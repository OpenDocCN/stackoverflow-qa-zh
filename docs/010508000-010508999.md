# StackOverflow 问答 10508000-10508999

# c# - 使用接口映射多对多

> ID：10508000
> 
> 赞同：1
> 
> 时间：2012-05-08T23:38:18.507
> 
> 标签：c#, nhibernate, interface, many-to-many, nhibernate-mapping

我在网上搜索了很多，但没有找到适合我的问题的正确解决方案。

基本上我正在尝试与属性创建多对多关系，但正如标题所说，它应该与接口而不是普通类一起使用。

这些是我在关系中的两个接口：

```
public interface IFaq  
{  
     IList<IFaqTagReference> FaqTagReferences { get; set; }  
     ...
}

public interface ITag
{  
     IList<IFaqTagReference> FaqTagReference { get; set; }
     ...
} 
```

以及指定关系的第三个接口

```
public interface IFaqTagReference  
{  
     IFaq Faq { get; set; }  
     ITag Tag { get; set; }  
} 
```

在 nhibernate 映射中，我尝试这种方式（通常每个元素都有属性，但它只是不起作用的关系）：

```
var mapper = new ConventionModelMapper();  
mapper.Class<Faq>(map =>  
                  {
                     map.Id(x => x.Id, m => m.Generator(Generators.GuidComb));
                     map.Set(x => x.FaqTagReferences,
                             db =>
                             {
                                 db.Key(km =>
                                        {
                                            km.Column("FaqId");
                                            km.NotNullable(true);
                                        });                            
                                 db.Table("FaqTagReferences");
                                 db.Cascade(Cascade.None);
                                 db.Inverse(true);
                             }, 
                             r => r.OneToMany(m => m.Class(typeof(FaqTagReference)))    
                             );
                   });

mapper.Class<Tag>(map =>
                 {   
                     map.Id(x => x.Id, m => m.Generator(Generators.GuidComb));                 
                     map.Set(x => x.FaqTagReferences,
                             db =>
                             {
                                  db.Key(km =>
                                         {
                                              km.Column("TagId");
                                              km.NotNullable(true);
                                         });
                                  db.Table("FaqTagReferences");
                                  db.Cascade(Cascade.None);
                                  db.Inverse(true);
                             }, 
                             r => r.OneToMany(m => { m.Class(typeof(FaqTagReference)); })
                             );
                 });

mapper.Class<FaqTagReference>(map =>
                         {
                            map.Id(x => x.Id, m => m.Generator(Generators.GuidComb));
                            map.ManyToOne(x => x.Faq, db => { db.Column("FaqId"); db.Class(typeof(Faq)); });
                            map.ManyToOne(x => x.Tag, db => { db.Column("TagId"); db.Class(typeof(Tag)); });
                         }); 
```

但这会引发以下异常

```
Could not determine type for:
System.Collections.Generic.IList[[Entities.IFaqTagReference,
BaseInterfaces, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]],
mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, for
columns: NHibernate.Mapping.Column(FaqTagReferences) 
```

感谢您的每一个提示或解决方案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T04:38:55.403

我认为可能与liskovs替代原则有关

[http://en.wikipedia.org/wiki/Liskov_substitution_principle](http://en.wikipedia.org/wiki/Liskov_substitution_principle)

```
essentially type IList<IFaqTagReference> is not type IList<FaqTagReference> 
```

类似于 [How do you map an entity -> interface relationship using Fluent NHibernate?](https://stackoverflow.com/questions/1022227/how-do-you-map-an-entity-interface-relationship-using-fluent-nhibernate)

# android - Proguard 和 Android 适配器

> ID：10508009
> 
> 赞同：2
> 
> 时间：2012-05-08T23:39:04.177
> 
> 标签：android, proguard

我听说应该保留 Android 活动。适配器呢。就像我有 ArrayAdapter 派生类一样？需要保留这些吗？视图呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T02:44:08.567

您通常应该保留使用反射访问的类的名称。这包括 AndroidManifest.xml 中列出的任何内容，以及自定义视图（如果它们在`layout.xml`文件中被引用）。适配器通常在代码中设置，因此您不需要保持它们的名称不被混淆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-08T08:56:06.050

目前您应该添加到`proguard-rules.pro`：

1) REST 库（Retrofit、Fuel 等）的 API 请求的数据类，

2) WebView JavaScript 接口，

3）其他一些可能在`Release`构建中发生变化的类，

4）所有，在他们的文档中提供库。

例如，参见[https://medium.com/androiddevelopers/practical-proguard-rules-examples-5640a3907dc9](https://medium.com/androiddevelopers/practical-proguard-rules-examples-5640a3907dc9)。

通常不应该添加活动（但我想，有人可以在那里编写数据类，尽管这是一个问题的情况）。

就我而言，我必须添加几个适配器的`ViewHolder`类。

# php - 加入返回空列？

> ID：10508010
> 
> 赞同：0
> 
> 时间：2012-05-08T23:39:08.190
> 
> 标签：php, mysql, join

我有一个从两个表中选择的 MYSQL 查询。第二个表可能不一定具有与第一个表匹配的连接 ID。让我们以这两个为例：

```
++++++++++++++++++
table: t1
column: id
column: test_id
column: info

table t2
column: t2id
column: test_id
column: extra_info
++++++++++++++++++ 
```

我将以下这些行插入到表中（目前这只是伪）：

```
insert into t1 values (1, 4, "asd")
insert into t1 values (2, 25, "dfg")
insert into t2 values (1, 25, "123") 
```

现在我的目标是将两个表连接在一起，但我遇到了连接问题。如果第二个表 (t2) 似乎没有匹配的行，它会使原始表中的连接列为 NULL？为什么要这样做？这是一个示例查询：

```
SELECT * FROM `t1` LEFT JOIN `t2` ON (`t1.test_id` = `t2.test_id`) WHERE `t1.id` = 1; 
```

现在，如果它们匹配，我绝对没有问题，但是由于某种原因，如果不存在任何行，则 t1 中的 test_id 被设置为 NULL ...如果有要加入的东西，我的目标是加入这两个表。 **编辑：如果没有要加入的内容，那么我只想通过将所有 t2 列设置为 NULL 或仅返回 t1 数据来从 t1 返回数据。** 我需要做一个子查询吗？如果是这样，那会是什么？谢谢 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T23:41:43.787

使用`INNER JOIN`.

```
SELECT * FROM `t1` 
INNER JOIN `t2` ON (`t1.test_id` = `t2.test_id`) 
WHERE `t1.id` = 1; 
```

关于 JOIN 类型的文档：http: [//dev.mysql.com/doc/refman/5.7/en/join.html](http://dev.mysql.com/doc/refman/5.7/en/join.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T23:42:41.880

这就是 的定义`LEFT JOIN`。`NULL`即使只有连接的左半部分匹配，它也会返回行，并在需要时填充右侧。

如果您只想获取对应右侧的行，请使用 just`JOIN`而不是`LEFT JOIN`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T23:43:37.233

加入时，建议不要使用“SELECT *”，特别是当您在多个表中具有类似命名的列时，因为这会引入歧义，并且您可能无法获得预期的结果。我建议改为：

```
SELECT t1.*, t2.t2id, t2.extra_info 
FROM `t1` 
    LEFT JOIN `t2` 
    ON (`t1.test_id` = `t2.test_id`)
WHERE `t1.id` = 1; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T23:42:34.237

有多种不同类型的连接。我认为您想要的是“内部联接”，其中仅返回匹配的行。查看[http://www.w3schools.com/sql/sql_join.asp](http://www.w3schools.com/sql/sql_join.asp)

# foursquare - 富媒体的 Foursquare API

> ID：10508014
> 
> 赞同：0
> 
> 时间：2012-05-08T23:40:06.257
> 
> 标签：foursquare, ads

我们想制作一个富媒体广告，并想应用foursquare 功能。

Foursquare API 现在是否可用于富媒体集成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T18:45:30.767

有一个[REST API](https://developer.foursquare.com/docs/)，甚至是[ActionScript 3 的客户端库](https://github.com/ludicast/foursquare)。

# javascript - 使用 jquery 调用 json 对象内的元素

> ID：10508017
> 
> 赞同：0
> 
> 时间：2012-05-08T23:40:33.280
> 
> 标签：javascript, jquery, json

我正在尝试调用 json 对象内的元素，这是代码的一部分

```
{
    " academy": {
        "business": {
            "E-commerce": [ 
```

现在我通过这段代码成功调用`academy`了第一个元素

```
$.getJSON("professorUnversityCollegeCourseData.js", function(property) {
$.each(property, function (key, value) {
    $('#uni').add('<option value="'+ key + '" id="'+ count +'">'+ key +  
                  '</option>').appendTo('#university-selection');
    arrayUni[count] = key;
    count++;
}); 
```

我现在如何获得“业务”元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:43:52.277

我认为你应该做的是：

```
$.getJSON("professorUnversityCollegeCourseData.js", function(property){
    business = property.academy.business;
     //-or-
    business = property["academy"]["business"];
}); 
```

（根据你放在那里的数据。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T23:44:26.643

你尝试过吗：

```
$.getJSON("professorUnversityCollegeCourseData.js", function(property) {
    $.each(property, function (key, value){
        $('#uni').add('<option value="'+ key + '" id="'+ count +'">'+ key + '</option>').appendTo('#university-selection');
        arrayUni[count] = key;
        count++;
        alert(this.academy.business);//Or also this['academy']['business']
    });
    alert(property.academy.business);//Or also property['academy']['business']
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T23:45:11.373

我想这就是你所追求的

```
key.academy.business 
```

真的就是这么简单，或者：

```
key['academy'] 
```

# python - 纯Python中的矩阵乘法？

> ID：10508021
> 
> 赞同：34
> 
> 时间：2012-05-08T23:41:14.343
> 
> 标签：python, matrix-multiplication

我正在尝试使用纯 Python 将两个矩阵相乘。输入（`X1`是 3x3 并且`Xt`是 3x2）：

```
X1 =  [[1.0016, 0.0, -16.0514], 
       [0.0, 10000.0, -40000.0], 
       [-16.0514, -40000.0, 160513.6437]]
Xt =  [(1.0, 1.0), 
       (0.0, 0.25), 
       (0.0, 0.0625)] 
```

其中 Xt 是另一个矩阵的 zip 转置。现在这里是代码：

```
def matrixmult (A, B):
    C = [[0 for row in range(len(A))] for col in range(len(B[0]))]
    for i in range(len(A)):
        for j in range(len(B[0])):
            for k in range(len(B)):
                C[i][j] += A[i][k]*B[k][j]
    return C 
```

python给我的错误是这样的：

> IndexError：列表索引超出范围。

现在我不确定是否`Xt`被识别为矩阵并且仍然是列表对象，但从技术上讲这应该有效。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-05-09T00:10:47.233

如果您真的不想使用`numpy`，可以执行以下操作：

```
def matmult(a,b):
    zip_b = zip(*b)
    # uncomment next line if python 3 : 
    # zip_b = list(zip_b)
    return [[sum(ele_a*ele_b for ele_a, ele_b in zip(row_a, col_b)) 
             for col_b in zip_b] for row_a in a]

x = [[1,2,3],[4,5,6],[7,8,9],[10,11,12]]
y = [[1,2],[1,2],[3,4]]

import numpy as np # I want to check my solution with numpy

mx = np.matrix(x)
my = np.matrix(y) 
```

结果：

```
>>> matmult(x,y)
[[12, 18], [27, 42], [42, 66], [57, 90]]
>>> mx * my
matrix([[12, 18],
        [27, 42],
        [42, 66],
        [57, 90]]) 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-05-08T23:55:50.423

This is incorrect initialization. You interchanged row with col!

```
C = [[0 for row in range(len(A))] for col in range(len(B[0]))] 
```

Correct initialization would be

```
C = [[0 for col in range(len(B[0]))] for row in range(len(A))] 
```

Also I would suggest using better naming conventions. Will help you a lot in debugging. For example:

```
def matrixmult (A, B):
    rows_A = len(A)
    cols_A = len(A[0])
    rows_B = len(B)
    cols_B = len(B[0])

    if cols_A != rows_B:
      print "Cannot multiply the two matrices. Incorrect dimensions."
      return

    # Create the result matrix
    # Dimensions would be rows_A x cols_B
    C = [[0 for row in range(cols_B)] for col in range(rows_A)]
    print C

    for i in range(rows_A):
        for j in range(cols_B):
            for k in range(cols_A):
                C[i][j] += A[i][k] * B[k][j]
    return C 
```

You can do a lot more, but you get the idea...

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-09T04:57:32.477

这是我多年前编写的纯 Python 中矩阵/向量例程的一些简短代码：

```
'''Basic Table, Matrix and Vector functions for Python 2.2
   Author:   Raymond Hettinger    
'''

Version = 'File MATFUNC.PY, Ver 183, Date 12-Dec-2002,14:33:42'

import operator, math, random
NPRE, NPOST = 0, 0                    # Disables pre and post condition checks

def iszero(z):  return abs(z) < .000001
def getreal(z):
    try:
        return z.real
    except AttributeError:
        return z
def getimag(z):
    try:
        return z.imag
    except AttributeError:
        return 0
def getconj(z):
    try:
        return z.conjugate()
    except AttributeError:
        return z

separator = [ '', '\t', '\n', '\n----------\n', '\n===========\n' ]

class Table(list):
    dim = 1
    concat = list.__add__      # A substitute for the overridden __add__ method
    def __getslice__( self, i, j ):
        return self.__class__( list.__getslice__(self,i,j) )
    def __init__( self, elems ):
        list.__init__( self, elems )
        if len(elems) and hasattr(elems[0], 'dim'): self.dim = elems[0].dim + 1
    def __str__( self ):
        return separator[self.dim].join( map(str, self) )
    def map( self, op, rhs=None ):
        '''Apply a unary operator to every element in the matrix or a binary operator to corresponding
        elements in two arrays.  If the dimensions are different, broadcast the smaller dimension over
        the larger (i.e. match a scalar to every element in a vector or a vector to a matrix).'''
        if rhs is None:                                                 # Unary case
            return self.dim==1 and self.__class__( map(op, self) ) or self.__class__( [elem.map(op) for elem in self] )
        elif not hasattr(rhs,'dim'):                                    # List / Scalar op
            return self.__class__( [op(e,rhs) for e in self] )
        elif self.dim == rhs.dim:                                       # Same level Vec / Vec or Matrix / Matrix
            assert NPRE or len(self) == len(rhs), 'Table operation requires len sizes to agree'
            return self.__class__( map(op, self, rhs) )
        elif self.dim < rhs.dim:                                        # Vec / Matrix
            return self.__class__( [op(self,e) for e in rhs]  )
        return self.__class__( [op(e,rhs) for e in self] )         # Matrix / Vec
    def __mul__( self, rhs ):  return self.map( operator.mul, rhs )
    def __div__( self, rhs ):  return self.map( operator.div, rhs )
    def __sub__( self, rhs ):  return self.map( operator.sub, rhs )
    def __add__( self, rhs ):  return self.map( operator.add, rhs )
    def __rmul__( self, lhs ):  return self*lhs
    def __rdiv__( self, lhs ):  return self*(1.0/lhs)
    def __rsub__( self, lhs ):  return -(self-lhs)
    def __radd__( self, lhs ):  return self+lhs
    def __abs__( self ): return self.map( abs )
    def __neg__( self ): return self.map( operator.neg )
    def conjugate( self ): return self.map( getconj )
    def real( self ): return self.map( getreal  )
    def imag( self ): return self.map( getimag )
    def flatten( self ):
        if self.dim == 1: return self
        return reduce( lambda cum, e: e.flatten().concat(cum), self, [] )
    def prod( self ):  return reduce(operator.mul, self.flatten(), 1.0)
    def sum( self ):  return reduce(operator.add, self.flatten(), 0.0)
    def exists( self, predicate ):
        for elem in self.flatten():
            if predicate(elem):
                return 1
        return 0
    def forall( self, predicate ):
        for elem in self.flatten():
            if not predicate(elem):
                return 0
        return 1
    def __eq__( self, rhs ):  return (self - rhs).forall( iszero )

class Vec(Table):
    def dot( self, otherVec ):  return reduce(operator.add, map(operator.mul, self, otherVec), 0.0)
    def norm( self ):  return math.sqrt(abs( self.dot(self.conjugate()) ))
    def normalize( self ):  return self / self.norm()
    def outer( self, otherVec ):  return Mat([otherVec*x for x in self])
    def cross( self, otherVec ):
        'Compute a Vector or Cross Product with another vector'
        assert len(self) == len(otherVec) == 3, 'Cross product only defined for 3-D vectors'
        u, v = self, otherVec
        return Vec([ u[1]*v[2]-u[2]*v[1], u[2]*v[0]-u[0]*v[2], u[0]*v[1]-u[1]*v[0] ])
    def house( self, index ):
        'Compute a Householder vector which zeroes all but the index element after a reflection'
        v = Vec( Table([0]*index).concat(self[index:]) ).normalize()
        t = v[index]
        sigma = 1.0 - t**2
        if sigma != 0.0:
            t = v[index] = t<=0 and t-1.0 or -sigma / (t + 1.0)
            v /= t
        return v, 2.0 * t**2 / (sigma + t**2)
    def polyval( self, x ):
        'Vec([6,3,4]).polyval(5) evaluates to 6*x**2 + 3*x + 4 at x=5'
        return reduce( lambda cum,c: cum*x+c, self, 0.0 )
    def ratval( self, x ):
        'Vec([10,20,30,40,50]).ratfit(5) evaluates to (10*x**2 + 20*x + 30) / (40*x**2 + 50*x + 1) at x=5.'
        degree = len(self) / 2
        num, den = self[:degree+1], self[degree+1:] + [1]
        return num.polyval(x) / den.polyval(x)

class Matrix(Table):
    __slots__ = ['size', 'rows', 'cols']
    def __init__( self, elems ):
        'Form a matrix from a list of lists or a list of Vecs'
        Table.__init__( self, hasattr(elems[0], 'dot') and elems or map(Vec,map(tuple,elems)) )
        self.size = self.rows, self.cols = len(elems), len(elems[0])
    def tr( self ):
        'Tranpose elements so that Transposed[i][j] = Original[j][i]'
        return Mat(zip(*self))
    def star( self ):
        'Return the Hermetian adjoint so that Star[i][j] = Original[j][i].conjugate()'
        return self.tr().conjugate()
    def diag( self ):
        'Return a vector composed of elements on the matrix diagonal'
        return Vec( [self[i][i] for i in range(min(self.size))] )
    def trace( self ): return self.diag().sum()
    def mmul( self, other ):
        'Matrix multiply by another matrix or a column vector '
        if other.dim==2: return Mat( map(self.mmul, other.tr()) ).tr()
        assert NPRE or self.cols == len(other)
        return Vec( map(other.dot, self) )
    def augment( self, otherMat ):
        'Make a new matrix with the two original matrices laid side by side'
        assert self.rows == otherMat.rows, 'Size mismatch: %s * %s' % (`self.size`, `otherMat.size`)
        return Mat( map(Table.concat, self, otherMat) )
    def qr( self, ROnly=0 ):
        'QR decomposition using Householder reflections: Q*R==self, Q.tr()*Q==I(n), R upper triangular'
        R = self
        m, n = R.size
        for i in range(min(m,n)):
            v, beta = R.tr()[i].house(i)
            R -= v.outer( R.tr().mmul(v)*beta )
        for i in range(1,min(n,m)): R[i][:i] = [0] * i
        R = Mat(R[:n])
        if ROnly: return R
        Q = R.tr().solve(self.tr()).tr()       # Rt Qt = At    nn  nm  = nm
        self.qr = lambda r=0, c=`self`: not r and c==`self` and (Q,R) or Matrix.qr(self,r) #Cache result
        assert NPOST or m>=n and Q.size==(m,n) and isinstance(R,UpperTri) or m<n and Q.size==(m,m) and R.size==(m,n)
        assert NPOST or Q.mmul(R)==self and Q.tr().mmul(Q)==eye(min(m,n))
        return Q, R
    def _solve( self, b ):
        '''General matrices (incuding) are solved using the QR composition.
        For inconsistent cases, returns the least squares solution'''
        Q, R = self.qr()
        return R.solve( Q.tr().mmul(b) )
    def solve( self, b ):
        'Divide matrix into a column vector or matrix and iterate to improve the solution'
        if b.dim==2: return Mat( map(self.solve, b.tr()) ).tr()
        assert NPRE or self.rows == len(b), 'Matrix row count %d must match vector length %d' % (self.rows, len(b))
        x = self._solve( b )
        diff = b - self.mmul(x)
        maxdiff = diff.dot(diff)
        for i in range(10):
            xnew = x + self._solve( diff )
            diffnew = b - self.mmul(xnew)
            maxdiffnew = diffnew.dot(diffnew)
            if maxdiffnew >= maxdiff:  break
            x, diff, maxdiff = xnew, diffnew, maxdiffnew
            #print >> sys.stderr, i+1, maxdiff
        assert NPOST or self.rows!=self.cols or self.mmul(x) == b
        return x
    def rank( self ):  return Vec([ not row.forall(iszero) for row in self.qr(ROnly=1) ]).sum()

class Square(Matrix):
    def lu( self ):
        'Factor a square matrix into lower and upper triangular form such that L.mmul(U)==A'
        n = self.rows
        L, U = eye(n), Mat(self[:])
        for i in range(n):
            for j in range(i+1,U.rows):
                assert U[i][i] != 0.0, 'LU requires non-zero elements on the diagonal'
                L[j][i] = m = 1.0 * U[j][i] / U[i][i]
                U[j] -= U[i] * m
        assert NPOST or isinstance(L,LowerTri) and isinstance(U,UpperTri) and L*U==self
        return L, U
    def __pow__( self, exp ):
        'Raise a square matrix to an integer power (i.e. A**3 is the same as A.mmul(A.mmul(A))'
        assert NPRE or exp==int(exp) and exp>0, 'Matrix powers only defined for positive integers not %s' % exp
        if exp == 1: return self
        if exp&1: return self.mmul(self ** (exp-1))
        sqrme = self ** (exp/2)
        return sqrme.mmul(sqrme)
    def det( self ):  return self.qr( ROnly=1 ).det()
    def inverse( self ):  return self.solve( eye(self.rows) )
    def hessenberg( self ):
        '''Householder reduction to Hessenberg Form (zeroes below the diagonal)
        while keeping the same eigenvalues as self.'''
        for i in range(self.cols-2):
            v, beta = self.tr()[i].house(i+1)
            self -= v.outer( self.tr().mmul(v)*beta )
            self -= self.mmul(v).outer(v*beta)
        return self
    def eigs( self ):
        'Estimate principal eigenvalues using the QR with shifts method'
        origTrace, origDet = self.trace(), self.det()
        self = self.hessenberg()
        eigvals = Vec([])
        for i in range(self.rows-1,0,-1):
            while not self[i][:i].forall(iszero):
                shift = eye(i+1) * self[i][i]
                q, r = (self - shift).qr()
                self = r.mmul(q) + shift
            eigvals.append( self[i][i] )
            self = Mat( [self[r][:i] for r in range(i)] )
        eigvals.append( self[0][0] )
        assert NPOST or iszero( (abs(origDet) - abs(eigvals.prod())) / 1000.0 )
        assert NPOST or iszero( origTrace - eigvals.sum() )
        return Vec(eigvals)

class Triangular(Square):
    def eigs( self ):  return self.diag()
    def det( self ):  return self.diag().prod()

class UpperTri(Triangular):
    def _solve( self, b ):
        'Solve an upper triangular matrix using backward substitution'
        x = Vec([])
        for i in range(self.rows-1, -1, -1):
            assert NPRE or self[i][i], 'Backsub requires non-zero elements on the diagonal'
            x.insert(0, (b[i] - x.dot(self[i][i+1:])) / self[i][i] )
        return x

class LowerTri(Triangular):
    def _solve( self, b ):
        'Solve a lower triangular matrix using forward substitution'
        x = Vec([])
        for i in range(self.rows):
            assert NPRE or self[i][i], 'Forward sub requires non-zero elements on the diagonal'
            x.append( (b[i] - x.dot(self[i][:i])) / self[i][i] )
        return x

def Mat( elems ):
    'Factory function to create a new matrix.'
    m, n = len(elems), len(elems[0])
    if m != n: return Matrix(elems)
    if n <= 1: return Square(elems)
    for i in range(1, len(elems)):
        if not iszero( max(map(abs, elems[i][:i])) ):
            break
    else: return UpperTri(elems)
    for i in range(0, len(elems)-1):
        if not iszero( max(map(abs, elems[i][i+1:])) ):
            return Square(elems)
    return LowerTri(elems)

def funToVec( tgtfun, low=-1, high=1, steps=40, EqualSpacing=0 ):
    '''Compute x,y points from evaluating a target function over an interval (low to high)
    at evenly spaces points or with Chebyshev abscissa spacing (default) '''
    if EqualSpacing:
        h = (0.0+high-low)/steps
        xvec = [low+h/2.0+h*i for i in range(steps)]
    else:
        scale, base = (0.0+high-low)/2.0, (0.0+high+low)/2.0
        xvec = [base+scale*math.cos(((2*steps-1-2*i)*math.pi)/(2*steps)) for i in range(steps)]
    yvec = map(tgtfun, xvec)
    return Mat( [xvec, yvec] )

def funfit( (xvec, yvec), basisfuns ):
    'Solves design matrix for approximating to basis functions'
    return Mat([ map(form,xvec) for form in basisfuns ]).tr().solve(Vec(yvec))

def polyfit( (xvec, yvec), degree=2 ):
    'Solves Vandermonde design matrix for approximating polynomial coefficients'
    return Mat([ [x**n for n in range(degree,-1,-1)] for x in xvec ]).solve(Vec(yvec))

def ratfit( (xvec, yvec), degree=2 ):
    'Solves design matrix for approximating rational polynomial coefficients (a*x**2 + b*x + c)/(d*x**2 + e*x + 1)'
    return Mat([[x**n for n in range(degree,-1,-1)]+[-y*x**n for n in range(degree,0,-1)] for x,y in zip(xvec,yvec)]).solve(Vec(yvec))

def genmat(m, n, func):
    if not n: n=m
    return Mat([ [func(i,j) for i in range(n)] for j in range(m) ])

def zeroes(m=1, n=None):
    'Zero matrix with side length m-by-m or m-by-n.'
    return genmat(m,n, lambda i,j: 0)

def eye(m=1, n=None):
    'Identity matrix with side length m-by-m or m-by-n'
    return genmat(m,n, lambda i,j: i==j)

def hilb(m=1, n=None):
    'Hilbert matrix with side length m-by-m or m-by-n.  Elem[i][j]=1/(i+j+1)'
    return genmat(m,n, lambda i,j: 1.0/(i+j+1.0))

def rand(m=1, n=None):
    'Random matrix with side length m-by-m or m-by-n'
    return genmat(m,n, lambda i,j: random.random())

if __name__ == '__main__':
    import cmath
    a = Table([1+2j,2,3,4])
    b = Table([5,6,7,8])
    C = Table([a,b])
    print 'a+b', a+b
    print '2+a', 2+a
    print 'a/5.0', a/5.0
    print '2*a+3*b', 2*a+3*b
    print 'a+C', a+C
    print '3+C', 3+C
    print 'C+b', C+b
    print 'C.sum()', C.sum()
    print 'C.map(math.cos)', C.map(cmath.cos)
    print 'C.conjugate()', C.conjugate()
    print 'C.real()', C.real()

    print zeroes(3)
    print eye(4)
    print hilb(3,5)

    C = Mat( [[1,2,3], [4,5,1,], [7,8,9]] )
    print C.mmul( C.tr()), '\n'
    print C ** 5, '\n'
    print C + C.tr(), '\n'

    A = C.tr().augment( Mat([[10,11,13]]).tr() ).tr()
    q, r = A.qr()
    assert q.mmul(r) == A
    assert q.tr().mmul(q)==eye(3)
    print 'q:\n', q, '\nr:\n', r, '\nQ.tr()&Q:\n', q.tr().mmul(q), '\nQ*R\n', q.mmul(r), '\n'
    b = Vec([50, 100, 220, 321])
    x = A.solve(b)
    print 'x:  ', x
    print 'b:  ', b
    print 'Ax: ', A.mmul(x)

    inv = C.inverse()
    print '\ninverse C:\n', inv, '\nC * inv(C):\n', C.mmul(inv)
    assert C.mmul(inv) == eye(3)

    points = (xvec,yvec) = funToVec(lambda x: math.sin(x)+2*math.cos(.7*x+.1), low=0, high=3, EqualSpacing=1)
    basis = [lambda x: math.sin(x), lambda x: math.exp(x), lambda x: x**2]
    print 'Func coeffs:', funfit( points, basis )
    print 'Poly coeffs:', polyfit( points, degree=5 )
    points = (xvec,yvec) = funToVec(lambda x: math.sin(x)+2*math.cos(.7*x+.1), low=0, high=3)
    print 'Rational coeffs:', ratfit( points )

    print polyfit(([1,2,3,4], [1,4,9,16]), 2)

    mtable = Vec([1,2,3]).outer(Vec([1,2]))
    print mtable, mtable.size

    A = Mat([ [2,0,3], [1,5,1], [18,0,6] ])
    print 'A:'
    print A
    print 'eigs:'
    print A.eigs()
    print 'Should be:', Vec([11.6158, 5.0000, -3.6158])
    print 'det(A)'
    print A.det()

    c = Mat( [[1,2,30],[4,5,10],[10,80,9]] )     # Failed example from Konrad Hinsen
    print 'C:\n', c
    print c.eigs()
    print 'Should be:', Vec([-8.9554, 43.2497, -19.2943])

    A = Mat([ [1,2,3,4], [4,5,6,7], [2,1,5,0], [4,2,1,0] ] )    # Kincaid and Cheney p.326
    print 'A:\n', A
    print A.eigs()
    print 'Should be:', Vec([3.5736, 0.1765, 11.1055, -3.8556])

    A = rand(3)
    q,r = A.qr()
    s,t = A.qr()
    print q is s                # Test caching
    print r is t
    A[1][1] = 1.1               # Invalidate the cache
    u,v = A.qr()
    print q is u                # Verify old result not used
    print r is v
    print u.mmul(v) == A        # Verify new result

    print 'Test qr on 3x5 matrix'
    a = rand(3,5)
    q,r = a.qr()
    print q.mmul(r) == a
    print q.tr().mmul(q) == eye(3) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-02-13T09:21:54.553

纯python中的矩阵乘法。

```
def matmult(m1,m2):
r=[]
m=[]
for i in range(len(m1)):
    for j in range(len(m2[0])):
        sums=0
        for k in range(len(m2)):
            sums=sums+(m1[i][k]*m2[k][j])
        r.append(sums)
    m.append(r)
    r=[]
return m 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-01-26T13:56:57.973

一个班轮：

```
def dot(m1, m2):
    return [
        [sum(x * y for x, y in zip(m1_r, m2_c)) for m2_c in zip(*m2)] for m1_r in m1
    ] 
```

解释：

zip(*m2) - 从第二个矩阵中获取一列

zip(m1_r, m2_c) - 从 m1 行和 m2 列创建元组

sum(...) - 对乘法行求和 * col

测试：

```
m1 = [[1, 2, 3], [4, 5, 6]]
m2 = [[7, 8], [9, 10], [11, 12]]
result = dot(m1, m2)
assert result == [[58, 64], [139, 154]] 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-11-21T19:44:45.507

当我不得不做一些矩阵运算时，我定义了一个新类来提供帮助。在这样的类中，您可以定义魔术方法，例如`__add__`，或者，在您的用例中`__matmul__`，允许您定义`x = a @ b`or`a @= b`而不是`matrixMult(a,b)`。[根据PEP 465](https://www.python.org/dev/peps/pep-0465/)`__matmul__`在 Python 3.5 中添加。

我在下面包含了一些实现这一点的代码（我排除了非常长的方法，它基本上根据传递给它的内容`__init__`创建一个二维列表`self.mat`和一个元组）`self.order`

```
class Matrix:
    def __matmul__(self, multiplier):
        if self.order[1] != multiplier.order[0]:
            raise ValueError("The multiplier was non-conformable under multiplication.")
        return [[sum(a*b for a,b in zip(srow,mcol)) for mcol in zip(*multiplier.mat)] for srow in self.mat]

    def __imatmul__(self, multiplier):
        self.mat = self @ multiplier
        return self.mat

    def __rmatmul__(self, multiplicand):
        if multiplicand.order[1] != self.order[0]:
            raise ValueError("The multiplier was non-conformable under multiplication.")
        return [[sum(a*b for a,b in zip(mrow,scol)) for scol in zip(*self.mat)] for mrow in multiplicand.mat] 
```

笔记：

*   `__rmatmul__`如果`b @ a`被调用`b`但未实现则使用`__matmul__`（例如，如果我想通过 2D 列表实现预乘）
*   `__imatmul__`是`a @= b`正常工作所必需的；
*   如果矩阵在乘法下不一致，则意味着它不能被乘法，通常是因为它的行数多于或少于被乘数中的列数

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-05-08T23:53:24.723

The fault occurs here:

```
C[i][j]+=A[i][k]*B[k][j] 
```

It crashes when k=2\. This is because the tuple `A[i]` has only 2 values, and therefore you can only call it up to A[i][1] before it errors.

EDIT: Listen to Gerard's answer too, your C is wrong. It should be `C=[[0 for row in range(len(A))] for col in range(len(A[0]))]`.

Just a tip: you could replace the first loop with a multiplication, so it would be `C=[[0]*len(A) for col in range(len(A[0]))]`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-08T23:52:41.497

你的矩阵的形状`C`是错误的；它是你真正想要的东西的转置。（但我同意 ulmangt：正确的做法几乎肯定是使用 numpy，真的。）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-05-19T05:22:07.890

```
def matrixmult (A, B):
    C = [[0 for row in range(len(A))] for col in range(len(B[0]))]
    for i in range(len(A)):
        for j in range(len(B[0])):
            for k in range(len(B)):
                C[i][j] += A[i][k]*B[k][j]
    return C 
```

在第二行你应该改变

```
C = [[0 for row in range(len(B[0]))] for col in range(len(A))] 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-07-18T07:05:51.823

以下所有答案都会返回您的列表。您需要将其转换为矩阵

```
def MATMUL(X, Y):
    rows_A = len(X)
    cols_A = len(X[0])
    rows_B = len(Y)
    cols_B = len(Y[0])

    if cols_A != rows_B:
        print "Matrices are not compatible to Multiply. Check condition C1==R2"
        return

    # Create the result matrix
    # Dimensions would be rows_A x cols_B
    C = [[0 for row in range(cols_B)] for col in range(rows_A)]
    print C

    for i in range(rows_A):
        for j in range(cols_B):
            for k in range(cols_A):
                C[i][j] += A[i][k] * B[k][j]

    C = numpy.matrix(C).reshape(len(A),len(B[0]))

    return C 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-11-02T12:20:55.660

```
m=input("row")
n=input("col")
X=[]
for i in range (m):
    m1=[]
    for j in range (n):
        m1.append(input("num"))
    X.append(m1)
Y=[]
for i in range (m):
    n1=[]
    for j in range (n):
        n1.append(input("num"))
    Y.append(n1)

# result is 3x3
result = [[0,0,0],
         [0,0,0],
         [0,0,0]]

# iterate through rows of X
for i in range(len(X)):
   # iterate through columns of Y
   for j in range(len(Y[0])):
       # iterate through rows of Y
       for k in range(len(Y)):
           result[i][j] += X[i][k] * Y[k][j]

for r in result:
   print(r) 
```

# javascript - （未）旋转矩形上的点

> ID：10508022
> 
> 赞同：2
> 
> 时间：2012-05-08T23:41:31.850
> 
> 标签：javascript, algorithm, geometry, bounding-box

我发现这个以/ （加上and ）开头并计算旋转到/的[优秀问题和答案](https://stackoverflow.com/questions/6867474/points-on-a-rotated-rectangle)。这个计算完美，但我想在相反的方向运行它；从/和开始，我想计算原始/和.`x``y``center x/y``degrees/radians``x'``y'``x'``y'``degrees/radians``x``y``center x/y`

```
(x', y') = new position
(xc, yc) = center point things rotate around
(x, y) = initial point
theta = counterclockwise rotation in radians (radians = degrees * Pi / 180)
dx = x - xc
dy = y - yc

x' = xc + dx cos(theta) - dy sin(theta)
y' = yc + dx sin(theta) + dy cos(theta) 
```

或者，在 JavaScript/jQuery 中：

```
XYRotatesTo = function($element, iDegrees, iX, iY, iCenterXPercent, iCenterYPercent) {
    var oPos = $element.position(),
        iCenterX = ($element.outerWidth() * iCenterXPercent / 100),
        iCenterY = ($element.outerHeight() * iCenterYPercent / 100),
        iRadians = (iDegrees * Math.PI / 180),
        iDX = (oPos.left - iCenterX),
        iDY = (oPos.top - iCenterY)
    ;

    return {
        x: iCenterX + (iDX * Math.cos(iRadians)) - (iDY * Math.sin(iRadians)),
        y: iCenterY + (iDX * Math.sin(iRadians)) + (iDY * Math.cos(iRadians))
    };
}; 
```

上面的数学/代码解决了图A中的情况；它根据/ （红圈）、（蓝星）和 的已知值计算目的地`x'`/ （绿圈）的位置。`y'``x``y``center x/y``degrees/radians`

但我需要数学/代码来解决图 B；我不仅可以找到目的地`x`/ `y`（绿色圆圈），还可以`center x/y`从起始`x`/ `y`（灰色圆圈，尽管可能不需要）、目的地`x'`/ `y'`（红色圆圈）和`degrees/radians`.

![图 A 和 B](../Images/bf413d006619f43b559a13e746ae9710.png)

上面的代码将通过（感谢@andrew cooke 的答案，该答案已被他删除）解决了目的地`x`/ `y`（绿色圆圈） ，但为了做到这一点，我需要向其中输入目的地的位置（绿色星)，这就是我目前缺少的计算，如下图 C 所示：`iDegrees * -1``center x/y`

![图C](../Images/3cdb04073a436b27044756ab8b316653.png)

那么......我如何找到给定的坐标`?`/ `?`（绿色星）`n`，`A`（角度）和`x'`/ `y'`（红色圆圈）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T17:39:16.093

你试图找到一个逆变换。您从两个线性变换的组合开始，一个平移 T 和一个旋转 R。您首先将 R 应用于向量 x，然后将 T 应用于向量，因此表达式为 y = TRx。要解决逆问题，您需要 TR 的逆，写作 (TR) ^(-1)，它等于 R ^(-1) T ^(-1)。旋转 R 的倒数只是旋转角度的负数（你提到的）。类似地，翻译的倒数是原始翻译乘以 -1。所以你的答案是 x = R ^(-1) T ^(-1) y。

在您目前的情况下，您通过其角度获得旋转，但您需要计算平移。您将需要灰色圆圈，您认为自己不需要。将旋转 R（不是它的倒数）应用于灰色圆圈。从红色圆圈中减去这一点。这是原始翻译 T。将符号反转得到 T ^(-1)。

# c# - 使用 Chart.DataBindCrossTable() 为点工具提示指定多个值

> ID：10508027
> 
> 赞同：0
> 
> 时间：2012-05-08T23:41:48.513
> 
> 标签：c#, asp.net, .net, charts

我正在使用 Microsoft 图表控件并将 a 绑定`DataTable`到它，`Chart.DataBindCrossTable`其中一个参数是调用的字符串`otherFields`，您可以指定与该字符串中的点关联的任何属性：

```
chart.DataBindCrossTable(table.Rows, "COLUMN1", "COLUMN2", "COLUMN3", "Label=COLUMN4, LegendText=COLUMN1, ToolTip=COLUMN3"); 
```

我不想在 ToolTip 字段中指定多个列，例如：

```
ToolTip=COLUMN3 = COLUMN4 
```

这样每个点的工具提示将是“COLUMN3 = COLUMN4”，其中 column3 和 4 将填充该点的那些列/行中的任何值。

但是当我这样做时，我收到一条错误消息，指出数据源中没有名为“COLUMN3 = COLUMN4”的列。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T06:05:54.730

您可以在数据表中创建另一个计算列来显示您想要的内容并绑定到该列。

# jquery - 确定如何通过 iframe 或 closeHTML、escClose 或 overlayClose 关闭 simplemodal 窗口

> ID：10508028
> 
> 赞同：0
> 
> 时间：2012-05-08T23:42:18.833
> 
> 标签：jquery, jquery-plugins, simplemodal

我正在使用 simplemodal 通过 iframe 显示表单。form 可以关闭 modal，onClose 回调可以刷新主屏幕，更新屏幕上的信息。但如果 iframe 表单没有关闭模式，我不想刷新主屏幕。换句话说，我不想在 closeHTML、escClose 或 overlayClose 的简单关闭时刷新屏幕。

如果关闭是通过 closeHTML、escClose 或 overlayClose 调用的，onClose 回调中是否有办法确定关闭模式的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T01:22:36.543

我确信有更好的方法可以做到这一点，但这可能会让你走上正轨。

*   编辑插件为每种关闭类型设置数据属性值
*   使用 onClose 回调获取数据属性

**插件代码**

```
 // bind the close event to any element with the closeClass class
    $('.' + s.o.closeClass).bind('click.simplemodal', function (e) {
        e.preventDefault();
        // set 'closeType' data attr
        $('body').data('closetype', 'closeClass');
        s.close();

    });

    // bind the overlay click to the close function, if enabled
    if (s.o.modal && s.o.close && s.o.overlayClose) {
        s.d.overlay.bind('click.simplemodal', function (e) {
            e.preventDefault();
            // set 'closeType' data attr
            $('body').data('closetype', 'overlayClose');
            s.close();
        });
    }

    // bind keydown events
    doc.bind('keydown.simplemodal', function (e) {
        if (s.o.modal && e.keyCode === 9) { // TAB
            s.watchTab(e);
        }
        else if ((s.o.close && s.o.escClose) && e.keyCode === 27) { // ESC
            e.preventDefault();
            // set 'closeType' data attr
            $('body').data('closetype', 'escClose');
            s.close();
        }
    }); 
```

**插件初始化**

```
 // Load dialog on click
    $('#basic-modal .basic').click(function (e) {
        $('#basic-modal-content').modal({
            overlayClose: true,
            onClose: function() {
                console.log($('body').data('closetype'));
                $.modal.close();
            }
        });
        return false;
    }); 
```

# maven - Need to replace code snippet while maven build

> ID：10508035
> 
> 赞同：0
> 
> 时间：2012-05-08T23:42:57.297
> 
> 标签：maven

I want to replace the code snippet between two custom tag (@Start, @End) with empty tag.

```
public class MyClass{ 
private String name; 
private String age; 

@Start 
private String address; 
private String phoneNumber; 
@End 

} 
```

These tags are available in multiple files.

Is it possible using maven ? I was looking at [http://code.google.com/p/maven-replacer-plugin/](http://code.google.com/p/maven-replacer-plugin/) which is used for replacing text/value, i don't think this can be used for replacing content. am i right ? Do we have any other way of doing it ?

Regards Pankaj

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T23:45:41.670

Write a maven plugin. Apache Mahout, for example, as a maven plugin which runs Apache Velocity to generate source code from templates.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T06:51:17.057

As i answered on the maven users list use the maven-replaces-plugin and put it into the correct lifecycle-phase (prepare-sources etc.) and use the buildhelper-plugin to add the target folder where the filtered/converted sources has been put into. That should work...depending on what you like to achieve the advise of bmargulies might be worth to consider.

# php - Javascript/PHP 交互仅在第二次点击时出现

> ID：10508036
> 
> 赞同：0
> 
> 时间：2012-05-08T23:42:59.607
> 
> 标签：php, jquery, jquery-mobile, getjson

已经寻找答案但没有快乐，所以这里......

我正在开发一个移动混合应用程序。我希望用户填写他们的 id 号，然后将其提交给 javascript 函数进行基本验证，然后向我的服务器端 PHP 发起 jQuery.getJSON 请求，该请求返回数据，然后我的 jQuery 将重新填充表单 div数据。

目前它在 Firefox 中根本不起作用，只有在我第二次按下提交按钮后才能在 Safari 中正常工作。它返回正确的数据，因此链接正常。

我的问题是：为什么第一次点击后 div 没有重新填充？

HTML：

```
<div id="login540div">
<form id="login540form" onSubmit="login540()">
Enter Student ID number<input type="text" name="login540id" id="login540id"/>
<input type="submit" value="Submit" />
</form>
</div> 
```

Javascript：

```
function login540(){
// validates the data entered is an integer. 
var loginNo = document.getElementById("login540id").value;
//if(!isNaN(loginNo))
 if((parseFloat(loginNo) == parseInt(loginNo)) && !isNaN(loginNo))
{

 //jSonCaller(loginNo); 
 $.getJSON('http://localhost:8888/c05673160/login540.php?q='+loginNo, function(data){

//alert(data);
$('#login540div').html("<p>First Name ="+
data.firstName+
"</p> Last Name ="+data.lastName+" </p>Module No.1 ="+
data.moduleNo1+"</p> Module No.2 ="+
data.moduleNo2+"<p> Course ID="+
data.courseID+"</p>");
    })

}
  else 
    {
    // alert(loginNo);  CHECKED
    alert("Please make sure to insert only a whole number");
        } 
```

然后PHP是这样的......

```
 <?php
include ("config.php");
/*
require_once('FirePHPCore/FirePHP.class.php');
ob_start();
$firephp = FirePHP::getInstance(true);

$var = array('i'=>10, 'j'=>20);

$firephp->log($var, 'Iterators');
*/

$dbhost = 'localhost';
$dbuser = 'root';
$dbpass = 'root';
$dbname = 'collegeData';

$q=$_GET["q"];

$table = "studentTable";
$conn = mysql_connect($dbhost, $dbuser, $dbpass);

if (!$conn)     
    die('Could not connect: ' . mysql_error());
if (!mysql_select_db($dbname))    
    die("Can't select database");   

$result = mysql_query("SELECT * FROM {$table} WHERE studentID = '".$q."'");
if (!$result)  
    die("Query to show fields from table failed!" . mysql_error());

$json = array();
while($row = mysql_fetch_array ($result))     
{
    $json = array(
        'firstName' => $row['firstName'],
        'lastName' => $row['lastName'],
        'moduleNo1' => $row['moduleNo1'],
        'moduleNo2' => $row['moduleNo2'],
        'courseID' => $row['courseID']
    );
}

$jsonstring = json_encode($json);
echo $jsonstring;

mysql_close($conn);
?> 
```

我不知道出了什么问题，在过去的几天里我一直在搞各种事情试图解决它，但没有快乐，所以我非常感谢你能提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:04:14.277

缺少函数 login540() 的底部，但这需要终止默认的“提交”操作：这可以通过“返回 false;”来完成 在末尾。由于我看不到结尾，不确定是否会发生这种情况，但表单可能会在 AJAX 运行时“提交”。

这很复杂，因为表单没有动作，这可能解释了不同的浏览器行为。我建议将操作设置为“#”，然后，如果您在 URL 中看到添加了“#”，则该表单已提交并且未被您的函数停止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T00:10:47.210

@Robbie 有一个很好的观点，您似乎没有停止表单提交的默认行为。为此，您需要更改几件事：

1.  `onSubmit="login540()"`需要更改为`onSubmit="return login540()"`否则您从`login540()`函数返回的任何内容都将被忽略。
2.  在`login540()`函数结束时，您需要`return false;`阻止表单正常提交。您也可以将`event`对象作为第一个参数传入并`event.preventDefault()`改用：`function login540(event){event.preventDefault();...}`.

但是，为了帮自己一个忙，您可以使用 jQuery 将`submit`事件处理程序绑定到表单，而不是使用内联 JS (tisk, ti​​sk, :) )

```
$('#login540form').on('submit', login540); 
```

这样，您可以将所有 JS 保存在一个地方，而不是分散在整个 HTML 中。

# java - 你如何在Java中为游戏加倍缓冲？

> ID：10508042
> 
> 赞同：9
> 
> 时间：2012-05-08T23:44:02.917
> 
> 标签：java, graphics, doublebuffered

所以在我正在开发的游戏中，我有一个弹珠跟随鼠标，但是当它这样做时屏幕会闪烁。

背景包括两个 jpeg 和 9 个矩形。我将如何进行双重缓冲呢？这是主窗口的代码。

```
/**
 * Write a description of class Window here.
 * 
 * @author (your name) 
 * @version (a version number or a date)
 */
public class Window extends JApplet implements MouseMotionListener
{
    private BufferedImage image; 
    private BufferedImage side;
    private int mouseX;
    private int mouseY;

    public Window(){
        try {
            image = ImageIO.read(new File("Backgrounds/violet.jpg"));
            side = ImageIO.read(new File("Backgrounds/side margin.jpg"));
        } catch (IOException ex) { }    
    }   

    private void delay(int delay)
    {
        try {
            Thread.sleep(delay);
        } catch (InterruptedException e) {}
    }

    public void init()
    {
        this.addMouseMotionListener(this);
    }

    public void paint (Graphics page)
    {
        page.drawImage(image, 0, 0, null);
        page.setColor(Color.blue);
        page.fillRect(0, 0, 160, 160);
        page.setColor(Color.black);
        page.fillRect(15, 15, 130, 130);
        page.setColor(Color.green);
        page.fillRect(340, 0, 160, 160);
        page.setColor(Color.black);
        page.fillRect(355, 15, 130, 130);
        page.setColor(Color.yellow);
        page.fillRect(0, 340, 160, 160);
        page.setColor(Color.black);
        page.fillRect(15, 355, 130, 130);
        page.setColor(Color.red);
        page.fillRect(340, 340, 160, 160);
        page.setColor(Color.black);
        page.fillRect(355, 355, 130, 130);
        page.drawImage(side, 500, 0, null);
        page.drawString(Score.getScore(), 560, 110);
        //conveyors
        page.setColor(Color.gray);
        page.fillRect(235, 0, 30, 160);

        //marble
        delay(100);

        page.fillOval(mouseX, mouseY , 40, 40);          
    }

    public void mouseMoved(MouseEvent e)
    {
        mouseX = e.getX();
        mouseY = e.getY();
        repaint();
    }

    public void mouseDragged(MouseEvent e)
    {

    }
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-08T23:50:41.143

双缓冲在概念上非常简单，不是一个一个地绘制对象，而是将它们绘制在图像上，然后告诉渲染器绘制整个图像。这消除了闪烁。

这是您如何执行此操作的示例（[来源](http://www.ecst.csuchico.edu/~amk/classes/csciOOP/double-buffering.html)）

```
class DoubleBufferedCanvas extends Canvas {

    public void update(Graphics g) {
    Graphics offgc;
    Image offscreen = null;
    Dimension d = size();

    // create the offscreen buffer and associated Graphics
    offscreen = createImage(d.width, d.height);
    offgc = offscreen.getGraphics();
    // clear the exposed area
    offgc.setColor(getBackground());
    offgc.fillRect(0, 0, d.width, d.height);
    offgc.setColor(getForeground());
    // do normal redraw
    paint(offgc);
    // transfer offscreen to window
    g.drawImage(offscreen, 0, 0, this);
    }
} 
```

现在，您不必自己实现它，您可以使用 BufferStrategy 和相关类。有关示例，请参见 lakam99 的答案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-09T00:42:46.477

Swing 自动支持双缓冲，因此您无需编写任何代码。

只需调用`setDoubleBuffered(true)`您的顶级组件（通常是 JPanel），它应该都能正常工作。

看：[`setDoubleBuffered`](http://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/JComponent.html#setDoubleBuffered%28boolean%29)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-09T23:52:49.357

Another solution is to use a library that will double buffer for you. Since you are using Java2D I am assuming you want to keep everything pretty lightweight and lower level. I think Slick2D does a great job of providing simple, 2d drawing and input functions without getting in your way. It feels like a more elegant version of Java2D, but is written on OpenGL. Once you make a few applications with pure Java, I think moving to Slick2D is a GREAT idea. This is not a direct solution to your issue, but since it has already been solved I thought Id offer some advice that will make your Java game development life easier. Check it out if you get a chance [http://slick.cokeandcode.com/](http://slick.cokeandcode.com/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-09T00:37:43.813

我认为您的问题不是双重缓冲。您必须`super.paint(page);`在您的绘画方法的第一行添加。

# javascript - 在 javascript xpaths 中使用 exslt 扩展

> ID：10508048
> 
> 赞同：3
> 
> 时间：2012-05-08T23:45:01.490
> 
> 标签：javascript, dom, xpath, webkit, exslt

我想在使用 exslt 扩展的网络应用程序中使用 javascript XPaths，但我不知道如何做到这一点。

假装我有一个 html 文档，里面有一些 div。我想运行这个：

```
namespaces={'regexp':'http://exslt.org/regular-expressions'};
result = document.evaluate( 
             "//div[regexp:test(.,'$')]", 
             document, 
             function(ns){ 
                 return namespaces.hasOwnProperty(ns) ? namespaces[ns] : null;
             }, 
             XPathResult.ANY_TYPE, 
             null); 
```

只有这样会在评估中导致无效的 XPath 表达式异常。我正在使用铬。

我还需要做些什么来使这些东西正常工作吗？我在 exslt.org 上看到有 javascript 的实现，但我如何确保它们可用？我是否需要将我的 javascript 插入到 dom 中的命名空间脚本元素中或一些疯狂的东西中？

**更新**

如果直接使用浏览器 dom + javascript 和 xpath 无法做到这一点，是否可以在浏览器中使用 exslt 扩展编写 XSLT 来模拟 document.evaluate（返回与 xpath 匹配的元素列表）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T18:00:21.967

我认为默认浏览器 XPath 实现不支持 EXSLT。EXSLT 页面上提到的 javascript 支持可能是关于如何使用 in-browser.javascript 提供自己的 exslt 函数实现。这是[我能很快找到的一个例子](http://www.tkachenko.com/blog/archives/000704.html)。

例如，在 Firefox 中，您可以将[Saxon-B 作为扩展来运行 XSLT2.0](https://developer.mozilla.org/en/XSLT_2.0)，并且[Saxon-B 具有对 exslt 的内置支持（与 Saxon-HE 不同），尽管使用 XSLT/XPath 可能会更好2.0 功能](https://stackoverflow.com/questions/5897664/how-do-i-get-exslt-support-in-saxon-he)。例如，这是[正则表达式语法](http://www.w3.org/TR/xpath-functions/#regex-syntax)。尽管如此，依靠 Mozilla Saxon-B 扩展程序并不能帮助您使用 Chrome 或其他浏览器。

话虽如此，我认为您找不到在 XPath 中使用 EXSLT 扩展的跨浏览器解决方案。DOM Level 3 XPath的[一致性部分](http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#Conformance)要求支持 XPath 1.0，但没有提到 EXSLT。据说`INVALID_EXPRESSION_ERR`被抛出：

`if the expression has a syntax error or otherwise is not a legal expression according to the rules of the specific XPathEvaluator or contains specialized extension functions or variables not supported by this implementation.`

最后，这是一个[开放的 bugzilla 票证](https://bugzilla.mozilla.org/show_bug.cgi?id=365801)，供 Firefox 为他们的 DOM Level 3 XPath 实现开放 EXSLT 支持。自 2007 年以来，它似乎一直处于 NEW 状态。票据上写着：

`Currently Mozilla gives an exception "The expression is not a legal expression." even if a namespace resolver correctly resolving the EXSLT prefixes to the corresponding URLs is passed in`. 这是[测试用例](http://home.arcor.de/martin.honnen/mozillaBugs/domLevel3/exsltTestInEvaluate1.html)。

--

如果你不介意我问，你到底想用正则表达式做什么？也许我们可以帮助您摆脱[标准 XPath 字符串函数](http://www.w3.org/TR/xpath/#section-String-Functions)的组合？

--

**更新**您可以通过 XSLT 构建一个 XPath 运行器（就像您在更新问题时提出的那样），但**它不会返回源文档中的节点，它会返回看起来完全相同的新节点**。XSLT 生成一个新的结果树文档，我认为没有办法让它返回对原始节点的引用。

据我所知，Mozilla（和 Chrome）都[支持 XSLT](https://developer.mozilla.org/en/XSLT)，不仅支持从外部源加载的 XML 文档，还支持正在显示的文档中的 DOM 元素。该[`XSLTProcessor`文档](https://developer.mozilla.org/en/Using_the_Mozilla_JavaScript_interface_to_XSL_Transformations)提到了如何`tranformToFragment()`，例如，`will only produce HTML DOM objects if the owner document is itself an HTMLDocument, or if the output method of the stylesheet is HTML`。

这是一个简单的 XPath Runner，我构建了它来测试您的 ide：

1) 首先，您需要一个 XSLT 模板才能使用。

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" 
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
    xmlns:regexp="http://exslt.org/regular-expressions" 
    extension-element-prefixes="regexp">

    <xsl:template match="/">
        <xsl:copy-of select="."/>
    </xsl:template> 
</xsl:stylesheet> 
```

我开始使用 APi 在 JavaScript 中构建它，`document.implementation.createDocument`但认为加载它会更容易。FF 仍然支持`document.load`，而 Chrome 只允许您使用 XHR 加载内容。`--allow-file-access-from-files`如果您想使用 XHR 从本地磁盘加载文件，则需要启动 Chrome 。

2) 一旦我们加载了模板，我们需要修改指令`select`属性的值来运行我们需要的 XPath：`xsl:copy-of`

```
function runXPath(xpath) {
    var processor = new XSLTProcessor(); 
    var xsltns = 'http://www.w3.org/1999/XSL/Transform';

    var xmlhttp = new window.XMLHttpRequest();
    xmlhttp.open("GET", "xpathrunner.xslt", false);
    xmlhttp.send(null);

    var transform = xmlhttp.responseXML.documentElement;

    var copyof = transform.getElementsByTagNameNS(xsltns, 'copy-of')[0];
    copyof.setAttribute('select', xpath);

    processor.importStylesheet(transform);          

    var body = document.getElementById('body'); // I gave my <body> an id attribute
    return processor.transformToFragment(body, document); 
} 
```

您现在可以使用以下内容运行它：

```
var nodes = runXPath('//div[@id]');
console.log(nodes.hasChildNodes());
if (nodes.firstChild) {
    console.log(nodes.firstChild.localName);
} 
```

它非常适合像这样的“常规”XPath `//div[@id]`（并且无法找到`//div[@not-there]`）**，但我就是无法让它运行`regexp:test`扩展功能**。有了`//div[regexp:test(string(@id), "a")]`它不会出错，只返回空集。

Mozilla 文档建议[他们的 XSLT 处理器支持 EXSLT](https://developer.mozilla.org/en/EXSLT)。我想他们无论如何都在幕后使用 libxml/libxslt。也就是说，我也无法让它在 Mozilla 中工作。

希望能帮助到你。

你有机会摆脱[jQuery regexp](http://james.padolsey.com/javascript/regex-selector-for-jquery/)吗？不太可能对您的 XPath 构建器实用程序有帮助，但仍然是在 HTML 节点上运行正则表达式的一种方式。

# css - 如何覆盖 div？

> ID：10508050
> 
> 赞同：0
> 
> 时间：2012-05-08T23:45:20.920
> 
> 标签：css, css-selectors

我有这个 div 作为包含罚款的一部分：

```
.connier {
      text-align: left;
      padding-top: 5px;
      padding-bottom: 10px;
      padding-left: 10px;
      background-color:#CCC;
} 
```

并这样使用它：

```
<div id="connier">
  <!--#include virtual="/cover/cover.asp" -->
</div> 
```

但是我想在另一个页面上使用相同的包含文件，但这一次，具有透明背景，但它仍然呈现相同的背景。

这是我尝试的

```
.connier.the_otherbg {
      text-align: left;
      padding-top: 5px;
      padding-bottom: 10px;
      padding-left: 10px;
      background-color:transparent;
} 
```

```
<div class="the_otherbg">
  <!--#include virtual="/cover/rents.asp" -->
</div> 
```

我究竟做错了什么？

非常感谢提前

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T23:49:49.893

我认为你应该做的就是：

```
.connier {
      text-align: left;
      padding-top: 5px;
      padding-bottom: 10px;
      padding-left: 10px;
      background-color:#CCC;
}

.transparent
{
    background-color: transparent!important;
} 
```

请记住，我们正在使用 CASCADING 样式表 (CSS)，因此在其他类下找到透明类很重要，如果没有，请使用 '!important'（虽然这不应该经常使用！）。

另请注意，在 div 中使用了 'class=' 属性。要使用'id'将一些css绑定到div，那么类应该像'#myDivId'（在我看来这不太有用）

对于您的正常 div 使用：

```
<div class="connier"></div> 
```

并为您的其他 div 使用：（该 div 将同时有两个类）

```
<div class="connier transparent"></div> 
```

通过这种方式，您可以使您的 css 更加可用和可维护。

希望这能澄清一点

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T23:50:13.710

将您的 CSS 更改为：

```
.the_otherbg {
      background-color:transparent;
} 
```

确保它是在`.connier`. 您还需要确保您的 div 具有两个类：

```
<div class="connier the_otherbg">
  <!--#include virtual="/cover/rents.asp" -->
</div> 
```

I would do it this way so that the `the_otherbg` div inherits any changes to `connier`. Only define what is different between them. In the future, when you need to change something, you will only need to do it in one place.

Demo: [http://jsfiddle.net/CF88G/](http://jsfiddle.net/CF88G/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T23:47:33.837

`class`好吧，如果您使用选择器来定位由它标记的 div，我很想知道第一个是如何工作的`ID`，但不要介意。

第二个选择器定位同时具有 和 类`connier`的`the_otherbg`元素，而您要定位的元素只有`the_otherbg`. 尝试`.connier`从选择器中删除。

# zsh - 你如何在多台机器之间共享 zsh 历史记录？

> ID：10508052
> 
> 赞同：11
> 
> 时间：2012-05-08T23:45:31.450
> 
> 标签：zsh, zshrc

我有一个设置，我很高兴在机器之间共享我的配置文件，但我发现我经常想在 zsh (Ctrl + R) 中搜索，但我不记得我在哪台机器上输入了命令。理想情况下，我希望从我的任何机器中搜索一个规范的重复数据删除列表，其中包含以前的命令。鉴于我有时会在没有网络连接的情况下同时在这些机器上工作，那么合并历史文件并使所有内容保持同步的明智方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-06-09T02:01:03.130

我为 oh-my-zsh 编写了这个插件：

**用于 GPG 加密的 Oh My Zsh 插件，使用 Git** [https://github.com/wulfgarpro/history-sync与 Internet 同步 Zsh 历史](https://github.com/wulfgarpro/history-sync)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T07:33:44.283

嗯，我想您可以以某种方式识别您的帐户...然后您可以执行以下操作：

*   修改您的 .zshrc 以将来自 Dropbox 或 SCM 的其他帐户的历史记录与当前历史记录连接起来，如果这是在当前计算机上启动的第一个 zsh
*   然后使用 -n 对条目进行排序（按时间戳排序）
*   如果您设置了 setopt HIST_SAVE_NO_DUPS，我猜 zsh 会删除重复项

然后您需要捕获 shell 退出，并将现有历史记录复制到保管箱/SCM/任何共享位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-08T19:17:25.510

您可以为所涉及的机器提供一个 NFS 挂载点，其中包含 .zsh_history。每台机器都需要将 HISTFILE env var 设置为 NFS 中的该文件路径。

HISTFILE env var 是强制性的，因为 ZSH 不接受符号链接，并且它将被使用符号链接目标的最新版本的文件替换。

我没有测试上面所说的，因为我的设置是在使用 OSX 的 VM 和 Parallels 共享文件夹之间。因此，对于 NFS，文件的完整性（顺序？）可能需要考虑，与 Dropbox 解决方案相比也是如此。

不确定，像[https://gist.github.com/elim/f77e3e9f06b6f8a5e788](https://gist.github.com/elim/f77e3e9f06b6f8a5e788)这样的东西可以用来修复要合并的版本......

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-03-16T06:12:41.173

我使用下面的命令：

`ssh username@example.com cat ~/.zsh/.zhistory | cat ~/.zsh/.zhistory - | sort | uniq | tee ~/.zsh/.zhistory | ssh username@example.com cat \> ~/.zsh/.zhistory`

# c# - Web 应用程序的用户身份验证

> ID：10508056
> 
> 赞同：0
> 
> 时间：2012-05-08T23:45:51.090
> 
> 标签：c#, .net, authentication

您能否为我在 .NET 框架中开发的 Web 应用程序提供最简单的用户身份验证机制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:52:01.093

使用 MembershipProvider 非常简单，请查看此以获取[更多详细信息](http://msdn.microsoft.com/en-us/library/f1kyba5e.aspx)

[这是一个简单的](http://msdn.microsoft.com/en-us/library/44w5aswa.aspx)例子

# c - 如何使用 sprintf 的输出作为 fopen 的文件名？

> ID：10508059
> 
> 赞同：0
> 
> 时间：2012-05-08T23:46:00.650
> 
> 标签：c, file-io

我正在开发一个日志解析程序，该程序通过组合环境变量和预设字符串来检索要打开的文件，以便提供文件的完整路径，但是我无法让 fopen 从 sprintf 中取出输出，我我正在使用将环境变量和预设字符串结合起来，所以我想知道是否有人可以就我应该怎么做才能使其正常工作提供建议？谢谢！（过去几周我刚刚开始自学 C，所以我愿意接受任何提示，无论它们对我来说多么明显）

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define _GNU_SOURCE
void main(int argc, char *argv[], char *envp[])
{
  FILE *fd; // File pointer
  char *name;
  char *filename[];
  name = getenv("MCEXEC_PLAYERNAME");
  sprintf(filename,"/home/minecraft/freedonia/playerdata/deathlog-%s.txt",name);
  char buff[1024];
  if ((fd = fopen(filename, "r")) != NULL) // open file
  {
    fseek(fd, 0, SEEK_SET); // make sure start from 0

    while(!feof(fd))
    {
      memset(buff, 0x00, 1024); // clean buffer
      fscanf(fd, "%[^\n]\n", buff); // read file *prefer using fscanf
    }
    printf("Last Line :: %s\n", buff);
  }
  else
  printf( "fail" );
} 
```

这是我在使用 gcc 编译时遇到的错误

```
lastline.c: In function ‘main’:
lastline.c:9: error: array size missing in ‘filename’
lastline.c:11: warning: passing argument 1 of ‘sprintf’ from incompatible pointer type
/usr/include/stdio.h:341: note: expected ‘char * __restrict__’ but argument is of type   ‘char **’
lastline.c:13: warning: passing argument 1 of ‘fopen’ from incompatible pointer type
/usr/include/stdio.h:249: note: expected ‘const char * __restrict__’ but argument is of   type ‘char **’ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T23:49:02.617

```
char *filename[]; 
```

`char`声明一个未知大小的指针数组。您需要一个足够已知长度的`char`to to数组。`sprintf`宣布

```
char filename[1000];  // assuming 1000 is large enough 
```

或者

```
char *filename; 
```

作为获得名称后的指针`char`和`malloc`足够的内存，

```
filename = malloc(sizeof "/home/minecraft/freedonia/playerdata/deathlog-.txt" - 1 + strlen(name) + 1);
if (!filename) exit(EXIT_FAILURE); 
```

`name`如果结果比预期的要长，以避免不愉快的意外。

# php - 数据未正确传递到 php 服务器

> ID：10508060
> 
> 赞同：2
> 
> 时间：2012-05-08T23:46:03.040
> 
> 标签：php, android, mysql, json, phpmyadmin

我有一个应用程序通过 php 脚本从 phpmyadmin 读取 Json 数据并显示在列表活动中。单击商店名称后，+1 会添加到该商店的投票计数中，并且应该被发送回 php 服务器以将新的投票计数存储在 phpmyadmin 中。选择后，我检查了 db vote count 值，它没有更新。虽然我在 logcat 中得到 HTTP/1.1 200 ok，但我认为数据没有被正确传递或接收。有人可以帮忙吗，我被卡住了，没有方向。

安卓代码：

```
public void writeJSON() {
    String convertedID;
    String convertedVote;

    //convert int to string value to passed
    convertedID = new Integer(selectedID).toString();
    convertedVote = new Integer(selectedVote).toString();

    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost("http://10.0.2.2/kcstores.php");

    try {

       //writes the output to be stored in creolefashions.com/test2.php
       ArrayList <NameValuePair> nvps = new ArrayList <NameValuePair>(2);
            nvps.add(new BasicNameValuePair("storeUpdate", "update"));
        nvps.add(new BasicNameValuePair("storeID", convertedID));
        nvps.add(new BasicNameValuePair("storeVote", convertedVote));

        httppost.setEntity(new UrlEncodedFormEntity(nvps));
        HttpResponse response = httpclient.execute(httppost);
        HttpEntity entity = response.getEntity();
        Log.i("writeJSON", response.getStatusLine().toString());

        } catch(Exception e) {
            Log.e("log_tag", "Error in http connection"+e.toString()); 
        } 
} 
```

PHP代码：

```
<?php
    $link = mysql_connect("localhost", "root", "") or die (mysql_error());
    mysql_select_db("king_cake_stores")or die (mysql_error());

    $query = "SELECT * FROM storeInfo";
    $result = mysql_query($query);
    $getUpdate = "noupdate";

    if (isset($_POST['storeUpdate'])) {
      echo "receiving data from app";
      $getUpdate = $_POST['storeUpdate'];
      $getStoreID = $_POST['storeID'];
      $getStoreVote = $_POST['storeVote'];
    }

    // If command == getStoreID, it updates the table storeVote value
    // with the android storeVote value based upon correct storeID 
    if ($getUpdate == "update") {
       mysql_select_db("UPDATE storeInfo SET storeVote = $getStoreVote
          WHERE storeID == $getStoreID");
    } else {
    // stores the data in an array to be sent to android application
    while ($line = mysql_fetch_assoc($result)) $output[]=$line;
        print(json_encode($output));
    }
     mysql_close($link);

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T23:56:29.423

I suggest you start debugging from the server end and start working your way backwards.

First, start logging the response text from your HttpResponse.

Echo the mysql query text in your php file, and make sure it looks the way you're expecting it to.

If it looks correct, check your database structure.

If not, try doing a `var_dump($_POST)`, and check to see if your parameters are being sent correctly.

If you run through these steps, you should have a better idea of where the problem is.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T00:03:33.243

这可能不是全部问题，但是：

```
mysql_select_db("UPDATE storeInfo SET storeVote = $getStoreVote
      WHERE storeID == $getStoreID"); 
```

那应该是`mysql_query`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T00:39:06.290

在这里尝试一下，使用 PDO：

```
<?php 
//Db Connection Class
Class db{
    private static $instance = NULL;
    private function __construct() {}

    public static function getInstance($DBUSER,$DBPASS) {
        if (!self::$instance){
            try {
                self::$instance = new PDO("mysql:host=localhost;dbname=king_cake_stores", $DBUSER, $DBPASS);
                self::$instance->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
            }catch (Exception $e){
                die('Cannot connect to mySQL server.');
            }
        }
        return self::$instance;
    }
    private function __clone(){}
}

//Connect to PDO
$db = db::getInstance('username','password');

//Inser Update
if (isset($_POST['storeUpdate'])) {

    try {
        /*** UPDATE data ***/
        $query = $db->prepare("UPDATE storeInfo
                               SET storeVote = :storeVote
                               WHERE storeID = :storeID");

        $query->bindParam(':storeVote', $_POST['storeVote'], PDO::PARAM_STR);
        $query->bindParam(':storeID',   $_POST['storeID'], PDO::PARAM_INT);

        /*** execute the prepared statement ***/
        $query->execute();

    }catch(PDOException $e){
        echo $e->getMessage();
    }

//Output Current
}else{
    $result = $db->query('SELECT * FROM storeInfo')->fetchAll(PDO::FETCH_ASSOC);
    echo json_encode($result);
}
/*** close the database connection ***/
$db = null;
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-19T13:45:25.473

尝试`or die`在每个 PHP 命令之后使用。在 Android 中也使用 try catch 块这将减少代码中的错误。

# c# - Sharepoint 2010、ClientContext 和 401 未经授权

> ID：10508067
> 
> 赞同：3
> 
> 时间：2012-05-08T23:47:53.583
> 
> 标签：c#, authentication, sharepoint-2010

我正在尝试连接到 Sharepoint 实例以通过 3rd 方工具发布一些内容。

我无法控制 Sharepoint 实例，但我确信我的帐户拥有完全权限。

```
 ClientContext ctx = new ClientContext("https://thesharepointsite.com");
        ctx.Credentials = new System.Net.NetworkCredential(@"username", "password", "domain");
        Web w = ctx.Web;
        ctx.Load(w);
        ctx.ExecuteQuery(); 
```

在 ExecuteQuery 行上，我得到了异常：

```
The remote server returned an error: (401) Unauthorized. 
```

（内部没有例外。）

当我通过浏览器登录时，我可以确认 url 和凭据有效。

基于[这个问题](https://stackoverflow.com/questions/3935682/401-unauthorized-error-working-with-client-object-model)，我的假设是这是一个权限问题。

如果是这样，那我需要申请什么许可？

其他问题'我试过但没有成功：

[401 错误-Sharepoint 2007](https://stackoverflow.com/questions/9190975/sharepoint-webservice-401-error)

[SharePoint Server 身份验证错误](https://stackoverflow.com/questions/6999240/sharepoint-server-authentication-error)

[从文档库 SharePoint 2010 读取数据时出现 401 未经授权的异常](https://stackoverflow.com/questions/7554659/401-unauthorized-exception-while-reading-data-from-the-document-library-sharepoi)

**更新**

我已经尝试了具有相同响应的各种其他查询。我们有一个 Sharepoint、Office 365 实例并且可以正常工作（使用[远程身份验证](http://code.msdn.microsoft.com/Remote-Authentication-in-b7b6f43c/view/SourceCode#content)）。这也是我相信它与某种许可或访问相关的原因。

这是在客户的实例上。我只有一个帐户。我相信如果我要求第二个，它会有同样的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T01:45:24.070

请咨询您的 SharePoint 服务器管理员。他们也应该能够帮助您进行故障排除。如果您无法访问 SharePoint，我们将无法为您提供太多帮助，因为问题很可能出在服务器端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T01:45:52.230

事实证明这是 Sharepoint 服务器上的配置问题。

在 Sharepoint 服务器上，错误被记录在事件查看器上。我能够在他们的网络内部使用相同的凭据运行上面的代码。

# javascript - 当用户使用键盘时，Knockout.js valueUpdate 不起作用

> ID：10508070
> 
> 赞同：6
> 
> 时间：2012-05-08T23:48:06.423
> 
> 标签：javascript, knockout.js

我正在使用 Knockout.js 和 ASP.NET。我的HTML如下：

```
<div class="InputField">
    Fixed/Floating
    <div class="FieldContainer">
        <select data-bind="options: $root.FixedLoanOptions, selectedOptions: IsFixed, valueUpdate: 'change'" ></select>
    </div>
</div> 
```

如果用户使用鼠标选择项目，则 JSON 将返回服务器并提供更新的信息。但是，如果用户使用“选项卡”在选择控件上进行选项卡，选择一个项目，然后关闭选项卡，那么即使所选项目显示在 UI 上，JSON 也会返回该控件的空白值。

如果用户仅使用键盘，则 Knockout 视图模型似乎不会更新，当用户使用鼠标时，似乎在浏览器中专门发生了一些更改事件。

我怎样才能解决这个问题？有没有办法可以注册选择框 onchange 事件以使用手动更新 Knockout 模型的功能？

我在 IE9 和 Firefox 中都试过了，我在这两个中都有同样的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T18:18:45.367

您的其余代码是什么样的？AJAX 调用是如何进行的？

这个用键盘修改选择的例子在 IE 和 Firefox 上对我来说没问题：

[http://jsfiddle.net/mikebridge/yYS7c/2/](http://jsfiddle.net/mikebridge/yYS7c/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T10:18:26.653

当 knockoutjs 将模型更新为触发更多模糊时，您可以更改事件。

```
<div class="InputField">
    Fixed/Floating
    <div class="FieldContainer">
        <select data-bind="valueUpdate: 'blur', options: $root.FixedLoanOptions, selectedOptions: IsFixed" ></select>
    </div>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:39:14.533

只要您在选择“选项”选择“选项时，就可以在[Live示例中看到：](http://knockoutjs.com/examples/controlTypes.html)

*   鼠标点击
*   按下回车键后通过键盘箭头按钮进行选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T14:50:22.340

将 valueUpdate 绑定到 'keyup' 对我有用。不影响用鼠标所做的更改，所以到目前为止看起来不错。

所以这样的事情应该有效：

```
<div class="InputField">
    Fixed/Floating
    <div class="FieldContainer">
        <select data-bind="valueUpdate: 'keyup', options: $root.FixedLoanOptions, selectedOptions: IsFixed" ></select>
    </div>
</div> 
```

# jquery - 下拉查询

> ID：10508071
> 
> 赞同：-1
> 
> 时间：2012-05-08T23:48:19.293
> 
> 标签：jquery, drop-down-menu

我需要有关此 javascript 的帮助以允许以下内容开始隐藏并单击按钮显示信息。请帮忙！

```
$(document).ready(function(){
    /* show or hide gadget */
    $('a[rel="hide_block"]').click(function(){
        if ( $(this).parent('div').parent('div').children('div.java_content').css('height')=='auto') {
            $(this).css('background-image','url(images/gadget_dropdown.jpg)');
        } else {
            $(this).css('background-image','url(images/gadget_dropup.jpg)');
        }
        $(this).parent('div').parent('div').children('div.java_content').slideToggle();
        return false;
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T07:15:13.387

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="Scripts/jquery-1.7.1.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {            
            $('a[rel="hide_block"]').click(function (e) {
                e.preventDefault();

                var objJavaContent = $(this).parents('div.MainParent').find('div.java_content');
                $(this).addClass(objJavaContent.css('height') == 'auto' ? 'gadget_dropdown' : 'gadget_dropup');
                objJavaContent.slideToggle();
            });
        });
    </script>
    <style type="text/css">
        .gadget-dropdown
        {
            background-color: Red;
        }

        .gadget_dropup
        {
            background-color: Yellow;
        }
    </style>
</head>
<body>
    <div class="MainParent">
        <div class="java_content" style="display: none;">
            test test test test test test test test test test test test test test test test
            test test test test test test test test test test test test test test test test
            test test test test test test test test test test test test test test test test
            test test test test
        </div>
        <div>
            <a rel="hide_block">Show/Hide</a>
        </div>
    </div>
</body>
</html> 
```

# java - 测试选项菜单

> ID：10508073
> 
> 赞同：0
> 
> 时间：2012-05-08T23:48:34.537
> 
> 标签：java, android, junit

我正在尝试使用 JUnits 和 Android 进行一些测试。我的一项测试旨在检查选项菜单是否工作正常。用于测试菜单的方法如下所示。当我运行测试时，选项菜单会毫无问题地膨胀，但是选择了错误的选项（始终是第一个），而不是 id 为 mypack.R.id.enablegps 或任何其他 id 的选项，然后测试失败. 怎么了？

```
public void testRoute1() {
    testPreConditions();

    this.sendKeys(KeyEvent.KEYCODE_MENU);
    boolean ok = getInstrumentation().invokeContextMenuAction(mActivity, mypack.R.id.enablegps, 0);
    getInstrumentation().waitForIdleSync();

    assertTrue(ok);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T02:53:00.190

如果你想检查选项菜单，你应该这样做：

```
public void testRoute1() {
    testPreConditions();

    boolean ok = getInstrumentation().invokeMenuActionSync(mActivity,
           mypack.R.id.enablegps, 0);
    getInstrumentation().waitForIdleSync();

    assertTrue(ok);
} 
```

# regex - 更改文件名顺序的正则表达式

> ID：10508074
> 
> 赞同：0
> 
> 时间：2012-05-08T23:48:57.147
> 
> 标签：regex

我扫描了一组大约 100 张打印的照片，为每张照片指定了一个带有前缀和自动递增索引的文件名，当我已经完成了 80 张时，我意识到顺序不正确。无论如何，我继续，完成了，但现在我有 100 个具有这些名称的文件

```
Prefix1_000.jpg
Prefix1_001.jpg
...
Prefix1_099.jpg 
```

事实证明（假设）图片“Prefix1_080.jpg”实际上应该是该组的第一个，“Prefix1_081.jpg”是第二个，依此类推。

我已经下载了 PFrank，它允许我使用正则表达式批量重命名文件。问题是我对它们知之甚少。

我想将左侧的名称重命名为右侧的名称：

```
Prefix1_000.jpg --> Prefix2_020.jpg
Prefix1_001.jpg --> Prefix2_021.jpg
...
Prefix1_079.jpg --> Prefix2_099.jpg
Prefix1_080.jpg --> Prefix2_000.jpg
Prefix1_081.jpg --> Prefix2_001.jpg
...
Prefix1_099.jpg --> Prefix2_019.jpg 
```

可以用正则表达式做到这一点吗？如果是这样，您将使用哪种搜索和替换模式？我更改前缀没有问题（以避免自我重叠）。

**编辑**：不连续性不必是 10 的倍数，如 80。它实际上是一个丑陋的数字，如 81。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:59:13.563

您可以使用 PowerShell 轻松完成此操作。第一个，剩下的交给你。不应该超过10分钟左右。

```
Dir Prefix1_00*.jpg | rename-item -newname {  $_.name  -replace "Prefix1_00","Prefix2_02"  }

Dir Prefix1_01*.jpg | rename-item -newname {  $_.name  -replace "Prefix1_01","Prefix2_03"  }

Dir Prefix1_02*.jpg | rename-item -newname {  $_.name  -replace "Prefix1_02","Prefix2_04"  }

Dir Prefix1_03*.jpg | rename-item -newname {  $_.name  -replace "Prefix1_03","Prefix2_05"  }

Dir Prefix1_04*.jpg | rename-item -newname {  $_.name  -replace "Prefix1_04","Prefix2_06"  }

Dir Prefix1_05*.jpg | rename-item -newname {  $_.name  -replace "Prefix1_05","Prefix2_07"  }

Dir Prefix1_08*.jpg | rename-item -newname {  $_.name  -replace "Prefix1_08","Prefix2_00"  }

Dir Prefix1_09*.jpg | rename-item -newname {  $_.name  -replace "Prefix1_09","Prefix2_01"  }

Dir Prefix1_06*.jpg | rename-item -newname {  $_.name  -replace "Prefix1_06","Prefix2_08"  }

Dir Prefix1_07*.jpg | rename-item -newname {  $_.name  -replace "Prefix1_07","Prefix2_09"  } 
```

花了大约10分钟......享受！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T00:02:18.347

阻力最小的路径可能是分 10 步完成。所以重命名`Prefix1_(.)0(.)\.jpg`为`Prefix2_\12\2\.jpg`，然后重命名`Prefix1_(.)1(.)\.jpg`为`Prefix2_\13\2\.jpg`，等等。我不建议尝试使用正则表达式进行算术运算。

在这里简单解释一下语法： each`(.)`表示任意单个字符 ( `.`)，应记住以供以后使用 ( `(...)`)；这`\.`意味着完全是一个`.`字符（与您之前看到的“任何单个字符”的含义相反）。然后，在替换中，`\1`并`\2`表示“第一`(...)`组”和“第二`(...)`组”。

正如 Chris Gessler 所说，您也可以使用其他更通用的工具来实现。（如果我遇到同样的问题，我可能会用 Python 来解决。）但是没有特别的理由不使用你拥有的工具。

# html - 我将我的 Spotify 应用程序放在 Vista 上的哪个目录？

> ID：10508077
> 
> 赞同：2
> 
> 时间：2012-05-08T23:49:04.210
> 
> 标签：html, windows-vista, spotify

我正在尝试使用[他们的 API](https://developer.spotify.com/technologies/apps/)为 Spotify 开发应用程序。我开始使用[他们的这个指南，](https://developer.spotify.com/technologies/apps/guidelines/)但是当它说将我的文件放在“我的文档/Spotify”中时很快就卡住了。Vista 使用文件夹 Documents 而不是 My Documents（如果您尝试在用户文件夹中创建 My Documents，它会将内容合并到 Documents 中），因此我无法让 Spotify 找到我的应用程序。

[我在 C:\Users\myusername\Documents\Spotify\ 中创建了文件夹“hurrdurrdurr”，并将此处](https://developer.spotify.com/technologies/apps/tutorial/)描述的 HTML 和 JSON 文件放在 C:\Users\myusername\Documents\Spotify\hurrdurrdurr\ 中，但是“spotify:app: hurrdurrdurr”给了我一个带有“错误：appNotFound”的“metadataFailed”消息。任何想法我应该把我的应用程序文件放在哪里？

是的，以下所有事情都发生了：

*   我已将我的帐户设为开发者帐户
*   “开发”标签已出现在 Spotify 中
*   将应用程序放入目录后，我尝试重新启动 Spotify

另外，我使用的是 Spotify 版本 0.8.3.222。{我懒得复制的构建 ID}。我找不到任何预览版本的下载链接，但据我所知，这是最新版本。任何人

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T14:38:49.450

目录应该是正确的，在我的情况下是`C:\Users\buchetics\Documents\Spotify`. 您的应用程序可能有问题。在此处查看示例/教程： [https ://github.com/mager/spotify-apps-tutorial](https://github.com/mager/spotify-apps-tutorial)

我刚刚克隆了存储库，它适用于您正在使用的相同 Spotify 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T22:19:45.743

在将 Spotify 教程加载到我的 Windows 机器上的 Spotify 时遇到类似的问题后，我发现了问题所在——这非常简单。我不会声称这会解决所有问题，但很多使用基于 Windows 的机器的人似乎都遇到了这个问题。

1.从 github 下载 Spotify 教程后，将其解压缩到您创建的文件夹中 - 如 github 站点上所述，该文件夹应为“Spotify”。

1.  您可以将“Spotify”文件夹放在您喜欢的任何位置，只要它位于 C: 驱动器（桌面、我的文档等）上。

2.  打开“Spotify”文件夹；然后打开“apps-tutorial-master”文件夹——在这个文件夹中有一个名称相似的文件夹“apps-tutorial-master”，从这个文件夹中剪切所有文件并将它们移动到这个文件夹的父级，然后粘贴它们。

    **“Spotify”->“apps-tutorial-master”->“apps-tutorial-master”->“我们需要向上移动一个目录的文件”**；

3.  新的目录结构应如下所示：

    **"Spotfy"->"apps-tutorial-master"->"我们移到了一个目录的文件**；

将文件剪切并粘贴到一个目录后，您应该能够让 Spotify 加载教程。文件夹结构中的冗余来自 windows 实用程序的提取/解压缩。

我希望这对那些使用 Windows 机器的人有所帮助。

# solr - Solr 查询必须匹配字段中的所有单词/标记

> ID：10508078
> 
> 赞同：0
> 
> 时间：2012-05-08T23:49:04.763
> 
> 标签：solr

我`name`的`schema.xml`. 查询`q=name:(organic)`返回以下文档：

```
<doc>
    <str name="id">ontology.category.1483</str>
    <str name="name">Organic Products</str>
</doc>
<doc>
    <str name="id">ontology.keyword.4896</str>
    <str name="name">Organic Stores</str>
</doc> 
```

这在普通的 Solr 搜索中是完全正确的，**但是**我想构建查询以便它不返回任何内容，因为*“有机”*仅匹配该字段中可用的 2 个单词中的 1 个。

一个更好的说法可能是：仅当字段中的所有标记都匹配时才返回结果。因此，如果一个字段中有两个单词（标记）并且我只匹配 1（*'organic'*、*'organics'*、*'organ'*等），我不应该得到匹配，因为只有 50% 的字段被搜索过.

这在 Solr 中可行吗？如何构建查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T08:47:06.887

您可能正在使用 StandardTokenizerFactory （或类似的东西），一种解决方案是使用 KeywordTokenizerFactory 并发出短语查询，然后只有完美匹配才会起作用。当然请记住您可能想要使用的其他过滤器（例如 LowerCaseFilterFactory 等）。请注意：“商店有机”也不会与您的文档匹配

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:23:59.413

由于时间限制，我不得不求助于以下（hacky）解决方案。

我通过名为 的 DynamicField 字段将术语计数添加到索引中`tc_i`。

```
<dynamicField name="*_i" type="int" indexed="true" stored="true"/> 
```

现在在查询时我计算术语并将其附加到查询中，所以`q=name:(organic)`变成了`q=name:(organic) AND tc_i:(1)`，这显然不会返回“有机商店”/“有机产品”的文档，因为它们的`tc_i`字段设置为 2（两个词）。

# c# - 导航到页面时是否应该始终加载瞬态状态，还是仅在从墓碑状态恢复时加载？

> ID：10508080
> 
> 赞同：4
> 
> 时间：2012-05-08T23:49:36.463
> 
> 标签：c#, .net, silverlight, windows-phone-7, tombstoning

我正在阅读 Windows Phone 7.5 Unleashed，并且有很多看起来像这样的代码（在页面的代码隐藏中）：

```
bool loaded;

protected override void OnNavigatedTo(NavigationEventArgs e)
{
    if (!loaded)
    {
        DataContext = new SomePageViewModel(State);
        loaded = true;
    }

    ((SomePageViewModel)DataContext).LoadTransientState();

    ...
}

... 
```

这个想法是`loaded`当从墓碑状态恢复时这将是错误的，所以我们知道我们想要重建视图模型。

我的问题是：为什么要在`if`块外加载瞬态？如果我们的内存没有被丢弃（即应用程序没有被墓碑化），我们就不能继续使用旧的视图模型而不重新加载它的状态吗？

导航到页面时是否应该始终加载瞬态状态，还是仅在从墓碑状态恢复时加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T08:21:15.627

我不熟悉这本书，从你展示的代码中很难说这是否正确。它归结为`LoadTransientState`实际做了什么。

您要采取的处理墓碑的方法是确保（只要它在应用程序中有意义*）应用程序/页面在用户返回时应处于与离开时相同的状态。

因此，如果`LoadTransientState`只关心墓碑时信息的持久性，那么将其移动到`if`块内可能是合适的。
如果它处理某种其他形式的瞬态数据，那么可能不会。

希望`LoadTransientState`将包含一些逻辑以确保它不会设置（或重置）内部已经存在（或已设置）的数据，因此将避免被不必要地调用的任何预期后果。

*一些明显的例外是实时数据、计时器（可能）、实时信息等。

# php - cURL 返回不同的结果

> ID：10508082
> 
> 赞同：0
> 
> 时间：2012-05-08T23:50:01.967
> 
> 标签：php, curl

下面的函数返回的结果与我们直接渲染页面的实际结果不同。

会是什么问题？

```
function file_get_contents_curl($url) {
    $ch = curl_init();
    $useragent="Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.1)Gecko/20061204 Firefox/2.0.0.1";
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); //Set curl to return the data instead of printing it to the browser.
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt ($ch, CURLOPT_USERAGENT, $useragent);
    curl_setopt ($ch, CURLOPT_TIMEOUT, 10);
    curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 1);
    $data = curl_exec($ch);
    curl_close($ch);

return $data;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:54:06.507

My guess is that your accessing it with one browser, but your setting the `$useragent` to another. The external site might be returning different data depending on the useragent

# objective-c - 从 NSDate 转换时如何知道为 NSDateFormatter 设置的时区

> ID：10508094
> 
> 赞同：4
> 
> 时间：2012-05-08T23:50:59.097
> 
> 标签：objective-c, ios, cocoa

我有一个函数，它使用 NSDateFormatter 将 RFC3339 中的 NSString 转换为 NSDate，但我不知道如何考虑时区做相反的事情。

字符串到 NSDate 转换的相关部分是：

```
 // The result of a call to systemTimeZone is cached by the app automatically, if the user changes it that change isn't 
    // reflected unless resetSystemTimeZone is called to clear the cache.
    [NSTimeZone resetSystemTimeZone]; 
    NSLocale *enUSPOSIXLocale;
    enUSPOSIXLocale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"];
    [sRFC3339DateFormatter setLocale:enUSPOSIXLocale];
    if ([fromString hasSuffix:@"Z"] || [fromString hasSuffix:@"z"])
    {
        [sRFC3339DateFormatter setTimeZone:[NSTimeZone timeZoneWithAbbreviation:@"UTC"]];
    }
    else 
    {
        [sRFC3339DateFormatter setTimeZone:[NSTimeZone systemTimeZone]];
    }

[sRFC3339DateFormatter setDateFormat:@"yyyy'-'MM'-'dd'T'HH':'mm':'ss'Z'"]; 
```

我的问题是，当从 NSDate 转换为 NSString 的另一个方向时，我怎么知道用什么来调用 setTimeZone？当通过查看 Z 的缺失/存在从字符串转到 NSDate 时。但是如果我有一个 NSDate，我怎么知道将格式化程序设置为哪个时区？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T00:00:05.617

您的 NSDate 存储为 UTC/GMT 时区。因此，当您将其转换为字符串时，您可以选择要在其中显示字符串的时区。没有“正确”的答案。这是您想要显示的任何内容。

# facebook - 通过应用程序登录 Facebook 时，页面会刷新

> ID：10508104
> 
> 赞同：0
> 
> 时间：2012-05-08T23:52:08.063
> 
> 标签：facebook, variables, login, refresh, loss

应用程序的第一页使用文本框将值传递到下一页。如果用户没有登录，那么它将显示一个登录链接，允许他们这样做。每当他们单击链接时，页面都会刷新，从而删除从第一页传递过来的变量的值。

这是第一页输入框的代码（HTML）

```
<form action="verify.php" METHOD=post>
Enter a School: 
<input type="text" name="school" /> 
<INPUT TYPE=SUBMIT VALUE="GO">
</form> 
```

这是第二页检查他们是否登录的代码（PHP）

```
$user = $facebook->getUser();
if ($user == 0){
    $loginUrl = $facebook->getLoginUrl();
    echo ( '<b>Please <a href="'.$loginUrl.'">Login</a> before proceeding.</b>' );
    echo ( '<br />' ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:06:30.547

将登录之前/之后需要保存的值存储在会话变量中，或将其附加到 redirect_uri 中使用的变量（在 getLoginUrl() 函数中生成）

请记住，在服务器端身份验证的第二步中将代码交换为 access_token 时，您需要保持相同的 redirect_uri 值

# django - Django - 创建用户异常

> ID：10508105
> 
> 赞同：0
> 
> 时间：2012-05-08T23:52:08.330
> 
> 标签：django

我正在尝试在 Django 项目中创建一个新用户。models.py 中的方法`create_user()`在以下行中引发异常：

```
user.save(using=self._db) 
```

这是方法：

```
def create_user(self, username, email, password=None):
    """
    Creates and saves a User with the given username, e-mail and password.
    """
    now = datetime.datetime.now()

    # Normalize the address by lowercasing the domain part of the email
    # address.
    try:
        email_name, domain_part = email.strip().split('@', 1)
    except ValueError:
        pass
    else:
        email = '@'.join([email_name, domain_part.lower()])

    user = self.model(username=username, email=email, is_staff=False,
                     is_active=True, is_superuser=False, last_login=now,
                     date_joined=now)

    user.set_password(password)
    user.save(using=self._db)
    return user 
```

有什么建议么？

# java - 为什么在构造函数中调用 super()？

> ID：10508107
> 
> 赞同：77
> 
> 时间：2012-05-08T23:52:14.690
> 
> 标签：java, superclass

我正在处理一个扩展的类`JFrame`。

`super`这不是我的代码，它在开始构建 GUI 之前会调用它。我想知道为什么要这样做，因为我一直只是访问超类的方法而无需调用`super();`

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2012-05-09T00:05:58.437

对于所有具有父类的类（即 Java 中的每个用户定义类），都有一个不带参数的隐式调用，`super()`因此通常不需要显式调用它。但是，如果父的构造函数接受参数并且您希望指定它们，则*可以*使用带参数的调用。`super()`此外，如果父类的构造函数带有参数，并且它没有默认的无参数构造函数，则*需要*使用参数调用`super()`。

一个示例，其中显式调用`super()`为您提供了对框架标题的一些额外控制：

```
class MyFrame extends JFrame
{
    public MyFrame() {
        super("My Window Title");
        ...
    }
} 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-05-08T23:53:45.150

`super()`当您不自己进行调用时，会自动调用父类的空构造函数。这就是您不必在代码中执行此操作的原因。它是为你完成的。

当您的超类没有无参数构造函数时，编译器将要求您`super`使用适当的参数进行调用。编译器将确保您正确地实例化该类。所以这不是你必须过多担心的事情。

无论您是否调用`super()`构造函数，它都不会影响您调用父类方法的能力。

作为旁注，有人说，为了清楚起见，通常最好手动进行调用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-06-23T10:56:29.790

**我们可以使用 super 关键字访问超类元素**

考虑我们有两个类，父类和子类，具有不同的方法 foo 实现。现在在子类中，如果我们想调用父类的方法 foo，我们可以通过 super.foo(); 我们还可以通过 super 关键字访问父元素。

```
 class parent {
    String str="I am parent";
    //method of parent Class
    public void foo() {
        System.out.println("Hello World " + str);
    }
}

class child extends parent {
    String str="I am child";
    // different foo implementation in child Class
    public void foo() {
        System.out.println("Hello World "+str);
    }

    // calling the foo method of parent class
    public void parentClassFoo(){
        super.foo();
    }

    // changing the value of str in parent class and calling the foo method of parent class
    public void parentClassFooStr(){
        super.str="parent string changed";
        super.foo();
    }
}

public class Main{
        public static void main(String args[]) {
            child obj = new child();
            obj.foo();
            obj.parentClassFoo();
            obj.parentClassFooStr();
        }
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T23:55:59.230

它只是调用超类的默认构造函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-04-03T14:28:51.217

## 以上答案都没有回答“为什么”。

[在这里](http://www.beginwithjava.com/java/inheritance/calling-the-superclass-constructor.html)找到了一个很好的解释：

> 子类可以有自己的私有数据成员，因此子类也可以有自己的构造函数。
> 
> 子类的构造函数只能初始化子类的实例变量。因此，当子类对象被实例化时，子类对象也必须自动执行超类的构造函数之一。

您可能还想在[此处阅读有关](https://docs.oracle.com/javase/tutorial/java/IandI/super.html)**super**关键字的所有内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-06-10T18:24:26.500

我们使用 super 关键字来调用超类的成员。

由于子类从其父类继承所有成员（字段、方法、嵌套类），并且由于构造函数不是成员（它们不属于对象。它们负责创建对象），因此它们不会被子类继承。

因此，如果我们需要为超类创建对象，我们必须显式地调用父构造函数，以便构造函数链保持连接。在创建对象时，只能调用一个构造函数。通过 super，我们可以在需要时从当前构造函数中调用另一个构造函数。

如果您正在考虑为什么它存在于不扩展任何其他类的类，那么请记住默认情况下每个类都遵循对象类。因此，在构造函数中保留 super 是一个好习惯。

注意：即使您的第一条语句中没有 super()，编译器也会为您添加它！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-11T12:09:15.543

**我们可以使用 super 关键字访问超类成员**

如果您的方法覆盖了其超类的方法之一，您可以通过使用关键字来调用被覆盖的方法`super`。您也可以使用 super 来引用隐藏字段（尽管不鼓励隐藏字段）。考虑这个类，超类：

```
public class Superclass {

    public void printMethod() {
        System.out.println("Printed in Superclass.");
    }
} 
```

// 这是一个名为 Subclass 的子类，它覆盖`printMethod()`：

```
public class Subclass extends Superclass {

    // overrides printMethod in Superclass
    public void printMethod() {
        super.printMethod();
        System.out.println("Printed in Subclass");
    }
    public static void main(String[] args) {
        Subclass s = new Subclass();
        s.printMethod();    
    }
} 
```

在 Subclass 中，简单名称`printMethod()`是指在 Subclass 中声明的名称，它覆盖在 Superclass 中的名称。因此，要引用`printMethod()`继承自 Superclass，Subclass 必须使用限定名称，使用 super 如图所示。编译和执行子类打印以下内容：

```
Printed in Superclass.
Printed in Subclass 
```

# c# - WP7 将数据添加到无限列表框

> ID：10508108
> 
> 赞同：0
> 
> 时间：2012-05-08T23:52:27.017
> 
> 标签：c#, windows-phone-7, json.net

我正在尝试实现一个“无限”列表框，每次到达列表框末尾时都会加载新数据。当我尝试反序列化下一组搜索结果时会出现问题。我得到一个`Operation not supported on read-only collection`.

这是我的课。

```
public class Search
{
    //public Spellcheck spellcheck { get; set; }
    public ObservableCollection<ResultSearch> results = new ObservableCollection<ResultSearch>();

    public IEnumerator<ResultSearch> GetEnumerator()
    {
        return this.results.GetEnumerator();
    }
}

public class ResultSearch
{
    public int id { get; set; }
    public bool selected { get; set; }
    public string type { get; set; }
    public string name { get; set; }
    public bool active { get; set; }
    public string mixName { get; set; }
    public string title { get; set; }
    public string slug { get; set; }
    public object isrc { get; set; }
    public string releaseDate { get; set; }
    public string publishDate { get; set; }
    public string sampleUrl { get; set; }
    public string rtmpStreamUrl { get; set; }
    public bool exclusive { get; set; }
    public Price price { get; set; }
    //public AudioFormatFee audioFormatFee { get; set; }
    public string currentStatus { get; set; }
    public string length { get; set; }
    public int bpm { get; set; }
    public Key key { get; set; }
    public string saleType { get; set; }
    public List<SearchArtist> artists { get; set; }
    public List<SearchGenre> genres { get; set; }
    public List<object> subGenres { get; set; }
    public List<SearchChart> charts { get; set; }
    public SearchRelease release { get; set; }
    public SearchLabel label { get; set; }
    public SearchImages images { get; set; }
    //public DynamicImages dynamicImages { get; set; }
    public string bio { get; set; }
    public string url { get; set; }
}

public class SearchArtist
{
    public int id { get; set; }
    public string name { get; set; }
    public string slug { get; set; }
    public string type { get; set; }
}

public class SearchGenre
{
    public int id { get; set; }
    public string name { get; set; }
    public string slug { get; set; }
    public string type { get; set; }
}

public class SearchChart
{
    public int id { get; set; }
    public int position { get; set; }
    public string type { get; set; }
}

public class SearchRelease
{
    public int id { get; set; }
    public string name { get; set; }
    public string type { get; set; }
    public string slug { get; set; }
}

public class SearchLabel
{
    public int id { get; set; }
    public string name { get; set; }
    public string type { get; set; }
    public string slug { get; set; }
}

public class SearchImages
{
    //public Small small { get; set; }
    //public SearchMedium medium { get; set; }
    public SearchLarge large { get; set; }
    //public SearchBanner banner { get; set; }
    //public Waveform waveform { get; set; }
}

public class SearchLarge
{
    public int width { get; set; }
    public int height { get; set; }
    public string url { get; set; }
    public string secureUrl { get; set; }
} 
```

反序列化新数据

```
protected override void OnNavigatedTo(System.Windows.Navigation.NavigationEventArgs e)
    {
        base.OnNavigatedTo(e);

        string searchTxt = String.Empty;
        if (NavigationContext.QueryString.TryGetValue("searchTxt", out searchTxt))
        {
            searchTxtBox.Text = searchTxt;
            HttpUtility.UrlEncode(searchTxt);
            LaunchWebClient(searchTxt);
        }
    }

    private void LaunchWebClient(string searchTxt)
    {
        // WebClient jsonSearch
        WebClient jsonSearch = new GzipWebClient();
        Uri apiSearch = new Uri("http://api.beatport.com/catalog/3/search?query=" + searchTxt);
        jsonSearch.DownloadStringCompleted += new DownloadStringCompletedEventHandler(jsonSearch_GetDataCompleted);
        jsonSearch.DownloadStringAsync(apiSearch);
    }

    // When end of listbox is reached
    private void LaunchWebClientNextpage(int page)
    {
        int pageLimit = page;
        if (pageLimit <= 5)
        {
            // WebClient jsonSearch
            WebClient jsonSearch = new GzipWebClient();
            Uri apiSearch = new Uri("http://api.beatport.com/catalog/3/search?query=" + searchTxtBox.Text + "&page=" + page);
            jsonSearch.DownloadStringCompleted += new DownloadStringCompletedEventHandler(jsonSearchNextPage_GetDataCompleted);
            jsonSearch.DownloadStringAsync(apiSearch);
        }
        else
        {
            SystemTray.SetIsVisible(this, false);
            //SystemTray.SetOpacity(this, 0.0);
            prog.IsVisible = false;
            prog.IsIndeterminate = false;
        }
    }

    // Deserialize search json data
    public void jsonSearch_GetDataCompleted(object sender, DownloadStringCompletedEventArgs e)
    {
        Search searchData = JsonConvert.DeserializeObject<Search>(e.Result);

        if (searchData.results.Count == 0)
        {
            MessageBox.Show("your search didn't return any results");
        }
        else
        {
            this.listSearch.ItemsSource = searchData.results;
        }
    }

    // Deserialize search next page json data
    public void jsonSearchNextPage_GetDataCompleted(object sender, DownloadStringCompletedEventArgs e)
    {
        Search searchDataPage = JsonConvert.DeserializeObject<Search>(e.Result);

        //listSearch.Items.Add(searchDataPage.results);
    } 
```

谢谢您的帮助。

**更新**

这也是我的 xaml

```
<!--ContentPanel - place additional content here-->
    <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">            
        <ListBox x:Name="listSearch" >
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal" >
                        <Image delay:LowProfileImageLoader.UriSource="{Binding images.medium.url}" Tap="searchSelectedImageHandler" Margin="10" Width="60" Height="60" />
                        <StackPanel Orientation="Vertical" >
                            <TextBlock Text="{Binding name}" Tap="searchSelectedHandler" Style="{StaticResource PhoneTextLargeStyle}"/>
                            <TextBlock Text="{Binding type}" Style="{StaticResource PhoneTextSubtleStyle}" />
                        </StackPanel>
                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:00:44.710

发布的代码有`class Search`一个`ObservableCollection`：

```
public ObservableCollection<ResultSearch> results = new ObservableCollection<ResultSearch>(); 
```

但是，反序列化正在尝试添加到`listSearch`：

```
listSearch.Items.Add(searchDataPage.results); 
```

我怀疑，这些项目应该被添加到`results`集合而不是`listSearch`控件中。

**编辑以回应评论**：

最快（不是最理想）的做法是在您的代码隐藏中创建一个 ObservableCollection，然后将 ListBox 的 ItemsSource 设置为 ObservableCollection 并修改 json 方法：

```
// code behind for your xaml
public partial class MyCodeBehind
{
  public ObservableCollection<Search> Searches;

  public MyCodeBehind()
  {
    InitializeComponent();

    Searches = new ObservableCollection<Search>();
    // bind the collection to the ListBox
    this.listSearch.ItemsSource = Searches;
  }

  // Deserialize search json data
  public void jsonSearch_GetDataCompleted(object sender, DownloadStringCompletedEventArgs e)
  {
    Search searchData = JsonConvert.DeserializeObject<Search>(e.Result);

    if (searchData.results.Count == 0)
    {
      MessageBox.Show("your search didn't return any results");
    }
    else
    {
      // add the results to the existing Searches collection
      foreach (Search search in searchData.results)
      {
        Searches.Add(search);
      }
    }
  }

  // Deserialize search next page json data
  public void jsonSearchNextPage_GetDataCompleted(object sender, DownloadStringCompletedEventArgs e)
  {
    Search searchDataPage = JsonConvert.DeserializeObject<Search>(e.Result);

    // add the results to the existing Searches collection
    foreach (Search search in searchDataPage)
    {
      Searches.Add(search);
    }
  }
} 
```

# c++ - 向量值分配

> ID：10508111
> 
> 赞同：0
> 
> 时间：2012-05-08T23:52:55.940
> 
> 标签：c++, file, vector

我有这段代码：

```
 while(fileStream>>help)
    {
        MyVector.push_back(help);
    } 
```

...并且可以说在文件“fileStream”中是 1 句话：今天是晴天。现在当我这样做时：

```
 for(int i=0;i<MyVector.size();i++)
    {
         printf("%s\n", MyVector[i]);
    } 
```

，结果是“一天一天一天一天”。当然，它不应该是这样的。变量声明如下：

```
 char *help;
    vector<char*> MyVector; 
```

编辑：我明白答案，谢谢...但是有什么方法可以将文件中的单词存储在`vector<char*> MyVector`其中（就像我首先想要的那样）。这对我的程序的其余部分来说会很棒。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T23:58:51.320

When you do `fileStream>>help`, that's not changing the value of the pointer, it is overwriting the contents of the string that the pointer is pointing at. So you are pushing the same pointer into the vector over and over again. So all of the pointers in the vector point to the same string. And since the last thing written into that string was the word "day", that is what you get when you print out each element of your vector.

Use a vector of `std::string` instead:

```
string help;
vector<string> MyVector; 
```

If, as you say, you must stick with `vector<char*>`, then you will have to dynamically allocate a new string for each element. You cannot safely use a `char*` with `operator>>`, because there is no way to tell it how much space you actually have in your string, so I will use `std::string` for at least the input.

```
std::string help;
vector<char*> MyVector;

while (fileStream>>help) {
    char * p = new char[help.size() + 1];
    strcpy(p, help.c_str());
    MyVector.push_back(p);
} 
```

Of course, when you are done with the vector, you can't just let it go out of scope. You need to delete every element manually in a loop. However, this is still not completely safe, because your memory allocation could throw an exception, causing whatever strings you have already allocated and put in the vector to leak. So you should really wrap this all up in a try block and be ready to catch [`std::bad_alloc`](http://en.cppreference.com/w/cpp/memory/new/bad_alloc).

This is all a lot of hassle. If you could explain why you think you need to use `vector<char*>`, I bet someone could show you why you don't.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T23:59:15.413

那是因为你`char *`都指向同一个对象。指针和存储在向量中的`help`指针都指向同一个对象。每次您从流中读取时，它都会修改所有指针指向的内容。更改`char*`为`std::string`.

# file-upload - Codeigniter Multiple file upload and thumbnail creation: only one thumbnail being uploaded

> ID：10508113
> 
> 赞同：1
> 
> 时间：2012-05-08T23:53:24.747
> 
> 标签：file-upload, multifile-uploader

I am able to upload my images ok, I am able to create thumbnails ok, but only the first thumbnail is being uploaded. I checked the error code for the resize function and they all say 'true' (Success). However, if I upload 4 files, only the first is being uploaded to the thumbnail folder. Here is my code:

```
function _upload_them_images($_FILES, $last_insert_id)
{
    $error = '';
    // for($i=0; $i<count($_FILES); $i++)
    for($i=0; $i<count($_FILES['imagefile']['name']); $i++)
    {

        $_FILES['userfile']['name']         = $_FILES['imagefile']['name'][$i];
        $_FILES['userfile']['type']         = $_FILES['imagefile']['type'][$i];
        $_FILES['userfile']['tmp_name']     = $_FILES['imagefile']['tmp_name'][$i];
        $_FILES['userfile']['error']    = $_FILES['imagefile']['error'][$i];
        $_FILES['userfile']['size']     = $_FILES['imagefile']['size'][$i];

        $config['file_name']     = $last_insert_id.'_'.time().rand(1000,9999).$i;
        $config['upload_path']   = './images/vehicles/';
        $config['allowed_types'] = 'jpg|jpeg|gif|png';
        $config['max_size']      = '1000';
        $config['overwrite']     = FALSE;

        $this->upload->initialize($config);

        if($this->upload->do_upload())
        {
            $upload_result = $this->upload->data();             
            $rc = $this->_image_name_into_database(
                $last_insert_id,
                $upload_result['file_name']);               
            $image_config = array(
                'source_image'      =>$upload_result['full_path'],
                'new_image'             => './images/vehicles/thumbs/', 
                'create_thumb'      => TRUE,
                'maintain_ratio'    => TRUE,
                'width'                     => 75, 
                'height'                    => 50
            );

            $this->load->library('image_lib', $image_config);
            $resize_rc = $this->image_lib->resize();            
            $error += 0;            
        }
        else
        {    
            //if the image was not uploaded successfully, try resizing  
            $error += 1;
        }
    }
    if($error > 0)
    { 
        return FALSE; 
    }
    else
    { 
        return TRUE; 
    }     
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T00:02:14.257

您的图像库参数不会在循环中更新。当您调用 时`$this->load->....`，将忽略重复项。您应该使用以下方法重新初始化图像库：

```
$this->image_lib->clear();
$this->image_lib->initialize($image_config); 
```

每次之前`->resize()`

# android - 使用 onBackPressed 保存文件

> ID：10508117
> 
> 赞同：1
> 
> 时间：2012-05-08T23:53:59.217
> 
> 标签：android

我想让用户从列表中保存最喜欢的项目列表，所以我使用带有复选框的 Listview 显示完整列表，用户将选中或取消选中列表中的项目。

当用户按下后退按钮时，我希望能够将选中的项目保存到 SD 卡上的单独文件中。

我在我的活动中使用以下方法：

```
@Override
  public void onBackPressed() {
  // TODO Auto-generated method stub

  } 
```

但是，我在 OnCreate 方法中创建的列表在 onBackPressed 方法中不可用 - 即它超出了范围。

如果我尝试将列表传递给 onBackPressed 方法，如下所示：

```
@Override
  public void onBackPressed(ArrayList<HashMap<String, Object>> checked_list) {
  // TODO Auto-generated method stub

  } 
```

然后我得到错误：

“SetFavourites 类型的 onBackPressed(ArrayList>) 方法必须覆盖或实现超类型方法”并且 Eclipse 提示删除 @Override。

但是当我这样做时，永远不会调用 onBackPressed 方法。

如何将变量传递给 onBackPressed 方法，以便在退出之前对 Activity 中的数据执行操作？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T23:56:07.247

您可以在类的范围内定义一个变量，即在onCreate() 之外。

```
class Example {
    int mVisible = 0;

    void onCreate() {
        int notVisible = mVisible;
    }

    void onBackPressed() {
        mVisible = 10;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T00:00:53.323

您不能使用`@Override`覆盖不存在的方法。换句话说`onBackPressed(ArrayList<...> foo)`，它不是`Activity`该类的现有方法。

要访问您的列表，请将其声明为`Activity`...的实例成员

```
public class MyActivity extends Activity {

    ArrayList<HashMap<String, Object>> checked_list;

    // onCreate(...) here

    // onBackPressed() here

} 
```

# android - Start animation on page load, stop on page loaded

> ID：10508123
> 
> 赞同：8
> 
> 时间：2012-05-08T23:54:36.290
> 
> 标签：android, android-webview, menuitem, android-animation

I have a `MenuItem` in my `ActionBar` that is a "reload" icon. My `Activity` has a `WebView` and I'd like the icon to start animating when the `WebView` starts loading a webpage and stop when it's finished. This includes when clicking on links in the site that is loaded. What I have so far, works the first time I bring up a webpage, but if I leave the `Activity` and load another webpage, the "reload" icon seems to double up, or I will get `NullReference` exception thrown on `refreshItem.setActionView(ivRefresh);`

![enter image description here](../Images/534754aa58d628d8e8d5a85e2cead37b.png)

Here is my code:

```
public class Browser extends SherlockFragmentActivity {

    private MenuItem refreshItem;
    private WebView mWebView;

    @Override
    public void onCreate(final Bundle icicle) 
    {
        super.onCreate(icicle);
        setContentView(R.layout.browser);

        mWebView = (WebView)findViewById(R.id.webview);
        mWebView.getSettings().setSupportZoom(true);  
        mWebView.getSettings().setBuiltInZoomControls(true);

        mWebView.loadUrl("http://www.google.com");

        mWebView.setWebViewClient(new WebBrowserClient());

        mWebView.setWebChromeClient(new WebChromeClient() {
            public void onProgressChanged(WebView view, int progress) {

                //if (!isFinishing() && progress == 100 && refreshItem != null && refreshItem.getActionView() != null)
                //{
                //refreshItem.getActionView().clearAnimation();
                //refreshItem.setActionView(null);
                //}
            }
        });         
    }

    private class WebBrowserClient extends WebViewClient {

          @Override
          public void onLoadResource(WebView view, String url) {
              //StartAnimation();
          }

          @Override
          public void onPageStarted(WebView view, String url, Bitmap favicon) {
              StartAnimation();
          }

          @Override
          public void onPageFinished(WebView view, String url) {
            if (refreshItem != null && refreshItem.getActionView() != null)
            {
                refreshItem.getActionView().clearAnimation();
                refreshItem.setActionView(null);
            }
          }

         @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            view.loadUrl(url);
            return true;
        }
    }

    private void StartAnimation() {
        final LayoutInflater inflater = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        final ImageView ivRefresh = (ImageView)inflater.inflate(R.layout.refresh_view, null);

        final Animation rotation = AnimationUtils.loadAnimation(this, R.anim.refresh);
        ivRefresh.startAnimation(rotation);
        refreshItem.setActionView(ivRefresh);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getSupportMenuInflater().inflate(R.menu.menu, menu);

        refreshItem = menu.findItem(R.id.refresh);

        return super.onCreateOptionsMenu(menu);
    }
} 
```

The commented out code is different ways I tried to get it to work.

**UPDATE:**

After debugging this more, I put a breakpoint in the `StartAnimation` function and sometimes it's hit up to 7 times in a row and other times it's not. This makes no sense, as, to me, this should be working. Perplexing...

**SOLUTION (SORT OF):**

Updating the StartAnimation() function to this, seems to fix this issue, but seems more of a duct tape solution:

```
private void StartAnimation() {
    if (refreshItem != null && refreshItem.getActionView() == null)
    {
        final LayoutInflater inflater = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        final ImageView ivRefresh = (ImageView)inflater.inflate(R.layout.refresh_view, null);

        final Animation rotation = AnimationUtils.loadAnimation(this, R.anim.refresh);
        ivRefresh.startAnimation(rotation);
        refreshItem.setActionView(ivRefresh);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T10:03:13.170

要创建流畅的用户界面体验，您的“加载轮”动画可能应该在用户单击链接时开始 - 而不是在新页面开始加载时 - 并在新页面加载时结束。这使得应用程序看起来对用户响应更快，并且是在[Dolphin Browser](https://play.google.com/store/apps/details?id=mobi.mgeek.TunnyBrowser)中实现的行为，例如。

要实现这一点，您需要在 WebView 中监听用户的链接点击。如何做到这一点已经在这个答案中介绍过：

[通过Android WebView中的javascript检测点击HTML按钮](https://stackoverflow.com/questions/4065312/detect-click-on-html-button-through-javascript-in-android-webview)

您必须验证点击实际上是在指向新页面的链接上。[您可以通过 WebView 的HitTestResult](http://developer.android.com/reference/android/webkit/WebView.HitTestResult.html)类找到单击的 HTML 元素。SO上的这个答案为您提供了有关如何验证 HitTestResult 值的详细信息：

[从我的 android 应用程序中的网页获取点击事件](https://stackoverflow.com/questions/5907439/get-the-click-event-from-webpage-in-my-android-application)

您从 onClick() 方法开始动画并从 WebViewClient 的 onPageFinished() 方法结束动画，如果新页面未加载，也会在 onReceivedError() 中结束。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T06:40:55.293

您可以使用线程的概念。

直到 Web 视图中的 URL 加载，您显示加载动画，当 URL 加载时停止动画。

您需要使用两个线程，一个用于进度指示器（即 URL 加载），另一个用于动画的 UI 线程。

搜索它！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-12T16:45:11.593

使`Animation`变量成为`Browser`类的成员，并确保在离开活动之前停止动画。

# objective-c - 有没有办法加快从核心数据中获取

> ID：10508124
> 
> 赞同：2
> 
> 时间：2012-05-08T23:54:38.443
> 
> 标签：objective-c, ios

我已经问过一个类似的问题，但仍然无法正常工作。我有一个包含 3 万多条记录的核心数据数据库。我正在尝试将其提取到 tableview 中。我观看了关于核心数据的 WWDC 演示文稿，无论演示者建议什么，它都对我不起作用。我从该表中删除了大部分字段，只留下了 4 个包含 nsstring 和日期的字段。我使用了不同数字的 setFetchBatchSize，但在使用仪器时，提取控制器仍在获取所有 30k 记录。我看了一遍，仍然不确定我在做什么来降低获取。我使用了一个单独的线程并显示了 svprogreshud 但这让它变得更慢我猜是因为线程没有立即运行。

此外，数据分为 12 个部分，我在核心数据库中有一个字段，用一个字符来设置部分。

我还设置了 -com.apple.CoreData.SQLDebug 1 并在设备上运行时显示 3 秒加载包含所有记录的获取请求，但显示 CoreData: sql: pragma cache_size=200 CoreData: annotation: total fetch execution time: 3.1087s 36684 行。

这是一些代码

```
-(void)useDocument{

    if (self.peopleDatabase.documentState == UIDocumentStateClosed){
        [self.peopleDatabase openWithCompletionHandler:^(BOOL success){
            [self setupFetchResultsController];

        }];

    } else if (self.peopleDatabase.documentState == UIDocumentStateNormal){
        [self setupFetchResultsController];
    }     
}

-(void)setupFetchResultsController
{

    NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"people"];
    request.sortDescriptors = [NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"pplicon" ascending:YES]];
    [NSFetchedResultsController deleteCacheWithName:nil];
    self.fetchedResultsController = nil;

    [request setFetchBatchSize:50];
    //[request setFetchLimit:100];

    self.fetchedResultsController = [[NSFetchedResultsController alloc]initWithFetchRequest:request managedObjectContext:self.peopleDatabase.managedObjectContext sectionNameKeyPath:@"pplicon" cacheName:@"peopleCache"]; 
} 
```

先感谢您！

更新乔迪再次感谢您的回答。
我去了表的核心数据设置，并检查了索引的pplicon。我还需要检查什么吗。我按照 wwdc 视频的说明并在核心数据中运行仪器，它显示 NSManagedObjectContext executefetch .. Fetch Count 36684 然后另一个 Fetch Count 12 同样在采样器中，peopleviewcontroller setupfetchResultsContoroller 363.75ms 和 UIAplication Run 287.6ms 花费的时间最多。在活动监视器中，该应用程序占用了 91mb 的实际内存。这次有什么可以改进的吗？我还能检查什么，看看挂断在哪里？

就部分而言。我在数据库 pplicon 中有一个字符，用于显示部分，数据按它排序。

数据模型现在有一个实体，其中 5 个属性作为字符串，1 个属性作为日期

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:30:31.257

是否计算部分名称？当计算节名时，Core Data 会自动获取所有节名并调用节名来正确排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T00:46:03.643

我想我过去曾评论过一个非常相似的问题。您绝对**必须**运行 Instruments 并查看它的内容。它会告诉你它在哪里花费时间。

您正在使用部分，这可能很昂贵。您的部分属性“pplicon”是否在数据库中设置为索引？如果没有，您肯定必须扫描数据库中的所有项目。不扫描所有记录的唯一机会是将其设为索引。内部**可能**只使用索引表来获取唯一索引值。但是，它仍然必须返回部分对象。

Again, you **must** turn on instruments while testing so you can see exactly where you are spending your time.

# cocoa - Maintain aspect ratio of a view on a NSWindow, rather than the aspect.

> ID：10508125
> 
> 赞同：3
> 
> 时间：2012-05-08T23:54:45.143
> 
> 标签：cocoa, nswindow, nsimageview

I have an image view that i would like to maintain the aspect ratio of but still be able to resize the window.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-15T15:41:35.030

在界面生成器中将图像视图缩放属性设置为“按比例向上或向下”，并设置包含它的窗口的内容纵横比：

```
 [window setContentAspectRatio:myImageView.image.size]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T15:11:04.823

据我所知，没有办法“自动”执行此操作，您需要跟随窗口的框架更改（使用委托方法 windowWillResize:toSize:) 并调整您的图像视图的框架，但是您希望它改变.

# php - HTML 添加 if 语句 I have an image uploader and I'm trying to make the site display what type of option has been selected when the file is uploaded. I will later add this functionality to connect to different tables in a database, but for now I

> ID：10508128
> 
> 赞同：0
> 
> 时间：2012-05-08T23:54:57.220
> 
> 标签：php, html

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:58:52.167

```
$uploadType = $_POST["uploadType"]; 
```

Then use `$uploadType` in your if statements. Variables in PHP always begin with a dollar sign.

In addition, use `else if` for the other conditions.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T00:09:04.900

您缺少两个“其他”陈述 - 在视频之前和事实“如果”陈述之前。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T00:00:20.423

`uploadType`在这里被用作常数。尝试替换`uploadType`为`$_POST['uploadType']`.

# css - 2个并排的DIV（1行）向右伸展

> ID：10508132
> 
> 赞同：0
> 
> 时间：2012-05-08T23:55:43.580
> 
> 标签：css, html, css-float

我正在尝试在 CSS 中构建如下所示的液体布局。 ![液体布局](../Images/78cab20c6c03dea0e860f41d62e71933.png)

左列应该伸展到所有可用空间，如果可能的话，在同一行。右边的列应该具有相同的宽度。

**我已经取得了非常接近我想要的结果。**看看[http://jsfiddle.net/tcWCC/34/embedded/result/](http://jsfiddle.net/tcWCC/34/embedded/result/) 但是有两个问题。两个对齐的 DIV 的高度应该相等。第一个或第二个 DIV 应该增长到与另一个相同的高度。

第二个问题是，当宽度不足以容纳 2 个 DIV 时，我希望第一个 (NomeEvento) div 位于顶部。而不是第二个 div (DataEvento)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T00:01:45.957

我不确定我是否正确理解了您的问题。以下布局是否与您想要的类似？[http://jsfiddle.net/5sjgf/](http://jsfiddle.net/5sjgf/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T00:08:43.393

这里有更多的 CSS 可供尝试。如果你想在左边留一个边距。我添加了背景颜色以帮助区分。

```
div.NomeEvento {
    text-align: left;
    float: left;
    width: 75%;
    background-color: #eee;
}

div.DataEvento {
    text-align: left;
    margin-left: 5%;
    width: 20%; 
    float:left;
    background-color: #ccc;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T00:13:11.287

对我来说，这似乎是很多无关的 CSS。但也许其他东西在那里是有原因的。这可以很好地作为您的 CSS 的总和：

```
div.Evento {
    overflow: hidden;
    margin-top: 10px;
}

div.NomeEvento {
    background: #eee;
    padding-right: 20%; /* the same as the right column width */
}

div.DataEvento {
    float:right;
    background: #ddd;
} 
```

...但是，如果您要右浮动一个元素，请将其放在布局中的*第一位*- 这里是元素类`DataEvento`：

```
<div class="Evento">
    <div class="DataEvento">@evento.Data</div>
    <div class="NomeEvento">@evento.Nome</div>
</div>​ 
```

检查它：http: [//jsfiddle.net/J89Hp/](http://jsfiddle.net/J89Hp/)

干杯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T23:29:42.280

我在我的 div 中使用显示表格、表格行和表格单元格完成了我想要的内容。

看一看。这正是我想要的。

[http://jsfiddle.net/tcWCC/47/embedded/result/](http://jsfiddle.net/tcWCC/47/embedded/result/)

# redirect - 如何为移动网站样式表创建媒体查询？

> ID：10508145
> 
> 赞同：0
> 
> 时间：2012-05-08T23:58:02.400
> 
> 标签：redirect, mobile, media-queries, directory-structure

我之前被告知要使用以下内容：

```
<link rel="stylesheet" media="only screen and (max-width: 480px)" href="mobile.css"> 
```

我想为移动访问者使用单独的样式表和 html 文档。这正常吗？我有很多元素我想从移动版本中删除，在移动网站中拥有一个网站似乎不那么复杂 - 它是自己的 html 和 CSS。

如何将上面的媒体查询用于特定于移动设备的样式表和 html？我会使用什么代码，我会把它放在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:06:21.843

就我而言，您必须检测浏览器服务器端，并提供不同的页面。

PHP 伪代码示例

```
if(browser == mobile && !isset($_COOKIES["prefer_desktop_view"])) //Pseudo code you do the checking here
{
   $_COOKIES["is_mobile"] = true; //more pseudo code
   header("location: mobile.example.com") //redirect solution - if
} 
```

媒体查询是特定于 CSS 的。在客户端没有办法做到这一点，即使有，客户端仍然必须下载和解析“桌面”HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-15T08:34:45.000

```
<link href="the/directory/containing/your/mobile.css type="text/css" media="handheld" rel="stylesheet" /> 
```

下一行可能是：

```
<link href="the/directory/containing/your/desktop.css" type="text/css" media="screen" rel="stylesheet" /> 
```

使用此方法并避免使用两个文档。相反，您正在根据用于查看该文档的设备来设置该文档的样式。

# mysql - 如何在 MySQL 中设计一个“视图”来获得我正在寻找的结果？

> ID：10508157
> 
> 赞同：5
> 
> 时间：2012-05-08T23:59:19.313
> 
> 标签：mysql

我已经设法从我的 MySQL 数据库中的一些数据创建一个视图，如下所示：

```
mysql> CREATE VIEW phonelist AS
    -> SELECT parent.parentID AS ParentID,
    -> ParentPerson.firstName AS ParentFirstName,
    -> ParentPerson.lastName AS  ParentLastName,
    -> ChildPerson.firstName AS PlayerFirstName,
    -> ChildPerson.lastName AS  PlayerLastName,
    -> GuardianHomePhone.homeNumber AS GuardianHomePhone
    -> FROM parent
    -> JOIN player ON (parent.parentID IN (player.motherID, player.fatherID))
    -> JOIN person AS ParentPerson ON (ParentPerson.personID = parent.parentID)
    -> JOIN person AS  ChildPerson ON (ChildPerson.personID = player.playerID)
    -> JOIN addressDetails AS GuardianHomePhone ON (GuardianHomePhone.personID = parent.parentID);

Query OK, 0 rows affected (0.00 sec)

mysql> select * from phonelist;

+----------+-----------------+----------------+-----------------+----------------+-------------------+
| ParentID | ParentFirstName | ParentLastName | PlayerFirstName | PlayerLastName | GuardianHomePhone |
+----------+-----------------+----------------+-----------------+----------------+-------------------+
|        8 | Gregory         | Peck           | Michael         | Peck           | 034871234         |
|        9 | Laura           | Peck           | Michael         | Peck           | 034871234         |
|       10 | Martha          | Petersen       | Matt            | Petersen       | 034724321         |
|       10 | Martha          | Petersen       | Christopher     | Petersen       | 034724321         |
|       11 | Chris           | Michaels       | Richard         | Michaels       | 034791212         |
|       11 | Chris           | Michaels       | Shaun           | Michaels       | 034791212         |
|       12 | Nadine          | Michaels       | Richard         | Michaels       | 034791212         |
|       12 | Nadine          | Michaels       | Shaun           | Michaels       | 034791212         |
|       13 | Barry           | Dackers        | Harry           | Dackers        | 034871996         |
|       14 | Kevin           | Mitchell       | Daniel          | Mitchell       | 034742886         |
|       15 | Rebecca         | Mitchell       | Daniel          | Mitchell       | 034742886         |
+----------+-----------------+----------------+-----------------+----------------+-------------------+
11 rows in set (0.00 sec)

mysql> 
```

创建这个视图是一个挑战，但下面的描述是我在导航时遇到的问题：

我还需要使用此视图添加每个玩家所在的团队。因为要匹配团队的名称需要将 4 个表连接在一起，所以我无法将它们合并在一起。我设法创建了一个单独的查询，将球员与以下球队匹配：

```
mysql> select person.firstName, person.lastName, team.teamName
    -> from person join player on person.personID = player.playerID
    -> join teamAllocation on person.personID = teamAllocation.playerID
    -> join team on teamAllocation.teamID = team.teamID;

+-------------+----------+------------+
| firstName   | lastName | teamName   |
+-------------+----------+------------+
| Michael     | Peck     | U10 Red    |
| Christopher | Petersen | U10 Red    |
| Richard     | Michaels | U11 Orange |
| Shaun       | Michaels | U9 Yellow  |
| Matt        | Petersen | U11 Orange |
| Harry       | Dackers  | U9 Yellow  |
| Daniel      | Mitchell | U9 Yellow  |
+-------------+----------+------------+
7 rows in set (0.00 sec)

mysql> 
```

我在脑海中想象的结果是这样的：

```
+----------+-----------------+----------------+-----------------+----------------+----------------+-------------------+
| ParentID | ParentFirstName | ParentLastName | PlayerFirstName | TeamName       | PlayerLastName | GuardianHomePhone |
+----------+-----------------+----------------+-----------------+----------------+----------------+-------------------+
|        8 | Gregory         | Peck           | Michael         | U10 Red        | Peck           | 034871234         |
|        9 | Laura           | Peck           | Michael         | U10 Red        | Peck           | 034871234         |
|       10 | Martha          | Petersen       | Matt            | U11 Orange     | Petersen       | 034724321         |
|       10 | Martha          | Petersen       | Christopher     | U10 Red        | Petersen       | 034724321         |
|       11 | Chris           | Michaels       | Richard         | U11 Orange     | Michaels       | 034791212         |
|       11 | Chris           | Michaels       | Shaun           | U9 Yellow      | Michaels       | 034791212         |
|       12 | Nadine          | Michaels       | Richard         | U11 Orange     | Michaels       | 034791212         |
|       12 | Nadine          | Michaels       | Shaun           | U9 Yellow      | Michaels       | 034791212         |
|       13 | Barry           | Dackers        | Harry           | U9 Yellow      | Dackers        | 034871996         |
|       14 | Kevin           | Mitchell       | Daniel          | U9 Yellow      | Mitchell       | 034742886         |
|       15 | Rebecca         | Mitchell       | Daniel          | U9 Yellow      | Mitchell       | 034742886         |
+----------+-----------------+----------------+-----------------+----------------+----------------+-------------------+ 
```

如果有人可以帮助我，我将不胜感激。对于那些想要使用数据测试查询的人，我已将架构 (DDL) 和数据 (DML) 脚本（放在一个“粘贴”中）放在[http://pastebin.com/S4iJyJUh](http://pastebin.com/S4iJyJUh)上。

另外，如果有人认为有更好的方法可以查看视图，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T00:21:23.057

你快到了，你只需要结合这两个查询。

```
CREATE VIEW phonelistWithTeams AS
SELECT parent.parentID AS ParentID,
  ParentPerson.firstName AS ParentFirstName,
  ParentPerson.lastName AS  ParentLastName,
  ChildPerson.firstName AS PlayerFirstName,
  ChildPerson.lastName AS  PlayerLastName,
  team.teamName AS TeamName,
  GuardianHomePhone.homeNumber AS GuardianHomePhone
FROM parent
  JOIN player ON (parent.parentID IN (player.motherID, player.fatherID))
  JOIN person AS ParentPerson ON (ParentPerson.personID = parent.parentID)
  JOIN person AS  ChildPerson ON (ChildPerson.personID = player.playerID)
  JOIN addressDetails AS GuardianHomePhone ON (GuardianHomePhone.personID = parent.parentID)
  JOIN teamAllocation ON (ChildPerson.personID = teamAllocation.playerID)
  JOIN team ON (teamAllocation.teamID = team.teamID); 
```

跑步`SELECT * FROM phonelistWithTeams`会给你

```
+----------+-----------------+----------------+-----------------+----------------+------------+-------------------+
| ParentID | ParentFirstName | ParentLastName | PlayerFirstName | PlayerLastName | TeamName   | GuardianHomePhone |
+----------+-----------------+----------------+-----------------+----------------+------------+-------------------+
|        8 | Gregory         | Peck           | Michael         | Peck           | U10 Red    | 034871234         |
|        9 | Laura           | Peck           | Michael         | Peck           | U10 Red    | 034871234         |
|       10 | Martha          | Petersen       | Matt            | Petersen       | U11 Orange | 034724321         |
|       10 | Martha          | Petersen       | Christopher     | Petersen       | U10 Red    | 034724321         |
|       11 | Chris           | Michaels       | Richard         | Michaels       | U11 Orange | 034791212         |
|       11 | Chris           | Michaels       | Shaun           | Michaels       | U9 Yellow  | 034791212         |
|       12 | Nadine          | Michaels       | Richard         | Michaels       | U11 Orange | 034791212         |
|       12 | Nadine          | Michaels       | Shaun           | Michaels       | U9 Yellow  | 034791212         |
|       13 | Barry           | Dackers        | Harry           | Dackers        | U9 Yellow  | 034871996         |
|       14 | Kevin           | Mitchell       | Daniel          | Mitchell       | U9 Yellow  | 034742886         |
|       15 | Rebecca         | Mitchell       | Daniel          | Mitchell       | U9 Yellow  | 034742886         |
+----------+-----------------+----------------+-----------------+----------------+------------+-------------------+ 
```

# ruby-on-rails - 敏捷 Web 开发 w/ Rails (4th e) 购物车问题

> ID：10508158
> 
> 赞同：0
> 
> 时间：2012-05-08T23:59:27.487
> 
> 标签：ruby-on-rails, controller, functional-testing, cart, nomethoderror

我正在阅读 Agile Web Dev w/Rails 书（第 4 版），但我完全陷入困境……我在 Mac OSX 上运行 Rails 3.2.3。我在**任务 D-3：添加一个按钮**.... 它从测试开始：功能在本章末尾不起作用...它给了我一个错误说：

```
Can't Mass assign protected attributes: product 
```

我遵循了这里给出的建议：[http ://forums.pragprog.com/forums/148/topics/10565](http://forums.pragprog.com/forums/148/topics/10565)

并将我在 Line_Items_Controller 中的代码行更改为

```
@line_item = @cart.line_items.build
@line_item.product = product 
```

这是我当前的 Line_Items_Controller 创建方法的样子：

```
# POST /line_items

def create
@cart = current_cart
product = Product.find(params[:product_id])
@line_item = @cart.line_items.build
@line_item.product = product

respond_to do |format|
  if @line_item.save
    format.html { redirect_to(@line_item.cart,
      :notice => 'Line item was successfully created.') }
    format.xml  { render :xml => @line_item,
      :status => :created, :location => @line_item }
  else
    format.html { render :action => "new" }
    format.xml  { render :xml => @line_item.errors,
      :status => :unprocessable_entity }
  end
end
end 
```

现在我收到了这个奇怪的信息：

```
NoMethodError in LineItemsController#create undefined method `product=' for   <LineItem:0x000001024f7fb0> 
```

这是我的 LineItem 模型

```
 class LineItem < ActiveRecord::Base
  attr_accessible :cart_id, :product_id, :product
end 
```

我现在不确定该怎么做，因为我是一个完全的 Rails (& Ruby) 新手。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T15:50:53.653

将原始代码行更改 `@line_item = @cart.line_items.build(product: product)`为`@line_item = @cart.line_items.build(:product_id => product.id)`in`line_items_controller.rb`为我解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T16:44:50.743

就我而言，LineItem attr_accessible 中有：product_id：

```
attr_accessible :cart_id, :product_id 
```

所以我将构建属性中的 :product => product 更改为 :product_id => product.id 并且它可以工作。

```
@line_item = @cart.line_items.build(:product_id => product.id) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T17:04:01.313

如果您希望书中的示例完全按照他们输入的方式工作，请转到 models/line_item.rb 并添加 attr_accessible 使其看起来像这样；

```
attr_accessible :cart_id, :product_id, :product 
```

高兴。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T03:21:01.307

您的订单项模型与 Product 没有`ActiveRecord`关联。我不确定您在构建什么，但我认为您会想要：

```
#lineitem
belongs_to :produce

#product
has_many :line_items 
```

您还需要将 product_id 添加到您的订单项表中。

# ios - IOS：视图控制器的自定义转换

> ID：10508164
> 
> 赞同：0
> 
> 时间：2012-05-09T00:00:09.370
> 
> 标签：ios, uiviewcontroller, transition

我的应用程序中有这段代码可以为视图控制器进行转换

```
SecondViewController *second = [[SecondViewController alloc]initWithNibName:@"SecondViewController" bundle:nil];
    [self.view addSubview:second.view];
    [second.view setFrame:CGRectMake(320, 0, 320, 480)];

    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:0.40]; //the double represents seconds
    [UIView setAnimationDelegate:self];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseOut];
    [second.view setFrame:CGRectMake(0, 0, 320, 480)];
    [UIView commitAnimations]; 
```

它工作正常；但在第二个视图控制器中，我有这段代码可以让这个视图控制器消失

```
[UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:0.40]; //the double represents seconds
    [UIView setAnimationDelegate:self];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseOut];
    [self.view setFrame:CGRectMake(320, 0, 320, 480)];
    [UIView commitAnimations]; 
```

它工作正常，但是释放它的方法是什么，我在哪里可以释放我调用它时分配的这一秒？如果我写 [self.view removeFromSuperView]?? 发布了吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:05:36.233

您需要将其从 superView 中删除，然后释放您在代码中分配的 SecondViewController。

```
SecondViewController *second = [[SecondViewController alloc]initWithNibName:@"SecondViewController" bundle:nil]; 
```

所以既然你拥有这个对象，你需要释放它。因此，在隐藏第二个视图并将其从 superView 中删除后，您需要释放它...

```
[second release]; 
```

# javascript - 防止javascript函数意外使用全局窗口

> ID：10508166
> 
> 赞同：0
> 
> 时间：2012-05-09T00:00:15.800
> 
> 标签：javascript

如果我想创建一个具有两个属性的 javascript“类”，我可能会执行以下操作：

```
var Person = function (firstName, lastName) {
    this.firstName = firstName;
    this.lastName = lastName;
}; 
```

然后我可以按如下方式创建一个新人：

```
var p = new Person("John", "Doe");
console.log(p.firstName + " " + p.lastName); 
```

在这一点上，一切都很好。但是，如果有人意外（或故意）调用以下命令：

```
Person("Mary", "Smith"); // without "new" 
```

突然之间，`firstName`并且`lastName`是全局窗口上下文的一部分，并且可能会搞砸整个页面。

```
console.log(window.firstName); // logs "Mary" 
```

在构建“类”时，有没有一种好的方法可以防止这种情况发生`Person`？显然，如果有人想在 javascript 中破坏某些东西，他们可以做到，但我只是在寻找最佳实践。

我可以在班级的顶部抛出这样的东西，但我不知道这是否是一个好的答案：

```
if (this === window) {
    console.log("You are fail");
    return;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T00:05:50.307

你可以检查一下是否`this`是`instanceof Person`

```
var Person = function (firstName, lastName) {
    if (!(this instanceof Person))
        throw "Person constructor called without \"new\"."
    this.firstName = firstName;
    this.lastName = lastName;
}; 
```

* * *

或者让它适当地调用构造函数。

```
var Person = function (firstName, lastName) {
    if (!(this instanceof Person))
        return new Person(firstName, lastName)
    this.firstName = firstName;
    this.lastName = lastName;
}; 
```

* * *

另一种可能性是让您的函数在严格模式下运行。这将导致`this`在`undefined`那种情况下，导致 TypeError，但仅在受支持的实现中。

```
var Person = function (firstName, lastName) {
    "use strict";
    this.firstName = firstName;
    this.lastName = lastName;
}; 
```

# r - R线性回归中的RandomForest尾部mtry

> ID：10508168
> 
> 赞同：6
> 
> 时间：2012-05-09T00:00:22.283
> 
> 标签：r, statistics, regression, random-forest

我正在使用 R 中的 randomForest 包（R 版本 2.13.1，randomForest 版本 4.6-2）进行回归，并注意到我的结果存在显着偏差：预测误差取决于响应变量的值。高值预测不足，低值预测过高。起初我怀疑这是我的数据的结果，但以下简单示例表明这是随机森林算法固有的：

```
n = 50; 
x1 = seq(1,n) 
x2 = matrix(1, n, 1)
predictors = data.frame(x1=x1, x2=x2)
response = x2 + x1
rf = randomForest(x=predictors, y=response)
plot(x1, response)
lines(x1, predict(rf, predictors), col="red") 
```

毫无疑问，树方法在线性方面有其局限性，但即使是最简单的回归树，例如 R 中的 tree()，也不会表现出这种偏差。我无法想象社区不会意识到这一点，但没有发现任何提及，它通常是如何纠正的？感谢您的任何评论

编辑：这个问题的例子是有缺陷的，请参阅堆栈交换中的“RandomForest for regression in R - response distributiondependent bias”以获得改进的处理[https://stats.stackexchange.com/questions/28732/randomforest-for-regression -in-r-response-distribution-dependent-bias](https://stats.stackexchange.com/questions/28732/randomforest-for-regression-in-r-response-distribution-dependent-bias)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T01:29:35.867

您发现的并不是随机森林中的固有偏差，而只是未能正确调整模型上的调整参数。

使用您的示例数据：

```
rf = randomForest(x=predictors, y=response,mtry = 2,nodesize = 1)
plot(x1, response)
lines(x1, predict(rf, predictors), col="red") 
```

![在此处输入图像描述](../Images/592bcba25239971bed762e319a691d36.png)

当然，对于您的真实数据，改进不太可能如此明显，而且我敢打赌，您会`nodesize`比`mtry`（`mtry`这里的大部分工作）获得更多的里程。

常规树没有表现出这种“偏差”的原因是，默认情况下，它们会搜索所有变量以获得最佳分割。

# jquery - jQuery在应用类之前计算高度

> ID：10508172
> 
> 赞同：0
> 
> 时间：2012-05-09T00:00:53.790
> 
> 标签：jquery, css

我试图让 jQuery 计算元素的高度，然后添加一个类，我将使用它在 CSS 中将元素的高度设置为 0px。

我的问题是 jQuery 没有以正确的顺序进行这些计算。这就是我希望发生的事情......

```
$(document).ready(function(){
  elementHeight = $('div#test').outerHeight(true); // Calculate the height of the element before we do anything else
}, $('div#test').addClass('zeroheight')); // Once we've calculated add a CSS class 
```

的CSS...

```
#test {
  height: 0;
} 
```

现在，假设自然元素高度为 300px - 变量 elementHeight 应该返回 300px 正确，因为我只是在 addClass 执行后应用一个类来更改高度？

但它返回的是 0px 。

在我添加一个类以将高度设置为 0 之前，有人可以给我一个关于如何获得 300px 值作为计算的解决方案吗？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T00:06:43.470

```
$(document).ready(function(){
     var elementHeight = $('#test').height();
     $('#test').addClass('zeroheight');
}); 
```

[小提琴](http://jsfiddle.net/adeneo/AGfwJ/1/)

# .net - 你能得到一个剪辑控件的可见区域的大小吗？

> ID：10508179
> 
> 赞同：8
> 
> 时间：2012-05-09T00:02:37.037
> 
> 标签：.net, winforms, graphics, controls, bounds

有没有办法在 WinForms 中获取剪辑控件的可见部分的大小？

一个很简单的例子：在窗体上放置一个控件，并使窗体宽度小于控件宽度。你如何获得控件可见区域的宽度？在这种情况下，您可以使用表单的 ClientSize，但并不总是那么简单。

一个更复杂（和真实）的例子：我有一个 AutoSize 设置为 true 的标签，它可以增长到超出其包含控件的宽度，导致它被剪裁。当这种情况发生时，我需要知道。这并不像比较标签的宽度与其容器的宽度那么简单，因为容器也可能有 AutoSize = true 并且也会被裁剪。

目前我的方法是沿着容器树向上走，直到找到一个 AutoSize = false 的容器，并获得它的宽度。我还必须考虑每个容器的填充。但这仅考虑控件被其容器或其容器的容器等裁剪。如果有问题的控件或任何容器被具有更高 Z 顺序的同级控件裁剪，则它将不起作用。我怀疑还有其他方法可以轻松打破这种方法。

将标签 AutoSize 更改为 false 不是一种选择。标签位于设置为 AutoSize 的 UserControl 上，因此当标签增长时，UserControl 也会随之增长。在不使用 AutoSize 的情况下让它工作很痛苦。

我尝试使用的东西，但没有成功：

`Control.ClientSize`, `Control.ClientRectangle`, `Control.PreferredSize`, `Control.CreateGraphics().VisibleClipBounds`.

我已经玩了一点图形类，但我在那里过头了。`Graphics.VisibleClipBounds`听起来很有希望，但似乎总是返回与提到的其他大小属性相同的值。

这特别适用于 WinForms。如果仅此而已，我会对 ap/invoke 解决方案感到满意。

在发布之前，我确实做了详尽的搜索。类似的问题都没有帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T07:38:33.357

您可以为此使用 Control.ClientRectangle。您需要做的是在上树时获取每个控件的屏幕边界，并计算交点。

它会是这样的：

```
Control c = myControl;
var rect = c.RectangleToScreen(c.ClientRectangle);
while (c != null) {
    rect = Rectangle.Intersect(rect, c.RectangleToScreen(c.ClientRectangle));
    c = c.Parent;
}
rect = myControl.RectangleToClient(rect); 
```

现在这应该对您有用，但是为了解决您决定何时绘制椭圆的问题，我建议改为引入更好的控件大小。如果每个控件的大小适当，通常会更好，以便它需要的所有信息都是它自己的大小来决定如何绘制它的内容。

您描述的问题是典型的自动尺寸方案。您希望它自动调整大小，但在容器太小时也受到限制。我尽量避免自动调整大小，而是通过覆盖 OnSizeChanged 来使用 Dock 属性和自定义布局登录。不过，这可能会或可能不会满足您的需求。

# wordpress - podscms 如何选择要使用的模板页面以及如何在更多模板页面中进行选择

> ID：10508180
> 
> 赞同：0
> 
> 时间：2012-05-09T00:02:39.377
> 
> 标签：wordpress, templating, podscms

我正在使用 podscms 创建数据库站点。

我想创建两个不同的 wp 模板用于详细信息和列表 Pods 页面，以便我可以加载一些特定的脚本和代码。

但我真的不明白 Pods 以何种方式选择可用于 pods 页面的主题模板。

我在 21 岁的儿童主题中创建了一个名为 pods.php 的页面。pods.php 模板由 page.php 使用 pods_content() 而不是循环复制。

如果我在 pods 页面设置中保留 --Page Template-- 选择不变，则会自动选择 pods.php 模板。

我想了解 Pods 如何选择要使用的页面模板以及如何创建两个页面以供选择（例如 pods-list.php 和 pods-detail.php）以及如何在 --Page Template- 中显示它们- 选择。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T04:05:00.587

Pod 页面模板的下拉列表由您当前主题文件夹中的模板填充，这些模板包含：/* 模板名称：您的 Pod 描述 */

如果您创建了一个新模板，但它没有出现在列表中，请单击 Admin 侧边栏中的 Pods 按钮，它将重新加载列表。确保在重新加载之前保存所有活动的 pod 页面、模板或帮助程序。

# c# - 如何确保列表 仅包含序列中的每个字符串一次

> ID：10508183
> 
> 赞同：7
> 
> 时间：2012-05-09T00:02:50.903
> 
> 标签：c#, linq

假设我有一个字符串列表，如下所示：

```
var candidates = new List<String> { "Peter", "Chris", "Maggie", "Virginia" }; 
```

现在我想验证另一个`List<String>`，我们称之为它`list1`，包含这些候选人中的每一个恰好一次。简洁地说，我该怎么做？我想我可以使用`Intersect()`. 我也想得到失踪的候选人。

```
private bool ContainsAllCandidatesOnce(List<String> list1)
{
     ????
}

private IEnumerable<String> MissingCandidates(List<String> list1)
{
     ????
} 
```

顺序无所谓。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T00:11:01.080

这在速度方面可能不是最佳的，但是两个查询都足够短，可以放在一行中，并且很容易理解：

```
private bool ContainsAllCandidatesOnce(List<String> list1)
{
    return candidates.All(c => list1.Count(v => v == c) == 1);
}

private IEnumerable<String> MissingCandidates(List<String> list1)
{
    return candidates.Where(c => list1.Count(v => v == c) != 1);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T00:58:12.620

在这里，我们谈论的是[except](http://msdn.microsoft.com/en-us/library/bb300779.aspx)、[Intersect](http://msdn.microsoft.com/en-us/library/bb460136.aspx)和[Distinct](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.distinct.aspx)。我本可以使用带有表达式的 Lamba 运算符，但它必须遍历每个项目。该功能可通过预定义的功能获得。

**对于您的第一种方法**

```
var candidates = new List<String> { "Peter", "Chris", "Maggie", "Virginia" };

private bool ContainsAllCandidatesOnce(List<String> list1)
{
    list1.Intersect(candidates).Distinct().Any();
} 
```

这将给出 list1 中候选列表中常见的任何元素，或者您可以以其他方式执行此操作

```
candidates.Intersect(list1).Distinct().Any(); 
```

**对于你的第二种方法**

```
private IEnumerable<String> MissingCandidates(List<String> list1)
{
    list1.Except(candidates).AsEnumerable();
} 
```

这将从 list1 中删除候选中的所有元素。如果你想要它的另一种方式，你可以做

```
candidates.Except(list1).AsEnumerable(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T14:14:22.193

GroupJoin 是适合这项工作的工具。来自[msdn](http://msdn.microsoft.com/en-us/library/bb534297.aspx)：

> GroupJoin 产生分层结果，这意味着来自外部的元素与来自内部的匹配元素的集合配对。GroupJoin 使您能够将结果基于外部每个元素的一整套匹配。
> 
> 如果给定的外部元素在内部没有相关元素，则该元素的匹配序列将为空，但仍会出现在结果中。

因此，GroupJoin 将为源中的每个项目从目标中找到任何匹配项。如果在目标中未找到匹配项，则不会过滤源中的项目。相反，它们被匹配到一个空组。

```
Dictionary<string, int> counts = candidates
 .GroupJoin(
   list1,
   c => c,
   s => s,
   (c, g) => new { Key = c, Count = g.Count()
 )
 .ToDictionary(x => x.Key, x => x.Count);

List<string> missing = counts.Keys
  .Where(key => counts[key] == 0)
  .ToList();

List<string> tooMany = counts.Keys
  .Where(key => 1 < counts[key])
  .ToList(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-09T00:12:55.870

这应该非常有效：

```
IEnumerable<string> strings  = ...

var uniqueStrings = from str in strings
                    group str by str into g
                    where g.Count() == 1
                    select g.Key;

var missingCandidates = candidates.Except(uniqueStrings).ToList();
bool isValid = !missingCandidates.Any(); 
```

1.  过滤掉重复。
2.  确保所有候选人都出现在过滤出的集合中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-09T01:51:52.140

使用 HashSet 代替 List 怎么样？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-09T00:09:27.433

```
 private bool ContainsAllCandidatesOnce(List<String> list1)
    {
        return list1.Where(s => candidates.Contains(s)).Count() == candidates.Count();
    }

    private IEnumerable<String> MissingCandidates(List<String> list1) 
    {
        return candidates.Where(s => list1.Count(c => c == s) != 1);
    } 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-05-10T03:08:37.887

```
private static bool ContainsAllCandidatesOnce(List<string> lotsOfCandidates)
{
    foreach (string candidate in allCandidates)
    {
        if (lotsOfCandidates.Count(t => t.Equals(candidate)) != 1)
        {
            return false;
        }
    }

    return true;
}

private static IEnumerable<string> MissingCandidates(List<string> lotsOfCandidates)
{
    List<string> missingCandidates = new List<string>();

    foreach (string candidate in allCandidates)
    {
        if (lotsOfCandidates.Count(t => t.Equals(candidate)) != 1)
        {
            missingCandidates.Add(candidate);
        }
    }

    return missingCandidates;
} 
```

# java - 多少个 GWT 服务

> ID：10508185
> 
> 赞同：0
> 
> 时间：2012-05-09T00:03:12.290
> 
> 标签：java, gwt, service, rpc, modularity

启动一个新的 GWT 应用程序并想知道我是否可以从某人的经验中获得一些建议。

我需要通过 RPC 服务获得大量服务器端功能……但我想知道在哪里划清界限。

我可以为每个小调用提供服务，或者我可以提供更少的服务来处理更多的操作。

假设我有客户、供应商和管理服务。我可以为每个类别中的每个功能制作 3 项服务或一项服务。

我注意到许多服务实现不提供编译时帮助，有时很难上手，但它提供了良好的模块化。当我有一个更大的服务时，我没有我所描述的模块化，但我不必解决服务创建问题并减少我的 web.xml 文件中的条目。

使用大量服务是否存在资源问题？确定使用何种粒度级别的最佳实践是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T08:58:05.950

在我看来，你应该为“合乎逻辑”的事情提供 rpc 服务。在你的例子中：

一个给客户，另一个给供应商，第三个给管理员

这样，您可以按含义对多个服务进行分组，并且您将在 web.xml 文件中维护几行代码（这是一个好消息 :-)

更严重的是，rpc 服务通常是调用数据库内容的包装器，因此，您甚至可以使用单个 web.xml 条目和数千个操作创建单个“MagicBlackBoxRpc”！

但是像你建议的那样，为管理操作制作一个单独的 rpc 似乎是一件好事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T08:59:53.877

阅读关于“一个班级应该有多大？”的一般建议，这可以在任何体面的软件工程书籍中找到。

在我看来：

一类 = 一个主题（即相关的一组功能或行为）

一个课程不应该处理一个以上的主题。例如：

类 PersonDao -> 主题：数据库和 Java 代码之间的接口。

它不会： - 缓存 Person 实例 - 自动更新字段（例如，更新字段“lastModified”） - 查找数据库

为什么？

因为对于所有这些其他事情，会有其他课程在做！分别： - PersonDao 周围的缓存与信息的有效存储有关，以避免不必要地频繁访问 DB - 使用 DAO 的 Service 类负责修改需要自动修改的任何内容。- 查找数据库是 DataSource 的责任（通常是 Spring 等框架的一部分），您的 Dao 不应该担心这一点。这不是它的主题的一部分。

TDD 就是答案

当您进行 TDD（测试驱动开发）时，对这种分离的需求变得非常清楚。尝试对单个类执行各种操作的不良代码进行 TDD！你甚至不能从一个单元测试开始！所以这是我最后的提示：使用 TDD，它会告诉你一个类应该有多大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-19T09:01:28.410

我认为要优化的是你可以在服务器的一次往返中完成一个结果。我在我的服务对象上有一个特别的方法集合，用于客户端在必须完成某事时发现自己所处的每种情况。当用户坐在那里等待时，您不希望客户端连续多次 RPC 到服务器。

REST 使事物正交，但正交性是有代价的：语言中经常使用的动词是不规则的，这是有原因的。在为您的应用程序维护干净的正交结构方面，请确保您的架构设计良好。这就是每个类应该具有与其他类的语义正交的语义。当每个 RPC 调用的语义可以在模式中清晰地表述时，就不会混淆它们的含义，即使它们不是 REST 完全理想的。

# html - 如何设置 HTML 表格单元格以继承其大小？

> ID：10508188
> 
> 赞同：2
> 
> 时间：2012-05-09T00:03:25.957
> 
> 标签：html, css

我在表格中有一个高度/宽度为 100% 的图像。我定义了表格大小，但在我定义 TD 大小之前它不起作用。如何让 TD 继承表格大小，这样我就不必在 CSS 中复制大小？

[http://jsfiddle.net/CgEhg/](http://jsfiddle.net/CgEhg/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T00:10:07.287

```
.g {
  width:40px;
  height:40px;
}

img {
  height:inherit;
  width:inherit;
}

td, tr, tbody {
  height:inherit;
  width:inherit;
}
```

```
<table class="g" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td><img src="http://www.google.com/logos/2012/stgeorge12-hp.png"></td>
  </tr>
</table>

<div class="g"><img src="http://www.google.com/logos/2012/stgeorge12-hp.png"></div>
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T01:02:55.670

除了上面的例子，设置 100% 以便表格根据其内容自动拉伸。

```
 table
    {
        width:40px;
        height:40px;
    }

    td,tr,tbody
    {
        height:100%;
        width:100%;
    } 
```

# php - 具有动态内容的网站上的 PHP

> ID：10508194
> 
> 赞同：0
> 
> 时间：2012-05-09T00:05:11.520
> 
> 标签：php, voting

到目前为止，我已经制作了一个连接到 MYSQL 数据库的网站。在网站上我有很多按钮，每个按钮对应于我数据库中的一个表。当我单击按钮时，一个 javascript 函数会以这种形式打开我的 php 文件

> xmlhttp.open("GET", "addPoint.php?q=" + name, true); 其中 name 是表的名称

回到html。我有一个带有 ID 的 div，它将随着 PHP 的任何回声而更新。

div 现在填充了表，反映了 mysql 中的表。这一切都很好。

这就是问题所在：我正在尝试实现一个投票系统，您可以通过单击新创建的表格的一个元素来投票。AFAIK MYSQL 更新需要进行投票才能工作，需要在 PHP 中完成，这意味着我需要告诉 PHP 文件

> 1.  表的名称
> 2.  元素的名称

我不愿意使用表格，因为我只想能够点击一些文本，而不必填写表格或点击单选按钮。

那么如何将这 2 位信息获取到 PHP 文件中呢？我正在做的结构有什么好处，还是我应该退后一步重新设计？

感谢阅读，如果我有歧义，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:12:20.297

熟悉[JQuery](http://api.jquery.com/)。非常适合此类项目。

[http://www.w3schools.com/jquery/default.asp](http://www.w3schools.com/jquery/default.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T00:13:10.770

正如 Norse 已经提到的，使用 javascript 为您提交“表单”请求。javascript 可以根据单击的按钮为您填充表格和元素值。这是否是 GET/POST 取决于您。

JQuery 将是帮助简化此过程的好方法，但如果您不想要它，则不需要它。

# javascript - 这个javascript函数可能吗？

> ID：10508209
> 
> 赞同：1
> 
> 时间：2012-05-09T00:06:45.223
> 
> 标签：javascript

调试时，我经常写类似的东西，`console.log("foo:"+foo+", bar:"+bar)`是否可以编写一个`logValues(foo,bar)`给出相同输出的函数？本质上，我在问是否有办法从一个变量转到该变量的名称。我是否必须仅使用产生的索引来设置参数数组的循环 `[0]: 'value of foo, [1]: 'value of bar'`

谢谢阅读

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T00:10:49.253

试试这个代码：

```
var logValues = function(){
    var args = arguments;
    for(var i in args)
        window.console.log(args[i] + ": " + eval(args[i]));
}
logValues("foo","bar"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T00:18:56.567

（这些选项都没有直接回答这个问题；但应该为您尝试做的事情提供更好的选择）

**WebKit 的检查器（我假设是 Firebug）允许您记录复杂类型，根本不需要编写帮助程序！**

只要`console.log(foo, bar)`你准备好了。或者`console.log({foo: foo, bar: bar})`，如果您想要输出中的变量名称。

![](../Images/4ec9be635a18237fe19c0ed343f70eec.png)

**备选答案：**

您可能会考虑一个只获取一个对象并将其吐出的助手——它不会节省太多（如果有的话）打字；但会导致更易读的代码与记录的输出非常接近。

```
window.logValues = function(values) {
  var k, v;
  var pairs = [];

  for (k in values) {
    v = values[k];
    pairs.push("" + k + ": " + v);
  }

  console.log(pairs.join(", "));
}; 
```

然后你这样称呼它：

```
logValues({foo: 1, bar: "asdf"}) 
```

你看到的：

```
foo: 1, bar: asdf 
```

**选项#3：**

或者一个更简洁的例子，它可能会去掉比你喜欢的更多的类型信息：

```
window.logValues = function(values) {
  console.log(JSON.stringify(values));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T00:16:01.253

```
function logValue(foo)
{
    console.log(foo + ": " + eval(foo));
}

var foo = "something";
logValue("foo"); 
```

这将起作用，但您必须确保您的 foo 变量在 logValue 函数中可用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-22T23:20:25.027

我使用两个数组将所有数据存储在：

```
data=[];
names=[];
foo=1;
data[1]="foovalue"; 
names[1]="foo";

bar=2;
data[bar]=28;
names[bar]="bar"; 
```

等等，我在项目中使用的所有全局值接下来你可以编写如下代码

```
data[foo]=data[foo] + data[bar];
data[bar]=data[bar]+22;

function log(a,b){
//something like
var=text;
text=names[a] + " = " + data[a];
text=text + linebreak + names[b] + " = " + data[b];
} 
```

你也可以用它来写html；

```
function writedataval(arrnumber){
  document.getElementById(names[arrnumber] ).innerHTML =  data[arrnumber] ;
}

writedataval(foo); 
```

必须有一个 id="foo" 的标签才能成功运行此代码

我认为这种方法在很多方面都非常有益，因为您还可以使用数组索引来访问 data 和 name 。

# google-drive-api - 用户如何禁用应用程序的谷歌驱动器访问？

> ID：10508212
> 
> 赞同：3
> 
> 时间：2012-05-09T00:07:14.673
> 
> 标签：google-drive-api

为了使 google drive api 调用正常工作，用户必须通过 Chrome Web Store 安装该应用程序。我想知道如何撤消此过程以进行测试。我尝试卸载我们的 CWS 应用程序，但驱动 api 调用仍然正常。除了卸载必要的应用程序之外，还有其他步骤吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T02:20:00.693

您可以通过“轮子”右上角的菜单 > 管理应用程序... > 选项 > 删除此应用程序从 Drive 卸载应用程序。

如果您只想再次测试身份验证流程（您知道第一次打开或新建时会通过 OAuth 2 授权屏幕），您可以转到以下页面[https://accounts.google.com /IssuedAuthSubTokens](https://accounts.google.com/IssuedAuthSubTokens)。它允许您撤销对应用程序的 OAuth 访问权限，如果您在下次打开或新建时撤销对应用程序的访问权限，您将再次通过 OAuth 2 授权屏幕。

（非常有用，因为只有在您第一次交换身份验证码时，您才会获得刷新令牌）

我通常会在后期进行开发，这比卸载+重新安装应用程序更容易。

# ruby-on-rails - 会话不保存变量

> ID：10508215
> 
> 赞同：1
> 
> 时间：2012-05-09T00:07:51.797
> 
> 标签：ruby-on-rails, session, session-variables

我正在使用 Ruby on Rails，由于某种原因，当我尝试在会话中存储哈希时，它不会跨页面传输，但是测试变量会。代码如下：

```
class HomeController < ApplicationController
require 'read_file'

def index
    session[:test] = 1
end

def uploadDictionary
    #post = ReadFile.read(params['dictionary'])
    file = params['dictionary']
    wordHash = Hash.new(0)

    file.read.each_line  do |line|
        wordHash[line.downcase] = line.downcase
        #session[:hmm] = line
        #puts session[:hmm]
    end

    #wordHash.each { |key, value| puts key + ' = ' + value + "\n" }     
    session[:storedDictionary] = wordHash
    #session[:storedDictionary].each { |key, value| puts key + ' = ' + value + "\n" }
    puts session[:test]
    redirect_to :action => "index"
end

def checkWord
    session[:storedDictionary].each { |key, value| puts key + ' = ' + value + "\n" }
    #puts session[:storedDictionary].key(params[:submittedWord].downcase)
    puts session[:test]
    render :text => "woot"
end
end 
```

问题是 session[:storedDictionary] 不能在uploadDictionary 和checkWord 中自我维护，我希望有人能给我一些建议。谢谢。更新以显示我的视图代码：

```
<h1>Home#index</h1>
<p>Find me in app/views/home/index.html.erb</p>

<%= form_tag({:action => :uploadDictionary}, :multipart => true) do %>
  <%= file_field_tag 'dictionary' %>
  <%= submit_tag "Upload" %>
<% end %>
<br>
<br>
<%= form_tag("/checkWord", :method => 'get') do %>
  <%=  text_field_tag 'submittedWord' %>
  <%= submit_tag "checkWord" %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:19:41.503

您可能需要创建会话数据库并启用会话。看到这个问题：

[Rails 会议当前实践](https://stackoverflow.com/questions/2588241/rails-sessions-current-practices-especially-for-rails-3)

# javascript - 我可以以某种方式加速这个 $.post 回调吗？

> ID：10508217
> 
> 赞同：1
> 
> 时间：2012-05-09T00:08:11.143
> 
> 标签：javascript, jquery, facebook-graph-api

在发布数据后，我`$.post`在下面使用回调来重定向页面。有时页面重定向很快，但有时可能需要 3-5 秒。

我是新手，所以不知道为什么要花这么长时间。是在等待php结束吗？这里有什么我可以改变以加快速度吗？

另一方面...`encodeURIComponent`似乎不起作用。URL 中总是有一个空格，比如`?fbname=John Doe" which I am trying to remove with`encodeURIComponent`

谢谢！

```
FB.api('/me', function(response) {
                 $.post("addtodb.php", 
                 {fbname:response.name},
                    function(data) {
                    window.location.href = "step2.php?fbname="+encodeURIComponent(response.name); //redirect after post callback
                 })
            }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T00:11:24.330

如果您使用的是 Firebug 或 Google Chrome 内置工具等工具，您可以查看网络活动。这将使您了解滞留的位置。等待时间可能是由于服务器的响应能力，甚至是您的 JavaScript 中的某些东西。

**示例：** 我可以在我的个人网站上看到 Facebook 的 like.php 的传输时间相当慢.. [http://i.imgur.com/pApRt.png](http://i.imgur.com/pApRt.png)

# iphone - 如何知道我的 Xcode iPhone 项目是否使用 ARC？

> ID：10508228
> 
> 赞同：33
> 
> 时间：2012-05-09T00:09:28.693
> 
> 标签：iphone, xcode, automatic-ref-counting

我想知道我的 Xcode iPhone 项目是否使用 ARC，但我不记得在创建项目时是否勾选了该框。

我怎样才能得到这些信息？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-05-09T00:14:55.277

选择您的项目，然后选择**Build Settings**。在**Apple LLVM 编译器 - 语言**部分中查找**Objective-C 自动引用计数。**确保选择目标；虽然您可以在项目中设置它，但目标可以覆盖它。

 **（您也可以使用构建设置中的搜索栏`OBJC_ARC`。）

还要记住，您可以在构建阶段基于每个文件打开或关闭 ARC。

或者，只是在代码中尝试这样的事情：

```
[[[NSObject alloc] init] autorelease] 
```

如果您收到错误消息：

```
ARC forbids explicit message send of 'autorelease' 
```

然后你正在使用ARC。

您还可以通过检查源代码文件来要求 ARC：

```
#if !__has_feature(objc_arc)
#error This file must be built with ARC.
// You can turn on ARC for only this file by adding -fobjc-arc to the build phase.
#endif 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-05-09T00:19:08.627

只需在目标的构建设置中搜索**自动：**

![在此处输入图像描述](../Images/61dff5fd5f3eae76b780cdd409cb362b.png)**

# javascript - 使用 Javascript 解析 XML 并从检索到的值创建对象

> ID：10508230
> 
> 赞同：1
> 
> 时间：2012-05-09T00:09:40.367
> 
> 标签：javascript, xml, dom, xml-parsing

我正在尝试解析 XML 文档，但我对如何处理它有点困惑。例如下面显示了我的 XML 文档

```
<document>
    <object name="Customer" type="class" x="137" y="63">
        <attributes>
        </attributes>
        <methods>
        </methods>
    </object>
    <object name="Item" type="class" x="539" y="275">
        <attributes>
        </attributes>
        <methods>
        </methods>
    </object>
    <link start="Customer" end="Item" type="generalization" />
</document> 
```

在我的情况下，我需要遍历每个“对象”并创建一个对象，在我的应用程序中，这很简单：`objectArray.push(new uml_Class(name));`.

现在我将如何遍历`<object>`文档上的每个，然后将其名称值插入到数组中？

我读过`getElementsByTagName()`要使用该功能，但这对我不起作用：

```
alert(documentXML);
var root = documentXML.getElementsByTagName('Object'); 
```

它确实在`documentXML`变量中提醒我的 XML，但随后 firebug 告诉我以下内容： `documentXML.getElementsByTagName is not a function`

我将如何循环通过 XML 文档，反复制作对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T00:13:44.763

您可能对 jQuery 的内置[XML 解析功能](http://papermashup.com/parse-xml-with-jquery/)感兴趣。

示例（从链接借来）：

```
$(document).ready(function () {
    $.ajax({
        type: "GET",
        url: "books.xml",
        dataType: "xml",
        success: xmlParser
    });
});

function xmlParser(xml) {

    $('#load').fadeOut();

    $(xml).find("Book").each(function () {

        $(".main").append('<div class="book"><div class="title">' + $(this).find("Title").text() + '</div><div class="description">' + $(this).find("Description").text() + '</div><div class="date">Published ' + $(this).find("Date").text() + '</div></div>');
        $(".book").fadeIn(1000);

    });

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T00:18:23.123

因为它是一个 XML 文档，所以标签名称*不是*大小写不变的。

```
var objects = documentXML.getElementsByTagName('object'); 
```

应该管用。[`document.getElementsByTagName()`](https://developer.mozilla.org/en/DOM/document.getElementsByTagName)在所有 Document 对象上都可用，我担心您错过了使用[`DOMParser`](https://developer.mozilla.org/en/DOMParser).

# jquery - 使用 Ajax 加载 XML 文件。在 IE 和 Safari 中成功。奇怪的 Firefox 行为

> ID：10508235
> 
> 赞同：0
> 
> 时间：2012-05-09T00:10:20.447
> 
> 标签：jquery, xml, ajax, firefox, xml-parsing

一段时间以来一直在关注这个网站上的帖子，发现它们非常有帮助。这是我的第一篇文章，所以请多多包涵。

我正在使用 ajax 加载 XML 文件（加载后我正在使用 jquery 处理信息）。它包含我用来构建缩略图、图片库和幻灯片的信息。但是 xml 文件似乎没有在 firefox 中加载。IE 和 Safari 这样做没有问题，所以我有点卡住了。我还没有测试过 chrome 或 opera，因为它们不允许本地 xml。

问题是，问题只是发生了，因为我更改了 xml 文件的位置。它曾经与我放置 ajax 命令的 javascript 文件位于同一文件夹中。所以以下在 IE Safari**和**Firefox 中运行良好：

```
$.ajax({
    type: 'GET',
    url: 'projects.xml',
    dataType: 'xml',
    success: parseXML
}); 
```

现在 xml 位于一个单独的文件夹中，Firefox 仅在我通过链接导航到 html 文件时才加载它（通过地址栏导航到 html 文件或刷新导致 firefox 不加载 xml）。所以我怀疑 Firefox 的“../”表达式有问题。这是真的？这仅仅是离线工作的问题吗？这是我现在使用的代码：

```
$.ajax({
    type: 'GET',
    url: '../xml/projects.xml',
    dataType: 'xml',
    success: parseXML
}); 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T01:43:53.367

在使用 file:// URI 时，Firefox 将树上更高的目录中的文件视为不同源。这是为了防止本地 HTML 文件从您的硬盘读取任意数据。

所以是的，这是由于您使用了 .. 并且只有当您使用 file:// URI 时才会出现问题。

# c - Typedefs 和 printf 格式说明符

> ID：10508236
> 
> 赞同：12
> 
> 时间：2012-05-09T00:10:34.330
> 
> 标签：c, typedef, format-specifiers

typedefs 的一个常见用途是使变量的“类型”能够更好地传达变量用途的概念，而无需重新定义其背后的存储结构。

但是，我也将 typedef 视为一次性更改一类变量的存储结构的一种方式。

例如，如果我定义

```
typedef uint32_t my_offset_t 
```

并且有 type 的变量，`my_offset_t`将代码库从`uint32_t`to切换到`char`or`uint64_t`就像更改一行并重新编译一样简单（假设我使用`sizeof`了而不是硬编码的大小），*除了 printf / scanf 的情况*。

有没有一种方法可以根据类型以某种简单的方式交换格式说明符，而无需`printf`/ `scanf`、 if-elses 或 ifdefs 周围的包装函数？

谢谢！

*对于任何感兴趣的人，我正在修改一个使用 16 位偏移量的 LKM 以使用 32 位偏移量，但希望它能够在必要时以最小的更改进入 64 位（或其他！）偏移量。*

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-09T00:49:32.993

这是一项棘手的业务，但`<inttypes.h>`来自 C99 及更高版本的代码显示了实现此目的的方法。

对于您定义的每个类型，您需要为自己提供一组适当的“PRI”和“SCN”宏，注意避免标准化的命名空间。

例如，您可以使用 XYZ 作为项目特定的前缀，并生成：

```
XYZ_PRIx_my_offset_t
XYZ_PRId_my_offset_t
XYZ_PRIX_my_offset_t
XYZ_PRIu_my_offset_t
XYZ_PRIo_my_offset_t 
```

和 SCN 等价物。此外，您将根据基本类型的等效宏来定义这些，因此：

```
#define XYZ_PRIx_my_offset_t PRIx32
#define XYZ_PRId_my_offset_t PRId32
#define XYZ_PRIX_my_offset_t PRIX32
#define XYZ_PRIu_my_offset_t PRIu32
#define XYZ_PRIo_my_offset_t PRIo32 
```

在您的代码中，您使用`XYZ_PRIx_my_offset_t`宏构建格式字符串：

```
printf("Offset: 0x%.8" XYZ_PRIX_my_offset_t "\n", my_offset_value); 
```

如果您随后需要将所有内容更改为 64 位，则适当地编辑 typedef 和宏定义，其余代码保持“不变”。如果你真的很小心，你可以非常接近完全不变。

确保在设置了很多警告的 32 位和 64 位系统上进行编译。GCC 不会警告您当前平台上的非问题，但它们可能会出现在另一个平台上。（我刚刚修复了一些在 64 位上干净但在 32 位上不干净的代码；它现在使用类似宏`XYZ_PRId_int4`而不是`%d`并且在两者上都可以干净地编译。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-09T00:13:47.620

如果您查看我[之前关于 inttypes.h 的问题，](https://stackoverflow.com/questions/6299323/good-introduction-to-inttypes-h)您可以看到系统定义的格式说明符如何与 typedefs 一起使用（通过`#define`）为您的自定义类型制作自定义打印说明符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T02:26:33.850

另一种解决方案是`intmax_t`为有符号类型和`uintmax_t`无符号类型相互转换。例如：

```
printf("%ju\n", (uintmax_t)n); 
```

如果`n`是任何无符号类型，则将正常工作。

对于这些`*scanf()`功能，您必须读入一个临时对象然后分配。

（这假设您的运行时库支持这些功能。）

# php - 我用 PHP 准备的语句 SQL 查询有问题

> ID：10508237
> 
> 赞同：-5
> 
> 时间：2012-05-09T00:10:46.750
> 
> 标签：php, sql, statements

我得到错误：

注意：未定义变量：第 18 行 C:\xampp\htdocs\sqltest.php 中的 db

致命错误：在第 18 行调用 C:\xampp\htdocs\sqltest.php 中非对象的成员函数 prepare()

我使用了此代码中的代码[如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/best-way-to-stop-sql-injection-in-php)

我对 PDO 之类的东西完全陌生，在我的 apache 服务器上它使用的是 php 5.3。

我只是对此进行测试，我知道我没有使用良好的编码习惯。

我的代码：

```
 $con = mysql_connect("localhost","root","") or die('error');
    mysql_select_db("safe",$con);

    if(isset($_POST['lastinput'])){
    $prepared = $db->prepare('SELECT * FROM data WHERE last = :last');
    $prepared->execute(array(':last' => $_POST['lastinput']));

    $rows = $prepared->fetchAll();
    echo $rows['first'];
    }
    mysql_close($con); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T00:14:40.380

使用的示例`$db->...`是使用已*建立的 PDO 连接*。您没有建立 PDO 连接，因此也永远不会创建变量`$db`。请从手册开始：http: [//php.net/manual/en/pdo.connections.php](http://php.net/manual/en/pdo.connections.php)

# ubuntu - 更新后wkhtmltopdf字体大小增加

> ID：10508243
> 
> 赞同：5
> 
> 时间：2012-05-09T00:11:20.447
> 
> 标签：ubuntu, debian, wkhtmltopdf

我刚刚将 wkhtmltopdf 从 0.9.9 更新到 0.11.0 rc1（下载了二进制文件，然后移至 /usr/bin/wkhtmltopdf-new 中的 /usr/bin/wkhtmltopdf 来自存储库的那个）

如果我运行 /usr/bin/wkhtmltopdf-new 我会得到非常大的字体作为结果/如果我运行 /usr/bin/wkhtmltopdf 我会得到正常的结果。

使用相同 HTML 的示例 这是一个 0.9.9 [http://dl.dropbox.com/u/1990697/0.9.9.pdf](http://dl.dropbox.com/u/1990697/0.9.9.pdf) 的文档 具有 0.11.0 rc1 的相同文档[http://dl.dropbox.com/ u/1990697/0.11.0.pdf](http://dl.dropbox.com/u/1990697/0.11.0.pdf)

我想达到 0.9.9 的结果

有任何想法吗？

干杯...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T17:15:15.800

显然，[这是 QT 的一个问题，可能需要一段时间才能解决](http://code.google.com/p/wkhtmltopdf/issues/detail?id=72#c101)。

一种解决方法是[使用 OTF 格式字体](http://chmielot.blogspot.de/2010/10/font-problems-with-wkhtmltopdf.html)。

```
@font-face {
    font-family: 'mysans';
    src: url(/path/to/myfont.otf);
} 
```

最后，[还有一个在线服务可以将 TTF](http://www.freefontconverter.com/)字体转换为 OTF 字体。

因此，目前最好的解决方法似乎是：将您的字体作为 TTF，使用上述服务将其转换为 OTF，然后按照上面的说明使用它。

在一个应用程序中，我既向浏览器提供 HTML，又将其呈现为 PDF。在这种情况下，我使用一些服务器端逻辑来生成一个带有 WOFF 的 Web 字体标签以传递给浏览器，以及一个带有 OTF 的 Web 字体标签来传递给 wkhtmltopdf。

OTF 字体起作用的原因是它们或多或少地嵌入在 PDF 中，并且[QT 错误与将非 OTF 字体渲染到 PDF](https://bugreports.qt-project.org/browse/QTBUG-4974)中有关。

# mysql - 在 MYSQL 中加载 csv 文件组并保留关系，即使每个组上的 id 开始相同

> ID：10508255
> 
> 赞同：0
> 
> 时间：2012-05-09T00:12:44.277
> 
> 标签：mysql, sql, csv

我有几组 CSV 文件需要放入 mysql 数据库。CSV 如下：

Products（它有一个 product_id） ShippingDetails（通过 product_id 与产品 csv 文件相关） Categories（通过 product_id 与产品 csv 文件相关）

我有 3 组这些文件

Group1: Products1.csv, ShippingDetails1.csv, Categories1.csv Products2.csv, ShippingDetail2.csv, ... ...

每个组上的文件都与 product_id 关联。

问题是我想加载数据库中的所有文件组，但是 product_id 的 id 在每个组上从 0 开始。所以我需要一种方法来更改 id，以便它对所有产品都是唯一的，无论它来自什么 csv 文件。此外，当所有数据都被带到一个表中时，我需要更改每个组上的关系（外键）以使它们与新的唯一 ID 匹配。在实际场景中，我有一堆表，它们都与每个组的 product_id 相关。所以我想知道 MySQL 是否可以在旅途中修复关系，或者最好的方法是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T03:15:41.010

我不确定 MySQL 是否可以为您做到这一点，但可以通过一个简单的脚本来完成。例如在 PHP 中，假设数据库中的 products 和 shipping_details 表为空：

```
$group_count = 3;

mysql_connect(DB_HOST, DB_USER, DB_PASS);
mysql_select_db(DB_NAME);

for ($max_product_id = 0, $group = 1; $group <= $group_count; $group++)
{
    // create temporary tables
    mysql_query("CREATE TABLE products_tmp LIKE products");
    mysql_query("CREATE TABLE shipping_details_tmp LIKE shipping_details");

    // load data from csv files
    mysql_query("LOAD DATA INFILE 'Products$group.csv' INTO TABLE products_tmp");
    mysql_query("LOAD DATA INFILE 'ShippingDetails$group.csv' INTO TABLE shipping_details_tmp");

    // update unique ids
    mysql_query("UPDATE products_tmp SET product_id = product_id + $max_product_id");
    mysql_query("UPDATE shipping_details_tmp SET product_id = product_id + $max_product_id");

    // insert into final tables
    mysql_query("INSERT INTO products SELECT * FROM products_tmp");
    mysql_query("INSERT INTO shipping_details SELECT * FROM shipping_details_tmp");

    // drop temporary tables
    mysql_query("DROP TABLE products_tmp");
    mysql_query("DROP TABLE shipping_details_tmp");

    // get max product_id to update next group of data
    list($max_product_id) = mysql_fetch_row(mysql_query("SELECT MAX(product_id)+1 FROM products"));
} 
```

此代码的逻辑是将第一组数据插入表中，获取最大 product_id + 1，然后在插入下一组数据之前将该数字添加到每个 product_id。这样 product_id 将始终是唯一的，并且关系将保持不变。在示例代码中，我只使用了 2 个表格，但您可以将其扩展到您需要的表格数量。

**笔记：**

*   从 csv 文件（使用 LOAD DATA INFILE...）加载数据时，您应该给出文件的绝对路径。我没有这样做以保持代码更清洁。
*   我使用了旧的 mysql 函数，因为它很容易编写，但是对于生产代码，最好使用 PDO 之类的东西。

# javascript - 原语作为 javascript 中的函数参数

> ID：10508260
> 
> 赞同：3
> 
> 时间：2012-05-09T00:13:08.197
> 
> 标签：javascript

我在这里学习 JS，并且对作为参数传入时的原始值有疑问。假设我有一个简单的功能：

```
var first = 5;
var second = 6;

function func(){
    first+=second;
}
func();
alert(first); //outputs 11 
```

所以在这种情况下，first 的值变为 11.. 但是如果我通过将 first 作为参数传递给函数来尝试它，first 仍然是 5..

```
var first = 5;
var second = 6;

function func(first){
    first+=second;
}
func(first);
alert(first); //outputs 5 
```

想知道是否有人可以向我解释这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T00:16:40.763

发生这种情况是因为当您`function first()`不带参数调用时，它使用全局变量“first”。但是当你调用时`function first(first)`，你对浏览器说现在 first 是一个局部变量（仅在函数内部）并且它不会对全局 var 进行任何更改`first`。这是代码：

```
var first = 5;
var second = 6;
function func(first){
    first += second; //Local var "first" + global var "second"
    alert(first); //Local var, outputs 11
}
func(first);
alert(first); //Global var, outputs 5 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T00:16:27.087

由于 Javascript 的作用域，作用域变量`first`首先覆盖全局变量。换句话说，您将添加`second`到函数内部的作用域版本`first`（它是作用域的，因为您在函数内部声明它），并且全局版本`first`不受影响。

如果您`first`从函数中删除 ' 声明，则 Javascript 将使用`first`它可以找到的下一个版本——在这种情况下，是全局版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T00:17:10.623

```
var first= 5;
var second= 6;

function func(first){

first+=second; // change the local first variable

}
func(first);
alert(first);//outputs 5 - the outer variable wasn't changed. 
```

* * *

```
var first= 5; // global var
var second= 6;

function func(){ // first wasn't defined in the inner scope.

first+=second; // change the global bar

}
func();
alert(first);//outputs 11 - the outer variable was changed. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T07:21:55.043

Mark Linus 的回答是对的，但我想补充一点。JavaScript 中的原始值总是按值传递，而数组和对象总是按引用传递。例子：

```
var first = [ 'a', 'b' ];

function func( arr ) {
    arr.push( 'c' );
}

func( first );

alert( first.join( ',' )); // output is 'a,b,c' 
```

如果您在对象或数组中有对象，它会变得更加复杂。请记住，更改将影响程序中的所有实例。

# php - PHP中是否保留了“句柄”一词？

> ID：10508263
> 
> 赞同：0
> 
> 时间：2012-05-09T00:13:33.970
> 
> 标签：php

在我的 php 代码中，我正在编写一个类来创建日志文件，因此必须使用文件。我想将变量 $handle 存储为一个字段，但是当我将其称为 $this->handle 时，“handle”会改变颜色，以表明它可能是一个保留术语。

我查看了 php 手册以及其他一些在线资源，但没有发现任何地方说它实际上是保留的。有人可以帮我解决这个问题吗？

谢谢你的帮助。

干杯!

- - - - - - - 编辑 - - - - - - - -

![越来越近了……截图取自 BBEdit，文件扩展名为 .php](../Images/ebe923f6a3b92c6ee7782e7020b0dc30.png)

看起来它将句柄识别为至少 3 个静态方法……仍然不确定“K”字的含义。钥匙？

![我正在使用代码的实际类的屏幕截图](../Images/1ba5e0ba86f4825e0fcc660fd59fb3f7.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T00:14:47.477

它不仅没有保留，而且调用资源 ID 等也是一种常见约定`$handle`。事实上，您可以在整个 PHP 文档中找到它。例如，[fopen](http://us3.php.net/manual/en/function.fopen.php)。

# recursion - 如何去掉左递归

> ID：10508273
> 
> 赞同：5
> 
> 时间：2012-05-09T00:15:29.750
> 
> 标签：recursion, antlr, antlr3, left-recursion

我想制作一个允许柯里化函数调用的语法。

那是：

```
a() /// good
a()() /// good
a()()() /// good
a(a) /// good
a(a()()) /// good
/// etc 
```

我的第一个刺是这样的：

```
ID  :   ('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*;

fncall  :   expr '(' (expr (',' expr)*)? ')';

expr    :   ID|fncall; 
```

但是由于左递归而失败。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T17:52:07.207

假设`(a)()`也是有效的，这是解决这个问题的一种方法：

```
grammar T;

options {
  output=AST;
}

tokens {
  EXPR_LIST;
  CALL;
  INDEX;
  LOOKUP;
}

parse
 : expr EOF -> expr
 ;

expr
 : add_expr
 ;

add_expr
 : mul_exp (('+' | '-')^ mul_exp)*
 ;

mul_exp 
 : atom (('*' | '/')^ atom)*
 ;

atom
 : fncall
 | NUM
 ;

fncall
 : (fncall_start -> fncall_start) ( '(' expr_list ')' -> ^(CALL $fncall expr_list)
                                  | '[' expr ']'      -> ^(INDEX $fncall expr)
                                  | '.' ID            -> ^(LOOKUP $fncall ID)
                                  )* 
 ;

fncall_start
 : ID
 | '(' expr ')' -> expr
 ;

expr_list
 : (expr (',' expr)*)? -> ^(EXPR_LIST expr*)
 ;

NUM : '0'..'9'+;
ID  :  ('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*; 
```

从上面的语法生成的解析器将解析输入：

```
(foo.bar().array[i*2])(42)(1,2,3) 
```

并构造以下 AST：

![在此处输入图像描述](../Images/43cb17e646f276073eaa7abeb495f371.png)

如果没有树重写规则，语法将如下所示：

```
grammar T;

parse
 : expr EOF
 ;

expr
 : add_expr
 ;

add_expr
 : mul_exp (('+' | '-') mul_exp)*
 ;

mul_exp 
 : atom (('*' | '/') atom)*
 ;

atom
 : fncall
 | NUM
 ;

fncall
 : fncall_start ( '(' expr_list ')' | '[' expr ']' | '.' ID )* 
 ;

fncall_start
 : ID
 | '(' expr ')'
 ;

expr_list
 : (expr (',' expr)*)?
 ;

NUM : '0'..'9'+;
ID  :  ('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*; 
```

# c# - 使用 xpath 选择部分 xml

> ID：10508274
> 
> 赞同：0
> 
> 时间：2012-05-09T00:15:56.167
> 
> 标签：c#, xml, xpath

我在服务器上有一个大的 xml 文件。但是，我需要该 xml 文件的一部分，以便可以将其绑定到 XMLDATASOURCE。这是我的 xml 文件的一部分：

```
 <Item Text="Reports" Navigateurl ="Reports/Default.aspx">
          <Group>
             <Item Text="Customers" NavigateUrl="Reports/Customers/Default.aspx">
                      <Group>
                             <Item ... />
                              <Item.. />
                                ..... 
                       </Group>
            </Item> 
```

通过这种方式，我在组标签中有项目。所以，现在我有一个 xml 数据源，我稍后将它绑定到 RadSiteMap。这是我用 C# 编写的代码：

```
 XmlDataSource XmlDataSource1 = new XmlDataSource();
          XmlDataSource1.DataFile = "~/Menu.xml";
          XmlDataSource1.XPath = "//Item[@Text='Customers']";
          XmlDataSource1.DataBind();
           SiteMap1.DataBind();
        SetSiteMapLevel();

           <asp:XmlDataSource ID="XmlDataSource1" runat="server"  
            DataFile="~/Menu.xml"></asp:XmlDataSource>
           <telerik:RadSiteMap runat="server" ID="SiteMap1" DataSourceID="XmlDataSource1"  
              OnNodeDataBound="SiteMap1_NodeDataBound" ShowNodeLines="true"> 
```

它工作正常，但它以这种方式显示：

```
 Customer
            group 
              ItemName1
               .......... 
```

但是，我不希望出现组标签。可以对 xml 文件进行更改，但我只想查找是否有任何方法可以使组标签不出现。请让我知道解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:34:32.133

Try using this XPath it should work fine

```
XmlDataSource1.Xpath = "//Item[@Text='Customers']/Group"; 
```

This should give you what is inside the group tag customers

# javascript - 使用 MouseOver 和 MouseOut

> ID：10508282
> 
> 赞同：0
> 
> 时间：2012-05-09T00:17:34.680
> 
> 标签：javascript, jquery, html

大家好，我在我的第一个网站上工作，我正在尝试使用`jquery`.

这是迄今为止得到的：

```
 <a href="javascript:void(0);"onmouseover="ShowBox();" onmouseout="HideBox();"">Show box<a>
         <script type="text/javascript">
         function ShowBox()
         {
           $("#SlideMenu").slideDown();   
         }
         function HideBox()
         {
           $("#SlideMenu").slideUp();
         }
         </script> 
```

当我将鼠标悬停在控件上时，我的菜单会向下滑动，但会自动向上滑动。我想要的是让用户有时间从菜单中选择和选项，如果他没有，我希望在鼠标离开控件后立即关闭菜单。

知道为什么这不起作用吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T00:27:13.663

在没有内联 JS 的情况下做你的事情，并记住关闭`<a>`元素并使用准备好的函数

```
<a id="test">Show box</a>

<script type="text/javascript">
   $(document).ready(function() {
      $("#test").on({
          mouseenter: function() {
             $("#SlideMenu").slideDown();
          },
          mouseleave: function() {
             $("#SlideMenu").slideUp();
          },
          click: function(e) {
             e.preventDefault();
          }
      });
   });
</script> 
```

[小提琴](http://jsfiddle.net/adeneo/66NwJ/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T00:22:00.143

当您使用 jQuery 时，我相信使用类似以下内容对您会有所帮助：

```
$("#box").hover(
   function() {
      //.stop() to prevent propagation
      $(this).stop().animate({"bottom": "200px"}, "fast");                   
   },
   function() {
      $(this).stop().animate({"bottom": "0px"}, "fast");                  
   }
); 
```

这意味着当鼠标悬停在菜单上时，菜单将保持在其打开位置。当鼠标退出菜单时，它会关闭。显然更改 id 和动画 CSS 值以满足您的需要 :)！

**这是一个工作示例：http:** [//jsfiddle.net/V3PYs/1/](http://jsfiddle.net/V3PYs/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T00:35:32.197

这里真的没有问题 - 脚本完全按照您的指示执行。但是，据我了解，*如果*用户的鼠标现在位于菜单上方，则当您离开“触发器”元素时，您*想要*菜单保持打开状态。试试这个：

 *```
<script type="text/javascript">
var timeout=250;//timeout in milliseconds to wait before hiding the menu
var menuMouseout;
$(document).ready(function() {
    $("#trigger").hover(function(){
        $("#SlideMenu").slideDown();
    }, function(){
        menuMouseout=setTimeout("$('#SlideMenu').slideUp();", timeout);
    });

    $("#SlideMenu").hover(function(){
        clearTimeout(menuMouseout);
    }, function(){
        menuMouseout=setTimeout("$('#SlideMenu').slideUp();", timeout);
    });
});
</script> 
```

这样，用户在将鼠标移出触发元素后会离开一段时间才能进入菜单。您可能需要摆弄超时，但这应该可行。我对此进行了测试，似乎可以正常工作。如有必要，请确保将其包装起来`$(document).ready`以确保所有元素都已加载并准备就绪。

演示：[http ://www.dstrout.net/pub/menu.htm](http://www.dstrout.net/pub/menu.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T00:21:51.107

如果您使用的是 jQuery，这将是正确的方法：

```
<a href="#" id="showBoxHref">Show box</a>

<script type="text/javascript">
    $("#showBoxHref").hover(function() {
        $(this).slideDown();
    }, function() {
        $(this).slideUp();
    });
</script> 
```

（只需复制/粘贴它就可以了）*

# math - Haskell 二进制 div 二进制

> ID：10508288
> 
> 赞同：0
> 
> 时间：2012-05-09T00:19:03.140
> 
> 标签：math, haskell, binary, char

我正在编写一个程序，它将十进制数、字符、字符串转换为二进制数并使用它们。但我被卡住了，因为我想把 Bin 分开。像这样的东西：

```
 11010110110000
/ 10011
  --------------
= 01001110110000 
```

所以新数字将是 1001110110000 / 10011 ......直到最后一个结果。

这是我的代码：

```
import Data.Char (ord)
import Data.List

toBinary :: Int -> [Int]
toBinary 0 = []
toBinary x = reverse (kisegf x)

kisegf 0 = []
kisegf x | x `mod` 2 == 1 = 1 : kisegf (x `div` 2)
         | x `mod` 2 == 0 = 0 : kisegf (x `div` 2)

chrToBinary :: Char -> [Int]    
chrToBinary x 
                |length (toBinary (ord x)) == 8 = (toBinary (ord x)) 
                |otherwise = take (8-(length (toBinary (ord x))))[0,0..] ++ (toBinary (ord x))

strToBinary :: String -> [Int]
strToBinary [] = []
strToBinary (x:xs) = [l | l <- chrToBinary x] ++ strToBinary xs

bxor :: [Int] -> [Int] -> [Int]
bxor [] [] = []
bxor (x:xs) (y:ys)
            |length (x:xs) == length (y:ys) && (x /= y) = 1 : bxor xs ys
            |length (x:xs) == length (y:ys) && (x == y) = 0 : bxor xs ys
            |length (x:xs) < length (y:ys) && (x /= y) = 1 : bxor (take (length (y:ys)-(length (x:xs)))[0,0..] ++ xs) ys
            |length (x:xs) < length (y:ys) && (x == y) = 0 : bxor (take (length (y:ys)-(length (x:xs)))[0,0..] ++ xs) ys
            |length (x:xs) > length (y:ys) && (x /= y) = 1 : bxor xs (take (length (x:xs)-(length (y:ys)))[0,0..] ++ ys)
            |length (x:xs) > length (y:ys) && (x == y) = 0 : bxor xs (take (length (x:xs)-(length (y:ys)))[0,0..] ++ ys)
{-this will compare 2 bin if a bigger than true else false-}
(%>=%) :: [Int] -> [Int] -> Bool
(%>=%)[] [] = True
(%>=%)[] _ = False
(%>=%)_ [] = True
(%>=%) (x:xs) (y:ys) = x==1 && y==1 && elemIndex 1 (x:xs) == elemIndex 1 (y:ys)

bmod :: [Int]{-number-} -> [Int]{-div-} -> [Int]{-result-}
bmod (x:xs) (y:ys)
            |length(x:xs) >= length(y:ys) && (take (length (y:ys)) (x:xs)) %>=% (y:ys) = ???
            |length(x:xs) >= length(y:ys) = ???
            |otherwise = (x:xs) 
```

我应该在“？？？”的地方写什么

另一个更大的例如：

```
Példa: bmod 11010110110000 10011.

       _______________
10011 ) 11010110110000
        10011,,.,,....
        -----,,.,,....
         10011,.,,....
         10011,.,,....
         -----,.,,....
          00001.,,....
          00000.,,....
          -----.,,....
           00010,,....
           00000,,....
           -----,,....
            00101,....
            00000,....
            -----,....
             01011....
             00000....
             -----....
              10110...
              10011...
              -----...
               01010..
               00000..
               -----..
                10100.
                10011.
                -----.
                 01110  
                 10011  <- bigger so cant div again
                 -----
                  1110 = what i want 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T03:37:33.477

您所写的功能不是您想要的。

```
bmod xs ys | not (xs %>=% ys) = xs
           | otherwise = ???? 
```

可能会更好。在 ???? 中，您希望从 xs 的开头获取连续数量的数字，直到找到 xs 的前缀大于 ys，然后使用递归

`bmod ((xsPrefix %-% ys)++xsSuffix) ys`

要获得 xs 的前缀，`inits`结合 with`filter`几乎是您所需要的。显然，您还需要实现一些更多的二进制函数。

您的设计的问题是，在第二种情况下，您没有什么可以递归的——您希望最终以某种方式使用第一种情况的代码，但是除了复制代码。

此外，您的`kisegf`功能可以稍微清理一下 - 为什么不

```
kisegf 0 = []
kisegf x = (x `mod` 2) : kisegf (x `div` 2) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T20:51:29.780

虽然不是您的问题的答案，但我会先保留位串 LSB，而不是 MSB 在前（即不要`reverse`在 中`toBinary`）。这样，列表索引对应于位的重要性，因此您不必担心添加前导零来对齐操作数。例如，`bxor`函数变得更加简单：

```
bxor [] bs = bs
bxor as [] = as
bxor (a:as) (b:bs) = (a `xor` b) : bxor as bs where
  a `xor` b | a /= b    = 1
            | otherwise = 0 
```

由于进位从 LSB 传播到 MSB，因此按此顺序排列位也会使加法/减法更简单：

```
badd :: [Int] {- a -} -> [Int] {- b -} -> Int {- carry-in -} -> [Int]
badd []     []     0 = []  -- no carry-out
badd []     []     1 = [1] -- carry-out
badd []     (b:bs) c = s : badd [] bs c' where (c', s) = add 0 b c -- zero-extend as
badd (a:as) []     c = s : badd as [] c' where (c', s) = add a 0 c -- zero-extend bs
badd (a:as) (b:bs) c = s : badd as bs c' where (c', s) = add a b c

add a b c = (s `div` 2, s `mod` 2) where s = a+b+c 
```

左移和右移也更简单，因为它们会影响 LSB：

```
as `rsh` n = drop n as
as `lsh` n = replicate n 0 ++ as 
```

对于有符号数，您隐含地假设最后一位无限重复。

# ruby-on-rails-3 - Rails 的 respond_to 块参数在哪里获取 xml、html、json 成员？

> ID：10508290
> 
> 赞同：0
> 
> 时间：2012-05-09T00:19:04.373
> 
> 标签：ruby-on-rails-3

生成这样的脚手架：

> rails 生成脚手架用户名：字符串电子邮件：字符串

在控制器类中创建如下所示的代码：

```
respond_to do |format|
  format.html # show.html.erb
  format.json { render json: @user }
end 
```

起初我不知道这是什么意思，所以我去寻找并找到[了这个](http://www.tokumine.com/2009/09/13/how-does-respond_to-work-in-the-rails-controllers/)，我认为这足以解释其中的大部分内容。但是格式应该最终成为一个[Responder 类](http://api.rubyonrails.org/classes/ActionController/Responder.html)。好吧，在 Responder 类中似乎没有声明任何 xml 或 html 或 json 成员。他们来自哪里？

PS：

脚手架开发人员将块参数命名为“格式”，当它最终成为响应程序时（格式信息来自 .html、.xml、.json 或其他）以使代码听起来有点像，这似乎很残忍英语，但阻碍了对实际情况的理解。其实 Responder::respond 是这样定义的，看起来太巧合了：

```
def respond
  method = "to_#{format}"
  respond_to?(method) ? send(method) : to_format
end 
```

但我看不出这里的格式（在“to_#{format}”中）如何与名为格式的块参数相关联。需要明确的是，它不是实例变量，因为它缺少 @ 符号，对吧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T04:21:50.060

正如博客稍后解释的那样，**Responder 实例基本上从这里通过 method_missing 处理 .html 和 .xml，这取决于您的 rails 应用程序可以处理的 mime 类型。** 描述 method_missing 的不错的博客之一是[这里](http://www.trottercashion.com/2011/02/08/rubys-define_method-method_missing-and-instance_eval.html)。
基本上，响应者的 method_missing 将在调用 js 和 json 方法时被调用。responder 类的method_missing 将获取“缺失的method_name”（即:js 或:json 符号）作为其第一个参数，这将驱动其渲染逻辑。

# wpf - 如何知道何时在 UserControl 上调用了命令？

> ID：10508304
> 
> 赞同：0
> 
> 时间：2012-05-09T00:19:57.783
> 
> 标签：wpf, silverlight

在执行特定的 ICommand 后，我需要对控件做一些视觉效果。例如，我的自定义控件公开了 AAACommand 和 BBBCommand 属性。

```
<myControl AAACommand={Binding ACommand}
           BBBCommand={Binding BCommand} /> 
```

其中 ACommand 和 BCommand 是 ViewModel 上的命令。我怎么知道 AAACommand 何时执行，所以我可以在我的 UserControl 中做一些 UI 工作？没有 ICommand 订阅的 Executed 事件。

**编辑：** AAACommand 在我的用户控件上定义如下：

```
public static readonly DependencyProperty AAACommandProperty =
        DependencyProperty.Register("AddCommand", typeof(RelayCommand), typeof(MyCustomControl), null);

public static readonly DependencyProperty AAACommandParameterProperty =
        DependencyProperty.Register("AAACommandParameter", typeof(object), typeof(MyCustomControl), null);

public RelayCommand AAACommand
{
    get { return (RelayCommand)GetValue(AAACommandProperty); }
    set { SetValue(AAACommandProperty, value); }
}

public object AAACommandParameter
{
    get { return (object)GetValue(AAACommandParameterProperty); }
    set { SetValue(AAACommandParameterProperty, value); }
} 
```

因此，在 ViewModel 上调用 ACommand 没有问题，这没有问题。问题是我的用户控件将如何知道 AAACommand 何时执行 ACommand，以便它可以对其 UI 执行某些操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T12:07:12.770

您想根据视图模型返回的响应和执行的命令来更新用户控件吗？我问了一个性质类似的问题，我想将字符串值从一个用户控件传递到另一个用户控件。我使用 INotifyProperty Changed 事件完成了此操作。[您可以在此处](https://stackoverflow.com/questions/6115994/passing-a-string-from-one-user-control-to-a-second-user-control-via-inotify-wiht)阅读原始问题和解决方案

**更新评论：**

根据您的评论，似乎可能会发生两件事之一。如果您不需要 VM 响应，则可以由视图中的元素触发更新。您可以使用 Binding ElementNameProperty 来做到这一点。这实质上允许您根据另一个元素的操作触发/更改属性。（在一个字段中键入文本会在另一个控件中显示该值）[这是 msdn 描述和示例](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.elementname.aspx)。

如果您需要根据返回（即成功或失败）调用它，那么 ViewModel 将需要一个属性（如布尔值），该属性以双向方式绑定到 ui 中元素的属性。您可能需要创建一个转换器（继承[IValueConverter](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx)）来处理绑定，但 INotifyProp Change 将用于编组控件之间的更新或其中的绑定元素。

这是一个简单的例子：

在我的 xaml 中，我添加了一个用户控件，在单击辅助用户控件中的另一个按钮之前，我不想在 UI 中显示该控件。为了处理这个问题，我在 Visibility 属性上设置了绑定

```
<ctrl:LandingPage x:Name="ucLandingPage"
                                  Grid.Row="1" 
                                  DataContext="{Binding}"  
                                  Visibility="{Binding LandingPageVisibility, Mode=OneWay, Converter={StaticResource LandingPageVisibilityConverter}}"/> 
```

在视图模型中，我有以下属性和代码

```
// Default ctor
        public SearchViewModel()  
        {
            //Show that the Landing Page control is being displayed
            SearchVisibility = Visibility.Collapsed;
} 
```

VM 中的属性（注意我使用 SimpleMVVM 框架，它在基础对象中包含了 Inotify，所以我的 notify prop 事件可能看起来与你的有点不同）

```
 private Visibility _SearchVisibility;
            public Visibility SearchVisibility
            {
                get { return _SearchVisibility; }
                set
                {
                    _SearchVisibility = value;
                    NotifyPropertyChanged(m => m.SearchVisibility);
                }
            } 
```

然后更新此属性的 VM 中的方法

```
 public void GetSearchResult()
        {
            currentPage = 1;
            //Set the visibility of the search control in the center of the page
            SearchVisibility = Visibility.Visible;
            this.SearchHistory = this._DataModel.AddSearchHistoryItem(this.SearchTerm);
        } 
```

最后是转换器类，它将返回值转换为元素的正确属性值

```
 public class SearchVisibilityConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            if (value != null & System.Convert.ToString(value) == "Visible")
            {
                return Visibility.Visible;
            }
            else
            {
                return Visibility.Collapsed;
            }
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    } 
```

# php - Gettext 有时有效

> ID：10508305
> 
> 赞同：3
> 
> 时间：2012-05-09T00:20:41.827
> 
> 标签：php, translation, gettext

我正在做一个项目，我需要为它进行用户翻译。所以我决定在 php 中使用 gettext 但它有时会起作用。

所以我有一个名为 lng 的文件夹，在这个文件夹中我有一个 php 文件，它调用我的 lang 文件来翻译我的页面。

这是代码：

```
<?php
if(isset($_GET['lang']) != '')
{
    setcookie('lang',$_GET['lang'], time() + 365*24*3600, null, null, false, true);
    $_SESSION['lang'] = $_GET['lang'];
    $language = $_GET['lang'];
}
else if(isset($_SESSION['lang']) != '' )
{
    $language = $_SESSION['lang'];
}
else if(isset($_COOKIE['lang']) != '')
{
    $_SESSION['lang'] = $_COOKIE['lang'];
    $language = $_SESSION['lang'];
}else{
    $language = 'fr';
}

  putenv("LANG=$language");
  setlocale(LC_MESSAGES, $language);

  $domain = 'trad';
  bindtextdomain($domain, 'locale/');
  textdomain($domain);
?> 
```

所以我可以检查我的 $_SESSION 和 $_COOKIE，没问题他给我 'en' 或 'fr' 但他没有翻译我的文件，我不知道为什么。

对于 lng 中的文件夹，它是：locale/en/LC_MESSAGES/trad.po（或 .mo）。我尝试使用 LC_ALL 和 LC_MESSAGES 但这不会改变结果。

我错过了什么或做错了什么吗？

非常感谢！

J。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T14:42:26.437

I've got the same problem. Restart Apache Service solved it for me

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T22:35:32.073

我遇到了同样的错误。我的情况有点不同，我开始认为它与线程有关，尽管它发生在我更改代码之后。

我有一个语言栏：

```
<?php
    include_once (dirname(__FILE__) . "/resources/config.php");
?>

<div id='language_bar'>
    <a style="margin-left:50px" href="./index.php?locale=es_ES">
        <img src='<?php echo $config['paths']['images']['lang']?>/es_ES.gif'/>
    </a>

    <a href="./index.php?locale=en_UK">
        <img src='<?php echo $config['paths']['images']['lang']?>/en_UK.gif'/>
    </a>

    <a href="./index.php?locale=de_DE">
         <img src='<?php echo $config['paths']['images']['lang']?>/de_DE.gif'/>
    </a>
</div> 
```

还有一个配置文件：

```
if (isset($_GET['locale'])) {
    $locale = $_GET['locale'];
    setcookie('locale', $locale, time() + 60 * 60 * 24 * 30);
} else {
    if(isset($_COOKIE['locale'])) {
        error_log('En _COOKIE');
        $locale = $_COOKIE['locale'];
    }
    else {
        $locale = $config['localization']['default_locale'];
        setcookie('locale', $locale, time() + 60 * 60 * 24 * 30);
    }
}

putenv("LC_ALL=$locale");
setlocale(LC_ALL, $locale);

error_log('setlocale->'.setlocale(LC_ALL, "0")." Env ->". getenv("LC_ALL"));
error_log(_("Submit")); 
```

我的主页有一些通过 jQuery 交互的 div，并在级联中重新加载。有时，其中一些（随机）给出默认字符串值。

默认情况下，它是西班牙语（es_ES），点击几下强制div刷新后，一些字符串以英文打印（en_UK原始字符串）。更重要的是。如果我切换到德语（de_DE），在第一次刷新后，我得到德语的每个字符串，gettext 开始用西班牙语重新输入字符串，过一会儿，用英语重新输入字符串。

请注意，我在 php 日志中添加了调试行。他们真的很有趣：

当事情进展顺利时：

```
[Thu May 31 00:28:51 2012] [error] [client ::1] setlocale->es_ES Env ->es_ES
[Thu May 31 00:28:51 2012] [error] [client ::1] Aplicar, referer: xxxxxxxx/index.php 
```

什么时候不要：

```
[Thu May 31 00:29:45 2012] [error] [client ::1] setlocale->es_ES Env ->es_ES, referer: xxxxxxxxx/index.php
[Thu May 31 00:29:45 2012] [error] [client ::1] Submit, referer: xxxxxxxx/index.php 
```

所以我猜这是 _() 函数失败（我总是使用别名）。为了以防万一，我在函数上循环了 10.000 次，它在翻译时给出了 10.000 次点击或 10.000 次错误，因此对于整个 http 请求它都会失败，或者没有。

我很抱歉写了这么多，但我真的很感激能帮助我指明正确的方向。（这个错误不仅发生在@我的本地主机上，也发生在我的在线测试服务器上）

¿ 可能与我为每个连接设置区域设置这一事实有关？

我的在线“游乐场”是：

Linux server8.nixiweb.com 2.6.32-71.29.1.el6.x86_64 #1 SMP Mon Jun 27 19:49:27 BST 2011 x86_64

我的服务器：

Linux filete 3.2.0-24-generic #39-Ubuntu SMP Mon May 21 16:52:17 UTC 2012 x86_64 PHP 版本 5.3.10-1ubuntu3.1

请注意，两者都是 64 位

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T01:27:16.260

你不是用windows吗？如果是这样，您必须使用[windows 语言环境名称](http://msdn.microsoft.com/en-us/library/39cwe7zf%28v=VS.71%29.aspx)。这是我在 linux 和 windows 上为我工作的课程的一部分（它只是有更多的语言环境名称选项）：

```
...
private function setLocaleByLang($lang)
{
    $map = array(
        'cs' => array('cs_CZ.UTF-8', 'cs_CZ', 'cs', 'czech'),
        'en' => array('en_US.UTF-8', 'en_US', 'en', 'english'),
        'de' => array('de_DE.UTF-8', 'de_DE', 'de', 'german'),
        'pl' => array('pl_PL.UTF-8', 'pl_PL', 'pl', 'polish'),
        'sk' => array('sk_SK.UTF-8', 'sk_SK', 'sk', 'slovak')
    );

    $locale = key_exists($lang, $map) ? $map[$lang] : $lang;
    setlocale(LC_ALL, $locale);
    putenv('LC_ALL=' . $lang); // for windows and gettext
}
... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-28T12:11:25.113

我有同样的问题。有时字符串被翻译，有时没有。我有 3 台服务器用于这个应用程序和 5 台开发人员的机器，都存在同样的问题。

我通过删除来解决它：

```
bindtextdomain("domain", "/locale"); 
```

并将 .mo 文件直接链接到 gettext 默认文件夹：

```
sudo ln -sf /myproject/locale/en/LC_MESSAGES/domain.mo /usr/share/locale/en/LC_MESSAGES/domain.mo 
```

我正在使用 Ubuntu 14.04。

# eclipse - MacOS - GoClipse GAE - “打开构建：没有这样的文件或目录”

> ID：10508307
> 
> 赞同：0
> 
> 时间：2012-05-09T00:21:30.690
> 
> 标签：eclipse, google-app-engine, compiler-errors, osx-lion, go

我最近完成了 MacOS Lion 的全新安装，但在让我的 Google App Engine Go 应用程序再次在 GoClipse 中运行时遇到问题。我已经通过 App Store、GAE Go SDK 和 Eclipse 下载了 XCode。我解压了 Eclipse 和 SDK，通过 Eclipse 菜单安装了 GoClipse，并将 6g、6l 和打包文件从 GAE/goroot/pkg/tool/darwin_amd64 移动到 GAE/goroot/bin。我已经在 Eclipse Preferences for Go 中设置了适当的目录，清理了我工作区中的所有项目，但出现了大量错误。

似乎每个包都出现“打开构建：没有这样的文件或目录”的错误。没有其他错误，只有这些错误，一遍又一遍地重复。我尝试制作一个新项目。当我添加一个空白的 .go 文件来说明它是哪个包的一部分时，出现了同样的错误。

我应该如何解决“开放构建”错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T03:28:12.757

最近尝试使用 GoClipse，我有一个模糊的记忆，您看到的错误是安装失败的遗留问题。我看到的注释说尝试删除它（字面意思是，在窗口中选择它并点击删除/退格键）；它不会像大多数其他工具一样自动消失。

此处提交了一个错误：[http ://code.google.com/p/goclipse/issues/detail?id=104](http://code.google.com/p/goclipse/issues/detail?id=104)

# xml - 反复创建对象的设计模式

> ID：10508315
> 
> 赞同：1
> 
> 时间：2012-05-09T00:22:50.177
> 
> 标签：xml, parsing

我是设计模式的新手，我有一个用例，我需要一遍又一遍地创建相同的对象。就我而言，我正在解析一个大型 XML 文件，并且我需要为每个块创建一个对象。所有对象都有相同的方法，除了存储的值不同。目前，我正在以程序方式执行此操作：创建 XML 文件的读取器，静态方法 parseEntry 获取块，并将它们解析为 POJO。我认为必须有更好的方法来做到这一点。谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T00:26:54.020

也许工厂模式会有所帮助。

[http://en.wikipedia.org/wiki/Factory_method_pattern](http://en.wikipedia.org/wiki/Factory_method_pattern)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T00:26:58.873

使用为您生成对象的[工厂模式](http://www.oodesign.com/factory-pattern.html)创建[工厂](http://en.wikipedia.org/wiki/Factory_method_pattern)类。

另一种方法是使用[复合](http://en.wikipedia.org/wiki/Composite_pattern)模式，这种模式在游戏编程中非常有用，其中使用继承会使游戏架构过于复杂并使对象彼此紧密耦合。

# c# - 像使用声卡一样从 WiFi 卡捕获原始信号

> ID：10508316
> 
> 赞同：0
> 
> 时间：2012-05-09T00:23:28.297
> 
> 标签：c#, vb.net, wifi, signal-processing, radio

是否可以像从声卡中捕获信号一样从 WiFi 卡中捕获原始信号？（我已经找到了使用声卡和绘制频谱图的代码）我想知道它会成为一个很酷的无线电类型项目。我更喜欢与 .net（VB 或 C#）完美结合的解决方案。

我的基本目标是捕捉周围的无线电波并建造一个原始的“望远镜”。使用内置计算机硬件只是完成此任务的最简单方法。如果您对如何以不同方式实现此目标有任何其他建议，请将其作为答案发布。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T01:22:00.587

查找“软件定义无线电”。它们通常是无线电电子套件或相当昂贵的硬件。您仍然需要天线。

# c - 是否有适用于 mac osx lion 上的 CUDA 的 IDE？

> ID：10508318
> 
> 赞同：5
> 
> 时间：2012-05-09T00:23:52.087
> 
> 标签：c, eclipse, cuda

我正在尝试学习 Cuda，它非常有趣，但是在没有 IDE 帮助的情况下创建代码时遇到了问题。我知道 Java/Python，但我不熟悉 C/C++，所以我一直在使用 eclipse 和 Xcode 来帮助我处理命令和查找内容（通过代码完成）。我似乎无法为 CUDA 获得这些选项？

我已经看过示例并且可以构建它们 find（nvcc 正在工作）但是没有 IDE 来帮助捕捉我的一些错误，我有点迷失在文本编辑器中编辑代码。我找到了一个用于 Eclipse 的工具包插件，但虽然它似乎已安装，但我认为它适用于较旧的 Eclipse 版本，因为说明中的大多数选项与我的版本（Indigo）不匹配。Nvidia 仅在他们的网站上有一个 Visual Studio 插件（我宁愿不在我的 Mac 上安装 Windows 来使用 Cuda）。

如果这听起来很糟糕，我很抱歉，但我很好奇人们如何在 Mac 上开发 cuda。我不在乎我使用什么 IDE，只要它可以帮助我查看选项并在我遇到语法问题等时警告我。（我不是最好的程序员，但对我来说切换 IDE 只是一个寻找的问题找出问题所在，所以我对任何解决方案都很好，只要它在我学习时对我有帮助）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:47:18.843

Nsight Eclipse Edition 作为 CUDA Toolkit 5.0 的一部分提供（无需额外下载）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T00:52:25.107

[Qt 创造者](http://qt.nokia.com/products/developer-tools/)！

您可以阅读[Qt Creator + CUDA + Linux](http://cudaspace.wordpress.com/2011/04/07/qt-creator-cuda-linux/)以获得有关如何在 Mac OS X 上设置构建环境的灵感。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T00:29:48.830

您可以考虑使用 JCuda：

[http://www.jcuda.de/](http://www.jcuda.de/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-09T01:19:09.403

有用于 CUDA 开发的 XCode 插件。我在[那里](https://code.google.com/p/beagle-lib/downloads/detail?name=NVCuda.pbplugin.zip&can=4&q=)找到的。nvidia.com上有[主要讨论](http://forums.nvidia.com/index.php?showtopic=60336&st=0)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-01-06T12:36:42.267

Visual Studio Code + 这个扩展： [https://github.com/gangliao/VS-Code-Cuda](https://github.com/gangliao/VS-Code-Cuda)。对我来说，Visual Studio Code 是我最喜欢的 IDE，适用于我在那里找到的每种语言

# javascript - jQuery 输入按钮点击事件监听器

> ID：10508319
> 
> 赞同：34
> 
> 时间：2012-05-09T00:24:45.810
> 
> 标签：javascript, jquery, button, onclick, jquery-events

jQuery的全新。我试图在我的页面上为以下控件设置事件侦听器，单击该控件时会显示警报：

```
<input type="button" id="filter" name="filter" value="Filter" /> 
```

但它没有用。

```
$("#filter").button().click(function(){...}); 
```

如何使用 jQuery 为输入按钮控件创建事件侦听器？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-05-09T00:25:26.330

首先，`button()`是一个 jQuery ui 函数，用于创建与 jQuery 核心无关的[按钮小部件，它只是设置按钮的样式。](http://jqueryui.com/button/)
因此，如果您想使用小部件，请添加 jQuery ui 的 javascript 和 CSS 文件，或者删除它，如下所示：

```
$("#filter").click(function(){
    alert('clicked!');
}); 
```

可能导致您出现问题的另一件事是，如果您没有等待输入呈现并在输入之前编写代码。jQuery 有*[ready 函数](http://api.jquery.com/ready/)*，或者它的别名`$(func)`，它在 DOM 准备好后执行回调。
用法：

```
$(function(){
    $("#filter").click(function(){
        alert('clicked!');
    });
}); 
```

因此，即使订单是这样的，它也会起作用：

```
$(function(){
    $("#filter").click(function(){
        alert('clicked!');
    });
});

<input type="button" id="filter" name="filter" value="Filter" /> 
```

[**演示**](http://jsfiddle.net/gdoron/WTzKR/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-09T00:26:12.023

```
$("#filter").click(function(){
    //Put your code here
}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-02-28T16:22:30.657

更多关于 gdoron 的回答，也可以这样做：

```
$(window).on("click", "#filter", function() {
    alert('clicked!');
}); 
```

无需将它们全部放入`$(function(){...})`

# android - 把照片贴在朋友的墙上？

> ID：10508320
> 
> 赞同：2
> 
> 时间：2012-05-09T00:24:47.407
> 
> 标签：android, facebook, facebook-graph-api

是否可以在朋友的墙上张贴图片？我正在使用这段代码：

```
Bundle postdata = new Bundle();
postdata.putString("message", msg);
postdata.putByteArray("picture", pic);
// this code, i found it in another questions but it doesn't
// seem to help much:
postdata.putString("target_id", usr);
// then i  use the Asynchronous request.
mAsyncRunner.request(usr+"/feed", postdata, "POST",new WallRequestListener(), null); 
```

其中`pic`是图片作为 byteArray 并且`usr`是朋友的 ID。它只是在朋友的墙上显示消息，但根本没有图片。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T05:42:14.070

这是我在我的应用程序中使用的。它有效。

```
protected void uploadPhoto() {
    if (!Utility.mFacebook.isSessionValid()) {
        Util.showAlert(this, "Warning", "You must first log in.");
    } else {
        if (targetUri != null) {
            Bundle params = new Bundle();
            try {
                params.putByteArray("photo", Utility.scaleImage(getApplicationContext(), targetUri));
            } catch (Exception e) {
                e.printStackTrace();
            }
            params.putString("caption", txtPhotoCaption.getText().toString());
            Utility.mAsyncRunner.request( "replace this with the users ID"+ "/photos&access_token=" + Utility.mFacebook.getAccessToken(), 
                    params, "POST", new PhotoUploadListener(), null);
            txtPhotoCaption.setText("");
            Toast.makeText(getApplicationContext(), "Photo uploaded successfully", Toast.LENGTH_SHORT).show();
            this.finish();
        }
    }
} 
```

请注意，我使用的方法与示例应用程序中使用的方法相同。没有涉及缩放或不缩放图像的利弊。“**标题**”属性是从 EditText 中提取的。实际图像位于“ **targetUri** ”字段中，该字段被声明为全局变量。它使用设备上的默认图库来获取图像。为了完整起见，这是从默认图库应用程序中获取图像的代码。（这会提示用户选择应用程序）

```
btnAddPhoto.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                Intent intent = new Intent(Intent.ACTION_PICK,
                        android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI);
                startActivityForResult(intent, 0);
            }
        }); 
```

它在`onActivityResult()`这里处理：

**注意**：*我还将 ImageView 中的选定图像设置为登录用户的预览*

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        // TODO Auto-generated method stub
        super.onActivityResult(requestCode, resultCode, data);

        Bitmap bitmap = null;
        if (resultCode == RESULT_OK)    {
            targetUri = data.getData();
            Log.e("IMG URI", targetUri.toString());
            try {
                bitmap = BitmapFactory.decodeStream(getContentResolver().openInputStream(targetUri));
                try {
                    Utility.scaleImage(getApplicationContext(), targetUri);
                    imgDisplaySelectedImage.setImageBitmap(bitmap);
                } catch (IOException e) {
                    e.printStackTrace();
                }
            } catch (FileNotFoundException e) {
                e.printStackTrace();
            }
        }
    } 
```

在我在这里发布代码作为答案之前，我再次测试了上传到朋友墙的内容。它确实有效。希望这对您也有帮助。

**编辑：**

正如最新评论中提到的，使用 Intent.ACTION_GET_CONTENT 与 onActivityResult() 下的预览图像显示效果不佳。修改代码有点工作。

我觉得奇怪的是，在“使用完成操作”弹出窗口中，我没有在我的 Galaxy S 上获得 Astro 文件管理器或画廊。它给了我文件管理器（市场外，而不是股票）和 Quickoffice Pro . 话虽如此，两者的选择仍然有效，照片仍然上传。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T06:45:30.890

根据[文档](http://developers.facebook.com/docs/reference/api/user/#photos)，图片的参数名称不是*"picture"*而是*"source"*。

所以你的代码应该是：

```
Bundle postdata = new Bundle();

postdata.putString("message", msg);
postdata.putByteArray("source", pic);

mAsyncRunner.request(usr + "/feed", postdata, "POST", new WallRequestListener(), null); 
```

# c++ - C++模板实例化，究竟是什么意思？

> ID：10508321
> 
> 赞同：3
> 
> 时间：2012-05-09T00:24:55.883
> 
> 标签：c++, templates, instantiation, tmp

现在，我对模板很熟悉，对 SFINAE 之类的东西也有些熟悉，而且我一直想知道当模板被编译器实例化时会发生什么。

当你在 TMP 中做一些事情时，比如 SFINAE，甚至是 TMP 中的简单斐波那契数列，*似乎*编译器所做的比我在*模板实例化*下理解的要多。似乎编译器正在**执行**模板代码。

**我的问题是，模板实例化**到底是什么，编译器实际执行代码的线在哪里？

编译器创建一个你的模板类型，是我对模板实例化的理解。但在 TMP 中，它的作用似乎远不止于此，这让我感到困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T00:31:45.437

最好把它想象成一堆函数，这就是它的本质。考虑一个 class `Type`，它在这里表示编译器对类型的内部表示。

```
template<typename T> class X {
    T t;
}; 
```

在运行时 C++ 中，您可以将其表示为

```
Type* X(Type *t) {
    static std::unordered_map<Type*, Type*> cache;
    if (cache.find(t) != cache.end())
        return cache[t];
    Type* ret = new Type;
    ret->DataMembers.insert("t", t);
    return cache[t] = ret;
} 
```

当然，专业化等需要一些额外的费用。但是，使用这个模型很容易做两件事。

A) 实例化模板相当于函数调用，它恰好发生在编译时，就像`constexpr`. 当然，一个聪明的编译器可能会做一些其他的优化，但在一般情况下。

B) 它如何扩展到模板提供的任何其他功能。

因为实例化模板是图灵完备的，所以您无法以其他任何方式真正处理它。编译器似乎正在执行它们的原因是因为它*是*. 它们只不过是语法错误的有限 EDSL 中的函数。

# complexity-theory - 估计 NP 问题实例的难度

> ID：10508323
> 
> 赞同：4
> 
> 时间：2012-05-09T00:25:38.797
> 
> 标签：complexity-theory, bitcoin

NP 问题看起来适合用作陷门函数或工作证明，因为它们难以解决，但易于验证。不幸的是，在对手可以控制问题选择的对抗环境中，它们似乎有点难以使用，因为虽然最坏情况问题是 NP，但可以非常快速地解决特定情况。

那么：是否有任何算法可以采用实例并估计 - 比尝试解决它们更有效 - 它们有多难或接近最坏情况？

（上下文在思考一个比特币协议，其中工作证明是可重用的，而不是无用的哈希检查。显而易见的方法是有一个中央权威问题，对于每个交易块，一个对应于现实世界的 NP 实例问题。但是中央权威可能会被颠覆，并开始发布简单的问题，这会使网络容易受到双重支出的影响。一个人可以接受来自多个权威或任何人的问题，但选择的简单问题仍然存在。如果有某种方法*估计*任何呈现给网络的问题的难度，那么“太容易”的问题可以简单地忽略，必要时退回到哈希竞赛。）

编辑：jaxtr 将我链接到[“Predicting Satisfiability at the Phase Transition”](http://www.cs.ubc.ca/~kevinlb/papers/2012-PredictingSatisfiability.pdf "徐等人 2012")，它提供了以 70% 的准确度估计硬度的算法 - 但他们似乎没有调查该算法是否可以被故意愚弄。（同样，显然可以产生具有特定概率可满足性的 SAT 问题。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T01:08:17.683

这与试图创建基于 np 完整性的公钥加密算法的研究人员所面临的问题相同。据我所知，有一些问题，但这仍然是一个悬而未决的问题。请参阅此处的讨论：[是否存在可证明 NP 难以击败的公钥加密算法？](https://stackoverflow.com/q/311064)

我知道我看过更多最近的作品，但不能随便找到。我记得一本由有关替代密码系统的文章组成的书应该因式分解突然变得便宜，我将尝试挖掘链接。

**编辑**：下面的评论指向我正在考虑的书。[该网站](http://pqcrypto.org/)对各种相关论文有很多很好的参考。具体参见“基于代码”部分。

# sqlite - 是否可以使用 sqlite 和 php 制作无服务器客户端数据库程序？

> ID：10508326
> 
> 赞同：1
> 
> 时间：2012-05-09T00:26:07.497
> 
> 标签：sqlite, client-side

我有一个客户想要一个可以在他的个人计算机上运行的小型数据库程序。我过去设置了多个 mySQL 数据库，我更喜欢使用 HTML、CSS 和 PHP 来编写自定义用户界面，因为它允许进行大量自定义。我的问题是，是否有一种可行的方法可以让我使用 SQLITE 和 HTML、CSS、PHP 创建客户端数据库程序？还是我应该考虑另一种编程语言？

*我考虑过使用像 XAMPP 这样的虚拟灯/wamp 堆栈，但我希望找到一种更有效的方法。

我对任何想法持开放态度。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T16:26:20.450

PHP 5.4 有一个内置的网络服务器，这意味着您可以开发一个应用程序，该应用程序仅依赖于在客户端计算机上安装 PHP。（我假设网络浏览器已经可用）

此外，您可能希望创建一个脚本（批处理文件）来启动服务器（并可能启动浏览器）。SQLite 支持包含在 PHP 的默认版本中。

[http://php.net/manual/en/features.commandline.webserver.php](http://php.net/manual/en/features.commandline.webserver.php)

# php - PHP 包括刷新（现在播放电台的信息）

> ID：10508329
> 
> 赞同：0
> 
> 时间：2012-05-09T00:26:20.913
> 
> 标签：php, html

我正在组建一个在线广播电台，并且正在使用 Applescript 使用最终来自 iTunes 的“正在播放”信息来更新我的服务器。Applescript 将该信息作为 .html 文件推送到服务器。效果很好，然后我使用这行 php 将信息接收到我的网站中：

```
$fp = fopen ("music/rtl.txt","r"); 
if (!feof($fp) ) 
{ 
   $buffer = fgets($fp, 1024); 
   print "<tr><td align=\"center\"><b>Current Track</b>: $buffer"; 
} 
fclose ($fp); 
```

我的问题是：如何让这些信息自动更新？即使它正在服务器上更新，它也会保持不变，直到我在网页上点击刷新。如何在无需手动刷新屏幕的情况下让这些 PHP 信息自行刷新？当前曲目信息如何自动更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T01:25:08.953

首先，在您的 html 页面上，使用带有 id 的 span 来指示您想要跟踪信息的位置：

```
//html page
<tr><td align="center"><b>Current Track</b>: <span id="currentTrack"></span>"; 
```

然后，假设 jquery 很酷，`ajax`在自定义函数中使用该函数，然后使用`setInterval`它每 5 秒运行一次：

```
//script page (using jquery)
$(function(){

    setInterval(refreshTrack,5000); //  5 SECONDS

    function refreshTrack() {
        $.ajax({
                type: 'post',
                url: 'ajax.php',
                success: function(txt) {
                    $('#currentTrack').text(txt);
                }
            });
    }
}); 
```

当然，你的 ajax 页面看起来很像你所拥有的，除了去掉 html 标记，因为它吐出的内容将在`<span>`标签之间：

```
// ajax.php
$fp = fopen ("music/rtl.txt","r"); 
if (!feof($fp) ) 
{ 
   $buffer = fgets($fp, 1024); 
   echo $buffer; 
} 
```

# c# - ASP.NET C# - 如果超过一定数量的字符，文本框值在从另一个页面传递后不可见

> ID：10508331
> 
> 赞同：1
> 
> 时间：2012-05-09T00:26:37.957
> 
> 标签：c#, javascript, asp.net, textbox, window.opener

我正在使用 javascript 将值从弹出页面传递到父页面中的文本框：

```
 function GetValue() {
        window.opener.document.getElementById('<%= Request["txtCCD"] %>').value = document.getElementById('<%=txtGetCCD.ClientID%>').value;

        window.opener.focus();
    window.close(); 
```

其中**txtCCD**是父页面中的文本框 ID，而**txtGetCCD**是要在弹出页面中传递的值的字符串（它是一个 HiddenField）。

现在，如果传递的字符数大约小于 3200，则一切正常。但更重要的是，这些值仍然会传递到父页面文本框，但除非我突出显示文本框，否则这些值将不可见！

文本框是否存在某种限制，或者这与我传递值的方式有关？

请帮忙！！

# python - 您如何获得一个方法，其代码实例化另一个对象以在每次调用时初始化一个不同的对象？

> ID：10508334
> 
> 赞同：0
> 
> 时间：2012-05-09T00:27:11.927
> 
> 标签：python, class, object, methods

对不起，如果标题中的问题不是那么清楚，但我的空间有限，澄清......

在我的代码中，我有一个名为 empDB 的类，它创建一个用于存储对象的空列表。

我也将新对象添加到列表中，我在 empDB 中创建了一个名为 appendEmp 的方法。appendEmp 接受一个参数，该参数指定它将实例化的类，然后将其添加到列表中。如果未提供参数，则默认为 Employee() 类。

这是我的问题

当我调用 appendEmp 方法时，它会在列表中创建新对象，但是当我尝试实例化已经在列表中的对象时，它只会创建它的别名。我每次都需要它来创建一个新对象，以便我可以单独编辑列表中每个对象的属性。

这是我的代码片段：

```
class empDB:

    def __init__(self, lst= []):                  #creates empty list
        self.lst = lst

    def appendEmp(self, emp=Employee()):
        self.lst=self.lst+[emp] 
```

基本上这就是现在发生的事情

```
>>> db=empDB()
>>> db.appendEmp()
>>> db.appendEmp()
>>> db[0] is db[1]
True 
```

我需要它是假的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T00:30:03.757

你可以这样解决你的问题：

```
class empDB:
    def __init__(self, lst= []):  #creates empty list
        self.lst = lst
    def appendEmp(self, emp=None):
        if emp is None:
            empt = Employee()
        self.lst=self.lst+[emp] 
```

该问题是由于将可变值分配为默认参数引起的。我将其替换为`None`，但如果您想接受此值作为 的参数`appendEmp()`，您可以将其替换为其他内容。

有关使用可变默认参数的危险的更多信息，您可以在此处阅读：[Python 的隐藏特性：可变默认参数的危险](https://stackoverflow.com/questions/101268/hidden-features-of-python#113198)

附言。您可能还希望对`__init__()`方法执行相同的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T05:48:10.253

如果您不完全了解它们的工作原理，可变的默认参数可能会导致麻烦。大多数初学者没有意识到，在处理定义时，关键字参数的默认值只计算一次。如果函数代码此后修改了这个对象，那么下一次使用默认对象的调用将看到修改后的值。

[我用从http://holdenweb.com/files/IntroNotes.pdf#page=118](http://holdenweb.com/files/IntroNotes.pdf#page=118)开始的图片来解释这一点

顺便说一句，这些笔记是我的“Python 简介”课程的开源版本的草稿，因此我将不胜感激。

# ruby-on-rails - Mongoid 不在查询中

> ID：10508336
> 
> 赞同：21
> 
> 时间：2012-05-09T00:27:41.750
> 
> 标签：ruby-on-rails, ruby, mongodb, mongoid, nosql

我对 mongoid 有一些问题：

```
 test "Test candidate" do
    User.create(:id => 1, :sex => User::Male, :country => 1, :city => 1)
    User.create(:id => 2, :sex => User::Female, :country => 1, :city => 1)
    User.create(:id => 3, :sex => User::Female, :country => 1, :city => 1)

    user = User.not_in(:id => [2]).second
    assert_not_equal(user.id, 2)
  end 
```

测试失败。我尝试使用 where(:id => {'$nid' => [2]})，但效果相同。

怎么了？如何在 mongoid 中使用“不在”状态？

PS，“第二个”没问题，“第一个”测试通过，因为 id=1

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-05-09T00:30:03.493

试试这个查询：

```
user = User.not_in(:_id => [2]).second 
```

在 MongoDB 中，主键具有 name `_id`。Mongoid 试图变得友好，并通过`id`在对象模型中将其别名化来部分地向开发人员隐藏这一事实。但是当您进行查询时，它无法判断您想要主键`_id`还是某个完全普通的字段`id`。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-03-26T12:00:31.497

```
user = User.where(:id.nin => [2,3,4,5]) 
```

这是根据 mongoid 官方文档：[http ://mongoid.org/en/origin/docs/selection.html](http://mongoid.org/en/origin/docs/selection.html)

# jquery - audio.currentTime 创建 javascript 错误

> ID：10508337
> 
> 赞同：0
> 
> 时间：2012-05-09T00:27:45.023
> 
> 标签：jquery, html

我的 javascript 似乎不想指定我的音频元素的 currentTime，而且我在其他任何地方都没有看到这个问题。音频.currentTime = 0; 正在产生 DOM 异常 11：

```
$(document).ready ( function () {
    var audio = null ;
    audio = document.createElement ( 'audio' ) ;
    audio.src = 'stopped.m4a' ;
    audio.currentTime = 0 ;
} ) ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T02:19:12.907

`audio`使用时未定义。

# java - 将项目列表的元素组合成组合集的最有效方法？

> ID：10508338
> 
> 赞同：0
> 
> 时间：2012-05-09T00:27:52.597
> 
> 标签：java, algorithm, collections, cartesian-product

假设我们要给出一些项目的列表列表，比如字符串。

```
list 1: "a", "b", "c"

list 2: "d", "e", "f"

list 3: "1", "2", "3"

results: (a, d, 1), (a, d, 2), ... (c, f, 3) 
```

（真正的用例与字符串等无关，这只是一个模型）

我写了一个递归方法来做到这一点，但我对它不满意，因为它创建了很多被扔掉的临时集（是的，我知道在 java 中创建对象很便宜，通常 cpu 指令比 C 中的 malloc 少（源: Java Concurrency in Action, p241)，eden GC 很便宜，等等等等。幽默我 :)。

```
void combine(List<List<String>> itemLists, List<Set<String>> combinations, Set<String> partial) {
    if (itemLists == null || itemLists.isEmpty()) return;
    List<String> items = itemLists.get(0);
    for (String s : items) {
        Set<String> tmpSet = new HashSet<>(partial);
        tmpSet.add(s);
        if (itemLists.size() == 0) //termination test
            combinations.add(tmpSet);
        else
            combine(itemLists.subList(1, itemLists.size()), combinations, tmpSet);
    }
} 
```

那么，你会怎么做呢？

**编辑**：要清楚，我不想创建排列。我想创建 sizeof(list of lists) 大的集合。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T14:45:16.357

您正在寻找的是“笛卡尔积”。

如果您可以使用 Sets 而不是 Lists，您可以使用[`Sets.cartesianProduct`](http://docs.guava-libraries.googlecode.com/git-history/v12.0/javadoc/com/google/common/collect/Sets.html#cartesianProduct%28java.util.Set...%29). 当您遍历生成的列表时，仍然分配了一些垃圾......但几乎没有其他方法那么多。

（请注意，作为一种常见的库方法，它已经过非常详尽的测试，因此与从 SO 中粘贴数十行代码相比，您可以对它更有信心。）

仅供参考，也有人[提出要求](http://code.google.com/p/guava-libraries/issues/detail?id=910)，`Lists.cartesianProduct`但我认为没有人在努力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T01:14:48.057

您想要一个所有可能集合的列表，其中包含每个提供的列表中的一个值，假设列表的数量是可变的并且这些列表的大小也是可变的。正确的？

那么这样的事情呢？

```
static List<Set<String>> combine(List<List<String>> itemLists)
{
    // Calculate how many combinations we'll need to build
    int remainingCombinations = itemLists.get(0).size();
    for(int i=1; i<itemLists.size(); i++)
    {
        remainingCombinations *= itemLists.get(i).size();
    }

    List<Set<String>> allSets = new ArrayList<Set<String>>();

    // Generate this combination
    for (;remainingCombinations > 0; remainingCombinations --)
    {
        Set<String> currentSet = new HashSet<String>();
        int positionInRow = remainingCombinations;

        // Pick the required element from each list, and add it to the set.
        for(int i=0; i<itemLists.size(); i++)
        {
            int sizeOfRow = itemLists.get(i).size();
            currentSet.add(itemLists.get(i).get(positionInRow % sizeOfRow));
            positionInRow /= sizeOfRow;
        }

        allSets.add(currentSet);
    }
    return allSets;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T01:14:58.563

这更有效：以与计数相同的方式处理它（每个“位置”都是您的列表之一，并且可以进入该位置的每个“数字”都是您列表的一个元素）：

```
List<Set<String>> combine( List<List<String>> input ){

    final int n = input.size();
    int[] index = new int[n];

    List<Set<Sting>> result = new List<>();

    int position = 0;
    while( position < n ){ // "overflow" check

        // Add set to result.
        Set<String> set = new HashSet<>();
        for( int i=0; i<n; i++ )
            set.add( input.get(i).get( index[i] ) );
        result.add( set );

        // Now the "hard" part: increment the index array
        position = 0;
        while( position < n ){

            if( index[ position ] < input.get( position ).size() ){
                index[position]++;
                break;
            }
            else // carry
                index[ position++ ] = 0;
        }
    }
    return result;
} 
```

（未经测试，可能有一些错误，但主要思想就在那里）。一般来说，递归比迭代慢。

# c# - 一旦将属性容器类加载/实例化到内存中，是否会评估属性 getter？

> ID：10508339
> 
> 赞同：1
> 
> 时间：2012-05-09T00:28:30.587
> 
> 标签：c#, properties

我有一个简单的问题。我设计了一个 C# 类，在那里我得到了一些属性获取器，他们负责执行一些性能昂贵的任务。我班上有很多这样的属性。我的问题是，一旦将类的实例加载到内存中，这些属性获取器是否会被评估？如果是这样，那么，我会考虑将它们分解为方法。我希望他们只在第一次使用该属性时进行评估，但我需要确定这个假设。

我知道我应该为昂贵的任务使用方法，但我刚刚发现使用属性更易于维护，因为我在一个类中有很多成员。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-09T00:29:42.707

每次调用/调用它们时都会评估属性 getter/setter。它们只不过是方法的语法。

```
public class Foo
{
   private int actual = 0;
   public int Bar
   {
      get { return actual++; }
      set { value = actual; value++ }
   }
}

int v = foo.Bar; //0
v = foo.Bar; // 1
v = foo.Bar; // 2
foo.Bar = v; // actual = 3 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T00:33:30.447

Property getters are not for instantiation, since getters/setters only run when you call the property. Use the constructor for instantiating properties. The exception to this rule is lazy initialization, when a (usually readonly) property's value is initialized the first time it is accessed.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-09T00:33:32.973

No, they will not be evaluated when the class is instantiated. They will only be evaluated when they are accessed (and every time thereafter). This allows you to implementat "lazy-loading". It may be wise (depending on your situation) to save the result in a private field after evaluating once, and returning that result for every subsequent call.

```
private string foo;
public string Foo
{
  get
  { 
    if (foo == null)
      foo = "expensive operation";
    return foo;
  }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-09T00:34:27.787

Getters/setters are evaluated when you do call them. Consider this:

```
 private string sample;
    public  string Sample
    {
        get
        {
            return (sample = sample ?? SomeExpensiveMethod());
        }
    } 
```

This way you can control when to call your expensive method.

Also consider static properties are populated only once in your application lifetime. So that can also be a choice, depending on your scenario.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-28T11:37:37.723

值得一提的是，您还可以使用关键字“value”来评估要分配的值。例如：

```
public String Author
    {
        get { return author; } 
        set 
        {
            if (value.Equals(""))
                Console.WriteLine();
            else
                author = value; 
        }
    } 
```

这样，您可以评估分配。

# algorithm - 给定一组数字和元素相对位置的一些条件，生成一组排列

> ID：10508343
> 
> 赞同：5
> 
> 时间：2012-05-09T00:29:26.333
> 
> 标签：algorithm, permutation, combinatorics, backtracking

我正在寻找一种算法，给定一组数字 {0, 1, 2, 4, 5...} 和一组关于每个元素的相对位置的条件，它将检查是否存在有效的排列。条件总是类型为“原始数组中位置 i 的元素必须是位置 j 或 z 中的元素的下一个（相邻）元素”。
排列中的最后一个元素和第一个元素被认为是相邻的。

这是一个简单的例子：

让数字为 {0, 1, 2, 3}
和一组条件：a0 必须在 a1 旁边，a0 必须在 a2 旁边，a3 必须在 a1 旁边
这个示例的有效解是 {0, 1,3,2}。

请注意，此解决方案的任何旋转/对称性也是有效的解决方案。我只需要证明存在这样的解决方案。

使用相同集合的另一个示例：
a0 必须在 a1 旁边，a0 必须在 a3 旁边，a0 必须在 a2 旁边。

此示例没有有效的解决方案，因为一个数字只能与 2 个数字相邻。

我现在唯一能想到的想法就是使用某种回溯。
如果存在解决方案，这应该会快速收敛。如果不存在解决方案，我无法想象有任何方法可以避免检查所有可能的排列。正如我已经说过的，旋转或对称不会影响给定排列的结果，因此应该可以减少可能性的数量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T03:25:29.300

将此公式化为图形问题。连接需要彼此相邻的每一对数字。你最终会得到一堆连接的组件。每个组件都有许多排列（我们称它们为迷你排列），您可以对组件进行排列。

创建图表时，请确保每个组件都遵循一系列规则：没有循环，没有超过两个顶点的顶点等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T00:56:30.667

基本上你想知道你是否可以创建数字链。将每个数字放入一个跟踪该数字和最多两个邻居的链中。使用规则将链连接在一起。当您加入两条链时，您最终会得到一条带有两个松散端（邻居）的链。如果你能通过所有规则而不用完松散的结局，那么它就可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T16:53:32.480

我已经实现了图形解决方案，并稍作修改。

如果一个节点有太多的邻居，该算法将删除一条边并再次检查图。然后我使用回溯回滚并检查是否可以丢弃下一个边缘......这种方法与我编写的蛮力方法给出相同的结果。

就复杂性而言，这个解决方案似乎比蛮力更好，尽管我不能在超过 20 个数字上运行它（蛮力只有 8 个）。从某种意义上说，这是合乎逻辑的，因为这样的图实际上可以一次生成一个有效排列的子集，而且在最坏的情况下，它相当于在一组边上找到一些组合。毕竟是回溯。

鉴于旋转对排列的有效性没有任何影响，我正在考虑将 a0 固定在第一个位置（这可以通过简单地旋转一个有效的排列直到 a0 处于第一个位置来实现）然后尝试构建从那里的解决方案。

使用 DP，我可能会得到比指数复杂度更好的东西。但我必须说我仍然不确定从哪里开始:)

# c# - MonoGame Mac 模板安装

> ID：10508349
> 
> 赞同：2
> 
> 时间：2012-05-09T00:29:44.243
> 
> 标签：c#, macos, mono, monodevelop, monogame

我在 Mac 上的 MonoDevelop 中安装 MonoGame 模板时遇到问题。我已按照自述文件的说明将 MonoDevelop.MonoGame.2.5 文件夹放在 MonoDevelop.app/Contents/MacOS/lib/monodevelop/AddIns/ 中，但是在重新启动 monodevlop 后，新项目部分中没有该模板。任何人都可以帮助解决这个问题吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-06T22:57:40.570

Mac 模板应该在即将发布的 2.5.1 错误修复版本中可用。

# java - Collections.sort, Enum, Comparable Interface 问题

> ID：10508350
> 
> 赞同：2
> 
> 时间：2012-05-09T00:29:46.747
> 
> 标签：java, enums, comparable

我有一个类卡，其他卡（纸牌游戏）继承自它。卡片花色和数字存储在这样的枚举中

```
public static enum Suit {
    CLUBS, DIAMONDS, HEARTS, SPADES
};

public static enum Rank {
    DEUCE, THREE, FOUR, FIVE, SIX, SEVEN, EIGHT, NINE, TEN, JACK, QUEEN, KING, ACE
}; 
```

我的第一个问题是如何改变卡牌的顺序。在从类 Card 继承的每个单独的类（Card Game）中，因为不同的纸牌游戏对不同的纸牌赋予不同的重要性级别。

我的第二个问题是使用 Comparable Interface。

所以我有一张这样的班级卡片：

```
public  class Card implements Comparable<Card> {

public Suit suit;
public Rank rank;

public Card(Rank ranker, Suit suiter) {

    rank = ranker;
    suit = suiter;
}

//Other Methods for rank and suit here. 

@Override
public int compareTo(Card o) {

    int rankCom = rank.compareTo(o.rank);
    return rankCom != 0 ? rankCom : suit.compareTo(o.suit);
} 
```

}

我最近刚被介绍到类似的接口，我不完全确定我的实现是正确的。当我想使用 collections.sort(cards_saver) 整理我的卡片时，问题就出现了。card_saver 是我存放卡片的地方。所有这些工作正常。collections.shuffle(cards_saver) 也可以正常工作。我在做 collections.sort 时遇到的问题是：

```
Bound mismatch: The generic method sort(List<T>) of type Collections is not applicable for the arguments (List<Card>). The inferred type Card is not a valid substitute for the bounded parameter <T extends Comparable<? super T>> 
```

我会提出我所有的额外代码......只是这太长了。如果我没有很好地解释问题，请发表评论-我会尽力解释。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T00:38:59.827

> 我的第一个问题是如何改变卡牌的顺序。在从类 Card 继承的每个单独的类（Card Game）中，因为不同的纸牌游戏对不同的纸牌赋予不同的重要性级别。

你有两种方法：

1.  由于您继承自`Card`，因此您可以重写`compareTo`以相应地表现。
2.  可以看一下`Comparator`界面，方便根据上下文重新定义对象的比较规则。

至于你得到的那个错误，它真的没有意义。问题可能出在其他地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T00:53:19.240

我认为对于语法错误，您必须将 Card 声明为（是的，我同意这是看起来很奇怪的语法）

```
public  class Card implements Comparable<? extends Card> 
```

然后你可以在子类中覆盖。但是，我发现这常常让人感到困惑。另外，从设计的角度来看，桥牌、红心、扑克中的牌都是一样的。可以说，没有 BridgeCard 和 PokerCard 子类。有一张卡片，但有一个不同的游戏，游戏决定了你如何比较卡片。

为了更加清晰，并且，如果您相信我的设计论点，为了更好的设计，不要使用 Comparable，而是实现一堆*Comparator*。例如：

```
static Comparator<Card> LOWBALL_POKER_COMPARATOR = new Comparator<Card>() {

      @Override
      public int compare(Card o1, Card o2) {
         // Ace is LOW is lowball poker, other cards as usual
      }

};

static Comparator<Card> PINOCLE_COMPARATOR = new Comparator<Card>() {
      @Override
      public int compare(Card o1, Card o2) {
         // I haven't played pinocle in so long I forget the rules...
      }
}; 
```

请注意，*Enums 可以实现 Comparator*，因此您可以在 Enums 中拥有所有这些 Comparator。您正在玩的 CardGame 的特定实例/子类会在启动时为该游戏选择正确的枚举/比较器，然后离开……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T00:50:33.557

你的代码对我来说很好。我刚刚向 Card 添加了一个 toString 方法：

```
import java.util.*;

class Card implements Comparable<Card> {

    static enum Suit {
        CLUBS, DIAMONDS, HEARTS, SPADES
    }

    static enum Rank {
        DEUCE, THREE, FOUR, FIVE, SIX, SEVEN, EIGHT, NINE, TEN, JACK, QUEEN, KING, ACE
    }

    public Suit suit;
    public Rank rank;

    public Card (Rank ranker, Suit suiter) {
        rank = ranker;
        suit = suiter;
    }

    @Override
    public int compareTo (Card o) {
        int rankCom = rank.compareTo(o.rank);
        return rankCom != 0 ? rankCom : suit.compareTo(o.suit);
    }

    public String toString () {
        return suit.toString () + "\t" + rank.toString (); 
    }
} 
```

并且 - 只是为了我的方便，将 Rank 和 Suit 作为内部枚举添加到 Card，但只是为了将所有内容放在一个文件中 - 它不应该影响排序。这是测试：

```
public class CardTest
{
    public static void main (String args[])
    {
        List <Card> lc = new ArrayList <Card> ();
        lc.add (new Card (Card.Rank.SIX, Card.Suit.CLUBS)); 
        lc.add (new Card (Card.Rank.TEN, Card.Suit.CLUBS)); 
        lc.add (new Card (Card.Rank.SIX, Card.Suit.HEARTS)); 
        lc.add (new Card (Card.Rank.ACE, Card.Suit.HEARTS)); 

        System.out.println (lc);
        Collections.sort (lc);
        System.out.println (lc);
    }
} 
```

输出：

```
[CLUBS  SIX, CLUBS  TEN, HEARTS SIX, HEARTS ACE]
[CLUBS  SIX, HEARTS SIX, CLUBS  TEN, HEARTS ACE] 
```

您的代码将是：

```
 lc.add (new Card (Rank.TEN, Suit.CLUBS)); 
```

反而。

如果您有不同的卡片顺序，创建一个新的卡片类可能是最简单的事情。排除扑克、桥牌、罗米、二十一点等之间的相似之处可能是过度设计。

# r - 如何按所有列对矩阵进行排序

> ID：10508352
> 
> 赞同：11
> 
> 时间：2012-05-09T00:29:54.147
> 
> 标签：r, sorting

假设我有

```
arr = 2 1 3
      1 2 3
      1 1 2 
```

我怎样才能把它分类到下面？

```
arr = 1 1 2
      1 2 3
      2 1 3 
```

也就是说，首先按第一列，然后按第二列，依此类推。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-09T00:45:29.347

你所追求的功能是`order`（我是如何得出这个结论的——我的第一个想法是“好吧，排序，怎么样`sort`？”。尝试过`sort(arr)`它看起来像是`arr`一个向量而不是按行排序。看着`?sort`，我明白了在“另请参阅：对**多个**`order`变量进行排序或重新排序。”）。

 **看着`?order`，我看到`order(x,y,z, ...)`将 order by `x`，break ties by `y`，break further ties by `z`，依此类推。太好了 - 我所要做的就是传递 to 的每一列`arr`来`order`做到这一点。（在示例部分中甚至还有一个示例`?order`）：

```
order( arr[,1], arr[,2], arr[,3] ) 
# gives 3 2 1: row 3 first, then row 2, then row 1.
# Hence:
arr[ order( arr[,1], arr[,2], arr[,3] ), ]
#     [,1] [,2] [,3]
#[1,]    1    1    2
#[2,]    1    2    3
#[3,]    2    1    3 
```

伟大的！

* * *

`arr[,i]`但是我必须为*每一*列写出有点烦人`arr`- 如果我不知道它有多少列怎么办？

好吧，这些示例也展示了如何做到这一点：使用`do.call`. 基本上，你这样做：

```
do.call( order, args ) 
```

其中`args`是参数*列表*`order`。因此，如果您可以从 的每一列中列出一个列表，`arr`那么您可以将其用作`args`.

一种方法是转换`arr`为数据框，然后转换为列表——这将自动为列表的每个元素放置一列：

```
arr[ do.call( order, as.list(as.data.frame(arr)) ), ] 
```

`as.list(as.data.frame`有点笨拙-当然还有其他方法可以创建列表，例如的`list[[i]]`第`i`列`arr`，但这只是其中一种。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-05-09T00:42:24.610

这会起作用：

```
arr[do.call(order, lapply(1:NCOL(arr), function(i) arr[, i])), ] 
```

它正在做的是：

```
arr[order(arr[, 1], arr[, 2], arr[ , 3]), ] 
```

除了它允许矩阵中有任意数量的列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-01T21:41:33.220

我写了这个小函数，它也可以降序 cols 允许选择要排序的列及其顺序

```
ord.mat = function(M, decr = F, cols = NULL){
    if(is.null(cols))
      cols = 1: ncol(M)
    out = do.call( "order", as.data.frame(M[,cols]))
    if (decr)
      out = rev(out)
    return(M[out,])
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-12T22:46:03.243

我遇到了类似的问题，解决方案似乎简单而优雅：

```
t(apply(t(yourMatrix),2,sort)) 
```**

# android - 用于布局视图的 android 后台活动

> ID：10508353
> 
> 赞同：0
> 
> 时间：2012-05-09T00:29:54.610
> 
> 标签：android, android-layout, android-asynctask

我需要将 30 多张图片加载到一个页面（带有预告文字）。我通过 AsyncTask 加载所有图像，但我无法修改当前布局，因为您只能对主线程上的视图执行修改。异步加载所有内容的最佳方法是什么，这样我的应用程序就不必在“页面加载”期间挂起？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:33:44.470

Why cannot modify layout? for `AsyncTask`, you have [onProgressUpdate](http://developer.android.com/reference/android/os/AsyncTask.html#onProgressUpdate%28Progress...%29) that guarantees to run on UI Thread. You just need to call [publishProgress](http://developer.android.com/reference/android/os/AsyncTask.html#publishProgress%28Progress...%29) in your `doInBackground` code.

==Update==

```
private class LoadImageTask<Url, String, String> extends AsynTask{
    doInBackground(Url... urls){
        for(int i=0; i<urls.length; i++){
            File img = DownloadImage(urls[i]); // Your download method.. 
            publishProgress(img.filename);     // Suppose it is saved in sd card
            // publish progress will call onProgressUpdate immediately, but on different thread
        }
    }

    onProgressUpdate(String filename){
        // Update the UI.. this method will run on UI thread
        displayImage(filename);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T00:34:58.093

I don't think you can build a view in the background. You're best bet would be to show a progress dialoge so the user understands why the app is busy.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T00:36:08.780

如果您的课程扩展了活动，您可以使用

```
runOnUiThread(new Runnable() {
    public void run() {
        //Update UI elements in this block
    }  
}); 
```

# javascript - HTML5 Multiple Canvases 事件监听器 - 如何确定哪个画布经历了事件？

> ID：10508357
> 
> 赞同：3
> 
> 时间：2012-05-09T00:30:22.057
> 
> 标签：javascript, html5-canvas, addeventlistener, mouseclick-event

我是 JS 新手。我没有使用 jQuery，我有一个问题。我在页面上创建了可变数量的画布，都有一个像这样的事件监听器：

```
 for (i=0; i<numberOfCanvases; i++){
                var canv =  document.createElement("canvas");
                canv.addEventListener('click', clickReporter, false);
                document.body.appendChild(canv); } 
```

给定监听函数 clickReporter：

```
 function clickReporter(e){...} 
```

我正在尝试使用此函数来告诉我单击事件相对于画布的鼠标位置：

```
function getMousePos(canvas, evt){
// get canvas position
var obj = canvas;
var top = 0;
var left = 0;
while (obj && obj.tagName != 'BODY') {
    top += obj.offsetTop;
    left += obj.offsetLeft;
    obj = obj.offsetParent;
}
// return relative mouse position
var mouseX = evt.clientX - left + window.pageXOffset;
var mouseY = evt.clientY - top + window.pageYOffset;
return {
    x: mouseX,
    y: mouseY
}; 
```

}

我从本教程中找到的：http: [//www.html5canvastutorials.com/advanced/html5-canvas-mouse-coordinates/](http://www.html5canvastutorials.com/advanced/html5-canvas-mouse-coordinates/)

问题是，它假设只有一个画布，并且我现在确实有一个放置在网页上的画布列表，但我想知道，仅给出 clickReporter() 函数，是否有一种简单的方法来确定哪个画布被选中？像 evt.getCanvas() 或 evt.getParentCanvas() 这样的函数？

我问是因为当事件发生时（鼠标单击许多画布中的一个，我想在该位置仅为该画布创建动作）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T01:00:40.173

```
function clickReporter(e){
    console.log( this ); // in a eventListener , this point to the element fire the event
    console.log( e.target ); // in fireFox and webkit, e.target point to the element fire the event
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T00:55:26.630

我认为 evt.target ( [event.target](https://developer.mozilla.org/en/DOM/event.target) ) 会起作用。

# python - Python - Installing matplotlib in Mac OSX Snow Leopard

> ID：10508360
> 
> 赞同：4
> 
> 时间：2012-05-09T00:30:44.697
> 
> 标签：python, matplotlib, installation

I've been having trouble installing matplotlib. I'm getting a similar error to many other topics, but none of those solutions have been working for me. I have tried installing matplotlib via pip and via git and I receive the same error every time I would very much appreciate help.

```
In file included from src/ft2font.cpp:3:
src/ft2font.h:16:22: error: ft2build.h: No such file or directory
src/ft2font.h:17:10: error: #include expects "FILENAME" or <FILENAME>
src/ft2font.h:18:10: error: #include expects "FILENAME" or <FILENAME>
src/ft2font.h:19:10: error: #include expects "FILENAME" or <FILENAME>
src/ft2font.h:20:10: error: #include expects "FILENAME" or <FILENAME>
src/ft2font.h:21:10: error: #include expects "FILENAME" or <FILENAME>
In file included from src/ft2font.cpp:3:
src/ft2font.h:34: error: 'FT_Bitmap' has not been declared
src/ft2font.h:34: error: 'FT_Int' has not been declared
src/ft2font.h:34: error: 'FT_Int' has not been declared
src/ft2font.h:86: error: expected ',' or '...' before '&' token
src/ft2font.h:86: error: ISO C++ forbids declaration of 'FT_Face' with no type
src/ft2font.h:132: error: 'FT_Face' does not name a type
src/ft2font.h:133: error: 'FT_Matrix' does not name a type
src/ft2font.h:134: error: 'FT_Vector' does not name a type
src/ft2font.h:135: error: 'FT_Error' does not name a type
src/ft2font.h:136: error: 'FT_Glyph' was not declared in this scope
src/ft2font.h:136: error: template argument 1 is invalid
src/ft2font.h:136: error: template argument 2 is invalid
src/ft2font.h:137: error: 'FT_Vector' was not declared in this scope
src/ft2font.h:137: error: template argument 1 is invalid
src/ft2font.h:137: error: template argument 2 is invalid
src/ft2font.h:143: error: 'FT_BBox' does not name a type
src/ft2font.cpp:41: error: 'FT_Library' does not name a type
src/ft2font.cpp:106: error: variable or field 'draw_bitmap' declared void
src/ft2font.cpp:106: error: 'FT_Bitmap' was not declared in this scope
src/ft2font.cpp:106: error: 'bitmap' was not declared in this scope
src/ft2font.cpp:107: error: 'FT_Int' was not declared in this scope
src/ft2font.cpp:108: error: 'FT_Int' was not declared in this scope
/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/numpy/core/include/numpy/__multiarray_api.h:1532: warning: 'int _import_array()' defined but not used
error: command '/usr/bin/gcc-4.2' failed with exit status 1 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-06T12:11:01.573

我有同样的问题。我用酿造。我通过这样做解决了这个问题

```
brew install freetype
brew link freetype
brew install libpng
brew link libpng
brew install matplotlib 
```

默认情况下，brew 使您的系统版本的 freetype 和 libpng 处于活动状态，这也是您需要执行“brew link”的原因。希望有帮助。

更新：我现在建议使用 Anaconda Python 的免费版本。那么这是微不足道的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-09T07:08:56.550

我强烈建议通过包管理器而不是尝试自己编译源代码。这效率更高。

一个不错的替代自制软件是著名的[MacPorts](http://macports.org)包管理器：

```
sudo port install py27-matplotlib 
```

过去，我使用过[Fink](http://www.finkproject.org)，它是 OS X 的第三个主要包管理器，我发现 MacPorts 更加强大和最新。

网上有很多 OS X 包管理器之间的比较（包括一些[不错的](http://terrychay.com/article/macports-vs-homebrew.shtml)），以便您更好地决定要提交哪个管理器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T00:53:44.807

您可以使用[homebrew](https://brew.sh/)轻松完成：

```
$ brew install python
$ brew install gfortran
$ brew install pkg-config
$ easy_install pip
$ pip install numpy
$ cd $HOME
$ git clone https://github.com/matplotlib/matplotlib.git
$ cd matplotlib
$ python setup.py build
$ python setup.py install 
```

# c++ - IPC connection with thread on Windows using Mutex

> ID：10508361
> 
> 赞同：1
> 
> 时间：2012-05-09T00:30:49.820
> 
> 标签：c++, windows, ipc

I have a question about Windows IPC. I implemented IPC with mutex on Windows, but there is a problem when I made the connection with another thread;when the thread terminated, the connection is closed.

1.  The connection thread(A) makes connection to the server
2.  Main thread(B) uses the connection handle(global variable) returned by A
3.  A terminates
4.  B cannot refer the handle any more - because connection is closed

It is natural that mutex is released when the process terminated. However, in the case of thread, I need the way to hold mutex to maintain connection even though the thread terminated, if the process is alive.

Semaphore can be the alternative on Linux, however, on Windows, it is impossible to use semaphor because it cannot sense the abnormal disconnection.

Does someone have any idea?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T21:40:11.197

当拥有互斥锁的线程退出时，没有办法阻止它的所有权被释放。

根据具体情况，还有许多其他方法可以解决问题。

1）您可以更改客户端上的任何代码吗？例如，如果客户端可执行文件使用您提供的 DLL 来建立和维护连接，您可以更改 DLL 以使其使用更合适的对象（例如命名管道）而不是互斥体，或者您可以让 DLL 启动自己的线程来拥有互斥锁。

2) 是否有多个客户？据推测，由于您使用的是互斥锁，因此您一次只希望一个客户端连接。如果您可以安全地假设一次只连接一个客户端，那么当服务器检测到互斥锁已被放弃时，它可以关闭自己的互斥锁句柄。当客户端进程退出时，互斥锁会自动被删除，因此服务器可以定期检查它是否仍然存在。

3）客户端如何与服务器通信？服务器可能正在为客户端做一些有用的事情，因此除了互斥锁之外，还必须有另一个通信通道。例如，如果客户端打开到服务器的命名管道，您可以使用该连接而不是互斥体来检测客户端进程何时退出。或者，如果通信通道允许您确定客户端的进程 ID，您可以打开该进程的句柄并使用它来检测客户端进程何时退出。

4) 如果没有其他解决方案可行，并且您被迫重写客户端和服务器，请考虑使用更合适的 IPC 形式，例如命名管道。

*额外的*

5) 通常的做法是使用进程句柄来等待（或测试）进程终止。大多数情况下，这些句柄是在创建进程时为父进程生成的句柄，但没有理由不使用 OpenProcess 生成的句柄。就先例而言，我向您保证，使用 OpenProcess 生成的句柄来监视客户端进程的先例至少与使用互斥锁的先例一样多；您完全有可能是第一个尝试使用 Windows 互斥锁来检测进程已退出的人。:-)

6) 大概 SQLDisconnect() 函数正在调用[ReleaseMutex](http://msdn.microsoft.com/en-us/library/windows/desktop/ms685066%28v=vs.85%29.aspx)以断开与服务器的连接。由于它是从不拥有互斥锁的线程执行此操作的，因此除了返回错误代码之外不会做任何事情，因此您的服务器没有合理的方法来检测这种情况。该函数是否还在互斥体上调用[CloseHandle ？](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724211%28v=vs.85%29.aspx)如果是这样，您可以使用（2）中的方法来检测何时发生这种情况。这适用于调用 SQLDisconnect() 和进程退出时。有多个客户端并不重要，因为它们使用不同的互斥锁。

6a）我说“没有合理的方式”，因为你可以想象使用[挂钩](https://stackoverflow.com/search?q=%5Bwindows%5D%20hooking)来改变 ReleaseMutex 的行为。 ***这不是一个好的选择。***

7) 除了调用 ReleaseMutex 和/或 CloseHandle 之外，您应该仔细检查 SQLDisconnect() 函数的作用。您完全有可能通过互斥锁以外的其他方式检测到断开连接。

# android - Show keyboard for edittext when fragment starts

> ID：10508363
> 
> 赞同：70
> 
> 时间：2012-05-09T00:31:25.797
> 
> 标签：android, android-edittext, android-softkeyboard

When my fragment starts, I want my edittext to be in focus/let user to just start typing in it. I am able to get it in focus with requestFocus(), but I cannot get the keyboard to show up.

I have tried both this:

```
edit = (EditText) view.findViewById(R.id.search);
edit.requestFocus();
InputMethodManager imgr = (InputMethodManager) getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);
imgr.showSoftInput(edit, 0); 
```

and

```
edit = (EditText) view.findViewById(R.id.search);
InputMethodManager imgr = (InputMethodManager) getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);
imgr.showSoftInput(edit, 0);
edit.requestFocus(); 
```

How can I get the keyboard to show up for EditText?

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2012-05-09T00:44:41.343

这行得通吗？

```
imgr.toggleSoftInput(InputMethodManager.SHOW_FORCED, InputMethodManager.HIDE_IMPLICIT_ONLY); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2015-08-24T08:27:14.490

你可以试试这个

```
@Override
public void onResume() {
    super.onResume();
    edit.post(new Runnable() {
        @Override
        public void run() {
            edit.requestFocus();
            InputMethodManager imgr = (InputMethodManager) getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);
            imgr.showSoftInput(edit, InputMethodManager.SHOW_IMPLICIT);
        }
    });
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2017-05-10T23:40:15.307

由于 using`showSoftInput`不适用于所有情况，并且在尝试了此处提到的一些解决方案之后，例如：

```
if (binding.account.requestFocus()) {
  requireActivity().getWindow()
      .setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_VISIBLE);
} 
```

**我终于使它工作使用**：

```
if (binding.account.requestFocus()) {
  ((InputMethodManager) requireActivity().getSystemService(Context.INPUT_METHOD_SERVICE)).toggleSoftInput(
      InputMethodManager.SHOW_FORCED,
      InputMethodManager.HIDE_IMPLICIT_ONLY
  );
} 
```

自从：

```
 binding.account.requestFocus() 
```

只请求焦点`EditText`（它不打开键盘）

和

```
((InputMethodManager) requireActivity().getSystemService(Context.INPUT_METHOD_SERVICE)).toggleSoftInput(
      InputMethodManager.SHOW_FORCED,
      InputMethodManager.HIDE_IMPLICIT_ONLY
  ); 
```

是唯一似乎可以正常工作以显示键盘的解决方案（也是投票最多的解决方案）

祝你好运！:-)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2018-10-16T09:19:45.080

我对此有帮助的扩展：

```
fun EditText.showKeyboard() {
    if (requestFocus()) {
        (getActivity()?.getSystemService(INPUT_METHOD_SERVICE) as InputMethodManager)
            .showSoftInput(this, SHOW_IMPLICIT)
        setSelection(text.length)
    }
} 
```

你还需要这个：

```
fun View.getActivity(): AppCompatActivity?{
    var context = this.context
    while (context is ContextWrapper) {
        if (context is AppCompatActivity) {
            return context
        }
        context = context.baseContext
    }
    return null
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-05-14T13:52:48.800

在尝试了此处的所有解决方案以及其他相关问题之后，以下是适用于我的方法：

```
editText.postDelayed(Runnable { showKeyboard(activity, editText)} , 50)

fun showKeyboard(activity: Activity, editText: EditText) {
    val inputMethodManager = activity.getSystemService(Activity.INPUT_METHOD_SERVICE) as InputMethodManager
    editText.requestFocus()
    inputMethodManager.showSoftInput(this, 0)
} 
```

有趣的事实是，当你在没有 postDelayed 的情况下调用它时，它不会工作，即使你只是将它延迟 1 毫秒，它仍然不会工作：D

你也可以像这样使用它作为扩展：

```
fun EditText.showKeyboard(activity: Activity) {
    val inputMethodManager = activity.getSystemService(Activity.INPUT_METHOD_SERVICE) as InputMethodManager
    requestFocus()
    inputMethodManager.showSoftInput(this, 0)
} 
```

如果您不喜欢将活动作为参数传递，请按照@Rafols 的建议使用此扩展功能：

```
fun View.getActivity(): AppCompatActivity? {
    var context = this.context
    while (context is ContextWrapper) {
        if (context is AppCompatActivity) {
            return context
        }
        context = context.baseContext
    }
    return null
} 
```

那么您的方法将如下所示：

```
fun EditText.showKeyboard() {
    val inputMethodManager = getActivity()!!.getSystemService(Activity.INPUT_METHOD_SERVICE) as InputMethodManager
    requestFocus()
    inputMethodManager.showSoftInput(this, 0)
} 
```

此外，如果您的 EditText 中已有文本，则在现有文本的末尾设置更好的选择：

```
fun EditText.showKeyboard() {
    val inputMethodManager = getActivity()!!.getSystemService(Activity.INPUT_METHOD_SERVICE) as InputMethodManager
    requestFocus()
    inputMethodManager.showSoftInput(this, 0)
    setSelection(length())
} 
```

如果你想在片段开始时启动它：

```
override fun onResume() {
    super.onResume()
    editText.postDelayed(Runnable { editText.showKeyboard()} , 50)
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-05-31T12:39:44.473

```
 @Override
public void onHiddenChanged (boolean hidden)
{
    super.onHiddenChanged(hidden);

    if(hidden)
    {
        hideKeyboard(yourView);
    }
    else
    {
        toggleKeyboard(yourView);
    }
}

    public static void toggleKeyboard(View v)
{
    InputMethodManager imm = (InputMethodManager) v.getContext().getSystemService(Context.INPUT_METHOD_SERVICE);
    v.requestFocus();

    imm.toggleSoftInput(InputMethodManager.SHOW_FORCED, InputMethodManager.HIDE_NOT_ALWAYS);
}

public static void hideKeyboard(View v)
{
    InputMethodManager imm = (InputMethodManager) v.getContext().getSystemService(Context.INPUT_METHOD_SERVICE);

    imm.hideSoftInputFromWindow(v.getWindowToken(), 0);
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-10-25T10:27:01.863

编辑文本。**requestFocus** () + 输入法管理器。**showSoftInput** () = 为 EditText 显示 IME

使用编辑文本。**在Fragment.onViewCreated** () 中执行AccessibilityAction (AccessibilityNodeInfo.ACTION_CLICK, null)

```
 void maybeShowInputMethod() {
        // use addOnPreDrawListener instead of addOnGlobalLayoutListener
        // because execute sequence: onGlobalLayout-> Restore focus -> onPreDraw
        getView().getViewTreeObserver().addOnPreDrawListener(new ViewTreeObserver.OnPreDrawListener() {

            @Override
            public boolean onPreDraw() {
                // TODO Auto-generated method stub
                getView().getViewTreeObserver().removeOnPreDrawListener(this);

                // always requestFocus when fragment enter or show
                getView().requestFocus();
                final View currentFocus = getView().findFocus();
                if ((currentFocus != null) && currentFocus.onCheckIsTextEditor()) {
                    Log.d(TAG, "maybeShowInputMethod:: currentFocus=" + currentFocus);
                    currentFocus.performAccessibilityAction(AccessibilityNodeInfo.ACTION_CLICK, null);
                }
                return true;
            }
        });
    } 
```

* * *

或创建 EditText 的子类并覆盖**public InputConnection onCreateInputConnection(EditorInfo editorInfo)**

```
public class ImeAwareEditText extends EditText {
private boolean mHasPendingShowSoftInputRequest;
final Runnable mRunShowSoftInputIfNecessary = () -> showSoftInputIfNecessary();

public ImeAwareEditText(Context context) {
    super(context, null);
}

public ImeAwareEditText(Context context, AttributeSet attrs) {
    super(context, attrs);
}

public ImeAwareEditText(Context context, AttributeSet attrs, int defStyleAttr) {
    super(context, attrs, defStyleAttr);
}

public ImeAwareEditText(Context context, AttributeSet attrs, int defStyleAttr,
        int defStyleRes) {
    super(context, attrs, defStyleAttr, defStyleRes);
}

/**
 * This method is called back by the system when the system is about to establish a connection
 * to the current input method.
 *
 * <p>This is a good and reliable signal to schedule a pending task to call
                                                                                                                                                                                                                     52,6          Top
 *
 * <p>This is a good and reliable signal to schedule a pending task to call
 * {@link InputMethodManager#showSoftInput(View, int)}.</p>
 *
 * @param editorInfo context about the text input field.
 * @return {@link InputConnection} to be passed to the input method.
 */
@Override
public InputConnection onCreateInputConnection(EditorInfo editorInfo) {
    final InputConnection ic = super.onCreateInputConnection(editorInfo);
    if (mHasPendingShowSoftInputRequest) {
        removeCallbacks(mRunShowSoftInputIfNecessary);
        post(mRunShowSoftInputIfNecessary);
    }
    return ic;
}

private void showSoftInputIfNecessary() {
    if (mHasPendingShowSoftInputRequest) {
        final InputMethodManager imm =
                getContext().getSystemService(InputMethodManager.class);
        imm.showSoftInput(this, 0);
        mHasPendingShowSoftInputRequest = false;
    }
}

public void scheduleShowSoftInput() {
    final InputMethodManager imm = getContext().getSystemService(InputMethodManager.class);
    if (imm.isActive(this)) {
        // This means that ImeAwareEditText is already connected to the IME.
        // InputMethodManager#showSoftInput() is guaranteed to pass client-side focus check.
        mHasPendingShowSoftInputRequest = false;
        removeCallbacks(mRunShowSoftInputIfNecessary);
        imm.showSoftInput(this, 0);
        return;
    }

    // Otherwise, InputMethodManager#showSoftInput() should be deferred after
    // onCreateInputConnection().
    mHasPendingShowSoftInputRequest = true;
}
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-05-21T23:12:37.767

**科特林**

要在片段中自动显示/隐藏键盘...

```
override fun onResume() {
    super.onResume()

    requireView().edit_text_ID.showKeyboard()

    requireView().edit_text_ID.setOnFocusChangeListener { _, hasFocus ->
     if (!hasFocus){
        hideKeyboardFrom(requireContext(), requireView())
     }
    }
}

fun EditText.showKeyboard() {
    if (requestFocus()) {
        (activity?.getSystemService(INPUT_METHOD_SERVICE) as InputMethodManager)
            .showSoftInput(this, SHOW_IMPLICIT)
        setSelection(text.length)
    }
}

fun hideKeyboardFrom(context: Context, view: View) {
    val imm =
        context.getSystemService(Activity.INPUT_METHOD_SERVICE) as InputMethodManager
    imm.hideSoftInputFromWindow(view.windowToken, 0)
} 
```

[这里](https://stackoverflow.com/a/17789187/7795072)有一点信息。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-07-05T10:25:01.103

简单地说，使用添加 2 行就像一个魅力：

如果使用 XML

```
android:focusable="true"
android:focusableInTouchMode="true" 
```

Java中的其他内容：

```
view.setFocusableInTouchMode(true);
view.requestFocus(); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-25T21:47:59.853

当片段启动时打开键盘的另一种方法是调用`requestFocus()`并`onCreateView`通过打开键盘做出相应的反应，当且仅当它`EditText`是可聚焦的。

```
if(this.editText.requestFocus())
{
    getActivity().getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_VISIBLE);
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-08-04T15:30:24.053

科特林

启动片段时键盘打开

```
 override fun onCreateView(
    inflater: LayoutInflater, container: ViewGroup?,
    savedInstanceState: Bundle?): View? {
    // Inflate the layout for this fragment
    val fragmentView = inflater.inflate(R.layout.fragment_main, container, false)

    activity?.window?.setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_VISIBLE);

    return fragmentView
} 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2015-04-25T14:39:36.213

正如 Nilzor 所说，这行得通

```
imgr.showSoftInput(getView(), InputMethodManager.SHOW_IMPLICIT) 
```

我同意它是比 toogleSoftInput 最好的解决方案

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2017-03-20T13:43:36.860

这篇文章帮助了我

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) 
{
  View view = inflater.inflate(R.layout.fragment_edit_name, container);
  editText = (EditText) view.findViewById(R.id.txt_yourName);
  editText.requestFocus();
  getDialog().getWindow().setSoftInputMode(
                       LayoutParams.SOFT_INPUT_STATE_VISIBLE);
   return view;
} 
```

[https://turbomanage.wordpress.com/2012/05/02/show-soft-keyboard-automatically-when-edittext-receives-focus/](https://turbomanage.wordpress.com/2012/05/02/show-soft-keyboard-automatically-when-edittext-receives-focus/)

# java - How to Upload File through XML Webservice using Java

> ID：10508367
> 
> 赞同：0
> 
> 时间：2012-05-09T00:32:21.620
> 
> 标签：java, xml, file-upload

I have read plenty of explanations about how to upload files to a server through XML using C#, but I have not found how to do the same using Java and have not been able to figure it out at all. I wonder if anybody on you have done this job successfully.

My intention is to do an HTTP posts containing some text values as a caption and description of an image file, then post them and the image file to the web server through XML.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:47:16.527

使用 Jersey 上传文件非常容易。实际上，它可以让您以**InputStream**的形式访问文件内容。请参阅下面的示例代码：

```
@Consumes("multipart/form-data") 
@POST 
public void post(@FormParam("file") InputStream file) { 
  ... 
} 
```

对于客户端，Jersey 还可以帮助您发送 HTTP 请求。可以在这里找到一个很好的示例：[http ://www.tuple23.com/2010/03/file-upload-using-jersey-client.html](http://www.tuple23.com/2010/03/file-upload-using-jersey-client.html)

# facebook-graph-api - Facebook Application Auth Token Get Error

> ID：10508368
> 
> 赞同：1
> 
> 时间：2012-05-09T00:32:26.453
> 
> 标签：facebook-graph-api, get, access-token, facebook-access-token

I am trying to request the authtoken for my app via the Facebook API Graph Exlorer following the facebooks [instructions](http://developers.facebook.com/docs/opengraph/using-app-tokens/). When I do a get call with a URL with the following form:

```
https://graph.facebook.com/oauth/access_token?client_id=YOUR_APP_ID&client_secret=YOUR_APP_SECRET&grant_type=client_credentials 
```

I get the following error:

```
 {
  "error": {
    "message": "Invalid callback",
    "type": "OAuthException",
    "code": 1
  }
} 
```

Suggestions on how I might go about obtaining the access token for my app would be greatly appreciated!

If I try to obtain the access code programmatically running the following code:

```
 FB.api('/oauth/access_token?client_id={APP_ID}&client_secret={APP_SECRET}&grant_type=client_credentials', function(response) {
   alert(JSON.stringify(response));
  }); 
```

I get the following error:

```
{"error":"load-error: unknown"} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T16:05:02.150

You cannot execute this command using the Facebook Graph API explorer. Typing it directly into the browser returns the access token as desired.

# java - On DBConnections reuse

> ID：10508370
> 
> 赞同：0
> 
> 时间：2012-05-09T00:32:42.573
> 
> 标签：java, database-connection

**Today:**

I continue to work on an application, which, constantly creates and closes a LOT of (sql) connections to the same (Oracle) database, using the same credentials running very basic selects, updates and inserts.

Currently, a `singleton CustomConnectionManager` checks in its pool to see if any `CustomConnector`s are available to be given out. Once given out they may be closed by the client. Upon `close()` the underlying `SQLConnection` (created and maintained by the `CustomConnector`) is also closed. If `CustomConnector` is unavailable, new `CustomConnector` is created.

The good thing about this is that ultimately `SQLConnection` remains closed after each use, however, very little reuse is going on as the value lies in `SQLConnection` not in `CustomConnector`.

Since all users of the system will connect to the same database, the same single connection may be used to accommodate all requests. Original solution that created new Connectors upon each request seems very wasteful.

**Proposed:**

`singleton CustomConnectionManager` will maintain 2 queues:

*   a queue of available `CustomConnector`, each of which will maintain it's own `SQLConnection` and
*   a queue of `inUse` `CustomConnector`s. Upon request new `CustomConnector` will be created and given out.

Client interaction only happens with the `singleton CustomConnectionManager`.

When new connection is needed, manager creates it, gives it out to client and places it in `inUse` queue. When client is done using the connection, instead of closing it, client will `.markConnectorAvailable()`, which would put it back into the `availableConnectors` queue ( Client will no longer be able to control underlying SQLConnection)

**Question 1: What do you think? Will this work? Is there an existing solution that already does this well?**

**Question 2: If proposed approach is not a complete waste, what is a good point for `CustomConnector`'s to close it's SQLConnections?**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:46:29.483

那就是连接池。ADO.Net 在设定的时间内没有使用会杀死它们（可以在连接字符串中设置，（我记得默认是两分钟。）。

# sqlite - Data displayed redundantly on my UITableView in monotouch

> ID：10508372
> 
> 赞同：0
> 
> 时间：2012-05-09T00:32:46.843
> 
> 标签：sqlite, uitableview, xamarin.ios

I have problem in populating a table in monotouch using SQLite as database. My problem is it only selects the last data inserted and returns it as many as the number of data in the table selected.

ex. data=iPhone, number of data in a table = 30.

it returns the iPhone in the table 30 times.

Here is the code:

MainViewController

```
public override void ViewDidLoad ()
    {
      base.ViewDidLoad ();

      LoadToolbarButtons ();
      LoadNavigationBarButtons ();

      BL.Products MyProducts = new BL.Products();
      List<Products> productList = new List<Products>();

      POSDB.InitPOSDatabase ();
      POSDB.GetAllProducts (productList, MyProducts);

      tblProductList.Source = new ProductListDataSource(productList);
      tblProductList.Delegate = new ProductListDelegate();
    } 
```

DataSource

```
public class ProductListDataSource : UITableViewSource
{
public List<Products> ProductList = new List<Products>();
public BL.Products myProducts = new BL.Products();

public ProductListDataSource(List<Products> productList):base()
{
    this.ProductList = productList;
}

#region implemented abstract members of MonoTouch.UIKit.UITableViewSource
public override int RowsInSection (UITableView tableview, int section)
{
    if (ProductList.Count == 0) 
    {
        UIAlertView alert = new UIAlertView ("No Records!", "Please add some items to your table.", null, "OK", null);
        alert.Show ();
    }

    return ProductList.Count;
}

public override UITableViewCell GetCell (UITableView tableView, NSIndexPath indexPath)
{
    string cellIdentifier = "Cell";
    UITableViewCell cellProduct = tableView.DequeueReusableCell(cellIdentifier);

    if (cellProduct == null)
    {
    cellProduct = new UITableViewCell(UITableViewCellStyle.Value1,cellIdentifier);
    }

    var products = this.ProductList[indexPath.Row];
    cellProduct.TextLabel.Text =string.Format("({0}) {1}", products.ProductID, products.ProductName);
    cellProduct.DetailTextLabel.Text = "$" + System.Convert.ToString(products.Price);

    return cellProduct;
}
#endregion 
```

}

Is there something wrong with my codes? Thank you in advance!

# javascript - 文档高度占原始高度的百分比

> ID：10508373
> 
> 赞同：3
> 
> 时间：2012-05-09T00:32:53.383
> 
> 标签：javascript, jquery, dom

我想在添加元素后重置原始文档的高度以删除多余的空间。我现在的代码是这样的。

```
 $(document).ready(function() {
       var document_height = $(document).height();
       document_height = 0.70 * document_height;
       $(document).height(document_height);
    }); 
```

这应该会改变文档的高度，但不会。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T00:42:25.110

我认为您需要使用`$(window)`.`$(document)`

`$(document)`是指整个文档的高度，`$(window)`是指视口大小。

如果您确实想要降低文档对象高度的行为，您可以考虑在 CSS 中使用替代方法来删除添加元素后作为“额外空间”的边距/填充。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T01:22:22.453

原始问题中的代码确实有效。其他东西为文档增加了更多空间。

# iphone - Facebook Photo Size in iOS sdk

> ID：10508374
> 
> 赞同：1
> 
> 时间：2012-05-09T00:32:59.303
> 
> 标签：iphone, objective-c, ios, facebook-graph-api, uiimageview

Right now with the Facebook iOS sdk, I am pulling images off the wall. but I need to analyze the photo and determine the height and width of the photo.

How would I go about doing this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T20:25:31.130

我知道这是一个已经回答的老问题，但由于接受的答案非常不清楚，因为这可能会帮助其他与您有相同问题的人：

鉴于您从墙上拉下的图像在显示之前已转换为 UIImage 对象，那么您只需执行以下操作即可轻松获取每个对象的高度和宽度：

完整代码示例：

```
NSData* imageData = [[NSData alloc] initWithContentsOfURL:[NSURL URLWithString:yourimageurlhere]];
UIImage* image = [[[UIImage alloc] initWithData:imageData] autorelease];
[imageData release];

NSLog(@"Height : %0.1f", image.size.height);
NSLog(@"Width : %0.1f", image.size.width); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-09T10:36:43.303

当您调用[GraphAPI 照片](https://developers.facebook.com/docs/reference/api/photo/)对象时，您会在响应中获得尺寸：[https ://graph.facebook.com/98423808305](https://graph.facebook.com/98423808305)

你在找什么？

# perforce - How to find which changelists will be copied?

> ID：10508375
> 
> 赞同：1
> 
> 时间：2012-05-09T00:33:06.790
> 
> 标签：perforce

I want to be able to do a 'p4 describe' on all the changelists that will be copied upon a 'p4 copy' command. How can this be done?

I could do something like:

```
p4 copy -n from-branch/... to-branch/... | sed -e 's|.* ||' | xargs -n 1 p4 filelog 
```

to find the list of changes per file and truncate the list at the point of the last branch or integrate action into to-branch (if there is one). But this could potentially take a long time. Is there a better way?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T14:13:46.577

试试[`p4 interchanges`](http://www.perforce.com/perforce/doc.current/manuals/cmdref/interchanges.html)。我喜欢`-l`and`-f`标志，它打印整个更改列表描述并列出更改的文件：

```
p4 interchanges -lf from-branch/... to-branch/... 
```

不过，我实际上并没有将此命令与 一起使用`p4 copy`，因此结果可能会略有不同。如果你正在做特别花哨的集成（樱桃采摘修订），Perforce 可能会显示一个需要集成的更改列表，即使它已经被集成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T14:53:58.237

脚本可能是正确的方法。我会使用 perl、python 或 ruby​​ API 来使其更高效且更易于维护。

基本大纲是：

*   运行`p4 copy -n`获取候选文件列表
*   解析出正在复制的源修订。例如，每一行输出都有类似“branch/sync from //depot/foo.c#1,#3”的内容。对于该文件，您想知道如何创建修订版 1-3。
*   运行`p4 changes`以获取影响每个文件的更改列表（例如`p4 changes -l //depot/foo.c#1,#3`

同样，使用 API 执行此操作会更有效，因为您可以对所有命令调用使用单个连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T00:53:05.370

我认为最简单的做法是在从分支复制到分支的最后一个 CL 处创建标签和标签 from-branch/...。然后找出未复制的 CL 列表很简单：

```
p4 changes 'from-branch/...@>copied-up-to' # where copied-up-to is the name of the dynamic label 
```

如果 from-branch 下的所有内容都标记在同一个 CL 中，我可以使用动态标签，其 Revision spec 将是从 from-branch 复制到 to-branch 的最后一个 CL。

# iphone - Changes to MainStoryboard.storyboard no longer appear in my published app

> ID：10508380
> 
> 赞同：0
> 
> 时间：2012-05-09T00:33:36.393
> 
> 标签：iphone, objective-c, xcode, ios5, storyboard

I've been working away at a project of mine, when a couple days ago I noticed that changes I was making to the MainStoryboard.storyboard weren't occurring in the published version of my app. I tried adding new components and switching many elements and still no changes. I've tried cleaning and building, but the storyboard will still not update itself to my new changes. Changes I make to the code, however, work. I can dynamically populate a text field for example.

I feel like I've done something silly and not realized it, like somehow disconnected or duplicated the storyboard (though I only see one storyboard file in my list). I'm hoping someone has some ideas so I can progress with my project. Anyone?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:57:33.313

I had the exact same problem and it was due to localization which splits the storyboard into different ones for each language. It remains one file but xcode shows each localization in the address bar (or whatever it is called) if you select the storyboard in the file navigator.

Most likely you made changes for a storyboard language you don't use yourself for testing.

# ruby-on-rails - Loop in Rails view without line breaks

> ID：10508383
> 
> 赞同：0
> 
> 时间：2012-05-09T00:34:13.597
> 
> 标签：ruby-on-rails, view, sass

I want to loop through an array of things and create a tab for each one. When I pull up the page, however, each one appears on a new line. I'm using Slim, though I think this would translate to any other tempting language.

I also have a reset.css loaded before anything else, but the breaks remain.

Slim:

```
p Your dashboard!
.tabs
  .tab-bar
    - TYPES.each do |type|
      .tab-item
        p
          = type.to_s 
```

Scss:

```
.tabs {
  width: 80%;
  border-color: $slushie;
  .tab-bar {
    .tab-item{
      p {
        color: $white;
        font-weight: bold;
        font-family: Helvetica;
      }
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T00:45:59.377

您需要添加一个 float:left; 元素到 css 元素上

```
tabs {
          float:left;
          width: 80%;
          border-color: $slushie;
          .tab-bar {
            .tab-item{
              p {
                color: $white;
                font-weight: bold;
                font-family: Helvetica;
              }
            }
          }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T00:45:34.267

这可能是因为您使用的`p`元素通常是块元素。您可以使用类似的东西覆盖它`display: inline;`（不是您也需要在您的`.tab-item`div 上执行此操作）。您也可以`.tab-item`改为浮动元素。

```
.tabs {
  width: 80%;
  border-color: $slushie;
  .tab-bar {
    .tab-item{
      display: inline;
      p {
        color: $white;
        font-weight: bold;
        font-family: Helvetica;
        display: inline;
      }
    }
  }
} 
```

# iphone - How do you remove a UIButton/keyboard/UIAlertView from the view while json or other data is being loaded?

> ID：10508387
> 
> 赞同：2
> 
> 时间：2012-05-09T00:35:12.587
> 
> 标签：iphone, json, ios5, uisearchbar

I'm using a UISearchBar in my application and the problem is when I call a few json methods `searchBarSearchButtonClicked` seems to not resign the keyboard until the other methods are done loading the data. I've tried alternatively using UIAlertView and UIButtons to replace the `searchBarSearchButtonClicked` function but they appear to literally freeze and stay in a "pressed down" state too. I was also wondering if this would be a reason why `[UIApplication sharedApplication].networkActivityIndicatorVisible = YES;` wouldn't show an activity indicator in the device's status bar.

```
- (void)searchBarSearchButtonClicked:(UISearchBar *)searchBar{
    self.args = searchBar.text;
    [self grabData];
    [self fillVars];
    [searchBar resignFirstResponder];
    [self.tableView reloadData];
} 
```

`[self grabData]` is where I grab the JSON data and `[self fillVars]` just fills a few things that are later used.

```
-(void)grabData{
    self.args = [self.args stringByAddingPercentEscapesUsingEncoding:NSASCIIStringEncoding];

urlString = [NSString stringWithFormat:@"%@%@?key=%@&q=%@",baseUrl,func,apiKey,args];
url = [NSURL URLWithString:urlString];
NSData *jsonData = [NSData dataWithContentsOfURL:url];
NSError *error; 
NSDictionary *json = [NSJSONSerialization JSONObjectWithData:jsonData options:kNilOptions error:&error];
self.matches = [json objectForKey:@"matches"];
[UIApplication sharedApplication].networkActivityIndicatorVisible=YES;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T00:44:40.107

您将不得不使用线程。对界面的所有操作都发生在主线程上，因此当您在主线程上执行冗长的任务时，界面将无法在任务完成之前自行更新。

在 UIViewController 中，您可以执行 [self performSelectorInBackground:@selector(grabData) withObject:self]，这是一种使用大中央调度调度新队列（线程）的便捷方法。

您也可以使用 GCD API 手动执行此操作。您会按照以下方式做一些事情：

```
dispatch_queue_t jsonQueue = dispatch_queue_create("JSON Queue", NULL);
dispatch_async(jsonQueue, ^{

    // fetch JSON data ...

    dispatch_async(dispatch_get_main_queue(), ^{

        // perhaps do something back on the main queue once you're done!

    });
}); 
```

# ruby-on-rails - 在 Rails 2.3 中优化 ActiveRecord 查询

> ID：10508389
> 
> 赞同：0
> 
> 时间：2012-05-09T00:35:41.867
> 
> 标签：ruby-on-rails, sqlite, activerecord

我正在使用 sqlite db 执行查询，在其中我从数据库中提取了相当大的呼叫记录数据集。在同一页面上，我想在通话记录中显示每天的计数细分，因此我对数据库执行了大约 30 次计数查询。

有没有一种方法可以过滤我最初检索的集合并在内存集合上执行计数，这样我就不必运行那些连续查询？我需要这些计数用于绘图和显示目的，但即使有日期索引，运行初始查询加上所有计数查询也需要大约 10 秒。

我基本上要问的是有没有办法对返回的记录进行计数或对其进行分析，或者有没有更聪明的方法来缓存这些数据？

```
 @set = Record.get_records_for_range(date1, date2)
while date1 < date2
    @count = Record.count_records_for_date(date1)
    date1 = date1 + 1
end 
```

基本上就是我正在做的事情。肯定有更简单、更快捷的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-12-12T15:26:22.377

使用`@set.length`将在不查询数据库的情况下为您提供内存集的计数，因为它是由 ruby​​ 非活动记录执行的（就像`.count`是）

在这里阅读[https://batsov.com/articles/2014/02/17/the-elements-of-style-in-ruby-number-13-length-vs-size-vs-count/](https://batsov.com/articles/2014/02/17/the-elements-of-style-in-ruby-number-13-length-vs-size-vs-count/)

这是从那篇文章中引述的一段话

> length 是一种不属于 Enumerable 的方法 - 它是具体类（如 String 或 Array）的一部分，并且通常在 O(1)（常数）时间内运行。这是最快的，这意味着使用它可能是一个好主意。

# c++ - 寻找在 STL 向量中的 C++ STL 向量

> ID：10508392
> 
> 赞同：14
> 
> 时间：2012-05-09T00:36:16.623
> 
> 标签：c++, stl, vector, find

我正在尝试查看向量*v1*是否包含在向量*v2*中。我的向量是有序的，并且需要保留顺序。

例如，如果*v1= ( **a, b** )*和*v2 = (e, f, **a, b** )*，我想在*v2中获得一个指向***a**的迭代器。

 *STL`find`只在向量中找到一个对象。我想我想要的是类似于`string::find`.

STL中是否有任何功能可以做到这一点？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-09T01:09:13.783

看起来您想在另一个序列中搜索子序列。您可以[`std::search`](http://en.cppreference.com/w/cpp/algorithm/search)从标准库中做到这一点。

```
auto it = std::search(v2.begin(), v2.end(), v1.begin(), v1.end()); 
```*

# javascript - 如何使用 jquery 或 javascript 发送/上传文件？

> ID：10508393
> 
> 赞同：0
> 
> 时间：2012-05-09T00:36:21.483
> 
> 标签：javascript, jquery, ajax, file-upload

如何使用 jquery ajax 向 php 发送/上传文件信息？info 是要上传的文件。

```
$.ajax({
            type: "POST",
            url: url,
            data: data, /* data from input file to upload it */
            async: false,
            beforeSend: function() {
            },
            complete: function() {

            },        
            cache: false,
            success: callback,
            error: function(error) {
                alert("Some problems have occured. Please try again later: " + error);
            }
        });

<form id="product-form" action="javascript: product();" enctype="multipart/form-data">
<input type="file" name="img" />
<a href="#" class="link2" onclick="document.getElementById('product-form').submit()">Submit</a> 
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T01:14:16.000

你不能单独使用 jQuery 来做到这一点。您需要使用 jQuery 插件（例如[Uploadify）](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CIUBEBYwAA&url=http://www.uploadify.com/&ei=XMSpT7edBsPv6AHdv_2nBA&usg=AFQjCNEpTOmRIaTRQ7F8JNaxa7VhKljjwQ&sig2=yrn-PhteAuvOiZhxjOaqLA)或使用[HTML 5](http://www.sitepoint.com/html5-ajax-file-upload/)。请注意，目前并非所有浏览器都支持 HTML 5，因此 jQuery Uploadify 可能是更好的选择。

# jquery - 如果表单悬停或单击输入框，则jQuery应用动画

> ID：10508394
> 
> 赞同：0
> 
> 时间：2012-05-09T00:36:24.550
> 
> 标签：jquery, html, css

当鼠标悬停在鼠标悬停时或单击输入框时，我试图将不透明度效果应用于整个表单，这样效果不会消失。

目前我有以下html：

```
<form id="search">
    <input id="search-input" type="text" value="Search" />
    <input id="search-submit" type="submit" value="" />
</form> 
```

而这个jQuery：

```
$('form#search').hover(function() { 
    $(this).stop().animate({"opacity": 1}); 
},function() { 
    $(this).stop().animate({"opacity": 0.6}); 
}); 
```

目前，它仅在您结束时才有效，而不是`#search-input`在鼠标位于屏幕上的其他位置时单击它时无效，我该如何添加最后一部分？

这对于 CSS3 是不可能的，因为当没有父选择器时，只有一个输入被聚焦时，您不能将不透明度影响应用到整个表单。

**伪代码最终目标**

```
$($('form#search').hover(), $('form#search input').focus()).functionOn(){
    $('form#search').stop().animate({"opacity": 1}); 
}, functionOff(){
    $('form#search').stop().animate({"opacity": 0.6}); 
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T00:39:47.027

您为什么不尝试仅在 CSS3 中执行此操作？您可以使用 :hover 和 :focus 来做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T01:57:49.970

该代码应该可以很好地完成工作。这也适用于如果有人在当前编辑输入时鼠标移出，并且如果您正在编辑输入然后单击另一个“可淡化” div，它应该会正确转换到新的“可淡化” div。

唯一缺少的是你的动画，但我认为你可以将 addClass/removeClass 更改为你的动画，你应该很高兴。

这花了一些时间，所以希望它有所帮助！

[http://jsfiddle.net/vpz2S/](http://jsfiddle.net/vpz2S/)

# proxy - 如何从 .pac 文件中查找代理服务器和密码

> ID：10508397
> 
> 赞同：10
> 
> 时间：2012-05-09T00:37:02.747
> 
> 标签：proxy, pac

我正在使用 dynatrace ajax 版本，它需要代理服务器和密码才能连接到 dynatrace 服务器。

问题是我只有我们在工作中使用的 .pac 文件 URL。

是否可以知道我的请求解析到哪个代理服务器和端口，以便我可以直接提供代理服务器名称和密码？

我检查了 stackoverflow 社区中的几个链接，但他们似乎没有回答这个问题。

喜欢：[如何发现 pac 中使用的 de 代理](https://stackoverflow.com/questions/3068728/how-to-discover-de-proxy-used-in-a-pac)

我正在使用带有 IE8 的 Windows 7 64 位系统。

谢谢，阿尤斯曼

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-09T00:51:06.183

在浏览了更多谷歌搜索结果之后，

[这个漂亮的工具](https://github.com/manugarg/pacparser)完美地帮助了我

请注意，我使用的是 64 位 Windows 7 机器，但它仍然运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-10-10T11:23:46.690

点击浏览器地址栏中的 URL。它应该下载文件。使用任何文本编辑器打开文件。查看文件的内容，您可以轻松找出正在使用的代理 IP/端口。这对我有用。希望它也对其他人有所帮助。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2014-07-11T18:22:02.547

要查找您的 Web 代理，只需访问：

[http://www.whatismyproxy.com/](http://www.whatismyproxy.com/)

此网页将显示有关您的代理服务器的信息。

# javascript - Google Maps v2：如何显示具有相同坐标的各种标记

> ID：10508398
> 
> 赞同：4
> 
> 时间：2012-05-09T00:37:06.620
> 
> 标签：javascript, google-maps, google-maps-markers, google-maps-api-2

我正在使用 Google Maps JavaScript API V2 来标记保存在数组中的位置。具有不同坐标的标记显示得很好，但我不知道如何显示具有相同坐标的各种标记。我需要它，因为位置数组可以具有相同的坐标，但具有不同的描述。显示这些不同描述的方式是什么？

添加标记的代码是：

```
var map;

    function loadEarth(mapdiv) {
        if (GBrowserIsCompatible()) {
            if(!mapdiv)
                return true;
            map=new GMap2(document.getElementById("map"));
            map.enableDoubleClickZoom();
            map.enableScrollWheelZoom();
            map.addControl(new GMapTypeControl());
            map.addControl(new GSmallMapControl());
            map.setCenter(new GLatLng(40.186718, -8.415994),13);
            }
    }
    function createMarker(point, number, description) {
        var marker = new GMarker(point);
        marker.value = number;
        GEvent.addListener(marker, "click", function() {
        var myHtml = "<b>#" + number + "</b><br/>" + description;
            map.openInfoWindowHtml(point, myHtml);
        });
        return marker;
    } 
```

...

```
for(var i=0; i<gl_list.length; i++){
   var point = new GLatLng(gl_list[i].Latitude,gl_list[i].Longitude);
   description = "Visited place : "+gl_list[i].nome+" on : "+gl_list[i].data;
   map.addOverlay(createMarker(point, i + 1, description));
} 
```

感谢您的关注。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-20T14:30:41.627

我经常在我的地图上遇到完全相同的问题，并且发现自己担心相同的多个标记问题：哪个标记在顶部？用户如何看到它们？等等

最终，我认为问题实际上与标记无关。它真的是关于地图上的一个特定*点*。从用户的角度来看，他们可能不太关心标记或标记周围的任何机制。他们真正关心的是与*该位置*相关的信息。从这个角度来看，挑战在于找到一种方法来为用户提供一种以直接方式查看相关信息的方法。因此，我决定将占据同一位置的所有标记合并为一个标记，该标记包含对用户而言重要的所有信息。

一步一步，这是我用来解决同一位置问题中的多个标记的方法：

***第 1 步：***对标记数据进行排序，以便识别占据相同位置的标记：

```
gl_list.sort( function( a, b ) {
    var aLat = a.Latitude, bLat = b.Latitude;               
    if ( aLat !== bLat ) { return aLat - bLat; }
    else { return a.Longitude - b.Longitude; }
}); 
```

***第 2 步：***`gl_list`添加一个新函数，为数组的并置成员创建一个“特殊”标记

```
var specialMarkers = null;

function createSpecialMarker( specialMarkers ) {
    var infoWinContent = "<table class='special-infowin-table'>";

    for ( var i = 0; i < specialMarkers.length; i++ ) {
        infoWinContent +=
            "<tr>" +
            "<td class='special-table-label'>" +
                "Visited Place [" + (i+1) + "]" +
            "</td>" + 
            "<td class='special-table-cell'>" +
                specialMarkers[i].nome + " on : " + specialMarkers[i].data +
            "</td></tr>";
    }
    infoWinContent += "</table>";

    var mrkrData = specialMarkers[0];
    var point = new GLatLng( mrkrData.Latitude, mrkrData.Longitude );
    var marker = new GMarker( point );
    GEvent.addListener(marker, "click", function() {
    map.openInfoWindowHtml( point, infoWinContent );
});

    return marker;
} 
```

***第 3 步：***遍历标记数据，识别具有相同位置的分组，使用特殊标记在地图上显示它们，并“正常”处理其他位置的所有标记数据：

```
for ( var i = 0; i < gl_list.length; i++ ) {
    var current = gl_list[i];
    var coLocated = null;
    var j = 0, matchWasFound = false;

    if ( i < ( gl_list.length - 1 ) ) {
        do {
            var next = assetData[ i + ++j ];
            if ( next !== undefined ) {    //just to be safe
                if ( next.Latitude === current.Latitude &&
                        next.Longitude === current.Longitude ) {
                    matchWasFound = true;
                    if ( coLocated === null ) {
                        coLocated = new Array( current, next);
                    }
                    else { coLocated.push( next ); }
                }
                else { matchWasFound = false; }
            }
            else { matchWasFound = false; }
        }
        while ( matchWasFound )

        if ( coLocated != null ) {
           var coLoMarker = createSpecialMarker( coLocated );
            if ( specialMarkers === null ) {
                specialMarkers = new Array( coLoMarker );
            }
            else {
                specialMarkers.push( coLoMarker );
            }

            i += --j;
            continue;
        }

        var point = new GLatLng(gl_list[i].Latitude,gl_list[i].Longitude);
        description = "Visited place : "+gl_list[i].nome +
                        " on : " + gl_list[i].data;
        map.addOverlay( createMarker( point, i + 1, description ) );
    }
} 
```

这个想法是产生一个单一的标记，让 InfoWindow 传达关于位置的多条重要信息，最终得到如下所示的内容：

![在此处输入图像描述](../Images/df0624f94ecf51ca0571edf34fcdbc9f.png)

现在我还没有运行这个实际的代码，但它是基于每天运行的代码。这更旨在让您对该方法有一个相当详细的了解，并分享一段代码，这些代码应该让您非常接近可用的解决方案，但要了解它可能需要一些调整和调试。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-20T08:50:35.833

您可以尝试使用 MarkerCluster 或 Marker Spiderfier 在相同坐标处显示标记

MarkerCluster：[演示](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/examples/advanced_example.html)

标记蜘蛛侠：[演示](http://jawj.github.com/OverlappingMarkerSpiderfier/demo.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-15T06:01:00.217

您是否考虑过使用自定义图标来表示具有相同坐标的多个位置？您可以按照上面的建议将所有公共位置汇总到一个标记点​​中，而不是在公共位置（+/- .00001 纬度）的左右两侧添加看起来像按钮的其他标记点。比将单击事件附加到代理点，通过单击标记点将允许您在共享位置上的点之间进行迭代。您甚至可以根据数组中显示的当前制造商隐藏或禁用下一个和上一个标记。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T00:47:55.723

一种想法可能是仅绘制独特的位置，并将描述汇总到位置级别。对于叠加层，您可以显示该位置的完整地点列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-12T11:09:57.480

使用聚类 .make 标记组作为 cluster.one 群集将在内部显示许多标记。

# internet-explorer - 愚蠢的 IE 没有在组合框中显示选定的值

> ID：10508399
> 
> 赞同：0
> 
> 时间：2012-05-09T00:37:20.477
> 
> 标签：internet-explorer, combobox, selectedvalue

我在 IE 中遇到了一个奇怪的问题，其他浏览器没有发生。打开以下网站：

[http://www.clinicasdefertilidadenlima.pe/](http://www.clinicasdefertilidadenlima.pe/)

您将在此页面上看到 3 个显示“Lima”的组合框。单击任何组合并选择任何其他值，例如 Lima 或 Arequipa。页面将刷新，但现在组合不会显示应始终为“Lima”的选定值（我已对其进行硬编码）如果您查看视图源，那么它是一个简单的组合框，我什至定义了 selected="selected"对于“Lima”值，但在 IE 中，它仅在您打开主页时显示选定的值。之后，当您从组合框中选择值时，它不会显示值。

```
<select id="city_id" name="city_id" class="f2_city" onchange="redirect(this.form)">
    <option value="" selected="selected">LIMA</option>
    <option value="LIMA">LIMA</option>
    <option value="Arequipa">Arequipa</option>
</select> 
```

我正在使用 IE9。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T15:27:07.257

我使用适用于 IE7/8/9 Chrome/Firefox 等的 jquery n-th:child 选择器解决了问题。

```
var comboId = document.getElementById('YourDropDownListId');
var selectedIndex = comboId.selectedIndex;
var selector = '#TableName:nth-child(' + selectedIndex.toString() + ')';
var selectedTable = $(selector).val(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T04:18:24.083

我已经解决了这个问题。刚刚在页面中定义了这个。

```
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" > 
```

# jquery - 自定义 jQuery 选择框的问题 - 键盘导航

> ID：10508403
> 
> 赞同：0
> 
> 时间：2012-05-09T00:38:39.037
> 
> 标签：jquery

我有自定义选择框的问题，我已经使用此解决方案进行了自定义，例如：- [http://info.wsisiz.edu.pl/~suszynsk/jQuery/demos/jquery-selectbox/](http://info.wsisiz.edu.pl/~suszynsk/jQuery/demos/jquery-selectbox/)

我也尝试了很多其他的......结果总是一样的。问题仍然存在，我无法输入一个字母，例如德克萨斯州的“T”，而是一直向下滚动以选择德克萨斯州。

任何可能熟悉这个问题的人，这是一个错误还是它是如何工作的？

我检查了所有类似的问题，但没有找到正确的答案或解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T02:44:32.743

这种行为是意料之中的，因为 select HTML 标记替代了许多 HTML span 元素。在此插件中未实现选择标签和列表中选择的项目的行为按键。

您可以针对这种特定情况实施组件扩展。

# facebook-c#-sdk - 使用 Facebook SDK for Windows Phone 的文档在哪里？

> ID：10508404
> 
> 赞同：2
> 
> 时间：2012-05-09T00:38:48.813
> 
> 标签：facebook-c#-sdk, windows-phone-7.1, codeplex

嗨，在 Windows Phone 上使用 Facebook SDK 对用户进行身份验证的当前文档在哪里？我检查了 Codeplex ......但我没有找到任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T21:17:03.587

现在您可以在[https://github.com/facebook-csharp-sdk/facebook-windows-phone-sample查看 WP7 示例](https://github.com/facebook-csharp-sdk/facebook-windows-phone-sample)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T00:50:19.530

主要文档位于[http://csharpsdk.org/docs/](http://csharpsdk.org/docs/) - 在撰写本文时，还没有任何特定于 Windows Phone 的文档；也许您只是像任何其他库一样包含 SDK 和针对它的代码，而一般的 SDK 文档应该可以与 Windows 手机一起使用？

{edit} 通用文档确实谈到了 Windows Phone，FAQ 中也提到了它{/edit}

# mysql - 从本地服务器连接到 MySQL 很慢

> ID：10508418
> 
> 赞同：2
> 
> 时间：2012-05-09T00:40:23.347
> 
> 标签：mysql, apache, lighttpd

我刚开始使用 git 来管理我的网站的分发。我的站点正在运行一个 lighttpd 服务器和一个 Symfony 2 PHP 框架。它连接到远程 MySQL 服务器。当我将项目克隆到我的 mac（运行 Apache）时，该站点仍然可以运行，但速度非常慢。问题似乎与mysql连接有关。只执行几个额外的查询（10 个左右）会导致页面加载时间显着延长。托管我的站点的远程服务器运行良好，比我的本地副本快得多。

造成这种放缓的常见原因有哪些？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T08:30:15.143

首先，我会看一下“只是一些额外的查询”，看看这些查询是否花费了不合理的时间。

我假设您仍在本地副本上连接到远程 MySQL 服务器？如果是这种情况，问题可能是带宽。租用的服务器通常在 100Mbit+ 的连接上，因此与您家中的宽带相比，数据传输会相对相当。

当您的 Web 应用程序在本地副本上运行时，请尝试运行 SHOW PROCESSLIST；在 MySQL 服务器上。

最后，与服务器相比，您的 mac 有多强大？如果您的 Mac 功能不足，并且您还尝试运行 photoshop + illustrator + itunes 等，这将有所作为。

# iphone - 荷兰 iPhone 设置应用程序中的“区域格式”和“语言”

> ID：10508421
> 
> 赞同：0
> 
> 时间：2012-05-09T00:40:59.870
> 
> 标签：iphone, ios, cocoa-touch, regions

我应该在荷兰国家/地区的 iPhone 设置应用程序中选择什么作为“区域格式”和“语言”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T05:55:36.350

你必须使用：

```
 Region Format = Dutch

 Language = Nederlands 
```

# iphone - 有没有办法在我的 UIImageView.image 属性更改时收到通知？

> ID：10508422
> 
> 赞同：17
> 
> 时间：2012-05-09T00:41:05.217
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

有没有办法在 UIImageView.image 属性上设置观察者，以便我可以在属性更改时收到通知？也许与 NSNotification？我该怎么做呢？

我有大量的 UIImageViews，所以我还需要知道更改发生在哪一个上。

我该怎么做呢？谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-09T01:00:47.297

这称为键值观察。可以观察到任何符合键值编码的对象，这包括具有属性的对象。阅读[本编程指南](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html#//apple_ref/doc/uid/10000177i)，了解 KVO 的工作原理以及如何使用它。这是一个简短的示例（免责声明：它可能不起作用）

```
- (id) init
{
    self = [super init];
    if (!self) return nil;

    // imageView is a UIImageView
    [imageView addObserver:self
                forKeyPath:@"image"
                   options:NSKeyValueObservingOptionNew | NSKeyValueObservingOptionOld
                   context:NULL];

    return self;
}

- (void) observeValueForKeyPath:(NSString *)path ofObject:(id) object change:(NSDictionary *) change context:(void *)context
{
    // this method is used for all observations, so you need to make sure
    // you are responding to the right one.
    if (object == imageView && [path isEqualToString:@"image"])
    {
        UIImage *newImage = [change objectForKey:NSKeyValueChangeNewKey];
        UIImage *oldImage = [change objectForKey:NSKeyValueChangeOldKey];

        // oldImage is the image *before* the property changed
        // newImage is the image *after* the property changed
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-16T01:03:38.593

在 Swift 中，使用[KVO](https://developer.apple.com/documentation/swift/cocoa_design_patterns/using_key-value_observing_in_swift)。例如

```
imageView.observe(\.image, options: [.new]) { [weak self] (object, change) in
            // do something with image
        } 
```

更多讨论[如何在 Swift iOS 中检测 UIImageView 中的更改图像](https://stackoverflow.com/questions/67533596/how-i-detect-changes-image-in-a-uiimageview-in-swift-ios)

# c# - 在 datagridview 和表单之间传递数据的更有效方式

> ID：10508430
> 
> 赞同：3
> 
> 时间：2012-05-09T00:42:43.867
> 
> 标签：c#, mysql, visual-studio-2010, datagridview

我有一个程序，其中包含许多“创建新 [xxx]”表单（包含文本框、组合框、日期时间 picekrs 等），这些表单稍后会保存到数据库中。要查看该数据，我使用相应的表单“view [xxx]”，其中包含从数据库填充的 datagridview。

当用户单击 datagridview 中的字段时，数据应该被发送回原始的“创建”表单。

到目前为止，我一直在通过从 datagridview 传递整行数据来重载“创建”表单的构造函数：

例子：

查看表格：

```
private void dataGridView1_CellContentClick(object sender, DataGridViewCellEventArgs e)
    {
        if (e.RowIndex > -1)
        {
            ID = dataGridView1.Rows[e.RowIndex].Cells[0].FormattedValue.ToString();
            string posName = dataGridView1.Rows[e.RowIndex].Cells[1].FormattedValue.ToString();
            string posDesc = dataGridView1.Rows[e.RowIndex].Cells[2].FormattedValue.ToString();

            frmNewStaffPosition frm = new frmNewStaffPosition(posName, posDesc);

            frm.Show();
frm.NewTypePositionAdded += new frmNewStaffPosition.AddNewTypeOfStaffPosition(frm_NewTypePositionAdded); 
```

创建表格：

```
 public frmNewStaffPosition( string pos, string desc)
    {
        InitializeComponent();
        tbPositionName.Text = pos;
        tbNewStaffPositionDecription.Text = desc;

    } 
```

虽然这可行，但我认为它不是最好的解决方案，特别是如果从 VIEW 传递的数据包含许多列。有没有更优雅的解决方案，即只传递选定行的 PK 并直接从数据库填写 CREATE 表单？

如果那很重要，我通过 MySQL 连接器使用 MySQL 数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T01:40:35.130

通常我会遵循这些基本规则......

1）如果您正在查找/编辑特定记录数据，则仅将关键数据传递给构造函数到下一个表单。

2）如果您要使用默认值创建新数据，请将它们放入一个类中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T01:07:44.183

取决于负责什么。传递它们的密钥是一种方法，但是您必须将数据库代码添加到表单中。事实证明这将是混乱的耦合，并且看到您正在使用 FormattedValue，您必须重新实现它。

您可以敲出一个类以将数据放入并将其传递，并将所有往返的东西委托给该类，或者更好的是它实现的接口。

或者您可以保持原样，因为所有这些都在移动/隐藏您现在拥有的凌乱部分。

如果事实证明您的几个表单正在使用常见的数据分组，那么可能值得一看，如果不是，请不要认为我会打扰自己。

也就是说，我会更舒服地从网格底层的数据源（即数据行）传递，否则对于您将要转换/解析的任何非字符串值，除非表单仅将数据作为字符串处理.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T00:50:06.807

如果您的列少于几百列，只要您的列不是具有几 MB 数据的 BLOB，我猜这对您的程序来说不是性能障碍。如果您要传递数百（或数千）行，那将是一个完全不同的问题，但是即使您有 200 列左右的列在计算机上传递那么多数据也没什么，它可以做很多很多次一个你无法注意到的时间空间。

不要过早优化。您的程序是否运行缓慢以完成其工作？如果没有，请不要打扰，你已经完成了。如果是这样，请使用分析器查看比应有的时间更长的时间，并在那里寻找优化。

哦，如果你有超过一或两列，最好为每列创建一个包含字段的类，填充该类的一个实例，然后传递它。它比处理很多很多参数要容易得多。

# xml - SAXParseException：解析文档类型时文件过早结束

> ID：10508437
> 
> 赞同：0
> 
> 时间：2012-05-09T00:43:42.020
> 
> 标签：xml, xml-parsing, sax, doctype

我正在尝试使用 Java XML API 将 XML 文档从文件加载到文档中：

```
DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
DocumentBuilder db = dbf.newDocumentBuilder();
Document doc = db.parse(source); 
```

但是，对于特定的输入文档，我收到以下异常：

```
org.xml.sax.SAXParseException: Premature end of file.
    at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(Unknown Source)
    at javax.xml.parsers.DocumentBuilder.parse(Unknown Source)
    ... 
```

System.err 日志提到问题出在 location `:3:1`，在这个 XML 文档中，是 doctype 声明：

```
<?xml version='1.0' encoding='UTF-8'?>

<!DOCTYPE web-app PUBLIC
  "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
  "http://java.sun.com/dtd/web-app_2_3.dtd">

<web-app>
  ... 
```

如果我删除 doctype 声明，它工作正常。但在这种情况下我无法删除它。如何解决此错误？[Eclipse 错误 252787](https://bugs.eclipse.org/bugs/show_bug.cgi?id=252787)表明这可能是一个缓存问题，但我不在代理后面，并且 DTD URL 是有效的。有任何想法吗？

# c++ - 向量化嵌套循环 - SIMD

> ID：10508440
> 
> 赞同：0
> 
> 时间：2012-05-09T00:44:01.003
> 
> 标签：c++, parallel-processing, x86, vectorization, simd

有谁知道使用 SIMD 对这样的东西进行矢量化：

```
for(size_t i = 0; i < refSeq.length() / 4; i++){

    for(size_t j = 0; j<otherSeq.length(); j++){
    if(refSeq[i] == otherSeq[j]){
        if(i == 0 || j == 0)
            L[i][j] = 1;
       else
        L[i][j] = L[i-1][j-1] + 1;
    }
       else
        L[i][j] = 0;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2022-01-22T02:25:16.653

出于某种原因，@arunmoezhi 的解决方案没有自动矢量化。[https://godbolt.org/z/KM4fh8TY7](https://godbolt.org/z/KM4fh8TY7)

```
.L8:
        mov     edx, DWORD PTR [rax+4+r8]
        cmp     DWORD PTR [rcx], edx
        je      .L5
        mov     DWORD PTR [rsi+4+rax], 0
        add     rax, 4
        cmp     rdi, rax
        jne     .L8 
```

这是[eve](https://github.com/jfalcou/eve)库的一个实现：[https ://godbolt.org/z/j8Kva8caP](https://godbolt.org/z/j8Kva8caP)

主循环看起来像这样（avx2）只是展开：

```
.LBB0_5:                                # =>This Inner Loop Header: Depth=1
        vmovdqu ymm2, ymmword ptr [rax + rcx]
        vpcmpeqd        ymm3, ymm0, ymmword ptr [rsi + rcx]
        vpsubd  ymm2, ymm2, ymm1
        vpand   ymm2, ymm3, ymm2
        vmovdqu ymmword ptr [rdi + rcx], ymm2
        lea     rbx, [rsi + rcx]
        add     rbx, 32
        add     rcx, 32
        cmp     rbx, r11
        jne     .LBB0_5 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T08:36:44.620

让我试着提出一个解决方案。最初计算 L[i][0] 和 L[0][j] 的值。现在从 i=1 和 j=1 开始迭代。现在可以删除循环每次迭代中对 i==0 或 j==0 的检查。这样做的另一个优点是，对于一行的每次迭代中的每个 L[i][j]，L[i-1][j-1] 的值都是可用的。现在，假设向量寄存器是否可以容纳数组的 4 个元素。现在我们可以加载 refSeq、otherSeq、L(previous row) 和 L(current row) 的 4 个元素。理论上我们现在得到了矢量化。我假设自动矢量化器不会识别这一点。所以我们必须手动完成。如果我错了，请纠正我。

```
for(size_t i=0;i<refSeq.length()/4;i++)
{
    if(refSeq[i]==otherSeq[0])
        L[i][0]=1;
    else
        L[i][0]=0;
}
for(size_t j=0; j<otherSeq.length();j++)
{
    if(refSeq[0]==otherSeq[j])
        L[0][j]=1;
    else
        L[0][j]=0;
}

for(size_t i=1;i<refSeq.length()/4;i++)
{
    for(size_t j=1; j<otherSeq.length();j++)
    {
        if(refSeq[i]==otherSeq[j])
            L[i][j] = L[i-1][j-1] + 1;
        else
            L[i][j]=0;
    }
} 
```

一个缺点是，现在我们正在加载前一行，无论 refSeq[i] 是否等于 otherSeq[j] 与原始代码一样，其中仅当序列相等时才访问对角元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-14T20:58:25.347

这是一个动态规划问题，并且严格的前向实现具有太多的数据依赖性，不适合 SIMD 计算。

但是，如果您将算法从逐行迭代更改为对角迭代，则可以并行计算整个对角线。见下图。

[![在此处输入图像描述](../Images/09459af339825d2106430f3d29e4a948.png)](https://i.stack.imgur.com/srJ0l.png)

下面的“伪”代码使用具有 1 个额外行/列的矩阵来简化“内部”计算。这个额外的行/列在每次对角迭代之前初始化。

```
int i, j, k;
for (k = 1; ; k++) {
    int minI = k > refLen ? k - refLen : 1;
    int maxI = k > otherLen ? otherLen : k - 1;

    for (i = maxI; i >= minI; ) {
        j = k - i;

        // vectorized calculation 256 bit (AVX2)
        if (i >= 32 && otherLen - j >= 32) {
            // calculate 32 values of the diagonal with SIMD
            i -= 32;
            continue;
        }

        // vectorized calculation 128 bit (SSE)
        if (i >= 16 && otherLen - j >= 16) {
            // calculate 16 values of the diagonal with SIMD
            i -= 16;
            continue;
        }

        // scalar calculation
        if (refSeq[i - 1] == otherSeq[j - 1]) {
            L[i][j] = L[i - 1][j - 1] + 1;
        } else {
            L[i][j] = 0;
        }
        i--;
    }

    if (k == otherLen + refLen) {
        break;
    }

    // initialize next j-endpoint in diagonal
    if (k <= refLen) {
        L[0][k] = 0;
    }
    // initialize next i-endpoint in diagonal
    if (k <= otherLen) {
        L[k][0] = 0;
    }
} 
```

不确定您是否想要计算的实际 SIMD 指令，或者只知道如何并行化/矢量化计算。

# php - 使用 php 和 API 缩短链接

> ID：10508449
> 
> 赞同：0
> 
> 时间：2012-05-09T00:45:47.690
> 
> 标签：php, function, curl

我的页面上已经有一个从 curl 生成 url 的函数。我需要使用以下字符串以文本格式或使用 shortswitch.com api 的“简单”返回短 url。

这是我的代码：

```
<?php
$long_url = urlencode('curPageURL()');
$url = "http://api.shortswitch.com/shorten?apiKey=[apikey]&format=simple&longUrl={$long_url}";
$result = file_get_contents($url);
print_r($result);
?> 
```

我正在尝试使用我为 bit.ly 找到的功能与 shortswitch.com api 一起使用作为 shortswitch.com/admin/api。

我的问题是我没有从函数中获得任何类型的输出，也没有生成缩短的 url。

最好的祝福，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T01:26:50.847

我只是猜测您实际上是在尝试*调用*该函数`curPageURL()`并*对其结果*进行 url 编码，而不是对字符串“curPageURL()”进行 url 编码：

```
$long_url = urlencode(curPageURL()); 
```

# iphone - 如何将触摸限制为特定的纵横比？

> ID：10508457
> 
> 赞同：0
> 
> 时间：2012-05-09T00:47:41.600
> 
> 标签：iphone, ios, cocoa-touch, crop, touchesmoved

我需要根据特定的纵横比（正方形、4x3、5x7、8x10 等）绘制一个选择矩形，以便裁剪图像。我有一些非常普通的代码可以处理在 touchesBegan/Moved 内自由拖动矩形的 4 个角，但我花了很长时间让它限制在特定的纵横比而不爬行或不准确。

这是我目前拥有的一些伪代码：

```
// this assumes that the four hitPoints are already arranged in the desired aspect ratio 

CGPoint hitPoints[4]; // arranged botLeft=0, botRight=1, topRight=2, topLeft=3
CGPoint lastPoint;
CGRect cropRect;
int activeHitPoint;

#define kMinCropSize 20

- (void) touchesBegan
{
    lastPoint = [touches locationInView:self];
    activeHitPoint = [self getWhichPointTouched];
}

- (void) touchesMoved
{
    CGPoint thisPoint = [touches locationInView:self];
    float xDiff = thisPoint.x - lastPoint.x;
    float yDiff = thisPoint.y - lastPoint.y;

    float constrain = [self getAspectRatio];  // e.g.. 8x10  = 8/10 = 0.8 

    if(ABS(xDiff) > ABS(yDiff)){
        yDiff = xDiff * constrain;
        if(activeHitPoint == 1 || activeHitPoint == 3)
            yDiff *= -1;
    }else {
        xDiff = yDiff * constrain;
        if(activeHitPoint == 1 || activeHitPoint == 3)
            xDiff *= -1;
    }

    switch(activeHitPoint){
        case 0:
        if((hitPoints[0].x + xDiff > imageDisplayRect.origin.x) &&
           (hitPoints[0].x + xDiff + kMinCropSize < hitPoints[1].x) &&
           (hitPoints[0].y + yDiff > imageDisplayRect.origin.y) &&
           (hitPoints[0].y + yDiff + kMinCropSize < hitPoints[2].y)){
                hitPoints[0].x += xDiff;
                hitPoints[0].y += yDiff;
                hitPoints[3].x = hitPoints[0].x;
                hitPoints[1].y = hitPoints[0].y;
        }
        break;
        case 1:
        if((hitPoints[1].x + xDiff < imageDisplayRect.origin.x + imageDisplayRect.size.width) &&
           (hitPoints[1].x + xDiff - kMinCropSize > hitPoints[0].x) &&
           (hitPoints[1].y + yDiff > imageDisplayRect.origin.y) &&
           (hitPoints[1].y + yDiff + kMinCropSize < hitPoints[2].y)){
                hitPoints[1].x += xDiff;
                hitPoints[1].y += yDiff;
                hitPoints[2].x = hitPoints[1].x;
                hitPoints[0].y = hitPoints[1].y;
        }
        break;
        case 2:
        if((hitPoints[2].x + xDiff < imageDisplayRect.origin.x + imageDisplayRect.size.width) &&
           (hitPoints[2].x + xDiff - kMinCropSize > hitPoints[0].x) &&
           (hitPoints[2].y + yDiff < imageDisplayRect.origin.y + imageDisplayRect.size.height) &&
           (hitPoints[2].y + yDiff - kMinCropSize > hitPoints[1].y)){
                hitPoints[2].x += xDiff;
                hitPoints[2].y += yDiff;
                hitPoints[1].x = hitPoints[2].x;
                hitPoints[3].y = hitPoints[2].y;
        }
        break;
        case 3:
        if((hitPoints[3].x + xDiff > imageDisplayRect.origin.x) &&
           (hitPoints[3].x + xDiff + kMinCropSize < hitPoints[2].x) &&
           (hitPoints[3].y + yDiff < imageDisplayRect.origin.y + imageDisplayRect.size.height) &&
           (hitPoints[3].y + yDiff - kMinCropSize > hitPoints[0].y)){
                hitPoints[3].x += xDiff;
                hitPoints[3].y += yDiff;
                hitPoints[0].x = hitPoints[3].x;
                hitPoints[2].y = hitPoints[3].y;
        }
        break;
    }

    cropRect = CGRectMake(hitPoints[0].x, hitPoints[0].y, hitPoints[1].x - hitPoints[0].x, hitPoints[2].y - hitPoints[1].y);

    lastTouch = thisTouch;
    [self setNeedsDisplay];
} 
```

这段代码**几乎**可以工作，但它不是很准确......好像有舍入错误。随着时间的流逝，它会失去适当的纵横比，这令人惊讶……以及为什么我使用浮点数……但这似乎并不重要。

# iphone - 可以实现 UIScrollView 与可缩放和方面适合的内容？

> ID：10508460
> 
> 赞同：2
> 
> 时间：2012-05-09T00:47:53.810
> 
> 标签：iphone, uiscrollview, zooming, layoutsubviews

我想创建一个滚动视图，其工作方式与您在照片应用中平移/缩放图像完全一样：

- 横向图像适合纵向屏幕，

- 您可以放大图像，

- 如果您旋转设备放大（横向），图像仍然在中间，

- 当您缩小时，图像仍然适合新的横向屏幕（拉伸全屏）。

**因此，我需要同时满足宽高比和缩放功能。**

我已经实现了一个解决方案，我在 layoutSubviews 中“手动”布局 scrollView 的内容以使外观适合，但这会干扰缩放行为。

有没有一种简洁的 UIKit 方法来处理这个问题？或者我必须在这里创建自己的实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:58:24.913

您需要启用缩放（并设置最小和最大缩放比例），然后实现 scrollViewDidZoom。这是一些示例代码，可帮助您开始处理图像居中。您可以对其进行调整以执行其他部分：

```
- (void)scrollViewDidZoom:(UIScrollView *)scrollView 
{
    CGSize boundsSize = scrollView.bounds.size;
    CGRect frameToCenter = imageView.frame;

    // center horizontally
    if (frameToCenter.size.width < boundsSize.width)
        frameToCenter.origin.x = (boundsSize.width - frameToCenter.size.width) / 2;
    else
        frameToCenter.origin.x = 0;

    // center vertically
    if (frameToCenter.size.height < boundsSize.height)
        frameToCenter.origin.y = (boundsSize.height - frameToCenter.size.height) / 2;
    else
        frameToCenter.origin.y = 0;

    imageView.frame = frameToCenter;
} 
```

注意：此代码假定您在 UIScrollView 中保留对 UIImageView（本例中为 imageView）的引用。

# javascript - 当我按下按钮时，如何发现调用了哪个函数？

> ID：10508463
> 
> 赞同：0
> 
> 时间：2012-05-09T00:48:03.330
> 
> 标签：javascript

我一直在修改别人的源代码，不幸的是它没有被强烈记录。

我试图弄清楚当我按下按钮时调用哪个函数，作为追踪当前错误到它的来源的一部分，我没有运气。据我所知，该函数被动态添加到生成后的按钮。因此，没有 onlick="" 可供我检查，我在调试面板中找不到任何其他有帮助的东西。

虽然我更喜欢 Chrome，但如果需要，我更愿意在不同的浏览器中启动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T00:50:34.590

1.  打开浏览器的 JavaScript 调试器打开页面
2.  单击“全部中断”或等效项
3.  单击您希望调查的按钮（如果鼠标悬停在页面元素上会导致事件被触发，则可能需要一些技巧。如果页面中发生超时或间隔，它们也可能会妨碍您。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T00:59:11.623

检查按钮标记并查看其类/ID。使用该类或 id 并搜索 JavaScript，以前的开发人员很可能已经做过类似的事情

```
document.getElementById('someId').onclick = someFunction...; 
```

或者

`document.getElementById('someId').addEventListener("click", doSomething, false);`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T01:37:52.413

在 Chrome 中，页面完全加载后，在 URL 栏中输入以下内容（不要忘记更改按钮类）：

```
var b = document.getElementsByClassName("ButtonClass"); alert(b[0].onclick); 
```

或者您可以尝试（对正确的按钮 ID 进行适当的更改）：

```
var b = document.getElementById("ButtonID"); alert(b.onclick); 
```

这应该在消息框中提醒函数名称/代码片段。

获得函数名称或代码片段后，您只需通过 .js 文件执行片段/函数名称的搜索。

希望能帮助到你！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T00:51:35.713

您可以为每个函数添加一个跟踪变量。使用 console.log() 查看跟踪结果。

像这样：

```
function blah(trace) {
    console.log('blah called from: '+trace);
} 
```

（要查看结果，您必须打开开发者控制台）

# php - 如何从“变量”设置 HTML 中元素的宽度

> ID：10508465
> 
> 赞同：1
> 
> 时间：2012-05-09T00:48:08.007
> 
> 标签：php, html

我想设置我拥有的进度条的宽度，但由于 HTML 并没有真正的变量，我尝试了这个：

```
<span class="bar" style="width:<?php echo $goal_percent . '%'; ?>"></div> 
```

我知道这是错的，我只是不知道我会怎么做这样的事情？

编辑：这是我正在使用的更多代码：

```
 <?php
                            $goal_percent = $goal / 100;
                            $goal_percent = $goal * 100;
                            if($goal_percent == 0)
                            {
                            $goal_percent = 1;
                            }
                            $goal_percent = 50;
                            ?>

                            <span class="progress progress-success progress-striped active" style="margin-bottom: 9px;">
                        <span class="bar" style="width:<?php echo $goal_percent; ?>%"></span> 
```

我只是在测试之后将目标百分比设置为 50，以防数学出现其他问题。还是行不通。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T00:59:33.677

此代码将起作用。我只是测试它：

```
<html>
    <head><title>Test</title></head>
    <body>
        <?php $goal_percent=50; ?>
        <div class="bar" style="width:<?php echo $goal_percent; ?>%"></div>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T00:58:29.113

只要`$goal_percent`是有效的 int/float 变量。就像@LawrenceCherone 提到的：

```
<span class="bar" style="width:<?php echo $goal_percent; ?>%"></span> 
```

# html - 文本与引导程序的 navbar-text pull-right 未正确对齐

> ID：10508466
> 
> 赞同：5
> 
> 时间：2012-05-09T00:48:25.967
> 
> 标签：html, css, twitter-bootstrap

我在 html 文件中有以下代码：

```
 <div class="navbar navbar-fixed-top">
          <div class="navbar-inner">
              <div class="container-fluid">
                  <a href="index.html" class="brand">Hello Bootstrap</a>
                  <p class="navbar-text pull-right">This is first notice.</p><br/>
                  <p class="navbar-text pull-right">This is second notice. </p>
              </div>
          </div>
  </div> 
```

我得到这样的输出：

![在此处输入图像描述](../Images/26297eda1ebb6a9f4f489710a69966b4.png)

请注意，“这是第二个通知”相对于它上面的行没有正确对齐。我试图让这两个通知彼此正确对齐。

我也尝试`<br/>`从上面的代码中删除，但我得到以下输出： ![在此处输入图像描述](../Images/31e3e3d3b97b5d1cd506a76e279daa8d.png)

有人可以指出我做错了什么吗？

JSFiddle：http: [//jsfiddle.net/N6vGZ/23/](http://jsfiddle.net/N6vGZ/23/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-09T19:41:29.477

两个段落在导航栏中没有正确对齐的原因是引导程序设置的默认值`line-height`不允许`40px`它们都正确堆叠。你可以通过设置一个 lower 来解决这个问题，`line-height`就像`20px`应该做的那样。

注意：我将这两个段落都包含在一个容器中，我可以轻松地使用我自己的类浮动和定位，以免打扰它周围的其他元素。

**HTML**

```
<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container-fluid">
            <a href="index.html" class="brand">Hello Bootstrap</a>
            <div class="notices pull-right">
                <p class="navbar-text">This is first notice.</p>
                <p class="navbar-text">This is second notice.</p>
            </div>
        </div>
    </div>
</div> 
```

尝试这个：

**CSS**

```
.notices p {
    line-height:20px !important;
} 
```

演示：http: [//jsfiddle.net/N6vGZ/29/](http://jsfiddle.net/N6vGZ/29/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T00:58:18.050

您没有包含 css，但我假设您的“pull-right”类中有“float:right”。

我认为解决它的最简单方法是将两个 p 包装在它们自己的 div 中并向右浮动：

```
<div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
          <div class="container-fluid">
              <a href="index.html" class="brand">Hello Bootstrap</a>
              <div class="pull-right">
                   <p class="navbar-text">This is first notice.</p>
                   <p class="navbar-text">This is second notice. </p>
              </div>
          </div>
      </div> 
```

如果您还没有在 CSS 中设置“pull-right”类的宽度，请不要忘记设置宽度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T05:49:11.500

You can use ul with nav class and li with pull-right

[http://jsfiddle.net/N6vGZ/28/](http://jsfiddle.net/N6vGZ/28/)

# mvvm - 是否应该允许 View 在 MVVM 中打开另一个 View

> ID：10508468
> 
> 赞同：1
> 
> 时间：2012-05-09T00:48:36.133
> 
> 标签：mvvm

让我们举这个例子。我有一个绑定到 AViewModel 的 AView。AView 应该在 AViewModel 上执行一个 ACommand，并传递一个参数。问题是 ViewA 没有足够的信息传递给命令，因此需要显示另一个 BView，以便从用户那里收集信息。VIewB 关闭后，ViewA 调用 AViewModel 上的 ACommand，并将参数传递给它。

如何处理这种情况？我是否应该允许 AView 直接与 BView 通信，或者如果我这样做我违反了某些规则？

我在想的另一种方法是在没有参数的情况下在 AViewModel 上调用 ACommand，然后从 VIewModelA 发送一条消息，说明完成任务需要信息。此信息由 MainPageViewModel 捕获，然后发送打开 BView 的请求，该请求绑定到 BViewModel。当 BView 关闭时，BVIewModel 会发送一条带有附加信息的消息，而 ViewModelA 已经订阅了该类型的消息，因此它会收到它，并完成任务。仅在两个文本框中输入值相当复杂，对吧？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T08:41:01.570

MVVM 有 3 条黄金法则：`Separation, Separation & Separation`:)

原因包括：组件的自动化测试、功能的完全分离（例如，对于独立模块）、模块的独立团队开发（不会相互绊倒）以及通常更容易弄清楚*什么做什么*。

**为了回答您互连的两个视图：**您正在添加不应该存在的依赖项。关注点的分离比一点点的复杂性更重要（*我认为消息传递模型没有保持直接互连那么复杂*）。

与互连不相关组件的危害相比，发布/侦听额外消息的复杂性微不足道，因此您的最后一个建议是“更好”，但我实际上建议对整个问题采取更简洁的方法：

## 一些指导方针：

*   视图不应该知道他们的数据来自哪里，只知道如何显示某种形状的数据。命令执行是通过绑定到 VM 上的 ICommands 来执行的。
*   ViewModel 应该保存某种形式的数据和命令。它应该不知道数据来自哪里或与之绑定的内容。
*   模型保存实际数据，但不知道它在哪里被使用。
*   控制器（在 MVVM 中经常被忽略）注册/推送事件，从模型中填充虚拟机，在 ICommands 中设置代码，控制视图的可见性等。控制器是唯一真正需要始终保留在内存中的东西，而且它们非常纤薄（主要是代码和少量数据）。

基本上我会建议将控制器添加到您的 MVVM 模式（MVCVM？）。应用程序/模块创建和初始化控制器。控制器订阅事件并提供应用程序的逻辑。

试试这个模式，看看使用大量视图、视图模型和模型变得多么简单。*您没有提及您使用的是什么语言或框架，因此我无法对示例提出具体建议。*

# javascript - Javascript：区分用户或脚本引发的更改事件

> ID：10508469
> 
> 赞同：1
> 
> 时间：2012-05-09T00:48:52.503
> 
> 标签：javascript, jquery, javascript-events

我遇到了一些脚本更改选择/收音机/复选框的情况。这会触发 change 事件。但是，我需要一个单独的事件来告诉我用户更改了元素。显然，当从脚本触发更改时，它会注册为用户更改。

当您更改选择/收音机/复选框的值时，有没有办法阻止脚本触发更改事件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T00:56:02.273

[`jQuery.trigger()`](http://api.jquery.com/trigger/)从代码触发事件时使用并传递一个附加参数。

例如：

```
$('select').bind('change', function(e, isScriptInvoked) {
    if (isScriptInvoked === true) {
        // some code for when artificial
    } else {
        // some code for when organic
    }
});

// Trigger the event.
$('select').trigger('change', [true]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T00:52:07.237

尝试：

```
function changeEvent(){
    if(this.type.toLowerCase()=='select' || this.type.toLowerCase()=='radio' || this.type.toLowerCase()=='checkbox')
        return false;
    else{
        //Your code here
    }
} 
```

# html - 在 div 标签中显示长文本

> ID：10508472
> 
> 赞同：0
> 
> 时间：2012-05-09T00:49:45.870
> 
> 标签：html, css

如果我在 div 中写长文本，长文本会超出 div 墙。如何将其显示为多行？

我的测试代码如下

```
<html>
<body>
<div style="left: 700px; top: 150px; width: 400px; height: 360px; border:1px solid">1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T00:52:07.723

使用 CSS`word-wrap`属性：

```
div {
     word-wrap: break-word;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T03:29:38.643

您需要分析内容并决定允许的换行点。在您的问题中，内容是一串数字。它可以在任何数字之后，或者每三个数字之后被打破，或者如何？真实的内容可能有所不同，并且可能有允许的断点，具体取决于其类型。例如，有打破 URL 的规则，有打破数学表达式的规则，还有打破不使用单词之间空格的语言中的文本的规则。

一旦你知道你希望在哪里允许中断，最可靠的方法是`<wbr>`在每个允许的中断点插入标签。符合标准的方法，现在几乎一样广泛使用，是插入零宽度空格字符，例如使用字符引用`&#x200b;`。更多信息：[http ://www.cs.tut.fi/~jkorpela/html/nobr.html#suggest](http://www.cs.tut.fi/~jkorpela/html/nobr.html#suggest)

在任何点都是允许的断点的非常特殊的情况下，`word-wrap: break-word`可以使用 CSS 声明：它很紧凑，并且适用于现代浏览器（请参阅[http://caniuse.com/#feat=wordwrap](http://caniuse.com/#feat=wordwrap)支持）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T01:16:39.477

如果没有空格字符，你不能使用自动换行，所以你不能这样做！！！

# java - 如何编写排除范围值的正则表达式？

> ID：10508473
> 
> 赞同：0
> 
> 时间：2012-05-09T00:49:56.847
> 
> 标签：java, regex

我有：

```
[a-zA-Z0-9[^lL]][a-zA-Z0-9[^oO]][a-zA-Z0-9[^kK]] 
```

我只是在玩正则表达式，并想创建一个正则表达式，它可以接受任何三个字母数字字符，而不是 'lok' 的任意大小写组合。出于某种原因，我现在接受了输入 lok。我的错误在哪里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T00:57:42.937

您将`l`,`o`和包括`k`在`a-zA-Z`. 如果你想用另一个你需要使用`&&`的字符类来否定这些字母（[交集](http://www.javamex.com/tutorials/regular_expressions/character_classes.shtml)）。

你想要的是这样的：

```
[a-zA-Z0-9&&[^lL]][a-zA-Z0-9&&[^oO]][a-zA-Z0-9&&[^kK]] 
```

但是，根据您要执行的操作，您可能会通过[负面的lookahead/lookbehind](http://www.regular-expressions.info/lookaround.html)来完成您的任务。

# r - gnls{nlme} 中的步骤减半问题

> ID：10508474
> 
> 赞同：0
> 
> 时间：2012-05-09T00:49:57.957
> 
> 标签：r, regression, linear-regression

我正在尝试估计一些社区数据的广义最小二乘回归的参数。我已经成功地为一组数据完成了此操作，但是当我尝试使用相同的技术来估计另一组的参数时，我收到以下错误消息：

```
Error in gnls(SF ~ a * Site_Code^b, data = data, weights = varPower(form = ~Site_Code),  : 
  Step halving factor reduced below minimum in NLS step 
```

我注意到其他人也有同样的问题。一种建议的解决方案是使用 gnlsControl 将 nlsTol 设置为 0.1 而不是 0.001（默认值），但是当我这样做时，我遇到了同样的问题。我的数据如下所示：

```
Site_Code   SF
5   3
5   0
5   2
5   0
5   0
5   0
5   2
5   0
5   0
5   0
5   0
5   3
1   0
1   1
1   29
1   15
1   7
1   0
1   10
1   12
1   55
2   0
2   5
2   0
2   0
2   3
2   24
2   49
2   17
2   1
3   4
3   48
3   7
3   1
3   31
3   0
3   0
3   1
4   8
4   16
4   29
4   0
4   1
4   2
4   1
4   7
4   3
7   2
7   0
7   0
7   0
7   0
7   0
7   2
7   1
7   0
7   1
7   0
7   0
8   1
8   2
8   1
8   2
8   0
8   0
8   3
8   0
8   2
6   0
6   6
6   0
6   0
6   0
6   0
6   0
6   0
6   0
6   2
6   0
6   3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T02:23:23.013

对我来说工作得很好；你没有给出起始值，所以我看了一些。也许您的起始值更差？

此外，您在这里遇到麻烦也就不足为奇了——为了拟合均值，您有两个参数并且只有 4 个独立的 x 值……对于方差估计也是如此。

```
dat <- read.table("gnlsdat.txt",header=TRUE)
plot(SF~Site_Code,data=x)

library(nlme)
g0 <- gnls(SF ~ a * Site_Code^b, data = dat,
           weights = varPower(form = ~Site_Code),
           start=list(a=30,b=-0.5)) 
```

结果：

```
Generalized nonlinear least squares fit
  Model: SF ~ a * Site_Code^b 
  Data: dat 
  Log-likelihood: -130.3289

Coefficients:
        a         b 
19.319493 -1.152149 

Variance function:
 Structure: Power of variance covariate
 Formula: ~Site_Code 
 Parameter estimates:
    power 
-0.885528 
Degrees of freedom: 33 total; 31 residual
Residual standard error: 28.10023 
```

阴谋：

```
plot(SF~Site_Code,data=x)
pframe <- data.frame(Site_Code=seq(1,5,length=41))
lines(pframe$Site_Code,predict(g0,newdata=pframe)) 
```

![在此处输入图像描述](../Images/6dde2e8439979d5890a55f8f4ec8215c.png)

# jsf - 在 JSF 中限制文件上传大小

> ID：10508477
> 
> 赞同：3
> 
> 时间：2012-05-09T00:50:14.327
> 
> 标签：jsf, file-upload, tomahawk

我正在使用 Tomahawk inputFileUpload 组件来允许用户将文件上传到服务器。我通过在文件上传后检查文件大小并在文件太大时显示错误来实现“软”文件大小限制。但是，我还想要一个更大的“硬”​​限制，一旦超过限制，上传就会立即停止。例如，如果硬限制为 500MB，并且用户尝试上传 2GB 的文件，则上传将在 500MB 上传后立即停止并显示错误。

我曾希望使用 MyFaces ExtensionsFilter 并设置 uploadMaxFileSize 可以解决问题，但在引发 SizeLimitExceededException 之前文件已完全上传。

是否有可能做到这一点？理想情况下，我仍然可以使用 Tomahawk，但任何其他解决方案都会很好。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-09T01:47:50.847

Web 服务器不能中途中止 HTTP 请求然后返回 HTTP 响应。整个 HTTP 请求必须被完全消耗，直到最后一位才能返回 HTTP 响应。这就是 HTTP 和 TCP/IP 的本质。使用服务器端编程语言对它无能为力。

请注意，Tomahawk 文件上传大小限制已经考虑到服务器的内存/磁盘空间不会在达到大小限制时被整个上传的文件污染。

最好的办法是在上传之前在 JavaScript 中验证文件长度。这在[支持](http://caniuse.com/#feat=fileapi)HTML5 [`File`](http://dev.w3.org/2006/webapi/FileAPI/)API 的浏览器中受支持。当前版本的 Firefox、Chrome、Safari、Opera 和 Android 都支持它。IE9还不支持，以后的IE10会支持。

```
<t:inputFileUpload ... onchange="checkFileSize(this)" /> 
```

像这样的东西

```
function checkFileSize(inputFile) {
    var max = 500 * 1024 * 1024; // 500MB

    if (inputFile.files && inputFile.files[0].size > max) {
        alert("File too large."); // Do your thing to handle the error.
        inputFile.value = null; // Clears the field.
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-27T22:59:00.420

试试这个：

```
<div>
    <p:fileUpload id="fileUpload" name="fileUpload" value="#{controller.file}" mode="simple" rendered="true"/>
    <input type="button" value="Try it" onclick="checkFileSize('fileUpload')" />

</div> 
```

当用户单击“尝试”按钮时，将调用 checkFileSize() 函数并验证 fileUpload primefaces 组件。如果文件大小大于 500MB，则不会上传文件。

```
<script>
    // <![CDATA[
        function checkFileSize(name) {
            var max = 500 * 1024 * 1024; // 500MB
            var inputFile = document.getElementsByName(name)[0];
            var inputFiles = inputFile.files; 

            if (inputFiles.lenght > 0 && inputFiles[0].size > max) {
                alert("File too large."); // Do your thing to handle the error.
                inputFile.value = null; // Clears the field.
            }
        }
    // ]]>
</script> 
```

checkFileSize() 逻辑基于上面回答的[BalusC 。](https://stackoverflow.com/users/157882/balusc)

测试的版本：

素面3.5

JSF 2.1

# core-data - CoreData - 原始访问器作为属性？

> ID：10508479
> 
> 赞同：0
> 
> 时间：2012-05-09T00:50:33.077
> 
> 标签：core-data

阅读[此处](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/CoreData/Articles/cdAccessorMethods.html#//apple_ref/doc/uid/TP40002154-SW14)的 Apple 文档，示例代码将原始访问器和修改器声明为类别中的单独方法。是否可以使用`@property`声明原语？这样做有缺点吗？似乎它节省了样板代码，但是以这种方式声明的方法的生成方式是否存在性能影响？什么是可选属性——（强的，非原子的）？

*苹果的示例代码*

```
@interface Department : NSManagedObject

@property(nonatomic, retain) NSString *name;

@end

@interface Department (PrimitiveAccessors)
- (NSString *)primitiveName;
- (void)setPrimitiveName:(NSString *)newName;
@end 
```

*建议更改*

```
@interface Department : NSManagedObject

@property(nonatomic, retain) NSString *name;

@end

@interface Department (PrimitiveAccessors)

@property (strong, nonatomic) NSString *primitiveName;

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:56:27.863

您应该自动为您的核心数据实体生成类。您可以通过按下编辑器菜单并选择“创建 NSManagedObject 子类”来执行此操作。这将自动为您的每个实体创建一个类，并且这些实体将具有您想要的属性。

如果您想自定义这些类，我强烈建议您在一个类别中进行。我推荐这个，因为你可能想回到你的数据模型并添加或删除一个属性，因此你将不得不生成新的子类。在这种情况下，您可能对子类所做的任何更改都将被覆盖，这可能会很痛苦:)

# node.js - Socket.io 检测客户端断开连接时

> ID：10508483
> 
> 赞同：4
> 
> 时间：2012-05-09T00:50:47.283
> 
> 标签：node.js, socket.io

我正在编写一个应用程序，当用户访问我的站点时我打开一个套接字，当用户在站点上时通过套接字发送数据来记录信息，并在用户离开站点后将信息存储在数据库中。

我目前面临的问题是，虽然我可以检测到套接字何时与我的服务器断开连接，但我不知道哪个套接字对应于什么信息，所以我不知道将哪些信息存储到数据库中。

下面是我认为我需要输入代码的地方

```
socket.on('disconnect',function() {
  //insert data corresponding to current socket into database
  console.log('The client has disconnected!');
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T03:51:53.640

听起来您想保持某种与套接字连接相关的状态。我认为您正在寻找的是 socket.io 会话。

网上有很多例子，这个线程有很多很好的信息：[socket.io 和 session？](https://stackoverflow.com/questions/4641053/socket-io-and-session)

我发现这特别有用：[http ://www.danielbaulig.de/socket-ioexpress/](http://www.danielbaulig.de/socket-ioexpress/)

# objective-c - 获取所有用户与消息到/从当前用户排序最近的事件

> ID：10508484
> 
> 赞同：0
> 
> 时间：2012-05-09T00:51:01.420
> 
> 标签：objective-c, core-data

我有两个核心数据实体，用户和消息。一个用户实体是“当前用户”。我需要显示一个消息屏幕，显示当前用户和任何其他用户之间的任何通信。我在这里使用核心数据关系 - 聊天具有 ToUser 和 fromUser 关系，其相反是 chatsFrom 和 chatsTo。

我在 User 实体上有一个 mostRecentMessageTimestamp 瞬态属性，用于排序。

因此，用简单的语言，我想获取与当前用户通信的所有配置文件，然后将最新的配置文件放在顶部。我盯着一个 NSPredicate 试图找出语法并失败了 - 任何人都可以启发我吗？

# asp.net - “/”应用程序中的服务器错误 (ASP.net)

> ID：10508486
> 
> 赞同：1
> 
> 时间：2012-05-09T00:51:13.110
> 
> 标签：asp.net

我正在使用 Visual Studio 2010 在 ASP .Net 中开发一个网站。我还没有附加任何数据库，它是带有大量 CSS 和一点点 Visual Basic 的纯 html。我从一家公司租用了 Web 服务器空间。我使用 FileZilla 上传了已发布的内容并将它们放在 wwwroot 目录中。当我从浏览器访问该网站时，我收到以下错误：

* * *

“/”应用程序中的服务器错误。

**运行时错误描述：**服务器上发生应用程序错误。此应用程序的当前自定义错误设置可防止远程查看应用程序错误的详细信息（出于安全原因）。但是，它可以被本地服务器机器上运行的浏览器查看。

**详细信息：**要在远程计算机上查看此特定错误消息的详细信息，请在位于当前 Web 应用程序根目录的“web.config”配置文件中创建一个标签。然后，此标记应将其“模式”属性设置为“关闭”。

```
<!-- Web.Config Configuration File -->

<configuration>
    <system.web>
        <customErrors mode="Off"/>
    </system.web>
</configuration> 
```

**注意：**您看到的当前错误页面可以通过修改应用程序配置标记的“defaultRedirect”属性以指向自定义错误页面 URL 来替换为自定义错误页面。

```
 <!-- Web.Config Configuration File -->

<configuration>
    <system.web>
        <customErrors mode="RemoteOnly" defaultRedirect="mycustompage.htm"/>
    </system.web>
</configuration> 
```

* * *

我用谷歌搜索并找到了一些答案，但没有一个适合我的情况。我应该提到我正在使用 Windows 7 和 IIS7，并且该站点在本地运行良好。我认为我可能在代码中犯了错误，所以我尝试上传 Visual Studio 默认的模板网站。但同样的错误仍然出现。我试图上传一个纯 html 网站，它工作。我试图制作一个简单的“hello world”aspx 和 asp 文件，它成功了。有没有人遇到过同样的问题，如果有，如何解决？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T06:11:29.097

放入`<customErrors mode="Off"/>`web.config，然后它会显示详细错误。在这一点上很难说什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-24T14:51:15.880

此错误可能是由未在 IIS 中配置为应用程序的虚拟目录引起的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-27T12:29:29.530

`<system.codedom> ...... </system.codedom>` 从*Web.config*文件中删除部分

# python - 使用ElementTree在python中解析xml

> ID：10508487
> 
> 赞同：4
> 
> 时间：2012-05-09T00:51:23.873
> 
> 标签：python, xml, parsing, xml-parsing

我对 python 很陌生，我需要解析一些需要先清理的脏 xml 文件。

我有以下python代码：

```
import arff
import xml.etree.ElementTree
import re

totstring=""

with open('input.sgm', 'r') as inF:
    for line in inF:
        string=re.sub("[^0-9a-zA-Z<>/\s=!-\"\"]+","", line)
    totstring+=string

data=xml.etree.ElementTree.fromstring(totstring)

print data

file.close 
```

解析：

```
<!DOCTYPE lewis SYSTEM "lewis.dtd">
<REUTERS TOPICS="YES" LEWISSPLIT="TRAIN" CGISPLIT="TRAINING-SET" OLDID="5544" NEWID="1">
<DATE>26-FEB-1987 15:01:01.79</DATE>
<TOPICS><D>cocoa</D></TOPICS>
<PLACES><D>el-salvador</D><D>usa</D><D>uruguay</D></PLACES>
<PEOPLE></PEOPLE>
<ORGS></ORGS>
<EXCHANGES></EXCHANGES>
<COMPANIES></COMPANIES>
<UNKNOWN> 
&#5;&#5;&#5;C T
&#22;&#22;&#1;f0704&#31;reute
u f BC-BAHIA-COCOA-REVIEW   02-26 0105</UNKNOWN>
<TEXT>&#2;
<TITLE>BAHIA COCOA REVIEW</TITLE>
<DATELINE>    SALVADOR, Feb 26 - </DATELINE><BODY>Showers continued throughout the week in
the Bahia cocoa zone, alleviating the drought since early
January and improving prospects for the coming temporao,
although normal humidity levels have not been restored,
Comissaria Smith said in its weekly review.
    The dry period means the temporao will be late this year.
    Arrivals for the week ended February 22 were 155,221 bags
of 60 kilos making a cumulative total for the season of 5.93
mln against 5.81 at the same stage last year. Again it seems
that cocoa delivered earlier on consignment was included in the
arrivals figures.
    Comissaria Smith said there is still some doubt as to how
much old crop cocoa is still available as harvesting has
practically come to an end. With total Bahia crop estimates
around 6.4 mln bags and sales standing at almost 6.2 mln there
are a few hundred thousand bags still in the hands of farmers,
middlemen, exporters and processors.
    There are doubts as to how much of this cocoa would be fit
for export as shippers are now experiencing dificulties in
obtaining +Bahia superior+ certificates.
    In view of the lower quality over recent weeks farmers have
sold a good part of their cocoa held on consignment.
    Comissaria Smith said spot bean prices rose to 340 to 350
cruzados per arroba of 15 kilos.
    Bean shippers were reluctant to offer nearby shipment and
only limited sales were booked for March shipment at 1,750 to
1,780 dlrs per tonne to ports to be named.
    New crop sales were also light and all to open ports with
June/July going at 1,850 and 1,880 dlrs and at 35 and 45 dlrs
under New York july, Aug/Sept at 1,870, 1,875 and 1,880 dlrs
per tonne FOB.
    Routine sales of butter were made. March/April sold at
4,340, 4,345 and 4,350 dlrs.
    April/May butter went at 2.27 times New York May, June/July
at 4,400 and 4,415 dlrs, Aug/Sept at 4,351 to 4,450 dlrs and at
2.27 and 2.28 times New York Sept and Oct/Dec at 4,480 dlrs and
2.27 times New York Dec, Comissaria Smith said.
    Destinations were the U.S., Covertible currency areas,
Uruguay and open ports.
    Cake sales were registered at 785 to 995 dlrs for
March/April, 785 dlrs for May, 753 dlrs for Aug and 0.39 times
New York Dec for Oct/Dec.
    Buyers were the U.S., Argentina, Uruguay and convertible
currency areas.
    Liquor sales were limited with March/April selling at 2,325
and 2,380 dlrs, June/July at 2,375 dlrs and at 1.25 times New
York July, Aug/Sept at 2,400 dlrs and at 1.25 times New York
Sept and Oct/Dec at 1.25 times New York Dec, Comissaria Smith
said.
    Total Bahia sales are currently estimated at 6.13 mln bags
against the 1986/87 crop and 1.06 mln bags against the 1987/88
crop.
    Final figures for the period to February 28 are expected to
be published by the Brazilian Cocoa Trade Commission after
carnival which ends midday on February 27.
 Reuter
&#3;</BODY></TEXT>
</REUTERS> 
```

我现在如何才能从正文标签中获取文本？

我见过的所有教程都依赖于直接从文件中读取 xml，以便 Elementtree.parse 工作。当我试图从一个字符串中解析时，这将不起作用，这破坏了我读过的很多教程。

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T01:44:06.687

你的第一个线索可能是当你收到这样的消息时......

```
>>> from xml.etree import ElementTree
>>> parse = ElementTree.parse('foo.xml')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.6/xml/etree/ElementTree.py", line 862, in parse
    tree.parse(source, parser)
  File "/usr/lib/python2.6/xml/etree/ElementTree.py", line 586, in parse
    parser.feed(data)
  File "/usr/lib/python2.6/xml/etree/ElementTree.py", line 1245, in feed
    self._parser.Parse(data, 0)
xml.parsers.expat.ExpatError: reference to invalid character number: line 11, column 0
>>> 
```

此错误来自 XML 源中的无效字符。您需要清理无效字符（请参阅`fix_xml.py`我的答案底部）。

有了干净的 XML 之后，就很容易了。您应该使用`StringIO`将字符串视为文件：

```
>>> from xml.etree import ElementTree
>>> from StringIO import StringIO
>>> text = open('foo.xml', 'r').read()
>>> tree = ElementTree.parse(StringIO(text))
>>> tree.find('//BODY')
<Element BODY at b723cf2c>
>>> tree.find('//BODY').text
'Showers continued throughout the week in\nthe Bahia cocoa zone, alleviating the drought since early\nJanuary and improving prospects for the coming temporao,\nalthough normal humidity levels have not been restored,\nComissaria Smith said in its weekly review.\n    The dry period means the temporao will be late this year.\n    Arrivals for the week ended February 22 were 155,221 bags\nof 60 kilos making a cumulative total for the season of 5.93\nmln against 5.81 at the same stage last year. Again it seems\nthat cocoa delivered earlier on consignment was included in the\narrivals figures.\n    Comissaria Smith said there is still some doubt as to how\nmuch old crop cocoa is still available as harvesting has\npractically come to an end. With total Bahia crop estimates\naround 6.4 mln bags and sales standing at almost 6.2 mln there\nare a few hundred thousand bags still in the hands of farmers,\nmiddlemen, exporters and processors.\n    There are doubts as to how much of this cocoa would be fit\nfor export as shippers are now experiencing dificulties in\nobtaining +Bahia superior+ certificates.\n    In view of the lower quality over recent weeks farmers have\nsold a good part of their cocoa held on consignment.\n    Comissaria Smith said spot bean prices rose to 340 to 350\ncruzados per arroba of 15 kilos.\n    Bean shippers were reluctant to offer nearby shipment and\nonly limited sales were booked for March shipment at 1,750 to\n1,780 dlrs per tonne to ports to be named.\n    New crop sales were also light and all to open ports with\nJune/July going at 1,850 and 1,880 dlrs and at 35 and 45 dlrs\nunder New York july, Aug/Sept at 1,870, 1,875 and 1,880 dlrs\nper tonne FOB.\n    Routine sales of butter were made. March/April sold at\n4,340, 4,345 and 4,350 dlrs.\n    April/May butter went at 2.27 times New York May, June/July\nat 4,400 and 4,415 dlrs, Aug/Sept at 4,351 to 4,450 dlrs and at\n2.27 and 2.28 times New York Sept and Oct/Dec at 4,480 dlrs and\n2.27 times New York Dec, Comissaria Smith said.\n    Destinations were the U.S., Covertible currency areas,\nUruguay and open ports.\n    Cake sales were registered at 785 to 995 dlrs for\nMarch/April, 785 dlrs for May, 753 dlrs for Aug and 0.39 times\nNew York Dec for Oct/Dec.\n    Buyers were the U.S., Argentina, Uruguay and convertible\ncurrency areas.\n    Liquor sales were limited with March/April selling at 2,325\nand 2,380 dlrs, June/July at 2,375 dlrs and at 1.25 times New\nYork July, Aug/Sept at 2,400 dlrs and at 1.25 times New York\nSept and Oct/Dec at 1.25 times New York Dec, Comissaria Smith\nsaid.\n    Total Bahia sales are currently estimated at 6.13 mln bags\nagainst the 1986/87 crop and 1.06 mln bags against the 1987/88\ncrop.\n    Final figures for the period to February 28 are expected to\nbe published by the Brazilian Cocoa Trade Commission after\ncarnival which ends midday on February 27.\n Reuter\n'
>>> 
```

我从 XML 源中删除了以下字符以清理它...

```
(py26_default)[mpenning@Bucksnort ~]$ python fix_xml.py foo.xml
bar.xml
343 &#5;
347 &#5;
351 &#5;
359 &#22;
364 &#22;
369 &#1;
378 &#31;
444 &#2;
3393 &#3;
(py26_default)[mpenning@Bucksnort ~]$ 
```

请记住，还有其他方法可以做到这一点……[`lxml.soupparser`](http://lxml.de/elementsoup.html)也可以清除不良的 XML。示例`lxml.soupparser`使用

```
from lxml.html import soupparser
from StringIO import StringIO
try:
    parser = XMLParser(ns_clean=True, recover=True)
    tree = ET.parse(StringIO(text), parser)
except UnicodeDecodeError:
    tree = soupparser.parse(StringIO(text)) 
```

* * *

## 清理了xml

```
<!DOCTYPE lewis SYSTEM "lewis.dtd">
<REUTERS TOPICS="YES" LEWISSPLIT="TRAIN" CGISPLIT="TRAINING-SET" OLDID="5544" NEWID="1">
<DATE>26-FEB-1987 15:01:01.79</DATE>
<TOPICS><D>cocoa</D></TOPICS>
<PLACES><D>el-salvador</D><D>usa</D><D>uruguay</D></PLACES>
<PEOPLE></PEOPLE>
<ORGS></ORGS>
<EXCHANGES></EXCHANGES>
<COMPANIES></COMPANIES>
<UNKNOWN>
C T
f0704reute
u f BC-BAHIA-COCOA-REVIEW   02-26 0105</UNKNOWN>
<TEXT>
<TITLE>BAHIA COCOA REVIEW</TITLE>
<DATELINE>    SALVADOR, Feb 26 - </DATELINE><BODY>Showers continued throughout the week in
the Bahia cocoa zone, alleviating the drought since early
January and improving prospects for the coming temporao,
although normal humidity levels have not been restored,
Comissaria Smith said in its weekly review.
    The dry period means the temporao will be late this year.
    Arrivals for the week ended February 22 were 155,221 bags
of 60 kilos making a cumulative total for the season of 5.93
mln against 5.81 at the same stage last year. Again it seems
that cocoa delivered earlier on consignment was included in the
arrivals figures.
    Comissaria Smith said there is still some doubt as to how
much old crop cocoa is still available as harvesting has
practically come to an end. With total Bahia crop estimates
around 6.4 mln bags and sales standing at almost 6.2 mln there
are a few hundred thousand bags still in the hands of farmers,
middlemen, exporters and processors.
    There are doubts as to how much of this cocoa would be fit
for export as shippers are now experiencing dificulties in
obtaining +Bahia superior+ certificates.
    In view of the lower quality over recent weeks farmers have
sold a good part of their cocoa held on consignment.
    Comissaria Smith said spot bean prices rose to 340 to 350
cruzados per arroba of 15 kilos.
    Bean shippers were reluctant to offer nearby shipment and
only limited sales were booked for March shipment at 1,750 to
1,780 dlrs per tonne to ports to be named.
    New crop sales were also light and all to open ports with
June/July going at 1,850 and 1,880 dlrs and at 35 and 45 dlrs
under New York july, Aug/Sept at 1,870, 1,875 and 1,880 dlrs
per tonne FOB.
    Routine sales of butter were made. March/April sold at
4,340, 4,345 and 4,350 dlrs.
    April/May butter went at 2.27 times New York May, June/July
at 4,400 and 4,415 dlrs, Aug/Sept at 4,351 to 4,450 dlrs and at
2.27 and 2.28 times New York Sept and Oct/Dec at 4,480 dlrs and
2.27 times New York Dec, Comissaria Smith said.
    Destinations were the U.S., Covertible currency areas,
Uruguay and open ports.
    Cake sales were registered at 785 to 995 dlrs for
March/April, 785 dlrs for May, 753 dlrs for Aug and 0.39 times
New York Dec for Oct/Dec.
    Buyers were the U.S., Argentina, Uruguay and convertible
currency areas.
    Liquor sales were limited with March/April selling at 2,325
and 2,380 dlrs, June/July at 2,375 dlrs and at 1.25 times New
York July, Aug/Sept at 2,400 dlrs and at 1.25 times New York
Sept and Oct/Dec at 1.25 times New York Dec, Comissaria Smith
said.
    Total Bahia sales are currently estimated at 6.13 mln bags
against the 1986/87 crop and 1.06 mln bags against the 1987/88
crop.
    Final figures for the period to February 28 are expected to
be published by the Brazilian Cocoa Trade Commission after
carnival which ends midday on February 27.
 Reuter
</BODY></TEXT>
</REUTERS> 
```

* * *

## John Machin 的错误 XML 查找器 (fix_xml.py)

正如 John Machin[在此答案](https://stackoverflow.com/questions/7693515/why-is-elementtree-raising-a-parseerror#answer-7693834)中提到的，某些字符不是有效的 XML；这是他为帮助查找无效 XML 字符而编写的脚本。

```
# coding: ascii
# Find numeric character references that refer to Unicode code points
# that are not valid in XML.
# Get byte offsets for seeking etc in undecoded file bytestreams.
# Get unicode offsets for checking against ElementTree error message,
# **IF** your input file is small enough. 

BYTE_OFFSETS = True
import sys, re, codecs
fname = sys.argv[1]
print fname
if BYTE_OFFSETS:
    text = open(fname, "rb").read()
else:
    # Assumes file is encoded in UTF-8.
    text = codecs.open(fname, "rb", "utf8").read()
rx = re.compile("&#([0-9]+);|&#x([0-9a-fA-F]+);")
endpos = len(text)
pos = 0
while pos < endpos:
    m = rx.search(text, pos)
    if not m: break
    mstart, mend = m.span()
    target = m.group(1)
    if target:
        num = int(target)
    else:
        num = int(m.group(2), 16)
    # #x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF]
    if not(num in (0x9, 0xA, 0xD) or 0x20 <= num <= 0xD7FF
    or 0xE000 <= num <= 0xFFFD or 0x10000 <= num <= 0x10FFFF):
        print mstart, m.group()
    pos = mend 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-09T01:22:09.417

如果您不关心（可能是混乱的）XML 文档的特定结构，而只想快速获取给定标记/元素的内容，您可能想尝试[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/bs4/doc/)模块。

```
import BeautifulSoup
from BeautifulSoup import BeautifulSoup

soup = BeautifulSoup(totstring)

body = soup.find("body")

bodytext = body.text 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T17:37:45.147

我不知道这是否仍然对您有所帮助，但我遇到了类似的问题，需要将我的 xml 数据放入元素树，而不是 BeautifulSoup 或 lxml 的汤解析器。我也不想通过我的 xml 文件进行两次传递。因此，我发现了如何为 ElementTree（不是 cElementTree，虽然）构建自定义 XMLParser。使用 Mike 的一些代码，我创建了一个 XMLParser 类，它可以在通过解析器之前拦截字符数据并过滤掉无效字符。

干得好：

```
import xml.etree.ElementTree as ET
import sys
import re

class MyXMLParser(ET.XMLParser):

    rx = re.compile("&#([0-9]+);|&#x([0-9a-fA-F]+);")

    def feed(self,data):
        m = self.rx.search(data)
        if m is not None:
            target = m.group(1)
            if target:
                num = int(target)
            else:
                num = int(m.group(2), 16)
            if not(num in (0x9, 0xA, 0xD) or 0x20 <= num <= 0xD7FF
                   or 0xE000 <= num <= 0xFFFD or 0x10000 <= num <= 0x10FFFF):
                # is invalid xml character, cut it out of the stream
                print 'removing %s' % m.group()
                mstart, mend = m.span()
                mydata = data[:mstart] + data[mend:]
        else:
            mydata = data
        super(MyXMLParser,self).feed(mydata)

parser = MyXMLParser(encoding='utf-8')
xml_filename = sys.argv[1]
xml_etree = ET.parse(xml_filename, parser=parser) 
```

# java - 使用 MVC 创建一个 ActionListener 来搜索 NotepadGUI 的 TextArea

> ID：10508490
> 
> 赞同：0
> 
> 时间：2012-05-09T00:51:37.850
> 
> 标签：java, model-view-controller, user-interface, highlight, actionlistener

这是我的记事本应用程序的视图。我需要创建一个控制器来搜索 centerPanel 中的 textarea。我定义了一个 JButton 以及一个文本字段，并希望用户能够在该字段中输入文本并按下按钮以突出显示搜索到的文本。我在一个新类中定义了所有 ActionListener。

```
public NotepadView() {
        super();
        //WINDOW
        setSize (750,500);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setTitle("Chad's Notepad");
        setLocationRelativeTo(null);
        setBackground(Color.BLACK);

        //CENTER PANEL
        centerPanel = new JPanel();
        centerPanel.setLayout(new FlowLayout());
        textArea = new JTextArea();
        centerPanel.add(textArea);
        add(centerPanel, BorderLayout.CENTER);
        scrollPaneText = new JScrollPane(textArea);
        add(scrollPaneText);
        textArea.setLineWrap(true);
        textArea.setFont(new Font("Garamond", Font.PLAIN, 18));

        //BOTTOM PANEL
        bottomPanel = new JPanel();
        bottomPanel.setLayout(new GridLayout(1,2));
        setButton = new JButton("Find");
        textField = new JTextField("EnterText");
        bottomPanel.add(setButton);
        bottomPanel.add(textField);
        add(bottomPanel, BorderLayout.SOUTH);

        //MENU BAR
        menuBar = new JMenuBar();
        fileMenu = new JMenu("File");   
        newItem = new JMenuItem("New");
        openItem = new JMenuItem("Open");
        saveItem = new JMenuItem("Save");
        closeItem = new JMenuItem("Close");
        menuBar.add(fileMenu);
        fileMenu.add(newItem);
        fileMenu.add(openItem); 
        fileMenu.add(saveItem); 
        fileMenu.add(closeItem);
        setJMenuBar(menuBar);

        newItem.addActionListener(new NewMenuCommand(textArea));
        openItem.addActionListener(new OpenMenuCommand(textArea));
        closeItem.addActionListener(new QuitMenuCommand());
        saveItem.addActionListener(new SaveMenuCommand(textArea));
    }
} 
```

//按钮的ActionListener新类

```
 public class ButtonCommand implements ActionListener {
    private JTextArea textArea;
    private String hText;
    int ind = 0;
    private String findString;

    public ButtonCommand (JTextArea ta){
        textArea = ta;
    }

    public void actionPerformed (ActionEvent e){
         hText = textArea.getText();
         findString=JOptionPane.showInputDialog(null,"Find   what","Find",JOptionPane.INFORMATION_MESSAGE);
         ind = hText.indexOf(findString,0);
         textArea.setCaretPosition(ind);
         textArea.setSelectionStart(ind);
         int a = ind+findString.length();
         textArea.setSelectionEnd(a);
    }
} 
```

# java - Automate console inputs from external input file?

> ID：10508496
> 
> 赞同：1
> 
> 时间：2012-05-09T00:52:13.403
> 
> 标签：java, eclipse

Does eclipse have the ability to load external file that contains thousands of lines of console commands and execute them?

I am debugging a program which requires a lot of commands for setup, it will be a great time saver if I don't have to type those commands every single time. (without modifying existing java code)

Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T01:02:10.297

You can debug console applications in Eclipse by leveraging the remote debugger. Then the console commands will be executed through a batch file. I suspect that is preferred, anyway, with thousands of lines of console commands. Error messages can then be captured from the output generated while running the batch.

Here is more detail, [answered in a previous question](https://stackoverflow.com/questions/104254/java-io-console-support-in-eclipse-ide).

# android - 这是库存的 Android 通知（RemoteView）布局吗？

> ID：10508498
> 
> 赞同：5
> 
> 时间：2012-05-09T00:52:14.463
> 
> 标签：android, android-layout

在我的 HTC 手机上，通知的 RemoteView 如下图所示...

![在此处输入图像描述](../Images/09cf9f087458f748cf12a9bdefccfa64.png)

我想在我的应用程序中为通知使用相同的布局（图像、粗体文本和小文本），但我无法确定它是否是一个普通的 Android 布局。我已经创建了自己的布局，但并不完全相同，如果可能的话，我想坚持“标准”。

使用 eclipse 我尝试输入`android.R.layout.`以查看建议是什么，但我看不到任何建议通知布局的名称。

它是股票的 Android 布局吗？如果是这样，我该如何访问它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T10:21:32.027

它是标准的 Android 通知布局，您无需创建自己的自定义布局。只需使用现有的通知 API 来设置可绘制对象、标题和文本。下面是一个示例，使用`NotificationCompat.Builder`来自兼容性库：

```
Intent notificationIntent = new Intent(this, ActivityHome.class);
PendingIntent pendingIntent = PendingIntent.getActivity(this, 0, notificationIntent, PendingIntent.FLAG_CANCEL_CURRENT);

NotificationCompat.Builder builder = new NotificationCompat.Builder(this);
builder.setContentIntent(pendingIntent)
        .setWhen(System.currentTimeMillis())
        .setTicker(getText(R.string.notification_ticker))
        .setSmallIcon(R.drawable.notification_icon)
        .setContentTitle(getText(R.string.notification_title))
        .setContentText(getText(R.string.notification_text));

mNotificationManager.notify(NOTIFICATION_ID, builder.getNotification()); 
```

和相同的使用`Notification`类：

```
Notification notification = new Notification(R.drawable.notification_icon, getText(R.string.notification_ticker), System.currentTimeMillis());

Intent notificationIntent = new Intent(this, ActivityHome.class);
PendingIntent pendingIntent = PendingIntent.getActivity(this, 0, notificationIntent, PendingIntent.FLAG_CANCEL_CURRENT);

notification.setLatestEventInfo(this, getString(R.string.notification_title), getText(R.string.notification_text), pendingIntent);

mNotificationManager.notify(NOTIFICATION_ID, builder.getNotification()); 
```

# stored-procedures - 经典 ASP - 丢失记录集？

> ID：10508501
> 
> 赞同：0
> 
> 时间：2012-05-09T00:53:00.997
> 
> 标签：stored-procedures, asp-classic, adodb, recordset

早上好，

请多多包涵; 我继承了一个经典的 ASP 环境，这当然是出乎意料的，而且丝毫不是我的强项。提前感谢您的考虑。

设置是这样的；接受参数以根据传递的参数返回用户活动数据的存储过程。当我从 SQL Management Studio 运行它时，存储过程会在我期望的每个参数情况下返回我的预期结果。SQL Server 环境是 SQL Server 2008 Service Pack 3 10.00.5500.00

位于管理面板中的经典 ASP 页面有一个包含位置列表的下拉菜单。如果您选择一个位置，页面会重新加载到该位置“实例”；包含相应 location_id 的全局 SITE_ID 变量填充了正确的 loaction_id。我通过输出 SITE_ID 进行测试以确保。

问题是在页面加载时它有时会将结果返回到页面，但有时不会。当它执行时，数据完全符合预期。当没有返回记录集时，我注意到如果我在几分钟后刷新页面，页面通常会正确显示记录集。如果我切换到另一个位置实例，它最初总是什么都不返回，但同样，几分钟后它通常会在刷新时返回。

我不能把手指放在它上面，并怀疑我不太熟悉的代码（但通常可以理解发生了什么）可能会很快关闭连接或什么？

有趣的是；我将此代码片段添加到页面上的输出中，当记录集返回此片段时不会触发。当记录集没有返回时，所有五个 Response.Write 消息都会出现在页面上。

任何想法或建议都非常受欢迎。我很感激你的时间。

**adState 片段**

```
<%
    If rs.State = adStateClosed Then
        Response.Write "Recordset is closed<br />"
    End If

    If rs.State = adStateConnecting Then
        Response.Write "Recordset is connecting<br />"
    End If

    If rs.State = adStateExecuting Then
        Response.Write "Recordset is executing<br />"
    End If

    If rs.State = adStateFetching Then
        Response.Write "Recordset is fetching records<br />"
    End If

    If rs.State = adStateOpen Then
        Response.Write "Recordset is open<br />"
    End If
%> 
```

下面是存储过程：

**存储过程**

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [report].[user_recent_activity] (
    @locationID INT,                        -- Location filter, NULL for all if @mode = 'all'
    @mode NVARCHAR(6) = NULL,               -- Mode filter, NULL for location specific
    @userID INT = NULL,                     -- User filter, if passed
    @startDate DATETIME = NULL,
    @endDate DATETIME = NULL
)
AS
SET NOCOUNT ON
SET ANSI_WARNINGS OFF
BEGIN
IF @mode = 'all'
BEGIN   
    SELECT 
        u.[user_id],
        u.[display_name], 
        CONVERT(VARCHAR,u.[last_login],103) + ' ' + CONVERT(VARCHAR,CONVERT(TIME,u.[last_login]),0) [last_login],
        CONVERT(VARCHAR,u.[last_activity],103) + ' ' + CONVERT(VARCHAR,CONVERT(TIME,u.[last_activity]),0) [last_activity],
        l.[location_name],
        (
            SELECT TOP 1 
                [event_text]
            FROM 
                [dbo].[siteflex_events] (NOLOCK) 
            WHERE 
                [location_id] = u.[location_id] AND 
                [user_id] = u.[user_id] AND 
                [event_date] = u.[last_activity]
        ) [activity]
    FROM 
        [dbo].[v_users] u (NOLOCK)
        JOIN [dbo].[locations] l (NOLOCK) ON u.[location_id] = l.[location_id]
    WHERE 
        u.[user_status] = 1 AND 
        u.[last_login] > DATEADD(d,-1,GETDATE())
    ORDER BY
        u.[last_activity] DESC
END
ELSE IF @mode = 'user'
BEGIN
    SELECT 
        MAX([last_login]) [last_login]
    FROM 
        [dbo].[v_users] (NOLOCK)
    WHERE 
        [location_id] = @locationID AND
        [user_id] = @userID 
    SELECT 
        u.[user_id],
        u.[display_name], 
        CONVERT(VARCHAR,u.[last_login],103) + ' ' + CONVERT(VARCHAR,CONVERT(TIME,u.[last_login]),0) [last_login],
        CONVERT(VARCHAR,u.[last_activity],103) + ' ' + CONVERT(VARCHAR,CONVERT(TIME,u.[last_activity]),0) [last_activity],
        l.[location_name],
        e.[event_text] [activity]
    FROM 
        [dbo].[v_users] u (NOLOCK)
        JOIN [dbo].[locations] l (NOLOCK) ON u.[location_id] = l.[location_id]
        JOIN [dbo].[siteflex_events] e (NOLOCK) ON e.[user_id] = u.[user_id] AND e.[location_id] = @locationID
    WHERE 
        u.[user_status] = 1 AND
        u.[location_id] = @locationID AND
        u.[user_id] = @userID
    ORDER BY
        u.[last_activity] DESC      
END 
ELSE IF @mode = 'active'
BEGIN
    SELECT 
        u.[user_id],
        u.[display_name], 
        COUNT(e.[event_id]) [activity_count],
        u.[login_count],
        MAX(CONVERT(VARCHAR,u.[last_activity],103) + ' ' + CONVERT(VARCHAR,CONVERT(TIME,u.[last_activity]),0)) [last_activity],
        l.[location_name]
    FROM 
        [dbo].[v_users] u (NOLOCK)
        JOIN [dbo].[siteflex_events] e (NOLOCK) ON e.[user_id] = u.[user_id] 
        JOIN [dbo].[locations] l (NOLOCK) ON e.[location_id] = l.[location_id]
    WHERE 
        u.[user_status] = 1 AND
        e.[user_id] <> 63 AND
        e.[location_id] = ISNULL(@locationID,e.[location_id]) 
    GROUP BY
        u.[user_id],
        u.[display_name], 
        u.[login_count],
        l.[location_name]       
    ORDER BY
        COUNT(e.[event_id]) DESC                
END 
ELSE IF @mode = 'aging'
BEGIN
    DECLARE @aged TABLE (
        [location_id] INT,
        [location_name] VARCHAR(512),
        [activity_count] INT,
        [last_activity] DATETIME,
        [last_user] INT,
        [activity] VARCHAR(150)
    )
    INSERT INTO @aged
    SELECT  
            l.[location_id],
            l.[location_name],
            COUNT(e.[event_id]) [activity_count],
            (
                SELECT TOP 1
                    [event_date]
                FROM 
                    [dbo].[siteflex_events] (NOLOCK) 
                WHERE 
                    [location_id] = l.[location_id] AND
                    [user_id] <> 63
                ORDER BY
                    [event_date] DESC
            ) [activity],
            (
                SELECT TOP 1
                    [user_id]
                FROM 
                    [dbo].[siteflex_events] (NOLOCK) 
                WHERE 
                    [location_id] = l.[location_id] AND
                    [user_id] <> 63
                ORDER BY
                    [event_date] DESC
            ) [last_user],  
            (
                SELECT TOP 1
                    [event_text]
                FROM 
                    [dbo].[siteflex_events] (NOLOCK) 
                WHERE 
                    [location_id] = l.[location_id] AND
                    [user_id] <> 63
                ORDER BY
                    [event_date] DESC
            ) [activity]                    
        FROM 
            [dbo].[locations] l (NOLOCK)
            JOIN [dbo].[siteflex_events] e (NOLOCK) ON e.[location_id] = l.[location_id]
            JOIN [dbo].[v_users] u (NOLOCK) ON e.[user_id] = u.[user_id]
        WHERE 
            --u.[user_status] = 1 AND
            l.[location_type] <> -1 AND
            e.[user_id] <> 63 AND
            e.[location_id] = ISNULL(@locationID,e.[location_id]) 
        GROUP BY
            l.[location_id],
            l.[location_name]       
    SELECT
        a.[location_id],
        a.[location_name],
        a.[activity_count],
        a.[last_activity],
        a.[last_user],
        u.[display_name],
        a.[activity],
        CONVERT(VARCHAR,DATEDIFF(day, a.[last_activity], GETDATE())) + ' days' [aged]
    FROM    
        @aged a
        JOIN [dbo].[v_users] u (NOLOCK) ON a.[last_user] = u.[user_id]
    ORDER BY
        a.[last_activity]
END
ELSE
BEGIN
    SELECT 
        u.[user_id],
        u.[display_name], 
        CONVERT(VARCHAR,u.[last_login],103) + ' ' + CONVERT(VARCHAR,CONVERT(TIME,u.[last_login]),0) [last_login],
        CONVERT(VARCHAR,u.[last_activity],103) + ' ' + CONVERT(VARCHAR,CONVERT(TIME,u.[last_activity]),0) [last_activity],
        l.[location_name],
        (
            SELECT TOP 1 
                [event_text]
            FROM 
                [dbo].[siteflex_events] (NOLOCK) 
            WHERE 
                [location_id] = @locationID AND 
                [user_id] = u.[user_id] AND 
                [event_date] = u.[last_activity]
        ) [activity]
    FROM 
        [dbo].[v_users] u (NOLOCK)
        JOIN [dbo].[locations] l (NOLOCK) ON u.[location_id] = l.[location_id]
    WHERE 
        u.[user_status] = 1 AND
        u.[location_id] = @locationID
    ORDER BY
        u.[last_activity] DESC      
END 
END 
```

下面是 ASP 代码。我为这篇文章的长度道歉。

**ASP 页面**

```
<!--#include virtual="/admin/inc/setup.asp" -->
<!--#include virtual="/admin/users/common.asp" -->
<%

PAGE_FORM = false
PAGE_STYLE_FILE = "style/user.css"

ADMIN_TABLE = ""

Dim h, g, rs

h = ""

' --- USER PERMISSIONS ---

if not isset(PAGE_ID) then
    if not session("solutions_user") then
        GotoUrl("/admin/users/activity.asp")
    end if
end if

' --- DATE SEARCH ---

min_date = session("min_date")
max_date = session("max_date")

' DATE RANGE SELECTOR SUBMIT
if isset(request.form("btnSubmit")) then
    set f = request.form
    min_date = f("tbMinDate")
    max_date = f("tbMaxDate")
    if (min_date<>"" and max_date<>"") then
            session("min_date")=min_date
            session("max_date")=max_date
        else
            session("min_date")=""
            session("max_date")=""
    end if
end if

' --- MAIN HTML AREA ---

if not isset(PAGE_ID) OR cstr(PAGE_ID)=cstr(ADMIN_ID) OR session("solutions_user") OR (session("user_publishes") = 2 OR session("user_publishes") = 3) then

    ' --- CHECK PERMISSIONS ---

    if session("user_publishes") <> 2 AND session("user_publishes") <> 3 then
        GotoUrl("/admin/users/user.asp")
    end if
    if session("solutions_user") then
        restrictedView = false
    end if

    ' --- CALL STORED PROCEDURES ---

    if pageMode="all" then
        sql = "EXEC report.user_recent_activity " & SITE_ID & ", 'all'"
    elseif pageMode="active" and Request.QueryString("t")="" then
        sql = "EXEC report.user_recent_activity " & SITE_ID & ", 'active'"
    elseif pageMode="active" and Request.QueryString("t") = 1 then
        sql = "EXEC report.user_recent_activity NULL, 'active'"
    elseif pageMode="aging" then
        sql = "EXEC report.user_recent_activity NULL, 'aging'"
    elseif IsSet(PAGE_ID) then
        sql = "EXEC report.user_recent_activity " & SITE_ID & ", 'user', " & PAGE_ID
    else
        sql = "EXEC report.user_recent_activity " & SITE_ID & ", NULL"
    end if

    ' --- MAKE DB CONNECTION ---

    set rs = Server.CreateObject("ADODB.Recordset")
    rs.CursorLocation=3
    rs.CursorType=2
    rs.LockType=1
    rs.open sql, DB_CONN_STRING

    ' --- SHOW LAST LOGIN FOR USER SPECIFIC PAGES ---

    if isset(PAGE_ID) then
        if not rs.eof then
        do while not rs.eof
            g = "Last Logged In: " & rs("last_login")
        rs.movenext
        loop
        end if
        set rs = rs.nextrecordset
    end if

    ' --- NOW SHOW THE RESULTS HEADER ---

    h = ""

    h = h & "<table id='results-table' class='results-table' cellspacing='0' style='padding-top: 20px;'>"

    if pageMode="active" then
        h = h & "<tr class='heading'><td>Most Active</td>"
    elseif pageMode="aging" then
        h = h & "<tr class='heading'><td>Location</td>"
    else
        h = h & "<tr class='heading'><td>Recently Logged In</td>"
    end if

    if pageMode="all" then
        h = h & "<td> Location</td>"
    elseif pageMode="active" then
        h = h & "<td>Location</td>"
        h = h & "<td>Login Count</td>"
        h = h & "<td>Activity Count</td>"
    end if

    if pageMode<>"active" and pageMode<>"aging" then
        h = h & "<td>Last Login</td>"
    end if

    if pageMode="aging" then
        h = h & "<td>Activity Count</td>"
    end if

    h = h & "<td>Last Activity</td>"

    if pageMode<>"all" and pageMode<>"active" and pageMode<>"aging" then
        h = h & "<td style='width: 33%;'>Activity</td>"
    end if

    if pageMode="aging" then
        h = h & "<td>Aged</td>"
    end if

    h = h & "</tr>"

    ' --- NOW LOOP THROUGH THE RESULTS ---

    If not rs.EOF then
    Do While Not rs.EOF

        h = h & "<tr>"
        h = h & "<td>"

        if pageMode="aging" then
            h = h & rs("location_name")
        else
            h = h & rs("display_name")
        end if

        h = h & "</td>"

        if pageMode="all" or pageMode="active" then
            h = h & "<td>" & rs("location_name") & "</td>"
        end if

        if pageMode="active" then
            h = h & "<td>" & rs("login_count") & "</td>"
            h = h & "<td>" & rs("activity_count") & "</td>"
        end if

        if pageMode="aging" then
            h = h & "<td>" & rs("activity_count") & "</td>"
        end if

        if pageMode<>"active" and pageMode<>"aging" then
            h = h & "<td>" & rs("last_login") & "</td>"
        end if

        h = h & "<td>" & rs("last_activity") & "</td>"

        if pageMode<>"all" and pageMode<>"active" and pageMode<>"aging" then
            h = h & "<td>" & rs("activity") & "</td>"
        end if

        if pageMode="aging" then
            h = h & "<td>" & rs("aged") & "</td>"
        end if

        h = h & "</tr>"
    rs.MoveNext
    Loop
    End If

    h = h & "</table>"

end if

    ' ADMIN NAV

    dim navHtml
    listCount = 0
    getUserNav()
    ADMIN_NAV = LeftCol("navTree","Users",navHtml,listCount,colBtn)

    ' SETUP THE ANCHOR JUMPS
    dim anchor_jump,anchors

    if session("solutions_user") then
        arrayPush anchors, Array(0,"Activity - All","activity-msd.asp?m=all")
        arrayPush anchors, Array(1,"Aging - All","activity-msd.asp?m=aging")
        arrayPush anchors, Array(3,"Most Active - All","activity-msd.asp?m=active&t=1")
        arrayPush anchors, Array(4,"Most Active","activity-msd.asp?m=active")
    end if
        arrayPush anchors, Array(2,"Activity","activity-msd.asp")

anchor_jump = makeAnchorJump(anchors,"pageFilter","maintainMode,no-detail")

formTable ADMIN_TABLE, h

%>
<!--#include virtual="/admin/inc/header.asp" -->
<div id="mainContainer" class="orange">
    <div id="mainArea" class="box">
        <h2>
            <%  ' PAGE TITLE

                if pageMode="all" then
                    Response.Write "Recent Activity - All"
                elseif pageMode="active" and Request.QueryString("t") = "" then
                    Response.Write "Most Active - " & SITE_NAME
                elseif pageMode="active" and Request.QueryString("t") = 1 then
                    Response.Write "Most Active - All"
                elseif pageMode="aging" then
                    Response.Write "Aging Activity - All"
                elseif isset(PAGE_ID) then
                    Response.Write "User Activity"
                else
                    Response.Write "Activity - " & SITE_NAME
                end if
            %>
        </h2>
        <%= anchor_jump %>
        <div style='padding-left: 5px;'><%= formTableValueRow(g) %></div>
        <div style='padding-left: 5px;'>
            <%  ' FILTER INFORMATION

                if pageMode="all" then
                    Response.Write "Most recent activity by user in all instances over the past 24 hours."
                elseif pageMode="active" and Request.QueryString("t") = "" then
                    Response.Write "Most active users in the " & SITE_NAME & " instance. Shows login and activity counts."
                elseif pageMode="active" and Request.QueryString("t") = 1 then
                    Response.Write "Most active users in all instances. Shows login and activity counts."
                elseif pageMode="aging" then
                    Response.Write "Aging report showing the instances that haven't been updated in some time."
                elseif isset(PAGE_ID) then
                    Response.Write ""
                else
                    Response.Write "Most recent activity by user in the " & SITE_NAME & " instance."
                end if
            %>
        </div>
        <table cellpadding="0" cellspacing="0" class="formTable">
            <tr>
                <td>Date range to view activity:</td>
                <td class="value"><span class="txt floatLeft" style="margin:0 5px 0 20px;"> From </span> <%=MakeDateSelect("tbMinDate","tbWp3",min_date) %><span class="txt floatLeft" style="margin:0 5px 0 20px;"> To </span><%=MakeDateSelect("tbMaxDate","tbWp3",max_date) %>
                </td>
                <td>
                <div class="formButtons">
                    <ul>
                        <%= MakeButton("submit","btnSubmit","Update Date","") %>
                    </ul>
                </div>
                </td>
            </tr>
        </table>
        <table cellpadding="0" cellspacing="0" class="formTable" style='margin-top: -20px;'>
            <tr>
                <td colspan=3>
                    Debug: This locationID is <%=SITE_ID%>, AdminID <%=ADMIN_ID%><br />
                    <%
                        If rs.State = adStateClosed Then
                            Response.Write "Recordset is closed<br />"
                        End If

                        If rs.State = adStateConnecting Then
                            Response.Write "Recordset is connecting<br />"
                        End If

                        If rs.State = adStateExecuting Then
                            Response.Write "Recordset is executing<br />"
                        End If

                        If rs.State = adStateFetching Then
                            Response.Write "Recordset is fetching records<br />"
                        End If

                        If rs.State = adStateOpen Then
                            Response.Write "Recordset is open<br />"
                        End If
                    %>

                    <%=h%>
                </td>
            </tr>
        </table>
    </div>
    <% = LeftCol("navTree","Users",navHtml,listCount,colBtn) %>
    <div id="blankfooter"></div>
</div>
<!--#include virtual="/admin/inc/footer.asp" -->
<%
On Error Resume Next
If IsObject(rs) then
 rs.close
 Set rs = nothing
End if
If IsObject(DB) then
 DB.close
 Set DB = nothing
End if
%> 
```

# javascript - javascript setUTCMilliseconds 错了吗？否则我错了

> ID：10508510
> 
> 赞同：1
> 
> 时间：2012-05-09T00:53:54.553
> 
> 标签：javascript, date, utc, milliseconds

我是否错误地实现了 setUTCMilliseconds？我输入的任何值的日期都不正确。这只是错误值的一个示例。我所有的测试数据在 JS 中解析到 5 月 24 日（从现在开始的未来），但在 C# 或使用快速在线转换工具中，我的 UTS MS 是正确的。

有什么想法吗？

```
function parseDate(epoch) {   
    var d = new Date();

    //tried this too, but it shows me the actual epoch 1970 date instead
    //var d = new Date(0);

    //EDIT: this should be seconds in combination with Date(0)
    d.setUTCMilliseconds(parseInt(epoch)); 

    return d.toString();
}

 // 1336423503 -> Should be Mon May 07 2012 13:45:03 GMT-7

 // javascript says
 Thu May 24 2012 05:03:21 GMT-0700 (Pacific Daylight Time) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T00:58:27.050

从一个类似的问题：

```
var utcMilliseconds = 1234567890000;
var d = new Date(0); // The 0 there is the key, which sets the date to the epoch
d.setUTCMilliseconds(utcMilliseconds); 
```

请参阅[使用 javascript 将 UTC 纪元转换为本地日期](https://stackoverflow.com/questions/4631928/convert-utc-epoch-to-local-date-with-javascript)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T01:19:24.310

要将 UTC 时间（以秒为单位）转换为本地日期对象：

```
function makeUTC(secs) {
  return new Date(Date.UTC(1970,0,1,0,0, secs, 0));
} 
```

请注意，时代是 1970-01-01T00:00:00.0Z

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T02:30:59.787

只需使用[`Date()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date)毫秒作为数字的构造函数：

```
> new Date(1336423503 * 1000)
2012-05-07T20:45:03.000 
```

之后无需创建 Date 对象和 setUTCMilliseconds。

# msbuild - 单击一次延迟标志

> ID：10508511
> 
> 赞同：0
> 
> 时间：2012-05-09T00:54:08.893
> 
> 标签：msbuild, clickonce, pfx, delay-sign

我有一个 ClickOnce 应用程序，它依赖于延迟签名（使用 .pfx）程序集。我目前依靠我的项目的发布目标来创建我的 ClickOnce 部署，并希望尽可能保持这种方式（避免使用法师）。

我的问题是打包的程序集仍然延迟签名，因为发布运行时我没有机会运行“sn -Rc ...”。有没有办法在构建/重建后连接到 Publish 目标以签署我的程序集。如果发布没有触发构建，我也可以在发布之前对程序集进行签名。

有什么建议么？

我不确定如何寻求一些线索： - 在 .deploy 文件中签名程序集 - 重新使用发布目标生成的 .manifest 和 .application 文件来创建带有签名程序集的新部署

总而言之：如何重新使用（有或没有法师）发布目标生成的 .manifest/.application 来创建新部署？相同的文件，有些略有不同。

谢谢，伯努瓦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T18:17:21.797

只是好奇，你使用法师有什么问题？这就是它的设计目的，并且很容易重新签署您的部署。[这是一篇文章，展示了如何做到这一点。](https://web.archive.org/web/20120313122449/http://blogs.msdn.com/b/vsto/archive/2009/04/29/signing-and-re-signing-manifests-in-clickonce.aspx)

如果你不想使用 mage，你可以查看 Patterns and Practices 提供的 MMU 应用程序，[在这里](http://compositewpf.codeplex.com/releases/view/14771)：你可以看一下代码；它以编程方式创建部署包。

Publish*总是*进行构建，您无法阻止它（许多人已经尝试过！）。

如果您想在创建发布包后将文件添加到部署中，请查看[本页](http://msdn.microsoft.com/en-us/library/ff699292.aspx)底部的“选项 2” 。IIRC，“自动”是指使用 MMU；手动意味着使用 Mage 或 MageUI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-10T07:19:03.543

> 我的问题是打包的程序集仍然延迟签名，因为发布运行时我没有机会运行“sn -Rc ...”。有没有办法在构建/重建后连接到 Publish 目标以签署我的程序集。

我在这方面已经很晚了，但我最近也遇到了这个问题，并设法将一个任务插入到 MSBuild 中，该任务在构建任务之后直接对程序集（而不是清单）进行完全签名。所以辞职是在发布之前完成的。

我将在下面引用 .targets 文件的相关行：

```
 <PropertyGroup Label="ProjectInfo">
    <AssemblyExtension Condition="'$(OutputType)' == 'Library'">.dll</AssemblyExtension>
    <AssemblyExtension Condition="'$(OutputType)' == 'WinExe'">.exe</AssemblyExtension>
    <AssemblyExtension Condition="'$(OutputType)' == 'Exe'">.exe</AssemblyExtension>
  </PropertyGroup>

  <PropertyGroup Label="Signing">
    <!-- the build server keeps the private key a secret; the path to the key file also containing 
         the private key is injected via build server environment -->
    <StrongNameKeyFile>$(STRONG_NAME_KEY)</StrongNameKeyFile>
    <IsBuildServer>$(BUILDSRV)</IsBuildServer>
  </PropertyGroup>

  <Target Name="Hook_AfterBuild" AfterTargets="AfterBuild">
  </Target>

  <!-- Fully sign the delay signed assembly on the build server -->
  <Target Name="FullySignAssembly" AfterTargets="Hook_AfterBuild"
          Condition=" '$(IsBuildServer)' == 'true' And '$(DelaySign)' == 'true' And '$(SignAssembly)' == 'true' ">
    <Exec Command="sn.exe -Ra $(OutputPath)$(AssemblyName)$(AssemblyExtension) $(StrongNameKeyFile)"/>
  </Target> 
```

# jquery - jquery-ui 选项卡不起作用 - 包含 js 和 css，但页面很简单

> ID：10508513
> 
> 赞同：0
> 
> 时间：2012-05-09T00:54:21.420
> 
> 标签：jquery, jquery-ui

我之前使用过 jquery-ui，甚至之前使用过 jquery-ui 的 Tabs 方面......但由于某种原因，它今天无法正常工作。我到底做错了什么？

```
<!doctype html>
<html>
    <head>
        <link rel="stylesheet" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/themes/ui-lightness/jquery-ui.css" />

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>

        <script type="text/javascript">
            $(document).ready(function() {
                $('#tabs').tabs();
            });
        </script>
    </head>
    <body>

        <div id="tabs">
            <ul>
                <li><a href='#tabs-1'>Email</a></li>
                <li><a href='#tabs-2'>Email 2</a></li>
            </ul>

            <div id='tabs-1'>
                <p>test</p>
            </div>
            <div id='tabs-2'>
                <p>test2</p>
            </div>
        </div>

    </body>
</html> 
```

该页面非常简单：

![在此处输入图像描述](../Images/c4e23ad710df07c6d2ceb1b1f5cfa081.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T01:11:11.547

href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/themes/ui-lightness/jquery-ui.css"

# windows - GVIM - 保存窗口配置

> ID：10508514
> 
> 赞同：1
> 
> 时间：2012-05-09T00:54:29.453
> 
> 标签：windows, vim, macvim

最近的一次崩溃提示了这个问题——我打开了两个 gui 窗口。会话或插件有什么方法可以保存窗口配置和位置并在完全退出/重新打开 macvim 时恢复它？我认为这将非常有用，但我无法通过谷歌找到任何关于它的信息。如果我在一个窗口中进行会话，它只会为那个窗口保存。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T05:30:44.627

GVim 还是 MacVim？它与您的问题无关，但您的问题的标题并未反映其主题。

在 GUI Vim 中，GUI 窗口是独立的实例，彼此之间没有太多了解，也没有共享进程。你想要的似乎在 Vim 内部是不可能的。MacVim 作为单个进程运行，但每个 GUI 窗口仍然是一个单独的实例。也许你会有一些第三方选项。

它对你的两个 GUI 窗口没有帮助，但你读过`:h :mksession`吗`:h :mkview`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T08:34:24.020

阅读会话和视图（如 romainl 提到的）：

```
:h :mksession
:h :mkview 
```

这些将做你想要的。就像他提到的那样，尽管您希望为每个 vim 实例保留不同的会话文件。例如：

```
:mksess! instance_1.vim 
```

合而为一，并且

```
:mksess! instance_2.vim 
```

在另一种情况下。

重新加载会话，例如：

```
gvim -S instance_1.vim& 
gvim -S instance_2.vim& 
```

要分配一个键以轻松保存“当前”会话而无需进一步考虑：

```
:nnoremap <F2> :exe "mksession! " . v:this_session<CR> 
```

现在按 F2 将保存活动会话（例如已加载的会话）。

# android - 关闭应用程序后出错

> ID：10508515
> 
> 赞同：1
> 
> 时间：2012-05-09T00:54:31.633
> 
> 标签：android, opengl-es

我有一个带有一些代码的glsurfaceview渲染器，可以让我在按下主页按钮后恢复并再次进入游戏，并且效果很好，但是如果我使用返回按钮关闭游戏，然后我再次尝试进入游戏，它就会崩溃并关闭。我试过在 OnDestroy 上写 finish() 但没有用。我已经检查了 onDestroy() 在我按下返回按钮时执行它。在 onSurfaceCreated 我有加载纹理并设置顶点以绘制这些纹理的函数，但是，我不明白会发生什么

编辑：

这是我第二次启动游戏后的日志，之前关闭过

```
05-08 20:30:41.069: I/GLThread(6272): noticed surfaceView surface lost tid=12
05-08 20:30:41.069: I/GLThread(6272): onResume tid=12
05-08 20:30:41.169: I/GLThread(6272): noticed surfaceView surface acquired tid=12
05-08 20:30:41.169: W/EglHelper(6272): start() tid=12
05-08 20:30:41.219: W/EglHelper(6272): createContext com.google.android.gles_jni.EGLContextImpl@4056d398 tid=12
05-08 20:30:41.219: I/GLThread(6272): noticing that we want render notification tid=12
05-08 20:30:41.219: W/GLThread(6272): egl createSurface
05-08 20:30:41.219: W/EglHelper(6272): createSurface()  tid=12
05-08 20:30:41.219: W/GLThread(6272): onSurfaceCreated
05-08 20:30:41.219: W/GLThread(6272): onSurfaceChanged(480, 320)
05-08 20:30:41.379: W/EglHelper(6272): destroySurface()  tid=12
05-08 20:30:41.389: W/EglHelper(6272): finish() tid=12
05-08 20:30:41.389: W/dalvikvm(6272): threadid=9: thread exiting with uncaught exception (group=0x40018578)
05-08 20:30:41.389: E/AndroidRuntime(6272): FATAL EXCEPTION: GLThread 12
05-08 20:30:41.389: E/AndroidRuntime(6272): java.lang.NullPointerException
05-08 20:30:41.389: E/AndroidRuntime(6272):     at glfg.gl.render.setverticesSquare(render.java:180)
05-08 20:30:41.389: E/AndroidRuntime(6272):     at glfg.gl.render.onSurfaceChanged(render.java:475)
05-08 20:30:41.389: E/AndroidRuntime(6272):     at android.opengl.GLSurfaceView$GLThread.guardedRun(GLSurfaceView.java:1381)
05-08 20:30:41.389: E/AndroidRuntime(6272):     at android.opengl.GLSurfaceView$GLThread.run(GLSurfaceView.java:1138)
05-08 20:30:41.399: I/GLThread(6272): onPause tid=12 
```

如果我终止进程，我可以毫无问题地再次进入，但是如果我使用返回按钮退出，当我尝试再次启动它时它会崩溃，它应该是应用程序将完全关闭但似乎不是

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T02:52:22.443

你的错误在这里：

```
05-08 20:30:41.389: E/AndroidRuntime(6272): java.lang.NullPointerException
05-08 20:30:41.389: E/AndroidRuntime(6272):     at glfg.gl.render.setverticesSquare(render.java:180) 
```

在第 180 行的 glfg.gl.render.setverticesSquare 中。这是您的代码的一部分吗？我会查看该行并查看哪些对象可能为空，或者最好使用断点来检查它。

# youtube - YouTube 配额限制 - 最佳做法是什么？

> ID：10508518
> 
> 赞同：2
> 
> 时间：2012-05-09T00:56:05.620
> 
> 标签：youtube, youtube-api, gdata

我正在开发一个严重依赖 YouTube API 来协助内容发现的应用程序。在开发的负载测试阶段，我收到了

```
<domain>yt:quota</domain><code>too_many_recent_calls</code> 
```

错误多次。虽然负载测试的流量比我预期的要高，但我想听听人们如何使用 YouTube API 处理配额问题。理想情况下，我想知道此时我何时接近配额并限制请求（我宁愿提供有限的服务，也不愿在收到此类错误后 10 分钟内从您的应用程序调用 API 以“重置“您的配额。”按照[http://apiblog.youtube.com/2010/02/best-practices-for-avoiding-quota.html的建议](http://apiblog.youtube.com/2010/02/best-practices-for-avoiding-quota.html)

请求只是 GET，没有 POST/PUT/DELETE，并且对即时结果的需求很小（即，如果需要，我可以在用户交互后限制调用，并呈现一个速度较慢但功能齐全的应用程序）

有没有人以这种方式管理 YouTube API 调用的经验？是否有一个很好的解决方案可以在配额下发出请求，而不会击中它并且不得不退后 10 分钟来重置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:53:06.990

对于 v2 ' [https://developers.google.com/youtube/faq?hl=en#quota](https://developers.google.com/youtube/faq?hl=en#quota) '

对于 v3 ' [https://developers.google.com/youtube/v3/getting-started?hl=en#quota](https://developers.google.com/youtube/v3/getting-started?hl=en#quota) '

应该给出一个想法。

使用 v3 并让用户 OAuth2 登录，通常会给你最好的结果。

# entitlements - 当我调用 runModal 时 NSOpenPanel 不显示

> ID：10508522
> 
> 赞同：4
> 
> 时间：2012-05-09T00:56:28.413
> 
> 标签：entitlements, nsopenpanel

你好因为我花了几个小时寻找解决方案但没有找到，并发现了错误我虽然我会出去发布它。

我创建了一个 NSOpenPanel，就像每个人都创建它一样，设置它接受的文件类型，并调用 runModal，程序冻结了大约 15 秒，然后继续运行，就好像模式已被取消一样。问题是我在我的应用程序中使用了权利，并且在应用程序沙箱化时，我需要将用户文件访问权限设置为读写才能使其正常工作。一旦我在我的项目设置中进行了设置，我再次运行该程序并能够使用 NSOpenPanel。祝大家好运。

# ios - 如何在 UIScrollview 中嵌入 UITableView

> ID：10508524
> 
> 赞同：17
> 
> 时间：2012-05-09T00:56:32.633
> 
> 标签：ios, uitableview, uiviewcontroller, uiscrollview, scroll

如何在 UIViewController 中执行以下操作（包含 tableview 作为子视图）

我最初有一个 UIViewController 显示预览部分（UIView）

```
//Setup container for preview section
UIView *tempContainer = [[UIView alloc]initWithFrame:CGRectMake(0, 20, 320, 100)];
self.preview_answer_container = tempContainer;
self.preview_answer_container.backgroundColor = [UIColor clearColor];
[tempContainer release];
[self.view addSubview:self.preview_answer_container]; 
```

我还在下面添加了一个 UITableView （和一个搜索栏）

```
//setup tableview
UITableView *tempTable = [[UITableView alloc]initWithFrame:CGRectMake(0,44 ,320,self.view.frame.size.height - 44)];
self.tagFriendsTableView = tempTable;
self.tagFriendsTableView.delegate = self;
self.tagFriendsTableView.dataSource = self;
[tempTable release];

[self.view addSubview:self.tagFriendsTableView]; 
```

![在此处输入图像描述](../Images/626087d1409347c55f1b599ceadf9638.png)

使用此设置，我的滚动区域很小（预览部分下方只有静态区域）

如何修改我的代码，以便 1）我可以向上滚动整个页面，即预览部分和 tableview 将一起向上滚动 2）当搜索栏到达顶部（导航栏下方）时，整个滚动将停止（见截图），但 UITableView 中的内容仍然可以滚动

![在此处输入图像描述](../Images/ae4c00e8cf4909fd3398cff09a0c31a8.png)

编辑：

为 UIScroll 视图添加了代码。然而，对我来说什么都没有改变。我的代码有什么问题？

```
//setup scroll view
UIScrollView *scroll = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];

//Search
UISearchBar *tempBar = [[UISearchBar alloc]initWithFrame:CGRectMake(0, 120 + 20, 320, 44)];
self.sBar = tempBar;
[tempBar release];
self.sBar.delegate = self;
self.sBar.tintColor = [UIColor colorWithHexString:@"#b6c0c7"];
self.sBar.placeholder = @"Search for FB and DM friends";

[scroll addSubview:sBar];

//setup tableview
UITableView *tempTable = [[UITableView alloc]initWithFrame:CGRectMake(0,144 + 20 + 20 ,320,self.view.frame.size.height - 144 - 20 - 20 - 44)];
self.tagFriendsTableView = tempTable;
self.tagFriendsTableView.delegate = self;
self.tagFriendsTableView.dataSource = self;
[tempTable release];

//Add the scroll view to the parent view
[scroll addSubview:self.tagFriendsTableView];

scroll.contentSize = CGSizeMake(self.view.frame.size.width, self.view.frame.size.height);
[self.view addSubview:scroll];
[scroll release]; 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-09T02:22:03.293

我有一个解决方案给你

只使用 tableView 就足够了

1.  将“预览视图”设为 tableView 的 HeaderView

2.  将“搜索栏”作为 tableView 的部分标题视图

你可以做到完美:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-09T02:33:22.397

不需要任何花哨或自定义，使用 a`UITableView`并将您的预览窗格设置为 ，`tableHeaderView`并将您的搜索字段设置为`tableView:viewForHeaderInSection:`在您的`UITableViewDelegate`.

在滚动事件期间，表格标题将滚动到顶部。如果可见，部分标题会在该部分的整个时间内浮动并保持可见。如果您只有 1 个部分，则部分标题将一直存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-22T20:28:36.780

或者您可以执行以下步骤： 1\. 禁用 tableView 的滚动。2\. 为 tableView 设置高度约束和连接到它的 IBOutlet。3\. 在重新加载数据之前，计算表格高度。`heightConstraint.constant = (heightOfTheSingleTableViewCell) * numOfRows`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-12T09:40:20.993

是的，您可以使用“tableView:viewForHeaderInSection”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-09T01:03:33.433

您必须将 UITableView 嵌入到具有屏幕大小减去导航栏的 UIScrollView 中。将 UIScrollViews 背景设置为 clearColor 以允许 UITableView 上方的内容保持可见。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-10T23:40:50.070

```
scroll.contentSize = CGSizeMake(self.view.frame.size.width, self.view.frame.size.height); 
```

它无法滚动，因为 contentSize 不够大。您需要将滚动视图顶部的内容的长度增加到总长度。

# hibernate - 在 NHibernate 中删除后从第一个缓存中读取已删除的对象

> ID：10508525
> 
> 赞同：-1
> 
> 时间：2012-05-09T00:56:57.663
> 
> 标签：hibernate, nhibernate

**更新**

我想知道一个实例是否已从 NHibernate 的第一个缓存中删除

```
private static void Evict()
        {
            using (var session = sessionFactory.OpenSession())
            using (var transaction = session.BeginTransaction())
            {
                var customers = session.Query<Customer>().ToList();

                var customer = customers[0];
                session.Delete(customer);
                transaction.Commit();

              //how to find out whether or not customers[0] is still in session.
            }

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T06:56:42.390

您可以尝试“破解”会话实现：

```
var sessionImpl = (ISessionImplementor)session;
var sessionContext = sessionImpl.PersistenceContext;  
var entry = sessionContext.GetEntry(customer);
if (entry.Status == Status.Deleted)
{
  Console.WriteLine("Customer {0} is deleted", customer.Name);
} 
```

老实说：我自己没有这样做，但据我所知，它应该运作良好。不要搞乱会话实现和上下文，如果写入此类，您可能会破坏一切。

另一种更复杂但也不那么“hacky”的方法是注册一个删除处理程序。问题是a）它在数据库中删除实体时执行（例如：刷新会话时）和b）它需要在会话工厂的配置时注册，这使得实现变得困难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T06:57:54.027

这是有道理的。当您说 var customer = customers[0]; 时，您正在将客户的**副本设置为变量。**您在设置变量后将其删除。该声明：

```
Console.WriteLine(customers[0].CustomerName); 
```

没有使用缓存 - 它正在使用变量值。

# iphone - iphone TBXML xml 解析

> ID：10508526
> 
> 赞同：1
> 
> 时间：2012-05-09T00:57:08.303
> 
> 标签：iphone, ios, xml, parsing, tbxml

我在我的 iphone 应用程序中使用 TBXML。我有一个类似下一个的 xml：

```
<detail>
    <title>My title</title>
    <subs>
       <sub>subCategory1</sub>
       <sub>subCategory2</sub>
       <sub>subCategory3</sub>
    </subs>
</detail> 
```

我可以成功获得标题，并且只有第一个子类别。我用于获取子类别的代码如下：

```
NSMuttableArray *divs = [[NSMuttableArray] initWithCapacity:3];
TBXMLElement *subsElement = [TBXML childElementNamed:@"subs" parentElement:currentElement];
TBXMLElement *subElement = [TBXML childElementNamed:@"sub" parentElement:subsElement];
do {
    [divs addObject:[TBXML textForElement:subElement]];
    NSLog(@"%@ , %@", @"Got one subCategory " , divs.lastObject);
} while ((subsElement = subsElement->nextSibling)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T05:25:18.237

看来您的`where`陈述中有错字。我相信你的意思是使用`subElement`而不是`subsElement`. 所以你的代码应该是：

```
while ((subElement = subElement->nextSibling)); 
```

# configuration - IBM WebSphere Application Server：什么是“环境条目”？

> ID：10508527
> 
> 赞同：2
> 
> 时间：2012-05-09T00:57:21.793
> 
> 标签：configuration, websphere

在 WebSphere Application Server 管理控制台中， *应用程序服务器 > server1 > 进程定义 > 环境条目下有一个部分*

我不明白什么是环境条目。它们不是系统属性，因为它们是在*Process definition > Java Virtual Machine > Custom properties*中定义的。

那是什么？如何从应用程序中访问它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T18:19:48.597

引用[http://www-01.ibm.com/support/docview.wss?uid=swg21254153](http://www-01.ibm.com/support/docview.wss?uid=swg21254153)，官方描述为；

> 环境条目可用于指定不是特定于 WebSphere Application Server 的变量，而是由其他元素定义的，例如 UNIX®、Language Environment® (LE) 或第三方供应商等。这些变量往往是特定于操作系统的。

所以它们是特定于操作系统的（即 Windows 的 PATH，AIX 的 LIBPATH，Solaris 的 LD_LIBRARY_PATH）。

对于需要使用的示例情况；引用[http://publib.boulder.ibm.com/infocenter/dmndhelp/v7r0mx/topic/com.ibm.wbit.help.runtime.doc/deploy/topics/rcfglibadapters.html](http://publib.boulder.ibm.com/infocenter/dmndhelp/v7r0mx/topic/com.ibm.wbit.help.runtime.doc/deploy/topics/rcfglibadapters.html)

> 如果一个本地库依赖于其他本地库，则必须在托管应用程序服务器的 JVM 的 LIBPATH 上配置依赖库（而不是上图所示的本地路径），才能成功加载该库。您应该通过选择 Servers > Application Servers > server_name > Java and Process Management > Process Definition > Environment Entries 来配置环境条目（其中 server_name 是服务器的名称；例如 server1）。在 Environment Entries 页面上，创建一个新的环境条目以指定 JVM 的 LIBPATH。

您可以使用 System.getenv()（不是 System.getProperties()，它返回自定义属性和通用 JVM 参数）来访问这些变量。

# java - 从 EditText 获取数字

> ID：10508529
> 
> 赞同：3
> 
> 时间：2012-05-09T00:57:38.720
> 
> 标签：java, android, string, android-edittext, int

我知道他被问过几次，但我一直在尝试我发现的一切，但没有运气。我仍然有一个错误。这是我的代码。

xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:layout_gravity="center"
android:background="@android:color/transparent"
android:gravity="center"
android:orientation="vertical" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Write item value."
    android:textColor="@android:color/black"
    android:textSize="25dp" />

<EditText
    android:id="@+id/editText1"
    android:layout_width="80dp"
    android:layout_height="wrap_content"
    android:layout_marginBottom="202dp"
    android:ems="10"
    android:hint="Value"
    android:inputType="number" >

    <requestFocus />
</EditText> 
```

爪哇

```
public class PopupValores extends Activity {

    EditText valor1;
    String myEditValue;
    public static int valor;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.popupvalores);

        valor1 = (EditText) findViewById (R.id.editText1);
        myEditValue = valor1.getText().toString();
        valor = Integer.parseInt(myEditValue);   <<<<Line 20

    }
} 
```

日志猫

```
05-08 21:02:10.023: W/dalvikvm(6074): threadid=1: thread exiting with uncaught exception (group=0x40020578)
05-08 21:02:10.039: E/AndroidRuntime(6074): FATAL EXCEPTION: main
05-08 21:02:10.039: E/AndroidRuntime(6074): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.dc.maker/com.dc.maker.PopupValores}: java.lang.NumberFormatException: unable to parse '' as integer
05-08 21:02:10.039: E/AndroidRuntime(6074):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
05-08 21:02:10.039: E/AndroidRuntime(6074):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
05-08 21:02:10.039: E/AndroidRuntime(6074):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
05-08 21:02:10.039: E/AndroidRuntime(6074):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
05-08 21:02:10.039: E/AndroidRuntime(6074):     at android.os.Handler.dispatchMessage(Handler.java:99)
05-08 21:02:10.039: E/AndroidRuntime(6074):     at android.os.Looper.loop(Looper.java:130)
05-08 21:02:10.039: E/AndroidRuntime(6074):     at android.app.ActivityThread.main(ActivityThread.java:3687)
05-08 21:02:10.039: E/AndroidRuntime(6074):     at java.lang.reflect.Method.invokeNative(Native Method)
05-08 21:02:10.039: E/AndroidRuntime(6074):     at java.lang.reflect.Method.invoke(Method.java:507)
05-08 21:02:10.039: E/AndroidRuntime(6074):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
05-08 21:02:10.039: E/AndroidRuntime(6074):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
05-08 21:02:10.039: E/AndroidRuntime(6074):     at dalvik.system.NativeStart.main(Native Method)
05-08 21:02:10.039: E/AndroidRuntime(6074): Caused by: java.lang.NumberFormatException: unable to parse '' as integer
05-08 21:02:10.039: E/AndroidRuntime(6074):     at java.lang.Integer.parseInt(Integer.java:362)
05-08 21:02:10.039: E/AndroidRuntime(6074):     at java.lang.Integer.parseInt(Integer.java:332)
05-08 21:02:10.039: E/AndroidRuntime(6074):     at com.popupclass.PopupValores.onCreate(PopupValores.java:20)
05-08 21:02:10.039: E/AndroidRuntime(6074):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
05-08 21:02:10.039: E/AndroidRuntime(6074):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
05-08 21:02:10.039: E/AndroidRuntime(6074):     ... 11 more 
```

我试图从 EditText 中获取一个 int，然后在其他类中使用它来确定某物的值。有人可以告诉我我做错了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T01:12:47.417

例外是：

```
Java.lang.NumberFormatException: unable to parse '' as integer 
```

这只是因为 editbox1 字段中没有值。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.popupvalores);

    valor1 = (EditText) findViewById (R.id.editText1);
    myEditValue = valor1.getText().toString();

    Log.debug("logtag", myEditValue); // Here you can see the output.

    try {
        valor = Integer.parseInt(myEditValue); 
    }
    catch(Exception e) {
        Log.e("logtag", "Exception: " + e.toString());
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-30T19:15:25.533

**使用正则表达式...如下：**

```
public class PopupValores extends Activity {

EditText valor1;
String myEditValue;
public static int valor;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.popupvalores);

    valor1 = (EditText) findViewById (R.id.editText1);
    myEditValue = valor1.getText().toString();
    valor = Integer.parseInt(myEditValue.replaceAll("[\\D]",""));

} 
```

}

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T01:07:40.473

您尝试访问`valor1`太快，`valor1`当前是一个空字符串。您必须在用户有机会定义某些内容后处理该值。

尝试添加这样的按钮：

```
(Button) button = (Button) findViewByID(R.id.button1);
button.setOnClickListener(new OnClickListener() {
    public void onClick(View view) {
        String temp = valor1.getText().toString();
        if(temp.isEmpty() == false) {
            valor = Integer.parseInt(temp);
            Log.v("SO", "Valor = " + valor);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-09T01:12:23.437

该代码正在尝试将 EditText '' 中的空字符串解析为 int ，这会导致引发异常。

您的示例代码也缺少结束 LinearLayout 标记。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-09T01:09:30.293

您上面的代码肯定会导致问题，因为您在创建 Activity 时所做`Integer.parseInt(myEditValue)`的`onCreate()`，您的 EditText 尚未填充任何文本（并且您没有在其 XML 定义中提供默认值），所以它是一个空字符串，并且`Integer.parseInt(emptyString)`会抛出`NumberFormatException`.

这样做的正确方法是将解析 EditText 值的代码移动到某个地方，以响应用户事件，或者只是`try...catch` `Integer.parseInt()`.

最安全的方法是永远`try...catch` `Integer.parseInt()`，因为我们**永远不应该相信用户的输入**。

# ruby-on-rails - 如何包装 Rails 应用程序以进行部署和移交？

> ID：10508532
> 
> 赞同：0
> 
> 时间：2012-05-09T00:58:11.603
> 
> 标签：ruby-on-rails, ruby, rest

好的，我知道如何打包 Java RESTful 服务，例如以战争形式。但是对于 ROR 呢？我需要将我的 ROR 服务移交给另一个团队，并且不希望他们知道我的代码。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T01:14:50.587

虽然可以[将 jruby 项目包装为 War 文件](http://caldersphere.rubyforge.org/warbler/)，否则你就不走运了。

# coldfusion - 为什么带有无限循环的请求不会被 ColdFusion 请求超时杀死？

> ID：10508534
> 
> 赞同：7
> 
> 时间：2012-05-09T00:58:14.853
> 
> 标签：coldfusion, infinite-loop

首先，我`20`在 CF Admin 中将 Timeout Requests after (seconds) 设置为。

然后我运行一个 cfm 像这样的一行`while(true);`

该页面将运行超过 20 秒，并且在我写这篇文章时该线程仍然存在。

下面是使用 Server Monitor 拍摄的快照

```
Thread  jrpp-3 request type - TEMPLATE REQUEST
*Template Path - D:\Projects\infiniteLoop.cfm
*Request Parameters - {}
*Request Method - GET
*Client IP address - 127.0.0.1
*Thread elapsed time - 322659 milliseconds 
```

这正常吗？？这是CF9.0.1.，开发者版。多实例设置，使用 JRun。

停止无限循环的唯一方法是重新启动 CF。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-09T13:21:23.880

ColdFuison 中的请求超时不符合您的预期。他们的呈现方式，你会想象有一个看门狗检查你的请求已经运行了多长时间，并在请求超时或请求超时后不久将其杀死。实际发生的情况是，只有在运行某些标签时，CF 才会检查请求的经过时间是否超过了设置的限制。`<cfoutput>`是它检查的标签之一，这就是为什么您经常看到指向 cfoutput 的超时超出消息的原因，即使您知道它不会花费很长时间来执行。

```
<cfsetting requesttimeout="5" enableCFoutputOnly="no" />

<!--- Looping with a condition <cfloop blamed --->
<cfset request.counter=0 />
<cfloop condition="true">
    <cfset sleep(1000) />
    <cfset request.counter=request.counter+1>

    <cflog file="timeout" text="#request.counter#">

    <cfif request.counter GT 8>
        <cfbreak>
    </cfif>

</cfloop>

<!--- Looping with an index, times out, naming CFLOOP as the offending tag --->
<cfloop index="foo" from="1" to="8">
    <cfset sleep(1000) />
</cfloop>

<!--- Looping with an index, times out, naming CFOUTPUT as the offending tag --->
<cfloop index="foo" from="1" to="8">
    <cfset sleep(1000) />
    <cfoutput>Hello</cfoutput>
</cfloop>

<!--- Same loop, but in script. No timeout warning at all --->
<cfscript>
for(foo=1;foo<=8;foo++){
    sleep(1000);
}
</cfscript>

<!--- Same loop, now with WriteOutput() called. Still no timeout --->
<cfscript>
for(foo=1;foo<=8;foo++){
    sleep(1000);
    writeoutput("tick...");
}
</cfscript> 
```

上面的代码显示了 requesttimeout 的一些奇怪行为。正如 Mark Kruger 指出的那样，任何对外部资源的调用都意味着不检查超时，我猜只是执行您自己的逻辑的大块脚本也不会被检查，而下一个输出语句将受到指责。

如果您需要跟踪代码滞后的位置并且超时消息指向错误的位置，我会在长时间运行的代码运行时使用日志记录或 jstack 从服务器获取堆栈跟踪。每隔几秒钟抓取一些堆栈跟踪，然后通过[Samurai](http://yusuke.homeip.net/samurai/en/index.html)运行日志文件以查找代码在做什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T09:31:23.277

当您知道 ColdFusion 中请求超时检查的约束时，您所描述的是不幸的预期行为。（当然，这不应该是预期的行为。）

Charlie Arehart有一篇关于超时问题的长[博文。](http://www.carehart.org/blog/client/index.cfm/2010/10/15/Lies_damned_lies_and_CF_timeouts/)一个部分的标题是“CF 在下一个操作开始时检查时间，但遗憾的是只在一些标签上”。不幸`cfscript`的是不是其中之一，并且不会使用纯脚本代码检查超时。但是，触发超时检查的标签之一是`cfoutput`，有了这些知识，就可以使基于脚本的代码尊重请求超时。然而，这是一个手动过程，您需要自己决定应该在哪里检查超时。

```
<cffunction name="cf_checkRequestTimeout" access="public" output="false" returntype="void" hint="Force CF to check if the request has timed out.">

    <!--- CF checks Request timeout on cfoutput tag use.  --->
    <cfoutput></cfoutput>

</cffunction>

<cfscript>
    for(foo=1;foo<=61;foo++){
        sleep(1000);
        cf_checkRequestTimeout();
    }
</cfscript> 
```

生成的错误将归咎于第 4 行，这具有误导性，但堆栈跟踪将显示该函数是从第 11 行调用的，这样您就可以知道哪位代码超时了。显然，该知识的粒度是基于检查超时的频率。

（`cf_checkRequestTimeout`不是`checkRequestTimeout`因为这是一个未记录的内部 CF 函数）也可以在 cfscript 之外调用，因此，例如，如果`cfquery`您认为导致超时问题，那么您可以将`cf_checkRequestTimeout`调用放在`cfquery`应该出现的超时错误之后而不是进一步执行代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-09T08:44:41.073

我发现和亨利一样的东西。这是我的测试代码：

```
Before thread<br />
<cfthread action="run" name="t1">
    <cfloop condition="true">
        <cfparam name="count" default="0">
        <cfset sleep(3000)>
        <cflog file="cfthreadTest" text="Log entry #++count#">
    </cfloop>
</cfthread>
After thread<br /> 
```

我的请求超时在 CFAdmin 中设置为 20 秒，而这个线程现在已经运行了 15 分钟。也就是说，线程不是“请求”，所以我不确定我是否希望它遵守请求超时。没有任何记录表明我可以发现它应该尊重请求超时。也就是说......有某种杀死线程的方法将是“方便的”。

我想这只是我认为您的期望不正确的上下文中的“答案”，因为您希望它尊重请求超时。

# objective-c - 跟随iOS教程时找不到特定代码

> ID：10508543
> 
> 赞同：0
> 
> 时间：2012-05-09T00:58:56.163
> 
> 标签：objective-c, ios, xcode

我是 iOS 编程新手，我正在阅读本教程以相处[http://www.raywenderlich.com/1797/how-to-create-a-simple-iphone-app-tutorial-part-1](http://www.raywenderlich.com/1797/how-to-create-a-simple-iphone-app-tutorial-part-1)

有一部分它告诉我打开我的 MasterViewController.m 并执行此操作：

```
// Replace the return statement in tableView:numberOfRowsInSection with the following:
return _bugs.count; 
```

和这个：

```
// Replace tableView:cellForRowAtIndexPath with the following
- (UITableViewCell *)tableView:(UITableView *)tableView
         cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView
                             dequeueReusableCellWithIdentifier:@"MyBasicCell"];
    ScaryBugDoc *bug = [self.bugs objectAtIndex:indexPath.row];
    cell.textLabel.text = bug.data.title;
    cell.imageView.image = bug.thumbImage;
    return cell;
} 
```

但是，我在此类中找不到类似“tableView:numberOfRowsInSection”或“tableView:cellForRowAtIndexPath”的语句。

这是我的 MasterViewController.m 类的代码：

```
#import "ScaryBugsMasterViewController.h"
#import "ScaryBugDoc.h"
#import "ScaryBugData.h"

@implementation ScaryBugsMasterViewController

@synthesize bugs = _bugs;

- (void)awakeFromNib
{
    [super awakeFromNib];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Release any cached data, images, etc that aren't in use.
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    self.title = @"Scary Bugs"; 
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
}

- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated
{
    [super viewDidDisappear:animated];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    return YES;
}

/*
// Override to support conditional editing of the table view.
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the specified item to be editable.
    return YES;
}
*/

/*
// Override to support editing the table view.
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete) {
        // Delete the row from the data source.
        [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
    } else if (editingStyle == UITableViewCellEditingStyleInsert) {
        // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view.
    }   
}
*/

/*
// Override to support rearranging the table view.
- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath
{
}
*/

/*
// Override to support conditional rearranging of the table view.
- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the item to be re-orderable.
    return YES;
}
*/

@end 
```

也许我在创建课程时做错了什么？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T01:06:57.873

UITableView 需要这三种方法才能工作。

(1) 指定表格中的节数

(2) 指定表格中每节的行数

(3) 创建将填充表格行的 UITableViewCell

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView
 numberOfRowsInSection:(NSInteger)section
{
    return [self.bugs count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView
         cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView
                             dequeueReusableCellWithIdentifier:@"MyBasicCell"];
    ScaryBugDoc *bug = [self.bugs objectAtIndex:indexPath.row];
    cell.textLabel.text = bug.data.title;
    cell.imageView.image = bug.thumbImage;
    return cell;
} 
```

编辑：导航到页面底部并下载源代码。这些方法在 MasterViewController 中实现。

当您创建一个新类时，只需将 UITableViewController 子类化，这些方法模板将自动在该类中，您只需实现它们即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T01:08:02.917

看起来您使用的是 UIViewController 而不是 UITableViewController。如果您使用 UITableViewController，您将获得表视图委托和数据源方法的存根。

# asp.net-mvc-3 - HttpPost 验证错误后如何补充 ViewModel

> ID：10508544
> 
> 赞同：0
> 
> 时间：2012-05-09T00:59:08.880
> 
> 标签：asp.net-mvc-3, postback, viewmodel

在 HttpPost 上的验证失败后，我的 ViewModel 没有得到适当的补水，导致在重新显示视图时，'CartItems' 上出现“*对象引用未设置为对象的实例”错误。*

如何重新水化我的 ViewModel 以便它可以重新显示错误消息？

我曾尝试使用`@Html.HiddenFor(...)`来保留未显示的值（根据[此答案](https://stackoverflow.com/a/9779666/242)），但这不起作用。

**视图模型**

```
 public class CheckoutViewModel
    {
        public List<Cart> CartItems { get; set; }
        [DisplayFormat(DataFormatString = "${0:F2}")]
        public double CartTotal { get; set; }
        public virtual Order Order { get; set; }
    } 
```

**控制器 GET：ActionResult**

```
 //GET: /Checkout/AddressAndPayment
    public ActionResult AddressAndPayment()
    {
        var order = new Order();
        order.Username = User.Identity.Name;
        MembershipUser currentUser = Membership.GetUser(User.Identity.Name, true /* userIsOnline */);
        storeDB.SaveChanges();

        var cart = ShoppingCart.GetCart(this.HttpContext);

        // Set up the ViewModel
        var viewModel = new CheckoutViewModel
        {
            CartItems = cart.GetCartItems(),
            CartTotal = cart.GetTotal(),
            Order = order
        };

        // Return the view
        return View(viewModel);
    } 
```

**控制器 POST：ActionResult**

```
 [HttpPost]
    public ActionResult AddressAndPayment(CheckoutViewModel checkoutViewModel)
    {
        TryValidateModel(checkoutViewModel);
        try
        {
            checkoutViewModel.Order.Username = User.Identity.Name;
            checkoutViewModel.Order.OrderDate = DateTime.Now;
            storeDB.Orders.Add(checkoutViewModel.Order);

            // Error occurs on the following line if a custom data annotation validation attribute fails
            storeDB.SaveChanges();

            var cart = ShoppingCart.GetCart(this.HttpContext);
            cart.CreateOrder(checkoutViewModel.Order);
            storeDB.SaveChanges();

            return RedirectToAction("Complete", new { id = checkoutViewModel.Order.OrderID });
        }
        catch
        {
            //Invalid - redisplay with errors
            return View(checkoutViewModel);
        }
    } 
```

**编辑#1**
@SoWeLie 告诉我，我已经解决了这个问题。
为了在将 ViewModel 中的 cartItem 重新水化，然后将其传递回 View，我将以下代码添加到了 HttpPost ActionResult 的 catch 块中。这段代码基本上调用了命中数据库的方法来获取购物车的必要信息：

```
catch
        {
            //Invalid - redisplay with errors
            //The model is not valid, we need to redisplay the same view so that the user can fix the errors => fetch the cartItems
             var cart = ShoppingCart.GetCart(this.HttpContext);
             checkoutViewModel.CartItems = cart.GetCartItems();
             checkoutViewModel.CartTotal = cart.GetTotal();

            return View(checkoutViewModel);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T01:11:12.150

您不希望在隐藏字段中保留整个对象，例如 CartItem 列表。试图将所有数据作为帖子值携带是低效且难以维护的。您的购物车对象需要保存在应用程序中的某个位置，例如数据库。您还可以将购物车存储在用户的会话中。

完成此操作的最佳方法是将用户的购物车保存在数据库中。有多种方法可以做到这一点。在不知道您的数据库模型的情况下，最简单的解决方案是将购物车及其项目添加到数据库中，然后获取购物车 ID 并将其存储在会话或 cookie 中（取决于您希望购物车保留多长时间）。

# javascript - 使用css关闭javascript？

> ID：10508547
> 
> 赞同：0
> 
> 时间：2012-05-09T00:59:20.813
> 
> 标签：javascript, mobile, css, media-queries

我使用媒体查询将移动访问者引导至单独的移动特定样式表。问题是索引页面上有使用 JS 的元素，我需要为移动版本关闭它 - 我该怎么做？

补充说明：我不熟悉 JS - 我可以使用 html 和 css 并使用其他人的 js :-/

关于下面的一些评论，由于加载了不必要的代码，我担心移动设备的加载时间。有人可以告诉我要添加到我的元素中以告诉文档仅在不是移动设备时才加载 js 吗？这是正确的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T01:02:51.663

最好的解决方案是只加载移动版本所需的脚本。由于许多设备都有数据上限，因此您不希望用户加载他们不需要的脚本。因此，您将通过 PHP 或 JavaScript 检测他们的浏览器，然后为他们的平台加载所需的文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T01:00:42.777

为什么不使用一个脚本来检测与您的媒体查询相同的规范呢？这样您就可以有选择地激活脚本。

[1140 CSS Grid](http://cssgrid.net/)框架中存在一个这样的脚本，以支持旧浏览器上的媒体查询。您可以检查一下，看看如何利用它。

[这是一篇文章](http://www.sitepoint.com/javascript-media-queries/)，解释了如何检查屏幕宽度和高度以模拟媒体查询屏幕检测。

顺便一提。CSS用于样式，仅此而已。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-26T18:43:10.627

媒体查询可能是为移动用户提供替代样式的最佳解决方案。不幸的是，在页面逻辑的情况下，元素没有类似的`media`属性。`<script>`

但是，您可以提供一个脚本加载器，它将`.js`根据浏览器根据您的媒体查询选择的样式表加载所需的文件。我不知道如何以直接、优雅的方式做到这一点，但有一个很好的技巧。您必须`.css`用唯一的声明“标记”每个声明（虚拟的、不重要的或不同的设计），并在页面加载后从 JS 中检查它以确定浏览器应用了哪个样式表。

CSS 可能如下所示：

```
@media handheld, screen and (max-width:1023px) {
    body {margin-top: 1px}
}
@media screen and (min-width:1024px) {
    body {margin-top: 0px}
}
/* These would be separate .css files in a real example */ 
```

以及随附的JS如下：

```
window.setTimeout('wait()', 10);
function wait() {
    if (!document.body)
        window.setTimeout('wait()', 100)
    else
       onLoad();
}

function onLoad() {
    var load = document.createElement('script');
    var head = document.getElementsByTagName('head')[0];
    var body = document.getElementsByTagName('body')[0];
    var mark = window.getComputedStyle(body).getPropertyValue('margin-top');
    switch (mark) {
        case '0px':
            load.setAttribute('src', 'handheld.js');
            break;
        case '1px':
            load.setAttribute('src', 'screen.js');
            break;
        default:
            load.setAttribute('src', 'somethingelse.js');
    }
    head.appendChild(load);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T01:22:33.493

两种选择：

您可以在桌面上使用一个脚本来加载所有其他脚本，如果您只使用非侵入式 Javascript（例如 jquery），这是一个不错的选择。

另一种选择是不首先在服务器端生成这些脚本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-09T01:03:55.490

我假设您的意思是页面上有嵌入脚本的元素。您需要做的第一件事是摆脱嵌入的脚本，例如元素上的 onclick 属性。这些脚本需要移动到它们自己的外部 JS 文件中。完成此操作后，您只能包含网站移动版本的 JS 文件。

# javascript - 使用 JavaScript 而不是 jQuery 在鼠标悬停时更改 div 内的图像宽度

> ID：10508549
> 
> 赞同：1
> 
> 时间：2012-05-09T00:59:29.793
> 
> 标签：javascript

我是 JavaScript 新手，我很难解决这个问题。

页面上有三个 div：

div 1 的 ID 为“div1”，上面有三个图像：

*   ID：im1，src = Cat.jpg
*   ID：im2，src = Dog.jpg
*   ID：im3，src = Fish.jpg

Div 2 的 ID 为“div2”，其中包含三个段落。在每个文本中添加一些随机文本，但要确保它们的 ID 为“p1”、“p2”和“p3”</p>

Div 3 的 ID 为“div3”，有两个段落（ID p4 和 p5；在每个段落中放入随机文本）和两个图像（ID im4 和 im5；src = Bird.jpg 和 src = Turtle.jpg。

当窗口完成加载时，必须通过 JavaScript 设置以下行为（不要使用 jQuery）：

*   当鼠标悬停在 div1 中时，每个图像都必须调整为 100px 宽度
*   div3 中的每个段落必须在鼠标悬停时获得黄色背景色

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T01:04:15.373

您可以使用 CSS 完成此操作

```
#div1 img:hover{ width:100px; }
#div3 p:hover{ background:yellow; } 
```

# ajax - Valums 文件上传器限制总文件大小？

> ID：10508553
> 
> 赞同：1
> 
> 时间：2012-05-09T01:00:04.977
> 
> 标签：ajax, file, size, restrict, uploader

我在这里找到了一个非常好的上传脚本：http: [//valums.com/ajax-upload/](http://valums.com/ajax-upload/) 但是，我希望能够限制所有文件的总上传大小。它可以让我限制单个尺寸，但是有没有办法限制所有尺寸的总和？例如，如果我将单个最大大小限制为 10MB，我可以上传 20 个 9.8 MB 的文件。只要所有文件的总大小不超过 10 MB，我希望能够让文件成为他们想要的任何大小。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T01:19:23.127

我自己找到了解决方案。我在顶部放了一个总大小变量，每次都将文件大小添加到总大小变量中，然后我检查了一下。

# asp.net - Telerik RadGrid 插入按钮的问题

> ID：10508555
> 
> 赞同：0
> 
> 时间：2012-05-09T01:00:11.280
> 
> 标签：asp.net, telerik, radgrid

目前，我有一个带有 radgrid 的页面和一些其他带有必填字段验证器的 asp.net 文本框。无论如何，问题是当其他文本框未填写时（由于验证器），我无法插入 radgrid。无论如何，是否允许用户将数据输入到 radgrid 中而不强迫他们先将内容输入到文本框中。请告诉我是否需要提供代码示例等。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T05:53:54.247

请尝试以下代码片段。

我猜您使用的是内联编辑模式/使用了内置的 EditCommandColumn。

注意：如果您使用的 ButtonType 与标准按钮不同，则使用 LinkBut​​ton / ImageButton 代替下面代码片段中的 Button。

```
protected void RadGrid1_ItemDataBound(object sender, GridItemEventArgs e)
{
    if (e.Item.IsInEditMode)
    {
        if (e.Item is GridDataInsertItem)
        {
            // Insert
            GridEditableItem editItem = (GridEditableItem)e.Item;
            Button InsertButton = (Button)editItem.FindControl("PerformInsertButton");
            InsertButton.CausesValidation = false; 
            //or
            InsertButton.ValidationGroup = "test";

        }
        else
        {
            // Update
            GridEditableItem editItem = (GridEditableItem)e.Item;
            Button updateButton = (Button)editItem.FindControl("UpdateButton");
            updateButton.CausesValidation = false;
            //or
            updateButton.ValidationGroup = "test";

        }
    } 
```

# php - 关闭后如何重新打开 php 会话？

> ID：10508556
> 
> 赞同：2
> 
> 时间：2012-05-09T01:00:13.027
> 
> 标签：php, jquery, ajax, session

有点像菜鸟问题，但我正在编写一个棋盘游戏，其中棋盘状态以及其他游戏状态信息被存储为 php 会话变量。该板是用 html/jquery 呈现的。每转一次，都会对 php 进行一次 ajax 调用，以执行逻辑来更改电路板的状态。但是每次 ajax 调用，似乎都会打开一个新的 php 会话而忘记旧的会话。这是代码：

```
'index.php'
        $.ajax({
        type: 'POST',
        url: 'cycle.php',
        data: {},
        dataType: 'json',       
        success: function(data, status, jqXHR) {    
            var stuff = jQuery.parseJSON(jqXHR.responseText);
            $("#board").html(stuff.html);       
        },
    }); 

'cycle.php'
        <?php 
session_start();
include('functions.php');
header('Content-type: application/json');

if (!isset($_session['turn'])) {

    $_session['turn'] = 1;
    $_session['population'] = "";
    $out = write_table();   
    $out['turn'] = $_session['turn'];
    $out = json_encode($out);
    echo $out;
}
else {
    $_session['turn'] = 2;
    $out = turn($_session['population']);
    $out['turn'] = $_session['turn'];
    $out = json_encode($out);
    echo $out;
}

?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T01:12:37.733

尝试`$_SESSION`而不是`$_session`. 所有 PHP 变量名都[区分大小写](http://php.net/manual/en/language.variables.basics.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T01:06:23.633

`session_start()`只要您不打电话，它就应该是自动的`session_destroy()`

你的代码/设置必须有更深层次的东西才能发生。

或许检查与会话相关的 PHP INI 设置。

# oauth-2.0 - 为什么当我再次将用户发送到 auth url 时，Google OAuth2 会重新请求用户许可

> ID：10508557
> 
> 赞同：25
> 
> 时间：2012-05-09T01:00:14.397
> 
> 标签：oauth-2.0

使用旧的 google openid，当我将用户（之前选择加入我的应用程序）发送到 auth url 时，它会立即将他们重定向回我的应用程序。

现在，使用 OAuth2，auth url 不断向用户请求许可。我阅读了一些关于此的文档，但我不明白这个流程我应该如何工作：

1.  用户通过我的应用程序登录谷歌并点击允许权限
2.  几天后，cookies被清除，用户回到我的网站，点击“登录谷歌”
3.  用户不再被要求获得许可，他们立即登录。

我认为这与在步骤 1 中存储身份验证令牌或刷新令牌有关，但在步骤 3 中，我不知道他们是谁，所以我如何将它们与正确的身份验证或刷新令牌匹配以获得有效访问令牌。

在我的测试中，当我在步骤 1 中将它们发送到原始身份验证 URL 时，会再次要求它们提供权限。

**编辑：找到解决方案**

google-api 在创建 auth url 时默认放置“approval_prompt=force”。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-12T19:07:02.633

是的，正如您所指出的，使用`approval_prompt=force`URL 参数将强制每次向用户显示身份验证对话框。通过简单地删除此 URL 参数，用户将不会在后续身份验证流程中收到提示。

如果您使用服务器端流程 ( `response_type=code`) 和离线访问 ( `access_type=offline`)，您将获得的响应略有不同。用户第一次授权您（当他看到批准屏幕时）或者如果您通过使用强制这样做，`approval_prompt=force`那么当您交换身份验证代码时，您将被授予 a`refresh_token`和 an `access_token`。

但是，每次用户未显示批准屏幕时（不使用approval_prompt=force 时的后续身份验证），在交换身份验证代码时，您只会被授予access_token，没有refresh_token。因此，如果这是您正在使用的流程，并且如果您希望能够离线访问用户的数据，则需要确保将 refresh_token 保存在本地以供第一次使用时使用。

仅当您请求访问其他类型的数据而不是简单的身份验证数据时才可能发生这种情况（使用 OAuth 2 流程，您可以请求访问其他数据，例如，联系人 API 数据、日历 API 数据、驱动器数据等...）因为通常情况下，常规的 Open ID 流不需要离线访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-17T17:37:11.920

只需在请求中传递一个附加参数`'approval_prompt=auto'`对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-13T16:45:01.953

对我来说，它是`hd`（托管域）参数。从授权网址中删除后，我得到了一个可供选择进行身份验证的用户列表。`hd`有关此处参数的更多信息[https://developers.google.com/identity/protocols/OpenIDConnect#hd-param](https://developers.google.com/identity/protocols/OpenIDConnect#hd-param)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-15T17:51:20.440

有一点更新，这个链接可以帮助：[https ://github.com/googleapis/oauth2client/issues/453](https://github.com/googleapis/oauth2client/issues/453)

'approval prompt' was replaced by 'prompt' with params: 'none', 'consent' and 'select_account'

# python - 在 Python 中从 IP 地址和掩码长度获取 IP 掩码

> ID：10508560
> 
> 赞同：5
> 
> 时间：2012-05-09T01:00:24.287
> 
> 标签：python, sockets, networking, ip-address, subnet

给定一个以点分四符号表示的 IP 地址，例如：
192.192.45.1
和一个掩码长度，例如通常为 8、16、24，但可以是任何值，即 17。

有人可以提供python中的代码来计算子网掩码吗？最好我可以将结果作为 32 位整数得到，这样就很容易散列，然后在需要打印时重新解释为点分四边形。我看到python有一个socket库，它基本上是unix socket api的包装器。我还看到它具有 inet_ntoa() 函数，但它返回某种数据包结构。我对 Python 结构库不是很熟悉，所以我希望其他人会有一些想法。谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-09T01:04:21.293

最简单的方法是使用 google 的[ipaddr](https://github.com/google/ipaddr-py)模块。我假设下面有一个 25 位掩码，但正如你所说，它可以是任何东西

对于 Python2

```
>>> # Use ipaddr in python 2.x
>>> import ipaddr
>>> mask = ipaddr.IPv4Network('192.192.45.1/25')
>>> mask.netmask
IPv4Address('255.255.255.128')
>>> 
```

对于 Python 3...

```
>>> # Use ipaddress in python 3.x
>>> import ipaddress
>>> mask = ipaddress.IPv4Network('192.192.45.1/25')
>>> mask.netmask
IPv4Address('255.255.255.128')
>>> 
```

该模块在处理 IPv4 和 IPv6 地址方面相当有效......其中一些其他功能的示例......

```
>>> ## Subnet number?
>>> mask.network
IPv4Address('192.192.45.0')
>>>
>>> ## RFC 1918 space?
>>> mask.is_private
False
>>>
>>  ## The subnet broadcast address
>>> mask.broadcast
IPv4Address('192.192.45.127')
>>> mask.iterhosts()
<generator object iterhosts at 0xb72b3f2c> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-09T01:29:53.130

您可以像这样计算掩码的 32 位值

```
(1<<32) - (1<<32>>mask_length) 
```

例如。

```
>>> import socket, struct
>>> mask_length = 24
>>> mask = (1<<32) - (1<<32>>mask_length)
>>> socket.inet_ntoa(struct.pack(">L", mask))
'255.255.255.0' 
```

# php - 名称匹配时ubuntu自动重定向到文件？$1 包含 something.php 但不包含某物

> ID：10508561
> 
> 赞同：0
> 
> 时间：2012-05-09T01:00:36.023
> 
> 标签：php, .htaccess, ubuntu

我正在开发 UBUNTU 12,04。这是我的 .htaccess 文件

```
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-l
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^(.*)$  something.php?url=$1 [QSA,L] 
```

问题是当我为请求输入 localhost/something 时，如果文件确实存在，请求会自动变为 something.php。但是当我输入 localhost/something $1 时它在 Windows 中运行良好，仍然等于某物。无论如何要禁用此设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T01:11:24.887

听起来像启用了 Apache 的[MultiViews](http://httpd.apache.org/docs/2.2/content-negotiation.html#multiviews)功能。

`Options -MultiViews`在同一个 .htaccess 中将为该目录禁用它。

或者，您可以`MultiViews`从`Options`httpd.conf 中文档根目录可能存在的指令中删除，并禁用此服务器或主机范围。

# excel - 当 arr[,] 包含的日期小于 1900-01-01 时，Excel Interop Range.Value = arr[,] 崩溃并出现 0x800A03EC

> ID：10508566
> 
> 赞同：2
> 
> 时间：2012-05-09T01:00:58.610
> 
> 标签：excel, datetime, interop, range, hresult

我了解基本问题是 Excel 将 1900-01-01 表示为 1 的值。但是，在 Excel 中，可以手动输入 1900 之前的值。

```
// this converts the DataTable to an Object[,]
DataTable table = ...
Object[,] arr = DataTableUtils.toObjectArray(table, false);

Range r00 = r0.get_Resize(arr.GetLength(0), arr.GetLength(1));
r00.Value = arr; // <-- this will crash if ... 
```

如果 arr[,] 包含 1899-12-31 之前的 DateTime 对象，则将导致 0x800A03EC 异常。奇怪的是，1899-12-31 很好，Excel 增加了一天的价值。最初我用 1900-01-01 替换了 1900 年前的日期，但在输出文件中，它们是 1900-01-02！

目前，我正在使用解决方法来替换错误的 DateTime 值。但是，如果有人有更好的解决方案，请告诉我。

# html - HTML5 多边形鼠标悬停

> ID：10508568
> 
> 赞同：0
> 
> 时间：2012-05-09T01:02:01.887
> 
> 标签：html, mouse, polygons

我有一个 HTML5 画布。我已经绘制了 100 多个动态多边形。这些多边形是路径的集合（beginPath、moveto、lineTo、...、closePath）。

每个多边形都存储在一个数组中。我在每个元素中存储坐标和一些属性信息。

我已经绘制了多边形，一切都很好。我现在希望将鼠标悬停在多边形上时显示一些属性。

现在我知道我不能将事件附加到任何多边形对象，因为它们不是真正的对象。

检查我悬停在哪个多边形上的最流行/最快的方法是什么。

注意：我想使用纯 HTML5，没有动力学或任何其他库。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T01:10:23.533

我会提前承认我的偏见，因为我写了它，但是您可以使用[alphapun.ch](http://alphapun.ch)使用实际元素来绘制多边形，而不是（或除了）画布。这样您就可以正确检测事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T01:11:31.993

通常的技术是两遍：

对于数组中的每个多边形：

*   将“边界矩形”与每个多边形信息一起保存，并测试鼠标光标是否在该矩形内
*   如果第一个测试是肯定的，则应用“多边形内的点”算法，该算法成本更高。

这是该算法的一个示例：

```
function isPointInPoly(poly, pt){
  for (var c = false, i = -1, l = poly.length, j = l - 1; ++i < l; j = i)
  ((poly[i].y <= pt.y && pt.y < poly[j].y) || (poly[j].y <= pt.y && pt.y < poly[i].y))
  && (pt.x < (poly[j].x - poly[i].x) * (pt.y - poly[i].y) / (poly[j].y - poly[i].y) + poly[i].x)
  && (c = !c);
  return c;
} 
```

# ruby-on-rails - 瘦服务器性能不佳/事件 Web 服务器如何工作？

> ID：10508572
> 
> 赞同：9
> 
> 时间：2012-05-09T01:02:29.673
> 
> 标签：ruby-on-rails, ruby-on-rails-3, webserver, thin, evented-io

我在 Nginx/Passenger 上有一个 rails 3 应用程序，我刚搬到 Nginx/Thin (1.3.1)。但是，我的应用程序现在明显比在Passenger 上要慢。很多请求也超时。

Thin 是一个事件网络服务器。根据我所读到的有关事件 Web 服务器的内容，它们没有工人的概念。一个“工人”处理一切。因此，如果一个请求正在等待 IO，thin 将继续处理下一个请求，依此类推。我读到的关于事件服务器的一种解释说，事件服务器的性能应该与基于工作者的服务器一样好或更好，因为它们只受系统资源的约束。

但是，我的 CPU 使用率很少。我的内存使用量也很少，也没有太多的 IO 发生。我的应用程序只进行了一些 MySQL 查询。

这里的瓶颈是什么？我的瘦服务器不应该在 CPU 达到 100% 之前处理请求吗？我是否必须在我的应用程序中做任何不同的事情才能让它在事件服务器上表现得更好？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-09T02:28:55.707

塞尔吉奥是正确的。在这一点上，您的应用程序可能比传统的 Apache/Passenger 模型更好。如果您采用事件路由，特别是在像 Ruby 这样的单线程平台上，您永远不能阻塞任何东西，无论是数据库、缓存服务器，还是您可能发出的其他 HTTP 请求——什么都没有。

这就是使异步（事件）编程更难的原因 - 很容易阻塞东西，通常以同步磁盘 I/O 或 DNS 解析的形式。诸如 nodejs 之类的非阻塞（事件）框架非常小心，因为它们（几乎）从不为您提供阻塞的框架函数调用，而是使用回调（包括 DB 查询）处理所有事情。

如果您查看单线程非阻塞服务器的核心，这可能更容易可视化：

```
while( wait_on_sockets( /* list<socket> */ &$sockets, /* event */ &$what, $timeout ) ) {
    foreach( $socketsThatHaveActivity as $fd in $sockets ) {
        if( $what == READ ) {   // There is data availabe to read from this socket
            $data = readFromSocket($fd);
            processDataQuicklyWithoutBlocking( $data );
        }
        elseif ($what == WRITE && $data = dataToWrite($fd)) { // This socket is ready to be written to (if we have any data)
            writeToSocket( $fd, $data );    
        }
    }
} 
```

您在上面看到的称为事件循环。`wait_on_sockets`通常由 OS 以系统调用的形式提供，例如 select、poll、epoll 或 kqueue。如果 processDataQuicklyWithoutBlocking 花费的时间太长，操作系统维护的应用程序的网络缓冲区（新请求、传入数据等）最终会填满，并导致它拒绝新连接并使现有连接超时，因为 $socketsThatHaveActivity 处理速度不够快. 这与线程服务器（例如典型的 Apache 安装）不同，因为每个连接都使用单独的线程/进程提供服务，因此传入数据将在到达后立即读入应用程序，而传出数据将立即发送.

当您进行（例如）数据库查询时，像 nodejs 这样的非阻塞框架所做的是将数据库服务器的套接字连接添加到被监视的套接字列表（$sockets）中，因此即使您的查询需要一段时间，您的（仅）线程不会在那个套接字上被阻塞。相反，他们提供了一个回调：

```
$db.query( "...sql...", function( $result ) { ..handle result ..} ); 
```

正如您在上面看到的，db.query 立即返回，并且在 db 服务器上绝对没有任何阻塞。这也意味着您经常必须编写这样的代码，除非编程语言本身支持异步函数（如新的 C#）：

```
$db.query( "...sql...", function( $result ) { $httpResponse.write( $result ); $connection.close(); } ); 
```

如果您有许多进程都在运行事件循环（通常是运行节点集群的方式），或者使用线程池来维护事件循环（java 的 jetty、netty 等），那么永不阻塞规则可以稍微放松，你可以用 C/C++ 编写你自己的）。当一个线程在某事上被阻塞时，其他线程仍然可以执行事件循环。但是在足够重的负载下，即使这些也无法执行。所以永远不要在事件服务器中阻塞。

如您所见，事件服务器通常尝试解决不同的问题——它们可以有大量打开的连接。他们擅长的地方是仅仅通过轻计算来推送字节（例如彗星服务器，像memcached，varnish这样的缓存，像nginx，squid等代理）。毫无价值的是，即使它们可以更好地扩展，响应时间通常也会增加（没有什么比为连接保留整个线程更好的了）。当然，运行与并发连接数相同的线程数可能在经济/计算上不可行。

现在回到你的问题——我建议你仍然保留 Nginx，因为它在连接管理（基于事件）方面非常出色——通常意味着处理 HTTP 保持活动、SSL 等。然后你应该将它连接到你的 Rails 应用程序使用 FastCGI，您仍然需要运行工作人员，但不必重写您的应用程序以完全事件。您还应该让 Nginx 提供静态内容 - 让您的 Rails 工作人员与 Nginx 通常可以做得更好的东西捆绑在一起是没有意义的。这种方法的扩展性通常比 Apache/Passenger 好得多，尤其是当您运行一个高流量的网站时。

如果您可以编写整个应用程序以进行事件处理，那就太好了，但我不知道在 Ruby 中这有多容易或多难。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T01:09:47.297

是的，Thin 确实有事件 I/O，但仅适用于 HTTP 部分。这意味着它可以在处理请求时接收传入的 HTTP 数据。但是，您在处理期间执行的所有阻塞 I/O 仍然是阻塞的。如果您的 MySQL 响应缓慢，那么瘦请求队列将被填满。

对于“更多”事件的网络服务器，您应该查看[Rainbows](http://rainbows.rubyforge.org/)。

# spring - 谁能比较 Google Guice 和 Spring DI？

> ID：10508577
> 
> 赞同：7
> 
> 时间：2012-05-09T01:03:38.840
> 
> 标签：spring, dependency-injection, guice

谁能列出 Google guice 在 Spring DI 上的优缺点？两者都以一种或另一种方式满足依赖注入。在哪些情况下我们可以使用 google guice，在哪些情况下我们可以使用 Spring DI。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T01:47:08.063

好吧，我已经将两者用于不同的事情。我认为很大程度上取决于偏好。

我不会在这里进行详尽的比较，因为其他人已经在网络上这样做了。根据我的经验，Spring 更适合 Java EE 方面的事物（Web 应用程序等），而 Guice 更适合其他类型的应用程序（例如 Eclipse）。我要说的是，*反对*Spring 讨论其“笨拙”的 XML 配置的论点不再正确。从 Spring 3 开始，如果您愿意，可以（几乎）使用带注释的 Java 类完全配置应用程序上下文。

还要记住，Guice 比 Spring 更新得多，并且在一定程度上，开发团队能够基于 Spring 学习开发 DI 框架的知识来编写代码。在 Guice 中，对于更多的角落用例（例如基于工厂的部分注入的 @Assisted 注释）似乎有更多的灵活性。

# java - 期望值，错误的结果

> ID：10508582
> 
> 赞同：0
> 
> 时间：2012-05-09T01:04:28.947
> 
> 标签：java, android

在阅读了一些关于我的应用程序的统计数据后，我发现更新 75% 的用户需要一个多月的时间。由于所有更新都非常重要，因此我提出了一个应用内警报，告诉用户有更新待处理。

有一个包含实际应用程序版本 (18) 的文本文件，存储在通过该`DownloadText()`方法获取的网络服务器中。这个数字进入`isUpdatetxt`并从带有 的不可显示字符中提取`.substring(1, 3)`。所以基本上，只剩下“18”了。

但有我的问题：`isUpdatetxt == "18"`返回错误，当它不应该的时候。

```
private class GetUpdate extends AsyncTask<Void, Void, Void>
{

    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        Toast.makeText(getApplicationContext(), "Vérification de mise à jours", Toast.LENGTH_LONG).show();
    }

    @Override
    protected void onPostExecute(Void result) {

        /** For debug reference*/
        Toast.makeText(getApplicationContext(), "*" + isUpdatetxt + "*" + " " + (isUpdatetxt.length()), Toast.LENGTH_LONG).show(); 
        if(isUpdatetxt == "18"){
            alertDialog.show();
        }
    }

    @Override
    protected Void doInBackground(Void... params) {
        isUpdatetxt = DownloadText(updateURL);
        isUpdatetxt = isUpdatetxt.substring(1, 3);
        return null;
    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-09T01:17:53.793

如果你在 Java 中比较字符串，你应该使用 .equals()。

在 Java 中将字符串与 == 进行比较时，是在比较引用。

因此，您的 if 语句将类似于：

```
if(isUpdatetxt.equals("18")){
    alertDialog.show();
} 
```

# xcode4.3 - xcode 4.3.2 codeSense 问题

> ID：10508587
> 
> 赞同：1
> 
> 时间：2012-05-09T01:06:33.867
> 
> 标签：xcode4.3, codesense

我刚刚更新到 4.3.2，现在我每时每刻都在让 codeSense 睡在我身上。在编码期间，我从枚举中获得部分列表，类的部分属性或没有属性，通常没有语法突出显示，未声明的变量没有错误。

如果我构建项目，它会引发正确的警告/错误并正确链接所有内容。所以它实际上可以找出是否有问题，只是在我编写代码时似乎并没有努力去做。

现在很生气。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T01:13:57.817

我最近遇到了类似的问题，我结束了删除项目的派生数据并重新启动 Xcode。

在 Xcode 中进入 Organizer 并在 Projects 选项卡下从左侧选择您的项目，然后按 Derived Data 旁边的 delete。然后重新启动 xcode，希望您一切顺利。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T01:34:19.733

在我的 iOS 项目上使用一些 c++ 文件时我遇到了这个问题......非常讨厌

您可以像这样轻松修复它：

在您的项目上，转到“构建设置”

“构建选项”

"Compiler for c/c++/objective-c"" 从 Apple 更改`LLVM compiler 3.1`

至

`LLVM GCC 4.2` 建造

并将其再次更改为

> LLVM 编译器 3.1

再次构建

现在 codeSense 应该可以工作了！

PS。无需删除派生数据...

;)

# ruby-on-rails - ruby on rails: (eval):1: 语法错误，意外 $undefined

> ID：10508589
> 
> 赞同：2
> 
> 时间：2012-05-09T01:07:00.723
> 
> 标签：ruby-on-rails

我收到以下语法错误：

```
(eval):1: syntax error, unexpected $undefined
$#<MenuBuilder:0x007fccee84e7f8> = #<MENUBUILDER:0X007FCCEE84E7F8>
 ^ 
```

这是代码执行：

# _main_menu.html.haml

```
#main-menu 
  = menu do |m| 
    = m.submenu "Products" do 
      = m.item "Products", Product 
```

# builders_helper.rb

```
module BuildersHelper 
  def menu(options = {}, &block) 
    MenuBuilder.new(self).root(options, &block) 
  end 
end 
```

# menu_builder.rb

```
class MenuBuilder 
  attr_accessor :template 
  def initialize(template) 
    @template = template 
  end 
  def root(options, &block) 
    options[:class] = "jd_menu jd_menu_slate ui-corner-all" 
    content_tag :ul, capture(self, &block), options 
  end 
  def item(title, url, options = {}) 
    content_tag :li, options do 
      url = ajax_route(url) unless String === url 
      url = dash_path + url if url.starts_with?("#") 
      link_to title, url 
    end 
  end 
  def submenu(title, options = {}, &block) 
    content_tag :li do 
      content_tag(:h6, title.t) + 
      content_tag(:ul, capture(self, &block), :class => "ui-corner- 
all") 
    end 
  end 
end 
```

它在 root 方法中的 capture() 调用上失败：

```
content_tag :ul, capture(self, &block), options 
```

self 指的是 MenuBuilder 的实例，我很肯定一个块作为另一个参数传递。如果我在 if block_given 中抛出 puts 语句？它会执行，但不会通过上面的 content_tag 行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:51:29.940

问题似乎在于您使用[了`capture`helper method](http://api.rubyonrails.org/classes/ActionView/Helpers/CaptureHelper.html#method-i-capture)。

该方法接受视图代码块并将其分配给可在视图中其他地方使用的变量。

这里有更多信息：[http ://api.rubyonrails.org/classes/ActionView/Helpers/CaptureHelper.html#method-i-capture](http://api.rubyonrails.org/classes/ActionView/Helpers/CaptureHelper.html#method-i-capture)

您确定您实际上是在将一个块传递到执行捕获的代码中吗？

你可能会考虑这样的事情：

```
content_tag :li do 
  if block_given?
    content_tag(:h6, title.t) + 
    content_tag(:ul, capture(self, &block), :class => "ui-corner-all") 
  else
    content_tag(:h6, title.t) # whatever is appropriate if there's no block passed
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-17T22:05:21.197

好的，我刚遇到这个问题，我想我想出了如何解决它。问题很可能是引入到 ActiveRecord 中的错误，它们覆盖了 Kernel.capture。我发现解决方法是使用辅助模块的捕获而不是类级别的捕获。因此，在您正在调用的情况下，请`content_tag :ul, capture(self, &block), options`尝试调用，`content_tag :ul, @template.capture(self, &block), options`以便使用辅助模块的捕获方法而不是 AR 中的伪劣方法。

查看[这些](https://github.com/markevans/block_helpers/pull/4) [github](https://github.com/capistrano/capistrano/issues/168#issuecomment-4162727) [问题](https://github.com/rails/rails/commit/d4fa120671e989eecb71c14647dd2051d28de4a5#activesupport/lib/active_support/core_ext/kernel/reporting.rb)以获取更多信息。

# ios - 拆分视图中有两个两个条形控制器？

> ID：10508590
> 
> 赞同：0
> 
> 时间：2012-05-09T01:07:15.130
> 
> 标签：ios, uitabbarcontroller, uisplitviewcontroller

因此，我并排构建了一个自定义 iPad 拆分视图控制器和两个条形控制器。标签栏控制器似乎按预期工作，除了第二个标签栏控制器将视图扩展到标签栏和标签栏下方。这有效地切掉了视图的底部，并且第二个标签栏控制器中的视图报告的高度比第一个标签栏控制器高 50 磅。标签栏控制器上是否有要设置的属性，以便它不会拉伸标签栏下的视图？

# clojure - clojure：在 cond 中使用绑定仅将 recur 放在尾部位置？

> ID：10508591
> 
> 赞同：3
> 
> 时间：2012-05-09T01:07:26.393
> 
> 标签：clojure, functional-programming

我有一些代码目前给我一个错误，因为 recur 只能在尾部位置。这是功能：

```
(defmethod transposer
    Long [scale degree]
    (loop [new-scale scale count degree]
    (cond 
        (zero? count) new-scale 
        (< count 0) (recur (step (reverse new-scale)) (inc count)))
        :else (recur (step new-scale) (dec count)))) 
```

我认为解决此问题的一种方法是条件绑定，如果我可以说： *当计数小于零时，将计数运算符设置为“inc”，否则设置为“dec”，然后在最后重复。*

那么这将解决我的问题。但我不确定如何在 clojure 中执行此操作，或者是否可能，when-let 和 if-let 似乎没有执行此操作。将我的代码修复为仅使用一次重复的最佳方法是什么？

编辑：我在这里学到了几件事：

1) 如果没有循环语句，“recur”将返回到 defn。在我看的书中，所有recur的例子都使用了loop/recur，所以我认为有一个循环是很有必要的。不是，我的循环语句是多余的。

2）括号错误给了我一个令人困惑的错误，令我感到奇怪的是，两个 cond 语句都不会被认为是在尾部，因为它们是互斥的。我应该更多地关注我的paren完成检查器。

3）如果我确实想做条件绑定，我可以使用标准的“let”语句并在其中包含条件逻辑。来自 java 背景，我有时会忘记 clojure 在这方面所允许的灵活性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T01:20:27.903

```
(defn foo [scale degree]
  (loop [new-scale scale count degree]
    (cond 
      (zero? count) new-scale 
      (< count 0) (recur (step (reverse new-scale)) (inc count))
      :else (recur (step new-scale) (dec count))))) 
```

我认为更接近你想要的（它不会给出尾部错误；我使用 defn 只是为了独立测试）。

多个`recur`s-tail递归没有问题，并不意味着它必须在文本的最后一行，只是它返回时没有更多的计算可做。

主要问题是弄乱了括号（之后太多`count`）。我建议找一个自动缩进的编辑器（并且痴迷地使用自动缩进）。那会立即显示parens问题（我在intellij idea中使用la clojure插件，但我相信其他人也有类似的功能）。

更新：为什么`loop`需要？

```
(defn foo [scale degree]
  (cond 
    (zero? degree) scale 
    (< degree 0) (recur (step (reverse scale)) (inc degree))
    :else (recur (step scale) (dec degree)))) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T02:12:39.680

在您最初的问题中，您问“我认为解决此问题的一种方法是条件绑定，如果我可以说：当计数小于零时，将计数运算符设置为“inc”，否则设置为“dec”，然后重复在最后。” 没有人回答那部分：

```
(let [d (if (neg? degree) inc dec)]
  (recur (step scale) (d degree))) 
```

除了你想在一种情况下调用 reverse 而不是另一种情况，所以你也需要一个条件绑定。这是一个使用解构绑定的示例：

```
(let [[s d] (if (neg? degree) [reverse inc] [identity dec])]
  (recur (step (s scale)) (d degree))) 
```

尽管正如 Andrew Cooke 指出的那样，在每个“尾部”（并且没有循环）中使用 recur 的简单 cond 工作得很好。

# java - 一行代码看不懂|Multitouch|

> ID：10508592
> 
> 赞同：-1
> 
> 时间：2012-05-09T01:07:29.367
> 
> 标签：java, android, eclipse, location, multi-touch

```
 private void dealEvent(int actionPointerIndex, MotioEvent event,
  View eventView, int actionresolved) {

  int rawX, rawY;
  int location[] = { 0, 0 };

  eventView.getLocationOnScreen(location);
rawX = (int) event.getX(actionIndex) + location[0];
rawY = (int) event.getY(actionIndex) + location[1];

ArrayList<View> views = getTouchedViews(rawX, rawY, actionresolved); 
```

我不明白这些线，我们为什么要这样做？

```
rawX = (int) event.getX(actionIndex) + location[0];
rawY = (int) event.getY(actionIndex) + location[1];

ArrayList<View> views = getTouchedViews(rawX, rawY, actionresolved); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T01:13:53.140

这主要是假设，因为您提供的代码不太可编译（`MotioEvent`应该是`MotionEvent`并且您`actionPointerIndex`在函数声明和`actionIndex`主体中使用）。

基于[此链接](http://www.passsy.de/multitouch-for-all-views/)，其中一个功能是事件会自动转发到底层视图。

它看起来像来自`getX`并且`getY`相对于某个非原点的返回值（例如，捕获事件的对象的左上角）。

该`getLocationOnScreen`调用填充`location`该点，然后您使用它从相关坐标生成原始（可能是屏幕）坐标。

很可能，这是因为`getTouchedViews`需要原始坐标才能为您提供当时的视图列表。然后代码通过该列表来确定哪个视图应该接收事件。

# c# - 选择项目后更改组合框背景和前景

> ID：10508596
> 
> 赞同：0
> 
> 时间：2012-05-09T01:07:51.853
> 
> 标签：c#, wpf

我查看了本网站上提供的所有答案以找到我的问题的答案，但我找不到可行的解决方案。

我有一个使用 ItemsSource 属性绑定到类的组合框。

类定义如下：

```
public class DataSource
{
    public string DisplayField { get; set; }
    public string ValueField { get; set; }
} 
```

ComboBox 必须使用 DisplayMemberPath = "DisplayField" 和 SelectedValuePath = "ValueField" 来显示数据...这是在后面的代码中完成的，并在窗口加载时加载。

ComboBox 定义如下：

```
<ComboBox Grid.Row="0" Grid.Column="1" Margin="5 5 5 0" Name="releaseHoldDropDown" Width="100"/> 
```

如果下拉列表的值更改为“Release”，我需要一种将背景更改为绿色并将前景更改为白色的方法。

如果下拉列表的值更改为“保持”，我还需要将背景更改为红色，将前景更改为白色。

仅供参考：我正在使用 ExpressionLight.xaml 主题来设置整个应用程序的样式。

作为旁注，我还想要一种将我所有组合框的背景从灰色更改为白色的方法，以使它们更具可读性。所以我需要修改 ExpressionLight.xaml 但我不知道要编辑哪个部分来进行这些更改。

任何帮助将不胜感激。

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T06:53:33.653

为什么不使用 style.trigger？

```
 <ComboBox.Style>
            <Style TargetType="ComboBox">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="Foreground" Value="Black"/>
                <Style.Triggers>
                    <Trigger Property="SelectedValue" Value="Release">
                        <Setter Property="Background" Value="Green"/>
                        <Setter Property="Foreground" Value="White"/>
                    </Trigger>
                    <Trigger Property="SelectedValue" Value="Hold">
                        <Setter Property="Background" Value="Red"/>
                        <Setter Property="Foreground" Value="White"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
        </ComboBox.Style> 
```

这可能是你的开始

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T01:25:42.980

由于您只想更改前景色而不是背景色（保持白色），因此在`releaseHoldDropDown_SelectionChanged`事件中使用

```
private void releaseHoldDropDown_SelectionChanged(object sender, FooBar e)
{
   releaseHoldDropDown.ForeGround = new SolidColorBrush(Colors.White);

   DataSource ds = (DataSource)releaseHoldDropDown.SelectedItem;

   if (ds.DisplayField == "Release")
        releaseHoldDropDown.Background = new SolidColorBrush(Colors.Green);
   else if(ds.DisplayField == "Hold")
        releaseHoldDropDown.Background = new SolidColorBrush(Colors.Red);
} 
```

如果你能给我 ExpressionLight.xaml，我可以帮助你。那只有我能帮忙

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-30T00:25:49.050

您是否尝试更改模板控件的必要颜色，如下所示？

```
<ComboBox x:Name="comboBox"
            ItemsSource="{Binding Items}"
            Margin="0,0,0,10"
            Background="White">
    <ComboBox.ItemTemplate>
        <DataTemplate>
            <Grid Background="White">
                <TextBlock Foreground="Black" Text="{Binding Name}"/>
            </Grid>    
        </DataTemplate>
    </ComboBox.ItemTemplate>
</ComboBox> 
```

# windows - 在 VB6 中使用自定义 MouseIcon

> ID：10508599
> 
> 赞同：1
> 
> 时间：2012-05-09T01:08:23.160
> 
> 标签：windows, vb6, mouse-cursor

我在 VB6 中创建一个应用程序，我想使用我自己的光标。我为表单设置了正确的属性：

```
MousePointer: 99 - Custom
MouseIcon: "My Icon" 
```

其中“我的图标”是光标的文件。设置完所有属性后，我的自定义光标出现了，但是当我单击时，它不是指向光标的尖端，而是在光标的右下角。当我使用 Windows 附带的其中一个游标时，这不是问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T01:12:44.417

游标有一个在 .cur 文件中设置的“热点”：它定义了点击发生的位置。

您需要在您使用的任何 .cur 编辑器中设置热点。

# google-chrome-extension - addEventListener 适用于静态按钮，但不适用于动态生成的按钮

> ID：10508602
> 
> 赞同：0
> 
> 时间：2012-05-09T01:09:16.813
> 
> 标签：google-chrome-extension

我在 popup.html 中有一个按钮，就像这样。

```
<button id='test'>TEST BUTTON</button> 
```

然后我在一个单独的 js 文件中有这个函数和监听器。

```
function getAjax()
{
    chrome.tabs.executeScript(null, {code:"alert('works!')"});
}

document.addEventListener('DOMContentLoaded', function () {
    var buttons = document.querySelectorAll('button');
    for (var i = 0; i < buttons.length; i++) {
    buttons[i].addEventListener('click', getAjax);
  }
});` 
```

当我使用上面的按钮时，该函数被调用。现在，如果我动态生成按钮，如下所示：

```
var AJAXholder = document.getElementById("AJAXholder"); 
var button = document.createElement("button");
button.setAttribute("class", "app-buttons");                
button.setAttribute("id", ""+ objects[i].name +"");
button.setAttribute("name", ""+ objects[i].name +"");
    var buttonText = document.createTextNode(""+ objects[i].name +"");
    button.appendChild(buttonText);
AJAXholder.appendChild(button); 
```

这些按钮已正确创建，但无法触发相同的功能。我能做些什么让它发挥作用吗？

编辑：

我在制作新按钮时添加了一个新的事件侦听器，如下所示：

```
var newlistener = document.getElementById(""+ objects[i].name +"").addEventListener('click', getAjax); 
```

它似乎工作。无论如何都不介意学习更好的方法，否则我会在允许时投票删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T14:43:19.870

您的按钮生成代码是否包含在您的`DOMContentLoaded`侦听器函数中？如果不是，我的猜测是`DOMContentLoaded`在 JS 脚本运行以创建按钮之前触发，所以`querySelectorAll('button')`得到一个空列表，因为还没有按钮存在。`DOMContentLoaded`确保您的按钮创建脚本在您的侦听器函数之后（或者更好的是，在其中）按时间顺序运行。

# django - Django 表单向导 - 将请求传递给视图？

> ID：10508607
> 
> 赞同：4
> 
> 时间：2012-05-09T01:10:11.197
> 
> 标签：django, django-forms, django-formwizard

有没有办法访问`request`表单向导的 done() 方法中的变量？

```
class AddWizard(SessionWizardView):
    def done(self, form_list, **kwargs):
        if form_list[0].cleaned_data['ad_type'] == '1':
            ad_type = 'basic'
        else:
            ad_type = 'other'
        return render_to_response('business/done.html', {
            'form_data': ad_type,
            },
            context_instance = RequestContext(request)
        ) 
```

我想访问请求中的用户对象，但我不确定如何将请求传递给 done() 方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-09T01:53:27.937

是的。`SessionWizardView`扩展了基本泛型`View`，因此请求在`self.request`.

文档：[https ://docs.djangoproject.com/en/1.5/topics/class-based-views/generic-display/#dynamic-filtering](https://docs.djangoproject.com/en/1.5/topics/class-based-views/generic-display/#dynamic-filtering)

# iphone - 将 NSNumber 传递给 UInt32 时出错

> ID：10508609
> 
> 赞同：0
> 
> 时间：2012-05-09T01:10:19.437
> 
> 标签：iphone, ios, nsnumber, uint32

我试图将 NSNumber 传递给 UInt32 变量，它似乎可以工作，但是当我去记录 UInt32 的值时，我被卡住了。

这就是我的代码的样子。

```
if ([methodName isEqualToString:@"Manu"]) {
        cacheNumber = [cacheValue objectForKey:@"Manus"];

        NSLog(@"%@", cacheNumber); // This produces the correct number
    }

    UInt32 CACHE_VALUE = [cacheNumber intValue];
    NSLog(@"%@", CACHE_VALUE); // This is where my thread gets stuck 
```

这是当我尝试单步执行第二个 NSLog 时它产生的消息（因为我在两个日志上都有断点来检查它们的输出）。

> 单步执行直到从函数 objc_msgSend 退出，该函数没有行号信息。

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T01:12:21.003

你打印一个 NSString 而不是一个 UInt。

```
 NSLog(@"%lu", CACHE_VALUE); // This is where my thread gets stuck 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T01:13:58.447

当您记录一个整数而不是一个对象时，即。一个 NSString，你应该使用 %d（十进制）占位符而不是 %@（对象）。

```
NSLog(@"Value: %d", CACHE_VALUE); 
```

# c# - 关于 ConcurrentDictionary 使用的一些问题

> ID：10508620
> 
> 赞同：11
> 
> 时间：2012-05-09T01:12:00.820
> 
> 标签：c#, asp.net, multithreading, thread-safety, concurrentdictionary

我目前正在编写一个 C# 应用程序。我是使用 ConcurrentDictionary 的新手，所以对它的线程安全有一些疑问。首先，这是我的字典：

```
 /// <summary>
    /// A dictionary of all the tasks scheduled
    /// </summary>
    private ConcurrentDictionary<string, ITask> tasks; 
```

我在我的类中实例化它并使用它来跟踪我所有实现 ITask 的对象。我想确保我的设置能够在多线程环境中正常工作。

如果多个线程想要获取 ConcurrentDictionary 中的项数的计数，是否需要锁定它？

如果我想从字典中获取特定的键，获取该键的对象并调用它的方法，我需要锁定它吗？例如：

```
 /// <summary>
    /// Runs a specific task.
    /// </summary>
    /// <param name="name">Task name.</param>
    public void Run(string name)
    {
        lock (this.syncObject)
        {
            var task = this.tasks[name] as ITask;
            if (task != null)
            {
                task.Execute();
            }
        }
    } 
```

请记住，多个线程可以调用 Run 方法来调用 ITask 的 Execute 方法。我的目标是让所有东西都线程安全并尽可能高效。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-09T03:04:03.773

它们本身的方法和属性`ConcurrentDictionary`是完全线程安全的：

[http://msdn.microsoft.com/en-us/library/dd287191.aspx](http://msdn.microsoft.com/en-us/library/dd287191.aspx)

> 表示可由多个线程同时访问的键值对的线程安全集合。

这包括[Count](http://msdn.microsoft.com/en-us/library/dd287234.aspx)属性：

> Count 具有快照语义，表示访问 Count 时 ConcurrentDictionary 中的项目数。

**然而**，这并不**意味着**字典中保存的对象本身就是线程安全的。也就是说，没有什么可以阻止两个线程访问同一个`Task`对象并尝试在`Execute`其上运行该方法。如果您希望对该`Execute`方法的每个单独任务进行序列化（锁定）访问，那么我建议在内部有一个锁定对象`Task`并在运行时锁定`Execute`：

```
public class Task
{
    private object _locker = new object();

    public void Execute()
    {
        lock (_locker) {
           // code here
        }
    }
} 
```

这确保了至少每个单独的任务没有运行多个线程`Execute`。我猜这就是您从问题的上下文以及类和方法的名称中所追求的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T01:35:33.520

ConcurrentDictionary 的所有方法都可以安全地从多个线程中调用。

它不能保证程序的其他部分不需要同步，因为您可能需要使用锁来同时访问其他对象/多个对象。

即，您的示例代码确实为检索任务和执行任务而锁定。它显示了以原子方式访问多个对象的锁定示例。

旁注：您应该检查您的锁，`task.Execute()`因为它禁止其他线程并行执行任务。这可能是您想要实现的目标，但在这种情况下，使用 ConcurrentDictionary 可能是矫枉过正。

# python - 我的 pygame 精灵不会移动

> ID：10508623
> 
> 赞同：0
> 
> 时间：2012-05-09T01:12:25.247
> 
> 标签：python, pygame, sprite

我试图让一个精灵通过步行动画在屏幕上移动，它所要做的就是保持静止，但它仍然会通过动画。这是代码：

```
from pygame.locals import *
import pygame._view

pygame.init()
clock = pygame.time.Clock()

height = 500
width = 500
screen = pygame.display.set_mode((width, height), 0, 32)
pygame.display.set_caption('placeholder text')

photo = 'grassbackground.png'
background = pygame.image.load(photo).convert()

photo1 = 1

user = pygame.sprite.Sprite()

change = False

x, y = (0, 0)

up = False
down = False
left = False
right = False

speed = 3

while True:
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
        if event.type == KEYDOWN:
            if event.key == K_UP:
                up = True
                y += 1
                change = True
            if event.key == K_DOWN:
                down = True
                y -= 1
                change = True
            if event.key == K_LEFT:
                left = True
                x -= 1
                change = True
            if event.type == K_RIGHT:
                right = True
                x += 1
                change = True

        if event.type == KEYUP:
            if event.key == K_UP:
                up = False
                change = False
            if event.key == K_DOWN:
                down = False
                change = False
            if event.key == K_LEFT:
                left = False
                change = False
            if event.key == K_RIGHT:
                right = False
                change = False

if down and user.rect.bottom < height:
    user.rect.top += speed
if up and user.rect.top > 0:
    user.rect.top -= speed
if left and user.rect.left > 0:
    user.rect.left -= speed
if right and user.rect.right < width:
    user.rect.right += speed

if change == True:
    pygame.time.wait(110)
    photo1 += 1

if change == False:
    photo1 = 1

if photo1 == 1:
    user.image = pygame.image.load("1.png").convert()
    user.rect = user.image.get_rect()
    screen.blit(user.image, user.rect)

if photo1 == 2:
    user.image = pygame.image.load("2.png").convert()
    user.rect = user.image.get_rect()
    screen.blit(user.image, user.rect)

if photo1 == 3:
    user.image = pygame.image.load("3.png").convert()
    user.rect = user.image.get_rect()
    screen.blit(user.image, user.rect)

if photo1 >= 4:
    photo1 = 1

thesprites = pygame.sprite.RenderPlain((user))
thesprites.update()

screen.blit(background, (0, 0))
thesprites.draw(screen)

pygame.display.update()
clock.tick(60) 
```

（ps我不确定为什么我在那里有x和y坐标，我想我只是把它放在那里以防我决定使用它）我没有使用任何定义的类，并且不希望这样做。提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T01:24:44.533

我不能确定，因为您没有包含运行应用程序所需的图像文件。

我不能对帖子发表评论，因为我不够活跃，但看起来你在这里重新创建了 rect：

```
if photo1 == 1:
    user.image = pygame.image.load("1.png").convert()
    user.rect = user.image.get_rect()
    screen.blit(user.image, user.rect)

if photo1 == 2:
    user.image = pygame.image.load("2.png").convert()
    user.rect = user.image.get_rect()
    screen.blit(user.image, user.rect)

if photo1 == 3:
    user.image = pygame.image.load("3.png").convert()
    user.rect = user.image.get_rect()
    screen.blit(user.image, user.rect) 
```

即使您在上面调整了几行：

```
if down and user.rect.bottom < height:
    user.rect.top += speed
if up and user.rect.top > 0:
    user.rect.top -= speed
if left and user.rect.left > 0:
    user.rect.left -= speed
if right and user.rect.right < width:
    user.rect.right += speed 
```

您必须存储用于玩家位置的矩形，然后在创建新图像后将其重新应用于矩形。

除此之外，看看创建和使用函数，这里的代码可以从拥有它们中受益匪浅。在这里查看更多信息： [http ://www.penzilla.net/tutorials/python/functions/](http://www.penzilla.net/tutorials/python/functions/)

# javascript - 模块模式中的这个关键字？

> ID：10508628
> 
> 赞同：6
> 
> 时间：2012-05-09T01:12:51.643
> 
> 标签：javascript, design-patterns, global-object

我刚刚开始在一家新公司工作，并注意到他们的许多 JS 对我来说看起来完全错误。我有点犹豫是否要在没有确认这是错误的情况下提出它，因为我还很初级，我不是 JS 专家，这只是我的第二天，我不想看起来很愚蠢。

所以，通常我希望模块模式看起来像：

```
MODULENAME = MODULENAME || {};

MODULENAME.SUBMODULENAME = (function() {
    var bla = {};

    bla.somefunction = function() {
        //do stuff
    };

    //add more stuff to bla
    return bla;
}()); 
```

他们在代码中的全部内容是：

```
MODULENAME = MODULENAME || {};

MODULENAME.SUBMODULENAME = (function() {
    var that = this;

    that.somefunction = function() {
        //do stuff
    };

    //add more stuff to that
    return that;
}()); 
```

现在当然是因为该函数没有被作为带有`new`关键字或方法的构造函数调用，`this`所以绑定到`window`并且它们定义`that`为`this`. 所以他们基本上把所有东西都转储到了全局对象中，他们所有的子模块名称实际上都是`window`. 有人愿意这样做吗？或者这真的像我认为的那样错误吗？

**编辑：**

我在`var`子模块定义之前犯了一个错误，最初我写了一些稍微不同的东西，忘记删除`var`. 我也试图让这个例子更清楚一些，希望我现在的意思更明显。

**编辑2：**

此外，我查看了在 Firebug 中执行的脚本，它们肯定将所有内容添加到`window`，该对象完全是一团糟。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T01:18:30.763

是的，它看起来不对。

```
MODULENAME = MODULENAME || {}; // missing var

var MODULENAME.SUBMODULENAME = (function() { // probably the missing var from above...
    var that = this;
    //add some stuff to that
    return that; // that is the WINDOW- wrong.
}()); 
```

[**演示**](http://jsfiddle.net/gdoron/29GfH/1/)它可以造成的损害：

```
var x = function() {
    alert('out');
}
var MODULENAME = MODULENAME || {};

MODULENAME.SUBMODULENAME = (function() {
    var that = this;
    that.x = function() {
        alert('DAMAGE');
    }
}());

x();​ // alert DAMAGE and not "out" - messed up with the global object! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T03:04:26.193

模块模式的使用不正确，这也是为什么不应使用函数表达式的原因之一，因为它们的使用对函数声明没有任何帮助。如果目的是创建全局函数（我怀疑它是），那么他们应该使用：

```
function somefuncion() {
  ...
} 
```

如果他们的意图是向对象添加属性（在这种情况下为方法），这很可能是这种情况，那么：

```
MODULENAME.SUBMODULENAME.somemethod = function() { /* do stuff */ }; 
```

如果需要有条件地创建方法，例如基于特征检测，那么以下可能适合：

```
(function(global, undefined) {

  // In here global is the global object
  global.MODULENAME = global.MODULENAME || {};
  global.MODULENAME.SUBMODULENAME = global.MODULENAME.SUBMODULENAME || {};

  // and undefined is undefined, belt and braces approach
  undefined = void 0;

  // Direct assignment
  function somemethod() {
      //do stuff      
  };

  // Assign directly to the "namespace" object
  MODULENAME.SUBMODULENAME.somemethod = somemethod;

  // Conditional assignment
  if ( sometest ) {
    MODULENAME.SUBMODULENAME.anothermethod = function(){...};

  // Try another way...
  } else if (someOtherTest) {
    MODULENAME.SUBMODULENAME.anothermethod = function(){...};

  // Default
  } else {
    MODULENAME.SUBMODULENAME.anothermethod = function(){...};
  }

  // Clean up 
  global = null;

}(this)); 
```

上面的一个问题是，在外部函数内部声明的每个函数都有一个返回函数对象及其环境的闭包，因此有点浪费资源。保持简单并且只在真正需要的地方使用模块模式并在不需要的地方使用普通的函数声明和赋值会更有效。不那么时髦，但更实用。

# android - Android中Activity和Service之间的通信方式

> ID：10508635
> 
> 赞同：0
> 
> 时间：2012-05-09T01:13:56.793
> 
> 标签：android, sockets

新的 Android 程序员在这里。我有一个执行套接字管理和异步 I/O 的服务，我需要在它和我的应用程序中的 Activity 之间建立通信路径。

当前的方法是为服务和活动都配备广播接收器，并使用它们将“命令”意图从活动发送到服务，并将“警报”意图从服务发送到活动。

我的服务有一个可运行的，这是套接字 read() 发生的地方；当接收到数据时，runnable 会向 Service 发送一个“传入数据”意图，然后 Service 会向 Activity 发出警报：

```
 @Override
        public int onStartCommand(Intent intent, int flags, int startId) {
            super.onStartCommand(intent, flags, startId);
            if (m_IsRunning == false) {
                m_IsRunning = true;
                (new Thread(new Runnable() {
                    byte[] inputBuffer = new byte[512];
                    public void run() {
                        while (m_IsRunning) {
                            if (m_IsConnected) {
                                try {
                                    m_Nis = m_Socket.getInputStream();
                                    m_Nis.read(inputBuffer, 0, 512);
                                    Intent broadcast = new Intent();
                                    Bundle bun = new Bundle();
                                    bun.putString("ServiceCmd", "ALERT_INCOMING_DATA");
                                    bun.putByteArray("MsgBuffer", inputBuffer);
                                    broadcast.putExtras(bun);
                                    broadcast.setAction(BROADCAST_TO_SERVICE);
                                    sendBroadcast(broadcast);
                                } catch (IOException e) {
                                    // Send fault to activity
                                }
                            }
                        }
                    }
                })).start();
            }
            return START_STICKY;
        } 
```

我使用 BroadcastReceiver 的方法如下所示：

```
 private BroadcastReceiver serviceReceiver = new BroadcastReceiver() {
            @Override
            public void onReceive(Context context, Intent intent) {
                Bundle bun = intent.getExtras();
                String cmdString = bun.getString("ServiceCmd");

                if (cmdString.equals("CMD_SETHOSTINFO")) {
                    // The activity has requested us to set the host info
                    String hostAddr = bun.getString("HostAddressString");
                    int hostPort = bun.getInt("HostPortNumber");
                    processSetHostInfoCommand(hostAddr, hostPort);
                }
                else if (cmdString.equals("CMD_CONNECT")) {
                    // The activity has requested us to connect
                    if ((m_IsRunning) && (m_IsConnected == false)) {
                        // Attempt to connect
                        processConnectCommand();
                    }
                }
                else if (cmdString.equals("CMD_DISCONNECT")) {
                    // The activity has requested us to disconnect
                    if ((m_IsRunning) && (m_IsConnected == true)) {
                        // Attempt to disconnect
                        processDisconnectCommand();
                    }
                }
                else if (cmdString.equals("CMD_SENDDATA")) {
                    // The activity has requested us to send data
                    if ((m_IsRunning) && (m_IsConnected == true)) {
                        // Attempt to send data
                        byte[] msgBuffer = bun.getByteArray("MsgBuffer");
                        processSendDataCommand(msgBuffer);
                    }
                }
                else if (cmdString.equals("ALERT_INCOMING_DATA")) {
                    // Our TCP receiver thread has received data
                    if (m_IsRunning) {
                        byte[] msgBuffer = bun.getByteArray("MsgBuffer");
                        processIncomingDataAlert(msgBuffer);
                    }
                }
            }
        }; 
```

（这些`processWhatever()`方法一般都是做socket管理和数据传输。）

就像我说的，它似乎工作正常，但我想知道这是否不是使用消息和处理程序更合适的情况。

所以，具体的问题是：

1.  在决定何时使用 BroadcastReceiver/Intents 或 Handler/Messages 时，“Android 之道”是什么？

2.  在决定使用哪种方法时是否有任何跨线程考虑？

（而且，虽然它是题外话，最后一个问题）：

1.  服务是否适合做我正在尝试做的那种基于套接字的 I/O？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T04:06:07.027

**广播意图、意图和处理程序之道**

广播意图用于一对多的发布/订阅场景，其中一个组件想要让世界知道发生了什么事情，但不关心是否有任何人/有多少听众，或者他们当前是否正在运行。

常规意图用于一对一场景，其中一个组件希望代表它完成特定处理，但不关心/知道是否有特定组件能够执行此操作，或者该组件当前是否正在运行。

另一方面，处理程序用于一对一的同步/异步场景，其中双方都是众所周知的并且当前正在运行。

**以上内容与您的情况有何关系**

在最简单的实现中，您不需要意图或处理程序，您可以直接从后台 Runnable 调用服务上的方法，如下所示：

```
MyService.this.processIncomingDataAlert(inputBuffer); 
```

请注意，这将在后台线程上执行该方法，并在处理数据时阻塞套接字侦听器。这让我们了解了您询问的线程注意事项。

如果您想解除阻塞套接字侦听器，和/或处理 UI 线程上的数据，您可以在其中创建一个 Handler`onStartCommand()`并使用它从 runnable 将另一个 runnable 发布回 UI 线程，如下所示：

```
myServiceHandler.post(new Runnable() {
    public void run() {
        MyService.this.processIncomingDataAlert(inputBuffer);
    }
}; 
```

请注意，这将导致 UI 线程处理 Runnable 调用`onIncomingData`和可能更新的后台线程侦听器之间的竞争条件`inputBufffer`，因此您可能需要创建一个副本。

当然，现在还存在处理发生在 UI 线程上的问题，该线程在服务和活动之间共享。所以，如果你的数据处理速度很慢，它会影响你的 UI 的响应能力。

如果您想确保后台套接字侦听器和 UI 线程都响应，您应该在（但）另一个线程上处理您的数据。您可以为每个 Runnable 启动一个新线程，但这会导致快速创建一堆线程，并浪费系统资源。更不用说创建单独的线程会导致处理多个数据块之间的竞争条件，这会使您的应用程序逻辑过于复杂。

幸运的是，Android 提供`AsyncTask`了此类场景。

AsyncTask 有一个后台线程池，它运行通过它调度的 Runnables。如果你在 GingerBread 或更低版本上运行，或者在 ICS 或更高版本上运行，AsyncTask 也会将它们序列化并一次只运行一个任务。

阅读[这篇文章](http://www.vogella.com/articles/AndroidPerformance/article.html)以获得关于线程、处理程序和 AsyncTask 的精彩介绍。请注意，文章显示了一个使用子类化 AsyncTask 并实现的示例`doOnBackground`，但这对您来说有点矫枉过正；静态`execute(Runnable)`方法对您来说效果很好。

**服务是否适合您的场景**

这个问题与其他问题有些正交。你需要一个后台线程来监听套接字，这是给定的。但是你需要一个服务不是很清楚。

服务适用于应用程序需要做后台处理，不需要通过 UI 吸引用户，或者用户切换到另一个应用程序后继续处理的场景。

因此，如果您的场景要求您仅在您的活动显示在屏幕上并且用户积极参与其中时才侦听套接字，则您不需要服务。您可以从您的活动中启动后台线程，并使用处理程序将新数据发回给它或 AsyncTask，如上所述。

但是，如果您确实需要在用户关闭您的活动后继续侦听套接字（您是否应该是一个单独的主题:-)），您需要服务。

这里的主要问题是 Android 中的进程生命周期。为了正确管理设备资源，操作系统会杀死它认为空闲的进程。如果进程中没有任何活动或服务正在运行，则该进程被视为空闲。仅仅启动一个后台线程并不足以让操作系统知道该进程仍然很忙。因此，如果您没有服务，一旦您的活动关闭，从 Android 的角度来看，您的进程什么也不做，它可以杀死它。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T03:17:25.113

您实际上不必使用服务。如果它们都在同一个进程中运行，只需将您的网络代码设为单例，并让活动直接调用方法。对于通知，您可以简单地让活动实现某个接口（`onData(String data)`等）并让它们注册到网络类。只需注意在活动消失时取消注册 ( `onStop()`)。另一方面，如果网络代码需要在没有 UI 可见的情况下运行（例如，不同的应用程序在前台），则需要使用服务。

消息和意图实际上是不同的：您使用 handlers.messages 与特定线程进行通信，而意图实际上是 IPC——它们可以传递到不同的应用程序/进程。使用广播接收器的好处是，如果当前没有运行，Android 将创建一个进程来处理传入的意图。

不知道是不是“道”，但一般来说：

*   如果您需要在没有 UI 的情况下运行某些东西，请使用服务（计划的网络 IO 等）
*   如果存在 UI，只需让它在不同的主题中运行（`AscynTask`提供了一种方便的方法）
*   如果您正在与自己的应用程序通信（在单个进程中），请使用处理程序/消息
*   如果您需要跨应用（进程）通信，请使用意图
*   如果您需要处理一些异步事件，并且处理它的应用程序可能无法运行，请使用广播接收器。然后，如果需要一些时间，您可能想要启动一个服务（`IntentService`在工作线程中进行处理）来完成实际工作。此外，您可能需要获取唤醒锁以防止设备在您执行工作（网络 IO 等）时再次入睡

# c# - 刚接触 Windows 服务并有疑问

> ID：10508647
> 
> 赞同：0
> 
> 时间：2012-05-09T01:15:58.463
> 
> 标签：c#, exception-handling, windows-services, spring.net

我目前正在编写一个 Windows 服务，通常习惯于用 C# 编写 Web 应用程序。因此，我有一些问题，更有经验的 Windows 服务程序员可能能够回答。

通常如何在 Windows 服务中处理异常、记录到事件查看器、文本文件等？

通常，当我编写 Web 应用程序时，我会使用带有自定义操作的安装程序来安装它。我可以为 Windows 服务创建相同的并以类似方式安装它吗？

最后，任何人都有关于如何将 spring.net 依赖注入连接到 Windows 服务的经验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T01:46:12.453

可恢复错误和不可恢复错误之间存在巨大差距。你可以克服可恢复的，但你不能做不可恢复的。因此，对于不可恢复的错误，我建议您坚持错误并关闭您的服务。对于可恢复的，您可以继续执行循环。[此答案](https://stackoverflow.com/questions/3156288/exception-handling-best-practice-in-a-windows-service)中有更多信息。要将某些内容记录到事件日志中，请使用 BCL 库中的 EventLog 类。[MSDN](http://msdn.microsoft.com/en-us/library/system.diagnostics.eventlog%28v=vs.110%29.aspx)中有关它的更多详细信息

是的，您可以为 Windows 服务制作安装程序。实现几乎相同。我建议在不生产时寻找安装的工具是[installutil](http://msdn.microsoft.com/en-us/library/50614e95%28v=vs.110%29.aspx)

我将 Windows 服务与 AutoFac 容器集成。您必须在启动后实例化和配置您的容器。不幸的是，我没有任何 Spring 特定的经验，所以如果您的问题是关于某些细节的，我对此一无所知。但是，如果它是关于 DI 容器集成的一般性问题。以防万一：服务启动有时间限制。

# php - php apache 权限 - 最佳实践

> ID：10508648
> 
> 赞同：3
> 
> 时间：2012-05-09T01:16:17.970
> 
> 标签：php, linux, apache, codeigniter

我有一个使用 php 创建文件夹的 codeigniter 应用程序。通过 php 创建的任何文件夹的所有者都是“apache”，但是如果我想通过 ftp 上传文件夹，则所有者是我的 ftp 用户名。

我遇到了一个问题，php（apache）由于权限而无法修改通过 ftp 上传的文件夹中的文件。与此同时，我已将我的 ftpuser 添加到 apache 组并将 apache 添加到 ftpuser 组，但想知道是否有更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T01:25:46.447

一般来说，我所做的是 chgrp 任何目录 php 将写入 apache 运行组（我的服务器上的 www，可能是你的服务器上的 apache）， chmod g+s 。这将使在该目录中创建的任何文件也归 Web 服务器组所有。如果默认的 umask 允许组写入，这将解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T01:27:38.380

最佳实践是只允许用户读/写他们应该读/写的文件。

在我的网络应用程序中，我有一个网站数据目录，用于存储我从应用程序动态生成的所有数据。

然后我只允许应用程序写入该目录，而不是其他任何内容。

# android - onLocationChanged() 没有被调用

> ID：10508650
> 
> 赞同：0
> 
> 时间：2012-05-09T01:16:44.563
> 
> 标签：android

我正在创建一个从 NETWORK 获取位置的小部件。但`onLocationChanged()`没有被调用但`locMgr.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, this);`被执行

每次都会创建新的小部件实例，因此使用了静态。

```
public class MyWidget extends AppWidgetProvider implements LocationListener {
    private static LocationManager locMgr;
    private static List<String> providers;
    private static String bestProvider;
    private static Double  lat , longt; 

  public void onEnabled(Context context) {
    super.onEnabled(context);

    if(locMgr == null)  {       //Get LocationManager
        locMgr = (LocationManager)context.getSystemService(Context.LOCATION_SERVICE);
        getLocations();
    }    

  }

 public void getLocations() {
    //List All providers
    providers = locMgr.getAllProviders();

    //Get criteria
    Criteria criteria = new Criteria();
    criteria.setAccuracy(Criteria.ACCURACY_FINE);

    //Get best provider
    bestProvider = locMgr.getBestProvider(criteria, false);       

    //Get Last known location
    //String locationProvider = LocationManager.GPS_PROVIDER;
    try {
        Location l = locMgr.getLastKnownLocation(bestProvider);
        getNewLocation(); 
    }catch(Exception e) {
        e.printStackTrace();
        System.out.println("error1");
    }

}

private boolean getNewLocation() {
    System.out.println("aaa");
    if(locMgr.isProviderEnabled(LocationManager.NETWORK_PROVIDER)) {                //This is executed since it can get locations faster than gps (is executed only if use wireless networks for locations is selected)  
        System.out.println("bbb");
            locMgr.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, this);
            return true;                
    }else {                             
        return false;
    }      
}

public void onLocationChanged(Location lc) {
    System.out.println("ccc");
    if(lc!=null) {
            lat = lc.getLatitude();
            longt = lc.getLongitude();             
            System.out.println(lat + "xxx " + longt);
            //unregister the locationlistener once we get the locations
            locMgr.removeUpdates(this);
    }else {

    }

}
} 
```

# node.js - 调用 Mongoose document.save() 似乎没有保存？

> ID：10508657
> 
> 赞同：0
> 
> 时间：2012-05-09T01:17:41.347
> 
> 标签：node.js, mongoose

我正在尝试将对象保存到我的数据库中；我知道数据库处于活动状态，因为我已经通过用于更新它的同一连接读取了对象。

```
saveAndReturnQuiz = (res, quiz) ->
  quiz.save (err) ->
    # At some point, started seeing empty object for err, rather than null
    if not _.isEmpty err
      switch err?.code
        when 11000
          sendError res, "Quiz title must be unique"
        else
          console.error "Unexpected error on save(): %j", err
          sendError res, extractError err

      return

    console.log "Sending Quiz response: %j", quiz

    res.send quiz 
```

我看到的是对 save() 的调用失败，但传递了一个空的 err 对象。

这是我的架构：

```
# Defines the schema of data
# Exports three Mongoose Model objects: Question, Round, and Quiz

mongoose = require "mongoose"

Schema = mongoose.Schema

Question = new Schema
  kind:
    type: String
    enum: [ "text" ]
  text:
    type: String
    required: true
  answer:
    type: String
    required: true
  value: Number
  { strict: true }

Round = new Schema
  kind:
    type: String
    required: true
    enum: ["normal", "challenge", "wager"]
  title:
    type: String
    required: true
  questions: [Question]
  { strict: true }

Quiz = new Schema
  title:
    type: String
    required: true
    unique: true
  created:
    type: Date
    default: -> new Date()
  location: String
  rounds: [Round]
  { strict: true }

module.exports =
  Question: mongoose.model('Question', Question)
  Round: mongoose.model('Round', Round)
  Quiz: mongoose.model('Quiz', Quiz) 
```

所以也许我只是错误地处理了这些嵌入元素？

有趣的是，我可以将新的 Quiz 对象添加到数据库中，而不是更新现有的对象：

```
 app.post "/api/quiz",
    (req, res) ->
      quiz = new Quiz req.body
      saveAndReturnQuiz res, quiz

  # Update an existing Quiz
  app.put "/api/quiz/:id",
    (req, res) ->
      Quiz.findById req.params.id,
        handleError res, (quiz) ->
          _.extend quiz, req.body
          console.log "Ready to save: %j", quiz
          saveAndReturnQuiz res, quiz 
```

进一步更新：当模型没有嵌套元素时，更新似乎可以正常工作。只是当有嵌套元素（回合，回合内，问题）时，事情才会失败。

我怀疑在设置架构时缺少一些东西，但我不确定接下来要检查什么。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T17:52:11.947

我相信我已经解决了这个问题；我保存的特定测验实体是我直接从 mongo shell 修改的：

```
> db.quizzes.find( {title: "NFJS" }).pretty()
{
  "_id" : ObjectId("4f835669c34c2a9c6f000003"),
  "created" : ISODate("2012-04-09T21:36:41.726Z"),
  "location" : "San Antonio",
  "rounds" : [
    {
      "_id" : ObjectId("4f835669c34c2a9c6f000004"),
      "kind" : "normal",
      "questions" : [
        {
          "kind" : "text",
          "answer" : "My Answer",
          "value" : 10,
          "text" : "My Question"
        }
      ],
      "title" : "Server-Side Java and JavaScript"
    },
    {
      "kind" : "normal",
      "title" : "Underscore / Bootstrap Trivia",
      "_id" : ObjectId("4fa317319b19aca4c900004c"),
      "questions" : [ ]
    }
  ],
  "title" : "NFJS"
} 
```

我相信没有 _id 属性的嵌入式 Question 实体是问题所在。通过我的 UI 创建一个包含回合和问题的新测验，以便每个实体都有其 _id，似乎工作正常！

# ios - 如何在 iOS 中从另一个应用程序编辑文本

> ID：10508661
> 
> 赞同：3
> 
> 时间：2012-05-09T01:18:14.380
> 
> 标签：ios, lua

我正在编写一个应用程序，其中包含一组嵌入式 lua 脚本。我希望能够在 iPad 上编辑脚本——这可能吗？

我想到的工作流程是：

1.  启动我的应用程序并进行测试；
2.  转到我在 iPad 上的文本编辑器并更改 lua 脚本；
3.  关闭我的应用程序；
4.  重新启动我的应用程序以重新加载脚本；
5.  转到 1。

编辑：我可以将“打开方式”选项添加到我的应用程序并根据[这个问题](https://stackoverflow.com/questions/3981199/adding-open-in-option-to-ios-app)打开文本文件，但是，一旦我这样做了，文本编辑器是否会将文件保存回它的来源？还是只使用副本？这假设我可以找到一个可以打开 lua 文件的文本编辑器，我想在某个地方有一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T09:39:40.687

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T02:15:52.250

如果你越狱你的 iPad 并安装 OpenSSH，你可以做这一切，甚至更多。

我使用 Moai 进行开发，[这是 Double Fine 最近采用的用于在 Lua 中编写游戏的 SDK](http://getmoai.com/)。我可以使用我选择的编辑器 (Vim) 通过与 localhost 的 SSH 会话（使用 Prompt，一个 iOS SSH 客户端）直接在 iPad 上编码。我映射了一个重新启动应用程序的热键。使用蓝牙键盘，它就像 iPad 成为笔记本电脑一样接近。

您还可以使用 ExpandDrive 之类的东西将 iPad 的文件系统映射到您的桌面文件系统。然后，您可以浏览文件并对其进行编辑，就好像它们在您的台式机上一样，完全无线。您可以在编辑器中映射一个密钥以通过 SSH 重新启动您的应用程序，因此工作流程变为：

1.  编辑 Lua 脚本
2.  点击键重新启动您的应用程序并查看更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T03:33:30.017

在没有越狱的情况下，您无法在 iOS 中从一个应用程序的 sanbox 访问其他应用程序的 sanbox。

# jquery - 在 cakephp 中，我的 jquery $.ajax() 调用在明确告知这样做时不会调用来自另一个控制器的操作

> ID：10508663
> 
> 赞同：0
> 
> 时间：2012-05-09T01:18:22.300
> 
> 标签：jquery, ajax, cakephp

在尝试了三天后，我将其发布在 stackoverflow 上。

我的 cakephp 应用程序中有一个消息控制器和一个链接控制器。我无法弄清楚为什么 $.ajax() 会从消息控制器中调用正确的操作，但似乎甚至没有尝试转到 ajax 调用指定的操作。

这将起作用并且实际上会在我的消息控制器中调用我的添加操作：

```
 $('#add_message').click( function () {
        $.ajax({
            url: "/messages/add",
            type: "POST",
            dataType: "html",
            data: {
                text: $('#message_text').val(),
                group_id: $('#group_id').val()                  
            },
            success: function(data, textStatus, jqXHR) {
                $('#message_list').prepend(
                        $(jqXHR.responseText).hide().fadeIn('slow')
                );
                $('#message_text').val("");

            }   
        }); 
```

下面的代码甚至没有转到由 ajax 调用指定的正确 url（'/links/add' 对应于链接控制器的添加操作），而是使用呈现当前视图的 url（在本例中为 /messages/指数）。提交时会显示一个 jqueryui 对话框用于用户数据输入，它会提示“成功”，因此正在触发该功能。

我使用 chrome 开发人员工具检查了它从未尝试调用 url /links/add 的标头。

```
$( "#dialog-add_group_link" ).dialog({
            autoOpen: false,
            height: 300,
            width: 350,
            modal: true,
            buttons: {
                "Add Link": function() {
                    $.ajax({
                        type: "POST",
                        Url: "/links/add/",
                        data: {
                            tags: $('#link_tags').val(),
                            text: $('#text').val(),
                            href: $('#href').val(),
                            group_id: $('#group_id').val()
                        },  
                        success: function() {
                            alert('success');
                        }
                    });
                    $( this ).dialog('close');
                },
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function() {

            }
        }); 
```

有什么我遗漏的东西告诉它使用不同的 URL 吗？我不确定为什么这不会调用 /links/add 操作，我已经尝试将链接设为绝对链接，所以这不是问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T01:19:38.727

该`url`字段必须为小写

# git - 如何比较 GIT 中不同提交中的特定文件？

> ID：10508668
> 
> 赞同：2
> 
> 时间：2012-05-09T01:18:48.300
> 
> 标签：git, compare, commit

有时我需要查看不同提交中特定文件的更改。有什么简单的方法可以做到这一点，而无需重置和签出文件并重命名为另一个临时文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T01:21:08.853

试试，例如

```
git diff 278d8..1cf1d www/index.html 
```

两个十六进制代码中的每一个都是标识提交的 SHA1 哈希的唯一前缀。

使用 浏览差异有时也很有帮助`gitk`，但这仅显示相邻提交之间的差异。

# javascript - 如果移动设备告诉 html doc 不要加载 js

> ID：10508669
> 
> 赞同：15
> 
> 时间：2012-05-09T01:18:49.693
> 
> 标签：javascript, media-queries

我在这里厚颜无耻地寻找一两行代码：

有人可以提供代码放置在 html 文档的头部，说明如果移动设备则不加载 JS？

这与以下 CSS 媒体查询结合使用：

```
<link rel="stylesheet" type="text/css" media="only screen and (max-device-width: 480px)" href="m/styles_mobile.css" /> 
```

所以我正在寻找一段基于相同规则的代码： media="only screen and (max-device-width: 480px)"

将不胜感激

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-09T01:46:52.550

给定：“如果移动设备**则不加载 JS** ”，并假设“移动设备”由宽度为 480 像素或更小的屏幕定义，那么类似以下的内容应该可以工作：

```
<script>
if (screen && screen.width > 480) {
  document.write('<script type="text/javascript" src="foo.js"><\/script>');
}
</script> 
```

仅当屏幕宽度大于 480 像素时才会添加脚本元素。

OP中的CSS规则是：

```
<... media="only screen and (max-device-width: 480px)" ...> 
```

这将针对 480 像素或更小的屏幕，这与第一条语句相反。因此更改`>`为`<=`脚本是否应该在小屏幕上运行而不是在大屏幕上运行。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-13T01:20:27.703

我不确定以前的答案如何与视网膜显示器一起使用。我会做类似的事情：

```
if( /Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent))
 document.write('<script type="text/javascript" src="foo.js"><\/script>'); 
```

[从这里](https://stackoverflow.com/questions/3514784/best-way-to-detect-handheld-device-in-jquery)摘录

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-12-23T11:41:39.183

现在可以使用`window.matchMedia`

```
if (window.matchMedia("(min-width: 480px)").matches) {
  document.write('<script type="text/javascript" src="foo.js"><\/script>');
} 
```

[https://developer.mozilla.org/docs/Web/API/Window/matchMedia](https://developer.mozilla.org/docs/Web/API/Window/matchMedia) [http://caniuse.com/#feat=matchmedia](http://caniuse.com/#feat=matchmedia)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-09T01:46:57.413

你可以这样做。

1.  测试屏幕宽高，看是否是移动设备。
2.  使用 JavaScript 加载脚本。

你可以做的是：

```
var scripts = ["foo.js",       //Put all your scripts here.
               "bar.js"];

if(screen.width <= 480){
    for(var i=0;i<scripts.length;i++){
              //-with jQuery (one line!)-
        $("head").append('<script type="text/javascript" src="'+scripts[i]+'"><\/script>');
                 //-or jQuery free-
        var scriptEle = document.createElement("script");
        scriptEle.setAttribute("type","text/javascript");
        scriptEle.setAttribute("src",scripts[i]);
        document.getElementsByTagName("head")[0].appendElement(scriptEle);
    }
} 
```

注意它是`screen.width <= 480`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-05-01T18:25:30.750

最好的方法是将它添加到“foo.js”文件中的整个实际移动脚本周围。如果您突然附加标签，DOM 将无法加载它。

```
if (screen && screen.width > 480) {
 // Whole your script here
} 
```

代替：

```
if (screen && screen.width > 480) {
  document.write('<script type="text/javascript" src="foo.js"><\/script>');
} 
```

# php - 从 cmd 行程序 (rtmpdump.exe) 捕获 PHP exec() 输出的替代方法

> ID：10508676
> 
> 赞同：2
> 
> 时间：2012-05-09T01:20:00.510
> 
> 标签：php, cmd, rtmp

过去我曾多次使用 exec() 函数从命令行可执行文件中捕获信息，并打算使用 RTMPDump.exe 再次执行此操作。PHP 代码如下，可与我过去使用过的任何其他命令行示例一起使用，但在这种情况下，不会对 $output 产生任何影响：

```
 $cmd = 'c:\rtmpdump\rtmpdump -r "rtmp://fms.domain.com/live/live_800"';
    exec($cmd, $output);
    foreach ($output as $item){
        // do something with this $item
    } 
```

我已经尝试通过将 Windows 命令行放在 .bat 文件中并运行它，其中 ase $output 然后只包含在 bat 文件中回显的内容，但不包含下面显示的输出，这是当我从命令行手动运行命令。

```
C:\rtmpdump>rtmpdump -r "rtmp://fms.domain.com/live/live_800"
RTMPDump v2.3
(c) 2010 Andrej Stepanchuk, Howard Chu, The Flvstreamer Team; license: GPL
Connecting ...
INFO: Connected...
ERROR: rtmp server sent error
Starting Live Stream
For duration: 2.000 sec
INFO: Metadata:
INFO:   author
INFO:   copyright
INFO:   description
INFO:   keywords
INFO:   rating
INFO:   title
INFO:   presetname            Custom
INFO:   creationdate          Tue May 08 03:00:23 2012
INFO:   videodevice           Osprey-440 Video Device 1B
INFO:   framerate             25.00
INFO:   width                 480.00
INFO:   height                360.00
INFO:   videocodecid          avc1
INFO:   videodatarate         800.00
INFO:   avclevel              30.00
INFO:   avcprofile            66.00
INFO:   videokeyframe_frequency10.00
INFO:   audiodevice           Osprey-440 Audio Device 1B
INFO:   audiosamplerate       22050.00
INFO:   audiochannels         1.00
INFO:   audioinputvolume      75.00
INFO:   audiocodecid          mp4a
INFO:   audiodatarate         48.00
#######
Download complete

C:\rtmpdump>rtmpdump 
```

程序确实运行，这不是问题，有一个显示视频数据转储的输出文件，所以可执行文件的语法不是问题 - 问题是是否有任何其他方法可以拦截 rtmpdump.exe 输出的内容命令窗口，不是通过 exec() 从 PHP 运行它来捕获的。

如果它很重要，那就是我有兴趣使用的“INFO：...”。我正在尝试确定实时视频流是否正在流式传输。服务器正在运行，但我需要知道特定流（live_800）是否正在流式传输。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T20:34:58.283

感谢 JohnF 让我走上了正确的道路，如果其他新手需要完成此操作，我使用**proc_open**进行如下操作：

```
$descriptorspec = array(
0 => array("pipe", "r"),    // stdin is a pipe that the child will read from
1 => array("pipe", "w"),    // stdout is a pipe that the child will write to
2 => array("pipe", "w")     // stderr is a pipe that the child will write to
);
$cmd = c:\rtmpdump\rtmpdump -r "rtmp://fms.domain.com/live/live_800 -B 1 -m 3";
$process = proc_open($cmd, $descriptorspec, $pipes);
if (is_resource($process)) {
    $stdin = stream_get_contents($pipes[0]);
    $stdout = stream_get_contents($pipes[1]);
    $stderr = stream_get_contents($pipes[2]);
    fclose($pipes[0]);  fclose($pipes[1]);  fclose($pipes[2]);
    // It is important that you close any pipes before calling proc_close in order to avoid a deadlock
    $return_value = proc_close($process);   
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T01:37:05.487

试试[直通](http://cz2.php.net/manual/en/function.passthru.php)功能。

# javascript - 同一页面上有 2 个 jquery 函数的问题

> ID：10508678
> 
> 赞同：-2
> 
> 时间：2012-05-09T01:20:28.317
> 
> 标签：javascript, jquery, html, css

我不知道如何使用 javascript，但我遇到了一个问题，我在主页上有一个滑块并且我有一个弹出功能。问题是每次我打开弹出窗口时，幻灯片图像都会随着弹出窗口打开并覆盖它。这就是我有 [http://jsfiddle.net/kD4ZB/](http://jsfiddle.net/kD4ZB/) 单击联系时出现的问题。非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T01:25:24.817

这似乎与 jQuery 无关，而与 CSS 的 z-index 有关。尝试编辑弹出窗口以具有更高的 z-index 或将滑块的 z-index 设置为较小。z-index 可以被认为是“与屏幕的距离”，其中 0（从技术上讲是 -1）在屏幕上，而 100（有时是 1,000）在用户身上。如果 A 的 z-index 为 10，B 的 z-index 为 11，则 B 将掩盖 A。

# c - GENERIC_ALL 和文件夹/文件 ACL？GENERIC_ALL 到底是做什么的？

> ID：10508679
> 
> 赞同：6
> 
> 时间：2012-05-09T01:20:36.590
> 
> 标签：c, windows, file-io, createfile

我最近重新设计了我们的文件服务器上的安全性，将完全控制的大部分内容都标记为要修改。现在我的开发人员告诉我，每当他们使用 GENERIC_ALL 打开文件（`CreateFile()`例如）时，他们都会收到拒绝访问的消息。

经过研究，似乎没有任何迹象表明这`GENERIC_ALL`只是`GENERIC_EXECUTE`++ ；但是，情况似乎并非如此，因为开发人员能够将三个常量值相加，并将其用于.`GENERIC_WRITE``GENERIC_READ``CreateFile()`

所以，我问......`GENERIC_ALL`真正的作用是什么？

谢谢，

马特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T01:28:33.950

`GENERIC_ALL`访问权限包括*所有*可能的访问权限，包括`WRITE_DAC`（更改权限）和`WRITE_OWNER`（更改所有者）等。[文件安全和访问权限](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364399%28v=vs.85%29.aspx)页面显示访问权限如何映射到文件的`GENERIC_*`特定访问权限。[File Access Rights Constants](http://msdn.microsoft.com/en-us/library/windows/desktop/gg258116%28v=vs.85%29.aspx)页面显示了文件的所有可能访问权限（可能在使用时都会被请求`GENERIC_ALL`）。

您应该鼓励您的开发人员仅请求他们实际需要的访问级别。例如，很少会同时打开一个`GENERIC_EXECUTE`文件`GENERIC_WRITE`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T01:28:27.157

`GENERIC_ALL`表示“所有可能的访问级别”（对于文件，它的名称为`FILE_ALL_ACCESS`）。由于您删除了完全控制，因此打开的尝试`GENERIC_ALL`将失败并显示拒绝访问，因为（例如）`WRITE_DAC`不再被授予。

# java - 在 JSP 中通过 servlet 检索网页

> ID：10508683
> 
> 赞同：0
> 
> 时间：2012-05-09T01:21:20.707
> 
> 标签：java, jsp, servlets

如何通过从 JSP 页面作为表单参数传递的 Servlet 检索网页？

JSP 页面有一个带有文本框的表单，用于输入作为字符串的 url 和一个提交按钮。该操作由 servlet 执行，该 servlet 从传递的 url 获取网页并显示检索到的网页。

这里我有我的 servlet 代码`

```
 import java.io.IOException;
    import java.io.InputStream;
    import java.io.PrintWriter;
    import java.net.MalformedURLException;
    import java.net.URL;
    import java.net.URLConnection;

    import javax.servlet.ServletException;
    import javax.servlet.annotation.WebServlet;
    import javax.servlet.http.HttpServlet;
    import javax.servlet.http.HttpServletRequest;
    import javax.servlet.http.HttpServletResponse;

    /**
    * Servlet implementation class Search
    */
    @WebServlet("/Search")
    public class Search extends HttpServlet {
private static final long serialVersionUID = 1L;

    /**
    * @see HttpServlet#HttpServlet()
    */
     public Search() {
    super();
    // TODO Auto-generated constructor stub
    }

/**
 * @param  
 * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
 */
 protected void doGet(HttpServletRequest request, HttpServletResponse response)            throws ServletException, IOException {
    String html = null;

    String server = request.getParameter("browsebox");
    if(server != null && server !="")
        {

            response.sendRedirect("browse.jsp");

        }

        try {
            html = getWebPageFromUrl(server);

        }catch(Exception e) {
            System.err.println(e.toString());
            return;

        }
        response.setHeader("serchbox", server);
        response.setContentType("text/html");

        PrintWriter out = response.getWriter();

        if(html == null) {
            out.println("<html>");
            out.println("<head><title>Refresher</title></head>");
            out.println("<body bgcolor=\"#ffffff\">");
            out.println("<p>The servlet has received a POST. This is the reply.    </p>");
            out.println("</body></html>");
        } else {

            out.print(html);
        }
    }

/**
 * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
 */
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    // TODO Auto-generated method stub
    doGet(request,response);
}

private String getWebPageFromUrl(String urlString) throws Exception {

    // Create a URL object from urlString
    URL stockURL;

    try {
        stockURL = new URL(urlString);
        } catch (MalformedURLException e) {

            String msg = "Invalid url: " + urlString;
            throw new Exception(msg);
            }

    // Open a connection to the URL
    URLConnection stockConnection;

    try {
        stockConnection = stockURL.openConnection();
        } catch (IOException e) {

            String msg = "Can't open connection to " + urlString;
            throw new Exception(msg);
            }

    // Get the InputStream from the URL connection
    InputStream webPageInputStream;

    try {
        webPageInputStream = stockConnection.getInputStream();
        } catch (IOException e) {

            // Could be any server error, but the most likely is 404
            String msg = "404 File Not Found: " + urlString;
            //throw new WebPageGrabberException(msg);
            throw new Exception(e.toString());
            }

    // Read the web page via the InputStream

    StringBuffer webPageData = new StringBuffer(32000);
    int totalBytesRead = 0;
    boolean moreToRead = true;
    byte[] readBuf = new byte[4096]; // Read the web page in 4K chunks

    while (moreToRead) {

        int numBytesRead = 0;

        try {
            numBytesRead = webPageInputStream.read(readBuf);
            } catch (IOException e) {

                moreToRead = false;
                numBytesRead = -1;
                }

        if (numBytesRead > 0) {

            totalBytesRead += numBytesRead;
            webPageData.append(new String(readBuf, 0, numBytesRead));
            } else {
                moreToRead = false;
                }

        }

    try {
        webPageInputStream.close();

        } catch (IOException e) {

        // Ignore any exception that might occur
            }

    webPageData.setLength(totalBytesRead);
     webPageData.toString();
}
} 
```

提交表单时，我从 servlet 得到空白。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T02:13:09.230

如果您需要完整显示该站点，只需重定向到它。

```
response.sendRedirect(request.getParameter("url")); 
```

如果您需要显示嵌入在 JSP 页面中的站点，请使用 iframe。

```
<iframe src="${fn:escapeXml(param.url)}"></iframe> 
```

*（[JSTL](https://stackoverflow.com/tags/jstl/info) `fn:escapeXml()`只是为了防止可能的 XSS 攻击）*

无论哪种情况，您可能只想预先验证 URL 是否以 http:// 或 https:// 等开头。

# sql - Sql Server WHERE IN 与 CASE

> ID：10508684
> 
> 赞同：2
> 
> 时间：2012-05-09T01:21:32.287
> 
> 标签：sql, sql-server-2008, where-clause

我们如何在 WHERE 子句中指定 CASE 的值范围？
我的这个查询失败了

```
declare @ProductType int

select * from Products 
where ProductLine in 
(
    case @ProductType
        when 1 then ('TVs')
        when 2 then ('Handsets', 'Mobiles') --fails here
        else ('Books')
    end
) 
```

这也行不通：

```
declare @ProductType int

select * from Products 
where (case @ProductType 
             when 1 then (ProductLine = 'TVs')
             when 2 then (ProductLine in  ('Handsets', 'Mobiles'))
             else (ProductLine = 'Books')
       end) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-09T01:24:49.607

您不能这样做 - 您需要将其拆分为多个检查：

```
WHERE (ProductLine = 'TVs' AND @ProductType = 1)
   OR (ProductLine IN ('Handsets', 'Mobiles') AND @ProductType = 2)
   OR (ProductLine = 'Books' AND @ProductType NOT IN (1, 2)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T01:27:00.987

```
declare @ProductType int

select * from Products 
where (case @ProductType 
             when 1 then ProductLine in ('TVs') 
             when 2 then ProductLine in  ('Handsets', 'Mobiles') 
             else ProductLine in ('Books') end) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T07:07:50.493

您可以采用两种方法。我的第一个选择是使用子查询或公用表表达式来反转逻辑并返回产品类型，然后匹配产品类型。第二个是使用“sp_executesql”。

第一个选项：

```
declare @ProductType int

WITH cte (Product_key, ProductType) AS (
    SELECT Product_key, CASE WHEN ProductLine IN ('TVs') THEN 1
        WHEN ProductLine IN ('Handsets', 'Mobiles') THEN 2  
        ELSE 3 END FROM Products
)
select p.* from Products p, cte 
where p.product_key = cte.product_key AND cte.ProductType = @ProductType 
```

第二种选择：

```
declare @ProductType int, @sql NVARCHAR(MAX)

SET @sql = 'select * from Products 
    where ProductLine in (' +
        case @ProductType
            when 1 then '''TVs'''
            when 2 then '''Handsets'', ''Mobiles'''
            else '''Books'''
        end + ')'
EXEC sp_executesql @sql 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T03:29:40.800

`CASE`是一个返回值的表达式。 `IN`是一个可能是查询一部分的子句。SQL Server 只勉强支持布尔数据类型。

您可以这样组合它们：

```
declare @ProductType int = 1
declare @Products as Table ( ProductLine VarChar(16) )
insert into @Products ( ProductLine ) values ( 'TVs' ), ( 'Books' )
select *
  from @Products  
  where
    case @ProductType 
      when 1 then ( select 1 where ProductLine in ('TVs') )
      when 2 then ( select 1 where ProductLine in ('Handsets', 'Mobiles') )
      else ( select 1 where ProductLine in ('Books') )
      end is not NULL 
```

# c++ - 用于打印 0.0、1.0、0.025 的 C/C++ 单一格式说明符

> ID：10508691
> 
> 赞同：1
> 
> 时间：2012-05-09T01:22:50.567
> 
> 标签：c++, c, floating-point, format-specifiers

什么单一格式字符串可用于打印 0.0, 1.0, 0.025 ？例如给定：

```
float vals[3] = { 0.0f, 1f, 0.025f };

for(int i=0; i < 3; i++)
    printf("%g\n", vals[i]); 
```

所需的输出：

```
0.0
1.0
0.025 
```

而是得到：

```
0
1
0.025 
```

尝试了各种宽度说明符和 %f vs %g 但无法得到我想要的。

如果有一个 c++ 替代方案就可以了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T01:34:15.577

您可以使用 setprecision(int n)，其中 n 是要输出的小数位数。除非您使用固定符号，否则不会显示任何尾随零

```
#include <iostream>
#include <iomanip>

float vals[3] = { 0.0f, 1.0f, 0.025f };
std::cout << setprecision(5);
for(int i=0; i < 3; i++)
std::cout << vals[i]; 
```

输出

```
0.0
1.0
0.025 
```

将以下内容更改为固定符号

```
cout << setprecision(5) << fixed; 
```

输出

```
0.00000
1.00000
0.02500 
```

编辑：还有科学记数法，你可以弄清楚它的作用。setprecision() ---> std::setprecision()

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T01:34:41.730

您可以在打印时指定浮点数和双精度数的小数位后的精度。这是通过格式说明符完成的，例如： %.Nf 其中 N 是一个正整数。因此，如果您使用：

```
printf("%.3f\n", vals[i]); 
```

你的输出是：

```
0.000
1.000
0.025 
```

但是你不能让它完全按照你声明的方式打印。您必须在循环的不同阶段更改精度（前 2 次迭代为 %.1f，最后一次迭代为 %.3f）。printf 有很多选项，包括前导空格：

[http://pubs.opengroup.org/onlinepubs/009695399/functions/printf.html](http://pubs.opengroup.org/onlinepubs/009695399/functions/printf.html)

编辑：

因此，如果您想按照评论中的说明打印至少 1 个小数位，您可以为该情况添加一个明确的检查：

```
#include <math.h>
#include <stdio.h>

int 
main(int argc, char *argv[]) {
  float vals[3] = { 0.0f, 1.0f, 0.025f };

  for(int i=0; i < 3; i++) {
    if( fmod(vals[i],1) == 0) printf("%.1f\n", vals[i]);
    else printf("%f\n", vals[i]);
  }

  return 1;
} 
```

输出：

```
0.0
1.0
0.025000 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T01:50:55.127

您可以使用 * 告诉 printf 精度将来自 int 参数值。

```
printf("%.*f\n", (vals[i] == (int)vals[i]) ? 1 : 3 ,vals[i]); 
```

应该打印：

```
0.0
1.0
0.025 
```

# ios - 加速框架 FFT vDSPztoc 拆分实数形式以拆分实数向量

> ID：10508692
> 
> 赞同：2
> 
> 时间：2012-05-09T01:23:20.927
> 
> 标签：ios, signal-processing, fft, accelerate-framework

我正在使用 Accelerate 框架在 iOS 中实现基于加速度计的 FFT，但我仍然有点困惑的是这部分：

```
/* The output signal is now in a split real form.  Use the  function
 * vDSP_ztoc to get a split real vector. */
 vDSP_ztoc(&A, 1, (COMPLEX *) obtainedReal, 2, nOver2); 
```

最终的数组是什么样的？我对“拆分实数形式”和“拆分实数向量”之间的区别感到困惑。我可能对它的含义有所了解，但我想确定我的想法是正确的。

起始数据，一个双精度数组，表示加速度等输入数据，通过 vDSP_ctoz 被放入奇偶形式。那么结果就是这种形式（复制自 Apple 的 vDSP 指南）：

```
{[DC,0],C[1],C[2],...,C[n/2],[NY,0],Cc[n/2],...,Cc[2],Cc[1]}

 where
 1\. DC and NY are the dc and nyquist components (real valued),
 2\. C is complex in a split representation,
 3\. Cc is the complex conjugate of C in a split representation.

For an n size real array A, the complex results require 2n
 spaces.  In order to fit the 2n size result into an n size  input and
 since the complex conjugates are duplicate information, the  real
 FFT produces its results as follows:
   {[DC,NY],C[1],C[2],...,C[n/2]} 
```

在我的实现中（有效，我只是对输出感到困惑），我还调用了 vDSP_ztoc。它应该有这个调用，还是只在示例中完成，因为他们想要恢复数组以匹配原始数组（因为他们做了反向变换）？

如果你应该这样称呼它，那么 vDSP_ztoc 之后的最终形式是什么？是吗：

```
 {[DC,NY],C[1],C[2],...,C[n/2]} 
```

或者输出数组中的第一个元素是 DC，第二个是第一个 bin 的实部，第三个是第一个 bin 的虚部，等等？或者第二个元素是否像该设置中的奈奎斯特频率，使第三个和第四个元素成为第一个 bin 的实部和虚部？

有点不清楚，但我想这个问题非常简单，我所需要的只是快速确认/更正。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:45:57.420

所以最终形式 {C[0],C[1],C[2],...,C[n/2]} 是正确的。

每个 bin 的频率是，如其他类似线程中所述，F = Fs/N 其中 Fs 是采样频率，N 是输入数组中元素的总数。你最终得到 N/2 个复数（一半实数一半虚数）。

# java - 如何从 SQLite 添加到我的列表

> ID：10508697
> 
> 赞同：0
> 
> 时间：2012-05-09T01:24:38.187
> 
> 标签：java, android, sqlite, list

我的应用程序将接收 SMS，将其保存在 SQLite 中，然后将其显示在我的列表中。其余的都完成了，但我无法将数据放入我的列表中；我怎样才能做到这一点？

这是我正在尝试的：

```
list.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(AdapterView<?> arg0, View view,
                int position, long index) {
            // here send Recent case Object  OR or Recent case info.  to show case information

        }
    }); 
```

这是我的适配器：

```
 public class RecentCaseListAdapter extends BaseAdapter {
private RecentCases myPage;
static public List<RecentCaseClass> listOfCases;

RecentCaseClass entry;

public RecentCaseListAdapter(RecentCases R, List<RecentCaseClass> listOfCaseParameter) {
    this.myPage = R;
    this.listOfCases = listOfCaseParameter;

}

public int getCount() {
    return listOfCases.size();
}

public Object getItem(int position) {
    return listOfCases.get(position);
}

public long getItemId(int position) {
    return position;
}

public View getView(int position, View convertView, ViewGroup viewGroup) {

     entry = listOfCases.get(position);

     if (convertView == null) {

        LayoutInflater inflater = (LayoutInflater) myPage.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        convertView = inflater.inflate(R.layout.recent_cases_row, null);
      }

    // this is row items..
    // Set the onClick Listener on this button

    TextView tvCase = (TextView) convertView.findViewById(R.id.tvrecentName);
    tvCase.setText(entry.getName());
    TextView tvCaseInfo = (TextView) convertView.findViewById(R.id.recent_info);
    tvCaseInfo.setText(entry.getAge());

    // To be a clickable button

    return convertView;
}

public void add(RecentCaseClass rCaseClass) {
    // TODO Auto-generated method stub
    listOfCases.add(rCaseClass);
}

} 
```

这是我的清单

```
 public static List<RecentCaseClass> RecentCaseList = new ArrayList<RecentCaseClass>();

public static List<RecentCaseClass> getRecentCaseList() {
    return RecentCaseList;
}

public static void setRecentCaseList(List<RecentCaseClass> recentCaseList) {
    RecentCaseList = recentCaseList;
} 
```

在这里我应该添加到列表中

```
if (SMSReceived.startsWith("Hi")) {
            Toast.makeText(context, "Iam in hi", Toast.LENGTH_LONG)
                    .show();

            msg = SMSReceived;

            RecentCaseClass rCase = run();
            dbAdapter.add(rCase);

            All_Static.RecentCaseList.add(recent1);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T01:49:17.810

我仍然不太确定你在问什么，所以我不知道这是否有帮助。我认为您想大致执行以下操作：

1）通过查询要放入列表中的数据来创建一个 android.database.Cursor 对象 2）使用要显示的查询中的列创建一个字符串数组。例如`String[] from_list = new String[] { "title", "case" }`

3) 创建一个 int 数组，其中包含要填写的列表行中的 TextViews 的 id。例如`int[] to_list = new int[] {R.id.title, R.id.case}`

4）创建一个 SimpleCursorAdapter 将光标映射到您的列表：

```
SimpleCursorAdapter mAdapter = new SimpleCursorAdapter (this, R.layout.list_row, mCursor, from_list, to_list); 
```

5) `setListAdapter(mAdapter);

这有帮助吗？

# ruby - 跟踪项目列表，即使项目来来去去：红宝石

> ID：10508699
> 
> 赞同：0
> 
> 时间：2012-05-09T01:24:46.240
> 
> 标签：ruby

假设我有一个项目哈希，并且我还保留了最大键的数量。

```
L = {1=>"item1", 2=>"item2", 3=>"item3"}, hi = 3

```

然后我删除了 1 条目

```
L = {2=>"item2", 3=>"item3"}, hi = 3

```

现在我想添加另一个项目，但想重新使用已删除的密钥。
如何重新设计它以优化确定哪个是第一个可用密钥所需的时间？

我总是可以从 1 循环到`hi`并返回第一个可用的键，但即便如此，也许有一种快速的方法来编写它，而不是手动调用循环并进行比较？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T01:52:13.237

嗯，有一种比使用显式循环更惯用的 Ruby 方法来编写它。像这样的东西：

```
first_available = ( 1 .. hi+1 ).find { |k| !L.include? k } 
```

但逻辑是一样的。除非您使用另一个变量来跟踪最小可用密钥，否则您无法真正避免类似的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T02:05:40.377

没有真正的方法可以避免一对一，只能减少您必须通过的数字数量。

例如，如果您将最小的可用数字保留在一个单独的变量中，那么在添加之后，您所要做的就是检查从您刚刚使用的键开始的下一个最小值。

在性能方面，除非您的散列将包含几百万个键，否则您不必担心必须按顺序查看每个键。即使散列中有 100 万个键，您也可以在不到 1 秒的时间内连续找到最小值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T02:08:50.623

例如，您可以对 Hash 进行子类化或修补，并跟踪最低可用数字（以及最高获取数字或您想要的任何其他数字）。类似的东西

```
class MyHash < Hash
  # override
  def delete k
    @min_available ||= 0
    @min_available = k if k < @min_available
    # or you can have an array here to keep track of all freed slots
    #   if you want to sacrifice some memory for speed in this situation

    super k
  end

  def get_first_available
    # use @min_available to serve this request
  end
end 
```

但是话又说回来，如果你认为你需要优化某些东西，你最好有数字来支持这个决定（提示：**profile 和 measure**）。

# extjs - 如何在 ExtPascal 中获取字符串的文本宽度

> ID：10508715
> 
> 赞同：2
> 
> 时间：2012-05-09T01:27:22.780
> 
> 标签：extjs, pascal, lazarus, text-width

我正在尝试使用 Lazarus 中的 ExtPascal 库（围绕 ExtJS 的包装器）定位按钮（TExtButton）。我想根据按钮的文本和字体设置按钮的宽度。我尝试了 GetWidth 和 JSExpression 以及 ExtUtilTextMetrics 的各种组合，但返回的答案类似于 -420,000。

我无法使用这样的调用来更改字体可能是相关的：

```
JSCode('style:{"font-size":"'+ FontSize +'px","font-family":"Tahoma"}'); 
```

但我能得到的唯一效果是，如果我将字体设置得足够大，按钮会更高，但按钮的文本会以原始的小字体呈现。

因此，我使用以下表达式将样式放入传递给按钮的 Text 属性的字符串中：

`result := '<b style="font-size:1.4em;font-family=sans-serif;color:rgb(14,63,138);">' + s + '</b>'`

谁能帮我计算出确切的文本宽度？

TIA 标志

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T17:19:16.227

起初，我不知道 ExtPascal 和 Lazarus。

我相信解决方案非常简单。只能使用 JavaScript 来完成。

步骤： 1\. 创建一个隐藏的div。

当你需要一些文本的宽度时， 1\. 设置隐藏div的文本、fontSize和fontFamily。2\. 将隐藏的 div 设置为可见 3\. 获取 div 的宽度。4\. 将 div 设置回隐藏。

在代码中：

```
<html>
<head>
    <script>
        function getWidth(text, fontSize, fontFamily) 
        {
            var element = document.getElementById('ruler');

            element.style.fontSize = fontSize;
            element.style.fontFamily = fontFamily;
            element.style.display = "inline";
            element.innerHTML = text;

            var width = element.offsetWidth;
            document.getElementById('width').innerHTML = width;
        }
    </script>
    <style>
        div#ruler
        {
            display : none;
        }
    </style>
</head>
<body onload="getWidth('Test', '13', 'Verdana');">
    <div id="ruler"></div>
    <div id="width"></div>
</body>
</html> 
```

ExtJs 也可以，但这是获取文本宽度的最简单方法。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-09T04:47:38.093

在 ExtJS 中使用一个有用的[TestMetrics](http://docs-devel.sencha.com/extjs/4.1.0/#!/api/Ext.util.TextMetrics)类，如下所示：

```
var textWidth = 
  Ext.util.TextMetrics.measure(
    extTextfield.getEl().dom, 
    text).
  width; 
```

# c# - C# 控制台应用程序 - 变量中的常量零值

> ID：10508716
> 
> 赞同：1
> 
> 时间：2012-05-09T01:27:26.300
> 
> 标签：c#, return

我几乎让我的小控制台应用程序工作了，唯一的问题是变量`totalComm`的值一直为 0。

我尝试了一切，我可能只是忽略了一个可以解决问题的小修复。

提前致谢

菲利普

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace CommissionCalculator
{
 class Program
  {
    public static void Main()
    {
        double total;
        double comm = 0;
        double totalComm = 0;
        string name = "";

        string inputLetter = "";
        int whilecount = 0;           

        while (inputLetter != "z")
        {
            if (whilecount == 0)
            {
                Title();
                whilecount = whilecount + 1;
            }

            getNameSales(out inputLetter, out name, out total, comm, totalComm);

            calcComm(total, out comm);

            outputVar(name, total, comm);

            totalCommCalc(comm, totalComm);
        }
    }

    public static void Title()
    {
        Console.WriteLine("\n           Sunshine Hot Tubs \n        Sales Commissions Report\n");
    }

    public static void getNameSales(out string inputLetter, out string name, out double total, double comm, double totalComm)
    {
        name = "";
        inputLetter = "";
        total = 0;

        Console.WriteLine("\nEnter salespersons initial a,b or e or enter z to quit");

        inputLetter = Console.ReadLine();

            if (inputLetter == "a")
            {
                name = "Andrea";

                string inValue;
                double sale = 0;
                total = 0;

                for (int count = 1; count <= 3; ++count)
                {
                    Console.WriteLine("Please enter sale: ");
                    inValue = Console.ReadLine();
                    sale = Convert.ToDouble(inValue);

                    total = total + sale;
                }
            }
            else if (inputLetter == "b")
            {
                name = "Brittany";

                string inValue;
                double sale = 0;
                total = 0;

                for (int count = 1; count <= 3; ++count)
                {
                    Console.WriteLine("Please enter sale: ");
                    inValue = Console.ReadLine();
                    sale = Convert.ToDouble(inValue);

                    total = total + sale;
                }
            }
            else if (inputLetter == "e")
            {
                name = "Eric";

                string inValue;
                double sale = 0;
                total = 0;

                for (int count = 1; count <= 3; ++count)
                {
                    Console.WriteLine("Please enter sale: ");
                    inValue = Console.ReadLine();
                    sale = Convert.ToDouble(inValue);

                    total = total + sale;
                }
            }
            else if (inputLetter == "z")
            {
                totalCommCalc(comm, totalComm);

                Console.WriteLine("Total commssion paid: {0:C}", totalComm);

                Console.ReadKey();
            }
        }

    public static void calcComm(double total, out double comm)
    {
        comm = total * 0.2;
    }

    public static double totalCommCalc(double comm, double totalComm)
    {            
        totalComm = totalComm + comm;

        return totalComm;
    }

    public static void outputVar(string name, double total, double comm)        
    { 
        Console.WriteLine("\n Name\t       Total sales\t     Commission \n{0}     \t    {1}     \t      {2}", name, total, comm);            
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T01:32:52.350

totalComm 按*值*传递给 totalCommCalc。要么通过*引用*传递它，要么从 totalCommCalc 返回它并分配回 totalComm。

当一个变量通过值传递时，一个*副本*被放置在您调用的方法的堆栈上。对该副本的更改不会影响原件。

当您通过*引用*传递时，原始地址被放置在堆栈上，并且更改*确实*会影响原始地址。

选项1：

```
// Passed by reference.
// Changes affect original.  
// Has side effects.  See http://en.wikipedia.org/wiki/Side_effect_%28computer_science%29
totalCommCalc(comm, ref totalComm); 
```

选项 2：

```
// Preferred.  Passed by value.  
// Result is assigned to a variable.  
// No side effects.
totalComm = totalCommCalc(comm, totalComm); 
```

我更喜欢第二种形式，因为随着代码的增长，具有[副作用](http://en.wikipedia.org/wiki/Side_effect_%28computer_science%29)的代码可能更难理解和维护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T01:32:43.293

对“totalCommCalc”的调用应该存储返回值或使用 out 关键字，就像其他方法一样。为了与您的其他方法保持一致，我将使用 out 并删除返回值。

```
 totalCommCalc(comm, out totalComm); 
```

或者

```
totalComm = totalCommCalc(comm, totalComm) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T01:34:01.153

您是`totalComm`按*值*传递，而不是按*引用*传递。如果您希望更改`totalComm`保持不变，请将其设为`ref`参数，或者在适当的情况下从函数中*返回*值。

通过引用传递：

```
....
getNameSales(out inputLetter, out name, out total, comm, ref totalComm);
....

public static void getNameSales(out string inputLetter, out string name, out double total, double comm, ref double totalComm) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T01:34:12.367

不要使用`ref`（根据@Eric J：随着代码的增长，具有[副作用的](http://en.wikipedia.org/wiki/Side_effect_%28computer_science%29)代码可能更难理解和维护）

只需更改一行，即为您的变量分配函数返回值。

```
totalComm = totalCommCalc(comm, totalComm); 
```

就是这样。

# .net - 检测服务卸载

> ID：10508717
> 
> 赞同：-1
> 
> 时间：2012-05-09T01:27:26.353
> 
> 标签：.net, vbscript, windows-installer, installshield

我已经通过 installshield 安装了 windows 服务，当我转到控制面板时，我可以看到我的 windows 服务，但是当我右键单击该服务时，我可以看到一个卸载选项，当我卸载时，我的代码会删除该服务。

> 无论如何我可以在代码中检测到用户为此服务单击了“卸载”吗？

在 installshield/通过 vbscript？

我可以检测用户是否单击了控制面板中特定 Windows 服务的卸载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T02:04:28.020

Installer 类有一个[OnBeforeUninstall](http://msdn.microsoft.com/en-us/library/system.configuration.install.installer.onbeforeuninstall.aspx)（和 OnAfter）方法。您如何使用它的细节取决于您的安装构建器。

假设您使用的是 VS 内置服务安装程序，您基本上[创建了一个类](http://www.devx.com/dotnet/Article/20849/0/)并将其注册到 Setup 包中。

# delphi - 获取另一个进程的过程/函数地址

> ID：10508725
> 
> 赞同：3
> 
> 时间：2012-05-09T01:28:44.660
> 
> 标签：delphi, function, getprocaddress

我正在编写一个显示所有打开进程的线程列表的程序。

使用类似的程序（Process Explorer），我可以看到线程列表，其中包含一些信息，如线程 ID、优先级、起始地址等。

我也可以检索所有这些信息，但 Process Explorer 显示的起始地址如下：

```
ModuleName!ProcedureName+$1111 
```

如何在`ProcedureName`不注入 dll 的情况下使用 GetProcAddress？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-09T01:57:41.280

您可以使用作为[`StackWalk64`](http://msdn.microsoft.com/en-us/library/ms680650.aspx)DbgHelp 一部分的 WinAPi 函数[，](http://msdn.microsoft.com/en-us/library/ms679291.aspx)如果您想了解如何使用此函数的 delphi 示例，请尝试[asmprofiler](http://code.google.com/p/asmprofiler/)项目。

# facebook-graph-api - 代表页面发布自定义 facebook 操作

> ID：10508726
> 
> 赞同：0
> 
> 时间：2012-05-09T01:28:51.027
> 
> 标签：facebook-graph-api, post, get, custom-action, facebook-page

我正在尝试代表我通过具有 manage_pages 权限的应用程序管理的 Facebook 页面发布操作。我可以通过以下表格的图表发布操作：

```
<pageID>/<appNameSpace>:<actionName>?<objectName>=<objectURL> 
```

但是，如果我随后通过以下调用查询应用程序以获取已发布的操作：

```
<pageID><appNameSpace>:<actionName>?access_token=<PageAccessToekn> 
```

我收到以下错误：

```
{
  "error": {
    "message": "An unknown error has occurred.",
    "type": "OAuthException",
    "code": 1
   }
} 
```

更新：

如果我尝试使用以下 URL 发布：

```
<pageID>/<appNameSpace>:<actionName>?<objectName>=<objectURL>&access_token=<pageToken> 
```

如果出现以下错误：

```
{"error":{"message":"(#100) The Action Type <appNameSpace>:<actionName> is not approved, so app <appID> can only publish to administrators, developers, and testers of the app.  User <pageID> is not one of those roles.","type":"OAuthException","code":100}} 
```

我试图代表发布的页面由应用管理员管理。我在 facebook 开发者应用程序的角色部分看不到任何地方可以将 facebook 页面添加为管理员。有什么可以测试的吗？是否可以代表页面发布自定义操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T04:36:01.697

根据您发布的错误消息，您的自定义操作尚未被 Facebook 批准供公众使用。据我所知，页面无法添加到测试用户（包括管理员和开发人员）列表中，因此您可能需要先让 Facebook 批准您的自定义操作，然后再继续。

[您可以在https://developers.facebook.com/docs/opengraph/opengraph-approval/](https://developers.facebook.com/docs/opengraph/opengraph-approval/)阅读有关批准流程的更多信息。他们的批准概述如下：

> 由于 Open Graph 让您只需进行一次 API 调用即可将您的应用程序直接集成到 Facebook 体验的所有部分中，因此在您的应用程序可以向所有用户发布 Open Graph 操作之前，我们将引入一个轻量级的审核和批准流程。
> 
> 这个过程很简单。一旦您的应用开始使用 Open Graph，所有 Open Graph 活动将立即对您应用的开发人员和测试人员可见。这使您可以对集成进行端到端测试。完成后，通过 Dev App 提交您的操作以供审核​​。在我们确认您对 Open Graph 的使用符合我们的标准后，我们​​将批准您的应用向所有 Facebook 用户发布您的 Open Graph 操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T22:25:11.993

是的，您需要在发布到开放图之前让您的开放图操作获得批准。有关更多详细信息，请参阅[https://developers.facebook.com/docs/opengraph/opengraph-approval/](https://developers.facebook.com/docs/opengraph/opengraph-approval/)。另外，我会在发布之前检查您是否具有 publish_actions 权限，因为用户可以在授权应用程序后随时删除此权限。在您获得开放图表操作批准后，您当然可以对其进行编辑，但您必须重新提交操作以供批准，然后实时用户才能看到这些更改。这个过程比第一次批准需要更长的时间，所以我会先把要求整理好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T10:01:28.057

将操作发布到页面、事件、组或作为页面、事件、组发布是不可能的，也不可能将操作发布到朋友的时间线 - 只有用户可以发布操作，并且只能发布到他们自己的时间线。

请参阅文档的[Open Graph Mechanics](https://developers.facebook.com/docs/opengraph/keyconcepts/#mechanics)部分，它显示**用户**对**对象**执行**操作**。你想要做的是让页面采取行动 - 这是不支持的

# node.js - 关于使用 websockets 和 node.js 编写可扩展的实时回合制策略游戏的建议

> ID：10508728
> 
> 赞同：3
> 
> 时间：2012-05-09T01:29:44.330
> 
> 标签：node.js, websocket, real-time

我打算使用 websockets 在 node.js 上编写一个实时回合制策略游戏服务器。我将迎合具有良好 html5 支持的现代浏览器，并且不太关心向后兼容性。

所提供的游戏将由少数玩家（例如 2-10 人）一次玩/观察，并且将具有在国际象棋中使用的时钟计时器，并在 www.chess.com 上实现。定时游戏最多持续一个小时，还可以选择玩非定时游戏。

服务器将负责玩家的评分、玩家的好友列表，以及管理正在运行/已完成的游戏状态，以及运行游戏时钟。游戏状态只是一点点 json，每场游戏最多只有几千字节。

一个限制是**所有**实际的游戏逻辑都**必须**发生在客户端上，而不是我的服务器上。因此，我需要一种机制，如果客户端发出非法移动信号，无论是因为它或其对手出现故障/恶意，那么一个或多个不相关的客户端或客户端（即使用我的网站的其他人）将把游戏状态加载到他们的浏览器在后台，争议将在那里解决。

这大概总结了我的要求。

这不是一个玩具项目，我希望有很多用户，所以我想提前考虑后端架构和可扩展性。我一般对node.js或网站部署不是特别了解，所以任何关于架构、技术/库、可扩展性/代理/负载平衡、如何实现时钟和处理延迟问题的建议或见解，在哪里/如何存储游戏状态等，非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T03:25:34.193

Node.js 和它的流行库在编写时考虑到了可扩展性，所以……像 express、mongodb/redis、socket.io 这样的通用工具就可以了。

关于客户端逻辑：

> 一个或多个不相关的客户（即使用我的网站的其他人）将在后台将游戏状态加载到他们的浏览器中，争议将在那里解决。

node.js 的一大优点是它与浏览器中的 javascript 相同。:) 所以你可以在你的服务器上运行**相同的代码**并在那里解决任何争议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T03:26:46.457

任何项目的第一件事都是整理一份技术要求清单。这是基于您在帖子中所写内容的示例：

1.  “服务器将处理[...]” - 您帖子中的项目列表表明您需要某种用户登录身份验证机制。
2.  “玩家的评分，玩家的朋友列表” - 这些需要存储在某种数据库中。
3.  “管理正在运行/已完成的游戏状态，运行游戏时钟” - 连接玩家之间的实时数据处理到正在运行的会话。
4.  如果您计划存储匹配结果，则需要将实时应用程序与数据库存储接口。
5.  “所有实际的游戏逻辑都必须在客户端上进行” - 你见过[Browser Quest](http://browserquest.mozilla.org/)吗？游戏的巨大问题是所有用户信息都存储在客户端上。要获得所有游戏特权，您只需手动编辑 localStorage。我唯一能想到的解决方法是将整个游戏逻辑编码到浏览器中，然后在每个连接的客户端上验证每个动作。但这会产生一个问题，用户可以修改逻辑来对应该合法的举动提出异议。

当您有一个明确定义的项目技术要求列表时，找到您正在寻找的库应该会容易得多。例如，socket.io 是一个处理 Web 套接字的优秀库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T19:37:11.407

游戏代码“不受信任”有什么原因吗？您需要做的就是验证 JSON 输入并且该移动不违反任何规则。在不了解更多细节的情况下，我不确定我能否就如何解决客户之间的纠纷提出建议，但我看不出游戏代码不可信的原因。

这个问题实际上听起来类似于[我读过的一篇关于分布式碰撞检测和解决的论文](http://gram.cs.mcgill.ca/theses/chen-10-distributed.pdf)，它减少了服务器网络压力。这是通过让所有“客户”对可预测的未来状态进行投票来实现的，每个客户都直接参与其中。如果没有争吵，则达成协议，然后游戏继续进行。如果发生争执，无法达成协议，则行动将中止。

它还为投票是否“及时”完成提供了一些有趣的想法（鉴于您的游戏是回合制的，您可能不必处理这种情况）。

您不必在无法达到碰撞时中止移动，而是必须编写一些逻辑来确定移动是否有效。这是很难回答您的问题的地方，因为您似乎无法信任除了服务器（甚至无法信任游戏代码本身）之外的任何东西。

我认为，为了可靠地解决这个问题，您可能必须采用您现有的想法之一：在服务器上启动沙盒游戏，询问不相关的客户端（这可能不可靠），或删除其中一个约束，并直接询问服务器。

# jquery - Jquery Hover 获取 Title 属性并显示 Div

> ID：10508729
> 
> 赞同：1
> 
> 时间：2012-05-09T01:29:45.823
> 
> 标签：jquery, hover

在修补了几个小时之后，我希望有人可以对此有所了解。

我有 2 个并排的 div。在右侧有一个包含 div id=list 的链接列表。在左侧有 viewarea div，它将在悬停时显示图片和链接的描述。因此，当您将鼠标悬停在链接上时，它应该在左侧显示一个特定于该 div 的 div。但是，我想为此添加一些自动化。

基本上将鼠标悬停在列表 div 中的链接上时，将切换左侧 div 的显示以显示块。将显示图片和描述的隐藏 div id 命名为与列表 div 中链接的标题属性相同。因此，在悬停时，链接应该切换一个 id 等于标题的 div 的显示：块。

所以基本上我的脚本逻辑是这样的：

将鼠标悬停在列表 div 中的链接上。获取此链接的标题属性。更改 id 等于上面（在#viewarea 中）获得的标题属性的 div 以显示块。

因此，当将鼠标悬停在猴子链接上时，它将获取标题“monkeys”并在 viewarea div 中切换 div id=“monkeys”的可见性。

这是粗略的 html/css 代码：

```
#list {
width: 480px;
float: right;
}

#viewarea {
width: 480px;
}

<div id="list">

<h1>
Animals
</h1>
<p>
<a href="monkeys_link"  title="monkeys">Monkeys</a>
</p>
<p>
<a href=”kittens_link" title="kittens">Kittens</a>
</p>
<p>
<a href="pigs_link" title="pigs">Pigs</a>
</p>

</div>

<div id="viewarea">

<div id="monkeys" style="display: none;">
<img src="picture_of_monkeys.jpg"></img>
Summary text
</div>

<div id="kittens" style="display: none;">
<img src="picture_of_kittens.jpg"></img>
Summary text
</div>

<div id="pigs" style="display: none;">
<img src="picture_of_pigs.jpg"></img>
Summary text
</div>

</div> 
```

这就是我最终得到的外部 jquery 脚本。我知道我需要某种像 .each 这样的循环结构，但我无法让它工作。我在正确的轨道上吗？

```
$(document).ready(function() {

var title1 = $("#list a").attr("title");

$("#list a").hover(
function () {
$("#" + "title1").css("display", "block");
},
function () {
$("#" + "title1").css("display", "none");
}
);

}); 
```

抱歉发了这么长的帖子，非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T01:54:14.890

```
$("#list")
  // On mouseenter and mouseleave, we want to react
  .on("mouseenter mouseleave", "a", function(e){
    // Find the element whose id matches our current title
    var el = $("#" + this.title);
    // Determine if we're entering or exiting the link
    switch ( e.type ) {
      // Show the element or hide the element
      case "mouseenter" : el.show(); break;
      case "mouseleave" : el.hide();
    }
  }); 
```

演示：http: [//jsbin.com/amiet/2/edit](http://jsbin.com/amitet/2/edit)

# java - Maven 忽略了与旧版本的 jar 冲突

> ID：10508733
> 
> 赞同：0
> 
> 时间：2012-05-09T01:30:20.220
> 
> 标签：java, maven, guava, playn

我是新手。我的 gwt 兼容项目使用[PlayN](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CGcQFjAA&url=http://code.google.com/p/playn/&ei=tMepT_vBE4PF6QHVibDXBA&usg=AFQjCNGl5icJhTDfXMWkaSAlC5_UZw-0oQ&sig2=p47YiaXt66kUQ-ODFYxJMw)，它依赖于 Google Guava r09：

```
<dependency>
  <groupId>com.google.guava</groupId>
  <artifactId>guava</artifactId>
  <version>r09</version>
</dependency> 
```

（该项目本身不是 GWT，但它是 GWT 项目的依赖项，因此其中的所有内容都需要与 GWT 兼容。）

我想使用 r12 的 gwt 兼容版本。做这个的最好方式是什么？我尝试将 r12 添加到我自己的 pom 中：

```
 <dependency>
        <groupId>com.google.guava</groupId>
        <artifactId>guava-gwt</artifactId>
        <version>12.0</version>
    </dependency> 
```

但是 Eclipse 报告说 r12 “与 r09 发生冲突而被省略”。我尝试从 PlayN 中排除 r09，但这没有用：

```
<dependency>
            <groupId>com.googlecode.playn</groupId>
            <artifactId>playn-java</artifactId>
            <version>1.1.1</version>
            <exclusions>
                <exclusion>
                    <artifactId>guava</artifactId>
                    <groupId>com.google.guava</groupId>
                </exclusion>
            </exclusions>
        </dependency> 
```

在我的项目中使用 r12 的最佳方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T02:15:46.763

我能够在我的项目中使用 Guava r11。我提供了分步说明，我希望它们同样适用于 r12，在这里：

*   [https://stackoverflow.com/a/10004959/1093087](https://stackoverflow.com/a/10004959/1093087)

我尝试尽可能少地了解 Maven 的机制，但在我的 pom 文件中没有看到任何排除项。您可以在此处找到该文件的完整副本：

*   [pom.xml](http://code.google.com/p/klenwell/source/browse/trunk/projects/java/playndev/playndev/core/pom.xml)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T10:32:35.347

我会说指定您打算使用的版本并排除可能导致麻烦的传递依赖项会更安全。

如果您想对此提供进一步的支持，您可以运行

mvn 依赖：树

添加排除之前或之后，并在此处发布结果

# ruby-on-rails - 预期 css“标题”和文本“Ruby on Rails 教程示例应用程序 | 注册”返回一些东西

> ID：10508734
> 
> 赞同：2
> 
> 时间：2012-05-09T01:30:40.310
> 
> 标签：ruby-on-rails, ruby, rspec, capybara, railstutorial.org

我正在阅读 Michael Hartl 编写的 Ruby on Rails 教程，但我不断收到一个我无法弄清楚的失败测试。

这是我遇到的失败：

用户页面注册页面：

```
 Failure/Error: it { should have_selector('title', text: full_title('Sign Up')) }
 expected css "title" with text "Ruby on Rails Tutorial Sample App | Sign Up" to return something
 # ./spec/requests/user_pages_spec.rb:11:in `block (3 levels) in <top (required)>' 
```

这是我的测试文件：

```
require 'spec_helper'

describe "User pages" do

  subject { page }

  describe "signup page" do
    before { visit signup_path }

      it { should have_selector('h1',    text: 'Sign up') }
      it { should have_selector('title', text: full_title('Sign Up')) }
  end
end 
```

这是我的 new.html.erb 文件：

```
<% provide(:title, 'Sign up') %>
<h1>Sign up</h1>
<p>Find me in app/views/users/new.html.erb</p> 
```

application_helper.rb：

```
module ApplicationHelper

    # Returns the full title on a per-page basis.
    def full_title(page_title)
      base_title = 'Ruby on Rails Tutorial Sample App'
      if page_title.empty?
        base_title
      else
        "#{base_title} | #{page_title}"
      end
    end
end 
```

应用程序.html.erb：

```
<!DOCTYPE html>
<html>
  <head>
    <title><%= full_title(yield(:title)) %></title>
    <%= stylesheet_link_tag    "application", media: "all" %>
    <%= javascript_include_tag "application" %>
    <%= csrf_meta_tags %>
    <%= render 'layouts/shim' %>
  </head>
    <body>
    <%= render 'layouts/header' %>
    <div class="container">
      <%= yield %>
      <%= render 'layouts/footer' %>
    </div>
  </body>
</html> 
```

我不确定我做错了什么。让我知道我是否应该提供更多信息。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-09T01:48:34.963

您的测试期待“注册”，您正在通过“注册”。请注意“向上”一词的大小写差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T02:08:49.743

您可以发布您的应用程序布局文件 ( `/app/views/layouts/application.erb.html`) 文件吗？

我不确定，但看起来您可能正在`:title`为该文件的 yield 部分提供内容——并且可能将其替换到应用程序布局文件中的位置可能与您的想法不同。

也就是说，在`application.erb.html`文件中，它看起来好像你有一个部分`yield :title`——但它可能不会像你的测试认为的那样呈现。

您可以编辑您的问题并添加应用程序布局（或至少是适当的部分）吗？

# oop - 从文件中读取子类

> ID：10508736
> 
> 赞同：0
> 
> 时间：2012-05-09T01:30:47.513
> 
> 标签：oop, design-patterns, polymorphism, factory

我正在制作一个程序，该程序从我称为脚本的文件中获取输入。脚本只包含一系列信息。将来，我将需要每个脚本包含更多信息，因此我将每个脚本与一个版本号相关联。

*任何*脚本文件中的信息都可以完全包含在一个名为 EntityStatePdu 的特定类中（其细节对于这个问题并不重要）。因此，我决定开设以下课程：

1) 抽象类 Script
2) 类 ScriptV1 扩展 Script
3) 类 ScriptV2 扩展 Script
4) ...

我让每个脚本文件都以其版本信息开头。因此，版本 1 脚本以“scriptV1”开头，版本 2 脚本以“scriptV2”开头。我想将不同的脚本版本抽象到脚本类中。

因此，理想情况下，我希望在名为 FromFile 的 Script 类中有一个工厂方法，这样调用会`Script.FromFile("scriptVersion1.txt")`返回一个有效的 ScriptV1 对象，而调用会`Script.FromFile("scriptVersion2.txt")`返回一个有效的 ScriptV1 对象。我想要`FromFile`读取文件的方法，通过查看文件的开头来确定它的版本，并实例化适当的 Script 子类。这将使该类的用户可以使用任何脚本文件，而与版本无关。

你将如何编写这个`FromFile`工厂方法？你会建议一个不同的班级设计吗？某种设计模式？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T02:00:59.933

将静态变量添加到 Script 类以包含从字符串（例如“scriptV1”）到相应类的实例的映射。在 FromFile 方法中，提取字符串，在地图中查找，克隆实例并返回它。作为初始化阶段，子类需要在映射中相应的字符串下注册自己的实例。

# java - Hibernate JPA hasOne 映射？

> ID：10508737
> 
> 赞同：0
> 
> 时间：2012-05-09T01:31:05.003
> 
> 标签：java, hibernate, jpa, persistence

假设我们有两张桌子，`ORDERS`并且`OFFERS`

**订购 POJO**

```
@Entity
@Table(name = "ORDERS")
public class Order {

    @Column(columnDefinition = "serial")
    private @Id Integer id;
    private @NotNull @Email String ownerEmail;
    private @NotNull Integer offerId;
} 
```

**提供 POJO**

```
@Entity
@Table(name = "OFFERS")
public class Offer {

    @Column(columnDefinition = "serial")
    private @Id Integer id;
    private @Email @NotNull String ownerId;
} 
```

是否可以在 EntityManager 上获取单个查询，`Order by ID`以便结果包含相关`Offer`对象？

就像在 Order 中创建 @Transient Offer 字段一样，因为我们不想在持久 Order 上修改 Offer 数据。

或者唯一的方法是创建两个查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T02:17:23.957

`@Transient`在`offer`字段上注解`Order`意味着该字段不会被映射和持久化。实际上，您应该映射此字段，但通过将其[@Column.insertable()](http://docs.oracle.com/javaee/6/api/javax/persistence/Column.html#insertable%28%29)和[@Column.updatable()](http://docs.oracle.com/javaee/6/api/javax/persistence/Column.html#updatable%28%29)设置为 false 将其设为只读。

```
@Entity
@Table(name = "ORDERS")
public class Order {

    @Column(columnDefinition = "serial")
    private @Id Integer id;
    private @NotNull @Email String ownerEmail;

    private @NotNull Integer offerId;

    @Column(insertable=false , updateable=false)
    private Offer offer;
} 
```

要在单个查询中获取订单及其相关报价，您可以使用 fetch 连接：

```
SELECT order FROM Order order join fetch order.offer 
```

# javascript - Javascript需要使用带有id的链接传递变量

> ID：10508738
> 
> 赞同：0
> 
> 时间：2012-05-09T01:31:07.257
> 
> 标签：javascript, jquery, lightbox

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T01:37:58.103

几点：

1.  jQuery[`attr()`](http://api.jquery.com/attr/)方法可用于获取`href`任何元素上的任何属性，包括 , 。

2.  使用已弃用[`on()`](http://api.jquery.com/on/)的 jQuery 1.7+ 方法。[`live()`](http://api.jquery.com/live/)

3.  如果您将有多个`<a>`标签，则需要引用`class`名称而不是`ID`. 所以你会使用“。” 代替 ”＃”。在您的情况下，它将`.selector`代替`#selector`.

4.  为了减少函数内部的语句数量`click`，可以将两个`fadeIn()`具有相同时间间隔的函数组合起来，`500`. 请注意，在这种情况下，您将使用“，”来分隔元素，`.overlayInner`而`.closepop`.

5.  由于您在灯箱中，因此假设您不想在单击链接时迁移到另一个页面。出于这个原因，您将需要使用`e.preventDefault`或`return false;`作为函数内的**最后一条**语句。`click`,`e`将是传递给[匿名的](http://docs.jquery.com/How_jQuery_Works)[eventObject](http://api.jquery.com/category/events/event-object/)。 `'click', 'a.selector', function(e)`

总而言之，这就是您的 javascript 的外观。

```
var href=$("a.selector").attr('href', 'country.php');

$(document.body).on("click", "a.selector", function(){
    $(".overlayInner").load("'+href+'");
    $(".overlayOuter").fadeIn(300); 
    $(".overlayInner, .closepop").fadeIn(500); 
    return false;
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T01:37:44.633

尝试这个：

```
$("a.selector").live("click", function() {
    var url = $(this).attr('href'); 
    $(".overlayInner").load(url);
    return false;
});

<a class="selector" href="/country.php">Country</a>
<a class="selector" href="/pigs.php">Pigs</a> 
```

如果您想获取显示“国家/地区”的内部文本或图像，您可以执行以下操作：

```
$("a.selector").live("click", function() {
    var url = $(this).attr('href'); 
    var img = $(this).html(); // But what do you want to do with it?
    $(".overlayInner").load(url);
    return false;
});

<a class="selector" href="/country.php"><img src="img.jpg" /></a> 
```

# html - 在 windows phone 7 应用程序中流式传输音频

> ID：10508740
> 
> 赞同：2
> 
> 时间：2012-05-09T01:31:30.667
> 
> 标签：html, windows-phone-7, stream, audio-streaming

如果我在 Javascript 中执行此操作，我可以在源 URL 后面播放音乐。没问题。

```
var music = new Audio();
var source = http://*HOST*.grooveshark.com/stream.php?streamKey=*STREAMKEY*;
music.src = source;
music.play(); 
```

更好的是，我可以在我的 WP7 应用程序中使用 Web 控件来执行此操作，并且神奇地我可以在应用程序中播放音乐。但是，我也想在背景中加入音频。所以我不能只在网络浏览器控件中流式传输音频。

我需要采用上述类型的音频源，但在本机 Windows Phone 应用程序中使用它。似乎有很多方法，MediaElement、BackgroundAudioPlayer 等，等等....但它们似乎都不适用于上述网址。我可以将他们传递给某处服务器上的 mp3 的链接，一切正常。但我似乎无法通过这样的网址在 Windows 手机上流式传输音频。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T05:28:47.440

尝试使用适用于 Windows Phone 的 Phonegap Media API 的 JavaScript 方式

[科尔多瓦媒体 API](http://docs.phonegap.com/en/1.7.0/cordova_media_media.md.html#Media)

看起来像：

```
 my_media = new Media("test.mp3", onSuccess, onError);
    function onSuccess() {
        console.log("playAudio():Audio Success");
    }
    // onError Callback 
    //
    function onError(error) {
        alert('code: '    + error.code    + '\n' + 
              'message: ' + error.message + '\n');
    } 
```

希望这有帮助:)

# ruby-on-rails - 您如何更改 Capybara 中 Cucumber 测试的测试默认驱动程序？

> ID：10508741
> 
> 赞同：9
> 
> 时间：2012-05-09T01:31:45.027
> 
> 标签：ruby-on-rails, cucumber, capybara

在[Capybara](https://github.com/jnicklas/capybara)提供的文档中，您可以更改特定测试组的 default_driver：

```
describe 'some stuff which requires js', :js => true do
  it 'will use the default js driver'
  it 'will switch to one specific driver', :driver => :selenium
end 
```

如果我想为特定的黄瓜测试组执行此操作怎么办？我将如何添加这些参数？

```
When /^I do something$/  do
  fill_in "a_text_box", :with => "stuff"
  fill_in "another_text_box", :with => "another_thing"
end 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-09T03:00:41.293

在黄瓜中，我分两步完成了这项工作：

在`/features/support/env.rb`中，放置以下行：

```
Capybara.javascript_driver = :webkit 
```

然后在黄瓜功能中，就在特定场景之前，就在场景`@javascript`之前添加——就像这样：

```
@javascript
Scenario: Successful sign in - with no flash message if using current firefox
When I'm using a current version of Firefox
When I visit the practitioner home page with "jane.doe@example.com"'s token
Then I should be signed in as practitioner "Jane Doe"
And I should be on the practitioner activities welcome page
And I should not see a flash message warning me I have an unsupported browser 
```

这告诉黄瓜`javascript`在运行特定场景时使用驱动程序。

这就是我使用 Capybara Webkit 完成此操作的方式——我确信其他驱动程序是相似的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-09T01:37:00.917

```
Capybara.current_driver = :webkit # temporarily select different driver
#... tests ...
Capybara.use_default_driver       # switch back to default driver 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-26T14:39:17.053

使用黄瓜，您可以使用标签来实现这一点。例如，如果您的默认驱动程序是 webkit，但您想使用 selenium 运行某些场景，您可以使用`@selenium`. `gem 'selenium-webdriver'`默认情况下适用

一般来说，如果要切换到其他驱动程序（本例中为 Headless chrome），请将以下代码放入`features/support/drivers.rb`：

```
# features/support/drivers.rb
Around '@headless_chrome' do |scenario, block|
  begin
    Capybara.current_driver = :headless_chrome # temporarily select headless chrome
    block.call
  ensure
    Capybara.use_default_driver                # switch back to default webkit driver
  end
end 
```

# grails - 如何在 grails 应用程序中阻止对石英监视器的访问

> ID：10508742
> 
> 赞同：0
> 
> 时间：2012-05-09T01:31:52.463
> 
> 标签：grails, quartz-scheduler

我在 grails facebook 应用程序中有石英监视器插件。主应用程序中的所有控制器都使用 facebook 身份验证。如何配置石英监视器的插件，使其无法被所有人访问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T01:39:35.530

如果你使用 spring security 插件来做 auth 的事情，那么你可以创建单独的角色，例如 ROLE_QUARTZ_USER，然后通过在其方法中添加以下注释来保护对石英控制器的访问：

```
 @Secured(['ROLE_QUARTZ_USER']) 
```

由于 FaceBook 用户不会拥有这个角色，Spring Security 将拒绝他们的访问。

# visual-studio - 找出我的应用程序当前在 Visual Studio 的调试模式下运行的代码行

> ID：10508749
> 
> 赞同：46
> 
> 时间：2012-05-09T01:32:58.637
> 
> 标签：visual-studio, debugging

当我使用 Visual Studio 在调试模式下运行应用程序时，有没有办法可以找出当前正在处理的代码行？我的意思是，有没有一种工具可以像设置断点一样工作，但您不必设置断点——您可以随时找出正在执行的代码行？

这样做的原因是，有时您可能想要调试应用程序中的间歇性挂起。如果您在调试模式下运行，并且您的应用程序挂起，那么立即找出它最后处理的代码行将很有用，而无需通过设置断点或跟踪调用提前计划。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-05-09T01:39:56.817

按暂停按钮（“||”）。

# java - 这个“for-loop”在做什么？

> ID：10508750
> 
> 赞同：-1
> 
> 时间：2012-05-09T01:33:26.627
> 
> 标签：java, for-loop

> **可能重复：**
> [foreach 循环一个 java 创建？](https://stackoverflow.com/questions/2518111/foreach-loop-a-java-creation)

我正在学习一个Java程序。但是有些东西，我不明白。它如下：

```
for(Some obj : vc) {
  System.out.println(obj.getResult()); 
```

我试图在我的书和谷歌中搜索“for-loop”。他们只是有一些基本的方法。

“for(Some obj : vc)”是什么意思？

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T01:35:14.417

这是一个[for-each 循环](http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html)，在 Java 1.5 中引入。

您可以将其解读为“For each `Some`in `vc`”。

它实际上与使用这样的迭代器相同：

```
for(Iterator<Some> i = vc.iterator(); i.hasNext();) {
  Some obj = i.next();
  System.out.println(obj.getResult());
} 
```

只有更少的膨胀。

另外，请注意，此语法不限于`Iterable`. `vc`如果是一个数组，这也将起作用`Some`如果是（即`Some[]`）

# c# - 将 ActionLink 添加到默认 MVC Web 应用程序

> ID：10508751
> 
> 赞同：1
> 
> 时间：2012-05-09T01:33:35.960
> 
> 标签：c#, html, asp.net-mvc, razor

我创建了一个 HelloWorld 控制器及其对应的视图。当我去的时候一切正常`http://localhost/HelloWorld`

我正在尝试将菜单项添加到默认 MVC 应用程序。在 _Layout.cshtml 文件中我有

```
<ul id="menu">
    <li>@Html.ActionLink("Home", "Index", "Home")</li>
    <li>@Html.ActionLink("Hello World", "HelloWorld", "")</li>
    <li>@Html.ActionLink("About", "About", "Home")</li>
</ul> 
```

请注意，我添加的唯一内容是 Hello World 部分。但是，当我单击菜单项时，它需要我`http://localhost/Home/HelloWorld`。我怎样才能让它去呢`http://localhost/HelloWorld`？

我对 MVC 真的很陌生，并且不确定我在做什么。一些谷歌搜索提到修改 Global.asax.cs 中的路由，但这似乎有点奇怪，不知道从哪里开始。我也尝试过使用 ~ 来回到在旧学校 asp.net 页面中工作的 root ，但不是在这里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T01:37:31.480

的定义`ActionLink`是。

```
public static MvcHtmlString ActionLink(
    this HtmlHelper htmlHelper,
    string linkText,
    string actionName,
    string controllerName
) 
```

由于您试图重定向到`/HelloWorld`，我假设您的控制器是`HelloWorld`并且您的操作是`Index`。使用这些信息我们可以填写方法。

```
Html.ActionLink(
    "Hello World",  // Link Text
    "Index",        // Action
    "HelloWorld",   // Controller
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T01:39:37.097

您想要的 ActionLink 的语法是：

```
@Html.ActionLink(string linkText, string actionName, string controllerName) 
```

您传入 ActionName 并将 controllerName 留空，默认情况下它将假定它是当前控制器（在本例中为“Home”）上的 Action。

尝试

```
@Html.ActionLink("Hello World", "HelloWorld", "HelloWorld") 
```

假设，也就是说，以*Action*`HelloWorld`的名义对您的. 如果 Action 有所不同，请将第二个参数替换为适当的名称。*`HellowWorldController`*

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-15T12:11:06.100

您还可以使用空字符串：

```
@Html.ActionLink("Home", "", "")

@Html.ActionLink("About Us", "About", "Home")

@Html.ActionLink("Contact me", "Contact", "Home") 
```*

# php - PHP - 如何隐藏某些帖子不被调用？

> ID：10508752
> 
> 赞同：-4
> 
> 时间：2012-05-09T01:33:38.420
> 
> 标签：php, mysql

好的，假设我有一个论坛，它有两个表，一个称为**帖子**，另一个是**用户**。当有人访问该站点时，会调用来自表格**帖子**的所有帖子。如果我有一个用户暂时被禁止并且我想隐藏他们的所有帖子（或者在这种情况下有多个用户），我怎样才能调用论坛帖子而不显示他们的帖子？我的**users**表中已经有一个名为*active*的列。Active 只是 1 或 0 表示禁止与否。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T02:10:22.227

您的问题非常模糊，但假设以下表结构：

```
table users
    id  username    password    active
table posts
    id  userid      title       text        date 
```

我将使用以下 SQL 语句。

```
SELECT p.id, p.title, p.text, p.date FROM posts AS p INNER JOIN users AS u ON u.id = p.userid AND u.active = 1; 
```

现在我不是 SQL 人，这里可能有错误.. 对不起，我不会设置这一切来测试。如果您无法从我的示例中弄清楚，请随时发表评论，我们可以进一步调查。可以在[此处阅读有关 mysql JOIN 语法的更多信息](http://dev.mysql.com/doc/refman/5.0/en/join.html)

编辑：正如向我指出的那样，INNER JOIN 是正确的 JOIN 使用。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-09T01:41:17.690

在表中创建另一个字段作为标志。说 1 表示显示，0 表示不显示。设置它，以便当您禁止某人时，它会遍历帖子表并找到他们的所有帖子并将标志设置为 0。当显示帖子时，请使用 select * from table where show field =1 in your mysql_query，假设您使用 mysql。

# android - 是否可以将 Wave Launcher 与其他应用程序集成？

> ID：10508759
> 
> 赞同：0
> 
> 时间：2012-05-09T01:34:25.410
> 
> 标签：android

我想将 wave 启动器应用程序与我正在构建的应用程序集成，这样我就可以以该波形显示我的应用程序的菜单页面。有什么办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T02:54:10.883

一般来说，任何诸如“是否可以与 [SOME_APPLICATION] 集成”之类的问题都可以通过以下方式回答：“只有 [SOME_APPLICATION.DEVELOPER] 为您创建了一些 API 供您使用，或者您可以设法与他们取得联系并找出其他整合方式。” 如果您在他们的网站上找不到任何关于与其他应用程序集成的部分（以任何未宣传的方式，即不仅仅是将快捷方式添加到 wave 事物），那么很有可能这是不可能的，您最好的选择是接触到创造它的人。

# java - 两个单独键盘的 Java 单独输入

> ID：10508760
> 
> 赞同：5
> 
> 时间：2012-05-09T01:34:26.783
> 
> 标签：java, usb

我有两个 USB 键盘插入同一台机器。我正在开发一个 Java 应用程序。无论如何允许Java应用程序分离出它来自哪个USB键盘？（即是否有类似[http://docs.oracle.com/javase/6/docs/api/java/awt/event/KeyEvent.html](http://docs.oracle.com/javase/6/docs/api/java/awt/event/KeyEvent.html)但带有 USB 参数的东西，所以我可以知道它来自哪个 USB 设备？）

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-09T02:03:21.180

仅使用 Java 是不可能的。

但是有 3rd 方工具可以重新映射键盘的键。[HID 宏](http://www.hidmacros.eu/whatisit.php)是一种应用程序。但它仅适用于按键，不适用于按键向上和向下事件。这限制了它的有用性，但对于您的用例可能就足够了。

如果你想深入挖掘，你需要使用 Windows 上的[RAW Input API](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645543%28v=vs.85%29.aspx "原始输入 API")来做你想做的事。代码项目中已经有一个很好的示例，名为[Using Raw Input from C# to handle multiple keyboards](http://www.codeproject.com/Articles/17123/Using-Raw-Input-from-C-to-handle-multiple-keyboard)，它揭示了正确的 API 用法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-14T09:30:42.487

我在这里回答可能为时已晚，因为这个问题是一个老问题。但是由于我在寻找相同要求时被引导到这里，所以我会提到我在另一个线程上找到的解决方案，以帮助将来将被引导到这里的人，为相同的要求寻求帮助。@nan 使用 java-hid-api 对此提供了解决方案，您可以[在此处](https://stackoverflow.com/a/17210694/3127619)找到他的答案。[他还在他的博客中](http://nanlee.wordpress.com/2013/06/12/manykeyboard-using-java-hid-api-to-handle-multiple-keyboard-input/)写了一篇关于如何做到这一点的清晰而逐步的帖子。

但是我必须说我已经尝试过了，但仍然没有成功，因为`HIDManager`在尝试通过路径或 id 打开 HID 时返回 null。尝试`open()`使用时也是如此`HIDDeviceInfo`。这个问题也列在[java hid api 页面](https://code.google.com/p/javahidapi/issues/list?cursor=javahidapi:21)中，但到目前为止似乎没有人能够提供有效的解决方案。因此，如果有人能够绕过此问题。请分享。

# javascript - 尝试在 RAILS 中渲染 JS 会导致问题

> ID：10508764
> 
> 赞同：0
> 
> 时间：2012-05-09T01:35:01.983
> 
> 标签：javascript, ruby-on-rails, ruby, highcharts

我目前正在实施 Highcharts 以在我的 RAILS 应用程序中创建图表。我正在使用惰性高图表 gem 使它更清洁。这工作正常。图表效果很好。不幸的是，gem 中不支持一些事情，例如添加自定义 js 事件，如点击事件。我必须在视图中添加额外的选项代码。

您可以在下面查看相关代码。注释掉的点击事件工作正常。此单击事件将成功引发浏览器警报窗口。下面的大块 js 文本是我想要实现的更高级的点击事件。不幸的是，我收到以下错误。我猜是因为 RAILS 试图解析 js 文本？我搞不定。

```
<%= high_chart("my_id", @h) do |c| %>
    <%= #"options.series[4].point.events.click = function() {alert ('Category: ');}" %>
    <%= render :js => %{ 
            options.series[4].point.events.click = 
                function() {
                        hs.htmlExpand(null, {
                            pageOrigin: {
                                x: this.pageX,
                                y: this.pageY
                            },
                            headingText: this.series.name,
                            maincontentText: Highcharts.dateFormat('%A, %b %e, %Y', this.x) + ':<br/> ' + this.y + ' visits',
                            width: 200
                        });
                    }
                } %>
<% end %> 
```

错误：

```
/home/scott/flux/app/views/cognos_mn_tickets/pbadata.html.erb:22: syntax error, unexpected ',', expecting ')'
...ext: Highcharts.dateFormat('%A, %b %e, %Y', this.x) +':<br/>...
...                               ^
/home/scott/flux/app/views/cognos_mn_tickets/pbadata.html.erb:22: unknown type of %string
... Highcharts.dateFormat('%A, %b %e, %Y', this.x) +':<br/> '+t...
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T01:42:49.397

问题是当你用`%{`then 开始一个字符串时，它会在下一个结束`}`——它在你的 JavaScript 代码的中间。尝试改用[Heredoc](http://rubyquicktips.com/post/4438542511/heredoc-and-indent)语法：

```
<%= high_chart("my_id", @h) do |c| %>
  <%= <<-END
      options.series[4].point.events.click = function() {
        hs.htmlExpand( null, {
          pageOrigin      : { x: this.pageX, y: this.pageY },
          headingText     : this.series.name,
          maincontentText : Highcharts.dateFormat('%A, %b %e, %Y', this.x) +
                            ':<br/> ' + this.y + ' visits',
          width           : 200
        } );
      }
    END
  %>
<% end %> 
```

# iphone - 使用 stringByReplacingOccurrencesOfString 将 \\ 替换为 \

> ID：10508769
> 
> 赞同：4
> 
> 时间：2012-05-09T01:35:44.973
> 
> 标签：iphone

我使用代码打击将 \\ 替换为 \

```
 NSString *str =@"\\u597d\\u6f02\\u4eae\\u7684\\u5a5a";

 str=    [str  stringByReplacingOccurrencesOfString: @"\\\\" withString: @"\\" ]; 
```

但看起来 stringByReplacingOccurrencesOfString 不起作用。两个都输出

```
 \u597d\u6f02\u4eae\u7684\u5a5a 
```

欢迎任何评论

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T01:38:58.967

这是因为源字符串不包含双斜杠：编译器在创建字符串常量的过程中会消耗所有双斜杠，并用单斜杠替换以获得最终字符串：

```
\u597d\u6f02\u4eae\u7684\u5a5a 
```

当您在字符串常量中使用斜线时，需要两个斜线来表示一个斜线。当您在传递给正则表达式的字符串常量中使用斜杠时，您需要四个斜杠：四个斜杠中的两个将由编译器使用，然后其余两个中的一个将由正则表达式编译器使用。

这是您的示例，它可以满足您的预期：

```
NSString *str =@"\\\\u597d\\\\u6f02\\\\u4eae\\\\u7684\\\\u5a5a";
NSLog(@"%@", str);
str=    [str  stringByReplacingOccurrencesOfString: @"\\\\" withString: @"\\" ];
NSLog(@"%@", str); 
```

输出如下所示：

```
\\u597d\\u6f02\\u4eae\\u7684\\u5a5a
\u597d\u6f02\u4eae\u7684\u5a5a 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T01:38:47.970

`str`里面没有`\\\\`- 你可以看到只有s ......这`\\`是你在第一个分配语句之后打印出来的，所以`stringByReplacingOccurrencesOfString`找不到任何可以替换的东西。

# android - 选项卡中的 ActivityGroup - 返回按钮

> ID：10508774
> 
> 赞同：0
> 
> 时间：2012-05-09T01:37:18.907
> 
> 标签：android, activitygroup

Java 回答很好，我倾向于将 C# 用于 Android。

在我的 ActivityGroup 中，我有这个方法可以启动并显示一个子活动：

```
 public void StartChildActivity (string Id, Intent intent)
    {
        intent.AddFlags (ActivityFlags.ClearTop);
        Window window = LocalActivityManager.StartActivity (Id, intent);
        if (window != null)
        {
            mIdList.Add (Id);
            SetContentView (window.DecorView);
        }
    } 
```

但是，当我处理后退按钮以“弹出”视图并将其返回到前一个视图时，应用程序会在调用完成时关闭：

```
 public override void OnBackPressed ()
    {
        int length = mIdList.Count;
        if (length > 1)
        {

            Activity current = LocalActivityManager.GetActivity (mIdList [length - 1]);
            current.Finish();
        }           
    } 
```

如何让视图“弹出”而不是关闭应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T05:25:12.827

尝试制作 iOS 端口听起来很熟悉？

这就是我开始活动的方式

```
 String id = "SOME_UNIQUE_ID";
 Intent intent = new Intent(context,SomeClass.class);
 intent.putExtra("UniqueID", id);
 LocalActivityManager m = getLocalActivityManager();
 Window w = m.startActivity(id, intent);
 setContentView(w.getDecorView());
 intentStack.push(intent); 
```

这就是我在后面完成活动的方式

```
 LocalActivityManager m = getLocalActivityManager();
 Intent i = intentStack.pop();
 m.destroyActivity(i.getStringExtra("UniqueID"),true); 
```

intentStack 就是我保存意图堆栈的地方，这样我就可以再次找到这些活动。

这应该是您所需要的，但无论您是否应该重新评估您是否需要使用 TabActivity/ActivityGroup 作为该类，并且所有子类自 2.2 或 2.3 起已被弃用。您应该考虑移动到片段并使用支持库。

# c# - PostBuildEvent 创建目录

> ID：10508778
> 
> 赞同：29
> 
> 时间：2012-05-09T01:37:55.733
> 
> 标签：c#, visual-studio-2010, cmd, post-build-event

我正在尝试在 Visual Studio 的 PostBuildEvent 中使用以下命令行在构建输出文件夹中创建一个名为 Design 的文件夹

```
mkdir $(TargetDir)Design  ....Runs Successfully but folder is not created
mkdir "$(TargetDir)Design" ....Runs Successfully but folder is not created
MD $(TargetDir)Design  ....Runs Successfully but folder is not created
MD "$(TargetDir)Design"  ....Runs Successfully but folder is not created 
```

谁能告诉我我做错了什么

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2014-10-29T01:52:28.180

您需要执行以下操作：

```
if not exist DirToCreate mkdir DirToCreate 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2017-01-26T22:31:18.133

这对我有用（其中 Design 是您要创建的文件夹）：

```
mkdir $(TargetDir)\Design 
```

如果要先检查是否存在：

```
if not exist $(TargetDir)\Design mkdir $(TargetDir)\Design 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-07-16T14:47:00.983

除了前两个答案之外，您还可以使用如下变量：

```
SET path=$(TargetDir)\Design
if not exist "%path%" mkdir "%path%" 
```

这样，您将避免任何重复。（用VS2019测试）

# cocoa - 来自 XIB 的基于视图的 NSTableView 的视图？

> ID：10508780
> 
> 赞同：3
> 
> 时间：2012-05-09T01:38:34.303
> 
> 标签：cocoa, nstableview, nsviewcontroller

`NSTableCellView`是否可以为基于视图的文件提供单独的 XIB 文件`NSTableView`？也许在 a 的帮助下`NSViewController`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:03:29.757

是的，这似乎是可能的。

来自 Apple 的文档：

> 为了发挥作用，以编程方式实现的基于视图的表必须实现以下功能：
> 
> ...
> 
> - (NSView *)tableView:viewForTableColumn:row: 由 NSTableViewDelegate 协议定义的方法。此方法既为表格提供了视图以显示为特定列和行的单元格，也为该单元格填充适当的数据。

这样，您可以拥有 NSView 类（或任何子类）的对象并在正确填充数据后将其返回。你从哪里得到这个对象，并不重要。据我所知，可以执行以下操作，例如：

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    // Assume you have a XIB called View.xib
    [NSBundle loadNibNamed:@"View" owner:self];

    // And you have an IBOutlet to your NSTableView (that's view based) called tView
    [tView reloadData];
}

- (NSInteger)numberOfRowsInTableView:(NSTableView *)tableView {
     return 20;
}

- (NSView *)tableView:(NSTableView *)tableView
   viewForTableColumn:(NSTableColumn *)tableColumn
                  row:(NSInteger)row {

    // Assume your class has an IBOutlet called contentOfTableView, 
    // your class is File's Owner of the View.xib and you connected the outlet.
    return contentOfTableView;

} 
```

希望它有效。我只是把它放在一起，心里有个粗略的想法。祝你好运！

# restkit - Restkit 创建 NULL 核心数据对象

> ID：10508781
> 
> 赞同：1
> 
> 时间：2012-05-09T01:38:40.870
> 
> 标签：restkit

我正在使用 Restkit 构建一个应用程序以与 Web 服务同步。第一个 loadObjectsAtResourcePath 调用正常工作，但随后每个附加调用都会创建一个新的所有 NULL 行。典型的 JSON 响应是：

```
[{"item":{"created_at":"2012-04-19T19:42:44Z","id":4,"json_event_id":null,"name":"Biz Cards","theme_id":null,"updated_at":"2012-04-19T19:42:44Z","url":"","user_id":3}},{"item":{"created_at":"2012-04-20T19:37:33Z","id":5,"json_event_id":null,"name":"Hummus","theme_id":null,"updated_at":"2012-04-20T19:37:33Z","url":"","user_id":3}}] 
```

第一次调用 loadObjectsAtResourcePath 时，我正确获取了在核心数据中创建的两个对象。下次我调用它时，我在 Sqlite 中获得了一个额外的行，其中包含一个新的 PK 和所有 NULL。每个后续调用都会创建一个新的 NULL 行，其中 PK 递增。

这是我的映射：

```
RKManagedObjectMapping *itemsMapping = [RKManagedObjectMapping mappingForClass:[Items class] inManagedObjectStore:objectManager.objectStore];
itemsMapping.primaryKeyAttribute = @"itemID";
[itemsMapping mapKeyPathsToAttributes:@"created_at", @"createdAt",
 @"id", @"itemID",
 @"json_event_id", @"json_event_id",
 @"name", @"name",
 @"theme_id", @"theme_id",
 @"updated_at", @"updatedAt",
 @"url", @"url",
 @"user_id", @"user_id", nil]; 
```

这是我对网络服务的调用：

```
RKObjectManager *objectManager = [RKObjectManager sharedManager];
[objectManager loadObjectsAtResourcePath:@"/items" delegate:self]; 
```

任何有关为什么创建这些额外行的帮助将不胜感激！

# heroku - 对于部署在 Heroku 上的基于 Play Framework 1.2 的 Java 应用程序，文件下载似乎不起作用

> ID：10508782
> 
> 赞同：1
> 
> 时间：2012-05-09T01:38:40.913
> 
> 标签：heroku, playframework, playframework-1.x

我在 heroku 上使用 ClearDB MySQL，而不是默认给出的 Postgres。我的代码在我的本地机器上运行良好。这是我的下载文件方法：

```
public static void downloadFile(long id) throws Exception {

final Article doc = Article.findById(id);
        notFoundIfNull(doc);

    User current_user = User.find("byEmail", Security.connected()).first();

    if(!current_user.equals(doc.author)){
        SelectedArticles selectedArticle = SelectedArticles.find("byArticleAndReviewer", doc, current_user).first();
        if(selectedArticle == null)
        {
             SelectedArticles newSelected = new SelectedArticles(current_user, doc);
             newSelected.save();
             selectedArticle = newSelected;
        }
        selectedArticle.download();
    }

    response.setContentTypeIfNotSet(doc.article_pdf.type());
    renderBinary(doc.article_pdf.get(), doc.pdfName);
} 
```

这是我在 Heroku 日志中看到的内容：

```
←[36m2012-05-09T01:29:41+00:00 app[web.1]:←[0m Caused by: java.lang.NullPointerE
xception
←[36m2012-05-09T01:29:41+00:00 app[web.1]:←[0m  ... 2 more
←[36m2012-05-09T01:29:41+00:00 app[web.1]:←[0m  at play.mvc.results.RenderBinary
.apply(RenderBinary.java:167) 
```

# marmalade - IwUI 是否支持多点触控？

> ID：10508786
> 
> 赞同：0
> 
> 时间：2012-05-09T01:39:06.157
> 
> 标签：marmalade

是否可以设置 3 个 CIwButton 小部件（比如说“左”、“右”、“开火”）并能够在按住“开火”按钮的同时使用“左”/“右”？还是我需要编写自己的按钮类来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T21:48:55.497

你不需要。如果您在 UI 中定义事件处理方法并`IWUISLOT`为每个按钮创建一个，那么每个按钮都会有自己的触摸事件。我认为您不需要任何单独的按钮类。

# php - 如何限制上传的文件大小？

> ID：10508787
> 
> 赞同：0
> 
> 时间：2012-05-09T01:39:22.210
> 
> 标签：php, file, upload, filesize

请看下面的片段。我正在使用它来限制超过 5 mb 的文件。每当文件超过 5 mb 时，它就会说“不允许您尝试上传的文件”，而实际上它应该说“您尝试上传的文件太大”。并不是我将它们放在代码的错误部分，我正在使用：

```
if(filesize($_FILES['filename']['tmp_name']) > $max_filesize) 
```

完整代码：

```
// Configuration - Your Options
$allowed_filetypes = array('.pdf','.jpg','.png','.gif'); 
$max_filesize = 5242880; // Maximum filesize in BYTES (currently 0.5MB).
$upload_path = "/store/user/$user"; 
$filename = $_FILES['filename']['name']; 
$ext = substr($filename, strpos($filename,'.'), strlen($filename)-1); 
if(!in_array($ext,$allowed_filetypes))
die('The file you attempted to upload is not allowed.');
// Now check the filesize, if it is too large then DIE and inform the user.
if(filesize($_FILES['filename']['tmp_name']) > $max_filesize)
die('The file you attempted to upload is too large.');
// Check if we can upload to the specified path, if not DIE and inform the user.
if(!is_writable($upload_path))
die(''); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T02:47:05.630

您的文件扩展名代码不正确，很可能。

尝试：

```
$allowed_filetypes = array('pdf', 'jpg', 'png', 'gif');
// ...
$ext = strtolower(pathinfo($filename, PATHINFO_EXTENSION));
// ... 
```

否则，由于文件大小的限制，文件基本上不会上传；您可以通过查看来检查这一点`$_FILES['filename']['error']`。该值应为 0。

如果不是 0，你可以在这里查看它的含义：[http ://www.php.net/manual/en/features.file-upload.errors.php](http://www.php.net/manual/en/features.file-upload.errors.php)

在您的情况下，文件可能太大了；在这里检查可能有什么问题：[http ://www.php.net/manual/en/features.file-upload.common-pitfalls.php](http://www.php.net/manual/en/features.file-upload.common-pitfalls.php)

# asp.net-mvc-3 - 没有特定控制器操作的视图中的 FileContentResult 呈现

> ID：10508788
> 
> 赞同：0
> 
> 时间：2012-05-09T01:39:25.770
> 
> 标签：asp.net-mvc-3, view, filecontentresult

我在从数据库中获取的控制器中具有相同的操作，例如具有名称、年龄、图像（字节 []）的员工。

所以我将信息存储在 ViewBag 中。然后在 View 中图片的具体代码是：

```
<img src="@ViewBag.Image" alt="Logo" /> 
```

但是当我看到回复的内容时，我有：

```
<img src="System.something.FileContentResult" alt="Logo" /> 
```

我已经看到了很多从控制器中的特定操作获取 FileContentResult 的示例，例如：

（代码仅为示例）

```
public ActionResult GetEmployeeImage (int id){
    byte[] byteArray = GetImageFromDB(id);
    FileContentData file = new File (byteArray,"image/jpg");
    return file;
} 
```

然后使用以下命令渲染图像：

```
<img src="@Url.Action("GetEmployeeImage", "Home", new { id = ViewBag.Id })" alt="Em" /> 
```

但我不想那样，因为我已经有了图像。

如何将它渲染到 View 并抛出 ViewBag？

谢谢！

PD：[在视图中渲染图像](https://stackoverflow.com/questions/10398230/rendering-image-in-a-view)是一样的，但没有得出结论

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T05:55:57.410

一种可能性是使用[数据 URI 方案](http://en.wikipedia.org/wiki/Data_URI_scheme)。请记住，这仅适用于支持它的浏览器。这个想法是将图像数据作为 base64 字符串嵌入到标签的`src`属性中：`img`

```
<img src="data:image/jpg;base64,@(Html.Raw(Convert.ToBase64String((byte[])ViewBag.Image)))" alt="" /> 
```

另一方面，如果您想要一个适用于所有浏览器的解决方案，则必须使用控制器操作来提供图像。所以在初始请求中只获取员工的 id、name 和 age 属性，而不是图像。然后编写一个控制器动作，它将员工 id 作为参数，查询数据库，获取相应的图像并将其作为文件结果返回。然后在视图内部将 img 标签的 src 属性指向这个控制器动作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-09T12:46:17.103

根据@darin 的回答，如果有人想通过调用控制器的操作来实现：

```
 public FileContentResult GetFileByID(string ID)
    {
        try
        {
            // Get the object from the db
                Ent ent = Biz.GetPatientsByID(ID);
               // Convert the path to byte array (imagepath is something like: \\mysharedfolder\myimage.jpg
                byte[] doc = EFile.ConvertToByteArray(ent.ImagePath);
                string mimeType = File(doc, MimeMapping.GetMimeMapping(Path.GetFileName( ent.ImagePath))).ContentType;
                Response.AppendHeader("Content-Disposition", "inline; filename=" + Path.GetFileName(ent.ImagePath));
                return File(doc, mimeType);

        }
        catch (Exception ex)
        {

            throw ex;
        } 
```

}

在前端：

```
 <img id="ItemPreview" src="@Url.Action("GetFileByID","Patient", new {ID= Model.ID })" alt="" width="350" height="350" /> 
```

其中 Patient 是控制器名称。

# c - ncurses 是在 linux 的 C 程序中实现命令历史记录的好选择吗

> ID：10508791
> 
> 赞同：3
> 
> 时间：2012-05-09T01:39:38.290
> 
> 标签：c, linux, command, history, ncurses

我是一名学生，我正在学习一门课程，我的项目是使用 unix 套接字、线程或 epoll 等编写服务器。

然而，当客户端从用户那里获取他的输入时，我想更进一步，给它一些关于他过去给出的命令的记忆；就像 shell 或 gdb 一样。

我不知道该怎么做，你们能帮帮我吗？我将 ncurses 放在标题中是因为我怀疑我应该使用它，但我不知道如何使用，我以前从未使用过 ncurses。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T01:41:27.643

[GNU readline 库](http://www.gnu.org/s/readline/)提供了这个功能。

# jquery - 使用 jQuery 设置 DropDown 的 selectedIndex？

> ID：10508795
> 
> 赞同：1
> 
> 时间：2012-05-09T01:40:07.330
> 
> 标签：jquery

我正在尝试将下拉列表的索引设置为 0；如果用户取消选中示例中所示的复选框，但有些人只是忽略了......

```
$ddlHeader.attr('selectedIndex', 0); 
```

[http://jsfiddle.net/abuhamzah/9YM4P/](http://jsfiddle.net/abuhamzah/9YM4P/)

//html:

```
Header:
<br /><input id="check" type="checkbox" name="approve" />
<select id="myddl" name="myddl">
    <option value="0">select me</option>
    <option value="1">One</option>
    <option value="2">Twooo</option>
    <option value="3">Three</option>
</select> 
```

​</p>

//js

```
var $ddls = $('select');
var $check = $('#check');
var $ddlHeader = $("#myddl"); 

$ddls.prop("disabled", true); 

$check .click(function() {
    $ddls.prop("disabled", true); 
    $ddlHeader.prop("disabled", !this.checked);
    $ddlHeader.attr('selectedIndex', 0);

}); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-09T01:42:21.020

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-09T01:42:36.707

`.prop`像下面这样使用，

```
$ddlHeader.prop('selectedIndex', 0); 
```

[更新的小提琴](http://jsfiddle.net/9YM4P/2/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-09T01:42:23.983

**更新**：

我感到困惑`selectedIndex`和重视。因此，仅当您明确希望选择 value = 0 时，此解决方案才有效：

`val(0)`改为使用

```
$check.click(function() {
    $ddls.prop("disabled", true); 
    $ddlHeader.prop("disabled", !this.checked);
    $ddlHeader.val(0);
}); 
```

[http://jsfiddle.net/9YM4P/1/](http://jsfiddle.net/9YM4P/1/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-10-13T16:54:29.270

//这行代码对我有用。 `$(function(){$("select").each(function (i) { $(this).prop("selectedIndex", 0); }); });`

# c++ - 像 ENet 这样的库，但对于 TCP？

> ID：10508797
> 
> 赞同：6
> 
> 时间：2012-05-09T01:40:15.313
> 
> 标签：c++, c, api, network-programming

我不打算使用 boost::asio，它对我的​​需求来说过于复杂。

我正在为桌面、iPhone 和 Android 构建一个跨平台的游戏。

我找到了一个名为 ENet 的库，这正是我所需要的，但它使用了似乎不支持加密和其他一些东西的 UDP。鉴于该游戏是一个事件驱动的纸牌游戏，TCP 似乎是合适的选择。

但是，我发现的只是 WINSOCK / berkley 套接字和 bost::asio。

这是一个带有 ENet 的示例客户端服务器应用程序：

```
#include <enet/enet.h>
#include <stdlib.h>
#include <string>
#include <iostream>

class Host
{
    ENetAddress address;
    ENetHost * server;
    ENetHost* client;
    ENetEvent event;
public:
    Host()
        :server(NULL)
    {
        enet_initialize();
        setupServer();
    }

    void setupServer()
    {
        if(server)
        {
            enet_host_destroy(server);
            server = NULL;
        }

        address.host = ENET_HOST_ANY;
        /* Bind the server to port 1234\. */
        address.port = 1721;

        server = enet_host_create (& address /* the address to bind the server host to */, 
            32      /* allow up to 32 clients and/or outgoing connections */,
            2      /* allow up to 2 channels to be used, 0 and 1 */,
            0      /* assume any amount of incoming bandwidth */,
            0      /* assume any amount of outgoing bandwidth */);

    }

     void daLoop()
     {
         while(true)
         {
             /* Wait up to 1000 milliseconds for an event. */
             while (enet_host_service (server, & event, 5000) > 0)
             {
                 ENetPacket * packet;

                 switch (event.type)
                 {
                 case ENET_EVENT_TYPE_CONNECT:
                     printf ("A new client connected from %x:%u.\n", 
                         event.peer -> address.host,
                         event.peer -> address.port);

                     /* Store any relevant client information here. */
                     event.peer -> data = "Client information";

                     /* Create a reliable packet of size 7 containing "packet\0" */
                     packet = enet_packet_create ("packet", 
                         strlen ("packet") + 1, 
                         ENET_PACKET_FLAG_RELIABLE);

                     /* Extend the packet so and append the string "foo", so it now */
                     /* contains "packetfoo\0"                                      */
                     enet_packet_resize (packet, strlen ("packetfoo") + 1);
                     strcpy ((char*)& packet -> data [strlen ("packet")], "foo");

                     /* Send the packet to the peer over channel id 0\. */
                     /* One could also broadcast the packet by         */
                     /* enet_host_broadcast (host, 0, packet);         */
                     enet_peer_send (event.peer, 0, packet);
                     /* One could just use enet_host_service() instead. */
                     enet_host_flush (server);

                     break;

                 case ENET_EVENT_TYPE_RECEIVE:
                     printf ("A packet of length %u containing %s was received from %s on channel %u.\n",
                         event.packet -> dataLength,
                         event.packet -> data,
                         event.peer -> data,
                         event.channelID);

                     /* Clean up the packet now that we're done using it. */
                     enet_packet_destroy (event.packet);

                     break;

                 case ENET_EVENT_TYPE_DISCONNECT:
                     printf ("%s disconected.\n", event.peer -> data);

                     /* Reset the peer's client information. */

                     event.peer -> data = NULL;
                 }
             }
         }

     }

        ~Host()
    {
        if(server)
        {
            enet_host_destroy(server);
            server = NULL;
        }

        atexit (enet_deinitialize);
    }
};

class Client
{
    ENetAddress address;
    ENetEvent event;
    ENetPeer *peer;
    ENetHost* client;
public:
    Client()
        :peer(NULL)
    {
        enet_initialize();
        setupPeer();
    }

    void setupPeer()
    {

        client = enet_host_create (NULL /* create a client host */,
            1 /* only allow 1 outgoing connection */,
            2 /* allow up 2 channels to be used, 0 and 1 */,
            57600 / 8 /* 56K modem with 56 Kbps downstream bandwidth */,
            14400 / 8 /* 56K modem with 14 Kbps upstream bandwidth */);

        if (client == NULL)
        {
            fprintf (stderr, 
                "An error occurred while trying to create an ENet client host.\n");
            exit (EXIT_FAILURE);
        }

        /* Connect to some.server.net:1234\. */
        enet_address_set_host (& address, "192.168.2.13");
        address.port = 1721;

        /* Initiate the connection, allocating the two channels 0 and 1\. */
        peer = enet_host_connect (client, & address, 2, 0);    

        if (peer == NULL)
        {
            fprintf (stderr, 
                "No available peers for initiating an ENet connection.\n");
            exit (EXIT_FAILURE);
        }

        /* Wait up to 5 seconds for the connection attempt to succeed. */
        if (enet_host_service (client, & event, 20000) > 0 &&
            event.type == ENET_EVENT_TYPE_CONNECT)
        {
            std::cout << "Connection to some.server.net:1234 succeeded." << std::endl;
        }
        else
        {
            /* Either the 5 seconds are up or a disconnect event was */
            /* received. Reset the peer in the event the 5 seconds   */
            /* had run out without any significant event.            */
            enet_peer_reset (peer);

            puts ("Connection to some.server.net:1234 failed.");
        }
    }

    void daLoop()
    {
        ENetPacket* packet;

        /* Create a reliable packet of size 7 containing "packet\0" */
        packet = enet_packet_create ("backet", 
            strlen ("backet") + 1, 
            ENET_PACKET_FLAG_RELIABLE);

        /* Extend the packet so and append the string "foo", so it now */
        /* contains "packetfoo\0"                                      */
        enet_packet_resize (packet, strlen ("backetfoo") + 1);
        strcpy ((char*)& packet -> data [strlen ("backet")], "foo");

        /* Send the packet to the peer over channel id 0\. */
        /* One could also broadcast the packet by         */
        /* enet_host_broadcast (host, 0, packet);         */
        enet_peer_send (event.peer, 0, packet);
        /* One could just use enet_host_service() instead. */
        enet_host_flush (client);

        while(true)
        {
            /* Wait up to 1000 milliseconds for an event. */
            while (enet_host_service (client, & event, 1000) > 0)
            {
                ENetPacket * packet;

                switch (event.type)
                {
                case ENET_EVENT_TYPE_RECEIVE:
                    printf ("A packet of length %u containing %s was received from %s on channel %u.\n",
                        event.packet -> dataLength,
                        event.packet -> data,
                        event.peer -> data,
                        event.channelID);

                    /* Clean up the packet now that we're done using it. */
                    enet_packet_destroy (event.packet);

                    break;
                }
            }
        }
    }
    ~Client()
    {
        atexit (enet_deinitialize);
    }
};

int main()
{
    std::string a;
    std::cin >> a;
    if(a == "host")
    {
        Host host;
        host.daLoop();
    }
    else
    {
        Client c;
        c.daLoop();
    }

    return 0;
} 
```

我查看了一些套接字教程，它们似乎有点太低级了。

我只需要抽象出平台的东西（例如，没有 WINSOCKS）并且具有跟踪连接的客户端并向它们发送消息的基本能力。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-05T19:19:28.453

一个迟到的回复，但也许它会帮助别人。

加密是高级功能。TCP 和 UDP 本身不支持加密。它们都是低级协议。实际上，与 UDP 相比，我们可以说 TCP 是一个更高级别的协议，因为 TCP 包含一些可能有用的高级功能......或没有，这取决于将使用它的项目。

ENet 很好，因为它提供了两全其美的好处——TCP 的可靠性和 UDP 的自由和轻量级。ENet 在内部只使用 UDP 而不是 TCP，这并没有错，因为 ENet 能够提供 TCP 所做的几乎所有事情，甚至更多。

如果您希望进行加密，则必须自己添加，无论您选择 TCP、UDP 还是 ENet。所以我建议你继续使用 ENet，如果你觉得舒服的话，当你启动并运行你的游戏时，你可以添加任何你想要的加密算法，只要你为客户端和服务器选择相同的算法。您可以选择一个 3rd 方加密库，然后通过它传递您的网络数据包。ENet 不关心通过它发送什么数据。

也许以下文章将对 ENet 有所帮助：

[使用 ENet 进行网络编程 作者：Mike Diehl](http://www.linuxjournal.com/content/network-programming-enet?page=0,0)

并查看以下有关小型网络数据包加密的 Stackoverflow 主题：

[加密连续/小型 UDP 数据的最佳实践](https://stackoverflow.com/questions/3040123/best-practices-for-encrypting-continuous-small-udp-data)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-05T21:20:14.520

我[听说](http://www.youtube.com/watch?v=YlOybQV8cGk)Mordor 有一个 SSL 层，可用于网络加密。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-20T21:35:34.223

clsocket 是一个很棒的小 TCP 库，允许开源许可证，Windows、Mac OSX、Linux：

[https://github.com/DFHack/clsocket](https://github.com/DFHack/clsocket)

# entity-framework - 有没有办法先更改数据库中的连接字符串？

> ID：10508798
> 
> 赞同：15
> 
> 时间：2012-05-09T01:40:19.310
> 
> 标签：entity-framework, database-first

我有几个数据库，它们的架构是相同的。当我使用数据库优先时，连接字符串是在我创建 edmx 文件时指定的。我想知道，有没有办法改变连接字符串？这是，所以我可以选择操作哪个数据库。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2014-05-07T21:01:38.907

我们不在 web.configs 中存储连接字符串，因此接受的解决方案对我们不起作用。如果您只是尝试通过基本 DbContext 构造函数提供连接字符串，您将收到以下异常：

> 如果在 Code First 模式下使用，使用用于 Database First 和 Model First 开发的 T4 模板生成的代码可能无法正常工作。要继续使用 Database First 或 Model First，请确保在执行应用程序的配置文件中指定了实体框架连接字符串。要使用从 Database First 或 Model First 生成的这些类，使用 Code First 添加使用属性或 DbModelBuilder API 的任何其他配置，然后删除引发此异常的代码。

要解决此问题，请按如下方式创建上下文的部分类，并使用附加的 EF 元数据格式化连接字符串（其中 MyContext 是您的~~语境~~型号名称（例如，您的型号名称是 MyModel.edmx，`MyContext`下面的代码将替换为`MyModel`所有三个扩展名 .csdl、.ssdl、.msl））：

```
public partial class MyContext
{
    public MyContext(string connStr)
        : base(string.Format(@"metadata=res://*/MyContext.csdl|res://*/MyContext.ssdl|res://*/MyContext.msl;provider=System.Data.SqlClient;provider connection string='{0}'", connStr))
    {
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T02:52:58.897

更改 web.config 文件中的连接字符串。

```
 <connectionStrings>
    <add name="SandBoxEntities" connectionString="metadata=r... />
  </connectionStrings> 
```

我缩写了实际的连接字符串，因为它并不重要——只是想让您了解在 web.config 文件中要查找的内容。

您还可以以编程方式更改连接字符串。查看[示例 16.2。以编程方式修改 EntityConnectionString](http://msdn.microsoft.com/en-us/library/orm-9780596520281-01-16.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-19T09:45:07.850

您可以在 web.config 中定义多个连接字符串，然后在您的代码中使用它们，也许是您的工作。例如：`

```
<connectionStrings>
  <add name="conStr1" connectionString="metadata=r... />
</connectionStrings>`

<connectionStrings>
  <add name="conStr2" connectionString="metadata=r... />
</connectionStrings>` 
```

等等

并且您的上下文类构造函数获取连接字符串名称作为参数：

```
 public MyContext(string connStr)
    :  base(connStr)    {    } 
```

好的。现在您可以在代码中使用如下：

```
using (var db = new MyContext("name=conStr1"))
{
  //your code here
} 
```

接着

```
using (var db = new MyContext("name=conStr2"))
{
   //your code here
} 
```

# java - Java 类路径 NoClassDefFoundError

> ID：10508799
> 
> 赞同：0
> 
> 时间：2012-05-09T01:40:29.217
> 
> 标签：java, jar

我正在尝试运行 testjar.jar ，这取决于驻留在 wsc-22.jar 中的 ConnectionException 类

两个jar都在同一个文件夹中。

波纹管命令有什么问题..？（它在 Eclipse 中运行良好，我刚刚导出到 testjar.jar 中）

谢谢 ..

```
lib > java -cp ./wsc-22.jar  -jar testjar.jar 
Exception in thread "main" java.lang.NoClassDefFoundError: com/sforce/ws/ConnectionException
Caused by: java.lang.ClassNotFoundException: com.sforce.ws.ConnectionException 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T01:46:31.860

您不能将 -cp（或 -classpath）与 -jar 一起使用

做`java -cp ./wsc-22.jar;testjar.jar my.package.Main`

相应地替换上述内容

另一种选择是在 testjar.jar 清单文件中添加 wsc-22.jar。

例如在 testjar.jar 中：

**清单文件**

```
Manifest-Version: 1.0  
Main-Class: my.path.to.the.main.Application  
Class-Path: wsc-22.jar 
```

# php - PHP Preg 表达式从字符串中删除 html 标签和内部内容？

> ID：10508801
> 
> 赞同：3
> 
> 时间：2012-05-09T01:40:59.273
> 
> 标签：php, preg-replace, expression

快速提问。

我想从以下字符串中删除 sup 标记，以及其中的所有内容。

```
$string = "Priority Mail<sup>&reg;</sup> International"; 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-09T01:43:48.203

我想这样的事情会起作用：

```
preg_replace("(<([a-z]+)>.*?</\\1>)is","",$input); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T01:44:00.993

```
$string = preg_replace ("/<sup>(.*?)<\/sup>/i", "", $string); 
```

你应该知道 (.*?) 不能处理 \n 或 \r，所以先过滤它们。

# char - 处理：用不间断空格替换空格

> ID：10508802
> 
> 赞同：0
> 
> 时间：2012-05-09T01:41:07.563
> 
> 标签：char, processing, space

在处理 1.5.1 中使用此代码时，我不断收到“格式错误的字符常量”错误。我想用字符串中的不间断空格替换所有空格。任何帮助，将不胜感激。

```
 String newStr;
    String S = "Hello there world"
    char c = '\u00A0';
    newStr = S.replace(' ', c); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T01:33:39.950

处理指示 unicode 不带引号并带有前缀 0x
试试这个：

```
String newStr;
String S = "Hello there world"
char c = 0x00A0;
newStr = S.replace(' ', c); 
```

# asp.net-mvc - 我的视图不会与 MVC 中的模型绑定

> ID：10508803
> 
> 赞同：0
> 
> 时间：2012-05-09T01:41:10.510
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我有以下视图模型：

```
 public class CityViewModel
    {
        public CityViewModel() {     
            CityDetails = Enumerable.Range(1,2).Select(x => new CityDetail()).ToList(); 
        } 

        public City City { get; set; }
        public IList<CityDetail> CityDetails { get; set; }

        public class CityDetail
        {
            public CityDetail() {
                Correct = true;
            }
            public bool   Correct { get; set; }
        } 
```

在我看来，我有以下几点：

```
 @foreach (int index in Enumerable.Range(0, Model.CityDetails.Count()))
        {
        <input type="hidden" name="CityDetails[@index]_Correct)" value="false" />
        <input type="checkbox" id="CityValid" name="CityDetails[@index]_Correct" value='@Model.CityDetails[index].Correct' /> 
```

对于名为“正确”的字段，我无法从视图到模型的任何绑定，所以我想知道我使用的命名。有谁知道可能出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T02:47:46.633

映射集合的简单和最佳方法是使用索引器。使用以下代码片段

```
 @for (int i = 0; i < Model.CityDetails.Count; i++)
 {
    @Html.EditorFor(x => Model.CityDetails[i].Correct)
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T02:00:27.853

您的视图没有必要看起来像那样。创建一个编辑器模板，然后使用 Html.EditorFor(x => x.CityDetails)。这将处理枚举集合并正确写出元素，以便它们映射回列表。

# java - Ant：重命名同名子目录

> ID：10508805
> 
> 赞同：1
> 
> 时间：2012-05-09T01:41:21.497
> 
> 标签：java, ant, rename

假设我有一个这样的目录结构：

*   动物/狗/细节
*   动物/猫/细节
*   动物/青蛙/细节
*   动物/马/细节

使用 ant，我想将 call 下的所有子目录重命名`animals`为`details`named `new`。所以结果是这样的：

*   动物/狗/新
*   动物/猫/新
*   动物/青蛙/新
*   动物/马/新

我试过这样的事情：

```
 <move tofile="new">
        <path id="directories.to.rename">
            <dirset dir="animals">
                <include name="**/details"/>
            </dirset>
        </path>
    </move> 
```

但是得到这个错误：

```
Cannot concatenate multiple files into a single file. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T07:46:40.260

您可以通过[mapper](http://ant.apache.org/manual/Types/mapper.html)执行您描述的重命名。例如：

```
<move todir="animals">
    <dirset dir="animals" includes="**/details" />
    <globmapper from="*/details" to="*/new"/>
</move> 
```

*[`move`（任务文档](http://ant.apache.org/manual/Tasks/move.html)末尾有一个类似的示例。）*

您看到的错误是因为您将移动任务（tofile）的单文件模式与多文件模式混合在一起。由于任务接受任何基于文件`dirset`的资源集合，包括.`path``move``dirset`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T01:48:14.940

使用[Ant-Contrib](http://ant-contrib.sourceforge.net/tasks/tasks/index.html)的`for`任务和`propertyregex`任务。

```
<target name="test">
  <for param="detailsDir">
    <dirset dir="animals">
      <include name="**/details"/>
    </dirset>
    <sequential>
      <propertyregex property="output.dir" input="@{detailsDir}" regexp="(.*)/details" replace="\1" />
      <move file="@{detailsDir}" toFile="${output.dir}/new" />
    </sequential>
  </for>
</target> 
```

# ruby-on-rails - 如何使用 Rack::URLMap 和 Rack::Cascade 在 Rails 2.3 中挂载 Resque

> ID：10508809
> 
> 赞同：2
> 
> 时间：2012-05-09T01:41:28.137
> 
> 标签：ruby-on-rails, rack, resque

我一直在运行带有 rackup config.ru 文件的 rails 2.3 应用程序来加载一些葡萄 API 中间件。

我最近需要运行一个 resque 服务器。

我的 config.ru 是这样设置的。

```
require File.dirname(__FILE__) + '/config/environment'

my_app = Rack::Builder.new do
 use Rails::Rack::LogTailer #optional
 use Rails::Rack::Static # optional
 run ActionController::Dispatcher.new
end

Resque::Server.class_eval do
  use Rack::Auth::Basic do |user, password|
    begin
      if user == "admin" and password == "bandana"
        true
      else
        false
      end
    end 
  end

end

run Rack::URLMap.new([
  "/" => my_app,
  "/resque" => Resque::Server.new
])

run Rack::Cascade.new([
  GrapeAPI_entry_1,
  GrapeAPI_entry_2,
  my_app
]) 
```

这并没有给我想要的效果，我不知道为什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-19T01:56:38.840

我真的找到了答案。原来redis没有运行，是的，可以使用cascade with map

我最终的 config.ru 看起来像这样。

```
re File.dirname(__FILE__) + '/config/environment'
require 'resque/server'

my_app = Rack::Builder.new do
 use Rails::Rack::LogTailer #optional
 use Rails::Rack::Static # optional
 run ActionController::Dispatcher.new
end

Resque::Server.class_eval do
  use Rack::Auth::Basic do |user, password|
    begin
      if user == "admin" and password == "bandana"
        true
      else
        false
      end
    end 
  end

end

app = Rack::Builder.new {
  use Rails::Rack::Static

  map "/resque" do
    run Resque::Server
  end

  map "/" do
    run my_app
  end
}.to_app

run Rack::Cascade.new([
  Grape_API_1,
  Grape_API_2,
  my_app
]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T04:06:04.337

我最近在我的一个 Rails 服务器上添加了对 resque 的类似访问。效果很好——我是这样做的：

```
# This file is used by Rack-based servers to start the application.
require ::File.expand_path('../config/environment',  __FILE__)
require 'resque/server'

run Rack::URLMap.new \
  "/"       => MyApp::Application,
  "/resque" => Resque::Server.new 
```

但是，我的应用程序基于 rails 3.2。我不确定您正在运行的机架版本有什么区别。

您是否需要 resque 服务器代码？

# gtk - 找出当前选择的 gtk 小部件

> ID：10508810
> 
> 赞同：5
> 
> 时间：2012-05-09T01:41:41.867
> 
> 标签：gtk, selection, gtkentry

我有一组`GtkEntry`小部件，其中一些是可编辑和可聚焦的，而有些则不是。我想找出其中哪些（如果有的话）当前选择了文本，以实现 Edit->Copy 菜单项。除了遍历所有小部件直到`gtk_editable_get_selection_bounds`返回 true 之外，还有什么方法可以做到这一点？

我目前正在通过调用来回避这个问题，`gtk_clipboard_get(GDK_SELECTION_PRIMARY)`但根据文档所说，这是不可移植的（并且还会在当前显示的任何位置选择文本，而不仅仅是从我的应用程序中）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T05:03:10.023

Have you tried `gtk_window_get_focus ()`? Users are frequently interacting with entries, so it may work for you. The documentation says that it "retrieves the current focused widget within the window." You can look it by yourself [here](http://developer.gnome.org/gtk/stable/GtkWindow.html#gtk-window-get-focus). Then, compare if the widget retrieved is one of your entries.

Once you get the focused entry, perhaps you would like to get its text using [gtk_entry_get_text ()](http://developer.gnome.org/gtk/stable/GtkEntry.html#gtk-entry-get-text) , though, it will get all the text in the entry. If this does not fit your purposes, the solution might be using [gtk_editable_copy_clipboard ()](http://developer.gnome.org/gtk/stable/GtkEditable.html#gtk-editable-copy-clipboard) which copies the contents of the currently selected content in the editable (of course, cast the entry to editable) and puts it on the clipboard. Then if it applies, paste what was copied using [gtk_editable_paste_clipboard ()](http://developer.gnome.org/gtk/stable/GtkEditable.html#gtk-editable-paste-clipboard).

# routing - 在 Symfony2 中调试路由

> ID：10508812
> 
> 赞同：5
> 
> 时间：2012-05-09T01:42:12.227
> 
> 标签：routing, symfony

我无法弄清楚Symfony2 路由 YML 文件中的单个*路由有什么问题。*其他每条路线都运行良好（我已经有几十条了），但这条路线拒绝被识别。

这是我的 YML 文件的相关剪辑：

```
ProjectMainBundle_util_initUpload:
    pattern:  /util/initUpload
    defaults: { _controller: ProjectMainBundle:Utilities:initUpload }
    requirements:
        _method:  POST

ProjectMainBundle_util_init:
    pattern:  /util/init
    defaults: { _controller: ProjectMainBundle:Utilities:initUtilities }
    requirements:
        _method:  POST

ProjectMainBundle_util_download:
    pattern:  /util/download
    defaults: { _controller: ProjectMainBundle:Utilities:download }
    requirements:
        _method:  GET 
```

第一个路由“/util/initUpload”返回“未**找到“POST /util/initUpload”**错误的路由。我尝试将块放置在不同的位置（甚至将其移动到“/util/init”上方。）“/”索引路由位于我的 routing.yml 文档的末尾，所以这不应该是问题。上面的路由是唯一格式为 /util/* 的路由。

该路由用于处理表单和文件上传，但我认为这并不重要。我已经删除了 POST 要求并直接在浏览器中对其进行了测试，但这仍然给了我同样的错误。camelCase 应该不是问题。我有其他这种格式的路线工作得很好......

我还缺少什么？关于如何调试这个的任何建议？我的下一步是废弃 YML 文件并使用 php 格式重写，尽管我真的不想这样做..

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-09T03:28:54.407

有一个命令可以列出您的所有路线：

**对于 Symfony 2.x** -

```
app/console router:debug 
```

**对于 Symfony 3.x 及更高版本**-

```
bin/console debug:router 
```

如果您在那里看不到您的路线，请先尝试清除缓存。如果没有帮助，请删除路线定义并手动重新键入 - 不要复制/粘贴。

PS 它与 YAML/PHP 无关。

# java - Playn - 是否可以在 Apache 服务器上部署？

> ID：10508817
> 
> 赞同：0
> 
> 时间：2012-05-09T01:42:39.780
> 
> 标签：java, gwt, playn

我知道它是一个 GWT，但如果它编译为 Javascript，假设我没有任何后端通信，生成的 html 模块是否可以编译为我可以将其部署在 Apache 上的包装？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T02:03:07.407

是的。这基本上就是我对[这个问题](https://stackoverflow.com/q/10203455/1093087)的理解。对于 HTML 端口，您实际上是在构建一个 GWT 应用程序，它只是一个托管一堆巧妙混淆的 Javascript 的 HTML 页面。

您可以在此处找到相关的 Google 文档：

*   [如何更改我的缓存/无缓存 HTML 文件的位置？](https://developers.google.com/web-toolkit/doc/latest/FAQ_DebuggingAndCompiling#How_do_I_change_the_location_of_my_cache/nocache_HTML_files?)

# java - Java井字游戏：转换字符串以检查二维数组中的值

> ID：10508818
> 
> 赞同：1
> 
> 时间：2012-05-09T01:42:43.103
> 
> 标签：java, tic-tac-toe

我正在创建一个简单的井字游戏。我使用单个空格字符初始化了我的 3x3 板。

```
private char[][] board;
private char player; // 'X' or 'O'

public TicTacToe() {
 for(int i = 0; i < 3; i++)
   {
     for(int j = 0; j <3; j++)
     {
       board[i][j] = ' ';
     }
   }
 player = 'X';
 } 
```

我要求用户输入坐标，如下所示：

```
 1  2  3
A |  |  |  |
B |  |  |  |
C |  |  |  | 
```

因此，如果 X 进入 B2，O 进入 A3，则棋盘将如下所示：

```
 1  2  3
A |  |  |O |
B |  | X|  |
C |  |  |  | 
```

现在，我正在尝试编写一个方法来检查当前玩家的移动是否有效。

问题： **如何转换用户字符串输入 (A=1,B=2,C=3) 以便查看 board[x][y] 是否包含 ' ' 字符？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T01:52:44.043

您可以使用[`String.charAt(int)`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#charAt%28int%29)从字符串中的任何点获取字符。请注意，与数组一样，字符串中的第一个字符是索引 0，而不是 1。

然后，您可以将它们转换为索引，如下所示：

```
input = input.toUpperCase(); // Makes code work for all cases
int x = input.charAt(0) - 'A';
int y = input.charAt(1) - '1';
char currentValue = board[x][y]; 
```

之后，`currentValue`将包含当前在该位置的游戏板上的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T01:59:24.310

你可以简单地检查一下。因为你只有 3 个选项，你可以做这样的事情：

```
int row = input.charAt(0);
int col = input.charAt(1) - 1;

if(row == 'A')
    row = 0;
else if(row == 'B')
    row = 1;
else if(row == 'C')
    row = 2; 
```

现在你可以得到协调

```
if(board[row][col]).equals("X") {
....
}
else if(board[row][col]).equals("O") {
...
}
else {
...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T02:01:24.640

我喜欢 Jake King 的解决方案，它非常简短优雅，但在我的偏好中，它不是“通过查看可调试”

我会做这样的事情，在我个人看来，这更明确

```
 Map<Character, Integer> rowMap = new HashMap<Character, Integer>();
    rowMap.put('A', 0);
    rowMap.put('B', 1);
    rowMap.put('C', 3);

    // Validations of input come here first...

    int row = rowMap.get(input.charAt(0));
    int col = Character.getNumericValue(input.charAt(1))-1;

    char place = board[row][col]; 

    if(place!=' '){
        throw new RuntimeException("Place is not empty");
    } 
```

# php - 更新一组用户 id

> ID：10508820
> 
> 赞同：0
> 
> 时间：2012-05-09T01:42:55.537
> 
> 标签：php, mysql, sql

我有一长串用户信息（用户名、用户名、密码和级别） 现在我希望更新大量用户的级别，但我不想通过单个命令为每个用户执行此操作。有没有办法一次更新所有这些？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T01:44:31.800

在您的语句中使用 MySQL 的[`IN()`](http://dev.mysql.com/doc/refman/5.1/en/comparison-operators.html#function_in)函数`WHERE`来包含您希望更新的所有 ID。

```
UPDATE users
   SET level=1
 WHERE id IN(1,2,3,4,5); 
```

或者，如果每个人在列中共享一个共同的唯一值，您可以使用它来代替。例如，如果您想将级别 1 的每个人更新到级别 2：

```
UPDATE users
   SET level=2
 WHERE level=1; 
```

# ruby-on-rails-3 - Simple_form 覆盖输入和 textarea 类

> ID：10508824
> 
> 赞同：3
> 
> 时间：2012-05-09T01:43:38.913
> 
> 标签：ruby-on-rails-3, simple-form

是否可以将输入和 textarea 上的默认“字符串”类更改为我自己可以选择的默认类？

我的意思是在我的 simple_form.rb 初始化程序中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T04:05:00.400

是的你可以。
请参阅简单表单 gem 的自述文件的[自定义输入部分](https://github.com/plataformatec/simple_form#custom-inputs)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-21T19:16:27.860

根据 gem 的最新版本，您可以在初始化程序中通过键入来更改它，`config.input_class = 'your-class'`但这会影响所有表单输入字段类。

# string - Python 2.7 中的 str 对象没有 __iter__，但它的行为就像是可迭代的。为什么？

> ID：10508825
> 
> 赞同：8
> 
> 时间：2012-05-09T01:43:43.943
> 
> 标签：string, iterator, python-2.7

我正在检查 Python 中的 str 对象，我意识到 Python 2.7 中的 str 对象既没有`__iter__()`方法也没有`next()`方法，而在 Python 3.0 中 str 对象有`__iter__()`方法，因此它们是可迭代的。但是，我仍然可以使用 str 对象，就好像它们在 Python 2.7 中是可迭代的一样。例如，我可以在 for 循环中使用它们。这是如何运作的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-09T04:23:35.967

简单的答案：因为`iter(s)`返回一个可迭代的对象。

更长的答案：`iter()`寻找一种`__iter__()`方法，但如果找不到，它会尝试自己构造和迭代器。任何支持`__getitem__()`从 0 开始的整数索引的对象都可以用来创建一个简单的迭代器。`__getitem__()`是列表/字符串索引操作背后的函数，例如`s[0]`.

```
>>> "abc".__iter__()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'str' object has no attribute '__iter__'
>>> iter("abc")
<iterator object at 0x1004ad790>
>>> iter("abc").next()
'a' 
```

有关详细信息，请参见[此处](http://docs.python.org/library/functions.html#iter)。

# cordova - 将 ActivityIndi cator 添加到我的应用程序

> ID：10508830
> 
> 赞同：0
> 
> 时间：2012-05-09T01:44:20.543
> 
> 标签：cordova, sencha-touch, extjs, sencha-touch-2

我有以下代码。我 a=在名为 images 的文件夹中添加了一张图片。但是没有弹出消息框。

```
Ext.MessageBox.show({
                                   title: 'Message',
                                   msg: '<img src="/images/spinner.gif" border="0" align="absmiddle">&nbsp;Wait a minute.',
                                   closable: false
                                   }); 
```

背景应该是透明的，就像 MBProgressHud 一样。我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T08:18:10.917

我在您的代码中发现了三个简单的错误。对我来说，这很好用：

```
Ext.**Msg**.show({
                         title: 'Message',
                         **message**: '<img src="**images**/spinner.gif" border="0" align="absmiddle">&nbsp;Wait a minute.',
                         closable: false
}); 
```

总结一下，使用：

*   Ext.Msg.show 而不是 Ext.MessageBox.show
*   'message' 属性而不是 'msg' 属性
*   src="images/spinner.gif" 而不是 src="/images/spinner.gif"

# django - 将 cakephp 应用程序迁移到 django

> ID：10508832
> 
> 赞同：0
> 
> 时间：2012-05-09T01:44:47.780
> 
> 标签：django, cakephp

我有一个 cakephp 应用程序，它有一个用户数据库，目前有大约 50 个用户。

我想知道在不影响用户的情况下将应用程序迁移到 django 的最佳方法是什么。

我很担心，因为密码当然都是加密的，而且很可能在 django 中加密不会相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T10:07:18.870

最简单的方法是在新应用程序中创建具有随机密码的用户，然后在切换时向他们发送带有登录链接的邀请。看看这个应用程序：[https](https://github.com/fajran/django-loginurl) ://github.com/fajran/django-loginurl 然后让用户在第一次登录时选择密码。

第二种方式，不太好 - 但是如果您不想再次询问密码并且您没有办法解密现有的密码：修改您现有的应用程序以发送用户名和密码（采取从现有的登录表单 - 所以你有明文）到新的后端。然后将配置文件从旧应用程序拉到新应用程序并创建/迁移用户配置文件。

# java - AsyncTask 中的确认对话框（警报）

> ID：10508834
> 
> 赞同：0
> 
> 时间：2012-05-09T01:45:01.727
> 
> 标签：java, android

我在 AsyncTask 内部运行了一个很长的过程，但它可能需要在处理时确认用户的某些内容。我知道如何显示确认对话框，但如何检索输出并等待使用确认？

```
this.runOnUiThread(new Runnable() {
            public void run() {
               boolean output = ConfirmUser(message);
            }
        }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T02:13:34.780

我会说这是个坏主意。如果您需要用户的确认，最好将 AsyncTask 分成两部分：先做一些部分，然后在*onPostExecute()*中显示对话框（因为它在 ui 线程上运行），并根据用户操作启动第二个 AsyncTask .

如果你仍然想做一个 AsyncTask，你可以这样做：

```
final BlockingQueue<Boolean> queue = new ArrayBlockingQueue<Boolean>(1);
this.runOnUiThread(new Runnable() {
    public void run() {
        // Assuming you have ConfirmUser method which returns boolean
        queue.add(ConfirmUser(message));
    }
});

Boolean result = null;
try {
    // This will block until something will be added to the queue
    result = queue.take();
} catch (InterruptedException e) {
    // deal with it
} 
```

# php - 基于登录状态 PHP 的条件显示链接

> ID：10508838
> 
> 赞同：0
> 
> 时间：2012-05-09T01:45:30.603
> 
> 标签：php, mysql, login

我有一个有 200 名成员的小网站。下面是登录/注销链接的代码，登录时显示“更改密码”、“报告”和“注销”链接。未登录时，会显示“登录”和“忘记密码”链接。

最近我们举办了一场有 14 名获胜者的比赛，我想要实现的是在代码中添加一个链接，只有 14 名获胜者才能看到，其余成员看不到。

我不太确定从哪里开始，是否可以在此代码中为 14 个用户 ID/电子邮件地址设置一个条件，或者我最好将一个新字段放入用户的数据库中？任何帮助或推动正确的方向将不胜感激！

```
 <?php # loginnav.php> 

     // Display links based upon the login status. 

     // Show LOGIN links if this is the LOGOUT page. 

      if (isset($_SESSION['user_id']) 
      AND (substr($_SERVER['PHP_SELF'], -10) 
      !='logout.php')) 

      { echo 
      '<li><a href="logout.php">Logout</a></li>
       <li><a href="change_password.php">Change Password</a></li> 
       <li><a href="report.php">Report</a></li>  
     '; } else { 

     // Not logged in.   
     echo 
     ' <li><a href="login.php">Login</a></li> 
     <li><a href="forgot_password.php">Forgot Password?</a></li> 
      '; } ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T01:57:24.373

您可以简单地将获胜者的 id 放入 中`array`，然后检查用户 id 是否在该数组中以显示链接。

```
$winners = array(1, 2, 3, 4, 5);

if (in_array($id, $winners))
{
    echo "link";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T02:02:05.917

```
 $winners_array = array('userid1', 'userid2', 'userid3', 'userid4', ...);  
          // This array contains users IDs who are winners
          // You can write it manualy right intj the login file, 
          //include it from external file or form from your Data Base

    if (isset($_SESSION['user_id']) 
      AND (substr($_SERVER['PHP_SELF'], -10) 
      !='logout.php')) 
      { 
      echo 
      '<li><a href="logout.php">Logout</a></li>
       <li><a href="change_password.php">Change Password</a></li> 
       <li><a href="report.php">Report</a></li>  
      '; 
      if(in_array($_SESSION['user_id'], $winners_array)){
         // If current ID is in winners list we add special link for him
         echo '<li><a href="winer_page.php">Winner link</a></li>';
      }
      } else { 
     // Not logged in.   
     echo 
     ' <li><a href="login.php">Login</a></li> 
     <li><a href="forgot_password.php">Forgot Password?</a></li> 
      '; } ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T02:01:30.410

一种选择是添加对用户 ID 的条件检查，如果它与您的 ID 列表匹配，则添加链接。这段代码的缺点是它是硬编码的，如果您计划将来有更多的比赛或其他特定成员独有的链接，它可能会成为维护问题。（你最终会得到几个这样的代码块）

首先将您的获胜者 ID 设置为一个数组，如下所示：

```
$winningIds = array(1,2,3,4,5,6,7,8,...); 
```

然后在`echo`您打印链接的块中执行以下操作：

```
if (in_array($_SESSION['user_id'], $winningIds))
{
     echo '<li><a href="newlink.php">New Link</a></li> ';
} 
```

编辑：我意识到我没有提到我在想的另一个选项，即在数据库中为每个用户存储一个“唯一”链接列表。然后在您的 echo 块之后，您将打印每个用户的唯一链接。

我设想这是两个额外的表。表 1 将是“链接”，将包含三列 - id、链接和显示文本。表 2 将是“user_links”并包含两列 - linkId 和 userId。

您将加入表格并拥有链接（这是您的`href`）并显示与 user_links 表相关联的文本显示。

# android - 如何在 Android 中修复这个 classnotfound 异常？

> ID：10508839
> 
> 赞同：1
> 
> 时间：2012-05-09T01:45:37.623
> 
> 标签：android, classnotfoundexception

我在 Android 开发者帐户中获得了下面的堆栈跟踪。此错误仅发生一次。

```
java.lang.RuntimeException: Unable to instantiate application com.mysite.myapp.TestApplication: java.lang.ClassNotFoundException: com.mysite.myapp.TestApplication in loader dalvik.system.PathClassLoader[/data/app-private/com.mysite.myapp-2.apk]
at android.app.LoadedApk.makeApplication(LoadedApk.java:466)
at android.app.ActivityThread.handleBindApplication(ActivityThread.java:3268)
at android.app.ActivityThread.access$2200(ActivityThread.java:117)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:973)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:130)
at android.app.ActivityThread.main(ActivityThread.java:3691)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:507)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:912)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:670)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.ClassNotFoundException: com.myapp.myapp.TestApplication in loader dalvik.system.PathClassLoader[/data/app-private/com.mysite.myapp-2.apk]
at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
at android.app.Instrumentation.newApplication(Instrumentation.java:945)
at android.app.LoadedApk.makeApplication(LoadedApk.java:461)
... 11 more 
```

在我的清单文件中，我声明了`com.mysite.myapp.TestApplication`. 我的清单文件如下所示：

```
<application
    android:name="com.mysite.myapp.TestApplication"
    android:icon="@drawable/app_icon"
    android:label="@string/app_name"
    android:theme="@style/Theme.myapp" >
    <activity
        android:name="com.mysite.myapp.ActivityDashboard"
        android:configChanges="orientation|keyboard"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T05:42:27.520

如果您的主页是 ActivityDashboard.java 插入如下，或者如果 TestApplication.java 将 .ActivityDashboard 替换为 .TestApplication 在活动标签中

```
<package name="com.mysite.myapp"
    <application
        android:name="TestApplication"
        android:icon="@drawable/app_icon"
        android:label="@string/app_name"
        android:theme="@style/Theme.myapp" >

        <activity android:name=".ActivityDashboard" android:configChanges="orientation|keyboard"
                android:label="@string/app_name" >
                <intent-filter>
                    <action android:name="android.intent.action.MAIN" />

                    <category android:name="android.intent.category.LAUNCHER" />
                </intent-filter>
            </activity>
    ......
    </application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T02:54:57.900

```
android:name="com.mysite.myapp.ActivityDashboard" 
```

将清单中的上述内容替换`thr`为以下内容。

```
 android:name=".ActivityDashboard" 
```

或者：

```
android:name="com.mysite.myapp.TestApplication.ActivityDashboard" 
```

# javascript - jQuery克隆元素并更改子元素的属性以保持它们的唯一性

> ID：10508840
> 
> 赞同：4
> 
> 时间：2012-05-09T01:45:42.023
> 
> 标签：javascript, jquery, attributes, clone, unique

我已经查看了一些类似问题的答案，但我并不完全理解这些答案。

我有一个表格，其中包含一些输入，如下所示...

```
<table class="form right 40 rewardclone_1">
<tr>        
<td><label for="financial_goal_1">Amount</label></td>
<td>Pledge <span class="dollar">&#36;</span><input id="financial_goal_1" class="text dollars" type="text" name="financial_goal_1" /> or more</td>
</tr>
<tr>
    <td><label for="maximum_1">Maximum</label></td>
<td><input id="maximum_1" class="text dollars" type="text" name="maximum_1" /> available (blank for unlimited)</td>
</tr>
<tr>
<td><label for="reward_1">Reward:</label></td>
<td><textarea id="reward_1" name="reward_1"></textarea></td>
</tr>
</table> 
```

我设法创建了一个按钮，单击该按钮可以克隆整个表格。

```
$('#add_reward').click(function() {         
  $('.rewardclone').clone().appendTo('#rewards_container');     
}); 
```

问题是我需要属性上的所有这些数字（reward_1、maximum_1 等）在每次克隆表时递增。

任何帮助将不胜感激！

jQuery 级别：初学者。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T02:00:13.327

由于它是一个小表，我更喜欢将其用作模板，而不是克隆和查找匹配的元素。

**注意：**根据服务器技术，您也可以第一次从服务器加载rewardTableTmpl，然后使用模板进一步使用。

[**演示**](http://jsfiddle.net/skram/EMaZT/1/)

```
$(function() {
    var rewardTableTmpl = '<table class="form right 40 rewardclone">' +
        '<tr><td><label for="financial_goal_{NUM}">Amount</label></td>' +
        '<td>Pledge <span class="dollar">&#36;</span><input id="financial_goal_{NUM}" class="text dollars" type="text" name="financial_goal_{NUM}" /> or more</td>' +
        '</tr><tr>' +
        '<td><label for="maximum_{NUM}">Maximum</label></td>' +
        '<td><input id="maximum_{NUM}" class="text dollars" type="text" name="maximum_{NUM}" /> available (blank for unlimited)</td>' +
        '</tr><tr>' +
        '<td><label for="reward_{NUM}">Reward:</label></td>' +
        '<td><textarea id="reward_{NUM}" name="reward_{NUM}"></textarea></td>' +
         '</tr></table>';

    $('#add_reward').click(function() {
        $('#rewards_container').append(rewardTableTmpl.replace(/{NUM}/g, $('rewardclone').length + 1));
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T01:54:22.050

对于您的情况，这将是一个简单的解决方案：

```
$('#add_reward').click(function() {         
    var $x = $('.rewardclone').clone();
    $x.appendTo('#rewards_container');
    $x.find('input[id], textarea[id], label[for]').each(function() {
        if($(this).is('label')) {
            var new_id = parseInt($(this).attr('for').split('_').pop(), 10) + 1;
            $(this).attr('for', new_id);
        } else {
            var new_id = parseInt(this.id.split('_').pop(), 10) + 1;
            this.id = new_id;
        }
    });     
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-08T18:30:01.663

我对 Selvakumar Arumugam 的回答做了一个小的调整，因为当我打印出 {NUM} 时，它并没有改变。

```
$(function() {
    var rewardTableTmpl = '<table class="form right 40 rewardclone">' +
        '<tr><td><label for="financial_goal_{NUM}">Amount</label></td>' +
        '<td>Pledge <span class="dollar">&#36;</span><input id="financial_goal_{NUM}" class="text dollars" type="text" name="financial_goal_{NUM}" /> or more</td>' +
        '</tr><tr>' +
        '<td><label for="maximum_{NUM}">Maximum</label></td>' +
        '<td><input id="maximum_{NUM}" class="text dollars" type="text" name="maximum_{NUM}" /> available (blank for unlimited)</td>' +
        '</tr><tr>' +
        '<td><label for="reward_{NUM}">Reward:</label></td>' +
        '<td><textarea id="reward_{NUM}" name="reward_{NUM}"></textarea></td>' +
         '</tr></table>';

var count =0;
     $('#add_reward').click(function() {
         count++;
        $('#rewards_container').append(rewardTableTmpl.replace(/{NUM}/g, count));
    });

}); 
```

# shell - 什么是 /dev/null 2>&1？

> ID：10508843
> 
> 赞同：347
> 
> 时间：2012-05-09T01:46:19.207
> 
> 标签：shell, syntax, posix, io-redirection

我在 /etc/cron.daily/apf 中找到了这段代码

```
#!/bin/bash  
/etc/apf/apf -f >> /dev/null 2>&1  
/etc/apf/apf -s >> /dev/null 2>&1 
```

它正在刷新并重新加载防火墙。
我不明白这`>> /dev/null 2>&1`部分。

在 cron 中有这个的目的是什么？它覆盖了我的防火墙规则。我可以安全地删除这个 cron 作业吗？

* * *

## 回答 #1

> 赞同：480
> 
> 时间：2012-05-09T01:49:42.013

`>> /dev/null`将标准输出 ( `stdout`) 重定向到`/dev/null`，它会丢弃它。

（这`>>`似乎有点多余，因为`>>`意味着追加，而`>`意味着截断和写入，并且追加或写入`/dev/null`具有相同的净效果。我通常只是`>`出于这个原因使用。）

`2>&1`将标准错误（`2`）重定向到标准输出（`1`），然后由于标准输出已经被重定向，标准输出也将其丢弃。

* * *

## 回答 #2

> 赞同：363
> 
> 时间：2017-03-21T06:35:38.127

让我们将`>> /dev/null 2>&1`声明分成几部分：

* * *

**第 1 部分：** `>>`输出重定向

这用于重定向程序输出并将输出附加到文件末尾。[更多的...](https://unix.stackexchange.com/questions/89386/what-is-symbol-and-in-unix-linux)

* * *

**第 2 部分：** `/dev/null`特殊文件

这是一个*[伪设备特殊文件](https://en.wikipedia.org/wiki/Device_file#Pseudo-devices)*。

命令`ls -l /dev/null`将为您提供此文件的详细信息：

```
crw-rw-rw-. 1 root root 1, 3 Mar 20 18:37 /dev/null 
```

你观察了`crw`吗？这意味着它是一个提供串行访问的[*字符特殊文件*](https://unix.stackexchange.com/questions/60034/what-are-character-special-and-block-special-files-in-a-unix-system)*类型的伪设备*文件。[](https://unix.stackexchange.com/questions/60034/what-are-character-special-and-block-special-files-in-a-unix-system)

 *> `/dev/null`接受并丢弃所有输入；不产生输出（总是在读取时返回文件结束指示）。参考：[维基百科](https://en.wikipedia.org/wiki/Device_file#Pseudo-devices)

* * *

**第 3 部分：（** `2>&1`将流 2 的输出与流 1 合并）

每当您执行程序时，操作系统总是会打开三个文件，标准输入、标准输出和标准错误，正如我们所知，每当打开一个文件时，操作系统（来自*内核）都会返回一个称为**文件描述符*的非负整数。这些文件的文件描述符分别为 0、1 和 2。

所以`2>&1`简单地说将标准错误重定向到标准输出。

> *`&`表示后面的内容是文件描述符，而不是文件名。*

***简而言之，通过使用此命令，您是在告诉您的程序在执行时不要大喊大叫。***

**使用的重要性是`2>&1`什么？**

如果您不想产生任何输出，即使终端中产生了一些错误。为了更清楚地解释，让我们考虑以下示例：

```
$ ls -l > /dev/null 
```

对于上面的命令，终端没有打印输出，但是如果这个命令产生错误怎么办：

```
$ ls -l file_doesnot_exists > /dev/null
ls: cannot access file_doesnot_exists: No such file or directory 
```

尽管我将输出重定向到`/dev/null`，但它仍打印在终端中。这是因为我们没有将错误输出重定向到`/dev/null`，所以为了也重定向错误输出，需要添加`2>&1`：

```
$ ls -l file_doesnot_exists > /dev/null 2>&1 
```

* * *

## 回答 #3

> 赞同：85
> 
> 时间：2012-05-09T01:49:13.433

这是安静地执行程序并隐藏其所有输出的方式。

`/dev/null`是一个特殊的文件系统对象，它丢弃写入其中的所有内容。将流重定向到其中意味着隐藏程序的输出。

该`2>&1`部分表示“将错误流重定向到输出流”，因此当您重定向输出流时，错误流也会被重定向。即使您的程序写入到`stderr`现在，该输出也会被丢弃。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2020-12-25T00:59:15.340

让我一点一点地解释一下。

## 0,1,2

```
0: standard input
1: standard output
2: standard error 
```

## >>

`>>`in`command >> /dev/null 2>&1`将命令输出附加到`/dev/null`.

## 命令 >> /dev/null 2>&1

1.  命令后：

```
command
=> 1 output on the terminal screen
=> 2 output on the terminal screen 
```

2.  重定向后：

```
command >> /dev/null
=> 1 output to /dev/null
=> 2 output on the terminal screen 
```

3.  后`/dev/null 2>&1`

```
command >> /dev/null 2>&1
=> 1 output to /dev/null
=> 2 output is redirected to 1 which is now to /dev/null 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2015-03-10T12:40:48.647

`/dev/null`是一个标准文件，它会丢弃您写入的所有内容，但会报告写入操作成功。

`1`是标准输出，`2`是标准错误。

`2>&1`将标准错误重定向到标准输出。`&1`表示文件描述符（标准输出），否则（如果你只使用`1`）你会将标准错误重定向到一个名为`1`. `[any command] >>/dev/null 2>&1`将所有标准错误重定向到标准输出，并将所有内容写入`/dev/null`.

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-06-08T06:29:34.997

我`>> /dev/null 2>&1`用于静默 cronjob。cronjob 可以完成这项工作，但不会向我的电子邮件发送报告。

据我所知，不要删除`/dev/null`. 它很有用，尤其是当您运行[cPanel](https://en.wikipedia.org/wiki/CPanel)时，它可以用于一次性的 cronjob 报告。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-10-03T20:13:31.117

正如其他人所描述的，写入 /dev/null 会消除程序的输出。通常，cron 会为以 cronjob 启动的进程的每个输出发送一封电子邮件。因此，如果您在 cron 中指定了地址，则通过将输出写入 /dev/null 可以防止垃圾邮件。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2013-04-15T23:01:11.860

编辑`/etc/conf.apf`. 设置`DEVEL_MODE="0"`。`DEVEL_MODE`设置为`1`将添加一个 cron 作业以在 5 分钟后停止 apf。*

# java - 如何确保只有一个 Java 应用程序实例正在运行？

> ID：10508846
> 
> 赞同：11
> 
> 时间：2012-05-09T01:46:57.180
> 
> 标签：java, mutex

我希望我的应用程序检查其自身的另一个版本是否已经在运行。

比如`demo.jar`启动，用户点击再次运行，但是第二个实例实现“哦等等，已经有一个`demo.jar`运行了”。并退出并显示一条消息。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-08-14T19:45:58.090

## 强制使用 ServerSocket 锁运行的程序的一个实例

Java 代码。将其放入名为 Main.java 的文件中：

```
import java.net.*;
import java.io.*;
public class Main{
  public static void main(String args[]){
    ServerSocket socket = null;
    try {
      socket = new ServerSocket(34567);
      System.out.println("Doing hard work for 100 seconds");
      try{ Thread.sleep(100000); } catch(Exception e){ }
      socket.close();
    }
    catch (IOException ex) {
      System.out.println("App already running, exiting...");
    }
    finally {
      if (socket != null)
          try{ socket.close(); } catch(Exception e){}
    }
  }
} 
```

**编译并运行它**

```
javac Main.java
java Main 
```

**在正常情况下测试它：**

运行程序。您有 100 秒的时间在另一个终端中再次运行该程序，它会说它已经在运行。然后等待 100 秒，它应该允许您在第二个终端中运行它。

**在使用 kill -9 强制停止程序后对其进行测试**

1.  在终端 1 中启动程序。
2.  在 100 秒内从另一个终端杀死 -9 该进程。
3.  再次运行程序，就可以运行了。

**结论：**

当您的程序不再运行时，操作系统会清理套接字占用。所以你可以确定程序不会运行两次。

**缺点**

如果某个鬼鬼祟祟的人，或者某个顽皮的进程要绑定所有端口，或者只是你的端口，那么你的程序将不会运行，因为它认为它已经在运行。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-09T01:52:51.090

您正在寻找的东西可能最好通过锁定文件来完成。通过锁定文件，我只是指一个具有预定义位置并且其存在是您的互斥锁的文件。

在程序启动时测试该文件是否存在，如果存在，立即退出。在已知位置创建文件。如果您的程序正常退出，请删除锁定文件。

最好的办法可能是您还可以使用 pid（进程 ID）填充文件，这样您就可以检测到未删除文件但特定于操作系统的异常退出。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-11-16T07:01:59.903

> 简单而强大的测试解决方案。

```
 static File file;
    static FileChannel fileChannel;
    static FileLock lock;
    static boolean running = false;

    @SuppressWarnings("resource")
    public static boolean checkIfAlreadyRunning() throws IOException {
        file = new File(FilePath.FILEPATH + "az-client.lock");
        if (!file.exists()) {
            file.createNewFile();
            running = true;
        } else {
            file.delete();
        }

        fileChannel = new RandomAccessFile(file, "rw").getChannel();
        lock = fileChannel.tryLock();

        if (lock == null) {
            fileChannel.close();
            return true;
        }
        ShutdownHook shutdownHook = new ShutdownHook();
        Runtime.getRuntime().addShutdownHook(shutdownHook);

        return running;
    }

    public static void unlockFile() {
        try {
            if (lock != null)
                lock.release();
            fileChannel.close();
            file.delete();
            running = false;
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    static class ShutdownHook extends Thread {
        public void run() {
            unlockFile();
        }
    } 
```

将这些方法放在某个 Util 类中，然后在启动主类之前检查是否已经存在，然后向用户显示一些对话框，否则启动应用程序。即使您异常关闭 java 进程或您所做的任何事情，它也能正常工作。它强大且高效，无需设置 DataGram 侦听器或其他任何东西......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-09T02:00:20.067

如果您的应用程序在 Windows 上运行，您可以通过 JNI调用[CreateMutex 。](http://msdn.microsoft.com/en-us/library/ee488798.aspx)

```
jboolean ret = FALSE;    
HANDLE hMutex = CreateMutex(NULL, FALSE, mutexName); 
ret = TRUE;    
if(WAIT_TIMEOUT == WaitForSingleObject(hMutex, 10))  
{    
    ret = FALSE;  
}
else if(GetLastError() != 0)  
{    
    ret = FALSE;  
} 
```

如果没有其他人使用此互斥锁，则返回 true，否则返回 false。如果您希望所有 Windows 会话共享您的互斥锁，您可以提供“myApplication”作为互斥锁名称或“Global\MyApplication”。

编辑：它并不像看起来那么复杂:) 我觉得它很干净。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-08-02T03:36:13.250

此代码的策略是保留上次运行时在注册表中的 PID，如果发现该 PID 在系统上运行，则不要启动。如果完成，请重置。

首选项存储在 Windows 注册表中`HKEY_LOCAL_MACHINE\SOFTWARE\JavaSoft\Prefs`

```
import java.io.*;
import java.util.prefs.Preferences;
public class JavaApplication3 {
    public static void main(String[] args){
        if(isRunning()){
            System.out.println("Two instances of this program cannot " +
                    "be running at the same time.  Exiting now");
        }
        else{
            onStart();
            epicHeavyWorkGoesHere();
            onFinish();
        }
    }
    public static void epicHeavyWorkGoesHere(){
        try {
            Thread.sleep(15000);
        } catch (InterruptedException ex) {}
    }
    public static void onStart(){
        Preferences prefs = Preferences.systemRoot().node("JavaApplication3");
        prefs.put("RUNNINGPID", getCurrentPID());
    }
    public static void onFinish(){
        Preferences prefs = Preferences.systemRoot().node("JavaApplication3");
        prefs.put("RUNNINGPID", "");
    }
    public static boolean isRunning(){
        Preferences prefs = Preferences.systemRoot().node("JavaApplication3");

        if (prefs.get("RUNNINGPID", null) == null || prefs.get("RUNNINGPID", null).equals(""))
            return false;

        if (isProcessIdRunningOnWindows(Integer.parseInt(prefs.get("RUNNINGPID", null))))
            return true;
        return false;
    }
    public static String getCurrentPID(){
        //This function should work with Windows, Linux and Mac but you'll have to 
        //test to make sure.  If not then get a suitable getCurrentPID function replacement.
        try{
            java.lang.management.RuntimeMXBean runtime = java.lang.management.ManagementFactory.getRuntimeMXBean();
            java.lang.reflect.Field jvm = runtime.getClass().getDeclaredField("jvm");
            jvm.setAccessible(true);
            sun.management.VMManagement mgmt = (sun.management.VMManagement) jvm.get(runtime);
            java.lang.reflect.Method pid_method = mgmt.getClass().getDeclaredMethod("getProcessId");
            pid_method.setAccessible(true);
            return pid_method.invoke(mgmt) + "";
        }
        catch(Exception e){
            throw new RuntimeException("Cannot get the current PID");
        }
    }
    public static boolean isProcessIdRunningOnWindows(int pid){
        //This Function only works for windows, if you want it to work on linux
        //or mac, you will have to go find a replacement method that 
        //takes the processID as a parameter and spits out a true/false 
        //if it is running on the operating system.
        try {
            Runtime runtime = Runtime.getRuntime();
            String cmds[] = {"cmd", "/c", "tasklist /FI \"PID eq " + pid + "\""};
            Process proc = runtime.exec(cmds);

            InputStream inputstream = proc.getInputStream();
            InputStreamReader inputstreamreader = new InputStreamReader(inputstream);
            BufferedReader bufferedreader = new BufferedReader(inputstreamreader);
            String line;
            while ((line = bufferedreader.readLine()) != null) {
                if (line.contains(" " + pid + " ")){
                    return true;
                }
            }
            return false;
        }
        catch (Exception ex) {
            throw new RuntimeException("Cannot run the tasklist command to query if a pid is running or not");
        }
    }
} 
```

如果程序挂起并且 pid 保留在任务列表中，这将被阻止。您可以添加一个额外的注册表项来存储上次成功的运行时间，如果运行时间变得太大，存储的 PID 将被终止，程序重新运行。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-09T01:59:42.883

如果您使用 Mutex，从逻辑上讲，Mutex 需要可以从任何运行“程序”副本的 JVM 访问。在 C 编程中，这可能是通过共享内存来实现的，但 Java 默认没有这样的东西。

有了这种理解，就有很多方法可以实现你想要的。您可以在指定端口上打开服务器套接字（操作系统确保只有一个进程是服务器套接字的接收者，随后的打开失败）。

您可以使用“锁定文件”，但它有点复杂，因为您需要使用的文件实际上是一个目录（并且它在很大程度上取决于目录创建对于您的文件系统是否是原子的，即使大多数目录创建是）。如果系统管理员决定通过 NFS 运行您，那么事情会变得更加困难（如果不是不可能的话）。

您还可以使用 JVM 和调试 / JMI 做一些漂亮的技巧，前提是您可以以某种方式向自己保证所有相关的 JVM 都使用相同的配置启动（及时，这是一项不可能完成的任务）。

其他人已经使用 exec 工具来运行等效的进程列表，但由于可能出现竞争条件（两个进程同时检查，但无法看到对方），这有点棘手。

最后，服务器套接字路由可能是最稳定的，因为它通过 TCP/IP 堆栈保证只绑定到一个进程（并且由操作系统调解）。也就是说，您将不得不刷新传入消息的套接字，这会带来其他安全问题的可能性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-09-11T06:55:46.060

以下解决方案也在两个致命的场景中工作。1>甚至你启动的exe在任务管理器中安排为javaw.exe。2> 您可以在两个位置安装您的应用程序，并且从启动这两个位置它也可以工作。

```
String tempDir = System.getProperty("java.io.tmpdir");// dependent to OS find any tem dir.
        String filePath = tempDir + "lockReserverd.txt";
        try {
            final File file = new File(filePath);

            if(file.exists())
                return false;

            final RandomAccessFile randomAccessFile = new RandomAccessFile(file, "rw");
            final FileLock fileLock = randomAccessFile.getChannel().tryLock();
            if (fileLock != null) {
                Runtime.getRuntime().addShutdownHook(new Thread() {
                    public void run() {
                        try {
                            fileLock.release();
                            randomAccessFile.close();
                            file.delete();
                        } catch (Exception e) {
                            //log.error("Unable to remove lock file: " + lockFile, e);
                        }
                    }
                });
                return true;
            }
        } catch (Exception e) {
            //log.Error("Unable to create and/or lock file");
        }
        return false 
```

或者

如果您的 application.exe 列在任务管理器中，这将起作用

```
"tasklist /FI \"IMAGENAME eq "+MyApplication+".exe 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-11-16T07:20:57.980

与其他几个答案相反，最可靠的方法是`ServerSocket`在只有您知道的固定端口上创建一个，在油漆卡中向上。与任何锁文件不同，它会在您的应用程序退出时自动释放，并且它之前通过 a 存在`BindException`是另一个实例已经在运行的非常可靠的标志。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-08-01T16:21:27.497

这是一种使用用户主目录中自动命名的锁定文件的方法。该名称基于运行 jar 的位置。

```
import java.io.File;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.RandomAccessFile;
import java.nio.channels.FileChannel;

public class SingleInstance {

    @SuppressWarnings("resource")
    public static boolean isAlreadyRunning() {
        File file;
        FileChannel fileChannel;
        File userDir = new File(System.getProperty("user.home"));
        file = new File(userDir, myLockName());

        if (!file.exists()) {
            try {
                file.createNewFile();
                file.deleteOnExit();
            } catch (IOException e) {
                throw new RuntimeException("Unable to create Single Instance lock file!", e);
            }
        }

        try {
            fileChannel = new RandomAccessFile(file, "rw").getChannel();
        } catch (FileNotFoundException e) {
            throw new RuntimeException("Single Instance lock file vanished!", e);
        }
        try {
            if (fileChannel.tryLock() != null) {
                return false;
            }
        } catch (Exception e) {
        }
        try {
            fileChannel.close();
        } catch (IOException e1) {
        }
        return true;
    }

    private static String myLockName() {
        return "." + SingleInstance.class.getProtectionDomain().getCodeSource().getLocation().getPath()
                .replaceAll("[^a-zA-Z0-9_]", "_");
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-09-11T07:29:44.197

如果您的应用程序可以在具有唯一名称的任务管理器中安排，这也是一个很好的解决方案

```
 "tasklist /FI \"IMAGENAME eq "+MyApplication+".exe 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-09-15T08:31:49.173

**检查 PID 和文件锁定技术**

*我们可以将创建锁文件的进程的进程id写入文件中。当我们遇到一个现有的锁文件时，我们不只是退出，而是检查具有该 id 的进程是否还活着。如果没有，则创建一个新的应用程序实例。我认为 MongoDB 使用这种技术。*

```
 static File file;
    static FileChannel fileChannel;
    static FileLock lock;
    static boolean running = false;
    static String currentPID = null;
    static String lockFilePID = null;
    public static final String USER_DIR = System.getProperty("user.dir");
    public static final String LOCK_FILE = "az-client.lock";

    public static boolean checkInstance() {
        try {
            file = new File(USER_DIR + File.separator + LOCK_FILE);
            currentPID = Integer.toString(getCurrentPID());
            if (!file.exists()) {
                file.createNewFile();
                writePID(currentPID);
                lockFile();
                addShudDownHook();
                running = true;
                return running;
            } else {
                if (isFileLocked()) {
                    syso("App already running");
                    System.exit(0);
                } else {
                    lockFilePID = getPIDFromLockFile();
                    if (isProcessIdRunningOnWindows(Integer.parseInt(lockFilePID))) {
                        lockFile();
                        addShudDownHook();
                        running = true;
                        return running;
                    } else {
                        file.delete();
                        file.createNewFile();
                        writePID(currentPID);
                        lockFile();
                        addShudDownHook();
                        running = true;
                        return running;
                    }
                }
            }
        } catch (Exception e) {
            syso(e + "App already running");
            System.exit(0);
        }
        return running;
    }

    /**
     * 
     * @return
     * @throws IOException
     */
    @SuppressWarnings("resource")
    private static boolean isFileLocked() throws IOException {
        fileChannel = new RandomAccessFile(file, "rw").getChannel();
        lock = fileChannel.tryLock();
        if (lock == null) {
            fileChannel.close();
            fileChannel = null;
            return true;
        } else {
            lock.release();
            fileChannel.close();
            fileChannel = null;
        }
        return false;
    }

    public static int getCurrentPID() {
        // This function should work with Windows, Linux and Mac but you'll have
        // to
        // test to make sure. If not then get a suitable getCurrentPID function
        // replacement.
        try {
            java.lang.management.RuntimeMXBean runtime = java.lang.management.ManagementFactory.getRuntimeMXBean();
            java.lang.reflect.Field jvm = runtime.getClass().getDeclaredField("jvm");
            jvm.setAccessible(true);
            sun.management.VMManagement mgmt = (sun.management.VMManagement) jvm.get(runtime);
            java.lang.reflect.Method pid_method = mgmt.getClass().getDeclaredMethod("getProcessId");
            pid_method.setAccessible(true);
            return (int) pid_method.invoke(mgmt);
        } catch (Exception e) {
            throw new RuntimeException("Cannot get the current PID");
        }
    }

    public static boolean isProcessIdRunningOnWindows(int pid) {
        // This Function only works for windows, if you want it to work on linux
        // or mac, you will have to go find a replacement method that
        // takes the processID as a parameter and spits out a true/false
        // if it is running on the operating system.
        try {
            Runtime runtime = Runtime.getRuntime();
            String cmds[] = { "cmd", "/c", "tasklist /FI \"PID eq " + pid + "\"" };
            Process proc = runtime.exec(cmds);

            InputStream inputstream = proc.getInputStream();
            InputStreamReader inputstreamreader = new InputStreamReader(inputstream);
            BufferedReader bufferedreader = new BufferedReader(inputstreamreader);
            String line;
            while ((line = bufferedreader.readLine()) != null) {
                if (line.contains(" " + pid + " ")) {
                    return true;
                }
            }
            return false;
        } catch (Exception ex) {
            throw new RuntimeException("Cannot run the tasklist command to query if a pid is running or not");
        }
    }

    /**
     * This method write PID to Lock file
     * 
     * @param pid
     * @throws Exception
     */
    private static void writePID(String pid) throws Exception {
        try {
            // To Do write PID to LockFile
        } catch (Exception e) {
            syso(e);
            throw e;
        }
    }

    /**
     * This method return PID from Lock File
     * 
     * @return
     * @throws Exception
     */
    private static String getPIDFromLockFile() throws Exception {
        try {
            return //To Do getPID from File
        } catch (Exception e) {
            syso(e);
            throw e;
        }
    }

    private static void addShudDownHook() {
        try {
            ShutdownHook shutdownHook = new ShutdownHook();
            Runtime.getRuntime().addShutdownHook(shutdownHook);
        } catch (Exception e) {
            LogWriter.logger.error(e);
        }
    }

    private static void unlockFile() {
        try {
            if (lock != null) {
                lock.release();
            }
            fileChannel.close();
            file.delete();
            running = false;
        } catch (IOException e) {
            syso(e);
        }
    }

    private static void lockFile() {
        try {
            fileChannel = new RandomAccessFile(file, "rw").getChannel();
            lock = fileChannel.tryLock();
            if (lock == null) {
                fileChannel.close();
                fileChannel = null;
            }
        } catch (IOException e) {
            syso(e);
        }
    }

    static class ShutdownHook extends Thread {
        public void run() {
            unlockFile();
        }
    } 
```

# ios - 通过 AFNetworking 上传到 Amazon-S3

> ID：10508848
> 
> 赞同：3
> 
> 时间：2012-05-09T01:47:21.430
> 
> 标签：ios, amazon-s3, afnetworking

我无法通过 AFNetworking 将文件上传到 S3。当我尝试上传时，我收到回调，表明一小部分文件已上传，然后回调停止，一两分钟后我收到超时消息。

我正在使用[AFAmazonS3Client](https://github.com/AFNetworking/AFAmazonS3Client)但它似乎是 AFHTTPClient 的一个非常简单的子类，因此问题似乎不太可能存在。由于我是 AFNetworking 和 S3 的新手，我很确定问题出在输入此消息 :)

我已经下载了 AWS-IOS 开发工具包，并且能够毫无问题地从他们的示例代码中发布图片。所以我不认为这是我的 S3 帐户配置错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T11:18:38.393

在为同样的问题苦苦挣扎并进行了一些研究之后，我找到了一个似乎运作良好的解决方案。

下载适用于 iOS 的 Amazon AWS 开发工具包并将其添加到您的项目中：

[http://aws.amazon.com/sdkforios/](http://aws.amazon.com/sdkforios/)

`NSOperation`然后，使用自定义类实现上传测试，如下所述：

[使用委托、操作和队列](https://stackoverflow.com/questions/8230870/using-delegates-operations-and-queues/8268376#8268376)

该`AmazonServiceRequestDelegate`协议是获取进度更新的关键，其方式与所做的类似`AFNetworking`。

特别是，这种方法是我需要的：

```
-(void)request:(AmazonServiceRequest *)request didSendData:(NSInteger)bytesWritten
    totalBytesWritten:(NSInteger)totalBytesWritten
    totalBytesExpectedToWrite:(NSInteger)totalBytesExpectedToWrite; 
```

# php - 跟踪php文件的最佳工具

> ID：10508849
> 
> 赞同：-3
> 
> 时间：2012-05-09T01:47:27.070
> 
> 标签：php

我是 php 新手，我想找出实际包含我看到的渲染 HTML 的文件。似乎页面的标题部分位于包含文件夹中。我花了 2 天时间才发现这一点。有没有更简单的方法或工具可以使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T01:52:38.147

PHP 通常是你能找到的最简单的。“什么文件实际上包含我看到的渲染 HTML”取决于您使用的设置。CMS 可能包含来自数十或数百个文件的各种 HTML 部分。一个小型自定义站点可能会将所有内容都放在一个文件中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T01:53:42.003

这一切都取决于您使用的 PHP 应用程序的类型。许多人将 HTML 代码与 PHP 代码分开，没错！

但是，如果您使用的代码混合了 HTML 和 PHP，并且没有专门指定到诸如“ `Templates`”或“ `Views`”之类的文件夹，那么您的 PHP 生活将开始有点棘手！

为了解决您的困境，这里有一个建议：

**建议一：**

*   我会拿一份[Netbeans](http://netbeans.org/)的副本（只是 PHP 的就可以了）。
*   使用文件创建一个新项目
*   随着旁边列出的新项目，
*   选择“来源图标”按`CTRL+F`搜索各种`<html>`标签，它会显示在搜索结果列表中。

**建议二：**

*   获取 Notepad++ 的副本（如果您在 Windows 上）
*   选择你所有的 PHP 文件（希望它低于 100）
*   将它们拖入[Notepad++](http://notepad-plus-plus.org/)并让它们打开
*   按`CTRL+F`，然后移动到“在文件中查找”
*   输入您要查找的一些`<html>`标签，您将在底部获得一个列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T02:33:06.977

您可以创建一个临时日志记录功能，每次渲染页面的某些部分时，您都会在日志中写入一些内容。

你可以做这样的事情（伪代码）：

```
createPage(){
  render(head); //with log
  render(body); //with log
  render(footer); //with log
} 
```

但这一切都取决于您使用的设置，如 ceejayoz 所述。

# android - Android应用插件架构

> ID：10508851
> 
> 赞同：2
> 
> 时间：2012-05-09T01:47:59.933
> 
> 标签：android, plugins, android-ndk

我正在尝试在 Android 中实现插件架构，更具体地说，是跨 apk 类加载

假设我有以下内容：apk A 和 apk B，`sharedUserId`在`AndroidManifest.xml` *接口 I*中定义相同的定义在 apk A 中，并且 apk B 包含一个实现*I的**类 IB*

 *我尝试了以下方法

1.  在 apk A 中，用于`createPackageContext`获取 B 的上下文，然后调用`Context.getClassLoader`并加载所需的类名。但是，由于这会创建两个类加载器，因此我无法将B中加载的*类 IB转换为**接口 I*；这意味着我需要使用反射......

2.  将 apk B 传递给`DexClassLoader`（通过 获得的 apk B 的路径）并因“ **Class resolve by unexpected DEX**`ApplicationInfo.sourceDir` ”而失败，可能是因为 apk B 中也存在重复的接口 I...

***   修改`build xml`并按照[Dalvik 中自定义类加载中](http://android-developers.blogspot.com/2011/07/custom-class-loading-in-dalvik.html)的方法创建一个单独的 jar，其中包含B 中实现*I的**类 IB* ，并将 jar 放入 apk B 的目录中。这种方法看起来很有希望，因为我可以加载*类 IB*并将其转换为*I*而不会出现问题。但是，它需要复制 jar，我不确定当涉及 NDK 共享库时会发生什么。*`assets`*** 

 *****我的问题是，是否有一种方法不涉及修改 build.xml/ant.properties 并与 NDK so 库一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T06:33:18.410

不确定其他方法，但是对于方法2，您可以在将B打包到apk时排除接口I。只需排除生成的 I.class 文件就足够了。

您可能会发现 Fred Chung 的这篇文章很有帮助，并且可能会给您一些提示。[http://android-developers.blogspot.kr/2011/07/custom-class-loading-in-dalvik.html](http://android-developers.blogspot.kr/2011/07/custom-class-loading-in-dalvik.html)******

# .net - MSBuild 复制任务问题

> ID：10508852
> 
> 赞同：0
> 
> 时间：2012-05-09T01:48:04.000
> 
> 标签：.net, msbuild

我面临的问题是我的目标“CopyBuildFiles”没有复制，因为我认为它无法找到构建文件夹。构建文件夹在属性 $(BuildFolder) 中定义，此文件夹名称是根据 date.time 创建的，并且是在“CopyBuildFiles”之前运行的先前目标之一中创建的。

如果我硬编码 @(SrcFiles) 的路径，而不是从 $(BuildFolder) 派生它，它就可以工作。

有什么想法，这里发生了什么，如何解决？

非常感谢。

```
<PropertyGroup>

    <year>$([System.DateTime]::Now.ToString("yy"))</year>
    <month>$([System.DateTime]::Now.ToString("MM"))</month>
    <day>$([System.DateTime]::Now.ToString("dd"))</day>
    <time>$([System.DateTime]::Now.ToString("HHmm"))</time>
    <AssemblyFileVersionAttribute>[$(year).$(month).$(day).$(time))]      </AssemblyFileVersionAttribute>
    <BuildFolder>c:\website.builds\$(AssemblyFileVersionAttribute)\</BuildFolder>
    <IISFolder>c:\website.publish\</IISFolder>        
    <LogDirectory>C:\website.builds.logs</LogDirectory>
    <LogFile>C:\website.builds.logs\Buildlog_$(AssemblyFileVersionAttribute).txt</LogFile>

</PropertyGroup>

<Target Name="PreBuild">
    <MakeDir Directories="$(LogDirectory)" />       
    <RemoveDir Directories="$(IISFolder)"></RemoveDir>        
    <MakeDir Directories="$(BuildFolder)" />
    <MakeDir Directories="$(IISFolder)" />        
</Target>

<Target Name="Compile">
    <MSBuild Projects="$(MSBuildStartupDirectory)\websitev2.sln"  Properties="OutDir=$(BuildFolder)\" />        
</Target>

<ItemGroup>
    <SrcFiles Include="$(BuildFolder)_PublishedWebsites\**\*.*"/>
</ItemGroup>

<Target Name="CopyBuildFiles"
          Inputs="@(SrcFiles)"
          Outputs=
      "@(SrcFiles->'$(IISFolder)%(RecursiveDir)%(Filename)%(Extension)')">
    <Copy SourceFiles="@(SrcFiles)"
          DestinationFiles="@(SrcFiles->'$(IISFolder)%(RecursiveDir)%(Filename)%(Extension)')"
      />      
</Target>

<Target Name="Deploy">
    <CallTarget Targets="PreBuild" />
    <CallTarget Targets="Compile" />
    <CallTarget Targets="CopyBuildFiles" />
</Target> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T02:20:03.427

由于您的目标之一定义了 $(BuildFolder) 属性，因此 @(SrcFiles) 项目组也需要在同一目标中定义，或者在定义 $(BuildFolder) 后执行的其他目标中定义。

像这样的东西：

```
<Target Name="MyTarget">
    <PropertyGroup>
        <BuildFolder>... some path ... </BuildFolder>
    </PropertyGroup>
    <ItemGroup>   
        <SrcFiles Include="$(BuildFolder)_PublishedWebsites\**\*.*"/>   
    </ItemGroup>  
</Target> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T01:29:06.470

```
Replaced ItemGroup with **CreateItem**. This makes the copy work. 
**CreateItem** works without parameters. The folder name did not get passed through a parameter for some reason??!?

<Target Name="BuildInit">
    <CreateItem Include="$(BuildFolder)_PublishedWebsites\**\*.*">
      <Output TaskParameter="Include" ItemName="YourFilesToCopy" />
    </CreateItem>

    <Copy SourceFiles="@(YourFilesToCopy)"
                    DestinationFiles="@(YourFilesToCopy->'$(IISFolder)\%(RecursiveDir)%(Filename)%(Extension)')" />
  </Target> 
```

# php - PHP cookie 转换成字符串

> ID：10508854
> 
> 赞同：3
> 
> 时间：2012-05-09T01:48:33.480
> 
> 标签：php, cookies

我在 PHP 中读到，根据[http://www.w3schools.com/php/php_cookies.asp](http://www.w3schools.com/php/php_cookies.asp) ，您可以使用 print_r 查看所有 cookie 。

```
<?php 
  print_r($_COOKIE); 
?> 
```

但我想对 cookie 的内容做更多的事情。

有没有办法在不知道 cookie 名称的情况下将 cookie 名称和值连接成字符串变量之类的东西，而不是依赖 print_r？

我在网上找不到答案。先感谢您。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-09T01:51:47.823

根据您的 cookie 数组的复杂性，这些中的任何一个都可能起作用

```
implode(',',$_COOKIE)

json_encode($_COOKIE)

serialize($_COOKIE) 
```

我建议不要这样做，只依赖遍历数组

简单示例：$_COOKIE['name']

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T01:57:19.167

您可以使用以下代码访问所有 cookie 名称，而无需事先知道它们：

```
foreach ($_COOKIE as $name => $value) {
   print "Variable " . $name . " has value " . $value . "<br />\n";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T13:20:22.613

我将它与所有调试器、_POST、_GET、_SESSION、_COOKIE 一起使用

```
 echo "<pre>";
foreach ($_COOKIE as $key => $val) {
    echo "[$key] = $val \r\n";
    if(is_array($val)) {
        echo "is ARRAY ::::::: \"$key\" : \r\n";
        foreach ($val as $key2 => $val2) {
            echo "[$key2] = $val2 \r\n";
        }
    }
}
echo "</pre>"; 
```

# sencha-touch-2 - Sencha Touch 2：找不到模块`/sencha-sdk-dir/command/sencha.js`

> ID：10508857
> 
> 赞同：1
> 
> 时间：2012-05-09T01:49:03.347
> 
> 标签：sencha-touch-2, sencha-command

我在 Arch Linux x64 上安装了 Sencha Touch 2 x64。从 SDK 目录中，我运行`./sencha`

```
[jiewmeng@JM SenchaSDKTools-2.0.0-beta3]$ ./sencha
[WARN] The current working directory (/opt/SenchaSDKTools-2.0.0-beta3) is not a recognized Sencha SDK or application folder. Running in backwards compatible mode.

Sencha Command v2.0.0 Beta 3
Copyright (c) 2012 Sencha Inc.

usage: sencha COMMAND [ARGS]

The available commands are:
   build            build a JSB project
   create bootstrapdata     generate boostrap data
   create jsb           generate a minimal JSB project for an app
   create locale            generate a template locale file from source
   create manifest      generate classes manifest
   package          package your Touch web app into a native bundle
   slice theme          slice a custom theme's images for IE

See 'sencha help COMMAND' for more information on a specific command. 
```

`.senchasdk`我通过添加一个只有“。”的文件来解决这个问题。init （正如我想象的那样），但现在我得到了

```
[jiewmeng@JM SenchaSDKTools-2.0.0-beta3]$ ./sencha

node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: Cannot find module '/opt/SenchaSDKTools-2.0.0-beta3/command/sencha.js'
    at Function._resolveFilename (module.js:332:11)
    at Function._load (module.js:279:25)
    at Array.0 (module.js:479:10)
    at EventEmitter._tickCallback (node.js:192:40) 
```

怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T21:39:20.517

我解决了这个问题，只是将 SDK 路径添加为系统变量，然后在 sencha 库文件夹中运行命令，而不是 SDK 文件夹。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-02T10:40:05.253

我收到与以下相同的警告：

```
[jiewmeng@JM SenchaSDKTools-2.0.0-beta3]$ ./sencha
[WARN] The current working directory (/opt/SenchaSDKTools-2.0.0-beta3) is not a recognized Sencha SDK or application folder. Running in backwards compatible mode.

Sencha Command v2.0.0 Beta 3
Copyright (c) 2012 Sencha Inc.

usage: sencha COMMAND [ARGS]

The available commands are:
   build                    build a JSB project
   create bootstrapdata     generate boostrap data
   create jsb               generate a minimal JSB project for an app
   create locale            generate a template locale file from source
   create manifest          generate classes manifest
   package                  package your Touch web app into a native bundle
   slice theme              slice a custom theme's images for IE

See 'sencha help COMMAND' for more information on a specific command.... 
```

然后我下载了[Sencha-Touch-2.0.1.1-gpl](http://www.sencha.com/products/touch/download/2.0.1.1/)并将内容解压到我的 web-root（即，`/var/www/sencha-touch-2.0.1.1`），最后下载了 [SenchaSDKTools](http://www.sencha.com/products/sdk-tools/)并以 root 用户身份通过​​终端安装，如下所示：

```
root@user:/your/directory/where yo downloaded the sdk tool# ./SenchaSDKTool-2.0.1-beta3.run 
```

然后我等待安装程序解压缩文件并选择安装目录与我放置 Sencha-Touch 库的位置相同，我们有以下内容：

```
root@user:/var/www/sencha-touch-2.0.1.1# ./sencha
Sencha Command v2.0.2
Copyright (c) 2012 Sencha Inc. 
```

..这就是人们在sencha中快乐编码的原因:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T11:24:57.440

@todotresde 你能否分享一个关于如何在 Mac OS X 上配置它的完整配方。

我刚刚在 /Applications 文件夹中下载并安装了 Sencha SDK，但我不想按照 SenchaDocs 中的说明在该文件夹中填充 Sencha 应用程序 [http://docs.sencha.com/touch/2-0/# !/指南/命令](http://docs.sencha.com/touch/2-0/#!/guide/command)

cd /path/to/sencha-touch-2-sdk

煎茶

SDK 安装将 SDK 路径变量添加到 ~/.bash_profile

导出 PATH=/Applications/SenchaSDKTools-2.0.0-beta3:$PATH

导出 SENCHA_SDK_TOOLS_2_0_0_BETA3="/Applications/SenchaSDKTools-2.0.0-beta3"

我在这里看到了一些好的建议：

[http://www.sencha.com/learn/a-sencha-touch-mvc-application-with-phonegap/](http://www.sencha.com/learn/a-sencha-touch-mvc-application-with-phonegap/)

根据标准 Sencha 应用程序架构，下载 SDK，然后将其放置（或符号链接）在名为 touch 的 lib 目录中。我们将把我们自己的代码放在 app 目录中

重要提示：当您进行开发或试验时，可以像这样简单地将整个 SDK 放在 lib 文件夹中。但在部署时，请确保该文件夹中仅保留所需的 JavaScript 和 CSS 文件，并删除 SDK 的其余部分。您不想在您的应用程序中编译和分发整个 Sencha Touch SDK。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T03:27:17.507

首先，将 SenchaSDK 文件夹添加到您的路径中，

```
export PATH=$PATH:/your/path/to/SenchaSDK 
```

然后设置 SENCHA_SDK_TOOLS_2_0_0_BETA3 环境变量，

```
export SENCHA_SDK_TOOLS_2_0_0_BETA3=/your/path/to/SenchaSDK 
```

现在您进入您的 sencha 库目录，例如 /your/path/to/sencha-touch-2.0.1.1，您应该能够毫无问题地运行 sencha**命令**。

# php - PHP OOP：身份验证器类的工作以通过会话检索当前用户？

> ID：10508865
> 
> 赞同：0
> 
> 时间：2012-05-09T01:50:19.647
> 
> 标签：php, oop

我正在重组应用程序。

在我的应用程序开始时，我需要初始化一个对象来代表当前用户。我正在计划一个身份验证类来处理登录和注销，我想知道用户 id 和数据库检索的初始会话变量检查是否也适用于这个类，或者是否有标准协议？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T02:14:13.767

嗯，当然。*首先*检查用户 ID 的会话变量是正确的做法。

无论使用哪种身份验证，您都必须检查是否有人已经登录。它甚至没有那么复杂。对于最简单的使用：

```
if(isset($_SESSION['logged_status']) && $_SESSION['logged_status'] ==1) {
    $this -> logged = true;
} 
```

但是，作为会话变量的数据库检索部分并不像您希望的那样安全。虽然，缓存记录可以存储在会话中而没有任何风险。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T02:33:54.073

通常我这样做的方式是创建一个通用的 WebUser 类。这个课程基本上是会话的模型。因此，每次应用程序运行时都会创建一个实例。`signIn`然后在那个类上，像/`signOut`之类的不良 dop 方法`isAuthenticated`和其他东西。然后，此类与模型交互以进行身份​​验证，该模型还返回用户实体的某些属性（如 user_id）以供以后使用。虽然我通常也直接在 WebUser 类上为 User 实体创建一个方便的 getter。

# javascript - D3子弹图和ie8

> ID：10508869
> 
> 赞同：1
> 
> 时间：2012-05-09T01:50:40.133
> 
> 标签：javascript, raphael, d3.js

我正在使用[D3 的子弹图示例，](http://mbostock.github.com/d3/ex/bullet.html)除了不支持 SVG 的 IE8 之外没有问题。所以我正在尝试使用[这里](https://stackoverflow.com/questions/9559365/raphael-and-d3-js-better-browser-compatibility)提到的 Raphael SVG 导入。但是我很难理解它应该如何工作。获取项目符号图的 .html() 有点晚了，因为 IE8 在项目符号图的“渲染”之前就抛出了一个错误。

有什么解决办法吗？我应该寻找的指针？

编辑：我刚刚找到了以下项目[d34raphael](http://webmonarch.github.com/d34raphael/)。对于替代解决方案，这个问题仍然存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T02:27:47.377

尝试使用 R2D3。使 D3 在 IE7 和 8 中工作是一个垫片。

[https://github.com/mhemesath/r2d3](https://github.com/mhemesath/r2d3)

# opengl - 没有累积缓冲区的 OpenGL 抗锯齿

> ID：10508872
> 
> 赞同：5
> 
> 时间：2012-05-09T01:50:58.773
> 
> 标签：opengl, antialiasing

在 NVIDIA 卡上，我可以使用累积缓冲区执行全场景抗锯齿，如下所示：

```
if(m_antialias)
{
    glClear(GL_ACCUM_BUFFER_BIT);
    for(int j = 0; j < antialiasing; j++)
    {
        accPerspective(m_camera.FieldOfView(), // Vertical field of view in degrees.
            aspectratio, // The aspect ratio.
            20., // Near clipping
            1000.,
            JITTER[antialiasing][j].X(), JITTER[antialiasing][j].Y(),
            0.0, 0.0, 1.0);

        m_camera.gluLookAt();

        ActualDraw();

        glAccum(GL_ACCUM, float(1.0 / antialiasing));

        glDrawBuffer(GL_FRONT);
        glAccum(GL_RETURN, float(antialiasing) / (j + 1));
        glDrawBuffer(GL_BACK);
    }

    glAccum(GL_RETURN, 1.0);
} 
```

在 ATI 卡上，累积缓冲区没有实现，每个人都说你现在可以用着色器语言来实现。当然，问题在于 GLSL 对于 OpenGL 初学者来说是一个相当高的入门门槛。

谁能指出我如何以 ATI 卡可以做到并且新手可以理解的方式进行全场景抗锯齿的方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-09T02:23:22.013

无论您是否有累积缓冲区，您为什么要以这种方式进行抗锯齿？只需使用[多重采样](http://en.wikipedia.org/wiki/Multisample_anti-aliasing)；它不是免费的，但它比你正在做的便宜得多。

首先，您必须使用多重采样缓冲区创建上下文。这意味着您需要使用[WGL/GLX_ARB_multisample](http://www.opengl.org/registry/specs/ARB/multisample.txt)，这意味着在 Windows 上，您需要进行[两阶段上下文创建](http://www.opengl.org/wiki/Creating_an_OpenGL_Context)。您应该请求一个像素格式，其中包含 1`*_SAMPLE_BUFFERS_ARB`和一些`*_SAMPLES_ARB`. 样本数越大，抗锯齿效果越好（也越慢）。`wglGetPixelFormatAttribfv`您可以使用或获得最大样本数`glXGetConfig`。

一旦你成功地创建了一个带有多重采样帧缓冲区的上下文，你就可以正常渲染了，但有一个例外：调用`glEnable(GL_MULTISAMPLE)`你的设置代码。这将激活多重采样渲染。

这就是你所需要的。

或者，如果您使用的是 GL 3.x 或有权访问[ARB_framebuffer_object](http://www.opengl.org/wiki/Framebuffer_Object)，则可以跳过上下文内容并创建多采样帧缓冲区。您的深度缓冲区和颜色缓冲区必须都具有相同数量的样本。我建议对这些[使用渲染缓冲区](http://www.opengl.org/wiki/Renderbuffer_Object)，因为您仍在使用固定功能（并且您不能从固定功能管道中的多样本纹理进行纹理处理）。

您为颜色和深度创建多重采样渲染缓冲区（它们必须具有相同数量的样本）。您将它们设置在 FBO 中，然后渲染到它们`glEnable(GL_MULTISAMPLE)`中（当然，使用 ）。完成后，您可以使用[`glBlitFramebuffer`](http://www.opengl.org/wiki/GLAPI/glBlitFramebuffer)从多重采样帧缓冲区 blit 到后缓冲区（不应该多重采样）。

> 当然，问题在于 GLSL 对于 OpenGL 初学者来说是一个相当高的入门门槛。

谁说的？初学者从着色器中学习并没有错。事实上，根据我的经验，这样的初学者通常学*得更好*，因为他们更有效地了解正在发生的事情的细节。

# c# - 具有多个 TreeViewItemStyle 的 Silverlight 树视图

> ID：10508874
> 
> 赞同：0
> 
> 时间：2012-05-09T01:51:16.193
> 
> 标签：c#, silverlight, xaml, styles

根据绑定项目 - 我使用不同的数据模板来显示数据。现在我还需要修改树视图本身的行为/样式。是否可以根据对象属性切换项目的样式？现在它只有一个指定：`ItemContainerStyle="{StaticResource TreeViewItemStyleFolder}"`

我想创造第二种风格`TreeViewItemStyleDocument`

当前 XAML（带有自定义样式和模板选择器）

```
<sdk:TreeView ItemsSource="{Binding Items}" 
                      Grid.Row="1" 
                      Style="{StaticResource TreeViewStyle1}" 
                      ItemContainerStyle="{StaticResource TreeViewItemStyleFolder}"
                      >
            <sdk:TreeView.ItemTemplate>
                <sdk:HierarchicalDataTemplate ItemsSource="{Binding SubItems}">
                    <DocumentManagement:DocumentTreeViewItemTemplateSelector 
                        Content="{Binding}">
                        <DocumentManagement:DocumentTreeViewItemTemplateSelector.FolderTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="24" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <!-- FOLDER ICON AND CAPTION -->
                                    <Image Source="{Binding IconSource}" Width="24" Height="24" />
                                    <TextBlock VerticalAlignment="Center" HorizontalAlignment="Left" 
                                   Grid.Column="1" Margin="5,0"
                                   Text="{Binding Folder.FolderId}" FontSize="12" Foreground="#2C2C2C" />
                                </Grid>
                            </DataTemplate>
                        </DocumentManagement:DocumentTreeViewItemTemplateSelector.FolderTemplate>
                        <DocumentManagement:DocumentTreeViewItemTemplateSelector.DocumentTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="24" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                                        <TextBlock FontSize="10" Foreground="#2C2C2C">
                                            <Run Text="Added by" />
                                            <Run Text="{Binding Document.MEMUser.UserName}" />
                                            <Run Text=" on " />
                                            <Run Text="{Binding CreatedOn, Converter={StaticResource DateTimeToStringConverter}}" />
                                        </TextBlock>                                        
                                        <!--BIND COMMANDS TO PARENT ViewModel to process operations-->
                                        <Button Content="Delete" Command="{Binding DataContext.DeleteCommand, ElementName=LayoutRoot}" CommandParameter="{Binding}" />
                                        <Button Content="Download" Command="{Binding DataContext.DownloadCommand, ElementName=LayoutRoot}" CommandParameter="{Binding}" />
                                    </StackPanel>
                                </Grid>
                            </DataTemplate>
                        </DocumentManagement:DocumentTreeViewItemTemplateSelector.DocumentTemplate>
                    </DocumentManagement:DocumentTreeViewItemTemplateSelector>
                </sdk:HierarchicalDataTemplate>
            </sdk:TreeView.ItemTemplate>
        </sdk:TreeView> 
```

**编辑**：

添加了基于属性切换 ItemContainerStyle 的触发器，但我认为问题在于我使用的是分层数据模板。如果我在属性上放置断点`IsFolder`- 没有源对象。

```
<sdk:TreeView x:Name="DocumentsTreeView" ItemsSource="{Binding Items}" 
                      Grid.Row="1" 
                      Style="{StaticResource TreeViewStyleTransparent}">
<!--            ItemContainerStyle="{StaticResource TreeViewItemStyleFolders}"-->
            <i:Interaction.Triggers>
                <ei:DataTrigger Value="False" Binding="{Binding IsFolder}">
                    <ei:ChangePropertyAction TargetName="DocumentTreeView" PropertyName="ItemContainerStyle"                
                                             Value="{StaticResource TreeViewItemStyleFolders}" />
                </ei:DataTrigger>
                <ei:DataTrigger Value="True" Binding="{Binding IsFolder}">
                    <ei:ChangePropertyAction TargetName="DocumentTreeView" PropertyName="ItemContainerStyle" 
                                             Value="{StaticResource TreeViewItemStyleDocuments}" />
                </ei:DataTrigger>
            </i:Interaction.Triggers>
            <sdk:TreeView.ItemTemplate>
                <sdk:HierarchicalDataTemplate ItemsSource="{Binding SubItems}">

                    <DocumentManagement:DocumentTreeViewItemTemplateSelector 
                        Content="{Binding}">
                        <DocumentManagement:DocumentTreeViewItemTemplateSelector.FolderTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="24" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <!-- FOLDER ICON AND CAPTION -->
                                    <Image Source="{Binding IconSource}" Width="24" Height="24" />
                                    <TextBlock VerticalAlignment="Center" HorizontalAlignment="Left" 
                                   Grid.Column="1" Margin="5,0"
                                   Text="{Binding Folder.FolderId}" FontSize="12" Foreground="#2C2C2C" />
                                </Grid>
                            </DataTemplate>
                        </DocumentManagement:DocumentTreeViewItemTemplateSelector.FolderTemplate>
                        <DocumentManagement:DocumentTreeViewItemTemplateSelector.DocumentTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="24" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                                        <TextBlock FontSize="10" Foreground="#2C2C2C">
                                            <Run Text="Added by" />
                                            <Run Text="{Binding Document.MEMUser.UserName}" />
                                            <Run Text="on" />
                                            <Run Text="{Binding Document.CreatedOn, Converter={StaticResource DateTimeToStringConverter}}" />
                                        </TextBlock>                                        
                                        <!--BIND COMMANDS TO PARENT ViewModel to process operations-->
                                        <Button Content="Delete" Command="{Binding DataContext.DeleteCommand, ElementName=LayoutRoot}" CommandParameter="{Binding}" />
                                        <Button Content="Download" Command="{Binding DataContext.DownloadCommand, ElementName=LayoutRoot}" CommandParameter="{Binding}" />
                                    </StackPanel>
                                </Grid>
                            </DataTemplate>
                        </DocumentManagement:DocumentTreeViewItemTemplateSelector.DocumentTemplate>
                    </DocumentManagement:DocumentTreeViewItemTemplateSelector>
                </sdk:HierarchicalDataTemplate>
            </sdk:TreeView.ItemTemplate>
        </sdk:TreeView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T20:35:36.220

如果我理解正确，您希望样式根据属性值动态更改，并且您希望在引用给定样式的页面上的每个项目上全局执行此操作？

如果是这种情况，我建议您查看 Expression Blend 中的情节提要和状态。我没有看到你在描述中提到混合。你在用吗？树视图有许多可以自定义的项目，有些更难。上周我遇到了一个问题，即嵌套在树视图中的超链接无法有效地更改字体颜色。我可能能够在设计上花费更多时间，但我改变了设计意图。

根据我的安装，Silverlight 5 的 Blend 预览版在 2013 年 6 月之前是免费的。 [http://www.microsoft.com/en-us/download/details.aspx?id=9503](http://www.microsoft.com/en-us/download/details.aspx?id=9503)

祝你好运，

# php - 中国邮政EMS API / CSV 下载

> ID：10508877
> 
> 赞同：2
> 
> 时间：2012-05-09T01:51:34.713
> 
> 标签：php, codeigniter, shipping

我正在为客户构建一个快递跟踪应用程序。这是我迄今为止与 UPS、TNT、AAE 和 BPost 合作过的第二次。都有可供使用的 API 或 CSV 下载。

我在 Codeigniter 工作。

我只是想知道是否有人有使用[中国邮政EMS服务](http://www.ems.com.cn/english.html)自动跟踪的经验？获取跟踪数据的唯一方法似乎是单独或分批输入 10 个跟踪代码/验证码。对于每月处理 500-1000 批货物的客户来说，这不太实用。

今天早上我已经搜索了大约 4 个小时关于如何做到这一点，我试着打电话给中国邮政（但不会说中文，所以没有得到任何结果），也发了电子邮件（还没有回复）。

现在我的客户正在谈论如果我们不能让它工作就放弃这个项目——问题是除非我能找到一种检索数据的方法，否则我看不出这是如何实现的。

如果您以前遇到过此问题（并且查看 Google，我可以看到我不是唯一遇到此问题的开发人员），请告诉我您的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-13T20:40:36.683

我知道这是一个老问题，但我一直在寻找解决同一问题的方法，现在，我发现的潜在解决方案是：

*   我找到了一个[Python GUI 脚本](https://github.com/gotlium/track-china-post-air-mail)，它使用*track-chinapost.com*和验证*码断路器*来获取跟踪信息
*   另一个潜在的解决方案是在许多其他快递公司中使用支持中国邮政的[AfterShip](http://www.aftership.com) API，但它非常昂贵，我认为它不适合您的情况......

如果您找到其他解决方案，请告诉我...

# javascript - 如何在 emberjs 中定义“类属性”？

> ID：10508880
> 
> 赞同：1
> 
> 时间：2012-05-09T01:51:54.353
> 
> 标签：javascript, ember.js

假设我正在对 Ember.View 进行子类化（“扩展”）以创建 My.Widget。我希望每个 My.Widget 子类都有一个名为“XMLTag”的“类属性”，可用于从 XML 文档中反序列化。

```
My.Widget = Ember.View.extend( { /*...*/ });
My.MySubWidget = My.Widget.extend( { /*...*/ });
My.MySubWidget.XMLTag = 'MySubWidget'; 
```

这是解决这个问题的正确方法吗？或者我可以在“extend()”中使用某种技巧来指定它的类属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T12:00:19.230

The proper way to extend class level variables or methods is reopenClass(), e.g.:

```
My.SubWidget.reopenClass({
  xmlTag: 'mysubwidget'
}); 
```

Simply adding the property to My.SubWidget will *not* be retained if you further extend the class.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T06:41:05.183

您可以通过`classNames`属性添加类`Ember.View`：该属性是一个字符串数组，它们被添加到`class`具体视图的属性中。由于它是所谓的*串联属性*，子类不会覆盖`classNames`超类的，而是扩展它——因此超类的类名不会被覆盖。

我创建了一个示例，请参见[http://jsfiddle.net/pangratz666/xMBQ4/](http://jsfiddle.net/pangratz666/xMBQ4/)：

```
My.Widget = Ember.View.extend({
    classNames: 'my-widget'.w(),
    didInsertElement: function(){
        var classes = this.$().attr('class');
        console.log(classes);
    }
});
My.MySubWidget = My.Widget.extend({
    classNames: 'my-sub-widget XMLTag'.w()
});

My.MySubWidget.create({
    classNames: 'class1 class2'.w(),
    templateName: 'mySubWidget'
}).append();​ 
```

`My.MySubWidget`添加视图时，这将打印以下内容： `ember-view my-widget my-sub-widget XMLTag class1 class2`.

# node.js - CoffeeScript 编译 express.static __dirname + '/public' 错误

> ID：10508883
> 
> 赞同：1
> 
> 时间：2012-05-09T01:52:21.957
> 
> 标签：node.js, coffeescript

我对 CoffeeScript 很陌生。我正在尝试使用 Express.js 框架创建 Node.js 应用程序。在我的快速应用程序配置中，这行代码编译错误：

```
app.use express.static path + '/public' 
```

它正在编译：

```
app.use(express["static"](path + '/public')); 
```

当我需要这样的时候：

```
app.use(express.static(path + '/public')); 
```

有谁知道为什么会发生这种情况以及如何解决这个问题？它导致我的公用文件夹无法访问。

我正在使用 CoffeeScript 1.3.1

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-09T02:20:34.457

`static`可能是 javascript/ecmascript 未来版本中的保留字。就像`top`现在一样。因此，将其用作变量名可能会在某处导致错误。

这就是为什么咖啡试图避免它。

但它们是等价的，因此请尝试在其他地方查找错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T02:07:05.240

它们是等价的，不用担心。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-14T12:59:57.837

Express 框架使用“serve-static”模块导出静态方法：

```
exports.static = require('serve-static'); 
```

您可以尝试像这样解决您的问题：

```
app.use '/static', require('serve-static')(__dirname + '/static') 
```

或覆盖模块中的静态方法。

# oracle - Oracle Data Integrator 有没有办法从 MongoDB 中提取数据

> ID：10508884
> 
> 赞同：7
> 
> 时间：2012-05-09T01:52:37.013
> 
> 标签：oracle, mongodb, etl

我正在尝试将数据快照从我们的 MongoDB 移动到我们的 Oracle BI 数据存储中。

BI 团队要求我为 ODI 提供可用数据，但我找不到这样做的示例。

有可能吗？我需要什么来实现它？

如果有更通用的方式将 MongoDB 数据导入 Oracle，那么我也很乐意提出这个建议。

**版本**

*   MongoDB：2.0.1
*   对外直接投资：11.1.1.5
*   甲骨文：11.2g

编辑：这是每天查询一次的东西，也许是两次，但在这个阶段，BI 报告粒度是每天

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:33:04.170

在 ODI 中，在 Topology 选项卡和 Physical Architecture 子选项卡下，您可以看到所有开箱即用支持的技术。MongoDB 不是其中之一。也没有可用于从 MongoDB 导入/导出的知识模块。

ODI 支持实现您自己的技术和您自己的知识模块。 [本手册](http://docs.oracle.com/cd/E23943_01/integrate.1111/e12645/toc.htm)将帮助您开始开发您赢得的知识模块，并且[在其他手册之一中，](http://docs.oracle.com/cd/E23943_01/nav/portal_booklist.htm)我相信您可以找到有关如何实施您自己的技术的解释。（Ctrl-F 表示“数据积分器”）

如果幸运的话，您可能会找到其他已经实现它的人。最好的地方是[Oracle 技术网络论坛](https://forums.oracle.com)，或与 MongoDB 相关的论坛。

除了创建直接链接，您还可以采取更简单的解决方法。将数据从 MongoDB 导出为 ODI 支持的格式，MongoDB 可以提取到该格式。也许是 CSV 或 XML？然后通过 ODI 将数据加载到 oracle 数据库中。我认为...这将是最好的选择，除非您必须经常这样做...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T04:24:21.627

查看下面的博客文章以获取选项； [https://blogs.oracle.com/dataintegration/entry/odi_mongodb_and_a_java](https://blogs.oracle.com/dataintegration/entry/odi_mongodb_and_a_java)

干杯大卫

# sql - SQL Server 2005 在一个视图中连接多个表时某些表可能不存在

> ID：10508899
> 
> 赞同：2
> 
> 时间：2012-05-09T01:54:51.250
> 
> 标签：sql, sql-server-2005

我需要创建一个视图，但是数据是从应用程序生成的，该应用程序具有自己的数据库管理表，基于列数可以为一个内部表定义创建超过 7 个 SQL Server 表。

表格都以 ['m' & number] 结尾，例如`devicem1`，`devicem2`...`devicem10`

它们都包含`logical_name`作为它们的主键，但你永远不能依赖哪个表将包含内部表中的任何其他列！

我需要创建一个将表连接在一起的视图，`device`这样当应用程序更改时它不会弄乱我想要创建的任何存储过程。

基于此查询：

```
CREATE VIEW device AS
   SELECT *
   FROM devicem1 m1, devicem2 m2, devicem3 m3, ... devicem10 m10
   WHERE m1.logical_name = m2.logical_name
   AND m1.logical_name = m3.logical_name
   ...
   AND m1.logical_name = m10.logical_name 
```

有没有办法加入十个表，我可以**忽略**`devicem9`&`devicem10`可能不存在的事实？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T02:38:08.063

关于视图的要求。创建视图时，引用的表必须存在。SQL 引擎不允许您创建引用不存在的表的视图。

考虑到视图只是一个存储的选择语句，在它创建之后可以删除表（只要模式绑定不在游戏中）；但是，任何时候调用或使用视图时，所有引用的表都必须存在，否则会抛出错误。

此外，您可以更改引用表的架构，只要它不删除视图中专门使用的任何字段，但同样，如果视图使用的特定列丢失，使用视图的任何查询都将失败。

您可能更幸运地摆脱了您尝试使用一些创造性的表值函数和动态 sql 所做的事情。表值函数基本上只是一个允许参数和扩展逻辑的视图。

总而言之，我想说你的描述听起来有点粗略。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T02:52:34.800

我会定期根据可用的表重新创建视图。

因此，如果应用程序每晚运行以创建表，那么在应用程序运行后，检查哪些表可用并重新创建视图。

最后，您将不得不使用动态 sql，执行以下操作：

```
declare @sql varchar(max);

select @sql = (select '(select * from '+table_name+') union all'
               from information_schema.tables
               for xml path (''));
set @sql = left(@sql, len(@sql) - 10);

set @sql = 'create view <whatever> as '+@sql;
exec(@sql); 
```

# ruby-on-rails - Mongoid 复制配置导致 ArgumentError

> ID：10508901
> 
> 赞同：1
> 
> 时间：2012-05-09T01:55:20.057
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongoid

我将复制添加到我的 mongoid 生产部分，如下所示：

```
production:
  hosts:
    - - <%= ENV['MONGO_URL1'] %>:<%= ENV['MONGO_PORT'] %>
    - - <%= ENV['MONGO_URL2'] %>:<%= ENV['MONGO_PORT'] %>
  read: :secondary
  username: <%= ENV['MONGO_USERNAME'] %>
  password: <%= ENV['MONGO_PASSWORD'] %>
  database: <%= ENV['MONGO_DATABASE'] %>
  max_retries_on_connection_failure: 10 
```

这在 Heroku 上的生产中有效，但在本地，它导致我的服务器在开始出现错误时失败：

> ROOT /Users/bashar/rails-projects/my-project /Users/bashar/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/syck.rb:135:in `load': syntax error on line 13, col 9:` - - :' (ArgumentError) 来自 /Users/bashar/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/syck.rb:135:in `load' from /Users/bashar/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/mongoid-2.4.7/lib/mongoid/railtie.rb:83:in` block in 来自 /Users/bashar/.rvm/rubies /ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/railties-3.1.3/lib/rails/initializable.rb:30:in `instance_exec' from /Users/bashar/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/railties-3.1.3/lib/rails/initializable.rb:30:in` run' 来自 /Users/bashar/.rvm/rubies /ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/railties-3.1.3/lib/rails/initializable.rb:55:in `block in run_initializers' from /Users/bashar/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/railties-3.1.3/lib/rails/initializable.rb:54:in` each' 来自 /Users/bashar/.rvm/rubies /ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/railties-3.1.3/lib/rails/initializable.rb:54:in `run_initializers' from /Users/bashar/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/railties-3.1.3/lib/rails/application.rb:96:in` 初始化！' 来自 /Users/bashar/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/railties-3.1.3/lib/rails/railtie/configurable.rb:30:in `method_missing' from /Users/bashar/rails-projects/my-project/config/environment.rb:5:in` ' 来自 /Users/bashar/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:240:in`require' from /Users/bashar/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:240:in`块在 /Users/bashar/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:223 的要求中：在`block in load_dependency' from /Users/bashar/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:640:in`/Users/bashar/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:223 的 new_constants_in' 中：在`load_dependency' from /Users/bashar/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:240:in`/Users/bashar/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/railties-3.1.3/lib/rails/application.rb:83 的要求中： in `require_environment!' from /Users/bashar/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/railties-3.1.3/lib/rails/commands.rb:39:in` '来自脚本/rails:6:in`require' from script/rails:6:in`'  ~/rails-projects/my-project/ [主]

我正在使用 Rails 3.1.3 Mongo 1.6.2 Mongoid 2.4.9 MongoDB 版本 2.0.2

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T10:04:33.300

您的配置文件应如下所示：

```
production:
  hosts:
    - <%= ENV['MONGO_URL1'] %>:<%= ENV['MONGO_PORT'] %>
    - <%= ENV['MONGO_URL2'] %>:<%= ENV['MONGO_PORT'] %>
  read: :secondary
  username: <%= ENV['MONGO_USERNAME'] %>
  password: <%= ENV['MONGO_PASSWORD'] %>
  database: <%= ENV['MONGO_DATABASE'] %>
  max_retries_on_connection_failure: 10 
```

它将被解决为：

```
hosts: [ 'host1:port1', 'host2:port2'] 
```

将主机和端口作为两个不同的东西时，您需要双数组：

```
hosts: [ ['host1', 'port1'], ['host2', 'port2'] ] 
```

# git - 为什么不能将 stash 应用到工作目录？

> ID：10508903
> 
> 赞同：105
> 
> 时间：2012-05-09T01:55:32.280
> 
> 标签：git, git-stash

我无法将存储应用回工作目录。

**小故事：**

首先，我尝试推送一些已提交的更改，但它说：“不，你不能，先拉”......好吧，我将从 GitHub 拉东西，然后推送我的更改。当我尝试拉取时，它说我的更改将被覆盖，并且我应该隐藏我的更改。好的，我隐藏了更改……拉动并推送已提交的更改。但是现在，我无法恢复我正在处理的未提交的更改。

*这是错误：*

```
MyPath/File.cs already exists, no checkout
Could not restore untracked files from stash 
```

当然，我还不了解 git 的所有概念，它们让我有点困惑……也许我做错了什么。

如果有人可以帮我解决这个问题，那就太好了......我已经搜索了一个多小时的谷歌和所有内容，但我还没有找到解决方案。

非常感谢您的帮助。谢谢！

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-05-09T01:57:58.303

听起来您的 stash 包含一个未跟踪的文件，该文件随后被添加到 repo 中。当您尝试检查它时，git 正确地拒绝了，因为它会覆盖现有文件。

要修复，您可以执行一些操作，例如删除该文件（没关系，它仍在 repo 中），应用您的存储，然后根据需要将文件的隐藏版本替换为 in-repo 版本。

**编辑：**也有可能该文件仅在工作树中创建*而*没有添加到存储库中。在这种情况下，不要简单地删除本地文件，而是：

1.  把它移到别的地方
2.  应用存储
3.  手动合并两个文件版本（工作树与移动）。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2012-05-10T20:00:04.887

最安全和最简单的方法可能是再次存储东西：

```
git stash -u             # This will stash everything, including unstaged files
git stash pop stash@{1}  # This will apply your original stash 
```

之后，如果您对结果感到满意，您可以致电

```
git stash drop 
```

删除您的“安全”藏匿处。

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2013-01-29T00:35:46.057

正如@bentolo 所提到的，您可以手动删除它抱怨的文件，切换分支，然后手动将它们添加回来。但我个人更喜欢留在“git 内”。

最好的方法是将存储转换为分支。一旦它成为一个分支，您就可以使用您熟悉和喜爱的正常分支相关技术/工具在 git 中正常工作。这实际上是一种有用的通用技术，即使您没有列出的错误，也可以使用 stash。它运作良好，因为 stash 确实是在幕后提交（参见 PS）。

# 将存储转换为分支

以下内容在创建存储时基于 HEAD 创建一个分支，然后应用存储（它不提交）。

```
git stash branch STASHBRANCH 
```

# 使用“stash 分支”

您接下来要做什么取决于存储与您的目标分支（我将称之为 ORIGINALBRANCH）现在所在的位置之间的关系。

## 选项 1 - 通常重新设置 stash 分支（自 stash 以来进行了大量更改）

如果您在 ORIGINALBRANCH 中进行了很多更改，那么您最好将 STASHBRANCH 视为任何本地分支。在 STASHBRANCH 中提交您的更改，将其重新设置在 ORIGINALBRANCH 上，然后切换到 ORIGINALBRANCH 并重新设置/合并 STASHBRANCH 对其的更改。如果存在冲突，则正常处理它们（这种方法的优点之一是您可以看到并解决冲突）。

## 选项 2 - 重置原始分支以匹配存储（存储后更改有限）

如果您只是在保留一些暂存更改的同时进行隐藏，然后提交，那么您要做的就是获得隐藏时未暂存的其他更改，您可以执行以下操作。它将切换回您的原始分支和索引，而无需更改您的工作副本。最终结果将是您在工作副本中的额外存储更改。

```
git symbolic-ref HEAD refs/heads/ORIGINALBRANCH
git reset 
```

# 背景

## Stashes 是提交，例如分支/标签（不是补丁）

PS，很容易将存储视为补丁（就像将提交视为补丁一样），但存储实际上是在创建时针对 HEAD 的提交。当您应用/弹出时，您正在做类似于将其挑选到当前分支中的事情。请记住，分支和标签实际上只是对提交的引用，因此在许多方面，存储、分支和标签只是指向提交（及其历史）的不同方式。

## 即使您没有更改工作目录，有时也需要

PPS，您可能在仅使用带有 --patch 和/或 --include-untracked 的 stash 后需要此技术。即使不更改工作目录，这些选项有时也会创建一个无法应用的存储库。我必须承认不完全理解为什么。有关一些讨论，请参阅[http://git.661346.n2.nabble.com/stash-refuses-to-pop-td7453780.html](http://git.661346.n2.nabble.com/stash-refuses-to-pop-td7453780.html)。

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2014-05-19T16:50:52.833

*解决方案：*您需要删除有问题的文件，然后尝试再次存储 pop/apply，它应该会通过。不要删除其他文件，只删除错误中提到的文件。

*问题：* Git 有时很糟糕。运行时`git stash -u`，它包含未跟踪的文件（酷！），但它**不会**删除那些未跟踪的文件，**也不**知道如何将隐藏的未跟踪文件应用到剩余文件之上（不酷！），这确实使该`-u`选项非常无用。

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2017-10-05T20:29:24.130

要将存储中的代码差异作为补丁应用，请使用以下命令：

```
git stash show --patch | patch -p1 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-08-09T17:15:04.477

这在我身上发生过很多次，我存储了未跟踪的文件，`git stash -u`这些文件最终被添加到了 repo 中，我无法再应用隐藏的更改。

我找不到强制`git stash pop/apply`替换文件的方法，所以我首先删除隐藏的未跟踪文件的本地副本（**小心，因为它会删除任何尚未提交**的更改），然后应用隐藏的更改：

```
rm `git ls-tree -r stash@{0}^3 --name-only`
git stash apply 
```

最后，如果缺少某些内容，我会使用`git status`,和其他工具检查并从已删除的文件中添加回部分。`git diff`

* * *

如果您有想要保留的未提交更改，您可以先创建一个临时提交：

```
git add --all
git commit -m "dummy"
rm `git ls-tree -r stash@{0}^3 --name-only`
git stash apply 
```

使用适合您的任何工具将先前提交的更改合并回本地文件，并删除虚拟提交：

```
git reset HEAD~1 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-20T07:25:54.670

解决此问题的一种简单方法是将现有的冲突文件重命名为非冲突文件。

在您的情况下，重命名`File.cs`为`File.new.cs`并重新运行`git stash apply/pop`，这次您不会收到错误，并且会同时拥有`File.cs`和供`File.new.cs`您使用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-03-12T11:22:15.157

尝试这个：

git checkout stash -- .

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-05-11T00:18:34.163

我同样被阻止的弹出操作是因为剩余的**忽略**文件（请参阅 .gitignore 文件）。Git 状态显示我被跟踪和未跟踪，但我的活动没有清理被忽略的文件。

**详细信息：**我曾经使用过`git stash save -a`，签出大师编译并查看原始行为，然后尝试将其全部放回去继续编辑。当我检查我的分支并尝试弹出时，我忽略的文件在存储保存之前仍然存在。那是因为 master 的检出只影响提交的文件——它没有擦除被忽略的文件。所以弹出失败了，基本上说它不想在仍然存在的文件之上恢复我隐藏的忽略文件。不幸的是，我无法找到与他们开始合并会话的方法。

最终，我曾经`git clean -f -d -x`删除了被忽略的文件。有趣的是，在我的大约 30 个文件中，清理后仍有 4 个文件（埋在子目录中）。我必须弄清楚它们属于哪个类别，必须手动删除它们。

然后我的pop成功了。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2017-09-03T20:01:03.217

使用 Git 2.14.x/2.15（2017 年第三季度），不再需要[qwertzguy](https://stackoverflow.com/users/965176/qwertzguy)从 2014 年开始的[解决方案。](https://stackoverflow.com/a/23743125/6309)

在 2017 年第三季度之前，您必须删除有问题的文件，然后再次尝试存储 pop/apply。
在下一个 Git 版本中，您将不必这样做。

请参阅[Nicolas Morey-Chaisemartin (](https://github.com/nmorey) [)的](https://github.com/nmorey)[提交 bbffd87](https://github.com/git/git/commit/bbffd87d3223b2f5782918eab2e011931bdffdcc)（2017 年 8 月 11 日） 。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 0ca2f32](https://github.com/git/git/commit/0ca2f3241aadd99265b3e864fe68dddffdeff84f))^(中，2017 年 8 月 23 日）)[`nmorey`](https://github.com/nmorey)
^([`gitster`](https://github.com/gitster))

> ## `stash`：在重置之前清理未跟踪的文件
> 
> 如果调用`git stash -u`包含由于文件的当前修改而不再被忽略的`gitignore`文件的存储库，则该文件将被隐藏但不会从工作树中删除。
> 这是由于`git-stash`首先执行 a`reset --hard`清除 `.gitignore`文件修改然后调用`git clean`，使文件保持不变。**由于文件存在，**
> **这会导致`git stash pop`**失败。
> 
> 此补丁只是在清理和重置之间切换顺序，并为此用例添加测试。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2017-01-24T07:12:45.000

其他解决方案：

```
cd to/root/your/project

# Show what git will be remove
git clean -n

# If all is good
git clean -f

# If not all is good, see
git clean --help

# Finish
git stash pop 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2017-09-05T00:38:19.210

跟踪存储的最安全方法

git stash -u

# 这将隐藏所有内容，包括未分阶段的更改

git 存储下降

完成工作后，删除“安全”存储。

# java - 如何对 ArrayList 进行排序

> ID：10508909
> 
> 赞同：3
> 
> 时间：2012-05-09T01:56:49.940
> 
> 标签：java

我所需要的只是对不使用内置 Java 排序器的 ArrayList 进行排序的最简单方法。目前我将 ArrayList 更改为 Array 并使用线性排序代码，但我稍后需要调用一些元素，而 ArrayLists 更容易做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T02:06:40.100

您可以使用匿名排序。

```
Collections.sort(<ArrayList name>, Comparator<T>() {

    public int compare(T o1, T o2) {
    .....
    ....
    }      
}); 
```

其中 T 是您要排序的类型（即字符串、对象）并根据您自己的需要简单地实现 Comparator 接口

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T02:15:17.980

假设“内置排序”是指 Collections.sort() 并且您对已实现的排序算法很好，您可以将排序后的数组转换为`ArrayList`

```
ArrayList list = new ArrayList(Arrays.asList(sortedArray)); 
```

`get(int index)`或者，您可以使用and`set(int index, E element)`方法重写排序算法以使用列表（例如 ArrayList）而不是数组。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-09T02:00:10.287

假设`ArrayList<String> a`...

最简单（但我猜这是你说你不能使用的）：

```
Collections.sort(a); 
```

下一个最简单的（但浪费）：

```
a = new ArrayList<String>(new TreeSet<String>(a)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-09T09:11:49.610

排序通过命令提示符传递的参数；不使用 Arrays.sort

```
public class Sort {

    public static void main(String args[]) 
    {
        for(int j = 0; j < args.length; j++) 
        {
            for(int i = j + 1; i < args.length; i++) 
            {
                if(args[i].compareTo(args[j]) < 0) 
                {
                    String t = args[j];
                    args[j] = args[i];
                    args[i] = t;
                }
            }
            System.out.println(args[j]);
        }
    }
} 
```

通过使用 Array.sort

```
import java.util.*;
public class IntegerArray {

    public static void main(String args[])
    {
        int[] num=new int[]{10, 15, 20, 25, 12, 14};
    Arrays.sort(num);
        System.out.println("Ascending order: ");
        for (int i=0; i<num.length; i++)
            System.out.print(num[i] + " ");
        }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-09T09:37:09.657

这是一个“简单”的快速排序实现：

```
public Comparable<Object>[] quickSort(Comparable<Object>[] array) {
    if (array.length <= 1) {
        return array;
    }

    List<Comparable<Object>> less = new ArrayList<Comparable<Object>>();
    List<Comparable<Object>> greater = new ArrayList<Comparable<Object>>();
    Comparable<Object> pivot = array[array.length / 2];

    for (int i = 0;i < array.length;i++) {
        if (array[i].equals(pivot)) {
            continue;
        }
        if (array[i].compareTo(pivot) <= 0) {
            less.add(array[i]);
        } else {
            greater.add(array[i]);
        }
    }

    List<Comparable<Object>> result = new ArrayList<Comparable<Object>>(array.length);
    result.addAll(Arrays.asList(quickSort(less.toArray(new Comparable<Object>[less.size()]))));
    result.add(pivot);
    result.addAll(Arrays.asList(quickSort(greater.toArray(new Comparable<Object>[greater.size()]))));
    return result.toArray(new Comparable<Object>[result.size()]);
} 
```

使用数组和列表构建结果的最后一个操作可以使用`System.arraycopy`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-09T03:06:39.650

如果您打算自己对数组进行排序，那么最简单的算法之一就是冒泡排序。这通过多次遍历数组，比较相邻的元素对，如果左侧大于右侧则交换它们。

由于这是家庭作业，剩下的就交给你了。首先可视化您的算法，然后考虑您的算法需要进行多少次通过，以及每次通过需要从哪里开始。然后编码。

您还需要了解并解决如何比较一对数组元素的问题：

*   如果元素是原始类型的实例，则只需使用关系运算符。
*   如果元素是引用类型的实例，则需要使用`Comparable`or`Comparator`接口。在 javadocs 中查找它们。（查找它们是*您*作业的一部分……）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-09T02:00:20.347

`Comparator`在java中检查。您可以使用它实现自己的排序，并使用`Collections.sort(..)`您自己的来对数组列表进行排序`Comparator`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-09T02:03:15.557

如果我没记错的话，当你从 arrayList 中间拉出一个元素时，它会自动将其余元素向下移动。如果您执行一个循环来查找最小值并将其拉出，则将其放在 arrayList 的末尾。每次通过 i-- 用于索引。那就是少用一个。因此，在 10 个元素的列表中，您将查看所有 10 个元素，取最低的一个并将其附加到末尾。然后，您将查看前九个并取出其中最低的一个并将其附加到末尾。然后是前 8 个，依此类推，直到列表排序。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-09T01:59:56.320

[Collections.sort(List);](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#sort%28java.util.List%29)

# linux-kernel - 如何在 /proc/meminfo 中计算 MemTotal

> ID：10508913
> 
> 赞同：4
> 
> 时间：2012-05-09T01:57:29.803
> 
> 标签：linux-kernel

当我`cat /proc/meminfo`，报告如下：

```
MemTotal:        2034284 kB
MemFree:         1432728 kB
Buffers:           16568 kB
Cached:           324864 kB
SwapCached:            0 kB
Active:           307344 kB
Inactive:         256916 kB
Active(anon):     223020 kB
Inactive(anon):    74372 kB
Active(file):      84324 kB
Inactive(file):   182544 kB
Unevictable:           0 kB
Mlocked:               0 kB
HighTotal:       1152648 kB
HighFree:         600104 kB
LowTotal:         881636 kB
LowFree:          832624 kB
SwapTotal:       4200960 kB
SwapFree:        4200960 kB
Dirty:                60 kB
Writeback:             0 kB
AnonPages:        222868 kB
Mapped:            80596 kB
Shmem:             74564 kB
Slab:              24268 kB
SReclaimable:      14024 kB
SUnreclaim:        10244 kB
KernelStack:        1672 kB
PageTables:         2112 kB
NFS_Unstable:          0 kB
Bounce:                0 kB
WritebackTmp:          0 kB
CommitLimit:     5218100 kB
Committed_AS:     833352 kB
VmallocTotal:     122880 kB
VmallocUsed:       13916 kB
VmallocChunk:      50540 kB
HugePages_Total:       0
HugePages_Free:        0
HugePages_Rsvd:        0
HugePages_Surp:        0
Hugepagesize:       4096 kB
DirectMap4k:       20472 kB
DirectMap4M:      888832 kB 
```

我有一个计算 Memtotal 的公式：

Memtotal = MemFree + Cached + Active + Inactive + Mapped + Shmem + Slab + PageTables + VmallocUsed

但我不知道公式是否正确，任何人都可以帮助澄清它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-13T08:44:39.993

我认为很难从 meminfo 中获得确切的值（基于加法的总内存验证）。尽管如此，在我看来，以下应该会导致您接近 TotalMemory 数字。

TotalMemory = MemFree + Buffers + Cached + Dirty + AnonPages + Slab + VmAllocUsed

在你的例子中 1432728 + 16568 + 324864 + 60 + 222868 + 24268 + 13916 = 2035272 一些参考： [http ://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/Documentation/ filesystems/proc.txt?id=HEAD#l451](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/Documentation/filesystems/proc.txt?id=HEAD#l451) （来自上面建议的另一篇 stackoverflow 文章）除此之外，我相信波动性是因为 VmAllocUsed。

# batch-file - 如何在批处理文件中模拟“mv --no-clobber”？

> ID：10508915
> 
> 赞同：0
> 
> 时间：2012-05-09T01:57:46.993
> 
> 标签：batch-file, mv

顾名思义，如果请求的移动将覆盖现有文件，则命令（至少是 Gnu 版本）的`--no-clobber`(or `-n`) 标志会导致命令失败。`mv`

如何在 Windows 批处理文件中进行模拟？

（顺便说一句，预计的批处理文件旨在自动运行（即无监督），因此任何需要提示人类用户许可的解决方案都已淘汰。）

谢谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-09T02:06:27.613

```
> MOVE /?
Moves files and renames files and directories.

To move one or more files:
MOVE [/Y | /-Y] [drive:][path]filename1[,...] destination

To rename a directory:
MOVE [/Y | /-Y] [drive:][path]dirname1 dirname2

  [drive:][path]filename1 Specifies the location and name of the file
                          or files you want to move.
  destination             Specifies the new location of the file. Destination
                          can consist of a drive letter and colon, a
                          directory name, or a combination. If you are moving
                          only one file, you can also include a filename if
                          you want to rename the file when you move it.
  [drive:][path]dirname1  Specifies the directory you want to rename.
  dirname2                Specifies the new name of the directory.

  /Y                      Suppresses prompting to confirm you want to
                          overwrite an existing destination file.
  /-Y                     Causes prompting to confirm you want to overwrite
                          an existing destination file.

The switch /Y may be present in the COPYCMD environment variable.
This may be overridden with /-Y on the command line.  Default is
to prompt on overwrites unless MOVE command is being executed from
within a batch script.

> ECHO N | MOVE /-Y OLDFILE NEWFILE 
```

或者：

```
IF NOT EXIST NEWFILE MOVE OLDFILE NEWFILE 
```

结合用于多个文件的 FOR 循环。

# jquery - 将 Knockout 与 jQuery 混合使用

> ID：10508916
> 
> 赞同：4
> 
> 时间：2012-05-09T01:57:47.710
> 
> 标签：jquery, jquery-templates, knockout.js

我正在使用 knockout.js 创建一个评论系统，但在让模板与我们现有的 jQuery 函数一起工作时遇到了一些问题。

一个例子是创建评论的日期。我写了一个 jQuery 函数，它使数据从`5-5-2012`变成`2 Days ago`. 例如：

```
 <ul data-bind="foreach: Comments">
        <li data-bind="attr: { id: Id }" class="Comment">
           <div data-bind="text: DateCreated" class="prettyDate"></div>
           ...
        </li>
    </ul>

    <script type="text/javascript">
          $(function(){
              $(".prettyDate").prettify();
          });
    </script> 
```

使用此代码，当我动态添加新评论时，日期保持`5-5-2012`格式不变。还有其他几个自定义的 jQuery 函数作用于重复数据，这些数据现在由敲除动态创建（通常通过基于类的选择）。

如何将这些自定义 jQuery 函数应用于由 knockout.js 生成的动态数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T06:15:53.793

一种选择可能是使用自定义绑定处理程序，该处理程序通过您的 jQuery 插件发送绑定元素，例如：

[http://jsfiddle.net/mikebridge/Q9r86/4/](http://jsfiddle.net/mikebridge/Q9r86/4/)

另一种可能性可能是在您的视图模型中添加计算的 observable。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-20T14:02:04.617

> 如果您需要在生成的 DOM 元素上运行一些进一步的自定义逻辑，您可以使用下面描述的任何 afterRender/afterAdd/beforeRemove/beforeMove/afterMove 回调。

```
<ul data-bind="foreach: { data: myItems, afterAdd: yellowFadeIn }">
    <li data-bind="text: $data"></li>
</ul>
<button data-bind="click: addItem">Add</button>

<script type="text/javascript">
    ko.applyBindings({
        myItems: ko.observableArray([ 'A', 'B', 'C' ]),
        yellowFadeIn: function(element, index, data) {
            $(element).filter("li")
                      .animate({ backgroundColor: 'yellow' }, 200)
                      .animate({ backgroundColor: 'white' }, 800);
        },
        addItem: function() { this.myItems.push('New item'); }
    });
</script> 
```

来源： http: [//knockoutjs.com/documentation/foreach-binding.html#note-7-post-processing-or-animating-the-generated-dom-elements](http://knockoutjs.com/documentation/foreach-binding.html#note-7-post-processing-or-animating-the-generated-dom-elements)

但是，请注意以下注意事项：

> 如果您的目标实际上是在添加新的 DOM 元素时将其他行为附加到它们（例如，事件处理程序或激活第三方 UI 控件），那么如果您将新行为作为自定义实现，您的工作会容易得多改为绑定

# android - Android 相机应用程序 - 必须重新安装 SD 卡？

> ID：10508920
> 
> 赞同：0
> 
> 时间：2012-05-09T01:58:03.530
> 
> 标签：android, camera, sd-card

我正在开发一个使用相机拍照并将照片存储在 SD 卡上的应用程序。问题是，在我保存照片后，我必须先卸载并重新安装 SD 卡，然后才能在 Gallery 应用程序中看到照片。

每次用户拍照时，我是否应该通过我的应用程序卸载并重新安装 SD 卡？有没有更好的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T02:39:57.317

您无法从应用程序安装/卸载 SD 卡（外部存储）。您可能需要调用媒体扫描仪来为您的图片编制索引。在[此处](http://developer.android.com/reference/android/media/MediaScannerConnection.html#scanFile%28android.content.Context,%20java.lang.String%5B%5D,%20java.lang.String%5B%5D,%20android.media.MediaScannerConnection.OnScanCompletedListener%29)和[此处](http://developer.android.com/guide/topics/data/data-storage.html#filesExternal)查看指针。SDK 还附带了一个示例应用程序。顺便说一句，您正在测试哪个 Android 版本？

# html - 表单动作——调用 HREF 时

> ID：10508923
> 
> 赞同：3
> 
> 时间：2012-05-09T01:59:00.133
> 
> 标签：html, asp-classic

我有一个关于表单操作的基本问题。

考虑下面的代码，如果有的话，请忽略语法。

```
<form action="demo_form.asp" method="get">
 <a href="test.asp">Code testing</a>
 First name: <input type="text" name="fname" /><br />
 Last name: <input type="text" name="lname" /><br />
 <button type="submit">Submit</button><br />
</form> 
```

demo_form.asp在表单提交时被调用，我可以在demo_form.asp中处理表单中的变量，如下所示，

```
request.GET('fname') 
```

通过 HREF 调用 test.asp 时如何处理表单中的变量。我可以使用相同的 GET 或 POST 方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T02:04:04.803

通过超链接提交数据的唯一方法是通过 GET 请求。这当然会涉及表单中的所有字段，而不是作为查询参数添加到超链接。

您当然可以修改一个`a`元素，以便它使用 onclick 处理程序和 JavaScript 使用 DOM 方法从您的表单中获取数据，动态修改 href 属性，然后触发该特定锚标记的 click 事件。这也将是一个 GET 请求。

**HTML：**

```
<form action="test.asp" id="theForm">
     <a href="test.asp?" id="link">Code testing</a>
     First name: <input type="text" name="fname" /><br />
     Last name: <input type="text" name="lname" /><br />
</form> 
```

**jQuery：**

```
$('#link').click(function() {
    var href = "";
    $('#theForm > input').each(function(event) {
        event.preventDefault();
        href = $('#link').attr("href") + "&" + 
            $(this).attr("name") + "=" + $(this).attr("value");
        $('#link').attr("href", href);
    });
    $(this).click();  // or window.location = $(this).attr("href");
}); 
```

我不确定这会给你带来什么价值，除了作为一个练习来了解更多关于 DOM 和浏览器处理事件的方式。

在不知道您要完成什么的情况下，很难知道为什么您不只是使用表单本身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T02:03:48.387

如果您`test.asp`通过链接（或您所说的 href）调用，则只能使用 GET 方法处理变量。因此，例如，如果您有 ，那么`test.asp?fname=bob&lname=smith`这些 GET 变量将在 test.asp 中可用

您不能对 POST 数据执行此操作。

# opencv - opencv 无法在启用 ipp 支持的情况下构建

> ID：10508926
> 
> 赞同：9
> 
> 时间：2012-05-09T01:59:26.810
> 
> 标签：opencv

我在使用 ipp 支持构建 opencv 时遇到了一些问题。我在 debian 挤压 32 位和最新的英特尔发布的 ipp（完整`composer`包）上使用 cmake-gui。

我想我已经正确配置了 cmake。当我在启用 ipp 的情况下构建时，构建失败并出现以下错误：

```
/usr/bin/ld: /opt/intel/ipp/lib/ia32/libippcv_l.a(ippcv00242as.o): relocation R_386_GOTOFF against undefined symbol `ippJumpIndexForMergedLibs' can not be used when making a shared object
/usr/bin/ld: final link failed: Bad value 
```

这对我来说似乎不是配置类型错误:-)

关于如何解决这个问题的任何想法？

谢谢，

-安德烈斯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-10T00:22:59.090

我解决了这个问题，并认为我应该回答我自己的问题，以防万一其他人遇到这个问题。

显然，当您指定共享库构建时，opencv 库将无法正确构建。使用 cmake-gui 时，不得设置此选项：

```
BUILD_SHARED_LIBS 
```

通过禁用此选项，构建和安装的 opencv 库就好了

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-23T17:11:46.280

如果您的处理器不是英特尔系列，请执行此操作`cmake -D WITH_IPP=OFF`，您不需要它。然后`make`。

# android - 如何在 GPS LocationListener 中将 Android 文本转语音？

> ID：10508945
> 
> 赞同：1
> 
> 时间：2012-05-09T02:02:21.627
> 
> 标签：android, gps, text-to-speech

是否可以在 LocatioListener 类中打开文本到语音功能？

我正在尝试让一个 android 应用程序检测你移动了多远。我能够打开 GPS，并监控位置移动。我想让它说“你已经移动了 300 米”。将它放在 OnLocation 方法中会非常方便，但是当我尝试实例化 texttospeech 时它会抱怨？

这就是我正在尝试的：

```
public class Location implements LocationListener {
    static TextToSpeech talk;
public void onLocationChanged(Location location) {
    // TODO Auto-generated method stub 
```

//这在下一行对我大喊大叫，不会让我使用'this'作为上下文？？（也试过Location.this）

```
 talk = new TextToSpeech(this, new extToSpeech.OnInitListener() {
        public void onInit(int status) {
            // TODO Auto-generated method stub

            talk.setLanguage(Locale.UK);
            Location aloc = new Location("aloc");
            Location bloc = new Location("bloc");
            aloc.setLatitude(alat);
            aloc.setLongitude(alon);
            bloc.setLatitude(blat);
            bloc.setLongitude(blon);

            float distance = aloc.distanceTo(bloc);
            talk.speak("You Moved..", TextToSpeech.QUEUE_FLUSH, null);
            }
    });     

}

public void onProviderDisabled(String provider) {
    // TODO Auto-generated method stub

}

public void onProviderEnabled(String provider) {
    // TODO Auto-generated method stub

}

public void onStatusChanged(String provider, int status, Bundle extras) {
    // TODO Auto-generated method stub

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T02:27:17.667

您需要引用 a`Context`来初始化 TTS 引擎。因此它不能与`this`or一起使用`Location.this`，因为两者都引用您的`Location`类的正在运行的实例，这显然*不是*一个`Context`（或它的子类）。

话虽如此，有多种选择。

1.  如果您将您的`Location`类用作匿名内部类或非静态内部类，例如`Activity`（或任何其他*可以*获取`Context`对象引用的类），您可以使用对外部类的引用来初始化 TTS 引擎。
2.  与其尝试直接在类中初始化 TTS 引擎，不如在您*确实*有引用的`Location`地方初始化它；例如，您请求的同一个地方（您已经需要参考）。*`Context``LocationManager``Context`*
**   创建 TTS 引擎的集中式实例。您可以将其设置为单例，但也可以子类化`Application`并保留它。初始化后，您可以或多或少地在您喜欢的任何地方获取和使用它。*

# php - 警告：json_decode() 最多需要 2 个参数，给定 4 个

> ID：10508946
> 
> 赞同：9
> 
> 时间：2012-05-09T02:02:33.717
> 
> 标签：php, json

我尝试像这样使用 json_decode：

```
json_decode($string, true, 100, JSON_BIGINT_AS_STRING); 
```

但我得到了错误：

```
Warning: json_decode() expects at most 2 parameters, 4 given in /home/content/27/2326027/html/sys/get.php on line 38 
```

任何回应都会受到赞赏

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-09T02:05:56.367

好像您的 PHP 版本不支持这些参数。

见手册：

```
Version     Description
5.4.0   The options parameter was added.
5.3.0   Added the optional depth. The default recursion depth was increased from 128 to 512
5.2.3   The nesting limit was increased from 20 to 128
5.2.1   Added support for JSON decoding of basic types. 
```

要使用您编写的代码，您至少需要 5.4.0 版本...

# ruby-on-rails - 基本表单操作不适用于heroku（但在本地有效）

> ID：10508947
> 
> 赞同：2
> 
> 时间：2012-05-09T02:02:48.130
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, heroku

编辑：我觉得很愚蠢，我没有正确地将我的分支与 git 合并。就像我说的，我对编程很陌生，很容易出现这些类型的错误。不过，我感谢您的帮助。

我在频道上。Rails by Example 书的第 7 章，我在其中创建了一个基本的“注册”表单。当我在本地主机上提交表单时，它可以通过将我引导至

LOCALHOST/new（返回注册页面，注册信息错误）或 LOCALHOST/show（用户配置文件，成功）。

当我将同一个应用程序推送到 heroku 并点击提交按钮时，它总是将我带到这个网址：

appname.heroku.com/form_action.asp?fname=&email=&password=&password= 告诉我“您要查找的页面不存在。您可能输入了错误的地址或页面可能已移动。”

而不是 appname.heroku.com/new 或 /show。

我很困惑，我是一个初学者程序员，这让我很困惑，为什么事情在本地主机上运行得如此完美，但在生产服务器上却不行。请帮忙！

我的代码在 github 上： [https ://github.com/Chamza/Sample-App2](https://github.com/Chamza/Sample-App2)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T02:51:01.033

您是否在 Heroku 上运行“雪松”堆栈？我相信 url 应该是`appname.herokuapp.com`- 不是`appname.heroku.com`。由于您在 github 中的代码基于使用 rails 3.2.1，因此您应该使用 cedar 堆栈。

以下是 heroku 中有关 cedar 堆栈的一些信息：[https ://devcenter.heroku.com/articles/cedar](https://devcenter.heroku.com/articles/cedar)

另外，您可以运行`heroku logs --tail --app my-app-name`然后发布单击链接时会发生什么吗？这就是所谓的“跟踪日志”，它将为您提供正在发生的事情的实时输出。

编辑***

我查看了您的代码，发现至少有一个问题是您使用的表单具有：

```
<% provide(:title, 'Sign up') %>
<div style = "width: 200px; margin: 0 auto;">
  <form  action="form_action.asp" method="get">
    <h1>Sign up</h1>
    <p align="left">Name:</p>
    <input type="text" name="fname" />  
    <p>Email:</p>
    <input type="text" name="email" />
    <p>Password:</p> 
    <input type="password" name="password" />
    <p>Password Confirmation:</p>
    <input type="password" name="password" /> 
    <br/>
    <input type="submit" value="Submit" />
  </div>
</form> 
```

表格中有一些错误。首先，行动是`form_action.asp`。看起来它来自一个旧项目。其次，结束`</div>`和`</form>`标签交换——form标签应该在div标签之前。

```
<% provide(:title, 'Sign up') %>
<div style = "width: 200px; margin: 0 auto;">
  <form  action="form_action.asp" method="get">
    <h1>Sign up</h1>
    <p align="left">Name:</p>
    <input type="text" name="fname" />  
    <p>Email:</p>
    <input type="text" name="email" />
    <p>Password:</p> 
    <input type="password" name="password" />
    <p>Password Confirmation:</p>
    <input type="password" name="password" /> 
    <br/>
    <input type="submit" value="Submit" />
  </div>
</form> 
```

您的本地计算机上的代码可能与您在 Heroku 上部署的代码不同。我会仔细检查——做一个`heroku releases --app my-app`，它会告诉你服务器上最新的 git commit 是什么。

# ado - ADO 可检索数据服务？

> ID：10508955
> 
> 赞同：0
> 
> 时间：2012-05-09T02:04:17.710
> 
> 标签：ado, recordset

需要有关如何使数据提供者/服务与 ADO 兼容的指针。这个要求与我们使用经典 ado 查询 LDAP 服务器（活动目录）的方式非常相似。这是一个相同的例子 --> [http://www.4guysfromrolla.com/webtech/041800-1.shtm](http://www.4guysfromrolla.com/webtech/041800-1.shtm)

然而，我期望这个提供者会做的事情是，实际上与下面的 WCF 服务对话，并以某种方式生成一个记录集以供下游消费。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T02:53:25.230

如果您希望通过 ADO 接口使您正在提取的数据可用，您可以看看这里的文章 - 它有点过时了，但我怀疑基本概念仍然有效。

[ADO 提供者](http://msdn.microsoft.com/en-us/magazine/cc301611.aspx "ADO 提供者")

# java - m2eclipse 工件搜索如何工作？

> ID：10508959
> 
> 赞同：0
> 
> 时间：2012-05-09T02:04:56.790
> 
> 标签：java, eclipse, m2eclipse

有人可以解释 m2eclipse 中的搜索功能吗？我不清楚这些信息的来源以及在找不到工件时如何解决此问题。我有两个 Eclipse 安装，都带有 m2eclipse 插件，一个有效（找到一些工件而不是其他工件），第二个不返回任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T02:49:58.107

从多个 eclipse 安装中使用 maven 时，获得一致结果的一种方法是单独安装 maven，并将 eclipse（在 Preferences->Maven->Installations 下）指向外部 maven 实例以代替嵌入式安装。这种方法的另一个优点是能够从命令行独立于 IDE 运行 maven，以获得构建过程的“纯”视图。这在故障排除时可能很有价值。

无论如何，m2eclipse 使用标准的 maven 实践在本地存储库（通常是 {主目录}/.m2/repository）中查找依赖项，然后转向任何“远程”存储库。本地存储库位置可以在 Eclipse 中的 Preferences->Maven->User Settings 下找到。如果没有进行其他配置，则位于[http://repo.maven.apache.org/maven2/](http://repo.maven.apache.org/maven2/)的“中央”maven 存储库是搜索的下一个位置。

由于您从每个 Eclipse 安装中得到不同的结果，我会假设他们正在查看不同的存储库，尽管不确定设置是如何得到的。知道您正在寻找的工件是否在已注册的存储库位置中会很有趣。

请注意，这假设您正在访问已发布的工件。如果您正在使用快照，则规则会发生一些变化，并且配置（在 settings.xml 文件中）很重要。

# c# - 枚举 Microsoft Outlook 联系人

> ID：10508962
> 
> 赞同：0
> 
> 时间：2012-05-09T02:05:53.157
> 
> 标签：c#

我有以下代码来枚举我的联系人的所有电子邮件地址，但我无法这样做，除了这一行的异常点

```
 Outlook.ContactItem oAppt = (Outlook.ContactItem)oItems; 
```

有人可以帮助我，以便我可以在 Microsoft Outlook 中枚举我的联系人的所有电子邮件地址吗？

```
namespace RetrieveContacts
{
    public class Class1
{
     public static int Main(string[] args)
    {
        try
        {
            Outlook.Application oApp = new Outlook.Application();

            Outlook.NameSpace oNS = oApp.GetNamespace("mapi");

            Outlook.MAPIFolder oContacts = oNS.GetDefaultFolder(Outlook.OlDefaultFolders.olFolderContacts);

            Outlook.Items oItems = oContacts.Items;

            Outlook.ContactItem oAppt = (Outlook.ContactItem)oItems;

            for (int i = 0; i <= oItems.Count; i++)
            {
            System.IO.StreamWriter file = new System.IO.StreamWriter("C:\\EmailAddress.txt");
            file.WriteLine(oAppt.Email1Address);
            file.Close();
            }
            oNS.Logoff();

            oAppt = null;
            oItems = null;
            oContacts = null;
            oNS = null;
            oApp = null;
        }
        catch (Exception e)
        {
        System.IO.StreamWriter file = new System.IO.StreamWriter("C:\\Exception.txt");
            file.WriteLine(e);
            file.Close();
        }
        return 0;
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T02:22:26.827

在不知道 Outlook 的对象模型的情况下，我猜这`Outlook.Items`是 s 的*集合*，`ContactItem`因此不能直接转换为单个`ContactItem`. 其他担忧：

*   您正在循环中创建并写入文件，因此每次都会被覆盖
*   您需要验证该项目*是否为*a `ContactItem`，否则您的演员将引发错误。
*   文件访问应该在一个`using`块中，因此如果抛出异常，它会自动关闭
*   如果集合是基于 0 的，则您的 for 循环将从`0`何时`Count`开始`0``Count-1`

尝试将循环更改为如下内容：

```
Outlook.Items oItems = oContacts.Items;
using(System.IO.StreamWriter file = new System.IO.StreamWriter("C:\\EmailAddress.txt"))
{
    for (int i = 0; i < oItems.Count; i++)  // Note < instead of <=
    {
        // Will be null if oItems[i] is not a ContactItem
        Outlook.ContactItem oAppt = oItems[i] as Outlook.ContactItem;

        if(oAppt != null)
            file.WriteLine(oAppt.Email1Address);
    }
}
file.Close();
oNS.Logoff(); 
```

# gcc - gcc 是否可以对生成的二进制文件进行不同的排序？

> ID：10508965
> 
> 赞同：1
> 
> 时间：2012-05-09T02:06:20.483
> 
> 标签：gcc

该命令`gcc -c a.c b.c c.c`生成的二进制文件与源文件在命令行中以不同方式排序的情况不同。出于安全目的，我希望每次构建文件时都更改二进制顺序。gcc 是否有内置选项可以执行此操作？还是比手动重新排序源文件更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T02:18:35.043

如果您不介意它在*概率上有所不同*，那么您可以编写一个小的 shell 脚本来随机化输入：

```
gcc -c $(ls *.c | sort --random-sort) -lwhatever 
```

当然，解析`ls(1)`输出通常是危险的，但由于这些是您的源文件，请在名称中表现出一点谨慎并避免换行。

当然，缺点是多次运行可能会产生相同的随机顺序。这就是生活。

# c# - WIA：保存文件时不压缩

> ID：10508974
> 
> 赞同：2
> 
> 时间：2012-05-09T02:07:42.777
> 
> 标签：c#, image, compression, wia

我正在使用 WIA 扫描图像并注意到，图像没有有效地存储，因为`SaveFile`显然没有使用压缩。

目前我正在使用这段代码：

```
WIA.ImageFile img = (WIA.ImageFile)item.Transfer(WIA.FormatID.wiaFormatPNG);
img.SaveFile(path); 
```

有没有办法使用 WIA 进行压缩，或者如何使用压缩保存图像？

**编辑：**

使用以下代码，我能够将文件大小从 25 MB 减少到 10 MB。

```
WIA.ImageFile img = (WIA.ImageFile)item.Transfer(WIA.FormatID.wiaFormatPNG);
WIA.ImageProcess ImageProcess1 = new WIA.ImageProcessClass();
System.Object Object1 = null;
System.Object Object2 = null;
Object1 = (Object)"Convert";
ImageProcess1.Filters.Add(ImageProcess1.FilterInfos.get_Item(ref Object1).FilterID, 0);
Object1 = (Object)"FormatID";
Object2 = (Object)WIA.FormatID.wiaFormatPNG;
ImageProcess1.Filters[1].Properties.get_Item(ref Object1).set_Value(ref Object2);
img = ImageProcess1.Apply(img);
img.SaveFile(path); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-11T19:00:25.857

获得 WIA 图像（此处显示为“图像”变量）后，在保存之前应用过滤器来调整质量，如下所示：

```
WIA.ImageProcess myip = new WIA.ImageProcess();  // use to compress jpeg.
myip.Filters.Add(myip.FilterInfos["Convert"].FilterID);
myip.Filters[1].Properties["FormatID"].set_Value(WIA.FormatID.wiaFormatJPEG);
myip.Filters[1].Properties["Quality"].set_Value(jpgQuality);

image = myip.Apply(image);  // apply the filters
image.SaveFile(outputFilename); 
```

在此示例中，jpgQuality 是一个介于 1 和 100 之间的 int 值。1 = 低质量，100 = 最佳。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T05:52:49.437

基本上你应该在保存图像之前添加一个压缩过滤器，在这个 url 中你可以找到一个 tiff/jpg 压缩示例：

[http://www.debugging.com/bug/18157](http://www.debugging.com/bug/18157)

# node.js - 不能使用基于 mongo 的会话存储

> ID：10508975
> 
> 赞同：2
> 
> 时间：2012-05-09T02:07:59.413
> 
> 标签：node.js, mongodb, express, mongohq

我在 ym 应用程序中有一个 mongoose 和 connect-mongo 模块实例。我正在使用 connect-mongo 模块将会话存储保存在 mongodb 数据库（mongohq）而不是内存存储中。

每次我在服务器启动时尝试访问我的应用程序（facebook auth with everyauth）我都会得到以下信息：

> 500 MongoError：错误：未经授权的 db：express-sessions 锁定类型：-1 客户端：199.192.242.4

我的用户名，密码都很好。

```
var conf = {
  db: {
    db: 'express-sessions',
    host: 'staff.mongohq.com',
    port: 10072,  // optional, default: 27017
    username: 'admin', // optional
    password: 'admin', // optional
    collection: 'facebookSessions' // optional, default: sessions
  },
  secret: '076ee61d63aa10a125ea872411e433b9'
};

app.use(express.session({
    secret: conf.secret,
    maxAge: new Date(Date.now() + 3600000),
    store: new MongoStore(conf.db)
  })); 
```

编辑，这似乎是我的 mongohq 的问题。我为较旧的集合修改了该集合，并且可以正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T23:17:04.507

我在使用 Heroku 和 Mongolab 时遇到了类似的错误。

我通过使用 mongolab 网络管理员手动创建一个新的数据库用户来解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T21:53:51.020

听起来数据库是用 --auth 启动的，但用户没有被授予访问数据库的权限。

[http://www.mongodb.org/display/DOCS/Security+and+Authentication](http://www.mongodb.org/display/DOCS/Security+and+Authentication)

# ruby-on-rails - Ruby 3.2.3 rake 似乎不起作用 - 或其他什么。瑞克失败了！无法加载此类文件

> ID：10508980
> 
> 赞同：2
> 
> 时间：2012-05-09T02:09:25.873
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rake

所以我正在尝试从 Lynda.com 学习 Ruby 和 rails 当我进入数据库部分时，老师让我们用 rake 做这个模式转储，但它中止了，我不知道出了什么问题（我对这一切都很陌生所以请原谅我=））

操作系统：Lion
Ruby：ruby 1.9.3p194（2012-04-20 修订版 35410）[x86_64-darwin11.3.0]
Rails：Rails 3.2.3
Rake：rake (0.9.2.2)
$PATH：/usr/local/Cellar:/ usr/local/bin:/usr/local/sbin:/usr/local/mysql/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/垃圾桶

所有的宝石都应该是最新的（前几天刚刚重新安装）。如果您需要了解其他任何信息来帮助解决问题，请告诉我！

这是我得到的错误：

```
Alex$ rake db:schema:dump
rake aborted!
cannot load such file -- bundler/setup

(See full trace by running task with --trace)

Alex$ rake --trace
rake aborted!
cannot load such file -- bundler/setup
/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
/Users/Alex/Sites/simple_cms/config/boot.rb:6:in `<top (required)>'
/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
/Users/Alex/Sites/simple_cms/config/application.rb:1:in `<top (required)>'
/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
/Users/Alex/Sites/simple_cms/Rakefile:5:in `<top (required)>'
/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/rake/rake_module.rb:25:in `load'
/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/rake/rake_module.rb:25:in `load_rakefile'
/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/rake/application.rb:501:in `raw_load_rakefile'
/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/rake/application.rb:82:in `block in load_rakefile'
/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/rake/application.rb:133:in `standard_exception_handling'
/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/rake/application.rb:81:in `load_rakefile'
/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/rake/application.rb:65:in `block in run'
/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/rake/application.rb:133:in `standard_exception_handling'
/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/rake/application.rb:63:in `run'
/usr/local/bin/rake:32:in `<main>' 
```

当我尝试重新安装budel并运行以下命令时得到了这个：

```
Alex$ bundle exec rake db:schema:dump
/Library/Ruby/Gems/1.8/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle: [BUG] Segmentation fault
ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-darwin11.3.0]

-- Control frame information -----------------------------------------------
c:0030 p:-17562901266652 s:0090 b:0090 l:000089 d:000089 TOP   
c:0029 p:---- s:0088 b:0088 l:000087 d:000087 CFUNC  :require
c:0028 p:0119 s:0084 b:0084 l:000083 d:000083 TOP    /Library/Ruby/Gems/1.8/gems/mysql2-0.3.11/lib/mysql2.rb:9
c:0027 p:---- s:0082 b:0082 l:000081 d:000081 FINISH
c:0026 p:---- s:0080 b:0080 l:000079 d:000079 CFUNC  :require
c:0025 p:0026 s:0076 b:0076 l:000056 d:000075 BLOCK  /Library/Ruby/Gems/1.8/gems/bundler-1.1.3/lib/bundler/runtime.rb:68
c:0024 p:---- s:0073 b:0073 l:000072 d:000072 FINISH
c:0023 p:---- s:0071 b:0071 l:000070 d:000070 CFUNC  :each
c:0022 p:0091 s:0068 b:0068 l:000056 d:000067 BLOCK  /Library/Ruby/Gems/1.8/gems/bundler-1.1.3/lib/bundler/runtime.rb:66
c:0021 p:---- s:0062 b:0062 l:000061 d:000061 FINISH
c:0020 p:---- s:0060 b:0060 l:000059 d:000059 CFUNC  :each
c:0019 p:0046 s:0057 b:0057 l:000056 d:000056 METHOD /Library/Ruby/Gems/1.8/gems/bundler-1.1.3/lib/bundler/runtime.rb:55
c:0018 p:0021 s:0053 b:0053 l:000052 d:000052 METHOD /Library/Ruby/Gems/1.8/gems/bundler-1.1.3/lib/bundler.rb:119
c:0017 p:0089 s:0049 b:0049 l:000048 d:000048 TOP    /Users/Alex/Sites/simple_cms/config/application.rb:7
c:0016 p:---- s:0047 b:0047 l:000046 d:000046 FINISH
c:0015 p:---- s:0045 b:0045 l:000044 d:000044 CFUNC  :require
c:0014 p:0026 s:0041 b:0041 l:000040 d:000040 TOP    /Users/Alex/Sites/simple_cms/Rakefile:5
c:0013 p:---- s:0039 b:0039 l:000038 d:000038 FINISH
c:0012 p:---- s:0037 b:0037 l:000036 d:000036 CFUNC  :load
c:0011 p:0013 s:0033 b:0033 l:000032 d:000032 METHOD /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/rake_module.rb:25
c:0010 p:0274 s:0029 b:0029 l:000028 d:000028 METHOD /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:501
c:0009 p:0009 s:0024 b:0024 l:000017 d:000023 BLOCK  /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:82
c:0008 p:0009 s:0022 b:0022 l:000021 d:000021 METHOD /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:133
c:0007 p:0011 s:0018 b:0018 l:000017 d:000017 METHOD /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:81
c:0006 p:0019 s:0015 b:0015 l:000008 d:000014 BLOCK  /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:65
c:0005 p:0009 s:0013 b:0013 l:000012 d:000012 METHOD /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:133
c:0004 p:0011 s:0009 b:0009 l:000008 d:000008 METHOD /Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:63
c:0003 p:0048 s:0006 b:0006 l:0003a8 d:000a48 EVAL   /usr/local/bin/rake:32
c:0002 p:---- s:0004 b:0004 l:000003 d:000003 FINISH
c:0001 p:0000 s:0002 b:0002 l:0003a8 d:0003a8 TOP 
```

……

```
[NOTE]
You may have encountered a bug in the Ruby interpreter or extension libraries.
Bug reports are welcome.
For details: http://www.ruby-lang.org/bugreport.html

Abort trap: 6
Alex$ 
```

这个错误太长了，无法适应这个领域。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T02:23:29.953

我通过运行解决了这个问题：

```
gem install bundler 
```

如果您尝试这样做并且它显示您已安装捆绑程序，请尝试输入：

```
bundle exec rake db:schema:dump 
```

您可能在当前捆绑包范围之外运行该命令。

`bundle exec`以下是有关为什么需要在 rake 命令前添加的更多背景信息：

[http://gembundler.com/](http://gembundler.com/)

另外，请注意，`rake`只要您已`rails`指定，您的“Gemfile”中就不需要它。`rake`安装为`rails`. 要查看相关性，请查看您的`Gemfile.lock`.

安装 rvm 后，将以下内容添加到`.rvmrc`项目根目录中的文件中：

```
if [[ -d "${rvm_path:-$HOME/.rvm}/environments" \
  && -s "${rvm_path:-$HOME/.rvm}/environments/ruby-1.9.3-p125@MYPROJECTNAME" ]] ; then
  \. "${rvm_path:-$HOME/.rvm}/environments/ruby-1.9.3-p125@MYPROJECTNAME"  
else
  rvm --create use  "ruby-1.9.3-p125@MYPROJECTNAME"
fi 
```

将您的项目名称替换为“MYPROJECTNAME”和您看到的相应 ruby​​ 版本`ruby-1.9.3-p125`。然后当你切换到那个目录时，rvm 会自动为你设置 gemset 和 ruby​​ 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:32:15.617

问题似乎是我在安装 ruby​​ & rails 之后安装了 bundle。我卸载了 ruby​​ 和我所有的 gem（但留下了 bundle 和 homebrew），然后使用 rvm 安装了最新的 ruby​​ 和 rails。

**另请注意，除非需要，否则我没有使用 sudo。我认为这将文件放在不同的位置，这可能也有帮助。**

rake 命令现在可以工作了（之前没有使用 bundle 命令）。

**所以基本上我已经安装了捆绑包，然后做了这个人在他的问题底部所做的一切（＃5给了我和错误并且没有安装）。**

[如何在 OSX Lion 上安装（构建）Ruby 1.9.3？](https://stackoverflow.com/questions/9626729/how-do-you-install-build-ruby-1-9-3-on-osx-lion)

希望这可以帮助其他遇到与我相同的问题的人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T02:40:26.107

安装 rvm

为您的项目创建一个新的 gemset。我打赌你在某些方面使用 Lion 附带的 aystem ruby

# java - 如何通过 Web 应用程序将整个 ftp 目录下载到用户客户端

> ID：10508981
> 
> 赞同：1
> 
> 时间：2012-05-09T02:09:53.133
> 
> 标签：java, ftp

Web 应用程序是用 Java/Jsp 开发的。我想做的一件事是从 FTP 下载一个目录到一台用户客户端电脑。由于该目录下至少要传输700MB的文件，而且FTP下载速度有时很慢。当我使用ativex进行下载时，网页卡住了很长时间。下载完成后，会话超时。那么我该如何解决下载和超时的事情呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-10T06:17:26.940

你可以从这里参考
`http://www.codejava.net/java-se/networking/ftp/how-to-download-a-complete-folder-from-a-ftp-server`
它对我有用

# ruby-on-rails - 在 Rails url 帮助器中包含受限路由的子域

> ID：10508985
> 
> 赞同：11
> 
> 时间：2012-05-09T02:10:37.390
> 
> 标签：ruby-on-rails, routes

假设我有以下受限于特定子域的路由：

```
App::Application.routes.draw do
  constraints :subdomain => "admin" do
    scope :module => "backend", :as => "backend" do
      resources :signups
      root :to => "signups#index"
    end
  end
  constraints :subdomain => "www" do
    resources :main
    root :to => "main#landing"
  end
end 
```

我的问题是，`root_url`两者`backend_root_url`都返回当前子域的 url：“http:// **current-subdomain** .lvh.me/”，而不是资源特定的子域。我想`root_url`返回“http://www.lvh.me/ ”并返回“ **http://admin.lvh.me/ ”（子****域**下所有资源的行为应该相同）。`backend_root_url`

 **我试图在rails 3.2中通过在不同的地方设置url选项来实现这一点，其中一个是应用程序控制器中的url_options：

```
class ApplicationController < ActionController::Base
  def url_options
    {host: "lvh.me", only_path: false}.merge(super)
  end
end 
```

也许我需要手动覆盖 url 助手？我将如何处理（访问路线等）？

编辑：我可以使用 root_url(:subdomain => "admin") 得到正确的结果，它返回 "http:// **admin** .lvh.me/" 而不管当前的子域。但是，我宁愿不必在整个代码中指定这一点。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-09T17:06:53.127

使用如下所示的“默认值”将使 rails url helpers 输出正确的子域。

```
App::Application.routes.draw do
  constraints :subdomain => "admin" do
    scope :module => "backend", :as => "backend" do
      defaults :subdomain => "admin" do
        resources :signups
        root :to => "signups#index", :subdomain => "admin"
      end
    end
  end

  constraints :subdomain => "www" do
    defaults :subdomain => "www" do
      resources :main
      root :to => "main#landing"
    end
  end
end 
```**

# android - 设置定时器在 10 分钟内做某事

> ID：10508987
> 
> 赞同：0
> 
> 时间：2012-05-09T02:10:54.960
> 
> 标签：android, timer, location

我想每 10 分钟保存一次我的位置，
我有从 gps 获取位置的代码，
然后我想每 10 分钟将我的位置保存在数据库中，
这是我的代码：

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    LocationManager locationManager;
    String context = Context.LOCATION_SERVICE;
    locationManager = (LocationManager)getSystemService(context);

    Criteria criteria = new Criteria();
    criteria.setAccuracy(Criteria.ACCURACY_FINE);
    criteria.setAltitudeRequired(false);
    criteria.setBearingRequired(false);
    criteria.setCostAllowed(true);
    criteria.setPowerRequirement(Criteria.POWER_LOW);
    String provider = locationManager.getBestProvider(criteria, true);

    updateWithNewLocation(null);

    locationManager.requestLocationUpdates(provider, (10*60*1000), 10,
                                           locationListener);
}
private final LocationListener locationListener = new LocationListener() {
    public void onLocationChanged(Location location) {
      updateWithNewLocation(location);
    }

    public void onProviderDisabled(String provider){
      updateWithNewLocation(null);
    }

    public void onProviderEnabled(String provider){ }
    public void onStatusChanged(String provider, int status, 
                                Bundle extras){ }
  };
  public void updateWithNewLocation(Location location) {

        if (location != null) {
            Dbhelper helper = new Dbhelper(this);
            final SQLiteDatabase db = helper.getWritableDatabase();
            long time = System.currentTimeMillis();
            SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd kk:mm:ss");
            final String curTime = df.format(time);
            final double lat = location.getLatitude();
            final double lng = location.getLongitude();
            final double alt = location.getAltitude();
            System.out.println(lat);
            System.out.println(lng);
            System.out.println(alt);
            /*db.execSQL("INSERT INTO location (longitude,latitude,altitude,tgl_buat) VALUES " +
            "('"+lng+"','"+lat+"','"+alt+"','"+curTime+"')");
            db.close();*/
            Timer timer = new Timer();
            timer.schedule(new TimerTask(){
                @Override
                public void run(){
                    db.execSQL("INSERT INTO location (longitude,latitude,altitude,tgl_buat) VALUES " +
                            "('"+lng+"','"+lat+"','"+alt+"','"+curTime+"')");
                    db.close();
                }
            }, 10*60*1000, 10*60*1000);

          } 
       } 
```

但是每 10 分钟保存一次是行不通的。
我该如何解决这个问题？谢谢 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T02:19:37.040

您可以在将来的某个时间使用处理程序进行更新：

[http://developer.android.com/reference/android/os/Handler.html](http://developer.android.com/reference/android/os/Handler.html)

[http://www.vogella.com/articles/AndroidPerformance/article.html#concurrency_handler](http://www.vogella.com/articles/AndroidPerformance/article.html#concurrency_handler)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T02:26:21.177

您的位置实际上不会保存在数据库中，因为每次更新您的位置（通过`onLocationChanged(Location location)`）时，您都在创建一个新的计时器实例。

您应该做的是在您的方法中进行`timer`初始化。`OnCreate()`然后声明这些变量

```
double lat = location.getLatitude();
double lng = location.getLongitude();
double alt = location.getAltitude(); 
```

作为全局并在`onLocationChanged(Location location)`方法中更新它们。这样，每当计时器调用数据库中的持久性时，这些`lat, lng, alt`值将可用并根据您的最新位置进行更新。

更新：

在这里，你我修复了你的代码。你能试试这个吗？

```
//decalred as global variables
String curTime;
double lat;
double lng;
double alt;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    LocationManager locationManager;
    String context = Context.LOCATION_SERVICE;
    locationManager = (LocationManager)getSystemService(context);

    Criteria criteria = new Criteria();
    criteria.setAccuracy(Criteria.ACCURACY_FINE);
    criteria.setAltitudeRequired(false);
    criteria.setBearingRequired(false);
    criteria.setCostAllowed(true);
    criteria.setPowerRequirement(Criteria.POWER_LOW);
    String provider = locationManager.getBestProvider(criteria, true);

        //Initialize timer
        Timer timer = new Timer();
            timer.schedule(new TimerTask(){
                @Override
                public void run(){
                    db.execSQL("INSERT INTO location (longitude,latitude,altitude,tgl_buat) VALUES " +
                            "('"+lng+"','"+lat+"','"+alt+"','"+curTime+"')");
                    db.close();
                }
            }, 10*60*1000, 10*60*1000);

    updateWithNewLocation(null);

    locationManager.requestLocationUpdates(provider, (10*60*1000), 10,
                                           locationListener);
}
private final LocationListener locationListener = new LocationListener() {
    public void onLocationChanged(Location location) {
      updateWithNewLocation(location);
    }

    public void onProviderDisabled(String provider){
      updateWithNewLocation(null);
    }

    public void onProviderEnabled(String provider){ }
    public void onStatusChanged(String provider, int status, 
                                Bundle extras){ }
  };
  public void updateWithNewLocation(Location location) {

        if (location != null) {
            Dbhelper helper = new Dbhelper(this);
            final SQLiteDatabase db = helper.getWritableDatabase();
            long time = System.currentTimeMillis();
            SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd kk:mm:ss");
            curTime = df.format(time);
            lat = location.getLatitude();
            lng = location.getLongitude();
            alt = location.getAltitude();
            System.out.println(lat);
            System.out.println(lng);
            System.out.println(alt);

        } 

      } 
```

# canvas - html画布文本溢出省略号

> ID：10508988
> 
> 赞同：12
> 
> 时间：2012-05-09T02:11:20.887
> 
> 标签：canvas, html5-canvas

如果文本不适合可用宽度并且需要截断，是否可以在文本末尾有省略号的画布上绘制文本？谢谢。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-09T07:28:25.680

没有标准功能。

由于我需要一个，我制作了这个计算最佳拟合字符串的小函数：

```
function fittingString(c, str, maxWidth) {
  var width = c.measureText(str).width;
  var ellipsis = '…';
  var ellipsisWidth = c.measureText(ellipsis).width;
  if (width<=maxWidth || width<=ellipsisWidth) {
    return str;
  } else {
    var len = str.length;
    while (width>=maxWidth-ellipsisWidth && len-->0) {
      str = str.substring(0, len);
      width = c.measureText(str).width;
    }
    return str+ellipsis;
  }
} 
```

`c`2D 上下文在哪里。

设置好画布的字体和其他绘图参数后，您可以正常绘制字符串：

```
c.fillText(fittingString(c, "A big string that will likely be truncated", 100), 50, 50); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-07-15T14:21:23.687

在处理大量文本时，投票最多的答案会导致性能问题。

这是使用二进制搜索来加快搜索正确长度字符串的改编版本。

```
const binarySearch = ({ max, getValue, match }) => {
  let min = 0;

  while (min <= max) {
    let guess = Math.floor((min + max) / 2);
    const compareVal = getValue(guess);

    if (compareVal === match) return guess;
    if (compareVal < match) min = guess + 1;
    else max = guess - 1;
  }

  return max;
};

const fitString = (
  ctx,
  str,
  maxWidth,
) => {
  let width = ctx.measureText(str).width;
  const ellipsis = '…';
  const ellipsisWidth = ctx.measureText(ellipsis).width;
  if (width <= maxWidth || width <= ellipsisWidth) {
    return str;
  }

  const index = binarySearch({
    max: str.length,
    getValue: guess => ctx.measureText(str.substring(0, guess)).width,
    match: maxWidth - ellipsisWidth,
  });

  return str.substring(0, index) + ellipsis;
}; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-16T20:32:19.403

有一些与浏览器相关的技术不支持多行文本呈现。

这就是为什么我开发了一个小型图书馆来处理这个问题（等等）。该库提供对象来建模和执行字母级文本渲染。这应该可以满足您的需要：

[在http://www.samuelrossille.com/home/jstext](http://www.samuelrossille.com/home/jstext)阅读更多屏幕截图、教程和下载链接。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-05-09T02:30:34.043

html5 drawText 没有这样的东西，实现起来会有点复杂。您需要循环来修剪字符串，直到适合所需的大小。如果文本没有旋转或有任何其他特殊效果，我建议使用具有绝对位置和以下 CSS 样式的普通 div：

```
overflow: hidden;
text-overflow: ellipsis;
-o-text-overflow: ellipsis;
white-space: nowrap;
width: 100%; 
```

# xcode - 如何在 IOS5.1 中打印 BSSID，以便每次在同一 SSID 中检测到新的 AP，打印 BSSID 的新值

> ID：10508990
> 
> 赞同：0
> 
> 时间：2012-05-09T02:11:32.883
> 
> 标签：xcode, ios5

我从 StackOverflow 的另一篇文章中获取并修改的代码（编译时没有错误）：

```
NSError *error; 
NSArray *ifs = (NSArray *)CFBridgingRelease(CNCopySupportedInterfaces());
NSLog(@"%s: Supported interfaces: %@", __func__, ifs);
id info = nil;

for (NSString *ifnam in ifs)
{
    info = (NSDictionary *)CFBridgingRelease(CNCopyCurrentNetworkInfo((__bridge CFStringRef)ifnam));
    NSLog(@"%s: %@ => %@", __func__, ifnam, info);

    if (info && [info count])
    {
        break;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T09:21:50.380

我在 iOS 5.01 上尝试了代码。它对我不起作用。我注意到发生了交接。我会解释的。我的两个接入点具有相同的 ssid，实际上是我可以从我的 iphone ping 的两个路由器。这是场景：

1.  我最初连接到路由器 A。我可以 ping 路由器 A 的 IP。代码显示 A 的 BSSID。
2.  我移动到路由器 B 的范围内，并超出了路由器 A 的范围。我无法再 ping 路由器 A，但我现在可以 ping 路由器 B。代码继续显示 A 的 BSSID。

尽管已经进行了切换，但 CNCopyCurrentNetworkInfo 不会返回新数据。这是为什么会发生这种情况的可能答案： [https ://stackoverflow.com/a/11304701](https://stackoverflow.com/a/11304701)

# c - （GNU 内联汇编）如何使用未分配或复制到 C 变量的寄存器？

> ID：10508992
> 
> 赞同：0
> 
> 时间：2012-05-09T02:12:29.257
> 
> 标签：c, gnu, inline-assembly

我正在使用基于 GNU 的工具链编写内联汇编语句，并且内联汇编中有三个指令来更新系统寄存器的单个位。步骤将是：

1.  将系统寄存器移动（读取）到通用寄存器
2.  'AND' 它与 C 代码中的变量值
3.  移动（写）回刚刚读取的系统寄存器

在我使用的指令集中，内联汇编语法是这样的：

```
unsigned int OV_TMP = 0xffefffff;
asm volatile ( "mfsr %0, $PSW\n\t"
               "and %0, %0, %1\n\t"
               "mtsr %0, $PSW"
               :  : "r"(OV_TMP) : ); 
```

%1 是我要将 OV_TMP 的值转发到的寄存器。

%0 对我来说是个问题，我的问题是： **一旦有内部使用的寄存器并且没有从 C 代码中的 C 变量分配或复制到 C 变量，如何编写内联汇编代码？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T09:22:29.367

这里要考虑的是，从编译器的角度来看，寄存器*是*由内联汇编分配给的，即使您以后不再使用它。也就是说，您正在生成相当于：

```
register unsigned int OV_TMP = 0xffefffff, scratch;

scratch = magic() & OV_TMP;
more_magic(scratch);
/* and then don't re-use scratch for anything from here on */ 
```

由于 ，魔术和/或 more_magic 步骤无法移动或组合`volatile`，因此编译器不能简单地删除已写入但未使用的寄存器。

`mfsr`and看起来像 powerpc 指令，`mtsr`我可能会`and`在 C 代码中执行该步骤（见脚注）；但以下通常应该有效：

```
unsigned int OV_TMP = 0xffefffff, scratch;
asm volatile("mfsr %0, $PSW\n\t"
             "and %0, %0, %1\n\t"
             "mtsr %0, $PSW"
             : "=&r"(scratch) : "r"(OV_TMP)); 
```

这里的“=&r”约束表示输出操作数 ( `%0`) 在输入操作数 ( `%1`) 被读取之前写入。

* * *

脚注：据我所知（这不是很远，我只做过一点点 ppc 组装）与其他处理器上的某些锁步序列不同，不需要将`mfsr`and`mtsr`指令保持特定距离。如果是这样，我会写一些更像这样的东西：

```
static inline unsigned int read_psw() {
    unsigned int result;
    asm volatile("mfsr %0, $PSW" : "=r"(result));
    return result;
}
static inline void write_psw(unsigned int value) {
    asm volatile("mtsr %0, $PSW" :: "r"(value));
}
#define PSW_FE0 0x00100000 /* this looks like it's FE0 anyway */
...
    write_psw(read_psw() & ~PSW_FE0); /* some appropriate comment here */ 
```

# python - 对 Django 服务器进行滚动重启以确保问题最少的一些最佳实践是什么？

> ID：10508994
> 
> 赞同：1
> 
> 时间：2012-05-09T02:12:47.097
> 
> 标签：python, django

在进行滚动重启时，一些服务器仍在运行旧代码，而一些服务器正在使用新代码重新启动。如果您有大量机器/进程，则第一台服务器和最后一台服务器之间可能会有很大的延迟。

当数据库架构发生更改时，这可能会成为问题，例如重命名列、删除表等。这意味着旧代码（例如使用以前的列名或旧表）在滚动重启完成。

我想知道 Django 是否提供任何保证或约定以使其正常工作。根据我自己的观察，在 Django 中添加新模型（表）和新字段（列）时，这似乎不会导致旧代码出现问题，因为旧代码甚至不知道它存在并且不在乎。

Django 中是否有任何最佳实践或约定可以遵循以确保在滚动重启时问题最小化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T05:54:58.700

部署 Django 应用程序有无数种方法——每个 Web 平台堆栈都可能有一组不同的“最佳实践”。也就是说，这[12 个因素](http://www.12factor.net/)是现代 Web 应用程序的良好设计原则。

到目前为止，我已经使用以下方法部署了 Django：

*   linux + apache + mod_wsgi
*   linux + nginx + uwsgi

我更喜欢将服务器配置为在我触摸某个文件时重新加载应用程序（通常是一个名为“reload.me”的空白文件）。

以我的经验，这不是问题，这就是为什么您可能找不到太多有关它的信息的原因。

# matlab - 在 Matlab 中使用优化进行 PCA

> ID：10508997
> 
> 赞同：1
> 
> 时间：2012-05-09T02:12:49.263
> 
> 标签：matlab, pca

我想通过解决优化问题 min||X-XBB'|| 在 Matlab 中找到数据矩阵 X 的主成分，其中范数是 Frobenius 范数，B 是正交矩阵。我想知道是否有人可以告诉我该怎么做。理想情况下，我希望能够使用优化工具箱来做到这一点。我知道如何使用其他方法找到主成分。我的目标是了解如何设置和解决以矩阵为答案的优化问题。我非常感谢任何建议或意见。

谢谢！乔丹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T03:10:46.237

统计工具箱有一个内置函数“ [princomp](http://www.mathworks.com/help/toolbox/stats/princomp.html) ”，它执行 PCA。如果你想学习（一般来说，没有优化工具箱）如何创建自己的代码来做 PCA，[这个网站](http://www.nlpca.org/pca-principal-component-analysis-matlab.html)是一个很好的资源。

由于您特别提到要使用优化工具箱并将其设置为优化问题，因此斯坦福大学有一个非常值得信赖的 3rd-party 软件包，称为[CVX](http://cvxr.com/cvx/)，可以解决您所指的优化[问题这个网站](http://cvxr.com/cvx/examples/cvxbook/Ch08_geometric_probs/html/eucl_proj_cone2.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T16:26:30.420

关于优化的事情是有不同的方法来解决一个问题，其中一些可能需要大量的计算。

鉴于 B 的约束，您的解决方案是使用 fmincon。首先为非线性约束创建一个文件：

```
function [c,ceq] = nonLinCon(x)
c = 0;
ceq = norm((x'*x - eye (size(x))),'fro'); %this checks to see if B is orthonormal. 
```

然后调用例程：

```
B = fmincon(@(B) norm(X - X*B*B','fro'),B0,[],[],[],[],[],[],@nonLinCon) 
```

B0 可以很好地猜测答案是什么。

此外，您需要了解该算法试图找到一个局部最小值，这可能不是您最终想要的解决方案。例如：

```
X = randn(1,2)
fmincon(@(B) norm(X - X*B*B','fro'),rand(2),[],[],[],[],[],[],@nonLinCon)
ans =
    0.4904    0.8719
    0.8708   -0.4909
fmincon(@(B) norm(X - X*B*B','fro'),rand(2),[],[],[],[],[],[],@nonLinCon)
ans =
    0.9864   -0.1646
    0.1646    0.9864 
```

所以要小心，在使用这些方法的时候，尽量选择一个好的起点

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T06:32:07.080

你有优化工具箱吗？文档非常好，只需尝试其中一个示例： http: [//www.mathworks.com/help/toolbox/optim/ug/brg0p3g-1.html](http://www.mathworks.com/help/toolbox/optim/ug/brg0p3g-1.html)。

但总的来说，优化函数如下所示：

```
[OptimizedMatrix, OptimizedObjectiveFunction] = optimize( (@MatrixToOptimize) MyObjectiveFunction(MatrixToOptimize), InitialConditionsMatrix, ...optional constraints and options... ); 
```

您必须自己创建 MyObjectiveFunction()，它必须将要优化的矩阵作为输入，并输出一个标量值，指示当前输入矩阵的成本。大多数优化器会尽量减少这个成本。请注意，成本必须是标量。

fmincon() 是一个很好的起点，一旦你习惯了工具箱，如果可以的话，你应该为你的问题选择更具体的优化算法。

要优化矩阵而不是向量，请将矩阵重塑为向量，将此向量传递给您的目标函数，然后将其重塑回目标函数中的矩阵。

例如，假设您正在尝试优化 3 x 3 矩阵`M`。您已经定义了目标函数`MyObjectiveFunction(InputVector)`。将 M 作为向量传递：

```
MyObjectiveFunction(M(:)); 
```

在 MyObjectiveFunction 中，您必须重新塑造 M （如有必要）再次成为矩阵：

```
 function cost = MyObjectiveFunction(InputVector)
      InputMatrix = reshape(InputVector, [3 3]);

      %Code that performs matrix operations on InputMatrix to produce a scalar cost

      cost = %some scalar value
  end 
```