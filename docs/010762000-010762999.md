# StackOverflow 问答 10762000-10762999

# php - 当使用 AJAX 接收到选项时，从 select 中自动选择一个选项

> ID：10762003
> 
> 赞同：2
> 
> 时间：2012-05-25T22:22:38.503
> 
> 标签：php, javascript, jquery, html

我的问题是我有一个下拉列表，它的值填充了来自 jQuery 调用的 Ajax。如何将特定选项设置为默认选定选项？

# html

```
<li>
     <label>Type</label>
     <select  name="type"class="TypeSelector"></select>
     <span class="errorMessage"></span>
</li> 
```

# jQuery

```
$.getJSON("http://localhost/Mar7ba/Type/getAllTypes/TRUE",function(data){
            var options = '';
            options+="<option>Select Type</option>";
            for(var i=0;i<data.length;i++){
                options += "<option>"+data[i]+"</option>";
            }
            if($("#addPlace #apTypeSelect").length){
                $("#addPlace #apTypeSelect").html(options);
            }
            if($('.TypeSelector').length){
                $('.TypeSelector').html(options);
            }
        }); 
```

和选择的选项是

```
<?php echo $question['name'];?> 
```

我试过这样：

```
<li>
         <label>Type</label>
         <select  value="<?php echo $question['name'];?>"name="type"class="TypeSelector"></select>
         <span class="errorMessage"></span>
</li> 
```

...但不起作用我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T22:24:26.627

通过 jQuery 来完成。给你`select`一个 ID（我用过`mySelect`）然后做：

```
$(function() {
    $("#mySelect").val("<?php echo $question['name'];?>");
}); 
```

# linkedin - 使用“使用 LinkedIn 登录”来识别我网站上的用户的正确方法？

> ID：10762006
> 
> 赞同：4
> 
> 时间：2012-05-25T22:23:03.960
> 
> 标签：linkedin

我正在尝试理解“使用 LinkedIn 登录”。我似乎只掌握了图片的一部分。

据我了解，用户在我的网站上使用 LinkedIn 登录，LinkedIn 将唯一的用户标识符返回到我的网站。

然后我以某种方式在我的网站上使用该标识符来识别用户。

但我不明白 - 一旦最终用户看到了标识符，有什么办法可以阻止他们从那时起直接使用并且不再通过 LinkedIn 登录？返回的用户 ID 必须保密，还是可以公开显示，例如在 URL 中？

另外，如何防止有人找到其他人的用户 ID，然后使用它访问我的网站？

似乎我对从LinkedIn返回的用户ID的使用方式以及与安全性相关的问题缺乏全面的了解。

有人可以解释一下吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T07:08:52.063

我会自己回答。事实证明，您可以选择要求 LinkedIn API 也返回一个包含签名的 cookie。通过连接的 HTTPS 将此 cookie 返回到您的后端服务器，您可以在那里根据您自己的 API 密钥验证签名。瞧 - 您已经证明这是一个有效用户，并且您已经证明用户登录实际上来自 LinkedIn，而不是被欺骗。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T22:40:25.620

当用户通过linkedin 登录时，他们的API 将返回给您他们的用户ID。这真的不是什么秘密，它只是简单地通过linkedin 告诉您您网站上的用户已经以具有该唯一标识符的用户身份登录。您不能仅仅通过知道他们的linkedin ID 来以其他用户身份登录 - 要让linkedin 的API 返回该ID，您网站上的用户必须使用用户名和密码登录linkedin。

只要您可以确定您正在访问的 API 确实是linkedin 的并且响应没有被拦截/更改/伪造，您就可以相信 API 返回的 ID 是他们网站上用户的正确 ID并且他们已经以该用户身份登录并进行了身份验证。

基本上，如果您始终使用linkedin 的API 对linkedin 用户进行身份验证，并且您的站点上没有提示“输入您的linkedin ID 进行身份验证”的表单，那么您是安全的。即使用户知道另一个用户的 ID，他们仍然需要他们的linkedin 用户名/密码，以便 API 将该 ID 返回给您。

请随意存储返回的 ID 以跟踪用户偏好/操作。您甚至可以将其与数据库中已经存在的用户相关联，并为用户提供使用存储在数据库中的用户名/密码组合（希望是加盐/散列）或通过 oauth 选项之一登录的选项。

希望这有助于澄清事情！

*根据评论编辑*

关于在 API 请求之后如何处理事情的另一个重点。您可以相信linkedin 返回的ID 是正确的，但在那之后，您还必须能够相信存储在您网站上的ID 仍然与您从linkedin 获得的相同。使用用户无法编辑的服务器端来存储此 ID（如 PHP 会话 - 不是 url 参数）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T06:16:20.830

Suppose after user authenticates with linkedin successfully,
it redirects to your page [http://www.xyz.com/redirect.php](http://www.xyz.com/redirect.php).

Now you have code in redirect.php which takes oauth parameters from URL and calls for userid.

```
function getUserID (){
   // code which takes oauth params and calls linked in api with access token 
   //and returns userId of user
   return userID;
}

$userID = getUserID(); 
```

Now since your have `$userID` , create a session with `$userID` and redirect user to his/her home page. Check for session in home page, if session `$userID` is set , let user open the page , if session is not available, dont show the page and tell them to login first.

Now to your question, how do you think in this approach user can enter `userID` by his/her own ?

# css - css 父 div 和子 div 不能正常播放

> ID：10762008
> 
> 赞同：0
> 
> 时间：2012-05-25T22:23:24.490
> 
> 标签：css, jquery, css-float

我有一个父 div，里面并排有大约六个 div。一切都很好，除非我在其中添加了一点 jQuery。

现在父 div 没有像以前那样展开。我制作了父 div`relative`和子 div `absolute`，但父 div 只是不会伸展开。

**jQuery**

```
$(".child").click(function() { 
  var mypos, otherpos, $this; 

  // Move to the target element 
  $this = $(this); 
  pos = $this.offset(); 
  otherpos = $('selector_for_other_element').offset(); 
  pos.left = otherpos.left - pos.left; 
  pos.top  = otherpos.top  - pos.top; 
  $this.animate({ 
    left: pos.left + "px", 
    top:  pos.top  + "px" 
  }); 
}); 
```

**CSS**

```
<style type="text/css">
  .child{
    width: 250px;
    height: auto;
    float: left;
    padding: 10px 5px 10px 0px;
    background-color: #fff;
    position: absolute
  }
  .parent {
    width: 770px;
    height: auto;
    float: left;
    padding: 10px 0px 0px 10px;
    background-color: #fff;
    position: relative;
    overflow: none;
  }
</style> 
```

**HTML**

```
<div class="parent">
  <div class="child">content</div>
  <div class="child">>content</div>
  <div class="child">>content</div>
  <div class="child">>content</div>
  <div class="child">>content</div>
  <div class="child">>content</div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:19:42.587

我不确定这个[http://jsfiddle.net/thebabydino/CRRV5/](http://jsfiddle.net/thebabydino/CRRV5/)是否正是您想要的，但它可以工作并且可以调整。

# jquery - 加载 AJAX 时，Twitter Boostrap 模式触发器未触发

> ID：10762009
> 
> 赞同：0
> 
> 时间：2012-05-25T22:23:35.953
> 
> 标签：jquery, ajax, twitter-bootstrap, modal-dialog

我有一个页面，其内容通过 AJAX 动态加载。在该加载的内容中，我有标签充当触发引导模式窗口的触发器。我遇到的问题是，在初始页面加载后加载触发器时，触发器不会触发模式。当我在没有 AJAX 的情况下将链接硬编码到页面中时，它可以正常工作。有谁知道解决这个问题的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T22:28:16.157

您需要使用委托设置您的事件。像这样，使用 jQuery：

```
$(document).on('click', '.your-trigger-selector', function() {
    // Do stuff, such as opening the modal window.
}); 
```

# php - 解析错误，在包含 SimplePie RSS 脚本时需要“T_FUNCTION”

> ID：10762012
> 
> 赞同：0
> 
> 时间：2012-05-25T22:23:50.763
> 
> 标签：php, rss, simplepie

当我包含 SimplePie RSS 脚本 (simplepie.inc) 时，我已将问题范围缩小到这一行。我不确定它究竟为什么会抛出这个错误，但我认为 StackOverflow 可能比我迄今为止通过谷歌找到的更多洞察力。

这是我用来获取 SimplePie 提要结果的简单类的代码：

```
<?php

// Include SimplePie
require_once("simplepie.inc");

class Channel
{
    public $feed = new SimplePie();

    private $feedURI = "";

    function __construct($URI)
    {
        $this->feedURI = $URI;

        $this->feed->set_feed_url($this->feedURI);
        $this->feed->init();
        $this->feed->handle_content_type();
    }
}

?> 
```

如果您对我有任何见解，那就太棒了！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T22:26:42.553

定义属性时不能实例化类。只有常量值是有效的语法。`$feed`而是在构造函数中实例化：

```
public $feed;

public function __construct($URI)
{
    $this->feed = new SimplePie();
    // ...
} 
```

从[手册](http://php.net/manual/en/language.oop5.properties.php)：

> 这个声明可能包括一个初始化，但这个初始化必须是一个常量值——也就是说，它必须能够在编译时被评估，并且不能依赖于运行时信息才能被评估。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T22:27:14.143

```
public $feed = new SimplePie(); 
```

您不能在属性声明中使用函数或类赋值。定义为NULL，并将属性值设置为新的SimplePi

# c# - HttpWebRequest.GetResponse 与同一服务器上的 cookie 容器非常慢

> ID：10762013
> 
> 赞同：0
> 
> 时间：2012-05-25T22:24:11.553
> 
> 标签：c#, cookies, httpwebrequest

在我的安全网站上，我正在通过 HttpWebRequest.GetResponse() 访问同一网站的页面（这是有原因的）。如果我将超时设置得很高，它就可以工作，只需大约两分钟即可运行。在浏览器中加载同一页面只需不到两秒钟。您将在下面的代码中看到我的一些实验：加载 Google 很快，加载没有内容的安全页面很慢，加载不安全 (http) 页面很慢。但是，如果我注释掉添加 cookie 的代码部分，不安全的页面会快速运行。请注意，cookie 对 Google 的调用没有影响。似乎服务器必须永远处理 cookie。知道为什么，或者我能做些什么来解决它？

```
public static string GetPageHtmlSecure(string url, HttpContext inContext = null)
{
    string pageHtml;
    HttpContext context;

    if (inContext != null)
    {
        context = inContext;
    }
    else
    {
        context = HttpContext.Current;
    }

    // we've already validated the server's ID, don't need to do it again
    ServicePointManager.ServerCertificateValidationCallback += skipCertValidation;

    // create web request
    //HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
    //HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://www.google.com");

    //HttpWebRequest request = (HttpWebRequest)WebRequest.Create("https://secure/page/no/content");
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://not/secure/page/");
    // attach the cookies the user has to this request
    request.CookieContainer = new CookieContainer();
    Cookie c = new Cookie();
    for (int i = 0; i < context.Request.Cookies.Count; i++)
    {
        c.Name = context.Request.Cookies[i].Name;
        c.Value = context.Request.Cookies[i].Value;
        c.Domain = request.RequestUri.Host;
        c.Expires = context.Request.Cookies[i].Expires;
        c.Path = context.Request.Cookies[i].Path;
        c.Secure = context.Request.Cookies[i].Secure;

        request.CookieContainer.Add(c);
    }

    request.UserAgent = "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)";
    request.Method = "GET";
    request.ContentType = "text/xml";
    request.Timeout = 200000;
    request.ReadWriteTimeout = 200000;
    request.KeepAlive = false;
    request.Proxy = null;

    using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
    {
        using (System.IO.StreamReader sr = new StreamReader(response.GetResponseStream()))
        {
            pageHtml = sr.ReadToEnd();
        }
    }
    return pageHtml;
} 
```

# javascript - 如何删除两个 Html 选择列表之间的重复项

> ID：10762015
> 
> 赞同：0
> 
> 时间：2012-05-25T22:24:34.587
> 
> 标签：javascript, jquery, html, css

我有两个 HTML 选择列表，我想删除列表 1 中与列表 2 中的元素相似的所有元素。

```
<select id="availableLanguages" name="availableSoftwareLanguages" multiple="multiple" size="15">
    <option value="AL" label="All Languages">All Languages</option>
    <option value="AG" label="Argentina">Argentina</option>
    <option value="BU" label="Bulgarian">Bulgarian</option>
    <option value="CF" label="Canadian French">CanadianFrench</option>
    <option value="C1" label="Cantonese">Cantonese</option>
</select>

<input id="addLanguages" type="button" value=" >> ">
<input id="removeLanguages" type="button" value=" << ">

<select id="selectedLanguages" name="selectedLanguages " multiple="multiple" size="15">
    <option value="AL" label="All Languages">All Languages</option>
    <option value="AG" label="Argentina">Argentina</option>
    <option value="BU" label="Bulgarian">Bulgarian</option>
</select> 
```

所以在这里我想从列表 availableLanguages 中删除类似于列表 selectedLanguages 中的选项的选项。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T22:27:10.447

我假设您是按选项值匹配的？如果是这样，请尝试：

```
$("#selectedLanguages option").each(function () {
    $("#availableLanguages option[value='" + $(this).val() + "']").remove();
}); 
```

# c# - C# 类型需要特定类的子类以及接口

> ID：10762019
> 
> 赞同：1
> 
> 时间：2012-05-25T22:25:02.430
> 
> 标签：c#, interface, subclass

我正在开发一个实用程序，该实用程序将具有“过滤器”接口以及该接口的许多实现。部分接口将返回一个类型为 Control 的对象，该对象将在 UI 中用于操作过滤器。

我希望能够要求返回的控件也实现另一个接口，以便我可以执行诸如请求控件写回创建它们的对象之类的事情。

现在我的代码看起来像：

```
public interface IFilter
{
    Control Control();
} 
```

我想要一些像：

```
public interface IFilterControl
{
    ...
}

public class FilterControl : Control, IFilterControl{}

public interface IFilter
{
    ...
    FilterControl Control();
} 
```

以上不起作用，因为FilterControl实际上并没有实现IFilterControl。

如果以上内容不够清楚，请尝试想象想象中的关键字“实现”如何在下面工作

```
public interface IFilterControl
{
    IFilter Filter{get;}
}

public interface IFilter
{
    Control implmenting IFilterControl Control();
}

public interface FilterImpl : IFilter
{
    Control implmenting IFilterControl Control(){
        return new FilterControlImpl(this);
    }
}

public partial class FilterImplControl : UserControl, IFilterControl
{
    FilterImpl filter;
    public FilterImplControl(FilterImpl filter)
    {
        this.filter = filter;
    }

    public IFilter Filter{get{return filter;}}
}

FilterImpl a_filter = GetAFilter();
Control implmenting IFilterControl ctl = a_filter;
panel.Controls.Add(ctl);
FilterImpl the_filter_indirectly = ctl.Filter; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T22:32:00.387

可能想看看使用泛型。他们会让你对类型施加约束。

```
public interface IFilter<T> where T : Control
{
    T Control { get; set; }
    T ControlMethod();
} 
```

where 子句是一个通用的约束，并且要求 T 始终是 Control 类型。它也适用于接口。这样，您就知道这些方法或属性始终是 Control 的派生，并且这些期望将显示在智能感知中。

编辑哦，我刚刚想到，如果您愿意，您可以仅在方法中应用泛型。

```
interface IFilter
{
    T Control<T>() where T : Control;
} 
```

# dns - 什么时候可以在手机上托管网站并安装域名服务器？

> ID：10762024
> 
> 赞同：5
> 
> 时间：2012-05-25T22:26:08.887
> 
> 标签：dns, webserver, web-hosting, mobile-phones

我的问题是关于托管流量不大的小型个人网站。

我们（标准 PC 用户）为网络托管服务付费的最大原因是（如果我错了，请纠正我）：

1.  我们不会一直打开我们的电脑。
2.  我们中的一些/大多数人没有静态 IP 地址。

然而，现代手机只不过是一直保持打开状态的小型 PC。如果它们也可以有静态 IP 地址，为什么我们不能在它们上安装 Web 服务器？

目前有这项技术吗？
如果是，它目前的使用范围有多广？而且，它什么时候才能战胜经典的远程付费网络服务器？如果没有，它何时以及如何可用？我们需要使用什么硬件（手机类型）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T14:54:43.410

如果您有 GSM 手机，您已经可以在您的 SIM 卡上运行一个称为智能卡 Web 服务器 (SCWS) 的 Web 服务器。它在称为 SIM 应用程序工具包的部分中运行，这是 SIM 卡中用于运行服务的一个非常酷的区域。Web 服务器是 OMA（开放移动联盟）[规范](http://www.openmobilealliance.org/technical/release_program/scws_v1_1.aspx)的一部分，因此大多数（如果不是全部）最新的 SIM 卡都支持它。Web 服务器可以提供静态和动态网页，您还可以运行一些[Java 小程序](http://java.sun.com/developer/technicalArticles/javacard/javacard-servlets/)。

问题在于，这是为您的移动运营商设计的，旨在为您的手机提供网页，而不是真正让某人远程连接到您的 SIM 卡以查看内容。例如，在英国的 O2 使用这项技术为我的手机上的 o2 额外功能提供了一个很好的界面。我可以从流量、足球等的 HTML 菜单中进行选择，然后一旦我深入了解我 SIM 卡上运行的小站点，我就会找到一个链接，该链接将我带到主 o2 站点上的深度链接站点。

我认为有一种方法可以使 SCWS 面向公众，因为 Axalto（现为金雅拓）在 2005 年发布了一份新闻稿，他们表示他们有一张 SIM 卡，可以为用户运行个人博客，并且用户可以拍照在他们的手机上，按一个按钮[来决定将其发布到他/她的博客上。然后他/她的朋友可以立即从 PC 或手机访问它。](http://www.gemalto.com/axalto/Company/press/pdf/U2%20SIM_1110_en.pdf)

如果您知道如何远程查看 SCWS，那么下一个问题就是如何将文件写入您的 SIM 卡。传统上，您需要某种使用 ADPU 协议与卡通信的 SIM 卡读卡器/写卡器。但是，发行您的 SIM 卡的移动网络可以通过无线向您的 SIM 卡发出命令来远程访问您 SIM 卡上的 SCWS 文件。这意味着有一种方法可以远程更新文件，经过一番挖掘，我认为安全性是基于预共享密钥的。获得预共享密钥后，您可以使用一种称为无线 SMS 的 SMS 向您自己的手机发送 SMS，该 SMS 对 SIM 进行重新编程，以便为您的 Web 服务器存储新文件。如果您给我发送直接消息，我可以告诉您获取预共享密钥的方法。

**总而言之：**

**目前有这项技术吗？**- 有点。您可以在 SIM 卡上运行 Web 服务器，如果您可以将其打开到您的公共 IP，那么您可以直接从 SIM 到公共运行 Web 服务器。

**目前它的使用范围有多广？**运营商在世界各地大量使用它来为您的手机提供更好的增值服务。除了金雅拓，我从未听说过任何人使用它来服务公共页面。

**它什么时候能战胜经典的远程付费网络服务器**？这是一个棘手的问题。如果您可以让 SCWS 为公共访问而工作，那么下一阶段是发布到 SIM 的简单方法。一旦有一种简单的方法可以发布到 SIM 卡，当您的手机从您的网络获得动态 IP 时，您如何让某种 DNS 系统运行。

**我们需要使用什么硬件（手机类型）？**因为它在 SIM 而不是手机上运行，​​所以它完全独立于手机硬件，但是 SCWS 仅适用于较新的 SIM 卡（而不是 CDMA 手机）。

更多信息在这里：[http ://smartcardwebserver.com/ 以及](http://smartcardwebserver.com/)[Gemalto](http://www.gemalto.com/simagine/2009/download/scws_application_architecture.pdf)如何工作的一个很好的概述。[通读SIMalliance SCWS 工作组](http://www.simalliance.org/en/about/workgroups/smart_card_web_server_scws_working_group/smart-card-web-server-scws_ft072pb2.html)的资源部分可能是个好主意

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T23:04:37.217

Web 服务器[已经存在](http://code.google.com/p/i-jetty/)。我什至不打算查找 DNS 服务器，因为这并不是很重要和延迟，再加上移动提供商极不可能为您提供静态 IP，您可能会跳上和跳下 wifi 更改 IP 和高网络上有 NAT 和/或防火墙的可能性。无论如何，Web 服务器很少运行自己的 DNS。

您可能会设置从电话到固定端点的隧道，将流量代理回您，但这仍然让您依赖于提供某种托管服务的第三方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T23:49:33.127

据我所知，鉴于 Sean 上面列出的所有原因，您无法直接连接到手机网络服务器。我曾经在我的旧 N95 中使用过一个诺基亚应用程序，它提供了对 SMS、照片音乐、相机等的访问权限。无需担心你在路由器、防火墙后面或使用 WiFi 或手机信号。但是您需要事先设置一个帐户。

该应用程序名为[http://www.mymobilesite.net/](http://www.mymobilesite.net/)，我记得它是开源的并在 sourceforge.net 中提供，但我无法再次找到它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-05T16:54:05.183

我目前正在同一领域攻读博士学位。所以我想我可以给你一些有用的提示，尽管你问这个问题已经很久了。

拥有一个可以接收 HTTP 请求并做出相应响应的移动 Web 服务器是非常容易且低成本的。您可以在 iOS 和 Android 上使用 Paw、KSWEB、i-jetty 等等。请记住，如果您希望移动设备成为 Web 服务器，则无需让浏览器保持运行。所以网络服务器不会消耗太多能量。当它在后台时，它可以监听 http 端口（通常是 8080）并随时接收任何请求。但是，目前的问题是，在微型移动设备上管理一个真实的网站并不是一种愉快的做法，尤其是在数据量很大的情况下。另一个问题是响应许多并发请求的能力，因为移动设备还没有完全成熟

静态 IP 也具有挑战性，但有补救措施。您始终连接到蜂窝网络或 Wi-Fi，并且可以访问外部计算世界。因此，即使您的 IP 不是静态的，当您的 IP 更改并且人们可以找到您时，您也可以使用 Wi-Fi 或蜂窝网络将 IP 地址发送到中央服务器。需要的是模拟一种特定类型的 DHCP 服务器来跟踪您的移动设备。然而，研究人员正在研究移动 IP，在不久的将来，许多移动 IP 问题将得到解决。希望能帮助到你。如果大家都感兴趣，可以继续讨论。

# html - HMTL5 清单缓存和预加载

> ID：10762034
> 
> 赞同：1
> 
> 时间：2012-05-25T22:27:23.803
> 
> 标签：html

有人可以为我传播一些关于 html 5 清单应用程序缓存的信息吗？我的问题是，如果您在清单中包含图像或文件，它是否应该立即加载文件，然后不必再重新加载文件？

例如，我有一个 Web 应用程序，我想在开始时预加载所有图像，我可以将它们包含在清单中还是我仍然需要为此使用 JS。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T06:19:10.083

对于其他好奇的人……清单确实会预加载包含的所有内容，但是有几件事会影响这一点，而这些事情很容易被遗漏。

1.  清单文件中的单个错误意味着不会缓存任何内容。例如。如果您的清单中有 20 个项目，并且其中一个文件不存在。整个清单将不会加载。

2.  您的服务器（至少是 apache）需要配置为运行 appcache 文件。[看这篇文章](https://stackoverflow.com/questions/5863380/cant-get-simple-html5-manifest-cache-to-work)

# c# - 为什么更改屏幕上的 DPI 会影响对话框的布局？

> ID：10762035
> 
> 赞同：2
> 
> 时间：2012-05-25T22:27:29.010
> 
> 标签：c#

我有一个可以运行并且看起来很漂亮的向导（如果我自己这么说的话），问题出在 Windows XP 上，当用户更改屏幕上字体的 DPI 时，此对话框会严重混乱。似乎它自己的控件正在被移动。老实说，我什至不知道从哪里开始。

![向导（正确）96 DPI（Windows 7）](../Images/dd94842fd0dd02471dbd0e6553d01fe7.png)

![向导（错误）120 DPI Windows XP](../Images/ef38d08dba20495d5c1d534fcc1466d1.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:39:13.733

您需要让 dlalog 的组件知道 DPI 设置并计算所需的空间和布局。WPF 会自动执行此操作。

这是关于 SO 的示例：[How to control the font DPI in .NET WinForms app](https://stackoverflow.com/questions/185804/how-to-control-the-font-dpi-in-net-winforms-app/202172#202172)

阅读[编写高 DPI Win32 应用程序](http://msdn.microsoft.com/en-us/library/windows/desktop/dd464660%28v=vs.85%29.aspx)

# iphone - 如何在 Xcode 4.3.1 中调整标签栏项目的大小？

> ID：10762036
> 
> 赞同：1
> 
> 时间：2012-05-25T22:28:00.303
> 
> 标签：iphone, uitabbarcontroller, xcode4.3, uistoryboard, uitabbaritem

我一直在寻找如何在“标签栏控制器”上调整标签栏项目的大小，但显然找不到任何东西。

我想这样做的原因是因为我正好有 6 个项目，它会导致每当你有 6 个或更多时创建“更多”项目。因此，底部显示 4 个项目，单击时显示其他两个项目的“更多”项目。

我所有项目的标题都很短，所以我想在没有“更多”的情况下将其中的 6 个压缩到正下方，唯一的方法是缩小项目宽度。如何调整每个项目的宽度？

如果我不够清楚，请附上一张图片，提前谢谢。

![在此处输入图像描述](../Images/5be7fa27d464f54aa331cddafc76efa8.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T22:40:22.157

UITabBarController 不支持太多自定义，因此您需要自己编写或使用其他人已经为类似目的编写的。你应该检查 cocoacontrols.com 和 github，我确信已经存在一些东西来完成这个，或者至少是你可以轻松修改的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T22:40:58.453

即使您能够对 TabBar 进行子类化并更改其行为，您也可能必须重写它的内部方法，并且很难估计所需的时间。

为了满足您的要求，我将隐藏选项卡栏并显示另一个控件（可能是分段控件），将其选择事件传递给使用的 tabBarController。这是一种简单快捷的方法，您的应用不会被拒绝。

# c# - 在 JQuery 对话框中隐藏和显示 Div 内容

> ID：10762042
> 
> 赞同：0
> 
> 时间：2012-05-25T22:28:40.183
> 
> 标签：c#, javascript, jquery, ajax, model-view-controller

我在 Div 中有一个带有标签及其验证摘要的字段。它是模态 JQuery 对话框的一部分：

```
<table>
.
.
.
<div id="user-date-add">
                    <tr>
                        <td width="100">
                            <div class="editor-label">
                                @Html.LabelFor(model => model.User.Date)
                            </div>
                        </td>
                        <td>
                            <div class="editor-field">
                                @Html.EditorFor(model => model.User.Date)
                                @Html.ValidationMessageFor(model => model.User.Date)
                            </div>
                        </td>

                    </tr>
                </div>
.
.
. 
```

根据 JavaScript 函数内部的特定条件，我需要使用该 Div 内的 Date 字段和相关数据隐藏或显示此部分

所以我尝试了：

```
 if(condition)
    {
     $("#user-date-add").hide();
    }
     else
    {
      $("#user-date-add").show();
    } 
```

我还尝试利用：

```
$("#user-date-add").trigger(); 
```

它不起作用。表单上的字段甚至不闪烁。是因为 div 是在模态弹出窗口内呈现的吗？还是因为里面有输入标签？顺便说一下，Editor Date 字段显示为 DatePicker。

我怎样才能使这项工作？先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:45:33.293

假设对话框的 ID 为`dialog-box`，那么您可以尝试使用 `$('#dialog-box #user-date-add').hide();`这可能是因为对话框正在实例化的方式，并且可能将现有的 div 留在那里，这意味着您的 jQuery 选择器无法正常工作。

尝试在 Firefox 中使用 Firebug 或在 Chrome 中使用 Web Inspector 在控制台中尝试不同的变体，例如以下内容。

```
$('#user-date-add');
$('[id=user-date-add]');
$('[id=user-date-add');
$('.editor-label'); 
```

希望它有帮助，戴夫

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T17:52:41.507

显然在表格单元格内有 DIV 标签是无效的。

我删除了 div 并将 ID 添加到我需要 .Hide()/.Show() 的实际行中。

```
 <tr id="user-date-add">
                    <td width="100">
                        <div class="editor-label">
                            @Html.LabelFor(model => model.User.Date)
                        </div>
                    </td>
                    <td>
                        <div class="editor-field">
                            @Html.EditorFor(model => model.User.Date)
                            @Html.ValidationMessageFor(model => model.User.Date)
                        </div>
                    </td>

                </tr> 
```

# xcode - Xcode iPhone SDK - 检查 UIImageView 是否无法加载图像

> ID：10762043
> 
> 赞同：1
> 
> 时间：2012-05-25T22:28:45.380
> 
> 标签：xcode, uiimageview, ios5

如何检查 UIImageView 是否无法加载图像？

我有一个 UIImageView 从 URL 加载图像，如下所示：

```
 [MyImageView setImage:[UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:@"http://exampleUrl.com/images/the_image.png"]]]]; 
```

但如果由于某种原因图像不可用，我想加载替代图像。

我将如何解决这个问题？我可以添加某种观察者吗？

或者，我可以检查 ImageView 何时完成加载图像以检查图像是否为零？

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T22:43:52.227

您正在主线程上发出同步请求，甚至没有检查错误情况，例如失败或网络连接超时。

您可以改用它：

```
[NSURLConnection sendAsynchronousRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://exampleUrl.com/images/the_image.png"]] queue:[NSOperationQueue mainQueue] completionHandler:^(NSURLResponse* response, NSData* data, NSError* error){

if(error)
{
  // Error Downloading image data
}
else
{
  [MyImageView setImage:[UIImage imageWithData:data]];
}
}]; 
```

使用 NSURLConnection 使用异步 url 加载。当连接完成下载数据或发生错误时，它会通过连接处理程序块通知。

# sql - XSD 问题，XML 到 SQL 导入 - 此位置不允许文本节点

> ID：10762044
> 
> 赞同：2
> 
> 时间：2012-05-25T22:28:53.113
> 
> 标签：sql, sql-server, xml, xsd, xsd-validation

我正在创建我的第一个 XSD，因为我有一个 4MB 的 XML 文件，我需要将其解析为 SQL，并且使用无类型的 XML 处理一些大的东西需要很长时间（我放弃并在一小时后取消了查询）。

我拥有的 XML 文件采用以下格式（每个产品都有更多元素，但我缩短了它并创建了一个测试 XML 文件，直到我做对了）：

```
 <ITEMS>
    <CREATED value="Wed May 2 9:40:38 BST 2012">
        <PRODUCT ITEM="0001">
            <MODEL>MODELNO1</MODEL>
            <BARCODE>5550204425</BARCODE>
            <TITLE>Item 1 Title</TITLE>
        </PRODUCT>
        <PRODUCT ITEM="0002">
            <MODEL>MODELNO2</MODEL>
            <BARCODE>52614343433</BARCODE>
            <TITLE>Item 2 Title</TITLE>         
        </PRODUCT>
        <PRODUCT ITEM="0003">
            <MODEL>MODELNO3</MODEL>
            <BARCODE>32563533</BARCODE>
            <TITLE>Item 3 Title</TITLE>         
        </PRODUCT>
        <PRODUCT ITEM="0004">
            <MODEL>MODELNO4</MODEL>
            <BARCODE>65135647582</BARCODE>
            <TITLE>Item 4 Title</TITLE>         
        </PRODUCT>
        <PRODUCT ITEM="0005">
            <MODEL>MODELNO5</MODEL>
            <BARCODE>65874112</BARCODE>
            <TITLE>Item 4 Title</TITLE>         
        </PRODUCT>
    </CREATED>
   </ITEMS> 
```

这个 XML 文件是由外部供应商系统自动生成的，我别无选择，只能以当前格式使用它。

我为它创建了这个模式：

```
<?xml version="1.0"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:element name="ITEMS">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="CREATED">
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="PRODUCT" maxOccurs="unbounded">
                                <xs:complexType>
                                    <xs:sequence>
                                        <xs:element name="MODEL" type="xs:string" maxOccurs="unbounded" />
                                        <xs:element name="BARCODE" type="xs:string" maxOccurs="unbounded" />
                                        <xs:element name="TITLE" type="xs:string" maxOccurs="unbounded" />
                                    </xs:sequence>
                                </xs:complexType>
                            </xs:element>
                        </xs:sequence>
                    </xs:complexType>
                </xs:element>
            </xs:sequence>
        </xs:complexType>
    </xs:element>
</xs:schema> 
```

在 SQL 中，我首先创建了一个模式集合，如下所示：

```
IF EXISTS ( SELECT * FROM sys.xml_schema_collections where [name] = 'MyXmlSchema')
DROP XML SCHEMA COLLECTION [MyXmlSchema]
GO

DECLARE @MySchema XML
SET @MySchema = 
(
    SELECT * FROM OPENROWSET
    (
        BULK 'C:\test\schema2.xsd', SINGLE_CLOB 
    ) AS xmlData
)

CREATE XML SCHEMA COLLECTION [MyXmlSchema] AS @MySchema 
GO 
```

然后我根据模式创建了一个表：

```
CREATE TABLE [dbo].[XMLProds] (
    [MODEL] xml(CONTENT dbo.[MyXmlSchema]) NOT NULL,
    [EAN] xml(CONTENT dbo.[MyXmlSchema]) NOT NULL,
    [NAME] xml(CONTENT dbo.[MyXmlSchema]) NOT NULL
) 
```

最后，验证 XML：

```
DECLARE @x2 XML ([MyXmlSchema])
SELECT @x2 = '<copied the code from the test XML file and pasted here>' 
```

验证不喜欢“创建”字段中的日期值，我可以不用它，因为它只声明一次并且可以轻松删除。但它也不喜欢每个产品字段中的“ITEM”值，这是没有问题的。2\. 这一点不容忽视，因为它出现在每一个项目中（全部 2-3 千个）。有没有办法解决这个问题？

只是为了破解，我从测试 XML 中删除了不需要的值，并且验证通过了。然后我执行了这个语句以尝试填充表：

```
INSERT INTO XMLProds (MODEL, BARCODE, TITLE)

    SELECT X.product.query('MODEL').value('.', 'VARCHAR(20)'),
           X.product.query('BARCODE').value('.', 'VARCHAR(50)'),
           X.product.query('TITLE').value('.', 'VARCHAR(150)')

FROM (
    SELECT CAST(x AS XML)
    FROM OPENROWSET(BULK 'C:\test\Products2test.xml', SINGLE_BLOB) AS T(x)) AS T(x)
    CROSS APPLY x.nodes('/ITEMS/CREATED/PRODUCT') AS X(product); 
```

..但遇到以下错误：

> 消息 6909，级别 16，状态 1，第 21 行 XML 验证：此位置不允许使用文本节点，类型是使用仅元素内容或简单内容定义的。地点： /

任何有关我在这里出错的地方的帮助将不胜感激！提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T01:44:47.187

我将从一个有效的 XSD 开始。您缺少属性，这就是您在处理不需要的内容时遇到问题的原因。

```
<?xml version="1.0" encoding="utf-8"?>
<!--XML Schema generated by QTAssistant/XML Schema Refactoring (XSR) Module (http://www.paschidev.com)-->
<xsd:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <xsd:element name="ITEMS">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="CREATED">
          <xsd:complexType>
            <xsd:sequence>
              <xsd:element maxOccurs="unbounded" name="PRODUCT">
                <xsd:complexType>
                  <xsd:sequence>
                    <xsd:element name="MODEL" type="xsd:string" />
                    <xsd:element name="BARCODE" type="xsd:unsignedLong" />
                    <xsd:element name="TITLE" type="xsd:string" />
                  </xsd:sequence>
                  <xsd:attribute name="ITEM" type="xsd:unsignedByte" use="required" />
                </xsd:complexType>
              </xsd:element>
            </xsd:sequence>
            <xsd:attribute name="value" type="xsd:string" use="required" />
          </xsd:complexType>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
</xsd:schema> 
```

如果它仍然不起作用，请告诉我。

# php - 将来运行脚本 - 从数据库中检索的日期

> ID：10762045
> 
> 赞同：-1
> 
> 时间：2012-05-25T22:28:55.970
> 
> 标签：php, python, mysql

所以我想做的是将来执行一个脚本。例如，我希望用户选择他们想要通过电子邮件发送的日期。在那一天，我的程序将向用户发送电子邮件。

如何将程序应该在数据库中执行的未来时间存储并有效地检索它？我只是在这里寻找理论。

如果您好奇，我将使用 MySQL，脚本将使用 Python。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T23:58:30.963

在数据库中放置一个[日期](http://dev.mysql.com/doc/refman/5.5/en/datetime.html)。运行定期[cron](https://en.wikipedia.org/wiki/Cron)作业——如果数据库中的日期 < 现在，则触发提醒或其他任何内容。

# java - 将 *.pfb 文件转换为 *.svg 文件

> ID：10762049
> 
> 赞同：0
> 
> 时间：2012-05-25T22:29:30.043
> 
> 标签：java, fonts

## 语境

我有兴趣*手动*将 *.pfb (Type 1) 字体文件转换为 Java 中的 *.svg 文件。

我知道

*   我可以从 Java 中的 *.pfb 文件中读取构造字体对象
*   我可以为每个字符生成 GlyphVectors。

## 问题

我不知道的是：

*   如何从 GlyphVector 转到可以输出到 *.svg 文件的笔划/路径？

## 在旁边

这是一个学习练习。为了学习，我故意重新发明轮子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:21:54.617

您想生成包含字体中所有字形的 SVG 图像还是生成[SVG 字体](http://www.w3.org/TR/SVG/fonts.html)？

要生成 SVG 图像，您可以使用[Batik](http://xmlgraphics.apache.org/batik/)。将每个字形绘制到 Batik 图形上下文中（使用[SVGGraphics2D](http://xmlgraphics.apache.org/batik/using/svg-generator.html)），然后您就可以从 Batik 编写 SVG 文件。

# javascript - Jquery外部页面平滑滚动

> ID：10762050
> 
> 赞同：0
> 
> 时间：2012-05-25T22:29:31.417
> 
> 标签：javascript, jquery

好的，这是我目前面临的问题，当锚链接具有名称或 ID 时，如何让 jquery 平滑滚动到锚链接。

```
<a name="scrollhere"> Smooth Scroll here on page load </a>
<a id="scrollhere"> Smooth Scroll here on page load </a> 
```

所以不管锚链接说什么，一旦页面加载，它应该平滑滚动。这是一个人给我的代码，它可以工作。但唯一的问题是此代码仅在这是 secnario 时才有效

```
<a class="scrollhere"> Smooth Scroll here on page load </a> 
```

该代码仅在锚链接具有我希望平滑滚动的一类时才有效。但我希望它是一个名字和/或一个ID。

```
$(window).bind("load", function() {
       var urlHash = window.location.href.split("#")[1];
       $('html,body').animate({scrollTop:$('.'+urlHash).offset().top}, 4000);  
}); 
```

告诉我如何更改此代码以执行我想要执行的操作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:45:41.733

您可以搜索要匹配的每个区域并返回第一个匹配项，如下所示：

```
$(window).bind("load", function() {
   var urlHash = window.location.href.split("#")[1];
   $('html,body').animate({scrollTop:$('.'+urlHash+', #'+urlHash+', [name='+urlHash+']').first().offset().top}, 4000);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T22:32:55.827

寻找`id`：

```
scrollTop:$('#'+urlHash); 
```

要查找名称：

```
scrollTop:$('[name='+urlHash+']'); 
```

# php - 从网站解析特定数据项

> ID：10762051
> 
> 赞同：0
> 
> 时间：2012-05-25T22:29:39.353
> 
> 标签：php, parsing, screen-scraping, web-scraping

我试图从[***这个网页中检索以下数据变量***](http://www.walmart.com/storeLocator/ca_storefinder_details_short.do?rx_dest=/index.gsp&rx_title=com.wm.www.apps.storelocator.page.serviceLink.title.default&edit_object_id=2092&sfsearch_single_line_address=K6T)

*   地址
*   城市
*   状态
*   邮政编码
*   商店电话
*   药房电话
*   营业时间
*   药房时间
*   取件选项
*   在这个商店/位置
*   站点到存储时间

我尝试过这种方式，但我无法分离出一些数据来存储在上述数据变量中，所以需要一些 PHP 专家的帮助和建议

```
 $html = file_get_html('http://www.walmart.com/storeLocator/ca_storefinder_results.do?serviceName=&rx_title=com.wm.www.apps.storelocator.page.serviceLink.title.default&rx_dest=%2Findex.gsp&sfrecords=50&sfsearch_single_line_address=K6T');
foreach($html->find('div[class=StoreAddress] div[1]') as $name)
{
echo $name->innertext.'<br>';
} 
```

这个网站的 html 很难用它的标签来识别每个数据项，因为它们没有分配给标签的正确 id。任何人都可以建议简单且可扩展的方法来解析本[网站](http://www.walmart.com/storeLocator/ca_storefinder_details_short.do?rx_dest=/index.gsp&rx_title=com.wm.www.apps.storelocator.page.serviceLink.title.default&edit_object_id=2092&sfsearch_single_line_address=K6T)的上述数据项。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T22:44:41.653

我看到他们在地址之前实现了一个不错的 hr 标签。在 hr 标签上展开它并使用带有地址的剩余部分来重建 html 对象。然后遍历 div 并使用 preg_match 来查看对象是否包含对您想要的数据的任何引用。

```
foreach($html->find(’div’) as $test)
    {
     if(preg_match(’/Adress/’,$test->innertext))
        {
        filter out addy
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T23:44:55.543

html 并没有那么复杂。Php 的迭代器和 dom/regex 函数对于这样的任务很笨拙，但可以做到：

```
$dom = new DOMDocument();
@$dom->loadHTMLFile('http://www.walmart.com/storeLocator/ca_storefinder_details_short.do?rx_dest=/index.gsp&rx_title=com.wm.www.apps.storelocator.page.serviceLink.title.default&edit_object_id=2092&sfsearch_single_line_address=K6T');
$xpath = new DOMXPath($dom);

foreach($xpath->query('//div[@class="StoreAddress"]') as $div) {
  // title
  echo $xpath->query(".//div[1]", $div)->item(0)->nodeValue . "\n";
  // street
  echo $xpath->query(".//div[2]", $div)->item(0)->nodeValue . "\n";
  // city state and zip
  preg_match('/(.*), ([A-Z]{2}) (\d{5})/', $xpath->query(".//div[3]", $div)->item(0)->nodeValue, $m);
  // city
  echo $m[1] . "\n";
  // state
  echo $m[2] . "\n";
  // zip
  echo $m[3] . "\n";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T02:36:21.907

试用[simple_html_dom](http://simplehtmldom.sourceforge.net/)库。在页面上，有一些简单的示例可以帮助您快速入门。

我一直在成功地将它用于您正在尝试做的事情。

# java - Android NoClassDefFoundError

> ID：10762058
> 
> 赞同：-1
> 
> 时间：2012-05-25T22:30:26.533
> 
> 标签：java, android, junit

我有一个带有源文件的应用程序项目：

```
androidsrc/MainActivity.java
androidsrc/ClientSession.java 
```

当我从 eclipse 中运行 ClientSessionTest.java 作为模拟器上的 android junit 测试时，出现此错误。

我遵循了 android 开发者网站上的标准 Hello，Testing 教程。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T00:12:00.900

这是另一个问题的征兆。我的一个类没有正确编译，因为隐藏在我的日志猫“由意外 DEX 解析的类”中，无论这意味着什么......

# jsf - 使用 primefaces 在 jsf 中动态启用/禁用复选框

> ID：10762061
> 
> 赞同：0
> 
> 时间：2012-05-25T22:31:30.630
> 
> 标签：jsf, dynamic, checkbox, primefaces

我有一个数据表，其中包含从数据库动态生成的数据。用户可以选择/取消选择行，但只能从数据库中选择未设置为 mustSelect 的行。

**我的豆子**

```
 public boolean isDisabled () {
    if (evState == EvaluationState.MUST_EVALUATE) {
        return true;
    } else {
        return false;
    }
}

public boolean isChecked() {
    if (evState == EvaluationState.EVALUATE
            || evState == EvaluationState.MUST_EVALUATE) {
        return true;
    } else {
        return false;

    }
} 
```

**和我的 xhtmlCode：**

> < p:selectBooleanCheckbox value="#{myBean.checked}" disabled = "#{myBean.disabled }"/>

目前没有像我想要的那样工作。选中所有复选框。在编译时，我不知道将启用哪个复选框，这就是我禁用该方法的原因。

如果有人有解决方案如何动态设置禁用，我会很高兴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T05:02:01.727

您的模型应该包含 2 个属性来处理这些操作，而不是您的控制器。

```
//defining the model
public class Data {
    private String name;
    //you get the idea...
    private boolean checked;
    private boolean disabled;
    //getters and setters...
}

//defining the controller
@ViewScope
public class MyBean {
    private List<Data> lstData;

    public MyBean() {
        //initialize data...
    }

    //getter and setter
} 
```

风景

```
<h:dataTable value="#{myBean.lstData}" var="data">
    <h:column>
        <h:outputText value="#{data.name}" />
    </h:column>
    <h:column>
        <p:selectBooleanCheckbox value="#{data.checked}" disabled = "#{data.disabled }"/>
    </h:column>
</h>dataTable> 
```

这样，每一行都有自己的检查和禁用数据值。

# java - Java（android）配置文件（脚本）

> ID：10762064
> 
> 赞同：2
> 
> 时间：2012-05-25T22:31:49.633
> 
> 标签：java, android, configuration-files

我必须能够使用配置文件更新我的 android 应用程序行为。思路如下：

*   服务器上有一个配置文件（这里允许任何类型的语义）。
*   如果配置文件比本地文件更新，Android 应用程序会下载该配置文件。
*   配置文件应该处理设置常量值和表达式。

什么样的表达方式？例如

```
if number_of_rows_in_database > 2:
some_flag = true 
```

Android上是否有任何可用的库/类/函数，这使得这更容易？

# sql - 为什么排序要花费我 70%？

> ID：10762070
> 
> 赞同：-1
> 
> 时间：2012-05-25T22:32:25.830
> 
> 标签：sql, sql-server, sql-server-2008

我的观点很慢：

```
ALTER  view [dbo].[TAT] as
WITH d AS ( SELECT TAT = CASE WHEN TAT > 191 THEN 192 ELSE TAT END,
   [MONTH entered],
   [YEAR] = DATEPART(yyyy,[datetime entered])
  FROM [SalesDWH].[dbo].[TurnAround] TurnAround
  left outer join hermes.lom.dbo.lom_specimen Lom
  on TurnAround.[specimen id] = lom.specimen
  LEFT outer join SalesDWH.dbo.Isomers Isomers
  on TurnAround.[specimen id] = Isomers.[accession id]
  WHERE lom.specimen is null
  and isomers.[accession id] is null
 -- GROUP BY CASE WHEN TAT > 191 THEN 192 ELSE TAT END 
    --[datetime entered],[Month Entered]
),
n AS ( SELECT TOP (192) n = ROW_NUMBER() OVER (ORDER BY [object_id]) 
  FROM sys.all_columns ORDER BY [object_id]
)
SELECT TAT = n.n,

  [MONTH entered],
  [YEAR]

FROM n LEFT OUTER JOIN d 
ON n.n = d.TAT  

GO 
```

当我查看执行计划时，它告诉我其中一个步骤是 SORTING 花费了我 70%。

当我检查 SORTING 步骤时，它说我的 ORDER BY 是：

```
[SalesDWH].[dbo].[QuickLabDump].Specimen ID Ascending, [SalesDWH].[dbo].[QuickLabDump].Date Entered Ascending, [SalesDWH].[dbo].[QuickLabDump].Time Entered Ascending, [SalesDWH].[dbo].[QuickLabDump].Date Completed Ascending, [SalesDWH].[dbo].[QuickLabDump].Time Completed Ascending, [SalesDWH].[dbo].[QuickLabDump].Practice Name Ascending, [SalesDWH].[dbo].[QuickLabDump].Practice Code Ascending, [SalesDWH].[dbo].[QuickLabDump].Order Count Ascending, [SalesDWH].[dbo].[QLMLISMapping].MLIS Practice ID Ascending, [SalesDWH].[dbo].[adjustedtime].TimeDifference Ascending 
```

但我没有在任何地方指定 ORDER BY。

**问题：**

1.  如果我没有任何 ORDER BY，为什么会显示 ASCENDING for ORDER BY？
2.  如何加快查看速度？

我不知道是否需要此信息，但上面的视图正在查询另一个名为`TURNAROUND`：

```
USE [SalesDWH]
GO

/****** Object:  View [dbo].[TurnAround]    Script Date: 05/25/2012 15:32:08 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER VIEW [dbo].[TurnAround]
AS
SELECT     dbo.QuickLabDump.[Specimen ID], DATEPART(yyyy, dbo.QuickLabDump.[Date Entered]) AS [Year Entered], CAST(CAST(dbo.QuickLabDump.[Date Entered] AS DATE) 
                      AS DATETIME) + CAST(dbo.QuickLabDump.[Time Entered] AS TIME) AS [DateTime Entered], CAST(CAST(dbo.QuickLabDump.[Date Completed] AS DATE) AS DATETIME) 
                      + CAST(dbo.QuickLabDump.[Time Completed] AS TIME) AS [DateTime Completed], dbo.QuickLabDump.[Practice Code] AS [QL Practuce Code], 
                      dbo.QLMLISMapping.[MLIS Practice ID], DATEPART(m, dbo.QuickLabDump.[Date Entered]) AS [Month Entered], ROUND(CAST(DATEDIFF(mi, 
                      CAST(CAST(dbo.QuickLabDump.[Date Entered] AS DATE) AS DATETIME) + CAST(dbo.QuickLabDump.[Time Entered] AS TIME), 
                      CAST(CAST(dbo.QuickLabDump.[Date Completed] AS DATE) AS DATETIME) + CAST(dbo.QuickLabDump.[Time Completed] AS TIME)) AS FLOAT) / 60, 0) AS TAT, 
                      ROUND(CAST(DATEDIFF(mi, CAST(CAST(dbo.QuickLabDump.[Date Entered] AS DATE) AS DATETIME) + CAST('9:00AM' AS TIME), 

                      CAST(CAST(dbo.QuickLabDump.[Date Completed] AS DATE) AS DATETIME) 
                      + CAST(dbo.QuickLabDump.[Time Completed] AS TIME)) AS float) / 60, 0) 

                      AS [Hours TurnAround Since 9AM], TAT9AMStateAdjusted=                   

                      ROUND(CAST(DATEDIFF(mi, CAST(CAST(dbo.QuickLabDump.[Date Entered] AS DATE) AS DATETIME) 
                      + CAST('9:00AM' AS TIME),                                            
                      CAST(CAST(dbo.QuickLabDump.[Date Completed] AS DATE) AS DATETIME) 
                      + CAST(dbo.QuickLabDump.[Time Completed] AS TIME)) AS float) / 60, 0)                         

                      +dbo.adjustedtime.timedifference
                      ,dbo.QuickLabDump.[Order Count], CONVERT(VARCHAR(8), DATEADD(D, - (1 * DATEPART(dw, dbo.QuickLabDump.[Date Entered])) + 6,
                       dbo.QuickLabDump.[Date Entered]), 1) AS [Week Ending]
FROM         dbo.QuickLabDump 
             INNER JOIN dbo.QLMLISMapping 
             ON dbo.QuickLabDump.[Practice Code] = dbo.QLMLISMapping.[Quicklab ID]
             left outer join dbo.AccountState
             on dbo.QuickLabDump.[Practice Code]=dbo.AccountState.[Account]
             left outer join dbo.AdjustedTime 
             ON dbo.AccountState.[state]=dbo.adjustedtime.[state]
WHERE     (dbo.QuickLabDump.[Practice Code] NOT LIKE 'test%') AND (dbo.QuickLabDump.[Specimen ID] NOT LIKE 'of%') AND (dbo.QuickLabDump.Outcome <> 'rejected')
GROUP BY dbo.QuickLabDump.[Specimen ID], dbo.QuickLabDump.[Date Entered], dbo.QuickLabDump.[Time Entered], dbo.QuickLabDump.[Date Completed], 
                      dbo.QuickLabDump.[Time Completed], dbo.QuickLabDump.[Practice Name], dbo.QuickLabDump.[Practice Code], dbo.QuickLabDump.[Order Count], 
                      dbo.QLMLISMapping.[MLIS Practice ID],dbo.adjustedtime.timedifference
HAVING      (dbo.QuickLabDump.[Order Count] = MAX(dbo.QuickLabDump.[Order Count])) OR
                      (dbo.QuickLabDump.[Order Count] IS NULL)

GO 
```

以下是表定义：

```
CREATE TABLE [dbo].[QuickLabDump](
    [Specimen ID] [varchar](50) NULL,
    [Client Key] [int] NULL,
    [Outcome] [varchar](50) NULL,
    [Medications] [varchar](max) NULL,
    [Date Collected] [date] NULL,
    [Time Collected] [time](0) NULL,
    [Date Entered] [date] NULL,
    [Time Entered] [time](0) NULL,
    [Date Completed] [date] NULL,
    [Time Completed] [time](0) NULL,
    [Test Date] [date] NULL,
    [Test Time] [time](0) NULL,
    [Practice Name] [varchar](500) NULL,
    [Practice Code] [varchar](50) NULL,
    [Requesting Physician] [varchar](500) NULL,
    [Other Medications] [varchar](max) NULL,
    [Order Comments] [varchar](max) NULL,
    [Reference Number] [varchar](500) NULL,
    [Order Count] [int] NULL,
    [QuickLabDumpID] [int] NOT NULL,
    [Source] [varchar](50) NULL,
    [MLIS] [varchar](50) NULL,
 CONSTRAINT [PK_QuickLabDump_1] PRIMARY KEY CLUSTERED 
(
    [QuickLabDumpID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T22:39:32.267

您看到已排序的列是 TurnAround`GROUP BY`子句中的列。执行 a 的最简单方法`GROUP BY`是首先按组列排序，然后按组拆分行，最后计算每个组的聚合，在这种情况下，看起来这正是数据库正在做的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T22:40:38.487

您的 group by 和（外部）连接可能是排序的原因，您正在使用的列上是否有任何匹配的索引？如果您发布表的完整定义（包括索引和键/约束），那么找到问题的猜测就会减少。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-25T22:43:51.390

查询分析器向您显示在您的 Group BY 上进行排序。

您应该在 group by 正在使用的字段上测试\创建索引以提高性能。

这是有关 Group By 如何创建排序的更详细说明。[关联](http://beyondrelational.com/modules/24/syndicated/500/posts/12126/sql-server-2012-detecting-sort-warnings-with-extended-events-sortwarning-event.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T22:36:08.207

只是为了确保你知道，我看到一个订单：

```
,
n AS ( SELECT TOP (192) n = ROW_NUMBER() OVER (ORDER BY [object_id]) 
  FROM sys.all_columns ORDER BY [object_id]
) 
```

# objective-c - Cocos2D 基本故障排除

> ID：10762075
> 
> 赞同：0
> 
> 时间：2012-05-25T22:33:21.273
> 
> 标签：objective-c, xcode, cocos2d-iphone

一个基本的问题，我只是想将 AppDelegate.m 中的 runWithScene: 方法更改为 [GameScene 节点]。我创建了 GameScene 类，并在其上创建了我的 GameLayer 类的实例 var，我发现了这个错误，这很烦人：

`Undefined symbols: "_OBJC_CLASS_$_GameLayer", referenced from: objc-class-ref-to-GameLayer in GameScene.o ld: symbol(s) not found collect2: ld returned 1 exit status`

这是我的 GameScene 代码：

`GameLayer *GameLayer; GameLayer = [GameLayer node];`

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T14:38:20.927

确保您的 GameLayer 类包含在您的目标中。显示实用程序（右侧、顶部、查看按钮）。之后，单击 GameLayer.m 模块上的项目导航器。目标成员资格显示在实用程序中。如果没有点击目标，GameLayer 类不会被编译（即没有错误），因此链接器找不到目标模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T23:50:03.463

好像你还没有导入`GameLayer`类。在实现的顶部，在 import 语句旁边，添加：

```
#import "GameLayer.h" 
```

更新：

好的，我想我知道发生了什么。你必须编译你的源代码。转到项目设置，然后是项目目标，然后是构建阶段，最后将 GameLayer 添加到下拉列表“编译源”。

# c - 汇编 x86 中的 Math.h 库函数？

> ID：10762079
> 
> 赞同：2
> 
> 时间：2012-05-25T22:33:54.433
> 
> 标签：c, linux, assembly, math.h

我试图将在 Linux（fedora 9）下编写的 C 代码转换为汇编 x86 代码，但是，我在 Math.h 函数中遇到了问题。该库中的函数，如 ceil、floor、log、log10、pow 在程序集 x86 中未定义。你能帮我解决这个问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T00:00:21.380

大多数库函数不会用汇编语言定义，至少在加法运算符直接映射到`ADD`指令的意义上不会。如果您想在汇编中重新编写库，则必须使用处理器可用的任何功能来实现该功能。大多数库函数都需要一个单独的汇编语言子程序，而不仅仅是一个操作。解决这个问题的最简单方法是让各个库子例程独立工作，然后将它们合并到更大的程序中。

您可以编译 C 代码并检查反汇编的输出，但要注意编译器优化可能会使输出难以让人理解。

请问这个任务背后的目的是什么？由于编译器本质上是 C 到汇编语言的翻译器，因此很少需要手动执行此操作。这是作业吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T22:39:26.373

找出这些函数的作用的最好方法是查看它们在 glibc 源代码中的实现。它应该给你足够清晰的洞察力。另一种方法是查看**/usr/lib/**中的**lm.so**的反汇编。

# java - 单击时在 JButton 上绘制一个椭圆

> ID：10762080
> 
> 赞同：1
> 
> 时间：2012-05-25T22:34:21.610
> 
> 标签：java, swing, jbutton, paintcomponent, gomoku

我已经开始为我的 Java 类开发一个项目 - LAN gomoku/连续五个。游戏板由一个填充有按钮 (JButton) 的二维数组表示。使用事件处理程序（clickHandler 类），我想在单击的按钮上绘制一个椭圆（clickHandler 对象的参数）。我的以下代码没有工作（我不知道如何摆脱变量 g 的空值）......我将不胜感激任何建议。十分感谢。

```
 class clickHandler implements ActionListener {

        JButton button;
        Dimension size;
        Graphics g;

        public clickHandler(JButton button) {
            this.button = button;
            this.size = this.button.getPreferredSize();
        }

        @Override
        public void actionPerformed(ActionEvent ae) {
                this.g.setColor(Color.BLUE);
                this.g.fillOval(this.button.getHorizontalAlignment(), this.button.getVerticalAlignment(), this.size.width, this.size.height);

                this.button.paint(this.g);
                this.button.setEnabled(false);
        }
    } 
```

（在创建 GUI 的类中 - 充满按钮的游戏板 - 我为每个按钮分配一个新的 Action Listener - clickHandler 的实例）这样：

```
 gButton.addActionListener(new clickHandler(gButton)); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T22:37:49.763

你必须：

*   扩展 JButton 类，并覆盖该`paintComponent(Graphics g)`方法。
*   执行覆盖`getPreferredSize()`方法，该方法将返回`Dimension`对象，并通过为其提供适当的大小来帮助`Layout Manager`您将其放置在`JButton`上。`Container/Component`

*   在那里制作你的圈子代码。

*   添加一个onClickListener，如果被点击，则在被点击的按钮上设置一个标志，并调用它来重绘。

* * *

关于`Graphics`对象：最好将它保存在它的`paintComponent`方法中，并且只在那里使用它。它总是会在重绘时传递，如果你将它保存到其他时刻，可能会发生奇怪的事情（快乐的实验:)）。

一个小例子：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class ButtonExample
{
    private MyButton customButton;

    private void displayGUI()
    {
        JFrame frame = new JFrame("Custom Button Example");
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

        customButton = new MyButton();
        customButton.addActionListener(new ActionListener()
        {
            public void actionPerformed(ActionEvent ae)
            {
                MyButton.isClicked = true;
                customButton.repaint();
            }
        });

        frame.getContentPane().add(customButton, BorderLayout.CENTER);
        frame.pack();
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
    }

    public static void main(String... args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                new ButtonExample().displayGUI();
            }
        });
    }
}

class MyButton extends JButton
{
    public static boolean isClicked = false;

    public Dimension getPreferredSize()
    {
        return (new Dimension(100, 40));
    }

    public void paintComponent(Graphics g)
    {
        if (!isClicked)
            super.paintComponent(g);
        else
        {
             g.setColor(Color.BLUE);
             g.fillOval(getHorizontalAlignment(), getVerticalAlignment(), getWidth(), getHeight());
        }       
    }
} 
```

# networking - tcp重传队列

> ID：10762081
> 
> 赞同：0
> 
> 时间：2012-05-25T22:34:30.880
> 
> 标签：networking, tcp, timer

我发现了一个关于 TCP 上的重传队列的有趣问题，我一直在阅读[这篇](http://flylib.com/books/en/3.475.1.124/1/)
文章，从这篇文章中我可以看到 TCP 上有这么多定时器，但我不明白它们是如何相互同步的，因为例如，当消息被发送时，它被放置在一个重传队列中，当重传队列的时间达到 0 时，一个重传计时器将检查这个队列。这个队列是队列数据结构吗？而且好像有两个TCP函数会检查这个队列，第一个是重传队列重传消息，以及删除已经成功传递的数据包的synak计时器，在这种情况下必须有一些同步机制那些计时器访问同一个队列，对吗？

你能帮助理解这是如何工作的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T01:38:17.517

我认为您对计时器有错误的概念。这不是一个应用程序。这些是操作系统计时器：保持它们同步没有问题。我认为您对队列也有错误的概念：我不知道您所说的“这个队列是队列数据结构”是什么意思吗？这个问题真的没有意义。队列就是队列。在这种情况下，它又是一个内核队列。它是如何实现的，除了内核作者之外，任何人都不关心。

# python - Python 元类：为什么在类定义期间不调用 __setattr__ 来设置属性？

> ID：10762088
> 
> 赞同：17
> 
> 时间：2012-05-25T22:35:12.460
> 
> 标签：python, metaclass

我有以下python代码：

```
class FooMeta(type):
    def __setattr__(self, name, value):
        print name, value
        return super(FooMeta, self).__setattr__(name, value)

class Foo(object):
    __metaclass__ = FooMeta
    FOO = 123
    def a(self):
        pass 
```

我本来期望`__setattr__`同时调用元类`FOO`和`a`. 但是，它根本没有被调用。`Foo.whatever`当我在定义类之后分配一些东西时，*就会*调用该方法。

这种行为的原因是什么？有没有办法拦截在创建类期间发生的分配？使用`attrs`in`__new__`不起作用，因为我想[检查一个方法是否被重新定义](https://stackoverflow.com/q/10761988/298479)。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-26T02:57:30.880

类块大致是构建字典的语法糖，然后调用元类来构建类对象。

这个：

```
class Foo(object):
    __metaclass__ = FooMeta
    FOO = 123
    def a(self):
        pass 
```

就好像你写的一样：

```
d = {}
d['__metaclass__'] = FooMeta
d['FOO'] = 123
def a(self):
    pass
d['a'] = a
Foo = d.get('__metaclass__', type)('Foo', (object,), d) 
```

只有没有命名空间污染（实际上，还需要搜索所有基础以确定元类，或者是否存在元类冲突，但我在这里忽略了这一点）。

元类'`__setattr__`可以控制当您尝试在其实例之一（类对象）上设置属性时发生的情况，但**在类块内**您没有这样做，您插入到字典对象中，因此`dict`类控制发生了什么，而不是你的元类。所以你运气不好。

* * *

除非您使用的是 Python 3.x！在 Python 3.x 中，您可以`__prepare__`在元类上定义一个类方法（或静态方法），它控制在将类块中的属性集传递给元类构造函数之前，使用什么对象来累积属性集。默认`__prepare__`只返回一个普通字典，但您可以构建一个不允许重新定义键的自定义类字典，并使用它来累积您的属性：

```
from collections import MutableMapping

class SingleAssignDict(MutableMapping):
    def __init__(self, *args, **kwargs):
        self._d = dict(*args, **kwargs)

    def __getitem__(self, key):
        return self._d[key]

    def __setitem__(self, key, value):
        if key in self._d:
            raise ValueError(
                'Key {!r} already exists in SingleAssignDict'.format(key)
            )
        else:
            self._d[key] = value

    def __delitem__(self, key):
        del self._d[key]

    def __iter__(self):
        return iter(self._d)

    def __len__(self):
        return len(self._d)

    def __contains__(self, key):
        return key in self._d

    def __repr__(self):
        return '{}({!r})'.format(type(self).__name__, self._d)

class RedefBlocker(type):
    @classmethod
    def __prepare__(metacls, name, bases, **kwargs):
        return SingleAssignDict()

    def __new__(metacls, name, bases, sad):
        return super().__new__(metacls, name, bases, dict(sad))

class Okay(metaclass=RedefBlocker):
    a = 1
    b = 2

class Boom(metaclass=RedefBlocker):
    a = 1
    b = 2
    a = 3 
```

运行它给了我：

```
Traceback (most recent call last):
  File "/tmp/redef.py", line 50, in <module>
    class Boom(metaclass=RedefBlocker):
  File "/tmp/redef.py", line 53, in Boom
    a = 3
  File "/tmp/redef.py", line 15, in __setitem__
    'Key {!r} already exists in SingleAssignDict'.format(key)
ValueError: Key 'a' already exists in SingleAssignDict 
```

一些注意事项：

1.  `__prepare__`必须是`classmethod`or `staticmethod`，因为它是在元类的实例（您的类）存在之前被调用的。
2.  `type`仍然需要它的第三个参数是一个真实的`dict`，所以你必须有一个`__new__`将 转换`SingleAssignDict`为普通参数的方法
3.  我本可以`dict`对. 所以我更喜欢子类化和包装字典。`update``__setitem__``collections.MutableMapping`
4.  实际的`Okay.__dict__`对象是一个普通的字典，因为它是由它设置的`type`并且`type`对它想要的字典类型很挑剔。这意味着在类创建之后覆盖类属性不会引发异常。如果要保持类对象字典强制的不覆盖，可以`__dict__`在调用超类后覆盖属性。`__new__`

* * *

遗憾的是，这种技术在 Python 2.x 中不可用（我检查过）。该`__prepare__`方法没有被调用，这很有意义，因为在 Python 2.x 中，元类是由`__metaclass__`魔法属性而不是类块中的特殊关键字确定的；这意味着用于累积类块属性的 dict 对象在元类已知时已经存在。

比较 Python 2：

```
class Foo(object):
    __metaclass__ = FooMeta
    FOO = 123
    def a(self):
        pass 
```

大致相当于：

```
d = {}
d['__metaclass__'] = FooMeta
d['FOO'] = 123
def a(self):
    pass
d['a'] = a
Foo = d.get('__metaclass__', type)('Foo', (object,), d) 
```

与 Python 3 相比，要调用的元类是从字典中确定的：

```
class Foo(metaclass=FooMeta):
    FOO = 123
    def a(self):
        pass 
```

大致相当于：

```
d = FooMeta.__prepare__('Foo', ())
d['Foo'] = 123
def a(self):
    pass
d['a'] = a
Foo = FooMeta('Foo', (), d) 
```

要使用的字典在哪里由元类确定。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-25T22:47:38.330

在创建课程期间不会发生任何作业。或者：它们正在发生，但不是在您认为的上下文中。所有类属性都从类主体范围收集并传递给 metaclass' `__new__`，作为最后一个参数：

```
class FooMeta(type):
    def __new__(self, name, bases, attrs):
        print attrs
        return type.__new__(self, name, bases, attrs)

class Foo(object):
    __metaclass__ = FooMeta
    FOO = 123 
```

原因：当类体中的代码执行时，还没有类。*这意味着元类还*没有机会拦截任何东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-25T22:47:19.657

类属性作为单个字典传递给元类，我的假设是这用于`__dict__`一次更新类的属性，例如，类似于 `cls.__dict__.update(dct)`而不是`setattr()`对每个项目执行操作。更重要的是，这一切都是在 C-land 中处理的，根本不是为了调用 custom 而编写的`__setattr__()`。

在元类的方法中对类的属性做任何你想做的事情是很容易的`__init__()`，因为你是作为 a 传递类命名空间的`dict`，所以就这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-26T01:25:52.310

在类创建期间，您的命名空间被评估为一个 dict 并作为参数传递给元类，以及类名和基类。因此，在类定义中分配类属性不会按您期望的方式工作。它不会创建一个空类并分配所有内容。您也不能在 dict 中有重复的键，因此在类创建期间，属性已经被重复数据删除。只有在类定义之后设置一个属性，您才能触发您的自定义 __setattr__。

因为命名空间是一个字典，所以您无法检查重复的方法，正如您的其他问题所建议的那样。唯一可行的方法是解析源代码。

# java - 我需要在 if 语句之外使用变量。它说我需要制作 if final，但如果我尝试使用它，它将无法正常工作

> ID：10762092
> 
> 赞同：0
> 
> 时间：2012-05-25T22:36:17.623
> 
> 标签：java, variables, global-variables

我有这个代码：

```
public void onPlayerInteract(PlayerInteractEvent event) {
    final Action action = event.getAction();
    Location l1 = null;
    Location l2 = null;
    if (action == Action.LEFT_CLICK_BLOCK){
        l1 = event.getClickedBlock().getLocation();
    } else if (action == Action.RIGHT_CLICK_BLOCK) {
        l2 = event.getClickedBlock().getLocation();
    }

    Thread t = new Thread() {
        @Override
        public void run() {
            while(true) {
                try {
                    Thread.sleep(1000*60*60);
                    Location maxx = l1.getX();
                    Location maxy = l1.getY();
                    Location maxz = l1.getZ();

                    Location minx = l2.getX();
                    Location miny = l2.getY();
                    Location minz = l2.getZ();

                    if(l1.getX() > l2.getX()){
                        //I can't execute this, errors!
                    }
                } catch (InterruptedException ie) {
                }
            }
        }
    };
    t.start(); 
```

它给了我错误，并说将 l1 和 l2 更改为决赛。如果我将 l1 和 l2 更改为决赛，它会给我另一个错误，它说 l1 = etc.，它说要删除决赛。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T22:46:00.430

`l1`并且`l2`是方法的局部变量`onPlayerInteract()`。在此方法中，您创建一个匿名内部类，它使用这些局部变量`l1`和`l2`. 这只有在`l1`并且`l2`是最终的情况下才有可能。但是根据定义，最终变量只能分配一次，然后您分配 null，然后再分配另一个值。因此，您需要复制`l1`和复制`l2`最终变量，并在匿名类中使用这些最终副本：

```
public void onPlayerInteract(PlayerInteractEvent event) {
    final Action action = event.getAction();
    Location l1 = null;
    Location l2 = null;
    if (action == Action.LEFT_CLICK_BLOCK){
        l1 = event.getClickedBlock().getLocation();
    } else if (action == Action.RIGHT_CLICK_BLOCK) {
        l2 = event.getClickedBlock().getLocation();
    }

    final Location l1Final = l1;
    final Location l2Final = l2;

    Thread t = new Thread() {
        @Override
        public void run() {
            while(true) {
                try {
                    Thread.sleep(1000*60*60);
                    Location maxx = l1Final.getX();
                    Location maxy = l1Final.getY();
                    Location maxz = l1Final.getZ();

                    Location minx = l2Final.getX();
                    Location miny = l2Final.getY();
                    Location minz = l2Final.getZ();

                    if(l1Final.getX() > l2Final.getX()){
                        // ...
                    }
                } catch (InterruptedException ie) {
                }
            }
        }
    };
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T22:43:21.410

```
public void onPlayerInteract(PlayerInteractEvent event) {
    final Action action = event.getAction();
    final Location blockLocation = event.getClickedBlock().getLocation();
    final Location l1 = (action == Action.LEFT_CLICK_BLOCK) ? blockLocation : null;
    final Location l2 = (action == Action.RIGHT_CLICK_BLOCK) ? blockLocation : null;

    Thread t = new Thread() {
        ...
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T23:18:44.370

您需要将 final 用于匿名内部类。如您所知，最终参考无法修改。

JB Nizet 的答案是正确的。

但请注意，不是 JB Nizet 代码：

```
Location l1 = null;
Location l2 = null;
if (action == Action.LEFT_CLICK_BLOCK){
    l1 = event.getClickedBlock().getLocation();
} else if (action == Action.RIGHT_CLICK_BLOCK) {
    l2 = event.getClickedBlock().getLocation();
}

final Location l1Final = l1;
final Location l2Final = l2; 
```

您可以使用以下代码

```
final Location l1;
final Location l2;
if (action == Action.LEFT_CLICK_BLOCK){
    l1 = event.getClickedBlock().getLocation();
    l2 = null;
} else if (action == Action.RIGHT_CLICK_BLOCK) {
    l1 = null;
    l2 = event.getClickedBlock().getLocation();
} else {
    l1 = null;
    l2 = null;
} 
```

由于局部变量永远不会被初始化（甚至为 null），编译器通常会告诉您在使用它之前对其进行初始化。但是如果你在 if/elseif/else 结构的所有情况下都初始化它，编译器肯定知道你在任何情况下都初始化了它。

无论如何，您的代码似乎没有任何意义，因为在任何情况下， l1 或 l2 都将为空。因此，您的线程将始终抛出 NullPointerException。

* * *

这里解释了为什么必须对匿名内部类使用 final： [为什么我们对匿名内部类使用 final 关键字？](https://stackoverflow.com/questions/7076773/why-do-we-use-final-keyword-with-anonymous-inner-classes)

* * *

另请注意，您不能使用语句 if(l1.getX() > l2.getX()){ 因为 getX() 和 getY() 返回 Location 并且无法使用 > 运算符进行比较。您应该考虑在 Location 类上使用 Comparable 然后执行 if ( l1.getX().compareTo(l2.getX()) > 0 ) { ... }

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T22:50:23.420

run 中的代码实际上是它自己的方法。您可以将其设为单独的可运行方法，并在实例化时将 y1 和 y2 传递给它，或者在运行中声明 y1 和 y2。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-25T23:06:35.793

解决方案如@JB Nizet 所述，但如果变量具有设置方法，则无需复制变量。然后，您的代码将如下所示（还修复了 @ 解释的空指针：

```
public void onPlayerInteract(PlayerInteractEvent event) {
final Action action = event.getAction();
final Location l1 = new Location(); // Assumming Location has a default constructor.
final Location l2 = new Location();
if (action == Action.LEFT_CLICK_BLOCK){
    l1.setX(event.getClickedBlock().getLocation().getX());
    l1.setY(event.getClickedBlock().getLocation().getY());
} else if (action == Action.RIGHT_CLICK_BLOCK) {
    l2.setX(event.getClickedBlock().getLocation().getX());
    l2.setY(event.getClickedBlock().getLocation().getY());
}

Thread t = new Thread() {
    @Override
    public void run() {
        while(true) {
            try {
                Thread.sleep(1000*60*60);
                Location maxx = l1Final.getX();
                Location maxy = l1Final.getY();
                Location maxz = l1Final.getZ();

                Location minx = l2Final.getX();
                Location miny = l2Final.getY();
                Location minz = l2Final.getZ();

                if(l1.getX() > l2.getX()){
                    // ...
                }
            } catch (InterruptedException ie) {
            }
        }
    }
};
... 
```

}

@Kkkev asnwer 也应该可以正常工作，但要注意空指针。

# java - Windows 7 上 0MQ/ZeroMQ 和 Java 的明确防呆步骤？

> ID：10762093
> 
> 赞同：3
> 
> 时间：2012-05-25T22:36:33.890
> 
> 标签：java, windows, 64-bit, zeromq

我一直在尝试在带有 Java 的 Windows 开发环境中使用 0MQ，但我遇到了非常困难的经历。似乎 PATH 不一致存在许多问题，并且 Visual Studio 命令提示符使用的 Java 版本与我运行应用程序的命令提示符不同。不一致并不止于此，我觉得我没有正确处理这个问题。

因此，是否有人在 Windows 7 64 位上成功使用了 ZeroMQ，而不是尝试修补此过程，以及您使用了哪些步骤和软件堆栈，以便可以在本地运行 Java 应用程序？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T11:29:50.713

我在 Win7/64bit 上使用了 zmq 和 F#；让它在那里工作很容易。

至于 Java 方面，我找到了这个文档：[http](http://www.zeromq.org/bindings:java) ://www.zeromq.org/bindings:java 和 [https://github.com/zeromq/jzmq](https://github.com/zeromq/jzmq)这是官方绑定。

# python - 我可以使用返回布尔值的方法作为 Python 中 if 语句的条件吗？

> ID：10762095
> 
> 赞同：-3
> 
> 时间：2012-05-25T22:36:56.090
> 
> 标签：python, if-statement, boolean

```
class my_class
    def is_same(self, arg1, arg2):
        return arg1 == arg2

    def a_function(self):
        if is_same('a', 'b'):
            print "They're the same" 
```

Eclipse 告诉我 is_same 是一个未定义的变量。我认为你可以在 Java 中做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:38:49.147

`is_mode`在发布的代码中没有任何地方，但是，还有另一个问题，语法错误。

代替原来的

```
print 'They're the same' 
```

采用：

```
print "They're the same" 
```

您可以使用 " " 或 ' ' 将字符串括起来，这里您在同一个字符串中使用其中的 3 个。如果您使用 "" 包围您的字符串，则无需转义 '。

更新：拥有没有什么错

```
return arg1 == arg2 
```

在您的函数中，它将按照您的预期返回一个布尔值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T23:04:37.480

我需要说`self.is_same()`，因为这些函数在一个类中。来自你不需要说的Java `this.method()`，我很困惑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T22:39:32.923

最有可能 pydev （我猜你正在使用）再次成为一个鸡巴。它有时不会立即重新读取所有内容，然后要么在源已完成的地方继续显示警告，要么显示警告，因为它不知道（尚）某人已被定义。保存文件通常会有所帮助。至少如果它不忙于“重建”项目。

除了引用错误之外，您的代码非常好并且可以按预期工作。

```
>>> def is_same(arg1, arg2):
...     return arg1 == arg2
...
>>> def a_function():
...     if is_same('a', 'b'):
...         print "They're the same"
...
>>> a_function()
>>> 
```

但是，如果你真的需要一个函数`is_same`，你不会这样写，而是导入它：

```
from operator import eq as is_same 
```

# javascript - 使用 iframe 的跨域 localStorage (Chrome)

> ID：10762096
> 
> 赞同：6
> 
> 时间：2012-05-25T22:37:21.090
> 
> 标签：javascript, google-chrome, iframe, local-storage

我正在尝试使用 iframe 将值存储在另一个域上（实际上，我使用的是[http://xauth.org/info/](http://xauth.org/info/)上的 xauth 库）。但是，当我尝试使用 Chrome 存储任何内容时，它会返回“QUOTA_EXCEEDED_ERR: DOM Exception 22”，我认为这是访问错误。我在下面模拟了几个非常简单的页面来复制效果：

文件 1.html：

```
<html>
<head/>
<iframe src='http://127.0.0.1/2.html' />
</html> 
```

文件 2.html：

```
<html>
<head/>
<script>
console.log(localStorage);
localStorage.setItem('test', '123');
</script>
</html> 
```

如果我将这两个都放在我的本地服务器上并访问 localhost/1.html 它会嵌入一个来自 127.0.0.1 的框架（Chrome 认为它是一个单独的域），我会得到与上面相同的访问错误。猜测一下，即使我从另一个域嵌入了 iframe，并且 iframe 中的脚本正确引用了该域的 localStorage（正如我在 console.log(localStorage) 行中看到的那样），权限用于写入 localStorage 的内容来自首页的域。

简而言之，看起来没有 iframe 可以写入 Chrome 中的 localStorage。有谁知道是否有办法绕过这个特定的安全“功能”？还是我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-05-21T13:10:04.437

仅当禁用第三方 cookie 时才会出现此问题。较新版本的 Firefox 和 Opera 也阻止了它。在 IE 和 Edge 中，尽管禁用了第三方 cookie，但它仍然是可能的。如果 localStorage 不会在 iframe 中被阻止，则网络跟踪器可以简单地包含 iframe，读取 cookie，将其发送到父脚本，然后将其发送到服务器。

这在 IE 和 Edge 中没有被阻止的原因是这些浏览器允许网站将之前设置为第一方 cookie 的第三方 cookie 发送到服务器，尽管第三方 cookie 被阻止了。例如，如果用户定期访问 facebook，他会从 facebook 获取第一方 cookie。然后当他使用 facebook 的分享按钮访问其他网站时，尽管第三方 cookie 被禁用，但 facebook 可以跟踪他。我真的不知道为什么 IE 和 Edge 不阻止第三方 cookie 发送，但无论如何我都不会使用这些浏览器。

禁用第三方 cookie 时浏览器显示的错误：

铬和歌剧：`Uncaught DOMException: Failed to read the 'localStorage' property from 'Window': Access is denied for this document.`

火狐：`SecurityError: The operation is insecure.`

IE 和 Edge：没有错误，尽管禁用了第三方 cookie，但可以访问 iframe 中的 localStorage。

因此，总而言之，无法绕过此安全功能（在 Chrome、Firefox、Opera 中），这有助于确保用户的隐私。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T23:08:02.097

好吧，`localStorage`它是基于域的，您的示例代码没有理由失败。它实际上所做的是将 127.0.0.1 的`test`项目设置为**123**，而它将 localhost`localStorage`留空。

这可能不是您最初 QUOTA_EXCEEDED_ERR 问题的答案，但只需尝试切换到 Chrome 上的隐私浏览 (Ctrl+Shift+N) 以查看是否仍有错误。如果没有关于你最初在做什么的更多信息，我不能说太多，但我相信超过配额意味着它意味着什么......

而且我认为 Chrome 的配额是 2.5mb，而 FF 的 localStorage 配额是 5mb。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-07T14:23:19.823

这是一个旧帖子，但如果其他人看到它 - 您可以使用 postMessage

[https://stackoverflow.com/a/40469196/4836581](https://stackoverflow.com/a/40469196/4836581)

# c# - 与自定义 ASP.NET MembershipProviders 有什么关系？

> ID：10762099
> 
> 赞同：2
> 
> 时间：2012-05-25T22:38:21.253
> 
> 标签：c#, asp.net, asp.net-mvc, membership-provider

我希望有人可以帮助我了解当我尝试实现自定义 MembershipProvider 时发生的事情。这可能更像是一个理论问题而不是代码问题......这就是我所拥有的：

*   MVC 2 应用程序（从一个空的 MVC 2 项目开始）
*   带有我自己的“用户”表的 SQL Server DB
*   一个用户类，UserRepository，UserService，等等等等

目前，我的应用程序通过 UserRepository 进行身份验证，如果成功则返回一个 User 对象。然后，此用户对象存储在会话中，随后被所有需要身份验证的控制器操作询问。

现在...我知道将它存储在会话中会使我容易受到会话劫持，并且更安全的方法是实现我自己的 MembershipProvider。我不明白的是，这个自定义 Provider 最终会在哪里存储我的 User 对象？我看到被覆盖的 ValidateUser() 方法只返回一个布尔值，但我无法弄清楚该用户在网站上的时间该信息在何处保留。

我真的很想保留我现有的流程，同时通过消除对用户身份验证会话的依赖来使其更加安全。一旦用户登录，我喜欢在整个应用程序中拥有一个完整的用户对象，但我愿意接受其他建议。似乎很多 MembershipProvider 文档有点像黑匣子。我希望有人可以解释它实际上在做什么来坚持用户身份验证。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:44:55.390

看看微软是如何发布源代码的

[提供者来源](http://weblogs.asp.net/scottgu/archive/2006/04/13/Source-Code-for-the-Built_2D00_in-ASP.NET-2.0-Providers-Now-Available-for-Download.aspx)

还要记住，.Net 中没有黑匣子，您可以使用[Just Decomile](http://www.telerik.com/products/decompiler.aspx)或[反射器](http://www.reflector.net/)来了解更多关于其他人（Microsoft）如何完成您想做的相同事情的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T00:38:36.997

验证用户后，ASP.Net Membership 会创建一个令牌（一个大的加密字符串），该令牌存储为 cookie 或 URL 字符串的一部分，具体取决于您在配置中的配置方式。它可以根据 cookie 是否可用来选择执行任一操作。令牌用于保持用户的身份，以回答您关于它如何在低级别工作的主要问题。根据自定义提供程序的实现方式，从服务器检索所有其他相关联的内容（角色、配置文件等）。

这不一定比会话更安全 - 如果站点不受 SSL 加密保护，它具有相同的 URL 或 cookie 重放漏洞（如果用户通过电子邮件将 URL 发送给其他人，则 URL 更糟）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T01:23:26.927

除了所有答案之外，我相信您的帖子中*缺少的链接*是 ASP.Net Forms Authentication - 这实际上是在 ASP.Net Web 应用程序中**使用**ASP.Net Membership 的原因。

因此，如果您拥有自己的 db 和 auth 方案（已经），您可以使用 Forms Authentication - 即使**不**尝试使其与 Membership 一起使用（您真的不必这样做）。

这是（很快成为我最常用的链接）一个[过于简单的 MSDN 表单身份验证示例，](http://msdn.microsoft.com/en-us/library/xdt4thhy.aspx)其方案是硬编码的。它向您展示了您甚至可以这样做 - 当然不是您应该这样做，而只是向您展示了可能性。

正如上面所有答案所述，如果需要，您可以构建自己的提供程序。（到目前为止）我走的最远的不是构建一个，而是自定义一些方法。原因：我有一个项目的现有用户数据库正在使用 MD5。这意味着我只是覆盖了 2 种方法（如果没有记错的话） -`ValidateUser()`和`CreateUser()`....

Hth

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T22:58:49.413

这是一个关于实现您自己的自定义 MembershipProvider 的优秀教程。

[http://www.codeproject.com/Articles/165159/Custom-Membership-Providers](http://www.codeproject.com/Articles/165159/Custom-Membership-Providers)

话虽如此，你真的需要阅读这篇文章。阅读文章并按照步骤操作后，您将开始了解问题的答案。除了经历像这样的教程的苦差事之外，真的没有很好的方法来理解它。至少，这是我的看法。通过阅读本教程，我第一次实现了我自己的自定义会员提供程序。几个小时后，我开始实现自己的加密算法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-26T03:48:58.410

我强烈建议使用标准的成员资格提供程序，但创建一个链接表以将您现有的用户存储库加入到 asp 网络成员资格提供程序。两全其美。

# php - 远程 MySQL 连接问题 - 与 MySQL 服务器的连接丢失 (110)

> ID：10762101
> 
> 赞同：2
> 
> 时间：2012-05-25T22:38:35.980
> 
> 标签：php, mysql

我正在尝试从服务器 Y 上的 php 脚本访问服务器 X 上的 MySQL 数据库。两者都是我具有 root 访问权限的专用 cPanel 服务器。这是我尝试过的：

1.  在服务器 XI 上，将服务器 Y 的 IP 地址放入 WHM 的“附加 MySQL 访问主机”功能中。
2.  在服务器 XI 上，为托管我尝试连接的数据库的帐户登录 cPanel，并在“远程数据库访问主机”页面上输入服务器 Y 的 IP。
3.  在服务器 XI 上，防火墙中的服务器 Y 的 IP 被列入白名单，并打开了传入/传出端口 3306 TCP。
4.  在服务器 XI 上，将服务器 Y 的 IP 地址添加到 /etc/hosts.allow 文件中

尽管我尝试了所有这些事情，但每当我尝试在服务器 Y 上运行脚本时，我都会收到超时消息：

```
Warning: mysql_connect() [function.mysql-connect]: Lost connection to MySQL server at 'reading initial communication packet', system error: 110 
```

这是我的 PHP 代码：

```
$host = '123.456.789.0'; //server X's IP
$db = 'user_test';
$user = 'user_test';
$pass = 'password';

if(mysql_connect($host, $user, $pass)){
    mysql_select_db($db);
}
else die(mysql_error()); 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:50:45.980

不确定它会有多大帮助，但请尝试打开 my.cnf 并将绑定地址设置（127.0.0.1 或 localhost）替换为您的实时服务器 ip。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T23:00:10.667

Have you contacted your hosting provider to see if they can help?

Is there a firewall on the linux machine you're connecting to?

Did you test your my.cnf file with 127.0.0.1 and localhost?

What version of MySQL are you running on both machines? Can you upgrade them?

# ruby-on-rails - 在解析和间隔日期/fixnum 对象时遇到问题

> ID：10762106
> 
> 赞同：1
> 
> 时间：2012-05-25T22:39:04.090
> 
> 标签：ruby-on-rails, ruby, loops

我正在构建一个小型应用程序，它将输入的内容输入到输入字段中，并在输入时直接显示在该输入字段的下方。

我使用此代码的目标是按日期分隔这些条目，以便在 6 月 1 日发布的所有内容之间都有一个换行符，并且 6 月 2 日的第一个条目与 6 月 1 日的条目之间有 2 个空格。

这是我的代码，它没有按计划运行，但我不知道为什么，我认为它源于第 3 行，而且我做错了。（注意：我知道这还没有考虑到月份或年份的变化。一旦我确定了正确的日期间距，我就会解决这个问题）

```
<% for i in (0..(@allLessons.count-1)) %>

<b><%= @date[i].created_at.strftime('%b %d')%></b><br/>

<% if @date[i].created_at.strftime('%d') == @date[i-1].created_at.strftime('%d') %>

<%= @date[i].created_at.strftime('%d') %> <br />

<% else %>

<%= @date[i].created_at.strftime('%d') %><br /><br />

<% end %>           
<% end %> 
```

从控制器：

```
@allLessons = Lesson.all
@date = Lesson.find(:all, :order => 'created_at ASC') 
```

您可以为此提供的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:43:57.047

块和迭代器是它所在的地方。

```
@allLessons = Lesson.order('created_at ASC')
@dates = @allLessons.group_by { |lesson| lesson.created_at.beginning_of_day }.sort

<% @dates.each do |date, lessons| %>
  <% lessons.each do |lesson| %>
    <b><%= lesson.created_at.strftime("%d") %></b><br />
  <% end %>
  <br />
<% end %> 
```

**带注释的**

首先，我们将所有课程放在一起。这相当于 find(:all, :order => 'created_at ASC')，但我喜欢这种更新、紧凑的语法

```
@allLessons = Lesson.order('created_at ASC') 
```

然后我们将它们全部组合成一个散列，其中键是日期，值是当天创建的记录数组。`beginning_of_day`将 a 转换`DateTime`为 a `Date`，其中时间设置为`00:00:00`。所以，`2012-05-25 18:00`变成`2012-05-25 00:00:00`。这样我们就可以自己对日期进行分组，而不会妨碍时间

```
@dates = @allLessons.group_by { |lesson| lesson.created_at.beginning_of_day }.sort 
```

`@dates`现在是一个哈希，其中键是日期，值是该日期的课程数组。例如，`{ '2012-05-24 00:00:00' => [ lesson_1 ], 2012-05-25 00:00:00' => [ lesson_2, lesson_3 ]`

然后我们将哈希传递到一个块中，其中键是日期，值是课程数组。这就是说，对于每个日期...

```
<% @dates.each do |date, lessons| %> 
```

给我属于那个日期的课程。而对于每一个...

```
 <% lessons.each do |lesson| %> 
```

打印上课日期

```
 <b><%= lesson.created_at.strftime("%d") %></b><br />
  <% end %> 
```

在继续下一个日期之前，打印一个`<br />`

```
 <br />
<% end %> 
```

# php - 每次访问加载的启动画面

> ID：10762110
> 
> 赞同：0
> 
> 时间：2012-05-25T22:39:27.517
> 
> 标签：php, javascript, html, splash-screen

我已经建立了一个网页，`splashcreen.html`当有人加载时`index.php`会自动转到。但我还希望有一个按钮，返回 index.php，允许用户返回主页。但是如果这个人关闭浏览器，整个过程就会重新开始。

就这样：

1.  打开浏览器，`index.php`
2.  重定向到`splashcreen.html`
3.  用户点击按钮，返回`index.php`
4.  无重定向导航
5.  用户关闭浏览器
6.  重新打开并重新开始整个过程​​。

这可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T22:43:01.920

保存 cookie，或发送 GET 值：

`<a href="index.php?spash=0">Go Home!</a>`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T22:45:33.233

你可以把你的`index.php`作为启动画面。然后用户单击按钮，重定向到`home.php`“真实”主页。

然后不是 Home 链接指向根（这意味着，因此是启动屏幕），而是`index.php`让它们指向。`home.php`

所以：

1.  用户打开`yoursite.com`并遇到您的启动画面
2.  用户单击按钮转到`home.php`
3.  用户正常导航
4.  一旦用户关闭并重新打开浏览器进行访问`yoursite.com`，好吧..再次启动屏幕！

如果以后您厌倦了启动画面并打算不再使用它，您可以使用简单的 .htaccess 规则将 index.php 请求重定向到 home.php

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T22:43:56.107

是的，只需在单击按钮时使用 JavaScript 设置一个 cookie ，并且如果设置了 cookie，则不`splashscreen.html`重定向 php（或 JS，无论重定向） 。`index.php`这很容易，只需在谷歌上搜索即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T22:48:18.207

你实际上并不需要重定向到 splash.html 你可以使用一个会话来存储它是否被看到或者只是继续做你的 index.php

索引.php

```
<?php 
session_start();

if(!isset($_SESSION['splash'])){
    //Show splash screen
    ob_start();
    include('./splash.html');
    $contents = ob_get_contents();
    ob_end_clean();

    echo $contents;
    $_SESSION['splash']=true;
    die;
}

//Do normal index.php
?> 
```

# ruby-on-rails - 为什么我的字符串在使用 .to_i 而不是整数时转换为 Fixnum？

> ID：10762118
> 
> 赞同：1
> 
> 时间：2012-05-25T22:40:36.477
> 
> 标签：ruby-on-rails, ruby

我正在运行这条线：

`<%= @date[i].created_at.strftime('%d').to_i.class %>`

并且输出是一个fixnum而不是一个int。为什么是这样？

从控制器：

`@date = Lesson.find(:all, :order => 'created_at ASC')`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T22:44:32.717

Ruby 中没有这样的东西`int`。是适合机器词`Fixnum`的小数类`1`，它是 的子类。检查以下内容：`2``Integer`

```
irb(main):004:0> 42.class
=> Fixnum
irb(main):005:0> 42.is_a? Fixnum
=> true
irb(main):006:0> 42.is_a? Integer
=> true
irb(main):007:0> 42.is_a? Numeric
=> true
irb(main):008:0> 42.is_a? Object
=> true 
```

所以你的值同时是 a `Fixnum`, an `Integer`, a`Numeric`和 an `Object`;) 这种效果称为[多态性](http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming)，在这种情况下它可能会让你感到惊讶，因为在其他一些编程语言中，数字以一种特殊的方式处理（它们有某种“本机”类型）。在 Ruby 中，数字只是对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T22:44:25.497

> Fixnum 包含可以用本机机器字（减 1 位）表示的整数值。如果对 Fixnum 的任何操作超出此范围，则该值将自动转换为 Bignum。

`Fixnum`实际上，是 的子类`Integer`。

见[http://www.ruby-doc.org/core-1.9.3/Integer.html](http://www.ruby-doc.org/core-1.9.3/Integer.html)

# mysql - mysql服务器详细日志

> ID：10762120
> 
> 赞同：2
> 
> 时间：2012-05-25T22:40:38.553
> 
> 标签：mysql, ubuntu

我从 syslog 获得了关于 mysql 的那些日志，但是它们太简短了，因为他们没有告诉我（或者至少我认为）是什么导致 mysql 以状态 1 终止。有人可以帮我获取更详细的日志吗？

最好的，元

5 月 25 日 18:32:21 巴纳德内核：[1587749.902491] type=1400 审计（1337985141.215:263）：apparmor="STATUS" operation="profile_replace" name="/usr/sbin/mysqld" pid=22272 comm="apparmor_parser “
5 月 25 日 18:32:21 巴纳德内核：[1587750.181772] 初始化：mysql 主进程 (22276) 以状态 1
5 月 25 日 18:32:21 终止巴纳德内核：[1587750.181819] 初始化：mysql 主进程结束，
18 年 5 月 25 日重生：32:22 巴纳德内核：[1587750.939171] 初始化：mysql 启动后进程（22277）以状态 1
5 月 25 日 18:32:22 终止巴纳德内核：[1587750.951160] 类型 = 1400 审计（1337985142.263:264）：apparmor="状态"操作="profile_replace"名称="/usr/sbin/mysqld" pid=22310 comm="apparmor_parser"
5 月 25 日 18:32:22 巴纳德内核：[1587751.226853] 初始化：mysql 主进程（22314）以状态 1 终止
5 月 25 日 18:32:22 巴纳德内核：[1587751.226899] 初始化：mysql 主进程结束，
5 月 25 日 18 日重生： 32:23 巴纳德内核：[1587751.996106] 初始化：mysql 启动后进程（22315）以状态 1
5 月 25 日 18:32:23 终止巴纳德内核：[1587752.008270] 类型 = 1400 审计（1337985143.323:265）：apparmor="STATUS " operation="profile_replace" name="/usr/sbin/mysqld" pid=22348 comm="apparmor_parser"
May 25 18:32:23 barnard kernel: [1587752.246873] init: mysql 主进程 (22352) 以 5 月 1
日的状态终止25 18:32:23 巴纳德内核：[1587752.246919] 初始化：mysql 重生太快，已停止

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T14:54:50.090

这里有同样的问题。从 5.1 开始，mysql 5.5 的 Ubuntu 安装/升级/配置设置中存在一些错误。其他人声称通过以下步骤取得了成功，但没有一个对我有用。第一步将删除 apparmor（一种安全服务），因此只能在调试期间临时执行此操作：

```
sudo service apparmor teardown 
```

将以下行添加到您的 /etc/mysql/my.cnf 的 [server] 部分下：

```
character_set_server  = utf8
collation_server      = utf8_general_ci
innodb_buffer_pool_size = 256M 
```

但是，就像我说的，这只适用于其他人，而不是我。

我正在使用带有 HD 符号链接的 SSD（安装在 SSD 上）运行 mysql ，`/`您是否有类似的混合驱动器配置？也许这导致了我们问题的“重生太快”部分。`/var``/tmp`

# powershell - 重命名文件中每个文件名的前 20 个字符

> ID：10762123
> 
> 赞同：4
> 
> 时间：2012-05-25T22:40:53.797
> 
> 标签：powershell, windows-7

我正在尝试在 powershell 中编写一个脚本来删除文件夹中每个 MP3 文件名的前 20 个字符，我创建了一个文件“test.ps”并将下面的 powershell 代码插入其中，

```
gci *.mp3 | rename-item -newname { [string]($_.name).substring(20) } 
```

当我在 powershell.exe 中运行此文件时，没有任何反应，

任何人都可以帮忙吗？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T23:43:05.470

这可能会让你开始。（可能有更简洁的方法，但是当您以后需要维护它时，这是可行的并且是可读的。:-)）

我创建了一个文件夹`C:\TempFiles`，并在该文件夹中创建了以下文件：

```
TestFile1.txt
TestFile2.txt
TestFile3.txt
TestFile4.txt 
```

（恐怕我是用老式的方式创建它们的。<g>。我用过

```
for /l %i in (1,1,4) do echo "Testing" > TestFile%i.txt 
```

从实际的命令提示符。）

然后我从开始菜单打开`PowerShell ISE`，运行这个脚本。它创建一个数组 ( `$files`)，只包含文件的名称，并处理每个文件：

```
cd \TempFiles
$files = gci -name *.txt
foreach ($file in $files) {
  $thename = $file.substring(4);
  rename-item -path c:\TempFiles\$file -newname $thename
} 
```

这留下了包含以下内容的文件夹：

```
File1.Txt
File2.Txt
File3.Txt
File4.Txt
File5.Txt 
```

为了从命令行运行脚本，您需要更改一些默认的 Windows 安全设置。您可以通过使用`PowerShell ISE`的帮助文件（从菜单中）并搜索或从提示中`about_scripts`执行来了解它们。请参阅帮助文件中的小节（它更容易阅读）。`help about_scripts``ISE``How To Run A Script`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T23:48:11.250

您的代码确实有效。两件事情...

1.  将文件重命名为`test.ps1`.
2.  在您保存 MP3 文件的文件夹中运行它。由于您没有提供路径，`Get-ChildItem`它将在当前目录中运行。

我通过制作一堆这样的 mp3 文件来测试你的产品线 -

```
1..30 | % { new-item -itemtype file -Name (
    $_.ToString().PadLeft(30, 'A') + ".mp3" )} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T08:48:35.257

我会使用更“更安全”的方式（如果文件名短于所讨论的长度，则会出现错误，您还将文件扩展名作为总字符的一部分）。检查每个文件的基本名称是否大于 21 个字符（如果删除前 20 个字符，名称仍然可以是一个字符长）。如果删除前 20 个后目录包含同名文件，则可能会失败，您可以自行进一步开发）：

```
gci *.mp3 | foreach{

    if($_.BaseName.Length -ge 21)
    {
        $ext = $_.Extension
        $BaseName = $_.BaseName.Substring(20)
        Rename-Item $_ -NewName "$BaseName$ext"
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-19T12:20:21.067

// 删除（替换为空字符）所有以“dbo”开头的文件名中的前 20 个字符。// 电源外壳

```
Get-ChildItem C:\my_dir\dbo -Recurse -Force -Filter dbo.* | Where-Object {!$_.PSIsContainer} | Rename-Item -NewName { ($_.name).Substring(20) } 
```

# jquery - 多个唯一的点击事件

> ID：10762128
> 
> 赞同：2
> 
> 时间：2012-05-25T22:41:47.087
> 
> 标签：jquery, image, resize, counter

我真的不知道如何表达这个问题——即使是标题也可能有点误导。

**场景：** 当单击具有特定类的元素时，我正在使用 jquery 创建一个函数。

单击元素时，它会在参数传递的元素中查找图像，并使用 animate() 调整（增加）图像的大小。

这是我一起破解的代码：

```
 var counter = 2;
          $(".bigger").click(function(event,ui) {
                var objid       = $(this).attr("rel"); 
                var mainid      = $(this).attr("id"); 
                var imageid = "#"+objid+""; 
                $(imageid).find('img').animate({ height:objheight * counter,width: objwidth * counter}).css({ height: objheight * counter, width: objwidth * counter });                
                    counter++;

            }); 
```

objheight 和 objwidth 是图像的尺寸。

HTML

```
<li class="ui-widget-content" id="obj1">
<img src="elements/pic1.png" id="obj_1" class="ui-widget-content"  width="96" height="72" />
<div class="tools"><a class="ui-icon sizeup" rel="obj1"  id="obj_1"  href=""><span></span></a> 
```

问题：由于每当点击发生时计数器都会增加，当我有多个图像时，我想调整大小而不是从 var counter = 2; 它只是从增量中拾起..这是可以理解的，但是，我怎样才能阻止这种情况发生？每个元素都有一个独特的计数器？我怎样才能创造它？

一如既往地感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:45:11.937

您可以使用 jQuery[数据 API](http://api.jquery.com/jQuery.data/)来存储 DOM 元素的元数据。

例如：

```
$(".bigger").click(function(event,ui) {
  var objid       = $(this).attr("rel"); 
  var mainid      = $(this).attr("id"); 
  var imageid = "#"+objid; 
  var image = $(imageid).find('img');
  var counter = (image.data('counter') || 1) + 1;
  image.data('counter', counter);
  image.animate({ height: objheight * counter,width: objwidth * counter});
  $('#result').html(image.data('counter'));
});​ 
```

[您可以在我刚刚为测试制作](http://jsfiddle.net/7EXRd/2/)的 jsFiddle 上检查这项工作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-26T00:42:58.073

您的代码中有一个错误，使用相同的 ID img 和具有 id="obj_1" 是非法的...您可以将其替换为 data-id。我使用了先前的答案，以表明您可以直接在 html 代码中使用数据设置来预定义数据。

[http://jsfiddle.net/SqarV/](http://jsfiddle.net/SqarV/)

# uiwebview - CoreAnimation 调整大小倾斜 UIWebView

> ID：10762132
> 
> 赞同：0
> 
> 时间：2012-05-25T22:42:53.653
> 
> 标签：uiwebview, resize, core-animation, scale

免责声明：我不是 Objective C 程序员，而是与这样一个研究项目合作和管理，因此我的问题可能有点幼稚。但是，在与各种专家进行多次讨论后，我确信这个问题是相关的，所以我求助于你，因为我非常感谢你的意见。

我们需要在核心动画级别调整 UIWebView 的大小。这是一个既定的事实，无法改变，我们不需要在这里讨论。仅仅简单地调整 UIWebView 本身的大小对于这个应用程序来说是不可能的。这是症结所在：

我们加载某个几何图形的 UIWebView，比如说 256 x 256 像素，然后我们使用 Core Animation 调整它的大小。假设新的目标大小为 1024 x 512 像素。我们设法轻松地使 UIWebView 很好地适应新的 512 宽空间。然而，问题在于它保持了原来的比例，因此新的 UIWebView 现在只覆盖了目标区域的一半，即 512 x 512 像素。这并不意外，然而，我们需要 UIWebView 在这样的变换之后显示更多的内容，即变得更长，以填充空间。我们很困，因为我们真的没有其他选择。一旦你开始思考这个问题并尝试各种场景，你会发现这不是微不足道的。如果您对我们如何解决/解决此问题有任何想法，那就太好了！

让我知道 - 一切顺利，

迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T03:11:58.530

Try `[webView.scrollView setZoomScale:1f]` after resizing.

# android - 在android中更改传感器坐标系

> ID：10762133
> 
> 赞同：0
> 
> 时间：2012-05-25T22:42:54.723
> 
> 标签：android, sensors, android-sensors, coordinate-systems

Android 以设备坐标系提供传感器数据，无论其方向如何。有什么方法可以在“重力”坐标系中获取传感器数据？我的意思是无论设备的方向如何，我都需要加速度计数据和坐标系中的方向，其中 y 轴指向天空，x 轴指向东方，z 轴指向南极。

我看了看，`remapCoordinateSystem`但似乎仅限于交换轴。我想对于方向，我将不得不做一些低级的旋转矩阵变换（或者有没有更好的解决方案？）。但是加速度数据呢？有没有办法获得与固定坐标系（某种世界坐标系）相关的数据。

我需要这个的原因是我试图在手机放在口袋里时做一些简单的动作手势，而且我更容易将所有数据放在与用户相关的坐标系而不是设备坐标系中（这会有一点点不同用户口袋的不同方向）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T07:53:03.190

好吧，您基本上在开始时会获得北方向 - 为此，您使用加速度计和磁场传感器来计算方向（或不推荐使用的方向传感器）。

拥有它后，您可以从这些方位角、俯仰角和滚动角计算旋转矩阵（方向余弦矩阵）。将您的加速度矢量乘以该矩阵会将您的设备框架运动转换为地球框架运动。

由于您的设备会随着时间的推移而改变其方向，因此您需要对其进行更新。为此，请检索陀螺仪的数据并为每个新值更新您的方向余弦矩阵。您也可以像第一次一样获得方向真实值，但它不太准确。

我的解决方案涉及 DCM，但您也可以使用四元数，这只是一个选择问题。如果需要，请随时询问更多信息。我希望这是你想知道的！

# assembly - ARM 汇编中的“Hello world”

> ID：10762139
> 
> 赞同：4
> 
> 时间：2012-05-25T22:43:43.670
> 
> 标签：assembly, arm

这是我在 ASM 中的简单“Hello world”程序：

```
.global _start
    _start:         
        adr r1, hello
        b test
    loop:   ldr r12, =0x16000000
        str r0, [r12]

    test:   ldrb r0, [r1], #1
        cmp r0,#0
        bne loop
        @b loop
hello: .asciz "Hello world.\n\r" 
```

注释掉之后`b loop`，我希望它只打印出一个“Hello world”。但实际上它并没有停止，就像命令`b loop`仍然存在一样。为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T06:09:43.137

bne 是一个条件分支，如果不相等则分支，如果零标志被清除则基本上分支。如果它没有分支，它将继续执行。一旦找到空终止，您就不会分支到循环，而是执行构成“地狱”的字节作为指令。尝试这个：

```
.global _start
    _start:         
        adr r1, hello
        b test
    loop:   ldr r12, =0x16000000
        str r0, [r12]

    test:   ldrb r0, [r1], #1
        cmp r0,#0
        bne loop
    forever: b forever
hello: .asciz "Hello world.\n\r" 
```

给手臂一些在bne之后执行的东西，而不是数据。它应该遍历数据字符串一次然后陷入无限循环。

# antlr - 添加 (...) {...} 函数字面量，同时避免回溯

> ID：10762153
> 
> 赞同：1
> 
> 时间：2012-05-25T22:44:44.463
> 
> 标签：antlr

[基于如何在没有回溯的情况下同时具有函数调用和括号分组中](https://stackoverflow.com/questions/10712068/how-to-have-both-function-calls-and-parenthetical-grouping-without-backtrack/10726048#comment13989309_10726048)找到的答案，我想添加非 LL(*) 表示的函数文字，如

```
...

tokens {
 ...
 FN;
 ID_LIST;
}

stmt
 : expr SEMI // SEMI=';'
 ;

callable
 : ...
 | fn
 ;

fn
 : OPAREN opt_id_list CPAREN compound_stmt
   -> ^(FN opt_id_list compound_stmt)
 ;

compound_stmt
 : OBRACE stmt* CBRACE

opt_id_list
 : (ID (COMMA ID)*)? -> ^(ID_LIST ID*)
 ; 
```

* * *

我想做的是允许匿名函数文字有一个参数列表（例如`()`or `(a)`or `(a, b, c)`）后跟一个`compound_stmt`. 所以`(a, b, c){...}`很好。但`(x)(y){}`不是那么多。（当然`(x) * (y){}`就解析器而言是“有效的”，就像`((y){})()[1].x`会一样。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T08:46:26.087

解析器需要一些额外的展望。我想它可以在没有它的情况下完成，但它肯定会导致一些看起来很糟糕的解析器规则，这些规则很难维护*，并且*解析器会接受`(a, 2, 3){...}`（一个带有表达式列表而不是 id 列表的函数文字）， 例如。这将导致您在创建 AST 后进行大量语义检查。

（IMO）解决此问题的最佳方法是在中添加*函数文字*规则`callable`并在其前面添加句法谓词，这将告诉解析器在实际匹配之前确保*确实存在这样的替代方案。*

```
callable
 : (fn_literal)=> fn_literal
 | OPAREN expr CPAREN -> expr
 | ID
 ; 
```

一个演示：

```
grammar T;

options {
  output=AST;
}

tokens {
 // literal tokens
 EQ     = '==' ;
 GT     = '>' ;
 LT     = '<' ;
 GTE    = '>=' ;
 LTE    = '<=' ;
 LAND   = '&&' ;
 LOR    = '||' ;
 PLUS   = '+' ;
 MINUS  = '-' ;
 TIMES  = '*' ;
 DIVIDE = '/' ;
 OPAREN = '(' ;
 CPAREN = ')' ;
 OBRACK = '[' ;
 CBRACK = ']' ;
 DOT    = '.' ;
 COMMA  = ',' ;
 OBRACE = '{' ;
 CBRACE = '}' ;
 SEMI   = ';' ;

 // imaginary tokens
 CALL;
 INDEX;
 LOOKUP;
 UNARY_MINUS;
 PARAMS;
 FN;
 ID_LIST;
 STATS;
}

prog
 : expr EOF -> expr
 ;

expr
 : boolExpr
 ;

boolExpr
 : relExpr ((LAND | LOR)^ relExpr)?
 ;

relExpr
 : (a=addExpr -> $a) ( (oa=relOp b=addExpr    -> ^($oa $a $b))
                         ( ob=relOp c=addExpr -> ^(LAND ^($oa $a $b) ^($ob $b $c))
                         )?
                     )?
 ;

addExpr
 : mulExpr ((PLUS | MINUS)^ mulExpr)*
 ;

mulExpr
 : unaryExpr ((TIMES | DIVIDE)^ unaryExpr)*
 ;

unaryExpr
 : MINUS atomExpr -> ^(UNARY_MINUS atomExpr)
 | atomExpr
 ;

atomExpr
 : INT
 | call
 ;

call
 : (callable -> callable) ( OPAREN params CPAREN -> ^(CALL $call params)
                          | OBRACK expr CBRACK   -> ^(INDEX $call expr)
                          | DOT ID               -> ^(INDEX $call ID)
                          )*
 ;

callable
 : (fn_literal)=> fn_literal
 | OPAREN expr CPAREN -> expr
 | ID
 ;

fn_literal
 : OPAREN id_list CPAREN compound_stmt -> ^(FN id_list compound_stmt)
 ;

id_list
 : (ID (COMMA ID)*)? -> ^(ID_LIST ID*)
 ;

params
 : (expr (COMMA expr)*)? -> ^(PARAMS expr*)
 ;

compound_stmt
 : OBRACE stmt* CBRACE -> ^(STATS stmt*)
 ;

stmt
 : expr SEMI
 ;

relOp
 : EQ | GT | LT | GTE | LTE
 ;

ID     : 'a'..'z'+ ;
INT    : '0'..'9'+ ;
SPACE  : (' ' | '\t') {skip();}; 
```

由上述语法生成的解析器会`(x)(y){}`在正确解析以下 3 段代码时拒绝输入：

## 1

`(a, b, c){ a+b*c; }`

![在此处输入图像描述](../Images/b25b199ed872b1e6221cd8f583cf450c.png)

## 2

`(x) * (y){ x.y; }`

![在此处输入图像描述](../Images/63e67d8c1e2d2bf73d81db2e4bdfb89b.png)

## 3

`((y){})()[1].x`

![在此处输入图像描述](../Images/143669bcc84f30c878b4c22194fe9e15.png)

# android - Mono for Android：反向地理编码当前位置

> ID：10762154
> 
> 赞同：0
> 
> 时间：2012-05-25T22:44:46.090
> 
> 标签：android, mono, geolocation, xamarin.android, mapactivity

使用`MyLocationOverlay`I 获取用户的当前 GeoPoint。

```
 myLocationOverlay.RunOnFirstFix (() => {
            mapView.Controller.AnimateTo (myLocationOverlay.MyLocation);
            RunOnUiThread (() => {
                DisplayIncidentsNearMe (myLocationOverlay.MyLocation);}
            );
        }
        ); 
```

但是，要 ReverseGeoCode 该位置，我需要 Lat/Lng。MyLocationOverlay 中的 GeoPoint 采用 LatitudeE6 格式，因此不起作用。

如何从返回的位置对象中获取“正常”纬度/经度`MyLocationOverlay`？

```
 Geocoder geo = new Geocoder (this, Java.Util.Locale.Default);
        var ad = geo.GetFromLocation (myLocation.LatitudeE6, myLocation.LongitudeE6, 1); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T12:17:57.047

从[GeoPoint 文档](https://developers.google.com/maps/documentation/android/reference/com/google/android/maps/GeoPoint#getLatitudeE6%28%29)中，LatitudeE6 是：

> 此 GeoPoint 的纬度，以微度（度 * 1E6）为单位。

您可以通过除以 1e6 将此数字转换回度数：

```
double degrees = myLocation.LatitudeE6 / 1e6; 
```

# c++ - BlackBerry Cascades UI 文件选择

> ID：10762158
> 
> 赞同：4
> 
> 时间：2012-05-25T22:45:14.933
> 
> 标签：c++, qml, blackberry-10

我已经建立了一个 BlackBerry Cascades-UI 项目。我正在使用 QML 来定义用户界面的外观。我需要为用户提供一种在触摸屏幕后从设备照片库中选择图像的方法。

有没有人知道如何在触发触摸事件后在屏幕上提供包含画廊中所有图像及其适当名称的列表？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T21:24:01.760

也许有人想知道，即使没有人回答。

目前没有照片库对话框（尽管它已宣布并且可能会在不久的将来在更新中发布）。但是，可以从另一个线程调用本机文件选择对话框。有关这方面的更多信息，请访问 Cascades 的支持论坛并找到一个名为：“在 Cascades 中使用本机文件浏览和文件保存对话框”的主题。

这是一个[链接](http://supportforums.blackberry.com/t5/Cascades-Development/Using-native-filebrowse-and-filesave-dialog-in-Cascades/td-p/1772481)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-18T16:27:43.920

在 beta 3 上，您可以使用[文件选择器](https://developer.blackberry.com/cascades/reference/bb__cascades__pickers__filepicker.html)来选择文件

# php - 当前时间与时间戳+毫秒的时间差

> ID：10762162
> 
> 赞同：0
> 
> 时间：2012-05-25T22:45:34.577
> 
> 标签：php, mysql

我想在 php 页面上显示当前服务器时间和 datetime 行之间的差异加上其中包含毫秒的行，所以我猜这个等式看起来有点像 ((Datetime+Milliseconds)-Server Time) .

唯一的问题是，我不确定如何在代码中做到这一点。我目前可以得到日期时间行和当前时间之间的差异`echo strtotime($row['date_added']) - time();`当我尝试添加包含毫秒的行时`date_mil`，我得到一个非常长的数字。

行中的日期`date_added`看起来像`2012-05-25 16:55:06`，并且 的值`date_mil`是 around `218238`。

我还在学习如何做这一切，这让我很困惑。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:29:05.477

我刚刚解决了我自己的问题。

```
$difference = time() - strtotime($row['date_added']);
$milliseconds = round(($row['date_mil']) * .001);
echo $milliseconds - $difference; 
```

# php - Zend Gdata Spreadsheets 无意义的列名

> ID：10762163
> 
> 赞同：1
> 
> 时间：2012-05-25T22:45:37.567
> 
> 标签：php, zend-framework, gdata

我有一个带有数字列标题的电子表格。当我使用列表提要查看这些列名时，当我期待“1”时，我得到了无意义的字符串，即“_cpzh4”。这使得插入新行变得非常困难。这是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T12:35:21.280

如果没有看到您的代码示例，很难准确地说，但您应该能够使用 getText(); 方法在您的单元格条目上。这将为您提供单元格的文本数据。

所以例子：

```
$listEntry->cell->getText(); 
```

# jquery - 从 php/sql 查询/JSON 查询创建 jquery 变量

> ID：10762166
> 
> 赞同：0
> 
> 时间：2012-05-25T22:45:46.700
> 
> 标签：jquery, sql, arrays, json, variables

我一直在搜索这个很棒的信息网站，但还没有找到我要找的东西，只有零碎的东西。

我对整个 JavaScript 语言/jQuery 库相当陌生，但我开始越来越喜欢它，因为你可以用它做一些事情。

我有一个文件，array.php，它打印出带有某些日期的 json 格式变量，我想在 .datepicker 日历中禁用这些日期。

除了来自 sql 部分的变量之外，我已经完成了整个工作。

这有效：`var $BadDates = new Array("2012-05-28","2012-05-29","2012-05-30");`

我想要的是这样的：

```
$.getJSON('array.php', function(data) {
var $BadDates = [];
} 
```

我的array.php：

```
$query = "SELECT * FROM dates";
$query_result = mysql_query($query) or die(mysql_error());

$results = array();

while($row = mysql_fetch_assoc($query_result)) {

  $n["startdate"] = $row['startdate'];

  array_push($results, $n); 
}
print json_encode($results); 
```

这就是我想要完成的（我知道这一切都错了，只是为了展示我的想法）：

```
$BadDates = new Array("$.getJSON('array.php')"); 
```

一直在检查许多解决方案，但没有任何运气......

我很感激我能得到的所有帮助！

/奥斯卡

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T22:58:46.623

这里不需要使用 AJAX，尽管我会向您展示两种方式：

首先，由于您的 PHP 文件正在打印 JSON 编码的字符串，您可以在 PHP 生成的页面中的必要位置包含它：

```
<?php
    /* Some php */
?>

<!-- some html -->

<script type="text/javascript">
    var badDates = <?php include('array.php'); ?>;
    /* do something with badDates, which is now a JS array */
</script>

<!-- some more html -->

<?php
    /* Some more php */
?> 
```

它会输出类似：[http ://codepad.org/4xHlcwig](http://codepad.org/4xHlcwig)

对于 AJAX 检索的数组，您将：

```
<script type="text/javascript">
    $.ajax({
        url: '/array.php',
        dataType: 'json',
        success: function (data) {
            /* data contains a JS array which was outputted from your file and decoded by jQuery for you */
        }
    });

    /* -OR- your shorthand method */

    $.getJSON('array.php', function(data) {
        /* data contains a JS array which was outputted from your file and decoded by jQuery for you */

    }
</script> 
```

# c# - 在 ASP.NET 中强制自定义 HTTP 401 未经授权的页面

> ID：10762169
> 
> 赞同：0
> 
> 时间：2012-05-25T22:46:24.213
> 
> 标签：c#, asp.net, access-denied, http-status-code-401, httpexception

我编写了一个 Web 应用程序供内部使用（而不是更广泛的 Internet），它使用 Windows 身份验证 - ASP.NET 询问 Windows 以获取当前的凭据集。如果在我设置的 AD 组中找不到用户名，则从受保护页面的 Page_PreInit 调用的身份验证方法会引发 401 错误。

我从 Throwing an HttpException 实现 Earlz 的 CustomErrorsFixer[总是发回 HTTP 500 错误？](https://stackoverflow.com/questions/5612970/throwing-an-httpexception-always-sends-back-http-500-error)因为我也只得到了500s。现在我的自定义错误页面正在工作，这很棒。

在Visual Studio开发服务器本地开发，我发现如果我没有访问权限，我就直接进入401错误页面。然而！当我将站点发布到 IIS 服务器时，如果用户无权访问，他们会收到**Windows 用户名/密码提示**（XP 中丑陋的小提示）。这实际上非常方便，因为它让登录到不同域的人有机会输入正确的凭据。

在这个阶段，当密码提示出现时，如果用户点击**Cancel**或**Escape**，他们会转到自定义的 401 页面，该页面告诉他们如何去请求访问。但是，如果他们尝试输入用户名和密码，默认为错误的域，因此是不正确的凭据，他们会显示**默认的 IIS 401 页面**，我非常希望避免这种情况。第三种情况 - 如果他们输入正确的凭据，他们会被询问 3 次，然后显示自定义错误页面。

因此，如果用户通过“身份验证”，他们将看到自定义 401 页面，如果没有，则看到标准 IIS 页面。

但是，我发现大多数人在提示输入用户名/密码框时只输入没有域的用户名/密码 - 这最终是不正确的，因此将它们发送到**非自定义 IIS 401 页面**。有谁知道我该如何解决这个问题？这非常烦人，因为人们需要查看自定义 401 页面才能查看他们需要请求访问哪个组！

万一这很重要，我们都使用的浏览器是 XP 上的 IE8 或 Windows 7 上的 IE9。如果我应该发布任何代码，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T22:54:31.877

默认情况下，IIS7 会拦截 401 以及其他一些 HTTP 状态代码。

试试这个：

```
<configuration>
  <system.webServer>
    <httpErrors existingResponse="PassThrough" />
  </system.webServer>
</configuration> 
```

# python - 在 Django 表单中放置 GeoIP IP/lat_lon 信息

> ID：10762170
> 
> 赞同：0
> 
> 时间：2012-05-25T22:46:44.887
> 
> 标签：python, django, geolocation, django-forms

我目前正在开发一个应用程序，我想在该应用程序中自动将纬度和经度坐标插入用户表单。我在这里找到了一篇以前的帖子，其目的几乎完全是我试图完成[对 IP 进行地理编码并使用模型表单进行保存的](https://stackoverflow.com/questions/4281754/geocoding-an-ip-and-save-using-model-forms)工作，但我似乎在这个过程中犯了一个错误。我已经安装了 GeoIP 来跟踪用户的 IP 和纬度、经度。

这是视图代码：

```
@login_required
def submit_story(request):
if request.method =="POST":
    story_form = StoryForm(request.POST, request.FILES)
    if story_form.is_valid():
        new_story = story_form.save(ip_address=request.META['REMOTE_ADDR'])
        new_story.author = request.user
        new_story.save()
        return HttpResponseRedirect("/report/all/")
else: # GET request
    story_form = StoryForm()
return render_to_response("report/report.html", {'form': story_form}, context_instance=RequestContext(request)) 
```

这就是我认为问题所在的表格：

```
class StoryForm(forms.ModelForm):
    class Meta:
        model = Story
        exclude = ('author','latitude', 'longitude')

    def save(self, ip_address, *args, **kwargs):
        g = GeoIP()
        lat, lon = g.lat_lon(ip_address)
        user_location = super(StoryForm, self).save(commit=False)
        user_location.latitude = lat
        user_location.longitude = lon
        user_location.save(*args, **kwargs) 
```

这是回溯：

```
Environment:

Request Method: POST
Request URL: http://localhost:8000/report/report/

Django Version: 1.3.1
Python Version: 2.7.1
Installed Applications:
['django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.sites',
 'registration',
 'profiles',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'stentorian.report',
 'south',
 'sorl.thumbnail',
 'gmapi',
 'django.contrib.admin']
Installed Middleware:
 ('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware')

Traceback:
     File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-        packages/django/core/handlers/base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
 File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/contrib/auth/decorators.py" in _wrapped_view
   23\.                 return view_func(request, *args, **kwargs)
 File "/Users/myname/Development/stentorian/../stentorian/report/views.py" in submit_story
  30\.             new_story = story_form.save(ip_address=request.META['REMOTE_ADDR'])
 File "/Users/myname/Development/stentorian/../stentorian/report/forms.py" in save
  16\.         lat, lon = g.lat_lon(ip_address)

Exception Type: TypeError at /report/report/
Exception Value: 'NoneType' object is not iterable 
```

这是我第一次涉足地理定位和第一个 Django 项目，所以我很确定错误很简单（也许我需要拆分元组，不确定）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:05:24.390

嗯...只是为了确定...您粘贴的代码中没有一些明显的缩进错误吗？你的错误到底说了什么？

**编辑**：我相信您的错误可能在于**您通过 name 传递 ip_address**，而您将其定义为表单*save()*方法中的**位置参数。**顺便说一句，您链接的另一个答案中似乎也发生了... :)

 *尝试在代码中更改此行：

`def save(self, ip_address, *args, **kwargs)`

通过这个：

`def save(self, ip_address=None, *args, **kwargs)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T23:56:02.687

这

```
lat, lon = g.lat_lon(ip_address) 
```

导致异常，因为 g.lat_lon() 返回 None，因此无法将其结果解压缩到`lat`and`lon`中。

它应该返回类似的东西`(32.0434235, 43.532522)`。

这意味着您要么将无效参数传递给`g.lat_lon()`，要么由于其他原因它无法解析纬度/经度。

**更新：**

```
new_story = story_form.save(ip_address=request.META['REMOTE_ADDR']) 
```

我想您从本地工作站运行它，在这种情况下， `request.META['REMOTE_ADDR']`它的价值`"127.0.0.1"`显然不是`g.lat_lon()`可以解决的。

在开发中，settings.DEBUG == True。所以你可以做以下

```
from django.conf import settings

def submit_story(request):
    remote_addr = request.META['REMOTE_ADDR']
    if settings.DEBUG:
        # We are in debug mode, so we set it to a dummy value.
        remote_addr = 'google.com'

    if request.method =="POST":
        story_form = StoryForm(request.POST, request.FILES)
        if story_form.is_valid():
            new_story = story_form.save(ip_address=remote_addr) 
```*

# python - 有没有一个好的 Python 的 emacs 插件，就像 R 的 ESS 和 Lisp 的 slime 一样？

> ID：10762171
> 
> 赞同：10
> 
> 时间：2012-05-25T22:46:51.163
> 
> 标签：python, emacs, editor

我尝试过 Ropemacs 和 Pymacs，但我认为它们还不够好..

我真的很喜欢 ESS 和 Slime 中强大的补全功能。

对于python，如果我想通过实验尝试一些功能，我通常会尝试iPython。

Python有这样的emacs插件（tab-completion）吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T20:39:48.870

这篇[文章](http://pedrokroger.com/2010/07/configuring-emacs-as-a-python-ide-2/)有关于 Emacs 作为 Python“IDE”的好技巧：

> 在这篇文章中，我将展示如何配置 emacs 来编写 Python 程序。我们不仅想要语法高亮等基础知识，还想要代码完成、轻松访问 Python 文档、检查常见错误的能力、运行单元测试、调试和良好的交互式编程环境。
> 
> 此设置基于 ipython 和 python-mode，但也可以使用rope、ropemacs 和自动完成模式，如我们在此处看到的。过去我在使用ropemacs 时运气不佳，但将来我会再试一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T12:55:08.700

这就是我使用的：[https ://github.com/gabrielelanaro/emacs-for-python/](https://github.com/gabrielelanaro/emacs-for-python/)

如果您想将 emacs 配置为 Python IDE，易于安装以及几乎所有您需要的东西

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-03T18:51:10.740

[elpy](https://github.com/jorgenschaefer/elpy)是蜜蜂的膝盖！我见过的最好的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T18:39:16.720

您是否尝试过[http://code.google.com/p/yasnippet/](http://code.google.com/p/yasnippet/)？

或：[http ://www.rwdev.eu/articles/emacspyeng](http://www.rwdev.eu/articles/emacspyeng)

# php - PHP 表单验证逻辑有点不对劲

> ID：10762173
> 
> 赞同：2
> 
> 时间：2012-05-25T22:47:19.003
> 
> 标签：php, mysql, forms, validation, error-handling

我正在使用 PHP 验证 HTML 表单。我的所有代码都很好，除了消息字段。如果我在消息字段中放了一些东西，而其他字段显示错误，它仍然会提交。但是，如果我在其他字段中输入了一些内容，并且其他字段有错误，它就不会提交，这是正确的。我怀疑这与我的代码的最后一个 if-else 有关。先感谢您。

```
contact.php
<?php

include 'includes/config.php';
$errors = FALSE;
$displayErrors = NULL;

if (isset($_POST['submit'])) {

$first = $_POST['first'];
$last = $_POST['last'];
$email = $_POST['email'];
$subject = $_POST['subject'];
$message = $_POST['message'];

//Connect to MYSQL Database server
$connect = mysql_connect(DB_HOST, DB_USER, DB_PASS) or die("Could not connect to MYSQL Database.");
$result = mysql_select_db(DB_NAME, $connect) or die("Could not connect to MYSQL table.");

//Clean Data to prevent malicous injections
mysql_real_escape_string(strip_tags(stripcslashes(trim($first))));
mysql_real_escape_string(strip_tags(stripcslashes(trim($last))));
mysql_real_escape_string(strip_tags(stripcslashes(trim($email))));
mysql_real_escape_string(strip_tags(stripcslashes(trim($subject))));
mysql_real_escape_string(strip_tags(stripcslashes(trim($message))));

if (empty($first)) {
    $errors = TRUE;
    $displayErrors .= 'First name is invalid.<br/>';
}
if (empty($last)) {
    $errors = TRUE;
    $displayErrors .= 'Last name is invalid.<br/>';
}
if (empty($email) || !filter_var($email, FILTER_VALIDATE_EMAIL)) {
    $errors = TRUE;
    $displayErrors .= 'Email is invalid.<br/>';
}
if (empty($subject)) {
    $errors = TRUE;
    $displayErrors .= 'Subject is invalid.<br/>';
}
if (empty($message)) {
    $errors = TRUE;
    $displayErrors .= 'Message is invalid.<br/>';
} else {
    $errors = FALSE;
          //Database insertion goes here
    echo 'Form submission successful. Thank you ' . $first . '.';

}

}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T22:55:31.307

基本上你是说，如果消息不是空的`$errors=FALSE`，那么你没有考虑到所有其他字段。

我建议将错误放在一个数组中，例如：

```
$errors['email'] = true; 
```

然后使用最后检查该数组`foreach`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T22:55:39.687

试着把它`else`变成

```
if($errors == FALSE) {//just corrected the equality operator
    //Database insertion goes here
    echo 'Form submission successful. Thank you ' . $first . '.'
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T22:56:06.547

让你所有的 ifs else ifs 这样你的最后一个 else 就不会弄乱你的验证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T22:56:31.087

在所有这些 if 之前，你应该把 $errors = FALSE。然后你可以把 if(!$errors){ //database insert here }

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-25T23:09:34.200

首先，[**不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/questions/12859942/why-shouldnt-i-use-mysql-functions-in-php)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](http://uk.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](http://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](http://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

* * *

我已经整理了你的逻辑，而不是使用`$error=true`ect 你应该构建一个错误数组（包含你的错误文本）然后检查最后是否为空，我还清理了你似乎有的魔术引号问题，以及可怕的多重mysql_real_escape_string 的，希望对你有帮助

联系人.php

```
<?php
include 'includes/config.php';
//Connect to MYSQL Database server
$connect = mysql_connect(DB_HOST, DB_USER, DB_PASS) or die("Could not connect to MYSQL Database.");
$result = mysql_select_db(DB_NAME, $connect) or die("Could not connect to MYSQL table.");

$errors = array();

if ($_SERVER['REQUEST_METHOD']=='POST') {

    function clean(&$value){
        if (get_magic_quotes_gpc()){
            $value = mysql_real_escape_string(strip_tags(trim($value)));
        }else{
            $value = mysql_real_escape_string(trim($value));
        }
    }
    array_walk($_POST,'clean');

    if (empty($_POST['first'])) {
        $errors['first']= 'First name is invalid.<br/>';
    }else{
        $first = $_POST['first'];
    }

    if (empty($_POST['last'])) {
        $errors['last']= 'Last name is invalid<br/>';
    }else{
        $last = $_POST['last'];
    }

    if (empty($_POST['email']) || !filter_var($_POST['email'], FILTER_VALIDATE_EMAIL)) {
        $errors['email'] = 'Email is invalid.<br/>';
    }else{
        $email = $_POST['email'];
    }

    if (empty($_POST['subject'])) {
        $errors['subject']= 'Subject is invalid.<br/>';
    }else{
        $subject = $_POST['subject'];
    }

    if (empty($_POST['message'])) {
        $errors['message']= 'Message is invalid.<br/>';
    }else{
        $message = $_POST['messsage'];
    }

    if(empty($errors)){
        //Database insertion goes here
        echo 'Form submission successful. Thank you ' . htmlentities($first) . '.';
    }else{
        //Errors, so your have $errors['name'] ect to output
        //so somthing like:
        echo (isset($errors['name'])?$errors['name']:null);

    }

}
?> 
```

您还应该添加一个条件，即该值是最小一定长度，`strlen($_POST['first']) > 2`等等。

# ios - iscroll 和 jquery 移动问题

> ID：10762176
> 
> 赞同：2
> 
> 时间：2012-05-25T22:47:27.863
> 
> 标签：ios, jquery-mobile, iscroll4

我不是很擅长 javascript，而且我在混合 iscroll 和 jquery mobile 时遇到了麻烦。我在IOS上测试

这就是我所拥有的；

[http://m.filmrev.me](http://m.filmrev.me)

两个页面都在滚动，但滚动方式不正确。

任何人都可以帮助解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T02:13:12.057

检查这个链接

[http://cubiq.org/dropbox/iscroll4/examples/simple/](http://cubiq.org/dropbox/iscroll4/examples/simple/)

和

您的示例 div 和 'ul' 有 2 个相同的 id。尝试更改这些ID。

前任..

在页面中， `<div id='scroller '>`

在第 2 页中，

```
<div id='scroller''> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T09:00:14.200

您是否尝试过 jQuery Mobile iscroll 实现 - 请参见[此处](https://github.com/watusi/jquery-mobile-iscrollview)。这是专门为 JQM 完成的。

然而，JQM 开发人员已经开始了他们自己的滚动条，称为[Overthrow](http://filamentgroup.github.com/Overthrow/)。与 iscroll 相比，这应该是更多的跨平台。我使用过 iscroll、scrollview（以前的 JQM 滚动条），现在正在使用 Overthrow。工作正常，我发现它很容易实现。

# ruby - 从内部类访问外部类访问器

> ID：10762183
> 
> 赞同：2
> 
> 时间：2012-05-25T22:49:08.173
> 
> 标签：ruby, metaprogramming

所以我在 ruby​​ 中尝试 mixins 和一些元编程，但无法让它为我工作。我想让它打印“狒狒”

```
 module A

  def self.included(base)
      base.extend ClassMethods
  end

  module ClassMethods
    def install_A
        include InstanceMethods
    end
  end

  module InstanceMethods
      class B
         def testB
           #What goes here???
           A.monkey
         end
      end

      attr_accessor :monkey

      def initialize()
         @monkey = "baboon"
      end

      def test
          b = B.new
          puts b.testB
      end
  end
end

class Chimp
  include A
  install_A
end

c = Chimp.new
c.test 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T00:15:49.057

`B`是它自己的自包含类。它不与任何其他类或模块相关联或连接，只是说一个类的实例`B`恰好是在`InstanceMethods::test`. 在定义内部声明`class B`for`module InstanceMethods`限制了`B`它在外部不可见的范围，`InstanceMethods`但它不以任何方式连接。`B``InstanceMethods`

您需要的是使模块的变量在`B`. 您可以实现一个带有参数的`initialize`方法`B`，并`InstanceMethods::test`可以使用`b = B.new(@monkey)`将值传递给`B`（确保`B::initialize`将值存储为实例变量）。

# android - 如何制作 BitmapDrawable 的深拷贝？

> ID：10762185
> 
> 赞同：2
> 
> 时间：2012-05-25T22:50:18.313
> 
> 标签：android

我在克隆 BitmapDrawable 时遇到问题。[我在这篇文章](https://stackoverflow.com/questions/7979440/android-cloning-a-drawable-in-order-to-make-a-statelistdrawable-with-filters)中尝试了答案，但它创建了一个“浅”副本，我需要一个“深”副本，这样我就可以在不影响原件的情况下更改克隆中的像素。

我也试过这个：

```
 Bitmap bitmap = bdOriginal.getBitmap();
    BitmapDrawable bdClone = new BitmapDrawable(getResources(), bitmap.copy(bitmap.getConfig(), true)); 
```

但它似乎创建了一个不可变的克隆，即使我将 Bitmap.copy() 中的可变参数设置为“true”。也就是说，滤色器似乎不会改变克隆。我做错了吗？（编辑：我使用调试器确认 bitmap.mIsMutable = true）

总而言之，我需要一个 BitmapDrawable 的克隆，它可以用滤色器进行更改而不影响原件。有什么建议么？

提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T09:04:07.507

1.  新建`Bitmap`相同大小的。
2.  为这个新创建画布`Bitmap`
3.  把你的第一个画`Bitmap`到这个画布上。

例子：

```
Bitmap copy = Bitmap.createBitmap(original.getWidth(), original.getHeight(), original.getConfig());
Canvas copiedCanvas = new Canvas(copy);
copiedCanvas.drawBitmap(original, 0f, 0f, null); 
```

# python - 重新配置鼠标设备

> ID：10762190
> 
> 赞同：1
> 
> 时间：2012-05-25T22:50:59.567
> 
> 标签：python, input, mouse, device, touchpad

我有一个希望在项目中使用的罗技无线触摸板。我有兴趣使用这两种设备来驱动显微镜载物台。理想情况下，我会将触摸板与计算机连接起来，其唯一目的是驱动舞台，而不是用作鼠标。将使用普通鼠标在窗口和我的程序的用户界面中导航。

这就是问题所在：我不确定如何重新配置​​该设备的功能。似乎我需要为触摸板编写一个新的驱动程序。然而，听起来为设备编写新的驱动程序可能是一项艰巨的任务，如果做得不好，后果会很严重。以前从未写过驱动程序，我敢肯定我会搞砸一些事情。

以下是我的具体问题：

1.  是否需要编写新的驱动程序来重新配置鼠标以进行其他操作？

2.  如果不是，如何进行这样的重新配置？（任何方法都可以接受）。

3.  我可以以某种方式简单地读取从设备输出到计算机的数据以获取要处理的事件吗？

以下是一些可能有用的其他信息：我在 Windows 7 上使用 Python 编程。我只需要知道触摸板上被触摸的 (x, y) 坐标。任何帮助或建议总比没有好。如果这个问题需要改进才能正确回答，请告诉我！提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T21:46:29.957

> > ​1\. 是否需要编写新的驱动程序来重新配置鼠标以进行其他操作？

否。无论其他问题如何，您仍然需要相同的驱动程序来从鼠标读取数据。

> > 2\. 如果不是，如何进行这样的重新配置？（任何方法都可以接受）。

您只需要使指针不是“核心”设备。在 Linux 下，您只需告诉 xinput 将其与 X 下的虚拟核心指针分离。

```
$ xinput list
⎡ Virtual core pointer                      id=2    [master pointer  (3)]
⎜   ↳ Virtual core XTEST pointer                id=4    [slave  pointer  (2)]
⎜   ↳ SynPS/2 Synaptics TouchPad                id=11   [slave  pointer  (2)]
⎜   ↳ Logitech USB-PS/2 Optical Mouse           id=12   [slave  pointer  (2)]
⎣ Virtual core keyboard                     id=3    [master keyboard (2)]
    ↳ Virtual core XTEST keyboard               id=5    [slave  keyboard (3)]
    ↳ Power Button                              id=6    [slave  keyboard (3)]
    ↳ Video Bus                                 id=7    [slave  keyboard (3)]
    ↳ Sleep Button                              id=8    [slave  keyboard (3)]
    ↳ Acer CrystalEye webcam                    id=9    [slave  keyboard (3)]
    ↳ AT Translated Set 2 keyboard              id=10   [slave  keyboard (3)]
$ xinput float 12
$ xinput list
⎡ Virtual core pointer                      id=2    [master pointer  (3)]
⎜   ↳ Virtual core XTEST pointer                id=4    [slave  pointer  (2)]
⎜   ↳ SynPS/2 Synaptics TouchPad                id=11   [slave  pointer  (2)]
⎣ Virtual core keyboard                     id=3    [master keyboard (2)]
    ↳ Virtual core XTEST keyboard               id=5    [slave  keyboard (3)]
    ↳ Power Button                              id=6    [slave  keyboard (3)]
    ↳ Video Bus                                 id=7    [slave  keyboard (3)]
    ↳ Sleep Button                              id=8    [slave  keyboard (3)]
    ↳ Acer CrystalEye webcam                    id=9    [slave  keyboard (3)]
    ↳ AT Translated Set 2 keyboard              id=10   [slave  keyboard (3)]
∼ Logitech USB-PS/2 Optical Mouse           id=12   [floating slave] 
```

我确信在其他操作系统上也存在类似的程序。

> > 3\. 我可以以某种方式简单地读取从设备输出到计算机的数据以获取要处理的事件吗？

绝对地。这就是[事件子系统](http://www.linuxjournal.com/article/6429)（以及它在其他操作系统上的类比）的用途。

# java - ObjectInputStream 无法读取

> ID：10762196
> 
> 赞同：0
> 
> 时间：2012-05-25T22:52:46.367
> 
> 标签：java, packet, objectoutputstream

我有一个`ObjectOutputStream`和一个`ObjectInputStream`。我尝试通过它们发送整数和对象。现在我设法发送并阅读了一个点，我不知道为什么它停在那里。

这是重点：

读者：

```
 while (true) {
        start = in.readInt();
        System.out.println("PART 1");
        int temp1 = in.readInt();
        int temp2 = in.readInt();
        int temp3 = in.readInt();
        System.out.println("PART12");
        Chunk temp = new Chunk(temp1,temp2, temp3);
        while (true) { 
```

它没有到达第 12 部分（没有通过第一个 int ......）

作家：

```
 if (chunkList != null) {
        for (Chunk c: chunkList) {
            out.writeInt(-1);
            out.writeInt(c.getLocation().getX());
            out.writeInt(c.getLocation().getY());
            out.writeInt(c.getLocation().getZ());
            if (c.getTileList() != null) { 
```

它成功地通过了所有这些。

我每 2ms out.flushing 在一个单独的线程中。

线：

```
 while (true)
        {
            while (c.sendPacket()) {

            try
            {
                if (c.getOut() != null)
                {
                    c.getOut().flush();
                }
            }
            catch (IOException ioexception)
            {
                ioexception.printStackTrace();
            }

            try
            {
                sleep(2L);
            }
            catch (InterruptedException interruptedexception) { }
            }
        } 
```

为什么它在 3 个整数的部分停止读取？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T01:54:34.777

我有一种感觉，这是一个线程安全问题。作为一般规则，流并非设计为线程安全的。因此，除非您在更高级别同步两个线程，否则一个线程写入流而第二个线程调用刷新是不安全的。

# bash - 将 xinit 与我作为参数传递的 bash 结合起来，这可能吗？

> ID：10762198
> 
> 赞同：1
> 
> 时间：2012-05-25T22:53:27.423
> 
> 标签：bash

我将 PlayOnlinux 用于一些旧的 Win 游戏。我通常在新的 X 窗口中启动非常旧的。

```
#!/bin/bash

xinit  '/home/deckoff/.PlayOnLinux/shortcuts/heroes.sh' -- :1 -ac -depth 16 
```

这是实际 sh 文件的内容，主要由 PlayOnLinux 创建

```
#!/bin/bash

xrandr -s 800x600

[ "$PLAYONLINUX" = "" ] && exit 0
source "$PLAYONLINUX/lib/sources"
export WINEPREFIX="/home/deckoff/.PlayOnLinux//wineprefix/HOMM3"
export WINEDEBUG="-all"
cd "/home/deckoff/.PlayOnLinux//wineprefix/HOMM3/drive_c/./Program Files/GOG.com/Heroes of Might and Magic 3 Complete"
POL_Wine "Heroes3.exe"  "$@" 
```

有没有办法将两个脚本合二为一，我试过分叉，但有点失败

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T00:55:00.753

你可以试试这个：

```
#!/bin/bash
xinit -- :1 -ac -depth 16 <<EOF

xrandr -s 800x600

[ "$PLAYONLINUX" = "" ] && exit 0
source "$PLAYONLINUX/lib/sources"
export WINEPREFIX="/home/deckoff/.PlayOnLinux//wineprefix/HOMM3"
export WINEDEBUG="-all"
cd "/home/deckoff/.PlayOnLinux//wineprefix/HOMM3/drive_c/./Program Files/GOG.com/Heroes of Might and Magic 3 Complete"
POL_Wine "Heroes3.exe"  "$@"
EOF 
```

如果这不起作用，请尝试将`xinit`行更改为其中任何一个以查看它们是否有效：

```
xinit - -- :1 -ac -depth 16 <<EOF 
```

或者

```
xinit /dev/stdin -- :1 -ac -depth 16 <<EOF 
```

# python - Python中的子字符串计数并从一行输入中添加2个数字

> ID：10762199
> 
> 赞同：3
> 
> 时间：2012-05-25T22:53:39.733
> 
> 标签：python

我正在关注一个 python 网站来完成我的功课。它真的很简洁，它为您提供了在浏览器中完成和编译代码的任务。无论如何，我遇到了一个我不确定该怎么做的挑战。

其中一个问题是：

> 相同的子串可能在同一个字符串中出现多次：例如“assesses”有 2 次子串“sses”，“trans-Panamanianbanana”有 6 次子串“an”。编写一个接受两行输入的程序，我们称第一个针和第二个干草堆。打印针作为 haystack 的子串出现的次数。

我不太确定我应该如何开始这个，我知道我必须比较两个字符串但是如何？我使用了该`count`方法，但它无法识别 in 的第二次`sses`出现`assesses`。

我的第二个问题是我解决的，但我作弊了一点。

问题是：

> 编写一个程序，输入形式为 «number1»+«number2» 的单个输入行，其中这两个都表示正整数，并输出两个数字的和。例如，在输入 5+12 上，输出应为 17。

我使用了这个`eval()`方法，它奏效了，我只是认为这不是评分者的想法。

任何见解将不胜感激。

**编辑：**第二个问题已解决。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T23:03:19.930

正如您所注意到的，对于第一个问题，`str.count()`没有找到重叠的匹配项。相反，[`str.find()`](http://docs.python.org/library/string.html#string.find)在每次找到匹配项后使用并推进起始索引，直到结果为`-1`，例如：

```
>>> 'assesses'.find('sses', 0)    # first look at the start of the string
1
>>> 'assesses'.find('sses', 2)    # now look at previous index + 1
4
>>> 'assesses'.find('sses', 5)    # now look at previous index + 1
-1 
```

由于在我们得到之前有两个结果`-1`，我们知道有两个位置可以找到`'sses'`。`'assesses'`

对于您的第二个问题，您将需要[`split()`](http://docs.python.org/library/stdtypes.html#str.split)字符串 on `'+'`，这将为您提供两个字符串的列表。调用[`int()`](http://docs.python.org/library/functions.html#int)它们中的每一个，然后将它们加在一起。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T19:47:13.210

这就是您在问题 1 中寻找的内容：

```
needle = input()    #defines first input string
haystack = input()    #defines second input string
times = 0     #defines number of times first input string is in second
for a in range(0, len(haystack) - 1):     #loop to check strings within haystack
    if haystack[a:len(needle) + a] == needle:     #checking for needle in haystack
        times = times + 1     #increasing our number of occurances if true
print(times)     #and here is your output 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T23:24:25.690

对于我得到的第二个问题：

```
S = input()
x = S.find('+')
print(int(S[0:x])+(int(S[x+1:]))) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-07T19:50:50.873

两个输入字符串，一个用于总计出现次数的计数器，一个名为 indx 的变量，它将始终作为起始搜索点，一个 loc 变量将是任何 str1 in 出现的开始的（int 类型）索引位置str2

```
str1 = input() #input 1
str2 = input() #input 2
count=0  #occurrence counter
indx=0  #index of string to start search at
for i in str2:  #for character i in input 2
    loc = str2.find(str1, indx)  #starting index of occurrence
    if loc == -1:  #-1 means there were no occurences
        break  #in this case break the search
    indx=loc+1  #to find the next occurrence, the new starting point will be the starting location of the last occurrence + 1
    count=count+1  #add an occurrence
print(count) #voila! 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-25T23:04:10.693

1.  STRING.count 方法应该适用于第一个问题。如果你仔细看，在评估中实际上没有两个*不重叠*的 'sses' 字符串。

    你要么有评估，**要么****评估**。你看到问题了吗？呼叫`"trans-Panamanian banana".count("an")`产生正确的号码。

2.  我认为使用 eval() 可能没问题。您的另一个选择是在 + 上拆分，然后遍历结果列表，随时进行类型转换和累积。听起来你在做一个字符串模块，所以这可能是你的 gpa 更好的解决方案；）。

**编辑：** FG 击败我，仅用几秒钟就发布了基本相同的答案。呸！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-25T23:54:24.523

1.  请参阅：[重叠出现的字符串计数](https://stackoverflow.com/questions/2970520/string-count-with-overlapping-occurances)

2.  总和（地图（lambda val：int（val.strip（）），INPUT.split（“+”）））

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-06T14:06:42.767

对于第一个问题，您还可以使用此示例代码：

```
def occurs(string, sub):
count = start = 0
while True:
    start = string.find(sub, start) + 1
    if start > 0:
        count+=1
    else:
        return count 
```

它会解决你的问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-05-18T03:14:46.297

**回答第一个问题：**

```
needle=input()
haystack=input()
counter=0
for i in range(0,len(haystack)):
  if(haystack[i:len(needle)+i]!=needle):
     continue
  counter=counter+1
print(counter) 
```

**回答第二个问题：**

```
S = input()
for position in range(0, len(S)):
plus=S[position]
    if (plus!="+"):
      continue
    number1=int(S[0:position])
    number2=int(S[position+1:len(S)])
    print(number1+number2) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-09-05T19:27:53.863

我找到了第二个问题的答案：

```
S=input()
x=len(S)
for i in range (0,x):
   w= S[i]
   if w == '+': 
      a=(S[0:i])
      b=(S[i+1:x])
      u=int(a)
      o=int(b)
      p=u+o
      print(p) 
```

# javascript - Javascript仅在窗口处于焦点时才执行计时器功能？

> ID：10762200
> 
> 赞同：1
> 
> 时间：2012-05-25T22:53:41.870
> 
> 标签：javascript, jquery

假设我打开了两个单独的浏览器窗口：

```
function onload() {
    setTimeout("dosomething", 2000);
}

function dosomething() {
    $.ajax({
        url: "someurl",
        success: function (data) {
            document.write("Hello");
        }
    });
    setTimeout("dosomething", 2000);
} 
```

我想让它只在窗口处于焦点时每两秒打印一次 hello 。如果窗口不在焦点上，则计时器将基本上暂停（换句话说，计时器将停止滴答，不会调用dsomething），直到用户单击不在焦点的浏览器窗口，计时器将恢复并且Hello 单词将继续打印，而另一个窗口将停止计时器，反之亦然。

我该如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:51:11.950

这是一个棘手的问题，并且取决于浏览器。

```
var timer;    
function onBlur() {
    timer = setTimeout("dosomething", 2000);
};
function onFocus(){
    clearTimeout(timer);
};
if (/*@cc_on!@*/false) { // check for Internet Explorer
    document.onfocusin = onFocus;
    document.onfocusout = onBlur;
} else {
    window.onfocus = onFocus;
    window.onblur = onBlur;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T22:56:09.470

```
var someVar = false;
window.onfocus = function() { someVar = true; };
window.onblur = function() { someVar = false; };
var time;

function timer(someVar) {
    if (someVar == true) {
        setTimeOut('time++', 1);
    }
}

function something() {
    time = 0;
    while (time <= 2000) {
        timer(someVar);
        document.getElementById('time').innerHTML = time;
    }
} 
```

# javascript - document.write 的替代品

> ID：10762202
> 
> 赞同：2
> 
> 时间：2012-05-25T22:53:54.520
> 
> 标签：javascript, jquery, document.write

我处于一种似乎必须在 javascript 库中使用 document.write 的情况。脚本必须知道定义脚本的区域的宽度。但是，该脚本对该区域中的任何标签都没有任何明确的了解。如果有一个 div 的明确知识，那么它会像这样简单：

```
<div id="childAnchor"></div>
<script ref...
 //inside of referenced script
 var divWidth = $("#childAnchor").width();
</script> 
```

因此，在引用的脚本中，我正在考虑像这样使用 document.write：

```
<script ref...
 //inside of referenced script
 var childAnchor = "z_87127XNA_2451ap";
 document.write('<div id="' + childAnchor + '"></div>');
 var divWidth = $("#" + childAnchor).width();
</script> 
```

但是，我不太喜欢 document.write 实现。这里有没有使用 document.write 的替代方法？我不能简单地使用 window 的原因是这是在主视图页面内呈现的视图内部。窗口无法正确获得嵌套区域宽度。

该地区几乎在这里：

```
<body>
 <div>
  <div>
   <div>
     AREA 
```

AREA 不知道任何其他 div。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T04:49:13.860

这只是我突然想到的，我记得你的问题：脚本代码可以找到它所在的脚本块，所以你可以从那里遍历 DOM。当前脚本块将是当前 DOM 中的最后一个（代码运行时仍在解析 DOM）。

通过定位当前脚本块，您可以找到它的父元素，并在任何地方添加新元素：

```
<!doctype html>
<html>
    <head>
        <style>
        .parent .before { color: red; }
        .parent .after { color: blue; }
        </style>
    </head>
    <body>
        <script></script>
        <div class="parent">
            <span>before script block</span>
            <script>
            var s = document.getElementsByTagName('script');
            var here = s[s.length-1];

            var red = document.createElement("p");
            red.className = 'before';
            red.innerHTML = "red text";
            here.parentNode.insertBefore(red, here);

            var blue = document.createElement("p");
            blue.className = 'after';
            blue.innerHTML = "blue text";
            here.parentNode.appendChild(blue);
            </script>
            <span>after script block</span>
        </div>
        <script></script>
    </body>
</html>​ 
```

[http://jsfiddle.net/gFyK9/2/](http://jsfiddle.net/gFyK9/2/)

请注意，“蓝色文本”跨度将插入“脚本块之后”跨度之前。`appendChild`那是因为此时调用DOM 中不存在“之后”跨度。

* * *

然而[，有一个非常简单的方法可以让这个失败](https://stackoverflow.com/a/14410368/825789)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T20:03:05.930

这种方法没有其他选择。这是脚本可以在不知道它加载到的 DOM 的**任何信息的情况下找到它嵌套的元素的宽度的唯一方法。**

在适当使用`document.write()`时使用是合法的。尽管向 DOM 追加一个新元素是可取的，但这并不总是一个可用的选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T23:05:15.390

如果你知道它是哪个子元素，你可以在 jquery 中使用第 n 个子元素。否则你需要用 each() 遍历它们

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T23:30:44.270

像这样创建并附加孩子：

```
var el = document.createElement('div');
el.id='id';
document.body.appendChild(el); 
```

但是我不确定你想用这个做什么来获得任何宽度，它可能会返回 0。

# node.js - ES6 代理无法拦截数组索引

> ID：10762216
> 
> 赞同：2
> 
> 时间：2012-05-25T22:56:57.223
> 
> 标签：node.js, ecmascript-harmony, proxy-object

这是我的测试代码（使用`node --harmony-proxies foo.js`：

```
var a = Proxy.create({
    get : function (proxy, prop)
    {
        return 5
    }
})

console.log(a['foo'])
console.log(a.length)
console.log(a['10'])
console.log(a[10]) 
```

为什么最后两行无法打印 5，为什么代理无法拦截看起来像整数的属性？它是一个实现错误还是它是如何指定的？是否有单独的方法来拦截数组索引，以便我可以实现自己的数组（例如稀疏数组）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T20:10:30.750

如果我正确阅读了节点更改日志，那么节点 0.6.18 仍在 V8 3.6.6 上运行，这是一个相当旧的版本（从 2011 年 10 月开始）。在那个版本中，对代理的支持仍在进行中（与其他支持的 Harmony 功能一样）。不要期望代理在 V8 3.8（从 2011 年 12 月起）之前正常运行。不幸的是，我无法告诉您节点的稳定版本何时会升级。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T16:32:55.000

正如 A. Rossberg 所指出的那样，该错误（以及其他一些阻碍因素）在 V8 3.8 中已修复（节点 0.7.x 非常稳定，0.8.x 即将发布）。但是，如果您使用代理，仍然需要注意一些错误。这个 github 问题对它们有一个很好的快速概述：[https ://github.com/tvcutsem/harmony-reflect/issues/4](https://github.com/tvcutsem/harmony-reflect/issues/4)

# c++ - c++类实例内存布局再一次

> ID：10762217
> 
> 赞同：5
> 
> 时间：2012-05-25T22:57:08.703
> 
> 标签：c++, memory, layout, shared-libraries

我知道以前有人问过这个问题，但是在你给我一个减号并报告重复的问题之前，请思考一下：

在所有先前的答案中，每个人都说对象内存布局取决于编译器。那么，共享库（*.dll、*.so）如何能够导出和导入 c++ 类，并且即使来自不同的编译器也绝对可以组合起来？考虑在 mingw 下编写的 DirectX 应用程序。DirectX 是使用 MSVC++ 编译的，那么这些环境如何在内存布局上达成一致？我知道 DirectX 严重依赖 C++ 类和多态性。

换个方式问：假设我有一个选择的架构（例如 Windows、intel x86）并且我正在尝试编写一个新的编译器。我如何知道如何访问由另一个编译器编译的 .dll lib 提供的类实例（vtable、成员字段）？还是只是这样：M$ 编写了 VC++，从那时起它就成为了不成文的标准，而所有其他编译器都“出于兼容性原因”这样做？那么 linux 或其他操作系统呢？

编辑：

好吧，我承认，DirectX 的例子很糟糕，因为 COM 规范......

另一个例子：QT。我将 QT 与 mingw 一起使用，但我知道也有可用的 MSVC 版本。我不知道差异是否仅在标头中，或者共享库（dll-s）是否也不同。如果是，这是否意味着我必须分发包含 qt 库的应用程序，所以如果有人碰巧有不同编译器的库，它不会混淆？（很好的内存和代码共享，对吧？）。或者它们是否相同，并且无论如何都有一些不成文的法律？

编辑2：

我安装了一个不同的 qt 版本（msvc 2010）只是为了看看什么是共享的和不共享的。似乎共享（他们真的共享）库是不同的。似乎我真的必须为我的应用程序提供 qt-libs ......这不是一件小事（例如 QtGui 8-9MB）。那么其他较小的库呢，其作者不太愿意为其他编译器提供版本？这是否意味着我被他们原来的编译器困住了？如果我想使用由不同编译器编译的两个不同库怎么办？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-25T23:04:39.180

基本上你在问一个ABI。

在某些情况下（例如，在 Itanium 上）有一个指定 ABI 的文档，基本上每个人都遵循该文档。

在 DirectX 的情况下，它有点相同：微软已经发布了 COM 规范，因此任何遵循这些规范的人都可以与基本上任何 COM 对象进行互操作（在合理范围内——64 位编译器可能无法工作为 Windows 3.1 编写的 16 位 COM 对象）。

对于大多数其他事情，您或多或少是靠自己来解决问题的。通常至少有一点以文档的方式发布，但至少根据我的经验，它经常略过一些最终很重要的细节，没有完全可靠地更新，在某些情况下完全是错误的。在大多数情况下，它的组织也很糟糕，因此您几乎可以从任何可以找到的地方收集您可以找到的东西，并且当您用完信息（或耐心）时，请进行一些逆向工程来填补缺失的部分。

编辑：对于像 Qt 库这样的非 COM 的东西，你有几个选择。一种是静态链接到 Qt 库，因此您需要的 Qt 代码直接链接到您的可执行文件中。如果你想使用一个 DLL，那么是的，你*几乎*被困在你的应用程序中分发一个 DLL，它将特定于你用来生成应用程序本身的编译器。不同的编译器（甚至不同版本或具有相同编译器的一组编译标志）通常需要不同的 DLL（可能是相同的源代码，但为了适应编译器的变化而构建）。

这也有例外，但它们与我上面概述的非常相似。例如，用于 Windows 的英特尔编译器通常使用 Microsoft 的标准库，并且也可以使用为 Microsoft 编译器构建的大多数（如果不是全部）其他库。这很大程度上是因为英特尔已经竭尽全力确保他们的编译器使用与微软相同的调用约定、名称修改方案等。它之所以奏效，是因为他们付出了很多努力使其发挥作用，而不是因为任何不成文的法律或类似的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T23:00:57.370

DirectX 是一种基于 COM 的技术，这就是为什么它可以在 C 中与各种编译器一起使用。引擎盖下的 COM 接口是一个模拟 VMT 的类 C 结构。

从技术上讲，DirectX 有一个中间自动生成的 C++ 接口，但是关于可以跨不同编译器使用以 .dll 导出的类的一般断言是错误的。

编辑1：

不幸的是，使用 MSVC 构建的 QT dll 与 gcc 构建的 dll 不兼容，这是由于自然原因：不同的 C++ 编译器 - 不同的 ABI 和不同的运行时库（mingw 使用较旧的 MSVCRT，这就是为什么 pure-C . dll 可以在 MSVC 中使用，反之亦然）。一些编译器偶然或部分有意地匹配它们的 ABI，但 MSVC/gcc 绝对不是这种情况。QT 也可以构建为静态库，因此要重新分发内容，可能只是静态链接。

DLL 中 C++ 类的名称修改很大程度上取决于所使用的编译器前端。许多知名公司的商业编译器使用 EDG 的 C++ 解析器，这就是为什么类名和重载函数具有相似或匹配的签名。

编辑2：

“如果我想使用由不同编译器编译的两个不同库怎么办？”

如果您迫切需要两个库的某些特定功能（我的意思是一些具体操作，而不是整个框架），那么没有库的源代码的方法是编写一些包装器并将此包装器编译为 C 风格的 .dll .

可以将其想象为拥有“两种不同的 C++-es，C++-1 和 C++-2”。ABI/Runtime 的问题与使用 C 中的 Pascal 代码或链接一些较旧的 Fortran 库没有什么不同。

# java - Android 会记住我的旧包名吗？

> ID：10762219
> 
> 赞同：0
> 
> 时间：2012-05-25T22:57:36.977
> 
> 标签：java, android, junit

当我第一次创建我的测试项目时，我告诉它我的包是 com.example.test。现在，我已将源包重命名为 com.imcool.android，并且还更新了清单中的包：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.imcool.android"
    android:versionCode="1"
    android:versionName="1.0" > 
```

完全清理后，Android 询问我是否要更新启动配置，我单击是。我尝试运行一个 android 单元测试，我得到这个错误：

```
Test run failed: Unable to find instrumentation info for: ComponentInfo{com.imcool.android/android.test.InstrumentationTestRunner} 
```

如果我将清单中的包更改回 com.example.test，它可以工作，即使我的实际源包名称仍然是 com.imcool.android。

这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T23:29:49.903

不是安卓问你的。这是日食。:)

无论如何，只需转到运行配置并删除所有不再需要的项目，然后再次运行。这样它就会忘记以前的配置，只使用你要求的配置。

# android - myView.setLayoutParams(otherView.getLayoutParams()); 不工作，为什么？

> ID：10762220
> 
> 赞同：1
> 
> 时间：2012-05-25T22:57:39.140
> 
> 标签：android, android-layout, android-view

在 xml 中得到了我的 TextView：

```
<TextView  
    android:id="@+id/myTextView"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:layout_weight="1"
    android:gravity="left"
    android:text="TextView"/> 
```

我想创建多个 TextView，但我想让它们看起来和**this**一样。

所以我尝试了：

```
TextView newTextView = new TextView(this);

newTextView.setLayoutParams(myTextView.getLayoutParams()); 
```

我认为这应该从 xml 中的 myTextView straigthlghly(?) 获取所有布局参数，并将它们传递给 newTextView 进行设置。

我的问题是：什么都没有发生。没有生效，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T09:14:10.723

这是一个示例项目，表明它有效。您可以通过查看可视化编辑器的预览来查看它的工作原理，它看起来与运行时显示的不同。我认为您的错误是您没有为加权视图设置 0px（或 0dp，零仍然为零）。

main.xml（布局）：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:orientation="vertical" android:layout_width="fill_parent"
  android:layout_height="fill_parent" android:id="@+id/container">

  <TextView android:id="@+id/textView1" android:layout_width="wrap_content"
    android:layout_height="0px" android:text="TextView1"
    android:layout_weight="1" android:background="#ffff0000" />

  <TextView android:id="@+id/textView2" android:layout_width="wrap_content"
    android:layout_height="wrap_content" android:text="TextView2"
    android:background="#ff00ff00" />

</LinearLayout> 
```

测试活动.java：

```
public class TestActivity extends Activity
  {
  /** Called when the activity is first created. */
  @Override
  public void onCreate(final Bundle savedInstanceState)
    {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    final TextView tv1=(TextView)findViewById(R.id.textView1);
    final TextView tv2=(TextView)findViewById(R.id.textView2);
    final LayoutParams layoutParams=tv1.getLayoutParams();
    tv2.setLayoutParams(layoutParams);
    // adding textView programatically:
    final TextView tv3=new TextView(this);
    tv3.setText("textView3");
    tv3.setBackgroundColor(0xff0000ff);
    tv3.setLayoutParams(layoutParams);
    final ViewGroup root=(ViewGroup)findViewById(R.id.container);
    root.addView(tv3);
    }
  } 
```

# bash - Bash：带有 curl 的 bash 脚本中“#!/bin/sh”的效果是什么

> ID：10762222
> 
> 赞同：1
> 
> 时间：2012-05-25T22:57:47.983
> 
> 标签：bash, curl

我做了一个复杂而长的命令来成功登录一个站点。如果我在控制台中执行它，它就可以工作。但是，如果我在 bash 脚本中复制并粘贴同一行，它就不起作用。

我尝试了很多东西，但偶然发现如果我不使用这条线

```
#!/bin/sh 
```

这行得通！为什么这发生在我的 mac OSX Lion 中？这个配置行在 bash 脚本中做了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T23:02:57.073

A bash script that is run via `/bin/sh` runs in **sh compatibility mode**, which means that many bash-specific features (herestrings, process substitution, etc.) will **not** work.

```
sh-4.2$ cat < <(echo 123)
sh: syntax error near unexpected token `<' 
```

If you want to be able to use full bash syntax, use `#!/bin/bash` as your shebang line.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T23:00:43.187

"#!/bin/sh" is a common idiom to insure that the correct interpreter is used to run the script. Here, "sh" is the "Bourne Shell". A good, standard "least common denominator" for shell scripts.

In your case, however, "#!/bin/sh" seems to be the *wrong* interpreter.

Here's a bit more info:

> [http://www.unix.com/answers-frequently-asked-questions/7077-what-does-usr-bin-ksh-mean.html](http://www.unix.com/answers-frequently-asked-questions/7077-what-does-usr-bin-ksh-mean.html)
> 
> Originally, we only had one shell on unix. When you asked to run a command, the shell would attempt to invoke one of the exec() system calls on it. It the command was an executable, the exec would succeed and the command would run. If the exec() failed, the shell would not give up, instead it would try to interpet the command file as if it were a shell script.
> 
> Then unix got more shells and the situation became confused. Most folks would write scripts in one shell and type commands in another. And each shell had differing rules for feeding scripts to an interpreter.
> 
> This is when the "#! /" trick was invented. The idea was to let the kernel's exec() system calls succeed with shell scripts. When the kernel tries to exec() a file, it looks at the first 4 bytes which represent an integer called a magic number. This tells the kernel if it should try to run the file or not. So "#! /" was added to magic numbers that the kernel knows and it was extended to actually be able to run shell scripts by itself. But some people could not type "#! /", they kept leaving the space out. So the kernel was exended a bit again to allow "#!/" to work as a special 3 byte magic number.
> 
> So `#! /usr/bin/ksh` and `#!/usr/bin/ksh` now mean the same thing. I always use the former since at least some kernels might still exist that don't understand the latter.
> 
> And note that the first line is a signal to the kernel, and not to the shell. What happens now is that when shells try to run scripts via exec() they just succeed. And we never stumble on their various fallback schemes.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T23:05:15.363

脚本的第一行可用于选择要使用的脚本解释器。

和

```
#!/bin/bash 
```

你告诉 shell 调用 /bin/bash 解释器来执行你的脚本。确保#!/bin/bash 之前没有空格或空行，否则它将不起作用。

# asp.net-mvc-3 - 非常规文件夹的 ASP.NET MVC 3 路由问题

> ID：10762223
> 
> 赞同：0
> 
> 时间：2012-05-25T22:58:10.887
> 
> 标签：asp.net-mvc-3

在我正在开发的网站中，我将所有图像放在“图像”文件夹中，例如“/图像”。

ASP.NET MVC 3 抛出一个异常，说它找不到“图像”的控制器。

路由表有什么技巧吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T12:01:17.353

你可以试试

```
routes.IgnoreRoute("images/"); 
```

这将阻止路由尝试为包含此文件夹的请求解析控制器。

# javascript - 将事件绑定到带有 div 加载的锚标记

> ID：10762224
> 
> 赞同：0
> 
> 时间：2012-05-25T22:58:46.230
> 
> 标签：javascript, jquery, jquery-plugins

我正在使用 jQuery 1.7.2。

我创建了一个加载模式的自定义插件 - 即带有内容的 div。( `$modal`)

当 div 显示给用户时，我想将一个函数绑定到 div 中`Close`分配有类的所有锚标记。

**我有这样的事情：**

```
 $(".Close", $modal).die().on("click", hitMe()); 
```

我遇到的问题是每次加载 div 时，该`hitMe()`函数总是在触发。我只希望当用户单击 div 中具有 Close 类的锚点时触发它。

知道我哪里出错了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T23:01:10.477

You are calling hitMe inside the .on function.
What you need to do is pass the function as an argument

```
$(".Close", $modal).die().on("click", hitMe); 
```

# mysql - MySQL：按组和字段排序

> ID：10762228
> 
> 赞同：1
> 
> 时间：2012-05-25T22:59:02.367
> 
> 标签：mysql, sql, cakephp, select, sql-order-by

我有一个具有以下（简化）结构的表：

```
INT id,
INT type,
INT sort 
```

我需要的是一个 SELECT 以某种方式对我的数据进行排序，以便：

*   相同类型的所有行都按顺序排列，`sort`内部按升序排序，并且
*   一种类型的所有“块”都按它们的最小值排序`sort`。

**例子：**

如果表格如下所示：

```
| id | type | sort |
|  1 |   1  |   3  |
|  2 |   3  |   5  |
|  3 |   3  |   1  |
|  4 |   2  |   4  |
|  5 |   1  |   2  |
|  6 |   2  |   6  | 
```

查询应该像这样对结果进行排序：

```
| id | type | sort |
|  3 |   3  |   1  |
|  2 |   3  |   5  | 
|  5 |   1  |   2  |
|  1 |   1  |   3  | 
|  4 |   2  |   4  |
|  6 |   2  |   6  | 
```

我希望这足够清楚。

在我看来，这应该是一个非常普遍的要求，但我没有找到任何足够接近的示例，无法自行将其转移到我的用例中。我想我至少不能避免一个子查询，但我自己并没有弄清楚。

任何帮助表示赞赏，在此先感谢。

顺便说一句：我将在 CakePHP 2.1 中使用这个查询，所以如果您知道使用 Cake 的一种舒适的方法，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T23:07:43.593

这比最初听起来要简单。我相信以下应该可以解决问题：

```
SELECT a.id, a.type, a.sort
FROM Some_Table as a
JOIN (SELECT type, MIN(sort) as min
      FROM Some_Table
      GROUP BY type) as b
ON b.type = a.type
ORDER BY b.min, a.type, a.sort 
```

为获得最佳（最快）结果，您可能需要 ( `type`, `sort`) 上的索引。如果有两个组具有相同的值（会导致混合行） ，
您需要额外的排序方式`a.type`（而不是 ( `b.min`, )）。如果没有重复值，您可以将其删除。`a.sort``sort`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T23:02:53.907

sort and type are reserved words on some databases and can cause you problems.

Have you tried?

```
ORDER BY TYPE DESC, SORT ASC 
```

# jquery - jQuery - 使用链接进行显示/隐藏功能，但防止链接在 url 中打开

> ID：10762233
> 
> 赞同：1
> 
> 时间：2012-05-25T22:59:37.233
> 
> 标签：jquery

我有一个很好的 jQuery 显示/隐藏功能；问题是，如果通过直接输入 URL 打开链接，它不会很好地降级——您可以一次看到所有元素。

有什么方法可以使用显示/隐藏功能中的链接，但在直接输入浏览器地址栏时阻止链接打开？

这是我的代码：

**jQuery**

```
$(document).ready(function() {

    $('#nav li a').first().addClass('blue');

    $('#nav li a').click(function(){

    $('#nav li a').first().removeClass('blue');
    $('#nav li a').removeClass('blue');
    $(this).addClass('blue');

    var toLoad = $(this).attr('href')+'#content';  
    $('#content').hide(0,loadContent);  
    $('#load').remove();  
    $('#wrapper').append('<span id="load">LOADING...</span>');  
    $('#load').fadeIn('normal');  
    //window.location.hash = //$(this).attr('href').substr(0,$(this).attr('href').length-0);  
    function loadContent() {  
        $('#conent').load(toLoad,'',showNewContent())  
    }  
    function showNewContent() {  
        $('#content').show(0,hideLoader());  
    }  
    function hideLoader() {  
        $('#load').fadeOut('normal');  
    }  
    return false;  
    });
}); 
```

**HTML**

```
<div id="leftcol">

<div id="menu">
<ul id="nav">
<li><a href="/option1">Option 1</a></li><br />
<li><a href="/option2">Option 2</a></li><br />
<li><a href="/option3">Option 3</a></li><br />
</ul>
</div>
</div>

<div id="content">
<div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T23:01:32.787

如果链接`href`不是 URL，您可能应该使用`#option1`

您可以使用该`hashchange`事件来调用显示/隐藏功能吗？

```
$(window).bind('hashchange', function() {
    showHideFunction(window.location.hash);
}); 
```

当您单击链接时，哈希将更改并调用该函数。

如果有人输入地址`http://domain.com/#option1`
，那么您可以在 onload 函数中像这样获取哈希值。

```
var hash = window.location.hash;
if(hash) {
    showHideFunction(hash);
} 
```

# .net - Why is my coding not working? Trying to show data in richtextbox

> ID：10762236
> 
> 赞同：-1
> 
> 时间：2012-05-25T22:59:51.003
> 
> 标签：.net, vb.net, vb.net-2010

I have spent hours trying to fix this problem I have, basically I want to only display column 1 from my text file in my rich text box.

Each column is seperated by a space (" ")

When I run the following coding it shows all columns.

```
RichTextBox1.Text = System.IO.File.ReadAllText("Path")
    Dim str1() As String = Nothing
    Dim LinesList2 As New List(Of String)

    For Each line1 In LinesList2
        str1 = line1.Split(" "c)
        If str1(0) = line1 Then
            Dim Hold As String = Nothing
            Hold = line1 & " " & str1(1).ToString
            LinesList2.Add(Hold)
        End If
    Next
    LinesList2.Sort()

    For Each Str As String In LinesList2
        RichTextBox1.AppendText(Str & Environment.NewLine)
    Next 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T23:06:03.767

使用 LINQ 会更容易：

```
Dim firstColumnText = From line In System.IO.File.ReadLines(path)
                      Select line.Split(" "c)(0)
RichTextBox1.Text = String.Join(Environment.NewLine, firstColumnText) 
```

除此之外，您在这里使用的是一个空列表：

```
' reads the whole file and set it as text for the RichTextBox '
RichTextBox1.Text = System.IO.File.ReadAllText(path)
' creates an empty List(Of String) '
Dim LinesList2 As New List(Of String)
' "Iterates" the empty list '
For Each line1 In LinesList2
    '  ..... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T23:03:52.457

You're not reading anything into LinesList2, so nothing inside either loop gets executed. Even if you did, the line `Hold = line1 & ...` seems to include the whole line.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T23:04:00.460

您正在添加整行

```
 Hold = line1 & " " & str1(1).ToString
    LinesList2.Add(Hold) 
```

目的是什么？

```
str1(0) = line1 
```

这只有在没有分裂的情况下才会成立。

您需要调试 line1 和 sr1()

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T23:04:31.320

除非您缺少代码，否则您已经创建`LinesList2`但没有填充任何内容，因此没有什么可循环的。

# objective-c - Why can't I disable ARC (per single-file)?

> ID：10762237
> 
> 赞同：2
> 
> 时间：2012-05-25T22:59:51.183
> 
> 标签：objective-c, ios, xcode, automatic-ref-counting

I am trying to use the compiler flag -fno-objc-arc but it does not work for me. I put it in the right place, under build phases ---> compile sources ---> compiler flags. Xcode is still giving me a ARC dealloc error even though I put that flag under the file that should not use ARC. I don't know what to do but this happens on every project I try, not just this one. I have restarted Xcode and cleaned the project but have not come up with a solution.

Does anyone know how to fix my problem?

Edit: I re-added the files that were giving me errors and it worked out just fine! I'd still know why this happens as it's not the first time it has happened to me.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:10:05.900

在您设置该编译器标志之前，该错误将继续出现。-fno-objc-arc 是否“接受”的测试是应用程序是否构建。如果使用 ARC 编译文件并调用 release/retain/dealloc/etc，则程序将失败。当你编辑文件时，Xcode 可能仍然会给你错误的错误信息，你只需要忽略它们。

# mysql - MySQL: Enable LOAD DATA LOCAL INFILE

> ID：10762239
> 
> 赞同：143
> 
> 时间：2012-05-25T23:00:13.867
> 
> 标签：mysql

I'm running Mysql 5.5 on Ubuntu 12 LTS. How should I enable LOAD DATA LOCAL INFILE in my.cnf?

I've tried adding local-infile in my config at various places but I'm still getting the "The used command is not allowed with this MySQL version"

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2012-05-25T23:25:35.273

从 MySQL 5.5 手册页：

> LOCAL 仅在您的服务器和客户端都已配置为允许时才有效。例如，如果 mysqld 以 --local-infile=0 启动，则 LOCAL 不起作用。请参见第 6.1.6 节，“LOAD DATA LOCAL 的安全问题”。

您应该设置选项：

```
local-infile=1 
```

进入my.cnf 文件的**[mysql]条目或使用****--local-infile**选项调用 mysql 客户端：

```
mysql --local-infile -uroot -pyourpwd yourdbname 
```

您必须确保在**[mysqld]**部分中也定义了相同的参数，以启用“本地 infile”功能服务器端。

这是一个安全限制。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2012-07-18T10:03:10.820

您应该编辑的 my.cnf 文件是 /etc/mysql/my.cnf**文件**。只是：

```
sudo nano /etc/mysql/my.cnf 
```

然后加：

```
[mysqld]
local-infile 

[mysql]
local-infile 
```

标题**[mysqld]**和**[mysql]**已经给出，只需在文件中找到它们并在每个下面添加**local-infile 。**

它适用于 Ubuntu 12.04 LTS 上的 MySQL 5.5。

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2018-07-26T06:57:03.417

我使用 mysql 终端命令在 MySQL 8.0.11 上解决了这个问题：

```
SET GLOBAL local_infile = true; 
```

我的意思是我先用通常的方式登录：

```
mysql -u user -p* 
```

之后，您可以使用以下命令查看状态：

```
SHOW GLOBAL VARIABLES LIKE 'local_infile'; 
```

它应该打开。我不会在这里写关于将本地文件加载到数据库中的安全性。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2013-09-20T14:53:13.790

用原生驱动替换驱动php5-mysql

在 Debian 上

```
apt-get install php5-mysqlnd 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2013-08-05T23:21:26.203

如果您在 ubuntu 上使用的 mysql 在任何情况下都不起作用并且仍然出现 1148 错误，您可以`load data infile`通过命令行运行该命令

打开终端窗口

跑`mysql -u YOURUSERNAME -p --local-infile YOURDBNAME`

您将被要求输入 mysqluser 密码

您将运行 MySQLMonitor 并且您的命令提示符将是`mysql>`

运行您的`load data infile`命令（不要忘记以分号结尾`;` ）

像这样：

```
load data local infile '/home/tony/Desktop/2013Mini.csv' into table Reading_Table FIELDS TERMINATED BY ',' ENCLOSED BY '"' LINES TERMINATED BY '\n'; 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2017-12-25T16:45:45.843

见下图...

我已经添加`--local-infile=1`到正常的 mysql 命令 `mysql -u root -p`

所以总行将是：

> mysql --local-infile=1 -u root -p

[![在此处输入图像描述](../Images/c3c86fab97099dac535a1585847c6db6.png)](https://i.stack.imgur.com/P3yi5.png)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2013-08-05T21:45:16.080

此外，对于其他读者，如果您尝试在 Django 中执行此操作并且您的服务器允许 local_infile（您可以通过 mysql 客户端键入 SHOW VARIABLES 进行检查），那么您可以将其添加到您的**settings.py**文件中（因为 python MySQLdb 没有t 默认读取 .my.cnf 文件）：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'mydb',
        'USER': 'myname',
        'PASSWORD': 'mypass',
        'HOST': 'myserver',
        'PORT': '3306',
        'OPTIONS' : {
            'local_infile':1,
        },
    }
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2020-04-18T04:18:49.533

添加`local_infile`和`mysql`部分`mysqld`。

```
[mysql]
local_infile=1
...

[mysqld]
local_infile=1
... 
```

在 Windows 和 Linux 中的 MySQL 8.x 中进行了测试。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-01-12T14:00:24.830

如果您的 csv 文件与 db**相同**，则需要在**LOAD DATA INFILE中删除****LOCAL**，否则会出现错误

 **> 此 MySQL 版本不允许使用的命令

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-10-10T13:20:08.170

您必须注意如何建立 mysqli 连接。该解决方案的全部功劳归于 Jorge Albarenque，[来源](http://dev.mysql.com/doc/refman/5.0/en/load-data-local.html)

为了解决它，我必须：

*   将 local-infile=1 添加到 my.cnf 的 [mysqld] 和 [mysql] 部分（如上面的评论中所述）
*   使用 mysqli_real_connect 函数（[PHP 文档](http://php.net/manual/de/mysqli.real-connect.php)）。

问题在于，使用该功能，您可以显式启用对 LOAD DATA LOCAL INFILE 的支持。例如（程序风格）：

```
$link = mysqli_init();
mysqli_options($link, MYSQLI_OPT_LOCAL_INFILE, true);
mysqli_real_connect($link, $host, $username, $password, $database); 
```

或面向对象

```
$mysqli = mysqli_init();
$mysqli->options(MYSQLI_OPT_LOCAL_INFILE, true);
$mysqli->real_connect($host, $username, $password, $database); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-07-19T19:02:34.373

我知道这并不完全是 OP 所要求的，但由于这个线程已经很老了，而且这里提出的解决方案都不适合我，所以我决定分享这个。

如果有人在 MySql 版本 8 中启用 local_infile 时遇到问题，这里的命令对我有用：

```
SET PERSIST local_infile = 1; 
```

它将配置保留在“mysqld-auto.cnf”配置文件中，然后在服务或服务器重新启动后将记住更改。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-03-08T23:37:07.480

如果是 Mysql 5.7，您可以使用“显示全局变量，如“local_infile”；” 这将给出本地 infile 状态，您可以使用“set global local_infile=ON;”打开它。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-08-13T16:49:35.360

我使用了下面的方法，它**不需要对 config 进行任何更改**，在 mysql-5.5.51-winx64 和 5.5.50-MariaDB 上进行了测试：

将“加载数据...”放入 .sql 文件中（例如：LoadTableName.sql）

```
LOAD DATA INFILE 'D:\\Work\\TableRecords.csv' INTO TABLE tbl1 FIELDS TERMINATED BY ',' ENCLOSED BY '"' LINES TERMINATED BY '\r\n' IGNORE 1 LINES (col1,col2); 
```

然后：

```
mysql -uroot -pStr0ngP@ss -Ddatabasename -e "source D:\Work\LoadTableName.sql" 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-09-25T21:53:12.037

另一种方法是使用`mysqlimport`客户端程序。

您可以按如下方式调用它：

```
mysqlimport -uTheUsername -pThePassword --local yourDatabaseName tableName.txt 
```

这会生成一个`LOAD DATA`加载`tableName.txt`到`tableName`表中的语句。

请记住以下几点：

`mysqlimport`根据您提供的文件确定表名；使用从文件名开头到第一个句点的所有文本作为表名。因此，如果您希望将多个文件加载到同一个表中，您可以区分它们，例如`tableName.1.txt`，、`tableName.2.txt`...等。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-02-04T16:08:44.817

这对我来说有点奇怪，从一天到下一天，几天以来一直在工作的脚本就停止工作了。没有更新版本的 mysql 或任何类型的升级，但我遇到了同样的错误，所以我最后一次尝试 CSV 文件并注意到行尾使用 \n 而不是预期的（根据我的脚本) \r\n 所以我用正确的 EOL 保存它并再次运行脚本没有任何问题。

我觉得 mysql 告诉我这个 MySQL 版本不允许使用的命令有点奇怪，因为原因完全不同。

我的工作命令如下所示：

```
LOAD DATA LOCAL INFILE 'file-name' IGNORE INTO TABLE table-name CHARACTER SET latin1 FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '\"' LINES TERMINATED BY '\r\n' IGNORE 1 LINES. 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-05-07T19:57:47.723

我正在使用 xampp v3.2.4 和 mysql 服务器 8.0.20。

我添加`local-infile=1`到文件“my.ini”中`[mysql]`。`[mysqld]`该文件位于“C:\xampp\mysql\bin\my.ini”。

然后我使用以下代码从 csv 文件中插入数据`LOAD DATA INFILE ...`。移动本地很重要。否则它将无法正常工作。

感谢以上所有建议。我终于找到了一个组合。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-02-09T15:09:41.417

对于那些正在寻找使 LOAD DATA `LOCAL`INFILE 像我一样工作的答案的人来说，这可能会奏效。好吧，它对我有用，所以就这样吧。按照链接中的步骤安装[`percona`](http://www.percona.com/doc/percona-server/5.5/installation/apt_repo.html)为您的 mysql 服务器和客户端。安装过程中会提示输入密码，因此请提供一个您会记住并在以后使用的密码。安装完成后，重新启动系统并测试服务器是否已启动并运行，方法是`terminal`输入`mysql -u root -p`并输入密码。现在尝试运行命令`LOAD DATA LOCAL INFILE`..希望它有效:)

顺便说一句，我在 Ubuntu 12.04 上使用 Ruby 1.9.3 开发 Rails 2.3。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-09-03T21:26:46.510

好的，这里发生了一些奇怪的事情。要使其工作，不需要在 /etc/mysql/my.cnf 中进行任何配置更改。您需要做的就是在终端中重新启动当前的 mysql 服务：

```
sudo service mysql restart 
```

然后，如果我想“重新创建”错误，我只需重新启动 apache 服务：

```
sudo service apache2 restart 
```

然后可以通过输入以下命令再次修复它：

```
sudo service mysql restart 
```

因此，似乎 apache2 在启动时正在做一些不允许此功能的事情（如果重新启动 mysql 服务，则会反转/纠正）。

在基于 Debian 的发行版中有效。

```
service mysqld restart
service httpd restart 
```

在基于 RedHat 的发行版中有效

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-08-11T14:02:07.797

全部：显然这是按设计工作的。请参阅日期为 2019-7-23 的新参考手册，第 6.1.6 节，**LOAD DATA LOCAL 的安全问题**。**

# ruby-on-rails-3 - 如何在 Rails 中创建单例全局对象？

> ID：10762246
> 
> 赞同：26
> 
> 时间：2012-05-25T23:01:10.353
> 
> 标签：ruby-on-rails-3

我有一个对象，我想创建一次并在我的一个模型中访问。我把他放在哪里？恐怕如果我把他放在模型类文件中，每次我创建该模型的新实例时都会创建他。我只希望这个对象在启动时创建一次。这是对象：

```
require 'pubnub'    
publish_key   = 'fdasfs'
subscribe_key = 'sdfsdsf'
secret_key    = 'fsdfsd'
ssl_on        = false

pubnub_obj = Pubnub.new(publish_key,
                    subscribe_key,
                    secret_key,
                    ssl_on) 
```

我在模型中这样使用他：

```
class Message < ActiveRecord::Base

  def self.send_new_message_client(message)
    message = { 'some_data' => message }
    info = pubnub_obj.publish({
                            'channel' => 'testing',
                            'message' => message
                          })
    puts(info)
  end

end 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-05-25T23:13:50.217

在 Rails 中，每个请求都会重新创建对象。如果这是某种服务，它应该是请求范围内的单例。

应该使用 ruby​​ 单例 mixin 创建单例对象：

```
require 'singleton'

class Pubnub
  include Singleton

  def initialize(publish_key, subscribe_key, secret_key, ssl_on)
    # ...
  end

  def publish
    # ...
  end
end 
```

然后您可以使用以下`instance`方法调用它：

```
Pubnub.instance.publish 
```

这样你就可以确保这个对象实际上是一个单例（只有一个实例存在）。

您可以将它安全地放在`models`目录中，尽管我通常更喜欢该`lib`目录，或者可能为服务创建一个新目录。这取决于实际情况。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-25T23:24:51.737

如果您希望整个应用程序中只有一个实例，请使用单例，否则使用类变量。

要使用单例，请包含 Singleton mixin。

```
require 'singleton'

class Pubnub
  include Singleton

  attr_writer :publish_key, :subscribe_key, :secret_key, :ssl_on

  def publish
    #...
  end
end 
```

然后像这样使用它：

```
require 'pubnub'    
class Message < ActiveRecord::Base
  Pubnub.instance.publish_key = 'xyz'
  Pubnub.instance.subscribe_key = 'xyz'
  Pubnub.instance.secret_key = 'xyz'
  Pubnub.instance.ssl_on = 'xyz'

  def self.send_new_message_client(message)
    message = { 'some_data' => message }
    info = Pubnub.instance.publish({
                            'channel' => 'testing',
                            'message' => message
                          })
    puts(info)
  end
end 
```

您还可以将其设为类变量，以将其更紧密地链接到特定模型：

```
require 'pubnub'    
class Message < ActiveRecord::Base
    @@pubnub_obj = Pubnub.new('xyz', 'xyz', 'xyz', 'xyz')

  def self.send_new_message_client(message)
    message = { 'some_data' => message }
    info = @@pubnub_obj.publish({
                            'channel' => 'testing',
                            'message' => message
                          })
    puts(info)
  end

end 
```

# javascript - assistance needed to get started with QUnit for jQuery plugin

> ID：10762251
> 
> 赞同：0
> 
> 时间：2012-05-25T23:02:00.083
> 
> 标签：javascript, jquery, unit-testing, qunit

I have written a custom plugin with jQuery 1.7.2.

I would like to unit test my JavaScript going forward and think this is the perfect start for such. I have looked at different JavaScript unit testing frameworks and I have decided to go with QUnit.

Being new to this I would like some assistance. Firstly with the understanding as to how I might go about unit testing a jquery plugin? And secondly how I may "stub" DOM elements to test the plugin?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T12:45:09.347

请尝试 [http://qunitjs.com/](http://qunitjs.com/)

这值得一读。

# ant - Old solution not working for missing Tools.jar while building Portico on Red hat Linux using apache ant

> ID：10762254
> 
> 赞同：0
> 
> 时间：2012-05-25T23:02:34.593
> 
> 标签：ant, redhat, tools.jar

I have already done my homework before posting this question. I am trying to build Portico-1.0.2 on Red-Hat Linux 64 bit machine using apache ant. Initially I was setting JAVA_HOME path to jre-1.6.0_31/bin folder but it threw an error that : **Unable to locate tools.jar. Expected to find it in jre1.6.0_31/lib/tools.jar.**

Then after exploring stackoverflow I found few posts explaining to install jdk and set its folder as the JAVA_HOME path. So I have installed Jdk-1.6.0 in Redhat Linux and after installing jdk I located tools.jar file in it's lib folder. Now when I set the JAVA_HOME path to : /usr/lib/jvm/jre-1.6.0-openjdk.x86_64, it throws an error : **portico-1.0.2/codebase/build.xml:55: The JAVA_HOME environment variable must be set**

But I have set the JAVA_HOME in .bashrc file as follows :

```
JAVA_HOME=/usr/lib/jvm/jre-1.6.0-openjdk.x86_64
PATH=$JAVA_HOME:$PATH 
```

I am not sure what to do. Any advice on how to solve this problem.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T07:53:47.423

令人困惑的是，JDK 还包含一个 JRE，后者您已设置为 JAVA_HOME 从而重复您的问题......

[Red hat 文档](http://docs.redhat.com/docs/en-US/JBoss_Enterprise_Portal_Platform/5.1/html/Installation_Guide/Pre_Requisites-Configuring_Your_Java_Environment.html)描述了如何设置 JAVA_HOME

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-20T07:01:29.233

您好，打开根目录中的 bashrc 文件并将路径添加到您的 jdk，您就可以开始了..

例如

导出 JAVA_HOME=/usr/java/jdk1.6.0_19

导出 PATH=$PATH:$JAVA_HOME/bin

# php - 创建一个数据库类——在哪里存储凭证？

> ID：10762255
> 
> 赞同：0
> 
> 时间：2012-05-25T23:02:42.707
> 
> 标签：php, oop

使用需要使用公共 API 来访问数据库的移动应用程序（但这不会影响问题）。

无论如何，我将 PHP 与 MySQL 一起使用，Android/iPhone 应用程序将对 PHP 文件发出 POST 请求。我正在创建与数据库的连接，并想创建一个类来完成它。但是，我不确定在哪里放置数据库的实际登录凭据。

我在 webroot 之外看到了提到，所以它更安全。然后我应该在 /lib 中创建一个数据库类来处理连接并包含 config.inc.php 文件吗？还是你们推荐一些完全不同的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:05:35.187

你的提议在我看来完全没问题。一般来说，从安全的角度来看，在 Web 根目录之外使用正确配置的 Web 服务器的配置文件是完全可以的。

# javascript - JavaScript 配置管理器类

> ID：10762264
> 
> 赞同：2
> 
> 时间：2012-05-25T23:03:26.763
> 
> 标签：javascript, oop

我希望能够实例化一个 JavaScript 对象，如下所示：

```
var c = new MyConfig({
    'server': 'servername',
    'kfc': true,
    'code': true,
    'test': true
}); 
```

类似的东西。我希望各个属性可以通过以下方式使用：

```
c.getConfig('nfc'); which should return true / false etc. 
```

我对一些小东西感到困惑，比如我应该使用文字还是构造函数。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T23:05:45.173

你真的不需要一个特殊的构造函数；一个对象非常适合。

```
var c = {
    server: 'servername',
    kfc: true,
    code: true,
    test: true
}; 
```

要访问一个属性，它就像 一样简单`c.kfc`，或者`c['kfc']`如果您需要动态访问该属性。

# firefox - firefox vs webkit的行高低2px

> ID：10762267
> 
> 赞同：6
> 
> 时间：2012-05-25T23:03:52.893
> 
> 标签：firefox, webkit, css

我有以下CSS：

```
.btn_container {
cursor: pointer;
font-family: Tahoma,Verdana,Arial;
font-size: 11px;
padding: 0;
width: auto;
}

.btn_center {
background: blue;
color: #FFFFFF !important;
display: block;
float: left;
font-weight: bold;
height: 32px;
line-height: 32px;
padding: 0 10px;
} 
```

*在 Firefox 中的 line-height 为 30 行，但在 webkit 中为 32。*

我知道浏览器会以不同的方式呈现事物，但我从来没有遇到过让文本正确居中的问题。

在以下示例中，您可以看到它在 Firefox 中降低了几个像素：http: [//jsfiddle.net/mstefanko/EGzEB/5/](http://jsfiddle.net/mstefanko/EGzEB/5/)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-15T21:28:11.670

其实我有相反的经历。我注意到一些标题元素在 IE7/兼容模式以及 Chrome/Safari 中的位置更高。所以经过很多麻烦后，我用 chrome 检查并看到 -webkit-margin-before: 1.6em 或添加到标题中的东西。添加该值并对其进行调整不起作用，因为它影响了标题的高度，从而将一些元素向下推，但填充选项对我来说效果很好......

我发现这对我有用：

```
H1, H2, H3, H4, H5, a.mainTab div {
  -webkit-padding-before: 1px;
} 
```

a.mainTab div 的跨度不会响应填充/边距，因此将它们包装在 div 中......这也可能适用于 li span 跨度标题。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-15T21:52:49.010

我过去曾对此进行过大量测试。我称之为*文本抖动*。这不是你可以控制的。为了最小化它，你所能做的就是对每个文本元素应用一个显式的行高（尤其是一个以 px 为单位的行高）。

默认行高在不同的浏览器和不同字体大小的不同字体系列中相差很大。设置一个显式的 line-height 可以解决这个问题。

但在此范围内，无论您做什么，文本在行高空间内的确切位置都会因浏览器而异。对于字体大小和行高的某些组合，所有浏览器都匹配。例如，Arial在 FF、Webkit 和 IE 中呈现相同的内容`font-size:11px`。`line-height:14px`但是将 line-height 更改为 13px 或 15px，它会因 1px 浏览器而异。

它没有标准或定义的行为。这是特定字体系列、字体大小和行高恰好由该操作系统上的浏览器呈现的结果。例如，Arial 是一种相对一致的字体，只要定义了明确的 line-height，通常变化不会超过 1px，而 Helvetica 变化多达 4 到 6 个像素。

# javascript - need GPA and CGPA calculate code

> ID：10762268
> 
> 赞同：0
> 
> 时间：2012-05-25T23:03:57.437
> 
> 标签：javascript

i have some code but the code is missing some features.
1\. if we selected box, and than the calculation 2\. if we select value of yes on repeated course. how we calculate new gpa and cgpa ?

Script Code

```
<script type = "text/javascript">

//function to set the focus on GPA form 
function setFocus() { 
document.GPA.focus(); 
return; 
}

//functio to round 2 decimal points 
function round(n){return(.01* Math.round(100*n));}

//function to calculate gpa 
function calculate(fr) 
{ 

//checking if all credit hours equal to zero 
if (fr.CH1.selectedIndex=="0") 
{alert ("Please specify your credit hours") } 

else 

//calculating 
var resultgpa; 
fr.resultgpa.value=round((eval(fr.CH1.selectedIndex)*parseFloat(fr.grade1.value))
/(eval(fr.CH1.selectedIndex)))

var resultcgpa; 
fr.resultcgpa.value 
=round((eval(fr.CH1.selectedIndex)*parseFloat(fr.grade1.value)+ 
parseFloat(fr.cgpa.value)*parseFloat(fr.TCH.value)) 
/(eval(fr.CH1.selectedIndex)+ 
parseFloat(fr.TCH.value)))

}

</script> 
```

HTML Code:

```
<form action="none" name="GPA">
<table  width="700" border="3"  align="center" valign="top" > 
<!--creating form to send data to function--> 

    <tr><td><p align="center"style="font-size:16pt"><b>Select</b></p></td>
    <td><p align="center"style="font-size:16pt"><b>Courses</b></p></td>
    <td><p align="center"style="font-size:16pt"><b>Credit</b></p></td>
    <td><p align="center"style="font-size:16pt"><b>Expected/Grade</b></p></td>
    <td><p align="center"style="font-size:16pt"><b>Repeted Course</b></p></td>
    <td><p align="center"style="font-size:16pt"><b>Previous Grade</b></p></td></tr>

<tr> 
<td>1\. <input type="checkbox" text name="sn1"value="smoker"/></td>
<td><select name="c1">
<option value="unknown">Select</option>
<option>CPE 101</option>
<option>ENG 101</option>
<option>ECO 101</option>
<option>MAT 101</option>
<option>PHY 101</option>
<option>HTR 101</option>
<option>TUR 101</option>
<option>CPE 112</option>
<option>ENG 102</option>
<option>MAT 102</option>
<option>PHY 102</option>
<option>CHM 110</option>
<option>CPE 221</option>
<option>CLE 201</option>
<option>CLE 201</option>
<option>MAT 201</option>
<option>MAT 205</option>
<option>XXX XXX</option>
<option>CPE 222</option>
<option>ILE 224</option>
<option>ILE 212</option>
<option>ILE 232</option>
<option>MAT 204</option>
<option>CPE 313</option>
<option>CPE 321</option>
<option>CPE 331</option>
<option>CPE 351</option>
<option>CPE 341</option>
<option>CPE 326</option>
<option>CPE 332</option>
<option>CPE 342</option>
<option>CPE 324</option>
<option>CPE 322</option>
<option>CPE 411</option>
<option>CPE 413</option>
<option>CPE 415</option>
<option>CPE 400</option>
<option>CPE 414</option>
<option>CPE 415</option>
</select></td>
<td align = "center"> 
<select name= "CH1"> 
<option value = "0" SELECTED>Select 
<option value = "1">1 
<option value = "2">2 
<option value = "3">3 
<option value = "4">4

</select></td>

<td align = "center" width = "70"> 
<select name= "grade1"> 
<option value = "5" SELECTED>Select 
<option value = "4">A 
<option value = "3.70">A- 
<option value = "3.30">B+ 
<option value = "3">B 
<option value = "2.70">B- 
<option value = "2.30">C+ 
<option value = "2">C 
<option value = "1.70">C- 
<option value = "1.30">D+ 
<option value = "1">D
<option value = "0.7">D-  
<option value = "0">F
</select></td>

    <td> <center>
         <input type="radio" name="1">Yes
         <input type="radio" name="1">No
    </center></td>

<td align = "center"> 
<select name= "g1"> 
<option value = "5" SELECTED>Select 
<option value = "4">A 
<option value = "3.70">A- 
<option value = "3.30">B+ 
<option value = "3">B 
<option value = "2.70">B- 
<option value = "2.30">C+ 
<option value = "2">C 
<option value = "1.70">C- 
<option value = "1.30">D+ 
<option value = "1">D
<option value = "0.7">D-  
<option value = "0">F

</select></td>
</tr>
</table>
<table width="400" border="3" align="center" valign="top"> 

<tr> 
<td><p align="center"style="font-size:16pt"><b> Your Current CGPA:</b></p> </td><td align="right"><input type = text name="cgpa"></td></tr>

<tr><td><p align="center"style="font-size:16pt"><b>Your Credit Hours Taken Is:</b></p> </td><td align="right"><input type = text name="TCH"></td></tr>

</table>

<table width="400" border="3" align="center" valign="top"> 

<!--sending information to calculate() function-->

<!--getting back result from function--> 
<tr><td><p align="center"style="font-size:16pt"><b>Your GPA Will Be:</b></p></td> 
<td align="right"><input type = text name="resultgpa"></td></tr>

<!--getting back result from function--> 
<tr><td><p align="center"style="font-size:16pt"><b>Your CPGA Will Be:</b></p></td> 
<td align="right"><input type = text name="resultcgpa"></td></tr>

<tr><td><input type = "button" value = "Calculate!" onclick = "calculate(this.form)" name = "bottun"></td>

<!--reset button--> 
<td align="right"><input type="reset" name="reset" value="Clear">

</td></tr> 
</table>
</form> 
```

# php - SQL 查询不起作用和 PHP 问题

> ID：10762272
> 
> 赞同：-1
> 
> 时间：2012-05-25T23:04:10.090
> 
> 标签：php, sql, backend

我对 PHP 有点陌生，只将它用于我的 Android 应用程序的后端。

我有三个字符串要从我的 Android 应用程序发送到 PHP。我想查询一个名为“users”的表并找到从我的 Android 应用程序发送的用户名的用户 ID，然后将数据插入一个名为“msg”的单独表中。

我已经尝试了我的生活，但我无法让它发挥作用，而且我什至还没有完成。

谢谢和帮助我会非常棒，因为我是 PHP 新手，无法完成其余的代码。

PHP：

```
 <?php

$username = $_POST['username'];
$msg = $_POST['msg'];
$frienduser = $_POST ['frienduser'];

/*mysql data below */ 
$dbc = mysql_connect('localhost', 'removemypasswords', 'again');
if(!dbc) {
die("Something went wrong! Try again...");
}
/* select database */ 
$db_select = mysql_select_db("andagain, $dbc");
if (!db_select){
die("Can't connect :" .mysql_error);
}
$query = mysql_query("SELECT FROM users WHERE usernames ='$usernames'");
$query1 = mysql_query(INSERT INTO  `gtanews1_zips54`.`msg` (
`id` ,
`friendid` ,
`msg`
)
VALUES (
'$query',  '$frienduser',  'msg'
);
echo ($msg);

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:08:57.837

如何在 $query1 周围加上引号，例如

```
$query1 = mysql_query("INSERT INTO gtanews1_zips54.msg (`id` ,`friendid` ,`msg`)
VALUES ('$query',  '$frienduser',  'msg')"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T23:13:19.463

应该

```
$query = mysql_query("SELECT * FROM users WHERE usernames ='$username'");
$result = mysql_fetch_array($query);

$query1 = mysql_query("INSERT INTO gtanews1_zips54.msg (id,friendid,msg) VALUES ('" . $result['yourField'] . "', '$frienduser','$msg')"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T23:13:59.580

你的 mysql 选择数据库代码是错误的。你需要在逗号前加上引号

mysql_select_db("又一次", $dbc);

还要在查询末尾加上引号

```
$query = mysql_query("SELECT FROM users  WHERE usernames ='$usernames'"); $query1 = mysql_query(INSERT INTO `gtanews1_zips54`.`msg` ( `id` , `friendid` , `msg` ) VALUES ( '$query', '$frienduser', 'msg' )"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T23:14:46.687

这里有很多问题：

```
 <?php

$username = $_POST['username'];
$msg = $_POST['msg'];
$frienduser = $_POST ['frienduser'];

/*mysql data below */ 
$dbc = mysql_connect('localhost', 'removemypasswords', 'again');
if(!$dbc) {  //- You forgot the dollar $ sign on $dbc
die("Something went wrong! Try again...");
}
/* select database */ 
$db_select = mysql_select_db("andagain", $dbc);  //- You had the entire thing quoted, quotes are just around "andagain"
if (!db_select){
die("Can't connect :" .mysql_error());  //- You forgot the parentheses after mysql_error  
}
$query = mysql_query("SELECT FROM users WHERE usernames ='$usernames'");
//- You need to actually get the results out of the query object
$row = mysql_fetch_assoc($query);
if (!$row) {
    die('User not found');
}
$user_id = $row['id']; //- Or whatever the column is called
$query1 = mysql_query("INSERT INTO  `gtanews1_zips54`.`msg` (
`id` ,
`friendid` ,
`msg`
)
VALUES (
'$user_id',  '$frienduser',  'msg'
");   //- You forgot to put quotes around this query
echo ($msg);

?> 
```

这只是开始，可能还有其他问题，具体取决于您的数据库架构/数据传输格式。

此外，您对 SQL 注入持开放态度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-25T23:23:45.753

你的代码有很多错误。

> 1.  $db_select = mysql_select_db（再次，$dbc）；
> 2.  $query = mysql_query('SELECT FROM users WHERE usernames="$usernames"');

因为 Stackoverflow 不是修复代码错误的社区..所以我把这份工作留给你。

以下是一些可以帮助您解决所有错误的要点？

1.  变量替换不能使用单引号 (') 。双引号允许变量替换。
2.  为了在引号内转义引号，我们使用 \
3.  参数不能用双引号封装。

# perl - 如何在 Perl 中使用 STDIN？

> ID：10762275
> 
> 赞同：16
> 
> 时间：2012-05-25T23:04:16.077
> 
> 标签：perl

我通过管道输出几个脚本的输出。其中一个脚本输出由我的 perl 脚本处理的整个 HTML 页面。我希望能够将整个 58K 文本提取到 perl 脚本中（当然，其中将包含换行符）。

我认为这可能有效：

```
open(my $TTY, '<', '/dev/tty');

my $html_string= do { local( @ARGV, $/ ) = $TTY ; <> } ; 
```

但它只是没有做我需要的。有什么建议么？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-05-25T23:07:24.390

```
my @lines = <STDIN>; 
```

或者

```
my $str = do { local $/; <STDIN> }; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-05-22T14:09:20.537

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-06-02T11:20:59.817

tl;博士：见帖子底部。先解释一下。

## 实际例子

我只是想知道同样的事情，但我想要适合外壳单衬里的东西。原来这是（Korn shell，整个例子，下面剖析）：

```
print -nr -- "$x" | perl -C7 -0777 -Mutf8 -MEncode -e "print encode('MIME-Q', 'Subject: ' . <>);"; print 
```

解剖：

*   `print -nr -- "$x"``$x`在没有任何尾随换行符 ( `-n`) 或反斜杠转义 ( ) 的情况下回显整个`-r`POSIX 等效项：`printf '%s' "$x"`
*   `-C7`将*stdin*、*stdout*和*stderr*设置为 UTF-8 模式（您可能需要也可能不需要）
*   `-0777`设置`$/`以便 Perl 将 slurp 整个文件；参考：人[`perlrun(1)`](https://www.mirbsd.org/man/perlrun.1)
*   `-Mutf8 -MEncode`加载两个模块
*   剩下的就是 Perl 命令本身：`print encode('MIME-Q', 'Subject: ' . <>);`，让我们从内到外，从右到左看：
    *   `<>`获取整个*标准输入*内容
    *   它与字符串连接`"Subject: "`
    *   并通过`Encode::encode`要求它将其转换为 MIME Quoted-Printable
    *   结果打印在标准输出上（没有任何尾随换行符）
*   这之后是`; print`, 再次在 Korn shell 中，这与`; echo`在 POSIX shell 中相同——只是回显一个换行符。

## tl;博士

`perl`使用`-0777`选项调用。然后，在脚本内部，`<>`将包含整个*stdin*。

### 完整的独立示例

```
#!/usr/bin/perl -0777
my $x = <>;
print "Look ma, I got this: '$x'\n"; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-27T05:10:07.827

要将其转换为您想要的单个字符串：

```
#!/usr/bin/perl -w
use strict;

my $html_string;
while(<>){
   $html_string .= $_;
}

print $html_string; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-27T19:48:04.517

我一直使用裸块。

```
 my $x;
  {
    undef $/; # Set slurp mode
    $x = <>;  # Read in everything up to EOF
  }
  # $x should now contain all of STDIN 
```

# facebook - wp7中没有对话框的facebook登录

> ID：10762278
> 
> 赞同：0
> 
> 时间：2012-05-25T23:04:33.127
> 
> 标签：facebook, windows-phone-7

几个 WP7 应用程序（如官方 FB 应用程序）提供了自己的登录对话框，填写后您可以连接到 facebook。此外，当您稍后调用该应用程序时，您会自动登录。

一般来说，将加密的凭据存储在设备上是没有问题的。

我的问题 - 有人知道如何实现“官方 FB 应用程序”的功能吗？我四处搜寻 - 但除了“必须使用对话框/没有其他方法......”之外什么也没找到。

但肯定有办法——因为应用程序会这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T23:08:00.053

“官方 fb 应用程序”也需要身份验证。

“内置 facebook 支持”通过将你的 LiveID 连接到你的 facebook 来工作，当你第一次连接它时，你仍然给它你的凭据。

没有任何东西可以公开任何帐户（推特、链接等）的“内置”凭据

*你能想象如果任何应用程序都可以自动登录到其中任何一个应用程序并做任何他们想做的事情会发生什么吗？*

# r - 使用 KDD cup 99 数据集和 R 机器学习

> ID：10762282
> 
> 赞同：0
> 
> 时间：2012-05-25T23:04:37.667
> 
> 标签：r, machine-learning

我正在尝试将 KDD cup 99 数据集与 R 一起使用，但不幸的是，我得到了非常糟糕的结果。基本上，预测器是在猜测（交叉验证集上的误差约为 50%）。我的代码中可能有一个错误，但我找不到在哪里。

KDD cup 99 数据集由大约 400 万个示例组成，这些示例分为 4 个不同的攻击类别 + “正常”类别。首先，我将数据集拆分为 5 个文件（每个类一个 + “正常”类一个），然后将非数字数据转换为数字数据。目前，我正在学习“远程到本地”（r2l）课程。我根据有关该主题的论文的结果选择了一些特征。之后，我采样了一些与 r2l 实例数相等的“正常”实例，以避免出现倾斜类的问题。我还用标签“攻击”替换了不同类型的 r2l 攻击的所有标签，这样我就可以训练一个二类分类器。然后我将样本加入到一个新数据集中的 r2l 实例中。最后，

这是我的代码：

```
r2l <- read.table("kddcup_r2l.data",sep=",",header=T)
#u2r <- read.table("kddcup_u2r.data",sep=",",header=T)
#probe_original <- read.table("kddcup_probe.data",sep=",",header=T)
#dos <- read.table("kddcup_dos.data",sep=",",header=T)
normal <- read.table("kddcup_normal.data",sep=",",header=T)

#probe <- probe_original[sample(1:dim(probe_original)[1],10000),]

#   Features selected by the three algorithms svm, lgp and mars
#   for the different classes of attack
########################################################################

features.r2l.svm <- c("srv_count","service","duration","count","dst_host_count")
features.r2l.lgp <- c("is_guest_login","num_access_files","dst_bytes","num_failed_logins","logged_in")
features.r2l.mars <- c("srv_count","service","dst_host_srv_count","count","logged_in")
features.r2l.combined <- unique(c(features.r2l.svm,features.r2l.lgp,features.r2l.mars))

#       Sample the training set containing the normal labels
#       for each class of attack in order to have the same number 
#       of training data belonging to the "normal" class and the 
#       "attack" class
#######################################################################

normal_sample.r2l <- normal[sample(1:dim(normal)[1],dim(r2l)[1]),]

# This part was useful before the separation normal/attack because 
# attack was composed of different types for each class
######################################################################

normal.r2l.Y <- matrix(normal_sample.r2l[,c("label")]) 

#######################################################################
#       Class of attack Remote to Local (r2l)
#######################################################################

#   Select the features according to the algorithms(svm,lgp and mars)
#   for this particular type of attack. Combined contains the 
#   combination of the features selected by the 3 algorithms  
#######################################################################
#features.r2l.svm <- c(features.r2l.svm,"label")
r2l_svm <- r2l[,features.r2l.svm]
r2l_lgp <- r2l[,features.r2l.lgp]
r2l_mars <- r2l[,features.r2l.mars]
r2l_combined <- r2l[,features.r2l.combined]
r2l_ALL <- r2l[,colnames(r2l) != "label"]

r2l.Y <- matrix(r2l[,c("label")])
r2l.Y[,1] = "attack"

#   Merge the "normal" instances and the "r2l" instances and shuffle the result
############################################################################### 

r2l_svm.tr <- rbind(normal_sample.r2l[,features.r2l.svm],r2l_svm)
r2l_svm.tr <- r2l_svm.tr[sample(1:nrow(r2l_svm.tr),replace=F),]
r2l_lgp.tr <- rbind(normal_sample.r2l[,features.r2l.lgp],r2l_lgp)
r2l_lgp.tr <- r2l_lgp.tr[sample(1:nrow(r2l_lgp.tr),replace=F),]
r2l_mars.tr <- rbind(normal_sample.r2l[,features.r2l.mars],r2l_mars)
r2l_mars.tr <- r2l_mars.tr[sample(1:nrow(r2l_mars.tr),replace=F),]
r2l_ALL.tr <- rbind(normal_sample.r2l[,colnames(normal_sample.r2l) != "label"],r2l_ALL)
r2l_ALL.tr <- r2l_ALL.tr[sample(1:nrow(r2l_ALL.tr),replace=F),]

r2l.Y.tr <- rbind(normal.r2l.Y,r2l.Y)
r2l.Y.tr <- matrix(r2l.Y.tr[sample(1:nrow(r2l.Y.tr),replace=F),])

#######################################################################
#
#       10-fold CROSS-VALIDATION to assess the models accuracy
#
####################################################################### 

# CV for Remote to Local
########################    
cv(r2l_svm.tr, r2l_lgp.tr, r2l_mars.tr, r2l_ALL.tr, r2l.Y.tr) 
```

和交叉验证功能：

```
cv <- function(svm.tr, lgp.tr, mars.tr, ALL.tr, Y.tr){  

Jcv.svm_mean <- NULL

#Compute the size of the cross validation
# =======================================
index=sample(1:dim(svm.tr)[1])
size.CV<-floor(dim(svm.tr)[1]/10)

Jcv.svm <- NULL

#Start 10-fold Cross validation
# =============================
for (i in 1:10) {
    #   if m is the size of the training set 
    #   (nr of rows in svm.tr for example)
    #   take n observations for test and (m-n) for training
    #   with n << m (here n = m/10)
    # ===================================================
    i.ts<-(((i-1)*size.CV+1):(i*size.CV))   
    i.tr<-setdiff(index,i.ts)

    Y.tr.tr <- as.factor(Y.tr[i.tr])    
    Y.tr.ts <- as.factor(matrix(Y.tr[i.ts],ncol=1))

    svm.tr.tr <- svm.tr[i.tr,]
    svm.tr.ts <- svm.tr[i.ts,]  

    # Get the model for the algorithms 
    # ==============================================

    model.svm <- svm(Y.tr.tr~.,svm.tr.tr,type="C-classification")

    # Compute the prediction 
    # ==============================================
    Y.hat.ts.svm <- predict(model.svm,svm.tr.ts)

    # Compute the error 
    # ==============================================

    h.svm <- NULL

    h.svm <- matrix(Y.hat.ts.svm,ncol=1)

    Jcv.svm <- c(Jcv.svm ,sum(!(h.svm == Y.tr.ts))/size.CV)
    print(table(h.svm,Y.tr.ts)) 

}

Jcv.svm_mean <- c(Jcv.svm_mean, mean(Jcv.svm))

d <- 10
print(paste("Jcv.svm_mean: ", round(Jcv.svm_mean,digits=d) ))   
} 
```

我得到了非常奇怪的结果。该算法似乎并没有真正看到实例之间的任何差异。这看起来更像是猜测而不是预测。我也尝试过使用“探测”类攻击，但得到了相同的结果。我之前提到的论文在 r2l 类上的准确率为 30%，在探针上的准确率为 60-98%（取决于多项式次数）。

这是交叉验证的 10 折之一的预测：

h.svm(attack) & Y.tr.ts(attack) --> 42 个实例

h.svm(attack) & Y.tr.ts(normal.) --> 44 个实例

h.svm(normal.) & Y.tr.ts(attack) --> 71 个实例

h.svm(normal.) & Y.tr.ts(normal.) --> 68 个实例

如果有人能告诉我我的代码有什么问题，我将不胜感激。

先感谢您

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T09:58:43.743

无法确定这是否是您的问题，但该数据集存在已知问题。 [http://www.brggerink.com/~zow/GradSchool/KDDCup99Harmful.html](http://www.bruggerink.com/~zow/GradSchool/KDDCup99Harmful.html) 抱歉，我无法帮助编写代码，我不知道 R :/

# r - 如何使用带有 ggplot2 和刻度的指数来格式化轴标签？

> ID：10762287
> 
> 赞同：29
> 
> 时间：2012-05-25T23:05:02.177
> 
> 标签：r, ggplot2

使用新版本的 ggplot2 和刻度，我无法弄清楚如何以科学计数法获得轴标签。例如：

```
x <- 1:4
y <- c(0, 0.0001, 0.0002, 0.0003)

dd <- data.frame(x, y)

ggplot(dd, aes(x, y)) + geom_point() 
```

给我

![带有刻度的示例 ggplot](../Images/abe5f542717557ea9a1fb39f2920b21d.png)

我希望轴标签为 0、5 x 10^-5、1 x 10^-4、1.5 x 10^-4 等。我无法弄清楚`scale_y_continuous()`和的正确组合`math_format()`（至少我认为这些是我需要的）。

`scale_y_log10()`log 转换轴，这是我不想要的。`scale_y_continuous(label = math_format())`只给我 10^0、10^5e-5 等。我明白为什么后者会给出这个结果，但这不是我想要的。

我正在使用 ggplot2_0.9.1 和 scales_0.2.1

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-08-30T10:20:24.663

我改编了布赖恩的回答，我想我得到了你想要的。

只需将 parse() 添加到 science_10() 函数（并将 'x' 更改为正确的 'times' 符号），您最终会得到：

```
x <- 1:4
y <- c(0, 0.0001, 0.0002, 0.0003)

dd <- data.frame(x, y)

scientific_10 <- function(x) {
  parse(text=gsub("e", " %*% 10^", scales::scientific_format()(x)))
}

ggplot(dd, aes(x, y)) + geom_point()+scale_y_continuous(label=scientific_10) 
```

![在此处输入图像描述](../Images/ac3faed5034829100ecf74e8449b0135.png)

您可能仍然希望使函数更智能，以便更优雅地处理 0，但我认为就是这样！

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-08-30T06:48:12.853

根据对已接受解决方案的评论，OP 正在寻求将指数格式化为指数。这可以通过*scales*包中的`trans_format`和`trans_breaks`函数来完成：

 *```
 library(ggplot2)
    library(scales)

    x <- 1:4
    y <- c(0, 0.0001, 0.0002, 0.0003)
    dd <- data.frame(x, y)

    ggplot(dd, aes(x, y)) + geom_point() +
    scale_y_log10("y",
        breaks = trans_breaks("log10", function(x) 10^x),
        labels = trans_format("log10", math_format(10^.x))) 
```

[![在此处输入图像描述](../Images/2d99eeb0830f0564eab8e43798ad867e.png)](https://i.stack.imgur.com/fq9uF.png)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-05-25T23:23:15.100

```
scale_y_continuous(label=scientific_format()) 
```

给出带有 e 而不是 10 的标签：

![在此处输入图像描述](../Images/8cfe7162e56e33607f3154e6637bd636.png)

我想如果你真的想要 10 个，你可以把它包装在另一个函数中。

```
scientific_10 <- function(x) {
  gsub("e", " x 10^", scientific_format()(x))
}

ggplot(dd, aes(x, y)) + geom_point() + 
  scale_y_continuous(label=scientific_10) 
```

![在此处输入图像描述](../Images/c5ce7c8879f6dc1d439d3f3c98f93975.png)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-08-24T16:49:57.000

摆脱上面汤姆的回答，以下内容删除了 + 符号，并更好地处理 0 （该函数也是匿名内联的）：

```
scale_y_continuous(label= function(x) {ifelse(x==0, "0", parse(text=gsub("[+]", "", gsub("e", " %*% 10^", scientific_format()(x)))))} ) + 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-05-22T19:27:07.283

我写了一个避免使用 scales 包的 science_10 版本；它还删除了指数中的前导零（10^04 到 10^4 等）。这是根据上面给出的有用答案改编的。

我还在下面包含了包装缩放功能。

```
scientific_10 <- function(x) {
    xout <- gsub("1e", "10^{", format(x),fixed=TRUE)
    xout <- gsub("{-0", "{-", xout,fixed=TRUE)
    xout <- gsub("{+", "{", xout,fixed=TRUE)
    xout <- gsub("{0", "{", xout,fixed=TRUE)
    xout <- paste(xout,"}",sep="")
    return(parse(text=xout))
}

scale_x_log10nice <- function(name=NULL,omag=seq(-10,20),...) {
    breaks10 <- 10^omag
    scale_x_log10(name,breaks=breaks10,labels=scientific_10(breaks10),...)
}

scale_y_log10nice <- function(name=NULL,omag=seq(-10,20),...) {
    breaks10 <- 10^omag
    scale_y_log10(name,breaks=breaks10,labels=scientific_10(breaks10),...)
}

scale_loglog <- function(...) {
    list(scale_x_log10nice(...),scale_y_log10nice(...))
}

qplot(x=exp(5*rnorm(100)),geom="density",kernel="rectangular") + 
    scale_x_log10nice() 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2021-05-26T09:48:10.473

我认为使用出色的`ggtext`-package 变得非常容易。我所做的是：

```
library(ggplot)
library(ggtext)
ggplot(mtcars, aes(x = log10(mpg), y = wt)) +
  geom_point() +
  scale_x_continuous(labels = function(x){return(paste0("10^", x))}) +
  theme(
    axis.text.x = element_markdown()
  ) 
```

[![在此处输入图像描述](../Images/76575e87a881620bec49bff0ba03dafd.png)](https://i.stack.imgur.com/i8djx.png)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-09-15T14:28:45.647

合并前面的答案，我创建了一个函数，可以将 x 和 y 的任意十倍幂作为乘法因子，然后创建在轴附近添加因子的图

[![在此处输入图像描述](../Images/41c927321cd0336def969b138e33bec9.png)](https://i.stack.imgur.com/V0DXK.jpg)

```
library(ggplot2)
x <- seq(1,25)
y <- rnorm(25)/10000
dd <- data.frame(x, y)

trim10 <- function(x) {
  parse(text=gsub(".*e", "x10^", scales::scientific_format()(x)))
}

ggplot_trim10 <- function(x,y,xfac,yfac,...){

    xnew    <- x*xfac 
    ynew    <- y*yfac 

    dd      <- data.frame(xnew,ynew)

    xunit   <- abs(max(xnew) - min(xnew))
    yunit   <- abs(max(ynew) - min(ynew))

    x_min_label <- min(xnew) - xunit*0.1
    x_max_label <- max(xnew) - xunit*0.1
    y_min_label <- min(ynew) - yunit*0.1
    y_max_label <- max(ynew) - yunit*0.1

    ggplot(data=dd, aes(x=xnew, y=ynew),...) +
    geom_line() +
    annotate("text", x = x_max_label, y = y_min_label, label = trim10(xfac)) +
    annotate("text", x = x_min_label, y = y_max_label, label = trim10(yfac)) +
    coord_cartesian(xlim = c(min(xnew), max(xnew)),ylim = c(min(ynew),max(ynew)), clip = "off")
    }

ggplot_trim10(x,y,10,10) 
```

作为注释，我知道“x”不是正确的符号，但我有点疯狂地混合`expression`等等`paste`。如果有人能修复它，那就太好了*

# node.js - node.js 如何限制虚拟内存的使用？

> ID：10762291
> 
> 赞同：6
> 
> 时间：2012-05-25T23:05:31.847
> 
> 标签：node.js, embedded, virtual-memory, limiting

我在资源非常有限的嵌入式环境中工作。我们正在尝试使用 node.js，它运行良好，但通常会消耗大约 60 兆字节的虚拟内存（实际使用的内存大约为 5 兆字节。）鉴于我们的限制，这是太多的虚拟内存；我们最多只能允许 node.js 使用大约 30 兆字节的 VM。

node.js 有几个命令行选项，例如“--max_old_space_size”、“--max_executable_size”和“--max_new_space_size”，但经过实验，我发现这些都是控制实际内存使用量，而不是最大虚拟内存内存大小。

如果重要的话，我正在使用 ARM 架构上的 ubuntu linux 变体。

是否有任何选项或设置允许设置 node.js 进程允许使用的最大虚拟内存量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T00:11:54.657

您可以使用[softlimit](http://cr.yp.to/daemontools/softlimit.html)来执行大小有限的节点。或者您可以直接使用Linux 的[setrlimit](http://linux.die.net/man/2/setrlimit)，但不确定如何从 NodeJS 调用它，请参阅[这个 SO question](https://stackoverflow.com/questions/4443597/node-js-execute-system-command-synchronously)

# iphone - 你如何只在 UIView 的填充之外显示阴影？

> ID：10762292
> 
> 赞同：14
> 
> 时间：2012-05-25T23:05:32.580
> 
> 标签：iphone, ios, cocoa-touch

我有一个带有半透明填充和阴影的 UIView。由于填充是半透明的，我可以看到填充后面的阴影。

```
- (id)init
{
    self = [super init];
    if (self) {
        self.backgroundColor = [UIColor colorWithWhite:1.0 alpha:0.8];
        self.layer.shadowColor = [UIColor blackColor].CGColor;
        self.layer.shadowOffset = CGSizeMake(0.0, 0.0);
        self.layer.shadowOpacity = 0.5;
        self.layer.shadowRadius = 2.0;
        self.layer.cornerRadius = 3.0;
    }
    return self;
} 
```

我不喜欢这种行为。我看不到视图后面的任何东西，因为填充的不透明度 + 阴影的不透明度 > 100%。如何让它像 CSS 一样，阴影只绘制在框的边框之外？

```
.someStyle {
   background: white;
   opacity: 0.8;
   box-shadow: 0 0 1em rgba(0,0,0,0.5);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T20:08:40.897

我能够使用以下内容获得这种预期的效果：

```
...
someLayer.backgroundColor = [[UIColor greenColor] CGColor];
someLayer.shadowOpacity = 1.0;
someLayer.shadowOffset = CGSizeMake(10.0, 10.0);
someLayer.shadowColor = [[UIColor blackColor] CGColor];

someLayer.rasterizationScale = [[UIScreen mainScreen] scale];
someLayer.shouldRasterize = YES;
someLayer.opacity = 0.5;

[[self layer] addSublayer:someLayer]; 
```

# glsl - GLSL - 点积真的只需要一个周期吗？

> ID：10762297
> 
> 赞同：11
> 
> 时间：2012-05-25T23:06:15.000
> 
> 标签：glsl, shader, gpgpu

我遇到过几种情况，声称在 GLSL 中做点积最终会在一个周期内运行。例如：

> > > 顶点和片段处理器在四个向量上运行，在单个周期内执行四分量指令，例如加法、乘法、乘法累加或点积。

[http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter35.html](http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter35.html)

我还在某处的评论中看到了这样的说法：

```
 dot(value, vec4(.25)) 
```

与以下相比，将是平均四个值的更有效方法：

```
 (x + y + z + w) / 4.0 
```

同样，声称 dot(vec4, vec4) 将在一个周期内运行。

我看到 ARB[说点积（DP3 和 DP4）和叉积（XPD](http://en.wikipedia.org/wiki/ARB_%28GPU_assembly_language%29)是单指令，但这是否意味着它们的计算成本与执行 vec4 加法一样？基本上有一些硬件实现，类似于类固醇上的乘法累加，在这里发挥作用？我可以看到类似的东西在计算机图形学中是如何有用的，但是在一个周期内完成可能是相当多的指令听起来很多。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-25T23:39:43.440

这个问题不能以任何明确的方式作为一个整体来回答。任何操作在硬件中需要多长时间不仅是特定于硬件的，而且是特定于*代码的*。也就是说，周围的代码可以完全掩盖操作所需的性能，或者它可以使其花费更长的时间。

通常，您不应假设点积是单周期的。

但是，有些方面肯定可以回答：

> 我还在某处的评论中看到了这样的说法：
> 
> 与以下相比，将是平均四个值的更有效方法：

我希望这是真的，只要`x`, `y`, `z`, and`w`实际上是不同的浮点值而不是相同的成员`vec4`（也就是说，它们不是`value.x`,`value.y`等）。如果它们是同一向量的元素，我会说任何体面的优化编译器都应该将它们编译为同一组指令。一个好的[窥视孔优化器](http://en.wikipedia.org/wiki/Peephole_optimizer)应该能捕捉到这样的模式。

我说它“有点真实”，因为它取决于硬件。点积版本至少应该不会*更慢*。同样，如果它们是同一向量的元素，优化器应该处理它。

> 单条指令，但这是否意味着这些指令的计算成本与执行 vec4 加法一样昂贵？

您不应假设 ARB 程序集与实际的硬件机器指令代码有*任何关系。*

> 基本上有一些硬件实现，沿着类固醇的乘法累加线，在这里玩吗？

如果你想谈论硬件，它是非常特定于硬件的。曾几何时，有专门的点积硬件。这是在所谓的“DOT3 凹凸贴图”和早期 DX8 着色器时代的时代。

但是，为了加快一般的行动，他们不得不把那种东西拿出来。所以现在，对于大多数现代硬件（又名：任何 Radeon HD 级或 NVIDIA 8xxx 或更好的硬件。所谓的 DX10 或 11 硬件），点产品的功能与他们所说的差不多。每个乘法/加法占用一个周期。

但是，此硬件还允许大量并行性，因此您可以*同时发生*`vec4`4 个独立的点积。每个需要 4 个周期。但是，只要这些操作的结果不被其他人使用，它们都可以并行执行。因此，它们四个总共需要 4 个周期。

 *再说一遍，这很复杂。并且依赖于硬件。

你最好的选择是从*合理*的开始。然后了解您尝试编写代码的硬件，并从那里开始工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-03-08T08:16:26.267

Nicol Bolas 从“ARB 组装”或查看 IR 转储的角度处理了实际答案。我将解决这个问题*“4 个倍数和 3 个加法怎么可能是一个硬件周期？！这听起来不可能。”* .

使用繁重的流水线，无论多么复杂，都可以使*任何*指令具有一个周期的吞吐量。

不要将此与一个延迟周期混淆！

通过完全流水线执行，一条指令可以分散到流水线的多个阶段。管道的所有阶段同时运行。

每个周期，第一阶段接受一条新指令，其输出进入下一个阶段。每个循环，一个结果从管道的末端出来。

让我们检查一个 4d 点积，假设内核具有 3 个周期的乘法延迟和 5 个周期的相加延迟。

如果这条管道以最糟糕的方式布置，没有向量并行性，它将是 4 次乘法和 3 次加法，总共有 12+15 个周期，总延迟为 27 个周期。

这是否意味着一个点积需要 27 个周期？绝对不是，因为它可以在每个周期开始一个新的，并在 27 个周期后得到答案。

如果您需要做一个点积并且必须等待答案，那么您将不得不等待完整的 27 个周期延迟才能得到结果。但是，如果要计算 1000 个单独的点积，则需要 1027 个周期。前 26 个循环，没有结果，第 27 个循环第一个结果出来结束，第 1000 个输入发出后，又花了 26 个循环，最后一个结果出来结束。这使得点积采取“一个周期”。

真正的处理器以各种方式将工作分布在各个阶段，提供或多或少的流水线阶段，因此它们的数量可能与我上面描述的完全不同，但想法保持不变。通常，每个阶段所做的工作越少，时钟周期就越短。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-15T18:15:04.497

关键是 vec4 可以在一条指令中“操作”（参见英特尔在 16 字节寄存器操作上所做的工作，也就是 IOS 加速框架的大部分基础）。

如果您开始拆分和拆分向量，则将不再有向量的“单个内存地址”来执行操作。*

# c++ - 采用 STL 风格迭代器的 C++ 虚方法

> ID：10762308
> 
> 赞同：7
> 
> 时间：2012-05-25T23:07:55.467
> 
> 标签：c++, templates, stl, iterator, virtual

我想要一个接口 ModelGenerator，它有一个方法 generate()，它接受一个可迭代的证据列表并创建一个模型。使用 STL 伪鸭类型迭代器习惯用法...

```
template<class Model>
class ModelGenerator {
  public:
    template<class Iterator>
    virtual bool generate(Iterator begin, Iterator end, Model& model) = 0;
}; 
```

但是虚函数不能被模板化。所以我必须对整个班级进行模板化：

```
template<class Model, class Iterator>
class ModelGenerator {
  public:
    virtual bool generate(Iterator begin, Iterator end, Model& model) = 0;
}; 
```

理想情况下，我想做的是这样的......

```
template<class Model, class Evidence>
class ModelGenerator {
  public:
    virtual bool generate(iterator<Evidence>& begin,
                          iterator<Evidence>& end,
                          Model& model) = 0;
}; 
```

但是没有迭代器继承的接口。（std::iterator 类只包含一堆 typedef，没有方法。）

我能想到的唯一方法是给 ModelGenerator 一个方法 addEvidence()，在调用 generate() 之前将它们一个一个添加，但是我必须给 ModelGenerator 状态，这有点痛苦。

如何编写一个采用任何 STL 容器的虚拟方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T23:10:02.657

你似乎需要一个`any_iterator`. 这是一个执行类型擦除以将您与实际迭代器实现隔离的迭代器。

Adobe 有一个实现`any_iterator`： [http ://stlab.adobe.com/classadobe_1_1any__iterator.html](http://stlab.adobe.com/classadobe_1_1any__iterator.html)

Boost有一个实现`any_range`： http: [//www.boost.org/doc/libs/1_49_0/libs/range/doc/html/range/reference/ranges/any_range.html](http://www.boost.org/doc/libs/1_49_0/libs/range/doc/html/range/reference/ranges/any_range.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T03:51:36.830

为此，您可以考虑使用模板专业化而不是虚拟方法。据我了解，您有一个独特的证据类，许多不同的模型类，并且想要创建一个通用工厂以从一系列证据中生成选定的模型。

```
#include <vector>
#include <iostream>

struct Model1 { };
struct Model2 { };
struct Evidence { };

template<class Model>
struct ModelGenerator;

template<>
struct ModelGenerator<Model1>
{
    typedef Model1 model_type;

    template<class Iterator>
    model_type generate(Iterator begin, Iterator end)
    {
        std::cout << "Generate Model1\n";
        return model_type();
    }
};

template<>
struct ModelGenerator<Model2>
{
    typedef Model2 model_type;

    template<class Iterator>
    model_type generate(Iterator begin, Iterator end)
    {
        std::cout << "Generate Model2\n";
        return model_type();
    }
};

template<class Model, class Iterator>
Model make_model(Iterator begin, Iterator end)
{
    ModelGenerator<Model> gen;
    return gen.generate(begin, end);
} 
```

你可以这样使用它：

```
int main()
{
    std::vector<Evidence> v;

    Model1 m1 = make_model<Model1>(v.begin(), v.end());
    Model2 m2 = make_model<Model2>(v.begin(), v.end());
} 
```

# javascript - JavaScript + 递归函数返回未定义

> ID：10762312
> 
> 赞同：3
> 
> 时间：2012-05-25T23:08:52.003
> 
> 标签：javascript, recursion

我有一个需要遍历的简单 html 结构。出于某种原因，我的递归函数在任何嵌套节点上返回“未定义”，但对父节点不返回。不幸的是，这需要是本机 js，没有 jQuery。谢谢！

**HTML：**

```
<div id="container">
  <div id="head"> 
    <span id="left"><</span> 
    <span id="right">></span> 
  </div>
</div> 
```

**脚本：**

```
var h = hasId(container, 'head');
var l = hasId(container, 'left');
var r = hasId(container, 'right');

console.log(h + " : " + r + " : " + l);
//[object HTMLDivElement] : undefined : undefined

function hasId(ele, id) {
    for (var i = 0; i < ele.childNodes.length; i++) {
        var child = ele.childNodes[i];
        if(child.id == id) return child;
        else hasId(child, id);
    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-25T23:14:31.343

您只是对`return`递归调用的调用。此外，您应该测试其结果是否已定义。如果是，您可以返回它，如果不是，则继续循环。

```
var h = hasId(container, 'head');
var l = hasId(container, 'left');
var r = hasId(container, 'right');

console.log(h + " : " + r + " : " + l);
//[object HTMLDivElement] : undefined : undefined

function hasId(ele, id) {
    for (var i = 0; i < ele.childNodes.length; i++) {
        var child = ele.childNodes[i];
        if(child.id == id) return child;
        else {
          var next = hasId(child, id);
          if(next) return next;
        };
    }
}​ 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-25T23:11:54.860

该`else`子句应该`return`是 的值`hasId(child, id)`，但前提是该值本身已定义，否则它必须继续循环。

没有 a`return`函数将递归，但不给出答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T23:15:02.730

你可以像这样修复它：

```
var h = hasId(container, 'head');
var l = hasId(container, 'left');
var r = hasId(container, 'right');

console.log(h + " : " + r + " : " + l);

function hasId(ele, id) {
    for (var i = 0; i < ele.childNodes.length; i++) {
        var child = ele.childNodes[i];
        if(child.id == id || (child = hasId(child, id))){
           return child;
        }
    }
    return false;
} 
```

# web-services - org.apache.axis2.AxisFault：第一个元素必须包含本地名称 Envelope ，但找到了定义

> ID：10762314
> 
> 赞同：7
> 
> 时间：2012-05-25T23:09:01.257
> 
> 标签：web-services, websphere, axis2

请求在我的本地环境中运行良好，但在部署的环境中不起作用。尝试了包括soapui在内的各种客户的请求。代码部署在 WAS 上

轴 2

```
org.apache.axis2.AxisFault: First Element must contain the local name, Envelope , but found definitions
    at org.apache.axis2.AxisFault.makeFault(AxisFault.java:430)
    at org.apache.axis2.transport.TransportUtils.createSOAPMessage(TransportUtils.java:123)
    at org.apache.axis2.transport.TransportUtils.createSOAPMessage(TransportUtils.java:67)
    at org.apache.axis2.description.OutInAxisOperationClient.handleResponse(OutInAxisOperation.java:354)
    at org.apache.axis2.description.OutInAxisOperationClient.send(OutInAxisOperation.java:417)
    at org.apache.axis2.description.OutInAxisOperationClient.executeImpl(OutInAxisOperation.java:229)
    at org.apache.axis2.client.OperationClient.execute(OperationClient.java:165)
    at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1604)
Caused by: org.apache.axiom.soap.SOAPProcessingException: First Element must contain the local name, Envelope , but found definitions
    at java.lang.Throwable.<init>(Throwable.java:67) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-21T15:11:18.147

这是服务器未返回预期的 xml 响应格式的问题。这可能是由于使用了不正确的服务端点 URL 造成的。

要解决此问题，请确保您的 Axis 代码中使用的 URL 与您的代码所基于的 WSDL 中的端点的 URL 相匹配。

WSDL 中的位置：

```
 <service name="ServiceName">
      <port name="PortName" binding="typens:PortNameBinding">
        <soap:address location="http://yourdomain.com/api/soap/"/>
      </port>
    </service> 
```

代码中的相应位置通常在`ServiceNameStub`类中的两个位置找到：

```
 /**
     * Default Constructor
     */
    public ServiceNameStub(
            org.apache.axis2.context.ConfigurationContext configurationContext)
            throws org.apache.axis2.AxisFault {

        this(configurationContext,
                "http://yourdomain.com/api/soap/");

    }

    /**
     * Default Constructor
     */
    public ServiceNameStub() throws org.apache.axis2.AxisFault {

        this("http://yourdomain.com/api/soap/");

    } 
```

只需确保这两个 URL 与您在 WSDL 文件中的服务端口的 soap:address 中找到的 URL 相匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-02T09:49:29.103

是的，我遇到了同样的问题，并通过使用端点 URL 更改 WSDL 来解决它。我更新了如何在下面找到端点 URL：

a) 在 Web 浏览器中打开 WSDL 文件。b) 在“wsdl:port”标签下找到“soap:address”。c) 复制并粘贴客户端代码中位置旁边的 URL。

而已。

# url - http://mydomain.com/me@mail.com 可以安全地用作 URL 吗？

> ID：10762318
> 
> 赞同：0
> 
> 时间：2012-05-25T23:09:39.150
> 
> 标签：url, rfc3986

我考虑设置一个服务器来处理包括电子邮件地址在内的 URL，例如

```
http://mydomain.com/me@mail.com 
```

根据 RFC 3986，我的用户立场 @ 在权限部分 = //mydomain.com/ 上保留，但在路径部分 /....... 上未保留，所以目前我认为可以在传递时使用电子邮件地址。

话虽如此，我仍然不确定 在生产中使用[http://mydomain.com/me@mail.com是否安全。](http://mydomain.com/me@mail.com)

请指教。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:40:42.207

`@`很好——您对 RFC 的解释是正确的，并且在 URI 部分中使用 an 没有“风险”（就浏览器做错事而言） 。

# c# - 动画属性并查看它何时在后面的代码中更改

> ID：10762319
> 
> 赞同：0
> 
> 时间：2012-05-25T23:10:01.627
> 
> 标签：c#, wpf, storyboard, dependency-properties

我经常需要为一些不属于 wpf 视图的东西设置动画，例如我的计算机的音量或鼠标的位置。我想通过使用 wpf 故事板和内置缓动功能来做到这一点。

例如，假设我想使用以下情节提要在我的计算机上制作动画（减小音量）：

```
<Storyboard x:Key="Storyboard1">
        <DoubleAnimationUsingKeyFrames 
                     Storyboard.TargetProperty="someProperty"  
                     Storyboard.TargetName="SomeTarget">
            <EasingDoubleKeyFrame KeyTime="0:0:1" Value="0">
                <EasingDoubleKeyFrame.EasingFunction>
                    <CircleEase EasingMode="EaseOut"/>
                </EasingDoubleKeyFrame.EasingFunction>
            </EasingDoubleKeyFrame>
        </DoubleAnimationUsingKeyFrames>
</Storyboard> 
```

在我后面的代码中，我使用以下函数设置音量：

```
 MyVolumeController.SetVolume(0); 
```

* * *

因此，我想创建一个看起来像这样的函数：（注意该函数是某种伪代码）

```
 public void AnimateProperty(Storyboard sb, Action<double> onPropertyChange)
 {
      var property = //sb.targetProperty;

      property.OnValueChanged += (a,b)=>{

           onPropertyChange(b.newValue);

      }

      sb.begin();// start animating

 } 
```

然后我可以通过调用该方法为音量设置动画：

```
 AnimateProperty(
           (Storyboard)this.FindResource("Storyboard1"), // storyboard
           (newVal)=>{MyVolumeController.SetVolume(newVal) // action
  ); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T06:46:54.100

如果您想为属性设置动画并在动画运行时收到有关值更改的通知，您必须将该属性设置为依赖属性，并通过依赖属性元数据附加一个[PropertyChangedCallback 。](http://msdn.microsoft.com/en-us/library/system.windows.propertychangedcallback.aspx)

这种依赖属性的典型声明类似于下面的代码（此处使用 double 作为属性类型）：

```
public class MyControl : ...
{
    public static readonly DependencyProperty SomethingProperty =
        DependencyProperty.Register(
            "Something", typeof(double), typeof(MyControl),
            new FrameworkPropertyMetadata(
                (o, e) => ((MyControl)o).SomethingChanged((double)e.NewValue)));

    public double Something
    {
        get { return (double)GetValue(SomethingProperty); }
        set { SetValue(SomethingProperty, value); }
    }

    private void SomethingChanged(double newValue)
    {
        // process value changes here
    }

    ...
} 
```

现在，您可以通过 Storyboard 轻松地为该属性设置动画，或者通过直接应用 Animation 更简单：

```
DoubleAnimation animation = new DoubleAnimation
{
    To = ...,
    Duration = ...,
};

myControl.BeginAnimation(SomethingProperty, animation); 
```

# jquery - 按特定顺序加载 jquery 部分

> ID：10762323
> 
> 赞同：0
> 
> 时间：2012-05-25T23:10:06.323
> 
> 标签：jquery, ruby-on-rails

我有两个部分。一个是 XFBML facebook 之类的按钮部分，它看起来像：

```
 <fb:like send="true" layout="box_count" width="300" show_faces="true" font="arial"></fb:like>
  <script>
    (function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
  </script> 
```

另一个是 disqus 评论部分，如下所示：

```
<div id="disqus_thread"></div>
<script type="text/javascript">
$(document).ready(function() {
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'goodsounds'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
});
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a> 
```

我的问题是，在 disqus 部分之前调用了类似按钮部分，但不知何故，Disqus 部分在我的点赞按钮之前加载，导致我的点赞按钮出现显着延迟。我有什么办法可以解决这个问题吗？

谢谢。

# html - .css 页面切断页脚，不会滚动

> ID：10762326
> 
> 赞同：1
> 
> 时间：2012-05-25T23:10:36.233
> 
> 标签：html, css

每当我向页面添加大量内容时，它不会滚动并且页脚会被截断。我尝试了其他问题的解决方案，但到目前为止对我没有任何帮助。有什么建议么？

```
html {
    overflow: hidden;
    height: 99%;
}

body {
    background: #ffffff;
    height: 99%;
    margin: 0;
    padding: 0;
    line-height: 150%;
    text-align: center;
}

* {
    font-size: 8pt; 
    font-family: Tahoma, Verdana, sans-serif; 
    color: #000000;
    text-align: left;
}

/* === Containers === */

#mainContentArea {
    margin: 0 auto 0 auto; 
    display: table; 
    height: 100%;  
    position: relative; 
    overflow: hidden; 
    width: 600px;
}

.link,.linkActive {
    width:75px;
    margin-right:10px;
    float: left;
    margin-top:24px;
    text-align:center;
    font-family:Georgia, "Times New Roman", Times, serif;
    background-image:url(tab.gif);
    position:relative; bottom:0px;
}

.link:hover { background-image:url(tab2.gif); }

a { text-decoration:none; }

.link a {
    font-family:Arial, Helvetica, sans-serif;
    font-size:12px;
    font-weight:bold;
}

#linkGroup {
    margin-right:10px;
    height:40px;
    width:600px;
}

#title {
    width:230px;
    height:40px;
    margin-right:20px;
    margin-top:15px;
    font-family:Verdana, Arial, Helvetica, sans-serif;
    font-size:20px;
    font-weight:bold;
    text-align:center;
    float:left;
}

.contentTitle {
    font-family:Verdana, Arial, Helvetica, sans-serif;
    color:#213E74;
    font-size:19px;
    margin-left:15px;
    margin-right:12px;
    margin-bottom:12px;
    width:573px;
}

.pageContent {
    font-family: Arial, Helvetica, sans-serif;
    color:#000000;
    font-size:12px;
    margin-left:20px;
    margin-right:20px;
    width:560px;
}

#blueBox {
    position: absolute;
    vertical-align: middle;
    background-color:#E7EDF8;
    width:600px;
    clear:both;
}

#header {
    width:600px;
    height:20px;
    background-color:#FFFFFF;
    background-image:url(header.gif);
    background-repeat:no-repeat;
}

#footer {
    width:600px;
    height:20px;
    background-color:#FFFFFF;
    background-image:url(footer.gif);
    background-repeat:no-repeat;
    text-align:center;
    padding-right:10px;
    color:#BDCDEC;
}

#footer a {
    font-size:9px;
    color:#BDCDEC;
}

#contentBox { margin-top:25px; }

html, body { text-align: center; }

p {text-align: left;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:14:20.907

隐藏溢出将隐藏您的 html 中的滚动条。

您是否尝试删除该行

```
html {
  overflow:hidden; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T23:15:41.553

看到这个：

```
#mainContentArea {
    margin: 0 auto 0 auto; 
    display: table; 
    height: 100%;         # set the height to the same as the parent element
    position: relative; 
    overflow: hidden;     # hide (prevent scrolling) content that overflows
    width: 600px;
} 
```

删除`overflow`指令或将其设置为`auto`应该可以解决问题。

# android - Android FQL 查询错误

> ID：10762327
> 
> 赞同：2
> 
> 时间：2012-05-25T23:10:43.280
> 
> 标签：android, facebook

我今天早些时候成功地进行了 FQL 查询。现在，当我尝试进行相同的查询时，我收到以下消息。

"error_code":190,"error_msg":"验证访问令牌时出错：由于用户更改了密码，会话已失效。"

我在自己的帐户上进行查询，并且我的密码尚未更改。关于为什么会发生这种情况的任何建议？

现在我收到了这个错误。

“验证访问令牌时出错：会话与当前存储的会话不匹配。这可能是因为用户在会话创建后更改了密码，或者 Facebook 出于安全原因更改了会话。”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T08:27:20.497

根据以上评论，这将是这个问题。

Android 中的单点登录 (SSO) 允许用户授权您的应用程序，一旦他们完成授权，如果他们已登录 Facebook 以使用手机/平板电脑上的任何应用程序，他们将在后续访问中直接登录。

这样做的缺点是 SSO 会记住令牌，如果令牌失效（通过用户取消对应用程序的授权或更改密码或其他详细信息），它将尝试使用它。您必须特别检查这两个错误，因为“isSessionValid() 将返回 true，即使它不是。如果您发现这两个错误之一，则再次调用授权方法。

因此，在您的情况下，捕获该错误，然后调用 authorize()。

来自 Facebook 的文档：http: [//developers.facebook.com/docs/mobile/android/build/#sso](http://developers.facebook.com/docs/mobile/android/build/#sso)

# android - TableLayout 单元格定位

> ID：10762328
> 
> 赞同：2
> 
> 时间：2012-05-25T23:10:53.737
> 
> 标签：android

我一直在尝试将我的单元格排列在下面的表格行中，这样第二个单元格的值（带有背景图像的按钮）就在第一个单元格的文本右侧。下面当前拉伸单元格 2 中的图像，看起来像![这](../Images/65498a39d5553728cd1069cedcee1c5b.png).

关于如何停止拉伸并将按钮图像放置在单元格 2 的最左侧的任何想法？

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical" 
    android:layout_width="fill_parent" 
    android:layout_height="fill_parent">
    <TableLayout 
        android:layout_width="fill_parent"
        android:layout_weight="1"
        android:layout_height="wrap_content" 
        android:stretchColumns="1"
        android:layout_marginLeft="5dp" 
        android:layout_marginRight="5dp">
        <TableRow>
        <TextView 
            android:id="@+id/timeMainLabel" 
            android:layout_weight="1"
            android:textSize="14sp"
            android:layout_column="0" 
            android:padding="1dip" 
            android:text="cell one texxxxxxxxt"/>
        <Button
            android:id="@+id/pdm_tooltip_btn1"
            android:layout_column="1" 
            android:background="@drawable/tooltip_btn" />
        <TextView 
            android:layout_column="2" 
            android:id="@+id/timeLabel"
            android:textSize="14sp" 
            android:text="cell 3"
            android:gravity="right" 
            android:padding="1dip" 
            android:visibility="visible" 
            android:layout_weight="1"/>
    </TableRow>
    <TableRow>
        <TextView 
            android:id="@+id/timeMainLabel" 
            android:layout_weight="1"
            android:textSize="14sp"
            android:layout_column="0" 
            android:padding="1dip" 
            android:text="cell one text"/>
        <Button
            android:id="@+id/pdm_tooltip_btn1"
            android:layout_column="1" 
            android:background="@drawable/tooltip_btn" />
        <TextView 
            android:layout_column="2" 
            android:id="@+id/timeLabel"
            android:textSize="14sp" 
            android:text="cell 3"
            android:gravity="right" 
            android:padding="1dip" 
            android:visibility="visible" 
            android:layout_weight="1"/>
    </TableRow>
    </TableLayout>
</LinearLayout> 
```

更新图像： ![在此处输入图像描述](../Images/d56df90608b5a3836938057529f112f6.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T23:33:58.733

这将需要一些摆弄。基本上，您必须在第 1 列之后添加一些空列（这将是第二列，因为它们是零索引的）。

所以你将拥有：

```
<TableRow>
   <TextView layout_column="0">

   <Button layout_column="1">

   <TextView layout_column="2"> // DUMMY!

   <TextView layout_column="3">
</TableRow> 
```

现在，您可以随意摆弄`weight`并进行相应的设置。

第三列（第 2 列）将填充两个元素之间的空间，以便在需要时将其拉伸。

# php - 使用 php-ews (Exchange Web Services) 在特定日期后获取电子邮件

> ID：10762337
> 
> 赞同：3
> 
> 时间：2012-05-25T23:13:21.740
> 
> 标签：php, exchangewebservices, php-ews

在我的 PHP 脚本中，我需要弄清楚如何检索在指定消息 ID 之后或在特定日期之后的所有电子邮件（两者都可以，我只需要检索自上次抓取收件箱以来的新电子邮件）。

这个收件箱每天收到数千封电子邮件，我在 30 天内无法删除任何电子邮件。对于最初的导入，我只是从收件箱的开头做一个偏移，但显然一旦我们开始清理电子邮件，这将不起作用。

我想我必须设置类“ [EWSType_FindItemType](https://github.com/jamesiarmes/php-ews/blob/master/EWSType/FindItemType.php) ”的 $Restriction 属性，但我认为[php-ews](https://github.com/jamesiarmes/php-ews)中不存在必要的类来执行此操作。我尝试自己添加它们，但我对 EWS 或 SOAP 的了解不够。

到目前为止，我唯一想到的是：

```
$Request->Restriction = new EWSType_RestrictionType();
$Request->Restriction->IsGreaterThan = new stdClass;
$Request->Restriction->IsGreaterThan->FieldURIOrConstant = new stdClass;
$Request->Restriction->IsGreaterThan->FieldURIOrConstant->Constant = '2012-01-02T07:04:00Z';
$Request->Restriction->IsGreaterThan->FieldURI = new stdClass;
$Request->Restriction->IsGreaterThan->FieldURI->FieldURI = 'item:DateTimeReceived'; 
```

那是行不通的:(

这是我目前用来检索电子邮件的代码：

```
<?php
require( dirname( __FILE__ ) . '/ews/ExchangeWebServicesLoader.php' );

$ews = new ExchangeWebServices( EXCHANGE_HOSTNAME, EXCHANGE_USERNAME, EXCHANGE_PASSWORD, ExchangeWebServices::VERSION_2010_SP1 );

$Request = new EWSType_FindItemType();

$Request->ItemShape = new EWSType_ItemResponseShapeType();
$Request->ItemShape->BaseShape = EWSType_DefaultShapeNamesType::ALL_PROPERTIES;
$Request->ItemShape->BodyType = EWSType_BodyTypeResponseType::TEXT;
$Request->ItemShape->BodyTypeSpecified = true;

$Request->Traversal = EWSType_ItemQueryTraversalType::SHALLOW;

$Request->IndexedPageItemView = new EWSType_IndexedPageViewType();
$Request->IndexedPageItemView->MaxEntriesReturned = 25;
$Request->IndexedPageItemView->BasePoint = 'Beginning';
$Request->IndexedPageItemView->Offset = $offset;

$Request->ParentFolderIds = new EWSType_NonEmptyArrayOfBaseFolderIdsType();
$Request->ParentFolderIds->DistinguishedFolderId = new EWSType_DistinguishedFolderIdType();
$Request->ParentFolderIds->DistinguishedFolderId->Id = 'inbox';
$Request->ParentFolderIds->DistinguishedFolderId->Mailbox = new EWSType_EmailAddressType();
$Request->ParentFolderIds->DistinguishedFolderId->Mailbox->EmailAddress = 'sharedmailbox@company.org';

// sort order
$Request->SortOrder = new EWSType_NonEmptyArrayOfFieldOrdersType();
$Request->SortOrder->FieldOrder = array();
$order = new EWSType_FieldOrderType();
$order->FieldURI = new stdClass;
$order->FieldURI->FieldURI = 'item:DateTimeReceived';
$order->Order = 'Ascending';
$Request->SortOrder->FieldOrder[] = $order;

$response = $ews->FindItem($Request);
$items = $response->ResponseMessages->FindItemResponseMessage->RootFolder->Items->Message;

foreach ( $items as $item ) {
    // Do stuff
} 
```

任何帮助将*不胜*感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T14:21:30.190

EWS 中的限制很棘手，这是真的。您可以查看它们在[EWSWrapper](http://ewswrapper.lafiel.net)中的使用方式，这里是如何创建 AND 限制以获取日期范围之间的项目的示例：

```
//create AND restrction
$request->Restriction = new EWSType_RestrictionType();
$request->Restriction->And = new EWSType_AndType();

$request->Restriction->And->IsGreaterThanOrEqualTo = new EWSType_IsGreaterThanOrEqualToType();
$request->Restriction->And->IsGreaterThanOrEqualTo->ExtendedFieldURI = new EWSType_PathToExtendedFieldType;
$request->Restriction->And->IsGreaterThanOrEqualTo->ExtendedFieldURI->DistinguishedPropertySetId = "Task";
$request->Restriction->And->IsGreaterThanOrEqualTo->ExtendedFieldURI->PropertyId = "33029";
$request->Restriction->And->IsGreaterThanOrEqualTo->ExtendedFieldURI->PropertyType = "SystemTime";
$request->Restriction->And->IsGreaterThanOrEqualTo->FieldURIOrConstant->Constant->Value = date('c', $start);

$request->Restriction->And->IsLessThanOrEqualTo = new EWSType_IsLessThanOrEqualToType();
$request->Restriction->And->IsLessThanOrEqualTo->ExtendedFieldURI = new EWSType_PathToExtendedFieldType;
$request->Restriction->And->IsLessThanOrEqualTo->ExtendedFieldURI->DistinguishedPropertySetId = "Task";
$request->Restriction->And->IsLessThanOrEqualTo->ExtendedFieldURI->PropertyId = "33029";
$request->Restriction->And->IsLessThanOrEqualTo->ExtendedFieldURI->PropertyType = "SystemTime";
$request->Restriction->And->IsLessThanOrEqualTo->FieldURIOrConstant->Constant->Value = date('c', $end); 
```

以及使用的类型：

```
class EWSType_RestrictionType extends EWSType {
/**
 * SearchExpression property
 * 
 * @var EWSType_SearchExpressionType
 */
public $SearchExpression;

/**
 * Constructor
 */
public function __construct() {
    $this->schema = array(
        array(
            'name' => 'SearchExpression',
            'required' => false,
            'type' => 'SearchExpressionType',
        ),
    ); // end $this->schema
} // end function __construct()
} // end class RestrictionType

<?php

class EWSType_AndType extends EWSType {
/**
 * SearchExpression property
 * 
 * @var EWSType_MultipleOperandBooleanExpressionType
 */
public $SearchExpression;

/**
 * Constructor
 */
public function __construct() {
    $this->schema = array(
        array(
            'name' => 'SearchExpression',
            'required' => false,
            'type' => 'MultipleOperandBooleanExpressionType',
        ),          
    ); // end $this->schema
} // end function __construct()
} // end class AndType
class EWSType_IsLessThanOrEqualToType extends EWSType {
/**
 * SearchExpression property
 * 
 * @var EWSType_TwoOperandExpressionType
 */
public $SearchExpression;

/**
 * Constructor
 */
public function __construct() {
    $this->schema = array(
        array(
            'name' => 'SearchExpression',
            'required' => false,
            'type' => 'TwoOperandExpressionType',
        ),
    ); // end $this->schema
} // end function __construct()
} // end class IsLessThanOrEqualToType

class EWSType_IsGreaterThanOrEqualToType extends EWSType {
/**
 * SearchExpression property
 * 
 * @var EWSType_TwoOperandExpressionType
 */
public $SearchExpression;

/**
 * Constructor
 */
public function __construct() {
    $this->schema = array(
        array(
            'name' => 'SearchExpression',
            'required' => false,
            'type' => 'TwoOperandExpressionType',
        ),
    ); // end $this->schema
} // end function __construct()
} // end class IsGreaterThanOrEqualToType 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T06:49:20.930

感谢 Maiiku 提供的代码示例！

这就是我使用[PHP Exchange Web 服务库 (php-ews)](https://github.com/jamesiarmes/php-ews)启用按日期和主题字段过滤的方式。

（在使用此示例之前，您需要先 require_once 相关的 EWSType 库）。

```
$start = new DateTime('2013-03-31'); 

$Request->Restriction = new EWSType_RestrictionType();
$Request->Restriction->And = new EWSType_AndType();

$Request->Restriction->And->IsGreaterThanOrEqualTo = new EWSType_IsGreaterThanOrEqualToType();
$Request->Restriction->And->IsGreaterThanOrEqualTo->FieldURI = new stdClass;
$Request->Restriction->And->IsGreaterThanOrEqualTo->FieldURI->FieldURI = 'item:DateTimeReceived';
$Request->Restriction->And->IsGreaterThanOrEqualTo->FieldURIOrConstant->Constant->Value = $start->format('c');

$Request->Restriction->And->Contains = new EWSType_ContainsExpressionType();
$Request->Restriction->And->Contains->FieldURI = new stdClass;
$Request->Restriction->And->Contains->FieldURI->FieldURI = 'item:Subject';
$Request->Restriction->And->Contains->Constant->Value = 'annual leave application';
$Request->Restriction->And->Contains->ContainmentMode = 'Substring';
$Request->Restriction->And->Contains->ContainmentComparison = 'Exact'; 
```

希望这可以帮助！

# sencha-touch - 未捕获的错误：[Ext.createByAlias] 无法创建无法识别别名的实例：小部件

> ID：10762338
> 
> 赞同：9
> 
> 时间：2012-05-25T23:13:31.393
> 
> 标签：sencha-touch, extjs

这是我要实例化的简单视图：

```
Ext.define('myapp.view.Home',{
    extend 'Ext.Panel',
    xtype : 'testpanel' ,
    config: {
        title:'home',
        iconCls:'home',
        cls : 'home',
        html: [
           '<h1> Hello Guys </h1>',
           '<p> some text goes here </p>'
        ].join("")
    }
}); 
```

我已将视图添加到我的控制器中，如下所示：

```
Ext.define('myapp.controller.Main', {
    extend : 'Ext.app.Controller',
    views : ['Home'],
    ...
} 
```

我在我的应用程序中使用了 xtype，如下所示：

```
items:[{
    xtype : 'testpanel'
}, 
```

我仍然收到此错误：

> **未捕获的错误：[Ext.createByAlias] 无法创建无法识别别名的实例：widget.testpanel**

我感谢您的帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-28T15:00:31.967

我想你忘了在 app.js - Ext.Application 的“views”数组中添加这个视图。做检查。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-26T16:54:10.267

可以通过添加来解决吗？

```
requires:[
  'myapp.view.Home'
] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-25T23:50:14.663

您需要使用带有小部件前缀的别名属性。

```
Ext.define('myapp.view.Home',{
    extend 'Ext.Panel',
    alias : 'widget.testpanel' ,
    config: {
        title:'home',
        iconCls:'home',
        cls : 'home',
        html: [
            '<h1> Hello Guys </h1>',
            '<p> some text goes here </p>'
        ].join("")
    }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-26T23:48:12.740

我想你需要检查文件是否进入正确的目录。

[http://docs.sencha.com/ext-js/4-1/#!/guide/application_architecture](http://docs.sencha.com/ext-js/4-1/#!/guide/application_architecture)

在这里，您可以找到参考资料以了解可能出了什么问题。

检查对象 myapp.view.Home 是否在目录 app/view/Home.js 中

别名必须像别名：'widget.testpanel'

和一个要求：['myapp.view.Home']，

你甚至可以发布 app.js 文件吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-27T06:23:23.577

当 xtype config/property 值（正在创建的组件/对象实例的）与类 xtype config/property 值的 xtype config 的实际名称不匹配时，我得到了这个异常。其中实例是其父组件的项目配置中组件的惰性实现。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-12-23T21:51:00.480

您可以通过在视图中添加控制器类来修复。

控制器：“控制器类”，

# php - 具有两个日期约束的一对多查询

> ID：10762342
> 
> 赞同：2
> 
> 时间：2012-05-25T23:13:49.007
> 
> 标签：php, mysql, one-to-many

我必须为一种版本控制系统编写报告查询，在该系统中我需要检索最新版本的基于日期的报告变体。简化的表结构是：

```
items_register: ir_id (primary, auto inc), ir_name (varchar)
items: i_id (primary, auto inc), i_register_id (int), i_version_name (varchar), i_datetime (datetime), i_date_expiry (datetime) 
```

items_register 中的每个条目都有多个关联版本，作为条目存储在 items 表中 - i_datetime 的最高值是最新版本。

我想从 items_register 中检索条目，其中最新版本（item）在请求的日期（$f_date）之后具有 i_date_expiry。

我想我需要以某种方式加入表格，按 i_datetime 对项目进行排序，将它们限制为 1，以便我获得最新版本，然后检查 i_date_expiry 是否在 $f_date 之后，如果是则检索字段。

我要检索的字段是 items_register.ir_id、items_register.ir_name、items.i_version_name、items.i_datetime。

TIA 寻求帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T23:31:37.863

也许这可能有用？ [http://dev.mysql.com/doc/refman/5.0/en/example-maximum-column-group-row.html](http://dev.mysql.com/doc/refman/5.0/en/example-maximum-column-group-row.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T00:23:46.793

## 看起来您正在搜索“ [groupwise max](http://jan.kneschke.de/projects/mysql/groupwise-max/) ”模式。

对您的问题中仍不清楚的事情做出一些假设，我认为这可能是您正在寻找的查询：

```
SELECT items_register.ir_id, items_register.ir_name, 
    items.i_version_name, items.i_datetime
FROM items_register
JOIN
(
    SELECT items.i_register_id, 
        MAX(items.i_datetime) AS most_recent_item_datetime
    FROM items
    WHERE items.i_date_expiry > '$f_date'
    GROUP BY items.i_register_id
) AS item_date ON item_date.i_register_id = items_register.ir_id
JOIN items ON items.i_register_id = items_register.ir_id 
    AND items.i_datetime = item_date.most_recent_item_datetime 
```

**请记住**，这假定 $f_date 是一个符合[本文档页面](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-literals.html)中列出的日期时间和时间戳文字（不是日期文字！）标准的字符串。

# whoosh - Whoosh 按时间间隔分组

> ID：10762350
> 
> 赞同：1
> 
> 时间：2012-05-25T23:14:54.073
> 
> 标签：whoosh

我有以下结构，并使用 Whoosh 进行索引。

```
timestamp            name  count(b.name)
-------------------  ----  -------------
2010-11-16 10:32:22  John  2
2010-11-16 10:35:12  John  7
2010-11-16 10:36:34  John  1
2010-11-16 10:37:45  John  2
2010-11-16 10:48:26  John  8
2010-11-16 10:55:00  John  9
2010-11-16 10:58:08  John  2 
```

我想进行查询以获取以下结构，因此它每 5 分钟显示一次名称频率

```
timestamp            name  count(b.name)
-------------------  ----  -------------
2010-11-16 10:30:00  John  2
2010-11-16 10:35:00  John  10
2010-11-16 10:40:00  John  0
2010-11-16 10:45:00  John  8
2010-11-16 10:50:00  John  0
2010-11-16 10:55:00  John  11 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T18:38:01.580

一种可能的解决方案是在索引中引入额外的字段，例如 timestamp_trimmed，将时间戳修剪为 5 分钟间隔并保存到 timestamp_trimmed 字段中并执行按 timestamp_trimmed 字段分组的搜索。

# android - 具有可见性 GONE 的 LinearLayout 是否消耗零资源？

> ID：10762352
> 
> 赞同：4
> 
> 时间：2012-05-25T23:15:22.030
> 
> 标签：android, progress-bar, visibility, drawable, android-linearlayout

我在考虑如何实现一个显示图像的*ImageView*，当我用新图像刷新它的内容时，它会显示一个“正在加载...”文本，右侧有一个圆形*ProgressBar* ，所以我已经编写了代码附在下面..这是实现我想要的正确方法吗？当其可见性设置为 GONE 时，带有*TextView*和*ProgressBar的**LinearLayout*是否消耗零资源？*进度*条是否***当自身或其父布局的可见性设置为 GONE 时，自身消耗零资源（我正在考虑进度循环圈动画）？如果我将其设置为 INVISIBLE，由于布局管理，它应该会消耗一些资源，但它仍然不应该消耗资源来为进度圈设置动画，对吧？***

 *****编辑**：当我在上面说“它是否消耗资源”时，我的意思是 CPU 资源，因为它显然会消耗一些内存资源，因为当我只是将其可见性设置为*GONE*时我没有释放视图。我在第一条评论和第一个答案之后添加了这条评论。

我希望下面的代码是正确的，以防像我这样的其他新手想知道如何实现相同的东西。

遵循代码和在模拟器上显示结果的图像：

![在此处输入图像描述](../Images/1b86621d575c156eae8256780147435c.png)

**主要的.xml**

```
 <FrameLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

        <ImageView
            android:id="@+id/image_view1"
            android:src="@drawable/fish"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:scaleType="centerCrop"
            android:contentDescription="image view 1" />

       <LinearLayout
           android:id="@+id/layout_progress"
           android:layout_width="match_parent"
           android:layout_height="match_parent"
           android:layout_gravity="center_vertical"
           android:background="@drawable/filled_rectangle"
           android:gravity="center_vertical|center_horizontal"
           android:orientation="horizontal"
           android:visibility="gone" >

           <TextView
               android:layout_width="wrap_content"
               android:layout_height="wrap_content"
               android:gravity="fill_horizontal"
               android:text="Loading..."  
               android:textSize="30sp" 
               android:layout_gravity="center_vertical"/>

               <!-- style="@android:style/Widget.ProgressBar.Small" --> 
           <ProgressBar
               android:id="@+id/progress_bar1"
               android:layout_width="wrap_content"
               android:layout_height="wrap_content"
               android:layout_gravity="center_vertical"
               android:indeterminateOnly="true"/>

       </LinearLayout>
   </FrameLayout>

   <Button
       android:id="@+id/refresh_image"
       android:layout_width="wrap_content"
       android:layout_height="wrap_content"
       android:layout_gravity="center_horizontal"
       android:onClick="onClick" 
       android:text="@string/refresh_image"/>

</LinearLayout> 
```

**可绘制/填充矩形.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">
    <solid android:color="#80000000"/>
</shape> 
```

**TestFrameLayoutActivity.java**

```
public class TestFrameLayoutActivity extends Activity {
    private int progressVisible;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        LinearLayout layout = (LinearLayout) findViewById(R.id.layout_progress);
        progressVisible = (layout.getVisibility() == View.VISIBLE)?1:0;
    }

    public void onClick (View view) {
        progressVisible = 1 - progressVisible;
        LinearLayout layout = (LinearLayout) findViewById(R.id.layout_progress);
        ImageView img = (ImageView) findViewById(R.id.image_view1);

        if (progressVisible == 1) {
            layout.setVisibility(ProgressBar.VISIBLE);
        } else {
            layout.setVisibility(ProgressBar.GONE);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-25T23:29:39.107

不。就屏幕上显示的内容而言，它已经消失了，但它仍然在 R.java 中具有内存映射，并且它可用于视图。

如果您创建了一个包含数十亿 GONE 子项的视图，它可能会由于内存耗尽而崩溃。

也就是说，它确实消耗更少的资源，因为它不需要调用`onMeasure()`or `onDraw()`。***

# android - Android TabHost- 通过单击按钮打开一个新的 TabLayout

> ID：10762354
> 
> 赞同：0
> 
> 时间：2012-05-25T23:15:46.530
> 
> 标签：android, button, tabs, onclick, android-tabhost

我已经创建了我的 TabLayout，当我设置为从我的主类加载的第一个屏幕时，它工作正常。我在这里按照教程：http: [//joshclemm.com/blog/ ?p=136](http://joshclemm.com/blog/?p=136)

但是，我不希望它成为加载的第一件事。

我有一个带有 的应用程序`splashscreen`，然后转到`home`没有选项卡的屏幕。它上面有一堆按钮。然后，当您单击其中一个按钮时，我想加载放置在 a 中的视图，`tabgroup`然后您可以单击常规选项卡。任何想法如何在Android上做这个基本的事情？

我不断收到运行时异常错误。

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{ttj.android.ft/ttj.android.ft.Transfers}: java.lang.IllegalStateException: Did you forget to call 'public void setup(LocalActivityManager activityGroup)' 
```

这是我的`onCreate`方法代码。

我有一个名为 的按钮`Transfers`，当它被单击时`Transfers.class activity`，它是一个 tablayout 应该打开但没有。活动在 android 清单中。我是菜鸟，所以我知道我可能在这里做一些非常简单的错误。

帮助将不胜感激！

```
public class MainActivity extends Activity {
Button Records, Transfers, Leagues;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Transfers = (Button) findViewById(R.id.bTransfers);

    Transfers.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub

            Intent openTransfers = new Intent(MainActivity.this,
                    Transfers.class);
            startActivity(openTransfers);

        }
    }); 
```

这是我的 Android 清单

```
 <activity
        android:name=".Splash"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="ttj.android.ft.STARTINGPOINT" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name=".Transfers"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="ttj.android.ft.TRANSFERS" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity> 
```

这是 logcat 崩溃时的日志。

```
FATAL EXCEPTION: main
java.lang.RuntimeException: Unable to start activity 
java.lang.IllegalStateException: Did you forget to call 'public void setup(LocalActivityManager activityGroup)'?
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
at android.app.ActivityThread.access$600(ActivityThread.java:123)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4424)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
at dalvik.system.NativeStart.main(Native Method)
    Caused by: java.lang.IllegalStateException: Did you forget to call 'public void setup(LocalActivityManager activityGroup)'?
at android.widget.TabHost$IntentContentStrategy.getContentView(TabHost.java:680)
at android.widget.TabHost.setCurrentTab(TabHost.java:346)
at android.widget.TabHost.addTab(TabHost.java:236)
at ttj.android.ft.Transfers.onCreate(Transfers.java:52)
at android.app.Activity.performCreate(Activity.java:4465)
at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920) 
```

转移活动代码

```
public class Transfers extends TabActivity {

    /** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.m_transfers);

    TabHost mTabHost = getTabHost();        

    Intent intentTeams = new Intent().setClass(this, TransfersTeams.class);
    TabSpec teamsTab = mTabHost.newTabSpec("TEAMS").setIndicator("")
            .setContent(intentTeams);

    Intent intentSummary = new Intent().setClass(this,
            TransfersSummary.class);
    TabSpec summaryTab = mTabHost.newTabSpec("SUMMARY").setIndicator("")
            .setContent(intentSummary);

    mTabHost.addTab(teamsTab);
    mTabHost.addTab(summaryTab);

            mTabHost.setCurrentTab(0);

} 
```

**固定的**

我的课程 TransfersTeams 和 TransfersSummary 正在扩展 TabActivity。我将其更改为 Activity，它现在可以工作了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:56:00.810

如果您单独启动选项卡项活动，则其顶部不会有选项卡栏。为此，您应该启动选项卡主机活动，并将当前选项卡设置为要显示的选项卡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T23:38:09.993

在 MainActivity 尝试替换

```
<intent-filter>
    <action android:name="ttj.android.ft.STARTINGPOINT" />
    <category android:name="android.intent.category.DEFAULT" />
</intent-filter> 
```

和

```
 <intent-filter>
        <action android:name="android.intent.action.MAIN" />

        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T23:39:07.713

问题出在您的`Transfers`活动中，而不是在`MainActivity`. 正如错误清楚地告诉你的那样，你忘记调用`setup()`你的`TabHost`.

# extjs - 将函数中配置的 html 添加到 ExtJS 4 MVC

> ID：10762358
> 
> 赞同：2
> 
> 时间：2012-05-25T23:16:36.960
> 
> 标签：extjs, extjs4, extjs-mvc

我想将旧样式的程序构建字符串注入在标准 ExtJS 4 MVC 应用程序中创建的 DIV 元素中，并且我很难理解我应该如何利用动态加载。

所以说我在一个名为“createHtml.js”的javascript文件中有这个函数：

```
function fillDiv(strDivName)    {
    document.getElementById(strDivName).innerHTML = "<h1>TEST</h1>";
} 
```

在其他地方，在我的 MVC ExtJS 4 应用程序中（所以*在 app.js 中引用的对象中*，我有以下内容：

```
myPanel = Ext.create('Ext.panel.Panel', {
    title: 'Map',
    html: '<div style="width:100%; height:100%" id="map"></div>'
}); 
```

在我的 index.html 页面中，我包含了对 createHtml.js 的引用。在我的 app.js 文件中，我有如下内容：

```
( function() {
    Ext.Loader.setConfig({
        enabled : true,
        paths   : {
            MyJive: 'media/js/ext/MyCom/MyJive',
        }
    });
    Ext.onReady( function() {
        var urlparams = document.URL.split('?')[1];
        var param = Ext.urlDecode( urlparams ? urlparams : '' );
        var pcard = Ext.create( 'MyJive.view.MyUI',{
            param1 : param.param1,
            param2: param.param2
        });
        Ext.create( 'Ext.container.Viewport', {
            layout: 'fit',
            items: [pcard]
        });
    });
})(); 
```

现在，如果我将侦听器附加到 MyUI 上某处的按钮并调用它，`fillDiv('map');`我会收到`Uncaught ReferenceError: fillDiv is not defined`错误消息。

如果我不将 fillDiv 放在它自己的文件（createHtml.js）中，而是将 MyUI.js（由 pcard 引用，上面），我很高兴。所以我知道这不是一个超级愚蠢的问题，比如 div id 错误或一些古怪、无效的 innerHTML 值。

我原以为应用程序会知道 fillDiv()，因为 fillDiv() 的父文件在 index.html 的 javascript 包含中，但是很好，createHtml.js 没有被动态加载。我知道了，我猜。

但是我如何告诉 app.js 我的函数存在于其边界之外的文件中？

（现在，“IRL”，我让 fillDiv 通过[OpenLayers](http://openlayers.org/)创建了一段复杂的 html，以便我们可以显示由嵌入 ExtJS 表单中的 param1 和 param2 标识的地图，但我已经使用这个更简单的设置来尝试弄清楚我做错了什么。）

**编辑：** 添加 index.html。createHtml.js 包含该`fillDiv()`方法。请注意，获取地图的 DIV 不在 index.html 中；它再次在 ExtJS 面板中定义。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
    <head>
        <title>My Project</title>
        <link rel="stylesheet" type="text/css" 
                href="media/js/ext/ext-4.0/css/ext-all.css" />
        <link rel="stylesheet" type="text/css"
                href="media/js/ext/MyCom/MyJive/css/main.css" />

        <script type="text/javascript" 
                src="media/js/ext/MyCom/MyJive/createHtml.js"></script>
        <script type="text/javascript" 
                src="media/js/ext/MyCom/MyJive/OpenLayers-2.11/OpenLayers.js"></script>
        <script type="text/javascript" 
                src="media/js/ext/ext-4.0/ext-all-debug-w-comments.js"></script>

        <script type="text/javascript"
                src="media/js/ext/MyCom/MyJive/app.js"></script>
    </head>
    <body>
        <div id="divParent"></div>
    </body>
</html> 
```

**编辑：**添加 app.js：

```
( function() {
    Ext.Loader.setConfig({
        enabled : true,
        paths   : {
            MyProj: 'media/js/ext/MyCom/MyProj',
            OpenLayers: 'media/js/ext/MyCom/MapJive/OpenLayers-2.11',
            MyComExt  : 'media/js/ext/MyCom/MyComExt'
        }
    });
    Ext.onReady( function() {
        var urlparams = document.URL.split('?')[1];
        var param = Ext.urlDecode( urlparams ? urlparams : '' );
        var pcard = Ext.create( 'MyProj.view.MyProj',{
            param1: param.p1,
            param2: param.p2
        });
        Ext.create( 'Ext.container.Viewport', {
            layout: 'fit',
            items: [pcard]
        });
    });
})(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T17:42:41.943

我只想发表评论，但我没有足够的积分。

您没有在 createHtml.js 和 app.js 文件的导入中包含 index.html 文件。但我要检查的第一件事是您的 createHtml.js 导入位于 app.js 之上。

# c# - 使用类型初始化、并发访问和反射创建带有“插件注册表”的小型可插拔架构

> ID：10762359
> 
> 赞同：2
> 
> 时间：2012-05-25T23:16:38.337
> 
> 标签：c#, asp.net-mvc, c#-4.0, .net-4.0

我需要一些基本的“可插拔”架构，并且很好奇我对实现的假设和想法是否与我相信的一样。设置包含支持某些功能的所有类的“插件注册表”的基本过程如下：

1.  反思程序集中的类并找到它们中的任何一个继承自插件基类。
2.  生成一个新的“ModulePlugin”对象，该对象存储类名中的名称并获取对派生类型的引用，并可能从属性中获取一些元信息，例如“插件类型”。
3.  上面的插件类型将根据请求创建派生类型的新实例，但在上面的“ModulePlugin”对象中将其作为插件基类返回。
4.  将生成的插件存储在列表中

在第四步中，我使用带有静态类型初始化程序的静态类“PluginRegistry”执行此操作，并将生成的数据结构（List < Plugin>）存储在静态只读 IEnumerable<Plugin> 中。

在整个应用程序中，我以这种方式使用插件：

```
PluginRegistry.Plugins.Where(plugin => plugin.Type == Logger).Foo(); 
```

这是在 ASP.NET MVC 应用程序中。我假设：

1.  在发生并发访问的情况下，类型初始化器/构造器可以安全地使用（ASP.NET）
2.  对于给定的应用程序池生命周期，所需的反射只会运行一次，更准确地说，不会为每个请求一遍又一遍地运行，因为这是一个使用类型初始化的静态类。

我有一个可运行的原型，但我担心无法预料的问题。

我的假设是否正确，是否有任何我应该注意的问题？

# c++ - 带有 stringstream 的类试图按值传递？

> ID：10762362
> 
> 赞同：0
> 
> 时间：2012-05-25T23:17:07.270
> 
> 标签：c++, std, stringstream

我有一个带有字符串流的类：

```
class NetMessageEncoder
{
    std::stringstream m_ss;
    std::stringstream m_numSS;
public:
    NetMessageEncoder();
    void beginMessage(); 
```

...

然后我有另一个类，其中包含该类的一个实例，我正在尝试制作一个向量：

```
m_games.resize(100); 
```

该行产生：

```
Error   1   error C2248: 'std::basic_ios<_Elem,_Traits>::basic_ios' : cannot access private member declared in class 'std::basic_ios<_Elem,_Traits>'    c:\Program Files\Microsoft Visual Studio 9.0\VC\include\sstream 516 
```

我认为这可能是因为向量需要复制类，我猜会导致字符串流按值复制还是什么？

stringstream 确实是原因，如果删除，编译得很好。

有没有办法解决这个问题？

谢谢

```
 struct TableS
    {
        ServerPlayer* m_players[4];
        SpadesGameInfo m_info;
        NetSpadesGame m_game;
        bool readyToPlay() const
        {
            int count = 0;
            for(int i = 0; i < 4; ++i)
            {
                if(m_players[i])
                {
                    count++;
                }
            }

            return count >= m_info.getNumPlayers();
        }
        TableS()
        {
            for(int i = 0; i < 4; ++i)
            {
                m_players[i] = NULL;
            }
        }
    };
    class ServerCore : public ServerHost, public NetEventListener
    {
        NetEventDecoder m_dec;
        NetEventEncoder m_enc;
        std::vector<ServerPlayer*> m_players;
        int m_totalPlayers;
        std::vector<TableS> m_games;
    public:
... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T23:21:44.820

流是*不可复制*的，因此它是您的，`NetMessageEncoder`因为它包含流作为成员。如果您使用的是**C++11**，则可以通过使您的类型*可移动*来克服此限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T23:26:16.350

您可以执行以下操作之一：

1）覆盖复制构造函数和赋值运算符`NetMessageEncoder`并自己处理流复制（我猜，在你的情况下使用新的复制流可能就足够了）

`std::vector<TableS*> m_games;`2) 通过使用而不是避免复制流`std::vector<TableS> m_games;`

# jquery - Jquery tooltip Qtip - 我如何定位工具提示的不同位置

> ID：10762363
> 
> 赞同：1
> 
> 时间：2012-05-25T23:17:19.993
> 
> 标签：jquery, tooltip, qtip, jquery-tooltip

我已经安装了 Qtip 并将其用于地图上的工具提示：

[http://www.gregquinn.com/oneworld/about_people6.html](http://www.gregquinn.com/oneworld/about_people6.html)

您可以翻转红色大头针并查看现在的工具提示。

但他们想要这样，当您将“意大利”一词（左侧的文字）滚动时，相同的工具提示会在地图上意大利所在的红色大头针旁边弹出。

对于地图上的红色图钉，我使用带有 ALT 标签的图像地图来触发工具提示，如下所示：

```
<script class="example" type="text/javascript">
// Create the tooltips only when document ready
$(document).ready(function()
{
// We'll target all AREA elements with alt tags (Don't target the map element!!!)
$('area[alt]').qtip(
{
    content: {
        attr: 'alt' // Use the ALT attribute of the area map for the content
    },
    style: {
        classes: 'ui-tooltip-tipsy ui-tooltip-shadow ui-tooltip-light'
    }
});
});
</script> 
```

Qtip[文档](http://craigsworks.com/projects/qtip/docs/reference/)说您可以定位一个位置（`position: { target: $('ul:first li:last') }`），但我不知道该怎么做，或者我可以定位地图坐标并将所有这些都存在于一个页面上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T00:28:38.097

您应该能够`hover`在左侧的文本中使用一个事件来触发`show`您想要定位的特定 qtip 的方法。

在您的 html 中，您应该为您的链接添加一个类并添加一个数据属性。

```
<span class="qt-pointer" data-country="italy">Italy</span>
<span class="qt-pointer" data-country="kenya">Kenya</span> 
```

javascript会是这样的：

```
$('.qt-pointer').hover(function () {
  // on hover
  $('#' + $(this).data('country')).qtip("show");
}, function () {
  // on exit
  $('#' + $(this).data('country')).qtip("hide");
}); 
```

您的 qtip 区域应具有与 qt 指针的 data-country 属性相对应的 id。我没用过qtip，所以把上面的代码当作伪代码。希望对解决您的问题有所帮助。

# jquery - window.bind 函数导致 ie7 由于脚本长时间运行而无响应

> ID：10762364
> 
> 赞同：1
> 
> 时间：2012-05-25T23:17:23.070
> 
> 标签：jquery, windows, internet-explorer-7

我将以下脚本用于响应式菜单。在 IE7 中，脚本使页面冻结，并显示页面“由于脚本长时间运行而没有响应”。我发现导致冻结的位是`window.bind`代码底部的部分，并且从我到目前为止的研究表明它导致了 IE7 中的无限循环。我已经阅读了有关使用 setTimeout 等的答案，但我很新手，不知道如何在脚本中实现它。任何想法如何防止此脚本崩溃/冻结 IE7？

这是一个涉及[此博客文章](http://www.picnet.com.au/blogs/Guido/post/2010/03/04/How-to-prevent-Stop-running-this-script-message-in-browsers)超时的解决方案，但我不知道如何使用下面的脚本来实现它

```
/* Sample scripts for RWD nav patterns 
(c) 2012 Maggie Wachs, Filament Group, Inc - http://filamentgroup.com/examples/rwd-nav-   patterns/GPL-LICENSE.txt
Last updated: March 2012
Dependencies: jQuery
 */

jQuery(function($){

$('.nav-primary')
  // test the menu to see if all items fit horizontally
  .bind('testfit', function(){
        var nav = $(this),
            items = nav.find('a');

        $('body').removeClass('nav-menu');                    

        // when the nav wraps under the logo, or when options are stacked, display the nav as a menu              
        if ( (nav.offset().top > nav.prev().offset().top) || ($(items[items.length-1]).offset().top > $(items[0]).offset().top) ) {

           // add a class for scoping menu styles
           $('body').addClass('nav-menu');

        };                    
     })

  // toggle the menu items' visiblity
  .find('h3')
     .bind('click focus', function(){
        $(this).parent().toggleClass('expanded')
     });   

// ...and update the nav on window events
$(window).bind('load resize orientationchange', function(){
   $('.nav-primary').trigger('testfit');
});

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T01:15:25.203

我会查看 John Resig 的这篇文章[http://ejohn.org/blog/learning-from-twitter/](http://ejohn.org/blog/learning-from-twitter/)

基本上，他建议不要将函数直接绑定到事件，而是让函数每 250 毫秒运行一次。

```
var outerPane = $details.find(".details-pane-outer"),
    didScroll = false;
$(window).scroll(function() {
    didScroll = true;
});

setInterval(function() {
    if ( didScroll ) {
        didScroll = false;
        // Check your page position and then
        // Load in more results
    }
}, 250); 
```

当浏览器同时触发许多事件时，这将更加有效。您不会让 resize 事件在页面开始时运行 20 次。

# actionscript-3 - 我无法在构造函数方法中引用父级

> ID：10762366
> 
> 赞同：1
> 
> 时间：2012-05-25T23:17:49.707
> 
> 标签：actionscript-3

```
public function Browser(){

                var chrome:chromeicon = new chromeicon();

                this.parent.addChild(chrome);
                chrome.y = 745;
                chrome.x = 220;

    } 
```

我注意到我无法在构造函数方法或添加对象时实例化的任何方法中引用类的父级。必须有办法解决这个问题，但由于我是 oop 新手，所以我不知道。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T23:32:44.067

这是因为“父级”是指显示对象列表中的父级。这意味着只要该对象不作为子对象添加到其他对象，它就没有父对象，我不确定它们是否也需要添加到阶段。您可以通过向构造函数添加侦听器来解决此问题：

```
this.addEventListener(Event.ADDED_TO_STAGE, _myFunction); 
```

然后构造一个函数：

```
private function _myFunction(e:Event) :void {
    this.removeEventListener(Event.ADDED_TO_STAGE, _myFunction);
    // here you will be sure that your object has a parent that you can refer to, that will be a parent on the display list.
} 
```

# ios - CATransform3DMakeRotation 动画零谷（从 -45 到 +45 角度）？

> ID：10762367
> 
> 赞同：0
> 
> 时间：2012-05-25T23:17:57.890
> 
> 标签：ios, core-animation

我正在尝试做一个带有反弹效果的简单水平翻转动画。

```
 [UIView animateWithDuration:0.4 delay:0 options:UIViewAnimationCurveEaseIn animations:^{
    front.layer.transform=CATransform3DMakeRotation(DEGREES_TO_RADIANS(90), -1.0,0.0,0.0); // flip halfway
}
completion:^(BOOL finished) { // swap view
    front.alpha=0;
    back.alpha=1;
    [UIView animateWithDuration:0.5 animations:^{ // flip remaining + bounce
        back.layer.transform = CATransform3DMakeRotation(DEGREES_TO_RADIANS(45), 1.0,0.0,0.0); // final + 45 
    }
    completion:^(BOOL finished) {
        [UIView animateWithDuration:0.25 animations:^{
            back.layer.transform = CATransform3DMakeRotation(DEGREES_TO_RADIANS(-22.5), 1.0,0.0,0.0); // bounce back
        }
        completion:^(BOOL finished) {
            [UIView animateWithDuration:0.125 animations:^{
                back.layer.transform = CATransform3DMakeRotation(0, 1.0,0.0,0.0); // final
            }];
        }];
    }];
}]; 
```

除了“反弹”外，效果很好。-22.5 旋转过渡到 0，然后返回到 22.5，而不是继续到 -22.5。

我尝试了各种值，还包括一个中间嵌套块，它在变为负数之前将反弹转换为“0”。没有帮助。旋转始终以正角度而不是负角度进行动画处理。

就像测试一样，将“final + 45”更改为负角度确实会在所需角度停止动画。所以角度本身是可以的。

问题似乎是从零开始或从零开始进行“逆时针”旋转。小于零的值总是转换为正角度。

如果以上是实现反弹效果的正确技术，那么如何构建通过 CATransform3DMakeRotation 从正角（45）旋转到负角（-45）的（嵌套）图层动画？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T14:18:54.647

您正在绕 x 轴旋转。如果没有对变换的*透视*，您将如何看待正角和负角之间的差异？没有透视，正旋转和负旋转看起来都是一样的（降低高度）。您可以通过设置更改变换矩阵的第三行和第四列中的值来[将透视应用于变换](https://stackoverflow.com/a/353611/608157)`.m34`。搜索“Core Animation perspective”，你会找到一个很好的解释。

我在上面运行了你的代码（在一个简单的视图上，用橙色填充）。为了更容易看到旋转以及正负角之间的差异，我对其进行了更改，使其围绕 z 轴旋转。

这是我在动画期间拍摄的四张截图。如您所见，除非我误解了您要做什么，否则负角度是有效的。

![0度](../Images/0b26666c345e24c2cdd245ec2b60a564.png) ![45度](../Images/1001ea419b6eb4440f4b0b2112365300.png) ![-25度](../Images/9b7acd177027b5688edbc5142628b006.png) ![0度](../Images/0b26666c345e24c2cdd245ec2b60a564.png)

# visual-c++ - 为什么控制台应用程序没有结束？

> ID：10762369
> 
> 赞同：0
> 
> 时间：2012-05-25T23:18:54.597
> 
> 标签：visual-c++

我第一次使用 Visual C++（也是这门语言的新手）——体验过 C#……所以我有了我在 Visual Studio 中启动的第一个控制台应用程序。

```
#include "stdafx.h"
#include <iostream>

using namespace std;

int _tmain(int argc, _TCHAR* argv[])
{
    int i;

    cin >> i;

    return 0;
} 
```

当我按下回车键时，控制台窗口 - 因此应用程序 - 为什么没有关闭？没有其他输入 - 只需输入...

`exit()`更重要的是，如果我只是按 Enter键，如何使应用程序退出（不想使用）正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T23:37:31.217

std::cin 等待您的一个非空字符串，然后尝试将此字符串转换为整数。

当您按 Enter 时，std::cin 只会得到一个空字符串并继续等待一些有效的输入。这是设计使然。std::cin 并不意味着模拟其他交互。

要在按键时终止应用程序，您必须使用特定于操作系统的工具来读取键盘按键。

这是 DOS/console Windows 上“conio.h”中的 kbhit() 函数和 POSIX 系统上的 termio 函数。

从您的来源我可以得出结论，您使用的是 MSVC++ 编译器，因此请尝试替换

```
std::cin >> i 
```

经过

```
while(!kbhit()) {} 
```

不要忘记添加

```
#include <conio.h> 
```

请记住，这是一个特定于 Windows 的解决方案。

# php - 使用 codeigniter 上传 .amr

> ID：10762370
> 
> 赞同：1
> 
> 时间：2012-05-25T23:19:36.873
> 
> 标签：php, codeigniter, upload, amr

我一直在尝试将 .arm 上传到内置 codeigniter 的网站。我知道它不是默认的我的类型，所以我添加了它：

```
'amr'   =>  'audio/amr', 
```

但它似乎并没有与之合作。我还将它添加到允许的类型中。知道是否可以支持 amr，如果可以，我可能做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T23:43:22.190

您可以尝试查看`system/libraries/Upload.php`第 199 行：
`$this->_file_mime_type($_FILES[$field]);`
将该行更改为
`$this->_file_mime_type($_FILES[$field]); var_dump($this->file_type); die();`
Now you redo your uploading 并查看浏览器发送到服务器的实际 mime 类型。

我所做的一个愚蠢且不安全的解决方法是将实际的 mime 类型添加到 mimes 数组中。但如果这个[问题](https://stackoverflow.com/questions/10762391/codeigniter-wrong-uploading-file-mime-type)得到回答，这可能会改变:)

# objective-c - 自定义drawRect：在UINavigationBar子类中

> ID：10762375
> 
> 赞同：3
> 
> 时间：2012-05-25T23:21:09.047
> 
> 标签：objective-c, cocoa-touch, uinavigationbar

我想子类化`UINavigationBar`，以便我可以在它的`drawRect:`.

这是我的代码：

**导航控制器 (.h)**

```
@interface CORENavigationController : UINavigationController

@property (strong, nonatomic) CORENavigationBar *customNavigationBar;

@end 
```

**导航控制器 (.m)**

```
@implementation CORENavigationController

@synthesize customNavigationBar = _customNavigationBar;

- (UINavigationBar *)navigationBar {
    if (![self customNavigationBar]) {
        [self setCustomNavigationBar:[[CORENavigationBar alloc] init]];
    }
    return [self customNavigationBar];
} 
```

**导航栏 (.h)**

```
@interface CORENavigationBar : UINavigationBar

@end 
```

**导航栏 (.m)**

```
@implementation CORENavigationBar

- (void)drawRect:(CGRect)rect
{
    [super drawRect:rect];
} 
```

问题是导航栏没有标题，例如我能看到的只是标准的蓝色背景。

一旦我删除以下方法，标题就会回到那里：

```
- (UINavigationBar *)navigationBar {
    if (![self customNavigationBar]) {
        [self setCustomNavigationBar:[[CORENavigationBar alloc] init]];
    }
    return [self customNavigationBar];
} 
```

为什么标题消失了？我打电话给`super`'s`drawRect:`并且不改变任何其他东西。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T11:47:20.480

找到了！这是答案：

[https://stackoverflow.com/a/9610801/1306956](https://stackoverflow.com/a/9610801/1306956)

在这种情况下，它将是：

```
[navigationController setValue:[[CORENavigationBar alloc] init] forKeyPath:@"navigationBar"]; 
```

在 iOS 5.1.1 (9B206) 上测试。奇迹般有效。

# xslt - 如何使用 XSLT 组装 XML 层次结构

> ID：10762376
> 
> 赞同：4
> 
> 时间：2012-05-25T23:21:23.450
> 
> 标签：xslt

鉴于此 XML

> ```
> <Xml>
>     <Thing id="1"  >
>         <Foo id="11" parentId="12"/>
>         <Foo id="12"/>
>     </Thing>
>     <Thing id="2" parentId="1" />
>     <Thing id="3" parentId="2" />
>     <Thing id="4">
>         <Foo id="11" parentId="15"/>
>         <Foo id="12" parentId="14"/>
>         <Foo id="13" parentId="11"/>
>         <Foo id="14" parentId="15"/>
>         <Foo id="15"/>      
>     </Thing>
> </Xml> 
> ```

我想抓住每一个兄弟姐妹的集合，并将它们组装成自己的层次结构。

每个具有 parentId 值的“事物”节点都应该嵌套在相应的事物节点下。每个具有 parentId 值的“Foo”节点都应该嵌套在相应的 Foo 节点下——但只能嵌套在其兄弟节点内。该示例有两组 Foo 兄弟姐妹。

我正在尝试创建这个：

> ```
> <Xml>
>     <Thing id="1" >
>         <Foo id="12">
>             <Foo id="11" parentId="12"/>
>         </Foo>        
>         <Thing id="2" parentId="1" >
>             <Thing id="3" parentId="2" />
>         </Thing>
>     </Thing>            
>     <Thing id="4" >
>         <Foo id="14" parentId="12">
>             <Foo id="12" parentId="14"/>
>         </Foo>
>         <Foo id="15">
>             <Foo id="11" parentId="15">
>                 <Foo id="13" parentId="11"/>
>             </Foo>
>         </Foo>
>     </Thing>
> </Xml> 
> ```

这个例子很接近： [如何使用 XSLT 1.0 向非分层 XML 文件添加结构？](https://stackoverflow.com/questions/9981835/how-can-i-use-xslt-1-0-to-add-structure-to-a-non-heirarchal-xml-file)

我使用标识模板来保留所有节点和属性。然后我想要一个覆盖模板来匹配所有具有兄弟姐妹（后面或前面）的节点，以便兄弟姐妹的 @parentId 值等于我的 @id 值。我最接近的方法是硬编码要匹配的 id/parentId 值。

> ```
> <?xml version="1.0" encoding="UTF-8"?>
> <xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
> 
>     <xsl:output indent="yes"/>
> 
>     <!-- override identity rule with template to match on
>         a node who has siblings, where sibling/@parentId == ./@id
>     -->
>     <xsl:template match="node()[@id='1' and (preceding-sibling::*[@parentId = 1] or following-sibling::*[@parentId = 1])]">
>        <captured>
>         <xsl:copy>
>             <xsl:apply-templates select="@*|node()"/>
>         </xsl:copy>
>        </captured>
>     </xsl:template>  
> 
>     <!-- identity rule -->
>     <xsl:template match="@*|node()">
>         <xsl:copy>
>             <xsl:apply-templates select="@*|node()"/>
>         </xsl:copy>
>     </xsl:template>
> 
> </xsl:stylesheet> 
> ```

我看不到如何根据 parentId 值获取当前节点 @id 值以在 Xpath 匹配兄弟的谓词中使用。

然后我想在它下面嵌套当前节点兄弟姐妹，其中兄弟姐妹@ParentId 等于我的@id。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T01:58:35.043

**首先请注意提供的 XML 文档中的错误**：

```
 <Foo id="12" parentId="14"/>
    <Foo id="13" parentId="11"/>
    <Foo id="14" parentId="12"/> 
```

`Foo`with `id`12 和`Foo`with之间存在循环关系`14`。这形成了一个循环，而不是“层次结构”。此外，这两个`Foo`元素从层次结构的顶部是*无法访问的！***请正确**。

**这种转变**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kElemById" match="*"
   use="concat(generate-id(..), '+', @id)"/>
 <xsl:key match="*" name="kDescendants"
  use="concat(generate-id(key('kElemById', 
                              concat(generate-id(..), '+',@parentId))),
             '+', @parentId)"/>

 <xsl:template match="node()|@*">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="/*">
  <Xml>
   <xsl:apply-templates select="*[not(@parentId)]"/>
  </Xml>
 </xsl:template>

 <xsl:template match="*/*">
   <xsl:copy>
    <xsl:apply-templates select="@*"/>

    <xsl:apply-templates select="*[not(@parentId)]"/>

    <xsl:apply-templates select=
       "key('kDescendants', concat(generate-id(), '+',  @id))"/>
  </xsl:copy>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<Xml>
    <Thing id="1"  >
        <Foo id="11" parentId="12"/>
        <Foo id="12"/>
    </Thing>
    <Thing id="2" parentId="1" />
    <Thing id="3" parentId="2" />
    <Thing id="4">
        <Foo id="11" parentId="15"/>
        <Foo id="12" parentId="14"/>
        <Foo id="13" parentId="11"/>
        <Foo id="14" parentId="12"/>
        <Foo id="15"/>
    </Thing>
</Xml> 
```

**产生正确的结果，不包括任何无法到达的元素**：

```
<Xml>
   <Thing id="1">
      <Foo id="12">
         <Foo id="11" parentId="12"/>
      </Foo>
      <Thing id="2" parentId="1">
         <Thing id="3" parentId="2"/>
      </Thing>
   </Thing>
   <Thing id="4">
      <Foo id="15">
         <Foo id="11" parentId="15">
            <Foo id="13" parentId="11"/>
         </Foo>
      </Foo>
   </Thing>
</Xml> 
```

# c++ - ATI Mobility Radeon 4650：“未找到 GPU。回退到 CPU 设备”

> ID：10762377
> 
> 赞同：1
> 
> 时间：2012-05-25T23:21:34.010
> 
> 标签：c++, gpu, ati, amd-processor, stream-processing

我的电脑上有 ATI Mobility Radeon 4650。我已经安装[了带有 OpenCL 1.2 SDK 的 AMD APP SDK v2.7](http://developer.amd.com/sdks/AMDAPPSDK/downloads/Pages/default.aspx#one)并打开了示例应用程序。所有这些都表示未找到 GPU。但是，根据[入门指南](http://developer.amd.com/sdks/AMDAPPSDK/assets/AMD_APP_SDK_Getting_Started_Guide_v2.7.pdf)，我的视频卡受支持，但仅限测试版。我查看了文档并尝试了谷歌但没有帮助。如何让 SDK 识别我的卡？我目前在 Windows x64 上运行。

# android - 如何在 Android 3.0+ 的媒体播放器通知栏中实现播放/暂停按钮？

> ID：10762378
> 
> 赞同：1
> 
> 时间：2012-05-25T23:21:40.197
> 
> 标签：android

我正在编写一个流媒体音频应用程序，我想在通知栏中有一个播放/暂停按钮，就像谷歌的音乐播放器一样。我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T11:29:54.780

您可以通过使用添加自定义布局来做到这一点`RemoteViews`，请参阅[本文档](http://developer.android.com/guide/topics/ui/notifiers/notifications.html#CustomNotification)

# php - MySQL：“您的 SQL 语法错误......靠近键......”？

> ID：10762380
> 
> 赞同：4
> 
> 时间：2012-05-25T23:21:49.080
> 
> 标签：php, mysql, syntax-error

我发现了一个非常酷的密码丢失脚本，但是这一行让我遇到了问题

```
$r = mysql_query('INSERT INTO `keys` (username,key, vreme) VALUES ("'.$user.'", "'.$acckey.'", "'.$keyexp.'"') or die(mysql_error()); 
```

错误

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'key, vreme) VALUES ("123123", "1ed2f5100a26298a55b2935cbea7d4a0", "1337991670"' at line 1 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-12-23T18:56:28.243

`KEY`是[保留字](http://dev.mysql.com/doc/en/reserved-words.html)。如[架构对象名称](http://dev.mysql.com/doc/en/identifiers.html)下所述：

> 如果标识符包含特殊字符或者是保留字，则在引用它时*必须*引用它。（例外：在限定名称中跟在句点后面的保留字必须是标识符，因此不需要引用。）
> 
> ```
> [*删除*]
> ```
> 
> 标识符引号字符是反引号（“<code>`”）：
> 
> ```
> mysql> **SELECT * FROM `select` WHERE `select`.id > 100;**
> ```
> 
> 如果[`ANSI_QUOTES`](http://dev.mysql.com/doc/en/server-sql-mode.html#sqlmode_ansi_quotes)启用了 SQL 模式，还允许在双引号内引用标识符：
> 
> ```
> mysql> **CREATE TABLE "test" (col INT);**
> ERROR 1064: You have an error in your SQL syntax...
> mysql> **SET sql_mode='ANSI_QUOTES';**
> mysql> **CREATE TABLE "test" (col INT);**
> Query OK, 0 rows affected (0.00 sec)
> ```

所以：

```
mysql_query("INSERT INTO `keys` (username, `key`, vreme) VALUES ('$user', '$acckey', '$keyexp') ") 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-25T23:22:46.863

`key`是[保留关键字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)- 将其括在反引号中

```
`key` 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-26T13:53:10.637

```
 $r = mysql_query("INSERT INTO `keys` (username,`key`,vreme) VALUES ('$user', '$acckey','$keyexp')") or die(mysql_error()); 
```

Thank you all (:

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T23:25:15.397

还删除查询中的双引号并将查询封装在双引号而不是单引号中。

在查询中使用单引号来封装值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-25T23:30:41.497

```
$r = mysql_query("INSERT INTO `keys` (username,key,vreme) VALUES ('".$user."', '".$acckey."','".$keyexp."')") or die(mysql_error()); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-25T23:31:24.210

您是否在最后一个右括号和分号之间的查询末尾缺少单引号？

# c# - C# 动态填充 DropDownList 在按钮 OnClick 上重置

> ID：10762383
> 
> 赞同：1
> 
> 时间：2012-05-25T23:21:55.350
> 
> 标签：c#, asp.net

我有一点 DUH 时刻，需要一些帮助。我有一个 DropDownList 控件，它在页面加载时填充了值，还有一个提交按钮可以进行进一步的操作。但是，当单击按钮时，DropDownList 返回值“-1”而不是所选选项。这里有什么问题？

网页：

```
<%@ Page Language="C#" MasterPageFile="/new/MasterPageA2.master" EnableEventValidation="false" AutoEventWireup="true" CodeFile="Checkout.aspx.cs" Inherits="Common_Checkout" EnableViewState="true" %>

<asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" runat="Server">
<asp:UpdatePanel ID="UpdatePanel" runat="server">
<ContentTemplate>

    <asp:Label runat="server" ID="test11"></asp:Label>
    <asp:DropDownList ID="ddlbillingcountry" required="true" EnableViewState="true" runat="server"></asp:DropDownList>
    <asp:Button ID="ImageButton1" AlternateText="Proceed" OnClick="ImageButton1_Click" CausesValidation="false" runat="server" />

</ContentTemplate>
</asp:UpdatePanel>
<asp:UpdateProgress ID="UpdateProgress1" runat="server">
    <ProgressTemplate>
        <p>Loading...</p>
    </ProgressTemplate>
</asp:UpdateProgress>
</asp:Content> 
```

后面的代码：

```
protected void Page_Load(object sender, EventArgs e) {
  if (!IsPostBack) {
    PopulateCountry(ddlbillingcountry);
  }
}

private void PopulateCountry(DropDownList Controlname) {
    DatasetTableAdapters.CountryTableAdapter _CountryTableAdapter = new DatasetTableAdapters.CountryTableAdapter();

    Controlname.ClearSelection();
    Controlname.Items.Clear();      

    DataTable _DataTable = _CountryTableAdapter._Eco_Country_Select(); 
    Controlname.DataSource = _DataTable;
    Controlname.DataTextField = "CountryName";
    Controlname.DataValueField = "Country";
    Controlname.DataBind();
    Controlname.Items.Insert(0, new ListItem("- Select Country -", ""));
}

protected void ImageButton1_Click(object sender, EventArgs e) {
    test11.Text += "<p>clicked " + ddlbillingcountry.SelectedIndex + " - " + ddlbillingcountry.SelectedValue.ToString();

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T03:42:14.700

您可以将 datasource 属性设置为返回数据集的函数的名称。尝试`datasource='<%# PopulateCountry("ddlbillingcountry") %>'`但您需要更改或重载函数以将参数更改为字符串，记住设置 datavaluefield 和 datatextfield。或者您可能想要创建一个单独的函数并在没有参数的情况下调用它。

# python - 在 Maya 或 3DS Max 中运行时 ssl.wrap_socket 减速

> ID：10762384
> 
> 赞同：0
> 
> 时间：2012-05-25T23:22:12.103
> 
> 标签：python, maya, 3dsmax, shotgun

在 3DS Max 和 Maya 中创建 Shotgun 对象时，我遇到了减速问题。这种减速是一个已知问题。我今天花了一些时间在 Shotgun 的 API 中进行反向搜索，最后找到导致速度下降的一行。这一行是对 ssl.wrap_socket 的调用，它是 Python 标准库中的一种方法。

我从 Shotgun API 中提取了这个方法，并尝试在 Maya 和 3DS Max 中运行这一行，而这一行确实仍然会导致速度变慢。在常规 Python shell 中运行平均只需 0.7 秒。但是，在 Maya 或 3DS Max（使用 Blur 的 Python 插件）中运行时，平均需要 6.5 秒。

我对 ssl 和套接字的了解还不够，无法进一步解决此问题，所以我希望这里的某个人可以提供一些想法，说明为什么在 Maya 和 3DS Max 中运行时速度如此之慢。值得一试！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T19:32:38.147

对于 Maya，修复记录在：

[https://support.shotgunsoftware.com/entries/20953057-shotgun-takes-10s-to-connect-when-running-in-maya](https://support.shotgunsoftware.com/entries/20953057-shotgun-takes-10s-to-connect-when-running-in-maya)

有关问题的描述和一些解决问题的下载，请参阅最后一个条目。基本上，Maya 中的 OpenSSL 存在问题，我们已经获得了一些补丁来修复它。

我们有报告说，相同的修补文件在 3ds 中工作，但绝对支持您要替换的任何文件。

希望有帮助！

-r

# ios - 如何使用核心数据整数 64 属性？

> ID：10762385
> 
> 赞同：5
> 
> 时间：2012-05-25T23:22:28.283
> 
> 标签：ios, cocoa-touch, core-data, properties, nsnumber

我希望 Core Data 中的 Entity 属性是 64 位整数。由于该模型将在 iOS 上运行，并且据我所知这些设备不是 64 位的，因此我认为这`NSNumber`是可行的方法（核心数据为您提供了对象或原始类型的标量属性的选项）。我假设`NSNumber`它将在内部负责跟踪 64 位的合适表示。

现在，我需要在某个时候从我的实体中的这个“64 位”属性中减去 1（如果您没有猜到，64 位属性是 Twitter API 中的 max_id 参数），但要这样做，我首先需要将 NSNumber 属性中的数字拆箱。

那么我应该得到 intValue 吗？长值？无符号整数值？无符号长值？长长？哪一个？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-26T00:05:27.657

由于您已经知道类型（64 位整数），因此您无需检查它。

要从 NSNumber 中获取 64 位整数，请执行以下操作之一：

```
NSInteger myInteger = [myNSNumber integerValue];
int64_t   myInteger = [myNSNumber integerValue]; 
```

为了只添加一个，您可以使用以下内容：

```
myNSNumber = [NSNumber numberWithInteger:[myNSNumber integerValue]+1]]; 
```

请注意，iOS**确实**有 64 位数据类型，例如`int64_t`和`NSInteger`。

**编辑：**
如果您使用的唯一原因`NSNumber`是存储 64 位整数，您可以在模型子类中声明这样的属性并完全跳过拆箱/装箱：

```
@property (nonatomic) int64_t myIntValue; 
```

Note that core data does this by default if you select the **Use scalar properties for primitive data types** option of the **Create NSManagedObject Subclass** feature.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T23:33:17.473

试着把它放在一个`NSNumber`类别中：

```
-(int64_t) int64value
{
    if (sizeof(short) == 8)
        return [self shortValue];
    if (sizeof(int) == 8)
        return [self intValue];
    if (sizeof(long) == 8)
        return [self longValue];
    if (sizeof(long long) == 8)
        return [self longLongValue];

    return -1; // or throw an exception
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T23:58:12.653

要获取 NSNumber 中包含的 C 类型，请使用 objCType

例子

```
NSNumber *myFloat = [NSNumber numberWithFloat:5.5f];
NSLog(@"%s", [myFloat objCType]); 
```

将打印“f”，因为它包含一个浮点类型的值。

另外，请查看将返回 C 类型字符的 @encode()。

例子

```
NSNumber *myFloat = [NSNumber numberWithFloat:5.5f];
if (strcmp(myFloat) == @encode(float)) { 
    NSLog(@"This is a float");
} 
```

还

```
NSNumber *myFloat = [NSNumber numberWithFloat:5.5f];
CFNumberType numberType = CFNumberGetType((CFNumberRef)myFloat); 
```

# delphi - 如何使用 ReadProcessMemory 读取 pchar

> ID：10762387
> 
> 赞同：2
> 
> 时间：2012-05-25T23:22:40.327
> 
> 标签：delphi, delphi-xe2

我正在使用该`ReadProcessMemory`函数来读取外部正在运行的应用程序的内容，我有一个指向 PChar(UNICODE) 的内存地址。我想知道哪个是将该值返回到字符串变量的正确方法？

现在我正在使用此代码，但无法正常工作

```
var
c : char;

repeat
  if not ReadProcessMemory(ph, Address, @c, sizeof(c), BytesRead) then
    raise exception.create(syserrormessage(getlasterror));
  result:=result+c;
  Address:=pointer(integer(address)+sizeof(c));
until (c=#0#0) or (BytesRead<>sizeof(c)); 
```

引发此错误

> 仅完成了 ReadProcessMemory 或 WriteProcessMemory 请求的一部分

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T00:54:36.637

您正在读取字符串：您读取的不是字节而是字符，因此将空终止符与字符进行比较，即：

```
until (c=#0) or (BytesRead<>sizeof(c)); 
```

`#0`已经是 2 个字节，`#0#0`是 4 个字节（它不能等于*任何*Char）。

当您阅读字符串并*“进入无法访问的进程区域”*（根据[文档](http://msdn.microsoft.com/en-us/library/ms680553%28v=vs.85%29.aspx)）时，将返回错误。

# php - CodeIgniter：上传文件 mime 类型错误

> ID：10762391
> 
> 赞同：0
> 
> 时间：2012-05-25T23:24:22.277
> 
> 标签：php, http, codeigniter, file-upload, mime-types

有时，在使用`<input>`标签上传文件时，我会遇到文件扩展名与`application/config/mimes.php`. 例如，当我上传一个`.doc`文件时，它的 mime 类型实际上是`application/octet-stream`，而不是`application/msword`预期的那样。

我过去有时会遇到这个问题。我确实通过添加`application/octet-stream`到`.doc`mime 数组来解决问题。但是有没有合适的方法来解决它？

我认为浏览器以某种方式强制我的文件的 mime 类型。是否有任何类型的 HTTP 标头或 html 元标记来防止这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T13:06:12.047

正如您[在此处](http://codeigniter.com/forums/viewthread/145433/#713128)看到的，这是一个常见问题，您应用的解决方案是合法的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-27T10:19:47.233

这不是由于 codeignitor 的问题。这是由于php问题。例如`finfo_file`，函数将返回带有扩展名 jpeg 的图像作为 image/png。

因此，解决方案是转到`config/mimes.php`文件，然后添加相应的扩展名。

如果您不知道 php 正在挑选的场景背后的扩展名是什么，请添加此代码进行检查。

```
$finfo = @finfo_open(FILEINFO_MIME);
$mime = @finfo_file($finfo, $_FILES["myname"]['tmp_name']); 
```

`$mime`将是 php 最终返回的扩展名。

# javascript - Javascript indexOf方法不适用于Object中的整数

> ID：10762392
> 
> 赞同：-1
> 
> 时间：2012-05-25T23:24:34.460
> 
> 标签：javascript

我做了一个小提琴：

[http://jsfiddle.net/csS24/](http://jsfiddle.net/csS24/)

我试图让代码达到一个点，它永远不会一次显示相同的两个项目，或者当一个项目被单击时，它永远不会从数组中拉回同一个项目，只是似乎有点挣扎逻辑和 indexOf 方法的行为很奇怪。

```
var justAdded = [];
justAdded['first'] = 0;
justAdded['second'] = 1;

newHtml = returnRandom().split('|');

justAdded[e.id] = parseInt(newHtml[0], 10);

    if(justAdded.indexOf(parseInt(newHtml[0], 10)) == -1){
        e.style.opacity = 0;
        e.innerHTML = newHtml[1];
        e.style.opacity = 1;
        e.setAttribute('data-id', newHtml[0]);
    } else {
        uniq(clickedEl);
    }

var returnRandom = function(){
    return options[Math.floor(Math.random() * options.length)]
}; 
```

e.id 将等于“第一”或“第二”。returnRandom() 将从选项数组中获取一个随机值：

```
var options = [
    '0|Flash',
    '1|Internet Explorer',
    '2|Java',
    '3|!important'
]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T23:42:22.877

您似乎正在向数组添加*非数字属性。*

该`indexOf()`方法旨在处理并返回数字属性。

此外...

*   处理`processAnswer`程序将元素的 ID 传递给`addHtml`...如“first”、“second”

*   `addHtml`使用该 ID 字符串获取存储在同名变量中的相同元素，然后将该元素传递给`uniq`

*   `uniq`向`justAdded`数组添加一个属性，键是元素的 ID。

您不断在传递元素及其 ID 之间切换，并在每个下一个函数中使用一个来获取另一个。这就是说你的代码看起来非常混乱，我认为你只需要从头开始重新思考你的代码。

* * *

还有，这到底是怎么回事？...

```
var options = [
    '0|Flash',
    '1|Internet Explorer',
    '2|Java',
    '3|!important'
]; 
```

为什么要将索引硬编码到数组中的字符串中？数组是有序列表。他们已经处理好索引。

```
var options = [
    'Flash',                // 0
    'Internet Explorer',    // 1
    'Java',                 // 2
    '!important'            // 3
]; 
```

# c++ - 输入字符串的大小

> ID：10762393
> 
> 赞同：2
> 
> 时间：2012-05-25T23:24:49.810
> 
> 标签：c++

我想知道无论我输入的长度如何，sizeof 函数如何返回 8

```
int main(){
   string input;
   getline(cin,input);
   cout << "size of input is  " << sizeof(input) << endl; //I am guessing 
//it returns the size of a pointer because my OS is 64 bits.
   return 0;
} 
```

所以我的问题是隐式转换发生在哪里？这是***getline***的声明，

```
istream& getline ( istream& is, string& str ); 
```

此外，这种转换总是会发生，即从任何类型到指针类型，是否存在一般情况？谢谢你。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-25T23:29:05.460

`sizeof`给你以字节为单位的大小。`std::string`包含指向实际数据的指针。无论它指向什么大小，单个指针的大小都保持不变。再加上其他因素，您的总尺寸为 8。

您正在寻找`std::string::size`或寻找`std::string::length`字符串的实际长度。如果您正在寻找一个函数来检索任何以 null 结尾的 C-String 的大小，请使用`strlen()`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T23:28:22.670

这里没有进行转换，它只是`sizeof`返回对象的实际字节大小。显然 std::string 使用堆分配的内存来存储其实际内容，因此您无法确切知道特定字符串总共使用了多少字节

# enumerate - 具有单个数字数组的枚举值，无需循环

> ID：10762398
> 
> 赞同：0
> 
> 时间：2012-05-25T23:25:21.870
> 
> 标签：enumerate

我正在为基于可视节点的 CAD 程序编写一些功能，该程序不允许我循环，因此我需要一种解决方法来枚举数字列表。我是一名几乎没有编程经验的架构师，所以任何帮助都会很棒。

A 有一个数字数组（numArray），因此 0,1,2,3,4...（第一列）我需要获取这些数字并将它们转换为第 1,2,3,4 列的对应值不使用任何循环或嵌套循环。

```
 numArray 1 2 3 4
        -----------
        0 = 0|0|0|0
        1 = 0|0|0|1
        2 = 0|0|0|2
        3 = 0|0|0|3
        4 = 0|0|1|0
        5 = 0|0|1|1
        6 = 0|0|1|2
        7 = 0|0|1|3
        8 = 0|0|2|0
        9 = 0|0|2|1
        10= 0|0|2|2
        12= 0|0|2|3
        13= 0|0|3|0
        14= 0|0|3|1
        15= 0|0|3|2
        16= 0|1|3|3
        17= 0|1|0|0
        18= 0|1|0|1
        19= 0|1|0|2
        20= 0|1|0|3
        21= 0|1|1|0
        22= 0|1|1|1
        23= 0|1|1|2
        24= 0|1|1|3 
```

我通过执行以下操作找出了第 4 列：

```
int column4 = numArray % 4; 
```

这可以工作并创建这样的数字 0,1,2,3,0,1,2,3 .... 这很好但是我不确定如何使用传入的 num 数组来生成第 3 列 2 和 1 . 同样，我的编程经验很少，所以任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T17:46:23.550

您正在将输入转换为以 4 为基数的表示法，这样就可以完成这项工作：

```
int input[] = {0,1,2,3,4,5,6,7,8,9,10,12,13,14,15,16,17,18,19,20,21,22,23,24};

for (int i = 0; i < sizeof(input)/sizeof(input[0]); i++)
{
    int c1, c2, c3, c4;

    c4 = input[i] % 4;
    c3 = (input[i] / 4) % 4;
    c2 = (input[i] / 16) % 4;
    c1 = (input[i] / 64) % 4;

    printf("%d = %d\t%d\t%d\t%d\n", input[i], c1, c2, c3, c4);
} 
```

# html - 保持文本内联

> ID：10762402
> 
> 赞同：1
> 
> 时间：2012-05-25T23:25:53.350
> 
> 标签：html, css

我有一个浮动到左侧的图像，然后是图像右侧的一些文本。但是，文本足够长，以至于段落的一行位于图像下方。如何使此文本与段落内联并防止其环绕图片？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T23:34:53.603

如果您的图像向左浮动，则诀窍是为您的文本包含的任何元素`margin-left`至少拥有图像的一个。`width`

例如，如果您的 HTML 类似于：

```
<img src="image.jpg">
<p>Some text 
```

你的图片宽度是160px，你必须给你的段落a`margin-left`至少160px（如果你给它`margin-left`比160px稍微大一点，它看起来会更好）。

这就是浮动图像后您需要做的所有事情，只需`margin-left`在其后面的段落上设置。您甚至不需要为段落指定宽度。

演示[http://dabblet.com/gist/2791183](http://dabblet.com/gist/2791183)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T00:36:41.613

如果您不想担心知道和设置任何宽度，您可以通过为文本容器[建立一个新的块格式化上下文来做到这一点。](http://www.w3.org/TR/CSS2/visuren.html#block-formatting)

即对于标记：

```
<img src="image.jpg">
<p>Some text 
```

您需要做的就是给`<p>`元素一个“可见”之外的溢出。例如：

```
p { overflow:auto; } 
```

在 上使用一点边距`<img>`将文本与图像分开。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T23:36:23.257

您需要分别浮动图像元素和文本元素。我认为您还需要为这两个元素指定宽度。

```
<img src"url()" style="float:left; width:100px;">
<div id="text" style="float:left; width:500px;">Words</div> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T23:39:37.997

如果您不将文本放置在另一个块元素中，那么它将始终环绕该另一个浮动元素。浮动的工作方式是从“文档流”中取出一个元素，[这里有一些关于浮动如何工作的更具体的信息](http://www.alistapart.com/articles/css-floats-101/)。让您的文本不换行的唯一方法是将其放在块元素（如`div`标签）内，然后将该元素与浮动图像一起浮动到左侧。

例子：

```
<div style="overflow: auto;">
    <img src="hello.jpg" style="float: left; width: 200px;">
    <div style="float: left; width: 700px;">
        Hello!!!
    </div>
</div> 
```

第一个`overflow: auto`将声明容器的高度。`clear: both`这与在图像和文本 div 下方添加 div 标签的概念相同。记住要经常清理你的花车！:)

# wordpress - 如何在 wordpress 中使用 wpml 自动注册字符串？

> ID：10762408
> 
> 赞同：1
> 
> 时间：2012-05-25T23:27:18.577
> 
> 标签：wordpress, translation

我正在尝试在 wordpress 中自动注册字符串，但由于某种原因它不起作用

当我调用主题代码时它可以工作：

```
esc_html_e('mytext','mythemename'); 
```

然后做

```
WPML->theme and plugins localization->strings in the theme->scan the theme for strings 
```

然后 mytext 出现在字符串列表中进行翻译

但如果我尝试启用：

```
 wpml->string translation->auto register strings for translation->auto-register strings always->apply 
```

在代码运行中，f.ex.：

```
$myvar='mytext';
esc_html_e($myvar,'mythemename'); 
```

然后，当然，我转到出现字符串的 wp 页面，但没有任何反应，字符串没有被添加到主题字符串列表中

有人知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T23:04:37.770

当我写的不是 esc_html_e 时，它​​开始添加字符串：

```
icl_register_string('mythemename','myvariable',$myvar);
echo icl_t('mythemename','myvariable',$myvar ); 
```

我敢肯定有更优雅的解决方案，但由于这个可行，它现在就可以了。

# ios - NSMutableData appendData 和 NSArray 数据

> ID：10762413
> 
> 赞同：0
> 
> 时间：2012-05-25T23:28:15.427
> 
> 标签：ios, nsmutabledata

要附加一个简单的字符串键值对，我们在对象 C 中执行此操作

```
 NSMutableData *body = [NSMutableData data];
[body appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"%@\";\r\n\r\n%@", _name, _value] dataUsingEncoding:NSUTF8StringEncoding]]; 
```

但是，我们如何附加 NSArray 的数据。假设电子邮件数组包含={tom@yahoo.com, dve@yahoo.com, john@yahoo.com}

我们如何将电子邮件数组附加到 NSMutableData 正文？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T22:01:53.643

您可以像使用单个字符串一样将数组转换为 NSString：

```
NSArray array = [[NSArray alloc] init];
...
[body appendData:[[NSString stringWithFormat:@"%@", array] dataUsingEncoding:NSUTF8StringEncoding]]; 
```

但我建议使用 NSKeyedArchiver，请参阅[此主题](https://stackoverflow.com/questions/1286212/how-to-convert-nsarray-to-nsdata)

# java - 如何处理 Composite 对象的所有子对象？

> ID：10762415
> 
> 赞同：1
> 
> 时间：2012-05-25T23:28:24.147
> 
> 标签：java, swt, dispose, composite

我有一个

```
Composite descComp 
```

里面有一些东西......基本上它是一个表单的容器，由许多标签、组合和按钮组成，所有这些都排成一行。我的表单不是有限的，我有一个按钮，可以添加一行额外的输入。然而，为了让它工作，我必须处理我的 descComp 的老孩子......

```
private void populateConstantMain(ContentData tariffConstantsOfType, Composite descComp,GridLayout descCompLayout, Boolean resize) {

    int arraySize;

    if (resize == false) {
        arraySize = tariffConstantsOfType.getQueryRowCount();
    } else {
        for (int i = 0 ; i < descComp.getChildren().length; i++) {
            System.out.println("Disposing: " + i + " " + descComp.getChildren()[i].toString());
            //descComp.getChildren()[i].setEnabled(false);
            descComp.getChildren()[i].dispose();
        }
        arraySize = tariffConstantsOfType.getQueryRowCount() + 1;
    }
......
} 
```

由于某些原因

```
descComp.getChildren()[i].dispose(); 
```

不起作用，这意味着它不会处理所有孩子，这会导致插入新孩子时出错，从而破坏布局：/有趣的是

```
descComp.getChildren()[i].setEnabled(false); 
```

工作，当我取消它，为所有孩子...

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-25T23:56:07.813

我有一种预感，在复合材料上调用 getChildren() 只会在您调用它时返回未处置的孩子。因此，当您的索引在增加但数组的大小正在减小时，调用`descComp.getChildren()[i].dispose();`会变得一团糟。你为什么不试试：

```
 for (Control control : descComp.getChildren()) {
        control.dispose();
    } 
```

通过这种方式，您可以在开始处理每个子项之前获得合成中子项的静态视图。

我还切换了代码以使用更好的 J5 for-each 语法。如果你被困在 J1.4 上，那么不幸的是你需要坚持`for(;;)`循环：

```
 Control[] children = descComp.getChildren();
    for (int i = 0 ; i < children.length; i++) {
        children[i].dispose();
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T18:41:46.480

在处理子项（或数组中的任何内容）时，我使用 for next 循环，但从头到尾进行，而不是从头到尾。（并在循环之前获取长度，否则它会改变。）

```
int i = length-1;i>=0;i-- 
```

否则你删除所有其他的。

# ios - UITextView 内容宽度随着输入时高度的增加而缩小。为什么我会看到这种行为？

> ID：10762420
> 
> 赞同：1
> 
> 时间：2012-05-25T23:29:41.823
> 
> 标签：ios, cocoa-touch, uitextview

在 UITextView 委托方法中，我在输入时打印它的 Frame 和 Content Size。

```
 - (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text
     {   
               NSLog(@"textView Frame: %@ Content Size:%@",NSStringFromCGRect(textView.frame),NSStringFromCGSize(textView.contentSize));
               return YES;
      } 
```

我所看到的非常令人费解。内容宽度随着我键入时向上滚动的文本高度增加而不断缩小。textView 的框架保持不变。为什么我会看到这种行为？

```
2012-05-25 16:18:53.349  textView Frame: {{20, 12}, {65, 40}} Content Size:{271, 74}
2012-05-25 16:18:53.405  textView Frame: {{20, 12}, {65, 40}} Content Size:{270, 74}
2012-05-25 16:18:53.412  textView Frame: {{20, 12}, {65, 40}} Content Size:{269, 74}
2012-05-25 16:18:53.508  textView Frame: {{20, 12}, {65, 40}} Content Size:{268, 132}
2012-05-25 16:18:53.516  textView Frame: {{20, 12}, {65, 40}} Content Size:{267, 132}
2012-05-25 16:18:53.613  textView Frame: {{20, 12}, {65, 40}} Content Size:{266, 132}
2012-05-25 16:18:53.621  textView Frame: {{20, 12}, {65, 40}} Content Size:{265, 132}
2012-05-25 16:18:53.684  textView Frame: {{20, 12}, {65, 40}} Content Size:{264, 132}
2012-05-25 16:18:53.709  textView Frame: {{20, 12}, {65, 40}} Content Size:{263, 132}
2012-05-25 16:18:53.789  textView Frame: {{20, 12}, {65, 40}} Content Size:{262, 132}
2012-05-25 16:18:53.813  textView Frame: {{20, 12}, {65, 40}} Content Size:{261, 132}
2012-05-25 16:18:53.868  textView Frame: {{20, 12}, {65, 40}} Content Size:{260, 132}
2012-05-25 16:18:53.949  textView Frame: {{20, 12}, {65, 40}} Content Size:{259, 132}
2012-05-25 16:18:54.029  textView Frame: {{20, 12}, {65, 40}} Content Size:{258, 132}
2012-05-25 16:18:54.045  textView Frame: {{20, 12}, {65, 40}} Content Size:{257, 132}
2012-05-25 16:18:54.173  textView Frame: {{20, 12}, {65, 40}} Content Size:{256, 132}
2012-05-25 16:18:54.180  textView Frame: {{20, 12}, {65, 40}} Content Size:{255, 132}
.......
2012-05-25 16:19:00.420 textView Frame: {{20, 12}, {65, 40}} Content Size:{119, 1524}
2012-05-25 16:19:00.477 textView Frame: {{20, 12}, {65, 40}} Content Size:{118, 1582} 
```

**编辑：** 更多细节。当我创建这个 textView 时，我正在创建它具有更大的帧大小并将其缩小并将其添加到它的超级视图中。我这样做的原因是，当 textView 的超级视图被缩放时，textView 内的文本不会变得模糊。

```
float Scale = 5.0;
CGRect rect = ... (original frame of myTextView)
myTextView = [[UITextView alloc] initWithFrame:CGRectMake(0,0,rect.size.width*Scale, rect.size.height*Scale)];
myTextView.transform = CGAffineTransformMakeScale(1.0/originalScale,1.0/originalScale); 
```

这种方法效果很好，但似乎它导致了这个错误。（因为当我关闭缩放时，这个问题不会发生）。

# javascript - JavaScript 中弹出窗口的回调

> ID：10762423
> 
> 赞同：3
> 
> 时间：2012-05-25T23:29:52.193
> 
> 标签：javascript, callback, popup, window

我希望我的功课做得很好，在过去的几个小时里搜索互联网并尝试一切，然后再发帖到这里，但我真的很接近说这是不可能的，所以这是我最后的选择。

我想要一个简单的东西（但在 JavaScript 中似乎很难）：

1.  单击按钮-> 打开窗口（使用 window.open）
2.  在弹出窗口中执行操作并将值返回给父级（开启者）

但我想以系统的方式实现它，为此弹出定义一个回调；就像是：

```
var wnd = window.open(...)
wnd.callback = function(value) {
    console.log(value);
}; 
```

我尝试在弹出窗口 JS 代码中定义回调属性：

```
var callback = null; 
```

不幸的是，这不起作用，因为...

```
$('#action').click(function() {
    console.log(callback);
}); 
```

...返回我最初设置的那个“null”。

我还尝试在窗口加载后在父窗口中设置回调（通过 window.onload=... 和 $(window).ready()），都没有工作。

我还尝试在子窗口源代码中定义一些方法来在内部注册回调：

```
function registerCallback(_callback)
{
    callback = _callback; // also window.callback = _callback;
} 
```

但结果相同。

而且我没有更多的想法。当然，使用 window.opener 设置值很简单，但我会失去这个子窗口所需的大部分灵活性（实际上是 DAM 系统的资产选择器）。

如果您有一些想法，请分享。谢谢你一百万！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T23:40:55.030

`postMessage`想到了HTML5 。它旨在完成您想要完成的工作：从一个窗口发布消息并在另一个窗口中处理它。

[https://developer.mozilla.org/en/DOM/window.postMessage](https://developer.mozilla.org/en/DOM/window.postMessage)

需要注意的是，它是一个相对较新的标准，因此较旧的浏览器可能不支持此功能。

[http://caniuse.com/#feat=x-doc-messaging](http://caniuse.com/#feat=x-doc-messaging)

* * *

使用起来非常简单：

要从源窗口发送消息：

```
window.postMessage("message", "*");
//'*' is the target origin, and should be specified for security 
```

要在目标窗口中侦听消息：

```
window.addEventListener
("message", function(e) {
console.log(e.data); //e.data is the string message that was sent.
}, true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T15:10:09.183

After few more hours of experiments, I think, I've found a viable solution for my problem.

The point is to reference jQuery from parent window and trigger a jQuery event on this window (I'm a Mac user but I suppose, jQuery has events working cross-platform, so IE compatibility is not an issue here).

This is my code for click handler on anchor...

```
$(this).find('a[x-special="select-asset"]').click(function() {
    var evt = jQuery.Event('assetSelect', {
        url:        'this is url',
        closePopup: true,
    });
    var _parent = window.opener;
    _parent.jQuery(_parent.document).trigger(evt);
}); 
```

... and this is the code of event handler:

```
$(document).bind('assetSelect', function (evt) {
    console.log(evt);
}); 
```

This solution is fine, if you don't need to distinguish between multiple instances of the asset selection windows (only one window will dispatch "assetSelect" event). I have not found a way to pass a kind of tag parameter to window and then pass it back in event.

Because of this, I've chosen to go along with (at the end, better and visually more pleasant) solution, Fancybox. Unfortunately, there is no way - by default - to distinguish between instances either. Therefore, I've extended Fancybox as I've described in my blog post. I'm not including the full text of blog post here, because is not the topic of this question.

URL of the blog post: [http://82517.tumblr.com/post/23798369533/using-fancybox-with-iframe-as-modal-dialog-on-a-web](http://82517.tumblr.com/post/23798369533/using-fancybox-with-iframe-as-modal-dialog-on-a-web)

# html - HTML / CSS省略号（...）不工作

> ID：10762424
> 
> 赞同：5
> 
> 时间：2012-05-25T23:30:13.023
> 
> 标签：html, css, text, overflow, ellipsis

我正在尝试在我的网站上使用省略号。这是以下 HTML / CSS 代码，它似乎不起作用。

CSS：

```
.oneline {
text-overflow:ellipsis;
white-space: nowrap;
width: 50px;
overflow: hidden;
} 
```

HTML：

```
<div class="oneline">Testing 123 Testing 456 Testing 789</div> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-25T23:41:44.577

根据[最初的帖子](https://stackoverflow.com/posts/10762424/revisions)，我们都假设很明显，但以防万一......;）

```
<style type="text/css">
    .oneline {
        text-overflow : ellipsis;
        white-space   : nowrap;
        width         : 50px;
        overflow      : hidden;
    }
</style>
<div class="oneline">Testing 123 Testing 456 Testing 789</div> 
```

[http://jsfiddle.net/NawcT/](http://jsfiddle.net/NawcT/)

**编辑**：解决方案是设置段落与 div 的样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-15T11:24:07.360

分配`position:absolute`给要截断的元素可能会产生较少的不良副作用`float:left`。

这对我有用：

```
div {
  position: absolute;
  width: 70px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
} 
```

# java - 如何在 Java 中为 Solr 创建通用日期格式化程序？

> ID：10762428
> 
> 赞同：7
> 
> 时间：2012-05-25T23:31:09.870
> 
> 标签：java, date, solr, date-format

我有一个要求，在将日期索引到 Solr 之前，可以以下列格式传递日期。以下是通过日期的示例

```
String dateStr = "2012-05-23T00:00:00-0400";
String dateStr1 = "May 24, 2012 04:57:40 GMT";
String dateStr2 = "2011-06-21"; 
```

标准 Solr 格式是**"yyyy-MM-dd'T'HH:mm:ss'Z'"**。

我尝试过 SimpleDateFormat 但无法编写通用程序来支持各种格式。它最终抛出解析异常。

我也尝试了 joda time，但到目前为止在 UTC 转换中还没有成功。

```
public static String toUtcDate(final String iso8601) {
        DateTime dt = ISO_PARSE_FORMAT.parseDateTime(iso8601);
        DateTime utcDt = dt.withZone(ZONE_UTC);
        return utcDt.toString(ISO_PRINT_FORMAT);
    }
```

是否有一个标准库来实现这一点？

任何指针将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-25T23:45:56.807

我只是尝试各种格式，直到获得成功：

```
public static String toUtcDate(String dateStr) {
    SimpleDateFormat out = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'");
    // Add other parsing formats to try as you like:
    String[] dateFormats = {"yyyy-MM-dd", "MMM dd, yyyy hh:mm:ss Z"}; 
    for (String dateFormat : dateFormats) {
        try {
            return out.format(new SimpleDateFormat(dateFormat).parse(dateStr));
        } catch (ParseException ignore) { }
    }
    throw new IllegalArgumentException("Invalid date: " + dateStr);
} 
```

我不知道有这样做的图书馆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T00:10:48.383

答案是： [Converting ISO 8601-compliant String to java.util.Date](https://stackoverflow.com/questions/2201925/converting-iso8601-compliant-string-to-java-util-date)

一旦你有了你的日期，你就知道如何获得你的 UTC 时间。

* * *

编辑：接受的答案不使用joda time，而是使用jaxb。

顺便问一下，这些格式从何而来？

```
String dateStr = "2012-05-23T00:00:00-0400";
String dateStr1 = "May 24, 2012 04:57:40 GMT";
String dateStr2 = "2011-06-21"; 
```

如果它们与另一个语言环境不同，则它们可能是由 DateFormat.getDateTimeInstance(...,...) 生成的，因此也许尝试找出已使用的。

# twitter - getJSON 推特

> ID：10762430
> 
> 赞同：0
> 
> 时间：2012-05-25T23:31:24.430
> 
> 标签：twitter, getjson

尝试使用 JSON 获取推文。我有推文 ID，但没有任何返回。有任何想法吗？

这是我使用的代码

```
$.getJSON("https://api.twitter.com/1/statuses/show.json?id=204981356940369920", function(data) {
 $("#twitter").html(data[0].text); 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T16:48:08.570

那是返回 JSON。由于[同源安全策略](https://developer.mozilla.org/en/Same_origin_policy_for_JavaScript)，您需要使用[JSONP](http://remysharp.com/2007/10/08/what-is-jsonp/)。

所以，调用需要

```
https://api.twitter.com/1/statuses/show.json?id=204981356940369920&callback=whatever 
```

如果你使用 jQuery，你可以使用

```
https://api.twitter.com/1/statuses/show.json?id=204981356940369920&callback=? 
```

jQuery 会自动添加回调

# javascript - 我如何结合两种形式

> ID：10762431
> 
> 赞同：-3
> 
> 时间：2012-05-25T23:31:34.067
> 
> 标签：javascript, jquery, html, forms

我想在提交form2时将form1中的所有字段添加到form 2中，而不必提前知道form1中的每个值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T23:52:08.270

acrashik 是对的，但它需要在第 1 行进行更正才能正确连接字符串：

```
var form1Data = $('#form1').serialize(),
   data = (form1Data !== "" ? form1Data + "&" : "") + $('#form2').serialize();
$.ajax({
  type: 'POST',
  url: 'your_url',
  data: data
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T23:43:24.153

```
var data = $('#form1').serialize() + '&' + $('#form2').serialize();
$.ajax({
  type: 'POST',
  url: 'your_url',
  data: data
}); 
```

# php - 准备好的语句函数

> ID：10762433
> 
> 赞同：0
> 
> 时间：2012-05-25T23:31:38.813
> 
> 标签：php, mysql, sql

好的，所以我在 php 中学习准备好的语句，因为我听说它们比 mysql 更安全

所以现在我刚刚掌握了功能。我制作了一个连接到 mysql db 的函数，并将它放在我想要使用它的页面的不同文件夹中。所以我希望我的所有主要功能都在一个文件中，然后我想从我需要它们的页面上的文件中调用它们。但是现在php不喜欢它。

这是我的functions.php页面

```
function mysqlconnect(){

$host = 'localhost';
$port = 3306; // This is the default port for MySQL
$database = '';
$username = '';
$password = '';

// Construct the DSN, or "Data Source Name".  Really, it's just a fancy name
// for a string that says what type of server we're connecting to, and how
// to connect to it.  As long as the above is filled out, this line is all
// you need :)
$dsn = "mysql:host=$host;port=$port;dbname=$database";

// Connect!
$db = new PDO($dsn, $username, $password);
} 
```

这是我的测试页面，只是测试调用该函数。

```
include 'functions/functions.php';

mysqlconnect();

$_POST['fish'] = "shadow" ;

$statement = $db->prepare("SELECT * FROM users WHERE username = ?");
$statement->execute(array($_POST['fish']));

while ($result = $statement->fetchObject()) {
    echo $result->username;
    echo "<br />";
} 
```

请注意，我包含该文件并调用该函数，但我得到：

注意：未定义变量：db 致命错误：在非对象上调用成员函数 prepare()

如果我将连接放在同一个 php 文件中，一切正常。但是当然 id 就像同一个文件中的所有函数一样，只要我需要它们就调用它们。我究竟做错了什么 ？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:35:57.177

`$db`在函数内部，不能在外部使用。查看[变量范围](http://php.net/manual/en/language.variables.scope.php)。您可以声明`$db`为全局变量，也可以`$db`从函数返回然后设置`$db=mysqlconnect()`。有许多其他方法可以做到这一点，但你有它，它不能做到。

旁注：我个人会这样做：

```
function mysqlconnect(){
    /* your code here*/
    return $db;
}
$db = mysqlconnect(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T23:36:05.237

`$db`是在函数内部定义的，所以它不能成为全局的。它的作用域在函数结束时结束。

你应该定义`$db` *你*的功能。

一个不太优雅的解决方案：

```
function mysqlconnect(){
  global $db; 
  $host = 'localhost';
  // etc.etc.
  $db = new PDO($dsn, $username, $password);
} 
```

请注意，使用`global`，特别是在这种情况下，是一种非常糟糕的做法（它会破坏代码的清洁度、代码的可重用性，并可能导致其他几个问题）。

一个更优雅的解决方案（就像其他用户说的那样）：

```
function mysqlconnect(){

  $host = 'localhost';
  // etc.etc.
  $db = new PDO($dsn, $username, $password);
  return $db;
} 
```

然后在您的测试页面中：

```
$db = mysqlconnect(); 
```

这很有用，因为您可以使用任何变量名称：使您的代码在其他场景中更可重用。

```
$donaldduck = mysqlconnect(); 
```

也可以。

# asp.net-mvc-3 - 更改 Init 时 TinyMCE 不回发

> ID：10762436
> 
> 赞同：0
> 
> 时间：2012-05-25T23:32:12.413
> 
> 标签：asp.net-mvc-3, tinymce

我对 tinyMCE 有一个奇怪的问题。

我有一个 .js 文件，内容如下：

```
tinyMCE.init({
mode: "textareas",
theme: "advanced",
theme_advanced_toolbar_location: "top",
theme_advanced_buttons1: "italic,underline,separator,justifyleft,justifycenter,justifyright,separator,formatselect,separator,bullist,numlist,link,unlink",
theme_advanced_buttons2: "",
theme_advanced_buttons3: ""
}) 
```

当我注释掉所有行时，tinyMCE 编辑器会将值正确回传到我的 HttpPost Edit() 函数（我使用的是 ASP.NET MVC3）。编辑器是具有所有完整按钮和高级主题的默认编辑器。但我想要的是一个带有几个按钮的简单编辑器，这就是为什么我拥有上述所有设置的原因。当它们如上时，tinymce 编辑器看起来像我指定的那样（所以我的脚本链接从 .cshtml 中是正确的），但问题是内容没有回发到 HttpPost 函数，所以值没有改变。

为什么是这样？我从浏览器中检查了两个版本的查看源代码，它们也是相同的。

仅供参考，根据搜索，我还添加了以下内容：

```
$(document).ready(function () {

$("#mySubmitButton").click(function () {
    tinyMCE.triggerSave();
});
}) 
```

但显然到目前为止它没有任何效果。

提前感谢您的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T08:39:50.983

只是一点点的想法。您能否确保您的 js 文件和您的页面位于同一个文件夹中（？）。

# ruby - Microsoft Word 符号的编码问题 [ UTF-8 到 ISO-5589-1 ]

> ID：10762441
> 
> 赞同：2
> 
> 时间：2012-05-25T23:33:15.907
> 
> 标签：ruby, ruby-on-rails-3, encoding, content-type, decoding

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T03:39:45.820

由于内置的[​​ String#force_encoding](http://ruby-doc.org/core-1.9.3/String.html#method-i-force_encoding)方法会将多字节符号转换为自身的表示，而不是替换，因此您不能使用它。

```
str = "“ ” ’"
str.force_encoding("ISO-8859-1")
#=> "\xE2\x80\x9C \xE2\x80\x9D \xE2\x80\x99" 
```

您可以尝试[String#encode](http://ruby-doc.org/core-1.9.3/String.html#method-i-encode)，但这只能用某些东西替换*所有*无效/未定义的字符，而不是单独替换每个字符。

```
str = "“ ” ’"
str.encode("ISO-8859-1", :invalid => :replace, :undef => :replace, :replace => "")
#=> "  "

str = "“ ” ’ €"
str.encode("ISO-8859-1", :invalid => :replace, :undef => :replace, :replace => "'")
#=> "' ' ' '" 
```

最有可能的是，您需要编写或找到一个库来维护 unicode 多字节字符和它们对应的 ASCII 字符之间的关系，并使用它。

# java - Eclipse XSB InterProlog Setup

> ID：10762442
> 
> 赞同：1
> 
> 时间：2012-05-25T23:33:16.513
> 
> 标签：java, eclipse, prolog, xsb, interprolog

I'm trying to set up InterProlog in eclipse.

My path variable already has the path to jdk1.7 and I already have xsb installed. I attached interprolog.jar as an external jar, added the xsb to my path variable (C:\Users\MyName\config\x86-pc-windows\bin), and I added the path to my xsb bin to the NativeEngine constructor (See below).

When I run the HelloWorld program:

```
PrologEngine engine = new NativeEngine("C:\\Users\\MyName\\xsb\\bin");
engine.command("import append/3 from basics");
Object[] bindings = engine.deterministicGoal("name(User,UL),append(\"Hello,\", UL, ML), name(Message,ML)", "[string(User)]", new Object[]{System.getProperty("user.name")}, "[string(Message)]");
String message = (String)bindings[0];
System.out.println("\nMessage:"+message);
bindings = engine.deterministicGoal("name('"+System.getProperty("user.name")+"',UL),append(\"Hello,\", UL, ML), name(Message,ML)","[string(Message)]");
System.out.println("Same:"+bindings[0]);
System.exit(0); 
```

I get (from the first line):

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: com.xsb.interprolog.NativeEngine.xsb_setDebug(Z)V
    at com.xsb.interprolog.NativeEngine.xsb_setDebug(Native Method)
    at com.xsb.interprolog.NativeEngine.<init>(NativeEngine.java:89)
    at com.xsb.interprolog.NativeEngine.<init>(NativeEngine.java:52)
    at com.xsb.interprolog.NativeEngine.<init>(NativeEngine.java:48)
    at HelloWorld.main(HelloWorld.java:12) 
```

Any ideas on how to solve? Thanks :)

# iphone - 屏幕关闭时在 iPhone 上按下按钮时收到通知

> ID：10762444
> 
> 赞同：3
> 
> 时间：2012-05-25T23:33:22.197
> 
> 标签：iphone, objective-c, ios, events, button

我打算创建一个救生应用程序，我需要与 iPhone 上的任何物理按钮（主页、音量、锁定）集成。当屏幕关闭时（在非越狱设备上），这是否可能以编程方式实现？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T01:53:57.667

我喜欢你的想法，但我认为这不会在非越狱设备上获得。如果您的应用程序是由播放/暂停、下一步和返回的组合触发的，@Andrews 答案可能会起作用，但需要您的应用程序始终是设备音频控件的响应者，这仅在用户关闭您的应用程序之间才有可能，并启动任何其他控制设备音频的东西。（可能不会那么长）

假设这将是 iOS 版本的 Life Alert，它会为用户拨打紧急服务，那么每次手机在口袋里按下几个按钮时，要防止应用程序产生误报并拨打 911 就太困难了，钱包等。而越狱则可能会听到某种模式（例如，主页按钮 - 按下、按下、按住、按下、按下）

除此之外，尝试将锁定屏幕上的任何内容用于其预期目的之外的其他用途很可能会导致 Apple 拒绝。他们非常注重用户体验，并且希望您的应用程序无论如何都会干扰设备的任何功能。

再一次，我认为你有一个好主意，但我很遗憾地说它可能无法在 iOS 上实现。祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T00:07:19.917

您不应将硬件按钮用于其他用途，否则 Apple 将拒绝您的应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T01:14:17.417

没有办法直接得到它，但是有几种方法可以通过迂回的方式得到它。

例如，如果您创建一个[MPMusicPlayerController](http://developer.apple.com/library/ios/#documentation/mediaplayer/reference/MPMusicPlayerController_ClassReference/Reference/Reference.html)对象，您可以注册 MPMusicPlayerControllerVolumeDidChangeNotification，当音量发生变化时您会收到通知。音量变化可以通过按下硬件音量按钮来实现，但还有其他条件可以触发它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T23:47:42.107

不见得。苹果很好地锁定了这些东西。

# iphone - iOS：推送相同的视图控制器

> ID：10762445
> 
> 赞同：2
> 
> 时间：2012-05-25T23:33:22.147
> 
> 标签：iphone, ios, xcode, uiview

如果我有一个按钮，并且我想使用相同的控制器为默认的“UI Page Slide”设置动画，那么在单击“nextbutton”时如何实现？我认为这会奏效，但事实并非如此。

```
- (IBAction)NextButton:(id)sender
{
    [self.navigationController pushViewController:self animated:YES];
    NSInteger CurrentQuestionNumber = [QuestionNumber intValue];
    NSInteger NewQuestionNumber = CurrentQuestionNumber + 1;
    QuestionNumber = [NSString stringWithFormat:@"%d", NewQuestionNumber];
    QuestionNumberLabel.text = QuestionNumber;
    QuestionLabel.text = [QuestionsList objectForKey:QuestionNumber];
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T23:51:37.073

你需要实例化同一个类的一个新实例，而不是推送 self，然后推送它来替换`self`. 然后，您可以获取相关数据并将其解析到`-viewDidLoad`方法中的接口中。

```
SameClassAsSelf *new_self = [[SameClassAsSelf alloc] init...];
new_self.questionNumber = QuestionNumber;
new_self.questionsList = QuestionsList; //if needed
[self pushViewController:new_self animated:YES];
[new_self release]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T23:48:51.940

从文档中[`pushViewController:animated:`](http://developer.apple.com/library/ios/documentation/uikit/reference/UINavigationController_Class/Reference/Reference.html#//apple_ref/occ/instm/UINavigationController/pushViewController%3aanimated%3a)：

> *视图控制器*
> 
> 压入堆栈的视图控制器。此对象不能是选项卡栏控制器的实例，并且它不能已经在导航堆栈上。

你不断推`self`入导航堆栈。由于它已经在堆栈中，导航控制器可能会忽略推送，并且因为您正在修改视图中的标签，所以看起来标签正在更改而没有任何动画。（因为这正是正在发生的事情。）

# javascript - 将地理位置添加到现有的谷歌地图

> ID：10762453
> 
> 赞同：1
> 
> 时间：2012-05-25T23:36:24.397
> 
> 标签：javascript, google-maps

嗨，我正在根据此示例[http://econym.org.uk/gmap/example_categories.htm](http://econym.org.uk/gmap/example_categories.htm)制作地图，并尝试为其添加地理位置，但每次我尝试添加地理位置代码时，它都会破坏其余部分代码，所以我希望有人能指出我如何让​​它工作的正确方向

我是谷歌地图和地理位置的新手

很抱歉，如果之前有人问过这个问题，我只是找不到我需要的答案

这是我用于 index.html 页面的代码

```
<!DOCTYPE html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>

<link href="test.css" rel="stylesheet" type="text/css" media="all">
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script> 
<script type="text/javascript" src="scripts/downloadxml.js"></script>
<script type="text/javascript" src="scripts/map.js"></script>
</head>

 <body onload="initialize()">
 <div class="main-container">
 <img class="logo" src="images/testlogo.png" width="1000" height="150">
 <div class="overall">

 <div class="sidebar1">
 <p>Home</p>
 <p>About Us</p>
 <p>Contact Us</p>
 <p>My Portfolio</p>
 <p>Links</p>
 </div>

 <div class="sidebar2">

 <p>Hi My name is Robert Baron Austin and I'm the designer of this website and other sites like Spinfish.co.uk which was my first ever website that I handcoded by myself by using Dreamweaver, Photoshop and Illustrator.</p>

 </div>

 <div class="content1">

 <p>Hi My name is Robert Baron Austin and I'm the designer of this website and other sites like Spinfish.co.uk bacwhich was my first ever website that I handcoded by myself by using Dreamweaver, Photoshop and Illustrator.</p>

 </div>

 <div class="content2">

 <p>Hi My name is Robert Baron Austin and I'm the designer of this website and other sites like Spinfish.co.uk which was my first ever website that I handcoded by myself by using Dreamweaver, Photoshop and Illustrator.</p>

 </div>

 <div class="content3">

 <p>Hi My name is Robert Baron Austin and I'm the designer of this website and other sites like Spinfish.co.uk which was my first ever website that I handcoded by myself by using Dreamweaver, Photoshop and Illustrator.</p>

 </div>

 <div class="content4">

 <p class="images1"><img class="otherpics" src="../f5770309.jpg" width="150" height="150"></p>
 <p>Hi My name is Robert Baron Austin and I'm the designer of this website and other sites like Spinfish.co.uk which was my first ever website that I handcoded by myself by using Dreamweaver, Photoshop and Illustrator.</p>
 </div>

 <div class="content5">

 <p>Hi My name is Robert Baron Austin and I'm the designer of this website and other sites like Spinfish.co.uk which was my first ever website that I handcoded by myself by using Dreamweaver, Photoshop and Illustrator.</p>

 </div>

 <div class="content6">

 <p><div id="map"></div>

 <form class="form" action="#">
   Theatres: <input type="checkbox" id="theatrebox" onclick="boxclick(this,'theatre')" /> &nbsp;&nbsp;
   Golf Courses: <input type="checkbox" id="golfbox" onclick="boxclick(this,'golf')" /> &nbsp;&nbsp;
   Test: <input type="checkbox" id="testbox" onclick="boxclick(this,'test')" /> &nbsp;&nbsp;
   Tourist Information: <input type="checkbox" id="infobox" onclick="boxclick(this,'info')" /><br />
 </form></p>

<div id="side_bar"></div>

 </div>

 </div>

 <div class="footer">footer</div>

 </div></div></body>
 </html> 
```

这是javascript

```
//<![CDATA[
  // this variable will collect the html which will eventually be placed in the side_bar 
  var side_bar_html = ""; 

  var gmarkers = [];
  var gicons = [];
  var map = null;

var infowindow = new google.maps.InfoWindow(
 { 
  size: new google.maps.Size(150,50)
  });

  var iconImage = new google.maps.MarkerImage('mapIcons/marker_red.png',
   // This marker is 20 pixels wide by 34 pixels tall.
   new google.maps.Size(20, 34),
   // The origin for this image is 0,0.
   new google.maps.Point(0,0),
   // The anchor for this image is at 9,34.
   new google.maps.Point(9, 34));
  var iconShadow = new google.maps.MarkerImage('http://www.google.com/mapfiles/shadow50.png',
   // The shadow image is larger in the horizontal dimension
   // while the position and offset are the same as for the main image.
   new google.maps.Size(37, 34),
   new google.maps.Point(0,0),
   new google.maps.Point(9, 34));
   // Shapes define the clickable region of the icon.
   // The type defines an HTML &lt;area&gt; element 'poly' which
   // traces out a polygon as a series of X,Y points. The final
   // coordinate closes the poly by connecting to the first
   // coordinate.
   var iconShape = {
   coord:   [9,0,6,1,4,2,2,4,0,8,0,12,1,14,2,16,5,19,7,23,8,26,9,30,9,34,11,34,11,30,12,26,13,24,14,21,16,18,18,16,20,12,20,8,18,4,16,2,15,1,13,0],
  type: 'poly'
  };

    //Custom marker function
        function createMarker(point) {

    //Create the markers
        return new google.maps.Marker({
        position: point,
        map: map,
        draggable: false

    });

 }

  // A function to create the marker and set up the event window
  function createMarker(latlng,name,html,category) {
  var contentString = html;
  var marker = new google.maps.Marker({
    position: latlng,
    icon: gicons[category],
    shadow: iconShadow,
    map: map,
    title: name,
    zIndex: Math.round(latlng.lat()*-100000)<<5
    });
    // === Store the category and name info as a marker properties ===
    marker.mycategory = category;                                 
    marker.myname = name;
    gmarkers.push(marker);

  google.maps.event.addListener(marker, 'click', function() {
    infowindow.setContent(contentString); 
    infowindow.open(map,marker);
    });
 }

  // == shows all markers of a particular category, and ensures the checkbox is checked ==
  function show(category) {
    for (var i=0; i<gmarkers.length; i++) {
      if (gmarkers[i].mycategory == category) {
        gmarkers[i].setVisible(true);
      }
    }
    // == check the checkbox ==
    document.getElementById(category+"box").checked = true;
  }

  // == hides all markers of a particular category, and ensures the checkbox is cleared ==
  function hide(category) {
    for (var i=0; i<gmarkers.length; i++) {
      if (gmarkers[i].mycategory == category) {
        gmarkers[i].setVisible(false);
      }
    }
    // == clear the checkbox ==
    document.getElementById(category+"box").checked = false;
    // == close the info window, in case its open on a marker that we just hid
    infowindow.close();
  }

  // == a checkbox has been clicked ==
  function boxclick(box,category) {
    if (box.checked) {
      show(category);
    } else {
      hide(category);
    }
    // == rebuild the side bar
    makeSidebar();
  }

  function myclick(i) {
    google.maps.event.trigger(gmarkers[i],"click");
  }

  // == rebuilds the sidebar to match the markers currently displayed ==
  function makeSidebar() {
    var html = "";
    for (var i=0; i<gmarkers.length; i++) {
      if (gmarkers[i].getVisible()) {
        html += '<a href="javascript:myclick(' + i + ')">' + gmarkers[i].myname + '<\/a><br>';
      }
    }
    document.getElementById("side_bar").innerHTML = html;
  }

 function initialize() {
  var myOptions = {
   zoom: 10,
   center: new google.maps.LatLng(53.8363,-3.0377),
    mapTypeId: google.maps.MapTypeId.ROADMAP
  }
  map = new google.maps.Map(document.getElementById("map"), myOptions);

  google.maps.event.addListener(map, 'click', function() {
    infowindow.close();
    });

  // Read the data
  downloadUrl("categories.xml", function(doc) {
  var xml = xmlParse(doc);
  var markers = xml.documentElement.getElementsByTagName("marker");

    for (var i = 0; i < markers.length; i++) {
      // obtain the attribues of each marker
      var lat = parseFloat(markers[i].getAttribute("lat"));
      var lng = parseFloat(markers[i].getAttribute("lng"));
      var point = new google.maps.LatLng(lat,lng);
      var address = markers[i].getAttribute("address");
      var name = markers[i].getAttribute("name");
      var html = "<b>"+name+"<\/b><p>"+address;
      var category = markers[i].getAttribute("category");
      // create the marker
      var marker = createMarker(point,name,html,category);
    }

    // == show or hide the categories initially ==
    hide("theatre");
    hide("golf");
    hide("info");
    hide("test");
    // == create the initial sidebar ==
    makeSidebar();
  });
 }

 // This Javascript is based on code provided by the
 // Community Church Javascript Team
 // http://www.bisphamchurch.org.uk/   
 // http://econym.org.uk/gmap/
 // from the v2 tutorial page at:
 // http://econym.org.uk/gmap/example_categories.htm
 //]]> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T00:06:06.087

For a start you have to use `sensor=true` when including the Google Maps API

```
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script> 
```

# python - 在 Kivy 中从内存中加载图像

> ID：10762454
> 
> 赞同：7
> 
> 时间：2012-05-25T23:36:59.387
> 
> 标签：python, matplotlib, kivy

我在内存中有一张图片格式（从pyplot输出），我想通过Kivy直接在Android上显示它，但我不想创建图片文件。有没有办法做到这一点？在 pyplot 上，我可以通过将对象写入对象来生成类似对象的文件，但我不知道如何将其放入 Kivy。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2018-09-12T18:21:43.953

类似于第一个答案，但不需要 img_pygame：

```
 from kivy.core.image import Image as CoreImage
    from kivy.uix.image import Image
    import io
    import qrcode # specific to my usecase, interchangeable with Pil.Image
    # OR
    from PIL import Image as PilImage

    msg = "text"
    image = Image(source="")
    imgIO = io.BytesIO()
    qr = qrcode.make(msg) # returns PilImage object
    qr.save(imgIO, ext='png') # equivalent to Pil.Image.save()
    imgIO.seek(0)
    imgData = io.BytesIO(imgIO.read())
    image.texture = CoreImage(imgData, ext='png').texture
    image.reload() 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-10-22T17:39:53.557

如果您想直接在 kivy 中显示二进制图像，您可以简单地使用 io 模块 (import io) 和 kivy 图像模块 (kivy.uix.image)

检查此代码：

```
from kivy.uix.image import Image, CoreImage
import io

f=open("img.jpg",'rb')

binary_data= f.read() #image opened in binary mode

data = io.BytesIO(binary_data)
img=CoreImage(data, ext="png").texture

new_img= Image()
new_img.texture= img 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-26T00:09:51.760

您可以使用 StringIO 将文件保存到缓冲区中（请参阅：[Python 中的二进制缓冲区](https://stackoverflow.com/questions/25116/binary-buffer-in-python)）。

就像是：

```
from StringIO import StringIO
buff = StringIO()
plt.savefig(buff)
buff.seek(0)
from kivy.core.image.img_pygame import ImageLoaderPygame
imgdata = ImageLoaderPygame(buff)._data 
```

# android - 在 sqlite 查询中使用 NOT

> ID：10762458
> 
> 赞同：0
> 
> 时间：2012-05-25T23:38:21.927
> 
> 标签：android, sqlite

我从未`NOT`在查询中使用过，所以我不知道这是否正确。

```
Cursor c = getActivity().getContentResolver().query(Games.TOTALS_URI, 
                new String[] {Games.TOTALS_FRAME_TOTAL},
                Games.TOTALS_FRAME_NUM+"=10"+" AND "+Games.TOTALS_FRAME_TOTAL+" NOT 0",null,null); 
```

我只想获得一个价值，`not 0`即使是`> 0`这样，那对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T23:45:31.937

你的直觉是正确的，它应该 > 0：

```
" AND "+Games.TOTALS_FRAME_TOTAL+" > 0" 
```

或者更好的是，要处理`Games.TOTALS_FRAME_TOTAL`可能为 NULL 的情况，请将其包装在 COALESCE() 函数中：

```
" AND COALESCE("+Games.TOTALS_FRAME_TOTAL+", 0) > 0" 
```

COALESCE 函数接受一个值列表并返回第一个非 NULL 值。

# apache - 在某些虚拟目录中关闭 SSL

> ID：10762463
> 
> 赞同：0
> 
> 时间：2012-05-25T23:39:42.877
> 
> 标签：apache, http, .htaccess, ssl, https

我想在虚拟目录中关闭 ssl - cron
一些需要通过 http 运行的 url 例如 /cron/one 、 /cron/two 或 /cron/three

我正在使用此重写来强制使用 ssl

```
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{SERVER_NAME}%{REQUEST_URI} [R,L] 
```

一些例子，这里应该关闭 ssl：

```
/cron/one
/cron/two
/cron/three 
```

一些帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:48:56.027

抱歉，无法为给定的 uri 禁用 SSL。这是一个先有鸡还是先有蛋的问题。当客户端向包含请求的 URI 的服务器发送 GET / POST HTTP 方法调用时，通道已经加密。可以使用**SSLEngine**指令为每个虚拟主机启用或禁用 SSL。

您可以在 127.0.0.1 上以纯 HTTP 侦听来创建专用虚拟主机来处理您的 /cron/ URI，或者您可以使用 crontab 中启用 HTTPS 的 CLI HTTP 客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T13:46:50.173

在您的 SSL VH 内部：

```
Redirect /cron/one http://your.domain/cron/one
Redirect /cron/two http://your.domain/cron/two
Redirect /cron/three http://your.domain/cron/three 
```

这会将这些 URL 重定向到 NON-SSL VH。

```
RewriteCond %{HTTPS} off
RewriteCond %{REQUEST_URI} ! /cron/one
RewriteCond %{REQUEST_URI} ! /cron/two
RewriteCond %{REQUEST_URI} ! /cron/three
RewriteRule ^(.*)$ https://%{SERVER_NAME}%{REQUEST_URI} [R,L] 
```

# android - Android共享首选项全屏不起作用

> ID：10762472
> 
> 赞同：-3
> 
> 时间：2012-05-25T23:41:25.250
> 
> 标签：android, passwords, locking, sharedpreferences

我已经根据自己的喜好在 xml 中创建了登录表单，并且我的共享偏好确实有效，但是当我将全屏添加到 java 类时，应用程序崩溃了。这是我的代码，任何帮助将不胜感激。

```
getWindow().requestFeature(Window.FEATURE_NO_TITLE);
        this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
        WindowManager.LayoutParams.FLAG_FULLSCREEN);

        /*
         * Check if we successfully logged in before. 
         * If we did, redirect to home page
         */
        SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);
        if (settings.getString("logged", "").toString().equals("logged")) {
            Intent intent = new Intent(Password.this, Video.class);
            startActivity(intent);
        }

        Button b = (Button) findViewById(R.id.loginbutton);
        b.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                EditText username = (EditText) findViewById(R.id.username);
                EditText password = (EditText) findViewById(R.id.password);

                if(username.getText().toString().length() > 0 && password.getText().toString().length() > 0 ) {
                    //------------------------------------Username below -------------------------------------Password below ---//
                    if(username.getText().toString().equals("username") && password.getText().toString().equals("password")) {

                        /*
                         * So login information is correct, 
                         * we will save the Preference data
                         * and redirect to next class / home  
                         */
                        SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);
                        SharedPreferences.Editor editor = settings.edit();
                        editor.putString("logged", "logged");
                        editor.commit();

                        Intent intent = new Intent(Password.this, Video.class);
                        startActivity(intent);
                    }
                }
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:55:46.380

你的问题与`SharedPreferences`. 您的代码的问题是您在为该窗口设置内容`requestFeature` *后调用。*如果您检查文档`requestFeature`，它会说必须在调用之前`setContentView()`调用它（直接或间接）。

[http://developer.android.com/reference/android/view/Window.html#requestFeature%28int%29](http://developer.android.com/reference/android/view/Window.html#requestFeature%28int%29)

> 公共布尔请求功能（int featureId）
> 
> 启用扩展屏幕功能。这必须在 setContentView() 之前调用。只要在 setContentView() 之前，就可以根据需要多次调用。如果不调用，则没有扩展功能可用。一旦被请求，您就不能将其关闭。您不能通过 FEATURE_CUSTOM_TITLE 使用其他标题功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-14T20:45:40.887

```
requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
                WindowManager.LayoutParams.FLAG_FULLSCREEN); 
```

在 oncreate() 方法中的 setcontentView() 之前使用此代码。

# c++ - 如何为 COM 接口 (c++) 中的方法生成不推荐使用的警告

> ID：10762473
> 
> 赞同：5
> 
> 时间：2012-05-25T23:41:34.687
> 
> 标签：c++, visual-studio-2010, com, deprecated

我们在我工作的地方使用“类 COM”模型，因为我们通常遵循 COM 规则，但不执行 MIDL 编译，也不针对 c/c++ 以外的其他语言。因此，我知道我总是可以根据自己的需要改变规则，但我尽量不要这样做，因为我们可能希望有一天真正符合 COM 标准，如果那一天到来，我们希望它尽可能轻松。

当有人从特定接口使用特定方法编译代码时，我想打印出警告。在 c++ 中（我们只支持微软编译器），我们会`__declspec(deprecated)`在函数声明之前添加来达到我们的目的。

我可以在我的接口方法声明之前添加它，还是有更好、更 COM 的方法来做到这一点？

我还想知道仅`__declspec(deprecated)`在方法前面添加是否足以迫使用户重新编译（如果可能的话，我想避免这种情况）。

谢谢

**更新**

我尝试`__declspec(deprecated)`在我的方法声明前使用，如下所示：

```
struct Interface : public IUnknown
{
    __declspec(deprecated) virtual HRESULT __stdcall OldMethod
    (
        int Arg1;
        int Arg2;
    ) = 0;

    virtual HRESULT __stdcall NewMethod
    (
        //arguments...
    ) = 0;
} 
```

通过这种弃用方法的方式，我在尝试使用 OldMethod 时根本不会收到编译器警告。`__declspec(deprecated)`使用纯虚拟方法是否有我不知道的限制？

再次感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T23:47:48.737

`__declspec(deprecated)`是 MS C/C++ 编译器的源代码级功能，不会影响任何东西的二进制布局 (ABI) - 因此用户不必重新编译。效果是通过包含您的 C++ 头文件向调用该方法的任何人发出编译时警告。它不会影响人们将您的对象用作 COM 对象而不包括您的标题，例如来自另一种语言。我不相信 COM/IDL 本身提供了一个类似的“弃用”属性。

因此，总而言之，为了 C++ 用户的利益，您不妨添加该属性，但如果您曾经为普通 COM 消费者提供过，他们将不得不依赖您提供的文档来知道该方法已被弃用。

# php - PHP发送邮件功能

> ID：10762476
> 
> 赞同：0
> 
> 时间：2012-05-25T23:41:55.607
> 
> 标签：php, email, sendmail

我不明白为什么我的发送邮件功能停止工作。它过去可以正常工作，但我刚刚发现尝试注册我的网站的用户不再收到电子邮件。

我一定是不小心改变了什么。

我已经剥离了所有细节，试图回归基础并解决问题。但是下面的代码 - 替换了正确的电子邮件地址 - 仍然不起作用。它总是打印成功，但电子邮件不会发送到该地址。

感谢您的帮助！

```
$email_address2 = "my@email.com";
    $header2 = "From: webmaster@domain.org.uk\n";

    $subject2 = "Your Membership!";
    $message2 = "
    The message2
    ";

$mailsend = mail($email_address2, $subject2, $message2, $header2.">\nX-Mailer: PHP/" . phpversion());

if($mailsend) {
    echo 'Your membership information has been mailed to your email address!<br/><br/>Please check it and follow the directions!';
} else {
print "There has been an error. Please try again";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T10:56:54.353

第一步是找出 sendmail 的安装位置。一旦你知道那条路径，进入你的 php.ini。您正在寻找 sendmail_path 设置。适当地设置它。

如果路径设置正确，正确调用 mail() 的结果应该返回 true。（请注意，返回值仅让您知道消息是否已传递到 sendmail [或在 Windows 的情况下为 SMTP]。它不能保证电子邮件已发送出去，或者 sendmail 配置正确。）如果它返回 true 并且您仍然没有收到电子邮件，然后检查您的 sendmail 配置。

# java - 处理数据库约束休眠

> ID：10762480
> 
> 赞同：7
> 
> 时间：2012-05-25T23:42:29.180
> 
> 标签：java, hibernate, transactions, batch-processing, spring-transactions

我的项目正在使用带有spring事务管理器的hibernate，我的数据库是postgres（可能无关紧要）。

我正在尝试读取大的 xml 文件并从中构造对象（对象不大，但数量很大）并将它们插入数据库。

如果碰巧我的一个对象违反了数据库约束，整个过程就会停止。如何跳过违反数据库约束的那些？或者将他们的 id 或其他任何内容记录到日志文件中？

**问题更新：**

我一直在浏览 SO，发现对于批量插入，最好建议使用无状态会话，但我仍然遇到同样的问题并且插入停止：

```
May 26, 2012 4:45:47 PM org.hibernate.util.JDBCExceptionReporter logExceptions
SEVERE: ERROR: duplicate key value violates unique constraint "UN_FK"
  Detail: Key (fid)=(H1) already exists. 
```

以下是我用于解析 xml 并插入数据库的代码的相关部分，为简单起见，假设我正在插入电影：

```
//class field
@Autowired
private SessionFactory sessionFactory;

@Override
public void startDocument() throws SAXException {
    session = sessionFactory.getCurrentSession();
}

@Override
public void endElement(String uri, String localName, String qName) throws SAXException  {
if (qName.equalsIgnoreCase("FILM")) {
        movie.setCategory(category);
        movie.setAdded(new Date());
        session.insert(movie);
    }
} 
```

我在 app-ctx 中将此属性设置`hibernate.jdbc.batch_size`为 100。为了避免这种情况，是否真的有必要在插入之前进行选择？

**更新 2：**

如果我使用`StatelessSession`而不是会话，我会得到大约 20 次插入，然后处理会无限期地停止，没有任何异常或任何东西。

我假设数字 20 是因为我正在与 tomcat 合并连接并拥有`maxActive="20"`.

**赏金更新：**

我真的很想看到有人提供解决方案（如果可能，没有防御选择）。使用 statelessSession 或只是会话。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T23:47:46.637

大多数类型的约束，例如列是否可以为空或具有最大宽度，您可以使用[Hibernate Validator](http://www.hibernate.org/subprojects/validator.html)进行检查。只需在尝试持久化之前手动对对象执行验证即可。

对于某些事情，特别是独特的约束，您需要执行“防御性”选择以查看是否存在冲突，或者维护已插入的内存中的一组值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-04T05:12:10.427

我认为不可能完全验证某些东西以保证插入成功。在某些情况下，无论您做什么，其他人都可以在验证和插入之间将某些内容插入数据库，从而导致违反约束。

在大多数情况下，我只建议像处理任何其他异常一样处理异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-25T23:54:54.350

要从 xml 文件中插入大量对象，您应该考虑使用 spring batch。参数 skip-limit 允许您在停止批处理之前告诉您的 xml 中有多少错误行。还要检查 skip-policy 和 skippable-exception；请参阅Spring 文档中的[配置步骤](http://static.springsource.org/spring-batch/reference/html/configureStep.html)。

如果您不想使用 spring 批处理，只需使用简单的 try catch 即可让您的过程继续到最后。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-01T02:53:12.757

为什么你认为这一切都必须是一笔大交易？事实上，你所描述的一切对我来说意味着你实际上在这里有很多交易。对于“出错”的对象，只需驱逐该实体并回滚事务。如果“FILM”元素定义了一个对象图，它会变得有点复杂，但想法是一样的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-01T00:14:02.283

我认为[Affe](https://stackoverflow.com/users/331052/affe)在插入前采用防御性选择的正确方法。

您可以考虑在每次插入之前使用[保存](https://stackoverflow.com/questions/6594759/savepoint-using-hibernate)点，如果抛出异常，则回滚到保存点。创建保存点会产生性能开销。完成后需要释放保存点。

请参阅[AbstractTransactionStatus.setSavepoint()](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/transaction/support/AbstractTransactionStatus.html#setSavepoint(java.lang.Object))或者如果您有权访问 JDBC 连接池[setSavepoint](http://docs.oracle.com/javase/6/docs/api/java/sql/Connection.html#setSavepoint()) [rollback(Savepoint)](http://docs.oracle.com/javase/6/docs/api/java/sql/Connection.html#rollback(java.sql.Savepoint))和[releaseSavepoint(Savepoint)](http://docs.oracle.com/javase/6/docs/api/java/sql/Connection.html#releaseSavepoint(java.sql.Savepoint))

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-08T05:21:51.210

虽然这是一个老问题，但我最近遇到了类似的情况，这就是我所做的。

我也使用了无状态会话，但这就是我所做的不同。我发出了一个 session.insert ，它由于违反约束而成功或失败，在违反约束时抛出一个 ConstraintViolationException ，捕获它会给你插入失败的对象，对失败的对象做任何你想做的事情。与事务一起，每个插入也使用保存点（保存点更便宜并且不会造成太大的性能影响），因此当事务由于某些问题而失败时，提交完成直到最后一个保存点（在 catch 子句中）。

我的代码看起来像这样：

```
try {
  session.connection().setSavePoint("lastSaved");
  session.insert(obj);
}
catch(ConstraintViolationException) {
  log.error(obj.getUserId());
  ....
}
tx.commit();
....
catch(TransactionException e) {
  tx.rollback();
} 
```

# entity-framework-4 - 如何在 Entity Framework 4 T4 脚本中区分表和视图

> ID：10762482
> 
> 赞同：2
> 
> 时间：2012-05-25T23:42:34.347
> 
> 标签：entity-framework-4

我有一个 EDMX，我在其中导入了表和视图。在 T4 脚本中，这些是通过`foreach( EntitySet set in container.BaseEntitySets.OfType<EntitySet>( ) )`.

“容器”来自`foreach (EntityContainer container in GetSourceSchemaTypes<EntityContainer>())`.

我还没有找到任何可以用来告诉我它是表还是视图的 EntitySet 属性。我怎么知道？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T15:09:20.120

It depends on the container. `EntityContainer` is general class which can be used for both CSpace (CSDL) and SSpace (SSDL) mapping metadata. CSpace describes your class model (what you see in the designer) and SSpace describes your table model (what you have in the database). Between these two sits CSSpace (MSL) which describes mapping from CSpace to SSpace.

Different space is used for different generators. Class generators use CSpace because they must create classes same as entities defined in CSpace. SQL generators use SSpace because they must create SQL using correct objects from SSpace. CSSpace is never used for code generation and almost whole its implementation is not public.

Information about view is stored in SSpace in `EntitySet`'s `MetadataProperties`. If you are working in CSpace to generate classes you don't have access to this information because entity from CSpace has no knowledge about its storage. Because API for CSSpace is not public it is also quite hard to move from CSpace space to SSpace without using some naming convention (or hardcoded solution) to convert name of the entity to name of the table.

# html - Ember.js + HTML5 拖放购物车演示

> ID：10762484
> 
> 赞同：23
> 
> 时间：2012-05-25T23:42:56.637
> 
> 标签：html, ember.js

简而言之，我正在尝试使用 ember.js 和 HTML5 原生拖放来重现 jquery-ui 的购物车演示的基本版本：http: [//jqueryui.com/demos/droppable/shopping-cart.html 。](http://jqueryui.com/demos/droppable/shopping-cart.html)

在之前尝试使用 ember + jquery-ui 实​​现拖放并且在使用此解决方案时遇到困难：http: [//jsfiddle.net/Wu2cu/2/](http://jsfiddle.net/Wu2cu/2/)，我看到了 pangratz 的 HTML5 解决方案：http: [//jsfiddle.net/pangratz666/ DYnNH/](http://jsfiddle.net/pangratz666/DYnNH/)并决定试一试。

我已经分叉了 pangratz 的 jsfiddle，创建了一个 productsController 和一个 addedToCartController，它根据 isAdded 属性过滤 productsController：http: [//jsfiddle.net/GU8N7/3/](http://jsfiddle.net/GU8N7/3/)

这很好用，但是当我尝试使用 #each 迭代器并将唯一的可拖动视图附加到迭代器中的每个对象时，我就卡住了。我希望能够拖动每个“产品”对象，当它被放入“购物车”区域时，将该对象的 isAdded 属性设置为 true，从而使其显示在“购物车”中。

任何帮助将不胜感激！！

（另外作为奖励，我想让购物车中的物品可分类，但在第一座桥被跨过之前，这可能要求太多了。）

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-05-26T22:19:01.993

查看下面的代码以获取解决方案（带有一些附加功能）。包括购物车物品的排序（见`cartController`JS 末尾）。

还有一个工作小提琴：http: [//jsfiddle.net/ud3323/5uX9H/](http://jsfiddle.net/ud3323/5uX9H/)。

**更新：**添加了拖动图像示例。

***车把***

```
<script type="text/x-handlebars" >  
    <b>Available Products</b>
    <br /><br />
    {{#each App.productsController}}
      {{#view App.ProductView contentBinding="this"}}
        {{content.name}}
      {{/view}}<br />
    {{/each}}
    <hr />

    {{#view App.ProductDropTarget 
            dragContextBinding="App.productsController.currentDragItem"}}
    Shopping Cart
    <div style="height: 20px">{{helpText}}</div>
    {{/view}}
    <br />
    {{#each App.cartController}}
      {{#view App.ProductView contentBinding="this"}}
        {{content.name}}
      {{/view}}<br />
    {{/each}}    
</script>​ 
```

***JavaScript：***

```
App = Ember.Application.create({});

DragNDrop = Ember.Namespace.create();

DragNDrop.cancel = function(event) {
    event.preventDefault();
    return false;
};

DragNDrop.Draggable = Ember.Mixin.create({
    attributeBindings: 'draggable',
    draggable: 'true',
    dragStart: function(event) {
        var dataTransfer = event.originalEvent.dataTransfer;
        dataTransfer.setData('Text', this.get('elementId'));
    }
});

DragNDrop.Droppable = Ember.Mixin.create({
    dragEnter: DragNDrop.cancel,
    dragOver: DragNDrop.cancel,
    drop: function(event) {
        event.preventDefault();
        return false;
    }
});

App.Product = Ember.Object.extend({
    name: null,
    isAdded: null
});

App.ProductView = Ember.View.extend(DragNDrop.Draggable, {
    tagName: 'span',

    // .setDragImage (in #dragStart) requires an HTML element as the first argument
    // so you must tell Ember to create the view and it's element and then get the 
    // HTML representation of that element.
    dragIconElement: Ember.View.create({
        attributeBindings: ['src'],
        tagName: 'img',
        src: 'http://twitter.com/api/users/profile_image/twitter'
    }).createElement().get('element'),

    dragStart: function(event) {
        this._super(event);
        // Let the controller know this view is dragging
        this.setPath('content.isDragging', true);

        // Set the drag image and location relative to the mouse/touch event
        var dataTransfer = event.originalEvent.dataTransfer;
        dataTransfer.setDragImage(this.get('dragIconElement'), 24, 24);
    },

    dragEnd: function(event) {
        // Let the controller know this view is done dragging
        this.setPath('content.isDragging', false);
    }
});

App.ProductDropTarget = Ember.View.extend(DragNDrop.Droppable, {
    tagName: 'div',
    classNames: ['dropTarget'],
    classNameBindings: ['cartAction'],
    helpText: null,

    // This will determine which class (if any) you should add to
    // the view when you are in the process of dragging an item.
    cartAction: Ember.computed(function(key, value) {
        if(Ember.empty(this.get('dragContext'))) {
            this.set('helpText','(Drop Zone)');
            return null;
        }

        if(!this.getPath('dragContext.isAdded')) {
            this.set('helpText', '(Drop to Add)');
            return 'cart-add';
        } else if(this.getPath('dragContext.isAdded')) {
            this.set('helpText', '(Drop to Remove)');
            return 'cart-remove';
        } else {
            this.set('helpText', '(Drop Zone)');
            return null;
        }

    }).property('dragContext').cacheable(),

    drop: function(event) {
        var viewId = event.originalEvent.dataTransfer.getData('Text'),
            view = Ember.View.views[viewId];

        // Set view properties
        // Must be within `Ember.run.next` to always work
        Ember.run.next(this, function() {
            view.setPath('content.isAdded', !view.getPath('content.isAdded'));
        });

        return this._super(event);
    }
});

App.productsController = Ember.ArrayController.create({
    content: [
      App.Product.create({ name: "MacBook Pro", isAdded: false }),
      App.Product.create({ name: "iPhone", isAdded: false }),
      App.Product.create({ name: "iPad", isAdded: true }),
      App.Product.create({ name: "iTV", isAdded: false })
    ],

    currentDragItem: Ember.computed(function(key, value) {
        return this.findProperty('isDragging', true);
    }).property('@each.isDragging').cacheable(),

    productsInCart: Ember.computed(function(key, value) {
        return this.filterProperty('isAdded', true);
    }).property('@each.isAdded').cacheable()

});

App.cartController = Ember.ArrayController.create({    
    content: Ember.computed(function(key, value) {
        var cartItems = this.get('cartItems');

        if(!Ember.empty(cartItems)) {
            // Sort desc by name
            return cartItems.sort(function(a,b){
                if((a.get('name').toLowerCase()) < (b.get('name').toLowerCase()))
                    return -1;
                else return 1;
            });
        }
    }).property('cartItems').cacheable(),

    cartItemsBinding: 'App.productsController.productsInCart'
}); 
```

​ ​</p>

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-12T18:38:03.083

我正在寻找一个拖放示例并找到您的示例，我将代码稍微更新为 1.0.0-rc5 并添加了双击项目的乐趣...

[http://jsfiddle.net/kadactivity/hhBrM/1/](http://jsfiddle.net/kadactivity/hhBrM/1/)

**车把**

```
<script type="text/x-handlebars" >  
    <b>Available Products</b>
    <br /><br />
    {{#each product in model}}
        {{#view App.ProductView contentBinding="product"}}
            {{view.content.name}}
        {{/view}}<br />
    {{/each}}
    <hr />

    {{#view App.ProductDropTarget 
        dragContextBinding="currentDragItem"}}
    Shopping Cart
    <div style="height: 20px">{{helpText}}</div>
    {{/view}}
    <br />
    {{#each cart in productsInCart}}
        {{#view App.ProductView contentBinding="cart"}}
            {{view.content.name}}
        {{/view}}<br />
    {{/each}}    
</script> 
```

**Javascript**

```
App = Ember.Application.create();

App.Router.map(function() {
  // put your routes here
});

App.ApplicationRoute = Ember.Route.extend({
  model: function() {
    return [
      App.Product.create({ name: "MacBook Pro", isAdded: false }),
      App.Product.create({ name: "iPhone", isAdded: false }),
      App.Product.create({ name: "iPad", isAdded: true }),
      App.Product.create({ name: "iTV", isAdded: false })
    ];
  }
});

DragNDrop = Ember.Namespace.create();

DragNDrop.cancel = function(event) {
  event.preventDefault();
  return false;
};

DragNDrop.Draggable = Ember.Mixin.create({
  attributeBindings: "draggable",
  draggable: "true",
  dragStart: function(event) {
    var dataTransfer = event.originalEvent.dataTransfer;
    dataTransfer.setData("Text", this.get("elementId"));
  }
});

DragNDrop.Droppable = Ember.Mixin.create({
  dragEnter: DragNDrop.cancel,
  dragOver: DragNDrop.cancel,
  drop: function(event) {
    event.preventDefault();
    return false;
  }
});

App.Product = Ember.Object.extend({
  name: null,
  isAdded: null
});

App.ProductView = Ember.View.extend(DragNDrop.Draggable, {
  tagName: "span",

  // .setDragImage (in #dragStart) requires an HTML element as the first argument
  // so you must tell Ember to create the view and it"s element and then get the 
  // HTML representation of that element.
  dragIconElement: Ember.View.create({
    attributeBindings: ["src"],
    tagName: "img",
    src: "http://twitter.com/api/users/profile_image/twitter"
  }).createElement().get("element"),

  dragStart: function(event) {
    this._super(event);
    // Let the controller know this view is dragging
    this.set("content.isDragging", true);

    // Set the drag image and location relative to the mouse/touch event
    var dataTransfer = event.originalEvent.dataTransfer;
    dataTransfer.setDragImage(this.get("dragIconElement"), 24, 24);
  },

  dragEnd: function(event) {
    // Let the controller know this view is done dragging
    this.set("content.isDragging", false);
  },

  doubleClick: function(event) {
    this.set("content.isAdded", !this.get("content.isAdded"));
  }
});

App.ProductDropTarget = Ember.View.extend(DragNDrop.Droppable, {
  tagName: "div",
  classNames: ["dropTarget"],
  classNameBindings: ["cartAction"],
  helpText: null,

  // This will determine which class (if any) you should add to
  // the view when you are in the process of dragging an item.
  cartAction: function() {
    if(Ember.isEmpty(this.get("dragContext"))) {
        this.set("helpText","(Drop Zone)");
        return null;
    }

    if(!this.get("dragContext.isAdded")) {
        this.set("helpText", "(Drop to Add)");
        return "cart-add";
    } else if(this.get("dragContext.isAdded")) {
        this.set("helpText", "(Drop to Remove)");
        return "cart-remove";
    } else {
        this.set("helpText", "(Drop Zone)");
        return null;
    }

  }.property("dragContext"),

  drop: function(event) {
    var viewId = event.originalEvent.dataTransfer.getData("Text"),
        view = Ember.View.views[viewId];

    // Set view properties
    // Must be within `Ember.run.next` to always work
    Ember.run.next(this, function() {
        view.set("content.isAdded", !view.get("content.isAdded"));
    });

    return this._super(event);
  }
});

App.ApplicationController = Ember.ArrayController.extend({
  currentDragItem: function() {
      return this.findProperty("isDragging", true);
  }.property("@each.isDragging"),

  productsInCart: function() {
    var cartItems = this.filterProperty("isAdded", true);
    console.log(cartItems);
    if(!Ember.isEmpty(cartItems)) {
      // Sort desc by name
      return cartItems.sort(function(a,b){
          if((a.get("name").toLowerCase()) < (b.get("name").toLowerCase()))
              return -1;
          else return 1;
      });
    }
  }.property("@each.isAdded")
}); 
```

# c# - Jquery 自动完成 .NET WebMethod

> ID：10762490
> 
> 赞同：2
> 
> 时间：2012-05-25T23:44:06.577
> 
> 标签：c#, jquery, asp.net

我有使用 HttpHandler - .ashx 文件的 Jquery 自动完成功能。它工作正常，我想知道是否有一种简单的方法可以在后面的代码中使用带有 [WebMethod] 的自动完成功能 - 这有什么好处吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T07:16:27.327

HttpHandler 和 Web-Services 的两个实现执行相同，
但是我更喜欢 HttpHandler，因为它是轻量级
的，另一方面，Web 服务编码请求和响应 xml 数据，这增加了额外的有效负载。

带有网络方法的 POP JqueryUI 自动完成：http:
[//blog.nitinsawant.com/2011/09/integrating-jquery-ui-autocomplete-in.html](http://blog.nitinsawant.com/2011/09/integrating-jquery-ui-autocomplete-in.html)

JS：

```
$(document).ready(function () {
            $("#<%=txtAutoComplete.ClientID %>").autocomplete({
                source: function (request, response) {
                    $.ajax({
                        url: "webservice/TestService.asmx/SearchData",
                        data: "{ 'q': '" + request.term + "', 'limit': '10' }",
                        dataType: "json",
                        type: "POST",
                        contentType: "application/json; charset=utf-8",
                        dataFilter: function (data) { return data; },
                        success: function (data) {
                            response($.map(data.d, function (item) {
                                return {
                                    label: item.Name,
                                    value: item.id + ""
                                }
                            }))
                        }
                    });
                }
            });
}); 
```

C＃：

```
[System.Web.Services.WebMethodAttribute(),  System.Web.Script.Services.ScriptMethodAttribute()]
public List<tdata> SearchData(string q, int limit)
{
    return new List<tdata> { new tdata { id = 0, name = "nitin" } };
} 
```

# r - 是否可以用 R 读取 EXIF 数据？

> ID：10762491
> 
> 赞同：9
> 
> 时间：2012-05-25T23:44:07.773
> 
> 标签：r, exif

我需要根据它们的 EXIF 数据来操作一些图像文件。可以在 R 中完成这样的事情吗？我还没有看到任何可以直接读取 EXIF 数据的 R 函数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-26T06:13:25.470

adimpro包可能很有用**。**它将 EXIF 数据保存为`comment()`导入图像上的 a。（虽然我自己没用过。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-12-08T19:24:09.507

我也找不到原生的 R 包，所以我在[https://github.com/cmartin/EXIFr实现了自己的包](https://github.com/cmartin/EXIFr)

到目前为止，它只读取我用于项目的标签子集，但我可以轻松扩展它以满足您的需求。

例如，要读取光圈值：

```
read_exif_tags(image_path)[["ApertureValue"]] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-25T08:24:43.323

使用 exiftool ( [http://www.sno.phy.queensu.ca/~phil/exiftool/](http://www.sno.phy.queensu.ca/~phil/exiftool/) )可能更快、更通用

> system("/usr/local/bin/exiftool 路径imagename.img")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-20T06:35:21.327

我尝试了 adimpro（对我来说太复杂了——需要其他软件包等）和 EXIFr（出现错误）。exiftool 工作，但我必须想办法将系统调用的结果输入 R。下面是如何（你必须添加，实习生 = TRUE）：

```
1) install (http://www.sno.phy.queensu.ca/~phil/exiftool/) for your OS
2) use this in R: varName <- system("/usr/local/bin/exiftool path/example.jpg", intern = TRUE) 
```

# kineticjs - Kinetic.Line 鼠标悬停

> ID：10762499
> 
> 赞同：2
> 
> 时间：2012-05-25T23:45:43.373
> 
> 标签：kineticjs

我正在尝试检测 Kinetic.Line 对象上的鼠标悬停。

根据文档， Kinetic.Line 确实具有 on 功能，因为它是节点的子节点。on 函数将 mousemove 和 mouseover 列为支持的事件。

但是，它似乎不适用于鼠标悬停或鼠标移动。

这是设计使然吗？这个功能会实现吗？难道我做错了什么？

```
function canvasTest () {
    stage = new Kinetic.Stage({
        container: "tutorial",
        width: 400,
        height: 400
    });

    var layer = new Kinetic.Layer();

    var redLine = new Kinetic.Line({
        points: [73, 70, 340, 23, 450, 60, 500, 20],
        stroke: "red",
        strokeWidth: 15,
        lineCap: "round",
        lineJoin: "round"
    });

    redLine.on('mouseover mousemove', function (ev) {
        alert('line moused over.');
    });

    layer.add(redLine);

    stage.add(layer);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T16:32:24.707

动力学线使用像素检测来处理事件，因为它们没有路径。您需要使用 shape.saveData() 方法才能检测到它。

这是一个例子：

[http://www.html5canvastutorials.com/kineticjs/html5-canvas-pixel-detection-with-kineticjs/](http://www.html5canvastutorials.com/kineticjs/html5-canvas-pixel-detection-with-kineticjs/)

干杯!

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T13:29:15.803

我想补充一下 Erics 的答案。

线所附加的层需要添加到舞台之前！发出 .saveData() 函数。否则你会有一个例外。

祝你好运。

# javascript - jQuery查找div可以包含的字符串长度

> ID：10762503
> 
> 赞同：3
> 
> 时间：2012-05-25T23:46:57.600
> 
> 标签：javascript, jquery, html

我有一个没有固定高度或宽度的 Div。div 将包含一些文本，字符串的长度不固定。如果字符串太长而无法放入 div，则文本将出现在 div 之外，我需要知道 div 可以根据其宽度和高度包含多少字符串的最大长度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T23:49:46.960

除非您使用所有字符宽度相同的固定宽度字体（这很不寻常），否则您的问题没有答案。给定宽度能容纳多少个字符取决于字符是什么，因为在所有可变宽度字体中，像“W”这样的字符比像“i”这样的字符宽得多。

如果您使用的是固定宽度的字体，那么您需要测量一个字符在您使用的字体中的宽度以及字体大小和字体样式。然后，您可以简单地将您拥有的宽度除以字符宽度并确定可以容纳多少个字符。

可以测量固定宽度的字体，方法是创建一个没有边距、填充或边框的 div，将样式设置为`position: absolute`，在其上设置所需的 font-family 和 font-size 并将一个字符放入 div。然后，您可以通过获取它的 offsetWidth 来获取 div 的宽度。

有关简单示例，请参见[http://jsfiddle.net/jfriend00/kHHU7/](http://jsfiddle.net/jfriend00/kHHU7/)。

这是一个测量固定宽度字体中字符宽度的函数：

```
function getCharWidth(fontFamily, fontSize) {
    var div = document.createElement("div");
    div.style.position = "absolute";
    div.style.visibility = "hidden";
    div.style.fontFamily = fontFamily;
    div.style.fontSize = fontSize;
    div.innerHTML = "S";
    document.body.appendChild(div);
    var width = div.offsetWidth;
    document.body.removeChild(div);
    return(width);
} 
```

你可以在这里看到它的工作：http: [//jsfiddle.net/jfriend00/y4eZr/](http://jsfiddle.net/jfriend00/y4eZr/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T23:57:05.520

也许最好使用css溢出：隐藏在div上？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T00:09:29.167

我会查看 jQuery 插件[dotdotdot](http://dotdotdot.frebsite.nl/)来处理这个问题。您不需要知道多长时间，它将为您完成将文本截断到适当长度的所有工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T23:54:04.773

Divider 元素是流体容器元素，并不是真正设计来做这种事情的。

我能想到的最好的方法是将`clientWidth`div 除以假定的字体宽度。

`var maxChars = div.clientWidth / 5;`

# leveldb - 如果值为空且只有一个键，leveldb 是否存在结构问题？

> ID：10762509
> 
> 赞同：3
> 
> 时间：2012-05-25T23:47:58.993
> 
> 标签：leveldb

我正在研究一种设计，其中数据的二级索引将使用键中的所有信息构建，在价值方面不需要任何东西。这可能会导致问题吗？

我**不是**在问*技术上*是否可以有一个空白值。是否有任何**结构性后果**，例如：添加排序键会使某些树结构失衡？（我不是说 leveldb 使用树，只是想一个类比 ;-)）

即：说“主记录”看起来像（空值作为分隔符）

*   key = uniqueTableID \0 uniqueRowID
*   value = 一些字段的集合

典型单值字段的二级索引如下所示：

*   key = uniqueFieldID \0 keyValue \0 uniqueRowID

允许通过部分键 [uniqueFieldID \0 keyValue] 进行迭代，并且如果主记录被删除或键值更改，它还可以轻松找到这些键并删除它们，从主记录的 uniqueRowID 开始工作。因此，可能有多个键值以相同的 uniqueRowID 结尾，但对于以 uniqueFieldID 开头并以 uniqueRowID 结尾的特定组合只能是一个键

唯一的一点是，我不需要在该对的值侧放置一个值。

我对这个概念设计很满意，只是看看是否有人能发现其中的漏洞。例如，如果它会扭曲 leveldb 内部结构导致性能问题。

我希望在一个特定的应用程序中会有数万个这样的键。

*作为我们可能*想要存储的值的示例，文本字段的辅助词索引可能如下所示：

*   key = uniqueFieldID \0 keyValue \0 GUID
*   value = 单词出现的计数，或者如果扫描大 blob 成本高，则可能是偏移列表

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T17:56:18.100

LevelDB 中的键和值是不透明的数组，快速查看[Slice 构造函数](http://code.google.com/p/leveldb/source/browse/include/leveldb/slice.h)的文档会显示如何创建空切片：

```
// Create an empty slice.
Slice() : data_(""), size_(0) 
```

这对于您没有任何值数据的情况非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-04T23:04:00.237

应该没问题，因为即使 leveldb 也将删除存储为没有值的键。内部 leveldb 对每个 SST 中的键使用和前缀长度编码，这将有助于进一步减少特定情况下的键大小。在您的情况下，唯一的偏差是索引大小。通常，索引大小将是数据块的一小部分（假设键较小且值相对较大），而在您的情况下，索引可能相对较大，因为索引为每个数据块存储一个键。

# perl - 如何检查是否定义了变量并使用 perl 正则表达式在数组中搜索两个模式？

> ID：10762510
> 
> 赞同：1
> 
> 时间：2012-05-25T23:48:01.470
> 
> 标签：perl

如何检查是否定义了变量并使用 perl 正则表达式在数组中搜索两个模式？

```
$/ = ""; # paragraph mode

__Data__
#SCSI_test         # put this line into  @arrayNewLines      
kdkdkdkdkdkdkdkd
dkdkdkdkdkdkdkdkd
- ccccccccccccccc  # put this line into @arrayNewLines

  while(<FILEREAD>)
  {
      chomp;
      my @arrayOld = split('\n',$_);

      foreach my $i (0 .. $#arrayOld) # using the foreach of index to remove the lines.
      {
            if($arrayOld[$i] =~ /-(.*)/ || /\#(.*)/)
            {
                 my @arrayNewLines = $arrayOld[$i];
                 splice @arrayOld,$i,1;             # remove lines from arrayOld
                 print "@arrayNewLines\n";
            }
                 print "@arrayOld\n";
      }
   } 
```

此代码在将每种类型的 - 或 # 行放入同一 @arrayNewLines 数组时不起作用。它仅适用于第一个 (/-(. *)/) 模式，不适用于第二个 (/#(.* )/)。我需要它来搜索两种模式并定义 $arrayOld[i] 变量以防止使用 uninitilize 消息。我想定义

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:54:11.780

```
if($arrayOld[$i] =~ /-(.*)/ || /\#(.*)/) 
```

这不会像您认为的那样起作用，原因与它也不会：

```
if($x == 1 || 2) 
```

改用这个：

```
if($arrayOld[$i] =~ /-(.*)/ || $arrayOld[$i] =~ /\#(.*)/) 
```

就像您使用它一样：

```
if($x == 1 || $x == 2) 
```

# java - 如何调整 Shell 子窗口的大小

> ID：10762522
> 
> 赞同：0
> 
> 时间：2012-05-25T23:49:50.063
> 
> 标签：java, resize, swt, childwindow

我有一个子窗口，包含一个表单、标签、组合、按钮，一行一行地对齐。形式不是有限的。有一个按钮用于添加额外的输入字段行。目前它*有点工作*......问题是当添加新行时，子窗口大小保持不变，但我希望它自动调整大小。

子窗口是一个标准的 SWT shell

```
Shell ConstantEditWindow = new Shell(parent); 
```

我有一个这样的按钮：

```
addDesc.addSelectionListener(new SelectionAdapter() {
        public void widgetSelected(SelectionEvent e) {

            populateConstantMain(tariffConstantsOfType, descComp, descCompLayout, true);

            ConstantEditWindow.layout();

        }
    }); 
```

但 id 不起作用：/ 子窗口不会调整大小；（

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T02:27:51.450

阅读：[http ://www.eclipse.org/articles/article.php?file=Article-Understanding-Layouts/index.html](http://www.eclipse.org/articles/article.php?file=Article-Understanding-Layouts/index.html)

和api：[http ://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fswt%2Fwidgets%2Fpackage-summary.html](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fswt%2Fwidgets%2Fpackage-summary.html)

*   .layout() 布局控件的子项
*   pack() 导致接收器被调整到它的首选大小。

还有约定，java中的常量名应该是ALL_IN_CAPITAL。

# sed - 有没有办法创建一个 sed 或 awk 语句来用另一个范围的字符替换代码中的字符

> ID：10762524
> 
> 赞同：2
> 
> 时间：2012-05-25T23:49:54.260
> 
> 标签：sed, awk

背景：MS 向存在严重磨损问题的 OEM 发布 COA 标签。使用的碳粉未正确粘合到 COA 贴纸的纸张上。随着时间的推移，产品密钥会降级并且某些字母/数字不再可读，从而禁止输入授权密钥进行重新安装。

问题：当只有几个字母/数字损坏时，尝试确定之前尝试过的数字是非常令人沮丧的。

请求：利用 sed 或 awk（最好）或其他方法输入 STRING，例如

```
A{B,E,R,8}CDE-FGH{I,1}J-KLMN{O,Q,0}-PQRST-UVWXY 
```

并接收输出

```
ABCDE-FGHIJ-KLMNO-PQRST-UVWXY
AECDE-FGHIJ-KLMNO-PQRST-UVWXY
ARCDE-FGHIJ-KLMNO-PQRST-UVWXY
A8CDE-FGHIJ-KLMNO-PQRST-UVWXY
ABCDE-FGH1J-KLMNO-PQRST-UVWXY
AECDE-FGH1J-KLMNO-PQRST-UVWXY
ARCDE-FGH1J-KLMNO-PQRST-UVWXY
A8CDE-FGH1J-KLMNO-PQRST-UVWXY
ABCDE-FGHIJ-KLMNQ-PQRST-UVWXY
AECDE-FGHIJ-KLMNQ-PQRST-UVWXY
ARCDE-FGHIJ-KLMNQ-PQRST-UVWXY
A8CDE-FGHIJ-KLMNQ-PQRST-UVWXY
ABCDE-FGH1J-KLMNQ-PQRST-UVWXY
AECDE-FGH1J-KLMNQ-PQRST-UVWXY
ARCDE-FGH1J-KLMNQ-PQRST-UVWXY
A8CDE-FGH1J-KLMNQ-PQRST-UVWXY
ABCDE-FGHIJ-KLMN0-PQRST-UVWXY
AECDE-FGHIJ-KLMN0-PQRST-UVWXY
ARCDE-FGHIJ-KLMN0-PQRST-UVWXY
A8CDE-FGHIJ-KLMN0-PQRST-UVWXY
ABCDE-FGH1J-KLMN0-PQRST-UVWXY
AECDE-FGH1J-KLMN0-PQRST-UVWXY
ARCDE-FGH1J-KLMN0-PQRST-UVWXY
A8CDE-FGH1J-KLMN0-PQRST-UVWXY 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T00:09:22.807

did you try this on the command line? at least in bash, it "just works":

```
> echo A{B,E,R,8}CDE-FGH{I,1}J-KLMN{O,Q,0}-PQRST-UVWXY
ABCDE-FGHIJ-KLMNO-PQRST-UVWXY ABCDE-FGHIJ-KLMNQ-PQRST-UVWXY ABCDE-FGHIJ-KLMN0-PQRST-UVWXY ABCDE-FGH1J-KLMNO-PQRST-UVWXY ABCDE-FGH1J-KLMNQ-PQRST-UVWXY ABCDE-FGH1J-KLMN0-PQRST-UVWXY AECDE-FGHIJ-KLMNO-PQRST-UVWXY AECDE-FGHIJ-KLMNQ-PQRST-UVWXY AECDE-FGHIJ-KLMN0-PQRST-UVWXY AECDE-FGH1J-KLMNO-PQRST-UVWXY AECDE-FGH1J-KLMNQ-PQRST-UVWXY AECDE-FGH1J-KLMN0-PQRST-UVWXY ARCDE-FGHIJ-KLMNO-PQRST-UVWXY ARCDE-FGHIJ-KLMNQ-PQRST-UVWXY ARCDE-FGHIJ-KLMN0-PQRST-UVWXY ARCDE-FGH1J-KLMNO-PQRST-UVWXY ARCDE-FGH1J-KLMNQ-PQRST-UVWXY ARCDE-FGH1J-KLMN0-PQRST-UVWXY A8CDE-FGHIJ-KLMNO-PQRST-UVWXY A8CDE-FGHIJ-KLMNQ-PQRST-UVWXY A8CDE-FGHIJ-KLMN0-PQRST-UVWXY A8CDE-FGH1J-KLMNO-PQRST-UVWXY A8CDE-FGH1J-KLMNQ-PQRST-UVWXY A8CDE-FGH1J-KLMN0-PQRST-UVWXY 
```

or on separate lines / used in some other command:

```
> for a in A{B,E,R,8}CDE-FGH{I,1}J-KLMN{O,Q,0}-PQRST-UVWXY; do echo $a; done
ABCDE-FGHIJ-KLMNO-PQRST-UVWXY
ABCDE-FGHIJ-KLMNQ-PQRST-UVWXY
ABCDE-FGHIJ-KLMN0-PQRST-UVWXY
ABCDE-FGH1J-KLMNO-PQRST-UVWXY
ABCDE-FGH1J-KLMNQ-PQRST-UVWXY
ABCDE-FGH1J-KLMN0-PQRST-UVWXY
AECDE-FGHIJ-KLMNO-PQRST-UVWXY
AECDE-FGHIJ-KLMNQ-PQRST-UVWXY
AECDE-FGHIJ-KLMN0-PQRST-UVWXY
AECDE-FGH1J-KLMNO-PQRST-UVWXY
AECDE-FGH1J-KLMNQ-PQRST-UVWXY
AECDE-FGH1J-KLMN0-PQRST-UVWXY
ARCDE-FGHIJ-KLMNO-PQRST-UVWXY
ARCDE-FGHIJ-KLMNQ-PQRST-UVWXY
ARCDE-FGHIJ-KLMN0-PQRST-UVWXY
ARCDE-FGH1J-KLMNO-PQRST-UVWXY
ARCDE-FGH1J-KLMNQ-PQRST-UVWXY
ARCDE-FGH1J-KLMN0-PQRST-UVWXY
A8CDE-FGHIJ-KLMNO-PQRST-UVWXY
A8CDE-FGHIJ-KLMNQ-PQRST-UVWXY
A8CDE-FGHIJ-KLMN0-PQRST-UVWXY
A8CDE-FGH1J-KLMNO-PQRST-UVWXY
A8CDE-FGH1J-KLMNQ-PQRST-UVWXY
A8CDE-FGH1J-KLMN0-PQRST-UVWXY 
```

or maybe you already knew this and need sed/awk for some other reason?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T00:06:44.220

I'd probably pick Ruby, Python, or Perl for this instead. And if it were just for me, I'd do something super-cheap and use a series of nested `for` loops like the following pseudo-code:

```
string = "A%sCDE-FGH%sJ-KLMN%s-PQRST-UVWXY"

for a in ["B", "E", "R", "8"]
  for b in ["I", "1"]
    for c in ["O" "Q", "0"]
        printf string, a, b, c
    end
  end
end 
```

The downside is you'd need to replace the string, the list of characters in each `for` loop, and potentially add or remove `for` loops based on the number of unknown characters. Making it a more powerful tool as you've described would definitely take more effort, but might make all the difference if you're trying to make a tool for others to use.

# php - php中的fsockopen在服务器上不起作用

> ID：10762526
> 
> 赞同：0
> 
> 时间：2012-05-25T23:50:09.583
> 
> 标签：php, fsockopen

这是我的代码：

```
$fp = fsockopen("74.63.172.37", 22, $errno, $errstr, 50);

if (!$fp) {

    echo "not connected";

} else {

    $out = "GET / HTTP/1.1\r\n";
    $out .= "Host: 74.63.172.37\r\n";
    $out .= "Connection: Close\r\n\r\n";
    fwrite($fp, $out);
    $val = "";
    if (!feof($fp)) {
        echo "<br/>".fgets($fp, 128);
    }

    if (feof($fp)) {
        echo "<br/>Not connected";
    } else {
      echo "<br/>Connected";
    }

    fclose($fp);

    die();
} 
```

在本地服务器上，它给了我一个输出：

```
trying to connect
SSH-2.0-1.82_sshlib GlobalSCAPE
Connected 
```

而在服务器上它给了我一个输出：

```
trying to connect
Not connected 
```

我有另一个 sftp 服务器，我可以从服务器和本地连接。可能是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T23:52:54.103

您的 ISP 未启用它，或者端口被阻止。我建议你联系服务台。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T00:28:44.227

我能想到的两个选择：

目标服务器将只接受来自特定 IP 地址的连接，而您的 Web 服务器不在其上。

您的 Web 服务器上的 Open SSL 版本不兼容，因此无法同意用于连接的密码。或者它试图回退到协议 1，但目标服务器配置为仅允许协议 2（最新）。

所以 - 检查目标服务器上是否有防火墙限制，并检查 openssl 是否是最新的，并且您的 Web 服务器上的密码都可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T06:50:31.417

谢谢，我找到了解决方案。目标主机已阻止我的服务器 IP 地址。

# ruby-on-rails - Rails“入门”博客练习控制台报错

> ID：10762528
> 
> 赞同：1
> 
> 时间：2012-05-25T23:50:20.240
> 
> 标签：ruby-on-rails, ruby, console

我是 Rails 的新手，我正在学习这里的教程：http: [//guides.rubyonrails.org/getting_started.html](http://guides.rubyonrails.org/getting_started.html)

当我谈到控制台的部分时，我试图复制他们所做的，但我一定做错了什么，因为当我尝试加载页面时，我不断得到这个：

![在此处输入图像描述](../Images/887b59639cf58ac8be2030cc9b93a4ae.png)

我退出了控制台并重新启动了服务器，但我仍然不断收到该错误，但我无法在“post.rb”文件中看到可以修复的任何更改。

有没有办法让我撤消我在控制台中搞砸的事情？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T00:15:54.283

你有一个空格错误

而不是`validates: name`，它应该是`validates :name`

这很微妙，但第一个被解释为 Rails 1.9 中的快捷方式，因为`:validates => name`这不是您想要的意思。

# ios - 在方法返回时绘制的 UIImages

> ID：10762529
> 
> 赞同：0
> 
> 时间：2012-05-25T23:50:24.463
> 
> 标签：ios, uiimage

我有一个设置 49 个图像的 IBAction。图像仅在方法结束时设置，而不是一一设置。为什么它会这样做？我将如何使图像一张一张地设置，而不是在方法结束时一次全部设置。有 1.4 秒的挂起，然后立即设置所有图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T02:45:25.087

我同意马特的建议，即您应该在后台线程中加载图像，例如

```
dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);

dispatch_async(queue, ^{

    for ( /* loop through my images */ )
    {
         // do whatever you need to do to load image (e.g. create your UIImageView, myImageView) 

         // now submit it to the main queue to be displayed, in this case, adding it to the scrollview that I use to hold all of my image thumbnails

         dispatch_async(dispatch_get_main_queue(), ^{
             [self.scrollView addSubview:myImageView];
         });
    }

}); 
```

注意，创建的 UIImageView 的添加被提交回主队列，因为所有 UI 更新都必须在该主队列上发生。

# cakephp - 从一个控制器在 3/4 表中添加数据

> ID：10762530
> 
> 赞同：0
> 
> 时间：2012-05-25T23:50:42.297
> 
> 标签：cakephp

我有以下表格

用户 hasmany 餐厅

餐厅 hasmany(RestaurantCuisine, RestaurantAddress,FavoriteRestaurant,RestaurantFeature,RestaurantReview)

RestaurantAddress 有很多城市

RestaurantCuisine 有很多美食

我的问题是我可以从 UserController 向所有表中添加数据吗？

如果可以的话，怎么办？

请参考我可以找到信息的具体文件。[很多次我从http://book.cakephp.org/2.0/en/models/saving-your-data.html](http://book.cakephp.org/2.0/en/models/saving-your-data.html)阅读保存你的数据并尝试了很多东西（saveAll，saveAssociated）但仍然没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T05:26:41.717

在控制器中，您可以指定要使用的模型。这是通过属性 $uses 完成的。

```
class UsersController extends AppController {
    public $uses = array('Users', 'Restaurant') // etc
} 
```

[http://book.cakephp.org/2.0/en/controllers.html](http://book.cakephp.org/2.0/en/controllers.html)（靠近底部）

我希望这能回答你的问题，如果没有回复我的话。

科里

# android - 从 ScanResult 构造 WifiConfiguration 或：解释 ScanResult 的“功能”字符串

> ID：10762533
> 
> 赞同：12
> 
> 时间：2012-05-25T23:50:58.050
> 
> 标签：android, android-wifi, wifi

你们中的任何一个 Android 专家都知道任何开源代码来创建一个[`WifiConfiguration`](http://developer.android.com/reference/android/net/wifi/WifiConfiguration.html)给定的[`ScanResult`](http://developer.android.com/reference/android/net/wifi/ScanResult.html#capabilities)吗？这会很有帮助。事实上，我捕获的 Android 源代码（2012 年 4 月中旬）的第 483 行 (/624)`WifiConfiguration.java`是一个注释掉的构造函数，目的就是为了做到这一点，有一个很大的 TODO 想知道它是否值得实现（见下面的引用）。我示意是的，我可以听一下吗？

我看到的主要挑战（实际上是这个问题的首当其冲）是如何解释 ScanResult.configuration 字符串。

1.  我可以期待一个简单的列表，比如`[WPA2-PSK-CCMP]`，`[WPS]`等吗？
2.  这些字符串是在文档或代码库中的某个地方枚举的吗？
3.  是否有我应该知道的设备/制造商/AP 特定的字符串？

* * *

来自`WifiConfiguration.java`（可能有社论）：

```
/** 
 * Construct a WifiConfiguration from a scanned network
 * @param scannedAP the scan result used to construct the config entry
 * TODO: figure out whether this is a useful way to construct a new entry.
 *   
public WifiConfiguration(ScanResult scannedAP) {
    networkId = -1; 
    SSID = scannedAP.SSID;
    BSSID = scannedAP.BSSID;
    // aaaah screw it I'm tired/lazy
}   
*/ 
```

[https://code.google.com/p/android/issues/detail?id=60523](https://code.google.com/p/android/issues/detail?id=60523)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-21T12:41:54.047

我发现这个项目[https://code.google.com/p/android-wifi-connecter/](https://code.google.com/p/android-wifi-connecter/)和以下文件特别有用：

[https://code.google.com/p/android-wifi-connecter/source/browse/src/com/farproc/wifi/connecter/Wifi.java](https://code.google.com/p/android-wifi-connecter/source/browse/src/com/farproc/wifi/connecter/Wifi.java) [https://code.google.com/p/android-wifi -connecter/source/browse/src/com/farproc/wifi/connecter/ConfigurationSecuritiesV8.java](https://code.google.com/p/android-wifi-connecter/source/browse/src/com/farproc/wifi/connecter/ConfigurationSecuritiesV8.java)

* * *

编辑 - 新链接

[https://github.com/mkch/android-wifi-connecter/blob/master/src/com/farproc/wifi/connecter/Wifi.java](https://github.com/mkch/android-wifi-connecter/blob/master/src/com/farproc/wifi/connecter/Wifi.java) [https://github.com/mkch/android-wifi-connecter/blob /master/src/com/farproc/wifi/connecter/ConfigurationSecuritiesV8.java](https://github.com/mkch/android-wifi-connecter/blob/master/src/com/farproc/wifi/connecter/ConfigurationSecuritiesV8.java)

# php - 如何用学说随机选择

> ID：10762538
> 
> 赞同：40
> 
> 时间：2012-05-25T23:51:24.277
> 
> 标签：php, doctrine-orm, dql

以下是我如何在数据库中查询一些单词

```
$query = $qb->select('w')
    ->from('DbEntities\Entity\Word', 'w')
    ->where('w.indictionary = 0 AND w.frequency > 3')
    ->orderBy('w.frequency', 'DESC')
    ->getQuery()
    ->setMaxResults(100); 
```

我正在使用 mysql，我想获得符合条件的随机行，我会在查询中使用 order by rand()。

我发现[这个类似](https://stackoverflow.com/questions/7455279/get-random-records-with-doctrine)的问题基本上表明由于 ORDER BY RAND 在教义中不受支持，您可以改为随机化主键。但是，在我的情况下无法做到这一点，因为我有一个搜索条件和一个 where 子句，因此并非每个主键都满足该条件。

我还发现了一个[代码片段](http://snippets.symfony-project.org/snippet/375)，它建议您使用 OFFSET 来随机化这样的行：

```
$userCount = Doctrine::getTable('User')
     ->createQuery()
     ->select('count(*)')
     ->fetchOne(array(), Doctrine::HYDRATE_NONE); 
$user = Doctrine::getTable('User')
     ->createQuery()
     ->limit(1)
     ->offset(rand(0, $userCount[0] - 1))
     ->fetchOne(); 
```

我有点困惑，这是否会帮助我解决在我的情况下缺乏对随机排序的支持的问题。我无法在 setMaxResult 之后添加偏移量。

知道如何实现吗？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-05-26T00:33:28.363

Doctrine 团队[不愿意实现这个功能](https://github.com/doctrine/doctrine2/issues/5479)。

您的问题有几种解决方案，每种都有自己的缺点：

*   添加[自定义数字函数](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/cookbook/dql-user-defined-functions.html)：查看此[DQL RAND() 函数](https://gist.github.com/919465)
    （如果您有很多匹配的行可能会很慢）
*   使用[本机查询](http://docs.doctrine-project.org/en/latest/reference/native-sql.html)
    （我个人尽量避免这种解决方案，我发现它很难维护）
*   首先发出原始 SQL 查询以随机获取一些 ID，然后使用 DQL`WHERE x.id IN(?)`通过将 ID 数组作为参数传递来加载关联的对象。
    此解决方案涉及两个单独的查询，但*可能*比第一个解决方案提供更好的性能（其他原始 SQL 技术不`ORDER BY RAND()`存在，我不会在这里详细介绍，您可以在此网站上找到一些很好的资源）。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2014-12-22T14:38:51.687

跟着这些步骤：

在您的项目中定义一个新类：

```
namespace My\Custom\Doctrine2\Function;

use Doctrine\ORM\Query\Lexer;

class Rand extends \Doctrine\ORM\Query\AST\Functions\FunctionNode
{

    public function parse(\Doctrine\ORM\Query\Parser $parser)
    {
        $parser->match(Lexer::T_IDENTIFIER);
        $parser->match(Lexer::T_OPEN_PARENTHESIS);
        $parser->match(Lexer::T_CLOSE_PARENTHESIS);
    }

    public function getSql(\Doctrine\ORM\Query\SqlWalker $sqlWalker)
    {
        return 'RAND()';
    }
} 
```

注册课程 `config.yml`：

```
doctrine:
     orm:
         dql:
             numeric_functions:
                 Rand: My\Custom\Doctrine2\Function\Rand 
```

直接使用它作为：

```
$qb->addSelect('RAND() as HIDDEN rand')->orderBy('rand()'); //Missing curly brackets 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2016-12-04T14:15:12.417

根据 Hassan Magdy Saad的[建议](https://stackoverflow.com/questions/10762538/how-to-select-randomly-with-doctrine/40959512#27604826)，您可以使用流行的[DoctrineExtensions](https://github.com/beberlei/DoctrineExtensions)库：

在此处查看 mysql 实现：[https ://github.com/beberlei/DoctrineExtensions/blob/master/src/Query/Mysql/Rand.php](https://github.com/beberlei/DoctrineExtensions/blob/master/src/Query/Mysql/Rand.php)

```
# config.yml

doctrine:
     orm:
         dql:
             numeric_functions:
                 rand: DoctrineExtensions\Query\Mysql\Rand 
```

在 Doctrine ORM 2.6.x-dev 中经过测试，您实际上可以执行以下操作：

```
->orderBy('RAND()') 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-02-16T13:01:32.087

或者你可以这样做 -->

```
$words = $em->getRepository('Entity\Word')->findAll();
shuffle($words); 
```

当然，如果您有很多记录，那么这将非常低效，因此请谨慎使用。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-08-30T09:40:37.583

为什么不使用存储库？

```
<?php

namespace Project\ProductsBundle\Entity;

use Doctrine\ORM;

class ProductRepository extends ORM\EntityRepository
{
    /**
     * @param int $amount
     * @return Product[]
     */
    public function getRandomProducts($amount = 7)
    {
        return $this->getRandomProductsNativeQuery($amount)->getResult();
    }

    /**
     * @param int $amount
     * @return ORM\NativeQuery
     */
    public function getRandomProductsNativeQuery($amount = 7)
    {
        # set entity name
        $table = $this->getClassMetadata()
            ->getTableName();

        # create rsm object
        $rsm = new ORM\Query\ResultSetMapping();
        $rsm->addEntityResult($this->getEntityName(), 'p');
        $rsm->addFieldResult('p', 'id', 'id');

        # make query
        return $this->getEntityManager()->createNativeQuery("
            SELECT p.id FROM {$table} p ORDER BY RAND() LIMIT 0, {$amount}
        ", $rsm);
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-11-19T11:29:56.447

对我来说，最有用的方法是创建两个数组，我说订单类型和实体的不同属性。例如：

```
 $order = array_rand(array(
        'DESC' => 'DESC',
        'ASC' => 'ASC'
    ));

    $column = array_rand(array(
        'w.id' => 'w.id',
        'w.date' => 'w.date',
        'w.name' => 'w.name'
    )); 
```

您可以向数组 $column 中添加更多条目，例如标准。

之后，您可以使用 Doctrine 在 ->orderBy 中添加 $column 和 $order 来构建您的查询。例如：

```
$query = $qb->select('w')
->from('DbEntities\Entity\Word', 'w')
->where('w.indictionary = 0 AND w.frequency > 3')
->orderBy($column, $order)
->getQuery()
->setMaxResults(100); 
```

这种方式提高了我的应用程序的性能。我希望这可以帮助别人。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-05T08:35:10.387

可以对查询（数组）结果进行改组，但改组不会随机选择。

为了从一个实体中随机选择，我更喜欢在 PHP 中执行此操作，这可能会减慢随机选择的速度，但它允许我控制我正在做的测试并使最终的调试更容易。

下面的示例将实体中的所有 ID 放入一个数组中，然后我可以使用该数组在 php.ini 中“随机处理”。

```
public function getRandomArt($nbSlotsOnPage)
{
    $qbList=$this->createQueryBuilder('a');

    // get all the relevant id's from the entity
    $qbList ->select('a.id')
            ->where('a.publicate=true')
            ;       
    // $list is not a simple list of values, but an nested associative array
    $list=$qbList->getQuery()->getScalarResult();       

    // get rid of the nested array from ScalarResult
    $rawlist=array();
    foreach ($list as $keyword=>$value)
        {
            // entity id's have to figure as keyword as array_rand() will pick only keywords - not values
            $id=$value['id'];
            $rawlist[$id]=null;
        }

    $total=min($nbSlotsOnPage,count($rawlist));
    // pick only a few (i.e.$total)
    $keylist=array_rand($rawlist,$total);

    $qb=$this->createQueryBuilder('aw');
    foreach ($keylist as $keyword=>$value)
        {
            $qb ->setParameter('keyword'.$keyword,$value)
                ->orWhere('aw.id = :keyword'.$keyword)
            ;
        }

    $result=$qb->getQuery()->getResult();

    // if mixing the results is also required (could also be done by orderby rand();
    shuffle($result);

    return $result;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-11T20:10:03.570

我希望这对其他人有帮助：

```
 $limit = $editForm->get('numberOfQuestions')->getData();
        $sql = "Select * from question order by RAND() limit $limit";

        $statement = $em->getConnection()->prepare($sql);
        $statement->execute();
        $questions = $statement->fetchAll(); 
```

注意这里的表问题是一个 AppBundle:Question Entity。相应地更改详细信息。问题的数量取自编辑表单，请确保检查表单构建器的变量并相应地使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-02-08T12:23:25.233

@Krzysztof 的解决方案在这里是最好的恕我直言，但是 RAND() 在大型查询上非常慢，所以我更新了@Krysztof 的解决方案以提供更少的“随机”结果，但它们仍然足够随机。受此答案启发[https://stackoverflow.com/a/4329492/839434](https://stackoverflow.com/a/4329492/839434)。

```
namespace Project\ProductsBundle\Entity;

use Doctrine\ORM;

class ProductRepository extends ORM\EntityRepository
{
    /**
     * @param int $amount
     * @return Product[]
     */
    public function getRandomProducts($amount = 7)
    {
        return $this->getRandomProductsNativeQuery($amount)->getResult();
    }

    /**
     * @param int $amount
     * @return ORM\NativeQuery
     */
    public function getRandomProductsNativeQuery($amount = 7)
    {
        # set entity name
        $table = $this->getClassMetadata()
            ->getTableName();

        # create rsm object
        $rsm = new ORM\Query\ResultSetMapping();
        $rsm->addEntityResult($this->getEntityName(), 'p');
        $rsm->addFieldResult('p', 'id', 'id');

        # sql query
        $sql = "
            SELECT * FROM {$table}
            WHERE id >= FLOOR(1 + RAND()*(
                SELECT MAX(id) FROM {$table})
            ) 
            LIMIT ?
        ";

        # make query
        return $this->getEntityManager()
            ->createNativeQuery($sql, $rsm)
            ->setParameter(1, $amount);
    }
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2018-02-14T17:11:26.887

*尽快获得单个对象*结果的最简单（但不一定是最聪明）的方法可能是在您的 Repository 类中实现它：

```
public function findOneRandom()
{
    $className = $this->getClassMetadata()->getName();

    $counter = (int) $this->getEntityManager()->createQuery("SELECT COUNT(c) FROM {$className} c")->getSingleScalarResult();

    return $this->getEntityManager()

        ->createQuery("SELECT ent FROM {$className} ent ORDER BY ent.id ASC")
        ->setMaxResults(1)
        ->setFirstResult(mt_rand(0, $counter - 1))
        ->getSingleResult()
    ;
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2019-04-07T13:30:12.157

首先从 DB 表中获取 MAX 值，然后将其用作 PHP 中的偏移量，即 $offset = mt_rand(1, $maxId)

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2017-11-24T01:09:02.483

我知道这是一个老问题。但我使用以下解决方案来获取随机行。

使用**EntityRepository**方法：

```
public function findOneRandom()
{
    $id_limits = $this->createQueryBuilder('entity')
        ->select('MIN(entity.id)', 'MAX(entity.id)')
        ->getQuery()
        ->getOneOrNullResult();
    $random_possible_id = rand($id_limits[1], $id_limits[2]);

    return $this->createQueryBuilder('entity')
        ->where('entity.id >= :random_id')
        ->setParameter('random_id', $random_possible_id)
        ->setMaxResults(1)
        ->getQuery()
        ->getOneOrNullResult();
} 
```

* * *

## 回答 #13

> 赞同：-7
> 
> 时间：2016-01-20T15:07:05.277

只需添加以下内容：

```
->orderBy('RAND()') 
```

# iphone - Core Data SUBQUERY 和 NSFetchedResultsController 的 Keypath 错误

> ID：10762539
> 
> 赞同：2
> 
> 时间：2012-05-25T23:51:26.647
> 
> 标签：iphone, ios, core-data

抱歉，如果这是重复的，20 分钟的搜索没有产生这种确切的情况或解决方案。

我有一个核心数据堆栈，其中包含三个类`XClass`、`YClass`和`ZClass`。`XClass`与 有一对多的关系`YClass`。`YClass`与 有一对多的关系`ZClass`。

使用 的实例`NSFetchedResultsController`，我试图获取`XClass`至少 1 至少`YClass`具有 1的所有实例`ZClass`。

我的谓词定义如下：

```
// ...stuff
NSFetchRequest * fetchRequest = [NSFetchRequest new];

NSEntityDescription * entity = [NSEntityDescription entityForName:NSStringFromClass([XClass class])
                                           inManagedObjectContext:managedObjectContext];
fetchRequest.entity = entity;

fetchRequest.predicate = 
[NSPredicate predicateWithFormat:@"0 < SUBQUERY(yObjects, $y, $y.zObjects.@count > 0).@count"];

// ..instantiate NSFetchedResultsController and perform fetch 
```

这会导致消息出现致命异常：`Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: 'Keypath containing KVC aggregate where there shouldn't be one; failed to handle $y.zObjects.@count'`

在其他地方，我已经成功获取了`YObject`带有谓词的实例`[NSPredicate predicateWithFormat:@"zObjects.@count > 0"];`

有人可以指出我做错了什么吗？非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T01:19:11.663

当您在 SUBQUERY 的谓词字符串中使用集合运算符时，NSPredicate 对象似乎很暴力。您似乎也无法对子查询谓词中的集合进行操作。除非变量表示谓词中的集合。

坏的：`SUBQUERY(yObjects, $y, $y.zObjects == NIL) > 0`

好的：`SUBQUERY(yObjects, $y, SUBQUERY($y.zObjects, $z, $z == NIL) > 0) > 0`

以下表达式会将所有非零对象添加到 SUBQUERY 返回的过滤集合中。换句话说，返回的集合将包含所有带有 ZClass 实例的 XClass 实例。

```
[NSPredicate predicateWithFormat:@"yObjects.@count > 0 AND (SUBQUERY(yObjects, $y, (SUBQUERY($y.zObjects, $z, $z != NIL).@count > 0)).count > 0)"]; 
```

# html - Rails 中的日期时间格式

> ID：10762541
> 
> 赞同：0
> 
> 时间：2012-05-25T23:51:39.100
> 
> 标签：html, ruby-on-rails, ruby, datetime, date

使用 Rails，我需要添加 html 标签：

```
<time datetime="2012-04-29T16:58Z">20 days ago</time> 
```

从存储的日期开始。我如何从@post.created_at 获得上述信息？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T00:33:43.863

见 strftime [http://www.ruby-doc.org/core-1.9.3/Time.html#method-i-strftime](http://www.ruby-doc.org/core-1.9.3/Time.html#method-i-strftime)

```
<%= @post.created_at.strftime(%Y-%m-%dT%H:%MZ) %>
<%= time_ago_in_words(@post.created_at) %> 
```

# asp.net - Firefox 坚持认为表格显示样式是“块”而不是

> ID：10762545
> 
> 赞同：0
> 
> 时间：2012-05-25T23:52:57.913
> 
> 标签：asp.net, css, firefox

我有一个表，它看起来不对，所以我检查了元素并看到内联样式显示 =“块”。所以我转到 HTML，内联样式没有说 display: block，它没有为显示定义任何内容。我放了一个内联样式“display: table”并刷新页面，检查元素实用程序仍然说它是“display:block”。如果我检查元素，它会显示“显示：块”，但如果我右键单击页面并转到“查看页面源代码”，我会看到内联样式显示“显示：表”。

有没有人见过这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:35:17.887

我刚刚遇到这个问题，并在您的帖子仍在我的屏幕上时解决了它，所以我想我会回答：如果元素的定位设置为绝对，firefox 会将表格单元格转换为块。通过将其设置为相对，事情会以应有的方式出现。

# c++ - C++ 类/向量指针问题

> ID：10762547
> 
> 赞同：3
> 
> 时间：2012-05-25T23:53:55.123
> 
> 标签：c++, pointers, vector

我正在尝试使用一个类的指针向量。尝试访问 Agent 类的任何成员时，我要么得到错误的指针，要么得到空数据。代码如下。

```
class Grue : public Agent
{
    string name;
    Room *cur_room;
 public:
   Functions()....
};

class Agent
{
        Room *cur_room;
        string name;
  public:
         Functions()....
};

Grue* Grue1 = new Grue("Test", roompointer);
vector<Agent*> agents;
agents.push_back(Grue1); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T00:07:19.523

Data members are private by default in a class. Thus your **cur_room**, **name** variables are different in the Agent and Grue class. When you call the Grue constructor, the Grue fields are initialized, but the vector stores Agent pointers, therefor you are accessing the agent fields which are not initialized.

here's the correct way of doing this:

```
class Agent
{
protected:
    Room *cur_room;
    string name;
public:
    Agent(string n, Room * r)
    : cur_room (r), name(n)         
    {}
};

class Grue : public Agent
{

public:
    Grue(string n, Room * r):Agent(n,r)
    {

    }
}; 
```

# objective-c - CCTexture2D。无法在 iPod touch 而非模拟器上创建纹理错误

> ID：10762554
> 
> 赞同：0
> 
> 时间：2012-05-25T23:54:41.223
> 
> 标签：objective-c, ios, cocos2d-iphone

我有一个通过 Xcode 在 iPhone 模拟器中运行良好的应用程序。当我尝试在 iPod touch 上运行应用程序时，我收到以下错误；

2012-05-25 19:40:33.014 PracticeOne [602:707] cocos2d: CCTexture2D。无法创建纹理。UIImage 为零 2012-05-25 19:40:33.016 PracticeOne[602:707] cocos2d：无法在 CCTextureCache 中添加图像：Success1.png 2012-05-25 19:40:33.025 PracticeOne[602:707] ***断言-[Game addChild:z:] 失败，/IOSDevelopment/PracticeOne/PracticeOne/libs/cocos2d/CCNode.m:407

我有一个 Success1.png 图像，存储在 Resources 文件夹中。

当用户点击提交按钮时，会执行以下逻辑；

//在屏幕上显示成功图形

```
 CCSprite *goodWord = [CCSprite spriteWithFile:@"Success1.png"];
    [goodWord setPosition:ccp(s.width / 2, s.height / 2) ];
    [self addChild:goodWord z:200];
    id action1 = [CCFadeIn actionWithDuration:1.5];
    id action2 = [CCFadeOut actionWithDuration:1.5];
    [goodWord runAction:action1];
    [goodWord runAction:action2]; 
```

因此，我检索了 png 文件，将其定位并将其添加到场景中。我运行动作来淡入淡出图像。它短暂出现然后消失，向用户显示他们成功了。

当我调试设备上运行的代码时，尝试检索 Success1.png 后，goodWord 不包含地址。

有谁知道为什么它可以在模拟器中成功并在一个设备中抛出这个错误？我的资源文件夹中的其他图像在设备上显示良好。

任何提示或建议将不胜感激。如果成功，我将继续寻找解决方案并进行更新。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T01:14:41.273

我不确定这是否是 OS X 和 iOS 之间的错误或行为怪癖，但我有一次非常相似（如果不是完全相同的问题）之前我不得不将另一个项目中的图像用于另一台设备作为iOS 项目的资产基础。

在我的具体情况下，原始图像是 gif 文件，我已将它们转换为 png。我在 Photoshop 中打开了所有文件，然后将每个文件保存为新的 png。有时我忘记更改文件格式，只是将 .gif 扩展名替换为 .png。我不相信 Photoshop 警告过我，所以我有效地保存了带有 png 扩展名的 gif！

奇怪的是，您可以将带有 png 扩展名的这些类型的 gif 加载到 X Code 中并运行它们将在您的模拟器上的应用程序中运行！但是，当您加载应用程序并从那里进行测试时，它们将无法在您的 iOS 设备上运行。

修复它就像正确地重新保存图像一样简单，确保选择正确的格式。

我不确定您的图像来自哪里或您可能使用过哪种类型的编辑器，但我想知道 OS X 是否足够聪明，可以确定图像存储为哪种类型的文件，而不管它的扩展名是什么。然而，iOS 似乎没有这种内置智能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T13:01:56.153

该设备对精细名称区分大小写。确保 Xcode 导航器中的文件名在大小写上与资源文件夹中的精细名称相同。此外，“深度清理”您的项目以揭示其他差异选项-> 构建可能是一个好主意。

# sql - 删除其他日期中包含的日期？

> ID：10762561
> 
> 赞同：5
> 
> 时间：2012-05-25T23:56:49.533
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有以下行：

```
CREATE TABLE #TEMP (id int, name varchar(255), startdate datetime, enddate datetime)
INSERT INTO #TEMP VALUES(1, 'John', '2011-01-11 00:00:00.000','2011-01-11 00:01:10.000')
INSERT INTO #TEMP VALUES(2, 'John', '2011-01-11 00:00:20.000','2011-01-11 00:01:05.000')
INSERT INTO #TEMP VALUES(3, 'John', '2011-01-11 00:01:40.000','2011-01-11 00:01:50.000')
INSERT INTO #TEMP VALUES(4, 'Adam', '2011-01-11 00:00:40.000','2011-01-11 00:01:20.000')
INSERT INTO #TEMP VALUES(5, 'Adam', '2011-01-11 00:00:45.000','2011-01-11 00:01:15.000')

SELECT * FROM #TEMP

DROP TABLE #TEMP 
```

我正在尝试删除日期包含在其他日期中的记录以获取以下内容：

```
John 2011-01-11 00:00:00.000 2011-01-11 00:01:10.000
John 2011-01-11 00:01:40.000 2011-01-11 00:01:50.000
Adam 2011-01-11 00:00:40.000 2011-01-11 00:01:20.000 
```

关于如何为大约 100K 行的表实现这一点的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T00:07:45.673

这给出了预期的结果：

```
DELETE T1 FROM #TEMP T1
WHERE EXISTS(
    SELECT NULL FROM #TEMP T2
    WHERE   t1.id <> t2.id
    AND     t1.name = t2.name
    AND     t1.startdate >= t1.startdate
    AND     t1.enddate   <= t1.enddate
) 
```

[http://msdn.microsoft.com/en-us/library/ms188336.aspx](http://msdn.microsoft.com/en-us/library/ms188336.aspx)

**编辑**：我刚刚注意到有一个问题。如果有重复（相同的开始日期和结束日期），两者都将被删除（约翰的方法没有，即使只有一个相同的日期）。所以你需要考虑到这一点：

```
DELETE T1 FROM #TEMP T1
WHERE EXISTS(
    SELECT NULL FROM #TEMP T2
    WHERE   t1.id <> t2.id
    AND     t1.name = t2.name
    AND     t1.startdate > t2.startdate
    AND     t1.enddate   < t2.enddate
    OR      t1.id <> t2.id
    AND     t1.name = t2.name
    AND     t1.startdate = t2.startdate
    AND     t1.enddate   < t2.enddate
    OR      t1.id <> t2.id
    AND     t1.name = t2.name
    AND     t1.startdate > t2.startdate
    AND     t1.enddate   = t2.enddate
    OR      t1.id > t2.id
    AND     t1.name = t2.name
    AND     t1.startdate = t2.startdate
    AND     t1.enddate   = t2.enddate
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T00:17:08.333

```
DELETE t1 FROM #TEMP t1
INNER JOIN #TEMP t2 ON t2.startdate < t1.startdate AND t1.enddate < t2.enddate
AND t1.name = t2.name 
```

结果匹配

# image-processing - 部分重建 tesseract 字典

> ID：10762562
> 
> 赞同：1
> 
> 时间：2012-05-25T23:56:51.177
> 
> 标签：image-processing, ocr, tesseract

我正在对餐厅菜单上的食品进行 OCR。我知道菜单中的每个项目是什么，并且想创建一个训练数据文件，该文件只包含我知道菜单中的单词字典。

我见过的所有关于构建字典的文档都涉及从头开始。有没有办法使用现有的训练数据，但不必从头开始重建字典？

谢谢。

注意：我不想使用 user-words 文件，因为它似乎只是**添加**到所选字典中，而不是**替换**.

# azure - approot 或 sitesroot 中的手动文件系统更改是否在实例之间同步？

> ID：10762565
> 
> 赞同：0
> 
> 时间：2012-05-25T23:57:19.113
> 
> 标签：azure

我有一个可以接收用户上传的文件的网络应用程序。这些文件存储在 Web 服务器的目录中。其他用户可以下载这些文件。我正在自定义此应用程序以在 Windows Azure 上迁移。在 Windows Azure 上，这些文件存储在 sitesroot 和 approot 中。Windows Azure 是自动同步这些更改还是我应该手动同步它们？也许，用这种方法存储文件不合适？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T01:38:35.630

实际上，Azure 不会*在*实例之间同步目录。您希望将文件存储在集中式存储中。Azure Blob 存储是迄今为止最好的选择。访问存储的API比较简单

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T02:04:54.757

@Igorek 的好回答。只是想补充一点。您的每个角色实例都完全独立运行。而且，从本质上讲，角色实例是 Windows 2008 Server。如果您有 5 个 Web 角色实例，则有 5 个虚拟机正在运行，每个虚拟机都有自己的本地存储。

而且，虽然您可以使用本地存储，但它是每个 VM 实例的单独存储，*并且*它是非持久的（这意味着如果磁盘崩溃，您的数据就会消失）。

正如@Igorek 所建议的那样，Blob 存储独立于您的角色实例。您可以从任何地方（从任何角色实例，甚至从本地应用程序）访问它。而且blob存储是按容器组织的，每个blob最大可以达到200GB。但最重要的是：它是*持久*的：在数据中心内进行三重复制，并在地理上复制到相邻的数据中心。

只要您的存储帐户与您的应用程序位于同一数据中心，访问速度就会非常快（每个 blob 大约 60MB/秒）。此外，您可以将单个 blob（或容器）设置为*public*或*private*。公共 blob 非常适合 CSS、图像或您可能希望在网页上呈现的任何其他内容。它们可以通过 URI 访问，例如：

`https://myapp.blob.core.windows.net/images/logo.png`

使用这种类型的 URI，您可以将其嵌入网页中，浏览器现在将直接从存储中检索这些图像，完全绕过您的 IIS Web 服务器，从而减轻您的角色实例的负载。从您的服务器上减轻足够的负载，您最终可以减少您的实例数。

现在，有了*私有*blob，外部世界就看不到这些了；您需要您的存储帐户密钥才能访问这些。对于您的 Web 服务器，这一切都是透明的。您可以快速将数据加载到 Blob、将 Blob 下载到本地存储、向最终用户提供内容……就像从本地磁盘提供内容一样。如果您需要对必须位于磁盘上的文件执行操作，您可以先将其下载到本地存储，然后从本地存储执行操作。

关于私有 blob 的另一件事：您可以通过在查询字符串上使用*共享访问签名*对 url 进行编码来授予对它们的临时访问权限。这是使用您的存储帐户密钥签署的，并授予长达一小时的访问权限。例如，如果您的最终用户拥有其他人不应访问的特定于帐户的 pdf，则您可以选择提供此内容。任何一个：

*   将私有 blob 从 blob 存储下载到本地存储，然后通过 IIS（或任何备用 Web 服务器）将其发送回浏览器，或者
*   返回到私有 blob 的链接，使用共享访问签名进行编码（具有一些短 TTL 到期时间，可能是 5 分钟），并让最终用户从他们的浏览器访问 blob（例如，通过链接单击），然后绕过您的角色实例，直接从 blob 存储下载 blob。

# javascript - 这是编写这种非数字/字母排序的最佳方式吗？

> ID：10762566
> 
> 赞同：0
> 
> 时间：2012-05-25T23:57:22.293
> 
> 标签：javascript, regex, arrays, sorting

我将各种样式的字体对象分组到数组中。每个字体对象都有一个属性 sub_family，它可以是 Regular、Italic、Bold、Bold Italic（或某些变体，例如 Italic 有时称为 Oblique）。当它们从数据库中出来时，它们是随机顺序的，需要按上述排序；常规总是第一个，斜体第二个，等等。

这是我正在使用的排序功能，它有效，但我想看看你们是否能想出更好/替代的解决方案：

```
// input: ["Bold Italic", "Regular", "Bold", "Italic"]    
sortFont = function(a, b) {
    // regular
    if (/^([Rr]egular|[Nn]ormal)$/.test(a.sub_family)) { return -1; }
    if (/^([Rr]egular|[Nn]ormal)$/.test(b.sub_family)) { return 1; }
    // italic
    if (/^([Ii]talic|[Ii]nclined|[Ii]t|[Oo]blique|[Oo]bl)$/.test(a.sub_family)) { return -1; }
    if (/^([Ii]talic|[Ii]nclined|[Ii]t|[Oo]blique|[Oo]bl)$/.test(b.sub_family)) { return 1; }
    // bold
    if (/^([Bb]old|[Bb]d)$/.test(a.sub_family)) { return -1; }
    if (/^([Bb]old|[Bb]d)$/.test(b.sub_family)) { return 1; }
}
// output: ["Regular", "Italic", "Bold", "Bold Italic"] 
```

谢谢！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T01:18:37.537

通过使用 i 标志，您可以替换

```
/^([Rr]egular|[Nn]ormal)$/ 
```

和

```
/^(regular|normal)$/i 
```

i 标志使正则表达式忽略字母字符的大小写。请注意，这将允许 REGULAR 或 ReGuLaR 等名称，如果这会导致问题，请使用您的原始公式。

然后更换

```
/^([Ii]talic|[Ii]nclined|[Ii]t|[Oo]blique|[Oo]bl)$/ 
```

和

```
/^(it(alic)?|inclined||obl(ique)?)$/i 
```

这 ？使其前面的内容成为可选的。

如果您的字体名称始终一致，另一种选择如下：

```
var sorted = ["Regular", "Italic", "Bold", "Bold Italic"];
function sortFont (a, b) {
  return sorted.indexOf (a) - sorted.indexOf (b);
} 
```

在这里，我们在每个候选字体的名称的排序数组中找到索引。减去这两个索引提供了排序顺序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T02:19:08.573

这是一种更有效的方法，它还允许您通过向表中添加条目来维护它：

```
sortKeys = {
    "regular": 1,
    "normal": 2,
    "italic": 10,
    "inclined": 11,
    "oblique": 12,
    "bold": 20,
    "bold italic": 30
};

function sortFont(a, b) {
    var aKey = sortKeys[a.sub_family.toLowerCase()] || 100;
    var bKey = sortKeys[b.sub_family.toLowerCase()] || 100;
    return(aKey - bKey);
} 
```

在这里演示：http: [//jsfiddle.net/jfriend00/MB76R/](http://jsfiddle.net/jfriend00/MB76R/)

# javascript - jquery如何从最后一次迭代中传递变量？

> ID：10762573
> 
> 赞同：0
> 
> 时间：2012-05-25T23:58:23.673
> 
> 标签：javascript, jquery, image, recursion, iteration

我有一个每个循环通过对象，

在其中，我创建了一些图像，我想在它们中放入最后一次迭代中对图像的引用数据。

例如：

```
.each((function(some_data){ return function(i, obj){

    var prev='???'; // how do I retrieve the value from the last cycle?
    var image=new Image();
        image.data('prev',prev);
        prev=image;
                // how do I pass the value to next cycle?
    }})(some_data)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T00:01:46.397

在您的 .each 调用之前，您在外部范围中定义变量..

```
var prev=null;
collection.each(function(idx, val){
   alert("Prev should have value from previous iteration (or null):" + prev);
   var image=new Image();
   image.data('prev',prev);
   prev=image;
 })(some_data)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T00:04:27.357

在 jquery 每个范围之外使用全局值。

```
myloopingvar=null;

 .each((function(some_data){ return function(i, obj){

if(loopingvar !=null) 
 {// do stuff
 }
 var image=new Image(); image.data('prev',prev); loopingvar=image }})(some_data)); 
```

# php - 递减字母值

> ID：10762579
> 
> 赞同：6
> 
> 时间：2012-05-25T23:59:25.943
> 
> 标签：php

我试图弄清楚如何将数组中的一堆字母值向下移动一步。例如，我的数组包含值（“d”、“e”、“f”、“g”、“h”），我想将其更改为（“c”、“d”、“e”、“f “， “G”）。这是我正在使用的代码：

```
function move_up_left($x) {
    if($x['orientation'] == "down") {
        foreach($x[0] as &$value) {
            $value = --$value; 
        }
    } else {
        foreach($x[1] as &$value) {
            $value = --$value;
        }
    }

    return $x;
} 
```

当我使用正值时，字母会发生变化；然而，负数似乎根本不起作用。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-26T00:13:06.890

PHP 重载`++`了字符串；情况并非如此`--`。您可以使用更简洁的代码来做同样的事情，包括[`chr`](http://php.net/chr),[`ord`](http://php.net/ord)和[`array_map`](http://php.net/array_map)：

```
function decrementLetter($l) {
    return chr(ord($l) - 1);
}

function move_up_left($x) {
    if($x['orientation'] === 'down') $arr = &$x[0];
    else $arr = &$x[1];

    $arr = array_map('decrementLetter', $arr);

    return $x;
} 
```

[这是一个演示。](http://codepad.org/XpFOfpCR)请注意，您可能需要为递减添加特殊情况`a`- 我不确定您要如何处理。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-04-07T10:08:07.763

如果您需要减少类似 Excel 的变量（'A'、'AA'、...），这是我来的函数。它不适用于特殊字符，但不区分大小写。如果您尝试减少“a”或“A”，它会返回 null。

```
function decrementLetter($char) {
     $len = strlen($char);
     // last character is A or a
     if(ord($char[$len - 1]) === 65 || ord($char[$len - 1]) === 97){ 
          if($len === 1){ // one character left
               return null;
           }
           else{ // 'ABA'--;  => 'AAZ'; recursive call
               $char = decrementLetter(substr($char, 0, -1)).'Z';
            }
     }
     else{
         $char[$len - 1] = chr(ord($char[$len - 1]) - 1);
     }
     return $char;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T00:21:12.717

```
function shift_character($array, $right = FALSE)
{
    $inc = ($right) ? 1 : -1;
    for ($i = 0; $i < count($array); $i++)
    {
        $array[$i] = chr(ord($array[$i]) + $inc);
    }
    return $array;
}

$example = array('b', 'c');
$shift_left = shift_character($example);
$shift_right = shift_character($example, TRUE);

print_r($example);
print_r($shift_left);
print_r($shift_right); 
```

# php - 在变量中搜索某个术语的文本，php

> ID：10762580
> 
> 赞同：0
> 
> 时间：2012-05-25T23:59:27.127
> 
> 标签：php

1.  我正在从数据库中提取提到“健身”一词的个人资料，如下所示：

    ```
    $result = mysql_query("SELECT profile FROM ".$table." WHERE profile LIKE ('fitness')"); 
    ```

2.  我正在对`$profile`变量进行基本检索并回显它。

    ```
    while($slice = mysql_fetch_assoc($result)) {
        $profile = $slice['profile'];
        echo $profile;
    } 
    ```

我想要的是一种在文本中搜索`$profile`“健身”一词并使用 CSS 突出显示找到的词的方法。

有什么想法吗？

**更新：**

Ty 非常，我还有一个问题。

在 sql 查询中，我将拥有：

```
$result = mysql_query("SELECT profile FROM ".$table." WHERE $profile_rule");

$profile_rule = 'profile LIKE ('fitness') AND profile LIKE ('pets')'; 
```

有没有办法s**trip $profile_rule** 并且只得到**fitness 和pets 两个词**？也许剥离没有被 '' 包裹的所有东西？

泰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T00:06:00.883

```
function highlightWord($word, $text){
    return str_replace($word, '<span class="highlighted">' . $word . '</span>', $text);
}

$profile = highlightWord('fitness', $profile); 
```

**编辑**：根据您的更新，看看`IN()`运营商：

```
$result = mysql_query("SELECT profile FROM $table WHERE profile IN ('fitness','pets')"); 
```

**编辑2**：我想我误解了你的问题，虽然我仍然建议编辑1。如果你只想从那个字符串中获取单词，请使用一些简单的正则表达式`fitness`：`pets``$profile_rule`

```
preg_match_all("|[a-z]+(?=\'\)|","profile LIKE ('fitness') AND profile LIKE ('pets')", $profiles);
var_dump($profiles); // array(1) { [0]=> array(2) { [0]=> string(7) "fitness" [1]=> string(4) "pets" } } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T00:02:31.790

```
$profile = str_replace("fitness", "<span style=\"color:red\">fitness</span>",
           $slice["profile"]); 
```

# ubuntu - ubuntu 12.04 SSL 握手失败

> ID：10762582
> 
> 赞同：0
> 
> 时间：2012-05-25T23:59:42.353
> 
> 标签：ubuntu, ssl-certificate, ubuntu-12.04

您好，我不想安装 ubuntu 12.04 beta，因为它有一些 SSL 问题。在 11.04 中也有同样的问题，但它有一个简单的修复方法：

1.  sudo apt-get install libneon27

    1.  cd /usr/lib

    2.  sudo rm libneon-gnutls.so.27

    3.  并创建一个软链接 sudo ln -s /usr/lib/libneon.so.27 libneon-gnutls.so.27

所以我只是在虚拟机中安装了 Ubuntu 12.04 final 来查看这个错误是否已修复，但我认为没有。有人知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:09:09.080

经过一番谷歌搜索，结果发现与 Precise 捆绑的 libneon 版本中存在导致此问题的错误。幸运的是，这已经在 0.29.3 版本中得到修复。要恢复正常工作的颠覆，请执行以下步骤：

1.  卸载当前的 libneon 包：sudo apt-get remove libneon27>

2.  下载最新的 libneon 包 [http://packages.debian.org/squeeze/libneon27](http://packages.debian.org/squeeze/libneon27) （在底部您可以为您的架构选择正确的版本）。

3.  安装需要的libssl依赖： sudo apt-get install libssl0.9.8 安装下载的libneon包。例如对于 64 位架构：dpkg -i libneon27_0.29.3-3_amd64.deb

4.  如上所述再次更改符号链接：sudo mv /usr/lib/libneon-gnutls.so.27 /usr/lib/libneon-gnutls.so.27.old sudo ln -s /usr/lib/libneon.so。 27 /usr/lib/libneon-gnutls.so.27

（[来源](http://www.yeap.de/blog2.0/archives/260-Subversion-Certificate-Problems-with-Ubuntu-Precise-Pangolin.html)）

# php - 发送表单后如何在不刷新页面的情况下重新加载元素的内容（蛋糕方式）？

> ID：10762583
> 
> 赞同：1
> 
> 时间：2012-05-26T00:00:10.407
> 
> 标签：php, javascript, ajax, cakephp, cakephp-2.1

我有一个元素（评论列表和表单）在我的应用程序的许多地方使用。它工作得很好而且很漂亮，除了它需要刷新整个页面。这可能会产生问题，尤其是当它重置您的评论所属的游戏时，会导致所有进度都悲惨地丢失。我对 AJAX 的经验非常有限，那么用添加的注释重新加载元素的最有效、最简单的方法是什么？

这是我的元素：

```
<?php
/*
set variables:
$data : data of the parent
$type : the type of the parent
$name : (optional)unique name to avoid naming conflicts
*/
if(!isset($name)) {
$name = 0;
}
foreach($data['Comment'] as $comment){
    echo '<div class="comment">'.$comment['content'].
        ' - '.$this->Html->link($comment['User']['username'],array('controller'=>'users','action'=>'view',$comment['User']['id']))
        .'</div>';
}
echo $this->Form->create(null, array('url' => '/comments/add','id'=>'qCommentForm'));
echo $this->Html->link('Leave comment','javascript:toggleDisplay("comment'.$name.'")');
echo '<br><div id="comment'.$name.'" style="display:none;">';
echo $this->Form->input('Comment.parent_id', array('type'=>'hidden','value'=>$data[$type]['id']));
echo $this->Form->input('Comment.parent_type', array('type'=>'hidden','value'=>$type));
echo $this->Form->textarea('Comment.content',array('div'=>'false','class'=>'small','label'=>false));
echo $this->Form->submit(__('Leave comment'),array('div'=>'false','class'=>'small'));
echo '</div>';
echo $this->Form->end();
?> 
```

### 更新

好的，多亏了您的帖子，我对 ajax 有了更多的了解，但我仍然不明白如何以“蛋糕的方式”做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T08:54:58.307

使用这样的 HTML：

```
<div id="comments">
    <!-- list of comments here -->
</div>

<form method="post" action="/comments/add" id="qCommentForm">
    <textarea name="Comment.content"></textarea>
    <input type="submit" value="Leave comment">
</form> 
```

您可以使用 JavaScript（在本例中为 jQuery）拦截提交事件并使用 Ajax 发送评论数据（假设 PHP 表单处理程序为新评论返回一个 HTML 片段）：

```
// run on document ready
$(function () {
    // find the comment form and add a submit event handler
    $('#qCommentForm').submit(function (e) {
        var form = $(this);

        // stop the browser from submitting the form
        e.preventDefault();

        // you can show a "Submitting..." message / loading "spinner" graphic, etc. here

        // do an Ajax POST
        $.post(form.prop('action'), form.serialize(), function (data) {
            // append the HTML fragment returned by the PHP form handler to the comments element
            $('#comments').append(data);
        });
    });
}); 
```

如果 PHP 表单处理程序返回整个评论列表（作为 HTML）而不是只返回新的，您可以使用`.html()`代替`.append()`：

```
$('#comments').html(data); 
```

[您可以在http://docs.jquery.com/](http://docs.jquery.com/)找到 jQuery 文档。

* * *

**更新：**我不是 CakePHP 专家，而是“蛋糕之路”AFAICT：

1.  [设置 JsHelper](http://book.cakephp.org/2.0/en/core-libraries/helpers/js.html#using-a-specific-javascript-engine)：

    1.  下载您喜欢的 JavaScript 库

    2.  在您的视图/布局中包含库，例如

        ```
        echo $this->Html->script('jquery'); 
        ```

    3.  在您的视图/布局中写入 JsHelper 缓冲区，例如

        ```
        echo $this->Js->writeBuffer(); 
        ```

    4.  在您的控制器中包含 JsHelper，例如

        ```
        public $helpers = array('Js' => array('Jquery')); 
        ```

2.  使用[`JsHelper::submit()`](http://book.cakephp.org/2.0/en/core-libraries/helpers/js.html#JsHelper%3a%3asubmit)而不是`FormHelper::submit()`生成将执行 Ajax 表单提交的提交按钮，例如

    ```
    echo $this->Js->submit('Leave comment', array('update' => '#comments')); 
    ```

3.  在您的控制器中，检测请求是否是 Ajax 请求，如果是，则使用 Ajax 布局呈现，例如

    ```
    if ($this->request->is('ajax')) {
        $this->render('comments', 'ajax');
    } 
    ```

不确定是否/如何[`RequestHandlerComponent`](http://book.cakephp.org/2.0/en/core-libraries/components/request-handling.html)计算到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T22:30:30.317

我不确定 cakePHP，但总的来说，这就是我在自定义应用程序中的做法。

1.  创建一个普通的 HTML 表单元素并设置所有输入。
2.  将事件侦听器 (javascript) 绑定到此表单以捕获提交事件。这可以通过多种方式完成，我使用的是 jQuery 库，因为它易于使用，尤其是 ajax 请求。您可以观看提交按钮并侦听单击事件，也可以观看表单并侦听提交事件。
3.  如果触发了事件，您需要返回 false 以便表单没有真正提交。相反，您收集表单数据 ( `form.serialize()`) 并通过 ajax 请求将数据发送到服务器上的某个 PHP 脚本。
4.  该脚本处理请求并将答案（HTML 代码）发送回客户端的浏览器。
5.  根据需要，使用 jQuery 或自定义 javascript 将返回的 HTML 注入到任何 DOM 元素中。例如，您可以用新的 HTML 替换表单。
6.  注意：许多 PHP 框架都有用于处理 ajax 请求的特殊控制器，cakePHP 可能也有。这意味着，您需要两个控制器和两个视图才能在您的框架模式中工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T06:27:50.383

这是我的一步一步：
1.首先创建一个带有表单的html文件，表单如下所示：

```
<body>
<div id="comment-list"></div>
<form id="form">
<textarea name="comment"></textarea>           
<input type="button" value="Submit Comment" id="submitcomments">
</form>
</body> 
```

2.然后像这样调用jquery库：

```
 <script language="javascript"  src="<js directory>/jquery-1.7.2.js">/script> 
```

您可以在此处获取 jquery：http: [//api.jquery.com](http://api.jquery.com)
3\. 然后创建一个 jquery ajax，如下所示：

```
<script>
$(document).ready(function()
{
        $("#submitcomments").click(function(){  //upon clicking of the button do an ajax post 
              var serializedata = $("#form").serialize(); //serialize the all fields inside the form
              $.ajax({
                     type: 'POST',
                     url: 'filename.php', //some php file returning the comment list
                     data: serializedata,// data that will be posted on php files
                     success: function(data)
                     {
                     $("#comment-list").append(data);  //now if the ajax post was success append the data came from php to the comment-list container in the html
                     }                                   
                  });
          });
});  
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-04T05:46:44.710

以前的答案包括 ajax 示例代码。一种有效的方法是让您的 php 代码返回一个带有您的代码加载的最后一条消息的 uid 的 javascript 变量 UID，并包含一个空的 div（即 ）。然后，您可以在该 div 之前插入您的 ajax 调用结果，并为变量 UID 设置一个新值，而不是一般地使用所有消息的 innerHTML。您还可以在任何所需的时间间隔使用此变量轮询您的服务器以获取新评论。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T15:11:08.490

我不了解 PHP，但使用 Jsp 和 js，我会对元素执行操作以调用 js，并在其中执行类似 var element =document.getElementById().. then element.innerHTML= "new value" 的操作如果在 ypur 情况下这是不可能的

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-03T03:09:03.683

这是获得您想要实现的目标的分步指南。

1.  首先，您需要获取要动态更新的代码的所有部分，并给它们一个唯一的 id。不同页面的 id 可以相同，只要该 id 在某个页面上只存在一次即可。

    ```
    <div id="comments"></div> 
    ```

2.  接下来，您需要构建一个 ajax 请求以从您的表单中发布评论。假设您有以下评论 textarea （`<form>`ajax 请求不需要）：

    ```
    <textarea name="comment" id="add_comment"></textarea> 
    ```

    你会做一个类似于这样的 ajax 请求：

    ```
    function refreshComments() {
        var comment = encodeURIComponent(document.getElementById('add_comment').value);
        var xmlhttp;

        if (window.XMLHttpRequest) {
            xmlhttp = new XMLHttpRequest();
        }
        else {
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange=function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                document.getElementById('comments').innerHTML = xmlhttp.responseText;
            }
        }
        xmlhttp.open("POST","add_comment.php?comment=" + comment, true);
        xmlhttp.send();
    } 
    ```

3.  现在将您的`submit`按钮更改为如下所示：

    `<input type="button" name="addComment" value="Add Comment" onClick="refreshComments();" />`

4.  现在在 PHP 中，您需要处理添加评论的请求，然后您需要回复该特定页面的所有评论。（这将允许用户在空闲时查看其他用户发布的任何评论。）您所要做的就是将评论回显到 ajax 页面（示例中的 add_comment.php）。

这是一个你可以玩的小提琴，看看它是如何工作的：http: [//jsfiddle.net/xbrCk/](http://jsfiddle.net/xbrCk/)

# symfony - 如何将其转换为 Doctrine 2 QueryBuilder 格式？

> ID：10762586
> 
> 赞同：15
> 
> 时间：2012-05-26T00:00:44.093
> 
> 标签：symfony, doctrine-orm

我想用 Doctrine 编写嵌套查询；示例 SQL 如下所示：

```
SELECT * FROM layer WHERE layer.id NOT IN 
               (SELECT task_id FROM users_tasks WHERE user_id = 1) 
AND parent_id IS NOT NULL AND leaf IS TRUE 
```

我在转换**SECOND** `SELECT`语句时遇到问题。

提前致谢。

我想用`createQueryBuilder`not来做`createQuery`。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-05-26T03:28:05.890

试试这个 ：

1）创建您的子查询

```
$subquery = $this->_em->createQueryBuilder()
    ->select('t.id')
    ->from('yourBundle:Task', 't')
    ->innerjoin('t.user','u')
    ->where('u.id = 1')
    ->getDQL(); 
```

2）创建查询后

```
$query = $this->_em->createQueryBuilder();
$query->select('l')
      ->from('yourBundle:Layer', 'l')
      ->where($query->expr()->notIn('l.id', $subquery))
      ....; 
```

我测试了它并且它有效:)

# javascript - 在 WordPress 中，当鼠标悬停在区域标签上时，Javascript 图像会弹出

> ID：10762588
> 
> 赞同：0
> 
> 时间：2012-05-26T00:01:13.160
> 
> 标签：javascript, wordpress, tooltip, onmouseover

我正在 WordPress 内部构建图像映射（形状是不规则多边形，不能使用 CSS），并且我想在区域标签上加载带有 onMouseOver 的帖子缩略图。这是我在循环中的内容：

```
<area shape="poly" onMouseOver="<!-- load the_post_thumbnail() as a tooltip -->" coords="511,75,540,115,560,109,544,58" href="<?php get_permalink($id); ?> " alt="Area 1" /> 
```

是否有一个可以与此一起使用的javascript插件？我在想我需要在循环中包含部分 javascript，以便 WordPress 知道要加载的帖子缩略图。

如果您知道更好的方法来做到这一点，请分享。谢谢！

**编辑：@PitaJ 的回答正确地引导我找到了这个解决方案：**

**Javascript：**

```
(function ($) {

var currentMousePos = { x: -1, y: -1 };
    $(document).mousemove(function(event) {
        currentMousePos = {
            x: event.pageX,
            y: event.pageY
        };
    });
    this.toolTip = function(thumbURL, thumbTitle){
        $("#content").append("<div class='thumbnail' style='position:fixed;width:150px;background:#333;padding:5px;top:" + currentMousePos.y + "px;left:" + currentMousePos.x +"px;'><img src='"+ thumbURL +"' alt='' /><p style='color:#fff;text-align:center;'>" + thumbTitle + "</p></div>");
    };

    this.toolTipHide = function(){
        $(".thumbnail").remove();
    };

})(jQuery); 
```

**HTML/PHP（在 WordPress 循环内）：**

```
<area shape="poly" coords="511,75,540,115,560,109,544,58" href="' . get_permalink($id) . '" alt=""'; if(has_post_thumbnail()) { echo ' onMouseOver="toolTip(\'' . $thumb_url . '\', \'' . $thumb_title . '\')" onMouseOut="toolTipHide()"';} echo '/>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T00:22:25.030

**HTML / PHP**

```
<area shape="poly" onMouseOver="thumbnailTooltip(<?php echo thumbnail_info(); ?>)" coords="511,75,540,115,560,109,544,58" href="<?php get_permalink($id); ?> " alt="Area 1" /> 
```

**JavaScript**

```
function thumbnailTooltip(thumbnailUrl, thumbnailName, thumbnailInfo) {
var element = '<div class="thumbnail" id="' + thumbnailName + '"><h3 class="thumbnail_header">' + thumbnailName + '</h3><p class="thumbnail_info">' + thumbnailInfo + '<br /><img class="thumbnail_image" src="' + thumbnailUrl + '" /></p></div>';
$('body').append(element);
$('#' + thumbnailName).css({ 'top': ($(this).offset().top + 'px'), 'left': ($(this).offset().left + 'px'), 'position': 'fixed');
} 
```

**PHP**

```
function thumbnail_info() {
var thumbnailUrl, thumbnailName, thumbnailInfo; // URL, Name, and Info of thumbnail to be displayed
return '"' . thumbnailUrl . '", "' . thumbnailName . '", "' . thumbnailInfo . '"';
} 
```

# ruby-on-rails - Rails gem 文件编辑

> ID：10762590
> 
> 赞同：2
> 
> 时间：2012-05-26T00:01:38.033
> 
> 标签：ruby-on-rails, bundle, gemfile

我正在开始一个 Rails 教程，告诉我在创建新的演示应用程序时编辑 gemfile：

```
source 'https://rubygems.org'

gem 'rails', '3.2.3'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem :development do
gem 'sqlite3', '1.3.5'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '3.2.4'
  gem 'coffee-rails', '3.2.2'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer', :platform => :ruby

  gem 'uglifier', '1.2.3'
end

gem 'jquery-rails', '2.0.0'

group :production do
    gem 'pg', '0.12.2'
end

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# To use Jbuilder templates for JSON
# gem 'jbuilder'

# Use unicorn as the app server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'ruby-debug19', :require => 'ruby-debug' 
```

当我尝试`bundle install`使用文件时，`bundle install --without production`按照说明使用，我收到此错误：

```
You need to specify gem names as Strings. Use 'gem "development"' instead. 
```

当我返回文件并更改`gem :development`为时，`gem "development"`我被告知：

```
Could not find gem 'development (>= 0) ruby' in the gems available on this machine. 
```

我是新手，当一组明确的指令似乎与另一组发生冲突并且两者都不起作用时，我真的不知道该怎么做，特别是因为我并不真正理解这些术语中的任何一个是什么意思。

非常感谢您的帮助，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-26T00:03:49.863

`:development`应该是一个组，而不是一个宝石。试试这个：

```
group :development do
  gem 'sqlite3', '1.3.5'
end 
```

这意味着开发组内的所有gem都应该加载到开发环境中。在这种情况下，您在生产或测试中运行时不会拥有 sqlite gem。

这同样适用于生产组。

[只有在为Asset Pipeline](http://guides.rubyonrails.org/asset_pipeline.html)编译资产时才会加载资产组。

# php - php简单登录脚本白页

> ID：10762591
> 
> 赞同：0
> 
> 时间：2012-05-26T00:01:40.773
> 
> 标签：php, mysql, sql

您好，我正在尝试将 PDO 植入我的登录脚本中，以使其免受 sql 注入的影响。但是我得到了一个白页，我认为这是因为我试图计算行数以查看用户是否真实.....

```
// Here we inculde the function page
include 'functions/functions.php';
// Here we connect to the db
$db = mysqlconnect();

$password = md5($_POST['mypassword']);
$statement = $db->prepare("SELECT * FROM users WHERE username = ? AND password = ?");
$statement->execute(array($_POST['myusername'], $password));

// Replace counting function based on database you are using.
 $count = $statement->rowCount();
// If result matched $myusername and $mypassword, table row must be 1 row

if($count == 1){
  // Register $myusername, $mypassword and redirect to file "login_success.php"

$_SESSION['username'] = $myusername ;

//Test if it is a shared client
if (!empty($_SERVER['HTTP_CLIENT_IP'])){
  $ip=$_SERVER['HTTP_CLIENT_IP'];
//Is it a proxy address
}elseif (!empty($_SERVER['HTTP_X_FORWARDED_FOR'])){
  $ip=$_SERVER['HTTP_X_FORWARDED_FOR'];
}else{
  $ip=$_SERVER['REMOTE_ADDR'];
}

$updateinfo=mysql_query("UPDATE `users` SET lastip ='$ip' WHERE `username` = '".$_SESSION['username']."'");
mysql_query("INSERT INTO user_log 
(username, ip) VALUES('".$_SESSION['username']."', '$ip' ) ") 
or die(mysql_error());  

header("Location: home.php");
} else {
  echo "Wrong Username or Password";
}

echo"<p> </p>"; 
```

我没有收到任何错误只是一个白页。

这也是我的功能页面，我包括

```
 function mysqlconnect(){
     global $db;
    $host = 'localhost';
    $port = 3306; // This is the default port for MySQL
    $database = '';
    $username = '';
    $password = '';

    // Construct the DSN, or "Data Source Name".  Really, it's just a fancy name
    // for a string that says what type of server we're connecting to, and how
    // to connect to it.  As long as the above is filled out, this line is all
    // you need :)
    $dsn = "mysql:host=$host;port=$port;dbname=$database";

    // Connect!
    $db = new PDO($dsn, $username, $password);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T02:51:19.137

您的代码中有几件事令人印象深刻。

如果您将整个脚本粘贴到此处，您将丢失`session_start()`. 我不知道你的内容是什么`home.php`，但如果它的内容生成取决于 $_SESSION['username'] 中的值，那么它永远不会发生，因为在标头重定向后它将为空。

查看有关[session_start()](http://php.net/manual/en/function.session-start.php)的手册。

此外，如前所述：

> 对于大多数数据库，PDOStatement::rowCount() 不返回受 SELECT 语句影响的行数。

以防万一想到提到这一点。过去我花了很多时间自己想知道这件事。

您可能想看一下有关[rowCount](http://php.net/manual/en/pdostatement.rowcount.php)的手册中的示例 #2 。

当然，正如@Paul 已经指出的那样，`mysql_query()`如果迁移到 PDO，您不应该再使用。

# mysql - 如何使用唯一列值作为另一个选择语句的输入

> ID：10762598
> 
> 赞同：0
> 
> 时间：2012-05-26T00:03:16.650
> 
> 标签：mysql, stored-procedures, query-optimization

我有一个表（MySQL），它有一个名为 binID 的列。此列中的值范围为 1 到 70。

我想要做的是选择该列的唯一值（应该是从 1 到 70 的数字），然后使用每个（我们称之为 theBinID）作为另一个 SELECT 语句的参数对它们进行迭代，例如：

```
SELECT * FROM MyTable WHERE binID = theBinID ORDER BY createdDate DESC LIMIT 10 
```

基本上，我希望为每个 binID 获取 10 个最近的行。

我不相信有一种方法可以用基本的 SQL 语句来做到这一点，**尽管我很乐意将其作为答案**，所以我编写了一个存储过程，它在 binID 的 SELECT DISTINCT 上创建一个游标，然后对其进行迭代并填充一个临时表。

我的问题是，这是为了优化，如果我获取 100K 行，我得到 1.7 秒的平均时间。执行我的存储过程以获取 700 行（70 个 bin 的 10 条记录）需要 1.4 秒。我意识到 0.3 秒可以被视为相当大的改进，但我希望在 100K 行中获得这个亚秒级。

有没有更好的办法？？

完整的存储过程是这样的：

```
BEGIN
DECLARE done INT DEFAULT FALSE;
DECLARE binID INT;
DECLARE cur1 CURSOR FOR SELECT DISTINCT heatmapBinID from MEStressTest ORDER BY heatmapBinID ASC;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;

DROP TEMPORARY TABLE IF EXISTS TempResults;

CREATE TEMPORARY TABLE TempResults (
    `recordID` text NOT NULL,
    `queryTerm` text NOT NULL,
    `recordCreated` double(11,0) NOT NULL,
    `recordByID` text NOT NULL,
    `recordByName` text NOT NULL,
    `recordText` text NOT NULL,
    `recordSource` text NOT NULL,
    `rerecordCount` int(11) NOT NULL DEFAULT '0',
    `timecodeOffset` int(11) NOT NULL DEFAULT '-1',
    `recordByImageURL` text NOT NULL,
    `canDelete` int(11) NOT NULL DEFAULT '1',
    `heatmapBinID` int(11) DEFAULT NULL,
    `timelineBinID` int(11) DEFAULT NULL,
    PRIMARY KEY (`recordID`(20))
);

OPEN cur1;

read_loop: LOOP
    FETCH cur1 INTO binID;

    IF done THEN
        LEAVE read_loop;
    END IF;

    INSERT INTO TempResults (recordID, queryTerm, recordCreated, recordByID, recordByName, recordText, recordSource, rerecordCount, timecodeOffset, recordByImageURL, canDelete, heatmapBinID, timelineBinID)
    SELECT * FROM MEStressTest WHERE heatmapBinID = binID ORDER BY recordCreated DESC LIMIT numRecordsPerBin;
END LOOP;

CLOSE cur1;

SELECT * FROM TempResults ORDER BY heatmapBinID ASC, recordCreated DESC; 
```

结尾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T02:51:06.840

尝试在 MySQL 中模拟 ROW_NUMBER OVER PARTITION：[http ://www.sqlfiddle.com/#!2/fd8b5/4](http://www.sqlfiddle.com/#!2/fd8b5/4)

鉴于此数据：

```
create table sentai(
  band varchar(50),
  member_name varchar(50),
  member_year int not null
);

insert into sentai(band, member_name, member_year) values
('BEATLES','JOHN',1960),
('BEATLES','PAUL',1961),
('BEATLES','GEORGE',1962),
('BEATLES','RINGO',1963),
('VOLTES V','STEVE',1970),
('VOLTES V','MARK',1971),
('VOLTES V','BIG BERT',1972),
('VOLTES V','LITTLE JOHN',1973),
('VOLTES V','JAMIE',1964),
('ERASERHEADS','ELY',1990),
('ERASERHEADS','RAYMUND',1991),
('ERASERHEADS','BUDDY',1992),
('ERASERHEADS','MARCUS',1993); 
```

对象，找到每个乐队的所有三个最近的成员。

首先，我们必须根据大多数年份在每个成员上放置一个 row_number（通过降序）

```
select *,

  @rn := @rn + 1 as rn
from (sentai s, (select @rn := 0) as vars)
order by s.band, s.member_year desc; 
```

输出：

```
|        BAND | MEMBER_NAME | MEMBER_YEAR | @RN := 0 | RN |
|-------------|-------------|-------------|----------|----|
|     BEATLES |       RINGO |        1963 |        0 |  1 |
|     BEATLES |      GEORGE |        1962 |        0 |  2 |
|     BEATLES |        PAUL |        1961 |        0 |  3 |
|     BEATLES |        JOHN |        1960 |        0 |  4 |
| ERASERHEADS |      MARCUS |        1993 |        0 |  5 |
| ERASERHEADS |       BUDDY |        1992 |        0 |  6 |
| ERASERHEADS |     RAYMUND |        1991 |        0 |  7 |
| ERASERHEADS |         ELY |        1990 |        0 |  8 |
|    VOLTES V | LITTLE JOHN |        1973 |        0 |  9 |
|    VOLTES V |    BIG BERT |        1972 |        0 | 10 |
|    VOLTES V |        MARK |        1971 |        0 | 11 |
|    VOLTES V |       STEVE |        1970 |        0 | 12 |
|    VOLTES V |       JAMIE |        1964 |        0 | 13 | 
```

然后，当成员在不同的频段时，我们重置行号：

```
select *,

  @rn := IF(@pg = s.band, @rn + 1, 1) as rn,
  @pg := s.band
from (sentai s, (select @pg := null, @rn := 0) as vars)
order by s.band, s.member_year desc; 
```

输出：

```
|        BAND | MEMBER_NAME | MEMBER_YEAR | @PG := NULL | @RN := 0 | RN | @PG := S.BAND |
|-------------|-------------|-------------|-------------|----------|----|---------------|
|     BEATLES |       RINGO |        1963 |      (null) |        0 |  1 |       BEATLES |
|     BEATLES |      GEORGE |        1962 |      (null) |        0 |  2 |       BEATLES |
|     BEATLES |        PAUL |        1961 |      (null) |        0 |  3 |       BEATLES |
|     BEATLES |        JOHN |        1960 |      (null) |        0 |  4 |       BEATLES |
| ERASERHEADS |      MARCUS |        1993 |      (null) |        0 |  1 |   ERASERHEADS |
| ERASERHEADS |       BUDDY |        1992 |      (null) |        0 |  2 |   ERASERHEADS |
| ERASERHEADS |     RAYMUND |        1991 |      (null) |        0 |  3 |   ERASERHEADS |
| ERASERHEADS |         ELY |        1990 |      (null) |        0 |  4 |   ERASERHEADS |
|    VOLTES V | LITTLE JOHN |        1973 |      (null) |        0 |  1 |      VOLTES V |
|    VOLTES V |    BIG BERT |        1972 |      (null) |        0 |  2 |      VOLTES V |
|    VOLTES V |        MARK |        1971 |      (null) |        0 |  3 |      VOLTES V |
|    VOLTES V |       STEVE |        1970 |      (null) |        0 |  4 |      VOLTES V |
|    VOLTES V |       JAMIE |        1964 |      (null) |        0 |  5 |      VOLTES V | 
```

然后我们只选择每个乐队最近的三个成员：

```
select x.band, x.member_name, x.member_year
from
(
  select *,
    @rn := IF(@pg = s.band, @rn + 1, 1) as rn,
    @pg := s.band
  from (sentai s, (select @pg := null, @rn := 0) as vars)
  order by s.band, s.member_year desc
) as x
where x.rn <= 3
order by x.band, x.member_year desc; 
```

输出：

```
|        BAND | MEMBER_NAME | MEMBER_YEAR |
|-------------|-------------|-------------|
|     BEATLES |       RINGO |        1963 |
|     BEATLES |      GEORGE |        1962 |
|     BEATLES |        PAUL |        1961 |
| ERASERHEADS |      MARCUS |        1993 |
| ERASERHEADS |       BUDDY |        1992 |
| ERASERHEADS |     RAYMUND |        1991 |
|    VOLTES V | LITTLE JOHN |        1973 |
|    VOLTES V |    BIG BERT |        1972 |
|    VOLTES V |        MARK |        1971 | 
```

虽然 MySQL 上还没有窗口函数（例如 ROW_NUMBER OVER PARTITION），但只需用变量模拟它。请让我们知道这是否比光标方法快

* * *

它在具有窗口功能的 RDBMS 上的样子：[http ://www.sqlfiddle.com/#!1/fd8b5/6](http://www.sqlfiddle.com/#!1/fd8b5/6)

```
with member_recentness as
(
  select row_number() over each_band as recent, *
  from sentai
  window each_band as (partition by band order by member_year desc)
)
select * 
from member_recentness
where recent <= 3; 
```

输出：

```
| RECENT |        BAND | MEMBER_NAME | MEMBER_YEAR |
|--------|-------------|-------------|-------------|
|      1 |     BEATLES |       RINGO |        1963 |
|      2 |     BEATLES |      GEORGE |        1962 |
|      3 |     BEATLES |        PAUL |        1961 |
|      1 | ERASERHEADS |      MARCUS |        1993 |
|      2 | ERASERHEADS |       BUDDY |        1992 |
|      3 | ERASERHEADS |     RAYMUND |        1991 |
|      1 |    VOLTES V | LITTLE JOHN |        1973 |
|      2 |    VOLTES V |    BIG BERT |        1972 |
|      3 |    VOLTES V |        MARK |        1971 | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T01:22:47.097

```
SELECT * FROM MyTable WHERE binID IN (SELECT DISTINCT(bin_id) FROM mysql_table) ORDER BY createdDate DESC LIMIT 10; 
```

这未经测试，别管语法。

添加索引以提高性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T02:02:43.560

如果您尝试在没有任何连接键的情况下内连接 2 个表，它将是 2 个表的笛卡尔积，即：

```
SELECT * 
FROM MyTable t 
    INNER JOIN (SELECT DISTINCT binId FROM MyTable) AS u 
WHERE 
    t.binID = theBinID 
ORDER BY t.createdDate DESC LIMIT 10 
```

你可以参考[这个](https://stackoverflow.com/questions/4481396/mysql-cartesian-product-between-two-select-statements)

# visual-studio - 如何将 Visual Studio SCC 插件与我的 CMAKE 生成的解决方案/项目集成

> ID：10762601
> 
> 赞同：3
> 
> 时间：2012-05-26T00:03:39.903
> 
> 标签：visual-studio, cmake, perforce

关于这个主题，我所能找到的只是工具包网站上的一个论坛帖子，说明我需要`SET_TARGET_PROPERTIES`在我设置`VS_SCCPROJECTNAME`,`VS_SCCLOCALPATH`和`VS_SCCPROVIDER`属性的 CMakeLists 文件中添加一个调用。我尝试了以下代码段，但插件仍然没有提示我打开解决方案，也没有自动签出我编辑的文件。非常感谢您的帮助！

```
IF (WIN32)
    SET_TARGET_PROPERTIES (${MY_PROJECT_NAME} PROPERTIES
        VS_SCCPROJECTNAME "Perforce Project"
        VS_SCCLOCALPATH ${THE_ROOT_DIRECTORY_OF_MY_PERFORCE_WORKSPACE_ON_MY_DRIVE}
        VS_SCCPROVIDER "MSSCCI:Perforce SCM"
    )
ENDIF (WIN32) 
```

作为旁注，我在资源管理器中的上下文菜单也没有在 perforce 菜单组下给我“签出”选项。也许这些问题是相关的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T00:10:24.203

Oops, missed the underscores in the VS_SCC values. It should have read

```
IF (WIN32)
    SET_TARGET_PROPERTIES (${MY_PROJECT_NAME} PROPERTIES
        VS_SCC_PROJECTNAME "Perforce Project"
        VS_SCC_LOCALPATH ${THE_ROOT_DIRECTORY_OF_MY_PERFORCE_WORKSPACE_ON_MY_DRIVE}
        VS_SCC_PROVIDER "MSSCCI:Perforce SCM"
    )
ENDIF (WIN32) 
```

I cleaned my cmake directory and regenerated and now it works

# c# - c# 静态类声明

> ID：10762604
> 
> 赞同：1
> 
> 时间：2012-05-26T00:04:11.443
> 
> 标签：c#, class, static, instantiation

嗨，下面代码的目的是返回一个包含相关数据集的静态类。你能推荐我如何做得更好吗？

```
public class People
{
    //want info to be setup in this class, so it can be accessed elsewhere
    public static readonly string[] ab = { "ALBERT", "EINSTEIN"};       
    public static readonly string[] dk = { "DONALD", "KNUTH" };

   //is this efficient or instantiated once per access? IF SO HOW CAN I DO THIS BETTER? 
    public static readonly Info AB = new Info(ab, 100); 
    public static readonly Info DK = new Info(dk, 80);

}

public class Info
{
    private string[] _name;
    private int _age;

    public string[] Name { get{ return _name}; }
    public int Age { get { return _age; } }

    public Info(string[] n, int a)
    {
        _name = n;
        _age = a;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T00:32:54.757

> 这是有效的还是每次访问都实例化一次？

如果您的意思是构建实例的时刻`Info`，它们是在第一次访问成员之前构建的。所以无论你调用多少次`People.AB`，对象都是一样的。

从 MSDN 关于[静态类和静态类成员](http://msdn.microsoft.com/en-us/library/79b3xss3%28v=vs.100%29.aspx)：

> 在第一次访问静态成员之前以及在调用静态构造函数（如果有的话）之前初始化静态成员。

如果你想让你的实例`Info`完全不可变（正如丹尼尔所说，`_name`一旦你获得对数组的引用，值就可以改变），你可以将类型`_name`及其属性访问器更改为：

```
private List<string> _name;

public IList<string> Name { get { return _name.AsReadOnly(); } } 
```

希望我已经了解您的需求！

# php - 在多个托管 XML 文件中搜索字符串

> ID：10762606
> 
> 赞同：0
> 
> 时间：2012-05-26T00:04:22.167
> 
> 标签：php, javascript, jquery, xml

我正在开发一个使用大量 XML 文件作为数据的网站（总共 150 个并且可能还在增长）。每个页面都是一个 XML 文件。

我正在寻找的是一种通过 XML 文件查找字符串的方法。我不确定这个 XML 搜索引擎使用什么编程语言。

我熟悉 PHP、JavaScript、JQuery。所以我更喜欢使用这些语言。

非常感谢！

**更新：**我正在寻找一种快速运行的解决方案。

理想情况下，该函数返回包含搜索字符串的标记名。例如，如果 XML 如下所示：

```
<article-1>This is a great story.</article-1> 
```

如果要搜索“故事”，它将返回“文章-1”。我不太确定如何使用正则表达式来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T00:09:31.070

PHP 可以做到这一点。这是一个例子：

```
foreach(glob("{foldera/*.xml,folderb/*.xml}",GLOB_BRACE) as $filename) {
   $xml = simplexml_load_file($filename);
   //use regular expressions to find your string
} 
```

您只需使用带有循环的[glob()](http://php.net/manual/en/function.glob.php)遍历服务器上的每个文件。`foreach`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T00:08:12.820

听起来像是一个可以用 grep 和正则表达式解决的问题。在不知道您要查找的字符串的情况下，无法准确地说出您应该做什么，但是阅读一些有关 grep 的文档应该可以让您走上正确的道路。

# css - 如何使标题图像响应？

> ID：10762610
> 
> 赞同：2
> 
> 时间：2012-05-25T22:53:25.037
> 
> 标签：css, responsive-design

我在我的网站上添加了一个标题图片：

```
#header_area {
    background: url('my_header_image.com');
    background-repeat:no-repeat;
    background-position: top center;
} 
```

我的网站是响应式的，但标题除外。

有没有办法让我的标题响应？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T23:05:28.090

当使背景图像响应时，您可以使用该`background-size`属性。在上述代码的情况下，只要您的`#header_area`元素具有隐式宽度（或具有媒体查询的显式宽度），您应该能够说：

```
#header_area {
    background: url('my_header_image.com');
    background-repeat:no-repeat;
    background-position: top center;
    background-size: 100%;
} 
```

# .net - How do I share a class library with an application in a service-like fashion?

> ID：10762613
> 
> 赞同：0
> 
> 时间：2012-05-26T00:05:10.280
> 
> 标签：.net, web-services

What we're wanting to do is use typical POCO objects over a service. Now, I know that services are really made to provide functionality ala carte, but really, the issue that we're trying to address here is achieving the same usability that you get with a class library (POCO functionality like attributes, constructors, and behaviors in a compiled library) along with the benefit of having a centralized, reusable assembly that is called "on the fly". That way, we can build the libraries, and re-deploy it to ONE location and all apps that reference it will be updated.

It would seem that WCF doesn't really support this, and I can understand why. In most cases, people tend to scoff condescendingly and ask "why would you do that?". Well, I've answered that here. So what I'm really asking is where should look into to achieve this sort of "central class library"? I don't feel like services are the answer, but I need to achieve a central class library that can be accessed like a service. This way, an update of that class library would transparently affect all applications that reference it vs. having to re-reference it in every app. Does this make sense? TIA

UPDATE: Just thought about it. Would it be stupid to just add the assembly to the application server's GAC?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T22:16:42.240

我最终做的是创建一个围绕 Web 服务的类库。所有业务逻辑都保留在类库中，而所有数据访问都通过服务完成。这隐藏了客户端编程中任何复杂的乒乓球，并使得一些非常简单和干净的页面。

在旁注中，事实证明在 WCF 服务中创建的对象仍然支持抽象，因此我能够稍微利用它。我为具有匹配类库对象的服务数据传输对象创建了一个命名约定。库对象具有与服务对象相同的属性名称，以及它们需要执行的任何其他内容（我将它们按区域分隔）。

所以我认为这是对服务的更正确使用，并且几乎解决了我的问题。相当多的额外工作，但现在我们有了一个更灵活的架构，它既松散耦合又高度内聚。

# php - Mysql数据库设计结构

> ID：10762618
> 
> 赞同：-2
> 
> 时间：2012-05-26T00:05:49.383
> 
> 标签：php, mysql, database

插入记录时哪个数据库设计更好？

```
**Option 1.**
uid|itemid| qty | price | amount
1  |13| 2  |  100    |200

**Option 2.**
uid| itemid| qty | price | amount
1  |13| 1 | 100 | 100
2  |13| 1 | 100 | 100 
```

在选项 2 中，然后通过 mysql 查询检索行并使用 id 计算...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T00:22:26.117

您似乎想保留订购的每件商品的原价。我要做的是使用选项 1，然后在表中创建另一列，其中包含一个字符串，该字符串标识订单中的每个项目。

例如，如果我在卖水果，香蕉可以`iZ`作为唯一键。苹果可以`6U`作为唯一键。当用户下订单时，这些唯一键将插入到您的新列中。因此，当您看到此列的数据时，`iZ6U`您就会知道用户订购了一个苹果和一个香蕉。

# floating-point - 使用 NEON 的矢量化浮点舍入

> ID：10762620
> 
> 赞同：0
> 
> 时间：2012-05-26T00:06:02.613
> 
> 标签：floating-point, arm, rounding, neon

我有一个 NEON 寄存器，里面填满了`float32`. 我想将它们四舍五入到最接近的整数，而不必传输回主 CPU。NEON 指令转换`float32`为`uint32`简单截断，因此例如`39.7`变为`39`，而不是`40`。我不太关心如何`0.5`处理——从零舍入或舍入到甚至两者都对我有用。

我可以看到实现舍入的最佳途径是

*   转换为`int32`（因此截断）
*   转换*回*_`float32`
*   将 1 添加到`int32`，转换回`float32`，并留出以防我们四舍五入
*   减去
*   比较`0.5`（不需要绝对值，因为我知道在我的情况下它们都是积极的）
*   根据比较结果选择 truncated 或 truncated + 1

这看起来丑陋、缓慢和复杂。

有没有更清洁、更快、更简单、更理智的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-26T01:12:20.227

添加 .5 并转换为整数。如果您想要浮点格式的结果，请转换回来。

由于您知道这些数字都是正数，因此另一种选择是加 0x1p23 并减去 0x1p23。加上 0x1p23 的结果至少是 0x1p23，所以浮点结果没有小于 1 的位，所以它肯定已经四舍五入为整数。然后减去 0x1p23 减去添加的值，只留下四舍五入的效果。

更新：如果输入在 [0x1p47, 0x1p48) 并且其低位为 1，则第二种方法将失败。那么 0x1p23 是输入的 ULP 的一半，所以加法会导致向上舍入（到偶数），而减法没有效果。我认为有一个修改可以解决这个问题，但我手头没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-16T10:00:00.533

我们知道，浮点数到整数轮次需要根据正数或负数加减 0.5。在 Neon 中， 1\. 我可以提取有符号的值；2\. 与0.5位或，则0.5有符号；3\. 添加有符号的 0.5 和原始值：

```
// 1\. extract sign of origin value
int32x4_t reinterpretInt = vreinterpretq_s32_f32(inputFloat);
int32x4_t signExtract = vdupq_n_s32(-2147483648);
int32x4_t signSignal = vandq_s32(reinterpretInt, signExtract);

// 2\. bit-or with 0.5 with origin value
float32x4_t roundValue = vdupq_n_f32(0.5);
float32x4_t plusValue = vreinterpretq_f32_s32(vorrq_s32(vreinterpretq_s32_f32(roundValue), signSignal));

// 3\. add signed 
return vaddq_f32(inputFloat, plusValue); 
```

# c# - get property name from generic list

> ID：10762622
> 
> 赞同：3
> 
> 时间：2012-05-26T00:06:27.840
> 
> 标签：c#

Environment: asp.net fx3.5

given

```
public class Product
{
    public int ProductId { get; set; }
    public string ProductName { get; set; }
    public decimal UnitPrice { get; set; }
} 
```

i have a `List<Product>` collection.

is there a way to get the property names because i want them to be a header row in my csv file that i'm constructing?

so the result i'm looking for is a `string = "ProductId,ProductName,UnitPrice"`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T00:11:06.667

```
var headers = this.GetType().GetProperties().Select(p => p.Name).Aggregate((p1, p2) => p1 + "," + p2); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T00:16:14.303

您可以使用[`TypeDescriptor`](http://msdn.microsoft.com/en-us/library/system.componentmodel.typedescriptor.aspx)该类（比普通反射更有效）：

```
string.Join(",", TypeDescriptor.GetProperties(instance).Select(p => p.Name)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T00:11:52.570

```
String.Join(",", typeof(Product).GetProperties().Select(p => p.Name)) 
```

如果您不想使用 Linq，您可以遍历 GetProperties 返回的 PropertyInfo 数组并将名称连接到一个字符串。

# macos - 目录上的 NodeJS fs.watch 仅在由编辑器更改时触发，而不是 shell 或 fs 模块

> ID：10762630
> 
> 赞同：8
> 
> 时间：2012-05-26T00:07:23.800
> 
> 标签：macos, node.js, fs

运行下面的代码时，只有当我使用我的 ide、TextEditor.app 或 vim 手动编辑和保存 tmp.txt 时才会触发手表。

它不是通过写入流或手动 shell 输出重定向（键入 echo "test" > /path/to/tmp.txt"）的方法。

虽然如果我看文件本身，而不是它的目录名，那么它就可以工作。

```
var fs, Path, file, watchPath, w;

fs = require('fs' );
Path = require('path');
file = __dirname + '/tmp.txt';
watchPath = Path.dirname(file); // changing this to just file makes it trigger

w = fs.watch ( watchPath, function (e,f) {
    console.log("will not get here by itself");
    w.close();
});
fs.writeFileSync(file,"test","utf-8");

fs.createWriteStream(file, {
    flags:'w',
    mode: 0777
} )
.end('the_date="'+new Date+'";' ); // another method fails as well

setTimeout (function () {
    fs.writeFileSync(file,"test","utf-8");
},500); // as does this one
// child_process exec and spawn fail the same way with or without timeout 
```

所以问题是：为什么？以及如何从节点脚本以编程方式触发此事件？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-26T00:39:24.377

问题是，您要求查看*目录*而不是*文件*。

*修改*文件时目录不会更新，例如通过 shell 重定向；在这种情况下，文件被打开、修改和关闭。目录没有改变——只有文件是。

当您使用文本编辑器修改文件时，通常的幕后系统调用集如下所示：

```
fd = open("foo.new")
write(fd, new foo contents)
unlink("foo")
rename("foo.new", "foo") 
```

这样，该`foo`文件要么完全是旧文件，要么完全是新文件，并且不可能有包含新内容的“部分文件”。重命名操作*确实会*修改目录，从而触发目录监视。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-26T00:39:50.820

它不会触发，因为对文件内容的更改不是对目录的更改。

在幕后，至少从 0.6 开始，Mac 上的 fs.watch 使用 kqueue，它是 kqueue 文件系统通知的一个非常薄的包装器。所以，如果你真的想了解细节，你必须了解 kqueue，和 inode 之类的东西。

但是如果你想要一个简短的“对孩子撒谎”的解释：用户认为的“文件”实际上是两个独立的东西——实际文件和指向实际文件的目录条目。这就是允许您拥有诸如硬链接之类的东西，以及即使在您删除它们之后仍然可以读取和写入的文件等等。

通常，当您写入现有文件时，这不会对目录条目进行任何更改，因此查看目录的任何人都不会看到任何更改。这就是为什么 echo >tmp.txt 不会触发您的原因。

但是，例如，如果您编写一个新的临时文件，然后将其移到旧文件上，这确实会更改目录条目（使其成为指向新文件而不是旧文件的指针），因此您会收到通知。这就是 TextEditor.app 确实会触发您的原因。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-22T12:48:59.820

尽管上述答案似乎合理，但它们并不完全准确。能够监听目录的文件更改实际上是一个非常有用的功能，而不仅仅是“重命名”。我认为此功能至少在 Windows 中按预期工作，并且在节点 0.9.2 中也适用于 mac，因为它们更改为支持该功能的 FSEvents API：

[版本 0.9.2（不稳定）](http://blog.nodejs.org/2012/09/17/node-v0-9-2-unstable/)

# javascript - Redirect from Js file depending on document location

> ID：10762632
> 
> 赞同：0
> 
> 时间：2012-05-26T00:07:28.497
> 
> 标签：javascript, html

I am using code below for for my js file for redirecting.. but i want my redirection based on top location. for example if someone visit xyz.com so it redirect to mydomain.com so what code i needed to add? i think it could be like indexOf('xyz.com')

```
loadScript("http://j.maxmind.com/app/geoip.js", function() {
    var country = geoip_country_code();

    if (country === "US") {
        window.location = "http://mydomain.com/";
    }
});

function loadScript(url, callback) {
    // adding the script tag to the head as suggested before
   var head = document.getElementsByTagName('head')[0];
   var script = document.createElement('script');
   script.type = 'text/javascript';
   script.src = url;

   // then bind the event to the callback function 
   // there are several events for cross browser compatibility
   script.onreadystatechange = callback;
   script.onload = callback;

   // fire the loading
   head.appendChild(script);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T01:03:18.360

I am not totally sure I understand your question,

[window.location](https://developer.mozilla.org/en/DOM/window.location) is an object which refers to the currently displayed web page at all times. As you already know you can change window.location and cause a page change in the browser.

window.location also has several properties which help in analyzing its contents, see the referenced link for more details. window.location.host is the one you need I think.

So if I understand your question correctly, you could replace

```
var country = geoip_country_code();

if (country === "US") {
    window.location = "http://mydomain.com/";
} 
```

with

```
if (window.location.host === 'xyz.com') {
    window.location = "http://mydomain.com/";
} 
```

# iphone - Can't Launch Xcode App Without Code Signing on iPad, Can on iPhone

> ID：10762633
> 
> 赞同：0
> 
> 时间：2012-05-26T00:07:39.883
> 
> 标签：iphone, xcode, ipad

I am trying to deploy an Xcode app to my iPad without code signing. To do so, I have edit the SDKSettings.plist file, changed my project settings to do not run, and installed AppSync. This is the error I receive:

```
Error launching remote program: failed to get the task for process 1019. 
```

This is the error in the debug screen:

```
Error launching remote program: failed to get the task for process 1396.The program being debugged is not being run. 
```

The number keeps changing. On my iPhone, once I hit "ok" to dismiss the error on my computer, I can launch the app from the springboard and use it perfectly. However, on my iPad, this is not the case. It just crashes if I attempt to open it.

Has anyone ever had this program, or know how to solve it?

Also, my iPhone is on 5.0.1, and my iPad is on 5.1.1\. The app works fine in the simulator, though.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T03:37:16.057

您必须拥有有效的配置文件，这需要注册 iOS 开发者计划。如果没有配置文件，就无法在 iOS 设备上运行应用程序。欲了解更多信息：[https ://developer.apple.com/programs/ios/](https://developer.apple.com/programs/ios/)

# c# - C# SQL 如果查询返回任何行数

> ID：10762639
> 
> 赞同：4
> 
> 时间：2012-05-26T00:08:40.417
> 
> 标签：c#, asp.net, ado.net

使用查询查找数据是否返回的最简单和最有效的方法是什么？我正在使用`DataTable`like`sqlAdapter.Fill(_table1)`然后`_table1.Rows.Count`查看数据表是否有任何行。C# 中是否有任何类和函数只给我是否有任何行。我不需要行的数据。只是计数是我需要的。我正在针对非常大的数据集运行此查询，因此我不想用所有行信息填充数据表。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-26T00:15:07.890

```
string myScalarQuery = "select count(*) from TableName";

SqlCommand myCommand = new SqlCommand(myScalarQuery, myConnection);
myCommand.Connection.Open();
int count = (int) myCommand.ExecuteScalar();
myConnection.Close(); 
```

根据下面的评论可能优化查询：Select Top 1 * FROM TableName

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-26T00:32:39.013

最便宜的方法是使用 SqlDataReader 的**HasRows**属性
**UPDATE**：当然，最有效的 SELECT 查询将类似于“Select Top 1 1 FROM TableName”，它甚至不需要提取任何列数据。

```
using (SqlConnection conn = new SqlConnection(connectionString))
{
    conn.Open();
    using (SqlDataReader rdr = cmd.ExecuteReader())
    {
        if (rdr.HasRows)
            ...
    }
} 
```

# android - How to ensure that a service can only be started manually?

> ID：10762640
> 
> 赞同：2
> 
> 时间：2012-05-26T00:09:04.500
> 
> 标签：android, android-service, android-2.3-gingerbread

I created a service that can be started via the `startService()` method, but it also be bound by the applications. I wish that it can be started only via the `startService()` method, or in other words, applications should be able to bind to it only when the service is already started.

1.  The service should be started manually and not when an application binds to it.
2.  If the service is running, applications can bind to it.
3.  If the service is not running, when an application tries to bind to it, the service should not start.

However, the default behavior is quite different: in fact, Android starts the service automatically when an application wants to bind to it. I would like to know if is possible to modify this behavior to achieve the above requirement.

If this is not possible, the only alternative would be to stop the service if it has been initiated as a result of a `bindService()`. Here are the changes to my service class in order to use this way...

```
// It says if the service was started manually.
private boolean mCorrectlyStarted = false;

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
   Log.i(LOG_TAG, "onStartCommand()");
   mCorrectlyStarted = true;   // the service is started manually: ok!
   return START_STICKY;
}

@Override
public IBinder onBind(Intent intent) {
   Log.i(LOG_TAG, String.format("onBind(intent: %s)", intent));

   if (mCorrectlyStarted) {
       return binder;
   }
   else {
       stopSelf(); // although I make this call, the service is not stopped
       return null;
   }
} 
```

Why do my changes do not have the desired effect? It might be good that the service starts when an application invokes the `bindService()` method, but after verifying that it was not started manually, it should stop itself.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T05:33:08.000

诸如 Activity 之类的东西被调用的事实`bindService()`意味着某人仍然绑定到该服务。调用`stopSelf()`不会破坏服务，因为从技术上讲，服务仍受活动约束。

`unbindService`一旦最终被 Activity 调用，它将被销毁。绑定和启动服务是正交的。

我不确定你想用这个设计实现什么，也许提供更多信息，说明为什么你希望服务在绑定之前启动？

# php - Php 64bit integer hash

> ID：10762646
> 
> 赞同：2
> 
> 时间：2012-05-26T00:09:41.403
> 
> 标签：php

Is there a one way hashing algorithm, that can give an integer hash of 64 bits? Tried converting md5 hex into integer(storing large int using gmp library in PHP), but I'll lose precision. Same with SHA1.

Is there an existing algorithm (in php or otherwise), that will give a int or a hex which I can convert to an integer(max 64 bits).

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T00:13:57.180

有[很多算法](http://php.net/manual/en/function.hash-algos.php)，要将它们转换为整数，您可以使用[`gmp`](http://php.net/manual/en/book.gmp.php)扩展：

```
$base16 = hash('md5', 'hello world');
$base10 = gmp_strval(gmp_init(strtoupper($base16), 16), 10); 
```

`$base16`哈希函数返回的十六进制摘要在哪里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T00:13:48.897

您可以`print_r(hash_algos());`查看所有可用 PHP 哈希算法的列表，然后选择适合您需求的算法：

```
Array
(
    [0] => md2
    [1] => md4
    [2] => md5
    [3] => sha1
    [4] => sha224
    [5] => sha256
    [6] => sha384
    [7] => sha512
    [8] => ripemd128
    [9] => ripemd160
    [10] => ripemd256
    [11] => ripemd320
    [12] => whirlpool
    [13] => tiger128,3
    [14] => tiger160,3
    [15] => tiger192,3
    [16] => tiger128,4
    [17] => tiger160,4
    [18] => tiger192,4
    [19] => snefru
    [20] => snefru256
    [21] => gost
    [22] => adler32
    [23] => crc32
    [24] => crc32b
    [25] => salsa10
    [26] => salsa20
    [27] => haval128,3
    [28] => haval160,3
    [29] => haval192,3
    [30] => haval224,3
    [31] => haval256,3
    [32] => haval128,4
    [33] => haval160,4
    [34] => haval192,4
    [35] => haval224,4
    [36] => haval256,4
    [37] => haval128,5
    [38] => haval160,5
    [39] => haval192,5
    [40] => haval224,5
    [41] => haval256,5
) 
```

# ios - iOSK：ABRecordRef 是什么样的数据类型？

> ID：10762647
> 
> 赞同：0
> 
> 时间：2012-05-26T00:09:45.593
> 
> 标签：ios, database, ios5, sqlite

我想将 ABRecordRef 保存到 SQLite3 DB。我对 SQLite 字段使用哪种类型的数据类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T02:27:23.487

您必须提取地址的各个组成部分并将它们保存为文本字符串。

**更新：**

如果您只想要 ABRecord 的标识符，请检索`ABRecordID`via`ABRecordGetRecordID`并将其保存为 SQLite 中的数值。

# oracle - JBOSS error Throwable while attempting to get a new connection: null Io exception: Connection reset

> ID：10762652
> 
> 赞同：1
> 
> 时间：2012-05-26T00:10:21.400
> 
> 标签：oracle, jboss5.x, java-6

After one week that jboss is working, its crash down, sending the next exception: Software jboss5.0 jdk1.6 ojdbc14.jar

```
 WARN [JBossManagedConnectionPool] Throwable while attempting to get a new connection: null
    org.jboss.resource.JBossResourceException: Could not create connection; - nested throwable: (java.sql.SQLException: Io exception: Connection reset)
    at org.jboss.resource.adapter.jdbc.local.LocalManagedConnectionFactory.getLocalManagedConnection(LocalManagedConnectionFactory.java:225)
    at org.jboss.resource.adapter.jdbc.local.LocalManagedConnectionFactory.createManagedConnection(LocalManagedConnectionFactory.java:195)
    at org.jboss.resource.connectionmanager.InternalManagedConnectionPool.createConnectionEventListener(InternalManagedConnectionPool.java:633)
    at org.jboss.resource.connectionmanager.InternalManagedConnectionPool.getConnection(InternalManagedConnectionPool.java:267)
    at org.jboss.resource.connectionmanager.JBossManagedConnectionPool$BasePool.getConnection(JBossManagedConnectionPool.java:622)
    at org.jboss.resource.connectionmanager.BaseConnectionManager2.getManagedConnection(BaseConnectionManager2.java:404)
    at org.jboss.resource.connectionmanager.TxConnectionManager.getManagedConnection(TxConnectionManager.java:381)
    at org.jboss.resource.connectionmanager.BaseConnectionManager2.allocateConnection(BaseConnectionManager2.java:496)
    at org.jboss.resource.connectionmanager.BaseConnectionManager2$ConnectionManagerProxy.allocateConnection(BaseConnectionManager2.java:941)
    at org.jboss.resource.adapter.jdbc
.WrapperDataSource.getConnection(WrapperDataSource.java:89)
    at com.genexus.db.driver.GXConnection.connectJDBCDataSource(Unknown Source)
........   
    Caused by: java.sql.SQLException: Io exception: Connection reset
    at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)
    at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:146)
    at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:255)
    at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:387)
    at oracle.jdbc.driver.PhysicalConnection.<init>(PhysicalConnection.java:420)
    at oracle.jdbc.driver.T4CConnection.<init>(T4CConnection.java:165)
    at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:35)
    at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:801)
    at org.jboss.resource.adapter.jdbc.local.LocalManagedConnectionFactory.getLocalManagedConnection(LocalManagedConnectionFactory.java:207)
    ... 58 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T15:39:24.013

当前运行 SAS 9.3 和 Oracle 11.2.0.2，得到与 NEFTALY 相同的错误。在此之前，由于 Red Hat Linux 6.3 中的进程/线程数限制而出现错误 - 内存不足。通过将限制从 40000 增加到 90000（！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-14T07:32:35.897

错误的 IP 地址可能会发生此异常。所以检查DATABASE的绑定IP地址和连接属性。

```
<local-tx-datasource>
    <jndi-name>JNDI_NAME</jndi-name>
    <connection-url>jdbc:mysql://localhost:3306/DATABASE_NAME</connection-url>
    <driver-class>com.mysql.jdbc.Driver</driver-class>
    <user-name>root</user-name>
    <password>root</password>
    <min-pool-size>1</min-pool-size>
    <max-pool-size>10</max-pool-size>
    <idle-timeout-minutes>1</idle-timeout-minutes>
        <metadata>
         <type-mapping>mySQL</type-mapping>
      </metadata>
  </local-tx-datasource> 
```

# jquery - 无限滚动手动触发

> ID：10762656
> 
> 赞同：15
> 
> 时间：2012-05-26T00:10:55.483
> 
> 标签：jquery, wordpress, triggers, infinite-scroll

只是似乎不起作用...... :-( 已经看到更多关于它的投诉，但我找不到答案。

**问题：** 无限滚动有效，但手动触发器无效。当我单击链接时，没有任何反应。萤火虫给

[无限滚动](http://www.infinite-scroll.com/)

**我的代码：**

```
 <?php echo ('<ul id="infinite">'); ?>
<?php 
$wp_query = new WP_Query();
$wp_query->query('paged='.$paged.'&cat=5&showposts=3&meta_key=video_video&orderby=meta_value&order=ASC'  . $post->ID);
while ($wp_query->have_posts()) : $wp_query->the_post(); ?>
<?php if ( get_post_meta($post->ID, 'video_video', true) ) : ?>
    <li class="video"><?php $home = array("h" => 290, "w" => 380, "zc" => 1, "q" =>100);
            //echo get('video_video');
            echo ('With: ');
            echo get('participant_first_name');
            echo ('&nbsp;');
            echo get('participant_last_name');
            echo ('</li>');?>

<?php endif;?>

<?php endwhile;?>

<?php if (get_post_meta($post->ID, 'video_video', true) ) { ?>
    <?php if ($wp_query->max_num_pages > 1) : ?>
        <nav id="nav-below" >
        <div id="next" >
        <?php next_posts_link( __( 'Scroll down for more', 'intowntheme' ) ); ?></div>
        </nav>
    <?php endif; //end nav ?>
<?php } else {  ?>
<p>There are no interviews at the moment </p>
<?php }   ?>     
</ul> 
```

**还有我的脚本：**

```
jQuery('ul#infinite').infinitescroll({ 
    navSelector  : "#next",  // selector for the paged navigation (it will be hidden)
    nextSelector : "#next a",   // selector for the NEXT link (to page 2)
    itemSelector : "ul#infinite li",  // selector for all items you'll retrieve
    errorCallback: function() { 
          // fade out the error message after 2 seconds
          $('#infscr-loading').animate({opacity: 0.8},2000).fadeOut('normal');   
        },   
    loading         : {
         msgText: "<em>Loading the next year of Grantees...</em>",
        finishedMsg: "<em>You've reached the end of the Interviews.</em>"
    },
  });

  //kill scroll binding
    jQuery(window).unbind('.infscr');
    //setTimeout("jQuery('#next').slideDown();", 1000);
     //hook up the manual click guy.

    jQuery('#next a').click(function(){
        jQuery('#next a').infinitescroll('retrieve.infscr');
     return false;
    }); 
```

**也试过**

```
jQuery(document).trigger('retrieve.infscr'); 
```

**代替**

```
jQuery('#next a').infinitescroll('retrieve.infscr'); 
```

**但没有运气。**

Firebug 然后说*`trigger(retrieve.infscr) called incorrectly`*

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-05-26T00:45:31.753

Pfoe，找到了……好的文档万岁（不适用于此插件！）

**这：**

```
 jQuery('#next a').click(function(){
    jQuery('#next a').infinitescroll('retrieve.infscr');
 return false;
}); 
```

**应该：**

```
jQuery('#next a').click(function(){
    jQuery('ul#infinite').infinitescroll('retrieve');
 return false;
}); 
```

最大的问题是不应该存在的.infscr ..希望它对其他人有帮助..

**类似文档的解决方案：**

```
jQuery("#clickable_element").click(function(){
    jQuery('#main_content_container').infinitescroll('retrieve');
        return false;
}); 
```

**注意：**
如果您使用砖石或同位素工作， 您可能必须添加[手动触发行为](https://github.com/paulirish/infinite-scroll/blob/master/behaviors/manual-trigger.js)才能使其正常工作。只需在infinitescroll 之后包含并在调用插件时`manual-trigger.js`通过传递来传递行为。`behavior: 'twitter'`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T14:42:08.183

我进行了以下调整以确保在第一次单击后显示导航链接：

```
jQuery("#clickable_element").click(function(){
    jQuery('#main_content_container').infinitescroll('retrieve');
    jQuery('#pagination').show();
    return false;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T00:16:45.497

也许... $('#next a').click(); ?

# android - xml隐藏视图

> ID：10762660
> 
> 赞同：0
> 
> 时间：2012-05-26T00:11:34.627
> 
> 标签：android, xml

使用下面的 xml，我试图在播放音频时显示背景图像，问题是我看不到背景图像，它被播放器的黑屏覆盖...谢谢！

编辑

```
 <?xml version="1.0" encoding="UTF-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/containerView"
           android:background="@android:color/transparent"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">

     <FrameLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
         android:background="#90ffffff" >

    <VideoView 
        android:id="@+id/videoView"
        android:layout_height="wrap_content"
        android:layout_width="wrap_content"
     >
    </VideoView>

    </FrameLayout>

 </RelativeLayout> 
```

# cakephp - CakePHP：处理资产缩小/合并的最佳方法？

> ID：10762663
> 
> 赞同：2
> 
> 时间：2012-05-26T00:12:00.277
> 
> 标签：cakephp, minify, assets

我知道缩小资产是件好事，因为这样做可以减少文件大小，从而减少页面加载所需的时间。我也知道合并资产是件好事，因为这样做可以减少 HTTP 请求的数量，这又一次减少了页面加载所需的时间。这很重要，因为*仍然*有人在拨号，而移动设备通常没有快速连接。

我正在努力解决的问题是如何轻松地将资产缩小并合并到我的工作流程中。我使用 CakePHP 进行本地开发，并使用 Git 进行版本控制。当需要上线时，我会通过 ssh 进入托管实时站点的服务器并合并到最新的提交中。

以下是我将如何推出自己的解决方案（仅考虑缩小且**未经测试**！）：

1.) 我的开发环境的“app/Config/core.php”文件将始终将其“调试”级别设置为*大于*0 的值，而生产环境的将始终*为*0。

2.) 在文件系统上，所有 CSS 和 JavaScript 都将存储在外部文件中，如下所示：

*   应用程序/webroot/css/used-site-wide.css
*   应用程序/webroot/css/used-on-a-few-pages.css
*   app/webroot/css/used-on-one-page.css
*   应用程序/webroot/js/used-site-wide.js
*   应用程序/webroot/js/used-on-a-few-pages.js
*   app/webroot/js/used-on-one-page.js

3.）而不是`echo $this->Html->script(array('used-on-a-few-pages', 'used-on-one-page'), array('inline' => false));`在视图文件中使用，我会使用这个：

```
Configure::write('external_js', array('used-on-a-few-pages'));
Configure::write('inline_js', array('used-on-one-page')); 
```

4.）而不是`echo $this->fetch('script');`在布局文件中使用，我会使用这个：

```
if (Configure::read('external_js') !== null) {
    $external_js = Configure::read('external_js');

    if (Configure::read('debug') == 0) {
        foreach ($external_js as &$external_js_filename) {
            $external_js_filename .= '-min';
        }
    }

    echo $this->Html->script($external_js);
}

if (Configure::read('inline_js') !== null) {
    $inline_js = Configure::read('inline_js');

    if (Configure::read('debug') == 0) {
        foreach ($inline_js as &$inline_js_filename) {
            $inline_js_filename .= '-min';
        }
    }

    echo "\n<script type=\"text/javascript\">\n\t/* <![CDATA[ */";

    foreach ($inline_js as $inline_js_filename) {
        echo file_get_contents(JS . Configure::read('inline_js') . '.js');
    }

    echo "\n\t/* ]]> */\n</script>";
} 
```

5.) 最后，我会设置 Git 以在提交时创建缩小资产。

使用此设置，我将使用开发中的未缩小资产和生产中的缩小资产。问题是，如果我不需要，我不想重新发明轮子。我认为，只有在解决一个既重要又不常见的问题时，才应该重新发明轮子。

大家都是怎么处理的？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-24T01:17:14.617

如果您想要比 Mark Story 的 AssetCompress 插件更简单的东西，请查看： [https ://github.com/joshuapaling/CakePHP-Combinator-Plugin](https://github.com/joshuapaling/CakePHP-Combinator-Plugin)

它将合并和缩小 JS 和 CSS 文件，并且您可以轻松地使其仅在调试模式为 0 时合并/缩小（在 GitHub 上的 .markdown 中有一个示例）。它使用包含的 JS/CSS 文件的修改日期来决定何时需要制作新的缓存文件。

它不像 Mark Story 的插件那样功能齐全，但它很简单，可以完成工作，并且只需要 10 或 15 分钟即可完成设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-28T15:55:18.727

我最近自己偶然发现了这种情况，并且我尝试了（现已弃用）Combinator 插件，它使用不太可靠的 jsmin。因此，我尝试了 Mark Story 的插件，该插件非常复杂，它甚至不会在文件更改时自动进行构建，每次您希望创建组合和缩小的文件时都必须做一些蛋糕烘焙。

因此，我编写了自己的简单助手，您可以在这里查看：[https](https://github.com/Highstrike/cakephp-compressor) ://github.com/Highstrike/cakephp-compressor 。一切都在自述文件中进行了解释，并且非常易于使用，利用 google 闭包进行 js 缩小。它还处理 HTML 缩小。

它甚至比 maurymmarques 的解决方案更容易，因为它只是一个帮助文件，不需要控制器或配置。

我希望它会帮助某人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-05T17:59:59.743

你也可以查看这个插件[https://github.com/maurymmarques/minify-cakephp](https://github.com/maurymmarques/minify-cakephp) 它很容易安装和配置。

# regex - 用正则表达式转换标签

> ID：10762665
> 
> 赞同：0
> 
> 时间：2012-05-26T00:12:06.157
> 
> 标签：regex, preg-replace

我想转换 youtube 标签...我现有的标签如下所示：

```
[video=youtube;puineN1UMto]http://www.youtube.com/watch?v=puineN1UMto&amp;feature=related[/video] 
```

我希望他们转换为：

```
[media=youtube]puineN1UMto[media] 
```

我怎样才能做到这一点？请指导。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T00:34:23.513

像这样的东西应该工作：

```
Search: %\[video=youtube;([a-zA-Z0-9]+)\].*\[\/video\]%
Replace: [media=youtube]\1[/media] 
```

# hook - SDT 内核模式挂钩

> ID：10762668
> 
> 赞同：0
> 
> 时间：2012-05-26T00:13:19.960
> 
> 标签：hook, driver, loadlibrary, kernel-mode

我正在做一个实验以成功地在全球范围内挂钩 API 调用，并且我在某处阅读了有关 SDT（服务描述符表）和内核模式驱动程序的信息。

这种钩子是否适用于驻留在 user32.dll 之类的调用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T03:35:04.490

这将挂钩所有需要进入内核模式才能运行的东西（I/O、文件系统、进程/线程、内核对象）。

虽然它们非常不稳定，**不**应该使用。您只能在 x86 系统版本上进行 SDT 挂钩，因为在 x64 上，ntoskrnl 不会导出 KeServiceDescriptorTable 符号，并且[PatchGuard](http://en.wikipedia.org/wiki/Kernel_Patch_Protection)将在错误检查 BSOD 中最终确定您的系统。

有很多方法可以绕过 KPP，但我不建议您继续这样做。

# ruby-on-rails - 在 has_many 视图表中显示名称而不是 ID

> ID：10762669
> 
> 赞同：3
> 
> 时间：2012-05-26T00:13:32.180
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我尝试了其他几个类似的帖子，但仍然出现错误。

在 Posts 模型中，我有一个 category_id 字段。我有以下型号：

```
#Posts model
belongs_to :categories  

#Category model
has_many :posts 
```

在 Posts 索引控制器中，我有：

```
@categories = @posts.Category.find(:all, :order => 'categoryname') 
```

在视图中我有：

```
<% @posts.each do |post| %>
<tr>
<td><%= post.category_id %></td>
<td><%= @categories.categoryname %></td>

<td><%= link_to 'View', post %></td>
<td><%= link_to 'Edit', edit_post_path(post) %></td>
</tr>
<% end %> 
```

在第二列中，我试图显示 Category 表中的类别名称（“categoryname”），而不是帖子表中的 category_id。我收到一个错误：

#ActiveRecord::Relation:0x3e1a9b0> 的未定义方法“类别”

我也试过：

```
<td><%= post.categories.categoryname %></td> 
```

但得到同样的错误。

也：

```
<td><%= post.category.categoryname %></td> 
```

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-26T00:27:16.083

在你的模型中

```
belongs_to :category 
```

在你看来

```
<td><%= post.category.categoryname %></td> 
```

您可以摆脱`@categories =`控制器中的线路

此外，categoryname 可能不是您的 Category 模型的最佳属性名称。为什么不直接命名呢`name`。`post.category.name`看起来好多了`post.category.categoryname`，你不觉得吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-26T00:27:52.883

好的，有几件事

```
belongs_to :categories 
```

belongs_to 是一个奇异的关系。你应该把

```
belongs_to :category 
```

在这种情况下，您需要 posts 表中的 category_id。你会得到类别

```
@post.category.categoryname 
```

除非一个帖子可以有很多类别，在这种情况下你会想要

```
#Post
has_and_belongs_to_many :categories

#Category
has_and_belongs_to_many :posts 
```

在这种情况下，您需要一个`categories_posts`带有两个字段的连接表`category_id`，`post_id`您可以通过调用

```
@post.categories.each do |cat|
  cat.categoryname
end 
```

您的代码还有其他一些问题，例如

```
@categories = @posts.Category.find(:all, :order => 'categoryname') 
```

类别是一个模型，而不是您的命名关系，这可能就是您在应用程序中遇到异常的原因。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-30T09:09:49.880

您将收到以下错误

> > 未定义方法 `categoryname' for nil:NilClass on the line: <%= post.category.categoryname %>

如果您的表中有没有指定类别的记录。

换句话说，确保您的所有记录都有一个与之关联的类别

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-02T07:46:01.633

我注意到控制器中的 @category 以小写字母 c 开头，但在您看来，它以大写字母开头！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-23T14:35:31.513

在您的情况下，如果您有可能在帖子表中有一个空的 category_id *（正如您在评论中提到的那样）*，您可以添加

```
if post.category_id? 
```

所以你的单元格看起来像这样：

```
<td><%= post.category.categoryname if post.category_id? %></td> 
```

如果 post.category_id 为 null 它只会显示一个空单元格。

# java - 超链接到数据表中的第一列？

> ID：10762671
> 
> 赞同：1
> 
> 时间：2012-05-26T00:13:45.963
> 
> 标签：java, jsp, hyperlink

下面是单选按钮的代码，我想将第一列作为超链接而不是单选按钮并将其传递到下一个 jsp 页面。并且还对放置在 PICHART 中的数据表值有任何想法。

你能帮帮我吗？

```
 "aoColumnDefs" : [
      {"fnRender" : function(oObj){  return '<div align="center">
      <input name="selectedAcccountId" type="radio" property = "selectedAcccountId"  
             value="'+ oObj.aData[0]+'">  
      </div>';},
 "aTargets" : [0]
  }], 
```

# php - 安全地存储密码以供 PHP 使用——本地

> ID：10762675
> 
> 赞同：2
> 
> 时间：2012-05-26T00:14:12.367
> 
> 标签：php, security, local

我有一个仅在本地计算机上存储和运行的 PHP 脚本——它用于访问远程服务器。

有没有办法安全地存储脚本使用的密码？我不认为 PHP 可以访问 Keychain 或安全磁盘映像，所以我想知道是否还有其他方法？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T01:13:02.397

如果机器或 PHP 代码遭到破坏，攻击者将可以访问 PHP 源代码，并且可以自由地重新创建您愿意采取的任何复杂步骤。只需将您的密码保存在文档根目录之外的文件夹中，并确保您的脚本不易受到代码注入的影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T00:46:39.990

为了进行加密/解密，您可以使用此处提供的答案：
[使用 PHP 加密和解密密码的最佳方式？](https://stackoverflow.com/questions/1289061/best-way-to-use-php-to-encrypt-and-decrypt)

注意：如果您使用此方法，您本地计算机上的其他人仍然可以使用您自己的脚本来解密密码，但它确实提供了一些额外的安全性。

# css - 车身背景问题

> ID：10762676
> 
> 赞同：0
> 
> 时间：2012-05-26T00:14:13.067
> 
> 标签：css, wordpress, background

我的网站位于[http://filmblurb.org](http://filmblurb.org)。如您所见，我使用`min-height`标签做了一个 CSS 技巧，以使页面容器在窗口缩小时无限垂直滚动。问题是当您第一次加载网站时，背景中的灰色（来自`body`标签）与页面容器中的白色背景重叠。任何人都知道它为什么这样做，以及我如何才能尝试修复它，以便灰色始终留在背景中？我尝试了一切来解决这个问题，但我无法找出问题所在。

提前谢谢你的帮助。我很感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T00:22:08.080

我没有看到您的问题，但我认为这会起作用：

```
html {
height: 100%;
width: 100%;
min-height: 100%;
background-color: gray;
background-attachment: fixed; /* may be overkill */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T02:54:03.930

在 style.css 的第 59 行，更改

```
 html, body {
    min-height: 100%;
    } 
```

至

```
 html, body {
    height: 100%;
    } 
```

# mysql - MySQL IF 条件

> ID：10762680
> 
> 赞同：2
> 
> 时间：2012-05-26T00:15:18.943
> 
> 标签：mysql, if-statement

尽管我已经阅读了资源，但我对 if 条件不太熟悉，这是我开始的语句：

```
$Phone = $MyDB['Phone'];
$Mobile = $MyDB['Mobile'];

"SELECT * FROM TABLE WHERE ((number LIKE '%$Phone%') OR (number LIKE '%$Mobile%))"; 
```

现在有可能 $Phone 或 $Mobile 可能等于空，但不能都等于空，在这种情况下，此查询将返回所有数据。所以我想我可以试试：

```
$NoValue = '';

"SELECT * FROM TABLE WHERE IF('$Phone' != '$NoValue', (number LIKE '%$Phone%'), (number LIKE '%Mobile%'))"; 
```

当然，这是查询实际的一个非常简化的版本，因为我需要比较几件事以返回正确的值，我是否允许在 WHERE 之后使用 if ？有没有人有正确使用的工作示例会非常方便

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T00:26:45.397

我可以看到你正在使用 PHP，所以你为什么不做类似的东西：

```
if(isset($Phone)){
"SELECT * FROM TABLE WHERE number LIKE '%$Phone%'";
}else{
"SELECT * FROM TABLE WHERE number LIKE '%Mobile%'";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T00:34:38.487

检查这个：

```
SELECT * , IF('$phone' = '$novalue','%$mobile%','%$phone%') as comparevalue    
FROM TABLE GROUP BY Id_column HAVING number LIKE comparevalue 
```

# php - fopen("php://input", "r") 返回 0

> ID：10762693
> 
> 赞同：1
> 
> 时间：2012-05-26T00:18:28.680
> 
> 标签：php, fopen, mamp

我有线

```
$input = fopen( "php://input", "r" ); 
```

在一个 php 脚本中，我不知道为什么它返回 0。它只是在我的本地 MAMP 设置上这样做。我认为这是一个权限问题，但我不确定我需要修改哪些权限。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T04:24:45.473

出于安全原因，在某些服务器中**allow_url_fopen**在 php.ini 中设置为 0。搜索此字符串**allow_url_fopen**并将其设置为 1 并重新启动 apache 服务

# javascript - 使用 jQuery/javascript 进行远程轮询

> ID：10762695
> 
> 赞同：2
> 
> 时间：2012-05-26T00:19:24.153
> 
> 标签：javascript, jquery

我想让我的用户创建他们自己的投票，这样他们就可以将我的代码粘贴到他们网站的某个地方，并且用户可以给他们自己的游戏角色评分（1-5 星评分）。

我想为此目的使用 jQuery 或 javascript，但我不知道如何开始开发类似的东西。它应该不会以任何方式被欺骗，所以我想将投票记录存储在我的数据库表（MySQL）中。

您可能对这个案例有一些经验，所以我正在等待您的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T00:44:47.910

简而言之，这就是我要做的事情

首先，您将在某个地方托管一个 javascript 文件和星星的图像，最好是在 CDN 上。

其次，您需要设置一个可以通过 JSONP 发送和接收数据的 php 文件（或 java 或 ruby​​ 或任何您喜欢的服务器端）。

从这里您要求您的用户在文档头中简单地包含远程 javascript 文件，并`div`在页面上使用特殊类来表示该星级评定者（对于本示例`.star`）。

任务：

1.  **Javascript：**使用您的星图填充所有实例`<div class="star"></div>`并进行设置。

2.  **Javascript：**通过带有完整标识符的 JSONP 从服务器请求当前评分平均数（参见步骤 4）。

3.  **PHP：**使用标识符查找到目前为止的预定平均星级，以 JSON 形式返回当前平均评分。如果未找到，则在 JSON 中返回“未评级”状态。

4.  **Javascript：**样式星号，使它们看起来都正确，或者显示从 ajax 接收到的当前评分平均值，或者显示未评分状态。

5.  **Javascript：**设置基本行为（悬停样式更改等）

6.  **Javascript：**创建与星星的点击事件绑定。当用户单击时，您必须通过 AJAX JSON 向服务器发送有关评级的信息。此信息需要包括评分本身以及评分者的 url 和任何其他标识符。

    就像是：

    ```
    {
         url : 'http://endUsersite.com/pagetoberated.html',
         starId : 'pictureOfBillMurray',
         rating : 4,
         raterIP : 192.168.1.130
         date   : UTCstringhere
    } 
    ```

7.  **Javascript：**重新设计以显示正在进行的评级并防止未来的 ajax 被点击。

8.  **PHP：**捕获 JSON，处理并将其存储在 mySQL 中

9.  **PHP：**成功存储后，使用 JSON 响应 ajax 调用，说明评级成功

10.  **Javascript：**在获得 JSON 的“成功响应”后，样式星显示成功评级。

11.  **PHP：**处理评级以确定新的平均值。

您很可能还希望在服务器端实施某种计时系统，以防止来自同一 IP 地址的垃圾评级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T00:39:59.930

*   你试过什么？搜索？
*   研究[http://webpoll.sparklit.com/samples.spark等网站提供的内容](http://webpoll.sparklit.com/samples.spark)

显然你不会看到他们的服务器端代码，但至少你会看到客户端接收-存储-计算-发送的内容。

# asp.net-mvc - 使用HttpContext初始化BaseController的字段，控制器设计

> ID：10762702
> 
> 赞同：0
> 
> 时间：2012-05-26T00:21:22.793
> 
> 标签：asp.net-mvc, unit-testing, design-patterns, architecture

我需要在基本控制器中设置一个适用于所有控制器实例的策略，如下所示：

```
 public class BaseController : Controller
    {

        private IPolicy Policy;

        public BaseController()
        {
            this.Policy= new Policy(HttpContext);
        }
    } 
```

在 Policy 类中，我需要执行以下操作：

```
 this.httpContextBase.User. 
```

问题：（**更新**）

就使用 HttpContext 和单元测试而言，设计 BaseController 的更好方法是什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-26T07:19:26.533

> 对 HttpContext 进行单元测试的正确方法是什么？

绝对没有办法。`HttpContext`当此上下文仍未初始化时，您正在使用控制器的内部构造函数。不仅此代码无法测试，而且当您运行应用程序时，它也会因 NRE 崩溃。你不应该在控制器的构造函数中使用任何与 HttpContext 相关的东西。

一种可能性是重构您的代码并在[Initialize](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.initialize.aspx)方法中执行此操作：

```
public class BaseController : Controller
{
    private IPolicy Policy;

    protected override void Initialize(RequestContext requestContext)
    {
        base.Initialize(requestContext);
        this.Policy = new Policy(HttpContext);
    }
} 
```

* * *

话虽如此，这不是我推荐的方法。我建议您使用依赖注入而不是被许多人视为反模式的服务位置。

所以：

```
public abstract class BaseController : Controller
{
    protected IPolicy Policy { get; private set; }

    protected BaseController(IPolicy policy)
    {
        Policy = policy;
    }
} 
```

现在，剩下的就是配置您最喜欢的依赖注入框架以将正确的实例注入构造函数。例如，使用[Ninject.Mvc3](http://nuget.org/packages/Ninject.MVC3)可以通过一行代码实现：

```
kernel.Bind<IPolicy>().To<Policy>(); 
```

现在，您可以随意在单元测试中模拟此 IPolicy，而无需关心任何 HttpContext。

例如，假设您有以下要进行单元测试的控制器：

```
public class FooController : BaseController
{
    public FooController(IPolicy policy): base(policy)
    { }

    [Authorize]
    public ActionResult Index()
    {
        Policy.DoSomething();
        return View();
    }
} 
```

现在，您需要做的就是选择您最喜欢的模拟框架（在我的例子中是 Rhino Mocks）并进行模拟：

```
[TestMethod]
public void Index_Action_Should_DoSomething_With_The_Policy()
{
    // arrange
    var policyStub = MockRepository.GenerateStub<IPolicy>();
    var sut = new FooController(policyStub);

    // act
    var actual = sut.Index();

    // assert
    Assert.IsInstanceOfType(actual, typeof(ViewResult));
    policyStub.AssertWasCalled(x => x.DoSomething());
} 
```

# php - 从变量内的文本中删除用 '' 包围的单词并将它们分解为单独的变量

> ID：10762703
> 
> 赞同：0
> 
> 时间：2012-05-26T00:21:42.980
> 
> 标签：php

请看一下这个变量的内容：

```
$profile_rule = 'profile LIKE (\'fitness\') AND profile LIKE (\'pets\')'; 
```

有没有办法去掉里面的所有文本，只把健身和宠物这两个词放在两个单独的变量中？

```
$var1 = 'fitness';
$var2 = 'pets'; 
```

我不确定这是否可以完成，但如果有办法可以为我节省大量工作。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T00:40:17.543

```
$profile_rule = 'profile LIKE (\'fitness\') AND profile LIKE (\'pets\')';

preg_match_all('/\'(.*?)\'/',$profile_rule,$match);

print_r($match[1]);

// Outputs: Array ( [0] => fitness [1] => pets ) 
```

# php - 获取匹配模板标签之间的内容

> ID：10762705
> 
> 赞同：0
> 
> 时间：2012-05-26T00:22:08.677
> 
> 标签：php, templates

如何从`{@if condtwo}`匹配中获取内容`{!if}`？

```
{@if condtwo}
    {@if condone}
        show this if condone is true
    {!if}
other contents
{!if} <- matching {!if} 
```

我尝试使用`preg_match_all`. 这是我的正则表达式：

```
/([\s]*?{@IF(.*?)}[\s]*?)(.+?)([\s]*?{!$IF}[\s]*?)/si 
```

问题是它只能从`{@if condtwo}`下一个获取所有内容`{!if}`：

```
{@if condtwo}
    {@if condone}
        this is a table
    {!if} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T00:45:43.957

好吧，我知道我说过不要使用正则表达式，但是……我撒了谎。这样就可以了，而且这也可能是最好的方法。

```
/{@if(.+?)}(((?>[^{}]+)|(?R))*){!if}/si 
```

[这是一个工作演示。](http://ideone.com/DYtyz)您可能还想查看[递归正则表达式的文档](http://php.net/manual/en/regexp.reference.recursive.php)。

# python - dll在运行jcc时加载失败

> ID：10762712
> 
> 赞同：0
> 
> 时间：2012-05-26T00:23:45.133
> 
> 标签：python, dll, jcc

运行时：

```
python -m jcc.main 
```

我得到错误

`C:\Python26\python.exe: DLL load failed: The specified module could not be found`

我检查了 jcc.dll 的目录在 PATH 中。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T08:16:34.747

尝试`python -m jcc.__main__ --find-jvm-dll`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T11:22:15.213

您可能缺少 jcc.dll 所需的库 - 很可能是 msvcr71.DLL 请阅读[http://code.google.com/a/apache-extras.org/p/pylucene-extra/wiki/PyLucene处的更新提示](http://code.google.com/a/apache-extras.org/p/pylucene-extra/wiki/PyLucene)

希望有帮助！

# c# - C#解析特定的xml

> ID：10762715
> 
> 赞同：-4
> 
> 时间：2012-05-26T00:25:42.247
> 
> 标签：c#, xml

我想知道如何通过下面 xml 中的 id 解析特定的人？

还可以说我想遍历它们并将它们添加到列表视图中，我该如何使用 XmlDocument 做到这一点？

```
<users>
  <user id="Marcus">
    <website>www.google.com</website>
    <type>1</type>
  </user>
  <user id="John">
    <website>www.youtube.com</website>
    <type>1</type>
  </user>
  <user id="Josh">
    <website>www.google.com</website>
    <type>2</type>
  </user>
</users> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T00:34:59.327

这是一个 linq to xml 示例 -

```
using System.Xml.Linq;

var doc = XDocument.Parse(@"...");
var element = doc.XPathSelectElement("/users/user[@id='John']");
var website = element.XPathSelectElement("website").Value;
var type = int.Parse(element.XPathSelectElement("type").Value); 
```

# javascript - 如何改进我的 Javascript 构建配置类？

> ID：10762716
> 
> 赞同：1
> 
> 时间：2012-05-26T00:25:56.163
> 
> 标签：javascript

我不太擅长 JavaScript。我正在尝试编写一个可用于即时设置设置的构建配置类。这个想法是传递要运行的环境，然后正确设置变量。我有以下内容：

```
function BuildConfig(){  
    this.build = 'html5';
    this.server = 'http://someurl',
    this.nfc = true,
    this.barcode = true,
    this.scheduler = true,
    this.getConfig = function(buildType){  

     switch(buildType)
        {
        case "ios":
            this.build = 'ios';
            this.server = 'http://someurl';
            this.nfc = true;
            this.barcode = false;
            this.scheduler = false;
            break;
        case "android":
            this.build = 'android';
            this.server = 'http://someurl';
            this.nfc = false;
            this.barcode = true;
            this.scheduler = false;
            break;
        case "websiteanonymous":
            this.build = 'websiteanonymous';
            this.server = 'http://someurl';
            this.nfc = true;
            this.barcode = false;
            this.scheduler = true;
            break;
        case "website":
            this.build = 'website';
            this.server = 'http://someurl';
            this.nfc = true;
            this.barcode = true;
            this.scheduler = false;
            break;

        default:

        }

    };  
}; 
```

这看起来好吗？可以做任何改进吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T01:04:48.980

Your approach is ok. And the below code is slightly shorter:

```
function BuildConfig(type) {
    // Defaults
    this.build = 'html5';
    this.server = 'http://someurl';
    this.nfc = true;
    this.barcode = false;
    this.scheduler = false;

    switch (type) {
        case "ios":
            this.build = 'ios';
            this.scheduler = true;
            break;

        case "android":
            this.build = 'android';
            this.server = 'http://anotherurl';
            this.nfc = false;
            break;

        case "websiteanonymous":
            this.build = 'websiteanonymous';
            this.server = 'http://otherurl';
            this.barcode = true;
            break;

        case "website":
            this.build = 'website';
            break;
    }
}

var config = new BuildConfig('android'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T00:39:27.617

看来你重复自己太多了，在所有情况下（除了*default*）你都拥有相同的值：

```
 ...
        this.server = 'http://someurl';
        this.nfc = true;
        this.barcode = true;
        this.scheduler = true;
        ... 
```

我建议这样做：

*   创建一个标志 var 并使用它应用更改
*   或者，自动进行更改并恢复`case default`

# java - 批处理文件调用Java问题

> ID：10762720
> 
> 赞同：0
> 
> 时间：2012-05-26T00:27:10.187
> 
> 标签：java, exception, batch-file, noclassdeffounderror

我目前有一个打开的命令提示符实例，它显示

```
java -cp .;jars/GUI.jar;jars/utils.jar;...(a bunch more jars in the same folder)... Test 
```

其中 Test 是我的 java 程序（类文件已经编译）。

当我按回车时，程序运行得很好。现在，我将相同的确切行放入批处理文件中以进行自动运行，但它给了我一个错误。

批处理文件：

```
cd
java -cp .;jars/GUI.jar;jars/utils.jar;...(a bunch more jars in the same folder)... Test
pause 
```

错误：线程“主”java.lang.NoClassDefFound 测试中的异常（错误名称：测试）

我今天已经在这里待了几个小时，所以在这一点上，这是我需要做的最后一件事，我的大脑被炸了，我错过了一些简单的事情吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T00:48:54.560

也许您应该尝试提供 Test 类的完整路径：/x/y/Test 我不太确定确切的规则，但我猜如果 Test.class 不在，计算机不知道您要启动哪个类当前文件夹（当前脚本文件夹？当前 cd/home 文件夹？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T01:11:47.777

或者 Bash 脚本不知道 Java 安装的路径。我也会检查环境变量。

# qt - Qt 使用什么 API 与 Windows 剪贴板进行交互？

> ID：10762725
> 
> 赞同：1
> 
> 时间：2012-05-26T00:28:02.780
> 
> 标签：qt, clipboard

我一直在浏览 Qt 源代码，试图找到实际的系统调用，但似乎 Qt 没有使用 MSDN 上记录的 Windows API。例如，对“GetClipboardData”的源进行 grepping 会在两个文件中返回结果：

qclipboard_win.cpp：

```
#if defined(Q_OS_WINCE)
...
HANDLE clipData = GetClipboardData(CF_TEXT) 
```

qaxserverbase.cpp：

```
STDMETHOD(GetClipboardData)(DWORD dwReserved, IDataObject** ppDataObject);
...
HRESULT WINAPI QAxServerBase::GetClipboardData(DWORD, IDataObject**)
{
    return E_NOTIMPL;
} 
```

和“SetClipboardData”：

qclipboard_win.cpp：

```
#if defined(Q_OS_WINCE)
...
result = SetClipboardData(CF_UNICODETEXT, wcsdup(reinterpret_cast<const wchar_t *> (data->text().utf16()))) != NULL; 
```

这两个似乎都没有用，因为它们被声明用于 Win CE/Mobile。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T02:27:22.147

我的 Qt (4.8.1) 使用[OleSetClipboard](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686623%28v=vs.85%29.aspx)和[OleGetClipboard](http://msdn.microsoft.com/en-us/library/windows/desktop/ms692778%28v=vs.85%29.aspx)。在常规窗口中永远无法达到您要达到的行，仅在`#if defined(Q_OS_WINCE)`Qt 使用`#define OleSetClipboard QtCeSetClipboard`and的情况下`#define OleGetClipboard QtCeGetClipboard`，否则使用系统提供的这些功能的版本。

不过看到这一点有点困难`#if defined`，所以请原谅；）

至少在我的 Qt 版本上是如此。如果您在谈论 qt，尤其是关于它的内部结构，您应该提及版本，对吗？

# javascript - 基于css类限制div的拖动

> ID：10762726
> 
> 赞同：3
> 
> 时间：2012-05-26T00:28:12.997
> 
> 标签：javascript, jquery

我使用下面的代码来安排我的 div：

```
$( ".myDivs" ).sortable({
    connectWith: [".myDivs"]
}); 
```

是否可以修改此代码以排除包含特定 css 值的可排序（移动）的 div：

```
<div class="myDivs excludeThisCss"><Excluded From Move></div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T00:35:07.323

您可以使用[:not()](http://api.jquery.com/not-selector/)来定位`myDivs`没有该类的`excludeThisCss`类：

请参阅此工作[小提琴示例！](http://jsfiddle.net/zuul/J5Hfd/)

**示例的 HTML**

```
<div class="connected">
    <div class="myDivs">Hello 01</div>
    <div class="myDivs">Hello 02</div>
    <div class="myDivs excludeThisCss">Hello 03</div>
    <div class="myDivs">Hello 04</div>
</div>

<div class="connected">
    <div class="myDivs">Hello 01</div>
    <div class="myDivs">Hello 02</div>
    <div class="myDivs excludeThisCss">Hello 03</div>
    <div class="myDivs">Hello 04</div>
</div> 
```

**查询**

```
$(function() {
    $( ".connected" ).sortable({
        connectWith : ".connected",
        items       : ".myDivs:not(.excludeThisCss)"
    }).disableSelection();
}); 
```

在 Fiddle 示例中，您将能够拖动所有`.myDivs`项目，但具有`.excludeMe`类的项目不会移动！

# facebook - apprequest 框出现在 app 中间（仅在 IE 中）

> ID：10762731
> 
> 赞同：1
> 
> 时间：2012-05-26T00:29:03.663
> 
> 标签：facebook, internet-explorer, apprequests

我有 IE 的问题。当我调用 apprequest 时，该框会出现在应用程序的中间。并且由于应用程序很大（2000px），用户不能说该框是否出现（检查它的唯一方法是向下滚动，但如果它是第一次用户他不会理解）

我不确定你是否已经有这个问题。我不知道问题可能出在哪里。最糟糕的是，在 chrome 和 ff 中运行良好。这件事让我发疯。

我得到的唯一错误是来自 jquery-ui 的一些错误，但我将其停用，并且 apprequest 框的问题仍然存在。也许有办法确定apprequest-box的位置？

谢谢您的帮助！

# python - 微软语音识别定制培训

> ID：10762736
> 
> 赞同：4
> 
> 时间：2012-05-26T00:30:37.020
> 
> 标签：python, speech-recognition, speech, sapi

我一直想使用 Microsoft Speech Recognition 创建一个应用程序。

我的应用程序的用户应该经常说缩写词，例如“大型强子对撞机”或“欧洲核子研究中心”的“LHC”。鉴于该确切顺序，我的应用程序将返回

> 你说：C岁。
> 
> 你说：Cern

虽然它对“欧洲核子研究中心”确实有效，但对“大型强子对撞机”却非常失败。

但是，如果我可以制作自己的自定义训练文件，我可以轻松地将“LHC”一词放在其中的某个地方。然后，我可以让用户访问语音控制面板并运行我的培训文件。

我为此找到的所有链接都令人沮丧地无用，因为他们只是说“这是----，你应该尝试去----论坛”之类的东西。

如果它确实有帮助，这里是链接列表：

[http://compgroups.net/comp.speech.users/add-my-own-training/153194](http://compgroups.net/comp.speech.users/add-my-own-training/153194)

[https://groups.google.com/forum/#!topic/microsoft.public.speech.server/v58SH1ov22s](https://groups.google.com/forum/#!topic/microsoft.public.speech.server/v58SH1ov22s)

[http://social.msdn.microsoft.com/Forums/en/servercorefordevelopers/thread/f7a35f3f-b352-464a-b264-e16eb4afd049](http://social.msdn.microsoft.com/Forums/en/servercorefordevelopers/thread/f7a35f3f-b352-464a-b264-e16eb4afd049)

我的问题甚至可能吗？或者培训文件本身是否采用特殊格式？如果是这样，可以复制该格式吗？

一个也可以在 Windows XP 上运行的解决方案将是理想的。

提前致谢！

PS如果已经有任何库或模块，有人可以指点我吗？Python 或 C/C++ 解决方案会很棒。另外，由于我不想发布另一个关于此的问题，是否可以从命令提示符使用 train 实用程序（或没有可见的 GUI，但仍然可以完全控制所有控件）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T02:28:05.247

[好的，从我三四年前写](http://blog.thomascsherman.com/2009/08/getting-started-with-windows-voice-recognition/)的东西中提取这个，但我相信你想做这样的事情。

语法库是一个经过训练的系统，可以识别单词。您可以根据特定单词创建自己的语法库。

C#，对不起

```
using System.Speech
using System.Speech.Recognition
using System.Speech.AudioFormat

SpeechRecognitionEngine sre = new SpeechRecognitionEngine();

string[] words = {"L H C", "CERN"};
Choices choices = new Choices(words);
GrammarBuilder gb = new GrammarBuilder(choices);
Grammar grammar = new Grammar(gb);
sre.LoadGrammar(grammar); 
```

这是我所能得到的。从文档看来，您可以以某种方式定义发音。所以也许这样你就可以让 LHC 直接映射到一个单词。这是语法课上的文档 - [http://msdn.microsoft.com/en-us/library/system.speech.recognition.grammar.aspx](http://msdn.microsoft.com/en-us/library/system.speech.recognition.grammar.aspx)

小更新 - 请参阅此处的文档中的示例[http://msdn.microsoft.com/en-us/library/ms554228.aspx](http://msdn.microsoft.com/en-us/library/ms554228.aspx)

# html - 如何保持表 100% 宽？

> ID：10762738
> 
> 赞同：0
> 
> 时间：2012-05-26T00:30:43.977
> 
> 标签：html, css

我有一个你可以[在这里](http://helios.hud.ac.uk/u0867587/Mobile_app/QandATable2.php)访问的应用程序。当您打开应用程序时，只需单击加号按钮，您将看到一个带有搜索栏的模式窗口。

现在请进行以下 2 次搜索：

搜索1：AAA

搜索2：AAE

您会看到在 AAE 搜索中，表格的宽度非常好，但如果您进行 AAA 搜索，表格的宽度会小很多。

我希望表格的宽度始终保持在 100%（不希望它变小），但我不知道该怎么做。

如何将代码固定在下面以满足要求？

下面是与表格相呼应的 php 代码：

```
 $output = "";
$output .= "
    <table border='1' id='resultbl'>
      <tr>
      <th id='questionth'>Question</th>
      <th id='optiontypeth'>Option Type</th>
      <th id='noofanswersth'>Number of <br/> Answers</th>
      <th id='answerth'>Answer</th>
      <th id='noofrepliesth'>Number of <br/> Replies</th>
      <th id='noofmarksth'>Number of <br/> Marks</th>
      </tr>
";
        while ($questionrow = mysql_fetch_assoc($questionresult)) {
$output .= "
      <tr>
      <td id='questiontd'>{$questionrow['QuestionContent']}</td>
      <td id='optiontypetd'>{$questionrow['OptionType']}</td>
      <td id='noofanswerstd'>{$questionrow['NoofAnswers']}</td>
      <td id='answertd'>{$questionrow['Answer']}</td>
      <td id='noofrepliestd'>{$questionrow['ReplyType']}</td>
      <td id='noofmarkstd'>{$questionrow['QuestionMarks']}</td>
      </tr>";
        }
        $output .= "        </table>";

        echo $output; 
```

下面是完整的 css 代码：每列标题和行居中对齐，并且具有最小和最大宽度，并且它自身的表具有 100% 的最小和最大宽度：

```
#questionth{
    min-width:35%;  
    max-width:35%;  
    text-align:center;
}

#optiontypeth{
    min-width:15%;
    max-width:15%;  
    text-align:center;
}

#noofanswersth{
    min-width:10%;
    max-width:10%;  
    text-align:center;
}

#answerth{
    min-width:20%;
    max-width:20%;  
    text-align:center;
}

#noofrepliesth{
    min-width:10%;
    max-width:10%;      
    text-align:center;
}

#noofmarksth{
    min-width:10%;
    max-width:10%;  
    text-align:center;
}

#questiontd{
    min-width:35%;
    max-width:35%;      
    text-align:center;
}

#optiontypetd{
    min-width:15%;
    max-width:15%;  
    text-align:center;
}

#noofanswerstd{
    min-width:10%;
    max-width:10%;  
    text-align:center;
}

#answertd{
    min-width:20%;
    max-width:20%;  
    text-align:center;
}

#noofrepliestd{
    min-width:10%;
    max-width:10%;      
    text-align:center;
}

#noofmarkstd{
    min-width:10%;
    max-width:10%;  
    text-align:center;
}

#resulttbl{
    min-width:100%;
    max-width:100%;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T00:33:41.183

请注意，您的 CSS 指的是`#resulttbl`. 您的脚本正在输出一个带有 id 的表格`resultbl`，因此 100% 宽度不适用于它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T00:32:17.597

为什么要搞得这么复杂？只需声明宽度并保留它：

```
#resulttbl{
    width:100%;
} 
```

如果由于某种原因不起作用，请尝试使用`!important`. 如果这确实有效，那么另一条规则的优先级高于当前规则。

```
#resulttbl{
    width:100% !important;
} 
```

**更新**

曹操是对的。在这一点上，我的回答真的只是很好的建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T00:34:56.050

如何让您的表格宽度 = 100% ？

# java - JPasswordField 在 JTable 中无法正常工作

> ID：10762746
> 
> 赞同：0
> 
> 时间：2012-05-26T00:32:28.907
> 
> 标签：java, swing, jtable, tablecelleditor, jpasswordfield

我在列中`JPasswordField`用作`JTable`单元格编辑器。输入文字时效果很好；但是将光标移动到另一个单元格后，它会显示简单的文本。

那么在其他单元格中移动时我能做些什么来隐藏文本呢？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T05:26:47.690

该表对编辑器与常规单元格渲染器使用不同的组件。您需要一个包含`JPasswordField`.

# objective-c - 你能像在任何地方一样在标签栏控制器的视图控制器中使用单例吗？

> ID：10762748
> 
> 赞同：1
> 
> 时间：2012-05-26T00:32:32.903
> 
> 标签：objective-c, ios, interface-builder, singleton, uitabbarcontroller

澄清：下面描述的带有单例的视图控制器本身可以正常工作。但是，当嵌入到 UITabBarController 中时，它不起作用。

原标题：NSUnknownKeyException：可能不是笔尖，会不会是单例？

* * *

这是另一个“NSUnknownKeyException...此类不符合键的键值编码”问题，这些问题在这里很丰富。我经历了很多！这是完整的投诉：

```
NSUnknownKeyException', reason: '[<UIProxyObject 0x683dfe0> setValue:forUndefinedKey:]: this class is not key value coding-compliant for the key button1.' 
```

似乎这些例外总是归结为笔尖遗留的变量问题，这些变量在其他地方已更改并且没有被清除。所以我已经完成了我所有的笔尖，断开连接，重新连接，检查无济于事。然后我删除了笔尖并从零开始重建它，我仍然遇到同样的问题:-(所以我再次转向 SO 的蜂巢思维。

通过一系列`NSLog`s 和其他技巧，我知道问题出在 GameViewController 上（如果我摆脱它并用空控制器替换它，应用程序可以正常工作）。下面是 GameViewController 的相关部分：

```
@interface GameViewController : UIViewController <UIAlertViewDelegate>
@end

@implementation GameViewController

- (id) init {
    NSLog(@" GVC initializing");      
    self = [super initWithNibName:@"GameViewController"
                           bundle:nil];
    if (self) {
        UITabBarItem *tbi = [self tabBarItem];
        [tbi setTitle:@"Play Game"];
    }       
    return self;
}

- (id) initWithNibName:(NSString *)nibName bundle:(NSBundle *)Bundle {
    return [self init];
}

 - (void)loadView {
     [super loadView];
     NSLog(@"loadView is starting");

     // Set up display of button and label singletons

     NSMutableArray *keyArray;
     NSMutableArray *valueArray;
     keyArray = [NSMutableArray arrayWithObjects:@"answerButtons", @"clueLabels", @"keyPad", nil];
     valueArray = [NSMutableArray arrayWithObjects: [AnswerButtons answerButtons], [ClueLabels clueLabels], [KeyPad keyPad], nil];

     NSMutableDictionary *externals = [NSMutableDictionary dictionaryWithObjects:valueArray
                                                                         forKeys:keyArray];

     // Fire the button and label singletons

     [[AnswerButtons answerButtons] answerButtonsDidLoad];
     [[ClueLabels clueLabels] clueLabelsDidLoad];
     [[KeyPad keyPad] keyPadDidLoad];

     // Set up nibOptions and link to externals

     NSDictionary *nibOptions = [NSDictionary dictionaryWithObject:externals
                                                            forKey:UINibExternalObjects];

     [self.nibBundle loadNibNamed:self.nibName owner:self options:nibOptions];

     NSLog(@"loadView is done");
 }

@end 
```

这是我的应用程序委托的相关部分：

```
@implementation AppDelegate   
@synthesize window = _window;   
@synthesize tbc = _tbc;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    NSLog(@"dFLWO starting");

    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

    UITabBarController *tbc = [[UITabBarController alloc] init];

    SettingsViewController *settingsVC = [[SettingsViewController alloc] init];
    GameViewController *gameVC = [[GameViewController alloc] init];
//    UIViewController *temp = [[UIViewController alloc] init]; // works fine

    NSLog(@"dFLWO: both VC's inited");

    [tbc setViewControllers:[NSArray arrayWithObjects:gameVC, settingsVC, nil]];
    //    [tbc setViewControllers:[NSArray arrayWithObjects: temp, settingsVC, nil]]; // works fine

    NSLog(@"dFLWO: VC's set");

    [[self window] setRootViewController:tbc];
    [self.window makeKeyAndVisible];
    NSLog(@"TabBarController now active");

    return YES;
} 
```

对不起。那很长。我已经尽可能地解决了这是一个笔尖问题。也许这是我需要启动的那些单身人士的问题？该项目的先前版本没有标签栏控制器，其中这些单例（以及其他未显示的）工作得很好。

建议赞赏！

# perl - 如何使用 Perl 正则表达式摆脱“if”构造中未初始化值的使用

> ID：10762759
> 
> 赞同：1
> 
> 时间：2012-05-26T00:34:59.717
> 
> 标签：perl

如何摆脱使用`if`Perl 正则表达式的构造中未初始化的值的使用？

使用下面的代码时，我会使用未初始化的值消息。

```
 if($arrayOld[$i] =~ /-(.*)/ || $arrayOld[$i] =~ /\#(.*)/) 
```

使用下面的代码时，我没有得到任何输出。

```
 if(defined($arrayOld[$i]) =~ /-(.*)/ || defined($arrayOld[$i]) =~ /\#(.*)/) 
```

给定上面的代码，检查变量是否具有值的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T01:15:21.130

尝试：

```
if($arrayOld[$i] && $arrayOld[$i] =~ /-|\#(.*)/) 
```

这首先检查 $arrayOld[$i] 的值，然后再针对它运行正则表达式。（也将 合并`||`到正则表达式中。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T01:19:28.293

从您评论中的错误消息中，您正在访问`@arrayOld`未定义的元素。在没有看到其余代码的情况下，这可能表明您的程序中存在错误，或者它可能只是预期的行为。

如果您了解*为什么* `$arrayOld[$i]`是`undef`，并且您希望在不收到警告的情况下允许这样做，那么您可以做几件事。Perl 5.10.0 引入了[定义或运算符`//`](http://perldoc.perl.org/perlop.html#C-style-Logical-Defined-Or)，您可以使用它来替换空字符串`undef`：

```
use 5.010;
...
if(($arrayOld[$i] // '') =~ /-(.*)/ || ($arrayOld[$i] // '') =~ /\#(.*)/) 
```

或者，您可以关闭警告：

```
if (do { no warnings 'uninitalized'; 
         $arrayOld[$i] =~ /-(.*)/ || $arrayOld[$i] =~ /\#(.*)/ }) 
```

在这里，我使用[do](http://perldoc.perl.org/functions/do.html)来限制禁用警告的时间。但是，关闭警告也会抑制如果 was 收到的`$i`警告`undef`。Using`//`允许您准确指定允许的`undef`值，以及应该使用什么值而不是`undef`.

注意：正在对[定义](http://perldoc.perl.org/functions/defined.html)`defined($arrayOld[$i]) =~ /-(.*)/`函数的结果运行模式匹配，这将是一个真/假值；不是您要测试的字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T12:41:20.583

要狭隘地回答您的问题，您可以在该行代码中防止未定义值警告

```
if (defined $i && defined $arrayOld[$i]
      && ($arrayOld[$i] =~ /-(.*)/ || $arrayOld[$i] =~ /\#(.*)/))
{
  ...;
} 
```

也就是说，计算其中一个`$i`或表达式`$arrayOld[$i]`可能会导致未定义的值。注意上面写的额外的括号层，因为 和 之间的优先级不同`&&`，`||`前者绑定更紧密。对于您问题中的特定模式，您可以通过将您的模式组合成一个正则表达式来回避这个优先级问题，但在一般情况下这可能会很棘手。

我建议不要使用上面令人不快的代码。继续阅读以查看一个优雅的问题解决方案，它让 Perl 为您完成工作并且更容易阅读。

## 回头看

从[您之前的问题](https://stackoverflow.com/q/10762510/123109)的更广泛的背景来看，`$i`是一个循环变量，并且肯定会通过构造来定义，因此测试`$i`是多余的。您的代码盲目地从 中提取元素`@arrayOld`，Perl 很乐意接受。在什么都没有的情况下，您会得到未定义的值。

这种一对一的偷看和戳在 C 程序中很常见，但在 Perl 中，它几乎总是一个危险信号，您可以更优雅地表达您的算法。考虑下面完整的工作示例。

## 工作演示

```
#! /usr/bin/env perl

use strict;
use warnings;
use 5.10.0;  # given/when

*FILEREAD = *DATA;  # for demo only

my @interesting_line = (qr/-(.*)/, qr/\#(.*)/);

$/ = ""; # paragraph mode
while(<FILEREAD>) {
  chomp;
  my @arrayOld = split /\n/;
  my @arrayNewLines;

  for (1 .. @arrayOld) {
    given (shift @arrayOld) {
      push @arrayNewLines, $_ when @interesting_line;
      push @arrayOld, $_;
    }
  }

  print "\@arrayOld:\n",      map("$_\n", @arrayOld), "\n",
        "\@arrayNewLines:\n", map("$_\n", @arrayNewLines);
}

__DATA__
#SCSI_test         # put this line into  @arrayNewLines      
kdkdkdkdkdkdkdkd
dkdkdkdkdkdkdkdkd
- ccccccccccccccc  # put this line into @arrayNewLines 
```

## 前台事项

线

```
use 5.10.0; 
```

启用 Perl 的[`given`/ `when`switch 语句](http://perldoc.perl.org/perlsyn.html#Switch-statements)，这是一种很好的方式来决定哪个数组获得给定的输入行。

正如评论所示

```
*FILEREAD = *DATA;  # for demo only 
```

是为了这个 Stack Overflow 演示的目的。在您的真实代码中，您有`open FILEREAD, ...`. 将您问题的输入放入 Perl 的`DATA`文件句柄中，可以在一个独立的单元中显示代码和输入，然后我们使用别名`FILEREAD`，`DATA`以便其余代码可以毫不费力地放入您的代码中。

## 主要事件

处理的核心是

```
for (1 .. @arrayOld) {
  given (shift @arrayOld) {
    push @arrayNewLines, $_ when @interesting_line;
    push @arrayOld, $_;
  }
} 
```

请注意，没有`defined`检查，甚至没有明确的正则表达式匹配！没有`$i`或`$arrayOld[$i]`！这是怎么回事？

您从`@arrayOld`包含当前段落中的所有行开始，并希望以有趣的行结束，`@arrayNewLines`而其他所有内容都留在`@arrayOld`. `@arrayOld`上面的代码从with中取出下一行[`shift`](http://perldoc.perl.org/functions/shift.html)。如果该行很有趣，我们[`push`](http://perldoc.perl.org/functions/push.html)将它放到`@arrayNewLines`. 否则，我们将其放回`@arrayOld`.

语句修饰符`when @interesting_line`与来自 的主题执行隐式智能匹配`given`。正如[“详细智能匹配”中所解释的，](http://perldoc.perl.org/perlsyn.html#Smart-matching-in-detail)当对数组进行智能匹配时，Perl 会隐式循环它并在第一次匹配时停止。在这种情况下，数组`@interesting_line`包含已编译的正则表达式，这些正则表达式匹配您要移动到的行`@arrayNewLines`。如果当前行（`$_`感谢`given`）与这些模式中的任何一个都不匹配，则返回`@arrayOld`.

我们将前面的过程精确地执行`scalar @arrayOld`多次，即当前段落中的每一行执行一次。这样，我们只处理一次所有内容，而不必担心当前数组索引在哪里的繁琐记账。`@arrayOld`在这么多 s 之后剩下的任何东西都`shift`必须是我们`push`重新编入它的行，这些行是按输入中出现的顺序排列的无趣的行。

## 样本输出

对于您问题中的输入，输出是

```
@arrayOld：
kdkdkdkdkdkdkdkd
dkdkdkdkdkdkdkdkdkd

@arrayNewLines：
#SCSI_test # 将此行放入@arrayNewLines      
- ccccccccccccccc # 将此行放入@arrayNewLines
```

# java - Grails 应用程序在 localhost 中运行良好，但在 Tomcat 服务器上失败？

> ID：10762762
> 
> 赞同：0
> 
> 时间：2012-05-26T00:35:32.387
> 
> 标签：java, spring, grails, spring-security

我有一个用**JDK 1.7**编译的**Grails 1.3.7**应用程序，我试图在**Tomcat 6.0.33.0**上运行。该应用程序在本地运行良好，但是当我将 WAR 文件部署到服务器时，当 Tomcat 尝试配置 Spring 安全性时出现以下异常：****`grails run-app`****

 ****> 配置 Spring Security ... context.ContextLoader 上下文初始化失败 org.springframework.beans.factory.access.BootstrapException：执行引导时出错；嵌套异常是 org.codehaus.groovy.runtime.InvokerInvocationException: java.lang.VerifyError: Expecting a stackmap frame at branch target 26 in method org.codehaus.groovy.grails.plugins.springsecurity.MutableLogoutFilter.(Lorg/springframework/security/网络/身份验证/注销/LogoutSuccessHandler；）

我什至不知道从哪里开始调试这个问题。我已经这样做了`grails clean`，我还尝试提取一个新的 repo 副本并从那里开始，但没有骰子。任何人都可以提供任何建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T06:06:58.917

我已将问题归结为**Grails 1.3.7**无法与**Java 1.7**一起正常工作。我将项目更新为**Grails 2.0.4**，现在一切正常。****

# ios - 以编程方式重新创建默认的 pushViewController 动画（没有导航控制器）

> ID：10762764
> 
> 赞同：-1
> 
> 时间：2012-05-26T00:35:59.870
> 
> 标签：ios, cocoa-touch, uiview

我想在可见屏幕之外创建一个视图并将其推入（如默认的 pushViewController 动画），但我无法在外部创建 UIView。我在这里尝试了这段代码，但它不起作用。视图总是被创建并显示在当前 UIScreen 边界中。这意味着不是两个视图，一个被推出，一个被推入，只有出去的视图“移动”，新的视图就在它的位置。

在视图的 .m 中显示：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // set the views frame off the screen
    self.view.frame = CGRectMake(320, 0, 320, 460);
} 
```

在实际进行转换的方法中：

```
-(void)showOverview:(UIViewController *)sender  //sender = mapviewController
{
    NSLog(@"overview");
    // current view (frame) = mapviewCOntroller.view
    CGRect outFrame = self.view.frame;

    if (!self.overviewViewController) {
        self.overviewViewController = [[UCOverviewViewController alloc] init];
        self.overviewViewController.transitionDelegate = self;

        // create a new View for the overview
        [self.overviewViewController.view setCenter:self.view.center];
        [self.view.window addSubview:self.overviewViewController.view];
        [self.view.window bringSubviewToFront:self.mapViewController.view];
    }

    CGRect inFrame = self.overviewViewController.view.frame;
    outFrame.origin.x = outFrame.origin.x-outFrame.size.width;  
    inFrame.origin.x = self.view.frame.origin.x;

    [UIView animateWithDuration:0.5f animations: ^{
        [self.view setFrame:outFrame];
    }];  
} 
```

**编辑：这是我的最终代码，至少是重要的部分。现在，当前可见的视图在屏幕外视图滑入的同时滑出屏幕。**

```
-(void)showOverview
{
    if (!self.overviewViewController) {
        NSLog(@"OverviewViewController created!");
        self.overviewViewController = [[UCOverviewViewController alloc] init];
        self.overviewViewController.transitionDelegate = self;
        // add the subView
        [self.view addSubview:self.overviewViewController.view];
        [self.view sendSubviewToBack:self.overviewViewController.view];
    }
    CGRect outFrame = self.mapViewController.view.frame;
    CGRect inFrame = self.overviewViewController.view.frame;

    outFrame.origin.x -= outFrame.size.width;
    inFrame.origin.x = self.view.frame.origin.x;
    self.isOverviewViewVisible = YES;

    [UIView animateWithDuration:0.5f animations: ^{
        [self.mapViewController.view setFrame:outFrame];
        [self.overviewViewController.view setFrame:inFrame];
    }];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T00:46:56.853

你的问题是这条线。

```
 self.overviewView = self.overviewViewController.view; 
```

您正在用已有的视图覆盖您创建的视图。

以下不是一个很好的方法，但它应该适用于我认为你所拥有的。

```
- (void)viewDidLoad {
      self.overviewViewController.view.frame = CGRectMake(320, 0, 320, 460);
      self.overviewViewController.view.backgroundColor = [UIColor blueColor];
} 
```

然后你想要另一个动作来做动画。

```
 [UIView animateWithDuration:0.5f animations: ^{
    self.overviewViewController.view.frame = CGRectMake(0,0,320,460);  
  }]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T01:17:39.527

您的代码中有一些奇怪和不正确的东西，让您难以理解实际发生的事情，但是......忘记在任何地方使用窗口。你唯一需要担心的就是这个。假设视图 A 是您的主要视图。视图 B 是您想要从 A 外部进入的视图。然后，从 nib 或手动创建 B，将其作为子视图添加到视图 A，然后在进入动画块将其移动到位之前，确保当前帧设置为 {ViewA.bounds.size.width, 0, ViewB.bounds.size.width, ViewB.bounds.size.height}。假设您希望它从右上角进入。

# c# - 在 Java Web 浏览器中加载 Flash 对象

> ID：10762765
> 
> 赞同：1
> 
> 时间：2012-05-26T00:36:14.963
> 
> 标签：c#, java, flash, browser

我想知道是否有某种方法可以从自定义 Java 网络浏览器加载 Flash 对象。例如，我希望能够观看 YouTube 视频。

我读过这篇文章：[Embedding Flash Component into Java App](https://stackoverflow.com/questions/221218/embedding-flash-flex-component-into-java-app)，但我不确定如何使用它，因为我没有本地的 Flash 作为 .swf。我不知道它从哪里加载 Flash 文件。另外，我更喜欢不需要购买产品的解决方案。

我确信使用 C# 和 WebBrowser 类可以做到这一点，因为它使用了 IE 的 Flash 插件，我只是想知道是否有办法使用 Java 来做到这一点。

# makefile - WINAVR 在包含路径中找不到包含空格的文件

> ID：10762766
> 
> 赞同：2
> 
> 时间：2012-05-26T00:36:17.800
> 
> 标签：makefile, winavr

当我为 EXTRAINCDIRS 提供不带空格的路径（在 Makefile 中，遵循 WINAVR 提供的示例）时，编译器能够找到我的头文件，但是当我使用包含空格的路径时（用引号括起来，如注释Makefile 直接），它引发：`error: No such file or directory`.

```
"d:/dev/avr/atmega/shared/" # will search files in this dir
"d:/dev/avr/atmega/sha ed/" # will not search this dir for files 
```

我的意思是，评论说：

```
# List any extra directories to look for include files here.
#     Each directory must be seperated by a space.
#     Use forward slashes for directory separators.
#     For a directory that has spaces, enclose it in quotes. 
```

知道如何让 WINAVR 正确处理这个问题吗？

我在 Windows XP 上使用程序员记事本 (WINAVR)。这是命令行命令：

```
avr-g++ -c -mmcu=atmega328p -I. -gdwarf-2 -DF_CPU=UL -Os -funsigned-char -funsigned-bitfields -fpack-struct -fshort-enums -Wall -Wstrict-prototypes -Wa,-adhlns=./main.lst -I"d:/dev/avr/atmega/shared/" -I"d:/dev/avr/atmega/sha -Ied/" -std=gnu99 -MMD -MP -MF .dep/main.o.d main.c -o main.o 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T14:38:44.783

发生的事情是我猜在makefile中的其他地方有一行可以执行以下操作：

```
INCLUDES = $(addprefix -I, $(INCDIRS)) 
```

发生这种情况时，addprefix 将 $(INCDIRS) 变量中的任何空格视为下一个变量的分隔符，并将在此处添加 -I。您可以做的是对空格使用特殊字符“\\”，然后在生成命令之前调用替换函数来重新替换空格。类似于以下示例：

```
SPACE = \\
INCDIRS = /home/posey/test$(SPACE)dir

INCLUDES = $(addprefix -I, $(INCDIRS))
REAL_INCLUDES = $(subst $(SPACE), ,$(INCLUDES))

.PHONY : all

all:
    $(info $(REAL_INCLUDES)) 
```

如果这没有意义，您可以发布整个 makefile，我们可以准确地向您展示发生了什么。一旦空间被替换回变量中，您就不能通过任何进一步的 make 函数来运行它，这些函数与空间分隔符一起工作，而不会发生相同的行为。

# php - 通过条件 >= 或 <= 在 2 个数字字段之间更改 TD 背景颜色

> ID：10762769
> 
> 赞同：0
> 
> 时间：2012-05-26T00:37:02.880
> 
> 标签：php, jquery, mysql, html-table

> **可能重复：**
> [如果字段结果大于或等于另一个字段，我可以更改 <td> 背景吗？](https://stackoverflow.com/questions/10760870/can-i-change-the-td-background-if-a-field-result-is-great-or-equal-to-another)

试图让我的脚本工作，显示 mySQl 通过 php 生成一个 HTML 表，其中包含一个包含 $qty 的特定列 TD，当它等于或超过 $min 或 $max 时，它的背景需要变为红色。

也许有更好的方法来纠正这个 php？

脚本不工作。

```
<script type="text/javascript">
$(document).ready(function() {
var min = parseInt($('.min').text());
var max = parseInt($('.max').text());
var qty = parseInt($('.quantity').text());

if (qty >= max || qty <= min ) {
$('.quantity').css('background-color', 'red');
} 
});
</script> 
```

我的 php 表/三个字段都在表的末尾：

```
$o .= '<tr><td>'.$type.'</td><td>'.$part_no.'</td><td>'.$description.'</td><td>'.$artwork.' &nbsp; &nbsp;</td><td><a href="/data/hero/copies/'.$part_no.'.pdf" target="_blank">Link &nbsp;</a></td><td align=right class="min">'.number_format($min).'</td><td align=right class="max">'.number_format($max).'</td><td align=right class="quantity">'.number_format($qty).'</td></tr>';} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T00:51:28.013

您的 php 示例`}`在行尾有一个迷路。是不是导致了这个问题？

我刚刚用你发布的 javascript 和这个 php 尝试了这个：

```
$o = '<tr><td>'.$type.'</td><td>'.$part_no.'</td><td>'.$description.'</td><td>'.$artwork.' &nbsp; &nbsp;</td><td><a href="/data/hero/copies/'.$part_no.'.pdf" target="_blank">Link &nbsp;</a></td><td align=right class="min">'.number_format($min).'</td><td align=right class="max">'.number_format($max).'</td><td align=right class="quantity">'.number_format($qty).'</td></tr>'; 
```

它完美地工作。

Is `$o` getting properly printed out to the browser? If you view the HTML source, do you have a `td`s with the classes min, max and quantity? What exact symptoms of it not working do you get? Maybe you could post a little more of the script?

# sql - 有没有如何优化与 2 内连接到同一个表的查询？

> ID：10762771
> 
> 赞同：3
> 
> 时间：2012-05-26T00:37:54.940
> 
> 标签：sql, sqlite

我有这个问题：我有一个包含这 3 个表的模型：Linha、Itinerario 和 Rua 在我的代码中，我收到了两个关于 idRua 的参数，并且我必须返回所有 Linhas，其中我有 Itinerario 对 Rua 的引用和两个 idRua...在这个例子中，我有 idRua = 1 和 idRua = 2。

```
SELECT l.codigo, l.linha, l.idEmpresa, l.idLinha 
FROM Linha l 
INNER JOIN Itinerario i1 ON i1.idLinha = l.idLinha 
INNER JOIN Itinerario i2 ON i2.idLinha = l.idLinha 
WHERE i1.ida = i2.ida and i1.idRua = 1 and i2.idRua = 2 
ORDER BY l.linha 
```

问题是我在该表 Itinerario 中获得了 2 个内部连接，并且查询变慢了......有什么办法可以优化它吗？是否有一些带有“AND”条件的“IN”运算符或类似的东西？我正在使用 SQLite。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T02:42:28.550

可能有一种方法可以消除自连接。

如果我没看错的话，你希望 Itinerario 中的 idLinha 包含同一个 ida 的 idRua = 1 和 idRua = 2。我注意到这只是一个过滤条件，因为选择中的所有内容都来自 linha。

下面得到这个条件：

```
SELECT idlinha
From itinerario
GROUP BY idlinha, ida
having max(case when idRua = 1 then 1 else 0 end) = 1 and
       max(case when idRua = 2 then 1 else 0 end) = 1 
```

现在，我们可以在“in”或“join”子句中使用它，如下所示：

```
SELECT l.codigo, l.linha, l.idEmpresa, l.idLinha 
FROM Linha l
where l.idlinha in (SELECT idlinha
                    From itinerario
                    GROUP BY idlinha
                    having max(case when idRua = 1 then 1 else 0 end) = 1 and
                           max(case when idRua = 2 then 1 else 0 end) = 1
                   )
order by l.linha 
```

group by 可能会比自加入更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T00:44:12.220

您的查询将尽可能有效地表达。您需要确保拥有正确的索引，以便 SQLite 有效地执行查询。`Itinerario`确保表的`idLinha`列上存在索引：

```
create index Itinerario_Linha_Idx on Itinerario(idLinha) 
```

上的索引`idRua`也可能派上用场：

```
create index Itinerario_Rua_Idx on Itinerario(idRua) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-26T00:48:37.277

因为您的`WHERE`条件不适用于 table `Linha`，您可以通过将条件移动到相关`ON`子句来提高性能，这些子句可以在进行内部连接时应用，而不是在结果集上应用：

```
SELECT l.codigo, l.linha, l.idEmpresa, l.idLinha 
FROM Linha l 
INNER JOIN Itinerario i1 ON i1.idLinha = l.idLinha and i1.idRua = 1
INNER JOIN Itinerario i2 ON i2.idLinha = l.idLinha and i2.idRua = 2 and i1.ida = i2.ida
ORDER BY l.linha 
```

此外，您必须在`Itinerario(idLinha)`. 几乎可以肯定，索引`Itinerario(idRua)`无济于事。

*为获得上述查询的最佳性能，请在* `idLinha`和上创建索引`idRua`：

```
create index Itinerario_Index1 on Itinerario(idLinha, idRua); 
```

使用 both`idLinha`和`idRua`in`ON`子句，索引的两个部分都可以使用，因此数据库将只读取它需要的确切行，从而最大限度地减少 I/O。

# python - 为什么接受 kwargs 但不使用它们？

> ID：10762780
> 
> 赞同：4
> 
> 时间：2012-05-26T00:40:23.477
> 
> 标签：python, django, keyword-argument

我今天在看 Django 源代码，我注意到了这一点：

```
class DjangoTestSuiteRunner(object):
    def __init__(self, verbosity=1, interactive=True, failfast=True, **kwargs):
        self.verbosity = verbosity
        self.interactive = interactive
        self.failfast = failfast 
```

为什么他们会在构造函数中接受 kwargs 而对它们不做任何事情？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-26T00:43:54.683

这种模式可以使向后/向前兼容更容易。如果新/旧版本的代码有更多/更少的参数，那么你不会破坏一切。

此外，当您继承此类时（例如使用 mixins），只接受所有内容会很方便。

恕我直言，这不是一个漂亮的模式，但它确实有效。

# xcode - OpenCv ImShow() 函数闪烁/闪烁

> ID：10762784
> 
> 赞同：1
> 
> 时间：2012-05-26T00:41:10.007
> 
> 标签：xcode, opengl, opencv

在 osx 10.7 上运行 mac 端口自我更新并安装 gnomeui 库后，我用 Xcode 编译了 OpenCV 程序，该`ImShow()`函数创建了一个行为异常的窗口，闪烁和闪烁。在 Xcode 的应用程序输出消息中显示以下内容：opengl support available。

有人知道问题出在哪里吗？我需要用 OpenGL 重新编译 OpenCV 吗？还有什么我可以尝试纠正的吗？

编辑：我附上了Xcode生成的Windows截图，通常这种带有按钮工具栏的UiWindow是由QtCreator生成的。我开始认为问题源于 Qt 被更新为 mac 端口自我更新。

![xcode生成的窗口](../Images/4fa12d36d445c909ee43afb24b36a805.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T17:32:31.350

[`waitKey`](http://docs.opencv.org/modules/highgui/doc/user_interface.html#waitkey)可能你调用后不使用`imShow`，然后窗口被创建并快速销毁。如果是这种情况，只需调用`waitKey`after `imShow`，然后创建窗口并等待，直到您按下一个键，然后窗口被销毁。

# c# - 如何查询 Sharepoint 列表中每个值的最大 ID？

> ID：10762785
> 
> 赞同：2
> 
> 时间：2012-05-26T00:41:30.727
> 
> 标签：c#, web-services, sharepoint, wss

我想查询一个`valueList`通过网络服务调用的 Sharepoint 2007 列表，并找到每个列表项的最新版本，所以给出了这个列表：

```
ID | Value
----------
1  | 101
2  | 305
3  | 102
4  | 101
5  | 305
6  | 101 
```

我希望我的查询返回：

```
ID | Value
----------
3  | 102
5  | 305
6  | 101 
```

在 Access SQL 中，我会这样做：

```
select v1.* from valueList v1
inner join 
(select value, max(id) as maxID from valueList group by value) v2
on v1.id=v2.maxID 
```

到目前为止，似乎我可以在 C#/CAML/Sharepoint Web 服务中执行此操作的唯一方法是运行 CAML 查询来对列表项进行分组`value`并按顺序排序`ID`，将查询转储到 DataTable，然后遍历每一行DataTable，为每个`value`. 代码如下：

```
//dataHandler constructor initializes Web Services Lists() object
dataHandler dh = new dataHandler();

string[] fields = { "ID", "value"};
string query =
           "<GroupBy collapse='true'>" +
              "<FieldRef Name='value' />" +
           "</GroupBy>" +
           "<OrderBy>" +
              "<FieldRef Name='ID' />" +
           "</OrderBy>";

DataTable listTable = dh.listToDataTable("valueList", fields, query);

//copy listTable structure to blank resultTable
DataTable resultTable = listTable.Clone();

//initialize value    
int value = (int)Convert.ToDouble(listTable.Rows[0][1]);

for (int ctr = 0; ctr < listTable.Rows.Count; ctr++)
{

    //check to see if we've gone onto a new 'value', if so get previous row
    if (value != (int)Convert.ToDouble(listTable.Rows[ctr][1]) )
    {
        resultTable.ImportRow(listTable.Rows[ctr - 1]);
        value = (int)Convert.ToDouble(listTable.Rows[ctr][1]);
    }

    //get the last row
    if (ctr == listTable.Rows.Count - 1)
    {
        resultTable.ImportRow(listTable.Rows[ctr]);
    }

} 
```

这`(int)Convert.ToDouble`是因为该字段作为字符串存储在 DataTable 中，例如 1234 存储为“1234.0000”。

这似乎不必要地复杂。有没有更直接的方法来完成我所追求的？如果有更简单的方法，我不需要使用 DataTables 或 CAML。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T01:56:15.207

看起来您正在列表上进行自己的版本控制？如果您只是使用 SharePoint 版本控制，那么很容易获得最新版本。:)

无论如何，CAML 非常有限，2007 年没有加入（[2010 年你有加入](http://msdn.microsoft.com/en-us/library/ee539975.aspx)）。除非您对列表进行某种预处理。我认为这是不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T09:30:57.090

这个[链接](https://sharepoint.stackexchange.com/questions/43684/how-to-query-greatest-id-of-each-value-in-a-sharepoint-list/43685#43685)对我有用:)

```
DataTable dtList = list.Items.GetDataTable();
var grouped = from row in dtList.AsEnumerable()
          group row by row["Value"] into valueGroup
          select new { Value = valueGroup.Key, ID = valueGroup.Max(id => id["ID"]) }; 
```

# c# - 将 DataGrid 绑定到 XmlDataProvider 的问题

> ID：10762786
> 
> 赞同：2
> 
> 时间：2012-05-26T00:42:24.747
> 
> 标签：c#, wpf, wpf-controls, wpfdatagrid

我有以下代码：

```
<Window.Resources>
    <XmlNamespaceMappingCollection x:Key="ns">
        <XmlNamespaceMapping Prefix="a" Uri="http://musicbrainz.org/ns/mmd-2.0#" />
    </XmlNamespaceMappingCollection>
    <XmlDataProvider XmlNamespaceManager="{StaticResource ns}" x:Key="SearchArtistDataSource" XPath="/a:metadata/a:artist-list/a:artist" Source="file.xml" />
</Window.Resources>
<DataGrid x:Name="SearchArtistDataGrid" ItemsSource="{Binding Source={StaticResource SearchArtistDataSource}}">
    <DataGrid.Columns>
        <DataGridTextColumn Binding="{Binding XPath=a:name}" />
        <DataGridTextColumn Binding="{Binding XPath=a:country}" />
    </DataGrid.Columns>
</DataGrid> 
```

这是我正在使用的 XML 文件：http: [//pastebin.com/5bUCIsB](http://pastebin.com/5bUCBisB)

到目前为止，我所取得的成就是在某种程度上将 DataGrid 绑定到 XmlDataProvider - 我可以说这么多，因为它会从 XML 文件中自动生成一些列。问题是我正在尝试添加的手动操作（显示艺术家列表数组中艺术家的姓名和国家/地区） - 没有任何内容显示在其中。

对于它的价值 - 类似的方法在 ListView 中运行良好，但我在迁移时被卡住了。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T11:39:27.303

我在 MSDN 论坛上得到了答案……这件事事后诸葛亮。

`XmlNamespaceManager`不仅要附加到，`XmlDataProvider`还要附加到`DataGrid`自身：

```
<DataGrid Binding.XmlNamespaceManager="{StaticResource ns}"> 
```

让我们希望这可以帮助任何遇到类似问题的人。

# routes - 如何使用控制器中的方法执行 Ruby on Rails link_to

> ID：10762791
> 
> 赞同：0
> 
> 时间：2012-05-26T00:43:41.927
> 
> 标签：routes, ruby-on-rails-3.2, ruby-1.9.3

我正在使用 bcrypt-ruby 进行密码加密。在 gem [http://bcrypt-ruby.rubyforge.org/](http://bcrypt-ruby.rubyforge.org/)的文档中，他们提供了一个允许某人重置密码的操作。我正在尝试执行此操作。

我在登录页面上添加了以下代码：

```
<p>Forgot your Password? <%= link_to "Click to reset your password", forgot_password_session_path, confirm: "Do you really want to reset your password?" %></p> 
```

这是我的 sessions_controller.rb 文件中的代码：

```
def forgot_password
  random_password = Array.new(10).map { (65 + rand(58)).chr }.join
  case
    when User.find_by_email(params[:session][:email_user])
      user = User.find_by_email(params[:session][:email_user])
    when User.find_by_username(params[:session][:email_user])
      user = User.find_by_username(params[:session][:email_user])
  end  
  user.password = user.password_confirmation = random_password
  user.save!
  Mailer.create_and_deliver_password_change(user, random_password)
end 
```

这是 config/routes.db 中的定义：

```
resources :sessions do
  member do
    get "forgot_password"
  end
end 
```

这是 rake 路由的输出：

```
forgot_password_session GET    /sessions/:id/forgot_password(.:format) sessions#forgot_password 
```

当我尝试单击登录链接上的链接时，出现以下错误：

没有路由匹配 {:action=>"forgot_password", :controller=>"sessions"}

我不知道它是如何说没有路线匹配的，但它看起来确实如此。我已经重新启动了我的 Rails 服务器和 spork，但仍然出现错误。我不知道下一步。

任何帮助将不胜感激。

更新 2012 年 5 月 26 日上午 9:14 GMT-6：

我更改为 POST，重新启动我的 Rails 服务器和 Spork。我得到了同样的错误。这是我来自服务器的日志：

在 2012 年 5 月 26 日 09:13:36 -0500 开始 GET "/login" for 127.0.0.1 由 SessionsController#new 处理为 HTML 在布局/应用程序中呈现 session/new.html.erb (112.4ms) 完成 500 内部服务器116 毫秒内的错误

这是耙路线信息：

```
forgot_password_session POST   /sessions/:id/forgot_password(.:format) sessions#forgot_password 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T01:03:17.487

It may need to be a POST request. When I took a rails class, putting inline link calls was inconsistant. The reason you have that error is that your routes file is configured for a GET, not a POST. Just a shot in the dark, but try adding the same line but with a POST.

# c# - 从成员中删除用户

> ID：10762793
> 
> 赞同：0
> 
> 时间：2012-05-26T00:44:04.703
> 
> 标签：c#, asp.net

我制作了一个`GridView`带有删除和编辑链接的按钮来执行编辑和删除操作。这适用于编辑按钮，但不适用于删除按钮。问题是什么？

当我运行我的应用程序时，它给了我这个错误：

> 必须声明标量变量“@UserName”

```
<asp:Content ID="Content1" ContentPlaceHolderID="HeadContent" runat="server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" 
DataSourceID="SqlDataSource1">
<Columns>
<asp:CheckBoxField DataField="IsApproved" HeaderText="IsApproved"
SortExpression="IsApproved" />
<asp:BoundField DataField="UserName" HeaderText="UserName" 
SortExpression="UserName" />
<asp:CheckBoxField DataField="IsLockedOut" HeaderText="IsLockedOut" 
SortExpression="IsLockedOut" />
<asp:CommandField ShowEditButton="True" ShowDeleteButton="True" />
</Columns>
</asp:GridView>
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
ConnectionString="<%$ ConnectionStrings:ApplicationServices %>" 
SelectCommand="SELECT [IsApproved], [UserName], [IsLockedOut] FROM [vw_aspnet_MembershipUsers]" 
UpdateCommand="UPDATE [vw_aspnet_MembershipUsers] SET IsApproved = @IsApproved, IsLockedOut = @IsLockedOut WHERE (UserName = @UserName)"
DeleteCommand="DELETE FROM [vw_aspnet_MembershipUsers] WHERE (UserName = @UserName)">
<UpdateParameters>
<asp:Parameter Name="IsApproved" />
<asp:Parameter Name="IsLockedOut" />
<asp:Parameter Name="UserName" />
</UpdateParameters> 
<DeleteParameters>
<asp:Parameter Name="IsApproved" />
<asp:Parameter Name="IsLockedOut" />
<asp:Parameter Name="UserName" />
</DeleteParameters> 

</asp:SqlDataSource>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T00:53:14.043

您应该通过`Membership.DeleteUser(user.UserName)`或通过存储过程删除`[dbo].[aspnet_Users_DeleteUser]`

[http://www.salmontraining.com/SqlExpressZone/articles/deleting_users_from_membership.html](http://www.salmontraining.com/SqlExpressZone/articles/deleting_users_from_membership.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T00:52:38.927

我的建议是处理 SQLDataSource 的“删除”事件。调用 asp.net 会员 api 从后面的代码中删除。

确保导入 System.Web.Security，然后尝试以下操作：

```
 // Delete Membership User 
    Membership.DeleteUser(UserName); 
```

无论如何，从视图中删除记录并不是最好的方法。

# android - 在安卓上访问相机

> ID：10762805
> 
> 赞同：0
> 
> 时间：2012-05-26T00:47:19.647
> 
> 标签：android, exception, camera

我试图实现相机访问，就像它发布在几个页面中一样。

这是代码

```
 package view;
 import R;
 import android.app.Activity;
 import android.hardware.Camera;
 import android.os.Bundle;
 import android.view.View;
 import android.view.View.OnClickListener;
 import android.widget.Button;
 import android.widget.EditText;
 import android.widget.FrameLayout;
 public class doInspectionImage extends Activity{
private cameraPreview csv;
private Camera cam;
private String rid;
public void onCreate(Bundle is){
    super.onCreate(is);
    this.rid = getIntent().getStringExtra("reportid");
    setContentView(R.layout.spectware_view_takepicture);
    csv = new cameraPreview(this);
    FrameLayout preview = (FrameLayout)findViewById(R.id.picturepreview);
    preview.addView(csv);
    Button takeAPicture = (Button)findViewById(R.id.takePicture);
    takeAPicture.setOnClickListener(new OnClickListener(){
        public void onClick(View v) {
            cam = csv.getCamera();
            addText();
        }
    });
}
public void onPause(){
    super.onPause();
    csv.CameraDisable();
}
public void onResume(){
    super.onResume();
    csv = new cameraPreview(this);
    FrameLayout preview = (FrameLayout)findViewById(R.id.picturepreview);
    preview.addView(csv);
    Button takeAPicture = (Button)findViewById(R.id.takePicture);
    takeAPicture.setOnClickListener(new OnClickListener(){
        public void onClick(View v) {
            cam = csv.getCamera();
            addText();
        }
    });
}
private void addText(){
    setContentView(R.layout.spectware_view_picturetext);
    Button storePic = (Button)findViewById(R.id.storepicture);
    storePic.setOnClickListener(new OnClickListener(){
        public void onClick(View v) {
            EditText dt = (EditText)findViewById(R.id.picturetext);
            storePicture(dt.getText().toString());
            finish();
        }
    });
}
private void storePicture(String txt){
    cam.takePicture(null,null,new model.camera.Camera(rid,txt));
}
} 
```

包视图；

```
import java.io.IOException;

import android.content.Context;
import android.hardware.Camera;
import android.view.SurfaceHolder;
import android.view.SurfaceView;

public class cameraPreview extends SurfaceView implements SurfaceHolder.Callback{
private SurfaceHolder holder;
private Camera camera;
public cameraPreview(Context context){
    super(context);
    this.holder = this.getHolder();
    this.holder.addCallback(this);
    this.holder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
}
public void surfaceCreated(SurfaceHolder holder){
        try{
            //Open the Camera in preview mode
            this.camera = Camera.open();
            this.camera.setPreviewDisplay(this.holder);
        }
        catch(IOException ioe)
        {
                ioe.printStackTrace(System.out);
        }
}
public void CameraEnable(SurfaceHolder holder){
    try{
        //Open the Camera in preview mode
        this.camera = Camera.open();
        this.camera.setPreviewDisplay(this.holder);
    }
    catch(IOException ioe)
    {
            ioe.printStackTrace(System.out);
    }
}
public void CameraDisable(){
    this.camera.release();
}
public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) {
        // Now that the size is known, set up the camera parameters and begin
        // the preview.
        Camera.Parameters parameters = camera.getParameters();
        parameters.setPreviewSize(width, height);
        camera.setParameters(parameters);
        camera.startPreview();
}
public void surfaceDestroyed(SurfaceHolder holder){
        // Surface will be destroyed when replaced with a new screen
        //Always make sure to release the Camera instance
        camera.stopPreview();
        camera.release();
        camera = null;
}
public Camera getCamera(){
        return this.camera;
}
public void onPause(){

}
} 
```

一旦我开始这项活动

```
 Intent i = new Intent();
i.setClass(l,doInspectionImage.class);
i.putExtra("reportid",l.inspection_id);
startActivity(i); 
```

我在记录器中收到此消息：

```
 05-26 02:35:12.550: W/dalvikvm(8300): threadid=1: thread exiting with uncaught exception (group=0x4001e578)
    05-26 02:35:12.600: E/AndroidRuntime(8300): FATAL EXCEPTION: main
    05-26 02:35:12.600: E/AndroidRuntime(8300): java.lang.RuntimeException: Fail to connect to camera service
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.hardware.Camera.native_setup(Native Method)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.hardware.Camera.<init>(Camera.java:300)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.hardware.Camera.open(Camera.java:275)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at view.cameraPreview.surfaceCreated(cameraPreview.java:22)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.SurfaceView.updateWindow(SurfaceView.java:569)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.SurfaceView.updateWindow(SurfaceView.java:407)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.SurfaceView.dispatchDraw(SurfaceView.java:352)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.View.draw(View.java:6936)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.widget.FrameLayout.draw(FrameLayout.java:357)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.ViewGroup.drawChild(ViewGroup.java:1646)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.View.draw(View.java:6936)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.widget.FrameLayout.draw(FrameLayout.java:357)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at com.android.internal.policy.impl.PhoneWindow$DecorView.draw(PhoneWindow.java:1917)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.ViewRoot.draw(ViewRoot.java:1530)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.ViewRoot.performTraversals(ViewRoot.java:1266)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1868)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.os.Handler.dispatchMessage(Handler.java:99)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.os.Looper.loop(Looper.java:130)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at android.app.ActivityThread.main(ActivityThread.java:3691)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at java.lang.reflect.Method.invokeNative(Native Method)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at java.lang.reflect.Method.invoke(Method.java:507)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:907)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:665)
    05-26 02:35:12.600: E/AndroidRuntime(8300):     at dalvik.system.NativeStart.main(Native Method) 
```

我尽可能靠近样品。我不知道我做了什么不同，除了我必须做出改变来实现它的目的。我很感谢任何帮助。

克里斯

PS：如果我点击后退按钮，我会得到预览。但在那之后一秒钟，应用程序崩溃了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T02:24:32.987

要检查的两件事

1.  检查清单中的相机权限。确保已添加。

2.  您必须正确释放相机资源（在 onPause 中停止查看）。

# mysql - MySQL 限制不起作用

> ID：10762807
> 
> 赞同：6
> 
> 时间：2012-05-26T00:48:02.313
> 
> 标签：mysql, sql

我有一个 MySQL 5.0 服务器，我正在运行这个查询：

```
 SELECT *
    FROM deals
    WHERE expires > "2012-05-25 19:37:58"
    AND city =2
    ORDER BY UIN
    LIMIT 48 , 57 
```

它正在返回：

> 显示第 0 - 29 行（总共 57 行，查询耗时 0.0036 秒）

难道我做错了什么？我预计 9 行，48-57 ..

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-26T00:49:30.070

to的第二个参数`LIMIT`不是偏移量，它是相对于偏移量的长度。所以如果你想要 9 行，那就是`LIMIT 48, 9`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-26T00:49:58.037

```
LIMIT 48 , 57 
```

将显示第 48 条记录之后的 57 条记录。

尝试

```
LIMIT 48 , 9 
```

[http://php.about.com/od/mysqlcommands/g/Limit_sql.htm](http://php.about.com/od/mysqlcommands/g/Limit_sql.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-26T00:52:11.220

`LIMIT`像这样工作：`LIMIT (page - 1) * post_per_page, post_per_page`

# python - 在 Pyside 中，为什么在处理信号后发出大于 0x7FFFFFFF 的整数会导致“OverflowError”？

> ID：10762809
> 
> 赞同：5
> 
> 时间：2012-05-26T00:48:45.557
> 
> 标签：python, qt, signals, pyside

我正在尝试使用具有 0 - 2^32-1 范围内的大整数的信号/插槽。我发现了一些奇怪的东西——一旦我发出 > 7FFFFFFF 边界，我会在插槽运行*后抛出 OverflowError 异常。*如果我或 QT 在 C 或 C++ 等另一种语言中明确使用带符号的 32 位整数，我可能会预料到这种溢出——众所周知，0x80000000 在 2s 补码表示法中回绕到 -2^31。但是在 python 中，它只有 2^32 没有包装。我在编写代码时的假设是这是 python 并且内置的 int 可以变得非常大（可能是任意的？）并且我不需要明确地定义为 32 位或 64 位或有符号/无符号的东西。这一切都会奏效。

下面的代码演示了我所看到的（Python 2.7.2（64 位）、Pyside 1.1.0、Windows 7）

```
from PySide.QtCore import *

@Slot(int)
def say(i):
    print "Say %i" % i

class Communicate(QObject):
    speak = Signal(int)

someone = Communicate()
someone.speak.connect(say)
someone.speak.emit(0x7FFFFFFF) #works fine
someone.speak.emit(0x80000000) #OverflowError after slot "say" runs
say(0x80000000)                #works fine 
```

确切的输出是：

```
说 2147483647
说-2147483648
溢出错误
说2147483648

```

1.  为什么 Qt 似乎将整数类型的信号/插槽视为处理带符号的 32 位整数而不是 python 内置整数？
2.  如果这是 Qt 的限制，我该怎么做才能将 int 标记为无符号或确保 QT 可以处理大于 0x7FFFFFFF 的整数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-26T02:04:58.813

我主要是 PyQt 用户，但我相信行为是相似的。`int`in 信号定义被映射到 4 字节整数（正如 Qt 理解的那样`int`）。

一种可能的解决方案是强制信号发出 Python 对象。这有效：

```
class Communicate(QObject):
    speak = Signal(object) 
```

但请注意，如果您将此信号连接到需要 Qt 版本`int`（例如`QtGui.QSpinBox.setMaximum`）的插槽，您将看到相同的行为。除此之外，纯粹在 Python 端使用这个信号应该没问题。

# iphone - iPhone可重复使用的单元格在滚动时不显示更改的数据

> ID：10762812
> 
> 赞同：-1
> 
> 时间：2012-05-26T00:48:58.303
> 
> 标签：iphone, uitableview, cell, reusability

我有一个表格视图。我创建了一个方法，它使用单元格获取所需的所有数据并返回更新的单元格。在那种方法中，我有：

我的行单元格就像这样 static NSString *CellIdentifier = @"Cell";

```
UITableViewCell *cell = [tableView 
                         dequeueReusableCellWithIdentifier:CellIdentifier];
cell = myCellcreationMethod : cell : reuseIdentifier: other arguments; 
```

MycellCreation 方法是这样的：带有参数的 MycellCreation 一些字符串、单元格和重用标识符。

```
if ( cell == nil ) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:reuseIdentifier];
    //Here code that creates a custom image view something like:
    thumbnailView = [[UIImageView alloc] initWithFrame:CGRectMake(9, 9, 70, 70)];
    thumbnailView = [imUtil getImageViewWithRoundedCorners:thumbnailView andRadius:10.0];
    thumbnailView.contentMode = UIViewContentModeScaleAspectFit;
    [cell.contentView addSubview:thumbnailView];
    //same here for another image view,
    //same again
    //and there same for a UILabel
}
//Here I set in each case the data for each imageView from above and the UIlabel text like

UIImage *thumbnailImage = [imUtil getThumbnailImageWithFile:thumbnail];
thumbnailView.image = thumbnailImage;
//the others go here
textLabel.text = @"something";

return cell; 
```

所有单元格都具有相同的标识符，因为它们都属于同一类型。但是当我向下滚动时，它不会显示与列表中的下一个对象对应的数据（新缩略图新图像，uilabel 中的新文本），它会复制第一个对象。我猜它会加载重用的单元格，但不会放入新数据。

请问有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T01:43:46.283

我找到了答案。我不应该只是在我的 tableview 类中使用方法添加视图。我创建了一个新的 UITableView 子类，用我的自定义视图对其进行了初始化，并在其中创建了一个设置新数据的方法。然后使用它们两个，它就像一个魅力！

# jquery - 使用 jQuery 将输入替换为 API 的输出

> ID：10762817
> 
> 赞同：0
> 
> 时间：2012-05-26T00:49:41.470
> 
> 标签：jquery, api, http, dynamic, replace

我有一个文本框和一个提交按钮。提交表单时（按下输入或单击按钮），我希望浏览器保留在当前页面上而不重新加载任何内容。

我想从文本字段中获取输入，使用此数据联系 HTTP GET API，然后将 API 的输出返回到输入文本框中，并突出显示输出以便可以将其复制到剪贴板。

我是 jQuery 的新手，所以如果有人愿意编写这个有希望的小代码片段，将不胜感激:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T00:56:53.713

这应该适合你。你不能 ajax 跨域。

```
$(function(){
    $('#idOfForm').on('submit', function(e){
        e = e || window.event;
        e.preventDefault();
        $.ajax({
            url: 'curl.php',
            data: $(this).serialize(),
            datatype: 'post',
            success: function(data){
                //do something with returned data
                alert(data);
            }
        });
    });
}); 
```

卷曲.php：

```
$url = 'http://apiurl.com'; 
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch ,CURLOPT_POST, 1); 
curl_setopt($ch, CURLOPT_POSTFIELDS, $_POST); 
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$contents = curl_exec($ch);
$err = curl_getinfo($ch, CURLINFO_HTTP_CODE);
curl_close($ch);
echo $contents ? $contents : $err; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T00:59:48.330

```
$('#your_button_id').click(function(e){
  e.preventDefault(); //to stay on same page
  $.ajax({
    type: 'POST',
    url: 'your_url',
    data: $('#form_id').serialize(),
    success: function(response){
        //On success you will have responce from server
        //Do all yo need with buttons and texts
    }
  });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T01:00:59.657

这段代码说：

*   当表单提交...
*   不要做默认的事情（提交表格）......
*   向具有特定值的指定服务器发送 GET 请求，然后当它完成时运行一个函数...
*   将数据放入输入并...
*   选择输入中的文本。

您需要将 URL 更改`mystring`为服务器期望的任何参数，如果您有多个表单或输入，则需要指定 id 或类（例如`form#myid`或`form.myclass`）。除此之外，这应该有效。

```
$('form').submit(function(e){
    e.preventDefault();
    $.get("/url/from/get/api", {mystring: $('input').val()}, function(data, status) {
        $('input').val(data);
        $('input').select()
    });
    return false;
}) 
```

[在http://api.jquery.com/jQuery.get/](http://api.jquery.com/jQuery.get/)阅读更多内容

# java - apache commons FileUpload - 在整个文件上传之前切断大文件

> ID：10762820
> 
> 赞同：3
> 
> 时间：2012-05-26T00:50:13.800
> 
> 标签：java, apache, servlets, file-upload, size

使用 Tomcat 6，我使用 apache commons FileUpload 来允许图像上传。我可以使用 setSizeMax 和 setFileSizeMax 设置最大文件。但似乎上传了整个大文件，然后检查它是否太大。根据另一篇[文章](https://stackoverflow.com/questions/8725375/getting-file-size-apache-commons-file-upload)，似乎 setSizeMax 应该切断上传，但这不是我得到的行为。

为了测试这一点，我将 sizeMax 和 fieSizeMax 设置得很低，并上传了一个相当大的文件。上传大文件需要 15 秒，而不是几乎瞬间将其切断。

任何想法？这是一些代码，带有简化的异常子句。

```
 FileItemFactory factory = new DiskFileItemFactory();
        ServletFileUpload upload = new ServletFileUpload(factory);
        upload.setFileSizeMax(30);
        upload.setSizeMax(28);
        List items = null;
        try {
            items = upload.parseRequest(request);
        } catch (Exception e) {
            out.println("exceeded max file size..");
            return;
        } 
```

更多信息：使用 tomcat 6\. 设置 maxPostSize 不适用于内容类型：multipart/form-data。此外，再次检查请求内容长度需要上传整个文件。最后，使用 FileUpload 的 steaming api 似乎也不起作用，因为它似乎再次要求在关闭流之前上传整个文件；即使 servlet 没有将字节写入磁盘，上传也会继续。必须有一种方法可以防止使用 tomcat 6 进行大量上传，因为上传图像等对于网络应用程序来说是一项非常常见的任务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T01:18:49.533

无论您是否将它们保存在服务器上，客户端都会发送这些位。服务器没有办法告诉客户端停止发送比特，而不是强制关闭输入流（因为 HTTP 的性质：响应跟随请求——它们不是同时的）。您可以尝试这样做，但大多数应用程序服务器会在您执行 close() 时从客户端排出输入流，因此不会发生任何变化。

如果您可以控制客户端并要求使用 100-Continue（通过 Expect 标头），则您可以窥探请求的 Content-Length 并通过发送否定回复而不是 100-Continue 来拒绝它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T05:00:22.600

Tomcat 的 HTTP 连接器有一个 maxPostSize 属性。请参阅[Tomcat 文档](http://tomcat.apache.org/tomcat-6.0-doc/config/http.html)

**编辑：**太糟糕了，这不适用于多部分/表单数据。您是否考虑过使用签名的 Applet 或使用“Java Web Start”来管理上传？

# javascript - 拖放 --> 如何获取 div 的 className 放置元素的位置

> ID：10762821
> 
> 赞同：0
> 
> 时间：2012-05-26T00:50:18.307
> 
> 标签：javascript, drag-and-drop, jquery-ui-draggable

> **可能重复：**
> [Jquery Drag-Drop（将元素放入）](https://stackoverflow.com/questions/1447393/jquery-drag-drop-getting-element-being-dropped-into)

我正在制造一艘战舰，我正在制定战略。这个想法是用户拖放船只。我的代码看起来像这样。

## 我的 HTML

```
 <div id="strategyBoard" class="board">
    <h2>Define your Strategy</h2>

    <div>

        <div class="boardHeader"></div>
        <div class="boardHeader">A</div>
        <div class="boardHeader">B</div>
        <div class="boardHeader">C</div>
        <div class="boardHeader">D</div>
        <div class="boardHeader">E</div>
        <div class="boardHeader">F</div>
        <div class="boardHeader">G</div>
        <div class="boardHeader">H</div>
        <div class="boardHeader">I</div>
        <div class="boardHeader">J</div>
    </div>

    <div>

        <div>
            <div class="sideHeader">1</div>
            <div class="1A boardBody"></div>
            <div class="1B boardBody"></div>
            <div class="1C boardBody"></div>
            <div class="1D boardBody"></div>
            <div class="1E boardBody"></div>
            <div class="1F boardBody"></div>
            <div class="1G boardBody"></div>
            <div class="1H boardBody"></div>
            <div class="1I boardBody"></div>
            <div class="1J boardBody"></div>
        </div>
        <div>
            <div class="sideHeader">2</div>
            <div class="2A boardBody"></div>
            <div class="2B boardBody"></div>
            <div class="2C boardBody"></div>
            <div class="2D boardBody"></div>
            <div class="2E boardBody"></div>
            <div class="2F boardBody"></div>
            <div class="2G boardBody"></div>
            <div class="2H boardBody"></div>
            <div class="2I boardBody"></div>
            <div class="2J boardBody"></div>
        </div>
        <div>
            <div class="sideHeader">3</div>
            <div class="3A boardBody"></div>
            <div class="3B boardBody"></div>
            <div class="3C boardBody"></div>
            <div class="3D boardBody"></div>
            <div class="3E boardBody"></div>
            <div class="3F boardBody"></div>
            <div class="3G boardBody"></div>
            <div class="3H boardBody"></div>
            <div class="3I boardBody"></div>
            <div class="3J boardBody"></div>
        </div>
        <div>
            <div class="sideHeader">4</div>
            <div class="4A boardBody"></div>
            <div class="4B boardBody"></div>
            <div class="4C boardBody"></div>
            <div class="4D boardBody"></div>
            <div class="4E boardBody"></div>
            <div class="4F boardBody"></div>
            <div class="4G boardBody"></div>
            <div class="4H boardBody"></div>
            <div class="4I boardBody"></div>
            <div class="4J boardBody"></div>
        </div>
        <div>
            <div class="sideHeader">5</div>
            <div class="5A boardBody"></div>
            <div class="5B boardBody"></div>
            <div class="5C boardBody"></div>
            <div class="5D boardBody"></div>
            <div class="5E boardBody"></div>
            <div class="5F boardBody"></div>
            <div class="5G boardBody"></div>
            <div class="5H boardBody"></div>
            <div class="5I boardBody"></div>
            <div class="5J boardBody"></div>
        </div>
        <div>
            <div class="sideHeader">6</div>
            <div class="6A boardBody"></div>
            <div class="6B boardBody"></div>
            <div class="6C boardBody"></div>
            <div class="6D boardBody"></div>
            <div class="6E boardBody"></div>
            <div class="6F boardBody"></div>
            <div class="6G boardBody"></div>
            <div class="6H boardBody"></div>
            <div class="6I boardBody"></div>
            <div class="6J boardBody"></div>
        </div>
    </div>
</div>

<div class="shipsBoard"> The Boats
  <div class="Ship"> <p>Destroyer: </p>
        <div><img src="/assets/images/ships/destroyer.png"  id="destroyer" width="70px" height="35px"/></div>
    </div>
    <div class="Ship"> <p>Patrol Ship: </p>
        <div><img src="/assets/images/ships/patrolShip.png"  id="patrolShip" width="70px" height="35px"/></div>
    </div>
    <div class="Ship"> <p>Aircraft Carrier: </p>
        <div><img src="/assets/images/ships/aircraftCarrier.png"  id="aircraftCarrier" width="175px" height="35px"/></div>
    </div>
    <div class="Ship"> <p>Battleship: </p>
        <div><img src="/assets/images/ships/battleship.png"  id="battleship" width="140px" height="35px"/></div>
    </div>
    <div class="Ship"> <p>Submarine: </p>
        <div><img src="/assets/images/ships/submarine.png" id="submarine" width="105px" height="35px"/></div>
    </div>

</div> 
```

## 我的

```
 var value = 0;
  $( "#aircraftCarrier, #battleship, #destroyer, #patrolShip, #submarine" ).draggable({ revert: "invalid"});
  $("#aircraftCarrier, #submarine, #patrolShip, #destroyer, #battleship").rotate({
     bind:
       {
             click: function(){
           value +=90;
           $(this).rotate({ animateTo:value})

             }
       }

  });

  $( "#strategyBoard .boardBody" ).droppable({

     drop: function(event, ui) {
      var position=event.target.className;
      alert(position);
      },
       hoverClass: "hoverClass"
  }); 
```

## 我的 CSS

我使用较少

```
 /* ===== Board Game CSS ========================================================
      Author: Team n&n
      ========================================================================== */

   #strategyRoom{
     width: 100%;
     min-height: 768px;
     background: url("/assets/images/batallaNaval.jpg");
     background-position:50% 50%;
     background-repeat: no-repeat;
     font-size: 16px;
   }

   #strategyBoard {
     float: left;
     margin-left: 50px;
   }

   .shipsBoard {
     color: black;
     float: right;
     padding: 40px;
     background-color: gray;
     .Border-radius;
     margin: 50px;

   }

   .hoverClass{
       opacity: 0.4;
   }
   .boardHeader {
       color: white;
    margin: 10px;
   }

   .sideHeader {
       width: 20px;
       padding: 0;
       color: white;
   } 
```

我的问题是，我怎样才能获得所有删除 div 的类名！丢弃的元素是一个大小为 2 o 3 o 4 o 5 div boardBody 的图像，具体取决于船。实际上，我只有鼠标指向的类名。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T02:16:11.150

我建议使用[JqueryUI 的 droppable 插件](http://jqueryui.com/demos/droppable/#default)，非常容易使用

[在此处](http://jsfiddle.net/KnDmz/1/)查看我的演示。当将 div 拖放到目标中时，它的类会显示在警报框中。请注意，由于插件的功能，其他类被添加到您的可拖动 div 中。

# php - 使用 PHP 计数器并希望使用 3 的倍数

> ID：10762822
> 
> 赞同：0
> 
> 时间：2012-05-26T00:50:29.397
> 
> 标签：php

我有这个代码here

```
<?php
$COUNT = 0;
if ($handle = opendir('.')) {
while (false !== ($entry = readdir($handle))) {
    if ($entry != "." && $entry != ".." & $count % 3 == 0) {
        echo "<td><a href='$entry'>$entry</a></td>";
        echo $Count;
        $Count++;

    }
    else {echo "<tr><td><a href='$entry'>$entry</a></td><tr>";
    echo $Count;
    $Count++;
    }
}
closedir($handle);
}
?> 
```

我似乎无法让它工作。每次计数器是 3 的倍数时，我都想要一个新的表格行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T00:52:55.963

您在脚本中调用`$COUNT`,`$Count`和`$count`，就像它们是同一个变量一样。他们不是。PHP 变量区分大小写。将它们全部更改为`$count`，它*应该可以*工作。

如果您打开 error_reporting 以便它报告通知，就像您在开发中应该经常做的那样，您会很快发现这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T00:57:38.533

除了@John Conde：使用`&&`而不是`&`

# python - 如何在不暂停其他功能的情况下暂停一个 pygame 功能？

> ID：10762823
> 
> 赞同：0
> 
> 时间：2012-05-26T00:50:37.763
> 
> 标签：python, pygame

所以我有一个函数（如下），我想每 2 秒更改一次变量。目前，该函数每 2 秒更改一次变量 (goblinx)。问题是 time.wait 导致所有函数暂停 2 秒。我怎么可能只有函数 movegoblin() 暂停。

```
def movegoblin():
    global goblinx
    global gobliny
    x = 1
    if x == 1:
        goblinx += 32
        pygame.time.wait(200) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T04:43:26.647

去这里的方法是改进你的地精？（和其他角色）在你的程序中从函数到适当的类的处理，这样它们就可以有内部状态。

每个此类它们都可以具有在每个游戏帧更新的变量，并且当计数达到一个值时触发一个动作。

这个解决方案比仅仅为了计时而添加并发线程更干净，并且正确地完成，可以导致应用程序设计，这将是开发、扩展和维护的一种幸福。

您可以采用的样式的简短示例，保留代码中的功能。（请注意，您可以使用 pygame.sprite.Sprite 类为每个对象组自动调用“更新”方法 - 我将在下面从头开始）

帧延迟 = 20

```
class Goblin(object):
    def __init__(self):
        self.x = 1 #or whatever
        self.y = 1 #or whatever
        self.movement_count = 0
        self.move_at_each = 10

    def move(self):
        self.movement_count += 1
        if self.movement_count < self.move_at_each:
            return
        self.movement_count = 0
        self.x += 32 
```

在你的主循环中，你实例化一个妖精，做：

`goblin = Goblin()`, 在进入 while 循环之前，并 `goblin.move()`在每一帧调用。通过这种方式，您可以拥有一个适当的地精类，这将允许您在游戏中拥有多个“地精” - 而您示例中的代码将要求您对每个角色进行硬编码。您只需在游戏的每一帧调用“goblin.move”方法。上面的示例被调整为每 10 帧移动一次，但您可以更改它（并且可以为您实例化的每个单独的地精更改它）。

正如我所说，pygame 已经提供了“Sprite”和“sprite groups”类作为这种机制的框架，但是在一些较小的游戏中滚动你自己的类将帮助你更好地了解需求以及 pygame sprites 已经提供的内容，因此您可以在以后的项目（或该项目的后期）中使用它们

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T17:02:12.430

最简单的答案：

每帧在你的地精上调用一个 .update() 函数。如果时间流逝 >= 200 毫秒，则移动他。否则什么也不做。

```
class Unit():
    def __init__(self):
        self.update_delay = 200
        self.last_update = pygame.time.get_ticks()

    def update(self):
        # call once per game update.
        now = pygame.time.get_ticks()
        if now - self.last_update >= self.update_delay:
            self.last_update = now

            # update AI , pathfind , etc.
            self.x += 30 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T16:24:22.003

我认为大多数人首先会想到的答案是：“你想错了！” ——如果你遵循传统的游戏开发方法，这实际上是正确的；jsbueno 和猴子向您展示了您通常如何去那里。

我只想指出一个 python 项目，它试图以解决问题的方式给出解决方案。主张是：现实世界是并发的，因此您应该以并发的方式对其进行建模（您的直观方法是并发的这一事实支持这一点）。

问题是，在问题上使用真正的多线程方法肯定会给您带来比它解决的问题更多的问题，因为您必须考虑竞争条件等（因此在 sajatack 的答案中使用互斥锁）。此外，如果您的游戏中有数百个精灵/对象，则数百个线程的开销（这不是一个很高的数字，如果您想开始思考大的话，请考虑那里的数万个）对于处理它的糟糕计算机来说很可能是矫枉过正的.

这就是为什么有些人开始了一个名为[stackless python](http://www.stackless.com/)的项目。他们想提供一种工具，让您*无需*多线程即可以并发方式编程！有了它，您可以按照您的建议进行编程，让一个功能等待，而其他功能继续运行。*他们称为微*线程背后的概念还有一篇很好的文章[介绍了编程中的并发思维](http://www.grant-olson.net/python/intro-to-stackless-python/browsable-html)。您可能想查看该项目，但这可能会给您带来几个问题：

1.  您将需要不同版本的 python 解释器。Stackless 不在标准的 c-python 和 pypy 中，而且很可能不会很快出现。
2.  您使用不同的解释器这一事实将使分发任何用 stackless python 编写的游戏变得更加困难。
3.  您可能会学习一种不常见的游戏编程方式——这在未来的某个时候可能很重要（或者可能不重要）。在与现实生活中的程序员交谈或阅读现有游戏的资源时可能会给您带来问题。先做一些*经典*的游戏编程或者在无堆栈的基础上做一些可能是个好主意。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-26T01:25:01.937

```
import _thread    
_thread.start_new_thread(movegoblin, ()) 
```

或者如果你喜欢

```
import threading
threading.Thread(target=movegoblin).start() 
```

带锁：

```
mutex = _thread.allocate_lock()
def movegoblin():
    global goblinx
    global gobliny
    x = 1
    if x == 1:
        mutex.acquire()
        goblinx += 32
        pygame.time.wait(200)
        mutex.release() 
```

# prolog - 河内塔（河内塔）

> ID：10762824
> 
> 赞同：2
> 
> 时间：2012-05-26T00:50:46.293
> 
> 标签：prolog, towers-of-hanoi

我正在尝试解决河内塔问题，到目前为止我已经尝试过：

```
move(1,[H|T],B,C,A1,B1,C) :-  
  A1 = T,
  B1 = [H|B].
move(N,A,B,C,A1,B1,C) :- 
N>1, 
M is N-1, 
move(M,[H|T],C,B,A1,B1,C), 
move(1,[H|T],B,_,A1,B1,C), 
move(M,C,B,[H|T],A1,B1,C). 
```

但是这段代码不起作用，我需要得到的结果是这样的：

```
?-move(3,[1,2,3],[],[],A1,B1,C).
  and the results:
  A1=[].
  B1=[1,2,3]
  C=[]. 
```

有人可以帮我修复我的代码并得到这样的结果吗？这对我来说很重要，我真的需要帮助。这就是我所做的，但有一些问题：

```
move(N,[H|T],[],[],A1,B1,C) :-
      N > 1,
      M is N - 1,   
      move(N,[H|M],[H|_],[],A1,B1,C),
      move(M,[_|M],[H|_],[H|_],A1,B1,C),
      move(M,[_|M],[],[H|T],A1,B1,C),
      move(M,[],[_|T],[H|T],A1,B1,C),
      move(M,[H|_],[_|T],[H|T],A1,B1,C),
      move(M,[H|_],[_|T],[],A1,B1,C),
      move(M,[],[H|T],[],A1,B1,C).
      move(N,[H|T],[],[]) :- write(A1), nl,
                             write(B1), nl,
                             write(C). 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T01:09:47.640

这是解决河内塔问题的指令。

```
 move(1,X,Y,_) :-  
        write('Move top disk from '), 
        write(X), 
        write(' to '), 
        write(Y), 
        nl. 
    move(N,X,Y,Z) :- 
        N>1, 
        M is N-1, 
        move(M,X,Z,Y), 
        move(1,X,Y,_), 
        move(M,Z,Y,X). 
```

以这样的方式解决问题：在指令解决方案中，我们不会更改 X、Y 或 Z 的内容。但在您的问题中，您最终会更改它们的内容。

更新：由于声明这不是作业问题，因此这是完整的答案：

```
towersOfHanoi(N,A,B,C,A4,B4,C4) :- move(N,A,B,C,A4,B4,C4),!.

move(1,[H|T],B,C,A1,B1,C1) :-  A1 = T,
                               B1 = [H|B],
                               C1 = C.
move(N,A,B,C,A4,B4,C4) :-   N>1, 
                            M is N-1, 
                            move(M,A,C,B,A1,C1,B1), 
                            move(1,A1,B1,C1,A2,B2,C2), 
                            move(M,C2,B2,A2,C4,B4,A4). 
```

# javascript - 在 DIV 内水平居中对象

> ID：10762825
> 
> 赞同：-1
> 
> 时间：2012-05-26T00:50:55.057
> 
> 标签：javascript

我试图将一个按钮水平居中在一个 div 中，但没有运气：

```
var x = document.createElement("div"); // the div container
x.style.backgroundColor = "red";
x.style.width = "200px";
x.style.height = "200px";   
document.body.appendChild(x);

var y = document.createElement("input"); // the button to be centered inside div "x"
y.type = "button";
y.value = "test button";
y.style.marginLeft = "auto";
y.style.marginRight = "auto";
x.appendChild(y); 
```

我试着做`y.style.textAlign = "center"`，`"y.style.margin = "auto 0"`。我究竟做错了什么？

[http://jsfiddle.net/5tffD/1/](http://jsfiddle.net/5tffD/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T00:55:29.397

做这个：

```
x.style.textAlign = 'center'; 
```

**现场演示：http:** [//jsfiddle.net/5tffD/3/](http://jsfiddle.net/5tffD/3/)

无法单独对齐元素。您只能通过`text-align`在包含文本行的元素（在本例中为 DIV 元素）上设置属性来将文本行作为一个整体对齐。

请注意这与`vertical-align`属性有何不同，后者*确实*使您能够单独对齐元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T14:41:34.497

这里有几种居中的方法：

1）div内的任何东西：

```
<div align="center"> text or smth </div> 
```

2）对于文本（也可能是图像）：

```
<center> text </center> 
```

3) 对于帧或图像

```
<img style="display:block;margin-left:auto;margin-right:auto;" align="center" src="imageee.jpg" /> 
```

4）只是定位正确：

```
<div style="width:80%;margin-left:10%;"> content </div> 
```

# iphone - 如何在 UITableViewCell 中有一个可编辑的多 UITextView

> ID：10762827
> 
> 赞同：1
> 
> 时间：2012-05-26T00:51:20.080
> 
> 标签：iphone, objective-c, uitableview

我在 UITableViewCell 子类中有一个 UITextView 。获得文本视图和单元格的新高度没有问题。我遇到的问题是告诉 UITableView 更新。

我已经实现`heightForRowAtIndexPath:`了在 TextView 展开时返回单元格的实时高度。

但是某处`[tableView beginUpdates]; [tableView endUpdates]; 必须调用。

如何？我应该向设置为 UITableViewController 子类的 UITableViewCell 添加一个委托属性吗？然后在单元格扩展高度并且Tableview需要更新时发送委托消息？在 UITableViewCell 和 Controller 之间有一个委托似乎有点奇怪？

我尝试使用 NSNotificationCenter，但我有不止一个可编辑单元格，而且不止一个这种性质的表格视图。所以没有办法只注册单元格的通知而不复制和粘贴同一行，这不好（因为单元格是在 IB 中创建的，而不是在数组或集合中），并且有多个tableviews 表示另一个表视图发生异常，因为它被告知要更新但没有任何变化。

我已经看到了很多关于这个主题的问题和答案，但是当谈到更新 tableview 时，他们都只是说“现在更新 tableview”而不是如何。那么我如何告诉他从其中一个单元格更新表格视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T01:11:59.637

我认为这种行为最好在`UITableViewController`而不是视图本身（`UITableViewCell`）中实现。

您的控制器负责设置单元格高度，并且通常是您`UITextView`的 's 的代表，所以让它处理所有这些。

在您的`textViewDidChange`方法中，确定单元格的新高度应该是多少，更新您的数据结构以反映这一点，然后调用`reloadRowsAtIndexPaths:withRowAnimation:`以使其实际更改。

**编辑：**
因此，由于您不喜欢我的第一个建议，因此另一种方法是将`recommendedRowHeight`属性添加到您的 custom `UITableViewCell`。

然后，您可以通过以下方式观察此属性，也可以使用`UITableViewController`以下方法实现委托协议：

```
- (void)recommendedRowHeightDidChange
// or 
- (void)recommendedRowHeightDidChangeTo:(CGFloat)newHeight 
```

然后，当您的身高发生变化时，`recommendedRowHeight`如果您走那条路线，请更新您的属性并调用您的委托方法。

无论哪种方式，一旦你的控制器发现一个单元格的推荐行高已经改变，它就可以做它应该做的事情。更新反映当前行高的数据结构，然后调用`reloadRowsAtIndexPaths:withRowAnimation:`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T04:06:58.267

您可以将 tableview 控制器对象添加为对 tableview 单元类的弱引用。在 tableview 控制器中，您可以有一个从 tableview 单元类调用的方法。

# java - 删除字符串中的最后一次出现

> ID：10762831
> 
> 赞同：5
> 
> 时间：2012-05-26T00:52:07.650
> 
> 标签：java, string

我正在尝试将字符串修剪为单个逗号分隔单词字符串中特定单词的第一次出现。例如：

```
deleteLastOccurrence("foo,bar,dog,cat,dog,bird","dog") 
```

应该返回

```
"foo,bar,dog" 
```

我有以下内容，但它似乎无法正常工作：

```
public String deleteLastOccurrence(String original, String target){
    String[] arr = original.split(",");
    arr = Arrays.copyOfRange(arr, Arrays.asList(arr).indexOf(target), original.length()-1);
    path = StringUtils.join(pathArray,",");
} 
```

对更简单的方法有什么建议吗？提前致谢...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-26T00:59:49.237

Use regex replace:

```
public static String deleteLastOccurrence(String original, String target){
    return original.replaceAll("(,)?\\b" + target + "\\b.*", "$1" + target);
} 
```

This code also works when the target is the first or last word in the original (hence the regex syntax `\b` which means "word boundary")

Also, rename your method to `deleteAfterFirstOccurrence()`, because your current name is misleading: The "last occurrence" is irrelevant to what you want.

Here's a little test:

```
public static void main(String[] args) {
    // Test for target in middle:
    System.out.println(deleteLastOccurrence("foo,bar,dog,cat,dog,bird,dog", "dog"));
    // Test for target at start:
    System.out.println(deleteLastOccurrence("dog,bar,dog,cat,dog,bird,dog", "dog"));
    // Test for target at end:
    System.out.println(deleteLastOccurrence("foo,bar,cat,bird,dog", "dog"));
} 
```

Output:

```
foo,bar,dog
dog
foo,bar,cat,bird,dog 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T01:19:35.480

更新：仔细查看问题并意识到我写了方法的名称，而不是 OP 想要的结果。所以，它只是摆脱了最后一次出现，而不是在它之后修剪。那好吧！:)

根据您的风格，您可能认为这并不简单。但是，这是一个有趣的问题。我认为这段代码更清晰一些。

```
public class ReplaceLast {

public String deleteLastOccurrence(String fromThis, String word){
    int wordLength = word.length();
    if(fromThis.startsWith(word + ",")){
        return fromThis.substring(wordLength + 1);
    }
    if(fromThis.endsWith("," + word)){
        return fromThis.substring(0, fromThis.length() - wordLength - 1);
    }
    int index = fromThis.lastIndexOf("," + word + ",");
    if(index == -1){
        return fromThis;
    }
    return fromThis.substring(0, index) + fromThis.substring(index+word.length() + 1);
}
@Test
public void testNotThere() {
    String actual = deleteLastOccurrence("foo,bar,dog,cat,dog,bird","moose");
    assertEquals("foo,bar,dog,cat,dog,bird", actual);
}
@Test
public void testMiddle() {
    String actual = deleteLastOccurrence("foo,bar,dog,cat,dog,bird","dog");
    assertEquals("foo,bar,dog,cat,bird", actual);
}

@Test
public void testFirst() {
    String actual = deleteLastOccurrence("foo,bar,dog,cat,dog,bird","foo");
    assertEquals("bar,dog,cat,dog,bird", actual);
}

@Test
public void testLast() {
    String actual = deleteLastOccurrence("foo,bar,dog,cat,dog,bird","bird");
    assertEquals("foo,bar,dog,cat,dog", actual);
}

@Test
public void testSubword() {
    String actual = deleteLastOccurrence("foo,bar,dog,cat,dog,bird","bir");
    assertEquals("foo,bar,dog,cat,dog,bird", actual);
}
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T20:06:55.120

我试图解决在特定单词第一次出现时修剪字符串的问题，我并不关心`deleteLastOccurrence`IMO 误导的方法的原始名称 ()。

对我来说，只匹配单个单词而不匹配子词的技巧是在句子前后添加两个逗号，然后用逗号检查单词。

即将 `",dog,"`检查`",foo,bar,dog,cat,dog,bird,"`是否存在。

```
package gicappa;

public class So {
    public static String trimSentenceOnFirstOccurrenceOf(String sentence, String word) {
        if (word.isEmpty()) return sentence;

        if (!addCommasAround(sentence).contains(addCommasAround(word))) return sentence;

        return trimAddedCommasOf(substringOfSentenceUntilEndOfWord(addCommasAround(sentence), addCommasAround(word)));
    }

    public static String substringOfSentenceUntilEndOfWord(String string, String word) {
        return string.substring(0, string.indexOf(word) + word.length());
    }

    public static String trimAddedCommasOf(String string) {return string.substring(1,string.length()-1);}

    public static String addCommasAround(String s) {return "," + s + ","; }
} 
```

如果你喜欢我用于 TDD 的一些测试，我们开始吧：

```
package gicappa;

import org.junit.Test;

import static gicappa.So.trimSentenceOnFirstOccurrenceOf;
import static org.hamcrest.core.Is.is;
import static org.hamcrest.core.IsEqual.equalTo;
import static org.junit.Assert.assertThat;

public class SoTest {
    @Test
    public void it_returns_the_same_sentence_for_empty_word() {
        assertThat(trimSentenceOnFirstOccurrenceOf("foo,bar,dog,cat,dog,bird", ""), is(equalTo("foo,bar,dog,cat,dog,bird")));
    }

    @Test
    public void it_returns_the_same_sentence_for_not_contained_word() {
        assertThat(trimSentenceOnFirstOccurrenceOf("foo,bar,dog,cat,dog,bird", "s"), is(equalTo("foo,bar,dog,cat,dog,bird")));
    }

    @Test
    public void it_returns_the_first_word() {
        assertThat(trimSentenceOnFirstOccurrenceOf("foo,bar,dog,cat,dog,bird", "foo"), is(equalTo("foo")));
    }

    @Test
    public void it_returns_the_same_sentence_if_is_matched_the_last_word() {
        assertThat(trimSentenceOnFirstOccurrenceOf("foo,bar,dog,cat,dog,bird", "bird"), is(equalTo("foo,bar,dog,cat,dog,bird")));
    }

    @Test
    public void it_trims_after_the_end_of_the_first_matched_word() {
        assertThat(trimSentenceOnFirstOccurrenceOf("foo,bar,dog,cat,dog,bird", "dog"), is(equalTo("foo,bar,dog")));
    }

    @Test
    public void it_does_not_trim_for_a_subword_of_a_contained_word() {
        assertThat(trimSentenceOnFirstOccurrenceOf("foo,bar,dog,cat,dog,bird", "do"), is(equalTo("foo,bar,dog,cat,dog,bird")));
    }

    @Test
    public void it_does_not_trim_for_a_subword_of_an_already_contained_word() {
        assertThat(trimSentenceOnFirstOccurrenceOf("dog,foozzo,foo,cat,dog,bird", "foo"), is(equalTo("dog,foozzo,foo")));
    }
} 
```

对更多 OO 类的冗长重构也可能是：

```
package gicappa;

public class Sentence {
    private String s;

    public Sentence(String sentence) {
        this.s = sentence;
    }

    public String trimOnFirstOccurrenceOf(String word) {
        if (word.isEmpty() || csvSentenceContainsWord(word)) return s;

        return substringSentenceToEndOf(word);
    }

    private String substringSentenceToEndOf(String word) {
        return addCommasTo(s).substring(1, addCommasTo(s).indexOf(addCommasTo(word)) + addCommasTo(word).length()-1);
    }

    private boolean csvSentenceContainsWord(String word) {
        return !addCommasTo(s).contains(addCommasTo(word));
    }

    public static String addCommasTo(String s) {return "," + s + ",";}
} 
```

用法如下：

```
new Sentence("dog,foozzo,foo,cat,dog,bird").trimOnFirstOccurrenceOf("foo"), is(equalTo("dog,foozzo,foo")) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-26T01:18:00.583

这是非正则表达式版本的尝试：

```
public String trimTo(String in, String matchNoCommas) {
   if (in.startsWith(matchNoCommas + ","))  // special check here...
      return matchNoCommas;
   int idx = in.indexOf("," + matchNoCommas+ ",");
   if (idx < 0)
      return in;
   return in.substring(0, idx + matchNoCommas.length()+1);
} 
```

提供与@Bohemian 的正则表达式版本相同的结果。你的电话哪个更容易理解。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-26T16:52:20.690

也许我错了，但这不是吗？

```
public trimCommaSeparatedListToIncludeFirstOccurrenceOfWord(String listOfWords, String wordToMatch) {
    int startOfFirstOccurrenceOfWordToMatch = listOfWords.indexOf(wordToMatch);
    int endOfFirstOccurrenceOfWordToMatch = startOfFirstOccurrenceOfWordToMatch + wordToMatch.length() - 1;

    return listOfWords.substring(0, endOfFirstOccurrenceOfWordToMatch);
} 
```

现在这可能不是 OP 想要的，但我认为这是 OP 所要求的。示例：`f("doggy,cat,bird", "dog")`将返回`"dog"`.

对于全字匹配，我会像其他人建议的那样对吸盘进行正则表达式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-26T01:01:00.273

How about this:

```
public String deleteLastOccurrence(String original, String target){
    return original.replace("(^|,)" + target + "(,|$)", "");
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-26T20:28:29.960

gonzoc0ding，在阅读了所有回复后，恕我直言，您的做法更简单、更干净，但应以这种方式更正：

```
public String deleteLastOccurrence(String original, String target){
    String[] arr = original.split(",");
    arr = Arrays.copyOfRange(arr,0, Arrays.asList(arr).indexOf(target));
    path = StringUtils.join(arr,",");
} 
```

但也许我没有理解你的要求......

# puppet - 自定义挂载点不适用于 puppet

> ID：10762834
> 
> 赞同：2
> 
> 时间：2012-05-26T00:52:24.360
> 
> 标签：puppet

我在 RHEL 6.2 上运行 Puppet 2.7.14（主节点和节点都具有此配置）。

对于我的生活，我无法弄清楚为什么我不能让自定义挂载点工作。

例如，如果我编辑 /etc/puppet/fileserver.conf 以包含以下内容：

```
[foo]
    path /etc/puppet/files/foo
    allow * 
```

并将文件 bar.txt 放入 /etc/puppet/files/foo/bar.txt

然后我希望以下资源可以毫无问题地解决：

```
file { "bar.txt":
    ensure => present,
    path => "/var/foo/bar.txt",
    source => "puppet:///foo/bar.txt",
} 
```

但这不起作用！我一直看到如下错误消息：

```
... Could not evaluate: Could not retrieve information from environment production source(s) puppet:///foo/bar.txt ... 
```

根据我读过的所有文档，我已经正确地做到了这一点，但我就是无法让它工作。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T04:46:00.653

似乎这里有一个“陷阱”。路径或允许属性之前的制表位是不允许的。非常令人惊讶。

# javascript - Javascript Google 地图，仅显示 100 个标记中的 10 个。有限制吗？

> ID：10762839
> 
> 赞同：2
> 
> 时间：2012-05-26T00:53:46.787
> 
> 标签：javascript, google-maps-api-3, geocoding

这是链接：[http ://alchemist3d.com/maptest.html](http://alchemist3d.com/maptest.html)

我也在循环中使用地理编码器来获取地址数组的坐标，这里是代码：

```
function initialize() {
  var list = [
  {location:"residencial punta del sol casa 6  temixco Morelos Mexico",body : " 1", title : "m 1"},
  {location:"prol. harris num. 23 ampl. bugambilias jiutepec Morelos Mexico",body : "ampl. bugambilias 2", title : "f 2"},
  {location:"Gladiola Satelite Cuernavaca Morelos Mexico",body:"Montes de Oca"}
  ];
  var latlng = new google.maps.LatLng(18.92009,-99.20611);
  var myOptions = {
    zoom: 12,
    center: latlng,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
  //map.fitBounds(getBounds());
  codeLocations(list, map);
}

function codeLocations(list, map) {
  for (var i = 0; i < list.length; i++) {
    //console.log("Looping " + list[i].location);
    var geocoder = new google.maps.Geocoder();
    var geoOptions = {
      address: list[i].location,
      bounds: getBounds(),
      region: "NO"
    };
    geocoder.geocode(geoOptions, createGeocodeCallback(list[i], map));
  }
}

function createGeocodeCallback(item, map) {
  //console.log("Generating geocode callback for " + item.location);
  return function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
      //console.log("Geocoding " + item.location + " OK");
      addMarker(map, item, results[0].geometry.location);
    } else {
      //console.log("Geocode failed " + status);
    }
  }
}

function addMarker(map, item, location) {
  //console.log("Setting marker for " + item.location + " (location: " + location + ")");
  var marker = new google.maps.Marker({ map : map, position : location});
  marker.setTitle(item.title);
  var infowindow = new google.maps.InfoWindow( {
    content : item.body,
    size : new google.maps.Size(100, 300)
  });
  new google.maps.event.addListener(marker, "click", function() {
    infowindow.open(map, marker);
  });
}

function getBounds() {
  var myOptions = {
    zoom: 23,
    center: new google.maps.LatLng(-33.9, 151.2),
    mapTypeId: google.maps.MapTypeId.ROADMAP
  }
  var southwest = new google.maps.LatLng(17.920,-100.206);
  var northeast =new google.maps.LatLng(19.920,-104.206);
  return new google.maps.LatLngBounds(southwest, northeast);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T01:22:14.280

是的，有一个速率限制，没有很好的记录。每秒 9-10 个请求？如果您检查错误状态，则称为 OVER_QUERY_LIMIT。有 100 个标记，我认为常见的等待技术不会对你有多大好处，因为你有很多标记。最好进行一次地理编码，保存 LatLng 并使用它们。

如果你有勇气，你可以试试：

```
setTimeout(function(){
  geocoder.geocode(geoOptions, createGeocodeCallback(list[i], map));
}, 200*i); 
```

我不知道为什么每个人都使用 200 毫秒，也许是反复试验？您可以尝试 150 或 100。不过，在 100 毫秒时，加载 100 个标记需要 10 秒。我读到的另一个想法是批量查询。地理编码十个，等等，然后再十个。

您可以尝试的另一个功能是`sleep`.

```
function sleep(milliSeconds) {
  var startTime = new Date().getTime();
  while (new Date().getTime() < startTime + milliSeconds);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T09:12:05.343

Lilina 对速率限制的看法是正确的，但可以根据您是否犯规来改变速率。200 毫秒可能一直没问题，但另请参阅[这个链接的问题](https://stackoverflow.com/questions/10062624/google-map-v3-only-some-markers-are-displayed)，其中有一个变化速率的示例，它开始比这更快（实际上只减慢到 150 毫秒左右）。

那里讲述的问题与您的问题**完全相同**。

[Google Map V3：只显示一些标记](https://stackoverflow.com/questions/10062624/google-map-v3-only-some-markers-are-displayed)

# dojo - Dojo 1.4.2 Tree Grid“展开点击”事件？坚持状态？

> ID：10762842
> 
> 赞同：0
> 
> 时间：2012-05-26T00:54:28.227
> 
> 标签：dojo, treegrid

问题：

给定一个 DOJO TreeGrid，当用户单击 expando ("+") 按钮以展开一行并存储特定行号或关联项目的标识符时，我如何捕获事件？我想这样做是为了从 DOM 中完全删除 TreeGrid，重建它，并在重建后恢复它的状态（即以编程方式扩展用户先前扩展的行）。

背景：

所以我有一个自定义 DOJO TreeGrid，连接到自定义 QueryReadStore，在我的应用程序中。它是使用以下教程构建的：

[http://www.ibm.com/developerworks/web/library/wa-dojotreegrid/index.html?ca=drs-](http://www.ibm.com/developerworks/web/library/wa-dojotreegrid/index.html?ca=drs-)

非常有趣的教程，但它可能与我的问题无关，因为它并没有真正压缩任何功能，它似乎只是增强了它。

无论如何，谷歌搜索了一下，我在 DOJO 论坛中发现了一个不错的函数，我可以使用它以编程方式扩展一行，给定特定的行索引。完美运行。

问题是我一直无法找到捕获expando click 事件并将其与网格中特定的“父项行”索引相关联的好方法。

抛开细节不谈，我想将用户展开的每一行的行索引放入一个数组中（并删除用户折叠的行的索引，显然），这样我就可以销毁这个 TreeGrid，并忠实地重建它，随着用户的选择正确扩展。

我不是 DOJO 的新手，但我绝对不是专家。我已经进行了相当多的谷歌搜索和 FireBugging，但还没有真正找到可以用来执行此操作的任何东西。

建议？以前有人做过类似的事情吗？愚蠢的问题，我错过了明显的答案？我完全被误导了，一切都错了吗？谢谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T10:22:29.933

与此类似的东西可能会起作用，这就是 dijit.Tree 实现的样子；

```
var expandedNodes = {}
dijit.tree._onExpandoClick = function (args /* object wrap for args.node */) {
   var treeNode = args.node,
       path = treeNode.getTreePath(),
       id = treeNode.getIdentity();

   expandedNodes[id] = path;

} 
```

我不是 100% 确定我是严格正确的，但对于 TreeGrid，您必须查看**dojox/grid/_TreeView.js**的代码（[链接](http://svn.dojotoolkit.org/src/dojox/trunk/grid/_TreeView.js)）。这`_setOpen`将是一个入口点，您可以从中“挂钩” onclick 操作。从那里找到`expandoCell.openStates`哈希，这是一个真/假变量集，由 itemId 索引。这个散列很可能是你需要的*状态*

# ios - 将带有按钮的 UIScrollview 保存到 NSuserdefaults

> ID：10762845
> 
> 赞同：0
> 
> 时间：2012-05-26T00:54:47.260
> 
> 标签：ios, uiscrollview, uibutton, nsmutablearray

我有一个充满按钮的滚动视图，这些按钮也在 NSMutableArray 中，如何使用按钮保存滚动视图，以便它们加载到视图中并加载。我有一个加载按钮并将它们放入滚动视图的功能，我有一个删除按钮的功能。所以这是滚动视图的结束状态及其需要保存的按钮。如果我可以保存数组，那没关系，因为我有一个 createButton 函数，它接受一个 NSString 并在滚动视图中创建一个按钮并将对象添加到数组中，所以我想我可以有 2 个数组，但这没有用，我' 相当新，所以我认为可能有一些非常好的方法可以做到这一点。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T22:39:32.787

使用 NSUserDefaults，你会这样做。这就是你如何只保存一个数组：

```
[[NSUserDefaults standardUserDefaults] setObject:yourArray forKey:@"SavedArray"]; 
```

然后加载它：

```
yourArray = [[NSUserDefaults standardUserDefaults] objectForKey:@"SavedArray"]; 
```

或者您可以分别保存按钮位置和按钮标题：

为了节省...

```
[[NSUserDefaults standardUserDefaults] setObject:titlesArray forKey:@"Titles"];
[[NSUserDefaults standardUserDefaults] setObject:locationsArray forKey:@"Locations"]; 
```

并加载...

```
titlesArray = [[NSUserDefaults standardUserDefaults] objectForKey:@"Titles"]; 
locationsArray = [[NSUserDefaults standardUserDefaults] objectForKey:@"Locations"]; 
```

NSUserDefaults 实际上非常酷，它们是多么简单。我希望这有帮助。

# javascript - 用javascript计算行数

> ID：10762848
> 
> 赞同：4
> 
> 时间：2012-05-26T00:55:00.940
> 
> 标签：javascript, string

我需要修剪动态文本，以便从中摘录 2 行（预告片）。问题在于，在 div 中显示字符串的行数取决于所使用的字符（例如，“w”和 i“将不具有相同的宽度）、浏览器和操作系统（Mac 上的字体是不完全等于 Windows 上的相同字体）。

有没有办法在 javascript 中修剪比 div 中的 x 行更长的文本（知道 div 长度是固定的）？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T01:01:47.657

you can use something like that [http://jsfiddle.net/cSTzn/](http://jsfiddle.net/cSTzn/) by using `overflow: hidden;` and proper `height`

EDIT: made update with link on the bottom right, customize as necessary [http://jsfiddle.net/cSTzn/1/](http://jsfiddle.net/cSTzn/1/)

# php - Slow query on remote database

> ID：10762856
> 
> 赞同：0
> 
> 时间：2012-05-26T00:56:57.850
> 
> 标签：php, sql, adodb, freetds

I have:

*   A linux server with PHP 5.3.2 and Apache 2.0
*   A windows Server with SQL SERVER

I connect my linux server with database with unixODBC 2.3.1 and FREETDS 0.9.1

The connection is okay but the queries are slow. Here is my code that generate the image below:

```
$this->adodb->LogSQL(true); // turn on logging
$query = "select c.name, t.name, c.length from syscolumns c join systypes t on t.xusertype = c.xusertype
          join sysobjects o on o.id=c.id where o.name = 'CONDOMINIO'";
$res = $this->adodb->Execute($query);
$this->adodb->LogSQL(false); // turn off logging
$perf = NewPerfMonitor($this->adodb);
echo $perf->SuspiciousSQL();
echo $perf->ExpensiveSQL(); 
```

[Image http://www.vigoonline.net/slow.png](http://www.vigoonline.net/slow.png)

As you can see, the first query has an average time of 4.68 seconds, which is way too slow.

If I execute the same query like this:

```
$this->adodb->_query($query); 
```

Then the time to execute the query takes less than a second what is great. Has anyone else experienced the same thing?

The query called with "Execute" is used for the own class for bringing the "MetaColumns" information from the table

The table "CONDOMINIO" only has 21 rows.

If the server database is in the same machine with the application script, then the response is fast!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T14:43:36.207

我自己解决了这个问题。这是我所做的：

转到文件`/adodb/drivers/adodb-odbc.inc.php`和班级`ADODB_odbc`

在这里尝试找到：

```
var $curmode = SQL_CUR_USE_DRIVER 
```

并将其更改为：

```
var $curmode = SQL_CUR_USE_IF_NEEDED; 
```

这将使连接`SQL_CUR_USE_ODBC`在需要时使用，并且“瞧”数据库对 SQL 服务器的访问速度非常快！

# git - brew update：以下未跟踪的工作树文件将被合并覆盖：

> ID：10762859
> 
> 赞同：374
> 
> 时间：2012-05-26T00:58:03.450
> 
> 标签：git, homebrew

我尝试运行`brew update`，但如果我合并我的本地更改将会丢失。我尝试提交我的本地更改（不记得做过任何更改，但已经有一段时间了），这让事情变得更糟。

这是输出：

```
MBP:Library User$ sudo brew update
error: The following untracked working tree files would be overwritten by merge:
    Library/Aliases/fastcgi
    Library/Aliases/htop
    Library/Aliases/nodejs
    Library/Aliases/ocio
    Library/Aliases/oiio
    Library/Aliases/pgrep
    Library/Aliases/pkill
    Library/Contributions/cmds/brew-beer.rb
    Library/Contributions/cmds/brew-dirty.rb
    Library/Contributions/cmds/brew-graph
    Library/Contributions/cmds/brew-grep
    Library/Contributions/cmds/brew-leaves.rb
    Library/Contributions/cmds/brew-linkapps.rb
    Library/Contributions/cmds/brew-man
    Library/Contributions/cmds/brew-mirror-check.rb
    Library/Contributions/cmds/brew-missing.rb
    Library/Contributions/cmds/brew-pull.rb
    Library/Contributions/cmds/brew-readall.rb
    Library/Contributions/cmds/brew-server
    Library/Contributions/cmds/brew-services.rb
    Library/Contributions/cmds/brew-switch.rb
    Library/Contributions/cmds/brew-test-bot.commit.html.erb
    Library/Contributions/cmds/brew-test-bot.css
    Library/Contributions/cmds/brew-test-bot.index.html.erb
    Library/Contributions/cmds/brew-test-bot.rb
    Library/Contributions/cmds/brew-tests.rb
    Library/Contributions/cmds/brew-unpack.rb
    Library/Contributions/cmds/brew-which.rb
    Library/Contributions/install_homebrew.rb
    Library/Formula/abcl.rb
    Library/Formula/abyss.rb
    Library/Formula/akka.rb
    Library/Formula/apollo.rb
    Library/Formula/appledoc.rb
    Library/Formula/arangodb.rb
    Library/Formula/autoconf.rb
    Library/Formula/automake.rb
    Library/Formula/avidemux.rb
    Library/Formula/bind.rb
    Library/Formula/bsdconv.rb
    Library/Formula/bsdmake.rb
    Library/Formula/camellia.rb
    Library/Formula/cbmbasic.rb
    Library/Formula/cdo.rb
    Library/Formula/checkstyle.rb
    Library/Formula/cifer.rb
    Library/Formula/clhep.rb
    Library/Formula/collada-dom.rb
    Library/Formula/crash.rb
    Library/Formula/crossroads.rb
    Library/Formula/css-crush.rb
    Library/Formula/curlftpfs.rb
    Library/Formula/dart.rb
    Library/Formula/dasm.rb
    Library/Formula/dfc.rb
    Library/Formula/di.rb
    Library/Formula/dsniff.rb
    Library/Formula/dupx.rb
    Library/Formula/dwatch.rb
    Library/Formula/eprover.rb
    Library/Formula/ext2fuse.rb
    Library/Formula/ezlupdate.rb
    Library/Formula/f3.rb
    Library/Formula/fastx_toolkit.rb
    Library/Formula/fceux.rb
    Library/Formula/findbugs.rb
    Library/Formula/freerdp.rb
    Library/Formula/funcoeszz.rb
    Library/Formula/fwknop.rb
    Library/Formula/gabedit.rb
    Library/Formula/gbdfed.rb
    Library/Formula/gconf.rb
    Library/Formula/git-encrypt.rb
    Library/Formula/glm.rb
    Library/Formula/gmap-gsnap.rb
    Library/Formula/gnu-arch.rb
    Library/Formula/gnunet.rb
    Library/Formula/gobby.rb
    Library/Formula/gptfdisk.rb
    Library/Formula/griffon.rb
    Library/Formula/grok.rb
    Library/Formula/gtk-chtheme.rb
    Library/Formula/gtkglextmm.rb
    Library/Formula/gtmess.rb
    Library/Formula/hg-flow.rb
    Library/Formula/hqx.rb
    Library/Formula/htop-osx.rb
    Library/Formula/htpdate.rb
    Library/Formula/imap-uw.rb
    Library/Formula/iozone.rb
    Library/Formula/ipbt.rb
    Library/Formula/ipe.rb
    Library/Formula/ispc.rb
    Library/Formula/ispell.rb
    Library/Formula/jigdo.rb
    Library/Formula/jing.rb
    Library/Formula/jless.rb
    Library/Formula/jpeginfo.rb
    Library/Formula/konoha.rb
    Library/Formula/legit.rb
    Library/Formula/libcouchbase.rb
    Library/Formula/libcuefile.rb
    Library/Formula/libextractor.rb
    Library/Formula/libglademm.rb
    Library/Formula/libgtextutils.rb
    Library/Formula/libinfinity.rb
    Library/Formula/libkate.rb
    Library/Formula/libqalculate.rb
    Library/Formula/libqglviewer.rb
    Library/Formula/libreplaygain.rb
    Library/Formula/libtool.rb
    Library/Formula/libvbucket.rb
    Library/Formula/libvo-aacenc.rb
    Library/Formula/libxmi.rb
    Library/Formula/lifelines.rb
    Library/Formula/makeicns.rb
    Library/Formula/mathgl.rb
    Library/Formula/meld.rb
    Library/Formula/mesalib-glw.rb
    Library/Formula/minisat.rb
    Library/Formula/minuit2.rb
    Library/Formula/mobile-shell.rb
    Library/Formula/movgrab.rb
    Library/Formula/mp3cat.rb
    Library/Formula/mpich2.rb
    Library/Formula/mrfast.rb
    Library/Formula/musepack.rb
    Library/Formula/ndiff.rb
    Library/Formula/net6.rb
    Library/Formula/nrpe.rb
    Library/Formula/nuttcp.rb
    Library/Formula/oath-toolkit.
Updating aa07533..3f070ef
Aborting
Error: Failed while executing git pull  origin refs/heads/master:refs/remotes/origin/master 
```

* * *

## 回答 #1

> 赞同：743
> 
> 时间：2012-08-20T03:15:27.310

不要忘记获取原点：

```
cd /usr/local/Homebrew
git fetch origin
git reset --hard origin/master 
```

发生的情况是您正在尝试更新 brew，但 brew 本身不是最新的（可能），通过某些操作系统更新发生了权限更改（也可能），或者 brew 稍微损坏（不太可能）。由于 brew 本身是一个 git repo，因此您必须将 brew 更新或重置为 master 分支版本。brew [默认] 位于`/usr/local/Homebrew`文件夹中，所以你

1.  转到该文件夹​​[第一个命令]，它也应该更新权限（如果没有见下文）
2.  获取原点 [第二条命令]，这意味着更新 brew 远程分支的本地版本
3.  基于远程主分支（也使用您当前的权限）的硬重置 [3rd command]。

`chown`如果您在非 sudo 或管理员配置文件中，您也可以使用第一个命令

```
sudo chown -R `whoami` /usr/local/Homebrew
cd /usr/local/Homebrew
git reset --hard origin/master 
```

要了解 git reset，请查看[这篇文章](http://git-scm.com/2011/07/11/reset.html)。

* * *

## 回答 #2

> 赞同：107
> 
> 时间：2012-05-26T01:28:26.397

几周前我遇到了类似的问题，试图更新旧的自制软件安装。这样做：

```
git reset --hard origin/master 
```

为`/usr/local`我修好了。

似乎其他人也有这个问题。您是否查看过[这里](https://github.com/mxcl/homebrew/issues/5128)提出的任何解决方法？

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-05-04T10:03:04.013

我正在添加我的个人经验，因为它似乎比 2012 年提出的更安全：

1.  运行`brew doctor`。
2.  如果您收到以下警告：

    ```
    Warning: The /usr/local directory is not writable. 
    ```

    跑：

    ```
    sudo chown -R `whoami` /usr/local 
    ```

    修复权限问题（也由 Chris Frisina 建议）。最终`brew doctor`再次运行以确保警告消失。

3.  现在，你应该有一个

    ```
    Warning: You have uncommitted modifications to Homebrew 
    ```

    可以通过以下方式解决

    ```
    cd /usr/local/Library && git stash && git clean -d -f 
    ```

    正如 Dr.Brew 本身所建议的那样。该命令存储未提交的修改，以便您可以在需要时返回并恢复它们。这似乎比`git reset --hard origin/master`我更安全。

4.  如果您愿意，如果此处和其他 SO 用户建议的步骤不能解决您的问题，请查看[官方故障排除指南。](https://github.com/Homebrew/homebrew/blob/master/share/doc/homebrew/Common-Issues.md#brew-update-complains-about-untracked-working-tree-files)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-27T13:07:18.577

类似的答案，但如果您有不再跟踪的文件，则需要额外的步骤，因此从`/usr/local`运行

```
git fetch origin
git clean -f
git reset --hard origin/master 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-15T00:14:25.500

这种方法可能比某些方法更简单。它涉及：

*   修复 git 问题，以便您可以再次将更改的管理委派给它。
*   无需手动移动文件或目录。
*   无需手动调整文件或目录权限。

步骤（为需要解释的人提供注释）：

```
cd $(brew --repository)                              // see Note 1 below
git remote add brew https://github.com/Homebrew/brew // see Note 2 below
git pull brew master                                 // promising fast-forward report!
brew update                                          // see Note 3 below 
```

概述：
据我所知，这个问题的实际原因是 repo url 发生了变化。现在`brew`和过去`brew.git`。（完整的最新网址：[https](https://github.com/Homebrew/brew) ://github.com/Homebrew/brew ）

注意 1：第一个命令将您从文件结构中的任何位置带到正确的目录。对我来说，目录结构与上面显示的其他人（Mac OS 10.11.16）不同，但是使用此命令，这些差异应该无关紧要。

注意 2：第二个命令将正确的远程 url 添加到新别名；我这样做是为了以防这种方法没有完成我想要的并且我再次需要以前的地址。由于新的遥控器工作正常，我会邀请其他人评论简单地更改以来源为别名的 url。我很乐意更新答案以反映对您有用的方法。

注意 3：这第四条命令完全符合预期的结果：它报告了大量更新，包括特别好的报告“==> Migrated HOMEBREW_REPOSITORY to /usr/local/Homebrew!” （强调他们的）。

# python - VideoCapture filename

> ID：10762864
> 
> 赞同：-1
> 
> 时间：2012-05-26T00:58:47.083
> 
> 标签：python, python-2.7, python-imaging-library, video-capture

I'm new here, this is my first post. I'm having a problem in VideoCapture: I want the names of the pictures i take change automaticaly in a "for" function and to save the pictures in a directory of my choice, but i couldn't figure out what i have to do and didn't find it on internet. If anyone knows, please, help me. Here is an example of the command lines:

```
from VideoCapture import Device
cam = Device()
cam.saveSnapshot('here i want to call a variable, but i don't know how.jpg') 
```

So this is it. I also don't know where i have to write the directory.

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T01:02:59.467

In C++ you'd usually you'd put together you string with an `ostringstream`, something like this:

```
std::ostringstream filename;

for (int i=0; i<10; i++) {
    filename << "variable: " << i << ".jpg";
    cam.saveSnapshot(filename.str().c_str());
} 
```

It's not entirely clear what parts you're doing with C++ (if any) and what with Python though...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T01:19:55.280

该`saveSnapshot()`方法采用文件名，因为它是第一个非`self`参数。
参考：http: [//videocapture.sourceforge.net/html/VideoCapture.html](http://videocapture.sourceforge.net/html/VideoCapture.html)

这意味着您可以执行以下操作：

```
import os
from VideoCapture import Device

save_dir = '/path/to/my/img/dir' # or for windows: `c:/path/to/my/img/dir` 
img_file_name = 'an_image.jpg'

cam = Device()
cam.saveSnapshot( os.path.join(save_dir, img_file_name) ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T04:45:40.840

好的，这很容易。

```
from VideoCapture import Device
from os.path import join, exists
# We need to import these two functions so that we can determine if
# a file exists.

import time
# From your question I'm implying that you want to execute the snapshot
# every few seconds or minutes so we need the time.sleep function.

cam = Device()

# First since you want to set a variable to hold the directory into which we
# will be saving the snapshots.
snapshotDirectory = "/tmp/" # This assumes your on linux, change it to any 
# directory which exists.

# I'm going to use a while loop because it's easier...
# initialize a counter for image1.jpg, image2.jpg, etc...
counter = 0

# Set an amount of time to sleep!
SLEEP_INTERVAL = 60 * 5 # 5 minutes!

while True:

    snapshotFile = join(snapshotDirectory, "image%i.jpg" % counter)
    # This creates a string with the path "/tmp/image0.jpg"
    if not exists(snapshotFile):
        cam.saveSnapshot(snapshotFile)
        time.sleep(SNAPSHOT_INTERVAL)
    # if the snapshot file does not exist then create a new snapshot and sleep
    # for a few minutes.

    #finally increment the counter.
    counter = counter + 1 
```

就是这样，那应该完全符合您的要求。

# php - 使用 Temando API 创建预订

> ID：10762869
> 
> 赞同：3
> 
> 时间：2012-05-26T00:59:41.047
> 
> 标签：php, soap

我正在测试 Temando API 并尝试创建预订。我已按照他们的手册 Temando API R1_11 开发人员指南给出的说明进行操作。

我的问题是，当我使用以下必需信息创建调用 makeBookingByRequest 时：任何东西、任何地方、任何时间、一般、来源、目的地、报价、付款、说明、评论、促销代码。

它返回错误 500：内部服务器错误。如果这与许可有关，我已经解决了。

顺便说一下，这是我的其余代码：

```
ini_set("soap.wsdl_cache_enabled", "1");
$client = new SoapClient("https://training-api.temando.com/schema/XXXX/server.wsdl", array('soap_version' => SOAP_1_2));

$username = "xxxxxxxxxx";
$password = "xxxxxxxxxx";

$headerSecurityStr = "<Security><UsernameToken><Username>".$username."</Username><Password>".htmlentities($password)."</Password></UsernameToken></Security>";

$headerSecurityVar = new SoapVar($headerSecurityStr, XSD_ANYXML);

$soapHeader = new SoapHeader('wsse:http://schemas.xmlsoap.org/ws/2002/04/secext', 'soapenv:Header', $headerSecurityVar);

$client->__setSoapHeaders(array($soapHeader));

$destination = array();
$destination["destinationCountry"] = "AU";
$destination["destinationCode"] = "2000";
$destination["destinationSuburb"] = "Sydney";
$destination["destinationIs"] = "Residence";
$destination["destinationResPostalBox"] = "N";
$destination["destinationResUnattended"] = "N";
$destination["destinationResInside"] = "N";
$destination["destinationResLimitedAccess"] = "N";
$destination["destinationResHeavyLift"] = "N";

$origin = array();
$origin["originDescription"] = "ABC Suppliers";
$origin["originBusUnattended"] = "N";
$origin["originBusInside"] = "N";
$origin["originBusHeavyLift"] = "N";
$origin["originBusTailgateLifter"] = "N";
$origin["originBusContainerSwingLifter"] = "N";

$quote = array();
$quote["totalPrice"] = "110.00";
$quote["basePrice"] = "100.00"; 
$quote["tax"] = "10.00";
$quote["currency"] = "AUD";
$quote["deliveryMethod"] = "Off-peak";
$quote["etaFrom"] = "2";
$quote["etaTo"] = "3"; 
$quote["guaranteedEta"] = "Y";

$payment = array();
$payment["paymentType"] = "Credit Card";
$payment["cardType"] = "Mastercard";
$payment["cardExpiryDate"] = "05-2010";
$payment["cardNumber"] = "5163190000000000";
$payment["cardName"] = "JANE DOE";

$comments = "No Comment";
$reference = "ABC200000";

$makeBookingByRequest = array();
$makeBookingByRequest["anything"] = $anything1;
$makeBookingByRequest["anytime"] = $anytime;
$makeBookingByRequest["anywhere"] = $anywhere;
$makeBookingByRequest["general"] = $general;
$makeBookingByRequest["origin"] = $origin;
$makeBookingByRequest["destination"] = $destination;
$makeBookingByRequest["quote"] = $quote; 
$makeBookingByRequest["payment"] = $payment; 
$makeBookingByRequest["instructions"] = $instructions;
$makeBookingByRequest["comments"] = $comments; 
$makeBookingByRequest["reference"] = $reference; 

$anythings = array();

$anything1 = array();
$anything1["class"] = "Freight";
$anything1["mode"] = "Less than load";
$anything1["packaging"] = "Carton";
$anything1["qualifierFreightGeneralFragile"] = "N"; 
$anything1["distanceMeasurementType"] = "Centimetres"; 
$anything1["weightMeasurementType"] = "Kilograms";
/** get the data below from POST DATA **/
$anything1["length"] = "30";
$anything1["width"] = "10";
$anything1["height"] = "10";
$anything1["weight"] = "10";
$anything1["quantity"] = "1";
$anything1["description"] = "Contains bottle lids and liquors.";
/*****************/

array_push($anythings, $anything1);

$anywhere = array();
$anywhere["itemNature"] = "Domestic";
$anywhere["itemMethod"] = "Door to Door";

$anywhere["originCountry"] = "AU";
$anywhere["originCode"] = "4000";
$anywhere["originSuburb"] = "Brisbane";
$anywhere["originIs"] = "Business";
$anywhere["originBusUnattended"] = "N";
$anywhere["originBusDock"] = "Y";
$anywhere["originBusForklift"] = "N";
$anywhere["originBusLoadingFacilities"] = "N";
$anywhere["originBusInside"] = "N";
$anywhere["originBusLimitedAccess"] = "N";
$anywhere["originBusHeavyLift"] = "N";
$anywhere["originBusTailgateLifter"] = "N";
$anywhere["originBusContainerSwingLifter"] = "N";

$anywhere["destinationCountry"] = "AU";
$anywhere["destinationCode"] = "2000";
$anywhere["destinationSuburb"] = "Sydney";
$anywhere["destinationIs"] = "Residence";
$anywhere["destinationResPostalBox"] = "N";
$anywhere["destinationResUnattended"] = "N";
$anywhere["destinationResInside"] = "N";
$anywhere["destinationResLimitedAccess"] = "N"; 
$anywhere["destinationResHeavyLift"] = "N";

$anytime = array();
$anytime["readyDate"] = "2012-06-01";
$anytime["readyTime"] = "PM";

$general = array();
$general["goodsValue"] = "2000.00"; 
```

调用方法：

```
try{
    $makeBookingByRequestResponse = $client->makeBookingByRequest($makeBookingByRequest);
    p($makeBookingByRequestResponse);
}catch (SoapFault $exception){
    p($exception);
// Nothing is done with the exception yet. Will be processed later in the display code.
}

function p($arr){
    echo '<pre>';
    print_r($arr);
    echo '</pre>';  
} 
```

有没有人有使用 Temando API 的经验？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T08:21:33.830

尝试使用[soapUI](http://www.soapui.org/)创建您的 SOAP 请求。它是一个免费软件，对处理 SOAP Web 服务非常有用。当它工作时，您可以专注于使用 PHP 构建此请求。

# php - 如何在php数组中获取具有最高值的键

> ID：10762879
> 
> 赞同：-5
> 
> 时间：2012-05-26T01:02:22.960
> 
> 标签：php

我有这个数组...

```
Array (
[1168] => 46
[6973] => 27
[4585] => 24
[1224] => 23
[2010] => 20
[7514] => 19
[1167] => 17
[8349] => 7
[2476] => 7
[5313] => 7
[1208] => 2
) 
```

我需要在前一个数组中获取三个具有最高值的键（作为值）：

```
Array (
[0] => 1168
[1] => 6973
[2] => 4585
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T01:04:36.173

数组是否总是按降序排序？如果没有，你需要`arsort($arr)`先：

```
$highest_keys = array_keys(array_slice($arr, 0, 3)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T01:14:30.367

编辑：

```
$a = array('foo' => 3, 'bar' => 2, 'fuz' => 1, 'baz' => 0);
$k = array_keys(array_slice($a, 0, 3));
print_r($k); 
```

[键盘](http://codepad.org/gOGSa0BL)

# database - CakePHP 函数不更新表

> ID：10762888
> 
> 赞同：0
> 
> 时间：2012-05-26T01:04:05.443
> 
> 标签：database, cakephp

大家好，当试图更新我的数据库时，这个函数没有从表中获取 id，也没有更新表中的那一行。它也抛出一个错误

```
$this->Relationship->id = $this->request->data['id']; 
```

这是完整的功能

```
public function approve($id=null){
        $this->Relationship->id = $id;
        if($this->request->is('get')){
        $this->request->data=$this->Relationship->read();}
        $this->Relationship->id = $this->request->data['id'];
        if($this->Relationship->save($this->request->data)) {
        $this->Session->setFlash('Your Relationship has been updated.');
        $this->redirect(array('action' => 'request'));
        } else {
            $this->Session->setFlash('Unable to update your post.');
        }
    }
    } 
```

这是表格/视图

```
<?php
echo $this->Form->create('Relationship', array('action'=>'approve'));
echo $this->Form->input('expirydate',array('label'=>'Expiry Date: ', 'class' => 'dateclass')); 
echo $this->Form->end('Submit');

?> 
```

我试图用这个函数做的是获取一个 id，并编辑该条目中的两个字段

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T05:52:13.483

`$this->request->data['Relationship']['id'];`如果您正确设置表单，应该是这样。另外，你可以做

```
$this->Relationship->create($this->request->data);
$this->Relationship->save() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T13:48:40.350

```
 public function approve($id=null){
        $this->set('title_for_layout', 'Relationships');
        $this->set('stylesheet_used', 'homestyle');
        $this->set('image_used', 'eBOXLogoHome.jpg');   
        $this->layout='home_layout';

        if ($this->request->is('get')) {
        $this->request->data = $this->Relationship->read(NULL, $id);

        } else {
        //sets active to 1
         $this->Relationship->read(null, $id);
         $this->Relationship->set(array('active' => true,));
        if ($this->Relationship->save($this->request->data)) {

            $this->Session->setFlash('Your post has been updated.');
            $this->redirect(array('action' => 'request'));
        } else {
            $this->Session->setFlash('Unable to update your post.');
        }
    }
} 
```

我还必须在数据库中将 tinyint 从 0=>1 更改。我遇到的另一个问题是我的请求视图，它没有将 id 传递给批准函数。一旦我将代码更改为此它就可以工作

```
<?php foreach($Relationships as $relationship):?>
                    <tr> 

                        <td align='center'><?php echo $relationship['Relationship']['partyone']; ?></td>
                        <td align='center'><?php echo $relationship['Relationship']['partytwo']; ?></td>
                        <td> </td>
                        <td><?php echo $this->Html->link($relationship['Relationship']['partyone'], array('action'=>'approve', $relationship['Relationship']['id'])); ;?>
                        </td>

                    </tr>
                <?php endforeach; ?>

            </table> 
```

# c# - change the size of writeablebitmap

> ID：10762891
> 
> 赞同：2
> 
> 时间：2012-05-26T01:04:51.700
> 
> 标签：c#, windows-phone-7, xaml

I was wondering if it was possible to change the size of a WriteableBitmap in WP7\. I have noticed that the default size is 640x480, and my windows phone application is in Portrait mode, so I would like the height of my writeablebitmap (which I am using to overylay a live grayscale camera image) could be increased accordingly (while ofcourse keeping the same aspect ratio). I have not been able to find anything regarding this anywhere?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T20:00:51.303

为什么不[使用相关的构造函数](http://msdn.microsoft.com/en-us/library/dd901609%28v=vs.95%29.aspx)创建所需大小的位图呢？

# html - 使用 Swift Mailer 将 html 和 css 邮件发送到 gmail

> ID：10762892
> 
> 赞同：7
> 
> 时间：2012-05-26T01:05:14.710
> 
> 标签：html, css, email, gmail, swiftmailer

我有一些基本的 html 和一些 css，但出于某种原因，gmail 将**3D**信息放在“text/css”中

代码示例

```
$message = "
            <style type='text/css'>
              #main {border:1px solid red;}
            </style>

              <div id='main'>some text</div>
"; 
```

但是当我查看原始发送到 gmail

```
<style type=3D'text/css'> 
```

也许这就是邮件没有样式的原因。我正在使用快速邮件

// 同样在 html 中

```
<div id=3D'main'> 
```

// 快速邮件

```
 $type = $message->getHeaders()->get('Content-Type');
    $type->setValue('text/html');
    $type->setParameter('charset', 'utf-8'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T02:08:55.130

据我所知，gmail 不支持头部或正文中的样式标签。我在发送电子邮件时使用元素的样式属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-09-09T20:31:50.523

让 swift mailer 以 HTML 格式发送消息，即使是 gmail ，因为 swift mailer 将 html 标签转义为其表示的字符，所以你需要这样写这些行：

```
$message = (new Swift_Message('Message Subject HERE '))
        ->setFrom(array('sender email' => 'Sender Name')) // can be $_POST['email'] etc...
        ->setTo(array('reciever email' => 'Receiver Name')) // your email / multiple supported.
        ->setEncoder( new Swift_Mime_ContentEncoder_PlainContentEncoder('8bit'))
        ->setBody($template, "text/html"); 
```

在那之后，每件事都应该正常工作，这里的诀窍是直到 swift mailer 使用 Swift mailler MimeType 类并指向正确的编码。您可以在此处查看更多信息[链接](https://swiftmailer.symfony.com/docs/messages.html#setting-the-encoding)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-24T12:17:03.750

斯威夫特梅勒正试图逃避“到\”。你必须在 setBody() 之前使用 setEncoder()：

```
$message->setEncoder(Swift_Encoding::get8BitEncoding());
$message->setBody($body, "text/html"); 
```

# c++ - Designing sets of data and support class extension OO approach, in c++

> ID：10762894
> 
> 赞同：0
> 
> 时间：2012-05-26T01:05:52.683
> 
> 标签：c++

i'm currently working on a project and something came up on the design. I have a class named Key which is composed of several Fields. This Field class it's a mother class and their sons like Age, Name, etc implement Field. Inside the Key class there's an attribute which is an array of Fields, to hold different kinds of Fields.

```
class Key {
private:
Field * fieldList; 
```

}

I'm working on a team and a design choice came up that i couldn't defend cause i didn't knew how to answer to the following problem... or maybe the lack of it? I trust that you'll be able to open my mind on this.

The purpose of this Key class is to hold several fields. The existence of this class is because i'm going to handle data of this kind.

(Name, Age....)

This is how i thought it would look already implemented:

```
Key myKey = Key();
Age newAge = Age(50);
myKey.add(newAge); 
```

This is what the prototype of the add method of the Key class would look like:

```
void Key::add(Field); 
```

As you may have assumed, since the Key class has an array of Field's this method receives a Field and since Age is also Field, cause of inheritance, then this works like a charm. Same can be said of the Name class and other classes that could come up in the future.

This is the same idea as in a database where you have rows with data and the columns belong to the attributes, so a same column has the same type of attribute.

We would also like to compare 2 Key's only by one of the Fields, for example:

Let's say i have 2 Key's with this data:

(John, 50) <- myKey1

(Paul, 60) <- myKey2

My method to do this would look like this:

```
myKey1.compareTo(myKey2, 2) 
```

This would answer if the 2nd attribute of the first myKey1 is bigger, equal or less than the one on the second myKey2.

There's a problem with this. When i used the add method, i randomly added Field's of different types, say Age first, then Name second, etc to the Key object. My Key object added them to it's internal array by order of appearance. So when i use the compareTo method, nothing is assuring me that inside both objects, the 2nd elements of their arrays will have a Field say, the Name Field, and therefore if that were not to be true, it could be comparing a Name with Age, cause inside it only holds an array of Field's, that are equal type as long the Key class knows.

This was my approach to my solution, but what i couldn't answer is, how to fix this problem.

Another member of my team proposed, that we implement a method for the key class for each of the existing fields, that is:

```
myKey.addAge(newAge);
myKey.addName(newName); 
```

Inside it would still have the Field array but this time, the class can assure you that Age will go in the 1st place of the array, and that Name would go in the 2nd position of the array, cause each method would make sure of it.

The obvious problem with this, is that i would have to add a method for each type of Field that exists. That means that if in the future i wish to add say "born date" and so creating the new Date class, i'll have to add a method addDate, and so on and so on... Another reason my team member gave me is that, "we can't trust an exterior user that he will add the Fields the way they're supposed to be ordered" when pointing why my approach was bad.

So to conclude:

*   On the first approach, the Key class depends on the programmer that added Fields, to make sure they have the order they should, but as a benefit no need to add a method for each type of field.

*   On the second approach, the Key class makes sure the order is the right one, by implementing a method for each type Field that exists, but then, by each type of new Field created, the class would grow bigger and bigger.

Any ideas with this? is there a workaround for this?

Thanks in advance, and i apologize if i wasn't clear with it, i'll add new details if needed.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T02:56:44.047

扩展 @tp1 的 Field 类中的 ID 字段和枚举的绝妙想法，您实际上可以使其非常灵活。如果您愿意将字段类型的数量限制为 32，您甚至可以将一组标志作为`CompareTo`. 然后您可以同时比较多个字段。这种方法有意义吗？

# ruby-on-rails - bootstrap sass 2 -- custom.css.scss.css 404 not found

> ID：10762895
> 
> 赞同：-3
> 
> 时间：2012-05-26T01:06:23.210
> 
> 标签：ruby-on-rails

I'm not able to get the bootstrap sass 2.0.0 to work with rails. The application layout does not change even after following the tutorial of Micheal Hartl which is by using rails 3.2\. I have tried all the possible changes.

```
Started GET "/assets/custom.css.scss.css" for 127.0.0.1 at 2012-05-26 03:42:45 +0300
Served asset /custom.css.scss.css - 404 Not Found (7ms)

ActionController::RoutingError (No route matches [GET] "/assets/custom.css.scss.css"):
actionpack (3.2.3) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.3) lib/rails/rack/logger.rb:26:in `call_app'
railties (3.2.3) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.1) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.3) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.1) lib/rack/lock.rb:15:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.3) lib/rails/engine.rb:479:in `call'
railties (3.2.3) lib/rails/application.rb:220:in `call'
rack (1.4.1) lib/rack/content_length.rb:14:in `call'
railties (3.2.3) lib/rails/rack/log_tailer.rb:14:in `call'
rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'

Rendered c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/middleware/templates/rescues/routing_error.erb within rescues/layout (1.0ms) 
```

This is the thing which comes when run the rails server:

```
Started GET "/assets/application.js?body=1" for 127.0.0.1 at 2012-05-26 03:42:45 +0300
Served asset /application.js - 304 Not Modified (0ms)
[2012-05-26 03:42:45] WARN  Could not determine content-length of response body. Set content-leng
th of the response or set Response#chunked = true

Started GET "/assets/rails.png" for 127.0.0.1 at 2012-05-26 03:42:45 +0300
Served asset /rails.png - 304 Not Modified (0ms)
[2012-05-26 03:42:45] WARN  Could not determine content-length of response body. Set content-leng
th of the response or set Response#chunked = true 
```

How do I fix this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T05:12:31.860

将您的文件重命名为`custom.css.scss`

# ruby-on-rails - 使用 Capybara/Rspec 使用 will_paginate Gem 测试视图

> ID：10762896
> 
> 赞同：2
> 
> 时间：2012-05-26T01:06:35.037
> 
> 标签：ruby-on-rails, ruby-on-rails-3, capybara, will-paginate, railstutorial.org

做 Michael Hartl 的 Rails 教程，[第 10 章，第 5 节，练习 2](http://ruby.railstutorial.org/chapters/user-microposts#sec%3amicropost_exercises)。我 - 非常简单 - 尝试编写测试以确保使用 will_paginate gem（这似乎是 Hartl 测试分页是否有效的首选方法）出现在几个页面上的分页 div，但是当我添加以下代码时..

```
subject { page }
.
.
.
it { should have_selector('div.pagination') } 
```

..它返回..

```
 1) UserPages profile page 
     Failure/Error: it { should have_selector('div.pagination') }
       expected css "div.pagination" to return something 
```

这特别奇怪，因为在这个特定的 _spec 文件中，相同的 Rspec 代码在某些测试中通过而在其他测试中失败（我将在下面突出显示）。div也`pagination`出现在我浏览器的源代码中，当然它工作正常。

因为它在某些地方而不是其他地方失败，所以我不得不假设这在某种程度上是一个“范围” - 或与相关的分配类型问题`will_paginate`- 你看，对于失败的测试，分页的内容实际上是“Microposts”的一部分” 控制器，但被测试的页面/视图由“用户”控制器处理。对于通过测试，视图和控制器都是“用户”。

这可能是问题吗？也有可能我的 FactoryGirl 设置/调用被破坏并且由于某种原因没有触发测试中的分页代码。我是 Rails n00b - 实际上对编程完全陌生 - 所以谢谢你们。:)

（另外，ps，我如何使我的代码在 SO 上变得丰富多彩和漂亮？）

**/spec/requests/user_pages_spec.rb**

```
require 'spec_helper' # Omitted from below - I don't think this is relevant.

describe "UserPages" do

  subject { page }

  describe "index" do # This is the block where it is PASSING..

    let(:user) { FactoryGirl.create(:user) } # I'll include my /spec/factories.rb file below

    before(:all)  { 30.times { FactoryGirl.create(:user) } }
    after(:all)   { User.delete_all } # I'll omit my /app/models/user.rb file - I don't think it's relevant to the problem

    before do
      valid_signin user # References /spec/support/utilities.rb to sign in as a valid user, but I will omit this since this is part of the working tests
      visit users_path # This is /app/views/users/index.html.erb - this is where SUCCESSFUL pagination testing occurs
    end

    describe "pagination" do

      it { should have_selector('div.pagination') } #PASS!! As I would expect
  .
  .
  .
  end

  describe "profile page" do
    let(:user) { FactoryGirl.create(:user) }
    let!(:m1) { FactoryGirl.create(:micropost, user: user, content: "Awesome")} # Used for other tests
    let!(:m2) { FactoryGirl.create(:micropost, user: user, content: "Sauce") } # Used for other tests

    before(:all)  { 30.times { FactoryGirl.create(:micropost) } } # Is this constructed properly? Perhaps the posts are not created, and that's why the failure to render the paginate code in test.
    after(:all)   { user.microposts.delete_all } # I have tested with and without this line of code - it fails both ways.

    before { visit user_path(user) } # /app/views/users/show.html.erb

    it { should have_selector('div.pagination') } # FAIL!!! This is the line in question that generates the error above.
    .
   .
  .
 .
end 
```

**/app/views/users/index.html.erb**（分页在现场工作，测试工作也）

```
<%= provide(:title, 'All users') %>
<h1>All users</h1>

<%= will_paginate %>

<ul class="users">
  <%= render @users %>
</ul>

<%= will_paginate %> 
```

**/app/views/users/show.html.erb**（分页在现场工作，测试失败）

```
<% provide(:title, @user.name) %>
<div class="row">
.
.
.
  <div class="span8">
    <% if @user.microposts.any? %>
      <h3>Microposts (<%= @user.microposts.count %>)</h3>
      <ol class="microposts">
        <%= render @microposts %>
      </ol>
      <%= will_paginate @microposts %> # Here is where I declare that pagination should occur on @microposts, NOT @users
    <% end %>
  </div>
</div> 
```

**/spec/requests/factories.rb**

```
FactoryGirl.define do
  factory :user do
    sequence(:name)   { |n| "Person #{n}" }
    sequence(:email)  { |n| "person_#{n}@example.com" }
    password  "secret"
    password_confirmation "secret"

    factory :admin do
      admin true
    end
  end

  factory :micropost do
    content "Lorem ipsum"
    user
  end
end 
```

**/宝石文件**

```
source 'https://rubygems.org'

gem 'rails', '3.2.3'
gem 'pg', '0.12.2'
gem 'bootstrap-sass', '2.0.0'
gem 'bcrypt-ruby', '3.0.1'
gem 'faker', '1.0.1'
gem 'will_paginate', '3.0.3'
gem 'bootstrap-will_paginate', '0.0.6'

group :development do
    gem 'guard-rspec', '0.5.5'
    gem 'annotate', '~> 2.4.1.beta'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '3.2.4'
  gem 'coffee-rails', '3.2.2'
  gem 'uglifier', '1.2.3'
end

gem 'jquery-rails', '2.0.0'

group :test, :development do
  gem 'rspec-rails', '2.9.0'
end

group :test do
    gem 'capybara', '1.1.2'
    gem 'rb-fsevent', '0.4.3.1', :require => false
    gem 'growl', '1.0.3'
    gem 'guard-spork', '0.3.2'
    gem 'spork', '0.9.0'
    gem 'factory_girl_rails', '1.4.0'
end 
```

**编辑：发现[这篇文章与 will_paginate 和 view testing 相关](http://mislav.uniqpath.com/rails/will_paginate-view-testing/)，但不诚实地理解它（可能是由于语法）.. 它可能有某种关联吗？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-26T20:01:05.493

当您使用：

```
before(:all)  { 30.times { FactoryGirl.create(:user) } } 
```

您已经创建了一个用户，因此总计数上升到 31，因此它分页（默认情况下，使用 will_paginate 的分页显示每页 30 条记录）。

尝试创建**31**个微博而不是 30 个，应该可以通过。

```
before(:each) { 31.times { FactoryGirl.create(:micropost, user: user) } } 
```

**编辑：**我忘记将 :user 传递给 micropost 工厂，它现在应该可以工作（是我测试中的代码并且它通过了）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T22:38:33.177

根据[http://thewebfellas.com/blog/2008/8/3/roll-your-own-pagination-links-with-will_paginate](http://thewebfellas.com/blog/2008/8/3/roll-your-own-pagination-links-with-will_paginate)

`"<%= will_paginate %>`" 生成带有 的 div 标签`class = pagination`，但我没有看到任何暗示通过测试的内容`'div.pagination'`。

我将测试更改为

```
it { should have_selector('div', class: 'pagination') } 
```

这应该基本上测试同样的事情，这对我来说是通过的。希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T18:00:55.383

```
<%= provide (:title, 'All users') %>
<h1>All users</h1>

<div class="pagination">
<%=will_paginate%>
</div>

<ul class="users">
<%=render @users%>
</ul> 

<div class="pagination">
<%= will_paginate %>
</div> 
```

# php - 带有 PHP/MYSQL 值的选项值

> ID：10762898
> 
> 赞同：-1
> 
> 时间：2012-05-26T01:08:40.637
> 
> 标签：php, mysql, html

出于某种原因，我无法使用此表单获得输出。我有一种可怕的感觉，这是我失踪的一个愚蠢的原因，但我已经盯着这个看了好几个小时，试图找出原因。

```
$pnames = $mysql_db->query('SELECT * FROM patient ORDER BY name ASC'); //normal query
<form action="<?php $_SERVER['PHP_SELF']?>?action=addLog" method="POST">
    <select name="pname">
    <?
    while ($p = mysql_fetch_object($pnames)) {
        echo "<option value=".$p->pid.">".$p->name."</option>";
    }
    ?>
    </select>
    <input type="submit"
        value="Add Log" />
</form> 
```

有人可以帮我弄清楚为什么选择没有选项吗？（我已经根据以前有效的代码检查了它，这让我感到困惑。我开始认为这是一个查询问题......无论如何。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T01:30:52.123

你需要关闭这个

```
"<?php $_SERVER['PHP_SELF']?>?action=addLog" 
```

像这样

```
"<?php echo $_SERVER['PHP_SELF'].'?action=addLog'?>" 
```

并确保您`PHP`支持短标签，因为您使用它。

```
<?
while ($p = mysql_fetch_object($pnames)) {
    echo "<option value=".$p->pid.">".$p->name."</option>";
}
?> 
```

试试这个

```
<?php
while ($p = mysql_fetch_object($pnames)) {
    echo "<option value=".$p->pid.">".$p->name."</option>";
}
?> 
```

# python - Resolving GeoIP coordinates in development mode

> ID：10762900
> 
> 赞同：1
> 
> 时间：2012-05-26T01:09:27.830
> 
> 标签：python, django, geolocation, django-forms

I'm trying to insert the lat, lon directly into a form using GeoIP. There have been issues, more than likely because I'm in development mode with local host and the IP address can't be properly resolved.

I'm trying to create a dummy IP address just to see if the lat, lon are actually being determined and set in the form ('google.com'). Unfortunately, this is causing problems with other elements in the form not being properly saved, specifically the author attribute.

The resulting error:

```
'NoneType' object has no attribute 'author' 
```

This is the view:

```
from django.http import HttpResponse, HttpResponseRedirect, Http404
from django.shortcuts import render_to_response, get_object_or_404, redirect
from django.template import RequestContext
from django.core.urlresolvers import reverse
from myapp.report.models import Story, UserProfile
from myapp.report.forms import ProfileForm, StoryForm
from django.contrib.auth.decorators import login_required
from django.contrib.gis.utils import GeoIP
from django.conf import settings

@login_required
def submit_story(request):
    remote_address = request.META['REMOTE_ADDR']
    if settings.DEBUG:
        remote_address = 'google.com'

    if request.method =="POST":
        story_form = StoryForm(request.POST, request.FILES)
        if story_form.is_valid():
            new_story = story_form.save(ip_address=remote_address)
            new_story.author = request.user
            new_story.save()
            return HttpResponseRedirect("/report/all/")
    else: # GET request
        story_form = StoryForm()
    return render_to_response("report/report.html", {'form': story_form}, context_instance=RequestContext(request)) 
```

This is the model:

```
class Story(models.Model):
    objects = StoryManager()
    title = models.CharField(max_length=100)
    topic = models.CharField(max_length=50)
    copy = models.TextField()
    author = models.ForeignKey(User, related_name="stories")
    zip_code = models.CharField(max_length=10)
    latitude = models.FloatField(blank=False, null=False)
    longitude = models.FloatField(blank=False, null=False)
    date = models.DateTimeField(auto_now=True, auto_now_add=True)
    pic = models.ImageField(upload_to='pictures', blank=True)
    caption = models.CharField(max_length=100, blank=True)

    def __unicode__(self):
        return " %s" % (self.title) 
```

This is the form:

```
from django import forms
from myapp.report.models import UserProfile, Story
from django.contrib.gis.utils import GeoIP

class ProfileForm(forms.ModelForm):
    class Meta:
        model = UserProfile

class StoryForm(forms.ModelForm):
    class Meta:
        model = Story
        exclude = ('author','latitude', 'longitude')

    def save(self, ip_address, *args, **kwargs):
        g = GeoIP()
        lat, lon = g.lat_lon(ip_address)
        user_location = super(StoryForm, self).save(commit=False)
        user_location.latitude = lat
        user_location.longitude = lon
        user_location.save(*args, **kwargs) 
```

# android - when does a Leadbolt notification ad show?

> ID：10762902
> 
> 赞同：0
> 
> 时间：2012-05-26T01:10:00.243
> 
> 标签：android, leadbolt

I have implemented the notification ads per the "How-to" guide:

```
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.READ_PHONE_STATE" /> 
```

and

```
String leadboltNoticationId = Application.getInstance().getLeadboltNoticationId();
AdController myController = new AdController(getApplicationContext(),
            leadboltNoticationId);
myController.setAsynchTask(true);
myController.loadNotification(); 
```

no ads show in the notification bar. Nothing shows in the logs. "leadboltNoticationId" is filled correctly with the id. How long do i need to wait for an ad to show up? Is there a way to force an ad to show up immediately? I don't have access to the docs so please dont reference them unless you are going to give me a publicly accessible download link.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T07:19:16.567

您可以通过将 Leadbot-Accout 中的通知设置为重复显示来强制显示通知。

# c++ - 尽管“cin.get();”控制台窗口不会留在屏幕上 或系统（“暂停”）

> ID：10762903
> 
> 赞同：0
> 
> 时间：2012-05-26T01:10:34.273
> 
> 标签：c++, console, main

我希望在您运行 C++ 程序时弹出的控制台窗口保持不变……但在我的代码中，这并没有发生。它很快就消失了。怎么了？注意：我是 C++ 新手。

出于某种原因，当我仅使用该`main()`功能来保存所有内容而不使用第二个功能时，它可以正常工作，但是出于我的任务的目的，我不能将所有内容都塞入`main()`.

```
#include <iostream>
#include <fstream>
#include <string>
#include <vector>
#include <sstream>
#include <cstdio>
using namespace std;

ifstream file("maze.txt");
vector<char> vec(istreambuf_iterator<char>(file), (istreambuf_iterator<char>())); // Imports characters from file
vector<char> path;                      // Declares path as the vector storing the characters from the file
int x = 18;                             // Declaring x as 18 so I can use it with recursion below
char entrance = vec.at(16);             // 'S', the entrance to the maze
char firstsquare = vec.at(17);          // For the first walkable square next to the entrance
vector<char> visited;                   // Squares that we've walked over already

int main()
{
    if (file) {
        path.push_back(entrance);               // Store 'S', the entrance character, into vector 'path'
        path.push_back(firstsquare);            // Store the character of the square to the right of the entrance
                                                // into vector 'path'.
        while (isalpha(vec.at(x)))
        {
            path.push_back(vec.at(x));
            x++;
        }
    }
}

int printtoscreen()
{
    cout << "Path is: ";                    // Printing to screen the first part of our statement

        // This loop to print to the screen all the contents of the vector 'path'.
        for(vector<char>::const_iterator i = path.begin(); i != path.end(); ++i)  // 
        {
        std::cout << *i << ' ';
        }

        cout << endl;
        cin.get();                          // Keeps the black box that pops up, open, so we can see results.
        return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-26T01:14:27.030

也许如果你真的*调用* `printtoscreen`了 ，你可能会发现它执行了暂停的代码。

但是，事实上，无论如何我都会把那`cin.get()`一点放在最后`main`，只是因为它是你只有在 IDE 中运行时才有的东西。您可能不希望它出现在最终的可执行文件中，因为它可能会惹恼任何试图运行它的人。

换句话说，`cin.get();`从末尾删除并在末尾`printtoscreen`添加类似这样的内容`main`：

```
cout << "Press ENTER to exit (remember to remove this from production code)"
     << endl;
cin.get(); 
```

请记住，您可能需要移至`printtoscreen`before `main`，或者之前为其提供原型`main`（以便`main`了解它）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T01:28:27.757

你没有调用你的`printoscreen`函数。尝试在函数`printtoscreen();`结束之前添加。`main()`

编辑：

还可以考虑在此函数中更改`int printoscreen(){`为`void printoscreen(){`并相应`return 0;`地更改为`return;`，因为您没有返回任何有意义的内容，并且忽略了 main 中的结果值。所以整个代码将是：

```
#include <iostream>
#include <fstream>
#include <string>
#include <vector>
#include <sstream>
#include <cstdio>
using namespace std;

ifstream file("maze.txt");
vector<char> vec(istreambuf_iterator<char>(file), (istreambuf_iterator<char>())); // Imports characters from file
vector<char> path;                      // Declares path as the vector storing the characters from the file
int x = 18;                             // Declaring x as 18 so I can use it with recursion below
char entrance = vec.at(16);             // 'S', the entrance to the maze
char firstsquare = vec.at(17);          // For the first walkable square next to the entrance
vector<char> visited;                   // Squares that we've walked over already

void printtoscreen();

int main()
{
    if (file) {
        path.push_back(entrance);               // Store 'S', the entrance character, into vector 'path'
        path.push_back(firstsquare);            // Store the character of the square to the right of the entrance
                                                // into vector 'path'.
        while (isalpha(vec.at(x)))
        {
            path.push_back(vec.at(x));
            x++;
        }
    }
    printtoscreen();
}

void printtoscreen()
{
    cout << "Path is: ";                    // Printing to screen the first part of our statement

        // This loop to print to the screen all the contents of the vector 'path'.
        for(vector<char>::const_iterator i = path.begin(); i != path.end(); ++i)  // 
        {
        std::cout << *i << ' ';
        }

        cout << endl;
        cin.get();                          // Keeps the black box that pops up, open, so we can see results.
        return;
} 
```

# jquery - 使用 PHP、MySQL 和 jQuery 的投票系统 - 不工作（诊断）

> ID：10762904
> 
> 赞同：0
> 
> 时间：2012-05-26T01:10:49.433
> 
> 标签：jquery, ajax, voting

尝试使用 PHP、MySQL 和 jQuery 进行这种**Reddit****[风格的投票](http://www.technabled.com/2009/02/reddit-style-voting-with-php-mysql-and.html)**。

**问题：**当我点击**"Vote up"**或**"Vote down"**时，它没有返回任何内容。页面上什么也没有发生。
*我已经确定该`votes.php`页面可以正常工作，*但无法弄清楚为什么其余页面不能正常工作。

基本上，有 3 组代码：
**01** . 进入 < `head`> 的 jQuery 脚本，
**02** . < > 内的 html `body`（显示：投票按钮和结果）/ `index.php`...
**03.**`votes.php` jquery 发送的PHP 页面（ ）采取行动。

* * *

**01.)**放在我的 < `head`> 内：

```
<script type="text/javascript" src="http://site.com/js/jquery.pack.js"></script>

<script type="text/javascript">
$(function(){
    $("a.vote_up").click(function(){
    //get the id
    the_id = $(this).attr('id');

    // show the spinner
    $(this).parent().html("<img src='images/spinner.gif'/>");

    //fadeout the vote-count 
    $("span#votes_count"+the_id).fadeOut("fast");

    //the main ajax request
        $.ajax({
            type: "POST",
            data: "action=vote_up&id="+$(this).attr("id"),
            url: "votes.php",
            success: function(msg)
            {
                $("span#votes_count"+the_id).html(msg);
                //fadein the vote count
                $("span#votes_count"+the_id).fadeIn();
                //remove the spinner
                $("span#vote_buttons"+the_id).remove();
            }
        });
    });

    $("a.vote_down").click(function(){
    //get the id
    the_id = $(this).attr('id');

    // show the spinner
    $(this).parent().html("<img src='images/spinner.gif'/>");

    //the main ajax request
        $.ajax({
            type: "POST",
            data: "action=vote_down&id="+$(this).attr("id"),
            url: "votes.php",
            success: function(msg)
            {
$("span#votes_count"+the_id).fadeOut().html(msg).fadeIn();
                $("span#vote_buttons"+the_id).remove();
            }
        });
    });
}); 
</script> 
```

* * *

**02.)**放置在< >内的**循环**内：（ 投票按钮和结果应该显示的位置）`body`

```
<div class=\"entry\">
 <span class=\"votes_count\" id=\"votes_count" .$id. "\">" .$effective_vote. " votes</span>  

 <span class=\"vote_buttons\" id=\"vote_buttons" .$id. "\">  
  <a href=\"javascript:;\" class=\"vote_up\" id=\"" .$id. "\">Vote Up!</a>  
  <a href=\"javascript:;\" class=\"vote_down\" id=\"" .$id. "\">Vote Down!</a>  
 </span>  

</div> 
```

* * *

**03.)**我的`votes.php`页面（动作发生的地方）：

```
// Database connection here //

function getAllVotes($id)
    {
    $votes = array();
    $q = "SELECT * FROM cover WHERE id='$id' ";
    $r = mysql_query($q) or die("Error: ". mysql_error(). " with query ". $q);
    if(mysql_num_rows($r)==1) {

        $row = mysql_fetch_assoc($r);
        $votes[0] = $row['votes_up'];
        $votes[1] = $row['votes_down'];
        }
    return $votes;
    }

function getEffectiveVotes($id)
    {
    /**
    Returns an integer
    **/
    $votes = getAllVotes($id);
    $effectiveVote = $votes[0] - $votes[1];
    return $effectiveVote;
    }

$id = $_POST['id'];
$action = $_POST['action'];

//get the current votes
$cur_votes = getAllVotes($id);

//ok, now update the votes

if($action=='vote_up') //voting up
{
    $votes_up = $cur_votes[0]+1;
    $q = "UPDATE cover SET votes_up = $votes_up WHERE id = $id";
}
elseif($action=='vote_down') //voting down
{
    $votes_down = $cur_votes[1]+1;
    $q = "UPDATE cover SET votes_down = $votes_down WHERE id = $id";
}

$r = mysql_query($q);
if($r) //voting done
    {
    $effectiveVote = getEffectiveVotes($id);
    echo $effectiveVote." votes";
    }
elseif(!$r) //voting failed
    {
    echo "Failed!";
    } 
```

* * *

具体来说，与在线提供的其他评级方法相比，我特别喜欢这个，是它返回总票数（从投票中减去 # of vote-downs，并返回该值）。

我不会做很多 jQuery 或 ajax，它有时会让我感到困惑，但我有非常基本的简单知识。（我通常只是遵循代码）

**+ 另外，我如何将它变成 PDO 版本**，而不是使用 MySQL 查询？如果有人可以对此提供额外帮助，我将不胜感激。**:o)**

不知道如何在 StackOverflow 上通知用户，但该项目的开发人员是：
用户：**abhisek** （*用户：4507330*）

谢谢你的时间！希望有人可以诊断问题的根源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T01:52:08.320

由于您在同一页面中使用 jQuery 和prototype.js，因此您需要注意如何使用该`$`函数（因为两个框架都声称该名称）。一种选择是将您的主要功能替换为：

```
jQuery(function($) {
    ...
}); 
```

这样您就可以在该块内`$`用作别名`jQuery`（但您将无法访问prototype.js）。另一种选择是使用 jQuery 的[`noConflict`](http://api.jquery.com/jQuery.noConflict/). 查看文档以获取有关如何使用它的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T06:00:05.433

你可能会喜欢这个 Jquery Ajax 投票系统

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script type="text/javascript" language="javascript" src="http://code.jquery.com/jquery-latest.js"></script>  
<script>
$(document).ready(function () {

    $(".voteMe").click(function() {
        var voteId = this.id;
        var upOrDown = voteId.split('_'); 
        $.ajax({
            type: "post",
            url: "<?= base_url();?>/index.php/article/voteMe",
            cache: false,               
            data:'voteId='+upOrDown[0] + '&upOrDown=' +upOrDown[1],
            success: function(response){
                try{
                    if(response=='true'){   
                        var newValue = parseInt($("#"+voteId+'_result').text()) + 1;            
                        $("#"+voteId+'_result').html(newValue);
                    }else{
                        alert('Sorry Unable to update..');
                    }
                }catch(e) {     
                    alert('Exception while request..');
                }       
            },
            error: function(){                      
                alert('Error while request..');
            }
         });
    });

});
</script>
<style>
ul,ol,li{
    list-style-type: none;
}

h2{
    color: #2864B4;
    text-decoration: none;
}
</style>
</head>
<body>
<div class="container">
<?php
    if(is_array($VOTES) && count($VOTES) ) {
?>
<div>
    <ul>
    <?php foreach($VOTES as $loop){ ?>               
        <li>
        <div>
            <h2><?=$loop->VOTE_DESC;?></h2>
            <span><a id="<?=$loop->VOTE_ID;?>_upvote" class="voteMe"><img src="<?= base_url();?>/img/images/up_vote.png"/></a><span id="<?=$loop->VOTE_ID;?>_upvote_result" ><?=$loop->UP_VOTE;?></span></span>&nbsp;|&nbsp;
            <a id="<?=$loop->VOTE_ID;?>_downvote" class="voteMe"><img src="<?= base_url();?>/img/images/down_vote.png"/></a><span id="<?=$loop->VOTE_ID;?>_downvote_result" ><?=$loop->DOWN_VOTE;?></span>
        </div>
        </li>
    <?php }?>   
    </ul>
</div>
<?php }?>

</div>
</body>
</html> 
```

# c - gdb 便利变量 strcat

> ID：10762905
> 
> 赞同：4
> 
> 时间：2012-05-26T01:11:03.037
> 
> 标签：c, linux, gdb

我想使用便利变量来收集事物列表。我找不到任何关于便利变量的字符串连接的信息。所以我尝试了一些东西。

看一下这个：

```
(gdb) set $foo="foo"
(gdb) p $foo
$45 = 0x84c7fd8 "foo"
(gdb) call strcat($foo,"bar")
$46 = 139231192
(gdb) p $foo
$47 = 0x84c7fd8 "foobar" 
```

好的，所以我更努力地让它崩溃：

```
(gdb) set $foo="foo"
(gdb) set $bar="blue"
(gdb) p $foo
$48 = 0x85d9100 "foo"
(gdb) p $bar
$49 = 0x83cd1e8 "blue"
(gdb) call memset($foo,' ',100000)
$50 = 140349696
(gdb) call strlen($foo)
$51 = 100001
(gdb) p $foo
$52 = 0x85d9100 ' ' <repeats 200 times>...
(gdb) p $bar
$53 = 0x83cd1e8 "blue" 
```

我越来越幸运了。

是的：

```
(gdb) call sprintf($foo, "%d %d %d\n", 1,2,3)
*** glibc detected *** /dev_tools/base/LOCAL-4.0.8_RHEL5.4/bin/sicstus: malloc(): memory corruption: 0x085e8790 ***
======= Backtrace: =========
/lib/libc.so.6[0x9da250]
/lib/libc.so.6(__libc_malloc+0x67)[0x9dbd87]
/lib/libc.so.6(__libc_memalign+0x12b)[0x9dc01b]
/lib/ld-linux.so.2(malloc+0x25)[0x966705]
/dev_tools/base/LOCAL-4.0.8_RHEL5.4/bin/sicstus[0x80486f0]
[0xa]
======= Memory map: ========
00952000-0096c000 r-xp 00000000 fd:00 34185                              /lib/ld-2.5.so
0096c000-0096d000 r--p 00019000 fd:00 34185                              /lib/ld-2.5.so
0096d000-0096e000 rw-p 0001a000 fd:00 34185                              /lib/ld-2.5.so
00970000-00aaf000 r-xp 00000000 fd:00 34194                              /lib/libc-2.5.so
00aaf000-00ab0000 ---p 0013f000 fd:00 34194                              /lib/libc-2.5.so 
```

也许这是一个更好的方法：

```
(gdb) set $foo=(char*)malloc(100000)
(gdb) p $foo
$83 = 0xf0d18bd0 ""
(gdb) call memset($foo,' ',100000)
$84 = -254702640
(gdb) set $foo[99999]=0
(gdb) call strlen($foo)
$85 = 99999
(gdb) set $foo[0]=0
(gdb) call strcat($foo,"12345")
$86 = -254702640
(gdb) call strcat($foo,"12345")
$87 = -254702640
(gdb) p $foo
$88 = 0xf0d18bd0 "1234512345" 
```

有人有更好的主意吗？

**编辑**

感谢 Employed Russian，这很有效：

```
2       breakpoint     keep y   0xf1b451ee in xxx at yyy.c:230
        breakpoint already hit 30 times
        silent
        set logging on
        p szFileName
        set logging off
        cont 
```

**编辑 2**

以下是一些与 malloc 一起使用的东西：

```
1       breakpoint     keep y   0xf1ac915f in xxx at yyy:346
        breakpoint already hit 334 times
        silent
        call sprintf($foo+strlen($foo),"%.3s %.4s %lf\n", s1, s2, (p->Amts[0].lfAmt > 0.01) ? p->Amts[0].lfAmt : p->Amts[1].lfAmt)
        cont 
```

在跑步之前，我会这样做：

```
(gdb) set $foo=(char*)malloc(100000)
(gdb) set $foo[0]=0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T02:13:04.723

这个：

```
(gdb) set $foo="foo" 
```

有效地`$foo = strdup("foo")`在劣质（被调试）进程中执行。

这个：

```
(gdb) call strcat($foo,"bar") 
```

腐败堆在劣质。它并没有因为纯粹的运气而崩溃。

> 有人有更好的主意吗？

没有更好的主意。

而且，我从来不需要以那种方式收集东西。在我看来，您可以通过在 emacs 中运行 GDB，或者只是将所需的值剪切/粘贴到编辑器缓冲区中，以更灵活的方式实现相同的结果。

# php - 我如何使用 wp_enqueue_script？

> ID：10762908
> 
> 赞同：0
> 
> 时间：2012-05-26T01:11:48.620
> 
> 标签：php, javascript, wordpress, wordpress-theming

好的，所以这是在我的functions.php文件中：（以下是编辑后的版本，以利用下面酷的答案。我之后离开原来的：

```
function mdg_setup_scripts() {
  wp_register_script( 'hoverIntent', get_bloginfo('template_url').'/js-custom/hoverIntent.js', array( 'jquery' ));
  wp_enqueue_script( 'hoverIntent' );
  wp_register_script( 'mdMenuAnimation', get_bloginfo('template_url').'/js-custom/mdMenuAnimation.js', array( 'jquery' ));
  wp_enqueue_script( 'mdMenuAnimation' );
}
add_action( 'wp_enqueue_scripts', 'mdg_setup_scripts' ); 
```

这是我最初拥有的：

```
function mdg_setup_scripts() {
  wp_register_script( 'hoverIntent',
    get_bloginfo( 'template_url' ) . '/js/hoverIntent.js',
    array( 'jquery' ),
    false,
    true );
  wp_register_script( 'mdMenuAnimation',
    get_bloginfo('template_url') . '/js/mdMenuAnimation.js',
    array( 'jquery', 'hoverIntent' ),
    false,
    false );
  if (!is_admin()) {
    wp_enqueue_script( 'mdMenuAnimation' );
  }
}
add_action( 'init', 'mdg_setup_scripts' ); 
```

js 文件存在于指定的文件夹中。但是前端根本没有加载任何 JavaScript。我做错了什么，但是什么？我需要注册 jquery（不过我认为 WP 里面有 jquery）？我需要分离入队呼叫吗？我需要在 header.php 中添加一些内容吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T17:13:56.913

你不需要添加jquery。如果没有添加，并且您的自定义脚本依赖于它（就像您在代码中编写的那样），它将由 wordpress 添加。这段代码可以工作（我刚刚测试过）但是..

而不是这个：

```
if (!is_admin()) {
    wp_enqueue_script( 'mdMenuAnimation' );
} 
```

wordpress 建议您使用钩子：

> Wordpress-codex：使用 wp_enqueue_scripts 操作调用此函数，或使用 admin_enqueue_scripts 在管理端调用它。

所以它应该是这样的：

```
function my_scripts_method() {
   wp_register_script( 'somehover', get_bloginfo('template_url').'/js-custom/hoverIntent.js', array( 'jquery' ));
   wp_enqueue_script( 'somehover' );
}  

add_action('wp_enqueue_scripts', 'my_scripts_method'); 
```

> Wordpress-codex：通过使用 wp_enqueue_scripts 钩子（而不是许多文章引用的 init 钩子），我们避免在管理页面上注册备用 jQuery，这会导致后期编辑（以及其他事情）经常在升级后中断。

# google-app-engine - 数据存储上的排序规则

> ID：10762916
> 
> 赞同：0
> 
> 时间：2012-05-26T01:13:17.290
> 
> 标签：google-app-engine

如何对德国使用的排序规则中的订单查询结果进行排序？

例如：N、O、Ó、Ö、P。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T04:25:19.703

App Engine 不直接支持本地化排序规则。

假设单个本地化，处理该问题的一种方法是预先计算将使用非本地化排序正确整理的“规范”形式。

# c# - 返回值后关闭 C# 控制台应用程序

> ID：10762917
> 
> 赞同：-2
> 
> 时间：2012-05-26T01:13:27.260
> 
> 标签：c#, text, md5

更新：忘记去掉 readkey 行

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T01:15:09.203

您是否尝试过摆脱 Console.ReadKey()？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-26T01:15:46.687

删除此行

```
Console.ReadKey(); 
```

# java - 简单的 Java 字符串

> ID：10762934
> 
> 赞同：0
> 
> 时间：2012-05-26T01:16:22.897
> 
> 标签：java, string

所以，我想知道这之间有什么区别：

```
first = "Hello!" 
```

和：

```
String first = "Hello!" 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-26T01:18:30.320

前者分配给已声明的变量；后者声明并分配一个变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T01:18:12.503

我不这么认为：

```
first="Hello!" 
```

将编译，因为编译器会抛出错误，询问 first 的类型。Java 是一种强类型语言——每个变量都需要一个明确定义的类型。我暂时忽略了像 E 这样的泛型类型......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T01:19:10.053

不太确定你在问什么。在你的第一个例子中：`first = "Hello!"`你没有声明`first`，所以如果你只运行那行代码，它将不起作用。假设您声明`first`为字符串，那么两个示例都是相同的。并且没有`string`像`int`and那样的原始类型`Integer`。字符串始终是一个对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-26T01:25:24.137

```
first = "Hello!" 
```

不会正确编译，因为它没有类型。在 Java 中，当您创建一个变量（在本例中称为“first”）时，您必须给它一个类型，例如 String、int、long 等等。因为没有给出类型，所以它不知道该怎么做。所以，当你创建变量时，你必须使用`String first = "Hello!"`

当变量已经声明时，您不需要提供类型。例如，

```
String first = "Hello!"
first = "Goodbye!" 
```

现在首先是“再见！”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-26T01:18:49.723

乍一看，除了第一个变量在另一行声明可能是实例变量之外，没有其他区别？

在内存中，字符串正在池中，所以应该是这样。

# jquery - 使用 nivoSlider 和 symphony-cms 的 Jquery 错误

> ID：10762936
> 
> 赞同：0
> 
> 时间：2012-05-26T01:16:51.177
> 
> 标签：jquery, typeerror, nivo-slider, symphony-cms

我嵌入了 nivo 滑块：

```
<link rel="stylesheet" href="/test/workspace/css/nivo-slider.css" type="text/css" media="screen" />
<div class="slider-wrapper theme-default">
  <div class="ribbon"></div>
  <div id="slider" class="nivoSlider">
    <img src="http://amarilaw.com/test/image/2/877/317/5/0/images/lighthouse.jpg" />
    <img src="http://amarilaw.com/test/image/2/877/317/5/0/images/main-image2.png" />
  </div>
</div> 
```

然后添加以下javascript：

```
 <script type="text/javascript" src="/test/workspace/js/jquery.nivo.slider.js"></script>
<script type="text/javascript">
$(window).load(function() {
    $('#slider').nivoSlider({
        effect: 'random', 
        pauseTime: 4000
     });
});
</script> 
```

（jquery已经加载到header中了，这里就不做了）

但是，我收到以下错误：

```
Uncaught TypeError: Object [object Object] has no method 'nivoSlider' /test/:76
(anonymous function) /test/:76
f.event.dispatch jquery-1.7.2.min.js:3
f.event.add.h.handle.i 
```

在这个网站上还有其他一些帖子显示人们遇到了同样的错误。我尝试了以下所有补救措施，但均未成功：

*   确保 jquery 没有在页面上加载两次
*   将 window.load 更改为 document.ready
*   检查 js 文件的所有文件路径是否正确
*   接受耶稣进入我的心

有人有想法吗？这是链接，您必须在下面输入登录信息才能看到它： [[1] [1]：http://amarilaw.com/test](http://amarilaw.com/test)

用户：betatest

通过：请努力

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T05:47:21.173

你不止一次调用你的 jQuery.min.js 文件，即使你说你已经起诉了它。请参阅行`6`和`108`. 你会注意到同一个文件，两次。

正因为如此，该函数在加载范围内对 jQuery 不可用，导致无法加载该函数。

在这里做两件事：

# 1

将您散布在文档中的所有随机`<script>`标签移到`bottom of the document body`.

# 2

删除位于第 #108 行的 jQuery.min.js 文件

# 3

？？？

# 4

利润。

# .htaccess - 通过 htaccess 将子域重定向到特定 URL

> ID：10762940
> 
> 赞同：0
> 
> 时间：2012-05-26T01:17:20.177
> 
> 标签：.htaccess, url, redirect, subdomain

我看过数百个例子，但我无法根据我的情况调整它们。

我需要（通过 htaccess）从 radio.mysite.com:8000 重定向到 www.mysite.com:8000/radio.pls

有人可以帮忙吗？谢谢！！

编辑：我尝试了几件事，但最像这样：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^radio\.mysite\.com:8000$ --// I also tried without the port which would be fine
RewriteRule ^/$ http://www.mysite.com:8000/radio.pls [L] --// I don't know what the [L] is for 
```

结果是：使用 8000 端口它什么都不做，我认为这是因为 htaccess (apache) 仅在端口 80 上工作（对吗？）。如果没有 8000 端口，它只会显示一些我不知道它在哪里的页面（就像您购买主机时的欢迎页面），但它不是我的索引或类似的东西。谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T13:39:02.190

尝试：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^radio\.mysite\.com$
#RewriteCond %{HTTP_PORT} ^8000$
RewriteRule ^$ http://www.mysite.com:8000/radio.pls [R,L] 
```

或者

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^radio\.mysite\.com$
#RewriteCond %{HTTP_PORT} ^8000$
RewriteRule ^$ /radio.pls [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T18:30:16.143

端口将在变量中`%{HTTP_PORT}`。

```
RewriteEngine On
# Match non-www
RewriteCond %{HTTP_HOST} !^www\. [NC]
# Match port 8000
RewriteCond %{HTTP_PORT} ^8000
# And redirect to www with the correct port with the [R] flag
RewriteRule ^/?$ http://www.mysite.com:8000/radio.pls [L,R] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-12T00:09:33.470

试试这个：（
*把它放在你的子域所在文件夹的 .htaccess 文件中）*

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^subdomain.primarydomain.com$ [OR]
RewriteCond %{HTTP_HOST} ^www.subdomain.primarydomain.com$ [OR]
RewriteCond %{HTTP_HOST} ^addondomain.com$
RewriteCond %{REQUEST_URI} ^/$
RewriteRule ^(.*)$ http://www.addondomain.com/ [R=301,L] 
```

将其切换为无 www。如果您希望它成为您的主域。

# java - 寻找一种在棋盘游戏中处理颜色和力 量的方法

> ID：10762958
> 
> 赞同：3
> 
> 时间：2012-05-26T01:21:01.080
> 
> 标签：java, hierarchy

我正在为我的学校项目创建一个游戏，所以我在这里不是为了任何类型的代码，只是一个关于如何做我想做的事情的全球想法......

我有碎片，每件都有自己的颜色和类型，如下所示：
碎片 1 - 黄色 - 简单
碎片 2 - 黄色 - 爆炸
......
碎片 10 - 蓝色 - 改变颜色

在开始游戏时，该列表中的随机棋子将是场（之前创建的列表，每个棋子只有一种），如果我们连续有 3 个或更多，游戏将删除它们并计算分数，但如果一个3个（或更多）中的任何一个“力量效应”比周围的碎片必须对这种力量做出反应（我的英语水平很难解释，但我认为你明白了：S..）

现在我的游戏只有简单的部分，为此我使用了这样的枚举：

```
public enum CorPeca 
{    
     AMARELO,
     AZUL,
     VERMELHO;
} 
```

在董事会课上，我正在这样做：

```
 this.arrayPecas = new ArrayList<Peca>();

    for (CorPeca corPeca : CorPeca.values())
        this.arrayPecas.add(new Peca(corPeca)); 
```

在 Pieces 课上，我正在这样做

```
public Peca(CorPeca tipoPeca)
{
    this.definirPeca(tipoPeca);
}

public CorPeca getCorPeca() { return this.corPeca; }
public char getCharPeca() { return this.charPeca; }

public void definirPeca(CorPeca tipoPeca)
{
    switch (tipoPeca)
    {
        case AMARELO:
            this.charPeca = 'a';
            this.corPeca = CorPeca.AMARELO;
            break;
        case AZUL:
            this.charPeca = 'u';
            this.corPeca = CorPeca.AZUL;
            break;
        case VERMELHO:
            this.charPeca = 'e';
            this.corPeca = CorPeca.VERMELHO;
            break;                
    }
} 
```

但我在想一个很好的方法来轻松添加那些“力量碎片”，但不仅如此，将来能够添加更多的颜色和更多的“力量”......

我正在考虑创建子类并使用扩展，但整个想法并没有填满我的脑海，因为我们不能扩展多个类......

那么任何人都可以给我一个关于如何存档的全局想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T01:43:29.883

执行此操作的经典 OOP 方法是定义一个抽象基类，该基类代表所有部分并包含通用功能（例如权力列表）：

```
public abstract class Piece {
    // put in fields that every piece has, e.g. x and y co-ordinate here

    // array of powers
    protected ArrayList<Power> powers=new ArrayList<Power>();

    // method to add new powers to the piece
    public void addPower(Power power) {
        powers.add(power);
    }

    // power method - optionally overriden by specififc pieces
    public void applyPowers() {
        for (Power power:powers) {
            power.methodToActivatePower();
        }
    }

    // abstract char method
    public abstract char getChar();

} 
```

请注意，这`abstract`意味着您不能直接实例化此类 - 您只能创建具体子类的实例。

然后扩展这个类来实现每个特定的部分：

```
public class YellowPiece extends Piece {

    // override applyPowers for yellow piece (if needed)
    @Override
    public void applyPowers() {
        // code for yellow piece power handling goes here
    }

    // override char - required
    @Override
    public char getChar() {
        return 'y';
    }

} 
```

您仍然可以创建一个`ArrayList<Piece>`并使用以下内容填充它：

```
ArrayList<Piece> pieces = new ArrayList<Piece>();
pieces.add (new YellowPiece());
pieces.add (new GreenPiece());
// etc.... 
```

然后，如果您想应用特定作品的力量，只需执行以下操作：

```
pieces.get(pieceNumber).applyPower(); 
```

您显然需要大量自定义此代码以使其在您的游戏中工作，但希望它可以为您提供总体思路。请注意，还有很多其他方法可以实现相同的目标——我刚刚描述了“经典”OOP 方式。

PS 抱歉所有代码都是英文的，但你的英语比我的葡萄牙语好得多 :-)

# android - Android 操作栏方向更改怪癖 - 调用 tabSelected 和 ItemSelected 方法

> ID：10762964
> 
> 赞同：2
> 
> 时间：2012-05-26T01:23:27.400
> 
> 标签：android, orientation, android-activity, android-actionbar, android-4.0-ice-cream-sandwich

我正在开发一个平板电脑应用程序，主要活动上有两个片段。左边的片段是一个列表片段，当用户选择一个选项卡或从 ActionBar 内的 2 个微调器中选择一个项目时，它的内容会更新。

最初我通过覆盖 onConfigurationChanged 来处理方向更改。由于 Google 不建议这样做并且它会导致 ActionBarSherlock 出现问题，因此我已开始努力以正确的方式进行操作。我已将我的片段设置为保留它们的实例 (setRetainInstance) 以更改方向。

问题是当方向更改时，活动的 OnCreate 方法会将选项卡添加到操作栏并选择一个导致列表重新加载的选项卡。微调器也会发生这种情况，因为在旋转时选择了新项目。在方向更改时，列表片段无需刷新。

我知道可以保存选项卡和微调器状态，但是如何阻止列表更新，因为这是在 onTabSelected 和 onItemSelected 方法中完成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T01:29:47.350

我不知道这是否是正确的做法，但您可以创建一个局部变量（布尔值），该变量在第一个 OnCreate 之后设置并在 OnPause/OnDestroy 处重置。然后，您可以使用 created 变量来排除 onCreate 方法中某些代码段的执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T11:58:15.260

如何使用`onRetainNonConfigurationInstance()`来保存一些不应该在方向改变时改变的状态？例如，如果您遵循[@ThomasKJDK 的回答](https://stackoverflow.com/a/10762980/570930)，您可以`boolean`在此方法中设置 。然后你可以`boolean`在`onCreate()`; 并据此决定各种代码段的执行`boolean`。

有关此方法的更多详细信息，请[点击此处](http://developer.android.com/guide/topics/resources/runtime-changes.html#RetainingAnObject)。

# c++ - c++中的快速输入/输出

> ID：10762967
> 
> 赞同：-3
> 
> 时间：2012-05-26T01:24:12.353
> 
> 标签：c++, c

我需要在编程问题中输入 1 到 10000 范围内的大量数字。问题建议使用快速 I/O 方法。

[我在竞争性编程中](https://stackoverflow.com/questions/9749630/fast-input-output-in-competitive-programming)查看了快速输入/输出， 但它太复杂了。所以任何人都可以告诉我一个更简单的方法来获得快速 io。

另外请告诉我使用 `gets`然后做`atoi()`是否比使用`scanf(%d)`数字作为输入更快。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T01:39:35.637

要回答你问题的第二部分，对我来说，这似乎`atoi`快了两倍。考虑以下：

```
#define ITERS 1000000

clock_t testAtoi()
{
    char buffer[64];
    clock_t start = clock();

    for (int i = 0; i < ITERS; i++) {
        sprintf(buffer, "%i", i);
        int l = atoi(buffer);
    }

    return clock() - start;
}

clock_t testScanf()
{
    char buffer[64];
    clock_t start = clock();

    for (int i = 0; i < ITERS; i++) {
        sprintf(buffer, "%i", i);
        int l = 0;
        sscanf(buffer, "%i", &l);
    }

    return clock() - start;
}

int main()
{
    printf("clocks for atoi: %lu\n", testAtoi());
    printf("clocks for sscanf: %lu\n", testScanf());

    return 0;
} 
```

对我来说，使用 gcc 和`-O0`（所以我的变量没有被优化掉），程序输出：

> atoi 时钟：222011
> sscanf 时钟：392409

但是，如果您使用的是`FILE *`，那么可能`fscanf`会更快。我现在没有时间比较这两者，但对于原始字符串，我只会使用`atoi`大部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-12-12T05:30:49.747

没有用于快速输入/输出的特定库。您可以关闭同步，这将一起输入并一起打印输出。

在 main() 中添加以下代码行以关闭同步：

```
int main(){
        ios_base::sync_with_stdio(0);
        cin.tie(0);
        // Your code ................
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-30T04:31:07.723

C/C++ 中没有任何用于 FASTIO 的特殊库。

在 C/C++ 中打印输出的最快方法是 stdio.h 库中的 fwrite 或 fwrite_unlocked。

也没有任何特殊/直接功能可以一次打印输出。

间接地，可以使用 cplusplus 中的 append 函数（将所有输出字符串附加到一个字符串并打印最终字符串）甚至 string.h lib 中的 strcat 函数来实现，但性能方面，“Appending or concat + printing”速度较慢，甚至比 printf 慢得多。

所以c/c++中最快的方法是：直接以原始形式读取流，并提取所需的信息。还将原始形式的输出放在一个巨大的缓冲区中，最后使用fwrite显示出来。

请尝试通过此链接中的解决方案进行快速 IO。（http://www.codechef.com/viewsolution/244848）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-04-11T19:45:41.563

参考这篇博客：[http ://bugdivine.blogspot.com/p/fast-input-reader-in-cc.html](http://bugdivine.blogspot.com/p/fast-input-reader-in-cc.html)

在 C/C++ 中获取输入的最快方法是从输入缓冲区读取每个字符并将它们推送到结果变量中，直到到达分隔符。

然而，scanf 也非常快，即使在竞争性编程世界中，我们必须使用 getchar_unlocked 的情况也很少发生。

# ios - 触摸时暂停 UIScrollView 的滚动

> ID：10762971
> 
> 赞同：0
> 
> 时间：2012-05-26T01:26:58.207
> 
> 标签：ios, uitableview, uiscrollview, scroll

我有一个 UIScrollView，它是在某个搜索词之后快速更新的 Twitter 流。每秒处理大量推文。我希望用户能够触摸表格视图上的任何位置并让它在添加新推文时停止滚动，以便用户可以停止并阅读单个推文。

目前，我正在添加这样的推文：

```
[self.tweets insertObject:model atIndex:0];
[self.tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:[NSIndexPath indexPathForRow:0 inSection:0]] withRowAnimation:UITableViewRowAnimationTop]; 
```

添加推文时，滚动视图的位置被锁定，因此整个视图向下移动以容纳推文。以如此快的速度，这使得屏幕上的推文以难以辨认的速度放大。理想情况下，我想这样做，如果与 TableView 接触（由覆盖它的 UIButton 完成），则滚动定位将锁定到视图中的该行。解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T02:34:46.963

每次添加推文时，都会通过更改表格视图的滚动位置来考虑其高度。要做到这一点，请使用`setContentOffset:animated:`. 用于参数以使更改即时并传递`NO`与推文高度相关的 a。因此，如果推文的高度为 50，则执行以下操作：`animated``CGPoint`

```
[tableView setContentOffset:CGPointMake(tableView.contentOffset.x, tableView.contentOffset.y -50) animated:NO]; 
```

这会将表格视图向上滚动 50，这意味着用户必须滚动才能查看刚刚添加的推文。

# c# - C# 静态方法与对象实例

> ID：10762973
> 
> 赞同：5
> 
> 时间：2012-05-26T01:27:37.083
> 
> 标签：c#, model-view-controller, static-methods, factories

我目前正在开发一个 C# MVC REST web api，并试图在我们的设计的两种可能性之一之间进行选择。

在不深入了解我们的设计的情况下，我们打算创建一个用于数据访问的类，我们将其称为`DataSource`. 每个`DataSource`人都需要执行小的、包含的逻辑块来正确构建适当的响应。由于希望将来能够热加载代码，我们不想简单地将这些功能放在 上`DataSource`，而是希望它们由其他程序集提供。我们已经实现了这个概念的证明，到目前为止，一切都很好。

我试图在两者之间做出决定是编写一个带有单个静态`ExecuteQuery`函数的静态类，还是编写一个工厂方法来创建这些类的实例，这些实例有一个名为`ExecuteQuery`.

**每个请求创建多个短期对象与调用静态方法之间的性能考虑是什么？**

直观地说，静态方法会更快，但我已经预料到通过反射调用它们会有点头疼（以支持热加载的代码要求）。

如果对短寿命的物体没有巨大的惩罚，那么它们可能仅靠简单性就胜出。

有关我们预期负载的相关信息：

*   响应时间在 300ms - 800ms 范围内
*   大约 2000 个 Web 客户端的平均负载
*   约 4000 个客户端的峰值负载
*   客户端每 2 - 5 秒查询一次
*   每秒 1 次查询的客户端峰值速率

此外，每个`DataSource`实例最多创建 8 个，平均为 3 个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T01:40:06.440

我假设每个`DataSource`实例都会与数据库建立新连接。如果是这样，那么只有一个实例是有意义的。找出“这是否是一个巨大的惩罚”的唯一方法是创建一个解决方案和配置文件的模型，看看影响是否显着。

*   由于您似乎一次没有很多客户，所以这也适用于单例模式。
*   并发查询不多（主要是因为上面的语句）。
*   您有一个已定义的响应时间规范。

我可以为工厂模式提出的唯一论点是“简单”。如果该项目确实对时间敏感，那么我想您别无选择。但是，如果您真的想要性能，请选择 Singleton。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T01:40:17.347

使用 MEF。无需发明自己的插件框架。它将引导您使用通过接口公开的实例方法。创建每个请求的对象并不少见...... MVC 框架在所有地方都可以做到这一点。每个请求的实例对于数据访问场景来说是一件特别好的事情，这样您就可以支持事务/回滚之类的事情，其中​​一个用户的体验不会影响其他用户，直到您明确地做出它。如果性能有问题，请在适当的地方使用响应缓存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T01:51:21.847

使用静态类，将调用委托给实现类。

这些实现类应该实现一个通用接口，这将允许您在不需要反射的情况下调用它们的方法。当然，静态方法不能实现接口方法。接口实现必须是实例，您需要某种工厂来实例化它们。如果它们存在于外部程序集中，我强烈建议您查看托管可扩展性框架 (MEF)，请参阅[http://msdn.microsoft.com/en-us/library/dd460648.aspx](http://msdn.microsoft.com/en-us/library/dd460648.aspx)。

每个请求创建多个短期对象与调用静态方法之间的性能考虑是什么？鉴于这些方法将进行数据访问，性能影响完全可以忽略不计。

如果您使用 MEF，框架将为您创建类似单例的实例。

如果您扮演自己的角色，并且想要消除多次创建这些对象的需要，您可以在它们上实现单例模式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-26T01:35:34.293

主要决定应该是“这个对象有状态吗？”

如果“否”，那么请务必将其设为静态方法。

恕我直言.. PSM

# java - JPA Entity Manager 应该关闭吗？

> ID：10762974
> 
> 赞同：88
> 
> 时间：2012-05-26T01:27:48.940
> 
> 标签：java, jpa

我有下面的方法。

```
public Profile readUser(String email){
    EntityManager em = EMF.get().createEntityManager();
    return em.find(Profile.class, email);
} 
```

以上实体管理器的用法可以吗？还是有必要关闭它们？请有任何建议。

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2012-05-26T01:51:45.717

我想答案是：*这取决于*.

您的实体管理器是访问实体所在上下文的关键。如果您的应用程序是 JSE 应用程序，您必须考虑上下文的​​预期寿命。

假设您将根据用户的请求创建一个实体管理器。因此，当您处理给定的请求时，您将保持您的实体管理器处于打开状态，当您完成它时，您将其关闭。

在 JSE 应用程序中，您可能考虑过希望实体管理器在应用程序的整个生命周期中保持打开状态（假设您不处理大量数据），然后在应用程序关闭时将其关闭。

最重要的是，何时打开和关闭完全取决于您的策略和设计。当您不再需要其上下文中的实体时，您将其关闭。

在您的示例中，这并不明显，但是由于您在方法中创建了 EM，因此您应该在返回之前将其关闭，否则，您将无法再次访问它（除非您将其保存在某个注册表中，这在代码中并不明显）。

如果您不关闭它，您的实体将保持为附加状态，即使在您完成使用它们之后也是如此。即使您无法再访问您的 EM，您的上下文也将保持活动状态。

[JPA 规范](http://download.oracle.com/otndocs/jcp/persistence-2_1-edr-spec/index.html)包含更多细节。在第**7.7 节应用程序管理的持久性上下文**中它说：

> 当使用应用程序管理的实体管理器时，应用程序直接与持久性提供者的实体管理器工厂交互以管理实体管理器生命周期并获取和销毁持久性上下文。
> 
> 所有此类应用程序管理的持久性上下文都在范围上进行了扩展，并且可以跨越多个事务。
> 
> `EntityManagerFactory.createEntityManager`方法和 `EntityManager` `close`方法用于管理应用程序管理的实体管理器的`isOpen`生命周期及其相关的持久性上下文。
> 
> 扩展的持久性上下文从创建实体管理器的那一刻开始一直存在， `EntityManagerFactory.createEntityManager`直到实体管理器通过`EntityManager.close`.
> 
> 从应用程序管理的实体管理器获得的扩展持久性上下文是一个独立的持久性上下文，它不与事务一起传播。
> 
> [...] 该`EntityManager.close`方法关闭实体管理器以释放其持久性上下文和其他资源。调用 close 后，应用程序不得在 `EntityManager`实例上调用除`getTransaction`and之外的任何其他方法`isOpen`，否则`IllegalStateException`将抛出 。如果在事务处于活动状态时调用 close 方法，则持久性上下文将保持受管理状态，直到事务完成。
> 
> 该`EntityManager.isOpen`方法指示实体管理器是否打开。该`isOpen`方法在实体管理器关闭之前返回 true。要真正了解其工作原理，了解实体管理器与上下文之间的关系至关重要。

因此，如您所见，实体管理器是您访问实体的公共接口，但是，您的实体驻留在上下文中，附加到您的实体管理器。了解不同类型上下文的生命周期将回答您的问题。

持久性上下文可以是不同的类型。在 Java EE 应用程序中，您可以拥有**事务范围的持久性上下文**或**扩展的持久性上下文**。在 JSE 应用程序中，上下文的性质**由开发人员控制**。

当您向实体管理器请求实体时，它会在其附加的上下文中查找实体，如果在那里找到实体，则返回它，否则，它会从数据库中检索实体。在上下文中对该实体的后续调用将返回相同的实体。

**事务范围**

在使用事务范围持久性上下文的 Java EE 应用程序中，当您第一次访问实体管理器时，它会检查当前 JTA 事务是否附加了上下文，如果还没有上下文，则创建新上下文并链接实体管理器在这种情况下。然后从数据库中读取实体（如果存在，则从缓存中读取）并将其放入上下文中。当您的事务结束（提交或回滚）时，上下文变得无效并且其中的任何实体都变得分离。这是无状态会话 bean 的经典场景。

```
@PersistenceContext(unitName="EmplService")
EntityManager em; 
```

这也意味着，根据您设计交易的方式，您最终可能会得到多个上下文。

**扩展持久性上下文**

在具有状态会话 bean 的 Java EE 应用程序中，您可能希望上下文能够在多个 bean 调用中继续存在，因为您不喜欢在 bean 被标记为删除之前提交，对吗？在这些情况下，您需要使用扩展的持久性上下文。在这种情况下，持久性上下文是在第一次需要时创建的，但在您将有状态 bean 标记为要删除之前，它不会变得无效。

```
@PersistenceContext(unitName="EmplService", type=PersistenceContextType.EXTENDED) 
```

这意味着，无论在后续调用有状态会话 bean 方法时注入此 bean 的实体管理器实例如何，您都可以确保您将始终访问相同的上下文，因此，即使后续调用也将返回相同的例如，因为它是相同的上下文。

此外，在将 bean 标记为删除或手动刷新它们之前，您的更改不会被刷新。

**应用程序管理**

您始终可以手动实例化您的实体管理器工厂和实体管理器。这是您通常在 JSE 应用程序中执行的操作，对吗？

对于这类应用程序，您通常没有容器来处理 JTA 事务，对吗？因此，您使用资源本地事务并负责手动提交或回滚更改。

对于这种应用程序，当您实例化实体管理器时，会自动将上下文附加到它。

根据您的应用程序，您可以决定创建一个全局实体管理器，其生命周期附加到应用程序本身的生命周期。这是应用程序整个生命周期的单个实体管理器。在这种情况下，您的上下文将由您的实体管理器创建和销毁。

Or, you could create an entity manager per conversation (i.e. transaction) with your application user. The scope, in this case, is determined by you, but still, your context will be created and destroyed with your entity manager.

# java - JavaFX 中 WebView 的性能

> ID：10762979
> 
> 赞同：36
> 
> 时间：2012-05-26T01:29:30.423
> 
> 标签：java, performance, swing, webview, javafx

我有一个 HTML5 UI 和一个 Java 后端，并且希望避免在纯 Java 中重建 HTML ui，所以我的想法是运行本地网络服务器并使用 webview 在“本机”窗口中呈现它。解决方案似乎是使用可以嵌入到 swing 中的 JavaFX WebView。在纸上听起来很棒（特别是因为他们声称使用 WebKit，它在 Chrome / Safari 中对我的 UI 具有明显更好的性能）。

它有效，但是：性能非常糟糕。比 Chrome、Safari（甚至更慢的 Firefox）中的相同速度慢几个数量级。它实际上是不可用的（我的 UI 大量使用了 JQuery / JS）。顺便说一句，我正在使用[这篇文章](https://stackoverflow.com/questions/8374365/integrating-javafx-2-0-webview-into-a-swing-java-se-6-application)中的代码。

问题是：

1.  有人可以支持我的经验吗？我只是做错了什么还是这是由JavaFX引起的，因此是“正常的”？

2.  任何更好的想法如何实现这一目标？我目前只是启动系统浏览器，它可以工作但不是很好（看起来不像集成的）。 

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-05-26T02:56:07.950

我已经使用了很多 WebView，通常性能非常好并且非常有用。

*   Html5 合规性很好。
*   JavaScript 性能各不相同，但根据 Google 的 V8 基准测试（Chrome 可能针对该基准进行了调整），我发现它的速度大约是最新版 Chrome 的三分之一。
*   渲染性能似乎不是什么大问题。
*   非常密集的 HTML Web 应用程序（例如 Chrome 实验库中的一些应用程序）的启动速度不如其他一些浏览器快。
*   不支持 WebGL，因此使用 WebGL 图形软件渲染的网站要慢得多。

我在使用 WebView 时遇到的最大问题是，它在尖端功能和密集使用方面不如其他浏览器那么稳定，但实际上并没有任何严重的性能问题。

以下是一些基准统计数据（使用的 WebView 版本来自 JavaFX 2.2 build 9）：

**遵守**

运行[html5](http://html5test.com/)测试以测试 html5 合规性（得分为 500）：

```
Chrome 19 402 + 13 积分
火狐 12 345 + 9 个奖励积分
WebView 2.2b9 296 + 7 加分
IE 9.0.6 138 + 5 加分

```

运行[acid3](http://acid3.acidtests.org)测试，webview 得分 100/100 与其他测试浏览器相同，但与 IE9 一样，最终呈现略有不完善。

**Javascript**

[Sunspider](http://www.webkit.org/perf/sunspider-0.9.1/sunspider-0.9.1/driver.html) Javascript 基准测试（越低越好）：

```
IE 9.0.6 146.7ms
铬 19 151.5 毫秒
火狐 12 185.8 毫秒
WebView 2.2b9 199.5ms

```

[Google V8](http://www.webkit.org/perf/sunspider-0.9.1/sunspider-0.9.1/driver.html) Javascript 基准测试（越高越好）：

```
铬 19 15323
火狐 12 9557
网络视图 2.2b9 5145
即 9.0.6 3661

```

[Mozilla Kraken](http://kraken-mirror.googlecode.com/svn/trunk/kraken/hosted/kraken-1.1/driver.html) Javascript 基准测试（越低越好）：

```
铬 19 2416.8ms
火狐12 2112.9ms
WebView 2.2b9 7988.9ms
IE 9.0.6 9403.0ms

```

**密集帆布**

旋转[3D 佛像](http://www.zynaps.com/site/experiments/environment.html?mesh=buddha.wft)（越高越好）：

```
铬 19 60fps
火狐12 43fps
IE 9.0.6 16fps
WebView 2.2b9 7fps

```

**jQuery**

[JQuery 测试套件](http://siliconforks.com/jscoverage/instrumented-jquery/jscoverage.html?test/index.html)执行（越低越好）：

```
铬 19 21826 毫秒
WebView 2.2b9 22742ms
火狐 12 23554 毫秒
IE 9.0.6 28247ms

```

基于上述基准（在我的 Windows 7 桌面上运行），只要 WebView 对您来说足够稳定和功能足够，那么 WebView 与其他浏览器的性能应该不是问题（只要您的应用程序没有很多3D 旋转的佛像...... :-)。

**更新**

正如 uta 的回答所述，JavaFX 2.2 的 Win 32 位版本打开 JavaScript JIT 编译器，JavaFX 2.2[的 Win 64 位版本关闭](http://javafx-jira.kenai.com/browse/RT-24998)。这意味着在运行 64 位 JavaFX 版本与 32 位 JavaFX 版本时，WebView JavaScript 基准测试要慢得多（通常慢 4 到 5 倍）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-25T12:25:21.330

JavaScript JIT 在 Windows x64 的 WebNode 中已关闭。这可能是您的问题的原因。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-06-18T15:45:25.950

我的网站（[https://mdemo.cqg.com](https://mdemo.cqg.com) ）也遇到了 JavaFX WebView 性能不佳（缓慢、重绘问题）。经过一番谷歌搜索后，我遇到了[Integrating JavaFX 2.0 WebView into a Swing Java SE 6 Application](https://stackoverflow.com/questions/8374365/integrating-javafx-2-0-webview-into-a-swing-java-se-6-application)主题。在答案中，有一个建议使用 JxBrowser ( [http://www.teamdev.com/jxbrowser](http://www.teamdev.com/jxbrowser) )——用于 Java 的基于 Chromium 的 Swing/JavaFX 组件。我为我的网站尝试过。网站表现良好——没有缓慢或重绘问题（在原始 WebView 中发生）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-04-04T12:09:20.643

在这种情况下，您并不孤单。我仍然对 webview 和谷歌地图有问题。你可以看到下面的链接。目前我没有任何答案给你，我知道这很不愉快......

我的帖子的一些例子： - [https://community.oracle.com/message/12356161](https://community.oracle.com/message/12356161)

如果可以的话，请投票： - [https://javafx-jira.kenai.com/browse/RT-33217](https://javafx-jira.kenai.com/browse/RT-33217)

*   [https://javafx-jira.kenai.com/browse/RT-29123](https://javafx-jira.kenai.com/browse/RT-29123)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-07-29T07:03:04.667

JavaFX webView 看起来速度较慢的一个原因是，与 Web 浏览器不同，它不缓存任何内容。这是必须执行的。

# wordpress - Wordpress 类别选择器 - 卡住

> ID：10762982
> 
> 赞同：0
> 
> 时间：2012-05-26T01:30:34.963
> 
> 标签：wordpress, categories

我正在使用 Auctionpress 创建一个类似 ebay 的网站。我有 300 多个类别，您可以在其中列出一个项目。

当用户列出一个项目时，他们只会得到一个包含所有类别的列表框，然后他们必须通过所有类别才能找到正确的类别。

相反，我希望用户首先看到所有顶级父类别，当他们选择一个时，它会获取所有子类别，依此类推，直到他们到达最终类别 - 就像在 ebay 中一样。

就像在这个视频中

[http://www.youtube.com/watch?v=ljW7_JrlAL4](http://www.youtube.com/watch?v=ljW7_JrlAL4)

到目前为止我设法做的事情：

列出 depth = 1 的所有类别（这是第一步）

```
wp_list_categories('hide_empty=0&depth=1'); 
```

好的，它起作用了

现在我希望当用户单击一个类别时，如果它有子类别，那么原始面板旁边的一个新面板将在所有子类别中可见，依此类推，直到用户到达没有子类别的类别。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T08:03:10.743

您将不得不执行一个 ajax 调用来获取给定类别的子级。
如何在 WP 中使用 Ajax：http: [//codex.wordpress.org/AJAX_in_Plugins](http://codex.wordpress.org/AJAX_in_Plugins)

ajax 调用将返回如下内容：

```
<?php
$args = array(
  'hide_empty'=> 0,
  'depth' => 1,
  'child_of' => $clicked_parent, //the Id of the parrent
);
wp_list_categories($args); 
```

另请参阅：[http ://codex.wordpress.org/Function_Reference/wp_list_categories](http://codex.wordpress.org/Function_Reference/wp_list_categories)

不是现成的答案。但是你必须弄清楚细节。

# javascript - 传单地图未在选项卡式面板内正确显示

> ID：10762984
> 
> 赞同：51
> 
> 时间：2012-05-26T01:30:53.137
> 
> 标签：javascript, css, twitter-bootstrap, leaflet

我正在尝试使用 Leaflet.js 在 Twitter Bootstrap 的选项卡式面板中显示地图，但行为方式很奇怪：

当我单击包含面板的选项卡时，地图顶部有一个灰色层。如果我拖动并移动地图，我会看到其他图块，但看不到最初的图块。

更奇怪的是，如果我调整浏览器的大小，突然它可以正常工作，直到我再次重新加载，所以我猜是 css 的问题，但我找不到问题。

此外，将地图放在选项卡式面板之外效果很好。

我在 Firefox 和 Chrome 中进行了测试，两者都有相同的问题。

我在 jsfiddle 中创建了一个测试以查看它“实时”：http: [//jsfiddle.net/jasalguero/C7Rp8/1/](http://jsfiddle.net/jasalguero/C7Rp8/1/)

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-05-26T02:05:41.903

这是与leaflet.js源代码混淆的完整黑客，但它可以工作（至少在jsFiddle中）[http://jsfiddle.net/C7Rp8/4/](http://jsfiddle.net/C7Rp8/4/)

这个想法来自谷歌地图，当它的容器 div 被调整大小时“调整大小”或“重绘”地图。

我所做的更改是：

将 id 添加`link3`到 HTML 中的小选项卡

```
<a href="#lC" data-toggle="tab" id="link3">tab3</a> 
```

在这个选项卡里面添加一个监听器`$(function() {`

```
$("body").on('shown','#link3', function() { 
  L.Util.requestAnimFrame(map.invalidateSize,map,!1,map._container);
}); 
```

requestAniMFrame 行取自 leaflet.js 中的 trackResize

**评论更新**：嗨，我使用了 map.invalidateSize(false); 而不是 L.Util.requestAnimFrame(... 这似乎也有效。只是想我会指出这一点。不过答案很好！ – Herr Grumps

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-06-17T17:05:03.270

Bootstrap 3 具有自定义命名空间事件，因此之前的答案适用于：

```
$("body").on("shown.bs.tab", "#link3", function() {
    map.invalidateSize(false);
}); 
```

参考：[引导选项卡](http://getbootstrap.com/javascript/#tabs)

# php - API 谷歌 + php + MySql

> ID：10762989
> 
> 赞同：-4
> 
> 时间：2012-05-26T01:32:14.477
> 
> 标签：php, javascript, google-maps-api-3

我想在地图上显示标记，但我只能看到第一个。问题是什么？

而标记没有显示任何

```
 <?php
 session_start();

 //connessione al DB
 include("dati_db.inc.php");

 mysql_connect($host,$username,$password)or die("Connessione IMPOSSIBILE al DBMS. TIPO ERRORE:".mysql_error());
 mysql_select_db($database)or die("IMPOSSIBILE selezionare il DataBase");

 $idric=$_GET['id_ric']; //id richiesta
 $sql = "SELECT * FROM richieste WHERE id=".$idric;
 $dati=mysql_query($sql);
 if (!$dati) {
    echo "Query non eseguita correttamente sul DB(".$sql."): ".mysql_error();
    exit;
 }

 $row=mysql_fetch_assoc($dati);
 $luogo=$row['luogo'];
 $indirizzo=$row['indirizzo'];
 $descrizione=$row['descrizione'];
 $oggetto=$row['oggetto'];
 $indirizzogoogle=$luogo." , ".$indirizzo;

?>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalableo"/>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
<title>Google Maps API v3: geocoding</title>
<style type="text/css">
html, body { margin:0; padding:0; width:100%; height:100%; }
body { background:#FFFFFF; color:#000000; font-family:Arial, Helvetica, sans-serif; font-size:12px; line-height:150%; text-align:center;}
#map { width:100%; height:95%; }
input { width:250px; }
#tooltip { padding:10px; text-align:left; }
#tooltip p { padding:0; margin:0 0 5px 0; }
</style>

<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false&language=it"></script>
<script type="text/javascript" src="inc/jquery-1.7.2.js"></script>
<script type="text/javascript" src="inc/myjs.js"></script>

<script type="text/javascript">

var createMap = function() {

    //indirizzo ricavato in precedenza del luogo dell'intervento
    var address = "<?php echo ($indirizzogoogle);?>";

    var geocoder = new google.maps.Geocoder();

    geocoder.geocode( {'address': address}, function(results,status) {
        if (status == google.maps.GeocoderStatus.OK) {

            var options = {
                zoom: 12,
                center: results[0].geometry.location,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };  

            var map = new google.maps.Map(document.getElementById('map'), options);

            var marker = new google.maps.Marker(
                {
                position: results[0].geometry.location,
                map: map,
                title: 'punto di intervento'
                }
            );

            var tooltip = '<div id="tooltip">'+
                '<p>Indirizzo punto di intervento<br>'+             
                results[0].formatted_address+'</p>'+
                '</div>';

            var infowindow = new google.maps.InfoWindow({
                content: tooltip
            });

            google.maps.event.addListener(marker, 'click', function() {
                infowindow.open(map,marker);
            });

            sedi = new Array();
            dim=0;
            //popoli vettore
            <?php 
                //recupero info di tutte le sedi
                $query="SELECT * FROM utenti WHERE tipo=3";
                $query_sedi=mysql_query($query);

                //per ogni record creiamo un MARKER
                $contcs=mysql_num_rows($query_sedi);

                if($contcs > 0){

                    //se ci sono records mostriamo tutte le sedi in un ciclo
                    while($line = mysql_fetch_array($dati, MYSQL_ASSOC)){
                        //recupero alcune informazioni
                        $sede = $line['sede'];  
                        echo ("cod_indirizzi($sede);\n");           

                    }
                }
                ?>

        } else {
          alert("Problema nella ricerca dell'indirizzo: " + status);
        }

      });
}; 

function cod_indirizzi(indirizzo){
    geocoder.geocode({'address':indirizzo}, function(result, status){
        map.setCenter(result[0].geometry.location);

        var marker= new google.maps.Marker
                    ({map:map,
                        position:result[0].geometry.location,
                        title: indirizzo});
    });
}

window.onload = createMap;
</script>
</head>
<body>

<div id="map"></div>
</body>
</html> 
```

获得的地图只有一个标记，您应该看到 3 错误是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T02:23:35.603

这是我做过的类似脚本可以帮助你使用`jquery 1.2.6`

```
(function() {
 window.onload = function() 
 {
     var ttl=["place1","place2","place3"];
     var options = {
 zoom: 13,
center: new google.maps.LatLng(28.550000, 77.22496000000001),
mapTypeId: google.maps.MapTypeId.ROADMAP
};
var map = new google.maps.Map(document.getElementById('map'), options); 
    // Creating an array that will contain the coordinates 
    var places = [];
    places.push(new google.maps.LatLng(28.550392878584265, 77.25169658660889));
    places.push(new google.maps.LatLng(28.546396951091907 , 77.19741940498352));
    places.push(new google.maps.LatLng(28.528748, 77.219663));    
      // Looping through the places array
      for (var i = 0; i < places.length; i++) 
      {
          // Adding the marker as usual
          var marker = new google.maps.Marker({
      position: places[i], 
      map: map,
      title: ttl[i]
      });      
  // Wrapping the event listener inside an anonymous function 
  // that we immediately invoke and passes the variable i to.
     (function(i, marker) {
      // Creating the event listener. It now has access to the values of
      // i and marker as they were during its creation

      google.maps.event.addListener(marker, 'mouseover', function() {
      var infowindow = new google.maps.InfoWindow({
      content: '<div style="overflow:hidden;">'+ttl[i]+'</div>'
      });           
      infowindow.open(map, marker);
      setTimeout(function () { infowindow.close(); }, 5000);  
     });      
})(i, marker);
   }
   }
   })(); 
```

HTML

```
 <div id="map"></div> 
```

CSS

```
#map {
width: 400px;
height: 400px;
border: 4px solid #ccc;
} 
```

# objective-c - 清空 UITapGestureRecognizer 缓冲区

> ID：10762990
> 
> 赞同：1
> 
> 时间：2012-05-26T01:32:20.410
> 
> 标签：objective-c, ios, buffer, uigesturerecognizer

我正在尝试设计一个非常简单的纸牌游戏。该功能基本上包括发现卡片以便仅点击它们。为此，我将卡片放在 UIView 上，然后在其他 UIView 上覆盖我捕获点击的位置。然后我只是计算出哪张牌被轻拍了，然后我把它翻过来。

问题是，如果我点击了一张错误的卡片，这个点击似乎会保留在一种缓冲区中，当我点击另一张卡片时，有时之前点击的卡片会在没有被点击的情况下翻转。这个缓冲区是真的还是我做错了什么？如果这个缓冲区是真实的，我如何在每次捕获新的点击时删除它的内容？

提前致谢。

> 问题解决了:)
> 这是问题所在的代码部分，在点击卡片和检查它是否是国王之间。

**[...] 这里有一些代码 [...]**

```
// And if what we have found is a king, then we uncover the next card in the game stack and .

if ([[gameWindow.deck getCardAtIndex:gameWindow.lastIndex] cardValue] == 9) {

//[self uncoverTheNextCardToPlay];

    do {

        [self uncoverTheNextCardToPlay];

    } while ([[gameWindow.deck getCardAtIndex:gameWindow.lastIndex] cardValue] == 9 && gameWindow.lastIndex < 40);
}

// And we update the realIndex with the real index index of the card just uncovered.

gameWindow.realIndex = ([[gameWindow.deck getCardAtIndex:gameWindow.lastIndex] cardSuit]*10)+[[gameWindow.deck getCardAtIndex:gameWindow.lastIndex] cardValue]; 
```

**[...] 更多代码在这里 [...]**

```
- (void)uncoverTheNextCardToPlay
{
    gameWindow.lastIndex = gameWindow.lastIndex+10;

    [[gameWindow.deck getCardAtIndex:gameWindow.lastIndex] setCover:NO];

    [[gameWindow.deck getCardAtIndex:gameWindow.lastIndex] refreshCardWithCardBack:gameWindow.cardBack];

    gameWindow.realIndex = ([[gameWindow.deck getCardAtIndex:gameWindow.lastIndex] cardSuit]*10)+[[gameWindow.deck getCardAtIndex:gameWindow.lastIndex] cardValue];
} 
```

# c++ - 如何构造 Foo 收到 Foo 后 ？

> ID：10762992
> 
> 赞同：2
> 
> 时间：2012-05-26T01:33:54.590
> 
> 标签：c++, templates

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T02:16:36.503

另一种选择是像分配器一样执行它并在 and 中提供一个模板`rebind`，如果您可以访问这些模板：`A``B`

```
template<class T>
struct A{
  template<class U>
  struct rebind{ typedef A<U> other; };
};

template<class AB>
struct C{
  typedef typename AB::template rebind<double>::other rebound_AB;
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-26T02:12:36.080

这可以通过引入我`translate`在以下代码中命名的帮助模板来解决：

```
template<class W>
struct A {
  typedef A type;
};

template<class W>
struct B {
  typedef B type;
};

template<class AB, class U>
struct translate {
};

template<template<typename> class AB, class W, class U>
struct translate<AB<W>, U> {
  typedef AB<U> type;
};

template<class AB>
struct C {
  // AB is A or B. If it's A we want to construct A<double>, if it's B                                                          
  // we want to construct B<double>:                                                                                            
  typedef typename translate<AB, double>::type D;
  D d;
};

int main(int argc, char** argv){
  C<A<int> > c1;
  C<B<int> > c2;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-26T02:11:16.970

为此，您需要部分模板规范：

```
// base declaration is undefined
template< typename AorB > struct C;

// declaration for A<W>
template< typename W >
struct C< A< W > >
{
    typedef A< double > type;
};

// declaration for B<W>
template< typename W >
struct C< B< W > >
{
    typedef B< double > type;
}; 
```

适用于具有一个类型参数的任何模板类的更一般情况是：

```
// base declaration is undefined
template< typename AorB > struct C;

// declaration for T<W>
template< template< typename > class T, typename W >
struct C< T< W > >
{
    typedef T< double > type;
}; 
```

# perl - 使用 Perl 解析 AVI 视频

> ID：10762993
> 
> 赞同：6
> 
> 时间：2012-05-26T01:34:38.830
> 
> 标签：perl, video, avi

我有一个监控 .avi 视频文件，其中大部分是静止的（不变的）帧。但是，某些物体（和人）会在短时间内进入视野并退出。我需要提取那些帧。

整个视频持续时间很长（24 小时以上），这使我无法实时重播。是否有可以按帧解析文件的 Perl 模块？有了它，我想我可以快速将帧转换为某个直方图并比较相邻帧以发现显着变化。该[网页](http://www.cs.ust.hk/~rossiter/mm_projects/video_key_frame/key_frame_index.html)详细说明了一般方法，但我找不到脚本（keyframe.pl）或使用的模块（授予.mpeg 文件）。

如果解析 .avi 的直接模块不存在，我可以将视频转换为 .mpeg（或任何其他形式），那么请直接将我指向其他可以解析文件的模块？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T09:44:56.080

我投票赞成原始评论，虽然我是 Perl 人，但这是错误的。我只想补充一点，对于监视和移动，有两个众所周知的工具：[http](http://www.lavrsen.dk/foswiki/bin/view/Motion/WebHome) ://www.lavrsen.dk/foswiki/bin/view/Motion/WebHome motion 和 zoneminder：[http://www.zoneminder。 com/](http://www.zoneminder.com/)在检测领域工作。motion 是建立在 ffmpeg 之上的，但我不确定它是否可以处理文件。

# jquery - 用于多维选择字段的 jQuery 选择器中的通配符

> ID：10762997
> 
> 赞同：2
> 
> 时间：2012-05-26T01:35:34.603
> 
> 标签：jquery, jquery-selectors

我有一堆这些选择字段..

```
<select name="options[0][option_group_id]" />
<select name="options[1][option_group_id]" />
<select name="options[2][option_group_id]" />
<select name="options[new3][option_group_id]" /> 
```

我想分配一个 onchange 事件，如下所示，其中 \S 是键 0、1、2、new3 的通配符...：

```
<script>
$("select[name^='options[\\S*][option_group_id]']").live("change", function(){
  alert('Houston we have contact!');
});
</script> 
```

但它不起作用。我该怎么做才能让它发挥作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T01:42:24.393

只需将其拆分为 2 个表达式：一个用于名称的开头，另一个用于其结尾：

```
$('select[name^="options"][name$="[option_group_id]"]') 
```

[http://jsfiddle.net/zerkms/enZLu/](http://jsfiddle.net/zerkms/enZLu/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T01:43:35.050

```
var pattern = /options\[\d{1,}\]\[option_group_id\]/;
$('select').filter(function(){
    return $(this).attr('name').match(pattern) !== null;
}).live(... 
```

# python - 尝试取消列表时出现 KeyError

> ID：10762999
> 
> 赞同：1
> 
> 时间：2012-05-26T01:36:45.367
> 
> 标签：python, pickle

我有一个包含浮动列表的腌制列表的文件。我可以在腌制它的同一台机器上毫无问题地加载列表，但是当我在另一台机器上尝试时，出现以下错误：

```
Traceback (most recent call last):
File "<console>", line 2, in <module>
File "/usr/lib/python2.7/pickle.py", line 1378, in load
  return Unpickler(file).load()
File "/usr/lib/python2.7/pickle.py", line 858, in load
  dispatch[key](self)
KeyError: '\x00' 
```

两个 python 版本是 2.7.0（在原始机器上）和 2.7.2（在尝试解开文件的那个）。我认为不应该仅仅因为这个而有任何不兼容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T02:13:12.537

> 我认为不应该仅仅因为这个而有任何不兼容。

除非在最近的版本中修复了 2.7.0 中的一些错误。检查他们的更改说明，我个人认为[问题 7117](http://bugs.python.org/issue7117)是最有可能的罪魁祸首：

> 问题 #7117：在几乎所有平台上：Python 中的浮点到字符串和字符串到浮点的转换现在已正确舍入。这些转换发生的地方包括： str 表示浮点数和复数；float 和 complex 构造函数；旧式和新式数字格式；使用 marshal、pickle 和 json 对浮点数和复数进行序列化和反序列化；解析 Python 代码中的浮点数和虚数文字；小数到浮点数的转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-09T11:03:18.823

我遇到了同样的问题并尝试了很多东西，但都是徒劳的。最后，我使用了cPickle，问题就解决了。只需将 'pickle' 替换为 'cPickle' 即可，一切正常。它具有完全相同的方法和参数。

```
import cPickle

cPickle.dump()

cPickle.load() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-27T20:54:31.547

使用 python 2.7.12 无法解开带有列表的 json 文件，即 *[{"k": 0},{"k": 1}]*

cPickle 没有帮助，json 有：

```
import json
json.load(open(file)) 
```