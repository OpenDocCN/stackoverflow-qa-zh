# StackOverflow 问答 11673000-11673999

# html - 网页无限向下滚动

> ID：11673007
> 
> 赞同：0
> 
> 时间：2012-07-26T15:41:59.003
> 
> 标签：html, infinite-scroll

所以我收到了这个改进网页的项目，它的行为很奇怪。当分辨率小于 900 像素（小型笔记本电脑和平板电脑）并且您到达页面末尾时，您可以在页脚图像之后无休止地向下滚动（它似乎会重复出现背景图像）。当我打开 firebug 时，所有分辨率都会发生这种情况。所有 div 都已正确关闭。我真的不知道这种行为背后的原因。可能之前有人看过...

这是我的页脚：

```
<footer>

 <div id="footer">

  <div id="footerContainer">

   <div id="footerMain">

    <div id="legal"></div>

    <div id="footerNav">

      <img src="images/table-footer.png" alt="">

     </div>

    </div>

   </div>

 </div>

</footer>

<a href="#" id="toTop"></a>
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:01:24.350

当屏幕高度低于某个数字时，#toTop 锚点被推到视口底部下方。这是因为无论使用什么脚本，都会将该锚的顶部值更改为比滚动位置多 x 数量。实现相同效果的更好方法是使家伙的底部值比视口底部多 10 左右。然后他不会走得太远，导致浏览器认为空间比实际空间多。

# c# - 从子中继器获取父中继器

> ID：11673009
> 
> 赞同：0
> 
> 时间：2012-07-26T15:42:01.370
> 
> 标签：c#, linq

我正在写出分解为年份和月份的链接列表，如下所示：

```
<ul>
  <li>2012</li>
  <ul>
    <li>July (12)</li>
    <li>June (8)<li>
    (etc)
  </ul>
  <li>2011</li>
    <li>July (7)</li>
    (etc)
  </li>
</ul> 
```

我正在使用两个中继器，一个用于年（“repYears”）和一个用于月的嵌套中继器（“repMonths”）。在repYears 的ItemDataBound 事件期间，我对repMonths 进行数据绑定。数据来自这些对象的通用列表：

```
public class ArchiveItem
{
    public ArchiveItem(long Id, string Month, int Year)
    {
        PostId = Id;
        Month = Month;
        Year = Year;
    }

    public long PostId { get; set; }
    public string Month { get; set; }
    public int Year { get; set; }
} 
```

到目前为止，我已经成功地写出了年份和月份。

我接下来需要做的是计算每月的项目数（即从上面的 HTML 中填充括号中的数字）。

为此（在 repMonths_ItemDataBound() 期间），我需要知道 repYears 中继器当前在哪一年。这将给我当前月份和当前年份，然后我可以从中计算出计数。

我可以轻松访问当前月份，因为我在 ItemDataBound 中，所以我可以使用 e.Item.DataItem。

那么如何从父中继器访问当前的 DataItem 值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:47:22.727

我不确定我是否明白这一点，因为您没有显示代码。

如果您在子中继器中`ItemDataBound`并且需要获取对父项的引用，则`DataItem`可以使用该`NamingContainer`属性：

在`ItemDataBound`子中继器中：

```
var repeater = (Repeater)sender;
var parentItem = (RepeaterItem)repeater.NamingContainer;
var parentDataItem = parentItem.DataItem; 
```

# google-analytics - 事件冲突与谷歌分析

> ID：11673010
> 
> 赞同：0
> 
> 时间：2012-07-26T15:42:07.287
> 
> 标签：google-analytics

我是谷歌分析的新手，就像我昨天被投入一个项目一样，我一直在梳理文档，试图找出我试图设置的 _trackEvent 有什么问题。

这是设置：我有一个设置了一些自定义事件的drupal 站点。我们跟踪的事件之一是出站链接，效果很好。我们想要做的是开始为其中一些链接创建特殊情况。因此，例如，我有一个带有以下代码的实时聊天按钮：

```
<a href='url/to/chat 
  onclick="_gaq.push(['_trackEvent','LiveChat','btnClick',this.href]);
  setTimeout(function(){this.newWindow = window.open(this.href);
  this.newWindow.focus(); 
  this.newWindow.opener=window;},200);
  return false;"><img alt='Live Chat Software' src='src/url' border='0'></a> 
```

所以我所做的是通过 ga_debug.js 运行调用。这是我得到的输出

```
_gaq.push processing "_trackEvent" for args: 
  "[Outbound links,Click,outgoing/url]": Track Event 
  Tracking beacon sent! 
```

这意味着在点击时发送事件。所以我很好奇为什么它发送出站链接事件而不是我的 LiveChat 事件？可能是范围问题吗？不确定，因为我知道出站链接是在全局级别定义的。有人有任何建议/见解/意见吗？在斥责我代码之前，我已经继承了这个项目，我只是想更好地理解它。

谢谢你，布罗迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T17:51:37.960

好的，事实证明这是一个范围界定问题。当他们最初为我们设置炸弹时，点击事件被注册到正文而不是内联。这就是吃内联事件。

经验教训：仔细检查范围

帮助 ga_debug.js 的工具

# javascript - 页面上未检测到 JavaScript (history.pushState)

> ID：11673016
> 
> 赞同：-1
> 
> 时间：2012-07-26T15:42:24.537
> 
> 标签：javascript, html, browser-history, pushstate

我一直在关注 Jeffery Way[在 Tuts+ 上的 history.pushState 教程](https://tutsplus.com/lesson/history-pushstate/)，但是我无法获得他的结果。

基本上，这是我的测试页面： http: [//leongaban.com/_tuts+/HTML5/](http://leongaban.com/_tuts+/HTML5/)

使用页面底部的脚本，URL 应该看起来像[http://leongaban.com/_tuts+/HTML5/page](http://leongaban.com/_tuts+/HTML5/page)但是什么也没发生，在 Chrome 和 Firefox 中，开发人员工具告诉我没有 JavaScript这页纸？

我的完整标记（与杰弗里的相同）：

```
<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8">
    <title>History – pushState</title>

</head>

<body>

    <ul>
        <li><a href="http://d2o0t5hpnwv4c1.cloudfront.net/2086_get-good-with-php/preview.png" title="Rockable">Rockable</a></li>

        <li><a href="http://tutsplus.s3.amazonaws.com/bestof/bestoftuts.jpg" title="Best">Best of Tuts</a></li>

        <li><a href="http://net.tutsplus.com/wp-content/uploads/2012/06/200x200.png" title="Advanced JS">Advanced JS</a></li>
    </ul>

    <script type="text/javascript">
        history.pushState(
            'Some data'
            'My Page Title'
            'page'
        );
    </script>

    </body>

    </html>

    <!--

    <script>
        history.go(-1); < Go back 1 page
        history.go(2); < Go forward 2 pages
        history.go(0); < Refresh current page
        history.forward(); < Forward 1 page
        history.back(); < Back 1 page
    </script>

    --> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:46:17.190

您需要将逗号传递给该函数，以分隔您传递给 pushState 的变量

```
 history.pushState(
            'Some data',
            'My Page Title',
            'page'
        ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T15:46:01.417

你需要逗号！我明白了`Uncaught SyntaxError: Unexpected string /_tuts+/HTML5/:31`

```
history.pushState(
    'Some data',
    'My Page Title',
    'page'
); 
```

# coldfusion - Coldfusion10 是否带有 cfcompile 实用程序，如果有，它在哪里？

> ID：11673019
> 
> 赞同：2
> 
> 时间：2012-07-26T15:42:33.870
> 
> 标签：coldfusion, compilation

根据文档，它应该位于根文件夹中，但是当我在整个硬盘驱动器中搜索“cfcompile”时，什么也没有出现。当我从命令提示符运行 cfcompile 时，它​​也不起作用。

有人可以告诉我 ColdFusion10 的免费版本是否带有 cfcompile 以及如果是的话如何访问它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T21:42:42.010

根据 bug 数据库，它*不*包含在 ColdFusion 10 中。它目前被列为 open/tofix，因此请随意投票：[bug #3197628](https://bugbase.adobe.com/index.cfm?event=bug&id=3197628)。

（我猜这与切换到 Tomcat 有关，因为`cfcompile.bat`引用的旧文件`jrun.jar`，由于显而易见的原因，它也不再包含在内。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-08-21T22:56:28.330

CFCompile 问题已在 CF10 中修复。

## 请按照以下步骤将文件编译为字节码。

步骤 1：转到文件夹 C:\Development\Servers\ColdFusion\cfusion\bin

## 句法

cfcompile -部署

## 例子

cfcompile -deploy C:\Development\Servers\ColdFusion\cfusion\wwwroot C:\FilesToCompile C:\compiledFiles

# hibernate - JPA (Hibernate) 和在运行时设置实体监听器

> ID：11673022
> 
> 赞同：3
> 
> 时间：2012-07-26T15:42:43.700
> 
> 标签：hibernate, jpa, runtime, entitylisteners

我有两个项目：

*   **带有 JPA 实体（为 JSON/XML 序列化注释）和`persistence.xml`文件的**beans.jar****
***   **rest.war**与 REST 应用程序，其中 JPA`EntityManagerFactory`使用自定义属性实例化，例如`hibernate.connection.*`**

 **我想分发 beans.jar 以获得更好的客户端编程便利。到目前为止很好。

有些实体在`@PrePersist`事件中有代码（实际上是盐化密码哈希），我不想分发。我可以将该代码推送到 JPA 实体侦听器，但是在`@EntityListeners`注释中引用了侦听器类，因此也必须在 beans.jar 中。

是否可以在运行时（即在 rest.war 项目中**）为一个（或所有）实体类设置 JPA 实体侦听器？**

也许有一些休眠属性，我忽略了......谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-08T01:04:58.760

这为所有实体设置了一个通用的 EntityListener。

创建一个名为 orm.xml 的文件并将其放在与 persistence.xml 文件相同的目录中（例如 META-INF）。我不确定这是否可以放入战争文件中。orm.xml 文件的内容应该如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<entity-mappings version="2.0" xmlns="http://java.sun.com/xml/ns/persistence/orm" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence/orm orm_2_0.xsd">
   <persistence-unit-metadata>
      <persistence-unit-defaults>
         <entity-listeners>
            <entity-listener class="nathan.db.Listener"/>
         </entity-listeners>
      </persistence-unit-defaults>
   </persistence-unit-metadata>
</entity-mappings> 
```

然后创建一个名为 Listener 的类。

```
package nathan.db;

import javax.persistence.PrePersist;

public class Listener
{
   @PrePersist
   public void event(Object entity)
   {
      // salt password
   }
} 
```**

# c++ - 用于 AVR 的 C/C++ 中的数组不断追加

> ID：11673024
> 
> 赞同：2
> 
> 时间：2012-07-26T15:42:46.613
> 
> 标签：c++, c, global-variables, avr

在 C 中，我有一个数组等待从传感器接收字节，保存在缓冲区中，然后像这样打印出来：

```
unsigned char responseFrame[300];

int main(void) {
   UART_init();
   while(1) {
       receive(responseFrame);
       myLog(responseFrame, sizeof(responseFrame));
   }
} 
```

我通过执行以下操作来填充数组：

```
void receive(unsigned char *rcv_buff) {
    uint8_t recv_data;

    for (int i=0; i<300; i++){
            USART1_Flush();
        rcv_buff[i] = USART1_RX();
    }
} 
```

然后我使用以下命令打印出缓冲区中的内容：

```
// Logs this output to the serial port; used for debugging
void myLog(unsigned char *msg, int size) {
    for (int i=0; i<size; i++) {
        USART0_TX(msg[i]);
    }
} 
```

这会打印出数组，但是当接收到另一个字节迭代时，会附加所有内容，所以假设我首先收到 {0xFF, 0xFF} 我第一次迭代的输出是：

```
0xFF 0xFF, 0x00, 0x00 ... 0x00 
```

但是在下一次迭代中，假设接收到 {0x0A, 0x0A}，在输出中我看到：

```
0xFF, 0xFF, 0x0A, 0x0A, 0x00, 0x00 ... 0x00 
```

注意：省略号只是说打印出更多的 0x00，直到我们基本上达到数组的大小。

为什么这个附加而不是从数组的开头覆盖？

这是我的 USART0_TX 和 USART1_RX 函数：

```
void USART0_TX(uint8_t myData) {
    // Wait if a byte is being transmitted
    while( !(UCSR0A & (1<<UDRE0)) );
    // Transmit data
    UDR0 = myData;
};
uint8_t USART1_RX(void) {
    // Wait until recv buffer is full
    while( !(UCSR1A & (1<<RXC1)) );
    // Return recvd data
    return UDR1;
}; 
```

这是我用来刷新 USART1 RX 的代码：

```
//USART1 flush, clears USART1 buffer
void USART1_Flush( void )
{
    unsigned char dummy;
    while ( UCSR1A & (1<<RXC1) ) dummy = UDR1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T19:52:00.720

我相信您的名为“Flush”的函数实际上是一个“轮询”函数，正在寻找要出现的字符（这将是正常用法，请等待字符出现）。使用 RXC1 的逻辑出现反转。试着看看这个看起来很专业的 AVR 驱动程序（就像你正在做的那样有一个轮询选项）：

[usart.c](http://www.raphnet.net/divers/anemometre/windmon_avr/usart.c)

另一个好评如潮的轮询驱动程序（并且很小，有很多评论）：[avr uart driver](http://www.nerdkits.com/library/codelib_uartterm/)

# c++ - 入门帮助。C++ 和在代码块中编译

> ID：11673025
> 
> 赞同：2
> 
> 时间：2012-07-26T15:42:47.423
> 
> 标签：c++, codeblocks

很抱歉，这很可能是一个非常“新手”的问题，但我在 code::blocks 中运行 C++ 代码时遇到了一点问题。关于我当时正在做什么，基本上我正在关注 Bjarne Stroustrup 的“编程：使用 C++ 的原则和实践”。我真的只是开始这本书，为此我在 Ubuntu 12.04 上使用 code::blocks。无论如何，对于第一个 hello world 示例，我执行了以下操作：

首先建立一个新项目 -> 选择控制台应用程序 -> 选择 C++ 作为我的语言 -> 输入项目名称 -> 选择 GNU GCC Compiler （从阅读和搜索这可能是问题） -> 最后输入编码。

我还确保正确下载并保存“std_lib_facilities.h”头文件。完成所有这些后，我输入了简单的 hello world 代码，如下所示。在构建代码时，它产生了以下警告（尽管没有错误）：“#warning 此文件包含至少一个已弃用或过时的标头，可能会被删除...”单击它会导致我进入“backward_warning.h”。但是，我仍然可以运行产生 hello world 的代码，使其看起来很好，就像它应该的那样。这可能意味着我没有问题，但警告仍然存在，我只是想知道是否有修复，或者它是否意味着有任何问题，因为我不想在后面的示例中发现这证明了成为一个问题。这似乎都是一个愚蠢的问题，但我 我是 C++ 新手，但对一般编程来说还是很新的，所以提前道歉。这是我的代码：

```
#include "../std_lib_facilities.h"

int main()
{
cout<<"Hello World";
return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:54:26.950

很有可能`<hash_map>`或`<ext/hash_map>`。

替代品将是 C++11's`<unordered_map>`或 C++03's `<tr1/unordered_map>`。

如果您使用的是 GCC，则可以通过添加`std=c++0x`编译标志来访问 C++11 功能。这将允许您使用`<unordered_map>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:51:56.653

本书中的示例对于您的 Ubuntu 来说可能已经很老了。尝试用新的标题替换已弃用的标题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:16:00.110

这个简单的“Hello World”应用程序只需要一个包含指令：

```
#include <iostream> 
```

我建议在需要之前避免使用“std_lib_facilities.h”。

# java - Drools 知识库大小

> ID：11673027
> 
> 赞同：3
> 
> 时间：2012-07-26T15:42:54.927
> 
> 标签：java, drools, heap-memory, business-rules, rule-engine

计算（没有序列化）Drools KnolwedgeBase 将占用的堆内存量（以字节为单位）的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T10:05:19.543

我很想知道你为什么需要知道这个？知识库大小与您计划添加到其中的知识包的数量有关，因此它实际上取决于您计划在规则或流程中执行的操作。干杯

# java - AsyncTask 和应用程序的生命周期？

> ID：11673030
> 
> 赞同：0
> 
> 时间：2012-07-26T15:43:03.273
> 
> 标签：java, android

我的应用程序从创建开始`MyApplication extends Application`

我有通过警报在后台运行的服务，当服务完成运行（获取 GPS 位置）时，我`AsyncTask`从该服务开始与我的服务器同步。

以下是我的理解：

1.  在 Android 操作系统中一次`Application`只能运行一个。我说的是我的应用程序的实例。因此，我无法从同一个包中运行我的 Application 对象的 2 个实例。
2.  如果我看到我登录的消息`Application.onCreate()`，这意味着操作系统关闭了我的应用程序。
3.  服务在 UI 线程上运行，即使不可见。
4.  如果我`AsyncTask`从我的服务中生成并且操作系统杀死了我的应用程序 - AsyncTask 也会终止。我无法控制 AsyncTask 的正常终止。
5.  如果我安排了警报并且应用程序已关闭 - 操作系统将发送广播，该广播将依次启动应用程序然后服务。
6.  警报每 5 分钟启动一次服务。服务尝试获取最多 1 分钟的位置，并在完成后启动 AsyncTask。因此，我的 AsyncTask 在下一次服务启动前还有 4 分钟。在异步任务中，我进行数据库访问，这会导致下面列出的问题..

我的理解正确吗？我之所以问这个问题是因为我从所有运行应用程序的设备中写入日志，并且有时会观察到奇怪的行为。大多数设备几乎 24/7 运行应用程序，但在某些设备上我一直看到 Application_Start 记录事件。

有什么方法可以模拟系统关闭应用程序以进行测试吗？我做错了什么，需要以不同的方式做吗？我想同步我的后台处理，因为有很多数据读/写并且它正在阻塞..

```
java.lang.RuntimeException: An error occured while executing doInBackground()
 at android.os.AsyncTask$3.done(AsyncTask.java:299)
 at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
 at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
 at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
 at java.util.concurrent.FutureTask.run(FutureTask.java:137)
 at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
 at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
 at java.lang.Thread.run(Thread.java:856)
Caused by: android.database.sqlite.SQLiteCantOpenDatabaseException: unable to open database file (code 14)
 at android.database.sqlite.SQLiteConnection.nativeExecuteForCursorWindow(Native Method)
 at android.database.sqlite.SQLiteConnection.executeForCursorWindow(SQLiteConnection.java:838)
 at android.database.sqlite.SQLiteSession.executeForCursorWindow(SQLiteSession.java:836)
 at android.database.sqlite.SQLiteQuery.fillWindow(SQLiteQuery.java:62)
 at android.database.sqlite.SQLiteCursor.fillWindow(SQLiteCursor.java:143)
 at android.database.sqlite.SQLiteCursor.getCount(SQLiteCursor.java:133)
 at android.database.AbstractCursor.moveToPosition(AbstractCursor.java:196)
 at android.database.AbstractCursor.moveToFirst(AbstractCursor.java:236)
 at com.idatt.data.LockData.Lock(LockData.java:37)
 at com.idatt.common.AsyncProcessor.doInBackground(AsyncProcessor.java:154)
 at com.idatt.common.AsyncProcessor.doInBackground(AsyncProcessor.java:18)
 at android.os.AsyncTask$2.call(AsyncTask.java:287)
 at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
 ... 4 more
android.database.sqlite.SQLiteCantOpenDatabaseException: unable to open database file (code 14)
 at android.database.sqlite.SQLiteConnection.nativeExecuteForCursorWindow(Native Method)
 at android.database.sqlite.SQLiteConnection.executeForCursorWindow(SQLiteConnection.java:838)
 at android.database.sqlite.SQLiteSession.executeForCursorWindow(SQLiteSession.java:836)
 at android.database.sqlite.SQLiteQuery.fillWindow(SQLiteQuery.java:62)
 at android.database.sqlite.SQLiteCursor.fillWindow(SQLiteCursor.java:143)
 at android.database.sqlite.SQLiteCursor.getCount(SQLiteCursor.java:133)
 at android.database.AbstractCursor.moveToPosition(AbstractCursor.java:196)
 at android.database.AbstractCursor.moveToFirst(AbstractCursor.java:236)
 at com.idatt.data.LockData.Lock(LockData.java:37)
 at com.idatt.common.AsyncProcessor.doInBackground(AsyncProcessor.java:154)
 at com.idatt.common.AsyncProcessor.doInBackground(AsyncProcessor.java:18)
 at android.os.AsyncTask$2.call(AsyncTask.java:287)
 at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
 at java.util.concurrent.FutureTask.run(FutureTask.java:137)
 at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
 at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
 at java.lang.Thread.run(Thread.java:856) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T17:30:38.320

1.  错误的 。android 真的可以同时运行多个进程和线程（和应用程序）。它一直都在这样做，尽管它通常为前台应用程序提供比其他应用程序更多的 CPU。此外，即使我从未做过，也可以运行您自己的应用程序的多个实例并使用多个进程。

    但是，如果您的应用程序在不在前台（例如游戏）时不应该使用 CPU，请尝试这样做。没有人希望有一个应用程序在它似乎没有运行时会耗尽电池电量。

2.  非常错误。应用程序的 onCreate 发生在开头。如果它出现多次，则意味着它已重新启动（由操作系统或用户）。

3.  正确的 。对于后台工作，请使用工作线程。

4.  要看 。如果您将服务作为前台服务启动（带有通知），操作系统将给予服务的终止非常低的优先级。

5.  取决于你的应用做什么。如果它这样做，它会以这种方式发生。

6.  当您创建后台服务时，您必须记住，只要操作系统认为它不执行重要任务，就可以将其关闭。这就是为什么当这种事情发生时你必须能够恢复你的工作。

# jquery-plugins - Tinymce（有时）未定义

> ID：11673033
> 
> 赞同：5
> 
> 时间：2012-07-26T15:43:10.527
> 
> 标签：jquery-plugins, tinymce

我在我正在工作的项目中使用 Tinymce（带有 jQ​​uery）；我们使用富文本编辑器供用户输入信息；但是，有时在加载页面时，Firefox 和 Chrome 会检测到“未定义小号”错误（有时在不同的代码行中），而其他时候页面会正常加载。奇怪的是它与 IE 完美配合。

这是我正在使用的一些代码：

```
view.find('textarea.rich-text').each(function () {        
   $(this).tinymce( /* ...rules... */);        
}); 
```

后来

```
_variable.find("#summary").tinymce().setContent(content); 
```

这一行是错误（有时）被捕获的地方。在我看来，这个问题是一个加载问题，即使 tinyMCE 插件在此行之前初始化了大约 5000 行。

**更新**：现在我已经设法用 setTimeout 来“解决”这个问题，但这似乎是一种非常丑陋的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T00:20:01.947

几点：

*   您没有提到 TinyMCE 初始化是否在 jQuery`ready`事件函数中完成。当然应该。

*   您不需要每个循环。你可以说：

`$('textarea.rich-text').tinymce({ script_url : '../js/tinymce/jscripts/tiny_mce/tiny_mce.js', theme : "advanced", ... });`

*   您不需要调用，`find`因为您只是按 id 选择。做就是了：

`$("#summary").tinymce().setContent(content);`

*   您真正的问题可能是当您收到错误时tinymce 尚未完成自身初始化。您会看到它必须从已配置的`script_url`. 这可能需要一段时间。因此，您必须使用诸如[oninit](http://www.tinymce.com/wiki.php/Configuration%3aoninit)之类的回调。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-28T10:42:58.880

如果您无法控制 TinyMCE 的 init 方法，则可以遵循此解决方案。

```
jQuery(document).ready(function($) {

    function myCustomSetContent( id, content ) {
        // Check if TinyMCE is defined or not.
        if( typeof tinymce != "undefined" ) {
            var editor = tinymce.get( id );
            // Check if TinyMCE is initialized properly or not.
            if( editor && editor instanceof tinymce.Editor ) {
                editor.setContent( text );
                editor.save( { no_events: true } );
            } else {
                // Fallback
                // If TinyMCE is not initialized then directly set the value in textarea.
                //TinyMCE will take up this value when it gets initialized.
                jQuery( '#'+id ).val( text );
            }
            return true;
        }
        return false;
    }

    function myCustomGetContent( id ) {
        // Check if TinyMCE is defined or not.
        if( typeof tinymce != "undefined" ) {
            var editor = tinymce.get( id );
            // Check if TinyMCE is initialized properly or not.
            if( editor && editor instanceof tinymce.Editor ) {
                return editor.getContent();
            } else {
                // Fallback
                // If TinyMCE is not initialized then directly set the value in textarea.
                // TinyMCE will take up this value when it gets initialized.
                return jQuery( '#'+id ).val();
            }
        }
        return '';
    }

    $(".class-to-update-content").on("click", function(e) {
        myCustomSetContent( "tinymce-editor-id", "New Content in Editor" );
    });

    $(".class-to-get-content").on("click", function(e) {
        $("div.class-to-display-content").html( myCustomGetContent( "tinymce-editor-id" ) );
    });
}); 
```

参考：[http ://blog.incognitech.in/tinymce-undefined-issue/](http://blog.incognitech.in/tinymce-undefined-issue/)

**编辑：**包括解决方案

# apache - apache重写规则

> ID：11673037
> 
> 赞同：0
> 
> 时间：2012-07-26T15:43:20.700
> 
> 标签：apache, mod-rewrite, url-rewriting

我正在尝试重写以下网址

```
http://blog.mywebsite.com:8080/wp-admin/users.php?paged=2 
```

作为

```
http://mywebsite.com/blog/wp-admin/users.php?paged=2 
```

我尝试了各种重写条件和规则

```
RewriteCond %{QUERY_STRING} ^(.*)$ [NC]
RewriteRule blog.mywebiste.com(.*)$ mywebsite.com/blog/$1 
```

当我这样做时，我似乎松开了查询字符串

```
RewriteRule ^/wp-admin(.*) http://mywebsite.com/blog/wp-admin$1 
```

这似乎根本没有抓住它

我也有重写登录。这是什么时候写的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:04:59.317

它应该在没有前导斜杠的情况下工作：

```
RewriteRule ^wp-admin/(.*)  http://mywebsite.com/blog/wp-admin/$1 
```

# mysql - 除了多个 OR 之外，还需要 WHERE AND 子句

> ID：11673038
> 
> 赞同：0
> 
> 时间：2012-07-26T15:43:21.133
> 
> 标签：mysql

我需要从 't'（线程）返回所有包含 'menu_item_id' = 1 的项目。

另外，我需要根据f.tag对以上所有结果进行过滤。

```
SELECT t.*, u.username AS owner, uu.username AS replyname, a.location
FROM thread t
INNER JOIN filter_thread as ft ON t.thread_id = ft.thread_id
INNER JOIN filter as f ON f.filter_id = ft.filter_id
INNER JOIN users u ON t.owner_id = u.id 
INNER JOIN users uu ON t.last_post_id = uu.id
INNER JOIN user_profiles AS up ON u.id = up.user_id
INNER JOIN avatars AS a ON up.avatar_id = a.id
WHERE t.menu_item_id='1'
AND f.tag LIKE '%hello%'
OR f.tag LIKE '%world%' 
```

问题区域：`AND f.tag LIKE '%hello%' OR f.tag LIKE '%world%'`

要意识到的重要一点是，'hello' 和 'world' 可能并不总是在查询中。此外，可能还会添加 3 个搜索，但`menu_item_id`始终会搜索。

我不希望所有结果都需要每个 f.tags，我只想让结果包含它们中的任何一个（OR）。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:45:39.450

比如……括号？

```
SELECT t.*, u.username AS owner, uu.username AS replyname, a.location
FROM thread t
INNER JOIN filter_thread as ft ON t.thread_id = ft.thread_id
INNER JOIN filter as f ON f.filter_id = ft.filter_id
INNER JOIN users u ON t.owner_id = u.id 
INNER JOIN users uu ON t.last_post_id = uu.id
INNER JOIN user_profiles AS up ON u.id = up.user_id
INNER JOIN avatars AS a ON up.avatar_id = a.id
WHERE t.menu_item_id='1'
AND (
    f.tag LIKE '%hello%'
 OR f.tag LIKE '%world%'
) 
```

如果问题是这个查询是动态进行的，只需`1`在前面添加一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T15:45:25.553

使用括号指定`AND`and的优先级`OR`。

```
a AND (b OR c) 
```

对比

```
(a AND b) OR c 
```

例如：

```
WHERE t.menu_item_id='1'
  AND (    f.tag LIKE '%hello%'
        OR f.tag LIKE '%world%'
      ) 
```

这将仅返回具有 menu_item_id = '1' 并且具有包含 'hello' 或 'world' 的标签的行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:30:00.103

下面是通过 PHP 动态生成的最终代码：

```
 $sql_select = "SELECT t.*, u.username AS owner, uu.username AS replyname, a.location";
    $sql_from = " FROM ";
    $sql_where = " WHERE ";
    $sql_joins = "";
    $sql_order = " ORDER BY t.replystamp DESC
                    LIMIT $threadstart, $limit";  
    $sql_from .= ' thread t ';
    $sql_where .= " t.menu_item_id=$menu_item_id";
    $sql_joins .= ' INNER JOIN filter_thread as ft ON t.thread_id = ft.thread_id
                    INNER JOIN filter as f ON f.filter_id = ft.filter_id
                    INNER JOIN users u ON t.owner_id = u.id 
                    INNER JOIN users uu ON t.last_post_id = uu.id
                    INNER JOIN user_profiles AS up ON u.id = up.user_id
                    INNER JOIN avatars AS a ON up.avatar_id = a.id';
    if ($ac_total > 0) {
        $sql_where .= " AND (";
        for ($i=0; $i < $ac_total; $i++)
        {
            if ($i == 0)
            {
                $sql_where .= "f.tag LIKE '%$active_category[$i]%'";
            } else {
                " OR f.tag LIKE '%$active_category[$i]%')";
            }
        }
        $sql_where .= ")";
    }
    $sql = $sql_select . $sql_from . $sql_joins . $sql_where . $sql_order;
    $query = $this->db->query($sql); 
```

谢谢您的帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T15:46:51.733

我不确定这是否能回答你的问题，但我喜欢用括号让事情更容易阅读，就像这样

```
SELECT t.*, u.username AS owner, uu.username AS replyname, a.location
FROM thread t
INNER JOIN filter_thread as ft ON t.thread_id = ft.thread_id
INNER JOIN filter as f ON f.filter_id = ft.filter_id
INNER JOIN users u ON t.owner_id = u.id 
INNER JOIN users uu ON t.last_post_id = uu.id
INNER JOIN user_profiles AS up ON u.id = up.user_id
INNER JOIN avatars AS a ON up.avatar_id = a.id
WHERE t.menu_item_id='1'
AND (f.tag LIKE '%hello%'
OR f.tag LIKE '%world%') 
```

现在它说 where t.menu_item_id = 1 AND 括号中的任一条件为真，而不是说 (t.menu_item_id = 1 AND f.tag LIKE '%hello%') OR f.tag LIKE '%world% '

希望有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T15:47:52.183

为什么不用括号？

```
WHERE t.menu_item_id='1' AND (f.tag LIKE '%hello%' OR f.tag LIKE '%world%') 
```

# jqgrid - jqGrid 分页按钮只能一键工作

> ID：11673042
> 
> 赞同：1
> 
> 时间：2012-07-26T15:43:31.697
> 
> 标签：jqgrid, paging

我在我的项目中使用 jqGrid 并遇到了一个奇怪的分页问题。我可以单击下一页按钮并从第 1 页转到第 2 页，但是在此之后我按下的任何其他分页按钮都会卡在第 2 页并且无法转到其他页面。但是，我可以输入页码，按回车键，然后它会更新显示的页面。我在下面粘贴了 jqGrid 代码。

```
jQuery(document).ready(function(){ 
jQuery("#groupsTable").jqGrid({

  jsonReader: {
       root:"rows",
       page:"page",
       total:"total",
       records:"records",
       repeatitems:false,
       cell:"",
       id:"id",
       userdata:"userdata"
     },
  url:'project/selectTable/loadTableInfo.do',
  datatype:'json',
  colNames:['Name','Size', 'Number', 'Search','Delete'],
  colModel:[
  {name:'name',index:'name', width:500, sorttype:'text', searchoptions:{sopt:['cn']}, 
  {name:'size',index:'size', sorttype:'int', width:150, searchoptions:{sopt:['le']}},
  {name:'mailList',index:'mailList',sorttype:'int', width:150, searchoptions:{sopt:['le']}},
  {name:'search',index:'search', stype:'select', width:60, sortable:false},
  {name:'delete',index:'delete',width:60, stype:'select', sortable:false}],
  pager:'#pager',
  loadonce:true,
  rowNum:50,
  rowList:[10,25,50,75,100,500],
  viewrecords:true,
  height:600,
  pgbuttons:true,
  pginput:true,
  loadComplete: function(){                
    var ids = jQuery("#groupsTable").getDataIDs(); 
    for(var i=0;i<ids.length;i++){ 
      var cl = ids[i]; 
      X = "<span class='delete' onClick=deleteRow("+cl+");></span>"
      searching = "<span class='search' onClick=search("+cl+");></span>"
      jQuery("#groupsTable").setRowData(ids[i],{delete:X});
      jQuery("#groupsTable").setRowData(ids[i],{search:searching});
      }
    jQuery('#groupsTable').filterToolbar({searchOnEnter:false});
    jQuery('#groupsTable')[0].triggerToolbar();
  },
  caption:'General Info'
});
}); 
```

和html：

```
<table id="groupsTable"></table> 
<div id="pager"></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:59:50.947

我认为您以错误的方式实现 rowList，请在此链接中阅读 rowList 的定义

[http://www.trirand.com/jqgridwiki/doku.php?id=wiki:first_grid](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:first_grid)

或者也可能是版本问题，请检查此链接..

[http://www.trirand.com/blog/?page_id=393/help/default-rowlist/](http://www.trirand.com/blog/?page_id=393/help/default-rowlist/)

希望对你有帮助

# php - 有没有办法覆盖 cap deploy:setup 任务？

> ID：11673043
> 
> 赞同：1
> 
> 时间：2012-07-26T15:43:31.980
> 
> 标签：php, ruby, symfony1, capistrano, capifony

我在哪里可以找到 capifony/capistrano 任务以覆盖它们。

我想在运行 cap deploy:setup 时对其进行修改以添加额外的符号链接以适应我的服务器结构。那可能吗？或者至少要编写一个新任务来执行此操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T03:22:46.237

上限任务列表： [http ://capitate.rubyforge.org/recipes/deploy.html](http://capitate.rubyforge.org/recipes/deploy.html)

要覆盖任务，请执行以下操作：

```
 namespace :deploy do
  task :start do ; end
  task :stop do ; end
  task :restart do ; end
  task :update_code do ; end #override this task to prevent capistrano to upload on servers
  task :symlink do ; end #don't create the current symlink to the last release
 end 
```

# xml - 如何使用 XSLT 匹配文档中的第一个元素？

> ID：11673044
> 
> 赞同：0
> 
> 时间：2012-07-26T15:43:31.590
> 
> 标签：xml, xslt

[这是如何使用 XSLT 选择第一个元素](https://stackoverflow.com/questions/1498819/how-can-i-select-the-first-element-using-xslt)的后续内容？.

```
<xml>
    <news>
        <newsitem>
            <dateCreated>2009-09-09</dateCreated>
            <summary>Something great happened</sumamry>
        </newsitem>
        <newsitem>
            <dateCreated>2009-09-08</dateCreated>
            <summary>Something bad happened</sumamry>
        </newsitem>
    </news>
    <news>
        <newsitem>
            <dateCreated>2009-09-07</dateCreated>
            <summary>Something really bad happened</sumamry>
        </newsitem>
    </news>
</xml> 
```

如何匹配`newsitem`文档中的第一个元素？另一个问题中的`xsl:template match="//newsItem[1]"`匹配将得到第一个孩子。`xsl:template match="(//newsItem)[1]"`无效。我得到的唯一其他提示涉及用钥匙做一些复杂/凌乱的事情，似乎应该有更好的答案，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T01:36:24.577

**在 XSLT 1.0 中可以使用这个**：

```
newsitem[not(ancestor::newsitem or preceding::newsitem)] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:27:20.040

如果我理解这个问题，我认为你应该使用：

```
<xsl:template match="//news[1]/newsitem[1]"> to select the first item of all. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T22:25:04.060

没有简单的匹配模式可以选择文档中名称 newsitem 的第一个元素。您可以使用谓词来做到这一点：

```
match="newsitem[not(preceding::newsitem)]" 
```

但性能可能很糟糕。

使用 XSLT 2.0 最好的解决方案是绑定一个全局变量并对其进行测试：

```
<xsl:variable name="first-newsitem" select="(//newsitem)[1]"/>

<xsl:template match="newsitem[. is $first-newsitem]"/> 
```

# linux - 使用 Jenkins、CMake 和 pkg-config 构建多个项目的首选方式？

> ID：11673047
> 
> 赞同：2
> 
> 时间：2012-07-26T15:43:38.827
> 
> 标签：linux, jenkins, cmake, pkg-config

我正在开发两个库 A 和 B，其中 B 取决于 A，它们都在自己的 Git 存储库中进行管理。这些库使用 CMake 构建并安装在标准 UNIX 目录中。在安装过程`.pc`中，还会安装一个由`pkg-config`. 库 B 用于`pkg-config`查找库 A，因此有必要在系统范围内安装库 A，`make install`或者将`PKG_CONFIG_PATH`其设置为适当的目录。

现在，我使用 Jenkins 在远程机器上构建库 A。不幸的是，由于不满足依赖关系（`pkg-config`找不到库 A） ，因此无法构建库 B。在预构建步骤中设置路径不起作用，因为命令在其自己的 shell 中运行。

问题是

*   我可以以某种方式`make install`图书馆A吗？或者，
*   我可以以某种方式指向 CMake`/var/lib/jenkins/jobs/libA/install_dir/lib`吗？
*   有没有更好的方法来构建具有相互依赖的库的项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:56:22.150

按顺序回答您的问题：

安装库 A - 您可以配置构建库 A 的 Jenkins 作业以将库归档为构建工件。然后构建库 B 的作业可以在运行开始时从 Jenkins 下载人工制品——例如 http:///job/libA/lastSuccessfulBuild/artifact/
一旦库 B 作业收集了库 A，就可以安装和使用它.

配置 Cmake – 我对 cmake 了解不够，所以恐怕无法回答。

有没有更好的方法 - 可能使用 Rake，我们使用它来控制具有大量依赖项的构建链。虽然我不确定如果必须在远程机器上构建库 A，它会如何工作。如果两个库都构建在同一台机器上，事情可能更容易管理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T19:58:21.123

正如 user1013341 所建议的那样，使用工件是解决此问题所需的步骤之一。但要让它工作，`pkg-config`我们必须做更多的事情：

1.  我设置库 A`CMakeLists.txt`以生成带有`make package_source`.
2.  成功构建库 A 后，Jenkins 创建此 tarball 并将其存储为工件。
3.  库 B 使用[Copy Artifact Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Copy+Artifact+Plugin)获取 tarball 并解压缩它。在 tarball 里面仍然有构建的项目和`.pc`指向库 A 安装位置的文件。
4.  在下一个构建步骤中，我使用[EnvInject 插件](https://wiki.jenkins-ci.org/display/JENKINS/EnvInject+Plugin)将`PKG_CONFIG_PATH`和设置为未解压缩`LD_LIBRARY_PATH`的库 A。
5.  最后但同样重要的是，可以启动正常的 CMake 构建过程，并根据环境变量选择正确的路径。

# ruby-on-rails-3 - RnR：数据库规范化、rails 模型和关联

> ID：11673050
> 
> 赞同：0
> 
> 时间：2012-07-26T15:44:03.150
> 
> 标签：ruby-on-rails-3, activerecord, rails-migrations, model-associations

好的，所以我有三个不同的对象：人、地点和设备。每个人都可以有一个地址，在大多数情况下是多个地址和多个电话号码。所以我的想法是创建特定的对象表，有一个地址和一个电话表。这是我的问题：

所以通常，在我的 SQL 世界中，我只会在 address 和 phone 表中有一个 object_id 列，并将对象的 id 放在 object id 列中，然后选择所有匹配的地址或电话记录。

我可以这样做，执行 find_by_sql 并获取记录，但我宁愿留在 ActiveRecord 范式中。那么这是否意味着我应该在每个对象的表中都有一个 id 列，所以 person_id、place_id 等。

对此建模的“正确”方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:11:38.320

您可以使用 activerecord 创建多态关联，因此您可以将`object_id`和添加`object_type`到地址和电话号码表中，并像这样指定关联：

```
class Address
  belongs_to :object, :polymorphic => true
end

class PhoneNumber
  belongs_to :object, :polymorphic => true
end

class Person
  has_many :addresses, :as => :object
  has_many :phone_numbers, :as => :object
end

class Place
  has_many :addresses, :as => :object
  has_many :phone_numbers, :as => :object
end

class Equipment
  has_many :addresses, :as => :object
  has_many :phone_numbers, :as => :object
end 
```

这样，`Person.first.addresses`应该运行类似的查询`Addresses.where(:object_type => "Person", :object_id => Person.first.id)`，对于其余的模型和关联，反之亦然。

# php - 如何将表格 html 输入到 PHP 电子邮件代码

> ID：11673067
> 
> 赞同：0
> 
> 时间：2012-07-26T15:44:53.323
> 
> 标签：php, html, zend-framework

这是我当前的代码：

![当前代码](../Images/155a9fae03523c51ff29ee19bfe86cff.png)

我想添加一些表格来更改电子邮件的设计，我对 PHP 和 ZEND 非常陌生，任何帮助都会非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:54:53.413

正如 Mike Brant 所说，您可以创建 HTML 然后内联复制。但是，您需要确保使用正确的 mime 类型发送电子邮件，以便用户的电子邮件阅读器知道呈现为 HTML 而不是纯文本。这并不难，但我发现 PEAR mail 和 mail_mime 库确实让正在做的事情变得更容易和更明显。还有一些 3rd 方电子邮件 api，例如我在一个使用[http://swiftmailer.org/的项目上取得了很好的成功](http://swiftmailer.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:51:16.940

最好的开始方法是按照您想要的方式在 HTML 中布局您的电子邮件，然后复制到您的 HEREDOC 部分并用变量替换内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T16:14:57.707

您可以使用 Zend_Mail 类 (Zend/Mail.php) 发送电子邮件。详细信息在下面的代码示例中：

```
$mail = new Zend_Mail();
$mail->setBodyText($bodyText);
$mail->setBodyHtml($bodyHtml);
$mail->setFrom($senderAddress, $senderLabel);
$mail->addTo($recipientAddress, $recipientLabel);
$mail->setSubject($subject);
$mail->send(); 
```

您可能有一个问题是如何将电子邮件（文本和 html）内容分配给 $bodyText 和 $bodyHtml。您可以创建几个 phtml 文件，一个用于 html 内容，另一个用于文本。请参阅下面的代码以了解如何实现此目的：

```
$this->view->fullname = "John Abc";
$this->view->emaildata = $data //Possibly an array of data from the db
$bodyText = $this->view->render('emails/htmlemail.phtml')
$bodyHtml = $this->view->render('emails/textemail.phtml') 
```

注意：此代码段应高于前一个代码段。

希望这能回答你的问题。快乐编码:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T20:42:19.090

*   为您的电子邮件创建一个 (zend) 布局，就像为您的网站所做的那样。最好使用 html 4.0 文档类型。避免使用 CSS。大多数电子邮件客户端无法正确呈现它。如果您必须使用 CSS，请将其嵌入到样式标签中（没有外部内容）并将样式标签嵌入到正文中。（大多数网络邮件正在删除头部）。
*   现在为您要发送的每种邮件类型创建视图（例如：注册，密码丢失，...）
*   将变量分配给视图并将其渲染到布局中。将布局渲染到 Zend-Email 对象中。

如果您想通过管理区域管理内容、主题、发件人……，只需创建一个包含以下列的表：

1.  类型（可以是注册，pw-Lost...）
2.  主题
3.  从
4.  收件人（对于发给管理员的邮件，例如：当用户发表评论时）
5.  抄送
6.  密送
7.  Html-Text（带有用于个性化的占位符的电子邮件文本）
8.  文本（包含占位符的可选纯文本）您可以将此文本附加到您的 html-Mail 或仅发送 html 或文本，具体取决于用户设置。
9.  附件的一些额外列（可选）

现在您可以管理不同的邮件并删除您的视图（而不是布局）。

至少创建一个您可以通过这种方式访问​​的邮件类：

```
$mail = new My_Mail(My_Mail::PW_LOST);

$mail->bind($userData); // will replace the placeholders in the text

$mail->addTo(...);

$mail->send(); // will replace the placeholders in the text, renders the layout, Sends the mail. 
```

**代码示例：** 如果您有兴趣，我可以在星期六提供代码示例

# php - 有没有像 PHP PDL 这样的东西？

> ID：11673070
> 
> 赞同：0
> 
> 时间：2012-07-26T15:44:58.513
> 
> 标签：php, sql, sql-injection

好的，我昨天接受了电话面试，他们告诉我准备面试，并告诉我学习一种叫做 PHP PDL 的东西。当我用谷歌搜索 PHP PDL 时，似乎什么都没有出现，而且我的手机由于某种原因没有保存号码来回电。所以现在我离面试还有 1 天，想知道要准备什么，我知道 PHP，但什么是 PDL，他们提到了一些关于 SQL 注入和准备好的语句，PDL 是使用它的好方法。也许我听错了，它是不同的东西，比如我不知道的 pdl 或 gdl。请如果有人知道它可以回应。

它再次与 PH​​P 相关，并且与 SQL 注入有一些联系，并使用准备好的语句来防止它。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T15:46:16.877

我想它是 PDO 而不是 PDL。

[php.net：PDO](http://php.net/manual/en/book.pdo.php)

[php.net : PDO 准备好的语句](http://www.php.net/manual/en/pdo.prepared-statements.php)

# javascript - 我正在使用struts2，我在询问单选按钮验证

> ID：11673074
> 
> 赞同：0
> 
> 时间：2012-07-26T15:45:16.517
> 
> 标签：javascript, validation, struts2, radio-button

```
<s:form action="creatingcv" method="post" onsubmit="return valider()" id="frmSaisie"> 

<s:radio name="cv.gender" label="Gender" list="{'Male','Female'}" id="Gender"/> 

</s:form> 
```

我使用了这个 javascript 代码，但它没有用

```
function valider() { 

    frm=document.forms['frmSaisie']; 

    if(frm.elements['Gender'].value != "")  {       
        return true; 
    } 
    else { 
        alert("Please choose your gender"); 
        return false; 
    }
 } 
```

我用其他组件测试了这个 javascript 代码，它运行良好，但是用这个它什么也没做。

我也测试过`frm.elements['Gender'].checked != false`，但它什么也没返回。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T08:15:11.730

对于那些仍然想使用相同的人

这是我的单选按钮

```
<td><s:radio id="SME_RADIO" label="SME_RADIO" name="SME_RADIO"  list="#{'1':'Passed','2':'Failed'}"  value="smeVO.SME_RADIO"  labelposition="left" labelSeparator=":"/> 
```

这就是您可以进行验证的方式，如果未选择任何内容，则未定义这就是我保持这种情况的方式

```
radioValidation()
{
var nameCHK ="SME_RADIO";
     var selectedRadio = $('input[name='+nameCHK+']:radio:checked').val();
    if( selectedRadio !='1'||selectedRadio !='2' )
       {
         alert( "Please provide Some Radio!" );
         return false;
       }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T10:16:59.217

：数据库的CRUD！在那种情况下，我必须做几个类 CreateAction UpdateAction.. 其次是 CreateAction-validation.xml 和 UpdateAction-validation.xml ......但是在这里我遇到了更新和读取之间的对象创建和变量的问题..我的 ID必须使用无效从一个表单传递到另一个表单。我有 3 个表单用于创建、列出、编辑……将参数从列表传递到编辑……我遇到了问题……我创建了一个额外的对象数据库编辑和我从另一种形式获取它..但是对象的创建是在类 Action 上，这就是为什么我必须使用一个包含所有 CRUD 的 Action ..即使我使用静态...仍然是 null java lang 异常。 ..

这是我的表格数据库

```
<s:form  action="createDb" method="POST" onsubmit="return valider()" id="frmSaisie">
<s:if test="dbs.size">
<table border="1px">
    <tr>

        <td>ID</td>
        <td>DataBase</td>

        <td></td>
    </tr>
    <s:iterator value="dbs">
        <tr>

            <td> <s:property value="dbaId"/> </td>
            <td> <s:property value="dba"/></td>

 <td class="tab-td">
<s:url id="update" action="redirect">
<s:param name="databaseEdited.dba" value="dba"/>
<s:param name="databaseEdited.dbaId" value="dbaId"/>
</s:url> 
<s:a href="%{update}">Edit</s:a>
</td >

<td class="tab-td">
<s:url id="delete" action="deletingDb">
<s:param name="databaseDeleted.dbaId" value="dbaId"/>
</s:url>
<s:a href="%{delete}"> Delete</s:a>
</td > 

        </tr>
    </s:iterator>
</table>
</s:if> 
```

我的数据库编辑表格

```
<s:form action="updatingDb" method="post" >
    <s:div>
<% as you see i get params from databaseEdited object but the id i ought to put it manually in action class --%>

        <s:textfield label="DataBase" name="databaseEdited.dba" id=DB />
    </s:div>
    <br>
  <s:submit value="Submit" />

     <s:reset key="Cancel"/> 

        </s:form> 
```

在我的行动课上：

```
package com.consoft.cv.action;

import java.util.ArrayList;
import java.util.List;

import javax.naming.Context;
import javax.naming.InitialContext;

import com.consoft.cv.entity.*;

import com.consoft.cv.model.*;

import com.opensymphony.xwork2.ActionSupport;

public class DBAction extends ActionSupport {

private static final long serialVersionUID = 1L;
private DBMBLocal DBEjb;
private DB database;
private DB databaseEdited;
private DB databaseDeleted;
private List<DB> dbs;
private static int uid;

public DBAction(){
    try {
        Context context=new InitialContext();
         DBEjb=(DBMBLocal) ( context.lookup("DBMB/local"));

        dbs=new ArrayList<DB>();
    } catch (Exception e) {
        e.printStackTrace();
    }

}

public String findAll() {
    this.dbs=DBEjb.findAll();
    return "success";
}
public String create()
{

    DBEjb.create(database);
    return "success";

}
public String update()
{//the UID got from redirect method
    databaseEdited.setDbaId(uid);

DBEjb.update(databaseEdited);
    return "success";

}
public String delete()
{

    DBEjb.delete(databaseDeleted);
    return "success";

}
public String redirect()
{
    //this is the key cause HERE I CAN KEEP PASS THE ID TO Update method
     **uid=databaseEdited.getDbaId();** 
    return "success";
} 
```

当然有getter和setter

由于这些问题，我无法使用 struts2 验证

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T20:40:52.327

认为该`<s:radio>`标签将替换为类似于以下内容：

```
 <input type="radio" id="Gender" value="Male"/>
 <input type="radio" id="Gender" value="Female"/> 
```

那么，`frm.elements['Gender'].value != ""`将无法使用属性，因为有两个元素与之匹配。分别检查每个元素：

```
function valider() {
  frm=document.forms['frmSaisie'];

  if(frm.elements[0].checked == true || frm.elements[1].checked == true)  {       
    return true;
  }
  else {
    alert("Please choose your gender");
    return false;
  }
} 
```

# php - php登录和facebook登录

> ID：11673076
> 
> 赞同：-1
> 
> 时间：2012-07-26T15:45:18.533
> 
> 标签：php, mysql, login, facebook-login

我不明白两者如何工作。我不会使用用户表，那么有没有任何教程可以在同一张表上使用 facebook 登录和站点登录？我需要用户添加/修改/删除员工，但这与用户 ID 相关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:51:38.010

我只是将用户的 facebook ID 存储在 users 表中。这样，当发生 facebook 登录时，我会获取用户 ID 并在我的网站上处理登录。

# android - 在 PreferenceActivity 刷新 UI

> ID：11673096
> 
> 赞同：2
> 
> 时间：2012-07-26T15:46:18.300
> 
> 标签：android, interface, refresh, preferenceactivity

我有一个`PreferenceActivity`代表设置 UI 的地方，当我按下第一个复选框时，第二个复选框变得可见。另一方面，当第一个复选框未选中时，第二个复选框被隐藏（并将默认值设置为 false）。

问题是，当我选中（或取消选中）第一个复选框时，我需要刷新我的 UI 屏幕，因为现在使用该代码我需要转到另一个 Activity（例如，当我按下后退按钮时）然后返回`PreferenceActivity`再次以查看我的 UI 上的更改。

**PreferenceActivity**的代码：

```
public class SetPreference extends PreferenceActivity implements
        OnSharedPreferenceChangeListener {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.checkboxpref);
    }

    @Override
    protected void onStart() {
        super.onStart();

        Preference checkbox = findPreference("checkBox_Schedule");

        SharedPreferences prefs = PreferenceManager
                .getDefaultSharedPreferences(this);

        if (prefs.getBoolean("checkBox", true)) {

        } else {

            ((PreferenceGroup) findPreference("category_second"))
                    .removePreference(checkbox);

            SharedPreferences.Editor geted = prefs.edit();
            geted.putBoolean("checkBox_Schedule", false);
            geted.commit();
        }
    }

    @Override
    protected void onResume() {
        super.onResume();

    }

    @Override
    public void onSharedPreferenceChanged(SharedPreferences sharedPreferences,
            String key) {
        // TODO Auto-generated method stub

    }

} 
```

**XML**代码：

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" >

    <PreferenceCategory
        android:summary="Username and password information"
        android:title="Login information" >
        <EditTextPreference
            android:key="username"
            android:summary="Please enter your login username"
            android:title="Username" />
        <EditTextPreference
            android:inputType="textPassword"
            android:key="password"
            android:summary="Enter your password"
            android:title="Password" />
    </PreferenceCategory>
    <PreferenceCategory
        android:summary="Username and password information"
        android:title="Settings"
        android:key="category_first" >
        <CheckBoxPreference
            android:key="checkBox"
            android:summary="On/Off"
            android:title="Keep me logged in" />

        <ListPreference
            android:entries="@array/listOptions"
            android:entryValues="@array/listValues"
            android:key="listpref"
            android:summary="List preference example"
            android:title="List preference" />
    </PreferenceCategory>
    <PreferenceCategory
        android:summary="schedule"
        android:key="category_second"
        android:title="Schedule" >
        <CheckBoxPreference
            android:key="checkBox_Schedule"
            android:summary="On/Off"
            android:title="Keep me logged in" />
    </PreferenceCategory>

</PreferenceScreen> 
```

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:26:18.337

好的，然后在选中/取消选中复选框时重新启动活动：

```
startActivity(new Intent(PreferencesActivity.this, PreferencesActivity.class));
finish(); 
```

考虑使用`onPreferenceSelectedListener`第一个复选框来检测选中/取消选中首选项的行为。

# mongodb - 为 MongoDB 2.2 中的每个集合创建不同的数据库

> ID：11673097
> 
> 赞同：6
> 
> 时间：2012-07-26T15:46:35.580
> 
> 标签：mongodb

MongoDB 2.2 每个数据库都有一个写锁，而不是以前版本的服务器上的全局写锁。那么，如果我将每个集合存储在一个单独的数据库中以有效地为每个集合拥有一个写锁，那可以吗？（这将使它看起来像 MyISAM 的表级锁定）。这种方法有问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T16:14:54.723

锁定有一个关键限制，那就是`local`数据库。该数据库包括一个`oplog`用于复制的集合。

如果您在生产环境中运行，则应该使用 Replica Sets 运行。如果您使用副本集运行，则需要注意该数据库上的写锁定效果。

如果它们都阻塞等待`oplog`.

在大步重写之前，请确保`oplog`不会引起问题。

另外，请注意 MongoDB 实现了 DB 级别的安全性。如果您使用任何安全功能，您现在正在创建更多的数据库来保护。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T15:55:48.060

是的，这会起作用，10gen 实际上在他们关于锁定的讨论中提供了这个选项。

不过，我可能会隔离每个集合。大多数数据库似乎有 2-5 个高活动集合。为了简单起见，最好将低活动集合放在一个数据库中，并将高活动集合放在他们自己的数据库中。

# sql - 返回三列中具有相同数据的行

> ID：11673099
> 
> 赞同：0
> 
> 时间：2012-07-26T15:46:37.907
> 
> 标签：sql, sql-server

我有一个具有以下架构的表

```
CREATE TABLE [dbo].[personas](
    [id_persona] [int] IDENTITY(1,1) NOT NULL,
    [nombres] [nvarchar](50) NOT NULL,
    [apellido_paterno] [nvarchar](50) NULL,
    [apellido_materno] [nvarchar](50) NULL,
    [fecha_nacimiento] [date] NOT NULL,
    [sexo] [varchar](1) NOT NULL,
    [estado_civil] [nvarchar](50) NOT NULL,
    [calle] [nvarchar](200) NULL,
    [colonia] [nvarchar](100) NULL,
    [codigo_postal] [char](5) NOT NULL,
    [telefonos] [varchar](50) NULL,
    [celular] [varchar](25) NULL,
    [email] [varchar](50) NULL,
) 
```

如何在 SQL Server 中进行查询以返回重复的行和行`nombre`？我的意思是两行或多行在这些列中具有相同的数据。`apellido_paterno``apellido_materno`

我想我正在寻找与 DISTINCT 子句相反的东西

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T15:54:12.783

你会想要...

```
SELECT nombre, apellido_paterno, apellido_materno
  FROM dbo.personas
 GROUP BY nombre, apellido_paterno, apellido_materno
HAVING COUNT(*) > 1 
```

如果您想查看实际的行，则将其用作内部查询并加入它。所以，像

```
SELECT * 
  FROM personas pOuter INNER JOIN
    (SELECT nombre, apellido_paterno, apellido_materno
      FROM dbo.personas
     GROUP BY nombre, apellido_paterno, apellido_materno
    HAVING COUNT(*) > 1) pInner
    ON pInner.nombre = pOuter.nombre 
   AND pInner.apellido_paterno = pOuter.apellido_paterno
   AND pInner.apellido_materno = pOuter.apellido_materno 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T15:57:40.173

```
;WITH x AS 
(
  SELECT id_personas, rn = ROW_NUMBER() OVER 
  (
   PARTITION BY nombre, apellido_paterno, apellido_materno
   ORDER BY id_personas
  )
  FROM dbo.personas
)
SELECT <col list> 
FROM dbo.personas AS p
WHERE EXISTS 
(
  SELECT 1 FROM x 
  WHERE x.id_personas = p.id_personas 
  AND x.rn > 1
); 
```

# installation - NSIS 命名空间有什么用？

> ID：11673101
> 
> 赞同：0
> 
> 时间：2012-07-26T15:46:42.040
> 
> 标签：installation, include, nsis

### 编辑：到目前为止，我包含的所有标题都是`MUI.nsh`. 我认为这应该排除将 LogicLib.nsh 和 Section.nsh 包含在脚本的其他部分中的选项。

### 尽管有我在下面发布的脚本，但代码仍然可以编译。

好的，我将 NSIS 脚本中那些看起来像`!include MUI2.nsh`名称空间的部分称为。我需要更清楚地了解哪些是我真正应该`!include`在我的代码中使用的命名空间。以下是我的困惑：

1）我有这样的代码：

```
!insertmacro MUI_PAGE_WELCOME
!insertmacro MUI_PAGE_COMPONENTS
!insertmacro MUI_PAGE_DIRECTORY
Page custom DbPage "" ": Information Page"
Page instfiles
!insertmacro MUI_PAGE_FINISH 
```

这基本上意味着我也在使用自定义的 InstallOptions 页面。所以我想我需要包括`!include InstallOptions.nsh`and `!include MUI.nsh`。有用。但令我惊讶的是，即使我不包括`!include InstallOptions.nsh`代码编译，我也看不出最终结果有什么不同！但如果我只包含`!include MUI2.nsh`，则代码无法编译。但如果我包含`!include MUI2.nsh & !include InstallOptions.nsh`. **那么我应该包括什么，`!include MUI.nsh`单独还是`!include MUI2.nsh`&的组合`!include InstallOptions.nsh`？**. 如果我包含所有`!include MUI2.nsh`,`!include InstallOptions.nsh`和`!include MUI.nsh`. **在这种情况下，宏和函数将从`!include MUI2.nsh`或`!include MUI.nsh`??**

2）我使用[此处定义的函数](http://nsis.sourceforge.net/Show_custom_page_when_a_section_has_been_selected)来查看是否选择了一个部分，如下所示：

```
SectionGetFlags ${Section_Name} $R0 
IntOp $R0 $R0 & ${SF_SELECTED} 
IntCmp $R0 ${SF_SELECTED} show 
```

该链接要求包含`!include Sections.nsh`，但对我来说，即使不包含它，脚本也会编译。**为什么？？我应该理想`!include`吗？**

3）我有这样的代码：

```
${If} ${FileExists} `$0\*.*`
${Else}
    CreateDirectory $0
${EndIf} 
```

和

```
 ${If} $2 != <
    StrCpy $2 >
  ${EndIf}

  ${If} $3 != <
    StrCpy $3 >
  ${EndIf} 
```

等等**，所以我不应该`!include` `LogicLib`吗？**即使不使用`!include LogicLib`.

为什么我能够在不包含适当的包/引用的情况下编译 NSIS 脚本？

**更新：**我在 nullsoft 的官方论坛中也得到了相同问题的[答案。](http://forums.winamp.com/showthread.php?t=346607)这讲述了同样的故事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T23:17:40.640

不要称它们为命名空间，NSIS 没有[命名空间](http://en.wikipedia.org/wiki/Namespace_%28computer_science%29)。`!include`'ed 文件被直接“粘贴”到代码中（在 !include 行所在的位置）。

**1)**

MUI2 对其自定义页面使用 nsDialogs，而 MUI(v1) 使用 InstallOptions。

如果**您**在代码中需要 InstallOptions.nsh 中的宏，**那么****您**应该包含它。如果 MUI 需要它，那么它将包含它，而您无需执行任何操作。

您不应该**同时**包含 MUI2.nsh 和 MUI.nsh，您需要选择其中一个！

**2)**和**3)**

其他一些代码已经包含 Sections.nsh/LogicLib.nsh。再次包含它并没有什么坏处，这样做是个好主意（这样您就不会依赖您无法控制的代码来包含它）。

# php - 保存选中的值 Checkbox 数组 POST

> ID：11673103
> 
> 赞同：1
> 
> 时间：2012-07-26T15:46:43.927
> 
> 标签：php, arrays, checkbox

我有一个复选框列表并将选中的值保存在一个数组中。但是，当有人单击“提交”并收到错误消息时，他们所有的复选框都会被遗忘。通常我会让脚本记住带有类似代码的复选框

如果复选框值 = OK { echo checked="checked"}

但是，现在我将它保存在一个数组中，我不知道该怎么做？

```
<?php

$sql = "SELECT merknaam FROM merken";
$result = mysql_query($sql);

while ($row = mysql_fetch_array($result)) {
    echo "&nbsp;&nbsp;<input type=\"checkbox\" name=\"merken[]\" value='" . $row['merknaam'] . "'>&nbsp;" . $row['merknaam'] . " <Br />  ";
}

?> 
```

这是我用于复选框的代码。接下来，我使用以下代码显示数组：

```
$merkenstring = implode(",", $_POST['merken']);

echo $merkenstring; 
```

结果：AC Ryan,Adidas,Agu,Cargo

我希望有人能给我一个代码示例！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:50:16.893

假设您将其发布到同一页面，并且`$_POST['merken']`在出现错误后仍然可用，请使用以下内容`in_array()`针对当前设置测试每个复选框的值`$_POST`：

```
while ($row = mysql_fetch_array($result)) {
    // If the current value is in the $_POST['merken'] array
    // and the array has been initialized...
    if (isset($_POST['merken']) && is_array($_POST['merken']) && in_array($row['merknaam'], $_POST['merken'])) {
      // Set the $checked string
      $checked = "checked='checked'";
    }
    // Otherwise $checked is an empty string
    else $checked = "";
    // And incorporate it into your <input> tag
    echo "&nbsp;&nbsp;<input $checked type=\"checkbox\" name=\"merken[]\" value='" . $row['merknaam'] . "'>&nbsp;" . $row['merknaam'] . " <Br />  ";
    //----------------------^^^^^^^^^^
} 
```

如果这被发布到不同的脚本，您将（与返回到先前脚本的任何发布值一样）需要将数组存储在其中并在您的调用中`$_SESSION`进行比较。`$_SESSION['merken']``in_array()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:51:45.553

假设`$row['merknaam']`是复选框值，并`$_POST['merken']`保存一个选中复选框值的数组，那么您只需检查该值是否在数组中：

```
if (in_array($row['merknaam'], $_POST['merken'])) {
   // this checkbox should be checked
} 
```

# vb.net - 将一个子程序的变量访问到另一个子程序 -VB

> ID：11673104
> 
> 赞同：0
> 
> 时间：2012-07-26T15:46:47.297
> 
> 标签：vb.net

我有两个问题

1.  我想`result`在我的`Button15_ click`子中使用

2.  当我在行中输入时`op = sender.Text`，我在智能感知中看到`Text`了发件人对象的方法？

这是我的代码

```
Public Sub Button10_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button10.Click, Button11.Click, Button12.Click, Button13.Click, Button14.Click, Button14.Click, Button16.Click
    Dim op As Char
    op = sender.Text

     result = Convert.ToInt32(TextBox1.Text)

End Sub

Public Sub Button15_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button15.Click
    Select Case op
        Case "+"
            result += Convert.ToInt32(TextBox1.Text)
            TextBox1.Text = result
        Case "-"
            result -= Convert.ToInt32(TextBox1.Text)
            TextBox1.Text = result
        Case "*"
            result *= Convert.ToInt32(TextBox1.Text)
            TextBox1.Text = result
        Case "\"
            result \= Convert.ToInt32(TextBox1.Text)
            TextBox1.Text = result

    End Select

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:49:21.773

声明`op`为类级别：

```
Dim op As Char

Public Sub Button10_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button10.Click, Button11.Click, Button12.Click, Button13.Click, Button14.Click, Button14.Click, Button16.Click
    op = sender.Text

    result = Convert.ToInt32(TextBox1.Text)
End Sub

Public Sub Button15_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button15.Click
    Select Case op
        Case "+"
            result += Convert.ToInt32(TextBox1.Text)
            TextBox1.Text = result
        Case "-"
            result -= Convert.ToInt32(TextBox1.Text)
            TextBox1.Text = result
        Case "*"
            result *= Convert.ToInt32(TextBox1.Text)
            TextBox1.Text = result
        Case "\"
            result \= Convert.ToInt32(TextBox1.Text)
            TextBox1.Text = result
    End Select
End Sub 
```

您`Text`在 IntelliSense 中看不到的原因是它`sender`是a ，而`Object`不是 a `TextBox`，并且没有`Text`属性。我建议您打开`Option Strict`，因为它会显示几个潜在的代码错误。要得到它，请投射`sender`：

```
op = DirectCast(sender, Button).Text(0) 
```

中也有很多共同的逻辑`Button15_Click`。我将其重写为：

```
Dim rightOperand As Integer = Integer.Parse(TextBox1.Text)

Select Case op
    Case "+"c
        result += rightOperand
    Case "-"c
        result -= rightOperand
    Case "*"c
        result *= rightOperand
    Case "\"c
        result \= rightOperand
End Select

TextBox1.Text = result.ToString() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:49:26.693

```
Private op as Char

Public Sub Button10_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button10.Click, Button11.Click, Button12.Click, Button13.Click, Button14.Click, Button14.Click, Button16.Click 
    op = DirectCast(sender, button).Text
     result = Convert.ToInt32(TextBox1.Text) 
End Sub 
```

# c# - 如何允许在 asp.net 的文本框中提交 HTML 标签？

> ID：11673107
> 
> 赞同：27
> 
> 时间：2012-07-26T15:47:01.460
> 
> 标签：c#, javascript, asp.net-mvc, decoding

首先，我想让大家知道我使用的是 aspx 引擎而不是 Razor 引擎。

我在表格中有一张桌子。我的一个文本框包含 html 标签，如

```
</br>Phone: </br> 814-888-9999 </br> Email: </br> aaa@gmail.com. 
```

当我去构建它时，它给了我一个错误，上面写着：

从客户端检测到具有潜在危险的 Request.Form 值`(QuestionAnswer="...ics Phone:<br/>814-888-9999<br...")`。

我尝试了验证请求 =“假”，但没有奏效。

很抱歉，到目前为止，我没有添加我的 html 代码供您查看。如果需要，我正在提出一些可以编辑的问题。

```
 <%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master"   Inherits="System.Web.Mvc.ViewPage<dynamic>" %>

<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
EditFreqQuestionsUser
</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
<script type="text/javascript">
$(document).ready(function () {
    $("#freqQuestionsUserUpdateButton").click(function () {
        $("#updateFreqQuestionsUser").submit();
    });
});
</script>
<h2>Edit Freq Questions User </h2>

<%Administrator.AdminProductionServices.FreqQuestionsUser freqQuestionsUser =   ViewBag.freqQuestionsUser != null ? ViewBag.freqQuestionsUser : new   Administrator.AdminProductionServices.FreqQuestionsUser(); %>
<%List<string> UserRoleList = Session["UserRoles"] != null ? (List<string>)Session["UserRoles"] : new List<string>(); %>
<form id="updateFreqQuestionsUser" action="<%=Url.Action("SaveFreqQuestionsUser","Prod")%>" method="post" onsubmit+>
<table> 
    <tr>
        <td colspan="3" class="tableHeader">Freq Questions User Details <input type ="hidden" value="<%=freqQuestionsUser.freqQuestionsUserId%>" name="freqQuestionsUserId"/> </td>
    </tr>
     <tr>
        <td colspan="2" class="label">Question Description:</td>
        <td class="content">
            <input type="text" maxlength="2000" name="QuestionDescription" value="  <%=freqQuestionsUser.questionDescription%>" />
        </td>
    </tr>
     <tr>
        <td colspan="2" class="label">QuestionAnswer:</td>
        <td class="content">
            <input type="text" maxlength="2000" name="QuestionAnswer" value="<%=freqQuestionsUser.questionAnswer%>" />
        </td>
    </tr>
    <tr>
        <td colspan="3" class="tableFooter">
                <br />
                <a id="freqQuestionsUserUpdateButton" href="#" class="regularButton">Save</a>
                <a href="javascript:history.back()" class="regularButton">Cancel</a>
        </td> 
    </tr>
    </table>
      </form>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-07-26T15:54:08.087

在提交页面之前，您需要使用 window.escape(...) 对文本框的值进行 html 编码

如果您需要服务器端未转义的文本，请使用`HttpUtility.UrlDecode(...)`方法。

非常快速的示例：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="WebForm1.aspx.cs" Inherits="SO.WebForm1" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <script>
        function makeSafe() {
            document.getElementById('TextBox1').value = window.escape(document.getElementById('TextBox1').value);
        };

        function makeDangerous() {
            document.getElementById('TextBox1').value = window.unescape(document.getElementById('TextBox1').value);
        }
    </script>
</head>
<body>
    <form id="form1" runat="server" onsubmit="makeSafe();">
    <div>
        <asp:TextBox ID="TextBox1" runat="server" TextMode="MultiLine" Rows="10" ClientIDMode="Static"></asp:TextBox>
    </div>
    <asp:Button ID="Button1" runat="server" Text="Button" />
    </form>

     <script>
         makeDangerous();
    </script>
</body>
</html> 
```

对您的代码进行以下更改：

```
<script type="text/javascript">
    $(document).ready(function () {
        makeDangerous();
        $("#freqQuestionsUserUpdateButton").click(function () {
            makeSafe();
            $("#updateFreqQuestionsUser").submit();
        });
    });

    // Adding an ID attribute to the inputs you want to validate is simplest
    // Better would be to use document.getElementsByTagName and filter the array on NAME
    // or use a JQUERY select....

    function makeSafe() {
        document.getElementById('QuestionAnswer').value = window.escape(document.getElementById('QuestionAnswer').value);
    };

    // In this case adding the HTML back to a textbox should be 'safe'
    // You should be very wary though when you use it as actual HTML
    // You MUST take steps to ensure the HTML is safe.
    function makeDangerous() {
        document.getElementById('QuestionAnswer').value = window.unescape(document.getElementById('QuestionAnswer').value);
    }
</script> 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-07-26T15:53:01.620

`[ValidateInput]`用属性装饰你的控制器动作：

```
[ValidateInput(false)]
[HttpPost]
public ActionResult Foo(MyViewModel model)
{
    ...
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-04-10T12:18:04.753

客户端 JavaScript：

```
function codificarTags() 
{
     document.getElementById('txtDescripcion').value = document.getElementById('txtDescripcion').value.replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

<form id="form1" runat="server" onsubmit="codificarTags();"> 
```

服务器：

```
protected void Page_Load(object sender, EventArgs e)
{
     txtDescripcion.Text = txtDescripcion.Text.Replace(@"&lt;", @"<").Replace(@"&gt;", @">");
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-22T10:08:34.937

我建议使用 AjaxControlToolkit 的 HTML 编辑器。我现在正在实施。如果您的文本框是多行的并且足够大以容纳 HTML，为什么不直接将其添加到 HTML 编辑器。您的用户也会更快乐。

[http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/HTMLEditor/HTMLEditor.aspx](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/HTMLEditor/HTMLEditor.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T15:52:33.330

在文本框中使用 html 不是一个好习惯，也许使用换行符 ( `Environment.NewLine`) 或 \r\n 而不是`br`? [.NET 参考](http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx)

示例（在 C# 中）：

```
textBox1.Multiline = true;
textBox1.Text = "test" + Environment.NewLine + "test2"; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-12T23:53:56.990

我采取了一些不同的方法。我想在我的应用程序中广泛使用 html 文本框。我制作了一个用户控件，可以避免每次添加新控件时都编辑 javascript。我的整个控件是非常自定义的，但 html 处理的核心如下所示。

标记有一些简单的`UserControl`javascript 来转义和取消转义文本框。

```
<script type="text/javascript">

    function UnescapeControl(clientId) {
            $('#' + clientId).val(window.unescape($('#' + clientId).val()));
    }

    function EscapeAllControls() {
       var escapeControList = JSON.parse('<%= new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(EscapeControlList) %>');
       for (var i = 0; i < escapeControList.length; i++) 
           EscapeControl(escapeControList[i]);            
    }

    function EscapeControl(textClientId) {
       document.getElementById(textClientId).value = window.escape(document.getElementById(textClientId).value); 
    }
</script>

<asp:TextBox ID="Txt_SavableText" CssClass="form-control" Width="100%" runat="server" ></asp:TextBox> 
```

后面的代码负责在回发之前对控件进行转义，并在回发之后对`RegisterOnSubmitStatement`它们进行转义。`RegisterStartupScript`

```
public partial class SavableTextBox : System.Web.UI.UserControl
{

    public List<string> EscapeControlList
    {
        get
        {
            if (Session["STB_EscapeControlList"] == null)
                Session["STB_EscapeControlList"] = new List<string>();

            return (List<string>)Session["STB_EscapeControlList"];
        }
        set { Session["STB_EscapeControlList"] = value; }
    }

    protected void Page_Load(object sender, EventArgs e)
    {
        if (EscapeHtmlOnPostback && !EscapeControlList.Contains(GetClientId()))
            EscapeControlList.Add(GetClientId());

        // When using a script manager, you should use ScriptManager instead of ClientScript.
        if (EscapeHtmlOnPostback)
            ScriptManager.RegisterStartupScript(this.Page, this.Page.GetType(), "UnescapeControl_" + GetClientId(), "UnescapeControl('" + GetClientId() + "');", true);

        // Ensure we have our escape script called before all post backs containing escapable controls.
        // This is like calling OnClientClick before everything.
        if (EscapeControlList != null && EscapeControlList.Count > 0)
            this.Page.ClientScript.RegisterOnSubmitStatement(this.GetType(), "SaveableTextBoxEscaper", "EscapeAllControls();");

    }

   public string Text
    {
        get
        {
            return Txt_SavableText.Text;
        }
        set
        {
            Txt_SavableText.Text = value;
        }
    }

    public string GetClientId()
    {
        return Txt_SavableText.ClientID;
    }
} 
```

现在我们可以在设置时像这样在任何地方使用它`EscapeHtmlOnPostback="True"`。

```
<%@ Register TagPrefix="STB" TagName="SavableTextBox" Src="~/SavableTextBox.ascx" %>
<STB:SavableTextBox ID="Txt_HtmlTextBox" EscapeHtmlOnPostback="True" runat="server" /> 
```

请注意，当我们`Txt_HtmlTextBox.Text`在回发期间访问时，它已经为我们转义了。

# c# - 查找字符串中标签的位置

> ID：11673113
> 
> 赞同：0
> 
> 时间：2012-07-26T15:47:23.893
> 
> 标签：c#

我有一个像这样的字符串：

```
<table><tr><td>This is my string <img width="100" height="10" src="images/image.jpg"></td></tr></table> 
```

我想找到`<img`标签的位置和图像标签结束的位置。这可能吗？我该怎么做呢？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:47:58.607

尝试在您的字符串中使用 IndexOf，例如：

```
int position = yourString.IndexOf('test'); 
```

# javabeans - 在 FreeMarker 中调用非 bean 属性方法

> ID：11673116
> 
> 赞同：2
> 
> 时间：2012-07-26T15:47:26.080
> 
> 标签：javabeans, freemarker

在 Freemarker 中，我们通常会做这样的事情。

```
class User{
private String name;

public String getName()...

pubilc void setName(String name)....

} 
```

然后我们的 Freemarker 代码像这样调用属性名称...

```
<strong>Hello ${user.name}</strong> 
```

如果我们想像这样在用户中调用一个名为“generateUserToken”的方法呢？

```
class User{
private String name;

public String getName()...

public void setName(String name)....

public String generateUserToken(){
  return "Hello World";
} 
```

}

现在，如果我尝试像这样调用 Freemarker 代码，我会收到一个错误...

```
<a style="font-size: 20px" href="${obj.generateUserToken}">VIEW USER</a> 
```

> 原因：freemarker.core.InvalidReferenceException：表达式 obj.generateUserToken 在 user_page.ftl 的第 63 行第 36 列未定义。

这是否意味着 Freemarker 访问的所有方法（使用默认的 BeanWrapper）都必须符合 bean 属性命名约定？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T18:35:31.987

您应该可以`obj.generateUserToken()`在模板中进行操作。注意`()`; 没有它，你只会得到方法，但不要调用它。但是在您的情况下还有其他一些问题，因为它说“generateUserToken”未定义。可以肯定的是，该方法不是来自公共类或接口。

# git - Git：如果我将一个新分支推送到原点，如何使其自动跟踪

> ID：11673117
> 
> 赞同：11
> 
> 时间：2012-07-26T15:47:27.263
> 
> 标签：git

我创建了一个新的本地分支并使用

```
git push origin my-branch 
```

如何自动设置我的本地分支来标记刚刚创建的远程分支？

还是我总是需要

```
git branch --set-upstream my-branch  origin/my-branch 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-26T15:51:10.257

您可以使用`git push -u origin my-branch`. 这将为无参数推/拉设置一切。

# c# - Datagridview_2 组合框值在 C# 中无效

> ID：11673118
> 
> 赞同：0
> 
> 时间：2012-07-26T15:47:33.493
> 
> 标签：c#, datagridview, datasource, datagridviewcombobox

我有一个包含 2 列的数据网格：1 列是普通文本框类型，另一列是组合框类型。

我的用户界面有另一个 datagrid_1，其中包含一个名称列表。当用户单击带有名称的 datagrid_1 行时。它将用户选择的值放在第一列的 datagrid_2 行中，然后期望用户选择另一列（组合框）中的一个值。

我不确定如何将数据源分配给此组合框。我尝试了以下代码，但出现错误`"Datagridview_2 combox value is not valid."`

```
var source = new BindingSource();                                    
var phase_7 = (phaseeqType.return_Distinct_Phase()
       .Select(b => b).AsEnumerable()).ToList();

string[] P_combo = new string[phase_7.Count()];
for (int i = 0; i < phase_7.Count(); i++)
{
   P_combo[i] = phase_7.ToString();
}

source.DataSource = phase_7; 
dataGridView1.CurrentRow.Cells[1].Value = source; 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T17:16:22.190

单元格没有 DataSource 属性，因此您可以尝试将其强制转换为：

例子：

```
((DataGridViewComboBoxCell)dataGridView1.CurrentRow.Cells[1])
    .DataSource = source; 
```

# .net - HTTP 状态：.net 浏览器控件中的 12002

> ID：11673123
> 
> 赞同：2
> 
> 时间：2012-07-26T15:47:41.163
> 
> 标签：.net, windows, internet-explorer-9, webbrowser-control, http-status-codes

在桌面应用程序内的浏览器控件中打开网页时，我收到 HTTP 状态 12002。但它在 Internet Explorer 中运行良好。我正在使用 .NET 3.5。

错误：

> 发生未知错误。Http状态：12002

可能是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T03:10:00.530

来晚了，但希望这对其他人有帮助。

经过数小时的搜索，我发现这是一个 IE 客户端问题。不幸的是，唯一的答案是更改本地注册表设置。

```
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\
InternetSettings\ReceiveTimeout 
```

将其设置为超过 10000（10 秒）。

# python - 在 NumPy 中获取随机数的最佳方法是什么？

> ID：11673124
> 
> 赞同：23
> 
> 时间：2012-07-26T15:47:43.417
> 
> 标签：python, numpy, random

我想在该范围内生成随机数，`-1, 1`并希望每个随机数具有相同的生成概率。即我不希望极端情况不太可能出现。这样做的最佳方法是什么？

到目前为止，我使用过：

```
2 * numpy.random.rand() - 1 
```

并且：

```
2 * numpy.random.random_sample() - 1 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-07-26T15:50:47.217

你的方法很好。另一种方法是使用函数[`numpy.random.uniform()`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.random.uniform.html)：

```
>>> numpy.random.uniform(-1, 1, size=10)
array([-0.92592953, -0.6045348 , -0.52860837,  0.00321798,  0.16050848,
       -0.50421058,  0.06754615,  0.46329675, -0.40952318,  0.49804386]) 
```

关于极端的概率：如果将其理想化为连续随机数，则获得极端之一的概率将为 0。由于浮点数是连续实数的离散化，因此实际上有一些正概率得到一些极端。这是某种形式的离散化误差，几乎可以肯定，这个误差会被模拟中的其他误差所抵消。别担心了！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-08-30T13:55:46.107

请注意，[`numpy.random.rand`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.random.rand.html)允许一次调用从均匀分布中生成多个样本：

```
>>> np.random.rand(5)
array([ 0.69093485,  0.24590705,  0.02013208,  0.06921124,  0.73329277]) 
```

它还允许生成给定形状的样本：

```
>>> np.random.rand(3,2)
array([[ 0.14022471,  0.96360618], 
       [ 0.37601032,  0.25528411], 
       [ 0.49313049,  0.94909878]]) 
```

正如您所说，可以通过以下方式生成 [-1, 1) 之间的均匀分布随机数：

```
>>> 2 * np.random.rand(5) - 1
array([ 0.86704088, -0.65406928, -0.02814943,  0.74080741, -0.14416581]) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-26T15:50:56.003

从文档中[`numpy.random.random_sample`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.random.random_sample.html#numpy.random.random_sample)：

> 结果来自规定区间内的“连续均匀”分布。采样 *Unif[A, b), b > a*将 random_sample 的输出乘以`(b-a)`并添加`a`：
> 
> ```
>  (b - a) * random_sample() + a 
> ```

根据 Sven Marnach 的回答，文档可能需要更新以引用[`numpy.random.uniform`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.random.uniform.html#numpy.random.uniform).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-29T08:13:29.600

为了确保包含范围 [-1, 1] 的极值，我随机生成一个范围为 [0, 200000001[ 的整数的 numpy 数组。后一个整数的值取决于所需的最终 numpy 数据类型。在这里，我采用 numpy float64，这是用于 numpy 数组的默认类型。然后，我将 numpy 数组除以 100000000 以生成浮点数并减去单位。代码是：

```
>>> import numpy as np
>>> number = ((np.random.randint(low=0, high=200000001, size=5)) / 100000000) - 1
>>> print(number)
[-0.65960772  0.30378946 -0.05171788 -0.40737182  0.12998227] 
```

确保不要将这些 numpy 浮点数转换为 python 浮点数以避免舍入错误。

# java - java jni异常访问冲突

> ID：11673128
> 
> 赞同：0
> 
> 时间：2012-07-26T15:47:53.807
> 
> 标签：java, java-native-interface, access-violation

我使用 JNI 的 java 应用程序因 hs_err_pid 文件而崩溃，错误为“异常访问冲突”。操作系统是 Windows VISTA。

据我所知，我的本机代码正在非法写入一些不属于它的内存块。

过去，我在纯本机代码的 Linux 上使用 valgrind 来检测此类问题。

但是在使用 java 时，valgrind 根本就失败了并且不起作用。

你会建议什么（如果有的话）方法来识别有问题的代码片段？

我无法手动挖掘本机代码（几百万行）来识别它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T21:23:56.893

我终于能够解决这个问题。我想我会在这里发布程序，以防其他人处于类似情况。

第 1 步：使用适当的调试符号构建本机代码。编译器标志可能类似于

```
"-g -rdynamic -O0"
```

.

第 2 步：下面的 valgrind 命令应该可以完成这项工作。

```
 valgrind --error-limit=no --trace-children=yes --smc-check=all --leak-check=full --track-origins=yes -v $JAVA -XX:UseSSE=0 -Djava.compiler=NONE $JAVA_ARGS
```

在上面的命令中，$JAVA 是 java 可执行文件，$JAVA_ARGS 是你的 java 程序的参数。

一旦成功启动，将需要更多数量级的时间来完成执行。Valgrind 将打印数千个错误（大多数与 jvm 相关，可以忽略）。但是，您可以识别与您的 jni 代码相关的那些。

这种通用策略应该适用于大多数与本机内存相关的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T07:26:12.933

如果您在 Linux 下运行 Java，则可以使用该`-XX:OnError="gdb - %p"`选项`gdb`在错误发生时运行。请参阅此[示例](http://www.jroller.com/eu/entry/debugging_jvm_crashes)。

在 windows 下，您可以使用该`-XX:+UseOSErrorReporting`选项来获得类似的效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T13:52:36.843

对于调试 JNI 代码，[本文](http://www.codeproject.com/Articles/69965/Debugging-a-JNI-Application-using-Netbeans-and-Vis)中发布的一种方法可能很有用（它是关于使用 Netbeans 和 Visual Studio 调试 JNI）。这很简单 - 只需启动您的 Java 程序，然后在 Visual Studio 中选择`Debug`->`Attach to process`并选择运行您的程序的 java.exe 进程。

当您向 C++ 代码添加断点时，Visual Studio 将在它们上中断。瞧：）

# javascript - 将声音嵌入我的网站

> ID：11673131
> 
> 赞同：0
> 
> 时间：2012-07-26T15:47:59.527
> 
> 标签：javascript, html

为什么我不能将自己录制的声音放在我的网站中...

```
file:///C:/Users/smilburn/Desktop/bug.wav 
```

我试过这个...

```
<li data-word="bug" data-audio="file:///C:/Users/smilburn/Desktop/bug.wav" data-pic="http://pixabay.com/static/uploads/photo/2012/04/16/12/17/black-35741_640.png"></li> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:02:38.137

您可以使用 HTML5 音频元素播放声音文件：

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script type="text/javascript">
        function playSound(urlOfSoundfile) {
            document.getElementById("audioPlay").src=urlOfSoundfile;
            document.getElementById("audioPlay").autoplay="autoplay";
        }
    </script>
</head>
<body>
    <ul>
        <li onclick="playSound('http://www.wav-sounds.com/various/beep.wav')">Click here to play sound from www</li>
        <li onclick="playSound('file:///C:/Users/smilburn/Desktop/bug.wav')">Click here to play sound from local file</li>
    </ul>
    <audio id="audioPlay">
    </audio>
</body>
</html> 
```

到目前为止，并非每个浏览器都支持每种声音文件格式，因此要符合跨浏览器的要求，您应该提供不止一种格式的声音文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:49:35.843

您需要在某处托管文件。源不能来自您的本地驱动器。如果您可以完全控制您的网站，只需将文件托管在您自己的服务器上即可。

编辑：更详细地说，您当前尝试做的是让您的网络服务器在网络服务器上不存在的目录中找到一个文件。您将其指向位于本地驱动器（您的计算机）上的文件。C:/ 在您的网络服务器上不存在。您需要将文件放在网络服务器本地的目录中，而不是您自己的计算机中。您可以使用第三方托管网站或自己托管。

如果您想自己托管，请访问您的网络服务器并专门为声音文件创建一个文件夹

（示例）文件：/yourwebsite/res/sounds/bug.wav

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:50:12.307

尝试查找[HTML5 音频](http://google.com/search?q=HTML5+audio+tutorial)，以便了解您应该如何做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T15:50:50.697

一种方法（取自[w3schools 网站](http://www.w3schools.com/html/html_sounds.asp)）是包含 Yahoo! 媒体播放器：

```
<a href="song.mp3">Play Song</a>

<script type="text/javascript" src="http://mediaplayer.yahoo.com/js">
</script> 
```

见演示：[http ://www.w3schools.com/html/tryit.asp?filename=tryhtml_audio_yahoo](http://www.w3schools.com/html/tryit.asp?filename=tryhtml_audio_yahoo)

# c# - 多个项目的单点登录工具栏，MVC4

> ID：11673132
> 
> 赞同：0
> 
> 时间：2012-07-26T15:48:11.837
> 
> 标签：c#, entity-framework, asp.net-mvc-4, single-sign-on

我正在构建一组基于 MVC 4 的服务。它们都应该是同一个身份验证系统的一部分。目前，我有一个单独的项目来处理所有模型，包括创建新的 MVC 4 应用程序时默认获得的表单身份验证。

现在，我想制作一个用于登录我们的云服务的工具栏，并且这个工具栏必须以可以导入我们其他服务的方式制作。使用此工具栏登录应该会登录到我们所有的服务，这些服务分为不同的 MVC 应用程序。因此，在浏览“service1”然后转到“service2”时登录，您应该仍然使用同一用户登录。

谁能在这里指出我正确的方向？我应该为这个工具栏制作一个单独的 MVC 应用程序，并以某种方式在我的所有其他项目中引用它吗？我应该将我的控制器导出到一个单独的项目中并使用它们吗？我不确定这里的最佳做法是什么，也不确定在哪里可以找到我需要的关于此事的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:01:41.620

由于您将在不同域上托管您的应用程序，因此您可以通过 Stack Exchange 网络实现一些单点登录机制：[https ://meta.stackexchange.com/questions/64260/how-does-sos-新的自动登录功能工作/64274#64274](https://meta.stackexchange.com/questions/64260/how-does-sos-new-auto-login-feature-work/64274#64274)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:10:30.653

不同的域意味着您将无法共享表单 cookie。您应该学习如何使用一种企业单点登录协议——使用公认的协议意味着您可以轻松地集成其他应用程序，即使它们是用不同的技术开发的（大多数开发环境都支持标准化协议）。

可能的候选人是：

*   OAuth2 协议。这是一个受人尊敬的协议，因为谷歌、LiveID、Facebook、Twitter 和其他人都支持它。要构建 OAuth2 服务器，您将需要像 DotNetOpenAuth 这样的框架。

*   WS-联邦。在 .NET 世界中得到了很多关注，因为我们获得了 Windows Identity Foundation 框架，它允许您创建 WS-Federation 服务器和客户端。

无论如何，我的建议是现在就投入你的时间，因为这将在未来得到很好的回报。

# android - Android微调器自定义？

> ID：11673133
> 
> 赞同：0
> 
> 时间：2012-07-26T15:48:17.160
> 
> 标签：android, spinner

我正在尝试创建一个看起来与此 android 示例中的完全相同的微调器，但不确定如何或是否必须自定义？我无法想象它必须是自定义布局，因为它在他们的示例中以这种方式显示......

[http://developer.android.com/guide/topics/ui/controls/spinner.html#Populate](http://developer.android.com/guide/topics/ui/controls/spinner.html#Populate)

![在此处输入图像描述](../Images/245fe2978f8471c95b289cb9c48bbef2.png)

我不关心列表的外观，而只关心微调器使用下角箭头的外观。这就是我想要的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T17:31:03.533

[该项目](https://github.com/ChristopheVersieux/HoloEverywhere)试图通过将 holo 主题构建到 Android 库项目中来支持它。您可以将该库与您的项目链接，以便访问全息主题小部件。

我从未使用过它，但我认为它包含您正在寻找的微调器小部件。

# sql - 计算两个日期之间的整月

> ID：11673136
> 
> 赞同：1
> 
> 时间：2012-07-26T15:48:26.193
> 
> 标签：sql, postgresql, datetime, postgresql-9.1, generate-series

我已经为此工作了几个小时，没有运气并且碰壁了。我的数据如下所示：

```
Date1          Date2
2012-05-06     2012-05-05
2012-03-20     2012-01-05 
```

我要做的是在两个日期之间的每个月的计数中加 1。所以我的输出理想情况下是这样的：

```
Year    Month    Sum
2012    2        1 
```

换句话说，它应该检查两个日期之间的“空”月份并将它们加 1。

这是我到目前为止制定的代码。它基本上会计算两个日期之间的月数，并将它们分组为月和年。

```
SELECT 
    EXTRACT(YEAR FROM Date2::date) as "Year", 
    EXTRACT(MONTH FROM Date2::date) as "Month",
    SUM(DATE_PART('year', Date1::date) - DATE_PART('year', Date2::date)) * 12 +
    (DATE_PART('month', Date1::date) - DATE_PART('month', Date2::date))
FROM
    test
GROUP BY 
    "Year", 
    "Month",
ORDER BY
    "Year" DESC, 
    "Month" DESC; 
```

这就是我卡住的地方——我不知道如何为每个“空”月实际添加 1。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T00:18:56.540

### 测试设置

使用一些示例行（应在问题中提供）：

```
CREATE TABLE test (
   test_id serial PRIMARY KEY
 , date1   date NOT NULL
 , date2   date NOT NULL
);

INSERT INTO test(date1, date2)
VALUES
   ('2012-03-20', '2012-01-05')  -- 2012-02 lies in between
 , ('2012-01-20', '2012-03-05')  -- 2012-02 (reversed)
 , ('2012-05-06', '2012-05-05')  -- nothing
 , ('2012-05-01', '2012-06-30')  -- still nothing
 , ('2012-08-20', '2012-11-05')  -- 2012-09 - 2012-10
 , ('2012-11-20', '2013-03-05')  -- 2012-12 - 2013-02
; 
```

### Postgres **9.3**或更新版本

使用`LATERAL`连接：

```
SELECT to_char(mon, 'YYYY') AS year
     , to_char(mon, 'MM')   AS month
     , count(*) AS ct
FROM  (
   SELECT date_trunc('mon',    least(date1, date2)::timestamp) + interval '1 mon' AS d1
        , date_trunc('mon', greatest(date1, date2)::timestamp) - interval '1 mon' AS d2
   FROM   test
   ) sub1
 , generate_series(d1, d2, interval '1 month') mon  -- implicit CROSS JOIN LATERAL
WHERE  d2 >= d1 -- exclude ranges without gap right away
GROUP  BY mon
ORDER  BY mon; 
```

*   [LATERAL 和 PostgreSQL 中的子查询有什么区别？](https://stackoverflow.com/questions/28550679/what-is-the-difference-between-lateral-and-a-subquery-in-postgresql/28557803#28557803)

### Postgres 9.2 或更高版本

没有`LATERAL`，还没有。改用子查询：

```
SELECT to_char(mon, 'YYYY') AS year
     , to_char(mon, 'MM')   AS month
     , count(*) AS ct
FROM  (
   SELECT generate_series(d1, d2, interval '1 month') AS mon
   FROM  (
      SELECT date_trunc('mon',    least(date1, date2)::timestamp) + interval '1 mon' AS d1
           , date_trunc('mon', greatest(date1, date2)::timestamp) - interval '1 mon' AS d2
      FROM   test
      ) sub1
   WHERE  d2 >= d1 -- exclude ranges without gap right away
   ) sub2
GROUP  BY mon
ORDER  BY mon; 
```

### 结果

```
 year | month | ct
------+-------+----
 2012 |     2 |  2
 2012 |     9 |  1
 2012 |    10 |  1
 2012 |    12 |  1
 2013 |     1 |  1
 2013 |     2 |  1 
```

*db<>fiddle[这里](https://dbfiddle.uk/?rdbms=postgres_11&fiddle=663a0fc1eab25650ddf0a035ff9daf97)*
[是 SQL Fiddle。](http://sqlfiddle.com/#!17/7e616/1)

### 解释

您正在寻找两个日期之间的*完整日历月。*

这些查询以升序或降序处理任何日期或时间戳，并且应该表现良好。

该`WHERE`子句是可选的，因为[**`generate_series()`**](https://www.postgresql.org/docs/current/functions-srf.html)如果 start > end 则不返回任何行。但是先验地排除空范围应该更快一些。

演员 to`timestamp`使它更清洁和更快。理由：

*   [在 PostgreSQL 中生成两个日期之间的时间序列](https://stackoverflow.com/questions/14113469/generating-time-series-between-two-dates-in-postgresql/46499873#46499873)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-09T12:28:06.340

age(timestamp1, timestamp2) => 返回区间

我们尝试从间隔中提取年份和月份并相应地添加它们。

> 选择提取（年龄（时间戳1，时间戳2））* 12 +提取（年龄（时间戳1，时间戳2）中的月份）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:53:54.600

AFAIK，您可以简单地在 postgresql 中减去/添加日期

```
'2001-06-27 14:43:21'::DATETIME - '2001-06-27 14:33:21'::DATETIME = '00:10:00'::INTERVAL 
```

所以在你的情况下，请求部分应该看起来像

```
DATE_PART('month', Date1::datetime - Date2::datetime) as "MonthInterval" 
```

# c++ - 我的 C++ 程序中的分段错误

> ID：11673137
> 
> 赞同：0
> 
> 时间：2012-07-26T15:48:29.390
> 
> 标签：c++, segmentation-fault

我正在为游戏 Flood-It（我认为也称为 Blobs）制作求解器。该程序编译并运行良好，直到最后。. . 我在 main() 函数的末尾做了一个最终的“cout”（然后添加了“return 0”，没有任何效果），它弹出“FloodItSolver.exe 已停止工作......”

当我执行“gdb FloodItSolver”然后执行“r”时，我以以下输出结束：

```
Did not complete in 25 turns.
Program received signal SIGSEGV, Segmentation fault.
0x6fc5b222 in libstdc++-6!_ZN9__gnu_cxx18__exchange_and_addEPVii () from C:\MinGW\bin\libstdc++-6.dll 
```

关于“未完成”的那部分是我最后想到的。

更新：这是在 gdb 发出“回溯”命令的结果：

```
(gdb) backtrace
#0  0x6fc5b222 in libstdc++-6!_ZN9__gnu_cxx18__exchange_and_addEPVii () from C:\MinGW\bin\libstdc++-6.dll
#1  0x6fcbd66e in libstdc++-6!atomic_flag_test_and_set_explicit () from C:\MinGW\bin\libstdc++-6.dll
#2  0x00401fee in __tcf_2 () at flooditsolver.cpp:9
#3  0x75b3c3e9 in msvcrt!isspace () from C:\Windows\syswow64\msvcrt.dll
#4  0x75b437df in msvcrt!_cexit () from C:\Windows\syswow64\msvcrt.dll
#5  0x00000000 in ?? ()
(gdb) 
```

这是没有意义的，因为我的 main() 结束了！为什么会在这里出现SegFault？

我的代码：

```
#include <iostream>
#include <fstream>
using namespace std;

//  GLOBAL---------------------------------------------------------------------
int rgbPos, scPos, color, grid[14][14];
ifstream file("Floodit.txt");
bool isFlood[14][14];
string line;
//  END GLOBAL-------------------------------------------------------------

//  Function Pool ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~
//  HighestBorderCount(), NonFloodColorsLeft(), CanEliminateAColor(), etc...
//  Gather a list of variables you consider when planning your next move, then make a function for it
//  So far I only have HighestBorderCount()

int HighestBorderCount()
{
    int highest=0, returnMe, countColors[6]={0,0,0,0,0,0};
    bool paddedBorder[16][16], border[14][14];
    for(int x=0;x<16;x++) {for(int y=0;y<16;y++) {paddedBorder[x][y]=false;}}
    for(int x=0;x<14;x++) {for(int y=0;y<14;y++) {border[x][y]=false;paddedBorder[x+1][y+1]=isFlood[x][y];}}    // Create copy of isFlood, zero out border[][]
    for(int x=0;x<14;x++) 
    {
        for (int y=0;y<14;y++) 
        {
            if( (!paddedBorder[x+1][y+1]) && (  (paddedBorder[x][y+1]) || (paddedBorder[x+1][y]) || (paddedBorder[x+2][y+1]) || (paddedBorder[x+1][y+2])    )   ) border[x][y]=true;
            if(border[x][y])
            {
                switch(grid[x][y])
                {
                    case 0:
                        countColors[0]++;
                        cout<<"0 on border\n";
                        break;
                    case 1:
                        countColors[1]++;
                        cout<<"1 on border\n";
                        break;
                    case 2:
                        countColors[2]++;
                        cout<<"2 on border\n";
                        break;
                    case 3:
                        countColors[3]++;
                        cout<<"3 on border\n";
                        break;
                    case 4:
                        countColors[4]++;
                        cout<<"4 on border\n";
                        break;
                    case 5:
                        countColors[5]++;
                        cout<<"5 on border\n";
                        break;
                }
            }
        }
    }
    for(int x=0;x<6;x++) if(countColors[x]>highest) highest=countColors[x];
    for(int x=0;x<6;x++) if(countColors[x]==highest) returnMe=x;
    return returnMe;
}

//  End Function Pool ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~

void Pivot(int x, int y)
{
    if(x>0)
    {
        if((grid[x-1][y]==grid[x][y])&&(isFlood[x-1][y]==false))
        {
            isFlood[x-1][y]=true;
            Pivot(x-1, y);
        }
    }
    if(x<14)
    {
        if((grid[x+1][y]==grid[x][y])&&(isFlood[x+1][y]==false))
        {
            isFlood[x+1][y]=true;
            Pivot(x+1, y);
        }
    }
    if(y>0)
    {
        if((grid[x][y-1]==grid[x][y])&&(isFlood[x][y-1]==false))
        {
            isFlood[x][y-1]=true;
            Pivot(x, y-1);
        }
    }
    if(y<14)
    {
        if((grid[x][y+1]==grid[x][y])&&(isFlood[x][y+1]==false))
        {
            isFlood[x][y+1]=true;
            Pivot(x, y+1);
        }
    }
}

void Flood(int FloodColor)
{
    for(int x=0;x<14;x++) {for (int y=0;y<14;y++) {if (isFlood[x][y]) Pivot(x,y);}} //  This run tells us what area to include in the flood
    for(int x=0;x<14;x++)
    {
        for(int y=0;y<14;y++)
        {
            if(isFlood[x][y]) grid[x][y]=FloodColor;                                                //  This floods the area
            cout<<grid[x][y]<<" ";
        }
        cout<<endl;
    }
    cout<<endl;
    for(int x=0;x<14;x++) {for (int y=0;y<14;y++) {if (isFlood[x][y]) Pivot(x,y);}} //  This updates the flood area, so we include newly acquired blocks
}

int GetColor(string s)
{
    s=s.substr(0,s.find(","));
    if(s=="237") return 0;              //  PINK == 0
    else if(s=="96") return 1;          //  PURPLE == 1
    else if(s=="243") return 2;         //  YELLOW == 2
    else if(s=="220") return 3;         //  RED == 3
    else if(s=="70") return 4;          //  BLUE == 4
    else if(s=="126") return 5;         //  GREEN == 5
    else return 6;                              
}

int main(/*int argc, char* argv[]*/)
{
    int input, counter=0;
    for(int x=0;x<14;x++) {for(int y=0;y<14;y++) {isFlood[x][y]=false;}} 
    isFlood[0][0]=true;

    //  GET INPUT
    if(file.is_open()) {while(file.good())  {getline(file, line);}}
    file.close();

    //  POPULATE GRID
    line=line.substr(11);
    for(int x=0;x<196;x++)
    {
        rgbPos=line.find("rgb");
        scPos=line.find("; \">");
        color=GetColor(line.substr(rgbPos+4,scPos-1-(rgbPos+4)));
        grid[x/14][x%14]=color;
        line=line.substr(scPos+3);
    }

    bool complete=false;
    bool floodCheck;
    while((!complete)&&(counter<25))
    {
        counter++;
        floodCheck=true;
        //cout<<"Highest border count: "<<HighestBorderCount()<<endl;
        //cin>>input;
        Flood(HighestBorderCount());
        for(int y=0;y<14;y++) {for(int z=0;z<14;z++) {if(!isFlood[y][z]) floodCheck=false;}}
        if(floodCheck) complete=true;
    }
    if(complete) {cout<<"Completed in "<<counter<<" turns!";} else {cout<<"Did not complete in 25 turns.";}
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:58:10.313

在这段代码中：

```
for(int x=0;x<196;x++)
{
    rgbPos=line.find("rgb");
    scPos=line.find("; \">");
    color=GetColor(line.substr(rgbPos+4,scPos-1-(rgbPos+4)));
    grid[x/14][x%14]=color;
    line=line.substr(scPos+3);
} 
```

您不检查是否`find`返回`npos`。因此，您将对`string`对象进行螺旋索引。

此外，在`Pivot`：

```
//...
if(x<14)
{
    if((grid[x+1][y]==grid[x][y])&&(isFlood[x+1][y]==false))
    {
        isFlood[x+1][y]=true;
        Pivot(x+1, y);
    }
}
//...
if(y<14)
{
    if((grid[x][y+1]==grid[x][y])&&(isFlood[x][y+1]==false))
    {
        isFlood[x][y+1]=true;
        Pivot(x, y+1);
    }
} 
```

您正在索引超出`isFlood`数组的边界并为其分配一个值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T15:52:10.633

完成后的错误表明存在静态存储持续时间`main`中的变量或对象的破坏问题。`main`如果您从调试器打印回溯，您至少会看到发生错误时被销毁的对象的类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:56:55.837

尝试使用[http://en.wikipedia.org/wiki/Valgrind构建](http://en.wikipedia.org/wiki/Valgrind)

# php - 如果有人从特定网站上的链接检查您的网站，如何隐藏页脚

> ID：11673144
> 
> 赞同：0
> 
> 时间：2012-07-26T15:48:56.407
> 
> 标签：php, javascript

我最近开始对自由职业产生兴趣。我刚刚在 vWorker 上创建了一个帐户，但他们似乎不允许链接到包含您个人信息的网站。

这意味着我无法链接到我的网站组合，除非我找到一种方法来在有人点击他们的链接时隐藏页脚。

当有人点击此页面上的链接时，有没有办法隐藏我的页脚？

*   [我的 vworker 投资组合](http://www.vworker.com/RentACoder/DotNet/SoftwareCoders/ShowBioInfo.aspx?lngAuthorId=8262781&Tab=2)

仅在此场景中应隐藏页脚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:07:31.753

在jquery中我会开始隐藏页脚，默认隐藏，然后在其他情况下显示

```
$(document).ready(function(){
    if (document.referrer.indexOf("http://www.xyz.com")==-1) 
        $("#footer").show();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:53:34.633

您可以使用 Javascripts`document.referrer`来检查它们的来源？然后，如果它是从特定域引用的，则触发一些 Javascript，该 Javascript 将删除页脚。

我肯定会建议删除联系信息而不是隐藏它。

# wpf - 如何将 WPF 控件绑定到 VB.net 属性？

> ID：11673145
> 
> 赞同：3
> 
> 时间：2012-07-26T15:48:57.280
> 
> 标签：wpf, vb.net, visual-studio-2010, mvvm, binding

> **可能重复：**
> [将 WPF 属性绑定到变量的数据](https://stackoverflow.com/questions/5533803/data-binding-wpf-property-to-variable)

如何将我的 module1 属性绑定到我的 WPF TextBox1？

WPF代码：

```
<Window x:Class="MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
    <Grid>
        <TextBox Height="23" HorizontalAlignment="Left" Margin="210,146,0,0" Name="TextBox1" VerticalAlignment="Top" Width="120" />
    </Grid>
</Window> 
```

VB.net 代码：

```
Module Module1
    ReadOnly Property tbBinding As String
        Get
            Return "Success!"
        End Get
    End Property
End Module 
```

下面是我一直在根据我得到的反馈和我一直在做的阅读工作的代码。/#######当前代码正在进行中（尝试使用类而不是模块）#######/

XAML：

```
<Window x:Class="MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
    <Grid DataContext="Class1">
        <TextBox Height="23" HorizontalAlignment="Left" Margin="210,146,0,0" Name="TextBox1" VerticalAlignment="Top" Width="120" Text="{Binding Path=tbBinding2}"/>
        <Button Content="Button" Height="23" HorizontalAlignment="Left" Margin="192,74,0,0" Name="Button1" VerticalAlignment="Top" Width="75" />
    </Grid>
</Window> 
```

第一类：

```
Imports System.ComponentModel

Public Class Class1
    Implements INotifyPropertyChanged

    Public Event PropertyChanged As PropertyChangedEventHandler Implements INotifyPropertyChanged.PropertyChanged

    Private Sub NotifyPropertyChanged(ByVal info As String)
        RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(info))
    End Sub

    Dim varField As String = String.Empty

    Public Property tbBinding2 As String
        Get
            Return varField
        End Get

        Set(value As String)
            varField = value
            NotifyPropertyChanged("tbBinding2")
        End Set
    End Property
End Class 
```

主窗口：

```
Class MainWindow 

    Private Sub Button1_Click(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles Button1.Click
        Dim myClass1 As New Class1
        myClass1.tbBinding2 = "Success!"
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T19:35:54.760

你没有设置`DataContext`任何地方

WPF 有两层：数据层和 UI 层。数据层是`null`默认的，您可以通过设置`DataContext`任何 UI 对象的属性来设置它。绑定用于将数据从数据层拉入 UI 层。

因此，如果您说`MainWindow.DataContext = new Class1()`，那么您将数据层设置`MainWindow`为对象的新实例`Class1`。

在 XAML 中写入`<TextBox Text="{Binding tbProperty}" />`是告诉 WPF 在数据层中查找名为的属性并将`tbProperty`其用于`Text`.`TextBox`

如果您将`tbProperty`对象`Class1`中的 更改为`DataContext`，则该更改也将反映在`TextBox.Text`（假设您已实现`INotifyPropertyChanged`）中。如果绑定模式设置为`TwoWay`（默认为`TextBox.Text`），则更改为`TextBox.Text`也将更新`tbProperty`数据层中的 。

如果您有兴趣，我实际上最近[在我的博客上发布了一个](http://rachel53461.wordpress.com/2012/07/14/what-is-this-datacontext-you-speak-of/)[概述。`DataContext`](http://rachel53461.wordpress.com/2012/07/14/what-is-this-datacontext-you-speak-of/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T17:58:51.810

您需要实现`INotifyPropertyChanged`接口。有关示例，请参阅[本文。](http://msdn.microsoft.com/en-us/library/ms229614.aspx#Y0)

**编辑：**

下面是`Class1`从 XAML 绑定到类（也称为“视图模型”）的示例：

```
<Window x:Class="MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:viewModels:"clr-namespace:MyApplication.ViewModels"
    Title="MainWindow" Height="350" Width="525">
    <Window.DataContext>
        <viewModels:Class1 />
    </Window.DataContext>

    <Grid>
        <TextBox Height="23" HorizontalAlignment="Left" Margin="210,146,0,0" Name="TextBox1" VerticalAlignment="Top" Width="120" Text="{Binding Path=tbBinding2}"/>
        <Button Content="Button" Height="23" HorizontalAlignment="Left" Margin="192,74,0,0" Name="Button1" VerticalAlignment="Top" Width="75" />
    </Grid>
</Window> 
```

请注意，此 XAML 假定`Class1`该类包含在命名空间下的同一程序集中`MyApplication.ViewModels`。

# jsf - 会话范围的 bean 和 HttpServletRequest 之间有什么关系？

> ID：11673146
> 
> 赞同：1
> 
> 时间：2012-07-26T15:49:03.800
> 
> 标签：jsf, javabeans, httprequest

在试图弄清楚如何为 JSF 应用程序实现登录过滤器时，我看到了这两行我不太了解的代码：

```
public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws ServletException, IOException {  

HttpServletRequest req = (HttpServletRequest) request;
LoginBean login = (LoginBean) req.getSession().getAttribute("login");

} 
```

假设 LoginBean 类是一个名为“login”的会话范围 bean，我注意到 bean 是请求的一个属性，它们之间的关系是什么？所有会话范围的 bean 在请求会话中都保存为“属性”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:57:53.683

> *所有会话范围的 bean 在请求会话中都保存为“属性”吗？*

这是正确的。JSF 只是一个建立在裸 Servlet API 之上的 MVC 框架，而不是一个完全独立的框架，可以在没有 Servlet API 的情况下运行。更重要的是，JSF 核心控制器`FacesServlet`是完全值得的`Servlet`，所以它肯定需要一个 servlet 容器来运行。“会话”的概念在 Servlet API 中提供`HttpSession`，因此将 JSF 会话范围的 bean 存储在其中而不是重新发明它是完全有意义的。

请注意，JSF 请求范围的 bean 存储为`HttpServletRequest`属性，而 JSF 应用程序范围的 bean 存储为`ServletContext`属性。

### 也可以看看：

*   [在任何 Servlet 相关类中按名称获取 JSF 托管 bean](https://stackoverflow.com/questions/2633112/jsf-get-managed-bean-by-name/)
*   [servlet 是如何工作的？实例化、会话、共享变量和多线程](https://stackoverflow.com/questions/3106452/how-do-servlets-work-instantiation-session-variables-and-multithreading)

# iphone - Xcode 4.4 现在可以合并两个开发者更改的storyboard 文件吗？

> ID：11673147
> 
> 赞同：0
> 
> 时间：2012-07-26T15:49:07.063
> 
> 标签：iphone, ios, xcode, storyboard

iPhone 中的故事板文件一直是开发人员的噩梦——两个开发人员更改同一个文件时根本无法做到！

这似乎是一个非常严重的错误！我想知道这个错误是否已在 Xcode 4.4 中修复？谁能带我四处走走？

谢谢

以前版本的 Xcode 也有类似的问题：

4.3： [Xcode 4.3 如何合并两个开发者使用 SVN 的故事板更改？](https://stackoverflow.com/questions/11434581/xcode-4-3-how-to-merge-storyboard-changes-from-two-developers-using-svn)

4.2： [XCode Storyboard 合并](https://stackoverflow.com/questions/8393214/xcode-storyboard-merging)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:53:10.920

故事板文件是（并且一直是？）XML；您通常可以使用普通的文本合并工具来合并它。

# bing-api - Bing API Azure Marketplace：如何知道是否有更多结果？

> ID：11673149
> 
> 赞同：0
> 
> 时间：2012-07-26T15:49:17.077
> 
> 标签：bing-api

我*在 Windows Azure Marketplace 中使用 Bing 搜索 API*（即替换旧 Bing 2.0 API 的 API，于 2012 年 8 月 1 日到期）。Microsoft 提供的[迁移指南](http://www.google.ch/url?sa=t&rct=j&q=migration%20guide%20bing&source=web&cd=1&ved=0CFQQFjAA&url=http://www.bing.com/webmaster/content/developers/ADM_MIGRATION_GUIDE.docx&ei=JGURUJjDO4WM4gSo2IDYAw&usg=AFQjCNGb51AqhxLDxCqHgUDymDuoNYFzVQ)指出：

> 如果没有更多的结果页面，该`/feed/link[@rel=’next’]`属性将不再出现 [...]。

然而，情况似乎并非总是如此。例如，新闻查询`"Roger Federer"`不包含`link`元素：

**请求：** [https ://api.datamarket.azure.com/Data.ashx/Bing/Search/News?Query=%27"Roger+Federer"%27](https://api.datamarket.azure.com/Data.ashx/Bing/Search/News?Query=%27Roger%20Federer%27)

**回复：**

```
<feed xmlns:base="https://api.datamarket.azure.com/Data.ashx/Bing/Search/News"
    xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices"
    xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"
    xmlns="http://www.w3.org/2005/Atom">
    <title type="text">"Roger Federer"</title>
    <subtitle type="text">Bing News Search</subtitle>
    <id>https://api.datamarket.azure.com/Data.ashx/Bing/Search/News?Query='"Roger Federer"'</id>
    <rights type="text"/>
    <updated>2012-07-26T15:43:03Z</updated>
    <entry>
        <!-- ... -->
    </entry>
    <!-- ... -->
</feed> 
```

尽管如此，还有更多新闻：[https ://api.datamarket.azure.com/Data.ashx/Bing/Search/News?Query=%27"Roger+Federer"%27&$skip=50](https://api.datamarket.azure.com/Data.ashx/Bing/Search/News?Query=%27Roger%20Federer%27&%24skip=50)

有谁知道问题可能出在哪里？（或者哪里有可靠的 API 文档？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T22:03:18.517

要做的一件事是更新你的 BingSearchContainer.cs - 当我第一次开始使用它时，我发现有一个旧版本给我带来了各种各样的问题。当我更新了很多东西开始工作。

我认为问题在于 BingSearchContainer 正在“修复”您的查询并将您搞砸。尝试以下操作：

然后尝试不带“标记的查询。它可能会成功并返回结果。

尝试使用 ' 代替，您可能会得到一些结果。

我认为容器默认将所有查询作为单个短语匹配转义。因此，只需添加搜索即可。现在，当您确实有两个短语需要搜索时……我也无法开始工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T10:33:27.253

我无法再重现这个：响应现在包含一个`link`元素。

我想必应的家伙在此期间已经解决了这个问题。

# concurrency - CUDA 多 GPU 执行中的并发性

> ID：11673154
> 
> 赞同：5
> 
> 时间：2012-07-26T15:49:30.047
> 
> 标签：concurrency, cuda, gpu, multiple-gpu

我在带有`4`GPU 的多 GPU 系统上运行 cuda 内核函数。我预计它们会同时发布，但事实并非如此。我测量每个内核的启动时间，第二个内核在第一个内核完成执行后启动。所以在 GPU 上启动内核`4`并不比`1`单个 GPU 快。

我怎样才能让它们同时工作？

这是我的代码：

```
cudaSetDevice(0);
GPU_kernel<<< gridDim, threadsPerBlock >>>(d_result_0, parameterA +(0*rateA), parameterB + (0*rateB));
cudaMemcpyAsync(h_result_0, d_result_0, mem_size_result, cudaMemcpyDeviceToHost);

cudaSetDevice(1);
GPU_kernel<<< gridDim, threadsPerBlock >>>(d_result_1, parameterA +(1*rateA), parameterB + (1*rateB));
cudaMemcpyAsync(h_result_1, d_result_1, mem_size_result, cudaMemcpyDeviceToHost);

cudaSetDevice(2);
GPU_kernel<<< gridDim, threadsPerBlock >>>(d_result_2, parameterA +(2*rateA), parameterB + (2*rateB));
cudaMemcpyAsync(h_result_2, d_result_2, mem_size_result, cudaMemcpyDeviceToHost);

cudaSetDevice(3);
GPU_kernel<<< gridDim, threadsPerBlock >>>(d_result_3, parameterA +(3*rateA), parameterB + (3*rateB));
cudaMemcpyAsync(h_result_3, d_result_3, mem_size_result, cudaMemcpyDeviceToHost); 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2016-01-26T08:55:53.790

我做了一些关于在`4`Kepler K20c GPU 集群上实现并发执行的实验。我已经考虑`8`了测试用例，下面报告了其相应的代码以及分析器时间线。

**测试用例 #1 - “广度优先”方法 - 同步复制**

*- 代码 -*

```
#include "Utilities.cuh"
#include "InputOutput.cuh"

#define BLOCKSIZE 128

/*******************/
/* KERNEL FUNCTION */
/*******************/
template<class T>
__global__ void kernelFunction(T * __restrict__ d_data, const unsigned int NperGPU) {

    const int tid = threadIdx.x + blockIdx.x * blockDim.x;

    if (tid < NperGPU) for (int k = 0; k < 1000; k++) d_data[tid] = d_data[tid] * d_data[tid];

}

/******************/
/* PLAN STRUCTURE */
/******************/
template<class T>
struct plan {
    T *d_data;
};

/*********************/
/* SVD PLAN CREATION */
/*********************/
template<class T>
void createPlan(plan<T>& plan, unsigned int NperGPU, unsigned int gpuID) {

    // --- Device allocation
    gpuErrchk(cudaSetDevice(gpuID));
    gpuErrchk(cudaMalloc(&(plan.d_data), NperGPU * sizeof(T)));
}

/********/
/* MAIN */
/********/
int main() {

    const int numGPUs   = 4;
    const int NperGPU   = 500000;
    const int N         = NperGPU * numGPUs;

    plan<double> plan[numGPUs];
    for (int k = 0; k < numGPUs; k++) createPlan(plan[k], NperGPU, k);

    double *inputMatrices = (double *)malloc(N * sizeof(double));

    // --- "Breadth-first" approach - no async
    for (int k = 0; k < numGPUs; k++) {
        gpuErrchk(cudaSetDevice(k));
        gpuErrchk(cudaMemcpy(plan[k].d_data, inputMatrices + k * NperGPU, NperGPU * sizeof(double), cudaMemcpyHostToDevice));
    }

    for (int k = 0; k < numGPUs; k++) {
        gpuErrchk(cudaSetDevice(k));
        kernelFunction<<<iDivUp(NperGPU, BLOCKSIZE), BLOCKSIZE>>>(plan[k].d_data, NperGPU);
    }

    for (int k = 0; k < numGPUs; k++) {
        gpuErrchk(cudaSetDevice(k));
        gpuErrchk(cudaMemcpy(inputMatrices + k * NperGPU, plan[k].d_data, NperGPU * sizeof(double), cudaMemcpyDeviceToHost));
    }

    gpuErrchk(cudaDeviceReset());
} 
```

*- 探查器时间表 -* [![在此处输入图像描述](../Images/11a799993e326199507e91d1d209cd9e.png)](https://i.stack.imgur.com/fPlIo.jpg)

可以看出，使用`cudaMemcpy`并不能在副本中实现并发，而是在内核执行中实现并发。

**测试用例 #2 - “深度优先”方法 - 同步复制**

*- 代码 -*

```
#include "Utilities.cuh"
#include "InputOutput.cuh"

#define BLOCKSIZE 128

/*******************/
/* KERNEL FUNCTION */
/*******************/
template<class T>
__global__ void kernelFunction(T * __restrict__ d_data, const unsigned int NperGPU) {

    const int tid = threadIdx.x + blockIdx.x * blockDim.x;

    if (tid < NperGPU) for (int k = 0; k < 1000; k++) d_data[tid] = d_data[tid] * d_data[tid];

}

/******************/
/* PLAN STRUCTURE */
/******************/
template<class T>
struct plan {
    T *d_data;
};

/*********************/
/* SVD PLAN CREATION */
/*********************/
template<class T>
void createPlan(plan<T>& plan, unsigned int NperGPU, unsigned int gpuID) {

    // --- Device allocation
    gpuErrchk(cudaSetDevice(gpuID));
    gpuErrchk(cudaMalloc(&(plan.d_data), NperGPU * sizeof(T)));
}

/********/
/* MAIN */
/********/
int main() {

    const int numGPUs   = 4;
    const int NperGPU   = 500000;
    const int N         = NperGPU * numGPUs;

    plan<double> plan[numGPUs];
    for (int k = 0; k < numGPUs; k++) createPlan(plan[k], NperGPU, k);

    double *inputMatrices = (double *)malloc(N * sizeof(double));

    // --- "Depth-first" approach - no async
    for (int k = 0; k < numGPUs; k++) {
        gpuErrchk(cudaSetDevice(k));
        gpuErrchk(cudaMemcpy(plan[k].d_data, inputMatrices + k * NperGPU, NperGPU * sizeof(double), cudaMemcpyHostToDevice));
        kernelFunction<<<iDivUp(NperGPU, BLOCKSIZE), BLOCKSIZE>>>(plan[k].d_data, NperGPU);
        gpuErrchk(cudaMemcpy(inputMatrices + k * NperGPU, plan[k].d_data, NperGPU * sizeof(double), cudaMemcpyDeviceToHost));
    }

    gpuErrchk(cudaDeviceReset());
} 
```

*- 探查器时间表 -*

[![在此处输入图像描述](../Images/d80e0043649daadf894977fa1dabb32e.png)](https://i.stack.imgur.com/4eeMn.jpg)

这一次，在内存副本和内核执行中都没有实现并发。

**测试用例 #3 - “深度优先”方法 - 带流的异步复制**

*- 代码 -*

```
#include "Utilities.cuh"
#include "InputOutput.cuh"

#define BLOCKSIZE 128

/*******************/
/* KERNEL FUNCTION */
/*******************/
template<class T>
__global__ void kernelFunction(T * __restrict__ d_data, const unsigned int NperGPU) {

    const int tid = threadIdx.x + blockIdx.x * blockDim.x;

    if (tid < NperGPU) for (int k = 0; k < 1000; k++) d_data[tid] = d_data[tid] * d_data[tid];

}

/******************/
/* PLAN STRUCTURE */
/******************/
template<class T>
struct plan {
    T               *d_data;
    T               *h_data;
    cudaStream_t    stream;
};

/*********************/
/* SVD PLAN CREATION */
/*********************/
template<class T>
void createPlan(plan<T>& plan, unsigned int NperGPU, unsigned int gpuID) {

    // --- Device allocation
    gpuErrchk(cudaSetDevice(gpuID));
    gpuErrchk(cudaMalloc(&(plan.d_data), NperGPU * sizeof(T)));
    gpuErrchk(cudaMallocHost((void **)&plan.h_data, NperGPU * sizeof(T)));
    gpuErrchk(cudaStreamCreate(&plan.stream));
}

/********/
/* MAIN */
/********/
int main() {

    const int numGPUs   = 4;
    const int NperGPU   = 500000;
    const int N         = NperGPU * numGPUs;

    plan<double> plan[numGPUs];
    for (int k = 0; k < numGPUs; k++) createPlan(plan[k], NperGPU, k);

     // --- "Depth-first" approach - async
    for (int k = 0; k < numGPUs; k++)
    {
        gpuErrchk(cudaSetDevice(k));
        gpuErrchk(cudaMemcpyAsync(plan[k].d_data, plan[k].h_data, NperGPU * sizeof(double), cudaMemcpyHostToDevice, plan[k].stream));
        kernelFunction<<<iDivUp(NperGPU, BLOCKSIZE), BLOCKSIZE, 0, plan[k].stream>>>(plan[k].d_data, NperGPU);
        gpuErrchk(cudaMemcpyAsync(plan[k].h_data, plan[k].d_data, NperGPU * sizeof(double), cudaMemcpyDeviceToHost, plan[k].stream));
    }

    gpuErrchk(cudaDeviceReset());
} 
```

*- 探查器时间表 -*

[![在此处输入图像描述](../Images/b921472d745fe6919d0ef25ae0e55c37.png)](https://i.stack.imgur.com/989kb.jpg)

正如预期的那样，实现了并发性。

**测试用例 #4 - “深度优先”方法 - 默认流中的异步复制**

*- 代码 -*

```
#include "Utilities.cuh"
#include "InputOutput.cuh"

#define BLOCKSIZE 128

/*******************/
/* KERNEL FUNCTION */
/*******************/
template<class T>
__global__ void kernelFunction(T * __restrict__ d_data, const unsigned int NperGPU) {

    const int tid = threadIdx.x + blockIdx.x * blockDim.x;

    if (tid < NperGPU) for (int k = 0; k < 1000; k++) d_data[tid] = d_data[tid] * d_data[tid];

}

/******************/
/* PLAN STRUCTURE */
/******************/
template<class T>
struct plan {
    T               *d_data;
    T               *h_data;
};

/*********************/
/* SVD PLAN CREATION */
/*********************/
template<class T>
void createPlan(plan<T>& plan, unsigned int NperGPU, unsigned int gpuID) {

    // --- Device allocation
    gpuErrchk(cudaSetDevice(gpuID));
    gpuErrchk(cudaMalloc(&(plan.d_data), NperGPU * sizeof(T)));
    gpuErrchk(cudaMallocHost((void **)&plan.h_data, NperGPU * sizeof(T)));
}

/********/
/* MAIN */
/********/
int main() {

    const int numGPUs   = 4;
    const int NperGPU   = 500000;
    const int N         = NperGPU * numGPUs;

    plan<double> plan[numGPUs];
    for (int k = 0; k < numGPUs; k++) createPlan(plan[k], NperGPU, k);

    // --- "Depth-first" approach - no stream
    for (int k = 0; k < numGPUs; k++)
    {
        gpuErrchk(cudaSetDevice(k));
        gpuErrchk(cudaMemcpyAsync(plan[k].d_data, plan[k].h_data, NperGPU * sizeof(double), cudaMemcpyHostToDevice));
        kernelFunction<<<iDivUp(NperGPU, BLOCKSIZE), BLOCKSIZE>>>(plan[k].d_data, NperGPU);
        gpuErrchk(cudaMemcpyAsync(plan[k].h_data, plan[k].d_data, NperGPU * sizeof(double), cudaMemcpyDeviceToHost));
    }

    gpuErrchk(cudaDeviceReset());
} 
```

*- 探查器时间表 -*

[![在此处输入图像描述](../Images/e63fd8038e4ed7b3a615dc05d5949541.png)](https://i.stack.imgur.com/P5J0V.jpg)

尽管使用默认流，但实现了并发。

**测试用例 #5 - “深度优先”方法 - 默认流和唯一宿主`cudaMallocHost`ed 向量中的异步复制**

*- 代码 -*

```
#include "Utilities.cuh"
#include "InputOutput.cuh"

#define BLOCKSIZE 128

/*******************/
/* KERNEL FUNCTION */
/*******************/
template<class T>
__global__ void kernelFunction(T * __restrict__ d_data, const unsigned int NperGPU) {

    const int tid = threadIdx.x + blockIdx.x * blockDim.x;

    if (tid < NperGPU) for (int k = 0; k < 1000; k++) d_data[tid] = d_data[tid] * d_data[tid];

}

/******************/
/* PLAN STRUCTURE */
/******************/
template<class T>
struct plan {
    T               *d_data;
};

/*********************/
/* SVD PLAN CREATION */
/*********************/
template<class T>
void createPlan(plan<T>& plan, unsigned int NperGPU, unsigned int gpuID) {

    // --- Device allocation
    gpuErrchk(cudaSetDevice(gpuID));
    gpuErrchk(cudaMalloc(&(plan.d_data), NperGPU * sizeof(T)));
}

/********/
/* MAIN */
/********/
int main() {

    const int numGPUs   = 4;
    const int NperGPU   = 500000;
    const int N         = NperGPU * numGPUs;

    plan<double> plan[numGPUs];
    for (int k = 0; k < numGPUs; k++) createPlan(plan[k], NperGPU, k);

    // --- "Depth-first" approach - no stream
    double *inputMatrices;   gpuErrchk(cudaMallocHost(&inputMatrices, N * sizeof(double)));
    for (int k = 0; k < numGPUs; k++)
    {
        gpuErrchk(cudaSetDevice(k));
        gpuErrchk(cudaMemcpyAsync(plan[k].d_data, inputMatrices + k * NperGPU, NperGPU * sizeof(double), cudaMemcpyHostToDevice));
        kernelFunction<<<iDivUp(NperGPU, BLOCKSIZE), BLOCKSIZE>>>(plan[k].d_data, NperGPU);
        gpuErrchk(cudaMemcpyAsync(inputMatrices + k * NperGPU, plan[k].d_data, NperGPU * sizeof(double), cudaMemcpyDeviceToHost));
    }

    gpuErrchk(cudaDeviceReset());
} 
```

*- 探查器时间表 -*

[![在此处输入图像描述](../Images/6bec77f68a1d59f13af1ba236154d9ef.png)](https://i.stack.imgur.com/Lyms2.jpg)

再次实现并发。

**测试用例 #6 - 使用流异步复制的“广度优先”方法**

*- 代码 -*

```
#include "Utilities.cuh"
#include "InputOutput.cuh"

#define BLOCKSIZE 128

/*******************/
/* KERNEL FUNCTION */
/*******************/
template<class T>
__global__ void kernelFunction(T * __restrict__ d_data, const unsigned int NperGPU) {

    const int tid = threadIdx.x + blockIdx.x * blockDim.x;

    if (tid < NperGPU) for (int k = 0; k < 1000; k++) d_data[tid] = d_data[tid] * d_data[tid];

}

/******************/
/* PLAN STRUCTURE */
/******************/
// --- Async
template<class T>
struct plan {
    T               *d_data;
    T               *h_data;
    cudaStream_t    stream;
};

/*********************/
/* SVD PLAN CREATION */
/*********************/
template<class T>
void createPlan(plan<T>& plan, unsigned int NperGPU, unsigned int gpuID) {

    // --- Device allocation
    gpuErrchk(cudaSetDevice(gpuID));
    gpuErrchk(cudaMalloc(&(plan.d_data), NperGPU * sizeof(T)));
    gpuErrchk(cudaMallocHost((void **)&plan.h_data, NperGPU * sizeof(T)));
    gpuErrchk(cudaStreamCreate(&plan.stream));
}

/********/
/* MAIN */
/********/
int main() {

    const int numGPUs   = 4;
    const int NperGPU   = 500000;
    const int N         = NperGPU * numGPUs;

    plan<double> plan[numGPUs];
    for (int k = 0; k < numGPUs; k++) createPlan(plan[k], NperGPU, k);

    // --- "Breadth-first" approach - async
    for (int k = 0; k < numGPUs; k++) {
        gpuErrchk(cudaSetDevice(k));
        gpuErrchk(cudaMemcpyAsync(plan[k].d_data, plan[k].h_data, NperGPU * sizeof(double), cudaMemcpyHostToDevice, plan[k].stream));
    }

    for (int k = 0; k < numGPUs; k++) {
        gpuErrchk(cudaSetDevice(k));
        kernelFunction<<<iDivUp(NperGPU, BLOCKSIZE), BLOCKSIZE, 0, plan[k].stream>>>(plan[k].d_data, NperGPU);
    }

    for (int k = 0; k < numGPUs; k++) {
        gpuErrchk(cudaSetDevice(k));
        gpuErrchk(cudaMemcpyAsync(plan[k].h_data, plan[k].d_data, NperGPU * sizeof(double), cudaMemcpyDeviceToHost, plan[k].stream));
    }

    gpuErrchk(cudaDeviceReset());
} 
```

*- 探查器时间表 -*

[![在此处输入图像描述](../Images/f7b8516fdaea3ab7059406561f9ea79a.png)](https://i.stack.imgur.com/Iv0Ti.jpg)

实现了并发，如相应的“深度优先”方法。

**测试用例 #7 - “广度优先”方法 - 默认流中的异步复制**

*- 代码 -*

```
#include "Utilities.cuh"
#include "InputOutput.cuh"

#define BLOCKSIZE 128

/*******************/
/* KERNEL FUNCTION */
/*******************/
template<class T>
__global__ void kernelFunction(T * __restrict__ d_data, const unsigned int NperGPU) {

    const int tid = threadIdx.x + blockIdx.x * blockDim.x;

    if (tid < NperGPU) for (int k = 0; k < 1000; k++) d_data[tid] = d_data[tid] * d_data[tid];

}

/******************/
/* PLAN STRUCTURE */
/******************/
// --- Async
template<class T>
struct plan {
    T               *d_data;
    T               *h_data;
};

/*********************/
/* SVD PLAN CREATION */
/*********************/
template<class T>
void createPlan(plan<T>& plan, unsigned int NperGPU, unsigned int gpuID) {

    // --- Device allocation
    gpuErrchk(cudaSetDevice(gpuID));
    gpuErrchk(cudaMalloc(&(plan.d_data), NperGPU * sizeof(T)));
    gpuErrchk(cudaMallocHost((void **)&plan.h_data, NperGPU * sizeof(T)));
}

/********/
/* MAIN */
/********/
int main() {

    const int numGPUs   = 4;
    const int NperGPU   = 500000;
    const int N         = NperGPU * numGPUs;

    plan<double> plan[numGPUs];
    for (int k = 0; k < numGPUs; k++) createPlan(plan[k], NperGPU, k);

    // --- "Breadth-first" approach - async
    for (int k = 0; k < numGPUs; k++) {
        gpuErrchk(cudaSetDevice(k));
        gpuErrchk(cudaMemcpyAsync(plan[k].d_data, plan[k].h_data, NperGPU * sizeof(double), cudaMemcpyHostToDevice));
    }

    for (int k = 0; k < numGPUs; k++) {
        gpuErrchk(cudaSetDevice(k));
        kernelFunction<<<iDivUp(NperGPU, BLOCKSIZE), BLOCKSIZE>>>(plan[k].d_data, NperGPU);
    }

    for (int k = 0; k < numGPUs; k++) {
        gpuErrchk(cudaSetDevice(k));
        gpuErrchk(cudaMemcpyAsync(plan[k].h_data, plan[k].d_data, NperGPU * sizeof(double), cudaMemcpyDeviceToHost));
    }

    gpuErrchk(cudaDeviceReset());
} 
```

*- 探查器时间表 -*

[![在此处输入图像描述](../Images/17ffb7332ec52fe5b5b94de9faeb55b5.png)](https://i.stack.imgur.com/zwAJ9.jpg)

实现了并发性，就像在相应的“深度优先”方法中一样。

**测试用例 #8 - “广度优先”方法 - 默认流和唯一宿主`cudaMallocHost`ed 向量中的异步复制**

*- 代码 -*

```
#include "Utilities.cuh"
#include "InputOutput.cuh"

#define BLOCKSIZE 128

/*******************/
/* KERNEL FUNCTION */
/*******************/
template<class T>
__global__ void kernelFunction(T * __restrict__ d_data, const unsigned int NperGPU) {

    const int tid = threadIdx.x + blockIdx.x * blockDim.x;

    if (tid < NperGPU) for (int k = 0; k < 1000; k++) d_data[tid] = d_data[tid] * d_data[tid];

}

/******************/
/* PLAN STRUCTURE */
/******************/
// --- Async
template<class T>
struct plan {
    T               *d_data;
};

/*********************/
/* SVD PLAN CREATION */
/*********************/
template<class T>
void createPlan(plan<T>& plan, unsigned int NperGPU, unsigned int gpuID) {

    // --- Device allocation
    gpuErrchk(cudaSetDevice(gpuID));
    gpuErrchk(cudaMalloc(&(plan.d_data), NperGPU * sizeof(T)));
}

/********/
/* MAIN */
/********/
int main() {

    const int numGPUs   = 4;
    const int NperGPU   = 500000;
    const int N         = NperGPU * numGPUs;

    plan<double> plan[numGPUs];
    for (int k = 0; k < numGPUs; k++) createPlan(plan[k], NperGPU, k);

    // --- "Breadth-first" approach - async
    double *inputMatrices;   gpuErrchk(cudaMallocHost(&inputMatrices, N * sizeof(double)));
    for (int k = 0; k < numGPUs; k++) {
        gpuErrchk(cudaSetDevice(k));
        gpuErrchk(cudaMemcpyAsync(plan[k].d_data, inputMatrices + k * NperGPU, NperGPU * sizeof(double), cudaMemcpyHostToDevice));
    }

    for (int k = 0; k < numGPUs; k++) {
        gpuErrchk(cudaSetDevice(k));
        kernelFunction<<<iDivUp(NperGPU, BLOCKSIZE), BLOCKSIZE>>>(plan[k].d_data, NperGPU);
    }

    for (int k = 0; k < numGPUs; k++) {
        gpuErrchk(cudaSetDevice(k));
        gpuErrchk(cudaMemcpyAsync(inputMatrices + k * NperGPU, plan[k].d_data, NperGPU * sizeof(double), cudaMemcpyDeviceToHost));
    }

    gpuErrchk(cudaDeviceReset());
} 
```

*- 探查器时间表 -*

[![在此处输入图像描述](../Images/7bf064ab81dd84b8f03b67ef4705c9d1.png)](https://i.stack.imgur.com/cc0Md.jpg)

实现了并发性，就像在相应的“深度优先”方法中一样。

**结论** *使用异步副本可以保证并发执行，无论是使用特意创建的流还是使用默认流。*

**注意** *在上述所有示例中，我已经注意提供足够的工作来完成 GPU，无论是在副本方面还是在计算任务方面。未能为集群提供足够的工作可能会阻止观察并发执行。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T16:28:32.973

您可能需要使用`cudaMemcpyAsync`. `cudaMemcpy`正在阻塞调用，因此它在完成之前不会将执行返回给您的代码，因此您的代码在完成当前程序的例程之前不会切换 GPU。

~~但是，内核调用是异步的（对于 CPU），因此您发布的代码可能会导致一些竞争条件（`cudaMemcpy` *可能*在内核完成之前开始执行）。~~ 正如@talonmies 在评论中指出的那样，由于`cudaMemcpy`/`cudaMemcpyAsync`与内核启动进入相同的流，因此一切都以正确的顺序执行。

我建议您使用 CUDA Streams；[这里](http://www.nvidia.com/docs/IO/116711/sc11-multi-gpu.pdf)简要介绍使用流的 MultiGPU 编程。在您的情况下它不是很有帮助，但在更复杂的应用程序中使用可能非常方便，例如，如果您需要在不同设备之间同步函数调用。

# mysql - MySQL假设基于多值插入和第一个ID的自动递增ID

> ID：11673157
> 
> 赞同：0
> 
> 时间：2012-07-26T15:49:36.920
> 
> 标签：mysql, lastinsertid

只是想被比我了解更多 MySQL 的人淘汰

我执行 MySQL 插入，我在一个查询中插入 10 行。然后，当您获得 MySQL 的最后一个插入 ID 时，它会为您提供第一个插入 ID 的 ID。

假设其他 ID 连续是 insert_id - insert_id+9 是否安全？还是有什么可能的方式不会变成这种情况？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:12:23.407

是的，有可能并非总是如此。

使用`innodb_autoinc_lock_mode = 2`，可以为单个 INSERT 语句插入的行分配不连续的 AUTO_INCREMENT 值（当并发 INSERT 语句正在运行时。）

[http://dev.mysql.com/doc/refman/5.1/en/innodb-auto-increment-handling.html](http://dev.mysql.com/doc/refman/5.1/en/innodb-auto-increment-handling.html)

# database - 具有 M:N 关系的数据的数据库实现

> ID：11673159
> 
> 赞同：0
> 
> 时间：2012-07-26T15:49:42.070
> 
> 标签：database, database-design, database-schema

我必须创建一个只有 2 个表学生和课程的数据库。它们之间没有关系，或者说最多1个关系是可以接受的。通常在其上运行的查询：-“获取学生注册的课程”。所以应该反应快。请告诉如何实现这样的数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:56:36.693

```
CREATE TABLE STUDENT 
(student_id INT PRIMARY KEY)

CREATE TABLE COURSE 
(course_id INT PRIMARY KEY)

CREATE TABLE COURSE_REGISTRATIONS 
(
student_id INT,
course_id INT,
) 
```

在`COURSE_REGISTRATIONS`中，`{student_id, course_id}`组合是主键，显然`student_id`和`course_id`是它们各自表的外键。

您可以查询`COURSE_REGISTRATIONS`您需要的信息。

# java - 我是否应该暂时避免使用 Java 7，因为它太新了？

> ID：11673163
> 
> 赞同：-1
> 
> 时间：2012-07-26T15:50:06.593
> 
> 标签：java, deployment

目前我的应用程序是为 1.6 编码的，但我想使用 Java 7 中的一些新功能（例如**`Files`**和**`NIO`**）。我应该避免使用这些功能，还是应该每个客户端都更新到 Java 7 才能运行它？假设大多数工作站仍在运行 1.5~1.6。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:52:39.547

使用的最佳版本取决于您。

在您知道将要运行它的机器可以安装 Java 7 之前，我不会开始开发 Java 7。

您可以现在升级，也可以很快升级，因为 Java 6 在今年 11 月 EOL [http://www.oracle.com/technetwork/java/eol-135779.html](http://www.oracle.com/technetwork/java/eol-135779.html)

或者您可能像许多仍在愉快地使用 Java 1.3 和 1.4 的人一样，因为它可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:52:17.823

这是一个相当主观的问题，但我会咬一口。这取决于你的客户是谁。它们是否足够灵活以进行升级？

*一般来说，你现在*想满足大多数人.. 1.6 可能有你需要的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:00:24.057

如果您可以“强制”您的用户升级，那么就去做，没有重大风险。事实上，使用 1.5 是有风险的，因为它没有公共（安全）更新，而且 1.6 也将在 11 月结束生命周期：

[http://www.oracle.com/technetwork/java/eol-135779.html](http://www.oracle.com/technetwork/java/eol-135779.html)

# php - 可点击链接的最佳 PHP 脚本

> ID：11673173
> 
> 赞同：1
> 
> 时间：2012-07-26T15:50:38.267
> 
> 标签：php, url

我发现许多 PHP 脚本可以将文本中的 url 转换为可点击的链接。但是它们中的大多数都不起作用，有些会产生大错误。其中一些转换已经可点击的链接。其他人不起作用，第三人从文本链接中制作部分。 **我需要一个脚本，它只检测链接，而不是文本，并且不会转换已经可以点击的链接，因为它非常丑陋**。

我发现这段代码似乎是我测试过的最好的。但它有一些错误。此代码转换可点击链接。像这样：

原来的：

```
<a href="http://www.netload.in/dateiySgPP2b14W/1409423417ExpFut.pdf.htm" target="_blank">http://www.netload.in/dateiySgPP2b14W/1409...7ExpFut.pdf.htm</a> 
```

转换：

```
http://www.netload.in/dateiySgPP2b14W/1409423417ExpFut.pdf.htm" target="_blank">http://www.netload.in/dateiySgPP2b14W/1409...7ExpFut.pdf.htm 
```

这是代码：

```
function parse_urls($text, $maxurl_len = 35, $target = '_self') // Make URLs Clickable
{
    if (preg_match_all('/((ht|f)tps?:\/\/([\w\.]+\.)?[\w-]+(\.[a-zA-Z]{2,4})?[^\s\r\n\(\)"\'<>\,\!]+)/si', $text, $urls))
    {
        $offset1 = ceil(0.65 * $maxurl_len) - 2;

        $offset2 = ceil(0.30 * $maxurl_len) - 1;

        foreach (array_unique($urls[1]) AS $url)
        {
            if ($maxurl_len AND strlen($url) > $maxurl_len)
            {
                $urltext = substr($url, 0, $offset1) . '...' . substr($url, -$offset2);
            }
            else
            {
                $urltext = $url;
            }

            $text = str_replace($url, '<a href="'. $url .'" target="'. $target .'" title="'. $url .'">'. $urltext .'</a>', $text);
        }
    }

    return $text;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:48:31.187

I just threw this together.

```
<?php
function replaceUrlsWithLinks($text){
    $dom = new DOMDocument;
    $dom->loadXML($text);
    $xpath = new DOMXpath($dom);
    $query = $xpath->query('//text()[not(ancestor-or-self::a)]');
    foreach($query as $item){
        $content = $item->textContent;
        if(preg_match_all('/((ht|f)tps?:\/\/([\w\.]+\.)?[\w-]+(\.[a-zA-Z]{2,4})?[^\s\r\n\(\)"\'<>\,\!]+)/si',$content,$matches,PREG_SET_ORDER | PREG_OFFSET_CAPTURE)){
            foreach($matches as $match){
                $newA = $dom->createElement('a',$match[0][0]);
                $newA->setAttribute('href',$match[0][0]);
                $newA->setAttribute('target','_blank');
                $a = $item->splitText($match[0][1]);
                $b = $a->splitText(strlen($match[0][0]));
                $a->parentNode->replaceChild($newA,$a);
            }
        }
    }
    return $dom->saveHtml();
}
// The HTML to process ...
$html = <<<HTML
<block>
<a href="http://google.com">http://google.com</a>
<b>Stuff http://google.com</b>
asdf http://google.com ffaa 
</block>
HTML;
// Process the HTML and echo it out.
echo replaceUrlsWithLinks($html);
?> 
```

The output would be:

```
<block>
<a href="http://google.com">http://google.com</a>
<b>Stuff <a href="http://google.com" target="_blank">http://google.com</a></b>
asdf <a href="http://google.com" target="_blank">http://google.com</a> ffaa 
</block> 
```

You shouldn't use regular expressions to manipulate HTML.

Hope this helps.

Kyle

-- Edit --

The previous code is more efficient, but if you plan to have two URLs in the same parent node, the code will break because the DOM tree is changed. To fix this, you can use this more intensive code:

```
<?php
function replaceUrlsWithLinks($text){
    $dom = new DOMDocument;
    $dom->loadXML($text);
    $xpath = new DOMXpath($dom);
    while(true){
        $shouldBreak = false;
        $query = $xpath->query('//text()[not(ancestor-or-self::a)]');
        foreach($query as $item){
            $shouldBreak = false;
            $content = $item->textContent;
            if(preg_match_all('/((ht|f)tps?:\/\/([\w\.]+\.)?[\w-]+(\.[a-zA-Z]{2,4})?[^\s\r\n\(\)"\'<>\,\!]+)/si',$content,$matches,PREG_SET_ORDER | PREG_OFFSET_CAPTURE)){
                foreach($matches as $match){
                    $newA = $dom->createElement('a',$match[0][0]);
                    $newA->setAttribute('href',$match[0][0]);
                    $newA->setAttribute('target','_blank');
                    $a = $item->splitText($match[0][1]);
                    $b = $a->splitText(strlen($match[0][0]));
                    $a->parentNode->replaceChild($newA,$a);
                    $shouldBreak = true;
                    break;
                }
            }
            if($shouldBreak == true)break;
        }
        if($shouldBreak == true){
            continue;
        }
        else {
            break;
        }
    }
    return $dom->saveHtml();
}

$html = <<<HTML
<block>
<a href="http://google.com">http://google.com</a>
<b>Stuff http://google.com</b>
asdf http://google.com ffaa  http://google.com
</block>
HTML;

echo replaceUrlsWithLinks($html);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:35:43.293

this function wraps text like `http://www.domain.com` in an anchor tag. What I see here is that you are trying to convert an anchor tag to an anchor tag, which of course won't work. So: don't write the anchors in your text, and let the script create them for you.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:45:52.893

You're running into the [usual problems](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454) that happen when you try to parse HTML with regexes. You need a proper HTML parser. Have a look at [this thread](https://stackoverflow.com/questions/292926/robust-mature-html-parser-for-php).

# php - QMultiHash php，相同的键，多个值

> ID：11673179
> 
> 赞同：0
> 
> 时间：2012-07-26T15:50:50.007
> 
> 标签：php, qt, hash

我尝试将一些代码从 C++/Qt 转换为 php。原始代码有一些像这样的哈希：

``QMultiHash<int, QString> Var;``

这意味着可以有许多值与同一个键相关联，同时，例如：

0 =>“零”

0 => "0"

0 =>“等等”

如何在php中完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:02:40.473

```
<?php
$multiHash = array(0 => array("Zero", "0", "etc."));
?>

//c++
bool    contains ( const Key & key, const T & value ) const
//php
bool    in_array ( $value, $multiHash[$key] )

//c++
bool    contains ( const Key & key ) const
//php
bool    array_key_exists ( $key, $multiHash )

//c++
QHash<Key, T>::iterator insert ( const Key & key, const T & value )
//php
void    $multiHash[$key][] = $value
int     array_push ( $multiHash[$key], $value ) 
```

ETC..

# synchronization - Akka onReceive 方法是否同时执行？

> ID：11673183
> 
> 赞同：6
> 
> 时间：2012-07-26T15:50:57.747
> 
> 标签：synchronization, actor, akka

这是我的场景：

我有一个主actor，它接收来自多个子actor的消息。这些消息包含要聚合的数据。在这个聚合逻辑中，如果我使用共享数据结构来收集聚合，我是否需要处理同步问题？

```
else if(arg0 instanceof ReducedMsg){

                           ReducedMsg reduced = (ReducedMsg)arg0;
        counter.decrementAndGet();

        synchronized(finalResult){

            finalResult.add((KeyValue<K, V>) reduced.getReduced());

            if(counter.get() == 0){
                                    if(checkAndReduce(finalResult)){

                    finalResult.clear();
                }
                else{
                    stop();
                    latch.countDown();
                }

            }

        }

    } 
```

如您所见，我有一个 finalResult，每条消息都将汇总到该结果中，并且在处理逻辑之后，还需要清除集合。

实际上我正在尝试实现的是递归（关联）减少mapreduce。所以我需要保持我假设的同步块？或者 Akka 是否有机会一次执行 onReceive 一个线程？

这种逻辑在小数据集上产生准确和可预测的结果。我的问题是当我的输入数据集有点大时，代码会挂起。我想确定这是因为我的同步块的上下文切换，所以我可能会深入到不同的设计中。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-26T16:04:41.967

`onReceive()`永远**不会**同时调用。这是 Akka 给你的最根本的保证。

这意味着，如果您的`counter`变量是演员中的一个字段，并且没有其他代码可以直接访问该字段，您可以安全地使用普通`int`/`long`代替`AtomicInteger`/ `AtomicLong`。假设同步`finalResult`是一个封装并隐藏在参与者中的字段，则不需要同步。

最后的用法`CountDownLatch`是可疑的。在 Akka 应用程序中，您不应该使用任何同步原语。Actor 本质上是单线程的，所有的通信（包括唤醒和传递数据）都应该通过消息传递来实现。

这在文档中都有解释：http: [//doc.akka.io/docs/akka/2.0.2/general/jmm.html#Actors_and_the_Java_Memory_Model](http://doc.akka.io/docs/akka/2.0.2/general/jmm.html#Actors_and_the_Java_Memory_Model)

# django - Django get_model() 导致错误：无法导入名称设置

> ID：11673185
> 
> 赞同：0
> 
> 时间：2012-07-26T15:51:02.387
> 
> 标签：django, import, settings, importerror

**更新：**

我试过修改`from actstream import settings as actstream_settings`它`import actstream.settings as actstream_settings`，它告诉我：

```
AttributeError: 'module' object has no attribute 'settings' 
```

应用程序中的`__init__.py`文件`actstream`不是空的，这可能是它无法导入`actstream/settings.py`的原因`actstream.settings`吗？

**原始问题：**

我有一个工作 django 项目。我从主干安装了以下应用程序`actstream`，因为最新版本有错误：[https ://github.com/justquick/django-activity-stream](https://github.com/justquick/django-activity-stream)

当将此应用程序加载到我的项目中时，它会引发以下异常：

```
Error: cannot import name settings 
```

我已验证错误发生在 的第一个命令`get_model()`中`actstream/settings.py`，如下所示：

```
from django.conf import settings
from django.db.models import get_model
import sys

MODELS = {}
for model in getattr(settings, 'ACTSTREAM_ACTION_MODELS', ('auth.User',)):
    MODELS[model.lower()] = model = get_model(*model.split('.'))

MANAGER_MODULE = getattr(settings, 'ACTSTREAM_MANAGER',
    'actstream.managers.ActionManager')
a, j = MANAGER_MODULE.split('.'), lambda l: '.'.join(l)
MANAGER_MODULE = getattr(__import__(j(a[:-1]), {}, {}, [a[-1]]), a[-1])

USE_JSONFIELD = getattr(settings, 'ACTSTREAM_USE_JSONFIELD', False) 
```

为什么会在这种情况下`get_model()`抛出关于无法加载的错误`settings`？

**追溯：**

```
Traceback (most recent call last):
  File ".../actstream/settings.py", line 7, in <module>
    MODELS[model.lower()] = model = get_model(*model.split('.'))
  File ".../lib/python2.7/site-packages/django/db/models/loading.py", line 213, in get_model
    self._populate()
  File ".../lib/python2.7/site-packages/django/db/models/loading.py", line 67, in _populate
    self.load_app(app_name)
  File ".../lib/python2.7/site-packages/django/db/models/loading.py", line 88, in load_app
    models = import_module('.models', app_name)
  File ".../lib/python2.7/site-packages/django/utils/importlib.py", line 35, in import_module
    __import__(name)
  File ".../libs/actstream/models.py", line 12, in <module>
    from actstream import managers, settings as actstream_settings
ImportError: cannot import name settings 
```

我现在注意到models.py 中发生了导入错误，但我仍然看不到它如何无法将settings.py 文件作为actstream.settings 导入。

# php - 在单独的目录中使用 PHP 创建 ZIP 存档

> ID：11673191
> 
> 赞同：1
> 
> 时间：2012-07-26T15:51:12.800
> 
> 标签：php, directory, zip, wordpress, wamp

我有一个 wordpress 网站，我正在为我工​​作的公司创建一个 HR 插件。其中一项功能允许管理员下载包含多个文档的 zip 文件。我已经测试了以下代码，它工作正常，但我希望在我选择的目录中创建 ZIP 存档。

```
function direct_download()
{
    if ($_REQUEST['action'] == 'download')
    {
        $App = new DHR_Application();
        $file_name=str_replace(" ","_",$App->Fname)."_".str_replace(" ","_",$App->Lname)."_".$App->ID;
        $txt_name=$file_name.".txt";
        $txt_path="../user-upload/temp/".$file_name.".txt";
        $arc_name=$file_name.".zip";

        $txt=$App->Fname." ".$App->Lname."\r\n".$App->ID;
        $file=fopen($txt_path,"w+");
        fwrite($file,$txt);

        $zip = new ZipArchive();

        if ($zip->open($arc_name, ZIPARCHIVE::CREATE )!==TRUE)
        {
            exit("cannot open <$arc_name>\n");
        }
        $nameAtt1 = pathinfo($App->Att1,PATHINFO_BASENAME);
        $zip->addFile($App->Att1,$nameAtt1);
        if (($App->Att2 != '') && ($App->Att2 != null))
        {
            $nameAtt2 = pathinfo($App->Att2,PATHINFO_BASENAME);
            $zip->addFile($App->Att2,$nameAtt2);
        }

        $zip->addFile($txt_name,$txt_path);
        $zip->close();
        fclose($file);

        header("Content-type: application/zip");
        header("Content-Disposition: attachment; filename=$arc_name");
        header("Pragma: no-cache");
        header("Expire: 0");
        readfile("$arc_name");
        exit();
    }
} 
```

通常，ZIP 存档在 /wp-admin/ 目录中创建。我不希望在此目录中创建和删除临时文件，因为它运行 wordpress 的后端。

`$arc_name`当我在代码中断中包含文件的路径时。我查看了 $zip->filename 值，它会将值从“C:/wamp/www/company/user-upload/temp/Tony_Beroni_000001.zip”更改为“C:\wamp\www\company\user-上传\\temp\Tony_Beroni_000001.zip”。我认为这可能是一个问题，因为 WAMP 和本机 Apache 服务器之间存在差异（不是双关语）。

有谁知道如何在特定目录中使用 PHP 创建 ZIP 存档？

**编辑：**我注意到我的参数`$zip->addFile($txt_name,$txt_path);`应该是相反的`$zip->addFile($txt_path, $txt_name);`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:55:53.883

如果您正在做跨平台开发（即 Windows 和 Linux）。您应该始终使用 PHP DIRECTORY_SEPARATOR 常量指定路径，例如：

```
$full_file_path = DIRECTORY_SEPARATOR . 'path' . DIRECTORY_SEPARATOR . 'to'. DIRECTORY_SEPARATOR . 'file' . DIRECTORY_SEPARATOR . $file_name; 
```

您可以随意定义路径，只要正在运行的网络服务器有权写入该路径即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:01:10.757

$arc_name 是您定义 zip 路径的地方，它的第一个参数是 zip open。

# c++ - 多个文件中的 C++ 变量范围

> ID：11673194
> 
> 赞同：1
> 
> 时间：2012-07-26T15:51:24.627
> 
> 标签：c++, scope

如何使特定文件中的变量/函数可见？例如，假设我有这个文件层次结构：

啊

```
extern int var; 
```

a.cpp

```
#include "a.h"

int var; 
```

bh

```
#include "a.h"

void function(); 
```

b.cpp

```
#include "b.h"

void function() {
    var = 0;
} 
```

在 main.cpp 我希望能够调用`function()`，但不能访问`var`变量

```
#include "b.h"

int main(int argc, char** argv) {
    function(); /* possible to call */
    var = 0 /* var shouldn't be visible */
} 
```

我不希望文件 ah 包含在 main.cpp 中 - 只有 bh 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T15:53:04.880

ah 不需要包含在 bh 中，只需要包含在 b.cpp 中。这是因为`var`只有函数定义需要，而不是它的声明。这与在其他标题中不包含标题的规则相一致，除非您绝对必须这样做。

bh

```
void function(); 
```

b.cpp

```
#include "b.h"
#include "a.h"

void function() {
    var = 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T15:53:52.390

我认为您需要停止尝试使用文件的可见性来隐藏信息，并开始查看 C++ 类，这些类允许您“隐藏”“方法”通过私有成员使用的东西：

```
class A
{
private:
    int var;

public:
    void function()
    {
        var = 0;
    };
}; 
```

# vba - 强制替换宏如何也适用于标题

> ID：11673195
> 
> 赞同：5
> 
> 时间：2012-07-26T15:51:26.567
> 
> 标签：vba, replace, ms-word

我想查找和替换 word 文档中的文本。我创建了一个宏，如下所示。

```
Sub Macro1()
  ActiveDocument.Content.Find.Execute FindText:="#Text1", ReplaceWith:="acca", _
     Replace:=wdReplaceAll   
End Sub 
```

它取代了所有发生但不在页眉/页脚中！如何被迫处理整个文档，包括页眉/正文/页脚？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-26T18:18:25.637

我一直使用这个 VBA 代码来查找/替换，它会与文档正文一起执行页眉/页脚：

```
 Dim myStoryRange As Range

        For Each myStoryRange In ActiveDocument.StoryRanges
        With myStoryRange.Find
            .Text = "Text to find to replace goes here"
            .Replacement.Text = "And the replacement text goes here"
            .Wrap = wdFindContinue
            .Execute Replace:=wdReplaceAll
        End With
        Do While Not (myStoryRange.NextStoryRange Is Nothing)
            Set myStoryRange = myStoryRange.NextStoryRange
            With myStoryRange.Find
                .Text = "Text to find to replace goes here"
                .Replacement.Text = "And the replacement text goes here"
                .Wrap = wdFindContinue
                .Execute Replace:=wdReplaceAll
            End With
        Loop
    Next myStoryRange 
```

也可以在同一个Sub中多次复制粘贴，同时替换不同的字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T18:09:32.857

应该有更好的方法，但我找不到：

```
Sub ReplaceHeaderFooterandBody(findString As String, replaceString As String)
ActiveDocument.Windows(1).View.SeekView = wdSeekPrimaryHeader
With Selection.Find
        .Text = findString
        .Replacement.Text = replaceString
        .Forward = True
        .Wrap = wdFindContinue
        .Format = False
        .MatchCase = False
        .MatchWholeWord = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
End With
Selection.Find.Execute Replace:=wdReplaceAll
ActiveDocument.Windows(1).View.SeekView = wdSeekPrimaryFooter
With Selection.Find
        .Text = findString
        .Replacement.Text = replaceString
        .Forward = True
        .Wrap = wdFindContinue
        .Format = False
        .MatchCase = False
        .MatchWholeWord = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
End With
Selection.Find.Execute Replace:=wdReplaceAll
ActiveDocument.Windows(1).View.SeekView = wdSeekMainDocument
With Selection.Find
        .Text = findString
        .Replacement.Text = replaceString
        .Forward = True
        .Wrap = wdFindContinue
        .Format = False
        .MatchCase = False
        .MatchWholeWord = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
End With
Selection.Find.Execute Replace:=wdReplaceAll
End Sub 
```

似乎 Word 拒绝搜索某个区域，除非它是您当前的视图（我认为这很荒谬）。您甚至无法通过 UI 一次搜索整个文档，包括页眉和页脚。[这是](http://social.msdn.microsoft.com/Forums/en-us/isvvba/thread/b5cc0421-8482-4cee-b70a-b84c4958f9db)另一个站点上的一个问题，似乎得到了相同的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:06:55.997

我看不到任何“强制”“查找和替换”对话框包含页眉和页脚文本的方法。我在更改标题文本时录制了一个宏并得到了以下代码：

```
Sub Macro1()
'
' Macro1 Macro
' Macro recorded 7/26/2012 by Jimmy Peña
'
  If ActiveWindow.View.SplitSpecial <> wdPaneNone Then
    ActiveWindow.Panes(2).Close
  End If
  If ActiveWindow.ActivePane.View.Type = wdNormalView Or ActiveWindow. _
    ActivePane.View.Type = wdOutlineView Then
    ActiveWindow.ActivePane.View.Type = wdPrintView
  End If
  ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader
  Selection.MoveRight Unit:=wdCharacter, Count:=1
  Selection.Delete Unit:=wdCharacter, Count:=1
  Selection.TypeText Text:="d"
End Sub 
```

我去了查看»页眉/页脚，删除了一个字符并输入了一个新字符。

您可能需要做的是在 VBA 中查找和替换：

*   将标头的内容读入 String 变量
*   解析字符串变量，必要时替换文本，然后
*   将 String 变量的内容写回头部

重复页脚。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-15T21:20:36.427

[我在这里](http://word.mvps.org/faqs/customization/ReplaceAnywhere.htm)找到了正确的代码它甚至会在页脚/页眉的文本框中进行文本替换。

```
 Sub FindReplaceAnywhere(ByVal pFindTxt As String, ByVal pReplaceTxt As String)
  Dim rngStory As Word.Range
  Dim lngJunk As Long
  Dim oShp As Shape
TryAgain:
  'Fix the skipped blank Header/Footer problem
  lngJunk = ActiveDocument.Sections(1).Headers(1).Range.StoryType
  'Iterate through all story types in the current document
  For Each rngStory In ActiveDocument.StoryRanges
    'Iterate through all linked stories
    Do
      SearchAndReplaceInStory rngStory, pFindTxt, pReplaceTxt
      On Error Resume Next
      Select Case rngStory.StoryType
      Case 6, 7, 8, 9, 10, 11
        If rngStory.ShapeRange.Count > 0 Then
          For Each oShp In rngStory.ShapeRange
            If oShp.TextFrame.HasText Then
              SearchAndReplaceInStory oShp.TextFrame.TextRange, _
                  pFindTxt, pReplaceTxt
            End If
          Next
        End If
      Case Else
        'Do Nothing
      End Select
      On Error GoTo 0
      'Get next linked story (if any)
      Set rngStory = rngStory.NextStoryRange
    Loop Until rngStory Is Nothing
  Next
End Sub
Sub SearchAndReplaceInStory(ByVal rngStory As Word.Range, _
    ByVal strSearch As String, ByVal strReplace As String)
  With rngStory.Find
    .ClearFormatting
    .Replacement.ClearFormatting
    .Text = strSearch
    .Replacement.Text = strReplace
    .Wrap = wdFindContinue
    .Execute Replace:=wdReplaceAll
  End With
End Sub 
```

# php - 收到超过 1 周未发帖的人的电子邮件

> ID：11673198
> 
> 赞同：0
> 
> 时间：2012-07-26T15:51:36.520
> 
> 标签：php, mysql

我有以下问题。

人们在网站上发布任务。

人们发布的所有任务都进入任务表，结构如下：

```
id
user_id
date_posted 
```

并且有一个带有下表的用户表

```
id
first_name
email 
```

我需要获取超过一周未发布任务的人的电子邮件吗？我怎样才能做到这一点？我尝试了以下方法：

```
SELECT distinct u.id, u.email FROM user as u WHERE id IN (SELECT user_id FROM task WHERE paid = 1 AND DATE_ADD(CURDATE(), INTERVAL -7 DAY) <= `date_posted` AND `date_posted` < DATE_ADD(CURDATE(), INTERVAL -6 DAY)) AND role = 0 
```

但我认为这不是正确的方法。我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:03:05.530

试试这个查询

```
SELECT u.id, u.email 
FROM user as u WHERE id NOT IN ( /* select users who posted */
  SELECT distinct user_id FROM task 
  WHERE paid = 1 AND DATE_SUB(CURDATE(), INTERVAL 7 DAY) <= `date_posted` 
) AND role = 0; 
```

未经测试，但你明白了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-26T15:30:46.030

尝试这个

```
SELECT DISTINCT u.id, u.email
FROM (
        SELECT t.user_id AS user_id
        FROM task t
        WHERE DATE(t.date_posted) > DATE_SUB(CURDATE(), INTERVAL 7 DAY)
    ) AS t
RIGHT JOIN USER u ON u.id = t.user_id
WHERE t.user_id IS NULL 
```

# php - 关于 PHP 中的“包含”函数

> ID：11673204
> 
> 赞同：0
> 
> 时间：2012-07-26T15:52:00.130
> 
> 标签：php

我在 script_client 的子目录中有一个 php 文件，例如 file2.php，在文件头中我包含“../../include/connection.php”。在我的本地主机上它工作正常。但是当我把它放在服务器上时，它总是显示“无法打开流：没有这样的文件或目录”，我不明白为什么。谁能帮我？

*   目录1
    *   包括
        *   连接.php
        *   文件1.php
    *   脚本
        *   脚本客户端
            *   文件2.php

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:40:35.550

也许您的包含路径未设置为您期望的目录。尝试使用 get_include_path()。如果是这种情况，您可以通过调用 set_include_path 来设置路径。

有关详细信息，请参阅 php.net 文档。

[http://php.net/manual/en/function.get-include-path.php](http://php.net/manual/en/function.get-include-path.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:55:06.447

检查您的许可，或者从服务器根目录执行

```
include $_SERVER['DOCUMENT_ROOT'].'/include/connection.php' 
```

# matlab - 从不同平台的命令行获取用户名

> ID：11673205
> 
> 赞同：6
> 
> 时间：2012-07-26T15:52:03.983
> 
> 标签：matlab, platform-independent

MATLAB 中有没有办法获取启动会话的用户的用户名？

我对**Windows**、**Linux**和**Mac OSX**的解决方案感兴趣。我想如果解决方案是特定于平台的，那么两种解决方案都可以按如下方式集成：

```
if ispc
    user_name = % method 1
elseif isunix
    user_name = % method 2
elseif ismac
    user_name = % method 3
end 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-26T16:31:26.367

使用 Java 怎么样（适用于 MATLAB 支持的所有平台）：

```
user_name = java.lang.System.getProperty('user.name') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T16:07:39.813

```
if isunix
    [~, user_name] = system('whoami') % exists on every unix that I know of
    % on my mac, isunix == 1
elseif ispc
    [~, user_name] = system('echo %USERDOMAIN%\%USERNAME%') % Not as familiar with windows,
                            % found it on the net elsewhere, you might want to verify
end 
```

希望有帮助！您可能还想加入一个`else I'm confused`子句，以防万一您发现该系统既不是 unix 也不是 pc。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-23T20:30:56.880

在 Windows 上获取它：

`getenv('USERNAME')`

# php - Jquery .change() 事件问题

> ID：11673211
> 
> 赞同：0
> 
> 时间：2012-07-26T15:52:18.837
> 
> 标签：php, jquery, events, checkbox

我在执行 ajax 调用后构造了 2 个复选框。当我尝试引用他们的 ID 来执行 .change() 事件时，该事件不会触发。有任何想法吗？这是我的代码：

阿贾克斯调用：

```
 $.ajax({                        
    url:"../includes/MC.Admin.ajax.php",
    type: "POST",
    data: empupdatedata,
    success: function(empupdate) {              
    var empupdateJson = $.parseJSON(empupdate);

                  $("#empupdateinfo_tbl").html(empupdateJson.updateempinfo);

                $("#empemploymentupdateinfo_tbl").html(empupdateJson.updateempemploymentinfo);

                $('#employee-update').bPopup({
                    modalClose: false
                });

                }
        }); 
```

这是构造文本框的地方：

```
if($rm5->isbonus == 1 && $rm5->isallowance == 0)
{
    $updateemployeeemploymentinfo .= "<tr><td class = 'tbl_data'>
    Additional Payment</td><td>Bonus <input type = 'checkbox' 
    name = 'isbonus' id = 'uisbonus'> Allowance <input type = 'checkbox' 
    name = 'isallowanece' id = 'uisallowance'></td></tr><tr></tr>"; 
} 
```

我想使用这两个复选框的 id 来触发使用以下代码的更改事件：

```
$("#uisbonus").change(function(){
    if($(this).attr("checked"))
    {
        $('#uamountcon').append("<td id = 'uamountcon'><input type = 'text' id = 'uamount ></td>")

    }
    else
    {
         $('#uamountcon').html();
    }
});

$("#uisallowance").change(function(){
    if($(this).attr("checked"))
    {
        $('#uamountcon').append("<td id = 'uamountcon'><input type = 'text' id = 'uamount ></td>")
    }
    else
    {
         $('#uamountcon').html();
    }
});//I placed this code insidethe $(document).ready(function() { }); 
```

更改事件的位置是否错误？我应该把事件放在哪里？或者是什么问题？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:00:59.750

由于您是在页面加载后添加它们，因此您必须使用[`on()`](http://api.jquery.com/on)or[`delegate()`](http://api.jquery.com/delegate/)进行事件委托。 `on()`是在 1.7 中添加的，但是，对于以前的版本`delegate()`是使用事件委托的最有效方法。

```
$("body").delegate("#uisbonus", "change", function(){ 
...
$("body").delegate("#uisallowance", "change", function(){ 
```

引用 a`class`而不是a 可能会更好`id`：

```
$("body").delegate(".uiClassName", "change", function(){ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:00:28.463

事件委托将是最简单的解决方法，

```
$(document).delegate("#uisbonus","change",function(){
    if($(this).attr("checked"))
    {
        $('#uamountcon').append("<td id = 'uamountcon'><input type = 'text' id = 'uamount ></td>")

    }
    else
    {
         $('#uamountcon').html();
    }
});

$(document).delegate("#uisallowance","change",function(){
    if($(this).attr("checked"))
    {
        $('#uamountcon').append("<td id = 'uamountcon'><input type = 'text' id = 'uamount ></td>")
    }
    else
    {
         $('#uamountcon').html();
    }
}); 
```

# spring - 如何使用 Spring JPA 进行分页 QueryDSL 查询？

> ID：11673213
> 
> 赞同：7
> 
> 时间：2012-07-26T15:52:21.660
> 
> 标签：spring, spring-data-jpa, querydsl

QueryDSL 定义了一个接口和一个实例，可以通过调用或`OrderSpecifier`轻松获得任何字段的接口和实例。Spring Data JPA的接口甚至还有一个以s 为参数的方法。`asc()``desc()``QueryDslPredicateExecutor``findAll()``OrderSpecifier`

`org.springframework.data.domain.PageRequest`然而，对 QueryDSL 一无所知，它有自己的方式来定义查询排序顺序，即`org.springframework.data.domain.Sort`. 它可以包含许多与`org.springframework.data.domain.Sort.Order`s 非常相似`OrderSpecifier`的 s，只是它们不是类型安全的等。

那么，如果我想进行使用排序的分页查询，真的没有办法使用 QueryDSL 来定义它吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-04-23T15:58:08.163

我知道已经有一段时间了，我不确定这在 OP 时是否可用，但现在引入了一个[QPageRequest](http://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/querydsl/QPageRequest.html)对象，它允许通过 QueryDSL 进行排序以添加到 spring data jpa Query DSL ...

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-04-15T17:24:02.843

`Sort`这是使用 QueryDSL构造对象的一种更简单的方法：

```
new QSort(user.manager.firstname.asc()) 
```

然后你可以`PageRequest`像这样使用它：

```
new PageRequest(0, 10, new QSort(user.manager.firstname.asc())) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-27T14:57:43.067

如果您找不到其他方法，它应该像这样工作

```
private Sort sortBy(Path<?> path) {
    return new Sort(Sort.Direction.ASC, path.getMetadata().getExpression().toString());
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-13T14:21:55.000

该`getExpression()`方法已被删除，并且我有类似于`QPost.post.period.periCode`需要遍历的表达式*，*并且没有表达式的完整名称我对此无能为力，所以现在我制作了一个`period.periCode`可以在`QPost.post`.

```
private String resolveOrderPath(Path<?> path) {
    StringBuilder stringBuffer = new StringBuilder(path.getMetadata().getName());
    path = path.getMetadata().getParent();
    while(!path.getMetadata().isRoot()) {
        stringBuffer.insert(0, path.getMetadata().getName() + ".");
        path = path.getMetadata().getParent();
    }
    return stringBuffer.toString();
}

Path<?> path = QPost.post.period.periCode;
String propertyPath = resolveOrderPath(path);
Sort sort = new Sort("asc".equals(sSortDir0) ? Sort.Direction.ASC : Sort.Direction.DESC, propertyPath); 
```

# ruby - 我得到一个“无方法错误”，使用每个来读取一个矩阵

> ID：11673214
> 
> 赞同：0
> 
> 时间：2012-07-26T15:52:23.087
> 
> 标签：ruby, matrix, each

在一个尝试使用“each”的非常简单的程序中，我得到了错误：sum.rb:16: undefined method `each' for # (NoMethodError)

我使用“每个”各种方式得到了同样的错误：下面显示的一个是直接从 ruby​​-doc.org 的 Class:Matrix 复制的。

```
# create State database using matrix
require 'matrix'

State=Matrix[ [3,1,4,4,6,2,8,12,6,2],
        [6,2,4,13,25,21,11,22,9,3,],
        [6,20,27,34,22,14,12,11,2,5],
        [6,28,17,23,31,18,15,9,18,12],
        [9,18,11,13,8,27,10,14,24,11],
        [3,9,7,16,9,15,28,24,29,21],
        [5,8,4,7,17,14,19,30,33,4],
        [7,17,23,9,5,9,22,21,12,21,],
        [7,14,25,22,16,10,19,15,12,11],
        [5,16,7,3,6,3,9,8,1,5] ]

State.each { |e| puts e } 
```

这一定很简单/很明显，但我想不通。（我已经用状态矩阵做了很多事情，结果如预期。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T17:19:52.080

Ruby 1.8.7 将返回您看到的问题。1.8.7 中的 Matrix 对象没有`each`方法。

升级到最近的版本，无论是 1.9.2 还是 1.9.3 都可以解决这个问题。

# php - sql NOT LIKE 的语法问题

> ID：11673215
> 
> 赞同：1
> 
> 时间：2012-07-26T15:52:25.250
> 
> 标签：php, sql

我被卡住并收到以下字符串错误任何想法请我试图阻止管理员（用户）显示在结果中。

```
SELECT * NOT LIKE 'admin' FROM users order by status ASC 
```

我也尝试过 %admin% ，但我遇到了错误！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T15:53:51.417

```
SELECT *  FROM users WHERE user NOT LIKE 'admin' ORDER BY status ASC; 
```

将 where 子句放在表名之后

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T15:54:03.810

你的语法是错误的，你想尝试这样的事情：

```
SELECT * FROM users WHERE username NOT LIKE '%admin%' ORDER BY status ASC 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T18:28:05.473

`NOT LIKE`如果您正在与一个简单的字符串进行比较，则不需要。此外，正如其他人的回答中所述，您的语法顺序混淆了：

```
SELECT * FROM users WHERE username != 'admin' ORDER BY status ASC 
```

干杯

# multithreading - SQL Server如何读取记录，然后在不存在的情况下写入而不创建重复项

> ID：11673216
> 
> 赞同：0
> 
> 时间：2012-07-26T15:52:30.773
> 
> 标签：multithreading, tsql, sql-server-2005, jdbc

如果表中还没有记录，那么将记录插入到表中的更好技术是什么？

问题是代码检查具有条件的记录是否存在，如果不存在，它会创建一个。但是，第二个线程可能会同时出现并检查。

我们开始尝试 TABLOCKX，它最初有效，虽然感觉有点像使用大象枪，但我们也在考虑使用快照隔离，它在这种情况下不起作用，第二个事务可以出现并读取桌子。

这是一个常见的问题，所以似乎应该有一个更标准的解决方案。请注意，此处不适合使用唯一索引，因为正在搜索的字段可能包含空值，并且 SQL Server 2005 不支持该上下文中的唯一约束。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T21:46:44.037

我在原始问题中没有看到任何关于更新表格的内容，所以也许你只想要类似的东西：

```
INSERT mytable (c1, c2, c3)
SELECT v1, v2, v3
WHERE NOT EXISTS (SELECT 1 FROM mytable WITH (UPDLOCK) WHERE c1=v1 AND c2=v2 AND c3=v3) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:01:59.427

在 SQL 2008 内部，我建议使用 Merge；但是，您标记了 2005。因此，对于 MS SQL 2005，您最好的选择是使用事务：

我会使用这样的东西：

```
begin tran
   update table with (x) set ...
   where key = @key

   if @@rowcount = 0
   begin
          insert table (key, ...) values (@key,..)
   end
commit tran 
```

# php - 如何使用 PHP/mySQL 查询一个表中存在的条目而不是另一个表中的条目？

> ID：11673220
> 
> 赞同：0
> 
> 时间：2012-07-26T15:52:33.737
> 
> 标签：php, mysql, join

我只想查询 table2 中包含“课程”值的条目，并且 table1 中不存在“课程”。我最初根据“课程”值将 table1 内部连接到 table2。这是我到目前为止所拥有的，但它不起作用：

```
 $query = "SELECT value1,value2,value3 FROM table2 INNER JOIN table1 USING(course)
            WHERE table2.sem = '$semester' AND NOT EXISTS (SELECT course FROM table1)
            ORDER BY course";
    $result = mysql_query($query2) or die(mysql_error());

    while ($row2 = mysql_fetch_array($result))
    {
        print_r($row);echo "<br><br>";
    } 
```

此内部连接代码有效：

```
 $query = "SELECT * FROM table1 INNER JOIN table2 USING(course) 
            WHERE table1.sem = '$semester'
            ORDER BY course";
    $result = mysql_query($query) or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:55:30.217

```
$query = "SELECT value1,value2,value3 FROM table2 
            WHERE table2.sem = '$semester' AND course IS NOT NULL
            AND course NOT IN(SELECT course FROM table1)
            ORDER BY course"; 
```

编辑：如果您想深入解释为什么要走这条路线而不是左连接（这也可以），请查看这篇文章：

[http://explainextended.com/2009/09/15/not-in-vs-not-exists-vs-left-join-is-null-sql-server/](http://explainextended.com/2009/09/15/not-in-vs-not-exists-vs-left-join-is-null-sql-server/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T16:00:57.923

```
SELECT value1,value2,value3 
FROM table2 t2
LEFT JOIN table1 t1 ON t2.course = t1.course
WHERE t1.course IS NULL
  AND t2.sem = '$semester'
ORDER BY course"; 
```

# java - 将上传的文件附加为电子邮件

> ID：11673221
> 
> 赞同：1
> 
> 时间：2012-07-26T15:52:35.000
> 
> 标签：java, file-upload, portlet, fileinputstream, jsr286

我正在使用 apache commons fileupload 来上传文件。我想将此文件附加到电子邮件中。我不想写入临时文件，但我想将数据保存在内存中并将其作为附件发送。我需要这里的指导。提前致谢

```
DiskFileItemFactory factory = new DiskFileItemFactory();
                PortletFileUpload upload = new PortletFileUpload(factory);
                List items = upload.parseRequest(request);

                Iterator iter = items.iterator();

                while(iter.hasNext()) {
                    FileItem item = (FileItem) iter.next();
                    if(item.isFormField()) {

                        String name = item.getFieldName();
                        String value = item.getString();
                        response.setRenderParameter(name, value);

                    } else {

                        String fieldName = item.getFieldName();
                        String fileName = item.getName();
                        //String contentType = item.getContentType();
                        boolean isInMemory = item.isInMemory();
                        long sizeInBytes = item.getSize();

                        InputStream uploadedStream = item.getInputStream();

                    }
                } 
```

**更新** 我有以下方法签名，用于发送带有附件的电子邮件，并且工作正常。

```
sendWithFileAttachment (String[] recipients,
            String subject,
            File message,
            String from,
            String filename) {

            BodyPart messageBodyPart = new MimeBodyPart();

    // Fill the message
    messageBodyPart.setText("Pardon Ideas");

    Multipart multipart = new MimeMultipart();
    multipart.addBodyPart(messageBodyPart);

    // Part two is attachment
    messageBodyPart = new MimeBodyPart();
    DataSource source = new FileDataSource(message);
    messageBodyPart.setDataHandler(new DataHandler(source));
    messageBodyPart.setFileName(filename);
    multipart.addBodyPart(messageBodyPart);

    // Put parts in message

    msg.setContent(multipart);

    Transport.send(msg); 
```

}

**更新 2：** 实现您的代码后，我收到以下错误。你能帮我解决这个问题吗

```
HIT ME! 15782
Jul 31, 2012 11:17:56 AM test.test.EmailUtility1$InputStreamMimeBodyPart getContentStream
SEVERE: null
Throwable occurred: java.io.IOException: Stream closed
    at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:156)
    at java.io.BufferedInputStream.reset(BufferedInputStream.java:425)
    at test.test.EmailUtility1$InputStreamMimeBodyPart.getContentStream(EmailUtility1.java:174)
    at javax.mail.internet.MimePartDataSource.getInputStream(MimePartDataSource.java:94)
    at javax.activation.DataHandler.writeTo(DataHandler.java:302)
    at javax.mail.internet.MimeBodyPart.writeTo(MimeBodyPart.java:1350)
    at javax.mail.internet.MimeBodyPart.writeTo(MimeBodyPart.java:845)
    at javax.mail.internet.MimeMultipart.writeTo(MimeMultipart.java:361)
    at com.sun.mail.handlers.multipart_mixed.writeTo(multipart_mixed.java:85)
    at javax.activation.ObjectDataContentHandler.writeTo(DataHandler.java:881)
    at javax.activation.DataHandler.writeTo(DataHandler.java:314)
    at javax.mail.internet.MimeBodyPart.writeTo(MimeBodyPart.java:1350)
    at javax.mail.internet.MimeMessage.writeTo(MimeMessage.java:1683)
    at com.sun.mail.smtp.SMTPTransport.sendMessage(SMTPTransport.java:585)
    at javax.mail.Transport.send0(Transport.java:169)
    at javax.mail.Transport.send(Transport.java:98)
    at test.test.EmailUtility1.sendWithFileAttachment(EmailUtility1.java:155)
    at test.test.TestEmail.main(TestEmail.java:32)
Exception in thread "main" javax.mail.MessagingException: IOException while sending message;
  nested exception is:
    java.io.IOException: Stream closed
    at com.sun.mail.smtp.SMTPTransport.sendMessage(SMTPTransport.java:625)
    at javax.mail.Transport.send0(Transport.java:169)
    at javax.mail.Transport.send(Transport.java:98)
    at test.test.EmailUtility1.sendWithFileAttachment(EmailUtility1.java:155)
    at test.test.TestEmail.main(TestEmail.java:32)
Caused by: java.io.IOException: Stream closed
    at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:156)
    at java.io.BufferedInputStream.read(BufferedInputStream.java:319)
    at java.io.FilterInputStream.read(FilterInputStream.java:101) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:10:18.460

您需要覆盖 MimeBodyPart（我假设您最有可能使用它）才能通过 Stream 获取它们的内容。

```
public void sendWithFileAttachment(String recipient,
                String subject,
                InputStream message,
                String from,
                String filename) throws MessagingException {
    MimeMessage msg = new MimeMessage(getSession());

    // set the from and to address
    InternetAddress addressFrom = new InternetAddress(from);
    msg.setFrom(addressFrom);

    InternetAddress addressTo = new InternetAddress(recipient);
    msg.setRecipient(Message.RecipientType.TO, addressTo);

    BodyPart messageBodyPart = new MimeBodyPart();

    // Fill the message
    messageBodyPart.setText("Pardon Ideas");

    Multipart multipart = new MimeMultipart();
    multipart.addBodyPart(messageBodyPart);

    // Part two is attachment
    messageBodyPart = new InputStreamMimeBodyPart(message);
    messageBodyPart.setFileName(filename);
    multipart.addBodyPart(messageBodyPart);

    // Put parts in message

    msg.setContent(multipart);

    Transport.send(msg);
    // important: you need to close the message stream manually
    try {
        message.close();
    } catch (IOException ex) {
        // meh. So what.
    }

}

private class InputStreamMimeBodyPart extends MimeBodyPart {

private InputStream inputStream;

    public InputStreamMimeBodyPart(InputStream source) {
        this.inputStream = source;
        if(!inputStream.markSupported()) {
            throw new IllegalArgumentException("only streams with mark supported are ok");
        }
        inputStream.mark(Integer.MAX_VALUE); // remeber the whole stream.
    }

    @Override
    protected InputStream getContentStream() throws MessagingException {
        throw new IllegalStateException("getContentStream is not implemented on purpose.");
    }

    @Override
    public void writeTo(OutputStream os) throws IOException, MessagingException {
        System.out.println("writing to somewhere.");
        byte[] buf = new byte[32];
        int length;
        inputStream.reset();
        while((length = inputStream.read(buf)) > -1 ) {
            os.write(buf, 0, length);
        }
    }
}

private Session getSession() {
    // here you do authentication etc.
    Properties properties = new Properties();
    return Session.getInstance(properties);
} 
```

# knockout.js - 如何在剔除映射中使用没有计算属性的 ko.toJs 方法？

> ID：11673229
> 
> 赞同：15
> 
> 时间：2012-07-26T15:52:56.790
> 
> 标签：knockout.js

我想将 viewModel 转换为 Json 对象。但我不想映射计算属性。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-07-27T01:38:11.633

如果要将其转换为 JSON，这里有几个选项：

1.  如果您为对象使用构造函数，则可以覆盖该`.toJSON`函数以控制要输出的属性。这是一篇关于它的文章：[http](http://www.knockmeout.net/2011/04/controlling-how-object-is-converted-to.html) ://www.knockmeout.net/2011/04/controlling-how-object-is-converted-to.html 。这是一个示例：http: [//jsfiddle.net/rniemeyer/FE4HX/](http://jsfiddle.net/rniemeyer/FE4HX/)。

2.  在 KO 2.1 中，当使用`ko.toJSON`第二个和第三个参数时，现在传递给`JSON.stringify`. 以下是有关参数的一些文档：[https](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/JSON/stringify) ://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/JSON/stringify 。这意味着您可以将第二个参数 ( `replacer`) 与要包含的属性数组或处理键/值的函数一起传递。这是使用此技术的相同示例：http: [//jsfiddle.net/rniemeyer/huyLe/](http://jsfiddle.net/rniemeyer/huyLe/)。

3.  我经常使用的另一个选项是将 JSON 输出中不需要的计算值定义为子可观察值。Observables 是函数，它们是对象，因此您实际上可以在 observables 上定义 observables。像：

-

```
this.name = ko.observable("Bob");
this.name.formatted = ko.computed(...); 
```

现在当转换为 JSON 时，`formatted`会`name`随着转换为它的值而自然丢失。这是相同的示例：http: [//jsfiddle.net/rniemeyer/peEGG/](http://jsfiddle.net/rniemeyer/peEGG/)。通常，当它是关于可观察对象（ ， 等）的元数据时，我会使用`isValid`它`isEditing`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-27T00:22:00.080

这也将起作用，它只会忽略其中包含“mappedProperties”的任何内容，因为鸭式反对者请记住，您不应该将 mappedProperties 作为代码的一部分，因为您使用的是淘汰赛。因此它应该工作。

```
/* Use this serializer function along with ko.toJS to produce clean JSON objects. */
ko.toJS2 = function (model)
{
     return JSON.parse(ko.toJSON(model, modelSerializer));
}

function modelSerializer(key, value)
{
if (isSerializable(value))
    return value;
else
    return;
}

function isSerializable(object) {
    if (object == null) return true;
    if (typeof object == 'function') return false;
    if (object.mappedProperties != null) return false;

    return true;
} 
```

用法：

```
var goodLookingJson = ko.toJS2(whateverModel); 
```

# sql-server - SQL Server 仍然认为数据库存在

> ID：11673233
> 
> 赞同：2
> 
> 时间：2012-07-26T15:53:14.320
> 
> 标签：sql-server

我遇到了一个奇怪的问题。我试图禁用旧的、未使用的登录，但是当我单击确定时，服务器返回以下错误

> 数据库“xyz”不存在。提供一个有效的数据库名称。

奇怪的是，该数据库在几年前就已分离。在某个地方，SQL 仍然对它有一些参考。我在哪里可以查看以及如何将其删除？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:02:07.767

难道这个登录名将`xyz`数据库设置为他用来连接的默认数据库？

![在此处输入图像描述](../Images/4461b0aa14f5ee561058223edeb56bdb.png)

如果是这样：当您禁用登录时，将该默认数据库更改为其他数据库。

# c - 基于时间在数据库（MYSQL）中排队数据

> ID：11673235
> 
> 赞同：0
> 
> 时间：2012-07-26T15:53:22.157
> 
> 标签：c, database, linux

根据进入数据库的时间检索数据的最佳方法是什么？

例如，以下保存在数据库中

```
data 1 saved now 
data 2 saved now+1
data 3 saved now+2
data 4 saved now+3
data 5 saved now+4 
```

那么获取数据1，数据2然后3的最佳方法是什么，例如fifo

另一个问题是假设数据数据 3 无法处理，那么用新的时间值再次保存它的最佳方法是什么，所以它将在 4 和 5 之前处理，所以它会像这样，

```
data 4 saved 
data 3 saved 
data 5 saved 
```

我正在考虑直接的解决方案，即获取对日期进行排序的行并尝试逐个处理它们然后获取另一组行，但我认为这还不够，因为我需要选择整个表并排序然后它处理它，我想象如果我有数百万行，那将是非常糟糕的。

是否可以使用 DB 以外的其他东西来完成上述操作？请记住，我需要将数据保存在磁盘上，以防服务器重新启动。

我正在使用的环境是具有多个线程/进程的 Linux 和 C

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:36:39.363

如果您不需要对数据执行复杂的查询，那么您可以实现由辅助驱动器支持的 fifo 队列。您甚至不需要存储时间戳，因为队列顺序意味着时间戳顺序。您可以将大块（例如 1000 行）保存在单独的文件中，并将最近的行保存在主内存中。在这种情况下，可能不需要数据库。

# java - Maven compile 在目标中产生同一个类的多个版本？

> ID：11673240
> 
> 赞同：0
> 
> 时间：2012-07-26T15:53:36.870
> 
> 标签：java, compilation, maven-3

我有一个具有许多不同依赖项的项目。当我跑

```
mvn clean compile 
```

对于某些课程，我会获得同一课程的多个版本，例如

```
./classes/com/.../MyClass$1$1.class
./classes/com/.../MyClass$1$10.class
./classes/com/.../MyClass$1$11.class
./classes/com/.../MyClass$1$12.class
./classes/com/.../MyClass$1$13.class
./classes/com/.../MyClass$1$14.class 
```

等等

为什么会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T15:56:09.857

该`$1`符号用于匿名内部类。运行`javac`将产生相同类型的输出。

# java - Java：使用 RSA 私钥（Xml 签名）解密字符串

> ID：11673243
> 
> 赞同：-2
> 
> 时间：2012-07-26T15:53:39.967
> 
> 标签：java, encryption, rsa

我必须解密使用 .NET 中的 RSA xml 签名公钥加密的字符串我尝试使用 php RSA Crypt Module 抛出错误。所以，我想使用 Java 。我是小新java。示例代码会很有帮助。

实际上我需要将以下 .Net 代码移植到 Java

```
RSACryptoServiceProvider rsaCryptoServiceProvider = new RSACryptoServiceProvider(keySize);
rsaCryptoServiceProvider.FromXmlString(privateKey);
int base64BlockSize = ((keySize / 8) % 3 != 0) ? (((keySize / 8) / 3) * 4) + 4 : ((keySize / 8) / 3) * 4;
int iterations = inputString.Length / base64BlockSize;
ArrayList arrayList = new ArrayList();
for (int i = 0; i < iterations; i++)
{                                                                               
   byte[] encryptedBytes = Convert.FromBase64String(inputString.Substring(base64BlockSize * i, base64BlockSize));
   Array.Reverse(encryptedBytes);
   arrayList.AddRange(rsaCryptoServiceProvider.Decrypt(encryptedBytes, false));
}                                                                                                   lstrResponse = Encoding.UTF8.GetString(arrayList.ToArray(Type.GetType("System.Byte")) as byte[]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:54:18.990

您必须阅读 .Net XML 密钥表示并将指数和模数存储在 Java [RSAPrivateKeySpec](http://docs.oracle.com/javase/1.4.2/docs/api/java/security/spec/RSAPrivateKeySpec.html)中。将此实例传递给[KeyFactory](http://docs.oracle.com/javase/6/docs/api/java/security/KeyFactory.html)`generatePrivate`的方法以生成密钥。

然后，您需要使用适合 .Net 实现的算法通过该方法获得的[Cipher](http://docs.oracle.com/javase/6/docs/api/javax/crypto/Cipher.html)实例。`Cipher.getInstance`密码也需要正确初始化。使用获得的`RSAPrivateKey`实例（见上文），您可以调用其中一种密码方法来解密数据。

魔鬼在细节中，当然：关键材料的解码和格式化，找到正确的算法，初始化......

# asp.net-mvc-3 - 急切加载的空相关对象正在延迟加载

> ID：11673251
> 
> 赞同：3
> 
> 时间：2012-07-26T15:54:02.423
> 
> 标签：asp.net-mvc-3, entity-framework, poco, eager-loading

我急切地加载（通过使用 .Include()）相关实体，以尽量减少为特别“大量”数据网格生成的 SQL 查询的数量。在 POCO 中，相关实体是公共虚拟导航属性，这意味着它们是延迟加载的。我想保留延迟加载这些相关实体的默认行为，因为它最适合我项目的其他部分。

现在，在预先加载相关实体之后，我可以看到仍然有相当数量的查询生成。这是仅针对为空的相关实体的查询*（*空只是因为 sql 连接“发现”没有相关数据）。

这让我相信，当我稍后在表示层访问它们时，EF 会尝试延迟加载这些实体（认为它们尚未加载）。

我是否错过了一些基本的东西，或者有什么办法可以解决这个问题？

**示例代码**
使用存储库模式，这里有一些简化的方法（省略分页、排序、过滤等）。

*通用存储库中的获取方法*

```
public IEnumerable<T> Get(
    Expression<Func<T, object>>[] includes = null)
{
    IQueryable<T> query = set;

    ...

    // Include properies for eager loading
    if (includes != null)
    {
       query = includes.Aggregate(query, 
          (current, include) => current.Include(include));
    }

    ...

    return query.ToList();
} 
```

*上面是从服务类调用的，像这样*

```
...
context.Licenses.Get(
    includes: new Expression<Func<License, object>>[] { l => l.Comment }
);
... 
```

*许可 POCO*

```
public class License
{
    public License()
    {
    }

    // Primitive properties
    public string ID { get; set; }
    public string Name { get; set; }
    ...
    // Navigation properties
    public virtual LicenseComment Comment { get; set; }
    ...
} 
```

*许可证评论 POCO*

```
public class LicenseComment
{
    public LicenseComment()
    {
    }

    // Primitive properties
    public string LicenseID { get; set; }
    public string Comment { get; set; }
} 
```

*在 MVC Razor 视图（或为此而在模型中）访问属性*

```
<span>@license.Comment</span> 
```

每当我尝试访问一个为 null 的 License.Comment（通过 SQL Server Profiler 查找）时，都会生成额外的 SQL 查询，在我看来，实体框架延迟加载会启动，即使我急切地包含了这个属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T08:02:10.437

我无法尝试知道，但我希望这不应该发生。无论如何，如果您有一个不希望发生延迟加载的页面，您可以简单地关闭该页面：

```
context.Configuration.LazyLoadingEnabled = false; 
```

或者您可以关闭这些查询的代理创建 - 未代理的实体不能使用延迟加载：

```
context.Configuration.ProxyCreationEnabled = false; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T12:32:32.913

我同意@Ladislav 的观点，认为它不应该发生，并测试了“正常”行为如下：

如果您加载包含评论的许可证...

```
var license = context.Licenses.Include(l => l.Comment).Single(l => l.ID == 1); 
```

...EF 将导航属性标记为已加载：

```
var isCommentLoaded = context.Entry(license).Reference(l => l.Comment).IsLoaded; 
```

无论评论是否`null`存在，访问属性时都`isCommentLoaded`不会`true`发出延迟加载查询。`Comment`

即使您不使用急切加载...

```
var license = context.Licenses.Single(l => l.ID == 1); 
```

...`isCommentLoaded`如果从许可证到数据库中的评论的外键是（但`true` *如果*外键不是）。原因是 EF 总是将语句中的外键加载到上下文中，如果这个键是EF 知道数据库中没有相关注释并将导航属性标记为已加载以避免不必要的延迟加载。`NULL``false``NULL``SELECT``NULL`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-03T18:29:55.140

虽然不完全是您的情况，但我有类似的情况，我指出有一个额外的属性访问不是原始包含的一部分。

# javascript - 如何知道元素何时滚动到底部

> ID：11673259
> 
> 赞同：0
> 
> 时间：2012-07-26T15:54:20.457
> 
> 标签：javascript, uiscrollview, scrolltop

根据[Stackoverflow](https://stackoverflow.com/questions/2817042/determining-when-scrolled-to-bottom-of-a-page-with-javascript)对问题的第一个答案，可以知道`element.innerHeight`+何时`element.scrollTop`大于或等于`element.offsetHeight`。不应该是**`element.innerHeight`+`element.scrollTop`大于或等于`element.scrollHeight`**吗？`offsetHeight`只在计算可见高度的时候包括了padding，我们这里想要的是找到滚动高度加上可见高度是否等于总高度，总高度不就是给出的`scrollHeight`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:57:07.353

一般来说，是的。然而，这个问题是关于页面的，并且`<body>`元素实际上并没有滚动；视口确实如此。

试试看：确保此页面滚动，然后打开控制台：

```
> document.body.offsetHeight === document.body.scrollHeight
true 
```

# wpf - 通过 Webbrowser 在 PDF 查看器上禁用上下文菜单

> ID：11673269
> 
> 赞同：0
> 
> 时间：2012-07-26T15:55:17.337
> 
> 标签：wpf, contextmenu

我正在尝试通过网络浏览器 UIElement 禁用 PDF 文件上的右键单击（以及上下文菜单）。但无论它永远不会调用所需的处理程序（与加载普通 html 的网络浏览器的行为相同，但与其他 UIElements 不同）。

```
 public override UIElement Play()
    {
        base.Play();

        //It will be represented in a Webbrowser element
        WebBrowser element = new WebBrowser();

        element.ContextMenuOpening +=new ContextMenuEventHandler(element_ContextMenuOpening);

        //navigate to the current path of the file in the HDD, adding some parameters to avoid the Adobe Reader pannels to be shown
        element.Source = new Uri(path+"#toolbar=0&navpanes=0");
        return element;
    }

    public void element_ContextMenuOpening(Object obj, ContextMenuEventArgs e)
    {
        Console.WriteLine("CONTEXT MENU PDF");
    } 
```

“CONTEXT MENU PDF”行从不打印。我也尝试过使用 MouseDown，但保持不变。

编辑 1：感谢 MephestoKhaan，我设法通过 webbrowser 与 Webs 一起工作。对于 PDF，它应该是类似的，我仍在寻找正确的类来将 Webbrowser.document 对象转换为。

```
 public override UIElement Play()
    {
        base.Play();

        //the element will be represented in a webbroser
        element = new WebBrowser();
        //load the web indicated by the path (url)
        element.NavigateToString(Path);
        element.Source = new Uri(Path);

        //disable context menu
        mshtml.HTMLDocumentEvents2_Event iEvent;
        iEvent = (mshtml.HTMLDocumentEvents2_Event) element.Document;
        iEvent.oncontextmenu += new mshtml.HTMLDocumentEvents2_oncontextmenuEventHandler(iEvent_oncontextmenu); 

        return element;
    }

    bool iEvent_oncontextmenu(mshtml.IHTMLEventObj e)
    {
        return false;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T09:27:08.600

好吧，MephestoKhaan 是通过 webbrowsers 处理元素的正确方法（在它的示例中：webs），但是在通过 Webbrowser 与 Acrobat Reader 斗争之后，我改为 Foxit Reader。

使用 Foxit，我可以直接在首选项上禁用所有菜单和右键单击事件并全屏打开它（不是网络浏览器，而是不同的窗口）。这不完全是我要问的，但解决了我最深的问题（PDF 查看器上没有上下文菜单）。

对于记录>如果您想在窗口上有按钮或某些自定义界面，请使用弹出窗口并将窗口设置为覆盖所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:22:38.590

试试这个： http: [//support.microsoft.com/](http://support.microsoft.com/?kbid=312777) ?kbid=312777 （从这里[WPF WebBrowser Mouse Events not working as expected](https://stackoverflow.com/questions/2189510/wpf-webbrowser-mouse-events-not-working-as-expected=)。似乎 WPF 本身不管理控件，所以你必须绑定处理程序到文档。

# android - 嵌套数组在多大的列表大小下会影响性能？

> ID：11673270
> 
> 赞同：0
> 
> 时间：2012-07-26T15:55:19.387
> 
> 标签：android, xml, arrays, performance, nested

我正在构建一个应用程序，它将使用可扩展的列表视图作为主用户界面，结构如下：*点菜：-劳斯莱斯：+鲑鱼+ 2.95 +金枪鱼-握寿司：+鲑鱼+黄尾

等等

我构建了一个 XML，其元素与此结构匹配，如下所示：

```
<type type = "A la Carte>
  <option option = "Rolls">
   <item>
     <name> Salmon</name>
     <price> 2.95 </price> 
   </item>
  </option>
</type 
```

（不要注意任何 xml 错误——我是从内存中输入的，但 XML 确实有效）。

我正在使用 SAXParser 来解析 XML。问题是，我应该将数据解析成什么结构？

菜单列表并不大（跨类别共有 100 个元素），所以我想我会创建一组嵌套数组列表，如下所示：

数组列表（类型）包含（数组列表（选项）包含（数组列表项）包含数组（名称，价格）。

这个结构再现了我将数据调用到 ListView 的顺序；它还与确认表中显示数据的方式相匹配；它与我将传递给服务器的 SQLite 的结构相匹配，以完成订单。

我的问题是，在这个大小列表和这个嵌套数量下，应用程序的性能会严重耗尽吗？值得注意的是，这会消耗电池寿命吗？

我真的很期待你的想法！

注意：要记住的一件事是我想将此结构重用于其他服务；例如，假设我的食堂有烧烤特色菜；我希望能够插入一个具有类似结构的 XML 文件（但不同的文本，因为它将以烧烤为主题）并最小限度地更改代码以便阅读它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:17:06.360

我看到了四个嵌套的 ArrayList，这肯定会开始降低性能，并且会消耗额外的电池寿命来查找所有这些数组 indeces。考虑使用其他数据类型[——BasicNameValuePair](http://developer.android.com/reference/org/apache/http/message/BasicNameValuePair.html)用于（名称、价格），[LinkedList](http://docs.oracle.com/javase/6/docs/api/java/util/LinkedList.html)用于项目、选项和类型。这将运行得更快。我可能会创建一个包含 BasicNameValuePair (name,price) 的简单 Item 类，以更好地组织程序。

如果顺序不重要，我肯定会使用 HashMap 而不是 LinkedList，因为按名称放置和访问元素要快得多。

如果它们总是按字母顺序排列，请使用 TreeMap，因为它速度极快，并且会自动按字母顺序排列所有内容。

# c# - 因为我可以阅读 SMPP 协议的帖子。网络 C#

> ID：11673274
> 
> 赞同：0
> 
> 时间：2012-07-26T15:55:40.660
> 
> 标签：c#, smpp

我需要通过 SMPP 协议读取消息并将信息保存在数据库中，因为我可以这样做，我发现要发送的信息很多，但我需要特别是通过 C# 语言捕获。NET 如果我能用西班牙语回答会好得多。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:04:03.190

您想阅读短信吗？

[http://www.inetlab.com/Products/Inetlab.SMPP.aspx](http://www.inetlab.com/Products/Inetlab.SMPP.aspx)

[http://sourceforge.net/projects/easysmpp/](http://sourceforge.net/projects/easysmpp/)

[一个强大的 .NET SMPP 库](https://stackoverflow.com/questions/4820560/a-robust-smpp-library-for-net)

[http://www.tops.com.pl/en/products/smscc/index.html](http://www.tops.com.pl/en/products/smscc/index.html)

# javascript - jQuery mobile Ajax 导航功能和 CSS 样式

> ID：11673277
> 
> 赞同：0
> 
> 时间：2012-07-26T15:55:50.097
> 
> 标签：javascript, jquery, css, jquery-mobile, styles

我正在使用 jQuery Mobile 创建一个网站，我对 jQuery Mobile 的 Ajax 导航功能很感兴趣。

我的第一个网页在 ... 标签中有一些 CSS 样式，而第二个网页有*不同的样式*。

如果我不使用 jQuery Mobile 的 ajax 导航，一切都是正确的；但如果我使用 ajax 导航，第二个网页的 CSS 样式将不会加载。

如何在启用 ajax 导航的情况下加载样式？我必须使用 jQuery 来加载这些样式吗？没有更好的办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:01:13.753

阅读[此页面](http://jquerymobile.com/demos/1.1.1/docs/pages/page-scripting.html)应该会有所帮助。

# regex - 如何使用 grep 删除单词前缀？

> ID：11673287
> 
> 赞同：14
> 
> 时间：2012-07-26T15:56:29.453
> 
> 标签：regex, linux, shell, sed

如何使用 grep 删除单词的开头？例如：我有一个文件，其中包含：

```
www.abc.com 
```

我只需要那部分

```
abc.com 
```

对不起，基本问题。但是没有使用Linux的经验。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-26T16:01:34.600

您不能`grep`在 Unix shell 中编辑字符串，`grep`通常用于从文本中查找或删除某些行。你宁愿使用`sed`：

```
$ echo www.example.com | sed 's/^[^\.]\+\.//'
example.com 
```

您需要学习正则表达式[才能有效地使用它](http://www.grymoire.com/Unix/Sed.html)。

sed 也可以就地编辑文件（修改文件），如果你传递`-i`参数，但要小心，如果你写错`sed`命令和使用`-i`标志，你很容易丢失数据。

## 一个例子

从您的评论中猜测您有一个 TeX 文档，并且您想删除所有 .com 域名的第一部分。如果是您的文件`test.tex`：

```
\documentclass{article}
\begin{document}
www.example.com
example.com www.another.domain.com
\end{document} 
```

然后您可以使用此`sed`命令对其进行转换（将输出重定向到文件或使用 就地编辑`-i`）：

```
$ sed 's/\([a-z0-9-]\+\.\)\(\([a-z0-9-]\+\.\)\+com\)/\2/gi' test.tex 
\documentclass{article}
\begin{document}
example.com
example.com another.domain.com
\end{document} 
```

请注意：

*   一个常见的允许符号序列后跟一个点匹配`[a-z0-9-]\+\.`
*   我在正则表达式中使用了组（它的一部分在`\(`and`\)`中）来指示 URL 的第一和第二部分，并将整个匹配替换为其第二组（`\2`在替换模式中）
*   域应至少是第 3 级 .com 域（每个`\+`重复意味着至少一个匹配项）
*   搜索不区分大小写（`i`最后标记）
*   它可以做的不仅仅是每行匹配（`g`最后的标志）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-26T16:34:39.690

正如其他人所指出的，`grep`它不太适合此任务，`sed`是一个不错的选择，或者如果文本井井有条，那么简单`cut`的输入可能会更容易：

```
echo www.abc.com | cut -d. -f2- 
```

*   `-d.`告诉`cut`用作`.`分隔符。
*   `-f2-`告诉`cut`将字段 2 返回到无穷大。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-07-26T18:42:31.683

你可以`grep`很容易地做到这一点：

```
$ echo www.google.com | grep -o '[^.]*\.com'
google.com 
```

而不是`echo`你必须给你的文件。

```
$ grep -o '[^.]*\.com$' < file 
```

我在这里使用了正则表达式'[^.]*.com'。这意味着：给我找一个没有`.`in 的词 ( `[^.]*`)，然后是`.com`( `\.com`in re)。`-o`关键说必须只显示找到的`grep`那部分。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-05-21T10:27:02.467

# 用 grep`--only-matching`和`\K`

您可以使用 grep 的`--only-matching`标志来执行此操作：

```
echo "www.abc.com" | grep --perl-regexp --only-matching 'www.\K.*' 
```

可以缩短为

```
echo "www.abc.com" | grep -Po 'www.\K.*' 
```

两个命令都产生

> 美国广播公司

使用 grep (GNU grep) 3.3。

而不是`echo`，我将使用[此处的字符串](https://tldp.org/LDP/abs/html/x17837.html)来进一步缩短命令：

```
grep -Po 'www.\K.*' <<< "www.abc.com" 
```

`\K`重置匹配的起点，基本上忘记了匹配的“www.”。有关更多信息，请参阅[此](https://stackoverflow.com/questions/33573920/what-does-k-mean-in-this-regex)内容`\K`。

# 与 grep 的积极后视

您也可以通过[积极](https://www.regular-expressions.info/lookaround.html#lookbehind)的后视来做到这一点：

```
grep -Po '(?<=www.).*' <<< "www.abc.com" 
```

# 使用 awk 的字段分隔符`-F`

```
awk -F 'www.' <<< "www.abc.com" '$2{print $2}' 
```

这打印

> 美国广播公司

如果已定义，该`$2{print $2}`部分将打印第二个字段。这在多行输入的情况下是必要的，以避免为不包含字段分隔符的输入行输出空行。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-26T16:00:59.407

`grep`不用于操作/更改文本，仅用于在文本中搜索文本/模式

您应该研究类似的东西，或者`sed`如果您想要命令行工具来执行此操作。或者用 Python/Perl/Ruby/whatever 编写一个脚本。`awk``cut`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-01-02T07:35:45.803

通过在 bash 中使用内置参数扩展，您实际上可以在不调用其他程序的情况下执行此操作：

```
while read line; do echo ${line#*.}; done < file 
```

Where`#*.`告诉外壳程序删除看起来像 0 个或多个字符的前缀，后跟一个`.`.

您可以在此处查看带有 bash 的不同参数扩展的备忘单：

[https://devhints.io/bash](https://devhints.io/bash)

# python - Python：检查整数中的数字

> ID：11673289
> 
> 赞同：-2
> 
> 时间：2012-07-26T15:56:36.190
> 
> 标签：python, integer

你如何检查python的整数中的数字？基本上是一个如果 8 在整数中则返回 true 的函数。所以函数（8291）返回真，但函数（777）返回假。搜索号码的诀窍是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T15:57:42.433

```
def contains_digit(digit, number):
    return str(digit) in str(number) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T15:57:36.850

最简单的方法是将其转换为字符串并在那里搜索。

`'8' in str(8291)`-> 真

`'8' in str(777)`-> 错误

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:00:09.293

如果将其转换为字符串，Python 有一个方法。

```
def function(number_to_search):
    return '8' in str(number_to_search) 
```

# php - 使用 PHP PDO 插入多行

> ID：11673290
> 
> 赞同：0
> 
> 时间：2012-07-26T15:56:36.567
> 
> 标签：php, pdo, prepared-statement

我正在尝试通过 PHP PDO 使用事务绑定插入多行。下面是我的代码。

```
$arrkeys = array_keys($this->postItem);
$itemqry = "INSERT INTO test_item (itemdate, flditmname, fieldtype, subscribe, id, year) VALUES (:itemdate, :flditmname, :fieldtype, :subscribe, :id, :year);" // dynamically generated

$itmstmt = $dbcon->prepare($itemqry);

for ($i=0; $i<$cnt; $i++){
  foreach ($arrkeys as $key){
     $val = $this->postItem[substr($key,1)][$i];
     $itmstmt->bindParam($key, $val);
  }

  try {
    $itmstmt->execute();
  } catch (PDOException $e){
    echo $e->getMessage();
  }

} 
```

我验证了值是否正确填充（用于绑定），如下所示：

```
echo $key."=".$val."<br>";  //echoed just before the bind.

:itemdate=2012-07-02 15:09:04
:flditmname=dccd
:fieldtype=2
:subscribe=X
:id=12345
:year=2012
:itemdate=2012-07-12 15:09:19
:flditmname=lkpok
:fieldtype=3
:subscribe=X
:id=12345
:year=2012 
```

但是，在我的 db 表中插入后，所有行的所有字段都采用值“2012”（最后一个字段的值）。

我不知道为什么会这样。谁能帮我跟踪问题？非常感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:32:21.360

您使用了错误的方法：

```
$itmstmt->bindParam($key, $val); 
```

应该：

```
$itmstmt->bindValue($key, $val); 
```

[`bindValue`](http://us2.php.net/manual/en/pdostatement.bindvalue.php)将值绑定到参数，而 [`bindParam`](http://us2.php.net/manual/en/pdostatement.bindparam.php)将参数绑定到指定的变量名

# php - foreach循环中的PHP GD绘图

> ID：11673291
> 
> 赞同：1
> 
> 时间：2012-07-26T15:56:37.010
> 
> 标签：php, gd

我有以下代码使用 GD 在图像上绘制绿色方块：

```
$img = imagecreatefrompng("images/dota.png");
$radiantcolor = imagecolorallocate($img, 7, 251, 15);
$direcolor = imagecolorallocate($img, 250, 2, 0);

$x = array(
0 => 38,
1 => 45,
2 => 25,
3 => 29,
4 => 34,
5 => 62,
6 => 83,
7 => 116,
8 => 76,
9 => 135,
10 => 232,
);

$y = array(
0 => 234,
1 => 240,
2 => 205,
3 => 161,
4 => 116,
5 => 219,
6 => 198,
7 => 171,
8 => 256,
9 => 260,
10 => 257,
);

foreach ($towerstatus_radiant as $key => $tower){
if ($tower == 1){
    $x = $x[$key];
    $y = $y[$key];
    imagefilledrectangle($img, $x, $y, $x+8, $y+8, $radiantcolor);
}
}

header('Content-Type: image/png');
imagepng($img); 
```

它适用于第一个正方形，但之后，正方形似乎只是放在左上角，如下所示：

![](../Images/8f4e2ec0153fec1e67081353c1a99318.png)

为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:00:40.983

你在这里覆盖你的 $x 和 $y 变量：

```
$x = $x[$key];
$y = $y[$key]; 
```

您需要在这里使用不同的变量名。

# android - 捆绑东西的麻烦：

> ID：11673292
> 
> 赞同：1
> 
> 时间：2012-07-26T15:56:47.043
> 
> 标签：android, android-appwidget

大家好（对此感到抱歉），我正在编写一个代码，该代码允许我在应用小部件的设置屏幕中输入一个数字。然后我们将其保存并存储为一个变量，以在为其制作小部件的主应用程序中使用。我想知道如何捆绑选择的号码并将其传输到要运行的应用程序/小部件。

```
import android.app.Activity;
import android.app.PendingIntent;
import android.appwidget.AppWidgetManager;
import android.content.Context;  
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.RemoteViews;
import android.widget.TextView;

public class WWSettings extends Activity implements OnClickListener {

    Context context = this;
    Button svBtn;
    AppWidgetManager awm;
    EditText userNum;
    TextView unOut;
    int awID;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.widgetconfig);
        svBtn = (Button) findViewById(R.id.btnwidgetconfig);
        emsNum = (EditText) findViewById(R.id.etwidgitconfig);
        emsOut = (TextView) findViewById(R.id.unOut);
        svBtn.setOnClickListener(this);
        //get widget info!
        Intent i = getIntent();
        Bundle extras = i.getExtras();
        if(extras !=null){
            awID = extras.getInt(AppWidgetManager.EXTRA_APPWIDGET_ID,AppWidgetManager.INVALID_APPWIDGET_ID);
        }
        else{
            finish();
        }
        awm = AppWidgetManager.getInstance(this);
    }

    public void onClick(View v) {
        // TODO Auto-generated method stub
        String e = userNum.getText().toString();
        RemoteViews view = new RemoteViews(this.getPackageName(), R.layout.widget);
        view.setTextViewText(R.id.unOut, "Your Number is set to" + e);
        Intent sparkintent = new Intent(this, startSpark.class);
        PendingIntent pi = PendingIntent.getActivity(this, 0, sparkintent, 0);
        view.setOnClickPendingIntent(R.id.btnwidgetconfig, pi);
        sparkintent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);

        awm.updateAppWidget(awID, view);

        Intent result = new Intent();
        result.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, awID);
        setResult(RESULT_OK, result);
        finish();
    }
} 
```

logz 的 Das Kat：

```
07-26 17:13:08.629: W/dalvikvm(1488): threadid=1: thread exiting with uncaught exception (group=0x40018560)
07-26 17:13:08.639: E/AndroidRuntime(1488): FATAL EXCEPTION: main
07-26 17:13:08.639: E/AndroidRuntime(1488): java.lang.RuntimeException: Unable to start activity ComponentInfo{lionsimage.com.this/lionsimage.com.this.startSpark}: java.lang.NullPointerException
07-26 17:13:08.639: E/AndroidRuntime(1488):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
07-26 17:13:08.639: E/AndroidRuntime(1488):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
07-26 17:13:08.639: E/AndroidRuntime(1488):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
07-26 17:13:08.639: E/AndroidRuntime(1488):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
07-26 17:13:08.639: E/AndroidRuntime(1488):     at android.os.Handler.dispatchMessage(Handler.java:99)
07-26 17:13:08.639: E/AndroidRuntime(1488):     at android.os.Looper.loop(Looper.java:130)
07-26 17:13:08.639: E/AndroidRuntime(1488):     at android.app.ActivityThread.main(ActivityThread.java:3683)
07-26 17:13:08.639: E/AndroidRuntime(1488):     at java.lang.reflect.Method.invokeNative(Native Method)
07-26 17:13:08.639: E/AndroidRuntime(1488):     at java.lang.reflect.Method.invoke(Method.java:507)
07-26 17:13:08.639: E/AndroidRuntime(1488):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:864)
07-26 17:13:08.639: E/AndroidRuntime(1488):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:622)
07-26 17:13:08.639: E/AndroidRuntime(1488):     at dalvik.system.NativeStart.main(Native Method)
07-26 17:13:08.639: E/AndroidRuntime(1488): Caused by: java.lang.NullPointerException
07-26 17:13:08.639: E/AndroidRuntime(1488):     at lionsimage.com.webb.startSpark.onCreate(startSpark.java:28)
07-26 17:13:08.639: E/AndroidRuntime(1488):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
07-26 17:13:08.639: E/AndroidRuntime(1488):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
07-26 17:13:08.639: E/AndroidRuntime(1488):     ... 11 more 
```

# django - 在 Django 用户记录中存储 unicode first_name 和 last_name

> ID：11673293
> 
> 赞同：4
> 
> 时间：2012-07-26T15:56:47.477
> 
> 标签：django, django-models, django-users, python-unicode

试：

```
new_user = User.objects.create_user(username, email, password)
new_user.first_name = first_name
new_user.last_name = last_name
new_user.save() 
```

但是如果名字或姓氏是外国重音字母（unicode？）我会在用户记录中得到垃圾。

我能做些什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T12:04:55.267

Django 支持用户模型的 unicode 字符串，但您的数据库也必须支持它。如果你使用 sqlite 肯定没有问题，但是例如在 mySQL 中，默认的列编码不是 utf-8。

要解决此问题，您可以手动将 auth_user 表列 first_name 和 last_name 排序规则更改为`utf8_unicode_ci`. 或者，您可以`utf8_unicode_ci`在执行 syncdb（并首次创建表）之前将数据库排序规则设置为，这样您的所有表和列都遵循相同的编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-22T12:55:59.017

阿米尔是正确的。

要更改现有表的 MySQL 排序规则，您可以执行以下操作：

```
> python manage.py dbshell

mysql> 
mysql> ALTER TABLE auth_user
    ->   DEFAULT CHARACTER SET utf8mb4,
    ->   MODIFY first_name CHAR(30)
    ->     CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
    ->   MODIFY last_name CHAR(30)
    ->     CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL;
Query OK, 10 rows affected (0.35 sec)
Records: 10  Duplicates: 0  Warnings: 0 
```

即使表非空，也可以这样做。

# c# - 如何将对象从 PowerShell 返回到 C#

> ID：11673295
> 
> 赞同：1
> 
> 时间：2012-07-26T15:57:01.083
> 
> 标签：c#, powershell, virtualization, hyper-v

我想将一个对象从 PowerShell 返回到 C#，因此 C# 使用 C# 代码中的对象来调用任何方法并从对象中获取属性。

例如，我有一个 PowerShell 脚本，它使用来自[pshyperv.codeplex.com](http://pshyperv.codeplex.com)的 Hyper-V 模块从主机获取虚拟机。（这个 GetVM.ps1 只是一个示例，用于解释返回对象）。

一旦我从 Execute() 执行 PowerShell 脚本，然后它返回对象，我想从 ttt() 调用对象的任何方法。

1.  是否有可能的解决方案将对象从 PowerShell 返回到 C#？
2.  如果您发现（PowerShell、C#），您能纠正我的示例代码中的错误吗？

# 电源外壳

```
Param (
    [String]
    $vmHost = '.',
    [String]
    $vmName
)
Process{
    $private:scriptname = $local:myInvocation.MyCommand.Name
    if  (($vmHost -eq '.' ) -and ($vmName -eq 'ITE'))
    {
        #Write-Output "Executing $private:scriptname on $vmHost"
    }
    try {
        return (Get-VM -Name $vmName -Server $vmHost)
    } catch {Write-Error "Unable to create a VM: $vmName"}
} 
```

# C＃

```
public void ttt()
{
    ...
    ret = ps.Execute(rs, "GetVM.ps1 -vmName 'ITE*' |out-string");

    Trace.WriteLine(ret[0].Name);
}

public object Execute(Runspace runSpace, string command)
{
    bool error = false;
    StringBuilder retStr = new StringBuilder();

    pipeline.Commands.AddScript(command);

    Collection<PSObject> results = pipeline.Invoke();

    foreach (object item in pipeline.Error.ReadToEnd())
    {
        error = true;
        strOutput.AppendLine(item.ToString());
        retStr.Append(item.ToString());
    }

    foreach (PSObject obj in results)
    {
        strOutput.AppendLine(obj.ToString());
        retStr.Append(obj.ToString());
    }

    strOutput.Append("\r\n");

    return results;
} 
```

# 执行 PowerShell 结果：

```
PS C:\CVS\IteExtensionCode\Virtualization\VirtualizationTest\Tools\Virtualization\Hyper-V\W2K8> .\GetVM.ps1 -vmName 'ITE*'  |gm

   TypeName: System.Management.ManagementObject#root\virtualization\Msvm_ComputerSystem

Name                          MemberType    Definition
----                          ----------    ----------
VMElementName                 AliasProperty VMElementName = ElementName
RequestStateChange            Method        System.Management.ManagementBaseObject RequestStateChange(System.UInt16 RequestedState, System.String TimeoutPer...
SetPowerState                 Method        System.Management.ManagementBaseObject SetPowerState(System.UInt32 PowerState, System.String Time)
AssignedNumaNodeList          Property      System.UInt16[] AssignedNumaNodeList {get;set;}
Caption                       Property      System.String Caption {get;set;}
CreationClassName             Property      System.String CreationClassName {get;set;}
Dedicated                     Property      System.UInt16[] Dedicated {get;set;}
Description                   Property      System.String Description {get;set;}
ElementName                   Property      System.String ElementName {get;set;}
EnabledDefault                Property      System.UInt16 EnabledDefault {get;set;}
EnabledState                  Property      System.UInt16 EnabledState {get;set;}
HealthState                   Property      System.UInt16 HealthState {get;set;}
IdentifyingDescriptions       Property      System.String[] IdentifyingDescriptions {get;set;}
InstallDate                   Property      System.String InstallDate {get;set;}
Name                          Property      System.String Name {get;set;}
NameFormat                    Property      System.String NameFormat {get;set;}
OnTimeInMilliseconds          Property      System.UInt64 OnTimeInMilliseconds {get;set;}
OperationalStatus             Property      System.UInt16[] OperationalStatus {get;set;}
OtherDedicatedDescriptions    Property      System.String[] OtherDedicatedDescriptions {get;set;}
OtherEnabledState             Property      System.String OtherEnabledState {get;set;}
OtherIdentifyingInfo          Property      System.String[] OtherIdentifyingInfo {get;set;}
PowerManagementCapabilities   Property      System.UInt16[] PowerManagementCapabilities {get;set;}
PrimaryOwnerContact           Property      System.String PrimaryOwnerContact {get;set;}
PrimaryOwnerName              Property      System.String PrimaryOwnerName {get;set;}
ProcessID                     Property      System.UInt32 ProcessID {get;set;}
RequestedState                Property      System.UInt16 RequestedState {get;set;}
ResetCapability               Property      System.UInt16 ResetCapability {get;set;}
Roles                         Property      System.String[] Roles {get;set;}
Status                        Property      System.String Status {get;set;}
StatusDescriptions            Property      System.String[] StatusDescriptions {get;set;}
TimeOfLastConfigurationChange Property      System.String TimeOfLastConfigurationChange {get;set;}
TimeOfLastStateChange         Property      System.String TimeOfLastStateChange {get;set;}
__CLASS                       Property      System.String __CLASS {get;set;}
__DERIVATION                  Property      System.String[] __DERIVATION {get;set;}
__DYNASTY                     Property      System.String __DYNASTY {get;set;}
__GENUS                       Property      System.Int32 __GENUS {get;set;}
__NAMESPACE                   Property      System.String __NAMESPACE {get;set;}
__PATH                        Property      System.String __PATH {get;set;}
__PROPERTY_COUNT              Property      System.Int32 __PROPERTY_COUNT {get;set;}
__RELPATH                     Property      System.String __RELPATH {get;set;}
__SERVER                      Property      System.String __SERVER {get;set;}
__SUPERCLASS                  Property      System.String __SUPERCLASS {get;set;}
ConvertFromDateTime           ScriptMethod  System.Object ConvertFromDateTime();
ConvertToDateTime             ScriptMethod  System.Object ConvertToDateTime();

PS C:\CVS\IteExtensionCode\Virtualization\VirtualizationTest\Tools\Virtualization\Hyper-V\W2K8> .\GetVM.ps1 -vmName 'ITE*'

Host                      VMElementName             State        Up-Time (mS) Owner
--------                  -------------             -----        ------------ -----
T06CORE                   ITE                       Stopped      0
T06CORE                   ITE2                      Stopped      0 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T17:58:53.150

看起来你有一个[`PSObject`](http://msdn.microsoft.com/en-us/library/system.management.automation.psobject%28VS.85%29.aspx)包装字符串：它看起来是正确的（鉴于`out-string`你正在使用）。您需要从`PSObject`具有其`BaseObject5`属性的字符串中提取字符串。

如果您期望`Get-VM`返回的对象集合，请不要使用`Out-String`.

# jakarta-ee - 未调用服务方法

> ID：11673298
> 
> 赞同：0
> 
> 时间：2012-07-26T15:57:06.377
> 
> 标签：jakarta-ee

我被这段代码困住了。然后我运行客户端不显示检查字符串。无法弄清楚为什么这不起作用。也许如果你看看这个可能会发现问题？

```
public class ClientApplicationTest {
    public static void main(String[] args) throws ParseException 
    {
        try
        {
            Context jndi = new InitialContext();

            BoatManagementServiceRemote service = (BoatManagementServiceRemote)
                    jndi.lookup("java:global/BoatManagement/BoatManagementServiceImplementation!com.boatmanagement.service.BoatManagementServiceRemote");

             Client cl = new Client("Mark", "Markus", "Birzu 12-44 Street", "+44 333 666 7", "markoff@test.com");
             service.updateClient(cl);
        }
        catch (NamingException e)
        {
            System.out.println(e);
        }
    }
} 
```

这是我的 BoatManagement 方法：

```
@Stateless
public class BoatManagementServiceImplementation implements BoatManagementServiceRemote 
{   
    @EJB
    private BoatDataAccess dao;

    public void updateClient(Client client) 
    {
        System.out.println("Check!");
        //dao.updateClient(client);
    }
}

@Remote
public interface BoatManagementServiceRemote 
{
    public void updateClient(Client client);
} 
```

所以实际上我的`updateClient`方法根本没有被调用。看不出问题。我使用 Glassfish 并且部署成功。

# objective-c - 如何检查字符串是否以任何字母开头，如 az 或 AZ？

> ID：11673301
> 
> 赞同：4
> 
> 时间：2012-07-26T15:57:11.903
> 
> 标签：objective-c, nsstring

这是上下文

```
if (self.display.text hasPrefix:[NSString stringWithFormat:@"%@ = ", ANYLETTER]) 
```

谢谢马特，我对其进行了一些更改，因此它仍然检查了我拥有的其余格式，现在它可以按预期工作。:)

```
if ([self.display.text rangeOfString:@" = "].location == 1 && [[NSCharacterSet letterCharacterSet] characterIsMember:[self.display.text characterAtIndex:0]]) 
```

编辑：这只是检查第一个字符是否是字母

```
char character = [self.display.text characterAtIndex:0];
if ([[NSCharacterSet lowercaseLetterCharacterSet] characterIsMember:character] || [[NSCharacterSet uppercaseLetterCharacterSet] characterIsMember:character])
{
    //String Starts With a Letter
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T16:02:09.297

```
if ([[NSCharacterSet letterCharacterSet] characterIsMember:[self.display.text characterAtIndex:0]])
{
    // Starts with letter.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:02:01.970

这是一种方法：

```
unichar ch = [[[self display] text] characterAtIndex:0];
BOOL startsWithLetter = (ch >= 'a' && ch <= 'z') || (ch >= 'A' && ch <= 'Z') 
```

您也可以使用正则表达式库/方法进行检查，但上述方法非常简单快捷。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:08:06.003

您可以执行`- (NSRange)rangeOfCharacterFromSet:(NSCharacterSet *)aSet`of`NSString`并通过`[NSCharacterSet letterCharacterSet]`并检查范围的位置是否为 0。

# android - 当片段在 ViewPager 上可见时启动动画

> ID：11673302
> 
> 赞同：5
> 
> 时间：2012-07-26T15:57:20.317
> 
> 标签：android, android-viewpager, fragment, onstart

我将 ViewPager 与 FragmentStatePagerAdapter 一起使用，并且我想在该片段可见且仅在可见时在片段中启动动画。问题是当片段是用户当前看到的片段之后的片段时动画开始。我将动画代码从“onActivityCreated”片段函数移到“onStart”片段函数，甚至移到“onResume”片段函数，但同样的事情发生了。

基本上我需要等待片段成为用户看到的页面才能启动一些代码。我怎样才能做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-26T19:06:02.943

我做到了。

```
 CustomOnPageChangeListener page_listener = new CustomOnPageChangeListener();
    view_pager.setOnPageChangeListener(page_listener);

    ...

    private static class CustomOnPageChangeListener extends SimpleOnPageChangeListener
    {
        @Override
        public void onPageSelected(int position)
        {
            if (position == fragment_position)
            {
                 MyFragment fragment = (MyFragment) fragment_pager_adapter.instantiateItem(view_pager, fragment_position);
                 fragment.startAnimation();
            }

            super.onPageSelected(position);
        }
    } 
```

当然，您必须编写一个*startAnimation()*函数来将动画启动到*MyFragment*代码中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:03:24.853

您是否尝试过使用以下内容：

```
@Override
public void onWindowFocusChanged (boolean hasFocus) {
   super.onWindowFocusChanged(hasFocus);
   if (hasFocus)
      myTextView.startAnimation(anim);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-06-29T14:42:40.283

`setUserVisibleHint`您可以在片段内部覆盖

```
@Override
public void setUserVisibleHint(boolean isVisibleToUser) {
    super.setUserVisibleHint(isVisibleToUser);
    if (mAnimation == null)
        return;

    if (isVisibleToUser) {
        mAnimation.resumeAnimation();
    } else {
        mAnimation.pauseAnimation();
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-15T16:43:30.483

用这个。完美地为 FragmentStatePagerAdapter 工作。

```
@Override
public void setUserVisibleHint(boolean isVisibleToUser) {
  super.setUserVisibleHint(isVisibleToUser);
  if (isVisibleToUser) { 
      // TODO
  }
} 
```

# c# - 多线程; HibernateException，非法尝试将集合与两个打开的会话相关联

> ID：11673303
> 
> 赞同：1
> 
> 时间：2012-07-26T15:57:32.300
> 
> 标签：c#, .net, nhibernate, repository

我对例外有所了解，但不知道如何解决。我的大多数并发线程将使用 SaveOrUpdate 来定位相同的对象图。那么我可以在任何时候只打开一个会话吗？如果是这样，我如何在多个线程上强制执行？

```
public class FnhManagerTS
{
    private static Configuration cfg;
    private static ISessionFactory sessionFactory;
    private static string connectionString;
    [ThreadStatic]
    private static ISession _session = null; 

    private FnhManagerTS() { }

    private static ISession OpenSession()
    {
        // Create a database connection and open a ISession on it.
        return sessionFactory.OpenSession();
    }

    /// <summary>
    /// ThreadStatic ISession.
    /// </summary>
    /// <returns></returns>
    public static ISession Session()
    {
        if (_session != null && _session.IsOpen)
            return _session;
        else
        {
            _session = OpenSession();
            return _session; 
        }
    } 
```

回购：

```
public class GenericRepoTS<T>
    where T : class
{
    private ISession session;

    public GenericRepoTS()
    {
        this.session = FnhManagerTS.Session();
    } 

    public void SaveOrUpdate(IList<T> instances)
    {
        if (instances != null)
        {
            using (ITransaction transaction = session.BeginTransaction())
            {
                try
                { 
                    lock (instances)
                    {
                        foreach (var i in instances)
                        {
                            session.SaveOrUpdate(i);
                        }
                        transaction.Commit();
                    }
                }
                catch (Exception ex)
                {
                    transaction.Rollback(); 
                    Trace.TraceError("GenericRepository.SaveOrUpdate IList<" + typeof(T).ToString() + "> ", ex.ToString());

                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T17:21:10.470

NHibernate 会话不是线程安全的，从逻辑上推论，数据库连接通常也不是。每个线程需要一个会话（连接）。

# objective-c - 核心数据无效规则不起作用？

> ID：11673310
> 
> 赞同：0
> 
> 时间：2012-07-26T15:57:45.473
> 
> 标签：objective-c, ios, core-data

我`Order<-->>Row`与两个关系删除规则都设置为`Nullify`. 但是当我如下删除一行时，它不会从订单的行列表中删除吗？

```
// Prints "1" as there is one row in the order
NSLog(@"Number of children before: %d", order.rows.count);

for (Row *row in order.rows)
    [moc deleteObject:row];

// Prints "1", should be "0"
NSLog(@"Number of children after: %d", order.rows.count); 
```

这可以强制行为，但它不应该是必需的。可能有什么问题？

```
for (Row *row in order.rows)
{
    [moc deleteObject:row];
    [order removeRowsObject:row];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:09:25.707

这不是 nullify 所做的。请改用级联。我在 2 天前回答了一个与此类似的问题，如果您需要更多详细信息，请查看：[删除（更新）cor​​eData 对象](https://stackoverflow.com/q/11631001/1487063)

# internal - sdk manager 上不显示 api 10

> ID：11673315
> 
> 赞同：0
> 
> 时间：2012-07-26T15:58:13.357
> 
> 标签：internal

我的 skd 管理器没有显示任何要下载的新版本，例如 api 10。顶部的“工具”链接只是说“管理插件站点”，有些人建议使用该链接。底部没有“仅显示更新”按钮，因为这是其他有此问题的人的另一个答案。一位回答者说使用帮助菜单，去添加新软件，并为他给出的“添加新站点”链接添加一个特定的网页。下载/安装花了一个多小时，似乎是一个陷阱，因为现在我无法调出 sdk 或 avd 管理器（“尚未在首选项中设置位置”消息）或运行我的项目（“发生内部错误”信息）。我不知道如何修复“发生内部错误”错误。

下载该软件似乎是我让 sdk 显示 api 10 或我还没有的任何 api 的唯一机会。我现在应该完全从下载 Eclipse 开始吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T19:39:03.657

我希望只是删除我的问题，但唯一的选择似乎是“投票删除”，这听起来很消极，好像它会对我的评分产生负面影响。我通过“帮助”并检查更新解决了大部分问题。这下载了一些版本 20.something 更新摆脱了“内部服务器”和“未设置路径”错误。现在我得到一个“androidmanifest.xml 文件丢失！” 消息，即使文件一直存在。所以基本上我把我的问题改成了我希望更容易解决的问题，主要是让 eclipse 像以前一样识别我的清单文件。

# wpf - 采用枚举的依赖属性

> ID：11673319
> 
> 赞同：0
> 
> 时间：2012-07-26T15:58:26.587
> 
> 标签：wpf, enums, dependency-properties

我已经定义了一个依赖属性，它使用枚举来更新按钮的背景颜色。当它运行时，我得到一个“默认值类型与属性类型‘CurrentWarningLevel’不匹配”异常。依赖属性如下：

```
public enum WarningLevels
{
    wlError=0,
    wlWarning,
    wlInfo
};

public class WarningLevelButton : Button
{
    static WarningLevelButton()
    {
    }

    public WarningLevels CurrentWarningLevel
    {
        get { return (WarningLevels)GetValue(WarningLevelProperty); }
        set { base.SetValue(WarningLevelProperty, value); }
    }

    public static readonly DependencyProperty WarningLevelProperty =
      DependencyProperty.Register("CurrentWarningLevel", typeof(WarningLevels), typeof(WarningLevelButton), new PropertyMetadata(false));
} 
```

我正在尝试按如下方式使用该属性：

```
<Trigger Property="local:WarningLevelButton.CurrentWarningLevel" Value="wlError">
    <Setter TargetName="ButtonBody" Property="Background" Value="{StaticResource CtlRedBrush}" />
    <Setter TargetName="ButtonBody" Property="BorderBrush" Value="{StaticResource CtlRedBrush}" />
</Trigger>
<Trigger Property="local:WarningLevelButton.CurrentWarningLevel" Value="wlWarning">
    <Setter TargetName="ButtonBody" Property="Background" Value="{StaticResource GreyGradientBrush}" />
    <Setter TargetName="ButtonBody" Property="BorderBrush" Value="{StaticResource BorderBrush}" />
</Trigger> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:05:13.927

**1）** 因为你不能`false(bool)`投进`WarningLevels`.

请记住，第一个参数`PropertyMetadata`是您的默认值。

**2）**您可能会遇到另一个问题。您的触发值

```
Value="wlError" 
```

是一个字符串，如果没有类型转换器，它也不能转换为枚举。解决这个问题的最简单方法是扩展您的价值：

```
<Trigger Property="local:WarningLevelButton.CurrentWarningLevel" >
    <Trigger.Value>
        <my:WarningLevels>wlError</my:WarningLevels>
    </Trigger.Value>
    <Setter TargetName="ButtonBody" Property="Background" Value="{StaticResource CtlRedBrush}" />
    <Setter TargetName="ButtonBody" Property="BorderBrush" Value="{StaticResource CtlRedBrush}" />
</Trigger> 
```

# javascript - requireJS 优化器不包括嵌套的 require 调用

> ID：11673320
> 
> 赞同：24
> 
> 时间：2012-07-26T15:58:30.623
> 
> 标签：javascript, requirejs

我正在阅读优化器文档很长一段时间，但似乎我无法理解。医生说：

> 优化器只会组合在传递给顶层 require 和 define 调用的字符串文字数组中指定的模块，或者在简化的 CommonJS 包装中组合 require('name') 字符串文字调用。因此，它不会找到通过变量名加载的模块：

好的，到目前为止一切都很好。这基本上意味着*r.js*不会包含也不会抓取嵌套的依赖项。现在假设我们有一个“主应用程序”文件，如下所示：

```
require([ 'es5shim', 'tools' ], function() {
    console.log('fictive app entry point');

    require([ 'domready!' ], function( doc ) {
        console.log('domReady, loading GUI modules...');
        require([ 'GUI/window', 'GUI/header', 'GUI/content' ]);
    });
}); 
```

我想问题在这里变得非常明显。*r.js*`es5shim.js` （优化器）仅通过链接并`tools.js`进入该文件来创建该文件。有没有什么好的方法/解决方法来告诉优化器，它也应该在这个例子中链接`window.js`,`header.js`和文件？`content.js`

当然`domReady`，这个实例中的插件会被加载并最终执行回调，但是这里的结构本身似乎阻止了优化器完成它的工作。

**问题是**：

*   如果我只是在“Top require call”中列出所有模块，*r.js 是否*还会将嵌套和嵌套嵌套模块中的所有 top`require`和调用包含+链接到*main-app*文件中？`define`

**   他们在文档中提到了*r.js的**包含*选项。它在这里有意义吗？如果是这样，如何正确调用它？* 

 **当然，您不希望稍后失去延迟加载模块的选项，但是对于这种依赖（等待 DOMContentLoaded），我希望有一种解决方法。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-08-10T20:02:00.043

默认情况下，RequireJS 不会扫描嵌套的 require 调用，因为它假定这些调用是为了在运行时加载依赖项。您通过设置覆盖它

```
findNestedDependencies: true 
```

在您的优化配置中。希望有帮助。**

# asp.net - 使用vb在asp.net中没有gridview的分页

> ID：11673321
> 
> 赞同：-1
> 
> 时间：2012-07-26T15:58:31.837
> 
> 标签：asp.net, vb.net, pagination, pager

我在 asp.net 中搜索分页示例，通过它我可以为我的项目在线考试制定解决方案，用户可以导航到下一个和上一个问题，并且他/她可以直接移动到特定问题。我用谷歌搜索了这个查询，并使用 gridview 获得了解决方案分页。建议和示例链接将不胜感激，谢谢！

**更新**

```
 <asp:GridView ID="gvUserlist" runat="server" AllowPaging="True" AutoGenerateColumns="False"
            DataKeyNames="Login_Id" DataSourceID="DSUserList" CellPadding="4" ForeColor="#333333"
            GridLines="None" Width="681px">
            <RowStyle BackColor="#EFF3FB" />
            <Columns>

                <asp:BoundField DataField="Login_Id" HeaderText="User Id" ReadOnly="True" SortExpression="Login_Id" />
                <asp:BoundField DataField="User_Type" HeaderText="User Type" SortExpression="User_Type" />
                <asp:BoundField DataField="First_Name" HeaderText="First Name" SortExpression="First_Name" />
                <asp:BoundField DataField="Last_Name" HeaderText="Last Name" SortExpression="Last_Name" />
                <asp:TemplateField>
                    <EditItemTemplate>
                        <asp:CheckBox ID="cbuserid" runat="server" />
                    </EditItemTemplate>
                    <ItemTemplate>
                        <asp:CheckBox ID="cbuserid" runat="server" />
                    </ItemTemplate>
                </asp:TemplateField>
            </Columns>
            <FooterStyle BackColor="#507CD1" Font-Bold="True" ForeColor="White" />
            <PagerStyle BackColor="#2461BF" ForeColor="White" HorizontalAlign="Center" />
            <SelectedRowStyle BackColor="#D1DDF1" Font-Bold="True" ForeColor="#333333" />
            <HeaderStyle BackColor="#507CD1" Font-Bold="True" ForeColor="White" />
            <EditRowStyle BackColor="#2461BF" />
            <AlternatingRowStyle BackColor="White" />
        </asp:GridView>
        <asp:SqlDataSource ID="DSUserList" runat="server" ConnectionString="<%$ ConnectionStrings:JPConnString %>"
            SelectCommand="SELECT User_Login.Login_Id, User_Login.User_Type, User_Login.Login_Status, derivedtbl_1.First_Name, derivedtbl_1.Last_Name FROM User_Login INNER JOIN (SELECT Email_Id, First_Name, Last_Name FROM User_Info UNION SELECT Email_Id, First_Name, Last_Name FROM Emp_Info) AS derivedtbl_1 ON User_Login.Login_Id = derivedtbl_1.Email_Id WHERE (User_Login.Login_Status = @Login_Status)">
            <SelectParameters>
                <asp:Parameter DefaultValue="Activate" Name="Login_Status" Type="String" />
            </SelectParameters>
        </asp:SqlDataSource> 
```

正如我之前提到的，我需要在线考试的分页，用户可以在其中导航到下一个并预览，并且数据将按列而不是按行显示。据我所知，网格视图按行显示数据。

因为，在在线考试系统中，我必须不以表格形式显示该数据，我只需要移动到表格的下一行。我不这么认为，grid-view 将帮助我解决这个问题，因为它以表格形式显示数据

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:10:08.117

威震天。我通常不会为某人写出整个代码，但我今天感觉特别慷慨。

这是我在项目中使用的 VB 寻呼机。这是我在 MVC 应用程序中使用的辅助方法。

```
 ''' <summary>
    ''' Pagers the specified helper.
    ''' </summary>
    ''' <param name="helper">The helper.</param>
    ''' <param name="urlPrefix">The URL prefix.</param>
    ''' <param name="totalRecords">The total records.</param>
    ''' <param name="currentPage">The current page.</param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    <Extension()>
    Public Function Pager(helper As HtmlHelper,
                          urlPrefix As String,
                          totalRecords As Integer,
                          currentPage As Integer) As MvcHtmlString

        ' Get out if we have 5 or less records
        If totalRecords <= 5 Then Return Nothing

        ' Make sure we're not getting invalid pages
        If currentPage <= 0 Then currentPage = 1

        ' Setup our initial variables
        Dim sb1 As New StringBuilder(),
            totalPages = (Math.Round((totalRecords / 5) + 0.5)),
            startingPoint,
            linksAfterCurrent,
            endPoint,
            i

        ' Set boundries for inner link numbers
        Select Case currentPage
            Case totalPages : startingPoint = currentPage - 5
            Case (totalPages - 1) : startingPoint = currentPage - 4
            Case Else : startingPoint = currentPage - 3
        End Select

        Select Case currentPage
            Case 1 : linksAfterCurrent = currentPage + 4
            Case 2 : linksAfterCurrent = currentPage + 3
            Case Else : linksAfterCurrent = currentPage + 2
        End Select

        sb1.Append("<div id=""pagercontainer""><ul class=""pager"">")

        ' Display the previous button and first button
        If currentPage > 1 AndAlso startingPoint >= 1 Then
            If startingPoint > 1 Then sb1.AppendLine([String].Format("<li><a href=""{0}{1}"" title=""go to page {1}"">&laquo;</a></li>", urlPrefix, currentPage - 1))
            sb1.AppendLine([String].Format("<li><a href=""{0}1"" title=""go to page 1"">1</a></li>", urlPrefix))
            If startingPoint > 1 Then sb1.AppendLine("&nbsp;&nbsp;&nbsp;")
        End If

        ' Generate the inner numbers
        i = startingPoint
        While (i < linksAfterCurrent)

            ' This 'if' statement keeps us from building a pager list that's longer than the totalPages.
            If (i >= 0) AndAlso
                (i < totalPages) Then

                ' Build out the inner pager buttons
                sb1.AppendLine([String].Format("<li><a href=""{0}{1}"" {2} title=""go to page {1}"">{1}</a></li>",
                                                urlPrefix,
                                                i + 1,
                                                If(i + 1 = currentPage, "class=""youarehere""", String.Empty)))
            End If

            i += 1
        End While

        endPoint = i

        ' Display the next button and the last button
        If (currentPage < endPoint) AndAlso
            (endPoint < totalPages) Then
            If endPoint < totalPages - 1 Then sb1.AppendLine("&nbsp;&nbsp;&nbsp;")
            sb1.AppendLine([String].Format("<li><a href=""{0}{1}"" title=""go to page {1}"">{1}</a></li>", urlPrefix, totalPages.ToString()))
            If endPoint < totalPages - 1 Then sb1.AppendLine([String].Format("<li><a href=""{0}{1}"" title=""go to page {1}"">&raquo;</a></li>", urlPrefix, currentPage + 1))
        End If

        sb1.Append("</ul></div><div class=""clear""></div>")

        Return MvcHtmlString.Create(sb1.ToString())
    End Function

    ''' <summary>
    ''' Pagers the specified helper.
    ''' </summary>
    ''' <param name="helper">The helper.</param>
    ''' <param name="urlPrefix">The URL prefix.</param>
    ''' <param name="totalRecords">The total records.</param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    <Extension()>
    Public Function Pager(helper As HtmlHelper,
                          urlPrefix As String,
                          totalRecords As Integer) As MvcHtmlString
        Return helper.Pager(urlPrefix, totalRecords, 1)
    End Function 
```

这就是我如何使用它

```
 @Html.Pager("?page=", Model.TotalEvents, Model.PageNumber) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:03:44.450

听起来是您的`DetailsView`完美选择。它旨在显示单个元素，但您仍然可以将其绑定到元素列表并向前和向后导航。

# javascript - 为动态表行编号

> ID：11673322
> 
> 赞同：1
> 
> 时间：2012-07-26T15:58:37.327
> 
> 标签：javascript, jquery, html

我正在使用 jQuery 制作动态 HTML 表格。在一个表中，我的用户有两个交互：

1.  追加一行
2.  删除特定行

对行进行编号的问题在于，如果用户删除了特定行，则该行之后的所有行都需要重新编号。我必须选择删除行之后的所有行并将它们的数量减去 1。

有没有更好的方法来解决这个问题？

编辑：这是一个演示问题的 JSFiddle：http: [//jsfiddle.net/LNXae/2/](http://jsfiddle.net/LNXae/2/)

我知道有序列表会自动重新编号我的行，但我宁愿使用表格，因为我现在给出的示例非常简单。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:21:49.687

[http://jsfiddle.net/mblase75/LNXae/1/](http://jsfiddle.net/mblase75/LNXae/1/)

首先，将计数器编号包装在`<span>`一个类中，以便稍后查找：

```
$new_row.children('td').prepend('Row #<span class="num">' + ($new_row.index() + 1) + "</span>"); 
```

`.each`然后在删除所需的行后使用循环更新所有这些跨度。传递给`.each`的回调函数的第一个参数是一个从零开始的索引号，第二个是 HTML 元素：

```
 var $row = $(this).closest('tr'),
        $table = $row.closest('table');
    $row.remove();

    $table.find('tr').each(function(i, v) {
        $(v).find('span.num').text(i + 1);
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:02:40.980

在用户添加一行或删除一行后，您只需要遍历“数字”单元格。如果我们假设您有一个`<td>`元素，我们：

1) 给他们一个漂亮的ID，例如`row_0`，`row_1`等...

2）编写一个函数来迭代它们：

```
function updateRows(){
    $('[id*="row_"]').each(function(index){
        $(this).html(index + 1); // add +1 to prevent 0 index.
    };
}; 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-07-26T16:09:24.383

我已经编写了一个 jquery 插件，它正是这样做的，你不应该需要对行本身进行“编号”。删除行时，您需要做的就是传递被删除行的*索引*。

例如，如果您连续有一个删除按钮：

```
<table>
 <tr>
    <td> <input type="button" class="delete" value="delete this row" /></td>
 </tr>
</table> 
```

jQuery 可能看起来像

```
$('.delete').click(function(){
 var index = $(this).parents('tr').index();
 // tell your plugin to delete row "index"
}); 
```

*我的*插件中执行此操作的方法如下所示：

```
removeRow: function (index) {
        return this.each(function () {
            var $this = $(this);
            var $tbody = $('tbody', $this);
            var $tr = $('tr', $tbody).eq(index);
            $this.trigger('rowRemoved', [$tr]);
            $tr.remove();
        });
    } 
```

# salesforce - Salesforce 测试失败但在系统上工作

> ID：11673323
> 
> 赞同：1
> 
> 时间：2012-07-26T15:58:43.153
> 
> 标签：salesforce

我已经为 Saleforce 触发器编写了一个测试。`Account_Status_Change_Date__c`每当“Account_Status__c”更改时，触发器会将值更改为当前日期。

我已经通过 Web GUI 实际更改了帐户状态的值，并且帐户状态更改日期确实设置为当前日期。但是，我的测试代码似乎没有触发这个触发器。我想知道人们是否知道这样做的任何原因。

我的代码如下：

```
@isTest
public class testTgrCreditChangedStatus {

    public static testMethod void testAccountStatusChangeDateChanged() {

        // Create an original date
        Date previousDate = Date.newinstance(1960, 2, 17);

        //Create an Account
        Account acc = new Account(name='Test Account 1');
        acc.AccountNumber = '123';
        acc.Customer_URN_Number__c = '123';
        acc.Account_Status_Change_Date__c = previousDate;
        acc.Account_Status__c = 'Good';
        insert acc;

        // Update the Credit Status to a 'Bad Credit' value e.g. Legal
        acc.Account_Status__c = 'Overdue';
        update acc;

        // The trigger should have updated the change date to the current date
        System.assertEquals(Date.today(), acc.Account_Status_Change_Date__c);
    }
}

trigger tgrCreditStatusChanged on Account (before update) {

    for(Account acc : trigger.new) {
        String currentStatus = acc.Account_Status__c;
        String oldStatus = Trigger.oldMap.get(acc.id).Account_Status__c;

        // If the Account Status has changed...
       if(currentStatus != oldStatus) {
            acc.Account_Status_Change_Date__c = Date.today();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:05:36.837

您不需要触发器来执行此操作。可以通过 Account 上的简单工作流规则来完成。但是，您的测试代码的问题是您需要在更新后查询帐户以获取帐户字段中的更新值。

```
public static testMethod void testAccountStatusChangeDateChanged() {

    ...
    insert acc;

    Test.StartTest();
    // Update the Credit Status to a 'Bad Credit' value e.g. Legal
    acc.Account_Status__c = 'Overdue';
    update acc;
    Test.StopTest();

    acc = [select Account_status_change_date__c from account where id = :acc.id];
    // The trigger should have updated the change date to the current date
    System.assertEquals(Date.today(), acc.Account_Status_Change_Date__c);
} 
```

# vba - 全局变量在启动时不可用

> ID：11673328
> 
> 赞同：0
> 
> 时间：2012-07-26T15:59:16.147
> 
> 标签：vba, powerpoint, powerpoint-2010

我在启用宏的 PowerPoint 2010 演示文稿中附加了以下 VBA 代码：

```
Public CurrentSlideIndex As Integer

Sub OnSlideShowPageChange()
    CurrentSlideIndex = ActivePresentation.SlideShowWindow.View.CurrentShowPosition
    If CurrentSlideIndex = 1 Then
        MsgBox "First Page"
        ' some initialization
    End If
End Sub 
```

我想在显示第一页时在那里进行一些初始化。问题是当我第一次运行演示文稿时，例程没有被触发。我需要停止演示并再次运行它，然后它就可以工作了，之后也继续工作。只有第一次运行不起作用。

有解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T19:02:51.340

我将对代码进行一些更改：

```
Public CurrentSlideIndex As Long

Sub OnSlideShowPageChange(ByVal SSW As SlideShowWindow)
    CurrentSlideIndex = SSW.View.CurrentShowPosition
    If CurrentSlideIndex = 1 Then
        MsgBox "First Page"
        ' some initialization
    End If
End Sub 
```

然后（谢谢你，汉斯霍夫曼： [http](http://www.tech-archive.net/Archive/Office/microsoft.public.powerpoint/2006-02/msg01234.html) ://www.tech-archive.net/Archive/Office/microsoft.public.powerpoint/2006-02/msg01234.html ）在第一个上放一个虚拟的active-x控件幻灯片（或者实际上只是关闭第一张幻灯片，因此它不会出现在节目中）。

这显然迫使 VBA 初始化，瞧，事件处理程序触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T18:11:09.113

庞培，

尝试这样的事情：

```
Sub OnSlideShowPageChange(ByVal SlideSet As SlideShowWindow)
    If SlideSet.View.CurrentShowPosition = _
        SlideSet.Presentation.SlideShowSettings.StartingSlide Then
        MsgBox "I am a Message."
    End If
End Sub 
```

保存模块中的代码，从头开始运行powerpoint。我在 2007 年运行过它，所以我相信它会在 Powerpoint 2007 或 2010 中正常运行。

您还可以使用此代码为其他幻灯片放映位置编写模块。查看 MSDN 文档以获取更完整的可能性列表：2007 -- [http://msdn.microsoft.com/en-us/library/bb265987(v=office.12).aspx](http://msdn.microsoft.com/en-us/library/bb265987(v=office.12).aspx)

2010 -- [http://msdn.microsoft.com/en-us/library/ff746846.aspx](http://msdn.microsoft.com/en-us/library/ff746846.aspx)

~乔尔

# android - AdMob 导入无法解决

> ID：11673329
> 
> 赞同：1
> 
> 时间：2012-07-26T15:59:22.667
> 
> 标签：android, admob

我正在尝试让 AdMob 与我的 android 应用程序一起工作，但遇到了一些麻烦。我已经在清单和 project.properties 中将目标 sdk 更改为 15，并且我已经在清单中声明了 AdActivity，但它仍然无法识别我活动中的 import com.google.ads.*。我怎样才能让它工作？

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.app.firstapp"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
<application
    android:icon="@drawable/blue_ship"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" 
    >
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main"
        android:screenOrientation="landscape" 
        android:configChanges="keyboardHidden|orientation"
        android:theme="@android:style/Theme.NoTitleBar.Fullscreen">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity android:name="com.app.firstapp.StartGame"
        android:screenOrientation="landscape"
        android:configChanges="keyboardHidden|orientation"
        android:theme="@android:style/Theme.NoTitleBar.Fullscreen"/>
    <activity android:name="com.google.ads.AdActivity"
         android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize"/>/> 
</application>
</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:04:27.350

您应该将目标设置为 Google API，并且需要添加 Admob sdk lib/jar 而不是 Android 目标。

1）右键单击项目>属性>Android>项目构建目标。

从目标窗口中选择 Google Api 的（供应商名称是 Google inc 那里）

2）通过Config build path选项在你的项目中添加admob sdk lib，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:05:43.113

您是否在项目的 libs 文件夹中添加了 admob sdk？

还需要添加构建路径。

做好以上步骤，你的问题就解决了

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T02:27:04.940

确保您遵循本[教程](https://developers.google.com/mobile-ads-sdk/docs/android/fundamentals)的所有步骤并正确选择项目的构建目标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-22T16:11:05.147

非常令人沮丧，但只是清理项目就解决了这个问题。

# ruby-on-rails - Rails ActiveRecord 关系助手如何允许诸如 `user.groups.new` 之类的方法？

> ID：11673330
> 
> 赞同：1
> 
> 时间：2012-07-26T15:59:27.270
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, ruby-on-rails-3.2

在 Rails 中，我创建了一个从 LDAP 数据库而不是 ActiveRecord 检索用户的模型。现在我正在尝试将我的 ActiveRecord 模型与基于 LDAP 的模型集成，因此我正在我的模型中编写方法来模拟一些常见的 ActiveRecord 方法。

我试图模仿的方法之一是通常由 has_many 通过 ActiveRecord 上的关系创建的方法。在 ActiveRecord 中，这种关系将允许以下内容：

```
user = User.first
groups = user.groups # == Array of Groups
groups << Group.create(name: "Test") # How does Rails allow this? 
```

Rails 究竟是如何允许这样做的？我尝试将方法动态分配给 user.groups 返回的数组实例，但似乎没有任何方法可以让这些方法知道数组是从哪个用户记录创建的。（所以他们可以分配`user_id`新的关系记录。）我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:28:50.757

虽然`user.groups`看起来是一组组，但它实际上是一个完全独立的类——一个 Rails 内部类，您通常不太了解它，称为关联代理。代理通过将请求代理到目标类，然后适当地设置关联来响应诸如`<<`、等方法。`create``new`

如果您想要类似的功能，则必须实现自己的代理关联。这样做会非常复杂，但这可能会让你开始。

```
module LDAP
  class Association
    attr_accessor :source, :target

    def initialize(source, target)
      @source = source
      @target = target
    end

    def <<(obj)
      @source.group_ids = [group_ids + obj].flatten.uniq
      @source.save
    end

  end
end

class User
  def groups
    LDAP::Association.new(self, Group)
  end
end 
```

这甚至不是特别接近 ActiveRecord 实现关联代理的方式。但是，这比 ActiveRecord 的解决方案要简单得多，应该足以复制一些基本的 ActiveRecord 功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:36:02.807

我会通过查看 Rails 源代码来实现这一点，例如上面 Group.create 示例的代码可以在

[http://api.rubyonrails.org/classes/ActiveRecord/Persistence/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/Persistence/ClassMethods.html)

```
 def create(attributes = nil, options = {}, &block)
    if attributes.is_a?(Array)
      attributes.collect { |attr| create(attr, options, &block) }
    else
      object = new(attributes, options, &block)
      object.save
      object
    end
  end
end 
```

# javascript - 无法将值从实例对象传输到父类的实例数组

> ID：11673332
> 
> 赞同：0
> 
> 时间：2012-07-26T15:59:41.873
> 
> 标签：javascript, google-closure-library

我有一个 JS 类，我在其中实例化一个 goog.net.XhrIo 对象。现在我可以从那个 JS 变量中得到我需要的所有东西，问题是每当我尝试将值分配给“父”类的实例变量时，我都会得到一个未定义的错误。我认为这是一个范围界定问题，但我不知道如何处理它。我正在使用 Google Closure 库。代码可以在以下位置找到：

[主 JS 文件](http://www.niuzly.com/ajax/niuzly.main.js)

我正在尝试将 POST 请求的所有结果存储在 this.items 对象/数组中。行号为 270。如果您在浏览器中查看此内容，请搜索“console.log(this.mainView);” 它会带你直接找到问题所在。

```
goog.net.XhrIo.send(this.URL+'/action.url.php', function(e){
    var items = new Object();
    items = e.target.getResponseJson();
    for(var x in items)
    {
        var currentName;
        var currentCat;
        if(items.hasOwnProperty(x))
        {
            currentName = items[x].name;
            currentCat = items[x].categories;
        }
        var x = goog.dom.createDom('div', {
        }, currentName, currentCat);
        console.log(this.mainView);
    }
    return e;
},'POST', 'action=getUserData'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:02:51.487

尝试将处理程序绑定到对象[`goog.bind`](http://closure-library.googlecode.com/svn/docs/closure_goog_base.js.html#goog.bind)：

```
goog.net.XhrIo.send(this.URL+'/action.url.php', goog.bind( function(e){
    var items = new Object();
    items = e.target.getResponseJson();
    for(var x in items)
    {
        var currentName;
        var currentCat;
        if(items.hasOwnProperty(x))
        {
            currentName = items[x].name;
            currentCat = items[x].categories;
        }
        var x = goog.dom.createDom('div', {
        }, currentName, currentCat);
        console.log(this.mainView);
    }
    return e;
}, this),'POST', 'action=getUserData'); 
```

# d3.js - 树绘制方向

> ID：11673335
> 
> 赞同：17
> 
> 时间：2012-07-26T16:00:21.780
> 
> 标签：d3.js, hierarchy

我使用树形布局做了一个稍微修改过的树。我需要将树从右到左定向，而不是默认的从左到右的常规方向。什么是正确和正确的 d3:ish 方式来做到这一点？

我最终通过在创建布局后简单地反转 x 坐标来做到这一点，但我觉得这是一个 hack。肯定有更优雅的东西吗？

我考虑过围绕中心进行 SVG 旋转，但随后我必须旋转标签才能正确显示文本。那感觉也不对。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-07-26T20:12:37.610

The tree layout computes node positions in **an arbitrary coordinate space of breadth (*x*) and depth (*y*)**. To change the orientation of the layout, change the mapping from the layout’s coordinate space to SVG pixel coordinates. If you prefer not to do the mapping manually, you could use [quantitative scales](https://github.com/d3/d3/blob/master/API.md#scales-d3-scale) to specify a more intuitive (but more verbose) mapping.

Here’s an example showing four different orientations:

*   [http://bl.ocks.org/3184089](http://bl.ocks.org/3184089)

# maven - 编写eclipse .classpath时如何让m2e插件忽略资源过滤

> ID：11673337
> 
> 赞同：2
> 
> 时间：2012-07-26T16:00:24.323
> 
> 标签：maven, classpath, m2eclipse, m2e

当 eclipse(indigo) 中的 m2e(1.1.0) 更新项目配置时，它会更改我的资源文件夹的条目以排除所有内容。

```
<classpathentry excluding="**" kind="src" output="target/classes" path="conf"/> 
```

但我需要以下内容才能成功运行测试：

```
<classpathentry kind="src" output="target/classes" path="conf"/> 
```

我想从我的 jar 中排除一些资源（例如 license.foo），但我需要其中许多文件位于 eclipse 类路径中以启用测试执行。

解决这个问题的正确方法是什么？

*   我的 pom 中是否有 org.eclipse.m2e 的设置来改变行为？
*   我可以在 .project/.classpath 中添加文本以通知 m2e 这必须保留吗？
*   我应该使用配置文件来更改存储在罐子中的内容吗？

你是如何处理这类问题的？（仅供参考，这类似于[MNGECLIPSE-864](https://issues.sonatype.org/browse/MNGECLIPSE-864)）

谢谢

彼得

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:20:43.210

您应该将运行时需要的资源放置到

```
src/main/resources 
```

和您只需要进行测试的资源

```
src/test/resources 
```

这是[Maven 标准目录布局](http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html)，资源将位于类路径中。

如果你没有标准目录，你应该使用[Maven Build Helper Plugin](http://mojo.codehaus.org/build-helper-maven-plugin/)添加[额外的（测试）资源目录](http://mojo.codehaus.org/build-helper-maven-plugin/usage.html#Add_more_resource_directories_to_your_project)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T18:43:48.193

如果您遇到这个问题，那么您可能想问**“为什么我希望 eclipse 和命令行 maven 以不同的方式处理资源”。**

我认为这个问题源于希望将不需要的项目（例如，许可证文件）从运输罐中取出。然而，正如**FrVaBe**指出的那样，**测试资源**很好地满足了这一需求。

我对汇编文件和 pom 进行了一些挖掘，以发现它们之间的竞争规范将 conf 目录移动到 target/classes 中，忽略它并将原始源位置导入到 pom.xml 中。我解开了复杂性，并有一个更简单的 pom 以更标准的方式处理资源。

谢谢您的帮助

彼得

# jpeg - 使用 Persits Jpeg，有没有办法根据文本和图像大小确定设置字体的大小

> ID：11673340
> 
> 赞同：1
> 
> 时间：2012-07-26T16:00:35.137
> 
> 标签：jpeg

我正在使用 Persits.Jpeg 图像处理工具。

我想在其中添加文本 - 文本可以是任意长度。

我希望文本填充图像的宽度 - 我可以获得图像宽度。

我可以设置字体大小，将文本放在图像上，然后获取文本的宽度，但是图像上的文本大小错误。

有没有一种方法可以在不将其放在图像上的情况下计算出文本的宽度，或者是否可以删除刚刚添加的文本。是的，我知道我可以重新加载图像，但我试图避免这种情况，因为它是过程密集型的，并且在成功调整每段文本的大小后我必须继续保存它。

# database - html5sql.process 里面的 for 循环

> ID：11673342
> 
> 赞同：1
> 
> 时间：2012-07-26T16:00:42.140
> 
> 标签：database, html, sqlite, jquery-mobile, cordova

我正在使用 jQuery mobile 1.1.1 和 PhoneGap 开发一个 iPad 应用程序。我`html5sql.js`用来做我的数据库操作，它工作正常。

如何`html5sql.process()`在 for 循环中使用？

前任：

```
html5sql.process( {
                    "sql": "select id,count from my_table",
                     "data": [],
                      "success": function(transaction, results){        
                    },  
                     function(transaction, results){

                        for(var i = 0; i < results.rows.length;i++){

                             /// Line 5
                 html5sql.process( {
                                      "sql": "select count(*) from my_table1 where id= ?",
                                    "data": [results.rows.item(i).id],
                                     "success": function(transaction, resultsD){        
                                 },  
                                      function(transaction, resultsD){

                                            if(results.rows.item(i).count == resultsD.rows.length){
                                  //do my task

                            }
                                       },function(){}
                                    );
                                 }
                           },function(){}
                       ); 
```

我没有从这段代码中得到任何输出。当我检查它时，它只工作到第 5 行。之后的代码不起作用。什么可能导致问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T16:22:44.443

看来，您的代码的整个结构是错误的。您不应该在循环内部而是在外部请求数据库。这是我的代码中的一个块，它生成了一个 jQM 列表视图。查询结果被放入一个数组中，javascript 从中解析出实际的 HTML 代码。希望能帮助到你

```
function showRecords() {
    document.getElementById('results').innerHTML = '<li data-role="list-divider">Header</li>';
    db.transaction(function(tx) {
      tx.executeSql("SELECT * FROM OrderList", [], function(tx, result) {
         for (var i = 0, item = null; i < result.rows.length; i++) {
            item = result.rows.item(i);
            document.getElementById('results').innerHTML += 
             '<li data-role="fieldcontain" class="ui-field-contain ui-body ui-br ui-li ui-li-static ui-body-c">'
            +'<a href="#"><p style="font-weight:bold;">'+item['catNo']+'</p>'
            +'.......................
            +'</li>';  
          }     
          $('#results').listview('refresh',true);
      });
   });
} 
```

# jacoco - JaCoCo 无法添加具有相同名称的不同类：org/hamcrest/BaseDescription

> ID：11673356
> 
> 赞同：35
> 
> 时间：2012-07-26T16:01:21.530
> 
> 标签：jacoco

嗨，我在运行 JaCoCo 覆盖时遇到以下异常：

```
 <plugin>
        <groupId>org.jacoco</groupId>
        <artifactId>jacoco-maven-plugin</artifactId>
        <version>0.5.8.201207111220</version>
        <executions>
            <execution>
                <goals>
                    <goal>prepare-agent</goal>
                </goals>
            </execution>
            <execution>
                <id>report</id>
                <phase>prepare-package</phase>
                <goals>
                    <goal>report</goal>
                </goals>
            </execution>
        </executions>
    </plugin> 
```

* * *

```
Error while creating report: Can't add different class with same name: org/hamcrest/BaseDescription
java.lang.IllegalStateException: Can't add different class with same name: org/hamcrest/BaseDescription
    at org.jacoco.core.analysis.CoverageBuilder.visitCoverage(CoverageBuilder.java:89)
    at org.jacoco.core.analysis.Analyzer$1.visitEnd(Analyzer.java:79)
    at org.objectweb.asm.ClassAdapter.visitEnd(Unknown Source)
    at org.jacoco.core.internal.flow.ClassProbesAdapter.visitEnd(ClassProbesAdapter.java:128)
    at org.objectweb.asm.ClassReader.accept(Unknown Source)
    at org.objectweb.asm.ClassReader.accept(Unknown Source)
    at org.jacoco.core.analysis.Analyzer.analyzeClass(Analyzer.java:94)
    at org.jacoco.core.analysis.Analyzer.analyzeClass(Analyzer.java:115)
    at org.jacoco.core.analysis.Analyzer.analyzeAll(Analyzer.java:155)
    at org.jacoco.core.analysis.Analyzer.analyzeArchive(Analyzer.java:135)
    at org.jacoco.core.analysis.Analyzer.analyzeAll(Analyzer.java:158)
    at org.jacoco.core.analysis.Analyzer.analyzeAll(Analyzer.java:183)
    at org.jacoco.maven.ReportMojo.createBundle(ReportMojo.java:280)
    at org.jacoco.maven.ReportMojo.createReport(ReportMojo.java:256)
    at org.jacoco.maven.ReportMojo.executeReport(ReportMojo.java:230)
    at org.jacoco.maven.ReportMojo.execute(ReportMojo.java:208)
    at org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginManager.java:490)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:694)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalWithLifecycle(DefaultLifecycleExecutor.java:556)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoal(DefaultLifecycleExecutor.java:535)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandleFailures(DefaultLifecycleExecutor.java:387)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegments(DefaultLifecycleExecutor.java:348)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.execute(DefaultLifecycleExecutor.java:180)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:328)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:138)
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:362)
    at org.apache.maven.cli.compat.CompatibleMain.main(CompatibleMain.java:60)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.classworlds.Launcher.launchEnhanced(Launcher.java:315)
    at org.codehaus.classworlds.Launcher.launch(Launcher.java:255)
    at org.codehaus.classworlds.Launcher.mainWithExitCode(Launcher.java:430)
    at org.codehaus.classworlds.Launcher.main(Launcher.java:375) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-22T07:58:27.640

有两种方法可以避免这种情况：

**1）重命名其中一个重复项**：当涉及到 maven 项目时，我经常看到这个问题。即使这两个类位于两个不同的模块中，两个不同的类具有相同的名称也不是一个好主意。

**2）排除其中之一**：有关更多信息，请参阅[此](https://stackoverflow.com/questions/9133116/jacoco-test-coverage-how-to-exclude-a-class-inside-jar-from-report)SO 线程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-05-13T14:31:43.810

- 文件夹中的某些 jar 或项目文件`target`通常会导致此问题。这就是我们的 maven 项目中解决问题的方法（请参阅[Sanjay](https://stackoverflow.com/questions/11673356/jacoco-cant-add-different-class-with-same-name-org-hamcrest-basedescription/65885458#65885458)对 gradle 的回答）：

```
 <plugin>
            <groupId>org.jacoco</groupId>
            <artifactId>jacoco-maven-plugin</artifactId>
            <version>0.8.7</version>
            <configuration>
                <excludes>**/*.jar</excludes>
            </configuration>
        </plugin> 
```

请注意，这是适用于我们特定项目的最简单的解决方案。如果您需要进行其他排除，请`<exclude>`按如下方式包装多个 -command：

```
 <configuration>
                <excludes>
                    <exclude>**/*.jar</exclude>
                    <exclude>naughty-dependency/**/*.class</exclude>
                </excludes>
            </configuration> 
```

**请注意**，此配置部分不会故意将 JaCoCo 附加到任何`<execution>`-goals。这样，当 JaCoCo 跌倒时，默认打包过程不会中断，并且运行速度也稍快。报告只会在发布时生成`mvn org.jacoco:jacoco-maven-plugin:prepare-agent test jacoco:report`，例如我们在 gitlab CI-pipeline 中执行的操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-13T21:59:00.840

我同意 rb512。另一个可能出现此错误的情况/区域是，在编译过程中，如果我们使用 JIBX/WST 等或类似的其他步骤/过程创建动态类文件（在编译时），即我们没有任何有效的对应工作区中的源文件（.java/.groovy 等）。

在这种情况下，您的工作区将有额外的类文件，当 jacoco 尝试生成报告时，它会因重复类的相同错误而出错。如果由于这种情况而发现此错误，则必须在运行 jacoco 报告之前删除所有类文件

如果您使用的是 Gradle（对于 Maven，请在 Maven pom .xml 文件中执行相同操作），请参阅`doFirst`下面的块。

```
 jacocoTestReport {
      //cleaning up the JiBx classes to jacoco will not cause problems for CareDiscovery
      doFirst {
             delete fileTree (dir: "${buildDir}/classes", include: "**/JiBX_*.class")
      }
      group = "Reporting"
      description = "Generate Jacoco coverage reports after running tests."

      executionData = fileTree(dir: 'build/jacoco', include: '**/*.exec')

      reports {
             xml{
                 enabled true
                 //Following value is a file
                 destination "${buildDir}/reports/jacoco/xml/jacoco.xml"
             }
             csv.enabled false
             html {
                 enabled true
                 //Following value is a folder
                 destination "${buildDir}/reports/jacoco/html"
             }
      }

      sourceDirectories = files(['src/java','src/main/java', 'src/main/groovy'])
      classDirectories =  files('build/classes/main')
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-25T13:12:44.580

就我而言，问题是由于项目 Jar artefact 中的类而发生的。

```
 Caused by: java.io.IOException: Error while analyzing /opt/jenkins/workspace/MicroService-M_build/microservice/dev/microservice/build/gen/main/resources/uploadassets/myCustomProject.jar@org/apache/commons/beanutils/BasicDynaBean.class.
Caused by: java.lang.IllegalStateException: Can't add different class with same name: org/apache/commons/beanutils/BasicDynaBean
    at org.jacoco.core.analysis.CoverageBuilder.visitCoverage(CoverageBuilder.java:107) 
```

以下是从 jacoco 测试报告中排除自定义 jar 的 gradle taks

```
jacocoTestReport {
        doFirst {
            delete fileTree (dir: "${buildDir}/gen/main/resources/uploadassets", include: "myCustomProject.jar")
        }
        reports {
            xml.enabled true
        }
    } 
```

这解决了我的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-14T18:29:15.473

我遇到了和你一样的问题。事实证明，我的项目文件夹中有两个 jars 做了同样的事情，即使其中只有一个在构建路径中。检查您的代码中是否有多个 hamcrest jar。

# java - JMS AUTO_ACKNOWLEDGE 何时确认？

> ID：11673361
> 
> 赞同：30
> 
> 时间：2012-07-26T16:01:33.310
> 
> 标签：java, jms, messaging

我试图用谷歌搜索这个，但没有成功。如果我正在使用`AUTO_ACKNOWLEDGE`，并且我有一个用 Java 编写的消费者客户端，那么何时确认消息？我正在使用一个`MessageListener`包含方法的`onMessage`方法。`onMessage`确认是否在完成之前或之后`onMessage`或在其他时间发送回服务器？提前感谢任何人能够提供的任何帮助！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-07-26T16:35:15.143

请检查这个[（](https://web.archive.org/web/20191101094431/http://www2.sys-con.com:80/itsg/virtualcd/Java/archives/0604/chappell/index.html) *用作文章的 Wayback Machine 链接自 2020 年起下线）*

使用`AUTO_ACKNOWLEDGE`模式，确认总是在`onMessage()`处理程序返回后隐式发生的最后一件事。`CLIENT_ACKNOWLEDGE`接收消息的客户端可以通过指定消费会话的模式来对保证消息的传递进行更细粒度的控制。

的使用`CLIENT_ACKNOWLEDGE`允许应用程序控制何时发送确认。例如，应用程序可以确认消息 - 从而减轻 JMS 提供者的职责 - 并对由消息表示的数据执行进一步处理。关键是 Message 对象上的 acknowledge() 方法，如清单 1 所示。

该`acknowledge()`方法通知 JMS 提供者消息已被消费者成功接收。如果在确认过程中发生提供程序故障，此方法将向客户端抛出异常。提供程序失败会导致 JMS 服务器保留消息以进行重新传递。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-12-17T07:29:14.617

**CLIENT_ACKNOWLEDGE**
使用这种确认模式，客户端通过调用消息的确认方法来确认已消费的消息。

```
Session session = connection.createSession(false, Session.CLIENT_ACKNOWLEDGE);
...
msg = (TextMessage) consumer.receive();
//acknowledge
msg.acknowledge(); 
```

**AUTO_ACKNOWLEDGE**
使用这种确认模式，当会话从接收调用成功返回或会话调用以处理消息的消息侦听器成功返回时，会话自动确认客户端收到消息。

```
Session session = connection.createSession(false,Session.AUTO_ACKNOWLEDGE); 
```

[最好](http://docs.oracle.com/javaee/7/api/javax/jms/Session.html)
[的例子](http://examples.javacodegeeks.com/enterprise-java/jms/jms-client-example/)

# php - 如何确保页面是 index.php 和 !isset($_GET) 用于导航突出显示

> ID：11673363
> 
> 赞同：0
> 
> 时间：2012-07-26T16:01:34.127
> 
> 标签：php, nav

当页面是链接指向的位置时，我正在突出显示我的导航链接。但是，因为我的一些链接只是带有**GET**变量的 index.php，所以我很难将其与 index.php 区分开来。

例如`index.php`和`index.php?get=**`with`$_SERVER['PHP_SELF']`都是`/index.php`。如何确保页面在 index.php 中没有任何 get 变量？

这是我的导航突出显示代码。

```
<?php
if( $_SERVER['PHP_SELF'] == '/index.php'
    &&
    ! isset($_GET)
)
{ echo 'class="white"'; } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:03:32.670

您可以像这样检查 $_GET 是否为空：

```
if(empty($_GET)) {
    // there are no GET paramas set this is index.php
} else {
    // there are GET params set
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:16:01.510

因为`$_GET`是一个（超全局）数组，您可以检查[`count()`](http://de.php.net/count)是否设置了元素。

```
if(count($_GET) == 0) {
  // index.php
} else {
  // get params ...
} 
```

# xml - RDF/XML - 类的正确语法

> ID：11673364
> 
> 赞同：0
> 
> 时间：2012-07-26T16:01:39.813
> 
> 标签：xml, rdf

只是想了解一下 RDF 语句。给定一些命名空间：

```
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
     xmlns:ex="http://example.org/#"
     xmlns:people="http://example.org/people/#"
> 
```

语句之间有什么区别：

```
<rdf:Description rdf:about="people:James_Brown">
    <rdf:type rdf:resource="ex:person"> 
</rdf:Description> 
```

和：

```
<ex:person rdf:resource="people:James_Browm" /> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T17:21:57.977

和

```
<?xml version="1.0"?>
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
     xmlns:ex="http://example.org/#"
     xmlns:people="http://example.org/people/#"
>
<ex:person rdf:resource="people:James_Browm" />
</rdf:RDF> 
```

[W3C 验证器](http://www.w3.org/RDF/Validator/)返回：

```
Error: {E201} rdf:resource not allowed as attribute here.[Line = 6, Column = 48] 
```

它应该是：

```
<?xml version="1.0"?>
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
     xmlns:ex="http://example.org/#"
     xmlns:people="http://example.org/people/#"
>
<ex:person rdf:about="people:James_Browm" />
</rdf:RDF> 
```

RDF 是三元组（主题、谓词、宾语），@resource 是主题的 URI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T17:20:01.720

我不知道你想表达什么样的观点，但我很确定这两种说法彼此完全不同。命名空间通常是附加到标签的前缀，例如`<c:name>Bill Gates</c:name>`在这种情况下命名空间是 c。您正试图以某种方式将名称空间组合到您的实际节点的值中，这不是正确的方法。每当您在引号中引用某些内容时`"people:James_Brown"`您是说将整个语句视为该节点的值。因此，您在内部拥有的任何命名空间引用都是无用的。命名空间更多地用于将一组节点组合在一起，而不是像您所做的那样尝试标记每个数据条目。我建议四处浏览并寻找一些示例 XML 文档以查看名称空间/值关系，因为我认为您在这里拥有的不是标准的。再说一次，我也是新手，可能完全错了。

# facebook - Facebook API 触发密码更改

> ID：11673367
> 
> 赞同：2
> 
> 时间：2012-07-26T16:01:47.560
> 
> 标签：facebook, passwords, lastpasswordset

我想知道是否有人知道 Facebook API 是否能够触发标志，让用户更改密码。

推理：PCI 合规性。我想通过 OAuth 2.0 集成 facebooks API，但是，我正在处理的应用程序必须符合 PCI 标准，这意味着必须每 90 天更改一次密码......有什么想法吗？

此外，OAuth 2.0 是否有任何规范包括触发密码更改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:03:56.617

Facebook 的 API 中没有任何内容要求用户更改密码，也没有任何方法可以让您知道用户是否/何时更改了他们的 Facebook 密码。

如果您将 Facebook 登录用于需要符合 PCI 的内容，您可能应该考虑为您自己的系统设置一个额外的密码，并要求定期更改该密码。

# grails - Grails：使用 g:each 在表格行中预选 ag:select 选项

> ID：11673369
> 
> 赞同：0
> 
> 时间：2012-07-26T16:01:49.147
> 
> 标签：grails

我在 grails 选择下拉列表中预选条目时遇到问题。我有一张桌子，每一行都有一个下拉菜单。

表中的行由 ag:each 定义：

```
<g:each in="${fooList}" status="i" var="fooInstance"> 
```

所以每一行都有这个对象的字段，我们就叫它Foo！

```
String name
String age
Bar xyz 
```

问题出现在最后一列。该对象中有另一个对象（条 xyz）。我希望能够在当前的 Foo 中更改这个 Bar（它是一个域对象）。但是当页面加载时，Foo 中可能已经有一个 Bar。

如何将选择绑定到预填充的子对象？选择中包含子对象的可能值（所有栏当前可用），但绑定不起作用！

```
<td>${fieldValue(bean: fooInstance, field: "name")}</td> //this is fine

<td><g:select from="${Bar.list()}" name="xyz" 
optionValue="${fooInstance.xyz}" value="${fooInstance.xyz.id}" 
optionKey="id" noSelection="['':'-Choose a Bar-']" /></td> 
```

有任何想法吗？希望这足够清楚，如果您需要任何其他信息，请告诉我，

谢谢，托尼

顺便说一句，我得到的堆栈跟踪是：

> 由 MissingMethodException 引起：没有方法签名：xxxxxxxxx.Bar.getAt() 适用于参数类型：(xxxxxxx.Bar) 值：[aaablahblah] 可能的解决方案：getAt(java.lang.String)、getAll()、getId( ), getAll([Ljava.lang.Long;), getAll(java.util.List), get(java.io.Serializable)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:49:16.587

每当我得到一个`missingMethodException`，我发现我需要停止服务器，清理项目，然后重新启动服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T18:58:22.747

查看[select tag 的文档](http://grails.org/doc/latest/ref/Tags/select.html)，`optionValue`应该是显示在主体中的当前项目的属性，即显示`Select`在`optionValue="${{it.someProperty}}"`哪里。`it``Bar`

那样有用吗？

# logic - 实际和逻辑上哪个更好，先做一些事情然后保存在数据库中还是先保存然后做那件事？

> ID：11673371
> 
> 赞同：-1
> 
> 时间：2012-07-26T16:01:57.690
> 
> 标签：logic, flowchart

应用程序应该记录一些在数据库中发生的任务。问题是：先保存或更新任务然后执行任务，还是先执行任务然后保存或更新到数据库？

从逻辑上讲，我认为先完成任务然后保存到数据库更好。但是，在应该为数据库提供回滚机制的事务环境中，我认为在事务的掩护下做任务更好，即先更新然后做任务！

你怎么看待这件事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:04:39.383

重要的是您的流程是原子的，这意味着只要您在发生异常时回滚所有内容，您首先或最后执行的操作并不重要。

好吧，如果您需要生成的任务类的 id 来继续，这可能很重要。

# iphone - 对象到 JSString 栏出现

> ID：11673372
> 
> 赞同：0
> 
> 时间：2012-07-26T16:01:59.007
> 
> 标签：iphone, nsdictionary, jsonkit

我一直在尝试使用 jsonkit 进行对象到字符串的转换。我的 SerializedClasses 助手将 NSMutableArray CellList 转换为 JSONString（ssd 日志）。这很完美。然后我将生成的字符串放入字典中，然后尝试获取 jsonstring 字典（ssd2 日志）。代码和输出如下。

```
 -(NSDictionary*)toDictionary{ 
NSString *myCellListString = [SerializedClassesHelper cellListToString:cellList];
NSLog(@"ssd:%@",myCellListString);

    NSDictionary *myDictionary = [NSDictionary dictionaryWithObjectsAndKeys:
                              [[NSString alloc] initWithFormat:@"%@",myCellListString],@"cellList",
                              [[NSString alloc] initWithFormat:@"%d",weaponType],@"weaponType",
                              nil];

for (NSString *eachString in myDictionary) {
    [eachString release];
}
NSLog(@"ssd2:%@",[myDictionary JSONString]);
return myDictionary;
} 
```

输出：

```
ssd:[{"col":"4","row":"2"},{"col":"4","row":"2"}]
ssd2:{"weaponType":"0","cellList":"[{\"col\":\"4\",\"row\":\"2\"},{\"col\":\"4\",\"row\":\"2\"}]"} 
```

为什么所有这些反冲出现在 cellList 字符串的中间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:07:35.023

它们正在转义引号字符，因为它们存在于字符串中。没有它们，它会告诉解析器继续退出并输入字符串，你最终会得到无效的语法。

# rest - Sencha 2 Proxy.Rest，如何处理 POST 后从服务器返回的验证错误

> ID：11673374
> 
> 赞同：1
> 
> 时间：2012-07-26T16:01:58.177
> 
> 标签：rest, sencha-touch-2

我有以下保存：

```
 var saveResponse = rene.save({
            success: function(response, opts) {
                console.log('The Child was saved, response: '+response);
            },
            failure: function(response, opts) {
                console.log('The Child save was a failure response: '+response);
                console.log('The Child save was a failure opts: '+opts);
            }
        }); 
```

服务器验证发送的数据，如果出现任何错误，它会返回：

```
{"validationErrors":{
    "phoneNumber":"Account with this email already exists",
    "birthDateString":"Use following format: yyyy-MM-dd. Example: 2012-11-22"}
} 
```

但是 save 方法有以下 API，它只返回：

[http://docs.sencha.com/touch/2-0/#!/api/Ext.data.Model-method-save](http://docs.sencha.com/touch/2-0/#!/api/Ext.data.Model-method-save)

"...它们都将被调用，模型和操作作为参数。",

所以我的问题是：

当它只为我提供模型时，如何获得响应（上面的 JSON）作为回报（我假设它只给我我在帖子正文中发送的原始 json，因为我不返回完整的模型作为回报）？是我忽略了什么，还是从语义的角度来看 REST POST 请求不应该失败（这里：验证错误）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:59:54.013

我想通了，您将异常侦听器注册到代理，如下所示：

```
var account = Ext.create('Sencha.model.user.Adult', {
....
}

var proxy = account.getProxy();
proxy.addListener({
    'exception': function(proxy, response, operation) {
        var obj = JSON.parse(response.responseText);
            adultClass.serverValidationErrors(obj);
        }
}); 
```

# sparql - 耶拿 DELETE 和 URI

> ID：11673379
> 
> 赞同：0
> 
> 时间：2012-07-26T16:02:09.450
> 
> 标签：sparql, jena

我有 Jena(2.6.4) 和 ARQ(2.8.8)，无法从三重存储中删除数据。SPARQL 请求：

```
 DELETE {?doc ?p ?o} 
  WHERE {  ?doc ?p ?o; 
        <http://example#fullName> <file:/c:/1.txt> } 
```

此请求在 Sesame Workbench 中运行良好。

但是，当我尝试使用 DB2 v.10 RDF 三重存储从 Java 发出它时，什么也没有发生：

```
 Dataset ds = RdfStoreFactory.connectDataset(store, conn);
       GraphStore graphStore = GraphStoreFactory.create(ds) ;
       UpdateAction.parseExecute(deleteDocumentString, graphStore); 
```

我发现的唯一方法 - 比较字符串：

```
 {?doc base:fullName ?fname. FILTER(str(?fname) = "file:/c:/1.txt") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T17:00:07.230

`<file:/c:/1.txt>`不是一个正确的 URI（它不是绝对的，尽管 file: URL 的定义不是很好）。

文件的正式定义： URls 要求：`file://host/path`并且`host`可能省略，给出`file:///`.

SPARQL 解析器将其转换为

你可以用

```
arq.qparse --file QueryInFile.rq 
```

似乎数据加载没有执行相同的步骤。Jena RIOT 解析从命令行运行时会发出警告：

```
WARN  [line: 1, col: 46] Bad IRI: <file:/c:/1.txt> Code: 57/REQUIRED_COMPONENT_MISSING in AUTHORITY: A component that is required by the scheme is missing. 
```

最好修复数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:44:35.240

你没有说你得到了什么错误，但鉴于你使用的是非常旧的 Jena 和 ARQ 版本，我怀疑问题只是它们不支持 SPARQL 更新请求。我建议您升级到更新版本的 Jena（或坚持使用 Sesame :)）

**更新**在我看来，您的数据似乎有问题。您的更新操作和您使用的查询都尝试将值`fullName`视为 URI（因为您通过将其放在尖括号中来使用 URI 语法，如下所示：

```
 <file:/c:/1.txt> 
```

但是，显然该值在您的数据中不作为 URI 存在（因为您执行的 SELECT 查询不会返回它，并且您使用它的 DELETE 操作不会删除任何内容）。由于您执行基于字符串的检查的版本*确实*有效，因此我怀疑在您的数据中，该值是文字，而不是 URI。

以下可能有效：

```
DELETE {?doc ?p ?o} 
WHERE {  ?doc ?p ?o; 
              <http://example#fullName> "file:/c:/1.txt" . 
} 
```

尽管只有当文字值是没有语言标签的无类型文字时，上述方法才有效。否则，您自己找到的替代方案（在字符串值上使用 FILTER 条件）是处理此问题的好方法。或者，当然，如果您希望这些值是 URI 而不是文字，请修改您的实际数据。

# javascript - 使用 HTML5 处理多个文件

> ID：11673380
> 
> 赞同：1
> 
> 时间：2012-07-26T16:02:13.070
> 
> 标签：javascript, html, fileapi, filelist

我觉得发布这个有点傻，因为从我一直在阅读的内容来看，这似乎很简单，但我不知道为什么我总是`1`将`files.length`.

```
<html>
<head>
<script src="http://code.jquery.com/jquery-1.7.2.js" type="text/javascript"></script>
<script>
    $(document).ready(function() {
        var button = $('#button');
        button.click(function(){    
           var files = $('#files');
           alert(files.length);
        });
     });
</script>
</head>
<body>
  <form>
    <input type="file" id="files" multiple="" />
    <input type="button" id="button" value="Upload" />
  </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:34:37.690

将警报行更改为：

```
alert(files[0].files.length); 
```

这是可行的，因为您要做的是获取作为[FileList](https://developer.mozilla.org/en/DOM/FileList)对象的输入 DOM 元素的 files 属性。然后，您需要 FileList 的[长度属性](https://developer.mozilla.org/en/DOM/FileList#section_3)，它会告诉您选择了多少对象。您首先使用 jQuery 选择输入元素，但是像 $("#files") 这样的 jQuery 选择的结果是一个 jQuery 集合，您需要输入元素的底层 DOM 对象，因为只有它具有 files 属性。每个 jQuery 对象都伪装成一个数组，因此您可以使用标准数组解引用来获取底层 DOM 元素。（见：[http](http://api.jquery.com/get/) ://api.jquery.com/get/ ）

[**尝试一下！**](http://jsfiddle.net/adamzr/FFTja/)

# css - 灵活的 CSS 三角形？

> ID：11673382
> 
> 赞同：1
> 
> 时间：2012-07-26T16:02:25.083
> 
> 标签：css

我想在块的侧面添加三角形，将其塑造成这样的[箭头](http://i.imgur.com/Fp10B.png)。但它需要灵活并适应不同长度的文本。我认为传统的 css-triangles-made-from-borders 技术行不通，但这就是我到目前为止所拥有的一切（[演示](http://jsfiddle.net/C8TSa/)）。还有其他人有更强大的解决方案吗？

只要能很好地降解，尖端的 css 就很好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T20:11:09.913

我认为最好的兼容性解决方案是[http://dabblet.com/gist/3184227](http://dabblet.com/gist/3184227)

它只使用伪元素和 CSS [**`transform`（**](https://developer.mozilla.org/en/CSS/transform)所以它在 IE9 中工作，它可能适用于 IE8，其中伪元素可以使用[**矩阵`filter`**](http://msdn.microsoft.com/en-us/library/ms533014%28VS.85%29.aspx)倾斜- 我从未检查过它是否真的有效......我只知道梯度过滤器不适用于伪元素）。

这个想法非常简单：使用两个伪元素，每个伪元素都有一半`height`，绝对`position`是它们，一个占据上半部，另一个占据下半部，最后`skew`它们的方向相反。

HTML：

```
<div class="t">
    <p>Add text to see how it scales</p>
</div> 
```

相关CSS：

```
.t {
    position: relative;
}
.t:before, 
.t:after {
    left: 0;
    right: 0;
    position: absolute;
    z-index: -1;
    content: '';
}
.t:before {
    top: 0;
    bottom: 50%;
    transform: skewX(10deg);
}
.t:after {
    top: 50%;
    bottom: 0;
    transform: skewX(-10deg);
} 
```

它可以在没有伪元素的情况下完成，只使用 CSS `gradients`。不幸的是，[IE9 不支持它们](http://caniuse.com/#feat=css-gradients)。

# c# - 错误：无法加载 log4net 程序集

> ID：11673383
> 
> 赞同：16
> 
> 时间：2012-07-26T16:02:26.563
> 
> 标签：c#, asp.net, crystal-reports

我正在寻找解决这个错误：

> 无法加载文件或程序集 'log4net, Version=1.2.10.0, Culture=neutral, PublicKeyToken=692fbea5521e1304' 或其依赖项之一。系统找不到指定的文件。” 此错误位于 web.config 文件中。

当我将 log4net.dll 复制到我的 webapp 的 bin 目录时，我得到一个

> 无法加载文件或程序集 'log4net, Version=1.2.10.0, Culture=neutral, PublicKeyToken=692fbea5521e1304' 或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。

此错误也会出现在 web.config 文件中。

更改版本和公钥令牌以匹配文件很容易，以便正确加载程序集。当我这样做时，我的网站运行完美，除了`reportViewer`初始化对象时。然后它会在 reportViewer 标记而不是 web.config 中引发原始错误。

我的假设是，如果我安装请求的版本`log4net.dll`，我的问题将得到解决。但我不知道它是哪个文件，或者在哪里可以找到它。我通过下载 log4net 1.2.10 并尝试下载中的每个 dll 来检查明显的情况。

我应该提到该网站在我的开发机器上运行没有问题，但在发布到我的服务器时却没有。

我在 Server 2008 R2 操作系统上运行 asp.net 网站、.NET 4.0、IIS 7。我已经为 64 位安装了 Crystal Reports 13.0.1（我的机器是 64 位的）。

我该如何解决这个问题？

编辑：为了回应@Kevian 的回答，我对我的 web.config 文件进行了更改。我仍然收到清单定义与程序集引用不匹配的错误。引发此错误的代码是：

```
Line 33:     <CR:CrystalReportViewer ID="CrystalReportViewer1" runat="server"   AutoDataBind="true"
Line 34:         BestFitPage="True" ToolPanelView="None" /> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T01:32:34.540

这里有几个问题是可以解决的：

1.  **32 位版本的 log4net.dll 的公钥标记**与 Crystal Reports 使用的公钥标记冲突。要验证您是否有此问题，请在所有 .csproj 文件中搜索“ ***692fbea5521e1304*** ” - 如果您看到对 CrystalDecisions**和**log4net 的引用，则表示您有此问题。
2.  32 位版本的**log4net.dll 与为 64 位或 AnyCPU 架构编译的 dll 发生冲突**。如果您遇到此问题，您将找到如下所示的参考。您可以通过将应用程序池重新配置为以 32 位运行并检查应用程序是否运行来验证问题 - 如果运行，则表示您有此问题。

> ```
> <Reference Include="log4net, Version=1.2.10.0, Culture=neutral, 
> ```
> 
> PublicKeyToken= **692fbea5521e1304**，处理器架构= **x86** ”>

**在 64 位中对我们有用的修复**是获取实际上具有新 PublicKeyToken 的最新 log4net.dll，替换您的 3rd 方 bin 文件夹中的 log4net.dll **，**并将所有 log4net.dll 引用更改为如下所示：

> ```
> <Reference Include="log4net, Version=1.2.10.0, Culture=neutral, 
> ```
> 
> PublicKeyToken= ***1b44e1d426115821***，处理器架构= ***MSIL*** >

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T16:45:06.193

尝试将此添加到您的 web.config。它基本上告诉运行时您可以为两个版本加载相同的程序集

```
 <runtime>
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
            <dependentAssembly>
                <assemblyIdentity name="log4net" publicKeyToken="692fbea5521e1304" culture="neutral" />
                <bindingRedirect oldVersion="0.0.0.0-1.2.10.0" newVersion="1.2.10.0"/>
            </dependentAssembly>
        </assemblyBinding>
    </runtime> 
```

您需要替换`1.2.10.0`为您在 bin 文件夹中实际拥有的版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-05-27T03:59:36.097

如果你的机器是 64 位的，而你安装了 Crystal Report 32 位版本，那么这个错误会一直困扰着你。在这种情况下，所有必需的程序集都已在 GAC 中正确注册，但仍然显示“无法加载 log4net 程序集...”此错误的原因是您试图在 64 位计算机上执行 32 位应用程序。

如果您在服务器端实现报告，IIS 将不允许执行此应用程序。要解决此问题，您必须在 IIS 中启用 32 位应用程序。

**为此的步骤是：**

1.  转到运行应用程序的应用程序池
2.  右键单击并转到高级设置
3.  在这里找到“启用 32 位应用程序”并将其设置为 true
4.  重置 IIS (iisreset)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-20T18:10:32.030

对于您的问题，我建议您在参考文献中删除/删除此 dll 并重新安装，这是在 VS 2013 上正确安装 Log4Net 的方法：

1）确保通过以下方式打开 NuGet 包管理器实用程序的 nuget.org 包源：右键单击项目（不是解决方案），然后选择左下方的“Manague NUGet Packages ...”选择“设置”，然后选择“包管理器”然后在可用包源下选择“包源”选择“nuget.org”同时检查“Machine-wid 包源”单击“确定”

2) 它将带您到管理 NUGet 包，然后在左侧窗格中选择“在线”，然后搜索从 apache log4j 移植的“log4net”，然后安装它。完成后你会发现它安装在你项目的参考下

我还附上了截图。

请享用！

[![在此处输入图像描述](../Images/ff07d0a4326ba7b819248a78478b8f8c.png)](https://i.stack.imgur.com/Ne8as.png)

[![在此处输入图像描述](../Images/e9a4a3ab7d8445dd91ae421edc0ae93d.png)](https://i.stack.imgur.com/vIbbn.jpg)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-31T10:13:50.803

MSDOS

```
-- Create a virtual disk
subst t: C:\Windows\assembly

-- Delete log4net x64 assembly
del t:\GAC_64\log4net\1.2.10.0__692fbea5521e1304\log4net.dll

-- remove the virtual disk
subst t: /d 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-02-15T11:33:01.513

我下载了这个x86版本，问题解决了

[https://downloads.i-theses.com/index.php?option=com_downloads&task=downloads&groupid=9&id=100](https://downloads.i-theses.com/index.php?option=com_downloads&task=downloads&groupid=9&id=100)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-10T16:35:19.033

我的代码中有这个问题。有人使用的其中一个项目存在 Log4Net 版本冲突。他们使用的是 12.2.10，而我使用的是 12.2.13。所以为了解决这个问题，我摆脱了我的参考并找到了他们的参考 dll。我改用它，它工作得很好。

查找参考 Microsoft Visual Studio 具有浏览器功能。您可以使用它来获取dll。要查找 dll，您可以单击项目中的引用，然后单击要查找的引用。在这种情况下，Log4Net。它将显示一个依赖列表，另一个 log4net 应该在所选 Log4Net 附近，并且应该有一些文本显示当前所选 dll 引用的位置。这是您可以找到参考的地方。

# javascript - jQuery Mobile 对话框中的按钮 onClick 事件触发次数过多

> ID：11673384
> 
> 赞同：2
> 
> 时间：2012-07-26T16:02:33.197
> 
> 标签：javascript, jquery, mobile, dialog

我正在使用 jQuery Mobile 1.1.1 并且正在使用[Dialogs](http://jquerymobile.com/demos/1.1.1/docs/pages/page-dialogs.html)。我正在使用对话框来选择要添加到`<ul>`. 我已经在 SO 上搜索并搜索了类似的问题，但到目前为止还没有运气。

要向其中添加多个元素，`<ul>`我需要多次打开我的对话框，并且我试图避免每次打开它时都必须重新创建对话框。我的问题是`onClick`我的按钮事件`OkButtonPopup`触发太多次（第一次触发一次，第二次触发两次，第三次触发3次，依此类推......）。

我不明白为什么会这样……

下面是给我带来麻烦的（简化的）代码。

```
<!doctype html>
<html>

<head>
    <title>Problem with Dialog re-use</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.css" />
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>
</head>

<body>
    <div data-role="page">
        <div data-role="header">
            <h1>Problem with Dialog re-use</h1>
        </div>
        <div data-role="content">
            <p><h2>Activated by</h2></p>
            <ul id="activate_ul">
                <!-- li to be added dynamically-->
            </ul>
            <a href="javascript:addPopup()" data-rel="popup" data-role="button">Add</a>    
        </div>
    </div>    
    <div id="myDialog" data-role="dialog">    
        <div data-role="header" data-theme="d">
            <h1>My Elements</h1>
        </div>    
        <div id="myDialogContent" data-role="content" data-theme="c">
            <p>Element Type</p>
            <select id="element-type">
                <!-- options to be added dynamically-->
            </select>
            <p>Element Name</p>
            <select id="element-list">
                <!-- options to be added dynamically-->
            </select>
            <a href="#" id="OkButtonPopup" data-role="button" data-rel="back" data-theme="b">Ok</a>
        </div>
    </div>
    <script type="text/javascript">
        var all_inputs = ["myInput1","myInput2","myInput3","myInput4"];
        var all_outputs = ["myOutput1","myOutput2","myOutput3","myOutput4"];
        var all_zones = ["myZone1","myZone2","myZone3","myZone4"];

        function updateInputList() {
            $('#element-list').empty();        
            for (var i = 0; i < all_inputs.length; i++ ) {
                $('#element-list').append('<option value="'+all_inputs[i]+'">'+all_inputs[i]+'</option>');
            }
        }

        function updateOutputList() {
            $('#element-list').empty();
            for (var i = 0; i < all_outputs.length; i++ ) {
                $('#element-list').append('<option value="'+all_outputs[i]+'">'+all_outputs[i]+'</option>');
            }
        }

        function updateZoneList() {
            $('#element-list').empty();
            for (var i = 0; i < all_zones.length; i++ ) {
                $('#element-list').append('<option value="'+all_zones[i]+'">'+all_zones[i]+'</option>');
            }
        }

        function removeByValue(arr, val) {
            for(var i=0; i<arr.length; i++) {
                if(arr[i] == val) {
                    arr.splice(i, 1);
                    break;
                }
            }
        }

        function addPopup() {
            $('#element-type').empty();
            $('#element-type').append('<option value="Input">Input</option>')
                            .append('<option value="Output">Ouput</option>')
                            .append('<option value="Zone">Zone</option>');    

            updateInputList();

            $('#element-type').change();        

            $('#element-type').on("change", function() {
                if ($("option:selected", this).attr('value') == "Input") {
                    updateInputList();
                }
                if ($("option:selected", this).attr('value') == "Output") {
                    updateOutputList();
                }
                if ($("option:selected", this).attr('value') == "Zone") {
                    updateZoneList();
                }

                $('#element-list').selectmenu('refresh');
            });

            // Event triggered too many times!! Why???
            $('#OkButtonPopup').on("click", function() {
                $('#activate_ul').append('<li>' + $('#element-list').val() +'</li>');

                // remove element from corresponding array
                if ($('#element-type').val() == 'Input' ) {
                    removeByValue(all_inputs, $('#element-list').val());
                }
                if ($('#element-type').val() == 'Output' ) {
                    removeByValue(all_outputs, $('#element-list').val());
                }
                if ($('#element-type').val() == 'Zone' ) {
                    removeByValue(all_zones, $('#element-list').val());
                }
            });

            $.mobile.changePage("#myDialog", { role: "dialog" });
        }
    </script>
</body>
</html> 
```

任何帮助将非常感激 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T16:17:03.147

每次调用 addPopup 时，都会继续将 click 事件附加到 OkButtonPopup，因此，事件处理程序会被调用几次。您可以尝试通过绑定附加事件并在绑定之前取消绑定。你可以这样做：

```
$('#OkButtonPopup').unbind("click").bind("click", function() {
                $('#activate_ul').append('<li>' + $('#element-list').val() +'</li>');

                // remove element from corresponding array
                if ($('#element-type').val() == 'Input' ) {
                    removeByValue(all_inputs, $('#element-list').val());
                }
                if ($('#element-type').val() == 'Output' ) {
                    removeByValue(all_outputs, $('#element-list').val());
                }
                if ($('#element-type').val() == 'Zone' ) {
                    removeByValue(all_zones, $('#element-list').val());
                }
            }); 
```

或者您也可以在 pageshow 上附加 click 事件，而不是在 addPopup 中进行。这样你只绑定一次。

# .net - 总计重复记录

> ID：11673385
> 
> 赞同：0
> 
> 时间：2012-07-26T16:02:37.193
> 
> 标签：.net, crystal-reports, report, crystal-reports-2008

如何将重复记录汇总在一起？例子：

```
1 John Doe $100.50
2 John Doe $51.23
Total Amount:$151.73
3 Jane Doe $100.01
4 Jim Johns $94.05
4 Jim Johns $5.00
Total Amount:$99.05 
```

我可以创建一个关于详细信息的新部分并将其隐藏直到记录重复吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T14:07:18.773

我会按名称分组，然后按价格分组。然后隐藏名称组页眉和价格组页脚。将名称添加到价格页眉并将总计添加到名称页脚。

如果您想使用分组，这是一种简单的方法。那就是如果我正确理解你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:16:15.213

可能像

```
var duplicates = from p in db.People
                 join p by p.Name into g
                 select new{g.Name, Sum => g.Sum(g.Price)}; 
```

# html - 当一个奇数宽度的 div 被分割为 50%/50% 时，剩下的 1px 会发生什么？

> ID：11673388
> 
> 赞同：10
> 
> 时间：2012-07-26T16:02:40.173
> 
> 标签：html, css

假设我想`div#wrapper`使用两个带有 的 div 创建一个背景，一半是蓝色，一半是红色`width:50%`，如下所示：

HTML：

```
<div id="wrapper">
    <div id="leftSide"></div>
    <div id="rightSide"></div>
</div> 
```

CSS：

```
body, html, #wrapper {
    width: 100%;
    height: 100%;
}

#wrapper {
    background: white;
}

#leftSide, #rightSide {
    width: 50%;
    height: 100%;
}

#leftSide {
    float: left;
    background: blue;
}

#rightSide {
    float: right;
    background: red;
} 
```

[这是上面示例的小提琴。](http://jsfiddle.net/9tMck/)

从理论上讲，这将解决该任务。但是，如果包装器的宽度包含奇数个像素，那么剩下的 1px 会发生什么？

例如，如果包装器的宽度更改为 101 像素，那么宽度`#leftSide`将是 50 像素，并且宽度`#rightSide`将是 50 像素，大概会在中间留下一条 1 像素的垂直白线。

浏览器通常如何呈现这个？一侧会吸收剩余的 1px 吗？如果是这样，解决这个问题的最佳纯 CSS 方法是什么？我的第一个倾向是将包装器的背景设置为红色或蓝色，但是还有其他方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-26T16:11:19.490

请参阅[http://jsfiddle.net/dq323/](http://jsfiddle.net/dq323/)。

在 IE 和 Firefox 中，右侧占据了额外的像素。在 Chrome 中，两者之间实际上存在差距。

设置容器的背景似乎是解决此问题的最佳方法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-26T16:23:49.883

一种可能的解决方案是不将宽度设置为第二个`DIV`( `#rightSide`)，而`float: left;`仅设置在左侧`DIV`。由于这些是块元素，因此如果没有设置，它们将始终扩展为完整的可用宽度。

在示例中，包装器宽度为 3px，左侧容器的宽度为 1-2px（取决于浏览器），右侧容器将需要包装器内剩余的水平空间：

[http://jsfiddle.net/dq323/1/](http://jsfiddle.net/dq323/1/)

# android - 您可以将 google-api-ruby-client 与 Google Cloud Messaging (GCM) 一起使用吗？

> ID：11673393
> 
> 赞同：0
> 
> 时间：2012-07-26T16:02:49.807
> 
> 标签：android, android-c2dm, google-cloud-messaging

[Google Cloud Messaging](http://developer.android.com/guide/google/gcm/index.html)似乎只提供 Java 示例代码。我在我的服务器上运行 ruby​​，并希望使用[google-api-ruby-client](http://code.google.com/p/google-api-ruby-client/)来为我的 GCM 安装提供动力。有没有关于如何做到这一点的指南？我只想使用 google-api-ruby-client 为 GCM 提供“hello world”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T18:56:04.263

没关系 - 这不需要使用具有更高级身份验证逻辑的 google-api-ruby-client，而是使用可用于简单 POST 请求的更简单的 API 密钥。[从文档](http://developer.android.com/guide/google/gcm/c2dm.html)：

> **服务器更改**
> 
> 当应用服务器收到一个 GCM 注册 ID 时，它应该存储它并标记它。
> 
> 向 GCM 设备发送消息需要进行一些更改：
> 
> 请求应该被发送到一个新的端点： [https](https://android.googleapis.com/gcm/send) ://android.googleapis.com/gcm/send 。请求的 Authorization 标头应包含注册期间生成的 API 密钥。此密钥替换已弃用的 ClientLogin Auth 令牌。例如：

```
Content-Type:application/json 
Authorization:key=AIzaSyB-1uEai2WiUapxCs2Q0GZYzPu7Udno5aA

{   "registration_id" : "APA91bHun4MxP5egoKMwt2KZFBaFUH-1RYqx...",   
    "data" : {
     "Team" : "Portugal",
     "Score" : "3",
     "Player" : "Varela",   }, 
} 
```

> 有关此主题的详细讨论和更多示例，请参阅架构概述。

# c# - c# 中带有反射的 jscript.net 代码

> ID：11673394
> 
> 赞同：-2
> 
> 时间：2012-07-26T16:02:50.643
> 
> 标签：c#, jscript

我想运行包含表单的 jscript.net 代码，一些带有事件的按钮。所有这些都必须在 c# 中通过反射完成，但我找不到这些事件的体面示例。请给我一些帮助。这是我到目前为止所拥有的，但最后一行会有错误

```
 StringBuilder sb = new StringBuilder();

            sb.AppendLine("import System.Windows.Forms;");
            sb.AppendLine("class EventTestForm extends Form");
            sb.AppendLine("{");
            sb.AppendLine(" var btn : Button;");
            sb.AppendLine("function EventTestForm()");
            sb.AppendLine("{");
            sb.AppendLine(" btn = new Button; btn.Text = \"Fire Event\";  Controls.Add(btn); btn.add_Click(ButtonEventHandler1);");
            sb.AppendLine("}");
            sb.AppendLine("function ButtonEventHandler1(sender, e : EventArgs)");
            sb.AppendLine("{");
            sb.AppendLine(" MessageBox.Show(\"Event is Fired!\");");
            sb.AppendLine("}");
            sb.AppendLine("}");

            sb.AppendLine("MessageBox.Show(\"Hello world\");");

            // Create the compiler object
            JScriptCodeProvider provider = new JScriptCodeProvider();
            ICodeCompiler compiler = provider.CreateCompiler();

            CompilerParameters options = new CompilerParameters();
            options.GenerateInMemory = true;

            options.GenerateExecutable = true;
            options.ReferencedAssemblies.Add("System.Windows.Forms");
            CompilerResults results = compiler.CompileAssemblyFromSource(options, sb.ToString()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:16:36.550

如果您尝试在 c# 应用程序中运行 javascript，最好使用其中一个 js 解释器

我用jint，还有侏罗纪，javascript.net，也许还有其他

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-23T15:12:35.840

```
options.GenerateExecutable = false;
options.GenerateInMemory = true;
options.ReferencedAssemblies.Add("system.dll");
options.ReferencedAssemblies.Add("system.Text.dll");
options.ReferencedAssemblies.Add("system.windows.forms.dll"); 
```

使用这些行

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T08:01:59.253

我可以建议你只学习 JavaScript 吗？刚刚看了一下`JScriptCodeProvider`课程，文档说：

> 此 API 支持 .NET Framework 基础结构，不打算直接从您的代码中使用。

[http://msdn.microsoft.com/en-us/library/microsoft.jscript.jscriptcodeprovider.aspx](http://msdn.microsoft.com/en-us/library/microsoft.jscript.jscriptcodeprovider.aspx)

# yii - 易。树枝模式中的国际化

> ID：11673396
> 
> 赞同：2
> 
> 时间：2012-07-26T16:02:51.730
> 
> 标签：yii, twig

如何在树枝模式中传递方法 Yii::t()？
为了能够使用它。
例如：

```
{{Yii.t('main', 'some_text')}} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T08:55:30.677

我自己已经想通了。
谁能派上用场：
在文件：/protected/extensions/ETwigViewRenderer.php的init函数中添加：

> $Yii = new ETwigViewRendererStaticClassProxy ('Yii');
> $this->_twig-> addGlobal('lang', $Yii);

在 Twig 模板中使用如下方式：

> {{lang.t ('main', 'Login') }}
> {{lang.t ('main', 'Logout ({username})',{'{username}': App.user.name}) } }

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-29T09:35:17.133

```
'viewRenderer' => array(
        'class' => 'ext.yiiext.renderers.twig.ETwigViewRenderer',
        'registerAutoloader' => false,
        'globals' => array(
            'html' => 'CHtml'
        ),
        'functions' => array(
            't' => 'Yii::t',
        ),
    ), 
```

然后你可以在你的树枝文件上使用 t('main', 'Some text')

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-23T20:53:07.133

@extends 尤金回答。

最好在配置中定义全局而不是编辑扩展文件：

```
'view' => [
            'class' => 'yii\web\View',
            'renderers' => [
                'twig' => [
                    'class' => 'yii\twig\ViewRenderer',
                    'cachePath' => '@runtime/Twig/cache',
                    // Array of twig options:
                    'options' => [
                        'auto_reload' => true,
                    ],
                    'globals' => ['html' => '\yii\helpers\Html', 'lang' => 'Yii'],
                    'uses' => ['yii\bootstrap'],
                ],
            ],
        ], 
```

注意 'lang' => 'Yii'，在 'globals' 设置中。

# facebook - Fb 应用程序域和站点 URL 的问题：

> ID：11673398
> 
> 赞同：0
> 
> 时间：2012-07-26T16:02:59.760
> 
> 标签：facebook, facebook-graph-api, appdomain, fbconnect, fbjs

```
I am trying to integrate facebook connect to all my websites. 
For example I have a website called example.com and many sub domains 
like,
   bob.example.com,
   claire.second.example.com,
   swiss.example.com and so on. 
My objective was to use the same App ID to all the websites. 
Well I did find, as long as the base URL is the same 
(i.e in my case example.com) we can use the same App Id for all 
the websites. So I put example.com in my Site URL and the remaining domain 
names in the App Domains field. But when I compile the code, the fb connect works 
only for the Site URL and not the App domains. BTW I am using the example in this
following link, 
```

[http://thinkdiff.net/facebook/new-javascript-sdk-oauth-2-0-based-fbconnect-tutorial/](http://thinkdiff.net/facebook/new-javascript-sdk-oauth-2-0-based-fbconnect-tutorial/) 如果有人知道解决方案，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T19:11:14.263

回答我自己的问题。

*   问题是我使用 localhost 进行测试（localhost 不起作用）。
*   并在 APP 域字段中包含所有基本 URL 相同的域，以使其正常工作。

[https://www.facebook.com/dialog/oauth?client_id=CLIENTAPPID&redirect_uri=SITEURL(OR)APPDOMAINURL&response_type=token](https://www.facebook.com/dialog/oauth?client_id=CLIENTAPPID&redirect_uri=SITEURL(OR)APPDOMAINURL&response_type=token)

将上面的 URL 替换为您的客户端 ID 和站点 url 以检查它是否有效，而不是在您的站点中实现 FB JS SDK 代码。

# android - Android GLES 2.0：后乘矩阵不起作用

> ID：11673401
> 
> 赞同：1
> 
> 时间：2012-07-26T16:03:04.293
> 
> 标签：android, matrix, glsl, opengl-es-2.0, shader

我似乎发现在顶点着色器中将向量与矩阵相乘的帖子适用于我的台式机，但不适用于我的 Android 手机。

我正在使用 libGDX 和 GLES2.0 编写游戏。我有相当一部分在桌面上运行，但是当我尝试在 Android 上运行它时，它只显示空白的清晰颜色。通过乱搞，我发现问题只存在于我在顶点着色器中使用矩阵时。有问题的顶点着色器是：

```
attribute vec3 aVertPos;
attribute vec2 aTexCoord;

uniform mat4 uCamMatrix;
uniform vec3 uPosition;
uniform vec2 uSize;

varying vec2 vTexCoord;

void main() {
  vTexCoord = aTexCoord;

  vec3 scale = vec3(uSize,0.0);
  vec4 dest = vec4((aVertPos*scale)+uPosition,1.0) * uCamMatrix;
  gl_Position = dest;
} 
```

我发现即使我将 uCamMatrix 作为单位矩阵传递，我仍然会出现空白屏幕。非常困惑，我环顾四周其他着色器 - 没想到结果 - 切换了该行中矩阵和向量的顺序：

```
vec4 dest = uCamMatrix * vec4((aVertPos*scale)+uPosition,1.0); 
```

在传递矩阵之前我一直在转置矩阵，所以我停止这样做，因为我正在更改顺序。这完全解决了这个问题。

桌面版看起来和往常一样，所以计算结果一定是以前的样子。

那么Android/GLES20 是否对矩阵乘法有一些怪癖？这是一个错误吗？我只是错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T07:58:26.673

如果是矩阵乘法错误，那么下面的代码应该可以解决问题。（但老实说，我认为问题一定出在您的代码中的其他地方）。

代码转置矩阵，因此矩阵可以位于向量的左侧（这是一种非常低效的方式 - 您应该只使用此代码检查矩阵乘法是否正确）。

```
attribute vec3 aVertPos;
attribute vec2 aTexCoord;

uniform mat4 uCamMatrix;
uniform vec3 uPosition;
uniform vec2 uSize;

varying vec2 vTexCoord;

void main() {
  vTexCoord = aTexCoord;

  vec3 scale = vec3(uSize,0.0);
  vec4 dest = transpose(uCamMatrix) * vec4((aVertPos*scale)+uPosition,1.0);
  gl_Position = dest;
}

mat4 transpose(mat4 m){
    return mat4(
            m[0][0],m[1][0],m[2][0],m[3][0],
            m[0][1],m[1][1],m[2][1],m[3][1],
            m[0][2],m[1][2],m[2][2],m[3][2],
            m[0][3],m[1][3],m[2][3],m[3][3]
            );
} 
```

# magento - Magento：如何删除所有永久重定向

> ID：11673403
> 
> 赞同：7
> 
> 时间：2012-07-26T16:03:04.993
> 
> 标签：magento, url-rewriting

我们遇到了一个问题，我们正在处理的 Magento 商店有不需要的永久重定向，我正在寻找如何从这些重定向方面的空白开始。我们不需要任何东西，因为它是一个开发中的站点，我们也不希望在此域内重定向任何内容。商店没有直播，以下是发生的事情。

我们不知道系统 -> 配置 -> 目录 -> SEO 下的 URL 重写管理选项，因此对于“创建永久重定向...”它被标记为“是”一些产品是通过提要上传的，但它们上传不正确。所以，我们重新上传它们以覆盖。结果是“White Shirt A”在管理员或导出的数据馈送中的 URL 键为“white-shirt-a.html”，但显示该产品的实际链接是“white-shirt-a-1”。 .html。” 如果我们转到“white-shirt-a.html”，它会给我们一个 404 Not Found。

我们如何清除所有这些永久重定向？我们已经尝试在 Catalog -> URL Rewrite Mangement 下禁用或删除这些特定的请求路径和目标路径条目，但它们没有任何效果。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-26T16:28:46.453

如果您的商店尚未上线，请按照以下步骤操作：

1.  从数据库中清空/截断`core_url_rewrite`表。

2.  禁用 Magento 后端的永久重定向。

3.  重新索引目录 URL 重写，您的所有 URL 将被更正。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-29T23:16:04.687

为了删除所有永久重定向，您可以：

1）执行直接查询（不推荐）：

```
DELETE FROM core_url_rewrite WHERE options IS NOT NULL AND is_system = 0 
```

2）更温和地做：

```
$write = Mage::getSingleton('core/resource')->getConnection('core_write');
try {
    $write->beginTransaction();
    $table = Mage::getSingleton('core/resource')->getTableName('core/url_rewrite');
    $count = $write->exec('DELETE FROM ' . $table . ' WHERE options IS NOT NULL AND is_system = 0');
    $write->commit();
    $this->_getSession()->addSuccess($this->__('Successfully removed %s redirects.', $count));
} catch(Exception $e) {
    $write->rollback();
    $this->_getSession()->addException($this->__("An error occurred while clearing url redirects: %s", $e->getMessage()));            
} 
```

3) 或者您可以安装[自定义产品网址](https://www.magentocommerce.com/magento-connect/catalog/product/view/id/30396/ "自定义产品网址")扩展，它使您能够从管理面板清除所有永久重定向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-25T07:39:35.390

我不保证这是安全的。但到目前为止，它似乎奏效了。

我已经运行了这个查询：

“删除*从`core_url_rewrite`哪里`is_system`！= 1”；

该查询删除了所有*自定义*重写规则，其中我们有大约 500,000 条。其中大多数是在有人关闭搜索引擎优化中的“.html”扩展名而不将“更改网址时创建重写规则”更改为“否”时创建的。

# networking - 多个 IP 的 ip 过滤器

> ID：11673404
> 
> 赞同：0
> 
> 时间：2012-07-26T16:03:07.210
> 
> 标签：networking, filter, ip, wireshark, tcpdump

我想过滤 .cap 文件上的 IP，我使用命令 ip.addr == 123.456.789 但这只会过滤掉一个 IP，我想知道是否有办法过滤掉多个 IP？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:15:26.253

尝试这个：

```
tshark -i em0 host 10.25.100.2 or host 10.25.100.3 
```

# cakephp - cakephp删除按钮

> ID：11673405
> 
> 赞同：0
> 
> 时间：2012-07-26T16:03:10.640
> 
> 标签：cakephp

我想在 CakePHP 中创建一个删除按钮，通过特定控制器中的操作删除所选记录，我希望当用户单击已删除按钮时删除所选记录，然后重新加载同一页面，然后用户看到其他记录我的问题是当删除按钮转到删除操作，然后页面转到删除视图，我不希望这样，因为记录太多，我使用分页，我希望页面回到分页的同一页面中。多谢你们

> 这是我的 removeAll 操作

```
function removeAll() {
        $this->layout = 'ajax';
        $this->FormData->setJoin();
        if(empty($this->data)) {
            $this->data = $data;
            $this->render('remove');
        } else {
            foreach($this->data as $id => $item) 
                if($item == 1) $delete[]=$id;
                foreach($delete as $deleted) {
                    if(($data = $this->FormData->findById($id)) && ('Approved' !=$data['FormData']['status'] || $this->Authake->isAdmin())){
                        if($this->Values->deleteAll(array("          {$this->Values->alias}.formdata_id"=>$deleted)))
                        if($this->FormData->delete($deleted));
                    } else {
                        $this->redirect('authake/user/denied');
                    }
        }
                $this->set('success' ,true);
                $id=$this->data['id'];

                $this->redirect('/form/list'.$id);

    } 
```

当页面执行此操作时，它的视图（即 removeall.ctp）必须加载但不想要这个。我想回到同一页面

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:56:11.247

您可以在此处获取当前页面：

```
<?php echo $this->Paginator->counter(array(
    'format' => ('{:page}')
      )); 
?> 
```

这是解决方案的一部分。

保存此变量并在您的控制器中，当您使用新请求时，在 Paginator 中放置该变量。可能是 Paginator 中的 'current_page' 或类似的东西。尝试使用文档。谷歌是你的朋友。:)

# html - 如何扩展内容

> ID：11673412
> 
> 赞同：0
> 
> 时间：2012-07-26T16:03:46.720
> 
> 标签：html, css

我`div`在页面底部有一个固定的。

里面`div`是一个`ul`，可以将鼠标悬停在它上面以显示更多内容（类似于下拉列表而不是下拉列表）。

我想要做的是在列表上方完全相同的位置为每个悬停元素显示悬停时的隐藏内容。

我还需要做的是扩展固定的父级`div`。它没有高度，因此随着内容的扩展而扩展，但是在按照上面我使用的定位内容时，`position:absolute`它会脱离父容器并且不会扩展它。

我确信使用点击方法会更容易，但它也需要在悬停时工作。

# java - 守护线程服务实用程序

> ID：11673416
> 
> 赞同：1
> 
> 时间：2012-07-26T16:03:59.327
> 
> 标签：java, multithreading

> **可能重复：**
> [关于为非守护线程提供某些服务的守护线程](https://stackoverflow.com/questions/11665729/regarding-daemon-thread-providing-some-service-to-non-daemon-thread)

我想开发一个应用程序，其中守护线程将为非守护线程提供服务，我开发了以下代码

```
import java.util.concurrent.Executors;
import java.util.concurrent.ThreadFactory;

public class daemonTest {

    public static void main(String... a) throws Exception {
        ExecutorService service = Executors
                .newSingleThreadExecutor(new ThreadFactory() { // anonmyous class start
                    public Thread newThread(Runnable r) {
                        Thread two = new Thread(r, "two");
                        two.setDaemon(true);
                        System.out.println("two --->" + two.isDaemon());
                        return two;
                    }
                });
        for (int i = 0; i < 10; i++)
            service.submit(new Runnable() {
                @Override
                public void run() {
                    System.out.println("[" + Thread.currentThread().getName()
                            + "] - Hello World.");
                    Thread.yield();
                }
            });
        service.shutdown();
    }
} 
```

但是请告知如果我创建一个不是守护线程的新线程，那么名为两个的守护线程将如何为新创建的线程提供服务，最后我想要实现

# postscript - 大型 postscript 打印作业失败

> ID：11673417
> 
> 赞同：0
> 
> 时间：2012-07-26T16:03:59.363
> 
> 标签：postscript

我正在开发一个使用 postscript 打印许多页面的程序。如果我打印几页，一切都会正确打印。但是，如果我打印一个大文档，比如 100 页，它会在第 21 页左右停止。它会等待一分钟，然后在下一页上吐出一个错误。我一次将一个字符直接发送到打印机，如果这有什么不同的话。如果我在错误之前从作业中删除页面，它会很好地打印这些页面，但会在接下来的 20 页左右出现另一个错误。我有一个临时修复，它连接到打印机，打印 10 页，然后关闭连接并每 10 页重新连接一个新连接。这打印一切正常。传输的数据量刚刚超过 1 兆，而我的打印机有 32 兆的内存，所以应该有足够的缓冲区空间。

文件在这里：[https ://dl.dropbox.com/u/2430447/SPL0333842](https://dl.dropbox.com/u/2430447/SPL0333842)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T06:18:18.170

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T21:23:32.260

一些问题：

1.  您发送的 PostScript 的发起人是谁？
2.  目标打印机是使用 PostScript 的打印机，还是打印主机和打印机设备之间发生了某种转换？
3.  在第 21 页失败的 100 页 PostScript 文件有多大（以字节为单位）？
4.  您能否告诉我们有关您似乎看到的“违规命令”错误的更多详细信息？！
5.  您是否可以提供一个示例 PostScript 文件的链接？
6.  打印机如何连接到您的打印主机？（例如，它是不是坐在一个提供网络连接的小型“打印服务器”设备盒后面，而打印机挂断了从设备到打印机的 USB 连接？）
7.  你检查了所有的电缆吗？
8.  以下代码是否打印 100 页？

    ```
    %!PS
    /H1 {/Helvetica findfont 48 scalefont setfont .2 .2 1 setrgbcolor} def
    /pageframe {1 0 0 setrgbcolor 2 setlinewidth 10 10 575 822 rectstroke} def
    /gopageno {H1 300 700 移动到 } def
    1 1 100 {pageframe gopageno
    4 字符串 cvs
    dup stringwidth pop
    -1 mul 0 rmoveto
    节目
    展示页面}为

    ```

# ruby - 正则表达式（或其他解决方案）以获取字符串中的所有单词，包括表情符号和剥离的标点符号

> ID：11673422
> 
> 赞同：1
> 
> 时间：2012-07-26T16:04:17.547
> 
> 标签：ruby, regex, parsing, string-parsing

例如：

```
Hello! :)  It's a good day to-day :D  'Aight? <3 
```

它会返回：

1.  你好
2.  :)
3.  它是
4.  一种
5.  好的
6.  天
7.  今天
8.  :D
9.  '好吧
10.  <3

人们可能会认为所有表情符号都是两个字符长......而且，如果有帮助，可能只会遇到“转发”表情符号。

没有表情符号的情况是微不足道的，但有了它们——以及去掉其他单词的标点符号——有点让我绊倒。

除了 .split 和运行一个块来逻辑检查每个单词之外，还有没有一种快速的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:07:56.483

以下正则表达式应该找到任何单词（除了破折号/单引号/下划线之外没有标点符号）或 2 个字符的表情符号：

```
\s*(?:([a-zA-Z0-9\-\_\']+)|([\:\;\=\[\]\{\}\(\)\<3dDpP]{2}))\s* 
```

正则表达式解释：

```
\s*                             # any whitespace
(?:
    ([a-zA-Z0-9\-\_\']+)        # any alpha-numeric character, dashes, underscores, single-quotes
    |
    ([\:\;\=\[\]\{\}\(\)\<3dDpP]{2})    # any 2-punctuation marks commonly found in emoticons, including
                                # the number 3, for the <3 and D for :D
)
\s*                             # any whitespace 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:09:01.070

它实际上不是正则表达式，但可以完成工作！

```
"Hello! :)  It's a good day to-day :D  'Aight? <3".split
=> ["Hello!", ":)", "It's", "a", "good", "day", "to-day", ":D", "'Aight?", "<3"] 
```

# ios - Xcode 4.4 - 无法运行项目

> ID：11673424
> 
> 赞同：10
> 
> 时间：2012-07-26T16:04:22.710
> 
> 标签：ios, xcode, xcode4.4

刚刚将 Xcode 4.3 升级到 Xcode 4.4，运行现有项目时出现以下错误：

在模拟器上：“无法在选定的目标上运行。选定的目标不支持构建选定软件的架构。切换到支持该架构的目标以运行选定的软件。”

在设备上：“Xcode 无法使用所选设备运行。选择具有受支持架构的目标以便在此设备上运行。”

有趣的是，该项目在 Xcode 4.4 和模拟器上运行前几次运行，然后停止工作。已经尝试重新启动但还没有重新安装，因为 Xcode 是一个相当大的应用程序，如果它只是一个设置问题，那么我真的不想从头开始再次下载它。

**注意**：基本 SDK 是最新的 iOS（iOS 5.1），我在 Lion（还不是 Mountain Lion），我的部署目标是 iOS 4.0。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-31T12:44:33.387

我遇到了这个问题，结果证明是构建设置中产品名称的拼写错误。检查您的所有产品参考在设置和列表中是否一致。还要检查产品名称是否包含空格或其他“非法”字符；这也会导致同样的错误

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-02T04:52:06.490

我也有这个问题升级到 4.5 和我的 iPhone 4 到 IOS 6

“Xcode 无法使用所选设备运行。选择具有受支持架构的目标以便在此设备上运行。”

因为我已经在 Mountain Lion 上跑过，所以我做了以下事情

**1)**将有效架构设置为 armv7s & armv7

**2)**仔细检查产品名称的拼写

**3）**重新安装到xcode 4.1.1

它工作了一段时间，但后来我又遇到了同样的错误。然后我得到了提示（非常明显）

**4）**删除我设备上以前安装的应用程序（用于调试）。

这行得通！我现在永远不会忘记在我的设备上删除该应用程序，以确保它是使用最新设置构建的。

**更新：**我已经重试了 xcode 4.5 / ios6 和以上步骤现在也可以工作。所以我现在可以使用 xcode 4.5 和 ios 6。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-23T02:29:23.817

我本周末将 Xcode 从 4.3.2 升级到 4.5 并遇到了同样的问题。

就我而言，

我通过更改项目设置来修复它。以前我在 Xcode 4.3.2 中的项目设置在构建架构中支持 armv6。由于 Xcode 4.5 放弃了这种支持，所以我必须删除 armv6 字符串。修复它，我可以使用 iOS 6 设备调试代码。

但是当我提交应用程序时，我必须回到 XCode 4.3.2。因为我公司的营销团队不想失去那些可能的小众用户，在中国，4.1和4.2.1的存在仍然很少。

因此，如果您的项目曾经支持 armv6，并且遇到由于 XCode 4.5 中的架构而无法运行的项目，请像我一样尝试一下。希望能有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-27T14:10:49.163

升级到 Mountain Lion 解决了这个问题。不知道为什么，但它现在正在模拟器和设备上运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-31T08:07:37.977

从 Xcode 4.3 升级到 4.4 后，我遇到了完全相同的问题。不过，仅适用于我的 1 个 iOS 项目。我的解决方案是创建一个新项目并重新添加我的所有源代码、依赖项（除了 KIF 集成测试，我还没有添加）和其他自定义库。这样做之后，我终于能够在我的 iPhone 和 iPod Touch 上调试我的应用程序。

我的设置是 OSX Lion 和 Base SDK 是最新的 iOS (5.1)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-24T09:54:42.177

尝试删除文件夹中应用程序的临时文件`Library/Developer/XCode/DerivedData`夹并重建。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-13T03:41:22.727

我要添加的原因是以上所有都无法解决此问题：

我的步骤是：

1.  在设备上卸载你的应用程序

2.  检查 info.plist 文件是否重复（我的意思是同一产品可能有两个相同的 plist）

3.  点击你的项目，检查PROJECT下的“IOS Deployment Target”，TARGETS下的所有“Deployment Target”都是一样的（大多数时候，此时你可以关闭xcode并重新启动，也许这一步之后就可以了)
4.  如果它仍然不起作用，请将您的项目和目标的“基本 SDK”从最新的 iOS（iOS 6.0）更改为 iOS 6.0（在“构建设置”下）（退出 xcode、cmd-q 或强制退出，并重新启动）
5.  经过所有这些步骤，它应该可以工作。（如果上述方法不起作用，您仍然可以复制该项目并重新创建一个新项目，除非您没有选择，否则不要这样做）

（PS：这是一个非常有问题的问题，实际上在我修复它之后，我把所有东西都改回来了，它仍然有效。）

忘记我上面说的，我找到了解决这个问题的真正快速方法，强制退出你的 Xcode，然后重新启动它，有时你还需要重新启动你的设备。祝你好运，真的厌倦了这种问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-28T00:16:14.847

我今天晚上在更新 OSX 后遇到了这个问题。该项目之前一直运行良好。事实证明，所需要的只是重新启动。不过还是很吓人。

# git - 每次提交都使用 Git diff 工具？

> ID：11673434
> 
> 赞同：13
> 
> 时间：2012-07-26T16:04:50.413
> 
> 标签：git, diff, git-diff, difftool

我想运行`git difftool HEAD~3.. path/to/file`并让 git 为这三个提交中的每一个打开 difftool，以便我可以看到每个提交的并排视图。

我将如何让 git-difftool 做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-30T17:42:36.647

或者你可以直接运行`git log -p`——它做的事情几乎和你想要的一样

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-30T17:39:00.457

这将完成您所描述的：

```
git difftool HEAD~3 HEAD~2 path/to/file
git difftool HEAD~2 HEAD~1 path/to/file
git difftool HEAD~1 HEAD path/to/file 
```

想要自动化这个过程？总是三个提交吗？你想要一个三向合并吗？

**更新：**

如果答案是是-是-否，解决方案将是：

```
for i in {3..1}; do
  git difftool HEAD~$i HEAD~$((i-1)) path/to/file
done 
```

**更新：**

如果答案是肯定的，那基本上就是@ruffin[在这里](https://stackoverflow.com/questions/11726144/view-full-file-diff-of-x-commits-of-a-single-files-history-thats-hosted-in)提出的问题。在那里看到我的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T17:07:30.477

更新：

Matthieu Moy 提出了更好的变体：

```
for rev in $(git rev-list <committish>.. ); do
    git difftool ${rev} ${rev}~1;
    done 
```

旧版答案：

我会说你做这样的事情：

```
git rev-list <commitish>.. | wc -l 
```

或者

```
git log --oneline <commitish>.. | wc -l 
```

`<commitish>`这将计算您和 HEAD之间有多少修订。

然后使用这个数字，您可以自动运行提交以查看差异

```
c=`git log --online <commitish>.. | wc -l`

while ! ${c} eq 0 ; do

git difftool HEAD~${c} HEAD~${($c-1)}
c=${c}-1
done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T17:41:46.903

```
for i in 1 2 3
do
  ((j=${i}-1))
  git difftool HEAD~${i}..HEAD~${j} path/to/file &
done 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-14T08:12:08.043

稍微不同的方法：

1) 执行交互式变基

```
git rebase -i <commitish> 
```

2) 标记所有提交以进行编辑

3) 对于每次提交运行

```
git difftool HEAD~1 
```

4) 转到下一个提交并重复步骤 3

```
git rebase --continue 
```

额外的好处是，如果您在审查中发现问题，您已经签出了要修复的提交。

# css - 使用 CSS3 转换打开一个 DIV

> ID：11673435
> 
> 赞同：4
> 
> 时间：2012-07-26T16:04:54.153
> 
> 标签：css, rotation, css-transforms, rotatetransform

我有一个菜单，它必须出现在旋转 -90 度的一侧，如下图所示。

![在此处输入图像描述](../Images/7b63a9106765b323b7e1cb05b8d781c5.png)

注意：DIV 具有**动态宽度**，因此我们不能旋转它，然后使用`top:-XX`.

```
#rotateme {
    -webkit-transform: rotate(-90deg); 
    -webkit-transform-origin: 0 0; 
    position: absolute; 
    top: 250px; /*not going to work with dynamic width */
    left: 0px; 
} 
```

我尝试了很多使用 CSS3 转换和转换原点，但没有任何组合可以让我到达那里。

我在这里创建了一个小提琴（[http://jsfiddle.net/P2UQy/8/](http://jsfiddle.net/P2UQy/8/)），它随机创建了 div 的内容（动态宽度）。此小提琴还包括使用 CSS3 转换进行旋转的失败尝试。

任何人都可以让它像上图所示的那样工作吗？如果需要，请随意添加更多容器/包装器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T16:45:35.907

我已经更新了你的[**小提琴**](http://jsfiddle.net/raymondralibi/P2UQy/12/)。希望它会工作。

# iphone - 复制 NSMutableDictionary, ios

> ID：11673438
> 
> 赞同：-1
> 
> 时间：2012-07-26T16:05:00.307
> 
> 标签：iphone, ios, nsmutabledictionary

**鉴于：**

> 一个名为 oldDictionary 的现有 NSMutableDictionary。

**目标：**

> 将 oldDictionary 复制到另一个名为 newDictionary 的字典中，如果 newDictionary 已被修改——例如，某些键的值已更改——那么 oldDictionary 也应该更新以反映更改。

**问题：**

最好的方法是什么？

请就这个问题给我建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:23:43.913

不确定这是最好的方法，我相信你可以为旧的每个键值分配观察者

```
addObserver:forKeyPath:options:context: 
```

处理每一个变化

```
observeValueForKeyPath:ofObject:change:context: 
```

查看 KVO[参考](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Protocols/NSKeyValueObserving_Protocol/Reference/Reference.html)以获取详细信息。为什么没有将其作为标准功能实现的原因一定是因为那是矫枉过正。

# jquery - jQuery 手机。从主站点重定向使站点变小

> ID：11673439
> 
> 赞同：1
> 
> 时间：2012-07-26T16:05:01.070
> 
> 标签：jquery, redirect, mobile

我希望你能帮忙。我正在使用下面的代码设置基本重定向。

```
 $iphone = strpos($_SERVER['HTTP_USER_AGENT'],"iPhone");
$android = strpos($_SERVER['HTTP_USER_AGENT'],"Android");
$palmpre = strpos($_SERVER['HTTP_USER_AGENT'],"webOS");
$berry = strpos($_SERVER['HTTP_USER_AGENT'],"BlackBerry");
$ipod = strpos($_SERVER['HTTP_USER_AGENT'],"iPod");

if ($iphone || $android || $palmpre || $ipod || $berry == true){
    header('location: http://www.ignitiondrivingschool.mobi');
    exit();
} 
```

我已经在其他网站上毫无问题地做到了这一点，但是，当我从 dev.ignitiondrivinglessons.co.uk 重定向时，样式变小了。刷新手机中的页面，它恢复正常。

![直接来自重定向的小版本](../Images/5dde96f997ad011e3d419e81a1866afd.png) 直接来自重定向的小版本

![刷新页面后正常查看](../Images/d4438f9fe09f92b7effdd9d5af817dc7.png) 刷新页面后正常查看

任何帮助都会很棒。

谢谢马克

# android - 无法访问 Internet 时的 webview 启动画面

> ID：11673442
> 
> 赞同：0
> 
> 时间：2012-07-26T16:05:20.953
> 
> 标签：android, webview

我有一个`WebView`从[http://developer.android.com/guide/webapps/webview.html构建的简单应用程序](http://developer.android.com/guide/webapps/webview.html)

如果没有互联网访问，我想添加一些图像或消息。如何实施？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:25:26.937

试试这个代码来检查互联网连接：

```
public static boolean hasConnection() {
ConnectivityManager cm = (ConnectivityManager) MbridgeApp.getContext().getSystemService(
    Context.CONNECTIVITY_SERVICE);

NetworkInfo wifiNetwork = cm.getNetworkInfo(ConnectivityManager.TYPE_WIFI);
if (wifiNetwork != null && wifiNetwork.isConnected()) {
  return true;
}

NetworkInfo mobileNetwork = cm.getNetworkInfo(ConnectivityManager.TYPE_MOBILE);
if (mobileNetwork != null && mobileNetwork.isConnected()) {
  return true;
}

NetworkInfo activeNetwork = cm.getActiveNetworkInfo();
if (activeNetwork != null && activeNetwork.isConnected()) {
  return true;
}

return false; 
```

}

`ACCESS_NETWORK_STATE`还将和`ACCESS_WIFI_STATE`权限添加到您的清单文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:20:21.633

只需打开一个包含 JS 脚本的页面的本地 HTML 文件，该脚本检查它是否可以访问 Internet，如果可以，则浏览到该页面。否则，将显示您的图像。就像是：

```
<html>
<head>
<script>
  body.onload = function() {
    if(navigator.onLine) {
      location = "http://developer.android.com/guide/webapps/webview.html";
    }
  }
</script>
</head>
<body>
  <img src="x.png" />
</body>
</html> 
```

# nagios - * 错误：nrpe 没有启动功能

> ID：11673443
> 
> 赞同：1
> 
> 时间：2012-07-26T16:05:26.477
> 
> 标签：nagios, gentoo, nrpe

我在 Gentoo 虚拟机上安装了 Nagios-NRPE。

当我尝试使用启动 nrpe 时`/etc/init.d/nrpe start`，出现以下错误：

```
ERROR:  nrpe does not have a start function. 
```

但是，在我安装了 Nagios-NRPE 的其他 Gentoo 虚拟机上，我没有收到此错误。

什么可能导致此错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T12:25:29.093

在我的情况下，安装`openrc`使用很简单`emerge`：

出现-avq openrc

似乎`openrc`提供了必要的服务来解释`start`某些脚本，包括`/etc/init.d/nrpe`.

# android - Android相机按钮半按监听器

> ID：11673444
> 
> 赞同：3
> 
> 时间：2012-07-26T16:05:30.787
> 
> 标签：android, button, camera, listener, autofocus

我正在构建一个自定义相机应用程序，并且已经具备了可以使用的基础知识。我还能够阻止相机按钮初始化真正的相机应用程序。我唯一想做的就是在半按相机按钮时建立自动对焦。

我使用起来很舒服`camera.autofocus`，但找不到一种方法来监听半按相机按钮（就像默认相机应用程序一样）以启动自动对焦调用。

是否有键码或其他方式来监听相机按钮被按下到一半？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T19:29:11.347

我有点创意，只是在 android 中完成了任何按键事件。我最终发现相机对焦的关键代码是 80 这种方式。一旦我知道我在寻找什么，这也与 android 文档相匹配。

[http://developer.android.com/reference/android/view/KeyEvent.html](http://developer.android.com/reference/android/view/KeyEvent.html)

```
@Override
public boolean onKey(View v, int keyCode, KeyEvent event) {

    if(event.getAction()==KeyEvent.ACTION_DOWN){

        Toast.makeText(this, new Integer(keyCode).toString(), Toast.LENGTH_LONG).show();
        return true;
    }

    return false;
} 
```

希望这对其他人有帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-26T16:27:56.110

相机按钮是屏幕上的虚拟按钮，我不知道它是如何半按的，甚至可以以任何方式被模仿。

# backbone.js - Backbone Marionette - 切换视图时添加视觉效果

> ID：11673445
> 
> 赞同：14
> 
> 时间：2012-07-26T16:05:32.513
> 
> 标签：backbone.js, marionette

当我离开页面（关闭视图/布局）并在同一区域打开新页面时，是否有一种方便的方法来添加效果？（有点像淡入淡出效果）

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-07-27T02:26:08.350

Marionette 区域有一个方法称为`open`，默认情况下只需将旧视图的 HTML 替换为新视图。你可以重写这个方法来做任何你喜欢的动画。从[区域文档](https://github.com/derickbailey/backbone.marionette/blob/master/docs/marionette.region.md)：

## 设置视图的`el`附加方式

如果您需要在通过区域显示视图时更改视图附加到 DOM 的方式，请覆盖该`open`区域的方法。此方法接收一个参数 - 要显示的视图。

默认实现`open`是：

```
Marionette.Region.prototype.open = function(view){
  this.$el.html(view.el);
} 
```

这将用视图的 `el`/ 内容替换区域的内容。但是，您可以根据需要更改为任何内容，以促进过渡效果等。

```
Marionette.Region.prototype.open = function(view){
  this.$el.hide();
  this.$el.html(view.el);
  this.$el.slideDown("fast");
} 
```

这个例子将导致视图从区域的顶部向下滑动，而不是仅仅出现在原地。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-06-18T18:11:20.397

这似乎对我有用：

```
this.views = {
    messageItem: Marionette.ItemView.extend({
        template: Handlebars.templates.messaging_item,
        tagName: "li",
        className: "messaging-item",
        render: function(){
            this.$el.html(this.template(this.model.attributes));
            this.$el.hide();
        },
        onShow: function(){
            this.$el.slideDown(800);
        }
    })
}; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-07-26T18:55:24.560

您可以覆盖`close`视图上的函数，执行以下操作：

```
close: function () {
  // fancy fade-out effects
  Backbone.Marionette.View.prototype.close.apply(this, arguments);
} 
```

`render`并对你的函数做类似的事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-09-14T11:59:51.190

对于未来的用户，人们可以在木偶中使用我的插件来支持过渡。

[https://github.com/saqibshakil/Marionette.TransitionRegion/](https://github.com/saqibshakil/Marionette.TransitionRegion/)

我使用 css3 过渡，因为它们比 jquery 动画具有更多的硬件支持。不利的一面是使用它会使代码异步，所以要小心。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-11T10:09:00.397

我认为这可能对你有用。

以下木偶插件添加了 4 种过渡。可以轻松添加更多过渡类型。

基本上不是使用 yourRegion.show(view)... 你现在可以使用 yourRegion.showAnimated(view, {animationType: 'yourAnimation'});

它非常易于使用。

[https://github.com/marcinkrysiak1979/marionette.showAnimated](https://github.com/marcinkrysiak1979/marionette.showAnimated)

有关更多信息，请参阅 github 上的文档

# objective-c - XCode 选项卡式应用程序不会加载图标

> ID：11673447
> 
> 赞同：0
> 
> 时间：2012-07-26T16:05:34.213
> 
> 标签：objective-c, ios, cocoa-touch

我正在创建一个选项卡式应用程序，但在让我的图标显示在选项卡上时遇到了一些问题。我已经将我的代码与我之前在书中编写的示例进行了比较，它似乎匹配，但是新应用程序中的图标只是显示为空白方块。我已尝试包含所有相关代码，但不包含所有繁琐的部分，但如果您想查看更多内容，请询问，我会根据需要进行更多编辑。我已经检查过 imageNamed:string 和图标名称的大小写是否相同。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    ... // initializers for ViewControllers 1-3, which are custom viewControllers
        // that have the tab properties set in (void)viewDidLoad
    globalUINavigationController = [[UINavigationController alloc] initWithNibName:
                                @"DemoTabbedFourthViewController" bundle:nil];
    globalUINavigationController.title = NSLocalizedString(@"Fourth", @"Fourth");
    globalUINavigationController.tabBarItem.image = [UIImage imageNamed:@"fourth.png"];

    UIViewController *viewController4 = [[DemoTabbedFourthViewController alloc] 
                    initWithNibName:@"DemoTabbedFourthViewController" bundle:nil];

    [globalUINavigationController pushViewController:viewController4 animated:YES];
    self.tabBarController = [[UITabBarController alloc] init];
    self.tabBarController.viewControllers = [NSArray arrayWithObjects:viewController1, viewController2,
                                         viewController3, globalUINavigationController, nil];
    self.window.rootViewController = self.tabBarController;
    [self.window makeKeyAndVisible];
} 
```

我使用 globalUINavigationController 作为我的示例，因为如果我能让那个工作，我应该能够让其他人基于它工作。如果您对代码有任何问题或意见，请告诉我。我是 Objective C 和 iPhone App 开发的新手，我会尽我所能获得帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:13:24.100

那是因为图像太大，或者您的图标是正方形。我的意思是，XCode 只会将您的图像作为蒙版抓取（意味着颜色无关紧要）。它必须是 PNG 图像，大小约为 30x30。来自类参考；

> 图像 项目的图像。如果为零，则不显示图像。标签栏上显示的图像来自此图像。如果此图像太大而无法放在选项卡栏上，则会对其进行裁剪以适应。标签栏图像的大小通常为 30 x 30 点。源图像中的 alpha 值用于创建未选中和选中的图像——不透明的值将被忽略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:18:24.853

我认为问题在于您使用 nib 文件初始化 UINavigationController 。我实际上从未尝试过这个。您应该首先初始化 ViewController，然后将其添加到 NavigationController 的初始消息中。此外，您必须在内容视图控制器上设置标题，而不是在导航控制器上，因为导航控制器向其 topViewController 询问它应该显示的标题。

我还没有编译下面的代码，所以可能会缺少一些逗号或类似的东西，但它应该让你明白我的意思。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    ... // initializers for ViewControllers 1-3, which are custom viewControllers
        // that have the tab properties set in (void)viewDidLoad
    UIViewController *viewController4 = [[DemoTabbedFourthViewController alloc] 
                initWithNibName:@"DemoTabbedFourthViewController" bundle:nil];

    globalUINavigationController = [[UINavigationController alloc] initWithRootViewController:viewController4];
    globalUINavigationController.tabBarItem.image = [UIImage imageNamed:@"fourth.png"];

    [globalUINavigationController pushViewController:viewController4 animated:YES];
    self.tabBarController = [[UITabBarController alloc] init];
    self.tabBarController.viewControllers = [NSArray arrayWithObjects:viewController1, viewController2,
                                     viewController3, globalUINavigationController, nil];
    self.window.rootViewController = self.tabBarController;
    [self.window makeKeyAndVisible];
} 
```

如果这不能解决问题，可能是因为您的图标文件是常规图像。只有图像的 alpha 通道用于标签栏项目。

//编辑：在这种情况下，看看这个问题：[UITabBarItem 图像只是显示为灰色块](https://stackoverflow.com/questions/8616820/uitabbaritem-images-just-appear-as-a-grey-block)

# java - 如果对象由多维数组保存，我可以使用该方法吗？

> ID：11673451
> 
> 赞同：1
> 
> 时间：2012-07-26T16:05:59.813
> 
> 标签：java, object, jcombobox, jtextfield, multidimensional-array

我看到了一些非常相似的帖子，但没有找到重点。

我在想这样的事情：

```
Object[][] test = {
          {"Name", new JTextField()},
          {"Gender", new JComboBox()}
} 
```

我试过这样的东西，但我不能使用 JTextField 或 JComboBox 的方法。如何根据那里的 1-index 实例化它？这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T16:09:21.373

如果你确定它是什么，你拿出来就可以施放，像这样

```
JComboBox box = (JComboBox)(test[1][1]);
box.whatever(); 
```

`Object[][]`但是，为什么不使用 ，而不是只创建一个类？

```
class UIWidgets {
    JTextField name;
    JComboBox gender;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T16:08:42.993

您需要先进行强制转换，然后才能访问特定于该类型的方法，因为 Java 将它们都视为以下实例`Object`：

```
((JTextField)test[0][1]).CallMethodHere(); 
```

或者：

```
JTextField tf = (JTextField)test[0][1];
// do something with tf 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:09:13.027

尝试这个：

```
((JTextField) test[0][1]).setText("someText"); 
```

# python - 使用 Pandas 库将历史 Metatrader CSV 数据导入 Python（日期/时间解析）

> ID：11673453
> 
> 赞同：2
> 
> 时间：2012-07-26T16:06:06.653
> 
> 标签：python, parsing, csv, pandas, metatrader4

我有一些 CSV 数据，例如

```
2011.12.08,22:45,1.33434,1.33465,1.33415,1.33419,265
2011.12.08,23:00,1.33419,1.33542,1.33419,1.33472,391
2011.12.08,23:15,1.33470,1.33483,1.33383,1.33411,420
2011.12.08,23:30,1.33413,1.33451,1.33389,1.33400,285 
```

来自 Metatrader 4 的名为 EURUSD15.csv 的文件

我想用 Python 导入这个文件，使用 Pandas 库和 read_csv 函数......

所以我这样做了：

```
#!/usr/bin/env python
from pandas import *
df = read_csv('data/EURUSD15.csv', header=None)
df.columns = ['Date', 'Time', 'Open', 'High', 'Low', 'Close', 'Volume']
print(df) 
```

我现在想解析日期/时间...

所以我改变了

```
df = read_csv('data/EURUSD15.csv', header=None) 
```

至

```
df = read_csv('data/EURUSD15.csv', header=None, parse_dates=[[1, 2]]) 
```

但我收到此错误消息

> ```
> Exception: Length mismatch (7 vs 6) 
> ```

如何解析日期和时间列并将 2 列视为 1 个“日期时间”列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T08:29:34.860

这些列是零索引的，所以你需要这样做 这是在最新版本的熊猫上，但应该适用于 0.8.0+：**`parse_dates=[[0,1]]`**

```
In [74]: data = """\
2011.12.08,22:45,1.33434,1.33465,1.33415,1.33419,265
2011.12.08,23:00,1.33419,1.33542,1.33419,1.33472,391
2011.12.08,23:15,1.33470,1.33483,1.33383,1.33411,420
2011.12.08,23:30,1.33413,1.33451,1.33389,1.33400,285
"""

In [75]: pd.read_csv(StringIO(data), 
                     names=['Date', 'Time', 'Open', 'High', 'Low', 'Close', 'Volume'], 
                     index_col='Date_Time', parse_dates=[[0, 1]])
Out[75]: 
                        Open     High      Low    Close  Volume
Date_Time                                                      
2011-12-08 22:45:00  1.33434  1.33465  1.33415  1.33419     265
2011-12-08 23:00:00  1.33419  1.33542  1.33419  1.33472     391
2011-12-08 23:15:00  1.33470  1.33483  1.33383  1.33411     420
2011-12-08 23:30:00  1.33413  1.33451  1.33389  1.33400     285 
```

请注意，这`index_col=0`也将起作用。复杂的日期解析将结果列放在前面，因此 parse_dates 将引用处理日期前的列索引（即，0 是日期，1 是时间）并`index_col`引用处理日期后的列索引。因此，建议使用列名，因为它使您不必考虑处理前后的列索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:20:19.343

parse_dates 不采用索引值。

尝试类似：

```
pd.read_csv('data/EURUSD15.csv',  parse_dates = [['YYYY.MM.DD', 'HH:MM']], index_col = 0, 
        date_parser=parse) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T00:28:05.867

```
parse = lambda x: datetime.strptime(x, '%d-%m-%Y %H:%M')
df = pd.read_csv('data/EURUSD15.csv', parse_dates=[[0, 1]], date_parser=parse, index_col=[0],   header=None)
keys = ['Open', 'High', 'Low', 'Close','Volume']
df.columns = [x for x in keys] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-15T14:12:27.683

easier method is using the drag and drop solution called [pytrader](https://github.com/TheSnowGuru/PyTrader-python-mt4-mt5-trading-api-connector-drag-n-drop), check it out on github.

# flash - Web 应用程序中内存管理的职责在哪里？

> ID：11673456
> 
> 赞同：0
> 
> 时间：2012-07-26T16:06:18.147
> 
> 标签：flash, internet-explorer, memory, browser, memory-leaks

我正在尝试调试客户端的一系列问题，这些问题似乎与我们的 Web 应用程序面临内存泄漏问题。在录制了一个简单地反复浏览我们的 Web 应用程序的宏脚本后，我们发现随着时间的推移，所有主流浏览器都会消耗越来越多的内存，这会导致 flash 和 javascript 等许多内存不足的问题。Internet explorer 是需要内存的最大罪魁祸首在 25 分钟内提交近 1.5 GB。我们的网络应用程序大量使用闪存，从我的研究来看，这也是一个很大的内存泄漏cuprit。说了这么多，我的问题是什么主要负责内存管理？我知道浏览器负责释放和占用进程级别的内存，但是如果我们观察到持续使用的内存泄漏，我们应该关注什么来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T09:48:08.350

您需要澄清几件事。如果问题似乎与 Flash 有关，您是重新加载包含 Flash 小程序的整个页面还是继续使用它？

如果您重新加载它 - 问题可能出在 JavaScript 方面，其中一些对 Flash 对象的 JavaScript 引用在查看单个页面的会话中持续存在（这很少见但并非不可能，在某些时候 Skype 会导致其覆盖层出现此类问题对于可调用的电话号码，它们在 ExternalInterface 包装器中弄乱了一些东西，不仅导致它们自己，而且包含 Flash 的每个页面都永远保留在浏览器的内存中）。

Flash小程序，如果你不重新加载它，它应该自己管理自己的内存，浏览器，插件包装器，甚至播放器都不负责。但是，Flash 使用类似于 Java 的内存管理模型，这意味着它在技术上无法分配应用程序关闭后不会回收的内存，这意味着如果您确保重新加载 Flash 小程序，那么即使小程序本身是泄漏，在它被卸载后，它使用的所有内存都应该被回收。

一般来说，AS3 使用更高级的编程，与 JavaScript 相比，它更多，所以，我会开始寻找那里的问题（因为在更复杂的代码中出错的可能性更大）。Flash 有几个可用的内存分析器。Flash Builder 中有一个，FlashDevelop 也有一个，还有一个已知不绑定到任何 IDE：http: [//jpauclair.net/2012/07/11/new-tutorial-profiling-memory-with-theminer/](http://jpauclair.net/2012/07/11/new-tutorial-profiling-memory-with-theminer/) 还有一个一个名为 Monocle（以前是 Telemetry）的项目，我不确定它是否已经发布，但 Adob​​e 在上一次 MAX 活动中展示了它，这里有一位 Adob​​e 工程师在谈论它：[https://adobechats.adobeconnect .com/_a200985228/p4khwz03sz9/?launcher=false&fcsContent=true&pbMode=normal](https://adobechats.adobeconnect.com/_a200985228/p4khwz03sz9/?launcher=false&fcsContent=true&pbMode=normal)（更接近演示文稿的中间）。

至于 JavaScript，这是我前段时间遇到的：[https](https://wiki.mozilla.org/Performance%3aLeak_Tools) ://wiki.mozilla.org/Performance%3aLeak_Tools来自 Mozilla 的建议。但是，我还记得需要从源代码构建 Mozilla 浏览器以启用内存分析（如果这样做，您需要设置一些与分析器输出相关的变量）。以下是 Chrome 上的类似信息：http: [//zetafleet.com/blog/google-chromes-heap-profiler-and-memory-timeline](http://zetafleet.com/blog/google-chromes-heap-profiler-and-memory-timeline)。也许，Visual Studio 中有一些工具可以在 IE 中分析 JavaScript - 我不知道。

# android - BroadcastReceiver 不捕捉电话状态

> ID：11673457
> 
> 赞同：0
> 
> 时间：2012-07-26T16:06:22.213
> 
> 标签：android, broadcastreceiver, phone-state-listener

我正在尝试启动一个新应用程序，但我需要了解手机状态的变化......由于某种原因（我对此不熟悉）我无法捕捉到变化的广播。那是我的代码：

```
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.util.Log;

public class MyReceiver extends BroadcastReceiver {
@Override
public void onReceive(Context context, Intent intent) {
    Log.d("TAG","yyyyyyyyyyyy");
}
} 
```

这就是我的清单：

```
<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />
<uses-permission android:name="android.permission.READ_PHONE_STATE"/>
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <receiver
        android:name=".MyReceiver">
         <intent-filter>
            <action android:name="android.intent.action.PHONE_STATE"/>
        </intent-filter>
    </receiver>
</application> 
```

如您所见...非常简单。但我在 LogCat 上的 onReceive 中看不到日志。有人知道为什么吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T17:35:54.013

由于[this](http://developer.android.com/about/versions/android-3.1.html#launchcontrols)和[this](http://commonsware.com/blog/2011/07/13/boot-completed-regression-confirmed.html)，您的 BroadcastReceiver 将不会收到任何内容。解决方案是为您的应用程序设计一个简单的活动，该活动在安装后至少启动一次，然后才开始接收。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:14:18.593

为了注册基于 Manifest 的广播接收器，您需要通过从应用程序抽屉打开它来运行您的应用程序。如果你不这样做，那么接收器将不会被 Android 调用。所以基本上，你至少需要一个可以启动的活动——它不需要做任何事情，只需要至少启动一次。是你做的吗？

在 Android 3.0+ 之后是这样

# jquery - 使用css时如何将一个div放在另一个div上？

> ID：11673460
> 
> 赞同：1
> 
> 时间：2012-07-26T16:06:35.060
> 
> 标签：jquery, html, css

我对 css 和 JQuery 很陌生，我对这个问题感到很困惑。我的代码很短，如下所示：

```
<script>
$(document).ready(function(){
    $(".square-2").hide();
    $(".square-3").hide();

    $("#btn-1").click(function(){
        $(".square-2").fadeOut(); $(".square-3").fadeOut(); $(".square-1").fadeIn();
    });
    $("#btn-2").click(function(){
        $(".square-1").fadeOut(); $(".square-3").fadeOut(); $(".square-2").fadeIn();
    });
    $("#btn-3").click(function(){
        $(".square-1").fadeOut(); $(".square-2").fadeOut(); $(".square-3").fadeIn();
    });
});</script>
</head>

<body>
<div id="container">
    <div id="square" class="square-1"></div>
    <div id="square" class="square-2"></div>
    <div id="square" class="square-3"></div>
</div>
<center><button id="btn-1">square-1</button><button id="btn-2">square-2</button><button id="btn-3">square-3</button></center>
</body> 
```

对应的css文件如下：

```
#container{
    width:300px;    
    margin:auto auto;
    position:relative;
    border:1px solid;
}

#square{
    position:relative;
    margin:auto auto;
    width:200px;
    height:200px;
}

.square-1{
    background:#CC66CC;
}
.square-2{
    background:#FFFF00;
}
.square-3{
    background:#66FF00;
} 
```

我只有3个相同大小的正方形，我想把它们都放在同一个地方。当我单击每个按钮时，我希望相应的正方形淡入，而其他 2 个淡出。应该如何利用*div id*和*class*来实现效果呢？

PS：我听说在同一个html中使用多个同名的id不是一个好习惯，例如这里的“正方形”。那么我应该如何解决这个问题呢？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:13:27.430

第一：`id`是具有唯一值的属性；您的 HTML 中不能有多个`id="square"`。这甚至不是“不是一个好习惯”，而是被 HTML 标准禁止的。

第二：你应该绝对定位“正方形”；父元素 ( `#container`) 应该有一个`position: relative;`. 相对位置是指当前位置之前的元素——`.square-2`在`square-3`.

第三：如果您的“方块”没有内容，则无需将它们淡入淡出 - 只需更改背景颜色即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T17:00:19.543

这是我正在工作的代码的[jsFiddle 。](http://jsfiddle.net/DKDKE/3/)

我更改了您的样式，以便有一个定义大小的正方形类。然后，我创建了一个名为 squareContainer 的 div，我用它来将框定位在中心。这是必需的，因为绝对定位的彩色框会忽略边距。squareContainer 有助于定义它们的形状和空间，这样它就不会弄乱布局的其余部分。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:43:13.913

你有一个好的开始，只是有几件事需要清理。

1.  正如@feeela 提到的，您需要具有唯一的 Id 属性。看起来你只是有类和 id trans-versed
2.  设置你的css类的继承思想。
3.  您的 JavaScript 代码需要一些工作，因此您不会进行多次调用考虑挂钩所有按钮并相应地淡化图像。

**CSS**

```
.square {
    position:relative;
    margin:auto auto;
    width:200px;
    height:200px;
}
.square.one{
    background:#CC66CC;
}
.square.two{
    background:#FFFF00;
}
.square.three{
    background:#66FF00;
} 
```

**HTML** 注意[data 属性的使用](http://www.w3schools.com/tags/att_object_data.asp)

```
<div id="container">
    <div id="square1" class="square one">Square One</div>
    <div id="square2" class="square two">Square Two</div>
    <div id="square3" class="square three">Square Three</div>
</div>
<div id="buttons">
    <button id="btn-1" data-linkedto="square1">square-1</button><button id="btn-2" data-linkedto="square2">square-2</button><button id="btn-3" data-linkedto="square3">square-3</button>
</div> 
```

**Javascript** 这是最好的解决方案，因为它可以使用一些修饰，但它应该让你思考正确的方向。

```
$("button", "#buttons").click(function () {
    var $me = $(this);
    var linkedTo = $me.data('linkedto');
    $("#container").children().fadeOut("fast");
    $("#" + linkedTo, "#container").fadeIn();
}); 
```

# asp.net-mvc-3 - 控制器操作完成后使用 Javascript 隐藏图像 MVC3

> ID：11673467
> 
> 赞同：6
> 
> 时间：2012-07-26T16:07:02.813
> 
> 标签：asp.net-mvc-3

我的应用程序已使用 MVC 3、.net 实现。我正在尝试通过单击按钮生成一个 excel 文件。使用 Ajax 调用控制器操作。我的主要问题是：在文件生成期间，我试图在屏幕上显示图像以让用户知道正在进行的操作。我可以很好地显示图像，但操作完成后我无法隐藏它。正在使用的代码是：

Javascript代码：

```
$("input.DownloadExcelReport").click(function (e) {
   e.preventDefault();
   var parameter = -- code to fetch parameter value;
   var outputViewUrl = (the url is created here);
   showLoading(); -- This function displays the image
   window.location.href = outputViewUrl;
}); 
```

控制器动作代码：

```
public ActionResult DownExcelReportForAssortment(Guid parameter)   
{

       try
       {

           //the contents for the file generation are fetched here..   
           // Write contents to excel file
           if (memoryStream != null)
           {
                var documentName = "Report.xls";
                byte[] byteArrary = memoryStream.ToArray();
                return File(byteArrary, "application/vnd.ms-excel", documentName);
           }
       }
       catch (Exception ex)
       {
           LogManager.LogException(ex);
       }
} 
```

我不会将 Json 结果返回给调用 javascript 方法，我可以在其中编写代码来隐藏图像。我正在返回一个可以由用户保存的文件并且操作已完成。

文件生成操作完成后，有人可以建议/帮助我如何隐藏图像吗？

感谢帮助...

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-26T17:12:07.307

您可以查看[以下文章](http://webcache.googleusercontent.com/search?q=cache%3ahttp://geekswithblogs.net/GruffCode/archive/2010/10/28/detecting-the-file-download-dialog-in-the-browser.aspx&hl=en&strip=1)并将其付诸实践。所以我们从定义一个控制器开始：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        return View();
    }

    public ActionResult DownExcelReportForAssortment(Guid parameter, string tokenId)
    {
        // Simulate some heavy work to fetch the report
        Thread.Sleep(5000);

        // we fake it
        byte[] byteArray = System.IO.File.ReadAllBytes(@"c:\test.xls");

        var cookie = new HttpCookie("fileDownloadToken", tokenId);
        Response.AppendCookie(cookie);

        return File(byteArray, "application/vnd.ms-excel", "report.xls");
    }
} 
```

在视图中：

```
@Html.ActionLink(
    "download report",
    "DownExcelReportForAssortment",
    "Home",
    new { parameter = Guid.NewGuid(), tokenId = "__token__" },
    new { @class = "download" }
) 
```

现在最后一步是包含[jquery.cookie](https://github.com/carhartl/jquery-cookie/)插件：

```
<script type="text/javascript" src="@Url.Content("~/scripts/jquery.cookie.js")"></script> 
```

并编写脚本订阅主播的点击事件并跟踪下载进度：

```
$(function () {
    var fileDownloadCheckTimer;

    $('.download').click(function () {
        var token = new Date().getTime();
        $(this).attr('href', function () {
            return this.href.replace('__token__', token);
        });

        // Show the download spinner
        $('body').append('<span id="progress">Downloading ...</span>');

        // Start polling for the cookie
        fileDownloadCheckTimer = window.setInterval(function () {
            var cookieValue = $.cookie('fileDownloadToken');
            if (cookieValue == token) {
                window.clearInterval(fileDownloadCheckTimer);
                $.cookie('fileDownloadToken', null);

                // Hide the download spinner
                $('#progress').remove();
            }
        }, 1000);
    });
}); 
```

# sql-server - 更改 SQL Server 2008 中的超时长度

> ID：11673468
> 
> 赞同：2
> 
> 时间：2012-07-26T16:07:06.170
> 
> 标签：sql-server, sql-server-2008

我对所有变量类型进行了批量插入，`varchar(max)`因为我尝试执行的所有其他插入（当然，这些不是批量插入，而是右键单击数据库名称、导入数据的 IS 组件）都出现截断错误。

现在，当我尝试转换为我需要的数据类型时，我收到一个超时过期错误，指出该过程花费了太长时间。我可以，但是只是做一个简单的

```
alter table X alter column X int 
```

类型声明有效。

我的问题是，为什么它以一种方式工作而不是另一种？如何更改 SQL Server 的超时时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T18:00:44.010

您是否在 SSMS 中运行上述语句？如果是这样，您应该能够在连接到服务器时将执行超时值设置为 0（无超时限制）。在 Connect to Server 窗口中，按 Options 按钮，有一个 Execution time-out 选项。确保它为 0。

# ios - UIButton 的 imageView 属性和 hidden/alpha 值

> ID：11673479
> 
> 赞同：6
> 
> 时间：2012-07-26T16:07:44.063
> 
> 标签：ios, uikit, uibutton, hidden, alpha

我有一个 UIButton 在某些情况下应该显示活动指示器而不是图像。我现在所做的是将按钮的 imageView 的隐藏属性设置为 YES 并返回。我还尝试将 alpha 值设置为 0.0f 并返回到 1.0f。

这一直有效，直到按钮的状态发生变化。这会重置 imageView 的属性并导致 hidden == NO 和 alpha == 1.0f。

有没有人做过类似的事情或知道如何隐藏按钮的 imageView 而其余部分保持可见？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2016-12-11T21:04:58.813

您可以通过使用视图层的变换属性来实现这一点，即

## 隐藏

SWIFT代码

```
button.imageView?.layer.transform = CATransform3DMakeScale(0.0, 0.0, 0.0) 
```

Objective-C 代码

```
button.imageView.layer.transform = CATransform3DMakeScale(0, 0, 0); 
```

## 取消隐藏

```
button.imageView?.layer.transform = CATransform3DIdentity 
```

Objective-C 代码

```
button.imageView.layer.transform = CATransform3DIdentity 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-04-10T11:24:25.230

很简单。按钮有不同的状态。**只需为选定状态**设置零图像，为**正常状态**设置图像。当您想要显示活动指示器时，将按钮状态设置为选中并将指示器添加为按钮子视图。

```
- (void)initializeButton {
    button = [[UIButton alloc] init];
    [button addTarget:self action:@selector(buttonDidClick:) forControlEvents:UIControlEventTouchUpInside];

    [button setImage:[[UIImage alloc] init] forState:UIControlStateSelected]; //zero image
    [button setImage:yourImage forState:UIControlStateSelected]; //your image
}

- (void)buttonDidClick:(UIButton *)button {
    button.selected = YES;
    /* Add yor activity indicator with some view tag or save reference to it */
} 
```

活动完成后调用 next 方法

```
- (void)finishActivityWithButton:(UIButton *)button {
    button.selected = NO;
    /* Remove your activity indicator from button */
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-09T22:01:28.750

如果您使用的是模板图像，请将色调颜色设置为 [UIColor clearColor]（可能也适用于其他人，没有尝试）

```
[[button imageView] setTintColor:[UIColor clearColor]]; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-26T17:15:21.393

您可以通过在要隐藏图像时从按钮中删除图像并在需要显示图像时将图像分配回按钮来实现此目的。

当您想隐藏图像时，可以这样写：

```
[yourButton setImage:nil forState:UIControlStateNormal]; 
```

并且当您想要显示图像时：

```
[yourButton setImage:yourImage forState:UIControlStateNormal]; 
```

这`yourButton`是您的`UIButton`，并且`yourImage`是`UIImage`保存按钮图像的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-20T07:40:11.817

更改转换或选择状态会导致另一个问题，最好的方法是使用类别：

```
const char kNormalImage;
const char kSelectImage;
const char kDisableImage;

@interface UIButton ()

@property (nonatomic, strong) UIImage *normalImage;
@property (nonatomic, strong) UIImage *selectImage;
@property (nonatomic, strong) UIImage *disableImage;

@end

@implementation UIButton (Hidden)

- (void)setImageViewHidden:(BOOL)hidden {
    if (hidden) {
        self.normalImage = [self imageForState:UIControlStateNormal];
        self.selectImage = [self imageForState:UIControlStateSelected];
        self.disableImage = [self imageForState:UIControlStateDisabled];

        UIGraphicsBeginImageContextWithOptions(self.imageView.bounds.size, NO, 0.0);
        UIImage *blank = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();

        [self setImage:blank forState:UIControlStateNormal];
        [self setImage:blank forState:UIControlStateSelected];
        [self setImage:blank forState:UIControlStateDisabled];
    } else {
        [self setImage:self.normalImage forState:UIControlStateNormal];
        [self setImage:self.selectImage forState:UIControlStateSelected];
        [self setImage:self.disableImage forState:UIControlStateDisabled];
    }
}

- (UIImage *)normalImage {
    return objc_getAssociatedObject(self, &kNormalImage);
}

- (void)setNormalImage:(UIImage *)normalImage {
    objc_setAssociatedObject(self, &kNormalImage, normalImage,  OBJC_ASSOCIATION_RETAIN_NONATOMIC);
}

- (UIImage *)selectImage {
    return objc_getAssociatedObject(self, &kSelectImage);
}

- (void)setSelectImage:(UIImage *)selectImage {
    objc_setAssociatedObject(self, &kSelectImage, selectImage,  OBJC_ASSOCIATION_RETAIN_NONATOMIC);
}

- (UIImage *)disableImage {
    return objc_getAssociatedObject(self, &kDisableImage);
}

- (void)setDisableImage:(UIImage *)disableImage {
    objc_setAssociatedObject(self, &kDisableImage, disableImage,    OBJC_ASSOCIATION_RETAIN_NONATOMIC);
}

@end 
```

# c# - 面板中对象的“单击并拖动鼠标悬停”行为

> ID：11673491
> 
> 赞同：1
> 
> 时间：2012-07-26T16:08:44.527
> 
> 标签：c#, winforms, mouseevent, panel

*我会尽量保持这个通用性以供将来参考。*

假设我们的表单有一个正方形网格（我们将分别称为“点”的矩形形状。）由于这个网格的大小在表单加载之前可能会发生变化，所以我们第一次在面板中创建了所有点加载我们的表格并可以使用...

```
foreach (Squares point in mySquares) 
```

...当我们想要改变他们的行为或外表时。现在，我们已经开发了代码来在用户单击左或右时更改每个点的颜色。它看起来像：

```
private void panelGrid_MouseDown(object sender, MouseEventArgs e)
{
    if (e.Button == MouseButtons.Left || e.Button == MouseButtons.Right)
    {
        foreach (Squares point in mySquares)
        {
            if (point.Rectangle.Contains(e.Location))     // determine which point to use
            {
                if (e.Button == MouseButtons.Left)
                {
                    Pencil(point);        // left-click to fill color
                }
                else
                {
                    Erase(point);       // right-click to erase color
                }
            }
        }
    panelGrid.Invalidate();            // refreshes grid
    }
} 
```

这就像一个魅力。但是假设我们需要更改此代码： *现在我们还希望在按住鼠标按钮并将光标移动到新点时更改颜色*。（有点像 MS-Paint：将铅笔工具拖到多个像素上依次填充每个像素。）

让我感到困惑的是正确实施此行为的正确方法。据我了解，我希望 Pencil/Eraser 方法在以下情况下调用：

**A.)**鼠标进入一个“点”**并且**一个按钮已经被按住。

**或者**

**B.)**鼠标按钮被按下。（见上面的代码）

**这对我来说变得棘手**的是确定如何最好地实施新检查，以及如何在网格中的各个点上执行它们——或者即使这是必要的。有小费吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:13:49.783

听起来您希望 MouseDown 和 MouseMove 事件做同样的事情：

```
private void MouseStuff(MouseEventArgs e) {
  if (e.Button == MouseButtons.Left || e.Button == MouseButtons.Right)
  {
    foreach (Squares point in mySquares) {
      if (point.Square.Contains(e.Location)) {
        if (e.Button == MouseButtons.Left) {
          Pencil(point);
        } else {
           Erase(point);
        }
      }
    }
    panelGrid.Invalidate();
  }
} 
```

然后尝试从两个事件中调用它：

```
private void panelGrid_MouseDown(object sender, MouseEventArgs e) {
  MouseStuff(e);
}

private void panelGrid_MouseMove(object sender, MouseEventArgs e) {
  MouseStuff(e);
} 
```

考虑使用双缓冲面板来减少控件的抖动，因为在 MouseMove 事件上使面板无效可能非常密集：

```
public class BufferedPanel : Panel {
  public BufferedPanel() {
    this.DoubleBuffered = true;
    this.ResizeRedraw = true;
  }
} 
```

# css - 如何在css3中的图像上浮动文本

> ID：11673492
> 
> 赞同：0
> 
> 时间：2012-07-26T16:08:45.067
> 
> 标签：css

如何在图像上对齐文本？我尝试使用绝对位置，但它在图像下方，因为图像处于绝对位置。文本必须在框中的图像下方，就像这张图片[http://s8.postimage.org/tsrcam791/image.png](http://s8.postimage.org/tsrcam791/image.png)或文本必须漂浮在图像上

css

```
.image_stack img { /* css style for photo stack */
border: none;
text-decoration: none;
position: absolute;
margin-left:0px;
width: 170px;
height: 160px;

}
.image_stack { /* css style for photo stack */
width: 200px;
position: relative;
padding-left:20px;
margin-bottom:40px;
float:left;

}
 .image_stack img { /* css style for photo stack */
position: absolute;
border: 4px solid #FFF;
box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5);
-moz-box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5);
-webkit-box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5);
z-index: 9999;
/* Firefox */
-moz-transition: all 0.2s ease;
/* WebKit */
-webkit-transition: all 0.2s ease;
/* Opera */
-o-transition: all 0.2s ease;
/* Standard */
transition: all 0.2s ease;
}
.image_stack #photo1 {  /* position of last photo in the stack */
top: 8px;
left: 108px;
}
.image_stack #photo2 {/* position of middle photo in the stack */
top: 6px;
left: 104px;
} 
.image_stack #photo3 {/* position of first photo at the top in the stack */
top: 4px;
left: 100px;
right: 100px;
}
.image_stack .rotate1 {/* rotate last image 15 degrees to the right */
-webkit-transform: rotate(15deg); /* safari and chrome */
-moz-transform: rotate(15deg);/*firefox browsers */
transform: rotate(15deg);/*other */
-ms-transform:rotate(15deg); /* Internet Explorer 9 */
-o-transform:rotate(15deg); /* Opera */
}
.image_stack .rotate2 {/* css not used*/
-webkit-transform: rotate(0deg); /* safari and chrome */
-moz-transform: rotate(0deg);/*firefox browsers */
transform: rotate(0deg);/*other */
-ms-transform:rotate(0deg); /* Internet Explorer 9 */
-o-transform:rotate(0deg); /* Opera */
}
.image_stack .rotate3 {/*rotate first image 15 degrees to the left*/
-webkit-transform: rotate(-15deg); /* safari and chrome */
-moz-transform: rotate(-15deg); /*firefox browsers */
transform: rotate(-15deg);/*other */
-ms-transform:rotate(-15deg); /* Internet Explorer 9 */
-o-transform:rotate(-15deg); /* Opera */
cursor: pointer;
 } 
```

```
<div class="image_stack" style="margin-left:0px;" >
<img id="photo1" class="stackphotos" src="photos/2.jpg"  >
<img  id="photo2" class="stackphotos" src="photos/3.jpg" >
 <img   id="photo3" class="stackphotos"  src="photos/1.jpg" >

<div  style="position:absolute;left:150px;top:130px;display:block;background:#eee;width:180px;">  text</div>

 </div>
 <div class="image_stack"style="margin-left:0px;" >
 <img id="photo1" class="stackphotos" src="photos/2.jpg"  >
 <img  id="photo2" class="stackphotos" src="photos/3.jpg" >
 <img   id="photo3" class="stackphotos"  src="photos/1.jpg" > 
 </div>
<div class="image_stack"style="margin-left:0px;" >
<img id="photo1" class="stackphotos" src="photos/2.jpg"  >
 <img  id="photo2" class="stackphotos" src="photos/3.jpg" >
 <img   id="photo3" class="stackphotos"  src="photos/1.jpg" > 
 </div> 
 </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:11:46.807

您还需要在图像和文本 div 上实现 z-index 属性。为图像提供比文本 div 更低的 z-index。那应该为你排序。

# python - python 中的 C++ 向量实例（用于 pyROOT 中的 TTrees）

> ID：11673493
> 
> 赞同：3
> 
> 时间：2012-07-26T16:08:47.747
> 
> 标签：python, c++, boost, cython, root-framework

我正在尝试在 python 中使用`pyROOT`. 我从具有多个分支的 TTree 获取信息，其中一些是 C++ 类型或`vector<int>`' s。`vector<float>``vector<string>`

为了将信息传递到新树中，我需要从旧树中访问它，我需要将向量等的地址传递给树，然后填充树。为此，我需要访问这样一个新向量的地址。这在 C++ 中很容易，但是在查看 Cython 和 boost 之后，我无法解决。最终我想要类似的东西：

```
cppintvectorinpython = getcppintvector()    
oldtree.setbranchaddress(branchname,cppintvectorinpython) 
```

这可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T17:22:45.950

CINT 为您导出了许多 STL 类，其中`std::vector`. `std::vector<double>`从 pyROOT创建例如一个

```
import ROOT as r
vec = r.vector('double')() 
```

由于 pyROOT，设置的分支地址`TTree`非常透明，例如，您不需要使用指针

```
tree = r.gDirectory.Get('oldtree')
tree.SetBranchAddress("vec_branch_name", vec) 
```

# android - 为 gridview 设置适配器时出现 NullPointerException

> ID：11673496
> 
> 赞同：0
> 
> 时间：2012-07-26T16:08:55.883
> 
> 标签：android, gridview, adapter

当我想为网格视图设置自定义适配器时，这行代码出现错误

```
 gvRecipes.setAdapter(recipeAdapter); 
```

更多代码

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    txtHeaderTitle = (TextView) findViewById(R.id.txtHeaderTitle);
    imgHeader = (ImageView) findViewById(R.id.imgHeader);
    gvRecipes = (GridView) findViewById(R.id.gvRecipes);

    ArrayList<Recipe> listOfRecipes = new ArrayList<Recipe>();

    String names[] = getResources().getStringArray(R.array.recipe_name);
    for(int i=0;i<names.length;i++){
        Recipe r1 = new Recipe();
        r1.id = i;
        r1.name =getResources().getStringArray(R.array.recipe_name)[i];
        r1.image =getResources().getStringArray(R.array.recipe_image)[i];
        listOfRecipes.add(r1);
    }

    RecipeAdapter recipeAdapter = new RecipeAdapter(getApplicationContext(),R.layout.item_row,listOfRecipes);

    gvRecipes.setAdapter(recipeAdapter);
    txtHeaderTitle.setText("بدري و هنية");
    setTypeFace(txtHeaderTitle);

    imgHeader.setImageDrawable(getResources().getDrawable(R.drawable.home));
    imgHeader.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View arg0) {
            Intent i = new Intent(getApplicationContext(),BHActivity.class);
            startActivity(i);

        }
    });
} 
```

错误是：

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{mobile.bh/mobile.bh.activities.RecipesListActivity}: java.lang.NullPointerException
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
at android.app.ActivityThread.access$1500(ActivityThread.java:117)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:130)
at android.app.ActivityThread.main(ActivityThread.java:3687)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:507)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.NullPointerException
at mobile.bh.activities.RecipesListActivity.onCreate(RecipesListActivity.java:47)
at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:20:25.407

`gvRecipes`似乎为空。该方法`findViewById()`可能返回 null。确保 GridView 存在于 main.xml 中并且它具有正确的 ID。

# tracking - 跟踪 piwik 安装

> ID：11673500
> 
> 赞同：0
> 
> 时间：2012-07-26T16:09:08.837
> 
> 标签：tracking, matomo

我正在尝试跟踪 piwik 安装本身而不是 piwik 活动，但到目前为止我还没有任何运气。

以下是我做过的几件事的清单：

*   在 config.ini.php 中，我添加了以下几行：[Debug] track_visits_inside_piwik_ui = 999

    其中 999 是我要跟踪的站点的站点 ID。

    它不会产生任何错误，也不会跟踪任何内容。

*   我修改了 piwik/plugins/CoreHome/templates/piwik_tag.tpl: {if $piwikUrl == 'http://demo.piwik.org/' || $debugTrackVisitsInsidePiwikUI || 'http://yourDomain/piwik/'} 并更改了 var piwikTracker = Piwik.getTracker("piwik.php", 2);

    这也不会引发错误，但也不会跟踪。

我试图将 piwik 跟踪代码放在各个页面中，但没有可以添加它们的 html 代码。

任何帮助将不胜感激。安贾利。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T12:35:38.730

使用内部跟踪，您只能跟踪对 idSite = 1 的访问。您使用的设置无效，因为`track_visits_inside_piwik_ui`它是一个布尔标志，只能接受值 0 和 1。

```
[Debug]
track_visits_inside_piwik_ui = 1 
```

这是唯一有效的设置。请注意，这是一个调试/开发功能，不应在生产中使用。

# c - 使用 %f 打印整数变量

> ID：11673503
> 
> 赞同：7
> 
> 时间：2012-07-26T16:09:12.680
> 
> 标签：c, format-specifiers

以下 c 程序的输出为：`0.000000`

输出背后是否有逻辑，或者答案编译器是否依赖，或者我只是得到一个垃圾值？

```
#include<stdio.h>

int main()
{
    int x=10;
    printf("%f", x);
    return 0;
} 
```

PS：-我知道尝试使用 %f 打印整数值是愚蠢的。我只是从理论的角度来问这个问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-26T16:13:31.890

来自最新的[C11 草案](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf)：

**§7.16.1.1/2**

```
...if type is not compatible with the type of the actual next argument 
(as promoted according to the default argument promotions), the behavior 
is undeﬁned, except for the following cases:

— one type is a signed integer type, the other type is the corresponding 
unsigned integer type, and the value is representable in both types;
— one type is pointer to void and the other is a pointer to a character type. 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-26T16:43:55.287

要记住的最重要的事情是，正如克里斯指出的那样，行为是未定义的。如果这是在一个真实的程序中，唯一明智的做法就是修复代码。

另一方面，查看行为未由语言标准定义的代码的行为可能是有益的（只要您注意不要过度概括该行为）。

`printf`的`"%f"`格式需要一个类型的参数`double`，并以十进制形式打印它，没有指数。非常小的值将打印为`0.000000`.

当你这样做时：

```
int x=10;
printf("%f", x); 
```

我们可以根据您所在平台的一些假设来解释可见行为：

*   `int`是 4 个字节
*   `double`是 8 个字节
*   `int`和`double`参数被传递给`printf`使用相同的机制，可能在堆栈上

因此调用将（似是而非）将`int`值`10`作为 4 字节数量压入堆栈，并将从堆栈中`printf`抓取 8 个字节的数据并将其视为 a 的表示`double`。4 个字节将表示`10`（以十六进制表示，`0x0000000a`）；其他 4 个字节将是垃圾，很可能为零。垃圾可以是 8 字节数量的高位或低位 4 个字节。（或其他任何东西；请记住，行为是未定义的。）

这是我刚刚放在一起的演示程序。它不是滥用`printf`，而是使用 . 将对象的表示复制`int`到`double`对象中`memcpy()`。

```
#include <stdio.h>
#include <string.h>

void print_hex(char *name, void *addr, size_t size) {
    unsigned char *buf = addr;
    printf("%s = ", name);
    for (int i = 0; i < size; i ++) {
        printf("%02x", buf[i]);
    }
    putchar('\n');
}

int main(void) {
    int i = 10;
    double x = 0.0;
    print_hex("i (set to 10)", &i, sizeof i);
    print_hex("x (set to 0.0)", &x, sizeof x);

    memcpy(&x, &i, sizeof (int));
    print_hex("x (copied from i)", &x, sizeof x);
    printf("x (%%f format) = %f\n", x);
    printf("x (%%g format) = %g\n", x);

    return 0;
} 
```

我的 x86 系统上的输出是：

```
i (set to 10) = 0a000000
x (set to 0.0) = 0000000000000000
x (copied from i) = 0a00000000000000
x (%f format) = 0.000000
x (%g format) = 4.94066e-323 
```

如您所见， 的值`double`非常小（有关详细信息，您可以查阅有关 IEEE 浮点格式的参考资料），足够接近零，将其`"%f"`打印为`0.000000`.

让我再次强调*行为是未定义的*，这意味着语言标准对程序的行为“没有要求”。字节顺序、浮点表示和参数传递约定的变化可以极大地改变结果。甚至编译器优化也会影响它；允许编译器假设程序的行为是明确定义的，并基于该假设执行转换。

所以*请*随意忽略我在这里写的所有内容（除了第一段和最后一段）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T16:20:44.613

因为二进制中的整数 10 看起来像这样：

```
00000000 00000000 00000000 00001010 
```

printf 所做的只是采用内存中的表示并尝试将其表示为 IEEE 754 浮点数。

浮点数由三个部分组成（从 MSB 到 LSB）：

符号：1 位
指数：8 位
尾数：23 位

由于整数 10 在尾数位中只是 1010，因此它是一个非常小的数字，远低于 printf 浮点格式的默认精度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T17:18:19.940

结果未定义。

> 我只是从理论的角度来问这个问题。

完整的[克里斯](https://stackoverflow.com/users/962089/)的[优秀答案](https://stackoverflow.com/a/11673569/14089)：

你的 printf 中发生的事情是未定义的，但*它可能与下面的代码非常相似*（它取决于 varargs 的实际实现，IIRC）。

*免责声明：以下是对在一个平台上未定义的行为情况下可能发生的情况的“就好像它那样工作”的解释，而不是在所有平台上总是发生的真实/有效描述。*

## 定义“未定义”？

想象一下下面的代码：

```
int main()
{
    int i       = 10 ;
    void * pi   = &i ;
    double * pf = (double *) pi ; /* oranges are apples ! */
    double f    = *pf ;

    /* what is the value inside f ? */

    return 0;
} 
```

在这里，由于指向 double (ie `pf`) 的指针指向托管整数值 (ie `i`) 的地址，因此您将得到未定义的，并且很可能是垃圾。

## 我想看看那段记忆里到底是什么！

如果你真的想看看垃圾背后可能是什么（在某些平台上调试时），请尝试以下代码，我们将使用联合来模拟一块内存，我们将在其中写入 double 或 int 数据：

```
typedef union
{
   char c[8] ; /* char is expected to be 1-byte wide     */
   double f ;  /* double is expected to be 8-bytes wide  */
   int i ;     /* int is expected to be 4-byte wide      */
} MyUnion ; 
```

`f`and`i`字段用于设置值，字段`c`用于逐字节查看（或修改）内存。

```
void printMyUnion(MyUnion * p)
{
   printf("[%i %i %i %i %i %i %i %i]\n"
      , p->c[0], p->c[1], p->c[2], p->c[3], p->c[4], p->c[5], p->c[6], p->c[7]) ;
} 
```

上面的函数将逐字节打印内存布局。

下面的函数将打印不同类型值的内存布局：

```
int main()
{
   /* this will zero all the fields in the union */
   memset(myUnion.c, 0, 8 * sizeof(char)) ;
   printMyUnion(&myUnion) ; /* this should print only zeroes */
                            /* eg. [0 0 0 0 0 0 0 0] */

   memset(myUnion.c, 0, 8 * sizeof(char)) ;
   myUnion.i = 10 ;
   printMyUnion(&myUnion) ; /* the representation of the int 10 in the union */
                            /* eg. [10 0 0 0 0 0 0 0] */

   memset(myUnion.c, 0, 8 * sizeof(char)) ;
   myUnion.f = 10 ;
   printMyUnion(&myUnion) ; /* the representation of the double 10 in the union */
                            /* eg. [0 0 0 0 0 0 36 64] */

   memset(myUnion.c, 0, 8 * sizeof(char)) ;
   myUnion.f = 3.1415 ;
   printMyUnion(&myUnion) ; /* the representation of the double 3.1415 in the union */
                            /* eg. [111 18 -125 -64 -54 33 9 64] */

   return 0 ;
} 
```

*注意：此代码已在 Visual C++ 2010 上测试。*

这并不意味着它会在您的平台上以这种方式（或根本没有）工作，但通常，您应该得到类似于上面发生的结果。

最后，垃圾只是您查看的内存中的十六进制数据集，但被视为某种类型。

由于大多数类型对数据有不同的内存表示，因此查看原始类型以外的任何其他类型的数据必然会产生垃圾（或非垃圾）结果。

您的 printf 可能会表现得像那样，因此，当最初将原始内存设置为 int 时，尝试将其解释为 double。

*PS：请注意，由于 int 和 double 的字节大小不同，垃圾变得更加复杂，但这主要是我上面描述的。*

## 但我想将一个 int 打印为双精度！

严重地？

[Helios](https://stackoverflow.com/users/1047285)提出[了一个解决方案](https://stackoverflow.com/a/11673865/14089)。

```
int main()
{
   int x=10;
   printf("%f",(double)(x));
   return 0;
} 
```

让我们看一下伪代码，看看输入 printf 的内容：

```
 /* printf("...", [[10 0 0 0]]) ; */
   printf("%i",x);

   /* printf("...", [[10 0 0 0 ?? ?? ?? ??]]) ; */
   printf("%f",x);

   /* printf("...", [[0 0 0 0 0 0 36 64]]) ; */
   printf("%f",(double)(x)); 
```

强制转换提供了不同的内存布局，有效地将整数“10”数据更改为双“10.0”数据。

因此，当使用 "%i" 时，它会期望像 [[?? ?? ?? ??]]，对于第一个 printf，接收 [[10 0 0 0]] 并将其正确解释为整数。

当使用 "%f" 时，它会期望像 [[?? ?? ?? ?? ?? ?? ?? ??]]，并在第二个 printf 上接收类似 [[10 0 0 0]] 的内容，缺少 4 个字节。所以最后 4 个字节将是随机数据（可能是 [[10 0 0 0]] 之后的字节，即 [[10 0 0 0 ?? ?? ?? ??]]

在最后一个 printf 中，强制转换更改了类型，因此将内存表示更改为 [[0 0 0 0 0 0 36 64]] 并且 printf 将其正确解释为双精度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T16:13:51.813

本质上是垃圾。小整数看起来像不应该存在的非标准化浮点数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-26T16:30:55.637

您可以像这样转换 int 变量：

```
int i = 3;
printf("%f",(float)(i)); 
```

# php - 格式化代码时 HTML 输出中的 PHP 空格

> ID：11673511
> 
> 赞同：0
> 
> 时间：2012-07-26T16:09:34.157
> 
> 标签：php, html, css, whitespace

以下代码将在图标之间产生不需要的空白。

```
<div>
    <img src="icon1.png" />
    <img src="icon2.png" />
</div> 
```

我需要将图像标签保留在单行上，因为我的 .phtml 文件中有一些条件，它看起来像这样：

```
<div>
    <?php if ($condition1) : ?>
        <img src="icon1.png" />
    <?php endif ?>
    <?php if ($condition2) : ?>
        <img src="icon2.png" />
    <?php endif ?>
</div> 
```

我不想将所有代码都搞砸在一行。有没有针对这种情况的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:11:16.980

将`font-size:0px;`样式应用于您的`div`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:29:48.713

您可以使用 echo 输出部分 html 代码。你会得到这样的东西

```
<div>
    <?php if (true) : 
        echo '<img src="icon2.png" />';
    endif;

    if (true) : 
        echo '<img src="icon2.png" />';
    endif;
    ?>
</div> 
```

# python - Wxpython：wxPyGridTableBase 追加整行数据

> ID：11673512
> 
> 赞同：0
> 
> 时间：2012-07-26T16:09:49.130
> 
> 标签：python, datagrid, wxpython

我正在尝试使用 wxPyGridTableBase 在 Wxpython 中设置记录查看器，我想从任意数量的行的数据库中提取记录。有没有一种方法或已经存在的方法可以让我将行附加到网格（就像将记录添加到数据表一样？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:12:41.937

来自[http://wiki.wxpython.org/wxPyGridTableBase#Table_Size.2BAC8-Shape_Reconfiguration](http://wiki.wxpython.org/wxPyGridTableBase#Table_Size.2BAC8-Shape_Reconfiguration)：

```
bool InsertRows(size_t pos = 0, size_t numRows = 1)
bool AppendRows(size_t numRows = 1) 
```

# formula - Excel 2003 中 DSUM 的替代公式

> ID：11673513
> 
> 赞同：0
> 
> 时间：2012-07-26T16:09:53.853
> 
> 标签：formula, excel-2003

我正在使用 Excel 2003 并试图找到单个标准的总数。我目前正在使用这个公式，它运行成功。

数据 A1:G1776 是数据库 --- 数据 C1 - 是包含我想要总计的列 --- 而 F4:F5 是我为要匹配的行设置条件的列。

=DSUM(数据!$A$1:$G$17996,数据!$C$1,$F$4:F5)

我遇到的问题是文件大小超过 5MB，当您尝试将其通过电子邮件发送给其他人时，这是巨大的。

有什么建议可以复制该公式，同时减小文件大小并提高文档速度？我不想使用数据透视表

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T12:07:06.260

作为 DSUM 的替代品，您可以使用 sumproduct 公式：

```
=SUMPRODUCT((DATA!$C$2:$C$17996)*(DATA!$A$2:$A$17996="Boys")*(DATA!$B$2:$B17996>18)) 
```

上面的示例总共创建了 C 列，其中仅包括以下行： A 列是“男孩”，B 列大于 18。该示例假定第 1 行是标题行。

为了加快计算速度，您可以使用 VBA 来启用单个工作表的计算。

用于启用计算的 VBA：

```
Public Sub enableCalc(ParamArray sheetsInUse())
  Dim i As Integer
  For i = 0 To UBound(sheetsInUse) Step 1
      sheetsInUse(i).EnableCalculation = True
  Next i
End Sub 
```

调用使用： enableCalc activeworkbook.Worksheets("Sheet1") 这将在活动工作簿中启用计算 Sheet1

VBA 用于禁用工作簿中所有工作表的计算：

```
Public Sub finishedUse(wrkbook As Workbook)
Dim i As Integer
Dim wrkSheet As Worksheet
For Each wrkSheet In wrkbook.Worksheets
wrkSheet.EnableCalculation = False
Next wrkSheet
End Sub 
```

调用使用：finishedUse activeworkbook 这将禁用活动工作簿中所有工作表的计算。

上述方法不受更改工具中的自动/手动计算的影响 --> 选项

# gwt - 将数据从服务器发送到客户端的最快方法是什么？

> ID：11673514
> 
> 赞同：1
> 
> 时间：2012-07-26T16:09:57.797
> 
> 标签：gwt, requestfactory

我需要从服务器向客户端发送大量数据（大约 3000 双的列表）。目前我正在使用`RequestFactory`，但它花费了太多时间（大约 5 秒，准备发送数据大约需要 0.2 秒）。

有更快的方法吗？还是我应该更多地考虑减少数据量？

# c# - 为什么当我切换语义缩放时，它没有导航到该部分？

> ID：11673521
> 
> 赞同：4
> 
> 时间：2012-07-26T16:10:20.083
> 
> 标签：c#, xaml, windows-8, microsoft-metro, semantic-zoom

我的语义缩放有些奇怪。我有两个部分：

![在此处输入图像描述](../Images/21f97d78e28b72b633a883929fd0c882.png) ![在此处输入图像描述](../Images/07b45d2ebd0da2248d82977782528ebc.png)

当我设置 ZoomOut 时，分组是好的，这是图像：

![在此处输入图像描述](../Images/934e39230e3b2ee3d5b596eb09f4385f.png)

但例如，如果我选择第二个选项，语义缩放不会将我导航到单击的项目。

这是我的程序中最重要的部分。

```
 <!-- from resources -->
    <CollectionViewSource
        x:Name="groupedItemsViewSource"
        Source="{Binding Groups}"
        IsSourceGrouped="False">

    ...

    <!-- Horizontal scrolling grid used in most view states -->
    <SemanticZoom x:Name="semanticZoomControl" Grid.Row="1" >
        <SemanticZoom.ZoomedInView>
            <ListView x:Name="itemGridView" SelectionMode="None" IsItemClickEnabled="False"
                      ScrollViewer.VerticalScrollBarVisibility="Disabled"
                      ScrollViewer.VerticalScrollMode="Disabled"
                      ScrollViewer.HorizontalScrollBarVisibility="Auto"
                      ScrollViewer.HorizontalScrollMode="Auto"
                      Margin="0,-3,0,0"
                      Padding="116,0,40,46"
                      ItemTemplateSelector="{StaticResource StartItemSelector}"
                      ItemsSource="{Binding Source={StaticResource groupedItemsViewSource}}"
                      ItemContainerStyle="{StaticResource ListViewItemStyleFlat}">
                <ListView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal" />
                    </ItemsPanelTemplate>
                </ListView.ItemsPanel>
            </ListView>
        </SemanticZoom.ZoomedInView>
        <SemanticZoom.ZoomedOutView>
            <ListView x:Name="groupGridView" CanDragItems="False"
                      CanReorderItems="False" SelectionMode="None" IsItemClickEnabled="True"
                      ScrollViewer.HorizontalScrollBarVisibility="Auto"
                      ScrollViewer.HorizontalScrollMode="Auto"
                      ScrollViewer.VerticalScrollBarVisibility="Disabled"
                      ScrollViewer.VerticalScrollMode="Disabled"
                      ItemContainerStyle="{StaticResource ListViewItemStyleSimple}"
                      ItemsSource="{Binding Source={StaticResource groupedItemsViewSource}}"
                      ItemTemplateSelector="{StaticResource ZoomedOutSelector}">
                <ListView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal"  Height="330"
                                    HorizontalAlignment="Left" VerticalAlignment="Top" />
                    </ItemsPanelTemplate>
                </ListView.ItemsPanel>
            </ListView> 
```

发生这种情况的原因可能是什么？

如果您觉得更舒服，您可以从 SkyDrive 下载该项目：http: [//sdrv.ms/Ma0LmE](http://sdrv.ms/Ma0LmE)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-26T21:05:25.000

您需要在代码隐藏中设置 Zoomed Out GridView 的 ItemsSource，例如

```
groupGridView.ItemsSource = groupedItemsViewSource.View.CollectionGroups; 
```

您很可能需要更新该网格的模板，以附加“组”。在你的绑定之前。

您的 ItemTemplateSelector 也将停止工作，它将传递一个 DependencyObject 而不是您的绑定组。您可以将对象转换为具有 Group 属性的 ICollectionViewGroup，您可以将其转换为模型对象等。

这一切都很痛苦，但我目前找不到更好的方法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-09T11:36:44.673

我的情况有些不同，但我决定在这里分享，希望有人会发现它有用。在我的应用程序中，我必须有两个不同的数据源用于语义缩放的放大/缩小视图。当然，这打破了两者之间的联系，所以我不能做上面@Nigel 建议的事情以及在一般情况下会起作用的事情。相反，我必须自己处理滚动。

因此，我为视图更改事件添加了一个事件处理程序：

```
<SemanticZoom ViewChangeStarted="OnSemanticZoomViewChangeStarted">
...
</SemanticZoom> 
```

然后我在代码隐藏中定义了它：

```
private void OnSemanticZoomViewChangeStarted(object sender, SemanticZoomViewChangedEventArgs e)
{
    // only interested in zoomed out->zoomed in transitions
    if (e.IsSourceZoomedInView)
    {
        return;
    }

    // get the selected group
    MyItemGroup selectedGroup = e.SourceItem.Item as MyItemGroup;

    // identify the selected group in the zoomed in data source (here I do it by its name, YMMV)
    ObservableCollection<MyItemGroup> myItemGroups = this.DefaultViewModel["GroupedItems"] as ObservableCollection<MyItemGroup>;
    MyItemGroup myGroup = myItemGroups.First<MyItemGroup>((g) => { return g.Name == selectedGroup.Name; });

    // workaround: need to reset the scroll position first, otherwise ScrollIntoView won't work
    SemanticZoomLocation zoomloc = new SemanticZoomLocation();
    zoomloc.Bounds = new Windows.Foundation.Rect(0, 0, 1, 1);
    zoomloc.Item = myItemGroups[0];
    zoomedInGridView.MakeVisible(zoomloc);

    // now we can scroll to the selected group in the zoomed in view
    zoomedInGridView.ScrollIntoView(myGroup, ScrollIntoViewAlignment.Leading);
} 
```

如您所见，hack 是首先需要重绕 gridview`ScrollIntoView`才能正常工作。我想这只是微软的另一个“设计”决定......：P

# android - 安装安卓4.1

> ID：11673523
> 
> 赞同：0
> 
> 时间：2012-07-26T16:10:24.540
> 
> 标签：android, build, android-4.2-jelly-bean

我正在尝试为三星 Galaxy Nexus 构建和安装 android 4.1.1。我是如何建造的：

```
repo sync
. build/envsetup.sh
lunch full_maguro-userdebug
make -j3 
```

构建成功完成，然后安装：

```
adb reboot bootloader
fastboot oem unlock
fastboot erase cache
fastboot erase userdata
fastboot flashall 
```

安装完成，但是重启后android不运行，只显示google logo。

我做错了什么？

# c# - 使用本体 XML 文档帮助解析 RDF 数据

> ID：11673524
> 
> 赞同：1
> 
> 时间：2012-07-26T16:10:23.897
> 
> 标签：c#, parsing, xml-parsing, rdf, opencalais

我正在使用 Open Calais 并尝试解析从 API 返回的 RDF/XML 数据。我无法制作自己的解析器，因为同一类型的数据有时会有所不同，具体取决于有多少信息-

```
<!--PersonCareer: person: Bill Gates; company: Microsoft; careertype: professional; status: past; --> 
```

对比

```
<!--PersonCareer: person: Margaret Cushing; position: president and chief executive officer; company: Hewlett-Packard; careertype: professional; status: current; --> 
```

我想要做的是使用 Open Calais 提供的本体文档 - [http://www.opencalais.com/files/owl.opencalais-4.3a.xml](http://www.opencalais.com/files/owl.opencalais-4.3a.xml)来解析这个 RDF 数据。我需要有关如何使用 c# 使用本体 xml 文档来解析这些数据的帮助。任何帮助，将不胜感激！:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T08:18:39.397

如果要在 C# 中解析 RDF，最好使用现有的 RDF 库，例如[dotNetRDF](http://www.dotnetrdf.org/)。

顺便说一句，您的代码示例令人困惑，因为您只粘贴了 XML 注释。据我所知，没有任何 RDF 解析器除了忽略注释之外会做任何事情。

# svn - 颠覆大乱 - 现在如何提交？

> ID：11673525
> 
> 赞同：3
> 
> 时间：2012-07-26T16:10:25.810
> 
> 标签：svn, version-control

一段时间以来，我一直在玩一个受源代码控制的项目。我添加了几个文件，删除了一些其他文件，并将另一个项目中的整个目录复制到了这个项目中。我现在才意识到，其中一些复制的文件夹内部有 .svn 目录，但是，目前，仅查看项目是不可能弄清楚哪些 .svn 目录与当前项目相关，哪些不属于当前项目。

我非常需要承诺，正如预期的那样，svn 让我头疼。起初我遇到了那些烦人的“丢失或未锁定”错误，但经过大量的搞砸后，我想我真的把事情搞砸了。

那么，我应该如何着手提交呢？我应该只清除所有 .svn 文件夹（我不确定哪些对应于当前项目，哪些不对应）还是会删除将每个文件连接到 svn 服务器中旧版本的所有信息？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T20:17:56.620

我会尝试以下方法：

1.  备份您的（损坏的）工作副本
2.  签出一个干净的工作副本，你想提交你的东西
3.  删除此（干净）工作副本中的所有**文件**，但保留所有文件夹*和*.svn 文件夹
4.  删除（损坏的）工作副本中的所有 .svn 文件夹，但保留所有文件和文件夹
5.  将损坏的工作副本（当您删除 .svn 文件夹时不再是工作副本）复制到干净的工作副本中
6.  将所有新文件添加到您的工作副本中（检查**svn status**）
7.  删除您的工作副本报告为丢失的所有文件（我必须手动删除空文件夹，对不起！）
8.  现在将所有更改提交到您的存储库

这应该在提交之前仔细审查 svn 状态的工作是不可避免的，如果出现问题重新启动备份

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:14:24.077

清除所有`.svn`文件夹可能不是您需要的。在每个`.svn`文件夹中，都有一个名为`entries`. 在该文件中，远程 repo 的 URL（自从使用 Git 后，不再记得正确的 SVN 措辞；抱歉）。

假设您的常规 repo 位于`http://server1.com/myregularrepo`并且您知道所有复制的文件夹（实际上不属于您的 repo）来自`http://otherserver.com/otherrepo`，那么搜索那些`entries`包含`http://otherserver.com/otherrepo`然后删除其父文件夹（即它们的`.svn`文件夹）的文件就可以了。

如果您将多个外部 repo 目录复制到您的工作副本中，事情会变得有点复杂，但我认为您已经掌握了该怎么做的窍门。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T20:20:46.377

如果您的代码是您想要的方式，我相信您可以进行 svn 导出（删除所有 .svn 文件夹，然后将其作为补丁导入到您的原始项目中。

# jquery - jquery ui组合框设置选定项目，变量为选择器名称

> ID：11673528
> 
> 赞同：0
> 
> 时间：2012-07-26T16:10:31.597
> 
> 标签：jquery, jquery-ui, combobox, selecteditem

最近这个问题一直让我发疯。在 .each() 中，我循环选择元素并将它们转换为 jquery ui 组合框。这很好用。在设置所选值时，我遇到了问题。在我的同一个 .each() 中，我试图将选定的值设置为我在其他地方得到的值。

```
 $("#" + e + " [role='select']").each(function () {
  $(this).combobox();
  var selId = '#ContactCategoryId';
  var cellv = '9';
  $(selId+" option[value=" + cellv + "]").attr("selected", 'true');
 }); 
```

现在上面的代码完美运行，将组合框设置为 9 和“单元格编号”的文本值。现在下面的代码失败了，没有错误，但不会更改所选值。我需要它以以下方式工作，我从当前选择元素中获取 Id：$(this).attr('id')。我已经尝试了很多不同的东西，请有人可以在这里给我看灯。

```
$("#" + e + " [role='select']").each(function () {

  $(this).combobox();
  var selId = '#'+$(this).attr('id');
  var cellv = '9';
  $(selId+" option[value=" + cellv + "]").attr("selected", 'true');
}); 
```

我正在使用 JQuery 1.7 和最新的 JQuery UI，谢谢！

詹姆士

* * *

由于我的声誉，我无法回答自己的问题，所以这是我的解决方案：

好的，在找到解决方案后，这个问题现在真的让我很恼火。通常，当我遇到 jquery 插件问题时，我只会查看源代码并尝试解决这个问题，但是对于这个问题，我没有尝试过，这让我付出了代价。这是解决方案，答案很简单。

```
 $("#" + e + " [role='select']").each(function () {
             if($(this).css('display')=='none')
             {
                 $(this).combobox("destroy");
             }
             $(this).combobox();
        }); 
```

当查看我认为现在出现的来源时，它必须从某个地方获得它的价值。所以我手动设置了值：

```
 $(this).val('9') 
```

它在表单的第一次打开时起作用，但在第二次打开时不起作用，然后我意识到如果它存在我需要将其销毁，然后创建组合框。我敢肯定你的大师有一个更好的解决方案，但我很高兴我得到了这个工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T09:28:21.940

它不像想象的那么简单，因为组合框实际上不是一个`select`元素......更新组合框元素会更新选择元素，但不是相反......我能看到的唯一方法是破坏组合框并重新创建它...这有效：

```
$("#divselect").children('select').each(function() {

    $this = $(this); // cache $(this)
    var cellv = '0'; // new value

    // Destroy the combobox
    $this.combobox("destroy");

    // Unselect the currently selected option
    $("option:selected",$this).removeAttr("selected");

    // Select the option you want to select
    $("option[value='"+cellv+"']",$this).attr("selected", "selected");

    // Create the combobox again
    $this.combobox();

}); 
```

[这里的工作示例](http://jsfiddle.net/a9F6J/58/)

另请注意..您不必这样做：

```
$("#showAnyCity").click(function() {
    checkdiv();
}); 
```

你可以这样做

```
$("#showAnyCity").click(checkDiv); 
```

# actionscript-3 - Flex 自定义事件 - 类型强制错误 - 与应用程序域相关？

> ID：11673529
> 
> 赞同：1
> 
> 时间：2012-07-26T16:10:34.373
> 
> 标签：actionscript-3, apache-flex, events, custom-events, type-coercion

我一直在寻找问题的答案，我想我可能走在正确的轨道上，但我就是不明白如何实施解决方案。我需要帮助。

我有一个类 RootPackage.Utils.SelectableGraphic.as、一个小部件 RootPackage.Widgets.WidgetWithSelection.mxml 和一个自定义事件 RootPackage.Events.SelectableGraphicEvent。

SelectableGraphic 调度 SelectableGraphicEvents 并且 WidgetWithSelection 监听这些事件。我的活动如下所示：

```
{
import RootPackage.utils.SelectableGraphic;

import flash.events.Event;

public class SelectableGraphicEvent extends Event
{
    public static const GRAPHIC_ADDED:String = 'Graphic_Added';
    public static const GRAPHIC_CLICKED:String = 'Graphic_Clicked';

    private var graphic:SelectableGraphic;

    public function SelectableGraphicEvent(type:String, gra:SelectableGraphic, bubbles:Boolean=false, cancelable:Boolean=false)
    {
        super(type, bubbles, cancelable);

        graphic = gra;
    }

    override public function clone():Event
    {
        return new SelectableGraphicEvent(type, graphic, bubbles, cancelable);
    }

    public function get Graphic():SelectableGraphic
    {
        return graphic;
    }
} 
```

我的调度看起来像这样：

```
lastDrawnGraphic = new SelectableGraphic(...);

lastDrawnGraphic.dispatchEvent(new SelectableGraphicEvent(SelectableGraphicEvent.GRAPHIC_ADDED, lastDrawnGraphic, true)); 
```

我的听力功能看起来像这样：

```
private function SelectableGraphic_ClickHandler(event:SelectableGraphicEvent):void
{
    gra:SelectableGraphic = event.Graphic;

    ...
} 
```

在进入监听函数之前，它在 WidgetWithSelection 中的调度和接收之间崩溃。如果我更改侦听函数头以侦听基本事件，那么它不会崩溃，但是当我尝试获取 event.Graphic 时，它会给出相同类型的强制错误。我尝试了很多变通方法，例如接收正常事件，将其转换为 SelectableGraphicEvent 并使用它。在这种情况下，强制转换操作返回空值。

类型强制错误类似于：错误 #1034：类型强制失败：无法将 RootPackage.Events::SelectableGraphicEvent@b56b071 转换为 RootPackage.Events.SelectableGraphicEvent。

无论如何，我已经阅读了一些关于此的内容，我相信这可能是因为这些类与我的主应用程序位于不同的应用程序域中或类似的东西。显然有一种方法可以更改应用程序域，但我只是不知道该怎么做。这让我现在很困惑，正如你可能从最后一段中看出的那样。有没有更简单的答案，或者任何人都可以向我解释我应该做什么？

谢谢，

吉尔曼

**编辑添加：**

这是添加 EventListener 的部分。open() 在 Additional_To_Stage 事件上，而 close() 在 Remove_From_Stage 上：

```
private function open():void
{
    this.map.addEventListener(SelectableGraphicEvent.GRAPHIC_CLICKED, SelectableGraphic_ClickHandler);
    this.map.addEventListener(SelectableGraphicEvent.GRAPHIC_ADDED, SelectableGraphic_AddedHandler);

    _selectableGraphics = GetSelectableGraphics();
}

private function close():void
{
    this.map.removeEventListener(SelectableGraphicEvent.GRAPHIC_CLICKED, SelectableGraphic_ClickHandler);
    this.map.removeEventListener(SelectableGraphicEvent.GRAPHIC_ADDED, SelectableGraphic_AddedHandler);

    ClearSelection();
} 
```

基本上，有一个地图包含一个包含可选图形的图形图层。因此，当我从我的 SelectableGraphic 调度时，事件会冒泡到地图（以及更远）。地图捕获事件并触发适当的 SelectableGraphic_EventHandler。

# sql - 我的 C# SQL Select 语句没有在我的表中提取任何记录

> ID：11673534
> 
> 赞同：1
> 
> 时间：2012-07-26T16:11:12.470
> 
> 标签：sql, select

我的 SQL 表中有*4 条记录*，我正在执行 SQL 选择语句来根据特定条件选择记录，但我没有选择任何记录。有人可以帮忙吗？

这是我的 SELECT 语句：

```
string Sql = "";  
Sql = @"SELECT * FROM " + _dtlName + " 
        WHERE Shipper_No = '" + sidNo + "' 
        AND Job_Code != '" + "R" + "'"; 
```

我有 3 条记录有一个`Null`for`Job_Code`和一个`1`记录有一个`R`.

基于此，我应该*使用 NULL 获取 3 条记录，* `Job_Code`但它*返回 0 条记录*。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:14:50.100

我怀疑问题是任何非空值和空值之间的比较不会返回真或假值，而是空值。所以你的查询应该是：

```
string sql = "SELECT * FROM " + _dtlName + " WHERE Shipper_No = @ShipperNo " +
             "AND (Job_Code IS NULL OR Job_Code != 'R')"; 
```

（请注意，我已经提取了一个参数`Shipper_No`- 您不应该像那样直接在 SQL 中包含值。显然，您需要在 SQL 命令中设置参数值。）

另请注意，`<>`在 SQL 中更常见的是表示“不等于”，但我相信 T-SQL 允许任何一种形式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:16:56.097

尝试，

```
Sql = @"SELECT * FROM " + _dtlName + " WHERE Shipper_No = '" + sidNo + "' AND Job_Code NOT IN ('R')"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:31:22.907

我认为您的查询应该更像这样，因为您要选择`NULL`值。

```
string Sql = String.Format("SELECT * " + 
                           "FROM {0} " +
                           "WHERE Shipper_No = {1} AND " +
                           "      Job_Code IS NULL",
                            _dtlName, sidNo) 
```

# android - 将已发送的彩信插入已发送的邮箱

> ID：11673543
> 
> 赞同：2
> 
> 时间：2012-07-26T16:11:59.833
> 
> 标签：android, mms

我正在尝试将 MMS 插入到发送的数据库中，但可惜我无法在本机 android 应用程序中查看它。

我的插入代码：

```
ContentValues values = new ContentValues();
values.put("thread_id", thread_id);
values.put("date", time);
values.put("read", true); //read status
values.put("sub", text); //mms subject
values.put("msg_box", 2); //message box. in this case outbox

Uri mmsUri = context.getContentResolver().
insert(Uri.parse("content://mms"), values);
Log.v("MMSProjectActivity", "Message saved at: " + mmsUri);

ContentValues mmsPartValue = new ContentValues();
mmsPartValue.put("ct", "image/jpeg"); //mime; for example image/jpeg
Uri picUri = picUris.get(0);
String [] fileNameSplit = picUri.toString().split("/");
String fileName = fileNameSplit[fileNameSplit.length-1] + ".jpg";

String messageId = mmsUri.getLastPathSegment().trim(); //id of MMS at content://mms
Uri partUri = Uri.parse("content://mms/" + messageId + "/part");

Uri mmsPartUri = context.getContentResolver().insert(partUri, mmsPartValue);
OutputStream os;
InputStream is;
try
{
    os = context.getContentResolver().openOutputStream(mmsPartUri);
is = context.getContentResolver().openInputStream(picUris.get(0));
byte[] buffer = new byte[256];
for (int len = 0; (len = is.read(buffer)) != -1; ) {
    os.write(buffer, 0, len);
}
} catch (FileNotFoundException e)
{
Log.v("MMSProjectActivity", "MMS not saved FileNotFoundException");
e.printStackTrace();
} catch (IOException e)
{
Log.v("MMSProjectActivity", "MMS not saved IOException");
    e.printStackTrace();
}

Log.v("MMSProjectActivity", "MMS part value saved at: " + mmsPartUri); 
```

有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T23:16:32.463

我想你需要的是[这个类](http://hi-android.info/src/com/android/mms/data/WorkingMessage.java.html)的源代码。一般在google上看看他们是怎么做的。。具体看看这个方法

```
 private static Uri createDraftMmsMessage(PduPersister persister, SendReq sendReq,
        SlideshowModel slideshow) {
    try {
        PduBody pb = slideshow.toPduBody();
        sendReq.setBody(pb);
        Uri res = persister.persist(sendReq, Mms.Draft.CONTENT_URI);
        slideshow.sync(pb);
        return res;
    } catch (MmsException e) {
        return null;
    }
} 
```

在创建草稿（第一步）之后，您将草稿更新为已发送。通过调用其他方法

```
 private static void updateDraftMmsMessage(Uri uri, PduPersister persister,
        SlideshowModel slideshow, SendReq sendReq) {
    if (Log.isLoggable(LogTag.APP, Log.VERBOSE)) {
        LogTag.debug("updateDraftMmsMessage uri=%s", uri);
    }
    if (uri == null) {
        Log.e(TAG, "updateDraftMmsMessage null uri");
        return;
    }
    persister.updateHeaders(uri, sendReq);
    final PduBody pb = slideshow.toPduBody();

    try {
        persister.updateParts(uri, pb);
    } catch (MmsException e) {
        Log.e(TAG, "updateDraftMmsMessage: cannot update message " + uri);
    }

    slideshow.sync(pb);
} 
```

现在我知道您无法从您的应用程序运行此代码，因为您没有在源代码中构建，或者即使您这样做也可能是一个挑战（即使我认为如果您确实在源代码中构建代码正确的谷歌代码应该处理保存的东西）

在任何情况下，您都应该能够按照他们在此类中所做的操作将 mms 消息保存在提供程序中。

干杯...

并发布您的进度...

# wpf - 绑定以显示 double 作为 int

> ID：11673544
> 
> 赞同：9
> 
> 时间：2012-07-26T16:12:02.937
> 
> 标签：wpf, binding

我想在我的控件上显示持续时间（以分钟为单位），但我不希望它显示为十进制数字（例如，65 而不是 65.94503）。

```
<TextBlock Text="{Binding Duration.TotalMinutes, StringFormat=\{0\} minutes}" /> 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-26T16:17:16.507

如果你想显示一个整数，我认为你需要做的就是设置 StringFormat 属性，如下所示：

```
<TextBlock Text="{Binding Duration.TotalMinutes, StringFormat=N0}"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:17:46.713

在代码而不是标记中执行此操作。您可以轻松地进行单元测试。将 TotalMinutes 改为字符串或整数，并在 ViewModel 中对其进行格式化。

# windows-8 - 我可以在我的笔记本电脑上使用手机上的 gps

> ID：11673545
> 
> 赞同：2
> 
> 时间：2012-07-26T16:12:06.517
> 
> 标签：windows-8, microsoft-metro, windows-runtime

我想知道是否可以在笔记本电脑中使用手机中的 gps 模块。

我想编写一个使用地理定位的应用程序（Windows 8 Metro），但我的电脑没有 gps 模块。是否有可能将手机用作外部gps？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T05:01:44.753

设置网络服务。创建一个将地理定位数据发送到服务的电话应用程序。然后，该服务可以将数据提取到 Metro Style 应用程序，或者应用程序可以在特定时间间隔提取位置数据。

# facebook - 使用我网站上的分享按钮时，我的图片未显示

> ID：11673548
> 
> 赞同：0
> 
> 时间：2012-07-26T16:12:18.943
> 
> 标签：facebook, button, web, share

我按照本教程在我的网站上添加 Facebook 分享按钮：[添加 Facebook 分享按钮的教程](http://www.hyperarts.com/blog/tutorial-how-to-add-facebook-share-button-to-your-web-site-pages/)

我不明白的是，当我使用他们的图片时，它的工作方式类似于此示例：

```
<script type="text/javascript">
$(document).ready(function(){
$('#share_button').live('click', function(e){
e.preventDefault();
FB.ui(
{
method: 'feed',
name: 'This is the content of the "name" field.',
link: ' http://www.hyperarts.com/',
picture: 'http://www.hyperarts.com/external-xfbml/share-image.gif',
caption: 'This is the content of the "caption" field.',
description: 'This is the content of the "description" field, below the caption.',
message: 'This is text in the message box a user can add to or replace.'
});
});
});
</script> 
```

我尝试了在谷歌上找到的另外两张图片，它也可以。但是现在当我使用存储在我的服务器上的图片时，它不起作用。例如：

```
<script type="text/javascript">
$(document).ready(function(){
$('#share_button').click(function(e){
e.preventDefault();
FB.ui(
{
method: 'feed',
name: 'www.facebook.com propulsé par Propelink',
link: 'http://prplk.com/MTU1',
picture: 'https://www.users.prplk.com/images/profils/17_20120726190935.jpg',
caption: '',
description: '',
message: ''
});
});
});
</script> 
```

不支持下划线字符吗？还是我的图片有问题？

我希望有人可以帮助我解决我的问题。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T01:02:32.353

这里有两个可能的问题。

1）图像至少需要 50x50（来自内存），但您拥有的图像只有 35x35

2) 托管证书无效。不确定这是否会有所不同，但如果加载较大的图像不起作用，请查看修复此问题（或不在 https 上托管）

编辑：刚刚在检查 Linter/Debugger 中的另一个项目/错误时看到图像应该是 200 x 200。目前似乎还不是要求，但最终可能会。所以还有一件事要注意。

# string - 格式化字符数组

> ID：11673556
> 
> 赞同：1
> 
> 时间：2012-07-26T16:12:47.040
> 
> 标签：string, matlab, datetime, matrix, cell-array

> **可能重复：**
> [在 MATLAB 中使用时间序列按天/小时计算值](https://stackoverflow.com/questions/11671588/counting-values-by-day-hour-with-timeseries-in-matlab)

这是一个基本问题，但我找不到：

我有一个 3000x25 字符数组：

`2000-01-01T00:01:01+00:00`
`2000-01-01T00:01:02+00:00`
`2000-01-01T00:01:03+00:00`
`2000-01-01T00:01:04+00:00`

这些显然是时代。我想将数组重新格式化为 3000x1 数组。如何将每一行重新定义为数组中的一个条目？

（再次，这很简单，对不起）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:22:07.577

除了转换为其他显示的序列号之外，我认为您只是想转换为字符串的单元格数组：

```
A = cellstr(c) 
```

其中`c`是 3000x25 的字符矩阵。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:16:07.183

您需要为数组指定格式并将其提供给`datenum`，如下所示：

```
>> d = datenum(c,'YYYY-MM-DDTHH:mm:ss')
d =
  1.0e+005 *
    7.3487
    7.3487
    7.3487
    7.3487 
```

时间现在存储为 datenums，即作为浮点数表示自 Matlab 纪元开始以来经过的天数。如果你想将这些转换为代表一天中过去的分数的数字，你可以这样做

```
>> t = d - fix(d); 
```

如果你想要自午夜以来的秒数，你可以这样做

```
>> t = 86400 * (d - fix(d));
t =
   61.0000
   62.0000
   63.0000
   64.0000 
```

# django - 使用从 django 中的表单返回的 CheckboxSelectMultiple 进行过滤

> ID：11673557
> 
> 赞同：0
> 
> 时间：2012-07-26T16:12:46.510
> 
> 标签：django

我有一个包含字段的表单：

```
item = forms.MultipleChoiceField( widget = forms.CheckboxSelectMultiple, choices=ITEM_CHOICES) 
```

在我看来，当我取回表单时，关于 POST 操作。我认为 form.data['item'] 应该包含一个字典，但它没有。它只拥有较高的 item_value。

那么如何从 POST 操作中获得多项选择呢？

在我的意见.py

```
search_items_form = SearchItemsForm( data = request.POST )
if not search_items_form.is_valid():
    ...error...
if 'item' in search_items_form.data:
     item = search_items_form.data['item'] 
```

这里的项目*仅*等于一个值，而您可以在字段表单中看到它被设置为多项选择字段。

另外，在查看萤火虫时，我看到的参数是 POST 操作：项目 1 项目 2 项目 3 项目 4

所以 POST 确实包含多个项目 X。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T18:30:11.197

您应该访问`cleaned_data['item']`，而不是`data['item']`.

# ajax - Angular JS 数据未从异步 http 请求中填充

> ID：11673559
> 
> 赞同：4
> 
> 时间：2012-07-26T16:12:55.507
> 
> 标签：ajax, jquery, asynchronous, angularjs

我正在尝试获取加载 div 以显示我的角度模块何时与服务器联系。我正在使用 AngularJS 1.0.1 和 AngularJS Resources 1.0.1 来扩展 HTML 和 jquery 1.7.2 的功能，以获得一些额外的 dom 操作和 ajax 支持。

我已经发现，如果我在 async false 中运行 ajax 调用，加载 div 将不会显示，除了 Firefox，它显示但动画 gif 不是动画。

如果我在 async true 中运行 ajax 调用，则返回的数据不会加载到已加载模板部分的角度模型变量中。

是否有可能获得一个动画加载 div 来显示并将角度数据加载到模型中？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-26T21:00:50.070

希望我正确理解你。您想显示 ajax 请求的加载进度。为此，您需要一个响应拦截器。这是一个如何执行此操作的示例[http://jsfiddle.net/zdam/dBR2r/](http://jsfiddle.net/zdam/dBR2r/)

```
// register the interceptor as a service, intercepts ALL angular ajax http calls
.factory('myHttpInterceptor', function ($q, $window, $rootScope) {
    return function (promise) {
        $rootScope.nowloading = true; // use ng-show="nowloading" on element containing spinner
        return promise.then(function (response) {
            // do something on success
            $rootScope.nowloading = false; // need to turn it off on success 
            return response;

        }, function (response) {
            // do something on error
            $rootScope.nowloading = false;  // need to turn it off on failure
            $rootScope.network_error = true;   // you might want to show an error icon.
            return $q.reject(response);
        });
    }; 
```

希望这可以帮助

- 担

# netbeans - 如何将 NetBeans 项目移植到另一台计算机上？

> ID：11673561
> 
> 赞同：1
> 
> 时间：2012-07-26T16:13:03.060
> 
> 标签：netbeans, relative-path, porting

我在 Linux 上使用 NetBeans 开发了一个 C++ 项目，它运行良好。现在我想在另一台计算机上用不同的目录结构重建它。

但是，IDE中存储的每个文件的路径仍然是以前的计算机的路径，因此在IDE的角度下这些文件似乎不存在。

在 NetBeans 中，我尝试在第一台计算机、tar 之前和目标计算机上执行以下操作：

1.  项目属性/常规/源文件夹设置相对于项目。
2.  工具/选项/C/C++/项目选项/文件路径模式/始终相对

这并没有解决问题。在目标机器上，我仍然有绝对路径。
我可以从头开始创建一个新项目，但我会避免这样做。

任何想法？

谢谢！

*平台：*
Linux - OpenSuse 10.1/11.4
Netbeans 7.1

# sql - 如何从 SQL Server Management Studio 中的表生成 CRUD 存储过程

> ID：11673563
> 
> 赞同：19
> 
> 时间：2012-07-26T16:13:14.727
> 
> 标签：sql, sql-server, tsql, ssms, crud

我如何在 SSMS 中获取一张桌子并为其自动生成 CRUD 存储过程？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-26T16:15:56.403

SSMS 没有生成 CRUD 过程的能力。您可以通过右键单击 Script Table As > 来生成 INSERT、UPDATE 语句等，但我认为使用[Mladen Prajdic 的 SSMS Tools Pack](http://ssmstoolspack.com/Features?f=12)会有更好的运气。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-07-26T16:24:33.673

如果您使用的是 Visual Studio，您可以这样做： [http ://weblogs.asp.net/stevewellens/archive/2009/12/11/automatically-generate-stored-procedures-with-visual-studio.aspx](http://weblogs.asp.net/stevewellens/archive/2009/12/11/automatically-generate-stored-procedures-with-visual-studio.aspx)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-07-10T08:30:45.320

我有一个简单的 TSQL 脚本用来做我的。它是基本的，但很容易修改以满足您的需求。它使用您指定的表和视图为 Upsert、Select 和 Delete 过程生成 TSQL。

```
 /*
This is a simple, single-table CRUD Generator. It does not have a bunch of 
bells and whistles, and is easy to follow and modify. I wrote this to make
my job easier, and I am sharing it with you to do with it as you wish.

The Basics:
The TSQL below will create 3 procedures:
    1\. An Upsert Procedure: Suffix _ups 
    2\. A Select Procedure: Suffix _sel
    3\. A Delete Procedure: Suffix _del

A Little More Detail:
Things you should know:
    All 3 procedures have a parameter called @MyID which is used to set 
    the Context, so that my audit procedures get the validated user. If you
    Have no use for it, you'll need to remove the piece of generator code 
    that adds it as a parameter to each of the 3 procedures. You will also
    need to remove the PRINT statement for each procedure that looks like:

            PRINT N'  SET CONTEXT_INFO @MyID;' + CHAR(13) + CHAR(10) 

    This generator expects to perform inserts, updates, and deletes on a
    table, and selects from a view. If you want to perform selects directly
    from the table, simply use the table name in both @TableName and 
    @ViewName.

The Upsert Procedure:
    If ID (Primary Key) is supplied it will perform an Update. Otherwise it 
    will perform an Insert. This generator is hard-coded to avoid inserting
    or updating these particular fields:
                                        Created
                                        CreatedBy
                                        Modified
                                        ModifiedBy
                                        RowVersion
                                        <The Primary Key Field>
    That's because in my databases I use those field names for audit, and they
    are never modified except internally within the database. You can modify
    the part of this procedure that performs this function to suit your needs.

    This generator always uses the Parameter name @ID to represent the Primary
    key defined for the table. This is my preference but you can modify to suit.

The Select Procedure:
    If ID (Primary Key) is supplied it will select a single row from the View 
    (Table) whose name you provide. Otherwise it will select all rows. If the 
    @ISACTIVE_SEL variable is set to 1 (True), then the Select Procedure expects
    your View (Table) to have a bit-type field named 'IsActive'. My tables are 
    standardized to this. If @ISACTIVE_SEL = 1 the Select Procedure will have an
    additional parameter called @IsActive (bit). When @ID is not supplied, and 
    @IsActive is not supplied, the procedure selects all rows. When @ID is not
    supplied, and @IsActive is supplied, the procedure selects all rows where
    the field IsActive matches the parameter @IsActive

The Delete Procedure:
    The Delete Pocedure requires that the Key value and the RowVersion value
    be supplied. I use an Int type RowVersion, so if you use TimeStamp (varbinary(128))
    then you will need to tweak the generator.

    --Casey W Little
    --Kaciree Software Solutions, LLC
    Version 1.00
*/

--Type Your Database Name in this Use statement:
USE [<Your Database>]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*MODIFY THE VALUES BELOW TO SUIT YOUR NEEDS*/
DECLARE @DBName nvarchar(100)=N'<Your Database>';
DECLARE @ProcName nvarchar(100)=N'<Your Proc Name>';
DECLARE @DBRoleName nvarchar(100)=N'<Role that should have exec Rights>';
DECLARE @TableName nvarchar(100)=N'<Your Table Name>';
DECLARE @ViewName nvarchar(100)=N'<Your View Name>';
DECLARE @OrderBy nvarchar(100)=N'<Your Field Name>';
DECLARE @OrderByDir nvarchar(4)=N'ASC';
DECLARE @AUTHOR nvarchar(50) ='<Your Name & Company>';
DECLARE @DESC nvarchar(100) ='<Proc Information>'; -- Ex. 'User Data' will return 'Description : Upsert User Data'
DECLARE @ISACTIVE_SEL bit =0; --Set to 1 if your table has a Bit field named IsActive
/*DO NOT MODIFY BELOW THIS LINE!!!*/

DECLARE @NNND char(23) ='NOT_NULLABLE_NO_DEFAULT';
DECLARE @NNWD char(22) ='NOT_NULLABLE_W_DEFAULT';
DECLARE @NBLE char(8) ='NULLABLE';
DECLARE @LEGEND nvarchar(max);
DECLARE @PRIMARY_KEY nvarchar(100);

--Set up Legend
    SET @LEGEND = N'USE [' + @DBName + N'];' + CHAR(13) + CHAR(10) 
    SET @LEGEND = @LEGEND + N'GO' + CHAR(13) + CHAR(10) 
    SET @LEGEND = @LEGEND + CHAR(13) + CHAR(10) 
    SET @LEGEND = @LEGEND + N'SET ANSI_NULLS ON' + CHAR(13) + CHAR(10) 
    SET @LEGEND = @LEGEND + N'GO' + CHAR(13) + CHAR(10) 
    SET @LEGEND = @LEGEND + CHAR(13) + CHAR(10) 
    SET @LEGEND = @LEGEND + N'SET QUOTED_IDENTIFIER ON' + CHAR(13) + CHAR(10) 
    SET @LEGEND = @LEGEND + N'GO' + CHAR(13) + CHAR(10) 
    SET @LEGEND = @LEGEND + CHAR(13) + CHAR(10) 

    SET @LEGEND = @LEGEND + N'-- ===================================================================' + CHAR(13) + CHAR(10) 
    SET @LEGEND = @LEGEND + N'-- Author      : ' + @AUTHOR + CHAR(13) + CHAR(10) 
    SET @LEGEND = @LEGEND + N'-- Create date : ' + CONVERT(nvarchar(30),GETDATE(),101) + CHAR(13) + CHAR(10) 
    SET @LEGEND = @LEGEND + N'-- Revised date: ' + CHAR(13) + CHAR(10) 

--Get Primary Key Field
SELECT TOP 1 @PRIMARY_KEY = COLUMN_NAME 
FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE 
WHERE OBJECTPROPERTY(OBJECT_ID(constraint_name), 'IsPrimaryKey') = 1 AND TABLE_NAME = @TableName AND TABLE_CATALOG = @DBName;

DECLARE TableCol Cursor FOR 
SELECT c.TABLE_SCHEMA, c.TABLE_NAME, c.COLUMN_NAME, c.DATA_TYPE, c.CHARACTER_MAXIMUM_LENGTH
    , IIF(c.COLUMN_NAME='RowVersion',@NBLE,IIF(c.COLUMN_NAME=@PRIMARY_KEY,@NBLE,IIF(c.IS_NULLABLE = 'NO' AND c.COLUMN_DEFAULT IS NULL,@NNND,IIF(c.IS_NULLABLE = 'NO' AND c.COLUMN_DEFAULT IS NOT NULL,@NNWD,@NBLE)))) AS [NULLABLE_TYPE]
FROM INFORMATION_SCHEMA.Columns c INNER JOIN
    INFORMATION_SCHEMA.Tables t ON c.TABLE_NAME = t.TABLE_NAME
WHERE t.Table_Catalog = @DBName
    AND t.TABLE_TYPE = 'BASE TABLE'
    AND t.TABLE_NAME = @TableName
ORDER BY [NULLABLE_TYPE], c.ORDINAL_POSITION;

DECLARE @TableSchema varchar(100), @cTableName varchar(100), @ColumnName varchar(100);
DECLARE @DataType varchar(30), @CharLength int, @NullableType varchar(30);

DECLARE @PARAMETERS nvarchar(max);
DECLARE @INSERT_FIELDS nvarchar(max),@INSERT_VALUES nvarchar(max);
DECLARE @UPDATE_VALUES nvarchar(max);

SET @PARAMETERS ='@MyID int,';
SET @INSERT_FIELDS ='';
SET @INSERT_VALUES ='';
SET @UPDATE_VALUES ='';

-- open the cursor
OPEN TableCol

-- get the first row of cursor into variables
FETCH NEXT FROM TableCol INTO @TableSchema, @cTableName, @ColumnName, @DataType, @CharLength, @NullableType

WHILE @@FETCH_STATUS = 0
    BEGIN
        IF @ColumnName NOT IN('Created','CreatedBy','Modified','ModifiedBy')
        BEGIN
            SET @PARAMETERS=@PARAMETERS + '@' + IIF(@ColumnName=@PRIMARY_KEY,'ID',@ColumnName) + ' ' + iif(@CharLength IS NULL,@DataType,@DataType + '(' + 
                CAST(@CharLength AS nvarchar(10)) + ')') +  IIF(@NullableType=@NNND OR @NullableType=@NNWD,',','=NULL,');
            IF @ColumnName <> @PRIMARY_KEY AND @ColumnName <> N'RowVersion'
                BEGIN
                    SET @INSERT_FIELDS=@INSERT_FIELDS + '[' + @ColumnName + '],';
                    SET @INSERT_VALUES=@INSERT_VALUES + '@' + IIF(@ColumnName=@PRIMARY_KEY,'ID',@ColumnName) + ',';
                    SET @UPDATE_VALUES=@UPDATE_VALUES + '[' + @ColumnName + ']=@' + IIF(@ColumnName=@PRIMARY_KEY,'ID',@ColumnName) + ',';
                END
        END

        FETCH NEXT FROM TableCol INTO @TableSchema, @cTableName, @ColumnName, @DataType, @CharLength, @NullableType
    END;

    SET @PARAMETERS=LEFT(@PARAMETERS,LEN(@PARAMETERS)-1)
    SET @INSERT_FIELDS=LEFT(@INSERT_FIELDS,LEN(@INSERT_FIELDS)-1)
    SET @INSERT_VALUES=LEFT(@INSERT_VALUES,LEN(@INSERT_VALUES)-1)
    SET @UPDATE_VALUES=LEFT(@UPDATE_VALUES,LEN(@UPDATE_VALUES)-1)

-- ----------------
-- clean up cursor
-- ----------------
CLOSE TableCol;
DEALLOCATE TableCol;

--Print Upsert Statement
    PRINT N'/****** Object:  StoredProcedure [dbo].[' + @ProcName + '_ups]    Script Date: ' + CAST(GETDATE() AS nvarchar(30)) + '  ******/' + CHAR(13) + CHAR(10) 
    PRINT @LEGEND;
    PRINT N'-- Description : Upsert ' + @DESC + CHAR(13) + CHAR(10) 
    PRINT N'-- ===================================================================' + CHAR(13) + CHAR(10) 
    PRINT CHAR(13) + CHAR(10) 
    PRINT N'CREATE PROCEDURE [dbo].[' + @ProcName  + '_ups]' + CHAR(13) + CHAR(10);
    PRINT N'  (' + @PARAMETERS + N')' + CHAR(13) + CHAR(10);
    PRINT N'AS' + CHAR(13) + CHAR(10) 
    PRINT N'BEGIN' + CHAR(13) + CHAR(10) 
    PRINT N'  SET CONTEXT_INFO @MyID;' + CHAR(13) + CHAR(10) 
    PRINT N'  IF @ID IS NULL OR @ID = 0' + CHAR(13) + CHAR(10) 
    PRINT N'    BEGIN' + CHAR(13) + CHAR(10) 
    PRINT N'      INSERT INTO [dbo].[' + @TableName + ']' + CHAR(13) + CHAR(10) 
    PRINT N'        (' + @INSERT_FIELDS + N')' + CHAR(13) + CHAR(10) 
    PRINT N'      VALUES' + CHAR(13) + CHAR(10) 
    PRINT N'        (' + @INSERT_VALUES + N');' + CHAR(13) + CHAR(10) 
    PRINT N'      SELECT * FROM [dbo].[' + @ViewName + '] WHERE [ID] = SCOPE_IDENTITY();' + CHAR(13) + CHAR(10) 
    PRINT N'    END' + CHAR(13) + CHAR(10) 
    PRINT N'  ELSE' + CHAR(13) + CHAR(10) 
    PRINT N'    BEGIN' + CHAR(13) + CHAR(10) 
    PRINT N'      UPDATE [dbo].[' + @TableName + ']' + CHAR(13) + CHAR(10) 
    PRINT N'        SET ' + @UPDATE_VALUES + CHAR(13) + CHAR(10) 
    PRINT N'        WHERE ([' + @PRIMARY_KEY + '] = @ID) AND ([RowVersion] = @RowVersion);' + CHAR(13) + CHAR(10) 
    PRINT N'      SELECT * FROM [dbo].[' + @ViewName + '] WHERE [ID] = @ID;' + CHAR(13) + CHAR(10) 
    PRINT N'    END' + CHAR(13) + CHAR(10) 
    PRINT N'END' + CHAR(13) + CHAR(10) 
    PRINT N'GO' + CHAR(13) + CHAR(10) 
    PRINT CHAR(13) + CHAR(10) 

----Now add GRANT and DENY permissions to the Role
    PRINT N'GRANT EXECUTE ON [dbo].[' + @ProcName + '_ups] TO [' + @DBRoleName + ']' + CHAR(13) + CHAR(10) 
    PRINT N'GO' + CHAR(13) + CHAR(10) 
    PRINT N'DENY VIEW DEFINITION ON [dbo].[' + @ProcName + '_ups] TO [' + @DBRoleName + ']' + CHAR(13) + CHAR(10) 
    PRINT N'GO' + CHAR(13) + CHAR(10) 
    PRINT CHAR(13) + CHAR(10) 
    PRINT CHAR(13) + CHAR(10) 

    --Print Select Statement
    PRINT N'/****** Object:  StoredProcedure [dbo].[' + @ProcName + '_sel]    Script Date: ' + CAST(GETDATE() AS nvarchar(30)) + '  ******/' + CHAR(13) + CHAR(10) 
    PRINT @LEGEND;
    PRINT N'-- Description : Select ' + @DESC + CHAR(13) + CHAR(10) 
    PRINT N'-- ===================================================================' + CHAR(13) + CHAR(10) 
    PRINT CHAR(13) + CHAR(10) 
    PRINT N'CREATE PROCEDURE [dbo].[' + @ProcName  + '_sel]' + CHAR(13) + CHAR(10);
    PRINT N'  (@MyID int, @ID int=NULL' + IIF(@ISACTIVE_SEL = 1,', @IsActive bit=NULL','') + ')' + CHAR(13) + CHAR(10);
    PRINT N'AS' + CHAR(13) + CHAR(10) 
    PRINT N'BEGIN' + CHAR(13) + CHAR(10) 
    PRINT N'  SET CONTEXT_INFO @MyID;' + CHAR(13) + CHAR(10) 
    PRINT N'  IF @ID IS NULL OR @ID = 0' + CHAR(13) + CHAR(10) 

    IF @ISACTIVE_SEL = 1
        BEGIN
            PRINT N'    BEGIN' + CHAR(13) + CHAR(10) 
            PRINT N'      IF @IsActive IS NULL' + CHAR(13) + CHAR(10) 
            PRINT N'        SELECT * FROM [dbo].[' + @ViewName + '] ORDER BY [' + @OrderBy + '] ' + @OrderByDir + ';' + CHAR(13) + CHAR(10) 
            PRINT N'      ELSE' + CHAR(13) + CHAR(10) 
            PRINT N'        SELECT * FROM [dbo].[' + @ViewName + '] WHERE [isActive] = @IsActive ORDER BY [' + @OrderBy + '] ' + @OrderByDir + ';' + CHAR(13) + CHAR(10) 
            PRINT N'    END' + CHAR(13) + CHAR(10) 
        END
    ELSE
        PRINT N'    SELECT * FROM [dbo].[' + @ViewName + '] ORDER BY [' + @OrderBy + '] ' + @OrderByDir + ';' + CHAR(13) + CHAR(10) 

    PRINT N'  ELSE' + CHAR(13) + CHAR(10) 
    PRINT N'    SELECT * FROM [dbo].[' + @ViewName + '] WHERE [ID] = @ID;' + CHAR(13) + CHAR(10) 
    PRINT N'END' + CHAR(13) + CHAR(10) 
    PRINT N'GO' + CHAR(13) + CHAR(10) 
    PRINT CHAR(13) + CHAR(10) 

----Now add GRANT and DENY permissions to the Role
    PRINT N'GRANT EXECUTE ON [dbo].[' + @ProcName + '_sel] TO [' + @DBRoleName + ']' + CHAR(13) + CHAR(10) 
    PRINT N'GO' + CHAR(13) + CHAR(10) 
    PRINT N'DENY VIEW DEFINITION ON [dbo].[' + @ProcName +'_sel] TO [' + @DBRoleName + ']' + CHAR(13) + CHAR(10) 
    PRINT N'GO' + CHAR(13) + CHAR(10) 
    PRINT CHAR(13) + CHAR(10) 
    PRINT CHAR(13) + CHAR(10) 

    --Print Delete Statement
    PRINT N'/****** Object:  StoredProcedure [dbo].[' + @ProcName + '_del]    Script Date: ' + CAST(GETDATE() AS nvarchar(30)) + '  ******/' + CHAR(13) + CHAR(10) 
    PRINT @LEGEND;
    PRINT N'-- Description : Delete ' + @DESC + CHAR(13) + CHAR(10) 
    PRINT N'-- ===================================================================' + CHAR(13) + CHAR(10) 
    PRINT CHAR(13) + CHAR(10) 
    PRINT N'CREATE PROCEDURE [dbo].[' + @ProcName  + '_del]' + CHAR(13) + CHAR(10);
    PRINT N'  (@MyID int, @ID int, @RowVersion int)' + CHAR(13) + CHAR(10);
    PRINT N'AS' + CHAR(13) + CHAR(10) 
    PRINT N'BEGIN' + CHAR(13) + CHAR(10) 
    PRINT N'  SET CONTEXT_INFO @MyID;' + CHAR(13) + CHAR(10) 
    PRINT N'  SET NOCOUNT ON;' + CHAR(13) + CHAR(10) 
    PRINT N'  DELETE FROM [dbo].[' + @TableName + '] WHERE [' + @PRIMARY_KEY + ']=@ID AND [RowVersion]=@RowVersion;' + CHAR(13) + CHAR(10) 
    PRINT N'  SELECT @@ROWCOUNT as [Rows Affected];' + CHAR(13) + CHAR(10) 
    PRINT N'END' + CHAR(13) + CHAR(10) 
    PRINT N'GO' + CHAR(13) + CHAR(10) 
    PRINT CHAR(13) + CHAR(10) 

----Now add GRANT and DENY permissions to the Role
    PRINT N'GRANT EXECUTE ON [dbo].[' + @ProcName + '_del] TO [' + @DBRoleName + ']' + CHAR(13) + CHAR(10) 
    PRINT N'GO' + CHAR(13) + CHAR(10) 
    PRINT N'DENY VIEW DEFINITION ON [dbo].[' + @ProcName +'_del] TO [' + @DBRoleName + ']' + CHAR(13) + CHAR(10) 
    PRINT N'GO' + CHAR(13) + CHAR(10) 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2017-06-27T08:09:55.973

除了前面提到的工具之外，还有另一个免费工具，您只需点击几下即可完成工作。

为此，您需要在[ApexSQL Complete](https://www.apexsql.com/sql_tools_complete.aspx)选项窗口中输入前缀和后缀，您可以在其中为每个 CRUD 过程模板（选择、插入、更新、删除）选择一个子选项卡。完成此操作后，可以通过右键单击对象资源管理器窗口、数据库或下拉菜单中的表来使用 CRUD 过程功能。

这是 [一篇](https://blog.apexsql.com/whats-next-in-apexsql-complete-2017-r6-automatic-crud-stored-procedure-generation/) 包含有关此功能的更多详细信息的文章（虽然文章有点旧，因为该功能已添加到当前版本中）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-07-22T10:31:42.257

您可以使用选定表中的预定义模板生成四个 CRUD 过程。此功能在多个加载项中可用，例如[SSMS Toolpack](https://www.ssmstoolspack.com/)和[SQL Complete](https://www.devart.com/dbforge/sql/sqlcomplete/productivity-extension.html#generate_crud)。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-05-20T03:26:01.130

```
CREATE PROCEDURE SP_USUARIO
@usuario varchar(30)=null,
@clave varchar(500)=null,
@idPersona int=null,
@idRol int=null,
@idUsuario int=null,
@TIPO TINYINT=1
AS
BEGIN
    IF @TIPO=1 -- LISTAR PERSONAS
    BEGIN
        SELECT idPersona,Nombre,ApePaterno,ApeMaterno,DNI,Direccion,celular,email FROM Persona
    END
    IF @TIPO=2 -- LISTAR ROLES
    BEGIN
        SELECT idRol,Nombre,Descripcion FROM ROL
    END
    IF @TIPO=3 -- LISTAR USUARIOS
    BEGIN
        SELECT idUsuario,usuario,pass,idPersona,idRol from Usuario
    END
    IF @TIPO=3 -- USUARIOS
    BEGIN
        SELECT idUsuario,usuario,pass,idPersona,idRol from Usuario where idUsuario=@idUsuario
    END
    IF @TIPO=4 -- AGREGAR USUARIO
    BEGIN
        INSERT Usuario(usuario,pass,idPersona,idRol) values(@usuario,@clave,@idPersona,@idRol)
    END
    IF @TIPO=5 -- EDITAR USUARIO
    BEGIN
        UPDATE Usuario SET usuario=@usuario,pass=@clave,@idPersona=@idPersona,idRol=@idRol where idUsuario=@idUsuario
    END
    IF @TIPO=6 -- ELIMINAR USUARIO
    BEGIN
        DELETE Usuario WHERE idUsuario=@idUsuario
    END
END

go 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2018-12-03T09:25:03.967

感谢原始脚本。
我用以下改进了它：
- 允许在另一个数据库上做
- 对于选择，根据参数动态生成查询
- 管理列 CreatedBy/Date 和 ModificationBy/Date
- 即使在模式/表/列中找到特殊字符也可以工作
- 允许系统地添加用户和文化。
- 程序名称模板
和很多选项。

注意：代码发送两个答案，限制为 30000 个字符。

```
IF OBJECT_ID('dbo.GenerateDynamicallyProceduresForTables','P') IS NOT NULL
    DROP PROCEDURE dbo.GenerateDynamicallyProceduresForTables
GO

CREATE PROCEDURE dbo.GenerateDynamicallyProceduresForTables @DatabaseName nvarchar(200)=NULL,
                                                            @SchemaName nvarchar(200) = NULL,
                                                            @TableName nvarchar(200) = NULL,
                                                            @NoCount bit=1,
                                                            @ManageTransaction bit=1,
                                                            @GenerateDebugScriptForList bit = 1,
                                                            @ParameterForUser nvarchar(20) = '@UserInP',
                                                            @ParameterForCulture nvarchar(20) = '@CultureInP',
                                                            @FirstParametersAreMandatory bit=1,
                                                            @ProcedureTemplateName nvarchar(100) = '[{SchemaName}].[{TableName}_Proc_{ActionType}]',
                                                            @ColumnNameLimitation nvarchar(500)= '', --(syscolumns.name LIKE ''%Creation%'' OR syscolumns.name IN (''SomeInt'',''Somebit'') )
                                                            @CreationUserMatch nvarchar(500) = 'syscolumns.name LIKE ''%CreationUser%'' OR syscolumns.name LIKE ''%CreationBy%''',
                                                            @CreationDateMatch nvarchar(500) = 'syscolumns.name LIKE ''%CreationDate%'' OR syscolumns.name LIKE ''%CreatedDate%''',
                                                            @ModificationUserMatch nvarchar(500) = 'syscolumns.name LIKE ''%ModificationUser%'' OR syscolumns.name LIKE ''%ModifiedBy%''  OR syscolumns.name LIKE ''%ModifiedUser%''',
                                                            @ModificationDateMatch nvarchar(500) = 'syscolumns.name LIKE ''%ModificationDate%'' OR syscolumns.name LIKE ''%ModifiedDate%'''
AS
BEGIN
DECLARE @UnCommentExecForDebug bit=0 --To set at 0 for final

DECLARE @StatementList TABLE(id INT IDENTITY(1,1) NOT NULL PRIMARY KEY,FullTableName nvarchar(1000),StatementType nvarchar(100),Statement nvarchar(max))  
DECLARE @FirstParameters nvarchar(400)='',@FirstParametersForExec nvarchar(400)=''

IF LEN(@ParameterForUser)>1 
BEGIN
  SET @FirstParameters = @FirstParameters + @ParameterForUser  +' nvarchar(500)' + CASE WHEN @FirstParametersAreMandatory =0  THEN ' = NULL' ELSE '' END +  ', 
    '
  SET @FirstParametersForExec = @FirstParametersForExec + @ParameterForUser + CASE WHEN @FirstParametersAreMandatory =0  THEN ' = NULL' ELSE ' =''K2:Denallix\Administrator''' END +  ', 
    '
END
IF LEN(@ParameterForCulture)>1
BEGIN
  SET @FirstParameters = @FirstParameters + @ParameterForCulture  + ' nvarchar(10)' + CASE WHEN @FirstParametersAreMandatory =0  THEN ' = NULL' ELSE '' END +  ', 
    '
  SET @FirstParametersForExec = @FirstParametersForExec + @ParameterForCulture + CASE WHEN @FirstParametersAreMandatory =0  THEN ' = NULL' ELSE '=''en-gb''' END +  ', 
    '
END
IF NOT(LEN(@DatabaseName)>0)
 SET @DatabaseName=DB_NAME()

 IF LEN(@SchemaName)=0
 SET @SchemaName=NULL

 IF LEN(@TableName)=0
 SET @TableName=NULL

IF NOT(LEN(@ColumnNameLimitation)>0)  
  SET @ColumnNameLimitation = '1=1'

IF NOT(LEN(@CreationUserMatch)>0)  
   SET @CreationUserMatch = 'syscolumns.name = ''BIDON12345678917071979'''

IF NOT(LEN(@CreationDateMatch)>0)  
   SET @CreationDateMatch = 'syscolumns.name = ''BIDON12345678917071979'''

IF NOT(LEN(@ModificationUserMatch)>0)  
   SET @ModificationUserMatch = 'syscolumns.name = ''BIDON12345678917071979'''

IF NOT(LEN(@ModificationDateMatch)>0)  
   SET @ModificationDateMatch = 'syscolumns.name = ''BIDON12345678917071979'''

DECLARE @strSpText nVarchar(max) ='USE [' + @DatabaseName + ']'
IF @DatabaseName!=DB_NAME()
INSERT INTO @StatementList (FullTableName,StatementType,Statement) VALUES ('Common','Set current database',@strSPText)

 DECLARE @sqlstatementForTables nvarchar(max) = -- Not test with USE [' + @DatabaseName + '] ISSUE ON Table iDENTITY.Identity: 'Could not complete cursor operation because the set options have changed since the cursor was declared
      N'
      DECLARE Tables_cursor CURSOR FOR
       SELECT TABLE_SCHEMA,TABLE_NAME
         FROM [' + @DatabaseName + '].INFORMATION_SCHEMA.TABLES
        WHERE TABLE_TYPE=''BASE TABLE''
          AND (TABLE_SCHEMA=@pSchemaName OR @pSchemaName IS NULL)
          AND (Table_Name=@pTableName OR @pTableName IS NULL)'

     --EXEC loopbackServerForDebug.[K2FranceDebugDB].dbo.K2FranceDebug '@sqlstatementForColumns',@sqlstatementForColumns
      exec sp_executesql @sqlstatementForTables, N'@pSchemaName  nvarchar(200),@pTableName  nvarchar(200)', @pSchemaName=@SchemaName, @pTableName=@TableName;

OPEN Tables_cursor
DECLARE @CurrentSchemaName nvarchar(100),@CurrentFullTableName nvarchar(1000),@CurrentTableName nVarchar(1000),
        @DropStatement nvarchar(max)=''
Fetch next
from Tables_cursor
INTO @CurrentSchemaName,@CurrentTableName
WHILE @@FETCH_STATUS=0
BEGIN

    SET @CurrentFullTableName='['+@CurrentSchemaName+'].['+@CurrentTableName+']';
    --PRINT @CurrentFullTableName

    Declare @dbName nVarchar(50)
    Declare @insertSPName nVarchar(4000), @updateSPName nVarchar(4000), @deleteSPName nVarchar(4000), @listSPName nVarchar(4000)--, @ReadSPName nVarchar(50) ;
    Declare @ColumnParametersInsert nVarchar(max), @ColumnDefForInsert nVarchar(max),@ColumnInValueForInsert nVarchar(max),
            @ColumnParametersList nVarchar(max),@ColumnParametersListForExec nVarchar(max),
            @tableColumnForWhereInList nvarchar(max),
            @tableColumnForWhereInListVariables nVarchar(max), @tableColumnForWhereInListAffectVariables nVarchar(max),@DebugVariablesForList nvarchar(max)='',
            @ColumnParametersInsertForExec nvarchar(max)
    Declare @tableCols nVarchar(max), @ColumnParametersUpdate nVarchar(max),@ColumnParametersUpdateForExec nVarchar(max);
    Declare @space nVarchar(50) = REPLICATE(' ', 4) ;
    Declare @colName nVarchar(max) ;
    Declare @DataType nvarchar(200),@colVariable nVarchar(200),@colVariableProc nVarchar(200);
    Declare @colParameter nVarchar(max) ;
    Declare @colAllowNull nvarchar(15), @colIsPrimaryKey INT,@ColIsIdentityAutoIncrement INT,@ColLength INT,@ColIsComputed INT,@ColMatchCreationUser INT,@ColMatchCreationDate INT,@ColMatchModificationUser INT,@ColMatchModificationDate INT;

    Declare @updCols nVarchar(max);
    Declare @ColumnParametersDelete nVarchar(max),@ColumnParametersDeleteForExec nVarchar(max),
            @LastPrimaryKey nvarchar(max),@NbPrimaryKey INT=0,@ColNumber int=0
    Declare @whereCols nVarchar(2000);
    DECLARE @SetVariablesForExec nvarchar(max)='',@SetVariablesForExecUpdate nvarchar(max)='', @SetVariablesForExecDelete nvarchar(max)=''

    DECLARE @strBegin nvarchar(1000)=' AS' + CHAR(13) + CHAR(10) + 'BEGIN',@spaceForTrans nvarchar(10)=''
    IF @NoCount=1
      Set @strBegin = @strBegin + CHAR(13) + CHAR(10) + @space + 'SET NOCOUNT ON '

    IF @ManageTransaction = 1 
    BEGIN
        Set @strBegin = @strBegin + CHAR(13) + CHAR(10) + @space + 'SET XACT_ABORT ON -- if a Transact-SQL statement raises a run-time error, the entire transaction is terminated and rolled back.'
      Set @strBegin = @strBegin + CHAR(13) + CHAR(10) + ''
      Set @strBegin = @strBegin + CHAR(13) + CHAR(10) + @space + 'BEGIN TRAN '
      SET @spaceForTrans= @space;
    END
    DECLARE @strEnd nvarchar(1000)=''
    IF @ManageTransaction = 1 
      Set @strEnd = @strEnd + CHAR(13) + CHAR(10) + @space + 'COMMIT TRAN '
    SET @strEnd = @strEnd + CHAR(13) + CHAR(10) + 'END'
    Set @strEnd = @strEnd + CHAR(13) + CHAR(10) + 'GO'
    Set @strEnd = @strEnd + CHAR(13) + CHAR(10) + ''
    IF @UnCommentExecForDebug = 0 Set @strEnd = @strEnd + CHAR(13) + CHAR(10) + '/*'

    IF @ProcedureTemplateName IS NULL
      BEGIN
        Set @insertSPName = '['+@CurrentSchemaName+'].[sp_' + @CurrentTableName +'_insert]' ;
        Set @updateSPName = '['+@CurrentSchemaName+'].[sp_' + @CurrentTableName +'_update]' ;
        Set @deleteSPName = '['+@CurrentSchemaName+'].[sp_' + @CurrentTableName +'_delete]' ;
        set @listSPName =  '['+@CurrentSchemaName+'].[sp_' + @CurrentTableName +'_list]' ;
      END
    ELSE
      BEGIN
         DECLARE @ProcedureName nvarchar(200)=REPLACE(REPLACE(@ProcedureTemplateName,'{SchemaName}',ISNULL(@SchemaName,@CurrentSchemaName)),'{TableName}',ISNULL(@TableName,@CurrentTableName));
         Set @insertSPName = REPLACE(@ProcedureName,'{ActionType}','Insert')
         Set @updateSPName = REPLACE(@ProcedureName,'{ActionType}','Update')
         Set @deleteSPName = REPLACE(@ProcedureName,'{ActionType}','Delete')
         Set @listSPName = REPLACE(@ProcedureName,'{ActionType}','List')   
      END

SET @DropStatement = @DropStatement+ '
DROP PROCEDURE ' + @insertSPName + '
DROP PROCEDURE ' + @updateSPName + '
DROP PROCEDURE ' + @deleteSPName +'
DROP PROCEDURE ' + @listSPName 

    Set @ColumnParametersInsert = @FirstParameters ;
    SET @ColumnParametersInsertForExec = @FirstParametersForExec
    Set @ColumnParametersUpdate=@FirstParameters
    SET @ColumnParametersUpdateForExec=@FirstParametersForExec
    Set @ColumnParametersDelete = @FirstParameters ;
    SET @ColumnParametersDeleteForExec = @FirstParametersForExec ;
    SET @ColumnParametersList = @FirstParameters;
    SET @ColumnParametersListForExec = @FirstParametersForExec

    SET @tableColumnForWhereInList= ''
    SET @tableColumnForWhereInListVariables =''
    SET @tableColumnForWhereInListAffectVariables =''
    SET @DebugVariablesForList ='';
    Set @ColumnDefForInsert = '' ;
    Set @ColumnInValueForInsert = '' ;
    Set @strSPText = '' ;
    Set @tableCols = '' ;
    Set @updCols = '' ;

    Set @whereCols = '' ;

    SET NOCOUNT ON

    CREATE TABLE #tmp_Structure (colid int,ColumnName nvarchar(max), 
                                 ColumnVariable nvarchar(max),
                                 DataType nvarchar(max), 
                                 ColumnParameter nvarchar(max), 
                                 AllowNull int, 
                                 IsPrimaryKey int, 
                                 IsIdentityAutoIncrement int, 
                                 ColLength int, 
                                 IsIsComputedColumn int,
                                 ColMatchCreationUser int,ColMatchCreationDate int,
                                 ColMatchModificationUser INT,ColMatchModificationDate INT)

    DECLARE @sqlstatementForColumns nvarchar(max) = 
      N'USE [' + @DatabaseName + ']
      SELECT distinct
           --sysobjects.name as ''Table'',
           syscolumns.colid ,
           ''['' + syscolumns.name + '']'' as ''ColumnName'',
           ''@''+syscolumns.name as ''ColumnVariable'',           
           systypes.name +
           Case When systypes.xusertype in (165,167,175,231,239 ) Then ''('' + Convert(varchar(10),Case When syscolumns.length=-1 Then ''max'' else CAST(syscolumns.length AS nvarchar(10)) end) +'')'' Else '''' end as ''DataType'' ,
           systypes.name +  Case When systypes.xusertype in (165,167,175,231,239 ) Then ''('' + Convert(varchar(10),Case When syscolumns.length=-1 Then ''max'' else CAST(syscolumns.length AS nvarchar(10)) end) +'')'' Else '''' end as ''ColumnParameter'',
           COLUMNPROPERTY(OBJECT_ID(@pFullTableName),syscolumns.name,''AllowsNull'') AS AllowNull,
           (SELECT COUNT(*) 
                    FROM [' + @DatabaseName + '].INFORMATION_SCHEMA.TABLE_CONSTRAINTS Tab, 
                         [' + @DatabaseName + '].INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE Col 
                   WHERE Col.Constraint_Name = Tab.Constraint_Name
                    AND Col.Table_Name = Tab.Table_Name
                    AND Constraint_Type = ''PRIMARY KEY''
                    AND Col.Table_Name = @pTableName
                    AND Tab.TABLE_SCHEMA=@pSchemaName
                    AND Col.Column_Name = syscolumns.name
                        ) AS IsPrimaryKey, 
           SC.is_identity AS IsIdentityAutoIncrement,
           syscolumns.length,
           (SELECT COUNT(*)
              FROM sys.computed_columns
             WHERE computed_columns.object_id=sysobjects.id
               AND computed_columns.Name=syscolumns.name) AS IsComputedColumn,
            CASE WHEN ' + @CreationUserMatch +' THEN 1 ELSE 0 END AS ColMatchCreationUser,
            CASE WHEN ' + @CreationDateMatch +' THEN 1 ELSE 0 END AS ColMatchCreationDate,
            CASE WHEN ' + @ModificationUserMatch +' THEN 1 ELSE 0 END AS ColMatchModificationUser,
            CASE WHEN ' + @ModificationDateMatch +' THEN 1 ELSE 0 END AS ColMatchModificationDate
    FROM sysobjects 
         LEFT JOIN syscolumns ON syscolumns.id=sysobjects.id
         LEFT JOIN systypes ON systypes.xusertype=syscolumns.xusertype
         LEFT JOIN sys.columns SC ON SC.object_id = sysobjects.id
                           AND SC.name=syscolumns.name
    Where sysobjects.xtype = ''u''
      and sysobjects.id = OBJECT_ID(@pFullTableName)
      AND (' + @ColumnNameLimitation + ')
    Order by syscolumns.colid'

     --PRINT @sqlstatementForColumns
     --EXEC loopbackServerForDebug.[K2FranceDebugDB].dbo.K2FranceDebug '@sqlstatementForColumns',@sqlstatementForColumns

      INSERT INTO #tmp_Structure
      exec sp_executesql @sqlstatementForColumns, N'@pSchemaName  nvarchar(200),@pTableName  nvarchar(200),@pFullTableName nvarchar(1000)', @pSchemaName=@CurrentSchemaName, @pTableName=@CurrentTableName,@pFullTableName=@CurrentFullTableName;

      --SELECT * FROM #tmp_Structure

    /* Read the table structure and populate variables*/
    DECLARE SpText_Cursor CURSOR FOR
     SELECT ColumnName, ColumnVariable, DataType, ColumnParameter, AllowNull, IsPrimaryKey, IsIdentityAutoIncrement,ColLength, IsIsComputedColumn,ColMatchCreationUser,ColMatchCreationDate,ColMatchModificationUser,ColMatchModificationDate
       FROM #tmp_Structure
    OPEN SpText_Cursor

    FETCH NEXT FROM SpText_Cursor INTO @colName, @colVariable,  @DataType, @colParameter, @colAllowNull,@colIsPrimaryKey, @ColIsIdentityAutoIncrement,@ColLength, @ColIsComputed,@ColMatchCreationUser,@ColMatchCreationDate,@ColMatchModificationUser,@ColMatchModificationDate
    WHILE @@FETCH_STATUS = 0
    BEGIN
       SET @ColNumber=@ColNumber+1

       SET @SetVariablesForExec = @SetVariablesForExec  + CASE WHEN @colAllowNull =1 THEN '' 
                                                         ELSE  CASE WHEN @DataType  IN ('datetime','datetime2','smalldatetime','date') AND @SetVariablesForExec NOT LIKE '%@Date%' THEN CHAR(13) +CHAR(10) + 'DECLARE @Date datetime =GetDate()'  
                                                                            WHEN @DataType  IN ('uniqueidentifier') AND @SetVariablesForExec NOT LIKE '%@GuidTest%' THEN CHAR(13) +CHAR(10) + 'DECLARE @TheGuid uniqueidentifier  =NEWID()'                                                                             
                                                                            ELSE '' 
                                                                       END
                                                         END

       --RegEx to keep only alphanumeric characters:
       DECLARE @MatchExpression nvarchar(20) =  '%[^a-z0-9]%',@DateTypeWithoutSpecialCharacters nvarchar(100)=@DataType;

       WHILE PatIndex(@MatchExpression, @DateTypeWithoutSpecialCharacters) > 0
        SET @DateTypeWithoutSpecialCharacters = Stuff(@DateTypeWithoutSpecialCharacters, PatIndex(@MatchExpression, @DateTypeWithoutSpecialCharacters), 1, '')

       --Remove Special characters (like space...) for variable name
       WHILE PatIndex(@MatchExpression, @colVariable) > 0
        SET @colVariable = Stuff(@colVariable, PatIndex(@MatchExpression, @colVariable), 1, '')

       SET @colVariableProc = '@p'+ @colVariable 
       SET @colVariable = '@'+ @colVariable 

       SET @colParameter = @colVariable + ' ' + @colParameter 

       DECLARE @AffectationForExec nvarchar(max)=@colVariable + CASE WHEN @colAllowNull =1 THEN ' = NULL' 
                     ELSE ' = ' +  CASE WHEN @DataType IN ('Text','sysname') OR @DataType LIKE '%char%'  THEN '''' + SUBSTRING ( CAST(ABS(@ColLength) AS nvarchar(10)) + 'TEST' + @DateTypeWithoutSpecialCharacters,0,CASE WHEN @ColLength < 0 THEN 1000 WHEN @DataType LIKE 'nchar%' THEN @ColLength/2+1 ELSE @ColLength END) + ''''
                                        WHEN @DataType  IN ('int','numeric','bigint','tinyint') THEN CAST(@ColNumber AS nvarchar(10))   
                                        WHEN @DataType  IN ('bit') THEN '0'   
                                        WHEN @DataType  IN ('float') THEN CAST(@ColNumber AS nvarchar(10))   +  '.' + CAST(@ColNumber+1 AS nvarchar(10)) 
                                        WHEN @DataType  IN ('datetime','datetime2','smalldatetime','date') THEN '@Date'  
                                        WHEN @DataType  IN ('uniqueidentifier') THEN '@TheGuid'  
                                        WHEN @DataType  IN ('xml') THEN '''<testXML><value name="test">' + CAST(@ColNumber AS nvarchar(10)) + '</value></testXML>''' 
                                        ELSE '''1''--Currently Not managed' 
                                   END
                END +  ', --Type ' + @DataType  + CHAR(13) + CHAR(10) + @space 

       IF @ColIsIdentityAutoIncrement = 0 AND @ColIsComputed = 0 
       BEGIN
          IF @ColMatchModificationUser = 0  AND @ColMatchModificationDate = 0
            Set @ColumnDefForInsert = @ColumnDefForInsert + @colName+ ',' + CHAR(13) + CHAR(10) + @space + @space + @spaceForTrans ;

          IF @ColMatchCreationUser= 0 AND @ColMatchCreationDate = 0 AND @ColMatchModificationUser = 0  AND @ColMatchModificationDate = 0
          BEGIN
            Set @ColumnParametersInsert = @ColumnParametersInsert + @colParameter + CASE WHEN @colAllowNull =1  THEN ' = NULL' ELSE '' END +  ','  + CHAR(13) + CHAR(10) + @space ;
            SET @ColumnParametersInsertForExec = @ColumnParametersInsertForExec + @AffectationForExec
          END 

          IF @ColMatchCreationUser= 1
          BEGIN
            IF LEN(@ParameterForUser)>1 
               Set @ColumnInValueForInsert = @ColumnInValueForInsert + 'ISNULL(' + @ParameterForUser + ',SYSTEM_USER)'
            ELSE
               Set @ColumnInValueForInsert = @ColumnInValueForInsert + 'SYSTEM_USER'
          END
          ELSE
          BEGIN
            IF @ColMatchCreationDate= 1
              Set @ColumnInValueForInsert = @ColumnInValueForInsert + 'GETDATE()'  
            ELSE
              IF @ColMatchModificationUser = 0  AND @ColMatchModificationDate = 0
                Set @ColumnInValueForInsert = @ColumnInValueForInsert + @colVariable
          END
          IF @ColMatchCreationUser= 1 OR @ColMatchCreationDate= 1 OR @ColMatchModificationUser = 0  AND @ColMatchModificationDate = 0
        SET @ColumnInValueForInsert =@ColumnInValueForInsert + ',' + CHAR(13) + CHAR(10) + @space + @space+ @spaceForTrans

          Set @tableCols = @tableCols + @colName + ',' ;

          IF @ColMatchModificationUser = 1
          BEGIN
             IF LEN(@ParameterForUser)>1 
               Set @updCols = @updCols + @colName + ' = ISNULL(' + @ParameterForUser + ',SYSTEM_USER)'; 
            ELSE
               Set @updCols = @updCols + @colName + ' = SYSTEM_USER'; 
          END 
          ELSE
          BEGIN
            IF @ColMatchModificationDate = 1
               Set @updCols = @updCols + @colName + ' = GETDATE()';     
            ELSE
              IF @ColMatchCreationUser=0 AND @ColMatchCreationDate=0
              Set @updCols = @updCols + @colName + ' = ' + @colVariable;     
          END   
          IF @ColMatchModificationUser = 1 OR @ColMatchModificationDate = 1 OR @ColMatchCreationUser=0 AND @ColMatchCreationDate=0
        SET @updCols =@updCols + ',' + CHAR(13) + CHAR(10) + @space + @space+ '   ' + @spaceForTrans

       END

       SET @ColumnParametersList = @ColumnParametersList + @colParameter + ' = NULL' +  ','  + CHAR(13) + CHAR(10) + @space ;
       SET @ColumnParametersListForExec = @ColumnParametersListForExec+  @colVariable + ' = NULL, --Type ' + @DataType  + CHAR(13) + CHAR(10) + @space 

       IF @ColIsIdentityAutoIncrement = 1 AND @DataType='int'
          BEGIN
            SET @SetVariablesForExecUpdate =   CHAR(13)+CHAR(10)+'DECLARE @PrimaryKeyValue INT= (SELECT MIN(' + @colName + ') FROM ' + @CurrentFullTableName + ')'
            SET @AffectationForExec = @colVariable  + '= @PrimaryKeyValue, --Type ' + @DataType  + CHAR(13) + CHAR(10) + @space 
          END 

       IF @ColIsComputed = 0 AND @ColMatchCreationUser=0 AND @ColMatchCreationDate=0 AND @ColMatchModificationUser=0 AND @ColMatchModificationDate=0
       BEGIN
         Set @ColumnParametersUpdate = @ColumnParametersUpdate + @colParameter + ',' + CHAR(13) + CHAR(10) + @space ;
         SET @ColumnParametersUpdateForExec = @ColumnParametersUpdateForExec + @AffectationForExec
       END

       IF @DataType NOT IN ('text') 
       BEGIN
         IF @DataType NOT IN ('Xml')
         BEGIN
             SET @tableColumnForWhereInList = @tableColumnForWhereInList + '
                 IF ' + @colVariable + ' IS NOT NULL
                   BEGIN
                     SET @Statement= @Statement+ @Separator + ''' + REPLACE(@colName,'''','''''') + '= '+  @colVariableProc +'''
                     SET @Separator = @SeparatorAnd
                   END'
             SET @tableColumnForWhereInListVariables = @tableColumnForWhereInListVariables + @space + @space + @space + @spaceForTrans + @colVariableProc + ' ' + @DataType +',
        '
             SET @tableColumnForWhereInListAffectVariables = @tableColumnForWhereInListAffectVariables + @space + @space + @space  + @spaceForTrans + @colVariableProc + '=' + @colVariable + ',
        '             
         END  
          SET @DebugVariablesForList = @DebugVariablesForList+ CHAR(13) +CHAR(10)  + @space + @space + @space + @space +@space+ @spaceForTrans 
          IF @DataType IN ('Xml')
            SET @DebugVariablesForList = @DebugVariablesForList+  'ISNULL(''DECLARE '+ @colVariableProc + ' ' + @DataType+' = CAST('''''' + REPLACE(CAST(' +@colVariable + ' as nvarchar(max)),'''''''','''''''''''') + ''''''AS XML);''+CHAR(13)+CHAR(10) ,'''') + '
          ELSE
            SET @DebugVariablesForList = @DebugVariablesForList+  'ISNULL(''DECLARE '+ @colVariableProc + ' ' + @DataType+' = '''''' + REPLACE(' +@colVariable + ','''''''','''''''''''') + '''''';''+CHAR(13)+CHAR(10) ,'''') + '
       END

       IF @colIsPrimaryKey= 1
       BEGIN
          IF @ColIsIdentityAutoIncrement = 1 AND @DataType='int'
          BEGIN
            SET @SetVariablesForExecDelete =   CHAR(13)+CHAR(10)+'DECLARE @PrimaryKeyValue INT= (SELECT MAX(' + @colName + ') FROM ' + @CurrentFullTableName + ')'
          END 

         SET @ColumnParametersDelete = @ColumnParametersDelete + @colParameter +', ' + CHAR(13) + CHAR(10) + @space ;

         SET @ColumnParametersDeleteForExec = @ColumnParametersDeleteForExec + @AffectationForExec
         SET @whereCols = @whereCols + @colName + ' = ' + @colVariable + ' AND ' ;
         SET @NbPrimaryKey = @NbPrimaryKey +1
         SET @LastPrimaryKey = @colName
       END
    FETCH NEXT FROM SpText_Cursor INTO @colName, @colVariable, @DataType,@colParameter, @colAllowNull,@colIsPrimaryKey,@ColIsIdentityAutoIncrement,@ColLength,@ColIsComputed,@ColMatchCreationUser,@ColMatchCreationDate,@ColMatchModificationUser,@ColMatchModificationDate
    END
    CLOSE SpText_Cursor
    DEALLOCATE SpText_Cursor

    IF @ColumnDefForInsert IS NULL
      RAISERROR('@ColumnDefForInsert IS NULL',16,1)
    IF @ColumnParametersInsert IS NULL
      RAISERROR('@ColumnParametersInsert IS NULL',16,1)
    IF @ColumnParametersInsertForExec IS NULL
      RAISERROR('@ColumnParametersInsertForExec IS NULL',16,1)
    IF @ColumnInValueForInsert IS NULL
      RAISERROR('@ColumnInValueForInsert IS NULL',16,1)
    IF @tableCols IS NULL
      RAISERROR('@tableCols IS NULL',16,1)
    IF @updCols IS NULL
      RAISERROR('@updCols IS NULL',16,1)

    IF @ColumnParametersDelete IS NULL
      RAISERROR('@ColumnParametersDelete IS NULL',16,1)
    IF @whereCols IS NULL
      RAISERROR('@whereCols IS NULL',16,1)

    DECLARE @LastPosOfComma INT

    If (LEN(@ColumnParametersUpdate)>0)
    BEGIN
      Set @ColumnParametersUpdate = LEFT(@ColumnParametersUpdate,LEN(@ColumnParametersUpdate)-3) ;
      SET @LastPosOfComma = LEN(@ColumnParametersUpdateForExec) - CHARINDEX(' ,',REVERSE(@ColumnParametersUpdateForExec))
      SET @ColumnParametersUpdateForExec = LEFT(@ColumnParametersUpdateForExec,@LastPosOfComma+3) + SUBSTRING(@ColumnParametersUpdateForExec,@LastPosOfComma+5,40000);
    END
     --See next post for the end of procedure 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2018-12-03T09:32:17.680

```
-- Here end end of the procedure (started on another post)
    If (LEN(@ColumnParametersInsert)>0)
    Begin

      Set @ColumnParametersInsert = LEFT(@ColumnParametersInsert,LEN(@ColumnParametersInsert)-3) ;
      SET @LastPosOfComma = LEN(@ColumnParametersInsertForExec) - CHARINDEX(' ,',REVERSE(@ColumnParametersInsertForExec))
      SET @ColumnParametersInsertForExec = LEFT(@ColumnParametersInsertForExec,@LastPosOfComma+3) + SUBSTRING(@ColumnParametersInsertForExec,@LastPosOfComma+5,40000);

      Set @ColumnParametersDelete = LEFT(@ColumnParametersDelete,LEN(@ColumnParametersDelete)-4) ;
      SET @LastPosOfComma = LEN(@ColumnParametersDeleteForExec) - CHARINDEX(' ,',REVERSE(@ColumnParametersDeleteForExec))
      SET @ColumnParametersDeleteForExec = LEFT(@ColumnParametersDeleteForExec,@LastPosOfComma+3) + SUBSTRING(@ColumnParametersDeleteForExec,@LastPosOfComma+5,40000);

      SET @ColumnParametersList = LEFT(@ColumnParametersList,LEN(@ColumnParametersList)-3) ;
      SET @LastPosOfComma = LEN(@ColumnParametersListForExec) - CHARINDEX(' ,',REVERSE(@ColumnParametersListForExec))
      SET @ColumnParametersListForExec = LEFT(@ColumnParametersListForExec,@LastPosOfComma+3) + SUBSTRING(@ColumnParametersListForExec,@LastPosOfComma+5,40000);

      IF LEN(@ColumnInValueForInsert)>0
        Set @ColumnInValueForInsert = LEFT(@ColumnInValueForInsert,LEN(@ColumnInValueForInsert)-3) ;
      IF LEN(@ColumnDefForInsert)>0
        Set @ColumnDefForInsert = LEFT(@ColumnDefForInsert,LEN(@ColumnDefForInsert)-3) ;
      IF LEN(@tableCols)>0
        Set @tableCols = LEFT(@tableCols,LEN(@tableCols)-1) ;
      IF LEN(@updCols)>0
        Set @updCols = LEFT(@updCols,LEN(@updCols)-3) ;
      SET @tableColumnForWhereInListVariables = LEFT(@tableColumnForWhereInListVariables,LEN(@tableColumnForWhereInListVariables)-3)
      SET @tableColumnForWhereInListAffectVariables = LEFT(@tableColumnForWhereInListAffectVariables,LEN(@tableColumnForWhereInListAffectVariables)-3) ;

    END

    If (LEN(@whereCols)>0)
      Set @whereCols = 'WHERE ' + LEFT(@whereCols,LEN(@whereCols)-4) ;
    ELSE
       Set @whereCols = 'WHERE 1=0 --Too dangerous to do update or delete on all the table'

    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- ============================================='
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- Author : ' + SYSTEM_USER
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- Create date : ' + Convert(varchar(20),Getdate())
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- Description : Insert Procedure for ' + @CurrentTableName    
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- ============================================='

    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'IF OBJECT_ID(''' + REPLACE(@insertSPName,'''','''''') + ''',''P'') IS NOT NULL'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '   DROP PROCEDURE  ' + @insertSPName 
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'GO'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + ''
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + ''

    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'CREATE PROCEDURE ' + @insertSPName
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + '' + @ColumnParametersInsert   
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @strBegin
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @spaceForTrans + 'INSERT INTO ' + @CurrentFullTableName + '('
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @spaceForTrans + '    ' + '' + @ColumnDefForInsert + ')'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @spaceForTrans + 'VALUES ('
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @spaceForTrans + '    ' + '' + @ColumnInValueForInsert + ')'

    IF @NbPrimaryKey =1 --No return if 2 or 0 primarykeys 
      Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @spaceForTrans + 'SELECT SCOPE_IDENTITY() AS ' + @LastPrimaryKey

    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @strEnd

    Set @strSPText = @strSPText + @SetVariablesForExec
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'EXEC ' + @insertSPName + ' '  + @ColumnParametersInsertForExec
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'GO'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'SELECT * FROM ' + @CurrentFullTableName + ' ORDER BY 1 DESC'
    IF @UnCommentExecForDebug = 0 Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '*/'

    INSERT INTO @StatementList (FullTableName,StatementType,Statement) VALUES (@CurrentFullTableName,'Insert',@strSPText)

    Set @strSPText = ''
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- ============================================='
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- Author : ' + SYSTEM_USER
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- Create date : ' + Convert(varchar(20),Getdate())
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- Description : Update Procedure for ' + @CurrentTableName
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- ============================================='

    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'IF OBJECT_ID(''' + REPLACE(@updateSPName,'''','''''') + ''',''P'') IS NOT NULL'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '   DROP PROCEDURE  ' + @updateSPName 
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'GO'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + ''
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + ''

    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'CREATE PROCEDURE ' + @updateSPName
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + '' + @ColumnParametersUpdate
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @strBegin
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @spaceForTrans+ 'UPDATE ' + @CurrentFullTableName 
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @spaceForTrans+ '   SET ' + @updCols
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @spaceForTrans+ ' ' + @whereCols
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @strEnd
    Set @strSPText = @strSPText + @SetVariablesForExec  + @SetVariablesForExecUpdate  
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'EXEC ' + @updateSPName + ' ' + @ColumnParametersUpdateForExec
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'SELECT * FROM ' + @CurrentFullTableName + ' '
    IF @UnCommentExecForDebug = 0 Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '*/'

    INSERT INTO @StatementList (FullTableName,StatementType,Statement) VALUES (@CurrentFullTableName,'Update',@strSPText)

    Set @strSPText = ''
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- ============================================='
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- Author : ' + SYSTEM_USER
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- Create date : ' + Convert(varchar(20),Getdate())
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- Description : Delete Procedure for ' + @CurrentTableName
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- ============================================='

    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'IF OBJECT_ID(''' + REPLACE(@deleteSPName,'''','''''') + ''',''P'') IS NOT NULL'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '   DROP PROCEDURE  ' + @deleteSPName 
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'GO'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + ''
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + ''

    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'CREATE PROCEDURE ' + @deleteSPName
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + '' + @ColumnParametersDelete
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @strBegin
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + 'DELETE FROM ' + @CurrentFullTableName
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + ' ' + @whereCols
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @strEnd
    Set @strSPText = @strSPText + @SetVariablesForExecDelete
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'EXEC ' + @deleteSPName + ' ' + @ColumnParametersDeleteForExec
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'GO'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'SELECT * FROM ' + @CurrentFullTableName + ' ORDER BY 1 DESC'
    IF @UnCommentExecForDebug = 0 Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '*/'

    INSERT INTO @StatementList (FullTableName,StatementType,Statement) VALUES (@CurrentFullTableName,'Delete',@strSPText)

    Set @strSPText = ''
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- ============================================='
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- Author : ' + SYSTEM_USER
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- Create date : ' + Convert(varchar(20),Getdate())
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- Description : List Procedure for ' + @CurrentFullTableName
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '-- ============================================='

    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'IF OBJECT_ID(''' + REPLACE(@listSPName,'''','''''') + ''',''P'') IS NOT NULL'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '   DROP PROCEDURE  ' + @listSPName 
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'GO'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + ''

    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'CREATE PROCEDURE ' + @listSPName
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + '' + @ColumnParametersList
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @strBegin
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space +'   DECLARE @Separator  nvarchar(20) =''
     WHERE '''
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space +'   DECLARE @SeparatorAnd  nvarchar(20) =''
       AND '''
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space +'   DECLARE @Statement nvarchar(max) =''SELECT * 
      FROM ' + REPLACE(@CurrentFullTableName,'''','''''') + '''' + @tableColumnForWhereInList

    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + ' --PRINT @Statement'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + ' BEGIN TRY'

    IF @GenerateDebugScriptForList=1
    BEGIN
      Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + '    IF 1=0--DEBUG --TODO: verify if not set for final version'
      Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + '      BEGIN'
      Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + '          DECLARE @FullQueryForDebug nvarchar(max)=' + @DebugVariablesForList
      Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + '            CHAR(13) +CHAR(10) + @Statement'
      Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + '  '
      Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + '         --PRINT @FullQueryForDebug'
      Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + '         --EXEC [K2FranceDebugDB].dbo.K2FranceDebug  ''@FullQueryForDebug DIRECT'', @FullQueryForDebug'
      Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + '         --EXEC loopbackServerForDebug.[K2FranceDebugDB].dbo.K2FranceDebug  ''@FullQueryForDebug loopback'', @FullQueryForDebug'
      Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + '      END'
    END
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + '     exec sp_executesql @Statement ,N''' + @tableColumnForWhereInListVariables + ''',' + @tableColumnForWhereInListAffectVariables
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + ' END TRY'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + ' BEGIN CATCH'

    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + '   DECLARE @ErrorToDisplay nvarchar(max)= ''Error trying to execute Query Error number:'' + CAST(ERROR_NUMBER() AS nvarchar(max)) + 
                        --'' Error severity:'' + ISNULL(CAST(ERROR_SEVERITY() AS nvarchar(max)),'''') + 
                        --'' Error state:'' + ISNULL(CAST(ERROR_STATE() AS nvarchar(max)),'''')  + 
                        --'' Error procedure:'' + ISNULL(CAST(ERROR_PROCEDURE() AS nvarchar(max)),'''')  + 
                        --'' Error line:'' + ISNULL(CAST(ERROR_LINE() AS nvarchar(max)),'''')  + 
                        '' Error message:'' + ISNULL(CAST(ERROR_MESSAGE() AS nvarchar(max)),'''')
'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + '   RAISERROR(@ErrorToDisplay, 16, 1);'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @space + @space  + @spaceForTrans + ' END CATCH'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + @strEnd
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'EXEC ' + @listSPName + ' ' + @ColumnParametersListForExec
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'GO'
    Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + 'SELECT * FROM ' + @CurrentFullTableName + ' ORDER BY 1'
    IF @UnCommentExecForDebug = 0 Set @strSPText = @strSPText + CHAR(13) + CHAR(10) + '*/'

    INSERT INTO @StatementList (FullTableName,StatementType,Statement) VALUES (@CurrentFullTableName,'List',@strSPText)

    Drop table #tmp_Structure   
    Fetch next from Tables_cursor INTO @CurrentSchemaName,@CurrentTableName
END
CLOSE Tables_cursor
DEALLOCATE Tables_cursor

SET @DropStatement = '

------------------------------------------- TO CLEAN COMPLETELY THE APPLICATION ---------------------------------------
/*' + @DropStatement +'
*/' 
INSERT INTO @StatementList (FullTableName,StatementType,Statement) VALUES ('Common','Drop statement to put at the end of final script',@DropStatement)

SELECT * FROM @StatementList
ORDER BY 1

END
GO

--For all tables of schema dbo of database "OlivierDb":
EXEC dbo.GenerateDynamicallyProceduresForTables 'OlivierDB','dbo'

--With all possible parameters:
EXEC dbo.GenerateDynamicallyProceduresForTables @DatabaseName               = 'OlivierDB',
                                                @SchemaName                 = 'dbo',
                                                @TableName                  = 'Table5',
                                                @NoCount                    = 1,
                                                @ManageTransaction          = 1,
                                                @GenerateDebugScriptForList = 1,
                                                @ParameterForUser           = '@UserInP',
                                                @ParameterForCulture        = '@CultureInP',
                                                @FirstParametersAreMandatory= 1,
                                                @ProcedureTemplateName      = '[{SchemaName}].[{TableName}_Proc_{ActionType}]',
                                                @ColumnNameLimitation       = '', --(syscolumns.name LIKE ''%Creation%'' OR syscolumns.name IN (''SomeInt'',''Somebit'') )
                                                @CreationUserMatch          = 'syscolumns.name LIKE ''%CreationUser%'' OR syscolumns.name LIKE ''%CreationBy%''',
                                                @CreationDateMatch          = 'syscolumns.name LIKE ''%CreationDate%'' OR syscolumns.name LIKE ''%CreatedDate%''',
                                                @ModificationUserMatch      = 'syscolumns.name LIKE ''%ModificationUser%'' OR syscolumns.name LIKE ''%ModifiedBy%''  OR syscolumns.name LIKE ''%ModifiedUser%''',
                                                @ModificationDateMatch      = 'syscolumns.name LIKE ''%ModificationDate%'' OR syscolumns.name LIKE ''%ModifiedDate%''' 
```

# php - 检查该值是否存在于另一个表中，然后插入

> ID：11673577
> 
> 赞同：0
> 
> 时间：2012-07-26T16:13:52.890
> 
> 标签：php, mysql, insert

我正在使用 PHP 中的表单将数据插入 MySQL，但在插入数据之前，有一个字段必须在插入之前在另一个表中检查。如果其他表中存在该值，则在主表中插入数据，如果不存在，则不插入数据。

这是我插入数据的代码：

```
$host = "localhost";
$username = "root";
$password = "";
$db_name = "forms";
$tbl_name = "table1";

mysql_connect("$host", "$username", "$password") or die("cannot connect");
mysql_select_db("$db_name") or die("cannot select DB");

$nombre = $_POST['nombre'];
$apellido = $_POST['apellido'];
$cedula = $_POST['cedula'];
$email = $_POST['email'];
$telefono = $_POST['telefono'];
$establecimiento = $_POST['establecimiento'];
$codigo = $_POST['codigo'];

$sql = " INSERT INTO $tbl_name(Nombre, Apellido, Cedula, Email, Telefono, Establecimiento, Codigo)VALUES('$nombre', '$apellido', '$cedula', '$email', '$telefono', '$establecimiento', '$codigo')";

$result = mysql_query($sql);

if ($result) {
    echo "Your data was sent";
} else {
    echo "You inserted a wrong code";
}

?>

<?php
// close connection 
mysql_close();
?> 
```

所以，我需要检查 table2 中的值 $codigo，如果存在，然后在 table1 中插入 $codigo 和其他值。这就是我卡住的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:22:39.040

只需使用您正在检查的数据对另一个表执行 SELECT 查询，然后如果 mysql_num_rows() > 0 则执行插入。像下面的东西

```
$query = "SELECT * FROM otherTable WHERE infoIsSame";
$result = mysql_query($query) or die(mysql_error());

if (mysql_num_rows($result) > 0) {
    $sql=" INSERT INTO $tbl_name(Nombre, Apellido, Cedula, Email, Telefono, Establecimiento, Codigo)VALUES('$nombre', '$apellido', '$cedula', '$email', '$telefono', '$establecimiento', '$codigo')";

    $result=mysql_query($sql);

    if($result){
        echo "Your data was sent";
    }else {
        echo "You inserted a wrong code";
    }
}else{
    echo "Not present in Other database";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:39:25.973

你真正需要做的就是这个。

```
// Check if Codigo already exists in table2
$codigo = mysql_real_escape_string($_POST['codigo']);
$result = mysql_query("SELECT Codigo FROM table2 WHERE Codigo = '$codigo'");

if (!mysql_num_rows($result)) {

    // Go ahead and insert everything in table1
    $data = array(
        'Nombre' => $_POST['Nombre'],
        'Apellido' => $_POST['apellido'],
        'Cedula' => $_POST['cedula'],
        'Email' => $_POST['email'],
        'Telefono' => $_POST['telefono'],
        'Establecimiento' => $_POST['establecimiento'],
        'Codigo' => $_POST['codigo']
    );

    // Make sure all the data is safe for entry into the database
    foreach ($data as $key => $val) {
        $data[$key] = "'" . mysql_real_escape_string($val) . "'";
    }

    $fields = implode(', ', array_keys($data));
    $values = implode(', ', array_values($data));

    $result = mysql_query("INSERT INTO table1 ($fields) VALUES ($values)");

    echo 'Your data was sent';

} else {
    echo 'Codigo already exists in table2';
} 
```

但请注意，有很多方法可以做得更好、更有效。一方面，我建议您使用 PHP 的 mysqli 函数而不是已弃用的 mysql 函数（http://www.php.net/manual/en/book.mysqli.php）

更重要的是，您看起来根本没有保护您的查询免受 SQL 注入攻击。请阅读此内容，但通常只需要 real_escape_string() 对您插入 SQL 查询的任何值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:39:38.093

一种方法是让 INSERT 语句为您进行检查：

```
INSERT INTO $tbl_name (Nombre, Apellido, Cedula, Email, Telefono, Establecimiento, Codigo)
SELECT '$nombre', '$apellido', '$cedula', '$email', '$telefono', '$establecimiento', '$codigo'
  FROM table2
 WHERE table2.Codigo = '$codigo'
 LIMIT 1 
```

然后检查插入的行数，`mysql_affected_rows()`以确定是否插入了行。对于您希望插入一行的“规范”情况，这减少了到数据库的往返次数。

* * *

**注意：**避免使用 mysql_ 函数并改用 mysqli_ 或 PDO。

# php - php（或更好的选择？）用于将回合数据发送到简单的 webapp 游戏

> ID：11673578
> 
> 赞同：0
> 
> 时间：2012-07-26T16:13:58.660
> 
> 标签：php, web-applications, backend, data-exchange

我有一个用 javascript 和 jQuery 编写的简单 2d 战略格斗游戏。用户在与怪物战斗时控制 3 或 4 个角色（此处为小屏幕截图[http://i.imgur.com/C0inB.jpg](http://i.imgur.com/C0inB.jpg)）。

它不是实时的，它是基于回合的（玩家回合，计算机回合），游戏是为手机用户设计的，主要是早上通勤的上班族。iPhone用户是主要目标。游戏开发处于早期阶段，但目前可玩。这是一个在浏览器中播放的网络应用程序。

我最大的问题是，如果您切换应用程序（例如接听电话）然后切换回页面重新加载（因此 Web 应用程序重新加载），您将失去任何进展。

我已经将此作为 Web 应用程序下载进行了测试（使用移动 Safari 添加到主屏幕），但切换时重新加载问题仍然存在。

我拒绝包装它并通过 Apple 应用程序商店交付......相反，我想创建一个可以节省玩家回合的后端。简单的任务，例如

*   我的网络应用程序中的 javascript 函数会以字符串的形式发送转弯数据
*   当网页（和网络应用程序）重新加载时，它会检索最后记录的回合
*   玩家需要登录

我对 PHP 很感兴趣，因为我在解构和更改 wordpress 主题方面有一些经验。我知道的唯一其他语言是前端（html、css、javascript、jQuery）。

PHP 能否以安全的方式完成上述任务，还是我应该考虑学习另一种语言？

非常感谢任何指导，并在此先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:16:16.353

是的。PHP 可以做你想做的事，就像任何其他服务器端语言一样。您只需使用 ajax 调用将数据更新发送到后端服务器。

# python - 使用多线程来最大程度地提高 CPU 效率

> ID：11673581
> 
> 赞同：1
> 
> 时间：2012-07-26T16:14:12.670
> 
> 标签：python, multithreading, cpu

我目前正在使用 Python，我的程序如下所示：

```
function(1)
function(2)
...
function(100) 
```

在 100% CPU 下执行一个函数需要大约 30 分钟，因此执行程序需要很多时间。这些函数访问相同的文件进行输入，进行大量数学运算并打印结果。

引入多线程会减少程序完成所需的时间（我正在使用多核机器）吗？如果是这样，我应该使用多少个线程？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:18:15.877

这取决于。

如果没有一个函数完全相互依赖，您当然可以在单独的线程上运行它们（甚至使用`multiprocessing`, 以避免全局解释器锁定的进程）。您可以每个核心运行一个进程，也可以运行 100 个进程，或者介于两者之间的任意数量，具体取决于系统的资源限制。（如果您不拥有系统，一些管理员不喜欢向进程表发送垃圾邮件的用户。）

如果函数必须一个接一个地运行，那么你不能这样做。您必须重组程序以尝试隔离独立任务，或者接受您可能遇到 P 完全（本质上难以并行化）问题并继续前进。

# c# - LINQ选择不同的c#

> ID：11673584
> 
> 赞同：6
> 
> 时间：2012-07-26T16:14:24.023
> 
> 标签：c#, linq-to-sql

我正在尝试做一个不包含重复`IdUser`值的查询，但不起作用。

**这是我的 linq 查询：**

```
var sql= (from u in db.USER
          join c in db.CONSULT on u.IdUser equals c.IdUser 
          select new UsuersViewModel 
                 {  
                    IdUser = c.IdUser, 
                    DateCreate=c.DateCreate, 
                    IdTypeConsult = c.IdTypeConsult, 
                    Sex=u.Sex 
                 })
                 .Distinct(); 
```

**我要这个：**

```
SELECT   distinct CONSULT.IdUser , CONSULT.DateCreate, 
         CONSULT.IdTypeConsult , USER.Sex
FROM   CONSULT INNER JOIN
       USER ON CONSULT.IdUser = USER.IdUser 
```

**查询给出重复的记录**

为什么它不起作用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T16:27:00.287

我认为您想使用`Distinct(IEqualityComparer<T>)`重载。你需要创建一个`IEqualityComparer`来做你想做的事：

```
class UserComparer : IEqualityComparer<UsuersViewModel >
{
    public bool Equals(UsuersViewModel  x, UsuersViewModel y)
    {
        //Check whether the compared objects reference the same data.
        if (Object.ReferenceEquals(x, y)) return true;

        //Check whether any of the compared objects is null.
        if (Object.ReferenceEquals(x, null) || Object.ReferenceEquals(y, null))
            return false;

        return x.IdUser == y.IdUser;
    }

    // If Equals() returns true for a pair of objects 
    // then GetHashCode() must return the same value for these objects.

    public int GetHashCode(UsuersViewModel  user)
    {
        //Check whether the object is null
        if (Object.ReferenceEquals(user, null)) return 0;

        return user.IdUser == null ? 0 : user.IdUser.GetHashCode();
    }
} 
```

然后像这样使用它：

```
var comparer = new UserComparer();
var sql= (from u in db.USER
          join c in db.CONSULT on u.IdUser equals c.IdUser 
          select new UsuersViewModel 
                 {  
                    IdUser = c.IdUser, 
                    DateCreate=c.DateCreate, 
                    IdTypeConsult = c.IdTypeConsult, 
                    Sex=u.Sex 
                 })
                 .Distinct(comparer); 
```

我不确定这是否会生成您想要的 SQL，但可能会得到您想要的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T16:24:46.127

在比较类实例（与匿名类型）时，您需要定义“平等”。对于匿名类型，编译器假定相等意味着“所有字段都相等”，就像 SQL 一样。所以你有几个选择：

1.  在查询中使用匿名类型，使用`.Distinct()`，然后转换为强类型，
2.  定义一个`IEqualityComparer<Usuers>`类并将其传递给`Distinct`,
3.  覆盖`Equals`（和`GetHashCode`）`Usuers`

2) 和 3) 将是非常相似的代码。2）更灵活（您可以通过定义不同的类以不同的方式定义相等，而 3）将在您比较`Uusers`实例时使用（不仅在此查询中）。

[在此处](https://stackoverflow.com/questions/11635568/how-to-i-get-this-linq-full-outer-join-to-function-properly/11636322#11636322)查看我对类似问题的回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-14T13:06:10.153

注意：以下可以在 LinqPad 中运行（在[http://www.linqpad.net/](http://www.linqpad.net/)免费） - 只需将 Language 下拉菜单设置为“C# Program”并将代码粘贴到编辑器窗口中。

您可以使用“组”来提供您的独特要求，如下所示：

```
void Main()
{
    var db = new DataBase();
    var sql= (from u in db.USER
          join c in db.CONSULT on u.IdUser equals c.IdUser 
          group c by new { c.IdUser, c.DateCreate, c.IdTypeConsult, u.Sex } into gc
          select new UsuersViewModel 
                 {  
                    IdUser = gc.Key.IdUser, 
                    DateCreate=gc.Key.DateCreate, 
                    IdTypeConsult = gc.Key.IdTypeConsult, 
                    Sex=gc.Key.Sex 
                 })
                 .Distinct();
    sql.Dump("SQL Distinct Demo");
}
public class Consultation {
    public int  IdUser {get;set;}
    public DateTime DateCreate {get;set;}
    public int IdTypeConsult {get;set;}
}
public class UsuersViewModel : Consultation {
    public string Sex {get;set;}
}
public class DataBase {
    public IEnumerable<Consultation> CONSULT {
        get { 
            return new List<Consultation>{
                new Consultation { IdUser = 1, DateCreate=DateTime.Today, IdTypeConsult = 2},
                new Consultation { IdUser = 2, DateCreate=DateTime.Today.AddDays(1), IdTypeConsult = 4}
            };
        }}
    public IEnumerable<UsuersViewModel> USER {
        get {
            return new List<UsuersViewModel>{
                new UsuersViewModel { IdUser = 1, Sex="M"},
                new UsuersViewModel { IdUser = 1, Sex="M"},
                new UsuersViewModel { IdUser = 2, Sex="F"},
                new UsuersViewModel { IdUser = 2, Sex="F"}
            };
        }}
} 
```

![结果如下：](../Images/29ae2f90b83aa78ee93514c3d7dc460b.png)

# python - 仅使用新目录更新目录列表

> ID：11673585
> 
> 赞同：1
> 
> 时间：2012-07-26T16:14:26.553
> 
> 标签：python

我正在使用下面的代码递归地创建所有目录的列表（文本文件）。由于有数千个子目录，我不想一次又一次地创建列表，但只想更新/插入上次列出它们时新创建的子目录。

有没有好的方法来做到这一点？

```
import os, sys
rootdir ="/store/user/"
myusers=['u1','u2','u3','u4','u5','u6','u7']

for myuser in myusers:
    rootuserdir=os.path.join(rootdir, myuser)
    for myRoot, mySubFolders, myFiles in os.walk(rootuserdir):
        for mySubFolder in mySubFolders:
            dirpath =  os.path.join(myRoot, mySubFolder)
            print dirpath 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:17:54.213

您不会通过尝试增量更新文件夹列表来保存任何内容。没有有效的方法可以从文件中间删除一行，也没有插入一行。简单地再次编写整个列表是最有效的方法，也是最简单的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:19:01.217

尝试定位文件中的特定条目将比每次重新填充列表更耗费资源。

对于性能优化，请始终尝试确定真正的瓶颈在哪里，然后再专注于一个特定领域。如果不采用这种方法，您的注意力将集中在错误的地方。

确定瓶颈或热点应该始终是重构代码时的首要关注领域之一。通过这样做，您将确保您专注于具有最高 ROI 和最少 LOE 的区域。一个经验法则是，如果您可以使整个程序或至少其中的重要部分至少快一倍，您应该只尝试重构代码。[更多的...](http://robzu.com/how-to-be-a-programmer/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:33:30.533

您可以运行一次性进程将信息缓存在某种数据库中（为简单起见，可能是面向文档的数据库），然后在守护进程中使用 pyinotify 以保持数据库同步。

# javascript - 您将如何创建 JQuery / svg 单击拖动选择轮廓效果？

> ID：11673591
> 
> 赞同：6
> 
> 时间：2012-07-26T16:15:06.367
> 
> 标签：javascript, jquery, svg, frontend

不知道到底该怎么称呼它，但我正在寻找一种方法来通过 javascript/svg 创建虚线轮廓/选择框效果，当您单击并拖动一个区域时，然后在 mouseUp 上消失（如果它可以添加不是原始部分）。

一个 jQuery 库如果存在就更好了。我做了一些环顾四周，并没有找到我正在寻找的东西。
我猜理论是从第一次点击中获取坐标，跟踪鼠标坐标时刻并相应地调整框。

但是不要从头开始写它会很好。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-26T17:29:39.307

这是我为您制作的演示 :)

## 演示（静态）：http: [//jsfiddle.net/HNH2f/1/](http://jsfiddle.net/HNH2f/1/)

## 演示（动画）：http: [//jsfiddle.net/HNH2f/2/](http://jsfiddle.net/HNH2f/2/)

您可以使用 CSS 来控制选取框的视觉样式。您可以将一两个函数传递给该`trackMarquee`方法；两者都将使用四个参数调用：选取框的 x1,y1,x2,y2 边界。释放选取框时将调用第一个函数。每次选取框移动时都会调用第二个函数（如果存在）（例如，您可以计算该边界框中的项目）。

当您开始拖动 SVG 文档（或您选择跟踪的任何元素）时，它将创建一个`<rect class="marquee" />`; 在拖动过程中，它将调整矩形的大小。使用 CSS（如演示中所示）为这个矩形设置任何你想要的样式。我正在使用该[`stroke-dasharray`](http://www.w3.org/TR/SVG/painting.html#StrokeDasharrayProperty)属性使边框点缀。

对于 Stack Overflow 的后代，这是代码（如果 JSFiddle 出现故障）：

```
(function createMarquee(global){
  var svgNS = 'http://www.w3.org/2000/svg',
      svg   = document.createElementNS(svgNS,'svg'),
      pt    = svg.createSVGPoint();

  // Usage: trackMarquee( mySVG, function(x1,y1,x2,y2){}, function(x1,y1,x2,y2){} );
  // The first function (if present) will be called when the marquee is released
  // The second function (if present) will be called as the marquee is changed
  // Use the CSS selector `rect.marquee` to select the marquee for visual styling
  global.trackMarquee = function(forElement,onRelease,onDrag){
    forElement.addEventListener('mousedown',function(evt){
      var point0 = getLocalCoordinatesFromMouseEvent(forElement,evt);
      var marquee = document.createElementNS(svgNS,'rect');
      marquee.setAttribute('class','marquee');
      updateMarquee(marquee,point0,point0);
      forElement.appendChild(marquee);
      document.documentElement.addEventListener('mousemove',trackMouseMove,false);
      document.documentElement.addEventListener('mouseup',stopTrackingMove,false);
      function trackMouseMove(evt){
        var point1 = getLocalCoordinatesFromMouseEvent(forElement,evt);
        updateMarquee(marquee,point0,point1);
        if (onDrag) callWithBBox(onDrag,marquee);
      }
      function stopTrackingMove(){
        document.documentElement.removeEventListener('mousemove',trackMouseMove,false);
        document.documentElement.removeEventListener('mouseup',stopTrackingMove,false);
        forElement.removeChild(marquee);
        if (onRelease) callWithBBox(onRelease,marquee);
      }
    },false);
  };

  function callWithBBox(func,rect){
    var x = rect.getAttribute('x')*1,
        y = rect.getAttribute('y')*1,
        w = rect.getAttribute('width')*1,
        h = rect.getAttribute('height')*1;
    func(x,y,x+w,y+h);
  }

  function updateMarquee(rect,p0,p1){
    var xs = [p0.x,p1.x].sort(sortByNumber),
        ys = [p0.y,p1.y].sort(sortByNumber);
    rect.setAttribute('x',xs[0]);
    rect.setAttribute('y',ys[0]);
    rect.setAttribute('width', xs[1]-xs[0]);
    rect.setAttribute('height',ys[1]-ys[0]);
  }

  function getLocalCoordinatesFromMouseEvent(el,evt){
    pt.x = evt.clientX; pt.y = evt.clientY;
    return pt.matrixTransform(el.getScreenCTM().inverse());
  }

  function sortByNumber(a,b){ return a-b }
})(window); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T16:54:03.743

你很幸运，这是我自己做的。我正在使用 jQuery SVG 插件（[http://keith-wood.name/svg.html](http://keith-wood.name/svg.html)）

```
$("#paper2").mousedown(function(ev) {
    ev.preventDefault(); 
    var pX= (ev.pageX - this.offsetLeft) * viewBox[2]/parseInt($("#paper2").css("width"));
    var pY= (ev.pageY - this.offsetTop)  * viewBox[3]/parseInt($("#paper2").css("height"));
    var rect = svg2.rect(
        pX, //X
        pY, //Y 
        1,1, //width and height
        { //Settings, you can make the box dotted here
            fill: 'black', "fill-opacity": 0.3, stroke: 'red', strokeWidth: 3, id:rect
        }
    )

    $("#paper2").mousemove(function(ev) {
        ev.preventDefault();
        var rect= $('#rect');
        var pX= (ev.pageX - this.offsetLeft) * viewBox[2]/parseInt($("#paper2").css("width")) - rect.attr("x");
        var pY= (ev.pageY - this.offsetTop)  * viewBox[3]/parseInt($("#paper2").css("height")) - rect.attr("y");
        rect.attr("width", pX);
        rect.attr("height", pY);
    });

    $("#paper2").mouseup(function(ev) {
        ev.preventDefault();
        var div= $("#paper2");
        div.unbind('mousemove');
        div.unbind('mouseup');
    })
}); 
```

paper2 是一个 div，其中我有一个 svg 元素（因此 svg 元素和 div 具有相同的高度/宽度）。这就是我创建 svg2 元素的方式：

```
var svg2;
var root2;
$(document).ready(function() {
    $("#paper2").svg({
        onLoad: function() {
            svg2= $("#paper2").svg('get');
            svg2.configure({id: 'svg2'});
            var div= $("#paper2");
            root2= svg2.root();
            $("#svg2").attr("viewBox", viewBox[0]+','+viewBox[1]+','+viewBox[2]+','+viewBox[3]);    
        },
        settings: {}
    });
} 
```

如果您不在 svg 元素上使用 viewbox，则在计算中不需要它：

```
 * viewBox[2]/parseInt($("#paper2").css("*****")); 
```

viewbox[2] 是 viewbox 的宽度， viewbox[3] 是 viewbox 的高度。

# knockout.js - 订阅可观察对象以更新视图模型

> ID：11673592
> 
> 赞同：3
> 
> 时间：2012-07-26T16:15:18.173
> 
> 标签：knockout.js, refresh, viewmodel

[http://jsfiddle.net/tim3046/jtmY3/2/](http://jsfiddle.net/tim3046/jtmY3/2/)

* * *

我让 observables 部分工作，因为它更新了顶部 par 字符串。

这就是我订阅的内容，所以我想知道这部分是否有问题，因为当我添加一个高尔夫球手时，它具有当前选择的球场标准杆。（即）我可以在一个球场上拥有 2 个高尔夫球手，在另一个球场上拥有 3 个高尔夫球手，因此当按下单选按钮时，它唯一要做的就是更改要添加的下一个高尔夫球手的标准杆。

```
self.site.subscribe(function (newValue) {
    var len = self.golfers().length;
    for (var i = 0; i < len; i++) {
        self.golfers()[i].par(self.availableCourses()[self.site()].courseP);
    }
}); 
```

这是我有可用课程的地方

```
self.availableCourses = ko.observableArray([
        { name: ko.observable("Fort Cherry Golf Club"),
            courseP: [ko.observable(4), ko.observable(4), ko.observable(4), ko.observable(5), ko.observable(3), ko.observable(4),
            ko.observable(4), ko.observable(4), ko.observable(4), ko.observable(4), ko.observable(4), ko.observable(3), ko.observable(4),
            ko.observable(5), ko.observable(4), ko.observable(3), ko.observable(4), ko.observable(4)]
        },
        { name: ko.observable("Lake View Golf Course"),
            courseP: [ko.observable(4), ko.observable(4), ko.observable(4), ko.observable(3), ko.observable(5), ko.observable(4),
            ko.observable(5), ko.observable(3), ko.observable(4), ko.observable(4), ko.observable(4), ko.observable(3), ko.observable(4),
            ko.observable(5), ko.observable(4), ko.observable(3), ko.observable(4), ko.observable(5)]
        }
            ]); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-26T17:40:46.177

通过淘汰赛，您可以在视图模型中创建 observables 来表示 UI 的状态。然后，如果需要，您可以订阅这些 observables 中的更改。[请参阅关于 observables 的 KO 页面](http://knockoutjs.com/documentation/observables.html)的最底部。

我设置了一个简单的 fiddle 来演示在 observables 上使用 subscribe 函数的基础知识：

[http://jsfiddle.net/YRscs/1/](http://jsfiddle.net/YRscs/1/)

# java - 在此字符串操作期间将创建多少个对象？

> ID：11673596
> 
> 赞同：3
> 
> 时间：2012-07-26T16:15:34.963
> 
> 标签：java

下面是实例方法中的代码片段

```
 String x = new StringBuffer().append("a").append("b").append("c").toString() 
```

我的印象是，首先创建新的字符串缓冲区，然后将 a 添加到字符串缓冲区的最后，类似于 b 和 c。在该字符串缓冲区转换为字符串之后。因此，据我所知，创建了 2 个对象（一个用于字符串缓冲区，另一个用于字符串）。正确的？基本上按照我的说法，不会为字符串“a”、“b”、“c”创建中间对象。这是正确的吗？

**编辑：-根据所有回复，看起来将为字符串文字“a”，“b”，“c”创建对象但是如果我通过链接[http://docs.oracle.com/javase/1.4。 2/docs/api/java/lang/StringBuffer.html#toString](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/StringBuffer.html#toString) ()，这不应该创建临时字符串。搜索“总体而言，这避免了创建许多临时字符串。” 在这个链接上。同意它适用于 1.4.2，但我希望 1.6 的基本面保持不变**

是的，如果我在下面而不是在上面创建五个对象。三个代表 "a","b","c" 。一个用于字符串缓冲区。最后是从字符串缓冲区转换的字符串。"a","b","c" 的对象和最后的字符串 "abc" 将进入池中并且终生存在

```
String str1="a";
String str2="b";
String str3="c";
String x = new StringBuffer().append(str1).append(str2).append(str3).toString() 
```

**以上理解正确吗？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:19:50.730

在创建对象的数量方面，您的第一个和第二个片段之间没有区别。字符串`"a"`、`"b"`和`"c"`将参与该过程，尽管可以使用它们的内部副本*。*在没有进一步引用的情况下`str1..str3`，编译器可以自由地将您的第二个片段转换为您的第一个片段，从而消除变量。

此外，如果其内部字符串中的内存不足以容纳正在附加的数据，则`StringBuffer`'s内部可能存在内部重新分配。`append`这只是理论上的可能性，但它确实存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:26:14.313

正如其他答案中所指出的，您的两个片段是等效的（关于 String 对象创建）。相反，如果第二个片段被写成：

```
String str1= new String("a");
... 
```

只有在这种情况下，您才能保证实例化一个新的 String 对象（不是您通常想要的）。另请参见[此处](https://stackoverflow.com/questions/3297867/difference-between-string-object-and-string-literal)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T16:28:09.120

字符串“a”、“b”、“c”是两个代码片段中的文字。它们将在您的代码执行之前由类加载器创建，并且没有办法（通常也没有必要）避免这种情况。

所以这两个代码片段本质上都是一样的，并且它们都创建了相同数量的对象。

而且，顺便说一句，这两个片段都不是有效代码 - 您不能像在两个片段中的最后一条语句中那样分配 StringBuffer = String 。

编辑：您还询问Java版本> 1.4。从 Java5 开始，StringBuffer 应该被 StringBuilder 替换（它本质上是完全一样的，但它不是同步的，因此它的性能要好一些）。

# c - 编写驱动程序来欺骗 Linux 系统关于拥有 GPU

> ID：11673597
> 
> 赞同：1
> 
> 时间：2012-07-26T16:15:37.523
> 
> 标签：c, linux, driver, x11

我正在为基于 Linux 的系统编写“模拟 GPU 驱动程序”。我的意思是，我只是想编写一个驱动程序（显然是在 X-server 之后）用一些调试消息来回答 X 的 API 调用。

换句话说，我想欺骗 Linux 关于拥有一个真正的 GPU。所以我可以为基于控制台的系统中的 GUI 加速包创建一个测试平台。

现在，如果我在基于 Linux 控制台的系统中执行 GUI 加速包；由于缺少真正的 GPU（或者我会说更好的 GPU 驱动程序），它只会死掉。

**所以我想知道：**

*   甚至可能吗？（编写一个 GPU 驱动程序来欺骗 Linux 关于拥有一个实际的 GPU）
*   在开始编写代码之前，您推荐哪些资源？
*   网上有没有类似的项目？

PS：我是一位经验丰富的 ANSI-C 程序员，但我对 *nix 下的真正内核/驱动程序开发一无所知（尽管阅读一些有关 USB 驱动程序开发的教程），因此有关这些领域的任何资源都将非常感激好。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T19:43:31.893

您正在寻找的实际上是 Xorg 服务器套件的一部分，它被称为[Xvfb](http://www.manpagez.com/man/1/Xvfb/)（虚拟帧缓冲区）。

如果你不怕有点复杂的 bash，你可以看看 Gentoo 的[virtualx.eclass](http://sources.gentoo.org/cgi-bin/viewvc.cgi/gentoo-x86/eclass/virtualx.eclass?view=markup#l96)的使用示例（我们用它来运行需要 X11 的测试）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T16:19:13.773

Mesa 项目是一个很好的起点——它在软件中实现了 OpenGL。它有办法诱使操作系统认为它是 OpenGL 驱动程序。

# ruby-on-rails - Rake 任务破坏了我的 Ruby... 糟糕的 Rake 任务

> ID：11673603
> 
> 赞同：0
> 
> 时间：2012-07-26T16:15:57.187
> 
> 标签：ruby-on-rails, ruby, rake, rvm

我正在尝试在本地运行 rake 任务，但遇到了一个奇怪的错误。

```
$ rake alert_notification  --trace
** Invoke alert_notification (first_time)
** Invoke environment (first_time)
** Execute environment
** Execute alert_notification
/Users/bendowney/.rvm/gems/ruby-1.9.3-p194@global/bin/rake(65399,0x7fff73799960) malloc: *** error for object 0x8: pointer being freed was not allocated
*** set a breakpoint in malloc_error_break to debug
Abort trap: 6 
```

奇怪的是，我没有使用给定的 gemset (@globaL)。当我运行 $ rvm gemset list

它显示了正确的宝石组。

据我所知，这不会影响我的 Rails 应用程序的其余部分的工作方式。虽然我并不完全确定。

以及有关如何解决此问题的建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:22:45.730

只是猜测，看起来你在 OSX 上用 clang 编译了 ruby​​，有两种方法可以为 ruby​​ 获得正确的编译器：osx-gcc-installer 和：

```
rvm get head
rvm requirements # read the part on homebrew apple gcc42 
```

获得正确的编译器后，您需要重新安装 ruby​​：

```
rvm reinstall 1.9.3 
```

至于`@global`gemset - 它被给定 ruby​​ 中的所有 gemset 继承，包括默认 gemset（没有任何`@...`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T11:33:44.197

不知何故，在我们编写 rake 任务的过程中，这个问题已经完全消失了。所以我猜这篇文章的答案是“编写有效的 rake 任务”。

# javascript - Ember.js Handlebars 绑定逻辑不

> ID：11673607
> 
> 赞同：2
> 
> 时间：2012-07-26T16:16:01.307
> 
> 标签：javascript, ember.js

**与 Ember.js 的车把绑定是否合乎逻辑？**

假设我有一个想要绑定到值的 ember 视图

```
{{Ember.Button disabledBinding="view.controller.some_value"}} 
```

`some_value`如果是，我只希望禁用该按钮`false`。上面的代码使它禁用 if `some_value`is `true`。

解决此问题的一种方法是在控制器上具有互补的计算值。*原谅我的咖啡稿*

```
opposite_some_value: (->
    if @get('some_value') == true
        return false
    else
        return true
).property 'some_value' 
```

但这似乎很笨拙。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-26T16:39:33.740

创建具有反转值的属性是要走的路。您可以为此使用绑定助手：`oppositeValueBinding: Ember.Binding.not('some_value')`.

另请注意，`Ember.Button`不推荐使用，您应该改用`{{action}}`帮助程序。

**更新**

在较新版本的 Ember.js 中，它是`oppositeValue: Ember.computed.not('some_value')`.

# javascript - 调整滚动div的高度

> ID：11673608
> 
> 赞同：0
> 
> 时间：2012-07-26T16:16:06.160
> 
> 标签：javascript, jquery, mcustomscrollbar

我将两个脚本组合在一起：一个滚动条和一个内容推子。当我交换内容（淡入淡出）时，具有大量内容的 div 会使滚动 div 超长。我正在阅读内容滚动的插件演示（[http://manos.malihu.gr/jquery-custom-content-scroller](http://manos.malihu.gr/jquery-custom-content-scroller)），您可以`$(selector).mCustomScrollbar("update");`在加载不同的内容时使用它来相应地调整 div。

我知道代码需要在我的褪色脚本中的某个地方，但是在哪里？这是褪色脚本，它会去哪里？

```
<script type='text/javascript'>//<![CDATA[ 
$(window).load(function(){
(function($) {
    $.fn.Fader = function() {
        this.each(function() {
            $('.clickme').bind('click', function(e) {
                e.preventDefault();
                $( "#mediaswap div" ).fadeOut();
                $( "#mediaswap div" + $(this).attr('name') ).fadeIn();
            })
        });
    }
})(jQuery);

$(function() {
    $('#mediaswap').Fader();
});
});//]]>  

</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T17:05:28.343

我已经回答了你对帖子的评论，但我也在这里写。

由于您淡入/淡出 div，您必须调用 update 方法作为 .fadeIn() 函数的回调，因此它会在动画完成后更新滚动条：

```
$( "#mediaswap div" + $(this).attr('name') ).fadeIn(function(){
    $(this).mCustomScrollbar("update");
}); 
```

此外，当您最初调用插件时，您可以使用一个额外的选项参数，它会检查内容大小并在滚动条发生变化时自动更新：

```
$("#mediaswap div").mCustomScrollbar({
    advanced:{ updateOnContentResize:true }
}); 
```

使用 updateOnContentResize 选项取决于您的其余代码（调用插件的位置），因此我建议使用第一种方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:57:44.470

我建议检查 div 以查看它是否使用类似这样的动画：

```
var wait = setInterval(function() {
        if( !$("#mediaswap div").is(":animated")) 
        {
                clearInterval(wait);
                //put the code in here because it checks 
                  for whether the DIV is currently animated.
            }
        }, 200); 
```

如果动画完成动画需要更长的时间，您可以更改间隔。

# javascript - 使用javascript在两个地方绘制单个DOM元素

> ID：11673609
> 
> 赞同：2
> 
> 时间：2012-07-26T16:16:06.237
> 
> 标签：javascript, jquery, html, jquery-ui

我正在使用 jQueryUI 创建一个大的可排序卡片表，每个卡片都由一个嵌套 div 标签的大树组成，并使用 CSS 进行样式设置。当我在某些条件下拖动卡片时，我想创建一个稍微透明的卡片“克隆”，在拖动时悬停在“真实”卡片的右侧，但我不想实际复制所有 HTML为了完成这个视觉效果。

那么，是否可以使用 javascript 在网页上的两个不同位置绘制相同的 DOM 元素，而无需实际复制 HTML？

感谢任何回答的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:23:57.517

每个 DOM 元素要么根本不连接到 DOM，要么连接到一个特定的父级。您不能在两个不同的地方显示相同的元素。附加到新的父级只会从旧的元素中移动元素。

您可以使用[`cloneNode`](https://developer.mozilla.org/en/DOM/Node.cloneNode)（注意将新的事件处理程序附加到它，因为它们没有被克隆）或在 JS 工厂生成一些“模板”元素并将它们中的每一个附加到不同的父级。

# c# - asp.net中字段的访问名称属性

> ID：11673613
> 
> 赞同：0
> 
> 时间：2012-07-26T16:16:17.707
> 
> 标签：c#, jquery, asp.net, jquery-validate

如何访问 asp.net 中字段的名称属性，我使用了 UniqueID 并且能够获取属性的名称，但是我将表单拆分为两个不同的 asp 控件，我无法使用访问字段名称属性其他控件上的 UniqueID。

例如..我在一个控件中有名字，姓氏，在另一个控件中有信用卡详细信息，我正在使用 jquery 验证插件进行验证，它根据字段的名称属性进行验证。我在一个控件中编写了验证，我使用下面的代码来获取名称属性

```
 <%=txtFNameRoom.UniqueID%> 
```

如果我将 javascript 放在此控件中，则此验证有效，我无法访问其他控件上的信用卡字段的名称属性。我不能将验证分成两部分，因为我们只能初始化 .validate() 方法一次。任何人都知道如何获取字段的名称属性，即使它们位于不同的控件中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:38:48.017

也许有更好的方法，但这应该有效：

在您的其他控件中，公开一个属性：

```
public string[] FieldsToValidate 
{
    get
    {
        return new[]{ txtCreditCardNumber.UniqueID, txtFNameRoom.UniqueID .. etc };
    }  
} 
```

然后，在第一个控件中，您可以访问该属性：

```
<% foreach(var id in ControlId.FieldsToValidate) { %>
    // <script... etc
    <%= id %>

<% } %> 
....
<uc1:TestControl ID="ControlId" runat="server" /> 
```

# windows - 确定 Windows 服务的启动方式

> ID：11673622
> 
> 赞同：1
> 
> 时间：2012-07-26T16:16:48.207
> 
> 标签：windows, service

我有一个启动类型 = 自动的 Windows 服务，以便该服务在启动时启动。如果用户明确停止我的服务并重新启动它（或我产品的某些其他组件明确停止我的服务并重新启动它），我需要知道这一点并在服务中表现不同。

是否有 API 来检测“此服务是由 Windows 在启动时自动启动的”与“此服务是手动启动的”？我在 MSDN 上找不到。

提前致谢！

# awk - 如何使用awk将行转换为列？

> ID：11673626
> 
> 赞同：3
> 
> 时间：2012-07-26T16:17:04.387
> 
> 标签：awk

我有一个包含 36 行的输入，如下所示：

```
822
526006
1343315205
1.4.2
32
0.000000
13.048815
...
0
0
0 
```

那是 memcache stats 命令的输出。所以它不是来自文件。如何将这些行转换为单行的列。我不想使用临时文件。

谢谢，

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-26T16:19:08.483

试试这个：

```
awk '{printf("%s ", $0)}' 
```

使用管道：

```
whatever_your_command | awk '{printf("%s ", $0)}' 
```

使用的好处`printf()`是它可以让您完全控制数据的输出格式/间距/等。

--

*测试*

```
822
526006
1343315205
1.4.2
32
0.000000
13.048815 
```

文件中的数据`data.txt`：

```
awk '{printf("%s ", $0)}' data.txt 
```

产量：

```
822 526006 1343315205 1.4.2 32 0.000000 13.048815 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-26T16:22:15.080

您可以在没有 awk 的情况下执行此操作：

```
tr '\n' ' ' < file
echo $(<file)
xargs echo < file
perl -pe 's/\n/ /' < file 
```

例子：

```
$ tr '\n' ' ' < data.txt
822 526006 1343315205 1.4.2 32 0.000000 13.048815
$ echo $(<data.txt)
822 526006 1343315205 1.4.2 32 0.000000 13.048815
$ xargs echo < data.txt
822 526006 1343315205 1.4.2 32 0.000000 13.048815
$ perl -pe 's/\n/ /' < data.txt
822 526006 1343315205 1.4.2 32 0.000000 13.048815 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-20T09:19:11.553

```
anuj@test:~$ cat num
1
2
3
4
5
anuj@test:~$ cat num |xargs
1 2 3 4 5
anuj@test:~$ 
```

我猜 cat 和 xargs 绰绰有余

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-26T18:18:47.113

可以是单字符`awk`程序

```
seq 10 | awk -v ORS=" " 1 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-26T16:25:00.963

使用`sed`

```
input | sed ':a;N;{s/\n/ /};ba' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-14T00:09:03.333

在 bash 中，您可以使用类似的东西。

```
input="822
526006
1343315205
1.4.2
32
0.000000
13.048815" 
```

然后使用一个简单的 for 循环。

```
for row in $(echo "$input");do echo -en "$row ";done;echo 
```

输出

```
822 526006 1343315205 1.4.2 32 0.000000 13.048815 
```

请注意，最后一个回显是为了避免您的提示出现在同一行，如果您在脚本中相应地使用它，请删除。

# asp.net-mvc-3 - 内容不会滚动页脚和页眉固定

> ID：11673628
> 
> 赞同：0
> 
> 时间：2012-07-26T16:17:08.717
> 
> 标签：asp.net-mvc-3, jquery-mobile

我已将页眉和页脚都设置为固定，但仍然无法在 iPhone 中调整内容。

![在此处输入图像描述](../Images/dea6df2144d6234b6c64f8b48cd97646.png)

这是我的布局代码

```
<body>  
    <div data-role="page"  @(Page.Id == null ? string.Empty : "id=" + Page.Id) data-fullscreen="false">
     @*    @RenderSection("MoreCode", false)*@

      @if (IsSectionDefined("Header"))
      { 
        <div data-role="header" data-position="fixed">

         @RenderSection("Header", false)

        </div><!-- /header -->
      }

     <div data-role="content">  
         @RenderBody()        

     </div><!-- /content -->

       <div data-role="footer" data-tap-toggle="false" data-position="fixed">

   <div class="center-wrapper">
        <table border="0">
        <tr>
        <td>
        <label for="basic">
        Place Of Interest
        </label>
        </td>
        </tr>
        <tr>
        <td>
        <table border="0">
        <tr>
        <td>
          <a href="@Url.Action("TermsOfUse", "Home")" data-mini="true">Terms of Use</a>
        </td>
        <td>
        <label for="basic">
        |
        </label>
        </td>
         <td>
          <a href="@Url.Action("PrivacyPolicy", "Home")" data-mini="true">Privacy Policy</a>
        </td>
        </tr>     
        </table>
        </td>
        </tr>    
        </table>      
        </div>
        </div>
</body> 
```

这是我的看法

```
<h3 style='color:#4FA600; font-weight:bold;'>@ViewBag.Number</h3>

<table border="1" width="100%">
<tr>
<td align="center" valign=middle style=' font-weight:bold; color:#FFFFFF; background:#4FA600; '>
<label for="basic">Available Documents</label>
</td>
</tr>

<tr>
<td>
<table width="100%" height="100%">
<tr>
<td align="left" valign="middle" style=' font-weight:bold;'>
Type
</td>
<td align="center" valign="middle" style=' font-weight:bold;'>
Description
</td>

</tr>
@{
    foreach(var row in Model)
    {       

        <tr>
        <td align="left" valign="middle">
        @row.DocType
        </td>

        <td align="center" valign="middle">
        <a href="#" target="_blank"  class="my-btn">@row.Description</a>
        </td>
        </tr>

    }

    }  
</table>
</td>
</tr>
</table> 
```

jquerymobile 不应该手动调整吗？它在firefox中渲染得很好。我该怎么做才能使内容充分显示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T15:02:47.397

\问题是我的css中有这个：

```
[data-role=page]{height: 100% !important; position:relative !important;} 
```

我从使用主题滚轮那里得到了这段代码，不知道为什么会搞砸。也许有人可以澄清将不胜感激

# html - 居中，不向下移动..不确定为什么/如何解决

> ID：11673629
> 
> 赞同：0
> 
> 时间：2012-07-26T16:17:10.200
> 
> 标签：html, css, css-float, margin, padding

`<nav>`应与徽标和标语下方的左侧对齐。但是，尽管尝试对两者都这样做，但`margin`它`padding`仍然位于徽标上方并位于页面中心。非常感谢任何有关如何纠正此问题的帮助。

HTML

```
<header>
    <div id="logo">
        <a href="#"><img src="img/logo.png" alt="GEC logo" /></a>
    </div>
    <div id="slogan">
        <h1>Revolutionizing Potential</h1>
    </div>
    <nav>
        <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#">About Us</a></li>
            <li><a href="#">Coaching Services</a></li>
            <li><a href="#">Resources</a></li>
            <li><a href="#">Events</a></li>
            <li><a href="#">Contact Us</a></li>
        </ul>
    </nav>
</header> 
```

CSS

```
/* Header */

header {
    margin-top: 95px;
}

#logo {
    float: left;
}

#slogan {
    float: right;
    margin-top: 90px;
}

nav ul li {
    display: inline;
    float: left;
}

nav ul li a {
    padding-right: 20px;
}

nav ul li:last-child {
    padding-right: 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:22:30.870

在您的 CSS 中添加：

```
nav {
    clear:both;
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/uGX2Z/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:34:48.357

首先，我总是为所有元素提供默认宽度和高度。

nav 是一个内联元素，而不是一个块。为了避免使用明确的修复，您应该在徽标和标语周围放置一个 div 元素。像这样：
HTML

```
<header>

  <div id="header_top">
    <div id="logo">
        <a href="#"><img src="img/logo.png" alt="GEC logo" /></a>
    </div>
    <div id="slogan">
        <h1>Revolutionizing Potential</h1>
    </div>
  </div>

    <nav>
        <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#">About Us</a></li>
            <li><a href="#">Coaching Services</a></li>
            <li><a href="#">Resources</a></li>
            <li><a href="#">Events</a></li>
            <li><a href="#">Contact Us</a></li>
        </ul>
    </nav>
</header> 
```

现在你可以给 header_top div 一个显示块和一个 overlfow:hidden。
这将使 header_top div 与其内容一起增长。

现在给你导航一个显示：块样式，它就完成了

我在我的笔记本上进行了本地测试，它就像一个魅力:)

添加：CSS

```
#header_top{
display: block;
overflow: hidden;
}
nav{
display: block;    
} 
```

# asp.net-mvc - MVC 控制器中的重载 Index() 方法

> ID：11673633
> 
> 赞同：3
> 
> 时间：2012-07-26T16:17:20.220
> 
> 标签：asp.net-mvc, vb.net, asp.net-mvc-3

我想同时访问 /Blog 和 /Blog/1，其中“1”是博客的 ID。这是我的代码：

```
 '
    ' GET: /Blog/

    Function Index() As ViewResult
        Return (View(db.Blogs.ToList()))
    End Function

    '
    ' GET: /Blog/(Integer)

    Function Index(id As Integer) As ViewResult
        Dim blog As Blog = db.Blogs.Find(id)
        Return View("Details", "_MyLayout", blog)
    End Function 
```

它给出了错误：

> “/”应用程序中的服务器错误。
> 
> 当前对控制器类型“BlogController”的操作“Index”请求在以下操作方法之间不明确：GemcoBlog.GemcoBlog.BlogController System.Web.Mvc.ViewResult Index(Int32) 类型上的 System.Web.Mvc.ViewResult Index()在 GemcoBlog.GemcoBlog.BlogController 类型上
> 
> 说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.Reflection.AmbiguousMatchException：当前对控制器类型“BlogController”的操作“Index”的请求在以下操作方法之间不明确：System.Web.Mvc.ViewResult Index() 类型 GemcoBlog.GemcoBlog.BlogController System。类型 GemcoBlog.GemcoBlog.BlogController 上的 Web.Mvc.ViewResult Index(Int32)
> 
> 源错误：
> 
> 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。

如何重载 Index() 方法？

编辑：

我也试图像这样组合它们：

```
 '
    ' GET: /Blog/

    Function Index(id As Integer) As ViewResult
        If (id) Then
            Dim blog As Blog = db.Blogs.Find(id)
            'Return View(blog)
            Return View("Details", "_MyLayout", blog)
        Else
            Return (View(db.Blogs.ToList()))
        End If
        'Return View(db.Blogs.Where(Function(x) x.Name = "Test").ToList())
    End Function 
```

但是，我得到的错误是：

“/”应用程序中的服务器错误。

> 参数字典包含“Blog.Blog.BlogController”中方法“System.Web.Mvc.ViewResult Index(Int32)”的不可空类型“System.Int32”的参数“id”的空条目。可选参数必须是引用类型、可空类型或声明为可选参数。参数名称：参数
> 
> 说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.ArgumentException：参数字典包含“Blog.Blog”中方法“System.Web.Mvc.ViewResult Index(Int32)”的不可空类型“System.Int32”的参数“id”的空条目。博客控制器'。可选参数必须是引用类型、可空类型或声明为可选参数。参数名称：参数
> 
> 源错误：
> 
> 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:20:17.750

您不能在同一个控制器上使用相同的 HTTP 动词访问 2 个操作。因此，要么更改操作名称，要么您必须使用不同的 HTTP 动词来消除歧义。例如：

```
<HttpPost>
Function Index(id As Integer) As ViewResult
    Dim blog As Blog = db.Blogs.Find(id)
    Return View("Details", "_MyLayout", blog)
End Function 
```

但由于其他操作似乎也在获取数据，我猜你不想让它只能通过 POST 访问。所以在这种情况下只需重命名它。坚持标准 RESTful 约定，您可以使用它`Index`来返回资源列表并`Show`返回特定资源：

```
Function Index() As ViewResult
    Return (View(db.Blogs.ToList()))
End Function

'
' GET: /Blog/(Integer)

Function Show(id As Integer) As ViewResult
    Dim blog As Blog = db.Blogs.Find(id)
    Return View("Details", "_MyLayout", blog)
End Function 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T16:59:39.707

有几种方法可以做到这一点。最简单的方法是将第一个方法重命名为“ShowBlog”或您想要的任何名称，然后在 global.asax 中设置一个路由，该路由无需参数即可路由到 /Blog 路由。

例如（在 c# 中）：

```
routes.MapRoute("Blog", "Blog", new { controller = "Blog", action = "ShowBlog" }); 
```

确保 MapRoute 位于默认路由之前。

要使您的第二种方法起作用，您需要使 id 可以为空，然后在您的方法中检查 null。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T16:58:52.753

由于它不可为空，因此它会自动假定您默认提供了一个 id。将 Id 设为 Nullable Integer，它将适用于两个 URL。

函数索引（id 作为 Nullabe（整数））作为 ViewResult

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-20T02:14:01.323

对 Erik 的帖子进行小修改以使其正常工作（我正在使用 MVC4）

```
routes.MapRoute("Blog", "Blog/{id}", new { controller = "Blog", action = "ShowBlog" }); 
```

# jquery - 在追加新行中添加类

> ID：11673635
> 
> 赞同：1
> 
> 时间：2012-07-26T16:17:28.597
> 
> 标签：jquery, asp.net, html

```
 $("#btnAdd").click(function () {
    $.ajax({
      type: "POST",
      url: "View.aspx/AddResponsibility",
      data: '{"ClientCode":"' + $("#hfClientCode").val() + '","ResponsibilityCode":"' + $("#txtResponsibility").val() + '"}',
      async: true,
      contentType: "application/json; charset=utf-8",
      dataType: "json",
      success: function (msg) {
        $('#tblRespon > tbody:last').append("<tr><td>" + $("#txtResponsibility").val() + "</td><td>" + $("#txtFullName").val() + "</td><td><a class='delete' id='btnDelete' name='btnDelete' value='" + $("#txtResponsibility").val() + "'>" + "Delete" + "</a></td></tr>");
      },
      error: function (msg) {
        alert(msg.d);
      }
    });
  }); 
```

我需要将一个类添加到我要添加的新元素“<a>”中。我在上面尝试的方式似乎没有作为函数工作

```
$(".delete").click(function () { 
```

不会像通常对页面上已包含的元素那样触发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:20:52.917

这是因为您稍后将注入到 DOM 的锚标记。这意味着无论您在哪里绑定了点击功能，它都不会对新注入的元素产生任何影响。

解决方案是[在](http://api.jquery.com/on/). `on`将适用于当前和未来的元素。

改变这个

```
$(".delete").click(function () {
   //some code here
}) 
```

至

```
$(document).on("click",".delete",function () {
  //some code here
}) 
```

`on`从**1.7+**版本开始可用。如果您使用的是早期版本，请考虑使用[live()](http://api.jquery.com/live/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:20:44.100

您需要像这样使用[.on()](http://api.jquery.com/on/)函数：

```
$("#tblRespon").on("click",".delete",function(){ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:23:44.907

如果我是正确的，您需要将*删除*处理程序重新分配给添加的元素：

```
success: function (msg) {
        $('#tblRespon > tbody:last').append("<tr><td>" + $("#txtResponsibility").val() + "</td><td>" + $("#txtFullName").val() + "</td><td><a class='delete' id='btnDelete' name='btnDelete' value='" + $("#txtResponsibility").val() + "'>" + "Delete" + "</a></td></tr>");

        $('.delete').click(function(){
           //your code
        })

}, 
```

我知道有更好的方法，但只需要知道每次添加元素时都应该为这些添加的元素注册处理程序

# centos - rpm 安装脚本未执行

> ID：11673644
> 
> 赞同：0
> 
> 时间：2012-07-26T16:18:00.790
> 
> 标签：centos, rpm, rpm-spec

我正在使用安装了 rpm 4.4 的 ClearOS5.3。我正在使用 rpm 分发我创建的模块，但是`%post`当我安装包时，我的规范文件中的脚本没有执行。

我正在使用命令`rpmbuild -ba mypackage.spec` 来构建 rpm，并使用命令`rpm -ivh mypackage-version-release.rpm`来安装包。

`make`在 %install 脚本中手动执行安装（不使用）。所有文件似乎都安装在正确的位置，但是没有安装脚本运行（特别是`%post`和`%preun`，在我的包的情况下）。使用其他安装脚本 ( `%pre`) 进行的测试表明这些部分也不起作用。

根据我在调试模式下安装软件包的情况，`%pretrans`和`%posttrans`脚本运行。此外，在构建包时，它会识别安装脚本并列出它们的依赖项 ( `/bin/sh`)。

有谁知道为什么这些安装脚本可能无法运行并有解决问题的建议？

# asp.net - ASP.NET Webforms 项目结构的最佳实践

> ID：11673645
> 
> 赞同：7
> 
> 时间：2012-07-26T16:18:02.990
> 
> 标签：asp.net, webforms

使用 ASP.NET 网络表单时，我看到了两种主要的构建项目的方法：

1）有很多 .aspx 文件（包括代码隐藏文件），可能还有一些 .ascx 文件（带有代码隐藏文件。

2）依赖大量的.cs文件（类文件），并让类用Controls.Add()等构造一切。

上面的第一种方法会产生很多 aspx 和 ascx 文件，而 .cs 文件很少。上面的第二种方法会产生大量的 .cs 文件，但会产生非常少的 aspx 和 ascx 文件。

是否有构建项目的“最佳实践”方式？Microsoft 是否推荐其中一种技术？有没有关于这两种风格中哪一种更常用的信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:22:45.343

我会坚持第一种方法。某些控件非常繁琐（或难以）以编程方式创建。

以`GridView`或`ListView`例如，创建一个带有 GridView 的 *.aspx 页面，该页面具有带有模板列的自定义模板。然后运行您的应用程序，在 ASP.NET 临时目录中找到 *.dll，反编译该类，看看代码是多么混乱和复杂。随着时间的推移维护它和/或进行更改将非常困难。

另一方面，只要您尝试保持平衡，拥有一些声明性代码也不错。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T16:38:53.240

这两种方法都没有错。您使用哪一种取决于个人偏好、可行性和要求。

您可能面临的一个问题是，如果您使用第二种方法，将有更少的开发人员能够拿起您的项目并使用它运行，或者需要更长的时间来加快速度。您会发现更多的开发人员可以轻松地采用第一种方法并继续前进。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T16:23:24.977

如果您还没有这样做，请查看[ASP.NET MVC](http://www.asp.net/mvc)。如果您不能选择 MVC，您可以使用 ASP.NET WebForms实现[MVP 模式。](https://www.google.co.uk/search?q=MVP+pattern+with+ASP.NET+WebForms)这两种模式提供了分离表示、模型和路由的好方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T16:29:56.387

尽可能使用方法一，只有在开箱即用的控件不能为您提供所需的功能时才使用方法二 - 在这种情况下，您可以通过从现有控件继承来创建自定义控件。这不是一个“非此即彼”的场景——您应该明智地使用这两种方法。

# c# - 将负值插入 SQL Server 十进制列会引发错误

> ID：11673655
> 
> 赞同：2
> 
> 时间：2012-07-26T16:18:34.713
> 
> 标签：c#, sql, sql-server

我有负小数的问题。

在我定义`price`为的 SQL Server 数据库中`decimal(8,2) NULL`

以及我在 C# 中使用的代码：

```
string query = string.Format("INSERT INTO ticket_elements " +
                             "(ticket_id, product_name, price, tax, amount) " +
                             VALUES ({0}, '{1}', '{2}', '{3}', '{4}'); SELECT SCOPE_IDENTITY();",
                                 ticket_id, pro2.ProductName, tPrice, tax, fixedAmountStr); 
```

当`{2}`价格也不是负值时，它工作正常但是当我设置价格时`-0.25`它给出了这个错误：

> 在数字数据类型中转换 varchar 时的算术溢出。

我需要做什么才能在 db 中使用负值？

更新：

但以下代码适用于负值或正值。

我真的很困惑。

```
string query = string.Format("INSERT INTO tickets " +
                             "(registration_date, cancellation, cancellation_date,    total_products, total_gross_price, total_net_price, pay_type, user_id, client_id)" +
                             " VALUES ('{0}', '{1}', '{2}', '{3}', '{4}',  '{5}', '{6}', {7}, {8});" +
                             " SELECT SCOPE_IDENTITY();", regData, "False", "", this.TotalProducts, totalGrossPrice, totalNetPrice, this.PayType, this.CashierId,  this.ClientId); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T16:22:14.677

不要使用 string.format 创建查询。请改用参数化查询。

对于 SQL Server：

```
var aDbCommand = connection.CreateCommand();
aDbCommand.CommandText = "insert into myTable(column1,columns2) values (@param1, @param2)";
aDbCommand.Parameters.Add(new SqlParameter{Name="@param1", SqlDbType=SqlDbType.Decimal, Value = aValue});
aDbCommand.Parameters.Add(new SqlParameter{Name="@param2", SqlDbType=SqlDbType.Decimal, Value = aValue});
aDbCommand.Execute(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T16:52:07.427

请改用参数化查询。它使您免于注入攻击，并且实际上比直接使用硬编码值传递 SQL 更快（因为服务器可以缓存已编译的参数化查询并仅发送值）。这就是你的做法：

```
string query = "INSERT INTO ticket_elements " +
"(ticket_id, product_name, price, tax, amount) " +
"VALUES (@ticket_id, @product_name, @price, @tax, @amount);" + 
"SELECT SCOPE_IDENTITY();",
// Instantiate SqlCommand object with above query.
sqlCommand.Parameters.Add("@ticket_id", ticket_id);
sqlCommand.Parameters.Add("@product_name", pro2.ProductName);
sqlCommand.Parameters.Add("@price", tPrice);
sqlCommand.Parameters.Add("@tax", tax);
sqlCommand.Parameters.Add("@amount", fixedAmountStr); 
```

请注意，如果您传入一个字符串，它必须在数据库端执行转换，如果它不能转换它可能会失败。更好的做法是获取强类型值（换句话说，解析数量以确保它们有效），然后将这些值传递给参数。

# wix - 如何在我的包（引导程序）中显示功能安装进度？

> ID：11673657
> 
> 赞同：1
> 
> 时间：2012-07-26T16:18:40.780
> 
> 标签：wix, wix3.6, burn

我想在我的托管引导程序（捆绑包）中显示功能安装进度。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T16:41:09.980

一个很好的例子是下载[WiX 源代码](http://wixtoolset.org/releases)，看看他们是如何在托管引导程序中完成的。

大部分进度条代码位于*src\Setup\WixBA\ProgressViewModel.cs*

**关于显示正在安装的功能的**更新：Windows Installer 并没有真正像那样工作。**它不会安装功能 A，然后是功能 B，然后是功能 C。相反，它会遍历[序列表](http://msdn.microsoft.com/en-us/library/windows/desktop/aa371621%28v=vs.85%29.aspx)并跨所有功能执行必要的操作。**

 **例如：这是一个[建议的安装执行顺序](http://msdn.microsoft.com/en-us/library/windows/desktop/aa372038%28v=vs.85%29.aspx)。当 Windows Installer 遇到 InstallFiles 操作时，它会安装所有文件。当 Windows 安装程序遇到 WriteRegistryValues 操作时，它会写入所有注册表值。**

# python - scrapy spider 提取正确的 url 但忽略 url 参数

> ID：11673658
> 
> 赞同：0
> 
> 时间：2012-07-26T16:18:41.660
> 
> 标签：python, scrapy, url-parameters

我有一个爬虫爬虫，它使用 SgmlLinkExtractor 在这样的规则中从图像地图中提取链接，

```
Rule(SgmlLinkExtractor(allow_domains=('pressen-haas.de'),
                       restrict_xpaths=('//map[@name="bildmaschinen"]'))) 
```

如果您想看一下，起始网址是[http://www.pressen-haas.de/neu//machines.php?lang=en 。](http://www.pressen-haas.de/neu//machines.php?lang=en)生成的 url 的格式为[http://www.pressen-haas.de/neu//masch_cat.php?lang=en&phid=0](http://www.pressen-haas.de/neu//masch_cat.php?lang=en&phid=0)，其中 phid 参数从 0 运行到 8。到目前为止一切都很好，蜘蛛得到9 个不同的 url 并抓取它们，问题是当蜘蛛获取这些页面时，如果您在浏览器中输入 url，则所有信息都不可用。我写了一个回调来测试它，

```
hxs = HtmlXPathSelector(response)
print hxs.select('//text()').extract() 
```

如果您在浏览器中键入 url*并删除第二个 url 参数，*即[http://www.pressen-haas.de/neu/masch_cat.php?lang=en](http://www.pressen-haas.de/neu/masch_cat.php?lang=en)

我检查了蜘蛛是否正在抓取正确的网址，我可以将抓取的网址从蜘蛛输出日志复制到浏览器中并且它们工作正常，为什么我可以在浏览器中看到这些网址但蜘蛛看到的东西不同？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T17:28:23.820

蜘蛛试图抓取的页面的 html 格式非常糟糕，我相当确定这是问题所在，而不是蜘蛛本身的问题。

# javascript - localStorage 清屏

> ID：11673659
> 
> 赞同：2
> 
> 时间：2012-07-26T16:18:44.617
> 
> 标签：javascript, html, local-storage

我正在测试 localStorage 以查看它是否可以在我的应用程序中使用，但是当我尝试将文本输入框中的数据存储到它时，屏幕变为空白。我怎样才能解决这个问题？这是代码：

```
<html>
<head>
<script type="text/javascript">
function write() {
localStorage.setItem('item',  document.getElementById('input').value);
}

function read() {
var data = localStorage.getItem('item');
document.getElementById('display').innerHTML = data;
}
</script>
</head>
<body>
<input id="input" type="text" />
<button type="button" onclick="write()">
Write
</button>
<p id="display">
Display
</p>
<button type="button" onclick="read()">
Read
</button>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:23:17.703

将您的函数名称从更改`write`为其他名称。听起来您不小心调用`document.write`了 ，这会使您的整个页面空白。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T16:23:16.207

您不能使用`write`在全局 ( `document`) 命名空间上调用的函数...调用它的其他名称，它工作正常

```
<input id="input" type="text" />
<button type="button" onclick="somethingelse();">
Write
</button>
<p id="display1">
Display
</p>
<button type="button" onclick="read()">
Read
</button>​

function somethingelse() {
    localStorage.setItem('item', document.getElementById('input').value);
}

function read() {
    var data = localStorage.getItem('item');
    document.getElementById('display1').innerHTML = data;
}​ 
```

[这里的工作示例](http://jsfiddle.net/jT58p/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T16:34:50.067

html 事件处理程序中的代码可以像这样有效地运行：

```
with(document) {
    with(this) {
        write();
    }
} 
```

所以你`write`的影子（它调用`document.write`）。您可以简单地参考正确的写法`window.write()`：

```
<button type="button" onclick="window.write()"> 
```

最终最好不要使用内联 html 事件。一个简单的`button.onclick = write`方法就可以了，`button`对元素的引用在哪里。

# .net - 您将如何创建数据继承数据库？

> ID：11673660
> 
> 赞同：2
> 
> 时间：2012-07-26T16:18:46.310
> 
> 标签：.net, sql, database, inheritance, nosql

首先，这不是关于如何在关系数据库中实现继承的问题。

**问题：**

我的系统有几个子系统，可能还有其他几个子系统，依此类推。我需要创建一个数据库来存储每个系统的配置参数。如果未提供子系统自己的设置，子系统将从父系统继承设置。继承是基于每个参数而不是它的完整集。

基本上...

**存储时：**

*   系统 A：**背景**：白色，**堆栈大小**：100，**线程**：50
    *   系统 A-1：**背景**：蓝色，**堆栈大小**：null，**线程**：null
        *   系统 A-1-1：**背景**：null，**堆栈大小**：10，**线程**：null
    *   系统 A-2：**背景**：null，**堆栈大小**：null，**线程**：150

**加载时：**

*   系统 A：**背景**：白色，**堆栈大小**：100，**线程**：50
    *   系统 A-1：**背景**：蓝色，**堆栈大小**：100，**线程**：50
        *   系统 A-1-1：**背景**：蓝色，**堆栈大小**：10，**线程**：50
    *   系统 A-2：**背景**：白色，**堆栈大小**：100，**线程**：150

你将如何实现这一点，所以它也可以快速加载？

我愿意使用 NoSql 和 Sql 解决方案。但是我使用它的应用程序将用 C# 编写。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T17:14:44.263

I have implemented something similar to this before (in MS Sql Server) using a self-referencing configuration table. Each entry would specify system, parent system, and setting name/value. This allows for flexibility around what settings are saved (rather than having a column for background, column for threads, etc). You can calculate the settings for a given system using a recursive [CTE](http://msdn.microsoft.com/en-us/library/ms186243%28v=sql.105%29.aspx), as long as the number of levels doesn't exceed the maximum recursion depth. As a place to start:

```
CREATE TABLE Configuration (
    SystemId varchar(30), 
    ParentSystemId varchar(30), 
    Name varchar(30), 
    Value varchar(30)
) 
```

And to retrieve the configuration for a system:

```
;WITH SystemConfig (Id, ParentId, Name, Value, Rank) AS (
    SELECT SystemId, ParentSystemId, Name, Value, 1
    FROM Configuration C
    WHERE SystemId = @SystemId

    UNION ALL

    SELECT D.SystemId, D.ParentSystemId, D.Name, D.Value, Rank + 1
    FROM Configuration D
    INNER JOIN SystemConfig S ON S.ParentId = D.SystemId
)

SELECT DISTINCT K.Name, V.Value 
FROM SystemConfig K
CROSS APPLY (
    SELECT TOP 1 Value
    FROM SystemConfig G
    WHERE K.Name = G.Name
    ORDER BY Rank
) V 
```

Demo [SQL Fiddle](http://sqlfiddle.com/#!3/c0916/15)

I can't say whether this is the most efficient way in SQL, and I've never attempted a NoSql solution, but this gets the job done and with reasonable indexing performs well.

# wstring - 将 wchar_t 转换为 wstring

> ID：11673669
> 
> 赞同：0
> 
> 时间：2012-07-26T16:19:19.793
> 
> 标签：wstring, printf

很抱歉提出这么简单的问题，但我试图将 wchar_T 放入 wstring 中，但是当我将其打印出来检查时，我会从 wstring 中得到垃圾。代码如下：

```
 wchar_t windowsDir[255];
 memset(windowsDir, NULL, sizeof(windowsDir));
 GetWindowsDirectory(windowsDir, 255);
 std::wstring winDir(windowsDir);

 if (debug){
   wprintf(L"Windows Dir is %s\r\n", windowsDir);
   wprintf(L"Windows Dir is %s\r\n", winDir);
 } 
```

据我从示例中可以看出，我正在做正确的事情，所以我不能害羞地在屏幕上看到垃圾。

在此先感谢您的帮助，

干杯，

尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:22:13.440

你正在使用`wprintf`. 此函数不能接受`std::wstring`. 你永远不应该使用`printf`和朋友或任何变量参数函数的主要原因是它们完全不安全，并且不能处理非 POD 类型，包括任何 C++ 标准库类型。

C++ IOstream 在这里可以正常运行。

# string - 用于保存的matlab迭代文件名

> ID：11673674
> 
> 赞同：3
> 
> 时间：2012-07-26T16:19:50.890
> 
> 标签：string, matlab, file-io, filenames, save

关于matlab的这个问题：我正在运行一个循环，每次迭代都会产生一组新数据，我希望每次都将它保存在一个新文件中。我还通过更改名称来覆盖旧文件。看起来像这样：

```
name_each_iter = strrep(some_source,'.string.mat','string_new.(j).mat') 
```

我在这里挣扎的是迭代，以便我获得文件： ...string_new.1.mat ...string_new.2.mat 等。

我正在尝试 () [] {} 以及 'string_new.'j'.mat' 的各种组合（这给出了语法错误）

如何做呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T16:22:13.883

字符串只是字符的向量。因此，如果您想迭代地创建文件名，这里有一个示例说明您将如何做到这一点：

```
for j = 1:10,
   filename = ['string_new.' num2str(j) '.mat'];
   disp(filename)
end 
```

上面的代码将创建以下输出：

```
string_new.1.mat
string_new.2.mat
string_new.3.mat
string_new.4.mat
string_new.5.mat
string_new.6.mat
string_new.7.mat
string_new.8.mat
string_new.9.mat
string_new.10.mat 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-26T16:37:20.483

您还可以使用 NUM2STR 提前生成所有文件名：

```
>> filenames = cellstr(num2str((1:10)','string_new.%02d.mat'))

filenames = 
    'string_new.01.mat'
    'string_new.02.mat'
    'string_new.03.mat'
    'string_new.04.mat'
    'string_new.05.mat'
    'string_new.06.mat'
    'string_new.07.mat'
    'string_new.08.mat'
    'string_new.09.mat'
    'string_new.10.mat' 
```

`filenames{i}`现在像在每次迭代中一样访问元胞数组内容

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-26T16:34:08.293

[sprintf](http://www.mathworks.nl/help/techdoc/ref/sprintf.html)对此非常有用：

```
for ii=5:12
    filename = sprintf('data_%02d.mat',ii)
end 
```

这会将以下字符串分配给`filename`：

```
 data_05.mat
    data_06.mat
    data_07.mat
    data_08.mat
    data_09.mat
    data_10.mat
    data_11.mat
    data_12.mat 
```

注意零填充。如果您想要参数化的格式化字符串，sprintf 通常很有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T17:05:58.480

要根据现有文件创建名称，您可以使用[regexp](http://www.mathworks.nl/help/techdoc/ref/regexp.html)检测“_new.(number).mat”并根据 regexp 找到的内容更改字符串：

```
original_filename = 'data.string.mat';
im = regexp(original_filename,'_new.\d+.mat')
if isempty(im) % original file, no _new.(j) detected
    newname = [original_filename(1:end-4) '_new.1.mat'];
else
    num = str2double(original_filename(im(end)+5:end-4));
    newname = sprintf('%s_new.%d.mat',original_filename(1:im(end)-1),num+1);
end 
```

这正是这样做的，并产生：

```
 data.string_new.1.mat
    data.string_new.2.mat
    data.string_new.3.mat
    ...

    data.string_new.9.mat
    data.string_new.10.mat
    data.string_new.11.mat 
```

迭代上述函数时，以 'data.string.mat' 开头

# jquery-mobile - jquery mobile 1.1.1 ui-mini

> ID：11673675
> 
> 赞同：0
> 
> 时间：2012-07-26T16:19:50.873
> 
> 标签：jquery-mobile

我刚刚将 jquery mobile 从 1.1.0 升级到 1.1.1，我的导航栏现在搞砸了。谷歌搜索我发现，在 1.1.1 中，默认添加了 .ui-mini 类。不幸的是，文档不是最新的，所以我不知道如何为我的标签恢复“经典”风格。

我试过 data-mini="false", data-full="true" 但它不起作用。任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T18:06:21.477

具有 1.1.1 样式的导航栏：

![在此处输入图像描述](../Images/4453c73402fad4cf37d4551fdfd16bdf.png)

似乎工作正常，除了按钮周围的额外边距 - [http://jsfiddle.net/nirmaljpatel/Mc3be/](http://jsfiddle.net/nirmaljpatel/Mc3be/)

该`.ui-mini`课程仅增加了一些利润...您可以摆脱它：

HTML：

```
<div id="myNavBar" data-role="navbar">
    <ul>
       <li><a href="a.html">One</a></li>
       <li><a href="b.html">Two</a></li>
    </ul>
</div><!-- /navbar --> 
```

CSS：

```
#myNavBar.ui-mini {
    margin: 0 0;
} 
```

移除了 .ui-mini 边距的导航栏：

![在此处输入图像描述](../Images/e2587ce2499c5e4974c2af4ac5c6e1b6.png)

# java - Java TrayIcon displayMessage '可能会触发 ActionEvent' 什么时候/不是吗？

> ID：11673676
> 
> 赞同：3
> 
> 时间：2012-07-26T16:19:52.930
> 
> 标签：java, notifications, trayicon, windows-2000

当使用 TrayIcon.displayMessage 显示弹出通知时，Java 6 文档指出“单击消息可能会触发 ActionEvent”。

[http://docs.oracle.com/javase/6/docs/api/java/awt/TrayIcon.html#displayMessage%28java.lang.String,%20java.lang.String,%20java.awt.TrayIcon.MessageType% 29](http://docs.oracle.com/javase/6/docs/api/java/awt/TrayIcon.html#displayMessage%28java.lang.String,%20java.lang.String,%20java.awt.TrayIcon.MessageType%29)

'可能'？谢谢，文档。

在我的 Windows 2000 测试 VM 上，单击消息似乎不会触发 ActionEvent（不幸的是，我没有任何更新的 Windows 许可证来测试），而相同的代码在 Ubuntu 和 OS X 中会触发一个。

注意：单击图标本身会触发鼠标侦听器上的事件。

所以无论如何，我的具体问题是：

1.  我是否正确单击通知不会触发 Windows 2000 中的 ActionEvent，或者我做错了什么？

2.  在 Windows XP 或 Windows 7 中触发 ActionEvent 是否有效？

最小的示例代码如下。当我`java Test`在 Windows 2000 中运行它时，单击通知不会生成任何命令行输出。

```
import java.awt.*;
import java.awt.event.*;
import java.awt.image.BufferedImage;

import javax.swing.SwingUtilities;

public class Test
{
    public static void main(String[] args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                TrayIcon icon = new TrayIcon(
                    new BufferedImage(16, 16, BufferedImage.TYPE_INT_RGB));
                icon.addActionListener(new ActionListener()
                {
                    @Override
                    public void actionPerformed(ActionEvent arg0)
                    {
                        System.err.println("ActionEvent: " + arg0);
                    }
                });
                try
                {
                    SystemTray.getSystemTray().add(icon);
                }
                catch(AWTException e)
                {
                    e.printStackTrace();
                }
                icon.displayMessage("New message", "Can you click on this?",
                    TrayIcon.MessageType.INFO);
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:03:43.277

您正在处理的问题是跨平台植入问题，这就是它“可能”触发事件的原因

# java - 向东布局添加 2+ 按钮时，仅显示 1 个

> ID：11673679
> 
> 赞同：5
> 
> 时间：2012-07-26T16:20:09.197
> 
> 标签：java, swing, layout, layout-manager

向东布局添加 2+ 按钮时，仅显示 1 个。我正在尝试测试使用选项卡式窗格的布局。出于某种原因，当我尝试向东部区域添加多个按钮时，它只显示 1 个按钮。碰巧显示的按钮是添加到东部区域的最后一个按钮，其余按钮被忽略。我在想也许它们只是隐藏在最后一个按钮下面。

```
public void createPage1()
    {
        {
            panel1 = new JPanel();
            panel1.setLayout( new BorderLayout() );

            panel1.add( new JButton( "North" ), BorderLayout.EAST );
            panel1.add( new JButton( "South" ), BorderLayout.EAST );
            panel1.add( new JButton( "East" ), BorderLayout.EAST );
            panel1.add( new JButton( "West" ), BorderLayout.EAST );
            panel1.add( new JButton( "Center" ), BorderLayout.EAST );
        }
    } 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-26T17:53:05.353

我不知道，您希望您的 UI 看起来如何，但可以这样尝试：

```
public void createPage1() {
    //This will be the main panel. 
    //We are going to put several buttons only in the "EAST" part of it.

    panel1 = new JPanel();
    panel1.setLayout( new BorderLayout() );

    //We create a sub-panel. Notice, that we don't use any layout-manager,
    //Because we want it to use the default FlowLayout
    JPanel subPanel = new JPanel();

    subPanel.add( new JButton( "1" ));
    subPanel.add( new JButton( "2" ));
    subPanel.add( new JButton( "3" ));

    //Now we simply add it to your main panel.
    panel1.add(subPanel, BorderLayout.EAST);
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-26T16:21:25.410

`BorderLayout`每个部分只允许一个组件。如果您想保留`BorderLayout`，但有 2 个以上的按钮，我建议首先将每个按钮放入 a 中`JPanel`，然后将其`JPanel`放入东部插槽中。

但是，您可能有更好的布局选择。您还提到了已经存在的标签`JTabbedPane`。

查看不同的[`LayoutManagers`](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)，并尝试找出适合您的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-26T17:40:07.170

**1\.** **JFrame**的默认布局是`BorderLayout`，它有 East 、 West 、 North 、 South 和 Center 区域，如果没有提到定位，则默认为 Center 。

**2.**现在**每个部分/区域只能容纳一个小部件**（即摆动组件）。

**3.**使用由 NetBeans 团队在 2005 年开发的**Windows Builder Pro，现在可以从 google 中免费**使用，您会**以更好的方式完成这项工作。** `Group Layout`

 ****4.**但是**如果你还是想用 BorderLayout 的**话，我建议你使用`JPanel`上的`content pane`以`JFrame`你**想要的方式添加按钮......****

# objective-c - 从方法返回 2 个结果的最佳方法是什么

> ID：11673687
> 
> 赞同：0
> 
> 时间：2012-07-26T16:20:35.083
> 
> 标签：objective-c, ios, pass-by-reference

我有一个返回整数的方法，现在我还想返回一个小结构或类。如果我使用 C++，我会将结构的引用作为参数传递。在使用 ARC 的 iOS 中，我认为等效的是使用指向具有 __autoreleasing 属性的指针的指针，我觉得这有点麻烦。

我可以返回一个包含这两个值的数组，但我认为我会分配超过必要的值，我可能会经常使用它（100,000 次调用）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T17:00:48.443

即使使用 ARC，您也可以通过引用或对象指针传入结构...

就像在 C++ 中一样，通过 ref 传递结构，例如`&aStruct`

```
-(int)getStuffOut:(SomeStruct *)aStruct {
   if(!aStruct) {
      return 0;
   }
   aStruct->myInt = 12345;
   aStruct->myFloat = 12.345f;
   return 1;
} 
```

或者：

```
-(int)getStuffOut:(SomeClass *)anObject {
   if(!anObject) {
      return 0;
   }
   anObject.myIntProperty = 12345;
   anObject.myFloatProperty = 12.345f;
   return 1;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:30:05.920

如果您使用的是 ARC，那么如果您使用的是普通的 Objective-C，则不必担心内存管理。

自定义对象通过引用传递，因此您可以将 OBJ-C 对象传递给您的方法并填写您的内容。

或者您可以返回一个包含两个值的 Struct

```
+(struct YourStruct)someMethod:(NSString *)someParam;

+(YourStruct)someMethod:(NSString)someParam {

    //some method code

    YourStruct st;

    //Do something here with the struct

    return st;
} 
```

# django - django-sendsms 中的导入错误

> ID：11673689
> 
> 赞同：0
> 
> 时间：2012-07-26T16:20:42.087
> 
> 标签：django

我正在尝试`django-sendsms`根据[此文档使用](https://github.com/stefanfoulis/django-sendsms)

我下载了包，复制了它的文件夹`c:`并在shell中运行了这个命令

```
c:
cd django-sendsms
python setup.py install 
```

这些命令在 sitepackages 文件夹中安装了 django-sms。然后根据我将此后端添加到的文档`settings.py`：

```
SENDSMS_BACKEND = 'sendsms.backends.console.SmsBackend' 
```

并在`views.py`：

```
from sendsms import api
api.send_sms(body='I can haz txt', from_phone='+41791111111', to=['+41791234567']) 
```

但我收到此错误：

```
No module named importlib 
```

一切都基于文档，我不知道它有什么问题！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:38:29.097

您使用的是哪个版本的 Python？似乎模块（在 sendms/util.py 中）将导入名为 importlib 的库，该库仅存在于 Python 2.7 中。如果您使用的是 Python 2.6 或更低版本，则该库不存在。

# c# - 如何在绑定的 DataGrid 中编辑未绑定的单元格？

> ID：11673692
> 
> 赞同：5
> 
> 时间：2012-07-26T16:20:42.883
> 
> 标签：c#, wpf, datagrid

所以我有一个绑定到数据源的 DataGrid（使用 ADO.NET），我创建了一个新的本地列（它不需要存在于数据库中）。我做了一些计算，然后将结果放在该列中。现在，我知道如何通过 DataSet 编辑/访问绑定的单元格，但我不知道如何为该新列的单元格执行此操作，因为它不在 DataSet 中。我想迭代每一行并编辑新列的单元格值。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-05T02:22:41.407

对于访问此页面的其他任何人，将以下属性添加到 my`DataGrid`的声明中对我来说是诀窍：

```
SelectedItemBinding="{Binding /}" 
```

有关更多信息，请查看[此问题](https://stackoverflow.com/questions/18615113/datagrid-how-to-manipulate-selected-item/18626727#18626727)。

# java - 我可以在 Java 中复制或截取输出流吗？

> ID：11673697
> 
> 赞同：7
> 
> 时间：2012-07-26T16:20:58.930
> 
> 标签：java, outputstream

我想截取标准输出流，然后将内容复制到另一个流，但我也希望保持标准输出流和原来一样。我可以用Java实现吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T16:29:59.257

您可以使用类似于`TeeOutputStream`此处解释的示例[编写您自己的 Java I/O 流类](http://java.sun.com/developer/technicalArticles/Streams/WritingIOSC/index.html)

基本上，您创建一个 TeeOutputStream，给它您的流和当前 System.out，然后将 System.setOut 与新流一起使用。

写入 System.out 的任何内容都将写入原始 System.out 以及您的流，因此您可以使用它做任何您想做的事情

编辑：

Oracle 去掉了这个页面，也可以使用Apache Commons 的[TeeOutputStream](http://commons.apache.org/io/apidocs/org/apache/commons/io/output/TeeOutputStream.html)来做同样的事情，而无需添加任何代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T21:36:08.327

看看这个包：[org.apache.commons.io.output](http://commons.apache.org/io/api-release/org/apache/commons/io/output/package-summary.html)。我认为[TeeOutputStream](https://commons.apache.org/proper/commons-io/javadocs/api-2.5/org/apache/commons/io/output/TeeOutputStream.html)是您正在寻找的。

# android - 在 TextView 中显示整数变量

> ID：11673699
> 
> 赞同：1
> 
> 时间：2012-07-26T16:21:15.673
> 
> 标签：android, android-activity, textview, int

我有一个`int`取决于用户输入的。我如何`int`在屏幕上显示它？

这是我一直在尝试的：

```
 <TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:text="@int/HW"  // What goes here, This is where i am confused
    tools:context=".DisplayMessageActivity" /> 
```

这里还有我定义的变量，你可能已经看过我不久前关于这个程序的帖子：

```
 // Receive messages from options page
    Intent intent = getIntent();
    int HW = intent.getIntExtra("MESSAGE_HW", 0);
    int OTW = intent.getIntExtra("MESSAGE_OTW", 0);
    int HPD = intent.getIntExtra("MESSAGE_HPD", 0); 
```

我正在尝试在屏幕上显示 int HW，非常感谢任何帮助！谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-26T16:26:43.223

> *android:text="@int/HW" // 这里发生了什么，这就是我困惑的地方*

默认值可以去那里。可以告诉您`TextView`尚未填充的东西。

> *我如何在屏幕上显示该 int ？*

在`int`屏幕上显示`TextView`您已向我们展示的内容。`TextView`您需要`Activity`使用类似于以下内容的内容：

```
TextView textView = (TextView) this.findViewById(R.id.textViewId); 
```

然后，您可以`textView`使用以下内容设置文本：

```
textView.setText(String.valueOf(HW)); 
```

* * *

这是将 id 添加到 xml 的示例：

```
<TextView
    android:id="@+id/textViewId"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:text="@int/HW"  // What goes here, This is where i am confused
    tools:context=".DisplayMessageActivity" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T16:28:15.567

当您获得用户输入时，请执行以下操作：

```
TextView hwTextView = (TextView)findViewById("R.id.hwTextView")
hwTextView.setText(String.valueOf(yourIntVariable)); 
```

请注意，这意味着您必须向 TextView 添加一个 id 属性，其值为“hwTextView”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T16:31:16.153

基于 prolink007 的答案，您也可以省略该行，然后调用`setText`java 端。

```
<TextView
    android:id="@+id/hw"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    tools:context=".DisplayMessageActivity" /> 
```

```
TextView HWgetText = (TextView)findViewById("R.id.hw");
HWgetText.setText(String.valueOf(HW)); 
```

# java - Java Web Start Jar 签名问题？

> ID：11673707
> 
> 赞同：2
> 
> 时间：2012-07-26T16:21:30.823
> 
> 标签：java, jnlp, java-web-start

我正在尝试通过 Java Web Start 运行这个 Java 应用程序（jar）并且遇到了非常困难的时间。

这是我当前的 JNLP 来源：

```
<?xml version="1.0" encoding="utf-8"?> 
<jnlp spec="1.0+" codebase="http://localhost:8080/" href="Test.jnlp">
    <information>
        <title>Jnlp Testing</title>
        <vendor>YONG MOOK KIM</vendor>
        <homepage href="http://localhost:8080/" />
        <description>Testing Testing</description>
    </information>
    <security>
        <all-permissions/>
    </security>
    <resources>
        <j2se version="1.6+" />
        <jar href="TestJnlp.jar" />
        <jar href="lib/appframework-1.0.3.jar"/>
        <jar href="lib/junit-4.7.jar"/>
        <jar href="lib/org.eclipse.swt.win32.win32.x86_64_3.100.0.v4233d.jar"/>
        <jar href="lib/org-netbeans-modules-java-j2seproject-copylibstask.jar"/>
        <jar href="lib/sqlite-jdbc-3.7.2.jar"/>
        <jar href="lib/swing-worker-1.1.jar"/>
    </resources>
    <application-desc main-class="proteotypic.ProteotypicQuantificationApp" />
</jnlp> 
```

运行 JNLP 文件时，出现以下错误：

```
JNLPException[category: Launch File Error : Exception: null : LaunchDesc:

---- here the JNLP ----

at com.sun.javaws.security.JNLPSignedResourcesHelper.checkSignedResourcesHelper(Unknown Source)
at com.sun.javaws.security.JNLPSignedResourcesHelper.checkSignedResources(Unknown Source)
at com.sun.javaws.Launcher.prepareResources(Unknown Source)
at com.sun.javaws.Launcher.prepareAllResources(Unknown Source)
at com.sun.javaws.Launcher.prepareToLaunch(Unknown Source)
at com.sun.javaws.Launcher.prepareToLaunch(Unknown Source)
at com.sun.javaws.Launcher.launch(Unknown Source)
at com.sun.javaws.Main.launchApp(Unknown Source)
at com.sun.javaws.Main.continueInSecureThread(Unknown Source)
at com.sun.javaws.Main$1.run(Unknown Source)
at java.lang.Thread.run(Unknown Source) 
```

我已经签署了所有的罐子，除了`lib/org.eclipse.swt.win32.win32.x86_64_3.100.0.v4233d.jar`- 如果我也签署了那个罐子，我会得到一个不同的例外：

```
com.sun.deploy.net.FailedDownloadException: Unable to load resource: http://localhost:8080/lib/org.eclipse.swt.win32.win32.x86_64_3.100.0.v4233d.jar
at com.sun.deploy.net.DownloadEngine.actionDownload(Unknown Source)
at com.sun.deploy.net.DownloadEngine.getCacheEntry(Unknown Source)
at com.sun.deploy.net.DownloadEngine.getCacheEntry(Unknown Source)
at com.sun.deploy.net.DownloadEngine.getResourceCacheEntry(Unknown Source)
at com.sun.deploy.net.DownloadEngine.getResourceCacheEntry(Unknown Source)
at com.sun.deploy.net.DownloadEngine.getResource(Unknown Source)
at com.sun.javaws.LaunchDownload$DownloadTask.call(Unknown Source)
at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
at java.util.concurrent.FutureTask.run(Unknown Source)
at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
at java.lang.Thread.run(Unknown Source)

java.io.IOException: invalid SHA1 signature file digest for org/eclipse/swt/awt/SWT_AWT$4.class
at com.sun.deploy.cache.CacheEntry$9.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at com.sun.deploy.cache.CacheEntry.writeFileToDisk(Unknown Source)
at com.sun.deploy.cache.Cache.downloadResourceToTempFile(Unknown Source)
at com.sun.deploy.cache.Cache.downloadResourceToCache(Unknown Source)
at com.sun.deploy.net.DownloadEngine.actionDownload(Unknown Source)
at com.sun.deploy.net.DownloadEngine.getCacheEntry(Unknown Source)
at com.sun.deploy.net.DownloadEngine.getCacheEntry(Unknown Source)
at com.sun.deploy.net.DownloadEngine.getResourceCacheEntry(Unknown Source)
at com.sun.deploy.net.DownloadEngine.getResourceCacheEntry(Unknown Source)
at com.sun.deploy.net.DownloadEngine.getResource(Unknown Source)
at com.sun.javaws.LaunchDownload$DownloadTask.call(Unknown Source)
at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
at java.util.concurrent.FutureTask.run(Unknown Source)
at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
at java.lang.Thread.run(Unknown Source) 
```

在执行“javaws -viewer”并重新运行 JNLP 之后，我得到：

[https://gist.github.com/3183636](https://gist.github.com/3183636)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T15:01:58.557

所有罐子必须使用相同的签名进行签名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T16:26:38.373

您必须签署 jar 文件。您可以使用 自己执行此操作`keytool`，但如果您计划部署它，我建议您让其签名`Verisign`或类似的公司。

如果您只需要临时修复，[可以自己签名](http://java.sun.com/developer/Books/javaprogramming/JAR/sign/signing.html)进行测试。

这是一个易于使用的[教​​程](http://wiki.plexinfo.net/index.php?title=How_to_sign_JAR_files)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-04T08:20:51.270

**一个 jnlp 中的**所有 jar都需要使用相同的签名进行签名，对于由第三方签名的 jar，请使用具有自己 jnlp 的扩展名。

一些 jar 使用 jar 中的原始签名进行加密（SQL 服务器的 JDBC 驱动程序），其他的在重新签名时不起作用（javahelp.jar）

您还可以通过将其包含在应用程序的 jnlp 中来省去签署它们的麻烦：

```
<extension name="javahelp" href="javahelp.jnlp"/> 
```

# microsoft-sync-framework - 将 2 个表合并到具有不同架构的单个表中

> ID：11673708
> 
> 赞同：1
> 
> 时间：2012-07-26T16:21:31.777
> 
> 标签：microsoft-sync-framework

我想将单个表与 2 个表之间的连接结果同步。我为练习设计了这些数据库（EQUI JOIN 位于 PERSON.AddressId 和 ADDRESS.Id 之间）：

如何执行 dbs 的配置和同步？

到目前为止，我开发了一些关于常见场景的示例，例如不同的表名、不同的列名或删除列。

如何做到这一点？

**-->第一个数据库<--**

人：

->Id（PK，int，不为空）

->名称（nchar（10），不为空）

->姓（nchar（10），不为空）

->AddressId（FK，int，不为空）

地址：

->Id（PK，int，不为空）

->街道（nchar（10），不为空）

->城市（nchar（10），不为空）

->国家（nchar（10），不为空）

* * *

**-->第二个数据库<--**

顾客：

->Id（PK，int，不为空）

->名称（nchar（10），不为空）

->姓（nchar（10），不为空）

->地址（nchar（10），不为空）

->城市（nchar（10），不为空）

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T17:20:05.793

据我从文档中可以看出，Schema 需要匹配才能使 Sync 工作。您可以使用 DbSyncTableDescription 的 GlobalName 属性在具有相同架构但名称不同的表之间进行同步。请参阅 JuneT 的帖子：

[http://jtabadero.wordpress.com/2011/05/08/syncing-tables-with-different-table-names/](http://jtabadero.wordpress.com/2011/05/08/synching-tables-with-different-table-names/)

对于这种特殊情况，我认为最好通过在 Second DB 上创建 Person 和 Address，然后将“Customer”创建为视图（也在 Second DB 上）以合并方式显示两个表。

# .net - 获取所有桶对象的内容

> ID：11673709
> 
> 赞同：0
> 
> 时间：2012-07-26T16:21:43.323
> 
> 标签：.net, amazon-web-services, amazon-s3

我在 S3 存储桶中有几个数据（csv）文件排列在以下虚拟目录中：

```
s3://mybucketname/data/Type1/ 
```

存储桶名称：mybucketname
密钥前缀：/data/Type1/

我想在这个bucket+key中组合这些csv文件的内容并将输出作为字符串返回。代码 -

```
public string GetBucketContents(string bucketName)
{
    string bucketContent = "";
    ListObjectsRequest request = new ListObjectsRequest
    {
        BucketName = bucketName,
        Prefix = "data/Type1/"
    };

    using (ListObjectsResponse response = amazonS3Client.ListObjects(request))
    {
        //Loop all objects in S3 bucket
        foreach (S3Object s3Object in response.S3Objects)
        {
            //Get S3 object @ s3Object.Key
            GetObjectRequest objectRequest = new GetObjectRequest().WithBucketName(bucketName).WithKey(s3Object.Key);                   
            using (GetObjectResponse objectResponse = amazonS3Client.GetObject(objectRequest))
            {
                using (StreamReader reader = new StreamReader(objectResponse.ResponseStream))
                {
                    bucketContent += reader.ReadToEnd();
                }
            }
        }
    }

    return bucketContent;
} 
```

我得到了预期的输出:-)
但仍然想验证是否有更好的（性能方面）方法来实现这一目标？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-10T11:11:37.417

如果您使用的是支持 aync 并等待 ajaxy 魔法的较新版本的 .net，那么您可以立即触发所有读取请求，然后等待所有请求返回以构造您的字符串。在大数据读取时，这可以提高性能并节省大量时间。

这是一些代码：（您需要修改字符串以适合您的目的并摆脱秒表但已包含在内，以便您查看时差）

```
public string GetBucketContents(string bucketname)

    string prefix = "S3/PathToCSVs/";
    StringBuilder sb = new StringBuilder();

    List<Task<string>> tasks = new List<Task<string>>();

    Stopwatch sw = new Stopwatch();

    // Begin timing
    sw.Start();

    using (client = new AmazonS3Client(AWSAccessKey, AWSSecretKey, Amazon.RegionEndpoint.USWest2))
    {
        try
        {
            ListObjectsRequest request = new ListObjectsRequest
            {
                BucketName = bucketname,
                Prefix = prefix
            };

            do
            {
                ListObjectsResponse response = client.ListObjects(request);

                // Process response.
                foreach (S3Object entry in response.S3Objects)
                {
                    GetObjectRequest gor = new GetObjectRequest
                    {
                        BucketName = bucketname,
                        Key = entry.Key
                    };

                    tasks.Add(Task<string>.Factory.StartNew(() =>
                    {
                        return ProcessResults(gor, sw);
                    }));

                }

                // If response is truncated, set the marker to get the next 
                // set of keys.
                if (response.IsTruncated)
                {
                    request.Marker = response.NextMarker;
                }
                else
                {
                    request = null;
                }
            } while (request != null);

            Task.WaitAll(tasks.ToArray());

            foreach (var s in tasks)
            {
                sb.AppendLine(sw.Elapsed.ToString() + "<br/>");
                sb.AppendLine(s.Result + "<br/>");
            }

            // Stop timing
            sw.Stop();
            sb.AppendLine(sw.Elapsed.ToString() + "<br/>");

            return sb.ToString();

        }
        catch (AmazonS3Exception amazonS3Exception)
        {
            if (amazonS3Exception.ErrorCode != null && (amazonS3Exception.ErrorCode.Equals("InvalidAccessKeyId") || amazonS3Exception.ErrorCode.Equals("InvalidSecurity")))
            {
                return "Check the provided AWS Credentials. To sign up for service, go to http://aws.amazon.com/s3";
            }
            else
            {
                return string.Format("Error occurred. Message:'{0}' when listing objects", amazonS3Exception.Message);
            }
        }
    }
}

public static string ProcessResults(GetObjectRequest gor, Stopwatch sw)
{
    string result = "";

    using (GetObjectResponse goresp = client.GetObject(gor))
    {
        using (StreamReader reader = new StreamReader(goresp.ResponseStream))
        {
            result = sw.Elapsed.ToString() + "<br/>" + reader.ReadToEnd() + "<br/>";
        }
    }

    return result;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-30T06:47:08.363

我来自 Bucket Explorer 的开发者团队网站。Bucket Explorer 的导出到 csv 功能为您提供了导出数据相关信息以导出为 csv 格式的选项。

[http://www.bucketexplorer.com/documentation/amazon-s3--export-object-details-to-csv.html](http://www.bucketexplorer.com/documentation/amazon-s3--export-object-details-to-csv.html)

# python - 通过 mturk API 列出所有的 hitTypes？

> ID：11673711
> 
> 赞同：0
> 
> 时间：2012-07-26T16:21:58.763
> 
> 标签：python, boto, mechanicalturk

有没有办法使用 mturk api列出我所有的 HIT**类型（不是 HIT 或作业）？**

我找不到任何关于此的文档。我正在使用 python，所以如果 boto 支持这个查询会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T21:05:25.307

不幸的是没有。我们通过 houdiniapi.com 上的 turk 的 api 将我们创建的每个 HitType 本地持久化，效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:12:39.530

Looking through the MTurk API (http://docs.amazonwebservices.com/AWSMechTurk/latest/AWSMturkAPI/Welcome.html) I don't see anything that returns a list of HIT types. You should post a query to the MTurk forum (https://forums.aws.amazon.com/forum.jspa?forumID=11). It seems like a useful feature to add.

# html - Flash 音乐播放器中的其他语言

> ID：11673713
> 
> 赞同：0
> 
> 时间：2012-07-26T16:22:04.530
> 
> 标签：html, flash

我正在使用此代码为我的网站 way2enjoy.com 播放音乐。它可以很好地播放所有歌曲，其来源为英语，但当源文件为其他语言时，例如阿拉伯语它不会播放。我已经使用萤火虫检查了源代码，它对于一个 Flash 播放器是 100% 正确的，而在另一个 Flash 播放器中，它显示阿拉伯字符为??????????

这是我现有的源代码。你可以看到第三个 div 是阿拉伯语。前两个将在下面的链接中很好地播放，但第三个不会播放，但一切都很好。

现场示例 [http://way2enjoy.com/try/musictest/drplayer/index.html](http://way2enjoy.com/try/musictest/drplayer/index.html)

```
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="Stylesheet" href="drplayer.css" type="text/css" />

<script src="jquery-1.4.1.min.js" type="text/javascript"></script>

<script src="drplayer.js" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $("#playlist").playlist(
            {
                playerurl: "swf/drplayer.swf"
            }
        );
    });
</script>

</head>
<body>
<div id="playlist">
    <div href="29.mp3" style="width: 400px;" class="item">
        <div>
            <div class="fr duration"></div>
            <div class="btn play"></div>
            <div class="title"><b></b> - Shut up and let me </div>
        </div>
        <div class="player inactive"></div>
    </div>

    <div class="clear"></div>
    <div href="30.mp3" style="width: 400px;" class="item">
        <div>
            <div class="fr duration"></div>
            <div class="btn play"></div>
            <div class="title"><b>Metallica</b> - Nothing else matters</div>
        </div>
        <div class="player inactive"></div>
    </div>

   <div class="clear"></div>
    <div href="ارجعلي.mp3" style="width: 400px;" class="item">
        <div>
            <div class="fr duration"></div>
            <div class="btn play"></div>
            <div class="title"><b>Arabic song</b> - Arabic song</div>
        </div>
        <div class="player inactive"></div>
    </div>

</div>

<a href="javascript:void(0);" onClick="$('#playlist').playlist('prev');">Prev</a>
<a href="javascript:void(0);" onClick="$('#playlist').playlist('next');">Next</a>

<a href="javascript:void(0);" onClick="$('#playlist').playlist('pause');">Pause</a>
<a href="javascript:void(0);" onClick="$('#playlist').playlist('play');">Play</a> 
```

这是我尝试过的其他玩家的链接

[http://way2enjoy.com/music/viewstory/3406](http://way2enjoy.com/music/viewstory/3406)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:46:42.253

`ارجعلي.mp3`不是有效的 URL，这很可能是您的问题。如果这是真的，您将不得不对其进行 URL 编码或使用纯拉丁文 URL。

这是一个在线 URL 编码器：

[http://meyerweb.com/eric/tools/dencoder/](http://meyerweb.com/eric/tools/dencoder/)

它将文件名变成

```
%D8%A7%D8%B1%D8%AC%D8%B9%D9%84%D9%8A.mp3 
```

在大多数浏览器中应该可以正常显示（即 as `ارجعلي.mp3`），并且始终可以正常工作。

# c# - 更改 RichTextBox 的格式而不选择任何文本

> ID：11673721
> 
> 赞同：1
> 
> 时间：2012-07-26T16:22:23.663
> 
> 标签：c#, .net, winforms, text

我想创建一个 Richtextbox，它加载一个巨大的文件（某种格式的几页文本）并根据格式格式化文本（假设它显示 html）。

我发现了如何使用选择来更改文本格式，但这非常慢且资源昂贵。有没有办法将预先格式化的文本附加到富文本框？这样我就可以格式化每个元素然后附加它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:55:36.300

如果不是您正在寻找的答案，这可能会对您有所帮助

但[RichTextBox.CanPaste 方法](http://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox.canpaste.aspx)确定是否可以将剪贴板中的信息以**指定的数据格式**粘贴。请参阅链接了解它将支持的[System.Windows.Forms.DataFormats](http://msdn.microsoft.com/en-us/library/system.windows.forms.dataformats)

# javascript - webkit中的jquery css值

> ID：11673722
> 
> 赞同：0
> 
> 时间：2012-07-26T16:22:24.753
> 
> 标签：javascript, jquery, css, webkit

使用 webkit 时，我无法读取外部 css 护套设置的值。

```
$(document).ready(function() {
    var plate = $(document.createElement('div'))
            .css({'overflow': 'hidden',
                  'display': 'inline-block'})
            .attr('class', $(this).attr('class'))
            .addClass('bbFormerPlate');
    console.log(plate.css('paddingRight'));
    console.log(plate.css('paddingBottom'));
}); 
```

Chrome 中的控制台什么也没有显示。只是一个空行。火狐没有问题。经过测试的 Safari (Windows) 也无法正常工作，这让我相信问题出在 webkit 上。

我试图将它添加到页面上已经定位的另一个元素中，看看是否有什么不同。

```
 $(positionedElement).wrap(plate); 
```

不用找了。仍然不能在 Webkit 上工作，但可以在 FF 上工作。

样式声明：

```
.bbFormerPlate {
    padding: 2px 15px 2px 5px;
    font-size: 10px;
} 
```

该样式实际上应用于页面上显示的元素，但脚本无法读取该值。我不记得我以前遇到过这个问题。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:56:28.610

在您的示例中，您没有在 dom 中插入元素，请检查此（工作）

```
$(document).ready(function() {
    var plate = $('<div></div>')
        .css({'overflow': 'hidden',
              'display': 'inline-block'})
        .attr('class', $(this).attr('class'))
        .addClass('bbFormerPlate');
        $('body').append(plate); // added this line

    console.log(plate.css('paddingRight'));
    console.log(plate.css('fontSize'));
});​ 
```

[**演示。**](http://jsfiddle.net/heera/RnCHJ/2/)

# javascript - 闪烁按钮jQuery的更好方法？

> ID：11673726
> 
> 赞同：0
> 
> 时间：2012-07-26T16:23:06.140
> 
> 标签：javascript, jquery, animation, mobile, blink

我希望一个按钮在 AJAX 调用（以及其他一些动画发生）之前闪烁一小段时间。ajax 调用发生得非常快，所以我不想使用 AJAX 的 before 函数。在任何其他动画之前，眨眼必须是明显的。我觉得好像有一种更漂亮的方法可以做到这一点：

```
 //This is inside of a button click event
       $(this).addClass('active').delay(250).queue(function (e) {
            $(this).removeClass('active').delay(250).queue(function (f) {
                alert(33);
                $child.css('margin-left', $(window).width() + 10 + 'px');
                $child.load(url + 'API CALL' + $(this).data("id"), bindAClicks);
            });
        }); 
```

bindAClicks - 动画到边距：0。

$child 是一个容器 div。

active 是一个具有深色背景的类。

奇怪的是警报甚至没有触发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:18:45.687

If you are referring to beforeSend, I would recommend checking out [this answer](https://stackoverflow.com/questions/5212949/jquery-ajax-wait-until-beforesend-animation-finishes) which shows how to wait for your animation to finish.

In response to Oleg's comment, I'm not sure what problem you're having when you say the response is so quick you can't see the blink. I created a [quick example](http://jsfiddle.net/RxA6r/2/) to demonstrate how it would work (so you can make the Ajax call and still perform the blink). Hopefully this helps.

# cakephp - CakePHP中使用数组变量的表单组合框输入

> ID：11673727
> 
> 赞同：2
> 
> 时间：2012-07-26T16:23:08.027
> 
> 标签：cakephp

```
<?php
$types_size=sizeof($types)-1;
$array_type=' ';
while($types_size!=-1)
{
$array_type.='"'.$types[$types_size]["Type"]["name_type"].'", ';
$types_size--;
}
echo $array_type; 
echo $this -> form -> input ('id_type', array('options' => array($array_type)));
echo $this -> form -> input ('id_type', array('options' => array(shoes, shirts, jeans,)));
?> 
```

*   我创建了 $array_type 来存储类型数据。
*   我得到了类型数据：“鞋子”、“衬衫”、“牛仔裤”、
*   我想创建一个具有 3 个值的组合框输入，就像第二个输入一样

问题：上面的代码没有像我预期的那样显示。第一个输入的组合框只显示一个值：鞋子、衬衫、牛仔裤，不像预期的第二个输入
希望有人能理解我的问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:44:41.253

在上面的代码中，您将意识到这`$array_type`是一个字符串变量而不是数组。`$array_type = array()`您应该使用not声明一个数组变量`$array_type = ''`

您可以尝试打印`$array_type`变量并验证它是数组还是字符串。

现在您的代码应如下所示：

```
<?php
$types_size=sizeof($types)-1;
$array_type= array();
while($types_size!=-1)
{
    $array_type[] = $types[$types_size]["Type"]["name_type"];
    $types_size--;
}
//echo $array_type; // if you echo an array variable it will print `Array`. 
//Use print_r() to print an array 
print_r($array_type);
echo $this -> form -> input ('id_type', array('options' => $array_type));
echo $this -> form -> input ('id_type', array('options' => array(shoes, shirts, jeans,))); 
```

?>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-28T11:31:01.003

```
<?php
$types_size=sizeof($types)-1;
$array_type= array();
while($types_size!=-1)
{
    $array_type[] = $types[$types_size]["Type"]["name_type"];
    $types_size--;
}
//echo $array_type; // if you echo an array variable it will print `Array`. 
//Use print_r() to print an array 
print_r($array_type);
echo $this -> form -> input ('id_type', array('options' => $array_type));
echo $this -> form -> input ('id_type', array('options' => array(shoes, shirts, jeans,))); 
```

# objective-c - Cocoa，存储类调用类方法

> ID：11673730
> 
> 赞同：-1
> 
> 时间：2012-07-26T16:23:15.927
> 
> 标签：objective-c, cocoa

我想存储和设置一个类变量，所以我可以调用它的类方法

是 类似这样的可能吗？

```
Class classInstance = [someInstance class];

[classInstance callSomeClassMethod]; // declared with +, like + (void)callSomeClassMethod 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:30:46.173

是的，有可能...

```
Class klass = [NSString class];

NSLog(@"%@", [[klass alloc] initWithUTF8String:"hey"]);

//=> 2012-07-26 17:29:56.882 Untitled 4[4061:707] hey 
```

# c# - 解析具有名称-值对的字符串

> ID：11673731
> 
> 赞同：16
> 
> 时间：2012-07-26T16:23:16.017
> 
> 标签：c#, asp.net-mvc, parsing, linq-to-sql

如何在 C# 中解析以下名称-值对字符串：

```
string studentDetail = "StudentId=J1123,FirstName=Jack,LastName=Welch,StudentId=k3342,FirstName=Steve,LastName=Smith" 
```

解析这个数组的目的是使用 Linq to SQL 在 DB 中插入值：

```
[HttpPost]
public ActionResult SaveStudent(string studentDetail)
{
    DataContext db = new DataContext();         

    Student student = new Student();
    {
        student.StudentID = //StudentID
        student.FirstName = //FirstName
        student.LastName = //LastName
    };

    db.Student.InsertOnSubmit(student);
    db.SubmitChanges();

    return View();
} 
```

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-07-26T16:37:28.400

您可以在逗号上拆分，然后在等号上拆分。我将数据放入字典以便于访问。

```
string input = "StudentId=J1123,FirstName=Jack,LastName=Welch";

Dictionary<string,string> keyValuePairs = input.Split(',')
  .Select(value => value.Split('='))
  .ToDictionary(pair => pair[0], pair => pair[1]);

string studentId = keyValuePairs["StudentId"]; 
```

请注意，这根本不验证输入以确保值中没有逗号，没有没有值的键，缺少键等。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-26T17:04:15.747

因为各个学生记录在输入中没有分隔，所以我会执行以下操作：

```
public class Student
{
    public string Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
} 
```

接着：

```
private List<Student> DoSplit(string input)
{
    var theReturn = new List<Student>();
    input = input.Replace(",StudentId=", "|,StudentId=");

    var students = input.Split('|');

    foreach (var student in students)
    {
        var attribs = student.Split(',');
        if (attribs.Count() == 3)
        {
            var s = new Student();
            s.Id = attribs[0].Substring(attribs[0].LastIndexOf('='));
            s.FirstName = attribs[1].Substring(attribs[1].LastIndexOf('='));
            s.LastName = attribs[2].Substring(attribs[2].LastIndexOf('='));

            theReturn.Add(s);
        }
    }

    return theReturn;
} 
```

同样，这有点幼稚，因为如果内容包含“=”、“”或“|”，则会出现故障。您还应该在那里添加一些检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-01-31T04:32:55.603

Eric Petroelje 在[https://stackoverflow.com/a/2049079/59996有一个非常好的答案](https://stackoverflow.com/a/2049079/59996)

> 尝试[System.Web.HttpUtility.ParseQueryString](http://msdn.microsoft.com/en-us/library/ms150046.aspx)，在问号后面传入所有内容。您需要使用 System.Web 程序集，但它不需要 Web 上下文。

（我不确定为什么这两个问题没有联系）

我能够使用以下代码解析格式为 a=1&b=2&c=3 的字符串

```
NameValueCollection nameValueCollection = HttpUtility.ParseQueryString(submission); 
```

# c# - 排序列表比较

> ID：11673734
> 
> 赞同：1
> 
> 时间：2012-07-26T16:23:23.363
> 
> 标签：c#, asp.net, list, enumerable, icomparer

我有两个排序列表

```
 1\. oldlist<int,int> 

 2\. newlist <int,int> 
```

（应用程序特定信息 - 键是行业 ID，值是重量）

我想比较列表中的变化。

我想要以下东西 -

*   重量不为零的项目列表，但在新列表中为零。

*   重量不为零且已从旧列表更改的项目列表。

我知道有一种东西叫做比较器。可以在这里使用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:29:59.823

您可以使用 Linq：

```
// list of items where weight was not zero, but its zero in the newlist.
var result1 = from o in oldList
              join n in newList on o.Key equals n.Key 
              where o.Value != 0 && n.Value == 0
              select new {Old = o, New = n};

// list of items where weight is not zero and has changed from oldlist.
var result2 = from o in oldList
              join n in newList on o.Key equals n.Key
              where o.Value != 0 && o.Value != n.Value
              select new { Old = o, New = n }; 
```

# unix - Cron 作业设置，解释

> ID：11673739
> 
> 赞同：0
> 
> 时间：2012-07-26T16:23:43.517
> 
> 标签：unix, cron

对于 cron 作业设置，我定义了一个作业如下：

```
 * */12 * * 
```

我假设这意味着 cron 作业将在每 12 小时后运行一次，不幸的是发现它的运行频率更高，不确定频率有多高，但输出比预期的要大。

任何人都可以简单地解释一下，我浏览了不同的文档，但似乎有几种方法可以设置单个 cron。

谁能轻松解释一下？

顺便说一句，我更新了我的 cron 每 12 小时运行一次，如下所示：

```
* * 12 * * ? 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:29:00.350

这条线应该在**12AM**和**12PM**运行：

`* 0,12 * * * /path/to/command`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:33:23.797

`* */12 * *`表示在 0 和 12 上每分钟运行一次。如果您想让它在这些小时内运行一次，请输入一个数字而不是第一个星号 (*)，例如

```
20 */12 * * 
```

顺便说一句，cron作业中应该有5个时间字段而不是4个字段，所以实际上应该是

```
20 */12 * * * 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-07T06:02:26.543

我也在寻找同样的东西，我发现[这个](http://cronchecker.net/)网站非常有用。它将解释您的 cron 工作。

看下面的例子：

1.  * **/15 * * * * cd ~/ecg;**

解释：**命令*cd ~/ecg;* 将在每个月的每一天每小时的每 15 分钟执行一次。**

1.  **15 09 07 03 * php abc.php**

说明：**命令*php abc.php*将在 3 月 7 日上午 9:15 执行。**

# c# - 多线程中的等待问题

> ID：11673742
> 
> 赞同：3
> 
> 时间：2012-07-26T16:23:50.167
> 
> 标签：c#, multithreading

```
class MultiThreading
{
    public class ThreadClass
    {
        public string InputString { get; private set; }
        public int StartPos { get; private set; }
        public List<SearchAlgorithm.CandidateStr> completeModels;
        public List<SearchAlgorithm.CandidateStr> partialModels;

        public ThreadClass(string s, int sPos)
        {
            InputString = s;
            StartPos = sPos;
            completeModels = new List<SearchAlgorithm.CandidateStr>();
            partialModels = new List<SearchAlgorithm.CandidateStr>();
        }

        public void Run(int strandID)
        {
            Thread t = new Thread(() => this._run(strandID));
            t.Start();
        }

        private void _run(int strandID)
        {
            SearchAlgorithm.SearchInOneDirection(strandID, ref this.completeModels, ref this.partialModels);
        }

        public static void CombineResult(
            List<ThreadClass> tc,
            out List<SearchAlgorithm.CandidateStr> combinedCompleteModels,
            out List<SearchAlgorithm.CandidateStr> combinedPartialModels)
        {
            // combine the result
        }
    }
}

class Program
    {

        static void Main(string s, int strandID)
        {
            int lenCutoff = 10000;
            if (s.Length > lenCutoff)
            {
                var threads = new List<MultiThreading.ThreadClass>();
                for (int i = 0; i <= s.Length; i += lenCutoff)
                {
                    threads.Add(new MultiThreading.ThreadClass(s.Substring(i, lenCutoff), i));
                    threads[threads.Count - 1].Run(strandID);
                }

                **// How can I wait till all thread in threads list to finish?**
            }
        }
    } 
```

我的问题是如何等到“线程”列表中的所有线程完成然后调用 CombineResult 方法？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T16:30:08.543

您可以添加一个`List<Thread>`结构来记录所有线程

```
private List<Thread> threads = new List<Thread>(); 
```

然后用线程填充列表

```
public void Run(int strandID)
{
    Thread t = new Thread(() => this._run(strandID));
    t.Start();
    threads.Add(t);
} 
```

最后，您可以有一个方法来调用[`Join`](http://msdn.microsoft.com/en-us/library/system.threading.thread.join.aspx)列表中的每个线程。设置超时延迟通常是一个好习惯，这样您的程序就不会永远阻塞（以防线程中存在错误）

```
public void WaitAll(List<Thread> threads, int maxWaitingTime)
{
    foreach (var thread in threads)
    {
        thread.Join(maxWaitingTime); //throws after timeout expires
    }
} 
```

* * *

另一种方法是使用一个[`Task`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx)类并调用[`Task.WaitAll`](http://msdn.microsoft.com/en-us/library/dd270695.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:29:51.367

有`ThreadClass`公开[加入线程](http://msdn.microsoft.com/en-us/library/system.threading.thread.join.aspx)的方法：

```
 private Thread nativeThread;
    public void Run(int strandID)
    {
        nativeThread = new Thread(() => this._run(strandID));
        nativeThread.Start();
    }

    public void Join()
    {
        nativeThread.Join();
    } 
```

然后`ThreadClass.Join`在启动它们后在每个线程上使用：

```
 var threads = new List<ThreadClass>();
    for (int i = 0; i <= s.Length; i += lenCutoff)
    {
        threads.Add(new ThreadClass(s.Substring(i, lenCutoff), i));
        threads[threads.Count - 1].Run(strandID);
    }

    // Waits for each thread to finish in succession
    threads.ForEach(t => t.Join()); 
```

或者，扔掉你的`ThreadClass`并享受[`System.Threading.Tasks`](http://msdn.microsoft.com/en-us/library/dd235608)：

```
// e.g. class Models { Complete; Partial; }
// private Models Search(string source, int offset, int length, int ID)
var tasks = new List<Task<Models>>(
    from x in Enumerable.Range(0, s.Length / lenCutoff)
    select Task.Factory.StartNew<Models>(
        () => Search(s, x, lenCutoff, strandID));
);

// private Models CombineResults(IEnumerable<Models> results)
var combine = Task.Factory.ContinueWhenAll<Models>(
    tasks.ToArray(),
    ts => CombineResults(ts.Select(t => t.Result)));

combine.Wait();

Models combinedModels = combine.Result; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T19:16:01.893

好吧，我看到已经选择了答案，但是我已经开始编写使用`System.Threading.Tasks`其他几个人提出的解决方案。我没有使用 LINQ，而是尝试尽可能地匹配原始代码的结构：

```
class SearchClass
{
    public String InputString { get; private set; }
    public int StartPos { get; private set; }
    public List<string> completeModels;
    public List<string> partialModels;

    public SearchClass(string s, int sPos)
    {
        InputString = s;
        StartPos = sPos;
        completeModels = new List<string>();
        partialModels = new List<string>();
    }

    public void Run(int strandID)
    {
        // SearchAlgorithm.SearchInOneDirection(...);
    }

    // public static void CombineResult(...){ };
}

class Program
{
    static void Main(string s, int strandID)
    {      
        int lenCutoff = 10000;

        if (s.Length > lenCutoff)
        {
            var searches = new List<SearchClass>();
            var tasks = new List<System.Threading.Tasks.Task>();

            for (int i = 0; i < s.Length; i += lenCutoff)
            {
                SearchClass newSearch = new SearchClass(s.Substring(i, lenCutoff), i);
                searches.Add(newSearch);
                tasks.Add(System.Threading.Tasks.Task.Factory.StartNew(()=>newSearch.Run(strandID)));
            }

            System.Threading.Tasks.Task.WaitAll(tasks.ToArray());

            // Combine the result
        }
    }
} 
```

# c++ - g++不能对具有虚拟方法的类的实例的运行时大小进行更多优化吗？

> ID：11673743
> 
> 赞同：3
> 
> 时间：2012-07-26T16:23:51.417
> 
> 标签：c++, optimization, gcc, size, vtable

我刚刚用 g++（4.7）检查了一个包含几十个虚拟方法的类的大小，因为我听说指针用于虚拟方法，我认为这将是一个糟糕的实现，因为它的每个实例将占用 80 个字节在我的系统上只有 10 个虚拟方法的类。

让我松了一口气，`sizeof(<insert typename here>)`只返回了 8 个字节，即我系统上指针的大小。我认为这意味着它存储了一个指向 vtable 的指针，而不是每个方法，并且我只是误解了人们在说什么（或者也许大多数编译器都很愚蠢）。

然而，在我最终测试这个之前，我一直在努力按照我期望的方式使用虚拟方法作为指针。我注意到地址实际上是一个相对非常小的数字，通常低于 100 并且与其他地址相比相差 8 个字节，所以我认为它是某种数组的索引。然后我开始思考如何自己实现 vtables，并且不会使用指针，因为我的测试结果清楚地表明了这一点。我很惊讶地看到它使用了整个 8 个字节（我通过插入一个 char 字段来验证它是否只是填充，该字段返回 16 个字节和 sizeof）。

相反，我将通过存储一个数组索引（例如 4 个字节，如果使用 65536 个或更少的类和虚拟方法，则甚至为 2 个字节）来实现这一点，该索引将在包含指向 vtables 的指针的查找表中进行搜索，并找到就这样。那么为什么要存储指针呢？出于性能原因，还是他们只是将代码重用于 32 位操作系统（因为它不会影响内存大小）？

先感谢您。

**编辑：**

有人要求我计算实际节省的内存，我决定做一个代码示例。不幸的是，它变得相当大（他们要求我在两者中都使用 10 个虚拟方法），但我对其进行了测试，它确实有效。它来了：

```
#include <cstdio>
#include <cstdlib>

/* For the singleton lovers in this community */
class VirtualTableManager
{
    unsigned capacity, count;
    void*** vtables;
public:
    ~VirtualTableManager() {
        delete vtables;
    }
    static VirtualTableManager& getInstance() {
        static VirtualTableManager instance;
        return instance;
    }
    unsigned addElement(void** vtable) {
        if (count == capacity)
        {
            vtables = (void***) realloc(vtables, (capacity += 0x2000) * sizeof(void**));  /* Reserves an extra 64KiB of pointers */
        }
        vtables[count] = vtable;
        return count++;
    }
    void** getElement(unsigned index) {
        return index < capacity ? vtables[index] : 0; /* Just in case: "Hey guys, let's misuse the API!" */
    }
private:
    VirtualTableManager() : capacity(0), count(0), vtables(0) { }
    VirtualTableManager(const VirtualTableManager&);
    void operator =(const VirtualTableManager&);
};

class Real
{
public:
    short someField; /* This is required to show the difference, because of padding */
    Real() : someField(0) { }
    virtual ~Real() {
        printf("Real::~Real()\n");
    }
    virtual void method0() {
        printf("Real::method0()\n");
    }
    virtual void method1(short argument) {
        someField = argument;
    }
    virtual short method2() {
        return someField;
    }
    virtual void method3() { }
    virtual void method4() { }
    virtual void method5() { }
    virtual void method6() { }
    virtual void method7() { }
    virtual void method8() { }
};

class Fake
{
    static void** vtable;
    static unsigned classVIndex; /* Don't know what to call it, please forgive me for the lame identifier */
public:
    unsigned instanceVIndex;
    short someField;
    Fake() : instanceVIndex(classVIndex), someField(0) { }
    ~Fake() {
        reinterpret_cast<void (*)(Fake*)>(VirtualTableManager::getInstance().getElement(instanceVIndex)[9])(this);
    }
    void method0() {
        reinterpret_cast<void (*)(Fake*)>(VirtualTableManager::getInstance().getElement(instanceVIndex)[0])(this);
    }
    void method1(short argument) {
        reinterpret_cast<void (*)(Fake*, short argument)>(VirtualTableManager::getInstance().getElement(instanceVIndex)[1])(this, argument);
    }
    short method2() {
        return reinterpret_cast<short (*)(Fake*)>(VirtualTableManager::getInstance().getElement(instanceVIndex)[2])(this);
    }
    void method3() {
        reinterpret_cast<void (*)(Fake*)>(VirtualTableManager::getInstance().getElement(instanceVIndex)[3])(this);
    }
    void method4() {
        reinterpret_cast<void (*)(Fake*)>(VirtualTableManager::getInstance().getElement(instanceVIndex)[4])(this);
    }
    void method5() {
        reinterpret_cast<void (*)(Fake*)>(VirtualTableManager::getInstance().getElement(instanceVIndex)[5])(this);
    }
    void method6() {
        reinterpret_cast<void (*)(Fake*)>(VirtualTableManager::getInstance().getElement(instanceVIndex)[6])(this);
    }
    void method7() {
        reinterpret_cast<void (*)(Fake*)>(VirtualTableManager::getInstance().getElement(instanceVIndex)[7])(this);
    }
    void method8() {
        reinterpret_cast<void (*)(Fake*)>(VirtualTableManager::getInstance().getElement(instanceVIndex)[8])(this);
    }
protected:
    Fake(unsigned instanceVIndex, short someField)
        : instanceVIndex(instanceVIndex), someField(someField) { }
    /* The 'this' keyword is an automatically passed pointer, so I'll just manually pass it and identify it as 'self' (thank you, lua, I would have used something like 'vthis', which would be boring and probably incorrect) */
    static void vmethod0(Fake* self) {
        printf("Fake::vmethod0(%p)\n", self);
    }
    static void vmethod1(Fake* self, short argument) {
        self->someField = argument;
    }
    static short vmethod2(Fake* self) {
        return self->someField;
    }
    static void vmethod3(Fake* self) { }
    static void vmethod4(Fake* self) { }
    static void vmethod5(Fake* self) { }
    static void vmethod6(Fake* self) { }
    static void vmethod7(Fake* self) { }
    static void vmethod8(Fake* self) { }
    static void vdestructor(Fake* self) {
        printf("Fake::vdestructor(%p)\n", self);
    }
};

class DerivedFake : public Fake
{
    static void** vtable;
    static unsigned classVIndex;
public:
    DerivedFake() : Fake(classVIndex, 0) { }
    ~DerivedFake() {
        reinterpret_cast<void (*)(DerivedFake*)>(VirtualTableManager::getInstance().getElement(instanceVIndex)[1])(this);
    }
    void method0() {
        reinterpret_cast<void (*)(DerivedFake*)>(VirtualTableManager::getInstance().getElement(instanceVIndex)[0])(this);
    }
protected:
    DerivedFake(unsigned instanceVIndex, short someField)
        : Fake(instanceVIndex, someField) { }
    static void vmethod0(DerivedFake* self) {
        printf("DerivedFake::vmethod0(%p)\n", self);
    }
    static void vdestructor(DerivedFake* self) {
        printf("DerivedFake::vdestructor(%p)\n", self);
        Fake::vdestructor(self); /* call parent destructor */
    }
};

/* Make the vtable */
void** Fake::vtable = (void*[]) {
    (void*) &Fake::vmethod0, (void*) &Fake::vmethod1,
    (void*) &Fake::vmethod2, (void*) &Fake::vmethod3,
    (void*) &Fake::vmethod4, (void*) &Fake::vmethod5,
    (void*) &Fake::vmethod6, (void*) &Fake::vmethod7,
    (void*) &Fake::vmethod8, (void*) &Fake::vdestructor
};
/* Store the vtable and get the look-up index */
unsigned Fake::classVIndex = VirtualTableManager::getInstance().addElement(Fake::vtable);

/* Do the same for derived class */
void** DerivedFake::vtable = (void*[]) {
    (void*) &DerivedFake::vmethod0, (void*) &Fake::vmethod1,
    (void*) &Fake::vmethod2, (void*) &Fake::vmethod3,
    (void*) &Fake::vmethod4, (void*) &Fake::vmethod5,
    (void*) &Fake::vmethod6, (void*) &Fake::vmethod7,
    (void*) &Fake::vmethod8, (void*) &DerivedFake::vdestructor
};
unsigned DerivedFake::classVIndex = VirtualTableManager::getInstance().addElement(DerivedFake::vtable);

int main_virtual(int argc, char** argv)
{
    printf("size of 100 instances of Real including padding is %lu bytes\n"
           "size of 100 instances of Fake including padding is %lu bytes\n",
            sizeof(Real[100]), sizeof(Fake[100]));
    Real *real = new Real;
    Fake *fake = new Fake;
    Fake *derived = new DerivedFake;
    real->method1(123);
    fake->method1(456);
    derived->method1(789);
    printf("real::method2() = %hi\n"
           "fake::method2() = %hi\n"
           "derived::method2() = %hi\n", real->method2(), fake->method2(), derived->method2());
    real->method0();
    fake->method0();
    derived->method0();
    delete real;
    delete fake;
    delete derived;
    return 0;
} 
```

不要害怕，我通常不会将定义放在这样的类中。我只是在这里做了，*希望能*提高可读性。无论如何，输出：

```
size of 100 instances of Real including padding is 1600 bytes
size of 100 instances of Fake including padding is 800 bytes
real::method2() = 123
fake::method2() = 456
derived::method2() = 789
Real::method0()
Fake::vmethod0(0x1bd8040)
DerivedFake::vmethod0(0x1bd8060)
Real::~Real()
Fake::vdestructor(0x1bd8040)
DerivedFake::vdestructor(0x1bd8060)
Fake::vdestructor(0x1bd8060) 
```

它可能不是线程安全的，可能包含大量可怕的错误，也可能效率相对较低，但我希望它能够展示我的概念。它在 64 位 Ubuntu 上使用 g++-4.7 进行了测试。我怀疑 32 位系统对大小有任何好处，因为我节省了不到一个字（4 个字节，这么多！）我不得不在其中放置一个字段以显示效果。随意对速度进行基准测试（如果你这样做，请先优化它，我匆忙这样做）或在其他架构/平台和其他编译器上测试效果（我想看看结果，所以如果你这样做，请分享它们）。当有人发现需要创建一个 128/256 位平台，创建一个内存支持非常有限但速度令人难以置信的处理器，或者使用每个实例上的 vtable 使用 21 个字节的编译器时，类似的东西可能很有用。

**编辑：**

糟糕，代码示例是一个*derp*。解决它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T16:41:18.437

基于数组的 vtable 面临的一个挑战是如何将多个已编译的源文件链接在一起。如果每个编译文件都存储自己的表，则链接器在生成最终二进制文件时必须将这些表组合在一起。这增加了链接器的复杂性，现在必须让链接器了解这个新的 C++ 特定细节。

此外，您描述的字节保存技术很难正确处理多个编译单元。如果你有两个源文件，每个源文件的类都足够少，每个 vtable 索引使用两个字节，但现在合并起来需要三个字节怎么办？在这种情况下，链接器必须根据新的对象大小重写对象文件。

此外，这个新系统不会与动态链接很好地交互。如果您有一个在运行时链接的单独的目标文件，您将有两个或更多的 vtables 全局表。然后生成的目标代码必须考虑到这一点，这会增加代码生成器的复杂性。

最后，还有对齐问题。当字长为 8 个字节时，使用两个或四个字节作为索引可能会降低程序性能，如果它偏移了对象的所有其他字段。事实上，g++ 完全有可能只使用四个字节，然后填充到八个。

简而言之，没有理由不进行这种优化，但它的实现非常复杂，并且（可能）代价高昂。也就是说，这是一个非常聪明的主意！

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T18:33:13.293

这总是一个权衡。作为一种改进，任何节省空间的方案都必须至少*经常*节省空间并且*永远不会*失去速度。

如果您在类中放置一个 2 或 4 字节的索引，然后我添加一个指针作为第一个成员，则必须有一些填充才能使我的指针正确对齐。

所以现在这个类无论如何都是16个字节。如果索引比使用 vtable 指针*稍微慢一点，那就是净损失。*

我可以接受这并不总是缩小尺寸，但我不想因为尺寸*没有*增加而损失一些速度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:44:45.537

此外，CPU 更简单地预取一个简单的地址而不是一个数组的索引（当然，还有额外的取消引用）。您增加的成本将超过一次取消引用的成本。

# java - 为什么 FindBugs 在这里抱怨？

> ID：11673744
> 
> 赞同：1
> 
> 时间：2012-07-26T16:23:53.410
> 
> 标签：java, intellij-idea, findbugs

```
 public int getFreezeColumns() {
    Integer currentValue = (Integer) checkValueBinding("freezeColumns", this.freezeColumns);
    if (currentValue != null) {
      return currentValue;
    }
    return 0;
  } 
```

FindBugs 说：

> 一个基元被装箱，然后立即拆箱。这可能是由于在需要未装箱值的地方进行了手动装箱，从而迫使编译器立即撤消装箱工作。

我怎么可能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:29:08.850

我认为这个抱怨有点误导：你没有将`checkValueBinding`它的返回值装箱`Object`，但你`Integer`过早地将它转换为

尝试更改代码以查看它是否可以帮助您避免警告：

```
public int getFreezeColumns() {
    Object currentValue = checkValueBinding("freezeColumns", this.freezeColumns);
    if (currentValue != null) {
        return (Integer)currentValue;
    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:25:55.160

在我看来，它似乎在抱怨您正在创建一个`Integer`，然后`int`立即将其转换为返回它。

checkValueBinding 返回什么？你真的需要把它包装成一个`Integer`？

# php - date() 返回不一致的时间

> ID：11673747
> 
> 赞同：1
> 
> 时间：2012-07-26T16:24:00.387
> 
> 标签：php, datetime

我在使用 PHP 5.3.8 和默认时区设置为欧洲/苏黎世的 Mac Book Pro 上的本地 apache2 网络服务器上有以下 PHP 代码：

```
$now = time();
$in5min = $now + 300;

echo "now: " . date('H:m:s', $now);
echo "<br>in 5 min: " . date('H:m:s', $in5min);

echo "<br>now using date only: " . date('H:m:s'); 
```

结果如下所示（2012 年 7 月 26 日 18:16:12 运行）：

```
now: 18:07:01  
in 5 min: 18:07:01  
now using date only: 18:07:01 
```

请注意，我可以刷新页面 - 秒数改变，小时和分钟保持不变。所以5分钟后它仍然是`18:07`。

我的网络服务器设置有什么问题？为什么时间计算不起作用？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-26T16:25:01.090

正确的格式字符串是`i`分钟，而不是`m`. [`m`是几个月。](http://php.net/manual/en/function.date.php)

```
date('H:i:s'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:26:14.360

你用错了[`interval`](http://www.php.net/manual/en/class.dateinterval.php)，但我建议[`DateTime::add`](http://php.net/manual/en/datetime.add.php)改用：

```
<?php
$date = date_create('2000-01-01');
date_add($date, date_interval_create_from_date_string('10 days'));
echo date_format($date, 'Y-m-d');
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:26:56.250

哈哈可能会打我的脸： date('H:m:s') 完全错误。“m”是月份，而不是分钟。改用 date('H:i:s')

# java - 如何使用整数溢出来违反 Comparable 接口的第一条规定？

> ID：11673748
> 
> 赞同：0
> 
> 时间：2012-07-26T16:24:11.787
> 
> 标签：java, comparable, effective-java

`java.lang.Comparable#compareTo`方法规定为第一条

> 实现者必须确保所有 x 和 y 的 sgn(x.compareTo(y)) == -sgn(y.compare-To(x))。（这意味着当且仅当 y.compareTo(x) 抛出异常时，x.compareTo(y) 必须抛出异常。）

并根据 Joshua Bloch 在 Effective Java 中的第 12 项

> 这个技巧在这里工作得很好，但应该非常小心地使用。不要使用它，除非您确定所讨论的字段是非负的，或者更一般地说，最低和最高可能字段值之间的差异小于或等于 Integer.MAX_VALUE (231-1)。这个技巧并不总是有效的原因是一个有符号的 32 位整数不足以容纳两个任意有符号的 32 位整数之间的差异。如果 i 是一个大的正整数，而 j 是一个大的负整数，(i - j) 将溢出并返回一个负值。生成的 compareTo 方法将针对某些参数返回不正确的结果，并违反 compareTo 合同的第一和第二条规定。这不是一个纯粹的理论问题：它在实际系统中引起了故障。这些故障可能难以调试，

如果整数溢出，您可能会违反第一条规定，但我不知道如何，此示例显示了如何违反第一条规定：

```
public class ProblemsWithLargeIntegers implements Comparable<ProblemsWithLargeIntegers> {

    private int zas;

    @Override
    public int compareTo(ProblemsWithLargeIntegers o) {
        return zas - o.zas;
    }

    public ProblemsWithLargeIntegers(int zas) {
        this.zas = zas;
    }

    public static void main(String[] args) {
      int value1 = ...;
      int value2 = ...;
      ProblemsWithLargeIntegers d = new ProblemsWithLargeIntegers(value1);
      ProblemsWithLargeIntegers e = new ProblemsWithLargeIntegers(value2);
      if (!(Math.signum(d.compareTo(e)) == -Math.signum(e.compareTo(d)))){
        System.out.println("hey!");
    }

} 
```

所以我想要一个`value1`和一个`value2`来得到那个？任何想法？还是约书亚错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:26:39.773

好吧，这首先违反了一般合同。例如，取`value1 = Integer.MIN_VALUE`和`value2 = 1`。这将`Integer.MIN_VALUE > 1`有效地报告。

编辑：实际上，我错了 - 很容易违反第一条规定：

```
int value1 = Integer.MIN_VALUE;
int value2 = 0; 
```

两次比较都会得到否定的结果，因为`Integer.MIN_VALUE - 0`== `0 - Integer.MIN_VALUE`。

# java - java.lang.OutOfMemoryError 做 javax.imageio.ImageIO.read("filename")

> ID：11673749
> 
> 赞同：0
> 
> 时间：2012-07-26T16:24:12.460
> 
> 标签：java, eclipse, image

我想压缩大约 4M 或更多的“JPG”图像。这是我的代码：

```
public static void Compress(String sourceFolder,String destFolder,double proportion) throws IOException
{
    File source=new File(sourceFolder);
    File[] sourceFiles=null;
    if(source.isDirectory())
    {
        sourceFiles=source.listFiles();
        for(int i=0;i<sourceFiles.length;i++)
        {
            String name="";
            javax.imageio.ImageIO.setUseCache(false);
            Image src = javax.imageio.ImageIO.read(sourceFiles[i]);
            name=sourceFiles[i].getName();
            int width=src.getWidth(null);
            int height=src.getHeight(null);
            destWidth=(int) (height*proportion);
            destHeight=(int) (width*proportion);
            BufferedImage tag=new BufferedImage(destWidth,destHeight,BufferedImage.TYPE_INT_RGB);
            Graphics g = tag.getGraphics();  
            g.drawImage(src, 0, 0, destWidth, destHeight, null);
            src.flush();
            src=null;
            FileOutputStream out = new FileOutputStream(destFolder+"/"+name);
            JPEGImageEncoder encoder = JPEGCodec.createJPEGEncoder(out);  
            encoder.encode(tag);  
            out.close(); 
        }
    }
    else
        System.exit(0);
} 
```

当它运行时

```
Image src = javax.imageio.ImageIO.read("filename"); 
```

发生异常：

```
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
at java.awt.image.DataBufferByte.<init>(DataBufferByte.java:58)
at java.awt.image.ComponentSampleModel.createDataBuffer(ComponentSampleModel.java:397)
at java.awt.image.Raster.createWritableRaster(Raster.java:938)
at javax.imageio.ImageTypeSpecifier.createBufferedImage(ImageTypeSpecifier.java:1056)
at javax.imageio.ImageReader.getDestination(ImageReader.java:2879)
at com.sun.imageio.plugins.jpeg.JPEGImageReader.readInternal(JPEGImageReader.java:943)
at com.sun.imageio.plugins.jpeg.JPEGImageReader.read(JPEGImageReader.java:915)
at javax.imageio.ImageIO.read(ImageIO.java:1422)
at javax.imageio.ImageIO.read(ImageIO.java:1282)
at functions.CompressImage.Compress(CompressImage.java:50)
at functions.CompressImage.main(CompressImage.java:24) 
```

我尝试了运行参数（-Xms=1g），它仍然不起作用！谁知道解决方法？请帮帮我，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T14:00:20.580

一个 4MB 的 JPG 将产生一个巨大的位图文件。我认为，它只需要很多内存。我经常在 javax.imagio 中阅读有关大内存消耗的信息。

要获得位图大小，请计算 image_X * image_Y * (8 to 10 bit * 3(colors))

**更新** 一些数学：

我假设每个颜色通道 8 位：

7000 * 4900 * 8 * 3 = 1029000000 位 = 122MB

我相信，内存中必须有一个 122MB 的字节 []。如果操作系统（不是 JVM）不能创建那个内存块，你就会得到那个异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:27:03.737

您需要获取堆转储并对其进行分析。所以最简单的方法是添加JVM参数，如

```
 -XX:+HeapDumpOnOutOfMemoryError 
```

这将自动创建堆转储/稍后您可以使用 java 分析器（yourkit、jprofiler 等）分析问题所在

# java - Java类名是复数的好习惯吗？

> ID：11673750
> 
> 赞同：29
> 
> 时间：2012-07-26T16:24:18.510
> 
> 标签：java, class, naming-conventions

拥有像 ExtractionUtils 这样的 java 类名是否很好。在命名约定中，我没有找到任何关于 java 类的复数名称的信息。
我在其中一个项目中看到过这样的课程。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-07-26T16:29:51.570

[`Arrays`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html), [`Collections`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html), [`Executors`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Executors.html), [`Files`](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html), [`Objects`](http://docs.oracle.com/javase/7/docs/api/java/util/Objects.html), [`Utilities`[!]](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/Utilities.html) - 来自 JDK 的示例。这*有点*违反 OO 设计，因为所有这些类都只是命名空间，包含相关对象的实用程序或工厂方法，而顾名思义，它们实际上包含或维护此类对象的集合。但讲道理——我发现这些名字可读且完全没问题。

BTW 看起来这样的命名约定在 Java 7 API 设计者中非常流行。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-26T16:27:54.487

是的，复数是完全可以接受的，`Collections`例如，它是一个具有许多静态方法的类，这些方法有助于处理不同风格的集合。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T16:30:00.480

我看到的唯一问题是“utils”的定义非常不明确。您希望类引用对象，而不是对象中的方法集合。基本上，它不是一个非常面向对象的名称，甚至与 OOP 无关——“utils”文件通常是非常糟糕的结构化编程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T16:30:29.867

看看 jls7 [http://docs.oracle.com/javase/specs/jls/se7/jls7.pdf](http://docs.oracle.com/javase/specs/jls/se7/jls7.pdf)。我发现以复数形式命名类有什么问题。

# awk - awk 脚本 - 提取括号之间的文本

> ID：11673754
> 
> 赞同：0
> 
> 时间：2012-07-26T16:24:27.483
> 
> 标签：awk

我正在尝试提取文件中第一个与其匹配的右括号之间的文本。

**输入**

```
CREATE MULTISET TABLE ABCD.EFGH,
NO FALLBACK,
NO BEFORE JOURNAL,
NO AFTER JOURNAL,
CHECKSUM = Default
( ABCK_SK      INTEGER         NOT NULL,
PRQ  VARCHAR(1024)           NOT NULL,
RST   DECIMAL (12,4)          NOT NULL,
LMN     CHAR(1)         NOT NULL,
OPQ      DATE            NOT NULL,
PQRS     DATE            NOT NULL,
TUV       INTEGER         NOT NULL,
WXY        INTEGER         NOT NULL
)  UNIQUE PRIMARY INDEX ABCK_PI (ABCK_SK)
; 
```

**预期产出**

```
ABCK_SK      INTEGER         NOT NULL,
PRQ  VARCHAR(1024)           NOT NULL,
RST   DECIMAL (12,4)          NOT NULL,
LMN     CHAR(1)         NOT NULL,
OPQ      DATE            NOT NULL,
PQRS     DATE            NOT NULL,
TUV       INTEGER         NOT NULL,
WXY        INTEGER         NOT NULL 
```

我编写了以下脚本，用于从需要提取文本的位置获取行号和列号，但我无法实际打印输出。任何建议将不胜感激。谢谢

```
#!/bin/sh
nawk 'BEGIN{startln=0;j=0;i=0;endln=0;startchr=0;endchr=0} {
i=1; while( i<=NF ) {
if($i=="(" && startln==0 ){startchr=i; startln=NR} 
if($i==")"){j=j-1} 
if($i=="("){j=j+1} 
if(j==0){endchr=i;endln=NR;break} 
 i=i+1}} 
END{
print "startln="startln " startchr="startchr " endln="endln " endchr="endchr}' $1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T17:13:37.457

这是提取第一个匹配括号中包含的数据的好方法：

```
sed -n -e '1,/(/s/[^(]*/foo/' -e '/(/,$p' input-file | m4 -D 'foo=$* m4exit(0)' 
```

sed 将第一个打开括号之前的所有文本替换为 text `foo`，然后将 m4 与名为`foo`defined 的宏一起使用，该宏仅输出其第一个参数，然后丢弃剩余的数据。 `m4`对括号进行了非常强大的解析，所以这应该适用于大多数情况。（请注意，如果您包含的文本包含`foo`后跟 a的字符串，这将失败`(`。请选择一些除 之外的唯一字符串`foo`。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T18:10:42.573

用法：
`awk -f foo.awk foo.txt`

**foo.awk**

```
BEGIN {
    ORS=""
    RS="[()]"
}

RT=="(" {
    s++;
    if (s>1) print $0 RT
}

RT==")" {
    s--;
    if (s==0) {
      print $0 "\n"
      exit
    } else {
      print $0 RT
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T18:20:09.693

perl 解决方案：

```
perl -e '$/=\1;
    while(<>) {
        if( /\)/ ) { $c -=1; exit unless $c }
        print if $c > 0;
        $c += /\(/
    }' input-file 
```

# sql - 使用 PostgreSQL 执行 SQL 语句时出错

> ID：11673764
> 
> 赞同：12
> 
> 时间：2012-07-26T16:25:03.320
> 
> 标签：sql, postgresql

我在本地数据库中创建了一个新数据库`'sakila'`，然后执行了这些 sql 语句：`pgAdmin III``PostgreSQL`

[sakila](https://github.com/restsql/restsql-sdk/blob/master/WebContent/database/postgresql/sakila-schema.sql) -schema.sql然后[是 sakila-data.sql](https://raw.github.com/restsql/restsql-sdk/master/WebContent/database/postgresql/sakila-data.sql)

第一条语句执行时没有错误，但是第二条 SQL 在执行时确实产生了错误：

```
ERROR:  syntax error at or near "1"
LINE 112: 1 PENELOPE GUINESS 2006-02-15 09:34:33
          ^

********** Error **********

ERROR: syntax error at or near "1"
SQL state: 42601
Character: 2511 
```

如何修复此错误？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-26T18:14:37.707

您不能`COPY FROM stdin`使用 pgAdmin，您必须使用[psql](http://www.postgresql.org/docs/9.1/static/app-psql.html)工具，问题是 pgAdmin 不是控制台应用程序，没有易于使用的标准输入，因此您无法从 Standard Input 复制。

# firefox - 如何在 Debian 服务器上运行 Firefox

> ID：11673769
> 
> 赞同：1
> 
> 时间：2012-07-26T16:25:26.627
> 
> 标签：firefox, ssh, gtk, debian

我已经在我的服务器（运行 Debian 6.0）上安装了 Firefox，但是当我尝试启动它时，我收到以下消息：

```
Error: no display specified 
```

谷歌搜索后，我安装了*xvfb*，现在出现此错误；

```
Xlib:  extension "RANDR" missing on display ":99.0". 
```

它冻结了。

有谁能够帮我？

更新：我现在可以运行 Firefox，但我不希望它打开本地窗口，但一切都应该在服务器端完成。它应该只是打开，播放一个宏（用 iMacros 制作）然后关闭。打开和关闭将由脚本处理。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:30:47.063

您正在使用 SSH 连接到那台 Debian 机器？然后下次使用 -X 作为参数调用 ssh 命令，这会将正确的显示选项传递给服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:04:53.533

从你的盒子的 xterm 启动它：

```
ssh -X debian-server dbus-launch firefox 
```

# ios - iOS：拍摄低质量图像

> ID：11673773
> 
> 赞同：3
> 
> 时间：2012-07-26T16:25:55.033
> 
> 标签：ios

我想允许用户拍照，然后显示灰度版本。但是，它很慢，因为图像文件太大/分辨率太高。

用户拍照时如何降低图像质量？

这是我用于转换的代码：

```
 - (UIImage *)convertImageToGrayScale:(UIImage *)image
{
    // Create image rectangle with current image width/height
    CGRect imageRect = CGRectMake(0, 0, image.size.width, image.size.height);
    // Grayscale color space
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceGray();
    // Create bitmap content with current image size and grayscale colorspace
    CGContextRef context = CGBitmapContextCreate(nil, image.size.width, image.size.height, 8, 0, colorSpace, kCGImageAlphaNone);
    // Draw image into current context, with specified rectangle
    // using previously defined context (with grayscale colorspace)
    CGContextDrawImage(context, imageRect, [image CGImage]);
    /* changes start here */
    // Create bitmap image info from pixel data in current context
    CGImageRef grayImage = CGBitmapContextCreateImage(context);
    // release the colorspace and graphics context
    CGColorSpaceRelease(colorSpace);
    CGContextRelease(context);
    // make a new alpha-only graphics context
    context = CGBitmapContextCreate(nil, image.size.width, image.size.height, 8, 0, nil, kCGImageAlphaOnly);
    // draw image into context with no colorspace
    CGContextDrawImage(context, imageRect, [image CGImage]);
    // create alpha bitmap mask from current context
    CGImageRef mask = CGBitmapContextCreateImage(context);
    // release graphics context
    CGContextRelease(context);
    // make UIImage from grayscale image with alpha mask
    UIImage *grayScaleImage = [UIImage imageWithCGImage:CGImageCreateWithMask(grayImage, mask) scale:image.scale orientation:image.imageOrientation];
    // release the CG images
    CGImageRelease(grayImage);
    CGImageRelease(mask);
    // return the new grayscale image
    return grayScaleImage;
    /* changes end here */
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:38:13.570

如果您使用 AVFoundation 来捕获图像，您可以通过更改捕获会话预设来设置要捕获的图像的质量，如下所示：

```
AVCaptureSession *session = [[AVCaptureSession alloc] init];
session.sessionPreset = AVCaptureSessionPresetLow; 
```

[在AVFoundation Programming Guide](http://developer.apple.com/library/ios/#DOCUMENTATION/AudioVideo/Conceptual/AVFoundationPG/Articles/04_MediaCapture.html#//apple_ref/doc/uid/TP40010188-CH5-SW14)中有一个表格，其中显示对应于哪个分辨率。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T16:40:01.027

在将 UIImage 传递给灰度转换之前如何对其进行下采样？就像是：

```
NSData *imageAsData = UIImageJPEGRepresentation(imageFromCamera, 0.5);
UIImage *downsampledImaged = [UIImage imageWithData:imageAsData]; 
```

当然，您可以使用 0.5 以外的其他压缩质量。

# android - 执行“getAddress(geoLng,geoLat);” 空指针异常

> ID：11673774
> 
> 赞同：0
> 
> 时间：2012-07-26T16:26:08.063
> 
> 标签：android, nullpointerexception

为什么

```
getAddress(geoLng,geoLat);
address = coder.getFromLocation(mlat, mLon, 3); 
```

给了我这个例外

```
07-27 00:21:14.655: E/AndroidRuntime(1228): java.lang.NullPointerException 
```

下面是代码：

```
@Override
public void onLocationChanged(Location location) {
    // TODO Auto-generated method stub
    if (location != null) {
        Double geoLat = location.getLatitude();
        Double geoLng = location.getLongitude();
        String str = ("location:(" + geoLng + "," + geoLat + ")");

        getAddress(geoLng,geoLat);

    }
}
//
public void getAddress(final double mlat, final double mLon) {
    Thread t = new Thread(new Runnable() {
        public void run() {
            try {

                address = coder.getFromLocation(mlat, mLon, 3);
                if (address != null || address.size() > 0) {

                    /*handler.sendMessage(Message.obtain(handler,
                            Constants.GEOCODER_RESULT));*/

                }

        }catch (AMapException e) {
            // TODO Auto-generated catch block
            handler.sendMessage(Message
                    .obtain(handler, Constants.ERROR));

    }}});

    t.start();

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:29:47.140

这里没有足够的代码来给出完整的答案，但是你真的初始化了 coder 吗？如果它在那条线上失败，那么唯一的方法是 coder 是否为空。

# java - 使用 Java，如何在不使用 GUI 组件的情况下检测按键？

> ID：11673782
> 
> 赞同：5
> 
> 时间：2012-07-26T16:26:27.323
> 
> 标签：java, event-handling, keyboard, mouseevent, keylistener

使用 Java，是否可以在不使用 GUI 元素的情况下检测用户操作，例如按键、鼠标按键和/或鼠标的屏幕位置？

如果是，我该如何实施？

否则，有什么替代方案？

* * *

我在这个问题上找到的唯一 StackOverflow 来源是[这个问题](https://stackoverflow.com/questions/9964995/java-how-do-you-detect-tab-key-press-within-a-non-gui-application)，没有答案。

我在 StackOverflow 之外发现的关于这个问题的唯一来源指向“隐形 GUI”解决方案，希望是我真正想要避免的事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T16:39:18.723

它可以使用 JNI 和/或 JNA 来实现，但这不能真正称为“java 实现”，因为您必须编写特定于平台的本机代码。

我尝试过的替代解决方案是使用全屏透明寡妇来监听鼠标和键盘的所有事件，并使用 class 将它们“转发”到实际应用程序`Robot`。我试过这种方法。它在一个限制条件下运行良好：支持应用程序的“鼠标悬停”事件存在问题：鼠标没有在实际应用程序上移动。它在透明的 java 窗口上移动。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-09-12T02:11:49.627

使用 java.awt.event.KeyListener 类。您将必须编写三种方法，您可以在其中编写要检测的键，以及按下键时想要发生的任何事情。

# php - 使用 PHP 上传图片：如何优化空间、带宽和性能

> ID：11673786
> 
> 赞同：0
> 
> 时间：2012-07-26T16:26:34.203
> 
> 标签：php, image-uploading

我打算开发一个用户可以上传图片的区域。我知道如何使用 PHP 在服务器上上传图片，但问题是开发执行系统的最佳实践是什么。

这个想法是在不同的页面中显示拇指，我想知道在服务器上保存两个不同的图像（拇指+原图）是否更好，或者最好只保存原图并动态创建所有拇指. Thumb + original 意味着服务器上有更多空间，而“thumbs on the fly”选项很可能意味着服务器过载。

我发现了几个很好的脚本可以即时调整大小和裁剪，但不确定使用它是否是一个好主意，特别是如果网站每天有几千名访问者（或者将来可能会更多，只是为了乐观/悲观）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:30:18.760

绝对生成并保存在磁盘上的缩略图。存储很便宜。

# facebook-graph-api - 时间线链接中缺少 fb_ref 参数

> ID：11673787
> 
> 赞同：1
> 
> 时间：2012-07-26T16:26:35.660
> 
> 标签：facebook-graph-api, ref

我们的软件依赖传递给喜欢和自定义操作的 ref 参数来跟踪归因。从今天早上开始，fb_ref 参数已停止出现在时间轴上的类似链接上，并且出现在时间轴上自定义操作链接的不同参数中。下面的例子...

这是 18 小时前点赞的时间线链接。它有 fb_ref 参数：

[http://prod.demo.smartsaasp.techlightenment.com/ecommerce/product/?id=1407109375&fb_ref=1002100600__I8RH9f_yxWiH4DJKIMuhm_1407109375&fb_source=timeline](http://prod.demo.smartsaasp.techlightenment.com/ecommerce/product/?id=1407109375&fb_ref=1002100600__I8RH9f_yxWiH4DJKIMuhm_1407109375&fb_source=timeline)

这是今天点赞的时间线链接。它缺少 fb_ref 参数。还要注意 fb_source=aggregation，即使链接以与上一个示例相同的样式出现（fb_source=timeline）：

[http://prod.demo.smartsaasp.techlightenment.com/ecommerce/product/?id=184537892X&fb_action_ids=10151115280129669&fb_action_types=og.likes&fb_source=aggregation&fb_aggregation_id=288381481237582](http://prod.demo.smartsaasp.techlightenment.com/ecommerce/product/?id=184537892X&fb_action_ids=10151115280129669&fb_action_types=og.likes&fb_source=aggregation&fb_aggregation_id=288381481237582)

这是时间线中最近活动面板的链接，用于今天点赞。它缺少 fb_ref 参数：

prod.demo.smartsaasp.techlightenment.com/ecommerce/product/?id=184537892X&fb_action_ids=10151115280129669&fb_source=timeline_og&action_object_map=%7B%2210151115280129669%22%3A10151068797314544%7D&action_type_map=%7B%2210151115280129669%22%3A%22og.likes%22%7D&action_ref_map =%5B%5D

最后，这是来自今天制作的自定义边缘（视图）时间线中最近活动面板的链接。它实际上将我们的跟踪代码嵌入在 action_object_map 参数中，但不包含 fb_ref 参数。

prod.demo.smartsaasp.techlightenment.com/ecommerce/product/?id=184537892X&fb_action_ids=10151115279759669&fb_source=timeline_og&action_object_map=%7B%2210151115279759669%22%3A10151068797314544%7D&action_type_map=%7B%2210151115279759669%22%3A%22scrm-ecommerce-prd%3Aview %22%7D&action_ref_map=%7B%2210151115279759669%22%3A%221002F00400_E6a0 *_zsqF3j4e3vInVUiN184537892X* %22%7D

我向您保证，当我们喜欢和自定义边缘时，会正确发送 ref 参数。

任何人都可以帮忙吗？

# magento - Magento - 在发票上打印跟踪号

> ID：11673792
> 
> 赞同：0
> 
> 时间：2012-07-26T16:26:52.083
> 
> 标签：magento

从 Magento 打印发票时，我需要在发票上打印订单跟踪号（如果有）。

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T05:22:38.020

实际上跟踪号是货件的一部分，而不是发票。但是，如果您想检查跟踪号是否可用，您可以使用：

```
$shipments = $order->getShipmentsCollection();
if ($shipments) {
   foreach ($shipments as $shipment) {
      foreach ($shipment->getAllTracks() as $track) {
         $trackingNumbers[] = $track->getTrackNumber();
      }
   }
} 
```

它将返回数组中的跟踪号（如果您有超过 1 个货件）。希望这可以帮助。

# grails - 在 Cloud Foundry 上部署 Grails 应用程序

> ID：11673793
> 
> 赞同：0
> 
> 时间：2012-07-26T16:26:53.283
> 
> 标签：grails, cloud-foundry

我使用 spring 源开发了一个 Grails 应用程序，将其部署在 Cloud Foundry 上。似乎已经部署得很好，但是 url 不起作用。有人能帮帮我吗！谢谢，礼萨

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T21:04:12.277

要使用 grails 插件访问您的日志文件，请使用 grails cf-logs。

这肯定会向您展示您的应用程序的行为方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T16:08:54.810

正如其他人指出的那样使用

```
grails cf-logs 
```

查看您的应用程序的日志记录结果。

您的应用程序也可能没有正确启动。所以尝试通过键入以下内容重新启动它：

```
grails cf-stop
grails cf-start 
```

Cloud Foundry 插件/Grails 控制台在启动应用程序 (" ") 时可能会过时，`Starting app .........`但只要继续点击部署 URL，一旦它运行，您就可以退出并重新启动 Grails。

# android - 发送多个通知 androidle

> ID：11673796
> 
> 赞同：0
> 
> 时间：2012-07-26T16:27:00.867
> 
> 标签：android

我正在尝试在我的手机上接收多个通知。但是每次我发送通知时。以前的通知都会被新通知覆盖。我看了其他问题，他们说有多个`Id's`通知我也在这样做，但我没有'不知道我哪里错了。

这是我创建通知的方式。（它是在服务中创建的）。

```
private void GenerateNotification(String data)
{
    String ns=Context.NOTIFICATION_SERVICE;
    manager=(NotificationManager) getSystemService(ns);

    int icon=R.drawable.ic_launcher;
    long when = System.currentTimeMillis();

    Notification notification = new Notification(icon, data, when);
    notification.flags |=Notification.FLAG_AUTO_CANCEL;
    notification.defaults |= Notification.DEFAULT_SOUND;
    Context context = getApplicationContext();
    CharSequence contentTitle = "The Best Essay";
    CharSequence contentText = data;
    Intent notificationIntent = new Intent(this,MainActivity.class);
    PendingIntent contentIntent = PendingIntent.getActivity(this, 0, notificationIntent, 0);

    notification.setLatestEventInfo(context, contentTitle, contentText, contentIntent);
    manager.notify(HELLO_ID, notification);
    HELLO_ID++;
} 
```

HelloID 在哪里增加以接收具有唯一 ID 的多个通知。请告诉我我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:31:52.320

所以问题是你使用的意图每次都是一样的。如果您尝试使用与已显示通知中使用的 Intent 相同的 Intent 通知用户，则 android 会认为它们是重复的。这是因为单击时的每个通知最终都会做完全相同的事情（所以 android 就像“为什么我需要显示其中两个？”）。

要做的事情是说“嘿，我是否已经显示通知？如果是这样，我将创建一个新通知，它将覆盖当前通知，但传达一个事实，即我实际上要通知两件事关于”。考虑短信应用程序。当您收到第二条未读短信时，它会覆盖关于原始短信的第一个通知，并用一条通知替换它，告诉您您有两条新短信。有道理？

# visual-c++ - 如何为 MFC 主菜单设置皮肤

> ID：11673801
> 
> 赞同：0
> 
> 时间：2012-07-26T16:27:26.123
> 
> 标签：visual-c++, mfc, menu, skinning

我在具有标准 MFC 主菜单的现有 MFC 应用程序中获得了一个菜单。

但我想改变它的背景颜色，使它看起来更无缝地属于应用程序的其余部分。

*   第一张图片：**MFC 主菜单**。如工具栏中所示，该应用程序的皮肤为蓝色，但菜单仍然是标准的灰色背景颜色。

*   第二张图片：**Spotify**的菜单，经过皮肤处理以适应其他颜色。

![菜单](../Images/bbde6b3f246b2e9268802ab3b3e77486.png)

我没有找到任何类似的例子。你能指点我如何实现这一目标吗？

我想到的方法：

1.  将 CMenu 子类化为我自己的 SkinnedMenu，但它不是由我们的代码创建的，而是由`GetMenu()`派生自`CFrameWnd`. 我在这里唯一能找到的是它的方法签名，定义在`afxwin.h`那么我怎么能使用我自己的子类菜单呢？

2.  删除整个菜单并连续添加我自己的自定义菜单按钮，使其看起来像一个菜单。也许这就是 Spotify 所做的，因为他们还删除了 Windows 窗口框架。

3.  以某种方式编辑现有的 CMenu，但我现在能找到的唯一自定义是修改其`MENUINFO`. 例如，如果我设置`info.hbrBack = skin.GetSysColorBrush(COLOR_MENU)`唯一改变的颜色是下拉菜单的背景，而不是主菜单本身。

4.  其他 ：）

# javascript - 使用未来 4 个月内的星期六日期创建一个选择

> ID：11673806
> 
> 赞同：1
> 
> 时间：2012-07-26T16:27:54.410
> 
> 标签：javascript, html, jquery-ui, calendar

大家好。我想知道如何使用 jquery.ui 作为日期的参考，在接下来的四个月中创建一个包含星期六日期的选择。我只是想创造这样的东西：

```
<select>
  <optgroup label="July">
    <option value="30/07/2012">30</option>
  </optgroup>
  <optgroup label="August">
    <option value="04/08/2012">4</option>
    <option value="11/08/2012">11</option>
    <option value="18/08/2012">18</option>
    <option value="25/08/2012">25</option>
  </optgroup>
</select> 
```

...

任何帮助将不胜感激。

非常感谢您的关注。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T17:01:21.447

一旦您开始进行任何类型的日期数学运算，您就应该始终评估领先的日期库。jQUEryUI 的日期功能以日期选择器的需求为中心，虽然很棒，但如果您不需要实际的日期选择器，那么最好使用[Moment.js 之类的东西](http://momentjs.com/)

要使用 Moment 查找接下来的几个星期六，您可以执行以下操作：

```
var thisSaturday = moment().day(6); // 6th day of the week = saturday

var num = 4,
    upcomingSaturdays = [
      thisSaturday
    ];

for (var i = 1; i <= num; i++) {
  upcomingSaturdays.push(moment(thisSaturday).add('days', 7 * i));
}

document.write(upcomingSaturdays.join('<br>')); 
```

​</p>

[在 JSFiddle](http://jsfiddle.net/658yL/)上

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T00:07:25.787

This is my final code, thanks to jsoverson, I hope it will be helpful for someone else:

```
var thisSaturday = moment().day(6); // 6th day of the week = saturday
var num = 16,
    upcomingSaturdays = [
      thisSaturday
    ];
for (var i = 1; i <= num; i++) {
  upcomingSaturdays.push(moment(thisSaturday).add('days', 7 * i).format("DD/MM/YYYY"));
}
jQuery(function() {
    jQuery("select#date").html(upcomingSaturdays.join('<option>'));
}); 
```

# iphone - ASIWebPageRequest : 响应总是在 NSISOLatin1StringEncoding

> ID：11673816
> 
> 赞同：2
> 
> 时间：2012-07-26T16:28:19.433
> 
> 标签：iphone, ios, asihttprequest

尝试使用 ASIWebPageRequest 类缓存带有离线模式的图像的页面。在我添加一些本地字符串（捷克语）之前，它工作正常。ASIHTTPRequest 总是在 NSISOLatin1StringEncoding 中返回响应，所以有些字符被破坏了。

```
-(void)loadPage
{
    ASIWebPageRequest *request = [ASIWebPageRequest requestWithURL:url_server];
    [request setUserInfo:[NSDictionary dictionaryWithObject:@"book" forKey:@"request"]];
    [request setDelegate:self];
    [request setUrlReplacementMode:ASIReplaceExternalResourcesWithLocalURLs];
}

-(void)requestFinished:(ASIHTTPRequest *)request
{
    NSData *data = [request responseData];

    if (data)
    {
        NSFileManager *file_manager = [NSFileManager defaultManager];

        [file_manager createFileAtPath:str_file_path contents:data attributes:nil];
    }
} 
```

问题是：如何使用 UTF8 编码下载页面（我确定该页面是 UTF8 格式的）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T08:44:25.930

您可以设置默认响应编码格式。

```
[self setDefaultResponseEncoding:NSISOLatin1StringEncoding]; 
```

# jsf - Omnifaces 有分页相关的组件吗？

> ID：11673819
> 
> 赞同：1
> 
> 时间：2012-07-26T16:28:36.297
> 
> 标签：jsf, pagination, omnifaces

我在omnifaces 的展示中搜索了任何有助于JSF（数据表）真实分页的组件，但没有成功。

大家知道有没有吗？

这将是一个很棒的功能。

我在这里采取了一些方法[https://rogerkeays.com/blog/paging-large-data-sets-with-a-lazylist](https://rogerkeays.com/blog/paging-large-data-sets-with-a-lazylist)并附带以下代码。

它非常通用，可以与任何 JSF 组件库或持久性 API 一起使用。

开发人员必须在他的 JSF 托管 bean（支持 bean）中实现惰性列表，它可以访问业务外观或实体管理器来执行查询。

```
import java.util.AbstractList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
public abstract class AbstractLazyList extends AbstractList {

/**
 * Current page cache.
 */
private final Map<Integer, Object> currentPage = new HashMap<Integer, Object>();

/**
 * Page size. Default 50.
 */
private int pageSize = 50;

public void setPageSize(int pageSize) {
    this.pageSize = pageSize;
}

@Override
public Object get(int index) {
    if (currentPage.containsKey(index)) {
        return currentPage.get(index);
    }

    queryNewPage(index);

    return currentPage.get(index);
}

/**
 * Clears cache and queries new page's itens.
 * 
 * @param firstItemIndex
 *            first item index
 */
private void queryNewPage(int firstItemIndex) {
    currentPage.clear();
    final List<Object> pageResults = queryNextPage(firstItemIndex, pageSize);
    for (int j = 0; j < pageResults.size(); j++) {
        currentPage.put(firstItemIndex + j, pageResults.get(j));
    }
}

@Override
public int size() {
    return queryResultsSize();
}

/**
 * Queries next page itens.
 * 
 * @param firstRowIndex
 *            first row index
 * @param pageSize
 *            maximum resuts of the query
 * @return list of results
 */
protected abstract List<Object> queryNextPage(int firstRowIndex,
        int pageSize);

/**
 * Counts the total results of the query.
 * 
 * @return query's total results
 */
protected abstract int queryResultsSize();
}
} 
```

也许这样的方法可以适用于全方位。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T17:17:57.653

OmniFaces 不适合面向视觉的 UI 组件，而更适合于“在幕后”工作并且可以与任何其他 JSF 组件库结合使用的实用程序。

考虑查看面向视觉的 UI 组件库，例如 PrimeFaces 和 RichFaces。它们提供具有分页可能性的数据表组件。

*   [PrimeFaces`<p:dataTable>`展示](http://www.primefaces.org/showcase/ui/datatablePagination.jsf)
*   [RichFaces `<rich:dataTable>`+`<rich:dataScroller>`展示](http://showcase.richfaces.org/richfaces/component-sample.jsf?demo=dataScroller&skin=blueSky)

# if-statement - 在 clojure 中嵌套 if-let 的更好方法

> ID：11673825
> 
> 赞同：11
> 
> 时间：2012-07-26T16:29:00.760
> 
> 标签：if-statement, clojure

假设我有一张这种形式的地图：

```
(def m {:a "A" :b "B"}) 
```

`:a`如果并且`:b`两者都不是零，我想做一些事情，我可以这样做：

```
(if-let [a (:a m)]
  (if-let [b (:b m)]
      ... etc )) 
```

或者

```
(if (and (:a m) (:b m))
  (let [{a :a b :b} m]
      ... etc )) 
```

甚至

```
(if (every? m [:a :b])
  (let [{a :a b :b} m]
      ... etc )) 
```

有没有更简洁（即单线）的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T18:07:03.100

我认为这里可能需要一个宏来创建您想要的行为。我从未写过（还），但以下表示向我表明这可能相当简单：

```
(let [{:keys [a b]} m]
   (when (every? identity [a b])
      (println (str "Processing " a " and " b)))) 
```

使用`:keys`解构绑定的形式并`every?`启用单个规范的键向量来解构和检查，绑定的局部变量在以下代码块中可用。

这可用于制作宏，例如`(when-every? [keys coll] code-with-bindings)`

如果我能花时间弄清楚如何做，我可以用宏代码更新这个答案。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-26T17:46:43.153

您可以使用[地图解构](http://clojure.org/special_forms)——Clojure 的一个有用功能。`and`这也利用了短路的事实，并且在第二个映射中找不到的第一个映射中的任何键都会得到`nil`一个虚假值：

```
(let [{a :a b :b} {:a 1 :b "blah"}] 
  (and a b (op a b))) 
```

好的，所以它是*两*行而不是一行....这也不能区分`nil`其他虚假值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T17:37:48.320

`not-any?`是一个很好的捷径：

```
user> (not-any? nil? [(m :a) (m :b)])
true
user> (not-any? nil? [(m :a) (m :b) (m :d)])
false
user> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T17:57:15.820

如果键具有非零值或者您是否想要返回非零键或值，我不太确定您想要做什么。所以，我只是解决了返回非零键的问题。

作为最终解决方案的一部分，您将使用以下步骤作为中间步骤。

我展示了我使用的所有步骤，不是为了迂腐，而是为了提供完整的答案。命名空间是`repl-test`. 它有一个与之相关的主要内容。

```
repl-test.core=> (def m {:a "A" :b "B" :c nil})
#'repl-test.core/m

repl-test.core=> (keys m)
(:a :c :b) 
```

最后：

```
; Check key's value to determine what is filtered through.
repl-test.core=> (filter #(if-not (nil? (%1 m)) (%1 m)) (keys m) )
(:a :b) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-15T09:01:03.143

顺便说一句，我发现了一个丑陋的单线，它之所以有效，是因为`and`如果它们都为真，则返回其参数列表中的最后一件事：

```
(if-let [[a b] (and (:a m) (:b m) [(:a m)(:b m)])]
    (println "neither " a " nor " b " is falsey")
    (println "at least one of " a " or " b " is falsey")) 
```

# java - Amazon Elastic Beanstalk 广播

> ID：11673834
> 
> 赞同：0
> 
> 时间：2012-07-26T16:29:37.230
> 
> 标签：java, amazon-web-services, amazon

我想开发一个简单的聊天，但为此我需要通知所有客户用户写了一条消息。一个服务器实例很简单，但它如何与 2+...

有没有办法通知我的 beanstalk 中的所有注册实例，或者我该如何解决这个问题。

感谢帮助！

问候，

菜鸟

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T15:10:48.763

根据您的设置，最好的解决方案是使用 Amazon 的 SNS。这相当于一个 JMS 主题，因此，您的应用可以订阅该主题上其他方（可能是在另一个实例中运行的同一应用）发布的事件。然后，该主题的每个消费者都会将聊天消息广播给连接到所述服务器的用户。

[http://aws.amazon.com/sns/](http://aws.amazon.com/sns/)

# excel - 在一个单元格中显示两个日期

> ID：11673847
> 
> 赞同：3
> 
> 时间：2012-07-26T16:30:10.630
> 
> 标签：excel

我试图在 Excel 的一个单元格中显示两个日期。

我使用了以下公式：

```
=DATE(YEAR(NOW()),MONTH(NOW()), I1) & " & " & DATE(YEAR(NOW()),MONTH(NOW()),I15) 
```

其中 I1 和 I15 的值分别为 1 和 15。我选择这个公式的原因是因为我希望每个日期都显示当月的 1 日和 15 日。我希望这个单元格读取“7/1/12 和 7/15/12”但是现在当前的公式给我“41091 和 41105”我已经格式化了单元格以显示我想要的正确日期格式。有没有办法来解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T16:37:05.997

使用 Text() 函数：

```
=TEXT(DATE(YEAR(NOW()),MONTH(NOW()),I1),"mm/dd/yyyy") & " & " & TEXT(DATE(YEAR(NOW()),MONTH(NOW()),I15), "mm/dd/yyyy") 
```

第二个参数控制数据的格式。[可以在此处](http://office.microsoft.com/en-us/excel-help/text-function-HP010062580.aspx)找到有效值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-04-06T09:19:17.897

我刚遇到这个问题。这是一般的解决方案：

```
=TEXT(NOW();"MM.YY")
&" - "&
TEXT(NOW();"MM.YY") 
```

它返回这个： `04.17 - 04.17`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T16:40:11.653

一个稍短的替代方案：

```
=TEXT(NOW()-DAY(NOW())+I1,"m/d/yy")&" & "&TEXT(NOW()-DAY(NOW())+I15,"m/d/yy") 
```

*更新*。更短：

```
=TEXT(NOW(),"m/"""&I1&"""/yy & m/"""&I15&"""/yy") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T16:41:40.100

您不能在单元格上使用日期格式并列出两个日期。单元格的格式需要设置为文本或一般。然后将日期格式化为文本，如下所示

```
=TEXT(DATE(YEAR(NOW()),MONTH(NOW()),I1), "m/d/y") & " & " &TEXT( DATE(YEAR(NOW()),MONTH(NOW()),I15),"m/d/y") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-25T20:11:02.003

这对我有用，我想每周进入，从 2 周前到 1 周前；如我所愿地出现； `MM/DD/YYYY`至`MM/DD/YYYY`

```
=TEXT(NOW()-14&DAY(NOW()),"m/d/yy")&" to "&TEXT(NOW()-7&DAY(NOW()),"m/d/yy") 
```

# javascript - Unable to submit form in jquery ajax callback function

> ID：11673848
> 
> 赞同：0
> 
> 时间：2012-07-26T16:30:11.003
> 
> 标签：javascript, ajax, forms, submit

I am trying to submit a form after validating captcha using an ajax request - if captcha is validated successfully , i have to submit the form.

here is the form :

```
<form action="Feedback" method="post" name="contact_us" id="contact_us_form">
     <table id="contact_us_table" style="font-family: 'Muli', serif;font-weight:bold;margin-left: 26px;margin-top: 39px;">

     <tr>
     <td> </td>
     <td height="20px" style="color: red;font-size: 12px;" id="msg">  </td>
     </tr>
     <tr>
     <td><span style="color: red">*</span>Name  </td>
     <td> <input type="text" name="name" id="name" /> </td>
     </tr>

     <tr>
     <td><span style="color: red">*</span>Email  </td>
     <td> <input type="text" name="email" id="email" /> </td>
     </tr>

     <tr>
     <td width="100px;"><span style="color: red">*</span>Message  </td>
     <td> <textarea style="max-width:420px;width: 420px; height: 100;" name="message" id="message"></textarea></td>
     </tr>

     <tr>
     <td height="50px;"></td>
     <td>Human Verification.</td>
     </tr>

     <tr>
     <td><img src="<%=GlobalData.SERVER_ROOT+"simpleCaptcha.png"%>"></td>
     <td height="20px;"><input type='text' name='answer' id="answer" value=''> </td>
     </tr>

     <tr>
     <td></td>
     <td> <button class="button1" id="submit">Submit</button> </td>
     </tr>

     </table>
     </form> 
```

and here is the javascript :

```
 $("#contact_us_form").submit(function(e){
             e.preventDefault();
            var email = $("#email").val(); 
            var name = $("#name").val(); 
            var message = $("#message").val();
            var answer = $("#answer").val();

            if(name == ""){
                   $("#name").focus();
                   $("#msg").html("Please enter your name");
                   return false;
                  }
            else if(email == ""){
               $("#email").focus();
               $("#msg").html("Please enter an email");
               return false;
              }
             else if(!isValidEmailAddress(email)){
               $("#email").focus();
               $("#msg").html("Email should be like : john@example.com");
               return false;
              }
             else if(message == ""){
                 $("#message").focus();
                   $("#msg").html("Please write your message");
                   return false;
                 }
             else if(answer == ""){
                 $("#answer").focus();
                   $("#msg").html("Enter what you see in image.");
                   return false;
                 }

             $.ajax({
                 type: "POST",
                 url: "CheckCaptcha",
                 data: {answer:answer}
             }).done(function(msg) {
                // alert(msg);

                 if(msg == "true"){
                    //$('#contact_us_form').submit();
                    //$('#contact_us_form').submit(); 
                       $("#contact_us_form").unbind('submit').submit();
                     //setTimeout(document.getElementById('contact_us_form').submit(), 10);
                 }
                 else{
                     $("#answer").focus();
                       $("#msg").html("Captcha Incorrect");
                       return false;
                     }
                 }).error(function(){

                 });

            }); 
```

You can see in javascript :

```
if(msg == "true"){

                    //$('#contact_us_form').submit(); 
                       $("#contact_us_form").unbind('submit').submit();
                     //setTimeout(document.getElementById('contact_us_form').submit(), 10);
                 } 
```

i have tried all i can . but it didn't work.

is their anything wrong ?

**EDIT ::**

**This code works if i click submit two times..**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T12:01:19.040

It's just because of this :

```
<button class="button1" id="submit">Submit</button> 
```

NEVER USE 'type' as a name or id

i was using `submit` as an id. that is why the code was not working..

when i changed it to

```
<button class="button1" id="submit_button">Submit</button> 
```

it worked !

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:42:47.143

try unbind without parameters:

```
 $("#contact_us_form").unbind().submit(); 
```

# php - 具有包含“@”的属性的 foreach 对象迭代

> ID：11673849
> 
> 赞同：1
> 
> 时间：2012-07-26T16:30:15.407
> 
> 标签：php, arrays, object, foreach

这是`$v`其中包含对象的转储

```
object(SimpleXMLElement)[69]
  public '@attributes' => 
    array
      'identifier' => string 'FC7C5117-8FF9-4FF4-86D2-F139EDE6EA74-19726-00011178F6D7A5AC' (length=59)
      'fileext' => string 'pdf' (length=3)
  public 'title' => string 'The PDF File' (length=12)
  public 'summary' => string 'Summary for the pdf file stuff' (length=30)
  public 'tags' => 
    object(SimpleXMLElement)[70]
      public 'tag' => string 'PDFTag' (length=6)
  public 'timeSignature' => 
    object(SimpleXMLElement)[71]
      public '@attributes' => 
        array
          'upper' => string '4' (length=1)
          'lower' => string '4' (length=1)
  public 'key' => string 'C' (length=1)
  public 'transposition' => string 'PDF Trans' (length=9)
  public 'bpm' => string '120' (length=3)
  public 'defaultAudio' => string '57895336-6D03-41B4-954C-91DA3F512185-19726-00011178DFE613C5' (length=59) 
```

我愿意

```
 foreach ($v as $k1 => $v1) 
                    {
                        var_dump($k1);
                        var_dump($v1);
                                            } 
```

它从`title`

```
title
object(SimpleXMLElement)[74]
  string 'The PDF File' (length=12)
summary
object(SimpleXMLElement)[72]
  string 'Summary for the pdf file stuff' (length=30)
tags
object(SimpleXMLElement)[74]
  public 'tag' => string 'PDFTag' (length=6)
timeSignature
object(SimpleXMLElement)[72]
  public '@attributes' => 
    array
      'upper' => string '4' (length=1)
      'lower' => string '4' (length=1)
key
object(SimpleXMLElement)[74]
  string 'C' (length=1)
transposition
object(SimpleXMLElement)[72]
  string 'PDF Trans' (length=9)
bpm
object(SimpleXMLElement)[74]
  string '120' (length=3)
defaultAudio
object(SimpleXMLElement)[72]
  string '57895336-6D03-41B4-954C-91DA3F512185-19726-00011178DFE613C5' (length=59) 
```

我错过了什么？为什么会跳过`@attributes`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:49:36.017

SimpleXML 是 PHP 中又一个奇怪的不一致性，它有些独特。它与 PHP 核心紧密集成，并显示一些 PHP 中没有其他类（包括本机类）显示的特征 - 例如，它代表与[转换为 boolean](http://www.php.net/manual/en/language.types.boolean.php#language.types.boolean.casting)相关的特殊情况。

我可以整天喋喋不休地谈论 SimpleXML 的怪异之处，但切入正题，`@attributes`实际上是向您展示 的[`attributes()`](http://www.php.net/manual/en/simplexmlelement.attributes.php)方法的结果`SimpleXMLElement`，转换为数组。它实际上不是财产。

我个人更喜欢将[DOM](http://www.php.net/manual/en/book.dom.php)用于与 DOM 相关的所有内容，因为虽然它更臃肿且冗长，但我发现它并没有做我没有预料到的事情，而 SimpleXML 会。这主要是我的用户错误/心理障碍，但它伴随着稍微不充分的文档和一些不标准的点点滴滴——比如你在这里遇到的那个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T08:00:02.560

> 为什么会跳过`@attributes`？

`foreach`与*XML 元素的* 对象一起使用`SimpleXMLElement`只会循环遍历*元素*集合，而不是任何属性（确切地迭代哪些元素取决于访问对象的方式；它可以是所有子元素或具有特定本地名称的子元素）。

如果要`foreach`覆盖元素的属性，请使用[`attributes()`](http://php.net/simplexmlelement.attributes)类似`foreach($v->attributes() as $name => $value)`. 此方法返回`SimpleXMLElement`属性的对象，可以对其进行迭代。

* * *

值得一提的是，`attributes()`如果您只是想访问属性，则不需要这样做。`$v['attribute_name']`可以使用数组样式的语法。

# javascript - 带逗号的 JavaScript 短路变量赋值

> ID：11673854
> 
> 赞同：2
> 
> 时间：2012-07-26T16:30:33.127
> 
> 标签：javascript, variable-assignment, short-circuiting

我正在查看我下载的 JavaScript 小部件的一些代码，并且有一个类似于以下内容的变量分配：

```
var a = a.something || a.somethingElse, c, d, e, f, g; 
```

我想知道的是这是否等同于：

```
var a = a.something || a.somethingElse;
var c, d, e, f, g; 
```

或这个：

```
var a = a.something || a.somethingElse || c || d || e || f || g; 
```

我一直在阅读短路评估和作业，我知道第一部分是说：

```
if ( a.something != (null or 0 or false)) {
    a = a.something;
} else {
    a = a.somethingElse;
} 
```

但我似乎找不到任何使用此类示例的资源。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T16:36:49.170

你的理解是正确的。var 语句中的逗号分隔列表被视为单个 Ines。

至于布尔 OR 语句：如果第一个表达式是假的，则使用第二个。您可以添加更多，如第三个示例中所示。

# asp.net-mvc-3 - 将模型传递给控制器 发送 null

> ID：11673857
> 
> 赞同：0
> 
> 时间：2012-07-26T16:30:39.653
> 
> 标签：asp.net-mvc-3, razor, controller

我正在尝试将我的模型从视图传递到控制器的强类型。我的观点是强类型的。当在控制器中调用“保存”操作方法时，我以某种方式在属性值中得到“空”。我正在使用`Asp.Net MVC 3`.

这就是我的视图的样子：

```
@model MvcApplication2.Models.Event
@{
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    <title>AddNew</title>
</head>
<body>
    @using(Html.BeginForm("Save","Event",FormMethod.Post, Model))
    {
        <div>
            <p>@Html.LabelFor(m=>m.EventName) @Html.TextBoxFor(m=>m.EventName)</p>
            <p>@Html.LabelFor(m=>m.Venue) @Html.TextBoxFor(m=>m.Venue)</p>
            <p>@Html.LabelFor(m=>m.StartTime) @Html.TextBoxFor(m=>m.StartTime)</p>
            <p>@Html.LabelFor(m=>m.EndTime) @Html.TextBoxFor(m=>m.EndTime)</p>
            @Html.ActionLink("Save Event", "Save")
        </div>
        }
</body>
</html> 
```

这就是我的`EventController`样子：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using MvcApplication2.Models;

namespace MvcApplication2.Controllers
{
    public class EventController : Controller
    {

        public string Save(Event eventModel)
        {
           //Here eventModel.EventName and rest of the properties are null.

            return "Saved";
        }

    }
} 
```

这是模型的样子：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace MvcApplication2.Models
{
    public class Event
    {
        public string EventName { get; set; }
        public string Venue { get; set; }
        public string StartTime { get; set; }
        public string EndTime { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:33:59.137

ActionLinks 不提交表单。改变：

```
@Html.ActionLink("Save Event", "Save") 
```

到

```
<input type="submit" value="Save"> 
```

`[HttpPost]`此外，如果您添加到您的方法中，这会更加明显。

```
 [HttpPost]
    public string Save(Event eventModel)
    {
       //Here eventModel.EventName and rest of the properties are null.

        return "Saved";
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:48:04.603

`ActionLink`helper 方法呈现一个锚标记，它是一个链接。它不会提交表单。正如 Erik 所提到的，您需要在表单中添加一个提交按钮。

如果您仍然想保留链接而不是提交按钮，您可以使用一些 javascript 代码来提交表单

```
<script type="text/javascript"> 

    $(function(){
      $("#Save").click(function(){
         $(this).closest("form").submit();        
      });
    });

</script> 
```

# java - Apache Karaf 中的基本身份验证

> ID：11673860
> 
> 赞同：1
> 
> 时间：2012-07-26T16:30:42.053
> 
> 标签：java, osgi, cxf, basic-authentication, apache-karaf

我有一个`OSGi`部署到`Apache Karaf 2.2.8`. 在这个捆绑包中，我正在使用`CXF`和`Camel`路由。我编写了一个`CXF`拦截器，它执行基本身份验证：从数据库中获取所有现有用户并进行验证。

问题是当方法`handleMessage`被调用时，`AuthorizationPolicy`对象为空。它不提供任何凭据。这是我的代码：

```
@Override
public void handleMessage(Message message)
        throws Fault {
        AuthorizationPolicy policy = message.get(AuthorizationPolicy.class);
    if (users == null) {
        setLastAccessedTime(Calendar.getInstance());
    }
    if (!wasRecentlyAccessed()) {
        users = this.loadUsers();
        setLastAccessedTime(Calendar.getInstance());
    }
    for (String user : users.values()) {
        LOGGER.debug("Existing user: " + user);
    }
    if (policy == null) {
        LOGGER.error("User attempted to log in with no credentials");
        sendErrorResponse(message, HttpURLConnection.HTTP_UNAUTHORIZED);
        return;
    }
    String password = users.get(policy.getUserName());
    if (password == null || !policy.getPassword().equals(password)) {
        LOGGER.error("Invalid login authentication for user: " + policy.getUserName());
        sendErrorResponse(message, HttpURLConnection.HTTP_FORBIDDEN);            
    }
} 
```

无论如何我可以在 Karaf 中为特定端点设置基本身份验证参数吗？是否有某种配置文件或其他东西？我在互联网上找不到任何东西......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T18:21:31.983

看看这里：[https ://access.redhat.com/documentation/en-US/Fuse_ESB_Enterprise/7.1/html/Security_Guide/files/CamelJetty-BasicAuth.html](https://access.redhat.com/documentation/en-US/Fuse_ESB_Enterprise/7.1/html/Security_Guide/files/CamelJetty-BasicAuth.html)

非常清楚地解释了如何使用`Apache Karaf`和进行基本身份验证`Camel Jetty`。稍后，您可以在部署在`Apache Karaf`.

# css - 样式表 - 输入和按钮，CSS

> ID：11673863
> 
> 赞同：0
> 
> 时间：2012-07-26T16:30:52.330
> 
> 标签：css, forms, border, styling

我有一个应用了一些样式的表单，包括边框。

我遇到的问题是，由于按钮也被视为输入，因此它也有边框，但它是图像，因此我希望它没有边框。

```
<form action="" method="get"><p><label for="name">Name: </label><input name="name" type="text" size="22" maxlength="100" /></p><p><label for="name">Email: </label><input name="email" type="text" size="22" maxlength="100" /></p><p><label for="name">Tel: </label><input name="tel" type="text" size="22" maxlength="100" /></p><p><label for="name">Message: </label><br /><textarea name="message" cols="33" rows="4"></textarea></p><input type="image" value="submit" src="assets/images/submit_btn.png" width="85" height="26" border="0" alt="submit" name="submit"></form> 
```

和CSS

```
input, textarea{border: 1px solid #D8CAB8;}.submit input, .submit textarea{color: #000;background: #ffa20f;border: 2px outset #d7b9c9;} 
```

如何使按钮仍在表单内但没有边框？

谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:34:23.373

在你的 CSS 中使用选择器 :)

如果您使用提交：

```
input[type="submit"] {
   border:0;
} 
```

如果您使用的是图像类型，请尝试向其添加类

```
.imageclass {
   border:0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:37:19.773

给按钮 CSS-class `no-border`。然后用代码扩展你的 CSSS

```
input.no-border {
    border-width:0;  } 
```

就是这样，我希望

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:37:12.803

不要为整个文本区域和输入编写 CSS ，而是以类的形式编写它，因为您为输入提供 css 作为常见，您无法删除边框

# c# - AjaxFileUpload fileName 是完整路径，而不仅仅是文件名

> ID：11673866
> 
> 赞同：2
> 
> 时间：2012-07-26T16:31:00.603
> 
> 标签：c#, asp.net, ajaxcontroltoolkit

我在 Visual Studio 2010 中使用 Ajax 文件上传控件运行我的 Web 表单的本地版本。

我通过上传文件并将 , 等写入数据库进行测试`e.fileName`，`e.fileSize`然后使用 a`GridView`稍后下载文件。

我的问题是：当我将文件写入`e.fileName`数据库时​​，它给了我文件的整个路径（即“C:\Folder\filename.xls”）作为文件名。

将不胜感激有关纠正此问题的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T17:26:03.693

你可以[`Path.GetFileName`](http://msdn.microsoft.com/en-us/library/system.io.path.getfilename%28v=vs.90%29.aspx)使用`System.IO`：

```
string justTheName = Path.GetFileName(e.fileName); 
```

然后将“justTheName”传递给数据库。

# symfony - 我可以从 Symfony2 中的子模板注入 javascript 块吗？

> ID：11673872
> 
> 赞同：5
> 
> 时间：2012-07-26T16:31:22.203
> 
> 标签：symfony, twig

我有一个扩展 ::base.html.twig 的子模板。基本模板包括一个 javascripts 块。我可以覆盖我的子模板中包含的 javascript。

但是，如果我对仅包含表单的第三个模板执行树枝包含，我无法从 javascripts 块（或嵌套块）内的子模板内的第三个模板注入额外的 javascript

这里有更多细节 - [https://gist.github.com/3182772](https://gist.github.com/3182772)

这可能吗？

这个 github 问题似乎表明它不是，但特征对我没有好处，因为我正在扩展一个基本模板。

[https://github.com/fabpot/Twig/issues/644](https://github.com/fabpot/Twig/issues/644)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T17:47:20.217

您不需要内部块。继续这样做：

```
{% block javascripts %}
    {{ parent() }}

    {# put additional JS here #}
{% endblock %} 
```

您可以根据需要继续执行此操作。

# android - 在新的 shell 中运行多个命令（阻塞）

> ID：11673874
> 
> 赞同：1
> 
> 时间：2012-07-26T16:31:25.953
> 
> 标签：android, ruby

我需要在 adb shell 上运行几个命令。

我的第一次尝试是使用 popen：

```
def adb_root(commands) 
   console = IO.popen('adb shell', :mode => 'w') 
   commands.each do |cmd|
     console.puts(cmd)
   end
end 
```

但这会启动一个子进程，我不知道何时执行所有命令。我需要这个来阻止。

是否有捷径可寻？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T23:33:49.530

我使用“bash -c”而不是“adb shell”

```
commands_array = ["ls /", "cd /tmp/", "echo 123"]

def run_commands(commands)
    response = []
    commands.each do |command|
        IO.popen("/bin/bash -c #{command}") do | cmd_io |
            response << cmd_io.readlines.map(&:strip) 
            puts "Response:  #{response.inspect}"
        end
    end
    return response
end

puts run_commands(commands_array).inspect 
```

这将为每个命令打开一个新的 (bash/adb) shell。据我所知，没有一个很好的方法可以知道命令何时完成。希望这可以帮助。

# asp.net - 做回发但返回到表单上的相同位置

> ID：11673876
> 
> 赞同：2
> 
> 时间：2012-07-26T16:31:27.993
> 
> 标签：asp.net

> **可能重复：**
> [在回发时保留页面位置](https://stackoverflow.com/questions/6692223/keep-page-position-on-postback)

回发后如何返回到表单上的相同位置？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-26T16:33:48.473

我认为您需要[**MaintainScrollPositionOnPostback**](http://msdn.microsoft.com/en-us/library/system.web.ui.page.maintainscrollpositiononpostback.aspx)

```
 <%@ Page MaintainScrollPositionOnPostback="true" %> 
```

如果你想在整个网站

```
use Web.config page section <pages maintainScrollPositionOnPostBack="true" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T16:34:06.930

在页面指令中设置为`MaintainScrollPositionOnPostback`。`True`

# javascript - 复杂的构建/排序数组

> ID：11673877
> 
> 赞同：0
> 
> 时间：2012-07-26T16:31:32.050
> 
> 标签：javascript

我有初学者技能，希望有人可以帮助我使用 JavaScript ECMA-262 中的复杂脚本（尽可能基本的 JS 脚本，因为我使用的程序只有较旧的 ECMA-262 实现。所以一些数组在这个程序的语言参考中没有找到像“splice”甚至“concat”这样的函数。但基本的 JS 工作正常）。

我正在尝试从 2 个单独的子数组（subarrayA=1,2,3 和 subarrayB=4,5,6）创建一个总共 6 个数字的数组，交替将每个子数组中的一个数字（从每个子数组中随机选择）放入最后的 6 个项数组。此外，没有重复。

因此，例如，3,6,1,4,2,5。

我试过在线搜索，这个板，从 2 个子阵列中尝试 zipper 方法，% 来挑选奇数/偶数等。到目前为止，没有任何效果。但至少我获得了更多的知识，使我能够以一种可能有助于创建更具体的解决方案的方式提出问题。我会对此进行硬编码，但我认为可能的变化/案例的数量可能会很大？

我希望有人可以在基本 JS 中建议一个脚本/函数，它可以（1）设置每个随机子数组，然后（2）创建最终的 6 项数组。

亲切的问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:40:06.463

如果您仅限于现代 JS API 的子集，我可能会采用首先合并两个数组（迭代地）然后应用随机排序的方法。就像是：

```
var arr1 = [1,2,3], arr2 = [4,5,6];
for (var i=0, len = arr2.length; i<len; i++) arr1[arr1.length] = arr2[i];
arr1.sort(function() { return 0.5 - Math.random(); }); 
```

`arr1`现在是随机排列的 6 个数字的数组，没有重复。

[编辑] - 根据下面的讨论，试试这个。

```
//prep - two arrays, randomised order
var arr1 = [1,2,3].sort(r_sort),
    arr2 = [4,5,6].sort(r_sort),
    final_arr = [],
    smallest_array = arr1.length < arr2.length ? arr1 : arr2;
function r_sort() { return 0.5 - Math.random(); }

//build final array - intersecting the two arrays
for (var i=0, len = smallest_array.length; i<len; i++) {
    final_arr[final_arr.length] = smallest_array[i];
    if (smallest_array == arr1 && arr2[i])
        final_arr[final_arr.length] = arr2[i];
    else if (smallest_array == arr2 && arr1[i])
        final_arr[final_arr.length] = arr1[i];

}

//result
alert(final_arr); 
```

# com - COM 注册失败：“自动化错误：系统找不到指定的文件”，将 dll 安装到 tlb 文件以外的其他文件夹时

> ID：11673878
> 
> 赞同：3
> 
> 时间：2012-07-26T16:31:33.707
> 
> 标签：com, wix, registry, dllregistration, heat

我们有一个用 VB.NET 开发的 COM 组件（我们称之为 MyLib），供我们的 Access 应用程序（我们称之为 MyApp）使用。为此，我们需要使用生成的 MyLib.dll 和 MyLib.tlb 文件进行 COM 注册。当我将这两个文件安装到我们的 MyApp 文件夹中时，一切正常，COM 函数被正确调用。但是，当我将 dll 安装到一个公共文件夹时，我在标题中提到了一个错误 - 我这样做的原因是因为我们希望允许在同一台机器上安装不同版本的 MyApp。所以如果 COM 组件没有改变，我们当然希望在这些不同的版本之间共享它，让 Windows 来做引用计数。

我不确定应该将 MyLib.tlb 文件放在 MyApp 的安装文件夹中，还是与 MyLib.dll 相同的公共文件夹中。但无论如何，我尝试了两个位置，它们都给出了相同的错误。我尝试比较将 MyLib.* 放入 MyApp 文件夹的情况和将 MyLib.dll 放入公共文件夹的情况之间的注册表文件。除了我试图在 HKCR\Wow6432nodes\CLSID{MYCLSID}\InprocServer32 下注册的类的 CodeBase 之外，我看不到任何区别。我不明白的另一件事是在这两种情况下，在 HKCR\Wow6432nodes\CLSID{MYCLSID} 下都没有名为 TypeLib 的子键，

我不完全了解 COM 参考如何用于 Access 应用程序，所以如果我错了，请纠正我。谁能告诉我我做错了什么？注册共享 COM dll 的正确方法是什么（是否将 dll 和 tlb 都放入共享文件夹）？谢谢！

更新：

关于 COM 注册，我使用 WIX 创建 Windows 安装程序和 heat.exe 从 dll 和 tlb 文件中获取信息。生成的文件包括Class、ProgID、TypeLib 和Registry 标签的信息。正如我所提到的，从 WIX 配置的角度来看，我的两种情况之间的唯一区别是我放置 MyLib.dll 文件的位置（我假设将 MyLib.tlb 文件放在 MyApp 安装文件夹中是正确的方法，再次，请更正如果我错了），当我将 dll 和 tlb 文件都放入应用程序的安装文件夹时，它确实有效。这是注册后的一些注册表结构

首先我有 HKCR\CLSID\{MYCLSIDs}，它们中的每一个都代表我的一个 COM 类。在名为“InprocServer32”的子项中，我有 Assembly、Class、CodeBase、RuntimeVersion、threadingModel。CodeBase要么是普通文件夹（不工作）要么是MyApp的安装文件夹（工作），这是我放置dll的不同位置。我认为 {MYCLSIDs} 下会有另一个子键 TypeLib，因为 Access 只看到 TypeLib，我认为应该有一些从 TypeLib 到实际 dll 的链接，但是，在这两种情况下，这个子键都丢失了，但在第二种情况它仍然有效。它有问题吗？

其次我有 HKLM\Software\Classes\CLSID\{MYCLSIDs}，这个键的结构和上面描述的一样。

第三，HKCR\{MYPROGIDs}，这些只是我班级的 ProgID

第四，HKCR\Typelib\{LibID}，包含来自tlb文件的信息，这个ID来自COM组件项目的Assembly GUID。

最后是 HKEY_CLASSES_ROOT\Interface\{InterfaceID}，有一个名为 ProxyStubClsid32 的子键，其值为 {00020424-0000-0000-C000-000000000046}，一个名为 TypeLib 的子键，其值为我的 LibID。

似乎唯一的区别是第一项中的 CodeBase（我可能是错的，但这就是我所看到的）。如果您发现任何问题，请告诉我。谢谢！

第二次更新：

将 MyLib.dll 安装到共享文件夹后，COM 调用失败。但是，如果我将 SHARED_FOLDER\MyLib.dll 的所有 CodeBase 值替换为 INSTALLDIR\MyLib.dll，并将 MyLib.dll 复制到 INSTALLDIR，它实际上可以工作。反之亦然，在我将 MyLib.dll 安装到 INSTALLDIR 后（在这种情况下 COM 正在工作），我将 CodeBase 值从 INSTALLDIR\MyLib.dll 更改为 SHARED_FOLDER\MyLib.dll，并复制到 SHARED_FOLDER，这次它失败了。所以看来，正是安装位置的问题，和我对COM的理解相反。而且我认为 SHARED_FOLDER 没有权限问题（我可能是错的），因为它位于我的安装程序创建的文件夹中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T06:31:54.327

> 我不完全了解 COM 参考对 Access 应用程序的工作原理，

com 对象在 windows 上的工作方式与 1990 年出现这种东西以来是一样的。所以我们谈论的是一种肉和土豆的支柱或技术，它已经存在了 22 年（而且早在 .net 中如何创建对象之前就已经存在了）。

因此，对于 Access、Delphi、FoxPro 或 VB6 或任何能够使用 com 对象的系统，com 的工作方式都是相同的。

接下来重要的是要记住，对于此类 com 对象，计算机上此类对象的注册表本质上是 GLOBAL。

与 .net 中放置在同一文件夹中的对象的动态链接概念没有任何关系。

所以way.net 的工作方式不需要全局注册（实际上你不需要任何注册！）。

但是，在.net 中，您可以根据需要在全局程序集中注册一个对象（GAC）。所以这是您的选择，但这样的选择不是标准的 windows com 对象，而是 .net 对象的选择。因此，那些.net 对象与我们 22 年来拥有的标准 windows com 对象几乎没有任何关系。

所以 .net 中的大多数对象实际上是 dir 的本地对象，但这不是标准窗口 com 对象的选择。

因此，要将 .net 对象或程序集正确转换为可用且工作的 windows com 对象，则该对象必须将 GLOBAL 注册到计算机。这意味着您不使用 regsvr32，但实际上将使用名为 regasm 的 .net 注册工具（实际上，在为您构建 com 对象桥之后，它最终会为您执行 regsvr32）。另请记住，您需要在此处编译正确的位版本。

如果您部署到其他计算机，则将您的项目设置为生成 2.0 对象，这样您就很有可能在目标计算机上安装了 .net 库。因此，在部署期间，您必须使用 regasm：

这个：C:\Windows\Microsoft.NET\Framework\v2.0.50727\RegAsm.exe

最重要的是不要忘记将 /codebase 添加到 regasm.exe 的命令行使用中，因为您必须在 GAC（全局程序集缓存）中注册 .net 对象。如果您不这样做，那么支持 windows com 对象的非 .net 应用程序将看不到 noir 能够将程序集用作标准 windows com 对象。

因此，在谈论非 .net 对象时，没有注册 ActiveX 的概念或通常在文件夹基础上称为 windows com 对象的概念——它本质上总是全局的。

因此，将 .dll 放入哪个目录或文件夹尚无定论。正确注册该 .dll 后，所有支持 com 对象的系统都可以使用它。

这也意味着在 .net 中的注册过程中，您必须使用全局程序集注册表选项（否则它将不起作用）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-01T12:50:55.670

原来，MyLib.dll 正在使用一些其他的库，这些库仍然安装在 MyApp 安装文件夹中。因此，如果 MyLib.dll 安装在共享文件夹中，它会尝试在相同的库中查找这些库，这当然会失败。当我也将这些库安装在共享文件夹中时，它正在工作。

顺便说一句，我发现 fulogvw.exe 在跟踪程序集加载问题时非常有用。例如，在我的失败日志中，它说无法在 SHARED_FOLDER 中加载文件 xxx.dll，xxx.dll 是 MyLib.dll 正在使用的某个库，我不知道 MyLib.dll 需要它，直到我看到日志。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-30T15:09:25.653

我遇到了同样的问题，尝试了所有建议，但没有任何效果。然后我决定使用`/reg`标志`regasm`来寻找线索，这让我发现了原因——我的 .net 程序集版本增加了，所以当它注册时，在注册表中创建了新的分支，并且一定发生了一些损坏同时。

这也意味着我无法回滚到以前的工作版本，`tlb`因为注册表总是会尝试使用最新的。

解决此问题的两种方法是从分支中手动删除所有恶意注册表项`CLSID`，将程序集的版本号重置为以前的编号，重新构建并重新注册。

或者，在我的情况下，更简单的方法 - 刷新 .net 程序集中的所有互操作指南。只需为每个类和接口以及程序集本身创建新的。然后重建，并使用 regasm 重新注册 tlb，dll 现在有效地成为具有新注册表项的新库。
显然，然后需要删除并阅读 VB6 中的引用，以便将其视为一个新库，然后一切正常。

# php - 使用ajax将vars发送到php

> ID：11673879
> 
> 赞同：0
> 
> 时间：2012-07-26T16:31:35.220
> 
> 标签：php, ajax

我不能用这个函数用ajax把变量发送到php，但我可以用一个简单的帖子直接把它们发送到php并将它们插入mysql。

我已经用 php 和典型的向 php 文件提交表单操作对其进行了测试，并且工作正常。我不知道我错过了什么。提前致谢。此致

```
<form class="largeform" id="editform" name="editform" accept-charset="utf-8"      action=""  onsubmit="enviarDatosEmpleado(); return false"> 
```

任何想法？// JavaScript 文档函数 objetoAjax(){

```
var xmlhttp=false;

try {

xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");

} catch (e) {

try {

xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");

} catch (E) {

xmlhttp = false;

}

}
if (!xmlhttp && typeof XMLHttpRequest!='undefined') {

 xmlhttp = new XMLHttpRequest();

 }

  return xmlhttp;

  }
  function enviarDatos(){

 //donde se mostrará lo resultados

  divresultado = document.getElementById('resultado');

  //valores de los inputs

  post_title=document.editform.post_title.value;

  post_metad=document.editform.post_metad.value;

  post_metak=document.editform.post_metak.value;

  post_special=document.editform.post_special.value;

  post_content=document.editform.post_content.value;

  post_private=document.editform.post_private.value;

  post_parent=document.editform.post_parent.value;

  post_template=document.editform.post_template.value;

  post_id=document.editform.post_id.value;

  post_menu=document.editform.post_menu.value;

  post_menu_order=document.editform.post_menu_order.value;

  //instanciamos el objetoAjax

   ajax=objetoAjax();

   //uso del medotod POST

   //archivo que realizará la operacion

  //registro.php

  ajax.open("POST", "insert.php",true);

  ajax.onreadystatechange=function() {

  if (ajax.readyState==4) {

  //mostrar resultados en esta capa

  divresultado.innerHTML = ajax.responseText
  divresultado.innerHTML = "ok";
  divresultado.style.display="block";

  //llamar a funcion para limpiar los inputs

   LimpiarCampos();

  }

  }

  ajax.setRequestHeader("Content-Type","application/x-www-form-urlencoded");

  //enviando los valores

   ajax.send                 ("post_title="+post_title+"&post_metad="+post_metad+"&post_metak="+post_metak+"&post_special="+post_special+"&post_content="+post_content+"&post_private="+post_private+"&post_parent="+post_parent+"&post_template="+post_template+"&post_id="+post_id+"&post_menu="+post_menu+"&post_menu_order="+post_menu_order)
 // ajax.send("nombres="+nom+"&departamento="+dep+"&sueldo="+suel)

  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:37:40.980

尝试使用 jQuery：

```
$.post("insert.php", {
    var: value,
    var2: value2
}, function(responseText) {
    $("#resultado").html(responseText);
}); 
```

确保包含 jQuery 库。仅供参考，您无需提前设置连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:41:03.523

您没有正确引用表单的 DOM 元素。

您需要执行以下操作：

```
document.getElementById('idOfFormElement').value 
```

同样正如一位评论者所提到的，您应该真正熟悉像 jQuery 这样的框架，这使得使用 ajax 变得更加容易（并且更符合跨浏览器）

# android - 缩放、裁剪和保存照片

> ID：11673880
> 
> 赞同：1
> 
> 时间：2012-07-26T16:31:45.557
> 
> 标签：android, image, zooming, crop

我想拍照、缩放、裁剪并将其保存到文件系统。对于缩放，我使用[如何获得图像缩放功能中的 TouchImageView (extends ImageView)？](https://stackoverflow.com/questions/2537238/how-can-i-get-zoom-functionality-for-images)但我不明白如何在缩放后获得位图。我尝试了 getDrawable() 和 getDrawingCache() 但它们返回完整图像，而不是裁剪。

# c++ - 几何着色器和深度 FBO

> ID：11673884
> 
> 赞同：3
> 
> 时间：2012-07-26T16:31:56.167
> 
> 标签：c++, opengl, glsl, fbo, geometry-shader

当涉及几何着色器时，是否有关于渲染到 FBO 的特殊规则？

上下文：我正在尝试在场景中实现阴影映射，其中包括以不同方式渲染的不同类型的对象：网格，通过 VBO 和着色器以标准方式渲染 Point sprite 粒子，使用顶点和片段着色器 Quad 粒子渲染，作为点发送，但在几何着色器中扩展为四边形

我正在以标准方式进行阴影映射，这涉及创建深度 FBO 并从灯光的角度向其渲染对象的深度。网格和点精灵工作正常，但几何着色器四边形粒子的深度没有被渲染到 FBO。

[这](http://i.imgur.com/hxpVE.png "这里")是标准（非 FBO）深度缓冲区。注意前景中的大圆形颗粒。

[这](http://i.imgur.com/IJlXp.png)是呈现给 FBO 的相同视图。请注意，仅绘制了网格和点精灵粒子的深度。

我的 FBO 设置如下（它基于 OpenGL 4 Shading Language Cookbook 的第 7 章）：

```
const bool Renderer::generateShadowMap(FBO & f, string & error) {
  uint depthTexID;
  uint width = f.getWidth();
  uint height = f.getHeight();
  glGenTextures(1, &depthTexID);
  glBindTexture(GL_TEXTURE_2D, depthTexID);
  glTexImage2D( GL_TEXTURE_2D,  0,       GL_DEPTH_COMPONENT,
  width,        height, 0,
  GL_DEPTH_COMPONENT, GL_FLOAT, NULL);
  float border[] = {1.0, 0.0, 0.0, 0.0};
  glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
  glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
  glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_BORDER);
  glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_BORDER);
  glTexParameterfv(GL_TEXTURE_2D, GL_TEXTURE_BORDER_COLOR, border);
  glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_COMPARE_MODE,
    GL_COMPARE_REF_TO_TEXTURE);
  glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_COMPARE_FUNC, GL_LESS);
  glActiveTexture(GL_TEXTURE1);
  glBindTexture(GL_TEXTURE_2D, depthTexID);
  uint fID;
  glGenFramebuffers(1, &fID);
  glBindFramebuffer(GL_FRAMEBUFFER, fID);
  glFramebufferTexture2D(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_TEXTURE_2D,             
    depthTexID, 0);
  glDrawBuffer(GL_NONE);
  if(!checkFBOstatus(error)) {
        cerr << error << endl;
           return false;
  }
  glClearDepth(1.0);
  glClear(GL_DEPTH_BUFFER_BIT);
  glBindFramebuffer(GL_FRAMEBUFFER, 0);
  glActiveTexture(GL_TEXTURE0);
  f.setFBOID(fID);
  f.setTexID(depthTexID);
  return true;
} 
```

应该渲染四边形粒子深度的着色器是：

```
//VERTEX SHADER
#version 400
in vec3 aPosition;
in float aSize;
out float gSize;
uniform mat4 vWorldView;
void main() {
  gSize = aSize;
  vec4 v4Vertex = vec4(aPosition.xyz, 1.0);
  vec4 transformedVertex = vWorldView * v4Vertex;
   gl_Position = transformedVertex;
}
//GEOMETRY SHADER
#version 400
layout (points) in;
layout (triangle_strip, max_vertices = 4) out;
in float gSize[1];
uniform mat4 vgProjection;
void main() {
 vec4 oPosition;

  float halfSize = gSize[0] * 0.5;
  oPosition = (vec4(-halfSize, -halfSize, 0.0, 0.0) + gl_in[0].gl_Position);
  gl_Position = vgProjection * oPosition;
  EmitVertex();

  oPosition = (vec4(halfSize, -halfSize, 0.0, 0.0) + gl_in[0].gl_Position);
  gl_Position = vgProjection * oPosition;
  EmitVertex();

  oPosition = (vec4(-halfSize, halfSize, 0.0, 0.0) + gl_in[0].gl_Position);
  gl_Position = vgProjection * oPosition;
  EmitVertex();

  oPosition = (vec4(halfSize, halfSize, 0.0, 0.0) + gl_in[0].gl_Position);
  gl_Position = vgProjection * oPosition;
  EmitVertex();

    EndPrimitive();
}
//FRAGMENT SHADER - empty as depth should be written automatically
#version 400
void main() {
} 
```

当然，深度测试是启用的。我已经通过 gDebugger 运行它，它根本无法检测到任何错误。我已经尝试告诉片段着色器实际绘制东西，但这也没有什么区别（没有尝试将不同的值写入 gl_FragDepth）。

点精灵粒子和四边形粒子之间的唯一区别是几何着色器的使用。我正在同时渲染两者并使用相同的统一值（相同的转换矩阵），并且我已经运行 gDebugger 来确保。

我已经在一台装有驱动程序版本 8.17.13.142 的 nVidia GTX 560 Ti 和另一台装有 Radeon Mobility HD 5650 的计算机上对此进行了测试。我在两者上都得到了相同的结果。

我是否犯了任何明显的错误，或者我应该知道一些具体的事情？

# hadoop - 如何在 Hive 中使用索引？

> ID：11673887
> 
> 赞同：4
> 
> 时间：2012-07-26T16:31:59.933
> 
> 标签：hadoop, indexing, hive

我编写了一个**自定义索引处理程序**并想对其进行测试。但是 hive 没有使用它。所以我检查了`(pokes (int foo, string bar))`带有配置单元分布的简单表以进行测试。然后我创建了一个紧凑的索引并设置了`set hive.optimize.index.filter=true;`但是，在检查日志信息后，似乎 hive 仍然没有使用索引。那么，问题是什么？我发出的查询是，`select foo from pokes WHERE foo=498`

以下是我发出查询后得到的日志信息。

```
12/07/26 12:25:17 INFO index.IndexWhereProcessor: Processing predicate for index optimization
12/07/26 12:25:17 INFO index.IndexWhereProcessor: (foo = 498) 

12/07/26 12:25:17 INFO metastore.HiveMetaStore: 0: get_table : db=default tbl=pokes_idx

12/07/26 12:25:17 INFO hive.log: DDL: struct pokes_idx { i32 foo, string _bucketname, list<i64> _offsets}
12/07/26 12:25:17 INFO index.IndexWhereProcessor: checking index staleness...  
12/07/26 12:25:17 INFO index.IndexWhereProcessor: 1342465077455

12/07/26 12:25:17 INFO index.IndexWhereProcessor: 1342465077455

12/07/26 12:25:17 INFO util.NativeCodeLoader: Loaded the native-hadoop library

12/07/26 12:25:17 WARN snappy.LoadSnappy: Snappy native library not loaded 
```

# python - 登录 Steam 网站

> ID：11673888
> 
> 赞同：0
> 
> 时间：2012-07-26T16:32:01.080
> 
> 标签：python, mechanize, python-requests, browser-automation, steam

我正在寻找一个脚本来登录 SteamPowered.com 网站，然后导航到帐户页面。我编写了一个脚本，该脚本从该页面获取销售额并将其加起来。问题是我必须手动将 HTML 保存到文件中，然后打开该文件。我试图这样做，`requests`但我认为 Steam 使用 OpenID 或类似的东西，我无法登录。然后我看了看，`mechanize`但由于验证码，我无法通过登录屏幕，尽我所能告诉。

**使用 Python 登录 Steam 网站需要采取哪些必要步骤？**

如果您有兴趣，这里是总销售柜台。不过这是较早的版本，因此如果系统上的销售额少于 6 个，则需要处理索引错误，并且您将无法验证总销售额。[http://pastebin.com/3CXBJUGe](http://pastebin.com/3CXBJUGe)

* * *

**更新**：我开始使用 Selenium，除非我让它在我当前打开的浏览器中打开一个新标签，否则它会弹出要求用户输入 Steam 发送到他们电子邮件的代码。我认为这比像以前那样向用户询问他们的购买历史页面要困难得多。

这是硒代码。它使用硬编码的 Xpath，因此您可能想要更改它。

```
import os
from selenium import webdriver

chromedriver = "path\to\chromedriver.exe"
os.environ["webdriver.chrome.driver"] = chromedriver
driver = webdriver.Chrome(chromedriver)
url = r'https://store.steampowered.com/login/'
driver.get(url)

xpath = r'//*[@id="login_btn_signin"]/a'

INuser = driver.find_element_by_id('input_username')
INpass = driver.find_element_by_id('input_password')
LOGbtn = driver.find_element_by_xpath(xpath)

#put in the user and pass into the 2 above elements, then click the last one

driver.quit() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T07:39:22.477

你在为 Steam 工作吗？或者，您只是想使网站自动化？[验证码](http://en.wikipedia.org/wiki/CAPTCHA)的关键在于它只能由人类来解决。

# javascript - 从弹出窗口打印图像

> ID：11673890
> 
> 赞同：0
> 
> 时间：2012-07-26T16:32:05.747
> 
> 标签：javascript, jquery, html, printing

我正在尝试在引导模式中显示一张图像，该弹出窗口也有一个打印按钮，因此我需要打印该图像，该图像显示在弹出窗口中。

```
<script type="text/javascript">    
   function code(){    
     $("#qbody").html("<p align='center'><img 
     src='http://chart.apis.google.com/chart?
     cht=qr&chs=300x300&chl=code&chld=H|0'/></p>");  
   }  
</script>  
<div class="modal fade">
  <div class="modal-body" id="qbody">
   <a href='#' class='btn btn-primary pull-left'
   onClick='window.print();'>Save</a>"
  </div> 
</div> 
```

但是在这里我单击整个页面将作为打印的保存按钮，而不是使用该弹出窗口图像。这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:38:40.920

为打印媒体使用自定义 css

```
@media print{
   body{
     visibility: hidden;
   }
  .to-print{
     visibility: visible;
     position: absolute;
     top: 0;
     left: 0;
   }
} 
```

现在将类添加`.to-print`到要打印的 div 中，在您的情况下进行`img`标记。

在[jsfiddle上查看](http://jsfiddle.net/sarowar/3Cxky/) *（它不使用模态窗口，直接加载）*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:39:24.537

打印功能不会截取屏幕截图并将其打印出来。如果您希望能够在模态窗口中打印项目，那么您将需要使用[`print`](https://developer.mozilla.org/en/Printing)CSS 样式表并将可见性指定为所需元素`display:block;`或`visibility:visible;`为所需元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:42:05.133

试试这个。如下所示，无论您想打印什么，都将其包装在一个 div 标记中，其 id 为“printme”（或您喜欢的任何内容）。

```
#printme { display: none; }

@media print
{

    #printme { display: block; }
}
</style> 
```

```
<div id="printme">
   your image goes here
</div> 
```

# iphone - 应用程序状态更改时禁用 UI 的标准方法

> ID：11673895
> 
> 赞同：0
> 
> 时间：2012-07-26T16:32:49.090
> 
> 标签：iphone, ios, user-experience, external-accessory

我有一个 iOS 应用程序，它与通过坞站连接器连接的外部附件一起工作。在使用应用程序期间，设备可能会断开连接。

我们有一个使用相同设备的 Windows 应用程序，并且当发生类似情况时，在部分不透明的白色背景上显示“设备已断开连接”（因此视图仍然显示）。当设备重新插入时，消息消失。

这样的方法在 iOS 上是否合适，或者是否有处理这种情况的标准方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:50:53.607

如果应用程序在没有连接设备的情况下无法运行，我看不出为什么 Apple 会反对警告并阻止 UI。

我不会完全阻止**静态**UI，以免给人以挂起应用程序的印象。您可以添加一些简单的动画或添加`info`按钮来避免它。

有两种选择：

1.  对于单窗口应用程序来说很简单，有点脏，实现起来非常快：

    > 在应用程序上添加拦截器视图`key window`

2.  不依赖于 Windows 的使用，干净，不那么快，可能很难保持井井有条

    > 使用此类功能分别扩展您的导航视图控制器（UINavigation 控制器或 UITabBarController）或每个视图控制器。

# html - 防止Visual Studio在格式化代码时删除cshtml中的回车

> ID：11673900
> 
> 赞同：0
> 
> 时间：2012-07-26T16:33:13.130
> 
> 标签：html, visual-studio-2010, razor, formatting

当我尝试用visual studio格式化cshtml文档的代码时，很多回车被删除了。

例如，这段代码：

```
 <div class="float-left">
     @Html.LabelFor(model => model.StartDate)
  </div>

  <div class="float-left" style="margin-left: 10px; margin-top: 5px; margin-right: 30px;">
     @Html.EditorFor(model => model.StartDate)
  </div> 
```

当我执行visual studio的格式命令时更改为：

```
<div class="float-left">
     @Html.LabelFor(model => model.StartDate)
  </div>
  <div class="float-left" style="margin-left: 10px; margin-top: 5px; margin-right: 30px;">
     @Html.EditorFor(model => model.StartDate)
  </div> 
```

请注意，两个 div 之间不再有空行。

是否可以防止视觉工作室删除回车？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:41:09.030

在 下`Tools > Options > Text Editor > HTML > Formatting`，有一个标记为`Tag Specific Options...` Here 您将找到 HTML 标记和 ASP.NET 控件的许多选项的按钮。由于 Razor 只是带有一些额外语法糖的 HTML，因此 HTML 设置应该控制格式。

例如，在 下`Client HTML Tags`，如果您设置`div`为 have `2 Before opening, within, and 2 after closing`for `Line Breaks`，我认为这将为您提供所需的内容。

# eclipse - Egit：将 rebase 配置为 master 分支的默认拉取策略

> ID：11673901
> 
> 赞同：7
> 
> 时间：2012-07-26T16:33:19.887
> 
> 标签：eclipse, git, egit

在我们的新项目中，我们有 10 个存储库，每个存储库都有相互依赖的 Eclipse 项目。

我计划建立一个默认工作流程，每个开发人员都在主分支上工作，并使用提交-拉-推循环。为了减少提交并获得良好的线性历史记录，我更喜欢将 rebase 作为 pull 的标准策略。这工作正常，如果`branch.master.rebase=true`设置。

不幸的是，在使用 EGit 克隆后，必须为所有存储库手动设置。我尝试了设置`branch.autosetuprebase=always`，但这仅影响手动创建的本地分支，而不影响克隆后的主分支。

我想自动化初始设置`branch.master.rebase=true`以减少错误和方便。有没有办法做到这一点？最好在 Eclipse/Egit 内部，但也欢迎其他想法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-04-16T18:30:19.070

正如 Ozan 对他们原始问题的回答所提到的，正确的解决方案是添加

```
[branch]
    autosetuprebase=always 
```

在`.gitconfig`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-09-21T17:12:55.717

如果您想在 Eclipse GUI 中进行此更改

1.  在 Eclipse 中打开 Git 透视图。
2.  扩展您的存储库、分支、本地。
3.  右键单击您的分支，然后单击“配置分支”。
4.  检查“变基”。
5.  单击确定。对推到原点的其余分支执行此操作。

# jquery - 使用 Jquery 将 XML 转换为 HTML 表时遇到问题

> ID：11673902
> 
> 赞同：0
> 
> 时间：2012-07-26T16:33:21.733
> 
> 标签：jquery, html, xml, xml-parsing

我知道还有很多其他问题涉及这个主题，但没有一个专门解决我的问题。

我正在获取一个 XML 文件，使用 Jquery 对其进行解析并将其转换为 HTML 表。在页面视觉上，它看起来不错；桌子看起来应该。但实际上，Jquery 正在对 html 做一些奇怪的事情。

这是 XML：

```
<?xml version="1.0" encoding="us-ascii"?>
<wsmenu>
<cat id="snacks">
    <item>
        <desc>marta&#8217;s fresh tortillas &amp; camp bread, pit master fat</desc>
        <price>4</price>
        <wood>m</wood>
    </item>
    <item>
        <desc>smoked almonds, chile salt</desc>
        <price>4</price>
        <wood>h</wood>
    </item>
    <item>
        <desc>smoked marinated olives</desc>
        <price>4</price>
        <wood>o</wood>
    </item>
    <item>
        <desc>crispy potatoes, smoked garlic aioli</desc>
        <price>6</price>
        <wood>h</wood>
    </item>
    <item>
        <desc>smoked artichokes, lemon and parmesan</desc>
        <price>9</price>
        <wood>h</wood>
    </item>
    <item>
        <desc>smoked hummus, pit master fat camp bread &amp; tortilla chips</desc>
        <price>8</price>
        <wood>m</wood>
    </item>
    <item>
        <desc>smoked whitefish dip, fresh tortilla chips</desc>
        <price>9</price>
        <wood>o</wood>
    </item>
</cat>
<cat id="salads">
    <item>
        <desc>smoked chicory, chicken chicharron, mustard-red wine vinaigrette, provolone</desc>
        <price>8</price>
        <wood>m</wood>
    </item>
    <item>
        <desc>3 kale salad, celery greens, guanciale, smoked pepita, manchego</desc>
        <price>8</price>
        <wood>m</wood>
    </item>
    <item>
        <desc>hickory braised spelt, smoked almond pesto &amp; tomato</desc>
        <price>8</price>
        <wood>h</wood>
    </item>
    <item>
        <desc>beet and fresh ricotta salad, smoked pistachios</desc>
        <price>8</price>
        <wood>m</wood>
    </item>
</cat>
<cat id="sandwiches">
    <item>
        <desc>pulled pork, bbq, house cole slaw, mustard &amp; pickles</desc>
        <price>8</price>
        <wood>o</wood>
    </item>
    <item>
        <desc>chopped beef, house mustard &amp; pickles</desc>
        <price>8</price>
        <wood>h</wood>
    </item>
    <item>
        <desc>woodshed burger, chopped beef, todays sausage, smoked cheddar, traditional garnish</desc>
        <price>11</price>
        <wood>h</wood>
    </item>
</cat>
<cat id="simple plates">
    <item>
        <desc>brisket stuffed piquillo peppers, bone broth &amp; cotija</desc>
        <price>9</price>
        <wood>h</wood>
    </item>
    <item>
        <desc>local acorn squash, tuaca, dark brown sugar, smoked pepper hollandaise</desc>
        <price>8</price>
        <wood>h</wood>
    </item>
    <item>
        <desc>today&#8217;s sausage, house mustard &amp; pickles</desc>
        <price>8</price>
        <wood>h</wood>
    </item>
    <item>
        <desc>pea tendrils, smoked chilies, citrus &amp; hickory butter</desc>
        <price>8</price>
        <wood>o</wood>
    </item>
</cat>
<cat id="tacos">
    <item>
        <desc>brisket stuffed piquillo peppers, bone broth &amp; cotija</desc>
        <price>9</price>
        <wood>m</wood>
    </item>
    <item>
        <desc>local acorn squash, tuaca, dark brown sugar, smoked pepper hollandaise</desc>
        <price>9</price>
        <wood>m</wood>
    </item>
    <item>
        <desc>today&#8217;s sausage, house mustard &amp; pickles</desc>
        <price>10</price>
        <wood>h</wood>
    </item>
    <item>
        <desc>pea tendrils, smoked chilies, citrus &amp; hickory butter</desc>
        <price>9</price>
        <wood>m</wood>
    </item>
</cat>
<cat id="traditional q">
    <item>
        <desc>beef ribs</desc>
        <price>12/lb</price>
        <wood>o</wood>
    </item>
    <item>
        <desc>pork ribs</desc>
        <price>12/lb</price>
        <wood>p</wood>
    </item>
    <item>
        <desc>smoked beef tenderloin</desc>
        <sub>served cold</sub>
        <price>11</price>
        <wood>h</wood>
    </item>
</cat>
<cat id="new q">
    <item>
        <desc>smoked red fish enpapillote, vegetables of the season</desc>
        <price>19</price>
        <wood>o</wood>
    </item>
    <item>
        <desc>game bird, wood braised spelt &amp; smoked artichokes</desc>
        <price>21</price>
        <wood>h</wood>
    </item>
    <item>
        <desc>fancy mushrooms of the season, 4 chiles, polenta, vin cotta &amp; hen egg</desc>
        <price>18</price>
        <wood>h</wood>
    </item>
    <item>
        <desc>bowl of ramen noodles, bone broth, pulled pork, chiles, &amp; quail egg</desc>
        <price>15</price>
        <wood>p</wood>
    </item>
</cat>
<cat id="dining with friends">
    <sub>please allow 30 minutes, feeds 4 people</sub>
    <item>
        <desc>16 hour smoked beef shin, fresh ricotta, chile, smoked oil borracho beans, 3 kale salad</desc>
        <price>75</price>
        <wood>h</wood>
    </item>
    <item>
        <desc>open fire paella of mussels, clams, shrimp rabbit-rattlesnake sausage, game bird, fennel aioli</desc>
        <price>75</price>
        <wood>m</wood>
    </item>
    <item>
        <desc>60 oz. bistecca alla fiorentina, crispy potatoes</desc>
        <price>90</price>
        <wood>m</wood>
    </item>
</cat>
<cat id="sides">
    <item>
        <desc>fresh chips</desc>
        <price>5</price>
        <wood>m</wood>
    </item>
    <item>
        <desc>smoked Loaded baked potato</desc>
        <sub>add pork or beef $3</sub>
        <price>5</price>
        <wood>h</wood>
    </item>
    <item>
        <desc>borracho beans</desc>
        <price>5</price>
        <wood>h</wood>
    </item>
    <item>
        <desc>mexican corn</desc>
        <price>4</price>
        <wood>m</wood>
    </item>
    <item>
        <desc>confit potato salad, mint, red pepper, crispy garlic</desc>
        <price>4</price>
        <wood>m</wood>
    </item>
</cat>
</wsmenu> 
```

这是Jquery：

```
function parseXML(xml){
$(xml).find("cat").each(function()
{
  $(".menu").append("<table class='mnutbl'><tr><th>"+$(this).attr("id")+"</th></tr>");

$(this).find("item").each(function()
{
    $(".menu").append("<tr class='mnutbl'><td>"+$(this).find("wood").text()+
    "</td><td>"+$(this).find("desc").text()+
    "</a></td><td>"+$(this).find("price").text()+
    "</td></tr></table>")});
});
}; 
```

电流输出：

```
Jquery is writing <table> and <th> with attribute "id" for each <cat> tag, then separate <tr> for each <item> tag (these <tr>'s are NOT contained in the <table>), like so:
<table class="mnutbl">
 <tr>
  <th>Snacks</th>
 </tr>
</table>
<tr>
 <td>m</td>
 <td>marta's fresh...</td>
 <td>4</td>
</tr>
etc....... 
```

两部分问题：

1.  每个`<cat>`标签都需要是它自己的`<table>`，并且每个`<item>`标签中的标签都`<cat>`需要是其中的表行`<table>`。我的 Jquery 代码有问题吗？

2.  一些`<desc>`值需要是图像的链接，但不是全部。如果我`<imgurl>`只添加到 XML 文件中的一些标签，我怎么能正确地将它作为使用 Jquery`<item>`写入表中？`<a href="...>`

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:37:58.837

`</table>`从您的内部删除最后一个`$(".menu").append`，并将其添加到外部。JQuery 的 append 将元素相互放置 - 因此将格式良好的表格行放入格式良好的表格中是有意义的，而不是尝试用每个表格行关闭表格。

另外，保持对表的引用如下：function parseXML(xml){

```
$(xml).find("cat").each(function() {
  var table = $("<table class='mnutbl'><tr><th>"+$(this).attr("id")+
    "</th></tr></table>");
  $(".menu").append(table);

  $(this).find("item").each(function(){
    table.append("<tr class='mnutbl'><td>"+$(this).find("wood").text()+
      "</td><td>"+$(this).find("desc").text()+
      "</a></td><td>"+$(this).find("price").text()+
      "</td></tr>")});
  });
}; 
```

然后浏览器添加所有额外的 table-start-tags 来补偿。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T16:38:34.507

您不是将表格行附加到表格，而是附加到`.menu`. 试试这个：

```
$(".menu").find('table').last().append("<tr ..... "); 
```

[http://jsfiddle.net/mblase75/fppfX/](http://jsfiddle.net/mblase75/fppfX/)

吐槽西也说得对，不过。不要附加结束`</table>`标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:42:02.260

您总是在追加，`.menu`但您必须将项目追加到表中。为此，请为表提供一个 ID 以对其进行识别。或者更简单：将其存储到一个变量中，首先附加所有行，然后将整个表附加到页面。

```
function parseXML( xml ) {
    $( xml ).find( 'cat' ).each( function() {
        var id = $( this ).attr( 'id' );
        var table = $( '<table class="mnutbl" id="' + id  + '"><tr><th>' + id  + '</th></tr></table>' );

        $( this ).find( 'item' ).each( function() {
            table.append( '<tr><td>' +
                $( this ).find('wood').text() +
                '</td><td>' + $( this ).find( 'desc' ).text() +
                '</a></td><td>' + $( this ).find( 'price' ).text() +
                '</td></tr>' );
        } );

        $( '.menu' ).append( table );
    } );
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T16:43:21.317

这个问题的一个更好的解决方案是使用 XSL 转换 (XSLT)，这是一种专门为像这样的任务创建的语言。

转换背后的语言和逻辑非常简单易学。你可以在这里查看：http: [//www.w3schools.com/xsl/](http://www.w3schools.com/xsl/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T16:45:01.013

我在您的代码中看到的问题是，最初您在搜索“item”标签时关闭了表格标签。

```
function parseXML(xml){
$(xml).find("cat").each(function()
{
  $(".menu").append("<table class='mnutbl'><tr><th>"+$(this).attr("id")+"</th></tr>");

$(this).find("item").each(function()
{
    $(".menu").append("<tr class='mnutbl'><td>"+$(this).find("wood").text()+
        "</td><td>"+$(this).find("desc").text()+
        "</a></td><td>"+$(this).find("price").text()+
        "</td></tr>")});
    });
$(".menu").append("</table>"); 
```

};

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-26T21:53:17.780

我实际上回答了我问题的第二部分。

使用相同的 XML 文件，只是这次一些`<item>`标签现在有一个属性，`imgurl=""`该属性包含一个照片的相对 url。

我更改了我的 JQuery 函数`parseXML`以包含一个检查属性是否`imgurl`存在的条件，然后围绕项目描述创建指向它的链接

这是代码：

```
function parseXML(xml){
$(xml).find("cat").each(function()
{
$(".menu").append("<table class='mnutbl'><tr><th>"+$(this).attr("id")+"</th></tr>");

$(this).find("item").each(function()
{
    var $x;
    var $image = $(this).attr("imgurl");
    if ($image == null) {
        $x = $(this).find("desc").text();
    }
    else {
        $x = "<a href='"+$image+"'>"+$(this).find("desc").text()+"</a>"
    }
    $(".menu").find("table").last().append("<tr><td>"+$(this).find("wood").text()+
    "</td><td>"+$x+"</td><td>"+$(this).find("price").text()+
    "</td></tr>")
});
$(".menu").append("</table>");
});
}; 
```

我为自己感到非常自豪，因为我对这个级别的编程仍然很陌生（这对你们大多数人来说可能是非常基础的），而且我通过 w3c 和 jQuery 网站参考自己设法做到了这一切。

# python - Python 新手：有人知道 __init__(self) 做什么吗？（请简单解释！）

> ID：11673906
> 
> 赞同：3
> 
> 时间：2012-07-26T16:33:43.547
> 
> 标签：python, init, self

> **可能重复：**
> [Python **init**和 self 他们做了什么？](https://stackoverflow.com/questions/625083/python-init-and-self-what-do-they-do)

谁能解释一下是什么`__init__(self)`？我一直在阅读其他问题和提到超级课程的人？什么是超级班？我认为程序应该从

```
def print_word(word):
    print word 
```

是`__init__(self)`某种特殊情况，因为它有下划线和“自我”吗？抱歉缺少具体的术语……仍在学习中。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-26T16:35:06.530

`__init__(self)`是在所谓的“类”中使用的特殊功能。[类](http://docs.python.org/tutorial/classes.html)允许您定义自己的数据类型/对象，并且`__init__`在您创建已定义的数据类型/对象的新实例时调用此函数。这就像说“嘿，每次你做这些事情时，确保你也运行这个代码”。在面向对象编程中，我们称这种函数为“构造函数”。这是一个用于“构造”新对象的函数。是对实际创建的`self`对象的引用。换句话说，从技术上讲，在您使用`__init__`函数时，该对象已经创建。`__init__`只是让您有机会初始化对象的各个方面（因此名称为`__init__`）。

Python 是函数式、过程式和面向对象范式的混合体。该`__init__`业务与对象有关。有关面向对象编程的更多信息，您可以查看[wikipedia 文章](http://en.wikipedia.org/wiki/Object-oriented_programming)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T16:35:49.953

`__init__`是Python 中类的[构造函数。](https://en.wikipedia.org/wiki/Constructor_%28object-oriented_programming%29)类中用括号括起来的方法`__`具有特殊含义（构造、运算符实现等）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-26T16:59:04.110

要了解您的角色，`__init__(self, ...)`您必须先了解类。

一个类基本上定义了一种对象。例如，如果我想定义 a 的`Fish`行为方式，我可能会从以下形式开始

```
class Fish:
    def swim(self):
        print "I'm swimming!"
    def breathe(self):
        print "I'm breathing!" 
```

然而，这不是一个非常有用的类，因为虽然我们已经定义了 a `Fish`can*做什么*，但我们不知道如何存储关于 的其他基本特性`Fish`，例如它的重量。

原则上，如果我有一个`Fish`named `f`，我可以这样做

```
f.weight = 3 
```

但是，如果我忘记为某些人这样做`Fish`，比如`Fish`命名`g`，然后尝试`g.weight`在表达式中使用，Python 将不会很高兴——它会抛出一个`AttributeError`抱怨`Fish instance has no attribute 'weight'`。

为了避免这种情况，我们可以为我们的类定义一个**构造函数**，每次`Fish`创建一个新对象时，都会将其权重和颜色等属性设置为合理的默认值。在 Python 中，这个构造函数被调用`__init__`。只要在类中定义它，每次创建该类的新实例时都会调用它。

```
class Fish:
    def __init__(self):
        self.weight = 3
    def swim(self):
        print "I'm swimming!"
    def breathe(self):
        print "I'm breathing!" 
```

您为类定义的每个函数都带有一个隐含的参数，我们通常将其标记为`self`. 第一个参数始终设置为调用函数的实例。例如，如果我调用

```
f = Fish()
f.swim() 
```

Python 创建 a `Fish`，将其放入`f`，然后调用`Fish.__init__(f)`and `Fish.swim(f)`。在这种情况下，`Fish`in`f`将其权重设置为 3，并导致“我在游泳！” 要打印。

您可以创建不需要带`self`参数的类函数，称为**静态函数**，但这些函数仅适用于您可能暂时不会遇到的特定情况。Python 中的类函数通常是**实例函数**，它会`self`隐式接受参数。

请注意，在上面的示例中，*每个* `Fish`created 都将其默认权重设置为 3。如果我们想在`Fish`创建时指定 a 的权重怎么办？好吧，我们可以定义`__init__()`一些额外的参数：

```
class SuperFish:
    def __init__(self, weight = 3):
        self.weight = weight 
```

请注意，该`weight`参数的默认值定义为 3。因此，我们实际上可以选择指定权重。如果我们刚才说`def __init__(self, weight):`的是，则需要指定权重。

我们现在可以执行以下任一调用：

```
a = SuperFish() # creates a SuperFish with a weight of 3
b = SuperFish(42) # creates a SuperFish with a weight of 42
c = SuperFish(weight = 9001) # creates a SuperFish with a weight of 9001 
```

希望这可以为您解决问题:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-26T16:39:42.653

可能重复：[Python __init__ 和 self 他们做了什么？](https://stackoverflow.com/questions/625083/python-init-and-self-what-do-they-do)

`def print_word(word)`是一个函数（或方法/过程）。`__init__(self)`是在**类**中使用的函数。

关于类的 Python 教程的这一[部分](http://docs.python.org/tutorial/classes.html#class-objects)`__init__`描述了该函数。顺便说一句，我强烈建议您阅读整个页面。

`self`是任意选择一个词来指代类本身；如果你愿意，你可以使用`watermelon`. 请参阅：[自我的目的是什么？](https://stackoverflow.com/questions/2709821/python-self-explained)

用双下划线包裹的 Python 类函数具有特殊的含义。另一个例子是`__str__`。PEP8（一个重要的 Python 风格文档）的这一[部分解释了 Python 中下划线的含义。](http://www.python.org/dev/peps/pep-0008/#descriptive-naming-styles)

* * *

超类：

*   Python类教程的继承[部分](http://docs.python.org/tutorial/classes.html#inheritance)
*   [如何初始化基（超）类？](https://stackoverflow.com/questions/3694371/how-do-i-initialize-the-base-super-class-in-python)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T16:46:20.343

self 指的是对象本身，并且`__init__`是*初始化*该“自我”的字段的构造函数。例如，您正在创建一个包含字段“name”和“age”的 Person 类。在`__init__`中，您可以通过执行以下操作将默认名称设置为“Bob”并将年龄设置为 36：

```
def __init__(self):
    self._name = "Bob"
    self._age = 36 
```

这样，每次创建新的 Person 对象时，默认名称和年龄将设置为“Bob”和 36。

# ios - 主线程上的 NSOperationQueue 回调仍未正确更新 UI

> ID：11673912
> 
> 赞同：0
> 
> 时间：2012-07-26T16:34:21.367
> 
> 标签：ios, xcode, multithreading, nib

所以我有一个`UIViewController`使用`NSOperationQueue`. 起初我在使用种子数据时有注释掉的行，但现在我已经切换到使用实际服务。数据适当地到达此方法，但 UI 没有更新。然后我读到您需要在主线程上运行 UI 更新，所以我将其更改为以下代码：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    self.menuView = (MenuView*)self.view;
    [MenuUIModel loadAndOnSuccess:^(id data, id context) {
        [self.menuView performSelectorOnMainThread:@selector(bindToModel:) withObject:data waitUntilDone:YES];
        //[self.menuView bindToModel:(MenuUIModel*)data];
    } onFail:^(NSString *error, id context) {
        NSLog(@"FAIL with error: %@", error);
    }];
} 
```

这是`MenuView`，虽然略有修剪。

```
@interface MenuView : UITableView

@property (strong, nonatomic) NSArray *menuItemViews;

// Menu Item View Loading Outlet
@property (strong, nonatomic) IBOutlet MenuItemView *lastLoadedMenuItemView;

- (void) bindToModel:(MenuUIModel*)model;

@end

@implementation MenuView

- (void)bindToModel:(MenuUIModel*)model
{
    if (model) {
        NSMutableArray *mutableMenuItemViews = [NSMutableArray array];
        UINib* inMemoryNib = [UINib nibWithNibName:@"MenuItemView" bundle:nil];
        for (MenuItemUIModel *item in model.Items) {
            [inMemoryNib instantiateWithOwner:self options:nil];
            [self.lastLoadedMenuItemView bindToModel:item];
            [mutableMenuItemViews addObject:self.lastLoadedMenuItemView];
            index++;
        }
        self.menuItemViews = [[NSArray alloc] initWithArray:mutableMenuItemViews];
    }
}

@end 
```

我意识到这种加载笔尖的方法有点不同，但目的是我只将笔尖及其资源加载到内存中一次，但在必要时实例化它。它还可以与种子代码完美配合。

所以我认为在主线程上运行这个方法会起作用，但显然不是。另一个注意事项，我添加了一个测试`UILabel`，`MenuView`当我用这种方法测试它时它会完美更新。因此，当我在我的内部调用 bindToModel 时，`MenuView`它不再在主线程上运行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:47:26.117

> 编辑：我的第一反应将 Cocoa 桌面绑定机制与您在此处称为绑定的方法混淆了。Cocoa 绑定在 iOS 上的 Cocoa Touch 中根本没有实现，所以我之前的建议是无关紧要的。对于那个很抱歉！

要回答您的问题，从您显示的代码来看，是的，您`-bindToModel:`方法中的所有内容都在主线程上运行。此处可见您的线程模型没有明显问题。

我建议`NSLog()`在您的方法中添加一些调用，`-bindToModel:`以确保一切按您的预期工作。控制台日志的输出将包含一个线程 ID，因此您可以确定事情正在您想要的线程上发生。

# php - 如何在 Magento 中显示可配置的产品库存数量？

> ID：11673917
> 
> 赞同：1
> 
> 时间：2012-07-26T16:34:40.090
> 
> 标签：php, javascript, magento-1.6

我制作了这段代码来显示某些可配置产品是否有库存。但我无法在 varien/product.js 的任何地方获得库存数量

```
updateStock: function(){
    var tempProducts = [];
    var allowedProducts = [];

    var idColor = jQuery('#attribute85').val();
    var idTalla = jQuery('#attribute127').val();

    // productos por color 
    var options = this.getAttributeOptions(85);
    for (var i = 0; i < options.length; i++ ) {
        if (options[i].id == idColor) {
            for (var j = 0; j < options[i].products.length; j++) {
                tempProducts.push(options[i].products[j]);
            }
        }
    }

    jQuery('#input-box-127 a').each(function(index) {
        // jQuery(this).find('.talla').removeClass('seleccionado');
        jQuery(this).find('div').addClass('sin_stock');

        idTalla = jQuery(this).attr('rel');
        options = spConfig.getAttributeOptions(127);
        for (var i = 0; i < options.length; i++ ) {
            if (options[i].id == idTalla) {
                for (var j = 0; j < options[i].products.length; j++) {
                    for (var index = 0; index < tempProducts.length; index++) {
                        if (tempProducts.indexOf(options[i].products[j]) > -1) {
                            //alert(jQuery(this).text());
                            jQuery(this).find('div').removeClass('sin_stock');
                        }
                    }
                }
            }
        }
    });

    return allowedProducts.length > 0;
}, 
```

magento 中是否有任何变量可以让我获得可配置的产品库存？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-09T07:03:14.387

您可以获取子产品列表并将所有子产品数量计算为可配置产品的数量...

```
$product=Mage::getModel("catalog/product");         
$prod=$product->load($prod_id);
    $conf = Mage::getModel('catalog/product_type_configurable')->setProduct($prod);
    $col = $conf->getUsedProductCollection()->addAttributeToSelect('*')->addFilterByRequiredOptions();

    $total_qty=0;
    foreach($col as $sprod){
        $sprod=$product->load($sprod->getId());
        $qty = intval(Mage::getModel('cataloginventory/stock_item')->loadByProduct($sprod)->getQty());
        $total_qty+=$qty;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T08:55:26.650

在 Magento 中，可配置产品没有库存水平。

每个子产品/变体都有自己的库存水平，因此您需要检查当前选择的变体的库存。

# ruby-on-rails - 如何使用 link_to 在 Rails 2.3.11 中创建“空白”链接？

> ID：11673919
> 
> 赞同：0
> 
> 时间：2012-07-26T16:34:43.023
> 
> 标签：ruby-on-rails, link-to

我只想创建一个在单击时不执行任何操作的链接（除了我绑定到链接 ID 的 jQuery 代码。

我在绑定到链接的 Javascript 函数中返回“false”，但我希望链接为“#”或类似的东西。当我尝试这个时：

```
link_to("Link", "#here") 
```

这给了我整个当前网址，加上“#here”卡在最后。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:44:24.653

试试这个

```
<%= link_to "TEXT" %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T16:41:43.537

试试这个：`<%= link_to('#', :id => 'link_id', :class => 'some_class') %>`

**编辑**

抱歉，我刚才看到这个问题与 Rails 2.3.11 有关。我查看了 api，看起来它可能仍然有效，但如果没有，请告诉我，我将删除此答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T16:50:33.077

你可以试试这样的

```
<%= "Link", "javascript:void(0)" %> 
```

# .net - 克隆时如何使某些属性不序列化？

> ID：11673920
> 
> 赞同：0
> 
> 时间：2012-07-26T16:34:44.463
> 
> 标签：.net, serialization

我在[这里](http://www.codeproject.com/Articles/23832/Implementing-Deep-Cloning-via-Serializing-objects)使用本指南允许我在我的项目中克隆某些对象。我有一个对象具有引用特定对象的属性。这个特定的对象来自我正在使用的另一个库，并且是根据我的对象的设置生成的。问题是当我去复制我的对象时，一切都变得疯狂，因为它试图复制一切。有谁知道我可以如何忽略这个特定的属性，以便我可以让它在克隆时根据其设置自行生成？

我正在使用 VB.NET，所以所有 .NET 答案都有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:40:37.733

我相信您可以将该[`[NonSerialized]`](http://msdn.microsoft.com/en-us/library/system.nonserializedattribute.aspx)属性应用于您不想被序列化的任何字段。

# jquery - MVC3 局部视图模式对话框调用了两次

> ID：11673921
> 
> 赞同：1
> 
> 时间：2012-07-26T16:34:47.053
> 
> 标签：jquery, asp.net-mvc-3, jquery-ui

在我的模态对话框中添加一个 jQuery 组件时，我遇到了一个有趣的问题。jQuery ui 元素（简单的颜色插件，位于[http://recursive-design.com/projects/jquery-simple-color/](http://recursive-design.com/projects/jquery-simple-color/)）被渲染了两次！经过调查，我发现模态对话框（即部分视图）*本身*被渲染了两次。这是我主要观点的相关代码：

```
// Here is the jQuery:
@section Head
{
    <script type="text/javascript">
        $(document).ready(function () {
            $("#addUserDialog").dialog({ modal: true, autoOpen: false, buttons: [
            {
                text: "Submit",
                click: function() {
                    $("#addUserForm").submit();
                }
            },
            {
                text: "Cancel",
                click: function() {
                    $(this).dialog("close");
                }
            }]
        });

        $('#addUser').click(function () {
            $("#addUserDialog").dialog("open");
        });
    </script>
}

// And here is the rendering of the partial view:
<div id="addUserDialog" title="Add User" style="display:none">
    @Html.Partial("AddUserView", ViewData["user"])
</div> 
```

局部视图模式对话框在这里：

```
@model UserModel
<script type="text/javascript">
    $(function () {
        alert("addUser");
        $.validator.unobtrusive.parse("#addUserForm");
        $(".colorPicker").simpleColor();
    });

    var closeAddUserDialog = function () {
        $("#addUserDialog").dialog("close");
    };
</script>

@using (@Ajax.BeginForm("addUser",
                        "OnCallControl",
                        new AjaxOptions
                        {
                            HttpMethod = "Post",
                            InsertionMode = InsertionMode.Replace,
                            UpdateTargetId = "userTable",
                            OnSuccess = "closeAddUserDialog"
                        },
                        new { id = "addUserForm" }))
{
    ... // Other form inputs
    <input class="colorPicker" value="#cc3333" />
} 
```

首次打开页面时，警报语句会出现两次。有趣的现象：我有另一个格式相同的模态对话框，带有类似的警报语句（例如`alert("editUser");`），两个警报语句按顺序出现两次（addUser，editUser，addUser，editUser）。

我怀疑我在标题和局部视图中合并 jQuery 的方法很糟糕，但我不知道这是否是导致局部视图中的 jQuery 函数执行两次的原因。有没有人知道为什么会这样？如果我的怀疑是正确的，我该如何纠正这种情况？

**附加信息：**

我确信这个问题来自索引视图或部分对话框视图中的某个地方，因为在视图的初始 GET 请求中没有从其他任何地方调用模式。

当我将对话框声明移动到单击事件函数（替换`dialog("open")`命令，`autoOpen: false`删除选项）时，在初始 GET 上该对话框仅发生一次警报。重复的 jQuery colorPicker 小部件令人费解地仍然存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T13:16:21.347

我对命令的运作方式存在根本性的误解`@Html.RenderPartial()`。我不知道如何从主视图访问局部视图的元素。如果在部分视图转换为标记*之后*完成，我可以从索引中成功初始化颜色选择器，而不是从部分视图中实例化颜色选择器。这可确保对话框中仅放置一个颜色选择器。

此解决方案规避了部分视图运行其 javascript 两次的问题。我假设 MVC（在这种情况下）总是通过部分运行两次，一次是在初始标记上，一次是在实际创建对话框时。我想知道是否有一种方法可以指示 Visual Studio在我告诉它之前*不要*运行局部视图？

# eclipse - 在 Ubuntu 的 eclipse 中无法解析外部 jar

> ID：11673929
> 
> 赞同：3
> 
> 时间：2012-07-26T16:35:10.050
> 
> 标签：eclipse, json, ubuntu, import, jar

我用java写了一个简单的JsonParser代码。[我在这篇文章](https://stackoverflow.com/questions/8997598/importing-json-into-an-eclipse-project)之后下载了 json jar 文件。我通过包含jar文件，

```
Project Properties-> Java Build Path -> Libraries -> Add external jars 
```

但我仍然收到导入语句的错误“无法解析导入 org.json.JSONObject”。

这发生在我的 Ubuntu 机器上。但是按照相同的步骤，我可以成功地包含 jar 并在 Windows 中运行我的程序。但我希望它在我的 Ubuntu 机器上工作。我应该做些不同的事情吗？

我的项目目录中有 jar 文件。它也被列在包资源管理器中的引用库下。

[编辑]：我做了一个 ctrl + shift + O 来组织 eclipse 中的导入和语句

```
import org.json.JSONObject
import org.json.JSONArray
import org.json.JSONExceptiop 
```

改为，

```
import org.json.simple.JSONObject
import org.json.simple.JSONArray 
```

出现以下错误，

```
The constructor JSONArray(String) is undefined
The method length() is undefined for the type JSONArray
The method getJSONObject(int) is undefined for the type JSONArray 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T17:02:12.363

看起来您从这里下载了 .jar：

[http://code.google.com/p/json-simple/](http://code.google.com/p/json-simple/)

而您的导入是基于此处的 .jar ：

[http://www.java2s.com/Code/JarDownload/java/java-json.jar.zip](http://www.java2s.com/Code/JarDownload/java/java-json.jar.zip)

来自 json-simple 的 JSONArray 没有采用单个字符串的构造函数。切换 .jar 文件或修复构造函数。

# android - 在 Android 上使用 AES 128 加密的 HLS（冰淇淋三明治）

> ID：11673932
> 
> 赞同：1
> 
> 时间：2012-07-26T16:35:29.060
> 
> 标签：android, encryption, http-live-streaming, drm

我开始将需要使用 HLS 视频的应用程序放在一起。我想使用冰淇淋三明治作为目标 SDK，但我不确定这个 api 是否支持*带*加密的 HLS。这是开发人员网站所说的：

**应用程序现在可以将 M3U 播放列表 URL 传递给媒体框架以开始 HTTP Live 流会话。媒体框架支持大部分 HTTP Live 流规范，包括自适应比特率。**

它没有具体说明我在寻找什么，所以我的问题是 - 有没有人在 ICS 上使用带有加密提要的 HLS？如果是这样，您是否使用了 Android DRM？从谷歌搜索我发现有些人对 HoneyComb 有好运，有些人没有，但在这件事上没有太多关于 ICS 的信息。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T08:40:06.400

一般来说，ICS 确实支持根据 HLS 标准的 AES-128 加密（[请参阅此处](https://datatracker.ietf.org/doc/html/draft-pantos-http-live-streaming-01)）。但是，设备的媒体播放能力不依赖于 Android 版本，而是依赖于特定设备上实现的媒体框架。大多数手机和平板电脑都使用在 Android 2.2 中引入的 stagefright 媒体框架。到目前为止，我还没有看到或听说过任何使用 stagefright 的 ICS，其中加密的 HLS 不起作用。但是，我尝试过使用其他无法播放加密 HLS 的媒体框架的 ICS 机顶盒（新固件可能会解决此问题）。

总结一下：理解是所有 ICS 都旨在支持加密 HLS，如果特定设备不支持，则可能正在修复。原因是在没有 Flash 的情况下，加密的 HLS 是实现直播 DRM 的唯一可能方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T16:02:28.197

据我所知，通过 html5`<video>`标签将支持 Http Live Streaming，因为 Android 的 Adob​​re Flash 已被弃用： [http ://www.zdnet.com/blog/open-source/no-flash-for-android-4-1 -jelly-bean-users/11433](http://www.zdnet.com/blog/open-source/no-flash-for-android-4-1-jelly-bean-users/11433) 用于数字版权管理的 html5 媒体加密仍在讨论中 [http://dvcs.w3.org/hg/html-media/raw-file/tip/encrypted-media/encrypted -media.html](http://dvcs.w3.org/hg/html-media/raw-file/tip/encrypted-media/encrypted-media.html)

# android - Android TabHost 销毁活动

> ID：11673935
> 
> 赞同：0
> 
> 时间：2012-07-26T16:35:45.557
> 
> 标签：android, android-activity

我有一个标签主机，里面有 3 个标签。在 tabpress 上，特定的活动是通过意图加载的。每个活动在线程中都有一个计时器。

所以问题是，当我选择不同的选项卡时，前一个选项卡会破坏，因此计时器也会停止。

我想让所有 3 个活动并行运行而不会破坏。可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:44:31.807

当您切换选项卡时，最后一个 Activity 会失去前景，`onPause()`并且`onStop()`会像所有其他失去前景的 Activity 一样被调用。您可以尝试扩展应用程序类并将计时器保留在其中或创建某种静态全局类。否则，您可以尝试使用视图而不是活动来显示您的内容，然后您的计时器将保持活动状态，因为在使用您的应用程序时该活动将始终处于前台。

# vim - 替换到文本对象的末尾

> ID：11673938
> 
> 赞同：5
> 
> 时间：2012-07-26T16:35:56.437
> 
> 标签：vim

在 Vim 中，我不断发现自己希望通过击键来重写某些参数列表的其余部分。例如，在以下 Python 函数中：

```
def myfun(a, b=12, c=(1,2,3), d=15):
    pass 
```

我希望将 替换`c=(1,2,3), d=15`为`e=12`。击键`ci(`允许我替换整个参数列表中的所有内容，但我发现我经常想保留一些 Vim 文本对象的前缀。一般来说，我假设我正在搜索的这个击键在替换函数调用的最终参数和定义的上下文中会很有用。

这个问题的理想答案也适用于带引号的字符串、`[]`块和其他文本对象。请注意，我了解“[如何在 Vim 中的括号（或引号或...）之间进行选择？](https://stackoverflow.com/questions/1061933/how-to-select-between-brackets-or-quotes-or-in-vim) ”中回答的所有有关文本对象的信息。

@pb2q 和@romainl 都提供了很好的搜索快捷方式，但它们要求我在视觉上找到封闭块的结尾，以设计一个搜索，该搜索对于块中的任何其他垃圾来说是明确的（例如，考虑嵌套函数调用）。特别是，当我在要操作的括号集中嵌套括号时，我经常发现自己想要这个。我真正想要的答案类似于`ci)`或`ca)`在概念上完全基于最近的封闭括号`)`，并且完全优雅地处理其他嵌套`)`块。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-26T17:34:21.103

有一堆命令从`]`某种结构的末尾开始，并尊重嵌套。`]``)`转到带括号的块的末尾，`]``}`转到带括号的块的末尾，`]``/`转到 C 注释（`/*...*/`样式）的末尾。使用`[`代替`]`去开始而不是结束。

所以要做你的`c=(1,2,3), d=15`类型的替换`c``]``)`。

这些命令的完整列表在下面列出`:help various-motions`。不幸的是，没有一个用于由方括号分隔的块，因为`[``[`and`]``]`在经典 vi 中已经具有不同的含义，而 vim 已经定义`]``[`并`[``]`很好地适应了这些。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-26T17:36:20.617

用这个创建地图

```
mavi)o`a 
```

*   标记当前位置 a
*   视觉选择 inside () 以选择您所在的 () 内的完整字符集
*   转到突出显示文本的另一端以`:h v_o`获取更多信息
*   移动到之前标记的位置

现在您可以执行诸如 c 或 d 之类的操作...

编辑：我仍然最喜欢@Alan-Curry 的解决方案，因为键序列很短。然而，这种技术也有使用 ] 的好处。

我还发现了我的解决方案的简化：

```
vi)o`` 
```

`` 跳转到最后一个位置。因此，您无需创建标记。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-14T19:23:09.293

如果您不介意使用插件，我相信[vim-ninja-feet](https://github.com/tommcdo/vim-ninja-feet)完全符合您的要求。

*   `c]i)`将更改参数列表的其余部分，
*   `d[i"`将向后删除到引用的开头，并且
*   `z]i]`将在 [] 块的末尾将您置于插入模式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T16:38:10.903

`ct:`在这种情况下，将更改所有内容，但不包括`:`. 前面`t`带有数字参数将允许您轻松更改嵌套的大括号/括号/引号，例如`c2t)`.

如果光标已经在您要更改的行上，`fc`将使用上述命令将您放在要开始更改的字符上，或使用搜索，例如：`/c=`对于更一般的情况，即如果您有`c`字符较早的行，或光标当前位于前一行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T19:28:01.897

我拼凑了一个小解决方案。它可能有一些边缘情况，可能有一些错误，但我今天没有时间测试了。有时间我会再去看看。

```
function! UntilTextObject(op)
    " Save marks
    let save_a = getpos("'a")
    let save_b = getpos("'b")

    " Read in the object type and set '< and '> to the ends of the
    " range of the text-object and 'a to the current position
    let object_type = nr2char(getchar())
    execute "normal! mavi" . object_type . "\<esc>"

    " Adjust end position (off by one)
    let pos = getpos("'>")
    let pos[2] += 1
    call setpos("'b", pos)

    " Operate on the range `a to `b
    execute "normal! `a" . a:op . "`b"

    " Restore marks
    call setpos("'a", save_a)
    call setpos("'b", save_b)
endfunction

onoremap u :call UntilTextObject(v:operator)<cr> 
```

这允许您`du)`删除-直到-the-end-of-the-)-text-object。也适用于其他文本对象。

我添加了一些更改，通过不踩踏你的标记使这更加礼貌。如果你给它一个不选择任何东西的文本对象，它仍然有点古怪。我会在以后重新审视这个，看看我是否能解决这个问题。出于演示目的，故意过度评论。

# sql-server-2008 - SQL Server 2008：字符编码

> ID：11673944
> 
> 赞同：0
> 
> 时间：2012-07-26T16:36:17.223
> 
> 标签：sql-server-2008, configuration, character-encoding, special-characters

我有 2 个独立的 SQL 服务器实例，一个是我们的测试系统，另一个是我们的生产系统。在测试系统中，字段（类型：nvarchar(50)）中的值如下所示（a）。但是，在生产系统中，它看起来像下面的 (b) -

a) 一些——性格

b) 一些 - 字符

我有两个问题：-

1.  数据库/SQL 实例的设置有何不同会使相同的字符出现不同？
2.  有没有办法找到那个特殊字符的 unicode 等价物，这样我就可以更清楚地了解它来自哪种语言/键盘？（此字段由用户表单填充，我们有一个全球用户团队）

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T02:36:07.853

在两个盒子上运行此语句。

```
SELECT SERVERPROPERTY('Collation') 
```

听起来您在不同的服务器上有不同的默认排序规则。如果它们不同，则您必须确定是否要/可以使它们都相同。

[如果是这种情况，关于 ServerFault 的这个问题应该会给你一些指导。](https://serverfault.com/questions/19577/how-do-i-change-the-collation-of-a-sql-server-database)

# linux - Jenkins 如何处理交互式 Shell 脚本？

> ID：11673945
> 
> 赞同：9
> 
> 时间：2012-07-26T16:36:19.110
> 
> 标签：linux, shell, jenkins

我正在编写几个 Linux shell 脚本来移动一些代码，如果它们可以是交互式的，那就太好了。

缺点是我想在 Jenkins 中执行其中一些脚本，并且不完全确定 Jenkins 如何处理脚本中的用户提示。我在这方面找不到很多东西，也没有资源继续测试它，所以任何建议都将不胜感激。

多谢你们

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-26T16:46:22.200

如果 Jenkins 执行的命令需要输入，它就会坐在那里等待输入。该作业将挂起，您需要手动将其终止。解决此问题的一种方法是将预期的输入通过管道传输到命令中，例如

```
echo "input" | command 
```

或者

```
command < file_with_input 
```

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2012-10-14T07:18:51.030

您可以从 Jenkins 运行交互式 shell 脚本。

这是相关的文档：

[http://www.buildengineers.org:8080/display/Tools/Running+interactive+Shell+Script+in+Jenkins](http://www.buildengineers.org:8080/display/Tools/Running+interactive+Shell+Script+in+Jenkins)

使用`<<LimitString`选项，您可以从命令行运行 shell 脚本。

您可以在 jenkins 配置的执行部分中提供输入。

希望这可以帮助。

# java - 排除 Oracle - 挂起的进程

> ID：11673947
> 
> 赞同：17
> 
> 时间：2012-07-26T16:36:28.930
> 
> 标签：java, database, oracle

我试图了解我们在挂起的 Java 进程中遇到的问题。这个过程已经在生产中运行了大约 4 个月，本周早些时候它开始挂起。当我查看进程的线程转储时，所有相关线程 (3) 都有如下堆栈：

```
 "TxnParser_1" prio=6 tid=0x69bd3400 nid=0x2534 runnable [0x6aa2f000]
   java.lang.Thread.State: RUNNABLE
        at java.net.SocketInputStream.socketRead0(Native Method)
        at java.net.SocketInputStream.read(SocketInputStream.java:129)
        at oracle.net.ns.Packet.receive(Unknown Source)
        at oracle.net.ns.DataPacket.receive(Unknown Source)
        at oracle.net.ns.NetInputStream.getNextPacket(Unknown Source)
        at oracle.net.ns.NetInputStream.read(Unknown Source)
        at oracle.net.ns.NetInputStream.read(Unknown Source)
        at oracle.net.ns.NetInputStream.read(Unknown Source)
        at oracle.jdbc.driver.T4CMAREngine.unmarshalUB1(T4CMAREngine.java:1099)
        at oracle.jdbc.driver.T4CMAREngine.unmarshalSB1(T4CMAREngine.java:1070)
        at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:478)
        at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:207)
        at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:790)
        at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:1039)
        at oracle.jdbc.driver.T4CStatement.executeMaybeDescribe(T4CStatement.java:830)
        at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1132)
        at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1687)
        at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1653)
        - locked <0x40e22f88> (a oracle.jdbc.driver.T4CStatement)
        - locked <0x28f8d398> (a oracle.jdbc.driver.T4CConnection)
        at com.gcg.data.LogParsingInfo.initFromDB(LogParsingInfo.java:262)
        at com.gcg.om.OmQueueEntry.initParseInfoFromDB(OmQueueEntry.java:104)
        at com.gcg.om.GenericQueueEntry.run(GenericQueueEntry.java:237)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
        at java.lang.Thread.run(Thread.java:619) 
```

没有等待锁的线程，因此进程不会死锁。这 3 个正在执行工作的线程只是被阻塞等待 Oracle 的响应，至少在我看来是这样的。

查看 Oracle，当我查询 v$session 时，看起来与这些线程关联的连接之一当前正在执行查询，尽管我看不到 sql。

```
select ... from v$session where ...;
SQL_ADDRESS      SQL_HASH_VALUE SQL_ID        SQL_CHILD_NUMBER SQL_EXEC_START SQL_EXEC_ID PREV_SQL_ADDR    PREV_HASH_VALUE PREV_SQL_ID   PREV_CHILD_NUMBER PREV_EXEC_START PREV_EXEC_ID
---------------- -------------- ------------- ---------------- -------------- ----------- ---------------- --------------- ------------- ----------------- --------------- ------------
              00              0                                                           0000000239F59EE8      1483377872 fqr8pndc6p36h                 5 26-JUL-12           32080545
              00              0                                                           0000000239F59EE8      1483377872 fqr8pndc6p36h                 5 26-JUL-12           32080546
0000000148CABD88     1784444892 a16hxxtp5sxyw                                             0000000239F59EE8      1483377872 fqr8pndc6p36h                 5 26-JUL-12           32080544

select * from v$sql where sql_id = 'a16hxxtp5sxyw';

no rows selected 
```

我的问题是：

1.  我的分析是否正确，该进程只是被阻止等待 Oracle 的响应？
2.  我应该在 Oracle 中寻找什么来理解为什么这个进程被阻塞？

更新：

基于关于查看 DBA_WAITERS 和 DBA_LOCKS 的评论

```
select * from dba_waiters;

no rows selected

select * from dba_locks where BLOCKING_OTHERS <> 'Not Blocking';

no rows selected 
```

dba_locks 中有 98 行，但由于所有行都“不阻塞”，我认为这不是锁定问题吗？有问题的进程已处于此状态超过 3 小时，因此现在已检测到任何死锁。

我认为 Oracle 实例不是“健康的”，但我不知道该看什么。我有一个重新启动 Oracle 服务器的请求，但尚未完成。

追问：v$session包含一个在v$sql中不存在的sql_id是否正常，如果是，在什么条件下？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-27T14:42:54.007

问题解决了，答案就在 v$session 表中。显然，Oracle 会话可能会因为锁定以外的原因而阻塞。请注意列 FINAL_BLOCKING_SESSION - 它标识了作为阻塞根本原因的会话。我们调查了会话 845，发现客户端进程（由 MACHINE 和 PORT 标识）不再存在。DBA 终止了会话 845 并全部恢复正常。

```
SID     SERIAL# STATUS    PROGRAM          TYPE SQL_ID        PREV_SQL_ID    BLOCKING_SESSION_STATUS BLOCKING_INSTANCE BLOCKING_SESSION FINAL_BLOCKING_SESSION_STATUS FINAL_BLOCKING_INSTANCE FINAL_BLOCKING_SESSION EVENT
------- ------- --------- ---------------- ---- ------------- -------------- ----------------------- ----------------- ---------------- ----------------------------- ----------------------- ---------------------- ----------------------------
 108    22447   ACTIVE    Gcg log parser 1 USER               fqr8pndc6p36h  VALID                   1                 1581             VALID                         1                       845                    library cache: mutex X
 639    40147   ACTIVE    Gcg log parser 3 USER               fqr8pndc6p36h  VALID                   1                 1581             VALID                         1                       845                    library cache: mutex X
 742    34683   ACTIVE    Gcg log parser 2 USER a16hxxtp5sxyw fqr8pndc6p36h  VALID                   1                 1581             VALID                         1                       845                    library cache: mutex X 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-11T04:50:03.877

我最近也遇到了这个问题，并使用此查询查找 Oracle 中的锁定/锁定会话：

```
select 
   inst_id||' '||sid||','||serial# inst_sid_s#, 
   username,
   row_wait_obj#||','||row_wait_block#||','||row_wait_row# obj_lck,
   blocking_session_Status||' '||blocking_instance||','||blocking_session blk_info,
   final_blocking_session_Status||' '||final_blocking_instance||','||final_blocking_session f_blk_info,
   event, 
   seconds_in_wait 
from 
   gv$session 
where 
   lockwait is not null
order by 
   inst_id; 
```

来源： [http ://www.dba-oracle.com/t_final_blocking_session_final_blocking_instance.htm](http://www.dba-oracle.com/t_final_blocking_session_final_blocking_instance.htm)

# java - 使用 Boolean.valueOf() 方法与（或 Java 1.5 自动装箱）创建布尔对象

> ID：11673954
> 
> 赞同：8
> 
> 时间：2012-07-26T16:36:52.010
> 
> 标签：java, performance

哪个是更好的实践 `Boolean.valueOf()`和`Java 1.5 autoboxing`创造`Boolean`，`booleans`为什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-26T16:38:35.083

自动装箱由编译器`boolean`透明地转换为`Boolean.valueOf()`：

```
boolean b = true;
Boolean bb = b; 
```

被翻译成：

```
iconst_1
istore_1            //b = 1 (true)
iload_1             //b
invokestatic    #2; //Method java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;
astore_2            //bb = Boolean.valueOf(b) 
```

使用您认为更有用和更易读的任何一个。由于 using`Boolean.valueOf()`除了额外的打字之外没有给你任何东西，你应该瞄准自动装箱。

* * *

当您考虑相反的转换 - 从`Boolean`到时，情况会变得复杂`boolean`。这个时间`Boolean.booleanValue()`是编译器为你透明调用的，理论上可以导致`NullPointerException`.

# iphone - iOS 使用 NSDictionary 将数据加载到部分和行中

> ID：11673963
> 
> 赞同：1
> 
> 时间：2012-07-26T16:37:20.357
> 
> 标签：iphone, ios, uitableview, ios4, nsdictionary

我希望在行中显示带有日期的表格部分作为部分标题和书名。我完全不知道如何使用 NSDictionary 将数据加载到部分和行中。因此我的代码都搞砸了:(谁能提供一些帮助，以一些示例代码作为指导？我的 NSMutableArray 如下：

```
(
        {
        BIBNo = 187882;
        date = "14/08/2012";
        itemSequence = 000010;
        name = "Increasing confidence / Philippa Davies.";
        noOfRenewal = 0;
        number = 000187907;
        status = "Normal Loan";
        time = "24:00";
        type = Loans;
    },
        {
        BIBNo = 291054;
        date = "14/08/2012";
        itemSequence = 000010;
        name = "iPhone application development for IOS 4 / Duncan Campbell.";
        noOfRenewal = 2;
        number = 000291054;
        status = "Normal Loan";
        time = "24:00";
        type = Loans;
    },
        {
        BIBNo = 244441;
        date = "15/08/2012";
        itemSequence = 000010;
        name = "Coach : lessons on the game of life / Michael Lewis.";
        noOfRenewal = 1;
        number = 000244441;
        status = "Normal Loan";
        time = "24:00";
        type = Loans;
    },
        {
        BIBNo = 290408;
        date = "15/08/2012";
        itemSequence = 000010;
        name = "Sams teach yourself iPhone application development in 24 hours / John Ray.";
        noOfRenewal = 3;
        number = 000290408;
        status = "Normal Loan";
        time = "24:00";
        type = Loans;
    },
        {
        BIBNo = 161816;
        date = "16/08/2012";
        itemSequence = 000010;
        name = "Malaysian Q & As / compiled by Survey & Interview Department ; illustrations by Exodus.";
        noOfRenewal = 1;
        number = 000161817;
        status = "Normal Loan";
        time = "24:00";
        type = Loans;
    },
        {
        BIBNo = 187883;
        date = "16/08/2012";
        itemSequence = 000010;
        name = "Positive thinking / Susan Quilliam.";
        noOfRenewal = 3;
        number = 000187899;
        status = "Normal Loan";
        time = "24:00";
        type = Loans;
    }
) 
```

我实际上如何将对象重新添加到 NSDictionary 中，以便将具有相同日期的对象存储在一起以在该部分中显示为行？请给我一些建议谢谢！T_T

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:41:42.227

```
 - Dictionary of sections by date
  |
   --- array of row objects for the date1
  |    |
  |     --- row dictionary with the data to display
  |    |
  |     --- row dictionary with the data to display
  |    |
  |     --- row dictionary with the data to display
  |    |
  |     --- row dictionary with the data to display
  |
  |
  |
   --- array of row objects for the date2
  |    |
  |     --- row dictionary with the data to display
  |    |
  |     --- row dictionary with the data to display
  |    |
  |     --- row dictionary with the data to display
  |
  |
  |
  |
   --- array of row objects for the date3
       |
        --- row dictionary with the data to display
       |
        --- row dictionary with the data to display
       |
        --- row dictionary with the data to display
       |
        --- row dictionary with the data to display
       |
        --- row dictionary with the data to display 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T17:14:55.043

要处理您的数据，您需要执行类似的操作

```
NSMutableDictionary *dataSource = [[NSMutableDictionary alloc] init]; // This would need to be an ivar

for (NSDictionary *rawItem in rawItems) {
    NSString *date = [rawItem objectForKey:@"date"]; // Store in the dictionary using the data as the key

    NSMutableArray *section = [dataSource objectForKey:date]; // Grab the section that corresponds to the date

    if (!section) { // If there is no section then create one and add it to the dataSource
        section = [[NSMutableArray alloc] init];
        [dataSource setObject:section forKey:date];
    }

    [section addObject:rawItem]; // add your object
}

self.dataSource = dataSource; 
```

然后获取章节标题

```
NSArray *sections =[[self.dataSource allKeys] sortedArrayUsingSelector:@selector(caseInsensitiveCompare:)];
return [sections objectAtIndexPath:indexPath.section]; 
```

然后在一个部分中获得一行

```
NSString *sectionTitle = // get the section title calling the above code
NSArray *items = [self.dataSource objectForKey:sectionTitle];

return [items objectAtIndex:indexPath.row]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:40:53.210

简而言之，您不能将对象重新添加到 NSDictionary。那是因为 NSDictionary 是不可变的。一旦它被创建，它的内容就不能被修改。你想要的是一个 NSMutableDictionary。

然后，您可以使用 setObject: forKey: 方法。

```
[MyDict setObject:@"Normal Loan" forKey:@"status"]; 
```

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsmutabledictionary_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsmutabledictionary_Class/Reference/Reference.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T17:20:00.537

正如 A-Live 所说，您将不得不将您的数组排序到数组的可变字典中

以下代码应该可以工作，但未经测试

在 TableView 控制器 .h

```
@interface MyController:UITableViewController{
   NSMutableArray* dict;
   NSMutableArray* array;
} 
```

在 MyController.m

```
-(void)initWithBooksArray:(NSArray*)bookArray{ //Or something similar

    self = [[super alloc] initWithStyle:UITableViewStylePlain];
    if(self){        
       dict = [[NSMutableDictionary alloc] init];
       array= [[NSMutableArray alloc] init];

       NSMutableArray* sectionArray;
       for(NSDictionary* bookDict in bookArray){

          date = [bookDict valueForKey:@"date"];
          sectionArray = [dict valueForKey:date];
          if(sectionArray){
             [sectionArray addObject:bookDict];
          }else{
             sectionArray = [[NSMutableArray arrayWithObject:bookDict];
             [dict addObject:sectionArray forKey:date];
          }
       }
       array = [[dict allKeys] sortedArrayUsingSelector:@selector(caseInsensitiveCompare:)];

    }
    return self;
}

-(NSInteger)numberOfSectionsInTableView:(UITableView *)tableView{
   return [dict count];
}

-(NSInterger)tableView:(UITableView*)tableView numberOfRowsInSection:(NSInteger)section{
   NSString* key = [array objectAtIndex:section];
   return [[dict objectForKey:key]count];
}
- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section{
   return [array objectAtIndex:section];
}

...

// I'll leave it to apple's documentation (or someone else) to fill in the blanks on how to create cells 
```

}

# ruby - 如何生成前 n 个素数？

> ID：11673968
> 
> 赞同：26
> 
> 时间：2012-07-26T16:37:33.633
> 
> 标签：ruby, primes

我正在学习 Ruby 并做一些数学工作。我想做的一件事是生成素数。

我想生成前十个素数和前十个。我可以毫无问题地测试一个数字以查看它是否是质数，但想知道生成这些数字的最佳方法是什么？

我正在使用以下方法来确定数字是否为素数：

```
class Integer < Numeric
  def is_prime?
    return false if self <= 1
    2.upto(Math.sqrt(self).to_i) do |x|
      return false if self%x == 0
    end
    true
  end
end 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-07-26T16:52:55.643

在 Ruby 1.9 中有一个 Prime 类，您可以使用它来生成素数，或测试一个数字是否为素数：

```
require 'prime'

Prime.take(10) #=> [2, 3, 5, 7, 11, 13, 17, 19, 23, 29]
Prime.take_while {|p| p < 10 } #=> [2, 3, 5, 7]
Prime.prime?(19) #=> true 
```

Prime 实现了该`each`方法并包含 Enumerable 模块，因此您可以执行各种有趣的事情，例如过滤、映射等。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-26T17:03:28.060

如果你想自己做，那么这样的事情可能会起作用：

```
class Integer < Numeric
    def is_prime?
        return false if self <= 1
        2.upto(Math.sqrt(self).to_i) do |x|
            return false if self%x == 0
        end 
        true
    end 

    def next_prime
        n = self+1
        n = n + 1 until n.is_prime?
        n   
    end 
end 
```

现在获取前 10 个素数：

```
e = Enumerator.new do |y|
    n = 2
    loop do
        y << n
        n = n.next_prime
    end
end

primes = e.take 10 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-07-26T16:54:29.060

```
require 'prime'

Prime.first(10) # => [2, 3, 5, 7, 11, 13, 17, 19, 23, 29] 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-07-26T17:18:57.257

查看埃拉托色尼筛。这不是 Ruby 特有的，但它是一种生成素数的算法。这个算法背后的想法是你有一个数字列表/数组说

`2..1000`

你抓住第一个数字，2。遍历列表并消除所有能被 2 整除的东西。你将剩下除了 2 本身之外不能被 2 整除的所有东西（例如 [2,3,5,7,9, 11...999]

转到下一个数字 3。再一次，消除可以除以 3 的所有内容。继续前进，直到到达最后一个数字，您将得到一系列素数。希望有帮助。

[http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-07-26T17:32:10.357

人们已经提到了`Prime`课程，这绝对是要走的路。有人还向您展示了如何使用[枚举](http://www.ruby-doc.org/core-1.9.3/Enumerator.html)器，我想使用[Fiber](http://www.ruby-doc.org/core-1.9.3/Fiber.html)贡献一个版本（它使用您的`Integer#is_prime?`方法）：

```
primes = Fiber.new do
  Fiber.yield 2
  value = 3
  loop do
    Fiber.yield value if value.is_prime?
    value += 2
  end
end

10.times { p primes.resume } 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-05-13T08:45:48.237

```
# First 10 Prime Numbers

number = 2
count = 1
while count < 10
  j = 2
  while j <= number
    break if number%j == 0
    j += 1
  end
  if j == number
    puts number 
    count += 1
  end
  number += 1
end 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-11-12T09:03:13.597

实施 Eratosthene 筛（或多或少）

```
def primes(size)
    arr=(0..size).to_a
    arr[0]=nil
    arr[1]=nil
    max=size
    (size/2+1).times do |n|
        if(arr[n]!=nil) then
            cnt=2*n
            while cnt <= max do
                arr[cnt]=nil
                cnt+=n
            end
        end
    end
    arr.compact!
end 
```

此外，这是我非常喜欢的单线

```
def primes_c a
    p=[];(2..a).each{|n| p.any?{|l|n%l==0}?nil:p.push(n)};p
end 
```

当然，那些会在第一个数字中找到素`n`数，而不是第一个`n`素数，但我认为适应不需要太多努力。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-06-09T01:21:37.350

这是一种从头开始生成素数直至“最大”参数的方法，无需使用素数或数学。让我知道你的想法。

```
def prime_test max
    primes = []
    (1..max).each {|num| 
        if
            (2..num-1).all? {|denom| num%denom >0}
        then
            primes.push(num)
        end
    }
    puts primes
end

prime_test #enter max 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-10-17T21:03:56.327

我认为对于非常大的最大数字来说，这可能是一个昂贵的解决方案，但在其他方面似乎效果很好：

```
def multiples array
  target = array.shift 
  array.map{|item| item if target % item == 0}.compact
end

def prime? number
  reversed_range_array = *(2..number).reverse_each
  multiples_of_number = multiples(reversed_range_array)
  multiples_of_number.size == 0 ? true : false
end

def primes_in_range max_number
  range_array = *(2..max_number)
  range_array.map{|number| number if prime?(number)}.compact
end 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-11-20T01:21:06.167

```
class Numeric
  def prime?
    return self == 2 if self % 2 == 0

    (3..Math.sqrt(self)).step(2) do |x|
      return false if self % x == 0
    end

    true
  end
end 
```

有了这个，现在`3.prime?`返回`true`，`6.prime?`返回`false`。

无需努力实现筛算法，只需验证直到平方根的可除性并跳过奇数，仍然可以快速节省时间。然后，遍历数字，检查素数。

记住：**人类时间>机器时间。**

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-10-09T20:32:59.730

我这样做是为了编码 kata，并使用 Eratosthenes 筛。

```
puts "Up to which number should I look for prime numbers?"
number = $stdin.gets.chomp
n = number.to_i
array = (1..n).to_a

  i = 0

while array[i]**2 < n

i = i + 1
array = array.select do |element|
  element % array[i] != 0 || element / array[i] == 1

end
end

 puts array.drop(1) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-07-22T12:04:45.613

Ruby：打印 N 个素数 [http://mishra-vishal.blogspot.in/2013/07/include-math-def-printnprimenumbernoofp.html](http://mishra-vishal.blogspot.in/2013/07/include-math-def-printnprimenumbernoofp.html)

```
include Math

def print_n_prime_number(no_of_primes=nil)

  no_of_primes = 100 if no_of_primes.nil?

  puts "1 \n2"

  count = 1

  number = 3

  while count < no_of_primes

sq_rt_of_num = Math.sqrt(number)

number_divisible_by = 2

while number_divisible_by <= sq_rt_of_num

  break if(number % number_divisible_by == 0)

  number_divisible_by = number_divisible_by + 1

end

if number_divisible_by > sq_rt_of_num

  puts number

  count = count+1

end

number = number + 2

  end

end

print_n_prime_number 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-04-23T05:17:16.650

与问题本身完全无关，但仅供参考：

*   如果有人不想一次又一次地生成素数（又名贪婪的资源保护程序）
*   或者你可能已经知道你必须以某种方式处理后续的素数
*   其他不为人知的精彩案例

试试这个片段：

```
 require 'prime'

  for p in Prime::Generator23.new
    # `p` brings subsequent prime numbers until the end of the days (or until your computer explodes)
    # so here put your fabulous code
    break if #.. I don't know, I suppose in some moment it should stop the loop
  end
  fp 
```

如果您需要它，您还可以使用其他更复杂的生成器作为`Prime::TrialDivisionGenerator`or `Prime::EratosthenesGenerator`。[更多信息](http://ruby-doc.org/stdlib-1.9.3//libdoc/prime/rdoc/Prime.html#class-Prime-label-Generators)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-02-25T16:53:40.147

这是一个超级紧凑的方法，它用一行代码生成一个素数数组。

```
 def get_prime(up_to)
    (2..up_to).select { |num| (2...num).all? { |div| (num % div).positive? } }
  end 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2016-03-03T16:24:52.637

```
def get_prime(number)
  (2..number).each do |no|
      if (2..no-1).all? {|num| no % num  > 0}
        puts no
      end
  end
end

get_prime(100) 
```

# ruby-on-rails - 未初始化的常量 ProductsController::Offer 错误？

> ID：11673971
> 
> 赞同：0
> 
> 时间：2012-07-26T16:37:51.510
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有一个问题，我无法弄清楚产品控制器错误的问题所在，我不会呈现我想要工作的产品索引视图页面。

我的代码如下：提供控制器

```
class OffersController < ApplicationController

  attr_accessible :product , :reserve_price

  def your_offer
    @your_offer = Offer.new

  end

  def new
    @offer = Offer.new = :your_offer
  end

end 
```

和产品控制器

```
class ProductsController < ApplicationController
      before_filter :authenticate, :except => [:index, :show]

      # GET /products
      # GET /products.xml
      def index
        @offer = Offer.new
         @products = Product.search(params[:search_query])

         respond_to do |format|
              format.html # index.html.erb
        format.xml  { render :xml => @products }
       end
      end

     # GET /products/1
     # GET /products/1.xml
     def show

         @product = Product.find(params[:id])

        respond_to do |format|
         format.html # show.html.erb
        format.xml  { render :xml => @product }
       end
     end

     # GET /products/new
     # GET /products/new.xml
     def new
      @product = Product.new

       respond_to do |format|
        format.html # new.html.erb
        format.xml  { render :xml => @product }
       end
     end

      # GET /products/1/edit
     def edit
       @product = Product.find(params[:id])
     end

     # POST /products
     # POST /products.xml
     def create
       @product = current_user.products.new(params[:product])

    respond_to do |format|
      if @product.save
        format.html { redirect_to(@product, :notice => 'Product was successfully created.') }
        format.xml  { render :xml => @product, :status => :created, :location => @product }
      else
        format.html { render :action => "new" }
        format.xml  { render :xml => @product.errors, :status => :unprocessable_entity }
      end
    end
  end

     # PUT /products/1
     # PUT /products/1.xml
     def update
    @product = Product.find(params[:id])

    respond_to do |format|
      if @product.update_attributes(params[:product])
        format.html { redirect_to(@product, :notice => 'Product was successfully     updated.') }
        format.xml  { head :ok }
      else
        format.html { render :action => "edit" }
        format.xml  { render :xml => @product.errors, :status => :unprocessable_entity }
      end
    end
  end

     # DELETE /products/1
    # DELETE /products/1.xml
  def destroy
    @product = Product.find(params[:id])
    @product.destroy

    respond_to do |format|
      format.html { redirect_to(products_url) }
      format.xml  { head :ok }
    end
  end
end 
```

报价模式

```
class Offer < ActiveRecord::Base
     belongs_to :product
  has_many :reserve_prices

  attr_accessible :product, :offer , :reserve_price

  validates_presence_of :offer
  validate :ensure_meets_reserve_price

  private
  def ensure_meets_reserve_price
    if amount < self.product.reserve_price
      errors.add(:amount, "does not meet reserve price")
    end
  end

  private
  def reserve_price
     product.reserve_price
  end

  def your_offer
    @your_offer = Offer.new

  end

  def new
    @offer = Offer.new = :your_offer
  end
end 
```

产品索引 viex 片段

```
<%= form_for @offer do |f| %>
    <%= f.text_field :your_offer %>
    <%= f.submit "Make Offer" %>
<% end %> 
```

谁能看到我的错误在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:56:25.157

它抱怨`@offer = Offer.new`

您是否在创建报价后运行了迁移并重新启动了服务器？

您是否将其声明为 config/routes.rb 中的资源

```
 resources :products, :shallow => true do
    resources :offers # or at least just this line
  end 
```

**编辑：**

摆脱这条线，然后再试一次

```
attr_accessible :product, :offer , :reserve_price 
```

是 :offer 在 offer 表中的一列？

attr_accessible 中不能有来自另一个模型的列。

# css - 过渡：顶部在 Firefox 和 Opera 中不起作用

> ID：11673977
> 
> 赞同：5
> 
> 时间：2012-07-26T16:38:18.797
> 
> 标签：css, css-transitions

我就是不能让它工作。我很确定这一定是可能的。

这只是一个例子。我希望内部 div 以过渡效果向下移动。

```
<div id="outer">
    <div id="inner"></div>
</div>

<style type="text/css">       
    #outer
    {
        width:200px; 
        height:200px; 
        background-color:Yellow;
    }

    #inner
    {
        position:relative;
        -webkit-transition: top .4s ease-out;
        -moz-transition: top .4s ease-out;
        width:50px; 
        height: 100px; 
        background-color:Red;
    }

    #inner:hover
    {
        top:20px;
    }

</style> 
```

它工作正常 f.ex。在 Chrome 中，但不是 Firefox 14 和 Opera 12（带有各自的 -o-transition）。我尝试了唯一的“过渡”属性但没有效果。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-26T16:41:54.550

你不能从 过渡`auto`到`20px`。将其显式设置为`0px`in `#inner {}`。

# html - 有没有一种 HTML/CSS 方式来显示 HTML 标签而不需要解析？

> ID：11673978
> 
> 赞同：26
> 
> 时间：2012-07-26T16:38:26.923
> 
> 标签：html, css, character-encoding, special-characters

有什么方法可以在不解析的情况下显示 HTML 标签？像以前一样完美的标签`XMP`，但现在它被替换`PRE`为不太酷的标签。看看这个例子：

```
//This used to NOT PARSE HTML even if you used standard < and >.
<XMP>
<a hred="http://example.com">Link</a>
</XMP>

//New PRE tag requires &lt; and &gt; as replacement for < and >.
<PRE>
&#60;a href="http://example.com"&#62;Link&#60;/A&#62;
</PRE> 
```

我正在寻找的是相当于旧的 XMP 标签。新的 PRE 标签将解析代码。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-08-01T04:22:16.530

您可以使用`script`带有 set 的元素`type`来表示纯文本，并将其`display`属性设置为`block`. 这只会影响解析行为：除了元素本身的结束标签外，不会识别任何标记（标签或实体或字符引用）`</script>`。（因此，它与识别标签的位置不完全相同。*）*您可以单独使空白处理类似于和/或默认情况下将字体设置为等宽字体。`xmp``</xmp>``xmp``pre`

例子：

```
<style>
    script {
        display: block;
    }
</style> 
```

然后在文档正文中：

```
<script type="text/plain">
    <i>&eacute;</i>
</script> 
```

在最新版本的 IE、Chrome、Firefox、Opera 上测试。在 IE 9 上的 IE 8 和 IE 7 仿真中不起作用，但这可能是仿真中的一个错误。

但是，我不明白您为什么要使用 this 而不是`xmp`，它并没有停止工作。它不在规格中，但如果你担心这一点，你应该一直担心。在 HTML 2.0（有史以来第一个 HTML 规范）中提到可以避免，但在 HTML 3.2 中已弃用，并在 HTML 4.0 中完全删除（很久以前：1997 年）。

它`xmp`正在卷土重来而不是死去。W3C HTML5（W3C 工作人员将其描述为当前的 HTML 规范）声明`xmp`为已过时且不符合标准，但它也对浏览器提出了[要求](http://www.w3.org/TR/html5/obsolete.html#other-elements-attributes-and-apis)：“用户代理必须以在语义和目的方面`xmp`等同于元素的方式对待元素`pre`的渲染。（尽管解析器对这个元素有特殊的行为。）”因此，旧的解析行为不是明确要求的，而是明确暗示的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-16T09:50:49.237

我个人认为使用`<code> </code>`标签只能在 Dream Weaver 中使用，并且标签`<xmp> </xmp>`永远不会停止工作，除非你把`</xmp>`它放进去可以正常工作。使用`<textarea> </textarea>`使得其他人可以在网站或页面上编辑您的代码，因此我建议`<xmp> </xmp>`仍然使用该标签并且该标签仍然存在。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-01-06T01:15:17.557

现代方法是使用带有（布尔）属性的 textarea 只读。您可以使用 XMP，但这已被弃用，因此最终可能会停止支持。
例子：

```
<textarea readonly='true'>
    <p>This is some text</p>
</textarea> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-12-27T04:49:05.517

然后......几年过去了，我在将我的博客从 wordpress 转换为由 lambda 和 dynamodb 支持的 vuejs spa 时遇到了同样的问题。

答案是；至少在我的情况下。逃离实体。

`&lt;`变成`&amp;lt;`

`&gt;`变成`&amp;gt;`

等等等等

希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-26T16:42:57.957

没有。

理论上你可以使用 CDATA 块，但没有浏览器支持 text/html 模式。

使用字符引用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-11-14T00:55:27.477

如果您想要更复杂，另一种方法是使用 jQuery 创建自定义标签。对于这个例子，我使用了`<noparse>`.

```
$('noparse').each(function(){
    if($(this).attr('tagchecked') != 'true'){ //checks if already changed tag
        $(this).text($(this).html()).attr('tagchecked', 'true'); //makes the html into plaintext
    }
}); 
```

JSFiddle[在这里](http://jsfiddle.net/GeekyGamer14/6eBxK/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-01-03T03:02:57.800

我建议使用 html iframe 标记并将您想要显示的文本放在 src 属性中。你只需要先对它进行 url 或 base64 编码。

```
example (urlencoded):
<iframe src="data:text/plain,%22%3Chello%3E%22"></iframe>

example (base64):
<iframe src="data:text/plain;base64,IjxoZWxsbz4i"></iframe>

Result displayed as:
"<hello>" 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-07-26T16:40:42.503

从技术上讲，您可以使用，但它要求您尝试显示的代码中`<textarea>`没有标签。`</textarea>`只是更容易逃脱`<`.

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-07-26T16:49:07.503

好吧，一种方法是使用 jQuery。jQuery .text() 方法将对特殊字符进行编码。如果您查看源代码，原始未编码的文本将保留。

```
<div id="text">
    <a href="">This is an anchor</a>
</div>

<script>
    var t = $('#text'); t.html(t.text());
</script> 
```

# c++ - 无法更改 volatile 变量的值

> ID：11673984
> 
> 赞同：1
> 
> 时间：2012-07-26T16:38:38.083
> 
> 标签：c++, volatile

描述：

当变量定义为 volatile 时（在 Main 中），我无法设置或更改它。删除 volatile 解决了这个问题，但我需要我的变量是 volatile。

我的尝试：

真的有很多尝试。重载 operator=，使 new operator= volatile，使 new volatile 方法。到目前为止，实际上没有任何效果。

我的主要：

```
int main() {
    volatile PlaceParentConversion s(10.0); // remove volatile = no errors
    std::cout << s.mX << std::endl;
    s = PlaceParentConversion::IDENTITY_CONVERSION;
    std::cout << s.mX << std::endl;
    return 0;
} 
```

我的课：

```
class PlaceParentConversion {
public: //all public, easier to check
    const static PlaceParentConversion IDENTITY_CONVERSION;
    double mX;
    PlaceParentConversion(const double x);
    PlaceParentConversion(const PlaceParentConversion& other);
};

const PlaceParentConversion PlaceParentConversion::IDENTITY_CONVERSION(0);

PlaceParentConversion::PlaceParentConversion(const double x) : mX(x) {}
PlaceParentConversion::PlaceParentConversion(const PlaceParentConversion& other) : mX(other.mX) {} 
```

错误：

```
‘volatile PlaceParentConversion’ as ‘this’ argument of ‘PlaceParentConversion& PlaceParentConversion::operator=(const PlaceParentConversion&)’ discards qualifiers [-fpermissive] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:45:27.793

定义`volatile`赋值运算符：

```
Foo volatile & operator=(Foo const & rhs) volatile
{
    // ...
    return *this;
} 
```

（为了便于阅读，我缩短了你的类名。）

* * *

这是一个更完整的示例：

```
struct Foo
{
    Foo() { }
    Foo(Foo const volatile &) { }
    Foo volatile & operator=(Foo const &) volatile
    { return *this; }
};

int main()
{
    volatile Foo x;
    Foo y;
    static_cast<Foo>(x = y);
} 
```

最后一行中的静态转换使 GCC 不会发出警告，即没有对 volatile 对象进行访问，这是赋值表达式的评估结果：标准说在 void 上下文中没有左值到右值转换，因此无法访问。我们使转换显式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:45:36.433

是的，这是正确的，因为你没有`volatile PlaceParentConversion& operator =(const PlaceParentConversion&) volatile;`

# mod-rewrite - Apache Mod 重写规则特殊条件

> ID：11673989
> 
> 赞同：0
> 
> 时间：2012-07-26T16:39:08.533
> 
> 标签：mod-rewrite

我试图将一个旧域重定向到它的新域，但是我需要制定一些规则，到目前为止我还没有设法让它完全正确。

旧域，例如 www.old-domain.com 在英国城镇之后有数百个文件夹名称，如下所示：

www.old-domain.com/sheffield/ www.old-domain.com/london/ www.old-domain.com/essex/

这些文件夹中的每一个都包含一个 index.html 文件和可能的其他目录和文件。

我需要以这样的方式将它们重定向到新域，以便旧域/城镇映射到新域/城镇但旧域/城镇/index.html 不会将 index.html 放在新域端但是如果路径之后town 是 index.html 以外的任何东西，可以在新域上重定向到它。
抱歉，这不是最容易解释的，也不是最容易阅读和理解的，我敢肯定。

**www.old-domain.com/sheffield => www.new-domain.com/sheffield**

**www.old-domain.com/sheffield/ => www.new-domain.com/sheffield/**

www.old-domain.com/sheffield/index.html => www.new-domain.com/sheffield/

www.old-domain.com/sheffield/main.html => www.new-domain.com/sheffield/main.html

www.old-domain.com/sheffield/innerFolder/ => www.new-domain.com/sheffield/innerFolder

www.old-domain.com/sheffield/innerFolder/file.php => www.new-domain.com/sheffield/innerFolder/file.php

上面粗体的两个我设法通过这个来工作：

```
Options +FollowSymLinks
RewriteEngine on
RewriteRule ^sheffield/(.*)$ http://www.new-domain.com/sheffield/$1 [R=301,L] 
```

但是，我真的很难让 old-domain.com/sheffield/index.html 不把 .index.html 放在新域上。

在我把头发拉出来盯着 mod rewrite 教程再看几个小时之前，任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:44:00.107

提示：重写规则在第一个匹配的基础上处理。您可以将例外放在主要规则之前

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T09:40:51.853

经过大约 4-5 小时的尝试不同的组合和阅读上帝知道我设法到达那里的重写教程。这是仅 3 个位置的 htacess 文件，现在它们都工作得很好。

```
Options +FollowSymLinks
RewriteEngine on

RewriteRule ^sheffield\/index\.html http://www.new-domain.co.uk/sheffield/ [R=301,L]
RewriteRule ^sheffield/(.*)$ http://www.new-domain.co.uk/sheffield/$1 [R=301,L]

RewriteRule ^bolton\/index\.html http://www.new-domain.co.uk/bolton/ [R=301,L]
RewriteRule ^bolton/(.*)$ http://www.new-domain.co.uk/bolton/$1 [R=301,L]

RewriteRule ^coventry\/index\.html http://www.new-domain.co.uk/coventry/ [R=301,L]
RewriteRule ^coventry/(.*)$ http://www.new-domain.co.uk/coventry/$1 [R=301,L] 
```

# arrays - 访问数组内的实例属性

> ID：11673991
> 
> 赞同：0
> 
> 时间：2012-07-26T16:39:20.803
> 
> 标签：arrays, flash, actionscript, instance, multidimensional-array

我已将多个图像导入到 actionScript 3 文档中。我已将它们全部转换为符号（电影剪辑）并赋予它们实例名称以从 ActionScript 中引用。

好的，所以我将实例放入一个数组中，这样我就可以轻松地遍历它们，但是由于某种原因，每当我输入实例名称时，我都会跟踪数组中的值，它给了我符号对象返回，而不是实例对象。

基本上试图遍历数组以使每个实例的可见性 = false

这是一个示例：

```
var large_cap_extrusion_data: Array = new Array();
large_cap_extrusion_data[0] = large_cap_extrusion_menu_button;
large_cap_extrusion_data[1] = extrusion_border_large_cap
large_cap_extrusion_data[2] = "Large Cap";
large_cap_extrusion_data[3] = large_cap_main_menu_button;

var extrusion_data: Array = new Array();
extrusion_data[0] = large_cap_extrusion_data;

trace(extrusion_data[0][0]); 
```

痕迹给出：

```
[object large_cap_menu_button] 
```

（父符号）

而不是：

“large_cap_extrusion_menu_button”

如果有人能告诉我哪里出错了，我将不胜感激...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:15:27.177

当您跟踪和对象时，默认情况下它会描述它的类型。您想要的是对象的“名称”属性。试试这个：trace(extrusion_data[0][0].name); 这应该为您提供 large_cap_menu_button 的实例 nema 而不是类描述。无论哪种方式，我打赌你都有正确的对象。

# objective-c - 重载 NSManagedObjects 类别中的方法名称会在 Xcode 4.4 及更高版本中发出警告

> ID：11673996
> 
> 赞同：0
> 
> 时间：2012-07-26T16:39:33.553
> 
> 标签：objective-c, ios, xcode, core-data, categories

我的每个`NSManagedObject`子类都有一个类别，工厂方法位于其中，因此在自动重新生成类文件时它们不会丢失。这样我就不需要知道`NSManagedObject`我在运行时使用的是哪个子类，每个子类的工厂方法都具有相同的名称，例如

```
+ (id)objectWithInfo:(NSDictionary *)info inManagedObjectContext:(NSManagedObjectContext *)context; 
```

（为了清楚起见，在此示例中，假设有一个派生自`NSManagedObject`被调用的实体`Item`，具有生成的文件 Item.m 和 Item.h，以及我自己的具有文件 Item+Factory.m 和 Item+Factory.h 的类别，上面的方法所在的位置）。

在 Xcode 4.3 中，这不会产生警告：但 Xcode 4.4（及更高版本将其标记为警告：

> (null): ...Item+Factory.o 类别中的元方法“objectWithInfo:inManagedObjectContext:”与另一个类别中的相同方法冲突

现在，我很清楚在类别中重载方法的危险，这是一件坏事。然而，我在这里所做的只是将对象视为比它们更一般的类，据我所知，这是明智的。

难道我做的不好？还是有不同的方法来声明我的方法来删除警告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:53:58.493

回答我自己的问题：

我在每个子类的标题中重新声明了该方法。在超类中声明一次对其进行了排序。

此外，将所有 +Factory.h #imports 移动到预编译的头文件中（并在其他地方删除）大大减少了混乱和额外的警告。

感谢 Paul.s 让我沿着这些思路思考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:56:42.073

您可能可以将该方法概括为对所有对象以相同的方式工作

```
+ (id)ps_insertNewObjectForEntityForName:(NSString *)entityName inManagedObjectContext:(NSManagedObjectContext *)context objectInfo:(NSDictionary *)objectInfo;
{
    NSManagedObject *managedObject = [self insertNewObjectForEntityForName:entityName inManagedObjectContext:context];

    [objectInfo enumerateKeysAndObjectsUsingBlock:^(id key, id obj, BOOL *stop) {
        [managedObject setValue:obj forKey:key];
    }];

    return managedObject;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T17:00:04.397

看起来您是自己发现的，但为了向未来的读者澄清：

由于您要向 NSManagedObject 添加所有子类都需要重载的功能，因此最好的方法可能是创建 NSManagedObject 的通用子类，然后它可以作为 Item 之类的超类。（子类化旨在以这种方式工作，但类别不是。）例如：

```
// ABCManagedObject.h
@interface ABCManagedObject : NSManagedObject
+ (id)objectWithInfo:(NSDictionary *)info inManagedObjectContext:(NSManagedObjectContext *)context;
@end

// ABCManagedObject.m
@implementation ABCManagedObject
+ (id)objectWithInfo:(NSDictionary *)info inManagedObjectContext:(NSManagedObjectContext *)context
{
    // no-op; use subclasses instead.
}
@end

// Item.h
@interface Item : ABCManagedObject
@end

// Item.m
@implementation Item
+ (id)objectWithInfo:(NSDictionary *)info inManagedObjectContext:(NSManagedObjectContext *)context
{
    // create and initialize new object and return it
}
@end 
```