# StackOverflow 问答 000707000-000707999

# ip-address - IP 子网表示法

> ID：707002
> 
> 赞同：46
> 
> 时间：2009-04-01T19:28:48.107
> 
> 标签：ip-address, notation, subnet

在一个使用端口扫描器处理网络拓扑的实验室中，我被指示“为 123.218.44.0/24 子网开发网络清单和拓扑”。

符号 0/24 在那里是什么意思？我以为这意味着要考虑网络范围 123.218.44.0 到 123.218.44.24。当我对范围使用 nmap 时，使用以下格式的参数：

```
nmap -sS -O 123.218.44.0/24 
```

nmap 报告它扫描了 256 个主机，大概是 123.218.44.0 到 123.218.44.255。0 到 24 之间只有一台主机，但 101 到 255 之间有 4 台主机。我假设我打算找到所有 5 台主机，但我不明白表示法，所以我不确定。谁能为我澄清一下？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-04-01T19:34:36.627

那是[无类域间路由](http://en.wikipedia.org/wiki/CIDR_notation)表示法。/24 表示子网的路由前缀是 24 位长，这意味着子网本身只剩下 8 位，即 123.218.44.0 到 123.218.44.255

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-02T13:26:30.497

/24 表示掩码为 255.255.255.0

其他海报关于 /24 是 CIDR 是正确的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-01T19:34:23.413

“0/24”是[CIDR 表示法](http://en.wikipedia.org/wiki/CIDR_notation)。[这是表示子网掩码](http://en.wikipedia.org/wiki/IP_Subnet_Mask#Binary_subnet_masks)的标准方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-16T12:57:12.083

/24 表示 255.255.255.0 是 C 类 IP 地址的默认子网掩码，它有 16777216 个子网和 254 个主机

# sql - 如何从 MySQL 表中选择行，该表按一列分组，另一列具有所需值

> ID：707004
> 
> 赞同：2
> 
> 时间：2009-04-01T19:28:56.687
> 
> 标签：sql, mysql, database

我需要过滤某些属性存储在与所有必需属性匹配的连接表中的产品，即用户需要能够通过添加要求逐渐缩小搜索范围。

鉴于以下（简化的）产品属性表，问题实际上只涉及我认为的属性表，而不是连接：

```
id product_id 属性值
---------------------------------
1 1 红色
2 1 小号
3 2色红色
4 2 大号

```

我如何获得 value 既是 'red' 又是 'small' 的所有 product_ids ？

[之前有人问](https://stackoverflow.com/questions/329822/mysql-strict-select-of-rows-involving-many-to-many-tables)过类似的问题，但没有完全回答。一个解决方案涉及 COUNT 和 HAVING 来获取每组中的行数与所需值一样多的行，例如

```
SELECT product_id, count(*) AS group_count FROM properties where
value = 'red' OR value = 'small'
GROUP BY product_id
HAVING group_count = 2 
```

这可行，但我担心性能，似乎会有更好的方法。

最终这将需要加入或至少用于过滤产品表：

```
身份证名称     
-------------
1 产品 1
2 产品 2

```

我忘了提到我有 2 个这些属性表加入了我需要过滤的产品，一个具有产品的常规属性，另一个具有可用的可配置选项（有点像变体）。该方案是允许用户过滤产品，例如：“显示性别='男'，品牌='耐克'和尺寸=='小'的产品”，其中性别和品牌是“属性”，尺寸在选项中（可配置时添加到购物车）

使用带有计数的组的解决方案仍然适用于 2 个连接的表，但它会变得混乱，所需的组计数是第一个表上所需选项的数量乘以第二个表上的数字。

我可以从属性（和另一个表）中获取 id，然后只做一个选择 where id IN(ids)，匹配两个属性表的一组 id，我不喜欢用很长的时间来做这个的想法id 列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T19:36:42.347

不确定这是否更快，但从您的过滤条件生成的子查询的连接将起作用：

```
Select p.name, p.id from product p, 
(select product_id from properties where value='red') colors,
(select product_id from properties where value='small') sizes
where p.id=colors.product_id and p.id=sizes.product_id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T19:39:39.810

```
SELECT DISTINCT p1.product_id, pn.name 
FROM properties p1, properties p2,
     productNames pn
WHERE p1.product_id = p2.product_id
AND p1.property = 'size' and value = 'small'
AND p2.property = 'color' and value = 'red'
AND pn.id = p1.product_id 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T19:54:47.187

您可以将表连接到自身：

```
SELECT
prop1.product_id
FROM
properties prop1
JOIN properties prop2
    ON prop1.product_id = prop2.product_id
WHERE
prop1.property = 'color' and prop1.value = 'red'
and prop2.property = 'size' and prop2.value = 'small' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T20:00:01.867

又一次遇到了属性值数据模型的一个陷阱。

假设您想要“颜色”与“红色”匹配且“尺寸”与“小”匹配的产品（您没有在问题中说属性实际上很重要，只是价值），问题的很大一部分是，您如何表示所需匹配的列表？它们会作为分隔字符串传递、存储在临时表中、动态构建的 SQL 还是其他？

如果您可以将它们放入表中（临时或其他），那么以下查询应该可以工作。由于存在子查询，性能将在很大程度上取决于您正在使用的数据量以及如何对其进行索引。此外，如果您最终在同一产品的表中出现重复的属性，那么它可能会丢掉一些东西，因此您可能需要考虑这一点。

```
SELECT
    P.*
FROM
    Products P
WHERE
    NOT EXISTS
    (
        SELECT
            *
        FROM
            Product_Search_Template PST
        LEFT OUTER JOIN Properties P2 ON
            P2.property = PST.property AND
            P2.value = PST.value AND
            P2.product_id = P.product_id
        WHERE
            P2.id IS NULL
    ) 
```

.

```
SELECT
    P.*
FROM
(
    SELECT
        PROP1.product_id,
        COUNT(*) AS match_count
    FROM
        Properties PROP1
    INNER JOIN Product_Search_Template PST ON
        PST.property = PROP1.property AND
        PST.value = PROP1.value
    GROUP BY
        PROP1.product_id
) SQ
INNER JOIN Products P ON
    P.product_id = SQ.product_id
WHERE
    SQ.match_count = (SELECT COUNT(*) FROM Product_Search_Template) 
```

# ruby-on-rails - 折叠旧的 Rails 迁移是个好主意吗？

> ID：707013
> 
> 赞同：15
> 
> 时间：2009-04-01T19:32:58.097
> 
> 标签：ruby-on-rails, migration

到目前为止，我正在开发的 Rails 应用程序大约有 35 次迁移。由于该应用程序是作为一个实验开始的，当我在不同的想法之间来回切换时，迁移中有相当多的无意义的搅动。

将迁移 1-35 合并为一个迁移有什么缺点吗？我打算通过让第一次迁移加载现在的模式并删除所有以前的迁移来做到这一点。

我目前是唯一一个在这个项目上工作的人，如果这有什么不同的话。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-01T20:45:00.700

如果您的代码受源代码控制（您的代码*确实*受源代码控制，不是吗？），那么我会说没有真正的危害，只要您接受回滚架构更改将需要恢复旧的迁移或全新的迁移。在确定任何事情之前，请确保您了解其中的含义并接受它们。

您当前的 schema.rb 可以构成一个新的单一迁移的基础，该迁移将开始一个新的集合。

请注意，如果您在现有迁移中进行数据操作操作，例如静态数据加载和/或可能的后续转换，则需要在某个地方处理这些操作。这是我绊倒过几次的东西...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-01T19:37:25.853

我会把它们留在身边。不必担心每次新开发人员签出项目时都必须运行大量迁移。他总能跑

```
rake db:schema:load 
```

这要快得多，而不是运行

```
rake db:migrate 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-02T01:06:44.097

有时迁移可能会使用不再存在的模型或创建表，然后再销毁它们，从而浪费宝贵的 CPU 时间。最好将其全部编译到*db/schema.rb*并让您的开发人员运行`rake db:schema:load`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-01T21:25:16.173

如果您的所有迁移只是修改您的表结构，我就不会担心这一切。

请记住，尽管某些迁移会添加数据——我有一些使用管理员帐户和其他固定数据为数据库播种的迁移——但架构不会给你这个。

请注意，因为我不在部署中使用迁移，所以对迁移做我所做的事情是个坏主意。因此，暂时将这些数据播种迁移移动到单独的 rake 任务中，折叠迁移可能是一个好主意。

在审查中-我正在回应已经提出的观点。 `rake db:migrate VERSION -1`

[我责怪令人分心的新动画徽标将我的视线从文字上移开]

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-25T00:39:05.443

没有害处，折叠迁移是一种很好的做法，并且在确实需要运行迁移时有助于提高性能。这现在是 Rails 的 schema.rb 的一部分：

```
# Note that this schema.rb definition is the authoritative source for your
# database schema. If you need to create the application database on another
# system, you should be using db:schema:load, not running all the migrations
# from scratch. The latter is a flawed and unsustainable approach (the more migrations
# you'll amass, the slower it'll run and the greater likelihood for issues). 
```

请注意@mike-woodhouse 所说，“请注意，如果您在现有迁移中进行数据操作操作，例如静态数据加载和/或可能的后续转换，则需要在某个地方处理这些操作。”

但无论如何，你不应该在你的迁移中做任何事情:)——乍得

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-10-19T19:42:53.240

对于那些像我一样在寻找**将应用程序重置为其原始状态**的方法时找到此答案的人，请执行以下操作：

```
rm db/migrations/*
rake db:drop
rake db:schmea:dump 
```

如果您刚刚启动一个应用程序并决定从头开始重建它而不丢失所有文件，这将非常有用。

# c++ - 为什么 VC++ 字符串不被引用计数？

> ID：707014
> 
> 赞同：14
> 
> 时间：2009-04-01T19:33:00.310
> 
> 标签：c++, string, visual-c++, reference-counting, copy-on-write

STL 标准不要求从 std::string 被引用。但事实上，大多数 C++ 实现都提供了引用计数、写入时复制的字符串，允许您将字符串作为原始类型按值传递。此外，这些实现（至少 g++）使用原子操作使这些字符串无锁且线程安全。

简单的测试显示了写时复制语义：

```
#include <iostream>
#include <string>

using namespace std;

void foo(string s)
{
    cout<<(void*)s.c_str()<<endl;
    string ss=s;
    cout<<(void*)ss.c_str()<<endl;
    char p=ss[0];
    cout<<(void*)ss.c_str()<<endl;
}

int main()
{
    string s="coocko";
    cout<<(void*)s.c_str()<<endl;
    foo(s);
    cout<<(void*)s.c_str()<<endl;
} 
```

在使用非常量成员之后，仅打印两个地址。

我使用 HP、GCC 和 Intel 编译器测试了这段代码，得到了类似的结果——字符串作为写时复制容器工作。

另一方面，VC++ 2005 清楚地表明每个字符串都是完全复制的。

**为什么？**

我知道 VC++6.0 中有一个错误，它具有非线程安全的引用计数实现，导致随机程序崩溃。这是原因吗？他们只是害怕再使用引用计数，即使这是常见的做法？他们宁愿完全不使用引用计数来解决问题？

谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-01T19:40:38.187

我认为越来越多的`std::string`实现将远离引用计数/写时复制，因为它通常是多线程代码中的反优化。

请参阅 Herb Sutter 的文章[优化不是（在多线程世界中）](http://www.gotw.ca/publications/optimizations.htm)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-01T19:59:00.637

STL 实际要求如果您使用引用计数，则语义与非引用计数版本的语义相同。这对于一般情况来说并非微不足道。（这就是为什么你不应该写你的字符串类）。

由于以下情况：

```
std::string   x("This is a string");
char&         x5 = x[5];
std::string   y(x);

x5 = '*'; 
```

请参阅：[http](http://www.sgi.com/tech/stl/string_discussion.html) ://www.sgi.com/tech/stl/string_discussion.html了解更多详情

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-02T19:01:11.713

正如 Martin 和 Michael 所说，写时复制 (COW) 往往比它的价值更麻烦，要进一步阅读，请参阅*Kelvin Henney*撰写的这篇关于[疯狂牛病](http://www.ddj.com/cpp/184403779)的优秀文章，我相信是*Andrei Alexandrescu*说**小字符串优化**表现更好在许多应用程序中（但我找不到文章）。

小字符串优化是您使字符串对象更大并避免小字符串的堆分配的地方。玩具实现看起来像这样：

```
class string {
    char *begin_, *end_, *capacity_;
    char buff_[64]; // pick optimal size (or template argument)
public:
    string(const char* str)
    {
        size_t len = strlen(str);
        if (len < sizeof(buff_))
        {
            strcpy(buff_, str);
            begin_ = buff_;
            capacity_ = buff_ + sizeof(buff_);
        }
        else
        {
            begin_ = strdup(str);
            capacity_ = begin_ + len;
        }
        end_ = begin_+len;
    }

    ~string()
    {
        if (begin_ != buff_)
            free(begin_); // strdup requires free 
    }
    // ...
}; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-01T19:43:40.877

也许微软认为字符串复制不是一个大问题，因为几乎所有 C++ 代码都尽可能使用通过引用传递。维护一个引用计数在空间和时间上有开销（忽略锁定），也许他们认为不值得付出。

或者可能不是。如果您对此感到担忧，您应该分析您的应用程序以确定字符串复制是否是主要开销，以及是否切换到不同的字符串实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-01T19:46:18.330

这不是主要原因，但我在 win32 平台下看到很多不正确的代码，它们执行类似`const_cast< char* >( str.c_str() )`.

也许微软知道这一点并关心开发人员:)

# .net - .Net PropertyGrid 线程安全

> ID：707016
> 
> 赞同：1
> 
> 时间：2009-04-01T19:33:22.760
> 
> 标签：.net, multithreading, propertygrid

我的应用程序中有一个`PropertyGrid`用于编辑任意对象。我需要能够在另一个查看这些对象的线程上运行任意子例程（搜索功能，如果你好奇的话）。显而易见的问题是，用户可能在我的搜索线程正在读取其中一个对象的同时正在编辑它，最好避免这种情况（尽管它可能不会导致任何关键问题，因为我的搜索线程只是在读取，不写）。

从我的搜索线程中调用`lock(obj)`很容易，但是在浏览了文档并简要浏览了 Reflector 中的 PropertyDescriptorGridEntry 代码后，我似乎找不到类似的位置来`System.Threading.Monitor.Enter()/Exit()`调用 PropertyGrid 上的相关对象。我希望有 BeginEdit 和 EndEdit 事件可以使这变得足够简单，但我似乎找不到任何这样的东西。我宁愿在 PropertyGrid 中显示时不锁定整个对象，因为这显然会阻塞我的搜索线程，直到选择另一个对象。

我对 Windows 窗体的线程模型有点陌生，所以我希望有一些我刚刚忽略的明显答案。有什么帮助吗？

**编辑：**在异步运行搜索之前同步克隆我的对象可能效率很低，以至于我还不如同步运行搜索本身 - 异步运行的目的当然是让我的用户在搜索执行时继续工作。搜索需要很好地扩展，因为我正在经历的数据集最终会变得任意大，这使得同步克隆看起来会导致我试图避免的可用性问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T19:37:22.033

那确实不是线程安全的。您可以将搜索代码的一部分编组到 UI 线程，但这会减慢速度，并且可能会破坏线程的要点......

搜索需要多快？你能对付克隆人吗？ETC

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T19:37:43.280

您可以在显示数据之前克隆数据，并让您的搜索线程在克隆上工作吗？如果您希望搜索线程“看到”更改，您可以响应事件，`PropertyGrid`并可能以某种方式对克隆进行*受控*更改。（不过，使用“陈旧”数据可能更容易。）

我知道克隆数据听起来非常低效，但是当每个线程处理完全独立的数据（或所有线程只读取）时，线程肯定更简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T19:40:29.030

我认为您将不得不为此做很多工作。

首先，您必须创建 ICustomTypeDescriptor 的实现，该实现将基于您通常为该类型获得的任何 TypeDescriptor。

然后，在公开要锁定的成员的描述符的方法的实现中，您将提供从这些描述符派生的子类并覆盖适当的方法以包裹锁定。

因此，对于一个属性，您将实现 GetProperties 以返回您的 PropertyDescriptor 的特定子类。这些子类将覆盖 GetValue 和 SetValue 方法（以及其他方法）并在访问这些变量时使用锁。

应该提到的是，在 UI 线程中像这样锁定可能是一个坏主意，因为您不想随意阻止该线程上的操作。最好只创建对象的克隆，然后有一个方法在完成后更新对象的存储。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T23:41:40.120

我可能是错的，但在我看来，你来自错误的一端。

您需要解决两个不同的问题。

首先，确保仅在 UI 线程上访问 PropertyGrid。如果从其他线程访问它的任何方法（包括属性 getter/setter），您将以神秘的方式遭受痛苦。当然，例外是`InvokeRequired()`和`Invoke`。

其次，确保您的搜索线程可以正常运行。

要解决第一个问题，*要么*确保你的对象*除了*UI 线程之外永远不会被修改，*或者*让你的所有事件触发器线程都知道，以便你的对象事件（例如 PropertyChanged）只在 UI 线程上触发。

第二个问题更容易——只要你的搜索线程只从你的核心对象中读取，一切都应该正常工作。是的，您的搜索线程可能会无意中看到一些部分更新的数据，但这真的是个问题吗？

最后的一些想法......

*   不要实现您的搜索来遍历 PropertyGrid 本身；预先获取对象列表（它们不需要是克隆）并通过它来代替。

*   您是否考虑过使用空闲处理进行搜索？每当应用程序用完要处理的消息时，该`Application`对象就会触发一个事件 - 您可以挂钩并在每次触发事件时执行搜索的 1 步。一种穷人线程，但没有互斥锁/锁/信号机头痛。我过去用这个效果很好。

**更新**：如果我没记错的话，PropertyGrid 尊重[`IEditableObject`](http://msdn.microsoft.com/en-us/library/system.componentmodel.ieditableobject.aspx)接口，[`BeginEdit`](http://msdn.microsoft.com/en-us/library/system.componentmodel.ieditableobject.beginedit.aspx)在您开始修改一行以及[`EndEdit`](http://msdn.microsoft.com/en-us/library/system.componentmodel.ieditableobject.endedit.aspx)移动到另一行时立即调用。您可以利用它来防止您的搜索线程看到不完整的更改。

**更新 2**：跟进，我发现了你已经知道的 - PropertyGrid*不*尊重 IEditableObject 接口。

我确实有另一个建议——尽管它可能比你想投资的要多。

大约在 .NET 2.0 中引入 System.Transactions 命名空间时，我看到了一篇关于使用环境事务为对象提供线程隔离的文章。这个想法是您的对象属性具有双重存储。首先，您拥有对所有线程可见的已提交值，并且您拥有一个线程局部变量，用于在每个线程的基础上存储未提交的值。修改属性时，对象通过将新值存储在本地线程中来加入任何环境事务。当事务提交或回滚时，线程的值要么被存储要么被丢弃。

不幸的是，我找不到原始文章，尽管 CSLA 似乎提供了这种支持。希望这可以帮助。

# asp.net - ASP.NET 解决方案的典型结构？

> ID：707017
> 
> 赞同：12
> 
> 时间：2009-04-01T19:33:22.963
> 
> 标签：asp.net, namespaces, solution

正如标题所说，我很想知道您通常如何构建 ASP.NET 解决方案。

我对**ASP.NET 网站**解决方案特别感兴趣，但与其他类型（WebApplication、MVC）相关的信息也可能很有趣。

一些具体问题：

*   解决方案包含什么/多少项目/程序集
*   你如何命名你的类库项目
*   你通常有什么命名空间
*   每个项目/程序集是否有多个命名空间，或者是否有严格的 1:1 关系
*   等等

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T19:55:23.017

我的一个项目如下所示：

*   Sln
    *   核心
    *   Sln.Core.Test
    *   数据
    *   Sln.Data.Test
    *   网络
    *   网络测试

核心是域模型和域服务，只要它们可以在不涉及持久性的情况下完成。数据是持久层，基本上就是FluentNHibernate定义和Core中定义的接口的具体实现。Web是前端层。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T22:42:35.853

我做过类似正义的事情。但是项目更少（编译时间更快）

Sln

*   项目.Core
*   项目网站
*   项目测试

Project.Core 看起来像这样

*   存储库
*   领域
*   主持人
*   服务
*   看法
*   常见的

我并没有真正从多个（超过 3 个）项目中受益。您不会获得可测试性，并且您的编译时间会变得更长。

另外，当我得到一个网站项目时，我做的第一件事就是将它转换为一个 Web 应用程序。但总的来说，当我在网站和 Web 应用程序之间切换时，我的项目并没有改变。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T19:41:43.253

我通常使用应用程序的名称作为解决方案名称（使用通用的“解决方案”项目类型），然后将 SolutionName.Site、SolutionName.Domain、SolutionName.Persistence 等用于它包含的项目。它似乎更容易处理所有引用。

不过我想看看其他人的答案。虽然这是我发现的最好的方式，但我无法摆脱可能会有更好的方式的感觉。

# vb.net - Visual Basic 中的标签

> ID：707021
> 
> 赞同：0
> 
> 时间：2009-04-01T19:34:42.070
> 
> 标签：vb.net, winforms

在 Visual Basic 中，当您在表单视图中（通过单击和拖动）创建标签时，是否可以使标签同时包含字符串和变量？

*

```
turns=1
label1.text = ("Turn:"(turns)) 
```

*

例如，这样标签 1 将显示

```
*Turn 1* 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T19:37:04.373

`label1.text = "Turn: " & turns.ToString()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T19:37:29.690

你说的是 VB.Net，还是别的什么？

在 .Net 中：

```
turns = 1
Label1.Text = $"Turn {turns}" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T19:39:14.710

每个控件都具有`Tag`可以存储任何对象引用的属性。但是，您不能轻易地给标签一种“格式字符串”，然后在您更改变量时让它更新，如果这是您的想法的话。

如果您*只是*在谈论格式化标签以在文本中使用变量的值，那么您不能在设计器中执行此操作 - 您必须在代码中的某处执行此操作（例如，在构造函数中，在设计器代码之后已被调用）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-28T10:51:16.457

您不能在设计器窗口中执行此操作（您可以在其中进行表单的定位和布局）。您必须在代码中实现该功能。

假设标签的名称是**Label1**，您可以在希望更改标签文本的位置编写此代码。例如，在转数变化时调用的事件处理程序、函数或子程序中。

```
Label1.Text = "Turn: " & turns.ToString() 
```

# python - 是否有与 Python 的 `if __name__ == '__main__'` 等价的 Perl？

> ID：707022
> 
> 赞同：32
> 
> 时间：2009-04-01T19:35:15.937
> 
> 标签：python, perl, executable

有没有办法确定当前文件是否是在 Perl 源代码中执行的文件？在 Python 中，我们使用以下结构来做到这一点：

```
if __name__ == '__main__':
    # This file is being executed.
    raise NotImplementedError 
```

`FindBin`我可以使用and一起破解一些东西`__FILE__`，但我希望有一种规范的方式来做到这一点。谢谢！

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-04-01T19:39:55.410

```
unless (caller) {
  print "This is the script being executed\n";
} 
```

见[来电者](http://perldoc.perl.org/functions/caller.html)。它`undef`在主脚本中返回。请注意，这在子例程中不起作用，仅在顶级代码中起作用。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-01T19:43:18.493

[请参阅brian d foy](https://stackoverflow.com/users/8817/brian-d-foy)的文章[五种改进 Perl 编程的方法中](http://www.onlamp.com/pub/a/onlamp/2007/04/12/five-ways-to-improve-your-perl-programming.html)的“应用程序的子类（第 18 章）”部分。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-02T15:00:16.463

`unless caller`很好，但更直接的并行以及更*明确的检查*是：

```
use English qw<$PROGRAM_NAME>;

if ( $PROGRAM_NAME eq __FILE__ ) { 
    ...
} 
```

只是以为我会把它放在那里。

**编辑**

请记住，`$PROGRAM_NAME`（或' `$0`'）是可写的，所以这不是绝对的。但是，在大多数实践中——除了事故或暴发模块——这可能不会改变，或者最多在另一个范围内[本地改变。](http://search.cpan.org/perldoc?perlfunc#local)

# python - Windows XP 网络上的连接被拒绝

> ID：707023
> 
> 赞同：0
> 
> 时间：2009-04-01T19:35:20.540
> 
> 标签：python, networking

这只是轻微的编程问题，更多的是网络问题。

我正在尝试让 Django Web 应用程序在我的家庭网络中运行，但我无法让网络上的任何机器访问网页。我已经在端口 80 和 8000 上运行，但没有运气。错误消息是：“Firefox 无法与 192.168.xx 的服务器建立连接”

我尝试从客户端在 python 中使用套接字：

```
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect ( ("192.168.x.x", 80) ) 
```

我只是得到“socket.error（10061，'连接被拒绝'）”。有趣的是，我可以连接端口 25。

没有运行 Windows 防火墙。电缆调制解调器前面有一个 NetGear 路由器/防火墙。

我应该看什么来配置这个？

* * *

也试过：

```
import urllib2
urllib2.urlopen("http://192.168.x.x/") 
```

一样。

* * *

回复：“你能从运行它的机器上看到 Django 应用程序吗？”

是的。它确实在同一台机器上工作。它不能通过网络工作。

我还可以将服务器设置为在我选择的任何端口（80、8000 等）上运行，并且它可以在本地访问，而不是通过网络访问。

* * *

问：它是否支持 netstat？答：是的：

```
 Proto  Local Address          Foreign Address        State
  ....
  TCP    D3FL2J71:http          localhost:1140         TIME_WAIT
  TCP    D3FL2J71:http          localhost:1147         TIME_WAIT 
```

我在本地的两个浏览器窗口中可以看到该网站。

* * *

使用显式外部端口（不依赖本地主机）：

```
python manage.py runserver 192.168.x.x:8000 
```

冰冰冰！我们有赢家！

哇，我很高兴这不是网络问题。

* * *

“Django 应用程序是否肯定在 192.168.xx 地址上宣传自己，而不仅仅是在环回适配器上？”

Jon 似乎也走在了正确的轨道上，但评论并没有给我指明方向——检查 Django 服务器的设置调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T19:45:10.407

我假设您正在运行 django 开发服务器？如果是这样，请确保您启动它，以便它将绑定到其他机器需要用于连接的 IP 地址：

```
python manage.py runserver 192.168.x.x:8000 
```

您可以要求服务器绑定到所有地址（我承认自己没有在 Windows 上尝试过）：

```
python manage.py runserver 0.0.0.0:8000 
```

恐怕正常的 runserver 使用只绑定到本地主机。

# ruby-on-rails - 我怎样才能正确地在 rails 中需要一个文本文件？

> ID：707025
> 
> 赞同：1
> 
> 时间：2009-04-01T19:37:02.813
> 
> 标签：ruby-on-rails, ruby

对于个人学习项目，Rails 似乎无法找到我想加载到内存中进行处理的文本文件的适当路径。

```
require "#{RAILS_ROOT}/lib/english.txt" 
```

或者

```
require "/lib/english.txt" 
```

不工作。

文本文件位于`lib`目录中。

我正在尝试从一个简单的控制器加载它。我继续收到错误：

```
MissingSourceFile in EntriesController#anagram
no such file to load -- /Users/me/Sites/cvtest/lib/english.txt 
```

根据我的计算机信息（OSX），上面的路径实际上是文件所在的位置。我做错了什么？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T20:37:07.363

如果文件包含 Ruby 代码，请将扩展名更改为 rb。很有可能 rails 会自动加载文件而无需任何要求。在最坏的情况下`require 'english'`，或者`require 'lib/english'`应该是你所需要的。

require 用于加载 Ruby 代码扩展、库和你有什么。

如果english.txt 不包含有效的Ruby 代码，那么require 不是您要查找的内容，这里没有什么可看的，继续前进。研究 File 类的许多奇迹。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T20:46:48.137

`File.open("#{RAILS_ROOT}/lib/english.txt")`应该这样做。

`require`用于包含 Ruby 代码，例如在类中包含模块。

# c#-3.0 - 我应该在 C#3.0 中支持 Pub-/Sub-Scenarios 的 Co-/Contravariance 吗？

> ID：707041
> 
> 赞同：0
> 
> 时间：2009-04-01T19:41:55.640
> 
> 标签：c#-3.0, covariance, contravariance, publish-subscribe

在我的应用程序中，我正在创建一个简单的事件中心，它为注册订阅者提供了一些东西：

```
Subscribes<EventType>(ISubscriber<EventType> subscriber) 
// and some other methods for adding subscribers 
```

并用于发布事件。

```
Publish<EventType>(EventType @event) 
```

非常简单。我想路由`Publish<int>(0)`到所有实现的订阅者`ISubscriber<int>`.

不太难的是，我希望订阅者 EventType 是逆变的。所以`ISubscriber<object>`基本上应该消耗掉一切。我不希望他们也使用值类型。

用 C#4 没问题，但现在我用 C#3 做这些事情，只是用接口假装逆变：

```
public interface IContravariantGenerics { 
  object AsVariantFor(Type[] genericParamters);
} 
```

好吧，现在，我想像这样将数据打包成“事件类型”。该事件的通用参数必须是协变的。

```
SubX : ISubscriber<DataChanged<A>>

DataChanged<T>
  T Data {get;} 
```

当我发布`Publish<DataChanged<B>>(new DataChanged<B>(new B())`（给定 B：A）时，应通知订阅者`DataChanged<A>`Data 是传递给的 B 实例的位置`DataChanged<B>`。所以我也需要协方差支持。

我想编写一个支持 Co-/和逆变的库，如下所示：

```
IMyObject<T1, T2> : IWithVariance<In, Out> 
```

这将允许像这样的转换（不是强制转换！）：

```
Obj<Fruit, Fruit> x;
IMyObject<Apple, object> x2 = x.ToVariant<Apple, object>(); 
```

你怎么看？可能吗？考虑使用动态代理来做这件事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T22:10:55.360

IMO，这会让事情很快变得非常复杂，这意味着你最终会编写很多反射代码。你能等到 C# 4.0 吗？;-p

或者，您的代码可以忽略它不知道如何处理的事情......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T22:28:23.120

在这部分：

> 当我发布 `Publish<DataChanged<B>>(new DataChanged<B>(new B())`时， `Subscriber`应该通知 -instance在 `DataChanged<A>`哪里。`.Data``B`

我可能没听懂你——`.Data`比如我看不到指的是什么，我只能猜测 B 和 A 之间的关系。你的意思是 B 是从 A 派生的吗？

如果是这样，C# 4 不一定会让这样的事情自动发生。默认情况下，类型`X<A>`和`X<B>`根本不兼容。如果`X`是一个`interface`并且类型参数被标记为`out`，那么`X<B>`可以分配给一个类型的变量`X<A>`。但请注意，这仅适用于接口，而不适用于具体类型（委托也有类似的规定，仅此而已）。

**编辑：**

因此，您要做的是模拟`X<B>`可以分配给`X<A>`C#/CLR 4.0 中类型变量的方式，其中 X 是一个接口。

假设 X 是：

```
interface X<T>
{
    T Foo(int arg);

    // Note: T may only appear as an output, so this is illegal:
    // void Foo(T arg);
} 
```

你有一个`X<B>`，你需要一个`X<A>`。你知道这`B`是可分配给`A`. 所以你需要以下适配器：

```
class WrapX_A_B : X<A>
{
    public X<B> Impl { get; set; }

    public A Foo(int arg)
    {
        return Impl.Foo(arg);
    }
} 
```

您只需将每个方法转发到真正的实现。

但是，对于泛型外部类和通过继承相关的泛型参数对的每种可能组合，您都需要这样的包装类。手动编写它们并保持大量查找以针对给定情况选择正确的任务将是一项乏味，容易出错且永远无法完成的任务。

所以现在您进入代码生成以在运行时制造包装类。

# dns - 域管理（多台服务器）

> ID：707047
> 
> 赞同：0
> 
> 时间：2009-04-01T19:44:35.617
> 
> 标签：dns, subdomain

这是我的场景：

我有两个托管在不同服务器上的 Web 应用程序。我想做的是请求“*.mydomain.com”（即没有子域、“www”等）去第一台服务器，并请求“mysubdomain.mydomain.com”去第二个服务器。我该如何做到这一点？

它只是我的域名注册商的“CNAME”设置吗？像“www.mydomain.com”到 ip 11.11.111.111？

我知道这不一定与编程有关。但是，我认为 asnwer 也会对网站上的其他人有所帮助，因为大多数问题都与 Web 开发相关。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T19:49:02.003

```
CNAME mysubdomain second.server
CNAME *  first.server 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-30T09:11:02.713

CNAME 是正确的，如之前的回复所述。您也可以添加 A 记录。

您需要指定要指向 *.mydomain.com 的服务器 IP 地址以及指向其他服务器的 mysubdomain.mydomain.com 的另一条 A 记录。

确保从 mydomain.com 指向和工作的服务器添加这些 DNS 记录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-01T02:57:28.823

我不清楚您是否只需要根域 mydomain.com 的 DNS 解析，或者您是否需要通配符子域 (*)，这意味着任何子域。

如果您知道第一台和第二台服务器的名称，即。first-server.com 和 second-server.com，然后您将使用 CNAME 记录，在 mydomain.com 的区域中添加或更改：

```
*.mydomain.com. IN CNAME first-server.com.
mysubdomain.mydomain.com. IN CNAME second-server.com. 
```

如果您拥有 IP 而不是名称，并且您可以控制这些 IP，我的意思是这些 IP 在您不知情的情况下不会更改，然后使用 A 记录，在 mydomain.com 的区域中添加或更改：

```
*.mydomain.com. IN A XXX.XXX.XXX.XXX
mysubdomain.mydomain.com. IN A YYY.YYY.YYY.YYY 
```

其中 XXX 是第一台服务器的 IP，YYY 是第二台服务器的 IP。

笔记：

如果您当前有 A 记录，则必须将其删除才能设置 CNAME，您不能同时拥有两者。

如果您不想要通配符子域而是根域解析，那么 CNAME 将不起作用，这是因为会与 SOA 记录冲突，在这种情况下，A 记录是必须的。

# algorithm - 房间/时间段调度优化

> ID：707054
> 
> 赞同：0
> 
> 时间：2009-04-01T19:48:59.680
> 
> 标签：algorithm, mathematical-optimization

人们最多可以提前选择 25 个讲座中的 5 个。所有这些讲座都是在一天的五个时间段的五个房间里进行的。听众可以参加的每个（首选）讲座让她更快乐，他选择但无法参加的每个讲座（因为另一个首选讲座在同一时间段内）让他有点不开心。首选讲座的列表没有加权（至少没有告诉注册者订购他们的偏好，但如果它使事情变得更容易，我可以假设第一选择具有最高优先级，依此类推，该信息是可用的）。
有没有办法在不尝试每一个可能的时间表的情况下最大限度地提高整体幸福感或近似值？我在维基百科上发现了一个关于医院/居民问题的空存根，这听起来很像一个类似的问题（？）

> [医院/居民问题 - 也称为大学录取问题 - 与稳定婚姻问题的不同之处在于“女人”可以接受来自多个“男人”的“建议”（例如，医院可以接收多个居民，或大学可以招收一个以上的学生）。解决医院/居民问题的算法可以是面向医院的（女性最优）或面向居民的（男性最优）。](http://en.wikipedia.org/wiki/Stable_marriage_problem)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T13:08:02.177

我不认为你已经提供了所有的信息。如果您总共有 25 个讲座（假设没有重复，因为没有描述），有 5 个时间段和 5 个房间，那么任何给定的与会者都会在每个时间段错过 4 个讲座。鉴于您没有对讲座提供任何容量限制并且您明确表示它们没有加权，因此参加同一讲座的每个人或将参加者（均匀或不均匀）分布在总体（甚至个人）幸福感上没有差异所有 5 节同时进行的讲座。

# .net - 当进程停止或计算机出现故障时，如何记录错误？

> ID：707056
> 
> 赞同：0
> 
> 时间：2009-04-01T19:49:26.683
> 
> 标签：.net

如果程序进程停止或处理计算机停机，您如何记录事件？

我正在使用 Microsoft Enterprise 库进行所有日志记录，但我不确定如何记录上述情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T19:53:08.890

你不能。没有什么可做的日志记录。你能做的最好的事情是一个外部监控程序，但这并不能真正说明发生了什么，除非你用“twitter”式的日志记录乱扔你的代码；“我没有尝试联系数据库”，“我联系了数据库”，“我正在发送查询”，...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T20:11:21.357

这里有几个选项。如果您不关心我所说的 ETW（世界末日）异常，例如 StackOverflowException（怎么样？），您可以将所有内容包装在入口点的 try-catch-finally 块中：

```
static void Main()
{
   try
   {
       // Run...
   }
   catch (Exception ex)
   {
       // Log failure.
   }
   finally
   {
       // Log shutdown.
   }
} 
```

如果您完全使用线程，事情就会变得更加混乱。正确使用委托和 Begin/End Invoke 模式会将异常传播到当前线程（当调用 EndInvoke 方法时）。使用 Thread 类会使事情变得更加复杂。我可以放心地假设有一种方法可以解决这个问题（但我个人并不经常使用干净的线程）。我在管子上读到，出于某种原因，您的 AppDomain 中的 ETW 异常对整个 AppDomain 来说是致命的（即使它不应该发生在您的主线程上）；如果您想避开这些，请不要依赖线程。

就 ETW 异常而言，您绝对最好的选择是隔离另一个 AppDomain（进程外或进程内）中可能存在错误的代码，并通过 Remoting 访问它。远程处理将使您免受这些异常的影响。远程处理还将保护您免受目标应用程序的意外终止。除非您可以在有限的时间跨度内进行清理（Windows 将首先尝试以确定性方式关闭您的应用程序），否则没有什么可以使您免于关闭工作站。

我已经尝试过 CER，但一无所获。您可能想查看[这篇](http://msdn.microsoft.com/en-us/magazine/cc163716.aspx)MSDN 文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T19:57:47.537

心跳。第二台机器不断地监听心跳，如果它没有到达，就会尖叫。当然，缓慢的处理/网络问题偶尔会产生可能不正确的警告，但根本原因通常是未决问题的重要迹象。

# testing - 制作巨大的测试文件的好方法是什么？

> ID：707058
> 
> 赞同：1
> 
> 时间：2009-04-01T19:50:19.987
> 
> 标签：testing, file

我正在尝试测试我刚刚编写的一些流文件上传/下载代码，但我需要一个巨大的（比我的内存大，如 > 4GB）文件来测试。快速生成特定大小的文件（但内部没有特定数据）的好方法是什么？

我知道我可以在我的硬盘驱动器周围寻找一个适当大小的文件，但我很好奇是否有任何其他好的方法来生成测试文件，特别是如果我想要一个特定的大小。下载文件也不好，因为我的连接很慢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-01T19:51:58.330

在 Unix 上，这很容易：

```
head -c <numbytes> /dev/random > bigfile.dat 
```

因此，对于 4 GB，这[大约](http://www.google.com/search?hl=en&client=safari&rls=en-us&q=bytes+in+4+gigabytes&btnG=Search)是：

```
head -c 4294967296 /dev/random > bigfile.dat 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-01T20:35:04.577

在 *nix 系统上，您可以创建一个几乎不使用任何实际磁盘空间的稀疏文件。

```
dd if=/dev/zero bs=1 seek=4294967295 count=1 of=4G
ls -l 4G
-rw-r--r-- 1 me wheel 4294967296 2009-04-01 13:28 4G 
```

这将创建一个文件，开头有一个大小为 4GB - 1 的孔。该漏洞不消耗文件系统块。您甚至可以创建太大而无法放入文件系统的稀疏文件。从孔中读取返回零。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-02T11:18:29.540

在 Windows 上，您还可以使用以下`fsutil`命令：

```
Usage : fsutil file createnew <filename> <length>
   Eg : fsutil file createnew C:\testfile.txt 1000 
```

这将创建一个名为`testfile.txt`1,000 字节的文件。该文件只包含 NUL，如果这很重要的话。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T19:52:11.497

在 *nix 平台上，您可以执行以下操作：

```
dd if=/dev/zero of=test5000M.bin bs=5000000000 count=1 
```

这将生成一个 5000mb 的文件，里面什么都没有。

在 Windows 上，这样的事情应该可以工作：

```
fsutil file createnew test5000M.bin 5000000000 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-01T20:49:01.783

这是在 Windows PowerShell 中执行此操作的[函数：](http://www.codekeep.net/snippets/d64e194a-f1c7-4c69-b9a7-0ae3a2152beb.aspx)

```
function Create-TestFile([string]$location, [long]$sizeInBytes, [int]$numberOfFiles = 1 ,[char]$fillerChar="X")
{
$fc = new-object string ($fillerChar, $sizeInBytes ) ;
1..$numberOfFiles | %{ [io.file]::WriteAllText("$location\TestFile-$_.txt", $fc) }
} 
```

下面是你如何使用它：

```
Create-TestFile "C:\temp" 2100 #creates a file 2100 bytes in size. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-01T20:02:28.977

我过去只是在文件末尾进行查找和写入，以分配大块。

但是，根据您使用的大小，这可能会失败。（根据我在 WinXP 上的经验，接近 1.2 TB 的限制）

我成功地将这种方法用于硬盘老化应用程序，适用于很多不同的系统配置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-02T15:55:59.553

以前我曾经使用eatbits.exe 实用程序。您可以在哪里创建这些文件。它们对于安装测试非常有价值。

我在网上的任何地方都找不到eatbits，它可能是我工作的公司的内部实用程序。

# c# - Linq to Xml 和自定义 xml 实体

> ID：707062
> 
> 赞同：1
> 
> 时间：2009-04-01T19:51:33.107
> 
> 标签：c#, xml, linq, mathml

我想使用 Linq to xml 从表达式树创建 MathML 文档，但我不知道如何使用 MathML xml 实体（例如 ⁡ 和 &InvisibleTimes）：当我尝试使用

```
XElement xe = new XElement("mo", "&InvisibleTimes"); 
```

它只是逃脱了＆符号（这不好）。我也尝试使用 XElement.Parse

```
XElement xe = new XElement.Parse("<mo>&InvisibleTimes</mo>"); 
```

但它失败了 System.XmlException: Reference to undeclared entity 'InvisibleTimes' 如何声明实体或忽略检查？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T20:10:42.170

根据[这个线程](http://social.msdn.microsoft.com/forums/en-US/linqprojectgeneral/thread/abd9d8cc-30cc-45f1-8bd9-652a15b2b491)，LINQ to XML 不包括实体引用：它没有任何节点类型。它只是在加载文件时扩展它们，然后你就得到了“普通”字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T20:55:17.103

正如其他人指出的那样，没有直接的方法可以做到这一点。

也就是说，您可以尝试使用相应的 unicode 字符。根据[http://www.w3.org/TR/MathML2/mmlalias.html](http://www.w3.org/TR/MathML2/mmlalias.html)，对于 ApplyFunction 它是 02061，尝试 new XElement("mo", "\u02061")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T20:00:37.420

我不知道`XDocument`，但你可以这样做`XmlDocument`：

```
XmlDocument doc = new XmlDocument();
var entity = doc.CreateEntityReference("InvisibleTimes");
XmlElement root = (XmlElement)doc.AppendChild(doc.CreateElement("xml"));
var el = root.AppendChild(doc.CreateElement("mo")).AppendChild(entity);
string s = doc.OuterXml; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T20:05:00.390

您可能需要对名称进行 xml 编码，因为“&”是一个特殊字符。

所以而不是

```
XElement xe = new XElement("mo", "&InvisibleTimes"); 
```

尝试

```
XElement xe = new XElement("mo", "&amp;InvisibleTimes"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T20:18:13.930

我认为您需要一个 DTD 来定义 <mo>⁢</mo>。

MathML 2.0 提供了 XHTML + MathML DTD。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-27T23:21:40.903

一种解决方法是对 & 使用任何占位符，例如`;_amp_;` `XElement xe = new XElement("mo", ";_amp_;InvisibleTimes)` 在获取 xml 字符串时将其恢复： `output = xe.ToString().Replace(";_amp_;", "&")`

# c# - Unauthorized access when writing to file

> ID：707065
> 
> 赞同：0
> 
> 时间：2009-04-01T19:52:57.767
> 
> 标签：c#, .net-2.0

I have a asp.net website where the users have the possibility to print a document. This document is first written to a folder on the server and then opened/printed by the client. When deploying the website on IIS server I did encounter a few times issues when a user tried to print the document. Apparently the IIS user on the server had insufficient access rights to write to the local folder and thus throwing an unauthorized access exception.

which one is the IIS user and how do I give it write access to a folder on the server in .net ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T20:09:40.877

I would give write / modify access to the IUSR_MACHINE and NETWORK SERVICE accounts. To actually change the permissions, find the folder in Windows Explorer, get the Folder Properties. On the security tab, click the user in the list (you may have to "ADD" a user to the list first), then check the appropriate checkboxes under the Allow column.

As an aside, when ever I am stumped by a permissions issue, Sysinternals Process Monitor nearly always solves it. Run procmon.exe, set up the filters by excluding processes of known good processes (Right click on the process name, and select "Exclude 'explorer.exe'"). I also typically exclude known results like SUCCESS, and a few others. You can then reproduce the problem, and a bright shining "ACCESS DENIED" entry will be listed at the bottom of the list, including the name of the user account, and the specific asset it was trying to access.

Download Link: [http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T19:54:31.087

Usially it's NETWORK SERVICE user, grand to it write permissions on the required folder.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T19:55:34.843

There's also frequently a user named "IUSR" that is used by that process.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T19:58:36.397

On server class operating systems, ASP.NET 2.0 runs under the "Network Service" account. (I'm not sure whether it uses a different account for XP.)

Rather than giving *that* account more access, it's probably worth making ASP.NET run under a dedicated account. [This PDF](http://www.maotdr.gov.pt/Admin/Files/Documents/us_library_ms998297(d=printer).pdf) explains how to do it. (That explains for IIS 6.0; it may be slightly different under IIS 7.0, but it's probably broadly the same.)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T20:00:28.187

You can use ASP.NET impersonation - [http://msdn.microsoft.com/en-us/library/aa292118(VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa292118(VS.71).aspx) - to check if your program can run under a chosen user account.

I find this to be quite useful for exploring account permissions related issues.

# vb.net - AES 是创建哈希验证系统的可行解决方案吗？

> ID：707072
> 
> 赞同：0
> 
> 时间：2009-04-01T19:54:47.670
> 
> 标签：vb.net, cryptography

我正在编写一个程序，并且喜欢实现数据验证系统。它需要为输入的任何值返回一个唯一的字符串。我的问题归结为：AES 函数是否可以为两个不同的条目返回相同的值？源值将来自磁条卡上保存的数据。

# 更多细节

我最初是通过手机发布的，现在我才回到这篇文章。

我一直在浏览网络，在阅读关于 SHA[的 Wikipedia 文章](http://en.wikipedia.org/wiki/SHA1)时，我发现 SHA-2（SHA-256/224、SHA-512/384）没有检测到冲突（假设文章准确/最新日期）。这是可取的。关于我应该使用哪个版本的 SHA-2 有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T19:57:25.260

只要您对所有计算使用相同的密钥和初始化向量，AES 就永远不会返回相同的值。您只需加密数据。通常你只会使用散列算法，因为所有散列的长度都与输入无关，而 AES 给出的结果与输入的长度成正比。

不可能的原因很明显 - 如果 AES 将不同的输入加密到相同的输出，您将无法再次解密该消息，因为将有多个可能的解密消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T21:07:48.460

AES 是一种加密方案，而不是散列方案，因此在其简单的应用程序中，它会返回与您的消息一样长的数据块，但已加密。对于任何唯一的消息，密文也将是唯一的。

听起来您想要的是数据的散列或“摘要”-查看诸如 SHA256 之类的内容。无论数据的长度如何，这将为您提供固定长度的结果。这意味着不可避免地会有多个不同的输入提供相同的输出，但它们非常薄地分布在一个非常大的空间中。

您应该使用的哈希类型取决于您是试图防止恶意企图破坏您的方案，还是仅仅防止随机错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T16:23:37.973

基于新问题，我会说：

你应该使用你想要的任何版本的 SHA，因为你有足够的存储空间来保存它。

我几乎总是对所有事情都使用 SHA-512，因为它发生冲突的可能性最低，而且 64 字节通常足够小来存储。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T19:56:40.520

AES 不一定会为相同的输入两次返回相同的值，只要给定相同的密钥。

您应该改用强哈希算法，例如 SHA。

但是，要回答您的问题，在给定相同的密钥和 IV 的情况下，AES 不可能为两个不同的输入返回相同的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T13:55:46.680

请记住，这里有两种方案。

一种是用于密码学，其想法是密文或密码散列尽可能少地泄露原始信息。出于安全目的，这是您想要的。

一种是用于错误检测和纠正，在这种情况下，您需要尽可能多的有关原始信息的信息。这是您出于数据完整性目的而需要的。

如果您获取文件的加密哈希，那么您以后只能判断它是否是完全相同的文件。如果您使用某种错误检测方案，您可能会说出有关错误的信息。

# apache - 无法创建 max_apache 事件！

> ID：707077
> 
> 赞同：1
> 
> 时间：2009-04-01T19:55:23.050
> 
> 标签：apache, sugarcrm

有没有人看到这个神秘的错误或知道它的含义？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-17T13:54:05.443

这是由 ZendMonitor.so 引起的，可以在 zend.ini 中配置

```
; Maximum Apache processes to trigger event

zend_monitor.max_apache_processes=100

; Maximum Apache processes to trigger severe event

zend_monitor.max_apache_processes.severe=150 
```

我不知道为什么日志没有时间戳，也没有记录......

# web - 比较两个站点结构的工具

> ID：707080
> 
> 赞同：11
> 
> 时间：2009-04-01T19:56:10.113
> 
> 标签：web, compare

有谁知道任何允许比较两个几乎完全相同的网站的工具？

简单地说，我有一个沙盒站点和一个生产站点，并且想找出它们之间的区别，以了解将哪些内容移动到生产站点。

谢谢！

编辑：

好的，我看到我错过了一条重要信息（抱歉！）。这两个站点都是在线的并且基于 CMS (Drupal)，因此我需要一些可以在这两个站点上运行的爬虫工具，并显示沙盒中存在哪些页面，而不是生产中的页面。

感谢所有回答的人！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-02T20:59:52.520

使用[httrack](http://www.httrack.com/)下载站点的副本，然后使用您喜欢的文件比较工具来查看差异。（我更喜欢[WinMerge](http://winmerge.org/)，它可以通过两个文件文件夹递归运行，具有忽略空格差异和空行的选项，甚至使用 WINE 在 Linux 下运行良好。）

PS 您甚至可能希望在进行比较之前通过[HTML Tidy运行下载的 HTML 文件以规范化/漂亮地格式化它们。](http://tidy.sourceforge.net/)

* * *

另一种方法是进行[数据库比较](https://stackoverflow.com/questions/225772/compare-two-mysql-databases)。不过，您仍然可以对原始网站文件（不是蜘蛛版本）进行文件比较。从记忆来看，Drupal 数据库的模式并不难理解，特别是如果您主要对节点内容感兴趣。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-01T19:58:25.960

[超越比较](http://www.scootersoftware.com/)......纯粹的敬畏

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-01T19:57:57.897

[WinMerge](http://winmerge.org/)是一个免费/开源工具，允许您比较文件和目录。

您可以显示相同、不同或仅存在于一个目录中的文件。然后，您可以通过将文件从一个目录复制到另一个目录来使两个目录相同。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-02T18:31:09.757

正如 Sunny 所说，使用爬虫和 diff 工具。

对于爬虫，我更喜欢 httrack 而不是 wget。如今，许多网站都使用从 css 引用的图像。当我上次检查时，wget 无法加载从 css 引用的文件。除此之外，它还有一个不错的 GUI。

从 diff 工具开始：我从 Windows 3.1 开始就使用 FileSync。当然还有更多花哨的 diff 工具，但这个工具简洁干净，可以胜任。在 unix 上，您始终可以执行 diff -r。如果你的机器上有 Eclipse，它有一个很好的差异查看器，它也可以比较两个目录。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-01T22:04:57.917

[如果您正在运行 Linux， Meld](http://meld.sourceforge.net/index.html)对此很有用。它在 Debian/Ubuntu 存储库中可用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-02T17:34:39.910

使用[wget](http://www.gnu.org/software/wget/)抓取网站，用一些[差异](http://en.wikipedia.org/wiki/Diff)工具比较内容。

或者，对脚本文件使用 diff 工具，然后将 DB 转储到文本 (csv) 文件中，然后进行比较。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-01T20:00:42.210

超越比较是伟大的。Syncback ( [http://www.2brightsparks.com/downloads.html](http://www.2brightsparks.com/downloads.html) ) 有一个免费版本，您可以使用任何合并工具，如 araxis 或 winmerge

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-01T20:03:34.730

将您的代码放入[Subversion](http://subversion.tigris.org/)或其他一些源代码控制中。当准备好部署时，' [svn update](http://svnbook.red-bean.com/en/1.0/re28.html) ' 将只更新已更改的内容。

' [svn diff](http://svnbook.red-bean.com/en/1.0/re09.html) ' 将显示差异。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-01T20:07:25.453

[DiffMerge](http://www.sourcegear.com/diffmerge/)是另一个支持目录差异的免费跨平台工具。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-06-19T17:08:13.440

您还可以使用一些在线比较服务，例如[CopyScape](https://www.changedetection.com/comparepages.html)或[ChangeDetection](https://www.copyscape.com/compare.php)

# c++ - C++ 中的运算符重载是否比它们的价值更麻烦？

> ID：707081
> 
> 赞同：6
> 
> 时间：2009-04-01T19:56:22.063
> 
> 标签：c++, operator-overloading

在我教授 C++ 的经验中，运算符重载是最让学生感到悲伤的话题之一。甚至在 stackoverflow 上查看问题：例如，将 + 运算符设为外部还是成员？怎么处理对称性等等，好像挺麻烦的。

当我从 C++ 迁移到 Java 时，我担心我会错过这种能力，但是除了 [] 或 () 之类的运算符之外，我真的从来没有觉得需要重载运算符。事实上，我觉得没有它们的程序更具可读性。

注意：我把它作为一个社区维基。让我们讨论一下。我想听听意见。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-01T20:18:55.037

重载的运算符就像香料。一点点可以让事情变得更好；太多会使它变得难吃。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-04-01T20:00:13.240

每个 C++ 程序员都应该知道的一些重载示例，即使他们不赞成：

*   operator=() 是必需的，以允许 C++ 对象表现得像值。
*   operator->() 是实现智能指针所必需的
*   需要 operator<<() 和 operator>>() 将类型集成到 iostream 框架中
*   在比较存储在标准库容器中的对象时，默认使用 operator<()
*   operator()() 用于实现标准库算法使用的函子
*   如果您实现自己的迭代器，则 operator++() 预计可用

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-01T20:27:51.240

抱怨重载的运算符很容易，只要它们不以令人惊讶的方式行事，我真的看不出问题。是的，那里有不好的例子（即使在 stl 中）。例如，参见 auto_ptr 的赋值运算符。重载一些运算符，例如`&&`和`||`几乎`,`总是会很糟糕。但在大多数情况下，让运营商做他们宣传的事情并没有真正的问题。

重载`operator+`来做一些奇怪的事情是不好的做法，但是如果你将一个名为“Add”的方法放到你的类中，将对象序列化到磁盘，那就同样糟糕了。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-01T20:55:16.010

重载的运算符可能是做某些事情的好方法，但很容易被滥用。

重载`<<`and`>>`运算符可以很容易地扩展 C++ 的流，包括新类型的流、新的 I/O 对象以及两者。重载`->`使智能指针几乎可以替代 C++ 指针。重载的运算符可以使用字符串连接运算符，并可以构建在语法上类似于`int`s 的新类型的数字。拥有它们可以在库中做需要在其他语言中进行语言级别更改的事情。

它们确实有其局限性。没有适合求幂的运算符。只有一个乘法运算符，在某些情况下有不止一种乘法方法（例如，对于 3D 向量，至少有点积和叉积）。、`&&`和`||`逗号运算符不能复制它们的内置功能，因为它们不能有短路评估和序列点。

当然，它们也可能被滥用。例如，没有语言要求算术运算符必须像算术一样工作。我已经看到为了提出一个有人认为直观的 SQL 表示法而做的可怕的事情。在一个写得很糟糕的 C++ 程序中，不可能知道，比如说，做了什么`a = x * y;`，因为它是`a.operator=(x.operator*(y));`，或者可能`a.operator=(operator*(x, y));`是什么，并且可以编写操作符函数来做任何事情。

Bjarne Stroustrup 设计 C++ 的意图是包含有用的特性而不考虑滥用的可能性，而 James Gosling 设计 Java 的意图是排除过度滥用的特性，即使它们有些用处。我不清楚这些哲学中的任何一个是正确的还是错误的，但它们是不同的。

Java 旨在避免通常需要某些 C++ 特性的情况，例如运算符重载、多重继承和运行时类型推导，因此它们不会经常被遗漏。这到底是好是坏，我不知道。

至于教学生，告诉他们不要自己重载运算符（除了在定义的条件下，例如函子和赋值运算符），而是指出库如何使用重载运算符。我不相信任何 C++ 学生都能正确地完成它们，如果他们能够做到，他们可以并且会自己学习。他们会知道这很棘手，因为你在课堂上禁止这样做。一些我永远不会相信比`for`语句更复杂的东西会发现如何重载运算符，并且无论如何都会这样做，但这就是生活。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-01T20:44:30.920

运算符重载对于很多目的来说都是必不可少的。如果没有重载 operator() 的能力，就不可能创建仿函数。在许多情况下，泛型编程会让人头疼。如果我编写一个数值算法，我依赖于行为相同的值类型，无论它是 float、double、std::complex 还是一些自制类型。我依赖于定义的常用算术运算符等，因此我不必为内置类型编写单独的重载，而为自定义类型编写另一个重载。

智能指针依赖于能够重载解引用运算符的对象，以便它们可以像指针一样工作。

运算符重载对于使 c++ 编程可以接受是极其重要的。至于它很复杂，我只是没有看到。它并不比创建自己的函数更复杂，人们通常觉得这很容易。如果你把它命名为“multiply”，它就是一个函数，如果你把它命名为“operator*”，它就是一个运算符。但是正文中的代码是完全相同的。

当然，运营商有时会被滥用。<< 或 >> 可能是可接受的边界，但它们是如此普遍和使用，以至于我认为这是公平的。

但是，如果您在 C# 中询问过运算符重载，我很乐意不使用它们。它们的实现要笨拙得多，它们不能使用泛型，并且它们不能启用 C++ 使用的所有漂亮和方便的技巧。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-01T20:00:17.203

我认为这真的取决于用例。有几种类型的类需要运算符。例如，如果没有 -> 和 * 运算符，智能指针将毫无价值。

我还发现比较、相等和赋值运算符对于特定类型非常有用。我在编辑器环境中工作，因此我们自然有多次表示坐标和跨度。当然我们可以用比较运算符做所有事情，但是

```
if ( point1 > point2 ) ... 
```

只是看起来比负载好

```
if ( point1.Compare(point2) < 0 ) ... 
```

尽管 cast 偶尔会派上用场，但我发现其他运算符的用处较少。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-01T21:18:20.963

我不认为运算符重载是一个坏主意。我确实认为将隐式转换作为默认行为是一个坏主意。与运算符重载相结合的默认隐式转换是一个**非常**糟糕的主意。

完全取消隐式转换 - 或使其依赖于“隐式”关键字 - 该语言永远不会像[本文这样](http://www.informit.com/articles/article.aspx?p=31529&seqNum=8&rll=1)的无数文章中讨论的潜在陷阱和陷阱的数量。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-01T20:10:26.460

正如 Neil 在他的回答中指出的那样，运算符重载是学习良好的面向对象 C++ 习语的必要主题。我会谨慎地向学生教授它，如果你不按照惯用约定实现重载运算符，它可能会导致非常错误和意外的行为。运算符重载不是发挥创造力的好时机。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-01T20:21:28.900

我使用它们时的运算符和案例：
operator->、operator* - 用于代理对象和不同的包装器。
operator= - 需要避免复制时出现意外行为。
operator < (>, <=, >=) - 用于存储在 map 或 set 中（但通常最好将 functor 传递给这个）。
运算符 << ( >> ) - 用于流和 boost::lexical_cast 兼容性。
运算符 ==, != - 允许比较对象。
操作员 ！- 有时改为valid() 函数。
运算符类型 - 用于转换为其他类型。
operator() - 用于智能仿函数，当 boost 被禁止时。

就这样。
有时以前我使用过其他运算符，但那是为了我的数学实用程序。

还应注意逻辑运算符（&&，||） - 我们将与标准语义有所不同：

```
ptr && ptr->method() 
```

如果我们重载了运算符&&，可能会有其他意义。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-01T20:35:04.733

我真的很喜欢在 C++ 中为非内置类型重载算术运算符的能力。但仅适用于具有类似算术行为的类型；例如定点类、3D 矢量类、复数类、任意长度的“bignum”类。我用 Java 写过类似的代码，并且因为不得不写类似的东西`a.Add(b)`而不是`a+b`. 请注意，我是一名受过训练的数学家；在我看来，运算符重载可以让您在 C++ 中获得一些特定于领域的语言优势，而无需实际实现。

但是当我看到例如`operator+`功能超载时，我真的很恼火，这些功能最好通过`operator<<`（遵循狡猾但完善的 iostream 约定）或类似 STL`.push_back()`的模式来完成。

至于`operator()`...发现后`boost::bind`，`boost::function`我无法想象没有函子的生活。如果没有重载等`operator*`，智能指针就不会那么方便了。`operator->`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-01T20:21:57.633

重载运算符的问题在于，有些人喜欢使用与运算符的原始 (C) 目的没有任何意义的功能来重载它们（这里我指的是 std 中的 >> 和 << 运算符::iostream 的东西。）。在我看来，你应该重载运算符的唯一时间是重载与底层运算符的含义完全匹配（即 < 和 > 必须是比较。）或者，你必须以某种方式重载它以便与另一个交互图书馆。

坦率地说，除非我需要一个库，否则我根本不会重载运算符。它只是让读者工作太努力，无法弄清楚发生了什么。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-01T23:15:02.320

最好避免重载的运算符之一是[转换运算符](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=24)。它导致了意想不到的结果，甚至 STL 也不喜欢重载它，而是更喜欢函数样式转换：

```
std::string str = "foo";
char *ch = str.c_str(); //rather than char *ch = str.operator *char(); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-02T02:35:28.610

我想念 Java 中的重载运算符，尤其是在以下情况下：

作为算法或函子的类：（策略模式、责任链、解释器等）。自然是重载 op(); 取而代之的是，每个程序员都会为函数提出（通常不兼容并因此令人困惑）名称：“eval”、“evaluate”、“operation”、“doIt”等。因此清晰度降低了，因为我们被迫使用这些名称不要让他们的意思很明显。

转换为另一种类型的类：在 C++ 中，它是运算符 Type()，既可用于实际转换，也可用于产生所需类的内部成员。第二种情况在 Java 中经常出现，当一个类不必要地是 final 但你想向它添加操作时：

```
class DecoratedStringBuffer { //extends StringBuffer doesn't work, as String is final
  private String byContainmentThen;
  public decorate(final String prefix, final String suffix) { ... }
  public append(final String s) { byContainmentThen.append(s);}
  // other forwarding functions
} 
```

由于 DecoratedStringBuffer 不是 is-a StringBuffer，在它离开你的代码并返回到客户端代码之前，它需要被转换回来，大概是通过一个最终应用后缀和前缀的函数。如果我们可以调用该运算符 StringBuffer() 那就太好了（如果 Java 像 C++ 一样可以应用一个用户提供的转换，那就更好了）。

相反，因为没有约定，我们必须给它一个必然更加模糊的名称。getStringBuffer() 是一个显而易见的名称，但对于许多 Java 用户来说，这意味着相应的 setStringBuffer，我们不想要它。即使它并不暗示，这个名字也是模棱两可的：你得到的 StringBuffer 是我们操作的那个，还是别的什么？

toStringBuffer() 是一个更好的名称，并且我倾向于应用这种模式，但是阅读代码的人想知道为什么看起来像 getter 的东西被称为“to”ClassName。

老实说，除了在设计数字类或“明显”可连接对象时，重载 op+ 几乎没有用处。由于 Java 不像 C++ 那样基于值，所以 op=; 没有太多用处。Java 并没有试图让一切都像一个原始的 int 值类。它是 op() 和我想念的转换运算符。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-04-01T20:33:15.843

有功能很不错，但不是必不可少的。在许多情况下，我发现它们比它们的好处更令人困惑。就像在 JaredPars 示例中一样，.compare 函数对我来说比 '>' 更明显。可以直接看到 point1 是一个对象，而不是原始数据类型。我喜欢我使用的库中的重载运算符，但在我自己的代码中我很少使用它们。

编辑：我对函数名的选择不一致。将 .compare 替换为 .greaterThan 会更清楚。我的意思是，对我来说，绑定到对象的函数名称比乍一看与对象没有关联的运算符更明显。恕我直言，一个精心挑选的函数名称更容易阅读。

# visual-studio-2008 - 重新安装 VS 2008 后缺少模板

> ID：707082
> 
> 赞同：0
> 
> 时间：2009-04-01T19:56:34.200
> 
> 标签：visual-studio-2008, visual-studio-templates

我安装了 VS 2008 并安装了 .NET 3.5 SP1 并获得了所有模板。

然后，我不得不卸载 VS 2008（请不要问为什么）而不卸载 .NET Framework 3.5 SP1 或其他任何东西。

之后，我重新安装了 VS 2008，然后我打开 VS 2008，发现当我添加一个新项目时，实体框架模板不再在列表中。

有人可以帮忙解决这个问题吗？

非常感谢！

射线。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T20:21:26.403

您是否在没有 VS2008 SP1 的情况下重新安装了 VS2008？我相信 EF 模板是 SP1 的一项功能。

# java - 尝试解组 xml 时出现类强制转换异常？

> ID：707084
> 
> 赞同：57
> 
> 时间：2009-04-01T19:57:10.907
> 
> 标签：java, jaxb, jaxb2

试图在这里克服一个类转换异常：

```
FooClass fooClass = (FooClass ) unmarshaller.unmarshal(inputStream); 
```

抛出此异常：

```
java.lang.ClassCastException: javax.xml.bind.JAXBElement 
```

我不明白这一点——因为该类是由 xjc.bat 工具生成的——它生成的类我根本没有改变——所以这里不应该有强制转换问题——解组器真的应该给我一个类可以转换为 FooClass。

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2009-04-01T20:04:11.843

`FooClass`有`XmlRootElement`注解吗？如果没有，请尝试：

```
Source source = new StreamSource(inputStream);
JAXBElement<FooClass> root = unmarshaller.unmarshal(source, FooClass.class);
FooClass foo = root.getValue(); 
```

这是基于[非官方 JAXB 指南](https://javaee.github.io/jaxb-v2/doc/user-guide/ch03.html#unmarshalling-xmlrootelement-and-unmarshalling)。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-05-21T06:02:45.900

在 JAXBElement 上使用 JAXBIntrospector 来获取 schemaObject，如 >>

```
JAXBContext jaxbContext = JAXBContext.newInstance(Class.forName(className));
Unmarshaller unmarshaller = jaxbContext.createUnmarshaller();
Object schemaObject = JAXBIntrospector.getValue(unmarshaller.unmarshal(new ByteArrayInputStream(xmlString.getBytes()))); 
```

参考：[JAXB unmarshaller.unmarshal 何时返回 JAXBElement<MySchemaObject> 或 MySchemaObject？](https://stackoverflow.com/questions/10243679/when-does-jaxb-unmarshaller-unmarshal-returns-a-jaxbelementmyschemaobject-or-a/10253282#10253282)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-01-10T11:09:44.423

我今天遇到了同样的问题，在这里看到了答案，做了一些研究，在我看来，最通用的解决方案是使用**JAXBIntrospector**。因此 -

```
FooClass fooClass = (FooClass ) unmarshaller.unmarshal(inputStream); 
```

应该写成

```
FooClass fooClass = (FooClass) JAXBIntrospector.getValue(unmarshaller.unmarshal(inputStream)); 
```

甚至更好，使其更通用-

```
T t = (T) JAXBIntrospector.getValue(unmarshaller.unmarshal(inputStream)); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-29T16:48:06.353

如需更全面的解释，请阅读[这篇文章](http://web.archive.org/web/20090121025810/http://weblogs.java.net/blog/kohsuke/archive/2006/03/why_does_jaxb_p.html)。事实证明，您的 XSD 必须正确设置，即必须有一些根元素包含所有其他元素。

> XJC 确实尝试将`@XmlRootElement`注释放在我们从复杂类型生成的类上。确切的条件有点难看，但基本思想是，如果我们可以静态保证复杂类型不会被多个不同的标签名称使用，我们将`@XmlRootElement`.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-02-11T15:54:46.670

我们花了太多时间来处理 JAXB 工厂类来满足解组器。我们已经了解到，使用 unmarshaller*而不*调用 JAXB 生成的对象工厂可以正常工作。希望示例代码能弥补某人的挫败感：

```
System.out.println("Processing generic-type unmarshaller: ");
MessageClass mcObject = unmarshalXml(MessageClass.class, msgQryStreamSource,
    NAMESPACE + "." + "MessageClass");

public static <T> T unmarshalXml(Class<T> clazz, StreamSource queryResults,
    String contextNamespace)
    {
        T resultObject = null;
        try {
            //Create instance of the JAXBContext from the class-name
            JAXBContext jc;
            jc = JAXBContext.newInstance(Class.forName(clazz.getName()));
            Unmarshaller u = jc.createUnmarshaller();
            resultObject = clazz.cast(u.unmarshal(queryResults));
            }
              //Put your own error-handling here.
        catch(JAXBException e)
        {
            e.printStackTrace();
        }
        catch (ClassCastException e)
        {
            e.printStackTrace();
        }
        catch (ClassNotFoundException e)
        {
            e.printStackTrace();
        }
        return clazz.cast(resultObject);
    } 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-01T23:26:39.330

我会查看 XML 文件并确保它大致符合您的预期。

我还会暂时将代码更改为：

```
Object o = unmarshaller.unmarshal(inputStream);
System.out.println(o.getClass()); 
```

如果第一个失败，那么类转换发生在 unmarshal 方法中，如果它成功，那么你可以看到你正在返回的实际类，然后找出为什么它不是你期望的那样。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-11-02T14:40:05.640

以同事的预览答案为基础，以防万一有人仍在寻找答案。

我的方案的根元素被定义为：

```
<schema>
  <element name="foo" type="bar" />
  <complexType name="bar" />
</schema> 
```

因此，我在以下位置获得了 Cast Exception：

```
try {            
        javax.xml.bind.JAXBContext jaxbCtx = javax.xml.bind.JAXBContext.newInstance(mobilityConfigType.getClass().getPackage().getName());            
        javax.xml.bind.Unmarshaller unmarshaller = jaxbCtx.createUnmarshaller();
        File f = FileUtil.toFile(this.getPrimaryFile());            
        mobilityConfigType = (MobilityModelConfigType)unmarshaller.unmarshal(FileUtil.toFile(this.getPrimaryFile()));
    } catch (javax.xml.bind.JAXBException ex) {            
        java.util.logging.Logger.getLogger("global").log(java.util.logging.Level.SEVERE, null, ex); //NOI18N
    } 
```

我所做的是将 try 块的第一行更改为：

```
javax.xml.bind.JAXBContext jaxbCtx = javax.xml.bind.JAXBContext.newInstance(mobilityConfigType.getClass().getName()); 
```

这为我解决了问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-01T20:03:48.800

您确定 FooClass 是您传递的 xml 输入源的根元素吗？Unmarshall 将返回由 xjc 创建的根元素的对象。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-08-03T12:41:32.253

有时，您的 XSD 定义包含多个不同的根元素（例如，在 WSDL 中定义的 XSD），在这种情况下，生成的类缺少 @XmlRootElement。因此，正如用户 mbrauh 已经写过的那样，您必须获取 JAXBElement 的值。就我而言，我使用了：

```
FooClass request = ((JAXBElement< FooClass >) marshaller.unmarshal(new StreamSource(classPathResource.getInputStream()))).getValue(); 
```

因此，使用泛型可以轻松避免双重类型转换。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-11-13T16:18:43.637

如果您有权访问并且可以修改 XSD。对我来说，当我使用 IDEA 从 XML 生成 XSD 时，这个问题就会出现。

有了这个 xml：

```
<?xml version="1.0"?>
<schema>
  <element name="foo" type="bar" />
  <complexType name="bar" />
</schema> 
```

IDEA 会生成这样的 XSD，而 JAXB 不会生成根元素：

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="schema" type="schemaType"/>
  <xs:complexType name="schemaType">
    <xs:sequence>
      <xs:element type="elementType" name="element"/>
      <xs:element type="complexTypeType" name="complexType"/>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="elementType">
    <xs:simpleContent>
      <xs:extension base="xs:string">
        <xs:attribute type="xs:string" name="name"/>
        <xs:attribute type="xs:string" name="type"/>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
  <xs:complexType name="complexTypeType">
    <xs:simpleContent>
      <xs:extension base="xs:string">
        <xs:attribute type="xs:string" name="name"/>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
</xs:schema> 
```

但是，如果您以这种方式修改 XSD（修改根元素“模式”以获取标签 xs:element 内的 xs:complexType）：

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="schema">
    <xs:complexType>
      <xs:sequence>
        <xs:element type="elementType" name="element"/>
        <xs:element type="complexTypeType" name="complexType"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:complexType name="schemaType">
    <xs:sequence>
      <xs:element type="elementType" name="element"/>
      <xs:element type="complexTypeType" name="complexType"/>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="elementType">
    <xs:simpleContent>
      <xs:extension base="xs:string">
        <xs:attribute type="xs:string" name="name"/>
        <xs:attribute type="xs:string" name="type"/>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
  <xs:complexType name="complexTypeType">
    <xs:simpleContent>
      <xs:extension base="xs:string">
        <xs:attribute type="xs:string" name="name"/>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
</xs:schema> 
```

JAXB 将生成根元素！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-09-09T17:19:12.103

指定 @XmlRootElement(name="specifyName", namespace="namespace") 来转换对象。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-10-30T16:49:13.117

我还遇到了“Javax.xml.bind.JAXBElement cannot be cast to”错误，找到了这个非常简单的解决方案：

```
FooClass fooClass = (FooClass) ((JAXBElement) u.unmarshal(new File("xml/foo.xml")) ).getValue(); 
```

由于显然返回了一个 JAXBElement 类型的对象，因此您需要改为对它的值进行类型转换。

来源：[https ://forums.oracle.com/thread/1625944](https://forums.oracle.com/thread/1625944)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-07-15T12:46:24.797

试试这个：

```
JAXBContext jc = JAXBContext.newInstance(Foo.class);
Unmarshaller unmarshaller = jc.createUnmarshaller();
JAXBElement element = (JAXBElement) unmarshaller.unmarshal( new StringReader(xmlString));
Foo foo = (Foo)element; 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-11-06T10:39:10.793

就我而言，我在尝试从 SOAPUI 应用程序发送肥皂请求时收到错误消息。我需要将属性 'strip whitespaces' 设置为 true 以跳过此错误。

调试收到的内容时，是一个包含下一个内容的列表：

```
[0] = "\n"
[1] = JAXBElement
[2] = "\n" 
```

希望帮助某人。

# python - 装饰师和课堂

> ID：707090
> 
> 赞同：3
> 
> 时间：2009-04-01T19:57:51.547
> 
> 标签：python, decorator

有没有办法在嵌套良好的类结构中编写装饰器？例如，这在没有类的情况下可以正常工作：

```
def wrap1(func):
    def loc(*args,**kwargs):
        print 1
        return func(*args,**kwargs)
    return loc

def wrap2(func):
    def loc(*args,**kwargs):
        print 2
        return func(*args,**kwargs)
    return loc

def wrap3(func):
    def loc(*args,**kwargs):
        print 3
        return func(*args,**kwargs)
    return loc

def merger(func):
    return wrap1(wrap2(wrap3(func)))

@merger
def merged():
    print "merged"

@wrap1
@wrap2
@wrap3
def individually_wrapped():
    print "individually wrapped"

merged()
individually_wrapped() 
```

输出是：

```
1
2
3
merged
1
2
3
individually wrapped 
```

这就是我想要的。但是现在假设我想将`merged`and`individually_wrapped`作为静态或类方法。只要将装饰器保持在类命名空间之外，这也将起作用。有没有什么好方法可以将装饰器放在命名空间中？我宁愿不列举所有行不通的方法，但主要问题是如果`merger`是方法，它就无法访问这些`wrapX`方法。也许这是一件愚蠢的事情，但是有没有人让这样的事情起作用，所有的装饰器和装饰方法都在同一个类中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-01T20:07:40.977

“有什么好方法可以将装饰器放在命名空间中吗？”

这没有令人信服的理由。你有模块文件。这些是一个类和一些装饰器的整洁容器。

你永远不需要装饰器作为类的方法——你可以从另一个方法调用一个方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T05:22:22.750

实际上，将它们全部放在一个类中应该没有问题。在类体内时，您可以简单地通过命名来命名迄今为止定义的任何变量：

```
A类（对象）：
    a = 1
    b = 2
    c = a + b

打印交流

```

这会产生结果 3，因为当 Python 执行类主体时，函数可以“看到”已声明的变量 a 和 b。所以以下也有效：

```
B类（对象）：
    @静态方法
    def 包装器（*args，**kw）：
       ...

    @包装器
    定义一个（...）：
        ...

```

现在，你的合并功能呢？问题是包装函数在类体执行完成*后*很长时间才运行，并且它定义的变量不再在封闭范围内。那你怎么能引用他们呢？通过使用类的名称作为前缀！像这样：

```
C类（对象）：
    @静态方法
    def wrap1(*args, **kw):
        ...
    @静态方法
    def wrap2(*args, **kw):
        ...
    @静态方法
    def wrap3(*args, **kw):
        ...
    @静态方法
    def 合并(*args, **kw):
        C.wrap1(C.wrap2(C.wrap3(...)))

    @合并
    def 普通（...）：
        ...

```

因此，Python 的一般规则是：在类主体级别运行的代码可以讨论迄今为止在其内部定义的所有变量和方法，这意味着您可以将这些类变量用作包装器。但是一旦你在类中的一个函数的“内部”，无论它是一个类函数、一个静态函数还是一个方法（这个包装器是一个类方法，因为它需要 args 但没有“self”），那么你必须使用类的名称以“获取”其内容。

# c++ - 计算两条边的交点

> ID：707096
> 
> 赞同：0
> 
> 时间：2009-04-01T19:58:36.707
> 
> 标签：c++, geometry, 2d

我有这个二维空间中边和顶点的大图。大图由 C++ 库中计算的函数返回。我正在阅读此图并使用它来计算其边缘的所有交点（线段）。我使用扫描算法。为了检测两条边的交点，我遇到了一些问题。我有 4 种不同的方法，根据这些方法我测试两条边是否相交，如果是肯定的，我计算并保留它们的交点：

1.  一种测试两条边是否是多边形的对角线。即插入另一条线方程的一条线的边缘坐标具有不同的符号。

2.  一种每次计算交点并检查找到的交点是否在两个线段的端点之间。

3.  一个是来自[这个链接](http://workshop.evolutionzone.com/2007/09/10/code-2d-line-intersection/)的代码，它是用 C++ 实现的。

4.  一个实现了 Jason Cohen 在 [这个问题](https://stackoverflow.com/questions/563198/how-do-you-detect-where-two-line-segments-intersect/706262#706262)中提出的第一种方法。

“问题归结为这个问题：从 A 到 B 和从 C 到 D 的两条线是否相交？然后你可以问四次（在这条线和矩形的四个边之间）。

这是执行此操作的矢量数学。我假设从 A 到 B 的线是有问题的线，从 C 到 D 的线是矩形线之一。我的符号是 Ax 是“A 的 x 坐标”，Cy 是“C 的 y 坐标”。而“*”表示点积，例如：

```
A*B = Ax*Bx + Ay*By.
E = B-A = ( Bx-Ax, By-Ay )
F = D-C = ( Dx-Cx, Dy-Cy ) 
P = ( -Ey, Ex )
h = ( (A-C) * P ) / ( F * P ) 
```

这个 h 数是关键。如果 h 在 0 和 1 之间，则线相交，否则不相交。如果 F *P 为零，您当然无法进行计算，但在这种情况下，线是平行的，因此仅在明显的情况下相交。确切的交点是 C + F* h。如果 h 恰好为 0 或 1，则线在端点处相接。你可以认为这是一个“交叉点”，也可以不是你认为合适的。”

对于我创建的数据（具有双值的小数据），我使用所有 4 种实现的方法都获得了很好的结果。当我对大图中的数据使用用 C++ 实现的这些方法中的任何一种时，我每次都会得到不同的结果，而且结果都不好：

1.  方法返回更多我需要的交点（所有点都在图表上），但我得到的点太多。

2.  无论如何，我总是获得 0 个交叉点。

3.  我得到的交叉点比 1 多得多。

4.  对于某些示例，我得到不在图表上的点（因此甚至没有交叉点）。但是对于一些例子，我得到了交点加上其他一些点。

我不知道问题出在哪里。任何关于如何计算交集并对其进行测试的建议或任何其他想法都非常受欢迎。谢谢你，马达琳娜

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T20:11:52.277

您需要的是对您的 4 种方法进行单元测试并对其进行*彻底*测试。尤其是线段相交时，除了所有常见的公差问题（例如，“等斜率”究竟是什么意思？）之外，还有*很多*端点情况，例如平行斜率、重合端点、完全或部分重叠。

如果不将事物分解成更小、更可测试的单元，您将很难缩小范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T20:48:56.010

尽管无法看到您的代码很难说，但我怀疑您的浮点值遇到了健壮性问题。您是否考虑过使用整数点或进行某种鲁棒性增强，例如消除浮点值中的公共位？

[有一个名为 GEOS ( http://trac.osgeo.org/geos/](http://trac.osgeo.org/geos/) )的开源几何库，它可能对测试您的数据集很有用。GEOS 中还有一些算法可以对整数网格执行四舍五入并消除常见位，以帮助您确定是否遇到了鲁棒性问题。进一步值得注意的是 GEOS 如何使用同质空间中的点线对偶性计算交集（我不能完全确定您描述的点积投影技术在数学上是否等效）。

顺便说一句，我最喜欢的计算边图中交点的解决方案是将扫描线与单调边链结合使用。当你使用单调链时，你可以消除很多边相交测试，因为链永远不会相交。这就是 GEOS 所做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T08:53:59.340

当我计算交点时，我在单调边缘上使用扫描线（我有一个排序函数，它对构造函数内的边缘进行排序，我测试它们我有序），即使我获得了一些作为顶点的点作为交点一些边缘，即使我有很多测试来消除这种情况。

这是第四种方法的代码（它给了我迄今为止最好的结果，但不是所有的交叉点，但与其他方法相比至少有一些好的交叉点）：

```
//4 method
double* QSweep::findIntersection(edge_t edge1,edge_t edge2) {  
    point_t p1=myPoints_[edge1[0]];
    point_t p2=myPoints_[edge1[1]];
    point_t p3=myPoints_[edge2[0]];
    point_t p4=myPoints_[edge2[1]];

    double xD1,yD1,xD2,yD2,xD3,yD3,xP,yP,h,denom;
    double* pt=new double[3];

    // calculate differences  
    xD1=p2[0]-p1[0];  
    xD2=p4[0]-p3[0];  
    yD1=p2[1]-p1[1];  
    yD2=p4[1]-p3[1];  
    xD3=p1[0]-p3[0];  
    yD3=p1[1]-p3[1];    

    xP=-yD1;
    yP=xD1;
    denom=xD2*(-yD1)+yD2*xD1;
    if (denom==0) {
        return NULL;
    }
    else{
    h=(xD3*(-yD1)+yD3*xD1)/denom;
    }
    std::cout<<"h is"<<h<<endl;
    if ((h>0)&&(h<1)){
        pt[0]=p3[0]+xD2*h;  
        pt[1]=p3[1]+yD2*h;
        pt[2]=0.00;
    }
    else{
        return NULL;
    }

    // return the valid intersection  
    return pt;  
}

void QSweep:: intersection(){
    nbIntersections=0;
    double* vector;
    for (int i=2;i<myEdges_.size()-1;i++){
        vector=findIntersection(myEdges_[i-1],myEdges_[i]);
        if (vector!=NULL){
                nbIntersections++;
                myIntersections.push_back(vector);
                swap(myEdges_[i-1], myEdges_[i]);
        }
    }
} 
```

交集函数总是一样的，所以我只是找到了`findIntersection`函数。

对于 1 和 2 方法，我使用的是以下版本的`findIntersection`函数：

```
double* QSweep::computeIntersection(double m1, double b1, double m2, double b2){
    double* v=new double[3];

    v[0]= (b2-b1)/(m1-m2);
    v[1]= (m1*b2-m2*b1)/(m1-m2);
    v[2]=0.00;
    return v;
    }

    double* QSweep::findIntersection(edge_t edge1, edge_t edge2){

    //equation for the support line of the first edge

    double a=myPoints_[edge1[0]][0];
    double b=myPoints_[edge1[0]][1];
    double c=myPoints_[edge1[1]][0];
    double d=myPoints_[edge1[1]][1];
    double m1=getSlope(a,b,c,d);
    double b1=getYIntercept(a,b,c,d);

    double x=myPoints_[edge2[0]][0];
    double y=myPoints_[edge2[0]][1];
    double s=myPoints_[edge2[1]][0];
    double t=myPoints_[edge2[1]][1];
    double m2=getSlope(x,y,s,t);
    double b2=getYIntercept(x,y,s,t);
    double* vector;

    double line2InLine1=evalEqnLineD(myPoints_[edge2[0]],edge1);
    double line2InLine1New=evalEqnLineD(myPoints_[edge2[1]],edge1);
    double line1InLine2=evalEqnLineD(myPoints_[edge1[0]],edge2);
    double line1InLine2New=evalEqnLineD(myPoints_[edge1[1]],edge2);

    if (m1==m2){
        return NULL;
    }
    else{

            if ((line1InLine2*line1InLine2New)<0 &&   (line2InLine1*line2InLine1New)<0){
            vector=computeIntersection(m1,b1,m2,b2);

            if ((vector[0]>a && vector[0]<c)&&(vector[0]>x && vector[0]<s)){
                return vector;
            }
            else{
                return NULL;
            }
        }
        else{
            return NULL;
        }
    }
    return vector;
} 
```

我会从头开始，看看我想要的交叉点有什么共同点。即使对一些测试很困难，我什至没有得到好的交点，而是图表上的其他点，所以我真的很困惑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T15:37:03.547

为什么要重新发明轮子？

如果您可以处理依赖[Boost](http://www.boost.org)，我会查看[sandbox](https://svn.boost.org/trac/boost/browser/sandbox/gtl/gtl?rev=50517)中的 GTL 库。有关如何下载的说明，请阅读[wiki](https://svn.boost.org/trac/boost/wiki)（首页上的说明）。

GTL 库适用于您对数据结构的任何实现（即，它是按照 STL 的精神设计的，其中数据结构和算法是正交的）。该代码既快速又正确。如果可以，请检查一下。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-25T23:23:54.883

您可能想尝试[Boost.Geometry（又名通用几何库）](http://trac.osgeo.org/ggl/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-26T07:23:40.013

刚才你说：sweep algorithm……我用了boosted Myers 1985算法，当时那个算法是最好的。

我所做的：使用整数 - 即固定 prec。- 数字，处理精度问题。

作为两个线段的交集算法：首先明显测试范围以及线段是否平行。然后我计算了双倍的预期交点，以及两个线段的角度。每当两个线段之间的角度“小”时，我都会计算到在我的整数空间中两条线段的距离大于 1 的交点的距离。然后我将两个线段中的每一个分解为 3 个，例如 >--------< 与一个公共部分，也就是说，将交叉点单独扩展到一个线段，并删除前两个线段。如果底层的多边形变成凹形，我不介意。

由于计算线段是为了计算多边形的细分图，因此细分图只有 3 个角度更健康的线段，而不是两个几乎平行的线段。

提升还包含事件点的分布式合并排序（现在：这样的算法非常可并行！！！），从而将排序本身的复杂性从预期的 O(n log n) 降低到预期的 O(n)，但 O (n log n) 最坏情况。我强烈建议重新审视扫描（单线程）算法，以使其并行化一些分而治之的技术。

# regex - 正则表达式从描述中捕获数据

> ID：707097
> 
> 赞同：0
> 
> 时间：2009-04-01T19:58:37.003
> 
> 标签：regex

我需要一个正则表达式，它可以从这样的描述中捕获数据：

> 14 克拉黄金母亲戒指款式 152，真正的紫水晶，真正的钻石，仿祖母绿​​，优质托帕石，优质碧玺，真正的蓝宝石，雕刻：jim,jake,john,jeff,rob,sandy，带雕刻：smith

我需要捕捉的是：

A）款式（Style 152）（款式+任意编号）

B) 金（14Kt Yellow Gold）（可以是 14kt、10kt、黄色或白色的组合）

C) 宝石（真正的紫水晶、真正的钻石、仿祖母绿、优质黄玉、优质碧玺、真正的蓝宝石）（这可以改变数量，但总是至少 1 个）

D) engravings (jim,jake,john,jeff,rob,sandy) （这可以是 0 或更多，并且字符串*Engravings:* won't be there if there is no names)

E）乐队雕刻（史密斯）（这也是可选的，字符串*乐队雕刻：*如果没有名字也不会出现）

我已经用常规的 epressions 工作了几个月了，但这有点超出我的想象，因为它可以非常多......这是我想出的最好的一个，但如果字符串 *Engravings:* 是走了：

```
/(\d{2}.+gold).+(style \d+)(.+)engravings:([^\*]*)(\*)?(.*)/i 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T20:11:08.893

为什么不简单地将其分解为多个正则表达式？这样，您可以检查字符串中是否包含“engravings”，然后填充 engravings 值，或者将其留空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T20:19:41.773

最好将其分解为每个部分的多个正则表达式，但您可以通过用括号将其包裹并添加一个 ? 后，`(like this)?`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T20:20:39.947

```
/(\d{2}.+gold).+(style \d+)(.+?)(engravings:.*?)?(band engraving:.*)?/i 
```

可以做你想做的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T20:37:04.913

> ... 可以是 14kt、10kt、黄色或白色的组合...

我真的不认为正则表达式是你想要的。这并不总是合适的。

如果数据的顺序可能因描述而异（例如，有时样式在黄金之前，有时在黄金之后），那么这是一个非常好的指标，表明您需要更通用的解析（可能使用 rossfabricant 建议的多个正则表达式）。

如果您知道订单是 100% 一致的，那么您可能可以构建一个单一的正则表达式来做到这一点，但我认为这会比它值得付出更多的努力。可能有更好的选择——这将有助于了解您使用的语言。

# c# - 解析 Visual Studio 解决方案文件

> ID：707107
> 
> 赞同：111
> 
> 时间：2009-04-01T20:00:17.687
> 
> 标签：c#, .net, visual-studio, parsing

如何在 .NET 中解析 Visual Studio 解决方案 (SLN) 文件？我想编写一个应用程序，将多个解决方案合并为一个，同时保存相对构建顺序。

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2011-01-08T15:10:57.980

Microsoft.Build 程序集的 .NET 4.0 版本在 Microsoft.Build.Construction 命名空间中包含一个解析 Visual Studio 解决方案文件的 SolutionParser 类。

不幸的是，这个类是内部的，但我已经将其中的一些功能封装在一个类中，该类使用反射来获取一些您可能会发现有用的常见属性。

```
public class Solution
{
    //internal class SolutionParser
    //Name: Microsoft.Build.Construction.SolutionParser
    //Assembly: Microsoft.Build, Version=4.0.0.0

    static readonly Type s_SolutionParser;
    static readonly PropertyInfo s_SolutionParser_solutionReader;
    static readonly MethodInfo s_SolutionParser_parseSolution;
    static readonly PropertyInfo s_SolutionParser_projects;

    static Solution()
    {
        s_SolutionParser = Type.GetType("Microsoft.Build.Construction.SolutionParser, Microsoft.Build, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", false, false);
        if (s_SolutionParser != null)
        {
            s_SolutionParser_solutionReader = s_SolutionParser.GetProperty("SolutionReader", BindingFlags.NonPublic | BindingFlags.Instance);
            s_SolutionParser_projects = s_SolutionParser.GetProperty("Projects", BindingFlags.NonPublic | BindingFlags.Instance);
            s_SolutionParser_parseSolution = s_SolutionParser.GetMethod("ParseSolution", BindingFlags.NonPublic | BindingFlags.Instance);
        }
    }

    public List<SolutionProject> Projects { get; private set; }

    public Solution(string solutionFileName)
    {
        if (s_SolutionParser == null)
        {
            throw new InvalidOperationException("Can not find type 'Microsoft.Build.Construction.SolutionParser' are you missing a assembly reference to 'Microsoft.Build.dll'?");
        }
        var solutionParser = s_SolutionParser.GetConstructors(BindingFlags.Instance | BindingFlags.NonPublic).First().Invoke(null);
        using (var streamReader = new StreamReader(solutionFileName))
        {
            s_SolutionParser_solutionReader.SetValue(solutionParser, streamReader, null);
            s_SolutionParser_parseSolution.Invoke(solutionParser, null);
        }
        var projects = new List<SolutionProject>();
        var array = (Array)s_SolutionParser_projects.GetValue(solutionParser, null);
        for (int i = 0; i < array.Length; i++)
        {
            projects.Add(new SolutionProject(array.GetValue(i)));
        }
        this.Projects = projects;
    }
}

[DebuggerDisplay("{ProjectName}, {RelativePath}, {ProjectGuid}")]
public class SolutionProject
{
    static readonly Type s_ProjectInSolution;
    static readonly PropertyInfo s_ProjectInSolution_ProjectName;
    static readonly PropertyInfo s_ProjectInSolution_RelativePath;
    static readonly PropertyInfo s_ProjectInSolution_ProjectGuid;
    static readonly PropertyInfo s_ProjectInSolution_ProjectType;

    static SolutionProject()
    {
        s_ProjectInSolution = Type.GetType("Microsoft.Build.Construction.ProjectInSolution, Microsoft.Build, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", false, false);
        if (s_ProjectInSolution != null)
        {
            s_ProjectInSolution_ProjectName = s_ProjectInSolution.GetProperty("ProjectName", BindingFlags.NonPublic | BindingFlags.Instance);
            s_ProjectInSolution_RelativePath = s_ProjectInSolution.GetProperty("RelativePath", BindingFlags.NonPublic | BindingFlags.Instance);
            s_ProjectInSolution_ProjectGuid = s_ProjectInSolution.GetProperty("ProjectGuid", BindingFlags.NonPublic | BindingFlags.Instance);
            s_ProjectInSolution_ProjectType = s_ProjectInSolution.GetProperty("ProjectType", BindingFlags.NonPublic | BindingFlags.Instance);
        }
    }

    public string ProjectName { get; private set; }
    public string RelativePath { get; private set; }
    public string ProjectGuid { get; private set; }
    public string ProjectType { get; private set; }

    public SolutionProject(object solutionProject)
    {
        this.ProjectName = s_ProjectInSolution_ProjectName.GetValue(solutionProject, null) as string;
        this.RelativePath = s_ProjectInSolution_RelativePath.GetValue(solutionProject, null) as string;
        this.ProjectGuid = s_ProjectInSolution_ProjectGuid.GetValue(solutionProject, null) as string;
        this.ProjectType = s_ProjectInSolution_ProjectType.GetValue(solutionProject, null).ToString();
    }
} 
```

请注意，您必须将目标框架更改为“.NET Framework 4”（不是客户端配置文件）才能将 Microsoft.Build 引用添加到您的项目。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2015-09-29T11:29:51.427

在 Visual Studio 2015 中，现在有一个可公开访问的`SolutionFile`类，可用于解析解决方案文件：

```
using Microsoft.Build.Construction;
var _solutionFile = SolutionFile.Parse(path); 
```

此类位于*Microsoft.Build.dll 14.0.0.0*程序集中。就我而言，它位于：

```
C:\Program Files (x86)\Reference Assemblies\Microsoft\MSBuild\v14.0\Microsoft.Build.dll 
```

感谢[菲尔](https://stackoverflow.com/users/95446/phil)指出[这一点](https://stackoverflow.com/questions/707107/library-for-parsing-visual-studio-solution-files#comment50617065_4634505)！

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2011-12-14T17:08:25.773

我不知道是否有人仍在寻找解决此问题的方法，但我遇到了一个似乎可以满足需要的项目。

[https://slntools.codeplex.com/](https://slntools.codeplex.com/) 被迁移到[https://github.com/mtherien/slntools](https://github.com/mtherien/slntools)

该工具的功能之一是将多个解决方案合并在一起。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2014-05-28T17:51:33.777

[JetBrains](http://www.jetbrains.com)（Resharper 的创建者）在其程序集中具有**公共**sln 解析能力（无需反射）。它可能比此处建议的现有开源解决方案更强大（更不用说 ReGex hacks）。您需要做的就是：

*   下载[ReSharper 命令行工具](http://www.jetbrains.com/resharper/features/command-line.html)（免费）。
*   添加以下内容作为对您项目的引用
    *   `JetBrains.Platform.ProjectModel`
    *   `JetBrains.Platform.Util`
    *   `JetBrains.Platform.Interop.WinApi`

该库没有文档记录，但 Reflector（或者实际上是 dotPeek）是您的朋友。例如：

```
public static void PrintProjects(string solutionPath)
{
    var slnFile = SolutionFileParser.ParseFile(FileSystemPath.Parse(solutionPath));
    foreach (var project in slnFile.Projects)
    {
        Console.WriteLine(project.ProjectName);
        Console.WriteLine(project.ProjectGuid);
        Console.WriteLine(project.ProjectTypeGuid);
        foreach (var kvp in project.ProjectSections)
        {
            Console.WriteLine(kvp.Key);
            foreach (var projectSection in kvp.Value) 
            {
                Console.WriteLine(projectSection.SectionName);
                Console.WriteLine(projectSection.SectionValue);
                foreach (var kvpp in projectSection.Properties)
                {
                    Console.WriteLine(kvpp.Key); 
                    Console.WriteLine(string.Join(",", kvpp.Value));
                }
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-04-01T20:37:40.810

我不能真正为您提供图书馆，我猜那里不存在图书馆。但是我花了很多时间在批量编辑场景中处理 .sln 文件，我发现 Powershell 是完成这项任务的一个非常有用的工具。.SLN 格式非常简单，几乎可以用一些快速而肮脏的表达式来完全解析。例如

包含的项目文件。

```
gc ConsoleApplication30.sln | 
  ? { $_ -match "^Project" } | 
  %{ $_ -match ".*=(.*)$" | out-null ; $matches[1] } | 
  %{ $_.Split(",")[1].Trim().Trim('"') } 
```

它并不总是很漂亮，但它是进行批处理的有效方法。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-01-08T15:32:47.697

我们通过编写一个 Visual Studio 插件解决了一个类似的自动合并解决方案的问题，该插件创建了一个新的解决方案，然后搜索 *.sln 文件并将它们导入到新的解决方案中：

```
dte2.Solution.AddFromFile(solutionPath, false); 
```

我们的问题略有不同，因为我们希望 VS 为我们整理构建顺序，因此我们随后尽可能将任何 dll 引用转换为项目引用。

然后，我们通过 COM 自动化运行 VS，将其自动化到构建过程中。

这个解决方案有点 Heath Robinson，但优点是 VS 正在编辑，所以我们的代码不依赖于 sln 文件的格式。当我们从 VS 2005 迁移到 2008 并再次迁移到 2010 时，这很有帮助。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-09-30T20:07:30.517

一切都很好，但我也想获得 sln 生成能力——在上面的代码快照中，你只解析 .sln 文件——我想做类似的事情，除了能够通过对 .sln 文件的轻微修改重新生成 sln . 例如，这种情况可能是为不同的 .NET 平台移植相同的项目。目前它只是 sln 重新生成，但稍后我会将其扩展到项目。

我想我还想展示正则表达式和本机接口的强大功能。（更少的代码，更多的功能）

**更新 4.1.2017** 我为解析 .sln 解决方案创建了单独的 svn 存储库： [https ://sourceforge.net/p/syncproj/code/HEAD/tree/](https://sourceforge.net/p/syncproj/code/HEAD/tree/)

下面是我自己的代码示例片段（前身）。您可以自由使用它们中的任何一个。

~~将来基于 svn 的解决方案解析代码也可能会更新为生成功能。~~

**更新 4.2.2017** SVN 中的源代码也支持 .sln 生成。

```
using System;
using System.Linq;
using System.Collections.Generic;
using System.IO;
using System.Diagnostics;
using System.Text.RegularExpressions;
using System.Text;

public class Program
{
    [DebuggerDisplay("{ProjectName}, {RelativePath}, {ProjectGuid}")]
    public class SolutionProject
    {
        public string ParentProjectGuid;
        public string ProjectName;
        public string RelativePath;
        public string ProjectGuid;

        public string AsSlnString()
        { 
            return "Project(\"" + ParentProjectGuid + "\") = \"" + ProjectName + "\", \"" + RelativePath + "\", \"" + ProjectGuid + "\"";
        }
    }

/// <summary>
/// .sln loaded into class.
/// </summary>
public class Solution
{
    public List<object> slnLines;       // List of either String (line format is not intresting to us), or SolutionProject.

    /// <summary>
    /// Loads visual studio .sln solution
    /// </summary>
    /// <param name="solutionFileName"></param>
    /// <exception cref="System.IO.FileNotFoundException">The file specified in path was not found.</exception>
    public Solution( string solutionFileName )
    {
        slnLines = new List<object>();
        String slnTxt = File.ReadAllText(solutionFileName);
        string[] lines = slnTxt.Split('\n');
        //Match string like: Project("{66666666-7777-8888-9999-AAAAAAAAAAAA}") = "ProjectName", "projectpath.csproj", "{11111111-2222-3333-4444-555555555555}"
        Regex projMatcher = new Regex("Project\\(\"(?<ParentProjectGuid>{[A-F0-9-]+})\"\\) = \"(?<ProjectName>.*?)\", \"(?<RelativePath>.*?)\", \"(?<ProjectGuid>{[A-F0-9-]+})");

        Regex.Replace(slnTxt, "^(.*?)[\n\r]*$", new MatchEvaluator(m =>
            {
                String line = m.Groups[1].Value;

                Match m2 = projMatcher.Match(line);
                if (m2.Groups.Count < 2)
                {
                    slnLines.Add(line);
                    return "";
                }

                SolutionProject s = new SolutionProject();
                foreach (String g in projMatcher.GetGroupNames().Where(x => x != "0")) /* "0" - RegEx special kind of group */
                    s.GetType().GetField(g).SetValue(s, m2.Groups[g].ToString());

                slnLines.Add(s);
                return "";
            }), 
            RegexOptions.Multiline
        );
    }

    /// <summary>
    /// Gets list of sub-projects in solution.
    /// </summary>
    /// <param name="bGetAlsoFolders">true if get also sub-folders.</param>
    public List<SolutionProject> GetProjects( bool bGetAlsoFolders = false )
    {
        var q = slnLines.Where( x => x is SolutionProject ).Select( i => i as SolutionProject );

        if( !bGetAlsoFolders )  // Filter away folder names in solution.
            q = q.Where( x => x.RelativePath != x.ProjectName );

        return q.ToList();
    }

    /// <summary>
    /// Saves solution as file.
    /// </summary>
    public void SaveAs( String asFilename )
    {
        StringBuilder s = new StringBuilder();

        for( int i = 0; i < slnLines.Count; i++ )
        {
            if( slnLines[i] is String ) 
                s.Append(slnLines[i]);
            else
                s.Append((slnLines[i] as SolutionProject).AsSlnString() );

            if( i != slnLines.Count )
                s.AppendLine();
        }

        File.WriteAllText(asFilename, s.ToString());
    }
}

    static void Main()
    {
        String projectFile = @"yourown.sln";

        try
        {
            String outProjectFile = Path.Combine(Path.GetDirectoryName(projectFile), Path.GetFileNameWithoutExtension(projectFile) + "_2.sln");
            Solution s = new Solution(projectFile);
            foreach( var proj in s.GetProjects() )
            {
                Console.WriteLine( proj.RelativePath );
            }

            SolutionProject p = s.GetProjects().Where( x => x.ProjectName.Contains("Plugin") ).First();
            p.RelativePath = Path.Combine( Path.GetDirectoryName(p.RelativePath) , Path.GetFileNameWithoutExtension(p.RelativePath) + "_Variation" + ".csproj");

            s.SaveAs(outProjectFile);

        }
        catch (Exception ex)
        {
            Console.WriteLine("Error: " + ex.Message);
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-11-16T02:59:20.687

我阐述，确定MSBuild类可以用来操作底层结构。稍后我将在我的网站上提供更多代码。

```
// VSSolution

using System;
using System.Reflection;
using System.Collections.Generic;
using System.Linq;
using System.Diagnostics;
using System.IO;
using AbstractX.Contracts;

namespace VSProvider
{
    public class VSSolution : IVSSolution
    {
        //internal class SolutionParser 
        //Name: Microsoft.Build.Construction.SolutionParser 
        //Assembly: Microsoft.Build, Version=4.0.0.0 

        static readonly Type s_SolutionParser;
        static readonly PropertyInfo s_SolutionParser_solutionReader;
        static readonly MethodInfo s_SolutionParser_parseSolution;
        static readonly PropertyInfo s_SolutionParser_projects;
        private string solutionFileName;
        private List<VSProject> projects;

        public string Name
        {
            get
            {
                return Path.GetFileNameWithoutExtension(solutionFileName);
            }
        }

        public IEnumerable<IVSProject> Projects
        {
            get
            {
                return projects;
            }
        }

        static VSSolution()
        {
            s_SolutionParser = Type.GetType("Microsoft.Build.Construction.SolutionParser, Microsoft.Build, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", false, false);
            s_SolutionParser_solutionReader = s_SolutionParser.GetProperty("SolutionReader", BindingFlags.NonPublic | BindingFlags.Instance);
            s_SolutionParser_projects = s_SolutionParser.GetProperty("Projects", BindingFlags.NonPublic | BindingFlags.Instance);
            s_SolutionParser_parseSolution = s_SolutionParser.GetMethod("ParseSolution", BindingFlags.NonPublic | BindingFlags.Instance);
        }

        public string SolutionPath
        {
            get
            {
                var file = new FileInfo(solutionFileName);

                return file.DirectoryName;
            }
        }

        public VSSolution(string solutionFileName)
        {
            if (s_SolutionParser == null)
            {
                throw new InvalidOperationException("Can not find type 'Microsoft.Build.Construction.SolutionParser' are you missing a assembly reference to 'Microsoft.Build.dll'?");
            }

            var solutionParser = s_SolutionParser.GetConstructors(BindingFlags.Instance | BindingFlags.NonPublic).First().Invoke(null);

            using (var streamReader = new StreamReader(solutionFileName))
            {
                s_SolutionParser_solutionReader.SetValue(solutionParser, streamReader, null);
                s_SolutionParser_parseSolution.Invoke(solutionParser, null);
            }

            this.solutionFileName = solutionFileName;

            projects = new List<VSProject>();
            var array = (Array)s_SolutionParser_projects.GetValue(solutionParser, null);

            for (int i = 0; i < array.Length; i++)
            {
                projects.Add(new VSProject(this, array.GetValue(i)));
            }
        }

        public void Dispose()
        {
        }
    }
}

// VSProject

using System;
using System.Reflection;
using System.Collections.Generic;
using System.Linq;
using System.Diagnostics;
using System.IO;
using System.Xml;
using AbstractX.Contracts;
using System.Collections;

namespace VSProvider
{
    [DebuggerDisplay("{ProjectName}, {RelativePath}, {ProjectGuid}")]
    public class VSProject : IVSProject
    {
        static readonly Type s_ProjectInSolution;
        static readonly Type s_RootElement;
        static readonly Type s_ProjectRootElement;
        static readonly Type s_ProjectRootElementCache;
        static readonly PropertyInfo s_ProjectInSolution_ProjectName;
        static readonly PropertyInfo s_ProjectInSolution_ProjectType;
        static readonly PropertyInfo s_ProjectInSolution_RelativePath;
        static readonly PropertyInfo s_ProjectInSolution_ProjectGuid;
        static readonly PropertyInfo s_ProjectRootElement_Items;

        private VSSolution solution;
        private string projectFileName;
        private object internalSolutionProject;
        private List<VSProjectItem> items;
        public string Name { get; private set; }
        public string ProjectType { get; private set; }
        public string RelativePath { get; private set; }
        public string ProjectGuid { get; private set; }

        public string FileName
        {
            get
            {
                return projectFileName;
            }
        }

        static VSProject()
        {
            s_ProjectInSolution = Type.GetType("Microsoft.Build.Construction.ProjectInSolution, Microsoft.Build, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", false, false);

            s_ProjectInSolution_ProjectName = s_ProjectInSolution.GetProperty("ProjectName", BindingFlags.NonPublic | BindingFlags.Instance);
            s_ProjectInSolution_ProjectType = s_ProjectInSolution.GetProperty("ProjectType", BindingFlags.NonPublic | BindingFlags.Instance);
            s_ProjectInSolution_RelativePath = s_ProjectInSolution.GetProperty("RelativePath", BindingFlags.NonPublic | BindingFlags.Instance);
            s_ProjectInSolution_ProjectGuid = s_ProjectInSolution.GetProperty("ProjectGuid", BindingFlags.NonPublic | BindingFlags.Instance);

            s_ProjectRootElement = Type.GetType("Microsoft.Build.Construction.ProjectRootElement, Microsoft.Build, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", false, false);
            s_ProjectRootElementCache = Type.GetType("Microsoft.Build.Evaluation.ProjectRootElementCache, Microsoft.Build, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", false, false);

            s_ProjectRootElement_Items = s_ProjectRootElement.GetProperty("Items", BindingFlags.Public | BindingFlags.Instance);
        }

        public IEnumerable<IVSProjectItem> Items
        {
            get
            {
                return items;
            }
        }

        public VSProject(VSSolution solution, object internalSolutionProject)
        {
            this.Name = s_ProjectInSolution_ProjectName.GetValue(internalSolutionProject, null) as string;
            this.ProjectType = s_ProjectInSolution_ProjectType.GetValue(internalSolutionProject, null).ToString();
            this.RelativePath = s_ProjectInSolution_RelativePath.GetValue(internalSolutionProject, null) as string;
            this.ProjectGuid = s_ProjectInSolution_ProjectGuid.GetValue(internalSolutionProject, null) as string;

            this.solution = solution;
            this.internalSolutionProject = internalSolutionProject;

            this.projectFileName = Path.Combine(solution.SolutionPath, this.RelativePath);

            items = new List<VSProjectItem>();

            if (this.ProjectType == "KnownToBeMSBuildFormat")
            {
                this.Parse();
            }
        }

        private void Parse()
        {
            var stream = File.OpenRead(projectFileName);
            var reader = XmlReader.Create(stream);
            var cache = s_ProjectRootElementCache.GetConstructors(BindingFlags.Instance | BindingFlags.NonPublic).First().Invoke(new object[] { true });
            var rootElement = s_ProjectRootElement.GetConstructors(BindingFlags.Instance | BindingFlags.NonPublic).First().Invoke(new object[] { reader, cache });

            stream.Close();

            var collection = (ICollection)s_ProjectRootElement_Items.GetValue(rootElement, null);

            foreach (var item in collection)
            {
                items.Add(new VSProjectItem(this, item));
            }

        }

        public IEnumerable<IVSProjectItem> EDMXModels
        {
            get 
            {
                return this.items.Where(i => i.ItemType == "EntityDeploy");
            }
        }

        public void Dispose()
        {
        }
    }
}

// VSProjectItem

using System;
using System.Reflection;
using System.Collections.Generic;
using System.Linq;
using System.Diagnostics;
using System.IO;
using System.Xml;
using AbstractX.Contracts;

namespace VSProvider
{
    [DebuggerDisplay("{ProjectName}, {RelativePath}, {ProjectGuid}")]
    public class VSProjectItem : IVSProjectItem
    {
        static readonly Type s_ProjectItemElement;
        static readonly PropertyInfo s_ProjectItemElement_ItemType;
        static readonly PropertyInfo s_ProjectItemElement_Include;

        private VSProject project;
        private object internalProjectItem;
        private string fileName;

        static VSProjectItem()
        {
            s_ProjectItemElement = Type.GetType("Microsoft.Build.Construction.ProjectItemElement, Microsoft.Build, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", false, false);

            s_ProjectItemElement_ItemType = s_ProjectItemElement.GetProperty("ItemType", BindingFlags.Public | BindingFlags.Instance);
            s_ProjectItemElement_Include = s_ProjectItemElement.GetProperty("Include", BindingFlags.Public | BindingFlags.Instance);
        }

        public string ItemType { get; private set; }
        public string Include { get; private set; }

        public VSProjectItem(VSProject project, object internalProjectItem)
        {
            this.ItemType = s_ProjectItemElement_ItemType.GetValue(internalProjectItem, null) as string;
            this.Include = s_ProjectItemElement_Include.GetValue(internalProjectItem, null) as string;
            this.project = project;
            this.internalProjectItem = internalProjectItem;

            // todo - expand this

            if (this.ItemType == "Compile" || this.ItemType == "EntityDeploy")
            {
                var file = new FileInfo(project.FileName);

                fileName = Path.Combine(file.DirectoryName, this.Include);
            }
        }

        public byte[] FileContents
        {
            get 
            {
                return File.ReadAllBytes(fileName);
            }
        }

        public string Name
        {
            get 
            {
                if (fileName != null)
                {
                    var file = new FileInfo(fileName);

                    return file.Name;
                }
                else
                {
                    return this.Include;
                }
            }
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-07-14T14:29:31.213

[@john-leidegren 的回答](https://stackoverflow.com/a/4634505/2745573)很棒。对于 VS2015 之前的版本，这很有用。但是有一个小错误，因为缺少检索配置的代码。所以想添加它，以防有人正在努力使用此代码。
增强非常简单：

```
 public class Solution
{
    //internal class SolutionParser
    //Name: Microsoft.Build.Construction.SolutionParser
    //Assembly: Microsoft.Build, Version=4.0.0.0

    static readonly Type s_SolutionParser;
    static readonly PropertyInfo s_SolutionParser_solutionReader;
    static readonly MethodInfo s_SolutionParser_parseSolution;
    static readonly PropertyInfo s_SolutionParser_projects;
    static readonly PropertyInfo s_SolutionParser_configurations;//this was missing in john's answer

    static Solution()
    {
        s_SolutionParser = Type.GetType("Microsoft.Build.Construction.SolutionParser, Microsoft.Build, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", false, false);
        if ( s_SolutionParser != null )
        {
            s_SolutionParser_solutionReader = s_SolutionParser.GetProperty("SolutionReader", BindingFlags.NonPublic | BindingFlags.Instance);
            s_SolutionParser_projects = s_SolutionParser.GetProperty("Projects", BindingFlags.NonPublic | BindingFlags.Instance);
            s_SolutionParser_parseSolution = s_SolutionParser.GetMethod("ParseSolution", BindingFlags.NonPublic | BindingFlags.Instance);
            s_SolutionParser_configurations = s_SolutionParser.GetProperty("SolutionConfigurations", BindingFlags.NonPublic | BindingFlags.Instance); //this was missing in john's answer

            // additional info:
            var PropNameLst = GenHlp_PropBrowser.PropNamesOfType(s_SolutionParser);
            // the above call would yield something like this:
            // [ 0] "SolutionParserWarnings"        string
            // [ 1] "SolutionParserComments"        string
            // [ 2] "SolutionParserErrorCodes"      string
            // [ 3] "Version"                       string
            // [ 4] "ContainsWebProjects"           string
            // [ 5] "ContainsWebDeploymentProjects" string
            // [ 6] "ProjectsInOrder"               string
            // [ 7] "ProjectsByGuid"                string
            // [ 8] "SolutionFile"                  string
            // [ 9] "SolutionFileDirectory"         string
            // [10] "SolutionReader"                string
            // [11] "Projects"                      string
            // [12] "SolutionConfigurations"        string
        }
    }

    public List<SolutionProject> Projects { get; private set; }
    public List<SolutionConfiguration> Configurations { get; private set; }

   //...
   //...
   //... no change in the rest of the code
} 
```

作为额外的帮助，提供简单的代码来浏览`System.Type`@oasten 建议的 a 的属性。

```
public class GenHlp_PropBrowser
{
    public static List<string> PropNamesOfClass(object anObj)
    {
        return anObj == null ? null : PropNamesOfType(anObj.GetType());
    }
    public static List<String> PropNamesOfType(System.Type aTyp)
    {
        List<string> retLst = new List<string>();
        foreach ( var p in aTyp.GetProperties(BindingFlags.NonPublic | BindingFlags.Instance) )
        {
            retLst.Add(p.Name);
        }
        return retLst;
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-01-21T16:44:04.983

对于它的价值，我现在创建了一个小项目来读取 nuget 上可用的 sln 和 proj 文件：

[https://www.nuget.org/packages/ByteDev.DotNet/](https://www.nuget.org/packages/ByteDev.DotNet/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-02-09T02:55:45.237

感谢@John Leidegren，他提供了一种有效的方法。我编写了一个 hlper 类，因为我无法使用他无法找到`s_SolutionParser_configurations`没有 FullName 的项目的代码。

代码在[github](https://gist.github.com/lindexi/b36feb816fe9e586ffbbdf58397b25da)中，可以获取具有 FullName 的项目。

并且代码无法获取SolutionConfiguration。

但是当你开发一个 vsx 时，vs 会说找不到`Microsoft.Build.dll`，所以你可以尝试使用 dte 来获取所有项目。

使用dte获取所有项目的代码在[github](https://gist.github.com/lindexi/3105bd0f0c5225bec4aa476f84dd29db)

# visual-studio-2008 - 在 Visual Studio 中，从项目中删除所有排除文件的快速方法是什么？

> ID：707113
> 
> 赞同：3
> 
> 时间：2009-04-01T20:01:38.090
> 
> 标签：visual-studio-2008, file

我在 Visual Studio 2008 中有一个大型项目。它积累了几年的尝试经验，并且经常从项目中排除（而不是删除）文件。我需要一种永久删除任何排除文件的方法。有数千个文件和数百个文件夹。在解决方案资源管理器中手动执行会花费太多时间。

我可以构建一个项目文件解析器并与文件系统进行比较，但我希望有一个快捷方式。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T20:06:21.480

排除的文件是否与其他文件一起受到源代码控制？如果没有，只需确保所有内容都已签入，获取到新的临时位置，将旧目录移开作为备份，然后将临时文件夹移动到旧目录所在的位置。

如果将实验检查到源代码控制中，则稍微困难一些-您可能需要使用项目文件解析器。不过，这可能不是很难。

编辑：好的，如果全部在 SVN 中，我建议你编写一个*非常*粗糙的项目解析器。给它一个 XPath 表达式（或类似的东西）列表以选择为“可能的路径”。选择项目文件中的所有内容，并将每个选择的文件复制到新位置（包括子目录等）。同时复制项目文件和解决方案文件。然后尝试构建——如果它失败了，你就错过了一些东西：重复。

继续直到它构建，然后测试它。只要一切都好，你就可以把其他一切都吹走:)

编辑：这是我的意思的*开始：*

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Xml.Linq;

public class ProjectParser
{
    static void Main(string[] args)
    {
        XDocument doc = XDocument.Load(args[0]);

        XNamespace ns = "http://schemas.microsoft.com/developer/msbuild/2003";
        DumpMatches(doc.Descendants(ns + "Compile")
                       .Select(x => x.Attribute("Include").Value));
        DumpMatches(doc.Descendants(ns + "AssemblyOriginatorKeyFile")
                       .Select(x => x.Value));
    }

    static void DumpMatches(IEnumerable<string> values)
    {
        foreach (string x in values)
        {
            Console.WriteLine(x);
        }
    }
} 
```

（我最初尝试使用 XPath，但命名空间的东西让它很痛苦。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T20:07:01.197

调出命令提示符并尝试`DEL/S *.exclude`. 我认为在 Visual Studio 中编写加载项不会比你做得更好。

# database - SQL 'ORDER BY' 缓慢

> ID：707117
> 
> 赞同：13
> 
> 时间：2009-04-01T20:03:07.010
> 
> 标签：database, sql-server-2005

这是真的，`ORDER BY`通常很慢吗？我正在尝试在`WHERE`子句非常简单的情况下运行一些 sql 语句，但随后我正在索引列`ORDER BY`上尝试。`VARCHAR(50)`

出于显示原因，我需要按字母顺序排序。我认为让数据库为我做这件事是最有效的。

在这一点上，我正在寻找

*   优化sql查询
*   对代码中的结果集进行排序

这是我尝试运行的实际查询：

```
// B.SYNTAX is a TEXT/CLOB field
// Indexes on NAME, MODULENAME. PREVIOUS is a CHAR(1) with no index
"SELECT A.NAME, B.SYNTAX, B.DESCRIPTION, A.RATE1, A.RATE2, 
A.RATE3, A.STARTDATE, A.ENDDATE, A.HIDE, A.CATEGORYNAME 
FROM A, B WHERE A.MODULENAME='"+loadedModuleName+"' 
AND A.NAME = B.NAME AND (A.PREVIOUS<>'N' OR A.PREVIOUS IS NULL) 
ORDER BY A.NAME" 
```

表 A 的大小约为 2000 行，B 约为 500 行。

我可能还应该提到，因为我们支持多个数据库，所以我不能做很多特定于数据库的优化。此外，该应用程序部署在客户站点。

我预计将返回数百条记录（少于 1000 条）。

你会怎么办？任何提示表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-01T20:07:24.363

索引字段的排序*不*应该很慢，因为它可以按索引顺序提取数据。您可能希望提供有关数据库结构 (DDL) 和实际查询的信息，以便人们查看。

您绝对应该尽可能使用 SQL 排序而不是代码排序，以便您在正确的轨道上。

**更新：** 好的，有几件事。首先，您不应该使用“+loadedModuleName+”构造，因为它使每个查询都是唯一的并且搞砸了优化器。使用参数。其次，您的 Order by 子句对于它是表 A 还是表 B 不明确 - 明确说明并选择带有索引的表（即使两者都有索引，也要明确说明）。最后，即使是 char(1)，您的“Previous”字段仍然可以被索引。除了最后一个建议的索引，测试速度，如果仍然很慢，我会做所有的事情，去索引并再次检查。

**更新**所以您将返回 <1000 条记录，但表的总大小是多少？

**更新**哦，伙计，我很抱歉我之前没有抓住这个。如果您想在 SQL Server 上正确部署它，您的查询应该是：

```
SELECT A.NAME, B.SYNTAX, B.DESCRIPTION, A.RATE1, A.RATE2, A.RATE3, A.STARTDATE, A.ENDDATE, A.HIDE, A.CATEGORYNAME 
FROM Table1 A join Table2 B on (A.Name=B.Name)
WHERE (A.MODULENAME=@ModuleName) AND (A.PREVIOUS<>'N' OR A.PREVIOUS IS NULL) 
ORDER BY A.NAME 
```

试试这个，我几乎可以保证你会看到一个巨大的加速。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-01T20:06:12.617

`ORDER BY`一般不会很慢，前提是数据库可以找到与`ORDER BY`表达式对应的索引。

但是，您的 SQL 语句可能包含其他强制数据库在返回结果之前扫描整个表的内容，例如`SELECT TOP n`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-01T20:07:57.543

如果您的过滤器如下所示：

```
WHERE col1 = @value1
      AND col2 = @value2
      AND col3 = @value3
ORDER BY
      col4 
```

，那么您需要在 上创建索引`(col1, col2, col3, col4)`。

优化器将使用索引来过滤前三个值并按第四个值排序。

如果您没有这样的索引，则会发生以下情况之一：

1.  优化器将使用索引来过滤`WHERE`条件，但它仍然需要`ORDER`剩余的行。
2.  优化器将使用`ORDER`值的索引，但需要查看所有值以将它们过滤掉。
3.  优化器根本不会使用索引，因此 2“需要查看所有值以过滤掉它们”和 1“必须对所有剩余的行进行排序”的两个缺点都是正确的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-01T20:32:08.250

**更新**：作为您发布的查询，我认为最好的选择是将查询视为良好，因为：

*   对于几行，不要关心谁做的工作。那么对你来说更容易的是使用`ORDER BY`.
*   对于很多行，不要让客户端做这项工作：RDMBS 更专业，并确保服务器有更多的内存和 CPU。

* * *

您必须考虑的订单提示是：

*   `ORDER BY`是对 SQL 查询进行保修排序的**唯一方法。**
*   无论如何，**最好的排序** *工作者*是数据库：一定要这样做！
*   尝试最小化返回行的基数。
*   根据查询创建索引。这意味着将有序列放在索引的最后。
*   如果查询很快，请避免建立索引。
*   您可以考虑对索引进行了排序，那么如果您仅对表进行排序并且具有良好的索引，则排序的成本可能接近于零。

有关索引的更多经验法则，请查看[其他 SO question](https://stackoverflow.com/questions/687986/what-are-some-best-practises-and-rules-of-thumb-for-creating-database-indexes/688006#688006)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-01T20:05:21.607

它不应该很慢。优化您的查询和数据库结构（如果是 SQL Server，至少是索引和统计信息）。`ORDER BY`除了导致这种缓慢的原因之外，您的查询中可能还有其他一些东西？

```
SELECT A.NAME, B.SYNTAX, B.DESCRIPTION, A.RATE1, A.RATE2, A.RATE3,
       A.STARTDATE, A.ENDDATE, A.HIDE, A.CATEGORYNAME
FROM Table1 A JOIN Table2 B on A.Name = B.Name
WHERE A.MODULENAME = @ModuleName AND A.PREVIOUS<>'N' OR A.PREVIOUS IS NULL
ORDER BY A.NAME 
```

## 选项1

如果您只查询几个简单的列 (2-4)，您也可以将它们包含到索引中。这样您的查询将运行得更快。还要确保该索引列上的排序顺序与查询中的排序顺序相匹配。

```
// if your query looks like this:
SELECT [Name], [Title], [Count] ORDER BY [COUNT]

// you can create an index on [Name], [Title], [Count] 
```

## 选项 3

创建一个`view`并将其绑定到`schema`. 然后从中查询数据`view`。

## 选项 3

如果您使用`SQL Server 2005`以上方法，您还可以尝试在**SQL Server Profiler**中运行查询，它会向您推荐可以应用于表的最佳索引和统计信息，以优化此特定查询的性能。

## 选项 4

尝试重建索引和统计信息。

## 选项 5

您可以尝试将索引/表放入不同硬盘驱动器上的单独文件组中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-01T20:07:23.787

如果您选择显示的行数足够少，则无法想象该`ORDER BY`子句将花费任何可察觉的时间，除非您使用`LIMIT`or限制返回的行数`TOP`。

我们需要更多信息。什么数据库管理系统？查询计划是什么样的？您是否查看过带有和不带有 的查询计划`ORDER BY`？你看到什么不同？

* * *

编辑：

```
SELECT A.NAME, B.SYNTAX, B.DESCRIPTION, A.RATE1, A.RATE2,  
A.RATE3, A.STARTDATE, A.ENDDATE, A.HIDE, A.CATEGORYNAME  
FROM A, B  
WHERE A.MODULENAME='"+loadedModuleName+"'   
  AND A.NAME = B.NAME  
  AND (A.PREVIOUS<>'N' OR A.PREVIOUS IS NULL)  
ORDER BY NAME 
```

是`NAME`吗`primary key`？有`index`开`NAME`吗？单独使用，还是与其他领域一起使用？以什么顺序？
一个loadedModuleName 返回多少行？
我怀疑缓慢来自“`A.PREVIOUS <> 'N' OR A.PREVIOUS IS NULL"` 尝试使用`(NOT A.PREVIOUS = 'N')`我认为是等效的并且可能会有所帮助。
在有和没有的情况下对查询进行`ORDER BY`计时，看看时间是否完全不同。不应该。

* * *

编辑：

如果在或`NAME`中不是唯一的，则当每个实例在 上交叉连接时，您的连接将部分弹道。如果 50 个 A 行匹配，50 个 B 行匹配，您最终将得到 2500 个结果行，这可能不是您想要的。`A``B``A.NAME``B.NAME`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-01T20:09:14.280

`ORDER BY`不是特别慢，特别是如果该列上有索引。特别是，如果您在该列上有*聚集*索引，则数据已经排序。

您还可以使用分页（`TOP`或`ROW_NUMBER`）等来提供帮助。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-01T20:24:31.420

请记住，许多查询编辑器会在前 50 个左右从数据库返回后显示结果。

添加 ORDER BY 将强制它在数据库上等待*所有*结果，这将揭示查询的真实速度。

在这些情况下，原始查询和 ORDERed 查询的速度相同；您只是被愚弄以为第一个很快，因为您的编辑器很快就获得了前 50 行左右。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-02T19:37:31.127

我昨晚在一个更生产类型的数据库（不是开发人员的数据库）上做了一些性能测试，这是我发现的：

表 A 中的总行数：13000

表 B 中的总行数：5000

连接查询返回的行数：5000

使用 ORDER BY 子句所用时间：~5.422 秒

不使用 ORDER BY 子句所用时间：~5.345 秒。

所以看起来 ORDER BY 并没有太大的不同。（我可以添加几毫秒）。

我还通过将所有 B.SYNTAX 值设置为 NULL 来进行测试，以确保它不仅仅是传输如此多数据的网络延迟。

**现在我从 SELECT 子句中删除了 B.SYNTAX，查询只用了 0.8 秒！**

所以看起来整个 CLOB 列是瓶颈。这并不意味着我已经找到了使这个查询更快的解决方案，但至少我不会花时间编写排序算法。

感谢所有回复的人。我学到了很多东西，这让我尝试了一些不同的事情。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-01T20:07:03.007

说“order by”本身很慢并不是一个公平的说法。就它们自己的实现、数据类型和索引方案而言，您需要考虑许多 RDBM。但是，我怀疑您是否可以比在服务器上更快地在客户端对其进行排序，但这并不是说在服务器上对其进行排序是正确的做法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-01T20:12:52.710

这里有*很多*问题在起作用。

就纯粹的性能而言，*假设索引等设置正确*，数据库非常擅长排序。 *对于一个单独的查询*，在数据库中排序可能是最快的。

不幸的是，在实践中，数据库经常成为应用程序的瓶颈。您可以采取任何措施将工作从数据库中转移出去，从而提高您的整体应用程序吞吐量。这包括将排序操作转移到不太繁忙的业务、Web 或表示层。表示层可能无法有效地对一个查询进行排序，但它可能更适合处理整体负载。当您可以可靠地将工作一直推送到单个最终用户机器时尤其如此，尽管这可能会出现问题。

另一方面，这里需要考虑的不仅仅是纯粹的性能。您还想考虑未来的维护。还有什么比简单的“ORDER BY”子句更易于维护的呢？这只是一行代码，与谁知道需要多少额外的程序员工作才能在别处工作的排序相比。在这种情况下，您最好在问题上投入一些资金，以确保您的数据库能够简单地维持*可接受*的性能、排序和所有水平。

即使在这里，问题也不是一成不变的。有一种观点认为排序确实应该被视为表示层的功能，并且最终表示层也是进行这项工作的更易于维护的地方。我不赞成那个理论，但它就在那里。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-01T20:16:18.927

ORDER BY 强制 RDBMS 进行排序。

排序需要 RDBMS 服务器上可能不存在的资源。

在某些情况下（即单表查询），您可以编写一个与索引匹配的 ORDER BY——如果您的 RDBMS 保证表按索引顺序保存——它可能是零成本。[通过丢弃 RDBMS 并使用文件，可以进一步改进依赖于大量单表查询的 DB 设计。]

通常， ORDER BY 必须进行排序。

“我认为让数据库为我做这件事是最有效的。”

这种假设是错误的。数据库不一定比你在数据库外的程序更有效。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-01T20:18:44.600

在客户端上排序，在我看来是你不应该做的事情。数据库引擎针对数据排序进行了优化。

就像其他人说的，如果你可以限制你选择的行数，这将运行得更快。

回答以下问题可能有助于更进一步：

*   查询返回多少行？
*   选择了多少列？
*   你加入任何桌子吗？
*   有/没有 ORDER BY 需要多长时间？

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-01T20:59:32.147

这里有很多非常好的建议，但有一件小事我没有看到我想评论。

你用的是什么数据库？作为一个在 MySQL 上花费大量时间的人，我突然想到的是 OR 语句。MySQL 使用 OR 可能*真的很*愚蠢。我已经看到进行两次选择并将它们联合在一起会更快。

如果您的行数很大（在表中，未返回），这可能是一个因素。

否则我会同意其他帖子。索引应该使它更快，并且让数据库来做而不是自己处理通常更好。数据库知道它在做什么。除非您有一个非常大的数据集并且想要将排序负担转移给客户端（以便数据库可以进行更多查询），否则我会让数据库进行排序工作。

# python - Python 源码头注释

> ID：707127
> 
> 赞同：11
> 
> 时间：2009-04-01T20:05:21.200
> 
> 标签：python, unix, shebang

什么是线

```
#!/usr/bin/env python 
```

在用于的python脚本的第一行？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-01T20:14:20.103

在 UNIX 和 Linux 中，这告诉使用哪个二进制文件作为解释器（另见[Wiki 页面](http://en.wikipedia.org/wiki/Shebang_(Unix))）。例如，shell 脚本由`/bin/sh`.

```
#!/bin/sh 
```

现在使用 python 有点棘手，因为你不能假设二进制文件安装在哪里，也不能假设你想使用哪个。因此`/usr/bin/env`诀窍。它使用`$PATH`. 您可以检查执行`which python`

使用解释器行，您可以通过将脚本 chmod 为可执行文件来运行脚本。只是运行它。因此以脚本开头

```
#!/usr/bin/env python 
```

这两种方法是等价的：

```
$ python script.py 
```

和（假设你之前已经完成了`chmod +x script.py`）

```
$ ./script.py 
```

* * *

这对于创建系统范围的脚本很有用。

```
cp yourCmd.py /usr/local/bin/yourCmd
chmod a+rx /usr/local/bin/yourCmd 
```

然后你可以从任何地方调用它

```
yourCmd 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-01T20:10:09.240

这称为[shebang](http://en.wikipedia.org/wiki/Shebang_(Unix))线：

> 在计算中，shebang（也称为 hashbang、hashpling 或 pound bang）指的是字符“#！” 当它们是文本文件中的前两个字符时。类 Unix 操作系统将这两个字符的存在作为文件是脚本的指示，并尝试使用文件中第一行其余部分指定的解释器执行该脚本。例如，Bourne shell 的 shell 脚本从第一行开始：

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-01T20:08:35.593

在 UNIX 和类似的操作系统下，这一行告诉如果执行文件将使用哪个解释器。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-01T20:15:29.320

正如安德里所说。在 Windows 中，从命令行启动时运行文件的可执行文件依赖于关联：

```
16:12:40.68 C:\>assoc .py
.py=Python.File

16:13:53.45 C:\>assoc Python.File
Python.File=Python File

16:14:01.70 C:\>ftype Python.File
Python.File="C:\Python30\python.exe" "%1" %* 
```

在 Unix 中，shell 解释器通过打开文件并查看文件中是否有指定的命令来进行推断。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-01T20:10:20.750

'/usr/bin/env python' 在 $PATH 中搜索 python 并运行它。

> 通常**env**用于为程序设置一些环境变量

该行的作用是告诉您的计算机如何处理该文件，如果您只是尝试运行该文件**而不指定解释器**..[更多详细信息](http://forums.debian.net/viewtopic.php?t=36789)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-01T20:52:34.440

请注意，这一行只不过是对**Windows**中解释器的注释。

# c# - 使用 ASP.NET 会话进行生命周期管理 (Unity)

> ID：707138
> 
> 赞同：17
> 
> 时间：2009-04-01T20:07:46.297
> 
> 标签：c#, asp.net, session, unity-container

我正在考虑使用 Unity 来管理自定义用户类实例的生命周期。我计划使用自定义 ASP.NET 会话管理器来扩展 LifetimeManager。我想要做的是从我的自定义类中存储和检索当前登录的用户对象，并让 Unity 从 ASP.NET 中的会话对象中获取 User 的实例，或者（在 Win32 项目中）检索它静态或从当前线程。

到目前为止，我最好的解决方案是在启动时创建我的 Unity 容器的静态实例，并使用 Resolve 方法从我的每个类中获取我的用户对象。但是，这似乎在我的其他类中创建了对统一容器的依赖。实现这一目标的更“团结”的方式是什么？我希望能够从任何类中读取/替换当前的用户实例。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2010-07-29T06:07:38.527

与 ASP.Net MVC 而不是普通的旧 ASP.Net 项目一起使用时，您会在 Unity 中获得最佳效果。ASP.Net MVC 允许您使用 Unity 之类的容器来管理用户对象、控制器、模型等。如果可能，为您的项目使用 MVC 而不是 ASP.net Web 表单。

如果我正确理解了您的问题，您可能希望使用 Unity 来维护对象在每个会话中的生命周期。您需要实现一个扩展 LifetimeManager 的 SessionLifetimeManager。代码非常简单，遵循以下几行：

```
public class SessionLifetimeManager : LifetimeManager
{
    private string _key = Guid.NewGuid().ToString();

    public override object GetValue()
    {
          return HttpContext.Current.Session[_key];
    }

    public override void SetValue(object value)
    {
          HttpContext.Current.Session[_key] = value;
    }

    public override void RemoveValue()
    {
          HttpContext.Current.Session.Remove(_key);
    }
} 
```

您还可以为 PerWebRequest 生命周期管理编写一个类似的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T15:58:15.323

为什么不使用缓存对象...然后您可以从 win 和 web 中使用它。像这样：

```
 IUnityContainer container= HttpRuntime.Cache.Get("Unity") as IUnityContainer;

    if (container == null)
    {
        container= // init container

        HttpRuntime.Cache.Add("Unity",
            container,
            null,
            Cache.NoAbsoluteExpiration,
            Cache.NoSlidingExpiration,
            CacheItemPriority.NotRemovable,
            null);
    }

    // return container or something 
```

HttpRuntime.Cache 将在 win 和 web 中工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T20:11:31.140

我认为您需要通过统一公开的两项服务（或一项同时执行这两项操作的服务）。

与其存储用户对象，不如存储一个接口实现，该接口实现公开了一个方法/属性，该方法/属性将为您获取用户对象。在 ASP.NET 案例中，您从会话中检索用户。在 WinForm 解决方案（或其他）中，您可以从执行线程中获取它。

您还将拥有一个 set 方法/属性，用于设置用户。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T04:38:15.470

Sounds like actually you need Registry pattern, not Unity.

[http://martinfowler.com/eaaCatalog/registry.html](http://martinfowler.com/eaaCatalog/registry.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-02T23:23:35.060

如果通过“自定义 ASP.NET 会话管理器”您正在谈论 NHibernate 会话或 Data/ObjectContext，听起来您需要的是注入到构造函数或属性设置器中的 IUserRepository，您可以从中检索用户对象。IUserRepository 的实现可以是从数据库访问到后端缓存等的任何内容。如果您直接在容器上使用 .Resolve() ，那么您将遵循[服务定位器](http://commonservicelocator.codeplex.com/)模式，并且没有正确使用 Unity 提供的所有功能。

然后，您可以使用[Ravi 的答案](https://stackoverflow.com/questions/707138/using-asp-net-session-for-lifetime-management-unity/3359863#3359863)来管理存储库的生命周期。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-02T01:16:27.443

也许我想太多了，但我认为您应该将 AoP 与 IoC 一起使用。这真是一个美丽的配对。本质上，我要做的是劫持您正在解析的类的构造函数，否则称为创建方面。然后，您可以在进入构造函数时将用户注入到类中，但是无论解决该类的问题，都不必显式地提供给用户，从而防止与 Unity 本身配对。

[PostSharp](http://www.sharpcrafters.com/)是一个优秀的 AoP 框架恕我直言。

现在最终您的应用程序将依赖于 AoP 框架，但是根据您的环境，完全解耦的应用程序可能是不现实的。您可能会惊讶于 AoP 和 IoC 的组合有多么有用。

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2010-05-17T14:27:07.450

如果这不太正确，我很抱歉，但是......

Unity 是一个游戏开发平台，因此我假设您正在构建一个 3d 应用程序或游戏，您打算用它来做一些很酷的事情（例如，使其成为多人游戏/使用服务器跟踪用户进度）。

为什么不让每个用户都登录，那么您可以使用 MembershipProvider 和 Formsauthentication 类来访问用户 id/name。

在您的服务器上，您只需将所有信息链接到用户的信息，即可轻松撤回与情况/用户请求相关的（简单的 ajax / 普通 http 请求）数据。

我不确定这一点，但我相信统一是部署客户端的东西，因此不需要在服务器上完成与它的集成。

只需请求您需要的内容并在客户端进行处理。

这样，您就可以坚持经典的 n 层设计模式，该模式允许您将逻辑与数据存储和 ui 分开。

希望这可以帮助 ...

# iphone - 我必须将图像文件放在哪里才能在 iPhone 应用程序中以编程方式加载它们？

> ID：707141
> 
> 赞同：0
> 
> 时间：2009-04-01T20:08:31.177
> 
> 标签：iphone

我已将我的图像放在 XCode Groups&Files 中，在这个位置：

**资源/img/**

但现在我查看了苹果的 UICatalog XCode 项目，他们将所有图像都放在这里：

**图片/**

看起来 Interface Builder 找到它们没有问题，但是一旦我以编程方式尝试，所有尝试都会失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T20:17:58.627

IB 总是被告知项目图像在哪里，所以无论你在哪里拥有它们 - 只是它们包含在项目中。

您稍后创建的图像必须存储在应用程序可以访问的可写区域中，我认为您不能使用 UIImageNamed 加载它们 - 您必须为它们创建一个文件 URL 并使用数据方法中的图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T20:22:07.400

您需要使用 pathForResource。

请参阅：[如何在 iPhone 上使用 fopen()？](https://stackoverflow.com/questions/318341/how-to-fopen-on-the-iphone)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T09:31:18.720

在 Xcode 中，组仅用于组织，您添加到项目中的所有数据文件都将放置在应用程序包的根目录中，而不管它们的组（假设组不是文件夹等） . 如果您使用文件夹而不是组，则会保留目录结构。我认为 UIImage imageNamed: 总是在根目录中查找。

# c# - C# 2.0 中的扩展方法

> ID：707145
> 
> 赞同：11
> 
> 时间：2009-04-01T20:09:48.850
> 
> 标签：c#, .net-2.0, extension-methods

我需要什么命名空间才能让我的扩展工作

这是我的扩展方法

```
使用系统；
使用 System.Collections.Generic；
使用 System.Web；
使用 System.Data；

命名空间 MyUtilities
{
    公共静态类 DataReaderExtensions
    {
        public static DataTable ToDataTable(IDataReader reader)
        {
            数据表表 = 新数据表（）；
            table.Load(读者);
            返回表；
        }
    }
}

```

当我尝试像这样使用它时

```
Session["Master"] = cust.GetCustomerOrderSummary((string)Session["CustomerNumber"]).ToDataTable();

```

它不起作用。这是.net 2.0

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-01T20:12:02.057

你不能。C# 2.0 根本没有扩展方法。*您可以在面向*.NET 2.0的 Visual Studio 2008 中使用来自 C# 3.0 的扩展方法，如我的[“C#/.NET 版本”文章中所述](http://csharpindepth.com/Articles/Chapter1/Versions.aspx)，但您不能说服 C# 2.0 编译器表现得好像它理解什么是扩展方法。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-04-01T20:13:18.653

标签说 .NET 2.0；如果您使用 C# 3.0（即 VS 2008）并以 .NET 2.0 为目标，则可以通过声明 ExtensionAttribute 来做到这一点 - 或者（更简单）只需引用[LINQBridge](https://www.nuget.org/packages/LinqBridge/)。

```
namespace System.Runtime.CompilerServices
{
    [AttributeUsage(AttributeTargets.Assembly | AttributeTargets.Class |
        AttributeTargets.Method)]
    public sealed class ExtensionAttribute : Attribute { }
} 
```

有了这个，扩展方法将在 .NET 2.0 和 C# 3.0 中工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T20:13:10.480

扩展方法在 C# 2 中不起作用，因为它们依赖于 C# 3 编译器。C# 3 编译器知道如何进行翻译：

```
foo.Bar() 
```

对此：

```
ExtensionClass.Bar(foo) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-01T20:14:11.117

正如 JS 所说，C# 2.0 没有扩展方法。

该扩展方法也将定义为：

```
public static DataTable ToDataTable(this IDataReader reader) 
```

尝试这样称呼它：

```
DataReaderExtensions.ToDataTable(
   cust.GetCustomerOrderSummary((string)Session["CustomerNumber"])
   ) 
```

# latex - LaTeX：如何使用必需的参数作为可选参数的默认值？

> ID：707152
> 
> 赞同：4
> 
> 时间：2009-04-01T20:11:11.047
> 
> 标签：latex, definition, tex

我正在尝试创建一个带有两个参数的 LaTeX 命令，其中一个是可选的。通常我会这样做

```
\newcommand{\whatever}[2][default]{first #1 second #2} 
```

其中`default`是第一个参数的默认值。但是对于这个命令，我希望将第二个参数的值用作第一个参数的默认值——也就是说，我想要

```
\whatever{blah}
\whatever{foo}
\whatever[lol]{rofl} 
```

相当于

```
\whatever[blah]{blah}
\whatever[foo]{foo}
\whatever[lol]{rofl} 
```

有谁知道如何做到这一点？如有必要，我可以下拉到纯 TeX。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-01T21:40:13.267

LaTeX 内核有一个内置的方法可以做到这一点，尽管它没有被广泛使用。这是一个例子：

```
\makeatletter
\newcommand\@foo[2][]{[1: #1, 2: #2.] }
\newcommand\foo{\@dblarg\@foo}
\makeatother

\foo{same}
\foo[hello]{world} 
```

显然，如果您在or文件中`\makeatletter`执行此操作，则可以删除命令。`.sty``.cls`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T20:26:13.380

一个丑陋的黑客：

```
\usepackage{ifthen}

...

\newcommand{\whatever}[2][uniquenonesense]{
   ... 
   \ifthenelse{\equal{#2}{uniquenonesense}}{#1}{#2}
   ...
} 
```

大概你想要更干净的东西，但这就是我所拥有的。

根据您的语义，`uniquenonesense`可能为空。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-05T10:54:42.707

```
 \newcommand{\haha}[2]{\backslash whatever \left[ #1 \right] 
    \left[   #1     \right] }

    \begin{document}
    $\haha{blah}{blah}$\\
    $\haha{stupid}{Idiot}$
    \end{document} % This works very well. 
```

# scala - 如何在 Scala 中将元组隐式转换为向量

> ID：707162
> 
> 赞同：5
> 
> 时间：2009-04-01T20:13:40.807
> 
> 标签：scala, tuples, implicit

我希望能够将数字元组（Ints 和 double）隐式转换为向量对象。

假设一个带有 + 方法的 Vector 类

```
case class Vector(x: Double, y:Double){
  def + (v:Vector)= new Vector(x+v.x,y+v.y)
} 
```

我的目标是让以下代码工作。

```
val vec = (1,2)+(.5,.3) // vec == Vector(1.5,2.3) 
```

我可以通过`Int`以下方式使用它

```
implicit def int2vec(t:Tuple2[Int,Int])=new Vector(t._1,t._2)
val vec = (1,2)+(3,4) // vec == Vector(4.0,6.0) 
```

但是当我添加双精度转换时它失败了

```
implicit def int2vec(t:Tuple2[Int,Int])=new Vector(t._1,t._2)
implicit def double2vec(t:Tuple2[Double,Double])=new Vector(t._1,t._2)
val a = (1,2)
val b = (.5,.3)
val c = (1,1)+b // vec = Vector(1.5,1.3)
val d = (1,2)+(.3,.5) // compile error: wrong number of arguments
val e = (1,2)+((.3,.5)) // compile error: type mismatch 
```

根据 Andri 的建议尝试加倍

```
implicit def double2vec(t:Tuple2[Double,Double])=new Vector(t._1,t._2)
val a = (.5,.3)
val b = (1,1)+a // type mismatch found:(Double,Double) required:String 
```

我需要做什么才能使其正常工作？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-01T21:13:11.350

Scala 的语法很灵活，但不是无限灵活。特别是，元组、参数和隐式的汇合使得这在库设计空间中成为一个非常危险的领域。正如您所注意到的，事情可能会中断，无法正常工作，并给出神秘的错误消息。如果可以的话，我建议你避免它。

特别是，我建议您做出以下定义：

```
val V = Vector 
```

然后您的所有示例都按您的预期工作，没有任何隐含、魔法或神秘的错误消息，并且每个向量只有一个字符。

```
val a = V(1,2)+V(.5,.3)
val b = V(1,2)+V(3,4)
val c = V(1,2)
val d = V(.5,.3)
val e = V(1,1)+b
val f = V(1,2)+V(.3,.5)
val g = V(.5,.3)
val h = V(1,1)+a 
```

这不是您想要的语法，但相信我，从长远来看，它会为您省去痛苦和头痛。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T20:33:22.600

这些隐式转换是模棱两可的，因此 Scala 不会使用它们中的任何一个。这就是为什么最后几行不会评估的原因。

解决此问题的一种方法将`int2vec`完全排除在外，尽管这意味着首先将所有整数隐式转换为双精度数。

# c# - 如何根据目标参数类型验证 C# 中的复合格式字符串？

> ID：707163
> 
> 赞同：4
> 
> 时间：2009-04-01T20:14:08.963
> 
> 标签：c#, validation, string.format

给定用户提供的复合格式字符串（与 一起使用`String.Format`）和一组表示将用于格式化复合格式字符串的参数的类型，您如何检查用户提供的值是否有效？

[创建一个正则表达式来检查参数占位符的一般语法是否与文档](http://msdn.microsoft.com/en-us/library/txafckwd.aspx)`{index[,alignment][:formatString]}`中的“ ”匹配应该很容易。验证复合格式字符串中占位符的索引是否小于输入参数的实际数量（即它们不引用不会给出的参数）并不难。但是，鉴于将传入的参数的类型是已知的，也应该可以验证“ ”是否适合这些类型。`:formatString`

例如，`{0:dddd MMMM}`当第一个参数类型（0 索引）是数字（`String.Format("{0:dddd MMMM}", 1234)`产生“ `dddd MMMM`”）时，您想验证用户没有将“”指定为格式字符串。按类型划分的“ `:formatString`”选项数量[太大](http://john-sheehan.com/blog/wp-content/uploads/msnet-formatting-strings.pdf)，无法手动检查所有内容。还有其他方法吗？还是您只需要与可能指定错误格式字符串的用户一起生活？

假设这里没有自定义或[`IFormatProvider`](http://msdn.microsoft.com/en-us/library/system.iformatprovider.aspx)实现。只是 .NET Framework 中已有的基本类型。解决自定义内容的奖励积分。[`ICustomFormatter`](http://msdn.microsoft.com/en-us/library/system.icustomformatter.aspx)[`IFormattable`](http://msdn.microsoft.com/en-us/library/system.iformattable.aspx)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-01T20:17:20.673

AFAIK，没有内置的方法可以做到这一点。

您可以手动编写每个常见案例，但我不建议这样做。

（**编辑**）一个务实的选择可能是`try/catch`- 在用户输入格式时尽早测试格式......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-01T20:19:51.557

对不起，但是这样做的方法是：

```
try { string.Format(godKnowsWhat, aBunchOfArguments); }
catch(FormatException) { // use exception for control flow lol } 
```

是的，有点糟糕。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T20:27:10.103

如果用户指定的错误格式字符串可能导致异常，那么也许您可以尝试一下？是的，这是天真的想法。

# apache2 - apache 000-默认虚拟主机

> ID：707169
> 
> 赞同：5
> 
> 时间：2009-04-01T20:17:01.407
> 
> 标签：apache2

我看到有 000-default 虚拟主机，我离开了它。我为 mysite.com 创建了一个新文件和链接，它可以工作，但不是我想要的。我想知道，有谁知道我是否需要删除或不应该删除 000-default vh？

出于某种原因，如果访问[http://mysite.com](http://mysite.com)，它会将我带到 000-default 站点，但如果我访问[http://www.mysite.com](http://www.mysite.com)，它会将我带到正确的位置。为什么有区别？

这是 mysite.com vh 文件：

```
#NameVirtualHost *
<VirtualHost *:80>
        ServerAdmin nick@mysite.com
        ServerName mysite.com
        ServerAlias www.mysite.com *.mysite.com
        DocumentRoot /home/nick/www/mysite.com

        ErrorLog /var/log/apache2/mysite.com/error.log

        # Possible values include: debug, info, notice, warn, error, crit,
        # alert, emerg.
        LogLevel info

        CustomLog /var/log/apache2/mysite.com/access.log common
        ServerSignature On

</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-12-02T13:47:35.543

使用“ *_default_* ”虚拟主机可以解决问题：[http ://httpd.apache.org/docs/2.0/vhosts/examples.html#default](http://httpd.apache.org/docs/2.0/vhosts/examples.html#default)

在创建另一个虚拟主机配置后，将默认虚拟主机配置更改为“ *_default_ ”是一种很好的做法。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T20:23:13.310

像这样配置，不需要默认 VH。现在，为什么 mysite.com 会将您设为默认值？这是一个很好的问题，如果您的配置与您复制的完全一样，您已经重新启动了服务器，那么它不应该。

# delphi - Delphi 2007 帮助集成

> ID：707171
> 
> 赞同：4
> 
> 时间：2009-04-01T20:17:24.930
> 
> 标签：delphi, ide, delphi-2007

我在 2008 年初迁移到 Delphi 2007。迁移我所有的工具和组件花了很长时间，而且我并不急于再次这样做。我是从 Delphi 6 搬来的。（买了 D2006，但由于迁移的问题，没怎么用）。

MSDN / F1 帮助“集成”，但仍然经常让我发疯。我根据需要访问 D6 帮助文件和各个供应商的帮助文件，但它肯定不如旧的 put-your-cursor-on-a-method 有用，单击 F1 -> 你会得到一些旧的有用的东西帮助方法，尤其是在集成了所有供应商文件的情况下。

看来我参加聚会可能很晚了，但显然我并不孤单：http: [//blogs.embarcadero.com/deeelling/2007/08/21/38290](http://blogs.embarcadero.com/deeelling/2007/08/21/38290)

我现在看到 Embarcadero 允许您下载 Delphi 2007 的 CHM 文件。他们有什么方法可以完全集成它们，并完全摆脱那个无用的 MSDN 怪物吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-01T20:34:14.080

这不能回答您的问题（我自己也急切地等待一个好的答案），但是[这个工具](http://www.delphipraxis.net/731770-post.html#838434)确实使默认帮助更快一点。所以你可以在合理的时间内得到无用的结果:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T23:05:30.330

这是一对：

BDS 专家的 Delphi 7 帮助 [http://codecentral.embarcadero.com/Item/23948](http://codecentral.embarcadero.com/Item/23948)

Delphi 2007 帮助专家 [http://cc.embarcadero.com/Item/24815](http://cc.embarcadero.com/Item/24815)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T12:17:53.623

不是我知道的，对不起。我真的很好奇你是如何（以及是否）设法解决这个问题的。在使用 Delphi 3/4/5/6/07/08/09 之后，我必须承认他们在沿途某处引入 MSDN“怪物”（如您所说）时出错了。那是我绝对不喜欢的一个变化。

如今，您可能最好（合法地）“获得”一些 PDF 书籍，因为它们比 Delphi 帮助更容易搜索而不是有效。祝你的新德尔福好运！:)

# windows - 如何在 Windows 上的 Cygwin 中运行 crontab？

> ID：707184
> 
> 赞同：104
> 
> 时间：2009-04-01T20:20:49.587
> 
> 标签：windows, cygwin, cron, crontab

一些 cygwin 命令是`.exe`文件，因此您可以使用标准的 Windows 调度程序运行它们，但其他命令没有`.exe`扩展名，因此无法从 DOS 运行（看起来）。

例如，我想`updatedb`每晚跑步。

如何让 cron 工作？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2009-04-01T20:33:02.303

您还需要安装`cygrunsrv`，以便可以将 cron 设置为 Windows 服务，然后运行`cron-config`​​.

如果您希望 cron 作业发送任何输出的电子邮件，您还需要安装`exim`or `ssmtp`（在运行之前`cron-config`。）

有关`/usr/share/doc/Cygwin/cron-*.README`更多详细信息，请参阅。

对于没有`.exe`扩展名的程序，它们可能是某种类型的 shell 脚本。如果您查看文件的第一行，您可以看到需要使用什么程序来运行它们（例如，“ `#!/bin/sh`”），因此您可能可以通过调用 shell 程序从 Windows 调度程序执行它们（例如，“ `C:\cygwin\bin\sh.exe -l /my/cygwin/path/to/prog`”。 )

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2009-04-01T20:34:27.840

你有两个选择：

1.  使用 cygrunsrv 将 cron 安装为 Windows 服务：

    ```
    cygrunsrv -I cron -p /usr/sbin/cron -a -n

    net start cron 
    ```

    > 请注意，在（非常）旧版本的 cron 中，您需要使用 -D 而不是 -n

2.  “非 .exe”文件可能是 bash 脚本，因此您可以通过 Windows 调度程序通过调用 bash 来运行脚本来运行它们，例如：

    ```
    C:\cygwin\bin\bash.exe -l -c "./full-path/to/script.sh" 
    ```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2011-10-26T08:10:53.797

帽子提示[http://linux.subogero.com/894/cron-on-cygwin/](http://linux.subogero.com/894/cron-on-cygwin/)

启动 cygwin-setup 并从“Admin”类别添加“cron”包。

我们将由用户 SYSTEM 将 cron 作为服务运行。因此，糟糕的 SYSTEM 需要一个主目录和一个 shell。“/etc/passwd”文件将定义它们。

```
$ mkdir /root
$ chown SYSTEM:root /root
$ mcedit /etc/passwd
SYSTEM:*:......:/root:/bin/bash 
```

启动服务：

```
$ cron-config
Do you want to remove or reinstall it (yes/no) yes
Do you want to install the cron daemon as a service? (yes/no) yes
Enter the value of CYGWIN for the daemon: [ ] ntsec
Do you want the cron daemon to run as yourself? (yes/no) no
Do you want to start the cron daemon as a service now? (yes/no) yes 
```

**本地用户**现在可以像这样定义他们的计划任务（crontab 将启动您最喜欢的编辑器）：

```
$ crontab -e  # edit your user specific cron-table HOME=/home/foo
PATH=/usr/local/bin:/usr/bin:/bin:$PATH
# testing - one per line
* * * * *   touch ~/cron
@reboot     ~/foo.sh
45 11 * * * ~/lunch_message_to_mates.sh 
```

**域用户**：它不起作用。糟糕的 cron 无法代表机器上的域用户运行计划任务。但还有另一种方式：cron 还运行“/etc/crontab”中系统级 cron 表中的内容。因此，在此处插入您的 suff，以便 SYSTEM 代表自己执行此操作：

```
$ touch /etc/crontab
$ chown SYSTEM /etc/crontab
$ mcedit /etc/crontab
HOME=/root
PATH=/usr/local/bin:/usr/bin:/bin:$PATH
* * * * *   SYSTEM touch ~/cron
@reboot     SYSTEM rm -f /tmp/.ssh* 
```

最后是关于 crontab 条目的几句话。它们是环境设置或预定命令。如上所示，在 Cygwin 上最好创建一个可用的 PATH。主目录和 shell 通常取自“/etc/passwd”。

至于预定命令的列，请参见手册页。

如果某些 crontab 条目没有运行，最好的诊断工具是：

```
$ cronevents 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-04-28T12:52:16.333

只是想补充一点，cron 的选项似乎已经改变。需要通过 -n 而不是 -D。

```
cygrunsrv -I cron -p /usr/sbin/cron -a -n 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-11-04T19:26:12.767

当我登录到 Windows 7 时，我想出了如何让 Cygwin cron 服务自动运行。这对我有用：

使用记事本，在第一行和第二行（不带引号）创建`C:\cygwin\bin\Cygwin_launch_crontab_service_input.txt`包含内容的文件。这是您对.`no``yes``cron-config`

创建`C:\cygwin\Cygwin_launch_crontab_service.bat`包含内容的文件：

```
@echo off
C:
chdir C:\cygwin\bin
bash  cron-config < Cygwin_launch_crontab_service_input.txt 
```

在 Windows 启动文件夹中添加以下快捷方式： `Cygwin_launch_crontab_service.bat`

如果您需要有关如何添加到 Startup 的帮助，请参阅[http://www.sevenforums.com/tutorials/1401-startup-programs-change.html 。](http://www.sevenforums.com/tutorials/1401-startup-programs-change.html)顺便说一句，如果您愿意，您可以选择在 Startup 中添加这些：

赛格温

XWin 服务器

第一个执行

```
C:\cygwin\Cygwin.bat 
```

第二个执行

```
C:\cygwin\bin\run.exe /usr/bin/bash.exe -l -c /usr/bin/startxwin.exe 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-03-20T08:36:37.897

应用了[这个答案](https://stackoverflow.com/a/707227/65706)的说明，它起作用了 只是为了指出一个更像复制粘贴的答案（因为 cygwin 安装程序是一种反复制粘贴明智的实现）
单击 WinLogo 按钮，键入 cmd.exe ，右键单击它，选择“以管理员身份启动”。在**cmd**提示符下：

```
 cd <directory_where_i_forgot_the setup-x86_64.exe> cygwin installer:
 set package_name=cygrunsrv cron
 setup-x86_64.exe -n -q -s http://cygwin.mirror.constant.com -P %package_name% 
```

确保安装程序不会在提示符中抛出任何错误......如果它有 - 你可能有一些 cygwin 二进制文件正在运行，或者你不是 Windows 管理员，或者一些怪异的错误......

现在在**cmd**提示符中：

```
 C:\cygwin64\bin\cygrunsrv.exe -I cron -p /usr/sbin/cron -a -D 
```

或您可能对 cygrunsrv.exe 拥有的任何完整文件路径，并在 cmd 提示符下将 cron 作为 Windows 服务启动

```
 net start cron 
```

现在在**bash**终端运行 crontab -e

设置您的 cron 条目下面的示例：

```
 #sync my gdrive each 10th minute
    */10 * * * * /home/Yordan/sync_gdrive.sh

    # * * * * * command to be executed
    # - - - - -
    # | | | | |
    # | | | | +- - - - day of week (0 - 6) (Sunday=0)
    # | | | +- - - - - month (1 - 12)
    # | | +- - - - - - day of month (1 - 31)
    # | +- - - - - - - hour (0 - 23)
    # +--------------- minute 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-07-29T12:05:55.837

在 cygwin 中将***cron***安装为 Windows 服务的正确语法是将***-n***作为参数而不是***-D***传递：

*cygrinsrv --install cron --path /usr/sbin/cron --args **-n***

***-D***在 cygwin 中启动***cron时返回使用错误：***

*$*

*$cygrunsrv --install cron --path /usr/sbin/cron --args -D*

*$cygrinsrv --start cron*

*cygrunsrv：启动服务时出错：QueryServiceStatus：Win32 错误 1062：*

*该服务尚未启动。*

*$cat /var/log/cron.log*

*cron：未知选项--D*

*用法：/usr/sbin/cron [-n] [-x [ext,sch,proc,parc,load,misc,test,bit]]*

*$*

下面的页面有一个很好的解释。

在 Windows 中安装和配置 Cygwin Cron 服务： [https ://www.davidjnice.com/cygwin_cron_service.html](https://www.davidjnice.com/cygwin_cron_service.html)

**PS**我必须以管理员身份在我的 Windows 10 PC 上运行***Cygwin64 终端才能将******cron***安装为 Windows 服务。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-12-11T17:03:54.610

```
Getting updatedb to work in cron on Cygwin -- debugging steps
1) Make sure cron is installed.
 a) Type 'cron' tab tab and look for completion help.
   You should see crontab.exe, cron-config, etc.  If not install cron using setup.
2) Run cron-config.  Be sure to read all the ways to diagnose cron.
3) Run crontab -e
 a) Create a test entry of something simple, e.g.,
   "* * * * * echo $HOME >> /tmp/mycron.log" and save it.
4) cat /tmp/mycron.log.  Does it show cron environment variable HOME
   every minute?
5) Is HOME correct?  By default mine was /home/myusername; not what I wanted.
   So, I added the entry
   "HOME='/cygdrive/c/documents and settings/myusername'" to crontab.
6) Once assured the test entry works I moved on to 'updatedb' by
   adding an entry in crontab.
7) Since updatedb is a script, errors of sed and find showed up in
   my cron.log file.  In the error line, the absolute path of sed referenced
   an old version of sed.exe and not the one in /usr/bin.  I tried changing my
   cron PATH environment variable but because it was so long crontab
   considered the (otherwise valid) change to be an error.  I tried an
   explicit much-shorter PATH command, including what I thought were the essential
   WINDOWS paths but my cron.log file was empty.  Eventually I left PATH alone and
   replaced the old sed.exe in the other path with sed.exe from /usr/bin.
   After that updatedb ran to completion.  To reduce the number of
   permission error lines I eventually ended up with this:
   "# Run updatedb at 2:10am once per day skipping Sat and Sun'
   "10 2  *  *  1-5  /usr/bin/updatedb --localpaths='/cygdrive/c' --prunepaths='/cygdrive/c/WINDOWS'"

Notes: I ran cron-config several times throughout this process
       to restart the cygwin cron daemon. 
```

# unit-testing - 稍后编写单元测试

> ID：707193
> 
> 赞同：5
> 
> 时间：2009-04-01T20:23:15.743
> 
> 标签：unit-testing, tdd

我知道 TDD 风格是先编写测试，看到它失败然后将其变为绿色，这是好东西。有时它真的对我有用。

然而，特别是当我在尝试一些东西时（*即不确定设计，不确定它是否会工作*）或疯狂地编写代码，我不想编写单元测试，它破坏了我的流程。

我倾向于稍后编写单元测试，尤其是在事情变得太复杂之前。还有另一个问题，以后写它们通常更无聊。

我不太确定这是否是一个好方法（*绝对不是最好的*）。

你怎么看？您以后编写单元测试的代码吗？或者你如何处理这个流程问题或实验设计/代码阶段。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-01T20:37:45.553

我了解到的**是没有实验代码**，至少不能在生产环境和/或紧迫的期限内工作。通常会进行实验，直到某些东西“起作用”，此时它成为生产代码。

另一方面是**从一开始的 TDD 将导致更好的代码设计**。与事后编写测试相比，您会更多地考虑它、重新设计它、更频繁地重构它。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-01T20:25:53.460

我在事后编写了测试。迟到总比不好。它们总是值得拥有。

但是，不得不说，第一次在写测试代码之前写它们，是非常令人满意的。无需再摆弄手动测试。我很惊讶它的感觉有多好。

此外，我倾向于在重构遗留代码之前编写单元测试——几乎按照定义，这意味着我正在编写测试来测试已经编写的代码。提供了一个安全毯，让我更容易接触到其他人编写的大块代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-01T20:36:55.353

**“我不太确定这是否是一个好方法（绝对不是最好的）。”**

不好？为什么不？

您是否在设计可测试性？在这种情况下，您的设计是测试驱动的。还有什么可以要求的？

测试是先出现、在中间还是最后出现与设计可测试性无关紧要。最后，对设计的更改将使测试失败，您可以修复问题。预期设计更改而对测试进行更改也会使测试失败。两者都很好。

如果你的设计工作已经结束，而中间有一些难以测试的东西，那么你就没有做 TDD。您必须重构您的设计以使其可测试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-01T20:29:51.983

我经常采取与您所说的相同的方法。似乎行之有效的方法是完全照此处理实验代码，然后根据您所学的内容开始适当的设计。从这里您可以先编写测试。否则，您将留下大量临时或实验性代码，并且可能无法为所有这些代码编写测试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-01T20:40:55.263

我想说，对于正常的开发，TDD 工作得非常好。在某些情况下，您可能不需要先编写测试（甚至根本不需要），但这种情况并不常见。但是，有时您需要进行一些探索以查看可行的方法。我认为这是一个“尖峰”，我不一定认为在这种情况下 TDD 是绝对必要的。我可能不会在我的项目中使用实际的“尖峰”代码。毕竟，这只是一次探索，现在我对它应该如何工作有了更好的了解，我可能可以编写比我的“尖峰”代码更好的代码（和测试）。如果我确实决定使用我的“尖峰”代码，我可能会回去为它编写测试。

现在，如果您发现自己违反了 TDD 并在测试之前编写了一些生产代码——它确实发生了——那么我也会回去编写测试。事实上，在这种情况发生在我身上的时候，我经常会发现我在开始编写测试时忽略的事情，因为我想到了更多没有由代码处理的测试。最终，你回到了 TDD 节奏（并且发誓再也不会那样做）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-01T21:41:04.043

考虑与沉没成本相关的心理倾向。也就是说，当你谈到等式的第二部分时，我们都有的懒惰基因让我们想要保护我们已经完成的工作。后果？

## 如果您先编写测试...

您倾向于编写代码以适应测试。这鼓励了“解决问题的最简单的事情”类型的开发，并使您专注于解决问题而不是解决元问题。

## 如果你先写代码...

您会很想编写适合代码的测试。实际上，这相当于编写问题以适合您的答案，这有点倒退，并且通常会导致价值较小的测试。

尽管如果 50 名程序员中有 1 名总是首先编写测试，我会感到惊讶，但我仍然认为，如果你想编写好的软件，这是需要努力的事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-01T20:50:15.320

我通常先编写测试，但有时在试验时我会在之后编写代码。一旦我知道我的代码应该做什么，我就会停止代码并开始测试。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-01T20:34:33.737

VS 2008 有一个很好的功能，可以为对象生成测试类，测试需要我调整，但它为你做了很多繁重的工作。它非常适合为您不那么勤奋的同事进行测试。

这样做的另一个好处是它有助于防止您遗漏某些东西，当您处理不属于您的代码时。

如果您使用与 MSUnitTest 不同的测试框架，则将测试从 MSUnit 转换为 Nunit 等相当简单，只需进行一些复制和过去。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-01T20:37:07.677

当您试图弄清楚您的代码将如何工作时，首先编写代码是很自然的。首先编写测试可以帮助您确定您的代码显示做什么（而不是它应该如何做）。如果您首先编写代码，那么您是在尝试解决问题而没有完全定义问题。这不一定是“坏的”，但您将单元测试用作回归工具而不是开发工具（同样，不是“坏” - 只是不是 TDD）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-01T21:20:49.990

我想说我总是先编写单元测试，但我当然不会（出于任何真正的程序员都知道的许多原因:-)）。我（好吧，也不*总是*......）所做的是将每个需要我超过五分钟才能找到的错误转换为单元测试。甚至在我修复它之前。这具有以下优点：

*   它会记录错误并在稍后再次出现时提醒我。
*   它有助于找到错误，因为我有一个明确定义的位置来放置调试代码（设置我的数据结构、调用正确的方法、设置断点等）。在我发现单元测试之前，我修改了 main() 函数对于此测试代码，当我事后忘记将其删除时会导致奇怪的结果...
*   通常它会给我很好的想法还有什么可能出错的，所以它经常在一大堆单元测试中演变，并导致多个错误被发现。固定的。

# java - 删除 Java 项目中不必要的依赖项的工具

> ID：707194
> 
> 赞同：9
> 
> 时间：2009-04-01T20:23:29.487
> 
> 标签：java, dependencies

我有一个 Java 项目，它的库目录中目前有很多 JAR，这些都包含在构建时生成的包中。但是，我知道其中一些库从未在项目中引用。

是否有可以搜索项目中未引用的库的工具？我想在这个意义上一定有什么东西。

顺便说一句，Eclipse 插件会很棒。

编辑：我选择使用 ClassDep，因为这是唯一有效的建议。但是，我遇到了一些麻烦：请检查[这个问题](https://stackoverflow.com/questions/745574/classpath-problems-with-jini-classdep-javas-dependency-finder)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-01T20:40:40.227

请注意通过 Class.forName() 加载的类并且未在清单文件中指定为依赖项的情况（有一个 Depends-On: 属性，但很多人没有指定它，这会破坏像这样的工具，当我使用这样的工具时，我存在的祸根）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-01T20:31:58.267

[ClassDep](http://java.sun.com/products/jini/2.0/doc/api/com/sun/jini/tool/ClassDep.html)（来自 Sun，在 Jini 开发工具包中）将为您完成这项工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T20:28:08.010

[ClassPathHelper](http://classpathhelper.sourceforge.net/)可以帮助您。

特别是“不在类路径视图上”

![不在类路径上](https://i.stack.imgur.com/moYzZ.jpg)

> 此视图扫描不在类路径上（但在当前项目下）的 jar。它提供了对可用但不在类路径上的包和类的基本浏览。这在尝试构建类路径时会很有帮助，因为您可以快速浏览缺少的类以查看哪些 jar 包含它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T20:29:03.407

不是 Eclipse 插件，但我相信[ProGuard](http://proguard.sourceforge.net/)的“缩小”功能正是您想要的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-14T08:56:06.877

我写了一个小 eclipse 插件，它从工作区中获取一个现有的[java 项目](http://help.eclipse.org/juno/topic/org.eclipse.jdt.doc.isv/reference/api/org/eclipse/jdt/core/IJavaProject.html)。对于项目原始类路径的每个类路径条目，[它](http://help.eclipse.org/juno/topic/org.eclipse.jdt.doc.isv/reference/api/org/eclipse/jdt/core/IJavaProject.html#getRawClasspath%28%29)会将[其](http://help.eclipse.org/juno/topic/org.eclipse.jdt.doc.isv/reference/api/org/eclipse/jdt/core/IClasspathEntry.html)从[项目](http://help.eclipse.org/juno/topic/org.eclipse.jdt.doc.isv/reference/api/org/eclipse/jdt/core/IJavaProject.html#setRawClasspath%28org.eclipse.jdt.core.IClasspathEntry%5B%5D,%20org.eclipse.core.runtime.IProgressMonitor%29)原始类路径中删除并[构建项目](http://help.eclipse.org/juno/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/core/resources/IProject.html#build%28int,%20org.eclipse.core.runtime.IProgressMonitor%29)。如果[项目上没有出现](http://help.eclipse.org/juno/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/core/resources/IResource.html#findMarkers%28java.lang.String,%20boolean,%20int%29)严重错误的[问题](http://help.eclipse.org/juno/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/core/resources/IMarker.html#PROBLEM)[标记](http://help.eclipse.org/juno/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/core/resources/IMarker.html)，它会从项目原始类路径中永久删除类路径条目。

我无法共享该插件，但是通过上面给出的 api 链接自己实现它并不是太多工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-01T23:23:20.490

您也无法判断您不导入的 JAR 是否是依赖项的必需依赖项。例如，如果您使用 Spring，它会带有自己的依赖项，即使您没有在代码中导入或调用这些类。我不知道 ProGuard - 它会检查这些情况吗？

# php - 正则表达式：如何删除除另一个正则表达式之外的所有内容？

> ID：707195
> 
> 赞同：0
> 
> 时间：2009-04-01T20:24:08.550
> 
> 标签：php, regex

我有一些正则表达式（如 ^\w+[\w-.] *\@\w+((-\w+)|(\w* )).[az]{2,3}$, 以匹配正确的电子邮件），但我无法弄清楚如何删除与我的字符串中的正则表达式不匹配的所有内容。

保留电子邮件示例，我需要一种方法，例如

```
$myString = "This is some text, the email is here example@example.com, and other things over here"; 
```

如果字符串中没有电子邮件，我只需要返回“example@example.com”或布尔值 false。

当然，电子邮件只是一个示例，有时我需要删除除整数/浮点数等之外的所有内容......

我用谷歌搜索了很多，但没有找到任何东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T20:30:17.193

如果您将正则表达式括在括号中并使用[`preg_match`](http://www.php.net/preg_match)or[`preg_match_all`](http://www.php.net/preg_match_all)它只会返回与正则表达式匹配的字符串部分：

```
$myString = "This is some text, the email is here example@example.com, and other things over here";
preg_match("/(\w+[\w-.]\@\w+((-\w+)|(\w)).[a-z]{2,3})/", $myString, $matches);
print_r($matches); 
```

请注意，我还取消了字符串分隔符的开头和结尾，因为在这种情况下不需要它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T20:30:24.603

使用该[`preg_match_all`函数](http://docs.php.net/preg_match_all)匹配所有匹配项。如果发生错误，`preg_match_all`函数本身会返回匹配数或*false 。*

所以：

```
$myString = "This is some text, the email is here example@example.com, and other things over here";
if (($num = preg_match_all('/\w+[\w-.]\@\w+((-\w+)|(\w)).[a-z]{2,3}/', $myString, $matches)) !== false) {
    echo $num.' matches have been found.';
    var_dump($matches);
} else {
    // error
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-21T06:16:04.567

您的正则表达式需要删除 $ 和 ^ 才能工作，在字符串中间找不到这些符号。如果您的正则表达式匹配，则它不可能包含除电子邮件之外的任何其他内容。

# sql-server - SQL Server 2005 数据库如何丢失几天的数据？

> ID：707197
> 
> 赞同：1
> 
> 时间：2009-04-01T20:25:20.700
> 
> 标签：sql-server, database, sql-server-2005, transactions, backup

我真的需要一些帮助。

我是丢失三天数据的 SQL Server 数据库应用程序的所有者！我不明白如何或为什么。

所以这里是设置。

*   Windows 2000 服务器上的 SQL Server 2005 32 位标准版数据库。（数据库 B）

*   数据库处于简单恢复模式

*   该数据库使用 SQL Server 连续合并复制作为订阅者连接到另一个数据库（Win2k3 企业上的 SQL Server 2005 64 位企业版）。（数据库 A）

作为计划重新启动的一部分，DatabaseB 在晚上 X 重新启动。数据库恢复后，它正常使用了几天，数据被创建到其中非常好。

但是昨天第 X + 4 天它丢失了很多数据。

数据库 B 位于具有另一个 SQL Server 实例的服务器上，并且它们都开始耗尽内存（彼此冲突）。

这是我认为发生这种情况时事件日志中的事件序列。

```
AppDomain 2 (DatabaseB.dbo[runtime].1) is marked for unload due to memory pressure. 

AppDomain 2 (DatabaseB.dbo[runtime].1) unloaded. 

BACKUP LOG WITH TRUNCATE_ONLY or WITH NO_LOG is deprecated. 
The simple recovery model should be used to automatically truncate the transaction log. (on DatabaseB)

AppDomain 3 (DatabaseB.dbo[runtime].2) created. 
```

我知道数据丢失是因为我的审计日志，并且用户在删除之前截取了一些数据的屏幕截图。

所以这是我的困境......这怎么可能发生？

DatabaseB怎么会丢失几天的数据？（随后发布数据库中也缺少它！）

Appdomain 关闭的截断是否导致数据从日志中刷新？

任何和所有的理论考虑。如果有人需要更多数据，我可以添加它。

帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T14:35:07.243

这不是您想听到的答案，但简而言之，SQL Server 不会“丢失”数据。有人删了。如果您的数据库处于完全恢复模式，您可以使用 Quest LiteSpeed 之类的产品来读取日志并准确识别它是如何被删除的，但是在简单模式下……对不起，先生，但您不走运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T12:49:08.260

合并复制是通过触发器实现的，因此不需要完全恢复。是否有人禁用了数据库中的所有触发器？它很容易做到 DISABLE TRIGGER [database] 这至少会导致订阅者丢失数据。

日志中的那些 appdomain 行意义不大，它是 SQL CLR 告诉您它卸载程序集以释放一些内存。然后稍后重新加载它们。

截断日志会删除已提交到磁盘的非活动部分，将恢复模式设置为简单意味着截断日志没有意义，如消息所示。

这些都不能解释为什么两台服务器上的数据都丢失了。一定有其他原因导致了这种情况。

在这 4 天里，一切都“完美无缺”，你如何验证它实际上是什么？你有这些天的备份吗？你能看到那些日子带有时间戳的记录吗？

机器中是否有可能在不告诉您的情况下进行了还原？

# algorithm - 如何对 32 位数字进行排序以查找唯一条目？

> ID：707199
> 
> 赞同：0
> 
> 时间：2009-04-01T20:25:28.563
> 
> 标签：algorithm, string, unique, prefix

有一个“文件”数据集 - 文件名，后面是 32 位数字 - 类似于文件的哈希值。

```
"file1" 6a9bd9a6 1df3b24b 7ab054dc
"file2" 6a9bd54e 1df3b24b 8cd054dc
"file3" 6a9bd9a6 7ab054dc 
```

我将如何获得唯一文件，因此 s2 不是任何其他 s2 的前缀 - 这意味着该数字是唯一的。如果有两个相同的 s2，如果它们不是任何其他 s2 的前缀，它们都是唯一的。

我正在寻找一个快速的解决方案。我可以想出解决方案来比较每个字符串，但这太耗时且无效。另一种选择是以某种方式将 MySQL 引擎用于表，但我不确定如何。你能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T20:31:00.593

您可以使用[trie](http://en.wikipedia.org/wiki/Trie)来确保没有字符串是任何其他字符串的前缀。

当你插入你的 trie 时，你会检查这两种情况：

1）我是否通过了旧的叶节点？如果是这样，这意味着另一个字符串是我的字符串的前缀。
2）我想将已经存在的非叶子标记为叶子吗？如果是这样，我是另一个字符串的前缀。

这将是一个 O(N) 解决方案，其中 N 是字符串的数量（测量插入到 trie 中的数量）。每个插入运行其字符串的长度。

所以如果你想从这里创建哈希。您可以轻松地遍历特里树，然后在到达所需的叶子后使用有关是否有前缀节点的信息。每个叶子节点代表一个完整的路径，它知道它是否是另一个字符串的前缀。如果是前缀，那么它至少有 1 个子节点。

# sql-server - 失去成为 SQL Server Reporting Services 2005 管理员的能力

> ID：707219
> 
> 赞同：1
> 
> 时间：2009-04-01T20:32:12.273
> 
> 标签：sql-server, reporting-services, reportingservices-2005

我曾经能够访问，`http://myserver/reports`并且在我提供了本地帐户信息（它是“管理员”的成员）之后，我将获得 SQL Server Reporting Services 的“主页”页面以及“站点设置”链接右上。

现在，当我登录时，它消失了，我似乎只是一个“普通用户”，因为“站点设置”菜单不再存在。“属性”选项卡和“新数据源”、“上传文件”等都不是...

我怎样才能恢复该功能？我在哪里看？在 ReportServer 数据库中？报告管理器.config？网络配置？

我的本地帐户已经是本地“管理员”的一部分，所以我认为我应该获得完整的菜单，但我没有。

是否有另一个后门“管理员”帐户可以让我登录，然后让我的第一个管理员帐户备份并运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-14T09:39:47.223

在 Reporting Services 配置管理器的报表服务器虚拟目录设置中勾选“应用默认设置”后，我的问题解决了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T07:51:17.737

我猜有人从“系统管理员”（站点设置...配置站点范围的安全性）中取出了本地管理员组。

您可能能够破解 ReportServer 数据库：

在 ReportServer 数据库中：

*   在用户表中应该有“BUILTIN\Administrators”
*   在 Roles 表中应该有“System Administrator”，TaskMask = 110101011
*   在 PolicyUserRole 表中，应该有一行包含来自上述用户和角色的 GUID。策略 ID = EBFA3A83-8497-4A39-9B5C-62E0240D2924

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-02T12:54:49.073

您需要在与“管理员”组不同的“报告服务器管理员”安全组中

# asp.net - ASP.Net ReportViewer 导致 Firefox 闪烁

> ID：707223
> 
> 赞同：0
> 
> 时间：2009-04-01T20:33:17.060
> 
> 标签：asp.net, firefox, reportviewer

在 ReportViewer 生成的 HTML 中有以下代码行（我尝试通过删除多余的信息使其更具可读性）

```
setTimeout("frames['ReportViewer1TouchSession0'].location.replace('/Reserved.ReportViewerWebControl.axd?...&TimerMethod=KeepAliveMethodReportViewer1TouchSession0...", 0);

function KeepAliveMethodReportViewer1TouchSession0() {   
setTimeout("frames['ReportViewer1TouchSession0'].location.replace('/Reserved.ReportViewerWebControl.axd?...TimerMethod=KeepAliveMethodReportViewer1TouchSession0....", -1703027296);
} 
```

当调用 Reserved.ReportViewerWebControl.axd 时，它会发出一个返回以下 HTML 的 GET 请求：

```
<html><body><script type="text/javascript">parent.KeepAliveMethodReportViewer1TouchSession0();</script 
```

所以实际上它变成了一个递归函数，并且因为 KeepAliveMethodReportViewer1TouchSession0 调用了一个带有负超时值的设置超时，在 Firefox 中它被立即调用，在大约 10 秒内 Firebug 在一分钟内记录了超过 150 个 GET 请求，记录了超过 700 个请求。这会导致 Firefox 的停止按钮和光标疯狂地闪烁。

如果有人知道如何调整keepalive请求的超时时间，那么我将非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-08-19T04:41:36.040

I know this thread is couple of years old, but I had a similar problem today and found a solution here:

[http://www.google.com/support/forum/p/Chrome/thread?tid=331a0a766d6da660&hl=en](http://www.google.com/support/forum/p/Chrome/thread?tid=331a0a766d6da660&hl=en)

It's a bit of a hack that creates a custom control inheriting from `ReportViewer` which replaces the offending JavaScript by overriding the `Render()` method.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-25T14:03:18.047

我有类似的问题，当我将会话超时设置为 10000 左右时，它在 Firefox 和 chrome 上停止闪烁。我不知道为什么，但它解决了这个问题。我是 ASP.Net 社区的新手，所以我想知道减少会话超时（以前我将其保持在 120000）和当应用程序在 IIS 上时报告查看器在 Firefox 上闪烁之间的关系（开发服务器没有问题）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T21:44:27.737

不确定...但值得注意的是，此控件通过 TimerMethod 参数暴露了跨站点脚本漏洞。关于这个问题的文档不多，但要小心。:)

# java - 用于 Web 服务的 XML：内联附件

> ID：707237
> 
> 赞同：2
> 
> 时间：2009-04-01T20:37:27.550
> 
> 标签：java, web-services, xslt, base64, attachment

我必须使用单个参数（XML 格式的字符串）调用 Web 服务。我正在通过 XSLT 转换来构建它。到现在为止还挺好。

问题在于这个 XSD 片段：

```
<xs:complexType name="Document">
    <xs:sequence>
        <xs:element name="title" type="xs:string" minOccurs="1"/>
        <xs:element name="content" type="xs:base64Binary" minOccurs="1"/>
    </xs:sequence>
</xs:complexType> 
```

它将（例如）翻译成这个 XML：

```
<attachment>
    <title>test title</title>
    <content>          
    PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Inllc
    yI/Pg0KPG1zZ3ByYXRpY2E+DQogICAgPHByYXRpY2E+DQogICAgICAgIDxwcm9jZXNzbz
    4NCiAgICAgICAgICAgIDxjb2RQcm9jZXNzbz4xPC9jb2RQcm9jZXNzbz4NCiAgICAgICA
    gICAgIDxjb2RJc3RhbnphUHJvY2Vzc28MzwvY29kSXN0YW56YVByb2Nlc3NvPg0KICAgI
    CAgICAgICAgPGNvZFN0YXRvPjYwPC9jb2RTdGF0bz4NCiAgICAgICAgPC9wcm9jZXNzbz
    4NCiAgICA8L3ByYXRpY2E+DQo8L21zZ3ByYXRpY2E+
    </content>
</attachment> 
```

是的，你没看错：我必须以 base 64 二进制格式将文件内容插入 XML 文档。

我想过用 XSLT 插入一个占位符，然后处理 XML 文档以将其替换为实际的文件内容，但我想知道这些场合是否有任何最佳实践，也许是一些超出我知识的花哨 XSTL 技巧或一些 Java可能派上用场的工具。

你会怎么做？

**注意**：我不能使用*带有附件的 SOAP*，而且我很清楚上述方法在附件很大的情况下容易失败，但目前我们的对手不会让步。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T22:38:03.830

**执行此操作的最佳方法可能是读取文件并通过实例化 XSLT 转换的代码以 base64 对其内容进行编码**。base64 字符串可以作为参数传递给转换，或者转换可以通过扩展方法请求它。

*原则上 XSLT 可用于对 base64 进行编码*，但是某些字节值，例如 0（对于 XML 1.0 和 XML 1.1）和 0x20 以下的 29 个其他代码（对于 XML 1.0）被禁止作为 XML 文档中的字符，并且这使得在 XSLT 中进行这种编码是不可能的。

（见：[http](http://projects.ischool.washington.edu/tabrooks/545/ContentManagement/PassingParameters.htm) ://projects.ischool.washington.edu/tabrooks/545/ContentManagement/PassingParameters.htm ）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T18:45:28.000

如果您的 SOAP 堆栈支持 MTOM，请将其打开。然后要做的就是在内容元素中放置一个“引用”，指向将放置数据的 MIME 附件。该数据可以是完全二进制的，而不是 base64 编码的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T18:22:05.723

这并不完全是您正在寻找的答案，但是像 Woodstox[链接文本](http://woodstox.codehaus.org/)这样的 XML 处理器支持高效读取和写入内联 Base64 编码的内容。在 Woodstox 4.0 中，它使用所谓的 Typed Access API 完成，它是 Stax2 扩展 API 的一部分（在包“org.codehaus.stax2.typed.*”、TypedXMLStreamReader、TypedXMLStreamWriter 下）。

这允许在给定二进制数据的情况下对元素和属性值进行流​​式读/写。

诀窍就是将它与 XSLT 挂钩。另一种可能更简单的方法是确定客户端 API Soap 堆栈（如 CXF aka XFire）是否可以让您通过 XMLStreamReader/Writer 访问内容。大多数新的都基于 Stax，通常嵌入 Woodstox。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-27T18:44:41.287

以下是我将如何在 Java 中的 base64Binary 对象（使用 MTOM 或 SwAref）上发送数据，至少用于测试目的（如硬编码数据路径所述）。

```
obj.setContent(
  新数据处理程序（
    新的 URL 数据源（
      this.getClass().getResource("/someDocument.png")
    ));
```

虽然正常的操作是使用 FileDataSource 来传递数据。虽然我很确定有人会想到创建自己的数据源。一般来说，我认为这不是一个好主意，因为最有可能的实现是使用 ByteArrayInputStream，它使用 VM 内存，如果你发送一个大文件，它会严重崩溃。

如果您需要传递一个简单的字符串以进行测试，您可以执行以下操作：

```
obj.setContent(
  new DataHandler("test string", "text/plain");
```

此外，如果您使用的是 WebSphere 7 运行时，`@MTOM`如果您注意到正在发送的数据仅包含消息，而没有附件，则可能需要在服务实现中使用注释。

# python - 创建一个不需要 pythonXX.dll 的独立 windows exe

> ID：707242
> 
> 赞同：16
> 
> 时间：2009-04-01T20:38:16.910
> 
> 标签：python, windows, py2exe

有没有办法从 python 脚本创建一个独立的 .exe。使用 py2exe 生成的可执行文件只能使用 pythonXX.dll 运行。我想获得一个完全独立的 .exe，它不需要安装 python 运行时库。它看起来像一个链接问题，但使用静态库而不是动态库，并且应用条带以删除未使用的符号也很有用。

任何的想法 ？

谢谢。

亚历山德罗

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-01T20:48:40.567

您可以在最新版本的 py2exe 中执行此操作...
只需在文件中添加类似于以下代码的`setup.py`内容（关键部分是 'bundle_files': 1）。

要在安装中包含您的 TkInter 包，请使用“包含”键。

```
distutils.core.setup(
      windows=[
            {'script': 'yourmodule.py',
             'icon_resources': [(1, 'moduleicon.ico')]
            }
      ],
      zipfile=None,
      options={'py2exe':{
                         'includes': ['tkinter'],
                         'bundle_files': 1
                        }
      }
  ) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-01T20:56:55.663

由于 Windows 的动态链接器的工作方式，如果您使用 .pyd 或 .dll Python 模块，您将无法使用静态库；Windows 中加载的 DLL 不会自动与可执行文件共享其符号空间，因此需要一个包含 Python 符号的单独 DLL。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-02T09:43:20.843

如果您拥有单个可执行文件的目的是简化下载/发送电子邮件等，我已经通过使用[Inno Setup](http://www.jrsoftware.org/isinfo.php)捆绑 py2exe 输出解决了这个问题。这实际上比拥有单个可执行文件要好，因为与其提供可以拖放到某个目录中的可执行文件，一个表现良好的 Windows 应用程序将提供一个卸载程序，显示在“添加/删除程序”小程序等中。Inno 处理所有这是给你的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-02T03:55:42.880

另一种解决方案是使用 python 创建一个 exe，并在其中安装所有依赖项，包括 python.dll。包装器中有一点魔力，但它确实有效。详情在这里：

[http://code.google.com/p/pylunch/downloads/detail?name=PyLunch-0.2.pdf](http://code.google.com/p/pylunch/downloads/detail?name=PyLunch-0.2.pdf)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-01T20:44:20.640

这不是最好的方法，但您可以考虑使用包含 .exe 和 .dll 文件的可执行 SFX 存档，并将其设置为在双击时执行您的 .exe 文件。

# sql-server - Sql 2008“未授予公共服务器权限”策略

> ID：707244
> 
> 赞同：0
> 
> 时间：2009-04-01T20:38:19.747
> 
> 标签：sql-server, policy

我最近开始研究 SQL Server 2008 中的新策略管理，当我检查是否符合“公共未授予服务器权限”策略时，我的服务器未通过检查。原因是，我很确定这是默认设置，public 具有 TCP Endpoint 权限，以便用户可以连接到服务器。如果我要删除它，我将不得不单独为用户分配连接权。

这对我来说似乎很愚蠢。我不明白为什么微软会建议改变这个。我没有来宾帐户，所以只有指定的用户才能访问服务器。服务器在防火墙后面，甚至公司内只有一个子网可以访问它。有人对此有任何见解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T20:52:21.010

安全最佳实践从锁定一切开始，然后只向真正需要使用它的人开放必要的部分。

通过允许“公众”访问甚至连接，不管他们无权做任何事情的事实，打开门只是一个裂缝。有时，这足以利用缓冲区溢出或其他类型的攻击。

**更新**

登录名和用户是两个不同的东西。登录是服务器级别的，用户是特定于数据库的。每个用户都应该有一个相应的登录名；但不是每个登录都会有一个数据库用户帐户。

假设您正在使用 Active Directory 集成安全性；并且您已经分配了一个特定的 AD 组来访问服务器。现在，只有组内的一些人可能实际上可以访问某些数据库。这些是您希望允许访问连接的人。而该组的其他成员没有常规的数据库用户帐户。

根据定义，这是一个问题，因为一些组成员可以连接并列出服务器上的数据库，即使他们无权访问这些数据库中的任何一个。这就是我所说的门上的“裂缝”。

如果您可以阻止这些人甚至无法连接，那么您在保护您的服务器方面已经走了很长一段路。

Public 角色还授予登录名的其他服务器级别权限。如果可能，您应该像关闭访客帐户一样关闭它。

# windows - 3D 应用程序中鼠标输入的帧率不均匀

> ID：707247
> 
> 赞同：2
> 
> 时间：2009-04-01T20:39:26.983
> 
> 标签：windows, winapi, opengl, mouse

我正在使用 OpenGL 为 Windows 编写一个 3D 应用程序。目前，它使用大约 50000 个多边形的模型渲染一个简单的测试场景，并以 60FPS 的速度平滑渲染。

但是，只要将鼠标移到应用程序窗口上，帧速率就会变得非常不均匀。它从 400 FPS 随机波动到 20 FPS。这有什么原因吗？这是由应用程序被迫处理的鼠标事件引起的吗？我可以禁用它们并只轮询鼠标状态吗？

我的应用程序循环非常简单，或多或少类似于：

```
if (PeekMessage(&msg,NULL,0,0,PM_REMOVE))
{
  if (msg.message==WM_QUIT)
  {
    quit();
  }
  else
  {
    TranslateMessage(&msg);
    DispatchMessage(&msg);
  }
}
else
{
  draw();
  Sleep(1);
} 
```

窗口程序基本上是

```
return DefWindowProc(hWnd,uMsg,wParam,lParam); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T21:06:47.840

除了鼠标移动消息之外，在窗口上移动还会生成 WM_SETCURSOR 消息。您可以尝试丢弃这些消息和 WM_MOUSEMOVE 消息以查看应用程序是否加速。要丢弃，请返回 1 而不是调用 DefWindowProc。

没有办法关闭鼠标消息，但扔掉它们应该很快。您可以使用[GetCursorPos](http://msdn.microsoft.com/en-us/library/ms648390.aspx)轮询鼠标坐标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T21:01:04.123

听起来像是线程问题。使用像[glut](http://www.xmission.com/~nate/glut.html)这样的库来为你处理 opengl 主循环怎么样？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T23:15:40.393

有点摸不着头脑，但是 WM_PAINT 消息会触发您的应用重绘吗？如果那是您进行渲染的地方，那么听起来鼠标正在生成 InvalidateRects 并强制窗口更新。

一般来说，我根本不让 Windows 轮询鼠标，但应用程序本身会根据需要进行轮询。

# iphone - 是 applicationDidFinishLaunching 为 UIImageView 设置图像的错误位置吗？

> ID：707249
> 
> 赞同：0
> 
> 时间：2009-04-01T20:39:46.080
> 
> 标签：iphone

我发现了这个：

applicationDidFinishLaunching（UIApplicationDelegate 协议的委托方法）似乎在我的 nib 文件中的视图完全加载之前被调用。所以我一整天都在尝试在我的应用程序在 iPhone 模拟器中启动后立即更改 UIImageView 的图像，但什么也没发生。

然后我写了一个小动作方法，按下一个按钮就可以调用它。然后它发生了：工作！

所以 applicationDidFinishLaunching 委托方法并不是真正适合在应用程序真正“准备好”之后必须完成的事情的地方。我想有更好的东西可以等待笔尖完全加载。但是哪里？什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-01T20:56:42.387

> 我想有更好的东西可以等待笔尖完全加载。但是哪里？什么？

对于应用程序特定的东西，如全局设置、首选项等，`-appDidFinishLaunching`是正确的地方。

对于 UIView 特定的东西，您通常使用`-viewDidLoad`UIVIewController 子类中的方法。它几乎是您保证加载 nib 文件、初始化 IBOutlets 并附加 IBAction 的唯一地方。

这与 Mac OS X 世界不同，在哪里`-awakeFromNib`可以做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T20:49:44.447

嘿，直到你的视图和他们的视图控制器实例化你不能修改他们的用户界面。但是，为了解决您的问题，您始终可以将 uiimageview 声明为应用程序委托类的属性，并在 appDidFinishLaunching 事件中对其进行初始化。但这是最糟糕的做法。与内存有限的 iPhone 一样，总是延迟加载，即：仅在 UI 实际需要对象时和之前初始化对象。因此，理想情况下，您应该在要使用此 UIImageView 的视图的 viewDidLoad 事件中执行此操作。

applicationDidFinishLaunching 通常用于数据库文件检查、打开数据库连接、填充全局变量、任何其他应用程序范围的逻辑、检查可用的 Internet 连接等

# css - 在 CSS 中，让徽标位于中央布局上方并突出到左侧？

> ID：707251
> 
> 赞同：0
> 
> 时间：2009-04-01T20:40:35.857
> 
> 标签：css, layout, internet-explorer-6, margins

我真的被困在这里了...

我有一个带有中央布局的站点布局（大约 922 像素宽度，位于页面中心）...我有一个位于左上角的小徽标，但它在中央设计左侧约 10 像素处. 如果你能想象，它有点突出在设计的左侧......

现在，有人告诉我绝对定位可以实现这一点。但是，如果设计本身位于页面中心，我看不出徽标将如何与绝对定位一起使用。我认为这是为了确保它在 IE6 中工作...我尝试将徽标浮动在中央标题中，然后应用负边距`margin-left: -10px;`确实有效，但我读过这在 IE6 中不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T20:43:17.600

在容器 div 上设置“位置：相对”。

```
<style type="text/css">
    div.page {
        position: relative;
        margin: 0 auto;
        width: 922px;
    }
    div.page img.logo {
        position: absolute;
        left: -10px; top: 0;
    }
</style>

<div class="page">
    <img class="logo" ... />
</div> 
```

虽然..我宁愿让它在没有绝对定位的情况下工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T20:48:55.620

没有一段代码很难说，但这可能是你的元素从哪里获得它的“绝对”定位的问题。“绝对”是用词不当。它的真正意思是“绝对......相对于最近的定位父母”。因此，如果在您的设计中，您没有带有 css“位置”样式的父元素，它将从 body 元素中获取其位置（根据您的浏览器，它可能有一些边距/填充）。

添加位置：相对；到您想成为“最外层”容器的元素将允许您在其中的项目上指定位置：绝对，并从那里指定您的确切坐标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T23:50:49.037

当您绝对定位您的标志时，它需要相对于*某物*放置。那东西通常是视口边缘。如果徽标位于相对定位的元素内，则它将相对于该元素定位。所以答案是使您的页面居中 div`display:relative;`使徽标始终与页面对齐，而不是与浏览器窗口的边缘对齐。这是一个例子：

的HTML：

```
<div id="centeredpage">
   <img id="logo"... />
</div> 
```

CSS：

```
body {
   text-align:center;
}
#centeredpage {
   width:922px;
   margin:0 auto;
   text-align:left;
   position:relative;
}
#logo {
   position:absolute;
   top:0;
   left:-10px;
} 
```

我希望这会有所帮助。

# jquery - Jeditable 保存后插入“点击编辑”？

> ID：707256
> 
> 赞同：4
> 
> 时间：2009-04-01T20:42:16.073
> 
> 标签：jquery, jeditable

我的代码是：

```
$(document).ready(function() {
            $('.post_title').editable('editposttitle.php', {
                cancel    : 'Cancel',
                        submit    : 'OK',
                indicator : 'Saving...',
            });
        }); 
```

保存文本时，文本“单击以编辑”被插入到我的元素中？而不是保存的文本？

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-01T20:48:09.723

抱歉，发现我哪里出错了！

我没有在我的 php.ini 中回显新值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-28T13:32:36.287

```
<?php echo $_REQUEST["value"]; ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-04T03:26:54.813

对我来说，修复不是将文件作为文件在本地打开，而是通过网络服务器访问它。不知道为什么会这样，但是一旦我将示例文件放在网络服务器上，它就开始工作了。

# ruby - Ruby 可访问的文件管理器

> ID：707257
> 
> 赞同：1
> 
> 时间：2009-04-01T20:42:43.483
> 
> 标签：ruby, file-management

我想使用 Ruby 制作一个定制的文件管理器，但我不想重新发明太多的轮子。是否有可以从 Ruby 访问的具有开放 API 的现有文件管理器？或者，是否有可用的工具包或框架来制作我自己的文件管理器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T22:07:11.813

[文件管理器](http://en.wikipedia.org/wiki/File_Manager)是什么意思？命令行还是基于 GUI？您是否需要它的全功能，或者您只是想做一个文件选择窗口，或类似的东西？

如果你想要一个基于 GUI 的 - 检查你的操作系统。可能有用于操作操作系统的 GUI 文件管理器的钩子。它们可能不会在 Ruby 中原生提供，但很可能它们在 C 中可用。您可以将挂钩包装在 ruby​​ 扩展中，然后执行您想要的操作。

如果您想要类似的命令行 - 请查看 FileUtils。它为您提供了查找目录内容、移动、复制或重命名文件以及几乎任何其他您想做的事情所需的钩子。

# java - 形状为“实际尺寸”

> ID：707264
> 
> 赞同：3
> 
> 时间：2009-04-01T20:44:54.693
> 
> 标签：java

在 Java 中将形状呈现为其“实际大小”的简单方法是什么。例如，我有一个直径为 1" 的管子，我想在屏幕上将其描绘为 1" 圆的轮廓。Graphics2D 方法 drawOval(int x, int y, int width, int height) 采用像素的高度和宽度。将像素大小转换为屏幕上呈现的大小的步骤是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-01T20:53:24.173

GraphicsConfiguration 类的 getNormalizingTransform() 方法看起来有一些潜力

[http://java.sun.com/javase/6/docs/api/java/awt/GraphicsConfiguration.html#getNormalizingTransform()](http://java.sun.com/javase/6/docs/api/java/awt/GraphicsConfiguration.html#getNormalizingTransform())

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T21:06:52.723

`java.awt.Toolkit`它将告诉您像素的大小[以及](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/Toolkit.html#getScreenResolution())屏幕的[像素尺寸。](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/Toolkit.html#getScreenSize())这是基于来自底层系统的信息，然而，这些信息有时可能被错误配置。

所以，要画一个 1" 的圆，你会使用直径`1.0 * tk.getScreenResolution()`，一个 2.5" 的圆是`2.5 * tk.getScreenResolution()`，等等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T21:02:31.873

您应该知道，即使您可能能够找到有关屏幕尺寸和分辨率的信息，您仍然无法确定所显示图片的实际尺寸。如果用户有 CRT 屏幕，那么屏幕可能会比实际屏幕尺寸小一点。

因此，如果你真的需要准确的结果，唯一的办法就是让用户交互式地调整屏幕上显示的标尺，并与实际的标尺进行比较。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T22:30:01.743

理论上你可以这样做。java.awt.Toolkit 将告诉您像素的大小和屏幕的像素尺寸。因此，要绘制一个 1" 的圆，您可以使用 1.0 * tk.getScreenResolution() 的直径，一个 2.5" 的圆是 2.5 * tk.getScreenResolution() 等。或者您可以使用 GraphicsConfiguration.getNormalizingTransform() 方法它将分辨率调整为“固定”大小。

不幸的是，这两种方法都依赖于底层系统知道（并告诉你）你屏幕的实际分辨率。在实践中，这种情况很少发生。各种各样的事情都会影响像素的实际大小。显示器的实际尺寸和品牌是一回事，有些显示器甚至允许您调整屏幕上图像的大小。

这篇文章[http://www.developer.com/java/other/print.php/626071](http://www.developer.com/java/other/print.php/626071)讨论了这一点。

打印机通常更善于告诉你他们的真实分辨率。如果您绝对必须有正确尺寸的图片，请将其发送到那里。

对我综合这个答案的各种答案表示感谢。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T20:49:59.797

您将遇到的问题是像素并不总是相同的大小。例如，一个 100 x 100 像素的正方形在 17" 1280 x 1024 显示器和 19" 1280 x 1024 显示器上会有不同的尺寸。

我不相信有一个 API 可以告诉您显示器的物理尺寸。

询问用户显示器的尺寸可能无济于事，因为很多人根本不知道。

您可以在屏幕上显示多行并让用户单击最接近 1 英寸的行并将所有渲染缩放到该值，但这有点笨拙。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-01T20:54:33.733

好吧，您需要显示器的尺寸和分辨率。假设显示器是 17 英寸，纵横比为 1280:1024。

屏幕尺寸是斜边，因此您需要找到斜边上的像素数。稍后简单几何，您可以得到像素/英寸的计算。

1280px^2 + 1024px^2 = c^2, c ~= 1639.2px。所以对于分辨率为 1280x1024 的 17 英寸显示器，它是 1639.2px/17inch = 96.4px/inch。这必须由用户输入。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-01T23:08:09.513

我的印象是仅仅从 Toolkit 获取屏幕分辨率是不够的。我认为你需要做更多的事情

```
float scalingFactor = Toolkit.getDefaultToolkit().getScreenResolution() / 72f; 
```

制作一个 1 英寸的正方形

```
int width = 1.0 * scalingFactor; 
```

和一个 2.5 英寸的正方形

```
int width = 2.5 * scalingFactor; 
```

所有这一切都是 Java2D 假定屏幕分辨率为 72 dpi，如果系统设置不同，您需要按比例放大以纠正此问题。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-04-01T20:54:22.113

这是一个奇怪的问题，我没有想到。在我的脑海中，您可能需要知道屏幕尺寸（17"、21" 等）、屏幕分辨率（"800x600、1280x1024 等）和屏幕 DPI（72、96、 120 等）。

通过各种 api，您可以确定屏幕分辨率，*也许*还有 dpi ......但是屏幕大小祝你好运。即便如此，您仍然不能保证在屏幕上产生正确的尺寸。

# .net - 有什么好的 .NET 安全编码库吗？

> ID：707266
> 
> 赞同：0
> 
> 时间：2009-04-01T20:45:06.347
> 
> 标签：.net, security, encoding, code-injection

一直在阅读各种注入型攻击，似乎摆脱这些漏洞的最佳方法是对所有用户输入进行编码，以删除/替换某些字符（< > ; 等）。

我在这里最好的选择是什么？有没有很好的图书馆可以帮助我解决这个问题？或者可以帮助我发现潜在漏洞的东西？- 还是正则表达式是我最好的选择？:)

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T20:57:08.003

看看[AntiXSS 库](http://www.codeplex.com/AntiXSS)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T20:49:12.017

`Server`ASP.NET 中的`Page`实例（可通过`Page`ie访问`this`）提供了`HtmlEncode()`一种足以防止 XSS 攻击的方法。

默认情况下`web.config`，ASP.NET 将拒绝任何带有错误页面的可疑输入，而无需在任何一个或通过页面指令明确允许它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T21:48:33.183

[OWASP Antisamy](http://www.owasp.org/index.php/Category:OWASP_AntiSamy_Project_.NET)和[OWASP ESAPI](http://www.owasp.org/index.php/.NET_ESAPI)。

其中，我会投票给 ESAPI，因为我使用了 Java 版本的 ESAPI 来防止 XSS 攻击。请记住，数据的纯 HTML 编码不会阻止 XSS。[数据的上下文也很重要](http://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet)——如果您动态生成它并将其注入服务器的响应中，您将不得不转义 JavaScript。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T22:22:03.757

您有 3 个不错的跨站点脚本保护选择：

我会按这个顺序尝试。

*   [微软反跨站脚本库](http://msdn.microsoft.com/en-us/library/aa973813.aspx)
*   [OWASP 改革](http://www.owasp.org/index.php/Category:OWASP_Encoding_Project)
*   [OWASP ESAPI](http://www.owasp.org/index.php/.NET%5FESAPI)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-30T20:33:08.593

最近我一直在研究 ESAPI.NET，该项目似乎不完整并且可能不活跃——尤其是与 java 包相比。

Anti-XSS 仅涵盖 ESAPI 范围的一个子集，实际上，ESAPI.NET 使用 AntiXSS（尽管不是最新的）进行编码。

任何证明 ESAPI.NET 有用性的评论都会有所帮助。

# php - 如何防止、对抗或补偿返回空集的空/NULL 字段 (MySQL)

> ID：707270
> 
> 赞同：0
> 
> 时间：2009-04-01T20:47:18.790
> 
> 标签：php, mysql

我正在学习 PHP 和 MySQL，以掌握服务器端脚本和个人兴趣/开发的窍门。超越“hello world”的第一个“程序”似乎正在写自己的博客。

这有点超出我的能力，所以我想我会从联系人数据库类型开始。到目前为止一切都很好，但是（总是有但是！）我正在尝试以联系人姓名格式化为 mailto: 链接的形式来格式化演示文稿。

```
$query = mysql_query("
    SELECT CONCAT(fname,', ',sname) AS name, email.address AS email
    FROM contacts, emails 
    WHERE contacts.contactID=email.contactID");

while ($row = mysql_fetch_array($query)) {

 echo "<li><a href=\"mailto" . $row['email'] . "\"> . $row['name'] . "</a></li>";

} 
```

这很好，直到我敢在 Db 中输入一个没有电子邮件地址的联系人，此时明显缺少一个 email.contactID 来等于contacts.contactID。

我意识到我应该能够处理这个问题但是......我想不出怎么办（是的失眠！@.@）。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T20:54:56.340

你想要一个左（又名左外）连接。

```
select concat(c.fname, ' ', c.sname) as name, e.address as email
from contacts c
left join emails e
on (c.contactID = e.contactID) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T20:52:11.510

使用外部联接加入联系人和电子邮件表：

```
SELECT 
      CONCAT(fname,', ',sname) AS name, email.address AS email 
FROM 
    contacts c
    left outer join emails e on (c.contactID = e.contactID) 
```

这将返回所有联系人及其电子邮件地址（如果他们有），否则地址将为空。

# c# - 多处理器和性能

> ID：707314
> 
> 赞同：2
> 
> 时间：2009-04-01T20:58:34.677
> 
> 标签：c#, performance, multithreading, multicore

我在.Net 服务中遇到了一个非常奇怪的问题。

我开发了一个多线程 x64 windows 服务。

我在具有 8 个内核的 x64 服务器上测试了这项服务。表演很棒！

现在我将服务移至生产服务器（x64 - 32 核）。在测试过程中，我发现性能至少是测试服务器的 10 倍。

我已经检查了大量的性能计数器，试图找到导致这种糟糕性能的一些原因，但我找不到一点。

可能是GC问题？你有没有遇到过这样的问题？

先感谢您！亚历山大

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-01T21:03:18.143

这是一个人们通常不知道的常见问题，因为很少有人有使用多 CPU 机器的经验。

基本问题是争吵。

随着 CPU 数量的增加，所有共享数据结构中的争用也会增加。对于低 CPU 计数，争用较低，并且您拥有多个 CPU 的事实可以提高性能。随着 CPU 数量显着增加，争用开始淹没您的性能改进；随着 CPU 数量变大，争用实际上开始*将*性能降低到低于 CPU 数量较少的性能。

您基本上面临着可伸缩性问题的一个方面。

但是我不确定这个问题出在哪里；在您的数据结构或操作系统数据结构中。您可以解决的前者 - 无锁数据结构是一种出色的、高度可扩展的方法。后者很困难，因为它本质上需要避免某些操作系统功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T21:02:22.170

有太多变量无法知道为什么一台机器比另一台机器慢。32 核机器通常更专业，其中 8 核可能只是双 proc 四核机器。是否有虚拟机或其他东西同时运行？通常有这么多内核，IO 带宽成为限制因素（即使 cpu 仍然有足够的带宽）。

首先，您可能应该在代码（或分析或其他）中添加大量计时器，以确定代码的哪一部分占用的时间最多。

性能疑难解答 101：什么是瓶颈（代码在哪里以及什么子系统（内存、磁盘、cpu））

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T21:03:18.020

这里有很多因素：

*   你真的在*使用*核心吗？
*   您的额外线程是否会导致锁定问题更加明显？
*   您是否没有足够的内存来支持您可以处理的所有额外堆栈/数据？
*   您的 IO（磁盘/网络/数据库）堆栈能否跟上吞吐量？

ETC

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T07:50:51.903

你用了多少线程？使用多个线程池线程可能会导致线程饥饿，这会使您的程序变慢。

一些文章： [http :](http://www2.sys-con.com/ITSG/virtualcd/Dotnet/archives/0112/gomez/index.html) [//www2.sys-con.com/ITSG/virtualcd/Dotnet/archives/0112/gomez/index.html http://codesith.blogspot.com/2007/03/thread-starvation-in-共享线程池.html](http://codesith.blogspot.com/2007/03/thread-starvation-in-shared-thread-pool.html)

（在其中搜索线程饥饿）

您可以使用 .net 分析器来找到您的瓶颈，这里有一个很好的免费分析器：http: [//www.eqatec.com/tools/profiler](http://www.eqatec.com/tools/profiler)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T08:13:13.080

我同意布兰克的观点，这可能是某种形式的争论。不幸的是，这可能很难追踪。它可能在您的应用程序代码、框架、操作系统或它们的某种组合中。您的应用程序代码最有可能是罪魁祸首，因为 Microsoft 已经花费了大量精力来使 CLR 和 OS 在 32P 机器上扩展。

争用可能存在于某些热锁中，但也可能是某些处理器缓存线在 CPU 之间来回晃动。

差 10 倍的指标是什么？吞吐量？

你试过用更少的 CPU 启动 32-proc 机器吗？在 boot.ini 或 BCDedit 中使用[/NUMPROC选项。](http://technet.microsoft.com/en-us/sysinternals/bb963892.aspx)

您是否实现了 100% 的 CPU 利用率？你的上下文切换率是多少？这与8P盒子相比如何？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-01T21:02:09.097

可能是内存或磁盘的差异吗？如果存在瓶颈，您将无法获得额外处理能力的价值。如果没有您的应用程序/配置的更多详细信息，则无法真正说出。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-01T21:08:56.930

由于有这么多线程同时运行，您将不得不非常小心地解决线程相互争斗以访问您的数据的问题。阅读[非阻塞同步](http://en.wikipedia.org/wiki/Lock-free_and_wait-free_algorithms)。

# javascript - textRange selection MSIE

> ID：707315
> 
> 赞同：3
> 
> 时间：2009-04-01T20:58:35.160
> 
> 标签：javascript, internet-explorer, selection

I can easily set the selection on 2+ elements programatically in Firefox, But have had no success with IE so I hope anyone here can help me with this.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T22:36:42.210

IE doesn't support multiple concurrent selected TextRanges, whether programmatically or manually selected. You can have a [ControlRange](http://msdn.microsoft.com/en-us/library/ms537447(VS.85).aspx) of multiple selected elements, but not stretches of text.

It's possible for other browsers that embed the Web Browser control to [support multiple text ranges](http://msdn.microsoft.com/en-us/library/ms536396(VS.85).aspx):

> Host applications can provide a multiple selection mechanism and can return a collection of TextRange objects that represents discontinuous selections.

But as of today IE doesn't, and I don't know of any other host application that does. Or indeed of any other browser than Firefox 3 that allows it.

# sql - 备份 SQL SP 和函数的快速方法？

> ID：707328
> 
> 赞同：13
> 
> 时间：2009-04-01T21:02:35.807
> 
> 标签：sql, sql-server, tsql

我的 SQL 服务器数据库中有很长的 SP（存储过程）和函数列表。我可以通过右键单击并将 XXX 脚本更改为来一一保存它们。TSQL 中是否有任何方法可以查询所有 SP 和函数将它们保存到 xxx.sql 文件中？

例如，对于 sp_mySP1，我想将其保存到 sp_mySP1.sql，这是一个文本文件。数据库太大，我想只保存 SP 和函数作为源代码的备份。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-01T21:06:05.517

在管理工作室；找到数据库，右键，任务，生成脚本；

next-next-next 直到您“选择对象类型”。选择“存储过程”和“用户自定义函数”，next，全选；选择一个输出；去！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-01T21:08:37.320

1) 在对象资源管理器中右键单击您的数据库名称

2) 从上下文菜单中选择“任务 > 生成脚本...”

3) 在列表中选择您的数据库，然后单击下一步

4) 在选择脚本选项上单击下一步

5) 在 Object Types 中，勾选 Stored Procedures 和 User-defined functions，点击 Next

6）在Stored Procedures选择界面点击Select All，点击Next

7) 在功能选择屏幕上单击全选，单击下一步

8) 选择“脚本到新查询窗口”并单击完成

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-01T21:53:01.597

这是一个将导出某些类型的数据的过程。

```
if exists ( select * from sysobjects where name = 'ExportData_P' )
    drop proc ExportData_P
go

CREATE PROC dbo.ExportData_P ( 
    @tableName varchar(500),
    @where varchar(5000) = '(1=1)'
)
AS
BEGIN
    SET NOCOUNT ON

    DECLARE @sql varchar(8000)
    DECLARE @fieldList varchar(8000)
    DECLARE @valueList varchar(8000)
    SELECT @fieldList = '', @valueList = ''

    DECLARE @cols TABLE ( column_name nvarchar(250), data_type varchar(250) )
    DECLARE @c nvarchar(250), @data_type varchar(250)

    INSERT INTO @cols 
    select column_name, data_type
    from information_Schema.columns 
    where table_name = @tableName

    WHILE EXISTS ( SELECT TOP 1 * FROM @cols )
    BEGIN
        SELECT TOP 1 @c = column_name, @data_type = data_type FROM @cols

        SELECT 
        @fieldList = @fieldList + @c + ', ',
        @valueList = @valueList + CHAR(13) + 'case when ' + @c + ' is null then ''NULL'' else '''''''' + ' +
            case when @data_type in ('text','ntext','char', 'nvarchar', 'varchar' ) then
                ' REPLACE ( REPLACE ( REPLACE ( '
                else ''
            end +
            'IsNull ( convert(varchar' + 
            ( -- change this section to pass the length of varchar to convert
                case when @data_type in ( 'uniqueidentifier' ) then '(50)'
                    when @data_type in ( 'text', 'ntext' ) then '(8000)'
                else '' end
            ) +
            ', ' +
            @c + 
            '), '''' )' + -- end is null
            case when @data_type in ('text','ntext','char', 'nvarchar', 'varchar' ) then
                ', CHAR(39), CHAR(39)+CHAR(39) ), CHAR(13), '''' + CHAR(13) + ''''), CHAR(9), '''' + CHAR(9) + '''') '
                else ''
            end +
            ' + '''''''' end + '', '' + '

        DELETE FROM @cols WHERE column_name = @c
    END

    SELECT @fieldList = LEFT ( @fieldList, LEN(@fieldList)-1 ),
        @valueList = LEFT ( @valueList, LEN(@valueList)-1 )

    SELECT @sql = 'select ''insert into ' + @tableName + ' (' + @fieldList + ') ' +
        ' VALUES ( ''+ ' + left ( @valueList, len(@valueList)-5) + ''') '' from ' + @tableName +
        ' WHERE ' + @where

    -- into [#mcoe_temp_export' + @tableName + ']   
    print @sql
    EXEC ( @sql )
    --EXEC ( 'select * from [#mcoe_temp_export' + @tableName + ']' )        

    SET NOCOUNT OFF
END

go 
```

像这样使用：

```
exec ExportData_P 'tablename' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T21:08:01.783

您可以查询 syscomments 以获取您的 sql 对象创建文本，但我不知道如何仅使用 TSQL 将它们全部保存在单独的文件中。

```
select * from syscomments 
```

# c++ - 根据消息长度打印自定义数量的标头分隔符

> ID：707332
> 
> 赞同：1
> 
> 时间：2009-04-01T21:03:27.597
> 
> 标签：c++, stl

说我要打印：

```
============
Some message
============ 
```

和：

```
=======================
Other Message long one
======================= 
```

“=”的数量根据消息长度而变化。打印这类东西最有效的方法是什么？

没有提升，请只是 STL。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-01T21:06:19.993

```
std::string line(msg.length(), '=');
cout << line << "\n" << msg << "\n" << line << endl; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T21:09:13.917

在这种情况下，您没有指定如何衡量“效率”。这是一种在您必须编写的代码和分配数量方面有效的解决方案：

```
#include <string>
#include <iostream>

using namespace std;

void format(const std::string& msg)
{
    std::string banner(msg.length(), '=');
    cout << banner << endl
         << msg    << endl
         << banner << endl;
}

int main(int argc, char *argv[])
{
    format("Some message");
    format("Other message long one");
    return 0;
} 
```

我可以想象其他避免为横幅分配临时字符串的替代方案，但这些替代方案可能会增加实际打印的成本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T21:27:24.840

iomanip 变体，只是为了好玩。

```
const std::string hello("hello world!");
std::cout << std::setfill('=') << std::setw( hello.length() + 1) << "\n"
          << hello << "\n";
          << std::setfill('=') << std::setw( hello.length() + 1 ) << "\n"; 
```

# sql - T-SQL 强制转换与转换

> ID：707335
> 
> 赞同：357
> 
> 时间：2009-04-01T21:05:48.217
> 
> 标签：sql, sql-server, database, tsql

关于何时应该使用`CAST`vs的一般指导是什么`CONVERT`？是否存在与选择一个与另一个相关的性能问题？更接近 ANSI-SQL 吗？

* * *

## 回答 #1

> 赞同：370
> 
> 时间：2009-04-01T21:39:02.037

`CONVERT`是特定于 SQL Server 的，`CAST`是 ANSI。

`CONVERT`更灵活，您可以格式化日期等。除此之外，它们几乎相同。如果您不关心扩展功能，请使用`CAST`.

编辑：

正如@beruic 和@CF 在下面的评论中所指出的，使用隐式转换（即您既不使用CAST 也不使用CONVERT）时可能会丢失精度。有关详细信息，请参阅[CAST 和 CONVERT](http://msdn.microsoft.com/en-us/library/ms187928.aspx)，尤其是此图：[SQL Server 数据类型转换图表](http://www.microsoft.com/en-us/download/confirmation.aspx?id=35834)。有了这些额外的信息，最初的建议仍然保持不变。尽可能使用 CAST。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-04-01T21:22:49.983

Convert 有一个用于日期到字符串转换的样式参数。

[http://msdn.microsoft.com/en-us/library/ms187928.aspx](http://msdn.microsoft.com/en-us/library/ms187928.aspx)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2018-06-13T16:19:56.410

为了扩展[[Shakti 复制](https://stackoverflow.com/a/50624016/2799848)][的上述答案](https://www.essentialsql.com/what-is-the-difference-between-cast-and-convert/)，我实际上已经能够测量这两个函数之间的性能差异。

[我正在测试这个问题](https://stackoverflow.com/questions/9077263)的解决方案变体的性能，发现使用`CAST`.

[![以毫秒为单位的运行时间](https://i.stack.imgur.com/fQ38r.png)](https://i.stack.imgur.com/fQ38r.png) [[*以毫秒为单位的时间，根据类型的](https://docs.microsoft.com/en-us/sql/t-sql/data-types/datetime-transact-sql?view=sql-server-2017#rounding-of-datetime-fractional-second-precision)[精度](https://docs.microsoft.com/en-us/sql/t-sql/data-types/datetime-transact-sql?view=sql-server-2017#rounding-of-datetime-fractional-second-precision)四舍五入到最接近的 1/300 秒[`DateTime`](https://docs.microsoft.com/en-us/sql/t-sql/data-types/datetime-transact-sql?view=sql-server-2017#rounding-of-datetime-fractional-second-precision)]

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2014-03-27T15:37:21.897

CAST 是标准 SQL，但 CONVERT 仅适用于方言 T-SQL。在日期时间的情况下，我们对转换有一点优势。

使用 CAST，您可以指明表达式和目标类型；使用 CONVERT，有第三个参数表示转换的样式，它支持某些转换，例如字符串与日期和时间值之间的转换。例如，CONVERT(DATE, '1/2/2012', 101) 使用代表美国标准的样式 101 将文字字符串转换为 DATE。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2018-02-22T23:04:41.440

似乎没有人注意到的东西是可读性。有……</p>

```
CONVERT(SomeType,
    SomeReallyLongExpression
    + ThatMayEvenSpan
    + MultipleLines
    ) 
```

…可能比…更容易理解</p>

```
CAST(SomeReallyLongExpression
    + ThatMayEvenSpan
    + MultipleLines
    AS SomeType
    ) 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-12-01T04:26:00.963

CAST 使用 ANSI 标准。在可移植性的情况下，这将适用于其他平台。CONVERT 特定于 sql server。但是功能很强大。您可以为日期指定不同的样式

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-09-08T15:57:17.073

您也不应该`CAST`用于获取哈希算法的文本。`CAST(HASHBYTES('...') AS VARCHAR(32))`不一样`CONVERT(VARCHAR(32), HASHBYTES('...'), 2)`。如果没有最后一个参数，结果将是相同的，但不是可读的文本。据我所知，您不能在`CAST`.

# c# - using 子句会关闭此流吗？

> ID：707336
> 
> 赞同：33
> 
> 时间：2009-04-01T21:05:48.277
> 
> 标签：c#, filestream, dispose, streamreader

我显然已经养成了一个不好的编码习惯。这是我一直在编写的代码示例：

```
using(StreamReader sr = new StreamReader(File.Open("somefile.txt", FileMode.Open)))
{
    //read file
}
File.Move("somefile.txt", "somefile.bak"); //can't move, get exception that I the file is open 
```

我认为这是因为该`using`子句明确调用`Close()`and `Dispose()`on the`StreamReader`也`FileStream`将被关闭。

我可以解决我遇到的问题的唯一方法是将上面的块更改为：

```
using(FileStream fs = File.Open("somefile.txt", FileMode.Open))
{
  using(StreamReader sr = new StreamReader(fs))
  {
    //read file
  }
}

File.Move("somefile.txt", "somefile.bak"); // can move file with no errors 
```

是否应该`StreamReader`通过在第一个区块中的处置来关闭底层证券`FileStream`？或者，我弄错了吗？

## 编辑

我决定发布实际有问题的代码块，看看我们是否能找到这个问题的根源。我现在只是好奇。

我以为我的`using`子句有问题，所以我将所有内容都扩展出来，但每次都无法复制。我在这个方法调用中创建了文件，所以我认为没有其他任何东西在文件上打开了句柄。我还验证了`Path.Combine`调用返回的字符串是否正确。

```
private static void GenerateFiles(List<Credit> credits)
{
    Account i;
    string creditFile = Path.Combine(Settings.CreditLocalPath, DateTime.Now.ToString("MMddyy-hhmmss") + ".credits");

    StreamWriter creditsFile = new StreamWriter(File.Open(creditFile, FileMode.Create));

    creditsFile.WriteLine("code\inc");

    foreach (Credit c in credits)
    {
        if (DataAccessLayer.AccountExists(i))
        {
            string tpsAuth = DataAccessLayer.GetAuthCode(i.Pin);
            creditsFile.WriteLine(String.Format("{0}{1}\t{2:0.00}", i.AuthCode, i.Pin, c.CreditAmount));
        }
        else
        {
            c.Error = true;
            c.ErrorMessage = "NO ACCOUNT";
        }

        DataAccessLayer.AddCredit(c);

    }

    creditsFile.Close();
    creditsFile.Dispose();

    string dest =  Path.Combine(Settings.CreditArchivePath, Path.GetFileName(creditFile));
    File.Move(creditFile,dest);
    //File.Delete(errorFile);
} 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-04-01T21:06:42.770

是的，`StreamReader.Dispose`关闭底层流（对于创建一个的所有公共方式）。但是，还有一个更好的选择：

```
using (TextReader reader = File.OpenText("file.txt"))
{
} 
```

这有一个额外的好处，它会打开底层流，并提示 Windows 您将按顺序访问它。

这是一个测试应用程序，它显示了第一个适用于我的版本。我并不是要说这是任何特别的证据——但我很想知道它对你的效果如何。

```
using System;
using System.IO;

class Program
{
    public static void Main(string[] args)
    {
        for (int i=0; i < 1000; i++)
        {
            using(StreamReader sr = new StreamReader
                  (File.Open("somefile.txt", FileMode.Open)))
            {
                Console.WriteLine(sr.ReadLine());
            }
            File.Move("somefile.txt", "somefile.bak");
            File.Move("somefile.bak", "somefile.txt");
        }
    }
} 
```

如果这有效，则表明这与您在阅读时所做的事情有关...

现在这里是您编辑的问题代码的缩短版本 - 即使在网络共享上，它对我来说也很好用。请注意，我已更改`FileMode.Create`为`FileMode.CreateNew`- 否则*可能*仍有一个应用程序可以处理旧文件。这对你有用吗？

```
using System;
using System.IO;

public class Test
{    
    static void Main()
    {
        StreamWriter creditsFile = new StreamWriter(File.Open("test.txt", 
                                          FileMode.CreateNew));

        creditsFile.WriteLine("code\\inc");

        creditsFile.Close();
        creditsFile.Dispose();

        File.Move("test.txt", "test2.txt");
    }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-01T21:40:11.970

注意 - 您的 using 块不需要嵌套在它们自己的块中 - 它们可以是顺序的，如：

```
using(FileStream fs = File.Open("somefile.txt", FileMode.Open))
using(StreamReader sr = new StreamReader(fs))
{
    //read file
} 
```

这种情况下的处理顺序仍然与嵌套块相同（即，在这种情况下，StreamReader 仍将在 FileStream 之前进行处理）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T21:53:35.043

我会尝试使用`FileInfo.Open()`and`FileInfo.MoveTo()`而不是`File.Open()`and `File.Move(`)。您也可以尝试使用`FileInfo.OpenText()`. 但这些只是建议。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T21:41:29.830

有没有可能其他东西锁定了 somefile.txt？

从本地（到文件）cmd 行的简单检查

```
net files 
```

如果其他东西有锁，可能会给你一些线索。

或者，您可以使用[FileMon 之](http://technet.microsoft.com/en-gb/sysinternals/bb896642.aspx)类的工具获取更多详细信息，并检查您的应用程序是否正确发布。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T00:00:56.500

由于这似乎不是编码问题，因此我将戴上我的 syadmin 帽子并提供一些建议。

1.  在创建文件时扫描文件的客户端或服务器上的病毒扫描程序。
2.  Windows[机会主义锁定](http://support.microsoft.com/kb/296264)习惯于在网络共享上搞砸事情。我记得这主要是具有平面文件数据库的多个读/写客户端的问题，但是[缓存](http://support.microsoft.com/kb/129202)肯定可以解释您的问题。
3.  Windows [file open cache](http://support.microsoft.com/default.aspx?scid=kb;[LN];Q124916). I'm not sure if this is still a problem in Win2K or not, but FileMon would tell you.

Edit: If you can catch it in the act from the server machine, then Sysinternal's Handle will tell you what has it open.

# model-view-controller - .Net 的 MVP Taligent 编程模型

> ID：707347
> 
> 赞同：3
> 
> 时间：2009-04-01T21:08:26.993
> 
> 标签：model-view-controller, mvp, composite-controls

有没有人使用如下的[智能编程模型](http://en.wikipedia.org/wiki/Taligent)创建`.NET`控制架构？

[http://www.wildcrest.com/Potel/Portfolio/mvp.pdf](http://www.wildcrest.com/Potel/Portfolio/mvp.pdf)

正如IBM所说 -

> MVP 将使 IBM 能够在其所有主要的面向对象语言环境中提供统一的概念编程模型

问题是如何实现或将 IInteractor 概念（第 9 页）映射到 .NET 接口？目前的猜测是使用`IInputElement`接口作为所有 UI 输入控件的事件源。

如果有人已经在 .NET 中实现了 taligent 模式，我想知道它是否适用于 Silverlight 和 WPF。如果是这样，它是否适用于它们的接口的联合？

最后，这代表了统一的抽象架构，可以取代`PresentationFramework.dll`. 如果您认为这适用于控制架构，请发表评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T21:29:38.970

这取决于您所说的“.net”是什么意思。该术语涵盖多种应用。Web 应用程序、Web 服务、Windows 窗体应用程序、WPF 应用程序等...

MVP 在 ASP.NET Web 应用程序中被大量使用。看：

[http://msdn.microsoft.com/en-us/magazine/cc188690.aspx](http://msdn.microsoft.com/en-us/magazine/cc188690.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T21:31:03.397

文章[如何：实现](http://msdn.microsoft.com/en-us/library/cc304879.aspx)MSDN[模式和实践](http://msdn.microsoft.com/en-us/library/ms998572.aspx)部分的模型-视图-演示者模式接缝成为您正在寻找的...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-16T14:28:18.640

基于 Taligent 的理念，我们为 .NET 创建了一个完整的 MVP 框架。我们花了一些时间才搞定，但现在我们可以通过编写业务类、创建新表单并将类的属性拖放到表单上来创建应用程序。

该框架非常复杂，允许在运行时自定义表单，以及自动将业务类中的验证与表单的编辑挂钩。

我们还编写了一个 OPF（对象持久性框架）来补充它，因此也无需管理数据库代码。

# java - 使用 NIO DatagramChannel 是否需要处理部分读/写的数据包？

> ID：707351
> 
> 赞同：3
> 
> 时间：2009-04-01T21:10:33.150
> 
> 标签：java, sockets, datagram

使用 SocketChannel 时，需要保留读写缓冲区来处理部分写入和读取。

我怀疑在使用 DatagramChannel 时可能不需要它，但信息很少。

故事是什么？

我是否应该反复调用（非阻塞）receive(ByteBuffer)，直到我得到一个空值来读取所有等待的数据报？

在非阻塞模式下发送时，我是否可以依靠 send(ByteBuffer, SocketAddress) 发送整个缓冲区或完全拒绝它，或者我是否需要保留部分写入的缓冲区？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-01T21:25:48.870

数据报的每次读取都是整个数据报，不多也不少。在 java.nio.DatagramChannel.read 的描述中有这样的提示：

> 如果数据报中的字节数多于给定缓冲区中剩余的字节数，则数据报的其余部分将被静默丢弃

当您处理 SocketChannel 时，它是一个消息流；无法保证每次读取会获得多少数据，因为 TCP 正在重新组装单独的数据包以从另一端重新创建消息。但是对于 UDP（这是您使用 DatagramChannel 读取的内容），每个数据包都是它自己的原子消息。

# actionscript-3 - 在 Flex 中计算字典长度

> ID：707354
> 
> 赞同：7
> 
> 时间：2009-04-01T21:14:05.950
> 
> 标签：actionscript-3, apache-flex, flex3

在 Flex 中计算 Dictionary 对象长度的最佳方法是什么？

```
var d:Dictionary = new Dictionary();
d["a"] = "alpha";
d["b"] = "beta"; 
```

我想检查这个字典的长度应该是 2。除了遍历对象之外，还有其他方法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-01T21:22:11.203

不，除了遍历元素之外，没有办法检查对象的长度（字典几乎是一个支持非字符串键的对象）。

[http://www.flexer.info/2008/07/31/how-to-find-an-objects-length/](http://www.flexer.info/2008/07/31/how-to-find-an-objects-length/)

您可能不必担心检查该属性是否为内部属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T19:56:09.023

as3corelib 中有一个 util 函数，可以获取字典中的键。您可以查看[DicitonaryUtil](http://as3corelib.googlecode.com/svn/trunk/src/com/adobe/utils/DictionaryUtil.as)

方法是：

```
 public static function getKeys(d:Dictionary):Array
    {
        var a:Array = new Array();

        for (var key:Object in d)
        {
            a.push(key);
        }

        return a;
    } 
```

所以你会做 getKeys(dictionary).length

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T21:48:03.870

您可以改用[关联数组](http://livedocs.adobe.com/flex/3/html/help.html?content=10_Lists_of_data_4.html)，因为我认为无法检查 Dictionary 对象的长度。但是，您可以扩展 Dictionary 类并添加该功能并覆盖相应的方法。

或者，您可以每次循环遍历它以获得长度，这不是一个好主意，但可用。

```
var d:Dictionary = new Dictionary();
d["hi"] = "you"
d["a"] = "b"
for (var obj:Object in d) {
  trace(obj);
}
// Prints "hi" and "a" 
```

您还可以[在此处](http://www.java2s.com/Code/Flash-Flex-ActionScript/Class/CallsetPropertyIsEnumerableindynamicobject.htm)查找有关使用“setPropertyIsEnumerable”的信息，但我相信这对对象比对字典更有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T13:34:22.550

您可以围绕控制插入/删除的字典编写一个类，以便跟踪键数。

尝试扩展代理或只是做一个包装。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-21T19:05:16.520

对于任何偶然发现此问题的人，现在 DictionaryUtil 都有更新。你现在可以打电话了..

```
var count:int = DictionaryUtil.getKeyCount(myDictionary); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-23T18:43:49.630

您可以获取`keys`并`Dictionary`检查`length`如下`keys` `array`：

```
var d:Dictionary = new Dictionary();
d["a"] = "alpha";
d["b"] = "beta";
var count:int = DictionaryUtil.getKeys(d).length; 
```

# java - 简单的 Spring，独立应用使用 ClasspathApplicationContext，如何重用？

> ID：707355
> 
> 赞同：5
> 
> 时间：2009-04-01T21:14:12.610
> 
> 标签：java, spring, jakarta-ee, inversion-of-control, cron

如果我有一个独立的主应用程序。说20节课。它们都可能需要随时与 spring 配置 (ApplicationContext) 定义的 bean 交互。我会在主应用程序入口点引导类路径应用程序上下文。但是如何重用已经实例化的 bean？

例如，将 ClasspathApplicationContext 设置为单例似乎是一种不好的方法，但这就是想法。

我以为我已经看到了 GlobalContextLocator 或类似的东西，但没有看到如何使用它的示例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T23:25:05.603

有很多方法可以做到这一点。您最好的参考在这里：

[http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#context-introduction](http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#context-introduction)

而你需要查看的具体类是 SingletonBeanFactoryLocator 和 ContextSingletonBeanFactoryLocator。

如果您使用 SingletonBeanFactoryLocator，您可以使用以下内容查找 bean：

```
BeanFactoryLocator bfl = SingletonBeanFactoryLocator.getInstance();
BeanFactoryReference bf = bfl.useBeanFactory("com.mycompany.myapp");
MyClass zed = bf.getFactory().getBean("mybean"); 
```

Javadocs 中有一个很好的详细解释：

[http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/factory/access/SingletonBeanFactoryLocator.html](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/factory/access/SingletonBeanFactoryLocator.html)

另外，为了清楚起见，请确保配置文件位于应用程序的类路径中，否则查找将失败。

# php - 如何从字符串中删除0

> ID：707356
> 
> 赞同：7
> 
> 时间：2009-04-01T21:14:16.573
> 
> 标签：php

我正在查看该功能`trim`，但不幸的是它没有删除“0”，我该如何添加它？我应该使用`str_replace`吗？

编辑：我要修改的字符串是一个消息号，如下所示：00023460

该函数`ltrim("00023460", "0")`正是我需要的:) 显然我不想使用常规`trim`，因为它也会删除结尾 0 但因为我忘了补充说我得到的答案很好:)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-01T21:16:31.123

```
$ php -r 'echo trim("0string0", "0") . "\n";'
string 
```

对于示例中的零填充数字：

```
$ php -r 'echo ltrim("00023460", "0") . "\n";'
23460 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T21:17:13.710

trim 函数只删除字符串开头和结尾的字符，因此您可能需要使用 str_replace。

如果只需要去掉字符串开头和结尾的0，可以使用如下：

```
$str = '0000hello00';

$clean_string = trim($str, '0'); // 'hello' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T00:59:10.167

这应该从一开始就在这里。

> 编辑：我要修改的字符串是一个消息号，如下所示：00023460

最好的解决方案可能是任何低于 PHP_INT_MAX 的整数

$number = (int) '00023460';

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T21:16:26.897

看看**[str_replace](http://us3.php.net/manual/en/function.str-replace.php)**

```
print str_replace( '0', '', "This0string0needs0spaces"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-01T21:16:54.023

当然可以（见[第二个参数`$charlist`](http://docs.php.net/trim)）：

```
trim('000foo0bar000', '0')  // 'foo0bar' 
```

# ruby-on-rails - Mongrel Rails 错误：RoutingError（没有路由匹配“/://0”与 {:method=>:get}）：

> ID：707358
> 
> 赞同：2
> 
> 时间：2009-04-01T21:15:37.333
> 
> 标签：ruby-on-rails, routing

我一直在我的 Rails 生产日志中看到这个错误，有什么想法吗？我在 apache 上使用 mongrel 集群运行 rails。RoutingError (没有路由匹配 "/://0" 与 {:method=>:get}):

不确定是什么尝试的 url 导致了错误。

编辑：这是我的 routes.rb 文件

ActionController::Routing::Routes.draw 做 |map|

```
map.signout '/account/signout', :controller => 'sessions', :action => 'destroy'
map.signin '/account/signin', :controller => 'sessions', :action => 'new'
map.signup '/account/signup', :controller => 'users', :action => 'new'

map.change_password '/account/change_password', :controller => 'users', :action => 'change_password'
map.forgot_password '/account/forgot_password', :controller => 'users', :action => 'forgot_password'
map.reset_password '/account/reset_password/:id', :controller => 'users', :action => 'reset_password'   

map.preferences '/preferences', :controller => 'preferences', :action => 'index'
map.dashboard '/dashboard', :controller => 'dashboard', :action => 'index'
map.account '/account', :controller => 'account', :action => 'index'
map.affiliate '/affiliates', :controller => 'affiliates', :action => 'index'

map.essentials '/preferences/essentials', :controller => 'preferences/essentials', :action => 'index'
map.contacts '/preferences/contacts', :controller => 'preferences/contacts', :action => 'index'
map.travel '/preferences/travel', :controller => 'preferences/travel', :action => 'index'
map.online '/preferences/online', :controller => 'preferences/online', :action => 'index'
map.reminders '/preferences/reminders', :controller => 'preferences/reminders', :action => 'index'
map.miscellaneous '/preferences/miscellaneous', :controller => 'preferences/miscellaneous', :action => 'index'

map.home '/home', :controller => 'main', :action => 'home'
map.about '/about', :controller => 'main', :action => 'about'
map.gift '/gift', :controller => 'gift', :action => 'index'
map.plans '/plans', :controller => 'main', :action => 'plans'
map.faqs '/faqs', :controller => 'main', :action => 'faqs'
map.contact '/contact', :controller => 'main', :action => 'contact'

map.tos '/terms_of_service', :controller => 'main', :action => 'terms_of_service'
map.privacy '/privacy', :controller => 'main', :action => 'privacy'

map.root :controller => 'main'

map.connect ':controller/:action/:id'
map.connect ':controller/:action/:id.:format' 
```

结尾

来自 rails 错误日志的完整错误消息：

```
ActionController::RoutingError (No route matches "/account/://0" with {:method=>:get}):
/usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/routing/recognition_optimisation.rb:66:in `recognize_path'
/usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/routing/route_set.rb:386:in `recognize'
/usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:182:in `handle_request'
/usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:110:in `dispatch_unlocked'
/usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:123:in `dispatch'
/usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:122:in `synchronize'
/usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:122:in `dispatch'
/usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:132:in `dispatch_cgi'
/usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:39:in `dispatch'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:76:in `process'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `synchronize'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `process'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:159:in `process_client'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `each'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:158:in `process_client'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `initialize'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `new'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:285:in `run'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `initialize'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `new'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel.rb:268:in `run'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:282:in `run'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `each'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/configurator.rb:281:in `run'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:128:in `run'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/command.rb:212:in `run'
/usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:281
/usr/local/bin/mongrel_rails:19:in `load'
/usr/local/bin/mongrel_rails:19 
```

apache vhost 文件的摘录：

```
 RewriteCond %{SERVER_PORT} !^443$
  RewriteRule ^/(.*)$ https://%{SERVER_NAME}/$1 [R,L]

  # Redirect all non-static requests to Mongrel
  RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f
  RewriteRule ^/(.*)$ balancer://mongrel1%{REQUEST_URI} [P,QSA,L]

  <Proxy balancer://mongrel1>
    BalancerMember http://127.0.0.1:3000
    BalancerMember http://127.0.0.1:3001
  </Proxy>

  ProxyPass / balancer://mongrel1/
  ProxyPassReverse / balancer://mongrel1/
  ProxyPreserveHost on 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T04:47:46.640

呃 - 问题似乎是有人正在请求一个 URL `"/account/://0"`？为什么不应该**产生**路由错误？我不希望这会击中您定义的任何路线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T05:56:45.010

这可能只是一次黑客攻击吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T07:32:23.343

您的 config/routes.rb 文件中似乎存在问题。

如果您可以将 routes.rb 文件的内容和您尝试加载的 URL 添加到您的消息中，我们可以提供进一步的帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T06:47:23.757

map.connect ':controller/:action/:id' map.connect ':controller/:action/:id.:format'

将这些语句与下面给出的顺序互换。

map.connect ':controller/:action/:id.:format' map.connect ':controller/:action/:id'

routes.rb 中没有提供宁静的路线，因此问题可能不在于方法定义或调用任何成员方法。

格式只是覆盖 url 源。

# c++ - 用于在 C++ 中包装整数的干净、高效的算法

> ID：707370
> 
> 赞同：30
> 
> 时间：2009-04-01T21:18:35.313
> 
> 标签：c++, algorithm, math, word-wrap, integer

```
/**
  * Returns a number between kLowerBound and kUpperBound
  * e.g.: Wrap(-1, 0, 4); // Returns 4
  * e.g.: Wrap(5, 0, 4); // Returns 0      
  */
int Wrap(int const kX, int const kLowerBound, int const kUpperBound)
{
    // Suggest an implementation?
} 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-04-01T21:35:35.227

的符号仅在且都是非负数`a % b`时才定义。`a``b`

```
int Wrap(int kX, int const kLowerBound, int const kUpperBound)
{
    int range_size = kUpperBound - kLowerBound + 1;

    if (kX < kLowerBound)
        kX += range_size * ((kLowerBound - kX) / range_size + 1);

    return kLowerBound + (kX - kLowerBound) % range_size;
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-04-01T22:26:34.450

以下应独立于 mod 运算符的实现工作：

```
int range = kUpperBound - kLowerBound + 1;
kx = ((kx-kLowerBound) % range);
if (kx<0)
  return kUpperBound + 1 + kx;
else
  return kLowerBound + kx; 
```

与其他解决方案相比的一个优势是，它只使用一个 %（即除法），这使得它非常有效。

*注意（题外话）：*

这是一个很好的例子，为什么有时定义区间是明智的，上限是不在范围内的第一个元素（例如对于 STL 迭代器......）。在这种情况下，两个“+1”都会消失。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-06T19:37:39.033

**最快的解决方案，最不灵活：利用将在硬件中进行包装的本机数据类型。**

包装整数的**绝对最快方法**是确保您的数据缩放到 int8/int16/int32 或任何本机数据类型。然后当你需要你的数据来包装本机数据类型时，将在硬件中完成！比这里看到的任何软件包装实现都非常**轻松且速度快几个数量级。**

作为示例案例研究：

当我需要使用 sin/cos 实现的查找表来实现 sin/cos 的快速实现时，我发现这非常有用。基本上，您可以缩放数据，使 INT16_MAX 为 pi，而 INT16_MIN 为 -pi。那你准备好了吗？

附带说明一下，缩放数据会增加一些前期有限计算成本，通常看起来像：

```
int fixedPoint = (int)( floatingPoint * SCALING_FACTOR + 0.5 ) 
```

随意将 int 换成你想要的其他东西，比如 int8_t / int16_t / int32_t。

* * *

**下一个最快的解决方案，更灵活：mod 操作很慢，如果可能，请尝试使用位掩码！**

我浏览的大多数解决方案在功能上都是正确的……但它们取决于 mod 操作。

mod操作很慢，因为它本质上是在做[硬件划分](http://en.wikipedia.org/wiki/Division_(digital))。外行人对 mod 和除法为什么慢的解释是将除法运算等同于一些伪代码`for(quotient = 0;inputNum> 0;inputNum -= divisor) { quotient++; }`（[商和除数](http://en.wikipedia.org/wiki/Quotient)的 def ）。正如您所看到的，如果硬件除法相对于除数来说是一个较小的数字，它*可能会很快......但***如果它比除数大得多，除法也会非常慢**。

如果您可以将数据缩放到 2 的幂，那么您可以使用将在一个周期内执行的位掩码（在所有平台的 99% 上），并且**您的速度提高大约一个数量级（至少 2 或快 3 倍）**。

实现包装的 C 代码：

```
#define BIT_MASK (0xFFFF)
int wrappedAddition(int a, int b) {
    return ( a + b ) & BIT_MASK;
}
int wrappedSubtraction(int a, int b) {
    return ( a - b ) & BIT_MASK;
} 
```

随意将#define 设置为运行时。并随意将位掩码调整为您需要的任何二的幂。就像您决定实施的 0xFFFFFFFF 或 2 的幂一样。

* * *

ps 我强烈建议在处理包装/溢出条件时阅读有关定点处理的信息。我建议阅读：

[定点算术：Randy Yates 简介 2007 年 8 月 23 日](http://www.digitalsignallabs.com/fp.pdf)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-22T02:26:27.207

请不要忽视这篇文章。:)

这有什么好处吗？

```
int Wrap(N,L,H){
  H=H-L+1; return (N-L+(N<L)*H)%H+L;
} 
```

这适用于负输入，只要 L 小​​于 H，所有参数都可以是负数。

背景...（请注意，`H`这里是重用变量，设置为 original `H-L+1`）。

我在递增时一直在使用`(N-L)%H+L`，但与几个月前我在开始学习 C 之前使用的 Lua 不同，如果我使用低于下限的输入，这将不起作用，更不用说负输入。（Lua 是用 C 构建的，但我不知道它在做什么，而且它可能不会很快......）

我决定添加`+(N<L)*H`make `(N-L+(N<L)*H)%H+L`，因为 C 似乎被定义为 true=1 和 false=0。它对我来说效果很好，并且似乎巧妙地回答了原始问题。如果有人知道如何在没有 MOD 运算符 % 的情况下使其速度惊人，请这样做。我现在不需要速度，但有一段时间我会的，毫无疑问。

编辑：

`N`如果低于多于`L`，则该函数失败，`H-L+1`但这不会：

```
int Wrap(N,L,H){
  H-=L; return (N-L+(N<L)*((L-N)/H+1)*++H)%H+L;
} 
```

我认为它会在任何系统中的整数范围的负极端处中断，但应该适用于大多数实际情况。它增加了一个额外的乘法和除法，但仍然相当紧凑。

**（这个编辑只是为了完成，因为我想出了一个更好的方法，在这个线程的一个更新的帖子中。）**

乌鸦。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-11-25T20:19:32.150

如果范围是排他的并且除数被限制为正值，我个人发现这些类型的函数的解决方案会更清晰。

```
int ifloordiv(int x, int y)
{
    if (x > 0)
        return x / y;
    if (x < 0)
        return (x + 1) / y - 1;
    return 0
}

int iwrap(int x, int y)
{   return x - y * ifloordiv(x, y);
} 
```

融合的。

```
int iwrap(int x, int y)
{
    if (x > 0)
        return x % y;
    if (x < 0)
        return (x + 1) % y + y - 1;
    return 0;
} 
```

同一个家庭。为什么不？

```
int ireflect(int x, int y)
{
    int z = iwrap(x, y*2);
    if (z < y)
        return z;
    return y*2-1 - z;
}

int ibandy(int x, int y)
{
    if (y != 1)
        return ireflect(abs(x + x / (y - 1)), y);
    return 0;
} 
```

可以为所有功能实现范围功能，

```
// output is in the range [min, max).
int func2(int x, int min, int max)
{
    // increment max for inclusive behavior.
    assert(min < max);
    return func(x - min, max - min) + min;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-01T21:35:31.343

实际上，由于 -1 % 4 在我使用过的每个系统上都返回 -1，所以简单的 mod 解决方案不起作用。我会尝试：

```
int range = kUpperBound  - kLowerBound +1;
kx = ((kx - kLowerBound) % range) + range;
return (kx % range) + kLowerBound; 
```

如果 kx 为正，则您修改，添加范围，然后修改返回，撤消添加。如果 kx 为负数，则您 mod，添加使其为正数的范围，然后再次 mod，这不会做任何事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-23T06:47:12.853

我的另一篇文章很糟糕，所有“纠正”乘法和除法都失控了。在查看了 Martin Stettner 的帖子后，在我自己的起始条件下`(N-L)%H+L`，我想出了这个：

```
int Wrap(N,L,H){
  H=H-L+1; N=(N-L)%H+L; if(N<L)N+=H; return N;
} 
```

在整数范围的极端负端，它会像我的另一个那样中断，但它会更快，并且更容易阅读，并且避免了其他的讨厌。

乌鸦。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-01T22:30:37.233

我会建议这个解决方案：

```
int Wrap(int const kX, int const kLowerBound, int const kUpperBound)
{
    int d = kUpperBound - kLowerBound + 1;
    return kLowerBound + (kX >= 0 ? kX % d : -kX % d ? d - (-kX % d) : 0);
} 
```

运算符的 if-then-else 逻辑`?:`确保 的两个操作数`%`都是非负数。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-02T06:21:48.597

一个具有一定对称性的答案，并且很明显，当 kX 在范围内时，它会原封不动地返回。

```
int Wrap(int const kX, int const kLowerBound, int const kUpperBound)
{
    int range_size = kUpperBound - kLowerBound + 1;

    if (kX < kLowerBound)
        return kX + range_size * ((kLowerBound - kX) / range_size + 1);

    if (kX > kUpperBound)
        return kX - range_size * ((kX - kUpperBound) / range_size + 1);

    return kX;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-02T07:59:44.027

我会给最常见的情况下界=0，上界=N-1的入口点。并在一般情况下调用此函数。在我已经在范围内的地方没有进行任何 mod 计算。它假设upper>=lower，或n>0。

```
int wrapN(int i,int n)
{
  if (i<0) return (n-1)-(-1-i)%n; // -1-i is >=0
  if (i>=n) return i%n;
  return i; // In range, no mod
}

int wrapLU(int i,int lower,int upper)
{
  return lower+wrapN(i-lower,1+upper-lower);
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-05-02T14:22:20.257

我也遇到过这个问题。这是我的解决方案。

```
template <> int mod(const int &x, const int &y) {
    return x % y;
}
template <class T> T mod(const T &x, const T &y) {
    return ::fmod((T)x, (T)y);
}
template <class T> T wrap(const T &x, const T &max, const T &min = 0) {
    if(max < min)
        return x;
    if(x > max)
        return min + mod(x - min, max - min + 1);
    if(x < min)
        return max - mod(min - x, max - min + 1);
    return x;
} 
```

我不知道它是否好，但我想我会分享，因为我在对这个问题进行谷歌搜索时被引导到这里，发现上述解决方案缺乏我的需求。=)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-03-30T21:42:36.533

在下限为零的特殊情况下，此代码避免了除法、取模和乘法。上限不必是二的幂。这段代码过于冗长，看起来很臃肿，但编译成 3 条指令：减法、移位（按常数）和“与”。

```
#include <climits>       // CHAR_BIT

// -------------------------------------------------------------- allBits
// sign extend a signed integer into an unsigned mask:
//   return all zero bits (+0) if arg is positive,
//       or all one  bits (-0) for negative arg
template <typename SNum>
static inline auto allBits (SNum arg) {
  static constexpr auto argBits = CHAR_BIT * sizeof( arg);
  static_assert( argBits < 256, "allBits() sign extension may fail");
  static_assert( std::is_signed< SNum>::value, "SNum must be signed");
  typedef typename std::make_unsigned< SNum>::type UNum;
  // signed shift required, but need unsigned result
  const UNum mask = UNum( arg >> (argBits - 1));
  return mask;
}

// -------------------------------------------------------------- boolWrap
// wrap reset a counter without conditionals:
//   return arg >= limit? 0 : arg
template <typename UNum>
static inline auto boolWrap (const UNum arg, const UNum limit) {
  static_assert( ! std::is_signed< UNum>::value, "UNum assumed unsigned");
  typedef typename std::make_signed< UNum>::type SNum;
  const SNum negX  = SNum( arg) - SNum( limit);
  const auto signX = allBits( negX);    // +0 or -0
  return arg & signX;
}
// example usage:
for (int j= 0; j < 15; ++j) {
   cout << j << boolWrap( j, 11);
} 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-04-01T21:31:27.110

对于负 kX，您可以添加：

```
int temp = kUpperBound - kLowerBound + 1;
while (kX < 0) kX += temp;
return kX%temp + kLowerBound; 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2013-03-10T21:55:06.317

为什么不使用扩展方法。

```
public static class IntExtensions
{
    public static int Wrap(this int kX, int kLowerBound, int kUpperBound)
    {
        int range_size = kUpperBound - kLowerBound + 1;

        if (kX < kLowerBound)
            kX += range_size * ((kLowerBound - kX) / range_size + 1);

        return kLowerBound + (kX - kLowerBound) % range_size;
    }
} 
```

用法：`currentInt = (++currentInt).Wrap(0, 2);`

# sql - SQL UPDATE SET 一列等于另一列引用的相关表中的值？

> ID：707371
> 
> 赞同：122
> 
> 时间：2009-04-01T21:19:04.970
> 
> 标签：sql

我希望这是有道理的，让我详细说明：

有一个测验程序的跟踪数据表，其中每一行都有..

QuestionID 和 AnswerID（每个都有一个表）。因此，由于一个错误，有一堆 QuestionID 设置为 NULL，但相关 AnswerID 的 QuestionID 位于 Answers 表中。

假设 QuestionID 为 NULL，AnswerID 为 500，如果我们转到 Answers 表并找到 AnswerID 500，则有一列 QuestionID 应该是 NULL 值所在的位置。

所以基本上我想将每个 NULL QuestionID 设置为等于在跟踪表中 AnswerID 的 Answer 行上的 Answers 表中找到的 QuestionID（与正在写入的 NULL QuestionID 相同的行）。

我该怎么做？

```
UPDATE QuestionTrackings
SET QuestionID = (need some select query that will get the QuestionID from the AnswerID in this row)
WHERE QuestionID is NULL AND ... ? 
```

不确定我如何能够将 QuestionID 从匹配的 AnswerID 分配给 QuestionID ...

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2009-04-01T21:24:23.820

```
update q
set q.QuestionID = a.QuestionID
from QuestionTrackings q
inner join QuestionAnswers a
on q.AnswerID = a.AnswerID
where q.QuestionID is null -- and other conditions you might want 
```

我建议在运行更新之前检查要更新的结果集是什么（相同的查询，只需选择）：

```
select *
from QuestionTrackings q
inner join QuestionAnswers a
on q.AnswerID = a.AnswerID
where q.QuestionID is null -- and other conditions you might want 
```

特别是每个答案 id 是否肯定只有 1 个关联的问题 id。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-04-01T23:00:19.970

如果没有 update-and-join 表示法（并非所有 DBMS 都支持），请使用：

```
UPDATE QuestionTrackings
   SET QuestionID = (SELECT QuestionID
                        FROM AnswerTrackings
                        WHERE AnswerTrackings.AnswerID = QuestionTrackings.AnswerID)
   WHERE QuestionID IS NULL
     AND EXISTS(SELECT QuestionID
                        FROM AnswerTrackings
                        WHERE AnswerTrackings.AnswerID = QuestionTrackings.AnswerID) 
```

通常在这样的查询中，您需要使用包含子查询的 EXISTS 子句来限定 WHERE 子句。这可以防止 UPDATE 践踏没有匹配的行（通常将所有值归零）。在这种情况下，由于缺少问题 ID 会将 NULL 更改为 NULL，因此可以说这无关紧要。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2015-09-10T10:20:32.303

我不知道您是否在 MySQL Workbench 上遇到了与我相同的问题，但是使用`INNER JOIN`after`FROM`语句运行查询对我不起作用。我无法运行查询，因为程序抱怨该`FROM`语句。

因此，为了使查询正常工作，我将其更改为

```
UPDATE table1 INNER JOIN table2 on table1.column1 = table2.column1
SET table1.column2 = table2.column4
WHERE table1.column3 = 'randomCondition'; 
```

代替

```
UPDATE a
FROM table1 a INNER JOIN table2 b on a.column1 = b.column1
SET a.column2 = b.column4
WHERE a.column3 = 'randomCondition'; 
```

我想我的解决方案是 MySQL 的正确语法。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-04-01T21:56:39.000

```
UPDATE
    "QuestionTrackings"
SET
    "QuestionID" = (SELECT "QuestionID" FROM "Answers" WHERE "AnswerID"="QuestionTrackings"."AnswerID")
WHERE
    "QuestionID" is NULL
AND ... 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-12-01T09:17:30.213

我有同样的问题。这是一个类似于 eglasius 的工作解决方案。我正在使用postgresql。

```
UPDATE QuestionTrackings
SET QuestionID = a.QuestionID
FROM QuestionTrackings q, QuestionAnswers a
WHERE q.QuestionID IS NULL 
```

如果使用 q 代替第 1 行中的表名，它会抱怨，并且第 2 行中的 QuestionID 之前不应有任何内容。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-03-01T18:55:40.860

```
 select p.post_title,m.meta_value sale_price ,n.meta_value   regular_price
    from  wp_postmeta m 
    inner join wp_postmeta n
      on m.post_id  = n.post_id
    inner join wp_posts p
      ON m.post_id=p.id 
    and m.meta_key = '_sale_price'
    and  n.meta_key = '_regular_price'
     AND p.post_type = 'product';

 update  wp_postmeta m 
inner join wp_postmeta n
  on m.post_id  = n.post_id
inner join wp_posts p
  ON m.post_id=p.id 
and m.meta_key = '_sale_price'
and  n.meta_key = '_regular_price'
 AND p.post_type = 'product'
 set m.meta_value = n.meta_value; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-05-08T11:51:24.323

***对于 Mysql 你可以使用这个查询***

UPDATE table1 a, table2 b SET a.coloumn = b.coloumn WHERE a.id= b.id

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-09-21T07:51:00.237

更新第一个表中的第二个表数据需要在 SET 之前进行内部连接：

```
`UPDATE `table1` INNER JOIN `table2` ON `table2`.`id`=`table1`.`id` SET `table1`.`name`=`table2`.`name`, `table1`.`template`=`table2`.`template`; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-02-16T00:22:06.770

以下适用于mysql

```
update table1 INNER JOIN table2 on table1.col1 =  table2.col1
set table1.col1 =  table2.col2 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-10-17T07:17:36.290

我认为这应该有效。

```
UPDATE QuestionTrackings
SET QuestionID = (SELECT QuestionID
                  FROM AnswerTrackings
                  WHERE AnswerTrackings.AnswerID = QuestionTrackings.AnswerID)
WHERE QuestionID IS NULL
AND AnswerID IS NOT NULL; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-05-31T11:08:49.980

```
UPDATE courses 
INNER JOIN states on courses.state_id = states.id 
SET courses.state_code = states.code
WHERE some_random_condition 
```

这里我们通过引用主记录来更新`courses`表列`course_code``states`

# excel - 除了明显的单元格着色属性之外，如何设置单元格的背景颜色？

> ID：707372
> 
> 赞同：1
> 
> 时间：2009-04-01T21:19:28.963
> 
> 标签：excel

我终其一生都无法弄清楚为什么某些单元格在我下载的电子表格模板中带有阴影。我确认单元格的着色属性设置为无颜色。该单元格有一个简单的公式：=SUM(J8:K8)。如果背景颜色是由另一个单元格中的代码设置的，我不知道如何找到它。搜索单元格名称（例如：B7）没有找到任何结果。有什么建议可以设置背景颜色吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T21:23:47.783

你看过条件格式选项吗？

可能是那里设置了背景颜色。

在 Office 2007 中，它位于“主页”选项卡上“样式”部分的功能区中 - 您最好选择“管理规则...”选项，然后检查每个工作表的规则。

# windows - wcf - 启用 Windows 和用户名身份验证

> ID：707373
> 
> 赞同：1
> 
> 时间：2009-04-01T21:19:31.053
> 
> 标签：windows, wcf

启用可以使用登录用户 Windows 凭据或用户名/密码组合调用 WCF 服务的方案所需的重要配置点是什么。

我很确定我知道如何设置它们，但我不知道如何强制使用用户名/密码端点。

是否只是使用允许您指定特定端点的构造函数，然后设置`ClientCredentials.UserName.UserName`and的问题`.Password`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T21:42:05.430

您只需要更改端点上的绑定；

```
<wsHttpBinding>
  <binding name="WSHttpUserName">
    <security>
      <transport clientCredentialType="None" />
      <message clientCredentialType="UserName" />
    </security>
  </binding>
</wsHttpBinding> 
```

现在，如果您想要自动 Windows 身份验证，那么您将需要另一个端点，在“Windows”的 clientCredentialType 上具有另一个绑定

或者您可以将它放在传输中而不是消息中，但无论如何您都需要 SSL 来进行用户名身份验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T11:49:47.467

只要您的配置客户端端点存在于 config 中并针对相关身份验证方法进行了配置，那么您是对的，它就像在构造函数中指定配置名称并将 uname/pwd 提供给客户端一样简单。

# iphone - 如何使用 AudioQueues 检索有效的 mHostTime

> ID：707377
> 
> 赞同：2
> 
> 时间：2009-04-01T21:21:26.057
> 
> 标签：iphone, audio, time

我正在为 iPhone 开发并试图获得一个初始时间戳来同步我的音频队列。

我正在使用`AudioQueueDeviceGetCurrentTime`这个。根据文档，**无论队列/设备是否正在运行，**此函数都会返回一个有效的 mHostTime 。但是当我尝试这个时，**我得到了一个`kAudioHardwareNotRunningError`**（1937010544）。所有队列都有一个关联的时间线，并且在我调用该函数之前已经初始化。

如何检索有效的 mHostTime 以同步我的 AudioQueues（在运行队列之前）？

我的代码：

```
AudioSessionInitialize(NULL, NULL, interruptionListenerCallback, self);

UInt32 sessionCategory = kAudioSessionCategory_MediaPlayback;

AudioSessionSetProperty(kAudioSessionProperty_AudioCategory,
                        sizeof(sessionCategory), &sessionCategory);

// initialize all queues
// ....

AudioSessionSetActive(true);

OSStatus result;
AudioTimestamp currentTime;

result = AudioQueueDeviceGetCurrentTime(audioQueueRef, &currentTimeStamp);

if (!result)
{
  // rest of code
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T13:45:43.773

经过一番谷歌搜索后，我在 CoreAudio 邮件列表上找到了一篇帖子，他们说 hostTime 与`mach_absolute_time()`.

`Mach_absolute_time()`确实给了我预期的时间戳值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T01:00:58.917

我花了大约一周的时间来解决这个确切的问题。据我所知，文档是错误的 - 您必须有一个正在运行的音频队列才能查询当前设备时间。

我的解决方案？这真的很不雅，但我只是让一个音频队列一直运行，播放静音，这样我就可以为其他队列计时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-20T17:45:46.413

试试这个，函数`AudioQueueGetCurrentTime(`) 填充一个`AudioTimeStamp`结构。如果您获得`mSampleTime`此结构的属性并除以**音频采样率**，您将获得当前秒位置。在代码中：

```
// AudioTimeStamp struct to store the value.
AudioTimeStamp timeStamp;

// Gets the current audio queue time.
AudioQueueGetCurrentTime(
                         mQueue,        // The audio queue whose current time you want to get.
                         NULL,        
                         &timeStamp,    // On output, the current audio queue time.
                         NULL         
                         );

// Return the value.
NSTimeInterval seconds = timeStamp.mSampleTime / mRecordFormat.mSampleRate; 
```

如果您不知道当前的**采样率**`mSampleRate`，如果您使用`CAStreamBasicDescription`结构来控制此信息，则此信息将存储在属性中。

希望它有效。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-12-02T02:43:21.267

您必须先创建一个时间线，然后才能调用`AudioQueueDeviceGetCurrentTime`

```
AudioSessionSetActive(true);
// initialize all queues
// ....

// initialize time line
AudioQueueTimelineRef audioTimeline;
status = AudioQueueCreateTimeline(audioQueueRef, &audioTimeline);

// now you can do what you want.
OSStatus result;
AudioTimestamp currentTime;

result = AudioQueueDeviceGetCurrentTime(audioQueueRef, &currentTimeStamp);    
if (!result)
{
    // rest of code
} 
```

# python - 如何在 Python 的方法中访问“静态”类变量？

> ID：707380
> 
> 赞同：208
> 
> 时间：2009-04-01T21:23:39.717
> 
> 标签：python, oop, static-variables

如果我有以下代码：

```
class Foo(object):
    bar = 1

    def bah(self):
        print(bar)

f = Foo()
f.bah() 
```

它抱怨

> NameError：未定义全局名称“bar”

如何访问`bar`方法中的类/静态变量`bah`？

* * *

## 回答 #1

> 赞同：216
> 
> 时间：2009-04-01T21:25:28.403

而不是`bar`使用`self.bar`or `Foo.bar`。分配给`Foo.bar`将创建一个静态变量，分配给`self.bar`将创建一个实例变量。

* * *

## 回答 #2

> 赞同：108
> 
> 时间：2009-04-02T09:42:57.227

定义类方法：

```
class Foo(object):
    bar = 1
    @classmethod
    def bah(cls):    
        print cls.bar 
```

现在如果`bah()`必须是实例方法（即可以访问self），您仍然可以直接访问类变量。

```
class Foo(object):
    bar = 1
    def bah(self):    
        print self.bar 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-04-02T05:13:03.287

与所有好的示例一样，您已经简化了您实际尝试做的事情。这很好，但值得注意的是，当涉及到类与实例变量时，python 具有*很大的灵活性。*方法也是如此。要获得一个很好的可能性列表，我建议阅读[Michael Fötsch 的新式课程介绍](http://realmike.org/blog/2010/07/18/introduction-to-new-style-classes-in-python/)，尤其是第 2 到第 6 节。

入门时需要做大量工作才能记住的一件事是**python 不是 java。** 不仅仅是陈词滥调。在 java 中，整个类都被编译，使得命名空间解析变得非常简单：在方法（任何地方）之外声明的任何变量都是实例（或者，如果是静态的，则为类）变量，并且可以在方法内隐式访问。

使用 python，经验法则是按顺序搜索三个命名空间以查找变量：

1.  功能/方法
2.  当前模块
3.  内置

`{begin pedagogy}`

有有限的例外。我想到的主要问题是，当加载类定义时，类定义是它自己的隐式命名空间。但这仅在加载模块时才会持续，并且在方法中被完全绕过。因此：

```
>>> class A(object):
        foo = 'foo'
        bar = foo

>>> A.foo
'foo'
>>> A.bar
'foo' 
```

但：

```
>>> class B(object):
        foo = 'foo'
        def get_foo():
            return foo
        bar = get_foo()

Traceback (most recent call last):
  File "<pyshell#11>", line 1, in <module>
    class B(object):
  File "<pyshell#11>", line 5, in B
    bar = get_foo()
  File "<pyshell#11>", line 4, in get_foo
    return foo
NameError: global name 'foo' is not defined 
```

`{end pedagogy}`

最后，要记住的是，您*确实*可以访问您想要访问的任何变量，但可能不是隐式的。如果您的目标简单明了，那么选择 Foo.bar 或 self.bar 可能就足够了。如果您的示例变得越来越复杂，或者您想做一些花哨的事情，例如继承（您可以继承静态/类方法！），或者在类本身中引用您的类名的想法对您来说似乎是错误的，请查看我链接的介绍。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2017-01-10T08:39:11.637

```
class Foo(object):
     bar = 1
     def bah(self):
         print Foo.bar

f = Foo() 
f.bah() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-05T18:26:34.643

`bar`是您的静态变量，您可以使用`Foo.bar`.

基本上，您需要使用类名来限定您的静态变量。

# javascript - 带有 javascript 的多功能 xml 属性正则表达式

> ID：707391
> 
> 赞同：0
> 
> 时间：2009-04-01T21:25:49.197
> 
> 标签：javascript, jquery, regex, xml, xml-attribute

基本上我有一个 xml 文档，我对文档的唯一了解是属性名称。

鉴于该信息，我必须找出该属性名称是否存在，如果确实存在，我需要知道该属性值。

例如：

```
<xmlroot>
  <ping zipcode="94588" appincome = "1750" ssn="987654321" sourceid="XX9999" sourcepw="ioalot">
  <status statuscode="Success" statusdescription="" sessionid="1234" price="12.50"> 
  </status>
</ping>
</xmlroot> 
```

我有名称 appincome 和 sourceid。价值观是什么？

此外，如果文档中有两个 appincome 属性名称，我也需要知道这一点，但我不需要它们的值，只要存在一个以上的匹配项即可。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T22:08:25.040

正则表达式可能不是最好的工具，尤其是当您的 JS 运行在支持 XPath 的相当现代的浏览器中时。这个正则表达式应该可以工作，但如果您没有严格控制文档的内容，请注意误报：

```
var match, rx = /\b(appincome|sourceid)\s*=\s*"([^"]*)"/g;

while (match = rx.exec(xml)) {
    // match[1] is the name
    // match[2] is the value

    // this loop executes once for each instance of each attribute
} 
```

或者，试试这个 XPath，它不会产生误报：

```
var node, nodes = xmldoc.evaluate("//@appincome|//@sourceid", xmldoc, null, XPathResult.UNORDERED_NODE_ITERATOR_TYPE, null);

while (node = nodes.iterateNext()) {
    // node.nodeName is the name
    // node.nodeValue is the value

    // this loop executes once for each instance of each attribute
} 
```

# ruby-on-rails - rails插件安装和升级

> ID：707395
> 
> 赞同：0
> 
> 时间：2009-04-01T21:26:25.780
> 
> 标签：ruby-on-rails, plugins

我有一个用 v 2.1.1 编写的 rails 插件。当我在 2.2.2 应用程序中安装它时，它会破坏应用程序。我无法使用多态路由，所以像

```
<%= link_to @object %> 
```

不起作用，因为它说： `ActionView::TemplateError (undefined method 'polymorphic_path' for #<ActionView::Base:0x1a95c1c>)`

如果我脚本/插件删除插件，它仍然坏了。所以我有一个两部分的问题：

1.  除了将文件复制到供应商/插件之外，脚本/插件安装还在做什么。从安装后的输出来看，它看起来像是在复制文件，但显然幕后还有其他事情发生，因为删除它并不能解决问题

2.  我需要做什么才能为 rails 2.2.2 更新这个插件。我对插件知之甚少，但我没有看到插件本身中有任何具有特定版本代码的东西，所以我无法弄清楚究竟是什么破坏了以及需要更新什么。显然，如果不看代码就很难回答这个问题，但实际上并不是插件中的代码在破坏，而是插件影响了我的整个 rails 配置。

有没有人有升级插件以适用于较新版本的 Rails 的经验？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T15:22:39.150

原来插件覆盖了 RouteSet::draw 方法，只需要更新到 2.2.2 绘制代码：P

# opengl - 在 OpenGL 中实现 HCI 的好方法是什么？

> ID：707397
> 
> 赞同：1
> 
> 时间：2009-04-01T21:27:58.333
> 
> 标签：opengl, hci

我想尝试为我现有的 OpenGL 应用程序实现一些 HCI。如果可能的话，菜单应该出现在我的背景中的 3D 图形前面。

我正在考虑直接在“相机”前面绘制一个正方形，然后在“基础”正方形的顶部绘制纹理或更多基元。

当菜单处于活动状态时，相机不能移动，因此相机不会从菜单上移开。

这听起来对任何人来说都太过分了，还是我走在正确的轨道上？其他人会怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T21:43:40.840

我只是`glPushMatrix`，`glLoadIdentity`做你的画，然后`glPopMatrix`不用担心你的相机在哪里。

您还需要禁用和重新启用深度测试、照明等

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T22:01:09.457

有[GLUI](http://www.cs.unc.edu/~rademach/glui/)库可以做到这一点（没有个人经验）
或者如果您使用 Qt，则有一些方法可以在 OpenGL 模型之上透明地渲染 Qt 小部件，还有在 opengl 中渲染所有 Qt 的 beta 支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T00:08:00.353

您还可以进行所有 3D 渲染，然后切换到正交投影并绘制所有菜单对象。这比按照您的建议将其全部放在一个大型广告牌四边形上要容易得多。

查看[此摘录](http://glprogramming.com/red/chapter03.html)，特别是标题“投影变换”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T00:47:01.680

[如此处](http://fly.cc.fer.hr/~unreal/theredbook/appendixh.html)所述，您需要在 x 和 y 中应用 0.375 的平移来获得像素完美对齐：

```
glViewport(0, 0, width, height);
glMatrixMode(GL_PROJECTION);
glLoadIdentity();
gluOrtho2D(0, width, 0, height);
glMatrixMode(GL_MODELVIEW);
glLoadIdentity();
glTranslatef(0.375, 0.375, 0.0);
/* render all primitives at integer positions */ 
```

算法很简单：

1.  绘制您的 3D 场景，大概启用深度测试。
2.  禁用深度测试，以便您的 GUI 元素将覆盖 3D 内容。
3.  使用 glPushMatrix 来存储您当前的模型视图和投影矩阵（假设您想要恢复它们 - 否则，就胜过它们）
4.  如上述代码中所述设置模型视图和投影矩阵
5.  绘制你的 UI 东西
6.  使用 glPushMatrix 恢复您推送的矩阵（假设您推送了它们）

这样做会使相机位置变得无关紧要 - 事实上，随着相机的移动，3D 部分会正常受到影响，但 2D 叠加层会保持原位。我期待这是您想要的行为。

# c# - C# 中的正则表达式帮助

> ID：707398
> 
> 赞同：-1
> 
> 时间：2009-04-01T21:28:38.130
> 
> 标签：c#, regex

我有一个用于删除 html 标签的正则表达式，现在我想知道是否有任何方法可以修改它，以便它也可以删除以or开头`http`和结尾的链接？`.stm``.gif`

这是我正在使用的一段代码：

```
string BBCSplit = Regex.Replace(BBC, @"<(.|\n)*?>", string.Empty); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T21:43:19.890

找出正则表达式的最好方法是通过示例、反复试验。

将您的 html 文本连同您的正则表达式一起放入[此站点，如果它变成黄色，则表示匹配。](http://regexpal.com/)

如果您需要有关 regexp 如何工作的教程，我发现[此站点](http://www.regular-expressions.info/)非常有用。

您需要的正则表达式类似于`http:.*\.stm`- 这意味着“字符 http，后跟 0 个或多个字符 (.*)，后跟字符 .stm”。

# c# - 在 null 上使用是否有效？

> ID：707399
> 
> 赞同：13
> 
> 时间：2009-04-01T21:28:48.363
> 
> 标签：c#, idisposable

如果资源没有实现 IDisposable，下面的代码会起作用吗？

```
 T resource = new T();
  using (resource as IDisposable)
  {
     ...
  } 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-01T21:33:56.043

是的。一个`using`语句检查它是否被给出`null`，如果是，则避免尝试调用`Dispose`。

从 C# 3 规范的第 8.13 节：

> using 语句被翻译成三个部分：获取、使用和处置。资源的使用隐式包含在包含 finally 子句的 try 语句中。这个 finally 子句处理资源。如果获取了 null 资源，则不会调用 Dispose，也不会引发异常。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-01T21:32:42.723

是的，它会工作，检查这个正在运行的测试：

```
[TestMethod]
public void TestMethod8()
{
    using (new MyClass() as IDisposable)
    {
    }
}
public class MyClass { } 
```

它只是运行没有任何问题。如果相应的类实现了 IDisposable ，它将调用它，否则它仍然可以工作/运行:)。

**更新：**正如其他人所说，我也想知道你想给它什么用途。我的猜测是你有一个类似工厂的东西，可以从不同的类中获取实例，这些实例可能是一次性的，也可能不是一次性的:)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T21:35:55.727

它应该可以正常工作，即使不是处理资源的“正确”方法。该`using`语句只是语法糖

```
IDisposable o = ...;

try
{
  // ...
}
finally
{
  if (o != null)
    o.Dispose(true);
} 
```

因此，如果 o 从未实现`IDisposable`，它将在`using`语句中为 null 并且它会尝试调用`Dispose`它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-01T21:40:22.377

在测试代​​码时，它似乎不会导致任何编译或运行时错误。

从语言定义（见第 8.13 节）：-

> 如果获取了 null 资源，则不会调用 Dispose，也不会引发异常。

如果该类型不能转换为 IDisposible，则 as 运算符会将资源转换为 null，并且封装在 using 块中的代码将执行得非常好，其行为与未将其包含在 using 块中的行为完全相同。

简而言之，您的问题的答案是肯定的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-01T21:31:38.653

如果通过“它会工作”你的意思是你会得到一个运行时错误吗？不，你不会。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-01T21:33:41.083

这有什么用？有什么好处？有什么好处？

using 语句将确保调用 Dispose 方法，但如果您的对象没有实现 IDisposable，我认为这样做没有用吗？它会工作（如，它不会抛出运行时异常并且它会编译），我刚刚在这里测试过但是......

使用您写下的代码，您甚至无法将资源用作 IDisposable ...

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-02T07:36:04.957

当类型显式实现 IDisposable 时，它​​可能很有用，在这种情况下，除非将类型强制转换为 IDisposable，否则无法直接访问该类型的 Dispose 方法，使用“as”进行安全强制转换并确保调用 Dispose。在大多数情况下，当类型显式实现 IDisposable 时，它​​会提供诸如 'Close' 之类的方法，而后者又会调用 Dispose

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-01T21:33:41.223

我相信编译器会在尝试调用 Dispose 之前添加检查以确定它是否为空。

[http://aspnetresources.com/blog/the_very_handy_using_statement.aspx](http://aspnetresources.com/blog/the_very_handy_using_statement.aspx)

# php - javascript 和 php 动态日历

> ID：707405
> 
> 赞同：0
> 
> 时间：2009-04-01T21:30:28.127
> 
> 标签：php, javascript, calendar, on-the-fly

我有一个 javascript 日历的代码，它完美地工作，因为它在页面加载时创建它。但是我想知道是否可以向其中添加事件。我找到了一个插件（jQuery），它使用户能够将鼠标悬停在带有“事件”类的 td 上，并且将显示一个事件。所以由于这个日历不会被我使用，而是被其他对开发一无所知的人使用，我想知道是否有办法制作 php 文件或上传或其他东西，以便她可以上传活动。我的意思是，假设她想在 3 日举办一个活动，然后她上传一个文件，php 读取它并告诉 javascript 添加该日期的“事件”类，然后 jQuery 完成其余的工作。是否可以？我什至不知道该怎么做，我真的希望我自己解释一下。这是我的javascript顺便说一句。

```
function buildCal(){
    var d = new Date();
    var month = d.getMonth()+1;
    var year = d.getFullYear();
    var monthName=['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'];
    var daysInMonth=[31,0,31,30,31,30,31,31,30,31,30,31];

    var objectDay = new Date(year, month-1, 1); //fix date bug when current day is 31st
    objectDay.od=objectDay.getDay()+1; //fix date bug when current day is 31st

    var todaydate=new Date() 
    var scanfortoday=(year==todaydate.getFullYear() && month==todaydate.getMonth()+1)? todaydate.getDate() : 0 //DD added

    daysInMonth[1]=(((objectDay.getFullYear()%100!=0)&&(objectDay.getFullYear()%4==0))||(objectDay.getFullYear()%400==0))?29:28;

    var t='<div class="main"><table class="main" cols="7" cellpadding="0" border="0" cellspacing="0">';
    t+='<h3 class="monthCSS" align="center">'+monthName[month-1]+' - '+year+'</h3><tr align="center">';

    for(s=0;s<7;s++)t+='<td class="daysofweek">'+"DoLuMaMiJuViSa".substr(s*2,2)+'</td>';

    t+='</tr><tr align="center">';
    for(i=2;i<=42;i++){
        var x=((i-objectDay.od>=0)&&(i-objectDay.od<daysInMonth[month-1]))? i-objectDay.od+1 : '&nbsp;';
            if (x==scanfortoday)
                x='<td class="today">'+x+'</td>'
            t+='<td class="days">'+x+'</td>';
        if(((i)%7==0)&&(i<36))t+='</tr><tr align="center">';
    }
    return t+='</tr></table></div>';
} 
```

正如您在此处看到的，它会添加空格，直到到达实际日期。我试图让它检查 if(x is not a number) 然后添加一个 td class="padding" 但是为此我试图使用 x.match(/[0-9]+/) 但它没有t 似乎有效，这也是我第一次尝试将正则表达式与 javascript 一起使用，有人知道为什么错了吗？或者如何实际检查它？

* * *

**编辑**

这个脚本发生了一些奇怪的事情，我不知道为什么，我试图改变

```
t+='<td class="days">'+x+'</td>'; 
```

到

```
t+='<td class="days' + x +'">'+x+'</td>'; 
```

这个，所以我可以选择每个 td，但是当我这样做时，会生成一个新的 td，其中包含

```
<td id="days&lt;td class=" today="">1</td> 
```

我不知道为什么会发生这种情况，我只知道它弄乱了代码，因为之后我得到一个 "> 打印（因为这个新 td 引起的引号不匹配......为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T21:41:17.647

我创建的日历系统使用了当月的完整 php 数组。这样您就可以对其进行迭代，并且对于每个相应的空白日期表单元格，该天都有一个空白数组。

例如

```
$calendar_dates = array(
              [week_1] = array(
                     [sun] = Null
                     [mon] = NULL
                     [tue] = array(
                            [events] = array(
                                    event_id => 'event name'
                                    event_name => ''
                                    event_time => ''
                             )
                     [wed]
                     ...
                 )
              [week_1] => array()
              ...........
  ) 
```

我通过从指定的日期和当前周创建一个数组来构建天数数组

然后我点击数据库以获取该范围内的事件

然后循环浏览事件并将它们附加到日历数组。

像魅力一样工作。

要让它与 javascript 一起工作，只需让它在控制日历日的打开和关闭的 html 文件的头部回显一些特定的 javascript。

为您的客户提供一个简单的登录页面，以在 Web 表单中输入/编辑事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T23:37:23.360

听起来您想将事件数据从服务器推送到包含日历的网页。虽然这是可能的，但这很困难，而且通常不值得付出努力。您最好在日历中构建一些 AJAX 并每隔 5 或 10 分钟左右轮询服务器以获取事件更新。这将在新事件上传和它们显示在日历上之间引入一些延迟，但会更容易开发。

# c# - 跟踪 C# 中的所有对象引用

> ID：707421
> 
> 赞同：15
> 
> 时间：2009-04-01T21:34:28.957
> 
> 标签：c#, visual-studio, object, reference

是否可以在 Visual Studio 中调试时列出对象的所有引用。我正在使用 C#。我正在寻找类似于垃圾收集期间 GC 所做的事情。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-01T21:44:58.027

SOS 可以为您做到这一点。它没有集成到调试器中，但您可以将其附加到正在运行的进程中。您可能会发现使用 SOSAssist 比学习控制台语法更有帮助。IIRC：

```
!dumpheap –type {type} 
```

# visual-studio - 有没有办法强制 Visual Studio 2008（或更低版本）使用拼写检查器进行评论？

> ID：707422
> 
> 赞同：5
> 
> 时间：2009-04-01T21:34:32.000
> 
> 标签：visual-studio, plugins, comments, spell-checking

我不确定这是否可以做到，但这肯定会让我的生活更轻松。我想知道 MS 拼写检查器是否可以用作其他应用程序的插件......或类似的东西。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T21:39:03.707

你可以通过[这个免费的插件](http://blogs.msdn.com/webdevtools/archive/2007/12/13/spell-checker-for-html-asp-net-jscript-vb-c-css-and-c-for-visual-studio-2005-and-2008.aspx)来做到这一点。

[较新的帖子](http://blogs.msdn.com/webdevtools/archive/2008/11/29/spell-checker-update-2-2-full-support-for-vs-2008-sp1-simpler-setup-and-a-few-bug-fixes.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T21:39:07.480

[Whole Tomato 的Visual Assist](http://www.wholetomato.com/)带有拼写检查器，以及许多其他奇妙的生产力增强功能 - 如果您使用 Visual Studio 没有 Visual Assist，您真的错过了 :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T21:41:12.140

您可以使用 FXCop 并编写自定义规则来拼写检查（[链接](http://davesbox.com/archive/2008/06/08/fxcop-now-ships-with-the-spell-checker-libraries.aspx)）您的评论

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T21:37:41.930

好吧，我不了解 Visual Studio，但 Eclipse 和 Emacs 都支持注释内的拼写检查。我通常把它关掉，因为它经常妨碍并抱怨变量名之类的东西，但我真的不需要拼写检查器（大部分时间）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T21:57:57.123

有一个工具可以在您键入的任何地方自动更正典型的拼写错误：

[AutoHotkey](http://www.autohotkey.com/)和[英文脚本的自动更正](http://www.autohotkey.com/download/OtherDownloads.htm)

# iphone - 你能从 iPhone 上的静态库中引用 Xib 文件吗？

> ID：707429
> 
> 赞同：31
> 
> 时间：2009-04-01T21:37:17.110
> 
> 标签：iphone, static-libraries, xib

在我的应用程序中，我目前将所有代码分离到一个静态库中，以便更轻松地为实际应用程序设置 xcode 项目目标并为我的代码进行单元测试。这样做的问题是我也想将我的大部分 xib 文件放在静态库中，但似乎当我运行我的应用程序并尝试引用 xib 时它找不到它，除非它包含在实际中应用程序的目标而不是静态库目标。是否可以在静态库中包含 xib 文件和其他资源，这些资源可以被同一库中的代码引用，如果可以，如何？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-28T05:46:19.697

不，这是不可能的，因为静态库与“捆绑包”不同。

捆绑包是一个目录，其中可能包含各种文件，包括资源文件 (xib)、可执行文件和静态库。它作为一组单独的文件存在于文件系统中。

静态库是包含由库创建者链接在一起的类、代码和变量的单个文件。它不“包含”其他文件，它本质上是一个编译代码的数据库。

尽管可以将 xib 的数据放在那里，但 Xcode 无法知道它在那里，因为它会在文件系统上将它们作为单独的文件查找。

在 Mac OS 中，您可以创建一个“框架”，它本质上是一组代码、资源、设置等，可以被多个项目重用。但是，Apple 似乎不支持为 iPhone OS 创建自定义框架。

捆绑 [https://developer.apple.com/library/content/documentation/CoreFoundation/Conceptual/CFBundles/BundleTypes/BundleTypes.html#//apple_ref/doc/uid/10000123i-CH101-SW1](https://developer.apple.com/library/content/documentation/CoreFoundation/Conceptual/CFBundles/BundleTypes/BundleTypes.html#//apple_ref/doc/uid/10000123i-CH101-SW1)

静态库 [http://en.wikipedia.org/wiki/Static_library](http://en.wikipedia.org/wiki/Static_library)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-29T02:12:00.687

回复评论（不适合评论框）

不用担心，上周我一直在尝试做与您几乎相同的事情-我想将 xib、包含文件和 .a 库的“框架”发送给客户，但不提供所有源代码代码。我也找不到使用捆绑包执行此操作的好方法。

无论出于何种原因，Apple 对此特别迟钝——我看不出他们在静态库（动态库足够公平）的情况下这样做的原因。

我现在的解决方案是手动创建一个包含以下子文件夹的包文件夹“Foo”：

1.  “包含”-> 将 .h 文件放在这里
2.  "res" -> 将 .xib 文件放在这里
3.  “lib”-> 包含“iphoneos”和“iphonesimulator”子文件夹，每个子文件夹都有 libFoo.a

然后将其压缩并发送给客户端。然后客户端：

1.  在他们喜欢的地方解压缩包。
2.  在资源组下添加“res”文件夹。
3.  更改以下目标设置：
    Other Linker Flags = -Objc -lfoo
    Header Search Paths = /include
    Library Search Paths = /lib/$(PLATFORM_NAME)

我可能可以在最后通过一些构建步骤来自动创建包，但是客户端被困在四个稍微繁琐的步骤中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-12-22T13:57:48.020

我找到了一个完美的解决方案，它可以自动完成以上所有操作，并且更多 [https://github.com/kstenerud/iOS-Universal-Framework](https://github.com/kstenerud/iOS-Universal-Framework) 它是一个 xCode 插件

它对我很有用，它只适用于 XCode 4 及更高版本

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-01-10T09:55:26.303

是的你可以。在库中添加一个 xib 文件，就像为任何普通项目所做的那样。然后在库项目目标中将 xib 文件与 .a 文件一起添加到复制文件部分。在您使用库的主项目中，将 xib 文件拖放到 .a 库文件所在的位置。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-15T06:40:24.160

回答将 Xib 文件包含到您的静态库中。

这次我们有 Xcode 11，除了库目标之外，您只需创建一个捆绑目标。捆绑包模板在 macOS 上可用。然后从库代码中，引用捆绑包以便能够引用笔尖。您将库与捆绑包一起分发。

下面是有关将 Xibs 与静态库一起使用的详细视频： [https ://www.youtube.com/watch?v=WQI02KR9kQw](https://www.youtube.com/watch?v=WQI02KR9kQw)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-20T11:58:44.650

分发时，您还可以创建一个 SDK。JSON.framework 在他们的 SVN 中做到了这一点，我成功地复制了这一点。您可以在项目中的 hltypes-ios.xcodeproj 和 iOS 文件夹中的[http://hltypes.svn.sf.net/](http://hltypes.svn.sf.net/)中查看这是如何完成的。

首先，您需要“安装”到您的构建文件夹中，然后您需要复制特殊格式的 SDKSettings.plist。然后将 SDK 的路径添加到应用程序项目中的“附加 SDK”列表中。复合 SDK 的缺点是每次更新此 mini-SDK 时都需要重新启动 Xcode 3.x，并且 Xcode 坚持构建由 Apple 的基础 SDK 和您的 mini-SDK 创建的复合 SDK（这意味着您需要等待相当长的时间） .

应用项目仍需手动添加 .xib 等资源。

# jquery - 简单的 CSS 悬停

> ID：707431
> 
> 赞同：2
> 
> 时间：2009-04-01T21:38:02.973
> 
> 标签：jquery, css

我在这里做一个非常简单的布局：http: [//www.flanels.com/](http://www.flanels.com/) - 如果你点击它画下来的工作，我正在使用这个 jQuery：

```
 $('#left ul li.item').hover(function() {
      $(this).addClass('over');
    }, function() {
      $(this).removeClass('over');
    }); 
```

这是课程：

```
#left ul li.over{
    background-color:#4CC7DC;    
} 
```

如果您查看链接文本，您会看到它更改为 a:hover，我正试图让您在 li.item 上时 a:hover 链接也更改，我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T21:46:37.680

这是你要找的吗？

```
#left ul li.over, #left ul li.over a {
    background-color:#4CC7DC;    
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T21:46:22.113

`hover()`在`li.item`元素上使用，然后代替访问`$(this).add/removeClass()`访问`$('#left ul li.item').add/removeClass()`。

也就是说，您可以在*任何*元素上设置类，而不仅仅是`$(this)`，因此只需命名您要更改的元素。

# implementation - 在 Web 应用程序中实施视觉链接分析的建议

> ID：707432
> 
> 赞同：-1
> 
> 时间：2009-04-01T21:38:38.293
> 
> 标签：implementation

我正在寻找一些关于如何在 Web 应用程序中实现可视链接分析的建议。我希望能够与 i2 的 Analysis Notebook 相比，而无需花费所有成本。

我找到[了 ThinkMap SDK](http://www.thinkmap.com/thinkmapsdk.jsp)（基于 Java）和[JuiceKit](http://www.juicekit.org/)（基于 Adob​​e Flex），但我更喜欢 C# .Net 中的东西，因为这是构建 Web 应用程序的基础。

如果没有人知道其他任何事情，那么有没有人有过[ThinkMap SDK](http://www.thinkmap.com/thinkmapsdk.jsp)或[JuiceKit](http://www.juicekit.org/)的经验？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T21:40:58.553

查看[NodeXL](http://www.codeplex.com/NodeXL)。它是免费的（在 CodePlex 上） - 带有源代码。我认为它最初来自微软。

它是 WPF，但如果您获得了源代码，我相信它可以移植到其他 .NET 技术。

# iphone - 如何找出我正在触摸的视图的标签

> ID：707436
> 
> 赞同：0
> 
> 时间：2009-04-01T21:39:12.427
> 
> 标签：iphone, uiview

我无法确定我正在触摸的视图的标签。

我有一个滚动视图并将其子类化以捕获触摸事件（我在子视图上有图片）。但是，我需要确定我触碰了哪张图片。

我想确定子视图的标签，但我得到随机结果（主要是标签 0）。捕捉这个的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T03:39:35.647

您可以尝试使用`UIView hitTest`. 它将返回用户正在触摸的子视图。

# asp.net - 页面后面的 Asp.Net AlertBox 代码？

> ID：707438
> 
> 赞同：1
> 
> 时间：2009-04-01T21:39:52.657
> 
> 标签：asp.net, alert

我在网格视图中有一个按钮域。单击按钮时，将调用 RowCommand 函数。

我需要弹出一个警告框让用户确认他们的选择。我很确定有一个 HtmlInputButton 涉及，但我只需要语法。

之后，你怎么知道他们是否确认了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T21:44:10.870

在你的 aspx 中，把它放在你的按钮上：

```
OnClientClick="javascript:return confirm('are you sure ?')" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T21:42:38.173

您可以通过 ItemDataBound 事件找到该按钮，然后添加一个确认框。

```
button1.Attributes.Add("OnCLick", "javascript: return confirm('Are You Sure You Want to Delete");") 
```

那应该可以为您提供所需的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T21:59:04.233

如果您使用的是 Ajax Control Toolkit，也可以使用[ConfirmButtonExtender](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/ConfirmButton/ConfirmButton.aspx)

如果您使用的是[jQuery](http://jquery.com/)（我完全推荐），您应该查看[jQuery UI](http://jqueryui.com/)和非常漂亮的[模态确认演示。](http://jqueryui.com/demos/dialog/#modal-confirmation)

需要注意的是，上面的确认是纯粹的客户端，所以如果你需要支持关闭了 javascript 的客户端，你也需要处理所有这些服务器端。例如，当单击“确定”时，javascript 可以设置一个隐藏的表单字段，该字段相当于“用户确认”，因此如果您按下删除按钮而没有填充隐藏的表单字段，您可以确定您需要显示一个服务器 -生成的确认字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-12T11:22:19.030

试试这个 ScriptManager.RegisterClientScriptBlock(Page, this.GetType(), "Alert", "alert('" + message+ "')", true);

# context-free-grammar - 如何编写上下文无关语法？

> ID：707443
> 
> 赞同：0
> 
> 时间：2009-04-01T21:40:44.217
> 
> 标签：context-free-grammar

我正在尝试在字母表`Σ = {a,b}`上为所有以相同数量的 's 开头和结尾的单词写一个 CFG，中间`a`至少有一个`b`。

现在我了解了 CFG、变量、生产规则等的基本概念。不幸的是，我已经没有编写上述 CFG 的想法了。到目前为止我所拥有的是

```
S → aYXYa
X → XbX | b | λ
Y → ??? 
```

我*认为*生产规则会给我一个字符串，两边都有两个 ** `S`** ，中间有尽可能多的 ** **。但是，我不确定如何在 ** ** 的两侧放置尽可能多的** **，同时确保每侧的 ** ** 数量完全相同。`X``a``b``a``b``a`

任何建议，解决方案将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-01T21:46:44.920

作为以前教过这门课的前教授，我不会给你答案。不过，我会给你一个提示：

你有正确的想法将它分成两部分，a 和其余部分。但是，您没有做对其中任何一个。

首先尝试写作： an ^n ba ^n 然后从那里分支。

希望有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T22:26:16.867

```
S → aSa | 乙
乙→乙| bB

```

这应该是您要查找的 CFG。每当您在开始和结束时处理相同的事情时，请记住您不能保证相同的 var 将以相同的方式填充。因此，您必须明确说明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T22:26:22.483

自从我的 CS 本科生以来已经有一段时间了，但这看起来很合理：

S -> aSa | bX

X -> bX | 乙

Basically, you start with S and add as many pairs of a's as you want and then switch to X and add as many b's as you want.

# unit-testing - NUnit 与团队系统单元测试

> ID：707444
> 
> 赞同：16
> 
> 时间：2009-04-01T21:40:56.697
> 
> 标签：unit-testing, nunit

你喜欢哪个？

单元测试各自的优缺点是什么？

编辑：我承认 Team System 提供的不仅仅是单元测试，例如应用程序和数据库的性能和负载测试。这个问题的中心是编写单元测试，你更喜欢哪个。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-02T07:16:49.387

**单元：**

好处：

*   自由
*   在属性和断言方法上与团队系统非常相似，有些名称甚至相同

缺点：

*   测试必须通过控制台或外部应用程序运行（这可以看作是一个优势，但不是从我的角度来看）。

**团队系统测试**

好处：

*   作为 VS 的一部分，您可以在测试窗口中运行测试。
*   如果您运行团队系统服务器，您可以在自动化构建过程中更轻松地运行测试

缺点：

*   昂贵的
*   仍然不如 NUnit 稳定

[团队系统与Nunit的比较](http://blogs.vertigosoftware.com/teamsystem/archive/2006/02/03/Comparing_nUnit_to_Team_System_Unit_Testing.aspx)

*我们使用团队系统 2008，因为我们是微软的金牌认证合作伙伴，但由于 VS 2005 中的错误相关问题，我们更早使用 Nunit。我更喜欢 VS 解决方案*。

*两者都是您工作的好解决方案，还请注意其他免费解决方案，例如：*

[团队系统的良好替代品](https://stackoverflow.com/questions/11857/what-do-you-use-as-a-good-alternative-to-team-system)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-02T00:57:00.640

一个非常具体的原因是，NUnit 不会将您绑定到 Visual Studio 的专业版。

**更新：**这里是关于vs 2008**专业版单元测试支持的链接：http:** [//msdn.microsoft.com/en-us/library/bb385902.aspx](http://msdn.microsoft.com/en-us/library/bb385902.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-02T12:24:02.330

NUnit 的另一个优点是它不需要您向测试类添加任何内容。MSTest 需要存在 TestContext 属性。我们从 MSTest 开始，但转换为 NUnit。我还发现 NUnit 的速度要快得多，而且我更喜欢 ReSharper 的测试运行器 UI。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-02T12:41:52.037

目前 NUnit 有**测试类别**，允许您将单元测试与较慢的集成测试分开运行。

MS Tests 没有这样的内置机制。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-02T07:29:45.173

使用 MS 测试时，您可以使用[CHESS](http://research.microsoft.com/en-us/projects/chess/)：

> CHESS 是一个系统地测试多线程代码的工具。给定一个并发测试，CHESS 系统地沿着所有可能的线程交错驱动测试。

[另外，我在这里](http://www.artofunittesting.com/Chapters/Tools_and_frameworks)找到了一个很好的比较，声称 MS 测试比 NUnit 慢一点，但我自己没有检查。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-02T12:40:14.383

Visual Studio 2008 不允许您在创建测试项目时使用其他测试框架吗？当 Hanselman 做预览 2 或 3 视频时，我在观看旧的 MVC 框架视频时依稀记得这一点。

这将允许您使用任何您喜欢的测试框架，并且仍然能够在您的 VS2008 IDE 中使用它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-08T07:08:52.453

测试私有方法怎么样。Team System 使用反射自动创建阴影访问器 - NUnit 是否相同？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-23T19:11:20.837

总是有像 ReSharper 和 TestDriven.NET 这样的工具。他们将让您从 Visual Studio 运行测试

# c++ - 单个 XMLHTTPRequest 对象发出多个请求

> ID：707447
> 
> 赞同：3
> 
> 时间：2009-04-01T21:41:07.477
> 
> 标签：c++, internet-explorer-7, msxml

有谁知道是否有办法使用单个 XMLHTTPRequest 对象来发送多个异步请求。我可以通过一个请求来完成它，并从我的 onreadystatechange() 处理程序中获得响应。

我想知道是否有办法使用同一个对象来发送多个并行请求，但我没有看到任何方法来匹配对来自 onreadystatechange() 函数的请求的响应。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-01T21:50:31.993

简短的回答：你不能。

您真正需要问自己的问题是，您为什么要在多个 XMLHTTPRequest 对象上使用它？实例化十几个对象几乎没有缺点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T15:30:24.717

+1 对 Martijn 的回答，但我想补充一点，您缺少的启示是，*根据定义*，请求是一次性对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-26T04:18:48.120

您可以在第一个请求完成后重用该对象以发出第二个请求，并将 onreadystatechange 更改为不同的函数。

不平行，但非常快。

需要注意的是，IE 不能重用 XMLHTTPRequest 对象，即使在 IE7 和 IE8 中实现的原生 XMLHTTP 中也是如此。

对于并行请求，创建多个 XMLHTTPRequest 对象，并在它们之间分配调用。

另一个注意事项是，当并行创建多个对象时，浏览器可能会限制您对并发 XMLHTTPRequest 对象的使用。通常以非常糟糕的方式丢失请求或透明地拒绝发送它们，因此您需要仔细测试。

最安全的做事方式是创建一个请求，使用它，然后处理它并创建一个新请求。一次一个。

# c# - 这个 C# 编译器行为是错误还是功能？

> ID：707454
> 
> 赞同：2
> 
> 时间：2009-04-01T21:43:08.983
> 
> 标签：c#, compiler-construction

为什么以下代码片段在 C# 中有效？这是编译器的一个特性还是一个bug？

```
class A
{
    public class B : A
    {

    }
}

class C : A.B
{
    public void Foo(C.B b)
    {

    }
}

class D : A
{
    public void Foo(D.B.B.B.B b)
    {

    }
} 
```

### 也可以看看

> [.NET 嵌套类](https://stackoverflow.com/questions/455928/-net-nested-classes)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-01T21:45:32.397

这是合法的代码，但很古怪。如果你愿意，我可以在规范中挖掘出关于名称解析的内容——但这绝对是合法的。我之前和 Eric Lippert 就类似的话题进行过对话。奇怪的是，它也使用了 DBBBB..。

谈话是由于[这个较早的问题](https://stackoverflow.com/questions/265585/why-cant-a-class-extend-its-own-nested-class-in-c)而引起的。

C# 3.0 规范的相关部分是 3.8，但它太长而且涉及到不值得在这里发布。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-01T23:29:55.453

1.  D 是一个 A
2.  A 有一个嵌套类型 B
3.  B 是一个 A
4.  转到 2

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T21:48:20.827

这个比较有趣。不过，我不知道这会造成什么伤害。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T23:12:11.673

请注意，代码分析指南声明[嵌套类型不应该是可见](http://msdn.microsoft.com/en-us/library/ms182162.aspx)的。

# html - 为什么要在 HTML 文档中使用尾随空格？

> ID：707455
> 
> 赞同：1
> 
> 时间：2009-04-01T21:43:18.437
> 
> 标签：html, spaces

我一直在查看[A List Apart](http://www.alistapart.com)网站的来源，我注意到一些奇怪的东西 - 每行（无论是否为空白）都有一个尾随空格。我从事排版工作，所以我经常会删除尾随空格，那么为什么在这种情况下你想要它们呢？我非常尊重 ALA，所以我认为这是有充分理由的！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T22:03:27.907

:P 这不是页面，而是 Chrome 的查看源代码功能 - 它为每一行添加了一个空格。虽然还是不知道为什么！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T22:07:35.820

html 源代码没有多余的空格。使用 wget 检索页面并使用 vim 进行查看。

# objective-c - Objective C 中的静态 BOOL

> ID：707460
> 
> 赞同：3
> 
> 时间：2009-04-01T21:45:06.937
> 
> 标签：objective-c

在下面的代码中，我在 UIColor 上创建了一个类别来创建随机颜色。但是，从这段代码中，我会认为每次运行该方法时“if”条件都会为真，而不仅仅是第一次。

我想我并没有真正正确理解静态变量。静态变量是否只设置一次，然后在第二次运行该方法时，该行就被忽略了？（所以第一次运行后种子永远是YES）？

```
@interface UIColor(Random)
+(UIColor *)randomColor
{
    static BOOL seeded = NO;
    if (!seeded) 
    {
        seeded = YES;
        srandom(time(NULL));
    }
    CGFloat red = (CGFloat)random()/(CGFloat)RAND_MAX;
    CGFloat green = (CGFloat)random()/(CGFloat)RAND_MAX;
    CGFloat blue = (CGFloat)random()/(CGFloat)RAND_MAX;
    return [UIColor colorWithRed:red green:green blue:blue alpha:1.0f];
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-01T21:51:21.180

你是正确的，静态变量只设置一次。

编码

```
static BOOL seeded = NO; 
```

不等于**_**

```
static BOOL seeded;
seeded = NO; 
```

第二个将始终评估为 NO，而第一个将评估为 NO，直到设置不同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-01T21:51:59.697

这里`static`意味着当前值`seeded`不会从方法的一次调用到下一次调用中丢失。声明行上的赋值只定义了 的第一个值`seeded`。

是的，`seeded`将永远`YES`在第一次运行之后。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T21:52:10.087

当控制离开函数范围时，静态变量保持其值。所以 seeded 将被设置为它最后拥有的任何值。在您的情况下，您使用 NO 初始化种子，然后将其设置为 YES。因此，要回答您的问题，是的：第一次调用此方法后，seeded 将始终为 YES。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T21:56:47.190

正如其他人所说，静态局部变量在创建时被初始化为特定值，并保留该值直到更改。另一方面，静态全局变量意味着它在文件范围内是本地的——也就是说，在当前源文件之外是不可访问的。

可以在[http://en.wikipedia.org/wiki/Block_Started_by_Symbol找到一些历史/低级细节](http://en.wikipedia.org/wiki/Block_Started_by_Symbol)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-01T22:31:32.050

静态变量不会像本例中的**红色、绿色**和**蓝色**变量那样分配在堆栈上。他们：

1.  分配在内存中的单个不可变位置，
2.  即使从未调用包含函数，也会消耗内存，
3.  *当函数在多个线程中使用时可能*会导致问题 - 尽管您的示例出现竞争条件的可能性很小，并且
4.  只分配一次；我不记得它是在第一次调用函数时还是在加载代码时（我认为是后者）。

它*可能会*帮助您将其视为编译器将声明（带赋值）移动到函数/类范围之外，但访问仅限于函数内部。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-01T21:53:45.917

嘿，您可以根据需要多次更改静态变量的值。您的 if 语句只有一次为真的原因是因为您在同一语句中声明并分配了 no 。尝试将两者分开以在每次运行时查看 if 语句为真

# mysql - 如何以 csv 格式输出 MySQL 查询结果（到屏幕，而不是文件）？

> ID：707473
> 
> 赞同：27
> 
> 时间：2009-04-01T21:48:15.540
> 
> 标签：mysql, csv

我正在尝试使用 mysql 命令行工具以逗号分隔格式输出查询结果。我的 mysql 用户无权使用此问题中引用的“INTO OUTFILE”选项：

[如何以 CSV 格式输出 MySQL 查询结果？](https://stackoverflow.com/questions/356578/how-to-output-mysql-query-results-in-csv-format)

我也知道分别以 html 和 xml 格式输出的 -H 和 -X 选项，但是有没有办法将 csv 格式直接输出到屏幕上？

[我使用 sed - http://tlug.dnho.net/?q=node/209](http://tlug.dnho.net/?q=node/209)找到了这种方法。但是，我很想找到一个直接的 mysql 解决方案。

有任何想法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-01T22:57:54.467

我最终只是采用制表符分隔的输出并将其复制粘贴到电子表格，然后将其导出到 csv。还意识到我可以使用 concat 或 concat_ws 函数来完成这项工作，并且下次会这样做。

[http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat)

[http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat-ws](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat-ws)

从表中选择 CONCAT_WS(',', field1, field2, field3);

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-06-14T11:11:16.783

将答案传递给`tr`，如下所示：

```
mysql <blah blah> -B | tr '\t' ',' 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-01T21:57:33.647

`mysql`我已经使用 MySQL 多年了，除了您已经找到的解决方案之外，我不知道有任何方法可以单独使用命令行客户端来生成 CSV 输出。

CSV 输出支持的文件中有几个功能请求：

*   [http://bugs.mysql.com/bug.php?id=5707](http://bugs.mysql.com/bug.php?id=5707)
*   [http://bugs.mysql.com/bug.php?id=25243](http://bugs.mysql.com/bug.php?id=25243)

我建议的唯一其他解决方案是用 Perl 或 PHP 编写脚本，从 MySQL 获取数据并以 CSV 格式或您想要的任何其他格式输出。这不是一个难写的脚本。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-05-09T15:12:27.887

```
mysql --raw --skip-column-names -u someuser -psomepass -h somehost -b somedatabase -e "select * from somedatabase.sometable;"| awk -F\\t '{print $1","$2","$3}'

-F\\t tells awk to use a tab as the delimeter on its input, and we print out the desired columns with commas as delimeters using the "," bit.  Replace "," with ":" or "|" or whatever to suit your needs. 
```

如果您需要引用一个输出字段，比如说 $1，您的 awk 打印将如下所示：

```
awk -F\\t '{print "\""$1"\","$2","$3}' 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-01T22:01:38.800

如果您有权访问 mysqldump，则可以使用类似这样的东西

```
mysqldump -u [username] -p -t -T/path/to/directory [database] --fields-enclosed-by=\; --fields-terminated-by=, 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-21T22:07:21.440

如果您安装了 MySQL Workbench，您可以运行查询，然后单击结果上方的“导出”。它将为您提供另存为 .CSV 的选项。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-10-13T12:25:58.963

按照将[MySQL 命令行结果的输出格式更改为 CSV](https://stackoverflow.com/questions/15640287/change-output-format-for-mysql-command-line-results-to-csv?rq=1)

```
mysql --skip-column-names --batch -e 'select * from dump3' t | awk -F'\t''{ sep=""; for(i = 1; i <= NF; i++) { gsub(/\\t/,"\t",$i); gsub(/\\n/,"\n",$i); gsub(/\\\\/,"\\",$i); gsub(/"/,"\"\"",$i); printf sep"\""$i"\""; sep=","; if(i==NF){printf"\n"} }}'

```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-01T23:08:53.613

CLI 可以以制表符分隔的格式输出，这几乎足够好（我根据经验说话）。使用 -B 选项。制表符分隔的最大问题是我无法让 Excel 导入该格式。但是，OpenOffice 可以。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-03T17:19:08.697

如果您以交互方式使用 mysql，则可以将寻呼机设置为使用 sed，如下所示：

```
$ mysql -u <user> p<passwpd>
mysql> pager sed 's/,/\n/g'
PAGER set to 'sed 's/,/\n/g''
mysql> SELECT blah FROM blah WHERE blah = blah

.
.
.
"blah":"blah"
"blah":"blah"
"blah":"blah" 
```

如果您不使用 see 作为寻呼机，则输出如下所示：

```
"blah":"blah","blah":"blah","blah":"blah" 
```

# string - 不同环境的单独连接字符串

> ID：707475
> 
> 赞同：0
> 
> 时间：2009-04-01T21:48:32.480
> 
> 标签：string, connection

在我的 VB.NET Windows 应用程序代码中，我创建了自己的 AppConfig 类，该类将连接字符串保存到 SQL 服务器数据库。我即将将该程序投入生产，并且想知道是否有一种简单的方法可以根据我是通过 VS 运行程序还是运行已部署的程序来让程序在开发连接字符串和生产连接字符串之间切换。我正在查看预处理指令，但无法弄清楚。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T21:52:03.440

```
string connectionString = String.Empty;
#if DEBUG
connectionString = ..
#else
connectionString = ..
#endif 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T21:54:04.153

您可以使用 #debug 之类的预处理指令仅在调试模式下运行某些代码块，但我相信这些仅在 C# 中可用。我认为您必须在 VB 中寻找另一种方法，而无需接触您的代码。是否可以为每个环境使用具有不同配置信息的不同配置文件？

-布莱恩

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T21:58:53.767

请通过类似的讨论查看[此帖子](https://stackoverflow.com/questions/350377/deploy-an-app-config-based-on-build-configuration)，其中问题是根据构建配置使用适当的应用程序配置。

我会毫不犹豫地使用您要采用的指令方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T22:22:26.283

```
If Environment.UserInteractive Then
  'Dev
Else
  'Prod
End If 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-09T21:13:29.717

我们有许多环境 DEV、QA、TEST、PROD 和 DR（灾难恢复）的问题。我们将其缩小到将连接字符串放在 machine.configs 或 AppSettings 中。我们使用了 AppSettings 作为关于[HERE的博客](http://blog.digitaltools.com/post/2009/06/18/Another-Place-to-Put-the-Connection-String.aspx)

# c# - 如何发送保留用户在 RTF 中的 RichTextBox 中提供的格式的电子邮件？

> ID：707478
> 
> 赞同：1
> 
> 时间：2009-04-01T21:48:58.563
> 
> 标签：c#, .net, html, richtextbox, rtf

我想要做的是提供一个表单，用户可以在其中键入或剪切和过去格式化的文本，并能够将其作为电子邮件发送（类似于 Outlook）。这是必需的，因为它与当前的工作流程非常相似，而且这些电子邮件不会保存在人们的收件箱之外的任何地方。这显然是一个更大的问题的绷带。

我目前的尝试有一个 RichTextBox，它可以接收复制和粘贴的 RTF，但是当我尝试发送电子邮件时，似乎唯一的选项是纯文本和 HTML。在研究了 RTF 到 HTML 库的选项之后，似乎它们都至少要花费 300 美元，但是在审查了自己编写库的难度之后，最好花时间和金钱来获得第三方选项。我很好奇在不引入第三方库的情况下是否有解决此问题的方法（发送带有格式化文本的电子邮件）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T21:51:36.920

大多数电子邮件客户端无法在 RTF 中显示电子邮件，事实就是如此。您无法更改电子邮件客户端。

因此，您需要以 HTML 格式发送电子邮件。不幸的是，没有内置的 WinForms 控件来导出 HTML 格式的文本，因此没有第三方代码就无法完成此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T22:15:06.927

您需要一个 RTF 到 HTML 转换器。你是对的，写一个可能不值得你花时间。反正我做到了。这还不错，因为我对 RTF 文档的创建有一定的控制权，并且可以禁止我不想翻译成 HTML 的东西。将 RTF 转换为 HTML 基本上只是一个文档解析器，它能够用它们的 HTML 等效项替换 RTF 命令动词。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T16:56:46.153

我最终找到了一个免费的解决方案： [http ://www.dreamincode.net/forums/showtopic48398.htm](http://www.dreamincode.net/forums/showtopic48398.htm)

这不是一个完美的翻译，但它比那里的任何付费套餐都要好。

# python - 问题回复：使用 Python 进行 GUI 编程的当前状态

> ID：707491
> 
> 赞同：21
> 
> 时间：2009-04-01T21:53:15.137
> 
> 标签：python, user-interface

我最近做了一些修改使用 wxPython 小部件的 Python gui 应用程序的工作。在过去的六七年里，我曾断断续续地尝试过 Python，但这是我第一次使用 gui 进行任何工作。我对目前使用 Python 进行 gui 编程的状态感到非常失望。我非常喜欢 Python 语言本身，它与我习惯的 Delphi/ObjectPascal 编程相比是一个有趣的变化，对于通用编程任务来说绝对是一个巨大的生产力提高。我想为所有事情转向 Python。

但是 wxPython 与 Delphi 的 VCL 或 .NET 的 WinForms 相比是一个巨大的倒退。虽然 Python 本身通过一般编程更高级别的抽象提供了不错的生产力收益，但 wxPython 的使用抽象级别低于 VCL。例如，我浪费了很多时间试图让 wxPython 列表对象按照我想要的方式运行。只是添加可排序的列涉及几个代码密集型步骤，一个是创建和维护提供实际排序顺序的影子数据结构，另一个是可以在列标题中显示图形排序方向三角形，以及还有几个我不记得了。所有这些容易出错的步骤都可以通过使用我的 Delphi 网格组件设置属性值来完成。

我的结论：虽然 Python 通过提高许多通用编码的抽象级别来大大提高生产力，但 wxPython 的抽象级别比 Delphi 可用的 gui 工具*低几个级别。*最终结果：使用 Delphi 进行 gui 编程比使用 Python 进行 gui 编程要快得多，并且使用 Delphi 生成的 ui 仍然更加精致和功能齐全。在我看来，说 Delphi gui 编程在 1995 年比使用 wxPython 的 python gui 编程在 2009 年更先进，这似乎并不夸张。

我对其他 python gui 框架进行了一些调查，但看起来并没有比 wxPython 更好。我还对 wxPython 的 gui formbuilders 做了一些最小的调查，这会让事情变得更好一些。但是根据大多数报告，这些解决方案是错误的，即使是出色的表单构建器也无法解决我对 wxPython 的主要抱怨，这只是它的功能较少，并且通常需要您以比我低得多的抽象级别进行 gui 编程习惯用Delphi的VCL。[对建议的 python gui-dev 解决方案 ( http://wiki.python.org/moin/GuiProgramming](http://wiki.python.org/moin/GuiProgramming) ) 的一些快速调查对于习惯于 Delphi 或 .NET 的人来说确实有些令人沮丧。

最后，我有几个问题。

首先，我错过了什么吗？是否有一些 Python 的 gui 开发解决方案可以与 VCL 或 WinForms 编程相比较？我不一定关心它是否完全符合 Delphi 的 VCL。我只是在寻找属于同一联盟的东西。

其次，IronPython 会是前进的方向吗？我主要是尽量避免喝 .NET koolaid，但也许 IronPython 给了我一个最终让步的理由。即便如此，IronPython 是否与 WinForms 完全集成，或者我是否需要让表单本身由 c# 或 vb 支持。网？在我看来，SharpDevelop 和 MonoDevelop 肯定就是这种情况（即 IronPython 不能用于进行设计时 gui 构建）。VS.NET 是否将 IronPython 与 gui 构建完全集成？

在我看来，如果 Python 出现了一些出色的新 gui 构建解决方案，Python 可以像 1990 年代早期 Visual Basic 所做的那样“接管世界”。只是这一次使用 Python，我们将拥有一个全新的快速、跨平台和 *开源*gui 编程范式。公司不会吃掉它吗？是的，我知道，Web 应用程序是当今事物的主要焦点，因此一个出色的 Python-gui 解决方案不会像 VB 曾经那样创造同样的革命。但我没有看到 gui 编程消失，我想要一个不错的现代、开源、高级解决方案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-01T22:09:32.260

似乎您的抱怨是关于 wxPython，而不是关于 Python 本身。尝试 pyQt（或者是 qtPython？）

但是，wxPython 和 pyQt 都只是 Python 对 C / C++（分别）库的绑定，它（在概念上）与原件一样低级。

但是，Qt 远优于 wx

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-02T00:17:59.750

PyQt 是 Nokia 与 Qt SDK 的绑定，PyQt 本身由一家名为[RiverBank](http://www.riverbankcomputing.co.uk/news)的公司提供。

如果许可证对您不重要，您可以在 GPL 下使用 PyQt，否则您需要为商业许可证支付一些费用。

PyQt 现在正在绑定 Qt 4.4。

Qt 不仅仅是 GUI，它是一个完整的 C/C++ SDK，可以帮助处理网络、xml、媒体、db 和其他东西，PyQt 将所有这些都转移到 python。

使用 PyQt，您将使用 Qt Designer，并通过简单的命令行将 .ui 文件传输到 .py 文件。

您会在网上找到许多关于 PyQt 的资源和来自不同社区的良好支持，甚至还出版了有关 PyQt 的书籍。

许多建议认为 RiverBank 别无选择，只能在 LGPL 下发布将依赖于 Qt 4.5 的下一个版本，我们正在等待 :)。

另一个解决方案是带有 Java Swing 的 Jython，编写起来非常简单和优雅（特别是在 JDK 6 下），但互联网上的资源不足。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-01T22:14:35.837

您可能想查看 Jython（Java VM 上的 Python）。它与 Iron Python 非常相似，你可以先去 .Net koolaid。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-03T14:38:58.060

[dabo](http://dabodev.com/)将 wxPython 编程置于您正在寻找的更高级别。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-01T22:26:37.680

您可能必须使用 .net 或 java python，但请先检查一下，看看它是否符合您的要求：

[猕猴桃](http://www.async.com.br/projects/kiwi/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-02T20:08:12.753

简短的回答：不要尝试 Tkinter - 它有上述所有问题。

长答案：Tkinter 对大型程序没有用处。用它处理各个部分总是会退化为杂耍（否则永远不会发生），并且生成的输出看起来不是原生的或特别优美的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-01T23:20:23.633

你是对的，wxPython 绝对可以改进。但我认为 Robin Dunn 到目前为止做得很好，现在仍然如此。

尤其是 wxPython 社区对改进持开放态度，例如最近[Andrea](http://xoomer.virgilio.it/infinity77/main/freeware.html)包含的小部件，因此就像许多社区项目一样，选择您最喜欢的一个，并在使用时对其进行改进。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-02T01:56:36.427

我们很高兴使用 Python.Net 在 WinForms 中构建我们的 UI，并使用 CPython 作为 Presenter、Model。如果你想在 Windows 上做 python，IronPython 也是一个很好的工具。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-02T18:09:32.400

有[Wax](http://wiki.wxpython.org/Wax)，其目的是为 wxWidgets 创建一个更加 Pythonic 的接口，但它的开发似乎已经停滞不前。

# c++ - 我如何使用 QPainter 进行绘画？

> ID：707492
> 
> 赞同：8
> 
> 时间：2009-04-01T21:53:15.497
> 
> 标签：c++, qt

我最近开始学习Qt。
我不太清楚如何使用`QPainter`类进行绘画。假设我只想在窗口中放置几个​​点：

```
 class PointDrawer: public QWidget {
    Q_OBJECT
private:
    QPainter p;
public:
    PointDrawer(QWidget* obj=0): QWidget(obj), p(this) {}
    virtual void paintEvent(QPaintEvent*) {
        p.setPen(QPen(Qt::black, 3));
        int n = 8;
        while(...) {
            qreal fAngle = 2 * 3.14 * i / n;
            qreal x = 50 + cos(fAngle) * 40;
            qreal y = 50 + sin(fAngle) * 40;
            p.drawPoint(QPointF(x, y));
                        i++;
        }
    }
}

int main(int argc, char *argv[]) {
    QApplication app(argc, argv);
    PointDrawer drawer;

    drawer.resize(200, 200);
    drawer.show();

    return app.exec();
} 
```

在那之后，我什么都没有！
你能告诉我我哪里错了吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-01T22:04:29.807

```
void SimpleExampleWidget::paintEvent(QPaintEvent *)
{
     QPainter painter(this);
     painter.setPen(Qt::blue);
     painter.setFont(QFont("Arial", 30));
     painter.drawText(rect(), Qt::AlignCenter, "Qt");
} 
```

[http://doc.qt.digia.com/4.4/qpainter.html](http://doc.qt.digia.com/4.4/qpainter.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-02T00:24:48.923

我认为问题在于您的`QPainter`初始化。

您可以`QPainter`在 Hydroes 的答案中创建类似的内容，然后看起来像这样：

```
class PointDrawer: public QWidget {
    Q_OBJECT
public:
    PointDrawer(QWidget* obj=0): QWidget(obj) {}
    virtual void paintEvent(QPaintEvent*) {
        QPainter p(this);
        p.setPen(QPen(Qt::black, 3));
        int n = 8;
        while(...) {
                qreal fAngle = 2 * 3.14 * i / n;
                qreal x = 50 + cos(fAngle) * 40;
                qreal y = 50 + sin(fAngle) * 40;
                p.drawPoint(QPointF(x, y));
                        i++;
        }
    }
} 
```

它也可以使用这样的东西，但我并不真正推荐它（我只是更喜欢其他解决方案）：

```
class PointDrawer: public QWidget {
    Q_OBJECT
private:
    QPainter p;
public:
    PointDrawer(QWidget* obj=0): QWidget(obj) {}
    virtual void paintEvent(QPaintEvent*) {
        p.begin(this);
        p.setPen(QPen(Qt::black, 3));
        int n = 8;
        while(...) {
                qreal fAngle = 2 * 3.14 * i / n;
                qreal x = 50 + cos(fAngle) * 40;
                qreal y = 50 + sin(fAngle) * 40;
                p.drawPoint(QPointF(x, y));
                        i++;
        }
        p.end();
    }
} 
```

`QPainter::begin(this)`和`QPainter::end()`调用在第二个示例中是必不可少的。在第一个例子中，你可以想到在构造函数和析构函数中`QPainter::begin(this)`被调用`QPainter::end()`

出于这个原因，我猜：由于`QPaintDevice`s 通常在 QT4 中被双缓冲，`QPainter::end()`可能是图像被传输到图形内存的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T22:08:46.957

您需要使用要在其上绘制的小部件初始化画家。
通常这是使用带有 a 的构造函数完成的，`QPaintDevice`但您也可以通过调用`begin()`.

# c++ - 将应用设置为需要海拔高度？

> ID：707497
> 
> 赞同：6
> 
> 时间：2009-04-01T21:54:37.803
> 
> 标签：c++, visual-studio, windows-vista, manifest, process-elevation

我正在为我们的一些产品开发新安装程序的引导应用程序。到目前为止，我一直依赖于我在某处读到的两件事：

1.  默认情况下，名称包含“setup”或“install”的应用程序将运行提升。
2.  运行提升的应用程序将以提升模式启动其他应用程序。

最近的测试发现这些陈述中的一个或两个都是错误的，因为我正在启动的应用程序之一是需要提升的第三方安装程序，并且由于提升要求而失败。

如何将我的应用程序设置为需要提升？我知道这与清单文件有关。当我在 Visual Studio 2008 中工作并生成清单文件时，我想知道在项目属性中输入什么以及在哪里需要提升。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-02T00:32:46.737

当我找不到应用程序清单作为可以添加到我的项目的新项目时，我进入在线帮助并找到了这个：

> 在 Configuration Properties - Linker - Manifest File - UAC Execution Level (requireAdministrator) 中配置 VS2008

那成功了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T22:01:29.657

在 VS2008 中：添加新项目；应用程序清单文件（app.manifest；模板文件中的注释告诉您如何要求更多访问权限）。

您现在可以在“应用程序”选项卡上的项目属性中指定清单（但您需要取消选中“启用 Visual Studio 托管进程”才能对其进行调试）。

# excel - 我可以将 RegFree Com 与用 Excel VBA 编写的应用程序一起使用吗？

> ID：707499
> 
> 赞同：0
> 
> 时间：2009-04-01T21:56:44.647
> 
> 标签：excel, regfreecom, windows-vista, vba

我有一个用 Excel VBA 编写的应用程序 myApp.xls。目前我们使用 InstallShield 来分发应用程序。由于我们正在迁移到 Windows Vista，因此我需要能够以标准用户身份安装该应用程序。这不允许我在安装过程中更新注册表。除了 excel 应用程序，我们还有几个 VB6 应用程序。为了安装这些应用程序，我可以使用 RegFree com 和 Make My Manifest (MMM)，正如论坛上的人们所建议的那样（顺便说一句，我非常感谢您的见解！）。这个过程虽然有点乏味，但效果很好。然后，我将 MMM 的输出打包到 VS '05 安装程序项目中，并使用 msiinfo.exe 删除了 msi 上的 UAC 提示。现在我面临安装一个基本上存在于 Excel 文件中的应用程序。我修改了 MMM 为我的一个 VB6 应用程序创建的清单，并尝试通过它运行 excel 文件，但我运气不佳。有人知道这样做的方法吗？RegFree com 是否与 VBA 一起使用？任何想法或建议将不胜感激。

谢谢，

史蒂夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-19T08:56:42.150

是的，可以在 Win2k3+ 上通过 VBA 使用免注册 COM。

从根本上说，无注册表示“这个 COM 类不再需要注册才能被发现，而是注册信息将由清单携带”。

清单本身在嵌入到可执行文件或命名为 *.exe.manifest 时被可执行文件隐式引用。但是，在 VBA 的情况下——您的代码并不存在于您控制的可执行文件中，因此您需要另一种方法来获取对清单的引用。

这就是[Microsoft.Windows.ActCtx](http://msdn.microsoft.com/en-us/library/aa375644(VS.85).aspx)对象的用武之地——它特别允许您在给定显式清单引用的情况下实例化您的对象。

例如（在 JS 中，因为我对 VBA 语法生疏了）：

```
var actCtx = WScript.CreateObject("Microsoft.Windows.ActCtx");
actCtx.Manifest = "myregfree.manifest";
var obj =  actCtx.CreateObject("MyObj"); 
```

# security - 可以使用哪些方法来保护 Web 服务？

> ID：707503
> 
> 赞同：0
> 
> 时间：2009-04-01T21:57:30.790
> 
> 标签：security, soap, service

我很想知道人们使用什么方法来保护他们的 web 服务免受未经授权的 web 服务消费者的侵害。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T22:05:25.500

我通常要求每次都发送一个用户 ID/密码，或者从第一个经过身份验证的连接中返回一个令牌，以便随后使用。

没有什么花哨。非常类似于标准的 Web 应用程序登录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T22:14:42.747

我已经使用 SOAP 标头和方法参数来传递用户凭据——.NET 使使用 SOAP 标头非常容易，但我在使用 Java 时遇到了问题（几个月前）。如果服务不是供客户端（浏览器）使用，而是来自后端 Web 服务器，我也会进行一些基于 IP 的过滤。公共的、可浏览器使用的 Web 服务通常受到会话 cookie 的保护——即，需要有效登录到网站，然后使用标准会话身份验证机制通过 AJAX 向 Web 服务发出请求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T22:16:24.473

有一个专门用于 Web 服务安全性的协议[WS-Security](http://en.wikipedia.org/wiki/WS-Security)。我过去曾使用过它的一部分，但当时在.Net 中并没有太多的支持，所以工作量很大。

目前使用 .Net 我使用 SOAP 扩展标头。我有一个 Web 服务调用来进行身份验证并获取会话令牌，然后在每个后续调用的 SOAP 标头中包含该令牌，有点类似于这个[示例](http://www.codeguru.com/columns/experts/article.php/c5479)。当然，所有请求都必须通过 TLS 传输以防止它们受到损害。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-18T13:18:57.817

如果您不想在自己的应用程序中处理，您可以使用诸如 IBM 的 DataPower 或 Vordel 之类的网络设备。

# c# - C# 字符串约定解析

> ID：707508
> 
> 赞同：3
> 
> 时间：2009-04-01T21:58:14.143
> 
> 标签：c#, string, parsing

我对 C# 比较陌生，并且有一个用户输入字符串（我希望有效。）

该字符串将组成多个信息部分和子部分。

例如：

```
1-7 will //represent values 1 2 3 4 5 6 7

3:.25:7 //will be the numbers contained between 3 and 7 in increments of .25 
        // (3 3.25 3.5 3.75 4 ... 6.75 7)
1,4,5  //will represent values 1 4 5 
```

我希望能够遍历与此类似的单个字符串，并获得与用分号 (;) 分隔的数据一样多的数组

主要目标是解析如下内容：

```
1-7;3:.25:10;1,5,9;4-7 
```

由于上面有 4 个“数据集”，我应该创建 4 个包含值的新数组。如果我有 n 个“数据集”，我应该创建 n 个新数组。

稍后我想使用所有组合以嵌套方式遍历数组。

此外，如果可能（不需要），还可以对如下表示进行某种混合：

```
1-7,9,16:2:20; 
```

我希望我在这里试图完成的事情在我的例子中是有意义的。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T22:03:39.950

好吧，可能会有一个聪明的 RegEx 的答案，我会尝试使用我最喜欢的 string.Split() 函数。

作为第一步，您可以将输入字符串拆分为 ';'

```
string[] datasets = inputString.Split(';'); 
```

因为就您的最后一点而言，逗号“，”似乎或多或少相同，您可以将其合并`Split(';', ',')`或将它们分开

```
string[] parts = datasets[i].Split(','); 
```

零件是以下三种情况之一：单个数字、范围或阶梯范围。

你可以用`string.IndexOf()` 和/或探测它

```
string[] rangeParts = parts[j].Split('-');
string[] steppedParts = parts[j].Split(':'); 
```

结果应分别具有长度 2 和 3。

然后应该使用 TryParse() 检查生成的字符串，并且由于使用标点符号，您最好修复文化：

```
bool valid = double.TryParse(parts[k], 
  System.Globalization.NumberStyles.AllowDecimalPoint, 
  System.Globalization.CultureInfo.InvariantCulture, out value); 
```

这些是零件，需要一些组装。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T22:11:05.237

我建议使用正则表达式。起初我会用下面的表达式分成几个部分。

```
^((?<section>[^;]+)(;|$))+ 
```

然后将每个部分分成小节。

```
^((?<subsection>[^,]+)(,|$))+ 
```

现在匹配三种可能的小节类型。

```
(?<value>^[0-9]+$)|
(?<range>^[0-9]+-[0-9]+$)|
(?<rangewithstep>^[0-9]+:\.[0-9]+:[0-9]+$) 
```

最后，您必须分析范围类型的小节。

```
^(?<start>[0-9]+)-(?<end>[0-9]+)$

^(?<start>[0-9]+):(?<step>\.[0-9]+):(?<end>[0-9]+)$ 
```

现在是将提取的字符串解析为数字并将它们添加到数组中的问题。

* * *

我把所有东西放在一个小的控制台应用程序中。它远非完美 - 没有错误处理，没有任何东西，只是解析演示输入。我合并了前面提到的一些表达式，以使代码更紧凑并且可能更好。

```
using System;
using System.Text.RegularExpressions;
using System.Globalization;

namespace RangeParser
{
    class Program
    {
        static void Main(string[] args)
        {
            String input = "1-7,9,16:2:20;1-7; 3:.75 : 10;1,5,9;4-7";

            Match sections = (new Regex(@"^((?<section>[^;]+)(;|$))+")).Match(input.Replace(" ", ""));

            foreach (Capture section in sections.Groups["section"].Captures)
            {
                Console.Write("Section ");

                Match subsections = (new Regex(@"^((?<subsection>[^,]+)(,|$))+")).Match(section.Value);

                foreach (Capture subsection in subsections.Groups["subsection"].Captures)
                {
                    Match subsectionparts = (new Regex(@"^(?<start>[0-9]*\.?[0-9]+)(((:(?<step>[0-9]*\.?[0-9]+):)|-)(?<end>[0-9]*\.?[0-9]+))?$")).Match(subsection.Value);

                    if (subsectionparts.Groups["start"].Length > 0)
                    {
                        Decimal start = Decimal.Parse(subsectionparts.Groups["start"].Value, CultureInfo.InvariantCulture);
                        Decimal end = start;
                        Decimal step = 1;

                        if (subsectionparts.Groups["end"].Length > 0)
                        {
                            end = Decimal.Parse(subsectionparts.Groups["end"].Value, CultureInfo.InvariantCulture);

                            if (subsectionparts.Groups["step"].Length > 0)
                            {
                                step = Decimal.Parse(subsectionparts.Groups["step"].Value, CultureInfo.InvariantCulture);
                            }
                        }

                        Decimal current = start;

                        while (current <= end)
                        {
                            Console.Write(String.Format("{0} ", current));

                            current += step;
                        }
                    }
                }

                Console.WriteLine();
            }

            Console.ReadLine();
        }
    }
} 
```

**更新**

修改为允许“1.5:0.2:3.6”之类的内容。

**更新**

为什么使用十进制而不是单精度或双精度？

输入中的数字是十进制数字，不能精确地用单精度或双精度表示，因为它们使用以 2 为底的表示。因此，例如，0.1 由单个值 0.100000001490116119384765625 表示。

```
Single x = 0.0F;

for (int i = 0; i < 8; i++)
{
   x += 0.1F;
}

Console.WriteLine(x); 
```

该程序仅在 8 次迭代后将打印 0.8000001。1000 次迭代后，误差增长到 0.00095，显示 99.99905 而不是 100.0，并且在 100 万次迭代后，结果是 100,958.3 而不是 100,000。

十进制没有这样的错误，因为十进制使用以 10 为基数的表示，并且能够准确地表示像 0.1 这样的十进制数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T22:21:15.257

这里有一些 C# 代码应该做你想做的事：

```
 var results = ParseExpression("1-7;3:.25:10;1,5,9;4-7");

    private static List<List<float>> ParseExpression(string expression)
    {
        // "x-y" is the same as "x:1:y" so simplify the expression...
        expression = expression.Replace("-", ":1:");

        var results = new List<List<float>>();
        foreach (var part in expression.Split(';'))
            results.Add(ParseSubExpression(part));

        return results;
    }

    private static List<float> ParseSubExpression(string part)
    {
        var results = new List<float>();

        // If this is a set of numbers...
        if (part.IndexOf(',') != -1)
            // Then add each member of the set...
            foreach (string a in part.Split(','))
                results.AddRange(ParseSubExpression(a));
        // If this is a range that needs to be computed...
        else if (part.IndexOf(":") != -1)
        {
            // Parse out the range parameters...
            var parts = part.Split(':');
            var start = float.Parse(parts[0]);
            var increment = float.Parse(parts[1]);
            var end = float.Parse(parts[2]);

            // Evaluate the range...
            for (var i = start; i <= end; i += increment)
                results.Add(i);
        }
        else
            results.Add(float.Parse(part));

        return results;
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T01:06:41.397

以下对我的正则表达式解决方案的评论促使我进行分析。

> 这不是正则表达式有点过于丑陋的情况吗？我认为，直接的代码解决方案会更简单、更容易理解。- 叉

我的回答如下。

> 或许。我决定使用正则表达式，因为您可以涵盖所有情况（如果您的正则表达式正确）。如果你用 String.Split() 和朋友来做，如果输入有效，你会得到一个更简单的解决方案。但是使用字符串方法捕获所有无效输入可能真的很可怕。当我开始将一个数字解析为十进制时，我已经知道它是一个有效数字并且不会失败。或者想想像 '1-2-3;,-1:.:' 这样的输入 - 你会拆分它们，但稍后会崩溃，或者返回一个毫无意义的结果。在 David 的代码中，访问 part[2] 将超出输入 '1:2' 的范围，解析可能会失败，并且肯定还有一些未捕获的错误。全部捕获它们可能会使代码比正则表达式代码更不可读。– 丹布鲁克

所以我决定使用微软很棒的工具[PEX](http://research.microsoft.com/en-us/projects/Pex/)并分析我的正则表达式方法和大卫的字符串操作方法。我没有修改 David 的代码，并将解决方案中的控制台输出替换为生成结果的语句，`List<List<Decimal>>`就像 David 所做的那样。

为了使一个相当完整的分析可行，我限制 PEX 只生成少于 45 个字符的输入，并且只使用以下 9 个不同的字符。

```
019.;,-:! 
```

没有必要使用所有数字，因为它们（应该）表现得都一样。我包含 9 是为了便于发现溢出，但 0 和 1 也应该足够了 - PEX 可能会找到 1000 而不是 999。我包含 0 和 1 是为了发现像 0.000[...]001 这样的非常小的数字的错误但什么也没出现。我假设非常小的数字会默默地四舍五入为零，但我没有进一步调查。或者可能是 44（44 是因为 28 到 29 位的十进制精度加上其他字符的一些空间）字符太短以生成足够小的数字。包括其他字符，因为它们是输入中的其他有效字符。最后，我将感叹号作为无效字符的替代项。

分析结果证明我是对的。PEX 在我的代码中发现了两个错误。我不检查空输入（我故意跳过它以专注于重要部分）导致众所周知的 NullReferenceException 和 PEX 发现输入“9999999999999999999999999999999”导致 Decimal.Parse() 失败并出现 OverflowException。PEX 还报告了一些假阴性结果。例如，“!;9,;.0;990:!!:,900:09”被报告为导致 FormatException 的输入。重新运行生成的测试不会产生异常。事实证明，“.0”导致测试在探索过程中失败。查看其他失败的测试表明 Decimal.Parse() 在探索期间对于（所有）以小数点开头的输入失败。但它们是有效数字，在正常执行期间不会失败。

这是针对字符串操作解决方案运行 PEX 的结果。两种实现都共享缺少的空检查和溢出异常。但是简单的字符串操作解决方案无法处理许多格式错误的输入。它们几乎都导致 FormatException，但 PEX 还发现了我预测的 IndexOutOfRangeException。

```
FormatException:           "!,"
FormatException:           ","
FormatException:           "1,"
FormatException:           "!"
FormatException:           ";9"
FormatException:           "::"
FormatException:           "!.999009"
FormatException:           "!.0!99!9"
FormatException:           "0,9.90:!!,,,!,,,,,,!,,,0!!!9,!"
FormatException:           ""
FormatException:           "-99,9"
FormatException:           "1,9,,,!,,,,,,9,,,9,1,!9,,,,!,!"
FormatException:           "!:,"
FormatException:           "!9!:.!!,!!!."
FormatException:           "!:"
IndexOutOfRangeException:  "1:9"
FormatException:           "09..::!"
FormatException:           "9,0..:!.!,,,!,,,,,,!,,,!!-,!,!"
OverflowException:         "99999999999999999999999999999999999999999999"
FormatException:           "!."
FormatException:           "999909!!"
FormatException:           "-"
FormatException:           "9,9:9:999,,,9,,,,,,!,,,!9!!!,!"
FormatException:           "!9,"
FormatException:           "!.09!!0!"
FormatException:           "9-;"
FormatException:           ":"
FormatException:           "!.!9!9!!"
NullReferenceException:    null
FormatException:           ":,"
FormatException:           "!!"
FormatException:           "9;" 
```

现在的问题是，处理所有这些案件有多难。简单的解决方案是使用 try/catch 子句保护解析指令。我不确定这是否足以保证正确操作输入的格式良好的部分。但是，这可能不是必需的，并且格式错误的输入会导致空结果，这将使修复解决方案变得容易。

最后是实现的代码覆盖率结果。请注意，我使用小数和单数分析了正则表达式解决方案，因为 PEX 无法检测在 Decimal.Parse() 中使用的一种方法。

```
ParseExpression(string)            100,00%  10/10 blocks
ParseSubExpression(string)          96,15%  25/26 blocks

ParseExpressionRegex(string)        95,06%  77/81 blocks
ParseExpressionRegexSingle(string)  94,87%  74/78 blocks 
```

对我来说结论 - 一个正则表达式解决方案真的应该是首选。它们有点难以设计和理解，但它们处理格式错误的输入比简单的基于字符串操作的实现要健壮得多。而且不要忘记 - 我根本没有检查返回的结果是否正确。这是另一种情况。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-01T22:10:56.297

C# 中没有用于解析范围的约定，因此您可以自由地做任何最有意义的事情。

但是，您可能希望从数学中的[区间符号导出您的符号。](http://en.wikipedia.org/wiki/Interval_(mathematics))

```
[2,4] - numbers between 2 and 4
(0,7] - numbers between 0 and 7, but not including 0 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-01T22:03:48.810

我不确定我是否完全理解您的问题，但听起来您正在寻找[String.Split()](http://msdn.microsoft.com/en-us/library/system.string.split.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-01T22:13:14.887

好的，所以当我使用 Hank 的前两部分拆分字符串时（假设数据集中有 , ）

然后我可以进入并用剩余的信息填充一个数组。

对于 - 分隔的，我会取 - 之前的值，然后从那里执行一个 for 循环到之后的值。

对于 : 分隔的那些，我做几乎相同的事情，除了在 for 循环更新时不是 i++ 增量，而是我做一个 i+= （中间值）。

要解析 - 或 : 字符之前和之后的值，我可以再次拆分并知道数组中的哪些索引对应于什么。

谢谢，

明天我会用我的最终解决方案更新这个。

如果 Henk Holterman 想用我上面所说的（解析其他部分的描述）更新他的解决方案，我会在我的家庭帐户上投票。出于某种原因，他们在这里阻止了 openID。

旁注：我不明白为什么即使作为客人他们也不让我接受解决方案，如果我提供正确的电子邮件地址，我应该能够接受吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-01T22:18:37.107

首先在分号上拆分字符串以获取单独的集合。然后用逗号分割每个集合以获得集合中的单独数字或范围。

您现在拥有的字符串可以是：

*   一个数字，比如`42`

*   一系列数字，例如`1-7`

*   步进范围，例如`1:.5:7`

您可以通过检查字符串是否包含连字符或冒号来识别第二个和第三个。然后，您将拆分这些字符串并进行一些循环以将数字添加到集合中。

通过像这样处理同一级别的数字和范围，它们可以完全按照您的需要混合。

一些技巧：

使用 double.TryParse 解析数字。使用`CultureInfo.InvariantCulture`as 格式提供程序，它使用句点作为小数分隔符。

您可以使用 a`List<double>`来保存每组的数字。最终结果可以是一个列表数组，也可以使用 ToArray 方法从列表中创建一个数组（如果您想要一个数组）。

# objective-c - Objective-C 中的 typedef 枚举是什么？

> ID：707512
> 
> 赞同：1103
> 
> 时间：2009-04-01T21:59:43.937
> 
> 标签：objective-c, enums, typedef

我认为我从根本上不了解 an`enum`是什么以及何时使用它。

例如：

```
typedef enum {
    kCircle,
    kRectangle,
    kOblateSpheroid
} ShapeType; 
```

这里真正宣布的是什么？

* * *

## 回答 #1

> 赞同：1576
> 
> 时间：2009-04-01T22:22:20.217

这里声明了三件事：声明了一个匿名枚举类型，`ShapeType`声明了该匿名枚举的 typedef，三个名称`kCircle`、、`kRectangle`和`kOblateSpheroid`声明为整数常量。

让我们分解一下。在最简单的情况下，可以将枚举声明为

```
enum tagname { ... }; 
```

这声明了一个带有标签的枚举`tagname`。在 C 和 Objective-C（但*不是*C++）中，对 this 的任何引用都*必须*以`enum`关键字开头。例如：

```
enum tagname x;  // declare x of type 'enum tagname'
tagname x;  // ERROR in C/Objective-C, OK in C++ 
```

为了避免必须在`enum`任何地方使用关键字，可以创建 typedef：

```
enum tagname { ... };
typedef enum tagname tagname;  // declare 'tagname' as a typedef for 'enum tagname' 
```

这可以简化为一行：

```
typedef enum tagname { ... } tagname;  // declare both 'enum tagname' and 'tagname' 
```

最后，如果我们不需要能够`enum tagname`与`enum`关键字一起使用，我们可以将其设为`enum`匿名并仅使用 typedef 名称声明它：

```
typedef enum { ... } tagname; 
```

现在，在这种情况下，我们声明`ShapeType`为匿名枚举的类型定义名称。 `ShapeType`实际上只是一个整数类型，并且只能用于声明包含声明中列出的值之一的变量（即`kCircle`,`kRectangle`和之一`kOblateSpheroid`）。但是，您可以通过强制转换为变量分配`ShapeType`另一个值，因此在读取枚举值时必须小心。

最后，`kCircle`、`kRectangle`和`kOblateSpheroid`被声明为全局命名空间中的整数常量。由于没有指定特定值，因此它们被分配给从 0 开始的连续整数，因此`kCircle`是 0、1`kRectangle`和`kOblateSpheroid`2。

* * *

## 回答 #2

> 赞同：263
> 
> 时间：2013-03-06T09:43:16.203

Apple 建议从**Xcode 4.4**开始定义这样的枚举：

```
typedef enum ShapeType : NSUInteger {
    kCircle,
    kRectangle,
    kOblateSpheroid
} ShapeType; 
```

他们还提供了一个方便的宏`NS_ENUM`：

```
typedef NS_ENUM(NSUInteger, ShapeType) {
    kCircle,
    kRectangle,
    kOblateSpheroid
}; 
```

这些定义提供了更强大的类型检查和更好的代码完成。我找不到 的官方文档，但您可以在[此处](https://developer.apple.com/videos/play/wwdc2012/413/)`NS_ENUM`观看来自 WWDC 2012 会议的“现代 Objective-C”视频。

* * *

**更新链接到**[这里](https://developer.apple.com/library/ios/releasenotes/ObjectiveC/ModernizationObjC/AdoptingModernObjective-C/AdoptingModernObjective-C.html#//apple_ref/doc/uid/TP40014150-CH1-SW6)
的官方文档。

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2012-03-15T16:31:57.370

枚举声明了一组有序值 - typedef 只是为其添加了一个方便的名称。第一个元素是 0 等等。

```
typedef enum {
Monday=1,
...
} WORKDAYS;

WORKDAYS today = Monday; 
```

以上只是shapeType标签的枚举。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2009-04-01T22:04:21.930

用户定义的类型，其可能值为`kCircle`、`kRectangle`或`kOblateSpheroid`。但是，枚举内部的值（kCircle 等）在枚举外部是可见的。记住这一点很重要（`int i = kCircle;`例如是有效的）。

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2014-01-29T13:08:25.027

**64 位更改更新：** 根据关于 64 位更改的[苹果文档](https://developer.apple.com/library/ios/documentation/General/Conceptual/CocoaTouch64BitGuide/ConvertingYourAppto64-Bit/ConvertingYourAppto64-Bit.html#//apple_ref/doc/uid/TP40013501-CH3-SW1)，

> 枚举也有类型：在 LLVM 编译器中，枚举类型可以定义枚举的大小。这意味着某些枚举类型的大小也可能比您预期的要大。与所有其他情况一样，解决方案是不对数据类型的大小做出任何假设。相反，将任何枚举值分配给具有正确数据类型的变量

因此，如果您支持 64 位，则必须**创建类型**如下语法的枚举。

```
typedef NS_ENUM(NSUInteger, ShapeType) {
    kCircle,
    kRectangle,
    kOblateSpheroid
}; 
```

或者

```
typedef enum ShapeType : NSUInteger {
   kCircle,
   kRectangle,
   kOblateSpheroid
} ShapeType; 
```

否则会导致警告为`Implicit conversion loses integer precision: NSUInteger (aka 'unsigned long') to ShapeType`

**快速编程更新：**

很快，语法发生了变化。

```
enum ControlButtonID: NSUInteger {
        case kCircle , kRectangle, kOblateSpheroid
    } 
```

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2013-03-10T18:23:21.233

enum（枚举的缩写）用于枚举一组值（枚举数）。值是由符号（一个词）表示的抽象事物。例如，一个基本的枚举可以是

```
enum { xs,s,m,l,xl,xxl,xxxl,xxxxl }; 
```

这个枚举被称为匿名，因为你没有一个符号来命名它。但这仍然是完全正确的。像这样使用它

```
enum { xs,s,m,l,xl,xxl,xxxl,xxxxl } myGrandMotherDressSize; 
```

行。生活是美好的，一切都很顺利。但是有一天你需要重用这个枚举来定义一个新的变量来存储 myGrandFatherPantSize，然后你写：

```
enum { xs,s,m,l,xl,xxl,xxxl,xxxxl } myGrandMotherDressSize;
enum { xs,s,m,l,xl,xxl,xxxl,xxxxl } myGrandFatherPantSize; 
```

但是你有一个编译器错误“枚举器的重新定义”。实际上，问题在于编译器不确定您首先枚举并且您第二次描述相同的事物。

然后，如果您想在多个地方重用相同的枚举数集（此处为 xs...xxxxl），则必须使用唯一名称对其进行标记。第二次使用此设置时，您只需使用标签。但是不要忘记，这个标签不会替换枚举词，而只是替换枚举数的集合。然后照常注意使用枚举。像这样：

```
// Here the first use of my enum
enum sizes { xs,s,m,l,xl,xxl,xxxl,xxxxl } myGrandMotherDressSize; 
// here the second use of my enum. It works now!
enum sizes myGrandFatherPantSize; 
```

您也可以在参数定义中使用它：

```
// Observe that here, I still use the enum
- (void) buyANewDressToMyGrandMother:(enum sizes)theSize; 
```

您可以说到处重写枚举并不方便，并且使代码看起来有点奇怪。你说的对。真正的类型会更好。

这是我们向峰会迈进的最后一步。通过添加一个 typedef 让我们将我们的枚举转换为一个真正的类型。哦，最后一件事，你的班级中不允许使用 typedef。然后在上面定义你的类型。像这样做：

```
// enum definition
enum sizes { xs,s,m,l,xl,xxl,xxxl,xxxxl };
typedef enum sizes size_type

@interface myClass {
   ...
   size_type myGrandMotherDressSize, myGrandFatherPantSize;
   ...
} 
```

请记住，标签是可选的。然后从这里开始，在这种情况下，我们不标记枚举器，而只是定义一个新类型。然后我们就不再需要它了。

```
// enum definition
typedef enum { xs,s,m,l,xl,xxl,xxxl,xxxxl } size_type;

@interface myClass : NSObject {
  ...
  size_type myGrandMotherDressSize, myGrandFatherPantSize;
  ...
}
@end 
```

如果您使用 XCode 在 Objective-C 中进行开发，我会让您发现一些以 NS_ENUM 为前缀的不错的宏。这应该可以帮助您轻松地定义好的枚举，而且还可以帮助静态分析器在编译之前为您做一些有趣的检查。

好枚举！

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2013-06-18T06:03:00.497

`typedef`对于重新定义现有变量类型的名称很有用。它提供了调用数据类型的简短而有意义的方式。例如：

```
typedef unsigned long int TWOWORDS; 
```

在这里，unsigned long int 类型被重新定义为 TWOWORDS 类型。因此，我们现在可以通过编写声明 unsigned long int 类型的变量，

```
TWOWORDS var1, var2; 
```

代替

```
unsigned long int var1, var2; 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2013-12-25T06:14:40.227

```
typedef enum {
kCircle,
kRectangle,
kOblateSpheroid
} ShapeType; 
```

那么你可以像这样使用它：-

```
 ShapeType shape; 
```

和

```
 enum {
    kCircle,
    kRectangle,
    kOblateSpheroid
} 
ShapeType; 
```

现在您可以像这样使用它：-

```
enum ShapeType shape; 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-03-16T12:45:55.773

enum 用于为枚举元素分配值，这在 struct 中无法完成。所以每次我们可以通过分配给枚举变量的值来代替访问完整的变量。默认情况下，它以 0 赋值开始，但我们可以为它分配任何值，枚举中的下一个变量将被分配一个前一个值 +1 的值。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-03-30T09:41:17.540

您可以使用以下格式，原始默认值从 0 开始，所以

*   kCircle 为 0，
*   kRectangle 为 1，
*   kOblateSpheroid 为 2。

您可以分配自己的特定起始值。

```
typedef enum : NSUInteger {
    kCircle, // for your value; kCircle = 5, ...
    kRectangle,
    kOblateSpheroid
} ShapeType;

ShapeType circleShape = kCircle;
NSLog(@"%lu", (unsigned long) circleShape); // prints: 0 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-12-27T22:42:40.373

typedef 允许程序员将一种 Objective-C 类型定义为另一种。例如，

typedef int 计数器；将类型 Counter 定义为等效于 int 类型。这极大地提高了代码的可读性。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-11-16T12:33:54.373

Typedef 是 C 和 C++ 中的关键字。它用于为基本数据类型**（char、int、float、double、struct 和 enum）**创建新名称。

```
typedef enum {
    kCircle,
    kRectangle,
    kOblateSpheroid
} ShapeType; 
```

在这里，它创建了枚举数据类型**ShapeType & 我们可以为枚举类型****ShapeType**编写新名称，如下所示

```
ShapeType shape1; 
ShapeType shape2; 
ShapeType shape3; 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-06-21T06:29:25.800

enum 可以减少许多类型的“错误”，并使代码更易于管理

```
#define STATE_GOOD 0
#define STATE_BAD 1
#define STATE_OTHER 2
int STATE = STATE_OTHER 
```

该定义没有约束。这只是一个替代品。它不能限制状态的所有条件。当STATE赋值为5时，程序会出错，因为没有匹配的状态。但是编译器不会警告 STATE = 5

所以最好这样使用

```
typedef enum SampleState {
    SampleStateGood  = 0,
    SampleStateBad,
    SampleStateOther
} SampleState;

SampleState state = SampleStateGood; 
```

# html - page-flip.com - 使 Flash Stage 更小

> ID：707513
> 
> 赞同：0
> 
> 时间：2009-04-01T22:00:29.130
> 
> 标签：html, css, flash

我正在寻找一种方法来缩小 Flash 文件的高度。我可以更改宽度，但高度似乎与它所在的窗口大小有关？

[http://www.bevelite.com.au/test](http://www.bevelite.com.au/test)

我正在使用[page-flip.com](http://www.page-flip.com)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T23:06:58.940

尝试 ：

```
stage.scaleMode = StageScaleMode.NO_SCALE; 
```

编辑：

根据 Evilpenguin 的评论，当然，如果您要嵌入无法重新编译的 SWF，则必须在 HTML 嵌入 ( `scale="noscale"`) 中从外部设置此值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T23:23:20.443

感谢您的指点，但事实证明我需要删除对“brochure.js”文件的引用，因为它是一个根据窗口高度减去页脚高度自动计算高度的函数。有点奇怪，这在文档中没有提到..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T23:24:38.867

无法弄清楚你到底在哪里做嵌入。您应该将`scale="none"`属性添加到 embed 标记。

# c# - 打印转换后的 XML

> ID：707518
> 
> 赞同：2
> 
> 时间：2009-04-01T22:03:01.557
> 
> 标签：c#, xml, winforms

由于我无法控制的情况，我正在用自制的 XML 报告替换我们所有的 Crystal Reports，它们运行良好。对于弹出 Crystal Reports 查看器的大多数报表，以下代码可以在 IE 中很好地打开它们，并通过 XSLT 样式表将其转换为 HTML。

```
ProcessStartInfo psi = new ProcessStartInfo(reportFilename)
{
   UseShellExecute = true
};

using (Process p = new Process {StartInfo = psi})
{
    p.Start();
} 
```

问题是一些报告只是直接打印到打印机，从不向用户显示报告，这在 CR 中工作正常。我无法弄清楚如何使用上面的代码来做到这一点。

如果可能，我不希望专门启动 IE 进程，但我保证它们运行的​​是 Windows，所以这不是硬性要求。此外，以这种方式直接打印会通过 XSL 将 XML 转换为 HTML 并打印，还是只打印实际的 XML 文本？

**编辑**：我已经尝试添加：

```
Verb = "Print" 
```

到 ProcessStartInfo 对象，但最终抛出异常：

```
"No application is associated with the specified file for this operation" 
```

**再次编辑**：将 IE 指定为要启动的 exe 再次加载 XML 就好了，但不提供“打印”操作。在 JavaScript 块中添加“window.print()”是可行的，但需要在允许脚本运行后手动单击打印按钮，因为 IE 会阻止它。

**编辑第三**：我的老板告诉我不要担心，他们可以从 IE 打印。我仍然想弄清楚这一点。我已经尝试过命令行“print.exe”，但这只会将原始 XML 打印到打印机。使用 PrintDocument 尝试了 XslCompiledTransform，但这也不是我想要的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T15:20:35.713

终于想通了 我刚刚创建了一个不可见的 WebBrowser 控件来进行 IE 渲染，并在 DocumentCompleted 上调用它的 Print() 方法。使用默认打印机设置就像一个魅力。

```
private static void PrintReport(string reportFilename)
{
    WebBrowser browser = new WebBrowser();

    browser.DocumentCompleted += browser_DocumentCompleted;

    browser.Navigate(reportFilename);
}

private static void browser_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
{
    WebBrowser browser = sender as WebBrowser;

    if (null == browser)
    {
        return;
    }

    browser.Print();

    browser.Dispose();
} 
```

# scons - 在 scons 中，如何注入要构建的目标？

> ID：707530
> 
> 赞同：6
> 
> 时间：2009-04-01T22:05:41.550
> 
> 标签：scons

我想注入一个“清理”目标，该目标取决于在它关闭之前完成的许多其他目标以及 gzip 的一些日志文件。重要的是我不要过早使用 gzip，因为这会导致某些工具失败。

如何为 Scons 注入清理目标以执行？

例如，我有目标 foo 和 bar。我想注入一个名为“cleanup”的新自定义目标，它依赖于 foo 和 bar 并在它们都完成后运行，而无需用户指定

```
% scons foo cleanup 
```

我希望他们输入：

```
% scons foo 
```

但是让 scons 像用户输入的一样执行

```
% scons foo cleanup 
```

我已经尝试创建清理目标并附加到 sys.argv，但似乎 scons 在到达我的代码时已经处理了 sys.argv，因此它不会处理我手动附加到的“清理”目标系统.argv。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-03-11T13:43:12.177

您不应该使用`_Add_Targets`或未记录的功能，您只需将清理目标添加到`BUILD_TARGETS`：

```
from SCons.Script import BUILD_TARGETS
BUILD_TARGETS.append('cleanup') 
```

如果您使用此记录的目标列表而不是未记录的函数，则 scons 在进行簿记时不会感到困惑。此评论块可在以下位置找到`SCons/Script/__init__.py`：

```
# BUILD_TARGETS can be modified in the SConscript files.  If so, we
# want to treat the modified BUILD_TARGETS list as if they specified
# targets on the command line.  To do that, though, we need to know if
# BUILD_TARGETS was modified through "official" APIs or by hand.  We do
# this by updating two lists in parallel, the documented BUILD_TARGETS
# list, above, and this internal _build_plus_default targets list which
# should only have "official" API changes.  Then Script/Main.py can
# compare these two afterwards to figure out if the user added their
# own targets to BUILD_TARGETS. 
```

所以我想它是为了改变`BUILD_TARGETS`而不是调用内部帮助函数

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-02T06:49:04.600

一种方法是让 gzip 工具依赖于日志文件的输出。例如，如果我们有这个 C 文件，'hello.c'：

```
#include <stdio.h>
int main()
{
    printf("hello world\n");
    return 0;
} 
```

而这个 SConstruct 文件：

```
#!/usr/bin/python
env = Environment()
hello = env.Program('hello', 'hello.c')
env.Default(hello)
env.Append(BUILDERS={'CreateLog':
    Builder(action='$SOURCE.abspath > $TARGET', suffix='.log')})
log = env.CreateLog('hello', hello)
zipped_log = env.Zip('logs.zip', log)
env.Alias('cleanup', zipped_log) 
```

然后运行“scons cleanup”将以正确的顺序运行所需的步骤：

```
gcc -o hello.o -c hello.c
gcc -o hello hello.o
./hello > hello.log
zip(["logs.zip"], ["hello.log"]) 
```

这不是您指定的内容，但此示例与您的要求之间的唯一区别是“清理”是实际创建 zip 文件的步骤，因此这是您必须运行的步骤。它的依赖关系（运行生成日志的程序，创建该程序）是自动计算的。您现在可以按如下方式添加别名“foo”以获得所需的输出：

```
env.Alias('foo', zipped_log) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T16:20:37.637

在 SCons 的 1.1.0.d20081104 版本中，您可以使用私有内部 SCons 方法：

```
SCons.Script._Add_Targets( [ 'MY_INJECTED_TARGET' ] ) 
```

如果用户键入：

```
% scons foo bar 
```

上面的代码片段将导致 SCons 表现得好像用户输入了：

```
% scons foo bar MY_INJECTED_TARGET 
```

# ms-access - 如何从驻留在 Microsoft Office 访问类对象中的模块执行代码

> ID：707533
> 
> 赞同：2
> 
> 时间：2009-04-01T22:07:01.640
> 
> 标签：ms-access, vba

是否可以从外部模块执行 MS Access 中的表单之外的代码？在 VBA 中调用的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T22:30:11.163

这绝对是可能的。它必须是公共子或函数，并且必须在当时加载表单。

```
Forms("FormName").SubOrFunction 
```

# apache-flex - Flex 中数组集合的反序列化错误：RangeError：错误 #2006

> ID：707535
> 
> 赞同：1
> 
> 时间：2009-04-01T22:07:19.753
> 
> 标签：apache-flex, actionscript-3, serialization, blazeds, amf

我在序列化过程中收到此错误：

> RangeError：错误 #2006：提供的索引超出范围。AbstractMessage.as 尝试读取时间戳的输入时发生错误。

之后，我的故障处理程序收到此错误：

> faultCode:Server.Acknowledge.Failed faultString:'没有收到确认消息' faultDetail:'期待 mx.messaging.messages.AcknowledgeMes​​sage，但收到 null'

它似乎是由于**ArrayCollection**从服务器返回而发生的。

是否有必要创建自定义类来处理带有自定义对象的 ArrayCollections 序列化，如此处[所示](http://iamjosh.wordpress.com/2007/12/12/serialization-of-custom-collections-for-flex-data-services/)？

我也按照[这里](http://www.brooksandrus.com/blog/2008/03/25/flex-air-serialization-lessons-learned/)的序列化建议没有运气。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T17:25:37.357

解决方案是纠正 Java 端 writeExternal 中的错误。我对序列化的顺序非常小心，但是使用 writeObject 将 int 作为对象编写。这将在客户端尝试 readInt 后导致完全不相关的代码出错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-23T13:29:41.507

我自己也遇到了这个错误，原来是Flash Builder网络监视器被启用引起的！！FB 4.0.1 这是。

我因为找不到原因而发疯，所以在这里分享它以让您安心。

# mysql - “无法转换为 SELECT 语句”这是什么意思

> ID：707537
> 
> 赞同：0
> 
> 时间：2009-04-01T22:07:32.857
> 
> 标签：mysql, optimization

我试图让我们的 mySQL 数据库运行得更快，我分析了我们的慢查询日志，最常见的慢查询是这样的：

```
CREATE TABLE IF NOT EXISTS `wp_bad_behavior` (
    `id` INT(11) NOT NULL auto_increment,
    `ip` TEXT NOT NULL,
    `date` DATETIME NOT NULL default '0000-00-00 00:00:00',
    `request_method` TEXT NOT NULL,
    `request_uri` TEXT NOT NULL,
    `server_protocol` TEXT NOT NULL,
    `http_headers` TEXT NOT NULL,
    `user_agent` TEXT NOT NULL,
    `request_entity` TEXT NOT NULL,
    `key` TEXT NOT NULL,
    INDEX (`ip`(15)),
    INDEX (`user_agent`(10)),
    PRIMARY KEY (`id`) ); 
```

我试图理解为什么这个查询不断被调用，因为在表设置后它不应该继续发生。

对此的解释结果是：无法转换为 SELECT 语句。

任何关于这方面的想法都会很棒！

保罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T23:18:32.843

EXPLAIN 仅适用于 SELECT 查询，这就是它抱怨的原因。至于为什么查询在慢查询日志中：要么它被删除并重新创建 - 检查常规查询日志中的 DROP TABLEs - 或者它只是因为表/数据库繁忙而阻塞 - 首先检查其他慢查询，尤其是那些在同一张桌子上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T22:36:31.227

当然，您不能将 CREATE 语句转换为 SELECT 语句...

因此，问题是，为什么如此频繁地调用创建语句。它使用 mysql 的 IF NOT EXISTS，因此它甚至可能不是设计问题，尽管查询被称为 bazillion 次，但该表只会创建一次。也许您使用数据库的系统会从每个方法发出此语句，以确保实际数据库结构符合其预期。万一有人删除了这个超级重要的表，这只是一个傻瓜。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T22:52:49.473

它可能是一种从删除表的人中恢复的简单方法。有人会删除该表的一个很好的理由是，这是一种摆脱旧日志文件的简单方法。但是，这显然会影响性能，因此您应该检查没有代码正在删除表，然后删除此检查。然后，您将需要在删除旧日志时手动重新创建表。

# .net - 如何将不同组件中的对象相互转换？

> ID：707545
> 
> 赞同：0
> 
> 时间：2009-04-01T22:10:21.663
> 
> 标签：.net, assemblies

我遇到了这个显然并不少见的问题——

1.  我在程序集 A 中有一个接口。

2.  我正在动态加载程序集 B，并尝试将其中的对象从程序集 A 投射到我的界面中。

3.  它因 InvalidCastException 而失败。

我已经明白为什么 - 程序集 A 中的一个类和程序集 B 中的一个类，即使具有相同的名称和相同的代码，也不是一回事，不能相互转换。

我的问题是：有解决办法吗？有什么方法可以使这两种类型兼容，还是需要在程序集 B 中复制我的接口并将对象转换为该类型？

我正在使用 Assembly.LoadFrom 加载程序集 B——是否有不同的方法可以使它们类型兼容？

我不可能是第一个遇到这个问题的人。我正在尝试做的似乎是插件架构的一项相当常见的任务。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-01T22:12:36.153

复制不是答案。程序集 B 是否可以引用程序集 A 并从那里使用接口（或其他）？

如果不是，请在程序集 A 和程序集 B 都引用的独立 dll 中声明接口（或其他）。然后只有 1 个版本的界面，一切正常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T22:12:49.083

您绝对可以从一个程序集中的类型转换为另一个程序集中的类型 - 否则我们永远无法从`object`:)

我怀疑问题是接口已单独加载 - 我怀疑您的程序集 B 已*再次*加载程序集 A （可能从其他地方？）。

你的文件布局是什么样的？如果您从不同的目录加载程序集 B，并且它的目录中有程序集 A 的副本，则可能是从那里加载它。程序集加载和绑定是一项棘手的工作。我建议掌握“通过 C# 进行 CLR”并非常仔细地阅读有关它的章节，和/或[打开 Fusion 日志记录](http://blogs.msdn.com/suzcook/archive/2003/05/29/57120.aspx)以查看发生了什么。

（顺便说一下，我假设程序集 B 中的类型*确实*实现了程序集 A 中的接口？如果不是，那将解释它！）

顺便说一句，我有一篇[相当老的文章](http://www.yoda.arachsys.com/csharp/plugin.html)可以作为这方面的教程。它可能会有所帮助。

# wcf - Amazon Elastic Cloud 和 Silverlight 部署

> ID：707551
> 
> 赞同：0
> 
> 时间：2009-04-01T22:12:50.863
> 
> 标签：wcf, silverlight, amazon-ec2, amazon

我们正在尝试在 Amazon EC2 上托管一个 Silverlight 应用程序。

我可以让它提供 .xap 文件，但是我在使用 silverlight 应用程序所需的 web 服务时遇到了一些麻烦。

通常我会在 Visual Studio 中添加服务引用并输入 Web 服务的 URL，例如[http://url.com/ServiceName.svc](http://url.com/ServiceName.svc)，然后会为我生成一个代理。

但是，随着 Amazon Elastic Cloud 实例输入 url

[http://ec2-174-129-139-48.compute-1.amazonaws.com/AuthService.svc](http://ec2-174-129-139-48.compute-1.amazonaws.com/AuthService.svc)

给出错误“不被识别为已知的文档类型”

如果我进入

[http://ec2-174-129-139-48.compute-1.amazonaws.com/AuthService.svc?wsdl](http://ec2-174-129-139-48.compute-1.amazonaws.com/AuthService.svc?wsdl)

在 Internet Explorer 地址栏中，我得到一个 wsdl 描述 - 但它在配置中有这部分，这似乎有点奇怪

```
<wsdl:types>
<xsd:schema targetNamespace="http://asp.net/ApplicationServices/v200/Imports">
  <xsd:import schemaLocation="http://ip-0af8db15/AuthService.svc?xsd=xsd0" namespace="http://asp.net/ApplicationServices/v200" /> 
  <xsd:import schemaLocation="http://ip-0af8db15/AuthService.svc?xsd=xsd1" namespace="http://schemas.microsoft.com/2003/10/Serialization/" /> 
  </xsd:schema>
  </wsdl:types> 
```

schemaLocation [http://ip-0af8db15/AuthService.svc](http://ip-0af8db15/AuthService.svc)？对我来说，这不是正确的地址吗？

任何人都知道我是否需要配置或更改某些内容以访问 Amazon EC2 上的 WCF Web 服务？

编辑：应注意：Windows Server 2003、IIS 6.0

编辑：看起来 ip-0af8db15 是机器名称

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-12-07T18:10:05.583

以防万一有人遇到同样的问题：在代理生成时尝试删除 EC2 地址开头的 http://，然后在服务配置中将“ip-0af8db15”部分替换为 EC2 地址。

希望它有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T00:34:12.520

这个线程（特别是最后两个帖子）帮助我解决了这个问题。

[http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/c7fd51a2-773e-41d4-95a0-244e925597fe/](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/c7fd51a2-773e-41d4-95a0-244e925597fe/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T22:18:29.570

我部署了相同的场景，没有任何问题。为什么不尝试使用 IP 地址而不是动态主机名：

[http://174.129.139.48/AuthService.svc](http://174.129.139.48/AuthService.svc)

编辑：

如果将无法访问的服务器名称放入 VS.Net 生成的代理中，则可以在自动生成的 configuration.svcinfo 中手动调整它。或者，您可以以编程方式设置 URL，这是一个更好的选择，因为如果您需要重新生成代理，它不会被覆盖。

```
BasicHttpBinding binding = new BasicHttpBinding();
EndpointAddress address = new EndpointAddress("http://174.129.139.48/AuthService.svc");
YourProxy yourProxy = new YourProxy(binding, address); 
```

# php - 阵列克隆的性能

> ID：707554
> 
> 赞同：3
> 
> 时间：2009-04-01T22:13:55.743
> 
> 标签：php, performance, arrays

我们都知道

```
$a1 = array('foo');
$a2 = $a1;
$a2[0] = 'bar';
// now $a1[0] is foo, and $a2[0] is bar. The array is copied 
```

但是，我记得读过但无法通过谷歌搜索确认的是，在内部，数组在被修改之前不会被复制。

```
$a1 = array('foo');
$a2 = $a1; // <-- this should make a copy
// but $a1 and $a2 point to the same data internally
$a2[0] = 'bar';
// now $a1[0] is foo, and $a2[0] is bar. The array is really copied 
```

我想知道这是不是真的。如果是这样，那就太好了。当传递一个大数组时，它会提高性能，但无论如何只能从它读取（在创建一次之后）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-01T22:47:34.167

它可能比你想知道的要多，但是[这篇文章](http://derickrethans.nl/files/phparch-php-variables-article.pdf)很好地描述了变量在 PHP 中的工作方式。

一般来说，在绝对必要之前不会复制变量是正确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T22:33:11.343

我似乎已经证实了这一点：

```
<?php

ini_set('memory_limit', '64M');

function ttime($m) {
    global $s;
    echo $m.': '.(microtime(true) - $s).'<br/>';
    $s = microtime(true);
}

function aa($a) {
    return $a;
}

$s = microtime(true);
for ($i = 0; $i < 200000; $i++) {
    $array[] = $i;
}
ttime('Create');
$array2 = aa($array); // or $array2 = $array
ttime('Copy');
$array2[1238] = 'test';
ttime('Modify'); 
```

给出：

```
Create: 0.0956180095673
Copy: 7.15255737305E-6
Modify: 0.0480329990387 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T22:18:49.100

我相信你在这里是正确的。我将尝试查找有关此的文档...我找不到有关此的任何信息，但我确信我在某处读过它。希望这里的人能更好地找到文档。

# asp.net - Microsoft 的 ASP.NET Ajax 的效率如何？

> ID：707559
> 
> 赞同：1
> 
> 时间：2009-04-01T22:16:09.513
> 
> 标签：asp.net, ajax, asp.net-ajax

是否有任何关于 Microsoft 的 ASP.NET Ajax 效率的研究？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T22:38:06.277

如果出于某种原因您决定使用 MS Ajax 工具包而不是类似 jQuery 或 YUI 的东西，那么您可以做一些事情来显着提高性能。

**在脚本资源处理程序上启用缓存**

在您的 web.config 中：

```
<system.web.extensions>
  <scripting>
    <scriptResourceHandler enableCompression=“true” enableCaching=“true”/>
  </scripting>
</system.web.extensions> 
```

**脚本组合**

使用`CompositeScript`ASP.NET 3.5 的特性将所有 MS Ajax 脚本组合到一个文件中，从而节省您的 HTTP 请求（此框架默认生成大量它们！）。

```
<asp:ScriptManager ID=”ScriptManager″ runat=”server” EnablePartialRendering=”false” ScriptMode=”Release” LoadScriptsBeforeUI=”false”&gt;
    <CompositeScript>
        <Scripts>
            <asp:ScriptReference Name=”MicrosoftAjax.js” />
            <asp:ScriptReference Name=”AjaxControlToolkit.Common.Common.js” Assembly=”AjaxControlToolkit, Version=3.0.20229.23352, Culture=neutral, PublicKeyToken=28f01b0e84b6d53e” />
            .... etc
        </Scripts>
    </CompositeScript>
</asp:ScriptManager> 
```

要找出每个页面调用的脚本，您可以使用Codeplex 上提供的[ScriptReferenceProfiler 。](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=13356)

至于使用这个框架是否明智，有几点需要考虑。

*   如上所述，您的应用程序是面向公众还是面向 Intranet？如果它没有被提供给互联网，那么性能就不是那么重要了。

*   您的应用程序是使用 Web 表单还是 MVC 开发的？

*   如果您使用 web 表单，MS Ajax 工具包与该模型相当和谐地工作，特别是如果您参与整个 RAD 拖放样式开发。

*   然而，对于 MVC 来说，jQuery 是一个更好的合作伙伴，微软在某种程度上也承认了这一点，因为他们将把 jQuery（和智能感知支持）与即将推出的 Visual Studio 版本捆绑在一起。

*   MS Ajax 无疑是一个比许多替代方案重得多的框架。另一个与性能无关的批评是它有点像黑匣子，很难调试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T22:25:54.560

我不确定研究，但我自测试版以来一直在使用它，我不得不说它更适合您不太关心页面大小或加载时间的 Intranet 类型的应用程序。

如果我正在建立一个面向公众的网站，我不会使用它。我会一起使用 MVC 和 Jquery 或不同的平台。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T22:34:53.463

Microsoft 的 Ajax（特别是更新面板）存在一些性能问题。

与其试图解释它，不如看看这篇 MSDN 杂志文章。

[http://msdn.microsoft.com/en-us/magazine/cc163363.aspx](http://msdn.microsoft.com/en-us/magazine/cc163363.aspx)

具体而言，图 7 显示了请求和响应的大小。

# javascript - 如何使用 Javascript 添加 CSS？

> ID：707565
> 
> 赞同：200
> 
> 时间：2009-04-01T22:19:10.817
> 
> 标签：javascript, css

您如何`strong { color: red }`使用 Javascript 添加 CSS 规则（例如）？

* * *

## 回答 #1

> 赞同：289
> 
> 时间：2009-04-01T22:24:06.937

简单直接的方法是创建一个新`style`节点并将其添加到文档中。

```
// Your CSS as text
var styles = `
    .qwebirc-qui .ircwindow div { 
        font-family: Georgia,Cambria,"Times New Roman",Times,serif;
        margin: 26px auto 0 auto;
        max-width: 650px;
    }
    .qwebirc-qui .lines {
        font-size: 18px;
        line-height: 1.58;
        letter-spacing: -.004em;
    }

    .qwebirc-qui .nicklist a {
        margin: 6px;
    }
`

var styleSheet = document.createElement("style")
styleSheet.innerText = styles
document.head.appendChild(styleSheet) 
```

* * *

## 回答 #2

> 赞同：142
> 
> 时间：2009-04-01T23:57:21.423

您也可以使用 DOM Level 2 CSS 接口 ( [MDN](https://developer.mozilla.org/en-US/docs/Web/API/Document/styleSheets) ) 来做到这一点：

```
var sheet = window.document.styleSheets[0];
sheet.insertRule('strong { color: red; }', sheet.cssRules.length); 
```

...除了（自然）IE8 和之前的所有版本，它使用自己略有不同的措辞：

```
sheet.addRule('strong', 'color: red;', -1); 
```

与 createElement-set-innerHTML 方法相比，这有一个理论上的优势，因为您不必担心在 innerHTML 中放置特殊的 HTML 字符，但实际上样式元素是旧版 HTML 中的 CDATA，并且 '< ' 和'&' 无论如何，很少在样式表中使用。

您确实需要一个样式表，然后才能开始像这样附加它。这可以是任何现有的活动样式表：外部的、嵌入的或空的，没关系。如果没有，目前创建它的唯一标准方法是使用 createElement。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2011-06-02T07:31:47.877

Ben Blank 的解决方案对我来说在 IE8 中不起作用。

然而，这在 IE8 中确实有效

```
function addCss(cssCode) {
var styleElement = document.createElement("style");
  styleElement.type = "text/css";
  if (styleElement.styleSheet) {
    styleElement.styleSheet.cssText = cssCode;
  } else {
    styleElement.appendChild(document.createTextNode(cssCode));
  }
  document.getElementsByTagName("head")[0].appendChild(styleElement);
} 
```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2013-02-15T15:52:37.753

[这是Chris Herring 解决方案](https://stackoverflow.com/a/6211716/152809)的略微更新版本，考虑到您也可以使用`innerHTML`它而不是创建新的文本节点：

```
function insertCss( code ) {
    var style = document.createElement('style');
    style.type = 'text/css';

    if (style.styleSheet) {
        // IE
        style.styleSheet.cssText = code;
    } else {
        // Other browsers
        style.innerHTML = code;
    }

    document.getElementsByTagName("head")[0].appendChild( style );
} 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2019-06-30T14:10:59.643

**最短的一班轮**

```
// One liner function:
const addCSS = s => document.head.appendChild(document.createElement("style")).innerHTML=s;

// Usage: 
addCSS("body{ background:red; }")
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-02T04:34:04.613

您可以逐个元素地添加类或样式属性。

例如：

```
<a name="myelement" onclick="this.style.color='#FF0';">text</a> 
```

您可以在哪里执行 this.style.background、this.style.font-size 等。您也可以使用相同的方法 ala 应用样式

```
this.className='classname'; 
```

如果您想在 javascript 函数中执行此操作，您可以使用 getElementByID 而不是“this”。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-10-04T19:31:59.040

`<style>`这个在 html 头部添加的简单示例

```
var sheet = document.createElement('style');
sheet.innerHTML = "table th{padding-bottom: 0 !important;padding-top: 0 !important;}\n"
+ "table ul {    margin-top: 0 !important;    margin-bottom: 0 !important;}\n"
+ "table td{padding-bottom: 0 !important;padding-top: 0 !important;}\n"
+ ".messages.error{display:none !important;}\n"
+ ".messages.status{display:none !important;} ";

document.body.appendChild(sheet); // append in body
document.head.appendChild(sheet); // append in head 
```

源[动态样式 - 使用 JavaScript 操作 CSS](https://www.w3.org/wiki/Dynamic_style_-_manipulating_CSS_with_JavaScript)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-02T03:18:54.433

YUI 最近刚刚为此[添加了一个实用程序](https://yuilibrary.com/yui/docs/api/classes/StyleSheet.html)。请参阅此处的[stylesheet.js](https://yuilibrary.com/yui/docs/api/files/stylesheet_js_stylesheet.js.html#l69)。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-08-29T09:45:35.237

这是我在最后一个样式表列表末尾添加 css 规则的解决方案：

```
var css = new function()
{
    function addStyleSheet()
    {
        let head = document.head;
        let style = document.createElement("style");

        head.appendChild(style);
    }

    this.insert = function(rule)
    {
        if(document.styleSheets.length == 0) { addStyleSheet(); }

        let sheet = document.styleSheets[document.styleSheets.length - 1];
        let rules = sheet.rules;

        sheet.insertRule(rule, rules.length);
    }
}

css.insert("body { background-color: red }"); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-01-28T07:54:15.130

如果您知道页面中至少`<style>`存在一个标签，请使用此功能：

```
CSS=function(i){document.getElementsByTagName('style')[0].innerHTML+=i}; 
```

用法 ：

```
CSS("div{background:#00F}"); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-06-27T09:39:38.060

另一种选择是使用 JQuery 来存储元素的内联样式属性，附加到它，然后用新值更新元素的样式属性。如下：

```
function appendCSSToElement(element, CssProperties)
        {
            var existingCSS = $(element).attr("style");

             if(existingCSS == undefined) existingCSS = "";

            $.each(CssProperties, function(key,value)
            {
                existingCSS += " " + key + ": " + value + ";";
            });

            $(element).attr("style", existingCSS);

            return $(element);
        } 
```

然后使用新的 CSS 属性作为对象执行它。

```
appendCSSToElement("#ElementID", { "color": "white", "background-color": "green", "font-weight": "bold" }); 
```

这可能不一定是最有效的方法（我对如何改进这一点持开放态度。:)），但它绝对有效。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-06-23T03:37:38.537

这是一个示例模板，可帮助您入门

需要 0 个库并且仅使用 javascript 来注入 HTML 和 CSS。

该功能是从上面的用户@Husky那里借来的

如果您想运行 tampermonkey 脚本并想在网站上添加切换覆盖（例如便笺应用程序），这很有用

```
// INJECTING THE HTML
document.querySelector('body').innerHTML += '<div id="injection">Hello World</div>';

// CSS INJECTION FUNCTION
//https://stackoverflow.com/questions/707565/how-do-you-add-css-with-javascript
function insertCss( code ) {
    var style = document.createElement('style');
    style.type = 'text/css';
    if (style.styleSheet) {
        // IE
        style.styleSheet.cssText = code;
    } else {
        // Other browsers
        style.innerHTML = code;
    }
    document.getElementsByTagName("head")[0].appendChild( style );
}

// INJECT THE CSS INTO FUNCTION
// Write the css as you normally would... but treat it as strings and concatenate for multilines
insertCss(
  "#injection {color :red; font-size: 30px;}" +
  "body {background-color: lightblue;}"
)
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-11-17T19:54:00.563

这是我的通用函数，它对 CSS 选择器和规则进行参数化，如果您希望添加到特定工作表，则可以选择接收 css 文件名（区分大小写）（否则，如果您不提供 CSS 文件名，它将创建一个新的样式元素并将其附加到现有的头部。它最多会创建一个新的样式元素并在以后的函数调用中重新使用它）。适用于 FF、Chrome 和 IE9+（可能更早，未经测试）。

```
function addCssRules(selector, rules, /*Optional*/ sheetName) {
    // We want the last sheet so that rules are not overridden.
    var styleSheet = document.styleSheets[document.styleSheets.length - 1];
    if (sheetName) {
        for (var i in document.styleSheets) {
            if (document.styleSheets[i].href && document.styleSheets[i].href.indexOf(sheetName) > -1) {
                styleSheet = document.styleSheets[i];
                break;
            }
        }
    }
    if (typeof styleSheet === 'undefined' || styleSheet === null) {
        var styleElement = document.createElement("style");
        styleElement.type = "text/css";
        document.head.appendChild(styleElement);
        styleSheet = styleElement.sheet;
    }

    if (styleSheet) {
        if (styleSheet.insertRule)
            styleSheet.insertRule(selector + ' {' + rules + '}', styleSheet.cssRules.length);
        else if (styleSheet.addRule)
            styleSheet.addRule(selector, rules);
    }
} 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2018-06-14T19:20:38.127

`.css`在 Jquery 中使用`$('strong').css('background','red');`

```
$('strong').css('background','red');
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<strong> Example
</strong> 
```

# asp.net-mvc - ASP.NET MVC：在回发时更改模型的属性

> ID：707569
> 
> 赞同：13
> 
> 时间：2009-04-01T22:21:50.327
> 
> 标签：asp.net-mvc

我一直在使用 ASP.NET MVC 并遇到了一些我无法弄清楚的事情。

假设我有一个像这样的对象：

```
public class TestObject
{
    public string Name { get; set; }
    public int Age { get; set; }
} 
```

还有一个像这样的视图页面（Create.aspx）：

```
<form action="/Create" method="post">
    <p>
        <%=Html.TextBox("Name") %>
    </p>
    <p>
        <%=Html.TextBox("Age")%>
    </p>
</form> 
```

在我的控制器上，我有这些操作：

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult Create()
{
    return View(new TestObject { Name = "DefaultName", Age = 10 } );
}

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create(TestObject o)
{
    o.Name = "ChangedNameToSomethingElse";
    o.Age = 15;
    return View(o);
} 
```

该`Html.TextBox()`方法始终使用默认值生成文本框，即使在回发之后，对象以其值的不同属性传回。现在，当然，我想不出一个现实世界的例子，为什么我想做这样的事情，但我仍然不明白为什么我总是在文本框中填充在 Create 操作中设置的模型值与`AcceptVerbs(HttpVerbs.Get)`属性。

**注意**：我试过`Html.TextBox("Name", Model.Name)`了，结果还是一样。`AcceptVerbs(HttpVerbs.Post)`我通过通过 ViewData 将值传递给 View 来验证 Create 操作是否实际运行。此外，当我再次输出值时，会显示更新值，`<%=Model.Name %>`而不是在文本框上。

有什么明显的我遗漏的东西，或者这种行为背后有什么原因吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-01T22:31:08.307

如果您通过方法的声明或通过 UpdateModel 或 TryUpdateModel 将发布请求的结果绑定到诸如 TestObject 之类的对象，则名为 ModelState 的属性将被这些值填充。诸如 Textbox 之类的 HTML 助手将始终通过显式传递的模型对象绑定到模型状态。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-26T16:27:16.647

我知道这是很久以前回答的，但这是对我有用的更有针对性的解决方案。

```
[HttpPost]
public ActionResult Create(TestObject o) { 
    ModelState.Remove("Name");    
    o.Name = "ChangedNameToSomethingElse";     
    ModelState.Remove("Age");    
    o.Age = 15;
    return View(o); 
} 
```

希望这可以帮助那里的人。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-18T05:36:03.927

试试这个：-（希望它对你有用）

```
[HttpPost]
[AcceptVerbs(HttpVerbs.Post)] 
public ActionResult Create(TestObject o) { 
    ModelState.Clear();    
    o.Name = "ChangedNameToSomethingElse";     
    o.Age = 15;
    return View(o); 
} 
```

# c# - C#中的IWin32Window？

> ID：707575
> 
> 赞同：0
> 
> 时间：2009-04-01T22:22:35.880
> 
> 标签：c#

我如何使用它来创建工具提示？

我试过浏览 MSDN 网站上的所有文章，但我无法理解它。

谢谢，

灰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T22:26:58.350

你到底想做什么？对于大多数目的，您只需添加 a`Tooltip`并针对控件设置值。一些控件提供自己的工具提示（和设置文本的机制）。

```
 [STAThread]
    static void Main()
    { // example code only... doesn't do cleanup
        Application.EnableVisualStyles();
        Button btn = new Button();
        Form form = new Form();
        form.Controls.Add(btn);
        ToolTip ttip = new ToolTip();
        ttip.SetToolTip(btn, "Hello world");
        Application.Run(form);
    } 
```

* * *

重新发表评论；然后就像：

```
form.Shown += delegate {
    ttip.Show("hi", form, 0,0, 3000);
}; 
```

（其中`form`可能是表单、“ `this`”或任何控件）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T22:26:18.943

[这是你要找的吗？](http://msdn.microsoft.com/en-us/library/aa288412(VS.71).aspx) 您不需要为工具提示使用互操作。

# objective-c - 我应该如何内存管理实例方法返回的对象？

> ID：707585
> 
> 赞同：4
> 
> 时间：2009-04-01T22:26:20.627
> 
> 标签：objective-c, cocoa

大量的 Objective-C 类返回对象。例如，像这样的语句`[[instanceOfNSWhatever objectForKey:aKey] stringValue]`出现在我的（希望其他所有人的代码）中。

我应该如何记忆管理这些“中间”对象？

*   它们是刚刚创建的还是一直存在的？
*   我可以保留它们吗？如果我释放创建它们的对象，它们也会被释放吗？
*   它们是自动发布的吗？
*   如果我`[instanceOfNSWhatever stringValue]`循环运行一百万次怎么办？我可以`NSString`根据需要处理所有这些 s 吗？

我仍在学习 ObjC，虽然我一直擅长平衡我的整体保留计数，但我对这些方法的工作原理肯定缺乏一些了解。谁能给我填？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-01T22:51:21.223

您可能已经阅读过 Apple 文档中有关内存管理的这一部分，但我会向您指出有关[对象所有权政策](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmObjectOwnership.html#//apple_ref/doc/uid/20000043)的部分，以防万一。您只负责管理您“拥有”的对象的内存。引用文档：

> *   您拥有您创建的任何对象。
> *   您使用名称以“alloc”或“new”开头或包含“copy”的方法“创建”一个对象（例如，alloc、newObject 或 mutableCopy）。
> *   如果您拥有一个对象，则您有责任在完成该对象后放弃所有权。[即：释放]
> *   如果您不拥有某个对象，则不得释放它。

这些文档的“简单示例”部分提供了很好的阐述，但要将以上几点放在您的具体问题的上下文中：

> 我应该如何记忆管理这些“中间”对象？

好消息是：你没有。忽略示例中“中间”对象的内存管理方面。

> *   它们是刚刚创建的还是一直存在的？

它们可能一直存在，或者它们可能刚刚被创建。Objective-c 的美妙之处在于，作为这些对象的消费者，您不必在意。

> *   我可以保留它们吗？如果我释放创建它们的对象，它们也会被释放吗？

如果您只是将它们传递给其他函数，或者在您自己的函数计算中将它们用作中间值，则不需要保留它们。例如，假设您`stringValue`要从示例函数中返回给其他人。保留它只是为了归还它是没有意义的。

如果您确实保留了它，那么是的，您有责任在某个时间点发布相应的发布消息。`stringValue`例如，如果您想在自己的实例中保留该值作为属性，则可以保留示例中的值。Objective-C 使用引用计数。如果您需要该对象长时间停留，则必须保留它，以便在保留计数降至 0 时其他人的释放消息不会导致它消失。

> 它们是自动发布的吗？

依靠。假设您要求从`instanceOfNSWhatever`. 如果`instanceOfNSWhatever`必须为您创建特殊的字符串（以便为您的请求提供服务），但不关心该字符串，那么是的......`instanceOfNSWhatever`可能将该字符串放入自动释放池中。如果字符串已经是的属性`instanceOfNSWhatever`并且它只是响应您的请求而将其发送给您，那么不，它可能不是自动释放的。

再次，美丽是：你不知道也不需要关心。由于`instanceOfNSWhatever`创建了字符串，它负责管理它。您可以忽略内存管理，除非您通过向字符串发送保留消息来添加它。

> 如果我在循环中运行一百万次 [instanceOfNSWhatever stringValue] 会怎样？我可以根据需要处理所有这些 NSStrings 吗？

没必要。再说一次......`stringValue`不是你来管理的，因为你没有创建它。作为技术说明，如果`instanceOfNSWhatever`确实必须创建 100 万个副本`stringValue`来服务您的 100 万个调用，它可能会将它们全部放入一个自动释放池中，该池将在当前可可事件循环结束时耗尽。幸运的是，除非您向这些`stringValue`对象中的每一个发送保留消息，否则您可以愉快地忽略这里的内存管理问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-01T22:37:32.723

您基本上根据[Cocoa 的内存管理编程指南](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)管理所有内存。然而，简而言之，您基本上只需要担心您“拥有”的对象。如果您创建了一个对象，那么您就拥有了它（在 Cocoa 中，您通过使用或它们的派生词之一专门分配`alloc`或复制它来创建一个对象）。`copy`如果您拥有一个对象，您有责任在使用完它后释放它。

因此，任何其他对象都不归您所有。如果您需要在任何长时间内使用此类对象（例如，在您收到它的范围之外），您需要通过向其发送`retain`消息或复制它来专门获取该对象的所有权。

要回答您的最后一个问题，如果您在循环或其他方式中创建大量临时对象，您可以创建自己的自动释放池。有关使用它们的更多信息，请参阅 NSAutoreleasePool 的[文档](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSAutoreleasePool_Class/Reference/Reference.html)。但是请注意，只有在分析了应用程序并发现它使用了太多内存并且会从这种优化中受益之后，才应该这样做。

最后，如果您正在创建和释放大量重对象并且不想依赖自动释放池，则可以专门分配和初始化它们，然后确保在完成后立即自行释放它们. 大多数具有便利创建者的对象都有类似的初始化器来专门创建对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-06T22:36:38.183

在 iPhone/iPod Touch 上工作时，自动释放对象会在应用程序退出时释放。这可能是你不想要的。尤其是在处理图像或大块数据时。为了确保标记为自动释放的大型内存池更快地释放，请创建本地自动释放池。像这样：

```
NSAutoreleasePool *localPool = [[NSAutoreleasePool alloc] init];

-- do something that creates large autorelease memory blocks --

[localPool drain]; 
```

如果你不这样做，你会发现你的应用程序意外退出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T22:40:36.583

我会告诉你一个简单的规则，我希望我在第一次开始使用 Objective-C 时就知道 :)

*   如果方法包含“alloc”或“copy”字样，那么您必须在完成时 [释放] 对象。
*   如果一个方法不包含这些词，您必须 [保留] 它以使其在您的函数之外保持有效。
*   如果您调用 [retain]，您必须稍后在完成后调用 [release]。

这几乎涵盖了您需要了解的有关内存管理基础知识的所有内容。

ObjC 大量使用所谓的“自动释放”池。从非分配/复制函数返回的对象被放入这些池中，并在您的函数存在后自动释放。

这就是为什么您不需要发布 [obj stringValue] 之类的结果的原因。

# security - 您将如何攻击域以查找“未知”资源？

> ID：707587
> 
> 赞同：10
> 
> 时间：2009-04-01T22:26:24.293
> 
> 标签：security, url

给定一个域，攻击者是否有可能发现该域下存在的一个或多个页面/资源？攻击者可以做什么/使用什么来发现域中的资源？

我从未见过任何安全材料中提到的问题（因为它是一个已解决的问题？）所以除了实践之外，我对想法、理论、最佳猜测感兴趣；攻击者可以在“黑匣子”庄园中使用的任何东西来发现资源。

* * *

我想出的一些事情是：

*   谷歌——如果谷歌能找到它，攻击者就可以。
*   暴力字典攻击——迭代常用词和词组合（登录、错误、索引、默认等）此外，如果知道资源扩展名（xml、asp、html、php），则可以缩小字典范围。是相当容易发现的。
*   通过嗅探器监控流量——观察用户访问的页面列表。这假设了某种类型的网络访问，在这种情况下，鉴于攻击者拥有网络访问权限，URL 发现可能只是小菜一碟。

**编辑**：显然目录列表权限已关闭。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-06T15:27:58.137

清单很长；有很多技术可以用来做到这一点；请注意，其中一些是高度非法的：

*   查看 Google、archive.org 和其他网络爬虫为该网站编制的索引。
*   浏览网站上的公共文档（包括 PDF、JavaScript 和 Word 文档）以寻找私人链接。
*   从不同的 IP 地址扫描站点以查看是否正在进行任何基于位置的过滤。
*   入侵站点所有者网络上的计算机并从那里进行扫描。
*   攻击站点的 Web 服务器软件中的漏洞并直接查看数据。
*   去垃圾箱潜水以获取身份验证凭据并使用便利贴上的密码登录网站（这种情况发生的频率比您想象的要多）。
*   查看常见文件（如 robots.txt）以查看它们是否“保护”敏感信息。
*   尝试常见的 URL（/secret、/corp 等）以查看它们是否给出 302（未经授权）或 404（未找到页面）。
*   在该公司获得一份低级别的工作，并从内部进行攻击；或者，以此为契机，通过键盘嗅探器等从合法用户那里窃取凭据。
*   窃取销售人员或高管的笔记本电脑——许多人不使用文件系统加密。
*   在公司附近设立一个提供免费 WiFi 热点的咖啡/热狗摊，代理流量，并使用它来获取凭据。
*   查看公司的公共 wiki 以获取密码。

等等……你最好攻击安全问题的人为方面，而不是试图通过网络进入，除非你立即发现一些明显的漏洞。办公室工作人员报告漏洞的可能性要小得多，而且他们的安全习惯通常非常草率——密码被放入 wiki 并写在贴在显示器上的便利贴上，公路战士不加密他们的笔记本电脑硬盘驱动器， 等等。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-06T15:14:29.307

最典型的攻击向量会试图找到众所周知的应用程序，例如`/webstats/`或`/phpMyAdmin/`，寻找一些没有经验的用户可能留在生产环境中的典型文件（例如。`phpinfo.php`）。最危险的：文本编辑器备份文件。许多文本编辑器会在原始文件的副本中附加或附加“~”。所以想象你有`whatever.php~`or `whatever.apsx~`。由于这些未执行，攻击者可能会访问源代码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-06T15:05:26.223

*   蛮力（使用类似[OWASP Dirbuster](http://www.owasp.org/index.php/Category:OWASP_DirBuster_Project)的东西，附带一个很棒的字典 - 它还会解析响应，因此可以非常快速地映射应用程序，然后即使在结构非常深入的应用程序中也能找到资源）
*   *如您所述*，雅虎、谷歌和其他搜索引擎
**   机器人.txt*   sitemap.xml（*现在很常见，里面有很多东西*）*   Web Stats 应用程序（如果有任何安装在服务器中并且可以公开访问，例如 /webstats/ ）*

 *对通常称为“**强制浏览**”的文件和目录的暴力破解可能会帮助您进行谷歌搜索。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-01T22:38:11.690

假设攻击者可以列出所有提供的文件，除非受到 HTTP AUTH 的保护（aspx auth 不足以达到此目的），否则通常最好设置您的防御。

编辑：更一般地说，您应该假设攻击者可以识别所有可公开访问的持久资源。如果资源没有授权检查，假设攻击者可以读取它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-06T15:14:54.377

如果在公共页面中使用资源文件，如 CSS、JavaScript、图像、视频、音频等，它们的路径也可以显示目录。CSS 和 JavaScript 也可以在其代码中包含告诉 URL。

如果您使用 CMS，某些 CMS 会在每个页面的头部放置一个元标记，表明该页面是由 CMS 生成的。如果您的 CMS 不安全，则可能是攻击媒介。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-01T22:52:26.400

“robots.txt”文件可以给你（如果它存在，当然）一些关于那里有哪些文件\目录的信息（[Exmaple](https://stackoverflow.com/robots.txt)）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-06T15:26:54.737

1.  能拿到整机吗？使用常见/众所周知的扫描仪和爆炸物。
2.  尝试社会工程学。您会想知道它的效率如何。
3.  Bruteforce 会话（JSessionid 等）可能带有[fuzzer](http://en.wikipedia.org/wiki/Fuzzing)。
4.  尝试常用的路径签名（/admin/ /adm/ .... 在域中）
5.  使用 XSS / SQL 注入 / 漏洞测试查找数据插入以进行进一步处理
6.  利用域内的弱已知应用程序
7.  使用钓鱼黑客（XSS/XRF/HTML-META >> IFrame）将用户转发到您的虚假页面（*并且域名保留*）。
8.  Blackbox reengineering - 使用什么编程语言？VM/Interpreter 版本中是否存在错误？尝试服务指纹识别。你怎么写一个像你想要攻击的页面一样的页面。页面的开发人员可能遗漏了哪些安全问题？

a) 试着像一个愚蠢的开发者一样思考 ;)

b）希望域的开发者是愚蠢的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-06T17:32:59.800

你是在谈论道德黑客行为吗？

您可以使用 SurfOffline 工具下载该站点，并对文件夹、架构等有一个很好的了解。

最好的祝福！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-10T13:52:08.977

在“teh interwebs”上附加一个新盒子时，我总是运行[(ze)nmap](http://www.hackingtheuniverse.com/infosec/tools/zenmap)。（我知道该网站看起来很险恶 - 我猜在这种情况下这是质量的标志......）

它几乎是一个按钮，并为您详细说明目标（阅读：“您的服务器”）的脆弱性。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-07T01:02:31.343

如果你`mod_rewrite`在你的服务器上使用，你可以这样：

所有不符合模式的请求都可以重定向到特殊页面。那里有 IP 或任何将被跟踪的东西。你有一定数量的“攻击”你可以禁止这个用户/IP。最有效的方法是自动在你身上添加一个特殊的重写条件`mod_rewrite`。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-07T16:15:42.443

一个非常好的第一步是尝试针对他们的 DNS 服务器进行域转移。许多配置错误，会给你完整的主机列表。

凶猛的域扫描器就是这样做的：http: [//ha.ckers.org/fierce/](http://ha.ckers.org/fierce/)

它还从字典中猜测常见的主机名，并在找到活动主机时检查数字接近的 IP 地址。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-09T11:17:23.253

为了保护站点免受攻击，请召集高层管理人员召开安全会议，并告诉他们不要在其他任何地方使用工作密码。大多数西装都会不小心在任何地方使用相同的密码：工作、家庭、pr0n 网站、赌博、公共论坛、维基百科。他们根本没有意识到并非所有网站都关心不查看用户密码的事实（尤其是当网站提供“免费”内容时）。

# image - FFmpeg 图像到视频和流媒体

> ID：707594
> 
> 赞同：1
> 
> 时间：2009-04-01T22:29:13.507
> 
> 标签：image, streaming, ffmpeg, vlc, transcoding

我有一个实时生成 JPEG 图像的 C# 程序，我需要（连续）从图像中生成视频并流式传输（也是实时的）。

我已经使用 ffmpeg 对输入视频源进行转码并将其流式传输，ffmpeg 是否没有选项可以将输入作为一组图像（始终生成）并从中制作视频？

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T22:33:10.097

实际上，我使用 VLC 进行流式传输....

实际上我只是发现我可以： ffmpeg -f image2 -i img%d.jpg /tmp/a.mpg

但是我需要告诉 ffmpeg 继续这样做，我的意思是，如果它没有找到另一个图像 ffmpeg 应该等待另一个图像生成......这可能吗？

# php - 使用 PHP 和 MySQL 创建定时验证

> ID：707595
> 
> 赞同：0
> 
> 时间：2009-04-01T22:29:57.313
> 
> 标签：php, validation

我将如何创建一个用户必须单击链接以验证某些内容的系统。

假设在我的网站上，每个用户都有自己的未共享文件夹。我希望他们成为每个用户在其帐户页面上的一个选项，他们可以在其中与另一个用户建立信任以访问彼此的文件夹。也许通过输入他们想要与之建立信任的用户的名称。

所以在这种情况下，用户 Jim 在他的创建信任输入框中键入“Tom”，因此需要建立信任。我想，A) 需要一些东西来存储 Jim 的请求，B.然后将其分配为未验证，C.最后将验证链接发送给 Tom。然后汤姆不知何故收到了一条消息？（还不确定），也许需要检查一下是否有汤姆的验证链接？然后 Tom 单击发送的验证链接以验证他是否也想与 Jim 建立信任。一旦 Tom 点击它，A. 告诉任何存储了 Tom 接受的 Jim 请求的内容，B. 将验证分配为已验证 C. 通知 Jim Tom 的请求已被接受或拒绝。

但是，如果 24 小时结束，或者 Tom 拒绝了 Jim 的请求，还需要有一种方法来删除验证存储（无论它是什么）。

谁能帮帮我吗？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T22:46:15.027

听起来对数据库来说是一项不错的工作。当用户 A 请求共享时，它在数据库中输入为待处理。当用户 B 收到通知时，他可以单击一个链接，该链接的脚本将检查数据库中的原始请求，验证它是否在 24 小时内，如果是，则数据库记录我们更新为接受或拒绝。如果 24 小时已过，记录将更新为过期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T22:47:14.103

如果您使用的是数据库，这很简单。只需为每个请求生成某种唯一 ID，并将请求（状态为“等待响应”或类似的）存储在数据库中，然后向 Tom 发送一封电子邮件，其中包含指向您的一个 php 页面的链接，该页面的唯一 ID 为查询字符串中的请求。

这样，您可以将请求的“接受时间”字段保存到 Tom 单击其电子邮件中的链接时，并将状态更改为“接受”。

逻辑上确定是否已过 24 小时很简单，您可以在此时间段之后拒绝访问受信任的共享。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T22:53:32.450

您可以定义一个具有以下属性的表：-
唯一 ID
-ID1（个人 1）
-ID2（个人 2）
-验证状态（真或假）
-验证哈希 MD5（名称（ID1）+随机（100,99999） ),Name(ID2))
- 请求关系的日期和时间 - 与
需要此功能的系统相关的其他信息...

然后按照您所说的进行。
1) 2009 年 12 月 5 日下午 5:25，Tom (ID=15) 要求 Mark(ID=21) 加入他的网络，然后您的脚本将数据添加到表中，如下所示： -
唯一 ID：由自动增量自动分配
-ID1: 15
-ID2: 21
-Validated: False
-Validation Hash MD5: MD5("Tom".42574."Mark")=bedbcfc6e679be69ff3587f15213c83f
-日期和时间：2009 年 12 月 5 日下午 5:25 -与
需要此功能的系统相关的其他信息...

确保在将数据设置到数据库之前检查重复项。
之后，删除日期和时间早于 24 小时的所有字段 =D

2）如果没有重复，发送邮件给 Mark 并带有返回您页面的链接，包括 md5 哈希作为 url 的 Get 属性。让页面名称为 validate.php?h=bedbcfc6e679be69ff3587f15213c83f

3)您的脚本 validate.php 收到带有获取参数 h=bedbcfc6e679be69ff3587f15213c83f 的请求继续检查
数据库。
如果散列存在，并且日期和时间不超过 24 小时，则将 Validated 设置为 true，然后将邮件发送到 Tom 的电子邮件，其中包含他的新朋友的信息。
如果 hash 不存在，通过验证页面结果通知 Mark。

好的。就这样。希望它在某种程度上对你有用。

# javascript - 将 jQuery datepicker 应用于多个实例

> ID：707603
> 
> 赞同：70
> 
> 时间：2009-04-01T22:31:32.720
> 
> 标签：javascript, jquery, jquery-ui

我有一个 jQuery 日期选择器控件，它可以在一次实例中正常工作，但我不确定如何让它适用于多个实例。

```
<script type="text/javascript">
    $(function() {
        $('#my_date').datepicker();
    });
</script>

<% Using Html.BeginForm()%>
<% For Each item In Model.MyRecords%>
<%=Html.TextBox("my_date")%> <br/>
<% Next%>
<% End Using%> 
```

如果没有 For Each 循环，它可以正常工作，但如果“MyRecords”集合中有多个项目，则只有第一个文本框会获得日期选择器（这很有意义，因为它与 ID 相关联）。我尝试为文本框分配一个类并指定：

```
$('.my_class').datepicker(); 
```

但是虽然到处都显示了一个日期选择器，但它们都更新了第一个文本框。

使这项工作的正确方法是什么？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-04-01T23:01:40.357

html:

```
<input type="text" class="datepick" id="date_1" />
<input type="text" class="datepick" id="date_2" />
<input type="text" class="datepick" id="date_3" /> 
```

脚本：

```
$('.datepick').each(function(){
    $(this).datepicker();
}); 
```

（伪编码了一点以使其更简单）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-12-06T21:46:10.293

我只是有同样的问题。

使用日期选择的正确方法是`$('.my_class').datepicker();`，但您需要确保没有将相同的 ID 分配给多个日期选择器。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-01T22:45:24.217

显而易见的答案是生成不同的 id，每个文本框都有一个单独的 id，比如

```
[int i=0]
<% Using Html.BeginForm()%>
<% For Each item In Model.MyRecords%>
[i++]
<%=Html.TextBox("my_date[i]")%> <br/>
<% Next%>
<% End Using%> 
```

我不知道 ASP.net，所以我只是在方括号内添加了一些通用的类似 C 的语法代码。将其转换为实际的 ASP.net 代码应该不成问题。

然后，您必须找到一种方法来生成尽可能多的

```
$('#my_date[i]').datepicker(); 
```

作为您的`Model.MyRecords`. 同样，方括号内是您的计数器，因此您的 jQuery 函数将类似于：

```
<script type="text/javascript">
    $(function() {
        $('#my_date1').datepicker();
        $('#my_date2').datepicker();
        $('#my_date3').datepicker();
        ...
    });
</script> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-01-15T16:16:32.983

```
<html>
<head>
 <!-- jQuery JS Includes -->
 <script type="text/javascript" src="jquery/jquery-1.3.2.js"></script>
 <script type="text/javascript" src="jquery/ui/ui.core.js"></script>
 <script type="text/javascript" src="jquery/ui/ui.datepicker.js"></script>

 <!-- jQuery CSS Includes -->
 <link type="text/css" href="jquery/themes/base/ui.core.css" rel="stylesheet" />
 <link type="text/css" href="jquery/themes/base/ui.datepicker.css" rel="stylesheet" />
 <link type="text/css" href="jquery/themes/base/ui.theme.css" rel="stylesheet" />

 <!-- Setup Datepicker -->
 <script type="text/javascript"><!--
  $(function() {
   $('input').filter('.datepicker').datepicker({
    changeMonth: true,
    changeYear: true,
    showOn: 'button',
    buttonImage: 'jquery/images/calendar.gif',
    buttonImageOnly: true
   });
  });
 --></script>
</head>
<body>

 <!-- Each input field needs a unique id, but all need to be datepicker -->
 <p>Date 1: <input id="one" class="datepicker" type="text" readonly="true"></p>
 <p>Date 2: <input id="two" class="datepicker" type="text" readonly="true"></p>
 <p>Date 3: <input id="three" class="datepicker" type="text" readonly="true"></p>

</body>
</html> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-02-19T09:34:56.393

有一个简单的解决方案。

```
<html>
    <head>
        <script src="http://code.jquery.com/jquery-1.9.1.js"></script>      
        <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"> </script> 
        <script type="text/javascript" src="../js/jquery.min.js"></script>
        <script type="text/javascript" src="../js/flexcroll.js"></script>
        <script type="text/javascript" src="../js/jquery-ui-1.8.18.custom.min.js"></script>
        <script type="text/javascript" src="../js/JScript.js"></script>
        <title>calendar</title>    
        <script type="text/javascript"> 
            $(function(){$('.dateTxt').datepicker(); }); 
        </script> 
    </head>
    <body>
        <p>Date 1: <input id="one" class="dateTxt" type="text" ></p>
        <p>Date 2: <input id="two" class="dateTxt" type="text" ></p>
        <p>Date 3: <input id="three" class="dateTxt" type="text" ></p>
    </body>
</html> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-10-08T08:54:20.000

在运行时添加 datepicker 生成的输入文本框时，您必须检查它是否已经包含 datepicker 然后首先删除类 hasDatepicker 然后将 datePicker 应用于它。

```
function convertTxtToDate() {
        $('.dateTxt').each(function () {
            if ($(this).hasClass('hasDatepicker')) {
                $(this).removeClass('hasDatepicker');
            } 
             $(this).datepicker();
        });
    } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-11-23T11:06:21.510

*对 SeanJA 答案的一点说明。*

有趣的是，如果您将**KnockoutJS 和 jQuery 一起**使用， 则以下输入**具有不同的 ID**，但具有**相同的 data-bind observable**：

```
<data-bind="value: first_dt" id="date_1" class="datepick" />
<data-bind="value: first_dt" id="date_2" class="datepick" /> 
```

会将一个（相同的）日期选择器绑定到两个输入（即使它们具有不同的 id 或名称）。

**在 ViewModel**中使用单独的 observable将单独的日期选择器绑定到每个输入：

```
<data-bind="value: first_dt" id="date_1" class="datepick" />
<data-bind="value: second_dt" id="date_2" class="datepick" /> 
```

初始化：

```
$('.datepick').each(function(){
    $(this).datepicker();
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-10T17:44:49.830

这里的解决方案是像你们中的许多人所说的那样拥有不同的 ID。问题仍然存在于日期选择器中。请纠正我，但日期选择器没有一个包装器 ID -“ui-datepicker-div”。这可以在主题中的[http://jqueryui.com/demos/datepicker/#option-showOptions上看到。](http://jqueryui.com/demos/datepicker/#option-showOptions)

是否有可以将此 ID 更改为类的选项？我不想仅仅为了这个明显的修复而分叉这个脚本！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-11-01T06:54:56.550

更改使用类而不是 ID

```
<script type="text/javascript"> 
    $(function() { 
        $('.my_date1').datepicker(); 
        $('.my_date2').datepicker(); 
        $('.my_date3').datepicker(); 
        ... 
    }); 
</script> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-01-12T23:18:16.387

我遇到了同样的问题，但最后发现这是我从 ASP Web 用户控件调用脚本的方式的问题。我正在使用`ClientScript.RegisterStartupScript()`，但忘记给脚本一个唯一的键（第二个参数）。由于两个脚本被分配了相同的键，实际上只有第一个框被转换为日期选择器。所以我决定将文本框的 ID 附加到键上以使其唯一：

```
Page.ClientScript.RegisterStartupScript(this.GetType(), "DPSetup" + DPTextbox.ClientID, dpScript); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-07-30T06:46:51.247

我在动态添加日期选择器类时遇到了类似的问题。我找到的解决方案是注释掉 datepicker.js 的第 46 行

```
// this.element.on('click', $.proxy(this.show, this)); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-09-07T01:23:10.480

在我的情况下，我没有给我的`<input>`元素任何 ID，而是使用一个类来应用日期选择器，就像 SeanJA 的答案一样，但日期选择器只应用于第一个。我发现 JQuery 会自动添加一个 ID，并且它在所有元素中都是相同的，这解释了为什么只有第一个被选中。

# ruby - 你怎么知道什么宝石是正确的？

> ID：707604
> 
> 赞同：1
> 
> 时间：2009-04-01T22:31:37.650
> 
> 标签：ruby, rubygems

似乎没有关于 Ruby Gem 包提交的指南。没有办法说出满足您需求的最终包是什么。至少不在 Gem 框架本身内。还是我错过了什么？

例如：我发现了“ActiveLDAP”。我做了

```
gem search ldap --remote 
```

然后回来了

```
*** REMOTE GEMS ***

activeldap (1.0.2)
ambitious-activeldap (0.1.1)
ruby-activeldap (0.8.3.1)
ruby-activeldap-debug (0.7.4) 
```

我最终安装了“ `activeldap`”和“ `ruby-activeldap`”。原来它们是同一个包：“ruby-activeldap”只是一个旧版本。

在 Gems 框架中是否有一种方法可以区分它们，而无需谷歌寻找答案。例如，一个简短的文档字符串，还是一个依赖树？

似乎在 Gems 中有很多此类差异。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T22:40:59.143

如果由于脚本中的依赖关系而安装 gem，您可能可以根据以下内容进行判断：

```
require_gem 'rake', '>=0.7.0', '<0.9.0' 
```

除此之外，我不确定是否完全诚实。如果需要没有指定需要哪个，我通常会使用最新版本的东西。

[编辑] 我会首先使用看起来最成熟的那个（1.0 超过 0.X）。[/编辑]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T23:05:12.827

我认为您可以环顾四周并找到指导方针，但是否遵循它们是完全不同的事情！

这是开源软件——您无需购买任何费用，但恐怕您将不得不花费一些时间来确定一个软件包是否符合您的要求。

确定 gem 的发布时间以及更新的次数和频率相对简单。这些指标表明源正在被积极维护，并且正在努力使其持续相关。您还可以查看测试（通常与软件包一起安装）、是否存在错误跟踪设施、讨论组或论坛等，以评估开发人员的承诺程度以及围绕该项目的渗透和社区数量代码。

除此之外，你还希望什么？性价比？某个中央权威机构认可图书馆的用途？这不会很快发生，而且这可能，总的来说，不是坏事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T23:33:19.983

`details`如果您使用and`all`选项，您可以在搜索结果中获得更多详细信息，这可能会帮助您缩小范围：

```
gem search activeldap --remote --details --all 
```

`all`显示版本列表。

部分输出：

```
activeldap (1.0.2, 1.0.1, 1.0.0, 0.10.0, 0.9.0)
    Authors: Will Drewry, Kouhei Sutou
    Rubyforge: http://rubyforge.org/projects/ruby-activeldap
    Homepage: http://rubyforge.org/projects/ruby-activeldap/

    Ruby/ActiveLdap is a object-oriented API to LDAP

ambitious-activeldap (0.1.1, 0.1.0)
    Author: Matthew King
    Rubyforge: http://rubyforge.org/projects/ambition
    Homepage: http://ambition.rubyforge.org/

    An ambitious adapter for ActiveLDAP 
```

除此之外，正如迈克所说，这有点像在网上四处寻找以试图找出最相关的版本。

需要注意的一件事是：2007 年年中左右，Ruby/Rails 社区大规模迁移到 Github。因此，如果你找到了一些东西，但它不在 Github 上，请确保它不是已被取代的旧版本。

# java - 用于查看 -agentlib:hprof 分析输出的类似 HPjmeter 的图形工具

> ID：707609
> 
> 赞同：11
> 
> 时间：2009-04-01T22:33:46.990
> 
> 标签：java, profiling, hprof

有哪些工具可用于查看内置 JVM 分析器的输出？例如，我正在启动我的 JVM：

```
-agentlib:hprof=cpu=times,thread=y,cutoff=0,format=a,file=someFile.hprof.txt 
```

这会生成 hprof（“JAVA PROFILE 1.0.1”）格式的输出。

过去我曾成功使用[HPjmeter](http://h20392.www2.hp.com/portal/swdepot/displayProductInfo.do?productNumber=HPJMETER)以合理的方式查看这些输出文件。但是，无论出于何种原因，使用当前版本的 Sun JVM 生成的文件都无法在当前版本的 HPjmeter 中加载：

```
java.lang.NullPointerException
    at com.hp.jmeter.f.jb.a(Unknown Source)
    at com.hp.jmeter.f.a.a(Unknown Source)
    at com.hp.c.a.j.z.run(Unknown Source)
Exception in thread "HPeprofDataFileReaderThread" java.lang.AssertionError: null pointer exception from loader
    at com.hp.jmeter.f.a.a(Unknown Source)
    at com.hp.c.a.j.z.run(Unknown Source) 
```

（他们为什么要混淆免费产品的字节码？！）

由此产生两个问题：

1.  有谁知道这个 HPjmeter 错误的原因？（***编辑****：是的——见下文*）
2.  还有哪些其他工具可以读取 hprof 文件？为什么没有来自 Sun 的（有）？

我知道[Eclipse TPTP](http://www.eclipse.org/tptp/)和其他工具可以动态监控 JVMTI 数据，但我需要一个可以在事后处理生成的 hprof 文件的解决方案，因为部署的机器只有一个 JRE（不是 JDK）安装。

**编辑**：一位非常有帮助的 HPjmeter 开发人员[在 HP ITRC 论坛上回答了我的问题，](https://forums13.itrc.hp.com/service/forums/questionanswer.do?threadId=1329103)指出`heap=dump`需要`-agentlib`暂时包含在选项中，直到 HPjmeter 中的错误得到修复。这些信息使 HPjmeter 再次可行，但我仍然会留下这个问题，看看是否有人知道任何其他工具。

**编辑**：从 HPjmeter 4.0.00 版（05/2009 可用）开始，此错误已得到修复。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T18:34:53.477

[您的 Kit](http://www.yourkit.com) Java Profiler 能够读取 hprof 快照（我不确定是否仅用于内存分析或 CPU）。它不是免费的，但它是迄今为止我用过的最好的 java profiler。它以清晰、直观的方式呈现结果，并且在大型数据集上表现良好。文档也很不错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-05T08:51:28.190

为了查看和分析`hprof=samples`或`hprof=cpu`我使用 PerfAnal 的输出，效果很好。GUI 有点简陋，但非常有用。

*PerfAnal 是免费下载的（GPL，最初是Java Programming on Linux*书中的一个示例项目）。见这篇文章：

[http://www.oracle.com/technetwork/articles/javase/perfanal-137231.html](http://www.oracle.com/technetwork/articles/javase/perfanal-137231.html)

了解更多信息和下载。

通常你可以运行

```
java -jar PerfAnal.jar hprof.java.txt 
```

对于大型 hprof 文件，您可能需要使用 -Xmx。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T11:49:38.933

我一直在使用[Eclipse Memory Analyzer](http://www.eclipse.org/mat/)成功分析不同的性能问题。首先，在 Eclipse 中安装项目网页中描述的工具。

之后，您可以创建一个转储文件，知道要分析的 jvm 的 pid

```
jmap -dump:format=b,file=<filename>.hprof <jvm_pid> 
```

然后只需在 eclipse 中导入 .hprof 文件。它有一些自动报告尝试（对我来说，它们通常不起作用）指出哪些可能是可能的问题。

**编辑：**

回答评论：你是对的，它更像是 Java 的泄漏查找器。对于性能问题，我曾在小型项目中使用[JRat](http://jrat.sourceforge.net/)。它显示了每个方法消耗的时间、调用方法的次数、调用层次结构等。唯一的问题是，据我所知，它不支持 .hprof 文件。要使用它，你需要执行你的程序添加一个 VM 参数

```
-javaagent:<path>/shiftone-jrat.jar 
```

这将生成一个目录，其中包含该工具捕获的配置文件。然后，执行

```
 java -jar shiftone-jrat.jar 
```

并打开跟踪。即使是一个简单的工具，我认为它可能很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T23:19:22.967

我不是 100% 确定它会工作（听起来会），我不确定它会以你想要的格式显示它......但你有没有想过[VisualVM](https://visualvm.dev.java.net/)？

我相信它会打开生成的文件。

# tsql - 在 SQL Server 查询中提取字符串的第一个单词

> ID：707610
> 
> 赞同：48
> 
> 时间：2009-04-01T22:34:12.933
> 
> 标签：tsql

在 sql server 查询中提取字符串的第一个单词的最佳方法是什么？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-04-01T22:37:29.180

```
SELECT CASE CHARINDEX(' ', @Foo, 1)
     WHEN 0 THEN @Foo -- empty or single word
     ELSE SUBSTRING(@Foo, 1, CHARINDEX(' ', @Foo, 1) - 1) -- multi-word
END 
```

您也许可以在 UDF 中使用它：

```
CREATE FUNCTION [dbo].[FirstWord] (@value varchar(max))
RETURNS varchar(max)
AS
BEGIN
    RETURN CASE CHARINDEX(' ', @value, 1)
        WHEN 0 THEN @value
        ELSE SUBSTRING(@value, 1, CHARINDEX(' ', @value, 1) - 1) END
END
GO -- test:
SELECT dbo.FirstWord(NULL)
SELECT dbo.FirstWord('')
SELECT dbo.FirstWord('abc')
SELECT dbo.FirstWord('abc def')
SELECT dbo.FirstWord('abc def ghi') 
```

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2012-04-13T17:11:02.263

我想在不创建单独函数的情况下做这样的事情，并想出了这个简单的单行方法：

```
DECLARE @test NVARCHAR(255)
SET @test = 'First Second'

SELECT SUBSTRING(@test,1,(CHARINDEX(' ',@test + ' ')-1)) 
```

这将返回结果“First”

它很短，只是没有那么健壮，因为它假设您的字符串不以空格开头。它将处理单字输入、多字输入和空字符串或 NULL 输入。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-09-04T09:31:08.897

通过应用 LTRIM() 增强 Ben Brandt 的答案以补偿即使字符串以空格开头。试图编辑他的答案但被拒绝，所以我现在将它单独发布在这里。

```
DECLARE @test NVARCHAR(255)
SET @test = 'First Second'

SELECT SUBSTRING(LTRIM(@test),1,(CHARINDEX(' ',LTRIM(@test) + ' ')-1)) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-06-17T00:31:32.060

在语句之前添加以下内容`RETURN`将解决字段中包含前导空格的情况：

```
SET @Value = LTRIM(RTRIM(@Value)) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-04-10T18:53:11.427

Marc 的回答让我得到了我需要的大部分内容，但我不得不接受，`patIndex`而不是`charIndex`因为有时空格以外的字符会标记我的数据单词的结尾。在这里，我`'%[ /-]%'`用来查找空格、斜线或破折号。

```
Select race_id, race_description
    , Case patIndex ('%[ /-]%', LTrim (race_description))
        When 0 Then LTrim (race_description)
        Else substring (LTrim (race_description), 1, patIndex ('%[ /-]%', LTrim (race_description)) - 1)
    End race_abbreviation
from tbl_races 
```

结果...

```
race_id  race_description           race_abbreviation
-------  -------------------------  -----------------
1        White                      White
2        Black or African American  Black
3        Hispanic/Latino            Hispanic 
```

警告：这是针对小型数据集（美国联邦种族报告类别）；我不知道当扩展到大量时性能会发生什么。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-11-03T11:19:36.657

```
DECLARE @string NVARCHAR(50)

SET @string = 'CUT STRING'

SELECT LEFT(@string,(PATINDEX('% %',@string))) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-05-12T08:56:57.103

从指定字段中提取第一个单词：

```
SELECT SUBSTRING(field1, 1, CHARINDEX(' ', field1)) FROM table1; 
```

从指示的字段中提取第二个和连续的单词：

```
SELECT SUBSTRING(field1, CHARINDEX(' ', field1)+1, LEN (field1)-CHARINDEX(' ', field1)) FROM table1; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-09-14T06:05:20.667

```
对函数稍加调整即可从条目中的起点返回下一个单词

    创建函数 [dbo].[GetWord]
    (
        @value varchar(最大值)
        , @startLocation 整数
    )
    返回 varchar（最大值）
    作为
      开始

         SET @value = LTRIM(RTRIM(@Value))  
         选择@startLocation =
                案子
                    当@startLocation > Len(@value) THEN LEN(@value)
                    否则@startLocation
                结尾

            选择@值 =
                案子
                    当@startLocation > 1
                        然后 LTRIM(RTRIM(RIGHT(@value, LEN(@value) - @startLocation)))
                    否则@值
                结尾

            返回案例 CHARINDEX(' ', @value, 1)
                    当 0 时 @value
                    ELSE SUBSTRING(@value, 1, CHARINDEX(' ', @value, 1) - 1)
                结尾

     结尾
    去

    选择 dbo.GetWord(NULL, 1)
    选择 dbo.GetWord('', 1)
    选择 dbo.GetWord('abc', 1)
    SELECT dbo.GetWord('abc def', 4)
    SELECT dbo.GetWord('abc def ghi', 20)

```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-24T15:35:45.753

试试这个：

```
Select race_id, race_description
, Case patIndex ('%[ /-]%', LTrim (race_description))
    When 0 Then LTrim (race_description)
    Else substring (LTrim (race_description), 1, patIndex ('%[ /-]%', LTrim (race_description)) - 1)
End race_abbreviation 
```

来自 tbl_races

# c - 刷新通信句柄接收缓冲区？

> ID：707613
> 
> 赞同：3
> 
> 时间：2009-04-01T22:35:35.067
> 
> 标签：c, windows, winapi

在 Win32 C 中是否有一个 API 调用来刷新（转储）COM 端口接收缓冲区的内容？我只能找到刷新传输缓冲区的函数。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-01T23:33:51.650

[`PurgeComm()'](http://msdn.microsoft.com/en-us/library/aa363428(VS.85).aspx)可以删除 Tx 和 Rx 缓冲区中的一个或两个中的所有字符，并中止端口上任何未决的读取和/或写入操作。要对端口执行所有操作，可以这样说：

```
PurgeComm(hPort, PURGE_RXABORT|PURGE_TXABORT|PURGE_RXCLEAR|PURGE_TXCLEAR) 
```

您可能还想确保您已经处理或明确忽略了端口上的任何未决错误，可能使用[`ClearCommError()`](http://msdn.microsoft.com/en-us/library/aa363180(VS.85).aspx).

[`ReadFile()`](http://msdn.microsoft.com/en-us/library/aa365467(VS.85).aspx)可用于通过将所有可用字节读入废物缓冲区来清空 Rx 缓冲区和 FIFO。请注意，您可能需要具备“非自然”知识才能正确调整该缓冲区的大小，或者重复`ReadFile()`调用直到它没有更多可说的。

[但是，读取缓冲区以刷新它只有在您首先“合理地”设置COMMTIMEOUTS](http://msdn.microsoft.com/en-us/library/aa363190(VS.85).aspx)或读取将阻塞直到缓冲区被填满时才有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T22:47:12.653

刷新接收缓冲区没有意义，要从 com 端口接收缓冲区中获取数据，只需在 com 端口的句柄上调用 ReadFile

FlushFileBuffers 同步强制传输缓冲区中的数据传输

PurgeComm 清空缓冲区而不进行传输或接收（基本上是删除）

# ruby-on-rails - 在 rake 任务期间关闭观察者的简单方法？

> ID：707615
> 
> 赞同：40
> 
> 时间：2009-04-01T22:36:39.433
> 
> 标签：ruby-on-rails, ruby, observer-pattern, restful-authentication

我在我的应用程序中使用了 restful_authentication。我正在使用 rake 任务创建一组默认用户，但是每次我运行该任务时，都会发送一封激活电子邮件，因为观察者与我的用户模型相关联。我在创建用户时设置了激活字段，因此不需要激活。

任何人都知道在运行 rake 任务时绕过观察者的简单方法，以便在我保存用户时不会发送电子邮件？

谢谢。

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2011-12-02T08:01:20.827

Rails 3.1 最终为此提供了 API：http: [//api.rubyonrails.org/v3.1.0/classes/ActiveModel/ObserverArray.html#method-i-disable](http://api.rubyonrails.org/v3.1.0/classes/ActiveModel/ObserverArray.html#method-i-disable)

```
ORM.observers.disable :user_observer
  # => disables the UserObserver

User.observers.disable AuditTrail
  # => disables the AuditTrail observer for User notifications.
  #    Other models will still notify the AuditTrail observer.

ORM.observers.disable :observer_1, :observer_2
  # => disables Observer1 and Observer2 for all models.

ORM.observers.disable :all
  # => disables all observers for all models.

User.observers.disable :all do
  # all user observers are disabled for
  # just the duration of the block
end 
```

`ORM`例如可以在哪里`ActiveRecord::Base`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-02T20:59:12.413

您可以向您的用户模型添加一个访问器，例如“skip_activation”，它不需要保存，但会在会话中持续存在，然后检查观察者中的标志。就像是

```
class User
  attr_accessor :skip_activation
  #whatever
end 
```

然后，在观察者中：

```
def after_save(user)
  return if user.skip_activation
  #rest of stuff to send email
end 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-03-10T14:19:00.337

作为观察者的标志，我喜欢定义一个名为“disabled”的类访问器，所以它看起来像这样：

```
class ActivityObserver < ActiveRecord::Observer
  observe :user

  # used in tests to disable the observer on demand.
  cattr_accessor(:disabled)
end 
```

我把它作为敏感回调的条件

```
def after_create(record)
       return if ActivityObserver.disabled
       # do_something
end 
```

我只是在需要时打开标志

```
ActivityObserver.disabled=true 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-12-04T22:18:11.963

另一个你可以尝试的（rails 3）

```
config.active_record.observers = :my_model_observer unless File.basename($0) == 'rake' 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-01T23:43:06.107

一般来说，对于这些情况，您可以：

1.  设置一个模拟对象来“吸收”不需要的行为
2.  有一个外部可访问的标志/开关，观察者尊重以抑制行为
3.  向观察者添加逻辑以检测*一般*何时不需要该行为（例如 dbarker 建议的内容）
4.  有一个全局标志“测试”、“调试”、“启动”或任何改变低级行为的东西
5.  内省并移除观察者
6.  向您的模型添加一个方法，该方法执行另一个未观察到的任务版本（尽可能与普通方法共享实现）。

在这种情况下，我会说#3 是你最好的选择。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-03T04:35:13.567

在我正在开发的应用程序上运行测试时，我使用以下内容：

```
Model.delete_observers 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-10-05T10:47:23.540

禁用 Rails 3 的观察者很简单：

```
Rails.configuration.active_record.observers = [] 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-02-10T23:24:13.713

你可以从观察者那里拿掉这个方法；

```
MessageObserver.send(:remove_method, :after_create) 
```

将通过删除它来停止 MessageObserver 上的 :after_create 。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-01-31T19:29:54.123

我来这里是为了寻找相同的答案......以上似乎都没有解决问题（或涉及向我的应用程序代码添加特定于迁移的逻辑——嘘）。

这是我想出的（有点蹩脚，它需要在每个相关的迁移中进行，但是......）

```
class ChangeSomething < ActiveRecord::Migration

  # redefine...
  class MessageObserver < ActiveRecord::Observer
    def after_create(observed) ; end
    def after_update(observed) ; end
  end

  def self.up
    # Message create/update stuff...
  end
end 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-12-13T00:40:09.643

```
User.skip_callback("create", :after, :send_confirmation_email)

....

User.set_callback("create", :after, :send_confirmation_email) 
```

更多关于这个：

[在 Rails 3 中禁用回调](http://www.multunus.com/2011/05/disabling-callbacks-in-rails-3)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-01T22:59:38.690

据我所知，没有一种简单的方法可以禁用观察者，但听起来可以向您的观察者添加逻辑，以便在设置激活码时不发送电子邮件......

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-02T13:46:48.667

正如其他人所暗示的那样；我会用一个简单的 if 语句将不需要的逻辑包装在您的 Observer 中。

```
def after_create
  send_email if RAILS_ENV == "production"
end 
```

# .net - 您可以将 .net 3.5 DLL 与 .net 2.0 网站一起使用吗？

> ID：707622
> 
> 赞同：6
> 
> 时间：2009-04-01T22:39:07.603
> 
> 标签：.net, asp.net, .net-3.5, .net-2.0

我有一些 DLL，在内部使用 .net 3.5 会更容易（利用 Linq 等）。我想将这些 DLL 与当前运行 asp.net 2.0 的 asp.net 网站一起使用。

这种情况可能吗？是否有任何限制或陷阱（例如，asp.net 不会对返回 .net 3.5 对象（如 IQueryable）的方法进行任何调用）？

注意：当然，.net 3.5 将安装在服务器上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T15:27:15.753

为了扩展 foosnazzy 所说的内容，.NET 3.5 (SP1) 只是带有一些新程序集的 .NET 2.0 SP2。不将其安装在网站上的唯一原因是该网站无法使用 .NET 2.0 SP2 运行。

这与过去的方式非常不同 - 在我负责的 .NET 1.0 网站上安装 .NET 1.1 破坏了网站，即使该网站没有使用 1.1 - 我已经安装了 1.1，所以我可以使用特定的工具。从 .NET 1.1 升级到 .NET 2.0 是一场更糟糕的噩梦。

但微软从中吸取了教训。从 2.0 .NET 3.5 SP1 开始的 .NET 版本都使用 .NET 2.0 公共语言运行时 (CLR)。事实上，安装 3.5 的人经常会惊讶地看到 IIS 设置并发现他们的网站仍然显示为运行 .NET 2.0。但它与 .NET 2.0 完全相同，只是应用了两个服务包。任何不使用新程序集的站点都不会受到影响（除了服务包可能会做的事情）。

进一步重申已经说过的内容 - C# 3.0 功能独立于框架。例如，您可以在纯 .NET 2.0 代码中使用匿名类型和 lambda。您*不能*做的是使用 LINQ，因为这需要 .NET 3.5 中的新程序集。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T22:42:26.457

您可以在 .net 2.0 中使用 C# 3 的许多功能，但 Linq 不是其中之一。您必须包含 Linq DLL，不允许单独分发，并且必须安装完整的 3.5 运行时。

注意：如果安装了 .net 3.5，如果站点未配置为包含 3.5 的程序集，我认为您将遇到麻烦。它可能在 Web 应用程序项目（而不是 Web 窗体项目）中工作，因为 dll 是预先编译的，并且可能在 PE 文件中包含必要的引用，但我不确定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T22:43:19.683

3.5 添加到 2.0 框架，一切都完全向后兼容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-01T23:47:27.547

总是有[LinqBridge](http://www.albahari.com/nutshell/linqbridge.aspx)，它允许您在 .Net 2.0 环境中使用 Linq To Objects。但是，将它与 ASP.Net 一起使用有一些注意事项，具体取决于您使用的是 ASP.NET Web 应用程序还是 ASP.NET 网站项目。请参阅[此页面](http://onceuponans.blogspot.com/2008/06/using-c-30-in-aspnet-20.html)了解更多信息。

# sql-server - SQL Server CE 中的 Shrink 和 Compact 有什么区别？

> ID：707625
> 
> 赞同：9
> 
> 时间：2009-04-01T22:40:04.447
> 
> 标签：sql-server, sql-server-ce

我有一个定期运行的方法来优化我的应用程序的 SQL Server Compact Edition (3.5) 数据库。现有代码使用 Shrink() 方法：

```
 SqlCeEngine engine = new SqlCeEngine(dbConnectionString);
        engine.Shrink(); 
```

今天我注意到还有一个 Compact() 方法。哪个更适合定期维护？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-01T22:47:14.400

来自[SQL Server Compact 团队博客](http://blogs.msdn.com/sqlservercompact/archive/2007/10/26/sqlceengine-issceengine-shrink-vs-repair.aspx)：

> 这两者之间的区别与内部和外部内存碎片非常相似。
> 
> 从[SqlCeEngine.Shrink](http://msdn.microsoft.com/en-us/library/system.data.sqlserverce.sqlceengine.shrink.aspx)文档中，
> 
> 通过将空的和未分配的页面移动到文件末尾，然后截断文件来回收数据库中浪费的空间。您可以通过在连接字符串中设置自动收缩阈值选项来将数据库配置为自动收缩。Shrink 不会创建临时数据库文件。
> 
> 从[SqlCeEngine.Compact](http://msdn.microsoft.com/en-us/library/system.data.sqlserverce.sqlceengine.compact.aspx)文档中，
> 
> 通过从现有文件创建新的数据库文件来回收数据库中浪费的空间。通过创建一个新的数据库意味着，它回收了行之间的空闲空间。
> 
> 更清楚地说，Shrink 声明了完全免费或未分配的页面；其中，Compact 也声称在页面中浪费了空间。因此 Compact 需要创建一个新的数据库文件。

# html - 如何确定包含 ActiveX 控件的 DIV 元素何时更改大小（不进行轮询）？

> ID：707636
> 
> 赞同：1
> 
> 时间：2009-04-01T22:45:00.333
> 
> 标签：html, activex

我有一个包含 activex 控件的 DIV。

此控件可以根据用户戳的按钮自行调整大小。

当控件调整自身大小时，我想重新定位 DIV。

在没有轮询的情况下，如何确定控件或 DIV 大小何时更改？

可以做到吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T22:51:56.527

尝试在 DIV 上 放置一个[onresize 事件处理程序。](http://msdn.microsoft.com/en-us/library/ms536959(VS.85).aspx)

# powershell - PowerShell 中用于脚本测试的 Echo 等效项

> ID：707646
> 
> 赞同：301
> 
> 时间：2009-04-01T22:49:06.517
> 
> 标签：powershell

我想通过设置标志并查看整个脚本中的数据矩阵来在[PowerShell脚本中输出变量和值。](http://en.wikipedia.org/wiki/Windows_PowerShell)

我该怎么做？

例如，与以下 PHP 代码等效的 PowerShell 是什么？

```
echo "filesizecounter: " . $filesizecounter 
```

* * *

## 回答 #1

> 赞同：348
> 
> 时间：2009-04-01T22:59:29.363

有几种方法：

[`Write-Host`](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/write-host)：直接写入控制台，不包含在函数/cmdlet 输出中。允许设置前景色和背景色。

[`Write-Debug`](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/write-debug)：直接写入控制台，如果[`$DebugPreference`](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_preference_variables#debugpreference)设置为继续或停止。

[`Write-Verbose`](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/write-verbose)：直接写入控制台，如果[`$VerbosePreference`](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_preference_variables#verbosepreference)设置为继续或停止。

后者旨在提供额外的可选信息，`Write-Debug`用于调试（因此似乎适合这种情况）。

**附加**：在 PSH2（至少）中，使用 cmdlet 绑定的脚本将自动获取`-Verbose`和`-Debug`switch 参数，在本地启用`Write-Verbose`和`Write-Debug`（即覆盖首选项变量），就像编译的 cmdlet 和提供程序一样。

* * *

## 回答 #2

> 赞同：148
> 
> 时间：2009-10-28T20:38:37.787

Powershell 有一个别名映射`echo`到`Write-Output`，所以你可以使用：

```
echo "filesizecounter : $filesizecounter" 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2009-04-01T22:52:54.230

PowerShell 内插，不是吗？

在 PHP 中

```
echo "filesizecounter: " . $filesizecounter 
```

也可以写成：

```
echo "filesizecounter: $filesizecounter" 
```

在 PowerShell 中，这样的东西应该适合您的需求：

```
Write-Host "filesizecounter: $filesizecounter" 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2009-04-02T01:09:10.580

```
Write-Host "filesizecounter : " $filesizecounter 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2010-01-14T15:39:26.630

到目前为止，在 powershell 中回显的最简单方法是创建字符串对象并让管道输出它：

```
$filesizecounter = 8096
"filesizecounter : $filesizecounter" 
```

当然，当不使用 Write-* 方法时，您确实放弃了一些灵活性。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2014-09-08T07:12:26.547

echo 是[Write-Output](http://technet.microsoft.com/en-us/library/hh849921.aspx)的别名，尽管它看起来与[Write-Host](http://technet.microsoft.com/en-us/library/hh849877.aspx)相同。

这不是*[PowerShell 中的 echo 和 Write-Host 有什么区别？](https://stackoverflow.com/questions/17623644)*.

echo 是 Write-Output 的别名，它写入 Success 输出流。这允许通过管道处理输出或将输出重定向到文件中。Write-Host 直接写入控制台，因此无法进一步重定向/处理输出。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2017-05-23T08:36:00.953

写主机工作正常。

```
$Filesize = (Get-Item $filepath).length;
Write-Host "FileSize= $filesize"; 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2020-03-02T08:51:57.467

还应该提到的是，[Set-PSDebug](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/set-psdebug?view=powershell-7)类似于老式的`echo on`批处理命令：

```
Set-PSDebug -Trace 1 
```

此命令将导致显示执行脚本的每一行：

> 当`Trace`参数的值为 时`1`，每行脚本都会在运行时被跟踪。当参数的值为 时`2`，还会跟踪变量赋值、函数调用和脚本调用。如果`Step`指定了参数，则在脚本的每一行运行之前都会提示您。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2019-10-21T05:02:07.810

PowerShell 有几个常见命令的别名，例如`echo`. 在 PowerShell 中键入以下内容：

```
Get-Alias echo 
```

得到回应：

```
CommandType     Name                                               Version    Source
-----------     ----                                               -------    ------
Alias           echo -> Write-Output 
```

甚至 Get-Alias 也有 alias `gal -> Get-Alias`。您可以写信`gal echo`以获取`echo`.

```
gal echo 
```

此处列出了其他别名： [https ://docs.microsoft.com/en-us/powershell/scripting/learn/using-familiar-command-names?view=powershell-6](https://docs.microsoft.com/en-us/powershell/scripting/learn/using-familiar-command-names?view=powershell-6)

`cat dir mount rm cd echo move rmdir chdir erase popd sleep clear h ps sort cls history pushd tee copy kill pwd type del lp r write diff ls ren`

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2015-01-19T09:07:40.980

我不知道这样做是否明智，但你可以写

```
"filesizecounter: " + $filesizecounter 
```

它应该输出：

> 文件大小计数器：值

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-01-15T20:50:17.823

尝试一下`Get-Content .\yourScript.PS1`，您将看到脚本的内容。

你也可以在你的脚本代码中插入这一行：

```
get-content .\scriptname.PS1
script code
script code 
```

……

# database - 选择最佳主键 + 编号系统

> ID：707657
> 
> 赞同：24
> 
> 时间：2009-04-01T22:55:08.063
> 
> 标签：database, database-design, primary-key

我们正在尝试为我们正在创建的资产系统提出一个编号系统，在办公室对此话题进行了一些激烈的讨论，所以我决定询问 SO 的专家。

考虑下面的数据库设计会是更好的选择。

![替代文字](https://i.stack.imgur.com/av4vO.png)

**示例 1：**使用自动代理键。

```
=================   ==================
Road_Number(PK)     Segment_Number(PK)
=================   ==================
 1                   1 
```

**示例 2：**使用程序生成的 PK

```
=================   ==================
Road_Number(PK)     Segment_Number(PK)
=================   ==================
 "RD00000001WCK"     "00000001.1" 
```

（这`00000001.1`意味着它是道路的第一段。**每次**添加新路段时都会增加，*例如*`00000001.2`）

**示例 3：**两者都使用（添加新列）

```
=======================    ==========================
ID(PK) Road_Number(UK)     ID(PK)  Segment_Number(UK)
=======================    ==========================
 1     "RD00000001WCK"       1       "00000001.1" 
```

只是一点背景信息，我们将在报告和其他文档中使用`Road Number`and `Segment Number`，因此它们必须是**唯一的**。

我一直喜欢保持简单，所以我*更喜欢*示例 1，但我一直在读到你不应该在报告/文档中公开你的主键。所以现在我更多地按照示例 3 的思路进行思考。

我也倾向于示例 3，因为如果我们决定更改资产编号的生成方式，则不必对主键进行级联更新。

你认为我们应该怎么做？

谢谢。

编辑：感谢大家的精彩回答，对我帮助很大。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-04-05T01:51:37.047

这实际上是关于代理（也称为技术或合成）与自然主键的讨论，该主题已被广泛讨论。我在[AppDevelopers 所犯的数据库开发错误](https://stackoverflow.com/questions/621884/database-development-mistakes-made-by-appdevelopers/621891#621891)中对此进行了介绍。

> 自然键是基于（表面上）唯一的外部有意义数据的键。常见的例子是产品代码、两个字母的州代码（美国）、社会安全号码等。代理或技术主键是那些在系统之外绝对没有意义的主键。它们纯粹是为了识别实体而发明的，通常是自动递增的字段（SQL Server、MySQL 等）或序列（最著名的是 Oracle）。
> 
> 在我看来，您应该**始终** 使用代理键。这个问题出现在这些问题中：
> 
> *   [你喜欢你的主键吗？](https://stackoverflow.com/questions/404040/how-do-you-like-your-primary-keys)
> *   [表中主键的最佳做法是什么？](https://stackoverflow.com/questions/337503/whats-the-best-practice-for-primary-keys-in-tables)
> *   [在这种情况下，您将使用哪种格式的主键。](https://stackoverflow.com/questions/506164/which-format-of-primary-key-would-you-use-in-this-situation)
> *   [代理与。自然/业务密钥](https://stackoverflow.com/questions/63090/surrogate-vs-natural-business-keys)
> *   [我应该有一个专用的主键字段吗？](https://stackoverflow.com/questions/166750/should-i-have-a-dedicated-primary-key-field)

自动编号字段是要走的路。如果您的密钥在您的数据库之外有意义（例如资产编号），那么这些密钥很可能会发生变化，并且更改密钥是有问题的。只需将这些内容的索引用于相关表即可。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-01T22:57:10.867

我个人会说保持简单并使用自动递增的主键。如果您在程序中的显示方面需要更多“可读”的东西，那么可能是您的其他想法之一，但我认为这只是给主键字段增加了不必要的复杂性。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-01T23:31:51.080

我也非常强烈地支持“不要将主键用作有意义的数据”阵营。每次我违反该政策时，都会以眼泪收场。有意义的数据迟早需要更改，如果这意味着您必须更改主键，那可能会很痛苦。主键可能会在外键约束中使用，您可能会花费很长时间尝试将其全部整理出来，只是为了进行简单的数据更改。

在我创建的每个表中，我总是使用 GUID/UUID 作为我的主键，但这只是个人喜好序列等也很好。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-02T00:10:24.620

除非...

*   价值永远不会改变是 100% 完全不可能的

*   没有两个人会合理
    地争论应该
    为特定行使用哪个值。

使用选项一并格式化应用程序中的值，使其在显示时看起来像选项二或三。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-10T14:55:47.357

我认为这里要记住的重要一点是，数据库/设计中的每个表都可能有多个键。这些是**候选键**。 [请参阅 wikipedia entry for Candidate Keys](http://en.wikipedia.org/wiki/Candidate_key)

根据定义，所有候选键都是平等的。它们都是相关表的唯一标识符。

然后，您的工作是从候选键池中选择最佳候选键作为**主键**。其他表将使用主键来建立关系约束，但您可以继续使用候选键来查询表。

因为主键被其他结构引用，因此在连接操作中使用，主键选择的标准对我来说归结为以下（按重要性排序）：

*   **不可变/稳定**- 主键值不应更改。如果他们这样做，您将面临引入更新异常的风险
*   **不为空**- 大多数 DBMS 平台要求主键属性不为空
*   **简单**- 用于物理存储和性能的简单数据类型和值。整数值在这里工作得很好，这是大多数代理/自动生成键的选择数据类型

一旦您确定了候选键，就可以使用上述标准来选择主键。如果没有符合标准的“自然”候选键，则可以创建并使用符合标准的代理键，如其他答案中所述。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-01T23:09:53.783

遵循不使用政策。

您可能会遇到的一些问题：

您需要从多个主机生成密钥。

有人会想要保留连续的号码一起使用。

人们希望它有多有意义？战争为此而战，而您已经处于第一次小规模冲突中。“它已经很有意义了，如果我们再添加两个数字，我们就可以......”即您正在建立一种（应该）可扩展的设计风格。

如果您将两者连接起来，那么您正在执行类型转换，这可能会弄乱您的查询优化器。

您需要重新分类道路，并重新定义它们的边界（即移动道路），这意味着更改主键并可能丢失链接。

所有这些都有解决方法，但这是一种解决方法激增并失控的问题。只需要一对夫妇就可以超越“简单”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-05T10:50:33.083

如前所述，无论您的平台上的最佳数据类型是什么，都将您的内部主键保留为键。

但是，您确实需要解决编号系统参数，因为这实际上是业务需求，也许我们将其称为资产的识别系统。

如果只有一个标识符，则将其作为一列添加到主表中。如果可能有很多识别系统（资产通常有很多），您将需要另外两个表

```
    标识符类型表 Identifier-cross-ref 表
      type-id ------------> type-id（唯一
      类型名称标识符字符串键）
                                        内部标识

```

这样，需要访问资产的不同人员可以以自己的方式进行识别。例如，服务器团队将识别与网络团队不同的服务器，并再次与项目管理、帐户等不同。

此外，您还可以参加每个人都互相争论的所有会议。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-01T23:28:32.070

要记住的另一件事是，如果您将大量数据导入此系统，您可能会发现诸如此类的事情`Road_Number`并不像您想象的那么独特，并且可能存在解决问题的操作障碍（重新粉刷路标， ETC。） 。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-10T10:16:41.960

虽然自然密钥对业务用户可能具有重要意义，但如果您不同意这些密钥是神圣的并且不应更改，那么您很可能会在维护“产品代码具有进行更改以适应公司收购的新产品线。” 您需要保护数据的 RI，而整数作为具有自动增量的主键是最好的方法。索引和遍历整数时的性能也比 char 列更好。

虽然不适合作为主键，但自然键非常适合用户使用，您可以通过索引强制执行唯一性。它们为数据带来了背景，使各方更容易理解。此外，在您需要重新加载数据时，自然键可以帮助验证您的查找仍然有效。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-10T13:42:26.457

我会使用代理键，但如果这样可以改善您的报告，您可能希望有一个计算列将代理键“格式化”为更“可读”的值。计算的列可以从代理键生成示例 2，例如用于显示目的。

我认为代理键路由是要走的路，我为此做的唯一例外是连接表，其中主键可以由外键引用组成。即使在这些情况下，我发现拥有代理主键比没有更有用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-10T17:36:36.567

我怀疑您真的应该使用选项＃3，正如这里许多人已经说过的那样。即使有足够的业务密钥，代理 PK（整数或 GUID）也是一种很好的做法。代理人将减少维护方面的麻烦（正如您自己已经指出的那样）。

话虽如此，您可能需要考虑的是您的数据库是否是：

1.  专注于数据维护和事务处理（即创建/更新/删除操作）
2.  面向分析和报告（即查询）

换句话说，用户是否关心维护活动数据或查询大部分静态数据以找到答案？

如果您非常专注于构建一个分析和报告数据库（例如数据仓库/集市），该数据库暴露给对业务词汇有很好掌握的技术业务用户（例如报表设计人员），那么您可能需要考虑使用自然基于有意义的业务价值的密钥。它们通过消除对复杂连接的需求来帮助降低查询复杂性，并帮助用户专注于他们的任务，而不是与数据库结构抗争。

否则，您可能专注于必须在某种程度上涵盖所有基础的完整 CRUD 数据库 - 这是绝大多数情况。在这种情况下，请使用您的选项#3。将来您始终可以针对可查询性进行优化，但您将很难为可维护性进行改造。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-11T21:08:14.707

我希望你会同意我的观点，即每个设计元素都应该有一个单一的目的。

问题是你认为PK的目的是什么？如果要识别表中的唯一记录，那么代理键就没有太多麻烦了。这是简单而直接的。

就选项 3 中的新列而言，您应该检查是否可以计算这些列（最好是在模型层中进行计算，以便它们可以比在 RDBMS 中进行的计算更容易更改）而不会造成太多的性能损失其他元素。例如，您可以将路段号和道路号存储在相应的表中，然后使用它们生成“00000001.1”。这将允许即时更改资产编号。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-12T00:59:58.693

首先，选项 2 是绝对最差的选项。作为一个索引，它是一个`string`, 这让它变慢了。它是根据业务规则生成的——这可能会发生变化并引起相当大的头痛。

就个人而言，我总是使用单独的主键列；我总是使用 GUID。由于硬盘空间的原因，一些开发人员更喜欢简单的 INT 而不是 GUID。但是，如果出现需要合并两个数据库的情况，GUID 几乎不会发生冲突（而 INT 肯定会发生冲突）。

**用户永远不**应该看到主键。让它对用户可读不应该是一个问题。主键**应该**用于与外键链接。这是他们的目的。该值应该是机器可读的，并且一旦创建，就永远不会改变。

# c# - C# DataTable ItemArray 返回 '{}' - 如何测试空值？

> ID：707658
> 
> 赞同：11
> 
> 时间：2009-04-01T22:55:44.253
> 
> 标签：c#, datatable, null, datarow

我有一个`DataTable resultSet;`- 我正在尝试检查字段是否为空，但要返回一个“{}”（空集？）对象。涉及“{}”的搜索没有产生任何合适的解决方案。

这是“fk_id”字段为空时无法按预期工作的代码：

```
if (resultSet.Rows[0].ItemArray[resultSet.Columns.IndexOf("fk_id")] == null)
{
   //never reaches here
} 
```

注意：使用 int 索引而不是 the`Columns.IndexOf()`不是问题。

“{}”在 C# 中还有其他名称吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-01T23:01:27.580

要检查 DataSet 中的 DBNull 列，可以使用[IsNull](http://msdn.microsoft.com/en-us/library/system.data.datarow.isnull.aspx)方法：

```
if (resultSet.Rows[0].IsNull("fk_id")) 
```

您的比较`null`可能失败，因为 DataSets 不`null`用于表示“数据库 NULL”值 - 它们使用[DBNull.Value](http://msdn.microsoft.com/en-us/library/system.dbnull.value.aspx)。如果您需要您的代码按照您呈现的方式工作，请尝试以下操作：

```
if (resultSet.Rows[0].ItemArray[resultSet.Columns.IndexOf("fk_id")] == DBNull.Value) 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2011-05-16T22:45:25.000

```
try
{
    if (DT.Rows[0][0] != null)
    {      
      //your code
    }    
}    
catch    
{    
    MessageBox.Show("AUTHANICATION FAILED.");    
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-01-26T07:24:34.883

请用：

```
dataTable.Select("FieldName is NULL") 
```

这将为您提供 FieldName 列中具有空值的 DataRows。

# c# - 以编程方式将 WPF UserControl 转换为 DLL

> ID：707659
> 
> 赞同：0
> 
> 时间：2009-04-01T22:56:27.653
> 
> 标签：c#, wpf, reflection, user-controls, process

我正在代码中生成一个 WPF UserControl，我想将其保存为 DLL 以在不同的应用程序中使用。保存 DLL 的过程需要完全自动化。尝试使用 System.Reflection 或使用 csc 来执行此操作会更好吗？或者，有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T06:22:39.517

我认为您应该为此目的使用 CodeCompiler。不需要反射或脱壳 csc，因为所有必需的支持都已在 .net 框架中提供。

查看 Microsoft 支持文章：[“如何使用 C# 编译器以编程方式编译代码”](http://support.microsoft.com/default.aspx/kb/304655)。还可以查看MSDN上的“ [System.CodeDom.Compiler ”命名空间。](http://msdn.microsoft.com/en-us/library/system.codedom.compiler.aspx)

此外，您还需要进行一些谷歌搜索，以找到适合您需求的样本。代码生成已经讨论了很多，因此您在查找示例时不会遇到问题。

您可能还对自动生成源代码感兴趣，因此 T4 也值得一看。请参阅[Oleg Sych](http://www.olegsych.com/)博客以了解有关 T4 生成的所有详细信息。

# c++ - 序列化结构

> ID：707664
> 
> 赞同：0
> 
> 时间：2009-04-01T22:58:42.967
> 
> 标签：c++, serialization, struct

我正在做一个家庭作业项目，我正在尝试将库存数据存储到一个文件中。

库存数据大小不应该太大，因为从技术上讲，没有人会真正使用它。

**我需要将这些内容写入文件：**

• 项目描述 • 现有数量 • 批发成本 • 零售成本 • 添加到库存的日期

**我将需要制作一个允许我执行此操作的界面：**

• 向文件中添加新记录 • 显示文件中的任何记录 • 更改文件中的任何记录

结构将是处理这个 imo 的最简单方法。如果我能弄清楚如何读取/写入结构到文件，这应该很容易。

如果你能提供一个关于如何做到这一点的小例子，我将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T23:06:27.897

问你的老师，你能使用boost库吗？
如果是，请阅读 boost 序列化教程，它包含一个简单的示例： http: [//www.boost.org/doc/libs/1_38_0/libs/serialization/doc/tutorial.html](http://www.boost.org/doc/libs/1_38_0/libs/serialization/doc/tutorial.html)

但是如果你想了解如何处理文件，你应该在没有任何帮助或提升的情况下完成这项工作。

如果你想使用 std::[io]fstreams 你应该决定你将支持什么格式：
- 文本 - 在这种情况下，最好的方法是定义 operator<< 和 operator>> 并将它们用于将结构写入文件或读取；
- 二进制 - 您的结构应该是 POD（普通旧数据）并且不应该包含指针 - 您将使用读取和写入流方法。
二进制文件示例：
[http ://www.codeguru.com/forum/showthread.php?t=269648](http://www.codeguru.com/forum/showthread.php?t=269648)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T23:10:24.517

如果您不介意非常低的级别，您可以通过将指向结构的指针转换为`void*`并使用`sizeof()`来获取结构长度来位复制结构。（IIRC 它们是一种将 void 缓冲区转储到文件/从文件读取的方法）

* * *

请注意，这仅在数据没有指针/引用/等时才有效。

* * *

我比 C++ 更喜欢[C 的 IO ，所以：](http://www.cs.cf.ac.uk/Dave/C/node18.html)

```
typedef struct { int hi; int mon; char[35] dat; } S;

S s;
S arr[22];
int f; 
```

* * *

```
 // write
f = open(/* I forget the args*/);

  // one
if(sizeof(s) != write(f, &s, sizeof(s))) Error();
  // many
if(sizeof(arr) != write(f, arr, sizeof(arr))) Error();

close(f); 
```

* * *

```
 // read
f = open(/* I forget the args*/);

  // one
if(sizeof(s) != read(f, &s, sizeof(s))) Error();
  // many
if(sizeof(arr) != read(f, arr, sizeof(arr))) Error();

close(f); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T23:03:37.153

**IOStream 库**做到了

> [ofstream](http://www.cplusplus.com/reference/iostream/ofstream/)类提供了将数据作为输出流写入文件的接口。
> 
> [ifstream](http://www.cplusplus.com/reference/iostream/ifstream/)类提供了从文件中读取数据作为输入流的接口

编辑- [示例](http://www.linuxtopia.org/online_books/programming_books/c++_practical_programming/c++_practical_programming_079.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T23:02:34.613

我会选择 XML；它是结构化的，基于文本的，因此您可以使用任何文本编辑器查看它。

# vb.net - 在 VB .NET 中生成从 LINQ 到 XML 的复杂对象

> ID：707670
> 
> 赞同：0
> 
> 时间：2009-04-01T23:01:34.117
> 
> 标签：vb.net, linq

我有一个使用 LINQ 处理的 XML 文件。我想基本上将 XML 数据序列化为自定义对象，但不知道如何。

简化的 XML

```
<Data>
   <Group id="1">
      <Child id="1"/>
      <Child id="2"/>
      <Child id="3"/>
   </Group>
   <Group id="2">
      <Child id="1"/>
      <Child id="2"/>
      <Child id="3"/>
   </Group>
</Data> 
```

我有一个名为 Group 的类，它有一个名为 Children 的属性，它是 (Child) 的列表。

我可以在 linq 中执行以下操作来生成 Enurable( of Group)：

```
 dim g = From item In _
 XElement.Load("XMLFile.xml", LoadOptions.None)...<Group> _
 Select New nABLE4ConfigInfo.Group(item.@id) 
```

如何完成上述 LINQ 查询以填充 Group 对象的 Children 属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T23:59:08.720

我认为这个类，与 配对`System.Xml.Serialization.XmlSerializer`，会做的伎俩：

```
<Serializable> _
Public Class Data

   <Serializable> _
   Public Class Group

       <Serializable> _
       Public Class Child
           <XmlAttribute> _
           Public id As Integer
       End Class

       <XmlArray> _
       Public Child() As Child

       <XmlAttribute> _
       Public id As Integer

   End Class

  <XmlArray> _
  Public Group() As Group
End Class 
```

该类可能还需要一些工作：正确设置数组可能很棘手。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T07:04:49.850

它就像嵌套的 select 语句和类上的正确构造函数一样简单。

```
 Dim g = From item In _
      XElement.Load("XMLFile.xml", LoadOptions.None)...<Group> _
             Select New Group(id:=item.@id, _
                   Children:=(From c In item...<Child>  Select c.@id).ToList) 
```

# python - 如何在 Python 中比较对象的类型？

> ID：707674
> 
> 赞同：198
> 
> 时间：2009-04-01T23:03:05.533
> 
> 标签：python, types, compare

基本上我想这样做：

```
obj = 'str'
type ( obj ) == string 
```

我试过：

```
type ( obj ) == type ( string ) 
```

它没有用。

另外，其他类型呢？例如，我无法复制`NoneType`.

* * *

## 回答 #1

> 赞同：289
> 
> 时间：2009-04-01T23:07:02.120

```
isinstance() 
```

在您的情况下，`isinstance("this is a string", str)`将返回`True`.

您可能还想阅读以下内容：http: [//www.canonical.org/~kragen/isinstance/](http://www.canonical.org/~kragen/isinstance/)

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-04-01T23:26:47.347

`isinstance`作品：

```
if isinstance(obj, MyClass): do_foo(obj) 
```

**但是**，请记住：如果它看起来像一只鸭子，如果它听起来像一只鸭子，那么它就是一只鸭子。

编辑：对于 None 类型，您可以简单地执行以下操作：

```
if obj is None: obj = MyClass() 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2009-04-02T00:34:18.573

首先，避免所有类型比较。它们非常非常少需要。有时，它们有助于检查函数中的参数类型——即使这种情况很少见。错误的类型数据会引发异常，这就是您所需要的。

所有基本转换函数都将映射为等于类型函数。

```
type(9) is int
type(2.5) is float
type('x') is str
type(u'x') is unicode
type(2+3j) is complex 
```

还有一些其他情况。

```
isinstance( 'x', basestring )
isinstance( u'u', basestring )
isinstance( 9, int )
isinstance( 2.5, float )
isinstance( (2+3j), complex ) 
```

没有，顺便说一句，从不需要任何这种类型检查。None 是 NoneType 的唯一实例。None 对象是一个单例。只需检查无

```
variable is None 
```

顺便说一句，一般不要使用上述内容。使用普通异常和 Python 自身的自然多态性。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-04-01T23:19:36.647

对于其他类型，请查看[types](http://docs.python.org/library/types.html)模块：

```
>>> import types
>>> x = "mystring"
>>> isinstance(x, types.StringType)
True
>>> x = 5
>>> isinstance(x, types.IntType)
True
>>> x = None
>>> isinstance(x, types.NoneType)
True 
```

PS 类型检查是个坏主意。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2009-04-02T00:01:28.137

你总是可以使用这个`type(x) == type(y)`技巧，`y`知道类型的东西在哪里。

```
# check if x is a regular string
type(x) == type('')
# check if x is an integer
type(x) == type(1)
# check if x is a NoneType
type(x) == type(None) 
```

通常有更好的方法来做到这一点，特别是对于任何最近的 python。但如果你只想记住一件事，你可以记住它。

在这种情况下，更好的方法是：

```
# check if x is a regular string
type(x) == str
# check if x is either a regular string or a unicode string
type(x) in [str, unicode]
# alternatively:
isinstance(x, basestring)
# check if x is an integer
type(x) == int
# check if x is a NoneType
x is None 
```

注意最后一种情况：在 python 中只有一个实例`NoneType`，那就是`None`. 您会在异常中看到很多 NoneType （`TypeError: 'NoneType' object is unsubscriptable`-- 一直发生在我身上..），但您几乎不需要在代码中引用它。

最后，正如 fengshaun 指出的那样，python 中的类型检查并不总是一个好主意。仅使用该值就好像它是您期望的类型一样，并捕获（或允许传播）由此产生的异常，这更像是 Pythonic。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-04-01T23:06:36.850

你很亲近！`string`是一个模块，而不是一个类型。您可能希望将 的类型`obj`与字符串的类型对象进行比较，即`str`：

```
type(obj) == str  # this works because str is already a type 
```

或者：

```
type(obj) == type('') 
```

请注意，在 Python 2 中，如果`obj`是 unicode 类型，则以上都不起作用。也不会`isinstance()`。请参阅约翰对这篇文章的评论，了解如何解决这个问题......我已经尝试记住它大约 10 分钟了，但是有一个记忆块！

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2013-02-09T10:48:30.567

使用 str 而不是字符串

```
type ( obj ) == str 
```

解释

```
>>> a = "Hello"
>>> type(a)==str
True
>>> type(a)
<type 'str'>
>>> 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2018-06-27T15:27:32.067

使用`isinstance(object, type)`. 如上所述，如果您知道正确的，这很容易使用`type`，例如，

```
isinstance('dog', str) ## gives bool True 
```

但是对于更深奥的对象，这可能很难使用。例如：

```
import numpy as np 
a = np.array([1,2,3]) 
isinstance(a,np.array) ## breaks 
```

但你可以做到这一点：

```
y = type(np.array([1]))
isinstance(a,y) ## gives bool True 
```

`y`因此，我建议使用您要检查的对象类型（例如， ）实例化一个变量（在这种情况下） `type(np.array())`，然后使用`isinstance`.

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-04-03T00:14:45.297

这是因为你必须写

```
s="hello"
type(s) == type("") 
```

type 接受一个实例并返回它的类型。在这种情况下，您必须比较两个实例的类型。

如果您需要进行抢先检查，最好检查支持的接口而不是类型。

类型并没有真正告诉你太多，除了你的代码需要一个特定类型的实例这一事实之外，不管你可能有另一个完全不同类型的实例，这将是非常好的，因为它实现了相同的接口.

例如，假设您有此代码

```
def firstElement(parameter):
    return parameter[0] 
```

现在，假设你说：我希望这段代码只接受一个元组。

```
import types

def firstElement(parameter):
    if type(parameter) != types.TupleType:
         raise TypeError("function accepts only a tuple")
    return parameter[0] 
```

这降低了该例程的可重用性。如果您传递列表、字符串或 numpy.array，它将不起作用。更好的东西会是

```
def firstElement(parameter):
    if not (hasattr(parameter, "__getitem__") and callable(getattr(parameter,"__getitem__"))):
        raise TypeError("interface violation")
    return parameter[0] 
```

但是这样做没有意义：如果协议仍然不满足，参数 [0] 将引发异常......当然，除非您想防止副作用或必须从失败前可以调用的调用中恢复。（愚蠢的）示例，只是为了说明这一点：

```
def firstElement(parameter):
    if not (hasattr(parameter, "__getitem__") and callable(getattr(parameter,"__getitem__"))):
        raise TypeError("interface violation")
    os.system("rm file")
    return parameter[0] 
```

在这种情况下，您的代码将在运行 system() 调用之前引发异常。如果没有接口检查，您将删除该文件，然后引发异常。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-04-02T00:10:13.593

我用`type(x) == type(y)`

例如，如果我想检查一个数组：

```
type( x ) == type( [] ) 
```

字符串检查：

```
type( x ) == type( '' ) or type( x ) == type( u'' ) 
```

如果你想检查 None，使用 is

```
x is None 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-04-01T23:07:49.063

我认为这应该这样做

```
if isinstance(obj, str) 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-04-06T21:34:25.267

类型不适用于某些类。如果您不确定对象的类型，请使用该`__class__`方法，如下所示：

```
>>>obj = 'a string'
>>>obj.__class__ == str
True 
```

另见这篇文章 - [http://www.siafoo.net/article/56](http://www.siafoo.net/article/56)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-02-01T05:07:22.957

要获取类型，请使用`__class__`成员，如`unknown_thing.__class__`

在这里谈论鸭式打字是没有用的，因为它不能回答一个非常好的问题。在我的应用程序代码中，我从不需要知道某物的类型，但是有一种方法来学习对象的类型仍然很有用。有时我需要获取实际的类来验证单元测试。因为所有可能的对象都有相同的 API，但只有一个是正确的。另外，有时我在维护别人的代码，我不知道我传递了什么样的对象。这是我对 Python 等动态类型语言的最大问题。第 1 版开发起来非常简单快捷。版本 2 是个麻烦事，尤其是如果您没有编写版本 1。所以有时，当我使用我没有编写的函数时，我需要知道参数的类型，

这就是`__class__`参数派上用场的地方。那（据我所知）是获取对象类型的最佳方法（也许是唯一方法）。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-05-05T07:25:19.473

您可以比较检查级别的类。

```
#!/usr/bin/env python
#coding:utf8

class A(object):
    def t(self):
        print 'A'
    def r(self):
        print 'rA',
        self.t()

class B(A):
    def t(self):
        print 'B'

class C(A):
    def t(self):
        print 'C'

class D(B, C):
    def t(self):
        print 'D',
        super(D, self).t()

class E(C, B):
    pass

d = D()
d.t()
d.r()

e = E()
e.t()
e.r()

print isinstance(e, D) # False
print isinstance(e, E) # True
print isinstance(e, C) # True
print isinstance(e, B) # True
print isinstance(e, (A,)) # True
print e.__class__ >= A, #False
print e.__class__ <= C, #False
print e.__class__ <  E, #False
print e.__class__ <= E  #True 
```

# c# - 如何动态选择 WCF 服务的 URI？

> ID：707678
> 
> 赞同：0
> 
> 时间：2009-04-01T23:05:09.397
> 
> 标签：c#, .net, wcf, uri

我正在尝试使用运行时 URI 字符串构造 WCF 客户端对象。这看起来很简单，但我已经没有什么东西可以尝试了，这似乎不是“错误的做法”。

原代码是这样的：

```
IPrototype p =  new prototype.PrototypeClient(); 
```

我有点期待它能够像这样工作。

```
string uri = GetMeMyURI();
IPrototype p =  new prototype.PrototypeClient(new URI(uri)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T23:19:10.877

在不知道您的 PrototypeClient 类是什么的情况下很难判断出了什么问题，它是 WCF 代理吗？

以编程方式设置 WCF 客户端的基本机制是：

```
BasicHttpBinding binding = new BasicHttpBinding();
EndpointAddress address = new EndpointAddress(GetMeMyURI());
PrototypeClient yourProxy = new PrototypeClient(binding, address); 
```

编辑：

为了避免必须知道服务器绑定：

```
PrototypeClient yourProxy = new PrototypeClient();
yourProxy.Endpoint.Address = new EndpointAddress(GetMeMyURI(), null); 
```

# c# - 转换对象数组

> ID：707686
> 
> 赞同：4
> 
> 时间：2009-04-01T23:07:23.650
> 
> 标签：c#, .net, arrays, casting

我如何转换：

```
object[] myArray 
```

到

```
Foo[] myCastArray 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-01T23:12:28.113

按`Foo`类型过滤元素：

```
Foo[] myCastArray = myArray.OfType<Foo>().ToArray(); 
```

要尝试将每个元素强制转换为`Foo`类型：

```
Foo[] myCastArray = myArray.Cast<Foo>().ToArray(); 
```

*旁注：*有趣的是，C# 支持一个称为[数组协方差的特性（](http://msdn.microsoft.com/en-us/library/aa664572(VS.71).aspx) *misfeature？* ） 。这意味着如果是可以转换为的引用，则可以隐式转换为（在某些情况下可能不安全，见下文）。这**仅适用于数组**，而不适用于其他东西。相反（数组逆变）是不正确的，也就是说，你不能转换为.`Derived``Base``Derived[]``Base[]`**`List<T>``object[]``string[]`**

 **C# 4.0 版也将支持泛型的安全协变和逆变。

数组协方差可能导致问题的示例：

```
void FillArray(object[] test) {
   test[0] = 0;
}
void Test() {
     FillArray(new string[] { "test" });
} 
```

I speculate C# has array covariance because Java had it. It really doesn't fit well in the overall C# style of doing things.

# c# - 防止 asp:ImageButton 默认内联样式

> ID：707695
> 
> 赞同：1
> 
> 时间：2009-04-01T23:10:46.277
> 
> 标签：c#, asp.net, imagebutton

不幸的是，asp:ImageButton 控件呈现了“border-width:0px;”的内联样式属性。由于各种原因，这令人沮丧。过去，我通过创建自己的不呈现内联样式属性的自定义图像按钮控件来解决该问题。我正在寻找一个更优雅的解决方案。任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T23:17:02.987

[**这是**](https://stackoverflow.com/questions/493800/how-to-build-imagebutton-control-adapter-or-more-general-how-to-build-a-simple)一个非常简单的[ControlAdapter](http://msdn.microsoft.com/en-us/library/system.web.ui.adapters.controladapter.aspx)，它演示了在需要时添加属性，并在不需要时完全关闭它。

# delphi - 组件创建问题：字段最终为零

> ID：707696
> 
> 赞同：1
> 
> 时间：2009-04-01T23:10:51.473
> 
> 标签：delphi, oop, inheritance, custom-component

这是我在这里工作的项目的延续： [Circular reference issue with Classes which use each other](https://stackoverflow.com/questions/692173/circular-reference-issue-with-classes-which-use-each-other)

那里收到的建议修复了 ciruclar 参考问题（再次感谢您的帮助）。现在我正在与其他东西搏斗：TcmDataPanel.FObservingDataPanels 总是以 = nil 结束，显然是因为它永远不会被创建。（最初我遇到了访问冲突，但在进一步测试中发现 FObserver 始终为零）。

下面是相关代码（它是一个 TFrame 单元，TcmTPDataPanel 是 TFrame 的后代）：

```
unit cmTPDataPanelFrame;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, cmTPBasePanelFrame, cmTPPanels, nxdb, nxllComponent;

type
  TcmTPDataConnector = class;

  TcmTPDataPanel = class(TcmTPBasePanel)
    Database: TnxDatabase;
    Session: TnxSession;
  private
    FDataConnector: TcmTPDataConnector;
    MyNxDataBase: TnxDatabase;
    MyNxSession: TnxSession;
    MyRefNxDataBase: TnxDatabase;
  protected
    procedure Disconnect; virtual; abstract;
    procedure Refresh; virtual;
    procedure Requery; virtual; abstract;
  public
    procedure Connect;
  published
    property DataConnector: TcmTPDataConnector read FDataConnector write
        FDataConnector;
  end;

  TcmTPCustomDataConnector = class(TComponent)
  private
    FDatabase: TnxDatabase;
    FObservingDataPanels: TList;
    FTableForCategories: TnxTable;
    FTableForItemCategoryLinks: TnxTable;
    FTableForItems: TnxTable;
    procedure SetTableForItemCategoryLinks(const Value: TnxTable);
  protected
    procedure IterateObservers;
  public
    constructor Create(AOwner: TComponent);
    destructor Destroy; override;
    procedure Register(Instance: TcmTPDataPanel);
    procedure ReportObservers;
    procedure Unregister(Instance: TcmTPDataPanel);
  published
    property Database: TnxDatabase read FDatabase write FDatabase;
    property TableForCategories: TnxTable read FTableForCategories write
        FTableForCategories;
    property TableForItemCategoryLinks: TnxTable read
        FTableForItemCategoryLinks write SetTableForItemCategoryLinks;
    property TableForItems: TnxTable read FTableForItems write FTableForItems;
  end;

  TcmTPDataConnector = class(TcmTPCustomDataConnector)
  end;

var
  cmTPDataPanel: TcmTPDataPanel;

implementation 
```

=== 和 ===

```
{
*************************** TcmTPCustomDataConnector ***************************
}
constructor TcmTPCustomDataConnector.Create(AOwner: TComponent);
begin
  ShowMessage('TcmTPCustomDataConnector.Create entered.');
//  inherited Create(AOwner); // TODO : check duplicate
  FObservingDataPanels := TList.Create();
end;

destructor TcmTPCustomDataConnector.Destroy;
begin
  FreeAndNil(FObservingDataPanels);
//inherited Destroy; // TODO : check duplicate
end; 
```

我希望在 cmTPDataConnector.Create 上运行的 ShowMessage 行从未出现，这让我认为它没有从 TcmTPCUstomDataConnector 继承 Create 方法。不应该吗？

它“感觉”好像我缺少一些明显的东西，但我没有看到它。:-\

两个问题：

1) 为什么没有创建 FObservingDataPanels？
2）“//继承的Create（AOwner）；// TODO：检查重复”和“//inherited Destroy；//TODO：检查重复”行是由ModelMaker在某个时候放入的。他们应该被取消注释吗？

PS显然，我还在学习组件创建和继承。欢迎任何其他意见和建议。

PPS 今天我有很多问题。如果我需要将它降低一个档次，请随时告诉我......（只是在这里有一个奖励很多问题的日子）。

提前感谢您的任何帮助！:)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-01T23:32:32.967

您需要覆盖您的构造函数，然后在该构造函数中调用继承作为 /first/ 事物。

```
 public
    constructor Create(AOwner: TComponent); override;

constructor TcmTPCustomDataConnector.Create(AOwner: TComponent);
begin
  inherited Create(AOwner); // TODO : check duplicate
  ShowMessage('TcmTPCustomDataConnector.Create entered.');
  FObservingDataPanels := TList.Create();
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T23:23:10.977

我对 Delphi 生疏了，但我认为您可能需要在构造函数声明上“覆盖”。

# sql-server - 公司-员工数据库设计

> ID：707697
> 
> 赞同：0
> 
> 时间：2009-04-01T23:11:58.007
> 
> 标签：sql-server, database-design, primary-key

我正在尝试构建一个具有公司数据表和员工数据表的 SQL 2005 数据库。每个公司都应该有一个员工 1、员工 2，依此类推。我意识到每个 Employee 记录都会有他们的 EmployeeID 和他们的 CompanyID 的 PK，但是我一生还没有确定这样做的最佳方式吗？

有任何想法吗？

**让我澄清一下**

每个公司都可以有自己的员工 #1、#2 等。假设我有一个存储过程，它通过传入公司 ID 和请求的员工 ID 返回特定员工。

```
exec dbo.GetEmployee @CompanyID = 1, @EmployeeID = 45 
```

请记住，公司 1 可以有员工 1，而公司 2 可以有不同的员工 1，我该怎么做？如何为每个公司的员工提供唯一的增量主键？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T23:20:58.080

如果您的问题是数据建模问题：

如果员工只能为一家公司工作，那么您可以让 CompanyID 只是 Employee 表中的外键引用，而 EmployeeID 是任何给定人员的唯一值（例如 SSID）。

如果员工可以为多个公司工作，那么您就有一个多对多关系，这需要第三个表——名为 CompanyEmployee，由 CompanyID 和 EmployeeID 组成。

这种帮助？

或者，您的问题很简单：

“如何在 SQL Server 中创建复合主键”？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T23:45:50.233

根据您对 Jamo 的评论，您需要两个员工 ID。一种是雇主唯一的，另一种是整个数据库中唯一的。然后你有这些表：

```
Employees
E_ID NUMBER(9) NOT NULL
E_NAME
E_SSID
etc.

Companies
C_ID NUMBER(9) NOT NULL
C_NAME
etc.

Employment
CE_ID NUMBER(9) NOT NULL
C_ID NUMBER(9) NOT NULL FOREIGN KEY (Companies.C_ID)
E_ID NUMBER(9) NOT NULL FOREIGN KEY (Employees.E_ID)
LOCAL_E_ID NUMBER(9) NOT NULL 
```

C_ID 是公司的唯一标识符。E_ID 是数据库中员工的唯一标识符。CE_ID 是就业表的唯一标识符，以便更轻松地进行更新。LOCAL_E_ID 在公司中是唯一的。您将需要创建某种触发器来创建此号码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T23:48:10.337

简单的答案是你不能。

您通过公司 ID 和员工 ID 在员工表上创建一个主键。这需要处理唯一约束。

但是，您不能让员工 ID 自动增加，而是在插入时需要将其包装在事务中并执行类似的操作

```
insert @companyID, max(employeeID)+1 from employees where companyID=@companyID into employee 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T23:52:03.323

简短的回答是，你可能在找错树了。

如果将employeeID 分配为自动递增（因此是任意的）数字，则没有理由重新启动每个公司的employeeID。如果您认为我错了，请提供一个例子，我会调整我的答案。

这种设计只会创建一个不必要的复杂设计。例如，您的存储过程确实应该采用单个 EmployeeID，然后该员工记录将用于确定公司。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T23:16:17.433

听起来好像那里有一个外键。这是员工和公司之间的 1:many 关系，假设员工一次只能为一家公司工作。Employee 和 Company 都会有一个 PK，而 Employee 会有一个引用 Company PK 的 FK。

我敦促您为公司和员工使用代理键。将业务逻辑排除在密钥之外是一个好主意。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-01T23:39:06.070

我将有一个名为 Company 的表，其中包含一个主键列 CompanyID，然后我将有一个名为 Employee 的表，其主键列为 EmployeeID，外键列为 CompanyID。当然，每个表上都有 EmployeeName 和 CompanyName 以及任何其他适当的列。

# c# - WPF异常在另一个类中运行动画

> ID：707700
> 
> 赞同：2
> 
> 时间：2009-04-01T23:13:10.670
> 
> 标签：c#, wpf, 3d

我可以从主窗口类运行动画，但如果我尝试从同一命名空间中的另一个类运行相同的代码，我会在情节提要开始函数中收到异常，
这是异常：

不存在适用的名称范围来解析名称'默认组”。

这就是我设置情节提要目标和属性的方式

```
Storyboard.SetTargetName(r3d,"DefaultGroup");
Storyboard.SetTargetProperty(r3d, new PropertyPath("(Visual3D.Transform).(Transform3DGroup.Children)[2].(RotateTransform3D.Rotation)")); 
```

我怎样才能解决这个问题？
谢谢瓦尔特
_

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-09T05:55:49.917

--otherUserControl.cs

```
StackPanel defaultGroup; 
```

--MainWindow.cs

```
this.RegisterName(otherUserControl.defaultGroup.Name, otherUserControl.defaultGroup); // RegisterName

Storyboard.SetTargetName(r3d,"defaultGroup");
Storyboard.SetTargetProperty(r3d, new PropertyPath("(Visual3D.Transform).(Transform3DGroup.Children)[2].(RotateTransform3D.Rotation)")); 
```

# .net - 使用 DataContext.ExecuteQuery 时忽略只读类属性

> ID：707706
> 
> 赞同：9
> 
> 时间：2009-04-01T23:16:16.263
> 
> 标签：.net, linq, linq-to-sql, datacontext

在将结果集绑定到对象时，如何告诉 LINQ 数据上下文忽略特定属性或所有只读属性？

我正在处理一些使用 LINQ 难以表达的 T-SQL 语句，因此我使用数据上下文的 ExecuteQuery 方法将直接的 T-SQL 传递给数据库。

如果我的类 T 具有任何只读属性，那么当数据上下文尝试设置这些属性并且由于没有 setter 属性而失败时，我会在运行时遇到异常。如何告诉上下文忽略这些属性？

这就是我现在正在做的事情。它有效，但很糟糕：

```
public bool IsPaidInFull {
    get { return NetTotal <= 0m; }
    set { /* needed so linq doesn't choke. Should never be set by hand */ }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:52:46.877

```
public bool IsPaidInFull
{
    get { return NetTotal <= 0m; }
    private set { ;}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T16:42:21.363

您是否考虑过 Linq to Entity？转换你的项目可能不值得麻烦，这取决于你走了多远，或者你对多少 orm 开销感到满意。但是，这种确切的情况在 Linq to Entities 中不会成为问题。它在加载对象时不会尝试更新对象中的只读属性，因为它们没有显式映射，它们只是扩展属性。

此外，您可以使用 getter 函数而不是属性来走老派/java 路线。public bool getIsPaidInFull(){return NetTotal <= 0m;}。

或者您可以尝试在继承的子类中实现只读属性，但这可能会引入各种类型问题。

# nhibernate - Fluent NHibernate - 如何将外键列映射为属性

> ID：707708
> 
> 赞同：10
> 
> 时间：2009-04-01T23:16:39.243
> 
> 标签：nhibernate, fluent-nhibernate

我确信这是一个直截了当的问题，但请考虑以下问题：我在公司和部门之间有如下参考：

```
public class Company {
    public Guid ID { get; set; }
    public Sector Sector { get; set; }
    public Guid SectorID { get; set; }
}

public class Sector {
    public Guid ID { get; set; }
    public string Name { get; set; }
} 
```

好的。我想要的是我去后要填充的 Company 对象的 SectorID：

```
(new Company()).Sector = new Sector() { Name="asdf" } 
```

并进行冲洗。

我正在使用的映射在 Company 表中的数据库中创建了一个名为 Sector_Id 的附加列，但这不能作为 Company 的属性使用。我希望填充 SectorID 属性。

我目前在 CompanyMap 中使用的映射是

```
References(c => c.Sector).Cascade.All(); 
```

有没有人有任何想法？

* * *

感谢您的答复。可悲的是，如果我执行第二个选项（将列的列名设置为与属性相同，或者设置，`Map(x => x.SectorID, "Sector_Id")`则出现错误：

System.IndexOutOfRangeException：此 SqlParameterCollection 的索引 7 无效，Count=7。

我可能必须做第一个选项，但我担心当您调用 SectorID get 时会触发一个额外的查询，因为它将 Sector 本身从数据库中取出（除非它是急切加载的，这有点麻烦）。

我很惊讶没有一个简单的答案。

* * *

哇！如果我使用

```
public virtual Guid SectorID
{
    get { return Sector.ID;
} 
```

那么 nhibernate 足够聪明，可以知道 Organization 查询中的 Sector_id 列实际上与 Sector.ID 相同，它会在后台返回它。即使您延迟加载，它也不会发送额外的查询。我很佩服！

* * *

作为后续行动......似乎hibernate并没有真正编写为能够映射对象中的外键列。尽管这在 Web 前端可能有点痛苦，但它是有道理的，因为这实际上是一个持久性问题，而不是真正的对象问题。我正在使用 asp.net MVC 并编写了一个自定义模型绑定器，它将采用名称联系人（而不是 ContactID）的输入框，使用 texbox 中的 ID 新建一个新联系人，然后将其应用于模型的属性。这解决了 Web 前端下拉列表的问题。如果有人感兴趣，将发布代码。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-12-06T15:27:11.733

这可以通过公式属性轻松完成。

```
public class Company {
  public virtual Guid Id { get; set; }
  public virtual Guid? SectorId { get; set; }
  public virtual Sector Sector { get; set; }
}

public class CompanyMap : ClassMap<Company> {
  public CompanyMap() {
    Id(x => x.Id); // Maps to a column named "Id"
    References(x => x.Sector); // Maps to a column named "Sector_id", unless you change the NHibernate default mapping rules.
    Map(x => x.SectorId).Formula("[Sector_id]");
  }    
} 
```

这应该完全按照您的意愿行事。当`Company`是新的时，`SectorId`将为空；当`Company`从数据库中获取时，`SectorId`将填充给定的公式值。被`SectorId`暴露为一个属性，这使得它非常适合处理 web 下拉列表等。当你保存时，你仍然需要绑定“真实”关联。假设`SectorId`以表格形式选择...

```
using (var txn = session.BeginTransaction()) {
  // Set the FK reference.
  company.Sector = session.Load<Sector>(company.SectorId);
  // Save the new record.
  session.Save(company);
  // Commit the transaction.
  txn.Commit();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-06-08T05:29:57.590

史蒂夫，您不需要 POCO 类中的 ForeignKey 属性。

例如，如果您将尝试获取文章作者的 ID，则不会执行加入选择。

var authorID = Article.Author.ID

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T00:51:20.623

两个想法：首先，这样的事情不会实现你想要的吗？

```
public class Company {
    public Guid ID { get; set; }
    public Sector Sector { get; set; }
    public Guid SectorID {
        get { return Section.ID; }
        // Really not sure what behavior your setter should have here; Maybe it shouldn't even have one?
        set { Sector = new Sector { ID = value }; }
    }
} 
```

其次，当您说映射在数据库中创建了一个名为 Sector_Id 的列时，除了您创建的一个名为 SectorID 的列之外，还有吗？如果是这样，您可以更改列名，使其使用正确的名称（[这里是映射的文档](http://wiki.fluentnhibernate.org/show/StandardMappingRelationships)，请参阅“指定列名”下方的几个标题）。

另外，您是否映射了 SectorID 属性（例如“Map(x => x.SectorID, "Sector_Id")”）？

# c# - 我可以将 DataContractSerializer 配置为不在输出 XML 中创建可选（即 Nullable<> 和 List<>）元素吗？

> ID：707711
> 
> 赞同：13
> 
> 时间：2009-04-01T23:17:53.420
> 
> 标签：c#, .net, datacontractserializer

我正在使用新的 .NET 3.0 DataContractSerializer。我有我要序列化的 Nullable< *> 和 List< > 对象。*例子：

```
[DataContract(Namespace = "")]
class Test
{
    public static void Go()
    {
        Test test = new Test();

        var dcs = new DataContractSerializer(typeof(Test));
        dcs.WriteObject(new StreamWriter("test.xml").BaseStream, test);
    }

    [DataMember]
    public Nullable<int> NullableNumber = null;

    [DataMember]
    public int Number = 5;

    [DataMember]
    public List<int> Numbers = new List<int>();
} 
```

当 .NET 序列化 null 或空列表时，它会将 nil（对于 Nullable）和空（对于列表）元素放入 XML。上面的示例生成：

```
<Test xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
  <NullableNumber i:nil="true"/>
  <Number>5</Number>
  <Numbers xmlns:a="http://schemas.microsoft.com/2003/10/Serialization/Arrays"/>
</Test> 
```

由于我没有时间描述的原因，我想消除多余的 NullableNumber 和 Numbers 元素，如下所示：

```
<Test xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
  <Number>5</Number>
</Test> 
```

事实上，上面的文件用序列化器反序列化就好了。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-01T23:51:32.593

用

```
 [DataMember(EmitDefaultValue=false)] 
```

这至少适用于可为空值类型的情况。对于 List 情况，您可能需要将列表的创建推迟到需要时，否则如果在序列化之前为空，则将成员设为 null。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T19:00:41.080

我真的需要同样的东西，但全局应用于生成的 RIA 类中的许多字段。我不确定这个 XML 是否可以被 DataConstract 接受以进行反序列化。但它是可读的，这符合我的目的......

```
 public override string ToString()
    {
        var doc = XDocument.Parse(this.ToXML());
        WalkElement(doc.Root);
        return doc.ToString( SaveOptions.None );
    }
    void WalkElement(XElement e)
    {
        var n = e.GetNamespaceOfPrefix("i");
        if (n != null)
        {
            var a = e.Attribute(n + "nil");
            if (a != null && a.Value.ToLower() == "true")
                e.Remove();
        }
        foreach (XElement child in e.Elements().ToList())
            WalkElement(child);
    } 
```

# excel - 找出 Vlookup 指的是哪个单元格

> ID：707721
> 
> 赞同：2
> 
> 时间：2009-04-01T23:21:37.593
> 
> 标签：excel, excel-formula, vlookup

说如果我在我的 Excel 电子表格中看到这个 Vlookup 公式：

```
=VLOOKUP(G37,'tb 2008'!$H$142:$M$247,6,FALSE) 
```

那么有没有一种有效的方法来找出它引用的是哪个*单元格？*我不想在脑海中手动执行 Vlookup 来找出它找到的符合参数的单元格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T00:38:13.290

我不确定这样做的好方法，但是您可以用行号填充一列（例如，列 N），然后使用两个 VLOOKUP 来获取第 6 列的值以及行号第 7 列。然后你有单元格，它是 M#，其中 # 是第二个 VLOOKUP 返回的任何内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T18:33:31.217

=地址(行((索引('tb2008'!$H$142:$H$247,MATCH(G37,'tb2008'!$L$142:$L$247,0)))),列((索引('tb2008' !$H$142:$H$247,MATCH(G37,'tb2008'!$L$142:$L$247,0)))))

match 返回数组中元素的编号，例如（假设范围 A1:A5 用 A,B,C,D,E 填充：match(C,A1:A5,0) = 3

index 将根据行号和列号返回对单元格的引用。索引（A1:A5, 0, 3）= C

然后我们使用 ROW 和 COLUMN 函数来获取该引用的行和列地址。然后使用 ADDRESS 将它们放在一起

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T13:23:35.697

通过哪个单元格，如果您指的是单元格的地址，则可以使用索引/匹配，并且可以使索引返回引用而不是值

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T07:50:02.100

不，没有内置的查找单元格的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-13T15:47:36.090

特别是对于`VLOOKUP`你的这个。

```
=VLOOKUP(G37,'tb 2008'!$H$142:$M$247,6,FALSE) 
```

你应该得到你需要的信息：

```
=ADDRESS(MATCH(G37;H142:H247;0);1) 
```

G37 = 您正在搜索的单元格/值（在这种情况下，单元格引用更实用）

H142:H247 = 包含搜索值的列范围。如果您整个列都专用于标准，您可以设置（在本例中）H:H

希望这可以帮助。

# sql-server - sql server 触发器的帮助

> ID：707724
> 
> 赞同：1
> 
> 时间：2009-04-01T23:22:52.597
> 
> 标签：sql-server, triggers

我想创建一个触发器，它将列 LastActivityDate 更新为更新 Description 列时的当前日期，问题是所有行都在更新，我不知道如何在触发器中创建 where 子句。 ..

我也需要为其他表制作这样的触发器，比如投票表......

我有：

```
CREATE TRIGGER test ON Articles
FOR INSERT, UPDATE  
AS
IF UPDATE(Description)
UPDATE Articles SET LastActivityDate = GETUTCDATE() 
```

where 子句会是怎样的呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T23:35:46.857

您可以加入插入的表以将更新限制为更新的行。

```
 CREATE TRIGGER test ON Articles
    FOR INSERT, UPDATE  
    AS
    IF UPDATE(Description)
    UPDATE a
    SET a.LastActivityDate = GETUTCDATE()
    from Articles a
    inner join inserted i
    on a.SomeIDField = i.SomeIDField 
```

# hibernate - Hibernate：映射单向冗余列

> ID：707741
> 
> 赞同：1
> 
> 时间：2009-04-01T23:33:09.953
> 
> 标签：hibernate, mapping, denormalized

在我的架构中，有一些冗余列用于加速报表查询。例如，销售的采购总额保存在表格的`"purchase_total"`列中`"sale"`，但在模型中，它是通过将销售中每个购买的商品的售价相加来动态计算的。可以通过在 Sale 对象上调用“getPurchaseTotal”访问器来检索此值。

有没有办法在插入/更新时将此值映射到销售表中的 purchase_total 列，但在从数据库加载时不包含在销售对象的水合中？我猜它类似于派生或计算的列，但相反。

最好通过数据库本身的触发器来处理这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T07:30:23.853

我可能会在数据库中执行此操作，因为这些列与您的主应用程序无关。

您可以使用触发器，或者完全摆脱冗余列并使用物化视图（Oracle 和 PostgreSQL）/索引视图（SQL Server）/自动汇总表（DB2）来查询您的报告数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T00:25:03.480

您是否尝试在模型中执行以下操作？

```
public class Sales {

  /**
   * this set method ignores the value loaded from the database.
   */
  public void setPurchaseTotal(double val) {
    // ignore a value set explicitly by hibernate
  }

  /**
   * Compute the purchase total
   */
  public double getPurchaseTotal() {
     // sum item totals
     double sum = 10.0;

     return sum;
  }

} 
```

这将忽略加载的数据，但在保存到数据库时会保留该值。

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T01:07:47.557

Hibernate 允许您创建类型并覆盖类型的获取/保存方法。

创建一个类型，例如 ，`InsertableOnly`它在 fetch 集上丢弃数据库值。

假设您的价值是整数，因为您以美分表示价格以避免四舍五入问题：

```
class InsertOnlyInteger extends org.hibernate.type.IntegerType {
  public Object get(ResultSet rs, String name) throws SQLException {
     return null;
  }
} 
```

然后使属性 InsertOnlyInteger 的 Hibernate 类型（使用 xml 或注释，因为它适合您）。

这与 sewardrobert 给出的答案非常相似，但它

1.  允许你在类中有一个“正常”的设置器，它
2.  合作者 /other/ 比 Hibernate （如你的 Java 代码求和例程）可以正常使用，
3.  它是可重复使用的，并且
4.  有一个像样的名字（比如 InsertableOnly），它或多或少是自我记录的。

# msbuild - MSBuild 和 TeamBuild - 由于 MSB3021 文件权限违规，BuildInParallel 失败

> ID：707742
> 
> 赞同：27
> 
> 时间：2009-04-01T23:33:16.863
> 
> 标签：msbuild, tfsbuild

我维护了一个相当大的软件的构建，包括大约 350 个 csharp 项目。我们调试内置时钟的构建时间大约为 17 分钟。

我一直在寻找缩短构建时间的方法，而 BuildInParallel 属性看起来确实很有趣。尤其是因为我们有一个四核服务器在做我们的构建，它应该真的能够利用计算能力。

但是唉......在设置属性，修改构建代理的配置文件并重新启动它之后，第一次运行看起来确实很有希望，比正常速度快得多，直到它失败了。

查看构建日志后，当它尝试将标记为 CopyLocal=true 的引用复制到输出目录时，构建似乎失败了。如果 C# 项目 A 和 C# 项目 B 是并行构建的，并且两者都引用相同的第三方 dll，并尝试同时复制它，则尝试复制文件的第二个进程将获得文件访问冲突 -该文件正被另一个进程使用。

任何人都经历过这种情况，并且能够在 Team Build 上进行多进程构建吗？

* * *

这是其中一个失败，很难弄清楚同时在建造哪个其他项目。

我已经删除了所有不相关的东西：

> 54>从项目“d:\temp\PCM\1.3-Maint_CI\Sources\Modules\Core\ Test\UnitTest\TestDIPS.Core.Data.Server.NUnit\TestDIPS.Core.Data.Server.NUnit.csproj”：54>任务“复制”从“..........\Bin\ 3rdParty\Oracle\Oracle.DataAccess.dll”到“d:\temp\PCM\1.3-Maint_CI\Binaries\Debug\Oracle.DataAccess.dll”。命令：复制 /y "..........\Bin\3rdParty\Oracle\Oracle.DataAccess.dll" "d:\temp\PCM\1.3-Maint_CI\Binaries\Debug\Oracle.DataAccess.dll " 54>c:\WINDOWS\Microsoft.NET\Framework\v3.5\Microsoft.Common.targets(2703,9): 错误 MSB3021: 无法复制文件 ".......\Bin\ 3rdParty\Oracle\Oracle.DataAccess.dll" 到“d:\temp\PCM\1.3-Maint_CI\Binaries\Debug\Oracle.DataAccess.dll”。该进程无法访问文件“d:\temp\PCM\1.3-Maint_CI\Binaries\Debug\Oracle.DataAccess.dll”，因为它正被另一个进程使用。完成执行任务“复制”——失败。54>在项目“TestDIPS.Core.Data.Server.NUnit.csproj”中完成构建目标“_CopyFilesMarkedCopyLocal”——失败。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-30T06:17:11.010

MSBuild 附带的默认目标是为 CopyLocal 行为而设计的——这是 VS 所依赖的。当您输出到单个输出目录时，CopyLocal 会出现问题。

为了能够真正并行构建，您需要在 Microsoft.*.Common.*.targets 文件中禁用多个 CopyLocal 特定行为。我过去曾与 MSBuild 团队中的一些人交谈过，这是一件特别麻烦的事情。即使您取消了某些 CopyLocal 行为，VS 测试访问器在并行构建时也表现不佳。

您可以从以下几点开始：

1.  通过将 private 设置为 true，禁用引用的 CopyLocal 行为。
2.  在构建依赖项目时禁用 CopyToOutputPath 文件的 CopyLocal。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-23T06:34:51.570

MS Build Copy 任务具有未记录的功能，至少 Google 保持沉默。如果设置系统范围的环境变量 MSBUILDALWAYSRETRY=1 此任务将重试复制文件，即使它在复制操作期间出现访问被拒绝异常

输出示例

```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets (3513): Got System.UnauthorizedAccessException: Access to the path 'C:\Builds\8\28\Binaries\Release\fr\System.Spatial.resources.dll' is denied.
   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   at System.IO.File.InternalCopy(String sourceFileName, String destFileName, Boolean overwrite, Boolean checkHost)
   at System.IO.File.Copy(String sourceFileName, String destFileName, Boolean overwrite)
   at Microsoft.Build.Tasks.Copy.CopyFileWithLogging(FileState sourceFileState, FileState destinationFileState)
   at Microsoft.Build.Tasks.Copy.DoCopyWithRetries(FileState sourceFileState, FileState destinationFileState, CopyFileWithState copyFile) copying C:\Builds\8\28\Sources\Main\Solutions\packages\System.Spatial.5.2.0\lib
et40\fr\System.Spatial.resources.dll to C:\Builds\8\28\Binaries\Release\fr\System.Spatial.resources.dll and HR is -2147024891
 C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets (3513): Retrying on ERROR_ACCESS_DENIED because MSBUILDALWAYSRETRY = 1
 C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets (3513): Could not copy "C:\Builds\8\28\Sources\Main\Solutions\packages\System.Spatial.5.2.0\lib
et40\fr\System.Spatial.resources.dll" to "C:\Builds\8\28\Binaries\Release\fr\System.Spatial.resources.dll". Beginning retry 1 in 1000ms. Access to the path 'C:\Builds\8\28\Binaries\Release\fr\System.Spatial.resources.dll' is denied. 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-11-23T07:14:59.407

几个月前我也有同样的问题。

VS C# 项目文件（.csproj 文件）中有两种类型的文件复制：

1.  具有“复制本地”属性的引用程序集。当属性为 True 时，程序集被复制到输出路径中。

2.  具有“复制到输出目录”属性的附加文件。当属性设置为“始终复制”或“如果较新则复制”时，文件将被复制到输出路径中。

问题：

A：如果同时构建两个或多个项目，并且其中两个尝试将同一个文件复制到输出目录中，您可能会遇到诸如“错误MSB3021：无法复制文件”，“访问路径被拒绝”之类的错误、“进程无法访问文件”等。

B：如果两个或多个项目引用了具有类型2的某些项目的公共项目。在这种情况下，在项目的并行构建过程中，其中两个可能会尝试同时构建公共项目的“GetCopyToOutputDirectoryItems”目标。因此，您可能再次面临上述异常。

解决方案1：

强制不同 .csproj 文件的 OutputPath 不在同一路径中

[http://social.msdn.microsoft.com/Forums/is/tfsbuild/thread/a62a6f98-ec44-46c1-a0d0-7f441f0db973](http://social.msdn.microsoft.com/Forums/is/tfsbuild/thread/a62a6f98-ec44-46c1-a0d0-7f441f0db973)

解决方案2：

第 1 步：解决方案是为项目中这些常见项目中的一个以外的所有项目设置公共项目的属性（在案例 1 中为 False，在案例 2 中为“不复制”）。或删除它们如果可能的话。

为了发现潜在的错误，您可以在文件 *.csproj 中搜索“private”（针对案例 1）和“CopyToOutputDirectory”（针对案例 2）这两个词

第2步： ...

祝你好运

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T10:49:44.593

看起来您的项目已配置到相同的输出目录。如果您将项目 A 和项目 B 配置为输出到不同的目录，这将解决此错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-24T16:13:46.530

这也可能由于文件为只读而发生。在这些情况下（即，不是其他大部分答案所涵盖的情况），[有适当的解决方法，具体取决于您是否能够依赖 MSBuild 3.5 或更高版本](http://blogs.msdn.com/aaronhallberg/archive/2007/10/22/error-msb3021-and-team-build.aspx)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T01:44:47.287

您使用的是哪个编译器？据我所知，直到 VS2005 并行构建不适用于多个项目。这是一个已知问题，MS 一直说他们最终会解决，但我不知道他们是否真的在 VS2008 中解决了这个问题。

# php - 有人尝试过带有匿名函数的新 php beta 版本吗？

> ID：707751
> 
> 赞同：1
> 
> 时间：2009-04-01T23:38:11.983
> 
> 标签：php, programming-languages, lambda, functional-programming

有没有人试用过新的 5.3.0 RC1 php 版本并玩过匿名函数？

我想知道你是否可以像 python 一样使用它来进行函数式编程。

例如，您可以执行以下操作：

```
def sinus(x):
  if x<=0.1:
    return x
  else:
    return (lambda x: 3*x-4*x*x*x)(sinus(x/3))

print sinus(172.0) 
```

或者更好的是，你能在 python 或 lisp 中做所有很酷的事情吗？有什么限制吗？不幸的是，我没有更好的例子。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T00:21:17.917

PHP 5.3 中的新匿名函数在现有的回调函数中非常有用。如本例所示。

```
echo preg_replace_callback('~-([a-z])~', function ($match) {
    return strtoupper($match[1]);
}, 'hello-world');
// outputs helloWorld 
```

这仍然是一个技巧，因为 PHP 5.3 隐含了一个使类实例可调用的闭包类。

[维基百科引用：](http://en.wikipedia.org/wiki/Anonymous_function#5.3)

> PHP 5.3 模仿匿名函数，但它不支持真正的匿名函数，因为 PHP 函数仍然不是一等函数。

[你可以在这个PHP RFC](http://wiki.php.net/rfc/closures)中阅读更多关于闭包的信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T00:08:47.947

从 PHP 4 开始，您可以使用函数[create_function](http://us2.php.net/manual/en/function.create-function.php)来做您想做的事情。

在您的示例中：

```
<?php

function sinus($x){
  if($x < 0.1) {
    return $x;
  } else {
    $func = create_function('$x', 'return 3*$x-4*$x*$x*$x');
    return $func( sinus($x/3) );
  }
}

?> 
```

# mysql - 将日期/时间添加到 MySQL 表？

> ID：707759
> 
> 赞同：2
> 
> 时间：2009-04-01T23:43:26.637
> 
> 标签：mysql, datetime

如何将当前日期和时间（服务器上设置的日期和时间）添加到 MySQL 表中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-01T23:49:06.030

很确定有一个`NOW()`功能...[链接](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_now)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-01T23:47:31.947

要将其添加到表中还是仅添加到结果集中？您可以将 NOW() 添加到任何查询的字段列表中来执行此操作。

如果您只想知道服务器认为它是什么时间，请尝试：

```
SELECT NOW(); 
```

编辑：这个答案的原件错误地使用了“GETDATE()”，因为我完全错过了 MySQL 标签。马特·索尔尼特（Matt Solnit）打电话给我，这是正确的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T23:46:10.997

CREATE TABLE t (ts TIMESTAMP ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP);

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T07:52:51.140

使用时间戳。最简单的方法，current_timestamp

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T01:43:32.353

如果适合这种情况，您可以使用 PHP [date 。](http://uk.php.net/date)像这样的东西：

```
$nowTime = date("Y-m-d H:i:s", time()); 
```

# c# - C#：如何在文本框的 keydown 事件中禁止按键被无限按下？

> ID：707760
> 
> 赞同：1
> 
> 时间：2009-04-01T23:44:00.223
> 
> 标签：c#

C#：如何在文本框的 keydown 事件中禁止按键被无限按下？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T23:50:16.870

处理这个问题的标准方法是为事件创建一个事件处理程序，然后如果按下的键与您要禁用的键匹配`Textbox.KeyDown`，则设置为 true。`KeyEventArgs.SuppressKeyPress`这是一个例子：

```
yourTextBox.KeyDown += delegate(Object sender, KeyEventArgs e)
{
    e.SuppressKeyPress = (e.KeyCode == YOUR_KEY);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T00:36:07.023

使用 e.SuppressKeyPress 将完全阻止按键记录。

假设您希望注册第一个击键，但在用户按住它时不将该键连续注册为击键，则将 e.SuppressKeyPress 包装在一个类级别变量中，该变量在按住某个键时进行注册。

```
public class nonRepeatingTextBox : TextBox
{
    private bool keyDown = false;

    protected override void OnKeyUp(KeyEventArgs e)
    {
        keyDown = false;
    }

    protected override void OnKeyDown(KeyEventArgs e)
    {
        if (keyDown)
        {
            e.SuppressKeyPress = true;
        }
        keyDown = true;
    }
} 
```

使用这个类作为你的文本框。您可能希望在 OnKeyDown 覆盖中为箭头键等设置例外。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-23T21:02:49.350

我意识到我玩游戏迟到了，但我需要 vb 中的这个功能，并认为我会分享我的经验。

接受的答案似乎相当模糊，虽然它确实表达了部分答案，但我觉得它并没有完全消除它。Stuart Helwig 有一些有趣的代码，但不幸的是它有一些相当大的缺点：1）如果你打字太快以至于在敲下一个键之前你还没有释放上一个键，它被排除在外 2）KeyDown 适用于 shift , alt 和 control 键以及没有 CAPSLOCK 的大写字母。因此，这是我试图清除答案的尝试。我希望有人发现它很有用，因为这是我的 RegexTextBox 非常需要的功能，它具有可以通过按住一个键来绕过的限制功能。

像 Stuart Helwig 一样，我继承了 TextBox 控件并添加了以下 Subs。

我正在使用`KeyDown`、`KeyPress`和`KeyUp`事件来解决问题。该`KeyDown`事件将 记录`KeyCode`到`KeyPressed`字段以供以后比较，`KeyPress`评估`Keychar`（但不是 shift、alt、控制）并用于`KeyPressEventArgs.Handled`删除 char 条目，并`KeyUp`重置`keyPressed`和`KeyIsDown`字段。

```
Private Sub PreventHoldKeyUp(sender As Object, e As KeyEventArgs) _
        Handles Me.KeyUp
        Me.KeyIsDown = False
        Me.KeyPressed = Keys.None
End Sub

Private Sub PreventHoldKeyDown(sender As Object, e As KeyEventArgs) _
         Handles Me.KeyDown
        /* Recording the current key that was hit for later comparison */
        Me.KeyPressed = e.KeyCode
End Sub

Private Sub PreventKeyPressHold(sender As Object, e As KeyPressEventArgs) _
        Handles Me.KeyPress
        /* If a key has been struck and is still down */
        If Me.KeyIsDown Then

            /* The following allows backspace which is picked up by
             keypress but does not have a keychar */
            Select Case Convert.ToInt32(e.KeyChar)
                Case Keys.Back
                    Exit Sub
            End Select
            /* If this is the same key picked up by keydown abort */
            /* this portion allows fast typing without char drop
             but also aborts multiple characters with one key press */
            If Me.KeyPressed = Convert.ToInt32(e.KeyChar) Then
                e.Handled = True
            End If
        Else
            e.Handled = False
        End If

        Me.KeyIsDown = True

End Sub 
```

# ios - 在 iPhone SDK 上等待 CLLocationManagerDelegate 的 didUpdateToLocation 方法时，UITableView 不会填充

> ID：707766
> 
> 赞同：1
> 
> 时间：2009-04-01T23:46:41.043
> 
> 标签：ios, uitableview, cocoa-touch, cllocation

我正在尝试用一组单元格填充 UITableview。我通常从 viewDidLoad 方法执行此操作，但这次我想根据位置填充数组。下面是我的界面的第一行：

```
@interface RootViewController : UITableViewController 
<UITableViewDelegate, UITableViewDataSource, CLLocationManagerDelegate> { 
```

在实现文件中，viewDidLoad 方法如下所示：

```
- (void)viewDidLoad {

    // for location
    self.locationManager = [[CLLocationManager alloc] init];
    [locationManager startUpdatingLocation];
    locationManager.delegate = self;
    locationManager.distanceFilter = kCLDistanceFilterNone; 
    locationManager.desiredAccuracy = kCLLocationAccuracyBest;

    [super viewDidLoad];
} 
```

我在 didUpdateToLocation 方法中填充单元格数组：

```
 self.title = @"Open Buildings";

NSMutableArray *buildingArray = [[NSMutableArray alloc] initWithObjects:building1, 

self.controllers = array; 
```

找到位置但未填充数组时，视图的标题会更新。当我在 viewdidupdate 中有上述代码时，该数组确实填充了。我不得不将它移动到 didupdatelocation 方法，因为当视图在 viewDidLoad 方法中加载时，应用程序将没有位置信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T00:30:09.800

Your table view doesn't know you have new data. So, once you have the new data, you need to tell your table view to reload:

```
[myTableView reloadData]; 
```

# sql - SQL唯一记录不是列？

> ID：707767
> 
> 赞同：2
> 
> 时间：2009-04-01T23:46:54.583
> 
> 标签：sql, insert, duplicate-data

有没有办法插入整个记录是唯一的 SQL 数据库？我知道您可以制作主键和唯一列，但这不是我想要的。

在不使数据库超载的情况下执行此操作的最佳方法是什么？我见过一种使用“WHERE NOT EXISTS ()”的子查询

我只想知道插入记录的最有效方法，这样就没有完全相同的记录的重复。

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T00:23:36.510

您知道如何在列上创建唯一索引。

只需在所有应该是唯一的列上都这样做：

```
create unique index foo 
on tablename(columnone, columntwo, columnthree); 
```

请注意，需要这样做可能表明您的表没有充分标准化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T00:24:08.893

您可以向表定义添加唯一约束并包括所有列（我相信主键除外）。唯一约束创建索引，所以我不知道这可能会对性能产生什么样的影响，但我猜列越少越好。

这会将这样的约束添加到现有表中：

```
ALTER TABLE SampleTable
ADD CONSTRAINT [uc_UniqueRow] UNIQUE (Column1, Column2, Column3) 
```

请注意，列类型等存在某些限制，因此这可能适用于您的表格，也可能不适用。有关详细信息，请参阅联机丛书：http: [//msdn.microsoft.com/en-us/library/ms177420 (sql.90).aspx](http://msdn.microsoft.com/en-us/library/ms177420(sql.90).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T23:58:38.753

你可以这样做：

```
create table #temp (val1 varchar(30), val2 varchar(30))

declare @val1 varchar(30),@val2 varchar(30)
select @val1='josh',@val2='bob'

insert into #temp
select @val1, @val2
where not exists (select * from #temp where val1=@val1 and val2=@val2) 
```

运行下半部分两次，它不会再插入一次记录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-26T04:31:49.590

你的问题很清楚（不知道为什么其他人回答你特别想排除的东西），以及我花了一个多小时试图找到的东西......

这个链接是最有帮助的 [http://www.timrosenblatt.com/blog/2008/03/21/insert-where-not-exists/](http://www.timrosenblatt.com/blog/2008/03/21/insert-where-not-exists/)

在 mySQL 5.1.35 ...

```
 mysql> CREATE TABLE testDupeSyntax  (name varchar(10), place varchar(20) );
Query OK, 0 rows affected (0.13 sec)

mysql>
mysql> INSERT INTO testDupeSyntax SELECT 'mango1', 'mango2' FROM DUAL WHERE NOT
EXISTS( SELECT name FROM testDupeSyntax WHERE name='mango1' LIMIT 1 );
Query OK, 1 row affected (0.06 sec)
Records: 1  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM testDupeSyntax;
+--------+--------+
| name   | place  |
+--------+--------+
| mango1 | mango2 |
+--------+--------+
1 row in set (0.00 sec)

mysql> INSERT INTO testDupeSyntax SELECT 'mango1', 'mango2' FROM DUAL WHERE NOT
EXISTS( SELECT name FROM testDupeSyntax WHERE name='mango1' LIMIT 1 );
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM testDupeSyntax;
+--------+--------+
| name   | place  |
+--------+--------+
| mango1 | mango2 |
+--------+--------+
1 row in set (0.00 sec)

mysql> INSERT INTO testDupeSyntax SELECT 'mango1', 'mango2' FROM DUAL WHERE NOT
EXISTS( SELECT name FROM testDupeSyntax WHERE name='mango1' AND place='mango2' LIMIT 1 );
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM testDupeSyntax;
+--------+--------+
| name   | place  |
+--------+--------+
| mango1 | mango2 |
+--------+--------+
1 row in set (0.00 sec)

mysql> INSERT INTO testDupeSyntax SELECT 'mango1', 'mango2' FROM DUAL WHERE NOT
EXISTS( SELECT name FROM testDupeSyntax WHERE name='mango1' AND place='mango3' LIMIT 1 );
Query OK, 1 row affected (0.05 sec)
Records: 1  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM testDupeSyntax;
+--------+--------+
| name   | place  |
+--------+--------+
| mango1 | mango2 |
| mango1 | mango2 |
+--------+--------+
2 rows in set (0.00 sec)

mysql> 
```

# c# - 如何使用 C# 从 pdf 文件中提取图像

> ID：707777
> 
> 赞同：10
> 
> 时间：2009-04-01T23:50:17.073
> 
> 标签：c#, image, pdf, bitmap

如何将 .pdf 文件中的图像放入 System.Drawing.Bitmap？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-09-08T18:40:17.733

您可能想为该任务尝试[Docotic.Pdf 库](https://bitmiracle.com/pdf-library/)。

以下示例展示了如何`System.Drawing.Bitmap`从 PDF 文件中的图像创建：

```
static void GetImagesFromPdfAsBitmaps()
{
    string pathToPdf = "";
    using (PdfDocument pdf = new PdfDocument(pathToPdf))
    {
        for (int i = 0; i < pdf.Images.Count; i++)
        {
            using (MemoryStream ms = new MemoryStream())
            {
                pdf.Images[i].Save(ms);

                // don't forget to rewind stream
                ms.Position = 0;

                System.Drawing.Image bitmap = System.Drawing.Bitmap.FromStream(ms);
                // ... use the bitmap and then dispose it
                bitmap.Dispose();
            }
        }
    }
} 
```

该库还可以将图像保存到文件中。该库不会重新采样图像（即您将获得与 PDF 中完全相同的图像）

免责声明：我为图书馆供应商 Bit Miracle 工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T23:58:47.113

对于与 .NET 中的 PDF 相关的任何事情，我推荐[iText#](http://itextsharp.sourceforge.net/tutorial/ch01.html)

看起来[可以](http://www.vbforums.com/showthread.php?t=530736)提取图像，但我没有机会对此进行测试。

希望这会有所帮助，祝你好运:)

# c# - C# 泛型中的“默认”类型参数是否有合理的方法？

> ID：707780
> 
> 赞同：98
> 
> 时间：2009-04-01T23:51:00.067
> 
> 标签：c#, generics, types, default, parameters

在 C++ 模板中，可以指定某个类型参数是默认值。即除非明确指定，否则它将使用类型 T。

这可以在 C# 中完成或近似吗？

我正在寻找类似的东西：

```
public class MyTemplate<T1, T2=string> {} 
```

这样一个没有明确指定的类型的实例`T2`：

```
MyTemplate<int> t = new MyTemplate<int>(); 
```

基本上是：

```
MyTemplate<int, string> t = new MyTemplate<int, string>(); 
```

最终，我正在研究一个案例，其中有一个相当广泛使用的模板，但我正在考虑使用额外的类型参数进行扩展。我想我可以子类化，但我很好奇这方面是否还有其他选择。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-04-01T23:53:38.797

子类化是最好的选择。

我会继承你的主要泛型类：

`class BaseGeneric<T,U>`

有一个特定的班级

`class MyGeneric<T> : BaseGeneric<T, string>`

这使得将您的逻辑保存在一个地方（基类）很容易，而且也很容易提供两种使用选项。根据班级的不同，实现这一点可能需要很少的额外工作。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2014-12-15T16:34:14.260

一种解决方案是子类化。我将使用的另一种方法是工厂方法（结合 var 关键字）。

```
public class MyTemplate<T1,T2>
{
     public MyTemplate(..args..) { ... } // constructor
}

public static class MyTemplate{

     public static MyTemplate<T1,T2> Create<T1,T2>(..args..)
     {
         return new MyTemplate<T1, T2>(... params ...);
     }

     public static MyTemplate<T1, string> Create<T1>(...args...)
     {
         return new MyTemplate<T1, string>(... params ...);
     }
}

var val1 = MyTemplate.Create<int,decimal>();
var val2 = MyTemplate.Create<int>(); 
```

在上面的例子`val2`中是类型`MyTemplate<int,string>` **而不是**从它派生的类型。

类型`class MyStringTemplate<T>:MyTemplate<T,string>`与 不同类型`MyTemplate<T,string>`。这可能会在某些情况下造成一些问题。例如，您不能强制`MyTemplate<T,string>`转换 to的实例`MyStringTemplate<T>`。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-12-02T02:23:07.537

你也可以像这样创建一个类 Overload

```
public class MyTemplate<T1, T2> {
    public T1 Prop1 { get; set; }
    public T2 Prop2 { get; set; }
}

public class MyTemplate<T1> : MyTemplate<T1, string>{} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-04-01T23:54:56.967

C# 不支持这样的功能。

正如您所说，您可以将其子类化（如果它没有密封，并复制所有构造函数声明），但这是完全不同的事情。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-01T23:57:09.990

不幸的是，C# 不支持您正在尝试做的事情。考虑到参数的默认类型必须遵守泛型约束，并且当 CLR 试图确保类型安全时很可能会让人头疼，这将是一个难以实现的功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2022-01-18T00:35:37.633

如果要将类型重载到接口，可以这样做： 示例：

```
public interface ISRD<TItem, TId>
{
    Task SaveAsync(TItem item);
    Task<TItem> GetAsync(TId id);
    Task DeleteAsync(TItem item);
}

public interface ISRD<TItem>: ISRD<TItem, Guid> { } 
```

# asp.net - 网格在 ASP.NET 中编辑多条记录

> ID：707781
> 
> 赞同：0
> 
> 时间：2009-04-01T23:51:18.317
> 
> 标签：asp.net, gridview, grid

我必须提供一个带有文本框网格的电子表格样式界面，供用户填写 ASP.NET 应用程序。构建它并保存结果的最有效方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T00:52:14.473

如果您需要大量控制用户可以使用网格做什么，我喜欢创建`DataGrid`每列都是`TemplateColumn`. 这样我可以选择每个`TextBox`绑定的方式，并且我可以完全控制如何保存数据，无论是逐行保存还是一次保存整个矩阵。

如果您有兴趣查看代码，请对此发表评论，我会尝试制作一些东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T00:13:51.663

它会有固定的行数吗？

如果用户不必插入新行，而只需要填写或修改现有单元格，那么[GridView](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.aspx)可能是要使用的适当控件。

如果您没有固定数量的行（即用户可以添加和删除行），那么[ListView](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listview.aspx)类将是要遵循的路径。关于保存它是相同的模型 - 用户逐行提交（或保存）。

关于保存结果，这取决于您是保存到平面文件还是数据库。ASP.NET 提供了许多可以插入到 GridView 或 ListView 中的数据源对象。

MSDN 对此有许多演练。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T21:36:43.053

MS GridView 的这个扩展看起来很有希望：

使用不带 xxxDataSource 的 GridView 进行批量编辑（SqlDataSource、ObjectDataSource 等） [http://www.codeproject.com/KB/webforms/BulkEditGridView.aspx](http://www.codeproject.com/KB/webforms/BulkEditGridView.aspx)

# c# - 托管 SIMPLEBLOB Blob 与非托管 SIMPLEBLOB 不匹配（RSA -Cryptography）

> ID：707785
> 
> 赞同：1
> 
> 时间：2009-04-01T23:52:28.610
> 
> 标签：c#, cryptography, rsa

使用生成的简单 blob

```
CryptExportKey(hKey, hPublicKey, SIMPLEBLOB, 0, lpData, &nSize); 
```

[与以下代码生成的不匹配（请注意，client.key 是使用http://www.codeproject.com/KB/security/plaintextsessionkey.aspx](http://www.codeproject.com/KB/security/plaintextsessionkey.aspx)找到的 hKey 的纯文本键值）

```
CspParameters cspParams = new CspParameters();            
cspParams.KeyContainerName = "Container Name";            
cspParams.KeyNumber = (int)KeyNumber.Exchange;
cspParams.ProviderType = 1;            
cspParams.ProviderName = "Microsoft Enhanced Cryptographic Provider v1.0";            cspParams.Flags = CspProviderFlags.UseMachineKeyStore;            

RSACryptoServiceProvider rsaClient = new RSACryptoServiceProvid(cspParams);               

    rsaClient.ImportCspBlob(File.ReadAllBytes(@"C:\client.key"));//Generate a SIMPLEBLOB session key

byte[] session = GetRC4SessionBlobFromKey(keyMaterial, rsaClient);//Encrypt a key using public key and write it in a SIMPLEBLOB format

   public byte[] GetRC4SessionBlobFromKey(byte[] keyData, RSACryptoServiceProvider publicKey)        
{              
using(MemoryStream ms = new MemoryStream())              
using(BinaryWriter w = new BinaryWriter(ms))            
{                   
w.Write((byte) 0x01); // SIMPLEBLOB                    
w.Write((byte) 0x02); // Version 2                    
w.Write((byte) 0x00); // Reserved                    
w.Write(0x00006801);  // ALG_ID = RC4 for the encrypted key.                
w.Write(0x0000a400);  // CALG_RSA_KEYX                    
w.Write(publicKey.Encrypt(keyData, false));                
w.Flush();                

return ms.ToArray();              
}        
} 
```

这是为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-05T14:59:01.460

1.  我[原始答案](https://stackoverflow.com/questions/684662/cryptexportkey-in-c/688855#688855)中的代码不正确。您必须反转加密的字节。我已经更新了解决该问题的答案。

2.  上面的代码缺少一个“ `w.Write((byte) 0x00); // Reserved`”。我最初的答案重复了那句话并不是一个错误。

3.  RSA PKCS#1 加密（在 SIMPLLEBLOB 中使用）不是确定性的。IE 两次加密相同的数据不会得到相同的结果。

所以总结一下：将上面的代码更改为：

```
public byte[] GetRC4SessionBlobFromKey(byte[] keyData, RSACryptoServiceProvider publicKey)        
{              
  using(MemoryStream ms = new MemoryStream())              
  using(BinaryWriter w = new BinaryWriter(ms))            
  {                   
    w.Write((byte) 0x01); // SIMPLEBLOB                    
    w.Write((byte) 0x02); // Version 2                    
    w.Write((byte) 0x00); // Reserved                    
    w.Write((byte) 0x00); // Reserved                    
    w.Write(0x00006801);  // ALG_ID = RC4 for the encrypted key.                
    w.Write(0x0000a400);  // CALG_RSA_KEYX                    
    byte[] encryptedKey = publicKey.Encrypt(key.Key);
    byte[] reversedEncryptedKey = new byte[encryptedKey.Length];
    for(int i=0;i<encryptedKey.Length;i++){
      reversedEncryptedKey[i] = encryptedKey[encryptedKey.Length - 1 - i];
    }
    w.Write(reversedEncryptedKey); // encrypted key in LSB byte order

    w.Flush();                

    return ms.ToArray();              
  }        
} 
```

然后通过使用 CryptImportKey() 导入 SIMPLEBLOB 而不是尝试将结果与 CryptExportKey() 进行比较来检查它是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T10:12:42.997

我无法编辑自己的问题，因此我将您希望我在此答案中附加的内容放在这里，我从下面的 Visual Studio 中的二进制编辑器/立即窗口中截取了图像

CryptExportKey - SIMPLEBLOB

[CryptExportKey - SIMPLEBLOB http://img14.imageshack.us/img14/1926/cryptoexportkeysimplebl.jpg](http://img14.imageshack.us/img14/1926/cryptoexportkeysimplebl.jpg)

调试窗口中的 KeyMaterial 值

[调试窗口中的关键材料值 http://img19.imageshack.us/img19/4138/keymaterialdebugwindow.jpg](http://img19.imageshack.us/img19/4138/keymaterialdebugwindow.jpg)

使用代码项目文章保存在文件中的 Key Material 值

[使用代码项目文章 http://img243.imageshack.us/img243/7936/keymaterialfile.jpg 保存在文件中的 Key Material 值](http://img243.imageshack.us/img243/7936/keymaterialfile.jpg)

来自 GetRC4SessionBlobFromKey() 的会话键值（由逗号分隔的单个字节的整数值）

[来自 GetRC4SessionBlobFromKey 的会话键值 http://img206.imageshack.us/img206/5620/sessionvaluefromgetrc4s.jpg](http://img206.imageshack.us/img206/5620/sessionvaluefromgetrc4s.jpg)

非常感谢您对此进行调查，如果我可以提供任何进一步的信息，请告诉我。

# excel - Excel VBA 复制 XL-2007 启用宏的工作簿作为没有宏的 excel-2003 文件

> ID：707800
> 
> 赞同：2
> 
> 时间：2009-04-01T23:58:57.847
> 
> 标签：excel, vba, copy, excel-2007, excel-2003

我正在寻找一个 vba 宏，该宏将使用我指定的名称作为 Excel 2003 无宏文档的当前启用宏的 Excel 2007 工作簿的副本。它还应使当前工作簿保持打开状态并保持 Excel 2007 格式（因此另存为不起作用）。

我不知道如何进行复制操作...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T19:18:38.440

保存为要容易得多。

为什么它必须保持开放？- 您可以通过以下方式模拟它：

*   对新文件执行另存为
*   关闭副本
*   重新打开原件

至于删除代码看看这些问题：

[Excel VBA代码模块的源代码控制](https://stackoverflow.com/questions/704759/how-to-remove-excel-vba-code-modules-when-spreadsheet-opened-closed)

[将活动工作表保存为新工作簿的宏，询问用户位置并从新工作簿中删除宏](https://stackoverflow.com/questions/680875/macro-to-save-active-sheet-as-new-workbook-ask-user-for-location-and-remove-macr)

# php - 使用 PHP 和 MySQL 自动发送电子邮件？

> ID：707816
> 
> 赞同：1
> 
> 时间：2009-04-02T00:02:14.390
> 
> 标签：php, mysql, automation, email

如何向用户输入的电子邮件地址发送自动电子邮件？

我有 Xampp，这是一个配备 Apache 的本地 Web 服务器，以及用于邮件的 Mercury。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T00:03:43.547

发送电子邮件：查找[邮件功能](http://us2.php.net/mail)。

要在 linux 中安排任务，请查找 crontab。

要在 Windows 中安排任务，请在控制面板中查找任务安排。

并且不要将 Xampp 用于生产。这是不安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T00:36:17.353

代替 php 的 mail() 函数，你应该使用[http://swiftmailer.org](http://swiftmailer.org)
之类的东西 。你可以轻松地进行 smtp-authentication、加密、mime-mail、字符编码、批量邮件……
而且你会得到更可靠的错误报告。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T01:02:06.510

这不是您问题的答案，但无论如何可能是相关的：

我使用本地网络服务器的经验是邮件无法到达目的地。这取决于您的 isp，但如果您每次连接到您的 isp（拨号、adsl、电缆）时都有一个不断变化的 IP 地址，那么您的外发邮件很可能会被收件人邮件服务器拒绝。

isp 为其客户提供的许多 IP 范围都被垃圾邮件过滤器阻止。

至少我所在的范围是:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T01:17:11.607

不过要小心，因为坏人会编写脚本来提交带有无数电子邮件地址的表单并尝试发送垃圾邮件。他们还将（尝试）在提交的地址中嵌入 \r\n 以写出其他内容和标题。我做这样的事情：

```
function sanitize($s) {
  $badheaders = array("/to\:/i", "/from\:/i", "/bcc\:/i", "/cc\:/i");
  $s = preg_replace($badheaders, '(spam)', $s);
    if (strlen($s) > 2048) {
       $s = substr($s, 0, 2048);
       $s = $s." (TRUNCATED)";
    }
    return $s;
} 
```

然后我在调用 mail() 之前通过 sanitize() 运行用户输入的字符串。当然是 YMMV。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T00:04:49.113

[php.net/邮件](http://php.net/mail)：

```
mail($to, $subject, $messge); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-14T03:02:50.127

你可以使用[phpmailer](https://github.com/PHPMailer/PHPMailer)通过SMTP协议发送邮件，这个库很不错！（Wordpress CMS 使用它！）

# wpf - 使用 WPF MV-VM 模式显示弹出窗口的正确方法

> ID：707818
> 
> 赞同：9
> 
> 时间：2009-04-02T00:03:37.040
> 
> 标签：wpf, design-patterns, mvvm, popup

当谈到弹出窗口时，我有一个关于 VM 职责的问题。当应用程序弹出消息框或某种对话框（使用 MVVM）时，我们有两个选项：

1.  将 UI (ShowDialog()) 代码放在 VM 中，这似乎很糟糕
2.  让 VM 发送某种 UI 可以订阅的事件并在后面的代码中显示一个对话框（但我们正在努力实现后面的零代码:)）

各位大佬是怎么处理这个案子的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T17:47:07.147

看看[玛瑙](http://www.codeplex.com/wpfonyx)。这是一个基于使用服务和服务定位器或依赖注入模式的 MV-VM 库（完全公开：我是作者）。有 MessageBox 和常用对话框的服务，添加自己的服务也很容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T01:04:00.170

不要将 UI 代码放在 VM 中，这只会导致很多麻烦。

当您想要弹出窗口或对话时，通常有两种情况。您这样做是因为商业案例，例如双击列表的详细视图，或者它完全基于 UI，例如弹出选项窗口。在第一种情况下，最好在 VM 中使用事件，在后一种情况下，我只使用事件处理程序。一个好的经验法则是，如果您不需要任何（重要的）VM 变量来完成操作，那么您应该只使用事件处理程序。

最重要的是，用你的头脑并相信你的判断，你很快就会学会使用哪个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T08:49:43.610

其他人未提及的其他几个选项：

**中继命令**

VM 执行一个我喜欢称之为“中继命令”的命令。这是由其他人处理的命令，VM 不在乎谁。命令执行只会引发`Executed`事件。您的视图将订阅此事件并以新`Window`的形式显示内容（内容将作为命令参数传递）。

请注意，中继命令不是路由命令。它不在其执行逻辑中搜索处理程序。它只是引发了一个事件。

**一项服务**

如果有很多情况需要在窗口中显示某些内容，请编写一个 UI 服务来处理它。虚拟机然后依赖这个服务（可以很容易地模拟）在窗口中显示内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T09:11:02.823

我想说最好的方法是`Popup`在 XAML 中定义，然后使用`DataTrigger`绑定到您的某些条件`ViewModel`来隐藏或显示它。然后，如果您关心处理来自 的返回值，请`Popup`在`EventTrigger`操作`Popup`属性`ViewModel`中反映该更改。

有很多关于这类领域的讨论，我认为这是因为人们习惯于在 WinForms 世界中编程。除了获取初始数据或设置之外，我还没有找到在视图中需要任何代码的解决方案`DataContexts`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T04:44:57.537

即使您打算使用消息框，也为您的弹出对话框创建一个界面。

在视图层次结构的视图底部有一个方法让演示者注册实现弹出窗口的类或表单。

让您的视图调用已注册的弹出窗口。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-08T17:16:48.403

有一个 ViewModel 用于弹出窗口和 View 作为用户控件。根据弹出窗口的复杂性，它可以是通用虚拟机，也可以是业务案例的具体虚拟机。当试图从父虚拟机显示它时，为弹出窗口的虚拟机创建一个“主机”类（从窗口或弹出窗口继承），显示它并将虚拟机分配给它。主机应负责定位正确的视图（通过 DataTemplate）

在这种情况下，您的弹出窗口的虚拟机仍然是可测试的，并且与父虚拟机的 WPF 耦合的最低级别是可以接受的，IMO。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-08T05:30:22.423

我同意 Carlos 的观点，即在视图中使用事件订阅不是一个好的选择。据我了解 MVVM，它可以消除视图中的任何代码，我真的很喜欢它 :)。MVVM 的优点之一是能够对其进行单元测试。但是我仍然相信即使弹出窗口也可以测试视图模型。我们所需要的只是使用带有所需视图模型的初始化内容的窗口。我认为VM应该打开新对话框可能有两种可能的情况：显示选项/设置窗口或显示取决于业务逻辑的窗口。在第一种情况下，新窗口代码是命令的唯一代码（“设置”或“选项”按钮/菜单项的命令）。在第二种情况下，我们有一些打开窗口的决策逻辑。但是在任何情况下，我们都可以将打开新窗口的代码移动到单独的方法/类中，并且在测试我们的 VM 时只是为了模拟这个方法/类。更重要的是，这个单独的类可以是某种通用的 WindowsController，它将跟踪应用程序中的所有窗口。但是我们仍然可以说视图模型使用帮助程序 WindowsController 打开弹出窗口，并且视图对其他窗口一无所知。所有业务逻辑都封装在模型和视图模型中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-02T01:21:36.883

我使用视图处理的事件。我不是 100% 喜欢它，但它支持自动化测试。

# c# - 哈希表与字典

> ID：707821
> 
> 赞同：13
> 
> 时间：2009-04-02T00:04:05.587
> 
> 标签：c#, .net

我的理解是 Dictionary 没有装箱问题并且[性能更快](http://www.phase9studios.com/2008/01/08/DictionaryVSHashTable.aspx)。与字典相比，是否存在使用 Hashtable 更可取的情况？谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-02T00:07:26.110

对于 .Net 2.0，您几乎总是需要 Dictionary。但是，请注意，它不仅仅是现有 Hashtable 的“替代品”。它们的工作方式（主要是它们处理空值的方式）存在一些差异，这意味着您确实需要先检查您的代码。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-02T00:05:53.913

`Hashtable`几乎已被弃用。它可能对与遗留代码交互很有用。

`Dictionary`是 .NET 2.0 中引入的泛型类，以及`System.Collections.Generic`命名空间中的其他类。它们取代了`System.Collections`命名空间中的类。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-02T00:06:00.840

HashTable 的主要优点是您可以使用它并以 .NET < 2.0 为目标。

否则， Dictionary<T,Y> （正确使用）在各方面都要好得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T07:43:37.690

这是我所知道的

1）字典存储在键值对中 2）Hastable 也存储在键值对中，但使用哈希键来探测内容。

因此，如果我要决定使用什么，如果我的集合很大并且我想搜索某个项目，我应该使用哈希表吗？如果集合不是那么大，使用字典？

还有一个后续问题是，在 c# 中，hastable 不像 c 或 c++ 那样进行链接，这是正确的吗？

# ruby-on-rails - 您可以强制 activerecord 关联更新而不保存它们吗？

> ID：707830
> 
> 赞同：2
> 
> 时间：2009-04-02T00:08:01.773
> 
> 标签：ruby-on-rails, activerecord, has-many, belongs-to

我有几个与这`has_many` `belongs_to`对关联的模型。为了演示，一个客户端有一个服务器，但一个服务器有很多客户端。我可能会做这样的事情：

```
client1.server = the_server
client2.server = the_server
client3.server = the_server 
```

我的实际应用程序比这复杂得多，但该示例将用于说明。

我想在保存这些对象之前检查它们之间的关联。ActiveRecord 在保存之前不会更新他们的信息。在上面的示例中，直到其中一个人得救之前，`the_server`都不知道是谁`client1`、`client2`或。`client3`我确信这有助于提高 active_record 的效率，但它会使内存中的模型实例处于不一致的状态。

我可以在客户端或服务器上调用任何会导致它们更新状态的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T01:08:44.077

调用`#reload`对象来更新它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T18:14:34.930

If you start off like this:

```
client1 = the_server.clients.build(:name => 'a client', ...) 
```

Then you should get what you're looking for I think.

EDIT:

Oops, I re-read your post and realized that `the_server` hasn't been saved yet either. In that case perhaps:

```
client1.server = the_server
the_server.clients << client1 
```

(be aware that this will save client1 if the_server is already saved)

or:

```
the_server.clients.build(:name => 'some client', ..., :server => the_server) 
```

A bit redundant so perhaps there's a better way out there.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T01:36:48.790

如果您使用创建关联的相反方式，那么您可以在保存模型之前查看模型：

```
the_server.clients << client1
the_server.clients << client2
the_server.clients << client3 
```

`client1.server`但是请注意，如果`the_server`已经存在，您只能在之后立即调用。

# java - 如何在 JMeter 中将变量从一个线程组传递到另一个线程组

> ID：707832
> 
> 赞同：59
> 
> 时间：2009-04-02T00:08:52.737
> 
> 标签：java, testing, jmeter, beanshell

我有一个带有 2 个线程组的 JMeter 测试 - 第一个是单个线程（创建一些库存），第二个有多个线程（购买所有库存）。我使用 BeanShell 断言和 XPath 提取器来解析返回的值（即 XML）并存储变量（例如要购买的商品的 id）。

但是，在第一个线程组中创建的值，无论是提取到标准`${jmeter}`类型变量还是`${__BeanShell(vars.get("jmeter"))}`类型变量中，都不能在第二个线程组中使用。无论如何要在第一个线程组中创建一个变量并使其对第二个线程组可见？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-04-02T15:16:36.470

我无法用变量来做到这一点（因为这些变量是单个线程的本地变量）。但是，我能够用属性解决这个问题！

同样，我的第一个 ThreadGroup 完成了所有设置，我需要从该工作中获取一些信息，以便第二个 ThreadGroup 中的每个线程都可以使用。我在第一个 ThreadGroup 中有一个 BeanShell 断言，其中包含以下内容：

```
${__setProperty(storeid, ${storeid})}; 
```

${storeid} 是使用 XPath 提取器提取的。BeanShell 断言执行其他操作，例如检查 storeid 是否从上一次调用中返回，等等。

无论如何，在第二个 ThreadGroup 中，我可以使用 Samplers 中“storeid”属性的值，如下所示：

```
${__property(storeid)} 
```

奇迹般有效！

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-05-17T18:55:50.270

根据 JMeter 文档：

> 16.12 在线程和线程组之间共享变量
> 
> 变量是线程的局部变量，一个线程中设置的变量不能在另一个线程中读取。这是设计使然。对于可以在测试开始之前确定的变量，请参阅参数化测试（上文）。如果在测试开始之前该值未知，则有多种选择：
> 
> 1.  将变量存储为属性 - 属性对于 JMeter 实例是全局的
> 2.  将变量写入文件并重新读取它们。
> 3.  使用 bsh.shared 命名空间 - 请参阅 [16.8.2 共享变量](http://jmeter.apache.org/usermanual/best-practices.html#bsh_variables)
> 4.  编写自己的 Java 类

在线程之间传递变量的另一种方法是使用[下面 Andrey Botalov 提到的](https://stackoverflow.com/a/12871601/632951)jmeter-plugins 。

但是我发现第一次使用它有点令人困惑，但它可以在从线程传递到线程期间完全控制变量。按照我的 BeanShell 使用示例，您会发现它是多么容易：

![项目结构](https://i.stack.imgur.com/CCEaU.jpg) 接下来参考下图中的部分：

(1.1) 在这里，我在用户定义的变量中创建了自定义变量（或者您可以使用 BSF 处理器来实现 - 在本例 (1.2) 中禁用）

(2.1)(2.4)我在第一个线程中成功使用了变量-没什么特别的:)

(2.2)添加了BeanShell PostProcessor并自定义了我的变量

(2.3)加入队列

(3.1) 在第二个线程中 - 变量取自队列 - 使用您想要的任何名称。但要小心，明智地使用超时，因为这个线程将等待直到前一次完成，所以它可以得到修改变量（实验一些长响应）

(3.2)(3.3)(3,4)重复使用和修改变量的步骤

(3.5) 变量在新队列中再次发送 - 所以为其提供新名称

(4.1)(4.2)(4.3) 从新队列中抓取修改后的变量就像魅力一样

警告

1.  如果您添加更多线程，则使用变量向线程组添加一些计数器并将此变量名称添加到队列名称中 - 在尝试捕获队列的线程组中执行相同操作，以便队列将为每个线程具有唯一名称（如果您需要一些更清晰的解释）

2.  如果您在一个线程组中有多个 http 请求，则将线程通信预处理器添加为 last 的子级（或其他，如果您想实现一些自定义的东西）http 请求

播放、修改、自定义以获得最佳结果 :) 添加更多线程可能会导致不需要的行为，因此您需要保持警惕。

![项目结构信息](https://i.stack.imgur.com/lpki7.jpg)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-08-12T13:51:09.803

我发现我认为这是完成这项工作的最简单方法。

采用

```
Bean Shell PostProcessor 
```

**设置在一个线程组中**

设置变量（[http://jmeter.apache.org/usermanual/best-practices.html#bsh_variables](http://jmeter.apache.org/usermanual/best-practices.html#bsh_variables)）

```
import org.apache.jmeter.util.JMeterUtils;
JMeterUtils.setProperty("PC_CREATED_PROMO_CODE", "value"); 
```

或者，如果您想将其设置为另一个变量中包含的值

```
import org.apache.jmeter.util.JMeterUtils;
JMeterUtils.setProperty("PC_CREATED_PROMO_CODE", vars.get("Extracted_PC_CREATED_PROMO_CODE")); 
```

**进入另一个线程组**

然后从另一个线程组，通过（[http://jmeter.apache.org/usermanual/functions.html#__property](http://jmeter.apache.org/usermanual/functions.html#__property)）阅读它

```
${__property(PC_CREATED_PROMO_CODE)} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-10-13T09:03:43.587

为此，JMeter 插件具有[线程间通信。](http://jmeter-plugins.org/wiki/InterThreadCommunication/)

有两种使用方法：

*   后处理器/预处理器
*   功能`__fifoPut`和`__fifoPop`

在我看来 PostProcessor/PreProcessor 更容易使用。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2018-06-01T14:37:09.993

![JMeter Bean Shell 断言](https://i.stack.imgur.com/8WoML.png)

只需添加一个 bean shell 断言，使用属性函数将值分配给一个变量（如全局变量），即使在它转到其他线程之后，该变量也会保存该值。

> 线程组 >> 添加 >> 断言 >> Bean Shell 断言

```
${__setProperty(Global_variable_Name,${Variable_name_whose_Value_to_be_Passed})} 
```

然后在另一个线程中你可以调用这个全局变量并可以使用它

以下是您需要用来调用存储值的函数：

```
${__property(global_variable_name)} 
```

[https://medium.com/@priyank.it/jmeter-passing-variables-between-threads-a4dc09903b59](https://medium.com/@priyank.it/jmeter-passing-variables-between-threads-a4dc09903b59)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-02T09:01:34.360

这在 JMeter 中是不可能的，因为这不是正常的客户端行为（线程之间共享参数）。取而代之的是使用一个带有控制器的线程组：

```
Thread Group
+ Create inventory
+ + XPath
+ Loop
+ + Purchase inventory 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-09-11T08:24:30.723

好吧，这是一种方法；按照这些步骤操作，它会起作用，稍后您可以根据需要进行调整！变量不在线程之间共享（JMeter 可能将此称为功能:)）。但属性是！因此，将您的变量设置为如下属性：

1）单击您的测试计划并启用“连续运行线程组”->这使线程组按顺序运行，而不是随机运行。（你可以稍后调整它，但现在让它工作..）

2）例如创建一个名为“setup”的线程组；在该线程组中添加一个 BeanShell 采样器，代码如下：

```
import org.apache.jmeter.util.JMeterUtils;
JMeterUtils.setProperty("theNameOfYourNewProperty", "theValueOfYourPropery"); 
```

所以现在属性已经设置好了！如果您要存储为属性的值是一个变量（例如用户定义的变量或 reqex 变量），您可以执行以下操作：

```
JMeterUtils.setProperty("theNameOfYourNewProperty", vars.get("theNameOfYourVariable")); 
```

3) 添加一个测试组“实际测试”，例如线程数大于 1；添加一个测试，然后在该测试中添加一个 BeanShell 预处理器，代码如下：

```
import org.apache.jmeter.util.JMeterUtils;
vars.put("theNameOfYourNewProperty", JMeterUtils.getProperty("theNameOfYourNewProperty")); 
```

因此，现在您已经在该线程中创建了一个名为 theNameOfYourNewProperty 的变量，该变量具有您的系统属性 theNameOfYourNewProperty 的值。在您的测试中，您现在可以像这样访问它：

```
${theNameOfYourNewProperty} 
```

它适用于每个线程，而不仅仅是第一个线程..

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-10-22T05:44:29.167

让主题重获新生 :) 在线程之间传输变量的另一种方法是写入/读取文件。[在线程之间传递变量](http://jmeter.apache.org/usermanual/hints_and_tips.html#variable_and_threads)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-01-06T15:37:07.493

另一种解决方案是使用简单表服务器来管理数据集。此功能添加了 1.2 JMeter 插件。

“主要思想是在 JMeter 插件中使用一个微型 http 服务器来管理数据集文件，使用简单的命令来**获取**/**添加**文件中的数据行”

查看文档：http: [//jmeter-plugins.org/wiki/HttpSimpleTableServer/](http://jmeter-plugins.org/wiki/HttpSimpleTableServer/)

问候。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-12-12T18:39:32.870

我使用 set 属性函数和 teardown teardowngroup 从 setupthreadgroup 获取值，但 teardown threadgroup 得到 401 错误。

我检查了所有标题，一切看起来都很好。不确定你的拆卸失败。有什么想法请给我建议

# mysql - 为什么这个 MySQL 查询的结果会相乘？

> ID：707833
> 
> 赞同：4
> 
> 时间：2009-04-02T00:09:12.270
> 
> 标签：mysql, cartesian-product

```
SELECT user_id,
    SUM(COALESCE(point_points, 0)) AS total_points,
    SUM(
        CASE
            WHEN point_date > '$this_month'
            THEN point_points
            ELSE 0
        END)                AS month_points,
    COUNT(DISTINCT c_id)    AS num_comments,
    COUNT(DISTINCT rant_id) AS live_submissions
FROM users
    LEFT JOIN points
    ON  users.user_id = points.point_userid
    LEFT JOIN comments
    ON
        (
            c_userid = user_id
        )
    LEFT JOIN rants
    ON
        (
            rant_poster = user_id
        AND rant_status = 1
        )
WHERE user_id = $id
GROUP BY user_id 
```

基本上`live_submissions`and`num_comments`变量显示正确的结果，而`total_points`and显示,和`month_points`的乘积。知道为什么会这样吗？`month_points/total_points``live_submissions``num_comments`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-02T01:24:12.057

这称为[笛卡尔积](http://en.wikipedia.org/wiki/Cartesian_product)。将表连接在一起时，默认结果是连接条件为真的**行的每个排列。**您使用`JOIN`条件来限制这些排列。

但是由于您将多个表连接到`users`，因此结果包括每个匹配表的每个排列。例如， 中的每个匹配行`points`重复 中的每个匹配行`comments`，并且每个匹配行再次相乘，重复 中的每个匹配行`rants`。

`COUNT(DISTINCT c_id)`您可以按照您的做法部分补偿这一点，但这`DISTINCT`是必要的，因为您每个`c_id`. 除非您将其应用于唯一值，否则它不起作用。此补救措施不适用于`SUM()`表达式。

基本上，您试图在一个查询中进行太多计算。您需要将其拆分为单独的查询以使其可靠。然后你也可以摆脱`DISTINCT`修饰符。

```
SELECT u.user_id, SUM(COALESCE(p.point_points, 0)) AS total_points, 
  SUM( CASE WHEN p.point_date > '$this_month' THEN p.point_points ELSE 0 END ) AS month_points
FROM users u LEFT JOIN points p
  ON u.user_id = p.point_userid 
WHERE u.user_id = $id
GROUP BY u.user_id;

SELECT user_id, COUNT(c.c_id) as num_comments, 
FROM users u LEFT JOIN comments c
  ON (c.c_userid = u.user_id)
WHERE u.user_id = $id
GROUP BY u.user_id;

SELECT u.user_id, COUNT(r.rant_id) as live_submissions
FROM users u LEFT JOIN rants r
  ON (r.rant_poster = u.user_id AND r.rant_status = 1)
WHERE u.user_id = $id
GROUP BY u.user_id; 
```

您不应该尝试在一个查询中完成所有这三个操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T00:13:10.950

你能提供一些示例输出吗？

我认为这与在要点中添加咆哮和评论有关。您可以尝试删除咆哮和评论表吗？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-02T00:23:54.543

如果您在分组之前查看查询输出，那么您会发现问题。如果用户在任何连接表中有超过 1 条记录，则将为用户返回多行。因此，如果用户有 2 条评论记录，那么也会返回 2 条点记录。

作为一个简化的例子......

> 用户表
> 
> 用户名
> 
> 1 弗雷德
> 
> 点表
> 
> userId 积分
> 
> 1 10
> 
> 评论表
> 
> userId 评论
> 
> 1 这里
> 
> 1 那里

从这些表中选择 * 将导致

> userId 积分 评论
> 
> 1 10 这里
> 
> 1 10 那里

我不完全确定 MYSQL 语法，但你会想要类似的东西

```
SELECT UserId, C.num_comments, P.total_points
FROM users
LEFT JOIN 
   (SELECT c_userId, COUNT(DISTINCT c_id) as num_comments
    FROM Comments
    GROUP BY c_userId)
    AS C
    ON UserId = c_userid
LEFT JOIN 
   (SELECT point_userId, sum(COALESCE(point_points, 0)) as total_points
    FROM Points
    GROUP BY point_userId)
    AS P
    ON UserId = point_userid 
```

# python - web.py：将初始化/全局变量传递给处理程序类？

> ID：707841
> 
> 赞同：1
> 
> 时间：2009-04-02T00:12:58.953
> 
> 标签：python, web.py

我正在尝试将 web.py 与 Tokyo Cabinet / pytc 一起使用，并且需要将 db 句柄（与 tokyo cabinet 的连接）传递给我的处理程序类，以便他们可以与 tokyo cabinet 交谈。

有没有办法将处理程序传递给处理程序类的**init**函数？或者我应该把句柄放在 globals() 中？什么是 globals() 以及如何使用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T10:47:49.287

最好的方法是添加一个负载钩子（[这里](http://webpy.org/cookbook/sqlalchemy)为 sqlalchemy 描述）。定义一个连接到 Tokyo Cabinet 的函数，并将生成的 db 对象作为 .orm 属性添加到 web.ctx，该属性在控制器中始终可用。

# php - 删除层次结构中的孤立项

> ID：707851
> 
> 赞同：2
> 
> 时间：2009-04-02T00:18:13.933
> 
> 标签：php, mysql

我在 MySQL 中有一个项目列表，通过列“parent_id”连接。

假设这些列是：id、name、parent_id

如果我的一个用户删除了层次结构中的一个项目，我需要删除它的所有子项。所以，两部分问题：

1) 是否有一个有效且高效的 MySQL 调用将返回其父项不再存在的所有项目的 ID？

2) 在 PHP 中，我想我可以将这些孤立的 ID 从 MySQL 获取到一个数组中，然后运行一个 foreach 循环并删除每个？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T00:19:17.953

如果您使用的是 InnoDB，您应该查看[外键约束](http://dev.mysql.com/doc/refman/5.1/en/innodb-foreign-key-constraints.html)`ON DELETE CASCADE`，在设置外键关系时使用该选项为您解决此问题。

文档中的一个示例：

```
CREATE TABLE parent (id INT NOT NULL,
                     PRIMARY KEY (id)) ENGINE=INNODB;

CREATE TABLE child (id INT, parent_id INT,
                    INDEX par_ind (parent_id),
                    FOREIGN KEY (parent_id) REFERENCES parent(id)
                    ON DELETE CASCADE) ENGINE=INNODB; 
```

有了它，如果您要添加一个父行和一个匹配的子行，如下所示：

```
INSERT INTO parent (id) VALUES (1);
INSERT INTO child (id, parent_id) VALUES (1,1); 
```

然后像这样删除父级：

```
DELETE FROM parent WHERE id = 1; 
```

您会发现匹配的子记录消失了。在我看来，这是最好的方法。

**编辑**：要在 1 个表中执行此操作，您将执行以下操作：

```
CREATE TABLE parent (
    id INT NOT NULL,
    name varchar(250) not null,
    parent_id INT NULL,
    FOREIGN KEY (parent_id) REFERENCES parent(id) ON DELETE CASCADE,
    PRIMARY KEY (id)
) ENGINE=INNODB 
```

然后，如果您添加两行，其中一行引用另一行：

```
INSERT INTO parent (id,name,parent_id)
VALUES ('1', 'Test 1', NULL), ('2', 'Test 2', '1') 
```

然后删除两者的父行：

```
DELETE FROM parent WHERE id = 1; 
```

你会发现它删除了`parent_id`1 的子行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T00:56:00.690

我猜原作者的想法是分层查询。

不幸的是，MySQL 没有对分层查询的原生支持（不像 Oracle，您可以使用它`CONNECT BY`来实现您想要的）。

删除所有孤儿的最简单方法可能是执行如下查询：

 `````
  SELECT t1.id 
    FROM table t1
      LEFT JOIN table t2 ON t2.id = t1.parent_id
    WHERE t2.id IS NULL

````  ``table`这将为您生成不存在其父级的所有行。

将其与持续执行查询并删除任何结果的 PHP 脚本配对，经过几次迭代后，您的表应该没有孤儿（整个事情可能会合并到一个 DELETE 语句中，您可以在 while 循环中执行） .

由于传递性，您需要多次执行 select-delete - 考虑孤儿是另一条记录的父项的情况；在第一次迭代中，您将删除第一个孤儿，使链中的下一条记录成为孤儿。

此外，请确保您明确跳过层次结构的头部，否则您最终会得到一个空表（因为根据定义，头部是一个孤儿）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T00:44:14.120

如果您的数据是线性分层的（每个节点只有一个父关系），并且高读低写，您可能会考虑将其迁移到修改后的预序树遍历结构。听起来很吓人，但实际上非常整洁。这里有一篇很棒的文章： [http ://www.sitepoint.com/article/hierarchical-data-database/1/](http://www.sitepoint.com/article/hierarchical-data-database/1/)

不仅从这种结构中检索数据非常有效（单次 SELECT 并获得所有子项），您还可以在单​​个 DELETE 语句中删除树的整个分支。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T00:24:57.630

RIGHT JOINS 通常用于在其他数据库中查找孤儿。但这也可以通过 LEFT JOIN 实现。

[这是](http://www.wellho.net/solutions/mysql-mysql-joins-using-left-join-and-right-join-to-find-orphan-rows.html)一篇关于在 MySQL 中获取孤立行的非常好的文章

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-02T01:10:16.723

另一种选择（如果您不使用 InnoDB，+1 Paolo）是在父 MySQL 表上 使用[删除触发器。](http://dev.mysql.com/doc/refman/5.0/en/trigger-syntax.html)

请记住，使用删除触发器时，删除行由**OLD**引用。这是一个示例触发器。

```
DELIMITER //

CREATE TRIGGER delete_clean BEFORE DELETE ON Parent
FOR EACH ROW
BEGIN
  DELETE * FROM Parent WHERE Parent.parent_id = OLD.id;
END //

DELIMITER ; 
```

# asp.net - asp.net 页面的持久状态

> ID：707858
> 
> 赞同：1
> 
> 时间：2009-04-02T00:23:09.490
> 
> 标签：asp.net, web-applications

我是 asp.net 的新手

这是我需要做的：我有一个名为 Results.aspx 的 asp.net 页面，它有 8 个 AJAX 可折叠面板和一个绑定到数据库的 gridview 控件。它还具有分页功能。

从这个页面，用户可以导航到应用程序中的其他页面。当他回到Results.aspx时，我需要保留以下区域的状态：1.所有可折叠面板2.Gridview控件3.Pagination

除了使用 asp.net 会话之外，在 asp.net 中实现这一目标的最有效方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T00:29:34.623

ASP.NET Session*是*执行此操作的最有效方式。您正在利用一个内置的、特定于会话的、特定于用户的状态管理器，它非常快速且经过优化，可以准确地完成您想做的事情。在这个特定的例子中，我建议您存储在会话中持久保存用户设置所需的元数据（不要将会话用作您将整个控件塞入其中的 ViewState 替代品）。如果您负责任地使用会话，那么我认为您会发现它适合您的需求。

你当然可以用其他方式来做，但你为什么要这样做？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T00:29:41.377

使用 ASP.NET 会话状态的效率与您将要获得的一样有效。如果您觉得正常的会话状态提供程序不适合您，您可以使用自定义会话状态提供程序，但这几乎是您在另一个页面上时保持页面状态的唯一方法。

我想您可以做的另一件事是将状态保留在隐藏字段中，然后以某种方式将其发布到之后您可能使用的所有其他页面。

* * *

ASP.NET`Cache`对象保存整个应用程序的信息——它不是每个用户的，所以它是一个非常糟糕的方式来保持每页每用户的状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T00:31:41.810

会话状态是一个选项，但如果你有一个服务器场或者你打算扩展你的应用程序，请注意如何实现它。

问候！！！

# javascript - 如何修复这个 JQuery 下拉菜单？

> ID：707865
> 
> 赞同：3
> 
> 时间：2009-04-02T00:25:14.197
> 
> 标签：javascript, jquery, menu, drop-down-menu

我试图在 JQuery 中创建一个下拉菜单，但事实证明这非常困难。

我的代码在这里：

```
 $(document).ready(function(){

        $('ul li').mouseover(function()
        {
              $(this).children("ul").show();
        });
        $('ul li ul').mouseover(function()
        {
              $('ul li ul').show();
        }).mouseout(function(){
              $('ul li ul').hide();
        });

  }); 
```

基本上我想将鼠标悬停在列表项和 sub ul 上以下拉，然后我可以将鼠标悬停在列表项上，如果鼠标离开子导航，菜单会再次隐藏。

谢谢，基思

更新：我从 CSS 中删除了边框并且它工作正常，所以当我将鼠标悬停在 1px 边框上时似乎触发了鼠标移出，这很奇怪。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T00:50:53.010

您应该使用[jQuery 的 hover() 函数](http://docs.jquery.com/Events/hover)，因为它可以避免所有特定于浏览器的问题..

如果没有一点测试，我会想象代码看起来更像：

```
 $('.clearfix li').hover(function() {
          $('ul', this).show();
        }, function() {
          $('ul', this).hide();
        }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T06:10:14.137

你知道[超级鱼](http://users.tpg.com.au/j_birch/plugins/superfish/)吗？它是一个jQuery 菜单插件，具有出色的跨浏览器支持。它绝对不存在您遇到的问题。我没有检查源代码，但关键的区别在于它增加了鼠标移出的延迟。这意味着一个动作不会被触发，除非光标的位置稳定了一段时间（默认延迟为 800 毫秒）。这将解决您的问题，并且实施起来也是一件好事，因为它将使您的菜单更加用户友好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T06:21:28.510

问题是，边框在盒子“外面”。如果您只是将下拉菜单向上移动 1 个像素，它会与菜单栏重叠 1 个像素，这会有所帮助。

只需将 CSS 中下拉菜单的顶部位置从 30px 更改为 29px，如下所示：

```
 ul li ul {
            border: none;
            position: absolute;
            top: 29px; /* <-- was 30px */ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T14:44:32.207

它在我的 Firefox 1.5.0.1 版本上运行良好 也许您没有最新版本。我自己经营一个图片库，但我不认为布局类型对我来说效果很好，因为我对我的图片有描述，而且有些图片很大。我不知道，这可能值得一试。

# objective-c - iphone-sdk，在多个视图之间共享数据

> ID：707867
> 
> 赞同：2
> 
> 时间：2009-04-02T00:26:35.597
> 
> 标签：objective-c, iphone

举个例子。。

单个 tabBarController 在两个视图之间切换，每个视图都由它们自己的视图控制器处理（比如说 viewController1、viewController2）。

我有一个名为 Widget 的类，它具有“名称”属性。

所以我在 view1 中有代码，它将读取文本字段的内容并设置我的小部件对象的“名称”属性。

我想在 view2 中有代码来读取小部件对象的“名称”属性并显示在某处。

**1\. 我将在哪里声明我的小部件类的实例？在 tabBarController 中？**

**2\. 如果是这样，我将如何在我的其他两个视图控制器中访问该实例？**

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T02:43:44.003

您可以将小部件类作为属性放在 Application Delegate 上。

```
@interface youAppDelegate : NSObject <UIApplicationDelegate> {
   Widget *myWidget;
}

@property (readonly) Widget *myWidget;

@end 
```

然后，在应用程序委托的消息“applicationDidFinishLaunching”上实例化它。

完成此操作后，您可以从项目中的任何位置访问 myWidget，如下所示：

```
youAppDelegate *ad = (youAppDelegate*)[UIApplication sharedApplication].delegate;
Widget *w = [ad myWidget]; 
```

该代码可以在 viewController1、viewController2 甚至 tabBarController 上完美地编译和执行。

# mysql - MySQL中INDEX、PRIMARY、UNIQUE、FULLTEXT之间的区别？

> ID：707874
> 
> 赞同：642
> 
> 时间：2009-04-02T00:32:30.950
> 
> 标签：mysql, indexing, key, schema

创建 MySQL 表时，PRIMARY、UNIQUE、INDEX 和 FULLTEXT 有什么区别？

我将如何使用它们？

* * *

## 回答 #1

> 赞同：703
> 
> 时间：2009-04-02T06:22:49.827

## 差异

*   **KEY**或**INDEX**指的是普通的非唯一索引。索引的非不同值是允许的，因此索引*可能*包含在索引的所有列中具有相同值的行。这些索引不会对您的数据实施任何限制，因此它们仅用于访问 - 用于快速到达特定范围的记录而无需扫描所有记录。

*   **UNIQUE**是指索引的所有行都必须唯一的索引。也就是说，对于该索引中的所有列，同一行可能不会与另一行具有相同的非 NULL 值。除了用于快速达到某些记录范围外，UNIQUE 索引还可用于对数据实施约束，因为数据库系统不允许在插入或更新数据时破坏不同值规则。

    您的数据库系统可能允许将 UNIQUE 索引应用于允许 NULL 值的列，在这种情况下，如果两行都包含 NULL 值，则允许它们相同（这里的基本原理是 NULL 被认为不等于自身）。但是，根据您的应用程序，您*可能会*发现这是不可取的：如果您希望阻止这种情况，您应该在相关列中禁止 NULL 值。

*   **PRIMARY**的作用与 UNIQUE 索引完全一样，只是它始终命名为“PRIMARY”，并且一张表上可能只有一个（并且*应该*始终有一个；尽管某些数据库系统不强制执行此操作）。PRIMARY 索引旨在作为唯一标识表中任何行的主要手段，因此与 UNIQUE 不同，它不应用于任何允许 NULL 值的列。您的 PRIMARY 索引应位于足以唯一标识行的最少列数上。通常，这只是一个包含唯一自动递增数字的列，但如果还有其他可以唯一标识一行的内容，例如国家列表中的“国家代码”，您可以使用它来代替。

    一些数据库系统（例如 MySQL 的 InnoDB）会按照它们在 PRIMARY 索引中出现的顺序将表的记录存储在磁盘上。

*   **FULLTEXT**索引与上述所有索引都不同，它们的行为在数据库系统之间存在显着差异。FULLTEXT 索引仅对使用 MATCH() / AGAINST() 子句完成的全文搜索有用，这与上述三个不同 - 通常在内部使用 b-trees 实现（允许从最左边的列开始选择、排序或范围）或哈希表（允许从最左边的列开始选择）。

    在其他索引类型是通用的地方，一个 FULLTEXT 索引是专门的，因为它服务于一个狭窄的目的：它只用于“全文搜索”功能。

## 相似之处

*   所有这些索引中可能包含多于一列。

*   除了 FULLTEXT 之外，列顺序很重要：要使索引在查询中有用，查询必须使用从左侧开始的索引中的列 - 它不能只使用索引的第二、第三或第四部分索引，除非它还使用索引中的先前列来匹配静态值。（要使 FULLTEXT 索引对查询有用，查询必须使用索引的*所有*列。）

* * *

## 回答 #2

> 赞同：163
> 
> 时间：2009-04-02T00:45:22.323

所有这些都是指数的种类。

**primary：**必须是唯一的，是一个索引，是（可能）物理索引，每个表只能是一个。

**独特的：**正如它所说。这个值的元组不能超过一行。请注意，由于唯一键可以超过一列，这并不一定意味着索引中的每个单独的列都是唯一的，而是这些列中的每个值组合都是唯一的。

**index：**如果它不是主要的或唯一的，它不会限制插入到表中的值，但它确实允许更有效地查找它们。

**fulltext：**一种更专业的索引形式，允许全文搜索。将其视为（本质上）为指定列中的每个“单词”创建一个“索引”。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2016-01-19T01:54:16.717

我觉得这已经很好地涵盖了，也许除了以下内容：

*   如果选择性足够，简单`KEY`/ `INDEX`（或称为）确实会提高性能。`SECONDARY INDEX`关于这个问题，通常的建议是，如果应用了索引的结果集中的记录数量超过了父表记录总数的 20%，那么索引将失效。在实践中，每种架构都会有所不同，但这个想法仍然是正确的。

*   二级索引（这是 mysql 特有的）不应被视为与主键完全分离且不同的对象。事实上，两者都应该联合使用，一旦知道了这些信息，就可以为 mysql DBA 提供一个额外的工具：在 Mysql 中，索引嵌入了主键。它带来了显着的性能改进，特别是在巧妙地构建隐式覆盖索引时，例如[那里描述](http://www.psce.com/blog/2012/05/17/can-mysql-use-primary-key-values-from-a-secondary-index/)的。

*   如果您觉得您的数据应该是`UNIQUE`，请使用唯一索引。您可能认为它是可选的（例如，在应用程序级别解决）并且普通索引就可以，但它实际上代表了对 Mysql 的保证，即每一行都是唯一的，这顺便提供了性能优势。

*   您只能在 Innodb（在 MySQL 5.6.4 及更高版本中）和 Myisam 引擎中使用`FULLTEXT`（或以其他方式调用）`SEARCH INDEX`

*   您只能使用`FULLTEXT`on`CHAR`和`VARCHAR`column`TEXT`类型

*   `FULLTEXT`索引涉及的不仅仅是创建索引。创建了一堆系统表，一个完全独立的缓存系统和一些特定的规则和优化应用。请参阅[http://dev.mysql.com/doc/refman/5.7/en/fulltext-restrictions.html](http://dev.mysql.com/doc/refman/5.7/en/fulltext-restrictions.html)和[http://dev.mysql.com/doc/refman/5.7/en/innodb-fulltext-index.html](http://dev.mysql.com/doc/refman/5.7/en/innodb-fulltext-index.html)

# python - 哪些 Python 贝叶斯文本分类模块类似于 dbacl？

> ID：707879
> 
> 赞同：11
> 
> 时间：2009-04-02T00:34:26.233
> 
> 标签：python, text, classification, bayesian

快速的谷歌搜索显示有大量的贝叶斯分类器被实现为 Python 模块。[如果我想要类似于dbacl](http://dbacl.sourceforge.net/)的封装的高级功能，哪些模块适合我？

训练

```
% dbacl -l one sample1.txt
% dbacl -l two sample2.txt 
```

分类

```
% dbacl -c one -c two sample3.txt -v
one 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-02T00:49:04.187

我想你会发现[nltk](http://www.nltk.org)很有帮助。具体来说，[分类模块](http://nltk.googlecode.com/svn/trunk/doc/api/nltk.classify-module.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T03:57:28.257

如果您尝试检测语言 ，即使是非常短的文本也可以正常工作[。](http://cogscicoder.blogspot.com/2009/03/automatic-language-identification-using.html)

该 api 与您的非常接近，但我不知道它是否称为贝叶斯分类器。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-03T14:50:11.220

试试[Mallet](http://mallet.cs.umass.edu)和[LingPipe](http://alias-i.com/lingpipe/)。他们为分类器提供了更多的模型。

# wcf-data-services - 使用从客户端库调用的参数的 ADO.Net 服务服务操作失败

> ID：707881
> 
> 赞同：1
> 
> 时间：2009-04-02T00:35:19.740
> 
> 标签：wcf-data-services

控制台应用程序

```
var result = dataService.CreateQuery<Customers>("GetCustomerByLastName").
    AddQueryOption("lastname", "S"); 
```

服务

```
 [WebGet]
    public IQueryable<Customers> GetCustomerByLastName( string lastname )
    {
       return   from c in this.CurrentDataSource.Customers
                where c.LastName.StartsWith( lastname )
                select c ; 
    } 
```

结果：（相对于[http://localhost:1478/Apress.Data.Services.CustomerService.Host/](http://localhost:1478/Apress.Data.Services.CustomerService.Host/)）

RequestUri: CustomerDataService.svc/GetCustomerByLastName()?lastname=S

并因此失败，因为 uri 中的括号不是预期的。

CustomerDataService.svc/GetCustomerByLastName?lastname='S'

在浏览器中工作。

与 2008 SP1 相比。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T06:40:13.687

原来问题与括号无关，我缺少字符串文字单引号

应该

```
AddQueryOption("lastname", "'S'"); 
```

但

```
GetCustomerByLastName()?lastname='S' 
```

和

```
GetCustomerByLastName?lastname='S' 
```

两者都适用于 ADO.Net 数据服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T01:38:43.707

您可能已经尝试过了，但是没有 AddQueryOption 会发生什么？我知道它不会传递参数，但这会改变括号的问题吗？此外，如果您这样做并将服务更改为不需要参数，会发生什么？关于括号的同样问题。

最后，如果这是一个错误，请在[Connect](http://connect.microsoft.com/visualstudio/)上报告。然后在此处发布 URL，以便我们对我们认为问题的重要性进行投票。一定要先搜索一下，看看有没有其他人举报过。

# c# - 通过 C# WebRequest 使用 HTTP 身份验证

> ID：707888
> 
> 赞同：27
> 
> 时间：2009-04-02T00:38:41.747
> 
> 标签：c#, authentication, webrequest

我想向需要身份验证的页面发出 Web 请求。我该怎么做呢？我发现了一些可能使用 Credentials 属性的东西，但我不确定如何使用它。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-04-02T00:39:35.737

为属性分配一个新`NetworkCredential`实例`Credentials`：

```
webClient.Credentials = new NetworkCredential("Mehrdad", "Password"); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-12-04T15:51:36.150

基本身份验证示例：

```
public void SetBasicAuthHeader(WebRequest req, String userName, String userPassword)
{
    string authInfo = userName + ":" + userPassword;
    authInfo = Convert.ToBase64String(Encoding.Default.GetBytes(authInfo));
    req.Headers["Authorization"] = "Basic " + authInfo;
} 
```

[http://blog.kowalczyk.info/article/at3/Forcing-basic-http-authentication-for-HttpWebReq.html](http://blog.kowalczyk.info/article/at3/Forcing-basic-http-authentication-for-HttpWebReq.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-07T00:38:43.940

也可以自动进行身份验证。这将使用当前登录用户的凭据。

```
webClient.Credentials = CredentialCache.DefaultCredentials 
```

# javascript - Javascript：为什么要与 null 比较？

> ID：707890
> 
> 赞同：8
> 
> 时间：2009-04-02T00:40:22.193
> 
> 标签：javascript

我从事的一个开源 JavaScript 项目包括代码：

```
if (color) {
      tapeDiv.style.backgroundColor = color;
      // set color here if defined by event. Else use css
    } 
```

贡献者想要将其更改为

```
if (color != null) {  // this line changed
      tapeDiv.style.backgroundColor = color;
      // set color here if defined by event. Else use css
    } 
```

颜色是一个字符串变量。只能使用超过 0 个字符的字符串来显式设置颜色。

既然 JS 将 "" 和 null 转换为 boolean false，为什么需要比较 != null 呢？

我认为第一种形式与第二种形式一样好（而且短一点）是不是错过了什么？

我经常在 JS 源代码中看到与 null 的比较。当所有 JS 简单对象在转换为布尔值时都知道结果时，为什么需要它们？

谢谢，

拉里

附言。我想如果 0（一个整数）是一个有效的情况，那么 if(0) 将是错误的 [一个问题] 并且 if(0 != null) 将是真的 [允许 0 的情况]。还有什么原因吗？

pps。应该提到tapeDiv 是新创建的。所以没有必要将样式重置为“”，因为 div 是全新的。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-02T02:04:44.237

使用所有可能的虚假值评估作业，您将得到答案：

```
tapeDiv.style.backgroundColor = false; // does nothing

tapeDiv.style.backgroundColor = 0;     // sets as "black", 
                                       // but ignored by FF

tapeDiv.style.backgroundColor = null;  // resets the background-color
                                       // to use whatever is defined
                                       // in a stylesheet (if any),
                                       // but ignored by IE.

tapeDiv.style.backgroundColor = '';    // resets the background-color
                                       // to use whatever is defined
                                       // in a stylesheet (if any). 
```

对“”的检查`if (color)`不会让他们中的任何一个通过。

对 " " 的检查`if (color != null)`将使 1)、2) 和 4) 通过。1) 不执行任何操作，2) 在 Firefox 中无法按预期工作，4) 将始终按预期工作。但是，“作品”取决于您的上下文（您没有提供）。

希望有帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-02T00:44:47.660

不，你的ps是正确的。Null 将评估为 false，如果需要将 null 与空字符串或 0 区分开来，那么您将进行 null 检查。

或者它可能只是为了清楚起见。它更具描述性，表明您正在专门寻找空值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T00:45:08.907

backgroundColor = "" 有什么作用吗？是否将颜色设置为默认颜色？如果是这种情况，那么作为重置颜色的一种方式是有意义的。

如果（颜色）{}

如果颜色为“”，则会失败，但在第二种情况下，它将重置背景颜色。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T00:56:36.540

如果颜色可以作为整数出现，则不能将背景设置为黑色 ( `#000000`= `0`)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T10:10:42.293

> 只能使用超过 0 个字符的字符串来显式设置颜色。

为什么？分配空字符串意味着颜色将被重置（即将使用 CSS 定义的默认值），这是一个完全有效的用例。

您应该做的就是检查是否`color`已定义，即

```
typeof color !== 'undefined' 
```

或者如果它是一个字符串变量

```
// checks for primitive strings
typeof color === 'string'

// checks for primitive strings and string objects
typeof color === 'string' || color instanceof String

// checks for primitive strings and string objects, cross-frame safe
Object.prototype.toString.call(color) === '[object String]' 
```

如果它可能包含不正确类型的值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-08T12:56:33.087

if(typeof color == 'string' && color.length)

对于 typeof 使用“==”就足够了，如果 typeof 是字符串，那么它将检查 color.length。否则，如果在检查第二个条件之前，它将退出。我相信这是最完整的解决方案。

但是，如果您确定 color 是一个字符串变量并且在初始化之前在某处定义，那么您可以像以前一样只使用“if(color)”，但请记住，如果在 if 时未定义颜色声明，你会得到一个 ReferenceError。

# c# - C#：你将如何让 D0 到 D9 在没有 D 的情况下以数字形式转换？

> ID：707893
> 
> 赞同：0
> 
> 时间：2009-04-02T00:44:06.570
> 
> 标签：c#

示例： (e.KeyCode >= Keys.D0) && (e.KeyCode <= Keys.D9)

我正在尝试检测文本框中的 keydown 事件是否按下了数字键

(e.KeyCode >= Keys.D0) && (e.KeyCode <= Keys.D9)，将 e.KeyCode 作为字符串显示到列表框中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T00:45:23.163

假设它们是按顺序定义的`enum`：

```
(int)key - (int)Keys.D0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T00:49:27.913

您正在寻找[KeysConverter](http://msdn.microsoft.com/en-us/library/system.windows.forms.keysconverter.aspx) TypeConverter。

# c# - 这个缓存功能是否像我认为的那样工作？

> ID：707909
> 
> 赞同：0
> 
> 时间：2009-04-02T00:55:46.230
> 
> 标签：c#, .net, caching, weak-references

我暂时写了这个方法：

```
public static Func<T> WeakCacheFor<T>( Func<T> provider ) where T: class
{
    var cache = new WeakReference(null);
    return () => {
        var x = (T)cache.Target;
        if( x == null )
        {
            x = provider();
            cache.Target = x;
        }
        return x;
    };
} 
```

所以有点背景：

我有一些冗长的遗留方法，看起来有点像这样：

```
var id = GetDatabaseId();
if(a){
    var data = GetLoader().Init(id).GetData(); // expensive!
    // do stuff with data
}
if(b){
    // don't load data
}
... lots more variations, some contain GetLoader().Init(id).GetData(); some don't.... 
```

我可能的解决方案是这样做：

```
var id = GetDatabaseId();
var loadData = WeakCacheFor(() => GetLoader().Init(id).GetData());
if(a){
    var data = loadData();
    // do stuff with data
}
if(b){
    // don't load data
}
... lots more variations, some contain loadData(); some don't.... 
```

我对此的看法：

*   超出这个方法调用的范围我不需要缓存，所以只要方法一返回GC就收集就好了
*   如果代码采用不需要加载数据的路径，则不会发生命中
*   如果它确实需要数据，如果再次需要，它将被缓存在弱引用中。
*   如果 GC 确实在中途收集，则无关紧要，因为它只会重新加载。

我的问题：

1.  这真的会奏效吗？- 我在`WeakCacheFor`方法中是否遗漏了任何可能导致无意中被强烈引用的内容？
2.  我是不是为了自己的利益太聪明了？- 即使不需要，我是否应该只招致命中并将数据缓存在普通的局部变量中？

我怀疑我可能太聪明了，但即使我是，这在其他人看来是否像一个可以在其他情况下有用的解决方案？

更新：修改功能，因为[显然你不能信任 .IsAlive](http://blogs.msdn.com/clyon/archive/2006/04/20/580255.aspx)

更新：我意识到返回的`Func`将在方法结束时超出范围，所以我根本不需要弱引用，普通的引用就可以了。我认为我正遭受“只见树木不见森林”的情况。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T02:07:40.610

我认为使用弱引用没有任何意义。加载数据后，几乎没有任何理由将其丢弃，直到您确定它不再有用为止。

您正在实施的是延迟加载模式的变体。坚持简单的模式，只使用对项目的常规引用：

```
public static Func<T> LazyLoad<T>(Func<T> provider) where T : class {
   T item = null;
   return () => {
      if (item == null) {
         item = provider();
      }
      return item;
   };
} 
```

（还有一个小提示：您使用的`var`关键字方式太多了。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T02:22:06.333

几个一般性评论：

1.  您的解决方案（以及我的）不是线程安全的。
2.  它不是为使用 IDisposable 对象而设计的。

对于以下讨论，请考虑：

```
foo = WeakCacheFor<Foo>(() => CreateFoo()); 
```

案例#1：使用 foo 作为一个长期存在的变量（例如一个长期存在的类的成员，或者一个全局变量）

您的解决方案在这里有意义。该变量将在需要时创建，并在系统在 GC 期间释放资源时销毁。

但是请注意，如果 foo 耗时但内存便宜，那么使用单例模式并在应用程序期间加载一次可能是有意义的吗？

案例 #2\. 使用 foo 作为局部变量。

在这种情况下，我猜最好使用单例模式。考虑这样的例子：

```
static void Main(string[] args)
{
    MethodA(5, 7);
    MethodA(8, 9);
}

static void MethodA(int a, int b)
{
    var foo = WeakCacheFor<Foo>(() => new Foo());

    if (a > 3)
    {
        Use(foo);

        if (a * b == 35)
        {
            GC.Collect(); // Simulate GC
            Use(foo);
        }
        else if(b % 6 == 2)
        {
            Use(foo);
        }
    }
} 
```

foo 将被创建 3 次。如果您评论“模拟 GC”行，则为 2 次。您也不能将其用于 IDisposable 类。

现在让我们尝试一个单例：

```
static void MethodA(int a, int b)
{
    using (var foo = new MySingleton<Foo>(() => new Foo()))
    {
        if (a > 3)
        {
            Use(foo);

            if (a * b == 35)
            {
                GC.Collect(); // Simulate GC
                Use(foo);
            }
            else if (b % 6 == 2)
            {
                Use(foo);
            }
        }
    }
} 
```

如您所见，代码几乎没有改变，但现在我们只得到 2 次调用 foo ctor 和 IDisposable 支持。

一个粗略的单例实现：

```
class MySingleton<T> : IDisposable
    where T : class
{
    private T _value;
    private Func<T> _provider;

    public MySingleton(Func<T> provider)
    {
        _provider = provider;
    }

    public T Get()
    {
        if (_value == null)
        {
            _value = _provider();
        }

        return _value;
    }

    #region IDisposable Members

    public void Dispose()
    {
        if(_value == null)
            return;

        IDisposable disposable = _value as IDisposable;

        if(disposable != null)
            disposable.Dispose();
    }

    #endregion
} 
```

其余代码：

```
class Foo : IDisposable
{
    public void Dispose() {}
}

static void Use(MySingleton<Foo> foo)
{
    foo.Get();
}

static void Use(Func<Foo> foo)
{
    foo();
} 
```

# asp.net - CodeBehind 中的数据上下文？

> ID：707914
> 
> 赞同：0
> 
> 时间：2009-04-02T00:57:47.580
> 
> 标签：asp.net, linq-to-sql

我正在开发一个 ASP.NET 应用程序并第一次使用 LINQ to SQL，但似乎有些不对劲。通常在一个web项目上，有一个数据访问层，一个biz层和preso层......难道linq to sql不能这样工作吗？我看到其他开发人员将 DataContext 直接放入 Preso 层并从那里通过 linq 调用 DB。这是正确的方法吗？没有商务层？谢谢约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T01:00:46.170

如果您正在寻找您和数据库之间的更多抽象层，那么 LinqToSql 可能不是您的正确选择。也许[ADO.NET Entity Framework](http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx)是更好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T01:00:37.747

您可以将 LINQ 封装在数据访问层中。但对于大多数中小型项目来说，这已经足够了。

您应该始终牢记高层次的目标。您使用面向对象和设计模式来降低实现成本和可维护性。当最简单和最快的设计满足大部分需求并且足够可维护时，没有必要过度设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T01:07:44.343

通常的做法也是实现存储库模式：

*   [将 IRepository 模式与 LINQ to SQL 一起使用](http://mikehadlow.blogspot.com/2008/03/using-irepository-pattern-with-linq-to.html)
*   [使用 Linq-to-Sql 实现存储库模式](http://www.codeproject.com/KB/architecture/linqrepository.aspx)

# javascript - 是否有利用 jQuery 的 JavaScript WYSIWYG？

> ID：707916
> 
> 赞同：5
> 
> 时间：2009-04-02T00:58:36.673
> 
> 标签：javascript, jquery, wysiwyg

我看过[TinyMCE](http://tinymce.moxiecode.com/)、[FCKeditor](http://www.fckeditor.net)、[YUI Rich Text Editor](http://developer.yahoo.com/yui/editor/)、[NicEdit](http://www.nicedit.com/)和其他一些，但我想知道是否有一个使用 jQuery 的？我的意思是，我已经在我的所有项目中使用了 jQuery，而且拥有一个使用它的 WYSIWYG 编辑器似乎很有用。这应该会导致更小的文件大小。

我知道如果不存在（因为它们可能是在 JS 框架流行之前开发的，现在更改代码库工作量太大），或者只是为了便于部署（不依赖于任何框架）。

那么，是否存在，它有什么好处吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-02T01:33:41.567

[jquery 所见即所得](http://code.google.com/p/jwysiwyg/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T19:36:47.987

我使用[imperavi redactor](http://imperavi.com/redactor/)的编辑器已经有一段时间了。快速，简单，可能不是很实用，但不断发展

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T01:56:08.813

它不是一个成熟的 WYSIWYG 编辑器，但如果您需要做一些标记语言，如 Markdown、BB Code、Textile、一些 Wiki 语法甚至原始 HTML，它肯定会很方便。

[标记！通用标记编辑器](http://markitup.jaysalvat.com/home/ "标记！ 标记编辑器")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T01:00:31.537

[这里](http://batiste.dosimple.ch/blog/posts/2007-09-11-1/rich-text-editor-jquery.html)有一个 Batiste Bieler 的轻量级插件

# c++ - GCC 编译器错误：“重新定义...以前定义”

> ID：707920
> 
> 赞同：17
> 
> 时间：2009-04-02T01:00:36.560
> 
> 标签：c++, gcc, compiler-construction

我收到了很多“重新定义 x....x 之前在这里定义的内容”。请问这个错误是什么意思？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-02T01:18:41.120

您需要限制每个文件只包含一次。您可以通过 2 种方式做到这一点。

1）在头文件的顶部放置：

```
#pragma once 
```

或者 2）如果您的编译器不支持，请将其放在头文件的顶部/末尾：

```
#ifndef _MYFILE_H_
#define _MYFILE_H_
...
#endif 
```

将 MYFILE 替换为您的文件名，并将 ... 替换为头文件的内容。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-02T07:09:03.710

该错误意味着有一个符号已在一个地方定义，而另一个定义已在另一个地方进行。

在以下情况下可能会发生这种情况：

*   如果你定义了两个同名的函数
*   如果函数与其原型不匹配
*   你在定义之前调用一个非平凡的函数，并且没有原型

在最后一种情况下，实际函数与编译器在没有原型可供使用时假定的“隐式声明”之间存在不匹配。

这些情况可以通过以下方式避免：

*   确保函数原型只声明一次
*   确保所有函数在其范围内具有唯一的名称（即，如果它们是，则在文件中`static`，或者如果它们在目标文件之间使用，则它们是唯一的）
*   `extern`如果在源文件中使用语句来声明原型，请小心。最好使用相应头文件中的原型。
*   确保所有函数都有原型——在`static`函数的情况下在源文件中，或者在其他目标文件使用时在头文件中。
*   通过使用 Mehrdad 和 Brian R. Bondy 建议的任何一种结构，确保每个源文件的所有头文件只能包含一次

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-02T01:03:07.677

您可能包含两次头文件。确保您的头文件被`#ifndef`语句包围。

[http://www.fredosaurus.com/notes-cpp/preprocessor/ifdef.html](http://www.fredosaurus.com/notes-cpp/preprocessor/ifdef.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-10T12:29:43.777

同样的事情发生在我身上，这是因为我不小心包含了 .c/.cpp 文件（在其中）而不是头文件。

那肯定会让你犯很多错误。

# windows - Windows XP 如何使用显示器的 EDID 来确定允许的显示模式？

> ID：707925
> 
> 赞同：2
> 
> 时间：2009-04-02T01:01:20.850
> 
> 标签：windows, windows-xp, resolution

我正在开发一种视频显示设备，该设备使用不符合任何 VESA 标准的 848x480 和 800x480 分辨率的自定义时序。设备有一个 EDID 来指定这些时间。

我想知道 Windows XP 用于确定显示分辨率的过程，以及它如何向用户提供选择列表。这似乎高度依赖于视频卡制造商和驱动程序。

我在不同的系统上观察到截然不同的行为：

*   似乎 vanilla Windows XP 除了在启动时不会查询 EDID，但是笔记本电脑和自定义视频驱动程序有时似乎会随意查询 EDID（插入不重新启动的计算机，点击演示模式，然后显示设备名称）
*   有些 PC 似乎可以毫无问题地生成 848x480 或 800x480，但有些似乎只是忽略了详细的时序并退回到 VESA 640x480。如果您指定自定义时序模式，任何给定的视频驱动程序/卡将能够生成正确的 VGA 信号的机会有多大？
*   很多时候，EDID 信息会传输到系统，但是如果您打开 Windows 显示属性，并在设置选项卡中选择设备，可用模式的滑块不会显示 848x480 或 800x480。它通常只在其他标准模式列表中显示 640x480（但不是提供的自定义模式）。
*   如果发生这种情况，您通常可以通过在显示属性 -> 设置 -> 高级 -> 适配器 -> 列出所有模式下的所有模式列表中选择设备来让设备以 848x480 或 800x480 显示。当您选择此项时，它会切换到正确的分辨率。
*   但是，如果您返回显示属性 -> 设置，您将在滑块中看到您选择的模式，但滑块只有一种分辨率。它应该（至少）也显示 640x480。在处理 Windows XP 和非标准视频时序时，这只是现实吗？很高兴确切地知道 Windows 如何填充该滑块。

我将非常感谢任何讨论与所有这些相关的细节的资源。我知道这不是严格意义上的编程问题，但它与我遇到的编程问题密切相关，而且我很难找到有关此主题的任何信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T21:39:36.233

啊，我感受到了你的痛苦。以前去过那里。您是否也在编写显示驱动程序？显示驱动程序也可以修剪模式，但通常只有在某些原因它无法物理处理它时才会这样做。此外，许多显示驱动程序将添加一定的默认模式列表（如 640x480），而不管 EDID 中的内容是什么。

我知道 Windows 会对 EDID 中指定的监视器范围限制进行一些检查。而且它们也不是直观的检查，因此您可以使用它。此外，刷新率也会影响 Windows 修整逻辑。

关于何时读取 EDID，我通常会在启动后第二次打开显示属性时看到 EDID 被读取，此后每次都被读取。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-21T02:33:31.610

我正在研究类似的问题。第一步是将所需的分辨率设置为 EDID 中的详细时序。

也就是说，而不是标准时序。如果您有 EDID 规范，请参阅第 3.10 节。根据规范，第一个详细时序将是最高优先级分辨率，其次是第二个详细时序，即标准时序，然后是已建立时序。

此外，您应该尝试不支持所有其他时间和分辨率。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-16T14:12:55.043

根据我的经验，您需要一个带有足够大胆驱动程序的图形适配器，以便您也可以*在驱动程序中*配置时序。据我所知，在 Windows 中，您目前唯一的选择是购买带有集成英特尔显卡的 PC。而且您必须注意驱动程序：对于任何高达 3x/4x 系列的 Extreme Graphics，请获取 Intel IEGD（并且您必须在安装之前滚动 IEGD 的自定义构建），或者只是库存台式机/笔记本电脑Nehalem+ 的高清显卡驱动程序。

我似乎记得也许 Nvidia 还允许您手动指定视频模式时间。

我似乎记得 Matrox 驱动程序确实允许进行一些调整，但如果没有记错的话，不要让您输入低级分辨率和时序值。

而且，说到 EDID/DDC，你最好的办法是通过切断 SDA/SCL 线（实际上只切断 SCL 也可以）来完全摆脱它，这将允许你强制驱动程序使用特定的解析度。

有许多漂亮、漂亮、低功耗的芯片组和 SoC（Geode、Vortex、Via Nano）——不幸的是，它们都不允许您在 Windows 中指定时间。因此，您必须使用耗电的 Atom 或更高版本来掌握时间:-(

请注意，任何半体面的 SVGA+ 硬件本质上完全能够在您能想到的任何像素时钟下产生几乎任何可以想象的分辨率（可能是模 8）（受合成器和 DAC 的带宽限制，现在通常为 200-400 MHz）。是 Windows 驱动程序强加了一个愚蠢的限制——它们倾向于坚持标准的典型 DMT/CVT 屏幕格式集。Linux + Xwindows 允许您在几乎任何 VGA 硬件上设置任何分辨率和时间。我曾经认为将 CRT 输出端口用作快速的三通道任意信号发生器，在 8 位分辨率下具有高达 400 MHz 的采样率，以及超过一百万个样本的缓冲空间 :-)

# ruby - ActiveRecord 的迁移器中的版本控制如何工作？

> ID：707946
> 
> 赞同：1
> 
> 时间：2009-04-02T01:14:47.180
> 
> 标签：ruby, activerecord, migration

我正在尝试通过在没有 rails gem 的情况下使用不同的包（ActiveRecord、ActiveSupport）来学习 Rails。

不过，我不知道如何创建一个包含三个类的数据库。这是我的 rakefile：

```
require 'rubygems'
require 'activerecord'   
require 'yaml'   

task :default => :migrate   

desc "Migrate the database through scripts in db/migrate. Target specific version with VERSION=x"   
task :migrate => :environment do   
  ActiveRecord::Migrator.migrate('db/migrate', ENV["VERSION"] ? ENV["VERSION"].to_i : nil )   
end   

task :environment do   
  ActiveRecord::Base.establish_connection(YAML::load(File.open('database.yml')))   
  ActiveRecord::Base.logger = Logger.new(File.open('database.log', 'a'))   
end 
```

我有三个文件：

```
001_create_appearances.rb 001_create_movies.rb 001_create_actors.rb 
```

我过去都成功运行过，每个都只是从 ActiveRecord::Migration 继承并执行 self.up/self.down。

但是，我有一个问题，当我运行 rake 时，它​​返回“多个迁移的版本号为 1”。我是否应该将所有迁移打包到一个文件中，例如 001_create_database.rb？

是否有描述这些版本如何工作的手册？

我尝试阅读 migrator.rb 的源代码，但找不到 up_without_benchmarks/down_without_benchmarks 的位置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T02:32:13.440

对。迁移必须以唯一编号开始，以便您希望它们被执行。默认情况下，在 rails 2.x 中，此数字将表示当前日期和时间。

这样做的原因是允许开发人员轻松运行和撤消迁移。如果两个开发人员同时创建新的迁移，则使用时间戳而不是顺序整数（这将导致它们在被推送到版本控制系统时具有相同的编号）。

# sql-server - 从快照创建新数据库 (SQL Server 2005)

> ID：707947
> 
> 赞同：2
> 
> 时间：2009-04-02T01:15:00.707
> 
> 标签：sql-server, sql-server-2005, backup, snapshot

我正在使用 SQL Server 2005。我创建了数据库 (RM_DB) 的快照，我想从该快照创建 (RM_DB_NEW)。当我右键单击我的快照时，我得到的唯一选项是“从此快照恢复 [RM_DB]”。

我可以从我的快照创建一个新的数据库吗？

### 编辑

我对从快照创建备份不感兴趣，这会破坏整点。我可以随时备份我的数据库，并从中恢复任何其他数据库。我对**直接从快照中完成所有操作的能力感兴趣**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T10:50:02.253

快照不是完整的数据集……它基本上只是更改的页面。没有源数据库是不完整的。

因此，您不能从快照创建数据库。

[数据库快照如何工作](http://msdn.microsoft.com/en-us/library/ms187054.aspx)

[数据库快照的限制和要求](http://msdn.microsoft.com/en-us/library/ms189940.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T01:27:46.590

创建一个新数据库，从快照还原到新数据库。您可能必须进入选项选项卡并确保选中“强制覆盖”。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-04-02T01:51:21.493

步骤 1\. 从您的快照创建一个备份（*.bk 文件）。步骤 2\. 从备份中恢复 RM_DB_NEW。

# regex - 用于大型搜索和替换的正则表达式工具

> ID：707952
> 
> 赞同：2
> 
> 时间：2009-04-02T01:17:31.543
> 
> 标签：regex

我经常发现自己需要一个工具来让我：

在大文件中搜索多个多行正则表达式模式并使用反向引用替换它们。

我是不是该：

1.  花 2 个小时来为自己构建这样一个工具
2.  使用某人已经构建的东西（请建议）
3.  学习使用特别擅长这类事情的语言（Perl？）

* * *

**示例**
我有一个包含数千个条目的 xml 文档。大约有 100 个具有已知值字段的条目需要删除。我可以为每个条目构建一个正则表达式。除值字符串部分外，100 个条目的表达式相同。该工具需要能够为每个值循环一次，或者只需要在表达式中使用 100 个 OR 项 (|) 循环一次（这将是巨大的）。在这种情况下，我将匹配项替换为空白，但在其他情况下，我将重新格式化文本并重新插入值字段。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T01:22:23.187

我认为你应该用[Python](http://www.python.org)写东西。python [re](http://docs.python.org/library/re.html)库很棒：

```
# get the re library
import re

# this is the line to process
xml_line = "<stuff><bad i_am_naughty=\"True\"></bad></stuff>"
# compile a regex 
exp = re.compile ("(.*)(<bad.*bad>)(.*)")
# run the regex on the line
match = exp.search (xml_line)
# print out the groups the regex found
print match.groups () 
```

注意 你也可以使用[python XML 解析库](http://www.diveintopython.org/xml_processing/)来去除你不想要的元素。使用 python XMl 解析简化了我在示例中忽略的一些复杂性（多行等）。代替 Python XML 解析示例，这个[问题](https://stackoverflow.com/questions/337/xml-processing-in-python)在 Python 中解析 XML 时有一些很好的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T01:39:18.497

我不太确定您的数据是什么样的，但我会考虑分三遍用 python 编写该工具：

1.  将 XML path plus variable = value 的文件转换为 XML.path.variable=value 的行
2.  对每一行应用大量正则表达式，可能从输出中删除行
3.  将 XML.path.variable=value 行的缩短列表转换回 XML

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T01:26:15.110

我建议不要使用正则表达式。XML 通常应该使用 XML 工具来处理。为什么不只使用[XSLT](http://en.wikipedia.org/wiki/XSL_Transformations)？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T12:30:31.037

有大量的模块可用于处理 xml。

[http://www.crummy.com/software/BeautifulSoup/](http://www.crummy.com/software/BeautifulSoup/) [http://codespeak.net/lxml/](http://codespeak.net/lxml/)

# c# - 如何使用 C# WinForms 在 MVP 中的视图之间导航？

> ID：707955
> 
> 赞同：7
> 
> 时间：2009-04-02T01:19:31.787
> 
> 标签：c#, winforms, design-patterns, mvp

据我了解，当我们使用 MVP 时，我们会将所有表示逻辑移至 Presenter。但是我们不想让 Presenter 知道视图的实现，那么我们如何才能导航到应用程序中的另一个屏幕呢？您如何管理实际应用程序上的应用程序流？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T08:08:09.527

使用一些导航器界面，例如：

```
interface INavigator
{
    void MoveTo (string screenName);
    void MoveTo (string screenName, NavigationParameters parameters);
} 
```

然后，每个演示者都会在构造函数中传递此导航器的实例。通过这种方式，导航与演示者和各个视图都分离。

您可以在配置中定义屏幕名称和实际表单类之间的映射。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T08:28:10.463

我假设您的意思是另一个具有自己的 MVP 对的屏幕？

我今天早上在考虑那个案例，我的解决方案可能是有一个 Coordinator 知道 Presenter 和需要打开的 MVP 对。那个会打开新的演示者+视图，完成后，可以选择在第一个演示者上调用一个方法并获得结果。

这样一来，第一个 MVP 不必知道任何关于新屏幕的信息，他们只需触发一个事件。打开第二个窗口并返回通信的逻辑完全包含在协调器中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T01:24:53.100

这是视图上的方法。因此，您将拥有一个抽象方法，例如 ShowCustomerForm()，WinForms 的实现将是 CustomerForm.Show（或 WinForms 中的任何内容），而在 WebForms 中它将是 Response.Redirct(CustomerForm.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T21:59:22.213

我们使用 Lennaert 所谓的协调器（我们称之为工作流控制器）来完成此操作。我来自 Java Web 开发，这个想法是 ApplicactionController 的一种形式。我遇到了一些问题，工作流控制器运行一个命令。每个命令代表一个工作流或一系列相关步骤（因此命名为 workflowcontroller）。flowcontroller 处理命令之间的导航，flowcontroller 具有在步骤之间导航的导航器。每个步骤都有一个完成事件（演示者被连接到该事件）和我们用来导航到下一步的 NextStep 方法。我们的 worflowcontroller 与菜单紧密耦合，因此我们可以在不同的工作流之间导航。这些步骤建立了视图和演示者之间的链接。我们不 没有任何配置，并且已经将建立下一步执行的逻辑硬连接到称为 NextStep 的方法中。它正在生产中，但我对此不太满意。太多的细节在这里进入。我考虑过转向更受事件驱动的东西。我们使用消息总线进行所有其他通信，我想转向使用它在屏幕之间导航。我不知道这是否有帮助。我们的屏幕大部分由顺序工作流程组成。我想改用它在屏幕之间导航。我不知道这是否有帮助。我们的屏幕大部分由顺序工作流程组成。我想改用它在屏幕之间导航。我不知道这是否有帮助。我们的屏幕大部分由顺序工作流程组成。

# php - 使用php放入p标签？

> ID：707974
> 
> 赞同：1
> 
> 时间：2009-04-02T01:26:55.593
> 
> 标签：php, html

我知道这对你们 php 的人来说是一个基本的问题：

我通过这样做将 p 标签放在一些 php 中：

```
echo "<p>";
echo $VM_LANG->_('PHPSHOP_COUPON_ENTER_HERE') . '<br />';
echo "</p>"; 
```

这是一种愚蠢的做法。那么如何将 p 标签放在一个“回声”中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-02T01:29:26.383

```
echo "<p>" . $VM_LANG->_('PHPSHOP_COUPON_ENTER_HERE') . '<br /></p>'; 
```

或者

```
echo "<p>" , $VM_LANG->_('PHPSHOP_COUPON_ENTER_HERE') , '<br /></p>'; 
```

后者只能通过 echo （不是打印）实现，理论上可以节省一些计算时间，因为字符串不需要连接在一起。可能不会在 99% 的时间里产生影响，但很高兴知道这一点。

第一个说

1.  附加（连接）“<p>”到 $VM_LANG->_('PHPSHOP_COUPON_ENTER_HERE')
2.  将 1 的结果附加到 '<br /></p>'
3.  回显 2 的结果

虽然后者说

1.  回显“<p>”
2.  回显 $VM_LANG->_('PHPSHOP_COUPON_ENTER_HERE')
3.  回显“<br /></p>”；

单个连接几乎总是比回声消耗更少的处理能力

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-02T01:29:39.563

您可以连接`<p>`并`</p>`一直到结尾：

```
echo '<p>'.$VM_LANG->_('PHPSHOP_COUPON_ENTER_HERE').'<br /></p>'; 
```

点 ('.') 是 PHP 的[字符串连接](http://us.php.net/language.operators.string)运算符，可用于组合多个字符串文字、变量和字符串返回函数。但是，还有另一种选择：

```
echo "<p>{$VM_LANG->_('PHPSHOP_COUPON_ENTER_HERE')}<br /></p>"; 
```

这使用[变量解析](http://us.php.net/manual/en/language.types.string.php#language.types.string.parsing)来创建所需的字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T01:31:56.250

我不认为你的方式是“愚蠢的”，使用这样的大变量名它甚至可能更具可读性。但这是我的做法：

```
echo '<p>', $VM_LANG->_('PHPSHOP_COUPON_ENTER_HERE'), '<br /></p>'; 
```

你也可以这样做：

```
echo "<p>{$VM_LANG->_('PHPSHOP_COUPON_ENTER_HERE')}<br /></p>"; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-02T01:44:08.530

还有一种方式...

```
<?
// Existing code block

// Using the <?= operator below is a short form "echo" for variables
?>

<P><?=$VM_LANG->_('PHPSHOP_COUPON_ENTER_HERE');?><BR /></P>

<?
// continue php code
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T07:40:32.027

因为之前没有人提到它，所以为了完整起见，我将添加这个（在大多数情况下我不想使用它，但在某些情况下它可能会派上用场）：

```
printf('<p>%s<br /></p>', $VM_LANG->_('PHPSHOP_COUPON_ENTER_HERE'); 
```

# java - 如何在 Struts 中重定向 NullPointerExceptions？

> ID：707978
> 
> 赞同：0
> 
> 时间：2009-04-02T01:31:00.230
> 
> 标签：java, jakarta-ee, struts

有没有办法将所有 NullPointerExceptions 重定向到可能在 Struts 中的漂亮 jsp 页面？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T01:55:06.913

有一个`struts-config.xml`配置允许您定义异常处理程序：

```
 <global-exceptions>
    <exception handler="br.com.nostrum.radiomanager.exception.RadioManagerExceptionHandler" key="exception" type="java.lang.Exception" />
  </global-exceptions> 
```

在这里，我们捕获了 java.lang.Exception 及其后代，但您可以更改为 NullPointerException。处理程序应扩展 org.apache.struts.action.ExceptionHandler 并通过 mapping.findForward （如@Kevin Crowell 所说）或您选择的其他方法转发。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T01:44:37.127

有一个请求范围的 EXCEPTION 对象将包含异常。看：

[http://struts.apache.org/1.x/struts-core/apidocs/constant-values.html](http://struts.apache.org/1.x/struts-core/apidocs/constant-values.html)

和以下键：

```
org.apache.struts.action.EXCEPTION 
```

然后有多种方法可以在 JSP 中打印出来，例如使用 Struts bean 标签：

```
<logic:equal name="org.apache.struts.action.EXCEPTION" value="java.lang.NullPointerException" scope="request">
  <bean:write property="org.apache.struts.action.EXCEPTION"/>
</logic:equal> 
```

然而，这都是 Struts 1.x。我确信 Struts 2 也有类似的方法。

# .net - 使用 TypeBuilder.CreateType 创建类型后修改类型

> ID：707980
> 
> 赞同：1
> 
> 时间：2009-04-02T01:31:58.967
> 
> 标签：.net, reflection

我正在运行时在动态程序集中创建一个动态类，并希望能够按需为该类定义方法。

前任。

1.  建造 X 型
2.  在类型 X 上定义方法 GetA
3.  创建类型 X
4.  调用 GetA
5.  对 X 型使用相同的类型生成器
6.  在类型 X 上定义新方法 GetB
7.  重新创建类型 X，它现在同时具有 GetA 和 GetB

如果这是不可能的，那么我将不得不根据需要为其中一种方法构建类型，并且要做到这一点，我还必须每次都创建程序集。

任何想法，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T10:47:09.130

您不能创建“完整”方法（可通过反射发现） - 但是，您可以使用`DynamicMethod`将新的 IL 块与类型相关联（主要用于范围等）。但最终，您所描述的是 4.0 中 DLR 的工作（以及诸如 Iron Python 之类的语言；C# 和 VB 不添加对*声明*动态方法的语言支持 - 仅使用它们）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T01:35:37.710

也许您应该使用[CodeDom](http://msdn.microsoft.com/en-us/library/y2k85ax6.aspx)创建类型。您可以构建整个类型，编译代码，然后加载新程序集并使用该类型。

# linux - 当我从 Perl 调用它时，为什么我的 awk 单行代码不起作用？

> ID：707981
> 
> 赞同：4
> 
> 时间：2009-04-02T01:32:12.960
> 
> 标签：linux, perl, unix, awk, qsub

使用AWK的以下命令作为独立命令我没有任何问题，没有任何错误：

```
$ awk '$9 != "NTM" && $9 != ""' myfile.txt  | less -Sn 
```

但是当我在 Perl 的[qsub](http://www.doesciencegrid.org/public/pbs/qsub.html)脚本中应用它们（即在 linux 集群中运行作业）命令时，如下所示：

```
use strict;
use Data::Dumper;
use Carp;
use File::Basename;

my $path = "/mypath/"; 
my @files = glob($path."*.txt");

foreach my $file ( @files ) {
print "$file\n";
    wy $base = basename($file,".fc-gn_".$type);
    my $nn = $path.$base.".out";

print "$file $nn\n";

    open PIPE, "| qsub" or die $!; 
    print PIPE <<EOF;
#!/bin/sh 
#PBS -N CLEAN
#PBS -l nodes=1:ppn=2 
#PBS -r n 

awk '$9 != "NTM" && $9 !=""' $file > $nn

EOF

} 
```

它给出了以下错误

```
awk: cmd. line:1:  != "NTM" &&  !=""
awk: cmd. line:1:  ^ syntax error 
```

正确的方法是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-02T01:39:05.500

在所有变量之前放置一个`"\"`字符将修复它。`"$9"`Perl 本身正在解析它们。

以下脚本：

```
print <<EOF;
awk '$9 != "NTM" && $9 !=""' $file > $nn
EOF 
```

输出：

```
awk ' != "NTM" &&  !=""'  > 
```

但：

```
print <<EOF;
awk '\$9 != "NTM" && \$9 !=""' \$file > \$nn
EOF 
```

输出：

```
awk '$9 != "NTM" && $9 !=""' $file > $nn 
```

但是，由于您希望`$file`并被`$nn`Perl 解释，因此实际的行应该是：

```
awk '\$9 != "NTM" && \$9 !=""' $file > $nn 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T01:56:32.977

您可以使用反斜杠解决方案，或者使用以下方法使其更具视觉吸引力：

`print <<'EOF'`

（并且没有反斜杠），如果你喜欢 Perl，你可能想[试试 gearman](http://www.danga.com/gearman/)，这真的很酷。

# math - 计算垂直于由点和真北航向描述的平面的 3d 矢量

> ID：707985
> 
> 赞同：4
> 
> 时间：2009-04-02T01:36:15.460
> 
> 标签：math, 3d, vector, geometry, geolocation

我在地球表面有一个点，我将其转换为地球中心的向量。

我有一个以度数为单位的真北航向，描述了该点在地球表面上的行进路径。

我需要计算一个向量，该向量垂直于该点沿地球表面的路径创建的平面。

[我尝试使用此处](http://www.codeguru.com/Cpp/Cpp/algorithms/general/article.php/c5115/)描述的方法计算路径上的任意点 ，然后取两个向量的叉积，但是它似乎不够准确，而且开销似乎比必要的要多。

这与我的另一篇文章[ray-polygon-intersection-point-on-the-surface-of-a-sphere 有关](https://stackoverflow.com/questions/628335/ray-polygon-intersection-point-on-the-surface-of-a-sphere)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-02T02:27:12.110

我假设您正在尝试计算一个位于路径*平面*中的向量，而不是垂直于它（因为您已经有了一个向量 - 即从原点到您的点的向量）。

您首先需要计算位于该平面上的向量，该向量指向正北和正东。为此，我们将`P`您的点`O`称为原点，并且`N = (0, 0, R)`是球体顶部的点。然后

```
e = cross(N - P, P - O) 
```

是指向正东的向量，并且与球体相切，因为它垂直于`P - O`球体的半径。

出于类似的原因

```
n = cross(e, P - O) 
```

将指向正北，并将与球体相切。

现在归一化`n`和`e`，你就得到了切线空间的*正交基。*要找到一个方向上的向量`theta`（例如，从正东轴逆时针方向，以简化数学运算），只需取一点`e`和一点`n`：

```
v = cos(theta) * e + sin(theta) * n 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T02:33:22.937

以下是我对您的问题的理解：

*   您在地球表面上有一个点，指定为纬度/经度坐标
*   “真北”方向是该点的人将通过最直接的可能路线到达（地理）北极的方向。也就是说，“真北矢量”在您选择的点与地球表面相切，并直接指向北方，平行于经线。
*   该点的运动方向将（最初）在您选择的点与地球表面相切。
*   您与真北有一个以度数为单位的角度，它指定了该点将要移动的航向。
*   这个角度是“真北向量”和点的运动方向之间的角度。
*   您想要计算在该点与地球表面相切但垂直于该点运动方向的向量。

如果我理解正确，您可以按以下方式进行：

1.  纬度`lat`，经度的“真北向量”`lng`由下式给出

    ```
    [-sin(lat) * cos(lng), -sin(lat) * sin(lng), cos(lat)]
    ```

2.  垂直于“真北向量”的向量，该向量沿纬度线（向东）指向，由下式给出

    ```
    [-sin(lng), cos(lng), 0]
    ```

3.  由于这两个向量标识与地球表面相切的平面，并且指定点运动方向的向量也在该平面内，因此您的运动向量是前两个的线性组合：

    ```
    [
    -(sin(lat) * cos(lng) * cos(th) + sin(lng) * sin(th))
    -(sin(lat) * sin(lng) * cos(th) - cos(lng) * sin(th))
    cos(lat) * cos(th)
    ]
    ```

    `th`你的航向角在哪里。
4.  要找到垂直于该运动矢量的矢量，您只需取半径矢量的叉积（即从地球中心指向您的点的矢量，

    ```
    [cos(lat) * cos(lng), cos(lat) * sin(lng), sin(lat)]
    ```

    与运动矢量。（那个数学会很乱，最好让电脑处理）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T05:06:18.887

您已经有 2 个向量：

N = (0,0,1) 点从原点直接向上。

P = (a,b,c) 从原点到您的点。

计算到你的点的单位向量 U = P/|P|

计算垂直于 U 和 N 的单位向量 E = UXN

计算垂直于 U 和 E 的单位向量（这将与球体相切） T = UXE T 可能指向北或南，因此如果 Tz < 0，则将 T 乘以 -1。

T 现在指向正北，并且平行于在 P 处与球体相切的平面。

[您现在有足够的信息来构造一个旋转矩阵 (R)，因此您可以围绕 U 旋转 T。您可以在wikipedia](http://en.wikipedia.org/wiki/Rotation_matrix#Axis_of_a_rotation)上找到如何制作一个围绕任何轴旋转的矩阵：

使用 R，您可以计算指向行进方向的矢量。

A = RT

A 是您正在寻找的答案。

# java - 通过网络进行 Java 序列化

> ID：707987
> 
> 赞同：9
> 
> 时间：2009-04-02T01:37:51.433
> 
> 标签：java, serialization, network-programming

只是想知道是否有用于序列化对象的教程或操作方法，将它们放入网络流中，并在另一端反序列化它。我了解序列化、I/O、流、套接字等的原理，我只想从客户端向服务器发送对象的示例开始。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-02T07:48:03.990

[这个](http://www.cs.mcgill.ca/~adenau/teaching/cs303/lecture12.pdf)(pdf) 是一个有用的教程，它将引导您了解序列化和套接字的基础知识，然后将这两个概念联系在一起（大约在幻灯片的一半）以展示如何序列化对象并将其从客户端发送到服务器（没有 RMI ）。我认为这正是你想要的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-02T01:47:59.660

其实很简单。只需使您的对象可序列化，并创建一个连接到您拥有的任何底层流的 ObjectOutputStream 和 ObjectInputStream，例如 FileInputStream 等。然后只需将您想要的任何对象写入流并在另一端读取它。

这是给你的一个[例子](http://www.java2s.com/Tutorial/Java/0180__File/ReadingBasicDataFromanObjectStream.htm)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-02T01:55:33.463

Java 使用[ObjectOutputStream](http://java.sun.com/j2se/1.4.2/docs/api/java/io/ObjectOutputStream.html)（和[ObjectInputStream](http://java.sun.com/j2se/1.4.2/docs/api/java/io/ObjectInputStream.html)）提供（二进制）对象序列化。您可以只将 writeObject() 写入流中，然后将 readObject() 放在另一端。为此，您需要做的就是实现 Serializable 接口。

但是，您可能有兴趣将其提升一级并使用[Remote Method Invocation](http://java.sun.com/docs/books/tutorial/rmi/index.html) ，而不是手动执行此操作。使用 RMI，您可以在另一个 JVM 中的对象上调用方法，所有的序列化和网络都在后台进行。

而且为了完整起见，如果不能使用二进制格式，还有[XML bean 序列化。](http://java.sun.com/products/jfc/tsc/articles/persistence4/)这种 XML 格式非常通用（阅读：冗长和丑陋），但是有一些流行的库（如[XStream](http://xstream.codehaus.org/)）可以创建替代的 XML 序列化。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-09-02T10:24:35.937

您可以使用 java api 创建对象流并发送任何可序列化的对象。但你必须记住，这些通过网络是未加密的：

在发件人方面：

```
CustomObject objectToSend=new CustomObject();
Socket s = new Socket("yourhostname", 1234);
ObjectOutputStream out = new ObjectOutputStream(s.getOutputStream());
out.writeObject(objectToSend);
out.flush(); 
```

在接收端：

```
ServerSocket server = new ServerSocket(1234);
Socket s = server.accept();
ObjectInputStream in = new ObjectInputStream(s.getInputStream());
CustomObject objectReceived = (CustomObject) in.readObject(); 
```

# android - Android：如何将变量值存储到注册表？

> ID：707993
> 
> 赞同：6
> 
> 时间：2009-04-02T01:42:38.223
> 
> 标签：android, variables, registry

我正在创建一个需要登录并允许用户配置一些设置的应用程序。

但是我想让用户存储首选设置、用户名和密码。

有谁知道如何从注册表存储和检索值？另一种可能性是使用 SQL Lite 数据库，但如果可能的话，我更愿意将值存储到注册表中。

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-02T04:31:28.287

“首选项是一种轻量级机制，用于存储和检索原始数据类型的键值对” [http://developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)

# asp.net-mvc - MVC 最佳实践 | 您是否将链接构建到 Url Helper 中？

> ID：707998
> 
> 赞同：1
> 
> 时间：2009-04-02T01:44:42.943
> 
> 标签：asp.net-mvc

只需阅读[有关 MVC 最佳实践的帖子](http://weblogs.asp.net/rashid/archive/2009/04/01/asp-net-mvc-best-practices-part-1.aspx)。文章的几个部分描述了构建辅助方法以链接到控制器上的操作。这是一个剪辑：

> 1) 创建 UrlHelper 的扩展方法以从 Route 生成您的 url
> 
> 避免将控制器、动作或路由名称作为字符串传递，创建封装它的 UrlHelper 的扩展方法，例如：
> 
> ```
> public static class UrlHelperExtension
> {
>     public static string Home(this UrlHelper helper)
>     {
>         return helper.Content("~/");
>     }
> 
>     public static string SignUp(this UrlHelper helper)
>     {
>         return helper.RouteUrl("Signup");
>     } 
> } 
> ```

我可以看到这将如何缩短视图中使用的链接......但我不明白这是一个“最佳实践”。也许我只是忽略了一些东西。我应该这样做来建立我的链接吗？我只是没有看到这有什么好处吗？

他甚至继续说应该制作样式表、图像和 javascript 助手......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T02:55:16.940

除非在多个地方引用了该路线，否则我可能不会这样做。我可以看到这样做的价值，并且我已经实现了 HtmlHelper 扩展以添加样式表和 javascript 包括以添加使用“版本化”链接的能力，但我的常用链接作为 ActionLinks 包含在 UserControl（菜单）中，并且对于大多数其他我使用 ActionLink 或 BeginForm/AjaxForm 来引用动作。在某些方面，感觉就像为除最常重用的链接之外的所有链接创建新方法一样，只会以很少的价值增加复杂性——您可以从一些简单的 UI 手动测试中获得这种价值，而您必须这样做反正。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T02:32:22.020

如果在将 URL 写入字符串时出错，直到运行时才会被捕获。这样，尝试将尚未创建为扩展方法的路由引用将在编译时产生错误，您可以快速更正（甚至更早，如果您使用 Visual Studio）。如果您在制定路线的方式中发现错误，您只需在一个地方进行修复。

虽然，与其用扩展方法使 UrlHelpers 混乱，不如拥有一个名为 CommonUrls 之类的静态类，它包含静态只读属性（或静态方法，如果您愿意）。

编辑：我刚刚意识到您需要将 UrlHelper 的实例传递给 CommonUrls 类。傻我。在这种情况下，扩展方法可能是完成这项工作的正确工具。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T05:38:23.273

这是一个人对最佳实践的看法。在某些情况下它可能会很好。如果在 URL 结构仍在制定中时有人使用视图，则一旦 URL 最终确定，您就不必更新视图。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-22T17:42:05.987

如果其他人碰巧偶然发现了这篇旧文章，我建议使用 David Ebbo 的 T4MVC 模板：[在此处查看他的最新博客文章](http://blogs.msdn.com/davidebb/archive/2009/07/28/t4mvc-2-4-updates-settings-file-sub-view-folders-actionname-support-and-more.aspx)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T10:22:53.667

我不认为这是最佳实践。一方面，您正在将结构细节隐藏在一堆扩展方法中。（虽然你可以为路径使用资源，但这意味着高摩擦的变化。）

此外，你在什么时候停下来？对于任何复杂的网站，您都将需要大量这些帮助程序。

在引用样式表、javascript、网站图标等时，我使用了一种类似的方法。尽管我使用 HtmlHelper 而不是 UrlHelper 扩展，因为从概念上讲，我认为它们更适合该任务。

此外，由于此类内容通常仅添加到母版页，因此只需将完整路径传递给帮助程序并让它构造一个完整的标记 - 而不仅仅是解析 URI 就没有问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-02-25T15:48:46.093

我正在使用这种方法。当您的应用程序站点地图发生变化时，它非常有用。是的，你需要很多（我的扩展类有 1800 行，带有注释）

就我而言，主要区别在于，我使用强类型构建器构建 URL。它看起来像这样：

```
 /// <summary>
    /// To campaign 'transfer credits' page
    /// </summary>
    public static string ToCampaignTransferCredits(this UrlHelper helper, int? idCampaignSource)
    {
        return To<CampaignController>(helper, c => c.Transfer(idCampaignSource));
    } 
```

由于某些原因，我认为这是一个非常好的做法（恕我直言）：

*   您在导航可用页面/操作和您的控制器之间有一个明确的**分离。**我最近不得不将方法从一个控制器移动到另一个控制器，并且它在没有痛苦/重构/测试的情况下工作。
*   它已**编译**，因此如果您更改控制器的方法签名，您就会知道要做的更改（并且您只有 1 或 2 个更改，无需检查整个应用程序）
*   您可以像 OOP 极客一样在控制器上使用继承和泛型，级联调用以及任何您认为强大的方法，这种方法将**隐藏**所有底层**复杂性**，将简单调用留在视图中。

# python - 调试正在运行的 python 进程

> ID：707999
> 
> 赞同：17
> 
> 时间：2009-04-02T01:45:03.257
> 
> 标签：python, remote-debugging

有没有办法查看各种线程在 python 进程中所做的事情的堆栈跟踪？

假设我有一个线程，它允许我对进程进行某种远程访问。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-02T03:44:35.357

[Winpdb](http://winpdb.org/)是一个**独立于平台**的图形化 GPL Python 调试器，支持网络远程调试、多线程、命名空间修改、嵌入式调试、加密通信，比 pdb 快 20 倍。

特征：

*   GPL 许可证。Winpdb 是免费软件。
*   与 CPython 2.3 到 2.6 和 Python 3000 兼容
*   与 wxPython 2.6 到 2.8 兼容
*   独立于平台，并在 Ubuntu Gutsy 和 Windows XP 上测试。
*   用户界面：rpdb2 是基于控制台的，而 winpdb 需要 wxPython 2.6 或更高版本。

[![截屏](https://i.stack.imgur.com/ORL1T.jpg)](https://i.stack.imgur.com/ORL1T.jpg)
[（来源：[winpdb.org](http://winpdb.org/images/screenshot_winpdb_small.jpg)）]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T02:04:49.400

大约 4 年前，当我使用扭曲时，沙井是完成您所要求的工作的好方法。

[http://twistedmatrix.com/projects/core/documentation/howto/telnet.html](http://twistedmatrix.com/projects/core/documentation/howto/telnet.html)

现在我的大部分项目都没有使用twisted，所以我只使用了WingIDE的远程调试钩子来内省一个正在运行的进程。

[http://www.wingware.com/doc/debug/remote-debugging](http://www.wingware.com/doc/debug/remote-debugging)``***