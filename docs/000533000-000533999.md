# StackOverflow 问答 000533000-000533999

# .net - 在silverlight中禁用右键单击

> ID：533005
> 
> 赞同：8
> 
> 时间：2009-02-10T16:20:07.533
> 
> 标签：.net, silverlight

我们在信息亭类型的场景中使用 Silverlight。有没有办法禁用右键单击进入silverlight配置对话框的能力？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T16:35:07.187

//在 SharePoint 中，我添加了一个小代码来告诉 SP 在加载每个部分后运行脚本。奇迹般有效 ：）

// 编辑

或者更好的是 silverlight 论坛建议您这样做： [Silverlight 论坛](http://silverlight.net/forums/p/37820/109804.aspx)

```
<div id="silverlightObjDiv">
    <!-- silverlight object here -->
</div>

<script>
_spBodyOnLoadFunctionNames.push ('setupElement');

function setupElement ()

{

document.getElementById('silverlightObjDiv').oncontextmenu =      disableRightClick;

}

function disableRightClick(e) {
if (!e) e = window.event;
if (e.preventDefault) {
    e.preventDefault();
} else {
    e.returnValue = false;
}
}
</script> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-08-10T10:37:13.923

正如 Dain 提到的，在 Silverlight 4 中，您可以轻松地做到这一点：

**使控件无窗口：**

```
<param name="windowless" value="true" /> 
```

**在您的根网格/布局控件中单击右键：**

```
public MainPage()
{
    LayoutRoot.MouseRightButtonDown += (s, e) => { e.Handled = true; };
} 
```

**在Firefox**
和 Chrome 中，您必须在具有上下文菜单*或*具有鼠标滚轮滚动功能之间进行选择。遗憾的是你不能同时拥有两者，希望这会在 Silverlight 5 中改变。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-10T10:30:12.053

在 Silverlight 4 中，您可以在 C# 中执行此操作，而无需摆弄和依赖任何 HTML。

下面的示例显示了如何实现控件实际使用的右键单击，但如果您只想禁用，则可以创建一个 clicktrap。

```
 public partial class MainPage : UserControl
 {
      public MainPage()
      {
          InitializeComponent();

          // wire up the event handlers for the event on a particular UIElement
          ChangingRectangle.MouseRightButtonDown += new MouseButtonEventHandler(RectangleContextDown);
          ChangingRectangle.MouseRightButtonUp += new MouseButtonEventHandler(RectangleContextUp);
      }

     void RectangleContextUp(object sender, MouseButtonEventArgs e)
     {
         // create custom context menu control and show it.
         ColorChangeContextMenu contextMenu = new ColorChangeContextMenu(ChangingRectangle);
         contextMenu.Show(e.GetPosition(LayoutRoot));
     }

     void RectangleContextDown(object sender, MouseButtonEventArgs e)
     {
         // handle the event so the default context menu is hidden
         e.Handled = true;
     }
 } 
```

参考：[http ://timheuer.com/blog/archive/2009/11/18/whats-new-in-silverlight-4-complete-guide-new-features.aspx#rightclick](http://timheuer.com/blog/archive/2009/11/18/whats-new-in-silverlight-4-complete-guide-new-features.aspx#rightclick)

# debugging - 如何从 Microsoft 脚本编辑器中运行 .vbs 文件？

> ID：533007
> 
> 赞同：1
> 
> 时间：2009-02-10T16:20:27.457
> 
> 标签：debugging, vbscript, scripting, editor

是否可以打开 Microsoft 脚本编辑器，然后从编辑器中打开一个 .vbs (VBScript) 文件，然后运行/调试它？

我知道我可以使用命令行 cscript (filename) //X 来启动文件，允许我选择 Microsoft Script Editor 作为调试器，但我想在 Microsoft Script Editor 中执行所有操作。

我知道许多免费软件和商业编辑器或多或少会以或多或少的集成方式做我想做的事，但这个问题是关于微软脚本编辑器的。

Microsoft 脚本编辑器作为独立应用程序是否仅对编辑/调试网页中的脚本有用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T17:05:32.167

您的脚本必须是网页的一部分。如果 MS 脚本编辑器名副其实，那就太好了，但事实并非如此。您可以制作一个简单的 HTML 页面来包含您的 vbs 文件，并在脚本编辑器中使用它来启动您的脚本。该页面可以像这样简单：

```
<script language="vbscript" src="file:///C:\myscript.vbs">
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T07:37:57.363

您可以直接从“wiev/Open with”菜单运行它。从列表中选择“wscript”，然后按“打开”按钮。

您可以编辑和调试没有 html 文件的独立脚本，但不能创建它。如果选择“文件/新建”菜单，则只能创建 html 和文本文件。选择文本文件，并以“.vbs”扩展名保存。关闭并重新打开它（如果您设置其他默认值，请使用“打开方式 - HTML/XML 编辑器”），然后使用智能感知。

# ruby - Ruby 中这些块编码风格的区别或价值是什么？

> ID：533008
> 
> 赞同：33
> 
> 时间：2009-02-10T16:21:07.533
> 
> 标签：ruby, coding-style

哪种风格更受欢迎？一个与另一个有充分的理由吗？

提前致谢！

```
1) cmds.each do |cmd|
   end

2) cmds.each { |cmd|
   } 
```

示例代码：

```
cmds = [ "create", "update", "list", "help" ]

# Block style one
#
cmds.each do |cmd|
  puts "loop1, cmd: #{cmd}"
end

# Block style two
#
cmds.each { |cmd|
  puts "loop2, cmd: #{cmd}"
} 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-10T16:25:02.560

rails 团队和许多其他 ruby​​ 专家[更喜欢](http://wiki.rubyonrails.org/rails/pages/CodingStandards)将花括号用于单行块和`do...end`多行块。

两者之间唯一的功能区别是`do...end`块的优先级低于块的优先级`{...}`。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-10T17:09:45.933

根据[“Pickaxe”书](http://www.pragprog.com/titles/ruby/programming-ruby)（我在这里看第二版），戈登是正确的：唯一的区别是优先级：

p.356（我的斜体）：

> 大括号优先级高；`do` 优先级较低。如果方法调用具有未包含在括号中的参数，则*块的大括号形式将绑定到最后一个参数，而不是整个调用*。`do`表单将绑定*到调用*。

有关示例，另请参见第 168 页。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-10T16:28:30.090

这两种形式是等价的。

推荐的样式是单行块使用大括号，多行块使用“do”-“end”。

**编辑：** [Austin Ziegler](https://stackoverflow.com/users/36378/austin-ziegler/)指出（在下面的评论中）这两种形式具有不同的优先级：花括号具有更高的优先级。因此，当调用不带括号的方法时，包含在 {} 中的块将绑定到最后一个参数而不是调用方法。

以下示例由 Austin 建议：

```
def foo
    yield
end

puts foo { "hello" }

puts foo do
    "hello"
end 
```

第一个“puts”打印“hello”：调用 foo 返回“hello”，这是 puts 的参数。

第二个保释错误：

```
in `foo': no block given 
```

因为在这种情况下 do-end 块绑定到 puts 方法。

再次感谢奥斯汀解决这个问题。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-10T16:57:18.443

Gordon 的回答是“Ruby 方式”，尽管将一行放在大括号中是一种常见的做法，但这不是必需的。

还要注意可以轻松地对结果值进行操作：

```
cmds.each do |cmd| cmd.upcase! end.sort

# Now, cmds = ["CREATE", "HELP", "LIST", "UPDATE"] 
```

尽管您可能已经看到`{}`这里的可读性更高，因此如果其他人要查看您的代码，则首选：

```
cmds.each { |cmd| cmd.upcase! }.sort 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-10T16:31:49.317

大多数情况下，样式 1 用于多行块，样式 2 用于单行。

该`do…end`语法与其他 Ruby 控制结构（if、def、class）非常相似，因此将其用于块可以使代码的外观保持一致和清晰。但它不适用于单行，这就是为什么括号版本在那里更受欢迎的原因。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-07-23T21:31:23.873

传统上，使用`{}`是为单行块保留的，而`do...end`为多行块保留。

由于`{}`在 Ruby 中的使用不像在 C++ 或 Javascript 等其他语言中那样频繁，`do...end`因此在有机会时使用而不是`{}`可以帮助您的代码对其他 Ruby 主义者更具可读性。

请注意，`{}`优先于`do...end`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T16:27:22.930

我认为这并不重要——这只是个人审美选择。有些人喜欢`do...end`在块需要多行时使用版本，而在一行中使用`{...}`版本。

# mysql - has_many 关系的finder_sql

> ID：533014
> 
> 赞同：1
> 
> 时间：2009-02-10T16:22:03.910
> 
> 标签：mysql, ruby-on-rails, ruby, activerecord

给定以下两个（简化的）模型：

```
class Customer < ActiveRecord::Base
  # finder sql to include global users in the association
  has_many :users, :dependent => :destroy,
  :finder_sql => 'SELECT `u`.* FROM `users` `u`
  WHERE (`u`.`customer_id` = "#{id}" OR `u`.`customer_id` IS NULL)'

  validates_presence_of :name
end

class User < ActiveRecord::Base
  # most users belong to a customer.
  # however, the customer_id may be NULL
  # to implement the concept of "global" users.
  belongs_to :customer
  validates_presence_of :email
end 
```

起初，这似乎工作得很好：

```
>> Customer.first.users # => Array of users including global users 
```

但是当我尝试跟随我得到一个mysql错误：

```
>> Customer.first.users.find_by_email("test@example.com")
ActiveRecord::StatementInvalid: Mysql::Error: Operand should contain 1 column(s): 
SELECT * FROM `users` 
WHERE (`users`.`email` = 'test@example.com') AND 
(
  SELECT `u`.* FROM `users` `u` 
  WHERE (`u`.`customer_id` = "1" OR `u`.`customer_id` IS NULL) 
  ORDER BY u.nickname
) LIMIT 1
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/connection_adapters/abstract_adapter.rb:188:in `log'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/connection_adapters/mysql_adapter.rb:309:in `execute'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/connection_adapters/mysql_adapter.rb:563:in `select'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/connection_adapters/abstract/database_statements.rb:7:in `select_all_without_query_cache'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/connection_adapters/abstract/query_cache.rb:62:in `select_all'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/base.rb:635:in `find_by_sql'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/base.rb:1490:in `find_every'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/base.rb:1452:in `find_initial'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/base.rb:587:in `find'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/base.rb:1812:in `find_by_email'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/base.rb:1800:in `send'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/base.rb:1800:in `method_missing'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_collection.rb:370:in `send'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_collection.rb:370:in `method_missing'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/base.rb:2003:in `with_scope'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_proxy.rb:202:in `send'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_proxy.rb:202:in `with_scope'
from /Library/Ruby/Gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_collection.rb:366:in `method_missing' 
```

因此，Rails 正在生成一个无效的 SQL 语句。原因可能是我的 finder_sql，因为没有 finder_sql 的关联按预期工作。

我已经尝试删除所有可选插件（will_paginate）。我想要实现的事情实际上很简单：`(users.customer_id = 1 OR users.customer_id IS NULL)`在我的关联中包含与以下条件匹配的所有用户模型。

感谢任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T16:48:09.900

如果您实际上有一个特殊的“全球”客户，您可能会发现它更容易，因此您不需要处理 NULL 的尴尬。

这是使用[空对象模式](http://en.wikipedia.org/wiki/Null_Object_pattern)的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T16:32:59.907

这些中的任何一个都应该工作

```
User.find(:all, :conditions => ['customer_id = ? OR customer_id IS NULL', Customer.first[:id]]) 
```

或者

```
Customer.first.users.select{|user| user.email == "test@example.com"} 
```

# sql-server - 删除选择中的死锁

> ID：533021
> 
> 赞同：3
> 
> 时间：2009-02-10T16:23:06.390
> 
> 标签：sql-server, deadlock

以下 SQL 语句偶尔会在我的 mssqlserver 2000 服务器中产生死锁

```
delete from tb_intervaloServico 
where idFeriado in (
    select ints.idIntervalo 
    from tb_periodicidadeServico ps, tb_intervaloServico ints 
    where ints.idPeriodicidadeServico=ps.idPeriodicidadeServico
    and idservicoContrato='7f20b4af-9076-48f9-a861-8b78273eadc3'
    and fromFixa=0) 
```

出于某种原因，删除获得了阻塞状态并且没有完成（？）我发现被此阻塞的唯一其他进程是在周末运行以重新创建索引的维护计划，所以我不知道有什么可以正在产生问题。

这是删除生成的锁...

```
Object                  Lock Type Mode Status Owner
tb_intervaloServico     TAB       IX   GRANT  Xact
tb_periodicidadeServico TAB       IS   GRANT  Xact 
```

有人对如何找到问题的根源有任何指示吗？我怀疑表 tb_intervaloServico 是阻塞的根，因为它在删除和选择中被调用，但我无法重现该行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T18:50:10.467

看起来您的查询是自锁的。您可能想阅读有关此问题的[新闻组主题](http://www.sqlnewsgroups.net/group/microsoft.public.sqlserver.server/topic1883.aspx)（特别是 Santeri Voutilainen 的帖子）。

这可能是 SP4 的问题。您可以尝试通过减少用于查询执行的处理器数量来降低查询并行度。为此，您可以使用查询提示 OPTION (MAXDOP n)，其中 n 是并行线程数。设置 n = 0 意味着使用所有可用的处理器。

或者，您也可以全局设置该选项：在 Enterprise Manager 中的“Properties - Processor - Parallelism”下，单击“Use”旁边的单选按钮并选择 1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T10:24:05.213

您需要在数据库上启用一些跟踪标志，以便在日志中获得解释死锁链的打印输出。

尝试使用跟踪标志 1204、1205 和 1206 启动 SQL Server。然后发布死锁链。

您可以尝试升级 sql 中的锁，这可能会修复它，但如果没有链打印输出，则无法判断

所以也许这会有所帮助：

```
delete from tb_intervaloServico 
where idFeriado in (
    select ints.idIntervalo 
    from tb_periodicidadeServico ps, tb_intervaloServico ints 
    with (updlock,serializable)
    where ints.idPeriodicidadeServico=ps.idPeriodicidadeServico
    and idservicoContrato='7f20b4af-9076-48f9-a861-8b78273eadc3'
    and fromFixa=0) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T10:42:00.117

尝试将您的查询更改为：

```
delete tis
from 
    tb_intervaloServico tis
where tis.idFeriado in (
    select ints.idIntervalo 
    from tb_periodicidadeServico ps, tb_intervaloServico ints 
    where ints.idPeriodicidadeServico=ps.idPeriodicidadeServico
    and idservicoContrato='7f20b4af-9076-48f9-a861-8b78273eadc3'
    and fromFixa=0) 
```

或许：

```
delete tis
from 
    tb_intervaloServico tis
    inner join tb_intervaloServico ints
        on tis.idFeriado = ints.idIntervalo
    inner join tb_periodicidadeServico ps
        on ints.idPeriodicidadeServico = ps.idPeriodicidadeServico
        and idservicoContrato='7f20b4af-9076-48f9-a861-8b78273eadc3' -- add the correct table prefix for idservicoContrato
        and fromFixa = 0 -- add the correct table prefix for fromFixa 
```

**您可以在删除之前使用select ***而不是**delete**测试这些查询

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T17:22:18.477

以下文章将指导您了解如何解决 SQL Server 2000 中的死锁。

[http://msdn.microsoft.com/en-us/library/aa937573(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa937573(SQL.80).aspx)

如果您需要具体帮助，请告诉我。

干杯，约翰

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T19:56:40.027

您从加入的表中删除，tb_intervaloServico。将子查询转储到临时表中，并在删除中使用临时表。

```
select ints.idIntervalo into #deleteMeId
from tb_periodicidadeServico ps, tb_intervaloServico ints 
where ints.idPeriodicidadeServico=ps.idPeriodicidadeServico
and idservicoContrato='7f20b4af-9076-48f9-a861-8b78273eadc3'
and fromFixa=0)

delete from tb_intervaloServico 
where idFeriado in (
select * from #deleteMeId
) 
```

# css - 在 IE7 中滚动后，div 边框不会重新绘制

> ID：533028
> 
> 赞同：2
> 
> 时间：2009-02-10T16:24:56.633
> 
> 标签：css, html

仅在 IE7 中存在一个问题，即滚动后不重新绘制 div 的边框。如果滚动后不在窗口中，则再次显示为白色。

这是我正在谈论的一个例子：

[http://imagebin.antiyes.com/467](http://imagebin.antiyes.com/467)

我已经`border: 10px`使它脱颖而出，它应该始终是坚实的。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T16:31:12.267

听起来像躲猫猫的虫子。尝试在盒子类上设置“缩放：100%”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T16:43:43.843

有一些关于 peekaboo 错误的好文章。如果可以的话，值得花时间了解常见原因，因为这样可以更容易地在未来避免它:)

有用的信息：[http ://www.positioniseverything.net/explorer/peekaboo.html](http://www.positioniseverything.net/explorer/peekaboo.html)

# sql - 向共享数据库服务器上的大表添加主键

> ID：533034
> 
> 赞同：1
> 
> 时间：2009-02-10T16:26:23.823
> 
> 标签：sql, ssms

我有一个用于邻近搜索的大型邮政编码数据库。大约有 100 万条记录。不知何故，我没有将主键添加到表中，现在我必须添加它，因为由于全表扫描，搜索大约需要 3 秒。当我去生成一个脚本将它添加到 SSMS 中时，操作超时，因为它正在创建一个新表并且很重要数据。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T16:45:57.567

确保 SSMS 选项/查询执行中的执行超时设置为 0（无超时）。然后使用类似于以下的查询，将表/列/键名替换为您的。根据需要调整参数。

```
ALTER TABLE tableName WITH NOCHECK 
ADD CONSTRAINT PK_tableName PRIMARY KEY CLUSTERED (columnName)
WITH (FILLFACTOR = 75, ONLINE = ON, PAD_INDEX = ON) 
```

[参考](http://msdn.microsoft.com/en-us/library/ms190273.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T16:28:47.920

生成脚本并将其粘贴到查询中并在那里运行。确保您的 SSMS 未在选项中设置为执行超时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T17:54:05.157

为什么不只创建一个唯一索引？

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-02-10T16:30:43.657

ALTER TABLE 添加主键（等...）

应该在 MySQL 中工作。

# algorithm - 分析、分类和索引元数据

> ID：533036
> 
> 赞同：1
> 
> 时间：2009-02-10T16:27:16.487
> 
> 标签：algorithm, text, metadata, bayesian

我有一个大型（约 250 万条记录）图像元数据数据库。每条记录代表一个图像，并具有唯一的 ID、描述字段、以逗号分隔的关键字列表（例如每张图像 20-30 个关键字）和一些其他字段。没有真正的数据库模式，如果不遍历每个图像并计算它们，我无法知道数据库中存在哪些关键字。此外，元数据来自几个不同的供应商，每个供应商对如何填写不同的字段都有自己的想法。

我想用这个元数据做一些事情，但由于我对这种算法完全陌生，我什至不知道从哪里开始寻找。

1.  其中一些图像对它们有一定的使用限制（以文字形式给出），但每个供应商的措辞不同，无法保证一致性。我想进行一个简单的测试，我可以将其应用于图像，以指示该图像是否不受限制。它不必是完美的，只要“足够好”。我怀疑我可以为此使用某种贝叶斯过滤器，对吧？我可以用我知道是受限制或不受限制的图像语料库训练过滤器，然后过滤器就能够对其余图像进行预测？还是有更好的方法？
2.  我还希望能够根据“关键字相似度”对这些图像进行索引，这样如果我有一张图像，我就可以快速判断它与哪些其他图像共享最多的关键字。理想情况下，该算法还将考虑到某些关键字比其他关键字更重要，并对它们进行不同的权衡。我什至不知道从哪里开始看这里，如果有任何指示，我会很高兴:)

我主要在 Java 中工作，但语言选择在这里无关紧要。我更感兴趣的是了解哪些方法最适合我开始阅读。提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T16:55:43.783

当然，您必须首先将“关键字列表”字段转换为真正的标记方案。最简单的一个是标签表，以及与图像表的“多对多”关系（即第三个表，其中每条记录都有一个图像外键和另一个关键字外键）。使用一组特定关键字查找所有图像非常快。

用于检测限制措辞的贝叶斯过滤器很有趣。我会说去吧，除非你时间紧迫。如果是这样的话，一些简单的模式匹配应该能满足 90-95% 以上的情况，其余的可以由几个操作员手动快速完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T21:59:15.847

(1) 看起来像是一个分类问题，将文本中的单词作为特征，将“受限”和“不受限”作为标签。贝叶斯过滤或任何分类算法都可以解决问题。

(2) 看起来像一个聚类问题。首先，您想提出一个良好的相似度函数，该函数根据它们的关键字返回两个图像的相似度分数。余弦相似度可能是一个很好的起点，因为您正在比较关键字。从那里您可以计算相似度矩阵并记住数据集中每个图像的“最近邻”列表，或者您可以更进一步并使用聚类算法来提出实际的图像聚类。

由于您有如此多的记录，您可能希望跳过计算整个相似度矩阵，而只为数据集的一个小的随机样本计算集群。然后，您可以将其他数据点添加到适当的集群。如果您想保留更多相似性信息，可以查看软聚类。

希望这会让你开始。

# c++ - 将 std::cout 重定向到自定义编写器

> ID：533038
> 
> 赞同：6
> 
> 时间：2009-02-10T16:27:28.967
> 
> 标签：c++, stream, stringstream, iostream, streambuf

我想使用[Mr-Edd 的 iostreams 文章](http://www.mr-edd.co.uk/?p=16)中的这个片段在某处打印 std::clog。

```
#include <iostream>
#include <iomanip>
#include <string>
#include <sstream>

int main()
{
    std::ostringstream oss;

    // Make clog use the buffer from oss
    std::streambuf *former_buff =
        std::clog.rdbuf(oss.rdbuf());

    std::clog << "This will appear in oss!" << std::flush;

    std::cout << oss.str() << '\\n';

    // Give clog back its previous buffer
    std::clog.rdbuf(former_buff);

    return 0;
} 
```

所以，在主循环中，我会做类似的事情

```
while (! oss.eof())
{
    //add to window text somewhere
} 
```

这是[ostringstream 文档](http://en.cppreference.com/w/cpp/io/basic_ostringstream)，但我无法理解执行此操作的最佳方法。我有一个显示文本的方法，我只想用 ostringstream 中的任何数据调用它。

将发送到 std::clog 的任何内容重定向到我选择的方法的最简单/最佳方法是什么？是如上所述，并填写 while !eof 部分（不确定如何），还是有更好的方法，比如在某处重载一些调用我的方法的“提交”运算符？我正在寻找快速和简单的方法，我真的不想像文章那样开始使用 boost iostreams 定义接收器之类的东西——这些东西太让我头疼了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-10T18:34:11.520

我鼓励你看看[`Boost.IOStreams`](http://www.boost.org/doc/libs/release/libs/iostreams/doc/index.html)。它似乎很适合您的用例，并且使用起来非常简单：

```
#include <boost/iostreams/concepts.hpp> 
#include <boost/iostreams/stream_buffer.hpp>
#include <iostream>

namespace bio = boost::iostreams;

class MySink : public bio::sink
{
public:
    std::streamsize write(const char* s, std::streamsize n)
    {
        //Do whatever you want with s
        //...
        return n;
    }
};

int main()
{
    bio::stream_buffer<MySink> sb;
    sb.open(MySink());
    std::streambuf * oldbuf = std::clog.rdbuf(&sb);
    std::clog << "hello, world" << std::endl;
    std::clog.rdbuf(oldbuf);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-10T16:42:29.617

我**认为**您想在不为空的情况下从 ostream 中提取文本。你可以这样做：

```
std::string s = oss.str();
if(!s.empty()) {
    // output s here
    oss.str(""); // set oss to contain the empty string
} 
```

如果这不是你想要的，请告诉我。

当然，更好的解决方案是去掉中间人，让一个新的streambuf去你**真正**想要的地方，以后不需要再去探查了。像这样的东西（注意，这对每个字符都有效，但在 streambufs 中也有很多缓冲选项）：

```
class outbuf : public std::streambuf {
public:
    outbuf() {
        // no buffering, overflow on every char
        setp(0, 0);
    }

    virtual int_type overflow(int_type c = traits_type::eof()) {
        // add the char to wherever you want it, for example:
        // DebugConsole.setText(DebugControl.text() + c);
        return c;
    }
};

int main() {
    // set std::cout to use my custom streambuf
    outbuf ob;
    std::streambuf *sb = std::cout.rdbuf(&ob);

    // do some work here

    // make sure to restore the original so we don't get a crash on close!
    std::cout.rdbuf(sb);
    return 0; 
```

}

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-07-16T11:47:51.170

我需要从第三方库获取输出到 std::cout 和 std::cerr 并使用 log4cxx 记录它们，并且仍然保留原始输出。

这就是我想出的。这很简单：

*   我用我自己的类替换了 ostream 的旧缓冲区（如 std::cout），这样我就可以访问写入它的内容。

*   我还使用旧缓冲区创建了一个新的 std::ostream 对象，以便我可以继续将输出发送到我的控制台，除了将它发送到我的记录器。我觉得这很方便。

代码：

```
class intercept_stream : public std::streambuf{
public:
    intercept_stream(std::ostream& stream, char const* logger):
      _logger(log4cxx::Logger::getLogger(logger)),
      _orgstream(stream),
      _newstream(NULL)
    {
        //Swap the the old buffer in ostream with this buffer.
        _orgbuf=_orgstream.rdbuf(this);
        //Create a new ostream that we set the old buffer in
        boost::scoped_ptr<std::ostream> os(new std::ostream(_orgbuf));
        _newstream.swap(os);
    }
    ~intercept_stream(){
        _orgstream.rdbuf(_orgbuf);//Restore old buffer
    }
protected:
    virtual streamsize xsputn(const char *msg, streamsize count){
        //Output to new stream with old buffer (to e.g. screen [std::cout])
        _newstream->write(msg, count);
        //Output to log4cxx logger
        std::string s(msg,count);
        if (_logger->isInfoEnabled()) {
            _logger->forcedLog(::log4cxx::Level::getInfo(), s, LOG4CXX_LOCATION); 
        }
        return count;
    }
private:
    log4cxx::LoggerPtr _logger;
    std::streambuf*    _orgbuf;
    std::ostream&      _orgstream;
    boost::scoped_ptr<std::ostream>  _newstream;
}; 
```

然后使用它：

```
std::cout << "This will just go to my console"<<std::endl;
intercept_stream* intercepter = new intercept_stream(std::cout, "cout");
std::cout << "This will end up in both console and my log4cxx logfile, yay!" << std::endl; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-04T19:57:38.680

对于 log4cxx 示例，您必须覆盖 overflow() 和 sync() 否则将始终在接收到第一个流后设置坏位。

请参阅： [http ://groups.google.com/group/comp.lang.c++.moderated/browse_thread/thread/fd9d973282e0a402/a872eaedb142debc](http://groups.google.com/group/comp.lang.c++.moderated/browse_thread/thread/fd9d973282e0a402/a872eaedb142debc)

```
InterceptStream::int_type InterceptStream::overflow(int_type c)
{
    if(!traits_type::eq_int_type(c, traits_type::eof()))
    {
        char_type const t = traits_type::to_char_type(c);
        this->xsputn(&t, 1);
    }
    return !traits_type::eof();
}

int InterceptStream::sync()
{
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T16:51:19.877

如果您只想获取 ostringstream 的内容，请使用它的 str() 成员。例如：

```
string s = oss.str(); 
```

# iis-7 - 避免上传大于 10mb 的文件

> ID：533039
> 
> 赞同：4
> 
> 时间：2009-02-10T16:27:43.163
> 
> 标签：iis-7, file-upload

有什么方法（可能是模块）可以使 IIS7 拒绝文件大于 10mb 的帖子？

我的 ASP.NET 应用程序有一个上传页面，文件不能大于 10mb，我相信只有在所有内容都已发送到服务器后才能检查文件的大小。

IIS7 模块将是正确的选择，有人知道吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T16:30:05.747

您可以在 Web.Config 中设置限制

```
<system.web>
  <httpRuntime  maxRequestLength="xxxxx" executionTimeout="xx"/>
</system.web> 
```

*边注：*

默认情况下，IIS7 将拒绝任何大于 30 兆的文件，您可以通过添加以下代码来增加它

```
<security>
 <requestFiltering>
  <requestLimits maxAllowedContentLength=”XXXXXX″ />
 </requestFiltering>
</security> 
```

如果您希望在上传之前获取内容大小，您应该能够使用 HTTP 方法 HEAD 来检索 Content-Length。

[执行](http://www.eggheadcafe.com/tutorials/aspnet/2c13cafc-be1c-4dd8-9129-f82f59991517/the-lowly-http-head-reque.aspx)

# c# - C#中的初学者线程

> ID：533042
> 
> 赞同：6
> 
> 时间：2009-02-10T16:28:45.407
> 
> 标签：c#, asp.net, multithreading, iis

你能推荐一个很好的系列文章*，或者最好是一本*关于如何开始使用线程，特别是 C# 的书吗？我主要是在控制台应用程序和 ASP.Net 应用程序中寻找线程的使用。

我只了解线程的基础知识，并且知道“这里是龙”，所以在开始使用它们之前要打好基础。

我很好奇的事情是诸如拥有线程池的概念，如何管理它的大小，如何选择要排队的事物直到线程可用与强制启动新线程等。另外，我理解IIS 有很多内置的线程处理，因此任何解释如何在 IIS 下使用 ASP.Net 中的线程以及它与控制台 C# 应用程序中的线程有何不同的任何内容都很有趣。

我的预期用途包括：

*   用户在 ASP.Net 页面上做了一些事情，导致我的服务器端代码需要连接到另一个系统并执行冗长的操作，所以我想通过将该操作触发到另一个线程来快速将控制权返回给用户。用户可以通过 AJAX 继续观看进度，或者干脆离开——毕竟网络是无状态的 :)

*   Fire and Forget 模式的使用（有很多示例代码，我想更多地了解它们的工作原理）

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-10T16:31:49.143

除了 Andrew 链接的我自己的文章外，Joe Albahari 还有[另一个教程](http://albahari.com/threading)。

如果您想要真正彻底的检查，请阅读 Joe Duffy 的[Windows 并发编程](https://rads.stackoverflow.com/amzn/click/com/032143482X)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-10T16:30:34.450

这是我们自己的 Jon Skeet 的一组很好的文章：

[http://www.yoda.arachsys.com/csharp/threads/](http://www.yoda.arachsys.com/csharp/threads/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-10T16:33:16.723

我发现Joseph Albahari 的这本[免费电子书非常有用](http://www.albahari.com/threading/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T16:36:14.890

我会推荐 Joseph Albahari 的系列文章，请点击此处：

[http://www.albahari.com/threading/](http://www.albahari.com/threading/)

它简洁且可读性强。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T16:37:56.727

我推荐以下

[很棒的 MSDN 文章](http://msdn.microsoft.com/en-us/magazine/cc163744.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T17:00:36.487

获得 Jeff Richter 的“ [CLR Via C#](https://rads.stackoverflow.com/amzn/click/com/0735621632) ”。它是我读过的最好的 .Net 书籍，并且有大量关于线程的信息。

[![替代文字](https://i.stack.imgur.com/1SNVV.jpg)](https://i.stack.imgur.com/1SNVV.jpg)

# python - 如何在 Python 中记录源文件名和行号

> ID：533048
> 
> 赞同：174
> 
> 时间：2009-02-10T16:29:23.457
> 
> 标签：python, logging

是否可以装饰/扩展 python 标准日志记录系统，以便在调用日志记录方法时它还会记录文件和调用它的行号或调用它的方法？

* * *

## 回答 #1

> 赞同：312
> 
> 时间：2009-02-10T16:33:26.613

当然，请检查日志记录文档中的[格式化程序。](http://docs.python.org/library/logging.html#formatter-objects)特别是 lineno 和 pathname 变量。

> **%(pathname)s** 发出日志调用的源文件的完整路径名（如果可用）。
> 
> **%(filename)s** 路径名的文件名部分。
> 
> **%(module)s** 模块（文件名的名称部分）。
> 
> **%(funcName)s** 包含日志调用的函数名称。
> 
> **%(lineno)d** 发出记录调用的源行号（如果可用）。

看起来像这样：

```
formatter = logging.Formatter('[%(asctime)s] p%(process)s {%(pathname)s:%(lineno)d} %(levelname)s - %(message)s','%m-%d %H:%M:%S') 
```

* * *

## 回答 #2

> 赞同：128
> 
> 时间：2017-06-07T00:08:32.313

在[Seb 非常有用的答案](https://stackoverflow.com/a/533077/6862601)之上，这里有一个方便的代码片段，它以合理的格式演示了记录器的用法：

```
#!/usr/bin/env python
import logging

logging.basicConfig(format='%(asctime)s,%(msecs)d %(levelname)-8s [%(filename)s:%(lineno)d] %(message)s',
    datefmt='%Y-%m-%d:%H:%M:%S',
    level=logging.DEBUG)

logger = logging.getLogger(__name__)
logger.debug("This is a debug log")
logger.info("This is an info log")
logger.critical("This is critical")
logger.error("An error occurred") 
```

生成此输出：

```
2017-06-06:17:07:02,158 DEBUG    [log.py:11] This is a debug log
2017-06-06:17:07:02,158 INFO     [log.py:12] This is an info log
2017-06-06:17:07:02,158 CRITICAL [log.py:13] This is critical
2017-06-06:17:07:02,158 ERROR    [log.py:14] An error occurred 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2020-02-04T19:07:48.970

```
# your imports above ...

logging.basicConfig(
    format='%(asctime)s,%(msecs)d %(levelname)-8s [%(pathname)s:%(lineno)d in 
    function %(funcName)s] %(message)s',
    datefmt='%Y-%m-%d:%H:%M:%S',
    level=logging.DEBUG
)

logger = logging.getLogger(__name__)

# your classes and methods below ...
# An naive Sample of usage:
try:
    logger.info('Sample of info log')
    # your code here
except Exception as e:
    logger.error(e) 
```

与其他答案不同，这将记录文件的完整路径和可能发生错误的函数名称。如果您的项目包含多个模块以及分布在这些模块中的多个同名文件，这将非常有用。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-09-19T17:36:42.783

要以将调试日志记录发送到标准输出的方式构建上述内容：

```
import logging
import sys

root = logging.getLogger()
root.setLevel(logging.DEBUG)

ch = logging.StreamHandler(sys.stdout)
ch.setLevel(logging.DEBUG)
FORMAT = "[%(filename)s:%(lineno)s - %(funcName)20s() ] %(message)s"
formatter = logging.Formatter(FORMAT)
ch.setFormatter(formatter)
root.addHandler(ch)

logging.debug("I am sent to standard out.") 
```

将上述内容放入一个名为的文件中`debug_logging_example.py`会产生输出：

```
[debug_logging_example.py:14 -             <module>() ] I am sent to standard out. 
```

然后如果你想关闭记录注释掉`root.setLevel(logging.DEBUG)`。

对于单个文件（例如类分配），我发现这是一种比使用`print()`语句更好的方法。它允许您在提交之前在一个地方关闭调试输出。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2020-01-03T21:30:29.880

对于使用 PyCharm 或 Eclipse pydev 的开发人员，以下将在控制台日志输出中生成日志语句源的链接：

```
import logging, sys, os
logging.basicConfig(stream=sys.stdout, level=logging.DEBUG, format='%(message)s | \'%(name)s:%(lineno)s\'')
log = logging.getLogger(os.path.basename(__file__))

log.debug("hello logging linked to source") 
```

请参阅[Eclipse 控制台中的 Pydev 源文件超链接以](https://stackoverflow.com/questions/42457296/pydev-source-file-hyperlinks-in-eclipse-console/57779755#57779755)获取更长的讨论和历史记录。

# php - 使用 PHP 和 MySQL 处理时间戳（我的理论正确吗？）

> ID：533049
> 
> 赞同：1
> 
> 时间：2009-02-10T16:29:52.627
> 
> 标签：php, mysql

我一直在研究 PHP & MySQL 中的时间戳。我的理解是 UNIX 时间戳仅存在于 GMT 中……关键在于您将其转换为用户时区（GMT +/- 时区 = 用户本地时间）。我通过将时间戳保存为“原始”形式（作为 10 位长整数）并在查询中将其转换为本地时间来成功地做到这一点

> ```
>  $row = $result->fetchRow(DB_FETCHMODE_ASSOC);
>     $timestamp = $row['stamp'];
>     date_default_timezone_set('America/New_York');
>     echo date("d/m/y : H:i:s", $timestamp); 
> ```

这似乎工作正常，但我不确定这是否是“标准”方式。你有这方面的经验吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T01:53:40.867

你的方法很好:)

您可能希望在更全局的范围内设置时区，例如在您用于登录的任何 PHP 脚本上，而不是每次使用日期函数时都必须调用它。如果出于某种原因改变主意并想要标准化时区或类似的东西，这也使更改变得更容易。

实际上，在 MySQL 中管理 Unix 时间戳的最佳方法是 UNIX_TIMESTAMP() 函数。没有任何参数的 UNIX_TIMESTAMP() 只返回当前的 Unix 时间，而不是像

```
$time=time();
mysql_query('UPDATE table SET time='.$time.' WHERE what="ever"'); 
```

您可以通过直接在查询中粘贴 UNIX_TIMESTAMP 来完全减少额外的工作：

```
mysql_query('UPDATE table SET time=UNIX_TIMESTAMP() WHERE what="ever"'); 
```

干净多了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T17:11:11.237

mysql-server 以独立于时区的格式 (UTC) 存储日期。
但在存储日期之前，它将使用其时区进行转换。

您可以更改每个连接的 mysql 时区 *1：

```
mysql_query('SET time_zone = "'.$timezone.'"'); 
```

您还可以更改每个脚本的时区。

```
date_default_timezone_set($timezone); 
```

如果将它们设置为相同的时区“2009-01-10 13:30:00”对 mysql 和 php 意味着相同的事情。

但请记住，两台服务器具有不同的内部时钟值，因此如果您想根据当前时间生成时间戳。在 mysql 或 php 中执行此操作。

*1) MySQL 时区支持可能需要额外的配置。检查[手册](http://dev.mysql.com/doc/refman/5.1/en/time-zone-support.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T20:45:52.043

我认为没有办法在 MySQL 中指定日期时间或时间戳字段的时区。

因此，您必须使用一个时区将日期和时间存储在数据库中，并在必要时将其转换为另一个时区。您可以使用 Zend Framework 的 Zend_Date 组件之类的东西来进行转换。

我认为使用时区和 MySQL 没有“标准”方式，您必须自己进行设置。

对于我的客户，每个人都只在一个时区工作，所以我在我的 PHP 脚本中做的第一件事就是`date_default_timezone_set`按照你所说的设置时区。但是在执行此操作时，您应该注意使用函数 NOW()（或其他日期和时间函数）进行查询，因为 MySQL 可能设置为与您在`date_default_timezone_set`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T17:33:09.123

[我使用putenv](http://us3.php.net/putenv)在 php 中设置时区。如果您基于 GMT 工作，这应该为应用程序的其余部分设置时区。可能还有其他解决方案，但这是我发现的最简单的解决方案，因为我并不总是使用数据库中的时间和日期。

# activemq - STOMP 协议 - 连接框架是否必须登录/密码？

> ID：533050
> 
> 赞同：1
> 
> 时间：2009-02-10T16:30:02.020
> 
> 标签：activemq, stomp

我一直在以各种形式使用 STOMP 协议。我在 STOMP 的 PHP、Python 和 Objective-C 库中经历过这种现象。[STOMP 网站](http://stomp.codehaus.org/)上的 STOMP 规范并没有具体说明这一点。

基本上，所有三个库中的 CONNECT 函数（虽然 Python 已经修复了这个问题，但它被确认为一个错误。该函数仍然发送登录和密码参数，即使没有指定。所以..

```
CONNECT
login:
passcode: 
```

规范尚不清楚，我想知道是否有人对此有更好的想法。我知道一些参与 STOMP 和 ActiveMQ 的人浏览这些论坛。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T10:01:58.750

ActiveMQ 不需要发送这些标头。例如看一下这个 telnet 会话

```
$ telnet localhost 61613
Trying ::1...
Connected to localhost.
Escape character is '^]'.
CONNECT

^@
CONNECTED
session:ID:nc-example.com-51165-1234432649359-2:0 
```

它在没有任何标头的情况下成功连接到代理。

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-29T04:30:39.420

对于它的价值，[STOMP 1.1 规范](https://stomp.github.io/stomp-specification-1.1.html#CONNECT_or_STOMP_Frame)澄清了这种含糊不清的地方：

> STOMP 1.1 客户端可以设置以下标头：
> 
> *   login ：用于对安全 STOMP 服务器进行身份验证的用户 ID。
>     
>     
> *   passcode ：用于对安全 STOMP 服务器进行身份验证的密码。

# php - 为什么我应该在我的 php 脚本中使用<?php而不是？<?

> ID：533057
> 
> 赞同：11
> 
> 时间：2009-02-10T16:30:54.980
> 
> 标签：php, syntax

为什么我应该在我的 php 脚本中使用`<?php`而不是？`<?`

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-10T16:47:45.253

避免使用短开标签的两个主要原因是

1.  最大的可移植性 -`<?php`可以在每台启用 PHP 的服务器上工作，但`<?`可以禁用
2.  它与 XML 序言的开头相同 - 可能会导致解析或执行问题

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-10T16:38:35.540

启动PHP有两种方法

```
<?php 
```

和

```
<? 
```

PHP 还包括

```
<?= 
```

但这将打印出它背后的变量，因为它是回声的简写。

您应该使用 < ?php 因为它与所有服务器类型兼容。您可以将代码移动到新的托管解决方案或设置新的服务器默认值，并且可以禁用速记。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-10T16:42:04.533

短标签`<?`（和`<?=`）可以被禁用。长版本`<?php`（和`<?=`= `<?php echo`）在任何地方都可以使用。

我们可以讨论 PHP 团队决定让这样的东西可配置的意义，但本质是，您不能在可移植代码中使用短标签。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-10T16:44:03.263

我个人更喜欢`<?` 关机有两个原因

1.  许多大型 PHP 项目的 PHP 编码标准建议将其关闭
2.  如果您正在生成 XML 文档（xml 文档以 开头`<?xml version="1.0" encoding="UTF-8" ?>`） ，则会产生问题
3.  (bonus)`<?php`比`<?`.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-10T16:33:49.997

两者在语义上是相同的。 `<?`只是完整语法的快捷方式。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-10T19:08:52.607

为了补充大家的解释，即不应使用短标签，因为它们可能被禁用（甚至可能从未来的 PHP 版本中删除），不推荐使用短标签的主要理由是它们不是有效的 XML“处理指令”，而`<?php`标签是。因此，带有标签的 PHP 模板`<?php ... ?>`可以是有效的 XML 文档，而使用短标签的则不是。

*   [http://www.w3.org/TR/REC-xml/#sec-pi](http://www.w3.org/TR/REC-xml/#sec-pi)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T16:36:34.500

应该注意的是，PHP 的某些服务器配置不支持其中一种或另一种。例如，我的网络服务器不支持 <? 但确实支持 <?php

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-07T18:02:34.930

可移植性论点都很好，但我会亵渎神明并说如果你愿意，你应该继续使用短标签，除非你正在做一些真正广泛分布的事情（源） ，或者正在制作一些非常关注 xml 的东西。

a) 我从未遇到过无法启用短标签的情况。通常它们默认打开。

b) 在大多数情况下，`<?`不会混淆，`<?xml`因为它们是在堆栈的不同级别进行解析的。

c）短标签不那么突兀，因此使您的代码更少混乱。我发现这尤其适用于`<?php echo`vs. `<?=`。（您可能会争辩说您通常应该避免使用其中任何一种，因为这可能意味着您正在编写意大利面条代码，但是来吧——这是 php！）

当然，这一切都取决于你正在从事什么样的项目，但对于一个基本的网站，我认为短标签根本不会伤害你。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-10T16:43:32.377

[Wordpress 编码标准](http://codex.wordpress.org/WordPress_Coding_Standards)说只使用`<?php`. 他们没有解释为什么。

这可能是一个宗教问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-10T17:05:20.017

短格式`<?`/`<?=`语法的支持基于[`short_open_tag`php.ini 中的参数](http://us3.php.net/ini.core)。如果您托管自己的代码库，则启用此功能很简单。但是，在共享/托管 Web 主机上，您可能无法控制此设置。

因此，为了获得最大的可移植性，您应该使用长格式语法。

# c++ - C++类成员函数命名规则

> ID：533065
> 
> 赞同：2
> 
> 时间：2009-02-10T16:31:40.503
> 
> 标签：c++, naming

我正在尝试将 C 套接字库中的一些函数封装到我自己的 C++ 类中。我想定义一个成员函数，它使用与其对应的 C 函数相同的名称，但具有不同的签名。例如，我想编写函数

```
ssize_t MyClass::write(const void *buf); 
```

调用

```
ssize_t write(int fd, const void *buf, size_t count); 
```

编译时出现以下错误

```
error: no matching function for call to ‘MyClass::write(int&, const char*&, size_t)’
note: candidates are: ssize_t MyClass::write(const char*) 
```

我有正确的`#include`语句来调用 C 套接字库，但我对写入函数的定义似乎掩盖了它。如果我将类定义函数的名称更改为其他名称，一切似乎都正常。

我有理由确定更改我的函数名称将是我的最终解决方案，但是有人可以告诉我导致这种行为的 C++ 命名规则的名称吗？我想阅读它，以便我知道我将来会做什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T16:35:22.863

您是否尝试过调用 C 函数以明确表示它位于全局命名空间中，例如 ::write？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T17:51:49.310

[这个页面](http://msdn.microsoft.com/en-us/library/2902y0f8(VS.80).aspx)很好地描述了 C++ 中的名称查找规则。基本上，一旦编译器看到这`write()`是一个类成员函数，它就不会寻找同名的全局函数。然后它报告一个错误，因为成员函数`write()`没有你给它的正确数量和类型的参数。一元范围解析运算符的使用`::`强制编译器仅在全局命名空间中搜索名为 的函数`write()`，然后搜索成功。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T17:45:21.167

更一般地，当编译器去寻找一个函数时，它首先在最近的命名空间中寻找，如果它找到一个具有正确名称的名字，它就不会再寻找任何东西，即使签名不匹配。

# c# - Windows 窗体列表框中的平滑滚动

> ID：533068
> 
> 赞同：2
> 
> 时间：2009-02-10T16:31:58.427
> 
> 标签：c#, .net, winforms, listbox, widget

有没有办法在 Windows 窗体框架中为 ListBox 类启用平滑滚动？（我使用的是 C# 和 .NET 框架 2.0）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T17:54:49.927

这是系统设置。您可以通过 P/Invoking SystemParametersInfo 使用 SPI_SETLISTBOXSMOOTHSCROLLING 参数来更改它。不建议这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T17:27:50.320

不，没有，反正在 WinForms 中也没有。

WPF 有一个可以启用的功能，并且有一个可以在 vista 中启用的平滑滚动动画，可以提供平滑滚动的外观，尽管它实际上只是一个动画过渡。但据我所知，ListBox 中的滚动是硬编码的，每次只做一个项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-09T11:34:03.133

您还可以看看在 codeproject.com 中[实现平滑动画 ListBox](http://www.codeproject.com/KB/list/SmoothListBox.aspx) Fredrik Bornander 编写了相同的控件，但该控件是根据 windows mobile 编写的，但我认为您可以轻松迁移您的 windows 窗体项目。

它也许能给你新的想法。

# winapi - 为 x64 重新编译一个简单的 Win32 C++ 应用程序

> ID：533070
> 
> 赞同：2
> 
> 时间：2009-02-10T16:32:14.213
> 
> 标签：winapi, 64-bit

我有一个用于 Win32 的小型 C++ 程序，它具有以下 WinMain：

```
int APIENTRY WinMain(HINSTANCE hInstance,
                     HINSTANCE hPrevInstance,
                     LPSTR     lpCmdLine,
                     int       nCmdShow) 
```

尝试为 x64 编译时，出现以下错误：

```
error LNK2019: unresolved external symbol WinMain referenced in function __tmainCRTStartup 
```

必须采取哪些步骤来为 x64 重新编译一个简单的 win32 应用程序？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T03:16:41.513

您的链接器设置为链接子系统下的可执行文件`CONSOLE`，因此它正在寻找`main`，您需要将子系统设置为`WINDOWS`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T16:43:49.210

没有承诺，但我怀疑您的问题可能会通过将“APIENTRY”更改为“WINAPI”来解决。如果这确实解决了问题，则问题是不同的调用约定。

如果没有，我怀疑您需要查看编译器标志。

# c# - 从 Java / C# 的角度理解 C++ 编译器

> ID：533076
> 
> 赞同：5
> 
> 时间：2009-02-10T16:33:22.777
> 
> 标签：c#, java, c++, compiler-construction, transition

我是一名经验丰富的 Java/C# 程序员，最近开始学习 C++。问题是，我无法理解如何构建各种头文件和代码文件。这似乎主要是由于我对编译器如何将所有内容链接在一起缺乏了解。我尝试阅读一些教科书，但我的 Java 和 C# 知识严重影响了我的先入之见。例如，我很难理解方法等可以在命名空间中定义而不仅仅是在类定义中的事实。

我找到了很多 C++ -> Java/C# 指南，但实际上没有什么可以反其道而行之。是否有任何好的资源可以缓解 Java/C# -> C++ 转换，特别是在理解编译过程方面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T16:44:05.853

当我第一次开始使用 C 时，这也是让我感到困惑的事情。书籍并没有很好地描述标题与代码文件的正确使用。

编译器通过加载每个 .cpp 文件并独立于所有其他文件进行编译来工作。编译的第一步是加载#include 语句引用的所有头文件。您可以认为它在有#include "foo.h" 的地方对整个 foo.h 进行文本插入。

这对如何构建文件有什么影响？头文件应该包含其他 .cpp 文件需要引用的程序的任何部分。作为一般规则，实现不应该在头文件中。这会导致问题。头文件应包括类、函数和全局变量的声明（如果必须使用它们）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T16:56:25.327

[C++ FAQ](http://web.tiscali.it/fanelia/cpp-faq-en/)是关于所有 C++ 特性的极好资源，但它可能比您正在寻找的要高级一些——即使对于相当有经验的 C++ 开发人员来说，大多数问题（不仅仅是答案）都是谜团。

我想如果你用谷歌搜索 C++ 教程，你就能找到一些东西。您可能还想尝试学习汇编语言（或至少快速了解微处理器中实际发生的事情），因为 C 和 C++ 在做事方式上都非常接近硬件。这就是它们的速度和能力的来源，但它是以 Java 提供的一些更好的抽象为代价的。

我可以尝试回答您上面提出的具体问题，但我不知道我会做得如何。

理解头文件和 cpp 文件之间关系的关键之一是理解“翻译单元”的概念。Java 类文件可以被认为是一个翻译单元，因为它是编译成二进制形式的基本单元。在 C++ 中，几乎每个 cpp 文件都是一个翻译单元（如果你在做奇怪的事情，也会有例外）。

头文件可以包含在多个翻译单元中（并且必须包含在使用头中定义的任何内容的任何地方）。#include 指令实际上只是进行文本替换——包含文件的内容被逐字插入到#include 指令所在的位置。您通常希望在头文件中定义类接口，并在 cpp 文件中定义实现。这是因为您不想将实现细节暴露给可能包含标题的其他翻译单元。在 C++ 中，包括类在内的所有内容都不是真正的丰富对象，而只是编译器为其赋予意义的内存块……通过将相同的标头信息编译到每个翻译单元中，编译器保证所有翻译单元对一块内存代表什么有相同的理解。由于编译后缺乏丰富的数据，反射之类的东西是不可能的。

C++ 构建过程的第二步是链接，在此链接器获取所有已编译的翻译单元并查找在翻译单元中使用但未在此处定义的符号（通常是函数调用，也包括变量）。然后它寻找另一个定义该符号的翻译单元并将它们“链接”在一起，以便对特定函数的所有调用都指向定义它的翻译单元。

在类方法的情况下，它们必须通过类实例来调用，这在幕后只是一个指向一块内存的指针。当编译器看到这些类型的方法调用时，它会输出调用函数的代码，隐式地将称为`this`指针的指针作为第一个参数传递给函数。您可以拥有不属于类的函数（不是方法，正如您所说，因为方法正确地是类的成员函数，因此没有类就不能存在），因为链接器没有类的概念。它将看到一个定义函数的翻译单元和另一个调用函数并将它们联系在一起的翻译单元。

这最终比我预期的要长得多，当然是过于简单化了，但据我所知和所提供的详细程度，它是准确的......希望它对一些人有所帮助。至少它应该为您提供一些谷歌搜索的起点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T17:04:36.273

我实际上建议远离关于 C++ 编译器的解释，并查看 C 编译器的解释。以我的经验，这些都得到了更好的解释，避免让您对 OOP 问题感到困惑。寻找有关 C 单独编译的材料。我会向您推荐我母校的一本很棒的幻灯片小册子，但它不是英文的。

C 编译和 Java/C# 之间的主要区别在于编译不会创建已解析的实体。换句话说，当您在 Java 中编译时，编译器会为任何引用的类查找已编译的类文件，并确保所有内容都可用且一致。基本假设是，当您最终运行程序时，这些文件也将可用。

另一方面，编译后的 C 文件只是一个“承诺”。它依赖于对依赖项外观的声明（以函数声明的形式），但不能保证在任何地方都定义了这些依赖项。您需要做的最困难的思维方式转换是将 C 文件不仅仅是该文件，而是该文件与其包含的所有内容（即预处理器生成的内容）的聚合。换句话说，编译器看不到头文件，似乎是一个大文件。编译器在生成的目标文件中跟踪“仍然丢失”的所有内容。稍后，在链接时，链接器通过尝试用来自不同目标文件的材料填充所有空白来解决这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T12:41:38.067

您可能想知道为什么编译和链接也是分开的（因为我没有看到任何解释它的帖子，这是造成很多混乱的原因，不知道事情的根本原因）。

链接和编译是分开完成的，因为（可能有不止一个原因）需要进行库调用。如果您定义或任何类似的代码，则在这些头文件中实现函数原型的代码是已经编译并作为目标代码位于某处的库的一部分。如果要改用一个巨大的编译过程，您需要拥有这些库调用的源代码，以及在编译期间更多的时间，因为您还要编译库代码。

# sql-server - 数据库文件级加密

> ID：533082
> 
> 赞同：2
> 
> 时间：2009-02-10T16:34:11.197
> 
> 标签：sql-server, sql-server-2005, encryption

我们最近被要求在静止时加密他们的所有数据。他们同意加密 dbf、backup 和 trn 文件足以满足他们的需求。我的问题是，我还需要加密 ldf 文件吗？ldf 文件中是否有任何需要加密的可检索数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T16:40:28.860

写入数据库的任何内容都在 LDF 中。

根据您的恢复模式，这些数据将存在多长时间。

可能要等到您下次执行日志文件备份。

无论哪种方式，是的，您应该认为它包含与您的数据库本身一样多的有价值信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T16:40:24.740

您当然可以读取 SQL Server 日志文件。您所需要的只是一个日志分析器，互联网上有很多可用的日志分析器。

你甚至可以建立自己的。

干杯，约翰

# django - 如何在 Django 1.0 中进行管理内联？

> ID：533086
> 
> 赞同：1
> 
> 时间：2009-02-10T16:35:27.093
> 
> 标签：django, django-admin

我正在研究我拥有的 Django 书中的示例，但这本书是为 0.96 编写的，而我使用的是 1.0.2，是的，我知道，这不是最好的主意。但是阅读 Django 的“将您的应用程序从 0.96 移植到 1.0”文档已经为我清除了大部分差异。直到我需要在管理页面上实现第二个模型的内联编辑。

我正在使用自定义关键字搜索模型来允许您搜索使用 Django 的 Flatpages 应用程序制作的页面。下面是模型：

`class SearchKeyword(models.Model):`

 ````
 keyword = models.CharField(max_length=50, blank=True)
    page = models.ForeignKey(FlatPage)

    def __unicode__(self):
        return self.keyword 
````  `我的 admin.py 应该是什么样子才能为显示在 Flatpages 管理页面上的 SearchKeyword 设置 StackedInline？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T16:46:25.270

你可以这样做：

```
class SearchKeywordInline(admin.StackedInline):
    model = SearchKeyword
    extra = 3

class FlatPageAdmin(admin.ModelAdmin):
    inlines = [SearchKeywordInline]

# unregister the FlatPage model from the admin site so I can
# register it again with the inline stuff (Thanks Carl & Jason)
admin.site.unregister(FlatPage)
admin.site.register(FlatPage, FlatPageAdmin) 
```

[官方Django 文档](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#ref-contrib-admin)中的更多信息

**更新**：修复了代码以满足您的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T10:37:00.190

查看 [链接文本](http://blog.haydon.id.au/2008/08/2-your-first-django-site-simple-cms.html) ，我认为这会恰到好处

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T21:55:09.810

这是我让它正常工作后的代码。谢谢你们的帮助

```
from cms.search.models import SearchKeyword
from django.contrib.flatpages.models import FlatPage
from django.contrib import admin

class SearchKeywordInline(admin.StackedInline):

    model = SearchKeyword
    extra = 3

class FlatPageAdmin(admin.ModelAdmin):

    inlines = [SearchKeywordInline]

# unregister the FlatPage model from the admin site so I can
# register it again with the inline stuff.
admin.site.unregister(FlatPage)
admin.site.register(FlatPage, FlatPageAdmin) 
```

# .net - 有没有办法查看 .NET 颜色名称显示的颜色？

> ID：533087
> 
> 赞同：2
> 
> 时间：2009-02-10T16:35:28.573
> 
> 标签：.net, visual-studio, colors, color-scheme, color-picker

我正在使用 System.Drawing.Color，Visual Studio 中有什么东西可以显示名称的颜色吗？

例如，如果我使用`Color.Cornsilk`会显示什么颜色？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T16:39:26.520

[http://www.codeproject.com/KB/macros/ZetaColorVisualizer.aspx](http://www.codeproject.com/KB/macros/ZetaColorVisualizer.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T16:42:56.590

Windows 窗体属性窗口允许您使用“颜色选择器”选择与颜色相关的属性，该颜色选择器在名称旁边显示实际颜色。

只需在属性值区域中输入颜色名称，按回车，如果名称是已知的 .NET 颜色，就会显示出来。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T16:47:31.620

您可以通过 VS 设计器在任何控件上测试颜色。
设置一个`Panel BackgroundColor`例如。

无论如何，可以在网络上的任何地方找到命名的颜色样本。
这是使用颜色的一个[很好的参考](http://www.colorexplorer.com/colorlibraries.aspx)（`Named Web Color`在下拉列表中选择）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-10T16:42:36.170

看看这篇文章中的 Jon Skeets 回答

[C# 颜色常数 R,G,B 值](https://stackoverflow.com/questions/225953/c-color-constant-rgb-values)

# iis-7 - “AspCompat”属性问题

> ID：533089
> 
> 赞同：0
> 
> 时间：2009-02-10T16:35:35.173
> 
> 标签：iis-7, ado

我客户的一个网站（我没有编码）昨天被他的主机迁移到了一个新的服务器上。所有这些使用 aspcompat 属性的 aspx 代码现在都会爆炸 -

<%@ Page Language="VB" AspCompat="true" %> '接下来我们需要使用 ADO 数据库连接对象在服务器上创建一个数据库连接对象。'创建一个 ADO 连接对象 adoCon = Server.CreateObject("ADODB.Connection")

'使用 DSN 连接 adoCon.Open ("DSN=Application") 设置到 Connection 对象的活动连接

因此，他显然在使用旧的 ADO 对象，并希望它能够与 COM 兼容。

我尝试在此文件夹级别设置一个新的应用程序池并将其设置为使用经典管道，但这也无济于事。

如果没有将他所有的 ADO 代码重写为 ADO.NET，我该怎么做才能让他启动并运行？这对他来说是此时的生产问题，所以时间对他来说至关重要。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T16:41:21.633

显然这是一个服务器配置问题，因为它是导致问题的迁移。考虑到这一点，这里有一些事情需要检查：

*   使用的 .Net 框架版本（和服务包）。它与旧服务器匹配吗？
*   检查 web.config 是否有任何将其绑定到旧服务器的内容
*   检查 machine.config 文件
*   检查新服务器与旧服务器上的信任级别
*   检查新服务器与旧服务器上的文件/安全权限

[更新]：
我刚在谷歌上看到这个： [http ://forums.iis.net/t/994019.aspx](http://forums.iis.net/t/994019.aspx)

# design-patterns - “后期绑定”和“控制反转”是什么关系？

> ID：533090
> 
> 赞同：0
> 
> 时间：2009-02-10T16:35:44.690
> 
> 标签：design-patterns, oop, inversion-of-control, late-binding

在[他](http://userpage.fu-berlin.de/~ram/pub/pub_jf47ht81Ht/doc_kay_oop_en)对 OOP 的定义中，Alan Kay 指出他支持“所有事物的极端后期绑定”。他对后期绑定的兴趣是否与人们对 IoC 的兴趣具有相同的动机？

特别是，如果说两者都是出于“尽可能少地指定，而将实现细节留待以后填写”的概念，是否正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T18:33:18.447

这取决于您所说的控制反转的含义-该术语已被重载以包括依赖注入，但它们实际上是不同的概念。IoC 最初描述了一种控制程序流的方法，而 DI 特别关注减少类型之间的耦合。

也就是说，可以说所有这些方法/模式/哲学都具有相同的基本原则：降低变革成本。

# django - 如何在不包含在 URL 中的情况下将一些信息传递给视图（django 新手）

> ID：533096
> 
> 赞同：2
> 
> 时间：2009-02-10T16:36:43.470
> 
> 标签：django, django-templates, django-urls

我正在开发一个用于保留绘画版画的 django 小应用程序。

客户进入此订购页面，填写一些信息（姓名、电子邮件、奉献精神等），选择他们要保留的打印编号，然后单击订购。单击时，我的 django 代码将所有客户信息存储在一个新的 OrderInfo 对象中，它调用 HttpResponseRedirect 到我的感谢页面。

我希望此感谢页面包含 OrderInfo 中包含的一些确认详细信息（例如，谢谢您，{{name}}，您的订单）。

我的第一个想法是在谢谢 url 中包含 OrderInfo 的 ID，但这将允许*任何人*访问 OrderInfo 以获取任何不适合隐私的 ID。

您可以在此处查看演示：[链接](http://cce.webfactional.com/myclubpicture/3/detail "演示")

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T16:46:10.390

首先，确保所有显示敏感内容的视图都有`@login_required`装饰器，并检查它`request.user`实际上是可以访问所请求信息的视图。

现在，对于您的具体问题，您可以将其`OrderInfo`放入会话字典中。事实上，将整个对象复制到那里可能会很方便，而不仅仅是 ID。

此外，如果您想允许未登录的用户执行所有这些操作，您仍然必须以某种方式识别它们。同样，最明显的方法是大量使用会话来跟踪用户。

# unit-testing - 对 Java EE/Web 应用程序进行单元测试的良好做法是什么

> ID：533097
> 
> 赞同：4
> 
> 时间：2009-02-10T16:36:43.533
> 
> 标签：unit-testing, jakarta-ee, junit

测试面向 servlet 的 Web 应用程序的最佳方法是什么？可能有 jdbc 支持的后端。

前端 = Struts2 和一些 servlet 后端 = hibernate，一些基本的 jdbc

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T11:51:56.583

使用模拟，easymock 是最好的模拟框架之一（或者如果你更喜欢这个名字，你可以使用 jmock）。spring-mock 对模拟 servlet 类有很好的支持。

您还可以使用 dbunit 进行集成测试（以测试您的 sqls 和 hqls），但它的速度很慢并且需要更长的时间来编写和维护。我认为你不应该这样做，除非你遇到一些问题，人们编写错误的查询或数据库架构发生了很大变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T12:25:43.197

最重要的事情：**可测试性设计**。

这意味着尝试拥有小的独立组件（这几乎总是一件好事，不仅仅是为了可测试性）并分别测试组件。控制反转（有或没有像 Spring 这样的 IoC 框架）可以在该领域为您提供很多帮助。一旦有了小组件，就可以很容易地使用 jUnit、easymock 或任何其他标准测试实用程序对其进行测试。

测试前端，是最乏味和无聊的任务。Selenium 可以帮助你一点，但我知道没有灵丹妙药。

# flash - 为什么减少内容时我的 SWF 文件大小没有减小？

> ID：533098
> 
> 赞同：2
> 
> 时间：2009-02-10T16:36:44.500
> 
> 标签：flash, actionscript-2

我经常发现我的 SWF 文件大小是否偏大，当完全删除媒体或删除并重新插入图像、声音等的压缩版本时，它对生成的 SWF 文件大小几乎没有影响或没有影响。我曾尝试删除 SWF 以允许 Flash 从头开始​​重新创建它，但这没有任何区别。有没有其他人经历过这个和/或知道解决方案？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T16:44:21.767

确保您删除了对库中文件的所有引用。例如，如果您有一个链接资产（即，正在导出以用于动作脚本的资产），即使您在舞台上没有该资产，它也会与 swf 一起编译。此外，当您从 FLA 中删除项目时，请使用 File > Save and Compact ... 这会清理您的文件并对其进行优化。有关更多信息，请参阅以下帖子...

[http://www.derekallard.com/blog/post/flash-save-and-compact/](http://www.derekallard.com/blog/post/flash-save-and-compact/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T21:58:09.953

如果您在发布设置中选中“生成大小报告”，您将获得一份非常详细的报告，并且您将更好地了解可能需要剔除的内容。长声音和大图像通常是最大的罪魁祸首。

我发现降低长背景音乐的音质对用户体验的影响很小，同时释放了大量空间。

编辑：默认情况下，报告作为文本文件发布到与 SWF 相同的位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T16:45:22.577

如果库中的某些内容以前未在电影中使用，则从库中删除它不会减小 SWF 大小。这是因为当 Flash 发布 SWF 时，它只包含使用的元素。

您提到的另一件事 - Flash 提供了自己的图像压缩。您最好在库中拥有高质量的 JPG 或 PNG，然后右键单击它并选择“属性”。然后在那里调整质量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-01T16:00:59.310

你可能有一个对象的双重实例。确保从库中拖动 mc 而不是位图。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-10T16:41:27.607

你确定你指的是 SWF 而不是 FLA？我有过从 FLA 中删除资产不会导致文件大小减小的经验。我相信这是 Flash 中的一个错误，因为保存新副本（文件 > 另存为）可以解决问题。

至于减小 SWF 的文件大小，根据我的经验，通常如果您不在库中创建对象的实例，则不会编译它。

# continuous-integration - 在 CruiseControl.Net 中仅对选定的构建进行质量检查

> ID：533100
> 
> 赞同：0
> 
> 时间：2009-02-10T16:37:55.743
> 
> 标签：continuous-integration, build-automation, cruisecontrol.net, qa

CC.Net 每天都在为我们创建许多构建。有时我们会进行一些手动冒烟测试，然后构建成为 QA drop（或发布候选，如果您愿意）。QA 丢弃只是复制到删除服务器。

我想针对现有的成功构建自动执行 q​​a-drop-copy nant 脚本。我怎样才能做到这一点？用更广泛的方式来表达我的问题，人们如何从一组成功的构建中自动发布到 QA？

我设想了一个带有“QA Drop”标签的额外按钮，可以触发脚本。它可能在 Force 按钮旁边（发布最后一个构建），甚至在每个构建报告页面上都可用（发布任何构建）。

谢谢，乔什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T23:17:54.753

这正是我们在 AnthillPro 中进行设置的方式。在构建记录上，您有一个名为“运行辅助进程”的额外按钮，可以连接到部署和功能测试套件等内容。单击该按钮，选择您的流程、目标环境，然后就可以开始使用了。

我在其他工具中对此进行模拟的方式是使用 CI 工具中的依赖项小部件来进行 QA 部署“项目”，该“项目”取决于我要部署的项目。对于支持这一点的大多数 CI 工具，当您仅部署最近成功的构建时，该方法最有效。

只要您想要进入 QA 环境，这种方法就可以工作。当您开始将多个流程串在一起时，可能需要某种实时构建或管道管理策略 - 这可能会开始将您移出开源 CI 工具空间。

——埃里克

# java - 您在 Java 项目中使用什么策略来命名包，为什么？

> ID：533102
> 
> 赞同：90
> 
> 时间：2009-02-10T16:38:09.533
> 
> 标签：java, naming-conventions, packages

不久前我就想到了这个问题，最近它又出现了，因为我的商店正在开发它的第一个真正的 Java Web 应用程序。

作为介绍，我看到了两种主要的包命名策略。（需要明确的是，我不是指整个 'domain.company.project' 部分，我指的是下面的包约定。）无论如何，我看到的包命名约定如下：

1.  **功能性：根据架构上的功能而不是根据业务领域的身份来命名您的包。** 另一个术语可能是根据“层”命名。因此，您将拥有一个 *.ui 包、一个 *.domain 包和一个 *.orm 包。您的包裹是水平切片而不是垂直切片。

    这*比*逻辑命名更常见。事实上，我相信我从未见过或听说过这样做的项目。这当然让我怀疑（有点像认为你已经想出了一个解决 NP 问题的方法），因为我不是很聪明，而且我认为每个人都必须有充分的理由这样做。另一方面，我并不反对人们只是想念房间里的大象，*而且*我从未听说过以这种方式命名包的实际*论据*。这似乎是事实上的标准。

2.  **逻辑：根据业务域标识命名您的包，**并将与该垂直功能切片有关的每个类放入该包中。

    正如我之前提到的，我从未见过或听说过这一点，但这对我来说很有意义。

    1.  我倾向于垂直而不是水平地接近系统。我想进去开发订单处理系统，而不是数据访问层。显然，我很有可能会在该系统的开发中触及数据访问层，但关键是我不这么认为。当然，这意味着当我收到变更单或想要实现一些新功能时，不必为了找到所有相关的类而在一堆包中四处寻找会很好。相反，我只是查看 X 包，因为我所做的与 X 有关。

    2.  从开发的角度来看，我认为让你的包记录你的业务领域而不是你的架构是一个重大的胜利。我觉得域几乎总是系统中更难理解的部分，因为系统的架构，特别是在这一点上，在其实现中几乎变得平凡。事实上，我可以使用这种类型的命名约定并立即从包的命名中知道它处理订单、客户、企业、产品等的系统，这似乎非常方便。

    3.  看起来这样可以让您更好地利用 Java 的访问修饰符。这使您可以更清晰地将接口定义到子系统中，而不是系统的层中。因此，如果您有一个希望透明持久化的订单子系统，理论上您可以通过不必在 dao 层中为其持久性类创建公共接口，而是将 dao 类包装在只有它处理的类。显然，*如果*您想公开此功能，您可以为其提供一个接口或将其公开。通过将系统功能的垂直部分拆分到多个包中，您似乎失去了很多。

    4.  我想我可以看到的一个缺点是它确实使剥离图层变得更加困难。而不是仅仅删除或重命名一个包，然后用另一种技术将一个新的包放到适当的位置，您必须进入并更改所有包中的所有类。但是，我认为这没什么大不了的。这可能是由于缺乏经验，但我不得不想象，与您在系统中进入和编辑垂直特征切片的次数相比，您更换技术的次数相形见绌。

所以我想这个问题会问你，你如何命名你的包，为什么？请理解，我不一定认为我在这里偶然发现了金鹅或其他东西。我对这一切都很陌生，主要是学术经验。但是，我无法发现我的推理中的漏洞，所以我希望你们都可以，这样我就可以继续前进。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-10T22:27:28.103

对于包装设计，我首先按层划分，然后按其他功能划分。

还有一些额外的规则：

1.  层从最一般（底部）到最具体（顶部）堆叠
2.  每层都有一个公共接口（抽象）
3.  一层只能依赖另一层的公共接口（封装）
4.  一个层只能依赖于更一般的层（从上到下的依赖关系）
5.  一个层最好依赖于它正下方的层

因此，例如，对于 Web 应用程序，您的应用程序层中可能有以下层（从上到下）：

*   表示层：生成将在客户端层中显示的 UI
*   应用层：包含特定于应用程序的逻辑，有状态
*   服务层：按领域分组功能，无状态
*   集成层：提供对后端层（db、jms、email...）的访问

对于生成的包布局，这些是一些附加规则：

*   每个包名的根是`<prefix.company>.<appname>.<layer>`
*   层的接口按功能进一步划分：`<root>.<logic>`
*   层的私有实现以私有为前缀：`<root>.private`

这是一个示例布局。

表示层由视图技术划分，并且可选地由（组）应用程序划分。

```
com.company.appname.presentation.internal
com.company.appname.presentation.springmvc.product
com.company.appname.presentation.servlet
... 
```

应用层分为用例。

```
com.company.appname.application.lookupproduct
com.company.appname.application.internal.lookupproduct
com.company.appname.application.editclient
com.company.appname.application.internal.editclient
... 
```

服务层被划分为业务域，受后端层中的域逻辑的影响。

```
com.company.appname.service.clientservice
com.company.appname.service.internal.jmsclientservice
com.company.appname.service.internal.xmlclientservice
com.company.appname.service.productservice
... 
```

集成层分为“技术”和访问对象。

```
com.company.appname.integration.jmsgateway
com.company.appname.integration.internal.mqjmsgateway
com.company.appname.integration.productdao
com.company.appname.integration.internal.dbproductdao
com.company.appname.integration.internal.mockproductdao
... 
```

像这样分离包的优点是更容易管理复杂性，并且增加了可测试性和可重用性。虽然这看起来像是很多开销，但根据我的经验，它实际上非常自然，并且在这个结构（或类似结构）上工作的每个人都可以在几天内完成它。

为什么我认为垂直方法不太好？

在分层模型中，几个不同的高层模块可以使用同一个底层模块。例如：可以为同一个应用构建多个视图，多个应用可以使用同一个服务，多个服务可以使用同一个网关。这里的诀窍是，当通过层移动时，功能级别会发生变化。更具体层中的模块不会在更通用层的模块上映射 1-1，因为它们表达的功能级别不会映射 1-1。

当您使用垂直方法进行包装设计时，即首先按功能划分，然后将具有不同功能*级别*的所有构建块强制放入相同的“功能外套”中。您可以为更具体的模块设计通用模块。但这违反了更一般的层不应该知道更具体的层的重要原则。例如，服务层不应该以应用层的概念为模型。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-10T17:35:29.100

我发现自己坚持鲍勃叔叔的[包装设计原则](https://en.wikipedia.org/wiki/Package_principles)。简而言之，要一起重用和一起更改的类（出于相同的原因，例如依赖项更改或框架更改）应该放在同一个包中。IMO，在大多数应用程序中，功能分解比垂直/业务特定分解更有可能实现这些目标。

例如，领域对象的水平切片可以被不同类型的前端甚至应用程序重用，而当底层 Web 框架需要更改时，Web 前端的水平切片可能会一起更改。另一方面，如果将跨不同功能区域的类分组在这些包中，则很容易想象这些更改在许多包中的连锁反应。

显然，并非所有类型的软件都是相同的，并且在某些项目中垂直分解可能是有意义的（就实现可重用性和可更改性的目标而言）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-10T17:44:15.367

通常存在两个级别的划分。从顶部开始，有部署单元。这些被命名为“逻辑上”（用你的话说，想想 Eclipse 特性）。在部署单元内部，您可以对包进行功能划分（想想 Eclipse 插件）。

例如，功能是`com.feature`，它由`com.feature.client`、`com.feature.core`和`com.feature.ui`插件组成。在插件内部，我对其他包的划分很少，尽管这也并不罕见。

**更新：**顺便说一句，Juergen Hoeller 在 InfoQ 上有关于代码组织的精彩演讲：http: [//www.infoq.com/presentations/code-organization-large-projects](http://www.infoq.com/presentations/code-organization-large-projects)。Juergen 是 Spring 的架构师之一，并且对这些东西非常了解。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-10T17:00:31.353

我从事的大多数 java 项目首先从功能上对 java 包进行切片，然后再从逻辑上切片。

通常部分足够大，以至于它们被分解成单独的构建工件，您可以将核心功能放入一个 jar，将 apis 放入另一个 jar，将 Web 前端内容放入 warfile 等。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-10T17:14:12.473

包将作为一个单元进行编译和分发。在考虑哪些类属于一个包时，关键标准之一是它的依赖关系。此类依赖于哪些其他包（包括第三方库）。一个组织良好的系统会将具有相似依赖关系的类聚集在一个包中。这限制了对一个库的更改的影响，因为只有少数定义明确的包会依赖它。

听起来您的逻辑垂直系统可能倾向于“涂抹”大多数包之间的依赖关系。也就是说，如果每个功能都打包为一个垂直切片，那么每个包都将依赖于您使用的每个第三方库。对库的任何更改都可能波及整个系统。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-13T22:12:44.243

我个人更喜欢对类进行逻辑分组，然后在其中包含每个功能参与的子包。

## 包装目标

包毕竟是将事物组合在一起 - 相关类的想法彼此靠近。如果他们住在同一个包中，他们可以利用包私有来限制可见性。问题是将所有视图和持久性内容集中到一个包中可能会导致许多类混入一个包中。因此，下一个明智的做法是创建视图、持久性、util 子包并相应地重构类。不幸的是，受保护的包私有作用域不支持当前包和子包的概念，因为这将有助于执行此类可见性规则。

我现在通过功能看到了分离的价值，因为对所有与视图相关的东西进行分组有什么价值。此命名策略中的事物与视图中的某些类断开连接，而另一些则处于持久性等等。

## 我的逻辑包装结构示例

为了说明的目的，让我们命名两个模块 - 将名称模块用作将类分组到包树的特定分支下的概念。

apple.model apple.store 香蕉.model 香蕉.store

## 优点

使用 Banana.store.BananaStore 的客户端只暴露给我们希望提供的功能。hibernate 版本是一个实现细节，他们不需要知道也不应该看到这些类，因为它们给存储操作增加了混乱。

## 其他逻辑 v 功能优势

越靠近根，范围就越广，属于一个包的东西开始表现出越来越多的依赖于属于她的模块的东西。例如，如果要检查“香蕉”模块，大多数依赖项将仅限于该模块内。事实上，“香蕉”下的大多数助手根本不会在这个包范围之外被引用。

## 为什么是功能？

通过基于功能将事物集中起来可以实现什么价值。在这种情况下，大多数类相互独立，很少或不需要利用包私有方法或类。将它们重构到自己的子包中几乎没有什么好处，但确实有助于减少混乱。

## 开发人员对系统的更改

当开发人员的任务是进行不那么微不足道的更改时，他们可能会进行包含来自包树所有区域的文件的更改，这似乎很愚蠢。使用逻辑结构化方法，它们的更改在包树的同一部分内更加本地化，​​这似乎是正确的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-09-13T17:56:55.007

***包装的功能***（架构）和***逻辑***（特性）方法都有一席之地。许多示例应用程序（那些在教科书等中找到的应用程序）遵循将表示、业务服务、数据映射和其他架构层放入单独的包中的功能方法。在示例应用程序中，每个包通常只有几个或只有一个类。

这种初始方法很好，因为一个人为的示例通常用于：1）从概念上绘制出所呈现框架的架构，2）这样做是出于单一的逻辑目的（例如从诊所添加/删除/更新/删除宠物） . 问题是许多读者将此视为没有界限的标准。

随着“业务”应用程序扩展到包含越来越多的功能，遵循***功能***方法成为一种负担。虽然我知道在哪里寻找基于架构层的类型（例如“web”或“ui”包下的 web 控制器等），但开发单个***逻辑***功能开始需要在多个包之间来回跳转。至少，这很麻烦，但比这更糟。

由于逻辑上相关的类型没有打包在一起，API过于公开；逻辑相关类型之间的交互被强制为“公共”，以便类型可以导入并相互交互（失去了最小化默认/包可见性的能力）。

如果我正在构建一个框架库，我的包无论如何都将遵循功能/架构打包方法。我的 API 消费者甚至可能会欣赏他们的导入语句包含以架构命名的直观包。

相反，在构建业务应用程序时，我将按功能打包。我可以将 Widget、WidgetService 和 WidgetController 都放在同一个“ *com.myorg.widget.* ”包中，然后利用默认可见性（并且具有更少的导入语句以及包间依赖项）。

但是，也有交叉的情况。如果我的 WidgetService 被许多逻辑域（功能）使用，我可能会创建一个“ *com.myorg.common.service.* ”包。还有一个很好的机会是，我创建类的目的是为了跨功能重用，并最终得到诸如“ *com.myorg.common.ui.helpers.* ”和“ *com.myorg.common.util.* ”之类的包。我什至可能最终将所有这些后来的“通用”类移动到一个单独的项目中，并将它们作为 myorg-commons.jar 依赖项包含在我的业务应用程序中。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-10T16:51:23.980

这取决于您的逻辑流程的粒度？

如果它们是独立的，您通常会在源代码控制中为它们创建一个新项目，而不是一个新包。

我目前正在进行的项目在逻辑拆分方面犯了错误，有一个用于 jython 方面的包，一个用于规则引擎的包，用于 foo、bar、binglewozzle 等的包。我正在考虑使用特定于 XML 的解析器/writers 用于该包中的每个模块，而不是拥有一个 XML 包（我之前做过），尽管仍然会有一个核心 XML 包用于共享逻辑。然而，这样做的一个原因是它可能是可扩展的（插件），因此每个插件还需要定义其 XML（或数据库等）代码，因此集中这可能会在以后引入问题。

最后，这似乎是对特定项目最明智的方式。但是，我认为按照典型项目分层图的方式进行打包很容易。您最终会得到逻辑和功能包装的混合。

需要的是标记的命名空间。一些 Jython 功能的 XML 解析器可以同时标记 Jython 和 XML，而不必选择其中之一。

或者，也许我在颤抖。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-10T17:42:49.787

我尝试以这样一种方式设计包结构，即如果我要绘制依赖关系图，它会很容易遵循并使用一致的模式，并且尽可能少地循环引用。

对我来说，这在垂直命名系统中比在水平命名系统中更容易维护和可视化。如果 component1.display 有对 component2.dataaccess 的引用，这会比 display.component1 有对 dataaccess 的引用发出更多的警告。组件2。

当然，两者共享的组件都放在自己的包中。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-04-16T15:36:41.583

我完全遵循并提出逻辑（“按功能”）组织！一个包应该尽可能地遵循“模块”的概念。职能组织可能会将一个模块分散到一个项目中，导致封装较少，并且易于更改实现细节。

让我们以一个 Eclipse 插件为例：将所有视图或操作放在一个包中会一团糟。相反，一个特性的每个组件都应该进入特性的包，或者如果有很多，则进入子包（featureA.handlers、featureA.preferences 等）

当然，问题在于分层包系统（其中包括 Java 有），这使得正交关注点的处理变得不可能或至少非常困难——尽管它们无处不在！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-04-28T19:23:07.827

完全不使用包（根包除外）是一个有趣的实验。

那么出现的问题是，何时以及为什么引入软件包是有意义的。据推测，答案将与您在项目开始时回答的不同。

我认为您的问题完全出现了，因为包就像类别，有时很难决定其中一个。有时标签会更适合传达一个类在许多上下文中可用的信息。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-10T17:09:59.443

我个人会选择功能命名。简短的原因：它避免了代码重复或依赖噩梦。

让我详细说明一下。当您使用带有自己的包树的外部 jar 文件时会发生什么？您正在有效地将（编译的）代码导入到您的项目中，并带有一个（功能分离的）包树。同时使用这两种命名约定是否有意义？不，除非那是对你隐藏的。如果你的项目足够小并且只有一个组件，它就是这样。但是如果你有几个逻辑单元，你可能不想重新实现，比如说数据文件加载模块。您希望在逻辑单元之间共享它，在逻辑上不相关的单元之间没有人为的依赖关系，并且不必选择要将特定共享工具放入哪个单元。

我想这就是为什么功能命名最常用于达到或打算达到一定大小的项目中，并且在类命名约定中使用逻辑命名来跟踪特定角色，如果每个类中的任何一个包裹。

我将尝试更准确地回应您关于逻辑命名的每一点。

1.  如果您在计划更改时必须在旧类中钓鱼以修改功能，这是抽象不良的标志：您应该构建提供明确定义的功能的类，可以在一个简短的句子中定义。只有少数顶级课程应该组合所有这些以反映您的商业智能。这样，您将能够重用更多代码、更容易维护、更清晰的文档和更少的依赖问题。

2.  这主要取决于您了解项目的方式。当然，逻辑和功能视图是正交的。因此，如果您使用一种命名约定，则需要将另一种应用于类名以保持某种顺序，或者在某个深度从一种命名约定分叉到另一种命名约定。

3.  访问修饰符是允许其他了解您的*处理*的类访问您的类的内部的好方法。逻辑关系并不意味着理解算法或并发约束。功能可能，虽然它没有。我非常厌倦除公共和私有之外的访问修饰符，因为它们经常隐藏缺乏适当的架构和类抽象。

4.  在大型商业项目中，技术变化比您想象的更频繁。例如，我已经更改了 3 次 XML 解析器、2 次缓存技术和 2 次地理定位软件。幸好我把所有的细节都藏在了一个专门的包里……

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-10T18:16:24.993

这取决于。在我的工作中，我们有时会按功能（数据访问、分析）或资产类别（信贷、股票、利率）来拆分包。只需选择对您的团队最方便的结构。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-10T17:10:31.970

从纯粹实用的角度来看，java 的可见性构造允许同一包中的类访问具有可见性`protected`以及`default`可见性的方法和属性`public`。从完全不同的代码层使用非公共方法肯定会产生很大的代码气味。所以我倾向于将同一层的类放入同一个包中。

我不经常在其他地方使用这些受保护或默认的方法——除了可能在类的单元测试中——但是当我这样做时，它*总是*来自同一层的一个类

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2013-07-02T23:21:17.083

根据我的经验，可重用性带来的问题多于解决问题。使用最新且便宜的处理器和内存，我更喜欢重复代码而不是紧密集成以重用。

# wpf - 在 WPF RichTextBox 中插入图像

> ID：533103
> 
> 赞同：2
> 
> 时间：2009-02-10T16:38:13.590
> 
> 标签：wpf, richtextbox, image-formats

嗨，我使用以下代码插入文本和图像，但我想在 MSWord 中将图像“文本后面”插入为 Image>Adjust with Text 属性

```
{
            int numeroInforme = Convert.ToInt32(txtNroInforme.Text);
            List<informeMedico> lstInformes = getInformeMedico(numeroInforme);

            FlowDocument mcFlowDoc = new FlowDocument();

            Paragraph para = new Paragraph();

            foreach (informeMedico info in lstInformes)
            {
                var signatureOne = BinaryImageConverter(info.firma1);
                var signatureTwo = BinaryImageConverter(info.firma2);

                para.Inlines.Add(new Run("RM Nro:" + "\t" + info.numeroinforme.ToString()));
                para.Inlines.Add(new Run("\n\n"));

                para.Inlines.Add(new Run("Sr. Dr.  :" + "\t" + info.medicoCompleto.ToString()));
                para.Inlines.Add(new Run("\n\n"));

                para.Inlines.Add(new Run("NOMBRE :" + "\t" + info.pacienteCompleto.ToString()));
                para.Inlines.Add(new Run("\n\n"));

                para.Inlines.Add(new Run("EXAMEN :" + "\t" + info.estudioExamenNombre.ToString()));
                para.Inlines.Add(new Run("\n\n"));

                para.Inlines.Add(new Run("FECHA :" + "\t" + info.fechainforme.ToString()));
                para.Inlines.Add(new Run("\n\n"));

                para.Inlines.Add(new Run(info.tecnica));
                para.Inlines.Add(new Run("\n\n"));

                para.Inlines.Add(new Run(info.hallazgo));
                para.Inlines.Add(new Run("\n\n"));

                para.Inlines.Add(new Run(info.conclusion));
                para.Inlines.Add(new Run("\n\n"));

                para.Inlines.Add(signatureOne);
                para.Inlines.Add(signatureTwo);
            }

            mcFlowDoc.Blocks.Add(para);

            mainRTB.Document = mcFlowDoc;

        } 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T21:15:39.700

您可以将Paragraph[或](http://msdn.microsoft.com/en-us/library/system.windows.documents.paragraph.aspx)单个[Runs的](http://msdn.microsoft.com/en-us/library/system.windows.documents.run.aspx)[背景](http://msdn.microsoft.com/en-us/library/system.windows.documents.textelement.background.aspx)设置为[ImageBrush](http://msdn.microsoft.com/en-us/library/system.windows.media.imagebrush.aspx)：

```
<Grid xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid.Resources>
        <FlowDocument x:Key="document">
            <Paragraph>
                <Paragraph.Background>
                    <ImageBrush ImageSource="http://sipi.usc.edu/database/misc/4.1.01.tiff" Stretch="UniformToFill"/>
                </Paragraph.Background>
                <Run Foreground="White" Text="this is some text"/>
                <LineBreak/>
                <Run Foreground="White" Text="and some more text"/>
            </Paragraph>
        </FlowDocument>
    </Grid.Resources>
    <FlowDocumentReader Document="{StaticResource document}"/>
</Grid> 
```

# c# - 如何根据下拉列表更改 url？

> ID：533111
> 
> 赞同：0
> 
> 时间：2009-02-10T16:39:45.677
> 
> 标签：c#, .net, asp.net

我正在使用下拉列表来选择一些选项。一切正常，我只需要更改 URL 中的名称。有没有办法仅根据选项更改 URL？

默认彪马 -

```
Default.aspx?Dept=Shoes&Type=Puma 
```

如果选择耐克 -

```
Default.aspx?Dept=Shoes&Type=Nike 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T16:47:50.557

要在服务器上处理此问题，您可以启用控件的 autopostback 属性并创建 SelectedIndexChanged 事件以调用方法来识别所选选项并根据此选择进行重定向。

```
protected void DropDownList1_SelectedIndexChanged(object sender, EventArgs e)
{
    Response.Redirect(string.Format("Default.aspx?Dept=Shoes&Type={0}", this.DropDownList1.SelectedValue), true);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T16:47:25.987

进一步来说

```
<select onchange="window.location.href=this.options[this.selectedIndex].value;">
  <option value="#">--  Select a Search Engine ---</option>
  <option value="http://www.live.com">Live Search</option>
  <option value="http://www.google.com">Google</option>
</select> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T16:42:09.743

您将要使用 Javascript 来执行此操作。您可以`window.location`从 Javascript 进行更改，它会将您重定向到您将其更改为的任何内容。

这是一种不显眼的方法：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>test</title>
    </head>
    <body>
        <select id="dd">
            <option value="http://example.com/first">first</option>
            <option value="http://example.com/second">second</option>
        </select>
        <script type="text/javascript">
            if (dd = document.getElementById("dd")) {   
                dd.onchange = function() {
                    window.location = dd.options[dd.selectedIndex].value;
                }
            }
        </script>
    </body>
</html> 
```

# python - 如何集成 Django 和 Cygwin？

> ID：533125
> 
> 赞同：10
> 
> 时间：2009-02-10T16:42:14.160
> 
> 标签：python, django, cygwin

我有一个安装了 cygwin、python 和 django 的 Windows 机器。

现在我想运行 django-admin，但是当我这样做时，我得到了错误：

```
$ django-admin.py
c:\Python26\python.exe: can't open file '/usr/bin/django-admin.py': [Errno 2] No such file or directory 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T16:53:05.880

从[这里](http://docs.djangoproject.com/en/dev/ref/django-admin/?from=olddocs)

> 对于没有可用符号链接功能的 Windows 用户，您可以将 django-admin.py 复制到现有路径上的某个位置或编辑 PATH 设置（在设置 - 控制面板 - 系统 - 高级 - 环境...下）指向到其安装位置。

希望这可以帮助

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T22:11:14.790

我刚刚遇到了完全相同的问题。我发现如果你已经安装了 windows 版本的 python，它似乎比 cygwin 版本优先。我通过编辑 /etc/profile 解决了这个问题并更改了：

```
PATH=/usr/local/bin:/usr/bin:/bin:/usr/X11R6/bin:$PATH 
```

...至：

```
PATH=/usr/local/bin:/usr/bin:/bin:/usr/X11R6/bin: 
```

...我*认为*这会阻止 cygwin 添加正常的 Windows 路径。完成后，将 django 下载到某个目录，移动到该目录并键入：

```
python setup.py install 
```

我一开始就遇到了问题，因为我一开始就省略了“python”位

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T06:58:35.357

至于如何在 cygwin 中启动 django 的步骤

首先打开您的 Windows 命令提示符，然后通过执行以下操作注册 python 环境：

```
Path %path%;C:\Python27;C:\Python27\Scripts 
```

然后现在去你的cygwin的安装文件夹

```
cd C:\cygwin 
```

然后像这样运行**cygwin.bat**：

```
C:\cygwin>cygwin.bat    <enter> 
```

然后 cygwin 将打开，然后键入**python**以查看它现在是否工作

```
$ python 
```

瞧，我们完成了！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T18:34:32.537

就像 Brian 提到的那样，您正在运行 Windows 版本的 Python，它不适用于 Cygwin 安装。

一句警告。当我第一次开始使用 Django 时，我尝试在 Cygwin 中安装它，但遇到了各种问题，最终切换到了 Python 的常规 Windows 版本。不幸的是，我没有记录我所有的问题，但我记得其中一些与数据库有关。无论如何，那是几个月前，我对 Django 的了解比现在还少。也许我遇到的问题已经解决了，也许现在我知道更多我可以让它工作，但是在 Cygwin 上运行 Django 似乎是一条少有人走的路。祝你好运。:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-15T06:22:40.687

将 django/bin 文件夹（或保存 django-admin.py 的其他位置）的位置添加到 PYTHONPATH 环境变量中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T21:50:41.463

帮助我们帮助您。您是否有理由运行 windows python 解释器 (c:\Python26\python.exe) 而不是 cygwin python 解释器 (/usr/bin/python.exe)？那可能是你的问题。因此，要解决此问题，您可能会考虑删除 Windows 本机解释器，或者只是确保 cygwin 路径列在 Windows 全局 PATH 变量中的 c:\Python26 路径之前。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T21:28:46.323

听起来有点像 Windows 版本的 Python 正在尝试运行而不是 cygwin 版本。如果您键入以下内容会发生什么：

```
$ python django-admin.py 
```

在这里我假设

```
$ which python 
```

查找 python 的 cygwin 版本（类似于 /usr/bin/python）。

您也可以尝试（暂时）卸载 windows 版本的 python 并仅使用 cygwin。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-13T06:52:37.447

只需将**django-admin.py**复制到您正在处理的当前位置，例如

在 Cygwin 上：

```
<root>/projects/ 
```

在你的 windows 目录上，它看起来像这样：

```
C:\cygwin\home\<your computer name>\projects\ 
```

复制文件后，您可以通过键入以下命令来创建项目：

```
$ python django-admin.py startproject mysite 
```

仅此而已 - 您已经使用 Cygwin 类 linux 环境完成了您的第一个项目。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-08-23T04:07:56.257

`.bash_profile`在和`.bashrc`文件中添加两行（[在此处](https://apple.stackexchange.com/questions/51036/what-is-the-difference-between-bash-profile-and-bashrc)查看它们的区别）。您可以在以下位置找到它们`C:\cygwin\home\[username]`：

```
export PATH=$PATH:/cygdrive/c/python2.7
export PYTHONPATH=$PYTHONPATH:/cygdrive/c/python2.7/Lib/site-packages 
```

希望这可以帮助

# project-management - 项目文件？

> ID：533126
> 
> 赞同：12
> 
> 时间：2009-02-10T16:42:29.087
> 
> 标签：project-management, project

我在一家获得 CMMI 5 级认证的公司工作，我讨厌的一件事是我们准备的文件数量（作为程序员，我已经讨厌文件）。我们有很多文件，如 PID（项目启动文档）、业务需求、系统要求、技术规范、代码审查清单、问题日志、缺陷日志、配置管理计划、配置管理检查清单、发布文档和批次...

几乎 90% 的这些文档都是为了 QA 审核而完成的 :) .. 您认为项目最重要的文档是什么？从长远来看，其他开发人员可以使用哪些文档？

请在这里分享您的良好做法。我想将它们用于我自己的项目或我计划长期创办的公司。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-10T16:47:20.603

关键文件是一个[很好的功能规范。](http://www.joelonsoftware.com/articles/fog0000000036.html) 一个系统应该***只有一个***参考文档。

每当有人更改系统或界面时，过度的文档就会激增大量的小需求和规范文档。对于任何复杂的系统，不久之后您的规范就会分布在数百个各种单词、excel、visio 甚至是 powerpoint 文件中。发生这种情况时，您会不清楚什么是最新的，甚至您是否已经找到并识别了所有相关文档。

BRD-SRD-Tech 规范进展基于以下假设：业务签署 BRD，业务分析师根据 BRD 中记录的要求签署 SRD，并且技术规范根据 SRD 签署。这会生成一个签核网络、包含冗余信息的多个文档，并且使规范文档保持最新变得困难和笨拙。

正因为如此，后续的需求文档往往采用一系列变更请求和补充需求和规范文档的形式，每个文档都有自己的签字和审核流程。您获得了 CYA 和审计跟踪（或至少是审计跟踪的外观），但您失去了清晰度。目前该系统没有明确的参考文件，很难确定什么是当前的或与任何特定活动相关的。最终结果是您的业务分析过程陷入了取证研究的困境，这增加了交付计划的开销和延迟。

规范文档应该以这样一种方式构建，即任何给定的系统或子系统都有一个明确的参考。该文档应保持最新并进行版本控制。获得像[Framemaker这样](http://www.adobe.com/products/framemaker/)[好的技术文档工具](https://stackoverflow.com/questions/371654/application-not-a-markup-language-for-producing-a-user-manual/372017#372017)，这样您的流程就可以扩展，并且文档具有 Word 所缺乏的那种结构完整性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T16:48:00.510

对我来说，我唯一使用过的真实文档是规范。越详细越好。不过不需要一次性全部完成，也不需要特别正式。对我来说，比经过检查和签名以及双重检查和双重签名的文档更有用的是始终能够获得最新版本的文档。并且能够与人们谈论他们所写的内容，并在有任何歧义的情况下做出决定。这对我来说比其他任何东西都更有用。

总而言之：规范是我发现的唯一有用的文档，但是与拥有一个完全了解所提议系统的项目经理相比，它相形见绌，并且可以根据他们所知道的做出明智的决定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T17:06:27.830

文档就像豆腐——大多数人讨厌它，直到他们意识到在适当的条件下，它可能真的很好。

问题是您认为文档主要是为了文档而制作的。作为开发人员，您不会在您生成的文档中看到任何直接价值，因为您知道您可以在没有您需要制作的所有 TPS 报告的情况下完成您的工作。

不幸的是，我敢打赌，在一家你一直被迫吃生豆腐的公司里，你无能为力。您可能只需要吸收它并编写公司需要的文档，但是您至少可以做一件事……您可以编写至少对*您*有用的文档，并且可以将它们与您的其他维护它的人的代码。

除了内联文档之外，您还可以设置一个 wiki 供您自己和团队成员使用。这种类型的文档是**可搜索**的，这对开发人员来说已经是一个很大的优势，而且它更像是一个活的文档，而不是你必须写的类似家庭作业的论文。您已经发布到 SO，因此只需将您的文档视为将您的知识集中在一个更有用的地方。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T16:48:30.227

> 您认为项目最重要的文件是什么？

不同的人有不同的需求：例如所有者需要的文件（例如业务合同）与QA 需要的文件不同。

> 从长远来看，其他开发人员可以使用哪些文档？

IMO 最重要的文档（源代码除外）是功能规范：因为软件**应**该做什么（而不是它**正在**做什么）是一件事，不一定是逆向工程。另请参阅[优秀的开发人员如何避免创建总线命中率低的代码？](https://stackoverflow.com/questions/400382/how-does-a-good-developer-keep-from-creating-code-with-a-high-bus-hit-factor/400436#400436)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T16:49:53.953

用户故事、燃尽图、代码

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T16:50:21.660

从项目的角度来看，最重要的文件是那些通常包含“计划”一词的文件，例如项目计划、配置管理计划、质量计划等。

您所描述的内容在流程改进中很常见，并且通常响应两个主要原因。一是该系统确实是过度教育并妨碍了正在完成的实际工作。您的问题实际上回答了另一个问题：并非只是为了审计而编写文件，您的重点不应该只是文档对其他开发人员有多大用处，而应该是对项目或整个公司有用。

一个人通常从自己的角度看事情，有时需要看大局。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-11T12:56:02.917

我是旧的 4+1 视图的粉丝：

*   用例视图（a/k/a 用户故事）。有几种形式：正确的用例、没有很好定义的前瞻性用例和需要分解的史诗。

*   逻辑视图。“静态”视图。UML 类图等在这里作为设计文档工作得很好。这还包括各种协议的请求和响应格式。这是我们记录 RESTful 请求和响应的地方。这包括 REST URI 设计。

*   进程视图。“动态”视图。UML 活动图、序列图和状态图等在这里用于设计文档。在某些情况下，简单的叙述效果很好。在其他情况下，有一种**状态**设计模式，它需要结合类图和状态图来显示有状态对象如何交互。

    这也包括协议（例如 REST）。这是我们为各种 REST 请求定义任何特殊处理的地方。

    这还包括身份验证或授权规则，以及任何其他横切方面，如安全、日志记录等。

*   组件视图。我们为部署而构建的部分。这包括我们依赖的东西，模块和包的结构等。这通常是一个简单的组件图或组件列表及其依赖项。

*   部署视图。我们尝试从部署的代码中生成它。由于我们使用的是 Python，因此我们使用 epydoc 来创建 API 文档。我们还使用 Sphinx 将模块文档导入到该软件视图中。

    这还包括参数、设置和配置详细信息。

然而，这还不够。

当项目开始时，您必须通过一系列冲刺来完成这一目标。

1.  第一个 sprint 只构建用例视图。

2.  随后的冲刺构建一个“架构”来实现用例。架构文档有 4+1 视图，但处于高抽象级别。它总结了模型模式的结构、请求和回复、RESTful 处理、其他处理、预期的组件等。它从来没有部署视图。我们通常将操作员指南和 API 文档作为架构的部署视图。

3.  然后设计和施工冲刺为各种组件构建（和更新）详细的 4+1 视图文档。

4.  然后发布 sprint 构建（和更新）部署视图。

# asp.net - 在商业环境中创新使用社交网络

> ID：533132
> 
> 赞同：2
> 
> 时间：2009-02-10T16:43:36.777
> 
> 标签：asp.net, sharepoint, social-networking

我正在寻找一些在纯商业环境中创新使用社交网络的例子。我可以看到 Twitter 对微博的任何用途（应用程序事件日志在其他想法中浮现）。

有没有人想分享更多的例子或想法，以便我们可以将这种技术嵌入到我们的基础设施中。

作为参考，我们是一个主要使用 Microsoft 技术（SharePoint、VS 2008、ASP.Net 等）的组织。

随意参考特定的代码示例、教程或只是对商业环境中的社交网络概念发表主观评论。

目前正在查看的网站包括：Facebook、Twitter、LinkedIn 和谷歌地图。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T10:41:18.713

很好的例子[http://brandonhallawards.com/08/958-BLOGS-Sun.doc](http://brandonhallawards.com/08/958-BLOGS-Sun.doc)

顺便问一下，还有其他人吗？我也很感兴趣。- 回声

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T16:53:52.260

稍加努力，您就可以将`Captcha`这些老式色盲卡片用于空军招募。

你甚至可以在网上做！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T16:54:14.207

不要忘记在公司环境中使用 IM 的非常普遍的做法。它通常比电话或邮件更容易，即使 IT 安全人员通常不允许这样做。诚然，它可能不是真正的*创新*，但*颠覆性*因素很重要，恕我直言。

# jquery - 通过迭代链接 JQuery 动画

> ID：533134
> 
> 赞同：1
> 
> 时间：2009-02-10T16:43:46.370
> 
> 标签：jquery

我有许多彼此相邻的 div（水平），并且想要按顺序排列每个 div 的宽度。理想情况下，它们应该看起来像一个从左侧向右延伸的长 div。我的问题是它们都开始同时增长。每个 div 的名称为 'div'，末尾有一个数字，我使用 'i' 作为那个数字。这应该是动态的，因为我不知道“我”会是什么。我可以通过迭代将其链接起来吗？谢谢你。

```
for (i = 0; i <= count; i++)
    {
        $('#div' + i).animate( {
            "width": "toggle"
        }, 1500 );
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T16:51:01.627

使用 animate 函数的回调来启动下一个操作

```
<script type="text/javascript">
  $.curDiv = 0;    
  continueAnimation = function()
  {
      $('div' + $.curDiv++).animate( { "width": "toggle" }, 1500, continueAnimation);   
  }
  continueAnimation();
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T22:10:29.730

我最终制作了一个单独的函数，该函数将调用 div 上的动画然后调用自身。正如它自称的那样，它会增加一个计数器，我将计数器与我的总值进行比较，并在需要时停止循环。

# c - 存储一个 Lua 函数？

> ID：533136
> 
> 赞同：22
> 
> 时间：2009-02-10T16:43:56.400
> 
> 标签：c, function, lua

[从 C 中调用 Lua 函数](http://www.lua.org/manual/5.1/manual.html#lua_call)相当简单，但有没有办法将 Lua 函数*存储*在某个地方以备后用？我想存储传递给我的 C 函数的用户定义的 Lua 函数以用于事件，类似于[Connect 函数在 wxLua 中](http://wxlua.sourceforge.net/)的工作方式。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-10T17:27:31.850

检查注册表 ( `luaL_ref()`)。它管理一个简单的表，让您可以存储任何 Lua 值（如函数），并通过简单的整数从 C 中引用它。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-04T20:18:52.853

基于 Javier 的回答，Lua 有一个特殊的通用可访问表，称为注册表，可通过 C API 使用 pseudo-index 进行访问`LUA_REGISTRYINDEX`。您可以使用该`luaL_ref`函数在注册表中存储您喜欢的任何 Lua 值（包括 Lua 函数），并从 C 中接收可用于引用它的整数：

```
// Assumes that the function you want to store is on the top of stack L
int function_index = luaL_ref(L, LUA_REGISTRYINDEX); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T17:31:01.437

最简单的方法是让您的函数采用“名称”和 lua 函数文本。然后在解释器中创建一个表（如果它不存在），然后使用命名参数将函数存储在表中。

在您的应用程序中，只需保留与每个事件相关的函数名称列表。当事件触发时，只需调用表中键与列表中名称匹配的所有函数。

# css - 字体颜色未在 DOTNETNUKE 上的容器中设置

> ID：533140
> 
> 赞同：1
> 
> 时间：2009-02-10T16:44:34.387
> 
> 标签：css, dotnetnuke

标题和正文具有正确的背景颜色，但字体看起来是灰色的。我在 DOTNETNUKE 版本 4.9.0 和 4.9.1 以及 Windows 2003 上运行。

谢谢

测试.htm

```
<body class="border">
    <div class="PhilosophyHeader" runat="server">[ACTIONS][ICON]  [TITLE]</div>
    <div id="ContentPane" runat="server" class="PhilosophyBody"></div>
</body> 
```

容器.css

```
.PhilosophyHeader
{
    color: #FF0000;
    font: normal normal bold 100%/normal serif;
    border: thin #CC9900;
    background-color: #CC9900;
}

.PhilosophyBody
{
    background-color: #800000;
    color: #CC9900;
}

.border
{
    border: thin #FFFF00 solid;
} 
```

编辑：删除`<header>`，它没有影响问题。

回答：问题是标签的组合不匹配并且在两个容器中使用了相同的名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T17:16:54.637

这可能是由各种问题引起的。如果没有网站可以查看，这里的任何人都很难回答您的问题。

诊断此类 CSS 问题的最简单方法之一是使用 Firefox 扩展[Firebug](http://getfirebug.com/)。检查显示为灰色的文本，并准确查看应用了哪些样式。样式以从下到上的层次结构显示。

我不知道您是否只是以这种方式为 Stack Overflow 格式化了您的示例，但您不应该在容器中包含`<head>`or`<body>`标记。`container.css`如果调用的 CSS 文件与容器 HTML 或 ASCX 文件位于同一目录中，DotNetNuke 将自动加载该文件。它将另外加载与正在加载的容器同名的任何 CSS 文件。例如，如果您有一个名为 的容器`MyContainer.ascx`，DotNetNuke 将自动加载`container.css`和`MyContainer.css`，前提是它们存在。

# c# - 迁移到 VSTO/Excel 互操作选项

> ID：533163
> 
> 赞同：0
> 
> 时间：2009-02-10T16:49:41.440
> 
> 标签：c#, .net, excel, interop, vsto

我们目前有一个包含大量 VBA 代码的 Excel 电子表格。VBA 代码负责：

*   操作、转换和格式化工作表数据。
*   调用 C# 和 C++ COM 公开的功能。在这样做时，将工作表数据编组到 C#/C++ 方法中，获取结果并使用结果更新工作表。

以及其他所需的实用程序代码。

我们现在想向 Excel 工作簿添加一个新工作表，并且不需要任何 VBA。我们想使用 C#。正如我所看到的，我仅限于以下选项：

*   将整个项目移植到 VSTO 手动将 VBA 重新编码为 VSTO 项目中的 C#。
*   用 C# 编写新工作表的功能并通过 COM 公开它。C# 代码将使用 Excel PIA 来更新工作表。该工作表需要一个非常薄的 VBA 层来将数据编组到 C# 方法。

我认为 ManagedXLL 不会在这方面对我有所帮助，因为我的代码要求与处理工作表数据有关，而与使用结果更新工作表有关。

请评论/询问更多细节。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T17:10:52.187

你忘了：

*   将整个项目移植到 VSTO，将现有代码移植到 VB.Net（其中一些只会复制/粘贴）并用 C# 编写新代码。
*   将新工作表放在单独的工作簿中，并将旧工作簿作为数据源调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-24T22:08:13.593

看看你是否需要我的建议......在开发方面可能需要更长的时间，但是......无论你使用 VB.Net 还是 C# 都采用这种方法......

1.  做一个喜欢的转换。对于具有最少或没有文档的大量 VBA，这将帮助您了解有时令人费解的逻辑和数据解析方法。

2.  逐个单元格迭代更改单元格的所有实例，并循环读取一次写入表一次类型的方法。这将涉及重写代码部分。在方法开始时读取所有道具和值，并在最后写入所有要返回的道具和值。

3.  确保所有数据和逻辑处理在 .net 中使用 .net 数据类型完成，不要直接在循环内使用范围对象或工作表对象属性，这只是代价高昂的方式。

4.  最后确保如果您使用多个线程，则在主线程上执行所有“Excel 工作”。

5.  阅读 SO 以获取有关正确处理 COM 对象的许多提示。谨防错误的处置模式。

# caching - 如何强制从搜索引擎索引中删除页面？

> ID：533165
> 
> 赞同：3
> 
> 时间：2009-02-10T16:50:06.480
> 
> 标签：caching, search-engine, web-crawler

情况：Google 已将论坛中的页面编入索引。该线程现已删除。我如何/是否可以让谷歌和其他搜索引擎删除缓存的副本？我怀疑他们是否会反对，因为链接页面不再存在，并且保持索引更新和有效应该符合他们的最大利益。

这是可能的还是我必须等待数月才能更新索引？或者页面现在会永远留在那里吗？

我不是相应网站的所有者，因此我无法更改 robots.txt 等示例。我想以“第三方”的身份强制更新。

我还注意到我两天前创建的该资源上的一个新页面已经在缓存中。鉴于此，我可以估计删除此域上的无效页面需要多长时间？

编辑：所以我做了测试。谷歌花了不到 2 个月的时间来删除该页面。很长一段时间...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T16:58:44.820

将其删除几乎是不可能的 - 但是用完全空白的内容替换页面将确保您在页面被重新定位时对页面的排名进行核对。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T16:52:12.933

除非在极端情况下，否则您无法真正让 Google 删除任何内容。您可以调整您的 robots.txt 文件以促进可能会更快更新内容的重访间隔，但如果它是一个低流量站点，您可能不会很快重访。

编辑：由于您不是网站所有者，您可以使用[此处](http://www.seoconsultants.com/meta-tags/revisit-after.asp)讨论的“revisit-after”标签修改页面上的元标签。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T16:59:17.113

您不能让搜索引擎删除该链接，但不要担心该链接很快就会被删除，因为该链接将不再处于活动状态。您无需等待数月即可实现这一目标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T18:59:13.690

如果您的网站已在[Google Webmaster](http://www.google.com/webmasters/)注册，您可以请求从索引中删除页面。它有效，我过去尝试并使用过它。

编辑：由于您不是所有者，因此恐怕此解决方案行不通。

# .net - Dim v As String() 和 Dim v() As String 有什么区别？

> ID：533166
> 
> 赞同：16
> 
> 时间：2009-02-10T16:50:10.880
> 
> 标签：.net, vb.net, arrays

这听起来可能微不足道，但两者之间有什么区别

```
Dim v As String() 
```

和

```
Dim v() As String 
```

在 VB.NET 中？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-10T16:58:44.150

没有不同。来自[VB.NET Language Specification on Arrays](http://msdn.microsoft.com/en-us/library/aa711948.aspx)：

数组类型是通过将修饰符添加到现有**类型名称**来指定的。修饰符由一个左括号、一组零个或多个逗号和一个右括号组成。

...

**也可以通过在变量名称**上放置数组类型修饰符或数组初始化修饰符来将变量声明为数组类型。在这种情况下，数组元素类型是声明中给出的类型，数组维度由变量名修饰符确定。*为清楚起见，在同一声明中同时对变量名和类型名使用数组类型修饰符是无效的*。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-10T17:30:01.983

最初，在 Basic 中，您必须定义数组，而不是变量。变量的类型由后缀字符定义：A$ 是字符串，A% 是整数，A# 是双精度。（并且所有三个都是不同的，可以同时使用）（对于单精度，您可以使用 A!，但如果您只使用 A，则这是默认设置）

最终，程序员开始意识到那些是非常糟糕的设计选择。

为了解决这个问题，Microsoft 添加了“Option Explicit”，它要求您预定义每个变量。为了减少对语言的影响，他们劫持了用于定义数组的“DIM”命令来定义标量变量。

所以原来：

```
 DIM A(50)    ' define 51-element single-precision array 
```

然后

```
 DIM A(50)    ' define 51-element single-precision array
 DIM A$       ' define a string 
```

然后为了摆脱后缀，他们添加了“As {type} 语法”

```
 DIM A(50)    ' define 51-element single-precision array
 DIM B as String 
 DIM C(50) as String ' define 51-element string array. 
```

然后他们使数组大小可变。

```
 DIM A()    ' define single-precision array
 DIM B as String 
 DIM C() as String ' define string array. 
```

这在定义风格上留下了冲突，所以他们允许两者：

```
 DIM A()    ' define single-precision array
 DIM B as String 
 DIM C() as String ' define string array.
 DIM D as String() ' define string array. 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-04-14T03:47:01.037

没有区别。

两者都`Dim v As String()`将`Dim v() As String`创建一个字符串数组

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T23:45:46.337

传统上，在 Basic 中，您会将括号放在变量名之后。在 VB.Net 中，如果您愿意，可以将它们放在类型之后。结果是相同的，因此使用任何一种语法都没有区别。但是，添加此功能的原因是因为您如何构造数组。考虑以下代码：

```
 Public Sub MethodThatExpectsAnArray(ByVal arr() As String)
    '...
  End Sub

  Public Sub Main()
    Me.MethodThatExpectsAnArray(New String() {"Hello", "World"})
  End Sub 
```

在调用中，我“即时”构造数组，除了直接分配给方法参数外，没有任何赋值。由于这里没有变量，我必须在类型之后设置括号。为了允许这种语法，Microsoft 可以选择更改您传统上在 Basic 中声明数组的方式，或者允许这两种语法。他们当然选择了后者。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T16:53:17.843

没有区别。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T16:58:02.747

它主要是语义。第一个读作`create variable "v" of type string array`，第二个读作`create array "v" of type string`。无论哪种方式，结果都是相同的字符串数组。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T23:05:55.563

两者的含义没有区别。

如果您想在一个 dim 语句中声明多个变量，则第二种形式提供了更大的灵活性： dim v(),v2 as string 允许您在同一语句中声明数组类型和非数组类型。

# vb.net - 每个循环的VB反射

> ID：533171
> 
> 赞同：0
> 
> 时间：2009-02-10T16:51:07.133
> 
> 标签：vb.net, reflection

我正在尝试按照以下代码在 for 每个循环中使用未知类型：

```
private sub ReflectThis(ByVal rawData As Object())
  Dim dataType As Type = rawData(0).GetType()
  Dim properties As PropertyInfo() = dataType.getProperties()
  For Each item As dataType In rawData ''//AAAA
    For Each property As System.Reflection.PropertyInfo properties
      ''//reflected code use here 
```

我得到的问题是在标记为 AAAA 的行上。它抱怨没有声明“dataType”，我认为这意味着它不作为一个适当的类存在。

目的是在别处调用 Web 服务，无论我调用哪个 Web 服务，都使用反射将生成的数据结构对象的信息添加到数据库中。

如果有的话，对做类似的事情有什么限制

```
将 myObject 调暗为 variableInstanceOfTypeObjectHere

```

还是我犯了一个更根本的错误？如果我是对的，有什么解决方法（如果有的话）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T17:15:53.983

当您将变量“As”声明为一种类型时，这意味着您在*编译*时就知道该类型。这让编译器可以检查你在用它做什么。在这种情况下，您在编译时*不*知道类型 - 您在执行时得到它。您所知道的是每个项目都是一个对象 - 所以要么不指定类型（如 Joel 所建议的那样），要么将其指定为 Object：

```
For Each item As Object In rawData ''//AAAA 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T16:55:30.867

只是不指定类型：

```
For Each item in rawData 
```

# sql-server-2005 - 在 MDX 查询中连接事实表

> ID：533180
> 
> 赞同：1
> 
> 时间：2009-02-10T16:52:32.027
> 
> 标签：sql-server-2005, olap, mdx

我正在使用 VS 2005 构建和分析服务项目。目标是分析广告活动。

我有一个带有 2 个事实表的立方体

factCampaign：包含受访者对广告活动的看法的详细信息 factDemographics：包含受访者的人口统计信息

这些事实表有一个共同的维度 dimRespodent 指的是被采访的实际人

我有 2 个其他维度（我留下了不相关的维度）

dimQuestion：包含问题列表 dimAnswer：包含每个问题的可能答案列表

dimQuestion 和 dimAnswer 与 factDemogrpahics 相关联，但与 factCampaign 无关

我希望能够运行查询以返回人们对活动的看法（来自 factCampaign）但使用人口统计标准（使用 dimQuestion 和 dimAnswer）的结果

例如，有多少 18-25 岁的男性回忆起特定的活动

我是 OLAP 和 Analysis Services (2005) 的新手，所以如果我的要求太基本，请原谅。

我尝试了以下选项

1.  使用公共 RespondentKey 将数据源视图中的事实表链接到事实表。查询运行并返回结果，但无论选择的人口统计标准如何，都会返回相同的结果，即被忽略。
2.  从 factDemographics 创建维度。我试图将 dimAnswer 连接到 Cube Structure 的 Dimension Usage 表中的 factCampaign 但没有成功。当我尝试部署项目时，项目要么停止，要么出现以下错误（注意启用的属性层次结构设置为 true）

元数据管理器中的错误。'Fact Demographics' 度量组维度的 'Answer Key' 中间粒度属性未启用属性层次结构。

我将不胜感激任何人都可以提供的帮助。如果您需要更多信息，请告诉我，如果这是一个基本问题，请再次道歉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T17:32:07.353

对于任何感兴趣的人，解决方案是更改 dimRespondent 以包含问题和答案。并在 Cube 设计的 Dimension Usage 选项卡中将 dimRespondent 设置为与两个事实表具有常规关系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T00:43:19.930

您可能需要的是多对多关系。[这里](http://www.sqlbi.eu/Projects/Manytomanydimensionalmodeling/tabid/80/language/en-US/Default.aspx)有一份白皮书，其中介绍了 m2m 关系的许多场景，包括一个专门围绕调查和问卷的场景。

# apache-flex - 在 AIR HTML 控件中的链接悬停时显示 url

> ID：533187
> 
> 赞同：3
> 
> 时间：2009-02-10T16:53:35.147
> 
> 标签：apache-flex, dom, air

有谁知道是否有一种简单的方法可以在 AIR HTML 控件中捕获悬停的链接 url？就像在浏览器中一样，我希望 url 显示在状态栏中，但我找不到在链接翻转时引发的任何事件。您是否需要为此检查并自己操作 DOM？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T18:07:07.917

假设您正在使用 mx:HTML 或 HTMLLoader，您可能必须编写自己的小脚本来将 DOM 对象连接到 AIR 容器。这是一种方法——可能有一个更优雅的解决方案，但为了说明的目的，它应该就足够了。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" width="1024" height="768" xmlns:html="flash.html.*" horizontalScrollPolicy="off">

    <mx:Script>
        <![CDATA[

            private function container_complete(event:Event):void
            {
                addHTMLListeners();
            }

            private function addHTMLListeners():void
            {
                var links:Object = container.htmlLoader.window.document.getElementsByTagName("a");

                for (var i:int = 0; i < links.length; i++)
                {
                    if (links[i].href != "")
                    {
                        var href:String = links[i].href;

                        links[i].onmouseover = function():void { setStatus(this); };
                        links[i].onmouseout = function():void { clearStatus() };
                    }
                }
            }

            private function setStatus(o:Object):void
            {
                status = o.href;
            }

            private function clearStatus():void
            {
                status = "";
            }

        ]]>
    </mx:Script>

    <mx:HTML id="container" location="http://stackoverflow.com/users/32129" width="100%" height="100%" complete="container_complete(event)" />

</mx:WindowedApplication> 
```

希望能帮助到你！

# .net - 排序 DLL 版本的正确方法是什么

> ID：533192
> 
> 赞同：3
> 
> 时间：2009-02-10T16:54:50.150
> 
> 标签：.net, windows, dll, versioning

我一直理解版本中的每个数字（例如：1.2.3.4）都被视为常规 int 值。我们正在使用一些遵循不同约定的第三方 DLL，这似乎会导致我们的修补过程出现问题（补丁不会用新的 DLL 覆盖旧的 DLL）。

DLL的旧版本是1.38 DLL的新版本是1.4

我理解事情是 1.4 < 1.38。我会亲自使用1.40。他们声称 1.4 == 1.40。

我讨厌因为无知而犯错误，我也讨厌盲目地遵循约定而不理解它们背后的含义。所以现在是我要求澄清的时候了。对此有何看法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T16:57:59.330

当然，`1.4`绝不等于`1.40`。

`1.40`是修订四十，`1.4`是修订四，它们`35`之间有修订。

我可以说`Photoshop v.10`肯定比`Photoshop v.1`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T16:59:44.507

惯例是 1.4 != 1.40。版本是一组数字，而不是单个数字。如果他们想增加到 1.4，他们应该一直使用 1.3.8。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T17:28:26.183

当然是单独的整数值！想想如果版本号是浮点数的噩梦，我的意思是，四舍五入等等。:P

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T17:00:38.170

这取决于您，但正如您所注意到的，事情很容易让人感到困惑。

在我的个人项目中，我总是用直整数编号，而不是任何点：v1、v2、v3 等。保持简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T17:04:00.877

我同意你的阅读。“1.4” == “1.04” < “1.38”

# php - 如何摆脱。和.. 在扫描文件夹时在 php 中创建一个数组？

> ID：533199
> 
> 赞同：2
> 
> 时间：2009-02-10T16:55:50.430
> 
> 标签：php, regex, arrays, file, directory

如果您扫描包含其他文件夹和文件的文件夹，您如何摆脱 . 和..和文件？您如何将只有数组的文件夹放入 WITHOUT 中。和 ..？我想使用正则表达式，但我是新手，我做错了。我的代码现在是这样但不起作用：

> if(fnmatch("\.{1,2}",$dir_array[$i]) || is_file($dir_array[$i]){
> unset($dir_array[$i]);
> }else{ //其他代码
> }

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-10T16:59:36.253

您在代码中混淆了 fnmatch 和正则表达式。要获取除特殊文件和目录之外的所有文件和目录，请使用以下命令：

```
$dir_array = array_diff($dir_array, array(".", "..")); 
```

或者，如果您仍然迭代数组，您可以像这样测试每个元素：

```
foreach ($dir_array as $name) {
    if (($name != "..") && ($name != ".")) {
        // Do stuff on all files and directories except . ..
        if (is_dir($name)) {
            // Do stuff on directories only
        }
    }
} 
```

在 php<5.3 中，您也可以专门[使用回调函数](http://php.net/manual/en/function.array-filter.php)：

```
$dir_array = array_filter($dir_array,
  create_function('$n', 'return $n != "." && $n != ".." && is_dir($n);')); 
```

（有关更详细的版本，请参阅 Alllain Lalonde 的答案）

从 php 5.3 开始，这可以写得[更好](http://wiki.php.net/rfc/closures)：

```
$dir_array = array_filter($dir_array,
  function($n) {return $n != "." && $n != ".." && is_dir($n);}); 
```

最后，结合 array_filter 和这个答案的第一行代码会产生一个（微不足道的）慢，但可能更易读的版本：

```
$dir_array = array_filter(array_diff($dir_array, array(".", "..")), is_dir); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T17:03:04.437

您不需要正则表达式来测试它。只需使用纯字符串比较：

```
if ($dir_array[$i] == '.' || $dir_array[$i] == '..' || is_file($dir_array[$i])) {
    unset($dir_array[$i]);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T17:03:31.003

这可能会做到。

```
function is_not_meta_dir($file_name) {
  // return true if $filename matches some pattern.
  // without knowing the format of your $dir_array
  return $file_name != '.' && $file_name != '..';
}

$new_dir_array = array_filter($dir_array, 'is_not_meta_dir'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T17:06:53.477

不需要正则表达式，只需 unset() 前两个值。

```
$d = dir($dir);
unset($d[0]);
unset($d[1]); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T17:03:55.620

我会这样做：

```
$items = array();
$handle = opendir('path/to/dir');
while (($item = readdir($handle)) !== false) {
    if (! in_array($item, array('.', '..'))) {
        $items[] = $item;
    }
}
closedir($handle);

print_r($items); 
```

虽然，我更喜欢[DirectoryFilterDots](http://www.php.net/~helly/php/ext/spl/classDirectoryFilterDots.html)，但它在可用的 PHP 发行版中很少见。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T17:06:23.943

我会做这样的事情（代码可能不会不费吹灰之力，因为我已经多年没有在 PHP 中工作了）

```
<?
if ($handle = opendir('/myPath')) 
  {
  while (false !== ($file = readdir($handle)))
  { 
    if (bool is_dir ( $file ) && substring($file,0,1) != ".")
      {
        $filesArray[] = $file; // this is the bit I'm not sure of the syntax for. 
      }
    }
  }
?> 
```

*编辑*误读了问题 - 现在应该将所有不是“。”的文件夹名称 ion myPath 添加到数组中。或者 ”..”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-14T15:37:05.840

```
 $pathsArr = array();
    foreach (explode($dirSeparator, $currentPath) as $path) {
        if (strlen($path) && $path !== '.') {
            if ($path === '..') {
                // die('.....');
                array_pop($pathsArr);
            } else {
                $pathsArr[] = $path;
            }
        }
    }

    $realpath = $winDrive . $dirSeparator . implode($dirSeparator, $pathsArr); 
```

# .net - 允许 .NET 2.0 运行时以完全信任的方式从网络运行可执行文件

> ID：533200
> 
> 赞同：6
> 
> 时间：2009-02-10T16:56:00.787
> 
> 标签：.net, security

伙计们，这不可能是真的

我正在尝试从网络驱动器运行 .NET 2.0 可执行文件，结果表明，由于 Microsoft .net 2.0 没有在服务器 2003 上安装 mscorcfg.msc，因此我必须安装完整的 SDK。我只是想在不下载 350Mb 垃圾的情况下运行该死的东西！

抱歉咆哮...任何人都可以想到一个简单的解决方案？

**EDIT1**：对于我想要实现的目标似乎存在误解。这适用于我的测试环境。我有很多虚拟机，我想要的只是完全禁用该死的安全性。这项任务似乎如此微不足道，但到目前为止，我似乎必须在每台机器上部署 SDK、3.5 SP1 或其他几 TB 包才能实现它

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T09:02:20.590

您可以尝试从 .NET 命令提示符运行以下命令 -

**caspol -cg All_Code FullTrust**

这为代码组“All_Code”提供了完整的权限集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T17:04:39.517

您可以使用 配置安全性`caspol.exe`，而不需要 msc。但是，使用 VS2005 中的 ClickOnce 部署（“发布”）会更容易——这避免了网络共享的大部分安全问题（但可以托管**在**网络共享上）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T17:03:34.233

您可以尝试更新到 .Net 3.5sp1 或更高版本。那应该能够运行 .Net 2.0 代码，但他们更改了该版本中的信任系统以修复此部署场景。

另外，我手边没有链接，买你不需要完整的 SDK 来获取 mscorcfg.msc。我已经看到它包含在一个小得多的包装中。但同样，我没有方便的链接，你可以像我一样简单地用谷歌搜索它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T17:05:53.227

你试过caspol.exe吗？

[http://msdn.microsoft.com/en-us/library/cb6t8dtz(VS.80).aspx](http://msdn.microsoft.com/en-us/library/cb6t8dtz(VS.80).aspx) [http://blogs.msdn.com/shawnfa/archive/2004/12/30/344554.aspx](http://blogs.msdn.com/shawnfa/archive/2004/12/30/344554.aspx)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-10T17:00:49.230

警告：我可能不理解您的问题，因为我不理解对 mscorcfg.msc 的引用。机器上是否安装了.NET？

如果是，简单的解决方案：

1.  配置安全性以允许您从网络共享运行程序

如果不是，简单的解决方案：

1.  安装 .NET 运行时

* * *

很抱歉直言不讳，这确实是一个简单的解决方案。

其他解决方案包括：

*   将您的程序打包成一个 .EXE 文件，其中包含 .NET 运行时的相关部分。这种打包需要专门的软件来完成，而且这些软件并不便宜，尽管这些工具的确切名称让我无法理解。
*   重写程序以不使用 .NET

# mysql - 在大视图上优化 MySQL GROUP BY 或 DISTINCT

> ID：533219
> 
> 赞同：4
> 
> 时间：2009-02-10T17:00:33.350
> 
> 标签：mysql, optimization, group-by, distinct, performance

考虑一个由多个表组成的视图...例如 a `v_active_car`，它由`car`连接到`body`、`engine`和的表`wheels`组成`stereo`。它可能看起来像这样：

**`v_active_cars`看法**

```
SELECT * FROM car
    INNER JOIN body ON car.body = body.body_id
    INNER JOIN engine ON car.engine = engine.engine_id
    INNER JOIN wheels ON car.wheels = wheels.wheels_id
    INNER JOIN stereo ON car.stereo = stereo.stereo_id
    WHERE car.active = 1
    AND engine.active = 1
    AND wheels.active = 1
    AND stereo.active = 1 
```

汽车的每个组件都有一个“活动”标志。现在，我需要找到现役汽车中可用的所有立体声音响。要做到这一点，需要使用整个视图，而不仅仅是`stereo`桌子——仅仅因为立体声音响处于活动状态并不意味着它可以在汽车中使用。

所以我可以

```
SELECT DISTINCT stereo_id FROM v_active_cars 
```

尽管这可能会返回非常少量的行，但它仍然是一个非常慢的查询。

我试过这个，但它更慢：

```
SELECT stereo_id FROM stereo WHERE EXISTS
(SELECT 1 FROM v_active_cars WHERE stereo_id = stereo.stereo_id) 
```

我还能做些什么来加快速度吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T17:04:08.647

你似乎做的一切都是正确的。下一步是检查索引覆盖率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T17:23:17.837

1.  确保所有 JOIN 都有索引
    *   在您的情况下，每个级别都由一个键和一个标志选择。将标志添加为索引的一部分可能允许数据库仅使用索引，而不是读取整个记录
    *   确保您有足够的 RAM 来保存结果集。尤其是 InnoDB 表有很多你必须调整的旋钮。大多数默认设置假定硬件*非常*旧且 RAM 太少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T17:12:45.490

试试这个：

```
SELECT stereo_id
FROM stereo s, (
  SELECT *
  FROM v_active_cars
  ORDER BY stereo_id
  ) v
WHERE s.active = 1
  AND v.stereo = s.stereo_id 
```

`ORDER BY`这里应该防止将谓词推入视图，优化器应该选择一个哈希连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T17:14:18.857

您可以尝试为每个部分创建一个仅显示活动部分的视图，然后加入这些部分。例如。

```
VIEW activeCar
SELECT * FROM car WHERE car.active = 1

VIEW activeEngine
SELECT * FROM engine WHERE engine.active = 1 
```

那么你的最终观点可以是

```
SELECT * FROM activeCar
INNER JOIN activeEngine ON activeCar.engine = activeEngine.engine_id 
```

显然，请确保您在活动列上有一个索引。

另一种选择是在 id 和 active 标志上都有一个索引。然后，您可以在加入时执行 active=1。这样，只有一个索引用于加入，而不是一个用于 id 和一个用于活动。

```
SELECT * FROM car
INNER JOIN body ON car.body = body.body_id AND body.active = 1
INNER JOIN engine ON car.engine = engine.engine_id AND engine.active = 1
INNER JOIN wheels ON car.wheels = wheels.wheels_id AND wheels.active = 1
INNER JOIN stereo ON car.stereo = stereo.stereo_id AND stereo.active = 1 
```

# iphone - 为 iPhone 创建一个组合框

> ID：533231
> 
> 赞同：0
> 
> 时间：2009-02-10T17:04:37.333
> 
> 标签：iphone, combobox, safari

由于没有通过 Safari 在网页上看到的用于创建组合框（或选择框）的预先存在的组件，有人可以提供一个示例或预先存在的 3rd 方组件来创建一个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T17:18:25.927

我不认为这很难做到。

在视图控制器中，您有一个 UITextField 和一个 UITableView。将视图控制器指定为两个控件的委托，以及表的数据源。

`textField:shouldChangeCharactersInRange:replacementString:`在控制器中实现 UITextField 委托方法。这会拦截在您的文本字段中输入的更改。在此方法中，遍历您的可能选项列表并将匹配项存储在视图控制器上的 NSMutableArray 实例变量中。然后调用`[myTableView reloadData]`。

让您的表格单元格从您之前存储的匹配数组中生成。

它应该非常简单，除了一些委托方法之外根本不需要太多代码来工作。

# sql-server - BizTalk：在远程连接对话框中，有没有办法强制 TCP/IP 传输而不是命名管道？

> ID：533237
> 
> 赞同：0
> 
> 时间：2009-02-10T17:05:51.370
> 
> 标签：sql-server, authentication, biztalk, remote-access

我正在尝试通过网络连接到 biztalk 实例，但并没有那么成功。带有 biztalk 数据库的 SQL 服务器已禁用命名管道。当我尝试连接到安装了 biztalk 的服务器时，它给出了一个命名管道错误。当我尝试连接到数据库服务器时，它只是超时并给出了一个几乎涵盖了阳光下所有场景的错误（基本上它无法连接，它不知道为什么）

如果我尝试连接 SQL Server Management Studio，它就可以工作。如果我尝试制作 dsn，它可以工作。如果我尝试通过 biztalk，它就会死掉。如果我尝试使用 tcp: 前缀通过 biztalk，它就会死掉。如果我在另外两个上强制命名管道，它就会死掉。

从连接到现有组对话框中是否有任何方法可以强制使用 TCP/IP 作为传输？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T08:41:28.837

您是否在系统或应用程序日志中收到任何错误消息？

您可能需要检查一些形状 - 端口等，因为可能有

[http://www.biztalkserverguide.com/2008/02/04/biztalk-server-throwing-named-pipes-error-40-could-not-open-a-connection-to-sql-server/](http://www.biztalkserverguide.com/2008/02/04/biztalk-server-throwing-named-pipes-error-40-could-not-open-a-connection-to-sql-server/)

> 声明了一个名为 btsConnString（字符串）的变量，该变量未设置为连接字符串，它是空白的（错误地），事情按预期工作，没有问题。在舞台上由于未为 btsConnString 分配连接字符串，因此引发了错误

[还要查看连接](http://msdn.microsoft.com/en-us/library/aa561924.aspx) DTC 测试的 MSDTC 问题[http://support.microsoft.com/kb/293799](http://support.microsoft.com/kb/293799) 如果您可以在两台服务器上安装，请使用[DTCPing](http://support.microsoft.com/default.aspx?scid=kb;en-us;306843)

还请查看这些[影响 Microsoft BizTalk Server 2006 的大多数 Microsoft SQL Server 问题属于以下类别之一：](http://msdn.microsoft.com/en-us/library/aa952081.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T11:46:37.940

我相信我最近有类似的事情 - BizTalk 会尝试使用命名管道连接到 SQL 框，原因不明，这会超时。我们使用注册表 (HKLM\SOFTWARE\Microsoft\MSSQLServer\Client\SuperSocketNetLib) 来强制它首先尝试 TCP（也是最后一个，我们没有指定任何其他协议），它似乎可以解决问题。

[在此处](http://msdn.microsoft.com/en-us/library/aa470051.aspx)查看详细信息

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T05:32:17.657

要强制 tcp，请尝试“tcp:servername”（或“tcp:servername\instancename,port”） 这可以在不使用 SQL 工具设置别名或默认协议的情况下完成

但是，您可能会收到错误的原因还有其他选择：

*   命名管道错误可能会产生误导，通常只是表示“找不到服务器”
*   防火墙等正在阻止对 SQL 实例的访问
*   ...或枚举实例/端口的 SQL 侦听器端口 1434

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-10T22:42:30.100

我知道这是一个非常古老的线程，但可以参考完全相同的问题。我最终在 SQL Server 配置管理器中为该实例创建了一个别名。您的别名将如下所示：`Alias = Aliasname Value = Server\Instance`. 然后将`Aliasname`作为您的数据源放入您的连接字符串中。在我看来，BizTalk 不理解`\`连接字符串中的反斜杠 ( )。它必须有一个单词。

# sql-server - 处理 ReportViewer 控件中的错误

> ID：533242
> 
> 赞同：0
> 
> 时间：2009-02-10T17:06:42.260
> 
> 标签：sql-server, reporting-services, reporting

我在 winforms 应用程序中使用 reportviewer 控件，并进行本地处理。我想处理 ReportError 事件，如果发生这种情况，向用户显示一条消息并退出，这样我就不必显示在渲染期间发生的后续错误消息。

问题是，即使我这样做了 this.close （在承载控件的表单上关闭），也无法取消渲染，并且它不断抛出更多错误。

有没有办法在第一次异常后取消报告呈现？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T17:15:59.163

您可以尝试使用一个 CancelRendering 函数。它是 ReportViewer 类的一部分。

```
ReportViewer1.CancelRendering([int time in milliseconds]) 
```

渲染实际停止需要几秒钟。您可以在 Function 参数中指定一个非常大的时间间隔，以使其有时间取消。

# sql - 在 PostgreSQL 上使用 SQL 连接数组中的多行

> ID：533256
> 
> 赞同：54
> 
> 时间：2009-02-10T17:09:48.943
> 
> 标签：sql, postgresql

我有一个这样构造的表：

```
oid | identifier | value
1   | 10         | 101
2   | 10         | 102
3   | 20         | 201
4   | 20         | 202
5   | 20         | 203 
```

我想查询此表以获得如下结果：

```
identifier | values[]
10         | {101, 102}
20         | {201, 202, 203} 
```

我想不出办法做到这一点。
那可能吗？如何？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2011-05-04T12:09:08.400

这是一个 Postgres 内置的，因为有几个版本所以你不再需要定义你自己的，名字是`array_agg()`.

```
test=> select array_agg(n) from generate_series(1,10) n group by n%2;
  array_agg   
--------------
 {1,3,5,7,9}
 {2,4,6,8,10} 
```

（这是 Postgres 8.4.8）。

请注意，没有`ORDER BY`指定，因此结果行的顺序取决于使用的分组方法（此处为哈希），即未定义。例子：

```
test=> select n%2, array_agg(n) from generate_series(1,10) n group by (n%2);
 ?column? |  array_agg   
----------+--------------
        1 | {1,3,5,7,9}
        0 | {2,4,6,8,10}

test=> select (n%2)::TEXT, array_agg(n) from generate_series(1,10) n group by (n%2)::TEXT;
 text |  array_agg   
------+--------------
 0    | {2,4,6,8,10}
 1    | {1,3,5,7,9} 
```

现在，我不知道你为什么得到`{10,2,4,6,8}`and `{9,7,3,1,5}`，因为`generate_series()`应该按顺序发送行。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-10T17:26:48.967

您必须创建一个聚合函数，例如

```
CREATE AGGREGATE array_accum (anyelement)
(
sfunc = array_append,
stype = anyarray,
initcond = '{}'
); 
```

然后

```
SELECT identifier, array_accum(value) AS values FROM table GROUP BY identifier; 
```

高温高压

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-04-01T19:37:38.083

简单的例子：每门课程都有很多课程，所以如果我运行下面的代码：

```
SELECT
  lessons.course_id AS course_id,
  array_agg(lessons.id) AS lesson_ids
FROM lessons
GROUP BY
  lessons.course_id
ORDER BY
  lessons.course_id 
```

我会得到下一个结果：

```
┌───────────┬──────────────────────────────────────────────────────┐
│ course_id │                   lesson_ids                         │
├───────────┼──────────────────────────────────────────────────────┤
│         1 │ {139,140,141,137,138,143,145,174,175,176,177,147,... │
│         3 │ {32,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,... │
│         5 │ {663,664,665,649,650,651,652,653,654,655,656,657,... │
│         7 │ {985,984,1097,974,893,971,955,960,983,1045,891,97... │
│       ...                                                        │
└───────────┴──────────────────────────────────────────────────────┘ 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-11-03T12:22:03.927

这是请求输出的代码。

```
select identifier, array_agg(value)
from (
  values
    (1   , 10         , 101),
    (2   , 10         , 102),
    (3   , 20         , 201),
    (4   , 20         , 202),
    (5   , 20         , 203)
  ) as tab (oid, identifier, value)
group by identifier
order by identifier; 
```

# c# - Ninject：通过类型解析对象_and_注册名称/标识符

> ID：533260
> 
> 赞同：7
> 
> 时间：2009-02-10T17:10:17.867
> 
> 标签：c#, inversion-of-control, ninject

我正在寻找一种方法来用 Ninject 做这样的事情：

```
// Sample from the Unity application block
IMyService result = myContainer.Resolve<IMyService>("Data"); 
```

（来自[http://msdn.microsoft.com/en-us/library/cc440957.aspx](http://msdn.microsoft.com/en-us/library/cc440957.aspx)）

是否可以？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-05T18:21:51.207

Ninject 2.0 具有以下功能：

```
Bind<IMyService>().To<MyServiceA>().Named("Data");
Bind<IMyService>().To<MyServiceB>().Named("SomethingElse");

kernel.Get<IMyService>("Data"); // will return MyServiceA 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T17:51:35.787

AFAIK 无法直接在 Ninject 中执行此操作，但您可以改用[上下文绑定](http://www.google.com/search?q=ninject+Contextual+Binding)。

# python - @classmethod 中的“self”指的是什么？

> ID：533300
> 
> 赞同：23
> 
> 时间：2009-02-10T17:18:53.057
> 
> 标签：python, self, class-method

我以为我开始掌握编程的“Python 方式”。类的方法接受 self 作为第一个参数，以引用该方法在其上下文中被调用的类的实例。@classmethod 装饰器指的是一个方法，其功能与该类相关联，但不引用具体实例。

那么，如果该方法是在没有实例引用的情况下被调用的，@classmethod 的第一个参数（规范的“self”）指的是什么？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-02-10T17:22:58.210

[类本身](http://docs.python.org/library/functions.html#classmethod)：

> 类方法接收类作为隐式第一个参数，就像实例方法接收实例一样。

```
class C:
    @classmethod
    def f(cls):
        print(cls.__name__, type(cls))

>>> C.f()
C <class 'type'> 
```

顺便说一句，这是`cls`规范的

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-10T17:28:00.040

类方法的第一个参数按约定命名`cls`，指的*是调用它的方法*所在的类对象。

```
>>> class A(object):
...     @classmethod
...     def m(cls):
...         print cls is A
...         print issubclass(cls, A)

>>> class B(A): pass
>>> a = A()
>>> a.m()
True
True
>>> b = B()
>>> b.m()
False 
True 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T17:23:17.647

类对象作为第一个参数传递。例如：

```
class Foo(object):
    @classmethod
    def bar(self):
        return self() 
```

将返回 Foo 类的实例。

**编辑**：

请注意，最后一行是 self() 而不是 self。self 将返回类本身，而 self() 返回一个实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T18:22:16.403

Django 在这里用一个类方法做了一些奇怪的事情：

```
class BaseFormSet(StrAndUnicode):
    """
    A collection of instances of the same Form class.
    """
    def __init__(self, data=None, files=None, auto_id='id_%s', prefix=None,
                 initial=None, error_class=ErrorList):
        ...
        self.prefix = prefix or self.get_default_prefix()
        ... 
```

即使 get_default_prefix 以这种方式声明（在同一类中）：

```
 @classmethod
    def get_default_prefix(cls):
        return 'form' 
```

# c# - 访问新表单上的控件

> ID：533305
> 
> 赞同：0
> 
> 时间：2009-02-10T17:20:33.490
> 
> 标签：c#, winforms

我的项目中有 2 个表单，form1 和 form2。当我单击 form1 中的按钮时，我运行以下代码：

```
Form tempform = new Form2();
tempform.Show(); 
```

在我的 Form2 代码中，我有一个标签，现在我需要更改文本。如何访问标签？

我试过：

```
tempform.label1.value = "new text" 
```

那没有用，我什至尝试使用 Controls 集合进行访问，但我认为我搞砸了。有什么办法可以访问标签吗？或者有什么方法可以将值传递给该新表单，然后让该表单更改标签文本。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T17:25:54.897

如果标签值只应设置一次，则在创建表单时，请使用 Form2 的构造函数，如下所示：

```
public Form2(string labelValue)
{
  _labelValue = labelValue;
} 
```

然后在创建表单时调用该构造函数。

或者，如果标签在表单的生命周期内发生变化，请创建一个公共属性：

```
public string LabelValue
{
  get { return label1.Text; }
  set { label1.Text = value; }
} 
```

此外，我建议命名参数和/或属性以反映值的含义，例如“titleText”而不是“labelValue”。这样，Form2 可以决定如何显示信息（在标题栏、标签、文本框等中），而 Form1 不必担心这一点。

编辑：像这样使用 LabelValue 属性：

```
Form2 newForm = new Form2(); // Assign object to a Form2 instead of Form
newForm.LabelValue = "new text";
newForm.Show(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T17:23:54.433

默认情况下，控件具有`protected`访问权限。您可以将其更改为`public`，或者您可以将方法/属性添加到您的 form2 类以设置标签并调用它（通常首选后一种方法来保留封装，因为设计人员可能想要覆盖您的公共更改。）。

# ruby-on-rails - 查看 Rails 模型页面适用于第一个视图，但不适用于后续视图

> ID：533310
> 
> 赞同：3
> 
> 时间：2009-02-10T17:21:47.073
> 
> 标签：ruby-on-rails, ruby, model

这是使用 Rails 2.2.2

我有一个使用acts_as_flaggable 插件的模型，在我用来显示模型实例的页面上，我列出了模型具有的所有标志。

当我使用标准脚本/服务器命令启动我的 Rails 开发服务器（mongrel）时，加载包含以下代码的页面，它加载正常：

```
<% @object.flags.each do |flag| %>
<tr>
<td><%= time_ago_in_words(flag.created_at) %> ago</td>
<td><%= flag.flag %></td>
<td><%= link_to flag.user.login, user_path(flag.user) %></td>
</tr>
<% end %> 
```

如果我重新加载页面（以及任何后续视图），我会收到以下 NoMethodError 错误：

```
You have a nil object when you didn't expect it!
You might have expected an instance of Array.
The error occurred while evaluating nil.include? 
```

如果我重新启动开发服务器，页面会再次正常加载，然后后续视图会产生同样的奇怪现象。

如果我删除该行：

```
<td><%= link_to flag.user.login, user_path(flag.user) %></td> 
```

页面加载正常，从那时起将重新加载正常。

似乎可标记插件由于某种原因在用户模型方面存在问题，但为什么它在第一页加载时起作用？我似乎也无法使用脚本/控制台重复该问题。

- 编辑 -

每个请求添加堆栈跟踪。在正常情况下，我通常可以处理这个特定的错误，但让我困惑的部分是它为什么第一次工作。

这是在我看来的错误页面/跟踪，我希望这会有所帮助：

```
NoMethodError in Admin#list_flagged

Showing app/views/admin/list_flagged.html.erb where line #65 raised:

You have a nil object when you didn't expect it!
You might have expected an instance of Array.
The error occurred while evaluating nil.include?

Extracted source (around line #65):

62:                   <tr>
63:                     <td><%= time_ago_in_words(flag.created_at) %> ago</td>
64:                     <td><%= flag.flag %></td>
65:                     <td><%= link_to flag.user.login, user_path(flag.user) %></td>
66:                   </tr>
67:                 <% end %>

RAILS_ROOT: /dev/trunk
Application Trace | Framework Trace | Full Trace

/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/attribute_methods.rb:142:in `create_time_zone_conversion_attribute?'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/attribute_methods.rb:75:in `define_attribute_methods'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/attribute_methods.rb:71:in `each'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/attribute_methods.rb:71:in `define_attribute_methods'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/attribute_methods.rb:350:in `respond_to?'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_proxy.rb:209:in `method_missing'
app/views/admin/list_flagged.html.erb:65
app/views/admin/list_flagged.html.erb:61
app/views/admin/list_flagged.html.erb:24:in `each'
app/views/admin/list_flagged.html.erb:24
app/views/admin/list_flagged.html.erb:14

/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/attribute_methods.rb:142:in `create_time_zone_conversion_attribute?'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/attribute_methods.rb:75:in `define_attribute_methods'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/attribute_methods.rb:71:in `each'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/attribute_methods.rb:71:in `define_attribute_methods'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/attribute_methods.rb:350:in `respond_to?'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_proxy.rb:209:in `method_missing'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_collection.rb:359:in `method_missing_without_paginate'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_proxy.rb:212:in `method_missing'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_proxy.rb:212:in `each'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_proxy.rb:212:in `send'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_proxy.rb:212:in `method_missing'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_collection.rb:359:in `method_missing_without_paginate'
/usr/lib/ruby/gems/1.8/gems/mislav-will_paginate-2.3.6/lib/will_paginate/finder.rb:167:in `method_missing'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/helpers/form_helper.rb:313:in `fields_for'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/helpers/form_helper.rb:253:in `form_for'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/renderable.rb:39:in `send'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/renderable.rb:39:in `render'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/template.rb:73:in `render_template'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/base.rb:256:in `render'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/base.rb:367:in `_render_with_layout'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/base.rb:254:in `render'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:1174:in `render_for_file'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:896:in `render_without_benchmark'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/benchmarking.rb:51:in `render'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/core_ext/benchmark.rb:8:in `realtime'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/benchmarking.rb:51:in `render'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:868:in `render_without_benchmark'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/benchmarking.rb:51:in `render'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/core_ext/benchmark.rb:8:in `realtime'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/benchmarking.rb:51:in `render'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:1248:in `default_render'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:1254:in `perform_action_without_filters'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/filters.rb:617:in `call_filters'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/usr/lib/ruby/1.8/benchmark.rb:293:in `measure'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/rescue.rb:136:in `perform_action_without_caching'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/caching/sql_cache.rb:13:in `perform_action'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/connection_adapters/abstract/query_cache.rb:34:in `cache'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/query_cache.rb:8:in `cache'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/caching/sql_cache.rb:12:in `perform_action'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:524:in `send'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:524:in `process_without_filters'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/filters.rb:606:in `process_without_session_management_support'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/session_management.rb:134:in `process'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:392:in `process'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:183:in `handle_request'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:110:in `dispatch_unlocked'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:123:in `dispatch'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:122:in `synchronize'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:122:in `dispatch'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:132:in `dispatch_cgi'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:39:in `dispatch'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/rails.rb:76:in `process'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/rails.rb:74:in `synchronize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/rails.rb:74:in `process'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:159:in `process_client'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `each'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `process_client'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/configurator.rb:282:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/configurator.rb:281:in `each'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/configurator.rb:281:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:128:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/command.rb:212:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:281
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:142:in `load_without_new_constant_marking'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:142:in `load'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:521:in `new_constants_in'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:142:in `load'
/usr/lib/ruby/gems/1.8/gems/rails-2.2.2/lib/commands/servers/mongrel.rb:64
/usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
/usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:153:in `require'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:521:in `new_constants_in'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:153:in `require'
/usr/lib/ruby/gems/1.8/gems/rails-2.2.2/lib/commands/server.rb:49
/usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
/usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'
script/server:3

/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/attribute_methods.rb:142:in `create_time_zone_conversion_attribute?'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/attribute_methods.rb:75:in `define_attribute_methods'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/attribute_methods.rb:71:in `each'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/attribute_methods.rb:71:in `define_attribute_methods'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/attribute_methods.rb:350:in `respond_to?'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_proxy.rb:209:in `method_missing'
app/views/admin/list_flagged.html.erb:65
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_collection.rb:359:in `method_missing_without_paginate'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_proxy.rb:212:in `method_missing'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_proxy.rb:212:in `each'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_proxy.rb:212:in `send'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_proxy.rb:212:in `method_missing'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/associations/association_collection.rb:359:in `method_missing_without_paginate'
/usr/lib/ruby/gems/1.8/gems/mislav-will_paginate-2.3.6/lib/will_paginate/finder.rb:167:in `method_missing'
app/views/admin/list_flagged.html.erb:61
app/views/admin/list_flagged.html.erb:24:in `each'
app/views/admin/list_flagged.html.erb:24
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/helpers/form_helper.rb:313:in `fields_for'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/helpers/form_helper.rb:253:in `form_for'
app/views/admin/list_flagged.html.erb:14
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/renderable.rb:39:in `send'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/renderable.rb:39:in `render'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/template.rb:73:in `render_template'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/base.rb:256:in `render'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/base.rb:367:in `_render_with_layout'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/base.rb:254:in `render'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:1174:in `render_for_file'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:896:in `render_without_benchmark'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/benchmarking.rb:51:in `render'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/core_ext/benchmark.rb:8:in `realtime'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/benchmarking.rb:51:in `render'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:868:in `render_without_benchmark'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/benchmarking.rb:51:in `render'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/core_ext/benchmark.rb:8:in `realtime'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/benchmarking.rb:51:in `render'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:1248:in `default_render'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:1254:in `perform_action_without_filters'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/filters.rb:617:in `call_filters'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/usr/lib/ruby/1.8/benchmark.rb:293:in `measure'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/rescue.rb:136:in `perform_action_without_caching'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/caching/sql_cache.rb:13:in `perform_action'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/connection_adapters/abstract/query_cache.rb:34:in `cache'
/usr/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/query_cache.rb:8:in `cache'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/caching/sql_cache.rb:12:in `perform_action'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:524:in `send'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:524:in `process_without_filters'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/filters.rb:606:in `process_without_session_management_support'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/session_management.rb:134:in `process'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:392:in `process'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:183:in `handle_request'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:110:in `dispatch_unlocked'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:123:in `dispatch'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:122:in `synchronize'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:122:in `dispatch'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:132:in `dispatch_cgi'
/usr/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/dispatcher.rb:39:in `dispatch'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/rails.rb:76:in `process'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/rails.rb:74:in `synchronize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/rails.rb:74:in `process'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:159:in `process_client'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `each'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `process_client'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `initialize'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `new'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/configurator.rb:282:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/configurator.rb:281:in `each'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/configurator.rb:281:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:128:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/command.rb:212:in `run'
/usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:281
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:142:in `load_without_new_constant_marking'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:142:in `load'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:521:in `new_constants_in'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:142:in `load'
/usr/lib/ruby/gems/1.8/gems/rails-2.2.2/lib/commands/servers/mongrel.rb:64
/usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
/usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:153:in `require'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:521:in `new_constants_in'
/usr/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:153:in `require'
/usr/lib/ruby/gems/1.8/gems/rails-2.2.2/lib/commands/server.rb:49
/usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
/usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'
script/server:3

Request

Parameters:

None

Show session dump

--- 
:user_id: 1
:last_page: http://localhost:3000/
flash: !map:ActionController::Flash::FlashHash {}

Response

Headers:

{"cookie"=>[],
 "Content-Type"=>"text/html",
 "Cache-Control"=>"no-cache"} 
```

--编辑#2--

好吧，我已经“修复”了它。尽管在 Flag 模型中存在belongs_to 关系，我还是在acts_as_flaggable 中的Flag 模型中添加了以下代码：

```
def user
  User.find(self.user_id)
end 
```

此代码确实允许页面加载而不会出现错误，无论是第一次在页面上还是第 N 次。

我会将此添加为答案，但我不知道我对此是否满意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T13:47:26.210

遇到类似问题，我会检查您的`/config/initializers`目录。它是否声明了一些方法或在模型中包含了一些模块？如果是这样，它将在第一次加载时发生，但模型将在后续请求中重新加载，而不会再次运行初始化程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T10:48:03.847

我知道这在 Rails 世界中是异端邪说，但安装 netbeans 并使用他们的调试工具来看看发生了什么。您可以在 html 中放置断点。这是相当令人印象深刻的（虽然非常非常慢）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T17:34:33.673

这意味着你有一个 nil 对象，你期望一个真实的对象。听起来它在插件内部的某个地方崩溃了。查看堆栈跟踪，看看您是否可以查明代码中发生这种情况的位置，然后在其周围包装一些调试打印输出，以检查您的对象是否在不应该出现的情况下为 nil。

在不知道该插件如何工作的情况下，不要认为我们可以提供更多帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-15T03:07:09.863

没有真正的修复，但这里有一个解决方法。它与 development.rb 文件中的 config.cache_classes 设置有关。

改变：

```
config.cache_classes = false 
```

至...

```
config.cache_classes = true 
```

问题就消失了。

不是一个很好的解决方案，但它似乎从 2.2.2 开始就存在了（我在 2.3.12 上）。

这里有很多[背景和可能的补丁](https://rails.lighthouseapp.com/projects/8994/tickets/1339-arbase-should-not-be-nuking-its-children-just-because-it-lost-interest)。

这是我的[第一个线索](http://www.theirishpenguin.com/2009/01/22/bug-of-the-day-nilinclude-error-with-create_time_zone_conversion_attribute/)。

# architecture - 您在项目中遵循 n 层架构和关注点分离的严格程度如何？

> ID：533311
> 
> 赞同：20
> 
> 时间：2009-02-10T17:22:17.433
> 
> 标签：architecture, n-tier-architecture, separation-of-concerns

我想大多数开发人员都有多层架构的想法。我们有 DAL（数据访问层），我们有 BLL（业务逻辑层），并且在接近尽头的地方我们有我们的 UI。如果您的项目以某种方式遵循这些原则，您是否保留（或至少尝试）保留/放置它们在概念上属于的地方？我对与许多其他人一起工作的大公司应用程序特别感兴趣。显然，你可以用你的私人玩具项目做任何你想做的事，发明任何类型的架构并坚持下去。对于有很多人为软件做出贡献或整体混乱的大型项目来说，这并不容易。

例如，我碰巧看到诸如 UI 组件直接进入数据库以获取一些 BL 不提供的“丢失”额外数据，UI 和 BL 都使用表字段等低级元素，我认为它们应该委托这些操作到较低级别即 DAL。在与高级开发人员讨论这些事情后，我看到他根本没有看到这有问题，这尤其令人难过。

我们当然可以假设我和任何与我观点相同的人都只是完美主义者，但我清楚地看到了一个非常不利的后果，因为我在一些任务中花了很长时间来追踪所有“平行”路线数据往返于数据库，并确定现在可能受到我实施的新功能影响的人以及以何种方式受到影响。在我看来，当有人决定快速破解这些东西并尽快关闭任务时，这些增加了进一步的开发/维护成本，超过了一些节省。

你的项目是“纯粹的”还是他们很久以前就放弃了在层之间保持清晰界限的想法？如果您仍然保持正确，您将如何处理不了解这些事情或不关心他们只是构建“自定义”解决方案和黑客攻击的同事？或者在某个时间点你停止与风车战斗并接受它作为你的惩罚？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-10T17:59:08.000

我们的应用程序越复杂，关注点分离就越重要。

100 kloc 的应用程序是一个大块，表单类中的业务代码与其他任何地方一样多，并从业务类调用表单方法。我们咬牙切齿地把业务逻辑和展示逻辑分开了。任何需要通知用户其进度的类都会引发一个被 UI 处理的事件。而且，有一段时间，世界一切都很好。

大约 200 klocs，我们添加了一个数据层。我们的应用程序的架构是这样的，我们的大部分数据一进入就被处理并立即丢弃。大多数配置信息都存储在与我们共享共生关系的第三方应用程序中。但是，设置开始在各种奇怪的角落累积。我们最终构建了三个配置管理系统，它们都错综复杂地融入了业务逻辑。通过广泛的重写，我们能够将配置信息分离到它自己的层中，并将流数据的处理分离到另一个层中。

在 250 kloc 线附近，我们决定终止与第三方供应商的关系，并使我们的应用程序独立。我们开始了大规模的重写，并且第一次在我们的应用程序中添加了一个实际的数据库。因为我们在流信息、数据存储和业务逻辑之间有清晰的界限，所以这是一个相当无缝的集成。

现在，接近 500 kloc，我们正在将应用程序迁移到基于网格的架构。不仅 UI 将与不同计算机上的业务逻辑分离，应用程序发出的报价和订单的实际计算将被负载平衡并分散以最大限度地提高效率。如果没有 n 层架构，这将是不可能的。

在成长的每个阶段，我们要么受到清晰分离的帮助，要么受到我们自己混乱的沟通、数据、业务和 UI 的阻碍。可能没有比创建此应用程序时的分离更重要的问题了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-10T17:32:34.117

这是一个很好的问题！每个 ASP.Net 开发人员都需要考虑的事情。你可能会得到很多答案，我鼓励这些基本的常识性想法。

--将简单性和交付速度视为“成功”架构的一部分，而不仅仅是“纯度”。尝试在坚持建筑理想和实用之间取得平衡。

--一般来说，正如你提到的，将代码分成几层似乎是有意义的。我建议尽管对于特定于页面的逻辑，如果它更简单/更快，它可以留在页面中——为什么要为只在一个地方使用的代码创建通用业务对象。正如人们所说的“过早的优化是万恶之源。”。

-- 将层数和复杂性降至最低，以减少编码时间并提高可读性和可维护性。

这个网站上有很多纯粹主义者喜欢为架构的网站做架构——使用架构作为工具来为业务问题提供解决方案，而不仅仅是为了它本身的艺术形式，让它成为一个有用的工具而不是比它使用你。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T17:44:51.357

把顾虑分开。这是非常非常重要的。不要将 UI 与 Biz 和 Biz 与数据层混合。使用抽象。使用抽象也使测试（单元测试）更容易（模拟它们）。我严格把每一层都放在它所属的地方。请记住，任何项目中最高的成本是它的维护。如果你把这些问题混为一谈，那么维护将成为一场噩梦。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T17:51:32.557

我们有一个 Winforms 应用程序和一个 ASP.NET 应用程序。它们都使用相同的 Business Objects 项目（大约 140 个类）。

Winforms 项目由大约 350 个表单和用户控件类组成，其中极少数 (<10) 需要来自数据库的关于它们自己的元数据。

ASP.NET 项目有大约 100 个 .aspx 页。

我们有一个由 5 个类组成的数据访问层，它们与 ADO.NET、线程和事务有关。它们将来自业务对象的请求转换为 SQL Server 调用。

UI 层（除了少数需要关于表单大小的元数据的类）根本不访问数据库。即使是少数例外也会像其他任何事情一样通过 DAL。

业务层对数据访问层的内部工作一无所知，当它需要数据时，只调用 DAL 类上的公共方法。

在这种事情上，我根本不是原教旨主义者，但我们从来不需要在这件事上偷工减料。

简而言之，100% 纯净。做对了总是会更好。

我们现在必须有充分的理由才能摆脱这种局面。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T17:36:39.970

Code Monkeys 和 Purists 很像生活中的任何其他极端主义者。

我们有极右翼和极左翼。很少有人完全是其中之一，他们在他们坐的地方找到了一个很好的中间立场。如果不是因为极端分子，我们将不知道边界在哪里。

就我编码的方式而言。我听纯粹主义者的做法。我看到代码猴子正在讨论他们的方法。我利用我的经验来选择一个中间立场，它给我适当的灵活性和可管理性，以及我需要制作它的时间以及我实际将获得的资金数额。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T19:45:13.797

代码越大，生命周期越长，不同的人在代码上工作的次数越多（同时或在生命周期中），分层就越重要。一开始，这似乎是一些不必要的工作，但从长远来看，它会为自己付出数倍的代价。

至于强制分离：这就是为什么你的首席程序员或技术架构师需要良好的软技能以及纯技术技能。您可以尝试从技术上强制分离（见下文），但最后，您需要说服（或强制）您的开发人员保持大局清晰。

但这并不是说强制分离的技术手段没有用。事实上，我发现确保“跨境调用”有些困难，这会让人们花更多时间思考他们在跨境界面中真正需要什么，从而使界面更加简洁。困难是技术上的（因为您必须使用 COM 或 CORBA）还是其他方面（您必须填写一式三份的 7 页表格）并不重要。

# python - 禁用每个应用程序由 GTK 主题定义的像素图背景

> ID：533321
> 
> 赞同：4
> 
> 时间：2009-02-10T17:25:31.230
> 
> 标签：python, gtk, pygtk

对于我们的（开源）全屏文本编辑器，我们将 、 等的背景颜色更改`gtk.Window`为`gtk.Fixed`自定义颜色。这很好用，但是一些[GTK](http://en.wikipedia.org/wiki/GTK%2B)主题（例如[Mac4Lin](http://sourceforge.net/projects/mac4lin/)）定义了背景像素图而不是某些小部件的背景颜色。调用这些小部件的 modify_bg() 方法时，这些背景像素图不会消失。

我知道我可以`bg_pixmap[NORMAL] = 'blabla.png'`使用 gtk.rc_parse_string() 设置像素图，并且可以定义我自己的 gtkrc 覆盖。但我不知道如何取消设置`bg_pixmap[NORMAL]`。

那么，我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T20:50:24.407

是的，当然 Mac4Lin 使用像素图来获得更精细的外观以匹配 MAC 外观。好吧，要禁用那些背景，您不需要覆盖它。

如果要将背景像素图作为其父级，请将其设置为

```
bg_pixmap[state] = "<parent>" 
```

并禁用将其设置为

```
bg_pixmap[state] = "<none>" 
```

# javascript - 文档的jQuery单击事件但忽略div

> ID：533323
> 
> 赞同：8
> 
> 时间：2009-02-10T17:25:51.760
> 
> 标签：javascript, jquery, html, events, click

我有一个在线幻灯片放映，我正在使用 jQuery。我已经使用 $(document).click 事件来检测用户何时单击页面以了解何时在幻灯片中显示下一个项目符号点或移动到下一页。

我遇到的问题是我的工作让我在页面底部插入一个评论框，当有人点击评论框或保存评论按钮时，它也会触发页面的点击事件。

有没有办法让整个页面都有点击事件，但当有人在 DIV 中点击评论框/保存按钮时忽略它？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-10T17:28:45.747

您很可能需要使用事件对象的[`stopPropagation()`](http://api.jquery.com/event.stopPropagation/)方法在您的 Comments div 中停止事件的传播：

```
$('#comments').click(function(e) {
  e.stopPropagation();
}); 
```

如果这不起作用，请尝试使用[`preventDefault()`](http://api.jquery.com/event.preventDefault/)：

```
e.preventDefault(); 
```

# c# - 动态调度和绑定

> ID：533330
> 
> 赞同：14
> 
> 时间：2009-02-10T17:27:58.807
> 
> 标签：c#, java, oop

动态调度和动态绑定是一回事吗？

谢谢

马切伊

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-10T17:35:44.343

不。

Dynamic Dispatch - 实际的方法组/签名/覆盖链在编译时绑定。调用的方法取决于对象的实际运行时类型，但不会发生实际解释。它仍然是静态绑定方法的一个版本。

这是 C# 中的示例。

```
class Foo { 
  public override string ToString() { return "foo's ToString"; }
}

void Example(object p1) { 
  p1.ToString();
} 
```

对 p1.ToString 的调用是动态调度的一个示例。代码静态绑定到方法 ToString。然而，它是一个虚拟方法，所以实际调用的 .ToString() 直到运行时才知道，但**保证**调用 .ToString() 方法。它将是 p1 的实际类型的 ToString。因此，如果 p1 实际上是 Foo 的一个实例，则会调用 Foo::ToString。

动态绑定 - 实际方法在运行时绑定，并根据语言或反射框架的语义进行解释。这可能由于无法绑定而失败。

例子：

```
void CallBar(object o) {
  var method = o.GetType().GetMethod("Bar");
  method.Invoke(new object[] {o});
} 
```

在这种情况下，我们试图在有问题的对象上调用方法“Bar”。关键字正在尝试。对象上完全有可能不存在“Bar”。但这是在运行时通过动态绑定到方法“Bar”来确定的。

它们最共同的一点是，两种操作（很可能）都依赖于对象的运行时类型。

**编辑**

应OP的要求添加了更多示例

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T18:35:20.563

动态分派或动态绑定意味着在调用方法时，选择要执行的实际方法实现发生在程序运行时，因为静态没有足够的可用信息。它将基于方法名称、实际接收器类型（子类型多态性）和/或实际参数类型（重载），甚至更花哨的模式匹配。

根据[Wikipedia](http://en.wikipedia.org/wiki/Dynamic_binding)，动态绑定是 OO 语言中的一种动态调度形式，其中调用的实际方法基于操作的名称和运行时的实际接收者。

[本文](http://cmpe.emu.edu.tr/aelci/Courses/D-318/D-318-Files/oofaq/s23.htm)介绍静态类型的动态绑定（由静态类型系统辅助的动态绑定）和完全在运行时执行的动态绑定。它也将重载视为动态绑定的一种形式。

我相信您可以找到许多其他讨论动态调度或绑定的文章。据我所知，术语不是固定的和“超载”的。最好描述运行时*实际*发生的情况（如何选择特定方法的确切过程），而不是试图正确定义这两个术语中的任何一个。

# multithreading - 我怎样才能强加自己的超时？

> ID：533332
> 
> 赞同：0
> 
> 时间：2009-02-10T17:28:13.643
> 
> 标签：multithreading, timeout, abort

我必须使用 API 来调用第三方，并且最好使用它返回的响应。API 有一个内置的 30 秒超时，并且不允许您以编程方式设置它。我需要它在 12 秒内超时。这是我正在打的电话：

字符串响应 = theAPI.FunctionA(a, b, c, d);

我一直在想我可能需要使用异步调用来完成这个并在 12 秒时中止线程。另一个stackoverflow问题似乎接近我正在考虑的问题：[Implement C# Generic Timeout](https://stackoverflow.com/questions/299198/implement-c-generic-timeout)

...我只是想知道这是否是最好的方法。具体来说，我一直看到警告您无论如何都要调用 EndInvoke 的文章，我想知道引用示例中的 Abort 是否仍会适当地关闭线程？我看到有一些评论非常关注使用 Abort。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T17:30:14.137

中止线程通常是一个坏主意。为什么不让调用完成（或在 30 秒后超时），但如果超过 12 秒则忽略结果（并继续前进）？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T17:37:05.430

`Thread.Abort`当然会关闭线程，因为它会调用 Win32 [`TerminateThread`](http://msdn.microsoft.com/en-us/library/ms686717(VS.85).aspx)。

此操作的结果将取决于您`API`喜欢的关闭方式`TerminateThread`。

如果您的方法被称为`NuclearPlant.MoveRod()`or之类的东西`Defibrillator.Shock()`，我宁愿等待这 30 秒。

这种方法没有让受害者有机会进行一些清理：

> `TerminateThread`用于使线程退出。发生这种情况时，*目标线程没有机会执行任何用户模式代码*。附加到线程的 DLL 不会收到线程正在终止的通知。系统释放线程的初始堆栈。

如中所述`MSDN`：

> `TerminateThread`是一个危险的功能，只能在最极端的情况下使用。仅当您确切知道目标线程在做什么时才应该调用`TerminateThread`，并且您控制了目标线程在终止时可能正在运行的所有代码。例如，`TerminateThread`可能会导致以下问题：
> 
> *   如果目标线程拥有临界区，该临界区将不会被释放。
> *   如果目标线程正在从堆中分配内存，则不会释放堆锁。
> *   如果目标线程在终止时正在执行某些 kernel32 调用，则线程进程的 kernel32 状态可能不一致。
> *   如果目标线程正在操作共享 DLL 的全局状态，则 DLL 的状态可能会被破坏，从而影响 DLL 的其他用户。

# centos - XEN 如何将虚拟机放在 /etc/xen 以外的目录中

> ID：533342
> 
> 赞同：0
> 
> 时间：2009-02-10T17:31:12.230
> 
> 标签：centos, redhat, xen

在我的 CentOS 5.2 机器上，XEN 虚拟机配置文件必须位于 /etc/xen 才能在不指定路径的情况下启动。我想将我的虚拟机移动到 /etc/xen/vm 以将它们与 xen 服务器的配置文件分开。有没有一种简单的方法可以将默认目录从 /etc/xen 更改为 /etc/xen/vm ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T17:55:51.313

最简单的方法是遵循[本教程](http://howtoforge.com/ubuntu-8.04-server-install-xen-from-ubuntu-repositories)，用于`xen-tools`为您生成虚拟机，并指定您想要放置虚拟机的位置。然后，您可以在其中修改一个配置文件 ( `xen-tools.conf`) 并更改 dir 属性：

`dir = /etc/xen/vm`

由于您使用的是 CentOS（如果您使用的是 Ubuntu，这会容易得多），因此需要做一些额外的工作，但它仍然是可行的。

# sql - 我可以获取从 LinqDataSource 生成的 T-SQL 查询吗？

> ID：533343
> 
> 赞同：3
> 
> 时间：2009-02-10T17:31:18.660
> 
> 标签：sql, linq, .net-3.5, linqdatasource

我正在使用 LinqDataSource 来填充网格。但是现在我需要 LinqDataSource 生成的 SQL 查询来传递方法（不，我不能修改方法以不需要 SQL 查询）。

有没有办法从实例化和配置的 LinqDataSource 中获取生成的 SQL 查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T19:03:07.423

希望这可以帮助。

使用下面的函数将返回一个 SqlQueryText，您可以从该对象重建查询。

*   要获取可以使用的 sql 文本，请使用 .Text 属性
*   要获取传递的参数，您可以使用 .Params 属性

    ```
     public static SqlQueryText GetFullQueryInfo(DataContext dataContext, IQueryable query)
        {
            DbCommand dbCommand = dataContext.GetCommand(query);

            var result = new SqlQueryText();

            result.Text = dbCommand.CommandText;
            int nParams = dbCommand.Parameters.Count;
            result.Params = new ParameterText[nParams];
            for (int j = 0; j < nParams; j++)
            {
                var param = new ParameterText();
                DbParameter pInfo = dbCommand.Parameters[j];
                param.Name = pInfo.ParameterName;
                param.SqlType = pInfo.DbType.ToString();
                object paramValue = pInfo.Value;
                if (paramValue == null)
                {
                    param.Value = null;
                }
                else
                {
                    param.Value = pInfo.Value.ToString();
                }
                result.Params[j] = param;
            }
            return result;
        } 
    ```

    这是一个例子

    var results = db.Medias.Where(somepredicatehere); ClassThatHasThisMethod.GetFullQueryInfo(yourdatacontexthere, results);

编辑：

抱歉忘记包含 SqlQueryText 数据结构

```
public struct SqlQueryText
{
    public ParameterText[] Params;
    public string Text;
}

public struct ParameterText
{
    public string Name;
    public string SqlType;
    public string Value;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T18:44:47.950

您可以在运行应用程序时运行 SQL Profiler，这应该会交给您。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T18:46:15.967

查看[LinqPad](http://www.linqpad.net/)进行调试并了解它是如何工作的。但是，如果您想在运行时使用它，我认为您不走运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T17:39:47.763

Sql 只会在运行时由 Linq to Sql 基础结构生成。

我认为有一些工具可以在调试器中查看生成的 Sql，但是如果您不打算使用 linq 动态生成 Sql，您不应该寻找一个简单的 Sql 设计器吗？

[我在Scottgu 的博客](http://weblogs.asp.net/scottgu/archive/2007/07/31/linq-to-sql-debug-visualizer.aspx)上找到了一个 Linq To Sql Debug 可视化工具。

# wpf - 在 WPF FlowDocument 中禁用搜索

> ID：533346
> 
> 赞同：1
> 
> 时间：2009-02-10T17:32:22.370
> 
> 标签：wpf, flowdocument

我有一个像这样在 XAML 中定义的 FlowDocument；

```
<FlowDocumentScrollViewer>
    <FlowDocument>
        <Paragraph>
            <Run>Hello</Run>
        </Paragraph>
    </FlowDocument>
</FlowDocumentScrollViewer> 
```

我想做的是防止在您按 Ctrl-F 或 F3 时出现“查找”和“缩放”控件。

这可能吗？

提前致谢！马特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T17:34:02.177

您可以处理`PreviewKeyDown`此控件的事件，如果按下 Ctrl-F 或 F3，则将事件标记为已处理。这应该可以防止控件本身响应该事件并显示 Find 和 Zoom 控件。

# asp.net - 使用中继器控件构建动态链接

> ID：533364
> 
> 赞同：5
> 
> 时间：2009-02-10T17:36:03.343
> 
> 标签：asp.net, .net-2.0, repeater

我正在使用中继器控件呈现数据。假设数据源中有 2 个字段：productName 和 ProductID

在以下代码中：

```
<asp:Repeater ID="Repeater1" runat="server" DataSourceID="SqlDataSource1">
<HeaderTemplate>
<ul>
</HeaderTemplate>
<ItemTemplate>
<li>
<%#Eval("productName")%> <br/>
<asp:HyperLink ID="lnkDetails" runat="server" NavigateUrl="~/Details.aspx?ID=">See Details</asp:HyperLink>
</li>
</ItemTemplate>
<FooterTemplate>
</ul>
</FooterTemplate> 
```

我需要修改什么

```
<asp:HyperLink ID="lnkDetails" runat="server" NavigateUrl="~/Details.aspx?ID=">See Details</asp:HyperLink> 
```

在链接**NavigateUrl="~/Details.aspx?ID="中包含从 ProductID 检索的值**

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-10T17:43:20.843

`NavigateUrl="~/Details.aspx?ID=<%# Eval("productID") %>"`应该管用...

……但事实并非如此！

最优雅的方式应该是：

```
<asp:HyperLink ID="lnkDetails" runat="server" NavigateUrl='<%# Eval("ProductID", "~/Details.aspx?ID={0}") %>'>See Details</asp:HyperLink> 
```

# email - 如何在我的生产机器上接收与域有关的所有电子邮件？

> ID：533373
> 
> 赞同：0
> 
> 时间：2009-02-10T17:37:41.827
> 
> 标签：email, postfix-mta, forward, procmail

我有一个奇怪的要求，任何网站用户（不是 linux 系统用户）都会获得一个电子邮件 ID，比如 jack@mywebsite.com、sarah@mywebsite.com，他们将在仪表板中内置一个收件箱功能。任何外部用户（可以是地球上的任何人/不完全是我的网站用户）都可以发送电子邮件至此 jack@mywebsite.com，并且 jack 在她的收件箱（内置在她的仪表板中）接收电子邮件。要做到这一点，我认为，以下是先决条件：

1.  我需要将 MX 记录指向 mywebsite.com 的生产机器
2.  我需要在我的 prod 机器上运行一个 smtp 服务器（可以是 Postfix）

除了这些，我还需要使用 MTA 设置任何类型的邮件帐户吗？我不想将这些网站用户创建为实际的系统用户（我喜欢做“useradd -s /sbin/nologin username”）我怎样才能完成这整个行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T17:48:11.333

在 sendmail 中，这可以通过[virtusertable](http://www.sendmail.org/m4/features.html#virtusertable)完成。对于后缀，这是[虚拟别名表](http://www.postfix.org/virtual.5.html)。

因此，使用 postfix SMTP 服务器设置为域设置一个 MX 记录以指向您的主机。

然后将 postfix 配置为接受 *@mywebsite.com 并将其发送到本地邮箱。虚拟域中的详细信息[如何](http://www.postfix.org/VIRTUAL_README.html#virtual_alias)
将虚拟域 (mywebsite.com) 添加到 main.cf 文件，然后添加一个 @mywebsite.com 条目以指向真实帐户，例如“webmail”。

然后为“webmail”设置一个真正的 linux 帐户，并在该帐户中配置 procmail 以处理所有传入的电子邮件，并做任何必要的事情将其放入他们的 web 仪表板。

# windows-7 - Vista 和 Windows 7 中的小工具编程之间的区别？

> ID：533375
> 
> 赞同：2
> 
> 时间：2009-02-10T17:38:00.967
> 
> 标签：windows-7, windows-vista, windows-desktop-gadgets

除了 Windows 7 中没有侧边栏这一显而易见的事实之外，小工具的组合方式有什么不同吗？我应该注意什么/我应该阅读的资源？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T19:36:57.750

[MSDN](http://msdn.microsoft.com/en-us/library/dd370867(VS.85).aspx)涵盖了 Vista 和 Windows 7 中小工具的差异。

我认为您必须处理的主要问题是 IE 8 渲染引擎和缺少侧边栏。他们在文章中介绍了如何处理 System.Gadget.onDock 和 System.Gadget.onUndock 以保持向后兼容性。

# oracle - 如何使用 HQL 返回 rownum 列值？（使用 Oracle 数据库）

> ID：533376
> 
> 赞同：2
> 
> 时间：2009-02-10T17:38:02.527
> 
> 标签：oracle, hibernate, oracle10g, hql

我有一个复杂的 HQL 查询。

我想访问 Oracle 特定的**rownum**列值作为我返回结果的一部分。如何编写查询（和/或更改我的 hbm.xml）以支持此功能？

到目前为止我尝试过的方法不起作用：

修改我的 hbm.xml

```
<property name="rownum" type="int" update="false" insert="false" generated="never"/> 
```

和一个查询，例如：

```
"select dog.rownum from Dog as dog where ..." 
```

但我得到*java.sql.SQLException: ORA-01747: invalid user.table.column, table.column, or column specification*

我怀疑我可能需要将一些 sql 与我的复杂 hql 查询混合在一起......欢迎提出建议。谢谢。

* * *

一些背景：

*   [http://ronfrancis.wordpress.com/2007/10/16/dont-forget-an-order-by-for-pagination-queries/](http://ronfrancis.wordpress.com/2007/10/16/dont-forget-an-order-by-for-pagination-queries/)
*   hibernate 使用 oracle 的 rownum 'under the hood' 对结果进行分页。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T17:49:07.710

ROWNUM 不属于任何表，因此您的查询应该是：

```
"select rownum from Dog as dog where ..." 
```

例如：

```
SQL> select emp.ename, rownum from emp;

ENAME          ROWNUM
---------- ----------
SMITH               1
ALLEN               2
WARD                3
JONES               4
MARTIN              5
BLAKE               6
CLARK               7
SCOTT               8
KING                9
TURNER             10 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T01:01:52.773

如果您真的想在映射中执行此操作，您可以尝试将其定义为公式而不是列。如果 Hibernate 无法将表名识别为列，则它可能不会预先添加表名。

# c# - 拳击，你的偏好是什么，你认为哪个更快？

> ID：533379
> 
> 赞同：3
> 
> 时间：2009-02-10T17:39:27.953
> 
> 标签：c#, word-wrap, boxing

简而言之，我认为拳击是一种烦恼。让我们看看一些替代方案......

```
public class Box<T> 
    where T : struct
{
    public T Value { get; set; }

    public static implicit operator T(Box<T> box)
    {
        return box.Value;
    }
} 
```

System.Int32 派生自抽象类 System.ValueType，后者派生自 System.Object 类。您不能从 C# 中的 System.ValueType 派生，但我猜想 struct 关键字正是这样做的，并且 CLI 将这些类型定义识别为具有按值传递的语义。无论如何，当将结构分配给对象类型时，就会发生装箱。我不想陷入拳击本身，而是想直接进入它。

我查看了一些由 C# 编译器生成的 IL。

```
object obj = 1;

.locals init ([0] object obj)
L_0000: nop 
L_0001: ldc.i4.1 
L_0002: box int32 // Convert a value type (of the type specified in valTypeToken) to a true object reference. 
L_0007: stloc.0 
```

在 MSDN 上找到这个...

值类型在公共语言基础结构 (CLI) 中有两种不同的表示形式：

*   当值类型嵌入另一个对象或堆栈时使用的“原始”形式。

*   一种“盒装”形式，其中值类型中的数据被包装（盒装）到一个对象中，因此它可以作为独立实体存在。

这使我得出结论，编写这样的代码应该同样昂贵......

```
var box = obj as Box<int>;
if (box != null)
{
    Console.WriteLine(box.Value);
} 
```

如果我打算将相同的值作为 System.Object 传递，我真的想每次都将 ValueType 拆箱和装箱吗？我的直觉告诉我不，但我真的找不到任何人愿意评论所有这些喋喋不休的好动机？

## 编辑

有人发现自己在这样做吗？我意识到它可能看起来很奇怪，但有一次我发现自己处于一个位置，我想基于几种不同的表示来抽象计算。我是这样做的，并使用 lambda 表达式。它与装箱并没有真正的关系，但它允许我将任何 ValueType（这个结构方便地以 8 字节对齐）视为一种单一类型“ReinterpretCast”。

```
[StructLayout(LayoutKind.Explicit)]
public struct ReinterpretCast
{
    [FieldOffset(0)] sbyte @sbyte;
    [FieldOffset(0)] byte @byte;
    [FieldOffset(0)] short @ushort;
    [FieldOffset(0)] ushort @short;
    [FieldOffset(0)] int @int;
    [FieldOffset(0)] uint @uint;
    [FieldOffset(0)] long @long;
    [FieldOffset(0)] ulong @ulong;
    [FieldOffset(0)] float @float;
    [FieldOffset(0)] double @double;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T17:49:34.667

我不完全确定你的问题。您只是在问您的解决方案是否比普通拳击更好？它当然有一些吸引力。如果您要问为什么一开始没有以这种方式实现装箱，请记住 .NET 没有泛型开始。

编辑：无论如何，拳击对于泛型来说是相对罕见的。不要忘记，如果对您的类型的实例的引用被传递为 as `object`（这通常是装箱的情况），您仍然需要进行运行时强制转换。也不要忘记接口——如果一个值类型实现了一个接口，那么它对应的用于装箱的引用类型也是如此。您的解决方案不会删除拳击的使用，因为您不能让您的类型“假装”来实现接口。（你也许可以用 DLR 做点什么，但到那时大部分要点都已经丢失了 :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T17:52:35.050

我们认为更快的是完全无关紧要的。在考虑什么更快时，只有探查器是相关的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T19:17:09.013

> “如果我打算将相同的值作为对象传递，我真的想每次都拆箱/装箱吗？”

简短的回答：不，你不想做很多装箱/拆箱。它会产生开销：额外的额外垃圾并且往往很慢（尽管我认为速度已经在以后的框架版本中进行了优化）。

编辑：但是，如果您“将相同的值作为对象传递”，则在需要之前不强制转换为值类型，那么它会一直装箱而不会被拆箱。

但是，正如每个人所说，无论如何您都不需要“将相同的值作为对象传递”。这就是泛型的用途，除非您正在使用 Framework 1.x。那时，当 BCL 集合类使用 System.Object 并且任何进入的值类型都被装箱时，装箱更加相关。

（顺便说一句，如果通过接口访问装箱的值类型，则不会取消装箱。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-18T16:50:45.890

您的问题的标题错过了我认为最有趣的方面：​​系统的拳击行为与`Box<T>`类型的行为有何不同。有几点不同：

(1) boxed`T`将实现与 a 相同的接口`T`，使用相同的代码，但主要使用类语义而不是值语义，但使用古怪的`Equals`方法。

(2)`T`在 C# 或 vb.net 中，改变一个装箱通常会很麻烦，但是一个装箱`T`永远不会真正不可变，因为允许不受信任的可验证代码这样做，即使它在某些语言中很尴尬（在 C++/CLI 中很容易） . 甚至像 boxed 这样的类型在装箱`Int32`时也是可变的。相比之下，可以定义一个`ImmutableBox<T>`，它采用 type 的构造函数`T`，其字段将是真正不可变的。

(3) 即使是在装箱时很容易可变的结构类型（例如，因为它们实现了一个`IEnumerator<T>`像`Equals`通常用它来测试它们的临时状态的相等性。相比之下，如果存在可变和不可变的盒子类型，则不可变类型可以检查状态是否相等，而可变类型可以检查引用是否相等。

(4) 隐式转换 from `T`to`Box<T>`不会排除类型`T`定义隐式转换到接口类型的可能性。相比之下，因为所有类型都可以隐式转换为`Object`，所以 vb.net 和 C# 都不允许在结构类型和接口之间进行隐式用户转换。

(5) 如果没有专门的编译器对装箱的支持，目前接受 param-array of 的方法将`Object[]`无法自动将参数从诸如 to 之类的类型`Int32`转换`Box<Int32>`。另一方面，添加一种请求某些参数自动装箱的方法可能比在任何地方都使用隐式装箱更好。请注意，如果存在这样的方法，则可以指定每个参数都应放在 a 中`Box<T>`，从而可以区分传递 a`T`和 a `Box<T>`（因为后者将作为 a 传递`Box<Box<T>>`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T18:16:22.903

好的，您在这里涉及到几个主题。首先，让我们看一下值类型以及它们存在的原因。*当您需要值语义*时，您可以使用值类型：

> 对于类，两个变量可以引用同一个对象，因此对一个变量的操作可能会影响另一个变量引用的对象。对于结构，每个变量都有自己的数据副本（除了 ref 和 out 参数变量），对一个变量的操作不可能影响另一个。此外，由于结构不是引用类型，因此结构类型的值不可能为空。

例如，所有数字类型都是值类型，因为它们需要具有值语义。如果变量**x**的值为 17 并且您将**x**分配给**y**，那么**y**将有*自己的*值 17 并且递增**y**不会将**x**更改为 18。因此，除非您有充分的理由，否则*仅*在定义类型时使用结构这需要具有价值语义。

在实现级别，通过使用内联分配来强制执行值语义。[你可以在这里](http://www.albahari.com/valuevsreftypes.aspx)阅读更多关于它的信息。

这将我们引向拳击。拳击什么时候发生？当您将值类型转换为引用类型时。您使用类型**对象**作为示例，但对于 C# 泛型，这在实践中应该很少发生。更常见的情况是将值类型转换为接口。例如，将**double**类型转换为**IEquatable**或**IComparable**。无论如何，如果您将值类型转换为引用类型，则装箱将并且必须发生。

当拳击发生时，真正发生了什么？制作要装箱的实例的*副本并将*其作为独立对象放置在堆上，以便即使原始实例超出范围时也可以安全地引用它。如果不是因为拳击，很容易让 CLR 尝试访问无效内存，我们都知道这是一件很糟糕的事情。

那么，拳击是好是坏呢？一方面它很好，因为它允许您在需要时安全地将值类型转换为引用类型。另一方面，它会创建“垃圾”——被丢弃并添加到垃圾收集器必须做的工作的对象的短暂实例。这很糟糕吗？仅在[某些情况下](http://blogs.msdn.com/shawnhar/archive/2007/07/02/twin-paths-to-garbage-collector-nirvana.aspx)，例如开发 XNA 游戏。如果这是你的情况，你会想要避免不受控制的拳击；如果是这样，我还邀请您访问我的博客，在那里我[对该主题有一些建议](http://beardseye.blogspot.com/search/label/boxing)。

# python - Python 中的动态/运行时方法创建（代码生成）

> ID：533382
> 
> 赞同：49
> 
> 时间：2009-02-10T17:40:05.953
> 
> 标签：python, metaprogramming, exec

我需要在运行时为方法生成代码。能够运行任意代码并拥有文档字符串非常重要。

我想出了一个结合`exec`和的解决方案`setattr`，这是一个虚拟示例：

```
class Viking(object):
    def __init__(self):
        code = '''
            def dynamo(self, arg):
                """ dynamo's a dynamic method!
                """
                self.weight += 1
                return arg * self.weight
            '''
        self.weight = 50

        d = {}
        exec code.strip() in d
        setattr(self.__class__, 'dynamo', d['dynamo'])

if __name__ == "__main__":
    v = Viking()
    print v.dynamo(10)
    print v.dynamo(10)
    print v.dynamo.__doc__ 
```

是否有更好/更安全/更惯用的方法来实现相同的结果？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-02-10T22:46:31.380

基于 Theran 的代码，但将其扩展到类上的方法：

```
 class Dynamo(object):
    pass

def add_dynamo(cls,i):
    def innerdynamo(self):
        print "in dynamo %d" % i
    innerdynamo.__doc__ = "docstring for dynamo%d" % i
    innerdynamo.__name__ = "dynamo%d" % i
    setattr(cls,innerdynamo.__name__,innerdynamo)

for i in range(2):
    add_dynamo(Dynamo, i)

d=Dynamo()
d.dynamo0()
d.dynamo1() 

```

哪个应该打印：

```
 in dynamo 0
in dynamo 1 

```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-10T18:38:47.840

函数文档字符串和名称是可变属性。你可以在内部函数中做任何你想做的事情，甚至可以有多个版本的内部函数供 makedynamo() 选择。无需使用字符串构建任何代码。

这是解释器的一个片段：

```
>>> def makedynamo(i):
...     def innerdynamo():
...         print "in dynamo %d" % i
...     innerdynamo.__doc__ = "docstring for dynamo%d" % i
...     innerdynamo.__name__ = "dynamo%d" % i
...     return innerdynamo

>>> dynamo10 = makedynamo(10)
>>> help(dynamo10)
Help on function dynamo10 in module __main__:

dynamo10()
    docstring for dynamo10 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-10T18:38:43.740

Python 将允许您在函数中声明一个函数，因此您不必做这些`exec`诡计。

```
def __init__(self):

    def dynamo(self, arg):
        """ dynamo's a dynamic method!
        """
        self.weight += 1
        return arg * self.weight
    self.weight = 50

    setattr(self.__class__, 'dynamo', dynamo) 
```

如果你想拥有多个版本的函数，你可以将所有这些放在一个循环中，并改变你在`setattr`函数中命名它们的名称：

```
def __init__(self):

    for i in range(0,10):

        def dynamo(self, arg, i=i):
            """ dynamo's a dynamic method!
            """
            self.weight += i
            return arg * self.weight

        setattr(self.__class__, 'dynamo_'+i, dynamo)
        self.weight = 50 
```

（我知道这不是很好的代码，但它明白了这一点）。至于设置文档字符串，我知道这是可能的，但我必须在文档中查找它。

**编辑**：您可以通过设置文档字符串`dynamo.__doc__`，因此您可以在循环体中执行以下操作：

```
dynamo.__doc__ = "Adds %s to the weight" % i 
```

**另一个编辑**：在@eliben 和@bobince 的帮助下，应该解决关闭问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-02-16T21:48:11.173

```
class Dynamo(object):
    def __init__(self):
        pass

    @staticmethod
    def init(initData=None):
        if initData is not None:
            dynamo= Dynamo()
            for name, value in initData.items():
                code = '''
def %s(self, *args, **kwargs):
%s
                            ''' % (name, value)
                result = {}
                exec code.strip() in result
                setattr(dynamo.__class__, name, result[name])

            return dynamo

        return None

service = Dynamo.init({'fnc1':'pass'})
service.fnc1() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-09T11:46:54.050

更通用的解决方案：

您可以调用 Dummy 类实例的任何方法。文档字符串是根据方法名称生成的。通过仅返回它们来演示任何输入参数的处理。

**代码**

```
class Dummy(object):

    def _mirror(self, method, *args, **kwargs):
        """doc _mirror"""
        return args, kwargs

    def __getattr__(self, method):
        "doc __getattr__"

        def tmp(*args, **kwargs):
            """doc tmp"""
            return self._mirror(method, *args, **kwargs)
        tmp.__doc__ = (
                'generated docstring, access by {:}.__doc__'
                .format(method))
        return tmp

d = Dummy()    
print(d.test2('asd', level=0), d.test.__doc__)
print(d.whatever_method(7, 99, par=None), d.whatever_method.__doc__) 
```

**输出**

```
(('asd',), {'level': 0}) generated docstring, access by test.__doc__
((7, 99), {'par': None}) generated docstring, access by whatever_method.__doc__ 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-03-29T16:51:41.610

请原谅我的英语不好。

我最近需要生成动态函数来绑定每个菜单项以打开 wxPython 上的特定框架。这就是我所做的。

首先，我创建了菜单项和框架之间的映射列表。

```
menus = [(self.menuItemFile, FileFrame), (self.menuItemEdit, EditFrame)] 
```

映射上的第一项是菜单项，最后一项是要打开的框架。接下来，我将每个菜单项中的 wx.EVT_MENU 事件绑定到特定框架。

```
for menu in menus:
    f = genfunc(self, menu[1])
    self.Bind(wx.EVT_MENU, f, menu[0]) 
```

genfunc 函数是动态函数生成器，代码如下：

```
def genfunc(parent, form):
    def OnClick(event):
        f = form(parent)
        f.Maximize()
        f.Show()
    return OnClick 
```

# vim - 打印时如何在vim中启用自动换行

> ID：533385
> 
> 赞同：6
> 
> 时间：2009-02-10T17:41:09.070
> 
> 标签：vim, printing, word-wrap

我想打印一个简单的文本文档，并确保单词在单词边界上换行。我都试过了

```
set linebreak 
```

和

```
set wrap 
```

但是在打印时，它只是在单词中间的右栏中中断。这可以打印吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T18:21:01.940

您正在创建一个没有任何内置换行符的文本文件，因此每个段落都是一个“行”，即使设置了换行符和换行，看起来它们也是多行）。这就是打印在固定位置中断的原因。（根据[http://www.vim.org/htmldoc/various.html#printing](http://www.vim.org/htmldoc/various.html#printing)似乎你不能在打印过程中让 vim 尊重换行/换行。）

为避免这种情况，如果您希望在编辑时换行，请执行

```
set textwidth=70 
```

在第 70 列换行。如果你希望你的文件有很长的行（例如，当加载到 MS Word 或其他东西时它的格式很好），那么你必须在打印之前对文本版本进行预处理。因此，例如，您可以尝试：

```
fmt file.txt | lpr 
```

或者如果您安装了 enscript，您应该可以尝试：

```
enscript --word-wrap file.txt 
```

打印。可以通过在 vim 中运行来包装现有文件：

```
gggqG 
```

也就是说，'gg' 转到文件的开头，'gqG' 将'gq' 从当前位置（即第一行）重新格式化到最后一行（通过转到'G'）。'gq' 将尊重您当前的 textwidth 设置。

# asp.net-mvc - ASP.Net MVC 视图架构

> ID：533386
> 
> 赞同：3
> 
> 时间：2009-02-10T17:41:27.307
> 
> 标签：asp.net-mvc, model-view-controller, architecture, routing

视图中的文件夹可以有子文件夹吗？如果是这样，控制器如何到达他们？例如......我想让以下网址正常工作：

*   管理员/索引
*   管理员/个人资料/索引
*   管理员/个人资料/编辑/1
*   管理员/组/索引
*   管理员/组/编辑/1

那么，我会在 Admin 中为 Profile 和 Group 创建一个文件夹作为子文件夹吗？

我尝试了这个并在全局文件中映射了一条路线，但这似乎不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T18:10:34.447

似乎您正在尝试创建管理面板并将其他与控制器相关的操作放入管理控制器中。我相信这不是最有效的方法。你可以简单地这样做：

如果`RedirectToAction`管理链接需要，用作返回

*   管理员/索引
*   管理员/个人资料
*   管理员/组

并让适当的控制器休息

*   简介/索引
*   个人资料/编辑/1
*   组/索引
*   组/编辑/1

还添加`[Authorize(Roles = "Administrator")]`和`[AcceptVerbs(HttpVerbs.Post)]`用于创建/编辑/删除操作

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T17:50:17.037

只需使返回操作如下所示：

```
return View("Profile/Index"); 
```

这将使控制器的技巧找到“子视图”。要将 URL 映射到正确的控制器，您可以使用路由系统，但忽略子视图，只需映射到正确的控制器并让控制器处理正确的视图。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T13:32:44.390

您可以创建自己的 ViewEngine 并覆盖在哪里查找类似这样的文件

```
public class MyViewEngine : WebFormViewEngine
{
    public MyViewEngine()
    {
        ViewLocationFormats = new[] { 
            "~/{0}.aspx",
            "~/{0}.ascx",
            "~/Views/{1}/{0}.aspx",
            "~/Views/{1}/{0}.ascx",
            "~/Views/Shared/{0}.aspx",
            "~/Views/Shared/{0}.ascx",
        };

        MasterLocationFormats = new[] {
            "~/{0}.master",
            "~/Shared/{0}.master",
            "~/Views/{1}/{0}.master",
            "~/Views/Shared/{0}.master",
        };
        PartialViewLocationFormats = ViewLocationFormats;

    }
} 
```

然后在您的应用程序中开始添加

```
ViewEngines.Engines.Add(new MyViewEngine()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T17:41:31.450

还有另一个选择是使用区域的概念来实现视图和控制器的全局分组，如这篇有趣的 Billy McCafferty 的帖子中所述：

[在视图下创建 MVC“区域”作为子文件夹](http://devlicio.us/blogs/billy_mccafferty/archive/2009/01/22/mvc-quot-areas-quot-as-hierarchical-subfolders-under-views.aspx)

该代码可用，因此您可以检查一切是如何完成的，但基本上将 ViewEngine 替换为另一个，类似于原始的，但视图位置的管理不同，并根据定义的区域注册路线。

# c - Win32API函数加入目录？

> ID：533387
> 
> 赞同：4
> 
> 时间：2009-02-10T17:41:59.117
> 
> 标签：c, winapi, path, filesystems

Win32 API 有连接两条路径的功能吗？

我找不到它，所以我想在自己滚动之前先问一下。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T17:59:27.640

也许您想要[Shell Path Handling Functions](http://msdn.microsoft.com/en-us/library/bb773559(VS.85).aspx)中的[PathCombine](http://msdn.microsoft.com/en-us/library/bb773571(VS.85).aspx)功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T17:45:14.867

我不确定加入两条路径是什么意思，但您可以使用[CreateSymbolicLink](http://msdn.microsoft.com/en-us/library/aa363878(VS.85).aspx)将一个目录链接到另一个目录。另一种选择是[CreateHardLink](http://msdn.microsoft.com/en-us/library/aa365006(VS.85).aspx)，它是一种为文件提供多个名称的方法。还有可用的联结点，这是链接目录的另一种方式。

请注意，所有这些都不同于由 shell 解释的更用户友好的快捷方式 (*.lnk) 文件。

如果您不必从代码中执行此操作，请使用 SysInternals（现为 Microsoft 的）[Junction](http://technet.microsoft.com/en-us/sysinternals/bb896768.aspx)实用程序。

# java - 如何测试消息队列客户端？

> ID：533388
> 
> 赞同：0
> 
> 时间：2009-02-10T17:42:10.067
> 
> 标签：java, continuous-integration, message-queue

我正在开发一个 java 消息队列客户端（beanstalk），现在我的测试看起来像这样：

```
  //确保我们的getJob可以处理utf8字符
  @测试
  公共无效测试UTF8（）{
    豆=新豆茎（）；
    工作工作 = 新工作（）；
    bean.putJob("€");
    工作 = bean.getJob();
    assertEquals("€", job.msg);
    bean.close();
  }

```

我读到您不应该测试实际队列本身，因为它不是我编写的代码，但我确实编写了客户端代码——有没有更好的方法来编写这个？我真的需要测试来保证自己，但除了风格之外，为我的 CI 设置也是一件痛苦的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T17:49:16.930

我认为编写单元测试来确定/记录外部库的行为没有任何问题。如果您在代码库中包含该测试，那么您将记录您的队列需要支持 UTF8 的事实；如果您将来更改为不同的排队机制，该测试将中断并需要重写，迫使新排队机制的实现者考虑新系统是否也可以处理 UTF8。这是一件好事，在我看来。

至于在 CI 中进行设置，我的建议是将其归类为集成测试，并在安装了队列支持的 CI 机器上运行它，如果你有的话。

# .net - 当一个js错误指向viewstate的一部分是什么意思？

> ID：533395
> 
> 赞同：1
> 
> 时间：2009-02-10T17:43:38.050
> 
> 标签：.net, asp.net, ajax, debugging, asp.net-ajax

我对 asp.net ajax 相当缺乏经验，并且遇到了引发 javascript 错误的问题（找不到对象）。

然后调试器停止并指向我的视图状态的子字符串，它看起来像下面这样（不完全是因为我的视图状态很大），椭圆之间的部分突出显示：

```
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" 
       value="ObMUE...X78PmJHLJkWcHW4OXxH7/QxjqBI...m2" /> 
```

调用堆栈同样无用，阅读

> JScript - form1 匿名函数

这是什么意思，我该如何调试它？

**编辑：**正如我在一些评论中所说，Firebug 不是一个选项。该应用程序仅限于 IE（我们正在尝试修复该问题，但它还有很长的路要走）并且不能与任何其他浏览器一起使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T17:50:56.317

您的错误中报告的行号可能具有误导性。我建议使用调试器单步执行 javascript。我通常使用 IE 和 Visual Studio 或 microsoft 脚本调试器来执行此操作（请查看[此链接](http://blogs.msdn.com/ie/archive/2004/10/26/247912.aspx)以获取指导）。Firefox 中还有一个很好的调试器，叫做[Firebug](http://getfirebug.com/)。

或者，如果您使用的是 Visual Studio 2008，您可以在 javascript 行上放置一个断点并按 F5。

编辑：哎呀，我没有意识到你已经在使用调试器了。您的页面是否通过 ScriptManager.RegisterClientScriptBlock 等发出 javascript？包含的文件呢，您是否使用任何可能来自错误的 js 框架？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T17:49:05.777

通过浏览器错误消息进行调试，尤其是 IE，是出了名的困难。即使是简单的错误条件，如无效引用，也会导致极其神秘的消息。

我会推荐一个好的 Javascript 调试器，比如 FireBug。它使查找和修复 javascript 问题变得更加容易。

# python - 在 python 2.4 中，如何使用 csh 而不是 bash 执行外部命令？

> ID：533398
> 
> 赞同：4
> 
> 时间：2009-02-10T17:44:23.603
> 
> 标签：python, shell, csh, tcsh

如果不使用新的 2.6 子进程模块，我怎样才能让 os.popen 或 os.system 使用 tcsh 而不是 bash 来执行我的命令？在执行一些其他命令之前，我需要获取一些用 tcsh 编写的脚本，我需要在 python2.4 中执行此操作。

编辑感谢使用'tcsh -c'的答案，但我想避免这种情况，因为我必须逃避疯狂。该字符串将由 bash 解释，然后由 tcsh 解释。我将不得不做类似的事情：

```
os.system("tcsh -c '"+re.compile("'").sub(r"""'"'"'""",my_cmd)+"'") 
```

我不能告诉 python 打开一个“tcsh”子进程而不是一个“bash”子进程吗？那可能吗？

PS 我意识到 bash 是猫的喵喵叫，但我在公司环境中工作，我将选择*不*打 tcsh 与 bash 之战——更大的鱼要炸。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-10T17:53:19.697

只需将 shell 作为命令的一部分添加前缀即可。我没有安装 tcsh 但安装了 zsh：

```
>>> os.system ("zsh -c 'echo $0'")
zsh
0 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-10T17:50:02.310

怎么样：

```
>>> os.system("tcsh your_own_script") 
```

或者只是编写脚本并添加

```
#!/bin/tcsh 
```

在文件的开头，让操作系统来处理。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-10T18:06:53.177

只需将 shell 设置为`tcsh`：

```
>>> os.environ['SHELL'] = 'tcsh'
>>> os.environ['SHELL']
'tcsh'
>>> os.system("echo $SHELL")
tcsh 
```

# jsp - 可以在自定义 TagSupport 类中包含一个 jsp，并指定正文应该去哪里？

> ID：533405
> 
> 赞同：1
> 
> 时间：2009-02-10T17:45:56.673
> 
> 标签：jsp, jsp-tags

我想使用自定义 jsp 标签来帮助在我的应用程序中构建菜单。但是，我希望所有实际的 HTML 都存在于 JSP 文件中，而不是 Java 类中。

所以，假设我有一个这样的标签：

```
<mytags:Menu>
  <mytags:MenuItem name="foo"/>
  <mytags:MenuItem name="bar"/>
  <mytags:MenuItem name="baz"/>
</mytags:Menu> 
```

然后我可能有我的`Menu`标签的类，如下所示：

```
public class MenuPill extends TagSupport {
    public int doStartTag() throws JspException {
        try {
            pageContext.include("/menu/menu.jsp");
        } catch (ServletException e) {
            throw new JspException(e);
        } catch (IOException e) {
            throw new JspException(e);
        }
        return super.doStartTag();
    }
} 
```

我的`menu.jsp`文件是菜单本身的包装器，可能如下所示：

```
<div id="menu>
  <%somehow include the body here%>
</div> 
```

我想要做的是将我的`mytags:Menu`标签正文（它将为实际菜单项生成 HTML）放入`menu.jsp`开始和结束标签之间的 , 中。我知道我可以将它分成两个不同的 jsp 文件，一个用于开始标记，一个用于结束标记，但这似乎很草率。

是否有可能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T17:50:12.497

我真的建议您使用[jsp 2.0 标记文件](http://www.onjava.com/pub/a/onjava/2004/05/12/jsp2part4.html)而不是您建议的方法。创建 Jsp 2.0 标记文件是为了解决您所描述的问题。结合jstl（如果它真的很复杂，可能还有java类），您应该能够实现相同的目的，但使用更简洁的方法，代码和表示的分离更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T17:58:31.837

如果您的 web 应用程序中的每个页面都需要相同的菜单，那么您可以考虑使用[Tiles](http://tiles.apache.org/)来定义[复合视图](http://tiles.apache.org/framework/tutorial/pattern.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T12:43:51.390

您可以创建自定义标签，如...

**模板.tld**

```
<?xml version="1.0" encoding="UTF-8"?>
<taglib version="2.0" xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee web-jsptaglibrary_2_0.xsd">
  <tlib-version>1.0</tlib-version>
  <short-name>template</short-name>
  <uri>/template</uri>
  <tag-file>
    <name>block</name>
    <path>/META-INF/tags/template/block.tag</path>
  </tag-file>
  <tag-file>
    <name>stringBlock</name>
    <path>/META-INF/tags/template/stringBlock.tag</path>
  </tag-file>
</taglib> 
```

**执行**

```
<%@tag import="org.mentawai.template.*" pageEncoding="UTF-8"%>
<%@attribute name="id" required="true"%>

<%
  Page page = (Page)request.getAttribute(TemplateServlet.PAGE_ATTR);
  Page block = page.getBlock(id);
  String view = "";
  if (block == null) {
      throw new ServletException("Block " + id + " doesn't exists");
  }
  request.setAttribute(TemplateServlet.PAGE_ATTR, block);
  view = block.getView();
  TemplateServlet.executeListener(block, request, response, application);

  String oldView = (String)request.getAttribute("_view");
  request.setAttribute("_view", "/" + view);
%>

<jsp:include page="${_view}" flush="true"/>

<%
  request.setAttribute("_view", oldView);
  request.setAttribute(TemplateServlet.PAGE_ATTR, page);
%> 
```

参考： [http ://docs.oracle.com/javaee/1.4/tutorial/doc/JSPTags5.html](http://docs.oracle.com/javaee/1.4/tutorial/doc/JSPTags5.html)

# tdd - 当我运行单元测试时，是什么导致 Cassini 加载

> ID：533412
> 
> 赞同：2
> 
> 时间：2009-02-10T17:47:35.920
> 
> 标签：tdd, cassini

我有一个解决方案的测试项目，其中涉及一个 MVC Web 应用程序和几个类库。我正在使用模拟对象和 System.Web.Abstractions 来避免对 ASP.NET 内部对象的依赖。但是当我开始我的测试项目 Cassini 加载。如果我立即停止卡西尼，我所有的测试仍然通过。那么为什么会加载呢？这不是它正在加载的问题。但是，如果我做的一切都是正确的，它似乎不应该加载。那么是什么导致它在我运行测试时加载？

该项目正在进行很多更改，而且我已经有几天没有直接进行它了，所以我不知道 Cassini 是什么时候开始运行的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-03-16T08:25:59.263

在运行单元测试项目时，我实际上是在尝试寻找运行 cassini 的方法。我可以通过设置对 Web 项目的显式项目依赖来做到这一点。

即右键单击单元测试项目>项目依赖项>勾选web项目。

对于您的情况，它可能会撤消此操作。取消勾选 web 项目。希望有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T14:34:58.433

听起来您的测试正在触及 System.Web.Abstractions 之外的东西。您正在接触抽象程序集中的哪些类？需要此信息来确定为什么要加载卡西宁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-12T14:20:15.513

好的，所以我的问题的实际答案就在这里：[如何将 VS2008 配置为仅在具有多个项目的解决方案中打开一个 Web 服务器？](https://stackoverflow.com/questions/16363/how-do-you-configure-vs2008-to-only-open-one-webserver-in-a-solution-with-multipl)

事实证明，您可以转到属性窗口（选择项目-> F4）并通过将“调试时始终启动”设置为“false”来关闭它。最后，这一直很烦人，甚至当我的测试项目完全不依赖于 Web 项目时也会发生这种情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-04T00:25:08.917

我不做 asp.mvc 但似乎很常见。

这是一个wep应用程序，不是吗？打开项目属性，选择底部附近的“web”选项卡，选择“不要打开页面...”并取消选中 Debuggers:asp.net。

HTH，天空

# c# - 如何使用 c# 在 asp.net 中实现类似大学的时间表？

> ID：533415
> 
> 赞同：0
> 
> 时间：2009-02-10T17:48:37.760
> 
> 标签：c#, asp.net

我正在做一个我必须实施时间表工具的项目。
我正在使用带有 C# 的 ASP.NET。我试图用 GridView 控件来实现我的时间表。我想从我的数据库中检索信息到 gridview 的每个时隙（框），但我只设法将信息放在每一行中。

我应该使用什么控制来实施我的时间表以及如何控制？
我对 .NET 编程很陌生，你能帮帮我吗？

这是一个与我想要的类似的链接。我只想实施一周的时间表，而不是月历。而是使用 Visual Basic，如我正在使用 C# 的链接中的示例中所示。

[http://www.codeproject.com/KB/custom-controls/schedule.aspx](http://www.codeproject.com/KB/custom-controls/schedule.aspx)

这是我的数据库的一些信息以及我想如何实现我的时间表：

### 培训班：

```
courseID（身份 - 自动递增） courseRef
               1 c0006
               2 c0007
               3 c0008
               4 c0009
               5 c0010
               6 c0011
               7 c0012
               8 c0013

```

等等...

### 房间

```
roomed(identity – auto increment) roomRef roomSize building
        1 RC 100 1
        2 射频 30 1
        3 RG 20 0
        4 罗 12 0

```

等等...

### 教师

```
TeacherID（身份 - 自动递增）teacherRef
                1吨000
                2 t002
                3 t003
                4 t004
                5 t005
                6 t006
                7 t007

```

等等...

然后我有一个描述每门课程的表格。例如，谁在教这门课程，有多少学生在这门课程中，该课程每周需要的讲座数量以及每门课程的讲座应该进行的最少天数：

### 课程说明：

```
courseID 教师ID noOfLectures minDays noOfStudents
    1 1 2 2 75
    2 2 2 2 75
    3 3 9 4 75
    4 4 7 2 75
    5 5 3 3 65
    6 6 9 4 65
    7 7 8 4 65

```

* * *

我正在寻找的时间表是这样的 2D 时间表：

[http://www.imagebam.com/image/9761dc26297272](http://www.imagebam.com/image/9761dc26297272)

每个时间段都会显示如上表所示的信息。

我还没有完成我的数据库，因为我不知道如何表示周期和时间段。如果您有任何想法，我将如何在我的数据库中表示它们，这将是有帮助的。如果您认为我必须更改数据库中的某些内容，我想听听您的建议。

我的问题是我不知道如何实现这个表并在时间表表的每个方格中显示我的数据库中的数据。

我希望我提供了足够的信息。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T18:03:00.877

我建议在彼此内部使用两个Repeater (asp:Repeater) 控件。

第一个中继器在一周中的几天循环。第二个中继器在给定日期的几个小时内循环。然后从中编写html。

html 可以构造为 html 表格，在表格单元格上设置行跨度以指示课程的持续时间。

# sql-server - SQL ADSI Active Directory 创建新帐户

> ID：533425
> 
> 赞同：3
> 
> 时间：2009-02-10T17:50:14.760
> 
> 标签：sql-server, active-directory, adsi

我的 SQL Server (2005) 中有一个 ADSI 连接，我可以使用 openquery 对其进行查询。有什么方法可以创建新帐户（和/或）编辑现有帐户？

另外，我想必须使用 openquery 来获取数据，但它看起来是唯一的解决方案。

这是我正在使用的示例查询：

```
SELECT 
  samaccountname,
  department,
  mail,
   displayName,
  employeeid
FROM OPENQUERY( ADSI, 
  '
  SELECT samaccountname, department, mail,  displayName, employeeid
  FROM ''LDAP://DC=MyDomainName,DC=MyDomainExtension''
  WHERE objectCategory = ''Person'' and objectClass= ''user''
  '
) 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T19:07:48.067

你不能（至少不使用 ADSI SQL）。

ADSI SQL 只定义了一个搜索接口，只支持`SELECT`语句（见 MSDN：“ [SQL Dialect](http://msdn.microsoft.com/en-us/library/aa746494(VS.85).aspx) ”）。此外，`OPENQUERY()`这是在 SQL Server 中获取数据的唯一方法。

要创建对象，您将不得不使用另一种方法（您可以很好地针对 ADSI 接口编写脚本）。

# c# - 即使没有类约束，也将类型参数的实例与 null 进行比较？

> ID：533426
> 
> 赞同：1
> 
> 时间：2009-02-10T17:50:16.927
> 
> 标签：c#, generics, nullable

以下代码编译：

```
class Testing<TKey, TValue>
{
    public bool Test(TKey key)
    {
        return key == null;
    }
} 
```

但是，TKey 可以是值类型，并且可能不允许值“null”。

我知道这个程序的结果，以及如何添加约束。我想知道的是**，当 TKey 不受“类”限制时，为什么编译器不允许这样做？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T17:56:16.057

在各种情况下能够做到这一点很方便。如果`TKey`是不可为空的值类型，则比较的结果将始终为假。（JITter 可能会完全删除该分支 - 不要忘记，尽管所有引用类型共享一个 JITted 代码版本，但它会为每个值类型重新 JIT。）

编辑：一个有趣的用途就是允许`Nullable<T>`与 null 进行比较。`TFoo=Nullable<T>`不满足*or*约束。*_*`where TFoo : class` *`where TFoo : struct`*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T17:53:20.790

至于“为什么”，我不确定。但要修复它，您可以使用`default(T)`而不是`null`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T17:56:36.383

因为它将您的变量转换为对象并使用 object == 运算符对于值类型，它始终为 false。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T17:56:47.223

因为 csharp 中的一切都是对象。
换句话说[，C# 中的每个类型都直接或间接地派生自对象类类型。](http://www.csharphelp.com/archives/archive75.html)
例子

```
using System;
using System.Collections.Generic;
using System.Text;

namespace ConsoleApplication1
{
    class Program
    {
        struct SimpleStruct
        {
            int a;
            public SimpleStruct(int a)
            {
                this.a = a;
            }
        }
        enum SimpleEnum
        {
            a = 1,
            b = 2,
        }

        static void Main(string[] args)
        {
            SimpleStruct tp = new SimpleStruct(2);

            object ob = tp;
            if (ob != null)
            {
                Console.WriteLine("struct is an object : " + ob);
                tp = (SimpleStruct)ob;
            }

            SimpleEnum tp2 = SimpleEnum.a;
            ob = tp2;
            if (ob != null)
            {
                Console.WriteLine("enum is an object : " + ob);
                tp2 = (SimpleEnum)ob;
            }
            Console.ReadKey();
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T18:20:22.817

因为 TKey 可以是可为空的类型。

由于 C# 2.0 struct 可与 null 进行比较。这就是为什么您可以编写 0 == null 而没有编译错误的原因。

# wcf - 主办 SilverLight / WCF

> ID：533429
> 
> 赞同：0
> 
> 时间：2009-02-10T17:51:09.797
> 
> 标签：wcf, silverlight-2.0

我创建了我的第一个 Silverlight 应用程序 :-)

它有一个基本页面并连接到数据库以填充列表。连接是使用 wcf 完成的，因此我的 silverlight 连接到执行这些操作的 ServiceReference。当我从 VisualStudio 运行时，这一切都很好。

我的问题是我不确定如何托管这个应用程序。我在 aspspider 上创建了一个帐户，上传了我的 default.html、zap 文件（我将其重命名为 zip）和数据库。这工作正常，直到它需要连接到数据库。我需要上传什么才能使数据库连接正常工作？

谢谢 :-) 马丁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T17:15:50.513

我听起来可能比我在第一篇文章中的知识渊博 :-) 我不知道如何托管 wcf，或者即使它是真正的 wcf。我会尽力解释我在做什么，如果你能提供帮助，我将不胜感激！

在我的解决方案中，我有一个 silverlight 项目，当我创建该项目时，系统提示我添加一个网络服务器，我这样做了。在添加数据库连接时，我通过添加“linq To sql 类”和 Web 服务来做到这一点。所以现在在我的网络服务器项目中，我有一个 Iservice1.cs Service1.svc LinqToSql.dbml。然后我在 silverlight 中添加了一个参考。

任何想法我如何去托管这项服务？

非常感谢马丁

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T17:54:50.520

您可以通过浏览器或 Fiddler 连接到您的 WCF 服务吗？尝试将 Silverlight 排除在外，并确保从 WCF 获取数据。

此外，我在您的问题中注意到您没有提到任何有关使用 aspspider 托管 WCF 服务的内容。您在哪里托管 WCF 服务？在您第一次进行项目时，您应该在与 silverlight 应用程序相同的域上设置 WCF 服务。否则，您将不得不开始使用 Silverlight 跨域策略，请[参阅 silverlight.net 上的视频](http://silverlight.net/learn/learnvideo.aspx?video=47174)

# java - Java 之声：设置控件的持久性是什么？

> ID：533438
> 
> 赞同：0
> 
> 时间：2009-02-10T17:53:57.793
> 
> 标签：java, controls, audio

嗨-仍然@应用程序的设计阶段，并且想知道关于“端口”类型的线的以下内容：

1.  端口关闭后是否最后输入的值（似乎只有在我在请求端口控件之前打开端口时才能访问端口控件）？

2.  输入的值是否只影响我的应用程序对底层硬件的访问，还是输入的值是系统范围的？

3.  如果应用程序终止后设置的值是否在系统范围内保持不变？

...我*可以*通过模型/试错来解决这个问题，但是我认为我不是第一个对此感到疑惑的人 - 任何见解都值得赞赏:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T19:18:43.610

好的，考虑到实验，如果我设置端口级控制，影响是@操作系统级别，影响所有应用程序，并且持续超出应用程序的操作。

仅供任何好奇的人参考:-)

# asp.net - ASP.NET 2.0 嵌套数据网格？

> ID：533453
> 
> 赞同：2
> 
> 时间：2009-02-10T17:57:10.983
> 
> 标签：asp.net, gridview, datagrid

我有一个设计有许多 HTML 表格的页面，这些表格根据当时需要显示的内容隐藏或显示。这些表中有各种 ASP.NET 标准 Web 控件，通常是复选框、单选按钮列表、文本输入框、标签等，并且都可以正常工作。

我正在尝试将 DataGrid 放在其中一行中（在标签下）并收到错误消息：

解析器错误消息：System.Web.UI.HtmlControls.HtmlTableCellCollection 必须具有“System.Web.UI.HtmlControls.HtmlTableCell”类型的项目。“MIIRS:DATAGRID”是“MIIRS.WebControls.DataGrid”类型。

（MIIRS DataGrid 继承 DataGrid 类并为其添加次要功能，如果您想知道的话）

我知道我可以重新设计页面以将 DataGrid 放在表格之外，但如果我能找到避免这种情况的方法，那就是我想要做的。

所以我的问题是：有没有办法让 HtmlTable 接受嵌套在其中的 DataGrid、GridView 或类似对象？并且更改为 asp 表标签是否可以接受？或者任何其他创造性的解决方案，以尽量减少拆分表的必要性，或者以我拥有的方式蚕食我的系统？:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T18:36:15.280

嵌套表和数据网格？哦，伙计，您可能不需要那么复杂，我相信您可以找到一种更简单的方法来实现您的 UI 目标。

要么那个，要么..逃跑，跑得又快又狠！跑到你的手摇

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T18:18:59.543

我找到了这个问题的一个可能答案。使用标签和 CSS 可以隐藏和显示 HTML 区域，因此虽然我无法在表格中获取 Datagrid，但我可以将它放在表格之外并简单地显示或隐藏它。当它被放置在表格的“中间”时，它需要将表格分成两部分（之前和之后）。

这是迄今为止我发现的让页面上的内容看起来相同的最佳方式。我仍然想知道为什么某些控件无法放入 HtmlTable 行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T18:30:29.100

你可能想看看这个演练......

[http://www.codeproject.com/KB/webforms/EditNestedDataGrid.aspx](http://www.codeproject.com/KB/webforms/EditNestedDataGrid.aspx)

# php - 如何做一个 PHP 嵌套类或嵌套方法？

> ID：533459
> 
> 赞同：15
> 
> 时间：2009-02-10T18:00:41.037
> 
> 标签：php, design-patterns, fluent-interface

我怎样才能在 PHP 中做到这一点

```
$myDBClass->users()->limit(5);//output you limited users to 5
$myDBClass->comments()->limit(3);//output you limited comments to 3 
```

我的意思是嵌套方法或嵌套类（我不知道！）所以当我作为用户的孩子调用限制方法时，它会知道我是从“用户”方法或类调用它并且当我调用限制方法 - 或类！- 来自评论 它也知道这一点。

PHP 类做这件事的可能结构是什么？

* * *

这个问题的原因是因为我正在为我自己的数据库类工作，所以我可以轻松地使用这样的东西

```
 $DB->comments()->id(" > 3")->limit(10); 
```

生成 sql 代码 "select * from comments where id > 3 limit 10" 谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-10T18:06:30.960

让这些方法返回具有所描述方法的对象，然后您就会得到您想要的。

因此，只要`$DB`是具有 - 方法的对象`comments()`，该部分就有效。如果`comments()`返回一个具有`id()`-method 的对象，那么该部分也是有效的。然后，`id()`需要返回一个具有`limit()`-method 的对象。

在您的特定情况下，您可能想要执行以下操作：

```
class DB {
  public function comments() {
    // do preparations that make the object select the "comments"-table...
    return $this;
  }

  public function id($string) {
    // handle this too...
    return $this;
  }

  public function limit($int) {
    // also this
    return $this;
  }

  public function execute() {
    $success = try_to_execute_accumulated_db_commands();
    return $success;
  }
}

$DB = new DB();
$DB->comments()->id(" > 3")->limit(10); 
```

在我的示例中，每个方法（也未在此处描述）都会返回对象本身，因此可以将命令链接在一起。当数据库查询的构建完成时，您实际上通过调用`execute()`（在我的情况下）将返回一个表示数据库执行成功的布尔值来评估查询。

用户 nickohm 建议这称为[fluent interface](http://en.wikipedia.org/wiki/Fluent_interface)。我必须承认，这对我来说是一个新术语，但这可能比该术语的用法更能说明我的知识。（*“我只是写代码，你知道……”*）

*注意：* `$this`是一个指向当前活动对象的“魔术”变量。顾名思义，它只是将自身作为方法的返回值返回。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-10T18:04:45.083

this 的标准约定是在每个方法调用结束时返回 $this 的实例。所以当返回给调用者时，我们只是引用另一个方法调用。

```
class Foo
{
  public function do_something()
  { 
    return $this; 
  }

 public function do_something_else() 
 {
   return $this; 
  }
}

$foo = new Foo();
$foo->do_something()->do_something_else(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T18:33:15.577

一个简单的实现方法可以帮助您入门，如下所示：

```
class db
{
  public function __call($function, $arguments)
  {
    switch($function) {
      // implement table handling here
      case 'user':
        //do something
        return $something;
        break;
    }
  }
} 
```

根据您是否想变得复杂，但坚实或简单，但不太灵活，您可能会实施两种不同的策略。简单的策略可能是这样的：

```
class db
{

  protected $operatingTable;

  public function limit($limitNumber)
  {
    return $this->executeQuery("SELECT * FROM ".$this->operatingTable." LIMIT ".$limitNumber); // where executeQuery is a function that runs a query
  }

  public function __call($function, $arguments)
  {
    switch($function) {
      // implement table handling here
      case 'user':
        $this->operatingTable='user'; // alternately, but less secure: $this->operatingTable=$function;
        return $this;
        break;
    }
  }
} 
```

或者，但更强大：

```
class db
{
  protected $operatingTable;

  public function limit($limitNumber)
  {
    return $this->executeQuery("SELECT * FROM ".$this->operatingTable." LIMIT ".$limitNumber); // where executeQuery is a function that runs a query
  }

  public function __call($function, $arguments)
  {
    switch($function) {
      // implement table handling here
      case 'user':
        $user = new user($this); // pass in the database to the object, so the table object can have a reference to the db
        return $user;
        break;
    }
  }
}

class baseTableClass
{
  protected $db; // an instance of class db

  function limit($limitNumber)
  {
    $db->execute($aStatementDerivedFromThisClassesInformation); // execute a sql command, based on information about the table in the class
  }

}

class user extends baseTableClass
{
  public function __construct($db) {
    $this->db = $db;
  }
} 
```

你明白了。要么重载 db 对象，要么创建基本 db 对象和表对象，将大部分智能放在表对象中，确保创建时，表对象存储对 db 对象的引用

# javascript - YUI 自动完成错位问题

> ID：533462
> 
> 赞同：2
> 
> 时间：2009-02-10T18:01:14.250
> 
> 标签：javascript, html, css, yui

![替代文字](https://farm4.static.flickr.com/3352/3270044482_610eee066a.jpg?v=0)

我正在使用自动完成 YUI 功能。但是，如您所见，当我在文本输入前面放置标签时，我无法将建议下拉菜单与文本输入对齐。我完全按照[这里的示例，](http://developer.yahoo.com/yui/examples/autocomplete/ac_basic_array_clean.html)除了这段代码，我只是用表单中的标签元素替换 H3：

```
<div id="myAutoComplete">
<label>Enter a state:</label>
    <input id="myInput" type="text">
    <div id="myContainer"></div>
</div>

<script type="text/javascript" src="http://developer.yahoo.com/yui/examples/autocomplete/assets/js/data.js"></script> 
```

（我还必须将 data.js 路径从相对路径更改为绝对路径。）

让建议下拉以与文本输入对齐的最佳方式是什么？我想要一个适用于所有流行的现代浏览器（FF3、Safari、Chrome、IE）以及 IE6 的解决方案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T23:02:15.477

AutoComplete 不会在每次显示时自动强制您的 AC 容器的位置，因为除非您正在进行内联工作，否则这是不必要的。但是，既然您已将输入字段内联，您确实需要采取另一个步骤来对齐容器，无论是使用自定义 CSS 还是蛮力 JS 定位。

这是蛮力方法。

定义 AC 实例后：

```
oAC.doBeforeExpandContainer = function() {
    var Dom = YAHOO.util.Dom;
    Dom.setXY("myContainer", [Dom.getX("myInput"), Dom.getY("myInput") + Dom.get("myInput").offsetHeight] );
    return true;
} 
```

这是一个工作示例：

[http://ericmiraglia.com/yui/demos/acalign.php](http://ericmiraglia.com/yui/demos/acalign.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T19:03:48.640

似乎这个自动完成插件没有使用 quirksmode 臭名昭著的[元素位置](http://www.quirksmode.org/js/findpos.html)技术来查找页面上元素的*真实*位置。

标签是否需要与输入框内联？`<br>`您可以通过在之后放置 a 或在元素上`label`实际设置 a来很好地解决此问题。`margin-left``<div id="myContainer">`

否则，您可能应该将此作为错误提交，并告诉他们使用 quirksmode 方式来执行此操作（它是跨浏览器）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T22:24:18.203

这不是错误，只是特定设计所需的简单定制。

如果您不使用 url 添加这些 js 文件，您只需要找到生成 table/div 的 js 代码来填充您的结果。代码要么即时生成整个表格，要么将已经隐藏的 table/div 的可见性设置为“可见”。如果您找到该代码，您只需要添加一个属性来设置其左侧位置以匹配其“px”位置与您的文本框。

或者找到哪个 css 类应用于该结果容器，并尝试将其设置为左侧和绝对位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-04T11:42:37.367

我有同样的问题...

我想要一个内联 YUI 自动完成功能，这样我就可以放置一个标签，然后放置一个带有自动完成功能的文本框，而无需换行。我找到了答案：[http](http://starikovs.com/2009/11/04/inline-yui-autocomplete-layout/) ://starikovs.com/2009/11/04/inline-yui-autocomplete-layout/ 。这是一个 CSS 解决方案，没有 JavaScript。

# java - 受保护/私人 - 为什么要打扰？

> ID：533464
> 
> 赞同：1
> 
> 时间：2009-02-10T18:01:48.523
> 
> 标签：java, encapsulation

**DUPE：[实践中的私人与公共成员（封装有多重要？）](https://stackoverflow.com/questions/99688/private-vs-public-members-in-practice-how-important-is-encapsulation)**

在用 Java 编写程序的过程中，我已经抽象出一些库，我可以看到它们在未来的项目中可能会用到。

为什么我要为这些方法中的任何一种设置受限访问（私有/受保护）而烦恼？

看来这只会让我未来的生活变得更加复杂。如果我在所有东西上都使用 public，我将永远不需要担心我是否可以从其他类中调用某些东西。我从来没有在我的任何代码中看到过这样一个案例，我可以使用除 public 之外的任何东西。

在所有事情上都使用“公共”是错误的吗？我会被 Java 众神击倒吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-10T18:04:28.703

是的，在所有事情上都使用 public 是错误的。这意味着您完全不知道“此成员是公共 API 的一部分；您应该能够从外部世界使用它，并且它不应该更改”和“此成员是一个实现”之间的区别细节。如果我以后想改变它，我可以这样做，因为我不知道外界不会调用它。

明确区分 API 和实现对于 IMO 的灵活性和清晰度非常重要。

# sitemap - 我应该在我的站点地图中编码特殊字符吗？

> ID：533465
> 
> 赞同：4
> 
> 时间：2009-02-10T18:02:11.487
> 
> 标签：sitemap

我有一些包含特殊字符的 URL。例如：

```
http://www.example.com/bléèàû.html 
```

如果您在浏览器中键入此 URL，我的 Web 服务器将显示正确的页面（它可以处理特殊字符）。

我查看了[站点地图规范](https://www.sitemaps.org/protocol.html)，不清楚站点地图文件是否可以包含特殊字符。根据我对协议的理解，如果 URL 工作正常并且服务器提供正确的页面并且 XML 文件是 UTF-8 编码的，那么就可以了。

例如，此条目是有效的站点地图条目：

```
 <url>
      <loc>http://www.example.com/bléèàû.html</loc>
      <changefreq>weekly</changefreq>
   </url> 
```

任何人都可以证实这一点？

[更新] 我不愿意对特殊字符进行编码的原因是我不想为相同的内容引入重复的 URL。例如

```
http://www.example.com/bl%C3%A9%C3%A8%C3%A0%C3%BB.html 
```

和

```
http://www.example.com/bléèàû.html 
```

将提供相同的页面。我认为 Google 会通过其正常索引和站点地图同时捕获 URL。不幸的是，谷歌倾向于降低具有指向同一页面的重复 URL 的网站的页面排名。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T18:53:35.793

站点地图规范没有说。它显示了各种转义形式的 URL 示例，但没有明确说明第一个示例（原始字符）是否允许。它只称它们为“URL”，没有提及“URL”或 RFC 的特定定义，这将阐明它们是指老式 ASCII URI 还是 IRI（可能包含非 ASCII 字符）。

因此，对 URL 的 UTF-8 编码进行 %-escape 是最安全的。然后该链接将在全局范围内工作，并且应该在所有现代浏览器中作为 Unicode 字符呈现给用户。

```
<loc>http://www.example.com/bl%C3%A9%C3%A8%C3%A0%C3%BB.html</loc> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T18:35:24.043

虽然站点地图确实必须以 UTF-8 编码，但这并不意味着其中包含的 URL 具有可供它们使用的所有 UTF-8。

URL 应该是 RFC [1738](https://www.rfc-editor.org/rfc/rfc1738)中指定的 US-ASCII 的子集。我不相信您的示例网址：

```
http://www.example.com/bléèàû.html 
```

根据该参考是有效的，应改为 URL 编码/转义。

*   [RFC1738：统一资源定位符 (URL) (1994)](https://www.rfc-editor.org/rfc/rfc1738)
*   [RFC3986：统一资源标识符 (URI)：通用语法 (2005)](https://www.rfc-editor.org/rfc/rfc3986)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T18:18:00.200

规范说站点地图**必须**是 UTF-8 编码的。如果 URL 正确并在您的网站上使用，那么是的，请将其包含在您的站点地图中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T19:07:16.493

对于那些没有能力轻松输入特殊字符**的用户，我建议你也接受服务器端最接近的近似值。（即别名或转发 /bleeau.html 到 /bléèàû.html）

** For example cell phone browsers with limited keyboards and persons with different keyboard language layouts.

# java - 如何从高程栅格近似矢量轮廓？

> ID：533467
> 
> 赞同：11
> 
> 时间：2009-02-10T18:02:48.583
> 
> 标签：java, math, vector, 2d, gis

我有一个存储为栅格的高程图。我想将平滑的“矢量”曲线拟合到恒定高度的轮廓。在我的应用程序中，数据实际上是地理海拔，但问题可以推广到两个变量的任何函数。

如果有帮助，我可以生成另一个具有抗锯齿轮廓线的栅格，并将其用作矢量拟合过程的输入。

[这个问题](https://stackoverflow.com/questions/188680/recommendations-for-converting-raster-images-to-vector-graphics)很相似，但我正在寻找一个可以在我的 Java 应用程序中使用的免费库，或者我（非数学家）可以自己实现的算法的解释。此外，就我而言，我已经找到了我关心的所有“边缘”——我只需要将它们矢量化。

[另一个问题](https://stackoverflow.com/questions/263305/drawing-a-topographical-map)涉及我的问题，但发帖人从未返回解释他如何实施最后一步，这是我缺少的部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T20:05:42.547

您可能想要拟合封闭的贝塞尔样条曲线（曲线）。

有一个[带有 Java 小程序的页面](http://www.serc.iisc.ernet.in/~amohanty/SE288/lagrange/curves.html)可以做到这一点。看看他们的（未注释的，bleh）PSegment.java

如果这不能很好地完成这项工作，那么[通过平方距离最小化将 B 样条曲线拟合到点云](http://www.cs.hku.hk/research/techreps/document/TR-2004-11.pdf)对于该任务来说应该是多余的。

有关更多信息，谷歌（学者）搜索“b样条拟合”和“封闭贝塞尔样条”之类的东西应该会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T21:50:38.770

MATLAB 使用等高线图执行此操作：查看[`contour`](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/contour.html)函数——它从 f(x,y) 数据网格生成等高线数据。我对他们使用的算法了解不多（他们确实有一个[讨论它的页面](http://www.mathworks.com/access/helpdesk/help/techdoc/creating_plots/f10-2524.html#f10-2614)），但也许值得看看[Octave 等价物](http://wiki.octave.org/wiki.pl?ContourScript)。

有[一篇关于等高线绘图](http://members.bellatlantic.net/~vze2vrva/thesis.html)的论文和一个基于该论文的[CodeProject 页面。](http://www.codeproject.com/KB/recipes/contour.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T19:59:50.327

我使用[GDAL](http://www.gdal.org/gdal_contour.html)。在我看来，您可能*不想*创建 Bézier 样条曲线，这会增加复杂性。短线段就足够了。

唯一的问题是您必须在数据准备时创建轮廓，而不是在您的 Java 应用程序中。

这是一张使用 GDAL从[USGS 高度数据](http://dds.cr.usgs.gov/srtm/)创建的一些等高线的地图：

![在此处输入图像描述](https://i.stack.imgur.com/BEcXM.png)

# command-line - FFmpeg：一些错误，包括无效的帧大小和不完整的帧

> ID：533469
> 
> 赞同：2
> 
> 时间：2009-02-10T18:03:48.220
> 
> 标签：command-line, video, ffmpeg, command-prompt, dvd

我使用这个 ffmpeg 命令从 DVD 上的大型 VOB 文件中获取剪辑：

```
ffmpeg.exe -i E:\VTS_02_2.vob -ss 00:00:57 -t 00:16:15 vids\VTS_02_2.vob 
```

它首先适用于 VOB 文件，但随后出现以下错误：

```
c:\ffmpeg>ffmpeg.exe -i E:\VTS_02_2.vob -ss 00:00:57 -t 00:16:15 vids\VTS_02_2.vob
FFmpeg version SVN-r15625, Copyright (c) 2000-2008 Fabrice Bellard, et al.
  configuration: --enable-memalign-hack --enable-postproc --enable-swscale --enable-g
l --enable-libfaac --enable-libfaad --enable-libgsm --enable-libmp3lame --enable-libv
rbis --enable-libtheora --enable-libx264 --enable-libxvid --disable-ffserver --disabl
-vhook --enable-avisynth --enable-pthreads
  libavutil     49.12\. 0 / 49.12\. 0
  libavcodec    52\. 0\. 0 / 52\. 0\. 0
  libavformat   52.22\. 1 / 52.22\. 1
  libavdevice   52\. 1\. 0 / 52\. 1\. 0
  libswscale     0\. 6\. 1 /  0\. 6\. 1
  libpostproc   51\. 2\. 0 / 51\. 2\. 0
  built on Oct 16 2008 05:40:02, gcc: 4.2.4 (TDM-1 for MinGW)
Input #0, mpeg, from 'E:\VTS_02_2.vob':
  Duration: 00:17:11.61, start: 1031.828511, bitrate: 8326 kb/s
    Stream #0.0[0x1e0]: Video: mpeg2video, yuv420p, 720x576 [PAR 16:15 DAR 4:3], 9640
kb/s, 25.00 tb(r)
    Stream #0.1[0x80]: Audio: ac3, 48000 Hz, stereo, s16, 192 kb/s
File 'vids\VTS_02_2.vob' already exists. Overwrite ? [y/N] y
Output #0, svcd, to 'vids\VTS_02_2.vob':
    Stream #0.0: Video: mpeg2video, yuv420p, 720x576 [PAR 16:15 DAR 4:3], q=2-31, 200
kb/s, 25.00 tb(c)
    Stream #0.1: Audio: mp2, 48000 Hz, stereo, s16, 64 kb/s
Stream mapping:
  Stream #0.0 -> #0.0
  Stream #0.1 -> #0.1
Press [q] to stop encoding
[ac3 @ 026D3990]frame sync error
Error while decoding stream #0.1
frame=    0 fps=  0 q=0.0 size=       0kB time=10000000000.00 bitrate=   0.0kbits/s
[mpeg2video @ 0141B780]ac-tex damaged at 40 2
[mpeg2video @ 0141B780]invalid mb type in B Frame at 3 12
[mpeg2video @ 0141B780]00 motion_type at 15 16
[mpeg2video @ 0141B780]mb incr damaged
[mpeg2video @ 0141B780]00 motion_type at 2 21
[mpeg2video @ 0141B780]00 motion_type at 44 22
[mpeg2video @ 0141B780]ac-tex damaged at 43 24
[mpeg2video @ 0141B780]Warning MVs not available
[mpeg2video @ 0141B780]concealing 765 DC, 765 AC, 765 MV errors
frame=    0 fps=  0 q=0.0 size=       0kB time=10000000000.00 bitrate=   0.0kbits/s
frame=    0 fps=  0 q=0.0 size=       0kB time=10000000000.00 bitrate=   0.0kbits/s
frame=    0 fps=  0 q=0.0 size=       0kB time=10000000000.00 bitrate=   0.0kbits/s
frame=    0 fps=  0 q=0.0 size=       0kB time=10000000000.00 bitrate=   0.0kbits/s
[mpeg2video @ 0141B780]ac-tex damaged at 5 9
[mpeg2video @ 0141B780]00 motion_type at 21 13
[mpeg2video @ 0141B780]ac-tex damaged at 1 20
[mpeg2video @ 0141B780]mb incr damaged
[mpeg2video @ 0141B780]00 motion_type at 30 30
[mpeg2video @ 0141B780]Warning MVs not available
[mpeg2video @ 0141B780]concealing 450 DC, 450 AC, 450 MV errors
[ac3 @ 026D3990]frame CRC mismatch
[ac3 @ 026D3990]incomplete frame
[ac3 @ 026D3990]invalid frame size
frame=    0 fps=  0 q=0.0 size=       0kB time=10000000000.00 bitrate=   0.0kbits/s
[mpeg2video @ 0141B780]00 motion_type at 38 15
[mpeg2video @ 0141B780]00 motion_type at 30 34
[mpeg2video @ 0141B780]Warning MVs not available
[mpeg2video @ 0141B780]concealing 254 DC, 254 AC, 254 MV errors
frame=    0 fps=  0 q=0.0 size=       0kB time=10000000000.00 bitrate=   0.0kbits/s
frame=    0 fps=  0 q=0.0 size=       0kB time=10000000000.00 bitrate=   0.0kbits/s
[mpeg2video @ 0141B780]ac-tex damaged at 7 6
[mpeg2video @ 0141B780]concealing 1350 DC, 1350 AC, 1350 MV errors
frame=    0 fps=  0 q=0.0 size=       0kB time=10000000000.00 bitrate=   0.0kbits/s
[ac3 @ 026D3990]incomplete frame
[ac3 @ 026D3990]invalid frame size
frame=    0 fps=  0 q=0.0 size=       0kB time=10000000000.00 bitrate=   0.0kbits/s
frame=    0 fps=  0 q=0.0 Lsize=       0kB time=10000000000.00 bitrate=   0.0kbits/s

video:0kB audio:0kB global headers:0kB muxing overhead -1.#IND00% 
```

**有没有办法强制 ffmpeg 只给我一个输出？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T15:36:57.007

以 [mpeg2video @ 0141B780] 开头的行显示一般解码错误。有时这些都无需担心，因为 FFMPEG 在此类错误之后成功继续运行（错误可能仅适用于当前帧）；它们可能代表用于对源进行编码的编码器中的故障，甚至是传输错误。

不过，这里值得关注的是其他行中的所有零：

```
frame=    0 fps=  0 q=0.0 size=       0kB time=10000000000.00 bitrate=   0.0kbits/s 
```

似乎很难理解来源。[Media Info](http://mediainfo.sourceforge.net/en)告诉您有关源 VOB 的哪些信息？

这个社区可能不太适合解决音频/视频编码问题——你试过 doom9.org 吗？您可能需要找人为您查看源 VOB 的样本。

大概您正在使用 ffmpeg 的命令行版本，因为您想自动执行此操作；如果没有，请注意 AVIdemux 等工具也可以在 GUI 中执行此操作。尽管它的名字它可以复制 MPEG 而无需重新编码。

# c# - 为什么我必须在将 ListView 的 ItemsSource 设置为新值之前将其显式设置为 null？

> ID：533471
> 
> 赞同：1
> 
> 时间：2009-02-10T18:04:03.713
> 
> 标签：c#, wpf, data-binding

在特定情况下 - 这里有太多代码要发布 - 当我尝试将通用 List 集合绑定到 ListView 的 ItemsSource 时，没有任何反应。ListView 之前已绑定到不同的集合。如果我将 ListView ItemsSource 设置为 null，则新绑定有效。

我试图找出问题所在，但一切都按我的预期进行。所以这与我现有的代码有关。但是，如果我将 List 更改为 ObservableCollection （并且不更改其他内容，则它可以在不将 ItemsSource 设置为 null 的情况下工作。

我已经解决了这个问题，但我真的很想了解它为什么会发生。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T18:09:45.460

渲染器使用 ObservableCollection 事件来了解何时重新渲染数据绑定控件的内容。

# sharepoint - SharePoint 通过 Web 客户端服务 (webclnt.dll)。CreateFile 失败

> ID：533475
> 
> 赞同：2
> 
> 时间：2009-02-10T18:05:22.883
> 
> 标签：sharepoint, webclient, createfile

我有一个创建和编辑文档的应用程序。我需要将它与 SharePoint 集成，以便用户可以使用我的应用程序编辑 SharePoint 服务器上的文件。我的环境是 Visual C++，非 MFC Windows 应用程序。

我正在尝试 Web 客户端服务 (webclnt.dll)，看看我是否可以让我的应用程序以最少的代码更改工作。这适用于记事本等（只需给它一个指向共享点文档的 URL，Web 客户端拦截文件 I/O 请求并将其重定向到网络）......但我的应用程序无法使用“GetLastError”代码调用 CreateFile 123:

```
(ERROR_INVALID_NAME). 
```

有谁知道这是为什么？我将 CreateFile 传递给该文件的有效完整 URL。我查看了可以传递给 createFile 的选项，我没有看到任何看起来会放松文件名验证的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T17:42:02.513

看起来问题是您无法将 URL 传递给 CreateFile。您必须使用 GetOpenFileName 对话框，并在其中输入 URL。WebDAV 重定向器然后将其转换为可以传递给 CreateFile 的 URI。然后就可以了。

# mysql - 将 SQL Server 2005 与 MySQL 同步

> ID：533476
> 
> 赞同：2
> 
> 时间：2009-02-10T18:05:46.657
> 
> 标签：mysql, sql-server

我需要将几个表从第三方 SQL Server 2000 数据库批量复制到 MySQL 5 数据库并保持同步——即，当 SQL Server 表上发生一些 CRUD 时，我希望它反映在及时的 MySQL 版本。现在，我知道[使用 2000 可以做到这一点](https://web.archive.org/web/1/http://blogs.techrepublic%2ecom%2ecom/howdoi/?p=112)，但是在不久的将来，SQL Server 数据库将升级到 2005，这似乎不会提供与 2000 相同的漏洞。

那么，有没有什么方法可以将数据从 SQL Server 2005 复制/同步到 MySQL，而不需要我以编程方式比较两个数据库中的表？如果是这样，它是否也适用于 SQL Server 2000？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T20:20:38.360

[从 MS Sql 2005 和 MySql 复制数据的建议](https://stackoverflow.com/questions/169086/suggestions-for-replication-of-data-from-ms-sql-2005-and-mysql)

一个人建议不要搞乱这样的方案并设置另一个 sql server。

SQL express 对性能有一些限制，但也许这是您的选择。我找不到任何可以开箱即用的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T06:56:39.113

我还建议[通过 Linked Server 将 SQL Server 连接到 MySQL](http://www.ideaexcursion.com/2009/02/25/howto-setup-sql-server-linked-server-to-mysql/)。然后，在使用 INSERTED 和 DELETED 伪表的相关表上创建 AFTER 触发器，以确保所有本地操作都反映在远程数据库上。例如：

```
CREATE TRIGGER tr_Orders_Insert ON Orders AFTER INSERT AS
    BEGIN
        INSERT INTO MySQLServer...Orders (OrderID, OrderDate)
        SELECT OrderID, OrderDate FROM INSERTED
    END
GO 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T17:33:21.387

我以前做过这个，虽然它完全取决于你对及时的定义！

我使用 myODBC ( [http://dev.mysql.com/downloads/connector/odbc/5.1.html](http://dev.mysql.com/downloads/connector/odbc/5.1.html) ) 将 mySQL 服务器设置为链接服务器。然后，您可以使用 openquery 命令 ( [http://msdn.microsoft.com/en-us/library/ms188427.aspx](http://msdn.microsoft.com/en-us/library/ms188427.aspx) ) 从远程表中获取数据。

然后，您需要做的就是编写一个存储过程，该过程在远程数据库中不存在数据的情况下执行插入/更新。SQL有点讨厌，但它是可行的！一旦你有了一个可以工作的 SP，你就可以将它设置为在某处作为触发器运行，或者在 MSSQL 服务器中将其作为作业运行。

# sql - 如何根据 SQL Server 2000 中的连续时间分配返回记录列表

> ID：533485
> 
> 赞同：1
> 
> 时间：2009-02-10T18:09:15.400
> 
> 标签：sql, tsql, time, sql-server-2000

我有一个看起来像这样的表：

```
IP            Hostname   TransactionDate
------------- ---------- -------------------
1.1.1.1       A          2009-01-01 01:00:00
1.1.1.1       A          2009-01-02 01:00:00
1.1.1.1       A          2009-01-03 01:45:00
1.1.1.1       B          2009-01-04 01:00:00
1.1.1.1       A          2009-01-05 01:00:00 
```

我想建立一个查询来返回记录，这些记录将根据他们连续持有 IP 地址的时间对结果进行分组：

即（选择或IP 1.1.1.1）：

```
Hostname    GrantDate            ExpireDate
----------- ---------------      -----------------
A           2009-01-01 01:00:00  2009-01-04 01:00:00
B           2009-01-04 01:00:00  2009-01-05 01:00:00
A           2009-01-05 01:00:00  NULL 
```

完成这项任务的最佳方法是什么？我想尽可能避免使用游标。我正在使用 SQL Server 2000，这使得这变得更加困难......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T18:38:46.810

[在 Joe Celko 的SQL Puzzles and Answers](https://rads.stackoverflow.com/amzn/click/com/0123735963)中有一些解决这个问题的方法。谷歌有[一个摘录](http://books.google.com/books?id=krv8CUJU44sC&pg=PA234&lpg=PA234&dq=celko+contiguous+time&source=bl&ots=jkBHcDSyvj&sig=G9Lx595vqFVXSNesYti40nOiuE8&hl=en&ei=IseRSfreONW5tweC6u3bCw&sa=X&oi=book_result&resnum=3&ct=result#PPA234,M1)，其中包括它们。他的示例包括开始时间和结束时间，但调整它们应该相当简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T18:45:05.307

为后人而张贴。我只是找不到不使用光标的方法。我敢肯定，其中一部分原因是 SQL 不是我的强项。如果其他人看到这篇文章，这是我使用的解决方案。我将继续使用它的查询，如果我弄明白了，我会发布它。

```
SET NOCOUNT ON
DECLARE @ip VARCHAR(15)
    SET @ip = '1.1.1.1'

DECLARE @dhcplog TABLE(IP VARCHAR(15), HOSTNAME VARCHAR(32), IPDATE DATETIME)
DECLARE @results TABLE(IP VARCHAR(15), HOSTNAME VARCHAR(32), STARTDATE DATETIME, ENDDATE DATETIME)
INSERT INTO @dhcplog VALUES('1.1.1.1', 'A', '2009-01-01 01:00:00')
INSERT INTO @dhcplog VALUES('1.1.1.1', 'A', '2009-01-02 02:00:00')
INSERT INTO @dhcplog VALUES('1.1.1.1', 'A', '2009-01-05 03:00:00')
INSERT INTO @dhcplog VALUES('1.1.1.1', 'B', '2009-01-07 04:00:00')
INSERT INTO @dhcplog VALUES('1.1.1.1', 'B', '2009-01-07 10:00:00')
INSERT INTO @dhcplog VALUES('1.1.1.1', 'B', '2009-01-08 05:00:00')
INSERT INTO @dhcplog VALUES('1.1.1.1', 'C', '2009-01-09 06:00:00')
INSERT INTO @dhcplog VALUES('1.1.1.1', 'A', '2009-01-10 07:00:00')

DECLARE @cHOST VARCHAR(32)
DECLARE @cEND DATETIME

DECLARE @tIP VARCHAR(15)
DECLARE @tHOST VARCHAR(32)
DECLARE @tIPDATE DATETIME

DECLARE IPCursor CURSOR FOR SELECT IP, HOSTNAME, IPDATE
                            FROM @dhcplog
                            WHERE IP = @ip
                            GROUP BY IP, HOSTNAME, IPDATE
                            ORDER BY IPDATE DESC

OPEN IPCursor
    FETCH NEXT FROM IPCursor INTO @tIP, @tHOST, @tIPDATE
        WHILE @@FETCH_STATUS = 0
            BEGIN
                IF @tHOST = @cHOST
                    BEGIN
                        UPDATE @results
                        SET STARTDATE = @tIPDATE
                        WHERE HOSTNAME = @cHOST
                        AND ENDDATE = @cEND
                    END
                ELSE
                    BEGIN
                        INSERT INTO @results (IP, HOSTNAME, STARTDATE, ENDDATE)
                        VALUES (@tIP, @tHOST, @tIPDATE, @tIPDATE)
                        SET @cHOST = @tHOST
                        SET @cEND = @tIPDATE
                    END
                FETCH NEXT FROM IPCursor INTO @tIP, @tHOST, @tIPDATE
            END
CLOSE IPCursor
DEALLOCATE IPCursor

SELECT * FROM @results

SET NOCOUNT OFF 
```

**结果：**

```
IP      Hostname    StartDate       EndDate
1.1.1.1 A       2009-01-10 07:00:00 2009-01-10 07:00:00
1.1.1.1 C       2009-01-09 06:00:00 2009-01-09 06:00:00
1.1.1.1 B       2009-01-07 04:00:00 2009-01-08 05:00:00
1.1.1.1 A       2009-01-01 01:00:00 2009-01-05 03:00:00 
```

# c# - 如何使用 SetConsoleHandler() 阻止退出调用

> ID：533491
> 
> 赞同：3
> 
> 时间：2009-02-10T18:11:43.680
> 
> 标签：c#, console, exit

我知道`setconsolehandler()`如果我想管理控制台关闭事件，我必须使用它。

我不知道如何阻止`CTRL_CLOSE_EVENT`。如果它捕获到该事件，我尝试返回 false/true，但没有成功

这是我到目前为止所拥有的（谢谢 Anton Gogolev！）

```
[DllImport("Kernel32")]
public static extern bool SetConsoleCtrlHandler(HandlerRoutine Handler, bool Add);

public delegate bool HandlerRoutine(CtrlTypes CtrlType);

public enum CtrlTypes{
    CTRL_C_EVENT = 0,
    CTRL_BREAK_EVENT,
    CTRL_CLOSE_EVENT,
    CTRL_LOGOFF_EVENT = 5,
    CTRL_SHUTDOWN_EVENT
}

private static bool ConsoleCtrlCheck(CtrlTypes ctrlType)
{ 
    if(ctrlType == CtrlTypes.CTRL_CLOSE_EVENT)
        return false;// I have tried true and false and viceversa with the return   
                     // true/false but I cant seem to get it right.
    return true;
}

//and then I use this to call it
SetConsoleCtrlHandler(new HandlerRoutine(ConsoleCtrlCheck), true); 
```

是否可以运行一个新线程来监视控制台是否正在关闭，如果主线程正在做某事，则阻止该关闭？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T18:17:32.057

的文档[`SetConsoleCtrlHandler()`](http://msdn.microsoft.com/en-us/library/ms686016(VS.85).aspx)说：

> 当用户关闭控制台、注销或关闭系统时，系统会生成 CTRL_CLOSE_EVENT、CTRL_LOGOFF_EVENT 和 CTRL_SHUTDOWN_EVENT 信号，以便进程在终止之前有机会进行清理。

这意味着与处理 CTRL+C 或 CTRL+BREAK 事件不同，您的进程没有机会取消关闭、注销或关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T03:36:09.523

实际上你可以阻止它（我至少在 Windows XP 上复制了它）。例如，如果在您的处理程序中，您有一个无限循环和睡眠，这将阻止该进程永远终止（或至少很长时间，或直到用户通过任务管理器终止该进程）。

如果您确实需要启动一个线程，您可以使用等待条件（`AutoResetEvent`在 C# 中）并启动您的线程（尽管在大多数情况下可能不需要新线程），然后在您的线程完成时通知等待条件。但是，在大多数情况下，只需在处理程序中进行任何清理就足够了。

如果在最坏的情况下您确实一直等待，该进程将继续运行，并且您将能够在您重新登录时看到它（至少在 Windows XP 上）。但是，这会导致桌面在进入注销屏幕之前暂停大约 20 秒（当它等待您的应用程序退出时），然后在注销屏幕上再次暂停（我想它会尝试第二次） . 当然，我强烈建议不要永远等待。对于任何长期运行的东西，您应该真正将其放入服务中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-26T13:14:05.033

我发现了一个可能的“黑客”，可以阻止应用程序关闭，同时仍然整齐地服从控制台关闭请求。我认为，这尤其适用于将控制台创建为“额外”的 GUI 应用程序。从 MSDN 文档中，在调用 Ctrl 处理程序时，会在进程中创建一个**新线程**来调用处理程序。因此，我的解决方案是在默认处理程序调用 ExitProcess 之前杀死攻击入侵线程。在处理程序例程（C++ 中的代码）中：

```
// Detach Console:
FreeConsole();
// Prevent closing:
ExitThread(0);
return TRUE; // Not reached 
```

**编辑：**这似乎确实会导致一些问题，正如我所料。随后对 AllocConsole() 的调用无限期挂起，因此我怀疑过早退出线程无法正确清理。

**编辑2：**

为了澄清上面，我发现继续运行该程序没有直接问题。但请记住，我们已经强制终止了 kernel32 创建的线程，因此 kernel32 中的任何资源都可能处于不确定状态。当程序继续运行时，这可能会导致无法预料的问题。

大多数情况下，我认为，这些问题将与控制台 API 有关。如前所述，`AllocConsole`从此时起无法工作（它将挂起应用程序），因此程序无法打开新控制台。其他控制台功能也很可能会失败。基本上，从那时起，您以任何方式（直接或间接）调用 kernel32 的任何操作都会受到未定义行为的影响，但我怀疑实际上在控制台功能之外不会有任何问题。

我的结论是，如果可能的话，你应该避免这种方法，但如果提前终止更糟，那么这可以被认为是一种紧急解决方法，要谨慎使用。

# language-agnostic - 编程教程的工具？

> ID：533500
> 
> 赞同：7
> 
> 时间：2009-02-10T18:15:01.940
> 
> 标签：language-agnostic

我参加了很多培训课程，我想为我的所有课程制作视频教程，以便我可以分发它。什么是最好的基于 Windows 的工具来添加我的 PowerPoint 幻灯片、笔记、语音和视频（我编写的代码教程）并将它们编译成一个视频？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T18:16:42.560

[Camtasia](http://www.techsmith.com/camtasia.asp)，如果你在 Windows 上。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-10T18:20:05.467

我们正在使用 Camtasia ( [http://www.techsmith.com/camtasia.asp](http://www.techsmith.com/camtasia.asp) ) 但我听说 Adob​​e 的 Captivate ( [http://www.adobe.com/products/captivate/](http://www.adobe.com/products/captivate/) ) 要好得多。两种解决方案都是商业化的。

如果您正在寻找免费的替代品，Camstudio( [http://camstudio.org/](http://camstudio.org/) ) 是相当不错的，尽管它缺少很多功能。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-13T13:53:46.470

[CamTasia](http://www.techsmith.com/camtasia.asp) (TechSmith.com) 与 PowerPoint 集成，拥有出色的编辑器，功能非常强大。如果您在截屏视频上花费的时间超过几个小时，请获取 CamTasia。它也可以集成网络摄像头并导出 SCORM 以进行电子学习。

[CamStudio](http://camstudio.org/)是 gpl，适用于简单的截屏，缺少编辑器，并且在录制 10 分钟后出现音频/视频同步问题（CamTasia 没有同步问题）

[HyperCam](http://www.hyperionics.com/hc/)是一款简洁的共享软件记录器，类似于 CamStudio，没有同步错误，但也没有编辑器。作者对错误有反应，几年前我用过它，它可以很好地用于基本录音。

[VirtualDubMod](http://virtualdubmod.sourceforge.net/)是一个 gpl 视频编辑器，它很笨重，但如果你使用 CamStudio，它会给你一些编辑+合并的能力

我建议买一个合理的麦克风（USB 麦克风 40 英镑应该就可以了），避免使用 3.5 毫米模拟插孔麦克风，因为您的录音中会出现主板电噪声。

[ShowMeDo.com](http://showmedo.com/)（披露：我是联合创始人）托管 800 个开源教程截屏视频，由超过 100 位开源作者制作。如果您想要展示演示文稿+编程材料的各种示例，您会在这里找到*许多*示例和一个友好的社区。

我是一名拥有 4 年经验的专业屏幕播音员。我一直在收集各种文章和采访（披露：一些采访是我的），它们应该为您提供更多背景知识，它们涵盖开源教程、产品演示、操作方法等：

[blog.procasts.co.uk/2009/01/screencaster-interviews-and-articles/](http://blog.procasts.co.uk/2009/01/screencaster-interviews-and-articles/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T18:17:55.193

Techsmith Camtasia。具有广泛部署选项的至尊屏幕/录音机（即闪存、avi 等）

# java - 如何跳过格式良好的检查 XML

> ID：533508
> 
> 赞同：2
> 
> 时间：2009-02-10T18:18:15.910
> 
> 标签：java, html, xml, xpath

我正在使用 Xpath（和 java）从一些网站中提取信息。但是我的问题是，由于其中一些网站格式不正确，我无法处理它们。有什么方法可以避免格式正确检查，或者指定不应该检查格式正确的标签？

谢谢 Rp

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T18:20:29.977

[使用Tidy](http://tidy.sourceforge.net/)进行预处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T18:43:21.420

查看[http://nekohtml.sourceforge.net/](http://nekohtml.sourceforge.net/)将 HTML 转换为 DOM 对象

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T18:29:16.600

[TagSoup](http://home.ccil.org/~cowan/XML/tagsoup/)是用 Java 编写的符合 SAX 的解析器，可以处理各种损坏的 HTML。尝试使用 TagSoup 作为您的 XML 解析器，然后通过 Xpath 处理输出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T18:21:08.633

您可能不想使用 XML 解析器来解析 HTML。最好使用[HtmlUnit](http://htmlunit.sourceforge.net/)或[HtmlParser 之](http://htmlparser.sourceforge.net/)类的库。

# sql-server - 存储过程 - 发送参数列表以供 IN 子句使用

> ID：533516
> 
> 赞同：2
> 
> 时间：2009-02-10T18:20:49.507
> 
> 标签：sql-server, stored-procedures

[[参数化 SQL IN 子句的重复项](https://stackoverflow.com/questions/337704/parameterizing-a-sql-in-clause])

* * *

**问题：**我需要将值列表发送到存储过程中，以便与 WHERE 子句中的 IN 语句一起使用。

**例子：**

```
declare @SPType NVARCHAR ( 30 )
declare @SPCodeA int

set @SPCodeA  = 75
set @SPType  = '''I'',''M'''

select * from table 
where CodeA=@SPCodeA 
and Type in (@SPType) 
```

从上面我得到 0 个结果，但我想得到类型为 I 或 M 的结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T18:27:03.143

我不相信 'IN' 子句可以处理表达式，我相信你需要一个文字。

尝试：

```
declare @sql NVARCHAR(MAX)

declare @SPType NVARCHAR ( 30 )
declare @SPCodeA int

set @SPCodeA  = 75
set @SPType  = '''I'',''M'''
SET @sql = 'select * from table where CodeA=' + CONVERT(NVARCHAR(MAX), @spcodea) +' and Type in (' + @sptype + ')'

EXEC (@sql) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T18:35:10.330

我过去也遇到过这个问题，并在网上找到了一些解决它的建议。我找到的解决方案是解析输入字符串中的各个值，将它们作为行放入临时表中，然后使用带有 IN 子句的子选择来获取值。下面是我正在使用的代码的简化。它假定 IN 子句中的值是 smallints，更改为使用 varchar 会很容易。

如需进一步参考，请参阅[这篇](http://vyaskn.tripod.com/passing_arrays_to_stored_procedures.htm)文章，了解解决此问题的不同方法。

```
 DECLARE @TempList table
(
    Enum smallint
)

DECLARE @Enum varchar(10), @Pos int

SET @ValueList = LTRIM(RTRIM(@ValueList))+ ','
SET @Pos = CHARINDEX(',', @ValueList, 1)

IF REPLACE(@ValueList, ',', '')  ''
BEGIN
    WHILE @Pos > 0
    BEGIN
        SET @Enum = LTRIM(RTRIM(LEFT(@ValueList, @Pos - 1)))
        IF @Enum  ''
        BEGIN
            INSERT INTO @TempList (Enum) VALUES (CAST(@Enum AS smallint)) --Use Appropriate conversion
        END
        SET @ValueList = RIGHT(@ValueList, LEN(@ValueList) - @Pos)
        SET @Pos = CHARINDEX(',', @ValueList, 1)
    END
END 

SELECT *
FROM ExampleTable
WHERE
ExampleTable.Enum in (select Enum from @TempList) 

```

# c# - 如何在重定向后保持下拉列表选项突出显示？

> ID：533524
> 
> 赞同：0
> 
> 时间：2009-02-10T18:24:52.430
> 
> 标签：c#, .net, asp.net

我从数据库中提取我的 ddl 选项，它设置列表的顺序。当我 Response.Redirect 时，如何保持所选选项显示？

页面加载阿迪达斯 -（ddl 列表顺序）**阿迪达斯**、耐克、彪马

选择耐克时 -（ddl 列表顺序）阿迪达斯、**耐克**、彪马

为 Puma - -（ddl 列表顺序）阿迪达斯、耐克、**彪马**

现在，重定向将显示的选项重置为**Adidas**。我如何让它相应地改变？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T18:27:21.597

response.redirect 应该清除视图状态，因此您能够保留所选项目的唯一方法是以某种方式将其编码到新请求中。在 response.redirect 之前使用查询字符串 (foo.aspx?currentSelectedShoes=Nike) 或设置具有相同信息的 cookie。

然后在您的页面加载事件处理程序中检查查询字符串或 cookie 并相应地设置所选项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T18:33:13.517

为了补充 Randolpho 所说的内容，您还可以使用会话状态或 ASP.NET 配置文件。这些选项有一些注意事项，但可能是正确的选择，特别是如果这条数据的范围不仅仅是这个特定的页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T18:32:36.157

使用**Server.Transfer**而不是**Response.Redirect**将保留您当前的表单状态，允许您根据需要将所选值存储在隐藏字段中。

# c# - C# webservice 需要即时将 SOAP 转换为 REST

> ID：533525
> 
> 赞同：0
> 
> 时间：2009-02-10T18:25:24.800
> 
> 标签：c#, xml, rest, soap

我正在尝试为我正在为其编写软件的测试系统编写翻译层。我将 LabVIEW 用于测试系统并使用 RESTful Web 服务。我已经实现了 REST 方法，它们工作正常。远程测试控制器和数据服务层等是用 C# 和 SQL 编写的，这些是我必须使用 SOAP 进行交互的项目。我有一个同事用 C# 为 SOAP 端编写的简单 Web 服务客户端。我基本上需要把 C# 程序收集的对象，然后构建一个小的 XML，可以作为 post 数据发送到 REST URI。

我已经介绍了 C# 课程，但是当我主要在 LabVIEW 中编写代码时，它是“这是基于您的基于文本的语言的 C#”并没有帮助。我很久以前就接受过 C 和一点 C++ 的培训，但在课程中真的很挣扎，这是一个非常陡峭的学习曲线，并且自从大约 3 个月前的课程以来就没有使用过 C#。我想学习 C#，并认为这将是一种简单的开始方式，但到目前为止我一直在苦苦挣扎。

好的一些代码：

```
[WebMethod]
[SoapHeader("RMSSvcHeader", Direction = SoapHeaderDirection.InOut)]
public ReturnStatus Initialise(string uri)
{
    ReturnStatus rs = new ReturnStatus();
    try
    {
        rs.Message = HttpPostXml(uri, @"C:\Inetpub\wwwroot\RMS\XMLMessages\Initialise.xml");
    }
    catch (Exception exc)
    {
        rs.Status = 1;
        rs.Message = exc.Message;
    }
    return rs;
} 
```

因此，当前版本使用一种方法将一组虚拟数据的 XML 文件作为 POSTDATA 发布到 REST URI 以用于测试目的。传递给此方法的 SOAP 数据公开了 UUID (GUID) 和方法名称。这意味着我有足够的信息来为需要发送到 REST 服务的 POSDATA 消息创建 XML。像这样的东西：

```
<?xml version="1.0" encoding="utf-8"?>
    <Initialise>
    <UUID>d7051980-a690-11dd-ad8b-0800200c9a66</UUID>
</Initialise> 
```

我只需要指出正确的方向，即如何最好地将对象转换为 REST 服务的 XML。

谢谢，

尼尔。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T18:34:41.907

您是否考虑过改用 WCF？[有一种更简单的方法](http://msdn.microsoft.com/en-us/netframework/cc950529.aspx)可以发布这些服务以进行 REST 交互。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T18:11:39.367

您可以做的是拥有 web 服务、以 RESTful 方式或 SOAP 方式（通过返回 XML）公开服务的页面。

# c# - 如何替换 URL 中的特殊字符？

> ID：533527
> 
> 赞同：17
> 
> 时间：2009-02-10T18:25:54.503
> 
> 标签：c#, url, encoding

这可能很简单，但我自己根本找不到答案:(

基本上，我想要的是，给定这个字符串：

“ [http://www.google.com/search?hl=en&q=c#](http://www.google.com/search?hl=en&q=c#)对象”

我想要这个输出：

[http://www.google.com/search?hl=en&q=c%23+objects](http://www.google.com/search?hl=en&q=c%23+objects)

我确信在框架中的某个地方有一些帮助程序类可以为我处理这个问题，但是我很难找到它。

编辑：我应该补充一点，这是针对 Winforms 应用程序的。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-10T18:30:12.823

HttpServerUtility.UrlEncode(字符串)

应该整理出任何麻烦的字符

要使用它，您需要添加对 System.Web 的引用（Project Explorer > References > Add reference > System.Web）

完成后，您可以使用它对您希望添加到查询字符串的任何项目进行编码：

```
System.Web.HttpUtility.UrlEncode("c# objects"); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-01-28T11:05:09.280

如果您不想依赖 System.Web，这里是我在 C# OAuth 库中的“UrlEncode”的实现（需要正确的实现 - 即空格应该使用百分比编码而不是“+”用于空格等.)

```
private readonly static string reservedCharacters = "!*'();:@&=+$,/?%#[]";

public static string UrlEncode(string value)
{
    if (String.IsNullOrEmpty(value))
        return String.Empty;

    var sb = new StringBuilder();

    foreach (char @char in value)
    {
        if (reservedCharacters.IndexOf(@char) == -1)
            sb.Append(@char);
        else
            sb.AppendFormat("%{0:X2}", (int)@char);
    }
    return sb.ToString();
} 
```

供参考 [http://en.wikipedia.org/wiki/Percent-encoding](http://en.wikipedia.org/wiki/Percent-encoding)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-23T15:56:38.827

@Wilfred Knievel 有公认的答案，但`Uri.EscapeUriString()`如果您想避免对`System.Web`命名空间的依赖，也可以使用。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-10T18:27:05.513

看看 Server.UrlEncode

[http://msdn.microsoft.com/en-us/library/ms525738.aspx](http://msdn.microsoft.com/en-us/library/ms525738.aspx)

# c# - OnItemDataBound 的用途

> ID：533533
> 
> 赞同：2
> 
> 时间：2009-02-10T18:27:24.297
> 
> 标签：c#, .net, events, event-binding

你会在 Repeater 上实际使用 OnItemDataBound 做什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T18:30:28.720

“此事件为您提供了在数据项显示在客户端之前访问数据项的最后机会。引发此事件后，数据项将被清空且不再可用。”

~ [http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datagrid.onitemdatabound.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datagrid.onitemdatabound.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T18:29:48.953

一种用途可以是基于在绑定中继器时仅可从绑定数据项获得的信息的动态控制生成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T18:29:02.577

当我需要为转发器中的每个项目稍微按摩数据时，我就使用了它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T18:31:01.400

如果您想使用动态控件或数据自定义模板中的单个项目，而这些控件或数据不属于您最初绑定到中继器的结果集，则有必要这样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T22:39:56.140

像这样想。在创建您的项目时，所有 OnDataBinding 事件都会针对该特定项目触发。可能有很多事情会构建一个项目，因此可以调用很多 OnDataBinding 事件。全部完成后，这是触发的事件，因此您可以应用一些最终的“触摸”，此时所有 OnDataBinding 事件都已完成。

例如。您的项目填充 10 个数据字段，并在绑定时执行各种操作。填满所有数据后，您需要检查现在已创建的某些数据片段，并为整个项目设置一些内容，例如整行颜色或基于整个项目数据的某些图标。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T18:44:53.303

我用它来实现嵌套中继器。在外部转发器的 ItemDataBound 事件处理程序中，您运行代码来数据绑定内部转发器的当前项的实例。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T22:28:59.127

我发现数据绑定语法难以阅读和调试。我不认为我曾经使用 OnItemDataBound 做过任何我无法通过将数据绑定表达式放入标记中来完成的事情，但是如果我想稍后更改它，我个人发现它更容易设置OnItemDataBound 中的断点，然后使用即时窗口确定我想要渲染的内容。我也是代码和标记应该分开的明显衰落（例如Ruby）格言的拥护者。

# java - Glassfish 中加载的类总数

> ID：533545
> 
> 赞同：2
> 
> 时间：2009-02-10T18:30:34.943
> 
> 标签：java, memory, deployment, glassfish, classloader

我有 EJB 的企业应用程序。该应用程序的总大小为 34 兆。当我部署我的应用程序时，一切都很好，但是当我重新部署它时，总加载类的数量会增加。我正在使用 visualVM 来查看此信息。它应该是这样还是内存泄漏。如何解决这个问题呢？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T19:01:03.950

你有一个类加载器泄漏！

您通常会发现，当您在*任何*JavaEE 应用程序服务器（包括 Glassfish）上部署应用程序时，应用程序服务器将专门为您的应用程序创建一个新的类加载器。当您的应用程序初始化并运行时，该类加载器将加载新类，这些新类将被放置到永久内存中，称为`PermGen`区域。

当应用程序被取消部署时，该类加载器应该被垃圾收集，但有时这不会发生，因为某些东西导致引用持续存在。当您*重新部署*应用程序时，应用程序服务器会执行与以前相同的动作，但现在可用的内存更少了。

有关这方面的更多信息，请查看[Frank Kieviet的名为 Classloader](http://frankkieviet.blogspot.com/) [Leaks](http://frankkieviet.blogspot.com/2006/10/classloader-leaks-dreaded-permgen-space.html)的博客文章以及有关[如何修复](http://frankkieviet.blogspot.com/2006/10/how-to-fix-dreaded-permgen-space.html)Classloader Leaks的后续文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T21:27:38.513

Visual VM 只是 Netbeans 中包含的“分析器”工具的独立版本。

因此，为了检测您的内存泄漏，您应该阅读 Netbeans 分析器的文档。

这里有一些链接可以帮助您入门

*   [http://www.netbeans.org/kb/60/java/profiler-intro.html](http://www.netbeans.org/kb/60/java/profiler-intro.html)
*   [http://www.netbeans.org/community/magazine/html/04/profiler.html](http://www.netbeans.org/community/magazine/html/04/profiler.html)
*   [http://www.javapassion.com/handsonlabs/nbprofilerperformance/index.html](http://www.javapassion.com/handsonlabs/nbprofilerperformance/index.html)

# html - 最小的网页设计

> ID：533549
> 
> 赞同：5
> 
> 时间：2009-02-10T18:31:40.883
> 
> 标签：html, css

我对极简设计感兴趣，从设计（即极简设计）和性能的角度来看。我目前正在尝试“零图像”方法。

（显然没有 flash/silverlight/etc）纯 html+css(+js)

有没有人试过，看过，想过。

举个例子，craigslist 就是极简设计。它有 0 个图像，1 个 css，1 个 js。

StackOverflow 不是最小的设计（尽管看起来如此）。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T19:10:04.320

在我制作网站的 13 年里，我考虑了很多。我认为这归结为一件事。“这个网站的意图是什么？” 根据意图是什么，将推动所需的交互性水平、复杂程度、用户界面的深度，以及实现意图所需的图像数量。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T18:36:22.170

谷歌像 13 年前一样击败了 Altavista。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-10T18:38:24.830

你试过[960](http://960.gs/demo.html)框架吗？它非常简约，而且很受欢迎。显然你可以去掉演示中使用的列图像，剩下的就是 css 和 html。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T18:35:57.020

创建不是极简但优雅降级的应用程序是一种选择吗？许多客户想要的最重要的事情是“哇”的因素，而这很难通过极简主义来实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T18:46:26.387

谈到极简主义，我喜欢 plaintxt.org 的[blog.txt](http://www.plaintxt.org/themes/blogtxt/blogtxt_01/) wordpress 主题。只有干净的布局和良好的字体组合。:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T19:32:05.950

必须同意 dominicminicoopers 对此的看法。您需要了解预期的目标受众以及他们将用于访问此站点的方法，以便了解使用这种样式是否有意义。如果该站点用于小型移动设备或互联网连接速度非常慢，那么我可以理解您为什么要减少图形和文件的数量。另一方面，如果他们将使用更高速的连接，那么为什么不让网站尽可能吸引人呢？我并不是说图形对于使任何网站都具有吸引力是必不可少的，但它们肯定会有所帮助。

祝你好运！

安德烈斯

# perl - Perl 构建、单元测试、代码覆盖率：一个完整 的工作示例

> ID：533553
> 
> 赞同：86
> 
> 时间：2009-02-10T18:32:59.370
> 
> 标签：perl, unit-testing, build-process, build-automation, code-coverage

我找到的关于 Perl 构建过程、单元测试和代码覆盖率的大多数 Stackoverflow 答案只是将我指向 CPAN 以获取那里的文档。指向 CPAN 模块绝对没有错，因为这是完整文档所在的位置。不过，在许多情况下，我很难找到完整的工作代码示例。

我一直在互联网上搜索可以下载或粘贴到我的 IDE 中的实际工作代码示例，例如您的典型教程“Hello World”示例源代码，但是一个示例通过单元测试和代码演示构建过程覆盖分析。有没有人有一个完整的工作项目的小例子来展示这些技术和流程？

*（我确实有一个小的工作示例，我会用它来回答我自己的问题，但可能还有其他 SO 用户的示例比我想出的示例更好。）*

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2009-02-10T18:38:10.620

我花了一段时间，也花了我从许多不同的来源获取小片段并将它们融合在一起，但我认为我有一个小的工作示例，足以向 Perl 新手演示 Perl 构建过程，包括单元测试和代码覆盖分析和报告。（我在 Windows XP Pro PC 上使用[ActiveState ActivePerl](http://www.activestate.com/activeperl/) v5.10.0，[Module::Build](http://search.cpan.org/~ewilhelm/Module-Build-0.31012/lib/Module/Build.pm)，[Test::More](http://search.cpan.org/dist/Test-Simple/lib/Test/More.pm)，[Devel::Cover](http://search.cpan.org/dist/Devel-Cover/lib/Devel/Cover.pm)）

从 Perl 项目的目录开始，然后在项目目录下创建一个“lib”目录和一个“t”目录：

```
HelloPerlBuildWorld
        |
        |----------> lib
        |
        |----------> t 
```

在“lib”目录中，创建一个名为“HelloPerlBuildWorld.pm”的文本文件。该文件是您将要构建和测试的 Perl 模块。将以下内容粘贴到此文件中：

```
use strict;
use warnings;
package HelloPerlBuildWorld;

$HelloPerlBuildWorld::VERSION = '0.1';

sub hello {
   return "Hello, Perl Build World!";
}

sub bye {
   return "Goodbye, cruel world!";
}

sub repeat {
   return 1;
}

sub argumentTest {
    my ($booleanArg) = @_;

    if (!defined($booleanArg)) {
        return "null";
    }
    elsif ($booleanArg eq "false") {
        return "false";
    }
    elsif ($booleanArg eq "true") {
        return "true";
    }
    else {
        return "unknown";
    }

   return "Unreachable code: cannot be covered";
}

1; 
```

在“t”目录中，创建一个名为“HelloPerlBuildWorld.t”的文本文件。该文件是您的单元测试脚本，它将尝试全面测试您上面的 Perl 模块。将以下内容粘贴到此文件中：

```
use strict;
use warnings;
use Test::More qw(no_plan);

# Verify module can be included via "use" pragma
BEGIN { use_ok('HelloPerlBuildWorld') };

# Verify module can be included via "require" pragma
require_ok( 'HelloPerlBuildWorld' );

# Test hello() routine using a regular expression
my $helloCall = HelloPerlBuildWorld::hello();
like($helloCall, qr/Hello, .*World/, "hello() RE test");

# Test hello_message() routine using a got/expected routine
is($helloCall, "Hello, Perl Build World!", "hello() IS test");

# Do not test bye() routine

# Test repeat() routine using a got/expected routine
for (my $ctr=1; $ctr<=10; $ctr++) {
    my $repeatCall = HelloPerlBuildWorld::repeat();
    is($repeatCall, 1, "repeat() IS test");
}

# Test argumentTest() 
my $argumentTestCall1 = HelloPerlBuildWorld::argumentTest();
is($argumentTestCall1, "null", "argumentTest() IS null test");

# Test argumentTest("true") 
my $argumentTestCall2 = HelloPerlBuildWorld::argumentTest("true");
is($argumentTestCall2, "true", "argumentTest() IS true test");

# Test argumentTest("false") 
my $argumentTestCall3 = HelloPerlBuildWorld::argumentTest("false");
is($argumentTestCall3, "false", "argumentTest() IS false test");

# Test argumentTest(123) 
my $argumentTestCall4 = HelloPerlBuildWorld::argumentTest(123);
is($argumentTestCall4, "unknown", "argumentTest() IS unknown test"); 
```

现在备份到您的顶级项目目录，创建一个名为“Build.PL”的文本文件。该文件将创建您稍后将使用的构建脚本。将以下内容粘贴到此文件中：

```
use strict;
use warnings;
use Module::Build;

my $builder = Module::Build->new(
    module_name         => 'HelloPerlBuildWorld',
    license             => 'perl',
    dist_abstract       => 'HelloPerlBuildWorld short description',
    dist_author         => 'Author Name <email_addy@goes.here>',
    build_requires => {
        'Test::More' => '0.10',
    },
);

$builder->create_build_script(); 
```

这就是您需要的所有文件。现在从顶级项目目录的命令行中，键入以下命令：

```
perl Build.PL 
```

您将看到类似于以下内容的内容：

```
Checking prerequisites...
Looks good

Creating new 'Build' script for 'HelloPerlBuildWorld' version '0.1' 
```

现在您应该能够使用以下命令运行单元测试：

```
Build test 
```

并看到与此类似的内容：

```
Copying lib\HelloPerlBuildWorld.pm -> blib\lib\HelloPerlBuildWorld.pm
t\HelloPerlBuildWorld....ok
All tests successful.
Files=1, Tests=18,  0 wallclock secs ( 0.00 cusr +  0.00 csys =  0.00 CPU) 
```

要使用代码覆盖率分析运行单元测试，请尝试以下操作：

```
Build testcover 
```

你会看到一些关于这个顺序的东西：

```
t\HelloPerlBuildWorld....ok
All tests successful.
Files=1, Tests=18, 12 wallclock secs ( 0.00 cusr +  0.00 csys =  0.00 CPU)
cover
Reading database from D:/Documents and Settings/LeuchKW/workspace/HelloPerlBuildWorld/cover_db

----------------------------------- ------ ------ ------ ------ ------ ------
File                                  stmt   bran   cond    sub   time  total
----------------------------------- ------ ------ ------ ------ ------ ------
D:/Perl/lib/ActivePerl/Config.pm       0.0    0.0    0.0    0.0    n/a    0.0
D:/Perl/lib/ActiveState/Path.pm        0.0    0.0    0.0    0.0    n/a    0.0
D:/Perl/lib/AutoLoader.pm              0.0    0.0    0.0    0.0    n/a    0.0
D:/Perl/lib/B.pm                      18.6   16.7   13.3   19.2   96.4   17.6
 ...
[SNIP]
 ...
D:/Perl/lib/re.pm                      0.0    0.0    0.0    0.0    n/a    0.0
D:/Perl/lib/strict.pm                 84.6   50.0   50.0  100.0    0.0   73.1
D:/Perl/lib/vars.pm                   44.4   36.4    0.0  100.0    0.0   36.2
D:/Perl/lib/warnings.pm               15.3   12.1    0.0   11.1    0.0   12.0
D:/Perl/lib/warnings/register.pm       0.0    0.0    n/a    0.0    n/a    0.0
blib/lib/HelloPerlBuildWorld.pm       87.5  100.0    n/a   83.3    0.0   89.3
Total                                  9.9    4.6    2.8   11.3  100.0    7.6
----------------------------------- ------ ------ ------ ------ ------ ------

Writing HTML output to D:/Documents and Settings/LeuchKW/workspace/HelloPerlBuildWorld/cover_db/coverage.html ...
done. 
```

*（有人请告诉我如何配置 Cover 以忽略所有 Perl 库，但只报告我编写的单个文件。根据 CPAN 文档，我无法让 Cover 过滤工作！）*

现在，如果您刷新顶级目录，您可以看到一个名为“cover_db”的新子目录。进入该目录并双击“coverage.html”文件以在您喜欢的 Web 浏览器中打开代码覆盖率报告。它为您提供了一个漂亮的彩色编码超文本报告，您可以单击文件名并在实际源代码旁边的报告中查看 Perl 模块的详细语句、分支、条件、子程序覆盖率统计信息。您可以在此报告中看到，我们根本没有涵盖“bye()”例程，而且还有一行无法访问的代码没有像我们预期的那样被涵盖。

[![代码覆盖率报告快照](https://i.stack.imgur.com/bW6cH.jpg)](https://i.stack.imgur.com/bW6cH.jpg)
[（来源：[leucht.com](http://www.leucht.com/images/CodeCoverageExample.jpg)）]

您可以做的另一件事是帮助您在 IDE 中自动执行此过程，即创建更多“Build.PL”类型的文件，这些文件显式执行我们在上面从命令行手动执行的一些构建目标。例如，我使用具有以下内容的“BuildTest.PL”文件：

```
use strict;
use warnings;
use Module::Build;

my $build = Module::Build->resume (
  properties => {
    config_dir => '_build',
  },
);

$build->dispatch('build');
$build->dispatch('test'); 
```

然后我设置我的 IDE 以通过单击鼠标执行此文件（通过“perl BuiltTest.PL”），它会自动从 IDE 运行我的单元测试代码，而不是我从命令行手动执行。将“dispatch('test')”替换为“dispatch('testcover')”以自动执行代码覆盖率。键入“构建帮助”以获取可从 Module::Build 获得的构建目标的完整列表。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-10T18:54:48.847

作为对 Kurt 的回应，我建议用这个替代他的 BuiltTest.PL 脚本。

```
use strict;
use warnings;
use Module::Build;

my $build = Module::Build->resume (
  properties => {
    config_dir => '_build',
  },
);

$build->dispatch('build');
$build->dispatch('test'); 
```

它重用由 Build.PL 构建的数据库（因此假设已经运行）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-11T07:58:40.587

我在[Intermediate Perl](http://oreilly.com/catalog/9780596102067/)和[Mastering Perl](http://oreilly.com/catalog/9780596527242/)中对此进行了介绍。然而，Kurt 给出了一个很好的总结。

[不过，我使用Module::Release](http://search.cpan.org/dist/Module-Release)将所有这些组合到一个发布脚本中。我输入一个命令，一切都会发生。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-11T09:38:37.460

非常有用[`module-starter`](http://search.cpan.org/dist/Module-Starter/bin/module-starter)的生成了一个易于使用的骨架项目，它处理模块安装、文档创建和模块文件的良好布局，以及——我*认为*——代码覆盖支持。对于任何与 Perl 模块相关的工作来说，这都是 IMO 一个很好的开始。

另外：使用与 CPAN 相关的工具`Module::Build`——即使对于可能永远不会公开发布的模块——[也是一个非常好的主意](http://perlbuzz.com/2008/10/write-your-code-like-its-going-on-cpan.html)。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-08-16T00:24:06.913

（披露：我是作者）

一旦您按照上述方式对所有内容进行了排序，您就可以进行下一步并使用[Devel::CoverX::Covered](http://search.cpan.org/dist/Devel-CoverX-Covered/lib/Devel/CoverX/Covered.pm)来例如

*   给定一个源文件，列出为该源文件提供覆盖的测试文件。这可以在文件、子例程和行级别上完成。
*   给定一个测试文件，列出该测试文件涵盖的源文件和子文件。
*   给定一个源文件，有效地报告每行或子的覆盖率细节。

有关具体的命令行示例，请参见[概要](http://search.cpan.org/dist/Devel-CoverX-Covered/lib/Devel/CoverX/Covered.pm#SYNOPSIS)。

在[Devel::PerlySense](http://search.cpan.org/dist/Devel-PerlySense/lib/Devel/PerlySense.pm)中，Emacs 支持在源代码缓冲区（[屏幕截图](http://cpansearch.perl.org/src/JOHANL/Devel-PerlySense-0.0180/doc/code_coverage.html)）中显示覆盖信息，以及导航到/从覆盖测试文件。

# c# - 如何在项目中为不同的构建配置使用不同的文件 - Visual Studio C# .net

> ID：533554
> 
> 赞同：12
> 
> 时间：2009-02-10T18:33:01.770
> 
> 标签：c#, .net, visual-studio, build

我有 ac# .net winforms 解决方案，我想创建两个不同的版本：一个支持 IE6，一个支持 IE7。我的一个项目中的一些文件对于 IE6 构建与 IE7 构建是不同的，因此我想在为 IE6 构建时包含 IE6 文件，在为 IE7 构建时包含 IE7 文件。针对这种情况构建我的解决方案的最佳方法是什么？

由于其他限制，我不想创建包含共享项目的单独程序集；我希望项目编译为单个程序集“foo.dll”，无论我正在制作哪个版本。

我想我可以创建两个单独的项目来编译为“foo.dll”，然后创建两个发布配置，并且只在相关配置中包含相关项目。但是，我需要在两个项目中包含与 IE6 和 IE7 相同的文件，并且我看不到如何在两个项目中使用文件的单个副本（当我添加现有项目时，它会在项目目录）。我正在使用 SVN 进行源代码控制，因此也许可以使用它在文件夹之间进行“共享”，但怀疑这是最好的方法..

注意：由于 IE 中的 API 差异，需要不同的构建，其细节与问题无关 - 请相信我需要两个构建。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-10T19:01:58.580

在 MSBuild 中，您可以为项组指定条件。然后，您可以将这些条件绑定到目标设备。

例子：

```
<!-- Declare the condition property at the beggining of the build file -->
<PropertyGroup Condition="$(Platform) == 'IE7'">
  <UseNewLibrary>true</UseNewLibrary>
</PropertyGroup>

<PropertyGroup Condition="$(Platform) == 'IE6'">
  <UseNewLibrary>false</UseNewLibrary>
</PropertyGroup>

<!-- Then those the property to select the right file -->
<ItemGroup Condition="$(UseNewLibrary)==true">
  <Compile Include="Class1.cs"/>
  <Compile Include="Class2.cs"/>
  <Compile Include="Class3.cs"/>
  <Compile Include="Class4.cs"/>
</ItemGroup>

<ItemGroup Condition="$(UseNewLibrary)==false">
   <Compile Include="Class1Old.cs"/>
   <Compile Include="Class2Old.cs"/>
   <Compile Include="Class3Old.cs"/>
   <Compile Include="Class4Old.cs"/>
</ItemGroup>

<!-- And now references -->
<ItemGroup Condition="$(UseNewLibrary)==true">
  <Reference Include="MyAssembly, Version=1.1.7.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
</ItemGroup>

<ItemGroup Condition="$(UseNewLibrary)==false">
  <Reference Include="MyAssembly, Version=1.0.6.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
</ItemGroup> 
```

请注意，所有文件都将出现在 IDE 中，但在编译时所有文件都应该正确对齐。

然后，您需要做的就是在配置管理中创建您的平台（IE6 和 IE7）。

您也可以直接使用平台属性，而不是创建中间属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T19:02:54.787

为了在两个或多个项目中添加相同的文件，您可以

右键单击项目并选择添加>>现有项目
在文件选择器中选择文件单击
文件选择器中添加按钮右侧的小三角形
选择添加为链接

这会将文件添加到项目中而不复制它。

我不知道你情况的所有细节，但你的解决方案听起来很尴尬。同一 dll 的两个版本最终可能会导致客户端计算机上的配置问题。我鼓励您考虑 Kevin 关于具有所有功能的单个 dll 的想法，并根据需要调用适当的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T19:03:26.143

假设您使用的是 VS2005 或更高版本，您可以使用项目文件中的 Condition 属性。

您需要直接编辑 csproj 文件

1.  卸载项目
2.  编辑

然后在您要有条件地包含的文件上

```
<Compile Include="IE6.cs" Condition=" '$(Platform)' == 'IE6' " />
<Compile Include="IE7.cs" Condition=" '$(Platform)' == 'IE7' " />
<Compile Include="IE.cs"  /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T18:55:50.843

我不知道怎么做你问的，但你不能只在 dll 中包含你的 API 包装器的两个版本并确定在运行时调用哪一个吗？例如，如果用户安装了您的应用程序的 IE6 版本，然后升级到 IE7，该怎么办？他们需要重新安装，对吧？

在我看来，这将是一个更简单的解决方案，但也许我错过了一些东西......

# c# - 在 C# 中创建用于填充下拉列表、网格等的类

> ID：533560
> 
> 赞同：0
> 
> 时间：2009-02-10T18:33:47.510
> 
> 标签：c#, oop, ienumerable

请记住，我是 C# 和 OOP 的新手，所以如果这对某些人来说似乎是一个简单的问题，我提前道歉。我将回顾我的代码并寻找方法来客观化重复代码并为其创建一个类，以便我可以简单地重用该类。话虽如此，我还不想学习 NHibernate 或任何其他 ORM。我什至不想学习 LINQ。我想破解这个来学习。

基本上，我使用相同的代码来访问我的数据库并用我得到的值填充一个下拉列表。一个例子：

```
 protected void LoadSchools()
    {
        SqlDataReader reader;

        var connectionString = ConfigurationManager.ConnectionStrings["MyConnectionString"].ConnectionString;
        var conn = new SqlConnection(connectionString);
        var comm = new SqlCommand("SELECT * FROM [Schools] ORDER BY [SchoolName] ASC", conn);

        try
        {
            conn.Open();
            reader = comm.ExecuteReader();
            cmbEditSchool.DataSource = reader;
            cmbEditSchool.DataBind();

            cmbEditSchool.Text = "Please select an existing school to edit...";
            if (reader != null) reader.Close();
        }

        finally
        {
            conn.Dispose();
        }
    } 
```

我在整个程序中，在不同的页面上一遍又一遍地使用同样的代码。大多数情况下，我填充一个下拉列表或组合框，但有时我会填充一个网格视图，只是稍微改变查询。

**我的问题是如何创建一个允许我调用存储过程的类**，而不是像我的示例那样手动使用查询并填充我的不同控件？是否可以只使用一种方法？我只需要从选择开始。我一直在阅读 IEnumerable ，这似乎是合适的接口，但我该如何使用它呢？

***编辑添加：***

我将 Rorschach 的答案标记为 THE answer，因为他/她解决了我的 IEnumerable 问题。我也理解需要适当的 DAL 和 BLL 层。我试图达到的就是那个。我可以使用数据集和表适配器构建 DAL，最终得到一个强类型数据集。但是，我觉得有点脱离了代码。从我上面给出的代码开始，我一直在寻找一种直接构建 DAL 的方法。也许我没有正确地措辞我的问题或我所追求的。

无论如何，罗夏最接近回答我的实际问题。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T18:51:06.080

这是一种减少代码重复的肮脏方法。设置数据访问层 (DAL) 和业务逻辑层 (BLL) 并不是真正正确的方法，我建议您学习一下。

```
protected void FillFromDatabase( string sql, BaseDataBoundControl dataControl)
{
SqlDataReader reader = null;

var connectionString = ConfigurationManager.ConnectionStrings["MyConnectionString"].ConnectionString;
var conn = new SqlConnection( connectionString );
var comm = new SqlCommand( sql, conn );

try
{
    conn.Open();
    reader = comm.ExecuteReader();
    dataControl.DataSource = reader;
    dataControl.DataBind();
}

finally
{
    if( reader != null )
        reader.Dispose();

    conn.Dispose();
}
} 
```

那么你可以这样称呼它

```
const string sql = "SELECT * FROM [Schools] ORDER BY [SchoolName] ASC";
FillFromDatabase( sql, cmbEditSchool ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T19:06:44.577

您可以创建一个允许您调用存储过程的类（这称为数据访问组件 (DAC) 类，通常由业务组件 (BC) 类引用，但它超出了您的问题范围）。

您将希望在这个新类中使用一些对象： Microsoft.Practices.EnterpriseLibrary.Data.Database Microsoft.EnterpriseLibrary.Data.DatabaseFactory System.Data.Common.DBCommand

DAC 类看起来与您所拥有的类似：

```
public class DataAccess
{
    public DataAccess()
    {
    }
    public System.Collections.IEnumerable GetSchoolData()
    {
        string connectionString = ConfigurationManager.ConnectionStrings["MyConnectionString"].ConnectionString;
        Database db = DatabaseFactory.CreateDatabase(connectionString);
        string sqlCommand = "GetSchoolData";
        DbCommand comm = db.GetStoredProcCommand(sqlCommand);
        //db.AddInParameter(comm, "SchoolId", DbType.Int32); // this is in case you want to add parameters to your stored procedure

        return db.ExecuteDataSet(comm);
    }
} 
```

您的页面代码将如下所示：

```
public class SchoolPage : Page
{
  public void Page_Init(object sender, EventArgs e)
  {
    DataAccess dac = new  DataAccess();
    cmbEditSchool.DataSource = dac.GetSchoolData();
    cmbEditSchool.DataBind();
  }
} 
```

请注意，这只是为了帮助您了解如何执行此操作。这不是一个好的开发方法，因为您正在向外部世界开放数据访问层（这很糟糕）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T18:48:24.650

您应该看看 ADO.NET 并使用 DataSets 之类的东西。Linq-to-SQL 也可能对您有用。但恐怕你不会只用一个方法调用来替换你所有的数据操作。

# agile - 六西格玛质量管理和软件开发

> ID：533562
> 
> 赞同：10
> 
> 时间：2009-02-10T18:34:16.947
> 
> 标签：agile

是否可以在软件开发过程中使用 6 Sigma 质量管理？

你对此有何经验？

如果你使用像 Scrum 或 XP 这样的敏捷方法，六西格码是不是太官僚了？

我说的是整个软件开发的质量管理，从需求收集到部署和操作，而不仅仅是构建阶段（TDD 和单元测试等工具或多或少已被确立为最佳实践）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-10T18:40:55.950

六西格码适用于可重现的过程。我的意思是指始终产生（或应该产生）相同输出的纯过程。鉴于软件开发很少产生相同的输出，SS 并不真正适用，IMO。这是因为软件开发与其说是一个过程，不如说是一种实践。

话虽如此，阅读它并尝试了解可以将哪些顶级想法应用于软件开发并没有什么坏处......

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-10T18:37:48.390

如果我理解正确的话，6 sigma 依赖于有意义的、可衡量的指标。你的会是什么？克洛克？课程签入您的档案？敏捷速度？

6 sigma 在车间工作得很好，但我不认为软件开发足够“类似于小部件”以适应这种方法。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-10T19:18:50.070

只要您不开发新产品，这绝对是可能的。

只需按照以下步骤操作。

1) 创建应用程序的无错误版本。这可能需要相当大的努力，因此最好选择范围较小的应用程序。
2) 从头开始​​重新创建应用程序，并将迭代与在步骤 1 中创建的理想进行比较以创建度量。
3) 调整您的流程，以在下一次迭代中与指标更紧密地对齐。
4) 转到步骤 2。

什么？您不会在您的商店中一遍又一遍地创建相同的应用程序吗？嗯，我不认为 6 sigma 在那种情况下会有多大用处。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-10T18:52:14.597

要使六西格码有用，您需要易于比较的指标或程序。

软件过于抽象，无法提供所需的度量类型。

也许一个很好的问题是

> 是否有类似 6 Sigma 的软件开发质量控制工具适用于生产和制造领域？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-10T18:40:31.283

我使用了广泛的方法，六西格码，敏捷等。真正的软件开发质量管理的成功取决于一个关键的事情。团队的质量。这一切都归结为这一点。一个好的团队可以在一种糟糕的方法中工作并使其发挥作用。这就是为什么他们很好。流程很重要，你可以让糟糕的流程更有效率，但这一切都取决于团队。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-10T19:35:08.500

软件开发的某些部分不太适合，因为它们没有提供结果正态分布的过程。另一方面，关注风险、价值和做正确的事情是必不可少的

[编辑] 看看 Cynefin 模型（在维基百科上），以了解为什么大部分软件开发都在复杂领域中。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-19T20:40:09.350

六西格码非常适合有大量离散工作项目积压的维护团队。

六西格码设计有一些可用于构建新软件产品的元素。

而且由于大多数软件是业务流程的推动者，并且该业务流程可能是一个高度重复的流程，可以应用六西格玛的统计工具，六西格玛可以在确定最高价值的软件功能要交付方面发挥作用最大的商业价值。它可以消除特征优先级决策过程中的情绪。如果您的环境中，喊得最大声或最有说服力的产品经理/利益相关者构建了他们的东西，则可以应用 6 sigma 来解决您的开发过程中不健康的方面，方法是在优先级排序过程后面进行一些合理的测量。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-10T18:41:25.073

我不确定是否会跟随你。

[SixSigma](http://en.wikipedia.org/wiki/Six_Sigma)是一种管理**流程变化**的方法，它使用数据和统计分析来衡量和改进公司的运营绩效。

因此，采取任何流程（SDP 或其他流程），选择您想要衡量的内容，识别问题，规划解决方案，评估影响。

我参与的 SixSigma 项目都是相当横向的，与软件生命周期无关。

* * *

所谓横向，我的意思是横向于软件开发的“产品设计-开发-构建-交付”过程。

例如，在一个环境中，如果我们需要在内部生产平台上制作一套程序，我们的 SixSigma 项目大部分都围绕**[Operational Architecture](https://stackoverflow.com/questions/122931#123132)**，即“使操作成为执行环境”（如何设置服务器和网络为了停止、更新、安装和启动一组可执行文件，以及许多项目，每个项目都有自己的 SDP）。
这是一个横向于任何你想要的 SDP 的概念，因为最终，所有这些“开发过程”只有一个共同目标：将你的软件投入生产。

衡量标准是精确且可重复的，从管理合并最终可执行文件所需的合并时间到合并错误数量到部署错误（由于标签不正确或发行说明错误）。

所有这些失误都在一个又一个发布后被记录下来，目标是减少它们。
一个副作用是发现了一个不充分的[合并工作](https://stackoverflow.com/questions/216212#216228)流，一旦修复，工作流可以让我们大大减少最终交付集的错误。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-02-16T14:46:33.027

我有一个教授在教六西格玛和其他制造效率技术，在告诉他我在软件开发领域后，他推荐了《[精益软件开发](http://books.google.com/books?id=8o1eom6ifIMC&dq=lean+software+development&printsec=frontcover&source=bn&hl=en&ei=ra16S6ihG5CjngfPwaj4DA&sa=X&oi=book_result&ct=result&resnum=4&ved=0CCcQ6AEwAw#v=onepage&q=&f=false)》一书。遗憾的是我没有读过它，但它似乎涉及将 6 sigma 和精益制造的一些*适用*概念应用于生产软件（如消除浪费、减少缺陷、持续改进）。 [这是](http://www.projectperfect.com.au/info_lean_development.php)描述精益软件开发的简短白皮书。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-04-04T16:41:43.793

我已经将 6 Sigma 用于特定的性能测试项目，这些项目以特定的可衡量问题陈述开始，并以再次可衡量的反措施结束。DMAIC 适合于性能调整，因果分析、实验设计等工具和技术也是如此。

# java - 使用 org.eclipse.xsd 和 Maven2 分析 XML 模式

> ID：533573
> 
> 赞同：2
> 
> 时间：2009-02-10T18:37:01.590
> 
> 标签：java, xsd, eclipse-emf

我正在尝试从 2002 年开始实现[本文](http://help.eclipse.org/help32/index.jsp?topic=/org.eclipse.xsd.doc/references/articles/dwtip1-scpw/index.html)的示例代码（我知道..），但无法加载架构。

```
import org.eclipse.emf.common.util.URI;
import org.eclipse.emf.ecore.resource.Resource;
import org.eclipse.emf.ecore.resource.ResourceSet;
import org.eclipse.emf.ecore.resource.impl.ResourceSetImpl;
import org.eclipse.xsd.util.XSDResourceImpl;

    ResourceSet resourceSet = new ResourceSetImpl();
    // I replaced the deprecated createDeviceURI with createURI as recommended in JavaDoc
    XSDResourceImpl xsdSchemaResource = 
        (XSDResourceImpl)resourceSet.getResource(URI.createURI("my.xsd"), true); 
```

我正在使用以下 Maven2 依赖项：

```
<dependency>
    <groupId>org.eclipse.xsd</groupId>
    <artifactId>xsd</artifactId>
    <version>2.1.1</version>
</dependency>
<dependency>
    <groupId>org.eclipse.emf</groupId>
    <artifactId>ecore</artifactId>
    <version>2.1.0</version>
</dependency>
<dependency>
    <groupId>org.eclipse.emf</groupId>
    <artifactId>common</artifactId>
    <version>2.1.0</version>
</dependency> 
```

代码编译得很好，但在执行时会产生 RuntimeException：

```
java.lang.RuntimeException: 
    Cannot create a resource for 'my.xsd'; a registered resource factory is needed
    at org.eclipse.emf.ecore.resource.impl.ResourceSetImpl.getResource(ResourceSetImpl.java:346) 
```

我在 org.eclipse.emf.ecore.xmi 中找到了一些资源工厂实现，但是 AFAIK 在公共 Maven 存储库中只有一个 xmi[快照](http://repo1.maven.org/maven2/org/eclipse/emf/ecore/xmi/2.3.0-v200706262000/xmi-2.3.0-v200706262000.pom)，它依赖于 org.eclipse.core.runtime .. 这*不是*我想要的.

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T20:43:57.820

在创建 ResourceSetImpl 之前尝试添加此代码：

```
import org.eclipse.xsd.util.XSDResourceFactoryImpl;

Resource.Factory.Registry reg = Resource.Factory.Registry.INSTANCE;
java.util.Map m = reg.getExtensionToFactoryMap();
m.put("xsd", new XSDResourceFactoryImpl()); 
```

这应该创建您需要完成您正在尝试做的事情的注册表和工厂。

# iphone - 如何取消一系列 UITouch 事件？

> ID：533574
> 
> 赞同：22
> 
> 时间：2009-02-10T18:37:13.040
> 
> 标签：iphone, ios, uitouch, touchesmoved, uiresponder

我有一个`UIImage`响应触摸事件的视图。`touchesMoved:`如果触摸超出某些范围，我想取消触摸序列，即进一步调用。我怎样才能做到这一点？

我知道`touchesMoved:`我可以检查触摸对象的坐标并忽略它，但我不知道如何完全取消序列。我没有看到[Apple Developer `UIResponder`Reference](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIResponder_Class/Reference/Reference.html)中记录的任何可以调用来取消触摸序列的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T19:51:13.860

此解决方案可能有点笨拙，但您可以实施并手动调用

```
- (void) touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event; 
```

我将此解决方案松散地基于我对 Apple [iPhone 示例代码](http://developer.apple.com/iphone/samples/index.action)站点上的 MoveMe 示例应用程序所做的一些调整，在该站点我将`touchesMoved`方法修改为如下所示：

```
- (void) touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
     UITouch *touch = [touches anyObject];
     if ([touch view] == placardView)
         CGPoint location = [touch locationInView:self];
         placardView.center = location;
         // I added the following line:
         [self touchesCancelled:touches withEvent:event];
         return;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-11-28T03:30:21.673

尝试将 UIImageView 的 userInteractionEnabled 属性临时设置为 NO

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-05-13T00:50:16.403

您需要调用`[super touchesMoved:withEvent:]`以让超级视图从事件中清除，但更重要的是，您*不需要*调用`[super touchesCancelled:withEvent:]`.

这是我在单元格上使用的内容，以防止在检测到滑动时将其选中：

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    if (!showingEdit) {
        if (IS_FAR_ENOUGH_TO_BE_A_SWIPE) {
            RESPOND_TO_SWIPE
            showingEdit = YES;
            [super touchesCancelled:touches withEvent:event];
        } else {
            [super touchesMoved:touches withEvent:event];
        }
    }
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    if (!showingEdit) {
        [super touchesEnded:touches withEvent:event];
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-04-05T09:30:59.410

我最近遇到了同样的问题，并找到了解决它的标准方法。您可以使用 [[UIApplication sharedApplication] beginIgnoringInteractionEvents] 停止向整个应用程序传递 touchesMoved 事件。当您需要再次接收触摸时，请确保使用 [[UIApplication sharedApplication] endIgnoringInteractionEvents] 启用它们。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-11-21T04:23:02.823

我认为这是不可能的，因为我没有看到它记录在案，而且这些解决方案都不起作用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-08-21T10:31:45.047

此代码将为您提供帮助。我在方法中禁用触摸事件，并在方法`touchesMoved:`中启用触摸事件`touchesCancelled:`

```
-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
     UITouch *touch = [touches anyObject];
     .......
     .......
     Your code
     .......
     .......

     //Condition when you want to disable touch event

     [[UIApplication sharedApplication] beginIgnoringInteractionEvents];

     .......
     .......
     Your code
     .......
     .......
 }

- (void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event
{
    [[UIApplication sharedApplication] endIgnoringInteractionEvents];
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-24T20:56:57.200

“蛮力”解决方案取决于它是否适合您的需求：删除并重新初始化接收触摸或响应它们的子视图（当然要注意框架和内容）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-08-03T10:44:34.547

我通过从其超级视图中删除视图并将其直接添加回来来实现这一点。

```
[view retain];
UIView *sv = view.superview;
[view removeFromSuperview];
[sv addSubview:view];
[view release]; 
```

这会破坏视图的响应者链，因此视图上不会收到任何剩余的触摸。下一次触摸仍将正常接收。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-11-25T18:44:24.393

在 iOS5 上，UITouch 中似乎有一个私有方法

```
-(void)setSentTouchesEnded:(BOOL)ended; 
```

根据苹果的实现，它可能会停止发送事件

另一种方法是使用关联对象

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    if ([(NSNumber *)objc_getAssociatedObject(touch, &outKey) boolValue])
        return;
    if (sometouchisoutsideofview) {
        objc_setAssociatedObject(touch, &outKey, [NSNumber numberWithBool:YES], OBJC_ASSOCIATION_RETAIN);
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-13T14:41:32.470

我只是想解决这样的问题，发现她列出的所有解决方案都不适合我。我能做到的最好的办法是暂时忽略触摸，但是当触摸重新进入视图时它们又恢复了。

终于解决了。

1.  设置一个名为“禁用”的布尔标志
2.  在 touchMoved 中，首先检查触摸是否在所需的视图内。如果不是，请将 disabled 标志设置为 YES。
3.  仍然在touchedMoved中，在执行你的动作之前检查标志。所以，在这一点上，如果他们在视野之外，什么都不会发生。
4.  在 touchesEnded 中，将 disabled 标志设置为 NO。因此，触摸序列有效地停止，直到用户抬起手指。

我想这对你有用，除非你有具体的理由需要取消触摸序列。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2013-04-17T19:43:37.233

您可以为 UITouch 创建类别。你可以申报

```
@property (nonatomic,strong,readwrite) UIView *view; 
```

并且当你将 touch.view 更改为 nil 时，例如，你可以模拟调度触摸事件的结束

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2011-11-24T05:44:12.857

您可以检查触摸点位置是否在**CGRect**中（即点在您的图像视图的 Rectangle 中）。如果它们不在该 Rect 中，则触摸将被取消。

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
 {
UITouch *touch = [touches anyObject];
CGPoint touchLocation = [touch locationInView:self.view];

    if (CGRectContainsPoint(myImageView, touchLocation))
    {
       lastPoint = [touch locationInView: myImageView];
    }

    NSLog(@"Last :%.2f - %.2f",lastPoint.x, lastPoint.y);   
  }

 - (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event 
 {
  CGPoint currentPoint;
  UITouch *touch = [touches anyObject];
  CGPoint touchLocation = [touch locationInView:self.view];

     if (CGRectContainsPoint(myImageView.frame, touchLocation))
     {
       currentPoint = [touch locationInView: myImageView];
     }
 } 
```

# oop - 使用反射是否被认为是 unOOPish？

> ID：533584
> 
> 赞同：3
> 
> 时间：2009-02-10T18:39:03.567
> 
> 标签：oop, reflection

使用反射有什么风险？它以任何方式违反 OOP 吗？

我开始在 C# 项目中轻轻地使用它，现在我发现它在许多场景中都很实用。

谢谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-10T18:44:05.520

OOP 是一种技术和结构，而不是一种宗教。

你不会因为没有在你的项目中使用它而犯罪。如果你知道更好的方法，那就去吧。明智地使用反射可以为您节省很多复杂性。

只要确保它干净且可读，这样你的队友就不会把你钉在十字架上。反思是强大的，但强大的力量伴随着巨大的责任，等等。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-10T18:42:56.083

回答标题中的问题：不，不是先验的。例如，在实现工厂以创建不同（但相关）类型的对象时，反射可能非常方便。

但是，这些都是实现细节，它们通常应该隐藏在通用接口后面。反射也往往很慢，因此不鼓励过度使用。基本上，在没有其他（好的）解决方案时使用它，别无他处。

一般而言，OOP 并不真正与反射竞争。但是，当 OOP 足够时，不要尝试使用反射来实现动态调度或侦听器/回调。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-10T19:20:05.620

反射可以打破封装并在一个类和另一个类的内部实现之间产生耦合。使用不当会导致糟糕的 OO 设计，但这与不面向对象不同。在某些方面，它还可以用于实现传统 OO 代码难以解决的问题，例如 AOP（面向方面​​编程）。纯粹主义者可能会将此视为非 OOP，尽管我认为它是一种超集关系。

我发现反射很方便的一些地方：

*   单元测试，访问内部状态以设置或验证数据
*   属性，访问属性值和从属性访问对象属性
*   属性验证 - 为各种属性类型编写通用验证器
*   消费/转换匿名类型

Except for unit testing, typically I only reflect on public properties/methods so as not to break encapsulation and create coupling to internal implementation.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T18:57:36.393

像 Smalltalk 这样的普通 OO 语言有反射。使用它的人认为没有它的语言实际上无法使用。能够在运行时对程序进行推理对于大型系统来说是必不可少的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T19:45:11.347

It depends on what you're doing with reflection... I've used it a lot to enumerate public APIs, and in Java (through the introspection libraries) to do useful things with JavaBeans. Used thoughtfully it's very useful.

I think that issues arise not necessarily when you start using reflection, but when you use it to break encapsulation - peering inside objects to observe and modify otherwise hidden internal state. Unless you're careful tight coupling and fragility can quickly spread through your classes once encapsulation is broken.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T20:03:47.420

All OO programming languages support reflection to a lesser or greater extent. Some encourage its use ( e.g. Smalltalk, at one end of the spectrum) and some discourage it ( e.g. C++, at the other). The relative frequency of use of those two languages to implement the software you use every day may tell you something about the desirability of making heavy use of reflection.

Please note this is not an attempt to start a language war - I am actually something of a Smalltalk fan & intend to do some [Squeaking](http://www.squeak.org/) later on this evening.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T20:08:41.870

I'm pro-reflection any time that interfaces just aren't cutting it for you, maybe because of an unforeseen change or because things are just too complicated to specify that rigidly. Keep in mind that duck typing in languages like Python is implemented by what amounts to reflection. You can a method by name only, and it either works or throws. I view reflection as a backdoor to duck typing in a statically typed language. IMHO, unless you believe that duck typing is fundamentally wrong and would never use it, there's nothing wrong with reflection provided the code in question isn't performance-critical.

# cocoa-touch - 有没有办法在代码仍在运行时释放对象时避免错误？

> ID：533590
> 
> 赞同：1
> 
> 时间：2009-02-10T18:40:01.880
> 
> 标签：cocoa-touch, memory-management

我有一个 UIView 子类，它在`-drawRect:`被调用时会自行绘制。它只需要一点时间，但在极端情况下，例如内存不足和在转到另一个视图控制器时删除实例，在对象被释放之前绘制函数不会完成。

我应该如何处理这个问题？解除分配会导致对 [self ...] 的任何调用抛出 EXC_BAD_ACCESS，绘图函数会执行此操作来确定如何绘制自身。

**笔记：**

我主要使用框架来处理内存管理。问题在于`-drawRect:`来自 UIView 使用的 CATiledLayer 的异步调用，这些调用在 UIView 发布之前进入。但是，由于它是异步的，`-didReceiveMemoryWarning`因此在绘图时运行，导致视图在绘图中间被释放。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T19:28:49.890

首先阅读 Apple 的内存管理规则：

[Cocoa 内存管理规则](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/Tasks/MemoryManagementRules.html)

底线：“处理”问题的方法是确保您管理对象及其内存使用正确。由于释放而导致的崩溃不是要被困住的东西，而是您的应用程序中需要修复的完全错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-26T21:14:25.987

我认为这里的答案是：使用`@synchronized`

# c# - 当我将具有枚举属性的类的对象序列化为 JSON 时，如果值为 null，则生成的 json 是 borked

> ID：533604
> 
> 赞同：7
> 
> 时间：2009-02-10T18:43:17.783
> 
> 标签：c#, json, enums

当我将具有枚举属性的类的对象序列化为 JSON 时，如果值为 null，则生成的 json 字符串具有如下名称值对：

```
"controlType":"-2147483648" 
```

当我将字符串反序列化为强类型对象时，这会导致问题。

处理枚举和空值的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T21:10:14.293

当您有一个非空值时，下面的代码会为您提供 json = ' **{"Name":"Test","Id":1,"MyEnum":3} '。**

```
public enum SerializeObjTestClassEnum {
  one = 1, two, three, four
}

[Serializable]
public class SerializeObjTestClass {
  public string Name { get; set; }
  public int Id { get; set; }
  public SerializeObjTestClassEnum MyEnum { get; set; }
}

public void SerializeObject_Test_Basic_Object() {
  var obj = new SerializeObjTestClass {
    Id = 1, Name = "Test", MyEnum = SerializeObjTestClassEnum.three
  };
  var json = (new JavaScriptSerializer()).Serialize(obj);
} 
```

* * *

这段代码给你 json = ' **{"Name":"Test","Id":1,"MyEnum":0}** '

`var obj = new SerializeObjTestClass { Id = 1, Name = "Test" };`

请注意，枚举在未设置时如何序列化为 0，而枚举本身从 1 开始。因此，您的代码可以通过这种方式知道枚举使用了 NULL 值。

如果您希望 json 看起来像 ' **{"Name":"Test","Id":1,"MyEnum":null}** '，那么您将需要使用类包装器来伪造它枚举。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T19:05:53.207

考虑：

```
echo json_encode(array("test"=>null)); 
```

这会产生：

```
{"test":null} 
```

处理枚举的最佳方式是使用键、值数组或标准类。只需将您的姓名绑定到一组唯一的整数。然后，您也可以绑定另一个方向：

{“A”：1，“B”：2，“C”：3，1：“A”，2：“B”，3：“C”}

这至少给了你双向性。

# html - CSS：三列布局问题

> ID：533607
> 
> 赞同：7
> 
> 时间：2009-02-10T18:43:55.660
> 
> 标签：html, css

我该如何修改这个：

```
<div style="border: solid 1px red; text-align: center">
    <div style="background-color: yellow; float: left">left</div>
    middle
    <div style="float:right; background-color: yellow">right</div>
</div> 
```

那么“右”与“左”垂直对齐？

这是我糟糕的 css 呈现的样子：

```
left                 middle
                                            right 
```

谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-10T18:59:52.423

如果您使用'float：right'，请将其作为第一行：

```
<div style="border: solid 1px red; text-align: center">
    <div style="float:right; background-color: yellow">right</div>
    <div style="background-color: yellow; float: left">left</div>
    middle
</div> 
```

否则它总是落入下一个文本行。

> 但为什么！！！！！

(1) 因为一旦你开始将静态文本放在一行上，你就有一个不确定的宽度来适应浮动元素。假设你写道：

```
abc abc abc <div style="float: left">xyz xyz</div> abc abc abc 
```

现在想象一下，您开始向下调整该窗口的大小，以使“abc abc abc”恰好适合第一行。现在你遇到一个浮点数，并尝试将它包含在你所在的行上。但它不适合：要适合它，您必须在行上有“abc xyz xyz”，将剩余的“abc”回流到下一行。但！现在您已经将浮动的插入点向下移动了一行，因此浮动也必须向下移动一行。但！现在第一行没有正确换行，因为有三个“abc”的空间，但是该行已经过早结束，以便为实际出现在页面下方的浮动让路......

CSS 标准通过在等待下一行之前在带有内联文本的行上设置浮点数来解决这个逻辑僵局。

(2) 因为这就是网景在`<img float="right">`很多很多年前所做的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T18:54:36.260

我得到了你需要的*：

```
<table style='border: 1px solid red; width: 100%; border-collapse: collapse;'>
  <tr>
    <td style='background-color: yellow; width: 25%;'>left</td>
    <td style='text-align: center;'>middle</td>
    <td style='background-color: yellow; width: 25%; text-align: right;'>right</td>
  </tr>
</table> 
```

晚点再谢我！

`*`免责声明：我只有 95% 是认真的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T19:14:38.393

这无需重新安排内容的顺序即可工作

```
<style type="text/css">
    .column
    {
    float: left;
    width:33.3%;
    }

    #container
    {
    text-align: center; 
    width:100%;
    }

    .clearfix 
    {
    display: inline-block; 
    }
</style>
<div id="container" class="clearfix">
      <div class="column">left</div>
      <div class="column">middle</div>
      <div class="column">right</div>
</div> 
```

你也可以去掉 33%，让它们代表你的设计，或者甚至在列上做一个固定的宽度。因此，请使用 ID 而不是类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T18:50:12.120

制作`middle`一个`div`，将其浮动到左侧并指定所有三个容器的宽度。另外，你可能会做环境`div` `overflow: auto`，否则它会自行坍塌。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T19:41:32.183

[您正在谈论这篇A List Apart 文章](http://www.alistapart.com/articles/holygrail)中的“圣杯”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T18:46:04.970

“中间”需要在自己的 div 中，否则会影响您的显示

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T18:48:44.993

更新：

```
<div style="border: solid 1px red; text-align: center">
   <div style="background-color: yellow; float: left">left</div>
   <div style="float:right" background-color: yellow">right</div>
   <div style="float:none">middle</div>
</div> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-10T18:51:14.537

尝试这样的事情：

```
<div style="border: solid 1px red; text-align: centerl width:100px">
          <div style="background-color: yellow; float: left; width:30px">left</div>
          <div style="background-color: yellow; float: left; width:30px">middle</div>
          <div style="background-color: yellow; float: left; width:30px">right</div>
</div> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-10T19:13:11.223

为了完成你想要做的事情，你应该把右栏放在中间栏之前。

```
<div style="border: solid 1px red; text-align: center">
      <div style="background-color: yellow; float: left">left</div>
      <div style="float:right; background-color: yellow">right</div>
      middle
</div> 
```

因为右列相对于其上下文定位，即中间内容下方的一行。

# flash - 检测损坏的闪存文件

> ID：533614
> 
> 赞同：1
> 
> 时间：2009-02-10T18:45:10.323
> 
> 标签：flash, preloader

我有一次不小心将我的 Flash 程序的一部分上传到了我的网站（即，它被截断了），最令我惊讶的是，Flash 对象被成功加载到网页中，没有出现错误，也没有给出任何警告。（这是播放器的发布版本，调试版本的行为可能有所不同，我不知道。）当然，它不能正常工作，但仍然可以正确显示预加载器屏幕，并出现下载和初始化正常完成。

我的问题是：有没有办法检测（在 actionscript/flash 或嵌入网页中）何时加载了这种损坏的 flash 对象？发生这种情况时，我可以使用预加载器发出警告吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T18:58:04.300

有很多方法可以从 SWF 文件中提取标题信息（包括文件大小）。由于此信息是在发布时写入的，因此如果文件在上传后被截断，它不会改变。因此，例如，您可以提取该信息并检查文件大小（根据 SWF 标头）是否 == 加载的字节数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T18:59:24.110

我不知道任何特定于 flash 的方法，但是编写一个脚本来比较原始文件的 md5 哈希值与您在线获得的版本肯定不难。它甚至可以很容易地设置为在文件更改时自动运行。

# c# - 过滤列表

> ID：533617
> 
> 赞同：0
> 
> 时间：2009-02-10T18:46:25.623
> 
> 标签：c#, .net, generics, filtering

在某些情况下，我一直在使用 DataTable，用 DataView 过滤它并在 DataGrid 中显示 DataView。我最近开始改用我自己的课程。例如：

```
[Serializable]
[System.Xml.Serialization.XmlRoot("Items", Namespace = "http://mycomp.com/test")]
public class Items: List<Item>
{

}

[Serializable]
[System.Xml.Serialization.XmlRoot("Item", Namespace = "http://mycomp.com/test")]
public class Item
{
  //public properties here
} 
```

然后我将我的 Items 类显示在一个运行良好的 DataGrid 中。有什么方法可以将过滤器应用于我的列表吗？DataView 仅适用于数据表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T18:59:19.460

您可以使用 FindAll() 方法：

```
List<Items> allItems = /* initialize list */;

List<Items> filteredList =
    allItems.FindAll(item => item.Name.StartsWith("A")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T18:48:15.090

如果我正确理解您的问题，您可以使用 LINQ to Objects 并将结果列表绑定到网格视图...

# javascript - 搜索框：使用 XML 自动提示

> ID：533626
> 
> 赞同：0
> 
> 时间：2009-02-10T18:49:15.833
> 
> 标签：javascript, xml, search

我想制作一个具有自动建议并在 XML 文件中搜索特定标签的搜索框。我怎么能意识到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T18:53:18.727

这取决于您所说的 XML 文件是什么意思。XML 文件在某些​​服务器上可用吗？

看看[jQuery](http://jquery.com/)和它的[自动完成插件](http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/)。它为 HTML/XHTML 页面提供自动建议功能。

# python - 什么是 mixin，它们为什么有用？

> ID：533631
> 
> 赞同：1193
> 
> 时间：2009-02-10T18:50:42.337
> 
> 标签：python, oop, multiple-inheritance, mixins

在“ [Programming Python](https://rads.stackoverflow.com/amzn/click/com/0596009259) ”中，Mark Lutz 提到了“mixins”。我来自 C/C++/C# 背景，以前没有听说过这个词。什么是混音？

[在这个例子](http://books.google.com/books?id=5zYVUIl7F0QC&pg=RA1-PA584&lpg=RA1-PA584&dq=programming+python+guimixin&source=bl&ots=HU833giXzH&sig=jwLpxSp4m_VbOYQ897UDkGNx_2U&hl=en&ei=x8iRSaTTF5iq-ganpbGPCw&sa=X&oi=book_result&resnum=3&ct=result)的两行之间阅读（我已经链接到它，因为它很长），我假设这是使用多重继承来扩展一个类而不是“适当的”子类化的情况。这是正确的吗？

为什么我要这样做而不是将新功能放入子类中？就此而言，为什么混合/多重继承方法比使用组合更好？

混合继承与多重继承有什么区别？这只是语义问题吗？

* * *

## 回答 #1

> 赞同：867
> 
> 时间：2009-02-13T21:15:17.283

mixin 是一种特殊的多重继承。使用mixin主要有两种情况：

1.  你想为一个类提供很多可选特性。
2.  你想在很多不同的类中使用一个特定的特性。

对于第一个示例，请考虑[werkzeug 的请求和响应系统](http://werkzeug.pocoo.org/docs/wrappers/)。我可以通过说来制作一个普通的旧请求对象：

```
from werkzeug import BaseRequest

class Request(BaseRequest):
    pass 
```

如果我想添加接受标头支持，我会这样做

```
from werkzeug import BaseRequest, AcceptMixin

class Request(AcceptMixin, BaseRequest):
    pass 
```

如果我想创建一个支持接受标头、etags、身份验证和用户代理支持的请求对象，我可以这样做：

```
from werkzeug import BaseRequest, AcceptMixin, ETagRequestMixin, UserAgentMixin, AuthenticationMixin

class Request(AcceptMixin, ETagRequestMixin, UserAgentMixin, AuthenticationMixin, BaseRequest):
    pass 
```

区别是微妙的，但在上面的例子中，mixin 类并不是独立存在的。在更传统的多重继承中，`AuthenticationMixin`（例如）可能更像`Authenticator`. 也就是说，该类可能被设计为独立存在。

* * *

## 回答 #2

> 赞同：282
> 
> 时间：2009-02-10T19:00:51.890

首先，您应该注意 mixin 仅存在于多继承语言中。你不能在 Java 或 C# 中做一个 mixin。

基本上，mixin 是一种独立的基本类型，它为子类提供有限的功能和多态共振。如果您正在考虑使用 C#，请考虑一个您不必实际实现的接口，因为它已经实现了；您只需从它继承并受益于它的功能。

Mixin 的范围通常很窄，并不打算扩展。

[编辑——至于为什么：]

既然你问了，我想我应该说明原因。最大的好处是您不必一遍又一遍地自己做。在 C# 中，mixin 可能受益的最大地方可能是[Disposal 模式](http://blog.jawaji.com/2008/08/disposal-pattern-c.html)。每当您实现 IDisposable 时，您几乎总是希望遵循相同的模式，但您最终会编写和重写相同的基本代码，但会有细微的变化。如果有一个可扩展的 Disposal mixin，你可以节省很多额外的输入。

[编辑2——回答你的其他问题]

> 混合继承与多重继承有什么区别？这只是语义问题吗？

是的。mixin 和标准多重继承之间的区别只是语义问题。具有多重继承的类可能会利用 mixin 作为多重继承的一部分。

mixin 的重点是创建一个可以通过继承“混入”任何其他类型的类型，而不影响继承的类型，同时仍然为该类型提供一些有益的功能。

同样，考虑一个已经实现的接口。

我个人不使用 mixins，因为我主要使用一种不支持它们的语言进行开发，所以我很难想出一个像样的例子来提供“啊哈！” 给你的时刻。但我会再试一次。我将使用一个人为的示例——大多数语言已经以某种方式提供了该功能——但希望这将解释应该如何创建和使用 mixin。开始：

假设您有一个类型，您希望能够序列化到 XML 和从 XML 序列化。您希望该类型提供一个“ToXML”方法，该方法返回一个包含具有该类型数据值的 XML 片段的字符串，以及一个允许该类型从字符串中的 XML 片段重建其数据值的“FromXML”。同样，这是一个人为的示例，因此您可能使用文件流，或者您语言的运行时库中的 XML Writer 类……随便。关键是您希望将对象序列化为 XML 并从 XML 中获取新对象。

此示例中的另一个重点是您希望以通用方式执行此操作。您不想为要序列化的每种类型都实现“ToXML”和“FromXML”方法，您需要一些通用的方法来确保您的类型能够做到这一点并且它可以正常工作。你想要代码重用。

如果您的语言支持它，您可以创建 XmlSerializable mixin 来为您完成工作。这种类型将实现 ToXML 和 FromXML 方法。它将使用一些对示例不重要的机制，能够从混合的任何类型中收集所有必要的数据，以构建由 ToXML 返回的 XML 片段，并且当 FromXML 是时，它同样能够恢复该数据叫。

而且..就是这样。要使用它，您需要将任何需要序列化为 XML 的类型从 XmlSerializable 继承。每当您需要序列化或反序列化该类型时，您只需调用 ToXML 或 FromXML。事实上，由于 XmlSerializable 是一个成熟的类型和多态性，您可以想象构建一个对原始类型一无所知的文档序列化程序，只接受一个 XmlSerializable 类型的数组。

现在想象一下将此场景用于其他事情，例如创建一个 mixin 以确保将其混入的每个类都记录每个方法调用，或者创建一个为混入它的类型提供事务性的 mixin。这个列表可以继续下去。

如果您只是将 mixin 视为一种小型基本类型，旨在为类型添加少量功能而不会影响该类型，那么您就是黄金。

希望。:)

* * *

## 回答 #3

> 赞同：231
> 
> 时间：2013-11-16T19:36:03.643

该答案旨在**通过以下示例**解释 mixins ：

*   **自包含**：简短，无需了解任何库即可理解示例。

*   **在 Python 中**，而不是在其他语言中。

    可以理解，有来自其他语言（例如 Ruby）的示例，因为该术语在这些语言中更为常见，但这是一个*Python*线程。

它还应考虑有争议的问题：

> 是否需要多重继承来表征mixin？

**定义**

我还没有看到来自“权威”来源的引文清楚地说明什么是 Python 中的 mixin。

我已经看到了 2 种可能的 mixin 定义（如果它们被认为与其他类似概念不同，例如抽象基类），人们并不完全同意哪个是正确的。

不同语言之间的共识可能会有所不同。

**定义1：没有多重继承**

mixin 是一个类，该类的某些方法使用了该类中未定义的方法。

因此，该类不打算实例化，而是用作基类。否则，实例将具有无法在不引发异常的情况下调用的方法。

一些来源添加的一个约束是该类可能不包含数据，只有方法，但我不明白为什么这是必要的。然而在实践中，许多有用的 mixin 没有任何数据，并且没有数据的基类更易于使用。

一个经典的例子是所有比较运算符的实现仅来自`<=`and `==`：

```
class ComparableMixin(object):
    """This class has methods which use `<=` and `==`,
    but this class does NOT implement those methods."""
    def __ne__(self, other):
        return not (self == other)
    def __lt__(self, other):
        return self <= other and (self != other)
    def __gt__(self, other):
        return not self <= other
    def __ge__(self, other):
        return self == other or self > other

class Integer(ComparableMixin):
    def __init__(self, i):
        self.i = i
    def __le__(self, other):
        return self.i <= other.i
    def __eq__(self, other):
        return self.i == other.i

assert Integer(0) <  Integer(1)
assert Integer(0) != Integer(1)
assert Integer(1) >  Integer(0)
assert Integer(1) >= Integer(1)

# It is possible to instantiate a mixin:
o = ComparableMixin()
# but one of its methods raise an exception:
#o != o 
```

这个特殊的例子可以通过`functools.total_ordering()`装饰器实现，但这里的游戏是重新发明轮子：

```
import functools

@functools.total_ordering
class Integer(object):
    def __init__(self, i):
        self.i = i
    def __le__(self, other):
        return self.i <= other.i
    def __eq__(self, other):
        return self.i == other.i

assert Integer(0) < Integer(1)
assert Integer(0) != Integer(1)
assert Integer(1) > Integer(0)
assert Integer(1) >= Integer(1) 
```

**定义2：多重继承**

mixin 是一种设计模式，其中基类的某些方法使用它未定义的方法，并且该方法旨在由*另一个基类*实现，而不是由定义 1 中的派生类实现。

术语*mixin 类*是指打算在该设计模式中使用的基类（TODO 那些使用该方法的，还是那些实现它的？）

判断一个给定的类是否是mixin并不容易：该方法可能只是在派生类上实现，在这种情况下我们回到定义1。你必须考虑作者的意图。

这种模式很有趣，因为可以将功能与不同的基类选择重新组合：

```
class HasMethod1(object):
    def method(self):
        return 1

class HasMethod2(object):
    def method(self):
        return 2

class UsesMethod10(object):
    def usesMethod(self):
        return self.method() + 10

class UsesMethod20(object):
    def usesMethod(self):
        return self.method() + 20

class C1_10(HasMethod1, UsesMethod10): pass
class C1_20(HasMethod1, UsesMethod20): pass
class C2_10(HasMethod2, UsesMethod10): pass
class C2_20(HasMethod2, UsesMethod20): pass

assert C1_10().usesMethod() == 11
assert C1_20().usesMethod() == 21
assert C2_10().usesMethod() == 12
assert C2_20().usesMethod() == 22

# Nothing prevents implementing the method
# on the base class like in Definition 1:

class C3_10(UsesMethod10):
    def method(self):
        return 3

assert C3_10().usesMethod() == 13 
```

**权威的 Python 事件**

在[collections.abc 的官方文档中，](http://docs.python.org/dev/library/collections.abc.html)该文档明确使用了术语*Mixin Methods*。

它指出，如果一个类：

*   工具`__next__`
*   从单个类继承`Iterator`

然后该类免费获得一个`__iter__` *mixin方法*。

因此，至少在文档的这一点上，**mixin 不需要多重继承**，并且与定义 1 一致。

当然，文档在不同点上可能相互矛盾，其他重要的 Python 库可能在其文档中使用其他定义。

该页面还使用了术语`Set mixin`，它清楚地表明类喜欢`Set`并且`Iterator`可以称为 Mixin 类。

**在其他语言中**

*   Ruby：显然不需要 mixin 的多重继承，正如主要参考书籍如[Programming Ruby](https://rads.stackoverflow.com/amzn/click/com/1937785491)和 The Ruby programming Language中提到的

*   C++：`virtual`设置的方法`=0`是纯虚方法。

    定义 1 与抽象类（具有纯虚方法的类）的定义一致。该类无法实例化。

    定义 2 可以使用虚拟继承：[来自两个派生类的多重继承](https://stackoverflow.com/questions/254673/multiple-inheritance-from-two-derived-classes)

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2013-07-05T14:26:37.850

我认为它们是使用多重继承的一种规范方式——因为最终，mixin 只是另一个 python 类，它（可能）遵循关于称为 mixin 的类的约定。

我对管理你称之为 Mixin 的东西的约定的理解是，一个 Mixin：

*   添加方法但不添加实例变量（类常量可以）
*   仅继承自`object`（在 Python 中）

这样，它限制了多重继承的潜在复杂性，并通过限制您必须查看的位置（与完全多重继承相比）来相当容易地跟踪程序的流程。它们类似于[ruby​​ 模块](http://ruby-for-beginners.rubymonstas.org/advanced/modules.html)。

如果我想添加实例变量（具有比单继承所允许的更大的灵活性），那么我倾向于进行组合。

话虽如此，我已经看到名为 XYZMixin 的类确实具有实例变量。

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2016-03-25T15:05:09.343

> # 混合继承与多重继承有什么区别？这只是语义问题吗？

mixin 是一种有限的多重继承形式。在某些语言中，向类添加 mixin 的机制（在语法方面）与继承的机制略有不同。

特别是在 Python 的上下文中，mixin 是一个父类，它为子类提供功能，但并不打算实例化它本身。

可能会导致您说“这只是多重继承，而不是真正的混合”的原因是，如果可能被混淆为混合的类实际上可以被实例化和使用 - 所以它确实是一种语义上的、非常真实的差异。

## 多重继承的例子

此示例[来自文档](https://docs.python.org/2/library/collections.html#ordereddict-examples-and-recipes)，是一个 OrderedCounter：

> ```
> class OrderedCounter(Counter, OrderedDict):
>      'Counter that remembers the order elements are first encountered'
> 
>      def __repr__(self):
>          return '%s(%r)' % (self.__class__.__name__, OrderedDict(self))
> 
>      def __reduce__(self):
>          return self.__class__, (OrderedDict(self),) 
> ```

它是模块的子类和`Counter`模块。`OrderedDict``collections`

两者都旨在被实例化并单独使用`Counter`。`OrderedDict`但是，通过对它们进行子类化，我们可以有一个有序的计数器并重用每个对象中的代码。

这是一种重用代码的强大方法，但也可能存在问题。如果事实证明其中一个对象存在错误，那么不小心修复它可能会在子类中产生错误。

## Mixin 示例

Mixin 通常被推广为一种获得代码重用的方法，而不会出现协作多重继承（如 OrderedCounter）可能存在的潜在耦合问题。当您使用 mixin 时，您使用的功能与数据没有紧密耦合。

与上面的示例不同，mixin 并不打算单独使用。它提供了新的或不同的功能。

例如，标准库在 library 中有[几个](https://docs.python.org/3/library/socketserver.html?highlight=mixin#socketserver.ThreadingMixIn)[mixin`socketserver`](https://docs.python.org/3/library/socketserver.html?highlight=mixin#socketserver.ThreadingMixIn)。

> 可以使用这些混合类创建每种类型服务器的分叉和线程版本。例如，ThreadingUDPServer 的创建方式如下：
> 
> ```
> class ThreadingUDPServer(ThreadingMixIn, UDPServer):
>     pass 
> ```
> 
> 混合类首先出现，因为它覆盖了 UDPServer 中定义的方法。设置各种属性也会改变底层服务器机制的行为。

在这种情况下，mixin 方法会覆盖`UDPServer`对象定义中的方法以允许并发。

被覆盖的方法似乎是`process_request`，它还提供了另一种方法，`process_request_thread`. 这是来自[源代码](https://github.com/python/cpython/blob/3.6/Lib/socketserver.py#L625)：

> ```
> class ThreadingMixIn:
>         """Mix-in class to handle each request in a new thread."""
> 
>         # Decides how threads will act upon termination of the
>         # main process
>         daemon_threads = False
> 
>         def process_request_thread(self, request, client_address):
>             """Same as in BaseServer but as a thread.
>             In addition, exception handling is done here.
>             """
>             try:
>                 self.finish_request(request, client_address)
>             except Exception:
>                 self.handle_error(request, client_address)
>             finally:
>                 self.shutdown_request(request)
> 
>         def process_request(self, request, client_address):
>             """Start a new thread to process the request."""
>             t = threading.Thread(target = self.process_request_thread,
>                                  args = (request, client_address))
>             t.daemon = self.daemon_threads
>             t.start() 
> ```

## 一个人为的例子

这是一个主要用于演示目的的 mixin - 大多数对象的发展将超出此 repr 的用途：

```
class SimpleInitReprMixin(object):
    """mixin, don't instantiate - useful for classes instantiable
    by keyword arguments to their __init__ method.
    """
    __slots__ = () # allow subclasses to use __slots__ to prevent __dict__
    def __repr__(self):
        kwarg_strings = []
        d = getattr(self, '__dict__', None)
        if d is not None:
            for k, v in d.items():
                kwarg_strings.append('{k}={v}'.format(k=k, v=repr(v)))
        slots = getattr(self, '__slots__', None)
        if slots is not None:
            for k in slots:
                v = getattr(self, k, None)
                kwarg_strings.append('{k}={v}'.format(k=k, v=repr(v)))
        return '{name}({kwargs})'.format(
          name=type(self).__name__,
          kwargs=', '.join(kwarg_strings)
          ) 
```

用法是：

```
class Foo(SimpleInitReprMixin): # add other mixins and/or extend another class here
    __slots__ = 'foo',
    def __init__(self, foo=None):
        self.foo = foo
        super(Foo, self).__init__() 
```

和用法：

```
>>> f1 = Foo('bar')
>>> f2 = Foo()
>>> f1
Foo(foo='bar')
>>> f2
Foo(foo=None) 
```

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2012-06-13T05:06:32.217

Mixins 是编程中的一个概念，其中类提供了功能，但并不打算用于实例化。Mixins 的主要目的是提供独立的功能，最好是 mixins 本身不与其他 mixins 继承并避免状态。在 Ruby 等语言中，有一些直接的语言支持，但对于 Python，则没有。但是，您可以使用多类继承来执行 Python 中提供的功能。

我观看了这个视频[http://www.youtube.com/watch?v=v_uKI2NOLEM](http://www.youtube.com/watch?v=v_uKI2NOLEM)以了解 mixins 的基础知识。对于初学者来说，了解 mixin 的基础知识、它们的工作原理以及在实现它们时可能遇到的问题是非常有用的。

维基百科仍然是最好的：[http ://en.wikipedia.org/wiki/Mixin](http://en.wikipedia.org/wiki/Mixin)

* * *

## 回答 #7

> 赞同：26
> 
> 时间：2020-01-15T13:51:03.007

我认为之前的回答很好地定义了*MixIn*是什么。但是，为了更好地理解它们，从代码/实现的角度比较***MixIn***与***抽象类***和***接口可能会很有用：***

**1.抽象类**

*   *需要包含一个或多个抽象方法的*类**

**   *抽象类* **可以**包含状态（实例变量）和非抽象方法* 

 ***2.接口**

*   *接口***仅**包含抽象方法（没有非抽象方法和内部状态）

**3\. 混音**

*   *MixIns*（如接口）**不**包含内部状态（实例变量）
*   *MixIn*包含一个或多个非抽象方法（与接口不同，它们**可以**包含非抽象方法）

在例如 Python 中，这些只是约定，因为以上所有内容都定义为`class`es。然而，*抽象类、接口*和*MixIn*的共同特点是它们**不应该**单独存在，即不应该被实例化。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2014-12-26T05:54:36.920

我认为这里有一些很好的解释，但我想提供另一种观点。

在 Scala 中，您可以像这里描述的那样执行 mixins，但非常有趣的是，这些 mixin 实际上是“融合”在一起以创建一种新的类来继承。本质上，您不会从多个类/mixin 继承，而是生成一种新的类，其中包含要继承的 mixin 的所有属性。这是有道理的，因为 Scala 基于当前不支持多重继承的 JVM（从 Java 8 开始）。顺便说一下，这种 mixin 类类型是 Scala 中称为 Trait 的特殊类型。

在定义类的方式中暗示了这一点：类 NewClass 用 SecondMixin 和 ThirdMixin 扩展 FirstMixin ...

我不确定 CPython 解释器是否也这样做（mixin 类组合），但我不会感到惊讶。此外，来自 C++ 背景，我不会将 ABC 或“接口”称为与 mixin 等价的东西——这是一个相似的概念，但在使用和实现方面存在差异。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2009-02-10T19:21:19.550

我建议不要在新的 Python 代码中进行混入，如果你能找到任何其他方法（例如组合而不是继承，或者只是将猴子修补方法添加到你自己的类中），那就不多了努力。

在旧式类中，您可以使用混入作为从另一个类中获取一些方法的一种方式。但在新风格世界中，一切，甚至是混入，都继承自`object`. 这意味着任何使用多重继承自然会引入[MRO 问题](http://www.python.org/download/releases/2.2.3/descrintro/#mro)。

有一些方法可以让多继承 MRO 在 Python 中工作，最值得注意的是 super() 函数，但这意味着您必须使用 super() 来完成整个类层次结构，而且理解控制流要困难得多。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2009-02-10T21:27:41.493

也许几个例子会有所帮助。

如果您正在构建一个类并且希望它像字典一样工作，您可以定义所有`__ __`必要的各种方法。但这有点痛苦。`UserDict.DictMixin`作为替代方案，您可以只定义一些，并从（移至`collections.DictMixin`py3k 中）继承（除了任何其他继承之外）。这将具有自动定义所有其余字典 api 的效果。

第二个示例：GUI 工具包 wxPython 允许您制作具有多列的列表控件（例如，Windows 资源管理器中的文件显示）。默认情况下，这些列表是相当基本的。您可以添加其他功能，例如通过单击列标题、从 ListCtrl 继承并添加适当的 mixin 来按特定列对列表进行排序的能力。

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2009-02-18T08:00:23.457

这不是 Python 示例，但在[D 编程语言](http://www.digitalmars.com/d/1.0/template-mixin.html)中，该术语[`mixin`](http://www.digitalmars.com/d/1.0/template-mixin.html)用于指代使用方式大致相同的构造；在课堂上添加一堆东西。

在 D 中（顺便说一句，它不做 MI），这是通过将模板（认为语法感知和安全的宏，你将接近）插入到一个范围中来完成的。这允许将类、结构、函数、模块或其他任何内容中的单行代码扩展为任意数量的声明。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2016-12-06T06:30:11.630

OP 提到他/她从未听说过 C++ 中的 mixin，可能是因为它们在 C++ 中被称为 Curiously Recurring Template Pattern (CRTP)。此外，@Ciro Santilli 提到 mixin 是通过 C++ 中的抽象基类实现的。虽然可以使用抽象基类来实现 mixin，但这是一种矫枉过正的做法，因为可以在编译时使用模板来实现运行时的虚函数功能，而无需在运行时进行虚拟表查找的开销。

CRTP模式在[此处详细描述](https://en.wikipedia.org/wiki/Curiously_recurring_template_pattern)

我已经使用下面的模板类将@Ciro Santilli 的答案中的 python 示例转换为 C++：

```
 #include <iostream>
    #include <assert.h>

    template <class T>
    class ComparableMixin {
    public:
        bool operator !=(ComparableMixin &other) {
            return ~(*static_cast<T*>(this) == static_cast<T&>(other));
        }
        bool operator <(ComparableMixin &other) {
            return ((*(this) != other) && (*static_cast<T*>(this) <= static_cast<T&>(other)));
        }
        bool operator >(ComparableMixin &other) {
            return ~(*static_cast<T*>(this) <= static_cast<T&>(other));
        }
        bool operator >=(ComparableMixin &other) {
            return ((*static_cast<T*>(this) == static_cast<T&>(other)) || (*(this) > other));
        }
        protected:
            ComparableMixin() {}
    };

    class Integer: public ComparableMixin<Integer> {
    public:
     Integer(int i) {
         this->i = i;
     }
     int i;
     bool operator <=(Integer &other) {
         return (this->i <= other.i);
     }
     bool operator ==(Integer &other) {
         return (this->i == other.i);
     }
    };

int main() {

    Integer i(0) ;
    Integer j(1) ;
    //ComparableMixin<Integer> c; // this will cause compilation error because constructor is protected.
    assert (i < j );
    assert (i != j);
    assert (j >  i);
    assert (j >= i);

    return 0;
} 
```

编辑：在 ComparableMixin 中添加了受保护的构造函数，以便它只能被继承而不能被实例化。更新了示例以显示在创建 ComparableMixin 对象时受保护的构造函数将如何导致编译错误。

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2012-07-31T11:49:59.597

mixin 提供了一种在类中添加功能的方法，即您可以通过将模块包含在所需的类中来与模块中定义的方法进行交互。尽管 ruby​​ 不支持多重继承，但提供了 mixin 作为实现这一目标的替代方案。

这是一个示例，解释了如何使用 mixin 实现多重继承。

```
module A    # you create a module
    def a1  # lets have a method 'a1' in it
    end
    def a2  # Another method 'a2'
    end
end

module B    # let's say we have another module
    def b1  # A method 'b1'
    end
    def b2  #another method b2
    end
end

class Sample    # we create a class 'Sample'
    include A   # including module 'A' in the class 'Sample' (mixin)
    include B   # including module B as well

    def S1      #class 'Sample' contains a method 's1'
    end
end

samp = Sample.new    # creating an instance object 'samp'

# we can access methods from module A and B in our class(power of mixin)

samp.a1     # accessing method 'a1' from module A
samp.a2     # accessing method 'a2' from module A
samp.b1     # accessing method 'b1' from module B
samp.b2     # accessing method 'a2' from module B
samp.s1     # accessing method 's1' inside the class Sample 
```

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2013-03-12T21:22:43.180

我只是使用 python mixin 来实现 python milters 的单元测试。通常情况下，milter 会与 MTA 对话，从而使单元测试变得困难。测试 mixin 会覆盖与 MTA 对话的方法，并创建一个由测试用例驱动的模拟环境。

因此，您采用未经修改的 milter 应用程序，例如 spfmilter 和 mixin TestBase，如下所示：

```
class TestMilter(TestBase,spfmilter.spfMilter):
  def __init__(self):
    TestBase.__init__(self)
    spfmilter.config = spfmilter.Config()
    spfmilter.config.access_file = 'test/access.db'
    spfmilter.spfMilter.__init__(self) 
```

然后，在 milter 应用程序的测试用例中使用 TestMilter：

```
def testPass(self):
  milter = TestMilter()
  rc = milter.connect('mail.example.com',ip='192.0.2.1')
  self.assertEqual(rc,Milter.CONTINUE)
  rc = milter.feedMsg('test1',sender='good@example.com')
  self.assertEqual(rc,Milter.CONTINUE)
  milter.close() 
```

[http://pymilter.cvs.sourceforge.net/viewvc/pymilter/pymilter/Milter/test.py?revision=1.6&view=markup](http://pymilter.cvs.sourceforge.net/viewvc/pymilter/pymilter/Milter/test.py?revision=1.6&view=markup)

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2009-02-10T19:08:50.187

也许 ruby​​ 的一个例子可以帮助：

您可以包含 mixin`Comparable`并定义一个函数`"<=>(other)"`，mixin 提供所有这些功能：

```
<(other)
>(other)
==(other)
<=(other)
>=(other)
between?(other) 
```

它通过调用`<=>(other)`并返回正确的结果来做到这一点。

`"instance <=> other"`如果两个对象相等则返回 0，如果大于则小于 0，如果`instance`大于`other`则大于 0 `other`。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2011-03-23T10:16:56.723

我读到你有 ac# 背景。因此，一个好的起点可能是 .NET 的 mixin 实现。

您可能想查看[http://remix.codeplex.com/上的 codeplex 项目](http://remix.codeplex.com/)

观看 lang.net Symposium 链接以获得概览。codeplex 页面上的文档还有更多内容。

问候斯特凡

# vbscript - 你能在 VBScript 中声明一个常量数组吗？

> ID：533632
> 
> 赞同：8
> 
> 时间：2009-02-10T18:50:46.503
> 
> 标签：vbscript

我想使用我在代码顶部多次声明的数组。前任。

常量季度 = [“Q1”、“Q2”、“Q3”、“Q4”]

对于每个 Quarter q q.Do some work

等等。

这可以在 VBScript 中完成吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-10T18:55:18.707

`Array()`数组是VBScript 中函数调用 ( ) 的结果。只能生成文字值`Const`。所以：不，你不能。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-10T19:13:18.477

为什么不将数组声明为 public，然后在脚本开始时分配数组？

```
Public arrQuarters
arrQuarters = Array("Q1", "Q2", "Q3", "Q4")

For Each Quarter in arrQuarters
    wscript.echo Quarter
Next 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-11-03T16:20:00.647

您可以定义一个函数来返回要用作常量的数组。例如：

```
For Each q in AllQuarters
    wscript.echo q
Next

wscript.echo "element 0 = " & AllQuarters()(0)

AllQuarters()(0) = "X1"

wscript.echo "element 0 still = " & AllQuarters()(0)

Function AllQuarters()
    AllQuarters = Array("Q1","Q2","Q3","Q4")
End Function 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T18:53:01.397

简单的回答：没有。无法制作阵列`const`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-08T00:27:26.107

一个更短且不易出错的解决方案是：

```
Dim arr
arr = Split("Q1 Q2 Q3 Q4") : ubd = UBound(arr)
' Implied separator is " " aka 040 octal aka 32 Dec aka 020 Hex. 
```

如果您的数据可能包含空格：

```
arr = Split("Le Sage,ne pleure,ni les vivants, ni les morts", ",")
ubd = UBound(arr)
' arr(2), for instance, now contains "ni les vivants" 
```

注意：切勿选择可能出现在“原子”数据字符串中的分隔符，否则函数将在单个数据中间的分隔符上进行拆分。

# f# - F# 中的 Seq.unfold 解释

> ID：533633
> 
> 赞同：5
> 
> 时间：2009-02-10T18:51:02.790
> 
> 标签：f#, seq.unfold

我正在尝试使用 F# 懒惰地创建一个序列。

序列定义如下：

> 三角形数列的第 n 项由下式给出， tn = ½n(n+1)；所以前十个三角形数是：
> 
> 1, 3, 6, 10, 15, 21, 28, 36, 45, 55, ...

这是我到目前为止所拥有的，但它似乎不起作用：

```
let tri_seq = 1.0 |> Seq.unfold (fun x -> match x with                                         
                                          | _ -> Some (x, 0.5*x*(x + 1.0))) 
```

非常感谢谁能帮我弄清楚展开的工作原理。谢谢

**编辑：**我将第一个答案标记为正确，但它不起作用，但是我稍微修改了它并且它起作用了。

```
let tri_seq = 1.0 |> Seq.unfold (fun x -> Some (0.5 * x * (x + 1.0),x + 1.0)) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T18:57:32.447

`match`首先，如果你只有一个案例，为什么要使用？

```
let tri_seq = 1.0 |> Seq.unfold (fun x -> Some (x, 0.5 * x * (x + 1.0))) 
```

第二，什么“似乎不起作用”？你知道你产生了一个无限的列表吗？

/编辑：为了完整起见，这是正确的解决方案，OP发现了自己并作为评论发布：

```
let tri_seq = 
    1.0 |> Seq.unfold (fun x -> Some (0.5 * x * (x + 1.0), x + 1.0)) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T23:51:19.900

Brian 发布的代码的另一种替代方法是使用递归而不是命令式“while”循环：

```
let tri = 
  let rec loop(n, diff) = seq { 
    yield n        
    yield! loop(n + diff, diff + 1.0) }
  loop(1.0, 2.0)
printfn "%A" (tri |> Seq.take 10 |> Seq.to_list) 
```

它的效率要低得多（所以你必须在这里小心一点......），但它是更惯用的功能解决方案，因此可能更容易看到代码的作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T19:12:06.717

这是一个替代方案：

```
let tri = seq {
    let n = ref 1.0
    let diff = ref 2.0
    while true do
        yield !n
        n := !n + !diff
        diff := !diff + 1.0
    }

printfn "%A" (tri |> Seq.take 10 |> Seq.to_list) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-08T07:02:11.170

我知道这是一个很老的问题，但是当您确定 x * (x + 1) 是偶数并且确实可以被 2 整除时，我无法弄清楚为什么要使用浮点数。所以我会简单地使用这个（不多我知道区别，但至少你有一个 int seq）：

```
let tri_seq = 1 |> Seq.unfold (fun x -> Some (x * (x + 1) / 2 , x + 1)) 

tri_seq |> Seq.take 6 |> Seq.toList //[1; 3; 6; 10; 15; 21] 
```

[小提琴](https://dotnetfiddle.net/Ct3k5t)

（当然，除非你处理大量数字......）

# windows - 在 Windows 中生成随机文件

> ID：533636
> 
> 赞同：34
> 
> 时间：2009-02-10T18:51:13.723
> 
> 标签：windows

有没有人有办法在 Windows 中生成随机数据文件？我想生成 50,000 个小 (2K) 文件作为示例。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-10T19:01:01.657

您可以在批处理循环中运行 fsutil 来创建任何大小的文件。

```
fsutil file createnew filename.extension 2000 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-02-05T19:20:06.560

我一直在使用[Random Data File Creator](http://www.bertel.de/software/rdfc/index-en.html)并喜欢它，它创建填充伪随机位的二进制文件（即不是文本文件），它可以快速创建非常大的文件。要使用它来创建多个小文件，您需要编写脚本，考虑到它是命令行，这将非常容易。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-09-27T18:23:16.513

You can use PowerShell to generate cheap random data for your files:

```
[Byte[]] $out = @()
0..2047 | % {$out += Get-Random -Minimum 0 -Maximum 255}
[System.IO.File]::WriteAllBytes("myrandomfiletest", $out) 
```

This uses an algorithm with a seed taken from the system clock, so don't use this for ANY serious cryptographic applications.

In addition, be wary of the performance degradation of `Get-Random` when increasing the size of the output file. More on this aspect here:

*   [PowerShell random file generator too slow](https://stackoverflow.com/q/29501598/4929564)
*   [Improve Powershell Performance to Generate a Random File](https://stackoverflow.com/q/28181000/4929564)

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2017-09-26T07:07:05.703

Powershell 中的单行代码：

```
$out = new-object byte[] 1048576; (new-object Random).NextBytes($out); [IO.File]::WriteAllBytes('d:\file.bin', $out) 
```

与@user188737 解决方案相比，这快如闪电。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-02-10T19:47:04.743

由于您没有指定语言，因此我将随机选择一种。这是一个执行此操作的 powershell 脚本：

```
$rootDir = 'C:\Temp\TestRandomFiles\'
$baseFile = $rootDir + "base.txt"
$desiredFileSize = 2*1KB
$fileCount = 50000
"start" | Out-File -Filepath $baseFile
While ($(Get-ChildItem -path $baseFile).Length -lt $desiredFileSize)
{
    $(Get-ChildItem -path $baseFile).Length | Out-File $baseFile -APPEND
}
for($i=1;$i -lt $fileCount;$i++)
{
    Copy-Item $baseFile "File$i.txt"
} 
```

当然，您必须将变量更改为您想要的参数。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-04-01T02:39:12.060

我没有根据 user188737 和 mguassa 的建议使用 Get-Random 生成文本，而是通过使用 GUID 提高了速度。

```
Function New-RandomFile {
    Param(
        $Path = '.', 
        $FileSize = 1kb, 
        $FileName = [guid]::NewGuid().Guid + '.txt'
        ) 
    (1..($FileSize/128)).foreach({-join ([guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid -Replace "-").SubString(1, 126) }) | set-content "$Path\$FileName"
} 
```

这需要 491 毫秒来生成一个 1mb 的文件。跑步：

```
New-RandomFile -FileSize 1mb 
```

更新：

我已经更新了我的函数以使用 ScriptBlock，因此您可以用任何您想要的方法替换“NewGuid()”方法。

在这种情况下，我制作了 1kb 的块，因为我知道我从不创建更小的文件。这大大提高了我的功能速度！

Set-Content 在最后强制使用 NewLine，这就是为什么每次写入文件时都需要删除 2 个字符的原因。我用 [io.file]::WriteAllText() 代替了它。

```
Function New-RandomFile_1kChunks {
    Param(
        $Path = (Resolve-Path '.').Path, 
        $FileSize = 1kb, 
        $FileName = [guid]::NewGuid().Guid + '.txt'
        ) 

    $Chunk = { [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid +
               [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid +
               [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid +
               [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid +
               [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid +
               [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid +
               [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid +
               [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid -Replace "-" }

    $Chunks = [math]::Ceiling($FileSize/1kb)

    [io.file]::WriteAllText("$Path\$FileName","$(-Join (1..($Chunks)).foreach({ $Chunk.Invoke() }))")

    Write-Warning "New-RandomFile: $Path\$FileName"

} 
```

如果您不关心所有块都是随机的，您可以简单地 Invoke() 一次生成 1kb 块。这大大提高了速度，但不会使整个文件随机化。

```
Function New-RandomFile_Fast {
    Param(
        $Path = (Resolve-Path '.').Path, 
        $FileSize = 1kb, 
        $FileName = [guid]::NewGuid().Guid + '.txt'
        ) 

    $Chunk = { [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid +
               [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid +
               [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid +
               [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid +
               [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid +
               [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid +
               [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid +
               [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid + [guid]::NewGuid().Guid -Replace "-" }
    $Chunks = [math]::Ceiling($FileSize/1kb)
    $ChunkString = $Chunk.Invoke()

    [io.file]::WriteAllText("$Path\$FileName","$(-Join (1..($Chunks)).foreach({ $ChunkString }))")

    Write-Warning "New-RandomFile: $Path\$FileName"

} 
```

Measure-Command 所有这些更改以生成 10mb 文件：

执行 New-RandomFile：35.7688241 秒。

执行 New-RandomFile_1kChunks：25.1463777 秒。

执行 New-RandomFile_Fast：1.1626236 秒。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-10T18:54:46.553

您必须以正常方式创建文件，然后用随机数据填充它们，可能来自某种 rand() 函数。

这实际上取决于您的编程语言。Windows 本身当然不会提供这种能力。

然而，有许多编程语言可以轻松做到这一点，包括基本的 windows 批处理/CMD 脚本。你有兴趣使用什么语言？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-08-10T13:38:03.727

是的，fsutil 很棒，但不会生成随机数据，只会生成 ASCII 空值。

我不记得我在哪里找到的，但这些天在谷歌上搜索我仍然可以在以下位置找到它：http: [//www.private-files.com/other/random.c.txt](http://www.private-files.com/other/random.c.txt)

我不知道这个程序有多老，但至少和你的问题一样老，可能有点老。

无论如何，这里有一个 C 程序，它创建卡方测试结果为 0 的文件：

```
// ------------------------------------------------------------     
// Name: random.c  (program to create random files)
//     
// This "no-frills" program creates files with the following 
// characteristics: 
//
//    (1) Byte sequences are random (no predictability);
//    (2) Files produced are binary files; 
//    (3) File sizes are multiples of 256; 
//    (4) Files will have a chi-squared test result of 0
//        (see analyze.exe by Wenger for explanation)
//  
//              Programmer:  Scott Wenger
//                           Box 802
//                           Stevens Point, WI 54481
//                           panther@wctc.net
//
//       Note:  part of this code is from Knuth Volume II
// 
//  Enhancements and modifications of this program are left 
//  to the imagination and creativity of the programmer.
//  Check your compiler for required header files.  You may 
//  need to include the iostream header.
//
//  Random files are of potential use to cryptographers
//  for the purpose of encryption.  
//  
//  To analyze files produced by this program, see 
//  the analyze.exe program by Scott Wenger (found at
//  http://www.coredcs.com/sware.html)
// ------------------------------------------------------------

// This program works in the following way:
// The time is used to seed the random number generator.
// Using Knuth's algorithm, random numbers are generated
// in the range of 0 to 255 (corresponding to 256 ASCII chars.)
// When random numbers are generated they are marked as used and 
// are not re-used until all 256 ASCII values appear.  Characters 
// are written to disk and the process continues until the
// desired file size is reached.  Output is a random binary file
// called random.bin (placed in the root directory)
// The controlled filesize along with the placeholder feature 
// of this code forces a very high degree of randomness in 
// the output file. 

#include <time.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void init_mm();
void clear_array(); 
int  number_range(int minval, int maxval);
int  number_mm();

static int rgiState[2 + 55]; 
int place_holder[256];          // to keep track of numbers already generated

int main()
{
  mainprogram();
  return 0;
}

int mainprogram()
{
  int ch; 
  int c_used = 0;  // counter of chars in placeholder
  int done = 0; 
  int random;

  char buffer[2];

  long x;
  long byte_size = 0L;
  FILE *fp;

  clear_array();
  init_mm();  // seed random number generator

  // create a random file of length specified by user
  printf("\nrandom.exe originally by Scott Wenger");
  printf("\nThis program creates a random binary file.\n");
  printf("\nPlease specify length of random file to create (in megabytes): ");  

  scanf("%ld", &byte_size);

  while (byte_size > 1000 || byte_size <= 0 )
  {
    printf("\nWill not create files larger than a gigabyte! ");
    printf("\nPlease specify length of random file to create (in megabytes): ");
    flushall();
    scanf("%ld", &byte_size);
  }

  byte_size = byte_size * 1024 * 1024;

  if ( (fp = fopen("random.bin", "wb"))  == NULL) {
    fprintf(stderr, "\nOutput file (random.bin) could not be created.");      
    fflush(stdout);
    exit(1);
  }

  for (x = 0L; x < byte_size; x++) {

    if (c_used == 256) {
      clear_array();
      c_used = 0;
    }

    random = number_range(0, 255);    // use all ASCII values

    if ( *(place_holder + random) ) {  // already used, find another
      done = 0;
      while (!done) {
        random = number_range(0, 255);
        if ( *(place_holder + random) == 0) {
          *(place_holder + random) = 1;
          done = 1;
        }
      }         
    }
    else *(place_holder + random) = 1;  // use it and mark as used 

    c_used++;   // found next character so increment counter

    sprintf(buffer, "%c", random);  // convert ASCII value to char 
    ch = buffer[0];
    fputc(ch, fp); // write to file
  }

  fclose(fp);

  printf("\nDone. File \"random.bin\" was created (size: %ld bytes)", byte_size);
  printf("\nOutput file is in the root directory (c:\\random.bin)\n");
  return(0);
}

// ---------------------------------------------------------------------------------

void clear_array()
{
  register int x;
  for (x = 0; x < 256; x++) 
    *(place_holder + x) = 0;
}

// ---------------------------------------------------------------------------------

int number_mm()
{
    int *piState;
    int iState1;
    int iState2;
    int iRand;

    piState     = &rgiState[2];
    iState1     = piState[-2];
    iState2     = piState[-1];
    iRand       = ( piState[iState1] + piState[iState2] )
                & ( ( 1 << 30 ) - 1 );
    piState[iState1]    = iRand;

    if ( ++iState1 == 55 )  iState1 = 0;
    if ( ++iState2 == 55 )  iState2 = 0;

    piState[-2]     = iState1;
    piState[-1]     = iState2;

    return(iRand >> 6);
}

// ---------------------------------------------------------------------------------

//  Generate a random number.

int number_range( int minval, int maxval )
{
  int power, number;

  if ( ( maxval = maxval - minval + 1 ) <= 1 ) return (minval);

  for ( power = 2; power < maxval; power <<= 1 )
    ;
  while ( ( number = number_mm( ) & ( power - 1 ) ) >= maxval )
    ;
  return(minval + number);
}

// ---------------------------------------------------------------------------------

// Mitchell-Moore algorithm from Knuth Volume II. 

void init_mm( )
{
  int *piState;
  int iState;

  piState = &rgiState[2];
  piState[-2]   = 55 - 55;
  piState[-1]   = 55 - 24;
  piState[0]    = ( (int) time( NULL ) ) & ( ( 1 << 30 ) - 1 );
  piState[1]    = 1;

  for ( iState = 2; iState < 55; iState++ ) 
  {
    piState[iState] = ( piState[iState-1] + piState[iState-2] )
                      &  ( ( 1 << 30 ) - 1 );
  }
}

// -------------------- End ------------------------------------------------------- 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-04-15T00:57:15.817

这里没有一个答案适合我，所以这是一个利用 Cryptography 库生成大量随机文件的脚本。

这将非常快速地生成文件，直到系统的熵耗尽（在我的 PC 上大约有 4,000 个文件）。在此之后，它（以及您系统上需要加密随机数的任何其他应用程序）将运行非常缓慢。（在 Linux 术语中，考虑使用此脚本`/dev/random`代替`/dev/urandom`）

```
$directory = (Get-Location).Path;
0..10000 | ForEach-Object {
    $size = 1023 * (Get-Random -Minimum 10 -Maximum 1536);
    $contents = [Byte[]]::new($size);

    $rng = [System.Security.Cryptography.RNGCryptoServiceProvider]::new();
    $rng.GetBytes($contents);

    $filename = "$directory\random$($_.ToString().PadLeft(5, '0')).txt"
    Write-Host $filename
    [System.IO.File]::WriteAllBytes($filename, $contents)
} 
```

如果您不想耗尽系统的熵，请将两行 $rng 替换为：

```
 $rng = [System.Random]::new();
    $rng.NextBytes($contents); 
```

这将运行得更慢，但对于大量文件（或更大的文件），它应该更可靠。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-10T18:54:40.503

好吧，从技术上讲，你可以写一些东西来为你做这件事。
我不知道任何具体的内容.. 但最简单的方法是创建一个特定大小的 TEXT 文件（例如 2K）.. 然后编写一个批处理文件将其复制 50000 次。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-10T19:00:11.190

像这样的东西怎么样： [随机文件生成器1.1](http://www.softpedia.com/get/Programming/Other-Programming-Files/Random-File-Generator.shtml)

或[文件生成器](http://www.soft.tahionic.com/download-file-generator/index.html)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-06-18T12:37:45.853

编辑

我重新阅读了这个问题，以下内容不会按原样提供答案（50x2k 文件），但会使用真正随机的二进制数据创建任意大小的文件。

如果您想看到一个准确回答问题的示例，请发表评论。

/编辑

以下可以使用 PowerShell 中可用的对象生成 1GB 的加密安全随机数据文件：

```
#set the size, 1024^3 = 1GB
$size=1024*1024*1024

#as we will build the file 1k at a time, divide required size by 1k
$size/=1024

#now create the byte array of a fixed size
$bytearray=new-object byte[] 1024

#and create a CSRNG object
$RNGObject=new-object Security.Cryptography.RNGCryptoServiceProvider

#Create a file for streaming. PS will overwrite if it exists.
#its probably bad form to hard code the filename, an exercise for you
$stream = New-Object System.IO.FileStream("d:\file1.bin"), Create

#open the stream and grab the handle.
$writer = New-Object System.IO.BinaryWriter($stream)

#create a timer object so we can measure the runtime.  start it.
$stopwatch=[diagnostics.stopwatch]::startnew()

#now, iterate through the required file size 1k at a time
0..($size-1) | Foreach-Object{
    #filling our byte array with random non zero bytes
    $RNGObject.GetNonZeroBytes($bytearray)
    #and them append them to the file stream.
    $writer.write($bytearray)
}

#captain obvious
$stopwatch.stop()
$stream.close()

#and display the stopwatch data
$stopwatch

IsRunning Elapsed          ElapsedMilliseconds ElapsedTicks
--------- -------          ------------------- ------------
False 00:00:23.2019782               23201     70240880 
```

要使用零值的随机数据，只需替换

```
$RNGObject.GetNonZeroBytes($bytearray) 
```

和

```
$RNGObject.GetBytes($bytearray) 
```

dadduckgo的快速介绍，如果你去duckduckgo.com搜索

```
!msdn Security.Cryptography.RNGCryptoServiceProvider 
```

您将直接从 Microsoft 开发人员网络获得非常集中的结果，让您查看可用的 Crypto 类、方法和属性。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-04-11T11:56:53.583

如果您对所在机器的权限有限，则可以在 excel 中使用 VBA。这将使用随机数创建所需数量的 txt 文件。不过，这可能不是最快的方法。

```
Sub rndcreate()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim sbook As Workbook
Dim i As Double
Dim upperbound, lowerbound, totalentries, totalfiles As Integer
Dim x, folder, file As String

'Set output location

folder = "C:\test\"

'Number of files created and entries in files as below

totalfiles = 1
totalentries = 150
upperbound = 99999
lowerbound = 1

For p = 1 To totalfiles

'Add new workbook to populate with data

Set sbook = Workbooks.Add

'Set file name

file = "randomdatafile" & p

For i = 1 To totalentries

    'Randomly created integers between your two bounds

    x = ((upperbound - lowerbound + 1) * Rnd + lowerbound)

    Range("A" & i) = x

Next

ActiveWorkbook.SaveAs Filename:=folder & file & ".txt", FileFormat:=xlTextWindows
ActiveWorkbook.Close

Next

End Sub 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-12-29T11:47:07.223

好吧，有点晚了，但这是我对一个永远是实际的问题的贡献。

它的工作方式在代码中是不言自明的：

有两个循环。在柜台上运行的外层在某些给定字母`$j`的根目录中创建文件夹。`$currdrive`内循环生成`$i`文件`$size`（默认1GB）

```
$currdrive="G"
for ($j=0;$j -lt 5;$j++){
    new-item "$($currdrive):\random$($j)" -itemType directory
    for ($i=0;$i -lt 100;$i++){
        echo "Creating file $i...";
        $size=1048576*1024;
        $out = new-object byte[] $size;(new-object Random).NextBytes($out);[IO.File]::WriteAllBytes("$($currdrive):\random$($j)\random-file$($i).bin", $out)
    }
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-06-18T13:59:40.240

所以，我决定这次添加一个准确的答案。

语言是powershell。假设：文件名将是连续的而不是随机的。文件内容将是加密安全和唯一的。文件位置为 C:\temp\

```
#create a fixed size byte array for later use.  make it the required file size.
$bytearray = New-Object byte[] 2048

#create and start a stopwatch object to measure how long it all takes.
$stopwatch = [Diagnostics.Stopwatch]::StartNew()

#create a CSRNG object
$RNGObject = New-Object Security.Cryptography.RNGCryptoServiceProvider

# set up a loop to run 50000 times
0..49999 | Foreach-Object {

    # create a file stream handle with a name format 'filennnnn'
    $stream = New-Object System.IO.FileStream("c:\temp\file$("{0:D5}" -f $_)"), Create

    # and a stream writer handle
    $writer = New-Object System.IO.BinaryWriter($stream)

    # Fill our array from the CSRNG
    $RNGObject.GetNonZeroBytes($bytearray)

    # Append to the current file
    $writer.write($bytearray)

    # Close the stream
    $stream.close()

}

# how long did it all take?
$stopwatch.stop()
$stopwatch 
```

和输出：

```
IsRunning Elapsed          ElapsedMilliseconds ElapsedTicks
--------- -------          ------------------- ------------
False 00:07:53.7685350              473768   1434270755 
```

嗯，感觉好像花了很长时间，但是

```
$stopwatch.ElapsedMilliseconds/50000
9.47536 
```

所以，每个文件大约需要 10 毫秒。那是一个旧的sata磁盘。

# flash - 如何确定来自预加载器的“initProgress”事件总数？

> ID：533644
> 
> 赞同：1
> 
> 时间：2009-02-10T18:53:28.617
> 
> 标签：flash, actionscript-3, event-handling, preloader

闪存预加载器发出`FlexEvent.INIT_PROGRESS`事件以指示闪存应用程序初始化的进度。但是，调度此事件*的次数*取决于应用程序本身。

我试图确定这个数字，但在 Flex 文档中找不到答案，所以现在我求助于实验。更糟糕的是，在我看来，这个数字会不时变化，即使闪存文件未修改。

有没有一种程序化的方式来至少估计这个值？

**编辑**：我正在使用此信息在预加载器中显示进度条。实际上，我显示了两个，一个在下载程序时显示，另一个在初始化时显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-24T23:58:45.637

该类`mx.preloaders.DownloadProgressBar`使用看似任意的值 12：

```
private var _initProgressTotal:uint = 12;

// [...]

protected function initProgressHandler(event:Event):void
{
    // [...]

    var loaded:Number = 100 * _initProgressCount /
    (_initProgressTotal - _displayStartCount);

    // [...]
} 
```

我不知道他们从哪里得到这个价值，但它似乎对 Adob​​e 来说足够好......？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-18T00:37:55.230

不要太担心总数，根据我的经验，这应该发生得如此之快，以至于没有必要完全准确。如果您进行了几次测试，发现它最多计数到 14，那么只需手动将进度条设置为最多 20 个。用户仍然会看到进度条很快填满，因为它不会在屏幕上显示很长时间, 没有人关心它是否完全准确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T11:33:35.703

也许每次初始化组件时都会触发该事件？

如果您告诉我们您到底想做什么，也许会有所帮助。我们可以尝试寻找替代解决方案。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-12T19:19:39.520

您应该将进度条基于 bytesLoaded / bytesTotal，而不是调用处理程序的次数。

例如：

```
preloader.loaderInfo.addEventListener(ProgressEvent.PROGRESS, onPreloaderProgress); 
```

然后，在您的处理程序中，执行以下操作：

```
function onPreloaderProgress(e:ProgressEvent):void
{
    progress = e.bytesLoaded / e.bytesTotal;
} 
```

# sql-server - 如何在 SQL Server Integration Services 项目中为目录服务使用 OLE DB 提供程序？

> ID：533646
> 
> 赞同：1
> 
> 时间：2009-02-10T18:54:19.410
> 
> 标签：sql-server, sql-server-2005, active-directory, ssis

我可以设置一个使用目录服务 OLE 提供程序并指向我们的域控制器之一的连接管理器。然后，在数据流区域，我创建一个 OLE DB 源并将数据访问模式设置为“SQL 命令”。

然后，我使用此查询从 Active Directory 中提取数据：

```
Select employeeid, sAMaccountName
From 'LDAP://MyCompany.com'
Where objectClass = 'user'
  and objectClass = 'Person'
  and objectClass <> 'Computer' 
```

如果我解析查询，它说它解析正确。如果我打开查询生成器，它会给我这个错误。

> FROM 子句中的错误：在“WHERE”附近。无法解析查询文本。

然后我单击确定，它会打开查询生成器，我可以在其中成功运行查询并从 AD 获取结果。但是，当我尝试单击“确定”以应用更改或进入“列”视图时，我收到此错误：

> 数据流任务 [OLE DB 源 1 [941]] 出错：发生 OLE DB 错误。错误代码：0x80040E21。
> 
> 附加信息：HRESULT 异常：0xC0202009 (Microsoft.SqlServer.DTSPipelineWrap)

我还尝试使用“来自变量的 SQL 命令”访问模式设置数据库源。我设置了一个字符串变量，其值为查询......但这只是给了我同样的错误。

因为错误太笼统了，我似乎无法找到实际错误的描述。

有谁知道如何成功使用 Microsoft Direcotry Services 的 OLE DB 提供程序？和/或是否有人知道在 SSIS 内部执行此操作的更好方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-09T14:55:15.127

假设您将链接服务器（您的 Active Directory OLE DB 提供程序）命名为“ADSI”，这基本上就是您需要的：

```
SELECT samAccountName,
       employeeID
FROM OPENQUERY(ADSI,
  'SELECT samAccountName, employeeID
   FROM ''LDAP://MyCompany.com''
   WHERE objectClass=''Person''
   AND objectClass = ''User''
   AND NOT objectClass = ''Computer''') 
```

# iphone - Next 和 Previous 导航文本字段

> ID：533650
> 
> 赞同：1
> 
> 时间：2009-02-10T18:54:40.533
> 
> 标签：iphone

我的应用程序中有一个带有多个 UITextField 的注册表单。为了加快这个过程，我想在固定在键盘上方的工具栏上添加一个下一个和上一个按钮，并允许用户使用这些按钮在字段之间“制表”。

我知道我可以浏览视图上的子视图集合，但我想知道是否有更清洁的方法来做到这一点？

此功能在 safari 中实现，如以下屏幕截图所示：

![替代文字](https://dl.getdropbox.com/u/22784/keyboardToolbar.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T19:30:13.507

如果您想将这种类型的功能添加到您的应用程序中，您需要创建一个带有下一个/上一个按钮的自定义视图，并在键盘出现时正确定位它。然后处理对这些按钮的任何触摸。

# git - 我可以运行受密码保护的只读 git 服务器吗？

> ID：533658
> 
> 赞同：9
> 
> 时间：2009-02-10T18:57:20.417
> 
> 标签：git, version-control

我需要一个应用程序能够从 git 存储库中获取但不能推送到它，所以，这是只读部分。这可以通过 git 守护进程轻松完成。

最重要的是，我需要访问所述存储库以受密码保护，包括阅读它。因此，在进行任何获取之前，应用程序需要进行身份验证。

可行吗？与 git 守护进程？别的东西？http + auth 也许？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T19:48:28.563

HTTP 身份验证不会保护通过网络传输的包，因此如果您担心窃听者，HTTP 身份验证将不够用。此外，git 使用 git 协议比使用 HTTP 协议更有效。但是，git-daemon 不会为您进行身份验证。

可能最好的解决方案是使用[gitosis](http://scie.nti.st/2007/11/14/hosting-git-repositories-the-easy-and-secure-way)，它允许您使用 ssh 保护存储库——加密的强身份验证和网络机密性——并控制对存储库的访问（例如，让一些用户读写，而另一些用户用户只读）。这将在您的 ssh 连接上使用高效的 git 协议。

如果你愿意外包，[github](http://github.com/)可能是最好的方法。他们有不同价位的计划来满足许多需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T19:05:56.123

最简单的方法是在 gitweb 之上设置 HTTP 身份验证。见[那里](http://maymay.net/blog/2008/08/08/how-to-use-http-basic-authentication-with-git/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-09T07:40:15.377

使用[gitolite](http://sitaramc.github.com/gitolite/)。这是最好的：易于设置（如果您已经了解 SSH 密钥管理），完全控制用户访问和传输安全 (SSH)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T15:07:02.433

我喜欢 **git** + **gitolite** + **gitweb的组合**

*   gitweb 提供了一个非常精简和快速的网络前端

*   gitolite 正在执行所有授权任务，因此您可以授予在（ssh）用户级别上读取或写入的权限（即使 gitolite 的配置也作为普通 git 存储库处理，这意味着授权/配置更改是可跟踪的）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T22:48:30.813

您可以通过 SSH 获取，它是经过身份验证和加密的通道。我不知道[gitosis](http://scie.nti.st/2007/11/14/hosting-git-repositories-the-easy-and-secure-way)是否会帮助您管理 SSH 访问权限，而不是使用 git-shell 作为 shell 来设置 shell 帐户。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-20T06:42:34.187

要创建经过身份验证的“只读”存储库，请为所有适用方提供对存储库的 SSH 访问权限，但仅允许通过使用[此处示例](http://www.kernel.org/pub/software/scm/git/docs/howto/update-hook-example.txt)的更新挂钩向各方子集推送请求（写入访问） 。

# sql-server - 为什么不将 IGNORE_DUP_KEY 设置为 ON？

> ID：533659
> 
> 赞同：10
> 
> 时间：2009-02-10T18:57:26.797
> 
> 标签：sql-server, tsql, database-design

`IGNORE_DUP_KEY = ON`基本上告诉 SQL Server 插入不重复的行，但默默地忽略任何重复；默认行为是在不允许的列中有重复项时引发错误并中止整个事务。

我处理过大量数据，这些数据通常至少有一个不应该重复的数据，所以`UNIQUE`当我知道一个值不应该重复时，我喜欢使用约束；但是，当我尝试批量加载数据时，我想要的最后一件事是让它完成 90%，然后突然遇到重复并出错整个事情（是的，我知道明显的解决方案是确保没有重复，但有时我只是收到一个充满数据的电子表格，并被告知尽快加载它）。

那么，设置默认值的原因是什么`OFF`，为什么**不**希望它一直处于打开状态，这样任何非重复条目都会成功，而您不必担心任何重复项；无论如何，重复项很可能是错误的。

它与性能有关，还是与其他有关？这似乎是个好主意，但它不是默认行为肯定是有原因的。

主要是，是否有充分的理由**不**使用我应该知道的这个，或者是否应该根据具体情况进行评估？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-11T05:11:34.997

每当数据库中的“正常”出现偏差时，您可能想知道它。

由于业务需求导致的某些限制，您使密钥保持唯一性。数据库只是保持交易的一面，说'嘿，你希望这是独一无二的，但现在你说的是相反的东西。下定决心'

如果这是故意的，您可以使用 IGNORE_DUP_KEY 要求数据库关闭 :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T19:12:36.060

我想这可能是因为默认设置是为了防止任何无效事务静默失败。考虑到一切，我更愿意选择何时忽略意外后果，但除非我另有说明，否则请告诉我。

示例：如果我存入我的薪水，我希望有人能注意到我的雇主是否不小心签发了重复的支票号码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-20T13:10:04.040

> 无论如何，重复项很可能是错误的。

我敢打赌他们是！他们是虫子。你当然想知道他们！`IGNORE_DUP_KEY` **默认开启**是...

1.  隐藏错误...
2.  ...通过破坏数据。（当然，数据库在物理上保持一致，但从业务逻辑的角度来看，数据仍然是错误的。）

从任何标准来看，这都是一个糟糕的选择。

在特殊情况下打开它，然后尽快摆脱它，以免不小心隐藏错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T19:07:52.500

它可以用作健全性检查。如果你知道不应该有冲突，就把它关掉，它会在错误上快速失败。OTOH 用于临时控制台会话，我明白你的意思。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-24T12:32:03.037

我有一个多对多的关系。我有一个具有唯一索引的产品到类别表，除了表中的 prodid 和 katid 之外没有其他数据。

所以我在唯一 (prodid,katid) 索引上设置 IGNORE_DUP_KEY 。

所以我可以放心地说“将产品 (1,2,3) 添加到类别 (a,b,c)”，而不必检查某些产品是否已经在某些类别中；我只关心最终结果。

# development-environment - 通过远程桌面在计算机上进行开发，经验？

> ID：533662
> 
> 赞同：3
> 
> 时间：2009-02-10T18:57:45.517
> 
> 标签：development-environment, remote-desktop

是否有人（出于选择或被迫）在他们必须远程桌面进入的计算机上进行开发？

你的经历如何？

我可以看到优势，因为只要您有足够快的连接，您基本上可以在世界任何地方进行编码。

### 复制

> [https://stackoverflow.com/questions/424869/reasons-to-use-a-vm-for-development](https://stackoverflow.com/questions/424869/reasons-to-use-a-vm-for-development)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-10T19:01:15.040

我不得不为一个共享点项目这样做，它几乎让我发疯。这些小的延迟确实加起来了，尤其是在滚动文本时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T19:01:52.420

我已经做到了。它有效，但对我的口味来说有点慢。我不知道这是否取决于我们当时运行的硬件等。当我不在控制台附近时，一些小用途是可以的，但是打字延迟很快就会影响到我。我听说 Citrix 曾经声称他们所有的人都毫无困难地使用了他们的远程解决方案，包括程序员。不过这是几年前的事了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T19:03:22.557

是的，我过去曾远程办公，远程桌面进入位于公司防火墙内的 PC 非常高效。我们都知道编码不仅仅是在 IDE 中打字。它是关于访问开发、测试、编译、共享和发布所需的资源。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T19:04:06.127

是的！！我工作的公司在不同地方的服务器中安装了虚拟机（更具体地说是不同的国家）......正如凯文所说，它很慢，但我可以在任何地方工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T19:07:19.567

在这里使用远程桌面在各种虚拟机上进行开发（通常在本地网络的某个地方，所以不是*那么*远程）。令人惊讶的是，同样的（小的、不可预测的）延迟让一些开发人员几乎发疯，完全打乱了他们的工作流程……而其他人几乎没有注意到它们，并且在远程系统上的效率与在本地计算机上一样高。我还没有弄清楚这是个人特质还是可以训练的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T22:33:16.747

这完全取决于您的连接速度/延迟。我通过 VPN 远程桌面连接到我的工作计算机，从家里远程开发，我发现它在性能方面与实际坐在工作中完全一样。唯一的缺点是双显示器问题，因为我有 2 个 19 英寸的显示器在工作中，而在家里有一个，但这并没有真正减损我正在进行的开发工作。

更难的是与其他员工的沟通 - 在工作中很容易走过去与某人聊天，给他们打个电话等。由于我们没有任何 IM 系统，远程工作人员仅限于电子邮件只做通讯。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T19:26:52.127

我现在正在做。这有点拖累，但可以忍受。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T19:32:39.287

只要您不尝试开发/调试图形密集型应用程序，就应该没有问题。我几乎每天都在我的 Mac 笔记本电脑上使用远程桌面在我办公室的 Windows 机器上进行开发，并且没有任何抱怨。50% c++ 桌面应用和 50% php web 应用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-10T19:43:02.740

当我需要在签入后编译我的应用程序副本时，我会使用远程桌面。我发现通过远程连接进行开发需要更长的时间，尤其是在连接或延迟出现问题的情况下。几年来，我一直在笔记本电脑上以这种方式工作，因为我在办公室的台式机功能要强大得多。现在我有一台四核机器，在家里开发并在本地进行所有测试比通过远程进行更方便。唯一的问题是确保您拥有可靠的备份解决方案，因为丢失代码不是一种选择。我正在运行 RAID 5 磁盘阵列和在线备份解决方案。然而，性能差异意味着我现在节省了大量的本地开发时间，而且更有趣（VS 2008 的道具）。

摘要：在本地开发、在本地测试和在本地编译（从本地 LAN 和远程将文件复制到部署盒所需的时间更少）。在使用它的地方做你的工作，如果你在家里测试，然后在家里开发。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-10T20:33:55.567

如果您的连接速度很好，那是完全可以的。您必须注意菜单和类似内容的轻微延迟。我每周有两到三天在家工作，这很棒，因为我有 70 英里的通勤时间。

大多数时候我没有太多的延迟。我是从新罕布什尔州到佛罗里达州再返回新罕布什尔州的 VPN。由于我的桌面是 Vista 而我的工作桌面是 XP，我认为没有双显示器我将无法生活，但我一直在使用[RoyalTS](http://www.code4ward.net/main/RoyalTS/Overview.aspx)。RoyalTS 不仅让我可以管理我需要连接的所有服务器和桌面，而且当我连接到我的 XP 桌面时，我可以在我的两个显示器上传播 Royal TS，并获得一个漂亮的宽终端窗口。我失去了最大化显示器的能力，但我可以适应。

它对我来说效果很好。每月大概有 2 到 3 个小时，延迟会变差，让我抓狂。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-10T20:48:07.173

我做过一次。通过局域网，因为隔壁的 IT 服务台太吵了，我发现无法集中注意力。那是在假期期间，他们无事可做（但必须在现场以防有支持电话打进来）并在 XBox 上玩。我去了大楼另一端的实验室，并从那里进入我自己的工作站。它稍微慢了一点，但非常值得。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-10T20:55:18.123

对我来说，忍受滚动太慢了。我工作的公司试图让我们检查笔记本电脑以在家中进行迟到的工作，但他们不想花时间了解我们的 IDE 和其他工具是否以我们可以使用的方式获得许可他们离开笔记本电脑。因此，我们应该使用 VPN 并在笔记本电脑上运行我们的台式机。

在花了 4 个小时等待屏幕刷新完成一项本应花费我不超过一个小时的任务后，我最终只开车 7 英里到办公室。之后再也没有尝试过。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-10T20:58:37.833

不完全回答您的问题，因为我不是真正的远程*桌面*，但是：

我一直在远程工作（=编写代码），使用 ssh、[screen](http://en.wikipedia.org/wiki/GNU_Screen)和 vim 的组合。通过基本的 DSL 线路，您可以获得与在本地工作时完全相同的响应能力。在任何现代机器上，您可以一次打开任意数量的编辑窗口和解释器，并且从另一台机器断开和恢复屏幕会话只需要一个命令。

当然，如果您是游戏程序员，则此设置效果不佳:)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-10T21:42:30.647

我经常在家里这样做。它在局域网上运行良好，但如果我尝试从外部源连接到我的家用计算机，尤其是通过蜂窝连接，它几乎无法忍受。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-10T19:09:13.383

这对于小型应用程序是可行的，但正如其他人所说，这很困难。

主要问题

1.  速度 - 与使用实际机器相比，远程连接总是会更慢。
2.  控制 - 如果您是远程用户，您可能没有管理员权限。
3.  没有双屏 - 取决于使用的软件。RDP 7 允许多个桌面（感谢 Mystere Man 的 RDP 说明）

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-10T22:16:54.947

我发现我会在周末来办公室，而不是这样做，除非我只是有一个非常快速的任务。我们有一个下雪天，办公室里的每个人都试图同时使用 VPN，我什至无法让我的光标工作。

但是，在办公室里，我一直在远程访问我们在另一个州的服务器，这似乎工作正常。但同样，我并没有做更多的故障排除或运行快速流程或复制文件。当两台服务器都在另一个位置并且我在弗吉尼亚州这里时，将大文件从一台服务器复制到另一台服务器要快得多。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-10T19:19:12.410

我遇到过一些必须远程访问机器的情况，通常是为了调试我在本地机器上无法执行的操作，例如拥有 2 个使用 Windows 2000 Professional 的网站，或者必须安装一些软件在本地安装比在 CMS 等服务器上使用或运行软件的中间件更痛苦。

对我自己来说，最大的问题是服务器上的东西可能与我的本地机器位于不同的位置，这有其好的和坏的优势。另一点是机器之间的 IIS 版本不同。Web Server 2008 有一些不错的功能，使其类似于资源管理器中的 Vista，这有点好坏，IMO。在这种情况下，壁纸、快速启动按钮和其他一些个人风格通常会被最小化。

我会说做一两天是可以的，但不仅如此，它会变得丑陋。我记得一个前同事的故事，多个开发人员不得不共享同一个服务器进行开发。这些年来，我从未见过如此糟糕的事情。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-10T19:20:23.390

除非绝对被迫，否则我会拒绝，即使那样最好是一个很好的理由。顺便说一句，如果客户端和主机 PC 都在运行 vista，您可以[远程终端并使用双显示器](http://blogs.msdn.com/ts/archive/2006/11/10/multi-monitor-support-in-the-vista-ts-client.aspx)

但是，我们确实通过 Hudson 使用干净的 VM 进行构建/CI。我相信这是两全其美的。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-02-10T19:24:25.157

这是可能的，但它是残酷的。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-10T19:27:24.777

当我需要在办公室 PC 上编译程序时（我在家里使用 mac 笔记本电脑），我一直在这样做。这不是很有趣，但它对于相对较短的任务是可行的。提示的短暂滞后有点烦人。

主要问题是分辨率越高，占用的带宽越多，有时体验越差。我使用 Eclipse，我只能在非常高分辨率下使用它。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-02-10T19:52:56.417

我们的开发团队使用 ESX 服务器，我们每个人都会在其中启动一个或多个虚拟服务器和 RDC 来完成我们所有的开发任务。我们几乎只将主机笔记本电脑用于个人生产力和协作任务（办公室/电子邮件/聊天/网络/等）。它工作得很好！我们有一个不错的网络，所以延迟通常不是问题。我喜欢在不影响我的实际计算机的情况下破坏我的开发环境的自由，并在一小时内让另一台重新上线。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-02-10T20:09:39.543

我在本地网络（非常快）上工作，它似乎工作得很好。但是，当我必须通过 256k 电缆连接从家里远程访问时，它可能会由于延迟而无法使用，但通常还可以。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-02-10T20:11:47.587

这在技术上是可能的，这意味着它会起作用，但你可能不会活太久。

特别是如果您不在本地网络中，而是通过 Internet 访问服务器，即使 DSL 线路也对您没有多大帮助。

我曾尝试在本地网络中以这种方式使用 Visio，最后我只是将笔记本电脑与本地安装一起带入以稳定我的精神状态。

今天，当许多人如此谨慎，甚至没有任何鼠标适合他们，因为它不够敏感或过于敏感，尝试切换到远程桌面模式实际上会将您传送到石器时代。

当您只需要短时间连接来管理事物时，远程桌面非常有用。它并不是真的要组织远程软件的使用。它会起作用，但你不会喜欢它。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-02-10T20:49:34.423

我一直使用 X11（或有时 VNC）来做这件事。其中一些也是 OpenGL 开发：如果您有足够的带宽并且使用比全屏更小的窗口，X11/GLX 工作得很好。

但无论你有多少带宽，真正决定体验是否愉快的因素是延迟。<50ms 好；> 100ms 开始变得疯狂。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2010-07-02T05:00:41.407

我让他们把我的开发箱放在服务器机房里，在那里它可以得到保护和备份。我使用基于公司的 VPN 和远程桌面访问它，具有锁定功能，如无剪贴板复制/粘贴。它让我可以快速访问他们防火墙内的所有内容（包括数据库和 SVN），并让我使用“一次性”笔记本电脑，如果它被盗，它不会真正丢失任何东西。如果是这样，我只需花大约 500 美元购买另一个，安装 VPN，然后我就走了……

不过，还是挺无聊的。当我们成长为它时会更喜欢它。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2010-06-09T21:41:23.833

将 RemoteDesktop 与多屏幕一起使用 - 我经常遇到无法重绘屏幕的问题，尤其是当窗口大于 1 个屏幕时。

# c# - 工作流程警告

> ID：533663
> 
> 赞同：0
> 
> 时间：2009-02-10T18:57:52.040
> 
> 标签：c#, workflow, warnings

我正在尝试清理一些现有代码生成的警告。我被这三个困住了......我真的没有工作流程的经验，所以我不知道它在抱怨什么......有什么想法吗？

```
warning WF1820: Activity 'StartWorkflowActivity' validation warning:
Validation failed for parameter 'workflowName'. All parameters for
the receive activity should have a valid activity binding or a value
specified.

warning WF1820: Activity 'ContinueWorkflowActivity' validation warning:
Validation failed for parameter 'workflowContext'. All parameters for
the receive activity should have a valid activity binding or a value
specified.

warning WF1821: Activity 'ContinueWorkflowActivity' validation warning:
Validation failed for parameter '(ReturnValue)'. No valid activity bind
or value found specified for return value. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T19:08:01.763

如果您的工作流程正常运行，您无需担心 - 它会针对在运行时绑定的属性（因此未在代码中设置）向您发出警告。

# c# - 实体框架动态 Where 子句

> ID：533673
> 
> 赞同：6
> 
> 时间：2009-02-10T19:00:04.123
> 
> 标签：c#, entity-framework, generics

我有一个像这样的查询：

```
var function = GetSomeExpression();    

using (FooModel context = new FooModel())
{
    var bar = context.Bar.Where(function);
} 
```

我想创建一个通用方法，可以针对上下文中的不同实体执行 Where 。目标是不必执行 context.Bar.Where、context.Car.Where、Context.Far.Where 等。

无法完成但说明目标的事情是：

```
var q = context.GetObjectContext(T).Where(queryFunction); 
```

我已经研究过使用 Relfection 并且可以获得 Where 方法，但不知道如何针对在委托中传递的上下文执行它。我还研究了 DynamicMethod，但做整个 IL 事情并不吸引人。

到目前为止我所拥有的：

```
private List<T> GetResults<T>(Expression<Func<T, bool>> queryFunction)
{
    // note: first() is for prototype, should compare param type
    MethodInfo whereMethod = typeof(Queryable).GetMethods()
        .Where(m => m.Name == "Where")
        .First().MakeGenericMethod(typeof(T)); 

    // invoke the method and return the results
    List<T> result = whereMethod.Invoke(
    // have the method info
    // have the expression
    // can reference the context 
    );

    throw new NotImplementedException();
} 
```

这可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T20:30:18.633

这比我之前尝试的要容易得多：

```
private List<T> GetResults<T>(IQueryable<T> source, 
    Expression<Func<T, bool>> queryFunction)
{
   return source.Where(queryFunction).ToList<T>();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T20:15:14.833

看到这个帖子

[LINQ to entity - 构建 where 子句以测试多对多关系中的集合](https://stackoverflow.com/questions/110314/linq-to-entities-building-where-clauses-to-test-collections-within-a-many-to-ma#131551)

**编辑**：在您的帖子更新后，这似乎不再相关；我会留下它以防它有帮助。

# unit-testing - 如何在多个浏览器上手动对我的应用程序进行单元测试？

> ID：533688
> 
> 赞同：6
> 
> 时间：2009-02-10T19:03:16.847
> 
> 标签：unit-testing, browser, cross-browser

我的项目需要支持多种浏览器，例如 Firefox 2.0、firefox 3.0、IE 6、IE 7 等。我的问题是我无法在较低版本的浏览器上测试应用程序。我必须转移到其他系统或其他机器进行测试。有没有办法解决这个问题？

我什至不能使用 Virtual Box，因为我的公司不鼓励安装其他软件。

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T19:04:43.333

使用浏览器[模拟器](http://spellbook.infinitiv.it/2006/07/26/top-10-browser-emulators.htm)，例如：

1.  [BrowserShots.org](http://browsershots.org)：免费；在不同的浏览器中测试您的网页设计

2.  [iCapture](http://www.danvine.com/icapture/)：免费；野生动物园截图

3.  [即捕获](http://www.danvine.com/iecapture/)：免费；互联网浏览器截图

4.  [猞猁查看器](http://www.delorie.com/web/lynxview.html)：免费；该服务允许网络作者在使用文本模式网络浏览器 Lynx 进行查看时查看其页面的外观（某种程度）。

5.  [浏览器摄像头](http://www.browsercam.com/)：24小时免费；跨浏览器屏幕截图。

6.  [多个 Internet Explorer](http://www.quirksmode.org/browsers/multipleie.html)：在同一台机器上安装多个 Internet Explorer 版本。

7.  [NetMechanic 的浏览器兼容性工具](http://www.netmechanic.com/browser-index.htm) ：付费服务

8.  [屏幕截图生成器](http://www.fundisom.com/g5/)：屏幕截图生成器，可在 Macintosh G5 的 Safari、MacIE 或 Mozilla 中查看您的网站。

9.  [浏览器存档](http://browsers.evolt.org/)：evolt.org 上以前版本浏览器的软件存档

    来源：[http ://spellbook.infinitiv.it/2006/07/26/top-10-browser-emulators.htm](http://spellbook.infinitiv.it/2006/07/26/top-10-browser-emulators.htm)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T21:14:08.687

有一些[“便携式”版本的 Firefox](http://portableapps.com/apps/internet/firefox_portable)可以让您轻松测试 1.5、2.0 和 3.0……如果讨厌的 IT 人员不允许您在本地安装，即使使用 USB 密钥也可以。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T19:06:44.560

对于 IE，您可以查看[IETester](http://www.my-debugbar.com/wiki/IETester/HomePage)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T22:20:26.213

这里有一个类似的问题： [Running Internet Explorer 6, Internet Explorer 7, and Internet Explorer 8 on the same machine](https://stackoverflow.com/questions/574463/running-ie6-ie7-and-ie8-on-the-same-machine)

公认的答案是使用虚拟化，这样您就可以真实了解网站在其本机系统上运行的每个浏览器下的行为方式。您可以在便携式拇指驱动器上运行 firefox，但不能使用 IE。您可以在每个 VM 上放置一个 Firefox 和一个 IE，以减少您需要的 VM 实例的数量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T19:07:48.363

安装 VirtualBox 的活动。严重地。它是网页设计的基本工具。大概他们给你一个比记事本更好的编辑器，他们也欠你不错的测试工具。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T20:10:03.957

测试解决方案取决于应用程序的功能和您可以使用的资源。你的第一个问题应该是我在哪个平台上写作？操作系统平台将确定您拥有的默认工具集。

应用范围是什么？

- 你在测试图形元素吗？
-GUI IO？
- 计算功能？

您是否可以访问：

*   虚拟机 - 一台计算机模拟其他环境
*   使用多台本地机器和一个 KVM 切换器，更原始的处理能力，易于访问，适用于 GUI 测试
*   通过 SSH 或其他一些服务器-客户端安排使用多台远程机器，可能需要 VNC 之类的客户端或远程桌面形式。

您将需要应用程序安装、激活、重置和报告的自动化方法。你能运行脚本或批处理文件吗？应用程序必须在 GUI 模式下运行，它有 CLI 吗？您是否可以访问其他服务，例如 Web 服务器，您可以打开端口来发送/接收状态报告吗？您可以远程登录到测试机器，从命令行启动和重置浏览器吗？您可以重置挂起的应用程序吗？

可以通过多种方式报告失败和成功，例如创建本地文件、从服务器下载图像或 ping 端口。本质上，测试将需要更多的工作和时间，因为您将需要设计、实施并且可能具有讽刺意味地测试测试套件和设备。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-07T10:43:37.597

检查所有 IE 你可以去 CodeckPack 。nl 并安装所有 IE，即[IE 集合](http://codecpack.nl/iecollection.htm)。

或者您可以使用 www。multibrowserviewer .com 它可以检查 45 个浏览器和 3 个操作系统

# sharepoint - Web 部件未显示在“添加 Web 部件”对话框中

> ID：533713
> 
> 赞同：4
> 
> 时间：2009-02-10T19:08:31.187
> 
> 标签：sharepoint, moss, sharepoint-2007

我使用 Visual Studio 2008 SharePoint Web 部件模板创建了几个 Web 部件。但是，当我部署时，它说一切都已成功部署，但是当我尝试添加 Web 部件时，它们在我的门户中的添加 Web 部件对话框中不可用...

有什么想法吗..？我使用另一个 Web 部件项目执行此操作，但没有遇到此问题...

我看到的唯一区别是这个项目有两个 Web 部件，另一个有一个......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T22:57:23.897

检查您的 Web 部件是否定义为公共（在 VB 中为公共）

internal 是默认的（VB 中的朋友）

这是在这里犯*的*经典错误:-)

安德斯·拉斯克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T19:32:43.687

解决方案应该有一个功能。VSeWSS 通常会激活该功能，但它可能没有被激活。我会检查功能列表，应该很明显哪个是您的，以及它是否已被激活。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T22:00:50.507

在手动安装 Web 部件期间，我遇到的另一个问题是 Web 部件出现错误，而开发环境中没有发现该错误。检查 ULS 日志以了解何时激活该功能，并查看那里是否有错误说明 Web 部件未显示的原因。

# .net - .NET/COM 互操作问题 - 打开 Outlook 2003 发送邮件对话框

> ID：533718
> 
> 赞同：3
> 
> 时间：2009-02-10T19:09:19.873
> 
> 标签：.net, outlook, office-interop

我们有一个用 VB.NET (CLR 2.0) 编写的 WinForms 应用程序，它可以处理很多与 Outlook 相关的事情。我们所做的其中一件事是以编程方式打开一个新的 Outlook 2003“撰写新电子邮件”表单，其中预先填充了“收件人”地址。

```
Me.WordApp = New Word.Application
Dim template As Object = System.Reflection.Missing.Value
Dim newTemplate As Object = System.Reflection.Missing.Value
Dim documentType As Object = Word.WdNewDocumentType.wdNewEmailMessage
Dim visible As Object = False
Me.WordDoc = Me.WordApp.Documents.Add(template, newTemplate, documentType, visible)
'then some other stuff 
```

现在，这几乎在我们部署应用程序的任何地方都能完美运行——用户填写电子邮件主题和文本，单击发送，我们可以捕获发送事件并做其他好事。

只有几个安装它坏了，我们只是无法深入了解它。

以下是否表明问题可能出在哪里：

```
Could not load file or assembly 'office, Version=11.0.0.0, Culture=neutral, 
PublicKeyToken=71e9bce111e9429c' or one of its dependencies. The located assembly's 
manifest definition does not match the assembly reference. (Exception from HRESULT: 
0x80131040) 
```

据我们所知，这些只是 Office 2003 安装，带有 Outlook 和 Word，就像在正常工作的情况下一样。

我将非常感谢任何想法 - 无论是关于如何解决这个问题，还是关于实现相同目标的更好方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T14:34:09.497

好的，它已排序，我感谢 Olli[的回答](https://stackoverflow.com/questions/533718/-net-com-interop-problem-opening-outlook-2003-send-mail-dialog/533807#533807)，这让我走上了正轨。

他的“示例项目”链接将我带到了[这个关于部署 VSTO 解决方案](http://msdn.microsoft.com/en-us/library/bb332051.aspx)的链接。

我在其中发现了有启发性的评论：

**“仅当目标计算机安装了 .NET Framework 1.1 或更高版本时，Microsoft Office 应用程序才会安装主互操作程序集。”**

灯亮了 - 我设置了一个虚拟机，我在上面安装了（按以下顺序）：

*   XP SP2
*   Office 2003（默认安装）
*   .NET 3.5 SP1（大的可再发行版）
*   我的应用程序

宾果游戏 - 问题变得可重现，就像我要向社区寻求帮助的另一个问题一样。正如您可以想象的那样，当 Office 继续运行时，我们所有的计算机以及大多数客户的计算机都已经安装了 .NET，因此通常这根本不是问题。

不过，Office 重新安装未能修复它，“检测和修复”安装也是如此。

但是，“添加功能”安装允许您手动选择 .NET 可编程性支持选项，问题就消失了。

底线：

**没有 .NET，没有 Office 安装的主互操作程序集。**

再次感谢奥利！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T19:30:53.910

我在使用 Excel 2003 加载项时也有过类似的经历。您是否在开发机器上同时安装了 Office 2003 和 Office 2007？如果是这样，请仔细检查项目中的*参考*部分。我对 Office 11 有依赖，但在 Office 12 互操作程序集下使用了。

我认为程序[集绑定重定向](http://msdn.microsoft.com/en-us/library/433ysdt1.aspx)给我带来了麻烦。

编辑：微软的 [示例项目](http://code.msdn.microsoft.com/VSTO2005SEMSI)帮助很大。另一个问题是某些机器上的安全设置（请参阅示例设置项目中使用的 SetSecurity 项目）。

# arrays - 简单的 C 代码，带有令人烦恼的“分配中不兼容的类型”错误

> ID：533724
> 
> 赞同：0
> 
> 时间：2009-02-10T19:11:00.633
> 
> 标签：arrays, variable-assignment, realloc

只是一个简单的程序来习惯指针。该程序应该以与读取内存的相反顺序将我的一部分内存的内容放入字符数组中。IE查看降序内存地址，我想将它按降序存储在字符数组中。

我的编译器一直告诉我：“赋值错误类型不兼容”

用*realloc*函数就行了

我究竟做错了什么？在我看来，“反向”和*realloc*的结果都应该是指向 char 类型的指针？

我的代码：

```
int main(){
char  first[]="hello mark", strng='h', reverse[]="";
char* ptr=&first[10];
int i=0;
    while(ptr > (&strng-0xf4240)){
        printf("%c", *ptr--);
        reverse = realloc(reverse, (i++ * sizeof(char)));
        reverse[strlen(reverse)-i] = *ptr;
    }
printf("%s", reverse);
return 0;
} 
```

谢谢！

编辑：对不起，我将这些错误发布为下面的评论

感谢帮助，第一条和第二条评论搞定了！我确实有所需的#include，我只是忘记将它们复制到堆栈溢出中。你是对的，现在我被困在非空终止的 strlen() 上。我会自己解决那个。再次感谢！

我说得太早了，编译好了，但是有逻辑错误。while 循环将执行一次。但是，无论 i 的初始值如何，后续循环仍然会失败。导致失败的行是调用 realloc 的行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T19:13:48.350

您不能重新分配一开始没有分配的内存。您应该将 reverse 声明为“char *”并从 malloc 开始。

这会让你继续前进，但你真的应该考虑以块的形式重新分配，而不是一次一个字节。哦，当您尝试 strlen 时，我没有费心解决“反向”可能不是空终止的事实 - 我将把它留给读者作为练习。

```
int main(){
char  first[]="hello mark", strng='h';
char* reverse;
char* ptr=&first[10];
reverse = (char*)malloc(1);
reverse[0] = '\0';
int i=0;
    while(ptr > (&strng-0xf4240)){
        printf("%c", *ptr--);
        reverse = (char*)realloc(reverse, (i++ * sizeof(char)));
        reverse[strlen(reverse)-i] = *ptr;
    }
printf("%s", reverse);
return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T19:28:15.070

任何一个：

*   您正在使用 C++ 编译器编译 C 代码。这就是为什么它认为您需要将返回的 void*`realloc`转换为 char*。转换在 C 中是合法的。

或者

*   您未能包含`stdlib.h`，因此编译器认为`realloc`返回`int`

**编辑**

再次阅读您的代码时，实际问题是您正在分配一个数组，该数组不允许出现在分配的 LHS 上（不是“左值”）。不过，您接受另一个答案很好。它有一些很好的建议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T02:49:44.587

> 您不能重新分配一开始没有分配的内存。

是的，绝对正确，因为为了重新分配，malloc 必须有一些关于您操作的内存块的附加信息（通过块分配表，或者存储在指针之前的 4 个字节中）。但你仍然可以写：

```
char * ptr1 = malloc(16);
char * ptr2 = ptr1 + 8;
ptr2 = realloc(ptr2,32); 
```

而且你不会有编译器错误。不过，您仍然可能会在运行时遇到段错误。

但是，C 编译器处理的方式存在根本差异

```
char * tab = "toto"; 
```

和

```
char tab[] = "toto"; 
```

在第一种情况下，*tab*是一个指针，类型为 char *，并且像任何普通变量一样是一个左值。它可能大部分时间都驻留在寄存器中，或者可能是堆上的地址。在第二种情况下，tab 是一个数组，一个常量，因此不是左值。它可能在汇编级别被一个指向二进制可执行文件的文本部分的地址替换，字符串“toto”的数据所在的位置。

# python - 如何使用 Django ORM 查询这个多对多示例？

> ID：533726
> 
> 赞同：5
> 
> 时间：2009-02-10T19:12:06.357
> 
> 标签：python, django, django-orm

我有以下型号：

```
class Author(models.Model):
  author_name = models.CharField()

class Book(models.Model):
  book_name = models.CharField()

class AuthorBook(models.Model):
  author_id = models.ForeignKeyField(Author)
  book_id = models.ForeignKeyField(Book) 
```

话虽如此，我正在尝试使用 Django ORM 模拟此查询（选择特定作者撰写的所有书籍，注意作者可以有很多书，而书籍可以有很多作者）：

```
SELECT book_name 
FROM authorbook, book
WHERE authorbook.author_id = 1
AND authorbook.book_id = book.id 
```

我已经阅读了 Django 网站上的[这个 FAQ 页面](http://www.djangoproject.com/documentation/models/many_to_many/)，但是在我修改我的模型结构并删除 AuthorBook 之前，我很好奇是否可以使用当前结构模拟该查询。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-10T19:21:36.880

你应该能够做到：

```
books = Book.objects.filter(authorbook__author_id=1) 
```

获取与您的 author_id 限制匹配的 Book 对象的 QuerySet。

Django 的好处是你可以在 shell 中做这件事并玩弄它。您可能还会发现 [http://docs.djangoproject.com/en/dev/topics/db/queries/#spanning-multi-valued-relationships](http://docs.djangoproject.com/en/dev/topics/db/queries/#spanning-multi-valued-relationships) 很有用。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-10T19:28:58.970

“AuthorBook”似乎没有正确建模。

您应该使用`ManyToManyField`：

```
class Book(models.Model):
  name = models.CharField()
  authors = models.ManyToManyField(Author) 
```

然后你可以这样做：

```
books = Book.objects.filter(authors__id=1) 
```

# c# - 从 const int * const buffer[] 中检索数据

> ID：533732
> 
> 赞同：1
> 
> 时间：2009-02-10T19:13:01.160
> 
> 标签：c#, pointers, pinvoke

我正确编组：

```
IntPtr buffer 
```

缓冲区是指向具有各自数据的数组的 2 个指针的数组的指针。问题是我得到的数据不准确，例如检索到的数据中是否缺少某些内容（例如，来自音频数据流的 misimg 样本）。

```
// length is parameter
IntPtr[] temp = new IntPtr[2];
Marshal.Copy(buffer, temp, 0, 2);
bufferedData = new byte[bufferSize];
byte[] a = new byte[length];
byte[] b = new byte[length];
Marshal.Copy(temp[0], a, 0, length);
Marshal.Copy(temp[1], b, 0, length); 
```

编辑：对不起，我忘了写那两行:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T22:12:36.877

我终于解决了。我没有错误地读取完整的输入缓冲区。感谢你的帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T21:00:09.017

我对C#一无所知，所以这是一个完整的猜测，但是-您似乎是从整数复制到字节，“长度”是以整数为单位的计数，还是以字节为单位的计数？那里可能有混淆吗？有时这在常规的旧 C++ 中可能是一个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T19:16:05.257

是的，您也需要复制字节缓冲区:)

更新：看起来更好！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T19:46:24.700

如果缓冲区是指向数组的指针，则需要再次读取该指针。

有效：

```
buffer = Marshal.ReadIntPtr(buffer); 
```

# wiki - 您可以删除 FogBugz 案例的“另见”部分中的死 wiki 链接吗？

> ID：533733
> 
> 赞同：3
> 
> 时间：2009-02-10T19:13:08.913
> 
> 标签：wiki, hyperlink, fogbugz

我们在 FogBugz 中有几个案例，它们通过***See Also***部分链接到旧 wiki。在这些情况下，编辑文本（输入文本的正常部分）中没有链接，所以我假设链接是通过 wiki 文章创建的（使用***Case ###***链接方法）。但是，该 wiki 文章似乎已被删除（因为单击链接显示***This article doesn't exist***）。有什么方法可以真正从这些案例中删除链接到不存在的维基？

谢谢

更新：

[这是](http://support.fogcreek.com/default.asp?fogbugz.4.43555.2)FogBugz 技术支持论坛上问题的链接。

更新 2：

他们已经解决了这个问题，并将在下一次 FogBugz 更新中发布它。非常感谢 Ben Kamens、Rich Armstrong、Joel Spolsky 和 ​​Fog Creek 的其他成员！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T20:14:02.900

[在FogBugz 技术支持论坛](http://support.fogcreek.com/?fogbugz)上询问这个问题可能是个好主意。您可能必须直接进入数据库并编辑记录以删除链接。这是我的想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-29T05:50:45.377

您可能已经意识到这一点，但这个错误已在 FogBuz 版本 7 中修复（可能在版本 6 中进行了修补）。

# c# - C#：您如何处理/解析应用程序的消息，例如拖放关联的文件类型？

> ID：533749
> 
> 赞同：1
> 
> 时间：2009-02-10T19:16:19.873
> 
> 标签：c#

C#：您如何处理/解析应用程序的消息，例如拖放关联的文件类型？

假设我有一个文本文档应用程序，我希望它执行并打开一个文件，如果，

1.) 一个 .txt 文件被拖到 exe 的顶部。

我怎样才能做到这一点，执行文本软件，二，最后在文本文档软件中打开并显示文本文档？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T19:19:32.563

当有人在您的应用程序的可执行文件上拖放一个文本文件时，您的应用程序将启动，文本文件的路径将作为参数传递。您应该能够在 Main 方法中检查它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T19:24:36.140

您必须找到声明 Main 方法的位置以确保其签名包含 args 参数，然后您可以检查 args 数组，您将找到拖到应用程序 exe 上的文件的完整路径名。现在，您可以根据自己的需要使用它。

例子：

```
static void Main(String[] args)
{
    string p = args[0];

    string e = Path.GetExtension(p);
    if (e == ".txt")
    {
        // It's a text file
    }
} 
```

您还可以拖动多个文件并在同一个数组中找到它们的名称。请记住，在我的示例中，我不检查 args 数组中是否确实存在某些元素，因此如果在启动应用程序时没有拖动（或作为参数传递）并且最后使用 Path.GetExtension 方法没有，我可以获得 IndexOutOfBoundException不能向您保证该文件是您所想的，但只是它具有该扩展名。

# wpf - 如何使 RadioButton 的 Bullet 对齐顶部？

> ID：533753
> 
> 赞同：11
> 
> 时间：2009-02-10T19:17:42.380
> 
> 标签：wpf, xaml, radio-button

我有一个多行单选按钮，我希望项目符号位于内容的左侧（默认情况下），与单选按钮控件的顶部对齐。在 XAML 中执行此操作的最简单方法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-10-19T02:09:37.500

**注意**：请务必查看[Rachel 的答案](https://stackoverflow.com/a/16342879/16940)- 她将这一阶段进一步纳入通用模板

* * *

首先，不要在`VerticalAlignment`or `VerticalContentAlignment`（甚至`ControlTemplate`）上浪费时间。他们不会做你想要或可能期望的事情。

如[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.bulletdecorator%28v=vs.85%29.aspx)中所述， a `BulletDecorator`（CheckBox 和 RadioButton 用于呈现单选/复选按钮的控件）将自动设置图标的位置。您对此没有额外的控制权：

> 当子对象是文本对象时，项目符号始终与第一行文本对齐。如果子对象不是文本对象，则项目符号将与子对象的中心对齐。

除非您更改控制模板（不必要），否则您只能在内容为文本时将单选/复选图标放置在顶部。

因此，如果您执行此类操作，它看起来不会很好，因为无论`VerticalAlignment`您尝试设置多少属性，您都无法移动图标。

```
<RadioButton>
    <StackPanel>
        <TextBlock Text="First line"/>
        <TextBlock Text="Something else"/>
    </StackPanel>
</RadioButton> 
```

**但**`TextBlock`幸运的是，您可以在using中放置几乎任何您想要的东西`InlineUIContainer`。第一行中的文本（或内容）将自动指示图标的位置。如果你想要第一行下面的东西不是文本，只需使用`<Linebreak/>`然后`<InlineUIContainer/>`

这是一个超大的示例，可以`TextBox`更清楚地显示正在发生的事情。

```
<RadioButton>

    <TextBlock VerticalAlignment="Top" TextWrapping="Wrap">

        <TextBlock Text="Products with &lt;" VerticalAlignment="Center" Margin="0,0,5,0"/>

        <InlineUIContainer BaselineAlignment="Center">
            <TextBox FontSize="30" Width="25" Text="10" Margin="0,0,5,0"/>          
        </InlineUIContainer>

        <TextBlock VerticalAlignment="Center" Margin="0,0,5,0">
            <Run Text="days" FontWeight="Bold"/>
            <Run Text="inventory" />
        </TextBlock>

        <LineBreak/>    

        <InlineUIContainer>
            <StackPanel>
                <CheckBox Content="Include unsold products" />
                <CheckBox Content="Include something else" />
            </StackPanel>
        </InlineUIContainer>

    </TextBlock>
</RadioButton> 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-05-02T16:13:43.540

我根据[Simon Weaver 的回答](https://stackoverflow.com/a/7815808/302677)构建了一个相对通用的模板，可以在大多数情况下使用，而无需记住一直自定义您`RadioButton.Content`的模板。

```
<ControlTemplate x:Key="MultiLineRadioButtonTemplate" TargetType="{x:Type RadioButton}">
    <RadioButton IsChecked="{TemplateBinding IsChecked}">
        <TextBlock>
            <LineBreak />
            <InlineUIContainer>
                <ContentPresenter Margin="0,-21,0,8" 
                                  Content="{TemplateBinding ContentPresenter.Content}"
                                  ContentTemplate="{TemplateBinding ContentPresenter.ContentTemplate}"/>
            </InlineUIContainer>
        </TextBlock>
    </RadioButton>
</ControlTemplate> 
```

解释模板的工作原理：

*   之所以`TextBlock`存在，是因为默认情况下，如果内容是 Text 对象，RadioButton 项目符号将与 Text 的第一行对齐（a`Label`不起作用）

*   就是将`LineBreak`内容换行，所以创建了第一行

*   这样`InlineUIContainer`我们就可以将非文本内容放入`TextBlock`

*   是`ContentPresenter`保存实际内容，它有一个负的上边距来去除`LineBreak`对象留下的空间。

以下是一些示例内容：

```
<StackPanel>
    <RadioButton Template="{StaticResource MultiLineRadioButtonTemplate}">
        <StackPanel>
            <Label Content="Option 1" />
            <StackPanel>
                <CheckBox Content="Some setting" />
                <CheckBox Content="Some other setting" />
            </StackPanel>
        </StackPanel>
    </RadioButton>

    <RadioButton Template="{StaticResource MultiLineRadioButtonTemplate}">
        <StackPanel>
            <Label Content="Option 2" />
            <DataGrid AutoGenerateColumns="False" Height="100">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Id" />
                    <DataGridTextColumn Header="Date" />
                    <DataGridTextColumn Header="Total" />
                    <DataGridTextColumn Header="Count" />
                </DataGrid.Columns>
            </DataGrid>
        </StackPanel>
    </RadioButton>

    <RadioButton Template="{StaticResource MultiLineRadioButtonTemplate}">
        <StackPanel>
            <Label Content="Option 3" />
            <TextBlock TextWrapping="WrapWithOverflow" Margin="2">
                Lorem ipsum dolor sit amet, consectetur adipisicing elit, 
                sed do eiusmod tempor incididunt ut labore et dolore magna 
                aliqua. Ut enim ad minim veniam, quis nostrud exercitation 
                ullamco laboris nisi ut aliquip ex ea commodo consequat. 
                Duis aute irure dolor in reprehenderit in voluptate velit 
                esse cillum dolore eu fugiat nulla pariatur. Excepteur sint 
                occaecat cupidatat non proident, sunt in culpa qui officia 
                deserunt mollit anim id est laborum.
            </TextBlock>
        </StackPanel>
    </RadioButton>
</StackPanel> 
```

以及它的外观：

![在此处输入图像描述](https://i.stack.imgur.com/QBiMI.png)

我唯一真正不满意的`ContentPresenter`是硬编码的负上边距，因为如果您更改字体大小，则必须手动调整该边距。

`Margin`为计算换行符（？）的高度的属性构建一个转换器可能并不难`{TemplateBinding FontSize}`，甚至是默认情况下具有此行为的 RadioButton 控件的扩展版本，但现在我很好根据我的应用程序的默认字体大小使用硬编码 -21。

此外，如果您想从原始 继承其他属性，例如边距、填充、对齐等，您可能需要在模板中添加一些。我只是`TemplateBindings`为了保持简单而绑定。`RadioButton``RadioButton``IsChecked`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T19:19:57.820

覆盖 RadioButton 的 Control.Template。这是来自 MSDN[单选按钮控件模板示例的示例](http://msdn.microsoft.com/en-us/library/ms751600.aspx)

如果您不想覆盖单选按钮的 Control.Template，您可以将内容设置为 Wrapped TextBlock。看到这个样本

```
<RadioButton  Name="radioButton1">
    <TextBlock TextWrapping="Wrap">Here is some multiline text that does some wrapping</TextBlock>
</RadioButton> 
```

# stored-procedures - 使用 loadrunner 调用存储过程的示例脚本？

> ID：533755
> 
> 赞同：0
> 
> 时间：2009-02-10T19:18:12.753
> 
> 标签：stored-procedures, loadrunner

我对 loadrunner 很陌生。我找不到任何有关为 loadrunner 脚本运行存储过程（用于 mssql）的在线资料。它说它需要是ansi c。我什至编写了连接到 db 并调用有问题的存储过程的 ac#，然后将其用于“记录”任务。运行它后，它没有生成我希望的脚本。这是它应该如何工作的吗？我对此表示怀疑：P 帮助。请指点我一个好的网站或示例脚本。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-03T21:19:05.953

使用`lrd_*`ODBC 的函数。在这种情况下，您需要`lrd_stmt`编写 SQL 语句，然后`lrd_exec`执行它。

我不能举一个例子，因为我手头没有要记录的应用程序，但函数参考应该给你你需要的信息。

# ios - 如何在 Linux/Windows 上构建 Apple 的 GCC？

> ID：533760
> 
> 赞同：6
> 
> 时间：2009-02-10T19:19:37.633
> 
> 标签：ios, iphone, gcc

我没有Mac，但我有iPhone。我想为 iPhone 开发应用程序。经过一些研究，我认为我只需要免费 SDK 中的头文件和库，以及支持 ARM/Mach-O 的 GCC 构建。Apple 发布了 iPhone SDK 中使用的 GCC 代码（他们必须这样做），所以我认为如果我可以在 Windows 或 Linux 上构建它，我可以将它与 SDK 中的头文件和库一起使用来开发 iPhone 应用程序。

然后，我可以在任何越狱 iPhone 上安装该应用程序。

如何在任何非 Apple 机器上构建它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T19:30:26.250

查看 winchain - 此工具在 windows 上构建 iphone 链，允许您在 windows 上编译 iphone 应用程序：

[http://code.google.com/p/winchain/wiki/HowToUse](http://code.google.com/p/winchain/wiki/HowToUse)

-亚当

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T00:11:25.323

检查[适用于 Windows 的 iOS 构建环境](http://www.pmbaty.com/iosbuildenv/)。据我所知，它使用 llvm 编译器并且经常更新。您可以将它与您自己的编辑器一起使用，或者使用独立的向导来生成 Visual Studio 项目（适用于 VC++ 和 VC++ express）。唯一的缺点是它有一个演示版，完整版需要捐赠。但是，我希望您能够毫无问题地使用演示中包含的工具链。

我已经下载了演示并与我自己的项目和提供的示例一起玩。它编译得很好。不幸的是，我无法在我的设备上测试结果，因为它们目前都没有越狱。

# c# - 你如何遍历一年中的每一天？

> ID：533767
> 
> 赞同：38
> 
> 时间：2009-02-10T19:20:39.957
> 
> 标签：c#, datetime

给定 2009 年 1 月 1 日的开始日期和 2009 年 12 月 31 日的结束日期，我如何遍历每个日期并使用 c# 检索 DateTime 值？

谢谢！

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-02-10T19:24:21.430

我会使用一个看起来像这样的循环

```
for(DateTime date = begin; date <= end; date = date.AddDays(1))
{
} 
```

相应地设置开始和结束

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-02-10T19:51:21.647

**实现迭代器设计模式的另一个选项：**

这听起来可能没有必要，但我取决于你如何使用这个功能，你也可以实现[迭代器设计模式](http://en.wikipedia.org/wiki/Iterator_pattern)。

想想这个。假设一切正常，并且您将“for”句子复制/粘贴到所有地方。突然间，作为要求的一部分，您必须迭代所有的日子，但跳过其中一些（比如在日历中，跳过圣日、周末、自定义等）

您必须创建一个新的“剪辑”并改用日历。然后搜索并替换你所有的for。

在 OOP 中，这可以使用迭代器模式来实现。

来自维基百科：

> *在面向对象编程中，迭代器模式是一种设计模式，其中迭代器用于顺序访问聚合对象的元素，**而不暴露其底层表示**。Iterator 对象封装了迭代发生方式的内部结构。*

所以想法是使用这样的构造：

```
 DateTime fromDate = DateTime.Parse("1/1/2009");
        DateTime toDate   = DateTime.Parse("12/31/2009");

        // Create an instance of the collection class
        DateTimeEnumerator dateTimeRange = 
                              new DateTimeEnumerator( fromDate, toDate );

        // Iterate with foreach
        foreach (DateTime day in dateTimeRange )
        {
            System.Console.Write(day + " ");
        } 
```

然后，如果需要，您可以创建子类来实现不同的算法，一个使用 AddDay(1)，另一个使用 AddDay(7)，或者另一个简单地使用 Calendar。等等等等。

这个想法是降低对象之间的耦合。

同样，这对于大多数情况来说都是多余的，但是如果迭代形成系统的**相关**部分（比如说，您正在为企业创建某种通知，并且应该遵守不同的全球化

当然，基本实现将使用 for。

```
public class DateTimeEnumerator : System.Collections.IEnumerable
{
    private DateTime begin;
    private DateTime end;

    public DateTimeEnumerator ( DateTime begin , DateTime end ) 
    {
        // probably create a defensive copy here... 
        this.begin = begin;
        this.end = end;
    }
    public System.Collections.IEnumerator GetEnumerator()
    {
        for(DateTime date = begin; date < end; date = date.AddDays(1))
        {
            yield return date;
        }
    }
} 
```

只是一个想法:)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-10T19:23:34.677

```
DateTime dateTime = new DateTime(2009, 1, 1);    

while(dateTime.Year < 2010)
    {

      dateTime = dateTime.AddDays(1);
    } 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-10T19:44:29.027

我会使用[MiscUtil](http://pobox.com/~skeet/csharp/miscutil)及其扩展方法：

```
foreach(DateTime date in 1.January(2009)
                         .To(31.December(2009))
                         .Step(1.Days())
{
    Console.WriteLine(date);
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-10T19:24:51.817

设置两个变量：

```
DateTime lowValue = DateTime.Parse("1/1/2009");
DateTime highValue = DateTime.Parse("12/31/2009"); 
```

然后，在低值上加一天，直到等于高值：

```
while (lowValue <= highValue)
{
   //Do stuff here
   lowValue = lowValue.AddDays(1);
} 
```

或类似的东西。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-10T19:26:26.243

`int day; for (int i = 1; i<365;i++) { day++; }`

对不起，无法抗拒。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-02-07T13:07:04.120

另一种可能更可重用的方法是在 DateTime 上编写扩展方法并返回 IEnumerable。

例如，您可以定义一个类：

```
public static class MyExtensions
{
    public static IEnumerable EachDay(this DateTime start, DateTime end)
    {
        // Remove time info from start date (we only care about day). 
        DateTime currentDay = new DateTime(start.Year, start.Month, start.Day);
        while (currentDay <= end)
        {
            yield return currentDay;
            currentDay = currentDay.AddDays(1);
        }
    }
} 
```

现在在调用代码中，您可以执行以下操作：

```
DateTime start = DateTime.Now;
DateTime end = start.AddDays(20);
foreach (var day in start.EachDay(end))
{
    ...
} 
```

这种方法的另一个优点是它使得添加每个星期、每个月等变得微不足道。然后这些都可以在 DateTime 上访问。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-10T19:26:14.687

```
DateTime current = DateTime.Parse("1/1/2009");
DateTime nextYear = current.AddYears(1);
do
{
    Console.WriteLine(current);
    current = current.AddDays(1);
} while (current < nextYear) ; 
```

# c# - 重构我的 DataTable 搜索代码

> ID：533769
> 
> 赞同：0
> 
> 时间：2009-02-10T19:21:29.877
> 
> 标签：c#, search, refactoring

我正在使用 C# 2.0，我不禁认为这不是在集合（在本例中为 DataTable）搜索值的最有效方法：

```
bool found = false;
foreach (DataRow row in data.Rows)
{
    if (id == row["rowID"])
    {
        found = true;
        break;
    }
}
if (!found)
{
    //Do stuff here
} 
```

谁能想到一种“更清洁”的方式来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T19:23:38.653

查看数据表的`Select()`方法：

[http://msdn.microsoft.com/en-us/library/b5c0xc84(VS.80).aspx](http://msdn.microsoft.com/en-us/library/b5c0xc84(VS.80).aspx)

```
DataRow[] rows = data.Select("rowID=" + id.ToString());
if (rows.Length > 0)
{
    //Do stuff here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T19:25:09.697

这是一个线性搜索，它是最慢的实际搜索。

如果您想继续使用 DataTable，另一种选择是定义主键并使用 Find() 方法：

```
myTable.PrimaryKey = new DataColumn[] { new DataColumn("rowID") };
DataRow row = myTable.Find(id); 
```

# java - 为什么不鼓励在 Java EE 容器中生成线程？

> ID：533783
> 
> 赞同：123
> 
> 时间：2009-02-10T19:25:14.283
> 
> 标签：java, multithreading, jakarta-ee

关于 Java EE 开发，我学到的第一件事就是我不应该在 Java EE 容器中生成自己的线程。但是当我想到它时，我不知道原因。

你能清楚地解释为什么不鼓励它吗？

我确信大多数企业应用程序都需要某种异步作业，例如邮件守护进程、空闲会话、清理作业等。

那么，如果确实不应该产生线程，那么在需要时正确的方法是什么？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-02-10T19:43:40.620

不鼓励这样做，因为环境中的所有资源都应由服务器管理，并可能由服务器监控。此外，使用线程的大部分上下文通常附加到执行线程本身。如果您只是启动自己的线程（我相信某些服务器甚至不允许），它就无法访问其他资源。这意味着，您无法获取 InitialContext 并执行 JNDI 查找来访问其他系统资源，例如 JMS 连接工厂和数据源。

有一些方法可以“正确”地做到这一点，但这取决于所使用的平台。

[commonj WorkManager 是 WebSphere 和 WebLogic 以及其他通用的](http://web.archive.org/web/20120510185357/http://www.ibm.com/developerworks/library/specification/j-commonj-sdowmt/index.html)

[更多信息在这里](http://www.theserverside.com/discussions/thread.tss?thread_id=44353)

[和这里](http://docs.oracle.com/middleware/1212/wls/WLPRG/topics.htm#sthref219)

[从今天](https://stackoverflow.com/questions/532360/thread-in-app-server/532440#532440)早上开始也有些重复

更新：请注意，这个问题和答案与 2009 年 Java EE 的状态有关，从那时起情况有所改善！

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-02-10T23:06:58.697

对于 EJB，不仅不鼓励这样做，而且还被[规范](http://jcp.org/aboutJava/communityprocess/final/jsr220/index.html)明确禁止：

> 企业 bean 不得使用线程同步原语来同步多个实例的执行。

和

> 企业 bean 不得尝试管理线程。企业 bean 不得尝试启动、停止、挂起或恢复线程，或者更改线程的优先级或名称。企业 bean 不得尝试管理线程组。

原因是 EJB 旨在在分布式环境中运行。EJB 可能从集群中的一台机器移动到另一台机器。线程（以及套接字和其他受限设施）是这种可移植性的重大障碍。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-10T19:39:29.130

您不应该产生自己的线程的原因是这些不会由容器管理。容器处理了很多新手开发人员难以想象的事情。例如，线程池、集群、崩溃恢复等事情都是由容器执行的。当你开始一个线程时，你可能会丢失其中的一些。此外，容器允许您重新启动应用程序，而不会影响它运行的 JVM。如果有线程超出容器的控制，这怎么可能？

这就是从 J2EE 1.4 开始引入计时器服务的原因。有关详细信息，请参阅[本文](http://www.onjava.com/pub/a/onjava/2004/10/13/j2ee-timers.html)。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-10-16T13:14:25.327

# Java EE 的并发实用程序

现在有一种使用核心 Java EE API 创建线程的标准且正确的方法：

*   [JSR 236：Java™ EE 的并发实用程序](https://jcp.org/en/jsr/detail?id=236)

通过使用 Concurrency Utils，您可以确保创建新线程并由容器管理，从而保证所有 EE 服务都可用。

[这里的](https://stackoverflow.com/questions/3212255/java-ee-specification-and-multi-threading/19404307#19404307)例子

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-10T19:48:44.430

没有真正的理由不这样做。我在 web 应用程序中使用[Quarz](http://www.quartz-scheduler.org/)和[Spring](http://www.springsource.org/)没有问题。`java.util.concurrent`也可以使用并发框架。如果您实现自己的线程处理，请将 theads 设置为[deamon](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#setDaemon(boolean))或为它们使用自己的 deamon 线程组，以便容器可以随时卸载您的 webapp。

但要小心，bean 范围*会话*和*请求*在产生的线程中不起作用！此外，其他代码[`ThreadLocal`](http://docs.oracle.com/javase/6/docs/api/java/lang/ThreadLocal.html)也不能开箱即用，您需要自己将值传输到生成的线程。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-10T19:56:02.977

作为部署描述符的一部分，您始终可以告诉容器启动内容。然后，它们可以执行您需要执行的任何维护任务。

遵守规则。有一天你会很高兴你做到了:)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-12-23T10:55:10.633

根据蓝图，Java EE 容器中禁止使用线程。请参阅[蓝图](http://java.sun.com/blueprints/guidelines/designing_enterprise_applications/ejb_tier/qanda/restrictions.html) 以获取更多信息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T19:28:42.777

我从来没有读过它是气馁的，除了它不容易正确地做到这一点。

这是相当低级的编程，与其他低级技术一样，您应该有充分的理由。使用线程池等内置结构可以更有效地解决大多数并发问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-10T22:40:05.640

我发现的一个原因是，如果您在 EJB 中生成一些线程，然后尝试卸载容器或更新您的 EJB，您将遇到问题。几乎总是有另一种方法可以做一些不需要线程的事情，所以说不。

# c# - C# 无法在 Access 2007 中保存数据

> ID：533785
> 
> 赞同：1
> 
> 时间：2009-02-10T19:25:45.980
> 
> 标签：c#, ms-access, ms-access-2007

我无法在 access 2007 中保存数据。我尝试了以下方法：

*   向我的数据库添加密码；没用
*   将数据库保存为 2003 文件；没用

这是我的代码：

```
public bool ExecuteUDI(string query)
{
    Command = new OleDbCommand();
    Command.Connection = Connection;
    Command.CommandText = query;
    Command.CommandType = System.Data.CommandType.Text;
    try
    {
        // Open connection
        Open();

        if (Command.ExecuteNonQuery() != -1)
            return true;
        else
            return false;
    }
    catch (Exception e)
    {
        mError = "ExecuteUDI - " + e.Message;
        return false;
    }
    finally
    {
        // Always close connection
        Close();
    }
} 
```

当我添加断点时，我看到我的查询看起来不错：

```
INSERT INTO DVD (Titel) VALUES ('Elegy') 
```

我没有收到任何错误，但受影响的行是 0。怎么会？我不明白..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T21:32:26.003

您的 mdb 文件与您的代码相关的位置在哪里？过去我遇到过问题，即在项目文件夹中包含 mdb 文件实际上会在应用程序运行时在内存中创建 db 的本地副本，但实际上没有任何内容被写回文件夹中的 mdb ......

我建议将 mdb 文件放在项目文件夹之外。那应该行得通。

# windows - 微软 CryptoAPI 书

> ID：533803
> 
> 赞同：2
> 
> 时间：2009-02-10T19:29:43.507
> 
> 标签：windows, sockets, ssl, cryptoapi, mscapi

我需要使用 Microsoft CryptoAPI 编写自己的 SSL 套接字（CSocket ansestor）和服务器端证书验证。

你能告诉我哪本书对我有帮助（或任何其他用户友好的信息来源）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T19:41:27.677

这个指针也可能有帮助，尽管它不是一本书。 [CAPI](http://msdn.microsoft.com/en-us/library/aa380255.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T19:37:40.413

我推荐[Eric Rescorla](http://www.rtfm.com/)（[ssldump的作者）的](http://ssldump.sourceforge.net/)[SSL 和 TLS](https://rads.stackoverflow.com/amzn/click/com/0201615983)，以便更好地理解 SSL。它很好地介绍了协议及其解决的问题，并可选择深入了解细节。

我也强烈建议*不要*编写自己的实现，除非你**真的**必须这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-12T09:35:07.877

库[CSSlSocket - 启用 SSL/TLS 的 CSocket](http://www.codeproject.com/KB/IP/sslsocket.aspx)

及其工作原理[使用 Schannel 创建安全连接](http://msdn.microsoft.com/en-us/library/aa374782%28VS.85%29.aspx)

# log4net - 使用 Log4Net 将当前日期附加到日志文件

> ID：533804
> 
> 赞同：12
> 
> 时间：2009-02-10T19:30:11.773
> 
> 标签：log4net, config

我要做的就是将当前日期和时间附加到我的日志文件中，例如：

```
"export_(Wed_Feb_21_2009_at_1_36_41PM)" 
```

这是我的 app.config 中的当前配置

```
<appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
    <file value="c:\export.txt" />
    <appendToFile value="true" />
    <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
    <rollingStyle value="Size" />
    <maxSizeRollBackups value="10" />
    <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message %stackTrace%newline" />
    </layout>
</appender> 
```

是否可以将日期附加到我的日志文件中，或者它是我需要在代码中而不是配置中做的事情之一？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-12-19T07:49:18.543

生成文件名，如：

```
log_2013-12-19.txt 
```

做出改变

```
<appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
    <param name="File" value="log_"/>
    <param name="RollingStyle" value="Date"/>
    <param name="DatePattern" value="yyyy-MM-dd.\tx\t" />
    <param name="StaticLogFileName" value="false"/>
</appender> 
```

请注意参数“DatePattern”，其中 .\tx\t 使文件扩展名为 .txt。如果您提供 .txt 而不是 .\tx\t，那么如果时间是 PM，则这将保存带有扩展名 .PxP 的文件名，如果是 AM，则将保存为 .AxA。所以我用 \t 来强制写字符而不是模式。也可以添加时间以及需要什么时间模式。

所以，这可能正是***Philipp M***想要的。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-19T20:17:57.470

对于那些感兴趣的人，这里是解决方案：

```
<appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
    <param name="File" value="C:\\Users\\chris\\Documents\\log_.txt"/>
    <param name="RollingStyle" value="Date"/>
    <param name="DatePattern" value="_(yyyy.MM.dd-hh_mm_ss)"/>
    <param name="StaticLogFileName" value="false"/>
    <maximumFileSize value="100KB" />
    <appendToFile value="true" />
    <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />           
    <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message %stackTrace%newline" />
    </layout>
</appender> 
```

以及验证这一点的单元测试：

```
[Test]
public void TestLogger()
{
    logger.Info("Start Log");

    for (int i = 0; i < 2500; i++)
    {
        logger.Info(i);
    }

    logger.Info("End Log Log");
} 
```

它产生以下输出：

```
 log_.txt_(2009.02.19-01_16_34) 
```

不是我想要的，但比我以前的更好。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-12T13:02:41.280

将以下内容添加到您的配置文件中

```
<appender name="rollingFile" type="log4net.Appender.RollingFileAppender,log4net">
  <param name="File" value="c:\\ProjectX\\Log\\log.txt"/>
  <param name="AppendToFile" value="true"/>
  <lockingModel type="log4net.Appender.FileAppender+MinimalLock"/>
  <param name="RollingStyle" value="Date"/>
  <param name="DatePattern" value="yyyy.MM.dd"/>
  <param name="StaticLogFileName" value="true"/>
  <layout type="log4net.Layout.PatternLayout,log4net">
    <param name="ConversionPattern" value="%date [%thread] %-5level %logger - %message%newline"/>
  </layout>
</appender> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-03-08T08:29:58.877

如果您想使用 .log 后缀（生成类似 myLogPrefix.20160309.log 的文件），请使用：

```
<appender name="GeofenceFileAppender" type="log4net.Appender.RollingFileAppender">
        <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
        <file type="log4net.Util.PatternString" value="C:\\Logs\\myLogPrefix" />
        <appendToFile value="true" />
        <rollingStyle value="Date" />
        <datePattern value=".yyyyMMdd.lo'g'" />
        <staticLogFileName value ="false" />
        <layout type="log4net.Layout.PatternLayout">
            <conversionPattern value="%date [%thread] %-5level %logger – %message%newline" />
        </layout>
</appender> 
```

陷阱是`staticLogFileName = false`允许您即时生成汇总（而不是必须重新启动服务\服务器），`'g'`并且`datepattern`因为`g`是`datePattern`. log4net 网站上没有很好的文档来研究这个，所以它真的是从反复试验和搜索其他人的经验中获得的智慧。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T19:41:30.967

使用[StaticLogFileName](http://logging.apache.org/log4net/release/sdk/log4net.Appender.RollingFileAppender.StaticLogFileName.html)：

```
<param name="StaticLogFileName" value="true"/> 
```

# f# - 用 OcamlYacc / FsYacc 表示可选语法和重复

> ID：533808
> 
> 赞同：3
> 
> 时间：2009-02-10T19:31:12.240
> 
> 标签：f#, parsing, ocaml, ocamlyacc, fsyacc

我正在尝试在词法分析/解析语法方面建立一些技能。我正在回顾我为 SQL 编写的一个简单的解析器，但我对它并不完全满意——似乎应该有一种更简单的方法来编写解析器。

SQL 让我大吃一惊，因为它有很多可选的标记和重复。例如：

```
SELECT *
FROM t1
INNER JOIN t2
INNER JOIN t3
WHERE t1.ID = t2.ID and t1.ID = t3.ID 
```

相当于：

```
SELECT *
FROM t1
INNER JOIN t2 ON t1.ID = t2.ID
INNER JOIN t3 on t1.ID = t3.ID 
```

`ON`and子句是可选的`WHERE`，可以出现多次。我在解析器中处理这些如下：

```
%{
open AST
%}

// ...    
%token <string> ID   
%token AND OR COMMA
%token EQ LT LE GT GE
%token JOIN INNER LEFT RIGHT ON
// ...

%%

op: EQ { Eq } | LT { Lt } | LE { Le } | GT { Gt } | GE { Ge }

// WHERE clause is optional    
whereClause:
    |                       { None }
    | WHERE whereList       { Some($2) }        

whereList:
    | ID op ID                    { Cond($1, $2, $3) }
    | ID op ID AND whereList      { And(Cond($1, $2, $3), $5) }
    | ID op ID OR whereList       { Or(Cond($1, $2, $3), $5) }

// Join clause is optional    
joinList:
    |                       { [] }
    | joinClause            { [$1] }
    | joinClause joinList   { $1 :: $2 }

joinClause:
    | INNER JOIN ID joinOnClause    { $3, Inner, $4 }
    | LEFT JOIN ID joinOnClause     { $3, Left, $4 }
    | RIGHT JOIN ID joinOnClause    { $3, Right, $4 }

// "On" clause is optional    
joinOnClause:
    |                       { None }
    | ON whereList          { Some($2) }

// ...
%% 
```

换句话说，我通过将可选语法分解为单独的规则来处理可选语法，并使用递归处理重复。这行得通，但是它将解析分解为一堆小子例程，并且很难看出语法实际代表什么。

如果我可以在括号内指定可选语法并使用 * 或 + 重复，我认为编写起来会容易得多。这会将我的 whereClause 和 joinList 规则减少到以下内容：

```
whereClause:
    |                       { None }
//    $1    $2, I envision $2 being return as an (ID * op * ID * cond) list
    | WHERE [ ID op ID { (AND | OR) }]+
        { Some([for name1, op, name2, _ in $1 -> name1, op, name2]) }

joinClause:
    |                       { None }

//    $1, returned as (joinType
//                       * JOIN
//                       * ID
//                       * ((ID * op * ID) list) option) list
    | [ (INNER | LEFT | RIGHT) JOIN ID [ON whereClause] ]*
        { let joinType, _, table, onClause = $1;
          Some(table, joinType, onClause) } 
```

我认为这种形式**更**容易阅读，并且更直观地表达了它试图捕捉的语法。不幸的是，我在 Ocaml 或 F# 文档中找不到任何支持此表示法或类似内容的内容。

**在 OcamlYacc 或 FsYacc 中是否有一种简单的方法来表示具有可选或重复标记的语法？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T20:25:48.753

当你编写所有的小片段时，你应该得到你想要的东西。代替：

```
(INNER | RIGHT | LEFT ) 
```

你只有

```
inner_right_left 
```

并将其定义为这三个关键字的并集。

您还可以在词法分析器中定义联合。在您定义令牌的方式或使用camlp4 方面，我在这方面做得不多，所以我不建议您采用这些路线。而且我认为它们不会为您工作，而只是到处都有小块。

*编辑：*

因此，对于camlp4，您可以查看[Camlp4 语法模块](http://caml.inria.fr/pub/docs/manual-camlp4/manual005.html)以及[教程](http://caml.inria.fr/pub/docs/tutorial-camlp4/tutorial003.html)和[更好的教程](http://brion.inria.fr/gallium/index.php/Full_parser_tutorial)。请注意，这并不*完全*是您想要的，但它非常接近。[正如最近关于 ocaml groups](http://groups.google.com/group/fa.caml/browse_thread/thread/733c0846d6d2ead5#)的讨论所表达的那样，文档非常糟糕，但是对于这个特定领域，我认为您不会遇到太多问题。我做了一点，可以提出更多问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-26T09:28:14.307

[Menhir](http://cristal.inria.fr/~fpottier/menhir/)允许通过其他符号对非终结符号进行参数化，并提供标准快捷方式库，如选项和列表，您可以创建自己的。例子：

```
option(X): x=X { Some x} 
         | { None } 
```

还有一些语法糖，“令牌？” 相当于'option(token)'，'token+' 到'nonempty_list(token)'。

所有这些确实缩短了语法定义。它也受 ocamlbuild 支持，可以作为 ocamlyacc 的替代品。强烈推荐！

有趣的是，我也用它来解析 SQL :)

# javascript - Why does my event handler cause an "is not a function" error, but works from the Firebug console?

> ID：533817
> 
> 赞同：5
> 
> 时间：2009-02-10T19:32:46.823
> 
> 标签：javascript, jquery

Using JQuery 1.2.6, testing from Firefox 3 and IE7\. I have a very basic bit of JavaScript to reload a captcha image. In my JS file, I have:

```
var Captcha = {
    count: 0,

    Refresh: function(){
        // Concatenate "count" to force a URL change, which forces the browser to reload the image
        $('#Captcha').attr('src', 'Captcha.aspx?' + Captcha.count);
        Captcha.count++;
    }
} 
```

My link looks as follows:

```
<a href="javascript:void(0);" id="ChangeCaptcha" onclick="Captcha.Refresh();">Try a different image</a> 
```

When I click on the link, I get a JavaScript error. From the Firebug plugin for Firefox, it says "Captcha.Refresh" is not a function. So, I go to my Firebug console in the same window, and type

```
Captcha 
```

And I get an "object" in the response line (as expected). I then type

```
Captcah.Refresh 
```

And I get a function() in the response line (as expected). I then type

```
Captcha.Refresh() 
```

And it executes the function, updates my captcha image, everything is dandy. If I go back and try the link again, it still does not work. If I type in Capcha.Refresh() into the console without ever hitting the link, it also works fine. What on earth am I missing here? Clearly the JS is getting loaded, but why doesn't that function call work?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-10T19:44:42.677

The problem arises because you have an element with an id of `Captcha`, and a global variable with the same name. IE traditionally introduces a global variable for every id attribute. FF doesn't... but pretends it does in certain situations for compatibility with IE. In this case, the `click` handler sees Captcha as an element rather than your object.

### Work-arounds:

Change the id of the `Captcha` element.

Or, change the name of your global object to something other than `Captcha`.

Or, use [Pim Jager's technique](https://stackoverflow.com/questions/533817/jquery-is-not-a-function-error-but-works-from-firebug-console/533830#533830) to move interpretation of the handler into a context where the global Captcha variable has been overwritten with your own.

Or, change your `onclick` attribute to:

```
onclick="window.Captcha.Refresh();" 
```

...this will force lookup of the `Captcha` property in the context where it has been replaced by your global variable.

(all of these tested in IE6 and FF3 - i recommend Pim Jager's answer)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-10T19:37:18.153

Try sepperating the HTML and javascript:

```
$('#ChangeCaptcha').click(Captcha.Refresh); 
```

# scripting - 实时脚本语言 + MS DLR？

> ID：533820
> 
> 赞同：1
> 
> 时间：2009-02-10T19:34:43.370
> 
> 标签：scripting, xbap, dynamic-language-runtime

首先，我应该让你们知道我想要做什么。我正在处理的项目有一个需要构建自定义脚本系统的要求。这将由使用该应用程序的非程序员使用，并且应该尽可能接近自然语言。一个例子是，如果用户需要运行自定义模拟并绘制输出，他们编写的代码需要看起来像

变量 input1 为 10；变量 input2 为 20；

变量 value1 是 AVERAGE(input1, input2);

变量条件1为真；如果条件 1 则 PLOT(value1);

可能没有多大意义，但它只是一个例子。AVERAGE 和 PLOT 是我们想要定义的函数，它们不应该被允许改变它们，甚至不应该看到它们是如何工作的。DLR 可以实现这样的事情吗？如果不是，我们还有什么其他选择（从 ANTRL 开始定义语法，然后继续？）？将来这可能也需要使用 XBAP 和 WPF 运行，所以这也是我们需要考虑的问题，但在 dlr 和 xbap 上还没有看到太多。谢谢，希望这一切都有意义。

* * *

Lua 不是一种选择，因为它与他们已经习惯的不同。

Ralf，它是被动的，老实说，结果应该返回给用户的时间范围可能是 1/100 秒，一直到 2 周或一个月（非常复杂的数学函数）。

基本上，他们已经购买了一个系统，可以满足他们的一些需求，并包含一种自定义脚本语言，可以完成我上面提到的功能，他们不想学习新的，他们基本上只是希望我们复制它并添加功能。我想我会从 ANTRL 开始，然后从那里开始。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T20:03:02.087

[卢阿](http://www.lua.org)

它体积小、速度快、易于嵌入、便携、可扩展且有趣！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T20:10:12.503

Lua 绝对是软实时系统（如电脑游戏）的最佳选择。请参阅[http://shootout.alioth.debian.org/](http://shootout.alioth.debian.org/)了解详细的基准。

然而，上次我检查时，Lua 使用了一个标记和清除垃圾收集器，这可能导致实时系统中的截止日期违规和非确定性抖动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T20:42:50.337

我相信您理论上可以使用 DLR，但我不确定在 XBAP（部分信任？）场景中的支持。

如果您托管 DLR，您将很快能够利用 IronRuby 或 IronPython 脚本。在创建自己的语言实现时，您可能希望查看这些实现。如果您将问题发布到[IronPython 邮件列表](http://lists.ironpython.com/listinfo.cgi/users-ironpython.com)，我相信您会在 XBAP 场景中得到更好的答复，并且那里的一些开发人员创建了[ToyScript](http://blogs.msdn.com/mmaly/archive/2008/01/08/building-a-dlr-language-toyscript.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T19:54:17.677

首先，我认为定义自己的语言*不是*要走的路。

*   主要是因为您可以为程序员或非程序员获得的最大生产力收益*是*开发工具。你（和我们其他 99.9% 的人）不会编写出像他们的工具那样好的工具。
*   语言设计**很难**。
*   语言支持和文档，也很难

我建议寻找预先构建的解决方案。如果您能找到一种可以锁定某些功能的语言，那将是一个很好的起点。MatLab 将是我想到的第一个。

最后，抛弃自然语言部分，BASIC、COBOL 和[YA-TDWTF-Lang](http://thedailywtf.com/Articles/The-Expert-System.aspx)都尝试过，但都失败了。

* * *

全面披露：我为一家正在开发通用领域特定语言“系统”的公司工作。它的目标是数据输入/文本输出应用程序，所以它不是合适的，它还不是测试版。结果是我有些知识和偏见。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T19:56:33.443

您要满足什么样的实时要求？模拟是否是硬实时模拟（某种硬件在环模拟 ==> 截止时间小于 1/1000 秒）？或者您是否希望脚本系统对用户输入“反应”==> 1/10 就足够了。

我不是 MS DLR 方面的专家，但据我所知，它不支持硬实时系统。您可能想查看 Java 的实时规范 (RTSJ)

# c# - UpdatePanel中的ListBox在选择底部的项目后跳转到顶部？

> ID：533823
> 
> 赞同：0
> 
> 时间：2009-02-10T19:35:31.963
> 
> 标签：c#, asp.net, updatepanel

这只发生在 Internet Explorer 中。我有一个在 UpdatePanel 中的 ListBox。ListBox 中有大约 100 个项目，它显示一次可见 15 个。它们从 1 到 100 排序。如果我滚动到底部并选择项目编号 50，项目 50 保持选中状态，但 ListBox 跳回列表顶部，因此它显示项目 1 到 15。这只发生在IE浏览器。如果我在 FireFox 中执行此操作，仍会显示所选项目，它只是成为列表中最后一个可见项目，即项目 15。有谁知道解决方案以及为什么会发生这种情况？

谢谢， XaiSoft

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T19:43:17.140

尝试`MaintainScrollPositionOnPostBack="true"`在您的 Page 指令中设置 ( `<%@ page %>`)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T19:58:15.373

发生这种情况是因为当 UpdatePanel 更新时，它会删除所有现有内容（控件）并从服务器发送的 HTML 中重新创建它们。控制值包含在更新中，但不包含滚动位置等内容。我能想到的唯一解决方案是在回发之前使用javascript记录滚动位置，然后在更新面板完成更新后恢复它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-29T13:41:28.200

这个问题似乎已经在这篇文章中得到了回答：

[在更新面板的列表框中保持滚动位置，而不是页面](https://stackoverflow.com/questions/543131/maintain-scroll-position-in-listboxes-in-updatepanels-not-the-page)

# c# - 文件 security.config.cch 对 CLR 有什么作用？

> ID：533824
> 
> 赞同：6
> 
> 时间：2009-02-10T19:35:51.777
> 
> 标签：c#, .net, clr

在我的机器上调试 VS2008、SP1 时，我遇到了令人讨厌的锁定问题。我正在运行 ProcMon.exe 来尝试确定发生了什么。我看到的一件事是对名为 security.config.cch 和 security.config.cch.new 的文件进行 100 次或 1000 次重复读取 + 写入。

这些文件是什么？为什么我的应用程序需要反复读取 + 写入此文件？

谢谢，戴夫

例子 ：

```
2:18:14.1421944 PM App.vshost.exe 1152 ReadFile C:\Documents and Settings\myuser\Application Data\Microsoft\CLR Security Config\v2.0.50727.42\security.config.cch 成功偏移：170,397，长度：208
2:18:14.1422854 PM App.vshost.exe 1152 ReadFile C:\Documents and Settings\myuser\Application Data\Microsoft\CLR Security Config\v2.0.50727.42\security.config.cch 成功偏移：170,605，长度：224
2:18:14.1423824 PM App.vshost.exe 1152 WriteFile C:\Documents and Settings\myuser\Application Data\Microsoft\CLR Security Config\v2.0.50727.42\security.config.cch.new SUCCESS 偏移量：206,817，长度: 208
2:18:14.1424843 PM App.vshost.exe 1152 WriteFile C:\Documents and Settings\myuser\Application Data\Microsoft\CLR Security Config\v2.0.50727.42\security.config.cch.new SUCCESS 偏移量：207,025，长度: 224
2:18:14.1425788 PM App.vshost.exe 1152 WriteFile C:\Documents and Settings\myuser\Application Data\Microsoft\CLR Security Config\v2.0.50727.42\security.config.cch.new 成功偏移：207,249，长度: 12
2:18:14.1426746 PM App.vshost.exe 1152 ReadFile C:\Documents and Settings\myuser\Application Data\Microsoft\CLR Security Config\v2.0.50727.42\security.config.cch 成功偏移：170,841，长度：220
2:18:14.1427679 PM App.vshost.exe 1152 ReadFile C:\Documents and Settings\myuser\Application Data\Microsoft\CLR Security Config\v2.0.50727.42\security.config.cch 成功偏移：171,061，长度：224

```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-11-17T12:11:18.960

`security.config.cch`文件及其变体（`security.config.cch.new`等`security.config.cch.[random numbers]`）是**安全解析缓存文件**。

这些文件本质上是应用程序代码的[CAS（代码访问安全）需求的缓存。](http://msdn.microsoft.com/en-us/library/930b76w0%28VS.71%29.aspx)它们允许 CLR 的内置安全系统稍微更快地解决代码的安全需求。

您可以安全地删除这些文件，这将导致您的应用程序下一次的初始性能稍慢，但是，CLR 安全子系统最终会重新生成这些文件。

此过程可能会出现一个已知问题，[“修复：当您尝试运行使用 .NET Framework 2.0 构建的 Web 应用程序时出现错误消息：“发生了巨大的变化”](http://support.microsoft.com/kb/913297/en-us)但是，这适用于 .NET Framework 2.0 并且可能适用于 .NET Framework 3.5 SP1（您与 VS2008 SP1 一起使用）可能仍然适用，也可能不适用。

对这些文件进行多次读/写是完全正常的，但是，如果读/写看起来过多并且您遇到锁定的地步，我会考虑查看您的代码（假设您有很多电话要求[特定的安全操作](http://msdn.microsoft.com/en-us/library/60zfc754%28loband%29.aspx)或等效操作），或检查[.NET Framework 配置工具 (Mscorcfg.msc)](http://msdn.microsoft.com/en-us/library/2bc0cxhc.aspx)中设置的[运行时安全策略](http://msdn.microsoft.com/en-us/library/t0385k7y.aspx)的配置。

# c# - 如何获取程序集中的所有基本类型？

> ID：533831
> 
> 赞同：1
> 
> 时间：2009-02-10T19:37:35.453
> 
> 标签：c#, .net, reflection

所以如果我有一个实例

```
System.Reflection.Assembly 
```

我有以下模型：

```
class Person {}
class Student : Person {}
class Freshman : Student {}
class Employee : Person {}
class PersonList : ArrayList {}
class StudentList : PersonList {} 
```

如何枚举程序集的类型以仅获取对 Person 和 PersonList 类型的引用？

需要明确的是：我不想在此查找期间明确指定 Person 或 PersonList 类型。Person 和 PersonList 只是在此示例的相关程序集中定义的根类型。我正在寻找一种通用方法来枚举给定程序集的所有根类型。

感谢您的时间:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T19:40:02.530

怎么样：

```
var rootTypes = from type in assembly.GetTypes()
                where type.IsClass && type.BaseType == typeof(object)
                select type; 
```

? 或者用非 LINQ 术语：

```
foreach (Type type in assembly.GetTypes())
{
    if (type.IsClass && type.BaseType == typeof(object))
    {
        Console.WriteLine(type);
    }
} 
```

编辑：不，那不会发现 PersonList。您需要更清楚地了解“根”的定义。您实际上是指“其基本类型不在同一个程序集中的任何类型”吗？如果是这样的话：

```
var rootTypes = from type in assembly.GetTypes()
                where type.IsClass && type.BaseType.Assembly != assembly
                select type; 
```

# google-analytics - 我可以在我的网站的博客子域中使用与主网站相同的 Google Analytics 标记吗？

> ID：533835
> 
> 赞同：4
> 
> 时间：2009-02-10T19:39:37.553
> 
> 标签：google-analytics

我的 site.com 和 blog.mysite.com 在不同的 IP 地址上。我可以对两个网站使用相同的 Google Analytics ID 吗？谷歌分析是否查看记录的访问者信息来自哪个 IP 地址？如果没有，是什么阻止随机网站包含您的 Google 分析标签并向您的帐户发送随机数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T19:43:28.623

您必须稍微修改一下您的脚本标签。Google 的常见问题解答包括： [http ://www.google.com/support/analytics/bin/answer.py?hl=en&answer=55524](http://www.google.com/support/analytics/bin/answer.py?hl=en&answer=55524)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-27T08:59:38.350

您可以在任何网站（任何域名、任何 IP）上运行任何 UA-XXXXX-YY，它将以您的个人资料统计信息结尾。

是的，如果某些网站将您的 UA id 放在其网站上，您的统计数据可能会完全混乱。

为了防止这种情况，您可以在您的 GA 配置文件上设置一个包含过滤器，并通过在主机名字段上使用类似“www.domain1.com|www.domain2.com|www.domain2.com”的正则表达式仅包含您的域名.

请注意，包含过滤器是独占的（如果字段主机名上有 3 个包含过滤器，则只会应用第一个过滤器）。

另一种方法是根据主机名创建一个高级细分，您将获得大致相同的结果，但如果您拥有大量受众，则可能会受到数据采样影响。但它允许事后快速修复，而在遇到麻烦之前需要设置过滤器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T19:43:24.097

当然。您可以对两者使用相同的。您将能够按域名细分流量。

# ruby - Ruby中的每个自动计数器？

> ID：533837
> 
> 赞同：136
> 
> 时间：2009-02-10T19:40:52.950
> 
> 标签：ruby, syntax

我想使用一个 for-each 和一个计数器：

```
i=0
for blah in blahs
    puts i.to_s + " " + blah
    i+=1
end 
```

有更好的方法吗？

**注意：**我不知道`blahs`是数组还是哈希，但必须这样做`blahs[i]`不会让它更性感。另外我想知道如何用`i++`Ruby编写。

* * *

从技术上讲，Matt 和 Squeegy 的答案排在第一位，但我对 paradoja 给出了最佳答案，所以在 SO 上分散了一些要点。他的回答也有关于版本的注释，这仍然是相关的（只要我的 Ubuntu 8.04 使用 Ruby 1.8.6）。

* * *

应该使用`puts "#{i} #{blah}"`更简洁的。

* * *

## 回答 #1

> 赞同：193
> 
> 时间：2009-02-10T19:57:07.480

正如人们所说，您可以使用

```
each_with_index 
```

但是，如果您想要具有不同于“each”的迭代器的索引（例如，如果您想使用索引或类似的东西进行映射），您可以使用 each_with_index 方法连接枚举器，或者简单地使用 with_index：

```
blahs.each_with_index.map { |blah, index| something(blah, index)}

blahs.map.with_index { |blah, index| something(blah, index) } 
```

这是您可以在 ruby​​ 1.8.7 和 1.9 中执行的操作。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2009-02-10T19:46:54.120

```
[:a, :b, :c].each_with_index do |item, i|
  puts "index: #{i}, item: #{item}"
end 
```

你不能用 for 来做到这一点。无论如何，我通常喜欢对每个人进行更具声明性的调用。部分原因是当您达到 for 语法的限制时，它很容易转换为其他形式。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-10T19:46:15.200

是的，就是`collection.each`做循环，然后`each_with_index`获取索引。

您可能应该阅读一本 Ruby 书籍，因为这是 Ruby 的基础知识，如果您不了解它，您将遇到大麻烦（尝试： http: [//poignantguide.net/ruby/](http://poignantguide.net/ruby/)）。

摘自 Ruby 源代码：

```
 hash = Hash.new
 %w(cat dog wombat).each_with_index {|item, index|
   hash[item] = index
 }
 hash   #=> {"cat"=>0, "wombat"=>2, "dog"=>1} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-05-19T01:11:26.397

如果您没有新版本的`each_with_index`，可以使用该[`zip`](http://ruby-doc.org/core/classes/Enumerable.html#M003138 "可枚举#zip")方法将索引与元素配对：

```
blahs = %w{one two three four five}
puts (1..blahs.length).zip(blahs).map{|pair|'%s %s' % pair} 
```

产生：

```
1 one
2 two
3 three
4 four
5 five 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-16T16:05:36.883

至于你关于做的问题`i++`，好吧，你不能在 Ruby 中做到这一点。你的`i += 1`陈述正是你应该做的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-11T00:06:50.797

枚举可[枚举](http://www.globalnerdy.com/tag/enumerable/ "枚举可枚举")系列非常好。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-08-27T14:26:48.607

如果你想获得每个红宝石的索引，那么你可以使用

```
.each_with_index 
```

这是一个展示如何`.each_with_index`工作的示例：

```
range = ('a'..'z').to_a
length = range.length - 1
range.each_with_index do |letter, index|
    print letter + " "
    if index == length
        puts "You are at last item"
    end
end 
```

这将打印：

```
a b c d e f g h i j k l m n o p q r s t u v w x y z You are at last item 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T19:48:29.843

如果`blahs`是一个混合了 Enumerable 的类，你应该能够做到这一点：

```
blahs.each_with_index do |blah, i|
  puts("#{i} #{blah}")
end 
```

# visual-studio - Visual Studio 中的 complex.h 解决方法

> ID：533849
> 
> 赞同：1
> 
> 时间：2009-02-10T19:44:08.417
> 
> 标签：visual-studio, visual-c++

经过一番搜索，我发现 Microsoft Visual Studio 没有提供“complex.h”头文件，但我有一些 C 代码不幸使用了它。我尝试过使用`<complex>`和编译为 C++ 代码；这需要改变

```
complex 
```

至

```
_complex 
```

我什至不知道我需要改变什么

```
long complex 
```

至。有什么想法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T19:49:23.897

你试过[这个链接](http://www.download3k.com/Software-Development/Components-Libraries/Download-CMATH-for-Visual-C.html)吗？

* * *

如果您不能使用第三方库，那么我认为您将不得不自己重新实现复杂的功能。好消息是最复杂的数学实际上很容易编写，除非你需要一些相当高级的功能。

# sql - 如何返回当天写的最新行？

> ID：533856
> 
> 赞同：3
> 
> 时间：2009-02-10T19:45:17.963
> 
> 标签：sql, sql-server

我有一个带有 FooId 和 CreatedTime 列的表。白天，可以为同一个 FooId 插入多行。CreatedTime 列表示插入时的时间。

我想要一个查询，它将返回给定日期的最新行（例如 2000-01-01）。有没有办法编写一个可以使用 SQL Server 2005 执行此操作的查询？

以下是我期望的数据和结果的示例。**我想要当天创建的最新数据。**所以 MAX(CreatedDate) 不起作用。谢谢！

```
FooId   Data  CreatedTime
---------------------------
1       A     2000/01/01 12:00:00
1       B     2000/01/01 12:12:00
1       C     2000/01/01 12:25:00
2       A     2000/01/01 12:00:00
2       B     2000/01/01 12:26:00
3       A     2000/01/01 12:00:00 
```

结果

```
FooId   Data  CreatedTime
---------------------------
1       C     2000/01/01 12:25:00
2       B     2000/01/01 12:26:00
3       A     2000/01/01 12:00:00 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T19:52:01.910

当然它适用于 MAX

因为你没有提供 DDL 和 DML 语句，所以我使用了我已经放置的东西

运行这个

```
 CREATE TABLE #MaxVal(id INT,VALUE varchar(10),SomeDate DATETIME)
    INSERT #MaxVal VALUES(1,'a','2009-02-10 14:48:45.143')
    INSERT #MaxVal VALUES(1,'b','2009-02-10 13:48:45.143')
    INSERT #MaxVal VALUES(1,'c','2009-02-10 11:48:45.143')
    INSERT #MaxVal VALUES(2,'d','2009-02-10 11:48:45.143')
    INSERT #MaxVal VALUES(2,'e','2009-02-10 12:48:45.143')
    INSERT #MaxVal VALUES(2,'f','2009-02-10 13:48:45.143')
    INSERT #MaxVal VALUES(3,'g','2009-02-10 11:48:45.143')
    INSERT #MaxVal VALUES(3,'h','2009-02-10 14:48:45.143')

SELECT t.* FROM(
    SELECT id,MAX(SomeDate) AS MaxValue
    FROM #MaxVal
    WHERE SomeDate >='2009-02-10'
        AND SomeDate < '2009-02-11'
    GROUP BY id) x
    JOIN #MaxVal t ON x.id =t.id
    AND x.MaxValue =t.SomeDate 
```

输出

```
id  VALUE   SomeDate
3   h   2009-02-10 14:48:45.143
2   f   2009-02-10 13:48:45.143
1   a   2009-02-10 14:48:45.143 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T19:49:19.387

因为要求改变了，所以在没有警告的情况下删除你的旧帖子是不是有点粗鲁？你不能把它关掉，这样人们就不会想知道发生了什么吗？

无论如何，**这是更新的答案：**

```
SELECT Foo.* 
FROM Foo
JOIN (
  SELECT FooId, MAX(CreatedTime) 
  FROM Foo Q
  -- Only change the dates in the next line.
  WHERE Q.CreatedTime >= '20000101' AND Q.CreatedTime < '20000102'
  GROUP BY Q.FooId, DATEADD(day, DATEDIFF(day, '19000101', Q.CreatedTime), '19000101')
) Q2 (FooID, CreatedTime) ON Q2.FooID = Foo.FooID AND Q2.CreatedTime = Foo.CreatedTime
ORDER BY FooID 
```

**结果**

```
FooId   Data    CreatedTime
1   C   2000-01-02 12:25:00.000
2   B   2000-01-02 12:26:00.000
3   A   2000-01-02 12:00:00.000 
```

**DDL**

```
CREATE TABLE Foo (FooId int NOT NULL, Data varchar(10), CreatedTime datetime NOT NULL)

INSERT INTO Foo VALUES (1, 'A', '2000-01-01 12:00:00')
INSERT INTO Foo VALUES (1, 'B', '2000-01-01 12:12:00')
INSERT INTO Foo VALUES (1, 'C', '2000-01-01 12:25:00')
INSERT INTO Foo VALUES (2, 'A', '2000-01-01 12:00:00')
INSERT INTO Foo VALUES (2, 'B', '2000-01-01 12:26:00')
INSERT INTO Foo VALUES (3, 'A', '2000-01-01 12:00:00')

INSERT INTO Foo VALUES (1, 'A', '2000-01-02 12:00:00')
INSERT INTO Foo VALUES (1, 'B', '2000-01-02 12:12:00')
INSERT INTO Foo VALUES (1, 'C', '2000-01-02 12:25:00')
INSERT INTO Foo VALUES (2, 'A', '2000-01-02 12:00:00')
INSERT INTO Foo VALUES (2, 'B', '2000-01-02 12:26:00')
INSERT INTO Foo VALUES (3, 'A', '2000-01-02 12:00:00') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T20:15:50.340

整天都试试这个：

```
SELECT FooId, Max(CreatedTime)
FROM Foo
GROUP BY FooId, cast(CreatedTime as int) 
```

对于给定的一天，请执行以下操作：

```
SELECT FooId, Max(CreatedTime)
FROM Foo
WHERE CreatedTime >= '2000-01-01' and CreatedTime < '2000-01-02'
GROUP BY FooId, cast(CreatedTime as int) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T19:47:34.167

您可能希望有一个计算列或另一个仅存储日期的列。在此之后，查询将是微不足道的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T19:48:43.867

这可以在 SqlServer2005 中工作吗？

```
SELECT FoodId, Data, CreatedTime WHERE CreatedTime=max(CreatedTime) GROUP BY FoodId, day(CreatedTime) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T19:51:35.093

```
select data 
 from fooTable 
 where CreatedTime between <beginning of day> and <end of day> 
 order by CreatedTime DESC 
 limit 1 
```

大概是这样的吧？未经测试，从我的头顶上掉下来。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T19:51:45.280

试试这个...

```
select f1.FooID, f1.Data, f1.CreatedTime
from Foo f1
inner join
(
    select f2.FooID, max(f2.CreatedTime) as CreatedTime
    from Foo f2
    where f2.CreatedTime >= '2000-01-01' and f2.CreatedTime < '2000-01-02'
    group by f2.FooID
) f3
on f3.FooID = f1.FooID
and f3.CreatedTime = f1.CreatedTime
order by 1, 2, 3 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-10T20:50:50.003

**select** top 1 *
**from** foo
**where** CreatedTime between @today and @tomorrow
**order by** CreatedTime desc

（@today 和 @tomorrow 是您想​​要的日期范围的占位符。）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-11T10:45:03.197

```
select x.FooId, x.Data, x.CreatedTime
from (select FooId,
             Data,
             CreatedTime,
             row_number() over (partition by FooId
                                order by CreatedTime desc) as rn
       from Foo
       where CreatedTime >= ...
          and CreatedTime < ...) as x
where x.rn = 1
order by FooId 
```

# c# - 使用局部变量重构的最佳实践

> ID：533858
> 
> 赞同：3
> 
> 时间：2009-02-10T19:45:53.327
> 
> 标签：c#, refactoring

我一直在花一些时间重构我的 C# 代码，我对局部变量的参数列表变得如此之大感到震惊，尤其是当您开始深入多个级别并且必须从调用堆栈的更高层传递局部变量时。

例如，我有一些使用 Linq to sql 的相当复杂的代码。我在过程的早期实例化数据上下文并在整个过程中使用它。但是，在重构之后，我发现我在所有子方法中都传递了这个 DC，以及其他各种状态变量。

当然，一种解决方案是将这些局部变量变成成员变量，但这会使整个类成为非线程安全的，并且在处理异步 i/o 时，这意味着使用锁和互斥锁来破坏事物以使其安全。

在考虑局部变量时，您的最佳实践是什么？你让他们成为会员吗？还是您随身携带国家行李？还是你做别的事情？

编辑：我不确定您需要更多详细信息。我不想转储一堆代码，因为从本质上讲，为了说明这一点，我必须展示一组非常复杂的程序。

我有许多局部变量，例如 Linq to Sql DC、处理的各个阶段、处理并写入数据库的大量原始数据的各个更新阶段。

我考虑过创建一个状态上下文并传递它，但这对我来说似乎有点骇人听闻，尽管我想这正是 Linq to SQL dc 的内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T19:51:41.147

不要*将*它们变成成员/全局变量。即使没有多线程，它们也使关于应用程序状态的推理变得更加困难 - 正如您所说，它变成了一场彻头彻尾的噩梦。

如果您注意到某些参数总是以组的形式传递，您可以尝试将它们折叠成简单的对象并传递它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T19:49:03.740

潜在地，使它们成为另一种类型的成员。嵌套类型在这里也能很好地工作。如果它们形成一个逻辑组，并让您使用相同的类型编写多个方法，那将很有意义。

除此之外，我们必须知道你正在做什么的细节才能进一步评论我怀疑。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T19:57:17.420

取决于项目。我试图以单一职责规则为目标，它允许我像疯子一样进行重构。

It happens I create dummy holder classes to hold the information I need to pass around. I don't like to have more than 1 or 2 parameters for my methods either but it depends on how important the information is and most of all how important the project is.

# vb.net - 在 VB.NET 中编写缓存函数

> ID：533861
> 
> 赞同：0
> 
> 时间：2009-02-10T19:46:38.443
> 
> 标签：vb.net, caching

我仍在学习 VB.NET，通常我只是用谷歌搜索我的问题，但这次我真的不知道要寻找什么，所以我会在这里尝试。

尝试编写一个以缓存键为参数并返回缓存对象的函数。那里没有问题，但我不知道如何将类型传递给函数以与 TryCast 一起使用，这样我就不必对返回的结果执行此操作。

到目前为止，这是我的功能，??? 将被以某种方式传递给函数的类型替换。

```
Public Function GetCache(ByVal tag As String) As Object
    Dim obj As Object = Nothing
    Dim curCache As Object = TryCast(System.Web.HttpContext.Current.Cache(tag), ???)
    If Not IsNothing(curCache) Then
        Return curCache
    Else
        Return Nothing
    End If
End Function 
```

我这样做是完全错误的还是我只是错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T19:53:23.450

使用泛型：

```
Public Function GetCache(Of T)(ByVal tag As String) As T
    Return CType(System.Web.HttpContext.Current.Cache(tag), T)
End Function 
```

更新：
编辑为使用 CType，因为 trycast 仅适用于引用类型。但是，如果强制转换失败，这可能会引发异常。您可以处理异常，在进行强制转换之前检查类型，或者将代码限制为引用类型，如下所示：

```
Public Function GetCache(Of T As Class)(ByVal tag As String) As T
    Return TryCast(System.Web.HttpContext.Current.Cache(tag), T)
End Function 
```

# svn - 服务器迁移后如何更新所有 svn:externals 引用？

> ID：533863
> 
> 赞同：1
> 
> 时间：2009-02-10T19:46:53.717
> 
> 标签：svn, properties, migration, svn-externals, externals

我今天迁移了一个 SVN 服务器并遇到了问题。我有一个在主干子文件夹上有 svn:externals 属性的仓库。这个文件夹已经分支了很多次，现在这个 svn:externals 引用需要在每个分支上更新以引用新服务器。

有没有一种简单的方法来更新所有这些属性？

我对手动单独更新它们并不感到兴奋。

我也在 Windows 上，所以花哨的[bash 脚本](http://www.thomaskeller.biz/blog/2009/01/05/change-svnexternals-quickly/)不起作用。一定有更简单的方法！

注意：这是从 svn:externals 引用必须是绝对的 1.5 之前的旧版本开始的。

* * *

更新：一个简单的`relocate`不会这样做，因为这些是绝对 URL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T19:50:13.740

SVN Relocate 会起作用吗？

它在存储库移动时使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T20:23:58.960

您可以安装 Cygwin 并使用您链接到的 bash 脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-19T22:05:03.487

我会为此使用[SvnDumpTool 。](http://svn.borg.ch/svndumptool/)请参阅[其他](https://stackoverflow.com/questions/204616/how-to-migrate-all-urls-in-svnexternals-properties-across-a-repository)有更多讨论的线程。

# asp.net - 在 ASP.NET 中强制缓存过期的最佳方法是什么？

> ID：533867
> 
> 赞同：10
> 
> 时间：2009-02-10T19:47:23.480
> 
> 标签：asp.net, caching, outputcache

假设我有一个 ASP.NET 应用程序在负载平衡器后面的多个 Web 服务器上运行：

我可以吗：

*   强制 OutputCache（页面和/或控制级别）全局过期？

*   强制数据缓存（即 Cache.Insert）过期？

*   从中央位置监控 ASP.NET 缓存使用情况（密钥、RAM 等）？

一种可能的解决方案是让缓存的每次使用都检查文件依赖关系是否有更改。可以触摸该文件，这将使所有缓存过期。但是，这要求开发人员在他们的所有代码中都包含依赖项。他们是更好的解决方案吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-10T21:31:16.257

有很多方法可以使这些缓存过期，例如 page outputcache by

```
Page.Response.Cache.SetCacheability(HttpCacheability.NoCache) 
```

基于时间的依赖只是在定义的时间点使项目过期。

```
Response.Cache.SetExpires(DateTime.Now.AddSeconds(360));
Response.Cache.SetCacheability(HttpCacheability.Private)
Response.Cache.SetSlidingExpiration(true); 
```

现在说到监控缓存，除非缓存上有API告诉你，否则没有直接的办法。

您当然可以枚举缓存、键值对，然后计算存储的每个项目的大小。听起来不容易吧？？

所以[这里是](http://www.aspalliance.com/CacheManager/Default.aspx)为了让你的缓存监控变得容易。坦率地说我自己从未使用过它，但是您可以尝试一下，只需将 dll 添加到您的应用程序中即可。

这是您的缓存键视图，

```
' display contents of the ASP.NET Cache
If Cache.Count > 0 Then    
  cc.Append("<b>Contents of the ASP.NET Cache (" _    
          & Cache.Count.ToString() & " items):</b><br />")    
  For Each item As Object In Cache    
    cc.Append("Key:'" & item.Key & "' Type:" _    
            & item.Value.GetType().ToString() & "<br />")    
  Next    
Else    
  cc.Append("<b>ASP.NET Cache is empty</b>")    
End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T20:59:58.497

来自[Tek-Tips](http://www.tek-tips.com/faqs.cfm?fid=1034)（阅读链接了解详细说明）

```
Response.Expires = 15
Response.ExpiresAbsolute = Now() - 2
Response.AddHeader "pragma","no-cache"
Response.AddHeader "cache-control","private"
Response.CacheControl = "private" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T11:17:05.603

[http://msdn.microsoft.com/en-us/library/y18he7cw(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/y18he7cw(v=vs.100).aspx)

```
Response.Cache.SetExpires(DateTime.Now.AddSeconds(60));
Response.Cache.SetCacheability(HttpCacheability.Public);
Response.Cache.SetValidUntilExpires(true); 
```

# c# - 如何获得装配中的所有底部类型？

> ID：533872
> 
> 赞同：0
> 
> 时间：2009-02-10T19:48:26.973
> 
> 标签：c#, .net, reflection

[这是这个](https://stackoverflow.com/questions/533831/how-do-i-get-all-the-base-types-in-an-assembly)问题的姐妹问题

如果我有一个实例

```
System.Reflection.Assembly 
```

我有以下模型：

```
class Person {}
class Student : Person {}
class Freshman : Student {}
class Employee : Person {}
class PersonList : ArrayList {}
class StudentList : PersonList {} 
```

如何枚举程序集的类型以获取对 Employee、Freshman 和 StudentList 的引用？

我希望能够像上面的示例一样枚举任何给定程序集的所有底部类型。

谢谢你的时间 ：）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T19:51:03.767

因此，您想查找程序集中没有其他类型派生的所有类型，对吗？

（为了可读性而重构。）

```
var allTypes = assembly.GetTypes();
var baseTypes = allTypes.Select(type => type.BaseType);
var bottomTypes = allTypes.Except(baseTypes); 
```

（如果您想要 .NET 2.0 版本，请告诉我。会更痛苦。）

# sql - SQL - Informix - 将列的数据类型从数字更改为字符

> ID：533879
> 
> 赞同：1
> 
> 时间：2009-02-10T19:49:06.487
> 
> 标签：sql, types, informix, alter

我有一个临时表，其中一列中有数字整数值。我想根据某些条件将整数值替换为字符值，或者我想添加另一列字符类型，该列会根据某些条件自动将值插入自身。

如果 x <= 1，更改为“SP”或创建新列并将“SP”存储在该行中
如果 x > 1，更改为“FA”或创建新列并将“FA”存储在该行中

此外，更改命令是在我的 Informix 版本中不允许在临时表上使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T20:27:22.853

SELECT id, yr, CASE WHEN yr_offset <= 1 THEN "SP" ELSE "FA" END CASE

[http://publib.boulder.ibm.com/infocenter/idshelp/v10/index.jsp?topic=/com.ibm.sqls.doc/sqls909.htm](http://publib.boulder.ibm.com/infocenter/idshelp/v10/index.jsp?topic=/com.ibm.sqls.doc/sqls909.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T20:39:26.240

你是对的，你不能改变临时表。可以使用`CASE`语句添加具有此派生值的额外列，即：

```
SELECT enroll.ud, enroll.yr, (CASE
   WHEN enrollsess.yr_offset <=1 THEN "FA"
   ELSE "SP" END)::CHAR(2) AS sess, ... 
```

强制转换（即括号和`::CHAR(2)`）可能不是必需的。

如果逻辑可以表示为零/非零（在您的示例中不清楚 yr_offset 是否可以为负），那么它就更简单了：

```
SELECT enroll.id, enroll.yr,
     DECODE(enrollsess.yr_offset, 0, "FA", "SP")::CHAR(2) AS sess, ... 
```

[手册中有关 CASE 语法的更多详细信息](http://publib.boulder.ibm.com/infocenter/idshelp/v10/index.jsp?topic=/com.ibm.sqls.doc/sqls909.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T19:56:50.960

```
SELECT          enrollsess.id,
                enrollsess.yr,
                "SP" sess
FROM            enrollsess
WHERE           enrollsess.yr_offset <= 1
UNION
SELECT          enrollsess.id,
                enrollsess.yr,
                "FA" sess
FROM            enrollsess
WHERE           enrollsess.yr_offset > 1
INTO            TEMP enrollsess2 WITH NO LOG; 
```

# c# - 是否有一种内置方法可以将多个文件作为一个流处理？

> ID：533881
> 
> 赞同：6
> 
> 时间：2009-02-10T19:49:18.360
> 
> 标签：c#, .net

我有一个文件列表，我需要按特定顺序将它们分别读取到给定大小的字节 [] 中。对于单个文件，这本身不是问题，简单的*while ((got = fs.Read(piece, 0,pieceLength)) > 0)*可以完美地完成工作。文件的最后一部分可能比期望的要小，这很好。

现在，有一个棘手的问题：如果我有多个文件，我需要有一个连续的流，这意味着如果文件的最后一段比pieceLength 小，那么我需要读取下一段的 (pieceLength-got)文件，然后继续进行，直到最后一个文件结束。

所以本质上，给定 X 个文件，我总是会读取长度正好是pieceLength 的片段，除了最后一个文件的最后一个片段，它可能更小。

我只是想知道.net（3.5 SP1）中是否已经有一些东西可以解决问题。我目前的方法是创建一个获取文件列表的类，然后公开一个`Read(byte[] buffer, long index, long length)`函数，类似于 FileStream.Read()。这应该很简单，因为我不必更改读取数据的调用代码，但在我重新发明轮子之前，我只想再次检查轮子是否尚未内置到 BCL 中。

谢谢 ：）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-10T19:54:25.163

我不相信框架中有任何东西，但我建议让它更灵活一点——`IEnumerable<Stream>`在你的构造函数中取一个，并从`Stream`你自己派生。然后要获取文件流，您可以（假设 C# 3.0）只需执行以下操作：

```
Stream combined = new CombinationStream(files.Select(file => File.Open(file)); 
```

“所有权”部分在这里有点棘手 - 上面将允许组合流获得它读取的任何流的所有权，但您*可能*不希望它必须遍历所有其余流并关闭它们，如果*它是*提前关闭。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-03-30T12:41:48.307

这是我根据@jon skeet 的想法提出的。

~~它只是实现了 Read 这对我来说已经足够了。（但我不需要帮助来实现 BeginRead/EndRead 方法。）~~这是包含同步和异步的完整代码 - Read 和 BeginRead/EndRead

[https://github.com/facebook-csharp-sdk/combination-stream/blob/master/src/CombinationStream-Net20/CombinationStream.cs](https://github.com/facebook-csharp-sdk/combination-stream/blob/master/src/CombinationStream-Net20/CombinationStream.cs)

```
internal class CombinationStream : System.IO.Stream
{
    private readonly System.Collections.Generic.IList<System.IO.Stream> _streams;
    private int _currentStreamIndex;
    private System.IO.Stream _currentStream;
    private long _length = -1;
    private long _postion;

    public CombinationStream(System.Collections.Generic.IList<System.IO.Stream> streams)
    {
        if (streams == null)
        {
            throw new System.ArgumentNullException("streams");
        }

        _streams = streams;
        if (streams.Count > 0)
        {
            _currentStream = streams[_currentStreamIndex++];
        }
    }

    public override void Flush()
    {
        if (_currentStream != null)
        {
            _currentStream.Flush();
        }
    }

    public override long Seek(long offset, System.IO.SeekOrigin origin)
    {
        throw new System.InvalidOperationException("Stream is not seekable.");
    }

    public override void SetLength(long value)
    {
        this._length = value;
    }

    public override int Read(byte[] buffer, int offset, int count)
    {
        int result = 0;
        int buffPostion = offset;

        while (count > 0)
        {
            int bytesRead = _currentStream.Read(buffer, buffPostion, count);
            result += bytesRead;
            buffPostion += bytesRead;
            _postion += bytesRead;

            if (bytesRead <= count)
            {
                count -= bytesRead;
            }

            if (count > 0)
            {
                if (_currentStreamIndex >= _streams.Count)
                {
                    break;
                }

                _currentStream = _streams[_currentStreamIndex++];
            }
        }

        return result;
    }

    public override long Length
    {
        get
        {
            if (_length == -1)
            {
                _length = 0;
                foreach (var stream in _streams)
                {
                    _length += stream.Length;
                }
            }

            return _length;
        }
    }

    public override long Position
    {
        get { return this._postion; }
        set { throw new System.NotImplementedException(); }
    }
    public override void Write(byte[] buffer, int offset, int count)
    {
        throw new System.InvalidOperationException("Stream is not writable");
    }

    public override bool CanRead
    {
        get { return true; }
    }

    public override bool CanSeek
    {
        get { return false; }
    }

    public override bool CanWrite
    {
        get { return false; }
    }
} 
```

也可作为 NuGet 包提供

```
Install-Package CombinationStream 
```

# javafx - 您对 JavaFX 有什么感受？

> ID：533895
> 
> 赞同：10
> 
> 时间：2009-02-10T19:52:00.833
> 
> 标签：javafx, ria

我目前在 ActionScript 3.0 方面做了很多工作，我也喜欢用 Java 编程。JavaFX 是否适合我？JavaFX 的总体感觉是什么，它会成为一个强大的公司，还是走上与 Java Applets 相同的道路？与我一起工作的设计师能否像熟悉 ActionScript 和 JavaScript 一样熟悉 JavaFX？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-05T00:32:44.210

只是想添加我的 $.02 美元...在过去的 4 天里，我一直在 JavaFX 中工作，这是我第一个使用它的小项目。作为一些背景，我从事专业编程已经有大约 9 年了，从 C 开始，在过去的 6 年里一直在做 Java 和 C#/.NET。

IMO，JavaFX 的方式更令人沮丧。以下是一些抱怨：

1.  语法有时很奇怪。它很容易更像 Java，因为它的*Java* FX。但是语法并不是从 Java 轻松过渡的。

2.  .fx 文件中项目的*顺序*实际上很重要，这意味着您会遇到愚蠢的循环引用错误，以及编译器应该轻松处理的“哦，您还不能使用此变量，因为它尚未初始化”的问题，但没有。

3.  随机的东西是行不通的。Swing 控件上的操作/事件并不总是有效，例如 SwingSliderBar 的 onKeyPressed/released 似乎没有被调用。

4.  错误处理很*糟糕*。如果发生了未处理的异常，除了 Java 控制台之外没有其他真正的方法可以判断，并且 UI 元素开始做出有趣的反应。例如，制作一个 SwingText 框并将其值绑定到一个变量。现在尝试编辑文本框中的值将引发异常，因为您无法编辑绑定变量。然而在 UI 中，文本框刚刚开始发生有趣的事情。有些字符只有 1/2 绘制，有时退格不做任何事情，有时它会删除一个字符，有时你可以在键盘上按 2 个键，如“1”和“2”，文本框最终会输入“21”而不是“12”等...

尽管我现在 JavaFX 开发的绝对 #1 问题是**Netbeans**。JFX 的表现非常糟糕。无法调试，错误在 IDE 中显示错误（我已经将注释标记为错误！），智能仅在 40% 的情况下工作，事件他在 IDE 中为拖放控件预编程的代码模板是'正确。我忘记了是哪一个，但是其中一个在插入的代码末尾添加了一个“&”，该代码永远无效，并且总是必须手动删除……这简直*太糟糕*了，对于像 Sun 这样的公司来说是不可接受的。

另一个抱怨是一般文档。它只是缺乏。不知何故，在搜索方法/类时，JavaFX API 甚至没有成为谷歌搜索结果的第一名。网络上的大量“示例”不再起作用，因为每个版本都有重大的重构更改，并且类被删除或重命名。

总的来说，我给 JFX 打 4 分（满分 10 分）。我*想*喜欢它，但 JFX 1.1 并没有削减它……它绝对不是我认为的“生产就绪”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T21:20:09.357

一声响亮的“嗯”。

一年前我看到它时，他们有一个单向 SVG 到 JavaFx 的转换工具。太好了，因此您可以创作一次视觉内容，用很多行为对其进行标记，然后下次您想让它看起来不错，然后呢？

如果您看一下[本教程](http://javafx.com/docs/gettingstarted/javafx/create-first-javafx-app.jsp)，您就会明白我的意思。我们通过将形状从调色板拖到源代码中来绘制东西。天哪。我没有向我的图形部门展示它。

我希望我对 JavaFx 的看法是错误的，但我认为他们不明白。拜托，Sun 的某个人不会给我们一个没有与代码密不可分地交织在一起的表示层吗？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-17T21:13:58.847

我离开了我的上一份工作，从 Java 转向 .NET 开发。

做出这一举动的原因有很多，但最大的一个原因是我厌倦了尝试使用 Java 和 Swing 构建一流的 UI 软件。已经六年了，我很高兴我继续前进。我认为没有理由相信 Sun 最终会理解使用 JavaFX 进行 UI 开发。

我相信微软最终会为我们提供一个在浏览器中构建丰富的交互式应用程序的平台。我说，在 13 年前构建了作为 Netscape 插件交付的商用软件之后，随后是 ActiveX 控件和 Java Applet，并且看到所有这些平台由于某种原因未能在企业中普及。

我意识到 Silverlight 2 仍然缺乏深度和成熟度，但微软在这一点上向我展示了足够的承诺，我相信它将在短短几年内成为主导 RIA 平台——至少对于需要“真正”编程的项目而言语。我确信 Flash 等人。不会很快消失，但 Flash 不适合我公司构建的那种软件。

对我来说锦上添花的是，我仍然可以使用 Visual Studio、C# 和我当前的大部分代码库（与 UI 完全分离的核心引擎）。当然，如果您来自 ActionScript，这对您没有帮助。

更重要的一点是 Silverlight 和 WPF 有很多共同点。我们的计划是在我们软件的 Silverlight 和 WPF 版本之间共享大量实现。WPF 成为 Windows 应用程序的标准只是时间问题——我不知道那是几年还是十年，但它显然会随着时间的推移而发生。能够从相同的代码库定位最流行的浏览器/操作系统与 Silverlight 和 Windows 是 IMO 的巨大优势。

如果您了解 Java，那么迁移到 C# 是小菜一碟。除非您使用的是不错的（非免费）Java IDE 之一，否则即使是免费版本的 Visual Studio 也会比您习惯的有所改进。障碍将是学习使用 XAML 做事的新方法——但这是一些非常酷的东西，因此您可能会真正喜欢它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T21:11:15.040

如果您了解 Java，但想做您认为仅在 Flash 中可行的事情 - 那么是的，JavaFX 对您有好处。

毫无疑问，将您的 Java 知识与设计内容结合起来会容易得多。

而且我相信工具只会变得更好，这将使其更易于使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-10T21:35:44.170

除非您正在开发内部应用程序，否则我会远离它。用户通常不希望必须处理完成与 Flash 相同的事情的另一个程序。我认为它的安装基数还不够大，不足以方便最终用户。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-10T20:10:06.950

尽管它在功能方面看起来相当强大，但由于它的结构和实现，我对 JavaFX 有点不屑一顾。进入 Flash/Silverlight 市场似乎是一次半心半意的尝试。太剧本了。

我会赞成走 Silverlight 2 路线，但我主要是 C# 开发人员，所以我有点偏颇。如果您出于某种原因不喜欢这条路线，但仍希望为您的用户提供更丰富的 UX，我建议您使用 Flex；对我来说，它似乎比 JavaFX 组织得更好。

只是我在这个问题上的两分钱。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-04-09T18:15:38.183

我已经使用 Flex 开发 Flash 应用程序大约 2 年了，我决定尝试 JavaFX，因为我们不断收到用户抱怨他们无法使用他们的 iPhone 上的应用程序（我喜欢 Java）。

这是对 Flash 的一次打击（没有广泛的移动支持）。

老实说，JavaFX 给我留下了深刻的印象（以一种非常糟糕的方式）。

*   文档不完整。
*   剧本简直糟透了；它是 JSON 和 R 之间的这种奇怪的混合，带有一种 Java 似曾相识的感觉。
*   我花了前 3 天的时间用 CODE 绘制多边形并制作渐变...... WTF！
*   我试图说服我的图形部门尝试它，但他们根本不了解生产套件应该如何工作，他们一直抱怨 Flex 蒙皮很容易，最终看起来更好（这绝对是真的）。
*   “CSS 支持”简直是个糟糕的笑话。
*   通常感觉像是为 RIA 前端提供一个选项的平庸尝试。

我只能想到一些关于它的好处：

*   它可以从 iPhone / iPad 和几乎所有的移动设备上运行。
*   考虑到 ActionScript 的限制（没有重载、没有私有构造函数等），您可以访问所有想要的 Java 代码。这对我们程序员来说是一件好事，但让我们记住这是一种前端/演示技术......这意味着用户必须实际看到这个东西，所以如果它看起来不太好并且很酷他们不会挖掘它的动画/效果。
*   脚本不像 MXML 文件那样冗长（代价是难以理解）。
*   谈论性能... Flash Player 是一个巨大的绿色 blob，与 JavaFX 的运行方式相比，它不断增长，直到没有剩余 RAM（JVM 摇摆不定！不幸的是，这与实际的 JavaFX API 无关，只是 JVM .. . 它摇摆不定！）。
*   它有一个很酷的功能，您可以在其中将小程序拖到 Web 浏览器之外。

最后，我很高兴我可以选择使用移动设备，但这是 Flex/Flash 在 RIA 应用程序方面所取得的成熟度的光年。Flex/Flash 作为一种广泛分布的网络技术的未来尚不清楚（它可能最终只用于烦人的横幅和在线游戏），没有人愿意依赖像 Flash Player 这样的封闭技术，这就是为什么整个网络社区正在努力使 Flash 脱离图片（HTML5 视频支持、Apple 设备没有 Flash Player 等）。因此，开放式的尝试总是受到欢迎，只是 JavaFX 感觉就像是 Sun 觉得有义务在周末宿醉期间提出的一个不完整的匆忙测试版。

我希望这对某人有用（并且对 Sun/Oracle =p 的某人感到冒犯）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-29T17:34:25.143

I've spent the weekend 'playing with it. I see nothing useful in it. It's a iteration of swing / awt. I guess it will be nice for mobile devices but beyond that its nothing useful.

Ideally I'd like to use flash but find it painful to intergrate with a backend of any type.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-02-20T09:37:50.453

好吧，ActionScript 和 JavaFX 的语法似乎有很多相似之处，所以可能是“是”。

我现在正在学习 JavaFX 脚本，我真的很喜欢它。但我不喜欢的可能是它最大的缺点是它的文档很糟糕，通常不是最新的或不完整的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-08-17T13:19:56.683

我已经在 J​​avaFX 应用程序上工作了几个月了。就个人而言，我喜欢这种语言。在我看来，他们在选择语法和语言结构方面做出了一些非常明智的决定（如果你愿意，我可以给你列出一个清单）。我已经用它编程了几个月，它似乎是一种非常有效甚至令人愉快的编程语言。

我认为它现在最好的用途是用于桌面应用程序和/或通过 webstart 部署的应用程序。在桌面上，它具有丰富的功能集，并且仍然可以利用 Swing 的其他功能和 Java 的其余部分。据我所知，一些系统上的小程序仍然很慢，而且如果没有 Android 支持，移动功能就没有功能。在我看来，applet/mobile/TV/web 支持更像是对桌面开发人员的奖励，而不是让您使用该技术的关键功能。

所以这真的完全取决于你打算用它做什么。如果您正在构建想要在 Java VM 上运行的桌面应用程序，这些应用程序可以使用简单的多媒体和丰富的 ui 控件，那么我认为有充分的理由来研究这种语言。WebStart 有了很大的改进，是一个很好的部署工具。如果您正在寻找构建 Web 应用程序，那么它可能会很有趣，但现在我会说 HTML5/ajax 更相关（在这种情况下您可能想查看 ZK）。然而，即使使用 HTML5 ajax 也有其局限性，如果您发现自己遇到了它们，那么 JavaFX 可能会为您提供选择。对于移动平台，除非有稳定的 Android 支持，否则它不会相关——在这种情况下，我现在只坚持使用 Android 平台本身。

# msmq - Microsoft 消息队列缺少消息

> ID：533898
> 
> 赞同：0
> 
> 时间：2009-02-10T19:52:17.197
> 
> 标签：msmq

我正在使用 C# 和 .Net Framework 1.1（是的，它很旧，但我继承了这些东西并且无法转换）。我将消息放在事务队列上，但大约 50% 的时间它不会进入队列。运行安装了所有服务包的工作组和 Windows/XP Professional。我也没有在死信队列中看到任何消息。

任何想法在哪里看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T23:34:20.563

如果它根本没有进入队列并且没有进入死信队列，则表明该项目没有被发送到队列。您应该能够通过打开队列的日志来确认是这种情况。

假设它没有进入队列，它可能是一个事务问题。我会检查您是否每次都将消息提交到队列中。确保没有任何异常被抛出和吞下，导致事务回滚或永远不会被提交（本质上是同一件事）。还要确保没有任何条件语句意味着提交被跳过。

我会在事务启动、提交和回滚的每个位置以及您正在创建消息的任何位置周围添加一些日志记录。然后，您可以查看您的日志以查看事件的顺序并查看发生了什么误会。

另一种选择是删除所有事务代码并针对非事务队列测试代码。如果消息全部出现，那么这是一个事务性问题。如果不是，则问题在其他地方。

我经常使用 MSMQ，我从经验中学到的一件事是它工作得非常好，弱点是我 :-)

# hibernate - 使休眠不包括选择子句中连接表中的字段

> ID：533901
> 
> 赞同：5
> 
> 时间：2009-02-10T19:52:56.477
> 
> 标签：hibernate

我在使用 Hibernate 的 DetachedCriteria 的 SQL 中遇到了性能问题。我有几个多对一的关系，当 Hibernate 生成 SQL 时，它包括来自在 FROM 中连接的表中的所有字段。发生这种情况时，MySQL 会花费很长时间来运行查询（其中还有一个 order by 和 sub query 添加到问题中）。对于我目前的 50k 记录 ~6sec。当我将 SELECT 中不必要的字段删除为我关心的域对象时，它的运行时间低于 500 毫秒。

有没有办法告诉 Hibernate 不要包含连接中的字段？

我尝试将映射文件中的 fetch 参数设置为“join”和“select”，这对生成的 SQL 没有任何影响。

我也尝试过设置不同的根条目，但从我读过的内容来看，这不适用于分页（我也在这样做）。

我可以尝试将查询编写为 HQL，但使用子查询只会让人头疼。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T21:44:47.410

您可以设置一个 Projection，其中仅包含您感兴趣的属性列表。

以下是过去项目的示例：

```
Criteria criteria = getSession().createCriteria(Something.class);
criteria.createCriteria("user", "u");

// only retrieve the following fields: id, state, viewCount, user.username
ProjectionList properties = Projections.projectionList();
properties.add(Projections.property("id"));
properties.add(Projections.property("state"));
properties.add(Projections.property("viewCount"));
properties.add(Projections.property("u.username"));

criteria.setProjection(properties); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-27T12:51:11.923

我有同样的问题，听起来很奇怪，没有办法做到这一点。这听起来很常见，使用 JOIN 进行过滤，但不加载整个关联实体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T11:11:53.087

您是否尝试为不想加载的类设置 Lazy = true ？

# asp.net - LINQ注入无效字符

> ID：533902
> 
> 赞同：0
> 
> 时间：2009-02-10T19:53:01.470
> 
> 标签：asp.net, linq, iis-7

我们目前正在从 Server 2003 迁移到 Server 2008。我们的 ASP.NET 应用程序有一些不同的环境更改。我们的测试环境此时运行良好，但是具有相同代码的生产机器正在将无效字符注入 SQL。

以下是我通过 SQL Server Profiler 看到的 SQL。

```
exec sp_executesql N'SELECT [t0].[VenuePDID], [t0].[VenueID], [t0].[VenueNumber], [t0].[MarketID], [t0].[ProgramID], [t0].[VenueTypeID], [t0].[SalesTypeID], [t0].[BackBarPaymentID], [t0].[Goal], [t0].[LocationTypeID], [t0].[VenueStatus], [t0].[Tab1ConfirmDate], [t0].[Tab1ConfirmedBy], [t0].[Tab2ConfirmDate], [t0].[Tab2ConfirmedBy], [t0].[DateContractRequested], [t0].[ContractRequestedBy], [t0].[ContractTypeRequested], [t0].[ContractAmtRequested], [t0].[ContractAmtLimit], [t0].[ContractSalesAmtRequested], [t0].[ContractSalesAmtMax], [t0].[ContractPerVistAmtLimit], [t0].[ContractSalesPerVisitAmtLimit], [t0].[ActiveDate], [t0].[InactiveDate], [t0].[WebsiteRejected], [t0].[ResponsibleGM], [t0].[CreateDate], [t0].[CreatedBः㐈   [1]     
[1] 볧इ퀄㐀޼SELECT [t0].dBy], [t0].[timestamp], [t0].[DetailConfirmDate], [t0].[DetailConfirmBy], [t0].[SalesConfirmDate], [t0].[SalesConfirmBy], [t0].[ContractTypeId]
FROM [dbo].[tbl_VenueProgramDetails] AS [t0]
WHERE ([t0].[VenueID] = @p0) AND ([t0].[ProgramID] = @p1)',N'@p0 int,@p1 int',@p0=7477,@p1=27 
```

我已经从工作测试环境中复制了所有的 dll，我得到了同样的结果。我还将测试网络服务器指向实时数据库并且代码有效。我已经将实时 Web 服务器指向测试数据库，并且代码像上面一样失败。此时问题必须与生产服务器上的 IIS7 配置或 .Net 相关。我似乎无法指出它。有没有人见过这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T20:59:19.340

问题最终是网卡驱动程序。物理机不是配置或代码的问题。

编辑：我遇到问题的机器是带有 Broadcom 网卡的 HP DL360。我们将就该问题与惠普联系。通过网络发送 LINQ 请求时，数据包组装错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T02:08:44.140

> 创建dB\u0903\u3408 [1] \uffff

那不是真正的 Unicode... U+FFFF 明确地不是 Unicode 字符，首先！

似乎有东西在你的记忆的任意位上吐出二进制损坏。这不会很有趣，因为它很可能是令人不快的低级别。您的应用程序或生产机器上的 ISAPI 扩展是否使用了任何可疑的非托管组件？（甚至是其他的钩子，比如狡猾的杀毒软件？）

# python - 得到一系列列表的笛卡尔积？

> ID：533905
> 
> 赞同：428
> 
> 时间：2009-02-10T19:54:17.177
> 
> 标签：python, list, cartesian-product

如何从一组列表中获取笛卡尔积（每个可能的值组合）？

输入：

```
somelists = [
   [1, 2, 3],
   ['a', 'b'],
   [4, 5]
] 
```

期望的输出：

```
[(1, 'a', 4), (1, 'a', 5), (1, 'b', 4), (1, 'b', 5), (2, 'a', 4), (2, 'a', 5) ...] 
```

* * *

## 回答 #1

> 赞同：518
> 
> 时间：2009-02-10T19:58:01.287

### [`itertools.product`](https://docs.python.org/3/library/itertools.html#itertools.product)

可从 Python 2.6 获得。

```
import itertools

somelists = [
   [1, 2, 3],
   ['a', 'b'],
   [4, 5]
]
for element in itertools.product(*somelists):
    print(element) 
```

这与，

```
for element in itertools.product([1, 2, 3], ['a', 'b'], [4, 5]):
    print(element) 
```

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2009-02-10T19:58:31.380

```
import itertools
>>> for i in itertools.product([1,2,3],['a','b'],[4,5]):
...         print i
...
(1, 'a', 4)
(1, 'a', 5)
(1, 'b', 4)
(1, 'b', 5)
(2, 'a', 4)
(2, 'a', 5)
(2, 'b', 4)
(2, 'b', 5)
(3, 'a', 4)
(3, 'a', 5)
(3, 'b', 4)
(3, 'b', 5)
>>> 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2009-02-10T20:38:16.883

对于 Python 2.5 及更早版本：

```
>>> [(a, b, c) for a in [1,2,3] for b in ['a','b'] for c in [4,5]]
[(1, 'a', 4), (1, 'a', 5), (1, 'b', 4), (1, 'b', 5), (2, 'a', 4), 
 (2, 'a', 5), (2, 'b', 4), (2, 'b', 5), (3, 'a', 4), (3, 'a', 5), 
 (3, 'b', 4), (3, 'b', 5)] 
```

这是一个递归版本`product()`（只是一个插图）：

```
def product(*args):
    if not args:
        return iter(((),)) # yield tuple()
    return (items + (item,) 
            for items in product(*args[:-1]) for item in args[-1]) 
```

例子：

```
>>> list(product([1,2,3], ['a','b'], [4,5])) 
[(1, 'a', 4), (1, 'a', 5), (1, 'b', 4), (1, 'b', 5), (2, 'a', 4), 
 (2, 'a', 5), (2, 'b', 4), (2, 'b', 5), (3, 'a', 4), (3, 'a', 5), 
 (3, 'b', 4), (3, 'b', 5)]
>>> list(product([1,2,3]))
[(1,), (2,), (3,)]
>>> list(product([]))
[]
>>> list(product())
[()] 
```

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2016-11-21T08:42:02.477

我会使用列表理解：

```
somelists = [
   [1, 2, 3],
   ['a', 'b'],
   [4, 5]
]

cart_prod = [(a,b,c) for a in somelists[0] for b in somelists[1] for c in somelists[2]] 
```

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2009-02-10T20:01:26.440

使用[itertools.product](http://docs.python.org/library/itertools.html#itertools.permutations)：

```
import itertools
result = list(itertools.product(*somelists)) 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2013-06-14T06:08:27.080

这是一个递归生成器，它不存储任何临时列表

```
def product(ar_list):
    if not ar_list:
        yield ()
    else:
        for a in ar_list[0]:
            for prod in product(ar_list[1:]):
                yield (a,)+prod

print list(product([[1,2],[3,4],[5,6]])) 
```

输出：

```
[(1, 3, 5), (1, 3, 6), (1, 4, 5), (1, 4, 6), (2, 3, 5), (2, 3, 6), (2, 4, 5), (2, 4, 6)] 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-02-10T20:02:47.047

在 Python 2.6 及更高版本中，您可以使用“itertools.product”。在旧版本的 Python 中，您可以使用文档中的以下（几乎 - 参见文档）等效[代码](http://docs.python.org/library/itertools.html#itertools.product)，至少作为起点：

```
def product(*args, **kwds):
    # product('ABCD', 'xy') --> Ax Ay Bx By Cx Cy Dx Dy
    # product(range(2), repeat=3) --> 000 001 010 011 100 101 110 111
    pools = map(tuple, args) * kwds.get('repeat', 1)
    result = [[]]
    for pool in pools:
        result = [x+[y] for x in result for y in pool]
    for prod in result:
        yield tuple(prod) 
```

两者的结果都是一个迭代器，所以如果你真的需要一个列表进行进一步处理，请使用`list(result)`.

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2017-02-21T04:03:40.493

尽管已经有很多答案，但我想分享一些我的想法：

## 迭代方法

```
def cartesian_iterative(pools):
  result = [[]]
  for pool in pools:
    result = [x+[y] for x in result for y in pool]
  return result 
```

## 递归方法

```
def cartesian_recursive(pools):
  if len(pools) > 2:
    pools[0] = product(pools[0], pools[1])
    del pools[1]
    return cartesian_recursive(pools)
  else:
    pools[0] = product(pools[0], pools[1])
    del pools[1]
    return pools
def product(x, y):
  return [xx + [yy] if isinstance(xx, list) else [xx] + [yy] for xx in x for yy in y] 
```

## Lambda 方法

```
def cartesian_reduct(pools):
  return reduce(lambda x,y: product(x,y) , pools) 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2018-12-31T18:32:17.293

**递归方法：**

```
def rec_cart(start, array, partial, results):
  if len(partial) == len(array):
    results.append(partial)
    return 

  for element in array[start]:
    rec_cart(start+1, array, partial+[element], results)

rec_res = []
some_lists = [[1, 2, 3], ['a', 'b'], [4, 5]]  
rec_cart(0, some_lists, [], rec_res)
print(rec_res) 
```

**迭代方法：**

```
def itr_cart(array):
  results = [[]]
  for i in range(len(array)):
    temp = []
    for res in results:
      for element in array[i]:
        temp.append(res+[element])
    results = temp

  return results

some_lists = [[1, 2, 3], ['a', 'b'], [4, 5]]  
itr_res = itr_cart(some_lists)
print(itr_res) 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-12-10T01:40:56.937

对上述可变变量风格的递归生成器解决方案的小修改：

```
def product_args(*args):
    if args:
        for a in args[0]:
            for prod in product_args(*args[1:]) if args[1:] else ((),):
                yield (a,) + prod 
```

当然还有一个包装器，使它的工作方式与该解决方案完全相同：

```
def product2(ar_list):
    """
    >>> list(product(()))
    [()]
    >>> list(product2(()))
    []
    """
    return product_args(*ar_list) 
```

有**一个折衷**：它检查递归是否应该在每个外循环上中断，并且**一个收获**：空调用时不产生，例如`product(())`，我认为这在语义上会更正确（参见文档测试）。

关于列表推导：数学定义适用于任意数量的参数，而列表推导只能处理已知数量的参数。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-10-29T22:28:11.077

只是补充一点已经说过的内容：如果您使用 sympy，则可以使用符号而不是字符串，这使得它们在数学上很有用。

```
import itertools
import sympy

x, y = sympy.symbols('x y')

somelist = [[x,y], [1,2,3], [4,5]]
somelist2 = [[1,2], [1,2,3], [4,5]]

for element in itertools.product(*somelist):
  print element 
```

关于[同情](http://sympy.com)。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-01-04T07:26:43.827

我相信这有效：

```
def cartesian_product(L):  
   if L:
       return {(a,) + b for a in L[0] 
                        for b in cartesian_product(L[1:])}
   else:
       return {()} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-09-16T23:13:20.507

这可以做一个

```
[(x, y) for x in range(10) for y in range(10)] 
```

另一个变量？没问题：

```
[(x, y, z) for x in range(10) for y in range(10) for z in range(10)] 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-07-17T13:11:10.067

以下代码是[Using numpy to build an array of all combination of two arrays](https://stackoverflow.com/a/1235363/11154841)的 95% 副本，所有学分都在那里！据说这要快得多，因为它仅在 numpy 中。

```
import numpy as np

def cartesian(arrays, dtype=None, out=None):
    arrays = [np.asarray(x) for x in arrays]
    if dtype is None:
        dtype = arrays[0].dtype
    n = np.prod([x.size for x in arrays])
    if out is None:
        out = np.zeros([n, len(arrays)], dtype=dtype)

    m = int(n / arrays[0].size) 
    out[:,0] = np.repeat(arrays[0], m)
    if arrays[1:]:
        cartesian(arrays[1:], out=out[0:m, 1:])
        for j in range(1, arrays[0].size):
            out[j*m:(j+1)*m, 1:] = out[0:m, 1:]
    return out 
```

如果您不想从所有条目的第一个条目中获取 dtype，则需要将 dtype 定义为参数。如果您有字母和数字作为项目，请使用 dtype = 'object'。测试：

```
somelists = [
   [1, 2, 3],
   ['a', 'b'],
   [4, 5]
]

[tuple(x) for x in cartesian(somelists, 'object')] 
```

出去：

```
[(1, 'a', 4),
 (1, 'a', 5),
 (1, 'b', 4),
 (1, 'b', 5),
 (2, 'a', 4),
 (2, 'a', 5),
 (2, 'b', 4),
 (2, 'b', 5),
 (3, 'a', 4),
 (3, 'a', 5),
 (3, 'b', 4),
 (3, 'b', 5)] 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-12-12T01:36:54.383

列表理解简单明了：

```
import itertools

somelists = [
   [1, 2, 3],
   ['a', 'b'],
   [4, 5]
]
lst = [i for i in itertools.product(*somelists)] 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2021-01-27T11:53:12.767

# 早期拒绝：

```
def my_product(pools: List[List[Any]], rules: Dict[Any, List[Any]], forbidden: List[Any]) -> Iterator[Tuple[Any]]:
    """
    Compute the cartesian product except it rejects some combinations based on provided rules

    :param pools: the values to calculate the Cartesian product on 
    :param rules: a dict specifying which values each value is incompatible with
    :param forbidden: values that are never authorized in the combinations
    :return: the cartesian product
    """
    if not pools:
        return

    included = set()

    # if an element has an entry of 0, it's acceptable, if greater than 0, it's rejected, cannot be negative
    incompatibles = defaultdict(int)
    for value in forbidden:
        incompatibles[value] += 1
    selections = [-1] * len(pools)
    pool_idx = 0

    def current_value():
        return pools[pool_idx][selections[pool_idx]]

    while True:
        # Discard incompatibilities from value from previous iteration on same pool
        if selections[pool_idx] >= 0:
            for value in rules[current_value()]:
                incompatibles[value] -= 1
            included.discard(current_value())

        # Try to get to next value of same pool
        if selections[pool_idx] != len(pools[pool_idx]) - 1:
            selections[pool_idx] += 1
        # Get to previous pool if current is exhausted
        elif pool_idx != 0:
            selections[pool_idx] = - 1
            pool_idx -= 1
            continue
        # Done if first pool is exhausted
        else:
            break

        # Add incompatibilities of newly added value
        for value in rules[current_value()]:
            incompatibles[value] += 1
        included.add(current_value())

        # Skip value if incompatible
        if incompatibles[current_value()] or \
                any(intersection in included for intersection in rules[current_value()]):
            continue

        # Submit combination if we're at last pool
        if pools[pool_idx] == pools[-1]:
            yield tuple(pool[selection] for pool, selection in zip(pools, selections))
        # Else get to next pool
        else:
            pool_idx += 1 
```

我有[一个案例](https://github.com/odoo/odoo/pull/65089)，我必须获取一个非常大的笛卡尔积的第一个结果。尽管我只想要一件物品，但这需要很长时间。问题在于，由于结果的顺序，它必须遍历许多不需要的结果才能找到正确的结果。因此，如果我有 10 个包含 50 个元素的列表，并且前两个列表中的第一个元素不兼容，则它必须遍历最后 8 个列表的笛卡尔积，尽管它们都会被拒绝。

此实现能够在结果包含每个列表中的一项之前对其进行测试。因此，当我检查某个元素是否与先前列表中已包含的元素不兼容时，我会立即转到当前列表的下一个元素，而不是遍历以下列表的所有产品。

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2020-12-12T21:42:07.903

您可以`itertools.product`在标准库中使用来获取笛卡尔积。其他很酷的相关实用程序`itertools`包括`permutations`、`combinations`和`combinations_with_replacement`. 这是下面代码片段的 python codepen[的链接：](https://polylang.io/#/python?id=bc8aa0249fdb4cd2b9ce2d647b1f9217)

```
from itertools import product

somelists = [
   [1, 2, 3],
   ['a', 'b'],
   [4, 5]
]

result = list(product(*somelists))
print(result) 
```

# testing - 是否有工具可以根据 j/nunit 结果创建历史报告

> ID：533908
> 
> 赞同：1
> 
> 时间：2009-02-10T19:55:24.537
> 
> 标签：testing, report

寻找一种获得关于以下内容的可视化报告的方法：

1.  一段时间内的总体测试成功百分比（有关测试是否以及如何快速变得更环保的信息）
2.  随着时间的推移可视化单个测试结果（很容易注意到长时间变绿的测试变红，反之亦然，注意刚刚变绿的测试）
3.  任何其他有利于测试人员和整个项目的可视化统计数据

基本上是一个工具，它可以从整个测试结果目录生成结果，而不仅仅是单次（每日）运行。

一般来说，它似乎可以使用 XSLT 来完成，但同时处理多个文件似乎没有太大的灵活性。

这样的工具是否已经存在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T20:01:07.143

我敢于宣称大多数持续集成引擎（例如[Hudson（用于 Java））](http://hudson-ci.org/)本身或通过插件提供此类功能。在 Hudson 的案例中，已经有一些代码覆盖插件可用，*我认为*它会自动从单元测试中自动生成基本图表。

哦，记得正确配置 CI，例如我们的 Hudson 每 10 分钟轮询一次 CVS，如果它看到任何更改，它会执行所有相关的技巧（获取更新的 .java 文件、编译、运行测试、验证依赖项等）以查看如果构建仍然可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-30T15:12:10.343

有这样的新报告支持 NUnit \ JUnit，称为[Allure](http://allure.qatools.ru/)。要从 NUnit 检索信息，您需要使用[NUnit 适配器](https://github.com/allure-framework/allure-nunit)，对于 JUnit，请阅读以下[wiki 页面](https://github.com/allure-framework/allure-core/wiki/JUnit)。您可以通过相应的[插件](https://github.com/allure-framework/allure-jenkins-plugin)将它与 Jenkins 一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T20:08:59.887

[Hudson](http://hudson.gotdns.com/wiki/display/HUDSON/Meet+Hudson)将执行此操作，它将使用我在此处概述的步骤与 Nunit（[此处](https://stackoverflow.com/questions/352703/integrating-hudson-with-ms-test/512092#512092)[）](http://hudson.gotdns.com/wiki/display/HUDSON/NUnit+Plugin)、Junit（本机）和 MSTest.exe 测试一起使用。它可以满足您的所有要求，甚至更多。即使您希望它只运行测试并向您提供反馈，它也可以。

# oop - 函数是封装的一个例子吗？

> ID：533921
> 
> 赞同：9
> 
> 时间：2009-02-10T19:58:56.447
> 
> 标签：oop, object, methods, encapsulation

通过将功能放入函数中，仅此一项是否构成封装的示例，还是您需要使用对象进行封装？

我试图理解封装的概念。我的想法是，如果我从这样的事情出发：

n = n + 1

它作为一大段代码的一部分在野外执行，然后我把它放在一个函数中，比如这个函数，然后我把这个添加逻辑封装在一个方法中：

```
addOne(n)
    n = n + 1
    return n 
```

或者，如果我向外界隐藏 addOne 的详细信息，它是否只是封装 - 比如它是一个对象方法并且我使用私有/受保护的访问修饰符？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-10T20:07:35.227

我将是第一个不同意似乎是答案趋势的人。是的，一个函数封装了一些实现。你不需要一个对象（我认为你用它来表示一个类）。

也见[迈耶斯](http://www.ddj.com/cpp/184401197)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-10T22:03:26.647

也许您将抽象与封装混淆了，后者在面向对象的更广泛背景下被理解。

封装正确地包括以下所有三个：

*   抽象
*   实现隐藏
*   责任分工

抽象只是封装的一个组成部分。在您的示例中，您已经从它曾经所在的代码主体中抽象了添加功能。您可以通过识别代码中的一些共性来做到这一点 - 识别特定情况下的概念（加法）（将数字 1 添加到变量 n）。由于这种能力，抽象使得封装的组件——方法或对象——可重用。

与封装概念同样重要的是实现隐藏的想法。这就是为什么在面向对象领域讨论封装的原因。实现隐藏保护对象免受其用户的影响，反之亦然。在 OO 中，您通过向对象的用户提供公共方法的接口来做到这一点，而对象的实现发生在私有方法中。

这有两个好处。首先，通过限制对您的对象的访问，您可以避免对象的用户可以使对象处于无效状态的情况。其次，从用户的角度来看，当他们使用您的对象时，他们只是松散地耦合到它——如果您稍后更改您的实现，他们不会受到影响。

最后，责任划分——在更广泛的面向对象设计的背景下——是必须考虑的事情，以正确解决封装问题。封装随机的函数集合是没有用的——职责需要清晰且逻辑地定义，以便尽可能少地重叠或歧义。例如，如果我们有一个厕所对象，我们将希望将它的职责范围与我们的厨房对象隔离开。

但是，在有限的意义上，你是正确的，一个函数，比如说，通过抽象一些功能来“模块化”它。但是，正如我所说，“封装”作为一个术语在面向对象的更广泛背景下被理解为适用于满足上面列出的三个标准的模块化形式。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-10T20:50:41.520

是的。

例如，仅对其参数进行操作的方法将被认为比对全局静态数据进行操作的方法“封装得更好”。

封装早在 OOP 之前就已经存在了 :)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-10T20:08:26.440

方法不再是封装的示例，就像汽车是良好驾驶的示例一样。封装与语法无关，它是一个逻辑设计问题。对象和方法都可以表现出好的和坏的封装。

考虑它的最简单方法是代码是否隐藏/抽象代码中不需要了解/关心实现的其他部分的细节。

回到汽车的例子：自动变速器提供了很好的封装：作为一名司机，你关心前进/后退和速度。手动变速箱的封装不好：从驾驶员的角度来看，低/高速所需的特定档位通常与驾驶员的意图无关。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-10T20:16:16.327

不，封装*不需要*对象。在最广泛的意义上，“封装”只是意味着“隐藏细节”，在这方面，方法正在封装其实现细节。

但这并不意味着您可以仅仅因为您将其划分为方法就可以说您的代码设计良好。由 500 个公共方法组成的程序并不比在一个 1000 行方法中实现的相同程序好多少。

在构建程序时，无论您是否使用面向对象技术，您都需要考虑在许多不同的地方进行封装：隐藏方法的实现细节，隐藏不需要知道的代码中的数据，简化模块接口等。

**更新：**为了回答您更新的问题，“将代码放入方法中”和“使用访问修饰符”都是封装逻辑的不同方式，但每种方式的作用不同。

将代码放入方法中会隐藏构成该方法的各个代码行，以便调用者无需关心这些行是什么；他们只担心方法的签名。

将类上的方法标记为（例如）“私有”会隐藏该方法，以便*该类*的使用者无需担心它；他们只担心类的公共方法（或属性）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-10T20:04:54.903

封装的抽象概念意味着您隐藏了实现细节。面向对象只是使用封装的一个例子。另一个例子是名为 module-2 的语言，它使用（或使用）实现模块和定义模块。定义模块隐藏了实际的实现，因此提供了封装。

当您可以将某物视为黑匣子时，将使用封装。对象是一个黑盒子。您知道它们提供的方法，但不知道它们是如何实现的。

[编辑] 至于更新问题中的示例：这取决于您定义封装的范围。您的 AddOne 示例并没有隐藏我相信的任何内容。如果您的变量是数组索引并且您将调用您的方法 moveNext 并且可能有另一个函数 setValue 和 getValue，这将是信息隐藏/封装。这将允许人们（可能与其他一些功能一起）导航您的结构和设置并获取变量，因为他们知道您使用数组。如果您的编程语言将支持其他或更丰富的概念，您可以通过更改含义和接口来更改 moveNext、setValue 和 getValue 的实现。对我来说，这就是封装。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T20:01:36.393

这是组件级别的事情

看看[这个](http://en.wikipedia.org/wiki/Encapsulation_(computer_science))：

> 在计算机科学中，封装是将软件组件的内部机制和数据结构隐藏在定义的接口之后，这样组件（其他软件）的用户只需要知道组件做什么，而不能让自己依赖于它如何做到这一点的细节。目的是实现潜在的变化：可以改进组件的内部机制而不影响其他组件，或者可以用支持相同公共接口的不同组件替换该组件。

（我不太明白您的问题，如果该链接不能解决您的疑问，请告诉我）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T22:07:56.090

让我们用一个类比来稍微简化一下：你转动汽车的钥匙，它就会启动。你知道它不仅仅是钥匙，但你不必*知道*里面*发生了什么*。对你来说，钥匙转动 = 电机启动。键的接口（例如，函数调用）隐藏了启动电机旋转引擎等的实现......（实现）。**那就是**封装。您不必知道引擎盖下发生了什么，并且为此感到高兴。

如果你创造了一只假手，比如说，为你转动钥匙，那**不是**封装。您正在使用额外的中间人来转动钥匙而不隐藏任何东西。这就是您的示例让我想起的 - 它没有封装实现细节，即使两者都是通过函数调用完成的。在这个例子中，任何拿起你的代码的人都不会感谢你。事实上，他们更有可能用你的假手来打你。

您能想到的任何隐藏信息的方法（类、函数、动态库、宏）都可以用于封装。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-10-12T06:02:03.717

封装是将对象的属性（数据成员）和行为（成员函数）组合在一起作为单个实体称为类的过程。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-11T11:36:24.307

由国际标准化组织编写的开放分布式处理参考模型定义了以下概念：

实体：任何具体或抽象的感兴趣的事物。

对象：实体的模型。一个对象的特征在于它的行为，双重地，它的状态。

（对象的）行为：行为的集合，对何时可能发生具有一组约束。

接口：对象行为的抽象，由该对象的交互的子集以及它们何时可能发生的一组约束组成。

封装：对象中包含的信息只能通过对象支持的接口的交互来访问的属性。

你会明白，这些内容非常广泛。然而，让我们看看，将功能放入函数中是否可以在逻辑上被认为构成了这些术语中的封装。

首先，函数显然是“感兴趣的事物”的模型，因为它代表您（可能）希望执行的算法，并且该算法与您尝试解决的某个问题有关（因此是它的模型） .

函数有行为吗？它当然可以：它包含一组动作（可以是任意数量的可执行语句），这些动作是在函数必须从某个地方调用才能执行的约束下执行的。一个函数可能不会在任何时候自发调用，没有因果关系。听起来像法律术语？完全正确。但是，尽管如此，让我们继续前进。

函数有接口吗？它确实有：它有一个名称和一个形式参数的集合，它们又映射到函数中包含的可执行语句，因为一旦调用函数，名称和参数列表就被理解为唯一标识可执行文件的集合在调用方未指定这些实际语句的情况下运行语句。

函数是否具有只能通过对象支持的接口上的交互来访问函数中包含的信息的特性？嗯，可以的。

由于某些信息可通过其接口访问，因此某些信息必须在函数中隐藏且不可访问。（此类信息所表现出的属性称为信息隐藏，Parnas 认为模块应该被设计为隐藏困难的决策和可能改变的决策。） 那么，函数中隐藏了哪些信息？

要看到这一点，我们应该首先考虑规模。很容易声称，例如，Java 类可以封装在一个包中：一些类是公共的（因此是包的接口），一些是包私有的（因此信息隐藏在包中） . 在封装理论中，类形成节点，包形成封装区域，整体形成封装图；类和包的图称为第三图。

声称函数（或方法）本身封装在类中也很容易。同样，有些函数是公共的（因此是类接口的一部分），有些是私有的（因此信息隐藏在类中）。函数和类的图称为第二图。

现在我们来谈谈函数。如果函数要成为封装自身的一种方式，它们应该包含一些对其他函数公开的信息以及一些隐藏在函数中的信息。这些信息可能是什么？

McCabe 给了我们一位候选人。在他关于圈复杂度的里程碑式论文中，Thomas McCabe 描述了源代码，其中“图中的每个节点对应于程序中的一个代码块，其中流程是连续的，弧对应于程序中的分支。”

让我们将顺序执行的 McCabian 块作为可以封装在函数中的信息单元。由于函数中的第一个块始终是第一个也是唯一保证要执行的块，我们可以认为第一个块是公共的，因为它可以被其他函数调用。然而，函数中的所有其他块不能被其他函数调用（除了允许在流程中跳转到函数的语言中），因此这些块可以被认为是函数内隐藏的信息。

采用这些（也许有些微不足道的）定义，那么我们可以说是的：将功能放入函数中确实构成了封装。函数内块的封装是第一个图。

但是，有一个警告。你会考虑封装一个每个类都是公开的包吗？根据上面的定义，它确实通过了测试，正如您可以说包的接口（即所有公共类）确实为其他包提供了包行为的一个子集。但是在这种情况下，子集是整个包的行为，因为没有类是信息隐藏的。因此，尽管严格地满足了上述定义，但我们认为它不满足定义的精神，因为肯定有些东西必须是信息隐藏的，才能声称真正的封装。

你给出的例子也是如此。我们当然可以认为 n = n + 1 是一个单一的 McCabian 块，因为它（和 return 语句）是一个单一的、顺序的执行流程。但是您将其放入的函数因此仅包含一个块，并且该块是该函数的唯一公共块，因此在您提议的函数中没有信息隐藏块。所以它可能满足封装的定义，但我会说它不满足精神。

当然，所有这些都是学术性的，除非你能证明这样的封装是有益的。

有两种力量推动封装：语义和逻辑。

语义封装仅仅意味着基于节点（使用通用术语）封装的含义的封装。所以如果我告诉你我有两个包，一个叫做“动物”，一个叫做“矿物”，然后给你三个类 Dog、Cat 和 Goat 并询问这些类应该封装到哪些包中，那么，给定没有其他信息，您完全正确地声称系统的语义表明这三个类被封装在“动物”包中，而不是“矿物”包中。

然而，封装的另一个动机是逻辑。

系统的配置是对系统的每个节点及其所在的封装区域的精确和详尽的标识；Java 系统的特定配置（在第三张图中）识别系统的所有类并指定每个类所在的包。

逻辑封装系统意味着识别系统的某些数学属性，该属性取决于其配置，然后配置该系统以使该属性在数学上最小化。

封装理论提出，所有封装图都表示最大潜在边数（MPE）。例如，在类和包的 Java 系统中，MPE 是该系统的所有类之间可以存在的源代码依赖关系的最大潜在数量。同一个包中的两个类不能相互隐藏信息，因此两者都可能形成相互依赖。然而，不同包中的两个包私有类可能不会相互依赖。

封装理论告诉我们，对于给定数量的类，我们应该有多少包，以便最小化 MPE。这可能很有用，因为负担原则的弱形式表明转换实体集合的最大潜在负担是转换实体的最大潜在数量的函数 - 换句话说，您之间的潜在源代码依赖关系越多您的课程，进行任何特定更新的潜在成本就越大。因此，最小化 MPE 可以最小化更新的最大潜在成本。

给定 n 个类和每个包 p 个公共类的要求，封装理论表明包的数量 r，我们应该最小化 MPE，由等式给出：r = sqrt(n/p)。

这也适用于您应该拥有的功能数量，给定系统中 McCabian 块的总数 n。正如我们上面提到的，函数总是只有一个公共块，因此系统中函数数量 r 的等式简化为：r = sqrt(n)。

诚然，在实践封装时，很少有人考虑系统中的块总数，但它很容易在类/包级别完成。此外，最小化 MPE 几乎完全是直观的：它是通过最小化公共类的数量并尝试在包中均匀分布类来完成的（或者至少避免大多数包有 30 个类，一个怪物包有 500 个类，在这种情况下，后者的内部 MPE 很容易压倒所有其他的 MPE）。

因此，封装涉及在语义和逻辑之间取得平衡。

都很好玩。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-09-23T02:38:40.310

在严格的面向对象术语中，人们可能会说不，“单纯的”函数不足以称为封装......但[在现实世界](http://www.google.com/search?hl=en&defl=en&q=define:encapsulation&ei=ioi5Sur_LZSJtgellJ24BA&sa=X&oi=glossary_definition&ct=title)中，显而易见的答案是“是的，函数封装了一些代码”。

对于对这种亵渎行为感到愤怒的 OO 纯粹主义者，考虑一个没有状态和单一方法的静态匿名类；如果 AddOne() 函数不是封装，那么这个类也不是！

只是为了迂腐，封装是一种抽象形式，反之亦然。;-)

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-02-10T20:02:51.227

*在不参考属性而不是仅*参考方法的情况下谈论封装通常不是很有意义——当然，您可以对方法进行访问控制，但是如果没有任何数据限定在封装方法的范围内，很难看出除了荒谬之外还有什么意义. 也许你可以提出一些论据来验证它，但我怀疑它会很曲折。

所以不，你很可能不使用封装只是因为你把一个方法放在一个类中，而不是把它作为一个全局函数。

# java - 可以在 Java 中的枚举上使用 == 吗？

> ID：533922
> 
> 赞同：116
> 
> 时间：2009-02-10T19:59:01.313
> 
> 标签：java, syntax, enums

可以`==`在 Java 中的枚举上使用，还是我需要使用`.equals()`？在我的测试中，`==`总是有效，但我不确定我是否可以保证。特别是，`.clone()`枚举上没有方法，所以我不知道是否有可能获得一个`.equals()`返回不同值的枚举`==`。

例如，这样可以吗：

```
public int round(RoundingMode roundingMode) {
  if(roundingMode == RoundingMode.HALF_UP) {
    //do something
  } else if (roundingMode == RoundingMode.HALF_EVEN) {
    //do something
  }
  //etc
} 
```

还是我需要这样写：

```
public int round(RoundingMode roundingMode) {
  if(roundingMode.equals(RoundingMode.HALF_UP)) {
    //do something
  } else if (roundingMode.equals(RoundingMode.HALF_EVEN)) {
    //do something
  }
  //etc
} 
```

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2009-02-10T20:46:18.847

只是我的 2 美分：这是 Sun 发布的 Enum.java 的代码，也是 JDK 的一部分：

```
public abstract class Enum<E extends Enum<E>>
    implements Comparable<E>, Serializable {

    // [...]

    /**
     * Returns true if the specified object is equal to this
     * enum constant.
     *
     * @param other the object to be compared for equality with this object.
     * @return  true if the specified object is equal to this
     *          enum constant.
     */
    public final boolean equals(Object other) { 
        return this==other;
    }

} 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2009-02-10T20:00:15.070

是的，== 很好——保证每个值只有一个引用。

但是，有一种更好的方法来编写你的轮方法：

```
public int round(RoundingMode roundingMode) {
  switch (roundingMode) {
    case HALF_UP:
       //do something
       break;
    case HALF_EVEN:
       //do something
       break;
    // etc
  }
} 
```

一个*更好*的方法是将功能放在枚举本身中，这样你就可以调用`roundingMode.round(someValue)`. 这触及了 Java 枚举的核心——它们是*面向对象的*枚举，与其他地方的“命名值”不同。

编辑：规范不是很清楚，但[第 8.9 节](http://java.sun.com/docs/books/jls/third_edition/html/classes.html#8.9)指出：

> 枚举类型的主体可能包含枚举常量。枚举常量定义枚举类型的一个实例。枚举类型除了由其枚举常量定义的实例外，没有其他实例。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-11T09:16:28.700

是的，就好像您为枚举中的每个值创建了单例实例：

```
公共抽象类 RoundingMode {
  公共静态最终 RoundingMode HALF_UP = new RoundingMode();
  公共静态最终 RoundingMode HALF_EVEN = new RoundingMode();

  私人舍入模式（）{
    // 私有作用域阻止该类之外的任何子类型
  }
}

```

**但是**，该`enum`构造为您提供了各种好处：

*   每个实例的 toString() 打印代码中给出的名称。
*   （如另一篇文章中所述）枚举类型的变量可以使用`switch-case`控制结构与常量进行比较。
*   `values`可以使用为每个枚举类型“生成”的字段来查询枚举中的所有值
*   **这是身份比较的重要内容：**枚举值无需克隆即可在序列化中幸存下来。

序列化是一个很大的问题。如果我使用上面的代码而不是枚举，那么身份平等的表现如下：

```
RoundingMode original = RoundingMode.HALF_UP;
断言（RoundingMode.HALF_UP == 原始）；// 通过

ByteArrayOutputStream baos = new ByteArrayOutputStream();
ObjectOutputStream oos = new ObjectOutputStream(baos);
oos.writeObject(原始);
oos.flush();

ByteArrayInputStream bais = new ByteArrayInputStream(baos.toByteArray());
ObjectInputStream ois = new ObjectInputStream(bais);
RoundingMode 反序列化 = (RoundingMode) ois.readObject();

断言（RoundingMode.HALF_UP == 反序列化）；// 失败
断言（RoundingMode.HALF_EVEN == 反序列化）；// 失败

```

您*可以*在不使用枚举的情况下解决此问题，使用涉及`writeReplace`and的技术`readResolve`，（请参阅[http://java.sun.com/j2se/1.4.2/docs/api/java/io/Serializable.html](http://java.sun.com/j2se/1.4.2/docs/api/java/io/Serializable.html)）...

我想重点是——Java 不遗余力地允许您使用枚举值的身份来测试相等性；这是一种鼓励的做法。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-10T20:14:16.410

== 比较两个对象的引用。对于枚举，保证只有一个实例，因此对于任何两个相同的枚举，== 将是真的。

参考：

[http://www.ajaxonomy.com/2007/java/making-the-most-of-java-50-enum-tricks](http://www.ajaxonomy.com/2007/java/making-the-most-of-java-50-enum-tricks)

（在 Sun 文档中找不到任何内容）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-10T20:56:50.693

这里有一些你可能会觉得有趣的邪恶代码。:D

```
public enum YesNo {YES, NO}

public static void main(String... args) throws Exception {
    Field field = Unsafe.class.getDeclaredField("theUnsafe");
    field.setAccessible(true);
    Unsafe unsafe = (Unsafe) field.get(null);
    YesNo yesNo = (YesNo) unsafe.allocateInstance(YesNo.class);

    Field name = Enum.class.getDeclaredField("name");
    name.setAccessible(true);
    name.set(yesNo, "YES");

    Field ordinal = Enum.class.getDeclaredField("ordinal");
    ordinal.setAccessible(true);
    ordinal.set(yesNo, 0);

    System.out.println("yesNo " + yesNo);
    System.out.println("YesNo.YES.name().equals(yesNo.name()) "+YesNo.YES.name().equals(yesNo.name()));
    System.out.println("YesNo.YES.ordinal() == yesNo.ordinal() "+(YesNo.YES.ordinal() == yesNo.ordinal()));
    System.out.println("YesNo.YES.equals(yesNo) "+YesNo.YES.equals(yesNo));
    System.out.println("YesNo.YES == yesNo " + (YesNo.YES == yesNo));
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-11T12:30:28.453

枚举是干扰多态代码的好地方。

```
enum Rounding {
  ROUND_UP {
    public int round(double n) { ...; }
  },
  ROUND_DOWN {
    public int round(double n) { ...; }
  };

  public abstract int round(double n);
}

int foo(Rounding roundMethod) {
  return roundMethod.round(someCalculation());
}

int bar() {
  return foo(Rounding.ROUND_UP);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-08T12:45:27.590

请注意，通过 RMI/IIOP 传输枚举时存在问题。看到这个线程：

[http://www.velocityreviews.com/forums/t390342-enum-equality.html](http://www.velocityreviews.com/forums/t390342-enum-equality.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-14T12:22:53.740

== 通常没问题， == 和`.equals()`. 我个人更喜欢在比较对象时总是使用`.equals()`，包括`enum`s. 另请参阅此讨论：

[比较 Java 枚举成员：== 或 equals()？](https://stackoverflow.com/questions/1750435/comparing-java-enum-members-or-equals)

# c# - C# Combobox (Dropdownstyle = Simple) -- 如何在键入时选择项目

> ID：533923
> 
> 赞同：5
> 
> 时间：2009-02-10T19:59:05.980
> 
> 标签：c#, combobox

我的表单上有一个 Combobox 控件（WinForms，.NET 3.5），它的**DropDownStyle**属性设置为**Simple**。假设它填充了字母表中的字母，作为**字符串**对象（“a”、“b”、“c”等）。
当我在组合框的输入字段中键入一个字母时，正确的项目将显示在下方。

这是我想要的行为。但我也想选择第一个匹配的项目。

是否有 Combobox 控件的属性可以实现这一点？还是我需要以编程方式处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T20:04:22.533

根据您的需要，您可以考虑使用 TextBox 控件并设置 AutoComplete 属性（例如 AutoCompleteMode 和 AutoCompleteCustomSource）

您将面临的困难是，一旦您选择了一个项目（以编程方式），组合框中的文本就会改变。所以做这样的事情：

```
private void comboBox1_TextChanged(object sender, EventArgs e)
{
    for(int i=0; i<comboBox1.Items.Count; i++)
    {
        if (comboBox1.Items[i].ToString().StartsWith(comboBox1.Text))
        {
            comboBox1.SelectedIndex = i;
            return;
        }
    }
} 
```

可能会完成您想要的（就选择而言），但它也会立即更改用户的文本。

# apache - 您自己的服务器上的动态 DNS

> ID：533926
> 
> 赞同：2
> 
> 时间：2009-02-10T20:00:42.310
> 
> 标签：apache, dns, dyndns

我在主机上有一个服务器（它有一个静态 IP）并且想在家里运行一个服务器并且不想从 dyndns.com 购买 dyndns 包

我要么想找到一个不花钱的程序，并且使用我自己的服务器和域，这样我就可以拥有 myclient.domain.com，或者我想自己写这个。我可以使用自定义 apache conf 来做到这一点吗？

编辑：

我有 1 台带有静态 ip 的服务器，我想在家里运行一台服务器（动态 IP） 我想使用带有静态 ip 的服务器作为 dyndns 管理服务器运行

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T20:04:50.053

我使用 zoneedit.com 作为我的 DNS 服务器，他们有一个免费的动态服务，可以很好地用于我的家庭机器。（另一方面，我家的盒子大约一年换两次IP，所以我并不强调它。）

在我的家用盒子上，我有一个脚本，它轮询我的 colo 盒子上的一个小 cgi 以返回我当前的 IP 是什么（因为我无法从路由器获取它），如果它改变了，它会“卷曲”更新我的 zoneedit 设置。当我回到家时，我会尽量记住发布脚本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T20:07:28.767

根据您的修改：啊，那么理论上您可以这样做，是的。（如其他地方所述，apache.conf 无关紧要。）您的托管服务器需要是您的动态 DNS 的记录名称服务器；您可能应该使用子域。这将是您主域的 IN NS server.ip.number.here 区域文件中的记录。然后在托管服务器上为动态命名空间配置 DNS 服务器；您必须深入配置以设置记录，以便它们建议客户端名称服务器不要缓存它们，或者只缓存它们非常短暂。然后，您编写某种系统，在该系统中，主机在建立连接时与托管服务器通信并告诉它更改动态主机名的 DNS 以指向其当前分配的 IP。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T20:09:57.700

您不能使用自定义 Apache conf 来做到这一点。Apache 处理 Web 服务，而不是 DNS。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T20:31:59.957

也许我错了，但我认为你想要的是：

1.  **在免费**的 DNS 服务中创建一个动态主机，例如 dyndns.org（或者您甚至可以使用也具有动态 dns 的 editdns.com 管理整个域）。例如：server-at-home.dyndns.org。
2.  为所需地址（例如 www2）创建一个静态 IP 主机，指向 www 服务器的相同 IP 地址。
3.  在静态 ip 服务器的 httpd.conf 中创建一个虚拟主机，并在项目 1 上使用动态主机创建放置一个反向代理。

PS：你说主要目标是取消**购买**这项服务，但我使用 dyndns.com，我不为此付费。我的帐户中有 4 台主机。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T20:14:10.810

我在家里有一台带有静态 IP 地址的服务器，我用一个免费的 dyndns 帐户做你想做的事。我只需要每两个月更新一次——他们给我发了一封电子邮件，我只需点击链接让他们知道我还在这里并且还活着。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T20:19:53.637

我不确定，但听起来您想从托管站点上的网络服务器重定向到您家中的“服务器”？

您需要定期向您的静态 IP 服务器发送一些通知，让它知道您的动态 IP。

您可以通过一些 cron/计划的工作来执行此操作 - 只需每天创建一个重定向 html 页面并将其（自动）ftp 到您的静态 IP 主机。

可能还有其他方法可以做到这一点。但这应该有效。

# c# - 将双精度转换为字符串

> ID：533931
> 
> 赞同：27
> 
> 时间：2009-02-10T20:01:50.823
> 
> 标签：c#, typeconverter

我有三个双变量 a ， b 和 c

```
a = 0.000006 
b = 6 
c = a/b; 
```

所以 C 应该是 0.000001

我想在文本框中显示这个值，所以我写了

```
textbox.text = c.tostring(); 
```

但它给出的结果为“1E-06”..

任何人都可以帮助我如何在文本框中输入正确的值吗？

谢谢

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-02-10T20:10:55.653

```
a = 0.000006;
b = 6;
c = a/b;

textbox.Text = c.ToString("0.000000"); 
```

根据您的要求：

```
textbox.Text = c.ToString("0.######"); 
```

如果要显示 6 位小数，这只会显示到小数点后 6 位。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-10T20:14:48.983

尝试`c.ToString("F6");`

（有关数字格式的完整说明，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)）

# oracle - 我应该安装哪个 Oracle 客户端和 ODP.NET 版本（使用 .NET 3.5）

> ID：533932
> 
> 赞同：1
> 
> 时间：2009-02-10T20:02:20.060
> 
> 标签：oracle, .net-3.5, odp.net

在使用 Oracle Client 9.2.0.7 和与之配套的 ODP.NET（针对 .NET 1.1）进行相当长的开发之后，我们正在将我们的代码行升级到 .NET 3.5，并且我们也在考虑升级 Oracle Client 版本。

我想知道是否应该使用/不使用特定版本是否有任何“陷阱”？

例如，众所周知，Oracle 客户端 9.2.0.4 存在 .NET 错误，升级到 9.2.0.7 是非可选的。

显然，当前的 Oracle 客户端版本是 11.1.0.7.0（来自[这里](http://www.oracle.com/technology/software/tech/oci/instantclient/htdocs/winsoft.html)）。有人对此版本有具体问题并会推荐其他版本吗？有时安装最新版本不是最佳选择...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T01:07:41.647

看看 Metalink 的以下文档，它可能会有所帮助。它包含 ODP 驱动程序版本、支持的操作系统、SQL*Net、RDBMS、.NET Framework 和 Visual Studio 的矩阵。

主题：Oracle Data Provider for .NET (ODP) 支持的配置

文件编号：726240.1

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T21:30:59.993

如果您只需要与 Oracle 交谈，那么您可以使用我在[此处](https://stackoverflow.com/questions/923283/what-is-the-minimal-setup-required-to-deploy-a-net-application-with-oracle-clien/923300#923300)找到的说明进行 Oracle 11 Client XCopy 部署。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-26T15:21:13.613

如果您拥有 Visual Studio 2008，则最新版本是唯一可以使用的版本，除非您不想要 Oracle 提供的任何时髦的插件（例如 SQLPlus 等）。我用最新的版本连接10g的数据库就好了。

# jsp - 如何将 EL 表达式作为嵌套 jsp 2.0 标记中的参数？

> ID：533938
> 
> 赞同：3
> 
> 时间：2009-02-10T20:03:09.137
> 
> 标签：jsp, jsp-tags

我想做这样的事情来调用 JSP 2.0 标记：

```
<mytags:foo abc="<%=def%>">
  <mytags:bar ghi="<%=jkl%>"/>
</mytags:foo> 
```

其中 Strings`def`和`jkl`在 jsp 文件中定义较早。假设我的标签文件如下所示：

`foo.tag`：

```
<%@ tag body-content="scriptless" %>
<%@ attribute name="abc" required="true" %>
<div class="${abc}">
  <jsp:doBody/>
</div> 
```

`bar.tag`：

```
<%@ tag body-content="scriptless" %>
<%@ attribute name="ghi" required="true" %>
<div>${ghi}</div> 
```

我希望输出看起来像这样：

```
<div class="def">
<div>jkl</div>
</div> 
```

（假设变量`def`和分别在调用 JSP 文件`jkl`中初始化为`def`和`jkl`。）

外部标签的属性很好（`<div class="def">`），但内部标签失败。

这可能吗？我收到 jkl 无法解决的错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T20:41:13.413

注意`body-content="scriptless"`标签指令中的属性。这意味着被标签包围的主体不能包含脚本代码（`<% %>`东西）。您需要使用 EL。

如果我将 JSP 中的内容更改为：

```
 <c:set var="def" value="def"></c:set>
  <c:set var="jkl" value="jkl"></c:set>

  <mytags:foo abc="${def}">
      <mytags:bar ghi="${jkl}"/>
  </mytags:foo> 
```

请注意，我需要添加 `<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>`

# windows-vista - 如何防止 Vista 要求对 patch.exe 进行提升？

> ID：533939
> 
> 赞同：14
> 
> 时间：2009-02-10T20:03:26.687
> 
> 标签：windows-vista, uac, patch

[很抱歉，这不是直接的编程问题。但是我最近切换到了一台新的 Vista 机器，我在其中保持 UAC 启用（请不要告诉我禁用它，这不是一个选项）。]

每次我运行 gnu 的 patch.exe 时，我都会从 Vista 中得到一个提升对话框。如果我将 patch.exe 重命名为 foo.exe，它不会这样做，所以我认为这是 Vista 的“启发式”之一。

有谁知道如何禁用它？这让我发疯了，谷歌也没有帮助。

或者我应该为 patch.exe 添加一个清单来告诉系统不要尝试提升它？这会奏效吗？如果是这样，你如何制作这样的清单？

非常感谢，到目前为止，我已经在墙上撞了一个小时。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T20:14:37.720

来自：
[http ://social.msdn.microsoft.com/Forums/en-US/windowsgeneraldevelopmentissues/thread/bf4f7dfa-5553-41d3-9c8e-311ee4a88599/](http://social.msdn.microsoft.com/Forums/en-US/windowsgeneraldevelopmentissues/thread/bf4f7dfa-5553-41d3-9c8e-311ee4a88599/)

> 如果您可以将清单添加到受影响的可执行文件中，声明 requestExecutionLevel 为“asInvoker”，它应该停止提示。

关于 UAC 架构和转换现有应用程序以使其正常工作的相关指南（靠近页面底部的五分之一）：

[http://technet.microsoft.com/en-us/library/cc709628.aspx](http://technet.microsoft.com/en-us/library/cc709628.aspx)

最后，如何编写这样的清单：

[http://www.google.com/search?q=writing+a+uac+manifest](http://www.google.com/search?q=writing+a+uac+manifest)

-亚当

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-19T02:50:04.220

问题是您的应用程序不包含带有**requestedExectutionLevel**的程序集清单。

## 背景

所有正确编写的 Windows 应用程序都必须具有程序集清单。从 2006 年开始，您需要具备的元素之一是**requestedExecutionLevel**，它指定您的应用程序是否只有在用户是管理员时才能运行。

如果您的应用程序没有程序集清单，或者它没有**请求**的执行级别， Windows 将假定它是一个*遗留*应用程序，并做一些事情来保持它运行。

遗留应用程序的一个兼容性问题是其中一些可能是安装程序或 udpater，并且只能在以管理员身份运行时运行。Windows 尝试通过文件名来猜测这些应用程序：

*   设置
*   更新
*   修补

是否所有文件名示例都被试图自动提升用户的兼容性启发式*捕获*。

如果应用程序没有程序集清单，则它不是一个有效编写的 Windows 应用程序。

## 正确的解决方案

正确的解决方案是添加所有正确应用程序都将具有的程序集清单。这禁用了启发式。

示例 UAC“asInvoker”清单：

```
<?xml version="1.0" encoding="utf-8"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
   <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
      <security>
         <requestedPrivileges>
            <requestedExecutionLevel level="asInvoker" />
         </requestedPrivileges>
      </security>
   </trustInfo>
</assembly> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-07-17T07:29:46.107

就我而言，我必须编写一个包装程序，该程序执行以下操作：

1-将“patch.exe”文件复制到系统的临时文件夹（％TMP％）中，使用另一个名称：“apply.exe”

2-使用所需的参数执行“%TMP%\apply.exe”。

3-删除“%TMP%\apply.exe”文件

您无需编写清单。

如果需要计算“patch.exe”的完整路径，假设.exe在%PATH%环境变量中，可以在C#中使用如下代码：

```
public string GetPatchInstallPath()
{
    StringDictionary env = 
    System.Diagnostics.Process.GetCurrentProcess().StartInfo.EnvironmentVariables;
    string pathEnvVble = env["PATH"];
    string[] paths = new string[]{};
    paths = pathEnvVble.Split(new char[] { ';' });

    foreach (string p in paths)
    {
       string fullPath = Path.Combine(p, "patch.exe");
       if (File.Exists(fullPath))
           return fullPath;
    }
    return string.Empty;
} 
```

否则，如果您不想将新条目添加到 patch.exe 位置的 %PATH% 变量，则可以将 patch.exe 完整路径传递给包装程序。

# crystal-reports - 水晶报表公式：IsNull + Iif

> ID：533942
> 
> 赞同：5
> 
> 时间：2009-02-10T20:04:18.243
> 
> 标签：crystal-reports, isnull, iif-function

这个网站上到处都有这个问题的答案提示，但我问的是一个稍微不同的问题。

Crystal Reports 在哪里记录了这种语法不起作用？

```
Trim({PatientProfile.First}) + " "
    + Trim(Iif(
        IsNull({PatientProfile.Middle}) 
        , Trim({PatientProfile.Middle}) + " "
        , " "
        )
    )  
+ Trim({PatientProfile.Last}) 
```

我知道解决方案是

```
If IsNull({PatientProfile.Middle}) Then
    Trim({PatientProfile.First})
        + " " + Trim({PatientProfile.Last})
Else
    Trim({PatientProfile.First})
       + " " + Trim({PatientProfile.Middle})
       + " " + Trim({PatientProfile.Last}) 
```

但是我们怎么知道我们不能使用第一个版本呢？

IsNull 的文档说

*   评估当前记录中指定的字段，如果该字段包含空值，则返回 TRUE

和 Iif 给出

*   [返回] 如果表达式为 True，则返回 truePart；如果表达式为 False，则返回 falsePart。返回值的类型与 truePart 和 falsePart 的类型相同。

我想如果你盯着关于“返回值的类型”的那一行，你可以得到它，但是......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-01-07T16:07:49.997

> > Crystal Reports 在哪里记录了这种语法不起作用？

我怀疑整个宇宙中是否有足够大的地方来记录所有在 Crystal Reports 中不起作用的东西......

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-05-19T13:07:07.593

我知道我在这个问题上迟到了几年，但我在试图弄清楚同样的事情时遇到了这个问题。有趣的是，我什至在 Crystal Reports 文档中都找不到答案，而是在[IBM 的链接中](https://www-304.ibm.com/support/docview.wss?uid=swg21143931)找到了答案。

Baiscally，如果您使用的是 Crystal Reports 8.x 或 10.x，`ISNULL`请`IIF`不要一起使用。从网站：

> **原因**
> 
> Crystal Reports 8.x 和 10.x 中存在一个缺陷，导致上述公式无法正常工作。'IIF' 和 'IsNull' 命令不能一起使用，这包括尝试使用“Not”来修改 IsNull 命令；例如，IIF(Not IsNull ())。
> 
> **解决问题**
> 
> 解决方法是使用“If-Then-Else”语句。例如，

```
If IsNull({~CRPT_TMP0001_ttx.install_date}) Then "TBD" Else "In Progress" 
```

因此，如果您使用的是 CR 8.x 或 10.x（我们就是这样），那么您就不走运了。当您将多个字段连接在一起并且其中一个可能为 NULL 时，它会变得非常有趣。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-11T22:27:15.847

我认为 CR 评估 IIF 的真假部分。因为那里有“Trim({PatientProfile.Middle})”部分，它将被评估为空值，CR 公式评估器似乎只是失败了。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2011-06-28T20:27:18.213

试试这个：

```
currencyvar tt;
currencyvar dect;
tt :={ship.comm_amount};
dect := tt - Truncate(tt);
tt := truncate(tt);
dect := dect * 100;
if dect = 0 then
UPPERCASE('$ ' + ToWords (tt,0 )) + ' ONLY'
else
UPPERCASE('$ ' + ToWords (tt,0) + ' And ' + ToWords(dect,0)) + ' ONLY '; 
```

# c# - 检索修改后引用的原始值

> ID：533950
> 
> 赞同：2
> 
> 时间：2009-02-10T20:07:00.280
> 
> 标签：c#, entity-framework

我已经弄清楚如何使用`ObjectStateManager`和`ObjectStateEntries`来确定给定实体的标量属性的原始值。

我现在需要知道的是如何对导航属性做同样的事情。`GetModifiedProperties`on 方法`ObjectStateEntry`不返回导航属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T13:28:08.277

只需获取所有添加或删除的 ObjectStateEntries，然后使用 LINQ 仅获取代表关系的那些：

```
private IEnumerable<ObjectStateEntry> GetModifiedRelationshipEntries()
{
    return ObjectStateManager.GetObjectStateEntries(
            EntityState.Added | EntityState.Deleted)
            .Where(e => e.IsRelationship);
} 
```

在为 EF 编写审计日志时，我发现 Daniel Simmons 的这两个博客条目非常有用：

[http://blogs.msdn.com/b/dsimmons/archive/2008/01/16/ef-extension-method-extravaganza-part-i-objectstateentry.aspx](http://blogs.msdn.com/b/dsimmons/archive/2008/01/16/ef-extension-method-extravaganza-part-i-objectstateentry.aspx)

[http://blogs.msdn.com/b/dsimmons/archive/2008/01/17/ef-extension-methods-extravaganza-part-ii-relationship-entry-irelatedend.aspx](http://blogs.msdn.com/b/dsimmons/archive/2008/01/17/ef-extension-methods-extravaganza-part-ii-relationship-entry-irelatedend.aspx)

# sql - 使用整数并要求乘法与使用小数作为数据类型 - 你的想法是什么？

> ID：533951
> 
> 赞同：0
> 
> 时间：2009-02-10T20:07:21.293
> 
> 标签：sql, database, database-design, types, precision

您对此有何看法？我正在整合一些以制表符分隔的文本格式的新数据，并且所有小数列都保存为单个整数；为了确定小数，您需要将数字乘以 0.01。它针对百分比、重量和定价信息等信息执行此操作。例如，一个项目的价格`3259`在数据文件中表示，当我想显示它时，我需要将它相乘以获得“真实”数量`32.59`。

你认为这是个好主意还是坏主意？我应该保持我的数据结构与供应商提供的数据结构相同，还是应该将数据库列设为真正的小数并使用 SSIS 或某种 ETL 过程自动将整数列乘以它们的十进制等值？在这一点上，我还没有决定是否要使用 ORM 或存储过程或什么来检索数据，所以我试图从长远来看并决定使用哪种方法。我也可以轻松地在 DTO 或类似的代码中处理这个问题，类似于：

```
public class Product
{
    // ...
    private int _price;
    public decimal Price
    {
        get
        {
            return (this._price * .01);
        }
        set
        {
            this._price = (value / .01);
        }
    }
} 
```

但这似乎是班级的额外和不必要的工作。您将如何处理这个问题，请记住，数据是由供应商以整数格式提供的，您将经常需要从中获取更新。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T20:14:43.820

“你认为这是个好主意还是坏主意？”

坏的。

“我应该保持我的数据结构与供应商提供的相同吗？”

不。

“我应该让数据库列真正的小数吗？”

是的。

做正确的事要简单得多。目前，数据传输时没有“.”。将整数与小数分开；这没有任何实际意义。

数据为十进制。十进制数学有效。使用您的语言和数据库提供的十进制数学。不要发明自己的十进制算术版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T20:13:59.483

就个人而言，我更希望将数据正确存储在我的数据库中，并且每次更新时都进行简单的转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T20:13:54.087

迂腐地：它们也没有被保存为整数。它们是需要解析的字符串。

从哲学上讲：您在文件中有*信息*，您应该将*数据*写入数据库。这意味着以任何必要的方式转换信息以使其有意义/有用。如果您不预先进行此转换，那么您将注定要在数据库的所有使用者中重复转换。

在某些情况下，您不允许转换数据，例如能够回答以下问题：“文件中有什么？”。这些场景需要将数据写入字符串 - 如果解析失败，您将无法获得文件的准确表示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T23:32:55.730

在我看来，在这种情况下使用 Decimal over Int 最重要的方面是可维护性。

存储在表中的数据应该是有意义的，无需任意操作。如果需要操作，则应该清楚地表明它是（例如从字段名称）。

我最近处理了一周中的几天存储为值 2-8 的数据。你无法想象这造成的后果（由于各种原因测试没有显示问题，但现场使用确实引起了政治爆炸）。

如果您确实遇到过这种情况，我绝对可以确保在不使用存储过程或视图的情况下无法将数据写入表或从表中读取数据。这使您能够确保执行和记录必要的操作。如果你没有这两个，将来跟随你的一些可怜的草皮会诅咒你的名字。

# hibernate - 来自 HQL 查询的 SQL 字符串？

> ID：533954
> 
> 赞同：3
> 
> 时间：2009-02-10T20:08:15.130
> 
> 标签：hibernate, hql

HQL 查询转换为 SQL。

我希望我的程序在发送到我的数据库之前拥有完整的 SQL 字符串。

我可以这样做吗？

* * *

*笔记：*

我可以通过设置看到发送到数据库的SQL

```
<property name="hibernate.show_sql">true</property> 
```

在我的 cfg.xml

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T21:22:47.400

我相信你可以创建一个实现的类，在启动`org.hibernate.Interceptor`时注册它`Configuration.setInterceptor(Interceptor)`，然后通过`Interceptor.onPrepareStatement(String sql)`回调访问 SQL。

请参阅[拦截器 javadocs](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/Interceptor.html)

# formatting - 如何向高中黑客解释缩进和冗长的变量名是好事？

> ID：533958
> 
> 赞同：0
> 
> 时间：2009-02-10T20:09:33.037
> 
> 标签：formatting, coding-style, children

他是一名优秀的程序员（赢得了一些比赛），但他绝对忽略了格式化。他认为 i, j, k 很漂亮...我希望他不会发现 goto 关键字的存在。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-10T20:13:19.580

以他的“风格”编写一些代码，然后让他阅读并解释它在做什么。

对鹅有什么好处...

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-28T07:11:27.083

我告诉我的学生（中学后），他们可以选择写好代码，或者我以与他们编写代码相同的方式编写作业。我告诉他们我会编写以下程序：

*   接受作业的文本
*   在同义词库中查找一些单词并将它们替换为晦涩的版本
*   删除所有标点符号
*   删除所有空格
*   将所有内容转换为小写
*   插入随机空格
*   大写随机字母

然后他们可以完成任务......嘿，它的“正确”（所有单词都在那里）祝你好运，尽管理解任务是什么。

奇怪的是，投诉在那一刻停止了:-)

我也将它与英语进行了比较。我们使用分节符、大写字母等……作为惯例。当有人选择不遵守约定时，阅读就会变得更加困难。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-10T20:11:30.083

告诉他关于 python 的事 :)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-10T20:21:03.383

让他维护别人的代码，这些代码是按照他的方式编写的。然后让他维护别人写的风格很好的代码。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-10T20:23:07.623

FORTRAN77 和 Python 的组合应该可以解决他的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T20:18:23.203

代码可维护性

我在高中时也不在乎的东西:)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T20:20:29.983

写一堆“他的”代码，让他找到一段特定的代码。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T20:20:58.907

给他一些写得很糟糕的代码，其中有错误，并要求他找出错误。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-10T20:15:52.880

好吧，如果他打算以此为生，请解释说，如果他至少不努力遵循团队标准，他将在真正的团队中度过非常艰难的生活。如果他不打算以此为生，请不要担心。

您还可以确定是否有他钦佩的人。如果有，那么他们很有可能遵循标准。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-10T20:21:30.090

你可能做不到。有些人就是不明白。我在工作和私下都使用自我描述的变量名，没有人告诉我。我在工作中也因使用长且易于理解的名称而受到赞赏。

如果一个人既不为自己也不为你的项目做这件事，那么你就是这样的人。给他看一些关于源代码风格政策的文档。解释为什么这很重要。

在您获得一些经验并了解这如何以及为什么有用之后，您开始使用正确的命名约定。没有经验，这只是一个抽象的谈话。

PS 有时我会被变量名卡住，因为我不确定这个特定的名字是否符合我在当前项目中使用的常见语言风格，或者这个名字在高级文学语言上的比例如何。自大学第一年以来，使用 bool b1 与 bool IsSomePropertyAvailable 的问题从未出现过。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-10T20:22:10.370

我要指出，拥有干净的代码是有组织和聪明的头脑的标志。然而，真正的杀手将是他编写大量代码时。我怀疑你能否说服他，因为他很可能对应用程序的逻辑而不是过程感到兴奋。给他一个严厉的教训需要经验。所以这是我的建议。

*   给他一个项目，里面满是乱七八糟的无格式代码，让他受苦。*   鼓励他从事一个拥有大量代码库的项目，并让他看看他在第 1,000 个源文件之后对自己的变量名的记忆有多好。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-10T20:42:49.103

我很确定您可以错误地配置代码美化器来呈现如此可怕的输出。混淆器很常见，并且基本上做同样的事情（简短的无用变量名，没有缩进，空白使用不当）。

给他分配以他的风格执行现有程序并添加微不足道的功能的任务。

另外，拿他 6 个月或更长时间前编写的代码并给出相同的任务。

-亚当

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-10T20:45:00.317

也许他不是无知，也许他只是受到了 Kernighan & Pike 的启发。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-02-10T20:55:50.257

i,j,k 适用于循环。

我个人更喜欢在迭代中使用 1 个字母的变量...

```
foreach ($test as $t) 
{
} 
```

美丽 :D

# lisp - 如何运行 Sutton 和 Barton 的“强化学习”Lisp 代码？

> ID：533960
> 
> 赞同：7
> 
> 时间：2009-02-10T20:09:45.907
> 
> 标签：lisp, artificial-intelligence, common-lisp, reinforcement-learning, mcl

我最近阅读了很多关于[强化学习](http://en.wikipedia.org/wiki/Reinforcement_Learning)的内容，我发现[“强化学习：简介”](http://incompleteideas.net/sutton/book/ebook/the-book.html)是一本很好的指南。作者为他们的许多工作示例提供了有用的[源代码。](http://incompleteideas.net/sutton/book/code/code.html)

在我开始这个问题之前，我应该指出我对 lisp 的实际知识很少。我知道基本概念及其工作原理，但我从未真正以有意义的方式使用 lisp，所以很可能我只是在做一些令人难以置信的 n00b-ish。:)

另外，作者在他的页面上声明他不会回答有关他的代码的问题，所以我没有联系他，并认为 Stack Overflow 会是一个更好的选择。

我一直在尝试在 linux 机器上运行代码，同时使用 GNU 的 CLISP 和 SBCL，但无法运行它。我不断使用任一解释器获取完整的错误列表。特别是，大多数代码似乎使用了包含在文件“utilities.lisp”中的许多实用程序，该文件包含以下行

```
(defpackage :rss-utilities
  (:use :common-lisp :ccl)
  (:nicknames :ut))

(in-package :ut) 
```

:ccl 似乎是指某种基于 Mac 的 lisp 版本，但我无法确认这一点，它可能只是其他一些代码包。

```
> * (load "utilities.lisp")
>
> debugger invoked on a
> SB-KERNEL:SIMPLE-PACKAGE-ERROR in
> thread #<THREAD "initial thread"
> RUNNING {100266AC51}>:   The name
> "CCL" does not designate any package.
> 
> Type HELP for debugger help, or
> (SB-EXT:QUIT) to exit from SBCL.
> 
> restarts (invokable by number or by
> possibly-abbreviated name):   0:
> [ABORT] Exit debugger, returning to
> top level.
> 
> (SB-INT:%FIND-PACKAGE-OR-LOSE "CCL") 
```

我尝试删除这个特定的部分（将行更改为

```
 (:use :common-lisp) 
```

但这只会产生更多错误。

```
> ; in: LAMBDA NIL ;     (+
> RSS-UTILITIES::*MENUBAR-BOTTOM* ;     
> (/ (- RSS-UTILITIES::MAX-V
> RSS-UTILITIES::V-SIZE) 2)) ;  ; caught
> WARNING: ;   undefined variable:
> *MENUBAR-BOTTOM*
> 
> ;     (-
> RSS-UTILITIES::*SCREEN-HEIGHT*
> RSS-UTILITIES::*MENUBAR-BOTTOM*) ;  ;
> caught WARNING: ;   undefined
> variable: *SCREEN-HEIGHT*
> 
> ;     (IF RSS-UTILITIES::CONTAINER ;  
> (RSS-UTILITIES::POINT-H ;         
> (RSS-UTILITIES::VIEW-SIZE
> RSS-UTILITIES::CONTAINER)) ;        
> RSS-UTILITIES::*SCREEN-WIDTH*) ;  ;
> caught WARNING: ;   undefined
> variable: *SCREEN-WIDTH*
> 
> ;     (RSS-UTILITIES::POINT-H
> (RSS-UTILITIES::VIEW-SIZE
> RSS-UTILITIES::VIEW)) ;  ; caught
> STYLE-WARNING: ;   undefined function:
> POINT-H
> 
> ;     (RSS-UTILITIES::POINT-V
> (RSS-UTILITIES::VIEW-SIZE
> RSS-UTILITIES::VIEW)) ;  ; caught
> STYLE-WARNING: ;   undefined function:
> POINT-V 
```

有人知道我如何运行这段代码吗？我只是对所有的lisp一无所知吗？

**更新 [2009 年 3 月]：**我安装了 Clozure，但仍然无法让代码运行。

在 CCL 命令提示符下，命令

```
(load "utilities.lisp") 
```

导致以下错误输出：

```
;Compiler warnings :
;   In CENTER-VIEW: Undeclared free variable *SCREEN-HEIGHT*
;   In CENTER-VIEW: Undeclared free variable *SCREEN-WIDTH*
;   In CENTER-VIEW: Undeclared free variable *MENUBAR-BOTTOM* (2 references)
> Error: Undefined function RANDOM-STATE called with arguments (64497 9) .
> While executing: CCL::READ-DISPATCH, in process listener(1).
> Type :GO to continue, :POP to abort, :R for a list of available restarts.
> If continued: Retry applying RANDOM-STATE to (64497 9).
> Type :? for other options.
1 > 
```

不幸的是，我还在学习 lisp，所以虽然我感觉有些东西没有完全定义，但我并不真正理解如何阅读这些错误消息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T00:45:44.403

我的猜测是代码依赖于 CCL，所以使用[CCL](http://www.cliki.net/CCL)而不是 CLISP 或 SBCL。你可以从这里下载它：http: [//trac.clozure.com/openmcl](http://trac.clozure.com/openmcl)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T02:16:17.810

该代码适用于 Macintosh Common Lisp (MCL)。它只会在那里运行。使用 Clozure CL (CCL) 将无济于事。您必须注释图形代码。随机状态的东西对于 MCL 也有点特殊。您必须将其移植到可移植的 Common Lisp（[make-random-state](http://www.lispworks.com/documentation/HyperSpec/Body/f_mk_rnd.htm)等）。此外，文件名对于 Mac 来说是特殊的。

Clozure CL 是 Macintosh Common Lisp 的一个分支，但已更改为 Unix 约定（路径名，...），并且不包含 MCL 的特殊图形代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-13T03:05:29.117

在 linux x86 上使用最新版本的 CCL，将此文件保存为 foo.lisp：

```
#+ccl (defun random-state (x y)
        (ccl::initialize-random-state x y))

(load "utilities.lisp")
(use-package 'rss-utilities)

(load "testbed.lisp")

(setup)
(init)

(print (runs 10 10 .1)) 
```

跑步

```
~/svn/ccl/lx86cl -l foo.lisp 
```

打印一堆警告消息和所需的答案：

```
(-0.77201915 0.59691894 0.78171235 0.41514033 0.6744591 0.26383805 0.8981678 1.1274683 0.50265205 0.4081622) 
```

为了找出所需的#'random-state defun，我猜测“#.(RANDOM-STATE 64497 9)”是来自 MCL 的序列化随机状态对象。为了了解 CCL 是如何处理的，我检查了 CCL 中的 MAKE-RANDOM-STATE 输出：

```
$ ~/svn/ccl/lx86cl 
Welcome to Clozure Common Lisp Version 1.3-r11936  (LinuxX8632)!
? (make-random-state)
#.(CCL::INITIALIZE-RANDOM-STATE 64497 9) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-13T08:23:39.620

如果您从未以有意义的方式使用过 lisp，则有一个[Matlab 代码](http://waxworksmath.com/Authors/N_Z/Sutton/sutton.html)，用于“强化学习：简介”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-29T02:54:40.477

除了[Rainer Joswig 的回答](https://stackoverflow.com/a/641231/2584145)：安装 Clozure 后，您必须将对该函数`RANDOM-STATE`的引用更新`utilities.lisp`为`random-mrg31k3p-state`.

更具体地说，替换：`#.(RANDOM-STATE 64497 9)`与`#.(ccl::random-mrg31k3p-state)`

`random-mrg31k3p-state`似乎`random-state`在编写代码后的某个时间已被替换，请参阅[l1-numbers.lisp?rev=13327](http://trac.clozure.com/ccl/changeset/13327/trunk/source/level-1/l1-numbers.lisp)

# security - 为什么通过默默无闻的安全是一个坏主意？

> ID：533965
> 
> 赞同：78
> 
> 时间：2009-02-10T20:10:07.543
> 
> 标签：security, encryption, security-by-obscurity

我最近遇到了一个系统，其中所有 DB 连接都由以各种方式隐藏的例程进行管理，包括 base 64 编码、md5sums 和各种其他技术。

为什么通过默默无闻的安全是一个坏主意？

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2009-02-10T20:17:39.460

通过默默无闻的安全将把你的钱埋在一棵树下。唯一让它安全的是没有人知道它的存在。真正的安全是把它放在锁或密码后面，比如保险箱。**你可以把保险箱放在街角，因为它的安全性在于除了你**之外没有人能进去。

正如@ThomasPadron-McCarty 在下面的评论中提到的：

> 如果有人发现密码，您只需更改密码，这很容易。如果有人找到了这个位置，你需要把钱挖出来搬到别的地方，这是更多的工作。如果你在程序中使用隐蔽的安全性，你将不得不重写程序。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-02-10T20:14:52.197

通过默默无闻的安全性可以说是不好的，因为它通常意味着默默无闻被用作主要的安全手段。在被发现之前，默默无闻是好的，但是一旦有人解决了你的特殊默默无闻，那么你的系统就会再次脆弱。鉴于攻击者的持续存在，这等同于根本没有安全性。

不应该使用模糊性来替代适当的安全技术。

作为隐藏源代码以防止复制的一种手段，晦涩难懂是另一个主题。我在这个话题上意见不一。我可以理解您为什么希望这样做，就我个人而言，我从未遇到过需要这样做的情况。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-02-10T21:34:08.183

通过默默无闻的安全性是一个有趣的话题。它（正确地）被诽谤为有效安全的替代品。密码学的一个典型原则是消息是未知的，但内容是未知的。加密算法通常被广泛发布，由数学家分析，一段时间后，人们对它们的有效性建立了一些信心，但永远不能保证它们是有效的。

有些人隐藏了他们的加密算法，但这被认为是一种危险的做法，因为这样的算法没有经过同样的审查。只有像美国国家安全局这样拥有大量预算和数学家人员的组织才能摆脱这种方法。

近年来更有趣的发展之一是[隐写术](http://en.wikipedia.org/wiki/Steganography)的风险，这种做法是将信息隐藏在图像、声音文件或其他介质中。隐写分析中最大的问题是识别消息是否存在，通过模糊来确保这种安全性。

去年我遇到了一个[研究人员计算隐写通道容量的](http://it.slashdot.org/article.pl?sid=08/11/04/1354207)故事，但真正有趣的是：

> 以这种方式研究隐写通道会导致一些违反直觉的结果：例如，在某些情况下，将查找隐藏数据的算法数量增加一倍可以增加隐写通道的容量。

换句话说，您用于识别消息的算法越多，它变得越不有效，这与通过默默无闻对安全性的正常批评背道而驰。

有趣的东西。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-02-10T20:12:32.140

这是一个坏主意的主要原因是它没有解决潜在的问题，只是试图隐藏它们。迟早会发现问题。

此外，额外的加密会产生额外的开销。

最后，过度模糊（如使用校验和）使维护成为一场噩梦。

更好的安全替代方案是消除代码中的潜在弱点，例如强制输入以防止注入攻击。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-10T20:34:51.573

从安全漏洞中恢复的能力之一。如果有人发现您的密码，只需重置它。但是，如果有人发现了您晦涩难懂的计划，那您就完蛋了。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-10T21:18:59.563

像所有这些人都同意的那样使用默默无闻不是安全，而是为自己争取时间。也就是说，实施一个体面的安全系统，然后添加一层额外的默默无闻仍然是有用的。假设明天有人在无法立即修补的 ssh 服务中发现了无与伦比的裂缝/漏洞。

作为一项规则，我已经在内部实现了......所有面向公众的服务器只公开所需的端口（ http/https ），仅此而已。然后，一台面向公众的服务器将在某个不起眼的高编号端口处将 ssh 暴露给 Internet，并设置端口扫描触发器以阻止任何试图找到它的 IP。

默默无闻在安全世界中占有一席之地，但不是第一道和最后一道防线。在上面的示例中，我没有对 ssh 进行任何脚本/机器人攻击，因为他们不想花时间搜索非标准的 ssh 服务端口，如果他们这样做了，他们不太可能在另一层之前找到它安全人员介入并切断了他们。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-10T22:21:20.677

所有可用的安全形式实际上都是通过默默无闻的安全形式。每种方法都增加了复杂性并提供了更好的安全性，但它们都依赖于某种算法和一个或多个密钥来恢复加密数据。当有人选择一种最简单、最容易破解的算法时，大多数人称之为“通过默默无闻实现安全”。

诸如字符转换之类的算法易于实现且易于破解，这就是为什么它们不是一个好主意。它可能总比没有好，但它最多只会阻止随意浏览数据以防止轻松阅读。

互联网上有很多优秀的资源，您可以使用这些资源来了解所有可用的加密方法及其优缺点。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-11T16:43:23.273

安全是关于让人们进入或阻止他们，这取决于他们知道什么、他们是谁或他们拥有什么。目前，生物识别技术并不擅长找出你是谁，而且总是会出现问题（指纹读取器用于遇到严重事故的人，伪造指纹等）。因此，实际上，大部分安全性都是关于混淆某些东西。

良好的安全性是将您必须保密的东西保持在最低限度。如果你有一个正确加密的 AES 通道，你可以让坏人看到除了密码之外的一切，你就安全了。这意味着您有一个更小的区域可以被攻击，并且可以专注于保护密码。（并不是说那是微不足道的。）

为此，您必须对除密码之外的所有内容都充满信心。这通常意味着使用许多专家研究过的行业标准加密货币。任何人都可以创造一个他们无法破解的密码，但不是每个人都能创造出 Bruce Schneier 无法破解的密码。由于完全缺乏密码安全性的理论基础，密码的安全性取决于有很多非常聪明和知识渊博的人尝试提出攻击，即使它们不实用（对密码的攻击总是会变得更好） ，永远不会更糟）。这意味着加密算法需要广为人知。我对高级加密标准非常有信心，而乔编写和混淆的专有算法几乎没有。

但是，加密算法的实现存在问题。很容易在不经意间留下可以找到钥匙或进行其他恶作剧的孔。它发生在 PGP 的备用签名字段以及在 Debian Linux 上实现的 SSL 的弱点上。它甚至发生在 OpenBSD 上，它可能是现成的最安全的操作系统（我认为十年内最多有两次漏洞利用）。因此，这些应该由一家有信誉的公司来完成，如果实现是开源的，我会感觉更好。（封闭的源代码不会阻止一个坚定的攻击者，但它会让随机的好人更难找到要关闭的漏洞。）

因此，如果我想要安全，我会尽量让我的系统尽可能可靠，这意味着除了密码之外尽可能开放。

在已经安全的系统之上通过默默无闻的分层安全性可能会有所帮助，但如果系统是安全的，则没有必要，如果它不安全，最好的办法是使其安全。将默默无闻想象成不太知名的“替代医学”形式——它不太可能有太大帮助，虽然它本身不太可能造成太大伤害，但它可能会使患者不太可能去看有能力的医生或计算机安全专家，无论哪一个。

最后，作为一个感兴趣的读者，我想为[Bruce Schneier 的博客制作一个完全不请自来且无私的插件。](http://www.schneier.com/blog/)我从中学到了很多关于安全的知识。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-10T20:27:53.070

评估、测试或改进安全产品的最佳方法之一是让一个庞大的、聪明的同行群体对它进行测试。

依靠“黑匣子”来保证安全性的产品无法从这种测试中受益。当然，作为“黑匣子”总是会引起怀疑（通常是有道理的），即他们无论如何都不会经受住这种审查。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-11T15:14:46.827

我曾在一个案例中辩称，密码保护实际上是通过默默无闻实现的安全性。我能想到的唯一安全性不会是 STO 是某种生物识别安全性。

除了那一点语义和挑剔之外，STO（通过默默无闻的安全性）在任何需要真正安全的情况下显然都是不好的。但是，可能存在无关紧要的情况。我会经常异或填充一个我不想让任何人阅读的文本文件。但我真的不在乎他们是否这样做，我只是希望它不被阅读。在这种情况下，这无关紧要，XOR 垫是易于查找 STO 的完美示例。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-10T20:14:18.267

这[几乎从来都不](http://en.wikipedia.org/wiki/Security_through_obscurity)是一个好主意。同理，开车不系安全带好不好？当然，您可以找到一些适合的情况，但是由于经验的原因，答案似乎很明显。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-10T22:44:39.437

弱加密只会阻止最不积极的黑客，因此它并非毫无价值，只是不是很有价值，尤其是当 AES 等强加密可用时。

通过默默无闻的安全性是基于您很聪明而您的用户很愚蠢的假设。如果该假设是基于傲慢而不是经验数据，那么您的用户和黑客将确定如何调用隐藏方法、打开未链接的页面、反编译并从 .dll 中提取纯文本密码等。

也就是说，向用户提供全面的元数据并不是一个好主意，只要你用加密、授权、身份验证和所有其他安全原则来支持它，隐藏是完全有效的技术。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-10T22:35:54.370

如果操作系统是 Windows，请考虑使用数据保护 API (DPAPI)。它不是默默无闻的安全性，并且是为无人参与的过程存储登录凭据的好方法。正如几乎每个人在这里所说的那样，通过默默无闻的安全性并不能为您提供太多保护。

[http://msdn.microsoft.com/en-us/library/ms995355.aspx](http://msdn.microsoft.com/en-us/library/ms995355.aspx)

[http://msdn.microsoft.com/en-us/library/ms998280.aspx](http://msdn.microsoft.com/en-us/library/ms998280.aspx)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-11T17:50:17.623

我必须补充的一点尚未涉及，那就是互联网通过默默无闻粉碎安全的令人难以置信的能力。

正如一次又一次证明的那样，如果你唯一的防御是“没有人知道后门/漏洞/漏洞的存在”，那么只需要一个人偶然发现它，几分钟之内，数百人就会知道。第二天，几乎每个想知道的人都会。哎哟。

# .net - .NET 客户端与 ActiveX（或其他方法？）

> ID：533967
> 
> 赞同：2
> 
> 时间：2009-02-10T20:10:17.607
> 
> 标签：.net, wpf, silverlight, activex, xbap

有没有人有任何白皮书或文章可以比较和对比需要 .NET 客户端组件并且正在考虑的选项是 ActiveX 或 .Net 组件解决方案的 Web 架构？

我有一个客户想要在架构上推荐一个.Net 客户端方法而不是 Active X。但是，对于 ActiveX 有一些强烈的意见。我想做的是为我们的方向收集更多的背景和行业支持。

我个人不建议任何人再编写 ActiveX 组件。如果他们需要浏览器部署模型中的增强功能，我通常建议通过 XBAP 使用 WPF 或编写 Silverlight 应用程序。理想情况下，我想讨论一下标准网络、增强网络 (silverlight) 或平台优化 (WPF) 的优缺点。

这是你们可以帮助我们指出正确方向的事情吗？有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T19:24:04.340

上面的链接很棒。我想澄清一下，虽然 XBAP 和 ClickOnce 应用程序默认在沙箱中运行，但它们可以提升到更高的信任度。这对 XBAP 来说比较棘手，因为它要求客户机器上存在代码访问安全策略，并且没有简单的方法可以实现它（除了网络启动的 MSI 之外）。

Click-Once 应用程序可以在清单中指定它们需要提升的权限（这在项目设置中完成）。首次启动应用程序时，如果应用程序需要比默认区域（通常是 Internet）更多的权限，则会提示并警告用户，但他们*可以*批准提升的权限。

Silverlight 只能在安全的沙盒中运行，无法提升。有一种访问本地存储的安全方法，但无法直接与 USB 设备等其他硬件进行交互。Silverlight 非常适合（几乎）零接触应用程序部署，只要应用程序可以存在于 Silverlight 提供的安全和功能边界内。然而，Silverlight 确实在继续发展，并且这些界限继续扩大。例如，使用 Live Framework，我们现在可以在离线模式下在桌面上的浏览器之外运行 Silverlight 应用程序并进行数据同步。我[在第 9 频道上](http://channel9.msdn.com/posts/jbienz/Live-Framework-and-Always-Available-Social-Applications/)有一个关于此的截屏视频。

我也会避免使用 ActiveX，除非您无法在这些其他配置文件之一中满足您的需要。ActiveX 在每个浏览器版本中都受到越来越多的限制，而且它比其他浏览器更难控制，安全性也更低。ActiveX 可能是 IT 专业人员的管理难题，这反过来又使您的应用程序部署在企业中变得更具挑战性。

希望对您的项目有所帮助并祝您好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T20:39:12.763

我在 2007 年写过这篇文章——它今天仍然适用——尽管最近我发现人们对将 Silverlight 用于业务线应用程序很感兴趣。

*   [何时使用哪种 Microsoft 演示技术](http://blogs.msdn.com/synergist/archive/2007/07/10/when-to-use-which-microsoft-presentation-technology.aspx)

*   [有关何时使用哪种演示技术的更多详细信息](http://blogs.msdn.com/synergist/archive/2007/10/10/more-detail-on-when-to-use-which-presentation-technology.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T20:42:50.570

安全性通常是您最大的卖点。XBAP 应用程序始终在沙箱中运行，而 ActiveX 则不在。

我找到了以下微软博客条目：[XBAP = next-generation ActiveX？](http://rrelyea.spaces.live.com/blog/cns!167AD7A5AB58D5FE!1553.entry)乐于助人。

# c# - c#“finally”块，只在异常上运行

> ID：533968
> 
> 赞同：7
> 
> 时间：2009-02-10T20:10:21.287
> 
> 标签：c#, exception, finally

编辑：我查看了答案代码：**他们**都没有做我想要的（我已经检查过）。似乎没有办法在本机 c# 中做我想做的事。我想这不是一场灾难，只是一种耻辱，因为 .NET 确实支持它（见接受的答案）。

谢谢大家。

* * *

我有像这样的 c# 代码（测试框架的一部分，除非在调试器下运行，否则永远不会运行）谁指出它是为了避免实际捕获异常，因为这使得调试堆栈未展开部分中的代码非常痛苦。

```
Bool bad = true;
try
{
   MightThrow();
   bad = false;
}
finally
{
   if(bad) DoSomeLoggingOnFailure();

   //// Does not catch!!!! 
   //// exception continues to unwind stack.

   //// Note that re throwing the exception is NOT
   //// the same as not catching it in the first place
} 
```

他们是更好的方法吗？

> 对于未捕获的异常，解决方案的行为必须与调试器下的行为完全相同。它必须导致唯一的第一次机会异常，并且调试器在*最初*引发异常的点中断，而不是在 catch 块中。
> 
> 具体来说，我需要未捕获异常的调试器来停止 MightThrow。

以下不起作用，因为它无法让调试器在正确的位置中断

```
try { ... } catch { throw; } 
```

这不起作用，因为它会丢失堆栈信息（并且还会在错误的位置中断）。

```
try { ... } catch(Exception e) { throw e; } 
```

我知道在[D](http://www.digitalmars.com/d/1.0/)中我可以使用[`scope(failure)`](http://www.digitalmars.com/d/1.0/statement.html#ScopeGuardStatement)块

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-10T21:17:19.677

因此，在 .NET 中，您所要求的在理论上是可能的，但这并不容易。

CIL实际上定义了*五种*异常处理块！您在 C# 中习惯使用的 、 和 ，以及另外`try`两个`catch`：`finally`

*   `filter`- 类似于`catch`块，但可以运行任意代码来确定它是否要处理错误，而不仅仅是匹配类型。此块可以访问异常对象，并且对异常堆栈跟踪具有与`catch`块相同的效果。

*   `fault`- 类似于`finally`块，但它仅在发生异常时运行。此块无权访问异常对象，并且对异常堆栈跟踪没有影响（就像`finally`块一样）。

`filter`在某些 .NET 语言（例如 VB.NET、C++/CLI）中可用，但在 C# 中不可用，遗憾的是。但是，除了 CIL 之外，我不知道任何允许`fault`表达块的语言。

因为它*可以*在 IL 中完成，所以并不是所有的都丢失了。理论上，您可以使用 Reflection.Emit 动态发出具有`fault`块的函数，然后将要运行的代码作为 lambda 表达式传递（即，一个用于尝试部分，一个用于错误部分，依此类推），但是(a) 这并不容易，并且 (b) 我不相信这实际上会给你一个比你目前得到的更有用的堆栈跟踪。

抱歉，答案不是“这里是怎么做”类型的事情，但至少现在你知道了！你现在正在做的可能是最好的方法恕我直言。

* * *

请注意那些说问题中使用的方法是“不好的做法”的人，实际上不是。当你实现一个`catch`块时，你是在说“发生异常时我需要对异常对象做一些事情”，而当你实现一个块时，`finally`你是在说“我不需要异常对象，但我需要先做一些事情函数结束”。

如果您实际上想说的是“我不需要异常对象，但是当异常发生时我需要做一些事情”，那么您介于两者之间，即您想要一个`fault`块。由于这在 C# 中不可用，因此您没有理想的选项，因此您不妨选择不太可能因忘记重新抛出而导致错误并且不会破坏堆栈跟踪的选项。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-02-10T20:12:53.327

这个怎么样：

```
try
{
  MightThrow();
}
catch
{
  DoSomethingOnFailure();
  throw; // added based on new information in the original question
} 
```

真的，这就是你所做的一切。finally 用于无论是否发生异常都必须运行的事情。

[**编辑：**澄清]

根据您提到的评论，您希望在不修改其原始堆栈跟踪的情况下继续抛出异常。在这种情况下，您想使用我添加的简单投掷。这将允许异常继续向上堆栈，并且仍然允许您处理部分异常。典型情况可能是关闭网络连接或文件。

[**第二次编辑：**关于你的澄清]

> 具体来说，我需要未捕获异常的调试器停止在抛出的原始点（在 MightThrow 中）而不是在 catch 块中。

我反对打破最佳实践（是的，这是部分处理异常的最佳实践）来为您的调试增加一些小价值。您可以轻松地检查异常以确定异常抛出的位置。

[**最终编辑：**你有你的答案]

[kronoz](https://stackoverflow.com/questions/533968/c-finally-block-that-only-runs-on-exceptions/534086#534086)为您提供了您所寻求的答案。不要破坏最佳实践——正确使用 Visual Studio！您可以将 Visual Studio 设置为在引发异常时准确中断。这是[有关该主题的官方信息](http://msdn.microsoft.com/en-us/library/d14azbfh.aspx)。

我实际上不知道这个功能，所以去给他接受的答案。但是，请不要试图以某种时髦的方式处理异常，只是为了让自己手动调试。你所做的就是向更多的错误敞开心扉。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-10T20:38:24.263

如果您对调试器感兴趣，只是在发生异常的位置精确停止，那么您是否考虑过第一次机会异常？

如果您打开 Tools|Exceptions 然后勾选 Common Language Runtime Exceptions 框，调试器将在异常点停止，而不管任何 try/catch/finally 块。

**更新**：您可以通过展开“异常”对话框中的 [+] 树来指定要捕获的精确异常。当然，每次发生指定类型[s]的*任何*异常时它都会触发[s]，即使在调试会话中间，您也可以随意打开和关闭它，因此明智地使用断点可以得到它做你的竞标。我成功地使用它来解决源自使用反射实例化对象的“调用目标已引发异常”的球痛。在这种情况下非常有用的工具。另请注意，据我所知，本地人和堆栈跟踪应该是可靠的（只是做了一个快速测试并且它们*是*可用的），所以那里没有问题。

当然，如果您想记录一些东西，那么这超出了 IDE 调试器的范围；在这种情况下，第一次机会例外不会帮助你！

至少试一试；我发现它们非常有用，它们可能比您想象的更适合您的问题。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-10T20:13:17.910

有什么问题：

```
try
{
   MightThrow();
}
catch
{
   DoSomthingOnFailure();
   throw;
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-10T20:13:39.190

对于只应在异常上运行的代码，请使用 catch 块：

```
try
{
   MightThrow();
}
catch (Exception ex)
{
   // this runs only when there was an exception
   DoSomthingOnFailure();
   // pass exception on to caller
   throw; 
}
finally
{
   // this runs everytime
   Cleanup();
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-10T20:16:41.850

这就是你想要的。它只会在发生错误时调用该方法，而“throw”语句将在调用堆栈完好无损的情况下重新抛出异常。

```
try
{
   MightThrow();
}
catch
{
   DoSomthingOnFailure();
   throw;
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-10T20:21:19.780

仅在失败时运行的“finally”块称为“catch”（没有参数）。:-)

现在，有一个小警告。如果您想为特定异常类型提供专门的“catch”案例*并*拥有适用于所有异常的通用“catch”，则必须执行一些自定义逻辑。

因此，我会做类似的事情：

```
 try
  {
    MightThrow();
  }
  catch(MyException ex)
  {
    // Runs on MyException
    MySpecificFailureHandler()
    // Since we have handled the exception and can't execute the generic
    // "catch" block below, we need to explicitly run the generic failure handler
    MyGenericFailureHandler()
  }
  catch
  {
    // Runs on any exception hot handled specifically before
    MyGenericFailureHandler()
    // If you want to mimic "finally" behavior and propagate the exception
    // up the call stack
    throw;
  }
  finally
  {
    // Runs on any failure or success
    MyGenericCleanupHandler();
  } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-10T20:41:34.677

根据我的测试，到目前为止，每个示例都丢失了原始的 StackTrace。这是一个适合您的解决方案。

```
private static void PreserveStackTrace(Exception exception)
{
  MethodInfo preserveStackTrace = typeof(Exception).GetMethod("InternalPreserveStackTrace",
    BindingFlags.Instance | BindingFlags.NonPublic);
  preserveStackTrace.Invoke(exception, null);
}

try
{
   MightThrow();
}
catch (Exception ex)
{
    DoSomethingOnFailure();
    PreserveStackTrace(ex);
    throw;
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-10T21:14:12.150

**只捕获“MightThrow”不**抛出的异常怎么样？

```
Bool bad = true;
try
{
   MightThrow();
   bad = false;
}
catch (SomePrivateMadeUpException foo)
{ 
   //empty
}
finally
{
   if(bad) DoSomeLoggingOnFailure();   
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-10T21:37:22.123

让我以我理解的方式概括您的要求：

1.  您需要一些仅在生成异常时运行的代码，以便进行一些日志记录。
2.  您希望在调试器下运行您的测试框架并在抛出异常时中断。

为了满足您的第一个要求，您应该按照大家建议的方式编写代码 - 使用无参数的 catch 和 throw。

为了在使用无参数 catch 时满足您的第二个要求，您可以将调试器配置为在抛出异常时中断，而不仅仅是在出现未处理的异常时。我怀疑你知道怎么做，但我把它放在这里是为了回答的完整性：在 VS 中，你可以在 Debug -> Exception -> Common Language Runtime Exceptions -> 检查 Thrown 复选框中做到这一点。

如果您知道您的应用程序会引发大量已处理的异常，那么这可能不是您的选择。在这一点上，满足您的第一个要求的唯一选择是编写代码最终用于异常记录目的，或者按照 Greg Beech 的建议查看直接发出 IL 的路线。

但是，最终代码是否正在执行取决于您使用的调试器。特别是，VS 会在 finally 执行之前因未处理的异常而中断，并且不会让您继续。因此，除非您此时从进程中分离，否则您的日志记录代码将永远不会被执行。换句话说，第二个要求会干扰满足第一个要求。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-11T00:37:06.247

您可以将逻辑封装在自定义类中，例如：

```
 public  class Executor
{
    private readonly Action mainActionDelegate;
    private readonly Action onFaultDelegate;

    public Executor(Action mainAction, Action onFault)
    {
        mainActionDelegate = mainAction;
        onFaultDelegate = onFault;
    }

    public  void Run()
    {
        bool bad = true;
        try
        {
            mainActionDelegate();
            bad = false;
        }
        finally
        {
            if(bad)
            {
                onFaultDelegate();
            }
        }
    }

} 
```

并将其用作：

```
 new Executor(MightThrow, DoSomeLoggingOnFailure).Run(); 
```

希望这可以帮助。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-10T20:13:30.983

这不与以下内容相同：

```
try 
{
    MightThrow();
}
catch (Exception e) 
{
    DoSomethingOnFailure();
    throw e;
} 
```

?

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-01-06T23:06:39.423

您可以在 VB.net 中编写或让某人为您编写一个小程序集，该程序集实现了接受四个委托的 TryFaultCatchFinally(of T) 方法：

1.  TryMethod -- 执行“Try”块的 Action(of T)。
2.  FaultMethod——一个 Predicate(Of T, Exception)，如果发生异常，将*在*任何“finally”块运行之前调用；如果它返回 true，则 Catch 块将运行 - 否则不会。
3.  CatchMethod -- 如果发生异常并且 FaultMethod 返回 true，则要执行的 Action(Of T, Exception)；在“终于”块运行之后发生。
4.  FinalMethod -- 一个 Action(OF T, Exception, Boolean) 作为“Finally”块执行。如果 TryMethod 运行完成，则传入的异常将为 null，或者将保留导致其退出的异常。如果异常被捕获，布尔值将为真，否则为假。

请注意，在执行 FaultMethod 时，可以检查导致异常的对象的状态，然后再由 finally 块破坏这种状态。执行此操作时必须小心（在抛出异常时持有的任何锁都将继续持有），但该功能有时仍然很方便，尤其是在调试时。

我建议例程看起来像：

```
    Shared Sub TryFaultCatchFinally(Of T)(ByVal TryProc As Action(Of T), _
                                          ByVal FaultProc As Func(Of T, Exception, Boolean), _
                                          ByVal CatchProc 作为动作（T，异常），_
                                          ByVal finallyProc As Action(Of T, Exception, Boolean), _
                                          ByVal 值作为 T)
        将异常调暗为异常 = 无
        Dim exceptionCaught As Boolean = False
        尝试
            TryProc（值）
            theException = 没有
            异常捕获 = 假
        当 CopyExceptionAndReturnFalse(Ex, theException) OrElse FaultProc(Value, Ex) 时将 Ex 作为异常捕获
            异常捕获=真
            CatchProc（值，前）
        最后
            finallyProc（值，异常，异常捕获）
        结束尝试
    结束子

```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-10T20:12:42.857

不，我认为这是一个常见的习惯用法。

编辑需要明确的是，“catch”然后“rethrow”策略提供相同的运行时语义，但是当附加 VS 调试器时它们会改变体验。工具和维护很重要；调试通常需要您“捕获所有第一次机会异常”，如果由于代码中的先捕获后重新抛出而导致大量“虚假”的第一次机会异常，那么它确实会损害调试代码的能力。这个习惯用法是关于与工具进行良好的交互，以及清楚地表达意图（您不想“捕获”，决定无法处理并重新抛出，相反，您只想记录确实发生了异常但让它通过）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-01-13T15:00:14.357

您是否考虑过使用 DebuggerStepThrough 属性？ [http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggerstepthroughattribute.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggerstepthroughattribute.aspx)

```
[DebuggerStepThrough]
internal void MyHelper(Action someCallback)
{
    try
    {
        someCallback();
    }
    catch(Exception ex)
    {
        // Debugger will not break here
        // because of the DebuggerStepThrough attribute
        DoSomething(ex);
        throw;
    }
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-12-04T20:07:49.233

在 C# 6 中添加异常过滤器后，一种选择是使用返回错误的异常过滤器，如下所示：

```
void PerformMightThrowWithExceptionLogging()
{
    try
    {
        MightThrow();
    }
    catch (Exception e) when (Log(e))
    {
        // Cannot enter here, since Log returns false.
    }
}

bool Log(Exception e)
{
   DoSomeLoggingOnFailure(e);
   // Return false so the exception filter is not matched, and therefore the stack is kept.
   // This means the debugger breaks where the exception actually happened, etc.
   return false;
} 
```

有关异常过滤器的更多详细信息，请参阅[https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/try-catch](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/try-catch)。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2009-02-10T20:13:09.470

```
try
{
   MightThrow();
}
catch
{
   DoSomethingOnFailure();
} 
```

# c# - 如何在 WPF 中将形状“粘贴”到鼠标上？

> ID：533999
> 
> 赞同：0
> 
> 时间：2009-02-10T20:15:29.090
> 
> 标签：c#, wpf

我有一个 wpf 应用程序，它在画布上有一些形状我想让用户单击一个形状，然后该形状被鼠标卡住，直到他们再次单击。

到目前为止，我对 WPF 知之甚少，所以请放轻松；）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T20:21:42.883

希望这是您正在寻找的。

“鼠标拖动逻辑相当简单：在 OnMouseDown 处理程序中，保存要拖动的对象和鼠标指针的位置，然后调用 CaptureMouse。在 OnMouseMove 中，计算当前鼠标指针坐标之间的差异位置和保存的位置，并将其添加到原始对象位置。（如果您在画布上，您可以通过为对象调用 Canvas.SetLeft 和 Canvas.SetTop 来移动对象；否则您可以调整 TranslateTransform 对象集到对象的 RenderTransform 属性。）在 OnMouseUp 中，您调用 ReleaseCapture。

因为您的应用程序可能会以其他方式丢失鼠标捕获（例如系统模式消息框的外观），您还需要覆盖 OnLostMouseCapture 以中止拖动操作（如果它没有被 OnMouseUp 终止）并执行清理. 如果用户按下 Escape 键，您可能还希望覆盖 OnTextInput 以中止拖动。”

[从http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/b6c51eef-269e-4c85-96af-b5b1e4cb9bd5/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/b6c51eef-269e-4c85-96af-b5b1e4cb9bd5/)复制， 该网站上也有代码说明如何做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T20:22:00.790

看看这个线程 - [http://silverlight.net/forums/t/68889.aspx](http://silverlight.net/forums/t/68889.aspx)

由于您的“棒”在画布上，请继续使用 MousePositions 在 MouseMove 上设置 Canvas.Left 和 Canvas.Top**`**