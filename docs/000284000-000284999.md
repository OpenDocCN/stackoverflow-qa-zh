# StackOverflow 问答 000284000-000284999

# eclipse - 使用热键转换选定的文本

> ID：284000
> 
> 赞同：3
> 
> 时间：2008-11-12T13:58:11.760
> 
> 标签：eclipse, hotkeys, textselection

我有这个代码：

我的变量

我想改成

跟踪（“我的变量：” + 我的变量）；

使用直接热键`alt`-`f12`来做到这一点。即不使用`ctrl`-`space`和箭头按钮。

日食有可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T15:43:13.077

我不知道是否可以为模板绑定热键。某种类似行为的一种方法可能是使用正确的模板名称并“自动插入”..

也就是说，您将编写*trcc*（例如），Eclipse 会自动将其扩展为模板*trace("${name}: " + ${name});* （你最终会编辑名称）。缺点是您应该选择这样一个名称，否则您将不会在代码中使用它。（所以如果你最终会为其他事情写 trcc，你应该选择另一个名字）

关于模板，[关于它们的一篇博客文章](http://homepage.mac.com/kelleherk/iblog/C1281128591/E20070302212710/index.html)。（注意 ${enclosing_type} 和 ${enclosing_method} 如果你还不熟悉它们）

# c++ - C++ 数组：包含类型的转换

> ID：284019
> 
> 赞同：2
> 
> 时间：2008-11-12T14:03:52.933
> 
> 标签：c++, arrays

在 C++ 中将固定长度的字符串数组转换为固定长度的整数数组的最佳方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-12T14:09:43.687

这会将一个字符数组复制到一个整数数组中：

```
#include <algorithm>
char foo[9] = "asdfasdf";
int bar[9];
std::copy(foo, foo+9, bar); 
```

[标准::复制](http://www.cppreference.com/wiki/stl/algorithm/copy)

这会将空终止字符数组 {'a', 's', 'd', 'f', 'a', 's', 'd', 'f', '\0'} 的值分配给整数数组，产生 {97, 115, 100, 102, 97, 115, 100, 102, 0}。请注意，这包括原始字符串的空终止。

* * *

这将解析一个字符串数组，并将它们的整数值放入一个整数数组中：

```
#include <algorithm>
#include <sstream>
#include <string>

template <class T>
T parse(const std::string& str)
{
    T temp;
    std::istringstream iss(str);
    iss >> temp;
    if(iss.bad() || iss.fail())
    {
        // handle conversion failure
    }
    return temp;
}

...

std::string foo[3];
int bar[3];
foo[0] = "67";
foo[1] = "11";
foo[2] = "42";

std::transform(foo, foo+3, bar, parse<int>); 
```

[标准::转换](http://www.cppreference.com/wiki/stl/algorithm/transform)

这会将数组 foo 中的每个字符串转换为整数，并将它们放入整数数组 bar 中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-12T14:25:50.410

```
#include <algorithm>

std::string foo[9];
int bar[9];

std::transform(foo, foo+9, bar, MyMagicStringToIntFunction); 
```

MyMagicStringToIntFunction 是您希望用于将字符串转换为整数的任何函数。由于您没有具体说明您希望如何完成，我无法回答那部分。

这是我对您想要做什么的猜测，但更多信息会有所帮助。（“字符串数组是指 std::strings 的数组吗？您希望如何执行转换？”

无论如何，std::transform 是我最好的，但你必须自己填补空白。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T14:31:35.720

### 字符串数组 -> 整数数组

循环遍历字符串数组，并将每个字符串依次转换为相应的整数`std::istringstream`

```
std::size_t const N = 3;
std::string a[N] = { "10", "-2", "5" };
int b[N];

for(std::size_t i = 0; i < N; i++) {
    std::istringstream sstream(a[i]);
    sstream >> b[i];
} 
```

如果您有许多值，则不断重新创建字符串流可能会引入大量开销。你可以把它从循环中取出。

```
std::stringstream sstream;
for(std::size_t i = 0; i < N; i++) {
    sstream << a[i];
    sstream >> b[i];
    sstream.clear(); 
    sstream.seekp(0); sstream.seekg(0);
} 
```

### 字符数组 -> 整数数组

如果要将 char 数组`a`转换为 int 数组`b`，可以这样做：

```
std::size_t const N = 15;
char a[N] = { "this is a test" };
int b[N];

for(std::size_t i = 0; i < N; i++)
    b[i] = (int)(unsigned char) a[i]; 
```

转换为`unsigned char`使 int 数组的值变为正数（如果您想转换扩展的 8 位字符，这些字符将以有符号 8 位字符类型表示为负数，否则也将是负整数）。如果您不想要这种行为，则可以安全地省略该演员表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T14:31:19.010

如果您想使用向量而不是数组，这可能会给您一些想法。

```
#include <iostream>
#include <string>
#include <vector>
#include <iterator>
#include <ostream>
#include <algorithm>
#include <sstream>
using namespace std;

int int_from_string(const string& s) {
    istringstream ss(s);
    int i;
    ss >> i;
    return i;
}

vector<int> int_vec_from_string_vec(const vector<string>& vstr) {
    vector<int> v(vstr.size());
    transform(vstr.begin(), vstr.end(), v.begin(), int_from_string);
    return v;
}

int main() {
    const vector<string> vstr(3, "45");
    const vector<int> vint = int_vec_from_string_vec(vstr);
    copy(vint.begin(), vint.end(), ostream_iterator<int>(cout, "\n"));
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T14:44:44.507

如果你想将一个字节数组分解为一个整数数组，你可以逐个字符地进行：

```
char foo[10];
int bar[10];

for(int i = 0; i < 10; ++i) {
  bar[i] = (int)foo[i];
} 
```

但我猜这不是你要找的...

# build - CruiseControl.NET Build Label & SourceGear Vault 实践相关问题

> ID：284029
> 
> 赞同：2
> 
> 时间：2008-11-12T14:06:23.587
> 
> 标签：build, label, cruisecontrol.net

我将 SourceGear Vault 和 applyLabel="true" 用于一个项目，因此当它构建时，它将在 SourceGear Vault 中为相应的项目创建一个标签。我的问题是

我有一个夜间构建，所以如果那天我没有对该项目进行任何更改，那么我该如何定义我的设置....

```
 <sourcecontrol type="vault" autoGetSource="true" applyLabel="true">
           <executable>c:\program files\sourcegear\vault client\vault.exe</executable>
           <username>john</username>
            <password>password</password>
            <host>server</host>
            <repository>Default Repository</repository>         
            <folder>$/Projects/xxx/xxx/xxx/source/xxx/xxx/xxx/xx.source</folder>
                    <ssl>false</ssl>
                    <timeout units="minutes">10</timeout>
                    **<useWorkingDirectory>false</useWorkingDirectory>**
                    <workingDirectory>C:\CCNET\build\xx\xx\</workingDirectory>
        </sourcecontrol> 
```

问题是我不想要代码没有更改的构建标签。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T14:20:54.413

在您的项目定义中应该有一个`<triggers>`部分。对于我们的夜间构建，我们使用以下内容：

```
 <triggers>
      <scheduleTrigger time="00:30" buildCondition="IfModificationExists"/>
   </triggers> 
```

这告诉 CCNet 仅在自上次构建以来已签入更改时才在 0030 小时构建。这里的重要部分是`buildCondition="IfModificationExists"`，它可以用于任何触发器类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T18:01:37.463

所以斯科特你的意思是你对夜间和正常构建或不同的触发器有不同的定义？

# java - JSF：如何基于另一个会话 bean 更新一个会话 bean？

> ID：284038
> 
> 赞同：0
> 
> 时间：2008-11-12T14:09:12.377
> 
> 标签：java, session, jsf

我目前正在修改一些 jsf 应用程序。我有两个豆子。

*   连接豆
*   UIBean

当我第一次在 connectionBean 中设置连接参数时，UIBean 能够读取我的 connectionBean 信息并显示正确的 UI 树。

但是，当我尝试在同一会话中设置连接参数时。我的 UIBean 仍然会使用之前的 connectionBean 信息。

它只会在我使整个 httpSession 无效后使用。

无论如何我可以让一个会话 bean 更新另一个会话 bean？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-13T09:03:10.060

在我看来，这是 UIBean 引用过时版本的 ConnectionBean 的某种问题。这是 JSF 的一个问题——如果您重新创建一个 bean，JSF 将不会更新所有其他 bean 中的引用。

您可以尝试每次都获取 ConnectionBean 的“新”副本。以下方法将按名称检索支持 bean：

```
protected Object getBackingBean( String name )
{
    FacesContext context = FacesContext.getCurrentInstance();

    return context
            .getApplication().createValueBinding( String.format( "#{%s}", name ) ).getValue( context );
} 
```

在不知道代码的细节以及如何使用 bean 的情况下，很难更具体！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T09:16:46.310

@Phill Sacre getApplication().createValueBinding 现在已弃用。将此函数用于 JSF 1.2。获取 bean 的新副本。

```
protected Object getBackingBean( String name )
{
    FacesContext context = FacesContext.getCurrentInstance();

    Application app = context.getApplication();

    ValueExpression expression = app.getExpressionFactory().createValueExpression(context.getELContext(),
            String.format("#{%s}", name), Object.class);

    return expression.getValue(context.getELContext());
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-15T14:29:12.590

在第一个会话 bean 中定义常量和静态方法：

```
public class FirstBean {

public static final String MANAGED_BEAN_NAME="firstBean";

/**
 * @return current managed bean instance
 */
public static FirstBean getCurrentInstance()
{
  FacesContext context = FacesContext.getCurrentInstance();
  return (FirstBean) context.getApplication().evaluateExpressionGet(context, "#{" + FirstBean.MANAGED_BEAN_NAME + "}", TreeBean.class);
}  
... 
```

而不是像这样在第二个会话 bean 中使用：

```
...  
FirstBean firstBean = FirstBean.getCurrentInstance();  
... 
```

更好的方法是使用一些**依赖注入**框架，如 JSF 2 或 Spring。

# python - 在 Python 中从单元测试中输出数据

> ID：284043
> 
> 赞同：126
> 
> 时间：2008-11-12T14:10:27.070
> 
> 标签：python, unit-testing

如果我在 Python 中编写单元测试（使用 unittest 模块），是否可以从失败的测试中输出数据，以便我可以检查它以帮助推断导致错误的原因？

我知道创建自定义消息的能力，它可以携带一些信息，但有时您可能会处理更复杂的数据，这些数据不容易表示为字符串。

例如，假设您有一个 Foo 类，并且正在测试一个方法 bar，使用名为 testdata 的列表中的数据：

```
class TestBar(unittest.TestCase):
    def runTest(self):
        for t1, t2 in testdata:
            f = Foo(t1)
            self.assertEqual(f.bar(t2), 2) 
```

如果测试失败，我可能想输出 t1、t2 和/或 f，看看为什么这个特定的数据会导致失败。通过输出，我的意思是在运行测试之后，可以像访问任何其他变量一样访问变量。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-11-12T15:38:03.150

我们为此使用日志记录模块。

例如：

```
import logging
class SomeTest( unittest.TestCase ):
    def testSomething( self ):
        log= logging.getLogger( "SomeTest.testSomething" )
        log.debug( "this= %r", self.this )
        log.debug( "that= %r", self.that )
        # etc.
        self.assertEquals( 3.14, pi )

if __name__ == "__main__":
    logging.basicConfig( stream=sys.stderr )
    logging.getLogger( "SomeTest.testSomething" ).setLevel( logging.DEBUG )
    unittest.main() 
```

这允许我们为我们知道失败的特定测试打开调试，并且我们需要额外的调试信息。

然而，我更喜欢的方法不是花很多时间在调试上，而是花时间编写更细粒度的测试来暴露问题。

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2012-12-03T17:17:16.643

在 Python 2.7 中，您可以使用附加参数 ，`msg`将信息添加到错误消息中，如下所示：

```
self.assertEqual(f.bar(t2), 2, msg='{0}, {1}'.format(t1, t2)) 
```

官方文档在[这里](http://docs.python.org/2/library/unittest.html#unittest.TestCase.assertEqual)。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2008-11-12T14:33:31.627

您可以使用简单的打印语句，或任何其他写入标准输出的方式。您还可以在测试中的任何位置调用 Python 调试器。

如果您使用*[鼻子](https://web.archive.org/web/20081120065052/http://www.somethingaboutorange.com/mrl/projects/nose)*运行测试（我推荐），它将收集每个测试的标准输出，并且仅在测试失败时显示给您，因此您不必在测试通过时忍受杂乱的输出.

*鼻子*也有开关来自动显示断言中提到的变量，或者在失败的测试中调用调试器。例如，`-s`( `--nocapture`) 阻止标准输出的捕获。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-11-12T14:56:25.857

我不认为这正是你要找的。没有办法显示不会失败的变量值，但这可能会帮助您更接近以您想要的方式输出结果。

您可以使用**TestRunner.run()**返回的**[TestResult 对象](http://docs.python.org/library/unittest.html#id3)**进行结果分析和处理。特别是 TestResult.errors 和 TestResult.failures

 **关于 TestResults 对象：

[http://docs.python.org/library/unittest.html#id3](http://docs.python.org/library/unittest.html#id3)

还有一些代码可以为您指明正确的方向：

```
>>> import random
>>> import unittest
>>>
>>> class TestSequenceFunctions(unittest.TestCase):
...     def setUp(self):
...         self.seq = range(5)
...     def testshuffle(self):
...         # make sure the shuffled sequence does not lose any elements
...         random.shuffle(self.seq)
...         self.seq.sort()
...         self.assertEqual(self.seq, range(10))
...     def testchoice(self):
...         element = random.choice(self.seq)
...         error_test = 1/0
...         self.assert_(element in self.seq)
...     def testsample(self):
...         self.assertRaises(ValueError, random.sample, self.seq, 20)
...         for element in random.sample(self.seq, 5):
...             self.assert_(element in self.seq)
...
>>> suite = unittest.TestLoader().loadTestsFromTestCase(TestSequenceFunctions)
>>> testResult = unittest.TextTestRunner(verbosity=2).run(suite)
testchoice (__main__.TestSequenceFunctions) ... ERROR
testsample (__main__.TestSequenceFunctions) ... ok
testshuffle (__main__.TestSequenceFunctions) ... FAIL

======================================================================
ERROR: testchoice (__main__.TestSequenceFunctions)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "<stdin>", line 11, in testchoice
ZeroDivisionError: integer division or modulo by zero

======================================================================
FAIL: testshuffle (__main__.TestSequenceFunctions)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "<stdin>", line 8, in testshuffle
AssertionError: [0, 1, 2, 3, 4] != [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

----------------------------------------------------------------------
Ran 3 tests in 0.031s

FAILED (failures=1, errors=1)
>>>
>>> testResult.errors
[(<__main__.TestSequenceFunctions testMethod=testchoice>, 'Traceback (most recent call last):\n  File "<stdin>"
, line 11, in testchoice\nZeroDivisionError: integer division or modulo by zero\n')]
>>>
>>> testResult.failures
[(<__main__.TestSequenceFunctions testMethod=testshuffle>, 'Traceback (most recent call last):\n  File "<stdin>
", line 8, in testshuffle\nAssertionError: [0, 1, 2, 3, 4] != [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n')]
>>> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-03-05T03:34:54.430

我使用的方法非常简单。我只是将其记录为警告，因此它实际上会显示出来。

```
import logging

class TestBar(unittest.TestCase):
    def runTest(self):

       #this line is important
       logging.basicConfig()
       log = logging.getLogger("LOG")

       for t1, t2 in testdata:
         f = Foo(t1)
         self.assertEqual(f.bar(t2), 2)
         log.warning(t1) 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-13T22:28:25.780

另一种选择 - 在测试失败的地方启动调试器。

尝试使用 Testoob 运行您的测试（它将运行您的单元测试套件而不进行更改），并且您可以使用“--debug”命令行开关在测试失败时打开调试器。

这是 Windows 上的终端会话：

```
C:\work> testoob tests.py --debug
F
Debugging for failure in test: test_foo (tests.MyTests.test_foo)
> c:\python25\lib\unittest.py(334)failUnlessEqual()
-> (msg or '%r != %r' % (first, second))
(Pdb) up
> c:\work\tests.py(6)test_foo()
-> self.assertEqual(x, y)
(Pdb) l
  1     from unittest import TestCase
  2     class MyTests(TestCase):
  3       def test_foo(self):
  4         x = 1
  5         y = 2
  6  ->     self.assertEqual(x, y)
[EOF]
(Pdb) 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-03-23T12:24:52.653

在这些情况下，我`log.debug()`在我的应用程序中使用带有一些消息的 a。由于默认日志记录级别是`WARNING`，因此此类消息不会在正常执行中显示。

然后，在单元测试中，我将日志记录级别更改为`DEBUG`，以便在运行它们时显示此类消息。

```
import logging

log.debug("Some messages to be shown just when debugging or unit testing") 
```

在单元测试中：

```
# Set log level
loglevel = logging.DEBUG
logging.basicConfig(level=loglevel) 
```

* * *

* * *

* * *

查看完整示例：

这是`daikiri.py`一个基本类，它用它的名称和价格来实现一个*[大切。](https://www.etymonline.com/word/daiquiri)*有一种方法`make_discount()`可以在应用给定折扣后返回该特定 daikiri 的价格：

```
import logging

log = logging.getLogger(__name__)

class Daikiri(object):
    def __init__(self, name, price):
        self.name = name
        self.price = price

    def make_discount(self, percentage):
        log.debug("Deducting discount...")  # I want to see this message
        return self.price * percentage 
```

然后，我创建了一个单元测试，`test_daikiri.py`来检查它的使用情况：

```
import unittest
import logging
from .daikiri import Daikiri

class TestDaikiri(unittest.TestCase):
    def setUp(self):
        # Changing log level to DEBUG
        loglevel = logging.DEBUG
        logging.basicConfig(level=loglevel)

        self.mydaikiri = Daikiri("cuban", 25)

    def test_drop_price(self):
        new_price = self.mydaikiri.make_discount(0)
        self.assertEqual(new_price, 0)

if __name__ == "__main__":
    unittest.main() 
```

因此，当我执行它时，我会收到以下`log.debug`消息：

```
$ python -m test_daikiri
DEBUG:daikiri:Deducting discount...
.
----------------------------------------------------------------------
Ran 1 test in 0.000s

OK 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-11-12T17:38:52.173

我想我可能是想多了。我想出的一种方法可以完成这项工作，就是拥有一个累积诊断数据的全局变量。

像这样的东西：

```
log1 = dict()
class TestBar(unittest.TestCase):
    def runTest(self):
        for t1, t2 in testdata:
            f = Foo(t1)
            if f.bar(t2) != 2:
                log1("TestBar.runTest") = (f, t1, t2)
                self.fail("f.bar(t2) != 2") 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-02-16T16:38:21.217

使用日志记录：

```
import unittest
import logging
import inspect
import os

logging_level = logging.INFO

try:
    log_file = os.environ["LOG_FILE"]
except KeyError:
    log_file = None

def logger(stack=None):
    if not hasattr(logger, "initialized"):
        logging.basicConfig(filename=log_file, level=logging_level)
        logger.initialized = True
    if not stack:
        stack = inspect.stack()
    name = stack[1][3]
    try:
        name = stack[1][0].f_locals["self"].__class__.__name__ + "." + name
    except KeyError:
        pass
    return logging.getLogger(name)

def todo(msg):
    logger(inspect.stack()).warning("TODO: {}".format(msg))

def get_pi():
    logger().info("sorry, I know only three digits")
    return 3.14

class Test(unittest.TestCase):

    def testName(self):
        todo("use a better get_pi")
        pi = get_pi()
        logger().info("pi = {}".format(pi))
        todo("check more digits in pi")
        self.assertAlmostEqual(pi, 3.14)
        logger().debug("end of this test")
        pass 
```

用法：

```
# LOG_FILE=/tmp/log python3 -m unittest LoggerDemo
.
----------------------------------------------------------------------
Ran 1 test in 0.047s

OK
# cat /tmp/log
WARNING:Test.testName:TODO: use a better get_pi
INFO:get_pi:sorry, I know only three digits
INFO:Test.testName:pi = 3.14
WARNING:Test.testName:TODO: check more digits in pi 
```

如果你不设置`LOG_FILE`，日志会得到`stderr`。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-05-04T19:42:27.280

您可以`logging`为此使用模块。

所以在单元测试代码中，使用：

```
import logging as log

def test_foo(self):
    log.debug("Some debug message.")
    log.info("Some info message.")
    log.warning("Some warning message.")
    log.error("Some error message.") 
```

默认情况下，警告和错误会输出到`/dev/stderr`，因此它们应该在控制台上可见。

要自定义日志（例如格式化），请尝试以下示例：

```
# Set-up logger
if args.verbose or args.debug:
    logging.basicConfig( stream=sys.stdout )
    root = logging.getLogger()
    root.setLevel(logging.INFO if args.verbose else logging.DEBUG)
    ch = logging.StreamHandler(sys.stdout)
    ch.setLevel(logging.INFO if args.verbose else logging.DEBUG)
    ch.setFormatter(logging.Formatter('%(asctime)s %(levelname)s: %(name)s: %(message)s'))
    root.addHandler(ch)
else:
    logging.basicConfig(stream=sys.stderr) 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-09-13T17:01:36.690

inspect.trace 将让您在抛出异常后获取局部变量。然后，您可以使用如下装饰器包装单元测试，以保存这些局部变量以供事后检查。

```
import random
import unittest
import inspect

def store_result(f):
    """
    Store the results of a test
    On success, store the return value.
    On failure, store the local variables where the exception was thrown.
    """
    def wrapped(self):
        if 'results' not in self.__dict__:
            self.results = {}
        # If a test throws an exception, store local variables in results:
        try:
            result = f(self)
        except Exception as e:
            self.results[f.__name__] = {'success':False, 'locals':inspect.trace()[-1][0].f_locals}
            raise e
        self.results[f.__name__] = {'success':True, 'result':result}
        return result
    return wrapped

def suite_results(suite):
    """
    Get all the results from a test suite
    """
    ans = {}
    for test in suite:
        if 'results' in test.__dict__:
            ans.update(test.results)
    return ans

# Example:
class TestSequenceFunctions(unittest.TestCase):

    def setUp(self):
        self.seq = range(10)

    @store_result
    def test_shuffle(self):
        # make sure the shuffled sequence does not lose any elements
        random.shuffle(self.seq)
        self.seq.sort()
        self.assertEqual(self.seq, range(10))
        # should raise an exception for an immutable sequence
        self.assertRaises(TypeError, random.shuffle, (1,2,3))
        return {1:2}

    @store_result
    def test_choice(self):
        element = random.choice(self.seq)
        self.assertTrue(element in self.seq)
        return {7:2}

    @store_result
    def test_sample(self):
        x = 799
        with self.assertRaises(ValueError):
            random.sample(self.seq, 20)
        for element in random.sample(self.seq, 5):
            self.assertTrue(element in self.seq)
        return {1:99999}

suite = unittest.TestLoader().loadTestsFromTestCase(TestSequenceFunctions)
unittest.TextTestRunner(verbosity=2).run(suite)

from pprint import pprint
pprint(suite_results(suite)) 
```

最后一行将打印测试成功的返回值和局部变量，在本例中为 x，当它失败时：

```
{'test_choice': {'result': {7: 2}, 'success': True},
 'test_sample': {'locals': {'self': <__main__.TestSequenceFunctions testMethod=test_sample>,
                            'x': 799},
                 'success': False},
 'test_shuffle': {'result': {1: 2}, 'success': True}} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-12T15:25:57.153

捕获从断言失败生成的异常。在您的 catch 块中，您可以将数据输出到任何地方。然后，当你完成后，你可以重新抛出异常。测试运行者可能不知道其中的区别。

免责声明：我没有在 Python 的单元测试框架中尝试过这个，但我在其他单元测试框架中尝试过。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2013-10-23T09:50:38.247

扩展[Facundo Casco 的答案](https://stackoverflow.com/questions/284043/outputting-data-from-unit-test-in-python/13688397#13688397)，这对我来说效果很好：

```
class MyTest(unittest.TestCase):
    def messenger(self, message):
        try:
            self.assertEqual(1, 2, msg=message)
        except AssertionError as e:      
            print "\nMESSENGER OUTPUT: %s" % str(e), 
```

# objective-c - Xcode 属性自动化

> ID：284045
> 
> 赞同：3
> 
> 时间：2008-11-12T14:10:42.657
> 
> 标签：objective-c, xcode

Xcode 在脚本菜单中有这些方便的节省时间的工具，称为“代码->将访问器定义放在剪贴板上”和“代码->将访问器声明放在剪贴板上”。这些脚本允许您为任何突出显示的实例变量自动生成 getter 和 setter 方法。

有谁知道输出 Objective-C 2.0 属性声明语句的类似脚本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-24T13:13:36.550

查看：

1.  [Matt Gallagher 的 XCode 属性访问器脚本](http://cocoawithlove.com/2008/12/instance-variable-to-synthesized.html)

2.  [Accessorizer](http://www.kevincallahan.org/software/accessorizer.html)，如果你想要一个用于生成属性访问器的整个应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T14:14:05.537

您可以使用“脚本”菜单中的“编辑用户脚本...”菜单选项自己创建这些脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T17:53:32.393

我还推荐使用 textexpander ，它使该过程更加直观和通用，以便可以在文本编辑器中使用相同的“片段”。

# windows-mobile - 如何在紧凑框架中获取当前目录？

> ID：284049
> 
> 赞同：14
> 
> 时间：2008-11-12T14:14:19.093
> 
> 标签：windows-mobile, compact-framework

你如何获得你的应用程序正在运行的当前目录？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-12T14:41:04.840

你可以试试这个：

```
using System.IO;
using System.Reflection;

namespace Utilities
{
    static public class DirectoryHelper
    {
        static public string GetCurrentDirectory ()
        {
            return Path.GetDirectoryName (Assembly.GetExecutingAssembly ().GetName ().CodeBase);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-12T14:41:59.910

试试这个：

```
Path.GetDirectoryName(Assembly.GetExecutingAssembly().GetName().CodeBase); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-11-05T11:35:37.950

公共共享子 WriteDBStatus(ByVal strString As String)

```
 Try

        Dim FILE_NAME As String = Path.GetDirectoryName(Assembly.GetExecutingAssembly().GetName().CodeBase) + "\DBStatus"

        Dim sr As IO.StreamWriter = Nothing
        If Not IO.File.Exists(FILE_NAME) Then
            sr = IO.File.CreateText(FILE_NAME)
            sr.WriteLine(strString)
        End If
        sr.Close()
    Catch ex As Exception

    End Try

End Sub 
```

# delphi - 在 Delphi 中使用卷影复制服务 (VSS)

> ID：284050
> 
> 赞同：1
> 
> 时间：2008-11-12T14:14:20.730
> 
> 标签：delphi, volume-shadow-service

是否有人有示例代码来使用卷影复制服务 (VSS) API 复制打开的（正在使用并被另一个程序锁定）文件？

The Delphi Magazine（2005 年 9 月）中有一篇关于此的文章。但是该代码不再可用，即使它是可用的，它也不是最新的。

我正在寻找适用于当前版本的卷影复制服务库的示例代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T23:48:37.670

“The Delphi Magazine”的 U 盘上有一个数字版。你可以在他们的网页上订购。

也许有人创造了那根棍子的洪流。

**更新**

~~我在这里找到了该示例： [http ://www.google.com/codesearch/p?hl=de#XIdFp1PskBE/VSS/VssAPI.pas](http://www.google.com/codesearch/p?hl=de#XIdFp1PskBE/VSS/VssAPI.pas)~~

上面的链接已经过时了，头文件也可以在这里找到：http: [//www.delphipraxis.net/998560-post3.html](http://www.delphipraxis.net/998560-post3.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-23T10:46:18.450

我在这里找到了一个工作（XE2）示例： [http ://www.rathlev-home.de/sources/delphi.html#progsxe2](http://www.rathlev-home.de/sources/delphi.html#progsxe2)

要使用 XE8 进行编译，请获取最新的“gnugettext.pas”

该软件包包含编译创建卷影副本的 delphi 程序所需的所有单元。此外，还有一个示例应用程序 VsToolkit 可用。我用 XE2 和 XE8 编译它，它工作得很好......

# flash - 模拟旧电脑？

> ID：284051
> 
> 赞同：10
> 
> 时间：2008-11-12T14:14:20.823
> 
> 标签：flash, optimization, virtual-machine, emulation

我正在编写一个 Flash 游戏，对 CPU 的消耗非常大。

除了对它进行了很多优化之外，我还希望能够像玩家一样在慢速 PC 上玩它，因为我有一个好的 CPU，我想让它也可以在坏 CPU 上玩

首先，我认为虚拟化会有所帮助，但我尝试了带有 ubunto 映像的 vmware 播放器，但在任何地方都找不到如何做到这一点。

购买旧 PC[不是一种选择](https://stackoverflow.com/questions/284051/emulate-old-pc#284316)，因为我不喜欢只为此而配备机器。

我需要的是一个软件降频器，或者一个我可以为 CPU 和 RAM 指定低规格的虚拟机。

有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-12T14:33:01.957

[Microsoft Virtual PC](http://www.microsoft.com/windows/downloads/virtualpc/default.mspx)是一种 VM 软件，可让您确定您创建的每个虚拟机的 CPU 速度、RAM 设置和显卡设置。从网站：

> **可配置性**- 安装 Virtual PC 后，您可以对其进行配置以满足您的要求。Virtual PC 有许多设置来控制产品如何与物理计算机交互、分配资源等等。

我以前用它来模拟具有 128 Megs RAM 的 400mhz PC。

编辑：

Virtual PC 上的虚拟机将比您的主机 PC 慢。我记得在 VPC 2004 中，它甚至会说它正在虚拟化的 mHz 速度是多少。这不再出现在 Virtual PC 2007 中，但一些挖掘表明 Microsoft 人员已经解决了这个问题。

从他们网站的[博客](http://blogs.msdn.com/virtual_pc_guy/archive/2007/05/14/slowing-down-virtual-machines.aspx)中（考虑到它可能有一天会消失）：

> 好吧-也许仿真解决方案更适合您的需求。或者，也许您需要投资一些较旧的硬件。或者 - 您可以在虚拟机内部使用“减速”软件。我使用的一些成功程度不同的程序包括：
> 
> *   对于 DOS：
>     *   [减速](http://www.hpaa.com/moslo/basic.asp)或[MoSlo](http://members.aol.com/bretjohn/programs/slodn310.zip)
> *   对于 Windows：
>     *   [涡轮](http://wiw.org/~jess/turbo.html)
> 
> 关于这个主题的最后一条评论 - 有些人注意到一些已知会在快速硬件上崩溃的旧 DOS 程序实际上在 Virtual PC / Virtual Server 内完美运行。原因是很久以前在 Virtual PC 开发中，我们在一些常见的 DOS 库中放入了一些代码来检测有问题的例程（查看此作为示例参考）并“即时”修补这些二进制文件，以便它们将在虚拟机内正确运行。

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-12T14:19:15.027

Buy another OLD PC.

Old PCs are so cheap, the cost of an old box should be a heck of lot cheaper than the time it will take you to figure out how to do this.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-12T14:25:22.300

有一些 CPU 节流实用程序可以减慢 CPU 的速度，但不完全确定它们有多大帮助。这是我刚刚通过快速谷歌找到的[一个链接。](http://www.oldskool.org/pc/throttle)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-30T06:06:22.513

您可以尝试使用 CPU Killer

[http://www.cpukiller.com/](http://www.cpukiller.com/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-12T14:22:13.477

现代“虚拟 PC”软件依赖于主机 CPU 中的虚拟化支持功能，并且虚拟机具有与主机相同的指令集。所以程序是直接执行的，当主机需要在幕后做一些事情来维持虚拟化时，“陷阱”会停止执行。这对你没有帮助。

如果您使用的是 Linux，您可以尝试在 Valgrind 中运行该程序，这在大多数情况下会提供 10 倍的速度。:) 这不是设计使然，所以它不是一个长期的解决方案。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-02T17:36:37.000

Throttle your program to a fixed framerate using a timer. That way you give CPU time you don't need back to the operating system. The human eye can't do much better than 25 fps anyways. Setting a fixed framerate of 50/60 fps should be more than enough for a Flash game.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-12T16:17:43.430

我使用了一个名为**CPU Killer**的程序来在我的现代电脑上玩敌人后方的突击队。该游戏的速度与您的计算机速度成正比。它是为 200mhz 设计的，因此在没有 cpu-killer 的情况下在 3GHz 上运行它是不可能的。:D

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-23T10:29:44.773

[DOSBOX](http://www.youtube.com/watch?v=dXQ_Y6u9IPw)模拟旧 PC。它旨在玩旧的PC游戏。其中一些游戏不能运行得太快，并且通常在现代硬件上根本无法运行。

> ID：284052
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# php - 使用 Zend_Auth 进行身份验证后如何重定向到请求的 URI？

> ID：284060
> 
> 赞同：5
> 
> 时间：2008-11-12T14:17:17.480
> 
> 标签：php, zend-framework, authentication, redirect

我正在使用一个简单的[Zend_Auth](http://framework.zend.com/manual/en/zend.auth.html)设置来验证我的一个应用程序的用户，使用[控制器插件](http://framework.zend.com/manual/en/zend.controller.plugins.html)中的 preDispatch() 方法的检查。当匿名用户导航到

```
/users/view/id/6 
```

例如，它们应该在身份验证后重定向到上述 URI。

做这个的最好方式是什么？我不想存储`$_SERVER['REQUEST_URI']`在会话中。就个人而言，我会发现将整个 Zend Request 对象存储到最干净的解决方案中，但我不确定这是否明智，以及我是否应该采用这种方法。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T16:00:41.030

我们遇到了同样的问题，实际上确实在会话变量中存储了请求 URI。如果您不将任何特定的、不可序列化的对象放入 Zend Request 中，我认为坚持它也可以。

但是，这取决于您期望的吞吐量。如果你有一个高流量的网站，序列化像 Zend Request 这样的对象可能不是最好的主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T17:42:52.680

重定向或转发到 LoginController 可能不是将未经身份验证的用户带到登录页面的最佳方式。相反，在 preDispatch 中，您可以获取 $request 对象并通过执行以下操作来更改它。

```
$request->setActionName('someaction');
$request->setControllerName('somecontroller'); 
```

此时您的原始请求仍在维护中，但页面正在显示登录页面。然后您可以更改您的登录控制器以检查当前请求位置是登录控制器还是其他位置。如果成功登录时是其他内容（原始请求），请将它们发送到该页面。

# visual-studio - .NET 设置相对路径

> ID：284061
> 
> 赞同：0
> 
> 时间：2008-11-12T14:17:30.130
> 
> 标签：visual-studio, configuration, properties, settings

我正在开发一个应用程序，其中我有一个相对于我的应用程序根目录的图像文件夹。我希望能够在 Properties -> Settings 设计器中指定这个相对路径，例如。“\图片\”。我遇到的问题是在 Environment.CurrentDirectory 通过 OpenFileDialog 更改的情况下，相对路径无法解析到正确的位置。有没有办法在设置文件中指定一个路径，该路径意味着始终从应用程序目录而不是当前目录开始？我知道我总是可以动态地将应用程序路径连接到相对路径的前面，但我希望我的 Settings 属性能够自行解析。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T14:24:51.037

据我所知，没有允许这种类型的路径解析的内置功能。您最好的选择是动态确定应用程序执行目录并将您的图像路径连接到它。由于您提到的原因，您不想`Environment.CurrentDirectory`专门使用 - 当前目录对于这种情况可能并不总是正确的。

我发现找到执行程序集位置的最安全的代码是：

```
public string ExecutingAssemblyPath()
{
   Assembly actualAssembly = Assembly.GetEntryAssembly();
   if (this.actualAssembly == null)
   {
      actualAssembly = Assembly.GetCallingAssembly();
   }
   return actualAssembly.Location;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T14:25:55.947

您在寻找 Application.ExecutablePath 吗？这应该告诉您应用程序的可执行文件在哪里，删除可执行文件名称，然后将您的路径附加到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T14:25:51.550

2个选项：

*   使用该设置的代码可以针对当前执行程序集的目录解析该设置。
*   您可以创建自己的类型，将其序列化为相对于正在执行的程序集的字符串，并具有完整路径的访问器，该路径将针对当前正在执行的程序集的目录进行解析。

代码示例：

```
string absolutePath = Settings.Default.ImagePath;
if(!Path.IsPathRooted(absolutePath))
{
    string root = Assembly.GetEntryAssembly().Location;
    root = Path.GetDirectoryName(root);
    absolutePath = Path.Combine(root, absolutePath);
} 
```

这段代码的好处是它允许在您的设置中使用完全限定的路径或相对路径。如果您需要相对于不同程序集的路径，您可以更改您使用的程序集的位置 -`GetExecutingAssembly()`将为您提供程序集的位置以及您正在运行的代码，`GetCallingAssembly()`如果您使用选项 2 会很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T12:36:46.317

这似乎在 WinForms 和 ASP.NET 中都有效（提供**配置文件**的路径）：

```
new System.IO.FileInfo(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile).Directory; 
```

对于 Windows 和控制台应用程序，显而易见的方法是使用：

```
Application.StartupPath 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-04T16:07:39.137

[我建议你](http://itscommonsensestupid.blogspot.com/2008/05/how-to-get-file-path-of-executing.html)使用Assembly.CodeBase，如下图：

```
public static string RealAssemblyFilePath()
{
   string dllPath=Assembly.GetExecutingAssembly().CodeBase.Substring(8);
   return dllPath;
} 
```

您可以尝试[Application.ExecutablePath](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.executablepath.aspx)。但是您需要参考 System.Windows.Forms。如果您希望您的类库避开表单和 UI 内容，这可能不是一个好主意。

您可以尝试[Assembly.GetExecutingAssembly().Location](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.location%28VS.71%29.aspx)。但是，如果您在运行应用程序之前以某种方式执行“影子复制”（如默认的 NUnit 行为），那么此属性将返回影子复制位置，而不是真实的物理位置。

最好的方法是实现一个调用 Assembly 对象的 CodeBase 属性的函数，并去掉字符串中不相关的部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-08T15:06:43.200

我使用以下两种方法来帮助解决这个问题：

```
public static IEnumerable<DirectoryInfo> ParentDirs(this DirectoryInfo dir) {
    while (dir != null) {
        yield return dir;
        dir = dir.Parent;
    }
}
public static DirectoryInfo FindDataDir(string relpath, Assembly assembly) {
    return new FileInfo((assembly).Location)
        .Directory.ParentDirs()
        .Select(dir => Path.Combine(dir.FullName + @"\", relpath))
        .Where(Directory.Exists)
        .Select(path => new DirectoryInfo(path))
        .FirstOrDefault();
} 
```

当各种构建脚本最终将内容粘贴在`bin\x64\Release\NonsensePath\`.

# c# - 使用 TryParse 设置对象属性值

> ID：284063
> 
> 赞同：4
> 
> 时间：2008-11-12T14:18:46.710
> 
> 标签：c#, exception, refactoring, tryparse

我目前正在重构代码以将 Convert.To 替换为 TryParse。

我遇到了以下代码，它正在创建一个属性并将其分配给一个对象。

```
List<Person> list = new List<Person>();

foreach (DataRow row in dt.Rows)
{
     var p = new Person{ RecordID = Convert.ToInt32(row["ContactID"]) };

     list.Add(p);
} 
```

我想出的替代品是：

```
var p = new Person { RecordID = Int32.TryParse(row["ContactID"].ToString(), out RecordID) ? RecordID : RecordID }; 
```

有什么想法、意见、替代我所做的事情吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-12T14:24:17.417

写一个扩展方法。

```
public static Int32? ParseInt32(this string str) {
    Int32 k;
    if(Int32.TryParse(str, out k))
        return k;
    return null;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T14:24:47.463

我会使用一个替代实现`TryParse`，它返回一个`int?`：

```
public static int? TryParseInt32(string x)
{
    int value;
    return int.TryParse(x, out value) ? value : (int?) null;
} 
```

然后你可以写：

```
var p = new Person { RecordID = Helpers.TryParseInt32(row["ContactID"].ToString()) ?? 0 }; 
```

（或者，如果您愿意，可以使用不同的默认值 - 无论哪种方式，它都会在您的代码中可见。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T14:28:58.827

我建议将 TryParse 部分与初始化程序分开。它将更具可读性。

```
int recordId;
Int32.TryParse(row["ContactID"].ToString(), out recordID)

foreach (DataRow row in dt.Rows)
{
     var p = new Person{ RecordID = recordId };
     list.Add(p);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-08T01:56:38.233

```
private static void TryToDecimal(string str, Action<decimal> action)
{
        if (decimal.TryParse(str, out decimal ret))
        {
            action(ret);
        }
        else
        {
            //do something you want
        }
}

TryToDecimal(strList[5], (x) => { st.LastTradePrice = x; });
TryToDecimal(strList[3], (x) => { st.LastClosedPrice = x; });
TryToDecimal(strList[6], (x) => { st.TopPrice = x; });
TryToDecimal(strList[7], (x) => { st.BottomPrice = x; });
TryToDecimal(strList[10], (x) => { st.PriceChange = x; }); 
```

# asp.net - 构建我的第一个 ASP 应用程序

> ID：284080
> 
> 赞同：5
> 
> 时间：2008-11-12T14:24:47.370
> 
> 标签：asp.net, web-applications

我刚刚负责使用 ASP (.net) 构建 Web 应用程序，并且正在寻找一些关于从哪里开始的建议。简而言之，应用程序需要能够。

*   处理用户验证/认证
*   处理会话
*   做 SOAP 消息传递

该应用程序旨在充当可通过 Web 服务调用访问的系统功能的前端。

我打算在客户端使用 JavaScript 做很多工作，并且正在考虑仅使用 ASP 作为我上面列出的 3 个项目的框架。

感谢您提出的任何建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T15:29:05.103

如果可以，请使用 Visual Studio 2008。它对 Ajax 客户端库和 javascript intellisense 的支持非常好。（查看[jQuery 插件](http://blogs.msdn.com/webdevtools/archive/2008/10/28/rich-intellisense-for-jquery.aspx)）

ASP.NET 内置了登录控件（以及 ChrisE 提到的成员服务），并且还具有表单身份验证。尝试利用这些现有组件并避免使用会话来存储用户特定的对象/数据。

---会话咆哮

*它有时是不可避免的，但你应该尽可能避免它。它给每个用户的网络服务器带来了负担，这会导致一些非常困难的扩展问题。FormsAuthentication Ticket 有一个 value 属性，您可以在其中存储大约 4K 的用户数据 - 尝试改用它。*

---结束会话咆哮

尝试使用 MVC 方法（不一定是[ASP.NET MVC](http://www.asp.net/mvc/)），但至少要使用一种将您的表示/视图层与数据/模型层分开的方法。

创建一个默认主题并使用它。大多数网站以后都需要有多个主题，而重构这将是一个 PIA。

如果您需要 SOAP 与非 .NET 服务进行交互，那么一定要使用它。如果您只连接到 .NET 服务，请查看 WCF 客户端和服务。他们会给你更多的灵活性。

如果您使用 javascript 进行客户端工作，则不要使用更新面板。它增加了很多开销。

获取 FireFox + FireBug + YSlow 和 IE8（是的，它仍然是测试版）。他们将在处理调试/样式的客户端时为您提供帮助。

看看[网站性能的规则](http://developer.yahoo.com/performance/rules.html)，但对这些规则持保留态度。它们适用于非常大的站点，并且某些项目可能不适用（CDN、DNS 查找、重定向）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T14:28:42.340

WCF for Soap——我还建议选择这个：

[替代 ASP.NET 3.5 http://ecx.images-amazon.com/images/I/518N8vYWf1L._SL500_AA240_.jpg](https://rads.stackoverflow.com/amzn/click/com/0596529562)

这本书是教程形式的——杰西·利伯蒂（Jesse Liberty）是一位伟大的老师（他的合著者也是）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T14:32:51.240

ASP.NET 通过 SqlMembershipProvider 和 SqlRoleProvider 类提供开箱即用的身份验证/授权，或者您可以使用 ADMembershipProvider 和自定义 RoleProvider 来针对 Active Directory 设置进行身份验证和授权。

会话处理也很容易由 ASP.NET 提供，通过进程内服务器、外部 StateServer 服务或通过与 SQL Server 的连接（当然，如果您需要不同的东西，您可以提供自定义会话服务）。

正如 Lou Franco 所提到的，WCF 为 SOAP 调用提供了框架，并且可以很方便地融入您的 ASP.NET 应用程序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-12T14:39:01.537

如果您使用的是 ASP.NET Web 表单，那么为了处理用户身份验证/验证，我建议您使用 ASP.NET Membership services [http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx](http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx)，因为它可以完成一些为您提供繁重的工作，还可以帮助您避免犯任何基本的安全错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T15:43:03.703

这与您的要求没有直接关系，但我建议您研究一下网站和 Web 应用程序之间的区别。越早越好。如果您了解项目的管理方式，一切都会顺利进行。

你可以从这里开始：http: [//www.codersbarn.com/post/2008/06/ASPNET-Web-Site-versus-Web-Application-Project.aspx](http://www.codersbarn.com/post/2008/06/ASPNET-Web-Site-versus-Web-Application-Project.aspx)

# c# - 如何获取 ReadOnlyCollection 字典中的键

> ID：284090
> 
> 赞同：7
> 
> 时间：2008-11-12T14:26:00.143
> 
> 标签：c#, generics, dictionary, collections, c#-2.0

我的课程包含 a `Dictionary<T, S> dict`，我想公开 a`ReadOnlyCollection<T>`的键。如何在不将 复制`Dictionary<T, S>.KeyCollection dict.Keys`到数组然后将数组公开为 的情况下做到这一点`ReadOnlyCollection`？

我希望 `ReadOnlyCollection`成为一个合适的包装器，即。反映底层字典的变化，据我所知，将集合复制到数组不会这样做（而且看起来效率低下 - 我实际上并不想要一个新集合，只是为了公开底层的键集合.. .)。任何想法将不胜感激！

编辑：我使用的是 C# 2.0，所以没有可用的扩展方法，例如 .ToList （很容易）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T14:39:03.457

如果你真的想使用 ReadOnlyCollection<T>，问题是 ReadOnlyCollection<T> 的构造函数需要一个 IList<T>，而 Dictionary 的 KeyCollection 只是一个 ICollection<T>。

因此，如果要将 KeyCollection 包装在 ReadOnlyCollection 中，则必须创建一个适配器（或包装器）类型，实现 IList<T>，包装 KeyCollection。所以它看起来像：

```
var dictionary = ...;
var readonly_keys = new ReadOnlyCollection<T> (new CollectionListWrapper<T> (dictionary.Keys)
); 
```

虽然不是很优雅，特别是因为 KeyCollection 已经是一个只读集合，你可以简单地将它作为 ICollection<T> 传递:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-12T16:25:21.603

DrJokepu 说，为 Keys Collection 实现包装器可能很困难。但是，在这种特殊情况下，我认为实现并不是那么困难，因为正如我们所知，这是一个只读包装器。

这使我们可以忽略一些在其他情况下难以实现的方法。

这是 Dictionary.KeyCollection 包装器的快速实现：

```
class MyListWrapper<T, TValue> : IList<T>
{
    private Dictionary<T, TValue>.KeyCollection keys;

    public MyListWrapper(Dictionary<T, TValue>.KeyCollection keys)
    {
        this.keys = keys;
    }

    #region IList<T> Members

    public int IndexOf(T item)
    {
        if (item == null)
            throw new ArgumentNullException();
        IEnumerator<T> e = keys.GetEnumerator();
        int i = 0;
        while (e.MoveNext())
        {
            if (e.Current.Equals(item))
                return i;
            i++;
        }
        throw new Exception("Item not found!");
    }

    public void Insert(int index, T item)
    {
        throw new NotImplementedException();
    }

    public void RemoveAt(int index)
    {
        throw new NotImplementedException();
    }

    public T this[int index]
    {
        get
        {
            IEnumerator<T> e = keys.GetEnumerator();
            if (index < 0 || index > keys.Count)
                throw new IndexOutOfRangeException();
            int i = 0;
            while (e.MoveNext() && i != index)
            {
                i++;
            }
            return e.Current;
        }
        set
        {
            throw new NotImplementedException();
        }
    }

    #endregion

    #region ICollection<T> Members

    public void Add(T item)
    {
        throw new NotImplementedException();
    }

    public void Clear()
    {
        throw new NotImplementedException();
    }

    public bool Contains(T item)
    {
        return keys.Contains(item);
    }

    public void CopyTo(T[] array, int arrayIndex)
    {
        keys.CopyTo(array, arrayIndex);
    }

    public int Count
    {
        get { return keys.Count; }
    }

    public bool IsReadOnly
    {
        get { return true; }
    }

    public bool Remove(T item)
    {
        throw new NotImplementedException();
    }

    #endregion

    #region IEnumerable<T> Members

    public IEnumerator<T> GetEnumerator()
    {
        return keys.GetEnumerator();
    }

    #endregion

    #region IEnumerable Members

    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
        return keys.GetEnumerator();
    }

    #endregion
} 
```

这可能不是这些方法的最佳实现:) 但这只是为了证明可以这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-06-01T15:07:37.303

作为记录，在 .NET 4.6 中，`KeyCollection<T>`implements `IReadOnlyCollection<T>`，所以如果你使用那个接口，你仍然可以反映字典的变化，仍然得到 O(1) 包含，并且因为接口是协变的，你可以返回`IReadOnlyCollection<some base type>`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T14:48:45.667

假设您使用的是 C# 3.0 并且您有：

字典< T,S > d;

然后

ReadOnlyCollection< T > r = new ReadOnlyCollection< T >( d.Keys.ToList() );

您还需要导入 System.Linq 命名空间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T15:04:05.123

不幸的是，据我所知，你不能直接做到这一点，因为`KeyCollection<T>`它不会暴露任何可以让你轻松做到这一点的东西。

但是，您可以进行子类`ReadOnlyCollection<T>`化，以便它的构造函数接收字典本身并覆盖适当的方法，以便它公开字典的项目，就好像它们是它自己的项目一样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T14:45:47.967

这很丑陋，但这会做到这一点

```
Dictionary<int,string> dict = new Dictionary<int, string>();
...
ReadOnlyCollection<int> roc = new ReadOnlyCollection<int>((new List<int>((IEnumerable<int>)dict.Keys))); 
```

# delphi - wintypes.dcu 未找到且代码完成停止工作

> ID：284091
> 
> 赞同：8
> 
> 时间：2008-11-12T14:26:48.007
> 
> 标签：delphi, delphi-2009

我收到错误：在 Delphi 2009 IDE 中一天找不到几次 wintypes.dcu，在此错误代码完成停止工作后，我也无法使用 Ctrl + Click 打开任何单元的源代码，然后我必须重新打开IDE 来修复它。

任何人都知道可能导致这种情况的原因吗？

我安装的唯一 IDE 扩展是 GExperts。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-12T15:14:29.267

wintypes.pas 和 winprocs.pas 已被 windows.pas 替换（很久以来）。您应该使用 Unit Aliases 将所有 wintypes 替换为 windows。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-12T15:27:06.247

对于现在的 Windows 单元，您必须仍在使用古老的（Delphi 2 之前的）名称。我建议您搜索并替换所有使用列表，并将 WinTypes 和 WinProcs 替换为 Windows。

或者，您可以确保在项目选项的 Unit Aliases 部分中具有“WinTypes=Windows”和“WinProcs=Windows”，但在这几十年之后，我仍然会转向 32 位世界！（16 位是主要限制，这意味着 WinTypes 和 WinProcs 是两个独立的单元。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-28T22:16:10.587

打开项目 - 选项，Delphi 编译器，进入单元别名插入：

WinTypes=Windows;WinProcs=Windows;DbiProcs=BDE;DbiTypes=BDE;DbiErrs=BDE

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T18:12:31.967

您使用决策立方体组件吗？因此，请在您的源代码中查找有关单元 MXQEDCOM.pas 的参考资料。

在 BDS 2006 上，是我找到的 Wintypes 和 Winprocs 的唯一参考。

顺便说一句，请确保 Unit Aliases 包含[Barry Kelly](https://stackoverflow.com/questions/284091/wintypesdcu-not-found-and-code-completion-stops-working#284290)编写的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T14:40:09.353

为什么找不到 wintypes.dcu，我不知道。但是另外两个是明显的后续错误：如果 Delphi 由于语法错误而无法编译代码（并且丢失的文件被认为是语法错误），它会停止代码完成并且无法再使用 Ctrl + Click 找到源代码。

# excel - 停止 Ms Excel 将数字字符串自动格式化为数字

> ID：284092
> 
> 赞同：3
> 
> 时间：2008-11-12T14:27:11.857
> 
> 标签：excel, ms-access, formatting, report, export-to-excel

我正在将报告从 MS Access(2003) 导出到 Excel (97-2003) 输出。

其中一列有一个字符串，该字符串对于某些行是数字的，例如“05-0880”。

当我在 MS Excel 中打开输出文件时，相应的单元格设置为数字*-372424*。

我认为这是由于 Excel 是“聪明的”并决定“05-0808”代表某种时间值或日期并将字符串转换为相应的数值造成的。

在我的情况下，数据代表产品代码，这种转换是非常不可取的。如果我导出报表基础查询的输出（导出数据表），则不会发生这种转换。（建议 Access 必须能够以防止转换的方式输出到 Excel 格式）。

我尝试更改报告中字段的格式属性，但没有“文本”选项，“标准”的行为似乎与将其留空相同。

有没有办法使用*format()*函数来强制字符串输出？如果是这样，当 Excel 仍然可以进行巧妙的转换时，这是否会有所帮助？

仅使用底层查询作为输出是一种选择，但并不理想，因为格式和分组会丢失。将报告导出为文本格式是一场灾难，因为列没有分隔。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T17:06:44.830

实际上，它更像是相反的方式。MS Access 太笨了，无法从报告中正确导出。您可以使用引号或撇号来保护数据；但是，如您所知，这非常难看，需要后期处理。

我的解决方法是仔细制作查询，然后导出查询结果而不是报告。这将为您提供您期望的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T14:30:46.157

导出“'05-0880”而不是“05-0880”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-28T20:24:47.920

确保使用单引号而不是其他撇号。

# c# - C# 构建十六进制符号字符串

> ID：284093
> 
> 赞同：18
> 
> 时间：2008-11-12T14:27:14.790
> 
> 标签：c#, string, hex

如何以十六进制表示法构建转义序列字符串。

例子：

```
string s = "\x1A"; // this will create the hex-value 1A or dec-value 26 
```

我希望能够像这样构建具有 00 到 FF 之间的十六进制值的字符串（在本例中为 1B）

```
string s = "\x" + "1B"; // Unrecognized escape sequence 
```

也许还有另一种制作十六进制字符串的方法......

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-11-12T15:51:47.023

请尽量避免`\x`转义序列。它很难阅读，因为它停止在哪里取决于数据。例如，这两个字符串一眼看去有多大区别？

```
"\x9Good compiler"
"\x9Bad compiler" 
```

在前者中，“\x9”是制表符——转义序列在此处停止，因为“G”不是有效的十六进制字符。在第二个字符串中，“\x9Bad”都是一个转义序列，给您留下一些随机的 Unicode 字符和“编译器”。

我建议您改用 \u 转义序列：

```
"\u0009Good compiler"
"\u0009Bad compiler" 
```

（当然对于你会使用的标签，`\t`但我希望你明白我的意思......）

当然，这与最初的问题有些不同，但已经回答了:)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-11-12T14:35:43.447

您不会将十六进制值存储在字符串中。

你可以，但它只是一个字符串，并且必须转换为整数或字节才能实际读取其值。

您可以将十六进制值作为文字分配给 int 或字节：

```
Byte value = 0x0FF;
int value = 0x1B; 
```

因此，很容易将十六进制文字传递到您的字符串中：

```
string foo = String.Format("{0} hex test", 0x0BB); 
```

这将创建这个字符串“126 hex test”。

但我不认为这就是你想要的？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-12T15:12:32.563

**十六进制16 位**unicode 字符代码有一个 '\u' 转义码。

```
Console.WriteLine( "Look, I'm so happy : \u263A" ); 
```

# xml - 如何使用命名空间从 XML 中“选择”？

> ID：284094
> 
> 赞同：15
> 
> 时间：2008-11-12T14:27:35.773
> 
> 标签：xml, xslt

我有一个类似于 ::: 的 XML 文档

```
<?xml version="1.0" encoding="utf-8"?>
<?mso-application progid="Excel.Sheet"?>
<Workbook xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
          xmlns:o="urn:schemas-microsoft-com:office:office"
          xmlns:x="urn:schemas-microsoft-com:office:excel"
          xmlns="urn:schemas-microsoft-com:office:spreadsheet">
  <Worksheet ss:Name="Worksheet1">
    <Table>
      <Column ss:Width="100"></Column>

      <Row>
        <Cell ss:Index="1" ss:StyleID="headerStyle">
          <Data ss:Type="String">Submitted By</Data>
        </Cell>
      </Row>
      <Row>
        <Cell ss:Index="1" ss:StyleID="alternatingItemStyle">
          <Data ss:Type="String">Value1-0</Data>
        </Cell>
      </Row>
    </Table>
    <AutoFilter xmlns="urn:schemas-microsoft-com:office:excel"
                x:Range="R1C1:R1C5"></AutoFilter>
  </Worksheet>
</Workbook> 
```

问题是当尝试选择行时

```
 <xsl:for-each select="//Row">
    <xsl:copy-of select="."/>
  </xsl:for-each> 
```

它不匹配。我删除了所有的名称间距，它工作正常。那么，如何让“选择”匹配行？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-12T14:41:43.437

在 XSLT 中为命名空间声明一个命名空间前缀，然后`select`使用该前缀：

```
<xsl:stylesheet ... xmlns:os="urn:schemas-microsoft-com:office:spreadsheet">
  ...   
  <xsl:for-each select="//os:Row">
    ...
  </xsl:for-each>
  ...
</xsl:stylesheet> 
```

这通常会产生易于阅读的 XPath。但是，XSLT/XPath 工具会生成以下等效代码：

```
<xsl:for-each select="//*[local-name()='Row' = and namespace-uri()='urn:schemas-microsoft-com:office:spreadsheet']">
   ...
</xsl:for-each> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-12T14:37:48.170

如果您不关心命名空间，可以使用 XPath `local-name()' 函数：

```
<xsl:for-each select="//*[local-name() = 'Row']">
  <xsl:copy-of select="."/>
</xsl:for-each> 
```

或者，同样的事情可以这样表达。我不确定这是否是标准 XPath 以及是否所有 XPath 实现都支持它（ColdFusion 支持，Java 也可能支持）。也许有人知道这是否符合任何标准。

```
<xsl:for-each select="//:Row">
  <xsl:copy-of select="."/>
</xsl:for-each> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-12T15:08:36.923

[Tomalek](https://stackoverflow.com/users/18771/tomalak)和[ckarras](https://stackoverflow.com/users/5688/ckarras)给出了很好的答案，但我想澄清他们背后的原因。

您不匹配的元素位于它们在 doc 中出现的范围的默认命名空间中，也就是说，它们位于为该范围声明的命名空间中，没有前缀（例如

```
xmlns="urn:schemas-microsoft-com:office:spreadsheet" 
```

在`Workbook`元素上）。即使标记名缺少命名空间前缀，它们也在命名空间中。

`namespace-uri()`但是，XPath 要求命名空间中的所有元素名称都必须使用前缀进行限定，或者在谓词中明确指定命名空间。因此，您必须`local-name()`在谓词中使用该函数来匹配元素名称（`namespace-uri()`如果存在跨名称空间名称冲突的危险，也必须使用该函数），或者您必须声明您希望在 XPath 中匹配元素的每个名称空间使用前缀，并在 XPath 表达式中使用它们的命名空间前缀来限定元素名称。

# c++ - 我应该为富客户端应用程序选择什么 Windows API？

> ID：284103
> 
> 赞同：6
> 
> 时间：2008-11-12T14:31:30.103
> 
> 标签：c++, windows, visual-c++, cross-platform

我在 Mac OS X 和 Linux 上开发富客户端软件。我希望将应用程序移植到 Windows 而不是 Microsoft 产品的用户，我一般对 Windows 不是很熟悉。

我所熟悉的：

在 Mac OS X 上，我可以选择 Cocoa 和 Objective C 或 Carbon 和 C/C++。在 Linux 上，我可以选择 GTK+ 和 C/C++ 或 Qt 和 C++。我更喜欢 Mac OS X 上的 Cocoa 和 Linux 上的 GTK+。Cocoa 的 Interface Builder 和 GTK+ 的 Glade 让我的生活变得轻松。在这些操作系统中创建富客户端很**有趣。**

我的核心类，或 MVC 中的“模型”，是用跨平台 C++ 编写的。用户界面类，或 MVC 中的“视图和控制器”，是用每个平台的“首选”语言和 GUI API 编写的。

C++ 是我最熟悉的语言。我广泛使用 Boost 库。尤其是智能指针、线程和 asio 网络库。对于 Unicode、本地化等，我使用 Unicode 国际组件 (ICU)。

问题 1：与我的跨平台模型类兼容的 Windows 平台的“首选”语言和 GUI API 是什么？

问题 2：如何访问我的跨平台模型类？

例如，在 Mac OS X 上，我通过控制器类访问我的模型类。控制器类在 Objective-C++ 中实现。Objective-C++ 是 C++ 和 Objective-C 的混合体。在 Objective-C 中查看对象与控制器对象“对话”，而在 C++ 中控制器对象与模型对象“对话”。

在 Linux 上，所有类都是用 C++ 实现的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T14:49:16.243

Windows 上并没有真正的“首选”语言和 API，更像是有很多选择。最明显的是直接对操作系统的原始 Win32 调用（所以实际上只是 C 调用），或者在此之上的薄抽象（例如 WTL，Windows 模板库，它是 C++），或者更厚的抽象（例如 MFC，也C++）。

微软现在正在大力推动 WPF，但这是托管 .NET 世界的一部分。您可以在其中编写 C++，因此您可以移植您的应用程序，但我预计这将是一项巨大的努力。

鉴于您在 Linux 上使用 GTK+ 或 QT，显而易见的事情是考虑在 Windows 上同时使用这两者，因为两者都存在 - 这样您就可以保持 Linux 和 Windows 版本几乎相同。它们不是纯 Windows 应用程序的自然选择，因为它们最初并非来自 Windows 世界，但考虑到您的背景，它们会很有意义。您可能需要花一些时间来调整它们以使 Windows 应用程序的外观和感觉恰到好处，但这应该可以通过不需要编写全新的表示层来弥补。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-12T16:09:19.687

Qt 在 Windows 上运行良好。此外，它独立于平台。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T14:47:46.263

如果您可以让您的 C++ 使用 Visual Studio 工具链（而不是 gcc 或 mingw）进行编译，我强烈建议您制作一个 .lib，然后将其链接到一个 C++/CLI 程序集，在其中将托管 API 公开给您的图书馆。

然后，您可以使用 C# 和 WinForms API 或 WPF，并拥有一个极其丰富且具有原生窗口外观的应用程序。这项工作非常简单，如果您愿意重写 GUI，它将获得最好的结果并且最容易部署。

一个警告是，如果您需要它在可能不存在 .NET 的机器上工作——如果是这样，我会坚持使用 .NET 2.0（和 WinForms）。您还应该让安装程序检测并安装它。如果您愿意安装 .NET 3.5（如果不存在），请选择 WPF。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T14:40:00.523

GTK+ 在 Windows 上运行良好。如果您已经熟悉它，那就是我会使用的。尽管性能可能与原生 Windows UI 库（如 MFC）的性能不匹配，但它已经足够好，除非您的应用程序真的依赖于 ui 性能。在所有平台上使用 GTK+ 的一个重要例子是[Pidgin](http://www.pidgin.im)。

如果没有看到一些代码，就无法真正回答您的第二个问题，但我不明白为什么它与您在其他平台上的模型视图控制器方法不同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T14:44:25.600

Windows Presentation Foundation (WPF) 是适用于 Windows 的新 Microsoft 丰富应用程序标准。您的 C++ 将移植到它，但大多数人都针对它开发 C#。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T17:09:52.763

我倾向于 Windows Presentation Foundation。我想这是微软在 Mac OS X 上对 Cocoa 的回答，因为“它旨在统一许多应用程序服务：用户界面、2D 和 3D 绘图、固定和自适应文档、高级排版、矢量图形、光栅图形、动画、数据绑定，音频和视频。” 这对我来说听起来像可可:-)

我想这个实现类似于我的 Mac OS X 实现：

*   模型：跨平台 C++ 类
*   查看：WPF 和 C#
*   控制器：C++/CLI 或其他

而在 Mac OS X 上，视图类是用 Objective-C 实现的，而控制器类是用 Objective-C++ 实现的。在 Objective-C 中查看对象与控制器对象“对话”，而在 C++ 中控制器对象与模型对象“对话”。

Windows 上的 C++/CLI 是像 Mac OS X 上的 Objective-C++ 还是我在 C++/CLI 中*定义的 C# 类不可访问？*

从托管 .Net 语言访问 C++ 类的“正确”或“首选”方式是什么？

# sql-server - 您对 Report Builder 2.0 使用什么源代码管理？

> ID：284111
> 
> 赞同：2
> 
> 时间：2008-11-12T14:33:32.203
> 
> 标签：sql-server, version-control, reporting-services

我想使用新的报表生成器 2.0，而不是旧的 VS2005 集成报表生成器以获得新功能和易用性，但源代码控制集成是必须的。

我没有看到任何本地使用 TFS 的能力，并且我已经安装了[TFS MSSCCI Provider](http://www.microsoft.com/downloads/details.aspx?FamilyId=FAEB7636-644E-451A-90D4-7947217DA0E7&displaylang=en)，所有这些都没有爱。

有谁知道如何让他们打得好，还是我从错误的角度看待这个问题。

您如何对 SQL 报告进行版本控制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T21:46:47.700

如果您使用的是 Report Builder，您可以从文件系统中打开 RDL 文件，但是是的，它不直接与 TFS 或任何源代码控制包集成。你需要VS我害怕。所以你可以结帐，在报告生成器中打开..保存然后再签入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T03:50:29.837

RB2 不使用传统的文件系统接口，而是使用报表服务器 Web 服务与报表服务器上的文件进行通信。由于这种脱节，您不会找到任何简单的答案 - 但只有一个建议。如果您在 sharepoint 集成模式下运行，您可能会获得某种程度的更改跟踪。

# c# - XmlSerializer 和 XmlElement 字段

> ID：284112
> 
> 赞同：4
> 
> 时间：2008-11-12T14:33:59.287
> 
> 标签：c#, .net, xml, xml-serialization

我有一个看起来像这样的 xml：

```
<Config>
<A></A>
<Template><B/><C/></Template>
</Config> 
```

我想反序列化它以将`<Template><B/><C/></Template>`位作为 XmlElement 或 XmlNode。但是当我这样尝试时：

```
public class Config
{
     public string A;
     public XmlElement Template;
} 
```

模板设置为`<B/>`仅。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-12T15:19:50.067

[使用XmlAnyElement](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlanyelementattribute.aspx)属性装饰您的 Template 成员。这应该够了吧。

# variables - 您是否遵循原始程序员的命名约定？

> ID：284113
> 
> 赞同：8
> 
> 时间：2008-11-12T14:34:28.693
> 
> 标签：variables, naming-conventions, hungarian-notation

如果你从某人那里接手一个项目来做简单的更新，你会遵循他们的命名约定吗？我刚收到一个项目，以前的程序员到处使用匈牙利符号。我们的核心产品有一个命名标准，但多年来我们有很多人做自定义报告，做他们想做的任何事情。

不过，我没有时间更改代码中已经存在的所有变量名称。

我倾向于继续他们的命名约定以保持可读性。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-12T14:37:43.460

是的，我愿意。它使继承它的人更容易跟随你。如果真的很难理解，我会尝试稍微清理一下代码以使其更具可读性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-12T14:41:47.633

如果您没有将所有现有代码更改为您的标准，那么只要您更改这些文件，我会说坚持原始约定。在同一个文件中混合两种风格的代码正在破坏一致的代码风格所带来的任何好处，下一个人将不得不不断问自己“谁编写了这个函数，它将被称为什么 - FooBar() 或 fooBar( ）？”

当您导入 3rd 方库时，这种事情会变得更加棘手——您不想重写它们，但它们的代码风格可能与您的不匹配。所以最后，你会得到几种不同的命名约定，最好在“我们的代码”和“他们的代码”之间划清界限。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-12T14:54:14.957

我同意建议保留作者编写的代码，**只要该代码内部一致即可。**如果代码由于不一致而难以遵循，您有责任对未来的维护者（可能是您）负责，使其更清晰。

如果您花费 40 个小时来弄清楚一个函数的作用，因为它使用了命名不佳的变量等，您**应该**重构/重命名以清楚起见/添加评论/做任何适合这种情况的事情。

也就是说，如果唯一的问题是作者使用的最一致的风格与公司标准或您习惯的风格不同，我认为您正在浪费时间重命名所有内容。此外，如果原始作者仍然可以回答问题，您可能会失去专业知识的来源，因为他将不再识别代码。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-12T14:39:14.377

通常，为了符合风格指南而对代码库进行大规模更改只是引入新错误的一种方式，几乎没有附加价值。

这意味着您应该：

1.  更新您正在处理的代码，使其在处理时符合指南。

2.  使用代码中的约定来帮助未来的维护工作。

我推荐 2.，但匈牙利符号让我的眼睛流血：p。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-12T14:40:21.333

如果您正在维护其他人编写的代码并且其他人将在您之后维护，那么您应该对所有相关人员负责，不要进行无缘无故的更改。当他们进入源代码控制系统查看您更改的内容时，他们应该看到解决您正在处理的问题所必需的内容，而不是一百万个差异，因为您进行了一堆全局搜索并将代码替换或重新格式化为适合您最喜欢的大括号匹配约定。

当然，如果原始代码真的很糟糕，那么所有的赌注都没有了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-12T14:40:01.397

一般来说，是的，在这种情况下，我会寻求约定和可读性而不是标准。没有人喜欢这个答案，但保持代码长期可维护是正确的做法。

当一个优秀的程序员阅读代码时，他应该能够解析变量名并在他的脑海中跟踪几个——只要它们一致，至少在源文件内。但是如果你打破这种一致性，它可能会迫使阅读代码的程序员遭受一些认知失调，这会使跟踪变得更加困难。这不是杀手——优秀的程序员会度过难关，但他们会诅咒你的名字，并可能将你发布到[TheDailyWTF](http://thedailywtf.com/)上。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-12T14:40:34.623

我当然会继续使用相同的命名约定，因为它会使代码保持一致（即使它一直很丑陋）并且比混合变量命名约定更具可读性。人类的大脑似乎很擅长模式识别，你真的不想通过无缘无故地打破所说的模式来给大脑一个曲线球。

就是说，我不过是几个匈牙利符号，但如果那是你必须使用的......

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-12T14:42:00.190

如果文件或项目已经使用一致的样式编写，那么您应该尝试遵循该样式，即使它与您现有的样式冲突/矛盾。代码风格的主要目标之一是一致性，因此，如果您将不同的风格引入已经一致（在其自身内部）的代码中，您就会失去这种一致性。

如果代码写得不好并且需要一定程度的清理才能理解它，那么清理样式就成为一个更相关的选择，但只有在绝对必要时才应该这样做（尤其是在没有单元测试的情况下）运行引入意想不到的重大变化的可能性。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-12T14:43:06.960

绝对没错。我认为最好不要遵循原始程序员的命名约定的一种情况是原始程序员（或从那时起修改代码的后续开发人员）未能遵循任何一致的命名约定。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-12T15:43:08.727

是的。我实际上在标准文档中写了这个。我在我现在的公司创建：

现有代码取代所有其他标准和实践（无论它们是行业标准还是本文档中的标准）。在大多数情况下，您应该修改您的代码以匹配相同文件中的现有代码，原因有两个：

1.  避免在单个模块/文件中包含多个不同的样式/模式（这与标准的目的相矛盾并妨碍可维护性）。
2.  重构现有代码的努力往往会不必要地增加成本（耗时且有利于引入新错误）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-12T14:40:42.237

就我个人而言，每当我接手一个具有不同变量命名方案的项目时，我倾向于保留以前程序员使用的相同方案。我唯一不同的是对于我添加的任何新变量，我在变量名前加了一个下划线。通过这种方式，我可以快速查看我的变量和代码，而无需进入源历史记录和比较版本。但是当涉及到我继承简单不可读的代码或注释时，我通常会仔细检查它们并尽我所能清理它们，而无需重新编写整个东西（它已经到了）。组织是拥有可扩展代码的关键！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-12T14:40:44.217

如果我可以阅读代码，我（尝试）采用相同的约定，如果它不可读，我需要重构并因此改变它（取决于它的样子）相当大

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-12T14:41:31.533

依靠。如果我正在构建一个新应用程序并从具有垃圾变量命名的旧应用程序中窃取代码，我将在将其放入我的应用程序后进行重构。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-12T14:44:10.013

是的.. 有一点比走进一个有两种截然不同的风格的应用程序更令人沮丧。我最近从事的一个项目有两种不同的文件操作方式，两种不同的屏幕实现方式，两种不同的基本结构。第二位编码员甚至将新功能作为从主代码调用的 dll 的一部分。维护是一场噩梦，当我在一个部门工作时，我必须同时学习范式和希望。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-11-12T14:45:29.327

在罗马做到入乡随俗。

（除了索引变量名称，例如“iArrayIndex++”。停止宽恕这种白痴。）

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-11-12T14:48:48.787

我认为修复错误是一种外科手术。进去，尽可能少打扰，修理它，出去，尽可能少留下你在那里的痕迹。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-11-12T14:57:27.740

我这样做了，但不幸的是，在我之前的几个开发人员没有遵守这个规则，所以我有几个命名约定可供选择。

但有时我们有时间把事情整理好，所以最终，它会变得又好又干净。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-11-12T15:06:14.323

如果代码已经有一致的风格，包括命名，我会尝试遵循它。如果以前的程序员不一致，那么我可以随意应用公司标准，如果没有任何公司标准，我可以使用我的个人标准。

在任何一种情况下，我都会尝试通过用评论框起来来标记我所做的更改。我知道在当今的 CVS 系统中这通常不会完成，但我仍然更喜欢这样做。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-11-12T15:14:23.493

不幸的是，大多数时候答案是肯定的。大多数时候，代码没有遵循良好的约定，因此很难遵循先例。但是为了可读性，有时需要顺其自然。

*但是*，如果它是一个足够小的应用程序，我可以重构大量现有代码以更好地“闻”起来，那么我会这样做。或者，如果这是更大重写的一部分，我也将开始使用当前的编码标准进行编码。但通常情况并非如此。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-11-12T15:43:27.743

如果现有应用程序中有标准，我认为最好遵循它。如果没有标准（制表符和空格混合，大括号无处不在......哦，恐怖），那么我会做我认为最好的事情，并且通常通过格式化工具（如 Vim）运行现有代码。如果有连贯的风格，我将始终保留现有代码的大写风格等。

我对这条规则的一个例外是，除非有人用枪指着我的头，否则我不会使用匈牙利符号。我不会花时间重命名现有的东西，但我添加的任何新东西都不会有任何匈牙利疣。

# python - 跨平台隐藏文件检测

> ID：284115
> 
> 赞同：21
> 
> 时间：2008-11-12T14:35:29.563
> 
> 标签：python, cross-platform, filesystems

跨平台处理隐藏文件的最佳方法是什么？（最好在 Python 中，但仍然赞赏其他解决方案）

只需检查一个领先的“。” 适用于 *nix/Mac，文件属性适用于 Windows。然而，这似乎有点简单，也没有考虑隐藏东西的替代方法（.hidden 文件等）。有没有标准的方法来处理这个？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2011-06-15T22:37:28.717

这是一个在 Python 2.5+ 上运行的脚本，应该可以满足您的需求：

```
import ctypes
import os

def is_hidden(filepath):
    name = os.path.basename(os.path.abspath(filepath))
    return name.startswith('.') or has_hidden_attribute(filepath)

def has_hidden_attribute(filepath):
    try:
        attrs = ctypes.windll.kernel32.GetFileAttributesW(unicode(filepath))
        assert attrs != -1
        result = bool(attrs & 2)
    except (AttributeError, AssertionError):
        result = False
    return result 
```

我在 jaraco.windows 添加了类似于 has_hidden_ [​​attribute](https://bitbucket.org/jaraco/jaraco.windows)的内容。如果您有 jaraco.windows >= 2.3：

```
from jaraco.windows import filesystem

def has_hidden_attribute(filepath):
    return filesystem.GetFileAttributes(filepath).hidden 
```

正如 Ben 所指出的，在 Python 3.5 上，您可以使用 stdlib：

```
import os, stat

def has_hidden_attribute(filepath):
    return bool(os.stat(filepath).st_file_attributes & stat.FILE_ATTRIBUTE_HIDDEN) 
```

尽管您可能仍希望将 jaraco.windows 用于更多 Pythonic API。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-05T23:42:04.087

Jason R. Coombs 的回答对于 Windows 来说已经足够了。和大多数 POSIX GUI 文件管理器/打开对话框/等。可能遵循与`ls`. 但不是 Mac OS X。

至少有四种方法可以在 Finder、文件打开面板等中隐藏文件或目录：

*   点前缀。
*   HFS+ 隐形属性。
*   Finder 信息隐藏标志。
*   匹配 CoreFoundation 中内置的特殊黑名单（每个操作系统版本都不同——例如，`~/Library`在 10.7+ 中隐藏，但在 10.6 中没有）。

尝试编写自己的代码来处理所有这些并不容易。而且你必须保持最新，因为我愿意打赌黑名单会随着大多数操作系统版本而改变，Finder Info 最终会从弃用变为完全不受支持，扩展属性可能比 HFS+ 得到更广泛的支持，……</p>

但是如果你可以要求`pyobjc`（它已经包含在最近的 Apple 提供的 Python 中，并且可以通过`pip`其他方式安装），你可以调用 Apple 的代码：

```
import Foundation

def is_hidden(path):
    url = Foundation.NSURL.fileURLWithPath_(path)
    return url.getResourceValue_forKey_error_(None, Foundation.NSURLIsHiddenKey, None)[0]

def listdir_skipping_hidden(path):
    url = Foundation.NSURL.fileURLWithPath_(path)
    fm = Foundation.NSFileManager.defaultManager()
    urls = fm.contentsOfDirectoryAtURL_includingPropertiesForKeys_options_error_(
        url, [], Foundation.NSDirectoryEnumerationSkipsHiddenFiles, None)[0]
    return [u.path() for u in urls] 
```

这应该适用于 pyobjc 支持的任何 Python，在 OS X 10.6+ 上。如果您想要 10.5 或更早版本，则目录枚举标志尚不存在，因此唯一的选择是过滤类似`contentsOfDirectoryAtPath_error_`（或只是`os.listdir`） on之类的东西`is_hidden`。

`pyobjc`如果您必须不`CoreFoundation`使用`ctypes`. 主要功能是`CFURLCopyResourcePropertyForKey`用于`is_hidden`和`CFURLEnumeratorCreateForDirectoryURL`用于列出目录。

有关实现，请参见[http://pastebin.com/aCUwTumB](http://pastebin.com/aCUwTumB)。

我已经测试过：

*   OS X 10.6，32 位 python.org 3.3.0
*   OS X 10.8，32 位苹果 2.7.2
*   OS X 10.8，64 位苹果 2.7.2
*   OS X 10.8，64 位 python.org 3.3.0

它适用于每一个（例如，它`~/Library`在 10.8 上跳过，但在 10.6 上显示）。

它*应该*适用于任何 OS X 10.6+ 和任何 Python 2.6+。如果您需要 OS X 10.5，则需要使用旧 API（或`os.listdir`）并在`is_hidden`. 如果您需要 Python 2.5，请将检查更改`bytes`为`str`检查（这当然会破坏 3.x）并将检查更改`with`为丑陋`try`/`finally`或手动发布。

如果有人计划将此代码放入库中，我强烈建议`pyobjc`首先检查（`import Foundation`并且，如果您没有获得`ImportError`胜利），并且仅在`ctypes`代码不可用时才使用该代码。

* * *

最后一点：

一些寻找这个答案的人正试图重新发明一个他们不需要的轮子。

通常，当人们在做这样的事情时，他们正在构建一个 GUI 并希望，例如，显示一个文件浏览器，并带有隐藏或显示隐藏文件的选项。许多流行的跨平台 GUI 框架（Qt、wx 等）都内置了这种支持。（此外，其中许多是开源的，因此您可以阅读他们的代码以了解他们是如何做到的。）

这可能无法回答您的问题 - 例如，他们可能只是将“过滤隐藏文件”标志传递给平台的本机文件浏览器对话框，但您正在尝试构建控制台模式文件浏览器并且不能这样做. 但如果是这样，请使用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T16:11:11.150

我们实际上在我们编写的项目中解决了这个问题。我们所做的是拥有许多不同的“隐藏文件检查器”，它们在主检查器中注册。我们通过这些传递每个文件，看看它是否应该被隐藏。

这些检查器不仅适用于不同的操作系统等，而且我们插入版本控制“忽略”文件，以及通过 glob 或正则表达式可选的用户覆盖。

它主要相当于你所做的，但以一种可插入、灵活和可扩展的方式。

在此处查看源代码：[https ://bitbucket.org/aafshar/pida-main/src/tip/pida/services/filemanager/filemanager.py](https://bitbucket.org/aafshar/pida-main/src/tip/pida/services/filemanager/filemanager.py)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-29T08:43:15.290

结合我之前的答案以及来自@abarnert 的答案，我发布了具有跨平台隐藏文件检测支持的[jaraco.path 1.1 。](https://pypi.python.org/pypi/jaraco.path/1.1)安装该软件包后，要检测任何文件的隐藏状态，只需调用`is_hidden`：

```
from jaraco import path
path.is_hidden(file) 
```

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2008-11-12T15:47:54.550

“有标准的方法来处理这个吗？” 是的。使用标准（即符合 POSIX 的）操作系统。

由于 Windows 是非标准的——好吧——没有适用的标准。如果有的话不是很好吗？我感觉到你的痛苦。

你尝试做的任何跨平台的事情都会有 Win32 的奇怪之处。

你的解决方案——就目前的情况而言——非常好。在未来的某个时候，Microsoft 可能会选择编写符合 POSIX 的操作系统。在那之前，你可以很好地应对这种情况。

# c# - NAnt 扩展函数，Project 对象

> ID：284120
> 
> 赞同：2
> 
> 时间：2008-11-12T14:37:29.950
> 
> 标签：c#, nant

有没有办法`Project`从 NAnt 扩展函数访问对象，就像可以从扩展任务中完成的那样？

在这个例子中，我想使用函数`BaseDirectory`内部的属性`Bar`：

```
[FunctionSet("foo", "Foo")]
public class FooFunctions : FunctionSetBase
{
    public FooFunctions(Project project, PropertyDictionary properties)
        : base(project, properties)
    {
        // When does this constructor gets called?
    }

    [Function("bar")]
    public static string Bar(string name)
    {
        return "Bar!"; // How to get at project.BaseDirectory?
    }
} 
```

我是 NAnt 扩展的新手，所以我不知道这是否是一个有效的问题，或者我是否应该以不同的方式处理这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T21:48:36.420

好问题汤姆。抽象基类**FunctionSetBase**有一个名为**Project**的属性，您可以从**Bar**函数访问该属性。但是，我注意到 Bar 函数被声明为静态的，这并不总是必要的（但没有错）。

以下在 NAnt 世界中应该是完全合法的：

```
Function("bar")]
public string Bar(string name)
{
    string baseDirectory = Project.BaseDirectory;
    return baseDirectory; 
} 
```

你看有什么问题吗？

# .net - 如何在使用 WCF（或 WSE 3）的 Web 服务客户端应用程序的请求和响应中混合消息编码类型（文本/MTOM）？

> ID：284149
> 
> 赞同：13
> 
> 时间：2008-11-12T14:42:54.573
> 
> 标签：.net, wcf, web-services, wse, mtom

这是我的问题。我正在访问一个 Web 服务（托管在基于 Java 的服务器上），它只接受文本编码的请求，但它返回 MTOM 响应。我发现如果我将 Web 服务设置为 RequireMtom，它会发送一个 Mtom 请求！不幸的是，服务器在 Mtom 请求上阻塞并返回 500 错误。但是，如果我将其设置为文本消息编码，则响应会正确返回，并带有一个多部分 MIME (MTOM) 响应，该响应会导致 Microsoft Web 服务 API 出错（下面的示例错误）。它期待一个文本编码的响应，因为请求是文本编码的。我只想在响应中使用 RequireMtom。有人能帮我一下吗？

*正如您在下面的错误中所见（发生在标准 Web 服务 API、WCF 或 WSE3 中），当我使用文本编码发送请求时，响应正确返回，其中包含多部分/相关响应中的所有数据，但是.net 框架窒息！*

**WSE 的错误消息：**

```
Client found response content type of 'multipart/related; type="text/xml"; start="<1AE0B46A85B0186B5D136D12E1EE286E>";  boundary="----=_Part_209564_1891070135.1226526701833"', but expected 'text/xml'.
The request failed with the error message:

 at System.Web.Services.Protocols.SoapHttpClientProtocol.ReadResponse(SoapClientMessage message, WebResponse response, Stream responseStream, Boolean asyncCall)
   at System.Web.Services.Protocols.SoapHttpClientProtocol.Invoke(String methodName, Object[] parameters)
   at TestWseService.AdesaJasperWse.ManagementServiceService.runReport(String requestXmlString) in C:\Documents and Settings\xxx\My Documents\Visual Studio 2005\Projects\TestWseService\Web References\AdesaJasperWse\Reference.cs:line 229
   at TestWseService.Form1.buttonRunService_Click(Object sender, EventArgs e) in C:\Documents and Settings\xxx\My Documents\Visual Studio 2005\Projects\TestWseService\Form1.cs:line 42 
```

**WCF 的错误消息**

```
The content type multipart/related; type="text/xml"; start="<30ED8FE3004CDA67723CC7164A6CFEEC>";    boundary="----=_Part_209545_389093169.1226526546805" of the response message does not match the content type of the binding (text/xml; charset=utf-8). If using a custom encoder, be sure that the IsContentTypeSupported method is implemented properly. The first 1024 bytes of the response were: 

Server stack trace: 
   at System.ServiceModel.Channels.HttpChannelUtilities.ValidateRequestReplyResponse(HttpWebRequest request, HttpWebResponse response, HttpChannelFactory factory, WebException responseException)
   at System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout)
   at System.ServiceModel.Channels.RequestChannel.Request(Message message, TimeSpan timeout)
   at System.ServiceModel.Dispatcher.RequestChannelBinder.Request(Message message, TimeSpan timeout)
   at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)
   at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs)
   at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)
   at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message) 
```

**请求（带有文本消息编码）：**

```
POST /jasperserver-pro/services/repository HTTP/1.1
Content-Type: text/xml; charset=utf-8
VsDebuggerCausalityData: uIDPo7V2+runH+xGudbec7ueUU8AAAAA7H9vL3stlkCBofMgLa5DWkQOHHpBdy1Ek6P6nXx7FpsACQAA
SOAPAction: ""
Authorization: Basic amFzcGVyYWRtaW46akBzcDNyQGRtJW4=
Host: reports.dev.xxx.com
Content-Length: 789
Expect: 100-continue

<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body s:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><q1:runReport xmlns:q1="http://axis2.ws.jasperserver.jaspersoft.com"><requestXmlString xsi:type="xsd:string">&lt;request operationName="runReport" locale="en"&gt;&#xD;
&lt;argument name="RUN_OUTPUT_FORMAT"&gt;HTML&lt;/argument&gt;&#xD;
&lt;resourceDescriptor name="" wsType="" uriString="/BusinessIntelligence/MOS/Reports/dotnettest" isNew="false"&gt;&#xD;
&lt;label&gt;null&lt;/label&gt;&#xD;
&lt;parameter name="testparam"&gt;1&lt;/parameter&gt;&#xD;
&lt;/resourceDescriptor&gt;&#xD;
&lt;/request&gt;</requestXmlString></q1:runReport></s:Body></s:Envelope> 
```

**响应（带有文本消息编码）：**

```
HTTP/1.1 200 OK
Date: Wed, 12 Nov 2008 21:49:04 GMT
Server: IBM_HTTP_Server
Surrogate-Control: no-store
Set-Cookie: JSESSIONID=0000z5pH1xEMyulueASctjru2qe:13kftunf6; Path=/
Expires: Thu, 01 Dec 1994 16:00:00 GMT
Cache-Control: no-cache="set-cookie, set-cookie2"
Content-Length: 2580
Content-Type: multipart/related; type="text/xml"; start="<30ED8FE3004CDA67723CC7164A6CFEEC>";   boundary="----=_Part_209545_389093169.1226526546805"
Content-Language: en-US

------=_Part_209545_389093169.1226526546805
Content-Type: text/xml; charset=UTF-8
Content-Transfer-Encoding: binary
Content-Id: <30ED8FE3004CDA67723CC7164A6CFEEC>

<?xml version="1.0" encoding="utf-8"?><soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><soapenv:Body><ns1:runReportResponse soapenv:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:ns1="http://axis2.ws.jasperserver.jaspersoft.com"><runReportReturn xsi:type="xsd:string">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;operationResult version=&quot;2.0.1&quot;&gt;
    &lt;returnCode&gt;&lt;![CDATA[0]]&gt;&lt;/returnCode&gt;
&lt;/operationResult&gt;
</runReportReturn></ns1:runReportResponse></soapenv:Body></soapenv:Envelope>
------=_Part_209545_389093169.1226526546805
Content-Type: text/html
Content-Transfer-Encoding: binary
Content-Id: <report>

<html>
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <style type="text/css">
    a {text-decoration: none}
  </style>
</head>
<body text="#000000" link="#000000" alink="#000000" vlink="#000000">
<table width="100%" cellpadding="0" cellspacing="0" border="0">
<tr><td width="50%">&nbsp;</td><td align="center">

<a name="JR_PAGE_ANCHOR_0_1"/>
<table style="width: 595px" cellpadding="0" cellspacing="0" border="0" bgcolor="white">
<tr>
  <td><img alt="" src="images/px" style="width: 35px; height: 1px;"/></td>
  <td><img alt="" src="images/px" style="width: 189px; height: 1px;"/></td>
  <td><img alt="" src="images/px" style="width: 253px; height: 1px;"/></td>
  <td><img alt="" src="images/px" style="width: 118px; height: 1px;"/></td>
</tr>
<tr valign="top">
  <td colspan="4"><img alt="" src="images/px" style="width: 595px; height: 20px;"/></td>
</tr>
<tr valign="top">
  <td><img alt="" src="images/px" style="width: 35px; height: 30px;"/></td>
  <td valign="middle"><span style="font-family: Arial; font-size: 12.0px; font-weight: bold;">The value of the parameter is:</span></td>
  <td valign="middle"><span style="font-family: Arial; background-color: #FFFFFF; font-size: 12.0px; font-weight: bold;">1</span></td>
  <td><img alt="" src="images/px" style="width: 118px; height: 30px;"/></td>
</tr>
<tr valign="top">
  <td colspan="4"><img alt="" src="images/px" style="width: 595px; height: 20px;"/></td>
</tr>
</table>

</td><td width="50%">&nbsp;</td></tr>
</table>
</body>
</html>

------=_Part_209545_389093169.1226526546805-- 
```

**请求（使用 Mtom 消息编码）：**

```
POST /jasperserver-pro/services/repository HTTP/1.1
MIME-Version: 1.0
Content-Type: multipart/related; type="application/xop+xml";start="<http://tempuri.org/0>";boundary="uuid:fafcdca7-94f7-4884-a8d4-5c6d50dbe8ef+id=1";start-info="text/xml"
VsDebuggerCausalityData: uIDPo+cN2kKX2odFuUVaER0j60gAAAAAmfYaGH7Ow0WQOcwhebh5pqmDl29omcVOtwVGa10IWewACQAA
SOAPAction: ""
Authorization: Basic amFzcGVyYWRtaW46akBzcDNyQGRtJW4=
Host: reports.dev.xxx.com
Content-Length: 1031
Expect: 100-continue

--uuid:fafcdca7-94f7-4884-a8d4-5c6d50dbe8ef+id=1
Content-ID: <http://tempuri.org/0>
Content-Transfer-Encoding: 8bit
Content-Type: application/xop+xml;charset=utf-8;type="text/xml"

<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body s:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><q1:runReport xmlns:q1="http://axis2.ws.jasperserver.jaspersoft.com"><requestXmlString xsi:type="xsd:string">&lt;request operationName="runReport" locale="en"&gt;&#xD;
&lt;argument name="RUN_OUTPUT_FORMAT"&gt;HTML&lt;/argument&gt;&#xD;
&lt;resourceDescriptor name="" wsType="" uriString="/BusinessIntelligence/MOS/Reports/dotnettest" isNew="false"&gt;&#xD;
&lt;label&gt;null&lt;/label&gt;&#xD;
&lt;parameter name="testparam"&gt;1&lt;/parameter&gt;&#xD;
&lt;/resourceDescriptor&gt;&#xD;
&lt;/request&gt;</requestXmlString></q1:runReport></s:Body></s:Envelope>
--uuid:fafcdca7-94f7-4884-a8d4-5c6d50dbe8ef+id=1-- 
```

**响应（使用 Mtom 消息编码）：**

```
HTTP/1.1 500 Internal Server Error
Date: Wed, 12 Nov 2008 21:47:42 GMT
Server: IBM_HTTP_Server
Surrogate-Control: no-store
$WSEP: 
Set-Cookie: JSESSIONID=0000_iMrdp-TnK9FG3jZFzjx_hA:13kftunf6; Path=/
Expires: Thu, 01 Dec 1994 16:00:00 GMT
Cache-Control: no-cache="set-cookie, set-cookie2"
Content-Length: 12
Connection: close
Content-Type: text/html;charset=UTF-8
Content-Language: en-US

Error 500: 
```

这是一个支持微软不支持混合编码理论的链接：

[WSE 3.0：MTOM 请求必须响应 MTOM？](http://social.msdn.microsoft.com/Forums/en-US/asmxandxml/thread/9270913a-ab9f-4097-beef-51d4d69563d7/ "WSE 3.0：MTOM 请求必须响应 MTOM？")

超高！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-11-25T19:32:52.427

是的，您可以使用 WCF 发送短信并获得 mtom 回复（反之亦然）。

看...

[http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/480f1bc4-1fc4-40e9-a2ed-efcf3009d6ef](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/480f1bc4-1fc4-40e9-a2ed-efcf3009d6ef)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T09:04:54.620

我对此进行了一些研究，坏消息是从 WCF 的角度来看，请求和响应必须使用相同的编码。所以，是的，上面的答案是非常正确的。您必须与服务提供商组织以在请求和响应中启用 MTOM。据我所知，除了更改 SOAP mime-type 之外，MTOM 请求不会对他的应用程序产生任何影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T05:01:39.837

这是我在另一个论坛上得到的回复。它基本上说问题出在Java端的Axis2上。不幸的是，在这种情况下，这不在我的控制之下。

> cherry111 - 发表于 2008 年 11 月 15 日星期六 12:52:08
> 
> 您需要更改 AXIS2 Web 服务的配置。您可能知道可以在两个地方启用 MTOM。一个在 service.xml 中，另一个在 axis.xml 中。Java推荐你在service.xml中设置，但是.net wse3.0客户端不喜欢。如果您在axis.xml 中启用MTOM，它应该可以工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-09T10:37:49.637

是的，WCF 有这个强制性要求，没有，因为你可以像我一样解决它。

我写了一个 MultiContentTypeMessageEncoder，它封装了 3 个不同的编码器文本，mtom 和 fi。如果可能的话，我还计划封装一个 gpb 编码器，如果将来有充分的理由这样做

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-06T08:41:01.680

[WSE 3.0] 您可以使用单个覆盖方法 GetWebResponse 定义从 WSE3 代理对象继承的新类。

在 GetWebResponse 方法中，您可以根据响应的内容类型简单地选择是否要使用 mtom 编码。

之后，您必须使用此代理类而不是生成的代理类。

PS：必须使用 wsewsdl3 作为 WebClient 生成 WSE3 代理类（将此选项 /type:webClient 添加到命令行）。

参考： http: [//www.codeproject.com/Tips/46257/Solution-to-WSE-error-for-WSE-clients-needing](http://www.codeproject.com/Tips/46257/Solution-to-WSE-error-for-WSE-clients-needing)。

# sql-server - SQL Server NOLOCK 查询运行授权

> ID：284163
> 
> 赞同：0
> 
> 时间：2008-11-12T14:46:34.003
> 
> 标签：sql-server, security, web-applications, ddos

在我们的应用程序登录过程中，运行了几个查询，围绕验证登录。在评估它们时，我注意到其中一个查询是在没有 NOLOCK 提示的情况下运行的。

脏读似乎没有任何特别的危险，因为数据几乎不会改变。

考虑到有人一次又一次地尝试登录失败而进行的 DOS 类型攻击，我认为没有 NOLOCK 会降低我们的失败门槛。

我相信这是 DOS 攻击的极不可能的结果（我认为 Web 服务器会先攻击），但添加 NOLOCK 应该使它从不可能变为不可能。

那么，我是过分还是琐碎？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T14:49:58.880

对于针对您的服务器的 DoS 尝试，您最不必担心是否有 NOLOCK。

我不会出汗的。

如您所说，如果数据很少更改，那么在此处使用 NOLOCK 可能不会造成伤害。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T15:06:41.590

是的，你太过琐碎了。

如果您受到 DOS 攻击，SQL 授权调用上的 NOLOCK 是您最不必担心的。实施一些 DOS 检测、故障跟踪 + 节流，甚至一些不会影响用户但会减慢攻击速度的计划暂停......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T14:52:45.053

这也是一个非常罕见的情况，但仍然：就在有人停用用户以阻止他们登录的那一刻，NOLOCK 让他们进入。可能是需要立即锁定的流氓用户/黑客/员工？

您必须担心这种特殊情况才能放弃 NOLOCK 的性能优势。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T14:56:52.593

如果您经常调用该查询，尤其是在更广泛的事务中，NOLOCK 可能会提高您的性能。

考虑脏读的性质——可能发生这种情况的时间窗口真的很关键吗？例如，您在授权角色中添加或删除某人。

在添加场景中，脏读会在该尝试中失败。（拒绝访问）

在删除场景中，脏读将在该尝试上起作用。（授予访问权限）

如果数据通过手动操作（例如人工交互）发生变化 - 它们的“延迟”余量通常比您的数据库高得多/不确定！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T15:54:37.970

通过查看表的权限，您可以更好地保护您的表。像这样的表不应该允许任何直接访问，所有访问都应该来自存储的过程和对它们设置的权限。

# apache-flex - Flex datagrid 通用数值排序功能？

> ID：284164
> 
> 赞同：2
> 
> 时间：2008-11-12T14:46:47.247
> 
> 标签：apache-flex, sorting, datagrid

我正在使用 Flex dataGrid，并且需要对我的一些列进行数字排序。
查看 sortCompareFunction，似乎我需要为要排序的每一列创建一个不同的函数，因为我的排序函数必须知道它正在排序的字段。

有什么方法可以将要排序的字段传递给函数？这样我只需要一个数字排序功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T18:11:39.803

如果您使用带有 XML dataProvider 的 DataGrid，这对我有用（根据 Alex 的回答修改）：

```
private function xmlDataGridNumericSorter(field:String):Function 
{

    return function (obj1:Object, obj2:Object):int 
    {
        var num:Number = ((Number)(obj1.attribute(field)) - (Number)(obj2.attribute(field)));
        return (num > 0) ? 1 : ((num < 0) ? -1 : 0);
    }

} 
```

和

```
dataGridColumn.sortCompareFunction = xmlDataGridNumericSorter(xmlAttribute.name().toString()); 
```

一个非常好的解决方案，考虑到这可能是一个多么常见的过程..

谢谢亚历克斯，希望这可以进一步帮助人们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T16:54:21.903

我使用这个功能做到了：

```
函数字段数字排序器（字段：字符串）：函数{
    返回函数（obj1：Object，obj2：Object）：int {
        返回符号（int（obj1[field]）-int（obj2[field]））；
    }
}
```

并且对于需要排序集的每一列

```
colToBeSorted.sortCompareFunction = fieldNumericSorter("fieldname");
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-22T22:54:37.273

我没有使用数字函数进行排序 - 而是执行了以下操作：

arrayColObject.addItem({Col1: rowData[0], Col2: parseFloat(rowData[1])});

这似乎正确地进行了排序。

# sql-server - 热备 SQL Server/Web Server

> ID：284187
> 
> 赞同：3
> 
> 时间：2008-11-12T14:54:25.610
> 
> 标签：sql-server

热备 SQL Server/Web Server

这个问题可能属于 IT 类别，但作为首席开发人员，我必须想出一个集成解决方案以及纯软件问题。

我们刚刚将我们的 Web 服务器移出现场，现在我想在现场保持网站和数据库 (SQL 2005) 的热备用。在以下环境中执行此操作的最佳实践是什么？

异地：我们的网站和数据库 (SQL 2005) 位于一台 Windows 2003 服务器上。服务器前面有一个防火墙，这使得复制或数据库镜像不是一个选项。vpn 也不是一个选项。

作为开发人员，我的想法是编写一个在远程站点上运行的服务，以压缩并将数据库备份 ftp 到站点上的 ftp 服务器。然后另一个进程将解压缩备份并将其还原到此处的热备用数据库。

我想我也可以在网站上做到这一点。

我愿意接受所有想法，包括第三方解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-13T06:17:55.370

如果你想要一个远程备用，你可能想要研究一个日志传送解决方案。

[这篇文章](http://msmvps.com/blogs/omar/archive/2006/09/15/How-to-setup-SQL-Server-2005-Transaction-Log-Ship-on-large-database-that-really-works.aspx)可能会帮助你。过去，我必须为完全相同的问题开发其中一种解决方案，从头开始编写它并不太难。使用日志传送获得的优势在于，您可以恢复到任何时间点，并且避免传送这些大而重的完整备份，而是传送轻量事务日志备份，偶尔还会传送大备份。

您必须记住，如果没有完整的事务日志备份序列和完整备份，事务日志备份将毫无用处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T06:19:31.367

你有完全正确的想法。您也许可以编写一个脚本，将您移动的文件的名称插入到您的暖服务器可以读取的表中。然后，您的工作可以每隔一段时间轮询该表，而不必担心时间。

忘了那个 - 刚刚发现这个。听起来像你打算做的事情。 [http://www.sqlservercentral.com/articles/Administering/customlogshipping/1201/](http://www.sqlservercentral.com/articles/Administering/customlogshipping/1201/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T03:49:12.270

我听说过有关 Syncback 的好消息：

[http://www.2brightsparks.com/syncback/sbpro-features.html](http://www.2brightsparks.com/syncback/sbpro-features.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-13T14:30:20.927

感谢文章 sambo99 的链接。事务日志传送是我最初的想法，但我驳回了它，因为服务器不在同一个域中，甚至不在同一个时区。我将文件从 A 点移动到 B 点的唯一方法是通过 FTP。我将尝试仅发送事务日志。看看是否有办法在给定的时间间隔启动恢复工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T06:50:40.540

www.FolderShare.com 是微软的一个很好的工具。您可以将日志传送到本地目录，然后将该目录同步到任何其他机器。您也可以同步网站文件夹。

“设置它并忘记它”类型的解决方案。设置您的 SQL 作业以清除旧文件，并且在初始安装后您将永远不必编辑任何内容。

FolderShare（免费，测试版）目前限制为每个库 10,000 个文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-14T15:30:45.843

对于所有感兴趣的人，以下问题也与我实施日志传送的总体计划有关：

[SQL Server sp_cmdshell](https://stackoverflow.com/questions/288084/sql-server-xpcmdshell)

# reporting-services - 是否可以在报告服务上以编程方式将列表集中在页面上？

> ID：284188
> 
> 赞同：0
> 
> 时间：2008-11-12T14:55:27.760
> 
> 标签：reporting-services

我有兴趣（动态地）将页面上的列表/表格居中。

例如，我有一个未知记录数的表（只有在运行时才会知道）

那么如何在页面中居中呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T06:26:59.713

我自己没有尝试过，但是您是否考虑过根据表达式设置顶部位置或边距？类似于以下伪代码

```
( < pageHeight> - (<numRows> * <rowhieght>) ) / 2 
```

# c++ - actionscript/flash 和 c++ 的脚本

> ID：284189
> 
> 赞同：2
> 
> 时间：2008-11-12T14:55:37.993
> 
> 标签：c++, flash, scripting

我没有太多使用 Flash 或动作脚本。我正在计划一个小项目，我想通过 flash 在线，但我想在我的 c/c++ 项目中重用代码

有我可以使用的脚本语言吗？我在想lua或python。谷歌搜索后，我发现了不完整的流感和 jython。我可以在 Flash 中使用 java 吗？在使用 flash 运行的 java 中使用 python 是个好主意吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T08:01:03.153

你看过[炼金术](http://labs.adobe.com/technologies/alchemy/)吗？

> 借助 Alchemy，Web 应用程序开发人员现在可以在 Flash 平台上重用数亿行现有的开源 C 和 C++ 客户端或服务器端代码。Alchemy 将高性能 C 和 C++ 库的强大功能带入 Web 应用程序，同时在 AVM2 上的降级最小。C/C++ 代码作为 SWF 或 SWC 编译为 ActionScript 3.0，可在 Adob​​e Flash Player 10 或 Adob​​e AIR 1.5 上运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T01:24:03.377

你看过Haxe吗？[http://www.haxe.org](http://www.haxe.org)

Haxe 编译器可以使用或多或少类似于 ActionScript 或 JavaScript 的语言生成 swf 文件、JavaScript 和其他文件，具体取决于您关心的语言细节。

这是来自 haxe 网站的精彩预告：“目前正在测试中，使用 Hugh Sanderson 提供的正确构建的 Haxe，您现在可以将 Haxe 应用程序输出为纯 C++ 源代码，并带有 makefile。”

但是不，我不知道在 Flash 中使用 Java。您的意思是 Flash 应用程序在运行时执行 Java？或使用 Java 创建 Flash 应用程序？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T15:02:24.627

无法在 Flash 电影中嵌入 Java。如果您正在创建一个将在浏览器中显示的 SWF，那么您将受限于 Actionscript。您可以创建一个 Java 小程序，将其加载到同一页面中，然后使用 javascript 在两者之间进行通信，但我不建议这样做。

如果您使用投影仪创建 EXE，那么您可能能够加载和使用 C++ dll，尽管我从未尝试过。

# windows-vista - Vista Ultimate 64 w/SP1 适合开发机器吗？

> ID：284190
> 
> 赞同：5
> 
> 时间：2008-11-12T14:55:55.637
> 
> 标签：windows-vista, vista64

我正在更新我的装备，我需要在继续使用 XP x64 还是使用 Vista x64 之间做出决定。我很少做开发，实际上只是从我的开发人员那里构建产品。我另外 90% 的工作是使用 Google Apps、Skype、Office 等完成的……

我想升级到 Vista 不仅因为我将在 DirectX10 上运行 3x 显示器，而且主要是因为 XP x64 不支持 iTunes！

所以，我的问题...

有了关于 Vista 的所有恐怖故事，配备 8GB RAM 的 Vista Ultimate x64 是否适合我的开发机器？

如果我不能在 Vista 上开发，我总是可以打开一个 VPC 来进行开发。不是吗？

**编辑**

我正在使用所有 Microsoft 开发工具...

*   VS.NET 2005
*   VS.NET 2008
*   VB6
*   SQL Server 2005/2008
*   ASP.NET
*   （.NET 2.0 和 .NET 3.0）

我确定软件会运行，我想我不太确定操作系统是否足够快或足够稳定。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T14:57:02.577

我对 .net 和 php 的 Vista 64 位很好。

很多关于它的对话已经在 SO 上。以下是您可能会考虑的一些重要点**.Net**：

*   [使用 NUnit 进行单元测试](https://stackoverflow.com/questions/208985/nunitexe-cannot-work-on-vista-64bits-if-x86-build)

*   [UAC 与开发](https://stackoverflow.com/questions/128352/when-developing-do-you-turn-off-uac-in-vista#128354)

*   [VS 和 Vista](https://stackoverflow.com/questions/251460/running-visual-studio-2008-x86-on-windows-vista-x64#251500)

*   多很多...

您可以毫无问题地在新的 X64 机器上开发 X86。

对于**PHP** XAMPP 工作正常，Eclipse 也工作正常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T15:28:04.653

我运行具有 4GB 内存的 Vista x64 并且没有遇到任何重大问题。在此之前，我使用的是 Vista x86，我绝对更喜欢 x64，因为它**看起来**更稳定。

如果你很好奇，只有（呵呵，只有！？说起来很神奇）4GB 内存我可以轻松运行：

*   3 个带有 Resharper 的 Visual Studio 2008 实例
*   几个 Sql Management Studio 实例
*   带有 3 个邮件存储区的 Outlook，总计 @ 2GB
*   带有@ 20 个标签的 Firefox
*   一堆 Windows 资源管理器窗口
*   Windows媒体播放器
*   iTunes（像狗一样慢）
*   @ 5 Excel 和 Word 文档
*   加上一些分类服务（例如，Sql Service 2005 和 2008）和状态区应用程序

尽管如此，我仍然有大约 750 MB 的可用空间，并且在使用应用程序时没有性能问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T14:59:18.347

在切换到 Windows Server 2008 (x64) 之前，我使用了很长时间 - 虽然非常好，

就个人而言，我发现 Server 2008 是一个更好的开发操作系统。查看[这篇](http://www.win2008workstation.com/)关于将 Windows Server 2008 转换为更像 Vista 的文章。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-12T15:08:26.563

我现在运行 Vista Business x64 SP 1 (8 GB RAM) 一个月了。到目前为止没有问题。我正在使用以下软件：

*   视觉工作室 2005 SP 1
*   视觉工作室 2008 SP 1
*   TortoiseSVN / VisualSVN
*   Visual SourceSafe（旧项目）
*   SQL Server 客户端工具
*   火狐 3.01 + 萤火虫
*   IE 7 + 提琴手
*   铬合金
*   Red Gate SQL 比较/数据比较
*   虚拟 PC 2007 SP 1
*   记事本++
*   同步返回
*   RoyalTS（远程桌面管理器）
*   Skype
*   办公室 2007

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T14:58:22.950

我个人在我的开发机器上使用带有 8GB RAM 的 Vista Ultimate x64。我没有 3 台显示器，但我的机器非常适合开发。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-12T15:02:19.213

我运行 Vista x64 Ultimate 作为我的主要开发机器，它很好。对 x64 的支持已经走过了漫长的道路，在大多数情况下，除了程序文件的位置和更多的 RAM 之外，您不会注意到任何差异。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-12T15:17:50.633

Vista x64 非常适合 .NET 和 Java。从 4GB RAM 开始，但这还不够（有时达到 100%，机器会慢得爬行）。6GB勉强够用。有时会达到 95% 的内存使用率，它会变慢一点，但机器不会再陷入分页狂潮。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-12T15:38:24.803

Vista 将非常快速和稳定。我现在正在使用 Vista x64 Ultimate 进行开发@work，并且已经使用了一段时间。我对此无话可说。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-12T14:58:40.907

我会说这取决于你正在开发什么。首要任务应该是确保您的所有开发和测试工具在 Vista x64 下都能正常工作。如果他们不这样做，就没有理由忍受在虚拟机中完成所有实际工作的痛苦。

所以我想说最好的办法是冒险，看看它是如何工作的，并保留 XP 光盘。如果一切都按预期工作，那么在 VPC 中运行一份 XP 副本以进行兼容性测试仍然是谨慎的做法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-12T15:34:16.310

在 IE6 中进行任何开发都必须使用基于 XP 的虚拟机。在 Vista 中运行该浏览器几乎是不可能的，更不用说 Ultimate。

由于很多政府和遗留代码库都反对 IE6，所以这种情况经常发生。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-12T15:53:47.283

我使用 Vista x64 作为开发机器，并且只有一些小问题主要与在 Visual Studio 2008 中使用第三方 API 有关。请记住，如果您在使用第三方时在 Visual Studio 项目中遇到真正无法解释的错误API - 尝试在您的项目设置中使用**x86 CPU 标志编译您的应用程序。**这解决了我在这里和那里的一些头痛问题。

# command-line - 安排 .vbs 文件在 Windows 中运行

> ID：284201
> 
> 赞同：1
> 
> 时间：2008-11-12T14:58:34.650
> 
> 标签：command-line, vbscript, windows-server-2003, telnet, wsh

我有一个[VBScript](http://en.wikipedia.org/wiki/VBScript)脚本，它启动一个 cmd 提示符，telnet 到一个设备和[TFTP](http://en.wikipedia.org/wiki/Trivial_File_Transfer_Protocol)的配置到服务器。当我登录并手动运行它时它可以工作。我想用 Windows [Task Scheduler](http://en.wikipedia.org/wiki/Task_Scheduler)自动化它。

任何帮助将不胜感激，这是 VBScript 脚本：

```
set WshShell = WScript.CreateObject("WScript.Shell") 
WshShell.Run "cmd" 
WScript.Sleep 100 
WshShell.AppActivate "C:\Windows\system32\cmd.exe" 
WScript.Sleep 300 
WshShell.SendKeys "telnet 10.20.70.254{ENTER}" 
WScript.Sleep 300 
WshShell.SendKeys "netscreen" 
WScript.Sleep 300 
WshShell.SendKeys "{ENTER}" 
WScript.Sleep 300
WshShell.SendKeys "netscreen" 
WshShell.SendKeys "{ENTER}" 
WScript.Sleep 300 
WScript.Sleep 300 
WshShell.SendKeys "save conf to tftp 10.10.40.139 test.cfg{ENTER}"
WScript.Sleep 200 
WshShell.SendKeys "exit{ENTER}" 'close telnet session' 
set WshShell = WScript.CreateObject("WScript.Shell") 
WshShell.Run "cmd" 
WScript.Sleep 100 
WshShell.AppActivate "C:\Windows\system32\cmd.exe" 
WScript.Sleep 300 
WshShell.SendKeys "telnet 10.20.70.254{ENTER}" 
WScript.Sleep 300 
WshShell.SendKeys "netscreen" 
WScript.Sleep 300 
WshShell.SendKeys "{ENTER}" 
WScript.Sleep 300
WshShell.SendKeys "netscreen" 
WshShell.SendKeys "{ENTER}" 
WScript.Sleep 300 
WScript.Sleep 300 
WshShell.SendKeys "save conf to tftp 10.10.40.139 palsg140.cfg{ENTER}" 'repeat as needed 
WScript.Sleep 200 
WshShell.SendKeys "exit{ENTER}" 'close telnet session' 
WshShell.SendKeys "{ENTER}" 'get command prompt back 
WScript.Sleep 200 
WshShell.SendKeys "exit{ENTER}" 'close cmd.exe

WshShell.SendKeys "{ENTER}" 'get command prompt back 
WScript.Sleep 200 
WshShell.SendKeys "exit{ENTER}" 'close cmd.exe 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T15:02:34.097

添加使用您的凭据运行脚本的计划任务。提醒自己，每次更改密码时都需要更新任务的凭据。每次运行时通过电子邮件或其他方式让脚本“打电话回家”是个好主意，这样您就可以判断它是否正在执行。

为此类活动设置单独的服务 ID 可能也是一个好主意。您可能不需要经常更改服务 ID 上的密码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T15:24:10.963

您可以添加计划任务并且不为其输入凭据或密码。这将导致它在本地系统（通常是任务计划程序服务使用的上下文）下运行。

请注意，这是一个后门漏洞场景：任何被允许编辑您的脚本文件的人都可能滥用它在运行该任务的机器上做不受欢迎的事情。对脚本文件设置适当的权限以防止这种情况发生。另一方面 - 作为 LOCAL SYSTEM 运行的任务不能对网络造成严重破坏。

我建议你稍微压缩你的脚本文件：

```
设置 WshShell = WScript.CreateObject("WScript.Shell")

运行“cmd.exe”
SendKeys "telnet 10.20.70.254{ENTER}"
SendKeys“网屏”
发送键“{ENTER}”
SendKeys“网屏”
发送键“{ENTER}”
SendKeys“将配置保存到 tftp 10.10.40.139 test.cfg{ENTER}”
SendKeys "exit{ENTER}" '关闭远程登录会话'

运行“cmd.exe”
SendKeys "telnet 10.20.70.254{ENTER}"
SendKeys“网屏”
发送键“{ENTER}”
SendKeys“网屏”
发送键“{ENTER}”
SendKeys "save conf to tftp 10.10.40.139 palsg140.cfg{ENTER}" '根据需要重复
SendKeys "exit{ENTER}" '关闭远程登录会话'
SendKeys "{ENTER}" '返回命令提示符
SendKeys "exit{ENTER}" '关闭 cmd.exe
SendKeys "{ENTER}" '返回命令提示符
SendKeys "exit{ENTER}" '关闭 cmd.exe

子发送密钥
  WshShell.SendKeys
  WScript.Sleep 300
结束子

子运行（命令）
  WshShell.Run 命令
  WScript.Sleep 100
  WshShell.AppActivate 命令
  WScript.Sleep 300
结束子

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T14:09:02.650

如果您没有登录，我很高兴 SendKeys 将无法工作。无论如何，根据我的经验，它是不可靠的。使用 DOS 批处理文件可能会更好。

getftpconf.bat：

```
telnet 10.10.40.139
netscreen
netscreen
save conf to tftp 10.10.40.139 palsg140.cf
exit 
```

类似的东西。

如果命令提示符中有需要记录的输出，可以在命令行快捷方式的末尾加上“>> output.txt”。

然后，您可以调用另一个批处理文件，通过 ftp 将该 output.txt 发送到您需要的任何地方。

您可以轻松地将此批处理文件设置为在 Windows 中作为计划任务运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T21:39:44.170

只需制作一个包含以下内容的批处理文件：

```
cscript.exe myscript.vbs 
```

将其保存为 myscript.bat 之类的文件。

使用计划任务来计划 .bat 文件。创建计划任务后，您可能需要检查它的属性以确保它具有适当的用户权限。

您可以将[一些选项](http://technet.microsoft.com/en-us/library/bb490816.aspx)与 cscript 一起使用，这样它就不会显示徽标等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T17:46:48.303

如果桌面被锁定或没有用户登录，我很确定 SendKeys 将不起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T21:27:19.267

批处理文件不能在带有 Telnet 的 Windows 中工作（在 UNIX 中工作正常——再次，微软的方式）。正如这里已经提到的，未登录时，sendkeys 在 vba 中不起作用。

抱歉，我没有适合您的“这确实有效”的解决方案....我遇到了同样的问题

# c# - 遍历 C# 中的通用列表

> ID：284220
> 
> 赞同：3
> 
> 时间：2008-11-12T15:05:07.180
> 
> 标签：c#, generics

```
public class Item
{
        private int  _rowID;
        private Guid _itemGUID;

        public Item() { }

        public int Rid
        {
            get
            {
                return _rowID;
            }
            set {  }

        }

        public Guid IetmGuid
        {
            get
            {
                return _itemGuid;
            }
            set
            {
                _itemGuid= value;
            }

        }

} 
```

以上是我的自定义对象。

我有一个清单：

```
List<V> myList = someMethod; 
```

其中 V 的类型是 Item，我的对象。

我想迭代并获得这样的属性

```
foreach(V element in mylist)
{
   Guid test = element.IetmGuid; 
} 
```

当我调试并查看“元素”对象时，我可以看到“Quickwatch”中的所有属性，但我无法执行 element.IetmGuid。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T15:19:32.033

您是否对泛型类型 V 施加了约束？您需要告诉运行时 V 可以是属于您的类型的子类型的任何`Item`类型。

```
public class MyGenericClass<V>
  where V : Item  //This is a constraint that requires type V to be an Item (or subtype)
{
  public void DoSomething()
  {
    List<V> myList = someMethod();

    foreach (V element in myList)
    {
      //This will now work because you've constrained the generic type V
      Guid test = element.IetmGuid;
    }
  }
} 
```

请注意，如果您需要支持多种项目（由项目的子类型表示），那么以这种方式使用泛型类才有意义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T15:19:01.363

Try declaring your list like this:

```
List<Item> myList = someMethod; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T15:10:34.657

```
foreach( object element in myList ) {
    Item itm = element as Item;
    if ( null == itm ) { continue; }
    Guid test = itm.ItemGuid;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T15:10:35.577

你的列表应该这样声明：

```
List<V> myList = someMethod; 
```

其中 V 是类型项。

然后你的迭代是正确的：

```
foreach(V element in myList)
{
    Guid test = element.IetmGuid;
} 
```

# javascript - 什么是正确的编码方法，然后在 ASP.NET Web 应用程序中检索业务规则静态错误（不是异常消息）消息？

> ID：284229
> 
> 赞同：1
> 
> 时间：2008-11-12T15:08:03.460
> 
> 标签：javascript, asp.net, messages, business-rules

在过去的 6 年里，我用几种不同的方式给这只猫换了皮。硬编码的字符串、带有 const 的静态类和资源文件。你使用什么方法，为什么？与客户端错误消息集成的奖励积分！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T15:57:40.600

我使用包含验证方法的业务对象层

```
public bool ValidateData(IList<string> errs) 
```

错误消息作为从程序常量模板格式化的字符串添加到集合中（显然，全球化不是问题），例如“{0} 不能为空，请为 {0} 输入一个值”，其中 {0} 是字段姓名

相同的业务层适用于 Web 和桌面应用程序

编辑：错误消息集合在错误消息标签中传递回 winform，或在错误消息标签中传递给 webform。（不需要javascript）

我还使用了一个变体，它采用 IDictionary，其中第一个字符串是字段名称，第二个字符串是错误消息，辅助函数找到绑定到命名字段的表单元素以突出显示

一般来说，我在大多数应用程序系统中使用大致相同的模式，具体取决于客户需求

# python - Tkinter 中的笔记本小部件

> ID：284234
> 
> 赞同：20
> 
> 时间：2008-11-12T15:10:26.857
> 
> 标签：python, wxpython, tabs, tkinter

在玩过 Tkinter 和 wxPython 之后，我更喜欢 Tkinter，因为我的源代码看起来很干净。但是，它似乎没有那么多功能。特别是它没有标签（如 Firefox 窗口顶部的标签）。

关于这个主题的一点谷歌搜索提供了一些建议。有[一个食谱条目](http://code.activestate.com/recipes/188537/)，其中包含一个允许您使用选项卡的类，但它非常原始。SourceForge 上还有[Python megawidgets](http://pmw.sourceforge.net/)，虽然这看起来很旧并且在安装过程中给了我错误。

有没有人有在 Tkinter 中制作选项卡式 GUI 的经验？你用了什么？或者仅仅是任何需要更强大的窗口组件的人都必须使用 wxPython 的情况？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-12T17:32:26.493

在最近的 Python (> 2.7) 版本中，您可以使用该[`ttk`](https://docs.python.org/2/library/ttk.html)模块，该模块提供对*Tk 主题小部件*集的访问，该小部件集已在`Tk 8.5`.

`ttk`以下是在 Python 2 中导入的方式：

```
import ttk

help(ttk.Notebook) 
```

在 Python 3 中，该[`ttk`](https://docs.python.org/3.4/library/tkinter.ttk.html?highlight=ttk#module-tkinter.ttk)模块作为[`tkinter`](https://docs.python.org/3.4/library/tkinter.html).

这是一个基于[`TkDocs`](http://www.tkdocs.com/tutorial/complex.html)网站示例的简单工作示例：

```
from tkinter import ttk
import tkinter as tk
from tkinter.scrolledtext import ScrolledText

def demo():
    root = tk.Tk()
    root.title("ttk.Notebook")

    nb = ttk.Notebook(root)

    # adding Frames as pages for the ttk.Notebook 
    # first page, which would get widgets gridded into it
    page1 = ttk.Frame(nb)

    # second page
    page2 = ttk.Frame(nb)
    text = ScrolledText(page2)
    text.pack(expand=1, fill="both")

    nb.add(page1, text='One')
    nb.add(page2, text='Two')

    nb.pack(expand=1, fill="both")

    root.mainloop()

if __name__ == "__main__":
    demo() 
```

另一种选择是使用库中的`NoteBook`小部件[`tkinter.tix`](https://docs.python.org/3/library/tkinter.tix.html)。要使用`tkinter.tix`，您必须`Tix`安装小部件，通常在安装`Tk`小部件的同时安装。要测试您的安装，请尝试以下操作：

```
from tkinter import tix
root = tix.Tk()
root.tk.eval('package require Tix') 
```

有关更多信息，请查看PSF 网站上的此[网页。](https://docs.python.org/3/library/tkinter.tix.html)

请注意，它`tix`已经很旧并且没有得到很好的支持，因此您最好的选择可能是使用`ttk.Notebook`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-09-20T17:02:01.213

如果有人还在寻找，我已经在 tkinter 中将它作为 Tab 工作。使用代码使其按您想要的方式运行（例如，您可以添加按钮以添加新选项卡）：

```
from tkinter import *

class Tabs(Frame):

    """Tabs for testgen output"""

    def __init__(self, parent):
        super(Tabs, self).__init__()
        self.parent = parent
        self.columnconfigure(10, weight=1)
        self.rowconfigure(3, weight=1)
        self.curtab = None
        self.tabs = {}
        self.addTab()                
        self.pack(fill=BOTH, expand=1, padx=5, pady=5)

    def addTab(self):
        tabslen = len(self.tabs)
        if tabslen < 10:
            tab = {}
            btn = Button(self, text="Tab "+str(tabslen), command=lambda: self.raiseTab(tabslen))
            btn.grid(row=0, column=tabslen, sticky=W+E)

            textbox = Text(self.parent)
            textbox.grid(row=1, column=0, columnspan=10, rowspan=2, sticky=W+E+N+S, in_=self)

            # Y axis scroll bar
            scrollby = Scrollbar(self, command=textbox.yview)
            scrollby.grid(row=7, column=5, rowspan=2, columnspan=1, sticky=N+S+E)
            textbox['yscrollcommand'] = scrollby.set

            tab['id']=tabslen
            tab['btn']=btn
            tab['txtbx']=textbox
            self.tabs[tabslen] = tab
            self.raiseTab(tabslen)

    def raiseTab(self, tabid):
        print(tabid)
        print("curtab"+str(self.curtab))
        if self.curtab!= None and self.curtab != tabid and len(self.tabs)>1:
                self.tabs[tabid]['txtbx'].lift(self)
                self.tabs[self.curtab]['txtbx'].lower(self)
        self.curtab = tabid

def main():
    root = Tk()
    root.geometry("600x450+300+300")
    t = Tabs(root)
    t.addTab()
    root.mainloop()

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-13T20:20:33.027

虽然目前它可能对您没有帮助，但 tk 8.5 附带了一组扩展的小部件。tk 8.4 通过称为“tile”的扩展可以使用此扩展集。扩展的小部件集中包括一个笔记本小部件。不幸的是，此时 Tkinter 默认使用一个相当旧的 Tk 版本，它没有附带这些小部件。

已经努力使 Tkinter 可以使用 tile。查看[http://tkinter.unpythonic.net/wiki/TileWrapper](http://tkinter.unpythonic.net/wiki/TileWrapper)。对于另一个类似的努力，请参阅[http://pypi.python.org/pypi/pyttk](http://pypi.python.org/pypi/pyttk)。此外，要了解这些小部件的外观（在 Ruby、Perl 和 Tcl 中），请参阅[http://www.tkdocs.com/](http://www.tkdocs.com/)。

Tk 8.5 是对股票 Tk 的*巨大*改进。它引入了几个新的小部件、本机小部件和主题引擎。希望有一天它会默认在 Tkinter 中可用。太糟糕了，Python 世界落后于其他语言。

*更新：最新版本的 Python 现在包括对开箱即用的主题小部件的支持。_*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T15:58:20.880

“或者仅仅是任何需要更强大的窗口组件的人都必须使用 wxPython 吗？”
简短的回答：是的。

长答案：您的 wxPython 代码可能需要一些练习才能感觉“干净”，但它比 Tkinter 更好、更强大。您还将获得更好的支持，因为现在有更多的人使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T22:34:39.160

pmw 有什么问题吗？它很旧，是的，但它是纯 python，所以它应该可以工作。

请注意，Tix 不适用于 py2exe，如果这对您来说是个问题。

# .net - 如何在多个应用程序之间共享配置设置

> ID：284240
> 
> 赞同：6
> 
> 时间：2008-11-12T15:11:22.330
> 
> 标签：.net, configuration-files

我有一个项目，其中有多个具有一些通用配置值的应用程序。我想要一个共享的 .config 文件，该文件可供所有使用 .Net 配置对象模型的应用程序使用。每个应用程序也会有自己的 app.config 文件

怎样才能做到最好。我宁愿尽可能避免使用注册表。在查看文档时，OpenExeConfiguration(string exePath) 方法似乎很有希望访问指定的配置文件。这是一个合理的方法吗？还有其他建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T16:33:15.100

app.config 中的某些部分允许引用外部文件。

```
<appSetting configSource="somefile.config"/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T15:16:12.477

我会把价值放在机器配置中。然后，您可以通过将其放在单个应用程序配置中来覆盖您需要的任何值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T15:15:54.710

[这是](https://stackoverflow.com/questions/239687/easiest-way-to-read-a-config-file-belonging-to-another-application#239715)一个讨论 OpenExeConfiguration 可能会有所帮助的讨论。

# c# - 在项目中复制 Web 表单页面的最佳方法？

> ID：284245
> 
> 赞同：1
> 
> 时间：2008-11-12T15:13:03.077
> 
> 标签：c#, asp.net, vb.net

因此，假设您想在 .Net 项目中制作 Web 表单页面的副本。

有没有比以下更简单的方法：

1.  复制源页面
2.  项目中的页面源页面以获取新页面
3.  排除源页面
4.  为新页面重命名类后面的代码
5.  添加源页面返回

有时我会错过一些明显的东西有没有更好的方法来做到这一点？我知道下一个问题是“为什么要在项目中复制代码而不是重用它？” 让我们说这是一个秘密；）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T15:27:32.830

我这样做：

1.  在解决方案资源管理器中选择原始 ASPX 文件
2.  Ctrl+C 后跟 Ctrl+V（快速复制粘贴）
3.  重命名新的 ASPX 文件（比如说 NewFile.aspx）
4.  将代码隐藏类名重命名为 NewFile
5.  `Inherits`将 HTML中指令的属性重命名为`Page`以“NewFile”结尾
6.  （可选）如果您将页面移动到不同的文件夹中，则需要更新 HTML`Page`指令以及代码隐藏中的命名空间引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T19:48:52.647

1.  通过“添加新项目”创建新页面
2.  复制原始标记（减去页面声明）并粘贴到新页面
3.  从原始代码隐藏中复制代码并粘贴到新的代码隐藏中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T15:36:01.487

您可以将该表单设置为用户控件，然后根据需要插入它吗？然后，您可以省去编辑您复制的每个实例的麻烦。

# javascript - Javascript 范围错误

> ID：284246
> 
> 赞同：1
> 
> 时间：2008-11-12T15:13:09.333
> 
> 标签：javascript, google-maps

我目前正在从事 Google Maps 项目并正在实施搜索功能。在我的搜索功能中，我试图在侧面列出刚刚添加到地图中的搜索器对应于每个大厅的内容。然而，在组装这个字符串时，我遇到了一个问题，`side_bar_html`如果我不先警告数据，我的变量将不会输出。

这是我的 searchMap 函数。变量声明如下：`var side_bar_html = "";`

```
function searchMap(term, map) {

closeSearch();  

searchCount = 0;
searchMarkers = [];

var request = GXmlHttp.create();

    request.open("GET", "admin/search.php?s=" + term, true);

    request.onreadystatechange = function() {

    if (request.readyState == 4) {

        var xmlDoc = GXml.parse(request.responseText);
        var points = xmlDoc.documentElement.getElementsByTagName("point");

        var polygonsToShow = [];
        for (var i = 0; i < points.length; i++) {                                   
            var lat = parseFloat(points[i].getAttribute("lat"));
            var lng = parseFloat(points[i].getAttribute("lng"));
            var pid = points[i].getAttribute("id");
            for(var j = 0; j < polygons.length; j++) {
                if(polygons[j].vt_bid == pid) {
                    polygonsToShow.push(j);
                }
            }
            var point = new GLatLng(lat,lng);           
            var pname = points[i].getAttribute("name");
            var curMarker = createSearchMarker(point, pid, pname,getLetter(i));                 
            map.addOverlay(curMarker);
        }
        //olays.buildings.checked = false; : Figure out some way to uncheck the buildings overlay checkbox?
        for(var k = 0; k < polygons.length; k++) {
            polygons[k].hide();
        }

        for(var l = 0; l < polygonsToShow.length; l++){ 
            polygons[polygonsToShow[l]].show();
        }
    }
}

request.send(null);
alert(side_bar_html); //side_bar_html will be empty unless I alert the variable

searchResults = new HtmlControl('<div style="background-color:white; border:solid 1px grey; padding:2ex; overflow:auto; width:125px; margin:1px;  font-size:14px;"><img align="right" style="cursor: pointer;" src="http://www.thebort.com/maps/images/close.gif" onclick="closeSearch()"><strong>Search</strong><br/>' + side_bar_html + '</div>', {selectable:true});
map.addControl(searchResults, new GControlPosition(G_ANCHOR_BOTTOM_RIGHT, new GSize(20, 70)));

} 
```

以及创建搜索标记的功能：

```
function createSearchMarker(point, id, pname, letIcon) {
    var marker = new GMarker(point,letIcon);
    GEvent.addListener(marker, "click", function() {         
        marker.openInfoWindowHtml('<a href="#" onclick=\'tb_show("' + pname + '","admin/get_info.php?b=' + id + '&KeepThis=true&TB_iframe=true&height=400&width=600",false); return false;\'>' + pname + '</a>');

     });

side_bar_html = side_bar_html + '<a href="javascript:clickSearch(' + searchCount + ')">' + String.fromCharCode("A".charCodeAt(0) + searchCount) + ': ' + pname + '</a><br>';
marker.vt_id = id;
    searchMarkers.push(marker);
searchCount++;

    return marker;
 } 
```

我现在想将这个项目的代码暴露在最低限度，所以如果有什么需要解释的，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T15:19:27.337

所以我对你的问题的理解`side_bar_html`是在`onreadystatechange`函数调用期间设置的，但是除非你提醒它，否则你看不到它被设置。

以下是可能发生的情况：Ajax 请求需要一些时间才能发生。当您调用`req.send(null)`then 时，会启动请求，但您的`onreadystatechange`函数要等到稍后的某个时间，在您的 Web 浏览器发出请求并得到响应之后才会被调用。

因此，当您立即尝试使用该`side_bar_html`值时，它不起作用，因为响应尚未返回。但是，当您提醒该值时，执行提醒所花费的时间使浏览器有时间获得响应并`side_bar_html`适当地设置该值。

您的根本问题是 Ajax 是异步的（A 来自那里）并且您尝试同步使用它（这意味着您假设事情总是以特定的顺序发生）。最好的办法是把使用的代码`side_bar_html`放在你的`onreadystatechange`函数中，这样它在设置之前就不会被使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T15:26:00.197

将下面的代码添加到 onreadystatechange 函数的末尾（在 if 语句中检查值 4）。例如：

```
request.onreadystatechange = function() {

if (request.readyState == 4) {

    var xmlDoc = GXml.parse(request.responseText);
            var points = xmlDoc.documentElement.getElementsByTagName("point");

            var polygonsToShow = [];
            for (var i = 0; i < points.length; i++) {                                                       
                    var lat = parseFloat(points[i].getAttribute("lat"));
                    var lng = parseFloat(points[i].getAttribute("lng"));
                    var pid = points[i].getAttribute("id");
                    for(var j = 0; j < polygons.length; j++) {
                            if(polygons[j].vt_bid == pid) {
                                    polygonsToShow.push(j);
                            }
                    }
                    var point = new GLatLng(lat,lng);                       
                    var pname = points[i].getAttribute("name");
                    var curMarker = createSearchMarker(point, pid, pname,getLetter(i));                             
                    map.addOverlay(curMarker);
            }
            //olays.buildings.checked = false; : Figure out some way to uncheck the buildings overlay checkbox?
            for(var k = 0; k < polygons.length; k++) {
                    polygons[k].hide();
            }

            for(var l = 0; l < polygonsToShow.length; l++){ 
                    polygons[polygonsToShow[l]].show();
            }

            searchResults = new HtmlControl('<div style="background-color:white; border:solid 1px grey; padding:2ex; overflow:auto; width:125px; margin:1px;  font-size:14px;"><img align="right" style="cursor: pointer;" src="http://www.thebort.com/maps/images/close.gif" onclick="closeSearch()"><strong>Search</strong><br/>' + side_bar_html + '</div>', {selectable:true});
            map.addControl(searchResults, new GControlPosition(G_ANCHOR_BOTTOM_RIGHT, new GSize(20, 70)));
} 
```

# css - 修复 CSS 问题以使用 IE 7 的最佳方法

> ID：284247
> 
> 赞同：4
> 
> 时间：2008-11-12T15:13:15.650
> 
> 标签：css, internet-explorer-6, internet-explorer-7, cross-browser, standards

最近，我开始维护一个 web 应用程序，不幸的是它只适用于 IE 6。大多数问题都与 CSS 有关。

是否有任何工具可以帮助我标准化 CSS 类以**同时使用** **IE 6 和 IE 7**？我知道我必须通过标准，但我需要快速开始。

Firebug 可以在一定程度上帮助我识别与 UI 元素相关的 CSS 类（如果页面在 firefox 上呈现）。但是，我一直在寻找更像顾问工具的东西。如果您有一些经验可以分享，请随意。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T20:23:52.707

试用[SuperPreview](http://www.webdesignerdepot.com/2009/03/microsoft-announces-superpreview-for-ie-browser-testing/)或[整个软件包](http://www.istartedsomething.com/20090318/expression-web-superpreview-cross-browser-testing/)（Expression Web 在 Mix 上宣布）..

SuperPreview 是来自 Microsoft 的新免费独立应用程序（仍处于测试阶段），它使您能够查看您的网站在不同版本的 Internet Explorer 中的外观，从而比以前更容易从 IE6 迁移到 7 和 8，而无需启动虚拟机器运行IE6，或者有一台单独的计算机专门运行IE6。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T15:15:18.907

查看[Dean Edwards 的 IE7](http://dean.edwards.name/IE7/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-12T15:53:26.800

Tredosoft 的[多个 IE](http://tredosoft.com/Multiple_IE)是一个很好的比较/对比。你继续升级到 IE7，然后安装它（只选择 IE6 选项，除非你需要所有 5.5/5.0/4.0/等），你可以在两个浏览器中同时看到页面。这将帮助您找出必须条件化/破解的内容。

此外，[IE Developer Toolbar](http://www.microsoft.com/downloads/details.aspx?familyid=E59C3964-672D-4511-BB3E-2D5E1DB91038&displaylang=en)虽然不如 Firebug 等。al.，至少会让你在 IE 中看到浏览器认为你的样式正在发生什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-24T12:00:09.427

有时您需要为 IE6 和 IE7 引入一些技巧，例如删除双边距，我使用以下纯 CSS 代码

```
css-selector { code for all browsers }

*html css-selector {code for IE6 browser }

*+html css-selector {code for IE7 browser } 
```

它不是您期望的工具，但可能会有所帮助

# windows - How do I set the version information for an existing .exe, .dll?

> ID：284258
> 
> 赞同：129
> 
> 时间：2008-11-12T15:16:35.503
> 
> 标签：windows, dll, versioning, exe, fileversioninfo

As part of our build process I need to set the version information for all of our compiled binaries. Some of the binaries already have version information (added at compile time) and some do not.

I want to be able to apply the following information:

*   Company Name
*   Copyright Notice
*   Product Name
*   Product Description
*   File Version
*   Product Version

All of these attributes are specified by the build script and must be applied after compilation. These are standard binaries (not assemblies) compiled with C++ Builder 2007.

How can I do this?

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2014-07-15T19:38:37.597

虽然它不是一个批处理过程，但 Visual Studio 还可以添加/编辑文件资源。

只需在 .EXE 或 .DLL 上使用 File->Open->File。这对于在构建后修复版本信息或将其添加到没有这些资源的文件中非常方便。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2013-09-17T00:37:43.107

与许多其他答案不同，此解决方案使用完全免费的软件。

首先，创建一个文件，`Resources.rc`如下所示：

```
VS_VERSION_INFO VERSIONINFO
    FILEVERSION    1,0,0,0
    PRODUCTVERSION 1,0,0,0
{
    BLOCK "StringFileInfo"
    {
        BLOCK "040904b0"
        {
            VALUE "CompanyName",        "ACME Inc.\0"
            VALUE "FileDescription",    "MyProg\0"
            VALUE "FileVersion",        "1.0.0.0\0"
            VALUE "LegalCopyright",     "© 2013 ACME Inc. All Rights Reserved\0"
            VALUE "OriginalFilename",   "MyProg.exe\0"
            VALUE "ProductName",        "My Program\0"
            VALUE "ProductVersion",     "1.0.0.0\0"
        }
    }
    BLOCK "VarFileInfo"
    {
        VALUE "Translation", 0x409, 1200
    }
} 
```

接下来，使用[GoRC](http://www.godevtool.com/)将其编译为`.res`文件：

```
GoRC /fo Resources.res Resources.rc 
```

^(（请参阅下面我的评论以获取镜像`GoRC.exe`）)

然后在 CLI 模式下使用[Resource Hacker](http://www.angusj.com/resourcehacker/)将其添加到现有的`.exe`：

```
ResHacker -add MyProg.exe, MyProg.exe, Resources.res,,, 
```

而已！

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-04-30T18:12:27.983

或者您可以查看 Win32 exe/dll 文件的免费软件[StampVer](http://blog.dixo.net/downloads/stampver/)。
它只会更改文件和产品版本，但如果它们已经有版本资源。如果版本资源不存在，则无法添加版本资源。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2016-02-03T22:26:01.590

**rcedit**是相对较新的，并且在命令行中运行良好：[https ://github.com/atom/rcedit](https://github.com/atom/rcedit)

```
$ rcedit "path-to-exe-or-dll" --set-version-string "Comments" "This is an exe"
$ rcedit "path-to-exe-or-dll" --set-file-version "10.7"
$ rcedit "path-to-exe-or-dll" --set-product-version "10.7" 
```

还有一个[NPM 模块](https://github.com/atom/node-rcedit)，它从 JavaScript 和一个[Grunt 任务](https://www.npmjs.com/package/grunt-rcedit)包装它，以防你使用 Grunt。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2010-01-21T18:12:56.867

这样的事情呢？

```
verpatch /va foodll.dll %VERSION% %FILEDESCR% %COMPINFO% %PRODINFO% %BUILDINFO% 
```

可[在此处获取完整资源](http://www.codeproject.com/KB/install/VerPatch.aspx?msg=3207401)。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2019-01-28T19:37:41.627

许多很棒的答案都提到了多种工具，我将选择一个。

# *资源黑客*

[我从[AngusJ]: Resource Hacker](http://www.angusj.com/resourcehacker)下载了最新版本 ( *5.1.7* ) 。所有需要的信息都可以在该页面上找到（命令行选项、脚本……）。在下面的演练中，我将在 2 个可执行文件（实验室老鼠）上进行操作（出于显而易见的原因），我已将其复制到我的*cwd 中*：

 **   *ResourceHacker.exe*：我认为对自己进行操作会很有趣
*   *cmake.exe ：没有设置**版本信息*的随机可执行文件（我机器上*v3.6.3*安装的一部分）

在继续之前，我想提一下***ResourceHacker*有一个有趣的终端输出**，下面的复制/粘贴片段可能会产生一些混乱。

## 1\. 设置

这更像是一个初步步骤，熟悉环境，表明没有时髦的生意在进行，......

> ```
> e:\Work\Dev\StackOverflow\q000284258> sopr.bat
> *** Set shorter prompt to better fit when pasted in StackOverflow (or other) pages ***
> 
> [prompt]> dir
>  Volume in drive E is Work
>  Volume Serial Number is 3655-6FED
> 
>  Directory of e:\Work\Dev\StackOverflow\q000284258
> 
> 2019-01-28  20:09    <DIR>          .
> 2019-01-28  20:09    <DIR>          ..
> 2016-11-03  09:17         5,413,376 cmake.exe
> 2019-01-03  02:06         5,479,424 ResourceHacker.exe
> 2019-01-28  20:30               496 ResourceHacker.ini
>                3 File(s)     10,893,296 bytes
>                2 Dir(s)  103,723,261,952 bytes free
> 
> [prompt]> set PATH=%PATH%;c:\Install\x64\CMake\CMake\3.6.3\bin
> 
> [prompt]> .\cmake --help >nul 2>&1
> 
> [prompt]> echo %errorlevel%
> 0
> 
> [prompt]> .\ResourceHacker.exe -help
> 
> [prompt]>
> 
> ==================================
> Resource Hacker Command Line Help:
> ==================================
> 
> -help             : displays these abbreviated help instructions.
> -help commandline : displays help for single commandline instructions
> -help script      : displays help for script file instructions.
> 
> [prompt]> echo %errorlevel%
> 0 
> ```

正如所见，可执行文件没问题，它们运行良好，它们的*详细信息*（我们关心的）如下所示：

[![Img0-初始](https://i.stack.imgur.com/pte7a.jpg)](https://i.stack.imgur.com/pte7a.jpg)

## 2\. 资源

资源文件是包含资源的文本文件。资源（简化）具有：

*   姓名
*   类型
*   价值

有关更多详细信息，请查看[[MS.Docs]：关于资源文件](https://docs.microsoft.com/en-us/windows/desktop/menurc/about-resource-files)。有许多工具（在现有答案中提到）可以促进资源文件编辑，例如：

*   *VStudio*在启动新项目时会创建一个默认的
*   可以手动创建这样的文件
*   但是，因为它是关于*Resource Hacker*的，并且：

    *   它能够从现有的可执行文件中提取资源
    *   它嵌入了资源（如上图所示）

    我将在此步骤中使用它 ( `-action extract`)

接下来，为了将资源嵌入到*.exe*（*.dll*，...）中，必须将其*编译*为适合*PE*格式的二进制形式。同样，有很多工具可以实现这一点，但正如您可能猜到的那样，我将坚持使用*Resource Hacker* ( `-action compile`)。

> ```
> [prompt]> :: Extract the resources into a file
> [prompt]> .\ResourceHacker.exe -open .\ResourceHacker.exe -save .\sample.rc -action extract -mask VersionInfo,, -log con
> 
> [prompt]>
> 
> [28 Jan 2019, 20:58:03]
> 
> Current Directory:
> e:\Work\Dev\StackOverflow\q000284258
> 
> Commandline:
> .\ResourceHacker.exe  -open .\ResourceHacker.exe -save .\sample.rc -action extract -mask VersionInfo,, -log con
> 
> Open    : e:\Work\Dev\StackOverflow\q000284258\ResourceHacker.exe
> Save    : e:\Work\Dev\StackOverflow\q000284258\sample.rc
> 
> Success!
> 
> [prompt]> :: Modify the resource file and set our own values
> [prompt]>
> [prompt]> :: Compile the resource file
> [prompt]> .\ResourceHacker.exe -open .\sample.rc -save .\sample.res -action compile -log con
> 
> [prompt]>
> 
> [28 Jan 2019, 20:59:51]
> 
> Current Directory:
> e:\Work\Dev\StackOverflow\q000284258
> 
> Commandline:
> .\ResourceHacker.exe  -open .\sample.rc -save .\sample.res -action compile -log con
> 
> Open    : e:\Work\Dev\StackOverflow\q000284258\sample.rc
> Save    : e:\Work\Dev\StackOverflow\q000284258\sample.res
> 
> Compiling: e:\Work\Dev\StackOverflow\q000284258\sample.rc
> Success!
> 
> [prompt]> dir /b
> cmake.exe
> ResourceHacker.exe
> ResourceHacker.ini
> sample.rc
> sample.res 
> ```

在您的情况下，不需要保存和编辑资源文件，因为该文件已经存在，我只是为了演示目的。下面是修改后的资源文件（因此在编译之前）。

*样本.rc*：

```
1 VERSIONINFO
FILEVERSION 3,1,4,1592
PRODUCTVERSION 2,7,1,8
FILEOS 0x4
FILETYPE 0x1
{
BLOCK "StringFileInfo"
{
    BLOCK "040904E4"
    {
        VALUE "CompanyName", "Cristi Fati\0"
        VALUE "FileDescription", "20190128 - SO q000284258 demo\0"
        VALUE "FileVersion", "3.1.4.1592\0"
        VALUE "ProductName", "Colonel Panic\0"
        VALUE "InternalName", "100\0"
        VALUE "LegalCopyright", "(c) Cristi Fati 1999-2999\0"
        VALUE "OriginalFilename", "ResHack\0"
        VALUE "ProductVersion", "2.7.1.8\0"
    }
}

BLOCK "VarFileInfo"
{
    VALUE "Translation", 0x0409 0x04E4  
}
} 
```

## 3.嵌入

这也将由*Resource Hacker* ( `-action addoverwrite`) 执行。由于*.exe*已被复制，我将就地编辑它们的资源。

> ```
> [prompt]> .\ResourceHacker.exe -open .\cmake.exe -save .\cmake.exe -res .\sample.res -action addoverwrite -mask VersionInfo,, -log con
> 
> [prompt]>
> 
> [28 Jan 2019, 21:17:19]
> 
> Current Directory:
> e:\Work\Dev\StackOverflow\q000284258
> 
> Commandline:
> .\ResourceHacker.exe  -open .\cmake.exe -save .\cmake.exe -res .\sample.res -action addoverwrite -mask VersionInfo,, -log con
> 
> Open    : e:\Work\Dev\StackOverflow\q000284258\cmake.exe
> Save    : e:\Work\Dev\StackOverflow\q000284258\cmake.exe
> Resource: e:\Work\Dev\StackOverflow\q000284258\sample.res
> 
>   Added: VERSIONINFO,1,1033
> 
> Success!
> 
> [prompt]> copy ResourceHacker.exe ResourceHackerTemp.exe
>         1 file(s) copied.
> 
> [prompt]> .\ResourceHackerTemp.exe -open .\ResourceHacker.exe -save .\ResourceHacker.exe -res .\sample.res -action addoverwrite -mask VersionInfo,, -log con
> 
> [prompt]>
> 
> [28 Jan 2019, 21:19:29]
> 
> Current Directory:
> e:\Work\Dev\StackOverflow\q000284258
> 
> Commandline:
> .\ResourceHackerTemp.exe  -open .\ResourceHacker.exe -save .\ResourceHacker.exe -res .\sample.res -action addoverwrite -mask VersionInfo,, -log con
> 
> Open    : e:\Work\Dev\StackOverflow\q000284258\ResourceHacker.exe
> Save    : e:\Work\Dev\StackOverflow\q000284258\ResourceHacker.exe
> Resource: e:\Work\Dev\StackOverflow\q000284258\sample.res
> 
>   Modified: VERSIONINFO,1,1033
> 
> Success!
> 
> [prompt]> del /f /q ResourceHackerTemp.*
> 
> [prompt]> dir
>  Volume in drive E is Work
>  Volume Serial Number is 3655-6FED
> 
>  Directory of e:\Work\Dev\StackOverflow\q000284258
> 
> 2019-01-28  21:20    <DIR>          .
> 2019-01-28  21:20    <DIR>          ..
> 2016-11-03  09:17         5,414,400 cmake.exe
> 2019-01-03  02:06         5,479,424 ResourceHacker.exe
> 2019-01-28  21:17               551 ResourceHacker.ini
> 2019-01-28  20:05             1,156 sample.rc
> 2019-01-28  20:59               792 sample.res
>                5 File(s)     10,896,323 bytes
>                2 Dir(s)  103,723,253,760 bytes free 
> ```

正如所见，我不得不小把戏（*gainarie*），因为我不能（至少我认为我不能）在使用时修改*.exe 。*

## 4\. 测试

这是一个可选阶段，以确保：

*   可执行文件仍然有效（他们在这个过程中没有搞砸）
*   资源已添加/更新

> ```
> [prompt]> .\cmake --help >nul 2>&1
> 
> [prompt]> echo %errorlevel%
> 0
> 
> [prompt]> .\ResourceHacker.exe -help
> 
> [prompt]>
> 
> ==================================
> Resource Hacker Command Line Help:
> ==================================
> 
> -help             : displays these abbreviated help instructions.
> -help commandline : displays help for single commandline instructions
> -help script      : displays help for script file instructions.
> 
> [prompt]> echo %errorlevel%
> 0 
> ```

以及他们的*详细信息*：

[![Img1-最终](https://i.stack.imgur.com/XbU4w.jpg)](https://i.stack.imgur.com/XbU4w.jpg)

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2008-11-12T15:47:12.447

有这个工具[ChangeVersion](http://www.the-software-box.com/changeversion.aspx) ^([1])

功能列表（来自网站）：

> *   命令行界面
> *   支持 .EXE、.DLL 和 .RES 文件
> *   根据版本掩码更新 FileVersion 和 ProductVersion
> *   添加/更改/删除版本密钥字符串
> *   调整文件标志（调试、特殊、私有等）
> *   更新项目文件 ( .bdsproj | .bpr | .bpk | .dproj )
> *   添加/更改主应用程序图标
> *   使用带有配置的ini文件
> *   Windows Vista 支持（需要提升）
> *   易于集成到持续构建环境中

完全披露：我认识写这个工具的人，我曾经和他一起工作过。但这也意味着我知道他制作了高质量的软件；）

* * *

^([1])链接已失效。[download.cnet.com](http://download.cnet.com/ChangeVersion/3000-2383_4-75765045.html)上似乎有镜像版本。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2016-02-16T10:06:00.233

我正在做它没有额外的工具。我刚刚将以下文件添加到我的 Win32 应用程序项目中。

一个头文件，它定义了一些我们可以在资源文件甚至程序代码上重用的常量。我们只需要维护一个文件。感谢 Qt 团队向我展示了如何在 Qt 项目中执行此操作，它现在也适用于我的 Win32 应用程序。

----[版本.h]----

```
#ifndef VERSION_H
#define VERSION_H

#define VER_FILEVERSION             0,3,0,0
#define VER_FILEVERSION_STR         "0.3.0.0\0"

#define VER_PRODUCTVERSION          0,3,0,0
#define VER_PRODUCTVERSION_STR      "0.3.0.0\0"

#define VER_COMPANYNAME_STR         "IPanera"
#define VER_FILEDESCRIPTION_STR     "Localiza archivos duplicados"
#define VER_INTERNALNAME_STR        "MyProject"
#define VER_LEGALCOPYRIGHT_STR      "Copyright 2016 ipanera@gmail.com"
#define VER_LEGALTRADEMARKS1_STR    "All Rights Reserved"
#define VER_LEGALTRADEMARKS2_STR    VER_LEGALTRADEMARKS1_STR
#define VER_ORIGINALFILENAME_STR    "MyProject.exe"
#define VER_PRODUCTNAME_STR         "My project"

#define VER_COMPANYDOMAIN_STR       "www.myurl.com"

#endif // VERSION_H 
```

----[MyProjectVersion.rc]----

```
#include <windows.h>
#include "version.h"

VS_VERSION_INFO VERSIONINFO
FILEVERSION     VER_FILEVERSION
PRODUCTVERSION  VER_PRODUCTVERSION
BEGIN
    BLOCK "StringFileInfo"
    BEGIN
        BLOCK "040904E4"
        BEGIN
            VALUE "CompanyName",        VER_COMPANYNAME_STR
            VALUE "FileDescription",    VER_FILEDESCRIPTION_STR
            VALUE "FileVersion",        VER_FILEVERSION_STR
            VALUE "InternalName",       VER_INTERNALNAME_STR
            VALUE "LegalCopyright",     VER_LEGALCOPYRIGHT_STR
            VALUE "LegalTrademarks1",   VER_LEGALTRADEMARKS1_STR
            VALUE "LegalTrademarks2",   VER_LEGALTRADEMARKS2_STR
            VALUE "OriginalFilename",   VER_ORIGINALFILENAME_STR
            VALUE "ProductName",        VER_PRODUCTNAME_STR
            VALUE "ProductVersion",     VER_PRODUCTVERSION_STR
        END
    END

    BLOCK "VarFileInfo"
    BEGIN
        VALUE "Translation", 0x409, 1252
    END
END 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2011-01-19T12:44:46.837

verpatch 很好，但不处理 unicode 字符...
试试[ResourceLib](https://github.com/dblock/resourcelib)

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2019-11-05T17:58:16.680

@DannyBeckett的[上述](https://stackoverflow.com/a/18839527/12327655)回答对我帮助很大，

我将以下内容放入批处理文件中，并将其放在 ResourceHacker.exe 和我工作的 EXE 所在的同一文件夹中，并且效果很好。[您可以编辑它以满足您的需要]

```
 @echo off
    :start1
    set /p newVersion=Enter version number [?.?.?.?]:
    if "%newVersion%" == "" goto start1
    :start2
    set /p file=Enter EXE name [for 'program.exe' enter 'program']:
    if "%file%" == "" goto start2
    for /f "tokens=1-4 delims=." %%a in ('echo %newVersion%') do (set ResVersion=%%a,%%b,%%c,%%d)
    (
    echo:VS_VERSION_INFO VERSIONINFO
    echo:    FILEVERSION    %ResVersion%
    echo:    PRODUCTVERSION %ResVersion%
    echo:{
    echo:    BLOCK "StringFileInfo"
    echo:    {
    echo:        BLOCK "040904b0"
    echo:        {
    echo:            VALUE "CompanyName",        "MyCompany\0"
    echo:            VALUE "FileDescription",    "TestFile\0"
    echo:            VALUE "FileVersion",        "%newVersion%\0"
    echo:            VALUE "LegalCopyright",     "COPYRIGHT © 2019 MyCompany\0"
    echo:            VALUE "OriginalFilename",   "%file%.exe\0"
    echo:            VALUE "ProductName",        "Test\0"
    echo:            VALUE "ProductVersion",     "%newVersion%\0"
    echo:        }
    echo:    }
    echo:    BLOCK "VarFileInfo"
    echo:    {
    echo:        VALUE "Translation", 0x409, 1200
    echo:    }
    echo:}
    ) >Resources.rc     &&      echo setting Resources.rc
    ResourceHacker.exe -open resources.rc -save resources.res -action compile -log CONSOLE
    ResourceHacker -open "%file%.exe" -save "%file%Res.exe" -action addoverwrite -resource "resources.res"  -log CONSOLE
    ResourceHacker.exe -open "%file%Res.exe" -save "%file%Ico.exe" -action addskip -res "%file%.ico" -mask ICONGROUP,MAINICON, -log CONSOLE
    xCopy /y /f "%file%Ico.exe" "%file%.exe"
    echo.
    echo.
    echo your compiled file %file%.exe is ready
    pause 
```

[作为旁注，我还使用资源黑客来编译 res 文件，而不是 GoRC]

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2015-09-17T18:03:52.433

聚会有点晚了，但由于我一直在寻找它（有时我可能需要再次找到它），所以我在 VS2013 Express 下的 C++ DLL 中包含版本、公司名称等：

1.  如前所述，创建并编辑了一个 dllproj.rc 文件。
2.  在 DLL 项目中添加了“rc.exe dllproj.rc”行作为预构建步骤。
3.  将 dllproj.res 添加到项目的资源文件夹中。

希望这可以帮助！

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-07-10T00:17:15.550

Heaventools Software有**[Resource Tuner Console](http://www.heaventools.com/command-line_resource_editor.htm)**。

> Resource Tuner Console 是一个命令行工具，使开发人员能够自动编辑大量 Windows 32 位和 64 位可执行文件中的不同资源类型。

具体参见[更改版本变量和更新版本信息](http://www.heaventools.com/rtconsole-sample-script-update-version-info.htm "编辑版本信息")页面以获取更多详细信息。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2019-01-28T06:14:01.753

您实际上可以尝试从[下载链接下载](https://www.carifred.com/fvie/)**FVIE**并尝试编辑任何 .exe 文件的信息。

*（或者）*

您可以从[下载链接下载](http://blog.dixo.net/downloads/stampver/)**StampVer – Win32 版本资源标记** ，这对于 windows .exe 文件非常有用。

*（或者）*

您可以使用名为**RCEDIT**的命令工具。从[Github 源链接](https://github.com/electron/rcedit)下载，然后使用 Visual Studio 2015 构建，然后您有特定的命令来更改 .exe 文件的版本。有关各种可用命令，请参阅[文档链接](https://github.com/electron/rcedit#docs)。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-05-21T15:19:48.077

这是我见过的最好的工作工具，可以完全控制所有文件资源，包括 VersionInfo。

请参阅：[Anders Melander](https://stackoverflow.com/users/2249664/speedfreak)的[ResourceEditor](http://melander.dk/reseditor/)。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-03-19T03:58:24.757

我想组合一个更紧凑的版本

*   第一步：创建资源
*   第 2 步：下载 ResourceHacker
*   第三步：将res编译成rc文件
*   第四步：运行脚本：修改exe

### 第 1 步：创建`resource`

准备资源文件：`resource.rc`

```
VS_VERSION_INFO VERSIONINFO
    FILEVERSION    0,0,0,0
    PRODUCTVERSION 0,0,0,0
{
    BLOCK "StringFileInfo"
    {
        BLOCK "040904b0"
        {
            VALUE "CompanyName",        "\0"
            VALUE "FileDescription",    "\0"
            VALUE "FileVersion",        "0.0.0.0\0"
            VALUE "LegalCopyright",     "© 2020 Carson. All rights reserved.\0"
            VALUE "OriginalFilename",   ".exe\0"
            VALUE "ProductName",        "\0"
            VALUE "ProductVersion",     "0.0.0.0\0"
        }
    }
    BLOCK "VarFileInfo"
    {
        VALUE "Translation", 0x0409, 1200
    }
} 
```

*   [VSVersionInfo 文件](http://msdn.microsoft.com/en-us/library/ms646997.aspx)
*   [VarFileInfo：查询 langID 和 charsetID](https://docs.microsoft.com/en-us/windows/win32/menurc/varfileinfo-block)

### 第 2 步：下载 ResourceHacker

有两种方法可以得到它。

1.  从[Chocolatey](https://chocolatey.org/)下载：
    *   [安装巧克力](https://chocolatey.org/install)
    *   `choco install reshack -y`
    *   安装后，您可能需要添加环境变量。
2.  [资源黑客网站](http://www.angusj.com/resourcehacker/)

### 第三步：编译`res`成`rc`文件

```
ResourceHacker.exe -open resources.rc -save resources.res ^
 -action compile -log CONSOLE 
```

### 第四步：运行脚本：修改exe

```
SET INPUT_EXE=app.exe
SET OUTPUT_EXE=app.exe
ResourceHacker.exe -open %OUTPUT_EXE% -save %OUTPUT_EXE% ^
 -resource resources.res ^
 -action addoverwrite ^
 -mask VersionInf ^
 -log CONSOLE 
```

### 摘要脚本

```
SET INPUT_EXE=app.exe
SET OUTPUT_EXE=app.exe

ResourceHacker.exe -open resources.rc -save resources.res ^
 -action compile -log CONSOLE

ResourceHacker.exe -open %OUTPUT_EXE% -save %OUTPUT_EXE% ^
 -resource resources.res ^
 -action addoverwrite ^
 -mask VersionInf ^
 -log CONSOLE 
```

### 参考

*   [⭐resourcehacker Command Line Syntax](http://www.angusj.com/resourcehacker/) open and search:（`Command Line Syntax`
    强烈*推荐你看看*）
*   [通过 Windows 批处理文件将长命令拆分为多行](https://stackoverflow.com/a/69079)：`^`

# coding-style - 强制编码风格

> ID：284259
> 
> 赞同：25
> 
> 时间：2008-11-12T15:16:57.077
> 
> 标签：coding-style

几年前，当我开始一个小型开发项目时，我和其他开发人员坐下来就折衷的大括号和缩进样式达成了一致。它不是任何人的最爱，但它是没有人真正讨厌的东西。我为该样式编写了一个 .indentrc 配置文件，并有一个签入触发器，该触发器将在签入每个文件时对每个文件运行缩进。这使得您编写代码的样式无关紧要，在其他人看到它之前，它最终会成为团体标准。这具有一致性的优点。但在此之前或之后，我从未见过其他人这样做过。

那你们其他人怎么说？好主意，还是可憎？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-12T15:20:11.690

我会说好主意。我会更进一步，让每个人都在他们的 IDE 中使用配置文件，以便他们默认以约定的样式编写。如果他们将不得不以中性风格查看其他所有人的代码，他们还不如习惯它。即使是他们自己的代码在一个签入签出周期后也应该是中性风格，那么为什么要以自己的个人风格开发新代码呢？

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-12T15:36:18.257

采用中性的编码风格绝对是个好主意。但是，仅在签入源时强制执行编码样式可能是也可能不是一个好主意（另请参阅下面[的 Bill](https://stackoverflow.com/questions/284259/enforcing-a-coding-style/284270#284270)和[Elie](https://stackoverflow.com/questions/284259/enforcing-a-coding-style/284268#284268)的答案）。

**使用签入挂钩：**

**优点：**允许编码人员随心所欲地编写代码，因此他们不必考虑标准或更改编写代码的方式。这最大限度地减少了对策略的抵抗，并且不会在编写代码时对他们的生产力产生负面影响。

**缺点：**您的编码人员可能对中性样式只有一丁点的了解，因此您无法从使用“相同”样式的每个人中获得全部好处。如果您的程序员必须在结对编程设置中一起工作，他们仍然会在屏幕上受到彼此的编程风格的影响，这将不同于他们自己的风格或中性风格。

**更进一步，在开发过程中使用中性风格：**

**优点：**鼓励中性风格流利，每个人都可以在签入前后随时阅读其他人的代码。

**缺点：**这样做会遇到来自开发人员的更多阻力。根据您的文化，这可能比它的价值更麻烦。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-12T15:26:48.493

如果您将其限制为强制大括号和缩进的样式，那么我认为这是一个好主意。但是，如果您要尝试强制执行每一个格式标准，那么它可能不会。在我看来，有时打破标准是有意义的。例如，我更喜欢

```
int x = y * z; 
```

到

```
int x = y*z; 
```

因为它更容易阅读。但是，我非常喜欢

```
int a = b*c + d*e; 
```

到

```
int a = b * c + d * e; 
```

因为间距代表操作的顺序。

所以你强制缩进和大括号的政策听起来真的很好。但是，如果有人试图盲目地强制执行其他间距规则，我认为它不会奏效。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-12T15:19:58.367

这听起来像一个好主意。只要您最终得到的样式不是完全陌生的东西，这是确保您的开发人员使用该样式的好方法。它还有一个额外的好处，那就是他们不必以这种方式编码——当他们签入他们的更改时，它将为他们重新格式化。如果有一个可以插入 CVS（通用术语）的工具，那就太好了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-12T15:28:22.467

我们将 TFS 与运行一组 Stylecop 规则的签入策略一起使用。如果您的代码未通过，则无法将其签入。确实很好用。除了始终如一的风格和良好的注释之外，它似乎还提高了代码的总体质量——也许是因为开发人员被迫描述每个方法、事件等，他们被迫在检查之前更多地考虑代码在。

只是一个 MS 解决方案，但如果它可供您使用，则值得。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-17T21:32:06.240

使用自动代码格式化程序的最大问题是代码格式化程序无法处理所有情况。

例如，如果您的代码中有大量 SQL，您可能会自动格式化 SQL。但是，如果您的 SQL 超过一行（一行到底有多长？），那么您必须对其进行格式化。到目前为止，我还没有看到一个可以正确处理这个问题的好的格式化程序。

例子：

```
String sql = "SELECT * FROM USERS WHERE ID = ? AND NAME = ? AND IS_DELETED = 'N'"; 
```

对比

```
String sql = 
  "SELECT * " +
  "FROM USERS " + 
  "WHERE ID = ? " + 
  "  AND NAME = ? " +
  "  AND IS_DELETED = 'N'"; 
```

当您有很长的查询时，第二种格式更具可读性。大多数格式化程序会将其反格式化为一长行，直到行长。

然而，如果你所做的只是转身

```
if(x=1) print("blah"); else print("eep!"); 
```

进入

```
if (x = 1) {
  print("blah");
} else {
  print("eep!");
} 
```

那么格式化程序就可以了。我们在工作中做类似的事情；它不是由 CVS 工具强制执行的，而是由 IDE 强制执行的。工作得相当好。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-07-12T04:51:31.203

有一个名为[EditorConfig](http://editorconfig.org)的项目可以在一定程度上解决这个问题。但是，它目前仅解决缩进问题。

EditorConfig 包含[许多不同编辑器](http://editorconfig.org#download)的插件和文件格式标准。通过在项目的根目录中创建一个`.editorconfig`文件并安装相应的插件，编辑器将在您键入代码时格式化您的代码。

这是一种通用方式（与**indentrc**不同，不限于 C/C++），但您仍然可以查看此解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-08T09:10:07.513

我相信你现在已经决定了你的开发环境。如果您使用 Eclipse，您可以在 Java 编辑器上启用 Format Source 保存操作，该操作会在每次保存时重新格式化。这样做的主要好处是源机会在完成时在源存储库中标记，而不是在以后重新格式化源时。

让它成为一个自动步骤。以后你会感激的。

# c# - 如何从 xmlReader 的当前节点创建 xmlElement？

> ID：284269
> 
> 赞同：13
> 
> 时间：2008-11-12T15:20:01.847
> 
> 标签：c#, .net, xml

如果我有一个 xmlreader 实例，我如何使用它来读取其当前节点并最终得到一个 xmlElement 实例？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-12T16:01:30.390

未经测试，但如何通过`XmlDocument`：

```
 XmlDocument doc = new XmlDocument();
    doc.Load(reader);
    XmlElement el = doc.DocumentElement; 
```

或者（从一开始），类似：

```
 doc.LoadXml(reader.ReadOuterXml()); 
```

但实际上我不喜欢这样......它无缘无故地强制执行额外的 xml-parse 步骤（CPU 成本更高的操作之一）。如果原件有问题，那么也许考虑一个子阅读器：

```
 using (XmlReader subReader = reader.ReadSubtree())
    {
        XmlDocument doc = new XmlDocument();
        doc.Load(subReader);
        XmlElement el = doc.DocumentElement;
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T16:50:24.143

假设您有 XmlDocument，您需要在其中附加新创建的 XmlElement：

```
XmlElement myElement;
myXmlReader.Read();
if (myXmlReader.NodeType == XmlNodeType.Element)
{
   myElement = doc.CreateElement(myXmlReader.Name);
   myElement.InnerXml = myXmlReader.InnerXml;
} 
```

来自[文档](http://msdn.microsoft.com/en-us/library/system.xml.xmlelement.xmlelement.aspx)：不要直接实例化 XmlElement；相反，请使用 CreateElement 等方法。

# c# - 在 C# 代码中跟踪 OutOfMemoryExceptions

> ID：284272
> 
> 赞同：1
> 
> 时间：2008-11-12T15:22:18.097
> 
> 标签：c#, debugging

我想知道是否有一个工具可以在 C# 代码中跟踪间歇性 OutOfMemoryExceptions。

理想情况下，我正在寻找能够检测 OOM 情况的东西，一旦发生，它将允许查看托管堆的内容。

我通常使用 WinDBG + SOS 扩展来查看堆状态。这种方法的问题是我的问题是间歇性的，当异常发生时我没有转储文件。在 WinDBG 中遍历堆也不是真正的用户友好体验。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T15:24:43.380

看看[JetBrains dotTrace Profiler](http://www.jetbrains.com/profiler/index.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T15:25:26.513

您是要跟踪此异常还是要确定原因？我使用[AQTime](http://www.automatedqa.com/products/aqtime/)来查找托管/非托管代码中的内存泄漏并取得了相当大的成功。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T12:42:39.440

我会说 WinDbg + SOS 是一个很好的组合，但我会告诉你它不是最有吸引力的用户体验。

我的建议是您设置即时调试器以创建故障转储，然后使用 WinDbg 查找错误。

请注意，内存不足异常的故障转储可能很大。

# html - WAP 网站与移动网站的传统 HTML

> ID：284281
> 
> 赞同：3
> 
> 时间：2008-11-12T15:25:25.627
> 
> 标签：html, mobile, mobile-phones, wap

如果您有一些社交网络应用程序，并且您希望您的用户使用移动设备与他们进行交互，您会使用 WAP 还是使用 HTML 的常规网站的精简版？

我的思路是，由于所有可用的移动网络浏览器（Iphone、Opera Mini），WAP 已经死了，或者至少开始流血至死。这是一个好的假设吗？

另外，在选择您想要开发的移动访问方式时，您应该考虑哪些受众因素？

我不确定我的目标设备。我很确定我的用户会更加“现代”，因此我们可以假设 Windows Mobile、iPhone 和 Blackberry 设备。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-12T15:47:12.617

WAP 2.0 = XHTML 移动配置文件。我假设 WAP 是指 WAP 1.0 和 WML。现在几乎所有的移动浏览器都支持 XHTML MP（或一些近亲）。

有关移动开发的最佳实践，请参阅[dotMobi Mobile Web Developer's Guide](http://www.networksolutions.com/learning-center/mobi-guide.pdf)。

我建议您使用 WURFL 之类的工具来自动检测移动浏览器，并为它们提供带有无线 CSS 的 XHTML MP。我以这种方式为应用程序构建了一个移动前端，并且它在许多移动浏览器（移动端，即opera，openwave，...）上运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T15:28:11.080

您应该使用标准的 XHTML 1.0 Strict 或 XHTML Mobile Profile。WAP 很快就会消亡（如果还没有的话）。

[http://en.wikipedia.org/wiki/XHTML_Mobile_Profile](http://en.wikipedia.org/wiki/XHTML_Mobile_Profile)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T15:28:25.073

精简 HTML。

在我看来，WAP 网站普遍都很丑陋，而且随着移动浏览器的功能越来越强大，Ajax 应用程序越来越可能（并且可以很好地适应人们可能拥有的有限带宽/数据计划。

但是，如果您需要支持地球上的所有移动设备，您可能无论如何都必须使用 WAP。

你的目标设备是什么？一切，现代手机，只有智能手机......？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T15:35:24.780

在开发了一些移动应用程序之后，我会说大多数客户端都支持 HTML。当然，为这些客户提供精简版的 HTML 是安全的，以便为共同设计您的应用程序。但是，仍有大量客户端仅接受 WML 作为其内容类型，因此 HTML 无法满足您的所有用户。

如果您阅读 HTTP_ACCEPT 标头，您可以确定客户端能够理解的内容。根据我的经验，尽可能提供 HTML 服务并在必要时使用 WML 会更安全。

底线是，如果您不愿意支持站点的两个版本，请使用精简的 HTML（最好是 XHTML）。如果除了 HTML 之外您还可以支持 WAP，那么对于不理解 HTML 的客户端来说，它是一个很好的后备方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T15:16:05.027

请记住，WAP 具有自己的优势，即从手机浏览的普通 HTTP 站点不具备。

一个重要的问题是您可以访问 WAP 计费，您可以在其中向可能没有信用卡可用的客户收取少量费用。

您还可以使用 MSISDN（手机号码）来唯一地识别和跟踪您的 WAP 站点的访问者。

# c# - 与 u-blox gps 的 C# 串行通信

> ID：284285
> 
> 赞同：4
> 
> 时间：2008-11-12T15:26:04.517
> 
> 标签：c#, serial-port, gps, usbserial

我有一个来自 u-blox.com 的 GPS，带有 USB 连接和驱动程序。驱动程序安装了一个虚拟 COM 端口，当您插入 USB 时会弹出该端口。使用超级终端，我可以观察来自 GPS 的数据流。

然后我要我程序里的数据，没那么容易...

我已经实现了一些使用 serialPort 类从 GPS 读取的方法，但没有成功。我之前用 C# 编写了几个串行设备读取器和写入器，但这一个阻止了我。

例如，[simpleSerial](http://csharp.simpleserial.com/)中的简单代码不会给您任何东西，除非您拔下并重新插入 USB。

尝试使用 matlab 阅读它，效果很好，但是由于我需要 GPS 数据的程序的其余部分是在 c# 中，这并不能完全解决问题。

我可以绕过 serialPort 类中发生的一些高级 C# 事情吗？或者在读取 USB 串行端口时是否存在任何已知问题，我认为它就像我的 GPS 一样工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T22:02:15.433

如果您可以使用超级终端与 GPS 通信，那么原则上您没有理由不能在 C# 中进行通信。您确定您已正确配置串行端口，尤其是波特率、数据位、停止位、奇偶校验和流控制设置吗？

您可以使用[SysInternals PortMon](http://technet.microsoft.com/en-us/sysinternals/bb896644.aspx)工具查看低级 I/O 并比较超级终端和您的 C# 程序如何配置串行端口。也许这会提供一些有用的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T22:12:17.613

我已经成功地将 .Net 2 中的 SerialPort 类与虚拟 comport 上的 gps 一起使用。看来您的虚拟 comport 驱动程序有点不对劲。如果您找不到更新的驱动程序，我建议您调用 WinAPI 函数来读取串行端口。

例如看一下这段代码：http: [//www.codeproject.com/KB/system/SerialPortComm.aspx](http://www.codeproject.com/KB/system/SerialPortComm.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-26T21:05:48.333

从 u-blox 支持获得此信息。

以下十六进制命令将强制 GPS 模块上的看门狗复位。

> B5 62 06 04 04 00 00 00 00 00 0E 64
> 
> 这是 GPS 中 ARM7 uP 的低级命令 它适用于所有 u-blox GPS 接收器。

```
byte[] data = new byte[]{0xB5, 0x62, 0x06, 0x04, 0x04, 0x00,
                         0x00, 0x00, 0x00, 0x00, 0x0E, 0x64}; 
sp.Write(data, 0, data.Length); 
```

这个对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T03:48:27.173

不确定这是否与您遇到的问题相同。

我注意到如果 RX_FLAG 与 SetCommMask API 一起使用，GetOverlappedResult 似乎不会在第一个 WaitCommEvent 之后返回。看起来 API 正在等待某些事情发生，直到重置 com 掩码（至少这是我观察到的）。但是，如果您去读取端口，仍然会收到一些数据，之后设备不再响应。在这种情况下，您需要拔下并重新插入设备以使其再次响应。

但是，如果改为使用 RX_CHAR，则 GetOverLappedResult 会返回正确的状态，并且设备会正常工作。

希望这些信息有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T03:45:45.587

问题是 USB 串行端口驱动程序或 Microsoft 的 SerialPort 类实现中存在错误。我在使用 Prolific 制造的芯片（以及 Prolific 制造的驱动程序）的 USB 到串行适配器上遇到了完全相同的问题。

我无法准确地缩小问题范围，但现在 .NET Framework 源代码可用，我将尝试进入 SerialPort 并查看问题究竟出在哪里。

一种解决方法是使用不同的串行访问类。在 .Net 2.0 之前，我编写了一个 SerialStream 类，由于某种原因，它似乎可以与 SerialPort 类无法使用的这些相同的 USB 到串行适配器一起正常工作。

您可以在[http://www.6bit.com/download/SerialStream.zip](http://www.6bit.com/download/SerialStream.zip)获取我的课程。多年来，我已经向一些 GPS 程序员同事提供了相同的代码，他们也取得了成功。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T03:53:33.353

我使用以下代码通过 USB 与 Arduino 进行通信，它从 Arduino 发送和接收一个字节。这很简单，并且不与 GPS 通话，但希望它会有所帮助！

```
 public static byte ReadByte()
    {
        byte byteRead = new byte();
        SerialPort port = new SerialPort("COM3", 9600, Parity.None, 8, StopBits.One);
        port.Open();
        int byteValue = port.ReadByte();
        port.Close();

        byteRead = Convert.ToByte(byteValue);

        return byteRead;
    }

    public static void SendByte(byte packet)
    {
        SerialPort port = new SerialPort("COM3", 9600, Parity.None, 8, StopBits.One);
        port.Open();
        byte[] writeByte = new byte[1];
        writeByte[0] = packet;
        port.Write(writeByte, 0, 1);
        port.Close();
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-18T07:57:34.830

U-Blox GPS 遇到了同样的问题，但通过启用 DTR 和 RTS 属性设法解决了这个问题。现在我可以很好地阅读 NMEA 句子了。我发现的一个问题是我仍然需要不时将我的 GPS 移除并重新插入 USB 端口。希望能帮助到你。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-13T02:36:37.097

我在正在编写的应用程序中遇到了类似的问题，问题结果是我试图向我们`SerialPort.WriteLine`发送 a`\r\n`来结束行，而我真的需要发送`\n`. 当我切换到末尾附加`SerialPort.Write`一个`\n`时，一切都像在超级终端中一样工作。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2010-08-22T19:57:06.277

尝试使用握手/流量控制。它们在使用 USB 串行适配器时也很有用。

# compact-framework - Compact Framework - System.Threading.Timer 在用户关闭屏幕时停止

> ID：284300
> 
> 赞同：5
> 
> 时间：2008-11-12T15:28:38.427
> 
> 标签：compact-framework, power-management

我有一个应用程序需要“轮询”网络服务以查看用户是否有任何新消息在等待。我无法控制网络服务，所以我无法切换到“推送”机制，我被困在每 X 秒发出一个请求以查看可用的内容。

我经常使用 System.Threading.Timer 发出请求，但遇到了一些问题。最大的问题是当手机进入“待机”模式时它会停止运行（屏幕关闭，但仍然能够接听电话和电子邮件/txt 通知）。

我真的希望它表现得像其他后台应用程序一样。我该怎么做才能让它在不消耗太多电池电量的情况下工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T21:48:20.790

讨厌回答我自己的问题，但有人指出了[这一点](http://blog.opennetcf.com/ctacke/PermaLink,guid,169fcc25-a42f-4a8f-b8af-6b6c85d8819d.aspx "这")，即使设备处于睡眠状态，它也能够执行。看起来它工作得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T15:38:13.727

你无能为力，AFAIK。待机模式旨在暂停处理器以节省电力，如果处理器没有运行，您的代码将无法执行。您的应用程序可以做一些事情来防止设备进入待机模式，但这根本不值得推荐。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T15:42:56.480

是的。与MusiGenesis 的回答类似，如果不保持设备正常运行，您将无法做很多事情。类似于某些手机会通知“游戏/应用程序正在运行”，因此您的电池正在被拍打。

从您的手机编写一个界面以利用短信（仍然有效）并让它向网络服务发送短信怎么样？那可能吗？我猜这种方法也可能停止运行，但我认为这是一个想法？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T15:45:33.790

我不确定紧凑的框架，但在 Win32 中有 WaitableTimer 可以将计算机从待机状态唤醒。虽然.Net 中没有包装器，但它需要一些本机调用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T17:32:57.507

尽管您无法修改 Web 服务，但您可以在客户端和原始 Web 服务之间添加第二个“影子”Web 服务。影子 web 服务可以轮询原始 web 服务，然后将它发现的任何内容“推送”到 PDA。

不过，我想你可能仍然有同样的问题。我从来没有从 web 服务“推送”过，但我认为它基本上是通过让客户端对 web 服务方法进行初始调用来实现的，该方法将委托给客户端中的方法，然后 web 服务会挂起。当 web 服务需要推送某些东西时，它会调用该委托。如果客户端同时进入待机模式，从服务器调用委托的尝试将失败。

# customization - Infragistics grid "on-demand" appearance

> ID：284310
> 
> 赞同：0
> 
> 时间：2008-11-12T15:31:47.843
> 
> 标签：customization, infragistics, appearance, ultrawingrid

We're using Infragistics grid (most probably, we'll have 8.2 version at the end) and we want to configure row/cells appearances "on-demand" in order to be able to provide sort of "dynamic appearance".

For example, I want some cell to be red or green, depending on its value. We might want to tweak other characteristics as well (font, size, image, etc).

A perfect place to do it would be some event, that happen before a cell gets repainted... But it seems there is no such event in Infragistics...

Or am I wrong? Any help?

**Clarification:** I'm talking about WinForms Infragistics UltraGrid

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T16:18:49.183

I had to do exactly this with the IG WebGrid a few years back, and it was ... shall we say ... painful. However, the WebGrid had the advantage of a single render point -- once the HTML was emitted, we were set!

For dealing with this in WinGrid, I tried a variety of different events, both on the grid and the datasource, and met with abject failure every step of the way. The only event I got to work was `Paint`, which will likely create a performance issue.

For `Paint`, here's what I hacked together. I'm not proud of this code, and I likely wouldn't put it in production, but here it is anyway (C#):

```
private void UltraGrid1_Paint(object sender, System.Windows.Forms.PaintEventArgs e)
{
    foreach (UltraGridRow r in UltraGrid1.Rows)
    {
        foreach (UltraGridCell c in r.Cells)
        {
            if (c.Text == "foo")
                c.Appearance.BackColor = Color.Green;
        }
    }
} 
```

and VB:

```
Private Sub UltraGrid1_Paint(ByVal sender As System.Object, ByVal e As System.Windows.Forms.PaintEventArgs) Handles UltraGrid1.Paint
    For Each r As UltraGridRow In UltraGrid1.Rows
        For Each c As UltraGridCell In r.Cells
            If c.Text = "foo" Then
                c.Appearance.BackColor = Color.Green
            End If
        Next
    Next
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T15:36:07.337

There is an event. I don't remember exactly what it's called, but it's got to be something like 'DataRowBound' or 'ItemDataBinding', etc..

Also, [this article](http://weblogs.asp.net/tonylombardo/archive/2008/01/29/demystifying-infragistics-webgrid-databinding.aspx) might help.

Not that this has anything to do with your question, but I'd stay away from heavy use of Infragistics controls - they're very heavy and will slow down the page rendering process considerably. Just my $0.02.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T14:57:10.280

We have finally come up with two solutions for that problem.

For some of the dynamic content we use grid elements appearance and reinitialize it "on-demand".

For the extremely resource-critical appearance we use UltraGrid.DrawFilter (see also IUIElementDrawFilter interface).

# xml - 如何将子节点附加到 DOM 对象中的元素？

> ID：284315
> 
> 赞同：1
> 
> 时间：2008-11-12T15:34:45.340
> 
> 标签：xml, dom, asp-classic, vbscript

```
<%
    Set xmlDoc = Server.CreateObject("MSXML2.DOMDOCUMENT")
    xmlDoc.loadXML( "<response />" )

    Set node = xmlDoc.createElement("account")
    xmlDoc.documentElement.AppendChild node

    Set node = xmlDoc.createElement("type")
    node.Text = "TheType"
    xmlDoc.documentElement.AppendChild node

    Set node = Nothing
%> 
```

这将创建一个如下所示的 XML 文档：

```
 <response>
        <account></account>
        <type>TheType</type>
   </response> 
```

如何将“type”节点作为子节点附加到“newaccount”节点，使其看起来像这样：

```
 <response>
        <account>
            <type>TheType</type>
        </account>
   </response> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T15:36:59.127

与您现在将其附加到文档元素的方式相同：

```
Set accountEl = xmlDoc.createElement("account")
xmlDoc.documentElement.AppendChild accountEl

Set typeEl = xmlDoc.createElement("type")
typeEl.Text = "TheType"
accountEl.AppendChild typeEl

accountEl = Nothing
typeEl = Nothing 
```

# ios - 隐藏在 UITabBarController 内的 UINavigationController

> ID：284321
> 
> 赞同：3
> 
> 时间：2008-11-12T15:36:08.817
> 
> 标签：ios, cocoa-touch, cocoa

我有一个应用程序，`UIViewController`每个 5 s 在一个对应的 s 内`UINavigationController`，全部隐藏在 a`UITabBarController`中，在屏幕底部显示 5 个选项卡。

我想在按下对话框按钮时显示另一个`UIViewController`（在 a 内）。`UINavigationController`

该视图只能以编程方式加载和卸载；即它不应该出现在标签栏中。但是，我希望标签栏始终可见。

如果我添加`[UINavigationController view]`到`[self window]`被`UITabBar`覆盖。如果我将它添加到任何其他图层，则`UINavigationController`它对状态栏的补偿增加，因此看起来比预期的要低。

一个解决方案是将第 6 个与其他的一起`UINavigationController`添加到第 6 个中`UITabBar`，但将其`tabBarItem`隐藏。`tabBar`然后我可以使用s`selectedIndex`属性显示和隐藏它。

`tabBarItem`通过`UIViewController`节目访问没有明显的方法可以做到这一点。

* * *

@wisequark，我认为你完全误解了，你几乎重写了我的应用程序的架构。但是，我为每个视图都有一个单独的导航控制器，因为它们是互斥的，并且没有“向下钻取”的概念。

@Kendall，这就是我希望我必须做的 - 让模态视图出现一个隐藏按钮以恢复正常界面。但是保持标签栏始终可见会很好，所以我只是想知道是否有人知道一种方法。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-12T17:40:43.183

听起来好像你手上一团糟。A`UINavigationController`是一个与 a 非常不同的独特对象`UITabBarController`。通常，您的应用程序应该有一个选项卡控制器，其中一个选项卡的加载者`UINavigationController`依次加载它的视图——而不是两者都维护对不同视图的管理。`UIViewController`将 a 的显示称为这样的对象没有视觉表示也是不恰当的。在 a 的情况下`UINavigationController`，导航控制器对象负责显示导航栏和表格视图（在最常见的情况下）并管理导航层次结构中所有视图的显示。它本身在屏幕上没有相应的表示。同样，一个`UITabBarController`呈现一个选项卡栏，负责加载和卸载附加到选项卡按钮的视图和/或视图控制器。如果我们将其呈现为图像，它将看起来像这样 - [替代文本 http://img.skitch.com/20081112-2sqp7q4wafa34te1ga337u4k8.png](http://img.skitch.com/20081112-2sqp7q4wafa34te1ga337u4k8.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-13T17:05:21.143

好吧，听起来你真正想要做的是呈现一个模式视图，其中标签栏仍然可见。您可以将视图添加为标签栏控制器视图的子视图。奇怪的是，标签栏的视图不是标签栏本身，而是包含标签栏和所选项目视图的视图。

或者，您可以尝试调用 presentModalViewController:animated: 并将*所选选项卡*（即 [tabBarController.selectedViewController presentModalViewController:animated:]）作为接收器而不是选项卡栏。我似乎记得曾经这样做过（很偶然）并且标签栏仍然可见。

再想一想：由于您的五个视图控制器中的每一个都是 UINavigationController，因此您始终可以将 ViewController:animated: 推送到选定的视图控制器上，然后隐藏后退按钮。您的视图只会出现没有动画。但是您需要记住，每当用户切换到另一个选项卡时，将您的视图控制器从堆栈中弹出。这可能需要更多的工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T20:35:56.873

我能想到的最好的主意是为您的视图推送一个模式导航控制器（这将隐藏您不想要的标签栏），或者让标签栏控制器当前选择的视图控制器（实际上是您的导航控制器一个选项卡）并将您的新视图控制器推到那里 - 然后在使用选项卡栏委托选择另一个选项卡时弹出该视图。

不过，将视图推送到随机选项卡上对我来说似乎很奇怪，如果视图是从模态对话框创建的，我不明白为什么视图本身也不应该是模态的并隐藏选项卡。

# c# - 如何在 C# 中构建 XML？

> ID：284324
> 
> 赞同：453
> 
> 时间：2008-11-12T15:37:41.217
> 
> 标签：c#, xml

如何在 C# 中生成有效的 XML？

* * *

## 回答 #1

> 赞同：521
> 
> 时间：2008-11-12T15:40:37.450

这取决于场景。`XmlSerializer`当然是一种方式，并且具有直接映射到对象模型的优势。在 .NET 3.5 中`XDocument`， 等也很友好。如果尺寸非常大，那么`XmlWriter`就是你的朋友。

例如`XDocument`：

```
Console.WriteLine(
    new XElement("Foo",
        new XAttribute("Bar", "some & value"),
        new XElement("Nested", "data"))); 
```

或与以下内容相同`XmlDocument`：

```
XmlDocument doc = new XmlDocument();
XmlElement el = (XmlElement)doc.AppendChild(doc.CreateElement("Foo"));
el.SetAttribute("Bar", "some & value");
el.AppendChild(doc.CreateElement("Nested")).InnerText = "data";
Console.WriteLine(doc.OuterXml); 
```

如果您正在编写**大量**数据流，那么任何 DOM 方法（例如`XmlDocument`/`XDocument`等）都会很快占用大量内存。[因此，如果您正在从CSV](http://en.wikipedia.org/wiki/Comma-separated_values)编写 100 MB XML 文件，您可能会考虑`XmlWriter`；这是更原始的（一次写入的firehose），但非常有效（在这里想象一个大循环）：

```
XmlWriter writer = XmlWriter.Create(Console.Out);
writer.WriteStartElement("Foo");
writer.WriteAttributeString("Bar", "Some & value");
writer.WriteElementString("Nested", "data");
writer.WriteEndElement(); 
```

最后，通过`XmlSerializer`：

```
[Serializable]
public class Foo
{
    [XmlAttribute]
    public string Bar { get; set; }
    public string Nested { get; set; }
}
...
Foo foo = new Foo
{
    Bar = "some & value",
    Nested = "data"
};
new XmlSerializer(typeof(Foo)).Serialize(Console.Out, foo); 
```

这是映射到类等的一个很好的模型；但是，如果您正在做一些简单的事情（或者如果所需的 XML 与对象模型没有真正的直接相关性），这可能是矫枉过正。另一个问题`XmlSerializer`是它不喜欢序列化不可变类型：一切都必须有一个公共的 getter*和*setter（除非你自己通过实现来完成这一切`IXmlSerializable`，在这种情况下，你并没有通过使用获得太多收益`XmlSerializer`）。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2009-09-01T22:44:19.850

我尝试过的最好的事情是[LINQ to XSD](http://linqtoxsd.codeplex.com/)（大多数开发人员都不知道）。你给它一个 XSD Schema，它会在后台为你生成一个完美映射的完整的强类型对象模型（基于 LINQ to XML），这真的很容易使用——它会更新和验证你的对象模型和 XML即时的。虽然它仍然是“预览版”，但我没有遇到任何错误。

如果您有一个如下所示的 XSD 架构：

```
 <xs:element name="RootElement">
     <xs:complexType>
      <xs:sequence>
        <xs:element name="Element1" type="xs:string" />
        <xs:element name="Element2" type="xs:string" />
      </xs:sequence>
       <xs:attribute name="Attribute1" type="xs:integer" use="optional" />
       <xs:attribute name="Attribute2" type="xs:boolean" use="required" />
     </xs:complexType>
  </xs:element> 
```

然后您可以像这样简单地构建 XML：

```
RootElement rootElement = new RootElement;
rootElement.Element1 = "Element1";
rootElement.Element2 = "Element2";
rootElement.Attribute1 = 5;
rootElement.Attribute2 = true; 
```

或者简单地从文件中加载一个 XML，如下所示：

```
RootElement rootElement = RootElement.Load(filePath); 
```

或者像这样保存：

```
rootElement.Save(string);
rootElement.Save(textWriter);
rootElement.Save(xmlWriter); 
```

`rootElement.Untyped`还产生 XElement 形式的元素（从 LINQ 到 XML）。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-11-19T22:22:22.880

```
new XElement("Foo",
       from s in nameValuePairList
       select
             new XElement("Bar",
                  new XAttribute("SomeAttr", "SomeAttrValue"),
                          new XElement("Name", s.Name),
                          new XElement("Value", s.Value)
                         )
            ); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-11-12T15:43:54.247

XmlWriter 是编写良好 XML 的最快方法。XDocument、XMLDocument 和其他一些也很好用，但没有针对编写 XML 进行优化。如果您想尽可能快地编写 XML，则绝对应该使用 XmlWriter。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-12T15:49:16.543

在过去，我创建了我的 XML 模式，然后使用一个工具来生成将序列化到该模式的 C# 类。XML 模式定义工具就是一个例子

[http://msdn.microsoft.com/en-us/library/x6c1kb0s(VS.71).aspx](http://msdn.microsoft.com/en-us/library/x6c1kb0s(VS.71).aspx)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-12-10T14:40:57.320

我认为这个资源应该足以进行适度的 XML 保存/加载：[Read/Write XML using C#](http://www.java2s.com/Code/CSharp/XML/ReadandWriteXMLWithoutLoadinganEntireDocumentintoMemory.htm)。

我的任务是存储乐谱。我选择 XML，因为我猜[.NET](http://en.wikipedia.org/wiki/.NET_Framework)已经足够成熟，可以轻松解决该任务。我是正确的 ：）

这是我的歌曲文件原型：

```
<music judul="Kupu-Kupu yang Lucu" pengarang="Ibu Sud" tempo="120" birama="4/4" nadadasar="1=F" biramapembilang="4" biramapenyebut="4">
    <not angka="1" oktaf="0" naikturun="" nilai="1"/>
    <not angka="2" oktaf="0" naikturun="" nilai="0.5"/>
    <not angka="5" oktaf="1" naikturun="/" nilai="0.25"/>
    <not angka="2" oktaf="0" naikturun="\" nilai="0.125"/>
    <not angka="1" oktaf="0" naikturun="" nilai="0.0625"/>
</music> 
```

这可以很容易地解决：

对于保存到文件：

```
 private void saveToolStripMenuItem_Click(object sender, EventArgs e)
 {
     saveFileDialog1.Title = "Save Song File";
     saveFileDialog1.Filter = "Song Files|*.xsong";
     if (saveFileDialog1.ShowDialog() == DialogResult.OK)
     {
         FileStream fs = new FileStream(saveFileDialog1.FileName, FileMode.Create);
         XmlTextWriter w = new XmlTextWriter(fs, Encoding.UTF8);
         w.WriteStartDocument();
         w.WriteStartElement("music");
         w.WriteAttributeString("judul", Program.music.getTitle());
         w.WriteAttributeString("pengarang", Program.music.getAuthor());
         w.WriteAttributeString("tempo", Program.music.getTempo()+"");
         w.WriteAttributeString("birama", Program.music.getBirama());
         w.WriteAttributeString("nadadasar", Program.music.getNadaDasar());
         w.WriteAttributeString("biramapembilang", Program.music.getBiramaPembilang()+"");
         w.WriteAttributeString("biramapenyebut", Program.music.getBiramaPenyebut()+"");

         for (int i = 0; i < listNotasi.Count; i++)
         {
             CNot not = listNotasi[i];
             w.WriteStartElement("not");
             w.WriteAttributeString("angka", not.getNot() + "");
             w.WriteAttributeString("oktaf", not.getOktaf() + "");
             String naikturun="";
             if(not.isTurunSetengah())naikturun="\\";
             else if(not.isNaikSetengah())naikturun="/";
             w.WriteAttributeString("naikturun",naikturun);
             w.WriteAttributeString("nilai", not.getNilaiNot()+"");
             w.WriteEndElement();
         }
         w.WriteEndElement();

         w.Flush();
         fs.Close();
     }

 } 
```

对于加载文件：

```
openFileDialog1.Title = "Open Song File";
openFileDialog1.Filter = "Song Files|*.xsong";
if (openFileDialog1.ShowDialog() == DialogResult.OK)
{
    FileStream fs = new FileStream(openFileDialog1.FileName, FileMode.Open);
    XmlTextReader r = new XmlTextReader(fs);

    while (r.Read())
    {
        if (r.NodeType == XmlNodeType.Element)
        {
            if (r.Name.ToLower().Equals("music"))
            {
                Program.music = new CMusic(r.GetAttribute("judul"),
                    r.GetAttribute("pengarang"),
                    r.GetAttribute("birama"),
                    Convert.ToInt32(r.GetAttribute("tempo")),
                    r.GetAttribute("nadadasar"),
                    Convert.ToInt32(r.GetAttribute("biramapembilang")),
                    Convert.ToInt32(r.GetAttribute("biramapenyebut")));
            }
            else
                if (r.Name.ToLower().Equals("not"))
                {
                    CNot not = new CNot(Convert.ToInt32(r.GetAttribute("angka")), Convert.ToInt32(r.GetAttribute("oktaf")));
                    if (r.GetAttribute("naikturun").Equals("/"))
                    {
                        not.setNaikSetengah();
                    }
                    else if (r.GetAttribute("naikturun").Equals("\\"))
                    {
                        not.setTurunSetengah();
                    }
                    not.setNilaiNot(Convert.ToSingle(r.GetAttribute("nilai")));
                    listNotasi.Add(not);
                }
        }
        else
            if (r.NodeType == XmlNodeType.Text)
            {
                Console.WriteLine("\tVALUE: " + r.Value);
            }
    }
}

}
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-12T15:44:29.830

对于简单的事情，我只使用 System.XML 中的 XmlDocument/XmlNode/XmlAttribute 类和 XmlDocument DOM。

它为我生成 XML，我只需要将几个项目链接在一起。

然而，在更大的事情上，我使用 XML 序列化。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-12T15:48:51.647

对于简单的情况，我还建议查看[XmlOutput](http://www.improve.dk/blog/2008/08/10/updating-xmloutput)一个用于构建 Xml 的流畅接口。

XmlOutput 非常适合使用可读和可维护的代码创建简单的 Xml，同时生成有效的 Xml。原始[帖子](http://www.improve.dk/blog/2007/10/20/xmldocument-fluent-interface)有一些很好的例子。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2008-11-12T21:05:32.333

如上。

我使用 stringbuilder.append()。

非常简单，然后您可以执行 xmldocument.load(strinbuilder object as parameter)。

您可能会发现自己在 append 参数中使用了 string.concat，但这是一种非常简单的方法。

# c - 父母退出后如何使子进程死亡？

> ID：284325
> 
> 赞同：230
> 
> 时间：2008-11-12T15:37:51.153
> 
> 标签：c, linux, unix, process, fork

假设我有一个进程恰好产生一个子进程。现在，当父进程因任何原因（正常或异常，通过 kill、^C、断言失败或其他任何原因）退出时，我希望子进程终止。如何正确地做到这一点？

* * *

关于stackoverflow的一些类似问题：

*   （之前问过）[当父进程退出时，如何使子进程退出？](https://stackoverflow.com/questions/269494/how-can-i-cause-a-child-process-to-exit-when-the-parent-does)
*   （稍后问）[当父进程被杀死时，使用 fork() 创建的子进程是否会自动被杀死？](https://stackoverflow.com/questions/395877/are-child-processes-created-with-fork-automatically-killed-when-the-parent-is-k)

* * *

**关于Windows**的 stackoverflow 的一些类似问题：

*   [如何在 Windows 中自动销毁子进程？](https://stackoverflow.com/questions/53208/how-do-i-automatically-destroy-child-processes-in-windows)
*   [当父进程被杀死时杀死子进程](https://stackoverflow.com/questions/3342941/kill-child-process-when-parent-process-is-killed)

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2008-11-12T16:12:14.440

当父母死亡时，孩子可以通过在系统调用中`SIGHUP`指定选项来要求内核传递（或其他信号），如下所示：`PR_SET_PDEATHSIG``prctl()`

`prctl(PR_SET_PDEATHSIG, SIGHUP);`

详情请参阅`man 2 prctl`。

编辑：这是仅限 Linux

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2010-01-10T01:18:08.007

我正在尝试解决同样的问题，并且由于我的程序必须在 OS X 上运行，因此仅限 Linux 的解决方案对我不起作用。

我与此页面上的其他人得出了相同的结论——当父母去世时，没有一种与 POSIX 兼容的方式来通知孩子。所以我拼凑了下一个最好的事情——让孩子投票。

当父进程死亡（出于任何原因）时，子进程的父进程变为进程 1。如果子进程只是定期轮询，它可以检查其父进程是否为 1。如果是，子进程应该退出。

这不是很好，但它很有效，而且比本页其他地方建议的 TCP 套接字/锁定文件轮询解决方案更容易。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2008-11-12T19:58:48.147

过去，我通过在“子”中运行“原始”代码和在“父”中运行“生成”代码来实现这一点（即：您在之后颠倒了测试的通常意义`fork()`）。然后在“衍生”代码中捕获 SIGCHLD ......

在你的情况下可能是不可能的，但是当它起作用时很可爱。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2010-10-29T17:38:01.133

如果您无法修改子进程，您可以尝试以下操作：

```
int pipes[2];
pipe(pipes)
if (fork() == 0) {
    close(pipes[1]); /* Close the writer end in the child*/
    dup2(pipes[0], STDIN_FILENO); /* Use reader end as stdin (fixed per  maxschlepzig */
    exec("sh -c 'set -o monitor; child_process & read dummy; kill %1'")
}

close(pipes[0]); /* Close the reader end in the parent */ 
```

这会在启用了作业控制的 shell 进程中运行子进程。子进程在后台生成。shell 等待换行符（或 EOF）然后杀死孩子。

当父母死亡时——不管是什么原因——它都会关闭管道的末端。子 shell 将从读取中获取 EOF 并继续终止后台子进程。

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2016-04-29T18:32:29.930

在Linux下，你可以在子进程中安装一个父死亡信号，例如：

```
#include <sys/prctl.h> // prctl(), PR_SET_PDEATHSIG
#include <signal.h> // signals
#include <unistd.h> // fork()
#include <stdio.h>  // perror()

// ...

pid_t ppid_before_fork = getpid();
pid_t pid = fork();
if (pid == -1) { perror(0); exit(1); }
if (pid) {
    ; // continue parent execution
} else {
    int r = prctl(PR_SET_PDEATHSIG, SIGTERM);
    if (r == -1) { perror(0); exit(1); }
    // test in case the original parent exited just
    // before the prctl() call
    if (getppid() != ppid_before_fork)
        exit(1);
    // continue child execution ... 
```

请注意，在 fork 之前存储父进程 ID 并在子进程中对其进行测试可以消除调用子进程[`prctl()`](http://man7.org/linux/man-pages/man2/prctl.2.html)之间的竞争条件和退出进程。[`prctl()`](http://man7.org/linux/man-pages/man2/prctl.2.html)

还要注意，孩子的父母死亡信号在它自己的新创建的孩子中被清除。它不受`execve()`.

[如果我们确定负责采用所有孤儿](https://en.wikipedia.org/wiki/Orphan_process)的系统进程具有 PID 1 ，则可以简化该测试：

```
pid_t pid = fork();
if (pid == -1) { perror(0); exit(1); }
if (pid) {
    ; // continue parent execution
} else {
    int r = prctl(PR_SET_PDEATHSIG, SIGTERM);
    if (r == -1) { perror(0); exit(1); }
    // test in case the original parent exited just
    // before the prctl() call
    if (getppid() == 1)
        exit(1);
    // continue child execution ... 
```

但是，依靠该系统进程存在`init`并具有 PID 1 是不可移植的。[POSIX.1-2008 规定](http://pubs.opengroup.org/onlinepubs/9699919799/functions/_Exit.html#tag_16_01_03_01)：

> 调用进程的所有现有子进程和僵尸进程的父进程ID都应设置为实现定义的系统进程的进程ID。也就是说，这些进程应该由一个特殊的系统进程继承。

传统上，采用所有孤儿的系统进程是PID 1，即init——它是所有进程的祖先。

[在Linux](http://man7.org/linux/man-pages/man2/prctl.2.html)或[FreeBSD](https://www.freebsd.org/cgi/man.cgi?query=procctl&sektion=2)等现代系统上，另一个进程可能具有该角色。例如，在 Linux 上，进程可以调用[`prctl(PR_SET_CHILD_SUBREAPER, 1)`](http://man7.org/linux/man-pages/man2/prctl.2.html)以将自己建立为继承其任何后代的所有孤儿的系统进程（参见 Fedora 25 上的[示例](https://gist.github.com/gsauthof/8c8406748e536887c45ec14b2e476cbc)）。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2011-06-26T15:38:14.707

为了完整起见。在 macOS 上，您可以使用 kqueue：

```
void noteProcDeath(
    CFFileDescriptorRef fdref, 
    CFOptionFlags callBackTypes, 
    void* info) 
{
    // LOG_DEBUG(@"noteProcDeath... ");

    struct kevent kev;
    int fd = CFFileDescriptorGetNativeDescriptor(fdref);
    kevent(fd, NULL, 0, &kev, 1, NULL);
    // take action on death of process here
    unsigned int dead_pid = (unsigned int)kev.ident;

    CFFileDescriptorInvalidate(fdref);
    CFRelease(fdref); // the CFFileDescriptorRef is no longer of any use in this example

    int our_pid = getpid();
    // when our parent dies we die as well.. 
    LOG_INFO(@"exit! parent process (pid %u) died. no need for us (pid %i) to stick around", dead_pid, our_pid);
    exit(EXIT_SUCCESS);
}

void suicide_if_we_become_a_zombie(int parent_pid) {
    // int parent_pid = getppid();
    // int our_pid = getpid();
    // LOG_ERROR(@"suicide_if_we_become_a_zombie(). parent process (pid %u) that we monitor. our pid %i", parent_pid, our_pid);

    int fd = kqueue();
    struct kevent kev;
    EV_SET(&kev, parent_pid, EVFILT_PROC, EV_ADD|EV_ENABLE, NOTE_EXIT, 0, NULL);
    kevent(fd, &kev, 1, NULL, 0, NULL);
    CFFileDescriptorRef fdref = CFFileDescriptorCreate(kCFAllocatorDefault, fd, true, noteProcDeath, NULL);
    CFFileDescriptorEnableCallBacks(fdref, kCFFileDescriptorReadCallBack);
    CFRunLoopSourceRef source = CFFileDescriptorCreateRunLoopSource(kCFAllocatorDefault, fdref, 0);
    CFRunLoopAddSource(CFRunLoopGetMain(), source, kCFRunLoopDefaultMode);
    CFRelease(source);
} 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2008-11-12T16:15:49.597

子进程是否有通往/来自父进程的管道？如果是这样，您将在写入时收到 SIGPIPE，或在读取时收到 EOF - 可以检测到这些条件。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2014-05-01T02:25:57.170

受此处另一个答案的启发，我提出了以下全 POSIX 解决方案。总的想法是在父母和孩子之间创建一个中间过程，它有一个目的：注意父母何时死亡，并明确地杀死孩子。

当子代码无法修改时，这种类型的解决方案很有用。

```
int p[2];
pipe(p);
pid_t child = fork();
if (child == 0) {
    close(p[1]); // close write end of pipe
    setpgid(0, 0); // prevent ^C in parent from stopping this process
    child = fork();
    if (child == 0) {
        close(p[0]); // close read end of pipe (don't need it here)
        exec(...child process here...);
        exit(1);
    }
    read(p[0], 1); // returns when parent exits for any reason
    kill(child, 9);
    exit(1);
} 
```

这种方法有两个小注意事项：

*   如果你故意杀死中间进程，那么当父母死亡时，孩子不会被杀死。
*   如果子进程在父进程之前退出，那么中间进程将尝试杀死原来的子进程 pid，它现在可以引用不同的进程。（这可以通过在中间过程中使用更多代码来解决。）

顺便说一句，我使用的实际代码是在 Python 中。这是为了完整性：

```
def run(*args):
    (r, w) = os.pipe()
    child = os.fork()
    if child == 0:
        os.close(w)
        os.setpgid(0, 0)
        child = os.fork()
        if child == 0:
            os.close(r)
            os.execl(args[0], *args)
            os._exit(1)
        os.read(r, 1)
        os.kill(child, 9)
        os._exit(1)
    os.close(r) 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2008-11-12T15:45:14.133

我不相信可以保证只使用标准的 POSIX 调用。就像现实生活一样，一旦孩子出生，它就有了自己的生活。

父进程有可能捕获大多数可能**的**终止事件，并在此时尝试杀死子进程，但总有一些无法捕获。

例如，没有进程可以捕获`SIGKILL`. 当内核处理此信号时，它将终止指定进程，而不会通知该进程。

扩展类比——唯一的其他标准方法是让孩子在发现自己不再有父母时自杀。

有一种仅限 Linux 的方法`prctl(2)`- 请参阅其他答案。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2013-05-21T00:49:22.470

正如其他人所指出的，当父退出时依赖父pid变为1是不可移植的。无需等待特定的父进程 ID，只需等待 ID 更改即可：

```
pit_t pid = getpid();
switch (fork())
{
    case -1:
    {
        abort(); /* or whatever... */
    }
    default:
    {
        /* parent */
        exit(0);
    }
    case 0:
    {
        /* child */
        /* ... */
    }
}

/* Wait for parent to exit */
while (getppid() != pid)
    ; 
```

如果您不想全速轮询，请根据需要添加微睡眠。

这个选项对我来说似乎比使用管道或依赖信号更简单。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2017-03-21T10:32:29.283

这个解决方案对我有用：

*   将 stdin 管道传递给子级 - 您不必将任何数据写入流中。
*   Child 无限期地从 stdin 读取直到 EOF。EOF 表示父母已经离开。
*   这是检测父母何时离开的万无一失且可移植的方法。即使父母崩溃，操作系统也会关闭管道。

这是一个工人类型的进程，它的存在只有在父进程还活着时才有意义。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2008-11-12T16:42:06.813

安装一个**陷阱处理程序**来捕获 SIGINT，如果它还活着，它会杀死你的子进程，尽管其他海报是正确的，它不会捕获 SIGKILL。

打开具有独占访问权限的 .lockfile 并让子轮询它以尝试打开它 - 如果打开成功，则子进程应退出

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2013-03-13T04:55:00.473

一些海报已经提到了管道和`kqueue`. 事实上，您也可以通过调用创建一对连接的**Unix 域套接字**`socketpair()`。套接字类型应该是`SOCK_STREAM`.

让我们假设您有两个套接字文件描述符 fd1、fd2。现在`fork()`创建子进程，它将继承 fds。在父进程中关闭 fd2，在子进程中关闭 fd1。现在每个进程都可以`poll()`在自己的一端为`POLLIN`事件打开剩余的 fd。只要每一方`close()`在正常生命周期内都没有明确表示其 fd，您就可以相当确定一个`POLLHUP`标志应该指示对方的终止（无论是否干净）。收到此事件的通知后，孩子可以决定做什么（例如，死去）。

```
#include <unistd.h>
#include <stdlib.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <poll.h>
#include <stdio.h>

int main(int argc, char ** argv)
{
    int sv[2];        /* sv[0] for parent, sv[1] for child */
    socketpair(AF_UNIX, SOCK_STREAM, 0, sv);

    pid_t pid = fork();

    if ( pid > 0 ) {  /* parent */
        close(sv[1]);
        fprintf(stderr, "parent: pid = %d\n", getpid());
        sleep(100);
        exit(0);

    } else {          /* child */
        close(sv[0]);
        fprintf(stderr, "child: pid = %d\n", getpid());

        struct pollfd mon;
        mon.fd = sv[1];
        mon.events = POLLIN;

        poll(&mon, 1, -1);
        if ( mon.revents & POLLHUP )
            fprintf(stderr, "child: parent hung up\n");
        exit(0);
    }
} 
```

您可以尝试编译上述概念验证代码，并在`./a.out &`. 您有大约 100 秒的时间来尝试通过各种信号杀死父 PID，否则它将直接退出。无论哪种情况，您都应该看到消息“孩子：父母挂断”。

与使用`SIGPIPE`handler 的方法相比，这种方法不需要尝试`write()`调用。

这种方法也是*对称*的，即进程可以使用相同的通道来监控彼此的存在。

此解决方案仅调用 POSIX 函数。我在 Linux 和 FreeBSD 中试过这个。我认为它应该适用于其他 Unix，但我还没有真正测试过。

也可以看看：

*   `unix(7)`Linux 手册页，用于Linux 上`unix(4)`的 FreeBSD ，，，。`poll(2)``socketpair(2)``socket(7)`

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2010-12-09T08:25:14.643

我认为一种快速而肮脏的方法是在孩子和父母之间创建一个管道。当父母退出时，孩子将收到一个 SIGPIPE。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2017-12-06T18:13:45.817

另一种特定于 Linux 的方法是在新的 PID 命名空间中创建父级。然后它将是该名称空间中的 PID 1，当它退出时，它的所有子项将立即被杀死`SIGKILL`。

不幸的是，为了创建一个新的 PID 命名空间，你必须拥有`CAP_SYS_ADMIN`. 但是，这种方法非常有效，并且除了父级的初始启动之外，不需要对父级或子级进行真正的更改。

请参阅[clone(2)](http://man7.org/linux/man-pages/man2/clone.2.html)、[pid_namespaces(7)](http://man7.org/linux/man-pages/man7/pid_namespaces.7.html)和[unshare(2)](http://man7.org/linux/man-pages/man2/unshare.2.html)。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-11-12T20:54:28.270

在[POSIX](http://www.opengroup.org/onlinepubs/009695399/toc.htm)下`exit()`，`_exit()`和`_Exit()`函数定义为：

*   如果进程是控制进程，则应向属于调用进程的控制终端的前台进程组中的每个进程发送 SIGHUP 信号。

因此，如果您将父进程安排为其进程组的控制进程，则子进程应在父进程退出时收到 SIGHUP 信号。我不确定当父母崩溃时会发生这种情况，但我认为确实如此。当然，对于非崩溃案例，它应该可以正常工作。

请注意，您可能必须阅读大量精美的印刷品 - 包括基本定义（定义）部分，以及和和的系统服务信息`exit()`-`setsid()`以`setpgrp()`获得完整的图片。（我也会！）

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2011-12-05T21:31:47.627

如果您向 pid 0 发送信号，例如使用

```
kill(0, 2); /* SIGINT */ 
```

该信号被发送到整个进程组，从而有效地杀死了孩子。

您可以使用以下方法轻松测试它：

```
(cat && kill 0) | python 
```

如果然后按 ^D，您将看到文本`"Terminated"`表明 Python 解释器确实已被杀死，而不是因为标准输入被关闭而退出。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2013-01-08T08:22:13.193

如果它与其他任何人相关，当我在 C++ 的分叉子进程中生成 JVM 实例时，我能让 JVM 实例在父进程完成后正确终止的唯一方法是执行以下操作。如果这不是最好的方法，希望有人可以在评论中提供反馈。

1) 在启动 Java 应用程序之前，按照建议调用`prctl(PR_SET_PDEATHSIG, SIGHUP)`分叉子进程`execv`，并且

2) 向 Java 应用程序添加一个关闭钩子，直到其父 PID 等于 1 为止，然后执行一个 hard `Runtime.getRuntime().halt(0)`. 轮询是通过启动一个运行`ps`命令的单独 shell 来完成的（请参阅：[如何在 Java 中找到我的 PID 或在 Linux 上的 JRuby？](https://stackoverflow.com/questions/138097/how-do-i-find-my-pid-in-java-or-jruby-on-linux)）。

**编辑 130118：**

这似乎不是一个可靠的解决方案。我仍然在努力理解正在发生的细微差别，但在屏幕/SSH 会话中运行这些应用程序时，我有时仍然会遇到孤立的 JVM 进程。

我没有在 Java 应用程序中轮询 PPID，而是让关闭挂钩执行清理，然后像上面那样硬停止。`waitpid`然后，当需要终止所有内容时，我确保在生成的子进程上调用C++ 父应用程序。这似乎是一个更强大的解决方案，因为子进程确保它终止，而父进程使用现有引用来确保其子进程终止。将此与之前的解决方案进行比较，后者让父进程随时终止，并让子进程在终止之前尝试确定他们是否已成为孤儿。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-11-26T09:18:11.983

我找到了 2 个解决方案，都不是完美的。

**1.当收到SIGTERM信号时，通过kill(-pid)杀死所有的孩子。**
显然，这个解决方案不能处理“kill -9”，但它确实适用于大多数情况并且非常简单，因为它不需要记住所有子进程。

```
 var childProc = require('child_process').spawn('tail', ['-f', '/dev/null'], {stdio:'ignore'});

    var counter=0;
    setInterval(function(){
      console.log('c  '+(++counter));
    },1000);

    if (process.platform.slice(0,3) != 'win') {
      function killMeAndChildren() {
        /*
        * On Linux/Unix(Include Mac OS X), kill (-pid) will kill process group, usually
        * the process itself and children.
        * On Windows, an JOB object has been applied to current process and children,
        * so all children will be terminated if current process dies by anyway.
        */
        console.log('kill process group');
        process.kill(-process.pid, 'SIGKILL');
      }

      /*
      * When you use "kill pid_of_this_process", this callback will be called
      */
      process.on('SIGTERM', function(err){
        console.log('SIGTERM');
        killMeAndChildren();
      });
    } 
```

同样，如果您在某处调用 process.exit，您可以像上面那样安装“退出”处理程序。注意：Ctrl+C 和突然崩溃已经被操作系统自动处理为杀死进程组，这里不再赘述。

**2.使用[chjj/pty.js](https://github.com/chjj/pty.js/)来生成带有控制终端的进程。**
当您以任何方式杀死当前进程甚至 kill -9 时，所有子进程也将被自动杀死（由操作系统？）。我猜是因为当前进程持有终端的另一端，所以如果当前进程死亡，子进程将获得 SIGPIPE 所以死亡。

```
 var pty = require('pty.js');

    //var term =
    pty.spawn('any_child_process', [/*any arguments*/], {
      name: 'xterm-color',
      cols: 80,
      rows: 30,
      cwd: process.cwd(),
      env: process.env
    });
    /*optionally you can install data handler
    term.on('data', function(data) {
      process.stdout.write(data);
    });
    term.write(.....);
    */ 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-08-21T16:22:06.457

通过滥用终端控制和会话，我设法用 3 个进程创建了一个可移植的、非轮询解决方案。

诀窍是：

*   进程 A 启动
*   进程 A 创建一个管道 P（并且从不从中读取）
*   进程 A 派生到进程 B
*   进程 B 创建一个新会话
*   进程 B 为该新会话分配一个虚拟终端
*   进程 B 安装 SIGCHLD 处理程序以在子退出时终止
*   进程 B 设置一个 SIGPIPE 处理程序
*   进程 B 分叉到进程 C
*   进程 C 做它需要的任何事情（例如 exec()s 未修改的二进制文件或运行任何逻辑）
*   进程 B 写入管道 P（并以这种方式阻塞）
*   进程A在进程B上等待（）并在它死亡时退出

那样：

*   如果进程 A 死亡：进程 B 获得 SIGPIPE 并死亡
*   如果进程 B 死了：进程 A 的 wait() 返回并死了，进程 C 得到一个 SIGHUP（因为当带有终端的会话的会话负责人死了，前台进程组中的所有进程都会得到一个 SIGHUP）
*   如果进程 C 死了：进程 B 得到一个 SIGCHLD 并死了，所以进程 A 死了

缺点：

*   进程 C 无法处理 SIGHUP
*   进程 C 将在不同的会话中运行
*   进程 C 不能使用会话/进程组 API，因为它会破坏脆弱的设置
*   为每一个这样的操作创建一个终端并不是最好的主意

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-10-25T11:24:00.853

即使 7 年过去了，我也遇到了这个问题，因为我正在运行 SpringBoot 应用程序，该应用程序需要在开发期间启动 webpack-dev-server 并且需要在后端进程停止时将其终止。

我尝试使用`Runtime.getRuntime().addShutdownHook`，但它适用于 Windows 10，但不适用于 Windows 7。

我已将其更改为使用等待进程退出或`InterruptedException`似乎在两个 Windows 版本上都能正常工作的专用线程。

```
private void startWebpackDevServer() {
    String cmd = isWindows() ? "cmd /c gradlew webPackStart" : "gradlew webPackStart";
    logger.info("webpack dev-server " + cmd);

    Thread thread = new Thread(() -> {

        ProcessBuilder pb = new ProcessBuilder(cmd.split(" "));
        pb.redirectOutput(ProcessBuilder.Redirect.INHERIT);
        pb.redirectError(ProcessBuilder.Redirect.INHERIT);
        pb.directory(new File("."));

        Process process = null;
        try {
            // Start the node process
            process = pb.start();

            // Wait for the node process to quit (blocking)
            process.waitFor();

            // Ensure the node process is killed
            process.destroyForcibly();
            System.setProperty(WEBPACK_SERVER_PROPERTY, "true");
        } catch (InterruptedException | IOException e) {
            // Ensure the node process is killed.
            // InterruptedException is thrown when the main process exit.
            logger.info("killing webpack dev-server", e);
            if (process != null) {
                process.destroyForcibly();
            }
        }

    });

    thread.start();
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-03-08T08:51:34.073

从历史上看，从 UNIX v7 开始，进程系统通过检查进程的父 ID 来检测进程的孤儿。正如我所说，从历史上看，`init(8)`系统进程是一个特殊的进程，原因只有一个：它不会死。它不会死，因为处理分配新父进程 id 的内核算法取决于这个事实。当一个进程执行它的`exit(2)`调用（通过进程系统调用或通过外部任务向它发送信号等）时，内核将这个进程的所有子进程重新分配 init 进程的 id 作为它们的父进程 id。这导致了最简单的测试和最便携的方式来了解进程是否已成为孤儿。只需检查`getppid(2)`系统调用的结果，如果它是进程 id`init(2)`进程然后进程在系统调用之前得到孤立。

这种方法出现了两个可能导致问题的问题：

*   首先，我们有可能将`init`进程更改为任何用户进程，那么我们如何确保 init 进程始终是所有孤儿进程的父进程？好吧，在`exit`系统调用代码中，有一个明确的检查来查看执行调用的进程是否是 init 进程（pid 等于 1 的进程），如果是这种情况，内核就会崩溃（它应该不再能够维护进程层次结构），因此不允许 init 进程进行`exit(2)`调用。
*   其次，上面暴露的基本测试中有一个竞争条件。Init process' id 在历史上被假定为`1`，但这不是 POSIX 方法所保证的，它声明（如在其他响应中公开的那样）仅为该目的保留系统的进程 id。几乎没有 posix 实现这样做，您可以假设在原始的 unix 派生系统中，具有系统调用的`1`响应`getppid(2)`足以假设该进程是孤立的。另一种检查方法是`getppid(2)`在 fork 之后进行 a 并将该值与新调用的结果进行比较。这并不是在所有情况下都有效，因为两个调用都不是原子的，并且父进程可能在第一次系统调用之后`fork(2)`和之前死亡。`getppid(2)`进程`parent id only changes once, when its parent does an`退出(2) `call, so this should be enough to check if the`getppid(2)`result changed between calls to see that parent process has exit. This test is not valid for the actual children of the init process, because they are always children of`init(8)`，但是您可以安全地假设这些进程也没有父进程（除非您在系统中替换为 init 进程）

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2020-05-19T23:01:57.170

我已经将使用环境的父 pid 传递给子进程，然后定期检查 /proc/$ppid 是否存在于子进程中。

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2011-12-06T23:17:22.293

如果 parent 死了，orphans 的 PPID 变为 1 - 你只需要检查你自己的 PPID。在某种程度上，这就是上面提到的轮询。这是外壳片：

```
check_parent () {
      parent=`ps -f|awk '$2=='$PID'{print $3 }'`
      echo "parent:$parent"
      let parent=$parent+0
      if [[ $parent -eq 1 ]]; then
        echo "parent is dead, exiting"
        exit;
      fi
}

PID=$$
cnt=0
while [[ 1 = 1 ]]; do
  check_parent
  ... something
done 
```

# .net - .NET 错误：找不到依赖项“Microsoft.Office.Interop.Excel”

> ID：284336
> 
> 赞同：9
> 
> 时间：2008-11-12T15:41:45.250
> 
> 标签：.net, excel, interop

我的同事编写了一个驱动 Excel 的 DLL。
当我在我的 .NET 应用程序中引用他的 DLL 时，我收到一个警告：

```
The dependency 'Microsoft.Office.Interop.Excel' could not be found. 
```

我的应用程序将编译。
但是，当我使用我同事的 DLL 访问 Excel 时，会引发异常，并显示上面的消息。

我们应该有相同的设置： **Windows XP Pro SP3、VS2003、.NET 1.1、Office 2003**

我的问题似乎与[this question](https://stackoverflow.com/questions/224181/net-microsoftofficeinteropexcel-and-interopexcel-dll)类似，但我不知道它是否相同。

任何帮助或建议都非常感谢！

## 更新：

感谢您到目前为止的回答！

我没有添加对`Microsoft.Office.Interop.Excel`.
我当然不应该这样做？
**但是**：当我尝试添加此引用时，在“添加引用”对话框中找不到`Microsoft.Office.Interop.Excel`。

大概这意味着我缺少一个 DLL？
......但我不明白这怎么会发生？！

## 更新（固定）：

@ConcernedOfTunbridgeWells 为我解决了这个问题：安装主互操作程序集。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-12T16:40:02.167

您可能需要安装 Office 的[主要互操作程序集](https://msdn.microsoft.com/en-us/library/aa302338.aspx)，可从[此处下载。](https://www.microsoft.com/en-us/download/details.aspx?id=3508) 根据您安装 Visual Studio 和 Office 的顺序，默认情况下可能不会安装它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T15:45:28.457

您是否`Microsoft.Office.Interop.Excel`在项目中明确添加了对的引用？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T15:56:54.737

请您的同事将他在 bin 文件夹中的 Interop.Excel.dll 文件发送给您。或者，正如 Jon 上面建议的那样，您可以从 Add Reference 对话框的 COM 选项卡中添加对 Microsoft Excel 库的引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-01T01:50:10.660

尝试在 CodePlex 上运行“官方”F# 示例时遇到了同样的问题。项目引用互操作 V11。我删除了引用并再次添加它们，注意到我有 V9、V12 和 V14。我添加了 V12，一切正常，没有任何进一步的更改。

在安装另一个互操作版本之前，您可能想尝试一下。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-09T04:33:43.700

我刚刚解决了如下：

*   首先我去添加参考
*   单击添加引用窗口左上角的 COM。
*   查找 Microsoft Excel 15.0 对象库。
*   或者它可能不是 15.0，只是对象库。

我正在使用 Microsoft Office 2013 和 Microsoft Visual Studio 2012。

# oracle - DUPLICATE 命令的不同备份位置

> ID：284344
> 
> 赞同：0
> 
> 时间：2008-11-12T15:43:18.413
> 
> 标签：oracle, rman

我正在尝试使用 RMAN 中的 DUPLICATE 命令将数据库从一台机器克隆到另一台机器。两台机器的操作系统都是 Windows 2003，数据库软件是 10.2.0.3。问题是我的克隆只有一个 C:\ 驱动器，而我的主机备份保存在 L:\ 驱动器上。有没有办法告诉 RMAN 它应该用于克隆的备份位于不同的位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-12T20:22:29.893

RMAN 可以在新服务器上的新位置对备份片段进行[CATALOG 。](http://download.oracle.com/docs/cd/B19306_01/backup.102/b14194/rcmsynta011.htm#sthref230)这将允许副本找到它们。我在[dba-oracle.com找到了这个解决方案](http://www.dba-oracle.com/t_rman_clone+copy_database.htm)

# .net - 将某些属性标记为 CDATA 元素以进行序列化

> ID：284358
> 
> 赞同：2
> 
> 时间：2008-11-12T15:46:49.077
> 
> 标签：.net, xml, vb.net, xml-serialization

在序列化/反序列化某些类时，我遇到了需要将某些属性标记或标记为 CDATA 元素（由于它们的内容）。我目前正在这样处理：

```
 <XmlElement("MessageText")> _
    Public Property XmlContentLeft() As XmlCDataSection
        Get
            Dim doc As New XmlDataDocument()
            Dim cd As XmlCDataSection = doc.CreateCDataSection(Me.MessageText)
            Return cd
        End Get
        Set(ByVal value As XmlCDataSection)
            Me.MessageText = value.Value
        End Set
    End Property

    <XmlIgnore()> _
    Public Property MessageText() As String
        Get
            Return _messageText
        End Get
        Set(ByVal value As String)
            _messageText= value
        End Set
    End Property 
```

现在虽然这很好用，但它也有缺点——我现在有任何我想成为 CDATA 元素的重复属性，我必须为这些属性编写额外的代码。

所以我的问题是是否有更好的方法来做到这一点？我不想为每个类编写自定义模式或序列化例程。在理想情况下，我可以为这些属性添加一个属性，以便将它们自动视为 CDATA 元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T16:18:08.437

两件事情：

1）您可以像这样简化现有的 CDATA 代码：

```
<XmlElement("MessageText")> _
Public Property XmlContentLeft() As XmlCDataSection
    Get
        return GetCData(Me.MessageText)
    End Get
    Set(ByVal value As XmlCDataSection)
        Me.MessageText = value.Value
    End Set
End Property

' this method is re-usable by any property that needs CData
Private Function GetCData(ByVal value As String) As XmlCDataSection
    Static doc As New XmlDataDocument() 
    return doc.CreateCDataSection(value)
End Function

<XmlIgnore()> _
Public Property MessageText() As String
    Get
        Return _messageText
    End Get
    Set(ByVal value As String)
        _messageText= value
    End Set
End Property 
```

当然，这实际上比您发布的代码要多，但请注意，您的 CData 属性现在要简单得多。此外，我的使用`Static`不是拼写错误或 C# 错误。VB.Net 有一个鲜为人知的`Static`用于在函数中创建成员的关键字。这样，XmlDataDocument 只为整个类创建一次，不会污染类的私有命名空间。

2) 序列化程序应该已经正确地转义了字符数据。你真的需要它是 CData 吗？您序列化的任何内容都应正确反序列化以匹配原始内容，甚至是代码字符串之类的内容。我唯一可能*需要*CDATA 部分的情况是，如果您必须符合预期的模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-08T11:28:09.480

我有一个类似的问题 - 客户端需要来自 web 服务的 XML，其字符串包含在可怕的 CData 标记中，这完全没有必要，但他们不想重新编码他们的客户端，所以我必须使我的 XML 符合。

我的工作方式是将我想显示为 CDATA 的（字符串）属性重新输入到我自己的自定义类型“XmlCDataString”中。

然后我在该类型上实现了 IXmlSerializable 并在其中加入了几个 Narrowing 和 Widening 转换运算符重载，以便这些属性仍然尽可能像字符串一样工作。

```
Imports System.Xml.Serialization
Imports System.Xml
<Serializable()> _
Public Class XmlCDataString
  Implements IXmlSerializable

  Private _strValue As String = Nothing

  Public Sub New()

  End Sub

  Public Sub New(ByVal strValue As String)
    _strValue = strValue
  End Sub

  Public Property StringValue() As String
    Get
      Return _strValue
    End Get
    Set(ByVal value As String)
      _strValue = value
    End Set
  End Property

  Public Shared Widening Operator CType(ByVal strValue As String) As XmlCDataString
    Return New XmlCDataString(strValue)
  End Operator

  Public Shared Narrowing Operator CType(ByVal cdata As XmlCDataString) As String
    Return cdata.StringValue
  End Operator

  Public Function GetSchema() As System.Xml.Schema.XmlSchema Implements System.Xml.Serialization.IXmlSerializable.GetSchema
    Throw New NotImplementedException
  End Function

  Public Sub ReadXml(ByVal reader As System.Xml.XmlReader) Implements System.Xml.Serialization.IXmlSerializable.ReadXml
    ' TODO
  End Sub

  Public Sub WriteXml(ByVal writer As System.Xml.XmlWriter) Implements System.Xml.Serialization.IXmlSerializable.WriteXml
    Dim doc As XmlDocument
    Dim xmlCData As XmlCDataSection
    Dim serializer As XmlSerializer

    doc = New XmlDataDocument()
    xmlCData = doc.CreateCDataSection(_strValue)
    serializer = New XmlSerializer(GetType(XmlCDataSection))
    serializer.Serialize(writer, xmlCData)

  End Sub
End Class 
```

然后我要序列化为 CData 的属性我必须重新键入如下（使用您的示例）：

```
Private _messageText As XmlCDataString  

Public Property MessageText() As XmlCDataString 
    Get 
        Return _messageText 
    End Get 
    Set(ByVal value As XmlCDataString) 
        _messageText= value 
    End Set 
End Property 
```

这对我有用！

# .net - 如何更改 .NET DateTimePicker 控件以允许输入空值？

> ID：284364
> 
> 赞同：24
> 
> 时间：2008-11-12T15:48:16.127
> 
> 标签：.net, datetimepicker, null

`null`更改 .NET DateTimePicker 控件以允许用户输入值的最简单和最可靠的方法是什么？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-11-19T12:32:48.187

您无需修改​​它即可执行此操作。

`DateTimePicker`in .net 实际上有一个内置的复选框。

将`ShowCheckBox`属性设置为`true`。

然后您可以使用该`Checked`属性来查看用户是否输入了值。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.datetimepicker.showcheckbox(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datetimepicker.showcheckbox(VS.80).aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-12T15:56:47.480

这是此 CodeProject 文章中有关创建[Nullable DateTimePicker](http://www.codeproject.com/KB/selection/Nullable_DateTimePicker.aspx)的方法。

> 我已经重写了`Value`属性以接受`Null`value as `DateTime.MinValue`，同时保持对标准控件的验证`MinValue`和`MaxValue`对标准控件的验证。

这是文章中自定义类组件的一个版本

```
public class NullableDateTimePicker : System.Windows.Forms.DateTimePicker
{
    private DateTimePickerFormat originalFormat = DateTimePickerFormat.Short;
    private string originalCustomFormat;
    private bool isNull;

    public new DateTime Value
    {
        get => isNull ? DateTime.MinValue : base.Value;
        set
        {
            // incoming value is set to min date
            if (value == DateTime.MinValue)
            {
                // if set to min and not previously null, preserve original formatting
                if (!isNull)
                {
                    originalFormat = this.Format;
                    originalCustomFormat = this.CustomFormat;
                    isNull = true;
                }

                this.Format = DateTimePickerFormat.Custom;
                this.CustomFormat = " ";
            }
            else // incoming value is real date
            {
                // if set to real date and previously null, restore original formatting
                if (isNull)
                {
                    this.Format = originalFormat;
                    this.CustomFormat = originalCustomFormat;
                    isNull = false;
                }

                base.Value = value;
            }
        }
    }

    protected override void OnCloseUp(EventArgs eventargs)
    {
        // on keyboard close, restore format
        if (Control.MouseButtons == MouseButtons.None)
        {
            if (isNull)
            {
                this.Format = originalFormat;
                this.CustomFormat = originalCustomFormat;
                isNull = false;
            }
        }
        base.OnCloseUp(eventargs);
    }

    protected override void OnKeyDown(KeyEventArgs e)
    {
        base.OnKeyDown(e);

        // on delete key press, set to min value (null)
        if (e.KeyCode == Keys.Delete)
        {
            this.Value = DateTime.MinValue;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-12T15:50:18.103

放置一个额外的复选框，标记为“启用通知”，启用/禁用 DateTimePicker。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-09T13:54:21.877

Tri 的解决方案对我来说并没有完全解决，所以 Grazioli 先生认为他做了一些事情： http: [//www.codeguru.com/csharp/csharp/cs_controls/custom/article.php/c9645](http://www.codeguru.com/csharp/csharp/cs_controls/custom/article.php/c9645 "又一个可以为空的 DateTimePicker")

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-23T11:33:59.053

我发布了很长的解决方案，在代码注释中对这个控件的特殊问题有一些发现：

[日期时间选择器空值](http://social.msdn.microsoft.com/forums/en-US/winforms/thread/f1f8cc0a-0ac9-4a3e-9ba4-9af495e8ff58/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-10-09T06:26:59.043

将`ShowCheckBox`属性设置为`true`。

然后您可以使用 Checked 属性，如下所示：

```
private void dateTimePicker1_ValueChanged(object sender, EventArgs e)
{
    DateTimePicker thisDateTimePicker = (DateTimePicker)sender;
    if (thisDateTimePicker.Checked == false)
    {
        thisDateTimePicker.CustomFormat = @" "; //space
        thisDateTimePicker.Format = DateTimePickerFormat.Custom;
    }
    else
    {
        thisDateTimePicker.Format = DateTimePickerFormat.Short;
    }
} 
```

# mysql - MySQL 何时尝试更新列的索引？

> ID：284365
> 
> 赞同：5
> 
> 时间：2008-11-12T15:48:22.663
> 
> 标签：mysql, database

我正在尝试确定 MySQL 更新索引的情况。假设我有下表：

```
CREATE TABLE MyTable (
  ID INT NOT NULL AUTO_INCREMENT,
  MyIndexedColumn VARCHAR NOT NULL,
  MyNonIndexedColumn VARCHAR,
  PRIMARY KEY (ID),
  INDEX MyNewIndex(MyIndexedColumn)
) 
```

然后我运行以下 SQL 来插入一行：

```
INSERT INTO MyTable (MyIndexedColumn, MyNonIndexedColumn) 
VALUES ('MyTestValue', 'MyTestValue'); 
```

我知道这个查询会将某种哈希键添加到 MySQL 中的 B-Tree 索引中，以获取值“MyTestValue”。

现在，如果我运行以下语句，是否会强制更新 B-Tree 索引，即使我没有更改列的值？

```
UPDATE MyTable SET MyIndexedColumn = 'MyTestValue', 
MyNonIndexedColumn = 'A New Value' WHERE ID = 1; 
```

MySQL 是否足够聪明来确定这一点？或者只是将该列作为更新语句的一部分，我是在告诉 MySQL 可能发生了一些变化，它应该完成更新索引的工作吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-12T15:55:38.560

MySQL 不仅足够聪明，不会在值未更改的情况下更新索引，而且足够聪明，不会用相同的值重写列值。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-13T19:00:30.537

我对此做了一些测试，使用 mysql 5.0.41，将更新与两个相同的 innodb 表（7 个列，所有整数）进行比较，除了一个表有 5 个索引（其中几个是 2 列），另一个表没有索引。（不过，每个表都有它的主键索引。）

这是我最终得到的结果（没有索引的表是 A，有索引的表是 B）：

```
10k updates of an indexed column with a new value:
A:  76.8 seconds
B: 126.7 seconds

10k updates of a non-indexed column with a new value:
A: 27.6 seconds
B: 22.0 seconds

10k updates of a random column with its same value:
A: 1.4 seconds
B: 1.2 seconds

10k updates of a random column with an incremented value:
A: 12.2 seconds
B: 50.0 seconds

10k updates of an indexed column=>same value, non-indexed column=>new value:
A:  7.0 seconds
B: 10.5 seconds 
```

我假设相同/增量值更快的部分原因是因为我必须在进行更新之前查找该行，所以它会以某种形式缓存在 mysql 中。

这几乎完全体现了其他人所说的内容，但给出了一些关于索引对事物的影响程度的观点。但是，在 Jim 询问的特定情况下，它看起来可能会慢 50%。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T15:52:32.873

如果您在 MySQL 客户端中运行该查询，您将看到类似

> 匹配行数：1，更新行数：0

所以 MySQL 肯定知道一行何时发生了变化——我从那里假设它们足够聪明，不会从那里更新索引。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T15:53:46.800

当您执行 UPDATE MySQL 报告匹配的行数和更改的行数。运行您的示例查询会给出输出：

查询正常，0 行受影响（0.00 秒）匹配行：1 更改：0 警告：0

如果 MySQL 不使用该信息来确定是否更新索引，我会感到非常惊讶。

# java - 如何将集合属性绑定到 Spring MVC 中的表单

> ID：284368
> 
> 赞同：16
> 
> 时间：2008-11-12T15:48:42.630
> 
> 标签：java, spring, jakarta-ee, spring-mvc

我正在尝试使用 Spring-MVC 将我的模型对象之一绑定到表单的字段。一切正常，除了模型对象的属性之一是无序集合。做类似的事情

```
 <c:forEach items="${m.items}" var="i" varStatus="itemsRow">
      <form:input path="items[${itemsRow.index}]"/>
    </c:forEach>
    <form:errors path="items" /> 
```

对于 List 类型的属性可以正常工作，但是对于 Set 在提交时尝试将输入字段内容绑定到对象属性时会引发错误。

Spring 中有什么东西可以与 Sets 一起使用吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T16:32:34.460

我认为它必须是一个有序的集合。例如，Spring 参考中有[一个图表](http://static.springframework.org/spring/docs/2.5.x/reference/validation.html)讨论了如何引用属性。它说：

> account[2] 表示索引属性帐户的第三个元素。索引属性可以是数组、列表或其他*自然排序* 的集合类型（强调它们的）

也许一种方法是向您的对象添加一个 getter，而不是返回您的 Set，而是返回 Set.toArray()。然后您的 items 属性将引用该数组。当然，你不能依赖于排序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T15:52:07.387

我认为它不适用于 Set 的原因是因为不能保证 Set 的顺序。当您尝试绑定到 post 上的第一个对象时，它可能不是该列表中要渲染的第一个对象。例如，GET 和 POST 之间的 items[0] 可能不同。

因此，如果您使用有序的 Set 实现，例如 SortedSet 或 TreeSet，它应该可以正常工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T10:05:12.083

在这里找到完美的解决方案：http: [//forum.springsource.org/showthread.php?45312-Submitting-arrays](http://forum.springsource.org/showthread.php?45312-Submitting-arrays)

总体思路 - 使用 commons-collections 方法初始化列表：

```
private List someList = LazyList.decorate(new ArrayList(), FactoryUtils.instantiateFactory(com.abc.xyz.SomeClass.class)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T16:07:18.883

您可以尝试编写自己的自定义编辑器来完成这项工作，然后将编辑器注册到表单的控制器。您不必费心以这种方式索引 Set 中的元素。如前所述，如果有一种对元素进行排序的方法，则可以使用 SortedSet 确保它们在集合中的顺序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T16:40:27.503

我不清楚这到底是如何绑定的，但它适用于我的目的。

```
 <c:forEach items="${items}" var="i" varStatus="itemsRow">
        <input name="items[${itemsRow.index}].fieldName" type="text"/>
    </c:forEach>
 <form:errors path="items" /> 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2011-04-20T15:33:39.397

如果您使用对对象 ID 的数字引用，并且注册了适当的 Converter 实现，则可以使用分号分隔的列表。

POST 数据排行榜=1,2

转换器实现（忽略 JSON 的东西）

```
 public final class LeaderboardConverter extends JsonDeserializer<Leaderboard> implements Converter<String, Leaderboard>
    {
        public Leaderboard convert(String source) throws IllegalArgumentException
        {
            Leaderboard activity = new Leaderboard();
            activity.setId(new Integer(source));
            return activity;
        }

        public Leaderboard deserialize(JsonParser jp, DeserializationContext ctxt) throws IOException, JsonProcessingException
        {
            return convert(jp.getText());
        }

} 
```

# sharepoint - MOSS SpNavigationNode.Children 始终为空

> ID：284370
> 
> 赞同：0
> 
> 时间：2008-11-12T15:49:06.700
> 
> 标签：sharepoint, navigation

我试图在sharepoint中返回一组导航节点的所有子节点，SDK暗示我应该做这样的事情：

```
NodeColl = objSite.Navigation.TopNavigationBar 
Dim Node as SPNavigationNode

For Each Node In NodeColl
  if Node.IsVisible then
    Response.Write("<siteMapNode url=""" & Node.Url & """ title=""" & Node.Title & """  description=""" & Node.Title & """ >" & Environment.NewLine)
    Dim SubChildNodes as SPNavigationNodeCollection = Node.Children
    Response.Write(SubChildNodes.Count) 'returns 0 always even though I know theres over 20 nodes in some of the sections
    Dim ChildNode as SPNavigationNode
    For Each ChildNode in SubChildNodes
      if ChildNode.IsVisible then
        Response.Write("<siteMapNode url=""" & ChildNode.Url & """ title=""" & ChildNode.Title & """  description=""" & ChildNode.Title & """ />" & Environment.NewLine)
      End if
    Next
    Response.Write("</siteMapNode>" & Environment.NewLine)
  End If
Next 
```

但是，每当我这样做时，它都会列出顶级导航节点，但我无法显示子项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-01-07T07:15:32.997

我有同样的问题，我找到了解决方案

```
using (SPSite site = new SPSite("http://server"))
{
    using (SPWeb web = site.OpenWeb())
    {
        SPNavigationNode quicklaunch = web.Navigation.GetNodeById(1025);
        if (quicklaunch != null)
        {
            foreach (SPNavigationNode heading in quicklaunch.Children)
            {
                PrintNode(heading);
            }
        }
    }
}

static void PrintNode(SPNavigationNode node)
{
    foreach (SPNavigationNode item in node.Children)
        PrintNode(item);
} 
```

确保您有一个`SiteMapDataSource`与您的母版页关联的快速启动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-03T05:35:35.213

我遇到了同样的问题：我试图`SPWeb.Navigation.Quicklaunch`从从 onet.xml 激活的网络范围功能的功能接收器`SPWeb.Navigation.QuickLaunch.Count`中访问.xml。

我的解决方案是在我的功能接收器中打开一个新的 SPSite 和一个新的 SPWeb，之后我就可以访问快速启动项。例如，这对我有用：

```
using (SPSite site = new SPSite("http://yourserver/"))
{
  using (SPweb web = site.OpenWeb("theweb"))
  {
    web.Navigation.QuickLaunch.Count ; // greater than zero

    // manipulate your quick launch here
  }
} 
```

我假设这是因为创建新的 SPWeb 对象会从数据库加载网络的最新状态，而传递给我的功能接收器的 SPWeb 并不代表最新状态。但这是我猜

# flash - 在 flash actionscript 3 中转换编码

> ID：284373
> 
> 赞同：3
> 
> 时间：2008-11-12T15:50:18.587
> 
> 标签：flash, actionscript-3, actionscript

有没有像php这样的函数`mb_convert_encoding`可以将编码转换为另一个？

我想将在闪存内的输入字段中传递的 utf-8 文本转换为 iso-8859-7 编码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-10T19:12:31.327

是的，试试[`flash.utils.ByteArray::writeMultiByte()`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/ByteArray.html#writeMultiByte())：

```
var bytes:ByteArray = new ByteArray();
bytes.writeMultiByte("Δ", "iso-8859-7");  // Capital delta
assertEquals(0xc4, bytes[0]); 
```

# asp.net - 在客户端浏览服务器文件夹

> ID：284381
> 
> 赞同：0
> 
> 时间：2008-11-12T15:54:38.763
> 
> 标签：asp.net

我需要管理员用户在 Web 服务器上设置导出目录，或者使用 UNC 相对于 Web 服务器设置导出目录。有没有什么东西可以用来做这个，或者我必须重复一个有限的目录并在客户端上填充一个主目录浏览器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T23:06:18.067

我今天注意到了这一点……一个 JQuery 文件树插件。该链接包括许多服务器端语言的“连接器脚本”，包括 asp.net：

[http://abeautifulsite.net/notebook.php?article=58](http://abeautifulsite.net/notebook.php?article=58)

看起来很棒（并且有据可查），但我没有尝试过。如果有人有，我很想听听反馈...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T16:17:42.900

我看到的这个问题的每一个解决方案都是目录浏览的家庭滚动实现。

在 SQL 服务器上附加数据库时，Microsoft 使用“自定义”树视图来显示可附加的驱动器/文件夹/文件。

此外，在 DotNetNuke（一个开源 ASP.NET 内容管理系统）上，他们还有一个自制的实现，用于将文件上传到门户文件夹......

# java - 从 Oracle 数据库中的数百万行中进行选择的最佳方法

> ID：284382
> 
> 赞同：3
> 
> 时间：2008-11-12T15:55:33.897
> 
> 标签：java, sql, oracle, select

天！

我有一百万个不同的单词，我想在一个有 1500 万行的表中查询它们。同义词的结果与单词一起在每次查询后得到处理。

表如下所示：

```
 synonym      word
    ---------------------
    ancient      old
    anile        old
    centenarian  old
    darkened     old
    distant      far
    remote       far
    calm         gentle
    quite        gentle 
```

这是目前在 Java 中的完成方式：

```
....
PreparedStatement stmt;
ResultSet wordList;
ResultSet syns;
...

stmt = conn.prepareStatement("select distinct word from table");
wordList = stmt.executeQuery();

while (wordList.next()) {
    stmt = conn.prepareStatement("select synonym from table where word=?");
    stmt.setString(1, wordList.getString(1));
    syns = stmt.executeQuery();

    process(syns, wordList.getString(1));
}
... 
```

这是令人难以置信的缓慢。做这样的事情最快的方法是什么？

干杯，克里斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T16:02:49.090

1.  确保“单词”列上有索引。

2.  将第二个 prepareStatement 移到单词循环之外。每次创建新语句时，数据库都会编译并优化查询——但在这种情况下，查询是相同的，因此没有必要这样做。

3.  [结合上面的sblundy](https://stackoverflow.com/questions/284382/best-way-to-select-out-of-millions-of-rows-in-an-oracle-db#284399)所做的陈述。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-12T15:59:22.437

两个想法：

a）如何使它成为一个查询：

```
select synonym from table where word in (select distinct word from table) 
```

b）或者，如果您`process`的方法需要将它们作为一个单词的一组同义词来处理，为什么不将它们排序`word`并重新开始`process`每次`word`都是不同的？该查询将是：

```
select word, synonym 
from table 
order by word 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-12T16:05:02.520

如果您要查询所有同义词，为什么还要查询循环内的同义词？您应该使用单个`select word, synonym from table order by word`，然后在 Java 代码中按单词拆分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T16:07:04.713

```
PreparedStatement stmt;
ResultSet syns;
...

stmt = conn.prepareStatement("select distinct " + 
                             "  sy.synonm " + 
                             "from " +
                             "  table sy " +
                             "  table wd " +
                             "where sy.word = wd.word");
syns = stmt.executeQuery();
process(syns); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T19:46:30.823

相关但不相关：

```
while (wordList.next()) {
    stmt = conn.prepareStatement("select synonym from table where word=?");
    stmt.setString(1, wordList.getString(1));
    syns = stmt.executeQuery();

    process(syns, wordList.getString(1));
} 
```

您应该将该 preparestatement 调用移到循环之外：

```
stmt = conn.prepareStatement("select synonym from table where word=?");
while (wordList.next()) {
    stmt.setString(1, wordList.getString(1));
    syns = stmt.executeQuery();

    process(syns, wordList.getString(1));
} 
```

准备语句的全部目的是让数据库编译/缓存/等，因为您将重复使用该语句。如果要执行这么多查询，您可能还需要显式清理结果集，以确保不会用完游标。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-30T13:47:35.857

您还应该考虑利用语句对象的 setFetchSize 方法来减少应用程序和数据库之间的上下文切换。如果您知道要处理一百万条记录，则应使用 setFetchSize(someRelativelyHighNumberLike1000)。这告诉 java 每次需要从 Oracle 获取更多记录时最多抓取 1000 条记录[而不是一次抓取一条记录，这是这种批处理操作的最坏情况]。这将提高您的程序的速度。您还应该考虑对单词/同义词进行重构和批处理，如

1.  取 1
2.  过程1
3.  重复

比

1.  获取 50/100/1000
2.  处理 50/100/1000
3.  重复

只需将 50/100/1000 [或您一次检索的多个] 保存在某个数组结构中，直到您处理它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-12T16:33:49.823

问题已经解决了。重要的一点是，表格可以按单词排序。因此，我可以轻松地遍历整个表。像这样：

```
....
Statement stmt;
ResultSet rs;
String currentWord;
HashSet<String> syns = new HashSet<String>();
...

stmt = conn.createStatement();
rs = stmt.executeQuery(select word, synonym from table order by word);

rs.next();
currentWord = rs.getString(1);
syns.add(rs.getString(2));

while (rs.next()) {
    if (rs.getString(1) != currentWord) {
        process(syns, currentWord);
        syns.clear();
        currentWord = rs.getString(1);
    }
    syns.add(rs.getString(2));
}
... 
```

# php - 分发一个小型 PHP 应用程序

> ID：284385
> 
> 赞同：7
> 
> 时间：2008-11-12T15:56:41.100
> 
> 标签：php, distribution

我写了一个我想分发的小型 PHP 应用程序。我正在寻找最佳实践，以便可以轻松地将其安装在大多数虚拟主机上。

简而言之：这是一个简单的工具，可以让人们在使用密码登录后下载文件。

所以我的问题是：

1）我应该如何处理配置值？我没有使用数据库，所以配置文件似乎合适。我知道其他 php 应用程序（例如 Wordpress）使用定义，但它们是全局的，并且名称可能会发生冲突。（显然，全局变量也有同样的问题。）我查看了 PHP 内置的“ini”文件机制。它只允许在顶部添加注释——所以你不能轻易地注释每个设置——你不能用“php -f”来验证语法。其他选择？

2）如何处理模板？应用程序需要抽出一个表格。可能带有错误消息。（例如“对不起，密码错误。”）我有一个带有 HTML 表单的类变量，但也允许使用外部模板文件（在配置中指定）。我做了一些简单的搜索和替换 - 例如 %SCRIPT% 到脚本的名称，%STATUS% 来保存错误消息。这感觉有点像重新发明轮子，但包括像 Smarty 这样的模板系统是矫枉过正的。（另外他们可能已经有一个模板系统。）其他选择？

3) i18n - 只有 3 个消息字符串，gettext 似乎没有被普遍安装。在配置文件中设置这三个字符串参数是不是一个坏主意？

4）如何最好地与其他框架集成？我的应用程序是一个单一的类。所以，我想我可以只包含一个显示类是如何被调用的 php 脚本。对于必须将其集成到另一个框架中的人来说，这将是一个起点，但对于那些对定制不感兴趣的人来说也可以。合理的？

5) GET/POST 参数 - 类查看 $_GET 和 $_POST 是不是不好的形式？在构造过程中是否应该将所有值传递给我的类？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-12T16:38:16.273

# 配置

您可以使用这样的 php 文件：

```
<?php
return array(
  'option1' =&gt; 'foobar',
  'option2' =&gt; 123,
  //and so on...
  );
?> 
```

在主类中只需使用：

```
$config = (array) include 'path/to/config/file'; 
```

如果您打算将您的类作为一个组件分发到其他应用程序中，那么只需将配置数组/对象作为参数放在您的类的构造函数中，并将详细信息留给用户。

# 模板

对于如此简单的应用程序，您描述的方法应该足够了。请记住，一个人总是可以扩展您的类并用他自己的方法重载您的输出方法。

# I10N

如前所述，对于 3 个变量，除了将它们存储为配置之外的任何东西都只是矫枉过正。

# 一体化

注释每个公共方法（甚至更好的是受保护的和私有的），并解释它们做什么以及需要哪些参数。如果将其与示例结合起来，对于大多数用户来说应该足够了。

# 获取与发布

您的班级使用密码，您甚至想过通过 GET 发送密码？;) 想想浏览器历史记录、引用标题等 - 您的用户密码将在那里可见。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T16:23:52.527

1.  配置可以是类实例的本地吗？或者你可以创建一个小类，你可以创建一个实例来查询配置值？此外，在您的应用程序名称前添加任何全局变量应该可以在某种程度上阻止冲突。

2.  如果您的模板非常简单，只需编写一个简短的模板。这比试图解决人们使用任何第 3 方模板时遇到的问题要容易。它还可能简化许可问题。如果您开始担心他们已经拥有的东西，您将永远不会释放任何东西。组合太多了。

3.  对于 3 个字符串？是的，以与您处理配置相同的方式进行操作。

4.  良好的评论贯穿始终，并附有介绍您如何使用该课程的介绍。

5.  我不这么认为。如果它困扰您，您可以使用默认参数首先使用给定的参数，然后搜索 GET/POST 值（如果没有提供）（尽管这可能是安全风险）

还有其他事情需要考虑。很多人都在共享主机上，因此无法控制他们的 php.ini 或他们的 php 版本。您需要确保只使用尽可能常见的功能。

一个例子是某些主机上没有启用短标签（您必须使用`<?php ... ?>`and`<?php echo "..."?>`而不是`<? ... ?>`or `<?= "..." ?>`），这可能是一个皇家 PITA。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T23:25:33.520

除了 Krzysztof 的好建议：

*   `<?php`仅使用
*   如果您使用可以禁用的功能，请使用`function_exists()`以确保它们可用。`@missing_function()`使 PHP 无声无息地死掉，而不会记录任何错误。
*   您不能依赖可以通过`php.ini`. 用于`ini_get()`适应不同的设置。
*   如果`magic_quotes`启用，则仅从您的输入副本中去除斜杠 - 不要修改全局数组！一些蹩脚代码的安全性可能依赖于这些斜线的存在。
*   期望用户会盲目地从您的文档/网站中复制和粘贴代码。

# .net - 是否有 .NET 测试的测试运行程序可以运行多线程以利用多核机器？

> ID：284388
> 
> 赞同：4
> 
> 时间：2008-11-12T15:57:01.770
> 
> 标签：.net, testing, continuous-integration, gallio, xunit.net

我目前正在设置 CI，使用 Thoughtworks Studios 的 Cruise、Gallio 来运行 xunit.net fact/tests，并使用 ncover 2 来进行代码覆盖。

我注意到运行代码覆盖率与我们的构建代理服务器拥有的四个 CPU 之一挂钩，并且想知道是否有一个多线程测试运行程序可以代替我使用，以利用其他 3 个内核闲着？我进行了快速搜索，但大多数命中都是关于测试多线程代码，而不是多线程测试运行......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T03:05:40.340

Gallio[实现](http://code.google.com/p/mb-unit/issues/detail?id=355)了并行测试执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T18:34:10.707

在 NUnit 中，您可以传递[/thread 参数](http://www.nunit.org/index.php?p=consoleCommandLine&r=2.2.4)，该参数在不同的线程中生成测试执行。我想拥有一个线程池来生成测试不会有太多的工作。您必须确保测试中没有依赖项。

我会询问 xUnit.NET 或 NUnit 列表。我知道 Charlie 正在努力使 NUnit 3.0 的这一部分。您还可以将[PNunit](http://pnunit.codicesoftware.com/opdownloads2/oppnunit.aspx)视为扩展。还有[一篇文章](http://www.damonpayne.com/2008/05/09/ConcurrentUnitTestingWithXUnitNet0.aspx)，有人致力于在多个线程中获取 xUnit.NET。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T15:37:26.780

就在昨天，我看到了 Damon Payne 的这篇文章：

[http://www.damonpayne.com/2008/05/09/ConcurrentUnitTestingWithXUnitNet1.aspx](http://www.damonpayne.com/2008/05/09/ConcurrentUnitTestingWithXUnitNet1.aspx)

其中他介绍了为 xUnit.NET 编写自定义测试运行程序，该运行程序使用类作为并发单元显式分发测试用例，以利用多个内核。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T18:25:57.867

如果不出意外，我知道在 CruiseControl.NET 中，您可以同时运行多个两个操作。我认为克鲁斯也是如此。您可以在每个测试的 1/4 上运行四个实例，然后将结果缝合在一起。但是，知道何时合并它们可能很困难。

# php - nusoap中的重复标签

> ID：284389
> 
> 赞同：1
> 
> 时间：2008-11-12T15:57:15.640
> 
> 标签：php, arrays, soap, nusoap

我正在使用[nusoap](http://sourceforge.net/projects/nusoap/)连接到一个肥皂网络服务。类发送给服务的 xml 是从一个数组构造的，即：

```
$params = array("param1" => "value1", "param2" => "value1");
$client->call('HelloWorld', $params, 'namespace', 'SOAPAction'); 
```

这工作正常。多维数组还构造了一个漂亮的嵌套 xml 消息。

当我需要两个具有相同名称的标签时遇到问题：

```
<items>
   <item>value 1</item>
   <item>value 2</item>
</item>

$params = array("items" => array("item" => "value 1", "item" => "value 2")); 
```

数组中的第二项覆盖第一项，导致：

```
<items>
   <item>value 2</item>
</item> 
```

怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T16:10:35.440

问题在于内部数组（）

```
$test_array = array("item" => "value 1", "item" => "value 2"); 
```

创建一个具有单个键（“项目”）的数组。

试试这个，看看它是否有效：

```
$params = array("items" => array("item" => array("value 1", "value 2"))); 
```

没有保证，但是...我很**长时间**没有使用 nusoap并且没有在这里安装 PHP 来测试它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-07T12:57:54.437

我们通过将字符串而不是数组传递给 nusoap 调用函数来解决这个问题。请查看以下链接 [http://fundaa.com/php/solved-duplicate-tags-in-nusoap/](http://fundaa.com/php/solved-duplicate-tags-in-nusoap/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-02T09:14:05.123

这很奇怪，因为方法：

```
$params = array('items' => array('item' => array('value1', 'value2')))
$client->call( 'action', $params ); 
```

我的作品。[如此链接中](http://osdir.com/ml/php.nusoap.general/2008-02/msg00015.html)所述

也许您需要更新版本的 nusoap？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T16:26:03.117

您的核心问题是您正在编写无效的 PHP 代码

```
$x = array("items" => array("item" => "value 1", "item" => "value 2")); 
var_dump($x);

array(1) {
  ["items"]=>
  array(1) {
    ["item"]=>
    string(7) "value 2"
  }
} 
```

哪个当然行不通，因为它的同义词

```
 $x = array(); 
 $x['items'] = array(); 
 $x['items']['item']='value 1'; 
 $x['items']['item']='value 2'; 
```

这当然行不通。

您最好的选择是

```
 array("items"=>array( "value1","value2") ); 
```

并希望数字键能够“工作”或

```
 array("items"=>array("item"=>array("value1","value2"))) 
```

如果它是如此倾斜。

### 此外

查看 sourceforge 上的示例，看起来这是有效的语法：

```
$params = '<person xsi:type="tns:Person"><firstname xsi:type="xsd:string">Willi</firstname><age xsi:type="xsd:int">22</age><gender xsi:type="xsd:string">male</gender></person>';
$result = $client->call('hello', $params); 
```

[http://nusoap.cvs.sourceforge.net/viewvc/checkout/nusoap/samples/wsdlclient3b.php *_* _](http://nusoap.cvs.sourceforge.net/viewvc/*checkout*/nusoap/samples/wsdlclient3b.php)

这个显示使用未键入（即：数字）数组作为输入源： [http : *//nusoap.cvs.sourceforge.net/viewvc/checkout/nusoap/samples/wsdlclient4.php*](http://nusoap.cvs.sourceforge.net/viewvc/*checkout*/nusoap/samples/wsdlclient4.php)

# asp.net - 在父 web.config 中被忽略

> ID：284390
> 
> 赞同：4
> 
> 时间：2008-11-12T15:57:16.903
> 
> 标签：asp.net, configuration, assemblies, gac

我有一个包含多个网站的文件夹，它们都使用 GAC 中的相同程序集。每个网站还包含一些他们自己的“自定义”程序集，这些程序集引用了公共程序集。

此文件夹中有一个 web.config，用于定义站点的通用设置，包括要加载到`<system.web>/<compilation>/<assemblies>`元素中的程序集。

我想要做的是添加一个`<runtime>/<assemblyBinding>`部分以将请求从较旧的“自定义”程序集重定向到安装在 GAC 中的较新程序集。（不幸的是，不能使用 machine.config 或 GAC 重定向策略，因为这会影响其他站点。）

似乎该`<assemblyBinding>`部分被忽略，除非它位于网站自己的 web.config 或 machine.config 中。

我已经遇到过这个`<configuration xmlns="http://schemas.microsoft.com/.NetConfiguration/v2.0">`问题，所以我知道不是这样。

有谁知道这是应该发生的事情还是我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-03T07:19:16.453

它应该发生。你没有做错什么。

有关更多信息，请查看 [http://msdn.microsoft.com/en-us/library/2fc472t2(vs.71).aspx](http://msdn.microsoft.com/en-us/library/2fc472t2%28vs.71%29.aspx)

# sql-server-2005 - SQL 2000 Reporting Services 和 SQL 2005 Reporting Services 并排？

> ID：284392
> 
> 赞同：0
> 
> 时间：2008-11-12T15:57:25.547
> 
> 标签：sql-server-2005, reporting-services, sql-server-2000

有谁知道是否可以同时安装 SQL 2000 Reporting Services Server 和 SQL 2005 Reporting Services Server？

Reports 和 ReportServer 虚拟目录都是默认网站中的虚拟目录，它们使用不同的 .net 框架。这甚至允许吗？我是否需要创建一个新网站来支持这两个引擎之一？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T16:01:16.350

答案是肯定的。您必须将 SQL Server 2000 版本保留为默认实例，并将 SQL Server 2005 版本保留为命名实例。还，

> 每个报表服务器和报表管理器实例的虚拟目录必须是唯一的。
> 
> 您可以对所有虚拟目录使用同一个网站。但是，您应该为 SQL Server 2005 报表服务器和报表管理器应用程序创建一个单独的应用程序池。

[来源](http://msdn.microsoft.com/en-us/library/ms143520(SQL.90).aspx)

# c# - .NET XmlDocument：为什么保存后 DOCTYPE 会发生变化？

> ID：284394
> 
> 赞同：3
> 
> 时间：2008-11-12T15:57:55.873
> 
> 标签：c#, xml, vb.net, doctype, xmldocument

我正在使用 .NET XmlReader 打开一个 XML 文件并将该文件保存在另一个文件名中，并且似乎 DOCTYPE 声明在两个文件之间发生了变化。虽然新保存的文件仍然是有效的 XML，但我想知道为什么它坚持要更改原始标签。

```
Dim oXmlSettings As Xml.XmlReaderSettings = New Xml.XmlReaderSettings()
oXmlSettings.XmlResolver = Nothing
oXmlSettings.CheckCharacters = False
oXmlSettings.ProhibitDtd = False
oXmlSettings.IgnoreWhitespace = True

Dim oXmlDoc As XmlReader = XmlReader.Create(pathToOriginalXml, oXmlSettings)
Dim oDoc As XmlDocument = New XmlDocument()
oDoc.Load(oXmlDoc)
oDoc.Save(pathToNewXml) 
```

以下（在原始文件中）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd"> 
```

变为（注意末尾的 [ ] 字符）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd"[]> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-07-01T17:03:07.137

当您设置 XmlDocument.XmlResolver = null 时，System.Xml 中存在错误。解决方法是创建一个自定义 XmlTextWriter：

```
 private class NullSubsetXmlTextWriter : XmlTextWriter
    {
        public NullSubsetXmlTextWriter(String inputFileName, Encoding encoding)
            : base(inputFileName, encoding)
        {
        }
        public override void WriteDocType(string name, string pubid, string sysid, string subset)
        {
            if (subset == String.Empty)
            {
                subset = null;
            }
            base.WriteDocType(name, pubid, sysid, subset);
        }
    } 
```

在您的代码中，创建一个新的 NullSubsetXmlTextWriter(pathToNewXml, Encoding.UTF8) 并将该对象传递给 oDoc.Save() 方法。

这是[Microsoft 支持案例](http://www.vistax64.com/net-general/215921-xmldocument-save-null-xmlresolver-modifies-doctype-tag.html)，您可以在其中阅读解决方法（它描述了解决方法，但不提供代码）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-13T02:19:28.113

可能该库将 DOCTYPE 元素解析为内部结构，然后将该结构转换回文本。它不存储原始字符串形式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-24T21:08:41.963

这是最适合您的解决方案：

```
writer.WriteDocType("Name", Nothing, 
                    "http://xml.cxml.org/schemas/cXML/1.2.033/Fulfill.dtd", Nothing) 
```

如果你使用`Nothing`你不会得到 [] 或 "" 等

# asp.net - ASP.NET 2.0：如何将 asp:Menu 绑定到 SqlDataSource？

> ID：284398
> 
> 赞同：5
> 
> 时间：2008-11-12T15:58:40.410
> 
> 标签：asp.net, database, menu, aspmenu

我找到了如何将 asp:Menu 绑定到 XML。我找到了如何将 asp:Menu 绑定到站点地图（实际上将其绑定到 XML）。如何将 asp:Menu 绑定到数据库？

.NET Framework 提供多个数据源：

*   [分层数据源控件](http://msdn.microsoft.com/en-us/library/system.web.ui.hierarchicaldatasourcecontrol.aspx)
*   *   [XmlDataSource](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.xmldatasource.aspx)
*   *   [站点地图数据源](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sitemapdatasource.aspx)
*   [数据源控件](http://msdn.microsoft.com/en-us/library/system.web.ui.datasourcecontrol.aspx)
*   *   [SqlDataSource](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sqldatasource.aspx)
*   *   [访问数据源](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.accessdatasource.aspx)
*   *   [Linq 数据源](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linqdatasource.aspx)

我想使用一个代表 SQL Server 表中的数据的。数据以每个人都使用的标准[分层](http://www.answers.com/hierarchical)格式存储：

```
NodeID    ParentNodeID    Caption        Url
========  ==============  =========      =================
{3234...  {3632...        stackoverflow  http://stackov...
{3632...  (null)          Questions      ~/questions.aspx
{3233...  (null)          Tags           ~/tags.aspx
{3235...  {3632...        google         http://www.goo... 
```

返回所有行的查询将是：

```
SELECT * FROM Nodes 
```

微软打算用什么秘密方法将这些数据混入 asp:Menu 中？

* * *

**更新：** aspalliance.com 上有一篇很好的文章：[Building a Database Driven Hierarchical Menu using ASP.NET 2.0](http://aspalliance.com/822)。不幸的是，它描述了如何执行 XML 数据绑定；虽然我对数据库绑定感兴趣。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-12T16:02:14.490

aspalliance.com 上有一篇很好的文章：[**Building a Database Driven Hierarchical Menu using ASP.NET 2.0**](http://aspalliance.com/822)。每个步骤都有解释和很好的说明。

*“在本文中，Michael 演示了如何使用 ASP.NET 2.0 仅用几行代码创建一个数据库驱动的分层菜单。对于需要功能强大且灵活且设计简单的专业菜单的每个人来说，这是一个必读的教程。 "*

的代码可能是：

```
protected void LoadData()
{
    DataSet ds = new DataSet();
    string connStr = YOUR_CONNECTION_STRING_HERE;
    using(SqlConnection conn = newSqlConnection(connStr))
    {
      string sql = "Select NodeID, Caption, Url, ParentID from Menu";
      SqlDataAdapter da = newSqlDataAdapter(sql, conn);
      da.Fill(ds);
      da.Dispose();
    }
    ds.DataSetName = "Menus";
    ds.Tables[0].TableName = "Menu";
    DataRelation relation = newDataRelation("ParentChild",
     ds.Tables["Menu"].Columns["NodeID"],
     ds.Tables["Menu"].Columns["ParentID"], true);

    relation.Nested = true;
    ds.Relations.Add(relation);

    xmlDataSource.Data = ds.GetXml();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-13T23:35:42.010

该菜单不支持绑定到 SqlDataSource，因为它是 HierarchicalDataBoundControl - 仅支持分层数据源。您应该实现自己的 HierarchicalDataSourceControl。[在这里](http://msdn.microsoft.com/en-us/library/system.web.ui.ihierarchicaldatasource.aspx)查看一个例子。或者，您可以创建一个自定义站点地图提供程序并使用 SiteMapDataSource，如此[处所示](http://msdn.microsoft.com/en-us/magazine/cc163657.aspx)。最后，您可以使用可以绑定到 SqlDataSource[的第 3 方控件。](http://demos.telerik.com/aspnet/prometheus/Menu/Examples/Programming/DeclarativeDataSources/DefaultCS.aspx)

# xpcom - 从 nsIDOMEvent 获取 URI

> ID：284408
> 
> 赞同：2
> 
> 时间：2008-11-12T16:02:08.297
> 
> 标签：xpcom

我正在使用 XPCOM，我想获取用户单击的页面部分的 URI（例如，用户右键单击一个框架，我想显示该框架的 URL）。所以我设置了一个鼠标监听器 (nsIDOMEventListener)，然后当点击发生时，handleEvent 回调让我可以访问 nsIDOMEvent。

我的问题是，如何从 nsIDOMEvent 获取 URI？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-13T13:20:50.830

要回答我自己的问题：在事件中，调用 getTarget().queyInterface(NS_IDOMHTMLELEMENT_IID).getOwnerDocument()。queryInterface(NS_IDOMHTMLDOCUMENT_IID).getURL()

（以上是伪代码。您必须根据您使用的语言对其进行调整）

# mysql - MySQL 中的系统视图

> ID：284418
> 
> 赞同：2
> 
> 时间：2008-11-12T16:05:46.263
> 
> 标签：mysql, sql-server, system-views

我正在使用 SYS.ALL_OBJECTS、SYS.FOREIGN_KEYS 等系统目录视图来获取有关我在 MS SQL 2005 中的数据库结构的信息。

MySQL (v. 5) 服务器是否有等效的功能/视图？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T16:54:18.100

对于模式（所有对象）；

```
SELECT * FROM information_schema.SCHEMATA S; 
```

也适用于约束和外键；

```
SELECT * FROM information_schema.TABLE_CONSTRAINTS T; 
```

对于其他一切，请检查此查询；

```
SELECT * FROM information_schema.CHARACTER_SETS C;
SELECT * FROM information_schema.COLLATION_CHARACTER_SET_APPLICABILITY C;
SELECT * FROM information_schema.COLLATIONS C;
SELECT * FROM information_schema.COLUMN_PRIVILEGES C;
SELECT * FROM information_schema.`COLUMNS` C;
SELECT * FROM information_schema.KEY_COLUMN_USAGE K;
SELECT * FROM information_schema.PROFILING P;
SELECT * FROM information_schema.ROUTINES R;
SELECT * FROM information_schema.SCHEMA_PRIVILEGES S;  
SELECT * FROM information_schema.STATISTICS S;
SELECT * FROM information_schema.TABLE_PRIVILEGES T;
SELECT * FROM information_schema.`TABLES` T;
SELECT * FROM information_schema.TRIGGERS T;
SELECT * FROM information_schema.USER_PRIVILEGES U;
SELECT * FROM information_schema.VIEWS V; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T16:38:24.120

嗯，我还没有研究它包含的所有内容，但是 information_schema 中有很多[信息](http://dev.mysql.com/doc/refman/5.0/en/information-schema.html)。还有[show](http://dev.mysql.com/doc/refman/5.0/en/show.html)命令。

尽管如此，我还是没有看到一个命令来显示其中的所有外键。

# c# - (DataGridView + Binding)如何根据绑定的对象为线着色？

> ID：284420
> 
> 赞同：4
> 
> 时间：2008-11-12T16:06:10.707
> 
> 标签：c#, .net, winforms, .net-2.0, c#-2.0

我想根据绑定对象的属性为特定行添加背景色。

我拥有的解决方案（并且有效）是使用事件`DataBindingComplete`，但我认为这不是最好的解决方案。

这是事件：

```
 private void myGrid_DataBindingComplete(object sender, DataGridViewBindingCompleteEventArgs e)
    {

        for (int i = 0; i < this.myGrid.Rows.Count; i++)
        {
            if((this.myGrid.Rows[i].DataBoundItem as MyObject).Special)
            {
                this.myGrid.Rows[i].DefaultCellStyle.BackColor = Color.FromArgb(240, 128, 128);
            }
        }
    } 
```

还有其他更好的选择吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-12T17:22:01.303

您还可以将事件处理程序附加到 RowPostPaint：

```
dataGridView1.RowPostPaint += OnRowPostPaint;

void OnRowPostPaint(object sender, DataGridViewRowPostPaintEventArgs e)
{
    MyObject value = (MyObject) dataGridView1.Rows[e.RowIndex].DataBoundItem;
    DataGridViewCellStyle style = dataGridView1.Rows[e.RowIndex].DefaultCellStyle;

    // Do whatever you want with style and value
    ....
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T16:21:23.127

我并没有真正使用 WinForms，但是在 ASP 中你会使用 'ItemDataBound' 方法。DataGrid 的 Windows 窗体中是否有类似的东西？

如果是这样，在该方法中，事件参数将包含数据绑定的项目以及 DataGrid 行。所以一般代码看起来像这样（语法可能是关闭的）：

```
if(((MyObject)e.Item.DataItem).Special)
   e.Item.DefaultCellStyle.BackColor = Color.FromArgb(240, 128, 128); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T20:40:38.983

我建议几点：

*   看看在 _OnRowDatabound 修改你的行
*   不要在代码中设置颜色！！！这将是一个很大的错误。使用 attributes 属性并设置 cssclass。向仍在这样做的人挥手致意。

如果您在实施过程中遇到困难，请告诉我，我会发布一个片段。

# javascript - EXtjs 网格过滤器

> ID：284422
> 
> 赞同：5
> 
> 时间：2008-11-12T16:06:33.467
> 
> 标签：javascript, extjs

我是 Extjs 库的新用户，我成功创建了一个网格，它工作得很好，现在我想使用 Ext.grid.GridFilters 向我的网格添加过滤，但是我在 Extjs 源代码中没有看到这个类文件，我在哪里可以获得所需的文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T21:52:46.550

社区支持的网格过滤插件可在[此论坛帖子](http://extjs.com/forum/showthread.php?t=14503)中找到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T19:34:42.377

过滤是您必须自己实现的自定义事物。有一些社区插件可以轻松完成，但首先要查看实际的网格 STORE 而不是网格面板。存储包含数据并支持过滤。过滤数据后，存储将引发其数据更改事件，只要相应地连接网格，您就会在网格中看到过滤后的记录集。有关更多信息，我会查看他们的示例页面并阅读那里的源代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-08T23:41:08.413

如上所述：使用商店中的过滤方法。

[在http://aboutfrontend.com/2011/01/extjs-grid-filter/](http://aboutfrontend.com/2011/01/extjs-grid-filter/)上有一个涵盖该主题的教程

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-06T07:23:04.247

ExtJs 提供了适当的过滤器选项：

```
store.filterBy(function(rec, id)) { return (rec.get("RecName") =="FilterRecord");} 
```

过滤数据后，过滤器将始终存在于商店过滤器配置中。因此，如果我们想删除过滤器并显示所有记录，那么只需清除应用的过滤器，如下所示：

```
store.clearFilter(); 
```

# objective-c - 避免@property-itis（即过度使用属性，何时合适）？

> ID：284428
> 
> 赞同：9
> 
> 时间：2008-11-12T16:08:34.807
> 
> 标签：objective-c, cocoa

Objective-C 2.0 给了我们@properties。

*   他们允许内省。
*   它们允许声明式编程。
*   @synthesize 和@dynamic 机制使使用不必编写重复的、库存的访问器。
*   最后是“点”属性语法，有些人喜欢，有些人讨厌。

这不是我听到的要问的。像任何新功能一样，最初倾向于在任何地方使用@property。那么财产使用在哪里合适呢？

显然，在模型对象中，属性和关系是属性的好素材。

```
@property(...) NSString *firstName;
@property(...) NSString *lastName;
@property(...) Person *parent; 
```

即使是合成/计算的属性似乎也是属性的一个很好的用例。

```
@property(...) NSString *fullName; 
```

你还在哪里使用过属性？您在哪里使用过它们，后来又认为这是对该功能的不当使用？

您是否将属性用于私有对象属性？

你能想到任何在 Cocoa 中不是属性的东西的例子吗？乍一看，它们可能想要成为属性，但仔细检查后，实际上是滥用或属性炎的例子吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-12T17:28:27.810

我对人们的建议是尽可能使用财产。如果您在框架中工作，那么在现代运行时中使用非脆弱实例变量的能力是一个巨大的好处，如果您不是，属性可以清楚地说明如何管理您的 ivars（分配 vs 保留 vs 复制） . 除了编写代码行所花费的时间（我实际上使用 TextExpander 片段来为我执行此操作）之外，声明属性并没有固有的性能损失，但是防止错误的潜力足够大，以至于它变成了很棒的最佳实践。如果您确实计划使用私有 ivars 的属性，则可以通过`@interface`块在您的实现文件中执行此操作。例如

```
@interface MyObject()

@property(retain) NSArray *myArray;

@end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-12T18:17:05.687

如果我必须想出一个避免它们的理由，我会说不要将它用于所涉及的计算很重要的计算属性。属性鼓励如下代码：

```
if (foobar.weight > 100) {
    goober.capacity = foobar.weight;
} 
```

在这个例子中，`foobar.weight`被调用了两次。如果它只是返回一个缓存值，没问题。但是，如果它需要在每次部署机器人手动称重 foobar 时阻塞线程，那么上面的代码片段将在只需要一个机器人部署时浪费两个机器人部署。

在这种情况下，我建议不要使用属性，并以不同的方式命名方法，这样代码看起来更像：

```
int w = [foobar computeWeight];
if (w > 100) {
    goober.capacity = w;
} 
```

使用类似的名称`computeWeight`更容易记住这是一项长期运行的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T13:50:25.993

如果访问器方法对对象做了一些不明显的事情，比如设置一个不相关的实例变量，我会避免使用属性。此外，如果返回的属性并不真正“属于”该对象。例如，在我的一个项目中，我有一个`stringValue`方法，因此我决定不创建属性。不过，这实际上更像是一个风格问题。

# wpf - 奇怪的错误 - CS0012：类型 x 在未引用的程序集中定义

> ID：284433
> 
> 赞同：33
> 
> 时间：2008-11-12T16:09:40.123
> 
> 标签：wpf, user-controls, .net-2.0, assemblies, repeater

类型“x”在未引用的程序集中定义。您必须添加对程序集“abc123”的引用。

我有一个引用我的程序集“abc123”的 .NET 2.0 Web 应用程序。该程序集存在于 GAC 中，我已经验证它是正确的（相同的）版本。除了一个 .aspx 页面外，应用程序的其余部分没有问题。有问题的页面有一个转发器，它将用户控件显示为其“字段”之一。在将 y 类型的列表绑定到中继器后，我向用户控件传递了一个 x 类型的列表（y 的属性），如下所示：

```
<uc1:usercontrol id="ucusercontrol " runat="server" myPublicUserControlProperty='<%#Eval("CollectionOfX") %>'/> 
```

在用户控件的属性集上，我将 x 类型的列表绑定到用户控件中的 gridview。

需要注意的一件奇怪的事情是，该报告在我的开发电脑上运行良好，但在部署后无法在任何服务器上运行。我的电脑是 Windows XP、IIS6、VS2005。服务器是 Windows Server 2003、IIS6。

我希望我解释得足够好。提前感谢您提供的任何见解。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-11-12T19:32:54.487

我是迈克的同事，我们制定了解决方案。

X 类型在他的程序集中定义，即仅在 GAC 中。尽管他的 ASP.NET Web 应用程序确实有一个引用，但它无法从 GAC 仅为此 UserControl 加载。应用程序的其余部分按预期工作。我们通过将程序集的副本放在 bin 目录中来确认加载失败，并且一切正常。我们卸下了组件，问题又回来了。

我们的解决方案是手动在程序集部分的 web.config 中添加一个条目，以将 ASP.NET 指向 GAC。

看起来每当您在页面中引用类型（而不是代码隐藏）时，您都需要在 web.config 文件或页面指令中定义的程序集信息。

```
<assemblies>
        <add assembly="MyAssembly, Version=1.0.0.0, Culture=neutral, PublicKeyToken=[MyPublicKeyToken]"/>   
</assemblies> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T01:47:51.247

还有一个 bug 可以表现出类似的症状，描述[在这里](http://codebetter.com/brendantompkins/2006/11/15/fix-for-asp-net-could-not-load-file-or-assembly-app_web-error/)。

解决方法是删除 C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\ 目录中的所有内容，它似乎只在调试模式下表现出来。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-12T16:27:16.123

在对这些类型的问题进行故障排除时，[Fusion Log Viewer](http://msdn.microsoft.com/en-us/library/e74a18c4(VS.71).aspx)一直是一个很大的帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-02T11:01:24.663

我发现 if`type x`实际上是你的一个类`App_Code`，弄脏它并重新保存通常会迫使 Web 应用程序重新编译并解决问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-16T13:39:48.473

我遇到了完全相同的错误，但是我的类中有一个**公共**构造函数，它用作参数，来自另一个项目的对象。

我通过使该构造函数内部化解决了这个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-03-07T02:00:05.023

通常，这是因为缓存的程序集。解决此问题的一种方法是在项目或配置文件中进行“强引用”。参考这篇博[文](http://lavbox.blogspot.com/2011/03/type-systemxmlixmllineinfo-is-defined.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-07T00:14:12.250

对我来说，这是一个版本控制拉问题。

在 Visual Studio 中，在解决方案资源管理器中打开“参考”，然后滚动浏览它。

如果有任何东西上有黄色警告三角形，请记住名称，将其删除，然后重新添加（或让 ReSharper 为您完成）。

当一位同事添加一个新的包和引用时，在拉取一个项目后发生在我身上好几次。

# iis - 具有不同 .net 框架的虚拟目录

> ID：284434
> 
> 赞同：2
> 
> 时间：2008-11-12T16:09:47.377
> 
> 标签：iis, .net-2.0, frameworks, .net-1.1

是否可以在 IIS 中的同一网站下有两个虚拟目录，但虚拟目录使用不同版本的 .net 框架？

例如，在默认网站下，我可以有一个针对 2.0 框架的虚拟目录和第二个针对 1.1 框架的虚拟目录吗？

这是针对 IIS 6 的，谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T16:11:12.553

您不是说您使用的是哪个版本的 IIS，但对于 6.0 及更高版本，只需将它们分配给不同的应用程序池，并将池设置为使用正确版本的 .Net。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T16:14:20.050

您必须为这两个虚拟目录创建一个“应用程序”，然后使用网站属性下的 ASP.NET 选项卡分配它们的 ASP.NET 版本。

此外，正如@sunny 提到的，您需要有两个不同的应用程序池，并且每个虚拟目录都必须指向不同的应用程序池。因为不同版本的 ASP.NET 不能在同一个应用程序池中运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T16:23:59.407

这取决于您是否将它们标记为“应用程序”。应用程序虚拟目录可以使用不同的框架。确保将它们关联到不同的应用程序池。切勿在一个应用程序池中混合使用两个 .NET 框架版本。

*一个重要说明：*如果您将虚拟目录创建为应用程序，则不会共享会话状态和其他与应用程序相关的对象。此外，Server.MapPath("~") 和其他与 ServerURL 相关的方法的属性将指向虚拟目录的物理目录，而不是指向主根目录。

# .net - .NET 上的纪念品实现

> ID：284437
> 
> 赞同：3
> 
> 时间：2008-11-12T16:10:52.430
> 
> 标签：.net, design-patterns, memento

我在 .NET 上看到过两种不同的 memento 实现。

一个非常简单——对象创建了它自己的另一个实例。

另一种是使用 BinaryFormatter 和 MemoryStream 序列化对象。

哪个是首选方法？谁能指出每种方法的优缺点？

* * *

顺便说一句，我有兴趣从资源使用/开发人员生产力的角度来看待它。我很抱歉没有先说明这一点。

假设 memento 不需要持久化，哪个是首选？

从开发人员生产力的角度来看，序列化胜出。对于任何对象来说，几行通用的代码比手动创建一个可能涉及私有构造函数、字段分配等的克隆更有效。

但话又说回来，也许连载很重——我不确定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T16:20:40.273

我认为如何创建/存储备忘录的选择取决于您希望备忘录保留多长时间以及是否需要跨应用程序域传达该备忘录。如果备忘录只存在很短的时间并且只被同一个线程使用，那么克隆对象是合理的。如果纪念品需要持久化或传递给另一个应用程序域，那么序列化将是首选。如果纪念品寿命很长，您甚至可能希望将其序列化并将其存储在外部（在文件或数据库中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T16:16:33.993

如果要保留纪念品，请使用序列化方法

否则，克隆对象就可以了

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T16:21:49.350

叫我疯狂和低效，但我对 StringBuilder 和从字符串做我的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T12:40:44.047

通常 BinaryFormatter 和 MemoryStream 无需编写大量代码即可工作，但 Clone() 需要将代码添加到每个类中。

否则，如果不需要保留纪念品，我看不到可以在两种方法之间进行选择的匹配项

# ms-access - 阻止访问外部 ActiveX 控件中的鼠标滚轮行为

> ID：284438
> 
> 赞同：4
> 
> 时间：2008-11-12T16:10:59.247
> 
> 标签：ms-access, dll, mouse

在 Access (2002 / 2003) 数据绑定表单中，转动鼠标滚轮会移动到下一条/上一条记录，即使光标位于多行文本字段或列表框内。这对用户来说是一个主要的烦恼，不能轻易关闭。

我最近发现了一个名为 MouseHook ( [http://www.lebans.com/mousewheelonoff.htm](http://www.lebans.com/mousewheelonoff.htm) ) 的 DLL，它可以有效地阻止这种鼠标滚轮行为并将其替换为更多预期的行为。

但是，当将外部 ActiveX 控件添加到 Access 窗体时，此模块不执行任何操作。例如，我有一个带有 FlexGrid 控件的表单，它可以包含很多行。当用户尝试使用鼠标滚轮滚动时，Access 再次只是转到另一条记录，即使加载了 MouseHook DLL。

是否有类似 MouseHook DLL 但也适用于外部 ActiveX 控件的解决方案？或者 MouseHook DLL 的源代码是否可用，以便可以对其进行修改以处理像 FlexGrid 这样的控件？

PS：我想问一下 MouseHook DLL 的作者，但他目前“暂停”到 2009 年 6 月。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-13T07:42:41.597

如果您真的必须更改 UI 并更改用户期望鼠标滚轮工作的方式，我实际上建议您禁用它而不是更改它的滚动方式。虽然它的滚动对您来说可能看起来很奇怪，但这就是程序的工作方式。如果您必须整天阅读 PDF，然后有一天有人认为鼠标滚轮滚动的工作方式不够好并更改为默认为巨大的跳跃或水平或其他方式，您会怎么做。是的，它可能是一个更好的解决方案，但是它对用户来说很烦人，因为它没有做它应该做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T04:15:04.927

为什么在 Access 中使用 flexgrid？对我来说，这是一个读取标志，您可能正在以与 Access 敌对的观点来处理该项目，因为您似乎选择非本机控件来执行几乎总是使用 Access 的本机控件更容易完成的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T07:08:27.803

钩住 flexgrid，拦截 WM_MOUSEWHEEL 消息，忽略它并调用您的预期行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T22:50:09.877

不是直接回答您的问题，但我们处理鼠标滚轮移动的方式是防止用户开始编辑后意外更改记录。当用户打开表单时，轮子会像往常一样随意移动记录。一旦用户在字段上编辑某些内容，然后移动鼠标滚轮，就会触发 BeforeUpdate 事件，这会导致我们的代码提示他们必须先保存记录。我们有一个保存按钮，用户必须明确按下该按钮才能抑制更新前事件中的警告。

# apache-flex - Flex：如何加载数据，然后创建所需的组件？

> ID：284444
> 
> 赞同：0
> 
> 时间：2008-11-12T16:12:53.173
> 
> 标签：apache-flex, actionscript

我有一个具有三个选项卡的 flex 应用程序。这些选项卡中的每一个都有一个组件，该组件加载具有下拉组合框的“表单”。这些组合框依赖于外部数据才能正确填充。目前正在创建第一个选项卡，并且应该在组合框中填充的数据不在其中。第二个选项卡的组合框填充了所需的数据。

我想做的是创建一个在加载数据后调度的事件。当此事件发生时，我想创建这些选项卡或选项卡的组件。有没有办法在应用程序创建组件之前等待数据加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T17:23:53.703

您可以在 actionscript 中创建组件。

此代码将创建一个组合框：

```
var newBox = new ComboBox();
newBox.dataProvider = aDataProvider;
// 你可以使用 (v/h)box.addChild(newBox)
// 将其添加为特定元素的子元素
Application.application.addChild(newBox);

```

您可以使用这种技术在 actionscript 中创建组件，您仍然需要设置通常在 mxml 中设置的所有属性，但它们都具有相同的名称。

# .net - Microsoft Sync Framework 查询性能

> ID：284457
> 
> 赞同：4
> 
> 时间：2008-11-12T16:18:13.820
> 
> 标签：.net, synchronization

我们正在开发一种产品，该产品依赖于 Microsoft Sync Framework，以使客户端应用程序和服务器上的数据保持同步。我们注意到，当同步大约 16 个表和约 2200 条记录时，大约需要 4 分钟，这是不可接受的。

使用 SQL Server Profiler，我们发现它使用 sp_executesql 来执行查询。在没有 sp_executesql 的情况下运行时，特定查询会在 <1 秒内运行，但需要 10 秒以上。

所以问题是：我们做错了什么，我们可以做些什么来加速它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T02:10:55.967

sp_executesql 正在使用动态 sql。每一行都被单独处理。

4 分钟似乎很长，你应该看看你的 16 个表的设计并检查它们的性能。尝试使用执行计划来查看可能发生瓶颈的位置。

查看涵盖基础知识的此链接：

[SQL 执行计划基础知识](http://www.simple-talk.com/sql/performance/execution-plan-basics/)

尝试向下滚动到文章底部，那里有 SQL Management Studio 中实际图形界面的屏幕截图。文章有一些无聊的部分，但您至少可以看到图形执行计划及其好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-31T21:02:42.470

[MSDN 上Sync Framework 2.0](http://msdn.microsoft.com/en-us/library/bb902854(SQL.105).aspx)的“新增功能”部分列出了性能改进。

> **性能改进**
> 
> 此版本中的新数据库提供程序已经在大规模扩展场景中进行了全面测试，其中单个服务器支持数千个客户端和数百个并发同步操作。该测试导致大量内部性能改进，使 Sync Framework 数据库提供商能够像远程数据访问 (RDA) 等其他 Microsoft 技术一样执行，同时提供与合并复制等端到端解决方案竞争的广泛功能.

# c++ - 我应该对 Minidumps 使用哪些设置？

> ID：284459
> 
> 赞同：7
> 
> 时间：2008-11-12T16:18:39.077
> 
> 标签：c++, release, minidump

目前我们`MiniDumpWriteDump`用`MiniDumpNormal | MiniDumpWithIndirectlyReferencedMemory`旗帜打电话。这适用于 Debug 配置中的内部构建，但没有提供我们在 Release 配置中所需的那么多信息。

在 Release 中，minidump 数据包含足够的堆栈信息，以便调试器找出代码中发生故障的位置，但没有其他数据。我不仅仅意味着由于优化而丢失了局部变量，正如您在发布版本中所期望的那样 - 我的意思是，除了调用堆栈和当前代码行之外，没有任何用处。没有寄存器，没有局部变量，没有全局变量，没有局部变量指向的对象——什么都没有。我们甚至没有得到允许我们查看当前对象的“this”。这就是使用的重点`MiniDumpWithIndirectlyReferencedMemory`——它应该包含本地变量和堆栈变量引用的内存，但似乎没有。

我们应该改用什么标志？我们不想使用`MiniDumpWithFullMemory`并开始生成超过 600MB 的转储，但如果这意味着获得更多有用的数据，我们会很乐意将转储扩展到我们目前获得的 90KB 以上。也许我们应该使用`MiniDumpWithDataSegments`(globals) 或...？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-14T22:40:36.453

WinDbg 对 a 使用以下标志`.dump /ma`：

```
0:003> .dumpdebug
----- User Mini Dump Analysis

MINIDUMP_HEADER:
Version         A793 (62F0)
NumberOfStreams 13
Flags           41826
                0002 MiniDumpWithFullMemory
                0004 MiniDumpWithHandleData
                0020 MiniDumpWithUnloadedModules
                0800 MiniDumpWithFullMemoryInfo
                1000 MiniDumpWithThreadInfo
                40000 MiniDumpWithTokenInformation 
```

我建议你替换`MiniDumpWithFullMemory`为`MiniDumpWithIndirectlyReferencedMemory`.

# php - 为什么学说返回的领域比我要求的要多？

> ID：284463
> 
> 赞同：1
> 
> 时间：2008-11-12T16:20:22.113
> 
> 标签：php, mysql, orm, doctrine

我正在使用 Doctrine（1.0.3 版）来查看是否适合我正在编写的应用程序集合。

我正在尝试进行查询并仅返回 3 个字段。我在一个表中得到了正确的字段，但是当我只想要一个字段时，我得到了所有的连接表。我已经在 phpMyAdmin 中写出了 SQL 应该是什么，它只返回我需要的内容。

```
 31 $ftp_info = Doctrine_Query::create()
 32          ->select('f.uid, f.home, s.identifier')
 33          ->from('FtpUser f')
 34          ->leftJoin('f.Submitter s')
 35          ->where('f.uid = ?',500)
 36          ->execute();
 37
 38 print $ftp_info[0]->uid ."\n";
 39 print $ftp_info[0]->home ."\n";
 40 print $ftp_info[0]->Submitter->description ."\n";
 41 print $ftp_info[0]->Submitter->identifier ."\n"; 
```

当我没有在查询中要求它时，它给了我一个描述值。这两个表具有在适当的设置方法中定义的一对一关系。

我错过了什么的任何线索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T16:49:19.963

我认为它会在您请求时自动从数据库中延迟加载该字段。看[这里](http://www.doctrine-project.org/documentation/manual/1_0/?one-page#working-with-objects:fetching-objects:field-lazy-loading)

你也许可以`var_dump()`用结果来证实这一点

# sql - SQL 用户定义函数：获取用户定义函数中的 TOP n 记录

> ID：284468
> 
> 赞同：2
> 
> 时间：2008-11-12T16:20:42.283
> 
> 标签：sql, sql-server, sql-server-2000, user-defined-functions

为什么以下不起作用？

```
CREATE FUNCTION Test (@top integer)
RETURNS TABLE
AS
RETURN
SELECT TOP @top * FROM SomeTable
GO 
```

我只是希望能够指定要返回的结果数。[SQL 服务器 2000。]

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T16:44:13.127

对于 MS SQL 2000，您可以使用：

```
CREATE FUNCTION Test (@top integer)

RETURNS TABLE

AS

SET ROWCOUNT @top

RETURN SELECT * FROM SomeTable 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T16:25:00.153

对此的支持已添加到 SQL Server 2005，但在 2000 年不可用。您必须使用（颤抖）动态 sql 或其他一些数字技巧。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T16:28:55.653

CREATE FUNCTION 测试（@top 整数）

回报表

作为

返回

SELECT TOP (@top) * FROM SomeTable

去

但是，如果没有 ORDER BY 子句，它就不是很有意义（不能保证结果的顺序）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T16:31:38.550

糟糕，变量 TOP 在 SQL Server 2000 中不可用。任何版本也不支持动态 SQL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T16:45:24.700

杰克，尝试将行数设置为您的函数参数，然后进行选择。我没有试过这个，YMMV。

*来自： http: [//msdn.microsoft.com/en-us/library/aa259189 (SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa259189(SQL.80).aspx)*

句法

```
SET ROWCOUNT { number | @number_var }
Arguments

number | @number_var 
```

是在停止给定查询之前要处理的行数（整数）。

# wpf - 如何从 WPF 应用程序中的任何位置引发事件？

> ID：284472
> 
> 赞同：2
> 
> 时间：2008-11-12T16:21:37.383
> 
> 标签：wpf

我有一个基本页面 BasePage，它引发了一个向用户显示消息的事件。适用于从 BasePage 派生的所有页面。我想从用户控件做同样的事情，但他们不从 BasePage 继承。

我想要的是一个可以从任何地方调用的中心位置，并且在该代码中它将引发一个事件。哪里是放置此代码的好地方：

```
 public void DisplayMessage(string message)
    {
        RaiseEvent(new MessageNotificationEventArgs(MessageNotificationEvent, message));
    } 
```

这样我就可以从任何地方调用它？RaiseEvent 位于 UIElement 类中，因此它需要转到 UIElement 的某个位置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T16:35:21.803

而不是使用事件来做到这一点，你应该使用指挥 - 乔什史密斯写了一篇很棒的文章：http: [//joshsmithonwpf.wordpress.com/2008/03/18/understanding-routed-commands/](http://joshsmithonwpf.wordpress.com/2008/03/18/understanding-routed-commands/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T18:39:36.757

解决问题的一种方法是使用[Event Aggregator](http://martinfowler.com/eaaDev/EventAggregator.html)。模式本身是平台无关的。

Jeremy Miller 有一篇关于[在此处](http://codebetter.com/blogs/jeremy.miller/archive/2008/01/11/build-your-own-cab-extensible-pub-sub-event-aggregator-with-generics.aspx)构建您自己的事件聚合器的帖子。

**但是，[Composite WPF](http://www.codeplex.com/CompositeWPF)（以前的 Prism）可以做到这一点，并且针对 WPF 进行了优化。**具体可以在[这里](http://msdn.microsoft.com/en-us/library/cc707857.aspx)找到。

# html - CSS 表格样式

> ID：284475
> 
> 赞同：6
> 
> 时间：2008-11-12T16:21:40.287
> 
> 标签：html, css, rounded-corners, css-tables

我需要将桌子设计成圆角。

我只是在看看如何最好地去做：

通常，当我将 div 样式设置为圆角时，我会使用 2 个 div，顶部和底部带有空注释，并对其应用尺寸和背景图像 CSS。

然而，表格有内部边框，所以我必须仔细对齐角落 bg 图像中的垂直线，以匹配真正的单元格边框。

到目前为止，这清楚吗？

所以我想知道其他人会如何处理这个问题。我认为我能做的最好的事情就是只使用一个完整的固定大小的背景图像、边框和所有内容，并在顶部覆盖一个无边框的表格。毕竟桌子总是一样大的。

谁能想到更好的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T16:42:11.133

25 种方法...... [http://www.cssjuice.com/25-rounded-corners-techniques-with-css/](http://www.cssjuice.com/25-rounded-corners-techniques-with-css/)

实际上，有太多的方法可以做到这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T16:26:15.473

你最好制作一个只有角落而不是边框​​的背景图像。将一个类应用于左上角、右上角、左下角和右下角单元格，以定义应使用角背景图像。

并使用 css 设置边框样式。不要将它们放在背景图像中。

在您的方法中，您最终将始终使背景图像中的垂直线与实际表格单元格的边框不匹配。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T16:27:54.017

你试过[http://www.roundedcornr.com/](http://www.roundedcornr.com/)吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T16:28:32.783

~~更好的方法是 9 网格，其中您有背景角，并且顶部、底部、左侧和右侧背景重复~~

~~您的表格进入单元格 5~~

# 编辑

正如一些在评论中发布的那样，您无法使用 9-grid 实现效果。你必须做一个 12 网格系统（由我现在组成 :)

## [现场演示](http://www.bizcacha.com/public/twelve-grid/roundedtable.htm)

.

## 代码：

*警告：它不漂亮，但有效*

```
<html>
<head>
    <style>

        .cell1 {background: #f8f8f8 url(images/cell1.gif) no-repeat left top; height: 10px; font-size: 1px;}
        .cell2 {background: #f8f8f8 url(images/cell2.gif) repeat-x top; height: 10px; font-size: 1px; border-right: solid 1px #c3c2c2; font-weight:bold;  }
        .cell3 {background: #f8f8f8 url(images/cell3.gif) no-repeat right top; height: 10px; font-size: 1px;}

        .cell4 {background: white url(images/cell4.gif) repeat-y left; border-bottom: solid 1px #c3c2c2; width: 13px; }
        .cell5 {background-color: #f8f8f8; padding: 5px; border-right: solid 1px #c3c2c2; font-weight:bold; border-bottom: solid 1px #c3c2c2; }
        .cell6 {background: white url(images/cell6.gif) repeat-y right; border-bottom: solid 1px #c3c2c2; width: 18px; }

        .cell7 {background: white url(images/cell7.gif) repeat-y left; width: 13px;}
        .cell8 {background-color: white; padding: 5px; border-right: solid 1px #c3c2c2; font-weight:normal;  }
        .cell9 {background: white url(images/cell9.gif) repeat-y right; width: 18px;}

        .cell10 {background: white url(images/cell10.gif) no-repeat left bottom; height: 17px;font-size: 1px; }
        .cell11 {background: white url(images/cell11.gif) repeat-x bottom; border-right: solid 1px #c3c2c2; height: 17px; font-size: 1px; }
        .cell12 {background: white url(images/cell12.gif) no-repeat right bottom; height: 17px;font-size: 1px; }

        .lastcolumn, th.lastcolumn, td.lastcolumn {border-right: solid 0px #c3c2c2; }

    </style>
</head>
<body>

<table id="pricing" border="0" cellpadding="0" cellspacing="0">
  <thead>
    <tr>
      <th class="cell1"></th>
      <th class="cell2">&nbsp;</th>
      <th class="cell2">&nbsp;</th>
      <th class="cell2">&nbsp;</th>
      <th class="cell2">&nbsp;</th>
      <th class="cell2">&nbsp;</th>
      <th class="cell2 lastcolumn">&nbsp;</th>
      <th class="cell3"></th>
    </tr>
    <tr>
      <th class="cell4">&nbsp;</th>
      <th class="cell5">Incoming calls</th>
      <th class="cell5">National calls</th>
      <th class="cell5">Calls to US &amp; Canada</th>
      <th class="cell5">Calls to other Phones</th>
      <th class="cell5">Calls to other Countries</th>
      <th class="cell5 lastcolumn">SMS text messages</th>
      <th class="cell6">&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="cell7"></td>
      <td class="cell8">Select</td>
      <td class="cell8">country</td>
      <td class="cell8">from</td>
      <td class="cell8">dropdown</td>
      <td class="cell8">list</td>
      <td class="cell8 lastcolumn">above</td>
      <td class="cell9"></td>
    </tr>
    <tr>
      <td class="cell10"></td>
      <td class="cell11">&nbsp;</td>
      <td class="cell11">&nbsp;</td>
      <td class="cell11">&nbsp;</td>
      <td class="cell11">&nbsp;</td>
      <td class="cell11">&nbsp;</td>
      <td class="cell11 lastcolumn">&nbsp;</td>
      <td class="cell12"></td>
    </tr>
  </tbody>
</table>

</body>
</html> 
```

*注意：SO 从代码中删除了一些不间断的空格。查看现场演示以获取更多信息*

享受！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T16:38:41.280

做这样的事情...

XHTML：（抱歉必须删除第一个'<'，因为它不会让我正常发布它，FIX THIS JEFF！）

```
table id="pricing" border="0" cellpadding="0" cellspacing="0">
  <thead>
    <tr>
      <th>Incoming calls</th>
      <th>National calls</th>
      <th>Calls to US &amp; Canada</th>
      <th>Calls to other Phones</th>
      <th>Calls to other Countries</th>
      <th>SMS text messages</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Select</td>
      <td>country</td>
      <td>from</td>
      <td>dropdown</td>
      <td>list</td>
      <td>above</td>
    </tr>
  </tbody>
</table> 
```

CSS：#pricing { 字体重量：粗体；文本对齐：中心 }

```
 #pricing thead
  {
    background-image:url("images/pricing_top.gif");
    background-position:top;
    background-repeat:no-repeat;
    padding:10px 0 0 /* replace 10px with the height of pricing_top.gif */
  }

  #pricing th
  {
    background-image:url("images/pricing_header_bg.gif");
    background-repeat:repeat-y;
    border-bottom:1px solid #c3c2c2;
    width:100px /* replace 100px with the width of pricing_header_bg.gif */
  }

  #pricing tbody
  {
    background-image:url("images/pricing_bottom.gif");
    background-position:bottom;
    background-repeat:no-repeat;
    padding:0 0 10px /* replace 10px with the height of pricing_bottom.gif */
  }

  #pricing td
  {
    background-image:url("images/pricing_cell_bg.gif");
    background-repeat:repeat-y;
    width:100px /* replace 100px with the width of pricing_cell_bg.gif */
  } 
```

唯一的缺点是您必须创建 4 个图像，但这不会花费太长时间。如果您想在右侧添加阴影并相应地更改它的背景图像和宽度属性，您还需要在每行的最后一个单元格中添加一个类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-12T20:07:45.463

发挥您最初的想法，您可以为每个角落单元格添加一个类，有效地关闭它们各自的违规边界。然后，您可以在 <thead> 和 <tfoot> 元素中使用全角背景图像来解决圆角问题。

其余单元格的边框可以打开，线条将正确排列。

剩下的唯一问题是解释那个爆炸的阴影。那是一个不同的练习。

# open-source - 有人知道任何知识库开源吗？

> ID：284477
> 
> 赞同：40
> 
> 时间：2008-11-12T16:22:09.240
> 
> 标签：open-source, knowledge-management

我想为我们的呼叫中心建立一个基于网络的知识库系统。为了节省一些开发时间，我正在寻找一个开源。有人知道那里有什么好的吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-12T16:23:09.767

众多维基中的一个怎么样？

Kenny：我使用过 FlexWiki 和 ScrewTurn（已弃用）。

使用 RepPower 编辑我的帖子的其他人添加了此内容。
维基百科由[MediaWiki](http://en.wikipedia.org/wiki/MediaWiki)提供支持。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-12T16:33:59.653

我用过[phpMyFAQ](http://www.phpmyfaq.de/)，发现它非常好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-03-11T05:17:40.873

由于我没有足够的声望点来评论 Bruno Shine 的答案，我将添加此注释作为新答案。

KBPublisher 2.0 在 Sourceforge 上仍然可用：http: [//sourceforge.net/projects/kbpublisher/](http://sourceforge.net/projects/kbpublisher/)

该项目多年未更新。从 v1.9 或其他版本开始，我一直在运行它，并且运行良好。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-12T16:45:34.747

除了 Kenny 提到的 MediaWiki，您还可以查看[MoinMoin](http://moinmo.in/)。

在 MediaWiki 和 MoinMoin 之间进行选择可能有点困难。以下是需要考虑的几点：

## 媒体维基

### 优点：

*   为维基百科制作，因此非常成熟和可扩展。
*   相当容易设置。

    ### 缺点：

*   **专**为维基百科制作。因此，自定义您喜欢的方式可能会有点痛苦。

## 莫因莫因

### 优点：

*   很成熟的软件。
*   大量可用的插件和第三方模块。

    ### 缺点：

*   安装起来可能很痛苦。

有大量其他 wiki 可用，但我会考虑这些是主要的两个。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-04-27T20:34:20.270

我相信[phpMyFAQ](http://www.phpmyfaq.de/)是迄今为止我见过的最有用的知识库（来自开源）。它是一个简单、直接的知识库软件，它是 PHP => 可以很容易地安装在任何服务器上，如果你懂一点 php 可以定制。此外，它变得足够简单，但具有正确的优先级和逻辑。我建议安装它并使用它，我做到了，我决定继续使用这个 KB。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-12T16:27:35.080

另外，请考虑[GForge](http://gforge.org/)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-09-01T07:26:31.380

根据我对这个知识库软件的个人经验，我也想加入“Julien H”。从[http://www.knowledgebase-script.com建议 PHPKB](http://www.knowledgebase-script.com)

我个人认为它是最好的之一。许多功能，不断开发，出色的支持和 GUI 简单而出色。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-11-30T15:52:48.393

又一次投票支持 PHPKB 知识库软件。我们从 StackOverflow 上的这篇文章中了解到 PHPKB，并按照 Julien 和 Ricardo 的推荐购买了它。我很高兴地告知这是一个正确的决定。尽管我们必须根据我们的需求定制某些功能，但他们的支持团队超出了我们的预期。所以，我只是想在这里分享新闻。我们对 PHPKB 知识库软件非常满意。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-12T16:37:20.300

我听说过[RTM](http://bestpractical.com/rtfm/)（RT 常见问题管理器）。但是，从未使用过它。

# c# - 静态类的范围是什么？

> ID：284491
> 
> 赞同：19
> 
> 时间：2008-11-12T16:25:57.907
> 
> 标签：c#, static, biztalk, applicationdomain

我有一个程序集，一次可以由多个进程使用。如果我使用的是静态类，多个进程是否都使用该类的相同“实例”？

由于进程是分开的，它们会在不同的应用程序域下运行，因此静态“实例”是否分开？

此处详细信息中的布丁是该程序集正由一个自定义 BizTalk 适配器使用，我将其设置为并行批处理消息。这就是我上面所说的“多进程”。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-12T16:30:32.653

每个应用程序域存在一次静态类。在您的情况下，这取决于适配器是在同一应用程序域中使用多个线程（因此共享静态类的单个实例）还是使用多个进程（因此具有静态类的单独实例）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-12T16:30:36.680

多个线程将共享一个实例。出于这个原因，静态类可以方便地在线程之间传递状态，但是您需要非常小心不要引入竞争条件（`Monitor`或`lock`您的属性）。

但是，多个*进程*应该位于不同的 AppDomain 中，因此每个进程都有自己的实例。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-12T16:31:20.703

*“我有一个程序集可能一次被多个进程使用。如果我使用的是静态类，多个进程是否都使用该类的相同“实例”？*

不，它们都有单独的实例。

*“由于进程是分开的，它们会在不同的应用程序域下运行，因此静态“实例”是否分开？”*

是的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-12T16:31:13.463

静态类的范围仅限于应用程序域。每个应用程序域都将拥有自己可能拥有的任何静态变量的副本。如果您的“进程”是同一应用程序域中的线程，那么它们将共享静态值。但是，如果它们是实际独立的 Windows 进程，那么它们将具有不同的应用程序域，因此会有不同的副本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-12T20:50:27.717

您可能想查看单例模式。要点似乎是您要控制服务实例的数量。

我猜您想要一个单独的 dll/项目来服务所有客户端请求。您可以使用静态类/单例/多例来实现所需的功能。这实际上取决于您要完成的工作。

# c# - WindowsPrincipal.IsInRole() 未返回预期结果

> ID：284500
> 
> 赞同：3
> 
> 时间：2008-11-12T16:28:49.443
> 
> 标签：c#, security, active-directory, security-roles, iprincipal

所以这是我当前的代码：

```
List<string> rowGroups = GetFileGroups((int)row.Cells["document_security_type"].Value);
bool found = false;
System.Security.Principal.WindowsPrincipal p = new System.Security.Principal.WindowsPrincipal(System.Security.Principal.WindowsIdentity.GetCurrent());

foreach (string group in rowGroups)
{
  if (p.IsInRole(group))
  {
    found = true;
    break;
  }
} 
```

这是几个月前有人完成的，我很难理解为什么它不起作用。该公司最近刚刚从一个域名转移到另一个域名。所以我很好奇 p.IsInRole("String") 函数将使用什么域控制器。我假设无论计算机使用什么，它都会使用默认 DC。

奇怪的是，办公室中运行此程序的计算机可能位于 2 个单独的域中。在`List<string>`对象中，我有两个可能的域。因此它可以包含诸如“domainA\groupA”、“domainA\userB”、domainB\groupC 和/或“domainB\userD”之类的项目。

所以我的主要问题是 IsInRole 函数永远不会返回 true。我知道它应该，我什至用 domainA\Domain 用户对其进行了测试，但仍然得到一个错误的返回。

有任何想法吗？更改代码是可能的，但不是想要的。我不是 100% 我什至可以编译它...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-12T20:01:20.653

我必须指出，你真的在​​你的字符串中正确地转义了你的 '\' 字符吗？就像在“domainA\\groupA”中一样？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T19:41:20.517

好吧，要解决这个问题，我只需要专门添加组的每个用户而不是组名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T19:51:44.100

当人们尝试在 Active Directory 中使用 Outlook 电子邮件列表来实现基于角色的安全性时，我发现了一些问题。这些出现在 Active Directory 中，很难与实际的安全组（您可以在 ACL 中引用的安全组等）区分开来。让您的管理员验证您使用的任何组是安全组。

# proxy - 在访问外部 Web 服务 (.NET 2.0) 之前获取代理配置

> ID：284511
> 
> 赞同：2
> 
> 时间：2008-11-12T16:32:02.480
> 
> 标签：proxy, c#-2.0

当尝试调用外部 Web 服务（通过 Internet）上的方法时，它会抛出“远程服务器返回错误：(407) 需要代理身份验证。”

为了解决这个问题，我使用以下代码来设置我们在办公室使用的代理：

```
//Set the system proxy with valid server address or IP and port.
System.Net.WebProxy pry = new System.Net.WebProxy("MyHost", 8080);

//The DefaultCredentials automically get username and password.
pry.Credentials = System.Net.CredentialCache.DefaultCredentials;
System.Net.WebRequest.DefaultWebProxy = pry; 
```

这工作正常，但现在......我需要做“更少的编码”，试图从我的系统中获取信息，而不是手动设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T16:39:59.907

这将使用我认为的 IE 的默认代理（未弃用）：

```
Services.MyService service = new Services.MyService();
service.UseDefaultCredentials = true;
service.Proxy = new System.Net.WebProxy();
service.Proxy.Credentials = service.Credentials; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T16:36:15.187

System.Net.WebProxy.GetDefaultProxy() 虽然 VS 警告它已被弃用。

# git - 什么是 git 主题分支？

> ID：284514
> 
> 赞同：147
> 
> 时间：2008-11-12T16:32:35.333
> 
> 标签：git, version-control, branch

什么是 git 主题分支？它在某些方面与普通分支有什么不同吗？是否有任何不是主题分支的分支？

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2008-11-12T18:16:52.330

主题分支通常是您在本地创建并且具有对*您*有意义的名称的轻量级分支。它们是您可能为预计需要一些时间才能完成的错误修复或功能（它们也称为功能分支）工作的地方。

另一种分支是“远程分支”或“远程跟踪分支”。这种类型的分支跟随*别人*工作的发展，并存储在您自己的存储库中。您定期更新此分支（使用`git fetch`）以跟踪其他地方发生的情况。当您准备好赶上其他人的更改时，您将使用`git pull`fetch 和 merge。

我还看到了另一种分支，它本质上是同一存储库中完全独立的文件树。例如，[Git 存储库本身](http://repo.or.cz/w/git.git/)包含名为[man](http://repo.or.cz/w/git.git?a=tree;h=refs/heads/man;hb=man)和[html的头，它们包含与](http://repo.or.cz/w/git.git?a=tree;h=refs/heads/html;hb=html)[master](http://repo.or.cz/w/git.git?a=tree;h=refs/heads/master;hb=master)分支完全不同的内容。我不知道这些类型的分支通常被称为什么。

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2008-11-12T17:03:24.773

这不是一个技术术语。它只是指为实现特定功能或修复错误而创建的分支。“主题”本质上是创建分支的原因。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2011-11-12T18:49:26.493

[https://github.com/dchelimsky/rspec/wiki/Topic-Branches](https://github.com/dchelimsky/rspec/wiki/Topic-Branches)很好地解释了这一点：

> “主题”分支是您在处理单个“主题”（错误修复、新功能或实验性想法）时使用的单独分支。建议使用主题分支而不是直接在“master”之上工作，因为：
> 
> {...访问链接...}
> 
> 因此，出于所有这些原因，建议使用主题分支来准备提交，即使是简单的贡献，如单次提交错误修复等。

该示例还提供了示例。这实际上让我想到，这可能是大多数商店已经在做的事情。我参与过的所有敏捷项目都是如此。我赞成“这不是一个技术术语”，因为我觉得这很中肯。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-13T17:40:32.897

> 看起来不是主题分支的最突出和最重要的分支类型将是主要的公开可用存储库上的发布分支，对吗？

这可能适合你，但那是关于你和你正在考虑的项目；它不是由 Git 决定的。

大多数版本控制系统（尤其是集中式系统）规定或强制执行特定的工作流程，包括使用分支的意义。Git（以及在某种程度上大多数分布式 VCS）认为工作流、使用什么分支、何时提交、使用什么不同的 repos 等等都是由用户和用户之间的协议（策略）选择的。所以 Git 并没有在技术上强制执行这些。

这是让我难以学习 Git 的原因之一。Oliver Steele 从用户的角度解释了这一点，写了关于[Commit Policies](http://blog.osteele.com/posts/2008/05/commit-policies/)的文章。

# .net - .NET ODBC DataProvider 从不通过 Transoft ODBC 驱动程序连接

> ID：284515
> 
> 赞同：3
> 
> 时间：2008-11-12T16:32:57.313
> 
> 标签：.net, odbc, transoft

我有一个用.Net 编写的Windows 服务。在我们当前的实现中，我们正在与 Transoft ODBC 进行交互。我已经实现了日志记录，基本上，当我们打开 ODBC 连接时，它永远不会连接。永远不要出错或任何事情。

我们已经能够通过 Access 连接到数据库，因此我们知道连接工作正常，并且 ODBC 驱动程序设置正确。

我在实际的 Connection 对象上找不到超时，或者我可以调整以使连接正常工作的任何其他内容。

```
 Dim ODBCConn As New Data.Odbc.OdbcConnection(ConnString)
    ODBCConn.Open() 
```

对可能发生的事情有任何想法或见解吗？

谢谢，布赖恩斯旺森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-21T15:43:03.353

试试这个连接：

```
OdbcConnection objJAMIS = new OdbcConnection("dsn=" + szDSN); 
```

其中 szDSN 是您在 odbc 连接中定义的 DSN。

# database - 失忆症患者的“第一”功能性语言？（我真的很喜欢 Clojure ......）

> ID：284518
> 
> 赞同：20
> 
> 时间：2008-11-12T16:33:17.377
> 
> 标签：database, functional-programming, clojure, webserver, artificial-intelligence

我最近被诊断出患有级联分离障碍，除了现有的可能的顺行性健忘症病例外，还会导致逆行性健忘症。许多人试图提醒我，我以前是一个多么伟大的程序员——现在我知道了概念和习语，但无论我是否知道，我都想自学。我想我可以部分克服健忘症的问题。

我的问题是，stackoverflow，我最近发现了 Clojure，它......使用起来感觉很好，即使只是从我能找到的任何网页上复制示例。我学习函数式编程语言的目标是创建一个简单的网络服务器、一个 irc AI bot 和一个类似 couchdb 的数据库系统，所有这些都是轻量级的，专门用于教育。Clojure 有哪些缺陷？现在是否有更好的函数式编程语言可用于教育/和/应用程序？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-13T07:37:39.937

我认为 Clojure 是一种非常好的语言。如果我应该指出任何缺陷，那就是它非常新，即使该语言看起来非常成熟并且可以生产，但围绕它的工具和框架却不是。因此，例如，如果您要制作一个 Web 应用程序，不要期望触发三个命令并在您的浏览器上显示“您的第一个 Web 应用程序正在运行，现在阅读此文档以创建您的模型”页面。

用 Clojure 编写的库也不多，但如果您认为几乎可以使用用 Java 编写的任何东西，这并不是一个大问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-12T17:38:32.267

[Haskell](http://www.haskell.org/)目前拥有大量的追随者和不断增长的[库和应用程序](http://hackage.haskell.org/packages/hackage.html)基础。它也用于教育和研究。我发现它是一种非常好用的语言。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-30T20:39:36.527

Haskell、Erlang 和[Clojure](http://clojure.org)都是不错的选择。我个人会推荐 Clojure，你也许可以使用属于 Clojure 的软件事务内存系统做一些有趣的数据库工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-12T17:40:49.003

你在你的问题中列出了 CouchDB，它是用[Erlang](http://en.wikipedia.org/wiki/Erlang_(programming_language))编写的，一旦你进入它，这意味着它是一种非常引人入胜的语言。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-02T08:54:40.993

我没有使用 Clojure 的个人经验，但我真的推荐[F#](http://msdn.microsoft.com/en-us/fsharp/default.aspx)。[它是OCaml](http://en.wikipedia.org/wiki/OCaml)风格中相当强大的语言。我真的很喜欢它，因为它的调试工具和 IDE 是首屈一指的，而且您几乎可以利用（巨大的）.NET 平台上的每个库。

# c - 我可以在 C 中分配特定数量的位吗？

> ID：284519
> 
> 赞同：13
> 
> 时间：2008-11-12T16:33:20.387
> 
> 标签：c, malloc, bitmask

我正在尝试存储大量在运行时确定的布尔信息。我想知道最好的方法可能是什么。

我目前一直在尝试使用以下方法分配内存：

`pStatus = malloc((<number of data points>/8) + 1);`

认为这会给我足够的工作。然后我可以使用数组表示法中的指针引用每个布尔值：

`pStatus[element]`

不幸的是，这似乎效果不佳。首先，我很难将内存初始化为整数值`0`。这可以使用`memset()`吗？不过，我认为这不会影响我在尝试访问时崩溃的原因`pStatus[element]`。

我也不完全相信这种方法是最好的方法。我真正想要的本质上是一个反映布尔值状态的巨大位掩码。我错过了什么吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-11-12T16:40:25.270

```
pStatus = malloc((<number of data points>/8) + 1); 
```

这确实为您的位分配了足够的字节。然而，

```
pStatus[element] 
```

这将访问元素的第*字节*，而不是位。因此，当元素超过总位数的八分之一时，您将访问分配的数组的末尾。

我会定义一些辅助函数

```
int get_bit(int element)
{
    uint byte_index = element/8;
    uint bit_index = element % 8;
    uint bit_mask = ( 1 << bit_index);

    return ((pStatus[byte_index] & bit_mask) != 0);
}

void set_bit (int element)
{
    uint byte_index = element/8;
    uint bit_index = element % 8;
    uint bit_mask = ( 1 << bit_index);

    pStatus[byte_index] |= bit_mask);
}

void clear_bit (int element)
{
    uint byte_index = element/8;
    uint bit_index = element % 8;
    uint bit_mask = ( 1 << bit_index);

    pStatus[byte_index] &= ~bit_mask;
} 
```

（为了清楚起见，对元素范围的错误检查。你也可以制作这个宏）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-12T16:38:29.487

*...认为这会给我足够的工作。然后我可以使用数组表示法中的指针引用每个布尔值：*

```
pStatus[element] 
```

元素是寻址*字节*，而不是位。你想要这样的东西：

```
pStatus[element/8] & (1 << (element % 8)) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-13T17:00:00.843

小点：要获得足够的内存来存储 N 位，(N/8) + 1 字节是不精确的（可以是一个太多）。

但是，(N+7)/8 始终是最小数字。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-12T16:39:30.187

好吧，最简单的答案是使用 calloc 而不是 malloc。

它被定义为将它分配的内存初始化为零，并且通常可以通过使用页面映射技巧来做到这一点。

这将解决您的内存初始化问题。这里的其他十几个帖子似乎充分解决了索引问题以及您偶尔分配一个额外字节的事实（哦，太可怕了！），所以我不会在这里重复他们的内容。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-12T16:40:15.600

pStatus[element] 将为您提供该地址的整个字节。

要设置特定元素，您可以执行以下操作：

```
pStatus[element >> 3] |= 1 << (element & 7); 
```

要重置元素：

```
pStatus[element >> 3] &= ~1 << (element & 7); 
```

并测试一个元素：

```
if (pStatus[element >> 3] & (1 << (element & 7)) != 0) 
```

初始分配应该是

```
pstatus = malloc((<number of data points> + 7) / 8) 
```

您所拥有的将起作用，但偶尔会浪费一个字节

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-13T16:38:54.130

我不禁注意到，这里的 C 语言中的所有回复似乎都假设一个字节是 8 位。这在 C 语言中不一定是正确的（尽管在大多数主流硬件上当然是正确的），所以在代码中做出这种假设是相当糟糕的形式。

编写架构中立代码的正确方法是

```
#include <limits.h> 
```

然后`CHAR_BIT`在需要“a 中的位数”的任何地方使用宏`char`。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-12T16:54:53.497

让自己更快乐，并定义一个类型和函数来对该类型进行操作。这样，如果您发现位访问太慢，您可以将每个布尔值的内存单位更改为字节/字/长，或者如果内存确实是一个问题（即，如果您的集合大多为零），则可以采用稀疏/动态数据结构，您可以只保留一个包含 1 坐标的列表。

您可以编写代码以完全不受位向量实现更改的影响。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-12T16:38:16.883

pStatus[element] 不寻址该位。它得到的确切字节取决于 pStatus 的类型——我假设是 char* 或等效的——所以 pStatus[element] 为你提供了第元素字节。

您可以将 memset 设置为 0，是的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-12T16:39:09.253

```
 pStatus = malloc((<number of data points>/8) + 1); 
```

那部分没问题。

```
 pStatus[element] 
```

这就是你遇到麻烦的地方。当您想要寻址位时，您是地址字节。

```
 pStatus[element / 8 ] 
```

将为您提供数组中的正确字节。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-12T16:40:36.473

您需要分配`c = malloc((N+7)/8)`字节，您可以使用

```
 c[n/8]=((c[n/8] & ~(0x80 >> (n%8))) | (0x80>>(n%8))); 
```

清除

```
 c[n/8] &= ~(0x80 >> (n%8)); 
```

并测试

```
 if(c[n/8] & (0x80 >> (n%8))) blah(); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-12T17:22:46.717

如果您不介意编写包装器，您也可以使用 C++ 的 STL 中的 bit_set 或 bit_vector，看起来它们（尤其是后者）正是您需要的，已经编码、测试和打包（以及大量的花里胡哨）。

很遗憾，我们缺乏在 C 应用程序中使用 C++ 代码的直接方式（不，创建包装器对我来说并不简单，也不有趣，从长远来看意味着更多的工作）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-20T22:46:57.893

会有什么问题`std::vector<bool>`？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-03T19:14:43.877

令我惊讶的是，这里只有一个答案提到了 CHAR_BIT。一个字节通常是 8 位，但并非总是如此。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2008-11-12T16:42:54.737

您的分配代码是正确的，请参阅[此答案](https://stackoverflow.com/questions/177054/is-there-a-practical-limit-to-the-size-of-bit-masks#177092)`set_bit()`中给出的和`get_bit()`函数来访问布尔值。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2008-11-12T17:14:56.450

布尔值在 C 中“从不”是一个单独的值。所以一个结构可能是为了让你继续前进。

确实，您没有初始化 mem 区域，因此您需要单独执行此操作。

这是一个简单的示例，说明如何使用联合结构和枚举来做到这一点

```
typedef unsigned char           BYTE;
typedef unsigned short          WORD;
typedef unsigned long int       DWORD;
typedef unsigned long long int  DDWORD;
enum STATUS
{
    status0 = 0x01,
    status1 = 0x02,
    status2 = 0x04,
    status3 = 0x08,
    status4 = 0x10,
    status5 = 0x20,
    status6 = 0x40,
    status7 = 0x80,
status_group = status0 + status1 +status4
};
#define GET_STATUS( S ) ( ((status.DDBuf&(DDWORD)S)==(DDWORD)S) ? 1 : 0  )
#define SET_STATUS( S ) (  (status.DDBuf|=  (DDWORD)S) )
#define CLR_STATUS( S ) (  (status.DDBuf&= ~(DDWORD)S) )
static union {
 BYTE   BBuf[8];
 WORD   WWBuf[4];
 DWORD  DWBuf[2];
 DDWORD DDBuf;
}status;

int main(void)
{
    // Reset status bits
    status.BBuf[0] = 0;
    printf( "%d \n", GET_STATUS( status0 ) );

    SET_STATUS( status0 );
    printf( "%d \n", GET_STATUS( status0 ) );

    CLR_STATUS(status0);
    printf( "%d \n", GET_STATUS( status0 ) );
    SET_STATUS( status_group );
    printf( "%d \n", GET_STATUS( status0 ) );
    system( "pause" );
    return 0;
} 
```

希望这可以帮助。此示例最多可以处理 64 个状态布尔值，并且可以轻松扩展。

此示例基于 Char = 8 bits int = 16 bits long int = 32 bits 和 long long int = 64 bits

我现在还添加了对状态组的支持。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2008-11-13T08:54:55.693

如果您仅限于几个位，您可以代替 eaanon01 解决方案，还可以使用位域的 c 内置工具（很少有场合可以使用它们，但这就是其中之一）

对于这个有点敲击的东西，我可以推荐：Herny Warrens “Hacker Delight”

# apache-flex - 在你的 Flex 代码中去掉 mx: 是不是一个坏主意？

> ID：284530
> 
> 赞同：3
> 
> 时间：2008-11-12T16:37:35.463
> 
> 标签：apache-flex, actionscript

我是 Flex 的新手，我不喜欢你必须为你编写的每个控件声明编写命名空间 mx: 的方式。它使代码混乱。我想写：

```
<Panel ... 
```

而不是

```
<mx:Panel ... 
```

我试着写

```
xmlns="http://www.adobe.com/2006/mxml" 
```

对于顶级元素而不是

```
xmlns:mx="http://www.adobe.com/2006/mxml" 
```

在顶层声明中。这项工作在一定程度上有效，但破坏了一些现有代码。一方面，文档中定义的 XML 数据都附加了 aaa: 作为运行时的命名空间。我还注意到我非常小的示例程序中的其他问题。

有没有办法做到这一点，或者这是一个失败的原因？以及一些关于为什么的背景信息将不胜感激。

*更新：感谢大家的回复，但我想听听实际尝试过这个并认为这很重要的人的意见。尽管你们中的大多数人告诉我这是一个坏主意，但我并不气馁。我现在有几个程序以这种方式顺利运行。并计划在我所有的 flex 应用程序中执行此操作。一个技巧似乎对我有用，尽管我不能声称它会普遍适用。如果您在文档中需要单独的命名空间，例如 HTTPService 参数，您可以在该元素中创建一个命名空间，如下所示：*

```
    <HTTPService id="服务" url="http://blah.com"
        方法="POST" 结果="gotResult(事件)">
        <请求 xmlns:p="*">
            <p:param1>p1</p:param1>
            <p:param2>p2</p:param2>
        </请求>
    </HTTP服务>

```

*希望这可以帮助某人。我对我的代码现在的干净程度感到非常满意，几乎和普通的 html 文件一样干净。至于那些认为编写 mx: 整个代码更清晰的人，我完全不同意。我认为要求您在代码中过度重复相同字符序列的语言（您应该将其视为文档）存在设计缺陷。给你打个比方：如果你在读一篇关于巴拉克奥巴马的文章，每句话都包含“巴拉克奥巴马”这个词，你会怎么看，那会很烦人，不是吗？*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-12T17:11:40.030

我认为随着项目变大，删除 mx 命名空间几乎肯定会给您带来名称冲突的麻烦。

我个人认为 mx 命名空间使代码更清晰而不是更混乱，特别是如果你有基于组件的 flex 开发或很多你自己的控件。在过去的两年里，我拥有一个大型的 flex 代码库，我发现 mx 命名空间并不显眼，尤其是当您有内嵌的自定义对象（例如项目渲染器）时。

我的建议（不科学地断言）是忍受它，特别是如果您在删除它时发现问题。我敢打赌你会在一段时间后不再注意到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T01:03:37.887

只是为了成为分歧的声音......

在挖掘[Ely Greenfields](http://www.quietlyscheming.com/blog/)代码时，他经常这样做——我不确定 Flex SDK 团队中的其他开发人员是否这样做，但它确实为这样做的论点提供了一些可信度……对吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T17:08:20.520

您需要 mx 或一些 xmls:[SOMETHING HERE] 因为这是引用控件定义的 XML 命名空间。这就像在普通代码中使用命名空间一样。

只写 Panel 是模棱两可的，可能会与其他人的 Panel 实现发生冲突。因此，我们向 Flex 声明 Panel 属于哪个命名空间 ( [http://www.adobe.com/2006/mxml](http://www.adobe.com/2006/mxml) )，并使用 mx 作为别名。

Microsoft 的 WPF XAML 也要求这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T20:54:44.233

我同意这里的大多数其他答案，最好离开它。最终，您将希望将其他名称空间用于自定义组件等内容，然后您将需要一个名称空间来进行区分。然后你会得到一些有命名空间的和一些没有命名空间的。

我会说，如果没有其他原因，您应该离开它，因为有一天其他人可能不得不查看您的代码，他们可能会发现使用 mx 比不使用 mx 更具可读性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T12:32:55.317

mx: 只是告诉 Flex Panel（连同任何其他组件）是 Flex 框架的一部分的一种方式，它内置在 Flex 中。这有助于 Flex 知道在哪里寻找面板，并使您的编译过程更快。

您还可以使用 local: 来访问您创建的组件。示例：如果我想向我的面板添加一些功能，我会键入一些代码，并将其保存为自定义面板，称为 MyPanel。它们，我可以用来告诉 Flex MyPanel 是我的组件，它可以找到我项目中的某个位置。当然，你可以随意命名它:-)

我同意你的观点，mx: 起初看起来不美观，尤其是当你已经具备 HTML 或 XML 方面的深厚背景时，但你会习惯它的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-22T18:29:52.890

请记住，如果您正在开发应在包括移动设备在内的各种平台上运行的应用程序，最好尽可能坚持使用纯 spark，因为如今大多数移动设备都支持它。在某些情况下，人们被迫使用诸如手风琴之类的 mx 控件。在这种情况下，如果您确实有时间实现它，明智的做法是使用工具或 spark 中的基本控件来创建这些更高级或更复杂的控件来代替使用。

# .net - WCF 错误：调用者未通过服务的身份验证

> ID：284538
> 
> 赞同：44
> 
> 时间：2008-11-12T16:38:44.980
> 
> 标签：.net, wcf, security, wcf-binding

我正在尝试从我的客户端控制台应用程序访问服务器上的 WCF 服务以进行测试。我收到以下错误：

> 调用者未经服务验证

我正在使用`wsHttpBinding`. 我不确定该服务需要什么样的身份验证？

```
<behaviors>
  <serviceBehaviors>
    <behavior name="MyTrakerService.MyTrakerServiceBehavior">
      <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
      <serviceMetadata httpGetEnabled="true"/>
      <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
      <serviceDebug includeExceptionDetailInFaults="false"/>
    </behavior>
  </serviceBehaviors>
</behaviors> 
```

**更新** 如果我`<endpoint "basicHttpBinding" ... />`在托管的 IIS 7.0、windows 2008 服务器上将绑定更改为（从 wsHttpBinding），它就可以工作

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-12T19:33:10.307

如果您使用 basicHttpBinding，请将端点安全性配置为“None”，并将 clientCredentialType 传输为“None”。

```
<bindings>
    <basicHttpBinding>
        <binding name="MyBasicHttpBinding">
            <security mode="None">
                <transport clientCredentialType="None" />
            </security>
        </binding>
    </basicHttpBinding>
</bindings>
<services>
    <service behaviorConfiguration="MyServiceBehavior" name="MyService">
        <endpoint 
            binding="basicHttpBinding" 
            bindingConfiguration="MyBasicHttpBinding"
            name="basicEndPoint"    
            contract="IMyService" 
        />
</service> 
```

另外，确保 IIS 中的目录身份验证方法启用匿名访问

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-02-25T23:42:14.823

我知道了。

如果您想使用 wshttpbinding，您需要添加 Windows 凭据，如下所示。

```
svc.ClientCredentials.Windows.ClientCredential.UserName = "abc";
svc.ClientCredentials.Windows.ClientCredential.Password = "xxx"; 
```

谢谢

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-12T18:04:27.787

您是否尝试过使用 basicHttpBinding 而不是 wsHttpBinding？如果不需要任何身份验证并且不需要 Ws-* 实现，那么使用普通的旧 basicHttpBinding 可能会更好。WsHttpBinding 为消息安全和身份验证实现 WS-Security。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-21T07:09:52.017

在您的虚拟目录中设置匿名访问

将以下凭据写入您的服务

```
ADTService.ServiceClient adtService = new ADTService.ServiceClient();
adtService.ClientCredentials.Windows.ClientCredential.UserName="windowsuseraccountname";
adtService.ClientCredentials.Windows.ClientCredential.Password="windowsuseraccountpassword";
adtService.ClientCredentials.Windows.ClientCredential.Domain="windowspcname"; 
```

之后，您调用您的网络服务方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-04T13:57:41.390

如果您使用像我这样的自托管站点，避免此问题的方法（如上所述）是在主机和客户端都规定 wsHttpBinding 安全模式 = NONE。

在客户端和主机上创建绑定时，您可以使用以下代码：

```
 Dim binding as System.ServiceModel.WSHttpBinding 
 binding= New System.ServiceModel.WSHttpBinding(System.ServiceModel.SecurityMode.None) 
```

或者

```
 System.ServiceModel.WSHttpBinding binding
 binding = new System.ServiceModel.WSHttpBinding(System.ServiceModel.SecurityMode.None); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-07T22:12:01.483

我能够通过以下步骤解决共享问题：

1.  转到 IIS-->**站点**-->**您的站点**-->
2.  功能视图窗格-->**身份验证**
3.  将**匿名身份验证**设置为**禁用**
4.  将**Windows 身份验证**设置为已**启用**

[![在此处输入图像描述](https://i.stack.imgur.com/2OCHn.png)](https://i.stack.imgur.com/2OCHn.png)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-19T06:26:49.267

我也有同样的问题`wsHtppBinding`。我只需要添加`security`指向 的模式`none`，就解决了我的问题，无需切换到`basicHttpBinding`. [检查此处](https://social.msdn.microsoft.com/Forums/vstudio/en-US/271b1816-173c-4c76-a4c4-fd9fda4b5e91/how-to-disable-wcf-security?forum=wcf)并检查如何禁用 WCF 安全性。检查以下配置更改以供参考：

```
<wsHttpBinding>
    <binding name="soapBinding">
        <security mode="None">
            <transport clientCredentialType="None" />
            <message establishSecurityContext="false" />
        </security>
    </binding>
</wsHttpBinding> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-27T09:55:13.350

如果需要在 webconfig 中指定域（验证客户端使用的用户名和密码），您可以将其放入 system.serviceModel services 服务部分：

```
<identity>          
<servicePrincipalName value="example.com" />
</identity> 
```

并在客户端指定域和用户名和密码：

```
 client.ClientCredentials.Windows.ClientCredential.Domain = "example.com";
 client.ClientCredentials.Windows.ClientCredential.UserName = "UserName ";
 client.ClientCredentials.Windows.ClientCredential.Password = "Password"; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-05-17T04:22:52.073

如果客户端与服务器位于不同的域中，则可能会导致此问题。

我在测试我的一个应用程序从我的 PC（客户端）到我的（云）测试服务器时遇到了这个问题，我能想到的最简单的解决方案是设置一个 vpn。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-11-03T06:29:06.453

为什么不能完全删除 wsHttpBinding 的安全设置（“none”而不是“message”或“transport”）？

# c# - 此代码示例中的 @ 是什么意思？

> ID：284545
> 
> 赞同：6
> 
> 时间：2008-11-12T16:39:59.937
> 
> 标签：c#, .net, variables, keyword, variable-names

`Html.TextBox("ParentPassword", "", new { @class = "required" })`

天哪该死的是@class的@。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-12T16:46:23.717

`class`是保留关键字，因此不能将其用作变量名。

@ 运算符允许您绕过此规则。之所以在这里这样做是因为匿名对象用于填充 HTML 元素的属性。有效的属性名称是“class”，它允许您在元素上设置 CSS 类。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-12T16:48:08.953

`class`是一个关键字。要`class`用作变量/属性的名称，在 C# 中，您可以`@`在其前面添加`@class`. 在 IL 中，对于所有 .net 而言，变量/属性的名称仍然是`class`-`@`您必须在 C# 中这样做。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-12T17:08:22.813

只是将我的两分钱添加到这里的所有正确答案中：

如果您是 C# 新手，但对 VB.NET 很熟悉，您可能知道 VB 中有一个与 @ 对应的对象。方括号 [ ] 在 VB.NET 中用于包围以保留字（或关键字）命名的变量名。例如：

```
Dim [String] As String 
```

# c++ - 删除还是虚拟删除？

> ID：284556
> 
> 赞同：0
> 
> 时间：2008-11-12T16:42:36.750
> 
> 标签：c++, virtual

我正在编写一个库和一个演示项目。该项目不关心我使用哪个版本的 lib（我可以使用 sdl、directx 或任何我喜欢的 gfx 后端）。为了得到我做的对象

```
Obj *obj = libname_newDevice(); 
```

现在，我应该使用 delete 还是应该使用`obj->deleteMe();`？我问是因为我不完全是在做新的，所以我不应该做删除？

我有`obj->create(theType);`它返回一个带有 Obj 接口的类。我真正的问题是我需要一个`libname_deleteDevice();`还是`obj->deleteMe()`很好，因为我在界面中有一个 deleteMe？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-12T16:45:37.180

由于您正在抽象内部的创建`libname_newDevice()`（我不得不说这不是一个好方法），您应该使用类似`libname_destroyDevice (obj)`.

正如 Martin 的评论所建议的那样，最好将它们放在自定义类的构造函数和析构函数中，您只需要在堆栈上创建，编译器将处理其余部分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-12T16:52:34.827

请尝试澄清您的问题。我完全不清楚。

*   为什么说图形后端？它与问题有关吗？
*   你是在问你应该如何设计你的库或者你应该如何使用它？

使用对象工厂来创建对象是一种很好的做法。我假设这是 的角色`libname_newDevice()`。

该库还应提供一种删除对象的方法（例如`obj->DeleteMe()`或`libname_Delete(obj)`）。

不要依赖 C++ 的`delete`: 调用者和库可能已经使用不同版本的编译器编译，这会在内存和资源分配方面做不同的事情。因此，如果您的 lib 删除它创建的对象会更安全。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-12T17:16:22.937

我会更进一步。
如果你使用工厂函数来创建，使用工厂函数来销毁可能是合乎逻辑的。除此之外，为了让一切都很好，并且可以安全地包装在一个对象中。

```
class ObjWrap
{
    public:
        ObjWrap()
            :obj(libname_newDevice())
        {}
        ~ObjWrap()
        {    libname_deleteDevice(obj);}
    private:
        ObjWrap(ObjWrap const&);        // Dont copy
        void operator=(ObjWrap const&); // Dont copy
        Obj* obj;
}; // If you want to copy then you need to extra work on ref counting
   // This may need some form of smart pointer. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T17:13:23.630

我认为最好的方法是尊重[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)并拥有一些引用计数包装对象（您甚至可以将[shared_ptr](http://www.boost.org/doc/libs/1_37_0/libs/smart_ptr/shared_ptr.htm)与自定义释放器一起使用）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T17:10:06.100

你肯定不想实现 Obj::deleteMe()。它必须执行以下操作：

```
delete this; 
```

当你还在 this->deleteMe() 里面的时候。按照 Jaywalker 的建议，让 destroy 函数以 Obj* 作为参数。

# c# - Linq to SQL，基于 If/Else 的具有不同返回类型的存储过程

> ID：284558
> 
> 赞同：2
> 
> 时间：2008-11-12T16:42:46.733
> 
> 标签：c#, linq-to-sql, stored-procedures

我有一个现有的存储过程，我现在尝试使用 LINQ to SQL 调用它，这里是存储过程：

```
ALTER procedure [dbo].[sp_SELECT_Security_ALL] (
@UID       Varchar(15)
)
as
DECLARE @A_ID   int

If ISNULL(@UID,'') = ''
    SELECT  DISTINCT
       App_ID,
       App_Name,
       App_Description,
       DB,
       DBNameApp_ID,
       For_One_EVA_List_Ind
    From      v_Security_ALL
ELSE
   BEGIN
        Select  @A_ID = (Select Assignee_ID From NEO.dbo.v_Assignees Where USER_ID = @UID and Inactive_Ind = 0)

    SELECT  DISTINCT
       Security_User_ID,
       Security_Company,
       Security_MailCode,
       Security_Last_Name,
       Security_First_Name,
       Security_User_Name,
       Security_User_Info,
       Security_User_CO_MC,
       Security_Email_Addr, 
       Security_Phone,
       Security_Security_Level, 
       Security_Security_Desc, 
       Security_Security_Comment,
       Security_Security_Inactive_Ind,
       App_ID,
       App_Name,
       App_Description,
       DB,
       DBNameApp_ID,
       For_One_EVA_List_Ind,
       @A_ID as Assignee_ID
    From      v_Security_ALL
    Where     Security_User_ID    = @UID
   END 
```

我的问题是智能感知只看到 IF 语句中的第一组返回值，我无法从存储过程的“其他”部分访问任何内容。所以当我尝试这样做时：

```
 var apps = dataContext.sp_SELECT_Security_ALL(userId);

        foreach (var app in apps)
        {
            string i = app.
        } 
```

在应用程序上。我拥有的唯一可用值是上面第一个 Select distinct 的结果。

是否可以将 LINQ 与这种类型的存储过程一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T17:05:40.930

问题不在于 Intellisense。 `dataContext.sp_SELECT_Security_ALL()`正在返回一个固定的数据类型。您可能将其隐藏在“var”后面，但它仍然是具有固定数量属性的具体类型。仍然有 C# 记住，一个函数只能返回一种类型的对象。查看您的 dataContext.designer.cs 文件以了解它的实际定义方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T17:19:52.260

Scott Guthrie[在一篇博](http://weblogs.asp.net/scottgu/archive/2007/08/16/linq-to-sql-part-6-retrieving-data-using-stored-procedures.aspx)文中介绍了这个案例。向下滚动到“处理来自 SPROC 的多个结果形状”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-21T20:22:08.637

解决此问题的快速而肮脏的方法是强制每个返回语句返回相同的内容：

```
IF @theSkyIsBlue
SELECT CustomerNumber, CustomerName, null as OrderNumber, null as OrderName
FROM Customers
ELSE
SELECT null as CustomerNumber, null as CustomerName, OrderNumber, OrderName
FROM Orders 
```

您可能必须观察/（手动更改）映射类型中属性的可空性，但这会让您到达目的地。

# c++ - 如何使用私有构造函数中的引用成员初始化类？

> ID：284566
> 
> 赞同：3
> 
> 时间：2008-11-12T16:45:56.570
> 
> 标签：c++, constructor, reference

我正在为一个类创建一个接口包装器。类中的成员是一个引用（以避免复制大型结构）。如果我创建一个私有构造函数，初始化该引用以安抚编译器的最佳方法是什么？

```
struct InterfaceWrapper {
    InterfaceWrapper( SomeHugeStructure& src ):m_internal(src){};
    int someElement(void) const { return m_internal.someElement; };
private:
    InterfaceWrapper(){}  // initialize m_internal
    SomeHugeStructure& m_internal;
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T16:57:14.020

如果你真的需要在没有元素的情况下构造类，那么引用不是要走的路。

如果您使用引用的唯一原因是避免复制，我建议使用指针。您可以简单地在常规构造函数中获取传递引用的地址，并在私有构造函数中将其初始化为 NULL。当对象的生命周期结束时，指针将是一个悬空指针，但引用也是如此......

或者，如果您担心生命周期，让公共构造函数采用智能指针并使用这样的智能指针作为成员。

当然，还要处理在类代码的其余部分中可能为 NULL 的指针。（但您必须处理在参考案例中可能是存根的成员，所以这不是真正的问题）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-12T17:44:10.197

正如其他人所提到的，如果您的目的是阻止其他人调用默认构造函数，那么您根本不想提供一个主体，并且声明它是不必要的，因为您有另一个构造函数并且编译器不会为它生成它你。

如果目的是限制对类朋友的访问，那么您最好拥有一个指针（最好是智能指针）成员，并将其设置为 NULL。

--

另外，我不确定您为什么将其设为结构而不是类。通常，当您将数据成员公开为公共时，将某些东西设为结构是有意义的，类似于 C。在这种情况下，看起来您有一个常规类，在这种情况下，C++ 约定将使其成为一个类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T17:00:29.537

如果您将默认 ctor 设为私有以防止任何人使用它，那么只需离开正文：

```
private:
    InterfaceWrapper();
    SomeHugeStructure& m_internal; 
```

编译器会认为它是在别处定义的，除非有人尝试使用它，否则链接器不会介意它不是。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T16:58:41.897

私人演员的意义何在？如果 m_internal 没有引用一个有效的对象，它有什么用呢？

m_internal-> 也不会编译。那是指针语法，而不是 ref。

# prototyping - 先设计还是先原型？

> ID：284578
> 
> 赞同：12
> 
> 时间：2008-11-12T16:49:43.833
> 
> 标签：prototyping

当第一次接近一个项目时，最好退后一步，仔细考虑所有事情，或者只是潜入并在以后开始编码和润色？本质上，您是先设计还是尝试快速原型？

我已经被这两种方法所困扰，有时我会尝试仔细考虑所有事情，但是当我真正深入到细节时，我会遇到我没有考虑到的问题，有时当我第一次编码时，我会以需要的代码结束重做以适应更好的整体设计。我的很多问题都源于缺乏经验，但欢迎任何建议。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-12T16:54:59.220

**逐步和迭代地进行。**

设计一点，实施一点。

从设计开始，您可能会受到*隧道效应*的影响，在您实际实施某些东西之前，您无法获得任何真正的反馈。

从没有设计的情况下开始，您可能会做出您会后悔的决定。

理想的情况是能够实现您的系统的非常简单的端到端版本，该版本可以进行测试并向客户展示。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-12T16:53:24.543

首先设计总是更安全，但这并不意味着原型设计不起作用。原型设计的真正问题是抵制保留已经编写的代码而不是在设计时将其丢弃的冲动。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-12T16:58:36.857

没有银弹。似乎设计优先是首选方法。但是您将无法预测在实施您的设计时可能出现的所有复杂情况。他们中的一些人可能会成为表演的终结者。另外，如果您正在为客户写作，最好能够展示一些内容以确保您在同一页面上。

在我的工作场所，我们两者都做——我们做一个快速原型，只是为了获得反馈并了解任何潜在的问题。然后我们进行正式的设计和正式的实现。在大多数情况下，我们能够从原型设计阶段挽救大量代码。我喜欢这种方法，因为我们通常会得到干净、可维护的代码。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-12T16:55:46.100

参见[盖尔定律](http://en.wikipedia.org/wiki/Gall's_law)。关键是迭代：设计一点，实施一点，测试一点，然后重复直到您（或您的客户）满意。这是新型“敏捷”方法的本质。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-12T16:57:03.973

这取决于。

当需求或解决方案不一定清楚时，原型设计最有用。举个例子，我正在一个环境（大型商业保险）中做一个数据仓库项目，其中财务对账很重要。该项目涉及大型原型设计工作，以获得一个与财务状况相协调的系统。由于围绕此的业务规则没有得到很好的记录，因此原型有助于暴露所有极端情况。

在其他情况下，设计优先的方法可能更合适。这最适用于需求和合理的解决方案架构相当明显的情况。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-12T16:54:35.773

在开始工作之前，您必须对内聚架构有所了解。对于大型系统尤其如此。

原型可用于设计的特定方面，例如表示层。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-12T16:56:30.870

我认为这取决于您预先有什么样的业务需求。如果它们（相对）详细和完整，那么我会根据这些要求进行设计。如果您一开始几乎没有任何东西可以使用，那么制作原型并向您的客户展示您得到了什么，以接收进一步的需求信息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-12T16:56:37.487

您应该使用敏捷方法进行开发。简而言之，您设计就行了。团队与产品负责人一起定义要开发的主题列表，按重要性排序，并在迭代中拆分开发。每次迭代作为要开发的特征，在迭代开始时设计每个特征。

[在这里](http://www.mountaingoatsoftware.com/scrum)查看更多。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-12T17:12:45.877

当第一次接近一个项目时，原型。但不要对所有东西都进行原型设计。原型化一件重要的事情（一个“用例”，如果这意味着什么）和“转动内在的眼睛跟随它的路径” - 留意你在尝试完成这件事时遇到的实际问题。

既然您已经了解了做一件重要的事情需要什么，那么您可以从不仅仅是基本原则进行设计。

当然，这假设您在一个环境中工作，您可以以最小的成本为正在进行的开发工作制作原型。但是，如果您在这样的环境中工作，请在您的设计讨论中大量使用原型。运气好的话，你可能会保留其中一些。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-12T17:26:22.650

请注意，敏捷方法不是避免设计的借口，它们只是鼓励更频繁地测试设计，并且增量更小

我喜欢绘制设计草图并将其元素分解，直到有理由确定没有明显的未知数或风险；“尖峰”项目突出了未知数和风险，如果首选方法证明不可行，则有确定可行性的时间框和可能替代方案的说明

一旦对整体架构感到满意，就自下而上（或按优先顺序）跳入功能以完成设计，编写初始测试，然后实施

编辑：请注意，“首先设计或原型”的问题是一个错误的假设，即可以在不进行任何设计的情况下进行原型设计，当然情况并非如此（除非您使用的是百万猴子方法）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-12T16:54:51.840

设计优先，除非你愿意冒险在你发现它不能做你需要它做的事情时，把所有投入到你的原型中的工作扔掉。至少，您应该为您的项目进行一些高级设计，这些设计可以帮助您就如何构建原型做出一些决定，从而将浪费的精力降到最低。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-12T17:00:13.047

如果我知道我想建造什么，我就直接去设计。

如果我正在为客户构建一些东西，那么我会制作原型以缓解用户的更具体要求。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-12T17:06:19.493

也许不是答案，而是我的经验的建议。

在大多数情况下，如果我早点开始编码会更好。您可以设计直到奶牛回家，但是如果在您开始编码时奶牛就在地平线上，您可能会发现您的精心设计很难及时实施。

# delphi - 如何发现我的 delphi 应用程序当前是否有模式窗口？

> ID：284581
> 
> 赞同：6
> 
> 时间：2008-11-12T16:50:40.710
> 
> 标签：delphi, modal-dialog, mdi

我在我的 Delphi MDI 应用程序中运行了一个计时器，如果后台发生变化，我想用它来弹出一条消息。但是我不希望当应用程序在前台有一个模式对话框时弹出该消息，因为用户对此无能为力。

所以我想知道的是如何检查我的应用程序中是否存在模式对话框？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-12T17:01:07.850

您可以尝试使用以下代码：

```
var
  ActForm: TCustomForm;
begin
  ActForm := Screen.ActiveForm;
  if (ActForm = nil) or not (fsModal in ActForm.FormState) then begin

  end;
end; 
```

我用 Delphi 4 测试过，对我有用。

[编辑]：但是你真的应该考虑弹出一个表格并窃取焦点是否是一个好主意。这取决于您的应用程序，但如果用户当前正在编辑字段中输入内容，或者正在使用鼠标进行操作，那么这可能会破坏他们的工作流程。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-13T08:21:11.627

自 Delphi 2005 以来，您在 TApplication 上有一个[ModalLevel](http://docwiki.embarcadero.com/Libraries/Seattle/en/Vcl.Forms.TApplication.ModalLevel)属性。它计算在应用程序中打开的模态表单的数量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T17:37:56.997

也许解决方案是实际弹出一个不会窃取焦点的提示。一个可见的可点击提示，但不是太具有侵略性。因此，如果用户想要采取他们可以采取的行动，或者他们可以完成他们正在做的事情，那么就采取行动。或者也许完全忽略它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-22T08:01:35.230

使用[AnyPopup](http://msdn.microsoft.com/en-us/library/ms632670(VS.85).aspx) () 函数

关于[GetLastActivePopup](http://msdn.microsoft.com/en-us/library/ms633507(VS.85).aspx) ()。它可能返回值与 hWnd 参数相同时

*   hWnd 标识的窗口最近处于活动状态。
*   hWnd 标识的窗口不拥有任何弹出窗口。
*   由 hWnd 标识的窗口不是顶级窗口，或者它属于另一个窗口。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-22T07:45:19.400

今天用户[histrio在](https://stackoverflow.com/users/180353/histrio)[另一个线程](https://stackoverflow.com/questions/3306260/delphi-detecting-if-my-app-has-a-modal-dialog-open)中正确回答了仅监视模态 Delphi 表单是不够的；Windows 也可以有模式对话框。

他[在另一个线程中的回答](https://stackoverflow.com/questions/3306260/delphi-detecting-if-my-app-has-a-modal-dialog-open/3306514#3306514)向您展示了如何检查。

——杰伦

# linux - 如何让 Subversion 使用第三方差异工具？

> ID：284608
> 
> 赞同：19
> 
> 时间：2008-11-12T16:57:46.313
> 
> 标签：linux, svn, diff, beyondcompare

我需要的不仅仅是默认差异！我最近购买了“Beyond Compare”，我想将它与 svn 集成，所以它在我输入时启动：

svn diff foo.c

我该怎么做呢？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-12T17:19:08.487

来自[Beyond Compare 论坛帖子](http://www.scootersoftware.com/vbulletin/showthread.php?t=41520)：

/usr/bin/bcompare_svn：

```
#!/bin/bash
/usr/bin/bcompare $6 $7 &
exit 0 
```

bcompare 的调用很明显，但我必须添加“exit 0”，以便 svn 一次打开多个文件。

为了让 svn 调用我的脚本，我在 ~/.subversion/config 的 [helpers] 部分添加了以下行

```
diff-cmd=/usr/bin/bcompare_svn 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-12T16:59:10.537

看 svn --diff-cmd。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-12T20:49:51.570

我想对安迪·莱斯特的回答添加评论，但我没有足够大的声誉。不过，我想我可以回答这个问题。

无论如何......正如安迪已经指出的那样运行“svn help diff”，但只是给你答案......

svn diff --diff-cmd <diff-cmd> --extensions <diff-cmd 选项>

svn diff --diff-cmd /usr/bin/diff --extensions "-bca" <文件名>

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-10T23:56:09.070

[我最近在我们的Using Beyond Compare With Version Control Systems](http://www.scootersoftware.com/support.php?zz=kb_vcs.php)网页中添加了关于 Linux 上的 Subversion 的说明。一旦您按照上面链接中的步骤操作，当您运行“svn diff”时，它应该会启动 Beyond Compare 3 for Linux。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-01-10T01:47:21.893

在最新的 Subversion 中，脚本 /usr/bin/bcompare_svn 应该是这样的：

```
#!/bin/bash
cp $6 $6.save
cp $7 $7.save
{
    /usr/bin/bcompare $6.save $7.save 
    rm $6.save $7.save
} &
exit 0 
```

或（未经测试的代码）

```
#!/bin/bash
base=`echo $3 | sed -r "s/^([^\(]+)[ \t]+\((.+)\)$/\1.\2/g" | xargs -i% basename "%"`
current=`echo $5 | sed -r "s/^([^\(]+)[ \t]\((.+)\)$/\1.\2/g" | xargs -i% basename "%"`

mv "$6" "/tmp/$base"
mv "$7" "/tmp/$current"
{
    /usr/local/bcompare/bin/bcompare "/tmp/$base" "/tmp/$current"
    rm "/tmp/$base" "/tmp/$current"
} &
exit 0 
```

# sql - SQL Mobile 中的性能与未选择的一大列

> ID：284609
> 
> 赞同：2
> 
> 时间：2008-11-12T16:58:07.217
> 
> 标签：sql, performance, sql-server-ce

我有一个带有一张表的 SQL Mobile 数据库。它有几列包含有用的、经常查询的数据，还有一列存储每条记录相对较大的字符串（1000 多个字符），但不经常查询。

想象一下这个假模式，“lifeStory”字段是大的。

```
table1
String firstName
String lastName
String address
String lifeStory 
```

一个有代表性的查询是

```
SELECT firstName, lastName, address FROM table1 WHERE firstName = :p1 
```

有谁知道在这个表中留下那个大的、不经常查询的列的任何性能问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T17:04:35.987

除非您尝试实际查看/查询该字段中的数据，否则您不应该注意到任何性能损失。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-25T18:32:52.897

使用 VS2005 (c#) 和 SQLServerCE 库我可以告诉你它**确实**会影响性能，但我不能真正回答*为什么。* 此外，实际上对性能产生负面影响的是该列中的数据长度，而不是该列本身。

在一个工作项目上做我自己的一些性能测试，我遇到了一个类似的场景，只是一个额外的专栏。

```
table1

c1 NVARCHAR (20)
c2 NVARCHAR (20)
c3 NVARCHAR (20)
c4 NVARCHAR (20) 
c5 NVARCHAR (4000) //maximum allowed and fully populated for testing purposes 
```

如果你跑...

```
select c1, c2, c3, c4 From table1 
```

...大约需要 1560 毫秒。

如果您创建两个表，拉出大列（并自然地提供一个外键来关联这两个表）并在第一个表上运行相同的查询，大约需要 660 毫秒。

最后，其他测试告诉我，这不是列数，而是每行数据的大小。即 5 列，2 个字符宽 == 2 列，5 个字符宽。此外，请务必在您的移动设备上运行这些。您可以对这些进行单元测试，但由于我的 PC 上的马力明显更大，我发现时间差为 10-20 毫秒，而不是上面所示的近 1000 毫秒。

为什么？这只是一个猜测，但...

在移动世界中，DBMS 不可能是一样的。它不是企业数据库。在幕后我敢打赌，他们仍在执行 OLEDB“搜索”。

总的来说，在移动领域，我学会了设计我的数据库不是最“规范化”的，而是支持最常见的用例。祝你好运！

# sql-server - 如何在 SQL Server 2000 中传递大于 varchar(8000) 的字符串参数？

> ID：284610
> 
> 赞同：3
> 
> 时间：2008-11-12T16:58:25.593
> 
> 标签：sql-server, tsql, parameters

如果将字符串参数定义为大于 8000 的大小，则会出现编译错误

例如

```
The size (9000) given to the type 'varchar' exceeds the maximum allowed for any data type (8000). 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-12T17:01:04.700

对于 sql 2000 中大于 8000 的字符串，您需要将其存储为 TEXT 而不是 varchar

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T19:16:30.387

> > 您不能将文本用作 SQL 2000 中存储过程的参数值<< 当然可以。

您不能做的是将局部变量定义为文本

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T17:01:32.717

您不能在 SQL 2000 中这样做，而是使用“文本”数据类型。

[选择 SQL 2000 数据类型](http://www.mssqlcity.com/Articles/General/choose_data_type.htm)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-12T18:01:55.433

您不能将文本用作 SQL 2000 中存储过程的参数值，因此通常该技术是将信息分解为 8000 个字符或更少的块并在过程中重新组合。

# winapi - Win32：注册 ActiveX 控件所需的注册表项？

> ID：284619
> 
> 赞同：11
> 
> 时间：2008-11-12T17:00:34.810
> 
> 标签：winapi, com, activex, registry

我需要编写调用 DllRegisterServer 时运行的代码。即当有人打电话时：

```
regsvr32 myActiveX.ocx 
```

我正在尝试找到所需注册表项的最终列表（而不仅仅是我可以通过注册表拼写拼凑的内容）。

到目前为止，我的探险发现：

```
HKEY_CLASSES_ROOT
   \MyCoolLibrary.MyCoolControl
      \Clsid
         (default) = "{myClassId}"
   \CLSID
      \{myClassId}
         \Control
         \InprocServer32
            (default) = "c:\foo\myActiveX.ocx"
            ThreadingModel = "Apartment"
         \MiscStatus
            \1
               (default) = 205201
         \ProgID
            (default) = "MyCoolLibrary.MyCoolControl"
         \ToolboxBitmap32
            (default) = "c:\foo\myActiveX.ocx,1"
         \TypeLib
            (default) = "{myTypeLibraryGuid}"
         \Verb
            \0
               (default) = "Properties,0,2"
         \Version
            (default) = "1.0"
   \TypeLib
      \{myTypeLibraryGuid}
         \1.0
            (default) = "MyCoolLibrary.MyCoolControl" 
```

现在，关注点： - 控制文件夹包含什么？它的存在是否表明控制？- 205201 的 MiscStatus 有什么作用？205202 会做什么呢？- 动词“Properties,0,2”是什么？“Properties,0,0”和“Properties,0,1”在哪里？

换句话说，我正在寻找文档。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-12T19:33:05.237

到目前为止我所知道的。COM 基于它的*clsid*创建一个对象。这是一个唯一标识该类的指南。

```
HKEY_CLASSES_ROOT
   \Clsid
      \{AE8530CF-D204-4877-9CAB-F052BF1F661F} 
```

然后该类用于创建对象。COM 现在需要知道保存该 COM 对象的 DLL 在哪里。在我的特定情况下，公开 COM 对象的“服务器”是一个 DLL，并且将处于“进程中”。然后，我们通过添加将 COM 指向该“进程内”dll：

```
HKEY_CLASSES_ROOT
   \Clsid
      \{AE8530CF-D204-4877-9CAB-F052BF1F661F}
         \InprocServer32
            (default) = "c:\foo\myActiveX.ocx" 
```

COM 还需要知道 COM 服务器对象支持的线程模型。本例中使用的最简单、最常见的一种是“Apartment”线程模型：

```
HKEY_CLASSES_ROOT
   \Clsid
      \{AE8530CF-D204-4877-9CAB-F052BF1F661F}
         \InprocServer32
            (default) = "c:\foo\myActiveX.ocx"
            ThreadingModel = "Apartment" 
```

接下来是 ProgID。这类似于使用 DNS 将友好名称转换为 IP 的方式。这里我们把友好的名字`"MyCoolLibrary.MyCoolControl"`变成丑陋的 clsid`"{AE8530CF-D204-4877-9CAB-F052BF1F661F}"`

```
HKEY_CLASSES_ROOT
   \Clsid
      \{AE8530CF-D204-4877-9CAB-F052BF1F661F}
         \InprocServer32
            (default) = "c:\foo\myActiveX.ocx"
            ThreadingModel = "Apartment"
HKEY_CLASSES_ROOT
    \MyCoolLibrary.MyCoolControl
       \Clsid
           (default) = "{AE8530CF-D204-4877-9CAB-F052BF1F661F}" 
```

现在有人可以要求

```
MyCoolLibrary.MyCoolControl 
```

COM 可以把它变成 ClassID

```
{AE8530CF-D204-4877-9CAB-F052BF1F661F} 
```

一旦 COM 有了 clasid，它就可以在下面的注册表`HKCR\Clsid\{AE8530CF-D204-4877-9CAB-F052BF1F661F}`中查找真实信息。

为了好玩，将 ProgID 添加到 Clsid 部分，这样人们就可以知道这个类是什么：

```
HKEY_CLASSES_ROOT
   \Clsid
      \{AE8530CF-D204-4877-9CAB-F052BF1F661F}
         \InprocServer32
            (default) = "c:\foo\myActiveX.ocx"
            ThreadingModel = "Apartment"
         \ProgID
             (default) = "MyCoolLibrary.MyCoolControl"
HKEY_CLASSES_ROOT
    \MyCoolLibrary.MyCoolControl
       \Clsid
           (default) = "{AE8530CF-D204-4877-9CAB-F052BF1F661F}" 
```

接下来是类型库。这对于任何进程中的东西来说都是*不重要*的，但是如果 COM 对象在另一个“公寓”中，则需要编组函数参数。如果 COM 具有定义所有类方法的类型库，它会自动为您执行此操作。

clsid 部分通过添加 TypeLib 键指向适当的类型库：

```
HKEY_CLASSES_ROOT
   \Clsid
      \{AE8530CF-D204-4877-9CAB-F052BF1F661F}
         \InprocServer32
            (default) = "c:\foo\myActiveX.ocx"
            ThreadingModel = "Apartment"
         \ProgID
             (default) = "MyCoolLibrary.MyCoolControl"
         \TypeLib            
             (default) = "{17A5A3D4-439C-4C2A-8AB4-749B7771CDE1}"
HKEY_CLASSES_ROOT
    \MyCoolLibrary.MyCoolControl
       \Clsid
           (default) = "{AE8530CF-D204-4877-9CAB-F052BF1F661F}" 
```

有关此类型库的信息也存储在注册表中，但添加这些键是通过调用[RegisterTypeLib](http://msdn.microsoft.com/en-us/library/ms221570.aspx)为我们完成的。但它会为我们添加类似于以下内容的键：

```
HKEY_CLASSES_ROOT
   \Clsid
      \{AE8530CF-D204-4877-9CAB-F052BF1F661F}
         \InprocServer32
            (default) = "c:\foo\myActiveX.ocx"
            ThreadingModel = "Apartment"
         \ProgID
             (default) = "MyCoolLibrary.MyCoolControl"
         \TypeLib            
             (default) = "{17A5A3D4-439C-4C2A-8AB4-749B7771CDE1}"
HKEY_CLASSES_ROOT
    \MyCoolLibrary.MyCoolControl
       \Clsid
           (default) = "{AE8530CF-D204-4877-9CAB-F052BF1F661F}"
HKEY_CLASSES_ROOT
    \TypeLib
        \{AE8530CF-D204-4877-9CAB-F052BF1F661F}
           \1.0
              (default) = "My Cool ActiveX Library"
           ... 
```

*现在我们进入棘手的问题，希望*使 ActiveX 控件工作所需的东西。

[一篇 MSDN 文章指出](http://msdn.microsoft.com/en-us/library/ms221150.aspx)，您必须添加一个虚拟**可编程**键以表明它是一个 ActiveX 控件：

```
HKEY_CLASSES_ROOT
   \Clsid
      \{AE8530CF-D204-4877-9CAB-F052BF1F661F}
         \Programmable 
```

但是[这个 MSDN Library 页面](http://msdn.microsoft.com/en-us/library/ms691424(VS.85).aspx)说关键字是**Control**，而不是**Programmable** - 并且没有 Programmable 键。

但这并不能阻止一些 ActiveX 使用 Control，一些使用 Programmable，还有一些两者都使用。

我找不到任何提到其他需要的东西。

那么，任何人都可以找到一些权威的文档吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-12T17:07:15.203

拉里奥斯特曼提供了一个很好的起点：

> 这种“货物崇拜”性质的很大一部分是这样一个事实，即可以为 COM 对象设置一组令人眼花缭乱的注册表设置，如果有的话，尚不清楚哪个适用。因此，我试图列出一系列文章，以帮助人们确定他们需要设置的内容。

--[注册 COM 对象需要哪些注册表项。](http://blogs.msdn.com/larryosterman/archive/2006/01/11/511647.aspx)

摘要：这取决于您需要在哪些场景中使用您的对象。最基本、绝对必要的设置是默认值和 ThreadingModel `HKEY_CLASSES_ROOT\CLSID\<clsid>\`，但大多数时候您还需要 ProgID 和 AppID。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-12T17:12:58.997

查找/借用/窃取 Kraig Brockenschmidt 的 Inside OLE 2 副本。它像世界一样古老（也和我约会:-)）

这也是上述注册表项[的高级概述。](http://msdn.microsoft.com/en-us/library/ms695220(VS.85).aspx)

阅读 Larry Osterman 的[博客文章](http://blogs.msdn.com/larryosterman/archive/2006/01/11/511647.aspx)以获取更多指导。

查看[MSDN ActiveX](http://msdn.microsoft.com/en-us/library/ms221669.aspx)示例。

此外，您在 HKCR\Interfaces 下缺少控件实现的所有自定义接口和事件接口的条目。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-12T17:09:12.640

它并不详尽，但请尝试[这篇](http://support.microsoft.com/kb/183771)MS 知识库文章。

此外，[Larry Osterman](http://blogs.msdn.com/larryosterman/default.aspx)[在这里](http://blogs.msdn.com/larryosterman/archive/2006/01/11/511647.aspx)有一篇有用的博文。

* * *

我想到另一种方法是使用[RegMon](http://technet.microsoft.com/en-us/sysinternals/bb896652.aspx)之类的工具，并在调用 DllRegisterServer 方法时直接监视所做的注册表更改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T17:10:26.957

无论如何，请使用链接的 Larry Osterman 文章。

此外，一个很好的起点是由 MSVC ATL COM 对象向导生成的 ATL 注册器脚本。您可以使用不同的选项，看看它们如何影响输出。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T17:58:49.200

旁注，如果您想通过实验查看创建了哪些键：使用 Sysinternals 的[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx "进程监视器")，它会在您注册控件时实时捕获注册表上的活动。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-03-19T12:39:52.690

您在使用 64 位操作系统吗？

如果是这样，而不是写入
HKEY_CLASSES_ROOT\CLSID\
您应该写入
HKEY_CLASSES_ROOT\Wow6432Node\CLSID\

# c# - 在 MVC 视图中遍历匿名类型化数据

> ID：284637
> 
> 赞同：2
> 
> 时间：2008-11-12T17:07:08.183
> 
> 标签：c#, asp.net-mvc, anonymous-types

我将匿名类型的结果放入一些视图数据中：

```
 var projectData = from p in db.Projects
                          orderby p.title
                          select new
                          {
                              Title = p.title,
                              DevURL = p.devURL ?? "N/A",
                              QAURL = p.qaURL ?? "N/A",
                              LiveURL = p.liveURL ?? "N/A",
                              Users = p.GetUsers().MakeUserList()
                          };

        ViewData["ProjectSummary"] = projectData; 
```

我如何在前端的MVC视图中遍历这个视图数据来说，制作一个结果表？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T17:18:39.750

在您的情况下，创建一个模型来保存您的数据而不是使用匿名类型会简单得多。

您遇到的问题是您的匿名类型在存储在 ViewData 中时被转换为对象。在 UI 方面，当您取出该对象时，访问其属性的唯一方法是使用反射。您不想在您的 UI 中执行此操作。它会非常难看。相反，只需将以下类添加到您的模型中：

```
public class Project{

public string Title {get;set;}
public string DevUrl {get;set;}
public string QAUrl {get;set;}
public string LiveUrl {get;set;}
public IEnumerable<User> Users {get;set;}

public static IEnumerable<Project> RetrieveAllProjects()
{
  return from p in db.Projects
           orderby p.title
           select new Project
             {
                Title = p.title,
                DevURL = p.devURL ?? "N/A",
                QAURL = p.qaURL ?? "N/A",
                LiveURL = p.liveURL ?? "N/A",
                Users = p.GetUsers().MakeUserList()
             };
} 
```

在您的控制器中执行以下操作：

```
public ActionResult Index()
{
  return View("Index", Project.RetrieveAllProjects());
} 
```

并在您视图的代码隐藏中，如此强烈地键入它：

```
//snip
public partial class Index : ViewPage<IEnumerable<Project>>
{
//snip 
```

您可能会认为将所有这些模型放在一边有点浪费，但如果您明智地使用模型，它会更容易理解，并使您的 UI 代码更苗条。

此外，模型是放置加载数据和构建模型本身的逻辑的好地方（事实上，应该是你做它的地方）。想想 ActiveRecord。而且，当您编写所有这些代码时，请意识到像 SubSonic 这样的项目会为您创建模型，而不会有任何麻烦或大惊小怪。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-23T21:00:22.070

没有用匿名类型尝试过，但这就是我通过将`List<T>`对象传递给`ViewData`

```
<% foreach (Project p in (IEnumerable<Project>)ViewData["ProjectSummary"]) { %>
     <%= Html.Encode(p.Title) %>
<% } %> 
```

希望这就是你要找的。

标记

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T17:10:23.447

问题不在于它是匿名类型。问题是它只是一个惰性求值的 IQueryable<> 对象，它还没有被求值。

我无法回答 ASP.NET MVC，但在非常相似的 Monorail 中，您必须将其从迭代器转换为实际集合：

```
 var projectData = (from p in db.Projects
                      orderby p.title
                      select new
                      {
                          Title = p.title,
                          DevURL = p.devURL ?? "N/A",
                          QAURL = p.qaURL ?? "N/A",
                          LiveURL = p.liveURL ?? "N/A",
                          Users = p.GetUsers().MakeUserList()
                      }).ToList(); 
```

# sql - 当有一个名为timestamp的字段时，Oracle为什么创建触发器失败？

> ID：284653
> 
> 赞同：5
> 
> 时间：2008-11-12T17:13:04.240
> 
> 标签：sql, oracle, ora-06553

我刚刚浪费了过去两个小时试图根据本教程创建一个具有自动递增主键的表[，](http://www.lifeaftercoffee.com/2006/02/17/how-to-create-auto-increment-columns-in-oracle/)本教程很棒，我遇到的问题是如果我有一个列，则创建目标会失败这是一个时间戳和一个在同一个表中称为时间戳的表......

为什么 oracle 在我创建表时不将此标记为问题？

这是我输入的命令序列：

1.  创建表：

    ```
    CREATE TABLE myTable
       (id NUMBER PRIMARY KEY,
        field1 TIMESTAMP(6),
        timeStamp NUMBER,
    ); 
    ```

2.  创建序列：

    ```
    CREATE SEQUENCE test_sequence
    START WITH 1
    INCREMENT BY 1; 
    ```

3.  创建触发器：

    ```
    CREATE OR REPLACE TRIGGER test_trigger  
    BEFORE INSERT  
    ON myTable  
    REFERENCING NEW AS NEW  
    FOR EACH ROW  
    BEGIN  
    SELECT test_sequence.nextval INTO :NEW.ID FROM dual;  
    END;  
    / 
    ```

这是我收到的错误消息：

```
ORA-06552: PL/SQL: Compilation unit analysis terminated
ORA-06553: PLS-320: the declaration of the type of this expression is incomplete or malformed 
```

任何没有两行和“时间戳”字样的组合都可以正常工作。我原以为语法足以区分关键字和列名。

正如我所说，我不明白为什么表创建得很好，但是当我尝试创建触发器时，oracle 崩溃了......

**澄清**

我知道问题在于有一个名为 timestamp 的列，它可能是也可能不是关键字。我的问题是为什么当我尝试创建触发器而不是创建表时它会发出声音，我至少会收到警告。

也就是说，使用 Oracle 几个小时后，它的错误报告似乎不那么冗长了，也许只是因为我使用的是 express 版本。

如果这是 Oracle 中的一个错误，没有支持合同的人将如何报告它？我只是在玩快速版本，因为我必须将一些代码从 MySQL 迁移到 Oracle。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-13T14:12:07.920

关于此（227615.1）摘录，metalink 上有一个注释：

```
# symptom: Creating Trigger fails
# symptom: Compiling a procedure fails
# symptom: ORA-06552: PL/SQL: %s
# symptom: ORA-06553: PLS-%s: %s     
# symptom: PLS-320: the declaration of the type of this expression is incomplete or malformed
    # cause: One of the tables being references was created with a column name that is one of the datatypes (reserved key word). Even though the field is not referenced in the PL/SQL SQL statements, this error will still be produced.

    fix:

    Workaround:

    1\. Rename the column to a non-reserved word.
    2\. Create a view and alias the column to a different name. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T20:58:43.300

TIMESTAMP 未在 Oracle 文档中作为保留字列出（这令人惊讶）。

它列在 V$RESERVED_WORDS 数据字典视图中，但其 RESERVED 标志设置为“N”。

这可能是触发器处理中的错误。我会说这是一个很好的 Oracle 支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T17:42:12.027

你自己已经暗示了答案。您将`timestamp`其用作列名，但它也是关键字。将列名更改为其他名称（例如`xtimestamp`）并编译触发器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T17:36:41.117

好吧，我对此并不完全确定，但我认为这是因为用于操作和访问数据库对象的 SQL 代码是由某种解释器解释的，与用于解释 PL/SQL 代码的解释器不同。

请记住，SQL 和 PL/SQL 是不同的东西，因此它们的处理方式不同。所以，我认为一个解释器有一些错误，只是不确定哪个是。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-16T19:14:19.900

不要让 Oracle 维护视图，而是使用 EXECUTE IMMEDIATE（即，如果“将列重命名为非保留字”不是一个选项。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-14T19:51:27.010

您可以通过 EXECUTE IMMEDIATE 执行。它不是更好的方法，而是工作并避免列重命名。

在我的情况下，重命名列将是一种混乱的方式

# parsing - 为分隔符分隔的块缓冲数据

> ID：284659
> 
> 赞同：2
> 
> 时间：2008-11-12T17:15:45.620
> 
> 标签：parsing, buffer, delimiter

有一个问题我多年来一直想知道，我希望有人能给我一个答案，让我放松一下。

假设我有一个输入流（如文件/套接字/管道）并且想要解析传入的数据。让我们假设每个传入数据块都由换行符分割，就像大多数常见的互联网协议一样。这个应用程序也可以解析 html、xml 或任何其他智能数据结构。关键是数据通过分隔符而不是固定长度分成逻辑块。如何缓冲数据以等待分隔符出现？

答案似乎很简单：只要有一个足够大的字节/字符数组来容纳整个事物。

但是如果分隔符出现在缓冲区已满之后呢？这实际上是一个关于如何将动态数据块放入固定大小的块中的问题。我真的只能想到几个替代方案：

1.  需要时增加缓冲区大小。这可能需要大量的内存重新分配，并且可能导致特制流的资源耗尽（或者甚至可能在我们想要保护自己免受耗尽攻击的套接字的情况下拒绝服务并丢弃试图耗尽资源的连接......和攻击者开始发送虚假的、超大的数据包以触发保护）。

2.  使用循环缓冲区开始覆盖旧数据。也许不是一个理想的方法，因为逻辑块会变得不完整。

3.  缓冲区已满时转储新数据。但是，这种方式永远找不到分隔符，所以这个选择显然不是一个好的选择。

4.  只需将固定大小的缓冲区变大，并假设所有传入的逻辑数据块都在其范围内……如果它被填满，只需将整个缓冲区解释为逻辑块……

无论哪种情况，我都觉得我们必须假设逻辑块永远不会超过一定的大小......

对这个话题有什么想法吗？显然必须有一种方法，因为高级语言通过其`readLine()`流方法提供了某种缓冲机制。

有没有“最好的方法”来解决这个问题，或者总是有一个权衡？我非常感谢关于这个主题的所有想法和想法，因为每次我需要编写某种解析器时，这个问题一直困扰着我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-29T01:09:25.670

通常有两种技术可以做到这一点

1）我认为 readline 使用什么 - 如果缓冲区填充返回数据，最后没有分隔符

2）当缓冲区填满时，记住它已填满，继续阅读，直到你得到分隔符并报告错误（或在缓冲区大小处截断记录）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T17:28:03.133

选项 (2) 和 (3) 不可用，因为在这两种情况下都会丢失数据。巨大的固定大小缓冲区的选项（4）不能解决问题，因为不可能知道什么大小足够大？是所有物理内存+交换空间+已知宇宙中所有磁盘中可用的可用空间吗？

调整缓冲区大小似乎是最好的解决方案。说重新分配到两倍大小并继续写入。总是有可能出现像 DoS 这样的特殊构造的流，它试图让系统崩溃。我的第一个想法是设置一个任意大的大小作为缓冲区的 max_size。但是，如果我们可以这样做，我们可以将其设置为大缓冲区的大小。所以，调整缓冲区的大小对我来说是最好的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T17:29:14.487

1.  如果协议或您没有为每个块的长度定义上限，那么我看不出如何防止内存耗尽边缘情况。

2.  假设有一个使用固定大小块的上限似乎是合理大小限制的好方法。

3.  如果限制足够高以至于单个固定缓冲区效率低下，那么我建议使用在内部实现为固定大小缓冲区链接列表的数据结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T18:12:25.897

为什么必须等待开始处理？

通常备选方案 4 是合理的。但是，它不需要“假设”，而是需要定义。您只需声明块小于 8K 即可。做起来并不难。

此外，还有备选方案 5：开始处理部分缓冲区。除非您设计了一个真正的病态协议，该协议可以在块的最后发送关键数据，否则这种方法是有效的。

HTML、XML、JSON/YAML 等都可以增量解析。您**不需要**分隔符来进行有用的处理。

# linux - 如何规范化 Bash 中的文件路径？

> ID：284662
> 
> 赞同：256
> 
> 时间：2008-11-12T17:16:06.900
> 
> 标签：linux, bash, unix, shell

我想转变`/foo/bar/..`为`/foo`

是否有执行此操作的 bash 命令？

* * *

编辑：在我的实际情况下，该目录确实存在。

* * *

## 回答 #1

> 赞同：254
> 
> 时间：2008-11-12T17:20:40.837

如果你想从路径中选择文件名的一部分，“dirname”和“basename”是你的朋友，“realpath”也很方便。

```
dirname /foo/bar/baz 
# /foo/bar 
basename /foo/bar/baz
# baz
dirname $( dirname  /foo/bar/baz  ) 
# /foo 
realpath ../foo
# ../foo: No such file or directory
realpath /tmp/../tmp/../tmp
# /tmp 
```

**`realpath`备择方案**

如果`realpath`你的 shell 不支持，你可以试试

```
readlink -f /path/here/.. 
```

还

```
readlink -m /path/there/../../ 
```

工作方式与

```
realpath -s /path/here/../../ 
```

因为路径不需要存在就可以标准化。

* * *

## 回答 #2

> 赞同：116
> 
> 时间：2008-11-12T17:19:24.413

我不知道是否有直接的 bash 命令来执行此操作，但我通常会这样做

```
normalDir="`cd "${dirToNormalize}";pwd`"
echo "${normalDir}" 
```

它运作良好。

* * *

## 回答 #3

> 赞同：65
> 
> 时间：2008-11-12T17:18:32.963

试试`realpath`。以下是其全部来源，特此捐赠给公共领域。

```
// realpath.c: display the absolute path to a file or directory.
// Adam Liss, August, 2007
// This program is provided "as-is" to the public domain, without express or
// implied warranty, for any non-profit use, provided this notice is maintained.

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <libgen.h>   
#include <limits.h>

static char *s_pMyName;
void usage(void);

int main(int argc, char *argv[])
{
    char
        sPath[PATH_MAX];

    s_pMyName = strdup(basename(argv[0]));

    if (argc < 2)
        usage();

    printf("%s\n", realpath(argv[1], sPath));
    return 0;
}    

void usage(void)
{
    fprintf(stderr, "usage: %s PATH\n", s_pMyName);
    exit(1);
} 
```

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2010-07-30T16:08:39.563

一个可移植且可靠的解决方案是使用 python，它几乎随处可见（包括 Darwin）。你有两个选择：

1.  `abspath`返回绝对路径但不解析符号链接：

    `python -c "import os,sys; print(os.path.abspath(sys.argv[1]))" path/to/file`

2.  `realpath`返回一个绝对路径，这样做会解析符号链接，生成规范路径：

    `python -c "import os,sys; print(os.path.realpath(sys.argv[1]))" path/to/file`

在每种情况下，`path/to/file`都可以是相对路径或绝对路径。

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2010-07-26T23:41:03.740

使用 coreutils 包中的 readlink 实用程序。

```
MY_PATH=$(readlink -f "$0") 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2016-03-14T19:49:50.647

老问题，但如果您在 shell 级别*处理完整路径名*，则有更简单的方法：

```
   abspath="$( cd "$path" && pwd )"
```

由于 cd 发生在子 shell 中，它不会影响主脚本。

假设您的 shell 内置命令接受 -L 和 -P，两种变体是：

```
   abspath="$( cd -P "$path" && pwd -P )" #物理路径解析符号链接
   abspath="$( cd -L "$path" && pwd -L )" #逻辑路径保留符号链接

```

就个人而言，除非出于某种原因我对符号链接着迷，否则我很少需要这种后一种方法。

仅供参考：获取脚本起始目录的变体即使脚本稍后更改它的当前目录也可以工作。

```
name0="$(basename "$0")"; #脚本的基本名称
dir0="$( cd "$( 目录名 "$0" )" && pwd )"; #绝对起始目录
```

使用 CD 可确保您始终拥有绝对目录，即使脚本是由 ./script.sh 等命令运行的，如果没有 cd/pwd，通常只会给出 .. 如果脚本稍后执行 cd 则无用。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2013-10-02T22:06:58.193

`readlink`是获取绝对路径的bash标准。如果路径或路径不存在（给定这样做的标志），它还具有返回空字符串的优点。

要获取可能存在也可能不存在但其父母确实存在的目录的绝对路径，请使用：

```
abspath=$(readlink -f $path) 
```

要获取必须与所有父级一起存在的目录的绝对路径：

```
abspath=$(readlink -e $path) 
```

要规范化给定路径并遵循符号链接（如果它们碰巧存在），否则忽略丢失的目录并返回路径，它是：

```
abspath=$(readlink -m $path) 
```

唯一的缺点是 readlink 将跟随链接。如果您不想关注链接，则可以使用此替代约定：

```
abspath=$(cd ${path%/*} && echo $PWD/${path##*/}) 
```

这将 chdir 到 $path 的目录部分并打印当前目录以及 $path 的文件部分。如果 chdir 失败，则会在 stderr 上得到一个空字符串和一个错误。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2011-06-18T02:38:07.910

正如 Adam Liss 所指出`realpath`的，并不是每个发行版都捆绑在一起。这是一种耻辱，因为它是最好的解决方案。提供的源代码很棒，我现在可能会开始使用它。这是我到目前为止一直在使用的，我在这里分享只是为了完整性：

```
get_abs_path() {
     local PARENT_DIR=$(dirname "$1")
     cd "$PARENT_DIR"
     local ABS_PATH="$(pwd)"/"$(basename "$1")"
     cd - >/dev/null
     echo "$ABS_PATH"
} 
```

如果您希望它解析符号链接，只需替换`pwd`为`pwd -P`.

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2011-10-10T19:47:20.270

我最近的解决方案是：

```
pushd foo/bar/..
dir=`pwd`
popd 
```

根据 Tim Whitcomb 的回答。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2012-05-29T23:16:49.947

不完全是答案，但可能是后续问题（原始问题不明确）：

`readlink`如果您真的想遵循符号链接，那很好。但也有一个仅规范化`./`and`../`和`//`序列的用例，这可以纯粹从语法上完成，*而无需*规范化符号链接。`readlink`对此没有好处，`realpath`.

```
for f in $paths; do (cd $f; pwd); done 
```

适用于现有路径，但适用于其他路径。

一个`sed`脚本似乎是一个不错的选择，除了你不能迭代地替换序列（`/foo/bar/baz/../..`-> `/foo/bar/..`-> `/foo`）而不使用 Perl 之类的东西，这在所有系统上都是不安全的，或者使用一些丑陋的循环来比较`sed`to它的输入。

FWIW，使用 Java (JDK 6+) 的单线：

```
jrunscript -e 'for (var i = 0; i < arguments.length; i++) {println(new java.io.File(new java.io.File(arguments[i]).toURI().normalize()))}' $paths 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2013-08-24T16:49:31.610

我迟到了，但这是我在阅读了一堆这样的线程后精心设计的解决方案：

```
resolve_dir() {
        (builtin cd `dirname "${1/#~/$HOME}"`'/'`basename "${1/#~/$HOME}"` 2>/dev/null; if [ $? -eq 0 ]; then pwd; fi)
} 
```

这将解析 $1 的绝对路径，与 ~ 配合使用，将符号链接保留在它们所在的路径中，并且不会弄乱您的目录堆栈。如果它不存在，它会返回完整路径或不返回任何内容。它期望 $1 是一个目录，如果不是，它可能会失败，但你自己做一个简单的检查。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-11-10T14:33:47.890

话多，回答有点晚。我需要写一个，因为我被困在较旧的 RHEL4/5 上。我处理绝对和相对链接，并简化 //、/./ 和 somedir/../ 条目。

```
test -x /usr/bin/readlink || readlink () {
        echo $(/bin/ls -l $1 | /bin/cut -d'>' -f 2)
    }

test -x /usr/bin/realpath || realpath () {
    local PATH=/bin:/usr/bin
    local inputpath=$1
    local changemade=1
    while [ $changemade -ne 0 ]
    do
        changemade=0
        local realpath=""
        local token=
        for token in ${inputpath//\// }
        do 
            case $token in
            ""|".") # noop
                ;;
            "..") # up one directory
                changemade=1
                realpath=$(dirname $realpath)
                ;;
            *)
                if [ -h $realpath/$token ] 
                then
                    changemade=1
                    target=`readlink $realpath/$token`
                    if [ "${target:0:1}" = '/' ]
                    then
                        realpath=$target
                    else
                        realpath="$realpath/$target"
                    fi
                else
                    realpath="$realpath/$token"
                fi
                ;;
            esac
        done
        inputpath=$realpath
    done
    echo $realpath
}

mkdir -p /tmp/bar
(cd /tmp ; ln -s /tmp/bar foo; ln -s ../.././usr /tmp/bar/link2usr)
echo `realpath /tmp/foo` 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2015-03-25T13:10:23.503

问题`realpath`在于它在 BSD（或 OSX 上）上不可用。[这是从 Linux Journal 的一篇相当旧的（2009 年）文章](http://www.linuxjournal.com/content/normalizing-path-names-bash)中提取的简单配方，它非常便携：

```
function normpath() {
  # Remove all /./ sequences.
  local path=${1//\/.\//\/}

  # Remove dir/.. sequences.
  while [[ $path =~ ([^/][^/]*/\.\./) ]]; do
    path=${path/${BASH_REMATCH[0]}/}
  done
  echo $path
} 
```

请注意，此变体**也不**需要存在路径。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2013-10-02T15:52:19.010

试试我们放在 GitHub 上的新 Bash 库产品[realpath-lib ，免费且不受阻碍地使用。](http://asymlabs.github.io/realpath-lib/)它有完整的文档记录，是一个很好的学习工具。

它解析本地、相对和绝对路径，除了 Bash 4+ 之外没有任何依赖项；所以它应该可以在任何地方工作。它是免费的、干净的、简单的和有启发性的。

你可以做：

```
get_realpath <absolute|relative|symlink|local file path> 
```

这个函数是库的核心：

```
function get_realpath() {

if [[ -f "$1" ]]
then 
    # file *must* exist
    if cd "$(echo "${1%/*}")" &>/dev/null
    then 
        # file *may* not be local
        # exception is ./file.ext
        # try 'cd .; cd -;' *works!*
        local tmppwd="$PWD"
        cd - &>/dev/null
    else 
        # file *must* be local
        local tmppwd="$PWD"
    fi
else 
    # file *cannot* exist
    return 1 # failure
fi

# reassemble realpath
echo "$tmppwd"/"${1##*/}"
return 0 # success

} 
```

它还包含 get_dirname、get_filename、get_stemname 和 validate_path 函数。跨平台尝试，并帮助改进它。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2015-06-27T08:50:05.273

根据@Andre 的回答，我可能有一个更好的版本，以防有人追求无循环、完全基于字符串操作的解决方案。它对于那些不想取消引用任何符号链接的人也很有用，这是使用`realpath`or的缺点`readlink -f`。

它适用于 bash 版本 3.2.25 及更高版本。

```
shopt -s extglob

normalise_path() {
    local path="$1"
    # get rid of /../ example: /one/../two to /two
    path="${path//\/*([!\/])\/\.\./}"
    # get rid of /./ and //* example: /one/.///two to /one/two
    path="${path//@(\/\.\/|\/+(\/))//}"
    # remove the last '/.'
    echo "${path%%/.}"
}

$ normalise_path /home/codemedic/../codemedic////.config
/home/codemedic/.config 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2021-03-04T05:08:17.570

如果你只是想规范化一个路径，存在或不存在，不接触文件系统，不解析任何链接，也没有外部工具，这里是一个纯**Bash**函数，从 Python 的`posixpath.normpath`.

```
#!/usr/bin/env bash

# Normalize path, eliminating double slashes, etc.
# Usage: new_path="$(normpath "${old_path}")"
# Translated from Python's posixpath.normpath:
# https://github.com/python/cpython/blob/master/Lib/posixpath.py#L337
normpath() {
  local IFS=/ initial_slashes='' comp comps=()
  if [[ $1 == /* ]]; then
    initial_slashes='/'
    [[ $1 == //* && $1 != ///* ]] && initial_slashes='//'
  fi
  for comp in $1; do
    [[ -z ${comp} || ${comp} == '.' ]] && continue
    if [[ ${comp} != '..' || (-z ${initial_slashes} && ${#comps[@]} -eq 0) || (\
      ${#comps[@]} -gt 0 && ${comps[-1]} == '..') ]]; then
      comps+=("${comp}")
    elif ((${#comps[@]})); then
      unset 'comps[-1]'
    fi
  done
  comp="${initial_slashes}${comps[*]}"
  printf '%s\n' "${comp:-.}"
} 
```

例子：

```
new_path="$(normpath '/foo/bar/..')"
echo "${new_path}"
# /foo

normpath "relative/path/with trailing slashs////"
# relative/path/with trailing slashs

normpath "////a/../lot/././/mess////./here/./../"
# /lot/mess

normpath ""
# .
# (empty path resolved to dot) 
```

就个人而言，我无法理解为什么 Shell（一种经常用于操作文件的语言）不提供处理路径的基本功能。在 python 中，我们有很好的库，如 os.path 或 pathlib，它们提供了一大堆工具来提取文件名、扩展名、基本名、路径段、拆分或连接路径，获取绝对或规范化路径，确定路径之间的关系，做任何事情都没有太多的大脑。他们会处理边缘情况，而且很可靠。在 Shell 中，要执行任何这些操作，我们要么调用外部可执行文件，要么必须使用这些极其原始和神秘的语法重新发明轮子......

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-05-06T10:28:14.603

我做了一个内置函数来处理这个问题，重点是尽可能高的性能（为了好玩）。它不解析符号链接，因此它与`realpath -sm`.

```
## A bash-only mimic of `realpath -sm`. 
## Give it path[s] as argument[s] and it will convert them to clean absolute paths
abspath () { 
  ${*+false} && { >&2 echo $FUNCNAME: missing operand; return 1; };
  local c s p IFS='/';  ## path chunk, absolute path, input path, IFS for splitting paths into chunks
  local -i r=0;         ## return value

  for p in "$@"; do
    case "$p" in        ## Check for leading backslashes, identify relative/absolute path
    '') ((r|=1)); continue;;
    //[!/]*)  >&2 echo "paths =~ ^//[^/]* are impl-defined; not my problem"; ((r|=2)); continue;;
    /*) ;;
    *)  p="$PWD/$p";;   ## Prepend the current directory to form an absolute path
    esac

    s='';
    for c in $p; do     ## Let IFS split the path at '/'s
      case $c in        ### NOTE: IFS is '/'; so no quotes needed here
      ''|.) ;;          ## Skip duplicate '/'s and '/./'s
      ..) s="${s%/*}";; ## Trim the previous addition to the absolute path string
      *)  s+=/$c;;      ### NOTE: No quotes here intentionally. They make no difference, it seems
      esac;
    done;

    echo "${s:-/}";     ## If xpg_echo is set, use `echo -E` or `printf $'%s\n'` instead
  done
  return $r;
} 
```

注意：此函数不处理以 开头`//`的路径，因为路径开头的两个双斜杠是实现定义的行为。但是，它处理`/`,`///`等就好了。

这个函数似乎可以正确处理所有边缘情况，但可能还有一些我没有处理过。

性能说明：当使用数千个参数调用时，运行速度比;`abspath`慢大约 10 倍。`realpath -sm`当使用单个参数调用时，`abspath`运行速度比`realpath -sm`在我的机器上快 110 倍以上，主要是因为不需要每次都执行新程序。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-03-16T19:24:16.443

基于loveborg的优秀python片段，我写了这个：

```
#!/bin/sh

# Version of readlink that follows links to the end; good for Mac OS X

for file in "$@"; do
  while [ -h "$file" ]; do
    l=`readlink $file`
    case "$l" in
      /*) file="$l";;
      *) file=`dirname "$file"`/"$l"
    esac
  done
  #echo $file
  python -c "import os,sys; print os.path.abspath(sys.argv[1])" "$file"
done 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-02-14T19:04:24.673

```
FILEPATH="file.txt"
echo $(realpath $(dirname $FILEPATH))/$(basename $FILEPATH) 
```

即使文件不存在，这也有效。它确实需要包含该文件的目录存在。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-03-10T10:49:19.290

我知道这是一个古老的问题。我仍在提供替代方案。最近我遇到了同样的问题，发现没有现有的便携式命令可以做到这一点。因此，我编写了以下 shell 脚本，其中包含一个可以解决问题的函数。

```
#! /bin/sh                                                                                                                                                

function normalize {
  local rc=0
  local ret

  if [ $# -gt 0 ] ; then
    # invalid
    if [ "x`echo $1 | grep -E '^/\.\.'`" != "x" ] ; then
      echo $1
      return -1
    fi

    # convert to absolute path
    if [ "x`echo $1 | grep -E '^\/'`" == "x" ] ; then
      normalize "`pwd`/$1"
      return $?
    fi

    ret=`echo $1 | sed 's;/\.\($\|/\);/;g' | sed 's;/[^/]*[^/.]\+[^/]*/\.\.\($\|/\);/;g'`
  else
    read line
    normalize "$line"
    return $?
  fi

  if [ "x`echo $ret | grep -E '/\.\.?(/|$)'`" != "x" ] ; then
    ret=`normalize "$ret"`
    rc=$?
  fi

  echo "$ret"
  return $rc
} 
```

[https://gist.github.com/bestofsong/8830bdf3e5eb9461d27313c3c282868c](https://gist.github.com/bestofsong/8830bdf3e5eb9461d27313c3c282868c)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-05-16T01:53:30.667

我需要一个可以完成所有三个方面的解决方案：

*   在库存 Mac 上工作。`realpath`并且`readlink -f`是插件
*   解析符号链接
*   有错误处理

没有一个答案同时具有#1 和#2。我添加了 #3 以节省其他人进一步的牦牛剃须。

```
#!/bin/bash

P="${1?Specify a file path}"

[ -e "$P" ] || { echo "File does not exist: $P"; exit 1; }

while [ -h "$P" ] ; do
    ls="$(ls -ld "$P")"
    link="$(expr "$ls" : '.*-> \(.*\)$')"
    expr "$link" : '/.*' > /dev/null &&
        P="$link" ||
        P="$(dirname "$P")/$link"
done
echo "$(cd "$(dirname "$P")"; pwd)/$(basename "$P")" 
```

这是一个简短的测试用例，路径中有一些扭曲的空格，以充分执行引用

```
mkdir -p "/tmp/test/ first path "
mkdir -p "/tmp/test/ second path "
echo "hello" > "/tmp/test/ first path / red .txt "
ln -s "/tmp/test/ first path / red .txt " "/tmp/test/ second path / green .txt "

cd  "/tmp/test/ second path "
fullpath " green .txt "
cat " green .txt " 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-12-09T14:17:13.087

由于所提供的解决方案都不适合我，因此在文件不存在的情况下，我实现了我的想法。André Anjos 的解决方案存在以 ../../ 开头的路径被错误解析的问题。例如 ../../a/b/ 变成了 a/b/。

```
function normalize_rel_path(){
  local path=$1
  result=""
  IFS='/' read -r -a array <<< "$path"
  i=0
  for (( idx=${#array[@]}-1 ; idx>=0 ; idx-- )) ; do
    c="${array[idx]}"
    if [ -z "$c" ] || [[ "$c" == "." ]];
    then
      continue
    fi
    if [[ "$c" == ".." ]]
    then
      i=$((i+1))
    elif [ "$i" -gt "0" ];
    then
      i=$((i-1))
    else
      if [ -z "$result" ];
      then
        result=$c
      else
        result=$c/$result
      fi
    fi
  done
  while [ "$i" -gt "0" ]; do
    i=$((i-1))
    result="../"$result
  done  
  unset IFS
  echo $result
} 
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2014-05-30T00:58:06.127

我今天发现你可以使用`stat`命令来解析路径。

所以对于像“~/Documents”这样的目录：

你可以运行这个：

`stat -f %N ~/Documents`

获取完整路径：

`/Users/me/Documents`

对于符号链接，您可以使用 %Y 格式选项：

`stat -f %Y example_symlink`

这可能会返回如下结果：

`/usr/local/sbin/example_symlink`

其他版本的 *NIX 上的格式化选项可能会有所不同，但这些在 OSX 上对我有用。

* * *

## 回答 #24

> 赞同：-4
> 
> 时间：2016-01-12T22:23:43.050

一个简单的解决方案`node.js`：

```
#!/usr/bin/env node
process.stdout.write(require('path').resolve(process.argv[2])); 
```

# session - 如何检查经典 ASP 中是否启用了会话 cookie？

> ID：284673
> 
> 赞同：2
> 
> 时间：2008-11-12T17:22:35.217
> 
> 标签：session, cookies, asp-classic, session-variables

**经典 ASP**中使用服务器端代码检查用户浏览器中是否启用了会话 cookie的一种优雅方式是什么（因为 javascript 也可能被禁用）。

我有自己的解决方案，但它看起来很丑陋。

@James - 虽然设置会话cookie和通用cookie没有区别（IE让您区分第一方，会话cookie和第三方，但我看到Firefox他们只区分第一方和第三方）？我在登录页面中设置一个会话值，然后做一个 Response.Redirect 有点事情并检查会话值是否仍然有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T20:43:01.553

除非您在 cookie 上指定过期时间，否则它将**是**会话 cookie。术语*会话*在 HTTP 中有点过载。当 IE 对话框引用会话 cookie 时，它​​意味着任何 cookie 仅存储在进程内存中而不持久化到磁盘，因此仅在进程（会话）期间存在。启动另一个 IExplore.exe 进程，您将拥有另一个会话，其中不包含任何先前或现有会话 cookie 的值。

你是对的，尽管你可以通过在会话对象中存储一个值并测试它在重定向上的存在来测试会话级别的 cookie 是否被阻止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T17:25:45.227

好吧，我们使用的“丑陋的地狱”方法是设置一个 cookie 并重定向到一个新页面。在新页面的代码中，查看是否设置了 cookie。由于到达第二页的唯一方法是在设置 cookie 时重定向到那里，所以它的存在或不存在应该告诉浏览器的状态。

# asp.net - 将 XMLWrite 输出发送到 httpContext.Response.OutputStream 时出现 NullReferenceException

> ID：284678
> 
> 赞同：1
> 
> 时间：2008-11-12T17:24:20.643
> 
> 标签：asp.net, null, objectoutputstream

我有一个应用程序，我时不时地遇到一个奇怪的错误。这是一段代码：

```
Dim XMLWriter As New System.Xml.XmlTextWriter(Me.Context.Response.OutputStream, Encoding.UTF8)
XMLWriter.WriteStartDocument()
XMLWriter.WriteStartElement("Status")

Message.SerializeToXML(XMLWriter)

XMLWriter.WriteEndElement()
XMLWriter.WriteEndDocument()
XMLWriter.Flush()
XMLWriter.Close() 
```

我得到的错误是：消息：对象引用未设置为对象的实例。

在线 XMLWriter.Flush();

为了让事情变得更有趣，这绝对是不可复制的。它只是时不时发生......

由于它在刷新 XML 时发生，我猜测现在为 null 的对象必须是 Response.OutputStream。

这是堆栈跟踪的相关部分：

```
Description:
An unhandled exception occurred and the process was terminated.

Exception: System.NullReferenceException

Message: Object reference not set to an instance of an object.

StackTrace:    at System.Web.HttpWriter.BufferData(Byte[] data, Int32 offset, Int32 size, Boolean needToCopyData)
   at System.Web.HttpWriter.WriteFromStream(Byte[] data, Int32 offset, Int32 size)
   at System.IO.StreamWriter.Flush(Boolean flushStream, Boolean flushEncoder)
   at System.Xml.XmlTextWriter.Flush()
   at RequestData.CompleteRequest(MessageBase Message) in RequestData.vb:line 142 
```

我的问题是，在什么情况下会发生这种情况？这个服务器是一个长轮询服务器，所以客户端要求一些东西，我可能会在 30 秒内没有回答......如果客户端断开连接（即关闭浏览器窗口），这个 Stream 是否有可能变为 Null？

还有其他想法吗？（任何指针表示赞赏）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T16:40:02.637

反射器给出了这个：

```
private void BufferData(byte[] data, int offset, int size, bool needToCopyData)
{
    int num;
    if (this._lastBuffer != null)
    {
        num = this._lastBuffer.Append(data, offset, size);
        size -= num;
        offset += num;
    }
    else if ((!needToCopyData && (offset == 0)) && !this._responseBufferingOn)
    {
        this._buffers.Add(new HttpResponseBufferElement(data, size));
        return;
    }
    while (size > 0)
    {
        this._lastBuffer = this.CreateNewMemoryBufferElement();
        this._buffers.Add(this._lastBuffer);
        num = this._lastBuffer.Append(data, offset, size);
        offset += num;
        size -= num;
    }
} 
```

唯一不通过其他方法检查、初始化或引用的对象（将显示在堆栈跟踪中）是 this._buffers。在该类中它设置为 null 的唯一位置是在 RecycleBufferElements() 中，如果您深入挖掘，可能会在客户端断开连接时发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T17:27:49.857

`Context.Response.OutputStream`不，如果它发生在您调用 Flush 时，那将比实际引用的唯一时间晚。该值在对`XmlTextWriter`构造函数的调用中获取，然后不再查看。

您是否有来自堆栈跟踪的更多信息？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-26T09:54:27.497

对 Flush 的调用将导致内存中缓存的任何内容被写入流并最终写入客户端，所以是的，这可能是问题所在。

您提到该请求预计需要很长时间才能执行，因此 ASP.Net 或 IIS 可能会过早地让您超时。我建议查看[web.config](http://msdn.microsoft.com/en-us/library/e1f13641.aspx)和类似设置中的 executionTimeout 属性。

# mysql - 操作巨大的 MySQL 转储文件

> ID：284679
> 
> 赞同：6
> 
> 时间：2008-11-12T17:24:29.643
> 
> 标签：mysql, linux, backup, restore

获取单个表的数据、删除单个表或将整个转储文件分解为每个包含单个表的文件的最简单方法是什么？我通常最终会做很多 vi 正则表达式修改，但我敢打赌，使用 awk/perl 等有更简单的方法来做这些事情。Google 结果的第一页带回了一堆不工作的 perl 脚本。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-12T19:43:25.153

当我需要从 sql 转储中提取单个表时，我使用 grep、head 和 tail 的组合。

例如：

```
grep -n "CREATE TABLE" dump.sql 
```

然后，这会为您提供每个表的行号，因此，如果您的表在第 200 行，而后面的表在第 269 行，我会这样做：

```
head -n 268 dump.sql > tophalf.sql
tail -n 69 tophalf.sql > yourtable.sql 
```

我想你可以扩展这些原则来敲出一个脚本，将整个事情分成每个表一个文件。

有人想在这里做吗？

另一个可能有助于启动 bash 循环的内容：

```
grep -n "CREATE TABLE " dump.sql  | tr ':`(' '  ' | awk '{print $1, $4}' 
```

这为您提供了一个很好的行号和表名列表，例如：

```
200 FooTable
269 BarTable 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-12T17:37:41.333

`mysqldump -T`如果可以的话，可以为自己节省很多麻烦并使用。

从[文档](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html#option_mysqldump_tab)中：

> --tab=路径，-T 路径
> 
> 生成制表符分隔的数据文件。对于每个转储表，mysqldump 创建一个 tbl_name.sql 文件，其中包含创建表的 CREATE TABLE 语句，以及一个包含其数据的 tbl_name.txt 文件。选项值是写入文件的目录。
> 
> 默认情况下，.txt 数据文件使用列值之间的制表符和每行末尾的换行符进行格式化。可以使用 --fields-xxx 和 --lines-terminated-by 选项明确指定格式。
> 
> 注意
> 仅当 mysqldump 与 mysqld 服务器在同一台机器上运行时，才应使用此选项。您必须具有 FILE 权限，并且服务器必须具有在您指定的目录中写入文件的权限。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-02-11T07:49:07.660

[这个 shell 脚本](http://kedar.nitty-witty.com/blog/mydumpsplitter-extract-tables-from-mysql-dump-shell-script/)将抓取你想要的表并将它们传递给`splitted.sql`.

它能够理解正则表达式，因为我添加了一个`sed -r`选项。

MyDumpSplitter 也可以将转储拆分为单独的表转储。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-20T08:25:58.890

[Maatkit](http://www.maatkit.org/)似乎非常适合[mk-parallel-dump](http://www.maatkit.org/doc/mk-parallel-dump.html)和[mk-parallel-restore](http://www.maatkit.org/doc/mk-parallel-restore.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-26T10:15:54.487

我在那个方面有点晚了，但如果它可以帮助任何人，我不得不拆分一个巨大的 SQL 转储文件，以便将数据导入另一个 Mysql 服务器。我最终做的是使用系统命令拆分转储文件。

**拆分 -l 1000 import.sql 拆分文件**

以上将每1000行拆分sql文件。

希望这可以帮助某人

# vb.net - 从 XSD 创建 dataset.designer.vb

> ID：284708
> 
> 赞同：6
> 
> 时间：2008-11-12T17:39:24.530
> 
> 标签：vb.net, visual-studio-2008, xsd, dataset, designer

我在 Visual Studio 2008 中有一个数据集的`.xsd`、`.vb`、`.xsc`和`.xss`文件，我从另一个 Visual Studio 项目复制了该数据集，但是我需要对数据集进行更改。因此，我进入了 XSD 文件，创建了新列，删除了不需要的列，等等。但是，当我尝试使用新数据集时，我意识到我并没有幕后的 Visual Basic 代码。此代码通常位于`dataset.designer.vb`. 当我复制旧的时，它当然不再有效，因为列发生了变化。

如何强制 Visual Studio 2008 使用`.xsd`文件并让它创建/更新其设计器代码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-08-10T14:21:01.240

您只需要排除您的`.xsd`文件并再次包含它。它将重新生成您的`designer.vb`文件。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-01-09T06:04:20.950

我不知道这是否仍然是其他人的常见问题，但我确实找到了答案（我认为）。单击解决方案资源管理器中的 .xsd 文件。将“自定义工具”属性更新为“MSDataSetGenerator”。这将自动重新生成 *.Designer.vb 文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-25T22:40:15.580

您可以右键单击 .xsd 文件并选择**“运行自定义工具”**以重新生成 dataset.designer.vb 文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T18:06:27.953

感谢您的帮助，最后我只是能够获得`dataset.vb`使用该`xsd.exe`工具生成的文件。它现在有效，但是，我仍然认为 Visual Studio 2008 中的某些设置不正确，或者至少 XSD 文件上下文菜单中的“生成数据集”菜单选项已经消失。

我只需要记住，如果我从这里开始修改 XSD 文件，Visual Studio 不会`.vb`自动更新文件，我可能会被重用`xsd.exe`程序卡住。

对于其他人，命令是（使用 Visual Studio 2008 命令提示窗口工具，如果使用 Windows Vista，则在管理员模式下）。

```
xsd.exe /d /l:VB "XSD FILE LOCATION PATH" 
```

`/d`表示创建数据集代码。`/l`是语言。

该`.vb`文件将在`C:\Windows\System32`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T17:58:54.770

不幸的是，这是我在需要时可以做的事情的灰色地带，但我不需要做足够的事情来将知识传授给他人。

我所知道的是，这`*.designer.vb`意味着这段代码是由 Visual Studio 生成的，如果它生成一次，它可以再次执行。此外，我这样做的次数很少（可能两次，都在 Visual Studio 2005 中），看起来就像将 *.xsd 文件添加到解决方案资源管理器一样简单。如果仅此一项还不行，请尝试显示所有文件或右键/双击 *.xsd。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-26T06:52:55.043

只需删除添加 xsd 文件时创建的额外 Designer.vb 文件。

# asp.net - 错误 4005 表单身份验证失败 - 提供的票证已过期

> ID：284709
> 
> 赞同：9
> 
> 时间：2008-11-12T17:39:34.577
> 
> 标签：asp.net, forms, authentication, asp.net-2.0

我正在使用 ASP.NET 2.0 运行一个网站。时不时地（每天 100 多个用户每天 10 次以上）我收到此错误：表单身份验证失败 - 提供的票证已过期。

这是我的 web.config 片段：

```
<authentication mode="Forms">
    <forms name=".CLLSAUTH" loginUrl="login.aspx" protection="All" path="/" timeout="60" />
</authentication> 
```

我看过几个解决方案，有人提到会话超时，但在我的配置中也是 60 分钟。还有两件事，我没有运行 webfarm，并且在错误发生时应用程序没有被回收。

有什么线索吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T17:47:12.190

我不确定你的问题是什么......在这种情况下，当用户打开浏览器超过一个小时时，他们的身份验证 cookie 会超时。下次他们向服务器 BAM 发送请求时。

尝试添加`slidingExpiration="true"`到表单元素。这样，每次用户点击服务器时超时都会重新启动。

这也可能是因为 IIS 回收了您的工作进程。您必须检查您的日志以查看是否在有人导致此错误之前发生了这种情况。

如果您的应用程序在不同的服务器上运行，则表单身份验证 cookie 中的机器密钥可能会出现问题，因为它源自不同的服务器。但从您的问题来看，这听起来不像是在网络农场上运行。

# sql-server - 无法使用别名连接到 SQL Server

> ID：284714
> 
> 赞同：3
> 
> 时间：2008-11-12T17:41:34.883
> 
> 标签：sql-server, sql-server-2000, alias

我在遇到奇怪连接问题的服务器上安装了 SQL Server 2000。

使用 SSMS 我无法使用我在 Configuration Manager 上设置的别名连接到它。别名设置为使用 TCPIP，这是按共享内存顺序排列的第一个协议。如果我使用在别名中输入的完全相同的服务器名称，那么我可以正常连接。

我在我的 ASP.NET 应用程序中看到完全相同的行为，使用连接失败的别名，使用它连接的名称就好了。ASP.NET 连接字符串未指定协议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T05:37:27.333

使用服务器名称将使用客户端的默认连接协议。这可能是命名管道或 tcp/ip（MDAC 版本、升级与安装等）。

> 别名设置为使用 TCPIP，它是共享内存以下顺序中的第一个协议

我假设如果客户端别名设置为使用 tcp，则服务器仅配置为侦听命名管道，因此它仅适用于服务器名称。客户端最终会在它要使用的协议列表中找到命名管道。

*要进行测试，请将 servername 替换为 np:servername 和 tcp:servername 以在不*使用别名的情况下更改协议。

或者检查服务器正在监听的内容并修复它......

另一个选项是非标准 TCP 端口（服务器，而不是 1433）或防火墙阻止访问端口 1433/1434。

[SQL 2000 书籍](http://doc.ddart.net/mssql/sql2000/html/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T17:43:56.983

别名是否指定了协议？服务器是否接受该协议？那是您按名称连接时使用的协议吗？（即客户端协议的顺序是什么）

# c++ - MSXML 选择节点不工作

> ID：284716
> 
> 赞同：3
> 
> 时间：2008-11-12T17:42:38.343
> 
> 标签：c++, xpath, msxml, selectnodes

我正在开发一个自动化测试应用程序，目前正在编写一个函数来比较两个应该相同但可能不相同的 XML 文件之间的值。这是我正在尝试处理的 XML 示例：

```
<?xml version="1.0" encoding="utf-8"?>
<report xmlns="http://www.**.com/**">
  <subreport name="RBDReport">
    <record rowNumber="1">
      <field name="Time">
        <value>0</value>
      </field>
      <field name="Reliability">
        <value>1.000000</value>
      </field>
      <field name="Unreliability">
        <value>0.000000</value>
      </field>
      <field name="Availability">
        <value> </value>
      </field>
      <field name="Unavailability">
        <value> </value>
      </field>
      <field name="Failure Rate">
        <value>N/A</value>
      </field>
      <field name="Number of Failures">
        <value> </value>
      </field>
      <field name="Total Downtime">
        <value> </value>
      </field>
    </record> 
```

（注意可能有多个`<subreport>`元素，并且在这些元素中，有多个`<record>`元素。）

我想要的是提取`<value>`两个文档的标签，然后比较它们的值。那部分我知道该怎么做。问题在于提取本身。

由于我被困在 C++ 中，所以我使用 MSXML，并编写了一个包装器以允许我的应用程序抽象出实际的 XML 操作，以防我决定更改我的数据格式。

该包装器 CSimpleXMLParser 加载 XML 文档并将其“顶级记录”设置为 XML 文档的文档元素。（CRecord 是一个抽象类，CXMLRecord 是其子类之一，它可以单独或按组访问子记录，还允许访问记录的“值”（在 CXMLRecord 的情况下，子元素或属性的值） .) CXMLRecord 包含一个 MSXML::MSXMLDOMNodePtr 和一个指向 CSimpleXMLParser 实例的指针。) 包装器还包含用于返回子项的实用函数，CXMLRecord 使用这些函数返回其子记录。

在我的代码中，我执行以下操作（尝试返回所有`<subreport>`节点以查看它是否有效）：

```
CSimpleXMLParser parserReportData;
parserReportData.OpenXMLDocument(strPathToXML);
bool bGetChildrenSuccess = parserReportData.GetFirstRecord()->GetChildRecords(listpChildren, _T("subreport")); 
```

这总是返回错误。CXMLRecord::GetChildRecords() 的实现内容基本上是

```
MSXML2::IXMLDOMNodeListPtr pListChildren = m_pParser->SelectNodes(strPath, m_pXMLNode);

if (pListChildren->Getlength() == 0)
{
    return false;
}

for (long l = 0; l < pListChildren->Getlength(); ++l)
{
    listRecords.push_back(new CXMLRecord(pListChildren->Getitem(l), m_pParser));
}

return true; 
```

CSimpleXMLParser::SelectNodes() 是：

```
MSXML2::IXMLDOMNodeListPtr CSimpleXMLParser::SelectNodes(LPCTSTR strXPathFilter, MSXML2::IXMLDOMNodePtr pXMLNode)
{
    return pXMLNode->selectNodes(_bstr_t(strXPathFilter));
} 
```

运行时，肯定会正确地将最高记录设置为`<report>`元素。我可以用它做各种各样的事情，比如获取它的子节点（通过 MSXML 接口，而不是通过我的包装器）或其名称等。我知道我的包装器*可以*工作，因为我在应用程序的其他地方使用它进行解析一个 XML 配置文件，并且可以完美运行。

我想也许我对 XPath 查询表达式做了一些错误的事情，但我能想到的每一种排列都不会让人高兴。当我尝试处理这个 XML 文件时，`MSXML::IXMLDOMNodeListPtr`返回的总是长度为 0。`IXMLDOMNodePtr::SelectNodes()`

这真让我抓狂。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-12T17:48:28.643

我习惯于使用 .NET 的 XmlDocument 对象来执行此操作，但我认为这里的效果是一样的：

如果 XML 文档包含一个名称空间——甚至是一个未命名的名称空间——那么 Xpath 查询也必须使用一个名称空间。因此，您必须将命名空间添加到 XMLDoument 中，您不妨在代码中给出一个名称，并在 XPATH 查询中包含前缀（xml 文档和xpath，只要命名空间把它整理出来）

因此，当您使用类似的 XPath`/report/subreport/record/field/value`时，您实际上需要首先设置文档的命名空间：

```
 pXMLDoc->setProperty(_bstr_t("SelectionNamespaces"),
                       _bstr_t("xmlns:r="http://www.**.com/**")); 
```

然后`selectNodes()`使用 `/r:report/r:subreport/r:record/r:field/r:value`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T17:46:10.613

当您选择节点时，我看不到对命名空间的引用。我希望这是根本问题。

# c# - System.Windows.Forms.ToolStrip 高度或自动调整大小

> ID：284721
> 
> 赞同：2
> 
> 时间：2008-11-12T17:44:43.240
> 
> 标签：c#, excel, excel-2007, toolstrip, officedev

我在 Excel 2007 操作窗格中使用了一系列工具条。我以编程方式将按钮添加到每个 ToolStrip，然后将每个 ToolStrip 添加到操作窗格。到现在为止还挺好; 我的 ToolStrips 及其关联的 ToolStripButtons 出现。

问题在于显示 ToolStrip 的全部内容。我将 ToolStrip.AutoSize 设置为 true （实际上是默认设置）。该属性的描述如下：

> "获取或设置一个值，该值指示控件是否自动调整大小以显示其全部内容。"

问题是，即使它设置为 true，我的 ToolStrips 也会显示操作窗格的宽度，但只有一行高；对于那些包含更多按钮的 ToolStrip，然后可以在该空间中显示 ToolStrip 不会垂直扩展以显示整组按钮，而是在右侧显示下拉箭头，允许用户查看剩余的纽扣。

那么，我的问题是我是否误解了这个属性（或者实际上是这个组件）的用法？例如，AutoSize 是否仅与水平空间有关？不管它值多少钱，我也尝试设置高度值无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T17:48:38.083

将“LayoutStyle”属性设置为“Flow”值。然后将项目流到下一行。

# regex - 如何使用 s/// 运算符将字符插入字符串？

> ID：284722
> 
> 赞同：2
> 
> 时间：2008-11-12T17:45:35.653
> 
> 标签：regex, perl, string

我正在尝试将注释字符插入到类似于以下内容的字符串中：

```
-CreateVideoTracker VT1 "vt name" 
```

变成

```
-CreateVideoTracker VT1 # "vt name" 
```

VT1 字实际上可以是任何东西，所以我使用的是正则表达式

```
$line =~ s/\-CreateVideoTracker \w/\-CreateVideoTracker \w # /g; 
```

这给了我结果：

```
-CreateVideoTracker w #T1 "vt name" 
```

有没有办法用一个正则表达式来做到这一点，还是我需要拆分字符串并手动插入评论？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-12T17:50:11.230

```
$line =~ s/^(\-CreateVideoTracker)\s+(\w+)/$1 $2 #/; 
```

正则表达式前半部分中的括号表达式（称为“捕获缓冲区”）被引用为`$1`, `$2`。等下半场。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-13T00:29:25.060

您可以使用`\K`Perl 5.10 正则表达式的功能；

```
$line=~s/^\-CreateVideoTracker\s+\w+\K/ #/; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T06:54:08.403

你有两个问题：

```
$line =~ s/\-CreateVideoTracker \w/\-CreateVideoTracker \w # /g; 
```

首先，你要匹配多个字符的单词，所以在左边，\w 应该是\w+。其次，你不能在右边使用像 \w 这样的模式；而是使用 () 在左侧捕获您想要的内容，并使用 $1、$2 等将其放在右侧：

```
$line =~ s/\-CreateVideoTracker (\w+)/\-CreateVideoTracker $1 # /g; 
```

# ruby-on-rails - 在 Ubuntu 上构建 Rails 应用程序时寻找 SVN 最佳实践

> ID：284732
> 
> 赞同：1
> 
> 时间：2008-11-12T17:48:19.423
> 
> 标签：ruby-on-rails, ruby, svn, ubuntu, rapidsvn

**首先介绍一下背景。**

在我的整个开发生涯中，我一直在 MS 平台上工作。直到两周前，我从未启动过除 98/XP/Vista 之外的任何其他操作系统。我很久以前就开始使用 VSS，大约 2 年前更改为 SVN。对于 SVN，我使用 TortiseSVN 并使用标准的分支/标签/主干设置。

我的项目也是独立的，这意味着我可以去一个新的开发框，拉下一个存储库，打开 VS，按 F5，它就会运行（大部分时间）。所有依赖项都存储在一个`lib`文件夹中，源代码在一个`src`文件夹中，等等......

为了学习新事物，我决定构建一个 Ruby on Rails 应用程序并创建了一个基于 Ubuntu 的开发机器。我已经启动并运行了一个 SVN 服务器，并且正在与另一个人一起在这个项目上工作。他碰巧使用 Mac 作为他的开发机器。

**现在是问题。**

我似乎在为如何管理各种版本的 ruby​​、rails 和我正在使用的所有插件而苦苦挣扎。我似乎也在努力在 Ubuntu 上使用 SVN。

所以 Ubuntu 预装了 Ruby。我想说它是 1.8.5 版本。无论哪种方式，我都为我正在使用的插件（社区引擎）安装了一堆宝石。作为 *nix 的新手，我在安装它们时没有使用`sudo`它们并遇到了各种问题。我最终彻底摆脱了 Ruby 并重新开始。这似乎奏效了。

但问题是，在我提交我的代码之后，另一个人得到最新的，他必须经历安装 gems 的整个过程。

**在 RoR 应用程序中管理 gem 和插件的最佳实践是什么？**我不在乎是否将无数文件添加到 SVN。磁盘空间和网络带宽很便宜。我只是不知道如何正确地做到这一点。

等到SVN。

我已经安装了 RapidSVN，但经常遇到文件夹被锁定的问题。有几次我意识到我的错误，其他人，我不知道为什么。但在这两种情况下，我都无法修复它。我最终备份了我的代码，下载了一个新的工作副本，然后手动移动更改并在将它们提交到项目时变得更聪明一些。

昨晚我实际上有点 RTFM，发现我应该为我的 repos 创建一个书签，然后从那个书签做一个“结帐工作副本”。我不知道为什么，但是好的，这就是手册所说的......

**在 Ubuntu 上的 RoR 项目中使用 SVN 有哪些最佳实践？**

我真的在寻找这个的一步一步的过程。

*编辑* 我忘了提及，我将 NetBeans 用于我的 IDE，虽然我还没有查看它有什么样的 SVN 支持（如果有的话）。我查看了 RubyMine，很想使用它，但它现在似乎太不稳定了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T20:24:16.333

对于插件，我个人建议将它们粘贴在 vendor 文件夹中并将它们添加到 SVN，就好像您自己编写代码一样。Piston 也是一个很好的解决方案，但是当所有常用插件都开始迁移到 github 时，就放弃了它（从那时起，piston 一直不可靠）

对于 gems，希望您使用的是 rails 2 或更高版本。您应该在`config/environment.rb`using中列出您需要的宝石`config.gem`。[这是有关该功能的大量信息](http://ryandaigle.com/articles/2008/4/1/what-s-new-in-edge-rails-gem-dependencies)

这意味着如果您添加一个新的 gem，下次您的同事更新时，他的 rails 应用程序*将无法启动*，直到他获得必要的 gem。然后他可以使用一步安装它们`sudo rake gems:install`

您可以更进一步，将您的 gem 放在 vendor 目录中。这通常被称为“供应商一切”。最简单的方法是列出你在`environment.rb`上面使用的所有 gem，然后运行`rake gems:unpack`​​. 然而，这种方法有两个问题，所以我不想自己使用它。

1.  如果您有 10 个应用程序并且每个应用程序都提供了他们的 gem，那么您最终会在 subversion 中保留 10 个通用 gem 的副本，这使得更新所有站点的速度要慢得多。
    这对您来说可能不是问题，或者可能值得忍受，这只是个人喜好。

2.  一些 gem（例如 mongrel 或 hpricot）具有用 C 编写的本机扩展。这意味着当您安装它们时，`.c`会下载源代码，并`gcc`运行以专门为您的系统编译它。
    如果您在 ubuntu 上安装了原生 C 扩展，然后将其放在 vendor 文件夹中，然后尝试在 OS X（甚至可能是不同版本的 ubuntu）上运行它，它很可能会使您的 ruby​​ 进程崩溃并带来您的应用程序向下。
    如果您所有的宝石都是纯红宝石，那么这不是问题，但这只是需要注意的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T18:08:28.463

许多人使用活塞或沙漠来管理插件并将 gem 安装到 Rail 本地供应商文件夹（存储在 SVN 下）。

[http://www.rubyinside.com/advent2006/12-piston.html](http://www.rubyinside.com/advent2006/12-piston.html) [http://pivotallabs.com/users/brian/blog/articles/459-build-your-own-rails-plugin-platform-with-desert](http://pivotallabs.com/users/brian/blog/articles/459-build-your-own-rails-plugin-platform-with-desert)

我还建议使用 geminstaller，它可以帮助您安装所有相同的 gem 和它们的相同版本

[http://geminstaller.rubyforge.org/](http://geminstaller.rubyforge.org/)

我从命令行使用 SVN，但如果您对 TortiseSVN 更熟悉，您可能想尝试 SVN 很好集成的 IDE，如 RadRails 和 NetBeans。IDE 具有非常相似的图形 SVN 管理器，类似于 Tortise，如果你想在 cmd 行上工作，只需找到一个简单的 10 分钟 SVN 教程，你应该很高兴。

我从来没有听说过快速 SVN，普通的 SVN 工具一直都可以在我身上找到，几乎不会导致锁定文件夹问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T10:32:21.397

Orion 提到在不同操作系统之间共享它们时必须重建已售出的 gem - 您可以使用 gems:build rake 任务自动重建它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T18:53:25.650

首先，从命令行找出 svn。[svn-book](http://svnbook.red-bean.com/)上线了。执行 svn status 或 svn commit -m "blah" 并不难。如果您使用操作系统功能删除或重命名文件，大多数问题都会出现。为此使用 svn 命令。

接下来，如果 rapidsvn 不适合您，请尝试 svn-workbench。讨厌这么说，但是我见过的 linux svn GUI 工具没有一个像 tortoisesvn 一样好。

插件和 svn 是个问题。有一种叫做[活塞](http://piston.rubyforge.org/)的工具旨在清除它，尽管我不使用它。我将插件检出到我的供应商/插件目录中。如果出现了我真正想要的新版本，我会使用我值得信赖的 update_plugin bash 脚本来更新插件：

```
#!/bin/bash

#  reinstall the plugin in an svn friendly way
plugin="some_plugin"
plugin_url="http://some_server/some_plugin/trunk"

for f in site1 site2 site3
do
  echo $f
  cd ~/rails/$f

  svn delete vendor/plugins/$plugin
  rm -rf vendor/plugins/$plugin
  svn -m "remove $plugin" commit
  script/plugin install $plugin_url
  svn add vendor/plugins/$plugin
  svn -m "add $plugin" commit

done 
```

# mysql - 如何在 Perl DBI 查询中插入带引号的字符串？

> ID：284740
> 
> 赞同：7
> 
> 时间：2008-11-12T17:50:20.717
> 
> 标签：mysql, perl

使用 DBI 将可以包含单引号和双引号 (",') 的字符串插入 MySql 的首选方法是什么？例如，`$val1`可以`$val2`包含引号：

```
my $dbh = DBI->connect( ... );
my $sql = "insert into tbl_name(col_one,col_two) values($val1, $val2)";
my $sth = $dbh->prepare($sql);
$sth->execute(); 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-12T17:58:16.520

使用绑定查询

```
$sth = $dbh->prepare("insert into tbl_name(col_one,col_two) values(?,?)");
$sth->execute($val1, $val2); 
```

如果你使用绑定变量，一切都会为你转义。

更新：将我的示例更改为与编辑到问题中的示例相对应。

更新：我不知道为什么亚当删除了他的答案，但如果由于某种原因你不能使用绑定变量（又名“占位符”），你也可以`$dbh->quote($var)`在变量上使用。例如：

```
$sql = sprintf "SELECT foo FROM bar WHERE baz = %s",
    $dbh->quote(q("Don't")); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T17:58:38.657

使用`quote()`方法。它将智能地为您处理报价。[文档](http://search.cpan.org/~timb/DBI/DBI.pm#quote)中的示例：

```
$sql = sprintf "SELECT foo FROM bar WHERE baz = %s",
            $dbh->quote("Don't"); 
```

稍作修改以具有两种类型的引号：

```
$sql = sprintf "SELECT foo FROM bar WHERE baz = %s",
            $dbh->quote(q("Don't")); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-13T17:00:14.163

关于绑定占位符的一个小警告，我构建了一个相当大的数据库加载脚本，该脚本最初在旧版本的 Perl/DBI 中使用绑定占位符，并发现占位符实现中似乎存在内存泄漏，所以如果你正在寻找在持久进程/守护进程或大容量上下文中使用它们时，您可能希望确保进程大小不会成为问题。切换到使用 quote() 方法构建查询字符串为我消除了这个问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-05-23T14:46:57.057

DBI 占位符很棒。当您需要在循环中执行相同的查询时，它们会发光。考虑一下：

```
 my $dbh = DBI->connect(...);
  my $name_pairs = get_csv_data("data.csv");
  my $sth = $dbh->prepare("INSERT INTO t1 (first_name, last_name) VALUES (?,?)");
  for my $pair (@$name_pairs) {
     unless ($sth->execute(@$pair)) {
         warn($sth->errstr);
     }
  } 
```

在这种情况下，使用准备好的语句句柄非常方便。

但是，除非出现这种紧密循环的情况，否则我希望看到发送到服务器的实际语句。这是我非常依赖报价和坦率地说 sprintf 的地方。

```
 # Here, I am confident about the hash keys, less so about the values
   $sql = sprintf("INSERT INTO t1 (%s) VALUES (%s)",
                    join(",", keys(%hash)),
                    join("," map { $dbh->quote($_) } values(%hash))
                  );
   $sth = $dbh->prepare($sql);
   unless ($sth->execute) {
     warn($sth->{Statement});
   } 
```

请注意，您必须在 $dbh 上设置 RaiseError => 0 以便您可以看到失败的 SQL，但这在过去对我有很大帮助。

干杯。

# python - 在 python 中处理分块编码的 HTTP POST 请求（或 apache 下的通用 CGI）

> ID：284741
> 
> 赞同：5
> 
> 时间：2008-11-12T17:50:29.560
> 
> 标签：python, http, post, java-me, midlet

我有一个 j2me 客户端，可以将一些分块的编码数据发布到网络服务器。我想用python处理数据。该脚本作为 CGI 脚本运行，但显然 apache 将拒绝对 CGI 脚本的分块编码后的请求。据我所知，mod_python、WSGI 和 FastCGI 也不行。

我想知道是否有办法让python脚本处理这种输入。我对任何建议持开放态度（例如，apache2 中的配置设置会组装块，独立的 python 服务器会做同样的事情等）我做了很多谷歌搜索，但没有找到任何可用的东西，这是很奇怪。

我知道在服务器端使用 java 是一种解决方案，但我无法想象这不能用 apache + python 来解决。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-27T11:51:03.947

I had the exact same problem a year ago with a J2ME client talking to a Python/Ruby backend. The only solution I found which *doesn't* require application or infrastructure level changes was to use a relatively unknown feature of mod_proxy.

Mod_proxy has the ability to buffer incoming (chunked) requests, and then rewrite them as a single request with a Content-Length header before passing them on to a proxy backend. The neat trick is that you can create a tiny proxy configuration which passes the request back to the same Apache server. i.e. Take an incoming chunked request on port 80, "dechunk" it, and then pass it on to your non-HTTP 1.1 compliant server on port 81.

I used this configuration in production for a little over a year with no problems. It looks a little something like this:

```
ProxyRequests Off

<Proxy http://example.com:81>
  Order deny,allow
  Allow from all
</Proxy>

<VirtualHost *:80>
  SetEnv proxy-sendcl 1
  ProxyPass / http://example.com:81/
  ProxyPassReverse / http://example.com:81/
  ProxyPreserveHost On
  ProxyVia Full

  <Directory proxy:*>
    Order deny,allow
    Allow from all
  </Directory>

</VirtualHost>

Listen 81

<VirtualHost *:81>
  ServerName example.com
  # Your Python application configuration goes here
</VirtualHost> 
```

I've also got a full writeup of the problem and my solution detailed [on my blog](http://www.atnan.com/2008/8/8/transfer-encoding-chunked-chunky-http).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T17:56:15.650

我会说使用扭曲的框架来构建您的 http 侦听器。Twisted 支持分块编码。

[http://python.net/crew/mwh/apidocs/twisted.web.http._ChunkedTransferEncoding.html](http://python.net/crew/mwh/apidocs/twisted.web.http._ChunkedTransferEncoding.html)

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T18:32:21.363

Apache 2.2 mod_cgi 对我来说工作得很好，当请求被传递给 CGI 应用程序时，Apache 会透明地取消分块。

WSGI 当前不允许分块请求，而 mod_wsgi 确实会通过 411 响应阻止它们。它在 WSGI 2.0 的绘图板上。但是恭喜你找到了可以执行块请求的东西，我以前从未见过！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-29T00:13:45.113

你不能用 mod_python 做你想做的事。如果您使用的是 3.0 版，则可以使用 mod_wsgi 来完成。但是，您必须跳出 WSGI 1.0 规范，因为 WSGI 有效地禁止了分块的请求内容。

[在http://code.google.com/p/modwsgi/wiki/ChangesInVersion0300](http://code.google.com/p/modwsgi/wiki/ChangesInVersion0300)中搜索 WSGIChunkedRequest 以了解所需内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T18:29:05.957

也许是配置问题？Django 可以通过 mod_python、WSGI 和 FastCGI 与 Apache 连接，并且可以接受文件上传。

# web-services - REST Web 服务的“WSDL”的首选方法是什么？

> ID：284743
> 
> 赞同：7
> 
> 时间：2008-11-12T17:52:44.487
> 
> 标签：web-services, rest, wsdl

我已经构建了大量的 SOAP 网络服务，但是正在为一个特定的项目构建一个 REST 网络服务，我想知道人们将什么用于 REST 服务的“WSDL”，或者是否需要它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-12T18:58:20.657

REST 实际上只对资源使用 HTTP 动词（GET、PUT、POST、DELETE）。对资源的所有操作都应该以这种方式表示。当您无法以适合其他三种方式表达您的业务逻辑时，POST 被用作一个包罗万象的方法。这就是为什么 REST 服务没有真正的 WSDL 的原因，因为您在资源上只有 4 个方法。请注意，Zend Framework REST 库并不是真正的 RESTful，它更像是一个普通的旧 XML (POX) 服务。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-14T00:00:02.180

虽然 Sam 正确地认为 RESTful Web 应用程序不需要直接模拟 WSDL，但有一个 XML 词汇表对描述 RESTful Web 应用程序很有用：WADL，或[Web Application Description Language](http://en.wikipedia.org/wiki/Web_Application_Description_Language)。在我的公司，我们主要使用 WADL 为我们想要构建的给定服务定义规范——我们通常不以编程方式使用它。也就是说，[WADL 主页](https://wadl.dev.java.net/)包含一些用于代码生成的 Java 工具，而 Java REST 框架[Restlet](http://www.restlet.org)包含一个 WADL 扩展，用于基于 WADL 动态连接应用程序并基于连接应用程序动态生成 W​​ADL。我是 WADL 的粉丝，建议你去看看。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-01-16T15:01:21.477

您可以尝试[Swagger](http://swagger.io/)（现为 OpenAPI），它允许使用 JSON 开放标准来描述 REST 服务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T21:17:49.537

实际上，可以为此使用 WSDL，但它应该是 v 2.0 - 请参阅“[使用 WSDL 2.0 描述 REST Web 服务](http://www.ibm.com/developerworks/webservices/library/ws-restwsdl/ "本文")”一文。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T18:15:27.047

如果您在 REST 服务中使用 XML，则可以提供 XSD。

或者只是 XML 的示例，无论如何都应该足以解决简单数据结构的问题。

# asp.net - 如何以声明方式将当前用户传递给 Web 控件

> ID：284744
> 
> 赞同：1
> 
> 时间：2008-11-12T17:52:48.603
> 
> 标签：asp.net, controls, asp.net-membership

我正在创建一个控件，需要将当前登录用户作为参数传递给它（以声明方式）

我试过这个但没有用（我得到了“<%= User.Identity.Name %>”作为值）：

```
<cc1:MyControl id="myid" runat="server" User="<%= User.Identity.Name %>" /> 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T17:58:21.573

为什么你需要通过它呢？用户控件可以直接访问 User.Identity.Name 属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T17:57:43.523

在该控件中，您将可以访问 this.Page.User，这是一种方法。另一种是使用HttpContext.Current.User。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T18:00:42.503

您可以在代码隐藏中执行此操作：

```
myid.User = User.Identity.Name 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T17:54:50.097

尝试使用：

```
User="<%= User.Identity.Name %>" 
```

%= 用于输出

%# 用于数据绑定。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T17:55:36.850

尝试将 User 属性中的双引号更改为单引号。我以前看过那个作品...

# winapi - 调整套接字连接调用超时

> ID：284748
> 
> 赞同：2
> 
> 时间：2008-11-12T17:55:04.217
> 
> 标签：winapi, sockets, timeout, connect

在 Win32 环境中是否有任何方法可以“调整”套接字`connect()`调用的超时？具体来说，我想增加超时长度。正在使用的套接字是非阻塞的。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-13T11:01:11.913

是的，这是可能的。

如果您在 之后处于非阻塞模式[`connect()`](http://msdn.microsoft.com/en-us/library/ms737625(VS.85).aspx)，则通常使用[`select()`](http://msdn.microsoft.com/en-us/library/ms740141(VS.85).aspx)等待 I/O 准备好。该函数有一个用于指定超时值的参数，如果超时将返回 0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-03-26T06:33:21.863

您可以尝试使用 SO_RCVTIMEO 和 SO_SNDTIMEO 套接字选项来设置任何套接字操作的超时。例子：

```
struct timeval timeout;      
timeout.tv_sec = 10;
timeout.tv_usec = 0;

if (setsockopt (sockfd, SOL_SOCKET, SO_RCVTIMEO, (char *)&timeout,
            sizeof(timeout)) < 0)
    error("setsockopt failed\n");

if (setsockopt (sockfd, SOL_SOCKET, SO_SNDTIMEO, (char *)&timeout,
            sizeof(timeout)) < 0)
    error("setsockopt failed\n"); 
```

你也可以试试alarm()。样本：

```
signal( SIGALRM, connect_alarm ); /* connect_alarm is you signal handler */
alarm( secs ); /* secs is your timeout in seconds */
if ( connect( fd, addr, addrlen ) < 0 )
{
    if ( errno == EINTR ) /* timeout, do something below */
        ...
}
alarm( 0 ); /* cancel the alarm */ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-09T00:25:29.350

不，这是不可能的。默认连接超时可以减少，但不能增加。

# excel - 简单的 Excel 小程序

> ID：284750
> 
> 赞同：1
> 
> 时间：2008-11-12T17:55:41.377
> 
> 标签：excel, macos, applescript

我是 Applescripts 和 Excel 08 的新手？我想写一个在 Excel 08 特定颜色中任意预选单元格的颜色。我可以让它在预选的单元格中写下需要，甚至加粗字体……但由于某种原因，它不会改变单元格的颜色……

```
print("Tell application "Microsoft Excel"
activate
set formula of active cell to "excellent answer"
set bold of font object of active cell to true
activate cell active cell"); 
```

这部分由于某种原因不起作用`

```
print("tell interior object of active cell of active sheet
    set color index to 3
    set pattern to pattern gray 50
    set pattern color index to 13
end tell"); 
```

不知道为什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-01-28T14:10:00.433

我能够使用以下 AppleScript 在 Excel 08（现在是 2011）中设置特定单元格的颜色：

```
tell sheet "Sheet1" of theWorkbook    
set color of interior object of range C2:C2 to {255, 255, 0}
end tell 
```

我必须在特定范围内指定颜色并使用红色、蓝色和绿色分量值（从 0 到 255）。

# c# - 在 C# 中打开目录选择器

> ID：284751
> 
> 赞同：21
> 
> 时间：2008-11-12T17:56:03.903
> 
> 标签：c#, wpf, winforms

我正在编写一个快速而肮脏的应用程序，它从给定目录中读取所有文件。我目前正在使用 OpenFileDialog 来选择一个目录并剔除它提供的文件名。似乎应该有一种方法来选择目录，但是在快速浏览 MSDN 时我没有找到它。

如果您在 winforms 中或者更喜欢在 WPF 中有方法，我会全力以赴。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-11-12T17:58:20.263

您需要使用[FolderBrowserDialog](http://msdn.microsoft.com/en-us/library/system.windows.forms.folderbrowserdialog.aspx)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-04-03T14:31:50.663

```
using FORMS = System.Windows.Forms;

var dialog = new System.Windows.Forms.FolderBrowserDialog();
FORMS.DialogResult result = dialog.ShowDialog();
if (result == FORMS.DialogResult.OK)
{
    MessageBox.Show("Result: " + dialog.SelectedPath);
} 
```

# java - nbsp 上的默认处理程序实现中断

> ID：284761
> 
> 赞同：0
> 
> 时间：2008-11-12T17:58:31.090
> 
> 标签：java, xml

我有一个默认处理程序的实现。当它到达字符数据中的 a 时，它会停止解析。它这样做有什么理由吗？是否需要设置其他属性才能处理  ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T22:27:34.747

这会中断，因为未定义 XML 实体。你可以添加

```
<!DOCTYPE document  SYSTEM "document.dtd" [ 
<!ENTITY nbsp "&#160;"> 
]> 
```

或者只是使用`&#160;`。（注意末尾的“;”）

也见[这里](http://www.dpawson.co.uk/xsl/characters.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T19:37:58.580

`&nbsp;`不是有效的 xml 实体。您可以尝试用它`&#160;`代替它，它会做同样的事情（不间断空间）。

# sharepoint - 如何在不填写必填字段的情况下保存内容类型的单词模板

> ID：284765
> 
> 赞同：2
> 
> 时间：2008-11-12T17:59:29.620
> 
> 标签：sharepoint, moss, content-type, word-template

我有一个包含必填字段的内容类型。我已将 Word 文档与内容类型关联为模板。我现在想编辑 Word 模板，但 word 不允许我在未填写必填字段的情况下保存模板。但是，如果我填写了必填字段并保存了文档，那么当您创建新文档时，这些字段将填充我的值。这不好，因为我希望在创建新文档时字段为空白 - 我希望用户被迫填写这些值。

我可以通过更新列并使它们成为可选、编辑单词模板、保存模板然后将列更改回所需来更新模板。这是一个 PITA - 一定有更好的方法，有人知道它是什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-08-27T21:33:16.337

我一直在使用这个解决方法：当我编辑模板时（即转到内容类型设置 --> 高级设置 --> 编辑模板），我进行更改并将文件保存在本地。然后，在我单击“编辑模板”链接的同一页面上，我上传了我在本地保存的副本。将其保存在本地可避免在您尝试将其保存回 SharePoint 时发生的验证。但是验证仍然适用于该内容类型的任何新文档。所以无需关闭和打开设置！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T01:56:12.393

您是否尝试过将文档另存为普通文档内容类型、进行更改、保存，然后返回到旧版本模板所在的位置？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-15T11:30:20.457

我发现的唯一解决方案是在库级别修改文档模板。只需上传所需内容类型的新文档模板。但是，如果您想在不同的文档库中重复使用一种相同的内容类型，这将不起作用。

# wpf - 不透明度 = 0 时的绘图视觉性能

> ID：284766
> 
> 赞同：4
> 
> 时间：2008-11-12T17:59:54.440
> 
> 标签：wpf

如果我在 WPF 中有一个不透明度 = 0 的 DrawingVisual，是否足以让它不被绘制？我们在 Canvas 上有数百个 DrawingVisual，目前正在将不显示的视觉效果设置为 Opacity=0，我想确保渲染 Opacity=0 的 DrawingVisual 不会影响渲染性能。

更新：我通过测试发现，当 Opacity=0 时存在开销，但由于 DrawingVisual 没有 Visibility 属性，我不知道你会如何告诉它不显示，除非你实际上将它从视觉中删除树，所以欢迎任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T03:56:20.607

我通过使用 a[`DrawingGroup`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.drawinggroup)并从中添加或删除[`Drawing`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.drawing)对象解决了一个非常相似的问题，`DrawingGroup`因为它们需要显示或隐藏。关键是以`Drawing`易于管理的方式组织您的对象，并了解如何在`DrawingGroup`.

请记住，您要从属性公开 的对象中添加和删除`Drawing`对象。所以使用或其他方法：, , , . 您需要保留您添加/删除的对象的外部列表才能成功执行此操作。[`DrawingCollection`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.drawinggroup.children)[`DrawingGroup.Children`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.drawingcollection)[`DrawingGroup.Children.Add()`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.drawingcollection.add)`DrawingCollection`[`Insert`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.drawingcollection.insert)[`Remove`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.drawingcollection.remove)[`RemoveAt`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.drawingcollection.removeat)[`Clear`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.drawingcollection.clear)`Drawing``DrawingGroup`

我通过在我的实例中将图像（位图）绘制到第一个子对象中，然后向该实例中`DrawingGroup`添加和删除对象，以便在绘图顶部分层多边形、路径、文本等，从而使用这种技术取得了很好的效果。 `Drawing``DrawingGroup`

我通过将对象添加或删除`Drawing`到`DrawingGroup`. 被`DrawingGroup`视为单个`Drawing`，因此任何缩放、平移或其他操作都会`Drawing`影响`DrawingGroup`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T10:22:16.200

最好的检查方法是将 Visibility 设置[为](http://msdn.microsoft.com/en-us/library/system.windows.uielement.visibility.aspx)Visibility.Colapsed，并查看是否存在任何绘图性能差异。

Visibility.Colapsed 确保元素不可见，但也不会参与 UI 的 Arrange、Measure 和 Render 通道，而 Opacity=0 的元素可能会参与所有通道。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T10:07:57.617

最有效的似乎是在我的测试中设置不透明度。另一种简单的方法是重绘受影响的视觉效果。

```
using (DrawingContext dc = RenderOpen()) {} //Hide this visual 
```

然后在它们再次可见时重绘。

渲染一个空白的绘图上下文似乎非常快。但是，如果您有复杂的视觉效果，当它们变得可见时可能需要一些时间来重新渲染它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T07:03:56.517

为什么不简单地从视觉孩子列表中删除视觉对象？当它需要可见时，您将其添加回来。

# sql-server - SQL Server 2005 中是否有与列统计信息相关的动态管理视图？

> ID：284771
> 
> 赞同：1
> 
> 时间：2008-11-12T18:01:33.017
> 
> 标签：sql-server, sql-server-2005

SQL Server 2005 的动态管理视图可以提供有关表索引的使用信息。是否有类似的方法来获取有关列统计信息的使用信息？具体来说，我很好奇我创建的一些较旧的列统计信息是否仍在使用。如果没有，我想删除它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T23:15:06.207

不，没有。但是有[sys.stats_columns](http://msdn.microsoft.com/en-us/library/ms187340.aspx)和[sys.stats](http://msdn.microsoft.com/en-us/library/ms177623.aspx)目录视图

# java - 我们可以使用 JUNIT 进行自动化集成测试吗？

> ID：284774
> 
> 赞同：41
> 
> 时间：2008-11-12T18:03:33.340
> 
> 标签：java, unit-testing, integration-testing

你如何自动化[集成测试](http://en.wikipedia.org/wiki/Integration_testing)？我使用 JUnit 进行其中一些测试。这是解决方案之一还是完全错误？你有什么建议？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-11-12T20:42:46.373

我使用 JUnit 进行了很多集成测试。当然，集成测试可能意味着许多不同的东西。对于更多的系统级集成测试，我更喜欢让脚本从外部驱动我的测试过程。

对于使用 http 和数据库的应用程序，这是一种非常适合我的方法，我想验证整个堆栈：

1.  `Hypersonic or H2`在内存模式下使用作为数据库的替代品（这对 ORM 最有效）
2.  初始化数据库`@BeforeSuite`或等价物（再次：使用 ORM 最简单）
3.  使用 Jetty 启动进程内 Web 服务器。
4.  `@Before`每次测试，清除数据库并使用必要的数据进行初始化
5.  用于`JWebUnit`向 Jetty 执行 HTTP 请求

这为您提供了无需任何数据库或应用程序服务器设置即可运行的集成测试，并且可以从 http 向下运行堆栈。由于它不依赖于外部资源，因此该测试在构建服务器上运行良好。

这是我使用的一些代码：

```
@BeforeClass
public static void startServer() throws Exception {
    System.setProperty("hibernate.hbm2ddl.auto", "create");
    System.setProperty("hibernate.dialect", "...");
    DriverManagerDataSource dataSource = new DriverManagerDataSource();
    dataSource.setJdbcUrl("jdbc:hsqldb:mem:mytest");
    new org.mortbay.jetty.plus.naming.Resource(
             "jdbc/primaryDs", dataSource);

    Server server = new Server(0);
    WebAppContext webAppContext = new WebAppContext("src/main/webapp", "/");
    server.addHandler(webAppContext);
    server.start();
    webServerPort = server.getConnectors()[0].getLocalPort();
}

// From JWebUnit
private WebTestCase tester = new WebTestCase();

@Before
public void createTestContext() {
    tester.getTestContext().setBaseUrl("http://localhost:" + webServerPort + "/");
    dao.deleteAll(dao.find(Product.class));
    dao.flushChanges();
}

@Test
public void createNewProduct() throws Exception {
    String productName = uniqueName("product");
    int price = 54222;

    tester.beginAt("/products/new.html");
    tester.setTextField("productName", productName);
    tester.setTextField("price", Integer.toString(price));
    tester.submit("Create");

    Collection<Product> products = dao.find(Product.class);
    assertEquals(1, products.size());
    Product product = products.iterator().next();
    assertEquals(productName, product.getProductName());
    assertEquals(price, product.getPrice());
} 
```

对于那些想了解更多的人，我在 Java.net 上写了[一篇关于使用 Jetty 和 JWebUnit 进行嵌入式集成测试的文章。](http://today.java.net/pub/a/today/2007/04/12/embedded-integration-testing-of-web-applications.html)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-12T18:27:35.040

JUnit 工作。没有任何限制将其限制为仅作为单元测试。我们使用 JUnit、Maven 和 CruiseControl 来做 CI。

可能有专门用于集成测试的工具，但我认为它们的有用性取决于您要集成的系统组件类型。JUnit 适用于非 UI 类型测试。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-12T18:28:03.667

在使用 Maven 构建项目时，我对[TestNG](http://testng.org/doc/)的运气稍微好一点，因为它具有[`@BeforeSuite`](http://testng.org/javadocs/org/testng/annotations/BeforeSuite.html)和[`@AfterSuite`](http://testng.org/javadocs/org/testng/annotations/AfterSuite.html)操作性。这很有用，因为如果任何集成测试失败，Maven 将不会执行“集成后测试”。Ant没有问题，所以我只是出于偏好而使用jUnit。

在任何一种情况下，像 TestNG 和 jUnit 那样分割测试也有助于集成测试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-12T20:22:42.937

在我们的工作中，我们的集成测试解决方案包含三个主要部分：

1.  [CruiseControl](http://cruisecontrol.sourceforge.net/)是我们持续集成方法的基础。
2.  我们的 CruiseControl 配置在任何人签入[Subversion](http://subversion.tigris.org/)后 3 分钟内启动快速测试构建。这里发生的测试是“一切都还在编译吗？” 和“单元测试都通过了吗？”。 [JUnit](http://www.junit.org/)显然是回答第二个问题的主要促进者。
3.  每小时，它都会启动一个更大的构建，构建我们在各种部署平台上使用的在线帮助和安装程序。这一步验证了“我们的每个目标平台是否还有可部署的产品？”这样更大的问题。

最终结果是这里的大多数人从不担心集成测试：它只是发生了。另一方面，单元测试是每个人的首要任务。JUnit 使构建测试变得容易，尽管*好的*测试总是需要思考和开发时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T18:30:07.860

是的，您可以使用 junit 进行集成测试，但这取决于您需要的集成测试类型。

测试一个 servlet：

*   设置 servlet 上下文和配置
*   使用模拟 servlet 请求进行测试（Spring 对此提供支持，但您也可以使用 EasyMock 或您自己的模拟）

测试弹簧应用程序：

*   使用 AbstractDependencyInjectionSpringContextTests 设置上下文
*   测试有线 bean
*   在使用数据库进行测试时，还有支持事务处理的 AbstractDependencyInjectionSpringContextTests 的子类。

但纯粹的 Junit 也有其局限性。测试用户界面是一个典型案例。您可以将 selenium 用于 Web 应用程序，将 soapui 用于 Web 服务或其他适当的工具。

但无论您使用什么，都应该可以将其集成到您的持续构建中（巡航控制、团队城市或其他）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T18:18:06.400

确实！我们使用 JUnit、ANT 任务的组合来运行它们，并使用[Hudson](http://hudson-ci.org/)进行持续集成测试。奇迹般有效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-13T08:35:30.897

该建议取决于您的应用程序和您的目标。

我在 JUnit 中编写过集成测试，但我也看到人们使用 HtmlUnit（JUnit 扩展）、Selenium、Watir、Fit/Fitness，甚至像 WinRunner 和 Silk 这样的商业工具。

因此，请告诉我们更多有关您的领域和测试目标的信息，您可能会得到更好的答案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-04T04:39:33.647

JUnit 有一个很好的扩展，叫做 Jitr。

Jitr 是一个 JUnit 集成测试运行器，它允许您的 Web 应用程序集成测试轻松地在与您的测试相同的 JVM 中针对轻量级 Web 容器运行。

有关详细信息，请参见他们的网站：[http ://www.jitr.org/](http://www.jitr.org/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-02-01T01:13:25.780

2012 年更新：虽然可以使用 JUnit（并且受益于 CI 支持），但 JWebUnit 和 Selenium 似乎正在占据集成测试的份额。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-09-18T21:05:20.143

我认为自动化和集成测试**不能很好地结合在一起**。最基本的问题是每次测试前的**环境设置。**需要更多集成类型的测试更大的设置。

我对集成层测试自动化的看法：http: [//blog.aplikacja.info/2012/03/whats-wrong-with-automated-integration-tests/](http://blog.aplikacja.info/2012/03/whats-wrong-with-automated-integration-tests/)

# .net - 如何解析 DateTime 并将其转换为 RFC 822 日期时间格式？

> ID：284775
> 
> 赞同：41
> 
> 时间：2008-11-12T18:04:01.437
> 
> 标签：.net, datetime, rss, rfc822

如何将 DateTime 结构转换为其等效的[RFC 822 日期时间](http://www.w3.org/Protocols/rfc822/#z28)格式的字符串表示**并将**此字符串表示解析回 .NET 中的 DateTime 结构？RFC-822 日期时间格式用于许多规范，例如[RSS Syndication Format](http://www.rssboard.org/rss-specification)。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-02-16T18:23:26.643

试试这个：

```
 DateTime today = DateTime.Now;
  String rfc822 = today.ToString("r");
  Console.WriteLine("RFC-822 date: {0}", rfc822);

  DateTime parsedRFC822 = DateTime.Parse(rfc822);
  Console.WriteLine("Date: {0}", parsedRFC822); 
```

传递给 DateTime 的 ToString() 方法的“r”格式说明符实际上产生了一个 RFC-1123 格式的日期时间字符串，但也作为 RFC-822 日期传递，基于阅读[http://www.w3 上的规范。 org/协议/rfc822/#z28](http://www.w3.org/Protocols/rfc822/#z28)。我在创建 RSS 提要时使用了这种方法，它们根据[http://validator.w3.org/feed/check.cgi](http://validator.w3.org/feed/check.cgi)提供的验证器通过验证。

缺点是，在转换中，它将日期时间转换为 GMT。要转换回本地时间，您需要应用本地时区偏移量。为此，您可以使用 TimeZone 类来获取您当前的时区偏移量，并将“GMT”替换为时区偏移量字符串：

```
TimeZone tz = TimeZone.CurrentTimeZone;

String offset = tz.GetUtcOffset().ToString();
// My locale is Mountain time; offset is set to "-07:00:00"
// if local time is behind utc time, offset should start with "-".
// otherwise, add a plus sign to the beginning of the string.
if (!offset.StartsWith("-"))
  offset = "+" + offset; // Add a (+) if it's a UTC+ timezone
offset = offset.Substring(0,6); // only want the first 6 chars.
offset = offset.Replace(":", ""); // remove colons.
// offset now looks something like "-0700".
rfc822 = rfc822.Replace("GMT", offset);
// The rfc822 string can now be parsed back to a DateTime object,
// with the local time accounted for.
DateTime new = DateTime.Parse(rfc822); 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-11-12T18:05:53.290

这是 C# 中如何解析 DateTime 并将其转换为 RFC-822 表示形式的实现。它的唯一限制是 DateTime 采用协调世界时 (UTC)。我同意这不是非常优雅的代码，但它可以完成工作。

```
/// <summary>
/// Provides methods for converting <see cref="DateTime"/> structures 
/// to and from the equivalent <a href="http://www.w3.org/Protocols/rfc822/#z28">RFC 822</a> 
/// string representation.
/// </summary>
public class Rfc822DateTime
{
    //============================================================
    //  Private members
    //============================================================
    #region Private Members
    /// <summary>
    /// Private member to hold array of formats that RFC 822 date-time representations conform to.
    /// </summary>
    private static string[] formats = new string[0];
    /// <summary>
    /// Private member to hold the DateTime format string for representing a DateTime in the RFC 822 format.
    /// </summary>
    private const string format     = "ddd, dd MMM yyyy HH:mm:ss K";
    #endregion

    //============================================================
    //  Public Properties
    //============================================================
    #region Rfc822DateTimeFormat
    /// <summary>
    /// Gets the custom format specifier that may be used to represent a <see cref="DateTime"/> in the RFC 822 format.
    /// </summary>
    /// <value>A <i>DateTime format string</i> that may be used to represent a <see cref="DateTime"/> in the RFC 822 format.</value>
    /// <remarks>
    /// <para>
    /// This method returns a string representation of a <see cref="DateTime"/> that utilizes the time zone 
    /// offset (local differential) to represent the offset from Greenwich mean time in hours and minutes. 
    /// The <see cref="Rfc822DateTimeFormat"/> is a valid date-time format string for use 
    /// in the <see cref="DateTime.ToString(String, IFormatProvider)"/> method.
    /// </para>
    /// <para>
    /// The <a href="http://www.w3.org/Protocols/rfc822/#z28">RFC 822</a> Date and Time specification 
    /// specifies that the year will be represented as a two-digit value, but the 
    /// <a href="http://www.rssboard.org/rss-profile#data-types-datetime">RSS Profile</a> recommends that 
    /// all date-time values should use a four-digit year. The <see cref="Rfc822DateTime"/> class 
    /// follows the RSS Profile recommendation when converting a <see cref="DateTime"/> to the equivalent 
    /// RFC 822 string representation.
    /// </para>
    /// </remarks>
    public static string Rfc822DateTimeFormat
    {
        get
        {
            return format;
        }
    }
    #endregion

    #region Rfc822DateTimePatterns
    /// <summary>
    /// Gets an array of the expected formats for RFC 822 date-time string representations.
    /// </summary>
    /// <value>
    /// An array of the expected formats for RFC 822 date-time string representations 
    /// that may used in the <see cref="DateTime.TryParseExact(String, string[], IFormatProvider, DateTimeStyles, out DateTime)"/> method.
    /// </value>
    /// <remarks>
    /// The array of the expected formats that is returned assumes that the RFC 822 time zone 
    /// is represented as or converted to a local differential representation.
    /// </remarks>
    /// <seealso cref="ConvertZoneToLocalDifferential(String)"/>
    public static string[] Rfc822DateTimePatterns
    {
        get
        {
            if (formats.Length > 0)
            {
                return formats;
            }
            else
            {
                formats = new string[35];

                // two-digit day, four-digit year patterns
                formats[0]  = "ddd',' dd MMM yyyy HH':'mm':'ss'.'fffffff zzzz";
                formats[1]  = "ddd',' dd MMM yyyy HH':'mm':'ss'.'ffffff zzzz";
                formats[2]  = "ddd',' dd MMM yyyy HH':'mm':'ss'.'fffff zzzz";
                formats[3]  = "ddd',' dd MMM yyyy HH':'mm':'ss'.'ffff zzzz";
                formats[4]  = "ddd',' dd MMM yyyy HH':'mm':'ss'.'fff zzzz";
                formats[5]  = "ddd',' dd MMM yyyy HH':'mm':'ss'.'ff zzzz";
                formats[6]  = "ddd',' dd MMM yyyy HH':'mm':'ss'.'f zzzz";
                formats[7]  = "ddd',' dd MMM yyyy HH':'mm':'ss zzzz";

                // two-digit day, two-digit year patterns
                formats[8]  = "ddd',' dd MMM yy HH':'mm':'ss'.'fffffff zzzz";
                formats[9]  = "ddd',' dd MMM yy HH':'mm':'ss'.'ffffff zzzz";
                formats[10] = "ddd',' dd MMM yy HH':'mm':'ss'.'fffff zzzz";
                formats[11] = "ddd',' dd MMM yy HH':'mm':'ss'.'ffff zzzz";
                formats[12] = "ddd',' dd MMM yy HH':'mm':'ss'.'fff zzzz";
                formats[13] = "ddd',' dd MMM yy HH':'mm':'ss'.'ff zzzz";
                formats[14] = "ddd',' dd MMM yy HH':'mm':'ss'.'f zzzz";
                formats[15] = "ddd',' dd MMM yy HH':'mm':'ss zzzz";

                // one-digit day, four-digit year patterns
                formats[16] = "ddd',' d MMM yyyy HH':'mm':'ss'.'fffffff zzzz";
                formats[17] = "ddd',' d MMM yyyy HH':'mm':'ss'.'ffffff zzzz";
                formats[18] = "ddd',' d MMM yyyy HH':'mm':'ss'.'fffff zzzz";
                formats[19] = "ddd',' d MMM yyyy HH':'mm':'ss'.'ffff zzzz";
                formats[20] = "ddd',' d MMM yyyy HH':'mm':'ss'.'fff zzzz";
                formats[21] = "ddd',' d MMM yyyy HH':'mm':'ss'.'ff zzzz";
                formats[22] = "ddd',' d MMM yyyy HH':'mm':'ss'.'f zzzz";
                formats[23] = "ddd',' d MMM yyyy HH':'mm':'ss zzzz";

                // two-digit day, two-digit year patterns
                formats[24] = "ddd',' d MMM yy HH':'mm':'ss'.'fffffff zzzz";
                formats[25] = "ddd',' d MMM yy HH':'mm':'ss'.'ffffff zzzz";
                formats[26] = "ddd',' d MMM yy HH':'mm':'ss'.'fffff zzzz";
                formats[27] = "ddd',' d MMM yy HH':'mm':'ss'.'ffff zzzz";
                formats[28] = "ddd',' d MMM yy HH':'mm':'ss'.'fff zzzz";
                formats[29] = "ddd',' d MMM yy HH':'mm':'ss'.'ff zzzz";
                formats[30] = "ddd',' d MMM yy HH':'mm':'ss'.'f zzzz";
                formats[31] = "ddd',' d MMM yy HH':'mm':'ss zzzz";

                // Fall back patterns
                formats[32] = "yyyy'-'MM'-'dd'T'HH':'mm':'ss'.'fffffffK"; // RoundtripDateTimePattern
                formats[33] = DateTimeFormatInfo.InvariantInfo.UniversalSortableDateTimePattern;
                formats[34] = DateTimeFormatInfo.InvariantInfo.SortableDateTimePattern;

                return formats;
            }
        }
    }
    #endregion

    //============================================================
    //  Public Methods
    //============================================================
    #region Parse(string s)
    /// <summary>
    /// Converts the specified string representation of a date and time to its <see cref="DateTime"/> equivalent.
    /// </summary>
    /// <param name="s">A string containing a date and time to convert.</param>
    /// <returns>
    /// A <see cref="DateTime"/> equivalent to the date and time contained in <paramref name="s"/>, 
    /// expressed as <i>Coordinated Universal Time (UTC)</i>.
    /// </returns>
    /// <remarks>
    /// The string <paramref name="s"/> is parsed using formatting information in the <see cref="DateTimeFormatInfo.InvariantInfo"/> object.
    /// </remarks>
    /// <exception cref="ArgumentNullException"><paramref name="s"/> is a <b>null</b> reference (Nothing in Visual Basic).</exception>
    /// <exception cref="ArgumentNullException"><paramref name="s"/> is an empty string.</exception>
    /// <exception cref="FormatException"><paramref name="s"/> does not contain a valid RFC 822 string representation of a date and time.</exception>
    public static DateTime Parse(string s)
    {
        //------------------------------------------------------------
        //  Validate parameter
        //------------------------------------------------------------
        if (String.IsNullOrEmpty(s))
        {
          throw new ArgumentNullException("s");
        }

        DateTime result;
        if (Rfc822DateTime.TryParse(s, out result))
        {
            return result;
        }
        else
        {
            throw new FormatException(String.Format(null, "{0} is not a valid RFC 822 string representation of a date and time.", s));
        }
    }
    #endregion

    #region ConvertZoneToLocalDifferential(string s)
    /// <summary>
    /// Converts the time zone component of an RFC 822 date and time string representation to its local differential (time zone offset).
    /// </summary>
    /// <param name="s">A string containing an RFC 822 date and time to convert.</param>
    /// <returns>A date and time string that uses local differential to describe the time zone equivalent to the date and time contained in <paramref name="s"/>.</returns>
    /// <exception cref="ArgumentNullException"><paramref name="s"/> is a <b>null</b> reference (Nothing in Visual Basic).</exception>
    /// <exception cref="ArgumentNullException"><paramref name="s"/> is an empty string.</exception>
    public static string ConvertZoneToLocalDifferential(string s)
    {
        string zoneRepresentedAsLocalDifferential   = String.Empty;

        //------------------------------------------------------------
        //  Validate parameter
        //------------------------------------------------------------
        if (String.IsNullOrEmpty(s))
        {
          throw new ArgumentNullException("s");
        }

        if(s.EndsWith(" UT", StringComparison.OrdinalIgnoreCase))
        {
            zoneRepresentedAsLocalDifferential  = String.Concat(s.Substring(0, (s.LastIndexOf(" UT") + 1) ), "+00:00");
        }
        else if (s.EndsWith(" GMT", StringComparison.OrdinalIgnoreCase))
        {
            zoneRepresentedAsLocalDifferential  = String.Concat(s.Substring(0, (s.LastIndexOf(" GMT") + 1 ) ), "+00:00");
        }
        else if (s.EndsWith(" EST", StringComparison.OrdinalIgnoreCase))
        {
            zoneRepresentedAsLocalDifferential  = String.Concat(s.Substring(0, (s.LastIndexOf(" EST") + 1)), "-05:00");
        }
        else if (s.EndsWith(" EDT", StringComparison.OrdinalIgnoreCase))
        {
            zoneRepresentedAsLocalDifferential  = String.Concat(s.Substring(0, (s.LastIndexOf(" EDT") + 1)), "-04:00");
        }
        else if (s.EndsWith(" CST", StringComparison.OrdinalIgnoreCase))
        {
            zoneRepresentedAsLocalDifferential  = String.Concat(s.Substring(0, (s.LastIndexOf(" CST") + 1)), "-06:00");
        }
        else if (s.EndsWith(" CDT", StringComparison.OrdinalIgnoreCase))
        {
            zoneRepresentedAsLocalDifferential  = String.Concat(s.Substring(0, (s.LastIndexOf(" CDT") + 1)), "-05:00");
        }
        else if (s.EndsWith(" MST", StringComparison.OrdinalIgnoreCase))
        {
            zoneRepresentedAsLocalDifferential  = String.Concat(s.Substring(0, (s.LastIndexOf(" MST") + 1)), "-07:00");
        }
        else if (s.EndsWith(" MDT", StringComparison.OrdinalIgnoreCase))
        {
            zoneRepresentedAsLocalDifferential  = String.Concat(s.Substring(0, (s.LastIndexOf(" MDT") + 1)), "-06:00");
        }
        else if (s.EndsWith(" PST", StringComparison.OrdinalIgnoreCase))
        {
            zoneRepresentedAsLocalDifferential  = String.Concat(s.Substring(0, (s.LastIndexOf(" PST") + 1)), "-08:00");
        }
        else if (s.EndsWith(" PDT", StringComparison.OrdinalIgnoreCase))
        {
            zoneRepresentedAsLocalDifferential  = String.Concat(s.Substring(0, (s.LastIndexOf(" PDT") + 1)), "-07:00");
        }
        else if (s.EndsWith(" Z", StringComparison.OrdinalIgnoreCase))
        {
            zoneRepresentedAsLocalDifferential  = String.Concat(s.Substring(0, (s.LastIndexOf(" Z") + 1)), "+00:00");
        }
        else if (s.EndsWith(" A", StringComparison.OrdinalIgnoreCase))
        {
            zoneRepresentedAsLocalDifferential  = String.Concat(s.Substring(0, (s.LastIndexOf(" A") + 1)), "-01:00");
        }
        else if (s.EndsWith(" M", StringComparison.OrdinalIgnoreCase))
        {
            zoneRepresentedAsLocalDifferential  = String.Concat(s.Substring(0, (s.LastIndexOf(" M") + 1)), "-12:00");
        }
        else if (s.EndsWith(" N", StringComparison.OrdinalIgnoreCase))
        {
            zoneRepresentedAsLocalDifferential  = String.Concat(s.Substring(0, (s.LastIndexOf(" N") + 1)), "+01:00");
        }
        else if (s.EndsWith(" Y", StringComparison.OrdinalIgnoreCase))
        {
            zoneRepresentedAsLocalDifferential  = String.Concat(s.Substring(0, (s.LastIndexOf(" Y") + 1)), "+12:00");
        }
        else
        {
            zoneRepresentedAsLocalDifferential  = s;
        }

        return zoneRepresentedAsLocalDifferential;
    }
    #endregion

    #region ToString(DateTime utcDateTime)
    /// <summary>
    /// Converts the value of the specified <see cref="DateTime"/> object to its equivalent string representation.
    /// </summary>
    /// <param name="utcDateTime">The Coordinated Universal Time (UTC) <see cref="DateTime"/> to convert.</param>
    /// <returns>A RFC 822 string representation of the value of the <paramref name="utcDateTime"/>.</returns>
    /// <exception cref="ArgumentException">The specified <paramref name="utcDateTime"/> object does not represent a <see cref="DateTimeKind.Utc">Coordinated Universal Time (UTC)</see> value.</exception>
    public static string ToString(DateTime utcDateTime)
    {
        if (utcDateTime.Kind != DateTimeKind.Utc)
        {
            throw new ArgumentException("utcDateTime");
        }

        return utcDateTime.ToString(Rfc822DateTime.Rfc822DateTimeFormat, DateTimeFormatInfo.InvariantInfo);
    }
    #endregion

    #region TryParse(string s, out DateTime result)
    /// <summary>
    /// Converts the specified string representation of a date and time to its <see cref="DateTime"/> equivalent.
    /// </summary>
    /// <param name="s">A string containing a date and time to convert.</param>
    /// <param name="result">
    /// When this method returns, contains the <see cref="DateTime"/> value equivalent to the date and time 
    /// contained in <paramref name="s"/>, expressed as <i>Coordinated Universal Time (UTC)</i>, 
    /// if the conversion succeeded, or <see cref="DateTime.MinValue">MinValue</see> if the conversion failed. 
    /// The conversion fails if the s parameter is a <b>null</b> reference (Nothing in Visual Basic), 
    /// or does not contain a valid string representation of a date and time. 
    /// This parameter is passed uninitialized.
    /// </param>
    /// <returns><b>true</b> if the <paramref name="s"/> parameter was converted successfully; otherwise, <b>false</b>.</returns>
    /// <remarks>
    /// The string <paramref name="s"/> is parsed using formatting information in the <see cref="DateTimeFormatInfo.InvariantInfo"/> object. 
    /// </remarks>
    public static bool TryParse(string s, out DateTime result)
    {
        //------------------------------------------------------------
        //  Attempt to convert string representation
        //------------------------------------------------------------
        bool wasConverted   = false;
        result              = DateTime.MinValue;

        if (!String.IsNullOrEmpty(s))
        {
            DateTime parseResult;
            if (DateTime.TryParseExact(Rfc822DateTime.ConvertZoneToLocalDifferential(s), Rfc822DateTime.Rfc822DateTimePatterns, DateTimeFormatInfo.InvariantInfo, DateTimeStyles.AdjustToUniversal, out parseResult))
            {
                result          = DateTime.SpecifyKind(parseResult, DateTimeKind.Utc);
                wasConverted    = true;
            }
        }

        return wasConverted;
    }
    #endregion
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-05-31T15:52:08.023

按照 Kirk 的想法，我反编译了`System.ServiceModel.Syndication.Rss20FeedFormatter`类（*System.ServiceModel.dll*）的源代码，这里是**Microsoft RFC 822 日期格式的内部解析器**（我稍微简化了它们的异常处理逻辑以减少依赖关系）：

```
public static class DateTimeParser
{
    public static DateTimeOffset ParseDateTimeRFC822(string dateTimeString)
    {
        StringBuilder dateTimeStringBuilder = new StringBuilder(dateTimeString.Trim());
        if (dateTimeStringBuilder.Length < 18)
        {
            throw new FormatException("Invalid date format. Expected date in RFC 822 format");
        }
        if (dateTimeStringBuilder[3] == ',')
        {
            // There is a leading (e.g.) "Tue, ", strip it off
            dateTimeStringBuilder.Remove(0, 4);
            // There's supposed to be a space here but some implementations dont have one
            RemoveExtraWhiteSpaceAtStart(dateTimeStringBuilder);
        }
        ReplaceMultipleWhiteSpaceWithSingleWhiteSpace(dateTimeStringBuilder);
        if (char.IsDigit(dateTimeStringBuilder[1]))
        {
            // two-digit day, we are good
        }
        else
        {
            dateTimeStringBuilder.Insert(0, '0');
        }
        if (dateTimeStringBuilder.Length < 19)
        {
            throw new FormatException("Invalid date format. Expected date in RFC 822 format");
        }
        bool thereAreSeconds = (dateTimeStringBuilder[17] == ':');
        int timeZoneStartIndex;
        if (thereAreSeconds)
        {
            timeZoneStartIndex = 21;
        }
        else
        {
            timeZoneStartIndex = 18;
        }
        string timeZoneSuffix = dateTimeStringBuilder.ToString().Substring(timeZoneStartIndex);
        dateTimeStringBuilder.Remove(timeZoneStartIndex, dateTimeStringBuilder.Length - timeZoneStartIndex);
        bool isUtc;
        dateTimeStringBuilder.Append(NormalizeTimeZone(timeZoneSuffix, out isUtc));
        string wellFormattedString = dateTimeStringBuilder.ToString();

        DateTimeOffset theTime;
        string parseFormat;
        if (thereAreSeconds)
        {
            parseFormat = "dd MMM yyyy HH:mm:ss zzz";
        }
        else
        {
            parseFormat = "dd MMM yyyy HH:mm zzz";
        }
        if (DateTimeOffset.TryParseExact(wellFormattedString, parseFormat,
            CultureInfo.InvariantCulture.DateTimeFormat,
            (isUtc ? DateTimeStyles.AdjustToUniversal : DateTimeStyles.None), out theTime))
        {
            return theTime;
        }
        throw new FormatException("Invalid date format. Expected date in RFC 822 format");
    }

    static string NormalizeTimeZone(string rfc822TimeZone, out bool isUtc)
    {
        isUtc = false;
        // return a string in "-08:00" format
        if (rfc822TimeZone[0] == '+' || rfc822TimeZone[0] == '-')
        {
            // the time zone is supposed to be 4 digits but some feeds omit the initial 0
            StringBuilder result = new StringBuilder(rfc822TimeZone);
            if (result.Length == 4)
            {
                // the timezone is +/-HMM. Convert to +/-HHMM
                result.Insert(1, '0');
            }
            result.Insert(3, ':');
            return result.ToString();
        }
        switch (rfc822TimeZone)
        {
            case "UT":
            case "Z":
                isUtc = true;
                return "-00:00";
            case "GMT":
                return "-00:00";
            case "A":
                return "-01:00";
            case "B":
                return "-02:00";
            case "C":
                return "-03:00";
            case "D":
            case "EDT":
                return "-04:00";
            case "E":
            case "EST":
            case "CDT":
                return "-05:00";
            case "F":
            case "CST":
            case "MDT":
                return "-06:00";
            case "G":
            case "MST":
            case "PDT":
                return "-07:00";
            case "H":
            case "PST":
                return "-08:00";
            case "I":
                return "-09:00";
            case "K":
                return "-10:00";
            case "L":
                return "-11:00";
            case "M":
                return "-12:00";
            case "N":
                return "+01:00";
            case "O":
                return "+02:00";
            case "P":
                return "+03:00";
            case "Q":
                return "+04:00";
            case "R":
                return "+05:00";
            case "S":
                return "+06:00";
            case "T":
                return "+07:00";
            case "U":
                return "+08:00";
            case "V":
                return "+09:00";
            case "W":
                return "+10:00";
            case "X":
                return "+11:00";
            case "Y":
                return "+12:00";
            default:
                return "";
        }
    }

    static void RemoveExtraWhiteSpaceAtStart(StringBuilder stringBuilder)
    {
        int i = 0;
        while (i < stringBuilder.Length)
        {
            if (!char.IsWhiteSpace(stringBuilder[i]))
            {
                break;
            }
            ++i;
        }
        if (i > 0)
        {
            stringBuilder.Remove(0, i);
        }
    }

    static void ReplaceMultipleWhiteSpaceWithSingleWhiteSpace(StringBuilder builder)
    {
        int index = 0;
        int whiteSpaceStart = -1;
        while (index < builder.Length)
        {
            if (char.IsWhiteSpace(builder[index]))
            {
                if (whiteSpaceStart < 0)
                {
                    whiteSpaceStart = index;
                    // normalize all white spaces to be ' ' so that the date time parsing works
                    builder[index] = ' ';
                }
            }
            else if (whiteSpaceStart >= 0)
            {
                if (index > whiteSpaceStart + 1)
                {
                    // there are at least 2 spaces... replace by 1
                    builder.Remove(whiteSpaceStart, index - whiteSpaceStart - 1);
                    index = whiteSpaceStart + 1;
                }
                whiteSpaceStart = -1;
            }
            ++index;
        }
        // we have already trimmed the start and end so there cannot be a trail of white spaces in the end
        Debug.Assert(builder.Length == 0 || builder[builder.Length - 1] != ' ', "The string builder doesnt end in a white space");
    }
} 
```

可能看起来不寻常的第一件事是它们返回`[DateTimeOffset][1]`class 而不是`DateTime`. 但是当我们阅读更多关于它的信息时，它似乎是完全合乎逻辑的——`DateTimeOffset`存储**日期、时间和时区**信息（完全是 RFC 822 格式的字符串）。**如果您只返回 DateTime 对象，它将位于哪个时区**：UTC、本地或解析字符串中指定的时区 - 在某些情况下，任何答案都是错误的。因此`DateTimeOffset`解决了一个重要的不确定性问题。您可以使用方法将其转换为稍后需要的时区`DateTimeOffset.ToUniversalTime()`，`DateTimeOffset.ToLocalTime()`.

我在少数情况下对其进行了测试，它似乎完美地完成了这项工作。

不过我不确定，为什么微软决定将这个实现私有化——它似乎不需要很多支持。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-03-17T21:10:22.153

以下是微软在 Rss20FeedFormatter 中的做法。反对派的代码没有去掉 GMT 偏移部分中的“：”。杰夫伍德曼似乎做到了这一点。下面的代码也是这样做的（如果不使用 Atom10FeedFormatter.zeroOffset）。

```
private string AsString(DateTimeOffset dateTime)
{
    if (dateTime.Offset == Atom10FeedFormatter.zeroOffset)
    {
        return dateTime.ToUniversalTime().ToString("ddd, dd MMM yyyy HH:mm:ss Z", CultureInfo.InvariantCulture);
    }
    StringBuilder builder = new StringBuilder(dateTime.T)oString("ddd, dd MMM yyyy HH:mm:ss zzz", CultureInfo.InvariantCulture));
    builder.Remove(builder.Length - 3, 1);
    return builder.ToString();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-03T07:31:40.207

根据 Kirk Liemohn 的回答，我成功地使用了这种方法：

```
private DateTimeOffset? ParseDate(string date)
    {
        const string FORMAT = "ddd, d MMM yyyy HH:mm:ss zzz";
        const string FORMAT2 = "ddd, dd MMM yyyy HH:mm:ss zzz";
        const string FORMAT3 = "dd MMM yyyy HH:mm:ss zzz";
        const string FORMAT4 = "d MMM yyyy HH:mm:ss zzz";
        DateTimeOffset d;
        if (DateTimeOffset.TryParseExact(date, new string[] { FORMAT, FORMAT2, FORMAT3, FORMAT4 }, CultureInfo.InvariantCulture, DateTimeStyles.AllowLeadingWhite | DateTimeStyles.AllowTrailingWhite, out d))
            return d;
        return null;
    } 
```

例子：

```
DateTimeOffset? date = ParseDate("Thu, 5 Apr 2012 23:47:37 +0200");
Console.WriteLine(date.ToString());
// => 05/04/2012 23:47:37 +02:00 
```

它不尊重 RFC 的完整规范，但它适用于我的用例。

具体来说，它不适用于时区表达，例如：“GMT”、“CST”等（参见[RFC822 第 5.1 节中的“zone”](https://www.rfc-editor.org/rfc/rfc822#section-5.1)）。请参阅[Oleksandr Pshenychnyy 的更好答案](https://stackoverflow.com/a/37550344/249742)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-02T14:11:29.980

这是我使用扩展方法的实现：

```
namespace MyNamespace
{
    public static partial class ExtensionMethods
    {
        public static string ToRFC822String(this DateTime timestamp)
        {
            return timestamp.ToString("ddd',' d MMM yyyy HH':'mm':'ss")
                + " "
                + timestamp.ToString("zzzz").Replace(":", "");
        }
    }
 } 
```

要使用：

```
 using MyNamespace;

 ....

 string MyRFC822String = DateTime.Now.ToRFC822String(); 
```

# windows - 如何在 Windows 批处理脚本中将 %USERNAME% 的值转换为小写？

> ID：284776
> 
> 赞同：24
> 
> 时间：2008-11-12T18:04:04.353
> 
> 标签：windows, scripting, batch-file, cmd

我正在使用点 bat 脚本自动化一些源代码控制软件功能，但鉴于我们的 svn 存储库托管在 *NIX 盒子中，我面临着这两个世界之间的永恒案例问题。

是否有任何 cmd.exe 函数可以将 Windows 系统变量 %USERNAME% 的值转换为小写？

提前非常感谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-05-22T12:13:27.930

好吧，我正在浏览一些语法并偶然发现了这个页面。我知道它很旧，但我想我会休息一下，给大脑一点刺激。

这里有一些更短且易于管理的东西。这只是将所有大写字母“强制”为小写字母，而不考虑实际字母是否存在于字符串中。因此，无论字符串的长度如何，功能循环都会运行 26 次。

希望这可以帮助某人。

```
@echo off
cls
setlocal enabledelayedexpansion

REM ***** Modify as necessary for the string source. *****
set "_STRING=%*"
if not defined _STRING set "_STRING=%USERNAME%"
set _STRING
REM ***** Modify as necessary for the string source. *****

set "_UCASE=ABCDEFGHIJKLMNOPQRSTUVWXYZ"
set "_LCASE=abcdefghijklmnopqrstuvwxyz"

for /l %%a in (0,1,25) do (
   call set "_FROM=%%_UCASE:~%%a,1%%
   call set "_TO=%%_LCASE:~%%a,1%%
   call set "_STRING=%%_STRING:!_FROM!=!_TO!%%
)

set _STRING
endlocal 
```

例子：

```
E:\OS.ADMIN>LCASE.BAT The Quick Fox Jumps Over The Brown Fence. 
```

结果：

```
_STRING=The Quick Fox Jumps Over The Brown Fence.
_STRING=the quick fox jumps over the brown fence. 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-12T18:22:18.687

一个快速的谷歌发现[了这个](http://cwashington.netreach.net/depo/view.asp?Index=780)......

```
@echo off
goto :end_remarks
*************************************************************************************
*
*
*    authored:Sam Wofford
*    Returns lowercase of a string
*    12:13 PM 11/13/02
**************************************************************************************
:end_remarks
setlocal
set errorlevel=-1
if {%1}=={} echo NO ARG GIVEN&call :Help &goto :endit
if {%1}=={/?} call :Help &goto :endit
call :set_LCASE_array a b c d e f g h i j k l m n o p q r s t u v w x y z

:start
set input=%1
set input=%input:"=%
set totparams=0
call :COUNT_PARAMS %input%
call :MAKE_LOWERCASE %input%
set errorlevel=
echo %convertedstring%
endlocal
goto :eof
:endit
echo %errorlevel%
endlocal
goto :eof

:MAKE_LOWERCASE
:nextstring
if {%1}=={} goto :eof
set string=%1
set /a params+=1
set STRINGCONVERTED=
set pos=0
:NEXT_CHAR
set onechar=%%string^:^~%pos%,1%%
for /f "tokens=1,2 delims==" %%a in ('set onechar') do for /f %%c in ('echo %%b') do call :checkit %%c
if not defined STRINGCONVERTED goto :NEXT_CHAR
shift /1
if %params% LSS %totparams% set convertedstring=%convertedstring% &:add one space,but not at end
goto :nextstring
goto :eof

:Help
echo USAGE:%~n0 string OR %~n0 "with spaces"
echo function returns the lowercase of the string or -1 (error)
echo strings with embedded spaces needs to be in quotes Ex. "lower case"
echo in a batch NTscript "for /f %%%%A in ('lcase STRING') do set var=%%%%A"
set errorlevel=
goto :eof

:checkit
set LCFOUND=
if /i {%1}=={echo} set STRINGCONVERTED=Y&goto :eof
set char=%1
for /f "tokens=2 delims=_=" %%A in ('set LCASE_') do call :findit %%A %char%
:skipit
if defined LCFOUND (set convertedstring=%convertedstring%%ucletter%) else (set convertedstring=%convertedstring%%char%)
set /a pos+=1
goto :eof

:set_LCASE_array
:setit
if {%1}=={} goto :eof
set LCASE_%1_=%1
SHIFT /1
goto :setit

:findit
if defined LCFOUND goto :eof
set ucletter=%1
set lcchar=%2
if /i {%ucletter%}=={%lcchar%} set LCFOUND=yes
goto :eof

:COUNT_PARAMS
:COUNTPARAMS
if {%1}=={} goto :eof
set /a totparams+=1
shift /1
goto :COUNTPARAMS 
```

将其作为文件（lowercase.cmd）添加到您的路径中，您应该能够将其称为“Lowercase.cmd %Username%”，如果需要，您可以将其通过管道传输到另一个命令中。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-12T21:10:53.573

[从http://short.stop.home.att.net/freesoft/unix.htm](http://short.stop.home.att.net/freesoft/unix.htm)下载一些用于 DOS 的 unix 实用程序 并使用 tr.exe（翻译字符）

```
echo %USERNAME% | tr "[A-Z]" "[a-z]" 
```

我还使用了一个名为 4NT 的 DOS 扩展 cmd 替换，它有一个内置命令 @lower

```
echo %@lower[%USERNAME%] 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-03-18T09:50:19.133

[http://www.dzone.com/snippets/lowercasing-string-bat-files](http://www.dzone.com/snippets/lowercasing-string-bat-files)

下层.bat

```
echo>%1
dir /b/l %1>lower.tmp
set /p result=<lower.tmp
echo %result% 
```

命令

```
lower "Mein BinnenMajuskel" 
```

结果

```
mein binnenmajuskel 
```

注意：快速和肮脏，但也是不安全和危险的变体。因为您创建了两个文件。一个称为给定字符串，另一个称为 lower.tmp，其中包含降低的字符串。如果你`lower "UserName"`在一个已经存在这个文件或目录的目录中执行会发生什么？特别是如果您之后删除此文件...

改良版：

```
echo>%Temp%\%1
dir /b/l %Temp%\%1>%Temp%\lower.tmp
set /p result=<%Temp%\lower.tmp
del %Temp%\%1
del %Temp%\lower.tmp 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-12-04T10:02:33.017

安装脚本语言后，可以将其与 a 一起使用`FOR`来设置变量。

```
@FOR /F %%s IN ('<<some script oneliner>>') DO @set MYVARIABLE=%%s 
```

如果可以将字符串转换为小写并输出结果，则可以使用任何脚本语言。

**使用 Perl 5 的示例：**

```
@FOR /F %%s IN ('perl -e "print lc(pop)" %USERNAME%') DO @set USERNAME=%%s 
```

**使用 PowerShell 的示例：**

```
@FOR /F %%s IN ('powershell -command "(get-item env:'USERNAME').Value.ToLower()"') DO @set USERNAME=%%s 
```

现在，很可能已经默认安装了 PowerShell。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-08-02T13:20:42.637

在我的批处理文件中，我正在比较 %USERNAME% 和 CSV 文件。

如果用户以大写用户名登录，该程序将无法运行。

例如：
登录：GB2NOGU // 不起作用
登录：gb2nogu //起作用

在这里，我可以通过不敏感的比较来解决我的问题。

```
if /i %USERNAME%==gb2nogu (
     // Code here
) 
```

参数 /i 告诉 cmd 进行不区分大小写的比较，因此它会忽略小写字母和大写字母之间的区别。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-05-26T17:48:17.550

可能这是在批处理文件中将字符串转换为小写的最快方法，因为它使用[宏](https://ss64.com/nt/syntax-macros.html)并且没有临时文件（它将生成的字符串保存在名为 的变量中`result`）：

```
@echo off

set LowerCaseMacro=for /L %%n in (1 1 2) do if %%n==2 (for %%# in (a b c d e f g h i j k l m n o p q r s t u v w x y z) do set "result=!result:%%#=%%#!") else setlocal enableDelayedExpansion ^& set result=

set "string=SOme STrinG WiTH lowerCAse letterS and UPCase leTTErs"
%LowerCaseMacro%%string%

echo %result% 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-10-03T16:13:47.690

```
:: UPcase.bat ==> Store in environment variable _UPcase_ the upper case of %1
:: -> Use quotes "" when the first argument has blanks or special characteres
::
:: Adapted from -> http://www.netikka.net/tsneti/info/tscmd039.htm
::
:: Note that the substitution method is case insensitive, which means that
:: while working for this application, it is not useful for all character
:: substitution tasks.
::
:: More concisely, one can capitalize (if you pardon the pun) on the fact
:: that in for and the substitution lower and upper case source are
:: equivalent.
@echo off

:: %~1 -> removes quotes from the first command line argument
:: http://steve-jansen.github.io/guides/windows-batch-scripting/part-2-variables.html
@echo off
::setlocal EnableExtensions
    :: echo %_UPcase_%
    call :ToUpcaseWithFor "%~1" _UPcase_
    :: echo %_UPcase_% _doit_1_
::endlocal & goto :EOF
goto :EOF
::
:: ======================
:ToUpcaseWithFor
setlocal EnableExtensions EnableDelayedExpansion
  set var_=%~1
  for %%c in (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) do (
    set var_=!var_:%%c=%%c!
  )
endlocal & set %2=%var_%& goto :EOF

:EOF
:: UPcase.bat ==> EOF 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-02-04T18:43:31.997

这是相同的答案/ [@It Wasn't Me](https://stackoverflow.com/users/8177207/it-wasnt-me?tab=profile) [here](https://superuser.com/a/1522183/969781)

* * *

对于预测字符集，此子字符串**`Set !var:A=a!`**有效，并且仅适用于**[bat](/questions/tagged/bat "show questions tagged 'bat'")** **/** **[cmd](/questions/tagged/cmd "show questions tagged 'cmd'")****中的预定义子字符串**。

**[对于这种类型的任务，为什么不使用c#](/questions/tagged/c%23 "显示标记为“c#”的问题")**获得一点帮助，它可以使用非常规的重音和辅音**è、È、ä、Ä、ñ、Ñ、ç、Ç 等。**

其中**[bat](/questions/tagged/bat "显示标记为“蝙蝠”的问题") / [cmd](/questions/tagged/cmd "显示标记为“cmd”的问题")**会生成**[c#](/questions/tagged/c%23 "显示标记为“c#”的问题")**代码的地方，会在运行时编译执行....

这解决了可能的用户输入，其中序列带有重音并且元音/辅音不同于传统的**[az]**和/或**[A_Z]**

* * *

```
@echo off & setlocal EnableDelayedExpansion 

cd /d "%~dp0" && title <nul && title ...\%~dpnx0 /// !time:~0,8! !date!

if exist "%tmp%\ToUpLower.cs" 2>nul >nul del /q /f "%tmp%\ToUpLower.cs" 
set "_where=%__appdir__%where.exe" && set "_csc=%windir%\Microsoft.NET"
>"%temp%\ToUpLower.cs"  ( 
echo= using System; namespace SUQ1522019 ^{class Program ^{static void Main(string[] args^) ^{
echo= if (args.Length==2 ^&^& args[0].ToLower(^)=="-l"^) ^{Console.WriteLine(args[1].ToLower(^)^);^} 
echo= if (args.Length==2 ^&^& args[0].ToLower(^)=="-u"^) ^{Console.WriteLine(args[1].ToUpper(^)^);^}^}^}^}
)

set "_arg=/t:exe /out:"%tmp%\ToUpLower.exe" "%tmp%\ToUpLower.cs" /platform:anycpu "
for /f tokens^=* %%i in ('!_where! /r "!_csc!" "csc.exe"^|findstr /lic:"k\v2\." 
')do "%%~i" !_arg! /unsafe+ /w:0 /o /nologo

for /f tokens^=* %%U in ('"%tmp%\ToUpLower.exe" -u %USERNAME%')do set "_up_case=%%U"
for /f tokens^=* %%l in ('"%tmp%\ToUpLower.exe" -l %USERNAME%')do set "_low_case=%%l"

echo/  Your username upcase is: !_up_case!
echo/ Your username lowcase is: !_low_case!

echo/ >nul 2>nul copy "%tmp%\ToUpLower.exe" "." 
del /q /f "%tmp%\ToUpLower.*" >nul 2>nul && endlocal & goto :EOF 
```

* * *

*   输出为**`%USERNAME%`**

    * * *

```
 Your username upcase is: USERNAME
Your username lowcase is: username 
```

* * *

没有转义的**[c#代码：](/questions/tagged/c%23 "显示标记为“c#”的问题")****`ToUpLower.cs`**

* * *

```
 using System; namespace SUQ1522019 {class Program {static void Main(string[] args) {
 if (args.Length==2 && args[0].ToLower()=="-l") {Console.WriteLine(args[1].ToLower());} 
 if (args.Length==2 && args[0].ToLower()=="-u") {Console.WriteLine(args[1].ToUpper());}}}} 
```

* * *

没有转义和缩进的**[c#代码：](/questions/tagged/c%23 "显示标记为“c#”的问题")****`ToUpLower.cs`**

* * *

```
using System
namespace SUQ1522019 
{
   class Program 
   {
      static void Main(string[] args)
      {
         if (args.Length==2 && args[0].ToLower()=="-l") 
         {
            Console.WriteLine(args[1].ToLower());
         } 

         if (args.Length==2 && args[0].ToLower()=="-u") 
         {
            Console.WriteLine(args[1].ToUpper());
         }
      }
   }
} 
```

* * *

*   此**[c#](/questions/tagged/c%23 "显示标记为“c#”的问题")**代码已在版本上**编译/测试：****`csc.exe`**

```
c:\Windows\Microsoft.NET\Framework\v2.0.50727\csc.exe
c:\Windows\Microsoft.NET\Framework\v3.5\csc.exe
c:\Windows\Microsoft.NET\Framework\v4.0.30319\csc.exe
c:\Windows\Microsoft.NET\Framework64\v2.0.50727\csc.exe
c:\Windows\Microsoft.NET\Framework64\v3.5\csc.exe
c:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe 
```

* * *

*   这是用于**编译****[c#](/questions/tagged/c%23 "显示标记为“c#”的问题")**代码 的**命令行：** *** * *** 

 **```
c:\Windows\Microsoft.NET\Framework\v2.0.50727\csc.exe /t:exe /out:"%tmp%\ToUpLower.exe" "%tmp%\ToUpLower.cs" /platform:anycpu /unsafe+ /w:0 /o /nologo 
```

* * *

*   **`ToUpLower.exe`使用** UPPER 到 -> 降低 *** * *** 

 **```
ToUpLower.exe -l STRING 

:: or ..

ToUpLower.exe -L STRING 
```**  *** * *

*   **`ToUpLower.exe`用法** 低于 -> UPPER

* * *

 ****```
ToUpLower.exe -u string

:: or ..

ToUpLower.exe -U string 
```**  *** * *

要保留**`ToUpLower.exe`**，请**`echo/`**从**命令**中删除：**`copy`**

 *** * *

```
**echo/** >nul 2>nul 复制 "%tmp%\ToUpLower.exe" "."
```

此命令行将从您的 bat 运行的同一个文件夹复制**`ToUpLower.exe`**到**`%temp%`**同一个文件夹。

* * *

编程指南 C#：

*   **[精氨酸](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/main-and-command-args/command-line-arguments)**

*   **[降低](https://superuser.com/a/1522183/969781)**

*   **[上衣](https://stackoverflow.com/users/8177207/it-wasnt-me?tab=profile)**

* * *

[对不起我有限的**英语**]

# visual-studio - 对 Visual Studio C++ 项目使用 /Zi 与 /Z7 有何影响？

> ID：284778
> 
> 赞同：39
> 
> 时间：2008-11-12T18:04:29.017
> 
> 标签：visual-studio, visual-studio-2008, visual-c++, visual-studio-2005, compiler-construction

## 背景

Visual Studio C++ 编译器可以使用多种不同的[调试标志。](http://msdn.microsoft.com/en-us/library/958x11bc.aspx)他们是：

*   **（没有任何）**
    *   不创建调试信息
    *   更快的编译时间
*   **/Z7**
    *   使用 CodeView 格式在 .obj 文件中生成全符号调试信息
*   **/子**
    *   使用程序数据库格式在目标的 .pdb 文件中生成全符号调试信息。
    *   启用对最小重建 (/Gm) 的支持，这可以减少重新编译所需的时间。
*   **/紫**
    *   生成 /Zi 之类的调试信息，但不支持 Edit-and-Continue

## 问题

*   [/Gm 标志与多进程构建](http://msdn.microsoft.com/en-us/library/bb385193.aspx)的 /MP 标志不兼容(Visual Studio 2005/2008)

*   如果您想启用最少的重建，那么 /Zi 标志在 /Z7 标志之上是必需的。

*   如果您打算使用 /MP 标志，则 /Z7 和 /Zi 看起来没有区别，看 MSDN。但是，[SCons 文档](http://www.scons.org/doc/production/HTML/scons-user/a4761.html#cv-CCPDBFLAGS)声明您必须使用 /Z7 来支持并行构建。

## 问题

*   在 Visual Studio C++ 项目中使用 /Zi 与 /Z7 有何影响？

*   我错过的这些选项中的任何一个还有其他优点或缺点吗？

*   具体来说，目标的单个程序数据库格式 (PDB) 文件与每个源的多个 CodeView 格式 (.obj) 文件有什么好处？

## 参考

[MDSN /Z7、/Zi、/ZI（调试信息格式）](http://msdn.microsoft.com/en-us/library/958x11bc.aspx)

[MSDN /MP（使用多个进程构建）](http://msdn.microsoft.com/en-us/library/bb385193.aspx)

[SCons 构造变量 CCPDBFLAG](http://www.scons.org/doc/production/HTML/scons-user/a4761.html#cv-CCPDBFLAGS)

[调试信息](http://www.debuginfo.com/articles/gendebuginfo.html)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-13T23:19:42.150

Codeview 是一种更古老的调试格式，它是在 1980 年代中期的“Microsoft C 编译器”时代与 Microsoft 的旧独立调试器一起引入的。它占用了更多的磁盘空间，调试器解析的时间也更长，而且在链接过程中处理起来很痛苦。当我在 1998-2000 年为 Windows 开发 CodeWarrior 时，我们从编译器生成了它。

一个优点是 Codeview 是一种文档格式，其他工具在无法处理 PDB 格式的调试数据库时通常可以处理它。此外，如果您一次构建多个文件，则不会争用写入项目的调试数据库。然而，对于现在的大多数用户来说，使用 PDB 格式是一个巨大的胜利，无论是在构建时间，尤其是在调试器启动时间。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-14T00:44:12.903

旧 C7 格式的一个优点是它是一体的，存储在 EXE 中，而不是单独的 PDB 和 EXE。这意味着您永远不会有不匹配的情况。VS 开发工具将确保 PDB 在使用它之前与其 EXE 匹配，但拥有一个包含您需要的一切的 EXE 肯定更简单。

这增加了在发布时需要能够剥离调试信息的新问题，以及巨大的 EXE 文件，更不用说古老的格式和缺乏对其他现代功能（如 minrebuild）的支持，但当你在试图让事情尽可能简单。一个文件比两个文件容易。

并不是说我曾经使用过 C7 格式，我只是把它作为一个可能的优势，因为你在问。

顺便说一句，这就是 GCC 在我正在使用的几个平台上做事的方式。DWARF2 格式埋在输出 ELF 中。Unix 人认为他们太搞笑了。:)

顺便说一句，可以使用[DIA SDK](http://www.google.com/search?source=ig&hl=en&rlz=&=&q=dia+sdk&btnG=Google+Search&aq=f)解析 PDB 格式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-02-05T06:55:01.843

`/Z7`将调试信息以 CodeView 格式保存在 .obj 文件中，并让链接器将它们提取到 .pdb 中，同时`/Zi`在编译期间通过与 mspdbsrv.exe 同步将其合并到一个通用的 .pdb 文件中。

这`/Z7`意味着更多的文件 IO、正在使用的磁盘空间以及链接器的更多工作（除非使用 /DEBUG:FASTLINK），因为这些 obj 文件中有很多重复的调试信息。但这也意味着每次编译都是独立的，因此实际上仍然比`/Zi`足够的并行化要快。

到目前为止，他们已经`/Zi`通过减少与 mspdbsrv.exe 的进程间通信来改善这种情况：[https ://docs.microsoft.com/en-us/cpp/build/reference/zf](https://docs.microsoft.com/en-us/cpp/build/reference/zf)

的另一个用例是“独立”（尽管更大）静态库，如果您愿意，`/Z7`不需要单独运送。只要您不使用正确[的](https://docs.microsoft.com/en-us/cpp/build/reference/fd-program-database-file-name)`.pdb`https://docs.microsoft.com/en-us/cpp/build/reference/fd-program- [database-file-name](https://docs.microsoft.com/en-us/cpp/build/reference/fd-program-database-file-name)，大多数人都忘记了。`vcxxx.pdb`

`/ZI`就像`/Zi`但添加了其他数据等以使“编辑和继续”功能正常工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-12T06:09:04.983

/Z7 还有一个缺点：它与增量链接不兼容，这可能是避免它的一个原因。链接：http: [//msdn.microsoft.com/en-us/library/4khtbfyf%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/4khtbfyf%28v=vs.100%29.aspx)

顺便说一句：即使微软说当“使用 /Yu /Z7 选项编译的对象已更改”时执行完整链接（而不是增量链接），但似乎这仅适用于使用 / 构建的静态库Z7，不适用于目标文件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-01-26T12:44:16.977

/Z7 的另一个缺点是目标文件很大。这已经在这里提到过，但是这可能会升级到链接器无法链接可执行文件的程度，因为它打破了链接器的大小限制或 PE 格式（它会给您链接器错误 LNK1248）。似乎 Visual Studio 或 PE 格式的硬限制为 2GB（也在 x64 机器上）。在构建调试版本时，您可能会遇到此限制。看来这不仅会影响最终编译的可执行文件的大小，还会影响临时数据。只有 Microsoft 知道链接器的内部结构，但我们在这里遇到了这个问题（尽管可执行文件当然不是 2gigs 大，即使在调试中也是如此）。当我们将项目切换到 /ZI 时，问题奇迹般地消失了，再也没有出现过。

# asp.net - 将提前输入功能添加到 asp.net 下拉列表控件

> ID：284783
> 
> 赞同：2
> 
> 时间：2008-11-12T18:05:27.893
> 
> 标签：asp.net

如何将提前输入功能添加到 asp.net 下拉列表控件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T18:28:52.167

更具体地说，查看 ListSearch 扩展程序。[此处](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/ListSearch/ListSearch.aspx)提供演示

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T18:11:01.937

查看 www.asp.net 上的 ajax 控制工具包

# sql - MS-SQL 中是否有“START AT”等价物？

> ID：284784
> 
> 赞同：11
> 
> 时间：2008-11-12T18:05:38.017
> 
> 标签：sql, sql-server

一些数据库支持以下命令：

```
SELECT TOP 10 START AT 10 * FROM <TABLE> 
```

本质上，我需要提取前 10 条记录，然后是接下来的 10 条记录，然后是接下来的 10 条记录，等等。也许还有另一种方法可以做到这一点，但过去我已经像上面那样为支持“START AT”的数据库完成了它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-01-12T08:58:25.753

对于[SQL Server 2012](http://msdn.microsoft.com/en-us/library/ms188385%28v=SQL.110%29.aspx)

```
SELECT * 
FROM <TABLE>
ORDER BY <SomeCol>
OFFSET 10 ROWS
FETCH NEXT 10 ROWS ONLY; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-12T18:08:09.837

哪个版本的 SQL Server？

在 SQL Server 2000 中，这是一个真正的痛苦（尽管可能使用像 stingyjack 发布的丑陋技巧）。

在 2005 年及以后，它变得更容易了——看看[Row_Number()](http://msdn.microsoft.com/en-us/library/ms186734.aspx)函数。

而且，根据您的客户端应用程序，它甚至可能没有那么难。一些 ASP.Net 网格控件支持自动分页。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-12T18:08:08.340

```
SELECT Top 10 * 
FROM Table 
WHERE <primary key> Not IN (
    SELECT Top 10 <primaryKey> 
    FROM Table 
    ORDER BY <primary Key> ASC) 
ORDER BY <primary Key> ASC 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-12T18:24:01.600

如果您想与 SQL Server 2000 兼容，您可以使用

```
SELECT * FROM
(
    SELECT TOP 10 FROM
    (
        SELECT TOP (n * 10) FROM <table> ORDER BY (column) ASC
    ) AS t1 ORDER BY (column) DESC
) AS t2 ORDER BY (column) ASC 
```

在 SQL Server 2005 中有一个新函数 Row_Number()。你可以这样使用它：

```
WITH Orders AS 
(
     SELECT SalesOrderID, OrderDate, 
     ROW_NUMBER() OVER (order by OrderDate) AS 'RowNumber' 
     FROM SalesOrder
) 
SELECT * 
FROM Orders 
WHERE RowNumber between 10 and 19; 
```

# php - 带浮点的 PHP 精度 - 复杂方程 = 1

> ID：284786
> 
> 赞同：0
> 
> 时间：2008-11-12T18:05:55.037
> 
> 标签：php, math, floating-point, equation

我有以下等式

> 1 - ((.5 * 0.83333333333333) ^ 2 + (.5 * 0.83333333333333) ^ 2 + (.5 * (1 - 0.83333333333333)) ^ 2 + (.5 * (1 - 0.83333333333333)) ^ 2)

在 Php5 中，这导致答案为 1 而不是 0.63（在两台机器上，OSx 和 Centos）。我应该专门使用 Php 的 bc 数学函数来做这样的方程吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T18:14:21.900

我想也许你应该使用[pow()](http://www.php.net/pow)而不是[xor 运算符 (^)](http://www.php.net/manual/en/language.operators.bitwise.php) :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T18:18:09.397

不是真正的方程式，而是语义。另外，我怀疑你的意思是异或，所以我认为这不是你想要的。无论如何，你能用有理算术吗？

0.83333 可以转换为分数（假设 3 是重复小数）：

```
 83.3333333 = 100x
  8.3333333 = 10x
 -----------------
         75 = 90x
     x = 75 / 90 = 0.83333... 
```

这样你只处理整数，只要两者都没有溢出（你可以在操作之前和之后通过 GCD 减少），那么你应该没问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T18:27:20.533

```
<?php

$hugeDamnEquation = pow(1 - ((.5 * 0.83333333333333), 2) + pow((.5 * 0.83333333333333), 2) + pow((.5 * (1 - 0.83333333333333)), 2) + pow((.5 * (1 - 0.83333333333333)), 2));

echo $hugeDamnEquation;

?> 
```

# mysql - 在 MySQL 5.x 中，是否可以根据条件（不使用视图）授予权限？

> ID：284796
> 
> 赞同：0
> 
> 时间：2008-11-12T18:10:05.560
> 
> 标签：mysql, security, views, privileges

在我开始的项目中，我想根据某些条件授予用户权限，例如（在某个表中）：

*   可以读取所有行
*   不能写入 id < x 的行，但可以写入行 >= x
*   ETC...

我想避免视图，因为每个用户的这些条件可能会改变（我知道我必须为每个案例创建一个视图）我也想避免在客户端强制执行它，因为它很容易被绕过。

如果这是不可能的，你会建议什么解决方法？

提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T18:30:05.863

我认为原始 MySQL 特权系统不可能。

只要您不想在客户端实现它，自己修改 MySQL 代码可能是您唯一的选择。毕竟它是开源的；）

# sql-server - 在 SQL SERVER 中索引大表

> ID：284804
> 
> 赞同：2
> 
> 时间：2008-11-12T18:12:56.067
> 
> 标签：sql-server, indexing

我有一张大表（超过 1000 万条记录）。该表在应用程序中大量用于搜索。所以，我不得不在表上创建索引。但是，当在表中插入或更新记录时，我会遇到性能缓慢的问题。这很可能是因为重新计算了索引。

有没有办法改善这一点。

提前致谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-12T18:33:41.737

您可以尝试通过减少索引的填充因子来减少页面拆分的数量（在您的索引中）。默认情况下，填充因子为 0（与 100% 相同）。因此，当您重建索引时，页面会被完全填满。这适用于未修改的表（插入/更新/删除）。但是，当数据被修改时，索引需要改变。填充因子为 0 时，可以保证获得页面拆分。

通过修改填充因子，您应该在插入和更新方面获得更好的性能，因为页面不会总是被拆分。我建议您使用 Fill Factor = 90 重建索引。这将使 10% 的页面留空，这将导致更少的页面拆分，从而减少 I/O。90 可能不是使用的最佳值，因此这里可能涉及一些“反复试验”。

通过使用不同的填充因子值，您的选择查询可能会稍微变慢，但如果填充因子为 90%，您可能不会注意到太多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T18:16:31.660

我们需要查看您的索引，但可能是的。

需要记住的一些事情是，您不想只在每一列上放置一个索引，而且您通常不希望每个索引只有一列。

最好的办法是，如果您可以记录一些实际搜索，跟踪用户实际搜索的内容，并针对这些特定类型的搜索创建索引。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T18:23:39.557

您可以选择多种解决方案

a）您可以对表进行分区

b) 考虑在非高峰时间（如晚上）批量执行更新

c) 由于工程是权衡的平衡行为，因此您必须选择哪个更重要（选择或更新/插入/删除）以及哪个操作更重要。假设您不需要“插入”的实时结果，您可以使用 Sql server 服务代理进行这些操作以异步执行“不太重要”的操作

[http://msdn.microsoft.com/en-us/library/ms166043(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms166043(SQL.90).aspx)

谢谢-RVZ

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T18:18:26.697

这是一个经典的工程权衡……您可以使铲子更轻或更坚固，但不能两者兼而有之……（直到材料科学取得突破。）

更多的索引意味着更多的 DML 维护，意味着更快的查询。

更少的索引意味着更少的 DML 维护，意味着更慢的查询。

您的某些索引可能是多余的并且可以合并。

除了 Joel 所写的内容，您还需要为 DML 定义 SLA。可以吗？它变慢了吗？您注意到它变慢了，但是与您实现的查询改进相比，这真的很重要吗... IOW，有这么弱的轻型铲子可以吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T19:13:28.740

如果您有一个不在标识数字字段上的聚集索引，则重新排列页面可能会减慢您的速度。如果是这种情况，请查看是否可以通过将其设为非聚集索引来提高速度（比没有索引快，但往往比聚集索引慢一点，因此您的选择可能会减慢，但插入会提高）

我发现用户更愿意容忍稍慢的插入或更新到较慢的选择。这是一条一般规则，但如果它变得非常缓慢（或更糟糕的超时），那么没有人可以处理得很好。

# lotus-notes - 如何导出驻留在给定 Domino 服务器上的数据库列表？

> ID：284821
> 
> 赞同：3
> 
> 时间：2008-11-12T18:17:31.737
> 
> 标签：lotus-notes, lotus-domino

我有一个 Lotus Domino 服务器，上面有数量惊人的 Domino 数据库，排列在不同的文件夹中。

有没有办法以某种电子表格格式导出所有这些数据库的列表，以及它们的标题和创建者的姓名？我拥有 Domino Admin 和 Domino Designer 软件，并且拥有或可以获得所需的任何访问权限。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-26T00:24:04.800

实际上，您可以使用一个非常简单的 Lotuscript 代理连接到服务器并使用 NotesDbDirectory 类遍历服务器上的所有数据库。这是一些代码，根据 6.5 帮助文件中的内容稍作修改 - 这会将所有数据库的标题和路径转储到 csv 文件。注意：GetFirstDatabase 方法的一个参数让您指定要扫描服务器上的哪些对象 - 1247 是“数据库”的常量 - 基本上，所有 NSF 文件。还有其他常量仅用于查找模板（NTF），仅用于启用复制的数据库等。

```
Sub Initialize
    Dim db As NotesDatabase
    Dim f As Integer
    f = Freefile
    Open "c:\dbExport.csv" For Output As #f

    Dim dbdir As New NotesDbDirectory("")  ' opens LOCAL - put a server name here
    Set db = dbdir.GetFirstDatabase(1247)  ' all databases - NSF, NSG and NSH (no templates)
    While Not(db Is Nothing)
        Print #f, """" + db.Title + """, """ + db.FileName + """"
        Set db = dbdir.GetNextDatabase
    Wend
    Close #f
End Sub 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T18:43:26.803

您可能认为 Domino Admin 中有一种方法，但无法导出列表。所以，我认为你最好的选择是使用域目录数据库。要构建它，请进入服务器配置文档 > 服务器任务 > 并打开域目录。然后catalog.nsf 数据库将被构建并且将包含您域中的所有数据库。您可以自定义视图以包含您需要的信息。

最后，您可以进入一个视图，选择所有文档并单击编辑 > 将所选内容复制为表格。然后将其粘贴到电子表格中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-06-19T11:29:32.600

一个鲜为人知的事实是，您可以在 Admin 客户端中“全选”并粘贴到 Excel 中。还有一个用于数据库平面视图而不是文件夹视图的选项。

没有列出数据库的创建者，但还有很多其他有用的信息

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-05T18:23:10.640

继承了一些遗留服务器，不是吗？

如果过去对服务器进行了明智的维护，那么您已经拥有以下内容：

*   一个catalog.nsf数据库，这正是你想要的，只有更好
*   `catalog`服务器任务启动并运行。

目录任务是自动构建和维护 catalog.nsf 数据库的任务。如果它尚未运行，您可以在 Domino admin 的服务器控制台上启动它一次： `load catalog`

甚至更好的是，将其添加到服务器的 notes.ini 中的服务器任务中

现在，编目任务仅涵盖已设置属性（例如允许编目）的数据库。一个行为良好的 Domino 管理员不会允许数据库在没有正确设置这些属性的情况下进入生产环境（我相信它无论如何都是默认设置），但您似乎并不完全处于正常情况。

如果这还不够*，*如果你有时间修补，我曾经遇到过类似的情况，我用一些相当先进的脚本建立了一个数据库来进行彻底的人口普查，包括代理人及其时间表等。如果你愿意，我很乐意把它传给你。

玩得开心你的新玩具！

# prolog - 序言列表中的尾随变量

> ID：284826
> 
> 赞同：3
> 
> 时间：2008-11-12T18:18:42.873
> 
> 标签：prolog

我正在上prolog的初学者课程，做地图着色问题。这是我的代码。

```
col(Colors,Map,Coloring) :-
    checkMap(Colors,Map,Coloring).
checkMap(Colors,[Country1:Country2],Coloring) :-
    goodColor(Country1:Country2,Coloring,Colors).
checkMap(Colors,[Country1:Country2|Rest],Coloring) :-
    goodColor(Country1:Country2,Coloring,Colors),
    checkMap(Colors,Rest,Coloring).
goodColor(Country1:Country2,Coloring,Colors) :-
    mem(Country1:Color1,Coloring),!,
    mem(Country2:Color2,Coloring),!,
    mem(Color1,Colors), mem(Color2,Colors),
    not(Color1=Color2).
mem(Var,[Var|_]).
mem(Var,[_|Rest]) :-
    mem(Var,Rest). 
```

我的输出如下所示：

```
?- col([a,b,c],[1:2,1:3,2:3],X).
X = [1:a, 2:b, 3:c|_G332] ;
X = [1:a, 2:c, 3:b|_G332] ;
X = [1:b, 2:a, 3:c|_G332] ;
X = [1:b, 2:c, 3:a|_G332] ;
X = [1:c, 2:a, 3:b|_G332] ;
X = [1:c, 2:b, 3:a|_G332] ;
fail. 
```

任何人都知道我怎样才能摆脱尾随变量？我知道它主要是化妆品，但我不明白它为什么在那里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T19:13:57.473

使用不完整的数据结构是一种有效的 Prolog 编程技术。如果您打算使用不完整的数据结构，那么一种解决方案是：

```
ground_terms([H|T1],[H|T2]) :- ground(H), !, ground_terms(T1,T2).
ground_terms(_,[]). 
```

并更改 col 如下：

```
col(Colors,Map,Coloring) :-
    checkMap(Colors,Map,Coloring1),
    ground_terms(Coloring1,Coloring). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-13T18:30:21.410

尾随变量在那里是因为`mem(Var,[Var|_])`将未绑定的`Coloring`变量绑定到`[Var|_]`.

避免它的一种方法是累积地图着色，例如（非常快速且非常脏）：

```
col(Colors,Map,Coloring) :-
    check(Colors,Map,[],Coloring).

check(Colors,[],Coloring,Coloring).

check(Colors,[Country1:Country2 | T],[],L) :-
    member(Color1,Colors),
    member(Color2,Colors),
    Color1 \== Color2,
    check(Colors,T,[Country1:Color1,Country2:Color2],L).

check(Colors,[Country1:Country2 | T],Coloring,L) :-
    member(Country1:Color1,Coloring),
    member(Country2:Color2,Coloring),!,
    check(Colors,T,Coloring,L).

check(Colors,[Country1:Country2 | T],Coloring,L) :-
    member(Country1:Color1,Coloring),!,
    member(Color2,Colors),
    not(member(_:Color2,Coloring)),
    check(Colors,T,[Country2:Color2|Coloring],L).

check(Colors,[Country1:Country2 | T],Coloring,L) :-
    member(Country2:Color2,Coloring),!,
    member(Color1,Colors),
    not(member(_:Color1,Coloring)),
    check(Colors,T,[Country1:Color1|Coloring],L). 
```

不过，它比你的方法更“程序化”:-(。可能有一种更优雅的方法......

# vb.net - 为了使这段 Vb 代码正常工作，我缺少什么（VB 2005）

> ID：284832
> 
> 赞同：1
> 
> 时间：2008-11-12T18:22:13.180
> 
> 标签：vb.net

```
For Each line As String In System.IO.File.ReadAllLines("file.txt")
'Do Something'
Next 
```

和

```
Using f As System.IO.FileStream = System.IO.File.OpenRead("somefile.txt")
    Using s As System.IO.StreamReader = New System.IO.StreamReader(f)
            While Not s.EndOfStream
                    Dim line As String = s.ReadLine

                    'put you line processing code here

            End While
    End Using
End Using 
```

都显示为红色，我正在运行 MS VS2005 的全新安装，并且这些代码都推荐给我，我是否缺少其他需要安装或声明的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T18:31:19.120

从 Msdn 您应该执行以下操作以读取所有行

```
Dim Lines As String()
Lines = System.IO.File.ReadAllLines("file.txt") 
```

对于第二个例子，这样的事情可能会奏效

```
Dim sr as New StreamReader("somefile.txt")
Dim line as String = sr.ReadLine()
Do While Not line is Nothing
    line = sr.ReadLine()
    'do something else
Loop 
```

我刚刚创建了以下 VB.Net 控制台应用程序，它工作正常：

```
Imports System.IO

Module Module1

Sub Main()
    Dim sr As New StreamReader("somefile.txt")
    Dim line As String = sr.ReadLine()
    Do While Not line Is Nothing
        line = sr.ReadLine()
        'do something else
    Loop

End Sub

End Module 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T18:35:57.707

您的代码是否被类和方法包围？

```
Public class CodeClass
    Public Sub CodeMethod

        Using f As System.IO.FileStream = System.IO.File.OpenRead("somefile.txt")
            Using s As System.IO.StreamReader = New System.IO.StreamReader(f)
                While Not s.EndOfStream
                    Dim line As String = s.ReadLine

                    //Non-vb comment for easier to read SO code
                End While
            End Using
        End Using

    End Sub
End Class 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T18:56:16.027

对于 vb6.0 你需要

```
Dim value As String = My.Computer.FileSystem.ReadAllText(file) 
```

# c++ - 如何在 C++ 标头中声明数组？

> ID：284833
> 
> 赞同：22
> 
> 时间：2008-11-12T18:22:15.720
> 
> 标签：c++, arrays, header, initialization, constants

这与其他一些问题有关，例如：[this](https://stackoverflow.com/questions/34987/how-to-declare-an-array-of-strings-in-c)和我的其他一些问题。

在[这个问题](https://stackoverflow.com/questions/34987/how-to-declare-an-array-of-strings-in-c)和其他问题中，我们看到我们可以在一个不错的步骤中声明和初始化字符串数组，例如：

```
const char* const list[] = {"zip", "zam", "bam"}; //from other question 
```

这可以在没有麻烦的函数实现中完成，也可以在任何范围之外的 .cpp 文件的主体中完成。

我想要做的是将这样的数组作为我正在使用的类的成员，如下所示：

```
class DataProvider : public SomethingElse
{
    const char* const mStringData[] = {"Name1", "Name2", "Name3", ... "NameX"};

public:
    DataProvider();
    ~DataProvider();

    char* GetData()
    {
        int index = GetCurrentIndex(); //work out the index based on some other data
        return mStringData[index]; //error checking and what have you omitted
    }

}; 
```

但是，编译器抱怨，我似乎无法弄清楚为什么。是否可以在类定义的一个步骤中声明和初始化这样的数组？有没有更好的替代品？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-12T18:29:41.510

使用关键字 static 和外部初始化使数组成为类的静态成员：

在头文件中：

```
class DataProvider : public SomethingElse
{
    static const char* const mStringData[];

public:
    DataProvider();
    ~DataProvider();

    const char* const GetData()
    {
        int index = GetCurrentIndex(); //work out the index based on some other data
        return mStringData[index]; //error checking and what have you omitted
    }

}; 
```

在 .cpp 文件中：

```
const char* const DataProvider::mStringData[] = {"Name1", "Name2", "Name3", ... "NameX"}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T18:25:48.290

这在 C++ 中是不可能的。您不能直接初始化数组。相反，您必须给它它的大小（在您的情况下为 4），并且您必须在 DataProvider 的构造函数中初始化数组：

```
class DataProvider {
    enum { SIZEOF_VALUES = 4 };
    const char * values[SIZEOF_VALUES];

    public:
    DataProvider() {
        const char * const v[SIZEOF_VALUES] = { 
            "one", "two", "three", "four" 
        };
        std::copy(v, v + SIZEOF_VALUES, values);
    }
}; 
```

请注意，您必须放弃数组中指针的常量性，因为您无法直接初始化数组。但是您需要稍后将指针设置为正确的值，因此指针需要是可修改的。

如果数组中的值仍然是 const，则唯一的方法是使用静态数组：

```
/* in the header file */
class DataProvider {
    enum { SIZEOF_VALUES = 4 };
    static const char * const values[SIZEOF_VALUES];
};

/* in cpp file: */

const char * const DataProvider::values[SIZEOF_VALUES] = 
    { "one", "two", "three", "four" }; 
```

拥有静态数组意味着所有对象都将共享该数组。因此，您也将节省内存。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-12T18:25:57.943

你不能像这样声明你的数组 (const char* []) 的原因是：

*   你不能在类声明中有初始化器，所以
*   语法`const char* []`没有说明编译器需要为每个实例分配多少空间（您的数组被声明为实例变量）。

此外，您可能希望将该数组设为静态，因为它本质上是一个常量值。

# css - CSS margin-top vs margin-bottom

> ID：284837
> 
> 赞同：39
> 
> 时间：2008-11-12T18:23:25.533
> 
> 标签：css, layout

如果您有一系列块元素，并且您想在它们之间放置边距。

您更喜欢哪一个，margin-top 或 margin-bottom 或两者兼而有之？为什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-11-12T18:30:51.633

取决于上下文。但是，通常`margin-top`更好，因为您可以使用`:first-child`它来删除它。像这样：

```
div.block {
    margin-top: 10px;
}

div.block:first-child {
    margin-top: 0;
} 
```

这样，边距仅在块之间。

显然，仅适用于更现代的浏览器。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-12T18:28:09.750

我总是使用`margin-bottom`，这意味着在第一个元素之前没有不必要的空间。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2018-10-04T21:45:03.803

这里投票最多的[答案](https://stackoverflow.com/a/284865/908879)有点过时了，因为它说去的好处`margin-top`是你可以使用`:first-child`（但从 2018 年开始，你可以将*margin-bottom*与*:last-child*结合使用并获得同等支持）。

然而，更喜欢**margin-top 和 :first-child**的原因（而不是*margin-bottom*和*:last-child*）在这篇文章[CSS: margin top vs bottom](https://matthewjamestaylor.com/css-margin-top-vs-bottom)中有详细解释。

基本上，它说如果你在其他类似块之间有一个块，并且你希望这个块的边距（顶部和底部）与其他块不同，你会遇到更多麻烦，因为没有简单的方法来选择进行中的元素，但是使用[相邻的兄弟选择器（+）](https://developer.mozilla.org/en-US/docs/Web/CSS/Adjacent_sibling_selectors)可以在不需要帮助类的情况下实现这一点：

[![在此处输入图像描述](https://i.stack.imgur.com/Um36f.png)](https://i.stack.imgur.com/Um36f.png)

使用**带有 :first-child**结构的 margin-top，为广告提供适当间距所需的 CSS 是：

```
article {
    margin-top: 2em;
}

article:first-child {
    margin-top: 0;
}

//space at the top of the Ad
.ad {
    margin-top: 1em;
}

//and to reduce space below the ad
.ad + article {
    margin-top: 1em;
} 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-02-14T22:25:49.377

另一种选择是`+`结合使用选择器`margin-top`：

```
.article + .article {
    margin-top: 10px;
} 
```

这将选择后一个元素，这意味着该规则根本不适用于第一个元素。元素上方或下方没有额外的类、伪类或空间。

```
/* CSS rules for legibility. */
section, article {
  outline: 1px solid blue;
}

section {
  background: lightgreen;
  padding: 10px;
}

section + section {
  margin-top: 30px;
}

article {
  background: lightblue;
}

/* Using the + selector. */
#PlusSelectorExample article + article {
  margin-top: 30px;
}

/* Using margin-bottom only. */
#MarginBottomExample article {
  margin-bottom: 30px;
}

/* Using last-child. */
#LastChildExample article {
  /* Other CSS rules for this element. */
  margin-bottom: 30px;
}

#LastChildExample article:last-child {
  margin-bottom: 0;
}
```

```
<p>The plus selector only selects an element following another. Combining the plus selector and margin-top means there's no extra space at the top since the selector doesn't apply.</p>
<section id ="PlusSelectorExample">
  <article>In vel sem sed nulla scelerisque semper. Fusce dictum semper lectus, a cursus turpis fermentum vitae.</article>
  <article>Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.</article>
  <article>Suspendisse potenti. Duis id lacus augue. Duis ultricies est viverra, dapibus est quis, pretium sapien.</article>
</section>
<p>Using margin-bottom leaves an extra gap at the bottom.</p>
<section id="MarginBottomExample">
  <article>In vel sem sed nulla scelerisque semper. Fusce dictum semper lectus, a cursus turpis fermentum vitae.</article>
  <article>Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.</article>
  <article>Suspendisse potenti. Duis id lacus augue. Duis ultricies est viverra, dapibus est quis, pretium sapien.</article>
</section>
<p>Combining margin-bottom with last-child achieves the same as the plus operator.</p>
<section id="LastChildExample">
  <article>In vel sem sed nulla scelerisque semper. Fusce dictum semper lectus, a cursus turpis fermentum vitae.</article>
  <article>Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.</article>
  <article>Suspendisse potenti. Duis id lacus augue. Duis ultricies est viverra, dapibus est quis, pretium sapien.</article>
</section>
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-06-27T11:38:43.110

我总是把边距放在我认为*更可选*的元素上。也就是说，对于更有可能从 DOM 中删除的元素。例子：

```
<div class="title">My Awesome Book</div>
<p>Description of My Awesome Book</p> 
```

在这种情况下，我会`margin-top`使用`<p>`，因为如果没有标题，描述就没有多大意义，但如果我只想提及标题，描述就有可能被删除。

另一个例子：

```
<img src="icon.png">
<div>My Awesome Book</div> 
```

在这里，我会做相反的事情。我会添加`margin-bottom`到图标中。我认为图标只是一种装饰，而且它有更多被删除的潜力。

这是我的哲学。样式元素是通过潜在的 DOM 更改来防止 CSS 更改的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-15T18:41:12.493

@This Mat - 我不同意你的做法。我会以语义方式在元素上分配间距，并使用上下文选择器来定义该元素集合的行为。

```
.content p { /* obviously choose a more elegant name */
   margin-bottom: 10px;
} 
```

根据类的行为而不是内容来命名类是一种滑坡，并且会混淆 HTML 的语义性质。例如，如果在页面的某个区域，所有具有类 .top10 的元素突然需要 20 像素，该怎么办？您不必更改单个规则，而是必须创建一个新的类名，并在您想要影响的所有元素上更改它。

要回答最初的问题，这完全取决于您希望元素如何堆叠。您想要顶部或底部的额外空间吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-09-01T13:37:56.063

我不太明白为什么你们中的一些人说margin-bottom 比margin-top 更符合逻辑。

只是为了确保大家都知道：页面是从上到下呈现的。

让我们考虑一个简单的问题

```
<div class="box">
   <div class="item first"></div>
   <div class="item second"></div>
   <div class="item third"></div>
</div> 
```

盒子内的元素之间应该有它们的距离。

一个非常通用的解决方案

```
.item:nth-child(n+2) {
    margin-top: 16px;
} 
```

或者你可以使用

```
.item + .item {
    margin-top: 16px;
} 
```

如您所见，只需要 1 条规则。它仅在存在超过 1 个元素时才起作用，如果例如由于某种原因“第一”和“第二”不存在，您不希望从顶部获得额外的空间导致空间从顶部开始由“box”元素填充处理。

如果由于某种原因一个或多个元素应该具有与其他元素不同的间距，您只需执行以下操作：

```
.item + .item {
    margin-top: 16px;
}

.item + .item.second {
    margin-top: 32px;
   // you could use margin-bottom here but there will be needed a different rule for handling if there is no 3rd element
}

.item.second + .item {
    margin-top: 32px;
} 
```

我在这里发现 1 个问题，如果您将一个元素注入到不包含类“项目”的列表中，但您为什么要这样做？

考虑到 margin-bottom 我试图找到一些解决方案，但我没有看到任何不需要编写多个规则的解决方案。

```
.item {
    margin-bottom: 16px;
}

.item:last-child {
   margin-bottom: 0px;
} 
```

不要误会，在某些情况下需要底部边距，但我发现很少使用它。

根据我的经验，margin-bottom 总是像脚上的针。

我发现一般来说，元素之间和页面之间的关系应该尽可能少，并且它们应该尽可能地可重用。

Ofc 让您的生活更简单是您决定做或不做的事情。

维护一条规则而不是多条规则是一件更好的事情，您不同意吗？

更少的 CSS 代码 = 更好的性能 -> 更快的下载

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-14T19:28:59.630

是的，我通常也使用 margin-bottom ，然后将最后一个类分配给最后一个类。假设你想要一个不同的样式。

```
.discussion .detailed.topics { margin: 20px 0 }    
.discussion .detailed.topics .topic { margin-bottom: 30px }
.discussion .detailed.topics .topic.last { margin-bottom: 0 } 
```

当您使用动态驱动的内容时，这是一种强大的方法

HTML（剃刀视图引擎）

```
<div class="detailed topics">   
   @if (Model.ActiveTopics != null && Model.ActiveTopics.Count > 0)
   {
      for (int i = 0; i < Model.ActiveTopics.Count(); i++)
      {
          var topic = Model.ActiveTopics[i];
          <div class="topic@(i == Model.ActiveTopics.Count - 1 ? " last" : "")">
                ...                                 
          </div>
      }
   }
</div> 
```

# java - 任何可用于 java 文件的命令行格式工具？

> ID：284841
> 
> 赞同：13
> 
> 时间：2008-11-12T18:24:07.310
> 
> 标签：java, formatting

我们正在开发一个遗留系统（7 岁），其中包含许多以前从未格式化过的 java/jsp 文件，根本**不是阅读器**。因为我们有很多旧版本，我们担心如果我们格式化它们，我们将无法有效地区分未格式化和格式化的文件。

是否有可用的命令行格式工具，我们可以在对新版本进行 diff 之前格式化旧版本的文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T19:19:52.283

已经有一段时间了，但我们曾经使用[Jalopy](http://jalopy.sourceforge.net/)。我相当肯定你可以从命令行运行它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T22:34:12.063

也许[艺术风格](http://astyle.sourceforge.net/ "艺术风格")会为你工作。

我的书签中也有[Uncrustify](http://uncrustify.sourceforge.net/ "去壳")，从未使用过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T18:44:18.390

Eclipse 和 IntelliJ 在它们的差异查看器中都有忽略空白选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-03T08:31:43.040

[您可以尝试使用此处](http://blogs.operationaldynamics.com/andrew/software/java-gnome/eclipse-code-format-from-command-line)提到的命令行中的 eclipse 源代码格式化程序。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-12T18:26:53.183

[http://checkstyle.sourceforge.net/cmdline.html](http://checkstyle.sourceforge.net/cmdline.html)有命令行工具。

# wcf - WCF 可靠会话如何影响消息排序？

> ID：284842
> 
> 赞同：1
> 
> 时间：2008-11-12T18:24:11.210
> 
> 标签：wcf, session, client-server

Microsoft 文档中提到的关于启用可靠会话的一件事是，该服务将能够按照收到消息的顺序处理消息。

这是否意味着单个会话中的消息按顺序处理？或者这是否意味着服务内*所有会话*的所有消息都按顺序处理？

我知道 netTcpBinding 已经是可靠的，但没有启用可靠的会话。但是，假设您在没有启用可靠会话的情况下使用 WsDualHttpBinding 之类的东西......*如果客户端发送请求 A 然后发送请求 B ，服务可能会在 A 之前接收 B*吗？或者这是否意味着如果客户端 A 发送消息 A 而客户端 B 发送消息 B，我可能会在 A 之前处理 B？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T16:41:36.340

服务可能在 A 之前收到 B，但可靠会话会将消息放在缓冲区中，并且仅按照它们在会话中发送的顺序处理它们。它不会在不同会话之间进行排序，仅在客户端创建的同一会话中进行排序。

# .net - .Net 或 COM 库来读取 SWF Actionscript

> ID：284854
> 
> 赞同：1
> 
> 时间：2008-11-12T18:28:25.460
> 
> 标签：.net, flash, actionscript

我正在寻找一个库来读取 SWF 文件并让我解析它的动作脚本和标头信息。有什么可以工作的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-13T14:27:53.707

我最终在以下位置找到了一个：

[http://sourceforge.net/projects/swfdotnet/](http://sourceforge.net/projects/swfdotnet/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-13T02:43:08.003

我不知道有任何库（包括 .NET）可以让您读取和解析（或反向工程）SWF 文件的内容。您所指的 ActionScript 在编译期间被编译为字节码，因此您不会在 SWF 文件中找到实际的 ActionScript 源代码。

有关 SWF 文件格式的更多信息，我建议您查看[官方规范](http://www.adobe.com/devnet/swf/pdf/swf_file_format_spec_v9.pdf)。

# visual-studio - Visual Studio 项目/解决方案结构是否有任何最佳实践？

> ID：284856
> 
> 赞同：35
> 
> 时间：2008-11-12T18:28:56.240
> 
> 标签：visual-studio

我在这个主题上看到了很多不同的看法，所以我想在这方面是否有更好的方法。

关于如何针对同一解决方案的多个解决方案设置 Visual Studio 项目和解决方案，是否有任何最佳实践？

例如：假设我有一个需要 Web 应用程序、控制台应用程序和共享业务逻辑库的任务。

在我的职业生涯中，我曾在 1、2 和 3 解决方案中看到过这种情况。这是一个简单的例子；但是，如果项目数量增加怎么办？是否有一条线何时将其保持在一个或将其分开？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-12T19:04:44.293

[事实上，在MSDN](http://msdn.microsoft.com/en-us/library/ee817674.aspx)上有一些关于这种设置的指南。我在对 StackOverflow 上[类似问题的回答中写了一个简短的摘要。](https://stackoverflow.com/questions/200954/solution-per-application-or-per-application-suite#201064)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2011-02-14T21:47:21.150

早在 2007 年，我就在博客上写过这篇文章。建议仍然有效：

[http://mikehadlow.blogspot.com/2007/07/how-to-structure-visual-studio.html](http://mikehadlow.blogspot.com/2007/07/how-to-structure-visual-studio.html)

底线是我应该能够让你的代码脱离源代码控制，在 Visual Studio 中打开它，按 F5，一切都应该正常工作。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-12T19:02:21.960

在特定情况下，解决方案适用于开发人员。项目（C-Sharp 的.CSPROJ）是真正编译的地方。

理论上，如果有 4 个不同的项目，则开发人员可能希望将这些项目组合成 24 种不同的组合成解决方案。

如果您将所有内容都保留在项目级别，则无需担心开发人员如何安排他们的 .SLN 文件

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-12T19:01:44.877

你可以有多种解决方案，每个解决方案都可以引用它关心的项目。扩展您的示例，您的共享业务逻辑库可能具有相应的单元测试库。这两个项目可以包含在一个解决方案中。同时，您可能有另一个解决方案，其中包含您提到的三个项目，但在这种情况下，单元测试库不包括在内。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-12T19:20:04.950

我的解决方案通常包括：

*   网络应用项目
    *   用于基础和通用助手类的“通用”文件夹
    *   “包括”文件夹
        *   “样式”文件夹
        *   “脚本”文件夹
        *   “图像”文件夹
    *   “用户控件”文件夹
*   网络服务项目
*   网络框架项目
*   业务层项目
*   业务框架项目
*   数据访问项目

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-12T18:53:44.910

我喜欢在解决方案中包含特定任务的所有项目。因此，根据您提到的示例，我将有一个包含三个项目的解决方案，这些项目属于我被要求做的解决方案。这使所有元素一起完成任务，我发现这简化了解决手头任务所需的其他元素的包含。

# c# - .NET 中最简单的键/值对文件解析

> ID：284858
> 
> 赞同：10
> 
> 时间：2008-11-12T18:29:40.950
> 
> 标签：c#, .net, key-value

我的项目需要一个文件，我将在其中存储用户应该能够读取和修改的键/值对数据。我希望程序只期望密钥在那里，并且我想尽快从文件中解析它们。

我可以将它们存储在 XML 中，但是 XML 太复杂了，它需要遍历节点和子节点等等，我想要的只是一些获取文件并生成键值对的类。我想要尽可能少的错误处理，并且我希望用尽可能少的代码来完成它。

我可以自己编写一个这样的类，但我宁愿学习它是如何在框架中完成的，也不愿两次发明轮子。.NET（3.5）中是否有一些内置的魔术类能够做到这一点？

```
MagicClass kv = new MagicClass("Settings.ini"); // It doesn't neccesarily have to be an INI file, it can be any simple key/value pair format.
string Value1 = kv.get("Key1");
... 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-12-17T18:40:14.690

如果您正在寻找一个快速简单的功能并且不想使用 .Net app\user 配置设置文件或担心有时会出现的序列化问题。

以下静态函数可以加载格式为`KEY=VALUE`.

```
public static Dictionary<string, string> LoadConfig(string settingfile)
{
    var dic = new Dictionary<string, string>();

    if (File.Exists(settingfile))
    {
        var settingdata = File.ReadAllLines(settingfile);
        for (var i = 0; i < settingdata.Length; i++)
        {
            var setting = settingdata[i];
            var sidx = setting.IndexOf("=");
            if (sidx >= 0)
            {
                var skey = setting.Substring(0, sidx);
                var svalue = setting.Substring(sidx+1);
                if (!dic.ContainsKey(skey))
                {
                    dic.Add(skey, svalue);
                }
            }
        }
    }

    return dic;
} 
```

*注意：我使用的是字典，所以键必须是唯一的，这通常是设置的情况。*

用法：

```
var settingfile = AssemblyDirectory + "\\mycustom.setting";
var settingdata = LoadConfig(settingfile);
if (settingdata.ContainsKey("lastrundate"))
{
    DateTime lout;
    string svalue;
    if (settingdata.TryGetValue("lastrundate", out svalue))
    {
        DateTime.TryParse(svalue, out lout);
        lastrun = lout;
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-12T18:36:21.573

我不知道任何用于解析 ini 文件的内置类。我在需要时使用了[nini 。](http://sourceforge.net/projects/nini)它在 MIT/X11 许可下获得许可，因此在封闭源代码程序中包含任何问题。

非常好用。因此，如果您有一个这样格式化的 Settings.ini 文件：

```
[Configuration]
Name = Jb Evain
Phone = +330101010101 
```

使用它很简单：

```
var source = new IniConfigSource ("Settings.ini");
var config = source.Configs ["Configuration"];

string name = config.Get ("Name");
string phone = config.Get ("Phone"); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-12T18:38:34.473

为您的 Key 和 Value使用[KeyValuePair](http://msdn.microsoft.com/en-us/library/5tbh8a42.aspx)类，然后使用[XMLSerializer将](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)[List](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)序列化到磁盘。

那将是我觉得最简单的方法。您不必担心遍历节点。调用 Deserialize 函数将为您完成此操作。如果他们愿意，用户也可以编辑文件中的值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-12T18:41:16.120

如果您希望用户能够读取和修改文件，我建议使用逗号分隔的对，每行一个

```
key1,value1
key2,value2
... 
```

解析很简单：读取文件，用换行符或逗号分割，然后成对取元素

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T18:36:43.180

以这种方式格式化文件：

```
key1=value1
key2=value2 
```

将整个文件读入一个字符串（有一个简单的便利函数可以做到这一点，可能在 File 或 string 类中），然后调用 string.Split('=')。确保在遍历列表并将每一对弹出到哈希表或字典中时，还对每个键和值调用 string.Trim()。

# sharepoint - MOSS 32 位和 64 位可以存在于同一个场中吗？

> ID：284860
> 
> 赞同：4
> 
> 时间：2008-11-12T18:29:52.553
> 
> 标签：sharepoint, moss, replication, failover

我正在尝试为 MOSS 设置故障转移位置。当前服务器场是在 32 位 Windows 2003 上构建的。故障转移位置的服务器都是 64 位 Windows 2008。

有什么方法可以让这两个环境对话并保持同步？我已经考虑过“拉伸”场配置，但除非两个位置的位宽相同，否则这将不起作用。

MOSS 的当前数据库服务器使用集群复制到我们的故障转移位置，并且在两个位置都可见。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-13T06:58:11.360

您可以在同一个场中混合 32 位和 64 位，它完全受支持。

但是，强烈建议将每个层保持相同的位宽（例如，所有 WFE 64 位、应用程序服务器 32 位、SQL 服务器 64 位）。

来自 msdn @ [http://technet.microsoft.com/en-us/library/cc261700.aspx](http://technet.microsoft.com/en-us/library/cc261700.aspx)

> 您可以在混合使用 32 位和 64 位服务器上部署 Office SharePoint Server 2007 场，前提是您在每个拓扑层保持体系结构同质性。例如，您不应混合使用 32 位和 64 位 Web 前端 (WFE) 服务器，但可以在具有 32 位 WFE 服务器和应用程序服务器的场中使用 64 位数据库服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-09T21:37:51.207

我们实际上在同一个场中运行 32 位和 64 位 wfe，没有任何问题。我们与 MVP 进行了交谈，他说绝对支持。您遇到的问题是将 32 和 64 负载平衡在一起。

关于 MSDN 文章[http://technet.microsoft.com/en-us/library/cc261700.aspx](http://technet.microsoft.com/en-us/library/cc261700.aspx)的 MVP 报价：

> 他们假设您在同一个 NLB 中对 32 和 64 进行负载平衡，这不会很好地平衡。然而，它在架构上是绝对支持的。它应该工作。

# .net - 为什么 SolidBrush 会产生带图案的图像？

> ID：284867
> 
> 赞同：1
> 
> 时间：2008-11-12T18:31:37.527
> 
> 标签：.net, graphics, colors, gif

我正在尝试在 HttpHandler 中动态生成指定大小和颜色的 gif 图像。出于某种原因，图像是用抖动的颜色模式生成的，而不是我期望***SolidBrush***创建的纯色。以下代码是我能找到的最简单的暴露问题的代码。

```
private void GenerateSquareImage(String filename, String color, Int32 width)
{
    Bitmap img = new Bitmap(width, width);
    Graphics g = Graphics.FromImage(img);
    SolidBrush brush = new SolidBrush(ColorTranslator.FromHtml("#" + color));

    g.FillRectangle(brush, 0, 0, width, width);

    img.Save(filename, System.Drawing.Imaging.ImageFormat.Gif);
    img.Dispose();

    brush.Dispose();
    g.Dispose();
} 
```

这是我在颜色参数中传递“415976”时得到的结果示例：

[图像黑客 http://img148.imageshack.us/img148/8936/colorcb5.png](http://img148.imageshack.us/img148/8936/colorcb5.png)

（左边的块是一个 HTML SPAN，背景颜色设置为 #415976。右边的块是我的图形，您可以在其中看到抖动的颜色。）

如果我使用这段代码，结果是一样的：

```
g.Clear(ColorTranslator.FromHtml("#" + color)); 
```

代替上述方法中的 g.FillRectangle 调用。

**更新：**默认情况下，如果对位图进行任何编程更改，GDI+ 会使用[Web 安全调色板保存 GIF。](http://oreilly.com/catalog/wdnut/excerpt/web_palette.html)这就是导致我的非安全调色板颜色抖动的原因。我能够修改下面 Marco 的帖子 ( [http://msdn.microsoft.com/en-us/library/aa479306.aspx](http://msdn.microsoft.com/en-us/library/aa479306.aspx) ) 中引用的代码，以修改我新创建的图像上的调色板，以便尊重我的颜色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T20:14:56.290

据我所知，GIF 文件仅限于 256 种颜色，因此它采用抖动处理。PNG 可能是您需要的格式。

或者您可以[在这里](http://www.glennjones.net/Post/799/Highqualitydynamicallyresizedimageswithnet.htm)寻找使用复杂量化器构建自定义调色板的解决方案（我不对链接中的代码负责，我自己从未尝试过）。

[来自 Microsoft 的另一个链接](http://msdn.microsoft.com/en-us/library/aa479306.aspx)对问题进行了深入分析。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T18:38:38.513

IIRC GIF 仅限于 .NET 上的特定调色板。有一些解决方法，但它们超出了我的理解。

# asp.net - 在 ASP.NET 中写入日志文件

> ID：284868
> 
> 赞同：9
> 
> 时间：2008-11-12T18:32:09.447
> 
> 标签：asp.net, logging

我正在使用 File.AppendAllText 方法将事件数据写入 asp.net httphandler 中的日志文件。我担心同时收到多个请求时会发生什么。AppendAllText 是否锁定它正在写入的文件？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-07-08T12:12:22.000

我建议使用`TextWriterTraceListener`而不是尝试自己管理。

设置和使用非常简单：

```
TextWriterTraceListener logListener = new TextWriterTraceListener("C:\log.txt", "My Log Name");
Trace.Listeners.Add(logListener); 
```

然后记录一些东西：

```
Trace.WriteLine("Log this text"); 
```

它使用起来非常简单，并且有许多不同类型的 SQL、事件日志、文本文件等侦听器。因此，如果您想更改侦听器，则无需调整代码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-12T18:39:16.560

不，您应该有一个静态锁定对象来保护日志文件的写入，例如

```
public static object LockingTarget = new object();

public void LogToFile(string msg)
{
    lock(LockingTarget)
    {
        //append to file here as fast as possible
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T18:38:38.857

您可以使用 My.Log 写入日志文件。

编辑：如果您使用 FileLogTraceListener，则该侦听器是线程安全的。

这样做还允许您通过 web.config 文件控制和配置日志记录。

# c# - c# 中的多客户端、异步套接字、最佳实践？

> ID：284885
> 
> 赞同：17
> 
> 时间：2008-11-12T18:37:10.467
> 
> 标签：c#, sockets, client-server

我正在尝试更好地理解 c# 中的 tcp/ip 套接字，因为我想挑战自己，看看我是否可以纯粹出于教育目的创建一个有效的 MMO 基础设施（游戏世界、地图、玩家等），因为我没有打算成为那些“OMGZ iz 会制作出比 WoW 更好的 r0x0r MMORPG ！！！”中的另一个，你知道我在说什么。

无论如何，我想知道是否有人可以阐明如何设计这种系统以及需要什么样的东西，以及我应该注意什么？

我最初的想法是将系统分解为单独的客户端/服务器连接，每个连接（在其自己的端口上）执行特定任务，例如更新玩家/怪物位置，发送和接收聊天消息等。处理数据更容易，因为您并不总是需要在数据上放置标头以了解数据包包含哪些信息。

这是否有意义并且有用还是我只是让事情复杂化了？

非常感谢您的回复。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-11-13T01:04:43.133

如果您正在进行套接字级别的编程，那么无论您为每种消息类型打开多少个端口，您仍然需要具有某种类型的标头。即使它只是消息其余部分的长度。话虽如此，向消息添加简单的标题和尾部结构很容易。我认为只需要在客户端处理一个端口会更容易。

我相信现代 MMORPG（甚至可能是旧的）有两个级别的服务器。验证您是否为付费客户的登录服务器。一旦经过验证，这些会将您转到包含所有游戏世界信息的游戏服务器。即便如此，这仍然只需要客户端打开一个套接字，但不允许拥有更多。

此外，大多数 MMORPGS 还会加密其所有数据。如果你写这篇文章是为了好玩，那么这并不重要。

对于一般的设计/编写协议，这是我担心的事情：

**字节序**

客户端和服务器是否始终保证具有相同的字节序。如果不是，我需要在我的序列化代码中处理它。有多种方法可以处理字节顺序。

1.  忽略它 - 显然是一个糟糕的选择
2.  指定协议的字节顺序。这就是旧协议所做/所做的，因此术语网络顺序总是大端。实际上，您指定哪种字节序并不重要，只需指定一个或另一个即可。如果您不使用大字节序，一些顽固的老网络程序员会站起来，但是如果您的服务器和大多数客户端都是小字节序，那么您除了通过使协议大字节序来增加额外的工作之外，真的不会给自己买任何东西。
3.  在每个标头中标记字节序 - 您可以添加一个 cookie，它会告诉您客户端/服务器的字节序，并根据需要对每条消息进行相应的转换。加班！
4.  使您的协议不可知 - 如果您将所有内容作为 ASCII 字符串发送，那么字节序无关紧要，而且效率也低得多。

在 4 个中，我通常会选择 2 个，并将字节序指定为大多数客户端的字节序，现在将是小字节序。

**向前和向后兼容性**

协议是否需要向前和向后兼容。答案几乎总是肯定的。在这种情况下，这将决定我如何根据版本控制设计整个协议，以及如何创建每个单独的消息来处理实际上不应该成为版本控制一部分的微小更改。您可以在此基础上使用 XML，但会损失很多效率。

对于整体版本控制，我通常设计一些简单的东西。客户端发送一个版本控制消息，指定它使用版本 XY，只要服务器可以支持该版本，它就会发回一条消息，确认客户端的版本，然后一切继续进行。否则，它会接收客户端并终止连接。

对于每条消息，您都有以下内容：

```
+-------------------------+-------------------+-----------------+------------------------+
| Length of Msg (4 bytes) | MsgType (2 bytes) | Flags (4 bytes) | Msg (length - 6 bytes) |
+-------------------------+-------------------+-----------------+------------------------+ 
```

长度显然告诉你消息有多长，不包括长度本身。MsgType 是消息的类型。这只有两个字节，因为 65356 是应用程序的大量消息类型。这些标志可以让您知道消息中序列化的内容。该字段与长度相结合，为您提供了向前和向后的兼容性。

```
const uint32_t FLAG_0  = (1 << 0);
const uint32_t FLAG_1  = (1 << 1);
const uint32_t FLAG_2  = (1 << 2);
...
const uint32_t RESERVED_32 = (1 << 31); 
```

然后您的反序列化代码可以执行以下操作：

```
uint32 length = MessageBuffer.ReadUint32();
uint32 start = MessageBuffer.CurrentOffset();
uint16 msgType = MessageBuffer.ReadUint16();
uint32 flags = MessageBuffer.ReadUint32();

if (flags & FLAG_0)
{
    // Read out whatever FLAG_0 represents.
    // Single or multiple fields
}
// ...
// read out the other flags
// ...

MessageBuffer.AdvanceToOffset(start + length); 
```

这允许您在消息**末尾****添加**新字段，而无需修改整个协议。它还确保旧的服务器和客户端将忽略他们不知道的标志。如果他们必须使用新的标志和字段，那么您只需更改整个协议版本。

 ****是否使用框架**

我会考虑将各种网络框架用于业务应用程序。除非我有特殊需要从头开始，否则我会使用标准框架。在您的情况下，您想学习套接字级编程，所以这是一个已经为您解答的问题。

如果确实使用了框架，请确保它解决了上述两个问题，或者如果您需要在这些领域对其进行自定义，至少不会妨碍您。

**我在和第三方打交道吗**

在许多情况下，您可能正在处理需要与之通信的第三方服务器/客户端。这意味着几个场景：

*   他们已经定义了协议 - 只需使用他们的协议。
*   您已经定义了一个协议（并且他们愿意使用它） - 再次简单地使用定义的协议
*   他们使用标准框架（基于 WSDL 等） - 使用框架。
*   双方都没有定义协议 - 尝试根据手头的所有因素（我在这里提到的所有因素）以及他们的能力水平（至少据你所知）确定最佳解决方案。无论如何，请确保双方同意并理解该协议。根据经验，这可能是痛苦的或愉快的。这取决于你和谁一起工作。

在任何一种情况下，您都不会与第三方合作，因此这实际上只是为了完整性而添加的。

我觉得我可以写更多关于这个的东西，但它已经相当冗长了。我希望这会有所帮助，如果您有任何具体问题，请在 Stackoverflow 上提问。

**回答 knoopx 问题的编辑：**

*   [http://en.wikipedia.org/wiki/Protocol_Buffers](http://en.wikipedia.org/wiki/Protocol_Buffers)
*   [http://en.wikipedia.org/wiki/Thrift_(协议)](http://en.wikipedia.org/wiki/Thrift_%28protocol%29)
*   [http://en.wikipedia.org/wiki/Etch_(protocol)](http://en.wikipedia.org/wiki/Etch_%28protocol%29)
*   [http://en.wikipedia.org/wiki/Adaptive_Communication_Environment](http://en.wikipedia.org/wiki/Adaptive_Communication_Environment)
*   [http://en.wikipedia.org/wiki/CORBA](http://en.wikipedia.org/wiki/CORBA)
*   还有很多

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T20:13:45.013

我认为你需要在走路和跑步之前爬行。首先要正确设计框架和连接，然后再考虑可扩展性。如果您的目标是学习 C# 和 tcp/ip 编程，那么不要让自己变得更难。

继续您的最初想法，并将数据流分开。

玩得开心，祝你好运

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T18:51:41.840

我建议不要针对不同的信息进行多个连接。我会设计一些协议，其中包含要处理的信息的标头。使用尽可能少的资源。此外，您可能不想将各种职位和统计数据的更新从客户端发送到服务器。否则，您最终可能会遇到用户可以修改他们的数据被发送回服务器的情况。

假设用户伪造怪物的位置以绕过某些东西。我只会更新用户的位置向量和动作。让服务器处理和验证其余信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T18:56:18.117

是的，我认为您对单个连接是正确的，当然客户端不会向服务器发送任何实际数据，更像是简单的命令，如“前进”、“左转”等，服务器会移动地图上的角色并将新坐标发送回客户端。

# .net - 大型应用程序的数据访问策略是什么

> ID：284889
> 
> 赞同：1
> 
> 时间：2008-11-12T18:37:55.097
> 
> 标签：.net, stored-procedures, vb6, legacy, data-access-layer

我即将着手重写 .NET 3.5sp1 中的 VB6 应用程序。VB6 应用程序编写得非常好，数据层完全基于存储过程。我想使用像 Linq2SQL/Entity Framework/NHibernate/SubSonic 这样的自动化工具。诚然，除了一次性项目，我没有在任何其他项目中使用过这些工具。

我担心所有这些选择可能遇到的潜在问题是速度。例如，现在要检索单行（或整个列表），我使用以下存储过程：

```
ALTER PROCEDURE [dbo].[lst_Customers]
 @intID     INT = NULL
,@chvName   VARCHAR(100) = NULL
AS

SELECT   Customer_id, Name
FROM dbo.Customer
WHERE (@intID IS NULL OR @intID = Customer_id)
 AND (@chvName IS NULL OR Name like ('%' + @chvName + '%'))
ORDER BY name 
```

要在 Linq2SQL/Entity Framework/NHibernate/SubSonic 中检索单行，这些解决方案是否必须将整个列表带到客户端并找到我需要的行？

那么，对于大数据域的应用，数据访问策略的共识是什么呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-12T20:06:42.343

我将扮演魔鬼的拥护者，并建议您至少考虑坚持使用存储过程。这些代表您不必重新编写和调试的代码块。 [这篇](http://www.joelonsoftware.com/printerFriendly/articles/fog0000000069.html)来自我们的 Very Own [tm] Joel Spolsky 的文章给出了避免完全重写的连贯论证。

给定一个“绿地”项目，您可以使用您想要的东西，而 O/R 映射器可能是一个不错的选择。但是，您已经说过 VB6 应用程序编写得很好。如果存储过程写得很好，那么您可以免费获得一些应用程序并且它已经调试过了，而且您可以回收数据库模式并避免数据迁移带来的大部分痛苦。

Fowler 的[企业应用程序体系结构模式](https://rads.stackoverflow.com/amzn/click/com/0321127420)应该为您提供一些很好的指导，帮助您设计一个数据访问层，该层可以很好地与存储过程配合使用，而不会引起维护问题。

这在 Oracle/Java 应用程序上很常见。许多旧版 Oracle 应用程序在 PL/SQL 中拥有大量存储过程代码——这是 Oracle Forms 客户端-服务器时代的标准架构。在 Java 中为存储过程编写包装器并在包装器之上构建用户界面是常见的做法。

其他海报之一提到 Subsonic 可以为存储过程生成包装器。

曾几何时，我有机会做一个数据字典破解，它为 PL/SQL 存储过程生成了一个概念验证 Java/JDBC 包装器——IIRC 只花了一天左右的时间。鉴于这并不难做到，我会惊讶地发现，在你可以从现成的东西上做这件事的时候，没有多少选择。在紧要关头，自己编写也不是那么难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T19:24:37.797

我不会谈论 Linq-to-SQL、实体框架或 NHibernate，但我爱上了 SubSonic。我的经验是非常积极的。

通常，这些工具的工作方式是，它们在托管代码中为您构建参数化查询，将该访问封装在类中，然后将这些类公开给您的应用程序。完全生成的 DAL 摇滚。

通过使用参数化查询，您对他们可能“必须将整个列表带到客户端并找到我需要的行”的担忧得到了处理。它们支持`where`子句和其他过滤以获取您需要的行。您可以执行 的等效操作`select * from foo`，但您不会陷入该模式。

也就是说，SubSonic 确实——当直接用于直接表/视图访问时——会降低整行，这在某些情况下*可能*是不利的。但是，您通过存储过程的访问不是问题——我无法与其他人交谈，但 SubSonic 有助于创建一个`SPs`封装所有过程的类，允许您将它们作为方法调用，并返回适当`DataTable`的 s，您可以然后根据需要手动解析。还有一些方法可以从 procs 初始化 DAL 类列表，因此如果 proc 返回一个直接匹配表/视图的数据集，您仍然可以拥有更清晰的语法，而无需手动处理。

（顺便说一下，SubSonic 治愈了我的“所有事情的 procs”。我现在通常几乎没有像过去那样花时间做 CRUD procs，只是最终将它们用于复杂的报告。但是你的里程可能，实际上会有所不同。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T19:35:17.633

我建议使用 SubSonic 生成所有代码来访问您现有的存储过程，这样可以减少由于新的数据访问层而导致回归的机会。然后可以通过使用 SubSonic 生成的 ActiveRecord 类访问任何新功能。在我看来，这似乎是最安全和最快的方法，

我不同意 NHibernate 的建议，因为它不太适合使用存储过程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T20:25:47.907

我们尝试将实体框架用作 orm，但在尝试将其与域驱动开发一起使用时遇到了多个问题。Linq to Sql 也有一些限制，我相信微软将在下一个版本中停止支持它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T20:55:50.733

如果查询在存储过程中，那么它们很有可能已经得到了很好的优化。并且可能他们对 JOINS、子查询等自由使用 SQL 表达式。

*使用 ORM 类型的抽象层准确地*复制这种效率和表现力将是一个挑战 - 特别是如果您不完全熟悉这些工具。

在直接了解应用程序的其余部分后，您始终可以重构查询。ORM 世界的变化太快了，当你到达那里时，选择肯定会有所不同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T19:31:00.577

甚至根据作者之一 Rob Connery 的说法，SubSonic 的编写更多是为了支持快速应用程序开发，而不是关于大型应用程序。我会说选择 NHibernate，因为您会从社区中找到最多的支持以及久经考验的真正测试框架。您可以从 www.dimecasts.net 获得有关设置 NHibernate 东西的良好信息。

# iis-7 - 为什么要从 IIS6 迁移到 IIS7？

> ID：284895
> 
> 赞同：3
> 
> 时间：2008-11-12T18:38:54.347
> 
> 标签：iis-7, iis-6, windows-server-2008, windows-server-2003

我在几个 IIS6/Server 2003 机器上运行了许多 Web 应用程序。他们跑得很好，很开心。它们都是 asp.net Web 应用程序并使用 .NET 3.5。

如果有的话，考虑将 Web 应用程序迁移到 IIS7/Server 2008 的正当理由是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-29T15:46:31.733

IIS7 以“可插拔”的概念从头开始重写。IIS7 比以往任何时候都更具可扩展性。整个请求管道已经过重新设计，让您也可以更轻松地处理请求。

从性能方面来看，这些变化是可以立即识别的。您可以在“经典”应用程序池中运行为 IIS6 开发的站点，这将保持兼容性，但提供显着的性能提升。在我们迄今为止所做的非科学评估中，我们的旧应用程序在 IIS7 测试机器上的加载时间减少了大约 20%。

当然，我们必须以“经典”模式运行的原因是一个有趣的旁注。在 global.asax 中，有一些在应用程序启动时会触及 HttpContext 的预取。具体来说，已经完成了预缓存，这是 IIS7 不允许的。因此，在我们从“经典”模式切换之前，我们必须做出一些改变。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T19:17:22.473

1.  最终，Microsoft 将停止对 Server 2003 的支持。诚然，这不会持续几年，所以它不会影响你今天。
2.  改进了对 ASP.NET MVC 的支持。对于我们大多数人来说，这可能是最重要的。您可以让 ASP.NET MVC 在 IIS6 上运行，但是[需要跳过](http://forums.asp.net/t/1192188.aspx).

我会给你更多，但我自己还没有在 Server 2008 上，也没有什么可以给的。大概 Vista（我在工作和在家中都使用）具有与 2008 年“相同”的 IIS7——UI 看起来非常相似——但我认为我在那里的经验对你的问题没有用处。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T19:25:42.567

能够以托管语言编写管道组件。以前，如果您想编写一个 ISAPI 过滤器来处理某种类型的 Web 请求，则必须用 C++ 编写它。现在，您可以使用良好的 .NET 代码。这允许通过编写可重用的管道组件来处理各种类型的请求进行更多的定制。例如，所有 .js 文件请求都被路由到 ScriptCompressor 管道组件，该组件会压缩并返回它们，并设置了大量的可缓存性。

对 MVC 的改进支持与此相关，因为您可以将 II7 设置为路由请求而不扩展 .NET，这样您就可以拥有“更干净”的 url，例如[http://www.yourwebsite.com/customer/1](http://www.yourwebsite.com/customer/1)而没有任何扩展可见，它揭示了您正在使用的服务器技术类型，并且这些天非常不流行。

# c# - 嵌套构造函数（或工厂方法）是否好，或者每个都应该做所有的初始化工作

> ID：284896
> 
> 赞同：28
> 
> 时间：2008-11-12T18:38:57.840
> 
> 标签：c#

为重载的 New 或 Factory 样式方法嵌套构造函数调用是一个好主意（来自设计 POV）吗？这主要用于简单的构造函数，其中每个重载都建立在前一个之上。

```
MyClass( arg1 ) { 
    _arg1 = arg1; 
    _otherField = true; 
    _color="Blue" 
}
MyClass( arg1, arg2) : this(arg1) { 
    _arg2 = arg2  
}
MyClass( arg1, arg2, arg3) : this(arg1, ar2) { 
    _arg3 = arg3; 
} 
```

或者使用工厂方法：

```
static NewInstance(arg1 ) { 
   _arg1 = arg1;       
}
static NewInstance(arg1, arg2) {
   f = NewInstance(arg1);
   f._arg2 = arg2;
}
//... and so on 
```

我可以看到双方的一些缺点

*   嵌套隐藏了构造函数在做什么
*   不嵌套会重复所有功能

所以，这样做是个好主意，还是让我为我不认为是问题的事情做好了准备。出于某种原因，我感到不安，主要是因为它划分了初始化的责任。

编辑： **@Jon Skeet**：我现在明白为什么这让我如此困扰了。我是倒着做的！我写了整件事，甚至没有注意到，它只是闻起来。我有（我写的）大多数其他情况，按照您推荐的方式进行，但这肯定不是我这样做的唯一一个。我确实注意到更复杂的我做得很好，但简单的我似乎马虎了。 *我喜欢微编辑。我也喜欢缩写！*

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-11-12T18:41:27.103

我认为将构造函数链接在一起是合理的，但我这样做是另一种方式 - 具有较少参数的版本调用具有更多参数的版本。这样它就可以非常清楚地知道发生了什么，并且所有真正的“逻辑”（超出默认值）都在一个地方。例如：

```
public Foo(int x, int y)
{
    this.x = x;
    this.y = y;
    precomputedValue = x * y;
}

private static int DefaultY
{
    get { return DateTime.Now.Minute; }
}

public Foo(int x) : this(x, DefaultY)
{
}

public Foo() : this(1, DefaultY)
{
} 
```

请注意，如果您有很多构造函数重载，您可能希望改用静态工厂方法 - 这通常会使代码更清晰，并允许多个方法采用相同的参数集，例如

```
public static XmlDocument FromText(string xml)

public static XmlDocument FromFile(string filename) 
```

* * *

## 回答 #2

> 赞同：-7
> 
> 时间：2008-11-12T19:56:16.750

**2016 年编辑**：仍然领先于时间，C# 正在从根本上削减或消除其对 C# 7 的记录支持和默认构造函数支持，也许*最终*是 C#8 。

**2015 年编辑**：我远远领先于时代。C#6 和 C#7 不再需要构造函数。

如果您在 .Net 3.5 中开发，我建议不要使用构造函数。我留下的唯一例外是如果您使用注入构造函数进行依赖注入。使用 .Net 3.5，他们创建了对象初始化程序，允许您执行

```
var myclass = New MyClass { arg1 = "lala", arg2 ="foo" } 
```

这将使用为 arg1 和 arg2 分配的值初始化类，同时将 arg3 保留为

```
default(typeof(arg3)). 
```

# java - 如何在 Java 中将 ActionListener 添加到 JButton 上

> ID：284899
> 
> 赞同：36
> 
> 时间：2008-11-12T18:40:05.420
> 
> 标签：java, swing, user-interface, jbutton, actionlistener

```
private JButton jBtnDrawCircle = new JButton("Circle");
private JButton jBtnDrawSquare = new JButton("Square");
private JButton jBtnDrawTriangle = new JButton("Triangle");
private JButton jBtnSelection = new JButton("Selection"); 
```

如何向这些按钮添加动作侦听器，以便从主方法中调用`actionperformed`它们，以便在单击它们时可以在程序中调用它们？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2008-11-12T18:49:17.040

两种方式：

**1.**在你的类中实现ActionListener，然后使用`jBtnSelection.addActionListener(this);` ，你必须定义一个menthod `public void actionPerformed(ActionEvent e)`，. 但是，对多个按钮执行此操作可能会造成混淆，因为该`actionPerformed`方法必须检查每个事件的来源 ( `e.getSource()`) 以查看它来自哪个按钮。

**2.**使用匿名内部类：

```
jBtnSelection.addActionListener(new ActionListener() { 
  public void actionPerformed(ActionEvent e) { 
    selectionButtonPressed();
  } 
} );
```

稍后，您必须定义`selectionButtonPressed()`. 当您有多个按钮时，这会更好，因为您对处理操作的各个方法的调用就在按钮的定义旁边。

**2、更新。**由于 Java 8 引入了 lambda 表达式，您可以说与 #2 基本相同的内容，但使用更少的字符：

```
jBtnSelection.addActionListener(e -> selectionButtonPressed()); 
```

在这种情况下，`e`是 ActionEvent。这是可行的，因为 ActionListener 接口只有一个方法，`actionPerformed(ActionEvent e)`.

第二种方法还允许您`selectionButtonPressed`直接调用该方法。在这种情况下，如果发生其他一些操作，您也可以调用`selectionButtonPressed()`- 例如，当计时器关闭或其他情况时（但在这种情况下，您的方法可能会被命名为不同的名称`selectionChanged()`）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-12T18:46:08.137

最好的办法是查看[Java Swing 教程](http://java.sun.com/docs/books/tutorial/ui/index.html)，特别是[关于 Buttons 的教程](http://java.sun.com/docs/books/tutorial/uiswing/components/button.html)。

简短的代码片段是：

```
jBtnDrawCircle.addActionListener( /*class that implements ActionListener*/ ); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-11-11T10:34:59.380

我不知道这是否有效，但我做了变量名

```
public abstract class beep implements ActionListener {
    public static void main(String[] args) {
        JFrame f = new JFrame("beeper");
        JButton button = new JButton("Beep me");
        f.setVisible(true);
        f.setSize(300, 200);
        f.add(button);
        button.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                // Insert code here
            }
        });
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T18:48:27.820

我没有完全遵循，但要添加一个动作监听器，你只需调用[addActionListener](http://java.sun.com/j2se/1.4.2/docs/api/javax/swing/AbstractButton.html#addActionListener(java.awt.event.ActionListener))（来自抽象按钮）。如果这不能完全回答您的问题，您能否提供更多详细信息？

# visual-studio-2008 - 什么是 *.vshost.exe.config 文件？

> ID：284904
> 
> 赞同：49
> 
> 时间：2008-11-12T18:41:21.533
> 
> 标签：visual-studio-2008, config

当我使用 VS2008 编译应用程序时，有时会得到 2 个相同的配置文件：

*   *.exe.config
*   *.vshost.exe.config

后一个是干什么用的？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-11-12T19:18:06.450

这是一篇关于 vshost 进程及其目的的博客文章。

[http://blogs.msdn.com/dtemp/archive/2004/08/17/215764.aspx](http://blogs.msdn.com/dtemp/archive/2004/08/17/215764.aspx)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-12T18:45:45.737

在 VS 中调试时，您的应用程序将被称为 [appname].vshost.exe，因此 .vshost.exe.config 文件是 .net 运行时查找程序配置的位置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-31T06:56:56.497

我注意到有关此行为的其他内容。

虽然 VS 将创建一个名为 [appname].vshost.exe.config 的配置，但 API 调用：

```
var s = AppDomain.CurrentDomain.SetupInformation.ConfigurationFile 
```

不返回此名称，而是返回：[appname].config

这是使用VS2010。在 VS2008 中未检查

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-10-25T14:22:37.910

此文件的唯一目的是帮助调试和托管 Process。Visual Studio 托管进程提高了调试器的性能。它支持新的调试器功能，例如部分信任调试和设计时表达式评估。

如果禁用托管进程，即使在项目属性的安全页面上启用了部分信任安全，部分信任调试也将不起作用。

您可以通过项目菜单禁用它 -> 单击属性 -> 调试选项卡 -> 清除启用 Visual Studio 托管进程复选框。设计时表达式总是使用宿主进程。在项目属性中禁用宿主进程会禁用类库项目的设计时表达式评估。

对于其他项目类型，不会禁用设计时表达式评估。相反，Visual Studio 会启动实际的可执行文件并将其用于设计时评估，而无需托管进程。

# user-interface - 开发人员易于理解的 UI 提示

> ID：284906
> 
> 赞同：20
> 
> 时间：2008-11-12T18:41:33.280
> 
> 标签：user-interface, usability

每个开发人员都应该知道哪些关键的 UI 设计技巧？

虽然有许多面向开发人员的 UI 资源（例如，Joel Spolsky 的[程序员用户界面设计](https://rads.stackoverflow.com/amzn/click/com/1893115941)），但我更感兴趣的是可以在 1 到 2 页中传达的项目符号列表。

我对更具战术**性的日常 UI 技巧**感兴趣，而不是 UI 设计会议（可能至少有一个具有良好 UI 意识的人参加）中涵盖的总体 UI 设计目标。这些技巧的集合可能涵盖了日常程序员会遇到的大约 80% 的情况。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-11-12T18:49:06.290

*   使用标准菜单栏（出于某种原因，业余 GUI 设计师似乎喜欢在这里绘制自己的路线）。确保第一项是文件、编辑和查看，最后一项是帮助
*   不用担心颜色主题或皮肤；坚持与您的平台一致的标准外观
*   使用默认系统字体
*   使用与您的平台一致的菜单加速器
*   坚持久经考验的真实布局，顶部有一个菜单栏，底部有一个状态栏，如果需要，左侧有一个导航窗格
*   永远不要进行系统范围的抓取
*   如果您有选择，请调整所有窗口的大小。
*   使用单选按钮组来“选择一个”。始终确保默认选择其中之一。如果您希望用户不能选择任何选项，请为“无选择”添加另一个单选按钮
*   使用多组复选按钮来“选择零个或多个”
*   如有必要，限制输入（即：简单地忽略数字输入字段中的非数字），而不是等待用户输入数据，提交，然后弹出一个对话框说“嘿，不允许使用字母！”。如果他们不被允许，首先不要接受他们。
*   对你接受的输入要自由。看在上帝的份上，如果 SSN 字段遗漏了连字符，或者当您不想要它们时，请不要输入它们。电脑很聪明，让它弄清楚 xxxxxxxxx 和 xxx xx xxxx 和 xxx-xx-xxxx 都是有效的社会安全号码。
*   总是在长字段中允许空格，例如序列号和诸如此类的东西。如果允许用户以三个或四个为一组对数字进行分组，则数据质量会大大提高。如果您的数据模型无法处理空格，您可以在保存数据之前将其删除。
*   避免像瘟疫一样弹出对话框。除非绝对必须，否则切勿展示。如果您决定必须这样做，请停止并重新考虑您的设计，然后再继续。有时它们是必要的，但这些时间比您想象的要少得多。
*   注意键盘遍历。大多数工具包都试图让它正确，但总是仔细检查。用户应该能够使用 tab 键以逻辑方式遍历小部件。

当然，所有这些规则都可以被打破。但只有当你出于正当理由破坏它时才破坏它。

请记住，软件是用来帮助用户的，它应该做*他们*想做的事，而不是让他们做他们想做的*事*。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-12T18:48:01.677

当您要执行将更改或删除信息的操作时，不要问“您确定吗”——用户将学会单击按钮作为操作的一部分。尝试在系统设计中允许“撤消”。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-12T19:00:18.017

选择大多数用户会满意的默认选择。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-12T18:50:12.670

**始终为您的用户提供无需**使用后退按钮的“出路” 。

最好的例子：

如果发生错误，请给他们一个链接返回到他们所在的位置（或至少到他们可以重新开始的位置）。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-12T19:11:52.470

尽可能使用工具提示。令人惊讶的是，这些小家伙可以为最终用户添加大量帮助，而且他们对应用程序本身并不显眼。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-12T19:13:06.913

在设计 UI 时，让它尽可能简单，但不要更简单。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-12T18:42:45.307

1.  询问用户，不要胡编乱造
2.  简化 - 删除一个步骤，消除点击等。
3.  熟悉[可用性原则](http://useit.com)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-11-12T18:57:26.057

我认为这个链接将是一个很好的起点，来自微软的“Windows Vista 用户体验指南：http:
[//msdn.microsoft.com/en-us/library/aa511328.aspx](http://msdn.microsoft.com/en-us/library/aa511328.aspx)

这可能非常接近您正在寻找的两页项目符号列表：“Top Violations”：http:
[//msdn.microsoft.com/en-us/library/aa511331.aspx](http://msdn.microsoft.com/en-us/library/aa511331.aspx)

非常实际的提示，例如：“如果窗口大小低于该大小，内容不再可用，请设置最小窗口大小。”

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-11-12T19:02:49.757

正确的制表位是必须的。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-11-12T19:08:52.040

不要以基本的清晰度和可用性为代价来增加“可发现性”。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-11-12T19:25:17.933

找到用户最常做的事情，然后让它成为最容易做的事情。

例如：我对微波设计有一个长期的个人抱怨。

许多人要求您在使用微波炉之前设置一个您从未使用过的时钟，并且每次断电时它都会忘记，并且*需要*在那些难以使用的按钮板上按 10 次按键才能这样做。

一个简单的可用性测试将意识到微波炉上最常见的烹饪时间是标准的“分钟”及其倍数。因此，理想的微波炉应该能够以 3 次或更少的动作以高功率烹饪产品 1 分钟。

对于一分钟以外的时间，但在黄金“1”分钟的 5 分钟内，应该有稍微更多的步骤，但不会显着增加，并且只有烹饪时间 > 5 分钟需要大量的操作。（这是相当罕见的）

* * *

## 2 个出色的微波设计示例

### 1\. 4个部分。门、温度刻度盘、时间刻度盘、时间照明顺序

温度刻度盘是模拟的，并且与以前的设置保持一致，具有不同的滑动范围。

时间表盘是数字的，但模拟模拟，顺时针转动表盘会增加时钟时间（由表盘下方的照明顺序显示）。逆时针转动表盘可减少时钟时间。烹饪会减少时钟时间。

门被关上，计时开始做饭。开门暂停烹饪。

**标准操作：**开门、加载、转动时间刻度盘、关门（或可选，先关门，时钟开启>1s 后立即开始烹饪）

### 2\. 6个零件，门，拨号，电源按钮，启动按钮，清除按钮，数字时间显示

没有选择时间的开始按钮以大功率开始烹饪 1 分钟。

烹饪时的开始按钮会增加 1 分钟的时间。

时间拨号在会话之间持续存在。转动刻度盘会将刻度盘位置上存储的时间复制到数字计时器中。

在开始烹饪之前按“电源”会

1.  在未转动表盘的情况下，将存储在表盘位置的当前时间复制到数字计时器中。
2.  如果拨盘已转动，则将功率级别的选择减 1，或者如果处于最低功率级别，则返回最高功率。

烹饪时按下电源会降低运行中的功率水平。

**标准操作：** 1 分钟高 = 按下开始。

1 分钟中高 = 按下开始，按下电源。

2 分钟高 = 按两次开始。

<anytime> 高 = 转动拨号直到满意，按开始。

<anytime> on <anypower> 转动拨号直到满意，按电源直到满意，按开始。

<previous selected time> on high = 按电源，按开始

<previous selected time + 1 minute> on high = 按电源，按两次启动。

正如您在此处看到的，添加少量额外的按钮，可以极大程度地增加表现力和功能性设计。

任何带有用于时间规范的数字小键盘的设计，都往往不符合我对良好设计的标准。

它指出，对于某些人来说，这些设计可能具有更高的学习曲线，但一旦学会，肌肉记忆就会使其成为本能。与更（明显？）但过于复杂的设计相反，即使是有学识的用户也将不得不反复花费大量时间执行乏味的任意操作，只是为了实现共同目标。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-11-12T19:38:49.157

做一些[走廊可用性测试](http://en.wikipedia.org/wiki/Usability_testing#Hallway_testing)（就像你做代码审查一样）。

即使是对你旁边的人进行非常快速的“嘿！试试这个”可用性测试（如果你可以这么说的话）也会产生很大的不同。最重要的是让自己以外的其他人尝试您刚刚构建的 UI。

令人惊讶的是，有多少次其他人在使用您的新 UI 时遇到问题，并且（通常）只需要几分钟就可以找到最大的问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-12T19:18:48.243

如果您确实使用来自编辑器的弹出窗口，请确保将插入点或状态返回到弹出窗口之前的状态。太多的程序只会让你“悬而未决”，不得不找到回去的路。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-12T19:28:30.020

而不是任意的“确定”和“取消”按钮，在给定的上下文中，这些按钮可能是模棱两可的，并且用户会盲目地点击一个按钮，这些按钮应该包含对他们所做的事情的简要描述。

```
[Ok, Please Cancel my subscription ], [ Please do not cancel my subscription ] 
```

远胜于

```
Cancel my subscription?
[ OK  ] [ Cancel ] 
```

（这类故障经常出现在dailywtf上）

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-11-12T20:29:10.863

1.  减少点击次数
2.  统一的外观（文字大小，按钮..和其他控件）
3.  最小化免费编辑...（例如：在地址条目中...在下拉列表中提供状态...等）
4.  在国家列表的下拉列表中...首先列出居住国家...（你们中有多少人对美国被列在底部感到沮丧，您必须向下滚动？）
5.  可以根据用户的选择订购通用下拉菜单
6.  没有拼写msitake ;) 根本
7.  注意标记文本：对于电子邮件地址（将标题作为电子邮件......相信我......我已经看到它作为电子邮件地址：）
8.  金额的货币符号。统一数字显示金额.. ex: $12.15 ==> $12.15 $10.9 ==> $10.90 9.进度/状态栏
9.  在用户单击确定/保存按钮之前指示错误字段的好友标签（例如：对于电子邮件地址，如果没有“@”，则无需等到用户单击确定然后告诉他们无效的电子邮件地址）
10.  避免重复输入...（例如：登录屏幕中的记住我选项）
11.  全局应用程序选项，让用户从上一个实例中离开的地方继续）
12.  在网格上显示数据时... excel 样式过滤器选项
13.  输入的默认值。

伙计们......请随意以正当理由冲掉上述任何一点！

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-12T20:38:48.613

## 祖母测试。

这是我对概念性问题的用语，“除了电子邮件和检查 www.cutecats.com 之外从未使用过计算机的你的祖母可以使用它吗？（假设她具有使用该特定应用程序的实际知识）”。

所有常见的东西都应该是显而易见的；没有什么应该是带有副作用的黑盒魔法。不常见的东西应该以用户以前使用过的通用格式访问。

清晰的标签，清晰的帮助文件路径，清晰的动作，清晰的效果。

如果奶奶不能使用你的画图程序，你需要真正考虑你的用户界面。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-11-24T14:54:42.697

我的 UI 设计的基本规则是让每个“页面”完成一项任务，并且只执行一项任务。它使页面保持简单，使设计保持简洁并使应用程序更易于理解。

这种类型的设计称为感应式用户界面。这是微软在 2001 年发布的关于该主题的[文档。](http://msdn.microsoft.com/en-us/library/ms997506.aspx "文档")文字可能有点过时，但原则通常都很好。唯一需要注意的是，在这样的设计中需要找到平衡。如果你过度简化了太多，用户将不得不到处导航以完成简单的任务，而在可理解性方面的收益将因工作效率低下而丧失。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-01-12T20:20:41.117

日常[用户界面网页设计](http://www.freshtilledsoil.com/services/user-interface-prototyping/)和应用程序设计的一些简单技巧：

*   使用简单的静态草图开始初步的 Web 应用程序开发计划。- 不要让用户有太多的选择。取而代之的是，使用迎合设计来引导用户走上他们将从中受益的道路。- 定义关键用户组和他们的旅程 - 将迭代设计作为 UI 的一部分，以确保投资回报率

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-05-04T17:25:34.427

我喜欢遵循这些指导方针：

1.  标准 - 遵循已知标准/模式，重用您尊重的所有产品的想法
2.  简单 - 让您的解决方案保持简单且易于更改（如果需要）
3.  优雅——用更少的东西完成更多的事情

# mysql - 开始学习 Actionscript 3.0 的教程？

> ID：284919
> 
> 赞同：3
> 
> 时间：2008-11-12T18:44:45.490
> 
> 标签：mysql, xml, actionscript-3

我已经了解 Java、Objective C、C# 和一些 Python。我希望能够与 XML 或 MySQL 数据库集成以获取动态内容。

有哪些教程或在线参考资料可以帮助我启动并运行 Actionscript 3.0？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T20:15:01.453

我刚刚学习了 AS3，我发现的最好的东西是 Essential Actionscript 3.0 书（Colin Moock，O'Reilly）。我知道你在网上要了一些东西，但这本书远远领先于我在网上找到的任何东西，我应该先买它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T19:39:41.773

[actionscript.org](http://www.actionscript.org/resources/categories/Tutorials/)上有一些很好的教程

# wpf - WPF 应用程序是否可以进行依赖注入？

> ID：284921
> 
> 赞同：37
> 
> 时间：2008-11-12T18:44:56.643
> 
> 标签：wpf, design-patterns, dependency-injection, inversion-of-control, autofac

我想开始在我的 WPF 应用程序中使用依赖注入，主要是为了更好的单元可测试性。我的应用程序主要是按照 MV-VM 模式构建的。我正在为我的 IoC 容器寻找[Autofac](https://code.google.com/p/autofac/)，但我认为这对这个讨论没有太大影响。

将服务注入启动窗口似乎很简单，因为我可以在 App.xaml.cs 中创建容器并从中解析。

我正在苦苦挣扎的是如何将 DI ViewModels 和服务转换为用户控件？用户控件是通过 XAML 标记实例化的，因此它们没有机会`Resolve()`。

我能想到的最好的办法是将容器放在单例中，并让用户控件从全局容器中解析他们的 ViewModel。充其量，这感觉像是一个半途而废的解决方案，因为它仍然需要我的组件依赖于 ServiceLocator。

使用 WPF 可以实现完整的 IoC 吗？

[编辑] - 有人建议使用 Prism，但即使评估 Prism 似乎也是一项巨大的投资。我希望有更小的东西。

[编辑] 这是我停止的代码片段

```
//setup IoC container (in app.xaml.cs)
var builder = new ContainerBuilder();
builder.Register<NewsSource>().As<INewsSource>();
builder.Register<AViewModel>().FactoryScoped();
var container = builder.Build();

// in user control ctor -
// this doesn't work, where do I get the container from
VM = container.Resolve<AViewModel>();

// in app.xaml.cs
// this compiles, but I can't use this uc, 
//as the one I want in created via xaml in the primary window
SomeUserControl uc = new SomeUserControl();
uc.VM = container.Resolve<AViewModel>(); 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-15T07:46:06.637

这实际上很容易做到。正如 jedidja 所提到的，我们在 Prism 中有这样的例子。您可以让 ViewModel 与 View 一起注入，也可以让 View 与 ViewModel 一起注入。在 Prism StockTraderRI 中，您将看到我们将 View 注入 ViewModel。本质上，发生的事情是 View（和 View 接口）具有 Model 属性。该属性在代码隐藏中实现，以将 DataContext 设置为该值，例如：`this.DataContext = value;`. 在 ViewModel 的构造函数中，视图被注入。然后它设置`View.Model = this;`哪个将自己作为 DataContext 传递。

您也可以轻松地执行相反的操作，并将 ViewModel 注入到 View 中。我实际上更喜欢这个，因为这意味着 ViewModel 不再有任何对视图的反向引用。这意味着在对 ViewModel 进行单元测试时，您甚至没有 Mock 的视图。此外，它使代码更清晰，因为在 View 的构造函数中，它只是将 DataContext 设置为注入的 ViewModel。

我在 Jeremy Miller 和我在 Kaizenconf 上发表的分离演示模式演讲的视频录制中更多地谈到了这一点。第一部分可以在这里找到[https://vimeo.com/2189854](https://vimeo.com/2189854)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-22T17:43:30.830

我想你已经解决了这个问题。控件需要注入到其父级中，而不是通过 XAML 以声明方式创建。

为了使 DI 工作，DI 容器应该创建接受依赖项的类。这意味着父级在设计时不会有子控件的任何实例，并且在设计器中看起来像一个外壳。这*可能*是推荐的方法。

另一个“替代方案”是从控件的构造函数或类似的东西中调用一个全局静态容器。有一种常见的模式，其中声明了两个构造函数，一个带有用于构造函数注入的参数列表，另一个没有委托的参数：

```
// For WPF
public Foo() : this(Global.Container.Resolve&lt;IBar&gt;()) {}

// For the rest of the world
public Foo(IBar bar) { .. } 
```

我几乎将其称为反模式，但事实上某些框架别无选择。

我什至不是 WPF 专家的一半，所以我期待这里有一个健康的 downmod 服务:) 但希望这会有所帮助。Autofac 组（从主页链接）可能是另一个提出这个问题的地方。Prism 或 MEF 示例应用程序（其中包括一些 WPF 示例）应该让您了解什么是可能的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-13T01:28:29.637

我们遇到了类似的问题。我们期待在 Expression Blend 2.0（强类型）下提供设计时支持的解决方案。此外，我们期待在 Expression Blend 下提供一些 Mock+Auto-Generated 数据样本的解决方案。

当然，我们也希望使用 IOC 模式让所有这些工作正常工作。

Paul Stovell 作为一篇有趣的文章开始： http: [//www.paulstovell.com/blog/wpf-dependency-injection-in-xaml](http://www.paulstovell.com/blog/wpf-dependency-injection-in-xaml)

所以我尝试了一些事情来在设计时为绑定和模拟对象添加更有价值的设计时支持，现在我的大部分问题都与在视图（代码）和 ModelView 之间建立强类型连接有关（ Xaml），我尝试了几个场景：

解决方案 1：使用 Generic 创建视图

```
public class MyDotNetcomponent<T> : SomeDotNetcomponent 
{
    // Inversion of Control Loader…
    // Next step add the Inversion of control manager plus
    // some MockObject feature to work under design time
    public T View {Get;}
} 
```

这个解决方案不起作用，因为 Blend 不支持 Generic inside is design surface，但 Xaml 确实有一些，在运行时工作得很好，但在设计时没有；

解决方案 2：ObjectDataProvider

```
<ObjectDataProvider ObjectType="{x:Type CP:IFooView}" />
<!-- Work in Blend -->
<!—- IOC Issue: we need to use a concrete type and/or static Method there no way to achive a load on demande feature in a easy way --> 
```

解决方案 3：继承 ObjectDataProvider

```
<CWD:ServiceObjectDataProvider ObjectType="{x:Type CP:IFooView}" />
<!-- Cannot inherit from ObjectDataProvider to achive the right behavior everything is private--> 
```

解决方案 4：从头开始创建一个模拟 ObjectDataProvider 到作业

```
<CWD:ServiceObjectDataProvider ObjectType="{x:Type CP:IFooView }" />
<!-- Not working in Blend, quite obvious--> 
```

解决方案 5：创建标记扩展 (Paul Stovell)

```
<CWM:ServiceMarkup MetaView="{x:Type CP:IFooView}"/>
<!-- Not working in Blend --> 
```

只是为了清除一点。当我说“不在 blend 中工作”时，我的意思是 Binding 对话框不可用，设计人员需要自己手写 XAML。

我们的下一步可能是花时间评估为 Expression Blend 创建插件的能力。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-03T12:06:06.513

你应该看看[Caliburn——](http://www.codeplex.com/caliburn)它是一个简单的 WPF/Silverlight MVC 框架，支持完整的 DI。它看起来很酷，它可以让你使用任何你想要的 IoC 容器。[文档 wiki](http://www.codeplex.com/caliburn/Wiki/View.aspx?title=Table%20Of%20Contents&referringTitle=Home)上有几个示例

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-12T19:03:44.937

是的，我们一直这样做。您可以“注入”您的 ViewModel 到控件的 DataContext 中。

实际上，我发现 WPF 更容易与 DI 一起使用。甚至依赖对象和属性也可以无缝地使用它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-10-29T16:37:29.113

Glen Block（见上文）提到一种常见的方法是设计您的**MVVM**解决方案以使用**DataContext**作为您可以在视图中“解析”您的视图模型的地方。然后，您可以使用表达式混合 2008 中的设计扩展（请注意，您不需要使用表达式混合设计工具来利用这一点）。例如：

```
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
mc:Ignorable="d" 
d:DataContext="{d:DesignInstance Type=local:MyViewModelMock, IsDesignTimeCreatable=True}" 
```

在您看来，您可以拥有一个属性获取器，将您的**DataContext**转换为您期望的类型（只是为了更容易在代码隐藏中使用）。

```
private IMyViewModel ViewModel { get { return (IMyViewModel) DataContext; } } 
```

不要忘记使用**接口**，以便您的视图更易于测试，或帮助您注入不同的运行时实现。

通常，您不应该在解决方案中到处从容器中解决问题。在每个构造函数中传递容器或使其全局可访问实际上被认为是不好的做法。（您应该查看有关“服务定位器”策略为何构成“反模式”的讨论）。

创建具有容器（例如 Prism Unity 或 MEF）可以解析的显式依赖关系的公共视图构造函数。

如有必要，您还可以创建一个**内部**默认构造函数来创建您的视图模型的模拟（或就此而言的真实模型）。这可以防止在外部（在您的“Shell”或任何地方）无意中使用此“**设计构造函数”。****您的测试项目也可以使用“ AssemblyInfo ”中的“** **InternalsVisibleToAttribute** ”来使用此类构造函数。但是当然，这通常不是必需的，因为无论如何您都可以使用完整的依赖构造函数来注入模拟，并且因为您的大多数测试首先应该关注**ViewModel**。**理想情况下，视图**中的任何代码都应该非常简单。*******（如果您的视图需要大量测试，那么您可能想问自己为什么！）*******

 ******Glen 还提到您可以将**Views 注入到 View Models**中，或者将**View Models 注入到 Views**中。我更喜欢后者，因为有非常好的技术可以解耦一切（使用声明性绑定、命令、事件聚合、中介模式等）。**视图模型**是协调核心业务逻辑的所有繁重工作。**如果View Model**提供了所有必要的“绑定”点，那么它真的不需要知道关于**View的****任何**信息（大部分可以在 XAML 中以声明方式连接到它）。

 **如果我们让 View Model 与用户交互的来源无关，那么测试会更容易（最好是先测试）。这也意味着您可以轻松插入任何视图（WPF、Silverlight、ASP.NET、控制台等）。事实上，为了确保实现适当的解耦，我们可以问自己，“MVM”（模型-视图模型）架构是否可以在工作流服务的上下文中工作。当你停下来想一想时，你的大部分单元测试可能都是在这个前提下设计的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-03-14T08:43:26.807

我认为你必须先决定 View First 或 Viewmodel First 然后给出另一个答案，它可以决定.. 有几个开源框架也是如此。我在首先采用 ViewModel 的地方使用 Caliburn，它的方法非常好

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-07T17:11:28.077

我编写了一个非常轻量级的框架，其中 ViewModel 在运行时通过使用 IoC (Unity) 作为标记扩展来解析。

该框架允许在没有代码的情况下编写 XAML，但仍允许您拥有路由命令、数据绑定和事件处理程序。

无论如何，我认为您不需要松散的 XAML，但是如果您查看代码 ( [http://xtrememvvm.codeplex.com](http://xtrememvvm.codeplex.com) )，可能会发现您可以使用一些代码来通过注入视图模型和服务来解决您自己的问题。

# svn - 我在哪里可以找到 SGI IRIX 的预构建 Subversion 二进制文件？

> ID：284922
> 
> 赞同：3
> 
> 时间：2008-11-12T18:44:57.360
> 
> 标签：svn, version-control, sgi, irix

我们有一些运行 IRIX 6.5.x 的 SGI Onyx 350 和 Orgin 350 系统，我们想在上面安装 Subversion。其中一个很可能用作运行 svnserve 的简单存储库服务器。其他人只需要安装客户端。

Subversion 网页包含许多 *NIX 系统的非官方二进制文件的链接，包括 HP-UX、Solaris、AIX、BSD 和 Linux 发行版。不幸的是，IRIX 没有。谷歌搜索也是空的。

那么，网络上是否有某个地方发布了 Subversion 的 IRIX 二进制文件？

如果没有，是否有人有在此类系统上从源代码编译 SVN 的经验？追踪所有依赖项有多难？有什么我们应该注意的警告吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T19:01:27.390

对于像您这样的机器，源代码构建可能是要走的路（这是拥有源代码的优势之一）。依赖关系并没有那么糟糕。依赖项是[zlib](http://www.zlib.net/)、[Apache Portable Runtime](http://apr.apache.org)（和 apr-utils）、[neon](http://www.webdav.org/neon/)（可选）和[BerkelyDB](http://www.oracle.com/technology/software/products/berkeley-db/index.html)（也可选）。
首先获取 Apache 和 neon，以及 berkelyDB 的东西。然后只需 ./configure --prefix=;make;make install

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T02:48:04.120

Nekoware 存储库有一个 Subversion 1.5.5 的二进制文件。

[http://www.mechanics.citg.tudelft.nl/~everdij/nekoware/index.php?path=current/](http://www.mechanics.citg.tudelft.nl/~everdij/nekoware/index.php?path=current/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T18:51:53.947

维护[这个网站](http://www.futuretech.blinkenlights.nl/sgi.html)的人出售二手 SGI 设备。他将它们与贡献软件的 CD 一起出售。也许他可以为你做点什么。

此外，[nekochan.net 上的 SGI 论坛](http://www.nekochan.net/weblog/archives/irix-software/)也发布了贡献软件的帖子。你也许可以在那里要求一些东西。

Subversion 对它的依赖关系相当挑剔（你可能已经解决了）。 [这个链接](http://www.peregrinehw.com/downloads/subversion/INSTALL-rh7.3-last)给出了在 Redhat 7.3 上安装的一些依赖项，它可以追溯到 2000 年代初期（我不知道您使用的是 Irix 的哪个次要版本）。您可能会发现它是对依赖项的合理指南。

# asp.net - 用数据网格分隔列值的最佳方法是什么

> ID：284938
> 
> 赞同：0
> 
> 时间：2008-11-12T18:50:50.750
> 
> 标签：asp.net, css

如果我正在编写自己的 HTML 并将值放在表中，我将使用 css 并使用以下方式设置边框样式：

```
td{
     border-left : solid gray 1px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T18:53:13.087

如果你把那个css样式放到你的网页中，你会发现你的datagrid会使用它，因为datagrid控件只是生成一个html表格！

当然，您可以设置数据网格的 CssClass 并为其制作样式；您还可以摆弄 datagridview 的行样式属性，但 css 样式以后更容易更改/皮肤

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-13T05:39:00.160

您可以尝试使用数据网格的 gridrowstyle 和alternatinggridrowstyle 属性。我建议将它们设置为 Steven 建议的 CSS 类。

# asp.net - POST 数据在某处“丢失”

> ID：284939
> 
> 赞同：0
> 
> 时间：2008-11-12T18:50:52.653
> 
> 标签：asp.net, forms

# 更新

所以事实证明，互联网爆炸者对“安全”的束缚，以“弥补”在安全方面如此糟糕的情况导致了我的问题。我应该先检查一下哈哈。感谢大家的投入，它给了我关于如何优化我的应用程序的想法：D

* * *

我正在编写一个与平台应用程序集成的 Web 应用程序（在 ASP.NET 3.5 中）。平台应用程序获取用户的凭据并将它们放入一个“空” HTML 页面，该页面由一个表单组成，其中包含包含所述凭据的隐藏项和到 webapp 的 POSTS ( **`default.aspx`**)：

```
<HTML>
<HEAD>
<SCRIPT LANGUAGE=JSCRIPT>
    function OnLoad(){
        try {
            document.form1.submit();
        }
        catch(e){
        }
    }
</SCRIPT>
</HEAD>
<BODY OnLoad="OnLoad()">
    <FORM ACTION="http://localhost:51816/gs_ontheweb/default.aspx" METHOD=POST NAME=form1 TARGET="_NEW">
    <INPUT TYPE="HIDDEN" NAME="ClientID" VALUE="123456">
    <INPUT TYPE="HIDDEN" NAME="Password" VALUE="2830088828">
    <INPUT TYPE="HIDDEN" NAME="PracType" VALUE="051">
    <INPUT TYPE="HIDDEN" NAME="Encrypt" VALUE="12345620081111">
</FORM>
</BODY>
</HTML> 
```

当我的**`default.aspx`**页面被加载时，它会调用以下函数：

```
Dim ClientID As String = Request.Form("ClientID")
Dim PassWord As String = Request.Form("Password")
Dim PracType As String = Request.Form("PracType") 
```

它们中的每一个都会导致空字符串。关于为什么会发生这种情况的任何想法？提前致谢。

编辑：我需要在我的**`web.config`**文件中配置什么以使其正常工作吗？Request.Params(" `<param name>`") 不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-13T01:15:16.510

您的问题是表单上的“目标”属性。为什么会在这里？

（我还冒昧地清理了您的 HTML）

```
<html>
    <head>
    <title>Test JS Post</title>
    <script type="text/javascript" language="javascript">
    <!--
        function OnLoad(){
            try
            {
                alert("Posting...");
                document.form1.submit();
            }
            catch(e)
            {
                alert("ERROR!");
                alert(e);
            }
        }
    //-->
    </script>
</head>
<body onload="OnLoad()">

    <form action="http://localhost:49684/Default.aspx" method="post" name="form1">

        <input type="hidden" name="ClientID" value="123456" />
        <input type="hidden" name="Password" value="2830088828" />
        <input type="hidden" name="PracType" value="051" />
        <input type="hidden" name="Encrypt" value="12345620081111" />

        <h1>This is in the form.  Submit me here:</h1><input type="submit" value="foo" />

    </form>

</body>
</html> 
```

在后面的代码中`Default.aspx`：

```
Private Sub Page_Init(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Init

    For Each value As String In Request.Form.Keys
        Debug.WriteLine(String.Format("{0} = ""{1}""", value, Request.Form.Item(value)))
    Next

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T20:33:02.743

那个 HTML 只是在用户的硬盘上？也许浏览器安全性不会让那个 POST 因为它被认为是一种风险。

作为测试——获取准确的 HTML 文件并将其放在您的网络服务器上，然后浏览到它。如果它有效，可能是浏览器拒绝发送数据。您可以在 FireFox 中使用 Fiddler (for IE) 或 Firebug。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T22:00:56.763

为什么不使用 System.Net.WebClient？

一些示例代码（对不起，它是 C#。看起来你在寻找 VB。我不能快速翻译。）

```
System.Net.WebClient wc = new System.Net.WebClient();
byte[] b;
byte[] res;
string formdata = "text=test text&password=secret&checkbox=on&textarea=a longer text sentence&submit=submit";

//    encode the form data string into a byte array 
b = System.Text.Encoding.ASCII.GetBytes(formdata);

// set the content type for a form 
wc.Headers.Add("Content-Type", "application/x-www-form-urlencoded");

// POST and get data
res = wc.UploadData("http://localhost:51816/gs_ontheweb/default.aspx", b);

//convert the return page from byte[] to ascii
string s = System.Text.Encoding.ASCII.GetString(res); 
```

# java - 如何让 javac 搜索类路径的子目录？

> ID：284941
> 
> 赞同：0
> 
> 时间：2008-11-12T18:50:57.473
> 
> 标签：java, classpath

我有 3 个文件：/a/A.java /a/aa/AA.java /b/B.java 和 B.java 取决于 A.java 和 AA.java。

我基本上希望 javac -classpath /a /b/B.java 工作（即在 /a 下面有 javac 搜索）。有什么办法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T18:56:31.097

简短的回答是否定的，这不是类路径目录的工作方式。

每个类路径目录都被视为包结构的根。每个包都是根目录中的一个目录。因此，如果 aa 是包目录且 a 是根目录，javac 将自动执行此操作。你的课程看起来像这样：

/a/A.java

```
class A {} 
```

/a/aa/AA.java

```
package aa;
class AA {} 
```

/b/B.java

```
package b;
import aa.AA;

class B {
  private AA aaInstance;
  private A aInstance;
} 
```

因为 A 没有包，所以放在根包中。

否则，您必须明确设置每个源目录。

# apache-flex - MS Expression、Adobe Flex 还是 OpenLaszlo？

> ID：284945
> 
> 赞同：1
> 
> 时间：2008-11-12T18:52:05.583
> 
> 标签：apache-flex, openlaszlo, microsoft-expression

有人对这三种技术有什么比较的想法吗？每个都针对不同的 VM，但它们的功能如何比较？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T18:55:24.483

[我没有使用 MS Expression 或 Flex 的经验，但是在回答这个问题](https://stackoverflow.com/questions/139150/experiences-with-openlaszlo)时写了一些关于我使用 OpenLaszlo 的经验的评论。其他回复之一提供了 Flex 和 Laszlo 的非常简短的比较。

# apache-flex - 如何在 ActionScript 3.0 中找到关联数组的长度？

> ID：284947
> 
> 赞同：10
> 
> 时间：2008-11-12T18:53:24.787
> 
> 标签：apache-flex, actionscript-3, arrays

`Object`在 ActionScript 3.0 中是否有一种简单的方法来检索关联数组（实现为 ）的长度？

我了解在 AS3 中创建关联数组有两种主要方法：

1.  使用一个`Dictionary`对象；当密钥不需要是`string`
2.  使用`Object`, 并简单地为每个所需元素创建属性。属性名称是键，值就是值。

我的应用程序使用方法#2（使用`Object`类来表示关联数组）。

我希望有比我的`for`循环更原生的东西，它手动计算所有元素。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-12T21:41:26.630

你必须像你一样在 for 循环中计算它们。当然，您可以创建一个类并将 for 循环粘贴在该类中。

有关 AS3 中集合的一些出色实现，请查看[这些家伙](http://lab.polygonal.de/ds/)。

**编辑 2013**毫不奇怪，链接确实会在一段时间后断开。试试这个新的：[http](http://www.grindheadgames.com/get-the-length-of-an-object) ://www.grindheadgames.com/get-the-length-of-an-object 。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-13T09:37:43.113

对此进行一些测试实际上让我感到惊讶。这是数组的正常使用：

```
var things:Array = [];
things.push("hi!");
trace(things.length);
// traces 1
trace(things);
// traces hi! 
```

如果我们为字符串设置一个值：

```
var things:Array = [];
things["thing"] = "hi!";
trace(things.length);
// traces 0
trace(things);
// traces an empty string
trace(things["thing"]);
// traces hi! 
```

基本上，如果您使用字符串添加内容，您是在设置属性，而不是实际添加到数组中。让我想知道为什么 Array 以这种方式是动态的。

所以...是的，用 for ... in 循环计算项目！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-12T19:30:27.863

我认为您坚持“手动”计算它们。

一种选择是将整个事物包装在一个类中，并保留一个单独的变量，您可以在添加/删除时更新该变量。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-13T22:17:34.367

```
var count:int; 
var key:String; 

for (key in myObject)
{ 
    count++; 
} 

trace ("myObject has this many keys in it: " + count); 
```

或者，或者，for-each 语法（我没有测试过哪个更快）

```
for each (var o:* in myObject)
{
    count++;
} 
```

# web-services - 有没有像样的编译器网络服务？

> ID：284948
> 
> 赞同：2
> 
> 时间：2008-11-12T18:53:28.687
> 
> 标签：web-services, compiler-construction, build-automation, web-farm

想法是这样的：您将代码提交到存储库并调用 Web 服务（或通过 Web 应用程序输入请求）来编译它。然后将结果推送到 FTP 服务器、S3 存储桶等。公共互联网上是否有类似的东西？

TFS 具有构建队列功能，但我更多地考虑*互联网*（而不是内部网）Web 服务。如果它可以从已知的源代码控制接口（Subversion、CVS 等）中提取，那么调用者除了选择编译器和特定的编译选项外，只需要传递很少的内容。

我的推理更倾向于消除许多软件安装和配置的麻烦，尤其是在不同语言/平台/框架/项目之间工作时

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T19:09:52.880

请参阅[是否有针对不同操作系统检查开源应用程序的构建场？](https://stackoverflow.com/questions/160793/is-there-build-farm-for-checking-open-source-apps-against-different-oses)获取相关信息。

# svn - 查看 Subversion 中锁定了哪些文件的最佳方法是什么？

> ID：284950
> 
> 赞同：40
> 
> 时间：2008-11-12T18:53:51.837
> 
> 标签：svn, administration

我终于让我的团队从 SourceSafe 切换到 Subversion。不幸的是，我的经理仍然想在每个文件上使用排他锁。所以我在每个文件上设置了 svn:needs-lock 属性并创建了一个预提交钩子以确保该属性保持设置。

我们在 Linux 服务器上运行 Subversion。我们大多数人使用 Windows 机器，少数人使用 Mac。我们正在使用各种 SVN 客户端（TortoiseSVN、SmartSVN、Subclipse 等）。

我们现在需要的是一种好的/简单的方法来查看当前锁定在整个存储库中的所有文件（以及谁锁定了它们）。我在 Tortoise 和 Subclipse 中浏览了一下，但还没有找到我要找的东西。我们的项目有许多子目录，这些子目录是多层次的，因此查看每个单独的目录会太费时间。

我想要的是一个我可以运行的单一报告，其中列出了当前锁定的所有内容以及谁锁定了它。获取此类信息的最佳方式是什么？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-12T19:00:18.157

您正在寻找的是[`svnadmin lslocks`](http://svnbook.red-bean.com/en/1.8/svn.ref.svnadmin.c.lslocks.html)命令。

我在工作中设置了这个，因为我们在 Subversion 存储库中保留了一些 Word 文档（带有`svn:needs-lock`）。我每天设置一个 cron 作业，检查锁列表并将所有超过 7 天的锁的报告通过电子邮件发送给整个团队。通过这种方式，我们可以知道谁在很长一段时间内一直在偷懒并坐在锁定的文档副本上。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-11-12T19:05:17.740

这可能不是您要寻找的答案，但您应该尝试让经理相信锁实际上不是最佳开发实践。有很多关于这个主题的文章，所以我不会在这里重复。

当您从锁定环境转到没有强制签出锁的环境时，起初您认为这会导致混乱，但事实并非如此。SVN 擅长在两个人处理同一个文件时合并更改，即使最终出现冲突，修复它们也不错。

比等着那个拿着重要文件去吃午饭的人要好得多，或者更糟的是，去度假了。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-07-22T11:23:29.223

要查看您和其他人持有什么锁，您可以使用 TortoiseSVN → 检查修改...。本地持有的锁令牌会立即显示。要检查其他人持有的锁（并查看您的任何锁是否损坏或被盗），您需要单击检查存储库。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2012-03-20T11:02:47.663

您可以从本地结帐中发现锁，使用`svn status --show-updates`它将`O` 在服务器上锁定的所有文件之前放置一个。

例如

```
$ svn status --show-updates
     O      279532   LockedFile
?                    UncommittedFile
M           279532   ModifiedFile 
```

查看[svnbook](http://svnbook.red-bean.com/en/1.2/svn.advanced.locking.html#svn.advanced.locking.discovery)了解更多详情

# c - 如果我的编译器对函数指针的支持被破坏，我该如何编写调度程序？

> ID：284952
> 
> 赞同：1
> 
> 时间：2008-11-12T18:54:18.747
> 
> 标签：c, function-pointers, dispatcher

我正在开发一个嵌入式应用程序，其中设备通过命令界面进行控制。我在 VC 中模拟了命令调度程序，并让它运行得令我满意；但是当我将代码移到嵌入式环境时，我发现编译器的指针函数的实现被破坏了。

以下是我最初实现代码的方式（在 VC 中）：

```
/* Relevant parts of header file  */
typedef struct command {
  const char *code;
  void *set_dispatcher;
  void *get_dispatcher;
  const char *_description;
} command_t;

#define COMMAND_ENTRY(label,dispatcher,description) {(const char*)label, &set_##dispatcher, &get_##dispatcher, (const char*)description} 

/* Dispatcher data structure in the C file */
const command_t commands[] = {
  COMMAND_ENTRY("DH", Dhcp, "DHCP (0=off, 1=on)"),
  COMMAND_ENTRY("IP", Ip, "IP Address (192.168.1.205)"),
  COMMAND_ENTRY("SM", Subnet, "Subunet Mask (255.255.255.0)"),
  COMMAND_ENTRY("DR", DefaultRoute, "Default router (192.168.1.1)"),
  COMMAND_ENTRY("UN", Username, "Web username"),
  COMMAND_ENTRY("PW", Password, "Web password"),
  ...
}

/* After matching the received command string to the command "label", the command is dispatched */
if (pc->isGetter)
  return ((get_fn_t)(commands[i].get_dispatcher))(pc);
else
  return ((set_fn_t)(commands[i].set_dispatcher))(pc);
  } 
```

如果不使用函数指针，似乎我唯一的希望是使用 switch()/case 语句来调用函数。但我想避免手动维护一个大的 switch() 语句。

我想做的是将所有 COMMAND_ENTRY 行移动到一个单独的包含文件中。然后用不同的#define 和#undefines 包装包含文件。就像是：

```
/* Create enum's labels */
#define COMMAND_ENTRY(label,dispatcher,description) SET_##dispatcher, GET_##dispatcher
typedef enum command_labels = {
#include "entries.cinc"
  DUMMY_ENUM_ENTRY} command_labels_t;
#undefine COMMAND_ENTRY

/* Create command mapping table */
#define COMMAND_ENTRY(label,dispatcher,description) {(const char*)label, SET_##dispatcher, GET_##dispatcher, (const char*)description} 
const command_t commands[] = {
#include "entries.cinc"
  NULL /* dummy */ };
#undefine COMMAND_ENTRY

/*...*/

int command_dispatcher(command_labels_t dispatcher_id) {
/* Create dispatcher switch statement */
#define COMMAND_ENTRY(label,dispatcher,description) case SET_##dispatcher: return set_##dispatcher(pc); case GET_##dispatcher: return get_##dispatcher(pc);
switch(dispatcher_id) {
#include "entries.cinc"
default:
  return NOT_FOUND;
}
#undefine COMMAND_ENTRY
} 
```

有没有人看到更好的方法来处理这种情况？可悲的是，“获得另一个编译器”不是一个可行的选择。:(

---编辑添加：只是为了澄清，特定的嵌入式环境被破坏，因为编译器*应该*创建一个“函数指针表”，然后编译器使用它来通过指针解析对函数的调用。不幸的是，编译器坏了，没有生成正确的函数表。

所以我没有一个简单的方法来提取函数地址来调用它。

--- 编辑#2：啊，是的，使用 void *(set|get)_dispatcher 是我尝试查看问题是否与 func 指针的类型定义有关。本来，我有

```
typedef int (*set_fn_t)(cmdContext_t *pCmdCtx);
typedef int (*get_fn_t)(cmdContext_t *pCmdCtx);

typedef struct command {
  const char *code;
  set_fn_t set_dispatcher;
  get_fn_t get_dispatcher;
  const char *_description;
} command_t; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-12T19:09:34.847

您应该尝试更改您的`struct command`，以便函数指针具有实际类型：

```
typedef struct command {
  const char *code;
  set_fn_t set_dispatcher;
  get_fn_t get_dispatcher;
  const char *_description;
} command_t; 
```

不幸的是，不能保证函数指针能够与 void 指针相互转换（仅适用于指向对象的指针）。

什么是嵌入式环境？

* * *

鉴于问题更新中发布的信息，我发现它确实是一个错误的编译器。

我认为您提出的解决方案似乎很合理 - 它可能与我想出的类似。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T19:10:19.570

函数指针实际上并不需要适合 void*。您可以检查以确保您调用的值实际上是函数的地址。如果不是，请在结构中使用函数指针类型：get_fn_t 或 IIRC void(*)(void) 保证与任何函数指针类型兼容。

编辑：好的，假设不能使按值调用起作用，我想不出比自动生成 switch 语句更简洁的方法来做你需要的事情。您可以在 C 预处理器之前为 ruby​​/python/perl/php/whatever 使用现成的 ASP 样式预处理器模式。像这样的东西：

```
switch(dispatcher_id) {
<% for c in commands %>
    case SET_<% c.dispatcher %>: return set_<% c.dispatcher %>(pc); 
    case GET_<% c.dispatcher %>: return get_<% c.dispatcher %>(pc);
<% end %>
default:
    return NOT_FOUND;
} 
```

可能比宏/包含技巧更具可读性，但是对于这么少量的代码来说，引入一个新工具和设置 makefile 可能不值得。并且调试信息中的行号与您认为是源文件的文件无关，除非您在预处理器中做额外的工作来指定它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T19:12:23.903

你能让供应商修复编译器吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T19:07:38.453

指向函数的指针损坏到什么程度？

如果编译器允许您获取函数的地址（我来自 C++，但这`&getenv`就是我的意思），您可以将调用约定的东西包装到汇编器中。

如前所述，我是 C++ssie，但有些东西

```
; function call
push [arg1]
push [arg2]
call [command+8] ; at the 4th location, the setter is stored
ret 
```

如果即使这被破坏了，您也可以定义一个指针数组`extern void*`，再次在汇编中定义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T19:03:43.907

试试这个语法：

返回 (*((get_fn_t)commands[i].get_dispatcher))(pc);

自从我完成 C 和函数指针以来已经有一段时间了，但我相信原始 C 语法在取消引用函数指针时需要 * 但大多数编译器会让你在没有它的情况下逃脱。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T23:14:18.363

您可以访问链接地图吗？如果是这样，也许您可​​以绕过不稳定的函数指针表：

```
unsigned long addr_get_dhcp = 0x1111111;
unsigned long addr_set_dhcp = 0x2222222; //make these unique numbers.

/* Relevant parts of header file  */
typedef struct command {
  const char *code;
  unsigned long set_dispatcher;
  unsigned long get_dispatcher;
  const char *_description;
} command_t;

#define COMMAND_ENTRY(label,dispatcher,description) {(const char*)label, 
    addr_set_##dispatcher, addr_get_##dispatcher, (const char*)description} 
```

现在编译，从链接图中获取相关地址，替换常量，重新编译。什么都不应该移动，所以地图应该保持不变。（使原始常量唯一应该防止编译器将相同的值折叠到一个存储位置。您可能需要很长很长，具体取决于架构）

如果这个概念有效，您可能会添加一个运行脚本的链接后步骤以自动进行替换。当然，这只是一个理论，它可能会惨败。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-03T17:15:36.733

也许，您需要再次查看结构​​：

```
typedef struct command {
  const char *code;
  void *set_dispatcher; //IMO, it does not look like a function pointer...
  void *get_dispatcher; //more like a pointer to void
  const char *_description;
} command_t; 
```

假设您的调度程序具有以下类似的函数定义：

```
//a function pointer type definition
typedef int (*genericDispatcher)(int data); 
```

假设调度程序如下所示：

```
int set_DhcpDispatcher(int data) { return data; }
int get_DhcpDispatcher(int data) { return 2*data; } 
```

因此，修改后的结构将是：

```
typedef struct command {
  const char *code;
  genericDispatcher set_dispatcher; 
  genericDispatcher get_dispatcher; 
  const char *_description;
} command_t; 
```

您的宏将是：

```
#define COMMAND_ENTRY(label,dispatcher,description) \
{   (const char*)label, \
    set_##dispatcher##Dispatcher, \
    get_##dispatcher##Dispatcher, \
    (const char*)description } 
```

然后，您可以像往常一样设置数组：

```
int main(int argc, char **argv)
{
    int value1 = 0, value2 = 0;

    const command_t commands[] = {
      COMMAND_ENTRY("DH", Dhcp, "DHCP (0=off, 1=on)")
    };

    value1 = commands[0].set_dispatcher(1);
    value2 = commands[0].get_dispatcher(2);

    printf("value1 = %d, value2 = %d", value1, value2);

    return 0;
} 
```

纠正我，如果我在某处错了...... ;)

# c - sleep() 过早地停止了我的程序。我究竟做错了什么？

> ID：284962
> 
> 赞同：4
> 
> 时间：2008-11-12T18:59:12.043
> 
> 标签：c, stdout, sleep, flush

我想写一个小程序，应该打印类似

> 测试 CPU... 完成
> 测试 RAM... 完成

等等。

我用 C 编写了以下程序：

```
printf( "testing RAM...\t\t" );
sleep( sleep_time );
printf( "done\n\n" );

printf( "testing HDD...\t\t" );
sleep( sleep_time );
printf( "done\n\n" ); 
```

2在哪里`sleep_time`。

但是，不是先打印“testing CPU ...”，然后等待，然后打印“完成”，而是先等待，然后打印整行，这与我的想法不完全一致。

我想这与编译器的自动优化有关。
无论如何，我该怎么做才能获得所需的输出？

我在 OSX 10.5.6 上使用 XCode 3.1

谢谢你，
巴斯蒂安

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-12T19:00:43.383

问题是您的打印被缓冲了。临睡前，调用 fflush(stdout); 刷新缓冲区

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-13T14:14:28.820

编译器无法重新排序打印和休眠，因为它们是 C 抽象机的“外部可观察行为”。

你得到的是由于标准输出缓冲。您可以使用 fflush 或打印到未缓冲的 stderr。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T03:23:35.703

只需在第一个 printf 的末尾使用 \n 或 endl 就足够了

# algorithm - Vb6 根据文本文件的每一行执行操作

> ID：284971
> 
> 赞同：0
> 
> 时间：2008-11-12T19:01:30.917
> 
> 标签：algorithm, vb6, scripting

我有一个带有一系列命令的文本文件，每个命令都在不同的行上，我需要做的是逐行浏览文本文件，并为每一行执行一组操作。我将如何逐行循环？

例子：

文本文件包含：
johndoe.log
Apples 和organes.log
猴子和zebras.log

脚本将抓取第 1 行（johndoe.log）
创建一个名为 johndoe.log 的新文本文件
转到第 2 行
创建一个名为 apples 和organes.log
等的新文本文件...直到文本文件完成

除了对文本文件的每一行执行操作的循环之外，我知道如何做所有事情:(

我知道它的橙子，打错了字，就跟着去了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T19:09:20.650

在经典的 VB6 中：

```
Dim LineData as String
Dim FileHandle as Integer

FileHandle = FreeFile
Open "C:\Test.txt" For Input As #FileHandle
Do While Not EOF(FileHandle)
    Line Input #FileHandle, LineData
    ' Do whatever with LineData
Loop
Close #FileHandle 
```

或者你可以看看`FileSystemObject`

# sql - 没有嵌套查询的 SQL 查询

> ID：284984
> 
> 赞同：3
> 
> 时间：2008-11-12T19:05:36.913
> 
> 标签：sql

假设我们有这些表；

表用户：
- id
- 用户名
- 电子邮件

表 user2group:
- userid
- groupid

表组： -id-
组名

如何进行一个查询来返回所有用户以及他们所属的组（作为结果集中的数组或其他东西..）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-12T19:08:06.237

```
select u.id, u.username, u.email, g.groupid, g.groupname
from user u 
join user2group ug on u.userid=ug.userid
join group g on g.groupid=ug.groupid
order by u.userid 
```

当您遍历结果集时，每次看到一个新的用户 ID 时都会创建一个新的用户对象（或其他）并将组添加到其中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T20:12:06.593

Eric 的回答很好，但我会使用 LEFT JOIN 而不是 INNER 来获取不属于任何组的用户。

```
SELECT 
  u.id, 
  u.username, 
  u.email, 
  g.groupid, 
  g.groupname
FROM 
  user u 
  LEFT JOIN user2group ug ON u.userid = ug.userid
  LEFT JOIN group g ON g.groupid = ug.groupid
ORDER BY 
  u.userid 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T20:32:21.340

以上两个都或多或少是正确的（取决于每个用户是否有一个组）。但他们也会为每个用户提供一个包含多个条目的结果集。

有多种方法可以将每个组成员连接成一个逗号分隔的字符串，我建议您在这里阅读： [http ://www.simple-talk.com/sql/t-sql-programming/concatenating-row-values-事务中 sql/](http://www.simple-talk.com/sql/t-sql-programming/concatenating-row-values-in-transact-sql/)

我个人喜欢的另一种方法是使用位值而不是关系表 user2group

然后表user得到一个int（或bigint）字段组，每个组ID分配一个位值（即：1,2,4,8,16等）用户表的组字段的值然后是总和分配给它的 groupID。要查询它是否有一个组，请执行以下操作： where (group AND groupID = groupID)

# class - 将属性添加到现有 VBA 类

> ID：284985
> 
> 赞同：1
> 
> 时间：2008-11-12T19:06:09.847
> 
> 标签：class, excel, vba

我想做一些事情，比如在类中添加一个 nice-to-Excel-functions`Name`属性`WorkBook`。有没有好的方法来做到这一点？

更详细的问题：在 VBA 中，您可以将公式分配给 Excel 工作表中的范围。我想这样做，并且我希望我的公式引用第二个工作簿，这是`wb`我的代码中调用的一个对象。然后我`wb.Name`将公式分配给一个范围。

当`wb.Name`其中包含单引号时，就会出现问题。然后你会得到这样的结果：

```
=MONTH('[Ryan's WB]Sheet1'A1) 
```

在电子表格中，由于工作簿名称中的单引号与第一个单引号匹配而失败。

我想要的是一个类的属性，它用两个单引号替换属性中的所有单`FunName`引号并返回它。那么上面的公式会正确地看起来像`WorkBook``Name`

```
=MONTH('[Ryan''s WB]Sheet1'A1) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T22:31:07.647

您无需创建单独的类来扩展工作簿类。您可以将属性添加到现有的 ThisWorkbook 类模块，如下所示：

```
Public Property Get FunName() As String

    FunName = Replace(Me.Name, "'", "''")

End Property 
```

然后你打电话`ThisWorkbook.FunName`给你清理过的名字。但是，此代码必须存在于手头的工作簿中。如果您希望它适用于*任何*工作簿，那么您的功能就是要走的路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T19:35:34.873

只需进行替换以将单引号加倍

```
WorksheetName = Replace(WB.Name, "'", "''") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T22:25:02.457

您需要的是一个扩展 Workbook 对象的类。插入一个类模块，然后试试下面的代码

```
Dim WithEvents WB As Workbook

Public Sub SetWB(W As Workbook)
  Set WB = W
End Sub

Public Property Get FunName() As String
  FunName = Replace(WB.Name, "'", "''")
End Property

Private Sub WB_SheetCalculate(ByVal Sh As Object)
  'this runs when WB calculates
End Sub 
```

'这样使用

```
Dim WB As New wbClass
WB.SetWB ActiveWorkbook
CleanedName = WB.FunName 
```

请注意，作为奖励，我已将 WithEvents 放在 Dims WB 类的顶部。这允许您捕获发生在 WB 上的所有事件，并且我在上面包含了 Calculate 事件作为演示。如果您在类代码中并单击代码窗格左上角的对象下拉列表，您将看到 WB 对象，如果您单击它，右侧的列表框将为您提供所有可供选择的事件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T23:14:42.090

最后的答案似乎是 WorkBook 类可以扩展为包含一个对 Excel 公式很好的名称属性。这可以使用 dbb 提供的方法来完成。但是，由于 VBA 不支持继承，扩展类的对象将仅具有您为它们定义的属性。

因此，只使用一个函数确实更有意义。这是我要使用的：

```
Function FormulaWorkName(ByVal aName As String) As String
    FormulaWorkName = Replace(aName, "'", "''")
End Function 
```

我将应用于工作表名称和工作簿名称。

# c - C MySQL 客户端库行为

> ID：284989
> 
> 赞同：2
> 
> 时间：2008-11-12T19:08:19.403
> 
> 标签：c, linux, memory-leaks, mysql4, mysql

我有一个客户端应用程序，它使用 SuSE SLES 9 上的库存库连接到 MySQL 数据库 4 服务器。但是，有时在处理来自服务器的特定重置集时，迭代抛出结果不允许我处理所有结果在数据库中。

这个问题有时会发生，主要是当服务器有几天的正常运行时间时。我怀疑重启可以解决问题。

无论如何，随着时间的推移不释放 MySQL 结果集会导致这种内存泄漏并以这种奇怪的行为显示自己必须始终释放所有结果集吗？但是，相同的表和相同的程序在另一台计算机上的行为应该如此。

由于应用程序或 mysql 客户端库中的实现问题，结果集是否会损坏？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T02:06:40.530

一切皆有可能，但我倾向于默认处理应用程序级别的问题。如果您使用 C/C++ 进行编码，任何闻起来可能与内存相关的问题都是堆损坏错误的主要候选者，这可能会导致结果集问题。另外，我很好奇您将此结果集保持打开多长时间 - 是否有可能在查询运行和检索时插入了您“丢失”的行结果集中的值？

最后，当您关闭数据库连接时，会自动在服务器上发布结果集，因此除非您将单个连接保持打开数天，否则这不太可能是问题，因为 MySQL 中没有错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-13T13:46:58.923

您可能会考虑升级到 MySQL 5。
拥有最新版本通常会很好。

# graphics - 什么图像编辑器或库可以生成易于使用的 2D 矢量格式来描述区域/蒙版？

> ID：284994
> 
> 赞同：2
> 
> 时间：2008-11-12T19:09:53.910
> 
> 标签：graphics, image, vector-graphics, image-editor

步

1.  行政/数据录入工作人员打开**?** ，加载光栅图像，并使用“类似套索”的工具（如果可能，使用 Photoshop 的“磁性”）指定感兴趣的区域/蒙版。

2.  **?**

3.  利润！（即，应用程序打开光栅图像，描述掩码的矢量文件，根据运行时上下文对感兴趣的区域做一些有趣的事情）

我的问题是“我们在步骤 1 和 2 中使用**什么？** ”

*   主要目标是减少完成第 1 步和第 2 步（流程的“机械土耳其人”部分）所需的时间。
*   严格的次要目标是易于解析/使用描述步骤 3 中感兴趣区域/掩码的矢量格式。

> **饮水机对话：**
> 
> “天哪，肯定有一些 Flash 组件可以做到这一点！”
> 
> “那么 GIMP 呢？”
> 
> “如果我们必须让 C 或 C++ 程序员参与其中，那将不是一项好的投资......”
> 
> “但如果只需要一两天呢？” “任何事情都只需要一两天，”......

对于原型设计，明显的路线是**Photoshop -> Illustrator -> SVG**。

但是，如果有一个框架/库/编辑器可以使“套索”编码和矢量文件生成变得容易，它可能会倾向于编写自定义编辑器。

有这样的框架/库/编辑器吗？***********************