# StackOverflow 问答 12277000-12277999

# plone - 'ascii' error at /@@mail-controlpanel

> ID：12277003
> 
> 赞同：2
> 
> 时间：2012-09-05T08:01:55.887
> 
> 标签：plone

I have a 'ascii' error at /@@mail-controlpanel. How can i check the values and fix that? The site is running Plone4.2 on Debian6.

Regards

my Traceback:

```
...
Module zope.tales.tales, line 696, in evaluate
   - URL: /home/plone42/buildout-cache/eggs/plone.app.controlpanel-2.2.5-py2.7.egg/plone/app/controlpanel/control-panel.pt
   - Line 110, Column 28
   - Expression: <PathExpr standard:u'widget'>
   - Names:
  {'args': (),
   'container': <PloneSite at /intranetcfa>,
   'context': <PloneSite at /intranetcfa>,
   'default': <object object at 0x7f11f8d43b40>,
   'here': <PloneSite at /intranetcfa>,
   'loop': {},
   'nothing': None,
   'options': {},
   'repeat': <Products.PageTemplates.Expressions.SafeMapping object at 0x5e37e10>,
   'request': <HTTPRequest, URL=http://91.121.151.215:8088/intranetcfa/@@mail-controlpanel>,
   'root': <Application at >,
   'template': <Products.Five.browser.pagetemplatefile.ViewPageTemplateFile object at 0x4edd790>,
   'traverse_subpath': [],
   'user': <PropertiedUser 'admin'>,
   'view': <Products.Five.metaclass.MailControlPanel object at 0x7f11ea4efbd0>,
   'views': <Products.Five.browser.pagetemplatefile.ViewMapper object at 0x7f11ea506110>}
  Module zope.tales.expressions, line 217, in __call__
  Module Products.PageTemplates.Expressions, line 155, in _eval
  Module Products.PageTemplates.Expressions, line 117, in render
  Module zope.formlib.textwidgets, line 134, in __call__
  Module zope.formlib.widget, line 627, in renderElement
  Module zope.formlib.widget, line 612, in renderTag
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 22: ordinal not in range(128) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:54:39.477

You might try to change the from name/address directly through the ZMI under

```
http://host:port/your_plone/manage_propertiesForm 
```

by adjusting the email_from_address or email_from_name properties.

# c# - 将图像传递到另一个页面

> ID：12277005
> 
> 赞同：0
> 
> 时间：2012-09-05T08:02:01.480
> 
> 标签：c#, asp.net

早上好，我正在尝试将图像从一页传递到另一页并且遇到了一些困难。它所在的页面名为Spain.aspx，它显示西班牙足球球衣，它在gridview中有一个图像，我希望用户能够点击任何球衣并被重定向到一个名为ProductLarge的页面，它将显示他们点击球衣并以更大的比例显示它。我已经阅读并尝试了一些不同的方法，但我似乎在使用以下代码：

```
<asp:Image ID="productimage" runat="server" ImageUrl='<%# "~/Handler.ashx?productid=" + Eval("productid")%>' Width="100" Height="100" /> 
```

或者

```
<asp:HyperLink Font-Size="12px" ID="lnkImage" runat="server" 
ImageUrl='<%# "~/Handler.ashx?productid=" + Eval("productid")%>'
NavigateUrl='<%#"ProductLarge.aspx?productid=" + Eval("productid")%>'>
<a href ="ProductLarge.aspx" > </a> </asp:HyperLink> 
```

有人会建议我是否应该使用处理程序（在您看来），或者尝试使用替代方法来传递图像？任何帮助表示赞赏，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:39:46.217

您可以通过查询字符串发送图像的 ID，然后从数据库中检索此 ID

# iphone - kal 日历更改标记事件颜色

> ID：12277006
> 
> 赞同：0
> 
> 时间：2012-09-05T08:02:05.877
> 
> 标签：iphone, objective-c, ios, xcode

我使用 Klazuka/Kal 控制器来选择日期。当我从两个不同的数组中添加事件时。所以

基本上我有两个数组，其中有不同的日期。所以，我想区分这两个

数组在日历中显示为事件的日期。

请提出一些摆脱这种情况的方法。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:29:31.360

CGColor 是 EKCalendar 的属性。EKEvents 没有属性可以为其设置颜色。特定日历中的所有事件都将具有相同的颜色。

您可以为颜色区分创建不同的日历

```
 EKEventStore *eventStore = [[EKEventStore alloc] init];

    EKCalendar *calendar = [EKCalendar calendarWithEventStore:eventStore];
    calendar.title = calendarName; // set calendar name
    calendar.CGColor = [UIColor grayColor].CGColor // set whichever color you want here

    bool success= [eventStore saveCalendar:calendar commit:YES error:&error]; 
```

参考[这个](http://developer.apple.com/library/ios/#documentation/DataManagement/Reference/EKCalendarClassRef/Reference/Reference.html)

# c# - 使用 WPF 与 Web 服务器通信

> ID：12277008
> 
> 赞同：0
> 
> 时间：2012-09-05T08:02:09.370
> 
> 标签：c#, .net, wpf, visual-studio-2010

我对 WPF 很陌生。

我使用 WPF 开发了一个简单的应用程序。现在，我需要与网络服务器通信（比如**www.xyztest.com/downloads/test.txt**）并将 test.txt 下载到我的本地驱动器（或用户指定的目录）。

我该怎么做呢？或者我从哪里开始学习与 Web 通信！我用谷歌搜索，但事情并不复杂。作为一个简单的起点，请建议一个简单的代码示例，该示例应与已知位置进行通信（或从 Internet 下载文本文件）。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:06:52.540

[`WebClient.DownloadFile`](http://msdn.microsoft.com/en-us/library/ms144193)正是这样做的。该类`WebClient`不是 WPF 特有的，它可以在任何类型的应用程序中使用。

还有许多其他方法可以访问网络功能，每种方法在便利性和表达能力之间都有自己的平衡。对于更强大（但也更冗长）的代码，您还应该查看[`WebRequest.Create`](http://msdn.microsoft.com/en-us/library/system.net.webrequest.create.aspx)相关的 class [`HttpWebRequest`](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)。

# c# - 合并两个 rtf 字段以不良风格显示

> ID：12277012
> 
> 赞同：1
> 
> 时间：2012-09-05T08:02:24.797
> 
> 标签：c#, .net, rtf

在我的每本书的应用程序集中以 rtf 格式保存在 SQLite 数据库中。我通过这段代码合并剧集：

```
rtbText.ResetText();
rtbText.Clear();
rtbText.Rtf = null;
DataTable dt = DAL.DataAccessClass.MultiMedia.FetchTexts(PointId, OutPointTitleId);
if (dt.Rows.Count != 0)
{
    string TextForRtf = string.Empty;
    RichTextBox rtftxt = new RichTextBox();
    foreach (DataRow Row in dt.Rows)
    {
        string Temp = Row["PointTitleContentRTF"].ToString();
        TextForRtf += Temp.Replace("\n}", "\n").Trim();
    }
    rtbText.Rtf = TextForRtf;
    rtbText.RightToLeft = System.Windows.Forms.RightToLeft.Yes;
    rtbText.Modified = false;
} 
```

剧集列表位于列表框中。当用户点击书名时，所有剧集必须合并并显示在 RichTextBox 中。但第一次 RichTextBox 的内容显示在 RichTextBox 的中间。单击任何一集时，再次单击书名 RichTextBox 内容显示正确。我怎样才能解决这个问题？

这是我的问题的说明：

![这是我的问题的一个例证](../Images/7c14fe60d765802301f951beac3d28c0.png)

# android - 如何在另一个活动中知道微调器选择的值

> ID：12277014
> 
> 赞同：0
> 
> 时间：2012-09-05T08:02:34.080
> 
> 标签：android

如何在另一个屏幕中获取微调器选择的值？

假设我在登录屏幕中有 3 个选项

1.  无线上网

2.  GPRS

3.  短信

    我在登录屏幕中选择选项 3 作为微调器值，当我进行另一个活动时，如何以这种方式设置微调器值

    如果选择的位置是 3
    true
    else false

或者我以任何其他方式检查以了解在最后一个屏幕上选择了哪个值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:06:06.837

在意图中使用 intExtra 将值 (1,2,3) 传递给第二个活动，您可以在其中使用 getIntent().getExtra() 来读取该 int。根据它的值，您知道在微调器上选择了什么。

示例：在 LoginActivity 中：

```
 Intent intent=new Intent(LoginActivity.this,SecondActivity.class);
 intent.putExtra("CODE",1);
 startActivity(intent);
 finish(); 
```

在第二活动中：

```
Intent intent = getIntent();
int code=intent.getIntExtra("CODE",0); 
```

然后根据代码值，您知道选择了什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T09:50:32.300

您可以获取所选项目的索引并将其传递给下一个活动。在第二个活动中将此项目设置为选中

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T08:11:27.550

您可以在活动中使用`putExtra()`和。`getExtra()`

写下您必须发送数据的活动。

```
 Intent intent = new Intent(YourCurrentActivity.this,YourNextActivity.class);
  intent.putExtra("Value", spinnerValue);
  startActivity(intent); 
```

接收时使用此

```
String getSpinnerValue = getIntent().getExtras().getString("Value"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T08:07:58.713

通过 putExtras() 和 getExtras() 将值从一个活动传递到另一个活动

```
 Intent in=new Intent(currentActivity.this,nextActivity.class);
  in.putExtras("passingvalue_attribute","passvalue");
  startActivity(in);
  finish(); 
```

为了获得价值。

```
 String value=getIntent().getExtras().getString("passingvalue_attribute"); // its for string likewise you can send and get boolean and integer also.. 
```

我想它可能对你有帮助..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-09T06:03:24.703

`String selectedItem = YourActivtyName.spinnername.getSelectedItem().toString();` 使用静态，您可以访问另一个类或活动中的数据成员。在您的活动中，您必须将 Spinner 名称声明为公共静态。

# visual-studio - 如何使用 VS 2012 创建 (VSTO) Office 2007 加载项？

> ID：12277023
> 
> 赞同：33
> 
> 时间：2012-09-05T08:02:59.683
> 
> 标签：visual-studio, vsto, visual-studio-2012, office-2007

Visual Studio 2012 似乎不支持 Office 2007（它只有 Office 2010 的项目模板）。如果我想创建与 Office 2007 兼容的加载项，是否需要使用 Visual Studio 2010，或者是否有简单的方法可以使用 VS 2012 来完成？

如果有*办法*在 VS 2012 中做到这一点，这样做有什么限制/优势等吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-09-05T15:05:17.013

您可以让**VS 2012**与**Office 2007**一起使用。首先创建一个**Outlook 2010 加载项**并修改项目文件 ( *.csproj* )，使其在 Office 2007 中打开，并且在运行时不查找 Office 2010。

这是项目设置更改（*Outlook 示例*）：

**源 XPath：**

> //项目/ProjectExtensions/VisualStudio/FlavorProperties/ProjectProperties/@DebugInfoExeName

**旧值（Office 2010）：**

> DebugInfoExeName="#Software\Microsoft\Office\14.0\Outlook\InstallRoot\Path#outlook.exe"

**新价值（Office 2007）：**

> DebugInfoExeName="#Software\Microsoft\Office\12.0\Outlook\InstallRoot \Path#outlook.exe"

更改此项目设置后，当您启动调试器 ( `F5`) 时，它将加载 Outlook 2007 应用程序，而不是查找 Outlook 2010。

* * *

使用 VS 2012 进行 Office 开发的主要缺点之一是[部署现在使用 InstallShield LE 而不是 Visual Studio Setup Projects](https://stackoverflow.com/a/11934294/175679)。这是一个重大转变，但似乎[MS 正在远离支持本地安装程序并让其他人来管理这个负担](http://blogs.msdn.com/b/buckh/archive/2011/03/17/visual-studio-setup-projects-vdproj-will-not-ship-with-future-versions-of-vs.aspx)。[WiX 是替代安装程序](http://wix.codeplex.com/)，但我没有尝试过。WiX ( *Windows Installer XML* ) 仍然缺少 InstallShield LE 或 VS 2010 安装项目所提供的 UI。

使用 VS 2012 进行开发的唯一优势是开发 IDE 速度要快得多。

# php - 从数据库中检索 x、y 坐标

> ID：12277026
> 
> 赞同：0
> 
> 时间：2012-09-05T08:03:20.603
> 
> 标签：php, mysql, maps

我有一个服务器：通过 UNIX 套接字的 localhost 和我使用 phpmyadmin 访问的 mySQL 数据库。现在我得到一个像这样的表：x double y double id smallint10 auto increment

x 和 y 值用于存储坐标。现在我想从数据库中获取最新的坐标并在谷歌地图中显示这些坐标。所以我需要一个 php 脚本来获取它们。然后我需要一个 js 脚本在谷歌地图中显示它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:08:58.317

你可以试试 PHP + MySQL，效果很好（PHP 是服务器端脚本服务，MySQL 是数据库服务，可以与 PHP 一起使用）。您可以通过**[PHP/MySQL 教程 1](http://www.freewebmasterhelp.com/tutorials/phpmysql)**和**[PHP/MySQL 教程 2](http://www.tizag.com/mysqlTutorial/)**了解这些事情是如何使用 PHP 工作的，例如将数据存储到 MySQL 数据库中以及从 MySQL 数据库中检索数据。

您还可以查看**[jQuery](http://jquery.com/%E2%80%8E)**的**[ajax](http://api.jquery.com/jQuery.ajax/)**方法，用于从远程源实时检索数据，同时保持在同一页面上，而无需导航到另一个页面。这是一个教程[http://viralpatel.net/blogs/jquery-ajax-tutorial-example-ajax-jquery-development/](http://viralpatel.net/blogs/jquery-ajax-tutorial-example-ajax-jquery-development/)（这可以帮助您在谷歌地图中显示 mysql 结果）

我建议你使用 PHP 的**[PDO](http://php.net/manual/en/class.pdo.php)**方法进行数据库操作，因为 PHP 手册本身就说“不鼓励使用 mysql 扩展。”。您可以阅读**[MySQL 开发人员的 PDO 教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:09:01.060

```
SELECT `x`, `y` FROM `your_tables_name` WHERE `id` = 'id_number_of_coordinations' 
```

......就像它得到的一样简单。您需要研究使用 PHP 查询 mysql。我建议使用 mysqli 或 PDO。

# xcode - Xcode - 显示“场景停靠” - 它被隐藏

> ID：12277027
> 
> 赞同：4
> 
> 时间：2012-09-05T08:03:28.547
> 
> 标签：xcode, dock

起初，我什至不确定这东西到底是怎么称呼的。在某些网站上，它似乎被称为“dock”或“scene dock”，在 Xcode 中编辑 GUI 时，视图下方的这个黑条。[示例图像](https://developer.apple.com/library/ios/referencelibrary/GettingStarted/RoadMapiOS/chapters/RM_YourFirstApp_iOS/Art/storyboard_vc_selected.jpg)

我的问题是，这个栏出现在每个教程中并用于不同的任务（例如手势），但在我的 Xcode 环境（4.3.2）中它没有出现。

我查看了所有查看菜单，查看了首选项，....我只是找不到任何可能性来展示这个“场景停靠”。知道我能做什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:28:08.513

1.  “场景停靠”仅在情节提要中可见，而不是在单个 xib 文件中。你有故事板吗？
2.  如果它以某种方式隐藏在您的故事板中，请不要担心。你实际上不需要它。“场景停靠”只显示文档大纲的内容（您的 xib 或情节提要中的左侧面板可以找到第一响应者）。您可以添加、编辑或连接文档大纲中的所有元素。

# c# - SNMP mib 解析器

> ID：12277028
> 
> 赞同：2
> 
> 时间：2012-09-05T08:03:30.977
> 
> 标签：c#, snmp, sharp-snmp

如何通过 mib 文件将 SNMP-OID 转换为字符串？

我使用 SNMPSharpLib，但我不知道如何解析对象。

我收到陷阱 (v2)，它们包含“ObjectIDentifier”文件，但我需要将它们翻译成英文文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:12:55.623

您应该查看 snmptranslate 示例，

[https://github.com/lextm/sharpsnmplib/blob/55a03bf575f0b5a518dab10b595dd09b2a1798ae/archived/snmptranslate_cs/Program.cs](https://github.com/lextm/sharpsnmplib/blob/55a03bf575f0b5a518dab10b595dd09b2a1798ae/archived/snmptranslate_cs/Program.cs)

它演示了执行翻译所需的内容。

**更新**

由于#SNMP Pro 版本的引入，MIB 文档相关功能已从#SNMP 库中删除。

# android - 在 Android 平台上使用 wifi-direct 进行客户端/对等通信

> ID：12277030
> 
> 赞同：10
> 
> 时间：2012-09-05T08:03:38.500
> 
> 标签：android, p2p, wifi-direct

我有三个 Android 设备：A、B 和 C。它们通过 wifi-direct 连接（假设 B 是组所有者）。

我只有两个问题： 1\. A 想给 C 发消息，消息必须经过群主 B 才能到达 C？2.如果群主B不小心掉线了，A还能给C发消息吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-27T04:55:15.957

在 Wifi 直接通信中，P2P 组所有者 (P2P GO) 设备在 P2P 组中实现类似 AP 的功能。充当客户端的设备称为 P2P 客户端。因此，所有的通信都必须通过群主渠道。

一旦组所有者断开连接，显然路由通道已被杀死，因此该组。客户端必须重新建立连接，并且其中一个客户端成为组所有者。

# ios - 计算凸度缺陷时，iOS 的 OpenCV 2.4.2 中的“断言失败（ptnum > 3）”，无法获得一个无缝轮廓

> ID：12277036
> 
> 赞同：1
> 
> 时间：2012-09-05T08:04:06.407
> 
> 标签：ios, opencv

我已经查看并尝试解决[在 c++ 中使用 OpenCV 2.4 计算凸度缺陷中](https://stackoverflow.com/questions/10620981/calculating-convexitydefects-using-opencv-2-4-in-c)的类似问题，但他的解决方案似乎对我不起作用。

```
// Get contours
vector<vector<cv::Point> > contours;
findContours(inputMat, contours, CV_RETR_TREE, CV_CHAIN_APPROX_SIMPLE);

vector<vector<cv::Point> > hulls(contours.size());
vector<vector<int> > intHulls(contours.size());
vector<vector<Vec4i> > defects(contours.size());

for(int i = 0; i < contours.size(); i++){
    convexHull(Mat(contours[i]), hulls[i]);
    convexHull(Mat(contours[i]), intHulls[i]);
    convexityDefects(contours[i], intHulls[i], defects[i]);
} 
```

我总是得到：

```
OpenCV Error: Assertion failed (ptnum > 3) in convexityDefects, file /Users/user/slave/ios_framework/src/opencv/modules/imgproc/src/contours.cpp, line 1969 
```

所以我去下载了源代码来查看contours.cpp，第1969行。

```
1965 void cv::convexityDefects( InputArray _points, InputArray _hull, OutputArray _defects )
1966 {
1967     Mat points = _points.getMat();
1968     int ptnum = points.checkVector(2, CV_32S);
1969     CV_Assert( ptnum > 3 ); 
```

看起来它正在尝试制作轮廓点的垫子，然后检查垫子是否......什么？在[http://docs.opencv.org/](http://docs.opencv.org/)上没有任何关于 checkVector 的文档，但是谷歌搜索发现[了这个文档](http://www710.univ-lyon1.fr/~eguillou/documentation/opencv2/classcv_1_1_mat.html#a39541d4dbd7fafbfae93f1737e51ffbc)：

```
int cv::Mat::checkVector    (   int     elemChannels,
    int     depth = -1,
    bool    requireContinuous = true 
    )        const

returns N if the matrix is 1-channel (N x ptdim) or ptdim-channel (1 x N) or (N x 1); negative number otherwise 
```

在读了几次之后，我仍然完全迷失了，不确定是什么导致了这个错误，或者我能做些什么来修复它。上周我一直在尝试自己解决这个整体的 convexityDefects() 问题，但一点运气都没有。

编辑：我只是仔细检查了几件事以确保安全。

我的输入垫总是 100 列 x 120 行，就像它应该的那样。但是，我认为轮廓会像在屏幕上看起来一样平滑和连续，但显然不是。当我将它们转换为垫子并检查尺寸时，它们几乎总是 1 col x XXX 行。所以我想我的问题是我必须得到一个二维轮廓——有没有办法把它们连接在一起？它们在我的屏幕上看起来无缝。

编辑2：即使在适当的垫子上绘制轮廓并传递给我同样的“断言失败（ptnum> 3）”错误。我真的不知道现在该怎么办。

# java - 具有备用目标列的休眠映射

> ID：12277037
> 
> 赞同：0
> 
> 时间：2012-09-05T08:04:17.483
> 
> 标签：java, hibernate, jpa

我有一个模型对象关系，例如：

```
@Table(name="cables")
class Cable {
    @Id
    private Long id;
    @Column(name="dstport_id")
    private Port dstPort;
    @Column(name="srcport_id")
    private Port srcPort;
}
@Table(name="ports")
class Port {
    @Id
    private Long id;
    private Cable cable; // Here's the mapping that should point to cables.dstport_id or cables.srcport_id whatever is present
} 
```

在这种关系中，映射是通过 Cable 的 dstport_id 或 srcport_id 列的一对一映射。一根电缆可以连接到一个、一个或两个（完全不同的）端口。端口可以​​不连接或仅连接一根电缆，并且可以连接到任一端点。那么，在 Hibernate 中有没有办法在 Port 实体中映射这种关系（在 Cable 实体中映射它没有技巧）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T04:33:34.433

我不相信只有在端口中的*一个*关联来定义从端口到电缆的关系是可能的。

`dstPortCable`在我看来，您最好的选择是使用“mappedBy”连接方法在端口（和，比如说）中定义 2 个可选的一对一关联到电缆`srcPortCable`，然后在端口中定义一个方法，因此：

```
public Cable getCable() {
    if (dstPortCable != null) {
        return dstPortCable;
    }
    if (srcPortCable != null) {
        return srcPortCable;
    }
    return null;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:23:07.487

据我所知，您需要`One to Many mapping ( Cable to Port) in Cable.java`和`One to One mapping in Port.java`上课。

因此，在 Calble.java 中，您可以执行以下操作 -

```
@OneToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY)
@JoinColumn(name = "srcport_id",nullable=false)
@ForeignKey(name = "fk_srcport_id")     
private List<Port > ports= new ArrayList<Port >(); 
```

并在 Port.java -

```
@OneToOne(fetch=FetchType.LAZY)
@JoinColumn(name = "srcport_id", updatable = false, insertable = false, nullable=false)  
private Calble Calble; 
```

# c# - 设置搜索，如 Google Chrome for WPF

> ID：12277049
> 
> 赞同：1
> 
> 时间：2012-09-05T08:05:25.970
> 
> 标签：c#, wpf, google-chrome, user-interface

Chrome 有一个很棒的功能：您可以搜索设置页面，Chrome 只显示相关设置，或者，如果您需要打开一个窗口，还有一点提示。我真的很喜欢这个功能，并希望在我的开源工具中实现它。

从技术上讲，这怎么可能实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T17:39:41.770

您可以尝试对设置集合使用集合视图，并在更改搜索字符串后对其进行过滤。

```
var settings = new ObservableCollection<SettingsClassType>();
SettingsCollView = CollectionViewSource.GetDefaultView(settings);
SettingsCollView.Filter += (o) => {
  var setting = (SettingsClassType)o;
  return string.IsNullOrEmpty(YourSearchInput)
         || setting.Name.Contains(YourSearchInput);
}

private string yourSearchInput;
public bool YourSearchInput
{
  get { return yourSearchInput; }
  set
  {
    if (value == yourSearchInput) {
      return;
    }
    yourSearchInput= value;
    // filer your collection here
    SettingsCollView.Refresh();
    this.NotifyPropertyChanged("YourSearchInput");
  }
} 
```

希望有帮助

# python - PyQt 4：setupUi() 未绑定方法错误

> ID：12277051
> 
> 赞同：2
> 
> 时间：2012-09-05T08:05:56.710
> 
> 标签：python, eclipse, pyqt4

我开始学习使用 PyQt4。我有一个想要显示的简单 gui 窗口（没什么花哨的）。

这是代码：

```
import sys
from PyQt4 import QtGui
from test import Ui_MainWindow

class MyForm(QtGui.QMainWindow):
   def __init__(self, parent=None):
       QtGui.QWidget.__init__(self, parent)
       self.ui = Ui_MainWindow
       self.ui.setupUi(self)          

if __name__ == "__main__":

    app = QtGui.QApplication(sys.argv)
    myapp = MyForm()
    myapp.show()
    sys.exit(app.exec_()) 
```

但是eclipse给了我以下错误：

```
TypeError: unbound method setupUi() must be called with Ui_MainWindow instance
as first argument (got MyForm instance instead) 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T08:28:32.653

你应该继承`Ui_MainWindow`：

```
import sys
from PyQt4 import QtGui
from test import Ui_MainWindow

class MyForm(QtGui.QMainWindow, Ui_MainWindow):
   def __init__(self, parent=None):
       QtGui.QWidget.__init__(self, parent)
       self.setupUi(self)

if __name__ == "__main__":
    app = QtGui.QApplication(sys.argv)
    myapp = MyForm()
    myapp.show()
    sys.exit(app.exec_()) 
```

或者您可以创建一个`Ui_MainWindow`实例：

```
import sys
from PyQt4 import QtGui
from test import Ui_MainWindow

class MyForm(QtGui.QMainWindow):
   def __init__(self, parent=None):
       QtGui.QWidget.__init__(self, parent)
       self.ui = Ui_MainWindow()    #note: instance, not the class
       self.ui.setupUi(self)

if __name__ == "__main__":
    app = QtGui.QApplication(sys.argv)
    myapp = MyForm()
    myapp.show()
    sys.exit(app.exec_()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:31:24.990

正如@Bakuriu 所说，你想要

```
self.ui = Ui_MainWindow() 
```

， 不是

```
self.ui = Ui_MainWindow 
```

. 您当前正在将类本身分配给 self.ui，而不是创建该类的实例。因此，调用不是“绑定”到成员，而是未绑定（尝试对整个类进行操作）。

# c# - 需要配置具有相同约束的 ASP.NET MVC 路由

> ID：12277053
> 
> 赞同：0
> 
> 时间：2012-09-05T08:06:07.343
> 
> 标签：c#, .net, asp.net-mvc

我需要这样的路线：
`http://localhost/{productName}/{featureName}`
where `productName = productId + URL friendly product name`，例如 1-some-product-name 和`featureName = featureId + URL friendly feature name`，例如 1-some-feature-name

为了实现这一点，我编写了以下路线：

```
routes.MapRoute(
            name: "ConcreteFeatureRoute",
            url: "{productName}/{featureName}",
            defaults: new { controller = "Feature", action = "FeatureDetails" },
            constraints: new { productName = @"\d+?-[^/]*", featureName = @"\d+?-[^/]*" }
        ); 
```

但结果我得到了`System.InvalidOperationException: No route in the route table matches the supplied values.`
如何通过路由配置实现这一点？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T11:12:49.520

需要使用一个静态关键字找到指定的url

# java - WebSphere 8.0.0.3 上的 MyFaces 2.1.8 项目

> ID：12277054
> 
> 赞同：0
> 
> 时间：2012-09-05T08:06:14.143
> 
> 标签：java, jsf, exception, websphere

我需要在 WebSphere Application Server 8.0.0.3 上运行我的 Java EE 6 项目。服务器支持 Apache MyFaces 2.0。

当我使用服务器库时，部署工作正常，但我的应用程序有一些错误。因此我使用 Apache MyFaces 2.1.8。我将 api 和 impl 放在我的 WEB-INF/lib/ 目录中。我还配置了我的 WAS parent_last 和 jsf-implementation SUNRI1.2。

当我部署我的项目时，我得到以下异常：

```
[9/5/12 9:18:55:716 CEST] 00000012 config        I   Initializing Sun's JavaServer Faces implementation (1.2_07-b03-FCS) for context '/mycontext'
[9/5/12 8:18:55:835 CEST] 00000009 DefaultFacesC I   Reading standard config META-INF/standard-faces-config.xml
[9/5/12 8:18:57:815 CEST] 00000009 LogMetaInfUti I   Artifact 'myfaces-api' was found in version '2.1.8' from path 'file:MyProject.ear/Project.war/WEB-INF/lib/myfaces-api-2.1.8.jar'
[9/5/12 8:18:57:816 CEST] 00000009 LogMetaInfUti I   Artifact 'myfaces-impl' was found in version '2.1.8' from path 'file:MyProject.ear/Project.war/WEB-INF/lib/myfaces-impl-2.1.8.jar'
[9/5/12 8:18:57:816 CEST] 00000009 AbstractFaces E   An error occured while initializing MyFaces: javax.faces.context.ExceptionHandlerFactory
                                 java.lang.IllegalArgumentException: javax.faces.context.ExceptionHandlerFactory
        at javax.faces.FactoryFinder.validateFactoryName(FactoryFinder.java:655)
        at javax.faces.FactoryFinder.setFactory(FactoryFinder.java:301)
        at org.apache.myfaces.config.FacesConfigurator.setFactories(FacesConfigurator.java:498)
        at org.apache.myfaces.config.FacesConfigurator.configureFactories(FacesConfigurator.java:473)
        at org.apache.myfaces.config.FacesConfigurator.configure(FacesConfigurator.java:418)
        at org.apache.myfaces.webapp.AbstractFacesInitializer.buildConfiguration(AbstractFacesInitializer.java:338)
        at org.apache.myfaces.webapp.Jsp21FacesInitializer.initContainerIntegration(Jsp21FacesInitializer.java:73)
        at org.apache.myfaces.webapp.AbstractFacesInitializer.initFaces(AbstractFacesInitializer.java:140)
        at org.apache.myfaces.webapp.StartupServletContextListener.contextInitialized(StartupServletContextListener.java:119)
        at com.ibm.ws.webcontainer.webapp.WebApp.notifyServletContextCreated(WebApp.java:1651)
        at com.ibm.ws.webcontainer.webapp.WebAppImpl.initialize(WebAppImpl.java:410)
        at com.ibm.ws.webcontainer.webapp.WebGroupImpl.addWebApplication(WebGroupImpl.java:88)
        at com.ibm.ws.webcontainer.VirtualHostImpl.addWebApplication(VirtualHostImpl.java:169)
        at com.ibm.ws.webcontainer.WSWebContainer.addWebApp(WSWebContainer.java:749)
        at com.ibm.ws.webcontainer.WSWebContainer.addWebApplication(WSWebContainer.java:634)
        at com.ibm.ws.webcontainer.component.WebContainerImpl.install(WebContainerImpl.java:422)
        at com.ibm.ws.webcontainer.component.WebContainerImpl.start(WebContainerImpl.java:714)
        at com.ibm.ws.runtime.component.ApplicationMgrImpl.start(ApplicationMgrImpl.java:1160)
        at com.ibm.ws.runtime.component.DeployedApplicationImpl.fireDeployedObjectStart(DeployedApplicationImpl.java:1369)
        at com.ibm.ws.runtime.component.DeployedModuleImpl.start(DeployedModuleImpl.java:638)
        at com.ibm.ws.runtime.component.DeployedApplicationImpl.start(DeployedApplicationImpl.java:967)
        at com.ibm.ws.runtime.component.ApplicationMgrImpl.startApplication(ApplicationMgrImpl.java:766)
        at com.ibm.ws.runtime.component.ApplicationMgrImpl.start(ApplicationMgrImpl.java:2153)
        at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.start(CompositionUnitMgrImpl.java:445)
        at com.ibm.ws.runtime.component.CompositionUnitImpl.start(CompositionUnitImpl.java:123)
        at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.start(CompositionUnitMgrImpl.java:388)
        at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.access$500(CompositionUnitMgrImpl.java:116)
        at com.ibm.ws.runtime.component.CompositionUnitMgrImpl$CUInitializer.run(CompositionUnitMgrImpl.java:994)
        at com.ibm.wsspi.runtime.component.WsComponentImpl$_AsynchInitializer.run(WsComponentImpl.java:349)
        at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1659)

[9/5/12 8:18:57:823 CEST] 00000009 StartupServle I   MyFaces already initialized 
```

我的面孔配置是空的。

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T11:21:11.043

设置 WarClassloader 父级最后解决了这个问题。另一种方式是共享库。

# javascript - 如何强制即时更改的 html 标题立即显示？

> ID：12277059
> 
> 赞同：0
> 
> 时间：2012-09-05T08:06:39.137
> 
> 标签：javascript, html, title

我想要做的是这样：当将光标移动到div的左半部分时，将其标题设置为“上一个”，当移动到右半部分时，将其标题设置为“下一个”。这很容易做到，但是问题是当光标第一次进入右半部分时，悬停一会儿，显示标题然后移动到左半部分，标题设置为“上一个”，但它永远不会显示，然后将光标移回右边，标题不再显示。我不想重新加载页面，我该如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T10:13:43.183

我不确定您到底想要什么，因为您对信息有点缺乏，例如将标题放在哪个元素上（即它是 div 上的标题属性还是其他东西，还是只是 HTML 标题元素？这是非常模棱两可的）。此外，您没有向我们提供您的代码，因此我们无法使用它。

我为标题属性编写了这个[jsfiddle](http://jsfiddle.net/qmbVH/)，因为这似乎更有可能。但是，我不知道该放在哪个元素上，所以我只使用了 jQuery 中的 html() 函数。不过，这将非常容易改变。

我 100% 肯定这可以用更少的代码行和更少的 jQuery 函数来完成。事实上，它甚至可以单独使用 CSS3 完成。

享受！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:37:34.423

我一直无法更改`title`jsFiddle 中的（可能是因为代码在框架内运行），所以我将在此处发布我的测试页面。

我试图完全按照您的描述进行操作，并且效果很好。标题立即更改。在 Opera、FireFox 和 Chrome 中测试。您可以将其与您的代码进行比较，看看您在做什么不同。

```
<html>
  <head>
    <title>Initial title</title>

    <style>
      body, html {
        height: 100%;
      }
    </style>

    <script>
      function foo(event) {
        if (event.pageX * 2 > document.body.clientWidth)
          document.title = 'NEXT';
        else
          document.title = 'PREVIOUS';
      }
    </script>
  </head>

  <body>
    <script>
      document.body.onmousemove = foo;
    </script>
  </body>
</html> 
```

# css - 具有 1 个绝对宽度浮动和 1 个相对浮动的相对宽度容器

> ID：12277060
> 
> 赞同：1
> 
> 时间：2012-09-05T08:06:43.490
> 
> 标签：css, layout, html

我已经阅读了很多答案，但不确定为什么它对我不起作用。也许它与父容器不是 100% 有关？事情是......我也尝试过填充，但存在同样的问题。

我也尝试过 container=width:100%，并在浮动 div 中创建带有边距的 10% 空间，但创建的 10% 的比例很奇怪……绝对与页面不成比例。

这是代码。

```
.container{
width:80%;
overflow:hidden;
margin-right:auto;
margin-left:auto;
}

.side{
width:300px;float:left;}

.main{
position:absolute;  float:left;  }

.clear{clear: both;} 
```

（没有绝对，两个 div 不再并排......但我看到人们在这里使用相对 ????）

这是html

```
<div class="container">
  <div class="side"></div>
  <div class="main"></div>
  <div class="clear"></div>
</div> 
```

所以现在的问题是，由于某种原因，div“main”不会填满剩余空间，但里面的文本要么在到达“容器”的边界之前停止，要么完全忽略容器并延伸到页面之外...

**我想保留两侧的空白边距，并且需要浮动 div 之一是固定宽度...不知道为什么它不工作**

....我觉得有一个简单的解决方案我只是想不直...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:11:08.220

像这样尝试：

```
.container {
width:100%; / width: 300px;
overflow: hidden;
position: relative;
margin-right: auto;
margin-left: auto;
}

.side {
width: 60%;
float: left;
}

.main {
width: 40%;
float: left;  
}

.clear {
clear: both;
} 
```

在`.container`选择宽度 % 或 px 的...什么对你来说更灵活

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:11:35.493

首先，您要实现的目标不是很清楚。您是否要在页面上重新排列 HTML 以实现可访问性？

首先，要让 .main 留在 .container 中，请将其放在 .container 中：

```
position:relative; 
```

那么也许你正试图将 main 浮动到右侧..把它放在 .main

```
left:300px; 
```

希望我猜对了你的意图..

# c++ - 错误需要指导

> ID：12277062
> 
> 赞同：-1
> 
> 时间：2012-09-05T08:06:54.497
> 
> 标签：c++, error-handling

需要帮助，请指导我。如何解决如下所述的错误？

> *   30:24:error:expected ')' before ',' 标记
>     
>     
> *   在成员函数'int Address::compareTo(const Address&)'中：
>     
>     
> *   41:26:error:'std::string' 没有名为 'compareTo' 的成员

```
 #include<iostream>
    using namespace std;

    class Address {
      int    houseNumber;
      string street;
      int    apartmentNumber;
      string city;
      string state;
      string zipCode; // e.g., "47405-1234"
      Address(int houseNumber, 
              string street, 
              // no apartmentNumber  
              string city, 
              string state, 
              string zipCode) { 
        this->houseNumber = houseNumber; 
        this->street = street; 
        this->city = city; 
        this->state = state; 
        this->zipCode = zipCode; 
      } 
      Address(int houseNumber, 
              string street, 
              int apartmentNumber, 
              string city, 
              string state, 
              string zipCode) { 
        this(houseNumber, street, city, state, zipCode);
        this->apartmentNumber = apartmentNumber; 
      } 
      void print(void) {
             std::cout << "Street: " << street << "\nCity: " 
                 << city << "\nState: " << state << "\nPostal Code: " << zipCode;
    }

      int compareTo(const Address &a) { 
        // same conventions as for Strings
        return this->zipCode.compareTo(a); 
      }
    }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:09:04.367

您正在寻找的功能是[`compare`](http://www.cplusplus.com/reference/string/string/compare/)，而不是`compareTo`（Java，C# 任何人）？

另外，请注意，这`angle`未在您的范围内声明。你的意思是：

```
return this->zipCode.compare("angel"); 
```

还是您只是省略了变量？

您还（“应该”在适用的情况下）：

*   不需要`this->`
*   作为`compare`您可以使用的替代方法`==`（这返回`true`相等）
*   `print`并`compareTo`应标记为`const`
*   在构造函数中使用成员初始化列表
*   `using namespace std;`从标题中删除
*   分离源文件中的实现
*   对标头使用包含防护
*   适当的缩进
*   通过...将`string`参数传递给构造函数`const &`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T08:27:00.103

> 30:24:error:expected ')' before ',' 标记

你有

```
this(houseNumber, street, city, state, zipCode); 
```

这是胡说八道；`this`是指向正在构造的对象的指针，而不是函数。

据推测，您正在尝试调用另一个构造函数来初始化一些数据成员。在 C++11 中，您可以委托给另一个构造函数，尽管我不知道是否有任何编译器支持它。这必须在初始化列表中完成，而不是在构造函数主体中完成：

```
Address(/*args*/) : Address(/*other args*/), apartmentNumber(apartmentNumber) {} 
```

如果这不起作用，那么您将不得不在两个构造函数中复制初始化，或者将它们移动到一个成员函数中并从两个构造函数中调用它。

您也可以考虑省略构造函数并使用聚合初始化：

```
Address address = {
    123, "Fake Street", /* and so on */
}; 
```

尽管您应该只对仅保存数据而没有要建立的类不变量的类执行此操作。

> 41:26:error:'std::string' 没有名为 'compareTo' 的成员

正如错误所说`compareTo`，`std::string`. 但是，有一个成员叫`compare`. 假设您的评论暗示您想要与 Java 相同的行为`String.compareTo`，那么这就是您想要的。

`==`然而，在 C++ 中，通过覆盖比较运算符（ 、`<`等）来使对象具有可比性更为常见；这样做可以更方便地使用标准算法以及使用类似习语的其他代码。您可能想要考虑做这种事情，而不是尝试使用其他语言的习语。

# sharepoint - SPListItem 生命周期

> ID：12277064
> 
> 赞同：0
> 
> 时间：2012-09-05T08:07:01.527
> 
> 标签：sharepoint, lifecycle, splistitem

我想对列表项生命周期提供一些帮助。我可以阅读有关此内容的任何链接吗？

我需要知道的主要事情是，在事件接收器中有如下方法：

1.  项目添加
2.  添加项目
3.  物品更新
4.  物品已更新

工作流程从哪里开始？如何停止更新过程并仅使用 systemupdate 更新某些字段并且不触发任何错误？ **我需要的是更新一些没有新版本且没有工作流开始的字段。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:59:41.380

您应该能够使用（在您的事件接收器中）：

```
base.EventFiringEnabled = false;
//Do some changes to the list item
item.SystemUpdate();
base.EventFiringEnabled = true; 
```

该线程还讨论了这个[http://social.msdn.microsoft.com/forums/en-US/sharepointdevelopment/thread/46e0a519-c580-46e3-92b7-c40765ed0e52](http://social.msdn.microsoft.com/forums/en-US/sharepointdevelopment/thread/46e0a519-c580-46e3-92b7-c40765ed0e52)

# java - Java & RabbitMQ - 队列 & 多线程 - 或 Couchbase 作为作业队列

> ID：12277067
> 
> 赞同：10
> 
> 时间：2012-09-05T08:07:05.423
> 
> 标签：java, multithreading, mongodb, rabbitmq, couchbase

我有一个`Job Distributor`在不同的网站上发布消息的人`Channels`。

此外，我希望有两个（以及未来更多）`Consumers`从事不同的任务并在不同的机器上运行。（目前我只有一个，需要扩展它）

让我们为这些任务命名（只是示例）：

*   `FIBONACCI`（生成斐波那契数）
*   `RANDOMBOOKS`（生成随机句子来写一本书）

这些任务最多运行 2-3 个小时，**应该平均分配给每个`Consumer`**.

每个消费者都可以有`x` **并行**线程来处理这些任务。所以我说：（这些数字只是示例，将被变量替换）

*   机器 1 可以消耗 3 个**并行**作业`FIBONACCI`和 5 个**并行**作业`RANDOMBOOKS`
*   机器 2 可以消耗 7个**并行**作业`FIBONACCI`和 3 个**并行**作业`RANDOMBOOKS`

我怎样才能做到这一点？

我是否必须`x`为每个线程启动每个线程`Channel`才能收听`Consumer`？

我什么时候必须承认这一点？

我目前的唯一方法`Consumer`是：为每个任务启动`x`线程 - 每个线程都是一个 Defaultconsumer 实现`Runnable`。在`handleDelivery`方法中，我打电话`basicAck(deliveryTag,false)`然后做工作。

进一步：我想将一些任务发送给一个特殊的消费者。如何结合上述公平分配来实现这一目标？

这是我的代码`publishing`

```
String QUEUE_NAME = "FIBONACCI";

Channel channel = this.clientManager.getRabbitMQConnection().createChannel();

channel.queueDeclare(QUEUE_NAME, true, false, false, null);

channel.basicPublish("", QUEUE_NAME,
                MessageProperties.BASIC,
                Control.getBytes(this.getArgument()));

channel.close(); 
```

这是我的代码`Consumer`

```
public final class Worker extends DefaultConsumer implements Runnable {
    @Override
    public void run() {

        try {
            this.getChannel().queueDeclare(this.jobType.toString(), true, false, false, null);
            this.getChannel().basicConsume(this.jobType.toString(), this);

            this.getChannel().basicQos(1);
        } catch (IOException e) {
            // catch something
        }
        while (true) {
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                Control.getLogger().error("Exception!", e);
            }

        }
    }

    @Override
    public void handleDelivery(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, byte[] bytes) throws IOException {
        String routingKey = envelope.getRoutingKey();
        String contentType = properties.getContentType();
        this.getChannel().basicAck(deliveryTag, false); // Is this right?
        // Start new Thread for this task with my own ExecutorService

    }
} 
```

在这种情况下，课程`Worker`开始了两次：一次为`FIBUNACCI`一次，一次为`RANDOMBOOKS`

**更新**

正如答案所述，RabbitMQ 不是最好的解决方案，但 Couchbase 或 MongoDB 拉取方法是最好的。我是这些系统的新手，有没有人可以向我解释，这将如何实现？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-16T22:43:01.483

这是我将如何在 couchbase 上构建它的概念视图。

1.  您有一些机器来处理工作，并且有一些机器（可能是相同的机器）创建工作要做。
2.  您可以在 couchbase 的存储桶中为每个作业创建一个文档（如果您将其与该存储桶中的其他数据混合，则将其类型设置为“作业”或其他内容）。
3.  每个工作描述，连同要完成的具体命令，可能包括它的创建时间、到期时间（如果有特定的到期时间）和某种生成的工作价值。这个工作值可以是任意单位。
4.  每个工作的消费者都会知道它一次可以做多少个工作单元，以及有多少可用（因为其他工人可能正在工作。）
5.  因此，一台具有 10 个工作单元容量且有 6 个工作单元正在完成的机器将执行查询以查找 4 个或更少工作单元的工作。
6.  在 couchbase 中，有一些视图是增量更新的 map/reduce 作业，我认为您在这里只需要 map 阶段。您将编写一个视图，让您查询到期时间、输入系统的时间和工作单元的数量。这样你就可以得到“4个工作单位或更少的最迟到的工作”。
7.  这种查询，随着容量的释放，将首先获得过期最多的工作，尽管您可以获得最大的过期工作，如果没有，那么最大的未过期工作。（其中“逾期”是当前时间与作业截止日期之间的差值。）
8.  Couchbase 视图允许像这样非常复杂的查询。虽然它们是增量更新的，但它们并不是完全实时的。因此，您不会寻找一份工作，而是一份求职者名单（按您的意愿排序。）
9.  因此，下一步是获取职位候选人列表并检查第二个位置 - 可能是锁定文件的 membase 存储桶（例如：RAM 缓存，非持久性）。锁定文件将有多个阶段（在这里，您使用 CRDT 或最适合您需要的任何方法进行一些分区解析逻辑。）
10.  由于此存储桶是基于 ram 的，因此它比视图更快，并且与总状态的延迟更少。如果没有锁定文件，则创建一个状态标志为“临时”的文件。
11.  如果另一个工作人员获得相同的工作并看到锁定文件，那么它可以跳过该工作候选人并执行列表中的下一个工作。
12.  如果，不知何故，两个工人试图为同一个工作创建锁定文件，就会发生冲突。在发生冲突的情况下，您可以平底船。或者，您可以有逻辑，其中每个工作人员对锁定文件进行更新（CRDT 解析，因此使这些幂等，以便可以合并兄弟姐妹）可能放入一个随机数或某个优先级数字。
13.  在指定的时间段（可能是几秒钟）后，锁文件由工作人员检查，如果它没有进行任何竞争解决更改，它会将锁文件的状态从“临时”更改为“已采取” "
14.  然后，它使用“已接受”或类似的状态更新工作本身，以便当其他工作人员正在寻找可用工作时它不会出现在视图中。
15.  最后，您需要添加另一个步骤，在执行查询以获取我上面描述的这些求职者之前，您执行一个特殊查询以查找已采取的工作，但所涉及的工人已经死亡。（例如：过期的工作）。
16.  知道工人何时死亡的一种方法是，放入 membase 存储桶中的锁定文件应该有一个到期时间，这将导致它最终消失。可能这个时间很短，工作人员只需触摸它即可更新到期时间（这在 couchbase API 中得到支持）
17.  如果一个工人死了，最终它的锁文件会消失，孤立的工作将被标记为“已接受”但没有锁文件，这是寻找工作的工人可以寻找的条件。

所以总而言之，每个工作人员都会查询孤立的作业，如果有的话，依次检查是否有锁文件，如果没有，则创建一个，并遵循上述正常的锁定协议。如果没有孤立的作业，那么它会查找过期作业，并遵循锁定协议。如果没有过期的作业，那么它只取最旧的作业并遵循锁定协议。

当然，如果您的系统没有“过期”之类的东西，这也将起作用，并且如果及时性无关紧要，那么您可以使用另一种方法来代替最旧的工作。

另一种方法可能是在 1-N 之间创建一个随机值，其中 N 是一个相当大的数字，例如工人数量的 4 倍，并用该值标记每个工作。每次工人去寻找工作时，它都可以掷骰子，看看是否有任何具有该编号的工作。如果没有，它将再次这样做，直到找到具有该号码的工作。这样，与其让多个工作人员争夺少数“最旧”或最高优先级的工作，而且更有可能发生锁争用，不如将它们分散开来……以队列中的时间为代价，比先进先出的情况更随机.

随机方法也可以应用于必须适应负载值的情况（这样单台机器不会承担太多负载），而不是采用最旧的候选者，而是从列出可行的工作并尝试去做。

**编辑添加：**

在第 12 步中，我说“可能放入一个随机数”，我的意思是，如果工人知道优先级（例如：哪个人最需要做这项工作），他们可以将代表这个的数字放入文件中。如果没有“需要”这份工作的概念，那么他们都可以掷骰子。他们用他们的骰子角色更新这个文件。然后他们两个都可以看看它，看看对方滚了什么。如果他们输了，他们就会下注，而其他工人知道它有它。通过这种方式，您可以在没有大量复杂协议或协商的情况下解决哪个工人接受工作。我假设两个工作人员都在这里访问同一个锁文件，它可以通过两个锁文件和一个找到所有锁文件的查询来实现。如果经过一段时间后，

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-13T23:45:22.947

首先让我说我没有使用 Java 与 RabbitMQ 通信，所以我无法提供代码示例。但是，这应该不是问题，因为这不是您要问的。这个问题更多的是关于您的应用程序的一般设计。

让我们分解一下，因为这里有很多问题。

## 将任务分配给不同的消费者

这样做的一种方法是使用循环，但这是相当粗糙的，并且没有考虑到不同的任务可能需要不同的时间来完成。那么该怎么办。这样做的一种方法是将 设置`prefetch`为`1`。预取意味着消费者将消息缓存在本地（**注意：**消息尚未被消费）。通过将此值设置为 1，不会发生预取。这意味着您的消费者只会知道并且只有它当前正在处理的消息在内存中。这使得只有在工作人员空闲时才接收消息成为可能。

## 何时确认

通过上述设置，可以从队列中读取消息，将其传递给您的线程之一，然后确认消息。对所有可用线程执行此操作 -1。您不想确认最后一条消息，因为这意味着您将打开以接收另一条您无法传递给您的工作人员的消息。当其中一个线程完成时，即是您确认该消息的时间，这样您的线程将始终与某些东西一起工作。

## 传递特殊信息

这取决于你不想做什么，但总的来说，我会说你的制作人应该知道他们在传递什么。这意味着您可以将它发送到某个交换器，或者更确切地说，使用某个路由键将这个消息传递到一个适当的队列，该队列将有一个消费者听它，知道如何处理该消息。

我建议您阅读 AMQP 和 RabbitMQ，这可能是一个很好的[起点](http://www.rabbitmq.com/tutorials/amqp-concepts.html)。

### 警告

我的提议和您的设计中存在一个重大缺陷，那就是`ACK`我们在实际处理完消息之前就已发送消息。这意味着当（不是如果）我们的应用程序崩溃时，我们无法重新创建`ACKed`消息。如果您事先知道要启动多少个线程，则可以解决此问题。我不知道您是否可以动态更改预取计数，但不知何故我对此表示怀疑。

### 一些想法

从我对 RabbitMQ 的经验来看，你不应该害怕创建交换和队列，如果做得正确，这些可以极大地改进和简化你的应用程序设计。也许你不应该有一个启动一堆消费者线程的应用程序。相反，您可能希望有某种包装器，它根据系统中的可用内存或类似的东西启动消费者。如果您这样做，您可以确保在您的应用程序崩溃时不会丢失任何消息，因为如果您这样做，您当然会在完成消息时确认该消息。

### 推荐阅读

*   [RabbitMQ 教程](http://www.rabbitmq.com/getstarted.html)
*   [了解 AMQP](http://blog.springsource.org/2010/06/14/understanding-amqp-the-protocol-used-by-rabbitmq/)

如果有什么不清楚的地方或者我错过了你的观点，请告诉我，如果可以的话，我会尝试扩展我的答案或改进它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-14T00:26:54.747

以下是我对你的问题的看法。正如@Daniel 在他的回答中提到的那样，我相信这更多的是架构原则问题而不是实现问题。一旦架构清晰，实现就变得微不足道。

首先，我想解决一些与调度理论有关的问题。您在这里有非常长时间运行的任务，如果没有以正确的方式安排它们，您将 (a) 最终以低于满负荷运行您的服务器或 (b) 完成任务的时间比其他方式可能要长得多. 所以，我有一些与你的调度范式有关的问题：

1.  你有能力估计每项工作需要多长时间吗？
2.  这些工作是否有与之相关的截止日期，如果有，它是如何确定的？

### RabbitMQ 在这种情况下是否合适？

我不相信 RabbitMQ 是调度极其长时间运行的作业的正确解决方案。事实上，我认为您之所以会遇到这些问题，是因为 RabbitMQ 不是适合这项工作的工具。默认情况下，在将作业从队列中删除以确定接下来应该处理哪些作业之前，您对作业没有足够的了解。其次，正如@Daniel 的回答中所提到的，您可能无法使用内置的 ACK 机制，因为每当与 RabbitMQ 服务器的连接失败时，重新排队的作业可能会很糟糕。

相反，我会寻找诸如 MongoDB 或 Couchbase 之类的东西来存储您的“队列”作业。然后，您可以完全控制调度逻辑，而不是依赖 RabbitMQ 强制执行的内置循环。

### 其他注意事项：

> 此外，我希望有两个（以及将来更多）从事不同任务并在不同机器上运行的消费者。（目前我只有一个，需要扩展它）

在这种情况下，我认为您不想使用基于推送的消费者。相反，使用基于拉取的系统（在 RabbitMQ 中，这将被称为 Basic.Get）。通过这样做，您将负责作业调度

> 消费者 1 有 3 个 FIBONACCI 线程和 5 个 RANDOMBOOKS 线程。消费者 2 有 7 个 FIBONACCI 线程和 3 个 RANDOMBOOKS 线程。我怎样才能做到这一点？

在这种情况下，我不确定我是否理解。您是否有`fibonacci`一份工作，并且您正在以某种方式在您的服务器上并行执行它？还是您希望您的服务器同时执行许多`fibonacci`作业？假设是后者，您将创建线程以在服务器上完成工作，然后将作业分配给它们，直到所有线程都已满。当一个线程可用时，您将轮询队列以启动另一个作业。

您的其他问题：

> *   我是否必须为每个 Channel 启动 x Threads 才能监听每个 Consumer ？
> *   我什么时候必须承认这一点？
> *   我目前只针对一个消费者的方法是：为每个消费者启动 x 个线程
> *   任务 - 每个线程都是实现 Runnable 的 Defaultconsumer。在handleDelivery 方法中，我调用了basicAck(deliveryTag,false) 然后进行工作。
> *   进一步：我想将一些任务发送给一个特殊的消费者。如何结合上述公平分配来实现这一目标？

我相信，一旦您将调度责任从 RabbitMQ 服务器转移到您的个人消费者身上，上述问题将不再是问题（消费者，我的意思是消费线程）。此外，如果您使用更多由数据库驱动的东西（例如 Couchbase），您将能够自己编程这些东西，并且您可以完全控制逻辑。

### 使用沙发底座

虽然如何将 Couchbase 用作队列的详细说明超出了此问题的范围，但我可以提供一些建议。

*   首先，您需要阅读[Couchbase](http://www.couchbase.com/couchbase-server/overview)
*   我建议将作业存储在 Couchbase 存储桶中，并依靠索引视图列出可用作业。如何为每个作业定义密钥有很多选项，但作业本身需要序列化为 JSON。也许使用[ServiceStack.Text](http://www.servicestack.net/)
*   当一个作业被拉出来进行处理时，需要一些逻辑来标记作业在 Couchbase 中的状态。您将需要使用一种[`CAS`方法](http://www.couchbase.com/docs/couchbase-devguide-2.0/cb-cas.html)来确保其他人没有在您拥有的同一时间接受该工作进行处理。
*   您将需要某种策略来清除队列中失败和已完成的作业。

### 概括

1.  不要为此使用 RabbitMQ
2.  使用每个作业的参数提出智能调度算法。一旦我对你的工作性质有了更多的了解，我就可以帮助你。
3.  根据 #2 中的算法将作业拉入工作人员，而不是从服务器推送它们。
4.  想出自己的方式来跟踪整个系统中的作业状态（排队、运行、失败、成功等）以及何时/是否重新调度停滞的作业。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T09:21:32.170

如果正在使用 spring 或者愿意使用 spring，那么你可以使用 spring listener 容器支持来实现它。这将为您提供您正在寻找的类似回调类型的编程模型。

[Spring AMQP 参考文档](http://static.springsource.org/spring-amqp/reference/html/amqp.html#d4e201)中的示例代码

```
@Configuration
public class ExampleAmqpConfiguration {

    @Bean
    public MessageListenerContainer messageListenerContainer() {
        SimpleMessageListenerContainer container = new SimpleMessageListenerContainer();
        container.setConnectionFactory(rabbitConnectionFactory());
        container.setQueueName("some.queue");
        container.setMessageListener(exampleListener());
        return container;
    }

    @Bean
    public ConnectionFactory rabbitConnectionFactory() {
        CachingConnectionFactory connectionFactory = new CachingConnectionFactory("localhost");
        connectionFactory.setUsername("guest");
        connectionFactory.setPassword("guest");
        return connectionFactory;
    }

    @Bean
    public MessageListener exampleListener() {
        return new MessageListener() {
            public void onMessage(Message message) {
                System.out.println("received: " + message);
            }
        };
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T10:38:26.507

最近我推送了分支 bug18384，它改变了将回调发送到消费者实现的方式。

在此更改之后，Connection 维护了一个调度线程，用于向消费者发送回调。这释放了消费者调用 Connection 和 Channel 上的阻塞方法。

Twitter 上出现了一个关于如何使这个可配置的问题，允许将自定义 Executor 插入 ConnectionFactory。我想概述为什么这很复杂，讨论一个可能的实现，看看是否有很多兴趣。

首先，我们应该确定每个消费者应该只在一个线程中接收回调。如果不是这种情况，那么混乱将会接踵而至，消费者将需要担心他们自己的线程安全，而不是初始化安全。

所有消费者只有一个调度线程，这种消费者线程配对很容易得到尊重。

当我们引入多线程时，我们要保证每个Consumer只与一个线程配对。使用 Executor 抽象时，这可以防止每个回调调度被包装在 Runnable 中并发送到 Executor，因为您无法保证将使用哪个线程。

为了解决这个问题，可以将 Executor 设置为运行“n”个长时间运行的任务（n 是 Executor 中的线程数）。这些任务中的每一个都从队列中提取调度指令并执行它们。每个消费者都与一个调度指令队列配对，可能是循环分配的。这并不太复杂，并且会在 Executor 中的线程之间提供简单的调度负载平衡。

现在，仍然存在一些问题：

1.  Executor 中的线程数不一定是固定的（与 ThreadPoolExecutor 一样）。
2.  没有办法，通过 Executor 或 ExecutorService 找出有多少线程。因此，我们无法知道要创建多少个调度指令队列。

但是，我们当然可以引入 ConnectionFactory.setDispatchThreadCount(int)。在幕后，这将创建一个 Executors.newFixedThreadPool() 以及正确数量的调度队列和调度任务。

我很想知道是否有人认为我忽略了解决这个问题的一些更简单的方法，事实上这是否值得解决。

# php - 谷歌登录 oauth2 每次都重新请求访问

> ID：12277075
> 
> 赞同：6
> 
> 时间：2012-09-05T08:07:36.063
> 
> 标签：php, oauth-2.0, google-signin

我正在尝试将 google oauth2 api 用于我的登录系统。它几乎可以工作了，用户可以访问我的 Web 应用程序，我阅读信息并连接用户。问题是，一旦他们离开或更换浏览器，回到我的网站，他们会再次被要求授予访问权限。

我不需要离线访问，因为除了签入用户之外，我没有使用任何 API 调用。无论如何，我被困住了，需要一些帮助！

我正在使用 google php 库（https://code.google.com/p/google-api-php-client/wiki/OAuth2），我什至将 ApprovalPrompt 设置为自动。仍然没有运气。

我的代码：

```
public function googleLogin()
{
    $this->set('connect', "Google login");
    $client = new apiClient();
    $client->setApprovalPrompt('auto');
    $client->setApplicationName("Authentication");
    $client->setClientId(G_OAUTH2_APP_ID);
    $client->setClientSecret(G_OAUTH2_SECRET);
    $client->setRedirectUri(G_REDIRECT_URI);
    $client->setDeveloperKey(G_DEV_KEY);
    $oauth2 = new apiOauth2Service($client);

    if (isset($_GET['code'])) {
        $client->authenticate();
        $_SESSION['token'] = $client->getAccessToken();
        $redirect = 'http://' . $_SERVER['HTTP_HOST'] . $_SERVER['PHP_SELF'];
        header('Location: ' . filter_var($redirect, FILTER_SANITIZE_URL));

    }

    if (isset($_SESSION['token'])) {
        $client->setAccessToken($_SESSION['token']);
    }

    if (isset($_REQUEST['logout'])) {
        unset($_SESSION['token']);
        $client->revokeToken();
    }
    //print_r($client->getAccessToken()); exit;

    if ($client->getAccessToken()) {
        $user = $oauth2->Guserinfo->get();

        // These fields are currently filtered through the PHP sanitize filters.
        // See http://www.php.net/manual/en/filter.filters.sanitize.php
        //$email = filter_var($user['email'], FILTER_SANITIZE_EMAIL);
        //$img = filter_var($user['picture'], FILTER_VALIDATE_URL);

        // The access token may have been updated lazily.
        $_SESSION['token'] = $client->getAccessToken();

        //do stuff with user data
        $data = $this->linkUser($user, "google");
        if ($data['state']=="createUser") {
            $this->set("data",$data);
        }

    } else {
        $authUrl = $client->createAuthUrl();
        header("Location: " . $authUrl);
    }
} 
```

**编辑：** 我添加了`$client->setAccessType("online");` 我不知道的行，如果这是我唯一需要做的事情，或者如果我在浏览器/操作系统之间有错误：上次我尝试使用 lion/chrome 它没有工作但在 w7/firefox 上没关系。好吧，否则我只是失去理智：p

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-08T10:14:44.263

关于这里的另一个问题：[Google API - 每次都强制授予权限](https://stackoverflow.com/questions/10851358/google-api-forces-to-grant-permission-every-time)

有人指出你可以这样做：

`$client->setApprovalPrompt('auto');`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-11T23:16:21.617

我有一个类似的问题，似乎解决了消除 $client->revokeToken()，在登录之前移动注销的东西。

我不知道避免使令牌无效是否是一个有效的想法，但它似乎有效。

试试这个：

```
public function googleLogin()
{
    $this->set('connect', "Google login");
    $client = new apiClient();
    $client->setApprovalPrompt('auto');
    $client->setApplicationName("Authentication");
    $client->setClientId(G_OAUTH2_APP_ID);
    $client->setClientSecret(G_OAUTH2_SECRET);
    $client->setRedirectUri(G_REDIRECT_URI);
    $client->setDeveloperKey(G_DEV_KEY);
    $oauth2 = new apiOauth2Service($client);

    // I moved the logout stuff here, without invalidating the token
    if (isset($_REQUEST['logout'])) {
        unset($_SESSION['token']);            
    }

    if (isset($_GET['code'])) {
        $client->authenticate();
        $_SESSION['token'] = $client->getAccessToken();
        $redirect = 'http://' . $_SERVER['HTTP_HOST'] . $_SERVER['PHP_SELF'];
        header('Location: ' . filter_var($redirect, FILTER_SANITIZE_URL));

    }

    if (isset($_SESSION['token'])) {
        $client->setAccessToken($_SESSION['token']);
    }

    /* // I solved getting this stuf commented
    if (isset($_REQUEST['logout'])) {
        unset($_SESSION['token']);
        $client->revokeToken();
    }*/
    //print_r($client->getAccessToken()); exit;

    if ($client->getAccessToken()) {
        $user = $oauth2->Guserinfo->get();

        // These fields are currently filtered through the PHP sanitize filters.
        // See http://www.php.net/manual/en/filter.filters.sanitize.php
        //$email = filter_var($user['email'], FILTER_SANITIZE_EMAIL);
        //$img = filter_var($user['picture'], FILTER_VALIDATE_URL);

        // The access token may have been updated lazily.
        $_SESSION['token'] = $client->getAccessToken();

        //do stuff with user data
        $data = $this->linkUser($user, "google");
        if ($data['state']=="createUser") {
            $this->set("data",$data);
        }

    } else {
        $authUrl = $client->createAuthUrl();
        header("Location: " . $authUrl);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T08:10:20.777

您必须保存用户第一次在数据库中授予对您的应用程序的访问权限时获得的刷新令牌，并将其重用于未来的请求。

Google Drive SDK 文档包含一个实现该流程的示例 PHP 应用程序，您可以将其用作参考：

[https://developers.google.com/drive/examples/php](https://developers.google.com/drive/examples/php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-13T19:11:02.120

设置离线访问。为每个经过身份验证的用户存储初始令牌和刷新令牌，然后无论用户从何处登录您的应用程序，他们都将始终连接到他们的 Google 帐户，即使他们没有直接登录到 Google，他们也会登录到 Google通过您的应用程序。

像上面一样，这在文档中有所介绍。

如果用户永远无法做到这一点，那么拥有 API 将毫无意义。此外，它与 cookie 和会话无关。将服务器 IP 添加到 Google 开发者控制台，就可以了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-05T08:11:27.500

我相信您的问题是您没有在用户计算机上存储任何 cookie。会话仅在用户访问网站期间存储信息。

这是关于 cookie 的一个很好的简单解释。希望能帮助到你。

[http://www.tizag.com/phpT/phpcookies.php](http://www.tizag.com/phpT/phpcookies.php)

# windows-xp - 未找到 Windows-XP ODBC 管理

> ID：12277082
> 
> 赞同：3
> 
> 时间：2012-09-05T08:08:01.513
> 
> 标签：windows-xp, odbc

在 Windows XP 和 7 中，可以通过 odbc-adminstrator-utility 管理 odbc 连接。可以通过设置/控制面板/访问 odbc-administrator。在我的 WindowsXP 计算机重新设置后，odbc-administrator 似乎消失了。有谁知道发生了什么以及如何找到或重新安装 odbc-administrator？

谢谢你的帮助。佐丹奴

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T08:11:29.547

试试这个：

开始菜单-> 执行（或 Win+r 快捷键）

然后写：

```
odbccp32.cpl 
```

并击中`Enter`

# ruby - 红宝石“-”到-或“+”到+

> ID：12277088
> 
> 赞同：1
> 
> 时间：2012-09-05T08:08:17.390
> 
> 标签：ruby

我实际上有这个简单的问题，但我找不到正确的答案。我想知道我怎么能做这样的事情：

```
 direction="-"
    value=17
    movement = direction value 
```

所以它会给我： motion=-17 我知道我可以使用 if 语句，但是如果有更快的方法将“-”转换为简单的-

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:16:00.243

您可以使用[`send`](http://ruby-doc.org/core-1.9.3/Object.html#method-i-send)

```
movement = 0.send(direction.to_sym, value) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T09:13:04.907

一元运算符在内部使用尾随`@`，因此：

```
direction = "-"
value = 17
movement = value.send(direction + "@")
#=> -17 
```

也就是说，IMO 这是不必要的复杂，一个简单的条件表达式（使用`?`）会更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T08:11:26.237

我这边的一个解决方案

```
direction = "-"
value = 17
movement = (direction + value.to_s).to_i 
```

它非常基本，没有使用任何复杂的东西，这可能会使它有点不干净，但至少表明只要知道 ruby​​ 中非常基本的操作就可以解决许多任务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T08:13:48.343

只需将方向设置为 -1 或 +1，即可乘以该值：

```
direction = -1
value = 17
movement = direction * value 
```

结果将是-17。

如果将方向设置为 1，则结果将为 17。因此，您可以使用两个方向，具体取决于您的方向值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-05T08:10:11.710

此解决方案中没有“如果”：

```
movement = (direction == "-") ? -value : value 
```

# google-app-engine - 如何在谷歌应用引擎中存储数据

> ID：12277090
> 
> 赞同：-1
> 
> 时间：2012-09-05T08:08:24.503
> 
> 标签：google-app-engine

我是 Google App Engine 的新手，我正在阅读此页面： [https ://developers.google.com/appengine/docs/java/datastore/queries](https://developers.google.com/appengine/docs/java/datastore/queries)

在这里，他们解释了如何从 dataStore 中检索数据：

```
 // Get the Datastore Service
   DatastoreService datastore = DatastoreServiceFactory.getDatastoreService();

      // The Query interface assembles a query
Query q = new Query("Person");

   //Use CompositeFilter to set more than one filter
    q.setFilter(CompositeFilterOperator.and(
 new FilterPredicate("lastName", Query.FilterOperator.EQUAL, lastNameParam),
 new FilterPredicate("height", Query.FilterOperator.LESS_THAN, maxHeightParam)));

    // PreparedQuery contains the methods for fetching query results
   // from the Datastore
    PreparedQuery pq = datastore.prepare(q);

  for (Entity result : pq.asIterable()) {
  String firstName = (String) result.getProperty("firstName");
   String lastName = (String) result.getProperty("lastName");
   Long height = (Long) result.getProperty("height");
   System.out.println(firstName + " " + lastName + ", " + height + " inches tall");
  } 
```

但是如何保存这个 data.where 以及这个 firstName 和 LastName 是如何保存在 DataStore 中的？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:45:55.460

您是否考虑阅读其他一些文档，例如链接在该文档上方的文档，该文档[准确地解释了要做什么](https://developers.google.com/appengine/docs/java/datastore/entities#Working_with_Entities)？

# java - “线程转储”是什么意思

> ID：12277091
> 
> 赞同：30
> 
> 时间：2012-09-05T08:08:28.597
> 
> 标签：java, multithreading

我想知道java线程转储是什么。有人可以帮我理解什么是线程转储以及它与正在运行的 java 程序的关系吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-09-05T08:10:05.320

Java 线程转储是一种找出 JVM 中的每个线程在特定时间点正在做什么的方法。如果您的 Java 应用程序在负载下运行时有时似乎挂起，这将特别有用，因为对转储的分析将显示线程卡在的位置。

`Unix/Linux`您可以通过运行来生成线程转储`kill -QUIT <pid>`，并`Windows`通过点击来生成线程转储`Ctl + Break`。

要了解如何从 JVM 获取线程转储，[请参见此处](https://helpx.adobe.com/in/experience-manager/kb/TakeThreadDump.html)

要了解如何创建线程转储，[请参见此处](http://www.webnms.com/webnms/help/developer_guide/troubleshooting_tips/creating_threaddump.html)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-05T08:10:56.173

来自[http://www.javasanity.org/understandingthreaddumps](http://www.javasanity.org/understandingthreaddumps)：

> 线程转储是某一时刻正在执行的确切内容的快照

有很多资源可以帮助您理解/分析线程转储（例如[http://www.javacodegeeks.com/2012/03/jvm-how-to-analyze-thread-dump.html](http://www.javacodegeeks.com/2012/03/jvm-how-to-analyze-thread-dump.html)）。

您可能还会发现以下问题很有用：[线程转储分析工具/方法](https://stackoverflow.com/q/3156434/851811)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T08:11:09.980

*“线程转储是当前在 Java 虚拟机 (JVM) 中活动的所有 Java 线程的列表。”* （[链接](http://dev.day.com/content/kb/home/cq5/CQ5SystemAdministration/TakeThreadDump.html)）

通常，此列表中的线程由其当前堆栈跟踪和线程状态（运行、挂起、锁定等）表示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T08:10:07.453

线程转储是程序失败时调用堆栈状态的输出。这应该让您知道程序中出现了错误，因为它准确地显示了程序在做什么（以及为什么）。

你有需要查看的线程转储吗？

# android - 如何在android的启动画廊中进行多选

> ID：12277092
> 
> 赞同：1
> 
> 时间：2012-09-05T08:08:28.847
> 
> 标签：android

天！

我想以多选模式启动画廊，但我失败了。

```
Intent photoPickerIntent = new Intent(Intent.ACTION_GET_CONTENT);
photoPickerIntent.setType("image/*");
startActivityForResult(photoPickerIntent, 1); 
```

我添加了下一个：

```
 <intent-filter>
        <action android:name="android.intent.action.SEND_MULTIPLE" />
    </intent-filter> 
```

从图库中获取图像，但它仅适用于我将图库作为应用程序启动并在那里选择文件。

如何从我的应用程序中以多选模式启动图库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:10:14.007

**不**，你不能。由于 Android Native Gallery 应用程序仅使用 Intent 响应 Single Select 响应`Intent.ACTION_GET_CONTENT`。

对于多选模式，您必须使用一些文件管理器或编写自己的文件资源管理器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-11T20:36:33.143

从 API18 开始，您实际上可以使用`Intent.ACTION_GET_CONTENT`现在使用来选择多个项目`Intent.EXTRA_ALLOW_MULTIPLE`

[http://developer.android.com/reference/android/content/Intent.html#EXTRA_ALLOW_MULTIPLE](http://developer.android.com/reference/android/content/Intent.html#EXTRA_ALLOW_MULTIPLE)

# python - rpy 内存泄漏

> ID：12277094
> 
> 赞同：5
> 
> 时间：2012-09-05T08:08:31.530
> 
> 标签：python, r, memory-leaks, rpy2

我的代码中有一小部分与此类似（当然使用实数矩阵而不是零填充的）：

```
x = [rinterface.FloatSexpVector([0]*(1000**2)) for i in xrange(20)]
y = robjects.r('list')(x) 
```

看起来它会导致内存泄漏。

运行以下代码时：

```
for i in xrange(10):
    x = [rinterface.FloatSexpVector([0]*(1000**2)) for i in xrange(20)]
    y = robjects.r('list')(x)
    del x
    del y
    robjects.r('gc(verbose=TRUE)') 
```

我得到：

```
Error: cannot allocate vector of size 7.6 Mb
In addition: Warning messages:
1: Reached total allocation of 2047Mb: see help(memory.size)
2: Reached total allocation of 2047Mb: see help(memory.size)
3: Reached total allocation of 2047Mb: see help(memory.size)
4: Reached total allocation of 2047Mb: see help(memory.size) 
```

这是一个错误还是我应该做的其他事情？我也尝试通过将它们放入 robjects.globalenv 然后 rm()-ing 在 gc() 之前将它们命名为变量，但它似乎不起作用。

我应该提到我在 Windows 上运行 rpy 2.3dev 但这也发生在 rpy 2.2.6 的 linux 上（尽管由于 linux 运行 64 位版本而不是像 windows 机器那样运行 32 位，内存只是增长而我没有得到 2047mb 错误）

**编辑**：似乎在 R gc() 解决第一个代码示例的问题之前添加 gc.collect() ，但这并没有解决我的问题 - 深入研究我的代码我发现导致问题的行是分配.names 中的值，类似于：

```
x = [rinterface.FloatSexpVector([0]*(1000**2)) for i in xrange(20)]
y = robjects.r('list')(x)[0]
y.names = rinterface.StrSexpVector(['a']*len(y)) 
```

在清理之前放置 rinterface.NULL 也无济于事。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:50:53.877

这可能是因为 Python 不知道嵌入式 R 分配的内存量，因此不知道应该收集垃圾。

[在 rpy2 的文档中](http://rpy.sourceforge.net/rpy2/doc-2.2/html/performances.html#memory-usage)有一些关于内存使用的内容，以及[关于 SO 的早期问题](https://stackoverflow.com/questions/5199334/clearing-memory-used-by-rpy2)

您的编辑表明可能发生了一些事情。最好的办法是在 rpy2 的 bitbucket 页面上提交错误报告，然后在此处而不是此处继续进行故障排除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-05T13:36:30.423

我不认为这是内存泄漏。我将尝试为您提供以下观点：

在 python shell 中尝试这些示例：

```
l = range(32 * 1024 * 1024) 
```

所以我们尝试让解释器分配 128 MB 的***连续***内存区域。这将起作用（在我的机器上大约需要 7 秒）

您可以使用各种值（它仍然适用于 256MB）；也尝试 N = 128 * 1024 * 1024；从这个值开始，我的机器就挂了。如果我有足够的耐心，我可能会在几分钟后拿回我的机器。但问题是解释器不能轻易分配大块连续的内存区域。

值得一提的是，我可以以相同的方式在 C++ 中分配 1GB 的内存，并且在同一台机器上花费不到 1 秒的时间（i7 和 8GB RAM、Windows 8 或 CentOS6 - 我尝试了两种操作系统）。我用Java尝试过同样的事情。

我没有花时间研究为什么 python 堆分配器会这样。我只能推测 rpy 人试图阻止/限制你分配太多，所以他们设置了一个下限，这样就不会发生任何不好的事情；实际上，您可以有多个较小的数组，其中包含一些引用对象（占用超过 4 个字节）。

# ios - 如何在 Logos Tweak 中发布通知

> ID：12277099
> 
> 赞同：0
> 
> 时间：2012-09-05T08:08:59.153
> 
> 标签：ios, nsnotificationcenter, tweak, logos

我使用 iOSOpenDev 创建了一个 Logos Tweak 来挂钩`acknowledgeIncomingMessageWithId:`，`CTMessageCenter`我想将通知发送`NSNotificationCenter`到另一个应用程序，但它不起作用。我认为`NSNotificationCenter`可以在不同的应用程序之间工作。首先，我尝试测试`NSNotificationCenter`in 调整。这就是我在下面所做的：

```
%hook CTMessageCenter

-(void)acknowledgeIncomingMessageWithId:(unsigned int)anId {
        [[NSNotificationCenter defaultCenter] addObserver:self 
                                                 selector:@selector(doingSMS) 
                                                     name:@"SMSComing" 
                                                   object:nil];
        [[NSNotificationCenter defaultCenter] postNotificationName:@"SMSComing" object:nil];
    }

    %orig;
}

- (void)doingSMS{
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"短信消息传送成功" 
                                                    message:@"来短信啦"
                                                   delegate:nil 
                                          cancelButtonTitle:@"Good" 
                                          otherButtonTitles:nil];
    [alert show];
    [alert release];
}

%end 
```

但它不起作用。此外，UIAlertView 没有出现。谁能告诉我为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T07:15:05.167

要使通知在应用程序之间起作用：

```
CFNotificationCenterAddObserver(CFNotificationCenterGetDarwinNotifyCenter(), 
                                NULL, 
                                doingSMS,
                                CFSTR("com.your.company.SMSComing"), 
                                NULL, 
                                CFNotificationSuspensionBehaviorCoalesce); 
```

接着

```
CFNotificationCenterPostNotification(CFNotificationCenterGetDarwinNotifyCenter(), 
                                     CFSTR("com.your.company.SMSComing"), 
                                     NULL, 
                                     NULL, 
                                     TRUE); 
```

请注意，通知名称`"SMSComing"`（不带前缀）容易出现问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T01:14:48.100

我在使用 iOSOpenDev 进行的调整中没有出现 UIAlertViews 的问题。
我意识到我必须将 UIAlertView 的委托设置为`self`. 由于某种我不明白的原因，当我将委托设置为`nil`UIAlertView 时不会出现。

# c# - 将南非时间转换为世界时间

> ID：12277104
> 
> 赞同：2
> 
> 时间：2012-09-05T08:09:21.307
> 
> 标签：c#, datetime, timezone

我想将南非时间转换为任何世界时间。我有以下可用值：时区（即布鲁塞尔的 60）和偏移量 = 60。

我试过这个：

```
var newDate = DateTime.Now.AddMinutes(60); 
```

但它没有给我布鲁塞尔的正确日期时间值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:12:32.927

根据[MSDN 页面](http://msdn.microsoft.com/en-us/library/bb382770.aspx)，您可以使用类似这样的内容（记得选择正确的时区）：

```
DateTime hwTime = DateTime.Now;
try
{
   TimeZoneInfo hwZone = TimeZoneInfo.FindSystemTimeZoneById("Hawaiian Standard Time");
   Console.WriteLine("{0} {1} is {2} local time.", 
           hwTime, 
           hwZone.IsDaylightSavingTime(hwTime) ? hwZone.DaylightName : hwZone.StandardName, 
           TimeZoneInfo.ConvertTime(hwTime, hwZone, TimeZoneInfo.Local));
}
catch (TimeZoneNotFoundException)
{
   Console.WriteLine("The registry does not define the Hawaiian Standard Time zone.");
}                           
catch (InvalidTimeZoneException)
{
   Console.WriteLine("Registry data on the Hawaiian STandard Time zone has been corrupted.");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T08:26:24.470

您可以使用[DateTime.ToUniversalTime()](http://msdn.microsoft.com/en-us/library/system.datetime.touniversaltime%28v=vs.110%29.aspx)`DateTime`将任何时间转换为世界时间 (UTC ) 。由于布鲁塞尔提前一小时，因此增加一小时（如果他们在夏令时）或两小时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T08:14:33.260

看看：http: [//msdn.microsoft.com/en-us/library/bb397769.aspx](http://msdn.microsoft.com/en-us/library/bb397769.aspx)

# iphone - 如何手动关闭UAModalPanel

> ID：12277107
> 
> 赞同：2
> 
> 时间：2012-09-05T08:09:29.700
> 
> 标签：iphone, xcode, uiviewcontroller, modalviewcontroller

我已经下载了一个很好的示例代码[UAModalPanel](http://code.coneybeare.net/uamodalpanel-an-open-source-modal-panel-alter)。我已经在我的项目中实现了它，如果我们点击段控件的第一个索引，它将打开 UAModalPanel。我可以成功地实现这一点。

但是，如果我们在段控制中选择第二个或第三个索引，我需要关闭 UAModalPanel 我该如何实现这一点。如果有人知道指导我吗？

![在此处输入图像描述](../Images/1dfdf3d7e30dfbd7fab8efa27a4ebf7a.png) **如果我们点击下面的段控件将被调用**

```
 -(void)navBarSegmentCntrl_tapped
{
if(navBarSegmentCntrl.selectedSegmentIndex==0)
{

    UAExampleModalPanel *modalPanel = [[UAExampleModalPanel alloc] initWithFrame:self.view.bounds title:@"dfg" ];

    [self.view addSubview:modalPanel];

    // Show the panel from the center of the screen
    [modalPanel showFromPoint:self.view.center];

}
else if(navBarSegmentCntrl.selectedSegmentIndex==1)
{
    [UAmodal hide];  //UAmodal allocated in view didload//
    imagePickerController = [[UIImagePickerController alloc] init];
    imagePickerController.delegate = self;
    imagePickerController.sourceType = 
    UIImagePickerControllerSourceTypePhotoLibrary;

    [self presentModalViewController:imagePickerController animated:YES];   
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:22:39.910

问题是您正在调用的对象与您正在调用的对象`show`不同`hide`。你应该在你的接口文件中声明它：

```
@interface MyViewController : UIViewController
{
    UAModalPanel *myModalPanel;
} 
```

然后，当你在`navBarSegmentCntrl_tapped`方法中显示它时，你初始化它`myModalPanel` （记住你不需要再做`UAModalPanel *myModalPanel`一次，一旦你已经设置了它，并且你的视图控制器“已经知道该对象”。你只需这样做`myModalPanel = [[UAModalPanel alloc] init....`）。

然后，要隐藏它，只需调用`[myModalPanel hide];`.

# perl - 驼鹿测试失败

> ID：12277113
> 
> 赞同：2
> 
> 时间：2012-09-05T08:09:55.420
> 
> 标签：perl, testing, moose

我正在尝试升级到最新版本的 Moose，但我遇到了很多测试失败。

所有这些错误似乎都与元类有关。我也尝试安装 2.0402（这是我们在本地镜像上的）并得到相同的错误。例如：

```
t/cmop/rebless_with_extra_params.t ............................ 
   Foo already has a metaclass, but it does not inherit Moose::Meta::Class
   (Class::MOP::Class=HASH(0x2be2070)). 
   at /home/cpoe/Downloads/Moose-2.0603/blib/lib/Moose.pm line 170. 
```

[我已经发布了完整`make test`输出](https://gist.github.com/3618458)的要点。

我正在做标准的“perl Makefile.PL; make; make test”。

```
$ perl -v

This is perl 5, version 12, subversion 2 (v5.12.2) built for x86_64-linux 
```

如果有人可以建议在哪里解决此错误，或者我可以提供哪些其他信息来帮助诊断它？我在 Google 上的搜索结果一无所获。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T07:10:47.093

这个问题现在已经解决了，因为这是我以前遇到的一个错误，但忘记了。

我把一个旧的复制`.bashrc`到这个盒子里，忘记了这一点：

```
echo $PERL5LIB
lib:t/lib 
```

该`t/lib`位已导致我之前在其他模块上安装失败，我应该记住这一点。

# jquery - 向 jQuery 脚本添加 cookie 功能（确保表格单元格保持突出显示）

> ID：12277114
> 
> 赞同：-1
> 
> 时间：2012-09-05T08:09:57.543
> 
> 标签：jquery, css, html-table

我有以下 jQuery 代码：

```
<script type="text/javascript">
    $(document).ready(function() {
        var color = ['none', 'green', 'yellow', 'red'];
        $('table').on('change','select', function() {
            $(this).parents('td').css('background', color[$(':selected', this).index()]);
        });​
    });
</script> 
```

Which highlights all table cells on a row when an option in a select box is chosen. 我已经下载并实现了 jQuery cookie 插件。我的问题是如何实现功能（附加代码），以便在刷新页面或用户注销时，表格单元格的行将保持突出显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:36:35.160

您所需要的只是将选定的颜色存储在 cookie 中，然后将其读回。您可以使用[jquery cookie 插件](https://github.com/carhartl/jquery-cookie)。此处的示例用法：

```
$(document).ready(function() {

    if ($.cookie("yourname")) {
        // applying color from cookie
        var color = $.cookie("yourname");
        $('div').css('background', color);
        $('select').val(color);
    }

    $('div').on('change', 'select', function() {
        // applying selected color, storing it in the cookie
        var color = $(this).val();
        $.cookie("yourname", color);
        $('div').css('background', color);
    });

});​ 
```

[演示](http://jsfiddle.net/hFzVc/1/)

PS：对于演示，我使用稍微修改过的脚本，因为你没有提供你的 HTML 标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T11:30:08.630

谢谢你的回答。在以下代码中实现它的最佳方法是什么：

```
<?php
while ($row = mysql_fetch_assoc($result))

{
echo '<tr>';

echo '<td><input type="text" name="order_no[]" value="' . $row['Orderno'] . '"/></td>';
echo '<td><input type="text" name="order_date[]" value="' . $row['Orderdate'] . '"/>   </td>';
    echo '<td><input type="text" name="order_ordered_by[]" value="' . $row['Orderedby'] . '"/></td>';
    echo '<td><input type="text" name="order_supplier[]" value="' . $row['Supplier'] . '"/></td>';
    echo '<td><input type="text" name="order_total_price[]" value="' . $row['totalprice'] . '"/></td>';
    echo '<td><input type="text" name="order_requested_by[]" value="' . $row['requestedby'] . '"/></td>';
    echo '<td>';
    echo '<select name="order_status[]">';
    echo '<option></option>';
    echo '<option>Approved</option>';
    echo '<option>Pending</option>';
    echo '<option>Dissaproved</option>';
    echo '</select>';
    echo '</td>';
    echo '</tr>';

}
?> 
```

# php - 使用 PDO 进行抽象

> ID：12277125
> 
> 赞同：-1
> 
> 时间：2012-09-05T08:10:34.657
> 
> 标签：php, mysql, pdo

当我使用`mysql_*`函数进行数据库操作时，我曾经将连接数据库和初始化代码放在一个单独的文件中，并将其包含在其他页面上，效果很好。

我最近学习了 PDO，所以我想用 PDO 尝试一下。所以我有 4 个 PHP 文件。

**config.php**文件存储所有数据库相关信息。

```
<?php

$host = "localhost";
$username = "root";
$password = "abc123";
$dbname = "blog";

?> 
```

**init.php**包含 config.php 文件并初始化数据库连接。

```
<?php

include_once("config.php");

$db = new PDO('mysql:host=' . $host . ';dbname=' . $dbname, $username, $password);
$db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

?> 
```

还有一个名为**functions.php**的单独文件，其中包含所有功能。它包括 init.php 文件。

```
<?php

include_once("init.php");

function AddCategory($_name)
{
    $param = $_name;
    $query = $db->prepare("INSERT INTO categories SET name = :name");
    $query->bindParam(':name', $param, PDO::PARAM_STR);
    $query->execute();
}

function CategoryExists($_name)
{
    $param = $_name;
    $query = $db->prepare("SELECT COUNT(1) FROM categories WHERE name = :name");
    $query->bindParam(':name', $param, PDO::PARAM_STR);
    $query->execute();

    $results = $query->fetch();

    return ($results == '0') ? false : true;
}

?> 
```

以及显示一个小表格的**index.php文件。**

```
<?php

include_once("functions.php");

if(isset($_POST['name']))
{
    $name = trim($_POST['name']);

    if(empty($name))
    {
        $error = "You must enter a category name";
    }
    else if (CategoryExists($name))
    {
        $error = "That category already exists";
    }
    else if (strlen($name) > 24)
    {
        $error = "Category name can only be upto 24 characters";
    }

    if(!isset($error))
    {
        AddCategory($name);
    }
}

?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Add a Category</title>
</head>
<body>

    <h1>Add a Category</h1>

    <form action="" method="post">
        <div>
            <label for="name">Name</label>
            <input type="text" name="name" value=""></input>
        </div>
        <div>
            <input type="submit" value="Add Category"></input>
        </div>
    </form>

</body>
</html> 
```

但是当我输入一些东西并提交它时，即使我已经包含了必要的文件，它也会抛出这个错误。

![在此处输入图像描述](../Images/dd02f0ef8505c41c4b3fde8ab8fd1144.png)

有人可以告诉我我在这里做错了什么吗？我真的很感激。还是有更简单/有效/正确的方法来实现这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T08:12:42.917

您的辅助函数正在尝试访问`$db`不在范围内的全局变量。可以`global $db;`在每个函数的顶部修复此错误。

这种方法是您学习时的自然步骤，但从工程的角度来看，这是非常不可取的，因为您的函数依赖于全局状态。将来，您应该研究如何创建一个扩展`PDO`（或聚合 PDO 实例）的类，并使这些函数成为该类的方法。如果你这样做，那么`$db`变量将成为类的“一部分”或[封装](http://en.wikipedia.org/wiki/Encapsulation_%28object-oriented_programming%29)在类中，这是一个有价值的目标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T08:13:36.063

在您的函数内部， $db 是一个未知变量。

快速而肮脏的方式：

```
function AddCategory($_name)
{
    global $db;
    $param = $_name;
    $query = $db->prepare("INSERT INTO categories SET name = :name");
    $query->bindParam(':name', $param, PDO::PARAM_STR);
    $query->execute();
} 
```

当然有一个更好的解决方案：让它成为一个类并将它们放在一起：

```
class mymodel
{
    private $db;

    function __construct( $host, $dbnam, $username, $password)
    {
      $this->db = 
        new PDO('mysql:host=' . $host . ';dbname=' . $dbname, $username, $password);
      $this->db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    }

    function AddCategory($_name)
    {
        $param = $_name;
        $query = $this->db->prepare("INSERT INTO categories SET name = :name");
        $query->bindParam(':name', $param, PDO::PARAM_STR);
        $query->execute();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T08:13:19.750

这里的问题是[变量范围](http://php.net/manual/en/language.variables.scope.php)。您需要将 $db 对象作为函数参数传入。

```
function AddCategory($_name, $db)
{
    $param = $_name;
    $query = $db->prepare("INSERT INTO categories SET name = :name");
    $query->bindParam(':name', $param, PDO::PARAM_STR);
    $query->execute();
}

function CategoryExists($_name, $db)
{
    $param = $_name;
    $query = $db->prepare("SELECT COUNT(1) FROM categories WHERE name = :name");
    $query->bindParam(':name', $param, PDO::PARAM_STR);
    $query->execute();

    $results = $query->fetch();

    return ($results == '0') ? false : true;
} 
```

# android - Logcat 无法显示陀螺仪值

> ID：12277131
> 
> 赞同：0
> 
> 时间：2012-09-05T08:11:07.530
> 
> 标签：android, android-logcat, gyroscope

我正在通过我的 Nexus 移动设备显示和检查陀螺仪的值。之前我曾经在连接我的设备后立即获取这些值。但是，我还使用 Log.v 进行检查，以防监听器被调用，并且它正在工作。但我无法在定位文件上获得实际的“数字”值。提前致谢

```
private SensorEventListener gyroscope_listener = new SensorEventListener() {

        public void onSensorChanged(SensorEvent event) {

            gyro_x = event.values[0];
            gyro_y = event.values[1];
            gyro_z = event.values[2];

            Log.v("GYRO-X" , "gyro_x");
            //Log("testgyro"+gyro_x);
            Log3("----- gyroscope sensor  -------");
            Log3("Gyro-x" + gyro_x);
            Log3("Gyro-y" + gyro_y);
            Log3("Gyro-z" + gyro_z);
            Log3("----- gyroscope sensor  -------");
        }

        public void onAccuracyChanged(Sensor sensor, int accuracy) {

        }
    }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:46:39.597

1.  什么是Log3？！也许你有拼写错误？

2.  你应该调试它并问自己：“你的程序甚至输入了那部分代码吗？” - 也许它没有！

# php - symfony2一下子坏了？

> ID：12277137
> 
> 赞同：5
> 
> 时间：2012-09-05T08:11:16.393
> 
> 标签：php, symfony

尽管我很喜欢 Symfony2，但这不是我在一周未开发后第一次回来，并且有一个奇怪的错误消息......

> 警告：类 __PHP_Incomplete_Class 在 /var/www/my_app/vendor/symfony/src/Symfony/Component/Security/Core/Authentication/Token/AbstractToken.php 第 153 行中没有反序列化程序

我当然没有碰过那个文件……试着用谷歌搜索它，但只找到了一些人们使用过 cache:clear 命令、安装供应商或移动实体的答案。正如我所说，我什么都没做...我更改了 symfony2 所在的目录名称，但这不应该影响它...无论如何我稍后将其更改回来，仍然是同样的问题。缓存清除（手动，删除文件夹缓存和日志）和 apache2 重新启动...

有人遇到过同样的问题吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-05T08:23:10.997

解决方案是运行 cache:clear 命令

```
cd symfony/app
php console cache:clear 
```

而不仅仅是手动删除文件夹 app/cache 和 app/logs

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-03-04T20:09:27.680

我遇到了同样的问题，清除缓存只是一个临时修复。问题是有两个 Symfony 实例有冲突的会话。我修复它的方法是在 config.yml 中为 Symfony 的每个实例提供自己的会话名称

```
framework:
    session:
        name: "NewSessionName" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-10-13T13:53:05.233

**对我来说最快的解决方案是**

*   打开 DevTools (Chrome/FF)(Win=>F12, Mac=>CMD+Shift+i) 并转到
*   资源-> Cookies-> 域/主机
*   删除 PHPSESSID 和其他 Stuff / All。

应该再次工作！

![Devtools 资源-Cookies](../Images/585c5053a3f85fe43d2d7fe523e67766.png)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-04-06T09:36:30.053

`app/console cache:clear 在我的情况下不起作用，只返回错误

解决方法：手动删除缓存内容

```
rm -r app/cache/dev/ 
```

# android - 如何在 Android 的选项卡应用程序中导航？

> ID：12277141
> 
> 赞同：0
> 
> 时间：2012-09-05T08:11:26.113
> 
> 标签：android, android-intent, navigation, tabview

嗨，每个人都是 android 技术的新手。我想问一下，当我单击项目时，我的项目中的第四个选项卡中有 4 个选项卡。它应该导航到新活动，它还必须显示与之相关的剩余 3 个选项卡但是当我点击它时，它单独显示活动而不显示剩余的 3 个选项卡。我应该怎么做才能克服这个问题？谁能帮助我提前谢谢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T10:04:48.440

您可以使用 tabhost 来导航视图。 [http://developer.android.com/reference/android/widget/TabHost.html](http://developer.android.com/reference/android/widget/TabHost.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T10:11:14.350

这个想法是在存根中实现模拟您的新活动的视图。

```
<ViewStub
        android:id="@+id/myStub"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:inflatedId="@+id/layoutParent"
        android:layout="@layout/new_activity" /> 
```

当 ViewStub 处于活动状态时隐藏实际布局：

```
myStub = findViewById(R.id.myStub);
myStub.setVisibility(View.VISIBLE); 
```

在这一刻，我可以在 new_activity 布局中找到新视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T09:33:34.383

您可以使用 ViewStub 来模拟不同的活动：

[http://developer.android.com/reference/android/view/ViewStub.html](http://developer.android.com/reference/android/view/ViewStub.html)

我是这样做的。

# jquery - AJAX 调用由服务器处理但不会呈现？

> ID：12277143
> 
> 赞同：1
> 
> 时间：2012-09-05T08:11:32.633
> 
> 标签：jquery, ruby-on-rails, ajax, coffeescript

在我的 rails 3 应用程序中，我有一个页面需要定期与服务器检查更新信息，然后相应地更新无序列表。按照[Rails 3 中显示的示例来等效于periodic_call_remote](https://stackoverflow.com/questions/3661967/rails-3-equivalent-for-periodically-call-remote)，我转换为适当的 CoffeeScript 并创建了必要的 .js.erb 部分。

页面调用服务器，服务器响应正确的 js 文件，但页面上的任何内容都无法修改。`alert('foo');`工作正常，但任何事情的顺序`.html()`或`.replaceWith()`不会。

这是我的 CoffeeScript：

```
$(document).ready ->
    setInterval () ->
        $.ajax url: "programs", type: "GET", dataType: "script"
    , 10000 
```

和相应的.js.erb：

```
$("#programlist").html("<%= escape_javascript(render @programs) %>"); 
```

这里有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:36:24.490

尝试`$("#programlist").load(..);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:34:54.750

这意味着响应中有错误（javascript）。可能是您在这里使用了错误的 ID`$("#programlist").html(..);`

在 firefox 中使用[firebug](https://addons.mozilla.org/en-us/firefox/addon/firebug/) addon 在其控制台中查看响应并使用它来逐行应用行，并查看哪一行有错误。

祝你好运 ：）

# iphone - UIButton 添加到 UIImageView 时的操作不起作用？

> ID：12277146
> 
> 赞同：-1
> 
> 时间：2012-09-05T08:11:51.010
> 
> 标签：iphone, ios, ipad

> **可能重复：**
> [按钮操作在 iphone 中不起作用？](https://stackoverflow.com/questions/12264519/button-action-not-working-in-iphone)

我有一个应用程序，在该应用程序中，我添加了一个图像视图，而不是导航栏视图。像这样在视图中确实加载了方法。

```
curtainsView=[[UIImageView alloc]init];

curtainsView.image=[UIImage imageNamed:@"curtains.png"];
curtainsView.frame=CGRectMake(0,-44, 320, 60);
curtainsView.backgroundColor=[UIColor clearColor];

[self.view addSubview:curtainsView]; 
```

现在我想在该图像视图上添加一个按钮。我正在尝试用这个来实现

```
UIImage *button2Image = [UIImage imageNamed:@"scroll_down.png"];
UIButton *scroll = [UIButton buttonWithType:UIButtonTypeCustom];
//scroll = [[UIButton alloc] init];
//self.scroll.tag=100;
[scroll setImage:button2Image forState:UIControlStateNormal];
scroll.frame = CGRectMake(270,-30, 40,40);
[scroll addTarget:self action:@selector(backpressed) forControlEvents:UIControlEventTouchUpInside]; 
//[scroll setUserInteractionEnabled:YES];
[self.view addSubview:scroll]; 
```

不工作。然后我也试过这个

```
UIButton *btnDetail = [[UIButton buttonWithType:UIButtonTypeDetailDisclosure]retain];

btnDetail.frame = CGRectMake(260,-15,100,100);
[btnDetail addTarget:self action:@selector(backpressed) forControlEvents:UIControlEventAllTouchEvents];

[self.curtainsView addSubview:btnDetail];
[self.curtainsView bringSubviewToFront:btnDetail];
[self.curtainsView setUserInteractionEnabled:YES]; 
```

也不工作。如果它在该图像视图的一侧，则它不起作用，但是当我尝试添加带有框架的第二个代码时，`CGRectMake(260,0,100,100)`它可以正常工作。但我需要该按钮位于该图像视图内。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:15:03.500

您不应该在 imageViews 上添加子视图。而是将您的按钮添加到 imageView 上方的 self.view 中。并且不要在其超级视图范围之外添加您的按钮。

```
UIImage *button2Image = [UIImage imageNamed:@"scroll_down.png"];
UIButton *scroll = [UIButton buttonWithType:UIButtonTypeCustom];
[scroll setImage:button2Image forState:UIControlStateNormal];
scroll.frame = CGRectMake(270, 0, 40, 40);
[scroll addTarget:self action:@selector(backpressed) forControlEvents:UIControlEventTouchUpInside]; 
[self.view addSubview:scroll]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T09:05:55.130

您需要在视图而不是图像视图上添加一个按钮。将您的按钮添加到 self.view 而不是 imageview。

```
 [self.view addSubview:btnDetail];
    [self.view bringSubviewToFront:btnDetail]; 
```

它会正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T08:38:21.333

这将起作用：

```
UIImageView *imgview=[[UIImageView alloc]initWithFrame:CGRectMake(10, 100, 300, 300)];
imgview.backgroundColor=[UIColor whiteColor];
imgview.userInteractionEnabled=YES;
[self.view addSubview:imgview];

UIButton *btn=[UIButton buttonWithType:UIButtonTypeCustom];
btn.Frame=CGRectMake(10, 10, 100, 20);
btn.backgroundColor=[UIColor blueColor];
[btn addTarget:self action:@selector(clickActonOfButtons) forControlEvents:UIControlEventTouchUpInside];
[imgview addSubview:btn];
btn=nil;
[imgview release]; 
```

注意：如果您要在按钮上添加图像......在这种情况下 `imgview.userInteractionEnabled=NO;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T08:44:12.597

使您的 ImgView 的 userInteractionEnabled 为 YES，默认为 NO。

UIImageView 中的触摸不会传递给 UIButton。

```
curtainsView.userInteractionEnabled=YES; 
```

还将 UIButton 的 userInteractionEnabled 设置为 YES

```
btnDetail.userInteractionEnabled=YES; 
```

在设置像 CGRectMake(260,-15,100,100) 这样的框架时，还要检查 btnDetail 的边界是否超出了超级视图的边界；

当您设置 CGRectMake(260,0,100,100) 时，它可以工作，因为 btnDetail 的边界在可见区域和超级视图边界内

# iphone - iOS - 在情节提要项目中关闭弹出窗口。

> ID：12277147
> 
> 赞同：1
> 
> 时间：2012-09-05T08:11:54.053
> 
> 标签：iphone, ios5, uiview, uibutton, popup

我使用此[示例](http://www.touch-code-magazine.com/showing-a-popup-window-in-ios-class-for-download/)打开我的条款和条件按钮的弹出窗口。

打开时它可以工作，但关闭它会给出`exc bad access error`.

在我的应用程序中，我使用`storyboards`的可能是没有关闭的问题

这是我在弹出窗口类中使用的代码：

```
 #import "MTPopupWindow.h"

 #define kShadeViewTag 1000

 @interface MTPopupWindow(Private)
 - (id)initWithSuperview:(UIView*)sview andFile:(NSString*)fName;
 @end

 @implementation MTPopupWindow

- (id)initWithSuperview:(UIView*)sview andFile:(NSString*)fName
{

self = [super init];
if (self) {
    // Initialization code here.
    bgView = [[UIView alloc] initWithFrame: sview.bounds];
    NSLog(@"%f",sview.bounds.size.width);
    NSLog(@"%f",sview.bounds.size.height);

    NSLog(@"%f",sview.bounds.origin.x);
    NSLog(@"%f",sview.bounds.origin.y);

    [sview addSubview: bgView];

    // proceed with animation after the bgView was added
    [self performSelector:@selector(doTransitionWithContentFile:) withObject:fName afterDelay:0.1];
}

return self;
}

 -(void)doTransitionWithContentFile:(NSString*)fName
{
//faux view
UIView* fauxView = [[UIView alloc] initWithFrame: CGRectMake(10, 10, 200, 200)];
[bgView addSubview: fauxView];

//the new panel
bigPanelView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, bgView.frame.size.width, bgView.frame.size.height)];
bigPanelView.center = CGPointMake( bgView.frame.size.width/2, bgView.frame.size.height/2);

//add the window background
UIImageView* background = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"popupWindowBack1.png"]];
background.center = CGPointMake(bigPanelView.frame.size.width/2, bigPanelView.frame.size.height/2);
[bigPanelView addSubview: background];

//add the web view
int webOffset = 10;
UIWebView* web = [[UIWebView alloc] initWithFrame:CGRectInset(background.frame, webOffset, webOffset)];
web.backgroundColor = [UIColor clearColor];

if ([fName hasPrefix:@"http"]) {
    //load a web page
    web.scalesPageToFit = YES;
    [web loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString: fName]]];
} else {
    //load a local file
    NSError* error = nil;
    NSString* fileContents = [NSString stringWithContentsOfFile:[[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:fName] encoding:NSUTF8StringEncoding error: &error];
    if (error!=NULL) {
        NSLog(@"error loading %@: %@", fName, [error localizedDescription]);
    } else {
        [web loadHTMLString: fileContents baseURL:[NSURL URLWithString:@"file://"]];
    }
}

[bigPanelView addSubview: web];

//add the close button
int closeBtnOffset = 10;
UIImage* closeBtnImg = [UIImage imageNamed:@"popupCloseBtn.png"];
UIButton* closeBtn = [UIButton buttonWithType:UIButtonTypeCustom];
[closeBtn setImage:closeBtnImg forState:UIControlStateNormal];
[closeBtn setFrame:CGRectMake( background.frame.origin.x + background.frame.size.width - closeBtnImg.size.width - closeBtnOffset, 
                              background.frame.origin.y ,
                              closeBtnImg.size.width + closeBtnOffset, 
                              closeBtnImg.size.height + closeBtnOffset)];
[closeBtn addTarget:self action:@selector(closePopupWindow) forControlEvents:UIControlEventTouchUpInside];
[bigPanelView addSubview: closeBtn];

//animation options
UIViewAnimationOptions options = UIViewAnimationOptionTransitionFlipFromRight |
UIViewAnimationOptionAllowUserInteraction    |
UIViewAnimationOptionBeginFromCurrentState;

//run the animation
[UIView transitionFromView:fauxView toView:bigPanelView duration:0.5 options:options completion: ^(BOOL finished) {

    //dim the contents behind the popup window
    UIView* shadeView = [[UIView alloc] initWithFrame:bigPanelView.frame];
    shadeView.backgroundColor = [UIColor blackColor];
    shadeView.alpha = 0.3;
    shadeView.tag = kShadeViewTag;
    [bigPanelView addSubview: shadeView];
    [bigPanelView sendSubviewToBack: shadeView];
}];
}

-(void)closePopupWindow
{
//remove the shade
[[bigPanelView viewWithTag: kShadeViewTag] removeFromSuperview];   

//[self performSelector:@selector(closePopupWindowAnimate) withObject:nil afterDelay:0.1];

}

-(void)closePopupWindowAnimate
{

//faux view
__block UIView* fauxView = [[UIView alloc] initWithFrame: CGRectMake(10, 10, 200, 200)];
[bgView addSubview: fauxView];

//run the animation
UIViewAnimationOptions options = UIViewAnimationOptionTransitionFlipFromLeft |
UIViewAnimationOptionAllowUserInteraction    |
UIViewAnimationOptionBeginFromCurrentState;

//hold to the bigPanelView, because it'll be removed during the animation
    [UIView transitionFromView:bigPanelView toView:fauxView duration:0.5 options:options completion:^(BOOL finished) {

    //when popup is closed, remove all the views
    for (UIView* child in bigPanelView.subviews) {
        [child removeFromSuperview];
    }
    for (UIView* child in bgView.subviews) {
        [child removeFromSuperview];
    }

    [bgView removeFromSuperview];

}];
 }

 @end 
```

# drupal - 区别 hook_form_alter() 和 hook_prepare()

> ID：12277148
> 
> 赞同：0
> 
> 时间：2012-09-05T08:11:58.850
> 
> 标签：drupal, drupal-7

我对 Drupal 比较陌生。

我遇到了两种预填充表单的方法，即[hook_form_alter()](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_form_alter/7)和[hook_prepare()](http://api.drupal.org/api/drupal/modules!node!node.api.php/function/hook_prepare/7)

我已经阅读了文档，我相信这两种方法都可以实现我想要的。

我想知道这两个函数是为了什么而创建的？有没有为指定功能制作的？

据我了解， hook_form_alter() 采用当前的表单状态，并对其进行操作。这是否意味着这个函数是用来改变实际表单本身的？喜欢更改某些字段，或添加自定义字段等？

另一方面，Hook_prepare() 在填充添加/编辑表单之前获取一个节点并对其进行操作。

假设情况是我正在尝试预填充表单。hook_prepare() 会是“正确”的方法吗？还是真的没关系？如果我使用 webform 模块而不是内容类型怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:38:30.273

这两个钩子完全不同，它们根本不做同样的事情。

`hook_form_alter()`每当使用`drupal_get_form()`. 它允许模块以结构化的方式更改与表单相关的元素或元数据（操作字段属性、添加 AJAX、添加 CSS 属性等）。任何实现它的模块都会调用该钩子。

相反，`hook_prepare()`用于在将节点对象传递给实体表单以进行添加/编辑之前对它们进行操作。它只会为定义正在准备的节点类型的模块调用。因此，除非您已经定义了众所周知的自定义“节点类型模块”，否则不会调用此挂钩。

简短的回答是 99% 的时间你会使用`hook_form_alter()`. `hook_prepare()`仅在一组非常特定的情况下进入等式，如果您使用的是 Webform 模块，则不适用于您的情况。

# opengl - openframework 示例已编译但在运行时在许多地方崩溃

> ID：12277150
> 
> 赞同：0
> 
> 时间：2012-09-05T08:12:01.603
> 
> 标签：opengl, opencv, runtime-error, openframeworks

以前我明确使用opengl和opencv，它们在我的电脑上运行良好，所以我确信这不是因为任何显卡问题。我正在尝试的是开放框架，我已经成功编译了库。样本也编译了 100% 正确，但是当我运行应用程序时它会崩溃。

在对其进行调查后，我发现了它崩溃或访问违规的地方。

示例是 \examples\video\videoGrabberExample

```
videoTexture.loadData(videoInverted, camWidth,camHeight, GL_RGB); 
```

经过进一步调试后，我发现它在每个项目的两个地方都崩溃了

```
 glActiveTexture(GL_TEXTURE0); //inside the class ofTexture. 
```

和

```
 ofEnableBlendMode(OF_BLENDMODE_ALPHA); 
```

或它崩溃的任何混合选项。

这似乎是 opnengl 错误，但我不确定下一步该做什么。所以我的要求是，如果有人有开放框架的经验，那么请指导我为什么它不工作？

# php - MySQL 更新语法错误

> ID：12277151
> 
> 赞同：0
> 
> 时间：2012-09-05T08:12:10.943
> 
> 标签：php, mysql

我做了一个简单的查询来使用 php 更新我的表，但无法找出错误。

我的功能：

```
function editData($id, $data) {
    $message ="";
    $query= "UPDATE blood_data SET name='{$data['name']}', group='{$data['group']}',
             address1='{$data['address']}', district='{$data['district']}',
             age='{$data['age']}', sex='{$data['sex']}', phone='{$data['phone']}', 
             mobile='{$data['mobile']}',  email='{$data['email']}' 
             WHERE id='{$id}' ";

    if(mysql_query($query)) {
        $message ="Data Successfully Updated ";
    }else {
        die("failed: " . mysql_error());    
    }

    return $message;

} 
```

这是传入函数的内容：

```
$dataArray = [
    'name'=>$_POST['full_name'],
    'group'=>$_POST['group'],
    'sex'=>$_POST['sex'],
    'age'=>$_POST['age'],
    'address'=>$_POST['address'],
    'district'=>$_POST['district'],
    'email'=>$_POST['email'],
    'phone'=>$_POST['phone'],
    'mobile'=>$_POST['mobile']
  ];

  $msg = editData($idUploader, $dataArray); 
```

抛出的错误消息是：

> 失败：您的 SQL 语法有错误；查看与您的 MySQL 服务器版本相对应的手册，了解在 'group='O +', address1='dsd', district='sdfs', age='22', sex='male', phone 附近使用的正确语法='23423' 在第 1 行

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T08:13:39.023

您需要引用您的字段名称，以及`group`保留的 MySQL 关键字。例如：

```
UPDATE blood_data SET `name` = '{$data['name']}', `group` = '{$data['group']}' ... 
```

看看使用[PDO](http://php.net/book.pdo.php)，因为它会为您做这件事，并有助于防止 SQL 注入，以及许多其他好处。更不用说这些`mysql_*`功能已被弃用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:18:27.587

你应该避免这样的代码，你的程序很容易受到 SQL 注入攻击。考虑将 mysqli 与准备好的语句一起使用。

正如**马特汉弗莱（Matt Humphrey**）在他的回答中已经提到的那样， group 是保留的 mysql 关键字，但是当您像这样在反引号中公开它时可以使用它：

```
`group` 
```

# fortran - DATA TKX/2HKX/在fortran中是什么意思？

> ID：12277157
> 
> 赞同：1
> 
> 时间：2012-09-05T08:12:35.300
> 
> 标签：fortran

此类数据在 fortran 中初始化：

```
DATA TKX/2HKX/ 
```

`TKX`是一个双实数。这意味着什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T08:50:04.580

`DATA`是一种老式的初始化变量的方法，并且是称为*Hollerith 数据*`2HKX`的（甚至更多）老式 Fortran 功能的示例。在这种情况下，是一种为没有字符或字符串数​​据类型的语言表达字符串的方法；FORTRAN77 之前的 Fortran 就是这样一种语言。因此，您所拥有的是一种将 2 个字符串存储在声明为数字（在您的情况下）类型的变量中的方法。*`2HKX``KX``KX``DOUBLE PRECISION`*

 *Hollerith 数据已从 77 标准中的语言中删除，但与所有好的（眨眼）事物一样，它的使用期限已过很久。*

# javascript - parseInt 行为奇怪 - 可能

> ID：12277164
> 
> 赞同：0
> 
> 时间：2012-09-05T08:13:02.613
> 
> 标签：javascript, debugging, visual-studio-2008, parseint

我有一个简单的小 js 函数，由文本框的自定义验证器调用，基本上是为了检查时间是否超出特定范围。时间的格式是“ **hh:mm** ”，范围被写入 js 变量从 web.config 读取的 asp.net 页面。

这是该功能的违规位..

```
function WarnOfOOOFlightTime(source, e){
    var val = e.Value.split(':');
    var minVal = oooMin.split(':');
    var maxVal = oooMax.split(':');

    var valHrs = parseInt(val[0]); //"07" here parses to 7
    var valMins = parseInt(val[1]);

    var minValHrs = parseInt(minVal[0]); //"08" here parses to 0!
    var minValMins = parseInt(minVal[1]);

.... 
```

确定它很简单，但我没有得到它..像往常一样非常感谢任何帮助

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:14:37.877

您需要将 radix 参数添加到`parseInt()`，否则它将尝试将带有前导零的数字视为八进制。

```
var n = parseInt(str, 10); 
```

# wordpress - WordPress 电子商务

> ID：12277168
> 
> 赞同：1
> 
> 时间：2012-09-05T08:13:25.890
> 
> 标签：wordpress, web, phpmyadmin, e-commerce

我正在开发在线商店并使用 wordpress 的电子商务插件（[http://wordpress.org/extend/plugins/wp-e-commerce](http://wordpress.org/extend/plugins/wp-e-commerce)）。我在 phpMyAdmin 中找不到包含产品和类别的表格。

你能告诉我关于产品和类别存储的信息吗？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T09:40:37.470

产品存储在 wp_posts 中。正如丹所说，由于产品是自定义帖子类型“wpsc-product”。

# opengl - 在 OpenGL 中批处理三角形条时光照不正确

> ID：12277174
> 
> 赞同：1
> 
> 时间：2012-09-05T08:14:02.493
> 
> 标签：opengl

我正在使用顶点缓冲区（在固定函数管道中）通过重复第一个/最后一个顶点来批处理三角形条带。渲染代码如下：

```
    glBindBuffer(GL_ARRAY_BUFFER, _vertexBuffer);

    // 启用顶点数组
    glEnableClientState(GL_VERTEX_ARRAY);
    glVertexPointer(3, GL_FLOAT, 3*sizeof(GLfloat), 0);

    //准备颜色VBO
    glBindBuffer(GL_ARRAY_BUFFER, _colorBuffer);

    // 启用颜色数组
    glEnableClientState(GL_COLOR_ARRAY);
    glColorPointer(3, GL_FLOAT, 3*sizeof(GLfloat), 0);

    // 准备法线 VBO
    glBindBuffer(GL_ARRAY_BUFFER, _normalBuffer);

    // 启用普通数组
    glEnableClientState(GL_NORMAL_ARRAY);
    glNormalPointer(GL_FLOAT, 0, 0);

    glDrawArrays(mode, 0, _nVertices);      

    // 禁用/解除绑定
    glDisableClientState(GL_VERTEX_ARRAY);
    glDisableClientState(GL_COLOR_ARRAY);
    glDisableClientState(GL_NORMAL_ARRAY);
    glBindBuffer(GL_ARRAY_BUFFER, 0);

```

但是，虽然三角形条被正确分开，但只有第一个三角形条的照明是正确的。

在下面的示例中，我正在渲染一个五边形和一个正方形，您可以看到只有五边形的照明是正确的。

![在此处输入图像描述](../Images/3d52adf3820953cf9df4e72213744e6f.png)

这是 3 个（顶点、法线、颜色）顶点缓冲区中的数据。可以看到五边形的最后一个顶点和正方形的第一个顶点是重复的，而且法线是一致的。

```
顶点：

-2.000000 1.000000 0.000000
-1.000000 0.000000 0.000000
-1.000000 2.000000 0.000000
0.000000 0.000000 0.000000
0.000000 2.000000 0.000000
0.000000 2.000000 0.000000
1.000000 -1.000000 0.000000
1.000000 -1.000000 0.000000
1.000000 -2.000000 0.000000
2.000000 -1.000000 0.000000
2.000000 -2.000000 0.000000

法线：

-0.000000 0.000000 1.000000
-0.000000 0.000000 1.000000
-0.000000 0.000000 1.000000
-0.000000 -0.000000 1.000000
-0.000000 0.000000 1.000000
-0.000000 0.000000 1.000000
-0.000000 0.000000 1.000000
-0.000000 0.000000 1.000000
-0.000000 0.000000 1.000000
-0.000000 0.000000 1.000000
-0.000000 -0.000000 1.000000

颜色：

0.317647 0.011765 0.458824
0.317647 0.011765 0.458824
0.317647 0.011765 0.458824
0.317647 0.011765 0.458824
0.317647 0.011765 0.458824
0.317647 0.011765 0.458824
0.678431 0.003922 0.003922
0.678431 0.003922 0.003922
0.678431 0.003922 0.003922
0.678431 0.003922 0.003922
0.678431 0.003922 0.003922

```

为什么广场的照明不对？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T03:46:28.727

显然，这个问题与组合 2 个三角形条带时添加的退化三角形的数量有关。这可以改变顶点顺序，从而使法线的方向不一致。

当三角形条的当前运行长度为奇数时，我通过添加额外的冗余顶点来解决上述问题。

下面的链接有很多关于三角带的构造和连接的有用信息：

[http://www.codercorner.com/Strips.htm](http://www.codercorner.com/Strips.htm)

# c++ - QTreeWidgetItem 的选择

> ID：12277176
> 
> 赞同：1
> 
> 时间：2012-09-05T08:14:12.473
> 
> 标签：c++, database, qt, user-interface

在这个函数中，我试图将每个 QTreeWidgetItem 与其相应的查询连接起来，一旦我选择了一个项目，就会显示在 tableview 模型中具有查询结果的 Dock 小部件。

我想要的是，当我选择一个新项目时，显示的停靠小部件会隐藏，新的小部件会出现一个新的结果。到现在为止，我选择的每个项目都会出现一个新的 Dock 小部件。我只想看到一个停靠小部件。

这是我的功能

```
void MainWindow::DocumentTable()
{
tableview = new QTableView;
query = new QSqlQueryModel(this);

foreach(it,treeWidget->selectedItems())
{
    for (int col=0; col< it->columnCount(); ++col)
    {
        qDebug() << col << it->text(col);

QSqlQuery qry;
qry.prepare("select * from document where Folno=:Folno");
qry.bindValue(":Folno", it->text(col));
qry.exec();

query->setQuery(qry);

    tableview->setModel(query);
tableview->setEditTriggers(QAbstractItemView::NoEditTriggers);
tableview->show();

Docwidget= new QDockWidget(this);
Docwidget->setAllowedAreas(Qt::LeftDockWidgetArea | Qt::RightDockWidgetArea);

Docwidget->setWidget(tableview);
addDockWidget(Qt::RightDockWidgetArea,Docwidget);
Docwidget->show();

if(!query->submit())
  {
     qDebug() << "Error " << query->lastError().text();
  }

 db.close();

}
}
   } 
```

有任何想法吗 ？？:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T15:01:42.380

不太清楚你在追求什么，但这是我的贡献：

在后面添加一行：

```
query = new QSqlQueryModel(this); 
```

然后，添加这个：

```
QDockWidget * lastDockWidget = NULL; 
```

添加：

```
if (lastDockWidget != NULL)  // If no null, then
    lastDockWidget.hide();   // hide it, delete it, or whatever... 
```

前

```
Docwidget= new QDockWidget(this); 
```

和这个：

```
lastDockWidget = Docwidget; 
```

紧接着：

```
Docwidget= new QDockWidget(this); 
```

结果：

```
void MainWindow::DocumentTable()
{
tableview = new QTableView;
query = new QSqlQueryModel(this);
QDockWidget * lastDockWidget = NULL; // This was added

foreach(it,treeWidget->selectedItems())
{
    for (int col=0; col< it->columnCount(); ++col)
    {
        qDebug() << col << it->text(col);

QSqlQuery qry;
qry.prepare("select * from document where Folno=:Folno");
qry.bindValue(":Folno", it->text(col));
qry.exec();

query->setQuery(qry);

    tableview->setModel(query);
tableview->setEditTriggers(QAbstractItemView::NoEditTriggers);
tableview->show();

if (lastDockWidget != NULL)  // This was added
    lastDockWidget.hide();   // This was added
Docwidget= new QDockWidget(this);
lastDockWidget = Docwidget;  // This was added
Docwidget->setAllowedAreas(Qt::LeftDockWidgetArea | Qt::RightDockWidgetArea);

Docwidget->setWidget(tableview);
addDockWidget(Qt::RightDockWidgetArea,Docwidget);
Docwidget->show();

if(!query->submit())
  {
     qDebug() << "Error " << query->lastError().text();
  }

 db.close();

}
}
   } 
```

希望能帮助到你。

# asp.net-mvc-3 - 从服务器端发送的 MVC3 C# 自定义验证消息

> ID：12277178
> 
> 赞同：0
> 
> 时间：2012-09-05T08:14:26.490
> 
> 标签：asp.net-mvc-3, custom-validators

再会。可能是错误的方式，但这是最快的方式。所以：

我有一个模型，它存储 IP 地址（NetworkMask）只要（整数）（存储在 mssql 表中）然后我需要实现输入和更正我添加未映射字段（IPv4NetworkMask）到模型中的 IP 地址：

```
 [NotMapped]
    public string IPv4NetworkMask{
        get{
            return ExtIP.LongToIPv4(NetworkMask);
        }
        set{
            NetworkMask=ExtIP.StringToIPv4(value);
        }
    } 
```

并进入视野：

```
 <div class="editor-label">
            @Html.LabelFor(model => model.NetworkMask)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.IPv4NetworkMask)
            @Html.ValidationMessageFor(model => model.IPv4NetworkMask)
        </div> 
```

现在一切正常，当用户输入不正确的网络地址时，我在 StringToIPv4 中出现异常，并且执行超出了控制器

```
 if (!ModelState.IsValid)
            return View(NewModelObj); 
```

但在客户端我收到消息：“值'fdgdfgdf'无效。” 如何将此消息更改为其他内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T10:58:54.487

如果您想在业务层执行此操作，可以使用[自定义验证器](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.customvalidationattribute%28v=vs.95%29.aspx)。

例如：

```
public static ValidationResult ValidateIP(string inputIP)
{
   bool isValid = false;

    try {
        ExtIP.StringToIPv4(inputIP);
        isValid = true;
    }
    catch {
    }

    if (isValid)
    {
      return ValidationResult.Success;
    }
    else
    {
      return new ValidationResult(
          "Ip is not in a correct format.");
    }
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T09:23:11.103

我找到了最简单的方法：

```
@Html.ValidationMessageFor(model => model.IPv4NetworkMask, "You have entered incorrect IP") 
```

# php - 使用迭代器渲染多维数组

> ID：12277179
> 
> 赞同：0
> 
> 时间：2012-09-05T08:14:28.370
> 
> 标签：php, arrays, iterator, spl

我有下一个多维数组：

```
Array
(
    [0] => Array
        (
            [id] => 1
            [name] => Category 1
            [parent] => 0
            [children] => Array
                (
                    [0] => Array
                        (
                            [id] => 3
                            [name] => Sub 1
                            [parent] => 1
                            [children] => Array
                                (
                                )
                        )
                    [1] => Array
                        (
                            [id] => 4
                            [name] => Sub 2
                            [parent] => 1
                            [children] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 6
                                            [name] => Sub Sub 4
                                            [parent] => 4
                                            [children] => Array
                                                (
                                                )
                                        )
                                )
                        )
                )
        )
    [1] => Array
        (
            [id] => 2
            [name] => Category 2
            [parent] => 0
            [children] => Array
                (
                    [0] => Array
                        (
                            [id] => 5
                            [name] => Sub 3
                            [parent] => 2
                            [children] => Array
                                (
                                )
                        )
                )
        )
) 
```

我需要在页面上用不同的缩进呈现这个数组。例如：

*   第一类
    *   子 1
    *   子 2
        *   子子 4
*   第 2 类
    *   子 3

我知道我可以使用 SPL RecursiveArrayIterator，但我不知道怎么做。你能帮我吗，如何渲染这样的数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:20:33.717

您可以简单地通过编写一个函数并像这样递归调用它来做到这一点：

```
<?php

function list_items($data)
{
    echo '<ul>';
    foreach ($data as $cat)
    {
        echo '<li>'.$cat['name'];

        if (count($cat['children']) > 0)
        {
            list_items($cat['children']);
        }

        echo '</li>';
    }

    echo '</ul>';
}

$array = array(
    array(
        'id' => 1,
        'name' => 'Category 1',
        'parent' => 0,
        'children' => array(
            array(
                'id' => 3,
                'name' => 'Category 3',
                'parent' => 1,
                'children' => array()
            ),
            array(
                'id' => 4,
                'name' => 'Category 4',
                'parent' => 1,
                'children' => array(                    
                    array(
                        'id' => 5,
                        'name' => 'Category 5',
                        'parent' => 4,
                        'children' => array()
                    ),
                    array(
                        'id' => 6,
                        'name' => 'Category 6',
                        'parent' => 4,
                        'children' => array()
                    )
                )
            )
        )
    ),
    array(
        'id' => 2,
        'name' => 'Category 2',
        'parent' => 0,
        'children' => array(
            array(
                'id' => 7,
                'name' => 'Category 7',
                'parent' => 2,
                'children' => array()
            )
        )
    )
);

list_items($array); 
```

产生：

```
<ul>
    <li>Category 1
        <ul>
            <li>Category 3</li>
            <li>
                Category 4
                <ul>
                    <li>Category 5</li>
                    <li>Category 6</li>
                </ul>               
            </li>
        </ul>   
    </li>
    <li>
        Category 2
        <ul>
            <li>Category 7</li>
        </ul>       
    </li>
</ul> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T08:32:22.230

下面是如何实现 RecursiveArrayIterator （基本上直接从 PHP.net 复制：[http](http://www.php.net/manual/en/class.recursivearrayiterator.php#102574) ://www.php.net/manual/en/class.recursivearrayiterator.php#102574 ）。

老实说，我不确定 ResursiveArrayIterator 对@MattHumphrey 的示例有多大帮助。

```
<?php

$array = [
    [
        'id' => 1,
        'name' => 'Category 1',
        'parent' => 0,
        'children' => [
            [
                'id' => 3,
                'name' => 'Category 3',
                'parent' => 1,
                'children' => []
            ],
            [
                'id' => 4,
                'name' => 'Category 4',
                'parent' => 1,
                'children' => [
                    [
                        'id' => 5,
                        'name' => 'Category 5',
                        'parent' => 4,
                        'children' => []
                    ],
                    [
                        'id' => 6,
                        'name' => 'Category 6',
                        'parent' => 4,
                        'children' => []
                    ]
                ]
            ]
        ]
    ],
    [
        'id' => 2,
        'name' => 'Category 2',
        'parent' => 0,
        'children' => [
            [
                'id' => 7,
                'name' => 'Category 7',
                'parent' => 2,
                'children' => []
            ]
        ]
    ]
];

$iterator = new RecursiveArrayIterator($array);
echo "<ul>";
iterator_apply($iterator, 'traverseStructure', array($iterator));
echo "</ul>";

function traverseStructure($iterator) {
    while ( $iterator -> valid() ) {

        if ( $iterator -> hasChildren() ) {
            echo "<li>Children: <ul>";

            traverseStructure($iterator -> getChildren());

            echo "</li></ul>";

        }
        else {
            echo "<li>" . $iterator -> key() . ' : ' . $iterator -> current() . "</li>";
        }

        $iterator -> next();
    }
} 
```

# javascript - 在 .net MVC 中使用 jquery 变量作为 ActionLink 的参数

> ID：12277181
> 
> 赞同：1
> 
> 时间：2012-09-05T08:14:32.927
> 
> 标签：javascript, asp.net-mvc, jquery, controller

只是我，还是真的很难在 javascript 中使用变量？

我的问题是我想将我的 javascript 函数的一些结果用于 MVC .net 控制器，但我不能！

1.- 我的 JavaScript 函数在视图上运行：

```
 $(document).ready(function () {
           $('#go').click(function () {
             // test for presence of geolocation
             if (navigator && navigator.geolocation) {
                 navigator.geolocation.getCurrentPosition(geo_success, geo_error);

             } else {
                 // nothing at this moment. 
```

……

```
 function geo_success(position) {
         printLatLong(position.coords.latitude, position.coords.longitude);
     } 
```

除了 printLatLong 函数，我想使用参数 position.coord.latitude 通过 Html.ActionLink 将其发送到控制器，如下所示：

```
 @Html.ActionLink("Link to Controller", "Action", "Controller", position.coords.latitude) 
```

但是我不能使用 position.coords.latitude ，因为现在我已经退出了这个功能。我只想在我的 ActionLink 中使用该值作为参数，这太难了吗？:(

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:26:58.193

只需使用 html 锚点并通过 jquery 操作 href 属性即可。

脚本：

```
function geo_success(position) {
    printLatLong(position.coords.latitude, position.coords.longitude);
    var url = '@Url.Action("Geo", "Home")';
    // grab the anchor and modify the url
    $("#geolink").attr("href", url += "?latitude=" + position.coords.latitude);
} 
```

在你看来

```
<a id="geolink">GeoLink</a> 
```

家庭控制器.cs

```
 public ActionResult Geo(int latitude)
    {
        throw new Exception(String.Format("Do something with: {0}", latitude));
    } 
```

# .net - 是否可以从 MVC4 中的部分视图获取回发数据到 Parrent 视图

> ID：12277184
> 
> 赞同：0
> 
> 时间：2012-09-05T08:14:41.327
> 
> 标签：.net, user-interface, razor, web, asp.net-mvc-4

嗨，我正在研究一个解决方案，其中我有两个或多个视图，它们使用相同的模型来显示、编辑和创建。

我研究了部分视图，因为我认为我可以在所有视图中重用大部分视图。

现在我的问题在于我在父视图中组合了多个局部视图，并希望确保我从所有局部视图中获取回发数据到父视图，以便我可以提交或更改底层模型。

这就是我所说的部分：

```
@using (@Html.BeginForm())
{
     @Html.Partial("Person",Model.PersonDetails)
     @Html.Partial("Employment", Model)

     @Html.Action("Save", "Employee")
     @Html.Action("Create", "Employee")
     @Html.Action("Cancel", "Employee")
} 
```

现在各个Partials包含很多editorfor dropdownlistfor labelfor等等。我的问题是这是正确的重用方法，还是有更好、更安全的方法，因为我已经阅读并听说很难甚至不可能获得

编辑：由于一些不相关的问题，我一直在进一步工作，我已将操作更改为如下输入：

```
 <input type="submit" value="Gem" name="submitType" />
<input type="button" value="Anullere" onclick="location.href='@Url.Action("Cancel", "Employee")'" />
<input type="submit" value="Send" name="submitType" /> 
```

编辑：自从上次我意识到我的发送按钮不会将数据作为发布数据发送后，我添加了另一个更改，因此我将其更改为提交按钮。并为我的两个提交按钮命名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:31:50.680

当然，您可以从部分视图收集数据并将它们作为回发数据发送到对应于父视图的操作。在您的情况下，您必须确保所有模型字段都包含在您要提交的主表单中。当触发提交时，您的输入/选择/文本区域字段中的所有值都将被序列化并附加到请求中，并且在服务器端，所有这些数据都将映射到与您的操作相对应的模型/操作参数。

# emacs - 复杂的交互表达

> ID：12277185
> 
> 赞同：1
> 
> 时间：2012-09-05T08:14:44.553
> 
> 标签：emacs, elisp

这就是我一直在使用的：

```
 (interactive "sEnterh the name of the figure (e.g. markov-chain.png): 
sCaption: ") 
```

这就是我想要使用的：

```
 (interactive (list (read-file-name "Image file: " (if (file-exists-p "_static")
                                                        "_static"
                                                      default-directory
                                                      )))
"sCaption: ") 
```

如何才能做到这一点？

用文字来说——可以在一个字符串中混合交互式类型：

```
 (interactive "r
sEnter char to use: 
sNumbering style used (d for digit, l for letter, r for Roman digits): 
sShould I dobule line breaks? (RET for yes) ") 
```

但是如何结合交互式类型，在我的示例中是“s”和 elisp 代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T10:50:24.237

If I understand your question correctly, if you use Lisp code to build a list of arguments to `interactive`, your code needs to handle all the arguments, and you will not have access to the convenience prompting facilities of `interactive`. So your first example would turn into

```
(interactive
  (list
    (read-file-name "Image file: " (if (file-exists-p "_static")
                                       "_static"
                                      default-directory) )
    (read-string "Caption: ") )) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:26:18.417

哦，我在没有交互式类型的情况下解决了它：

```
(defun rst-bk-numfigs ()
  (interactive) 
  (let (Fig Caption)
    (setq Fig (file-name-nondirectory 
               (car (list (read-file-name "Image file: "
                                     (if (file-exists-p "_static") ;; actually I need dir-p
                                         "_static"
                                       default-directory
                                       ))))))
    (setq Caption (read-from-minibuffer "Caption: ")))) 
```

可能无法将交互式类型与 elisp 代码集成。

# python - 太阳传播时间的差异

> ID：12277186
> 
> 赞同：2
> 
> 时间：2012-09-05T08:15:02.210
> 
> 标签：python, sun, pyephem

执行此代码片段：

```
import ephem
oma=ephem.Observer()
oma.lat='50.7975189'
oma.lon='4.3579155'
oma.elevation=114.43
oma.epoch=ephem.now()
sun=ephem.Sun(oma)
print "object transit time: ",sun.transit_time
print "observer next transit time: ", oma.next_transit(sun) 
```

这给出了以下输出：

```
object transit time:  2012/9/5 11:41:03
observer next transit time:  2012/9/5 11:41:06 
```

因此，太阳物体的时间与为太阳观察者计算的时间之间存在 3 秒的差异。两者哪个最靠谱？如果我们将这些值与本地计算值进行比较，则观察者的下一个传输时间是最接近的。

如果我们对火星做同样的计算：

```
import ephem
oma=ephem.Observer()
oma.lat='50.7975189'
oma.lon='4.3579155'
oma.elevation=114.43
oma.epoch=ephem.now()
mars=ephem.Mars(oma)
print "object transit time: ",mars.transit_time
print "observer next transit time: ", oma.next_transit(mars) 
```

这给出了以下输出：

```
object transit time:  2012/9/5 15:05:32
observer next transit time:  2012/9/5 15:05:32 
```

所以没有区别。

此致，

大理石

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T00:10:12.940

要确定哪个函数最准确，只需将它们给您的两次输入到观察者的`compute()`函数中，然后查看当方位角正好为 180° 时哪些着陆点最接近实际的凌日时刻：

```
import ephem
oma = ephem.Observer()
oma.lat, oma.lon = '50.7975189', '4.3579155'
oma.elevation = 114.43
sun = ephem.Sun()
for t in ('2012/9/5 11:41:03',
          '2012/9/5 11:41:06'):
    oma.date = t
    sun.compute(oma)
    print 'azimuth at', t, 'was', sun.az 
```

此脚本的输出表明，`11:41:06`较新`next_transit()`函数的时间给出了更准确的结果：

```
azimuth at 2012/9/5 11:41:03 was 179:58:45.4
azimuth at 2012/9/5 11:41:06 was 179:59:49.5 
```

旧`.transit_time`属性的较低准确性是当前 PyEphem 文档建议始终使用`next_transit()`它适用的所有运输计算的原因。（这意味着除了地球卫星之外的所有东西，`.transit_time`无论如何都会切换到不同的算法。）

事实上，当前的文档甚至没有提到请求`.next_transit`非地球卫星甚至是可能的，并且该属性仅用于古代向后兼容。

这两个函数的工作方式相同：通过猜测时间，检查当时的方位角，然后一遍又一遍地完善他们的猜测，直到他们喜欢答案。更新的`next_transit()`函数在这方面做得更好，所以你应该使用它。

这两个函数给你相同的火星答案的原因只是巧合——如果你在 9 月 5 日以外的日期对火星运行函数，你会看到不同的答案。这完全取决于函数进行一系列猜测的顺序，以及最后的猜测是否碰巧靠近或相距甚远。而且，我敢打赌，即使在 9 月 5 日，他们的答案也没有*真正*匹配——他们只匹配到第二个，这就是所有显示的内容！如果您要通过打印每个答案的 来显示这两个答案的全精度朱利安日期`repr(float(…))`，那么您无疑会发现小数点以下的分歧远远超出了一秒的分辨率能够显示给您的程度。

这是否涵盖了您所有的担忧？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T09:28:00.537

这是因为transit_time 不适用于观察者。

我改进并更改了您的代码：

```
from ephem import Observer, Sun, now
oma=Observer()
oma.lat='50.7975189'
oma.lon='40.3579155'
oma.elevation=114.43
oma.epoch=now()
sun=Sun(oma)
print "object transit time: ",sun.transit_time
print "observer next transit time: ", oma.next_transit(sun) 
```

这给出了：

```
object transit time:  2012/9/6 09:16:48
observer next transit time:  2012/9/7 09:16:27 
```

现在，为什么将 lon 从 4 更改为 40 会有一天的差异（或 -11 秒）？那些 lon 和 lat 以 ehem 表示的单位是什么？我想这不是这个问题的一部分。

# .net - 在 Windows XP 上运行时 TextBox.Text 绑定错误

> ID：12277190
> 
> 赞同：4
> 
> 时间：2012-09-05T08:15:25.840
> 
> 标签：.net, wpf, windows-7, windows-xp

我注意到 WPF 中有一个有趣的错误，我想知道是否其他人也看到了它，如果是，他们是如何解决的？

我有一个`Window`, 里面是一个`GroupBox`, 里面是一个`TextBox`. `DataContext`on设置为我的程序中的`GroupBox`一个对象，因此绑定`TextBox`设置如下：

```
<TextBox Text="{Binding Directory_Data}" IsReadOnly="True"
         Name="dataPath_TextBox" Grid.Column="0" Grid.Row="1"
         Height="23" Margin="6,3,3,3"/> 
```

在 Windows 7（我在其上开发）上，这工作得很好，我什至没有理由对 XAML 的那一行进行三思而后行。然而，在 Windows XP（安装了 .NET4.0）上进行一些测试时，打开它`Window`会导致整个程序崩溃，并出现以下错误：

> 事件类型：clr20r3，system.invalidoperationexception。

我花了很长时间才完成代码，直到最终将其缩小到上面的 XAML 行。

更改`TextBox`为 a `Label`（并将`Text`属性更改为`Content`）可防止此崩溃，并且程序按计划运行；这似乎是一个`TextBox`错误。

虽然可以切换`TextBox`到`Label`（考虑到在我的情况下`ReadOnly`无论如何都会切换），但我更喜欢`TextBox`外观。可能是我必须`Text`从后面的代码手动更新属性。

无论如何，主要是我只是想指出这个问题，以防其他人遇到类似的事情。任何关于为什么会这样的想法都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T15:12:41.677

根据评论中的建议，我`AppDomain.UnhandledException`按照此处概述的方式实施。我之前放了代码：

`app.InitializeComponent();`

`app.Run();`

然后将其输出到a `MessageBox`)。然后重新创建问题，我收到以下消息：

“TwoWay 或 OneWayToSource 绑定不能在只读属性上工作” `TextBox`。

更改它以`OneWay`解决问题，但我不确定为什么会在 XP 而不是 Windows 7 上发生这种情况。制作`TextBox`not`ReadOnly`也可以，但就我而言，我希望它保持不变`ReadOnly`。

# java - Kryo 中的自动课程注册

> ID：12277193
> 
> 赞同：3
> 
> 时间：2012-09-05T08:15:55.050
> 
> 标签：java, kryo

`className`据我了解，Kryo`numberID`在每个`writeObject`. 这张地图太窄了。因为在您的对象模型中，实例往往属于相同的类，接下来 writeObject 将再次构建和序列化类似的映射（一次又一次，一次又一次）。我知道可以通过手动注册类来共享地图，但这是繁琐的手动硬编码。我希望映射将由第一个对象写入启动，就像它通常那样，但是会话中的所有后续写入都将重用和扩展它。这样，注册将在运行时自动发生，没有额外的运行时开销，更频繁使用的对象自然会收到低 ID 号。该映射可以在之后单独存储在附件中，作为解密密钥。反序列化器将从加载此映射开始。你喜欢这个想法，如何实施？

我的问题类似于 [使用 kryo 注册类的策略，](https://stackoverflow.com/questions/7780707/strategy-for-registering-classes-with-kryo)其中用户可以使用列表将所有写入组合在单个 writeObject 下。正如我建议的那样，它甚至比单独存储地图更简单。但是，他似乎并不想这样做。就我而言，这种组合甚至是不可能的，因为大型 java 模型我避免通过分段序列化将其完全保存在内存中。在我的场景中，用户打开一个项目，进行更改并刷新它们。因此，该项目可以维护类映射并将其用于所有序列化。

**更新！**我意识到有类/对象注册器和自动重置。它们似乎是为这项任务而创建的。但是，我不明白这些事情如何解决它。`Autoreset=false`确实使第二次写入要小得多。但是，在这种情况下，我无法反序列化对象。正如您在示例中看到的，第二次反序列化失败：

```
public class A {
    String f1;
    A(String a) {
        f1 = a;
    }
    List list = new ArrayList();
    public String toString() {
        return "f1 = " + f1 + ":" + f1.getClass().getSimpleName();
    }

    public static void main(String[] args) {
        test(true);
        test(false);
    }

    static void write(String time, Kryo kryo, ByteArrayOutputStream baos, Object o) {
        Output output = new Output(baos); 
        kryo.writeClassAndObject(output, o); 
        output.close();
        System.err.println(baos.size() + " after " + time + " write");
    }

    private static void test(boolean autoReset) {
        Kryo kryo = new Kryo();
        kryo.setAutoReset(autoReset);
        kryo.setInstantiatorStrategy(new StdInstantiatorStrategy());
        System.err.println("-------\ntesting autoreset = " + autoReset);
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        A a = new A("a"), b = new A("b");
        write("first", kryo, baos, a);
        write("second", kryo, baos, b);
        A o1 = restore("first", baos, kryo);
        A o2 = restore("second", baos, kryo); // this fails
        System.err.println((o1.f1.equals(o2.f1)) ? "SUCCESS" : "FAILURE");

    }

    private static A restore(String time, ByteArrayOutputStream baos, Kryo k) {
        ByteArrayInputStream in = new ByteArrayInputStream(baos.toByteArray());
        Input input = new Input(in);
        A o = (A) k.readClassAndObject(input);
        System.err.println("reading object " + time + " time, got " + o);
        return o;
    } 
```

输出是

```
-------
testing autoreset = true
41 after first write
82 after second write
reading object first time, got f1 = a:String
reading object second time, got f1 = a:String
SUCCESS
-------
testing autoreset = false
41 after first write
52 after second write
reading object first time, got f1 = a:String
reading object second time, got null
Exception in thread "main" java.lang.NullPointerException
    at kryo_test.AutoresetDemo.test(AutoresetDemo.java:40)
    at kryo_test.AutoresetDemo.main(AutoresetDemo.java:18) 
```

**Update2**除了类名之外，autoReset=false 还可能记录对象引用。确实值得自动重置。

**Update3**我发现很难序列化类的映射（即类 -> 注册），因为注册包含引用 kryo 对象并保持某些状态的序列化程序。那时很难在许多 kryo 对象之间共享地图。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T22:08:26.773

好的，这是kryo-2.20的解决方案

```
public class GlobalClassKryo extends Kryo {

    public static class ExternalizableClassResolver implements ClassResolver {

        //local serializers
        final Map<Class, Registration> fromClass = new HashMap();
        final Map<Integer, Registration> fromId = new HashMap();

        public static class GlobalRegistration { int id; Class type; Class<? extends Serializer> serializer; }

        public final Map<Integer, GlobalRegistration> globalIds; 
        public final Map<Class, GlobalRegistration> globalClasses; 

        // I synchronize because I have one reader and one writer thread and 
        // writer may break the reader when adds something into the map. 
        public ExternalizableClassResolver() {this (
                Collections.synchronizedMap(new HashMap()), 
                Collections.synchronizedMap(new HashMap())
            ) ;}

        public ExternalizableClassResolver(Map<Integer, GlobalRegistration> ids, Map<Class, GlobalRegistration> classes) {
            globalIds = ids;
            globalClasses = classes;
        }

        public ExternalizableClassResolver (DataInput in) throws ClassNotFoundException, IOException {
            this();
            int id;
            while ((id = in.readInt()) != -1) {
                GlobalRegistration e = new GlobalRegistration();
                globalIds.put(e.id = id, e);
                e.type = Class.forName(in.readUTF());
                e.serializer = (Class<? extends Serializer>) Class.forName(in.readUTF());
                globalClasses.put(e.type, e);
            }
        }

        public void save(DataOutput out) throws IOException {
            for (GlobalRegistration entry : globalIds.values()) {
                    out.writeInt(entry.id);
                    out.writeUTF(entry.type.getName());
                    out.writeUTF(entry.serializer.getName());
            }
            out.writeInt(-1);
        }

        static final boolean TRACE = false;
        void log(String msg) {
            System.err.println(kryo != null ? Utils.fill(kryo.getDepth(), ' ')  + msg : msg);
        }
        @Override
        public Registration writeClass(Output output, Class type) {
            if (type == null) {output.writeInt(0, true); return null;}
            Registration registration = kryo.getRegistration(type);
            output.writeInt(registration.getId(), true);
            return registration;
        }
        @Override
        public Registration readClass(Input input) {
            int classID = input.readInt(true);
            if (classID == 0) return null;
            Registration registration = fromId.get(classID);
            if (registration == null) {
                registration = tryGetFromGlobal(globalIds.get(classID), classID + "");
            }
            if (registration == null) throw new KryoException("Encountered unregistered class ID: " + classID);
            return registration;
        }

        public Registration register(Registration registration) {
            throw new KryoException("register(registration) is not allowed. Use register(type, serializer)");
        }

        public Registration getRegistration(int classID) {
            throw new KryoException("getRegistration(id) is not implemented");
        }

        Registration tryGetFromGlobal(GlobalRegistration globalClass, String title) {
            if (globalClass != null) {
                Serializer serializer = kryo.newSerializer(globalClass.serializer, globalClass.type);
                Registration registration = register(globalClass.type, serializer, globalClass.id, "local");
                if (TRACE) log("getRegistration(" + title + ") taken from global => " + registration);
                return registration;
            } else
                if (TRACE) log("getRegistration(" + title + ") was not found");
            return null;
        }
        public Registration getRegistration(Class type) {
            Registration registration = fromClass.get(type);
            if (registration == null) {
                registration = tryGetFromGlobal(globalClasses.get(type), type.getSimpleName());
            } else
                if (TRACE) log("getRegistration(" + type.getSimpleName() + ") => " + registration);

            return registration;
        }

        Registration register(Class type, Serializer serializer, int id, String title) {
            Registration registration = new Registration(type, serializer, id);
            fromClass.put(type, registration);
            fromId.put(id, registration);

            if (TRACE) log("new " + title + " registration, " + registration);

            //why dont' we put into fromId?
            if (registration.getType().isPrimitive()) fromClass.put(getWrapperClass(registration.getType()), registration);
            return registration;
        }

        int primitiveCounter = 1; // 0 is reserved for NULL
        static final int PRIMITIVE_MAX = 20;

        //here we register anything that is missing in the global map. 
        // It must not be the case that something available is registered for the second time, particularly because we do not check this here
        // and use registered map size as identity counter. Normally, check is done prior to callig this method, in getRegistration
        public Registration register(Class type, Serializer serializer) {

            if (type.isPrimitive() || type.equals(String.class))
                return register(type, serializer, primitiveCounter++, "primitive");

            GlobalRegistration global = globalClasses.get(type);

            if (global != null )
                    throw new RuntimeException("register(type,serializer): we have " + type + " in the global map, this method must not be called");

            global = new GlobalRegistration();
            globalIds.put(global.id = globalClasses.size() + PRIMITIVE_MAX, global); 
            globalClasses.put(global.type = type, global);
            global.serializer= serializer.getClass();

            return register(global.type, serializer, global.id, "global");
        }

        public Registration registerImplicit(Class type) {
            throw new RuntimeException("registerImplicit is not needed since we register missing automanically in getRegistration");
        }

        @Override
        public void reset() {
            // super.reset(); //no need to reset the classes
        }

        Kryo kryo;
        public void setKryo(Kryo kryo) {
            this.kryo = kryo;
        }
    }

    public ExternalizableClassResolver ourClassResolver() {
        return (ExternalizableClassResolver) classResolver;
    }

    public GlobalClassKryo(ClassResolver resolver) {
        super(resolver, new MapReferenceResolver()); 
        setInstantiatorStrategy(new StdInstantiatorStrategy());
        this.setRegistrationRequired(true);
    }
    public GlobalClassKryo() {
        this(new ExternalizableClassResolver());
    }

    @Override
    public Registration getRegistration (Class type) {
        if (type == null) throw new IllegalArgumentException("type cannot be null.");

        if (type == memoizedClass) return memoizedClassValue;
        Registration registration = classResolver.getRegistration(type);
        if (registration == null) {
            if (Proxy.isProxyClass(type)) {
                // If a Proxy class, treat it like an InvocationHandler because the concrete class for a proxy is generated.
                registration = getRegistration(InvocationHandler.class);
            } else if (!type.isEnum() && Enum.class.isAssignableFrom(type)) {
                // This handles an enum value that is an inner class. Eg: enum A {b{}};
                registration = getRegistration(type.getEnclosingClass());
            } else if (EnumSet.class.isAssignableFrom(type)) {
                registration = classResolver.getRegistration(EnumSet.class);
            }
            if (registration == null) {
                //registration = classResolver.registerImplicit(type);
                return register(type, getDefaultSerializer(type));
            }
        }
        memoizedClass = type;
        memoizedClassValue = registration;
        return registration;
    }

    public Registration register(Class type, Serializer serializer) {
        return ourClassResolver().register(type, serializer);}

    public Registration register(Registration registration) {
        throw new RuntimeException("only register(Class, Serializer) is allowed");}

    public Registration register(Class type) {
        throw new RuntimeException("only register(Class, Serializer) is allowed");}

    public Registration register(Class type, int id) {
        throw new RuntimeException("only register(Class, Serializer) is allowed");}

    public Registration register(Class type, Serializer serializer, int id) {
        throw new RuntimeException("only register(Class, Serializer) is allowed");
    }

    static void write(String title, Kryo k, ByteArrayOutputStream baos, Object obj) {
        Output output = new Output(baos);
        k.writeClassAndObject(output, obj);
        output.close();
        System.err.println(baos.size() + " bytes after " + title + " write");
    }
    static class A {
        String field = "abcABC";
        A a = this;
        //int b = 1; // adds 1 byte to serialization
        @Override
        public String toString() {
            return field 
                    + " " + list.size() 
                    //+ ", " + b
                    ;
        }

        // list adds 3 bytes to serialization, two 3-byte string items add additionally 10 bytes in total
        ArrayList list = new ArrayList(100); // capacity is trimmed in serialization
        {
            list.add("LLL");
            list.add("TTT");

        }
    }

    private static void test() throws IOException, ClassNotFoundException {
        GlobalClassKryo k = new GlobalClassKryo();

        ByteArrayOutputStream baos = new ByteArrayOutputStream();

        write("first", k, baos, new A()); // write takes 24 byts

        //externalize the map
        ByteArrayOutputStream mapOut = new ByteArrayOutputStream();
        DataOutputStream dataOut = new DataOutputStream(mapOut);
        k.ourClassResolver().save(dataOut);
        dataOut.close();

        //deserizalize the map
        DataInputStream serialized = new DataInputStream(new ByteArrayInputStream(mapOut.toByteArray()));
        ExternalizableClassResolver resolver2 = new ExternalizableClassResolver(serialized);

        //use the map
        k = new GlobalClassKryo(resolver2);
        write("second", k, baos, new A()); // 24 bytes

        Input input = new Input(new ByteArrayInputStream(baos.toByteArray()));
        Object read = k.readClassAndObject(input);
        System.err.println("output " + read);
    }

    public static void main(String[] args) throws IOException, ClassNotFoundException {
        Kryo k = new Kryo();
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        write("first", k, baos, new A()); // write takes 78 bytes
        write("second", k, baos, new A()); // +78 bytes
        System.err.println("----------------");

        test();
    }
} 
```

结果流没有类名。不幸的是，与默认的 java 序列化（2x 或更多）相比，Kryo 太慢了，尽管它产生的流更加密集。仅 Kryo 就使我的示例序列化几乎缩小了 10 倍。您会看到此答案中提出的解决方案增加了 3 倍的附加因子。但是，在我序列化兆字节的字段中，相对于 java 序列化，我得到的压缩只有 2 倍，而使用 Kryo 存储到磁盘时，速度会降低 2 倍。

# c++ - 如何访问嵌套的 stl 元素？

> ID：12277195
> 
> 赞同：0
> 
> 时间：2012-09-05T08:15:57.113
> 
> 标签：c++, stl

我有以下代码：

```
set< vector<int> > set_of_things;
vector<int> triplet(3);

//set_of_things.push_back(stuff) - adding a number of things to the set 
```

我现在如何遍历集合并打印所有元素？

该集合是三元组的集合，因此输出应如下所示：

```
1 2 3 
3 4 5
4 5 6 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T08:17:56.647

`for`这对于 C++11 中引入的新的基于范围的循环来说是直截了当的：

```
for (auto const & v : set_of_things)
{
    for (auto it = v.cbegin(), e = v.cend(); it != e; ++it)
    {
        if (it != v.cbegin()) std::cout << " ";
        std::cout << *it;
    }
    std::cout << "\n";
} 
```

如果您不介意尾随空格：

```
for (auto const & v : set_of_things)
{
    for (auto const & x : v)
    {
        std::cout << *it << " ";
    }
    std::cout << "\n";
} 
```

或者使用[漂亮的打印机](https://stackoverflow.com/questions/4850473/pretty-print-c-stl-containers)：

```
#include <prettyprint.hpp>
#include <iostream>

std::cout << set_of_things << std::endl; 
```

如果您有一个较旧的编译器，则必须根据迭代器拼写出两个迭代。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T08:17:32.200

您使用迭代器：

```
for ( std::set<vector<int> >::iterator it = set_of_things.begin() ; 
      it != set_of_things.end() ; 
      it++ )
{
   // *it is a `vector<int>`
} 
```

在 C++11 中，您可以`auto`使用`std::set<vector<int> >::iterator`.

如果您不修改迭代器，则应使用 a`const_iterator`代替。

# virtuemart - 德德玛特 2 中的每公斤价格

> ID：12277198
> 
> 赞同：0
> 
> 时间：2012-09-05T08:16:00.573
> 
> 标签：virtuemart

我需要设置每公斤的价格（西红柿），

有没有办法直接在管理员中做到这一点？

我需要编码吗？如果是这样，你能否给一个开始的地方，我确定这一定存在，但我找不到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T22:03:53.447

我会试试这个[http://extensions.virtuemart.net/extensions-virtuemart-2/custom-size-detail](http://extensions.virtuemart.net/extensions-virtuemart-2/custom-size-detail)

# c# - 部署为 SharePoint 2010 解决方案的 wcf 的“访问被拒绝”

> ID：12277199
> 
> 赞同：1
> 
> 时间：2012-09-05T08:16:09.643
> 
> 标签：c#, wcf, sharepoint, exception-handling, permissions

我创建了一个 wcf（C# Visual Studio 2010）并将 wsp 作为解决方案安装在 SharePoint 2010 服务器（不在同一台机器上）上。在 der Studio-Project 中，svc 和配置文件位于映射的 ISAPI 文件夹的子文件夹中。SharePoint 中的部署运行良好，IIS7.5 上的虚拟 _vti_bin 文件夹中的 svc 文件是可浏览的。在 testclient 中，我可以设置对服务的引用。当我调用一个返回“Hello World”的方法时没问题。但是当我尝试从 Sharepoint 读取值时，总是会出现以下异常：

```
System.ServiceModel.Security.SecurityAccessDeniedException was unhandled
  Message=Access is denied.
  Source=mscorlib
  StackTrace:
    Server stack trace: 
       at System.ServiceModel.Channels.ServiceChannel.ThrowIfFaultUnderstood(Message reply, MessageFault fault, String action, MessageVersion version, FaultConverter faultConverter)
       at System.ServiceModel.Channels.ServiceChannel.HandleReply(ProxyOperationRuntime operation, ProxyRpc& rpc)
       at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs)
       at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)
       at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)
Exception rethrown at [0]: 
       at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
       at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
       at mgbahn.sharepoint.test.forms.SharePointService_Share.ISharePointService.GetDocumentTitles()
       at mgbahn.sharepoint.test.forms.SharePointService_Share.SharePointServiceClient.GetDocumentTitles() in D:\MGBScratch\src\sharepoint\mgbahn.sharepoint.test.forms\Service References\SharePointService_Share\Reference.cs:line 57
       at mgbahn.sharepoint.test.forms.TestFormWCF..ctor() in D:\MGBScratch\src\sharepoint\mgbahn.sharepoint.test.forms\TestFormWCF.cs:line 23
       at mgbahn.sharepoint.test.forms.Program.Main() in D:\MGBScratch\src\sharepoint\mgbahn.sharepoint.test.forms\Program.cs:line 15
       at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)
       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart() 
```

没关系，我尝试从 Sharepoint 读取什么样的信息，错误总是一样的。

我是 wcf 的新手，我对 IIS 的了解非常少。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T08:48:43.483

还要检查 wcf 端口是否未被防火墙阻止。

# bash - Bash脚本openssl加密，md5 in pass问题

> ID：12277201
> 
> 赞同：2
> 
> 时间：2012-09-05T08:16:23.013
> 
> 标签：bash, encryption, openssl

我正在尝试创建一个用于加密文件的脚本方法，我试图让它执行以下操作：

对我们正在加密的文件进行 MD5 校验和，仅剥离 MD5 值并将其放入变量中，

向用户询问密码，（希望我可以使用 openssl 输入法输入密码，而不必使用来自 bash 的输入，如果它打印到终端似乎不太安全）但我不知道该怎么做，有没有一种有效的安全方式来做到这一点？

无论如何，取那个密码，加上一个#，然后是md5总和，IE：passhere#md5sumoforiginalfile

在一个完美的世界中，它会首先 tar.gz 文件并对压缩存档执行加密。

这就是我有点难过的地方，我在打印 md5 并将 md5 哈希合并到密码中时遇到问题，按原样输入也感觉不对，有更好的方法吗？

提前谢谢大家！

这是函数（最初由作者：Matt Reid 从网络上的另一个脚本中获取）

```
function encrypt() {
filein="$1"
fileout="$2"

if [ "$filein" = "no" ]; then
    echo -n "No input file specified, what file are we encrypting: "
    read filein
fi

if [ -r "$filein" ]; then
    if [ "$fileout" = "no" ]; then
        fileout="$filein.aes256"
    fi
    if [ -f "$fileout" ]; then
        echo "Output file exists already, encrypting will overwrite this file."
        echo -n "Do you want to encrypt anyway? [Y/n]: "
        read choice
        if [ "$choice" = "Y" ] || [ "$choice" = "y" ] || [ "$choice" = "" ]; then
    openssl enc -aes-256-cbc -a -salt -in $filein -out $fileout
            generate_digests $filein $fileout
            sdelete $filein
            exit 0;
        else 
            exit 2;
        fi      
    else
    filemd5=$(openssl dgst -md5 $filein | cut -d '  ' -f 1)
    echo "Please enter password: "
        read passvar
    openssl enc -aes-256-cbc -a -salt -out $fileout -k ${passvar}#${filemd5}
        generate_digests $filein $fileout
        sdelete $filein
        exit 0;
    fi
else
    echo "Input file does not exist or is not readable. You're attempting to encrypt file: '$filein'"
    exit 1;
fi
} 
```

编辑：好的，我能够得到这个工作（减去焦油部分），但我的问题仍然存在，有没有办法改变这个，所以我可以使用 openssl enc 的隐藏输入作为密码以及如何修改输入的密码通过附加 #md5sumhere ？不太清楚该怎么做。

再次感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T08:36:13.147

我会使用散列密码而不是明文密码：

```
salt="astringtobeusedassalt"
hashedpassword=`openssl passwd -salt $salt`
echo $hashedpassword
finalpassword="$hashedpassword""#""$filemd5" # $filemd5 variable from your script 
```

作为旁注：`sha1`计算摘要时请使用或以上（`sha256`更可取）

# android - 在galaxy s2上运行android应用

> ID：12277202
> 
> 赞同：0
> 
> 时间：2012-09-05T08:16:24.717
> 
> 标签：android, eclipse, eclipse-plugin, galaxy

作为我在 B.Sc 的最终项目的一部分，我需要在 android 中开发。我完成了这个阶段：

1.  购买 Galaxy s2 android 4.0.4(ics)。
2.  安装了 eclipse 上一个版本（juno）。
3.  安装 sdk 版本 20。
4.  安装了 adk last ver+ DDMS。
5.  为手机驱动程序安装了凯斯。
6.  在模拟器上运行这个小应用程序。 [简单教程](http://www.vogella.com/articles/Android/article.html#tutorial_temperature)
7.  打开USB调试。
8.  将手机连接到计算机，计算机识别了 pone。

**失败的：**

1.  在手机上运行程序（模拟器正在启动而不是）。
2.  在手机连接到计算机时调试程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:19:35.780

设置您的系统以检测您的设备。
如果您在 Windows 上开发，则需要为 adb 安装 USB 驱动程序。有关 OEM 驱动程序的安装指南和链接，请参阅 OEM USB 驱动程序文档。
如果你在 Mac OS X 上开发，它就可以工作。跳过此步骤。
如果您在 Ubuntu Linux 上进行开发，则需要添加一个 udev 规则文件，其中包含您要用于开发的每种设备的 USB 配置。在规则文件中，每个设备制造商都由唯一的供应商 ID 标识，由 ATTR{idVendor} 属性指定。

检查此链接：http: [//developer.android.com/tools/device.html](http://developer.android.com/tools/device.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:28:27.650

按照本教程可能对您有所帮助[这是链接](http://developer.android.com/tools/device.html)

三星有一个单独的驱动程序，用于将他们的 Android 设备连接到 Windows 机器。我认为 Kies 有一个选项可以安装它

# ruby - 在 nginx 和 Thin（当然是 linux）下部署 Sinatra 应用程序的最快黑客

> ID：12277206
> 
> 赞同：0
> 
> 时间：2012-09-05T08:16:48.290
> 
> 标签：ruby, linux, nginx, sinatra, thin

我正在尝试找出在 nginx 和瘦身下部署 sinatra 应用程序的最佳实践！任何指南或源代码将不胜感激。

我不想使用乘客或 Apache .. 因为我的预感是 nginx 和瘦将是一个更快的组合。另一方面，如果没有 nginx，thin 可以自己更快吗？这将是我接下来要弄清楚的事情。

谢谢大家的关注。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T00:43:20.257

我建议您在决定选择其中任何一个之前，先用 unicorn、puma 和 thin 对您的 Sinatra 应用程序进行基准测试。对于我的应用程序，我发现 unicorn 的性能比瘦的要好得多，但仅限于高负载时。

您可以在以下位置阅读我的结果：

[http://ylan.segal-family.com/blog/2012/08/20/better-performance-on-heroku-thins-vs-unicorn-vs-puma/](http://ylan.segal-family.com/blog/2012/08/20/better-performance-on-heroku-thins-vs-unicorn-vs-puma/)

确保您的基准测试位于尽可能接近您预期的生产环境的环境中（我使用了登台服务器）。

# mongodb - 制作复合地理标签 mongodb 索引格式，同时指定位等

> ID：12277209
> 
> 赞同：0
> 
> 时间：2012-09-05T08:17:01.693
> 
> 标签：mongodb

我想做geo Hastag mongodb 但我不知道格式正确

这是我从网站 mongo 读取的格式：

```
db.places.ensureIndex( { loc : "2d"} , { bits : 26 } ) 
```

我想添加一些字段索引，但与地理标签相同的索引。

类似 [http://www.mongodb.org/display/DOCS/Geospatial+Haystack+Indexing](http://www.mongodb.org/display/DOCS/Geospatial+Haystack+Indexing)

但是，我希望索引是复合索引吗？

我应该做

```
db.tablebusiness.ensureIndex( {"LongitudeLatitude" : "2d", 
                               "indexContents" : 1, 
                               "Prominent" : -1 } , 
                              { bits : 22 } ) 
```

如果我这样做，mongodb 怎么知道 bits:22 是索引的 LongitudeLatitude 部分的选项？

干草堆索引的等价物是什么？

```
db.tablebusiness.ensureIndex( {"LongitudeLatitude" : "geoHaystack", 
                               "indexContents" : 1, 
                               "Prominent" : -1 } , 
                              { bits : 22 ,bucketsize: .2} ) 
```

那是对的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:44:15.210

这是一个语法问题。你上面的假设是正确的。由于 mongoDB 仅支持一个地理空间索引，并且您指定索引的 LongitudeLatitude 部分是带有“2d”索引标志的地理空间索引（而不是 1 表示升序，-1 表示降序），它知道 bits 参数是传递给 ensureIndex 对应于 LongitudeLatitude 字段。

Haystack 索引也是如此。

# android - 支持的android版本和编译android版本？

> ID：12277214
> 
> 赞同：0
> 
> 时间：2012-09-05T08:17:38.023
> 
> 标签：android, version, aviary

我将尝试[aviary](http://www.aviary.com/android-documentation)，并在文档中找到这些词：

> Aviary Android SDK 支持 Android 2.2+ 作为 minSdkVersion，但它必须使用 Android 4.0（API 级别 14）作为目标 sdk 进行编译。这意味着您的应用程序必须在“Project Build Target”Eclipse 面板中选择“Android 4.0”。

我很困惑为什么它必须**使用 android 4.0 编译**并同时**支持 Android 2.2**？如果我用它写一个应用程序，它可以在android 2.2 手机上运行吗？如果是，为什么需要 android 4.0 来编译？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:28:45.423

AndEngine 需要 Android 4.0 才能编译，但它会检查手机的 Android 版本是否正在运行，以确保它只会调用与该版本兼容的 API。因此，尽管它是使用 android 4.0 编译的，但它可以在 Android 2.3 设备中正常运行。我想这同样适用于 Aviary。

这个链接很有用：http: [//developer.android.com/training/basics/supporting-devices/platforms.html](http://developer.android.com/training/basics/supporting-devices/platforms.html)

# javascript - jquery：如何链接函数？

> ID：12277216
> 
> 赞同：1
> 
> 时间：2012-09-05T08:17:42.343
> 
> 标签：javascript, jquery, jquery-plugins

我使用 jquery 很长一段时间，并考虑自己创建一个插件。但是无论教程多么简单，我都无法真正掌握链接的想法。假设我有这个非常简单的插件....

```
(function($){
      $.test = function(){

        $.test.one = function(){ alert("1");};

        $.test.two = function(){ alert("2");};

        return this.each(function(){
             (what to write here????)
        });
      };
 })(jQuery); 
```

我想要完成的是，当我打电话时，例如

```
var myplugin = $.test();
myplugin.one().two(); 
```

但它返回给我错误。对不起，我尝试了很多次谷歌搜索简单的教程，但我无法让它工作

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T08:25:44.453

你想这样做吗？

```
(function($){
    $.fn.test = function(){
        var self = this;
        this.one = function(){ alert("1"); return self; };
        this.two = function(){ alert("2"); return self; };
        return this;
    };
}(jQuery));

var myplugin = $().test();
myplugin.one().two(); 
```

小提琴示例：http: [//jsfiddle.net/kzzMY/](http://jsfiddle.net/kzzMY/)

作为旁注，我强烈建议这个主题的有用资源：http: [//jqueryboilerplate.com/](http://jqueryboilerplate.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T08:22:44.433

这是我的插件模板：

```
(function($){
  $.fn.pluginName = function(){

  }
  return this;
})(jQuery) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T08:23:25.300

我自己从来没有写过 jQuery 插件，但你肯定需要从你的方法`one`和`two`（可能是' `this`'）中返回一些东西，否则你的链中的第二个方法没有对象可以被调用。

# c - 使用 C（不是 C++）处理 R 稀疏矩阵（dgCMatrix）

> ID：12277217
> 
> 赞同：1
> 
> 时间：2012-09-05T08:17:44.400
> 
> 标签：c, r, sparse-matrix

有人可以给我关于如何`Matrix`使用 C 操作 dgCMatrix 类稀疏矩阵（来自包）的提示/指针吗？我找到了一些关于使用 C++ 进行处理的示例（`RCppEigen`特别是使用），但找不到任何可以告诉我如何使用 C 进行处理的示例。我不熟悉 C++ 并打算坚持使用 C。

一些上下文：我正在对每一行巨大的稀疏矩阵（20kX100k）执行一些操作。当我使用`for`循环遍历每一行时，它非常非常慢。所以我尝试定义一个函数，并`apply`在矩阵的每一行上使用 - 但`apply`给了我矩阵的转置，而且重要的是，得到的矩阵不再是稀疏矩阵，而是常规矩阵）。所以我必须转置这个（非稀疏矩阵）以获得我需要的矩阵，然后再次将这个结果矩阵转换为`Matrix`类对象。至少可以说效率不高，因此我希望使用 C 来做我想做的事情。

# web-applications - 如何将 OAuth 与已部署的 Web 应用程序一起使用？

> ID：12277218
> 
> 赞同：1
> 
> 时间：2012-09-05T08:17:49.007
> 
> 标签：web-applications, oauth, oauth-2.0

我们是具有 Web 应用程序的 ISV。与 StackExchange 或 Trello 不同，此 Web 应用程序安装在客户站点上，因此每个 Web 应用程序安装都有一个单独的 URL。即：[http](http://app.example.com/) ://app.example.com/和[http://app.microsoft.com/](http://app.microsoft.com/)都可以是我们应用程序的有效 URL。

我们想使用 OAuth 访问用户的 Google 数据（一个简单的首次使用导入来启动应用程序数据库）。我们的问题是试图弄清楚如何使这项工作。

Web 应用程序（客户端）的 OAuth 依赖于在授权机构（在我们的例子中是 Google）注册的重定向 URL。如果您是 Trello 或 StackExchange，您只有一个 URL，然后将其放入。由于我们安装在很多地方，我们可以有很多 URL，我们不知道它们是什么，所以我们不能告诉 Google 哪些 URL提前使用。

客户端应用程序（Windows 客户端等）的 OAuth 通过在窗口标题中返回响应而不是重定向来解决此问题。这对于完全控制浏览器的应用程序来说非常有用——即控制沙箱，但对于普通浏览器来说，跨站点安全限制使得从谷歌响应窗口获取秘密是不可能的。

在 OAuth 世界中，我们似乎陷入了两种困境。不是 Web 应用程序，也不是客户端应用程序。

我们如何将 OAuth 与安装在多个位置的多个 Web 应用程序一起使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T00:44:23.230

抱歉，注册过程的存在是有原因的。如果它位于多家公司拥有的多个 URL 上，它们将被视为单独的应用程序，它们应使用不同的客户端 ID/客户端密码并由相应的所有者注册。您只需向客户提供有关他们应如何注册应用程序的说明，或者如果您有服务团队安装它，则将其作为部署过程的一部分。

构建多租户应用程序有很多好处，而不必这样做只是其中之一！

# javascript - 点击事件不起作用

> ID：12277222
> 
> 赞同：1
> 
> 时间：2012-09-05T08:18:03.267
> 
> 标签：javascript, jquery

在 chrome 中，没有错误，没有警告，甚至没有信息。它只是行不通。

```
 $(document).ready(function () {
        var cbxAdmins = $("input[name^=hasAdmin][type=checkbox]");
        for (var i = 0; i < cbxAdmins.Length; i++) {

            cbxAdmins[i].click(function () {
                var checkAll = this.checked;
                var permiCheckboxes = $(this).parents("tr:first").find(':checkbox');

                if (checkAll) {
                    $(permiCheckboxes).attr('checked', true);
                }
                else {
                    $(permiCheckboxes).attr('checked', '');
                }
            });
        }

    }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T08:20:44.173

您不需要`for`遍历数组中的所有元素，jQuery 足够聪明，可以单独应用 click 事件。试试这个：

```
$(document).ready(function () {
    $("input[name^=hasAdmin][type=checkbox]").click(function () {
        $(this).closest("tr").find('[type=checkbox]').prop('checked', this.checked);
    });
}); 
```

感谢 Fabricio Matte，我还稍微整理了一些逻辑。

# .htaccess - 重写子域

> ID：12277225
> 
> 赞同：0
> 
> 时间：2012-09-05T08:18:19.537
> 
> 标签：.htaccess, mod-rewrite, rewrite

我正在尝试使用重写规则生成子域。
它应该如下所示：

[http://www.example.com.dev/folder/default.html](http://www.example.com.dev/folder/default.html)
到
[http://folder.example.com.dev/default.html](http://folder.example.com.dev/default.html)

这是据我所知：
`RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} !www.example.com.dev$ [NC]
RewriteCond %{HTTP_HOST} ^(www.)?([a-z0-9-]+).example.com.dev$ [NC]
RewriteRule (.*) %2/ [L]`

我对此很陌生，所以你能帮我吗？
感谢您的意见

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:22:25.733

你很接近，试试这个：

```
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} !^www\.example\.com\.dev$ [NC]
RewriteCond %{HTTP_HOST} ^(www\.)?([a-z0-9-]+)\.example\.com\.dev$ [NC]
RewriteRule ^(.*)$ http://www.example.com.dev/%2/$1 [L,P] 
```

# java - 如何在我的 DAO (Java EE) 中处理连接对象

> ID：12277228
> 
> 赞同：0
> 
> 时间：2012-09-05T08:18:39.897
> 
> 标签：java, database, jakarta-ee, web, connection

我必须创建一个连接到 MySQL 数据库的 Web 应用程序。我想知道我应该如何处理我的 DAO 中的连接对象。

该应用程序很可能每天被不同的用户使用几次。

我对 DAO 模式和使用静态单例有点困扰。由于它是一个网络应用程序，我将永久连接到数据库。我觉得保持这种连接并在所有用户会话之间共享并不是很好。

另一方面，我不太确定每次需要访问 Db 时获取连接并关闭它真的是一个更好的主意。

一种方式比另一种更好吗？我是否忘记了任何可以做得更好的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:34:03.020

通常，您将在容器中设置数据源，并且对于每个操作，只需从数据源获取连接。使用正确的事务管理器设置，在同一事务下检索到的连接应该是相同的。连接池通常在数据源中处理。

# html - 帖子中传递的最大参数数

> ID：12277231
> 
> 赞同：17
> 
> 时间：2012-09-05T08:18:57.227
> 
> 标签：html, jboss

我收到此错误：

```
Exception during request processing:
Caused by javax.servlet.ServletException with message:
"Parameter count exceeded allowed maximum: 512" 
```

帖子中传递的参数数量似乎有限制。

如何在 JBoss 中扩展此限制？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-05T08:23:37.777

所有 Web 服务器中的参数数量都受到限制，以[阻止 hashmap 冲突拒绝服务攻击](https://stackoverflow.com/questions/8669946/application-vulnerability-due-to-non-random-hash-functions)。

您可以通过将以下系统属性添加到配置文件（例如`standalone.xml`）来提高限制：

```
<property name="org.apache.tomcat.util.http.Parameters.MAX_COUNT" value="10000"/> 
```

（[来源](https://community.jboss.org/thread/197650)）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-07-18T10:47:30.300

以防万一：对于普通的 Tomcat，相应的解决方案是添加：

```
org.apache.tomcat.util.http.Parameters.MAX_COUNT=10000 
```

在`catalina.properties`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-07-11T08:12:55.647

是的，没错！Aaron Digulla 先生答对了！
但请注意：在 Jboss 7 中，请插入该行

`<system-properties>`
`<property name="org.apache.tomcat.util.http.Parameters.MAX_COUNT"value="10000"/>` `</system-properties>`

在`<extensions>`标签之后，如果不是 Jboss 7 在解析standalone.xml 时会出错，让我举个例子：

```
<?xml version='1.0' encoding='UTF-8'?>
<server xmlns="urn:jboss:domain:1.2">
<extensions>
    <extension module="org.jboss.as.clustering.infinispan"/>
    <extension module="org.jboss.as.configadmin"/>
    ...
</extensions>
<system-properties>
    <property name="org.apache.tomcat.util.http.Parameters.MAX_COUNT" value="10000" />
</system-properties> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-14T07:44:52.373

您需要将以下代码段粘贴到 Jboss 服务器的standalone.xml 中：

```
<server name="default-server">
                <http-listener name="default" socket-binding="http" max-parameters="5000"/>
                <https-listener name="https" socket-binding="https" max-parameters="5000"/>
                <host name="default-host" alias="localhost">
                    <location name="/" handler="welcome-content"/>
                    <filter-ref name="server-header"/>
                    <filter-ref name="x-powered-by-header"/>
                    <http-invoker security-realm="ApplicationRealm"/>
                </host> 
```

专注于具有最大参数值的 HTTP 侦听器标记是不同之处。该字段的默认值为：-

```
org.apache.tomcat.util.http.Parameters.MAX_COUNT=1000 
```

这是作为对[此处讨论的 hashmap 冲突拒绝服务攻击的补救措施而完成的](https://stackoverflow.com/questions/8669946/application-vulnerability-due-to-non-random-hash-functions)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-01T18:05:27.550

如果您使用 WildFly，另一种方法是编辑**`standalone.xml`**文件并添加**`max-parameters`**：

**`<http-listener name="default" socket-binding="http" max-parameters="2690"/>`**

独立.xml 示例：

```
...

<subsystem xmlns="urn:jboss:domain:undertow:1.1">
   <buffer-cache name="default"/>
   <server name="default-server">
       <!-- change here-->
       <http-listener name="default" socket-binding="http" max-parameters="2690"/>
       <!-- change here-->
       <host name="default-host" alias="localhost">
           <location name="/" handler="welcome-content"/>
           <filter-ref name="server-header"/>
           <filter-ref name="x-powered-by-header"/>
       </host>
    </server>

... 
```

# web-applications - 如何创建基于串行密钥的激活机制，以及在 DB 上存储哪些数据？

> ID：12277232
> 
> 赞同：0
> 
> 时间：2012-09-05T08:18:57.197
> 
> 标签：web-applications, encryption, language-agnostic, activation

我目前正在研究如何为基于 Web 的产品管理平台创建基于序列密钥的激活机制（语言无关紧要，因为这更像是一个设计问题），其中每个产品已售出具有注册在线支持的许可证密钥。

我有一个串行密钥编码器/解码器类，它生成 AES 加密数据，然后进行 base32 编码以返回人类可读的密钥；我需要弄清楚要在那里加密什么，它是否应该包含实际的产品代码或什么。

此外，编码器也会为每个序列生成不同的解密密钥，但我不确定我是否喜欢这种方法。在这和每个键使用盐之间哪个最好？另外，我应该在哪里存储解密密钥和盐？我正在考虑数据库以及激活密钥、盐或解密密钥，以防当前方法有效，这是正确的吗？

我还需要保持密钥长度不变，这意味着我不能在加密中传递一定数量的字符。激活密钥应该保存实际的产品数据，还是只指向数据库上的匹配行，其中激活密钥充当 PK 并从那里读取我需要的所有内容？

提前感谢您的回复，我希望我的问题不是太粗略；请耐心等待，因为我对这个特定主题相对较新。我已经阅读了其他问题，但似乎都没有解决在基于 Web 的环境中实际存储激活密钥的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T10:02:58.750

在我看来，根本不需要加密。

您可以创建强随机字节（例如，使用 /dev/urandom）并将其用作激活密钥。

64 位随机性（从 urandom 读取 8 个字节）可能就足够了，因为它可以为您提供大约 2^32 个“激活密钥”而不会发生冲突。当然，请确保它适合您的具体情况。

例如，您的激活密钥可能看起来像这样（十六进制编码并用“-”拼接）：

```
28d7-59bf-0a29-b482 
```

# jquery - jQuery 移动 HTTPS

> ID：12277234
> 
> 赞同：1
> 
> 时间：2012-09-05T08:19:02.303
> 
> 标签：jquery, jquery-mobile, ssl, https

我正在使用 jquery mobile 和 phonegap 构建本机 Web 应用程序。数据从外部服务器加载。现在必须使用 ssl 加载数据，但出现错误：

> NETWORK_ERR：XMLHttpRequest 异常 101

我尝试了 Chrome REST 客户端，一切正常。

代码：

```
WebService.prototype.execute = function (url, params) {
    var result = {
        HttpResponseObject : {},

        onSuccess : function (data) {       
            result.HttpResponseObject.response = JSON.parse(data);
        },

        onError : function (XMLHttpRequest, textStatus, errorThrown) {          
            $.mobile.hidePageLoadingMsg();          

            // TODO some logging for errors
            console.log(JSON.stringify(XMLHttpRequest));
            console.log(JSON.stringify(textStatus));
            console.log(JSON.stringify(errorThrown));       
        }
    };

    $.ajax({
        url:            url,
        type:           'POST',
        async:          false,
        data:           JSON.stringify(params),
        dataType:       'text',
        contentType:    'application/json',
        error:          result.onError,
        success:        result.onSuccess
    });

    return result;
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:43:27.277

这就是我为了使用 ajax 查询外部 API 所做的...

```
 $.ajax({
        type: "GET",
        url: "http://api.rottentomatoes.com/api/public/v1.0/movies.json?apikey=[myAPIKey]&q=" + movie.title + "&page_limit=1",
        contentType: "application/json; charset=utf-8",
        crossDomain: true,
        dataType: 'jsonp',
        success: function (msg) {
            ...awesome code here
        }}); 
```

这里的关键是“crossDomain：true”行（对于某些服务也可能是 dataType：'jsonp'）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:31:26.343

这将对您有所帮助 - ajax 调用不适用于外部 url，但有一种解决方法：

[如何在 jquery 中调用外部 url？](https://stackoverflow.com/questions/4613310/how-to-call-external-url-in-jquery)

# java - java protobuf如何从int创建ByteString

> ID：12277235
> 
> 赞同：3
> 
> 时间：2012-09-05T08:19:01.330
> 
> 标签：java, constructor, byte, protocol-buffers

我想在我的项目中使用 google protobuf。

关键是我必须设置非常消息的第一个字节，因为底层代码根据第一个字节拒绝或接受消息并且它不知道 protobuf。

所以这个页面说 [https://developers.google.com/protocol-buffers/docs/proto#scalar](https://developers.google.com/protocol-buffers/docs/proto#scalar) 我必须使用与 Java 中的 ByteString 对应的字节字段。

> bytes 可以包含任意的字节序列。字符串字节串

但我不知道如何从 int 值创建 ByteString。我试过这样：

```
ByteBuffer eventTypeBuffer = ByteBuffer.allocate(1);
eventTypeBuffer.put(0x1c);
ByteString eventType = ByteString.copyFrom(eventTypeBuffer);
System.out.println(eventType.size() + " " + eventTypeBuffer.array().length);

Header.Builder mh = Header.newBuilder();
mh.setEventType(eventType); 
```

不能正常工作并且 println 给出 0 1

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-26T20:52:09.273

```
ByteBuffer eventTypeBuffer = ByteBuffer.allocate(1);
eventTypeBuffer.put(0x1c);
eventTypeBuffer.flip();
ByteString eventType = ByteString.copyFrom(eventTypeBuffer);
System.out.println(eventType.size() + " " + eventTypeBuffer.array().length);

Header.Builder mh = Header.newBuilder();
mh.setEventType(eventType); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T01:14:38.637

将 protobuf 消息视为“黑盒”字节字符串。读取第一个字节后取出protobuf消息，然后处理protobuf部分。

创建字节缓冲区

```
Byte[] buf = new Byte[100]; //length as per your application 
```

然后根据您的应用程序给出第一个字节（根据第一个字节拒绝或接受消息）。您可以使用 protobuf 消息填充的其余字节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-12T14:34:30.800

Using Guava:

```
ByteString byteStringFromInt(int in) {
  return ByteString.copyFrom(Ints.toByteArray(in));
} 
```

# unit-testing - TCL中变量的访问值

> ID：12277236
> 
> 赞同：1
> 
> 时间：2012-09-05T08:19:09.537
> 
> 标签：unit-testing, tcl

我有类似的代码用于编写单元测试，我需要检查变量的值。

```
#first.tcl
proc test {a} {
   if {$a < 10} {
      set sig 0
   } else {
      set sig 1
   }
} 
```

```
#second.tcl unit testing script
source "first.tcl"
test 10
expect 1 equal to $sig
test 5
expect 0 equal to $sig 
```

有什么办法可以访问变量“sig”的值，因为我无法更改第一个脚本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T08:59:54.727

你有问题。问题在于，在第一个脚本中，`sig`是一个*局部*变量，在调用`test`终止时消失。事后你不能检查它。碰巧，结果`test`是分配给`sig`; 我不知道您是否可以将其用于测试目的。如果这足够了，您可以这样做（假设您有 Tcl 8.5；对于 8.4，您需要一个辅助过程而不是`apply`术语）：

```
source first.tcl
trace add execution test leave {apply {{cmd code result op} {
    # Copy the result of [test] to the global sig variable
    global sig
    set sig $result
}}} 
```

这会拦截（就像面向方面的编程一样）结果`test`并将其保存到*全局* `sig`变量中。它没有做的事情对于测试代码中的问题是正确的：分配给一个变量，然后立即消失。

* * *

如果您要进行大量测试，请考虑使用 tcltest 来完成这项工作。这是用于测试 Tcl 本身的包，它可以让您非常轻松地编写执行脚本结果的测试：

```
# Setup of test harness
package require tcltest
source first.tcl

# The tests
tcltest::test test-1.1 {check if larger} -body {
    test 10
} -result 1
tcltest::test test-1.2 {check if smaller} -body {
    test 5
} -result 0

# Produce the final report
tcltest::cleanupTests 
```

# ruby-on-rails-3 - 为普通用户覆盖 RefineryCMS 的重置密码功能

> ID：12277238
> 
> 赞同：0
> 
> 时间：2012-09-05T08:19:16.997
> 
> 标签：ruby-on-rails-3

我正在使用refinerycms 并覆盖重置密码的功能。这是我的密码查看页面：

密码/new.html.erb

```
<h2>Forgot your password?</h2>
<%= form_for(resource, :as => resource_name, :url => refinery.user_password_path, :html => { :method => :post }) do |f| %>

<div><%= f.label :email %><br />
<%= f.email_field :email %></div>

<div><%= f.submit "Send me reset password instructions" %></div>
<% end %> 
```

密码/edit.html.erb

```
<h2>Change your password</h2>   

<%= form_for(resource, :as => resource_name, :url => refinery.user_password_path, :html => { :method => :put }) do |f| %>
<%= f.hidden_field :reset_password_token %>

<div><%= f.label :password, "New password" %><br />
<%= f.password_field :password %></div>

<div><%= f.label :password_confirmation, "Confirm new password" %><br />
<%= f.password_field :password_confirmation %></div>

<div><%= f.submit "Change my password" %></div>
<% end %> 
```

密码控制器是：

```
 class PasswordsController < Devise::PasswordsController
   helper Refinery::Core::Engine.helpers
   before_filter :store_password_reset_return_to, :only => [:update]

   def store_password_reset_return_to
     session[:'refinery_user_return_to'] = refinery.admin_root_path
   end
   protected :store_password_reset_return_to

   # Rather than overriding devise, it seems better to just apply the notice here.
   after_filter :give_notice, :only => [:update]
   def give_notice
     Rails.logger.debug @refinery_user
     if %w(notice error alert).exclude?(flash.keys.map(&:to_s)) or             @refinery_user.errors.any?
    flash[:notice] = t('successful', :scope => 'users.reset', :email => @refinery_user.email)
     end
  end
   protected :give_notice

   # GET /registrations/password/edit?reset_password_token=abcdef
   def edit
    if params[:reset_password_token] and (  @refinery_user = Refinery::User.where(:reset_password_token => params[:reset_password_token]).first).present?
      #Rails.logger.debug @refinery_user
      #logger.debug"******************************************************"
      respond_with(@refinery_user)
    else
      redirect_to refinery.new_user_password_path,
                :flash => ({ :error => t('code_invalid', :scope => 'refinery.users.reset') })
    end
  end

    # POST /registrations/password
    def create
    if params[:user].present? and (email = params[:user][:email]).present? and (user = Refinery::User.where(:email => email).first).present?

      # Call devise reset function.
      user.send(:generate_reset_password_token!)
      UserMailer.reset_notification(user, request).deliver
      redirect_to refinery.new_user_session_path,:notice => t('email_reset_sent', :scope => 'users.forgot')
    else
        flash.now[:error] = if (email = params[:user][:email]).blank?
        t('blank_email', :scope => 'users.forgot')
      else
        t('email_not_associated_with_account_html', :email => ERB::Util.html_escape(email), :scope => 'users.forgot').html_safe
      end
      render :new
    end
  end
end 
```

邮件已成功通过重置通知和编辑密码链接发送电子邮件，但是当我输入新密码并按 Enter 时，它会给出错误
“未定义的方法`email' for nil:NilClass",app/controllers/passwords_controller.rb:15:in`give_notice”。我怎样才能删除该错误？？请帮助！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T08:24:04.443

The result is to simply remove give_notice method and use error message field in password/edit.html.erb as:

```
<% if resource.try(:errors) %>
  <%= devise_error_messages! %>
<% end %> 
```

# mysql - 解决此推进“无法重新声明功能”错误的最正确方法是什么？

> ID：12277239
> 
> 赞同：5
> 
> 时间：2012-09-05T08:19:21.083
> 
> 标签：mysql, propel, redeclare

我有以下表格：

`user`, `logbook`,`user_logbook`

用户日志是一个联结表（`isCrossRef="true"`在 schema.xml 中），包含`user_id`和`logbook_id`外键。

我还想记住任何给定用户当前选择的日志，所以我`current_logbook_id`也在我的`user`表中放了一个，并给了它一个外键。但是，在我的`BaseUserQuery.php`文件中，我得到了两个`filterByLogbook()`函数。

我知道当你有同一张表的两个外键时，*来自*同一张表，你会得到类似`getUserRelatedBySomething()`and的函数`getUserRelatedBySomethingElse()`，但是在这种情况下最好的办法是什么？

我当然可以删除外键并使用保存的 ID，或者我想我可以创建一个新的联结表（尽管这似乎不正确）。在这种情况下，就MySQL*和Propel 中的**“做正确的事”*而言，最好的做法是什么（希望我能同时做到这两个！）。

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T12:24:33.627

在您`schema.xml`将[phpName 和 refPhpName 属性](http://www.propelorm.org/reference/schema.html#foreignkey_element)添加到用户表定义中的外键中：

```
 <table name="user" phpName="User">
    ...
    <foreign-key foreignTable="logbook" phpName="CurrentLogBook" refPhpName="CurrentLogBookUser">
      <reference local="current_logbook_id" foreign="id"/>
    </foreign-key>
    ...
  </table> 
```

然后你应该得到`filterByCurrentLogBook()`和`filterByCurrentLogBookUser()`功能并且没有冲突。*

# java - 拆分字符串的小问题

> ID：12277246
> 
> 赞同：0
> 
> 时间：2012-09-05T08:20:07.570
> 
> 标签：java, string, split

我有这个字符串：

```
"http://my/website/collections/index.php?s=1&schema=http:/my/web/fe7cd50991b11f51050902sddaf3e042bd5467/idApp=19" 
```

我想从字符串中提取这个标记：`fe7cd50991b11f51050902sddaf3e042bd5467`

网站可能会有所不同，但唯一不能改变的是我必须获取的字符串令牌始终位于“/idApp =”的左侧

解决这个问题的最有效方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T08:23:51.437

```
String url = "http://my/website/collections/index.php?s=1&schema=http:/my/web/fe7cd50991b11f51050902sddaf3e042bd5467/idApp=19";
String[] tokens = url.split("/");
String searched = tokens[array.length - 2]; 
```

如果令牌每次都是 prelast，这将起作用。否则，您需要通过`Array`并检查当前令牌是否符合您的条件并在之前获取令牌。在代码中：

```
int tokenId = 0;
for (int i = 0; i < tokens.length; i++) {
  if (token[i].equals("/idApp=")) {
    tokenId = i - 1;
    break;
  }
}
String rightToken = tokens[tokenId]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T08:29:53.180

假设令牌只能是数字和字母，你可以使用这样的东西。

它匹配 /idApp= 字符串之前的一系列数字和字母。

就作为一种标准的、易于阅读的方式而言，它是“高效的”，但可能有更高效的方式来做到这一点，尽管您应该仔细考虑找到这个字符串是否真的是一种性能瓶颈。

```
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class TestRegexp {
    public static void main(String args[]) {
        String text = "http://my/website/collections/index.php?s=1&schema=http:/my/web/fe7cd50991b11f51050902sddaf3e042bd5467/idApp=19";
        Pattern pattern = Pattern.compile("(\\w+)/idApp=");
        Matcher m = pattern.matcher(text);
        if (m.find()) {
            System.out.println(m.group(1)); 
        }

    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T08:31:29.103

您在这里不需要正则表达式。绝对地。任务只是剪断一根绳子，不要过于复杂。简单是关键。

```
int appIdPosition = url.lastIndexOf("/idApp=");
int slashBeforePosition = url.lastIndexOf("/", appIdPosition - 1);
String token = url.substring(slashBeforePosition + 1, appIdPosition); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T08:23:38.857

你可以使用正则表达式

这两个包可以帮助你

*   `java.util.regex.Matcher`
*   `java.util.regex.Pattern`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-05T08:44:51.457

使用字符串做任何事情时，请始终注意：

[http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/StringUtils.html](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/StringUtils.html)

这是我的答案...

```
public static void main(String[] args) {
    //Don't forget: import static org.apache.commons.lang.StringUtils.*;
    String url2 = "http://my/website/collections/index.php?s=1&schema=http:/my/web/fe7cd50991b11f51050902sddaf3e042bd5467/idApp=19";
    String result =  substringAfterLast("/", substringBeforeLast(url2,"/")) ;
    System.out.println(result);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-05T08:31:36.023

简单的 2 次拆分适用于多个参数。先拆开`"idApp"`再开`/`。

即使参数后面有多个参数，以下代码也可以工作`idApp`。

```
String url = "http://my/website/collections/index.php?s=1&schema=http:/my/web/fe7cd50991b11f51050902sddaf3e042bd5467/idApp=19";
String[] tokens = url.split("idApp");
String[] leftPartTokens = tokens[0].split("/");
String searched = leftPartTokens[leftPartTokens.length - 1];
System.out.println(searched); 
```

# javascript - 使用 google map api v3 自动完成字段（法国大道、邮政编码、城市）

> ID：12277247
> 
> 赞同：0
> 
> 时间：2012-09-05T08:20:13.530
> 
> 标签：javascript, google-maps-api-3

到目前为止，我已经运行了这段代码：[https ://google-developers.appspot.com/maps/documentation/javascript/examples/places-autocomplete](https://google-developers.appspot.com/maps/documentation/javascript/examples/places-autocomplete)

我已将自动完成设置为 address1 文本字段。它工作正常。

我需要的是当我选择正确的大道时，邮政编码和城市必须自动填写 acode1 文本字段和 city1 文本字段。

示例：Avenue Joffre, Épinay-sur-Seine, France（当我选择此选项时，我希望仅在 address1 文本字段中显示“Avenue Joffre”部分。然后在城市字段中显示“Epinay-sur-seine”和acode1 文本字段中此地址的邮政编码。

**如果可能的话，请帮助我编写代码，或者就如何达到此解决方案给我一些建议。我将尝试自己编写代码并将其发布在这里作为答案。**

体内：

```
 <input name="address1" id="address1" type="text"/>

 <input name="acode1" id="acode1" type="text"/>

 <input name="city1" id="city1" type="text"/> 
```

在 JS 中：

```
 function initialize() {
    var mapOptions = {
      center: new google.maps.LatLng(-33.8688, 151.2195),
      zoom: 13,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var map = new google.maps.Map(document.getElementById('map_canvas'),
      mapOptions);

    var input = document.getElementById('address1');

    var autocomplete = new google.maps.places.Autocomplete(input);

    autocomplete.setComponentRestrictions({'country':'fr'});

    var infowindow = new google.maps.InfoWindow();
    var marker = new google.maps.Marker({
      map: map
    });

    google.maps.event.addListener(autocomplete, 'place_changed', function() 
    {
      infowindow.close();
      var place = autocomplete.getPlace();
      if (place.geometry.viewport) {
        map.fitBounds(place.geometry.viewport);
      } else {
        map.setCenter(place.geometry.location);
        map.setZoom(17);  // Why 17? Because it looks good.
      }

      var image = new google.maps.MarkerImage(
          place.icon,
          new google.maps.Size(71, 71),
          new google.maps.Point(0, 0),
          new google.maps.Point(17, 34),
          new google.maps.Size(35, 35));
      marker.setIcon(image);
      marker.setPosition(place.geometry.location);

      var address = '';
      if (place.address_components) {
        address = [
          (place.address_components[0] && place.address_components[0].short_name || ''),
          (place.address_components[1] && place.address_components[1].short_name || ''),
          (place.address_components[2] && place.address_components[2].short_name || '')
        ].join(' ');
      }

      infowindow.setContent('<div><strong>' + place.name + '</strong><br>' + address);
      infowindow.open(map, marker);
    });

    // Sets a listener on a radio button to change the filter type on Places
    // Autocomplete.
    function setupClickListener(id, types) {
      var radioButton = document.getElementById(id);
      google.maps.event.addDomListener(radioButton, 'click', function() {
        autocomplete.setTypes(types);
      });
    }

    setupClickListener('changetype-all', []);
    setupClickListener('changetype-establishment', ['establishment']);
    setupClickListener('changetype-geocode', ['geocode']);
  }
  google.maps.event.addDomListener(window, 'load', initialize); 
```

可以在此页面中查看选项：[http ://code.google.com/p/geo-autocomplete/](http://code.google.com/p/geo-autocomplete/)

编辑.................................

经过长时间的研究，我现在处于这一点。它正确返回地址，但我很难检索邮政编码。

参考：[https ://developers.google.com/maps/documentation/javascript/reference#PlaceResult](https://developers.google.com/maps/documentation/javascript/reference#PlaceResult)

```
 var address = '';
      var code='';

     if(place.address_components){
     code = [place.address_components[0].types[0].postal_code];

          document.getElementById('acode1').value = code;
     }

      if (place.address_components) {  

        address = [
          (place.address_components[0] && place.address_components[0].short_name || ''),
          (place.address_components[1] && place.address_components[1].short_name || ''),
          (place.address_components[2] && place.address_components[2].short_name || '')
        ].join(' ');
      } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T10:56:25.357

看到这个类似的问题： [Get zipcode with geo-autocomplete in google api v3](https://stackoverflow.com/questions/12236857/get-zipcode-with-geo-autocomplete-in-google-api-v3)

这个[例子](http://www.geocodezip.com/v3_GoogleEx_places-autocomplete_postal_code.html)

要仅获取城市，请使用[type](https://developers.google.com/maps/documentation/geocoding/#Types) `locality`

**代码片段：**

```
function initialize() {
  var mapOptions = {
    center: new google.maps.LatLng(-33.8688, 151.2195),
    zoom: 13,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  var map = new google.maps.Map(document.getElementById('map_canvas'),
    mapOptions);

  var input = document.getElementById('searchTextField');
  var autocomplete = new google.maps.places.Autocomplete(input);

  autocomplete.bindTo('bounds', map);

  var infowindow = new google.maps.InfoWindow();
  var marker = new google.maps.Marker({
    map: map
  });

  google.maps.event.addListener(autocomplete, 'place_changed', function() {
    infowindow.close();
    var place = autocomplete.getPlace();
    if (place.geometry.viewport) {
      map.fitBounds(place.geometry.viewport);
    } else {
      map.setCenter(place.geometry.location);
      map.setZoom(17); // Why 17? Because it looks good.
    }

    var image = new google.maps.MarkerImage(
      place.icon,
      new google.maps.Size(71, 71),
      new google.maps.Point(0, 0),
      new google.maps.Point(17, 34),
      new google.maps.Size(35, 35));
    marker.setIcon(image);
    marker.setPosition(place.geometry.location);

    var address = '';
    var zip_code = '';
    document.getElementById('zip_code').innerHTML = zip_code;
    if (place.address_components) {
      address = [
        (place.address_components[0] && place.address_components[0].short_name || ''),
        (place.address_components[1] && place.address_components[1].short_name || ''),
        (place.address_components[2] && place.address_components[2].short_name || '')
      ].join(' ');
      for (var i = 0; i < place.address_components.length; i++) {
        for (var j = 0; j < place.address_components[i].types.length; j++) {
          if (place.address_components[i].types[j] == "postal_code") {
            zip_code = place.address_components[i].long_name;
            document.getElementById('zip_code').innerHTML = zip_code;
          }
        }
      }
    }

    infowindow.setContent('<div><strong>' + place.name + '</strong><br>' + address);
    infowindow.open(map, marker);
  });

  // Sets a listener on a radio button to change the filter type on Places
  // Autocomplete.
  function setupClickListener(id, types) {
    var radioButton = document.getElementById(id);
    google.maps.event.addDomListener(radioButton, 'click', function() {
      autocomplete.setTypes(types);
    });
  }

  setupClickListener('changetype-all', []);
  setupClickListener('changetype-establishment', ['establishment']);
  setupClickListener('changetype-geocode', ['geocode']);
}
google.maps.event.addDomListener(window, 'load', initialize);
```

```
body {
  font-family: sans-serif;
  font-size: 14px;
}

#map_canvas {
  height: 400px;
  width: 600px;
  margin-top: 0.6em;
}
```

```
<!-- Replace the value of the key parameter with your own API key. -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCkUOdZ5y7hMm0yrcCQoCvLwzdM6M8s5qk&libraries=places"></script>
<div>
  <input id="searchTextField" type="text" size="50">
  <input type="radio" name="type" id="changetype-all" checked="checked">
  <label for="changetype-all">All</label>

  <input type="radio" name="type" id="changetype-establishment">
  <label for="changetype-establishment">Establishments</label>

  <input type="radio" name="type" id="changetype-geocode">
  <label for="changetype-geocode">Geocodes</lable>
    </div>
<div id="zip_code"></div>
    <div id="map_canvas"></div>
```

# html - CSS错误：悬停事件也在子元素上触发

> ID：12277255
> 
> 赞同：-1
> 
> 时间：2012-09-05T08:20:46.153
> 
> 标签：html, css, hover

这是我的页面： [http](http://www.clouderize.it/michele/category/uncategorized/contattaci/) ://www.clouderize.it/michele/category/uncategorized/contattaci/ 问题出在我的菜单上。如果我将鼠标悬停在子菜单元素（如 michelepierri.it）上，则会触发父亲：悬停事件，并且父亲元素会更改其背景。

我不希望发生这种情况，所以我希望只有当我将鼠标放在菜单元素上时才会在菜单项上触发悬停事件。

我在我的 CSS 上做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:31:17.017

解决了，我换

```
li.backgroundNormal{ 
```

至

```
li.backgroundNormal > a:hover{ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:24:15.910

“悬停” CSS 伪状态在 DOM 树中冒泡。因此，如果你悬停一个元素，你会自动悬停它的所有祖先。

# python - 如何将不需要的属性保存到数据存储区？

> ID：12277258
> 
> 赞同：1
> 
> 时间：2012-09-05T08:21:18.830
> 
> 标签：python, google-app-engine, google-cloud-datastore

我有一个基础课：

```
class Post (db.Model):
    title = db.StringProperty(required = True)
    text = db.TextProperty(required = True)
    created = db.DateTimeProperty(auto_now_add = True).

new_record = Post(title = "TESSSST", text = "TESSST") 
new_record.put() #works! 
```

它工作正常 - 创建实例并写入数据。但是一旦我删除“required = true”属性就不再存储在数据存储中：

```
class Post (db.Model):
    title = db.StringProperty(required = True)
    text = db.TextProperty  
    created = db.DateTimeProperty(auto_now_add = True)

new_record = Post(title = "TESSSST")
new_record.text = "Burn conctructor!"
new_record.put() # text property won't be saved 
```

我不知道这是否有帮助，但是当我`print new_record.__dict__`通过构造函数分配的所有值检查属性时，都有'_'前缀（如'_title'）而其他没有（只是'文本'）。

所以问题是“是否可以将非必需（并且未由构造函数初始化）属性保存到数据存储区？” 我在 gae 文档中找不到答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:43:48.707

但是您不仅删除`required=True`了 ，还删除了`()`实例化该字段的括号。它应该是

```
text = db.TextProperty() 
```

# iis - FTP IIS 重命名接收到的文件

> ID：12277259
> 
> 赞同：0
> 
> 时间：2012-09-05T08:21:22.330
> 
> 标签：iis, ftp

我们有一些机器通过 FTP 将文件发送到我们的服务器。遗憾的是，在某些情况下，生成的文件可能具有相同的名称，并且在服务器上处理它们之前会被覆盖。

FTP 发件人系统我们无法更改任何内容（封闭系统）。

在 IIS FTP 服务器处理上传之后但在文件写入磁盘之前是否有可能更改文件名（可能是一些随机的，一个 guid 或其他东西）？

例如

来源 -> 目的地

```
file1.txt -> 235987298735236.txt
file2.txt -> 468934693469464.txt 
```

等等...在此先感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T09:51:36.603

您仍然可以尝试编写一个将监视指定文件夹的Windows服务，并且当新文件到达时它可以重写文件名，但是它并不完全是万无一失的，就好像两台机器同时发送相同的文件一样可能是个问题。

在这种情况下，我会请求查看用于 FTP 的 IIS API，并查看传入文件时是否有任何事件触发器。

# java - BufferedReader Java 故障排除

> ID：12277260
> 
> 赞同：0
> 
> 时间：2012-09-05T08:21:22.017
> 
> 标签：java, bufferedreader, inputstreamreader

我目前正在尝试访问许多非常相似的网站，这些网站只包含文本，并且都以相同的方式格式化。

我调用此方法的前 5-30 次，它有效，但之后它返回 null。没有错误。是否有任何理由无法获取字符串？

在插入了一些文本之后，我发现它似乎`line = in.readLine()`是随机的，`null`它跳过了字符串抓取的主体。我用`BufferedReader`的不多，所以很可能是问题所在。如果您有任何提示或解决此问题的方法，将不胜感激。

```
public static String pullString(int id) throws IOException {

    String price;
    logError("Checkpoint 1");
    URL url = new URL("example.com");
    URLConnection con = url.openConnection();
    logError("Checkpoint 2");
    BufferedReader in = new BufferedReader(new InputStreamReader(con.getInputStream()));
    logError("Checkpoint 3");
    String line;

    while ((line = in.readLine()) != null) {
  //        ^ for some reason this becomes null, but on identical pages it works fine. 

              //Removed unneeded info

                return ---;
            } catch (NumberFormatException e) {
                logError("NumberFormatException");

                return null;
            }
        }
    }
    logError("left out the back");
    return null;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:23:34.463

我怀疑它与 BufferedReader 有什么关系。

服务器更有可能返回您忽略的错误消息。我建议您打印返回的内容以确保标题中没有错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:43:19.147

在您完成阅读之前，连接可能已断开。我建议在 while 循环中只读取行，然后关闭连接并离线执行逻辑。您也可以尝试直接使用输入流并读取**字节**而不是字符串，然后将其离线转换。

# android - 在硬件菜单按钮单击操作栏中打开子菜单

> ID：12277262
> 
> 赞同：18
> 
> 时间：2012-09-05T08:21:29.380
> 
> 标签：android, menu, android-actionbar

标题说明一切。单击硬件菜单按钮时，我想在操作栏中打开子菜单

这是代码，它在我第一次单击菜单时运行良好。每隔一段时间它就会闪烁（打开并立即关闭它）

```
private Menu mainMenu;
public boolean onCreateOptionsMenu(Menu menu) {

MenuInflater inflater = getMenuInflater();
inflater.inflate(R.menu.options, menu);
mainMenu = menu;

return true;
}

public boolean onKeyDown(int keyCode, KeyEvent event) {
if(event.getAction() == KeyEvent.ACTION_DOWN){
    switch(keyCode) {
    case KeyEvent.KEYCODE_MENU:

        mainMenu.performIdentifierAction(R.id.more, 0);

        return true;  
    }
}
return super.onKeyDown(keyCode, event);
} 
```

这是options.xml

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >

<item
    android:id="@+id/settings"
    android:icon="@drawable/ic_menu_preferences"
    android:showAsAction="ifRoom|withText"
    android:title="Settings"/>

<item
    android:id="@+id/about"
    android:icon="@drawable/ic_menu_info_details"
    android:showAsAction="ifRoom|withText"
    android:title="About"/>

<item
    android:id="@+id/more"
    android:icon="@drawable/ic_menu_moreoverflow_normal_holo_dark"
    android:showAsAction="always|withText"
    android:title="More">
    <menu>
        <item
    android:id="@+id/changelog"
    android:icon="@drawable/ic_menu_recent_history"
    android:showAsAction="ifRoom|withText"
    android:title="Changelog"/>
        <item
    android:id="@+id/update"
    android:icon="@drawable/ic_menu_refresh"
    android:showAsAction="ifRoom|withText"
    android:title="Update Check"/>
<item
    android:id="@+id/check"
    android:icon="@drawable/ic_menu_help"
    android:showAsAction="ifRoom|withText"
    android:title="Compatibility Check"/>
        </menu> 
        </item>

</menu> 
```

**更新：（解决方案）** 刚刚将 onKeyDown() 方法更改为 onKeyUp() 现在它坚持了

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T08:40:42.857

试试这个：

```
public boolean onCreateOptionsMenu(Menu menu) 
{
    super.onCreateOptionsMenu(menu);// <--- add this

    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.options, menu);
    mainMenu = menu;
    return true;
}

//override this method instead of onKeyDown()....
@Override
public boolean onOptionsItemSelected(MenuItem item) 
{
    super.onOptionsItemSelected(item);      

    int menuId = item.getItemId();      
    if(menuId == R.id.settings)
    {
        //do settings   
    }
    //else if(menuId = ...) {....}

    return true;
} 
```

# xml - 自定义从 wcf 反序列化的 xml 的属性

> ID：12277263
> 
> 赞同：1
> 
> 时间：2012-09-05T08:21:32.500
> 
> 标签：xml, wcf, serialization, xsd

将使用我的 wcf Web 服务的那个有 2 个请求：他希望从服务返回的对象反序列化 xml 的第一个元素中的另一个属性。他希望修改该 xml 元素的现有属性。

按顺序，这是反序列化：

```
ServiceReference1.MyClient c = new ServiceReference1.MyClient();

ServiceReference1.MyRequest req = new ServiceReference1.MyRequest();

// setting the request

// richiedo la lista - prezzi
ServiceReference1.MyResponse res = c.GetPricesWithTecdocFormat(req);

// serializzation
string OutputPath = this.Request.PhysicalApplicationPath;
System.Runtime.Serialization.DataContractSerializer x = new System.Runtime.Serialization.DataContractSerializer(res.GetType());
using (FileStream fs = new FileStream(OutputPath + "MyResponse.xml", FileMode.Create))
{
    x.WriteObject(fs, res);
} 
```

生成的 XML 文件开头如下：

```
<?xml version="1.0"?>
 <MyResponse xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
   ... 
```

要求是这样的：

```
<?xml version="1.0"?>
 <MyResponse xsi:noNamespaceSchemaLocation="genericResponse.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> 
```

然后...

*   xmlns:i 必须是 xmlns:xsi

*   在元素中存在引用 .xsd 文件的属性

我用 MessageInspector 试了又试，但没有结果——这让我发疯了......

我能怎么做？

皮莱吉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:59:08.697

您将很难使用`DataContractSerializer`. 如果您切换到 using `XmlSerializer`，您可以更好地控制序列化过程。

然后你需要做两件事：

1.  使用该`XmlSerializerNamespaces`类型来操作命名空间前缀，如此[处所述](https://stackoverflow.com/a/2339796/569662)
2.  使用`XmlAttributeOverrides`类型将`noNamespaceSchemaLocation`属性添加到根节点。

# android - Android子线程调用主线程UI

> ID：12277265
> 
> 赞同：-1
> 
> 时间：2012-09-05T08:21:43.213
> 
> 标签：android

我是 Andorid 的新手。我想更改 UI 中的 textView。但是子线程调用append时会出现错误。可以通过句柄和消息来解决。但我不知道Android中句柄和消息的机制。所以我请别人帮忙解释一下。非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:03:17.153

为什么不使用[LocalBroadcastManager](http://developer.android.com/reference/android/support/v4/content/LocalBroadcastManager.html)？

这要简单得多！虽然您必须导入 android-support.jar（从 Android 工具安装兼容性库。）并在两个线程中实例化 localbroadcastmanager，但我发现之后阅读代码要容易得多！

[这](https://stackoverflow.com/questions/8802157/how-to-use-localbroadcastmanager)是 StackOverflow 上的一个示例（这应该足以让您开始使用）。

不要忘记投票或标记为正确！

# php - PHP：如何使用数组索引访问数组元素值

> ID：12277268
> 
> 赞同：2
> 
> 时间：2012-09-05T08:21:59.303
> 
> 标签：php, arrays

如何使用数组索引访问数组元素值？

```
<?
$json = '{
    "dynamic":{
       "pageCount":"12",
       "tableCount":"1"
    }
}';

$arr = json_decode($json, true);

echo $arr['dynamic']['pageCount']; // working
echo $arr[0]['pageCount']; // not working
?> 
```

我不知道“动态”中有什么，所以我想动态访问 pageCount 值？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-05T08:31:38.950

[array_values](http://php.net/array_values)是您正在寻找的功能

例子：

```
<?php
$json = '{
    "dynamic":{
       "pageCount":"12",
       "tableCount":"1"
    }
}';

$arr = json_decode($json, true);
echo $arr['dynamic']['pageCount']; // working

$arr = array_values($arr);
echo $arr[0]['pageCount']; // NOW working

?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T08:29:52.417

```
$arr = json_decode($json, true);
foreach ($arr as $key => $value) {
    if (isset($value['pageCount'])) {
        //do something with the page count
    }
} 
```

如果结构始终是单个嵌套的 JS 对象：

```
$obj = current($arr);
echo $obj['pageCount']; 
```

# asp.net-mvc-4 - MVC4 和 MVCContrib

> ID：12277270
> 
> 赞同：12
> 
> 时间：2012-09-05T08:22:10.680
> 
> 标签：asp.net-mvc-4, mvccontrib

MVCContrib 目前是否支持 MVC4？我首先看一下将项目从 MVC2 切换到 MVC4 并遇到一些便携式区域的问题。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-09T19:45:03.790

如果其他人看到这篇文章，你可以试试这些：

[http://nuget.org/packages/StudioDonder.MvcContrib.Mvc4/](http://nuget.org/packages/StudioDonder.MvcContrib.Mvc4/) [http://nuget.org/packages/StudioDonder.MvcContrib.Mvc4.TestHelper/](http://nuget.org/packages/StudioDonder.MvcContrib.Mvc4.TestHelper/) 等。

源代码在这里： http: [//mvccontrib.codeplex.com/SourceControl/network/forks/ErikSchierboom/mvccontribmvc4](http://mvccontrib.codeplex.com/SourceControl/network/forks/ErikSchierboom/mvccontribmvc4)

对于每一个，他们说： 注意：这是 MvcContrib 项目的一个分支，适用于 ASP.NET MVC 4。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-01T21:02:52.683

我可以根据经验说它“有点”有效。

我正在开发一个使用 Mvc.Contrib.TestHelpers 程序集的项目，在这种情况下，我必须从 Codeplex 下载源代码，将 MVC 引用从版本 3 更新到版本 4 并重建项目，然后参考我重建的 MvcContrib 版本。

我希望这会有所帮助:)

# mysql - MySQL：按组内排序

> ID：12277271
> 
> 赞同：4
> 
> 时间：2012-09-05T08:22:12.833
> 
> 标签：mysql, sql-order-by

我有一个这样的mysql表：

```
mysql> select * from pt_onhand where pn = '000A569011';
+------------+-----+----+--------+------------+---------+--------------+-----+
| pn         | pa  | mn | ACTIVE | locate     | onhand  | avg_cost     | whs |
+------------+-----+----+--------+------------+---------+--------------+-----+
| 000A569011 | P/A |    |        | AA-112     | 13.0000 | 0.0000000000|     |
| 000A569011 | P/A |    |        | PF120136.1 |  1.0000 | 5.4785156200 |     |
+------------+-----+----+--------+------------+---------+--------------+-----+ 
```

我想执行这样的查询：

```
mysql> select sum(onhand),max(locate),avg_cost from pt_onhand where pn = '000A569011' group by pn;
+-------------+-------------+--------------+
| sum(onhand) | max(locate) | avg_cost     |
+-------------+-------------+--------------+
|     14.0000 | PF120136.1  | 0.0000000000|
+-------------+-------------+--------------+ 
```

**所以我的问题是：我能否在同一个查询中获得与 max(locate) PF120136.1 相关的 avg_cost 5.4785156200，如何？谢谢**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T08:29:15.683

这有点杂乱无章，但它应该可以解决问题：

```
select a.onhand, a.locate, p.avg_cost
from
    (select sum(onhand) onhand, max(locate) locate from pt_onhand where pn = '000A569011' group by pn) a
    join pt_onhand p on p.locate = a.locate 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T08:34:40.887

你也可以做一个子查询：

```
select 
     sum(onhand)
    ,max(locate)
    ,(select avg_cost from pt_onhand where pn = pt.pn and locate = max(pt.locate)) as avg_cost 
from 
    pt_onhand pt 
where 
    pn = '000A569011' 
group by pn; 
```

但是根据您的数据库有多大，可能表现不佳，请全部尝试，看看哪个最适合您

# javascript - 我如何使 iframe 位置高于其他位置

> ID：12277276
> 
> 赞同：1
> 
> 时间：2012-09-05T08:22:34.530
> 
> 标签：javascript, html, css, iframe, z-index

我想做的是让 iframe 浮动在其余内容之上。zindex 似乎没有工作

```
<html>  
<head>
<script language="JavaScript" type="text/javascript">
function makeFrame(src) {
ifrm = document.createElement("IFRAME");
ifrm.setAttribute("src","http://www.google.com");
ifrm.style.display = "block";
ifrm.style.width = 640+"px";
ifrm.style.height = 480+"px";
ifrm.style.position = "absolute";
ifrm.style.zIndex= "2";
document.body.appendChild(ifrm);
}

function closeFrame(){
ifrm.style.display = "none";
}
</script>
</head>
<body>
<img src="" onmouseover=makeFrame() onmouseout=closeFrame() height="100px" width="100px" />
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:31:19.403

您可能需要指定框架的左侧和顶部，尝试添加：

```
ifrm.style.left="30px";
ifrm.style.top="30px"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:40:26.700

这是你的工作演示

[http://jsfiddle.net/REzpg/](http://jsfiddle.net/REzpg/)

和你的代码

```
<script language="JavaScript" type="text/javascript">
function makeFrame(src) {
ifrm = document.createElement("IFRAME");
ifrm.setAttribute("src","http://www.orbees.com");
    ifrm.setAttribute("onmouseout","closeFrame()")
ifrm.style.display = "block";
ifrm.style.width = 640+"px";
ifrm.style.height = 480+"px";
ifrm.style.position = "absolute";
ifrm.style.top="0px";
    ifrm.style.color="red";
ifrm.style.zIndex= "101";
document.body.appendChild(ifrm);
}

function closeFrame(){
ifrm.style.display = "none";
}
</script>

<img src="http://www.business-standard.com/ads/inhouse/take2/tabel_two.jpg" onmouseover=makeFrame()  height="100px" width="100px" /> 
```

# php - Twitter API - 我想抓取某个用户（实际上是一大群用户）的所有推文（php）

> ID：12277277
> 
> 赞同：1
> 
> 时间：2012-09-05T08:22:36.297
> 
> 标签：php, api, twitter

我有一个各种 Twitter 帐户（用户名）的列表。我想获取他们的状态信息（公开）。

我怎么能用他们的api做到这一点？

如果我要这样做，我只能看到该怎么做：

1.  创建一个新的 Twitter 帐户 (@myaccount)
2.  关注我想从中获取其状态的所有 Twitter 帐户
3.  使用 oAuth 授权 @myaccount
4.  从该帐户时间线获取所有状态并处理

我怎样才能以正确的方式做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:58:30.703

您可以制作一个 Twitter 列表[https://support.twitter.com/entries/76460-how-to-use-twitter-lists](https://support.twitter.com/entries/76460-how-to-use-twitter-lists)并通过小部件[https://twitter.com/about/resources/widgets/widget_list](https://twitter.com/about/resources/widgets/widget_list)输出。

这个答案来自这里，但是一些链接被破坏了将[多个 twitter 提要与 PHP 合并到一个列表中？](https://stackoverflow.com/questions/2697092/combine-multiple-twitter-feeds-into-one-list-with-php).

或者你可以按照你建议的方式使用这个 php 类[http://code.google.com/p/twitter-php/](http://code.google.com/p/twitter-php/)并使用 Twitter::ME_AND_FRIENDS 选项

# ios - ios过滤器去除像素化

> ID：12277281
> 
> 赞同：0
> 
> 时间：2012-09-05T08:22:55.587
> 
> 标签：ios

我有一个分辨率为 200 * 300 的图像。我使用核心图形将图像缩放到 600*900，结果图像开始像素化。ios中是否有任何过滤器或任何其他技术可以在缩放图像后减少像素化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T10:06:50.327

调整大小时使用良好的插值器。这应该就是所需要的。

> 我使用核心图形将图像缩放到 600*900……</p>

如果您使用 扩展`CGContextDrawImage`，那么您可能只需要`CGContextSetInterpolationQuality(gtx, kCGInterpolationHigh);`在调用之前添加`CGContextDrawImage`。您可能还想调整上下文的抗锯齿参数。

# javascript - 如何在 alfresco 4 的后台将电子邮件作为 webscript 发送？

> ID：12277284
> 
> 赞同：0
> 
> 时间：2012-09-05T08:23:09.417
> 
> 标签：javascript, email, alfresco, background-process

我有用 Javascript 编写的用于发送电子邮件的 webscript。它工作得很好，但我想在后台发送这些电子邮件，这样操作就不会减慢进一步的代码执行。我怎样才能做到这一点？

提前致谢！

最好的，D

附加代码：

我创建了 sendmail.lib.js，它包含在所需的 js 文件中，具有以下签名：

```
function sendmail(to, subject, nodeRef, templatePath, templateArgs, textIfTemplateNotFound ) 
```

此函数以以下行结束：

```
mail.execute(search.findNode(nodeRef)); 
```

这是我需要发送电子邮件以及与“开箱即用”Alfresco 事件无关的非常具体的事件的方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T16:30:51.723

由于您正在使用 Action，因此答案非常简单。你想要做的是[你的 Action 的异步执行](http://wiki.alfresco.com/wiki/Actions_and_Rules#Asynchronous_Action_Execution)。然后，Alfresco 会将您的操作添加到异步操作队列中，并在其中一个异步线程可用时立即运行它。

代替

```
 mailAction.execute(node); 
```

你改为

```
 mailAction.executeAsynchronously(node); 
```

就是这样！有关您可以在 JavaScript 中执行哪些操作的更多信息，请查看[wiki 上](https://wiki.alfresco.com/wiki/3.0_JavaScript_API#Actions_API)的文档，或者只需阅读[ScriptAction 源代码](https://svn.alfresco.com/repos/alfresco-open-mirror/alfresco/HEAD/root/projects/repository/source/java/org/alfresco/repo/jscript/ScriptAction.java)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T09:17:11.460

你应该创建一个规则，有两种方法，我前段时间在我的个人博客上写下了，很抱歉做这种广告..这里是链接： [预定的自定义操作 Alfresco](http://alch3mi5t.blogspot.it/2012/07/scheduled-custom-action-alfresco.html)。这适用于您希望在 CRON 基础上发送邮件的情况。否则，如果您想在存储库中发生某些事情时发送邮件，那么您可以按照这些简单的步骤创建规则。[创建内容规则 Alfresco](http://docs.alfresco.com/4.0/index.jsp?topic=/com.alfresco.enterprise.doc/tasks/tuh-contentrule-create.html)。让我知道是否有帮助。

# json - Dust.Js 部分和路径

> ID：12277286
> 
> 赞同：0
> 
> 时间：2012-09-05T08:23:12.953
> 
> 标签：json, dust.js

我收到以下格式的错误 JSON

```
error = [{field:'one', desc:'This is error for field one', value='FromPostFieldOne'},
         {field:'two', desc:'This is error for field two', value='FromPostFieldTwo'}]; 
```

我想在以下模板中显示

```
{#error}
<form>
  <input type="text" name="one" id="one" value="<!- value for field one from JSON-->"/>
  <!-- Display error from JSON for field one here -->

  <input type="text" name="two" id="two" value="<!- value for field two from JSON -->"/>
  <!-- Display error from JSON for field two here -->

</form>
{/error} 
```

我无法确定是否使用以太“显式上下文设置”或“{@if cond="condition"} helper”来实现这一点。Linkedin Dust 网站上的所有示例都说明了如何使用 JSON 键值而不是对象数组来执行此操作。

帮助表示赞赏！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:52:02.680

你的 json 无效，你应该做这样的事情：

```
 error = [
          {
           field:'one', 
           desc:'This is error for field one', 
           value:'FromPostFieldOne'
          },
          {
           field:'two', 
           desc:'This is error for field two', 
           value:'FromPostFieldTwo'}
         ]; 
```

# objective-c - 我的 UITableViewCell 设置按钮

> ID：12277287
> 
> 赞同：1
> 
> 时间：2012-09-05T08:23:13.870
> 
> 标签：objective-c, uitableview

我在向我`UITableViewCell`的 中添加按钮时遇到问题，单元格有两个`UILabel`s 和两个`UIImageView`s，有时`UIImageView`会包含一个图像，有时会包含一个按钮：

![在此处输入图像描述](../Images/81e090834191b6d34ea06082904e3628.png)

在我的`UITableViewCell`子类中，我有：

```
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if ( self ) {
        // Initialization code

    firstLock = [[UILabel alloc]init];
    [firstLock setBackgroundColor:[UIColor clearColor]];
    firstLock.textAlignment = UITextAlignmentLeft;
    firstLock.font = [UIFont fontWithName:@"Arial-BoldMT" size:17];

    secondLock= [[UILabel alloc]init];
    [secondLock setBackgroundColor:[UIColor clearColor]];
    secondLock.textAlignment = UITextAlignmentRight;
    secondLock.font = [UIFont fontWithName:@"Arial-BoldMT" size:17];

    firstLockImage = [[UIImageView alloc]init];

    secondLockImage = [[UIImageView alloc] init];

    [self.contentView addSubview:firstLock];
    [self.contentView addSubview:secondLock];
    [self.contentView addSubview:firstLockImage];
    [self.contentView addSubview:secondLockImage];
    }
    return self;
} 
```

当其中一个`UIImageView`s 只是一个图像时没问题，但是当我添加一个`UIButton`(imaged) 作为子视图时它会崩溃。

在`UITableViewDataSource`实施中：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

UIImage *btnImage = [UIImage imageNamed:@"bike_ok.png"];

UIButton *button =[UIButton alloc];
[button setImage:btnImage forState:UIControlStateNormal];

[cell.secondLockImage addSubview:button]; 
```

添加按钮作为图像视图的子视图崩溃：

```
 Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Requesting the window of a view (<UIButton: 0x7bac7d0; frame = (0 0; 0 0); transform = [0, 0, 0, 0, 0, 0]; alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = (null)>) with a nil layer. This view probably hasn't received initWithFrame: or initWithCoder:.'
*** First throw call stack: 
```

我错过了什么？

谢谢！

只需添加！这条线很重要

```
 [firstLockImage setUserInteractionEnabled:YES];
    [secondLockImage setUserInteractionEnabled:YES]; 
```

因为 UIImageView 默认设置为 NO 并且没有它按钮将无法工作！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T08:44:01.210

如果您阅读了崩溃错误，则很容易看出您的问题出在哪里。你还没有初始化你的按钮。

```
UIButton *button = [[UIButton alloc] initWithFrame:CGRectMake(0,0,0,0)]; 
```

或者您可以使用 initWithCoder。

希望这可以帮助

山姆

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T08:51:00.600

更改`UIButton *button =[UIButton alloc];`（**alloc w/o init**？）为

```
UIButton *button =[UIButton buttonWithType:UIButtonTypeCustom];
//set frame
[button setFrame:(CGRect){x,y,w,h}]; 
```

`+buttonWithType`处理 UIButton 对象的分配/初始化

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T08:43:51.287

阅读异常文本 - 它说：

> 此视图可能尚未收到 initWithFrame: 或 initWithCoder:

只需在您的问题中列出几行，您正在向一个`UIButton`实例发送消息，而该实例您只有`alloc`'d 而没有发送任何`init...`消息。那是你的错误。

~~此外，您不应该直接调用`alloc`/`init`对，`UIButton`因为它是一个类集群，您通常应该使用它`+[UIButton buttonWithType:]`来获取按钮实例。~~

**编辑**实际上，我对此不是 100% 确定的。但是你并不真正知道如果你这样做会得到什么`initWithFrame:`，我仍然会去`buttonWithType:`获得一个自定义按钮，这就是你想要的。**结束编辑**

因此，将该行更改为：

```
UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom]; 
```

希望这可以帮助！

# android - 将 textcolor 按钮设置回默认值

> ID：12277289
> 
> 赞同：4
> 
> 时间：2012-09-05T08:23:21.830
> 
> 标签：android

我有一个登录屏幕。在这个登录屏幕中，我有一个默认禁用的按钮。

当用户输入 4 个数字时，我启用按钮并将 textcolor 更改为绿色。
但是当 4 个数字不是正确的代码时，我会清除我的编辑文本并再次禁用我的按钮。

目前这个禁用按钮的文本颜色是绿色的。如何将其设置回默认颜色？

```
public void onTextChanged(CharSequence s, int start, int before, int count) {
            if(s.length() >= maxLength)
            {
                btnOk.setEnabled(true);
                btnOk.setTextColor(Color.parseColor("#00B32D"));
            }

            else
            {
                btnOk.setEnabled(false);
            }

private void checkIfValid(String inputPin)
{
    if(inputPin.equals("0000"))
    {
        startActivity(new Intent(this, ShowScreenActivity.class));
        finish();
    }
    else
    {
        clearText();

      ====>   //Here i want to set my textcolor back to normal.  

        Toast.makeText(this, "Pincode foutief", Toast.LENGTH_SHORT).show();
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-05T08:28:30.787

使用此代码获取 Button 的默认颜色，

```
int DefaultButtonColor = btnOk.getTextColors().getDefaultColor(); 
```

如果它不是您想要的，那么您可以使用 Android Platform Resource Color

就像是，

```
android.R.color.secondary_text_dark 
```

也检查别人...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T08:27:48.837

在 onCreate() 中备份您的默认颜色；

```
defaultTextColor = btnOk.getTextColors().getDefaultColor(); 
```

然后放回去

```
btn.setTextColor(defaultTextColor); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-13T16:31:19.283

如果您有另一个始终保持默认颜色的按钮，您可以将颜色修改按钮的颜色设置为该其他按钮以恢复默认颜色。代码可能是...

```
btnOk.setTextColor(btnCancel.getTextColors()); 
```

这是一个简单的单行解决方案，但您必须小心其他按钮颜色没有因为其他原因而被修改，否则这可能不起作用。

# asp.net-web-api - ApiController 的执行顺序

> ID：12277293
> 
> 赞同：13
> 
> 时间：2012-09-05T08:23:30.963
> 
> 标签：asp.net-web-api

通用方法顺序有这样的东西吗？

[http://blogs.msdn.com/cfs-filesystemfile.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-46-38-WebApiStackDiagramsNew/6428.ASP.NET_5F00_MVC4_5F00_WebAPI_5F00_StackDiagram_5F00_Future.jpg](http://blogs.msdn.com/cfs-filesystemfile.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-46-38-WebApiStackDiagramsNew/6428.ASP.NET_5F00_MVC4_5F00_WebAPI_5F00_StackDiagram_5F00_Future.jpg)

自从我从 Beta/RC 版本升级到 RTM 版本以来，我的 Web Api 解决方案现在在执行某些方法方面有了新的顺序。（它不是消息处理程序执行的相反顺序）

之前调用了 APIControllers 的这个方法：

```
protected override void Initialize(System.Web.Http.Controllers.HttpControllerContext controllerContext)
{
} 
```

在我的 AuthorizationFilter 的 filtermethods 之前

```
public override void OnAuthorization(System.Web.Http.Controllers.HttpActionContext actionContext)
{
} 
```

在 RTM 之后，在 Initialize() 之前调用 OnAuthorization。是否有一些关于 ApiController 方法的执行顺序和 RTM 发布后的变化的信息？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-09-05T09:53:05.947

假设请求进入 ApiController 范围，操作顺序如下：

*   的`ExecuteAsync`方法`ApiController`被调用。
*   的`Initialize`方法`ApiController`被调用。
*   检索注册的动作选择器。
*   注册的动作选择器的`SelectAction`方法被调用。如果仅匹配一种操作方法，则流水线继续。
*   检索所选操作的所有已注册过滤器。
*   授权过滤器被调用。授权过滤器可以决定让管道继续执行或终止管道。
*   如果授权过滤器没有终止请求，则执行操作参数绑定。
*   `ApiController.ModelState`已设置。
*   调用动作过滤器。Action Filters 可以决定是让管道继续执行还是终止管道。
*   如果 Action Filters 没有终止请求，则检索注册的 Action Invoker。
*   调用已注册的 Action Invoker的`InvokeActionAsync`方法来调用选定的操作方法。
*   注意：如果从 Authorization Filters 的执行到 action 方法的执行发生任何异常，则调用异常过滤器。

中间还有一些事情发生，但这非常接近一个完整的视图。查看[`ApiController`源代码](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/436ae9643c21#src/System.Web.Http/ApiController.cs)以获取更多信息。

# android - 使用默认来电屏幕来拨打假电话

> ID：12277294
> 
> 赞同：2
> 
> 时间：2012-09-05T08:23:32.030
> 
> 标签：android, phone-call

有没有办法从我的应用程序内部使用默认来电屏幕及其功能（接听和拒绝）。我想从我的应用程序内部拨打假电话，我不想创建自定义来电屏幕，而是在设备上使用默认来电屏幕，因为不同的设备有不同的来电屏幕。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T08:38:48.990

不，这不能使用标准 SDK 完成。首先，呼叫屏幕活动只能由系统启动。其次，Android 的特定供应商皮肤通常会用自定义的手机应用程序替换默认的手机应用程序，因此即使可能，您也不太可能只用一段代码在所有设备上执行此操作。

您最好的选择是尝试为最流行的设备重新创建来电屏幕并检测用户正在运行的设备，我知道这不是您想听到的。对不起。

# objective-c - 目标 C 按钮调整大小和延迟

> ID：12277299
> 
> 赞同：2
> 
> 时间：2012-09-05T08:23:47.503
> 
> 标签：objective-c, ios, xcode

我想在它所在的地方重新调整按钮的大小并延迟它，你能帮我吗？（发件人=UIButton）

我的功能：

```
-(IBAction)Animate: (id) sender
{

[sender setBackgroundImage:[UIImage imageNamed:@"Text Bg large.png"] forState:UIControlStateNormal];
CABasicAnimation *scale;
scale = [CABasicAnimation animationWithKeyPath:@"transform.scale"];
scale.fromValue = [NSNumber numberWithFloat:1];
scale.toValue = [NSNumber numberWithFloat:1.3];
scale.duration = 1;
scale.removedOnCompletion = NO;

scale.repeatCount = 1;
[sender addAnimation:scale forKey:@""];
[sender setFrame:(CGRectMake(x, y, z, w))];

} 
```

如果我希望该按钮保持在同一位置，并且在不手动输入值的情况下增长 1.3 倍，我对 x、y、z、w 使用什么。哦，我怎么能延迟这个操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:51:38.510

你有什么理由`CAAnimation`这样做吗？

怎么样：

```
CGRect newFrame = CGRectInset(sender.frame, CGRectGetWidth(sender.frame) * -0.15, CGRectGetHeight(sender.frame) * -0.15);

[UIView animateWithDuration: 1.0
                      delay: 0.5
                    options: UIViewAnimationOptionCurveLinear
                 animations:^{
                     [sender setFrame: newFrame];
                 }
                 completion: nil]; 
```

或者

```
[UIView animateWithDuration: 1.0
                      delay: 0.5
                    options: UIViewAnimationOptionCurveLinear
                 animations:^{
                     [sender setTransform: CGAffineTransformMakeScale(1.3, 1.3)];
                 }
                 completion: nil]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:50:49.087

做这个：

```
-(IBAction)Animate:(id) sender
{
  UIButton *btnAnimate = (UIButton *)sender;
  btnAnimate.transform = CGAffineTransformIdentity;
  [UIView animateWithDuration:0.4 delay:0 options:UIViewAnimationOptionCurveEaseOut animations:^{
  btnAnimate.transform = CGAffineTransformMakeScale(1.3f, 1.3f);

  } completion:^(BOOL finished){

    [btnAnimate setFrame:(CGRectMake(x, y, z, w))];

  }];
} 
```

# php - $.getJSON 数据未使用 ajaxSubmit 循环显示

> ID：12277303
> 
> 赞同：0
> 
> 时间：2012-09-05T08:23:53.857
> 
> 标签：php, jquery

我在尝试使用 jquery 执行动态加载的表单时遇到了一些问题。这是我的代码：

```
$(this).ajaxSubmit({ 
    url: '/postform1.php',
    type: 'post',
    //target: '#preview',
    success: function(msg) {

        var s = msg + '<form name="sr" id="sr" action="postform.php" method="post"><input type="text" /></form>';
        $('#preview').html(s);

        $.getJSON("/postform1.php", function(data){
        var counter = 0;
        if(data) {
           $.each(data, function(i, val) {
                var newTextBoxDiv = $(document.createElement('div')).attr("id", val);
                newTextBoxDiv.after().html('<label>' + i + ' : </label>' + '<input type="text" name="' + i + '" id="' + i + '" value="' + val + '" >');
                newTextBoxDiv.appendTo("#sr");
                counter++;
            });
        }
        });
    }
 }); 
```

我最初是从 postform1.php 呼应整个表单，但发现表单没有提交。我也不知道这是否是正确的方法，但我想我会试一试。如果有人有任何想法，很高兴收到您的来信。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:40:59.763

感谢您对此进行调查，设法对其进行了排序。我也改变了这个：

```
var newTextBoxDiv = $(document.createElement('div')).attr("id", val);  
            newTextBoxDiv.after().html('<label>' + i + ' : </label>' + '<input type="text" name="' + i + '" id="' + i + '" value="' + val + '" >');  
            newTextBoxDiv.appendTo("#sr");  
            counter++; 
```

对此：

```
var newTextBoxDiv = $(document.createElement('div')).attr("id", val);
                newTextBoxDiv.html('<label>' + i + ' : </label>' + '<input type="text" name="' + i + '" id="' + i + '" value="' + val + '" >');
                newTextBoxDiv.appendTo(".sr");
                counter++; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:25:57.640

您错过了声明：

```
contentType: " ... ",
dataType: " ... " 
```

# tags - 如何在 Tumblr 上添加标签云？

> ID：12277304
> 
> 赞同：3
> 
> 时间：2012-09-05T08:23:54.683
> 
> 标签：tags, blogs, tumblr, tag-cloud

我使用 Tumblr 已经有一段时间了，但我不知道如何在博客上显示 Tumblr 标签云。

我想问如何在我的 Tumblr 博客上显示标签云？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-06T14:27:49.363

第三方 JavaScript 解决方案：[http ://rive.rs/projects/tumblr-tag-clouds](http://rive.rs/projects/tumblr-tag-clouds)

> 这是 Tumblr 的标签云生成器。每次访问您的网站时，它都会使用 Tumblr API 生成标签云。

另一种变体（声称更快）： http: [//post-theory.com/tumblr-tag-cloud-javascript](http://post-theory.com/tumblr-tag-cloud-javascript)

# continuous-integration - Team City 中网站项目的自动版本控制

> ID：12277306
> 
> 赞同：0
> 
> 时间：2012-09-05T08:24:02.980
> 
> 标签：continuous-integration, teamcity, versioning, web-site-project

在我当前的客户中，我们有一些遗留的 ASP.Net 网站项目。我正在为我们的构建引入自动版本控制，并且想知道如何最好地使用 Team City 中的网站项目来做到这一点？

我目前正在使用 Team City 的 %build.number% 变量（通过项目构建模板设置）作为构建的权威版本号。对于任何生成程序集的 .NET 项目，可以轻松使用 Team City 中的“AssemblyInfo Patcher”构建功能，但这不适用于网站项目，因为它们不生成程序集。

那么，有什么建议吗？我已经在我的构建中使用 Powershell 和 psake，因此创建使用 %build.number% 的脚本不是问题，更多的是如何以“好的”方式将其注入网站项目的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T11:51:31.700

我尝试了几种解决方案，但最终使用了 Team City 在构建期间设置的依赖程序集的版本号。我在程序集中添加了一个类，它看起来像这样：

```
公共类 VersionUtils
{
    私有只读 ILog _logger；

 `public VersionUtils()
    {
        _logger = LogManager.GetLogger("VersionLogger");
    }

    public string GetWebAppVerison()
    {
        string version = "unknown version";

        var assembly = Assembly.GetAssembly(typeof(VersionUtils));
        try
        {
            version = assembly.GetName().Version.ToString();
        }
        catch(Exception ex)
        {
            _logger.Warn("Could not find or read version number from " + assembly.GetName(), ex);
        }

        return version;
    }` 

```

# android - OnDraw而不是样条曲线，它绘制圆圈

> ID：12277307
> 
> 赞同：0
> 
> 时间：2012-09-05T08:24:04.480
> 
> 标签：android, graphics, paint, alpha

/我得到以下代码：

```
public class SketchActivity extends Activity implements OnClickListener, OnSeekBarChangeListener {

private MyView myView;

private Button clearBtn;

private ToggleButton embossBtn, blurBtn, eraseBtn, srcaBtn;

private RelativeLayout layout, layout2;

private TextView penSizeTxt;

SharedPreferences pref;

private Preview preview;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(R.layout.activity_main);

    init();
    preview = new Preview(this);

    layout2 = (RelativeLayout) findViewById(R.id.paint_layout2);
    layout = (RelativeLayout) findViewById(R.id.paint_layout);
    layout.addView(preview);
    new Handler().postDelayed(new Runnable() {

        @Override
        public void run() {
            myView = new MyView(SketchActivity.this, layout.getWidth(), layout.getHeight());

            layout2.addView(myView);
            layout2.bringToFront();

        }
    }, 50);

    mPaint = new Paint();
    mPaint.setAntiAlias(true);
    mPaint.setDither(true);
    mPaint.setColor(0xFF000000);
    mPaint.setStyle(Paint.Style.STROKE);
    mPaint.setStrokeJoin(Paint.Join.ROUND);
    mPaint.setStrokeCap(Paint.Cap.ROUND);
    mPaint.setStrokeWidth(5);

    mEmboss = new EmbossMaskFilter(new float[] { 1, 1, 1 }, 0.4f, 6, 3.5f);
    mBlur = new BlurMaskFilter(8, BlurMaskFilter.Blur.NORMAL);
}

private void init() {

    clearBtn = (Button) findViewById(R.id.clearBtn);

    embossBtn = (ToggleButton) findViewById(R.id.embossBtn);
    blurBtn = (ToggleButton) findViewById(R.id.blurBtn);
    eraseBtn = (ToggleButton) findViewById(R.id.eraseBtn);
    srcaBtn = (ToggleButton) findViewById(R.id.srcatopBtn);

    clearBtn.setOnClickListener(this);
    embossBtn.setOnClickListener(this);
    blurBtn.setOnClickListener(this);
    eraseBtn.setOnClickListener(this);
    srcaBtn.setOnClickListener(this);
}

private static Paint mPaint;

private MaskFilter mEmboss;

private MaskFilter mBlur;

public void colorChanged(int color) {
    mPaint.setColor(color);
}

private void setToggleOf() {
    embossBtn.setChecked(false);
    eraseBtn.setChecked(false);
    blurBtn.setChecked(false);
    srcaBtn.setChecked(false);
}

@Override
public void onClick(View v) {
    if (v.getId() == embossBtn.getId()) {

        if (mPaint.getMaskFilter() != mEmboss) {
            setToggleOf();
            mPaint.setXfermode(null);
            mPaint.setAlpha(0xFF);
            mPaint.setMaskFilter(mEmboss);
            embossBtn.setChecked(true);
        } else {
            mPaint.setMaskFilter(null);
            embossBtn.setChecked(false);
        }
    } else if (v.getId() == blurBtn.getId()) {

        if (mPaint.getMaskFilter() != mBlur) {
            setToggleOf();
            mPaint.setXfermode(null);
            mPaint.setAlpha(0xFF);
            mPaint.setMaskFilter(mBlur);
            blurBtn.setChecked(true);
        } else {
            mPaint.setMaskFilter(null);
            blurBtn.setChecked(false);
        }
    } else if (v.getId() == eraseBtn.getId()) {
        if (eraseBtn.isChecked()) {
            setToggleOf();
            eraseBtn.setChecked(true);
            mPaint.setMaskFilter(null);
            mPaint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.CLEAR));

        } else {
            mPaint.setMaskFilter(null);
            mPaint.setXfermode(null);
            mPaint.setAlpha(0xFF);

        }
    } else if (v.getId() == srcaBtn.getId()) {
        if (srcaBtn.isChecked()) {
            setToggleOf();
            mPaint.setMaskFilter(null);
            srcaBtn.setChecked(true);
            mPaint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.SRC_ATOP));
            mPaint.setAlpha(0x80);
        } else {
            mPaint.setMaskFilter(null);
            mPaint.setXfermode(null);
            mPaint.setAlpha(0xFF);
        }

    }

    else if (v.getId() == clearBtn.getId()) {
        layout2.removeAllViews();
        myView = new MyView(SketchActivity.this, layout.getWidth(), layout.getHeight());
        layout2.addView(myView);
    }

}

public class MyView extends View {

    private static final float MINP = 0.25f;

    private static final float MAXP = 0.75f;

    private Bitmap mBitmap;

    private Canvas mCanvas;

    private Path mPath;

    private Paint mBitmapPaint;

    Bitmap bitmap;

    int x = 0;

    int y = 0;

    int r = 0;

    public MyView(Context c, int width, int height) {
        super(c);

        WindowManager wm = (WindowManager) c.getSystemService(Context.WINDOW_SERVICE);
        Display display = wm.getDefaultDisplay();
        int w = display.getWidth(); // deprecated
        int h = display.getHeight();
        // setFocusable(true);
        // setBackgroundResource(R.drawable.download);

        // setting paint
        mPath = new Path();
        mPaint = new Paint();

        mPaint.setAlpha(0);
        mPaint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.DST_IN));
        mPaint.setAntiAlias(true);
        mPaint.setMaskFilter(new BlurMaskFilter(10, BlurMaskFilter.Blur.NORMAL));
        mBitmapPaint = new Paint(Paint.DITHER_FLAG);

        this.getContext().getResources();

        Bitmap bm = BitmapFactory.decodeResource(getResources(), R.drawable.smoke);
        Bitmap bm2 = getResizedBitmap(bm, h, w);

        // converting image bitmap into mutable bitmap

        bitmap = bm2.createBitmap(w, h, Config.ARGB_8888);
        mCanvas = new Canvas();
        mCanvas.setBitmap(bitmap); // drawXY will result on that Bitmap
        mCanvas.drawBitmap(bm2, 0, 0, null);

    }

    @Override
    protected void onSizeChanged(int w, int h, int oldw, int oldh) {
        super.onSizeChanged(w, h, oldw, oldh);
    }

    @Override
    protected void onDraw(Canvas canvas) {
        //mCanvas.drawCircle(x, y, r, mPaint);

        // canvas.drawBitmap(bitmap, 0, 0, null);
        canvas.drawBitmap(bitmap, 0, 0, mBitmapPaint);

        canvas.drawPath(mPath, mPaint);

        super.onDraw(canvas);

    }

    private float mX, mY;

    private static final float TOUCH_TOLERANCE = 4;

    private void touch_start(float x, float y) {
        mPath.reset();
        mPath.moveTo(x, y);
        // mPath.lineTo(x, y);
        // mCanvas.drawPoint(x, y, mPaint);
        mX = x;
        mY = y;

    }

    private void touch_move(float x, float y) {
        float dx = Math.abs(x - mX);
        float dy = Math.abs(y - mY);
        if ((dx >= TOUCH_TOLERANCE) || (dy >= TOUCH_TOLERANCE)) {
            mPath.quadTo(mX, mY, (x + mX) / 2, (y + mY) / 2);
            mX = x;
            mY = y;
        }
        // invalidate();
    }

    private void touch_up() {
        mPath.lineTo(mX, mY);
        // commit the path to our offscreen
        mCanvas.drawPath(mPath, mPaint);
        // kill this so we don't double draw
        mPath.reset();
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        float x = event.getX();
        float y = event.getY();
        switch (event.getAction()) {
        case MotionEvent.ACTION_DOWN:
            touch_start(x, y);

            invalidate();
            break;
        case MotionEvent.ACTION_MOVE:
            touch_move(x, y);
            invalidate();
            break;
        case MotionEvent.ACTION_UP:
            touch_up();
            invalidate();
            break;
        }
        return true;
    }

    public Bitmap getImage() {
        return mBitmap;
    }
}

@Override
public void onProgressChanged(SeekBar seekBar, int progress, boolean fromUser) {
    // TODO Auto-generated method stub
    penSizeTxt.setText(String.valueOf(progress + 2));

}

@Override
public void onStartTrackingTouch(SeekBar seekBar) {
    // TODO Auto-generated method stub

}

@Override
public void onStopTrackingTouch(SeekBar seekBar) {
    // TODO Auto-generated method stub

}

public Bitmap getResizedBitmap(Bitmap bm, int newHeight, int newWidth) {
    int width = bm.getWidth();
    int height = bm.getHeight();
    float scaleWidth = ((float) newWidth) / width;
    float scaleHeight = ((float) newHeight) / height;
    // CREATE A MATRIX FOR THE MANIPULATION
    Matrix matrix = new Matrix();
    // RESIZE THE BIT MAP
    matrix.postScale(scaleWidth, scaleHeight);
    // RECREATE THE NEW BITMAP
    Bitmap resizedBitmap = Bitmap.createBitmap(bm, 0, 0, width, height, matrix, false);
    return resizedBitmap;
}

} 
```

我希望它清除第二个布局并在触摸时显示相机的内容。因此，如果我用手指在屏幕上画一条曲线，它会将这些像素设置为 alpha，并从背面布局查看相机。问题是，例如，如果我制作一条曲线，应用程序也会删除该曲线的内容。因此，如果我用手指画一个圆圈，它也会删除圆圈的内容，而不仅仅是边距。

它的外观截图：http: [//imgur.com/5gjNB](http://imgur.com/5gjNB)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T12:54:06.977

onCreate 我有：

```
mPaint = new Paint();
mPaint.setAntiAlias(true);
mPaint.setDither(true);
mPaint.setColor(0xFF000000);
mPaint.setStyle(Paint.Style.STROKE);
mPaint.setStrokeJoin(Paint.Join.ROUND);
mPaint.setStrokeCap(Paint.Cap.ROUND);
mPaint.setStrokeWidth(5); 
```

然后在我看来，我有：

```
 mPaint = new Paint();
 mPaint.setAlpha(0);
 mPaint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.DST_IN));
 mPaint.setAntiAlias(true);
 mPaint.setMaskFilter(new BlurMaskFilter(10, BlurMaskFilter.Blur.NORMAL)); 
```

覆盖 mPaint，这就是它无法正常工作的原因。通过删除第二个：

```
 mPaint = new Paint(); 
```

我让它工作

# c# - 如何在后面的c#代码中动态添加几个按钮及其点击事件？

> ID：12277311
> 
> 赞同：1
> 
> 时间：2012-09-05T08:24:19.933
> 
> 标签：c#, winforms, code-behind

嗨，我想在我的代码后面的代码中将几个按钮及其单击事件动态添加到我的 Windows 窗体应用程序中，我的按钮将在其中执行`System.Diagnostics.Process.Start(targetURL);` ，我该如何实现？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T08:31:40.250

您只需要创建按钮，设置它的属性和事件处理程序，然后将其添加到`Controls`表单上的集合中。

```
var button = new Button();
try
{
    button.Text = "Button 1";
    button.Click += (sender, e) => System.Diagnostics.Process.Start(targetURL);
    //Or if you don't want to use a lambda and would rather have a method;
    //button.Click += MyButton_Click;
    Controls.Add(button);
}
catch
{
    button.Dispose();
    throw;
}

//Only needed when not using a lambda;
void MyButton_Click(Object sender, EventArgs e)
{
    System.Diagnostics.Process.Start(targetURL);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T08:32:13.837

您可以将任何您喜欢的控件添加到[`Controls`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.controls)表单的集合中：

```
var targetURL = // ...

try
{
    SuspendLayout();

    for (int i = 0; i < 10; i++)
    {
        var button = new Button();
        button.Text = String.Format("Button {0}", i);
        button.Location = new Point(0, i * 25);
        button.Click += (object sender, EventArgs e) => System.Diagnostics.Process.Start(targetURL);
        this.Controls.Add(button);
    }
}
finally
{
    ResumeLayout();
} 
```

将多个控件添加到父控件时，建议您[`SuspendLayout`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.suspendlayout)在初始化要添加的控件之前调用该方法。将控件添加到父控件后，调用该[`ResumeLayout`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.resumelayout)方法。这样做将提高具有许多控件的应用程序的性能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T08:32:45.337

声明你的按钮变量。

添加事件处理程序

将它们添加到表单控件属性中。

利润

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-05T08:34:41.077

您可以编写一个包含文本框“txbURL”、按钮“btnNavigateToURL”的用户控件并编写按钮的事件处理程序，以执行您的代码（System.Diagnostics.Process.Start(targetURL);）

完成后，很容易在运行时将控件添加到表单中，编写类似这样的代码（现在没有 ac# 编辑器，因此您可能需要验证代码）

```
MyControlClassName userControl = new MyControlClassName(string targetUrl);
userControl.Parent = yourForm;
yourForm.Controls.Add(userControl); 
```

就是这样。

# emacs - 如何以交互方式调用函数

> ID：12277312
> 
> 赞同：1
> 
> 时间：2012-09-05T08:24:23.693
> 
> 标签：emacs, elisp, interactive

当我启动 Emacs 时，我希望它填满屏幕的左半部分。我使用

```
;; set initial window size to the left half of the screen
(defun set-frame-pixel-size (frame width height)
  "Sets size of FRAME to WIDTH by HEIGHT, measured in pixels."
  (let ((pixels-per-char-width (/ (frame-pixel-width) (frame-width)))
        (pixels-per-char-height (/ (frame-pixel-height) (frame-height))))
    (set-frame-size frame
                    (floor (/ width pixels-per-char-width))
                    (floor (/ height pixels-per-char-height)))))

(defun use-left-half-screen ()
  (interactive)
  (let* ((excess-width 32)
         (excess-height 48)
         (half-screen-width (- (/ (x-display-pixel-width) 2) excess-width))
         (screen-height (- (x-display-pixel-height) excess-height)))
    (set-frame-pixel-size (selected-frame) half-screen-width screen-height)))

(if window-system
    (use-left-half-screen)) 
```

而且效果很好。但是，我有时想在一天中的另一个时间调用相同的命令。因此，我做了，`M-x use-left-half-screen`但没有任何反应。

也就是说，除非我`M-: (set-frame-pixel-size (selected-frame) 1024 768)`先运行（或类似的东西）。如果我这样做，并且我不使用鼠标更改帧大小，那么就`use-left-half-screen`可以了。一旦我使用鼠标或操作系统快捷方式更改帧大小，它就会停止工作。

你对我如何创作有什么想法`M-x use-left-half-screen`吗？

# android - Android 主题设置为黑色，但在 Android 4.1 中为白色

> ID：12277315
> 
> 赞同：4
> 
> 时间：2012-09-05T08:24:38.467
> 
> 标签：android, eclipse

我在我的styles.xml中都试过了`Theme.DeviceDefault`，`Theme.Black`都让我的2.1模拟器正确变黑，但在4.1模拟器上它保持白色......我做错了什么吗？

```
<resources>

    <style name="AppTheme" parent="android:Theme.Black" />

</resources> 
```

PS：我认为图形布局顶部的“主题”下拉菜单只是向我展示了它的外观，而不是某种设置（对于应用程序）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-11T10:19:56.150

Android 系统总是选择最适合您设备的最特殊的值文件夹。

例如，如果您有一个文件夹`values`和另一个文件夹`values-v14`，如果设备是 v14 或更新版本，Android 系统将从后者获取资源。

有关更多信息，请参阅[Android 文档](http://developer.android.com/guide/topics/resources/providing-resources.html#AlternativeResources)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T08:38:53.313

1.在 res -> values-v13 下创建新文件夹 2.在
那里创建文件样式并添加此样式：
`<style name="AppTheme" parent="android:style/Theme.Holo.Light">`

在您的清单中，像这样为您的应用程序使用这种风格

```
<application
        android:name=".MainApp"        
        android:icon="@drawable/icon"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" > 
```

这样，在 ICS 版本上，您使用 Holo.light 主题，而 ICS 前使用您已经创建的默认值

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-01T08:49:18.210

通过样式设置它实际上不起作用，但是如果您为应用程序明确设置它，它就可以工作。

```
<application
android:allowBackup="true"
android:icon="@drawable/ic_launcher"
android:label="@string/app_name"
android:theme="@android:style/Theme.Black" > 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T08:42:30.050

默认情况下 4.0 和 4.1 为我们提供白色背景，但您可以将其更改为黑色 我几天前遇到了同样的问题，如果您的项目主题设置为黑色，那么您可能在创建项目时将标题更改为默认为“主” “MainActivity”，但如果你把它改成“Main”，它会给你黑色背景/

我不知道我的回答是否与您的问题相关，但如果我没记错的话，我认为您在谈论这个。

# sql-server - 在 SQL Server 2008 中使用数据库 661 版本

> ID：12277316
> 
> 赞同：2
> 
> 时间：2012-09-05T08:24:42.013
> 
> 标签：sql-server

> **可能重复：**
> [SQL Server：附加不正确的版本 661](https://stackoverflow.com/questions/4257684/sql-server-attach-incorrect-version-661)

我有 661 版本的 sql server 数据库。我有 SQL Server 2008 。我想在 SQL Server 2008 中附加和使用这个数据库。但是当我试图附加这个数据库时，sql server 会出现如下错误：

> 无法附加数据库 661 版本，因为 sql server 仅支持 655 数据库版本或很早。

*   为了使用该数据库版本，我必须使用 SQL Server 2008 做什么？
*   也许我必须为 sql server 设置最新的 Service Pack？
*   也许还有更多？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T08:33:19.220

版本 661 是 SQL 2008 R2。您无法将文件从 R2 还原或附加到 SQL 2008 (655) 服务器。

如果您可以升级到 SQL 2008 R2，请执行此操作。否则你将不得不找到一些方法来迁移数据（例如；SSIS）

# sql - 安全地传输存储过程

> ID：12277319
> 
> 赞同：1
> 
> 时间：2012-09-05T08:25:05.717
> 
> 标签：sql, database, tsql, stored-procedures

我正在开发一个有版本的项目。如果准备发布新版本，我会准备存储过程以由 DBA 更新数据库。我给他发了 SP，他执行了它们。但是，我不希望 DBA 看到我的 SP 代码。是否可以在不向 DBA 显示代码的情况下传输存储过程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:49:23.117

如果您发布 CLR 存储过程并混淆程序集，那么该功能将被很好地隐藏。

我建议这将是使用 CLR 存储过程的**错误**动机。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T13:47:08.307

一种选择是在加密文本文件中提供 SQL 存储过程。并在 .NET 中编写您自己的应用程序，该应用程序将读取加密的 SQL 文本，对其进行解密，然后部署到选定的服务器。

如果您在 .NET 中工作，那么您将知道编写这样一个应用程序是多么容易。只需为该应用程序提供您存储的 Procs。DBA 将能够使用该应用程序部署存储的过程而无需看到它们。对于简单的场景，您可以硬编码解密 SQL 文本所需的“密码”，但对于更敏感的场景，您可以使用 PKI。

与所有其他解决方案一样，此解决方案可以进行逆向工程，但恕我直言，这是一个比在 CLR 中重写存储过程逻辑更好的选择。

注意：我假设您将使用`WITH ENCRYPTION`选项来创建存储过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T08:47:16.243

好吧，正如 Phillip 已经评论的那样，如果我是执行您的存储过程的人，那么在我的数据库上运行我无法阅读的东西时会遇到很大的问题。

如果您希望您的代码乍一看不可读，请尝试混淆（一种或另一种形式几乎总是可用 - 如果您只是使用 BASE64 编码/解码字符串并立即执行）

对于以上所有内容，您都需要加密的存储过程，但这取决于系统，我对 tsql 的了解不足以告诉您。

# html - CSS 在 XSLT 中无法正常工作

> ID：12277323
> 
> 赞同：1
> 
> 时间：2012-09-05T08:25:35.103
> 
> 标签：html, css, xslt

我使用以下代码使用 XSLT 将 XML 文件显示为 HTML

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="Report/Scripts">
<html>
   <head>
   <title>Mobiuss.rtp Test Execution Results</title>
   <link rel="stylesheet" href="xmlstyle.css" />
   </head>
   <body>
   <xsl:for-each select="Script">
   <h1><xsl:value-of select="@File"/></h1>
   Execution log
   <br>
   </br>
   <table class="sortable">
   <tr>
   <th>Time</th>
   <th>Position</th>
   <th>Type</th>
   <th>Message</th>
   </tr>
   <xsl:for-each select="Message">
   <tr>
   <td> <xsl:value-of select="@Time"/></td>
   <td>Line <xsl:value-of select="@Line"/></td>
   <td> <xsl:value-of select="@Type"/></td>
   <td> <xsl:value-of select="@Message"/></td>
   </tr>
   </xsl:for-each>
   </table>
   </xsl:for-each>       
   </body>
</html>   
</xsl:template>
</xsl:stylesheet> 
```

上面的代码将 XML 文件显示为 html，它创建了大约 4 个表（取决于 XML）但由于某种原因，我不知道第一个表单独遵循 CSS，所有其他表都没有设置样式。

CSS代码在这里：

```
@CHARSET "ISO-8859-1";
.sortable {width:100%; height:40px; border:1px solid #ccc; background-color:#EEE0E5}
.sortable th {padding:4px 6px 6px; background:#444; color:#fff; text-align:center;     color:#ccc}
.sortable td {padding:2px 4px 4px; background:#fff; border-bottom:1px solid #ccc; overflow:auto}
.sortable .head {background:#444 url(images/sort.gif) 6px center no-repeat; cursor:pointer; padding-left:18px}
.sortable .desc {background:#222 url(images/desc.gif) 6px center no-repeat; cursor:pointer; padding-left:18px}
.sortable .asc {background:#222 url(images/asc.gif) 6px  center no-repeat; cursor:pointer; padding-left:18px}
.sortable .head:hover, .sortable .desc:hover, .sortable .asc:hover {color:#fff}
.sortable .even td {background:#f2f2f2}
.sortable .odd td {background:#fff} 
```

请指导我在我的代码中进行哪些更改，以便创建的所有表格都具有正确的样式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:59:41.700

所以这是一个简单的测试：http: [//jsbin.com/azaqog/1/](http://jsbin.com/azaqog/1/)似乎工作正常。您所面临的问题在提供的数据中并不明显。

我现在可以怀疑的一件事是，您从 XML 解析的数据包含导致最终 HTML 无效的内容。我建议您将 XML+XSLT 解析为原始文本文件，然后查看输出。您应该在那里看到破坏您的 html 的东西。

# xml - 介绍 MathML 的好网站？

> ID：12277329
> 
> 赞同：-1
> 
> 时间：2012-09-05T08:26:16.193
> 
> 标签：xml, mathml

我找不到一个合理的视频或网站来详细解释和教授 MathML。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:45:55.060

数学机器学习基础

[http://www.w3.org/TR/MathML3/chapter2.html](http://www.w3.org/TR/MathML3/chapter2.html)

数学介绍

[http://en.wikipedia.org/wiki/MathML](http://en.wikipedia.org/wiki/MathML)

带有 html5 的 MathML

[http://www.tutorialspoint.com/html5/html5_mathml.htm](http://www.tutorialspoint.com/html5/html5_mathml.htm)

MathML 浏览器测试

[https://eyeasme.com/Joe/MathML/MathML_browser_test](https://eyeasme.com/Joe/MathML/MathML_browser_test)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T21:33:47.410

如果您大量使用 HTML5 并依赖 chrome 进行开发。尽管底层渲染引擎 webkit 构建似乎默认启用了 MATHML 支持，但 Chrome 尚不支持 MATHML。

# iphone - scheduleLocalNotification 不起作用

> ID：12277334
> 
> 赞同：2
> 
> 时间：2012-09-05T08:26:30.490
> 
> 标签：iphone, ios, ipad

当我从 dateTimePicker.date 获取时间/日期时，通知工作，但是当我使用 dateFromString 触发日期时，通知不起作用。

编码：

```
-(IBAction)alarmSetButtonTapped:(id)sender {

NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
dateFormatter.locale = [NSLocale systemLocale];
dateFormatter.timeStyle = NSDateFormatterShortStyle;
dateFormatter.dateStyle = NSDateFormatterShortStyle;

NSString *tmp = @"2012-09-05 10:19";
[dateFormatter setDateFormat: @"yyyy-MM-dd HH:mm"];
[dateFormatter setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:0]];

NSDate *dateFromString = [dateFormatter dateFromString: tmp];
NSLog(@"Alarm TMP %@", dateFromString);
[dateFormatter release];

[self scheduleLocalNotificationWithDate:dateFromString];
[self presentMessage:@"Alarm set"]; 
```

};

请问你能帮我吗？？

编辑：

```
-(void) scheduleLocalNotificationWithDate:(NSDate *)fireDate {

UILocalNotification *notification = [[UILocalNotification alloc] init];

notification.fireDate = fireDate;
notification.alertBody = @"Time to wake up";
notification.soundName = @"clock.mp3";

[[UIApplication sharedApplication] scheduleLocalNotification:notification];

[notification release];
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T08:36:31.477

```
UILocalNotification *localNotification = [[UILocalNotification alloc] init];

    // Set the fire date/time
    [localNotification setFireDate:yourDate];
    [localNotification setTimeZone:[NSTimeZone defaultTimeZone]];

    localNotification.applicationIconBadgeNumber=1;

    // Setup alert notification
    [localNotification setAlertAction:@"Open App"];
    [localNotification setAlertBody:[randonQuotesDic objectForKey:@"Rajneesh"]];
    [localNotification setAlertBody:@"You had set a Local Notification on this time"];

    localNotification.soundName=UILocalNotificationDefaultSoundName;
    [localNotification setHasAction:YES];      
    UIApplication *app=[UIApplication sharedApplication];
    [app scheduleLocalNotification:localNotification]; 
```

# asp.net - 如何为 Ipad 网站制作更大尺寸的 AjaxCalender 控件？

> ID：12277336
> 
> 赞同：1
> 
> 时间：2012-09-05T08:26:39.673
> 
> 标签：asp.net, ajax, calendar, ajaxcontroltoolkit

我想通过覆盖默认 ajax Calender 的样式来制作更大尺寸的 ajax Calander 控件。

它应该在更大的视野中工作。我尝试过，但当我尝试选择月/年视图时效果不佳..

在这里，我附上了屏幕截图，我到底想用 ajax 日历控件做什么。

![在此处输入图像描述](../Images/50db9991163492fc435c1767e9592cf8.png)

是否可以为 iPad 网站提供更大的视图？

或建议我为 Ipad 网站提供良好的日历控制，我想使用 asp.net 网站。

谢谢阿布舍克

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-01-03T15:20:08.327

我自己也刚刚经历过。您需要做 3 件事。

**首先**- 向您的控件添加一个 CSS 类。但是请注意，如果您这样做，它会擦除​​现有的 ajax__calendar 类，因此它的大部分现有样式都将被添加到 CalendarExtender

```
 CssClass="ajax__calendar bigcal" 
```

bigcal 是你的新课程。

**第二**- 使用 bigcal 类为样式添加你的 CSS - 例如

```
.bigcal .ajax__calendar_container { width: 220px; font-size:14px;}
.bigcal .ajax__calendar .ajax__calendar_container {border: 3px solid #646464;}
.bigcal .ajax__calendar_days, .bigcal .ajax__calendar_months, .bigcal .ajax__calendar_years, .bigcal .ajax__calendar_body
{width:220px;height:200px}
.bigcal .ajax__calendar_month, .bigcal .ajax__calendar_year{height:55px;padding-top:4px}
.bigcal .ajax__calendar_container table, .bigcal .ajax__calendar_container TD {font-size:14px}
.bigcal .ajax__calendar_days td div{padding:4px 5px 4px 4px} 
```

请注意，我已将其大小重置为 220 宽和 200 高 - 相应调整

**第三**- 您需要在 javascript 中更改它的大小，因为它默认为滚动等工作的设定大小。所以

将以下内容添加到 CalendarExtender

```
OnClientShown="setBigCal" 
```

然后是下面的js函数

```
function setBigCal(sender, e) {
    sender._height = 200;
    sender._width = 220;
} 
```

HTH :)

编辑 - 抱歉 - 刚刚看到这个问题的日期，所以我假设你已经排序。但我会留下答案，以防其他人遇到同样的问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-04-08T20:00:19.443

我知道我的回答迟到了。我知道你在问 ajax 日历。但它可能会帮助其他人。几个程序员问如何格式化asp.net 日历。您可以使用以下样式格式化 asp.net 日历：

```
.calander {
    background-color: whitesmoke;
    border: 1px solid;
    height: 305px;
    width: 280px;
}

    .calander table tr td {
        padding: 10px;
    }

        .calander table tr td:hover {
            background-color:rgb(200, 255, 0);
        }

.ajax__calendar_today {
    background-color: rgb(209, 233, 255) !important;
    border-radius: 3px;
}

.ajax__calendar_footer {
    background-color: rgb(209, 233, 255) !important;
    width: 100% !important;
    margin: 0px !important;
    padding: 0px !important;
    position: relative !important;
    height: auto !important;
}

.ajax__calendar_active {
    background-color: rgb(200, 255, 0) !important;
    border-radius: 3px;
}

.ajax__calendar_day {
    height: 20px !important;
    width: 20px !important;
    padding: 0px;
    text-align: center;
    margin-top: -8px;
    margin-left: -5px;
}

.ajax__calendar_body {
    width: 270px !important;
    height: 245px !important;
}

.ajax__calendar_container {
    width: auto !important;
} 
```

这些样式可以按照您想要的任何方式进行定制。

# c# - 如何等待收到几个回调

> ID：12277337
> 
> 赞同：0
> 
> 时间：2012-09-05T08:26:45.470
> 
> 标签：c#, events

我有这样的代码：

```
 public void IssueOrders(List<OrderAction> actions)
    {
        foreach (var action in actions)
        {
            if (action is AddOrder)
            {
                uint userId = apiTransactions.PlaceOrder((action as AddOrder).order);
                Console.WriteLine("order is placing userId = " + userId);
            }
            // TODO: implement other actions
        }
        // how to wait until OnApiTransactionsDataMessageReceived for all userId is received?

        // TODO: need to update actions with received data here
    }

    private void OnApiTransactionsDataMessageReceived(object sender, DataMessageReceivedEventArgs e)
    {
        var dataMsg = e.message;
        var userId = dataMsg.UserId; 
```

`apiTransactions.PlaceOrder`是异步的，所以我会收到`userId`结果，但我会在回调 OnApiTransactionsDataMessageReceived 中接收数据。

例如，如果我下了 3 个订单，我将收到 3 个 userId，例如`1`、`3`和`4`。现在我需要等到收到所有这些 userId 的数据。

`userId`如果这很重要，它总是在增加。这几乎是整数序列，但由于并行执行，可能会省略一些数字。

**升级版**注意事项：

*   IssueOrders 可以从不同的线程并行执行
*   callack 可以在 PlaceOrder 返回之前被调用

**UPD2**

可能我需要重构下面的 PlaceOrder 代码，以便我可以保证`userId`在收到“回调”之前知道它：

```
 public uint PlaceOrder(Order order)
    {
        Publisher pub = GetPublisher();

        SchemeDesc schemeDesc = pub.Scheme;
        MessageDesc messageDesc = schemeDesc.Messages[0]; //AddMM
        FieldDesc fieldDesc = messageDesc.Fields[3];
        Message sendMessage = pub.NewMessage(MessageKeyType.KeyName, "FutAddOrder");

        DataMessage smsg = (DataMessage)sendMessage;
        uint userId = counter.Next();
        FillDataMessageWithPlaceOrder(smsg, order, userId);

        System.Console.WriteLine("posting message dump: {0}", sendMessage);
        pub.Post(sendMessage, PublishFlag.NeedReply);
        sendMessage.Dispose();

        return userId;
    } 
```

所以我需要将 PlaceOrder 拆分为两种方法：`userId CreateOrder`和`void PostOrder`. 这将保证当收到回调时我知道`userId`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:32:37.850

我会查看 Reactive Framework 中的[ForkJoin](http://rxwiki.wikidot.com/101samples#toc3)方法。它将阻塞，直到多个异步调用完成。

**编辑：**似乎 ForkJoin() 只包含在 Rx 的实验版本中。这是基于 Merge() 对您想要的内容的[讨论。](http://social.msdn.microsoft.com/Forums/en-US/rx/thread/3cfccb74-9ce3-47dc-94fd-cf60270c1ed5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:40:56.530

最愚蠢和最有效的方法之一是：

```
public void IssueOrders(List<OrderAction> actions)
{
    var userIds = new List<uint>();
    lock(theHashMap)
        theHashMap[userIds] = "blargh";

    foreach (var action in actions)
    {
        if (action is AddOrder)
        {
            lock(userIds)
            {
               uint userId = apiTransactions.PlaceOrder((action as AddOrder).order);
               Console.WriteLine("order is placing userId = " + userId);

               userIds.Add(userId);
            }
        }

        // TODO: implement other actions
    }

    // waiting:
    do
    {
       lock(userIds)
          if(userIds.Count == 0)
             break;

       Thread.Sleep(???); // adjust the time depending on how long you wait for a callback on average

    }while(true);

    lock(theHashMap)
        theHashMap.Remove(userIds);

    // now you have the guarantee that all were received
}

private Dictionary<List<uint>, string> theHashMap = new Dictionary<List<uint>,string>();

private void OnApiTransactionsDataMessageReceived(object sender, DataMessageReceivedEventArgs e)
{
    var dataMsg = e.message;
    var userId = dataMsg.UserId;

    // do some other things

    lock(theHashMap)
        foreach(var list in theHashMap.Keys)
           lock(list)
              if(list.Remove(userId))
                 break;
} 
```

但是，这是一种相当粗暴的方法。除非你解释等待是什么意思，否则很难提出更多建议——正如乔恩在评论中所问的那样。例如，您可能想离开`IssueOrders`，在任何地方等待，并确保在所有人都到达时完成了一些额外的工作？或者，`IssueOrders`除非全部收到，否则您不能离开？ETC..

编辑：请注意，在 ADD 附近，锁必须**在**PlaceOrder 之前，否则，当回调超快到达时，回调可能会在添加之前尝试删除 ID。另外，请注意这个实现非常幼稚：回调必须每次都搜索并锁定所有列表。加上一些额外的字典/地图/索引，它可能会被优化很多，但为了可读性我没有在这里做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T08:41:14.673

如果您能够更改 API，请考虑使用[Task Parallel Library](http://msdn.microsoft.com/en-us/library/dd460717.aspx)，您的代码将变得更加容易。

否则[AutoResetEvent](http://msdn.microsoft.com/en-us/library/system.threading.autoresetevent.aspx)可能会帮助您：

```
 private Dictionary<int, AutoResetEvent> m_Events = new ...;

    public void IssueOrders(List<OrderAction> actions)
    {
        foreach (var action in actions)
        {
            if (action is AddOrder)
            {
                uint userId = apiTransactions.PlaceOrder((action as AddOrder).order);
                // Attention: Race condition if PlaceOrder finishes                                         
                // before the MRE is created and added to the dictionary!
                m_Events[userId] = new ManualResetEvent(false);
                Console.WriteLine("order is placing userId = " + userId);
            }
            // TODO: implement other actions
        }

        WaitHandle.WaitAll(m_Events.Values);

        // TODO: Dispose the created MREs
    }

    private void OnApiTransactionsDataMessageReceived(object sender, DataMessageReceivedEventArgs e)
    {
        var dataMsg = e.message;
        var userId = dataMsg.UserId;

        m_Events[userId].Set();
    } 
```

# android - Android adb (OSX Lion) 无法识别 Galaxy Nexus、Jelly Bean

> ID：12277339
> 
> 赞同：13
> 
> 时间：2012-09-05T08:26:56.770
> 
> 标签：android, eclipse, macos, adb

我一直在安装在 OSX Lion 上的 Eclipse 上开发我的第一个 android 应用程序。我想使用我的 Jelly Beans Galaxy Nexus 进行调试，但[Android Device Bridge (adb)](http://developer.android.com/tools/help/adb.html)找不到该设备：

```
./adb devices
* daemon not running. starting it now on port 5037 *
* daemon started successfully *
List of devices attached 
```

*   手机处于调试模式。
*   手机可以识别为相机 (PTP)，但不能识别为媒体设备 (MTP)。无论 PTP\MTP 设置如何，ADB 都不起作用。
*   我没有重新启动手机和mac
*   按照[这个建议](https://stackoverflow.com/questions/9401049/samsung-galaxy-nexus-doesnt-appear-under-adb-devices-on-os-x)，我安装了[Android File Transfer](http://www.android.com/filetransfer/)。ATF 识别设备，但 ADB 没有运气。

有任何想法吗？

**附录：**我已经[报告了一个错误](https://code.google.com/p/android/issues/detail?id=37059&thanks=37059&ts=1346842671)。解决方法仍然是最受欢迎的！

**9 月 5 日 13:28 UTC - 解决方法 #1：Dropbox：**我已将 OSX Eclipse 工作区移至 Dropbox 并在设备上安装了 Dropbox。APK 被写入`bin/`，每次成功构建后我都会从 Dropbox 应用重新安装它。

![在此处输入图像描述](../Images/b4e2c751ea15c2da6ff2ca45845614f3.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-12T12:43:27.590

我正在回答这个问题，因为我的老板刚刚在他的 Galaxy Nexus 上遇到了完全相同的问题，我们昨天终于修复了它。他有一个名为“EasyTether”的应用程序阻碍了他与 ADB 的连接，并且无法在其他任何地方使用。您是否已经设置了此应用程序，或者可能为您使用 ADB 的类似应用程序？如果“Android 文件传输”有效（它与我老板的 EasyTether 并行工作），那么您的连接处于活动状态，因此只要在您的设置中启用“USB 调试”，您应该会看到连接。如果您确实拥有“easytether”，这是一个快速操作方法

**在您插入手机**之前，在终端中运行以下命令****

 **```
sudo kextunload /System/Library/Extensions/EasyTetherUSBEthernet.kext 
```

如果这解决了问题，并且您想完全删除easytether，您可以`rm`使用带有`-rf`标志的命令来防止它再次发生......

```
sudo kextunload /System/Library/Extensions/EasyTetherUSBEthernet.kext
sudo rm -rf /System/Library/Extensions/EasyTetherUSBEthernet.kext 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-08T08:33:48.450

您可以通过 wifi 使用 adb。

看这篇[文章](https://stackoverflow.com/questions/2604727/how-can-i-connect-to-android-with-adb-over-tcp)自己做。

或者google play上有相当多的[应用程序。](https://play.google.com/store/apps/details?id=bohlool.net.wifiadb&hl=en)但是这些需要root访问权限

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T01:56:36.263

你试过不同的电缆吗？我从 eBay 上订购了一堆便宜的电缆，而我使用的第一根电缆不适用于 adb。但是，它确实适用于收费和文件传输。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-05T08:29:04.377

1.  尝试将 USB 棒从手机中取出并放回原处
2.  尝试将其从 Mac 中取出并放回原处
3.  试着把棍子放在另一个端口
4.  尝试扭动摇杆，以确保它已连接。

这里对可能的解决方案进行了长时间的讨论：[Can't find android device using "adb devices" command](https://stackoverflow.com/questions/6026948/cant-find-android-device-using-adb-devices-command)**

# actionscript-3 - as3 错误属性 serverInfo 在字符串上找不到并且没有默认值

> ID：12277343
> 
> 赞同：1
> 
> 时间：2012-09-05T08:27:09.320
> 
> 标签：actionscript-3

我目前正在使用 ActionScript 3 试验 AMFPHP，一切正常，但是当我将数据插入数据库时​​出现以下错误，但数据将插入我的数据库。

下面是PHP中的代码：

```
<?php 
public function setColor($kleur){
  mysql_query("INSERT INTO kleuren (kleuren) VALUES ("'.$kleuren."')");
  return $kleur;
?> 
```

现在忽略安全问题我是最新的 SQL 注入，但现在这并不重要。

我的 AS3 代码如下所示：

```
import fl.controls.Button;
import fl.events.ComponentEvent;
import flash.display.Stage;
import flash.display.Sprite;
import flash.events.MouseEvent;
import flash.net.NetConnection;
import flash.net.Responder;
import flash.text.TextField;
import flash.text.TextFormat;
import flash.text.TextFieldAutoSize;

/**

MidasSerialComm 2.6.1

Attributes
    input
        a value which receives from serial port.

Methods
    serIn()
        Returns a String value read from serial port.
    serOut(String arg)
        Send "arg" to serial port.
        No return value.

*/

// The belows are parameters for configuration of module
midas.commport="COM4"; // necessary field
//midas.baudrate="9600";;
//midas.parity="n";
//midas.databit="8";
//midas.stopbit="1";
//midas.eof="ascii 13";
//midas.stx="null";
//midas.etx="null";
//midas.debug=false;
midas.serverip="localhost"; // necessary field
midas.serverport="8864"; // necessary field

midas.visible = false;

//knoppen rood , groen en blauw opzetten

var roodLampje:Sprite = new Sprite();
roodLampje.graphics.beginFill(0xFF0000);
roodLampje.graphics.drawRect(stage.stageWidth / 2 + -150, stage.stageHeight / 2, 60, 40);
roodLampje.buttonMode = true;
addChild(roodLampje);

var groenLampje:Sprite = new Sprite();
groenLampje.graphics.beginFill(0x00FF00);
groenLampje.graphics.drawRect(stage.stageWidth / 2 + -80, stage.stageHeight / 2, 60, 40);
groenLampje.buttonMode = true;
addChild(groenLampje);

var blauwLampje:Sprite = new Sprite();
blauwLampje.graphics.beginFill(0x0000FF);
blauwLampje.graphics.drawRect(stage.stageWidth / 2 + -10, stage.stageHeight / 2, 60, 40);
blauwLampje.buttonMode = true;
addChild(blauwLampje);

var zetLampjeUit:Sprite = new Sprite();
zetLampjeUit.graphics.beginFill(0x000000);
zetLampjeUit.graphics.drawRect(stage.stageWidth / 2 + 60, stage.stageHeight / 2, 60, 40);
zetLampjeUit.buttonMode = true;
addChild(zetLampjeUit);

//kleuren 

var rood:String = "Rood";
var groen:String = "Groen";
var blauw:String = "Blauw";

var huidigKleur:String;
var netConnection:NetConnection;
var responder:Responder;

//click events toevoegen aan buttons
roodLampje.addEventListener(MouseEvent.CLICK, onRoodClick);
groenLampje.addEventListener(MouseEvent.CLICK, onGroenClick);
blauwLampje.addEventListener(MouseEvent.CLICK, onBlauwClick);
zetLampjeUit.addEventListener(MouseEvent.CLICK, onUitClick);

//connectie met service
netConnection = new NetConnection();
netConnection.connect("http://navidmirzaie.com/amfphp/gateway.php");
responder = new Responder(onResult, onFault);

var t:TextField;
var textFormat:TextFormat = new TextFormat("Verdana",14,0x000000);

midas.ondata = function(msg){

    switch(msg){
        case "49":
            huidigKleur = rood;
            netConnection.call("ArduinoTest.setColor",responder,huidigKleur);
            //trace(huidigKleur);
        break;

        case "50":
            huidigKleur = groen;
            netConnection.call("ArduinoTest.setColor",responder,huidigKleur);
            //trace(huidigKleur);
        break;

        case "51":
            huidigKleur = blauw;
            netConnection.call("ArduinoTest.setColor",responder,huidigKleur);
            //trace(huidigKleur);
        break;

        case "48":

        break;

    }   

}

//click handlers, reageer op de gedrukte knop
function onRoodClick(eventObj:MouseEvent):void {
    midas.output("1");
    //trace("er is op rood geklik");
}

function onGroenClick(eventObj:MouseEvent):void {
    midas.output("2");
    //trace("er is op groen geklik");
}

function onBlauwClick(eventObj:MouseEvent):void {
    midas.output("3");
    //trace("er is op blauw geklik");
}

function onUitClick(eventObj:MouseEvent):void {
    midas.output("0");
    //trace("er is op blauw geklik");
}

//data afhandeling post
function onResult(responds:Object){

    var t:Array = new Array();
    t = responds.serverInfo.initialData;
    //var t:Array = responds.serverInfo.initialData;
    trace(t.length);

    /*
    for(var i:uint = 0; i < t.length; i++){
        trace("Aantal "+t[i][0]+" "+t[i][1]);
    }
    */
}

function onFault(responds:Object){
    for(var i in responds){
        trace(responds[i]);
    }
}

netConnection.call("ArduinoTest.getCountofTotallColors",responder);
//data ophalen van arduino 
```

我收到此错误：

> ReferenceError：错误＃1069：`serverInfo`找不到属性`String`并且没有默认值。在 test2_fla::MainTimeline/onResult()

我不明白错误的重点，这就是我无法调试代码的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:48:20.273

显然，您在响应中收到了一个未分类的字符串。对您在 onResult() 函数中传递的对象类型进行调试，如下所示：

```
function onResult(responds:Object):void
{
    if (responds is Array) {
        trace('Array has been received:',responds);
        // do something with that array
    } else if (responds is String) {
        trace('String has been received:',responds);
        // do something with that string
    } else {
        trace('An object of unknown type has been received:',responds);
        for (var i:String in responds) trace('['+i+']',responds[i]);
    }
} 
```

# asp.net - 如何检测是否发生 ISAPI 重写

> ID：12277345
> 
> 赞同：0
> 
> 时间：2012-09-05T08:27:43.193
> 
> 标签：asp.net, iis, isapi-rewrite

我在开始新工作后继承了旧系统，以前的开发人员都不再在这里工作，也没有人记录这么多。娱乐时间。

该系统使用旧的、已失效的 CMS，而我刚刚完成了一场大考验，我一生都无法弄清楚路由是如何工作的（客户想要更改 URL）。后来发现，以前的开发人员一直在使用一个完全独立的程序，称为“Helicon ISAPI rewrite”，并从那里完成了网站的所有 URL 管理。

我的问题是：我怎么能更快地弄清楚这一点（例如，有没有我可以使用的外部工具或我不知道的日志会揭示这个路由是如何工作的）？

我花了整整一个下午的时间来挑选价值 10 年的代码，而答案还没有出现！现在我觉得我没有机会快速解决这个问题，但我想知道我是否遗漏了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T02:23:38.813

我想我明白你在问什么，首先要发现重写。如果您事先了解 ISAPI_Rewrite，Tony 的回答是正确的，但事后看来是 20-20。我是 ISAPI_Rewrite 和 Helicon Ape 的忠实粉丝，所以我可能对此有所怀疑。但是，如果重写是由 IIS7 的 .NET web.config 完成的，我就不会在那里查看（尽管我猜 web.config 应该是任何 IIS-screwy 的起点）。使用旧版 CMS 或 WordPress 之类的东西，我不知道从哪里开始，所以我可能会像你一样从代码开始。

我想真正的起点是 IIS 的顶部，甚至在请求到达 Web 代码之前。

在 IIS7 中环顾四周，我看到 Handler Mappings，里面有一大堆东西，拦截各种请求。这些都可以在请求到达网站之前“做一些事情”。例如，我看到 Microsoft 的 ExtensionlessUrlHandler... 在升级到 .NET 4.0 时，它给我们带来了麻烦，因为它是一个重大变化。我们不得不为此挖掘，想知道是什么将 eurl.axd 放入我们的网址中。

IIS6 在网站属性上有一个 ISAPI 过滤器选项卡。我的里面有 ISAPI_Rewrite 和 ASP.NET_2.0....。还有一个带有 MIME 类型的 HTTP Headers 表，这可能是转移请求的罪魁祸首。

现在知道了这一点，也许所有重写软件的列表会很方便。只需在系统中搜索已安装的任何一个 - 可能是获得第一条线索的最快方法。

实际上，如果您在 10 年的代码中花费了一个下午，那还不错！因此，您可能没有机会快速弄清楚这一点 - 任何遗留系统都会隐藏秘密。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T09:03:06.613

如果是 ISAPI_Rewrite v3，您可以通过输入以下行来启用 ISAPI_Rewrite 安装文件夹中的 httpd.conf 日志记录：

```
RewriteLogLevel 9
LogLevel debug 
```

然后在您提出一些测试请求后，rewrite.log 和 error.log 文件将出现在 ISAPI_Rewrite 安装文件夹中。error.log 显示一般问题，而 rewrite.log 显示如何应用规则以及是否应用规则以及生成的 URL 是什么。

# ios - 选择 UITableViewCell 时 UITabBar 消失

> ID：12277352
> 
> 赞同：0
> 
> 时间：2012-09-05T08:28:11.867
> 
> 标签：ios, uitableview, uitabbar

我有一个 UITableView，其中有一个名为“Sunset”的单元格。按下 UITableViewCell 后，视图会切换到“infoView”，它会从 .txt 文件中加载一些文本。当按下“返回”按钮时，视图切换回 UITableView，但出现了问题。加载视图后，UITabBar 不见了！既然已经消失了，就不可能再回到另一个视图了。

我试过了：

```
self.hidesBottomBarWhenPushed = NO; 
```

代码：

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
{
    [tableView deselectRowAtIndexPath:indexPath animated:YES];
    UITableViewCell *cellSelected = [tableView cellForRowAtIndexPath:indexPath];
    NSString *cellTitle = cellSelected.textLabel.text;

    if (cellTitle == @"Sunrise")
    { //Swap views
        informationView *iv = [[informationView alloc] initWithNibName:nil bundle:nil];
        [self presentModalViewController:iv animated:YES]; 
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T09:16:09.973

当然标签栏不显示。您正在模态地呈现第二个视图。如果你想保留这个实现，你将不得不在第二个视图上添加一个按钮或其他东西来执行

```
[self.navigationController dismissModalViewControllerAnimated:YES];  //Programatically dismiss the view controller 
```

如果你想保留 tabBar 和导航栏的功能，你应该使用

```
[self.navigationController pushViewController:iv animated:YES]; 
```

代替

```
[self presentModalViewController:iv animated:YES]; 
```

# jakarta-ee - Glassfish 自定义资源的 JNDI 查找失败

> ID：12277360
> 
> 赞同：3
> 
> 时间：2012-09-05T08:28:42.183
> 
> 标签：jakarta-ee, glassfish, jndi

我是 Java EE 6 和 JNDI 的新手，所以如果我的问题看起来微不足道，请原谅我

我通过管理控制台向 Glassfish 3.1.2 JNDI 资源添加了一个自定义资源：

CommonTasks->资源->JNDI->自定义资源

*   JNDI 名称：someNumber
*   资源类型：java.lang.Integer
*   工厂类：org.glassfish.resources.custom.factory.PrimitivesAndStringFactory
*   附加属性：[名称：数字；值：6]

现在我希望在我作为 ear 部署到 glassfish 服务器的 Java EE 应用程序中查找此资源。我试过这个没有运气：

```
 InitialContext ctx = new InitialContext();     
    Object o =  ctx.lookup("someNumber"); 
```

我不断收到**NameNotFoundException**。你能告诉我我做错了什么吗？我知道您可以使用提供者 URL 将环境哈希表传递给初始上下文构造函数 - 这是问题所在吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T07:08:18.740

这样的菜鸟错误。

原来 NameNotFoundException 实际上是由我的整数 jndi 资源没有值引起的，我愚蠢地认为附加属性是自定义的，就像在 JMS 消息中一样，我可以在获取对象后查找它们。“附加属性”是我必须输入“值”属性。进行此更改后，一切正常

# ajax - extjs 4 动态无线电组与 sencha 架构师中的 xtype

> ID：12277366
> 
> 赞同：0
> 
> 时间：2012-09-05T08:29:08.067
> 
> 标签：ajax, extjs, extjs4, sencha-architect

如何在 sencha 架构师（或架构师外部）中创建组件，具有自定义 xtype（用户别名）的组件，并且可以放置在架构师的表单面板中。

该方法是使用给定的 xtype 创建包含表单面板时，然后组件进行 ajax 查询，返回单选按钮名称和配置，并且组件在表单面板上显示正确的按钮/名称。

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T12:16:50.380

首先，当您 Ext.define() 扩展一个类时，您可以使用以下格式指定一个全小写的“别名”：

```
alias: 'widget.myxtype' 
```

您能否提供有关您需要加载到表单中的内容的更多详细信息。

听起来您正在寻找定义一个单选按钮组并动态加载项目？

如果是这样，您可以只加载表单并加载一个假表单项（一组“单选按钮配置”）。然后，您将使用 .add() 作为子项扩展单选按钮组类插入项，就像任何其他类一样

# authentication - 网页脚本认证

> ID：12277375
> 
> 赞同：1
> 
> 时间：2012-09-05T08:29:45.590
> 
> 标签：authentication, share, alfresco

在露天执行webscript，我们可以定义webscript是否认证。[高级描述选项](https://wiki.alfresco.com/wiki/Web_Scripts#Authenticating)

但我想知道**“是否可以以管理员或某个组的成员身份执行单个 webscript 仅修改身份验证属性？”**

我想为**某个组的成员编写新程序，而不是 admin 组的成员，可以创建新用户、上传用户和删除现有用户**。所有执行这些任务的 webscripts[ *user-csv-upload.post、person.delete、people.post* ] 都需要**管理员**身份验证。如果我将这些 webscript 的身份验证更改为用户并以管理员身份运行这些 webscript，例如`<authentication runas="admin">user</authentication>`. 所有普通用户都可以创建新用户。**所以我想检查这些 webscript 是否只能调用一个条件**。

如果我不能检查，我必须做两种方式。

1.  我必须为两个不同的 webscripts 编写相同的逻辑，一个用于管理员，一个用于某个组的成员
2.  [使用sudo 之类的工具](http://fabiostrozzi.eu/2009/11/23/sudo-like-tool-for-alfresco-webscripts/)在控制器文件中编写身份验证检查，当前用户是管理员或某个组的成员。

我想听听你的任何建议。任何帮助是极大的赞赏。

**解决方案：**

[我在sudo-like-tool-for-alfresco-security-aspects](http://fabiostrozzi.eu/2010/01/16/sudo-like-tool-for-alfresco-security-aspects/)中找到了满足我需求的确切代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T09:12:18.403

就像 Will Abson 在另一个问题帖子中所说的那样，最优雅的解决方案是使用这个：[Sudo Tool for Alfresco WebScripts](http://fabiostrozzi.eu/2009/11/23/sudo-like-tool-for-alfresco-webscripts/)。使用此工具，您可以临时授予您的用户（如果此用户是某个自定义组的一部分）管理员权限。如果不是，它将作为具有自己权限的普通用户。不过，它需要一些 Java 编码。

否则，解决方案 1 是我们为客户实现的。我们开发了一个自定义 web 脚本，其自定义 url 只有其经理用户知道，它可以运行带有“runas=admin”选项的脚本，并制作他们想要的东西。在这种情况下，您可以做的是：公开一个指向“用户管理 webscript”的链接，**只有**当管理员用户登录时，否则该链接不会出现，并且您尊重某种“安全性”。它不是很优雅，但可以解决问题。

# javascript - CSS3 过渡不能重复

> ID：12277380
> 
> 赞同：1
> 
> 时间：2012-09-05T08:30:05.447
> 
> 标签：javascript, html, css, css-transitions

过渡效果仅在加载时运行一次，但在单击另一个选项卡时不起作用。每次更改选项卡时如何使其运行？

单击导航按钮时，内容应与过渡效果一起显示。HTML：

```
<body onload="setCurrent('home','home_content')">
<div id="wrap" class="center">
    <div class="top">
        <header class="left">
            <h1><a href="#">transition</a></h1>
        </header>
    </div>
    <div class="right">
        <nav class="menu">
            <ul>
                <li><a class="" id="home" onclick="setCurrent('home','home_content')">Home</a></li>
                <li><a class="" id="about" onclick="setCurrent('about','about_content')">About</a></li>
            </ul>
        </nav>
    </div>
    <div id="main">
        <div id="place">
            <div id="home_content" class="content">
                <h3>Home</h3>
            </div>
            <div id="about_content" class="content">
                <h3>About</h3>
            </div>
        </div>
    </div>
</div> 
```

CSS：

```
#place .content{
    height: 1px;
    padding: 20px;
    margin: 0;
    overflow: hidden;
    transition:all 2s ease;
    -moz-transition:all 2s ease; /* Firefox 4 */
    -webkit-transition:all 2s ease; /* Safari and Chrome */
    -o-transition:all 2s ease; /* Opera */
    -ms-transition:all 2s ease; /* MS */
}
#place .hide{
    display:none;
}

#place .expand{
    display:block;
    height:500px;
    background-color:#f00;
} 
```

JS：

```
function setCurrent(current,currentContent){
    document.getElementById('home').className = 'none';
    document.getElementById('about').className = 'none';

    document.getElementById('home_content').classList.remove('expand');
    document.getElementById('about_content').classList.remove('expand');

    document.getElementById('home_content').classList.add('hide');
    document.getElementById('about_content').classList.add('hide');

    document.getElementById(current).className='current';
    document.getElementById(currentContent).classList.remove('hide');
    document.getElementById(currentContent).classList.add('expand');
    return;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:55:32.593

您不能在 CSS 过渡之间`display: none;`和`display: block;`使用 CSS 过渡进行过渡。

我不确定你想要达到的效果，但是改变......

```
#place .hide{
    opacity: 0;
} 
```

将帮助您了解正在发生的事情。

如果要`display: none`在转换完成后设置，可以添加一些 javascript：

```
// webkitTransitionEnd: Opera and Chrome
// transitionend: Firefox and IE 10
// otransitionend: Opera  >= 12
// oTransitionEnd: Opera  <  12
// http://www.ianlunn.co.uk/blog/articles/opera-12-otransitionend-bugs-and-workarounds/

$('#place .hide').on('transitionend otransitionend oTransitionEnd webkitTransitionEnd', function(){
  $(this).hide()
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T09:31:32.890

由于您无法正确设置 display: none 的动画效果，因此我建议使用如下解决方案：

[http://jsfiddle.net/VgLEG/5/](http://jsfiddle.net/VgLEG/5/)

如您所见，有一些变化：

没有隐藏的类。您希望默认情况下隐藏所有内容。这样以后的矛盾就会减少。

而不是显示无，我建议

```
#place .content{
    height: 0;
    padding: 0 20px;
    opacity: 0;
}

#place .content.expand{
    height:500px;
    padding: 20px;
    opacity: 1;
    background-color:#f00;
} 
```

这样浏览器就知道要为什么设置动画：它会褪色（不透明度），它会向上/向下滑动（高度），并且还会在填充元素的宽度时为它设置动画。

（使用 jquery 会更容易，也可以在 IE8 和其他不支持 css 动画的旧浏览器中工作。）

# java - 基于骆驼内容的路由器与 XPath 不工作

> ID：12277387
> 
> 赞同：2
> 
> 时间：2012-09-05T08:30:48.067
> 
> 标签：java, xpath, apache-camel, routes, spring-dsl

我正在使用 XPath 在骆驼中实现基于内容的路由器。但是由于某种原因，XPath 表达式不会评估内容，并且总是选择其他路径。这是我在骆驼上下文中定义的路线：

```
<route>
        <from uri="cxf:bean:hioServiceEndPoint"/>
        <process ref="hioProcessor"/>
        <inOnly uri="file:{{path.ws.data}}/incoming/hio?fileName=hio_${date:now:yyyyMMdd_HHmmssSS}.xml"/>
        <choice>
            <when>
                <xpath>//ORDER_TYPE = 'CROSSDOCKING'</xpath>
                <log message="NIELS Incoming CROSS HIO !!!"/>
                <to uri="jms:incomingHioCross"/>
            </when>
            <otherwise>
                <to uri="jms:incomingHio"/>
                <log message="NIELS Incoming HIO"/>
            </otherwise>
        </choice>
        <transform>
            <constant>OK</constant>
        </transform>
</route> 
```

这是需要搜索标签的 XML `ORDER_TYPE`：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<INBOUND_ORDER xmlns="urn:ifsworld-com:schemas:handle_inbound_order">
    <DELIVERY_LEADTIME>0.0</DELIVERY_LEADTIME>
    <DELNOTE_DATE>2010-12-15T00:00:00</DELNOTE_DATE>
    <DELNOTE_NO>1454</DELNOTE_NO>
    <DESPATCH_DATE>2010-12-15T16:39:43</DESPATCH_DATE>
    <ORDER_DATE>2010-12-15T16:39:43</ORDER_DATE>
    <ORDER_NO>1454</ORDER_NO>
    <ORDER_TYPE>CROSSDOCKING</ORDER_TYPE>
    <REMARKS xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
    <SITE>DC2</SITE>
    <VENDOR_NO>ALM</VENDOR_NO>
    <INBOUND_ORDER_LINES>
        <INBOUND_ORDER_LINE>
            <CURRENCY_CODE>EUR</CURRENCY_CODE>
            <PART_NO>1276.1</PART_NO>
            <QUANTITY>2.0</QUANTITY>
            <QUANTITY_UNIT_MEAS>PCS</QUANTITY_UNIT_MEAS>
            <REMARKS xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <SEQUENCE_NO>1.0</SEQUENCE_NO>
            <UNIT_PRICE>0.0</UNIT_PRICE>
        </INBOUND_ORDER_LINE>
    </INBOUND_ORDER_LINES>
</INBOUND_ORDER> 
```

我看不出我做错了什么，我也尝试过`/INBOUND_ORDER/ORDER_TYPE = 'CROSSDOCKING'`，但即便如此，我似乎也可以让它工作。我编写了一个测试用例来查看我的 XPath 表达式是否正确，并且工作正常并返回 true。

我正在使用骆驼 2.5.0。

因此，如果有人有小费，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:33:43.717

我对你的命名空间有点困惑`xmlns="urn:ifsworld-com:schemas:handle_inbound_order"`。它是一个有效的命名空间吗？

无论如何，我认为这应该有效：

```
//*[local-name() = 'ORDER_TYPE'][codepoint-equal(text(), 'CROSSDOCKING')] 
```

# python - Python过滤和保存

> ID：12277388
> 
> 赞同：1
> 
> 时间：2012-09-05T08:30:56.583
> 
> 标签：python, linux

在服务器中包含一个大的日志文件。我想实现最近5天的日志数据。这是日志文件的一部分

```
 Sat Jun  2 03:32:13 2012 [pid 12461] CONNECT: Client "66.249.68.236"
    Sat Jun  2 03:32:13 2012 [pid 12460] [ftp] OK LOGIN: Client "66.249.68.236", anon     password "gxxglxxxxt@google.com"
    Sat Jun  2 03:32:14 2012 [pid 12462] [ftp] OK DOWNLOAD: Client "66.249.68.236",   "/pub/10.5524/100001_101000/100022/readme.txt", 451 bytes, 1.39Kbyte/sec
    Sat Jun  2 03:32:22 2012 [pid 12677] CONNECT: Client "66.249.68.236"
    Sat Jun  2 03:32:23 2012 [pid 12676] [ftp] OK LOGIN: Client "66.249.68.236", anon password "xxxxxbot@google.com" 
```

我使用该代码，但在打开（文件名）中有一些语法错误。命令是 python ex.py vsftp.log 有人可以帮我解决它。并创建一个新的日志文件来保存输出行。谢谢

```
from sys import argv 
import time
script, filename = argv
with open(filename) as f:
    lines= [line for line in f]
def OnlyRecent(line):
    return time.strptime(line.split("[")[0].strip(),"%a %b %d %H:%M:%S %Y")   <(time.time()-(60*60*24*5))
print "\n".join(filter(OnlyRecent,lines)) 
```

但是当我使用代码时，它可以工作吗？为什么从 sys 导入 argv

```
 script, filename = argv

  txt = open(filename)

  print "Here's your file %r:" % filename
  print txt.read() 
```

当我创建 ex.py 文件时

```
 f =open('/opt/CLiMB/Storage1/log/vsftp.log','r')
  print f.readline 
```

键入 python ex.py

它在 0x 处显示文件对象的内置方法 readline ... 如何解决它。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:41:50.353

格式日期字符串错误，应该是

```
"%a %b %d %H:%M:%S %Y" 
```

您可以`man strftime`从外壳中查看要放置的内容（在其他来源中！）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T08:44:09.900

您可以检查 h,m 和 s 是否为 strptime 中的大写字母，例如 "%a %b %d %H:%M:%S %Y"：

```
return time.strptime(line.split("[")[0].strip(),"%a %b %d %H:%M:%S %Y")   <(time.time()-(60*60*24*5)) 
```

另请注意，如果日期时间错误，或者日志文件中有一条多行语句会搞砸它，您可能会用 try/except 语句将返回值括起来。

```
def OnlyRecent(line):
    try:
       return time.strptime(line.split("[")[0].strip(),"%a %b %d %H:%M:%S %Y")   <(time.time()-(60*60*24*5))
    except:
       return False 
```

对于 Python 2.4.3，我认为您正在使用的文件读取语法不起作用。尝试类似：

```
f = open('file.txt', 'r')
lines = f.readlines()
f.close() 
```

更多关于 2.4.3 的文档在这里：[http ://docs.python.org/release/2.4.3/tut/node9.html#SECTION009200000000000000000](http://docs.python.org/release/2.4.3/tut/node9.html#SECTION009200000000000000000)

# c# - 我的单元测试是不是太在乎了

> ID：12277390
> 
> 赞同：7
> 
> 时间：2012-09-05T08:31:05.413
> 
> 标签：c#, asp.net-mvc, unit-testing

我对我的单元测试方法有两个担忧：

1.  我是否在一种测试方法中测试太多？
2.  我的测试方法名称如何反映所有测试期望？

当我的方法名称说： 时，我问自己`ReturnInvalidModelState`，然后我的另外 2 个`Asserts`不正确。至少关于方法名称......

```
[Test]
public void Create_TemplateAlreadyExists_ReturnInvalidModelState()
{
    // ARRANGE
    TemplateViewModel templateViewModel = new TemplateViewModel { 
        Name = "MyTest" 
    };

    Mock<ITemplateDataProvider> mock1 = new Mock<ITemplateDataProvider>();
    Mock<IMappingEngine> mock2 = new Mock<IMappingEngine>();

    TemplateController controller = 
        new TemplateController(mock1.Object, mock2.Object);
    mock1.Setup(m => m.TemplateExists("MyTest")).Returns(true);
    // Set ModelState.IsValid to false
    controller.ModelState.AddModelError("Name", 
                                        "This name already exists.");

    // ACT
    ActionResult result = controller.Create(templateViewModel);

    // ASSERT
    Assert.IsFalse(controller.ModelState.IsValid);
    Assert.IsInstanceOfType(typeof(PartialViewResult), result);
    Assert.AreEqual(templateViewModel, ((PartialViewResult)result).Model);
}

[HttpPost]
public ActionResult Create(TemplateViewModel templateViewModel)
{
    if (ModelState.IsValid
        && !_templateDataProvider.TemplateExists(templateViewModel.Name))
    {

        Template template = 
            Mapper.Map<TemplateViewModel, Template>(templateViewModel);

        _templateDataProvider.AddTemplate(template);
        return new JsonNetResult(new { success = true });
    }
    ModelState.AddModelError("Name", "This name already exists.");
    return PartialView(templateViewModel);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T15:14:49.333

是的，我认为您正在测试太多东西。

从重命名您的测试方法开始。您的方法签名应描述操作、场景和预期结果。

如果我要重命名您的方法，我将得到以下结果：

```
public void Create_DuplicateTemplate_ModelStateIsInvalidAndReturnsPartialViewResultAndPartialViewResultOfTypeTemplateViewModel() 
{ 
} 
```

你的测试关注三件事，而不是一件事。当它失败时，你不会马上知道它失败的原因。

考虑将其重新分解为较小的测试并封装一些排列逻辑，以便可以重复使用。

**编辑：**

关于具有单个断言的单个测试方法，您在评论中提出了一个很好的观点。我同意你的观点，尽管听起来不错，但通常还不够。

假设我有以下操作方法：

```
[HttpPost]
public ActionResult Register(NewUserViewModel newUser)
{
    if (!ModelState.IsValid)
        return View(newUser);

    var newUserDTO = Mapper.Map<NewUserViewModel, NewUserDTO>(newUser);
    var userDTO = UserManagementService.RegisterUser(newUserDTO);

    var result = Mapper.Map<UserDTO, UserViewModel>(userDTO);

    TempData.Add("RegisteredUser", result);
    return RedirectToAction("RegisterSuccess");
} 
```

我对此方法进行了以下单元测试：

```
 [TestMethod]
        public void Register_HttpPost_ValidViewModel_ReturnsRegisterSuccess()
        {
            // Arrange
            var autoMapperMock = this.mockRepository.DynamicMock<IMapper>();
            var userManagementServiceMock = this.mockRepository.DynamicMock<IUserManagementService>();

            var invalidRegistrationViewModel = new NewUserViewModel
            {
                LastName = "Lastname",
                FirstName = "Firstname",
                Username = null
            };

            autoMapperMock.Expect(a => a.Map<UserDTO, UserViewModel>(Arg<UserDTO>.Is.Anything)).Repeat.Once().Return(null);
            autoMapperMock.Expect(a => a.Map<NewUserViewModel, NewUserDTO>(Arg<NewUserViewModel>.Is.Anything)).Repeat.Once().Return(null);
            userManagementServiceMock.Expect(s => s.RegisterUser(Arg<NewUserDTO>.Is.Anything)).Repeat.Once();

            autoMapperMock.Replay();

            var controller = new AccountController
            {
                Mapper = autoMapperMock,
                UserManagementService = userManagementServiceMock
            };

            this.mockRepository.ReplayAll();

            // Act
            var result = (RedirectToRouteResult)controller.Register(invalidRegistrationViewModel);

            // Assert
            Assert.IsTrue((string)result.RouteValues["Action"] == "RegisterSuccess");
        } 
```

正如你所看到的，我对我的模拟设置了多个期望：

*   我希望 AutoMapper 被调用两次
*   我希望 UserManagementService 被调用一次

在测试结束时，我有一个断言来检查用户是否被重定向到正确的路线。

那么我在哪里检查我的断言呢？我创建了另一种方法来确保满足我的期望：

```
 [TestCleanup]
    public void Cleanup()
    {
        try
        {
            this.mockRepository.VerifyAll();
        }
        finally
        {                
        }
} 
```

所以你是对的，我有三个断言而不是一个，但是我以这样一种方式构造我的代码，所以看起来我只有一个断言。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T13:23:32.210

我建议将所有“排列”和“执行”代码移动到一个`Setup()`方法中，并将其余部分分成三个测试。这将使每个单独的测试更容易阅读，并让您给每个测试一个更好地对应于它包含的实际断言的名称。

```
private TemplateViewModel _templateViewModel;
private ITemplateDataProvider _mock2;
private IMappingEngine _mock2;
private TemplateController _controller;
private ActionResult _result;

[Setup]
public void Setup(){
    // ARRANGE
    _templateViewModel = new TemplateViewModel { Name = "MyTest" };

    _mock1 = new Mock<ITemplateDataProvider>();
    _mock2 = new Mock<IMappingEngine>();

    _controller = new TemplateController(_mock1.Object, _mock2.Object);
    _mock1.Setup(m => m.TemplateExists("MyTest")).Returns(true);

    // Set ModelState.IsValid to false
    _controller.ModelState.AddModelError("Name", 
                                        "This name already exists.");

    _result = controller.Create(_templateViewModel);
}

[Test]
public void Create_TemplateAlreadyExists_ModelStateIsInvalid()
{
    Assert.IsFalse(_controller.ModelState.IsValid);
}

[Test]
public void Create_TemplateAlreadyExists_ResultIsPartialViewResult()
{
    Assert.IsInstanceOfType(typeof(PartialViewResult), _result);
}

[Test]
public void Create_TemplateAlreadyExists_ResultModelMatchesTemplateModel()
{
    Assert.AreEqual(_templateViewModel, ((PartialViewResult)_result).Model);
} 
```

# java - Android 保存的图像质量低下

> ID：12277401
> 
> 赞同：1
> 
> 时间：2012-09-05T08:31:39.200
> 
> 标签：java, android, android-camera

我正在通过以下代码拍照并保存到 SD 卡，但它产生的图片质量如此之低，即使质量为 100% 也非常少。也许 bitmap.compress 不是正确的方法（或位图？！）

这是我的代码：

```
public class TakePhoto extends Activity {

    ImageView iv;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_take_photo);

        iv = (ImageView) findViewById(R.id.imageView1);

        Button b = (Button) findViewById(R.id.button1);
        b.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {

                Intent intent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
                startActivityForResult(intent, 0);

            }
        });
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        // TODO Auto-generated method stub
        super.onActivityResult(requestCode, resultCode, data);

        Bitmap bm = (Bitmap) data.getExtras().get("data");
        Random generator = new Random();
        String randFileName = String.valueOf (generator.nextInt(965) + 32);
        String both = "/mnt/extSdCard/DirectEnquiries/"+ randFileName + ".jpg";
        File imageFile = new File(both);

        writeBitmapToMemory(imageFile, bm);
        iv.setImageBitmap(bm);

    }

    public void writeBitmapToMemory(File file, Bitmap bitmap) {
        FileOutputStream fos;

        try {
            Log.e("Tom", "Starting take stream");
            fos = new FileOutputStream(file);
            Log.e("Tom", "Got stream");
            bitmap.compress(Bitmap.CompressFormat.JPEG, 100, fos);
            Log.e("Tom", "Saved Image");
            fos.close();

        } 
        catch (FileNotFoundException e) {
            e.printStackTrace();

        } 
        catch (IOException e) {
            e.printStackTrace();

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:35:35.083

请调用以下函数从相机捕获图像。

```
 private final static String FOLDER_NAME = "YourAppName/Image/";
 private Uri selectedImageUri = null;

public void startCamera() 
    {
        File photo = null;
        Intent intent = new Intent("android.media.action.IMAGE_CAPTURE");
        String timeStamp = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date());
        if (android.os.Environment.getExternalStorageState().equals(android.os.Environment.MEDIA_MOUNTED)) 
        {
            photo = new File(android.os.Environment.getExternalStorageDirectory(), FOLDER_NAME+File.separator+timeStamp+".png");
        } 
        else 
        {
            photo = new File(getCacheDir(), FOLDER_NAME+File.separator+timeStamp+".png");
        }    
        if (photo != null) 
        {
            intent.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(photo));
            selectedImageUri = Uri.fromFile(photo);
            startActivityForResult(intent, CAPTURE_IMAGE_CALLBACK);
        }
    } 
```

您可以在 selectedImageUri 变量中获取图像 Uri。（图像存储在 SD 卡中）

```
 protected void onActivityResult(int requestCode, int resultCode, Intent data) 
    {
        switch (requestCode) 
        {
            case CAPTURE_IMAGE_CALLBACK:

                break;
          }
     } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:40:04.780

您是否尝试过在意图中设置质量？

```
Intent intent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
intent.putExtra(MediaStore.EXTRA_VIDEO_QUALITY, 1);                
startActivityForResult(intent, 0); 
```

# c++ - 默认参数和变量列表

> ID：12277407
> 
> 赞同：1
> 
> 时间：2012-09-05T08:32:08.263
> 
> 标签：c++, list, templates, variables

我在玩可变参数列表。请参考下面的代码片段。在这里，我试图在 Foobar 中打印用户定义类型的内容。

```
template<typename T>
void Foobar(const T& obj,int nNumberofParams,...)
{  
  va_list args;  
  va_start(args,nNumberofParams);
  for(int i =0 ; i < nNumberofParams; i++)
  {  
    T val = va_arg(args,T);
    val.PrintContent();
  }
  va_end(args);
}  
//! Template Specialization for int
template<>
void Foobar(const int& ,int nNumberofParams,...)
{
va_list args;
va_start(args,nNumberofParams);
cout << "Foobar specialize for int called" << endl;
for(int i =0 ; i < nNumberofParams; i++)
{
    int val = va_arg(args,int);
    cout << val << endl;
}
va_end(args); 
```

}

主要我正在做这样的事情

```
int _tmain(int argc, _TCHAR* argv[])
{
    //! MyClass implements PrintContent
    MyClass obj,obj1(1,2,0),obj2(3,4,1),obj3,obj4(5,5,2),obj5(6,6,3);
    Foobar(obj,5,obj1,obj2,obj3,obj4,obj5);// Works fine

    //! Can't this be simpler ?
    int i = 3;
    int &j = i;
    Foobar(j,3,1,2,3);// Template specialization for int

    //! Can't this be simpler ?
    double d = 3.0;
    double& d1 = d;
    Foobar(d1,3, 1.0,2.0,3.0);// Template specialization for double

return 0; 
```

}

是否可以在带有变量 list 的函数中使用默认参数？是的，那该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T08:39:09.370

在 C++11 中，您可以使用可变参数模板。

在 C++03 中，为什么不创建一个正确类型的普通第一个参数，并从第二个参数开始有一个可变参数列表，而不是引入一个“虚拟”参数？或者调用模板的专业化之类的`Foobar<int>`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:50:16.787

在 C++11 中是可能的：http: [//ideone.com/9CGz4](http://ideone.com/9CGz4)

```
void Foobar() {}

template<typename First, typename... Rest>
void Foobar(const First &val, Rest... args)
{  
    val.PrintContent();
    Foobar(args...);
}

template<typename... Rest>
void Foobar(const int val, Rest... args)
{  
    std::cout << val << std::endl;
    Foobar(args...);
} 
```

从 C++03 开始​​：http: [//ideone.com/36lA5](http://ideone.com/36lA5)

```
template<typename T> 
void Print(T val) {
  cout << val << endl;
}

struct MyStruct {
  MyStruct(int a) : b(a) {}
  void print() { cout << "MS: " << b << endl; }
  int b;
};

void Print(MyStruct &val) {
 val.print();
}

template<typename T>
void Foobar(int nNumberofParams, ...) {
  va_list args;  
  va_start(args,nNumberofParams);
  for(int i =0 ; i < nNumberofParams; i++)
  {  
    T val = va_arg(args,T);
    Print(val);
  }
  va_end(args);
} 
```

然后只专注`Print`于满足您的需求。

`Foobar<MyStruct>(2, MyStruct(1), MyStruct(2));`

甚至

`Foobar<MyStruct>(2, 1, 2);`

这有点简单。

# jquery - 在回调之前去除 html 标签

> ID：12277408
> 
> 赞同：0
> 
> 时间：2012-09-05T08:32:09.950
> 
> 标签：jquery, asp.net-mvc-3

我用来`AjaxHelper.BeginForm`在我的视图中创建 ajax 表单。视图有一个`textarea`提供内容。如何在提交表单之前从此文本区域中删除 html 标签。我的意思是说：

*   用户点击“按钮”
*   标签被剥离
*   进行回调。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:35:30.463

您可以使用正则表达式从字符串中删除 HTML 标记，但请注意它不是 100% 可靠的。

```
$("button").click(function() {
    var text = $("#someElement").val().replace(/(<([^>]+)>)/ig, "");

    // make callback with above variable...
}); 
```

# c# - 当 SQL Server 中用户定义的表类型将所有列的默认值设置为 null 时，如何将具有较少列的 DataTable 传递给存储过程

> ID：12277410
> 
> 赞同：5
> 
> 时间：2012-09-05T08:32:12.887
> 
> 标签：c#, sql-server-2008, table-valued-parameters

我有一个存储过程，它接受用户定义的表类型，并且用户定义数据类型中所有列的默认值设置为 null。现在我将一个包含较少列的数据表从 c# 代码传递给存储过程，期望剩余列的值将设置为空。

但我收到此错误：尝试传递具有 21 列的表值参数，其中相应的用户定义表类型需要 77 列。这是代码

```
 SqlConnection conn = new SqlConnection("server=****; database=***;integrated security=SSPI");
  DataSet dataset=new DataSet();
  conn.Open();
  SqlCommand cmd = new SqlCommand("Insert");      
  cmd.CommandType = CommandType.StoredProcedure;
  cmd.Connection = conn;
  SqlParameter para = new SqlParameter();
  para.ParameterName = "@TableVar";
  para.SqlDbType = SqlDbType.Structured;
  //SqlParameter para=cmd.Parameters.AddWithValue("@TableVar",table);
  para.Value = table;
  cmd.Parameters.Add(para);
  cmd.ExecuteNonQuery(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-06-11T01:41:55.023

您可以使用 SqlDataAdapter 创建与表类型架构匹配的 DataTable：

```
DataTable table = new DataTable();

// Declare a variable of the desired table type to produce a result set with it's schema.
SqlDataAdapter adapter = new SqlDataAdapter("DECLARE @tableType dbo.UserDefindTableType 
                                             SELECT * FROM @tableType", ConnectionString);

// Sets the DataTable schema to match dbo.UserDefindTableType .
adapter.FillSchema(table, SchemaType.Source); 
```

然后，您可以使用所有默认列值创建 DataRows 并设置您知道的列：

```
DataRow row = table.NewRow();

// Set know columns...
row["ColumnName"] = new object();

// or check column exists, is expected type etc first
if (table.Columns.Contains("ColumnName") 
    && table.Columns["ColumnName"].DataType == typeof(string)) {
    row["ColumnName"] = "String";
}

table.Rows.Add(row); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-11T00:37:20.800

我遇到了同样的问题，我正在研究的解决方案是运行额外的 SQL 查询来获取列定义，然后用缺失的列填充 DataTable，这是表上列定义的 SQL 语句类型：

```
select c.name, t.name as type, c.max_length as length from sys.table_types tt
inner join sys.columns c on c.object_id = tt.type_table_object_id
inner join sys.types t on t.system_type_id = c.system_type_id
where tt.name = @tabletypename
order by c.column_id 
```

`SqlDbType`如果您希望解决方案适用于所有表值参数定义，则C# 代码将更加混乱，因为您必须将返回类型（即 VARCHAR、INT 等）解析为枚举。

如果您没有本地文件系统的写入权限，我会认为 Microsoft 在 SQL Server 引擎中可以更好地解决此类问题，作为导入 CSV 文件的下一个最佳方法，但我想要一个单一的 UDTT 来满足每次我处理新的文件格式时，所有 CSV 文件都不必创建新的表类型。反正..吐槽。

# javascript - 如何从 ExtJs 4 中的按钮处理程序访问 numberfield 值？

> ID：12277413
> 
> 赞同：1
> 
> 时间：2012-09-05T08:32:23.353
> 
> 标签：javascript, dom, extjs, extjs4, extjs4.1

我有一个包含以下项目的面板：

```
{
    xtype: 'numberfield',
    id: 'articleFastSearch',
    listeners: {
        scope: this,
        specialkey: function(field, e) {                            
            if (e.getKey() == Ext.EventObject.ENTER) {
                var val = this.rawValue;
                // Do stuff with val
            }
        }
    }
},
{
    id: 'articleFastSearchBtn',
    text: 'Open article',
    scope: this,
    handler: function(btn) {
        console.log(Ext.get("articleFastSearch"));
        var val = Ext.get("articleFastSearch").getValue();
        console.log(val);
        // Do stuff with val
    }
} 
```

numberfield 上的侦听器工作正常，但我无法从按钮处理程序访问 numberfield 值。我尝试命名数字字段并使用`this.articleFastSearch.getValue()`，但它没有用。我认为范围可能是错误的？

然后我求助于给 numberfield 一个 id 并尝试通过 dom 访问它，如上所示。这给出了一个奇怪的结果，因为返回的构造函数实际上包含一个`HTMLTableElement`而不是一个数字字段。我在属性中找不到值，所以我很困惑......页面上没有其他具有相同 ID 的元素。有任何想法吗？

理想情况下，如果可能的话，我宁愿只通过`this`变量访问值，但我会满足于任何可行的解决方案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:37:53.953

[Ext.get()](http://docs.sencha.com/ext-js/4-1/#!/api/Ext-method-get)返回一个[Ext.Element](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.dom.Element)。您正在寻找的是[Ext.getCmp()](http://docs.sencha.com/ext-js/4-1/#!/api/Ext-method-getCmp)您还应该考虑使用新的[Ext.ComponentQuery](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.ComponentQuery)，它也可用作从[Ext.container.AbstractContainer](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.container.AbstractContainer-method-down)继承的所有类中的快捷方式。

# asp.net - 保存文件时出现 System.UnauthorizedAccessException

> ID：12277420
> 
> 赞同：0
> 
> 时间：2012-09-05T08:32:55.817
> 
> 标签：asp.net, iis-6

我在 IIS6 上发布了我的网站。

通过 File.WriteAllText("C:\" + txtSaveExport.Text + ".CSV", b.ToString()); 保存文件时。它给出了一个错误：

> em.UnauthorizedAccessException：对路径“C:\hj.CSV”的访问被拒绝。ASP.NET 无权访问请求的资源。考虑向 ASP.NET 请求标识授予对资源的访问权限。ASP.NET 有一个基本进程标识（通常是 IIS 5 上的 {MACHINE}\ASPNET 或 IIS 6 和 IIS 7 上的网络服务，以及 IIS 7.5 上配置的应用程序池标识），如果应用程序不是模拟的，则使用该标识。如果应用程序通过 模拟，则身份将是匿名用户（通常是 IUSR_MACHINENAME）或经过身份验证的请求用户。
> 
> 要授予 ASP.NET 对文件的访问权限，请在资源管理器中右键单击该文件，选择“属性”并选择“安全”选项卡。单击“添加”以添加相应的用户或组。突出显示 ASP.NET 帐户，然后选中所需访问权限的框。``

如何处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:38:46.997

您需要向该文件夹中的 Aspnet 用户授予写入权限。

看到这个： [http ://devnet.logixml.com/rdPage.aspx?rdReport=Article&dnDocID=209](http://devnet.logixml.com/rdPage.aspx?rdReport=Article&dnDocID=209)

此致。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:42:19.537

写入 C: 驱动器下的变量目录不是一个好主意。我建议您不要授予在 C 下写入的权限，而是写入您的 Web 应用程序目录下的目录，您可以通过`Server.MapPath("~")`. 确保将应用程序池的用户帐户的写入权限授予应用程序目录下的任何文件夹，这样会更安全。

# objective-c - ContentOffset 并返回顶部问题

> ID：12277423
> 
> 赞同：1
> 
> 时间：2012-09-05T08:33:15.180
> 
> 标签：objective-c, ios, uiscrollview

我有一个带有分页的滚动视图。我声明：

```
 if(_fullPosterScroll == nil) _fullPosterScroll = [[UIScrollView alloc] initWithFrame:rc];
    [_fullPosterScroll setDelegate:self];
    [_fullPosterScroll setBackgroundColor:[UIColor blackColor]];
    [_fullPosterScroll setCanCancelContentTouches:NO];
    _fullPosterScroll.indicatorStyle = UIScrollViewIndicatorStyleWhite;
    _fullPosterScroll.clipsToBounds = NO;
    _fullPosterScroll.pagingEnabled = YES;
    _fullPosterScroll.alwaysBounceHorizontal = NO;
    _fullPosterScroll.directionalLockEnabled = YES; 
```

点击后我调用了一个方法：

```
[_fullPosterScroll setContentOffset:CGPointMake(_selectedPosterPosition*(_fullPosterScroll.frame.size.width), 0) animated:YES];
NSLog(@"%f",_fullPosterScroll.contentOffset.y); 
```

为什么在那之后在日志中我有例如 225.00 ？！这应该是0！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:55:39.897

我看不出您发布的代码有什么问题，但是您应该检查以确保它`setContentOffset`没有触发任何正在更改偏移量的委托方法。

此外，Apple 有一个示例项目[PageControl](http://developer.apple.com/library/ios/#samplecode/PageControl/Introduction/Intro.html)，它完全符合您的要求，因此如果您想要一个完整的示例，您应该查看它。

# garbage-collection - 如何最小化 Go 中的垃圾收集？

> ID：12277426
> 
> 赞同：25
> 
> 时间：2012-09-05T08:33:19.510
> 
> 标签：garbage-collection, go

有时您可能希望避免/最小化垃圾收集器，所以我想确定如何去做。

我认为下一个是正确的：

*   在函数的开头声明变量。
*   使用数组而不是切片。

还有吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-09-05T21:38:10.047

要最小化 Go 中的垃圾收集，您必须最小化堆分配。要最小化堆分配，您必须了解分配发生的时间。

以下事情*总是*会导致分配（至少在 Go 1 的 gc 编译器中）：

*   使用`new`内置函数
*   使用`make`内置函数（除了一些不太可能的极端情况）
*   当值类型是切片、映射或带有`&`运算符的结构时的复合文字
*   将大于机器字的值放入接口。（例如，字符串、切片和某些结构比机器字大。）
*   `string`在, `[]byte`, 和之间转换`[]rune`
    *   `m[string(b)]`从 Go 1.3 开始，编译器在特殊情况下`m`不分配此表达式`b`：`[]byte`
*   将非常量整数值转换为`string`
*   `defer`陈述
*   `go`陈述
*   捕获局部变量的函数字面量

以下情况*可能*会导致分配，具体取决于详细信息：

*   获取变量的地址。请注意，可以隐式获取地址。例如，可能会获取if is not a pointer`a.b()`的地址，并且该方法具有指针接收器类型。`a``a``b`
*   使用`append`内置函数
*   调用可变参数函数或方法
*   切片数组
*   向地图添加元素

该列表旨在完整，我对此充满信心，但很高兴考虑添加或更正。

如果您不确定分配发生在哪里，您始终可以按照其他人的建议进行概要分析，或者查看编译器生成的程序集。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-09-05T19:18:07.423

避免垃圾是相对简单的。您需要了解分配的位置，看看是否可以避免分配。

首先，在函数开头声明变量不会有帮助。编译器不知道区别。但是，人类会知道其中的区别，并且会惹恼他们。

使用数组而不是切片将起作用，但那是因为数组（除非取消引用）被放入堆栈。数组还有其他问题，例如它们在函数之间按值传递（复制）。堆栈上的任何东西都“不是垃圾”，因为它会在函数返回时被释放。任何可能逃脱函数的指针或切片都放在垃圾收集器必须在某个时候处理的堆上。

你能做的最好的事情就是避免分配。当您处理完不需要的大量数据时，请重新使用它们。这是Go 博客上的[分析教程中使用的方法。](http://blog.golang.org/2011/06/profiling-go-programs.html)我建议阅读它。

除了分析教程中的示例之外的另一个示例：假设您有一个`[]int`名为`xs`. 你不断地追加到，`[]int`直到你达到一个条件，然后你重置它，这样你就可以重新开始。如果你这样做`xs = nil`，你现在将切片的底层数组声明为要收集的垃圾。然后，Append 将在您下次使用时重新分配 xs。相反，如果您这样做`xs = xs[:0]`，您仍在重置它但保留旧数组。

在大多数情况下，试图避免产生垃圾是过早的优化。对于您的大多数代码来说，这并不重要。但是你可能偶尔会发现一个函数被调用很多次，每次运行时都会分配很多。或者你重新分配而不是重用的循环。我会等到你看到瓶颈后再过火。

# jruby - JRuby 构建工具

> ID：12277427
> 
> 赞同：1
> 
> 时间：2012-09-05T08:33:23.363
> 
> 标签：jruby, build-automation

我正在为 JRuby 项目寻找一些构建自动化工具。这个项目的结果应该是一些可以做东西的库。我需要使用一些 Java 库，但我想使用 Ruby。这就是 JRuby 的原因。

在这个阶段，我正在寻找可以处理依赖项并从远程存储库下载它们的构建自动化工具。

我可以为此使用 Maven，但我对其他可能更有趣的替代方案感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T09:06:32.750

所以是的，如果你正在寻找比 Mave 更性感的东西，SBT 是不错的选择。其他选项包括：

Gradle - [http://www.gradle.org/](http://www.gradle.org/) - 如果你想要 Groovy 而不是 scala 方向。

或者 Gant - [http://gant.codehaus.org/](http://gant.codehaus.org/) - 了解更多关于 Ant 的内容。

Buildr - [http://buildr.apache.org/](http://buildr.apache.org/) - 是另一个有趣的项目

我也遇到了这个死项目 - [http://raven.rubyforge.org/](http://raven.rubyforge.org/) - 但我想知道是否有新的东西来解决相同的项目，即使用 Rake，ruby 构建工具，也可以构建 java。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T10:04:18.113

仅从依赖管理的角度来看，[jbundler](https://github.com/mkristian/jbundler)是 Maven 和 bundler 之间的桥梁，可以帮助您管理依赖关系，无论它们是 gems 还是 maven artefacts。

# javascript - JavaScript Loop Inside HTML Table Won't work

> ID：12277439
> 
> 赞同：2
> 
> 时间：2012-09-05T08:34:23.363
> 
> 标签：javascript

I have a JavaScript assignment, and part of that assignment is having a two-column table with embedded JavaScript that loops through 50 temperatures in both Celsius and Fahrenheit.

I checked W3's HTML validator and it tells me so far I have 2 errors... The one I can never seem to get rid of is "Element script not allowed as child of element tbody in this context".

And this is my code:

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<style type="text/css">
body { background-image:url('background.png'); text-align:center; font-family:verdana; color:white; }

ul
{
list-style-type:none;
margin:0;
padding:0;
padding-top:6px;
padding-bottom:6px;
}
li
{
display:inline;
}

a:link,a:visited
{
opacity:0.75;
filter:alpha(opacity=75);
font-weight:bold;
color:#FFFFFF;
background-color:#999999;
text-align:center;
padding:5px;
text-decoration:none;
text-transform:uppercase;
border: 1px solid white;
font-weight:bold;
}

a:hover,a:active
{
opacity:1;
filter:alpha(opacity=100);
background-color:#999999;
border: 1px solid white;
font-weight:bold;
}

h1 { font-size: 25px; }
h2 { font-size: 12px; }
h3 { font-size: 10px; position:fixed; bottom: 5px; left:0%; right:0%; font-weight:normal; }
h4 { font-size: 25px; text-transform:uppercase; }

navigationtext { font-weight:bold; text-transform:uppercase; }

</style>
<head>
<title>Untitled Document</title>
</head>
<body>
<table>
<tr><td>Celsius</td><td>Fahrenheit</td></tr>
<script type="text/javascript" src="temperatures.js"></script>
</table>
</body>
</html> 
```

And here is the external JavaScript file:

```
var celsius = 0;
for (celsius = 0; celsius <= 50; celsius) {
    document.write("<tr><td>"+celsius+"</td><td>"+((celsius*9/5)+32)+"</td</tr>");
    celsius++;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:03:09.413

First off, get that `script` to the bottom of the `body`, right before the `</body>`. Putting it anywhere else will block page loading. Adapt your HTML for proper DOM manipulation by giving IDs to the elements you're going to manipulate:

```
<table>
    <thead>
        <tr><th>Celsius</th><th>Fahrenheit</th></tr>
    </thead>
    <tbody id="temperatureTableTbody"></tbody>
</table>
<script type="text/javascript" src="temperatures.js"></script>
</body> 
```

Also make a closure to don't pollute the global scope with unnecessary variables. I modified your code slightly to use proper DOM manipulation, should work on any browser released in the last decade.

```
(function() { //creates a closure, so vars don't leak in the global scope
    //stores a reference to the tbody DOM element which we will append rows to
    var tbody = document.getElementById('temperatureTableTbody');
    //iterates celsius from 0 to 50
    for (var celsius = 0; celsius <= 50; celsius++) {
        //creates elements
        var tr = document.createElement('tr'),
            tdcelsius = document.createElement('td'),
            tdfahr = document.createElement('td');
        //append textNodes to the td elements
        tdcelsius.appendChild(document.createTextNode(celsius));
        tdfahr.appendChild(document.createTextNode((celsius*9/5)+32));
        //appends the tds to the tr
        tr.appendChild(tdcelsius);
        tr.appendChild(tdfahr);
        //append the finished row to the tbody
        tbody.appendChild(tr);
        //repeat loop while condition is true
    }
}());​ //closes the Immediately Invoked Function Expression 
```

[**Fiddle**](http://jsfiddle.net/rpytJ/)

And please, don't use `document.write`.

Some reference: [Why is document.write considered a 'bad practice'?](https://stackoverflow.com/a/802943/1331430)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:50:54.660

Try like this.

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Untitled Document</title>
</head>
<body>
<table>
<tr>
    <td>Celsius</td>
    <td>Fahrenheit</td>
</tr>
<script type="text/javascript" > //<![CDATA[
    for (var celsius = 0; celsius <= 50; celsius++) {
        document.write("<tr><td>"+ celsius +"</td>");
        document.write("<td>"+ ((celsius*9/5)+32) +"</td></tr>");
}
//]]></script>
</table>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T08:53:06.497

You should call a javascript function when document has been loaded:

```
if (document.readyState === "complete") { loadTemperatures(); } 
```

Your loadTemperatures function will append rows to your table. Have a look here to learn how to do that: [http://viralpatel.net/blogs/dynamically-add-remove-rows-in-html-table-using-javascript/](http://viralpatel.net/blogs/dynamically-add-remove-rows-in-html-table-using-javascript/)

> Element script not allowed as child of element tbody in this context

Put the `<script>` balise between `<head>` and `</head>` to correct that.

Here is a jsFiddle to show you the goal: [http://jsfiddle.net/dfTz6/2/](http://jsfiddle.net/dfTz6/2/)

# ruby-on-rails-3 - Rails 范围内的表单未分配belongs_to

> ID：12277441
> 
> 赞同：0
> 
> 时间：2012-09-05T08:34:30.947
> 
> 标签：ruby-on-rails-3, forms, belongs-to

我在 Rails 3 中有两个模型——一个用户模型和一个配置文件模型。

```
class User < ActiveRecord::Base
  has_one :profile, :dependent => :destroy
end

class Profile < ActiveRecord::Base
  belongs_to :user
end 
```

它们的范围在我的 routes.rb 文件中，如下所示：

```
resources :users do
  resources :profiles
end 
```

所以现在，我创建配置文件的表单如下所示（使用 SimpleForm）：

```
<%= simple_form_for([@user, @profile]) do |f| %>
  <%= f.error_notification %>
    ...(Other Inputs)
<% end %> 
```

但是，用户 ID 似乎并没有像我想象的那样自动发送到配置文件模型。我必须通过控制器手动设置吗？还是我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:05:16.323

您应该首先确保 User 和 Profile 之间的关系确实正常工作。当我认为您的意思是：

```
class User < ActiveRecord::Base
  has_one :profile, :dependent => :destroy
end 
```

为了将用户 ID 与表单一起发送，表单应该位于一个页面上，其 URL 类似于“localhost:3000/users/5/profiles/new”，您可以使用帮助程序“new_user_profile_path(5)”链接到该页面"，对于 ID 为 5 的用户。

当您提交表单时，它将在您的 ProfilesController 中执行创建操作。以下应导致创建配置文件：

```
def create
  @user = User.find(params[:user_id])
  @profile = @user.build_profile(params[:profile])
  @profile.save!
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T09:28:44.630

添加 :method => :post 到您的表单，因为您的 html 请求是 GET 应该是 POST

```
simple_form_for([@user, @profile], :method => :post) do |f| %> 
```

# asp.net-mvc-3 - 如何使标签获得焦点

> ID：12277447
> 
> 赞同：1
> 
> 时间：2012-09-05T08:34:54.830
> 
> 标签：asp.net-mvc-3, jquery-ui

在我的 gridComplete 函数中，根据数据行中的某些值，我想将焦点移动到不同的选项卡。gridCompelete 函数将类似于

```
 var grid = $('#grdResults');
                var m = grid.getDataIDs();
                for (var i = 0; i < m.length; i++) {
                    var rowData = grid.getRowData(m[i]);
                    if (rowData.errorMessage != '') {
                        alert(rowData.errorMessage);
                        $('#UploadMain').focus();
                    }
                } 
```

显然 .focus() 似乎不起作用。下面给出的是包含选项卡代码的视图部分

```
 <div id="editTabs">
           <ul>
        <li><a href="#UploadMain">Main</a></li>
        <li><a href="#DataValidation">Data Validation</a></li>
    </ul>
    <div id="UploadMain">
        <fieldset>
          ....... 
```

我需要什么才能移动焦点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:45:52.800

您在寻找[select()](http://jqueryui.com/demos/tabs/#method-select)方法吗？

```
$("#editTabs").tabs("select", 0);              // Activate first tab. 
```

或者：

```
$("#editTabs").tabs("select", "#UploadMain");  // Activate "UploadMain" tab. 
```

# django - Django 管理员搜索，句子搜索

> ID：12277448
> 
> 赞同：1
> 
> 时间：2012-09-05T08:35:09.293
> 
> 标签：django, search, admin, django-queryset

我在管理员搜索中遇到了一些问题，想知道是否有人对我做错了什么有任何建议/指点？

在管理员 search_fields 我正在做这个 search_fields = ['games_played', 'dxdiag',] 它适用于 games_played 但 dxdiag 是一个 dxdiag，其中检索到某些数据并转换为 JSON 字符串。

我想要做的是能够搜索一个以上的单词，例如“windows xp”（用“表示有一个以上的单词），为此我覆盖了查询集，但它没有工作。当我搜索“windows xp”时，我得到“0 个结果（总共 13 个）”（15 个帖子中有 13 个有 windows xp）并且没有显示任何帖子。我是错误地解决了这个问题还是我只是忘记了某物？

```
class AdminUserData(admin.ModelAdmin):
    search_fields = ['games_played', 'dxdiag',] #Search field at top

def queryset(self, request):
    qs = super(AdminUserData, self).queryset(request)

    if request.GET:
        query = request.GET.get('q')

        if query == None:
            return qs

        data = query.split(' ')

        begin = []
        end = []

        if data == None:
            return qs

        for item in data:
            if item.startswith("'"):
                begin.append(item[1:])
            if item.endswith("'"):
                end.append(item[:-1])

        if len(begin) == 0 or len(end) == 0:
            return qs

        result = []
        for i in xrange(0, len(begin)):
            if begin[i][:-1] == end[i][1:]:
                result.append(begin[i][:-1])
            else:
                result.append(begin[i] + ' ' + end[i])

        for i in xrange(0, len(result)):
            qs = qs.filter(dxdiag__icontains=result[i])

    print qs #prints all user that has a dxdiag with "windows xp"  
    return qs 
```

# mysql - MySql SET 交集

> ID：12277457
> 
> 赞同：8
> 
> 时间：2012-09-05T08:35:36.177
> 
> 标签：mysql

我有下一个数据库

```
|   ID   |  numbers   |
|--------|------------|
|    1   | 1,2,3      |
|    2   | 4,5,6      |
|    3   | 2,3,4      | 
```

要检索包含给定数字的所有行`numbers`很容易：

```
SELECT * FROM mydb WHERE FIND_IN_SET(3, numbers) 
```

这将返回第 1 行和第 3 行

但是现在我想传递一个数组/一组数字，并想检索其中至少出现一个数字的所有条目`numbers`，即两个集合的交集不为空的地方像：

```
SELECT * FROM mydb WHERE SET_INTERSECT('2,4', numbers)!=NULL 
```

这应该返回所有行，因为每行包含 2 和/或 4。

以上不起作用。这在mysql中可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T08:38:36.077

为什么不使用 OR ？

```
SELECT * FROM mydb WHERE FIND_IN_SET(2, numbers) or FIND_IN_SET(4, numbers) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:40:04.970

如果将表结构更改为：

```
ID | NUMBERS

 1 | 1
 1 | 2
 1 | 3
 2 | 4
 2 | 5
 ...

SELECT DISTINCT id FROM table WHERE numbers = 2 OR numbers = 4
/*or...*/
/*WHERE numbers IN (2, 4)*/ 
```

# iphone - 如何在模拟器上访问我的应用程序的持久性存储文件？

> ID：12277458
> 
> 赞同：0
> 
> 时间：2012-09-05T08:35:45.423
> 
> 标签：iphone, xcode, ios-simulator

如何在模拟器上访问我的应用程序的持久性存储文件？

我知道如何从我的设备上取下它，但不知道模拟器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:35:30.847

转到 ~/Library/Application Support/iPhone Simulator/(iOS version #)/Applications/，每个应用程序都会有一个十六进制 ID 的文件夹，其中包含 .app 包和目录 Documents、Library 和 tmp。

请注意，它在“~/Library”而不是“/Library”中。

# java - 删除字符串的一部分之后的所有内容

> ID：12277461
> 
> 赞同：52
> 
> 时间：2012-09-05T08:36:10.683
> 
> 标签：java, android, string, replace

我有一个由三部分组成的字符串。我希望字符串是（更改）这个词，一个单独的部分（不更改）和最后一个更改的部分。我想删除分隔部分和结尾部分。分隔部分是“ - ”所以我想知道是否有办法在字符串的某个部分之后删除所有内容。

这种情况的一个例子是，如果我想把这个：“堆栈溢出 - 问东西的地方”变成这个：“堆栈溢出”。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-09-05T08:38:03.807

例如，您可以这样做：

```
String result = input.split("-")[0]; 
```

或者

```
String result = input.substring(0, input.indexOf("-")); 
```

（并添加相关的错误处理）

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-09-05T09:27:24.163

apache commons StringUtils 提供了一个[substringBefore](http://commons.apache.org/lang/api-2.3/org/apache/commons/lang/StringUtils.html#substringBefore%28java.lang.String,%20java.lang.String%29)方法

`StringUtils.substringBefore("Stack Overflow - A place to ask stuff", " - ")`

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2020-01-20T23:21:54.423

## Kotlin 解决方案

使用内置的 Kotlin`substringBefore`函数（[文档](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.text/substring-before.html)）：

```
var string = "So much text - no - more"
string = string.substringBefore(" - ") // "So much text" 
```

它还有一个可选的第二个参数，如果没有找到分隔符，它是返回值。默认值为原始字符串

```
string.substringBefore(" - ", "fail")  // "So much text"
string.substringBefore(" -- ", "fail") // "fail"
string.substringBefore(" -- ")         // "So much text - no - more" 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-05T08:39:42.927

你可以用这个

```
String mysourcestring = "developer is - development";
String substring = mysourcestring.substring(0,mysourcestring.indexOf("-")); 
```

它会写成“开发者是——”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-05T08:39:06.373

也许这就是您正在寻找的：

```
String str="Stack Overflow - A place to ask stuff";

String newStr = str.substring(0, str.indexOf("-")); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-05T08:49:22.127

我为所有方法创建了示例程序，`SubString`似乎是最快的一个。

```
Using builder : 54
Using Split : 252
Using Substring  : 10 
```

下面是示例程序代码

```
 for (int count = 0; count < 1000; count++) {
        // For JIT
    }
    long start = System.nanoTime();
    //Builder
    StringBuilder builder = new StringBuilder(
            "Stack Overflow - A place to ask stuff");
    builder.delete(builder.indexOf("-"), builder.length());
    System.out.println("Using builder : " + (System.nanoTime() - start)
            / 1000);
    start = System.nanoTime();
    //Split
    String string = "Stack Overflow - A place to ask stuff";
    string.split("-");
    System.out.println("Using Split : " + (System.nanoTime() - start)
            / 1000);
    //SubString
    start = System.nanoTime();
    String string1 = "Stack Overflow - A place to ask stuff";
    string1.substring(0, string1.indexOf("-"));
    System.out.println("Using Substring : " + (System.nanoTime() - start)
            / 1000);
    return null; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-07-19T20:59:01.957

干净的方法来安全地删除直到一个字符串，如果令牌可能存在或可能不存在，则保留搜索的部分。

```
String input = "Stack Overflow - A place to ask stuff";
String token = " - ";
String result = input.contains(token)
  ? token + StringUtils.substringBefore(string, token)
  : input;
// Returns "Stack Overflow - " 
```

> [Apache StringUtils](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/StringUtils.html)函数是 null-、empty- 和非匹配安全的

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-05T08:39:22.850

这将满足您的需要：

```
newValue = oldValue.substring(0, oldValue.indexOf("-"); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-05-03T14:04:01.337

```
String line = "deltaasm:/u01/app/oracle/product/11.2.0/dbhome_1:N        # line addred by agent";

    String rep = "deltaasm:";
    String after = "";

    String pre = ":N";
    String aft = "";
    String result = line.replaceAll(rep, after);
    String finalresult = result.replaceAll(pre, aft);
    System.out.println("Result***************" + finalresult);

    String str = "deltaasm:/u01/app/oracle/product/11.2.0/dbhome_1:N        # line addred by agent";

    String newStr = str.substring(0, str.indexOf("#"));
    System.out.println("======" + newStr); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-01-04T12:34:22.853

你可以我的 utils 方法这个动作..

```
public static String makeTwoPart(String data, String cutAfterThisWord){
    String result = "";

    String val1 = data.substring(0, data.indexOf(cutAfterThisWord));

    String va12 = data.substring(val1.length(), data.length());

    String secondWord = va12.replace(cutAfterThisWord, "");

    Log.d("VAL_2", secondWord);

    String firstWord = data.replace(secondWord, "");

    Log.d("VAL_1", firstWord);

    result = firstWord + "\n" + secondWord;

    return result;
}` 
```

# javascript - 没有 jquery 的 DOM 注入

> ID：12277470
> 
> 赞同：2
> 
> 时间：2012-09-05T08:36:42.643
> 
> 标签：javascript, html, dom, code-injection

我想知道如何在不使用 jquery 库的情况下使用 DOM 注入来注入 HTML 标签。

我们想从一个外部 javascript 文件生成几个对象到原始页面，但我们不想依赖 jquery（因为它是 90kb）并且我们无法控制将使用我们脚本的站点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T08:38:55.080

要么使用

```
 object.innerHTML = "<br/><span>Text</span>" 
```

或使用 appendChild：

```
 var child = element.appendChild(child); 
```

[https://developer.mozilla.org/en-US/docs/DOM/Node.appendChild?redirectlocale=en-US&redirectslug=DOM%2Felement.appendChild](https://developer.mozilla.org/en-US/docs/DOM/Node.appendChild?redirectlocale=en-US&redirectslug=DOM%2Felement.appendChild)

两者都有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T08:38:43.713

您只是在寻找：

```
newNode = document.createElement(tagType); 
```

和

```
parent.appendChild(newNode); 
```

有关`document`关卡功能的更多信息，请参阅[https://developer.mozilla.org/en-US/docs/DOM/document](https://developer.mozilla.org/en-US/docs/DOM/document)

有关操作元素的方法，请参阅[https://developer.mozilla.org/en-US/docs/DOM/element](https://developer.mozilla.org/en-US/docs/DOM/element)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T08:41:28.667

如果您要创建许多元素并且它们包含在一个公共根节点中，我建议创建一个`documentFragment`并将您需要通过`createElement()`和`appendChild()`方法生成的所有节点附加到其中

然后只需将其附加`documentFragment`到文档中

来自 MDN 参考：[createDocumentFragment](https://developer.mozilla.org/en-US/docs/DOM/document.createDocumentFragment)

> 由于文档片段在内存中而不是主 DOM 树的一部分，因此将子片段附加到它不会导致页面重排（计算元素的位置和几何形状）。因此，使用文档片段通常会带来更好的性能

# java - 无法使用 Apache 文件上传库在服务器中保存文件类型

> ID：12277478
> 
> 赞同：0
> 
> 时间：2012-09-05T08:37:16.343
> 
> 标签：java, jsp, servlets

我只是想在 jsp 中使用 type=file 上传任何文件，然后尝试使用 Servlet 在服务器中保存。

doPost 方法中的 Servlet 代码如下

```
 boolean isMultipart = ServletFileUpload.isMultipartContent(request);

    System.out.println(" isMultipart ="+isMultipart);
    if (isMultipart) {
        FileItemFactory factory = new DiskFileItemFactory();
        ServletFileUpload upload = new ServletFileUpload(factory);

        try {
            List items = upload.parseRequest(request);
            Iterator iterator = items.iterator();
            while (iterator.hasNext()) {
                FileItem item = (FileItem) iterator.next();
           System.out.println(" inside iterator..is form field"+item.isFormField());

                if (!item.isFormField()) {
                    String fileName = item.getName();

                    System.out.println(" inside nor form field");
                    String root1 = getServletContext().getRealPath("/");

                    System.out.println(" server root ="+root1);
                    File path = new File(root + "/uploads");
                    if (!path.exists()) {
                        boolean status = path.mkdirs();

                        System.out.println(" inside path doesnt exist");
                    } // if file path doesnt exists

                    File uploadedFile = new File(path + "/" + fileName);
                    System.out.println(uploadedFile.getAbsolutePath());
                    item.write(uploadedFile);
                } // if condition for field not form field but file
            } // while more files per request
        } catch (FileUploadException e) {
            e.printStackTrace();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

} 
```

在线 `if (!item.isFormField())` 它不进去。即使在jsp中，我也将正确的enctype如下

```
<form action="Test" enctype="multipart/form-data" method="post">
<label for="fil">Please select file</label>
<input id="fil" type="file">
<input type="submit" name="click" value="click">

</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T10:19:48.557

解决了。像这样放置名称属性后`<input id="fil" type="file" name="file" >`，问题就解决了。

# teamcity - 当构建固定在 Teamcity 中时是否可以运行脚本

> ID：12277481
> 
> 赞同：2
> 
> 时间：2012-09-05T08:37:24.347
> 
> 标签：teamcity

在 Teamcity 中，可以固定构建。有谁知道是否有可能进行“Pin Actions”？

我试图在 JetBrains TeamCity 文档中找到有关它的信息，但直到现在无法提出解决方案。

潜在的问题是我们只想为固定构建标记我们的 SVN 存储库，而不仅仅是成功构建。

我正在使用 TeamCity 6.5。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-02-15T09:58:26.337

实际上，由于该主题首先出现在 Google 搜索中...

此功能已经存在：添加触发器 -> 计划触发器 -> 显示高级选项 -> 仅在观察到的构建更改时触发 -> 最后固定的构建

因为您可以配置计划构建以每分钟或更频繁地检查它，这将完全按预期工作。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T17:31:55.203

引脚构建触发器存在[问题](http://youtrack.jetbrains.com/issue/TW-9578)，但尚未解决。JetBrains 提供使用[URL 触发插件](http://confluence.jetbrains.net/display/TW/Url+Build+Trigger)，但如果您的 teamcity 中没有访客支持，可能会很困难。

您也可以编写[自定义构建触发器](http://confluence.jetbrains.net/display/TCD7/Custom+Build+Trigger)，这将非常有用。

# arm - ARM和NEON可以并行工作吗？

> ID：12277484
> 
> 赞同：7
> 
> 时间：2012-09-05T08:37:32.757
> 
> 标签：arm, inline-assembly, simd, neon, cortex-a8

这是参考问题： [Intrinsics 中 Neon 的校验和代码实现](https://stackoverflow.com/questions/12066964/checksum-code-implementation-for-neon-in-intrinsics)

打开链接中列出的子问题作为单独的单独问题。由于多个问题不应作为单线程的一部分提出。

无论如何来这个问题：

**ARM**和**NEON**（就 arm cortex-a8 架构而言）实际上可以并行工作吗？我怎样才能做到这一点？

有人可以指点我或分享一些使用ARM-NEON的互操作的示例实现（伪代码/算法/代码，而不是理论实现论文或演讲）吗？（使用内在函数或 inline-asm 实现都可以。）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-05T15:52:25.443

答案取决于 ARM CPU。例如，Cortex-A8 使用协处理器来执行 NEON 和 VFP 指令，这些指令通过 FIFO 连接到 ARM 内核。当指令解码器检测到 NEON 或 VFP 指令时，它只需将其放入 fifo。NEON 协处理器从 FIFO 中获取指令并执行它们。因此，NEON/VFP 协处理器稍微落后了一点——在 Cortext-A8 上最多 20 个周期左右。

通常，该延迟并不关心该延迟，除非您尝试将数据从 NEON/VFP 协处理器传输回主 ARM 内核。（无论您是通过从 NEON/VPF 移动到 ARM 寄存器，还是通过使用最近由 NEON 指令写入的 ARM 指令读取内存来做到这一点并不重要）。在这种情况下，主 ARM 内核会停止，直到 NEON 内核清空 FIFO，即最多 20 个周期左右。

ARM 内核通常可以比 NEON/VPF 协处理器执行它们的速度更快地将 NEON/VPF 指令排入队列。您可以通过适当的交错指令来利用它使两个内核并行工作。例如，在每两个或三个 NEON 指令块之后插入一条 ARM 指令。或者，如果您还想利用 ARM 的双发功能，也可以使用两条 ARM 指令。您将不得不使用内联汇编来执行此操作 - 如果您使用内在函数，指令的确切调度取决于编译器，并且它是否具有适当地交错它们的智能是任何人的猜测。你的代码看起来像

```
<neon instruction>
<neon instruction>
<neon instruction>
<arm instruction>
<arm instruction>
<neon instruction>
... 
```

我手头没有代码示例，但是如果您对 ARM 汇编有点熟悉，那么交错指令应该不是什么大问题。完成后，请务必使用指令级分析器来检查事情是否按预期工作。您应该看到几乎没有时间花在 ARM 指令上。

请记住，其他 ARMv7 实现可能会完全不同地实现 NEON。例如，Cortex A-9 似乎将 NEON 移到了更靠近 ARM 内核的位置，并且在从 NEON/VFP 回到 ARM 的数据移动方面的成本要低得多。我不知道这是否会影响指令的并行调度，但这绝对是需要注意的事情。

# c# - 如何在流畅的nhibernate中添加参考条件？

> ID：12277486
> 
> 赞同：1
> 
> 时间：2012-09-05T08:37:40.743
> 
> 标签：c#, nhibernate, fluent-nhibernate, fluent-nhibernate-mapping

在我的 ClassMap 中，我只想在满足条件时加载一个属性。这是我现在使用的代码：

```
References<MyObject>(x => x.Property).ForeignKey("RecordId"); 
```

我想为此添加一个 Where 子句：仅`x.Property`在数据库中的值为零时加载，如下所示：

```
References<User>(x => x.Property).ForeignKey("RecordId").Where("Removed = 0"); // Where Removed is a column of the user table 
```

但不幸的是，这不起作用。有人知道这方面的等价物吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T09:25:39.270

在`ClassMap`课堂上，我添加了一个`Where`子句：

```
public class ClassAMap : ClassMap<ClassA>
{
    public ClassAMap()
    {
        Table("ClassA");

        // Only load Class A where the user is not removed
        Where("PersonRecId in (select u.Userid from Users u where u.Removed = 0)");

        Id(c => c.Id).GeneratedBy.Identity();

        References<User>(x => x.User).ForeignKey("UserId");
    }
} 
```

注意：需要在`Where`子句中使用别名，否则会出错。

# ajax - 未找到 JSF 2 动态生成的 ID

> ID：12277488
> 
> 赞同：0
> 
> 时间：2012-09-05T08:37:52.383
> 
> 标签：ajax, jsf-2, render

我在渲染参数中的 f:ajax 标记中遇到了动态生成的 id 问题。我得到错误：

```
Component with id:pak_Internet not found

viewId=/start.xhtml
location=C:\servers\apache-tomcat-7.0.29\temp\tst-web-war\start.xhtml
phaseId=RENDER_RESPONSE(6)

Caused by:
javax.faces.FacesException - Component with id:pak_Internet not found
at org.apache.myfaces.renderkit.html.HtmlAjaxBehaviorRenderer.getComponentId(HtmlAjaxBehaviorRenderer.java:411) 
```

代码：

```
<ui:repeat var="servicesPhones" value="#{cc.attrs.limits.servicesLimits}">  
            <h:selectOneMenu
                value="#{cc.attrs.limits.phoneSelected}">
                **<f:ajax render="pak_#{servicesPhones.name}" event="change" execute="@this"/>**
                <f:selectItems value="#{cc.attrs.limits.getPhones(servicesPhones.name)}" />
            </h:selectOneMenu>

            <h:panelGroup id="pak_#{servicesPhones.name}">
                <ui:repeat var="pak" value="#{cc.attrs.limits.getPackages(servicesPhones.name)}">
                    #{pak.name}<br/>
                </ui:repeat>
            </h:panelGroup>
</ui:repeat> 
```

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T11:39:44.080

只需从属性中删除那些 EL 表达式`id`。`<ui:repeat>`遗嘱本身已经确保了这些 ID 的唯一性，并且已经更新了正确的 ID 。

```
<f:ajax ... render="pak" />
...
<h:panelGroup id="pak"> 
```

如果您使用这些 EL 表达式的唯一原因是能够在 JavaScript 或 CSS 中识别/选择 JSF 生成的 HTML 表示，那么您需要通过`styleClass`.

# objective-c - 使用 Objective-C 以编程方式释放系统内存

> ID：12277492
> 
> 赞同：3
> 
> 时间：2012-09-05T08:37:59.153
> 
> 标签：objective-c, c, macos, cocoa, memory

所以，这就是我想要做的：

*   以与命令相同的方式释放系统内存（非活动内存），`purge`但以编程方式。

我已经尝试过这里的代码（它的作者声称它可以工作），但它所做的只是导致 Mac OS X 冻结：

```
void
free_up_memory()
{
    int c;
    char *p, *q;

    for(c = 0; c < 2048; c++)
    {
        if(!(p = malloc(1024 * 1024)))
        {

            return;
        }
        for(q = p; q < p + (1024 * 1024); q += 4096)
        {
            *q = 1;
        }

    }
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-05T17:14:23.733

现实情况是代码没有做——也永远不会做——它声称的。这是垃圾。

它所要做的就是破坏系统的缓冲区缓存子系统，并可能使机器快速分页，从而导致看起来完全像锁定的症状。尤其是在具有慢速（例如 5,400rpm 笔记本电脑驱动器）硬盘驱动器的系统上。

至少，在 RAM 相对较少的系统上。在具有大量 RAM 和运行的应用程序负载相对较轻的系统上，该程序将驱逐 2GB 的缓冲区缓存，导致各种 I/O 操作变慢，因为需要从磁盘重新读取各种内容，而不是真的帮助任何事情。

也不应该有任何这样的事情；如果应用程序需要内存，系统将根据需要从缓冲区缓存中逐出页面和/或将内存分页到磁盘（在 OS X 上——在 iOS 上，没有分页器能够在很大程度上写入脏页以保持响应能力）。

调用 to`purge`将驱逐各种磁盘缓冲区缓存并在冷启动时模拟条件，但是 - 再次 - 这只会破坏系统的缓存机制，而不会真正提高用户级应用程序的性能。*如手册页所述，它对于在冷缓存*状态下测试应用程序性能非常有用，但即使这样也有点可疑，因为它`purge`不会驱逐所有可以驱逐的东西；不会干净地模拟冷状态。

对于 Steve Jessep 的观点，在某些情况下调用`purge`（或类似的）可能会提高性能。这通常 - 几乎普遍 - 在一般情况下分崩离析，因为用户进程 A 无法知道用户进程 B、C、D、....、Z 在附近或遥远的未来。例子; A 可能会去清除东西，只是让 RSS Feed Scraper R 撕下几 MB 的 XML 进行解析和持久化，立即使清除无效。更糟糕的是，R 的最后一次刷新可能仍有一些位潜伏在缓存中，因此 R 的刷新会影响 I/O，使其变得更慢且成本更高（包括消耗电池寿命）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-05T08:47:27.433

这段代码实际所做的是将尽可能多的内存分配到 1MB 块中，最多可达 2GB，并向其中写入一些数据以确保实际提交内存。也就是说，要确保您不仅分配了虚拟地址空间，而且没有分配内存。然后它泄漏它。

因此，代码所做的是“强制操作系统在内存不足时执行它所做的事情”。然后当这个程序退出时，*它的*内存被释放并且你有很多不错的可用空间。

此代码的作者希望“操作系统在内存不足时所做的事情”是释放您所谓的“非活动内存”。看起来它实际上为你做的是冻结。显然这是一个错误。任何时候都有任意数量的设备和服务在运行，并且只要其中一个有缺陷就会导致问题。对于操作系统冻结，问题必须是在高于用户模式下运行的东西，所以我很失望但并不感到惊讶。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-05T09:00:39.120

Mac OS X 可能会冻结，因为它正在等待虚拟内存管理器 (VMM) 将页面交换到磁盘；由于您的函数正在快速分配内存，因此系统正在尽其所能为其提供服务，并且它将在放弃之前使用磁盘交换文件。

一旦发生这种情况，系统中分配内存的所有内容都会在 VMM 交换页面时停止。通常这只会在这里和那里造成小的延迟，但是由于您正在占用所有可用内存，*因此系统中的几乎所有内容*都会在磁盘 I/O 上阻塞。

我相当有信心，如果您等待的时间足够长，VMM 会赶上来，系统会恢复正常。

您可以通过在应用程序运行时查看活动监视器来测试我的假设；如果我是对的，Mac 冻结时磁盘 I/O 会非常高。

如果你真的想释放内存，你应该做一些不同的事情：以编程方式执行`purge`命令，或者将调用替换为`malloc`保持内存“连线”（不会被分页到磁盘）的东西。或者，根本不这样做，而不是事后猜测 VMM，让它完成它的工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-05T09:45:44.860

该程序不执行相同的`purge`- 它只是试图模拟效果`purge`。有时这是成功的，有时它只是将不必要的内存量刷新到磁盘（这可以解释为什么当您返回它们时您的程序可能会很慢）。`purge`做一些完全不同的事情——它专注于特定的记忆。

就“冻结”而言，是的，一旦达到上限，系统就会开始将内存的内容推送到磁盘。系统还将尝试在进程中释放内存支持的文件节点——内存支持的文件节点是特别`purge`关注的。您的程序最终会将其他进程的内存推送到磁盘。这不是解决问题的好方法。它要求太多，而且没有选择性。无论如何……这种方法可以像宣传的那样有效。它做*了*类似的事情，并且*可以*在此过程中释放磁盘缓冲区缓存。

FWIW，这在 10.8 中的问题比 10.7 小。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-08-15T01:30:11.103

这应该释放 OS X 认为不需要的所有 RAM：

```
-(void)purgeRAM {
    NSTask *purgeTask = [[NSTask alloc] init];
    [purgeTask setLaunchPath:@"/usr/bin/purge"];
    [purgeTask launch];
    [purgeTask waitUntilExit];
    NSLog(@"Purge complete");
} 
```

# ruby - 批量分配受保护的属性：用户、格式、操作、控制器

> ID：12277496
> 
> 赞同：1
> 
> 时间：2012-09-05T08:38:14.643
> 
> 标签：ruby, ruby-on-rails-3

我正在尝试使用 JSON 通过 POST 创建设计用户。

控制器的当前代码是

```
class V1::UsersController < ApplicationController
  load_and_authorize_resource
  respond_to :json

  def create
    @user = User.create(params)
    if @user.save
      render json: @user, status: :created
    else
      render json: @user.errors, status: :unprocesssable_entry
    end
  end

end 
```

我将以下 JSON 作为 POST 发送到`http://localhost:3000/v1/users.json`

```
{"user":{"active":true,"email":"test@email.com","username":"test"}, "auth_token":"my token"} 
```

问题是我看到一个错误，需要将一些似乎是 Rails 内部的属性列入白名单。我没有`user, format, action, controller`我的用户模型的属性。我尝试`attr_accesible`在用户模型中添加它们，但随后 POST 返回未找到这些属性。

```
<h1>
  ActiveModel::MassAssignmentSecurity::Error
    in V1::UsersController#create
</h1>
<pre>Can&#x27;t mass-assign protected attributes: user, format, action, controller</pre> 
```

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T08:43:41.130

您必须参考 params[:user] 而不是 params：

```
@user = User.create(params[:user]) 
```

# php - 在 PHP 中安全地传递变量 html 表单

> ID：12277500
> 
> 赞同：0
> 
> 时间：2012-09-05T08:38:21.940
> 
> 标签：php, forms, variables, hidden

我有一个由 MySQL 数据库中的数据填充的表单。要对表单进行更新/编辑，我想使用该记录的主键。提交页面后，如何安全地将主键传递给页面。我不想使用 $_GET，因为任何用户都可以在 URL 上更改它，并且在隐藏的表单字段中嵌入主键也可能被破坏并且在 html 源代码中可见。该操作正在同一页面上完成（请参见下面的代码块）。处理是在同一页面上完成的，所以我不确定会话是否有效。

```
//Load the data from the database
  if(isset($_GET['menu_id'])){
       $menu_id = (int)$_GET['menu_id'];
       $menu = new Menu();
       $menu_item = $menu->get_menu_items_by_id($menu_id);
  }
  else{
       //The user has possibly edited the URL
       $message = "Please select an option to edit";
       redirect_to($PHP_SELF . '?message=' . $message);
  }
?>
<form method="POST" action="<?php echo $_SERVER['PHP_SELF'] ?>">

<div>
<label>Name</label>
<input type="text" name="name" value="<?php echo $menu_item->name ?>">
</div>

<div>
<label>Title</label>
<input type="text" name="title" value="<?php echo $menu_item->title ?>">
</div>

<div>
<label>Is default page</label>
<input type="radio" name="is_default_page" value="1" 
    <?php 
        if($menu_item->is_default_page == 1) 
            {
            echo "checked"; 
            }?>
     >Yes
<input type ="radio" name="is_default_page" value="0" 
        <?php 
        if($menu_item->is_default_page == 0) 
            {
            echo "checked"; 
            }?>

     >No    
</div>

<div>
<label>Page name</label>
<input type="text" name="page" value="<?php echo $menu_item->page ?>" />
</div>

<div>
<label>Menu type</label>
<select name="menu_type">
    <?php
    //Display the options of the menu types available
    $menu_type_array = $menu->get_menu_types();
    draw_select($menu_type_array, 'name', 'id', $menu->menu_type_id);
    ?>
</select>
</div>

<div>
    <label>Page type i.e what is the page used for</label>
    <select name="page_type">
        <?php
        $page = new Page();
        $page_type_array  = $page->get_page_types();
        draw_select($page_type_array, 'name', 'id', $menu->page_type_id)
        ?>
    </select>
</div>

<div>
    <label>Position</label>
    <select name="position">
        <?php
        //Count the number of menus in the database

        $number_of_menu_items = $menu->count_menu_items() + 1;
        for($i=1; $i<=$number_of_menu_items; $i++){
            echo "<option value=\"{$i}\"";
            if($i==$menu->position){
                echo "selected = \"selected\"";
            }
            echo ">";
            echo "{$i}";
            echo "</option>";
        }

        ?>
    </select>
</div>

<div>
    <input type="submit" value="Add Menu" name="edit_menu" />
</div>

<form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:44:23.830

这里有什么问题？是的，用户可以更改正在编辑的记录的 id，因此输入的数据将保存到另一条记录。

...

所以呢？这与用户转到其他记录的页面并直接在那里编辑它没有任何不同。您仍然有访问控制来检查是否允许用户开始编辑记录，对吗？您还进行了数据验证，以验证提交的数据对于特定记录是否有效，对吗？

那么这里就没有真正的担忧了。如果用户能够编辑特定的记录，他就能够以一种或另一种方式进行。只需将 id 放在 URL 中就足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:44:00.813

如果使用可以轻松更改您的 $_GET 或 $_POST 数据，则它不是安全问题。事实上，如果它只是一个显示请求，你可以把它放在你的 $_GET url 上（当然，在这种情况下，你的 php 代码必须确保它可以被用户显示），以及你的 $_POST datas 如果您想修改存储在数据库中的数据。

这是获取和发布请求的目的，不要试图用其他工具发明一些东西。将来让它继续工作将是一团糟。

# java - JPA/Hibernate：已创建表的注释

> ID：12277501
> 
> 赞同：0
> 
> 时间：2012-09-05T08:38:23.390
> 
> 标签：java, hibernate, jpa

我有两个表（已经创建），说 Person 和 Address 具有以下模式：

```
create table Person (
    `id` int(11) not null auto_increment,
    `name` varchar(255) default null,
    primary key(`id`)
)

create table Address (
    `id` int(11) not null,
    `city` varchar(255) default null,
    primary key (`id`),
    constraint foreign key (`id`) references `Person`(`id`)
) 
```

现在，我应该在代码中使用哪些注释？

这两个类的骨架是：

```
class Person {
    @Id @GeneratedValue
    @Column(name="id")
    int id;
    String name;

    Address address;
}

class Address {
    int id;
} 
```

我需要为**Person**类中的*地址*字段和**Address类的***id*字段添加注释。

 ****** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:45:49.220

在 Person.java 中

```
@OneToOne(cascade = CascadeType.ALL, fetch = FetchType.LAZY)
@JoinColumn(name = "id",nullable=false)
@ForeignKey(name = "fk_id")     
private Address address; 
```

并在地址 .java -

```
@OneToOne(fetch=FetchType.LAZY)
@JoinColumn(name = "id", updatable = false, insertable = false, nullable=false)  
private Person id;    

@Column(name = "id", insertable = false, updatable = false, nullable=false)
private Integer id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:45:07.427

```
 class Person {
   @Id @GeneratedValue
   @Column(name="id")
   int id;
   String name;

   @OneToOne
   @JoinColumn(name = "address_id", referencedColumnName = "id")
   Address address;
}

class Address {
    @id
    int id;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T19:46:24.780

我认为您想使用[@MapsId](http://docs.oracle.com/javaee/6/api/index.html?javax/persistence/package-summary.html)。

```
@Entity
class Person {
   @Id 
   @GeneratedValue
   int id;

   String name;

   @OneToOne 
   @MapsId
   Address address;
}

@Entity
class Address {
    @Id
    int id;
} 
```

查看[@OneToOne](http://docs.oracle.com/javaee/6/api/javax/persistence/OneToOne.html)文档中的示例 2。*****

# asp.net - asp.net 存储 404 请求的 URL

> ID：12277505
> 
> 赞同：0
> 
> 时间：2012-09-05T08:38:37.057
> 
> 标签：asp.net, web-config, http-status-code-404

我的 web.config 中有以下内容：

```
<customErrors defaultRedirect="/error/1" mode="Off" redirectMode="ResponseRedirect">
  <error redirect="/404.aspx" statusCode="404" />
</customErrors> 
```

和

```
<httpErrors errorMode="Custom">
  <remove statusCode="404" subStatusCode="-1" />
  <error statusCode="404" prefixLanguageFilePath="" path="/404.aspx" responseMode="ExecuteURL" />
</httpErrors> 
```

**404.aspx.vb**

```
Partial Class _404
Inherits System.Web.UI.Page

Protected Overrides Sub Render(writer As HtmlTextWriter)
    MyBase.Render(writer)
    Response.StatusCode = 404
End Sub

Protected Sub Page_Load(sender As Object, e As System.EventArgs) Handles Me.Load
    Dim lang As String = Threading.Thread.CurrentThread.CurrentUICulture.TwoLetterISOLanguageName

    GlobalFunctions.ReportError("404 URL", Request.UrlReferrer.Host.ToString)

End Sub
End Class 
```

在我的 404.aspx 的代码隐藏中，我想首先存储请求的 URL。我该怎么做？如果在 404.aspx.vb 中不可能，我想知道我还能如何将请求存储在我的数据库中。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:43:50.133

Request.UrlReferrer 获取有关链接到当前 URL 的客户端先前请求的 URL 的信息。

直接来自[msdn](http://msdn.microsoft.com/en-gb/library/system.web.httprequest.urlreferrer.aspx)

# php - multi_query 错误捕获

> ID：12277506
> 
> 赞同：2
> 
> 时间：2012-09-05T08:38:37.250
> 
> 标签：php, multi-query

我通过谷歌搜索了很多关于这个但没有任何答案可以帮助我 - 或者我自己找不到解决方案。

这是我的问题：我执行了一个大型的 multi_query（大约 50 多个后续查询）。如果我确实理解手册正确，我必须释放 a 的结果，`multi_query()`因为对于每个后续查询，php 解释器将返回至少一个“ok”作为结果或类似的东西 - 我必须先释放它。这是正确的还是我在这里理解错误？

我目前正在尝试这样做以释放`multi_query`结果：

```
$Result = $this->Connect->multi_query($Query);
                if($Result !== false) {
                    // Query was ok - got result
                        while ($this->Connect->more_results() && $this->Connect->next_result());
                }
                    else {
                        // If the query failed
                        $this->Valid = false;
                    array_push($this->SQLErrors,$this->Connect->error);
                    return false;
                } 
```

这是正确的，如果是 - 为什么？如果我只使用`while($this->Connect->next_result())`它会给我带来类似`"Strict Standards: there is no next result set"`.

如何捕捉错误？通过执行`multi_query`50 个后续小查询，我希望能够拥有类似的东西`$ErrorStack[3] = "Mysql Error: ..."`；这意味着我的第三个后续查询失败。我该怎么做呢？

# hibernate - 具有可连接和复合键的多对多映射

> ID：12277510
> 
> 赞同：1
> 
> 时间：2012-09-05T08:38:47.480
> 
> 标签：hibernate, hibernate-mapping

我在书和作者之间有多对多的映射

```
@Enity
public class Book{

    private Long id;
    private String name;
    ...

    @Id
    @Column(name="book_id")
    public getId(){
    ...
    }
    @ManyToMany(
    @JoinTable(name="book_author",
        joinColumns = @JoinColumn(name="book_id"),
        inverseJoinColumns = @JoinColumn(name="????")
    )
    public List<Author> getAuthors(){
    ...
    }
}

@Enity
public class Author{
    @EmbeddedId;
    private AuthorPk authorPk;
    ...

} 
```

我如何在 inverseJoinColumn 上进行多对多映射，因为它是一个复合键？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T09:04:04.220

```
inverseJoinColumns = {@JoinColumn(name = "theFirstColumnInTheJoinTable", 
                                  referencedColumnName = "theFirstColumnInTheTargetTable"),
                      @JoinColumn(name = "theSecondColumnInTheJoinTable", 
                                  referencedColumnName = "theSecondColumnInTheTargetTable")} 
```

但我肯定会避免复合 PK：它们使生活变得更加复杂，性能也更差。

# jsp - 将 HTTP 发布参数从 JSP 加密到 servlet

> ID：12277511
> 
> 赞同：1
> 
> 时间：2012-09-05T08:38:47.217
> 
> 标签：jsp, servlets, post, encryption, parameters

我有一个登录 JSP，它在文本框中从用户那里获取用户名/密码，并在提交时使用 POST 方法将用户名/密码参数转发到登录 Servlet。

现在我在两者之间使用 Paros 代理（作为中间人攻击）来捕获参数。从 JSP 接收的参数在 Paros 中被捕获为纯文本。

Java标准API是否提供了任何特定方法，我们可以使用这些方法来加密这些参数：

1.  即使参数被 Paros Proxy 捕获，也可能无法以纯文本形式显示。

2.  Servlet 不必解密它。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T11:00:18.480

使用 SSL 保护您的数据不被嗅探。如果您要求在服务器端不执行解码（可能意味着*解密*），我想不出任何其他方式。

# javascript - 无点击淡出

> ID：12277513
> 
> 赞同：1
> 
> 时间：2012-09-05T08:38:48.830
> 
> 标签：javascript, jquery

在我的拼写游戏中，当一个单词完成时，它会在网格中消失。当一定数量的单词完成时（在本例中为 3），整个网格会淡出以显示后面的图像。我现在遇到的问题是当我完成第三个单词时，直到我再次单击鼠标之前什么都没有发生。

我需要它，以便在该单词完成后立即运行脚本而无需单击鼠标。

这是触发淡出的一段代码......

```
$('.drag').on('click', function(e) {
e.preventDefault();
if(animation) return;
animation = true;
setTimeout(function(){animation = false;},500);
var target = $('.drop-box.spellword:not(.occupied):first');
var targetPos = target.position();
var currentPos = $(this).offset();
var b = $(this);

if (target.length) {
    target.addClass("occupied");
    $(".minibutton").prop("disabled", true);
    b.clone().addClass(
    b.data("letter") == target.data("letter") ? "wordglow3" : "wordglow").appendTo("table").css({
        background: "transparent",
        position: "absolute",
        top: currentPos.top,
        left: currentPos.left
    }).animate({
        top: targetPos.top,
        left: targetPos.left
    }, "slow", function() {
        $(this).css({
            top: 0,
            left: 0
        }).appendTo(target);
        if (!$('.drop-box.spellword:not(.occupied)').length) {
            var wordIsCorrect = 0;
            $('.drop-box.spellword').each(function() {
                if ($(this).attr("data-letter") == $(this).find("div").attr("data-letter")) {
                    wordIsCorrect++;
                }
            });
            console.log(wordIsCorrect);
            console.log($('.drop-box.spellword').length);
            if ($('.drop-box.spellword').length == wordIsCorrect) {

                $('.drop-box.spellword').addClass('wordglow2');
                $(right).val('Well Done!');
                $(right).show();
                audioS.play();
                $('.counter').html(completeWords + '/6').show();
                $(wrong).hide();
                $('.minibutton').prop('disabled', false);

            } else {

                $('.drop-box.spellword').addClass("wordglow4").css('color', 'transparent');
                $(wrong).val('Try Again');
                $('.minibutton').prop('disabled');
                $(wrong).show();
                audioF.play();
                $('.counter').html(completeWords + '/6').show();
                $(right).hide();
                //$('.minibutton').prop('disabled', true);

                $('.drop-box.spellword')
                    .animate({ 'opacity': 1 }, 2000, function()
                             {
                                $(this)
                                    .removeClass('wordglow4')
                                    .removeClass('occupied')
                                    .html('')
                                    });
            }

        }
    });

}

var completeLetters = $('.wordglow2').length;
var completeWords = (completeLetters / 3);
$('.counter').html(completeWords + '/6');

if (completeWords == 3) {
    $('table').fadeOut(2000);
}

var incompleteWords = $('.spellword').hasClass('.wordglow4').length;
if (incompleteWords == 3) {
    $('.minibutton').prop('disabled', false);
} 
```

});

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T08:06:23.317

您的等级完成测试：

```
if (completeWords == 1) {
    $('table').fadeOut(2000);
} 
```

在点击的字母被添加之前被击中。你的代码太混乱了，我无法理解，但我建议你把这个测试移到你测试完整单词的分支中，这很好。

```
if ($('.drop-box.spellword').length == wordIsCorrect) {

  $('.drop-box.spellword').addClass('wordglow2');
  $(right).val('Well Done!');

  // move the above test here
} 
```

# ios - 如何让屏幕外 UIScrollView 知道设备旋转？

> ID：12277517
> 
> 赞同：0
> 
> 时间：2012-09-05T08:39:02.673
> 
> 标签：ios, uiscrollview, screen-rotation

我已经观看了 WWDC session 223 视频，介绍了使用`panGestureRecognizer`屏幕外`UIScrollView`的 OpenGL 在 OpenGL 中进行动态滚动。我正在试验这个和一个`UIView`后代（而不是演示中的 OpenGL 视图）所有工作正常，除了当我旋转设备时，滚动视图仍然计算`contentOffset`未旋转的坐标。有什么方法可以指示/连接滚动视图以应用设备旋转/窗口转换？

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T07:52:01.217

结果我没有足够仔细地观看演示视频：滚动视图必须通过将其添加为子视图来连接到根控制器。将 UIScrollView 作为不可见子项添加到它所控制的 UIVIew 可以解决问题。

```
UIView* theViewToControl = [...];
UIScrollView* scroller = [....];
// move gesture recognizer, set delegate etc. 
// Up to here it works, except for rotations;
// This is is required to make rotations work too:
[scroller setHidden:YES];
[theViewToControl addSubView:scroller]; 
```

# python - YAML加载期间的python str错误

> ID：12277523
> 
> 赞同：0
> 
> 时间：2012-09-05T08:39:23.463
> 
> 标签：python, yaml, runtime-error, pyyaml

大家早上好！（是的，我知道，早上没有必要站在你这边;-)）

我来找你是因为我的一天开始时有一段我无法解释的代码的小错误。

我目前正在建立一个旨在做两件简单事情的课程：

打开一个 YAML 格式的配置文件，然后加载这个。

对我来说不幸的是，我全新的革命计划（这显然是一个笑话）今天不想成为一名好士兵，并且拒绝做它应该做的事情。

这是我的代码：

main.py 部分：

```
#!/usr/bin/env python
import socket
from models import setting

run = setting.app_config()
run.get_config() 
```

这是设置模块：

```
import os
import yaml

class app_config:

def __init__(self, custom_cfg=None):

    self.workdir = os.getcwd()
    self.default_config_name = 'app_config.yaml'
    self.default_config_path = self.workdir+"/assets/"

    if custom_cfg is None:
        self.config_file_path = self.default_config_path+self.default_config_name

    else:
        self.config_file_path = custom_cfg

def get_config(self):

    app_config_file = open(self.config_file_path, 'r')
    parsed_config_file = yaml.load(app_config_file, 'r')
    app_config_file.close()
    network_settings = parsed_config_file['network']
    hostname = network_settings['host']
    socket = network_settings['port']
    buffer_size = network_settings['buffer_size']

    print network_settings, hostname, socket, buffer_size 
```

所以，现在，这两段代码的问题似乎来自这个声明：

```
parsed_config_file = yaml.load(app_config_file, 'r') <-- Line 22 
```

这导致了一个非常漂亮的错误消息：

```
Traceback (most recent call last):
File "main.py", line 6, in <module>
  run.get_config()
File "/home/dri/devil_project/models/setting.py", line 22, in get_config
  parsed_config_file = yaml.load(app_config_file, 'r')
File "/usr/local/lib/python2.6/dist-packages/yaml/__init__.py", line 69, in load
  loader = Loader(stream)
TypeError: 'str' object is not callable 
```

现在，如果我尝试打印我的 app_config_file 变量或尝试使用 for 循环读取此文件，一切都很完美，打印工作正常，我的文件打开并且我可以读取它。

好吧，如果有人已经使用 YAML 模块（PyYAML 模块）遇到过这种情况，我会对他的解决方案感兴趣;-)

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:45:53.533

你告诉加载函数你想打开一些东西来阅读，所以它假设你给它一个文件。摆脱'r'论点。

除非您想指定文件路径，否则我认为您要加载的是**app_config_file_path**

# android - 当我使用“Activity.openFileOutput("myFile", Context.MODE_PRIVATE);”时，文件存储在哪个目录中 存储它？

> ID：12277526
> 
> 赞同：0
> 
> 时间：2012-09-05T08:39:37.607
> 
> 标签：android, sqlite, fileoutputstream, bufferedinputstream

我有这段代码可以用我的 android 应用程序存储一个远程 sqlite .db 文件：

```
public String getRemoteCollection(String url, String dbName){
    BufferedInputStream in = null;
    FileOutputStream fout = null;
    dbName="myFile";
    try
    {
        in = new BufferedInputStream(new URL(url).openStream());
        fout = SectionManager.instance.activity.openFileOutput(dbName, Context.MODE_PRIVATE);

        byte data[] = new byte[1024];
        int count;
        while ((count = in.read(data, 0, 1024)) != -1)
            fout.write(data, 0, count);
        if (in != null)
            in.close();
        if (fout != null)
            fout.close();                   
    }
    catch(Exception e){e.printStackTrace();}
    return dbName;
} 
```

我需要用我的 sqlitemanager 打开那个文件，我有这个功能，它从资产中打开一个 .db 文件，但我需要调整这个方法来加载我在前面提到的方法中存储的文件，它不存储在资产上文件夹。所以我必须改变这个方法，但我不知道如何正确地做到这一点。

```
private void generateSQLiteDB(String databaseName) {     // 
        SQLiteDatabase db =  dbHelper.getReadableDatabase(); // by calling this line an empty database will be created into the default system path of this app - we will then overwrite this with the database from the server
        db.close();
        OutputStream os = null;
        InputStream is = null;
        try{
            is =  ctx.getAssets().open(databaseName+".db");
            String packageName=SectionManager.instance.activity.getApplicationContext().getPackageName();
            //os = new FileOutputStream("/data/data/com.android.launcher/databases/"+databaseName+".db");   
            os = new FileOutputStream("/data/data/"+packageName+"/databases/"+databaseName+".db");  
            copyFile(os, is);
        }catch (Exception e) {
            Log.e("DB", "Database not found", e);                          
        }finally{
            try{
                //Close the streams
                if(os != null)
                    os.close();
                if(is != null)
                    is.close();
            } catch (IOException e) {Log.e("DB", "Can't close adapters");}
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T11:21:05.407

如文档所述，openFileOutput() 不采用路径，文件存储为应用程序“私有数据存储”的一部分，设备上的其他应用程序无法访问。因此，假设您上面的两个代码片段在同一个 Android 应用程序中，您无需担心路径，只需将相同的文件名传递给 openFileInput()，您将获得与存储相同的数据。

在您的情况下，您的文件名是 dbName，因此在您的第二个片段中：

```
is =  ctx.getAssets().open(databaseName+".db"); 
```

变成

```
is = ctx.openFileInput(databaseName); 
```

在第一个片段中，它似乎被硬编码为“myFile”。我在这里假设 ctx 是 Context 类型或派生类，例如 Activity。

更新：如果您确实需要找出用于存储应用程序私有文件的文件系统目录，您可以调用：

```
ctx.getFilesDir(); 
```

或者

```
ctx.getFileStreamPath(databaseName); 
```

# delphi - 使用 HTTPSendRequest 上传

> ID：12277529
> 
> 赞同：4
> 
> 时间：2012-09-05T08:39:52.287
> 
> 标签：delphi, proxy, ntlm, wininet

我必须使用 delphi 将文件发送到 php 脚本。我最终选择使用 Wininet 函数，因为我必须通过 NTLM 身份验证代理。

当我发送文件时，我的内容请求的每个字符之间都有空字符（00）：

```
POST /upload.php HTTP/1.1
User-Agent: MYUSERAGENT
Host: 127.0.0.1
Cookie: ELSSESSID=k6ood2su2fbgrh805vs74fvmk5
Pragma: no-cache
Content-Length: 5

T.E.S 
```

这是我的德尔福代码：

```
pSession := InternetOpen('MYUSERAGENT', INTERNET_OPEN_TYPE_PRECONFIG, nil, nil, 0);
pConnection := InternetConnect(pSession, PChar('127.0.0.1'), INTERNET_DEFAULT_HTTP_PORT, nil, nil, INTERNET_SERVICE_HTTP, 0, 0);
pRequest := HTTPOpenRequest(pConnection, PChar('POST'), PChar('/upload.php'), 'HTTP/1.0', nil, nil, INTERNET_SERVICE_HTTP, 0);
HTTPSendRequest(pRequest, nil, 0, Pchar('TESTR'), Length('TESTR')); 
```

对正在发生的事情有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T08:49:57.963

您没有考虑到 Delphi 字符串从 Delphi 2009 开始切换到 UTF-16 编码的 Unicode。当您通过 时`PChar('TESTR')`，您实际上是在通过 a `PWideChar`，而不是`PAnsiChar`您期望的 a 。字符串的**字符长度**为 5 个字符，但**字节长度**为 10 个字节。 `HTTPSendRequest()`对字节而不是字符进行操作。因此，您确实发送了 5 个字节，其中每个第二个字节为空，因为这就是 ASCII 字符在 UTF-16 中编码的方式。

将最后一行改为：

```
var
  S: AnsiString;
...
S := 'TESTR';
HTTPSendRequest(pRequest, nil, 0, PAnsiChar(S), Length(S)); 
```

您不需要对您正在调用的其他函数执行此操作，因为它们确实将 Unicode 字符作为输入，因此没有不匹配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T08:47:19.040

您使用的是 Delphi 2009 或更高版本吗？如果是这样，那么您的字符串将是 unicode。尝试为您的 TESTR 字符串使用 ANSIstring 变量

# java - 如何使用 xpath 从特定站点获取值并将其存储在数组中？（安卓）

> ID：12277531
> 
> 赞同：3
> 
> 时间：2012-09-05T08:40:00.987
> 
> 标签：java, android, html, http, xpath

我想问一下我的代码有什么问题。我想从 html 页面获取结果并将值存储在字符串中或稍后存储在数组中......谢谢

> 09-05 16:36:41.221: I/test(22697): 计划失败 1org.xml.sax.SAXParseException: attr 值分隔符丢失！（位置：START_TAG @1:166 in java.io.StringReader@4061bc98）09-05 16:36:41.221：I/test（22697）：计划失败 1a @1:166 in java.io.StringReader@4061bc98）09 -05 16:36:41.231: W/System.err(22697): 在 org.apache.harmony.xml.parsers.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:151) 09-05 16:36:41.231: W/System .err(22697): 在 com.asiatype.boracay.CurrencyActivity$DownloadData.doInBackground(CurrencyActivity.java:194) 09-05 16:36:41.231: W/System.err(22697): 在 com.asiatype.boracay。 CurrencyActivity$DownloadData.doInBackground(CurrencyActivity.java:1) 09-05 16:36:41.231: W/System.err(22697): 在 android.os.AsyncTask$2.call(AsyncTask.java:185) 09-05 16 ：36：41.231：W / System.err（22697）：在java.util.concurrent。

```
 String s,link;
        String theResult = "";
        link="http://www.bsp.gov.ph/statistics/sdds/exchrate.htm";
        Document doc;
        HttpClient client = new DefaultHttpClient();
        HttpGet request = new HttpGet(link);
        HttpResponse response;
        try {
            response = client.execute(request);
            InputStream in = response.getEntity().getContent();
            BufferedReader reader = new BufferedReader(new InputStreamReader(in));
            StringBuilder str = new StringBuilder();
            String line = null;
            while((line = reader.readLine()) != null)
            {
                str.append(line);
            }
            in.close();
            htmlSource = str.toString();
        } catch (ClientProtocolException e2) {
            // TODO Auto-generated catch block
            e2.printStackTrace();
        } catch (IOException e2) {
            // TODO Auto-generated catch block
            e2.printStackTrace();
        }

        try {
            doc = DocumentBuilderFactory.newInstance()
                      .newDocumentBuilder().parse(new InputSource(new StringReader(htmlSource)));
            XPathExpression xpath = XPathFactory.newInstance()
                      .newXPath().compile("//div/table/tbody/tr[child::td[contains(text(),\"USD\")]]/td[15]");
                    htmlResult = (String) xpath.evaluate(doc, XPathConstants.STRING);
        } catch (SAXException e1) {
            // TODO Auto-generated catch block
            Log.i("test", "plan failed 1"+e1);
            Log.i("test", "plan failed 1a "+ htmlSource);
            Log.i("test", "plan failed 1a "+ htmlResult);
            e1.printStackTrace();
        } catch (IOException e1) {
            // TODO Auto-generated catch block
            Log.i("test", "plan failed 2");

            e1.printStackTrace();
        } catch (ParserConfigurationException e1) {
            // TODO Auto-generated catch block
            Log.i("test", "plan failed 3");

            e1.printStackTrace();
        } catch (XPathExpressionException e) {
            // TODO Auto-generated catch block
            Log.i("test", "plan failed 4");

            e.printStackTrace();
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:03:04.623

您用作输入的[源](http://www.bsp.gov.ph/statistics/sdds/exchrate.htm)HTML 文件不是格式良好的 XML，这就是`SAXParseException`抛出的原因 - 让您知道缺少 XML 属性的值分隔符。

HTML 和 XML 非常不同。例如，HTML 可以有缺失或不匹配的结束标记，以及不带引号的属性值，而 XML 不允许这样。因此，强烈建议**不要**尝试将 HTML 解析为 XML。解析不能满足 HTML 允许的所有不一致。

有几种替代方法可以解决此问题：

1.  从[使用 Java 读取 HTML 文件到 DOM 树](https://stackoverflow.com/questions/457684/reading-html-file-to-dom-tree-using-java)- 使用[Neko](http://nekohtml.sourceforge.net/)尝试使 HTML 成为有效的 XML，这将使您能够保留现有的 SAXParser 代码，您必须找到日期
2.  从上面的同一个问题 - 使用[JTidy](http://jtidy.sourceforge.net/)将 HTML 解析为 DOM 树并使用 DOM 方法查找您的数据。在 java 中看到[xml dom 解析器？](https://stackoverflow.com/questions/5481960/xml-dom-parser-in-java)对于一些 Java DOM 解析器

# java - 计算在 android 2.2 的日历视图中显示的第一天

> ID：12277535
> 
> 赞同：1
> 
> 时间：2012-09-05T08:40:15.110
> 
> 标签：java, date, calendar

我需要生成一个整数数组，其中包含需要在当前月份视图中显示的月份中的日期。例如，当前月份视图将在第一行列中显示 8 月 26 日。

![在此处输入图像描述](../Images/089ad28a0b129d2a48aa86b14c62964d.png)

使用 Calendar 和 Date 类在 java 中的上述网格中显示整数的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T10:18:09.863

你的问题对我来说很有趣，所以我创建了解决方案：

```
import java.util.Calendar;
import java.util.Date;
import java.util.LinkedList;
import java.util.List;

public class CalendarTable {

    private static List<Integer> daysPositions = new LinkedList<Integer>();

    static {
        daysPositions.add( Calendar.SUNDAY );
        daysPositions.add( Calendar.MONDAY );
        daysPositions.add( Calendar.TUESDAY );
        daysPositions.add( Calendar.WEDNESDAY );
        daysPositions.add( Calendar.THURSDAY );
        daysPositions.add( Calendar.FRIDAY );
        daysPositions.add( Calendar.SATURDAY );
    }

    public static void viewCalendar( Date date ) {
        Calendar calendar = Calendar.getInstance();
        calendar.setTime( date );

        calendar.set( Calendar.DAY_OF_MONTH, 1 );
        // day of week for first date of month
        int firstDateOfMonthDay = calendar.get( Calendar.DAY_OF_WEEK );
        int weekOfFirstDate = calendar.get( Calendar.WEEK_OF_YEAR );

        int lastDateOfMonth = calendar.getActualMaximum( Calendar.DAY_OF_MONTH );
        calendar.set( Calendar.DAY_OF_MONTH, lastDateOfMonth );
        // day of week for last date of month
        int lastDateOfMonthDay = calendar.get( Calendar.DAY_OF_WEEK );
        int weekOfLastDate = calendar.get( Calendar.WEEK_OF_YEAR );

        calendar.roll( Calendar.MONTH, false );
        int lastDateOfPrevMonth = calendar.getActualMaximum( Calendar.DAY_OF_MONTH );

        int weeksToDisplay = weekOfLastDate - weekOfFirstDate + 1;
        int[] days = new int[weeksToDisplay * 7];

        int firstDayPosition = daysPositions.indexOf( firstDateOfMonthDay );

        // fill previous month
        int x = lastDateOfPrevMonth;
        for ( int i = firstDayPosition - 1; i >= 0; i-- ) {
            days[i] = x--;
        }

        // fill current month
        for ( int i = 1; i < lastDateOfMonth + 1; i++ ) {
            days[firstDayPosition - 1 + i] = i;
        }

        // fill next month
        int j = 1;
        for ( int i = lastDateOfMonth + firstDayPosition; i < days.length; i++ ) {
            days[i] = j++;
        }

        // display calendar
        // ( here you may extract data into your structure )
        for ( int i = 0; i < days.length; i++ ) {
            if ( i % 7 == 0 ) {
                System.out.println();
            }
            System.out.print( days[i] + "\t" );
        }
    }

    public static void main( String[] args ) {
        viewCalendar( new Date() );
    }

} 
```

执行后，您将获得输出（例如 - 当前月份视图）：

```
26  27  28  29  30  31  1   
2   3   4   5   6   7   8   
9   10  11  12  13  14  15  
16  17  18  19  20  21  22  
23  24  25  26  27  28  29  
30  1   2   3   4   5   6 
```

此外，在某些日历中 - 一周的第一天是星期一，因此您可以`daysPositions`这样填写：

```
 static {
        daysPositions.add( Calendar.MONDAY );
        daysPositions.add( Calendar.TUESDAY );
        daysPositions.add( Calendar.WEDNESDAY );
        daysPositions.add( Calendar.THURSDAY );
        daysPositions.add( Calendar.FRIDAY );
        daysPositions.add( Calendar.SATURDAY );
        daysPositions.add( Calendar.SUNDAY ); // move Sunday to the end of week
    } 
```

进行此操作后，对于当前月份视图，您将获得：

```
27  28  29  30  31  1   2   
3   4   5   6   7   8   9   
10  11  12  13  14  15  16  
17  18  19  20  21  22  23  
24  25  26  27  28  29  30  
1   2   3   4   5   6   7 
```

# mysql - 将 access 2007 数据库与 MySql 链接时出现警告消息

> ID：12277536
> 
> 赞同：0
> 
> 时间：2012-09-05T08:40:20.820
> 
> 标签：mysql, odbc, ms-access-2007

我有一个 Access 2007 数据库，我已使用 access 将其复制到 MySql。由于有些用户仍将使用 access 2007，因此我打算将 Access 2007 链接到 MyAql。这意味着对任一数据库的更新都将显示在两个数据库上。

但是，当我尝试使用 Access 2007 链接这两个时，我收到如下所示的警告。

![在此处输入图像描述](../Images/8b74e9224eeeb65c168632d0e39e2170.png)

我通过单击确定忽略了图像上显示的警告。当我尝试更新 MySql 数据库时，没有发生任何更新，也没有任何内容传输到 Access 2007 数据库，反之亦然。

# twitter-bootstrap - Chrome 中的 AngularJS 和 twitter 引导编号验证

> ID：12277537
> 
> 赞同：3
> 
> 时间：2012-09-05T08:40:22.503
> 
> 标签：twitter-bootstrap, angularjs

我在使用 angularjs 验证时遇到问题，请参阅[http://jsfiddle.net/NR55T/1/](http://jsfiddle.net/NR55T/1/)。基本上，如果数字在小数点后有数字，则有效数字输入周围会发出红光。

这似乎只发生在 Google Chrome 上（在 Firefox 中运行良好）并且仅在与引导程序一起使用时才会发生。如果我省略了必需的属性，它在 Chrome 中也可以正常工作。

我的标记是无效的还是两者交互的问题？如果这是一个问题，是否有一个简单的解决方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T16:59:40.377

显然 Chrome 希望您指定这样的[步骤](http://www.w3schools.com/html5/att_input_step.asp)来指示任何增量都是有效的：

```
<input type="number" step="any" ng-model="Number" required /> 
```

[这](http://jsfiddle.net/NR55T/2/)是更新的小提琴，请参阅[此](http://blog.isotoma.com/2012/03/html5-input-typenumber-and-decimalsfloats-in-chrome/)以获取有关该问题的更多信息。

# javascript - JQuery BlockUI 鼠标加载光标不会在 Google Chrome 中恢复为默认值

> ID：12277540
> 
> 赞同：5
> 
> 时间：2012-09-05T08:40:31.600
> 
> 标签：javascript, jquery, google-chrome, jquery-blockui

我的 JQuery BlockUI 鼠标加载光标在服务器响应后返回到 FF 中的默认光标，但在 Google Chrome 中没有返回到默认光标，并且给人的印象是元素仍在加载.. 它在鼠标移动后返回默认值.

如何解决？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T14:47:41.690

这是一个已知的 Chrome[错误](http://code.google.com/p/chromium/issues/detail?id=26723)。当您访问该链接时，会建议一些解决方法。

# asp.net - 自己动手做模式的 CSS 修复

> ID：12277541
> 
> 赞同：1
> 
> 时间：2012-09-05T08:40:36.467
> 
> 标签：asp.net, css, modal-dialog

我一直在为我的网站设计一个模式窗口。我无法让 ajax 以我想要的方式工作，所以我这样创建它：

模态窗口和背景只是我在页面加载时隐藏的 asp 面板控件（执行此操作的代码，我同意是 arb，但我还没有设法改进它）

以下是模态的 html（预渲染）：

```
<asp:Panel runat="server" ID="pnlModalbg" CssClass="modalbg"> </asp:Panel>
<asp:Panel runat="server" ID="pnlModal" CssClass="modal">
    <!-- Modal content goes here -->
    <p>Lorem ipsum dolor sit amet...</p>
    <!-- End Modal content -->

    <!-- Close button -->
    <div class="centeralign"><asp:Button runat="server" ID="btnCloseModal" Text="Close" CssClass="button" /></div>
    <!-- End close button -->
</asp:Panel> 
```

非常简单。现在这是我用来显示/隐藏它的代码。上面的面板应在页面加载时隐藏，然后应显示在 GridView.RowCommand 事件上。这很好用，但我怀疑这是最好的方法：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    If Not IsPostBack Then

        pnlModal.Style(HtmlTextWriterStyle.Display) = "none"
        pnlModalbg.Style(HtmlTextWriterStyle.Display) = "none"
    End If

End Sub

Protected Sub gvAppointments_RowCommand(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewCommandEventArgs) Handles gvAppointments.RowCommand

    If e.CommandName = "ViewAppt" Then

        lblAppointmentId.Text = e.CommandArgument

        GetDetails()

        pnlModal.Style(HtmlTextWriterStyle.Display) = "block"

        pnlModalbg.Style(HtmlTextWriterStyle.Display) = "block"

    End If
End Sub

Protected Sub btnCloseModal_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnCloseModal.Click

    pnlModalbg.Style(HtmlTextWriterStyle.Display) = "none"
    pnlModal.Style(HtmlTextWriterStyle.Display) = "none"

End Sub 
```

现在这是真正的问题。的CSS。无论屏幕分辨率如何，这应该将模态窗口定位在距浏览器窗口顶部边缘 150px 和距浏览器窗口边缘左侧 450px 的位置。它没有。我测试过的每个屏幕上的水平定位都是不同的。

理想情况下，我想在类中使用边距（最好`margin: 150px auto;`是 ）`.modal`进行定位，但如果没有绝对定位，它总是与页面内容的其余部分一起显示。此外，`.modalbg`面板出现在模式窗口本身的上方。应用`.modal {z-index: 9999;}`和`.modalbg {z-index: -1;}`帮助，但是 modalbg 似乎仍然位于页面上的其他元素之后，并且更改它们的 z-index 值并不能纠正这一点。

```
.modal
{
    border: 2px solid #014073;
    border-radius: 5px;
    left: 450px;
    top: 150px;
    display: none;
    position: absolute;
    background: #fff;
    padding: 10px;
}

.modalbg
{
    height: 100%;
    width: 100%;
    position: absolute;
    top: 0;
    left: 0;
    background: #000;
    -moz-opacity:.30;
    filter:alpha(opacity=30);
    opacity:.30;
    display: none;
} 
```

我不介意必须更改服务器代码中的显示 css，但是对于 css 问题的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T07:05:12.830

因此，在改进了我的模态并看到我对这个问题没有任何回应之后，这是我当前的模态窗口模板：

的HTML

```
<a href="#" class="showModal">Show Modal</a>

<div class="modalbg" onclick="hideModal();">
</div>
<div class="modal">
    <!-- Content goes here -->

    <a href="#" class="hideModal">Hide Modal</a>
</div> 
```

这很简单，实际上只有几个 div。作为模态背景的一个是空的，另一个是实际的模态窗口，可以随意设置样式。还需要一个链接或用户可以单击以显示模式的东西。

我还在模态背景中添加了一个 onclick，这样如果它被点击，它将隐藏模态并让用户继续使用站点的其余部分。我看过一些网站，这是不可能的，而且确实非常具有侵入性。

CSS

```
.modal
{
    box-shadow: 0 0 10px 2px #a1a1a1;
    border-radius: 5px;
    margin: 0 auto;
    display: none;
    position: absolute;
    background: #c1c1c1;
    padding: 10px;
}

.modalbg
{
    height: 100%;
    width: 100%;
    position: absolute;
    top: 0;
    left: 0;
    background: #000;
    -moz-opacity:.30;
    filter:alpha(opacity=30);
    opacity:.30;
    display: none;
    z-index: 0;
} 
```

由于问题是关于css的，这就是我所拥有的。基本上，模态背景应该从左上角到右下角跨越整个浏览器窗口。模态框位于`0 auto`页边距以使其在页面上正确居中（可以根据自己的喜好调整上/下边距）。**当我问这个问题时，这是我遇到问题的地方，但这不应该是这个模板的问题。**

这是让一切正常工作的 JQuery

```
var modalbg = $(".modalbg");
var modal = $(".modal");

$(".showModal").click(function() {
    modalbg.fadeIn(500);
    modal.fadeIn(500);
});

$(".hideModal").click(function() {
    hideModal();
});

function hideModal() {
    // It's important here to blank out any form fields you may have on the modal
    // use $("#field_name").text = "";

    modalbg.fadeOut(500);
    modal.fadeOut(500);
} 
```

大多数情况下，JQuery 只是促进模式的显示/隐藏。我确信可能有一种方法可以改进这一点，但它按原样工作得很好。

# android - 无法为 Android 编译 LKM

> ID：12277542
> 
> 赞同：-1
> 
> 时间：2012-09-05T08:40:40.440
> 
> 标签：android, c, linux, android-ndk, linux-kernel

我有 Ubuntu 12.04 作为编译环境。

我也有**Cyanogen mod kernel**的源代码（从 Github 获取：[https](https://github.com/CyanogenMod/cm-kernel) ://github.com/CyanogenMod/cm-kernel ）

我使用来自 Android NDK r5c 的工具链（适用于 linux **）**

我有以下代码：

```
#include <linux/kernel.h>
#include <linux/module.h>
#include <asm/unistd.h>

asmlinkage ssize_t (*orig_open)(const char *pathname, int flags);

asmlinkage ssize_t hooked_open(const char *pathname, int flags) {
    printk(KERN_INFO "SYS_OPEN: %s\n", pathname);
    return orig_open(pathname, flags);
}

void **sys_call_table;

static int __init root_start(void) {
    sys_call_table= (void *) 0x0030084;

    orig_open = sys_call_table[__NR_open];
    sys_call_table[__NR_open] = hooked_open;
    return 0;
}

static void __exit root_stop(void) {
    sys_call_table[__NR_open] = &orig_open;
}

module_init(root_start);
module_exit(root_stop); 
```

这是我的**Makefile**：

```
obj-m += root.o

all:
    make -C CyanogenMod-cm-kernel-2a32a61/ M=$(PWD) ARCH=arm CROSS_COMPILE=arm-eabi- modules 
```

**我在终端**中编译的步骤：

```
export PATH=$PATH:/home/hongnhat/lkm/android-ndk-r5c/toolchains/arm-eabi-4.4.0/prebuilt/linux-x86/bin
cd CyanogenMod-cm-kernel-2a32a61
make oldconfig && make prepare
cd ..
make 
```

结果是：

```
make -C CyanogenMod-cm-kernel-2a32a61/ M=/home/hongnhat/lkm ARCH=arm CROSS_COMPILE=arm-eabi- modules
make[1]: Entering directory `/home/hongnhat/lkm/CyanogenMod-cm-kernel-2a32a61'

  WARNING: Symbol version dump /home/hongnhat/lkm/CyanogenMod-cm-kernel-2a32a61/Module.symvers
           is missing; modules will have no dependencies and modversions.

  CC [M]  /home/hongnhat/lkm/root.o
as: unrecognized option '-EL'
make[2]: *** [/home/hongnhat/lkm/root.o] Error 1
make[1]: *** [_module_/home/hongnhat/lkm] Error 2
make[1]: Leaving directory `/home/hongnhat/lkm/CyanogenMod-cm-kernel-2a32a61'
make: *** [all] Error 2 
```

我不知道为什么它会抛出**unrecognized option '-EL' error**。请帮我解决这个问题，我一直在努力尝试，我尝试使用不同的**gcc**版本（4.4.0、4.4.3、4.6）但没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:53:27.673

尝试使用 Sourcery Mentor 的 GCC 编译它。我之前尝试过为 Android 编译 Linux 内核。也许它有帮助。

# php - 修改对象中的数据

> ID：12277550
> 
> 赞同：0
> 
> 时间：2012-09-05T08:41:02.270
> 
> 标签：php, object

我有以下功能：

```
function moveUp($row_nr){
        $other_row = ($row_nr - 1);
        foreach ($this -> data as &$row){
            if ($row['row_nr'] == $other_row){
                $row['row_nr']++;
            }
            else if ($row['row_nr'] == $row_nr){
                $row['row_nr']--;
            }
        }
    } 
```

`$this -> data`是一个数组，其中包含表示 SQL 查询返回的字段行的数组。此函数的目的是通过递减其 row_nr 并递增最初在其上方的行的 row_nr 来按顺序向上移动指定的行。

不幸的是，事情似乎并没有计划好！row_nr 似乎没有在对象中更新。查看其他线程，我看到有人建议使用 & 运算符来专门引用变量而不是它的副本，但是正如您在我的代码中看到的那样，我已经做到了，但运气不佳（或者也许我做错了！）。

我也尝试过以下线路：

```
$row -> row_nr++;

$row -> row_nr--; 
```

正如我在这里发布的一些示例中看到的那样，但那里也没有运气。

有人对为什么对象中的数据数组似乎没有正确更新有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:44:33.563

在 PHP 中，函数获取数组的副本。

任何一个

a) 返回新数组

或者

b)`function moveUp(&$row_nr){`

通过引用传递数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T08:46:26.597

```
function moveUp($row_nr){
        $other_row = ($row_nr - 1);
        foreach ($this -> data as $key => $row){
            if ($row['row_nr'] == $other_row){
                $this->data[$key]['row_nr']++;
            }
            else if ($row['row_nr'] == $row_nr){
                $this->data[$key]['row_nr']--;
            }
        }
    } 
```

# c - sigint 调用多次而不是一次 (C)

> ID：12277551
> 
> 赞同：2
> 
> 时间：2012-09-05T08:41:07.183
> 
> 标签：c, fork, sigint

这是我的代码片段：

```
signal (SIGINT, ( void *)sig_handler); 

while(1){
    newsockd = -1;
    memset(&cli_addr, 0, sizeof(cli_addr));

    if((newsockd = accept(sockd, (struct sockaddr *) &cli_addr, (socklen_t *) &socket_len)) < 0){
        perror("Errore nella connessione\n");
        onexit(newsockd, sockd, 0, 2);
    }
    fprintf(stdout, "Ricevuta richiesta di connessione dall' indirizzo %s\n", inet_ntoa(cli_addr.sin_addr));

    child_pid = fork();
    if(child_pid < 0){
        perror("Fork error");
        onexit(newsockd, sockd, 0, 2);
    }
    if(child_pid == 0){
        do_child(newsockd);
        exit(0);
    }
    else{
       while(waitpid(child_pid, NULL, WNOHANG) > 0)
        continue;
       }
    }
} 
```

和函数 sig_handler：

```
void sig_handler(const int signo, const int sockd, const int newsockd){
  if (signo == SIGINT){
    printf("Received SIGINT, exiting..\n");
    if(newsockd) close(newsockd);
    if(sockd) close(sockd);
    exit(EXIT_SUCCESS);
  }
} 
```

当我按下“CTRL+C”时会出现问题，因为 sighandler 被多次调用。
例子：

1.  服务器正在监听；
2.  2 x 收到连接；
3.  2 个儿童叉；
4.  2 x 孩子已关闭；
5.  现在我想关闭服务器，所以我按 CTRL+C；

预期输出：
`received SIGINT, exiting....`
**真实**输出：
`received SIGINT, exiting....`
`received SIGINT, exiting....`
`received SIGINT, exiting....`

为什么我会出现这种行为？

**编辑：代码更新**
这是当 1 个分叉完成并且孩子完成后我关闭服务器时发生的情况：

```
^C7518
7516
Received SIGINT, exiting...
Received SIGINT, exiting... 
```

**`exit(0)`解决方案：问题是我在指令之后没有写`do_child()`...代码更新了！**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T08:48:11.053

信号被发送到当前进程的每个子进程。
在您的代码中，当您使用 时`fork`，您将创建一个子进程，该子进程继承自`SIGINT`处理程序的主进程。这就是为什么会多次打印该消息的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T10:07:32.990

观察的很少，

1）你应该更好地使用 sigaction 而不是信号功能。 [http://pubs.opengroup.org/onlinepubs/7908799/xsh/sigaction.html](http://pubs.opengroup.org/onlinepubs/7908799/xsh/sigaction.html)

2）现在在您当前的代码中进行了一些修复。您可以使用

```
if(child_pid == 0)
{
   /*Now in the child make again the action for SIGINT default, so that 
   your handler does not get called.*/ 
       signal (SIGINT, SIG_DFL);
       do_child(newsockd);
} 
```

3）为什么你在主循环中调用waitpid？您应该有一个 SIGCHLD 处理程序，然后在其中使用 wait/waitpid。

理想情况下，在创建一个子服务客户端之后，主循环应该返回接受。（如果它在创建孩子后被阻止，那么您的服务器如何成为并发服务器？）

（或者对于第一个版本，我建议您在调用 SIGINT 的信号处理程序之后避免使用这种方法，

```
signal(SIGCHLD, SIG_IGN);  //This should  automatically get rid of zombies. 
```

（请在您的系统中进行实验）

参考链接 - [http://en.wikipedia.org/wiki/SIGCHLD](http://en.wikipedia.org/wiki/SIGCHLD)

4）您对 SIGINT 处理程序的论点似乎也不正确。正确的原型是

```
void (*signal(int sig, void (*func)(int)))(int); 
```

但是你的处理程序是

```
void sig_handler(const int signo, const int sockd, const int newsockd). 
```

sockfd 和 newsockfd 的值是如何传递的？
关联

[http://pubs.opengroup.org/onlinepubs/009696899/functions/signal.html](http://pubs.opengroup.org/onlinepubs/009696899/functions/signal.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T09:12:59.453

我不确定你是如何杀死子进程的。如果子进程还没有处于 Zomb 状态，你的 sign_handler 将处理它。可能需要添加更多日志来阐明子进程生命周期的顺序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-14T13:57:41.920

在相关说明中：我发现我也为单个 CTRL+C 获得了多个 SIGINT。当我检查我的任务管理器时，我实际上为这个应用程序挂了多个 node.js 脚本。在任务管理器中终止它们后，我开始按预期接收单个 SIGINT。

# iphone - 任何人都可以帮助我如何解密（AES128）在 JAVA 中加密的 iOS 中的消息（AES 解密 128）

> ID：12277552
> 
> 赞同：-1
> 
> 时间：2012-09-05T08:41:08.287
> 
> 标签：iphone, ios, ios5, ios4, iphone-sdk-3.0

请找到我们正在使用的以下方法。

从 Hexa 中的服务器接收到的密钥：1EF5F2D644FBA8E4142778CD43D70BFA

从服务器收到的编码消息：/lGtPU2K29FZPNtrc9DKow==

如果我们解密上面的消息，它应该是“hi”

我无法在 iOS 端解密它。谁能帮帮我。

```
- (NSData *)AES128DecryptWithKey:(NSString *)key 
{
    // 'key' should be 16 bytes for AES128, will be null-padded otherwise
    char keyPtr[kCCKeySizeAES128+1]; // room for terminator (unused)
    bzero(keyPtr, sizeof(keyPtr)); // fill with zeroes (for padding)

    // fetch key data
    [key getCString:keyPtr maxLength:sizeof(keyPtr) encoding:NSUTF8StringEncoding];

    NSUInteger dataLength = [self length];

    //See the doc: For block ciphers, the output size will always be less than or 
    //equal to the input size plus the size of one block.
    //That's why we need to add the size of one block here
    size_t bufferSize = dataLength + kCCBlockSizeAES128;
    void *buffer = malloc(bufferSize);

    size_t numBytesDecrypted = 0;
    CCCryptorStatus cryptStatus = CCCrypt(kCCDecrypt, kCCAlgorithmAES128, 0,keyPtr, kCCKeySizeAES128,
                                          NULL /* initialization vector (optional) */,
                                          [self bytes], dataLength, /* input */
                                          buffer, bufferSize, /* output */
                                          &numBytesDecrypted);

    if (cryptStatus == kCCSuccess)
    {
        //the returned NSData takes ownership of the buffer and will free it on deallocation
        return [NSData dataWithBytesNoCopy:buffer length:numBytesDecrypted];
    }

    free(buffer); //free the buffer;
    return nil;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T10:24:07.860

你可以试试这个：

```
CCCryptorStatus cryptStatus = CCCrypt(kCCDecrypt, 
                                      kCCAlgorithmAES128, 
                                      kCCOptionECBMode | kCCOptionPKCS7Padding,
                                      keyPtr, 
                                      kCCKeySizeAES128,
                                      NULL /* initialization vector (optional) */,
                                      [self bytes], dataLength, /* input */
                                      buffer, bufferSize, /* output */
                                      &numBytesDecrypted); 
```

# java - 何时使用抽象类和接口

> ID：12277556
> 
> 赞同：0
> 
> 时间：2012-09-05T08:41:27.447
> 
> 标签：java

> **可能的重复：**
> [接口与抽象类（一般 OO）](https://stackoverflow.com/questions/761194/interface-vs-abstract-class-general-oo)

请举例说明在什么情况下使用抽象类和接口。在大多数情况下，人们通常倾向于使用接口而不是抽象类，为什么？解释它们的用途。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:46:27.790

抽象类是一种特殊的类，不能被实例化。那么，为什么我们需要一个无法实例化的类呢？抽象类只能被继承。换句话说，它只允许其他类从它继承而不能被实例化。优点是它在继承抽象类的多个类中强制执行某些常见行为或属性。

接口是由“接口”一词定义的实体。接口仅包含方法的签名，其实现将由实现该接口的类提供。

# iphone - 实施“应用内购买简介”教程后出现奇怪的错误

> ID：12277558
> 
> 赞同：0
> 
> 时间：2012-09-05T08:41:34.233
> 
> 标签：iphone, ios

我正在尝试在应用程序购买中实现，我遵循了这个很棒的教程[In-App Purchases 简介](http://www.raywenderlich.com/2797/introduction-to-in-app-purchases)

当我清理项目时，它没有显示任何错误，但是当我构建项目时，它给了我这些错误：

```
 Undefined symbols for architecture armv7:
  "_OBJC_CLASS_$_MBProgressHUD", referenced from:
      objc-class-ref in PDF_Product.o
  "_OBJC_CLASS_$_Reachability", referenced from:
      objc-class-ref in PDF_Product.o
  "_OBJC_CLASS_$_InAppRageIAPHelper", referenced from:
      objc-class-ref in AppDelegate.o
      objc-class-ref in PDF_Product.o
ld: symbol(s) not found for architecture armv7
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

我试图删除文件并再次添加它们，但没有奏效。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:47:18.477

它们是链接器错误，表明您使用了未内置到最终二进制文件中的类（并且它们；不在任何框架中等）。

对于每个缺少类的类，找到定义它的 .m 文件（例如，'Reachability` 可能在 Reachability.m 中定义）并检查：

*   你确定在你的应用程序目标中有 Reachability.m 吗？

*   您是否在目标的“编译源”构建阶段确定了 Reachability.m？

*   正如下面提到的@Sohaib，是否选择了正确的会员复选框？在右侧面板的属性检查器中检查这一点，在最左侧的选项卡（看起来像一张纸的选项卡）中有一个名为“目标成员资格”的部分 - 这显示了您的文件正在编译的目标。我总是不小心将文件错误地添加到我的单元测试目标中:)

# javascript-events - 在属性哈希中设置 id 时，不会将其复制为 Backbone 中的直接属性

> ID：12277563
> 
> 赞同：0
> 
> 时间：2012-09-05T08:42:12.410
> 
> 标签：javascript-events, backbone.js

在 Backbone 文档中，它说：[如果您在属性哈希中设置 id，它将作为直接属性复制到模型中](http://backbonejs.org/#Model-id)。

但它不适用于我的代码：

```
var room = new Room({id: 1});
test.equals(room.id, 1);// expect room.id to be 1, but it's undefined. 
```

这意味着我无法从我的收藏中获得这个模型：

```
rooms.add(room);
test.equals(rooms.get(1), room); // expect equal, but not because rooms.get(1) returns undefined 
```

以下是 Room 模型的一些代码片段：

```
var Room = Backbone.Model.extend({
        defaults: {
            dealInterval: 1
        },                 
        initialize: function(){   
            var seats = Seats.prepareSeats();   
            this.set({seats: seats, roomState: RoomState.WAITING, cards: Cards.decks(2)});
        }

    }); 
```

我什至可以在一个简单的节点命令（版本 0.9.2，下划线 1.3.3）中重现此问题，：

```
username$ node
> var Backbone = require('backbone');
undefined
> var room = new Backbone.Model({id: 1});
undefined
> room.id
undefined // expect to be 1
> room
{ attributes: { id: 1 },
  _escapedAttributes: {},
  cid: 'c0',
  changed: {},
  _silent: {},
  _pending: {},
  _previousAttributes: { id: 1 } }
> 
```

所以我怀疑我的节点环境可能有问题？

# javascript - Highcharts 动态更改标签？

> ID：12277568
> 
> 赞同：4
> 
> 时间：2012-09-05T08:42:33.813
> 
> 标签：javascript, jquery, highcharts

此图有一个标签：http: [//jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/demo/combo/](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/demo/combo/)标签是“总水果消费”

创建图表后，如何动态更改该句子？

**PS：**我尝试设置标签并重绘图形但没有用：http: [//jsfiddle.net/UXDqL/](http://jsfiddle.net/UXDqL/)

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-24T12:49:09.720

使用标签，你可以使用渲染器文本（），然后使用变量来保存对象。如果您需要动态更新此文本，只需使用 attr() 函数并更新即可。

[http://jsfiddle.net/6GKCJ/2/](http://jsfiddle.net/6GKCJ/2/)

```
var title = chart.renderer.text('Total fruits consumption', 100, 90)
        .css({
            fontSize: '12px'
        })
        .add();

        $('#btn').click(function(){

            title.attr({
                text:'newText'
            });
        }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T13:20:01.400

如果要在绘制绘图后更改它，只需对元素本身进行操作即可。使用 jquery 选择器很简单：

```
// find me the tspan containing the specified text and change it to...
$("tspan:contains('Total fruit consumption')").text("Something New") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T10:54:55.733

从 Highcharts 3.0 开始，Highchart 不提供任何动态更新标签标题的方法。虽然它确实提供了一种动态更新系列的方法：http: [//api.highcharts.com/highstock#Series.update()](http://api.highcharts.com/highstock#Series.update())

要更新标签标题，我们需要在这里采用蛮力方法，即在更新图表选项后再次渲染图表。以下代码应该可以解决问题：

```
var mychart = $('#container').highcharts();
    mychart.options.labels.items[0].html= "Changed label header";
    mychart = new Highcharts.Chart(mychart.options);
    mychart.render(); 
```

JsFiddle：http: [//jsfiddle.net/msjaiswal/ZD4N5/2/](http://jsfiddle.net/msjaiswal/ZD4N5/2/)

一个类似的线程：[这里](https://stackoverflow.com/questions/9661250/render-highcharts-after-user-updated-labels)

# c# - C#通过特定属性值删除特殊的html标签

> ID：12277570
> 
> 赞同：0
> 
> 时间：2012-09-05T08:42:38.277
> 
> 标签：c#, html

在下面的 html 标签中，我想使用 c# 程序删除具有以下属性值的整个`"display:none"`标签`style`：

```
<td>
    <span style="display:none">
        <font color="#ffffff">OK</font>
    </span>
    <span>
    <font color="#ffffff">OK</font>
    </span>
</td> 
```

并且 html 将变为：

```
<td>
    <span>
        <font color="#ffffff">OK</font>
    </span>
</td> 
```

除了使用`Replace()`函数，谁能给我一些解决这个问题的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:45:00.180

您可以使用 HTMLAGILITY Pack 安全地解析您的 html 节点

[http://nuget.org/packages/HtmlAgilityPack](http://nuget.org/packages/HtmlAgilityPack)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T08:59:28.853

幸运的是，您可以使用 CsQuery 在 C# 中使用 jQuery 之类的[sintaxys](https://github.com/jamietre/csquery)

```
string htmlString = @"<td>
<span style=\"display:none\">
<font color=\"#ffffff\">OK</font>
</span>
<span>
<font color=\"#ffffff\">OK</font>
</span>
</td>";
var dom = CQ.Create(htmlString);
dom.Select("[style=display:none]").Remove(); 
```

我没有测试它，但这是一个很好的起点

在具有多个显示的 DOM 中：无，正如在评论中提到的 @jamietre

```
var dom = CQ.Create(htmlString);
dom.Select("[style]").Where(item=>item.Style["display"]=="none")).Rem‌​ove(); 
```

# c# - MVC 分页帮助 - 列出“第一”和“最后”之间的页面

> ID：12277573
> 
> 赞同：0
> 
> 时间：2012-09-05T08:42:48.503
> 
> 标签：c#, asp.net-mvc, pagination

我已经根据[nerddinner 教程](http://nerddinnerbook.s3.amazonaws.com/Part8.htm)实现了这个寻呼机。

我之前已将其设置为列出第一个和最后一个链接之间的所有页面，但是现在这已经失控了:) 在下面的示例中，我有用于分页的 HTML / 代码块。我现在将第一个和最后一个链接之间的页码列表减少到只有 10 个。

然而这并没有改变。无论我在哪个页面上，它仍然会列出 1-10。我希望它显示接下来 10 页的链接。任何帮助，将不胜感激！

```
<ul id="paginator">
    <% if (Model.HasPreviousPage)
       { %>
    <li>
        <%= Html.RouteLink("First Page", new { namespaces = "Admin", controller = "Products", action = "ViewAll", page = 0 })%></li>
    <% } %>
    <% else %>
    <% { %>
    <li>First Page</li>
    <% } %>
    <% for (int i = 0; i < 10; i++) %>
    <% { %>
    <% if (i == Model.PageIndex) %>
    <% { %>
    <li>
        <%: i+1 %></li>
    <% } %>
    <% else %>
    <% { %>
    <li>
        <%= Html.RouteLink((i + 1).ToString(), new { namespaces = "Admin", controller = "Products", action = "ViewAll", page = i })%>
    </li>
    <% } %>
    <% } %>-->
    <% if (Model.HasNextPage)
       { %>
    <li>
        <%= Html.RouteLink("Last Page", new { namespaces = "Admin", controller = "Products", action = "ViewAll", page = Model.TotalPages - 1 })%></li>
    <% } %>
    <% else %>
    <% { %>
    <li>Last Page</li>
    <% } %>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:09:47.967

您可以使用当前页面来决定放置 10 个项目的位置，理想情况下，我想您希望在当前页面的任一侧显示 5 个页面（或在当前页面的任一侧显示 'n' 个页面）。这个算法相当容易实现......

```
var startingPage = currentPage - 5;
var endingPage = currentPage + 5; 
```

唯一需要添加的是，如果起始页小于 1，或者结束页大于最终页，则需要填充 10 个结果。

最后，您需要处理没有 11 页结果的情况！

```
var startingPage = currentPage - 5;
if (startingPage < 1) {
    startingPage = 1;
}

var endingPage = currentPage + 11;
if (endingPage > numberOfPages) {
    endingPage = numberOfPages;
} 
```

您现在有了循环的开始和结束来创建页面链接，当前页面在中间，除了在分页的开始和结束处。

```
for (int i = startingPage; i < endingPage; i++) 
```

您可以将硬编码值移出此代码并缩短生产代码中的表达式 - 我已经按照我认为会使概念变得最简单的方式完成了一些事情。

我还建议将此逻辑移动到一个辅助类中，如果您有多个需要此逻辑的页面，该类可以在您需要的任何地方创建页面链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:47:48.237

您始终可以使用 WebHelpers 类中的 WebGrid Helper（在 NuGet 上可用），它会为您提供所需的一切，包括分页，然后您只需要使用 css 对其进行样式设置。

一个很好的参考是：[http ://www.dotnetcurry.com/ShowArticle.aspx?ID=618](http://www.dotnetcurry.com/ShowArticle.aspx?ID=618)

# java - 返回的接口对象如何声明其方法

> ID：12277574
> 
> 赞同：0
> 
> 时间：2012-09-05T08:42:52.037
> 
> 标签：java, interface

这感觉像是一个愚蠢的问题，但它让我更加恼火，因为我不明白这些方法是在哪里声明的。在我的代码中，我可以做类似的事情（显然这是一个伪代码）

```
ResultSet rs = DB.getConnection.sendSQL(select * from [table]) 
```

我知道 SQL 的发送返回一个“结果集”，虽然“结果集”只是一个接口，但返回的对象实现了该接口。

我的问题是返回的对象如何实现该接口？从我读到的接口只能定义一个方法签名，而不是一个完整的功能。

那么函数在哪里定义呢？显然不在 ResultSet 界面中！我是否正确理解这是数据库驱动程序的工作？（我想我可能刚刚回答了我自己的问题）。

我可以用功能齐全的方法编写接口吗？然后任何实现类会自动实现该方法，还是我只是通过调用“super”或其他东西来覆盖它？

我刚刚在 SO 上找到了另一个问题 [，预定义接口（如 Connection、Statement 等）的抽象方法如何在没有正文的情况下执行某些任务？](https://stackoverflow.com/questions/7811265/how-does-abstract-method-of-predefined-interface-like-connection-statement-etc?rq=1) 这是一个完美的副本，但更好地制定。和一个很好的答案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:44:25.023

> 我的问题是返回的对象如何实现该接口？

```
class ResultSetImpl implements ResultSet { ... } 
```

> 从我读到的接口只能定义一个方法签名，而不是一个完整的功能。那么函数在哪里定义呢？明显不在ResultSet界面！

在返回的对象中。在点;-)

这是*非常*基本的Java。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T08:48:01.007

实现接口的类负责声明接口中的所有方法，并在适当的情况下实现这些方法的内部逻辑。

界面本质上是说“你必须为此提供功能，但我不在乎你是*如何*做到的。你只需要接受这些类型的输入并提供这种类型的输出。” 该类是您实现如何从输入到输出的地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T08:56:09.570

让我们看下面的场景：

我们有一个接口：

```
public interface Expendable(){
  public void expend();
} 
```

以及一个实现它的类：

```
public class MyClass implements Expendable(){
  public void expend(){
//Do something
}
} 
```

另一个类在方法中返回一个实现我们接口的对象：

```
public class OtherClass(){
  public Expendable myMethod(){
   return new MyClass();
}
} 
```

`OtherClass myMethod``Class`返回一个实现接口的对象（光看方法返回类型我们不知道它是什么） `Expendable`。当前的 Expend 方法是在 myMethod 返回的实际类中定义的。在这种情况下，如果您这样做，则调用的方法

```
new OtherClass.myMethod().expend(); 
```

是 MyClass 扩展方法。

# c# - XML 中的非法字符

> ID：12277580
> 
> 赞同：3
> 
> 时间：2012-09-05T08:43:34.587
> 
> 标签：c#, xml

我有一个用 C# 编写的 .NET 应用程序，它以 XML 格式保存信息。应用程序将应用程序数据序列化为 xml。该应用程序包含一个文本框，用户可以在其中自由输入任何文本。我有一些用户设法输入字符的情况，主要是当他们将文本从其他应用程序复制并粘贴到文本框中时，xml 文档会损坏。是否有一种通用方法来管理 xml 文档中的非法字符，而不必在输入的每个文本框中将它们过滤掉。

来自损坏的文档的样本

```
<Propery>
  <Name>&#x8;Alimentação Controlador</Name>
  <Value>24</Value>
  <Unit>Vca</Unit>
</Propery> 
```

文档使用 ASCIIEncoding.UTF8 进行序列化

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T09:02:30.130

我认为你最好的选择是“SafeEncode”用户输入的字符串。此链接[http://msdn.microsoft.com/en-us/library/system.security.securityelement.escape(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.security.securityelement.escape(VS.80).aspx)向您展示了如何通过一次调用 SecurityElement.Escape(string s ） 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-10T08:27:26.493

您应该将以下非法字符替换为：

> `&lt;`(<)
> 
> `&amp;`(&)
> 
> `&gt;`(>)
> 
> `&quot;`(")
> 
> `&apos;`(')

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T09:07:11.920

如果您希望使用 CDATA，您甚至可以使用这个“有罪的”字符

[看这里](http://www.w3schools.com/xml/xml_cdata.asp)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-05T09:12:58.820

您应该使用 JTMon 建议的最佳实践。

我在导出到 XML 时也遇到了同样的情况。我不知道它是否适合您，但尝试使用它`stringbuilder`来`string`生成 xml。

你也可以试试这个

```
i.SubItems[0].Text.Trim('\0') 
```

希望它会有所帮助。

# jquery - 使用 BlockUI 延迟页面变灰

> ID：12277581
> 
> 赞同：1
> 
> 时间：2012-09-05T08:43:38.803
> 
> 标签：jquery, blockui

当某些操作可能需要一些时间才能在服务器上执行时（它执行多个数据库查询，但这并不重要），我正在使用 BlockUI 和 jQuery 来阻止对页面的访问。这些动作大多是快速执行的，并且时不时地需要几秒钟。以免不顺。闪烁：

是否可以： - 启动 ajax 请求以执行操作 - 不可见地阻止 UI - 如果 500 毫秒（设置）后没有答案，请重新阻止 UI，现在变灰等 - 完成后/出错时，取消阻止 UI。

我应该如何做这样的事情，或者我应该做不同的事情，还是有另一个插件可以开箱即用地执行这个？

目前我使用以下代码来生成效果：

```
DoRequest = function( param, name ) {
    $.blockUI( { message: null, fadeIn: 0, fadeOut: 0, overlayCSS: { opacity: 0.0 } } );
    blockUIPhase1 = setTimeout( function(){ 
        $.unblockUI( { fadeOut: 0 } );
        $.blockUI( { message: "Even geduld a.u.b.", overlayCSS: { opacity: 0.0 } } );
    }, 1000 );
    $.ajax( {
        url:        "screen.json",
        dataType:   'json',
        success: function( data ) {
            // ....
        },  
        complete: function() {
            if ( blockUIPhase1 != undefined ) clearTimeout( blockUIPhase1 );
            $.unblockUI( { fadeOut: 0 } );
        }
    } ); 
```

# javascript - JavaScript 代码不在 Base64 文档中执行

> ID：12277590
> 
> 赞同：1
> 
> 时间：2012-09-05T08:43:51.083
> 
> 标签：javascript, html, base64, execution

我了解到我可以以 Base64 URL 的形式打开各种文档，如本文最后一行所示。到目前为止，我可以打开一个 HTML 文档，但它包含 JavaScript，我无法执行我的函数`rr()`，该函数是通过单击**“创建新表单”**按钮调用的。我正在使用 Firefox 16 并安装了 NoScript。据我所知，我已经让它允许`file://`和`data：URLs。但是不知道为什么点击按钮不能执行该功能，但是从浏览器的地址栏运行就可以执行。我应该检查什么问题或可能的问题？

```
<html>
    <title>about:2012-09-04</title>
    <script>
        function rr() {
            var r=document.location;
            //This is to make r stop pointing
            //to the actual document.location object

            r+="";
            r=r.replace("data:text/html;base64,","");
            r=atob(r);
            //r=r.replace(/.+/,"{}")

            r=r.replace(document.title, "about:"+document.getElementById("datetitle").value);
            r="data:text/html;base64,"+btoa(r);

            window.open(r,"_blank");
            document.getElementById("urlnew").value=r;
        }
    </script>
    <body>
        <form target='_blank' action='http://google.com/search' method='get'>
            <input type='text' name='q' />
            <input type='hidden' name='tbs' value='qdr:d' />
            <input type='submit' />
        </form>
        <br /><br />
        ____________________________________
        <br />
        Date: <input type="text" id="datetitle" /><br />
        URL: <input type="text" length="25" id="urlnew" /><br />
        <input type="button" onclick="javascript:rr()" value="Create New Form" />
    </body>
</html> 
```

和base64编码：

```
<code>data:text/html;base64,77u/PGh0bWw+DQogPHRpdGxlPmFib3V0OjIwMTItMDktMDQ8L3RpdGxlPg0KDQoNCg0KDQogPHNjcmlwdD4NCiBmdW5jdGlvbiBycigpDQogew0KICB2YXIgcj1kb2N1bWVudC5sb2NhdGlvbjsNCiAgICAvL1RoaXMgaXMgdG8gbWFrZSByIHN0b3AgcG9pbnRpbmcNCiAgICAvL3RvIHRoZSBhY3R1YWwgZG9jdW1lbnQubG9jYXRpb24gb2JqZWN0DQogICAgLy8vDQogICAgICByKz0iIjsNCg0KICAgICAgcj1yLnJlcGxhY2UoImRhdGE6dGV4dC9odG1sO2Jhc2U2NCwiLCIiKTsNCiAgICAgIHI9YXRvYihyKTsNCg0KLy8gICAgICByPXIucmVwbGFjZSgvLisvLCJ7fSIpDQogICAgICByPXIucmVwbGFjZShkb2N1bWVudC50aXRsZSwgImFib3V0OiIrZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRhdGV0aXRsZSIpLnZhbHVlKTsNCiAgICAgIHI9ImRhdGE6dGV4dC9odG1sO2Jhc2U2NCwiK2J0b2Eocik7DQoNCiAgd2luZG93Lm9wZW4ociwiX2JsYW5rIik7DQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ1cmxuZXciKS52YWx1ZT1yOw0KIH0NCiA8L3NjcmlwdD4NCg0KIDxib2R5Pg0KICA8Zm9ybSB0YXJnZXQ9J19ibGFuaycgYWN0aW9uPSdodHRwOi8vZ29vZ2xlLmNvbS9zZWFyY2gnIG1ldGhvZD0nZ2V0Jz4NCiAgIDxpbnB1dCB0eXBlPSd0ZXh0JyBuYW1lPSdxJyAvPg0KICAgPGlucHV0IHR5cGU9J2hpZGRlbicgbmFtZT0ndGJzJyB2YWx1ZT0ncWRyOmQnIC8+DQogICA8aW5wdXQgdHlwZT0nc3VibWl0JyAvPg0KICA8L2Zvcm0+PGJyIC8+PGJyIC8+DQoNCiBfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX188YnIgLz4NCiBEYXRlOiA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9ImRhdGV0aXRsZSIgLz48YnIgLz4NCiBVUkw6IDxpbnB1dCB0eXBlPSJ0ZXh0IiBsZW5ndGg9IjI1IiBpZD0idXJsbmV3IiAvPjxiciAvPg0KIDxpbnB1dCB0eXBlPSJidXR0b24iIG9uY2xpY2s9ImphdmFzY3JpcHQ6cnIoKSIgdmFsdWU9IkNyZWF0ZSBOZXcgRm9ybSIgLz4NCiA8L2JvZHk+DQo8L2h0bWw+</code> 
```

# java - 为什么minor GC这么频繁

> ID：12277594
> 
> 赞同：4
> 
> 时间：2012-09-05T08:44:00.007
> 
> 标签：java, garbage-collection, jvm

这是我的 JVM 参数：

```
> /usr/local/java/bin/java -Xloggc:log/gc.log -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=70 -XX:PermSize=64m -XX:MaxPermSize=64m -Xss128K -server -Xmn1024m -Xms3027m -Xmx3027m -Dresin.home=/usr/local/resin 
```

我用的是Resin，上面是Resin启动JVM参数，下面是我使用jstat -gcutil pid 1000 1000时的GC输出

```
 S0     S1     E      O      P     YGC     YGCT    FGC    FGCT     GCT   

  0.00   1.60  46.21  25.62  21.69  72639  941.082    31    0.275  941.357

  1.51   0.00  51.91  25.63  21.69  72640  941.093    31    0.275  941.368

  0.00   1.87  62.96  25.64  21.69  72641  941.104    31    0.275  941.379

  1.51   0.00  86.39  25.65  21.69  72642  941.114    31    0.275  941.389

  0.00   1.56  94.28  25.65  21.69  72643  941.126    31    0.275  941.401

  0.00   1.45   5.03  25.67  21.69  72645  941.146    31    0.275  941.421

  1.74   0.00  18.76  25.68  21.69  72646  941.158    31    0.275  941.433

  0.00   1.85  37.51  25.69  21.69  72647  941.169    31    0.275  941.443

  1.59   0.00  53.58  25.70  21.69  72648  941.180    31    0.275  941.455

  0.00   1.74  74.02  25.71  21.69  72649  941.192    31    0.275  941.467 
```

我们可以找到大约每秒一次的minor GC，我觉得它很频繁，因为我的新Edanz 大小是1g。为什么这么频繁或者这是正常的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T08:47:35.577

要么你的 Eden 大小不是 1 GB，要么你正在创造一个令人难以置信的垃圾。由于您似乎没有设置 Eden 大小，因此怀疑它比您想象的要小得多。

尝试使用`jstat -gccause`来查看尺寸。

我怀疑您一直在阅读[http://www.caucho.com/resin-3.0/performance/jvm-tuning.xtp](http://www.caucho.com/resin-3.0/performance/jvm-tuning.xtp)，它错误地指出`-Xmn`设置了伊甸园空间。;)

该`-Xmx`选项设置最大总堆大小（年轻和老）

该`-Xmn`选项设置由伊甸园空间和两个幸存者空间组成的年轻代的大小。由于您的幸存者空间似乎不是很满，我怀疑它们占年轻一代 1 G 的大部分。

[http://www.oracle.com/technetwork/java/javase/tech/exactoptions-jsp-141536.html](http://www.oracle.com/technetwork/java/javase/tech/exactoptions-jsp-141536.html)

尝试将其设置`-XX:SurvivorRatio=`为 10 之类的值，而 1 GB 的大部分将是 Eden 空间。

[http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html](http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html)

# rest - 使用 jersey 与 RESTful Web 服务进行服务器推送

> ID：12277606
> 
> 赞同：0
> 
> 时间：2012-09-05T08:44:36.227
> 
> 标签：rest, jersey, server-push

我有一个使用 RESTful jersey 的 Web 服务器，它可以工作，但有时我需要服务器推送。服务器如何使用 Java 推送球衣？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:22:14.437

您可以在 Web 服务器上使用 websockets 将数据推送到客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T14:38:21.613

看看[Atmosphere/Jersey 双向对话](https://stackoverflow.com/questions/8230682/atmosphere-jersey-bidirectional-conversation)。REST 是无状态的，所以我不确定 Jersey 是否适合将数据从服务器流式传输到客户端。也许只是普通的彗星就足够了，在与泽西应用程序相同的容器中运行：http: [//tomcat.apache.org/tomcat-7.0-doc/aio.html](http://tomcat.apache.org/tomcat-7.0-doc/aio.html)？

# c# - C#：名称在当前上下文中不存在

> ID：12277607
> 
> 赞同：0
> 
> 时间：2012-09-05T08:44:37.083
> 
> 标签：c#, .net

[在阅读本教程](http://www.homeandlearn.co.uk/csharp/csharp_s3p7.html)时，我无法弄清楚我的错误。

以下输出：

```
Warning    1    Possible mistaken empty statement    (Line    32)
Error    2    The name 'i' does not exist in the current context    (Line    35)
Error    3    The name 'i' does not exist in the current context    (Line    36) 
```

使用以下代码获得：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace Loops
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void label1_Click(object sender, EventArgs e)
        {
        }

        private void btnForLoops_Click(object sender, EventArgs e)
        {
            int loopStart;
            int loopEnd;
            int answer;
            //store the numbers from the text boxes into the two new variables:
            loopStart = int.Parse(tbLoopStart.Text);
            loopEnd = int.Parse(tbLoopEnd.Text);
            for (int i = loopStart; i <= loopEnd; i++) ; 
            {
                answer = answer + i;
                listBox1.Items.Add("i = " + i + "answer = " + answer.ToString()); //the display shows as i=1 answer = 1, i=2 answer = 3, etc...
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T08:46:01.793

```
 for (int i = loopStart; i <= loopEnd; i++) ;
                                            ^ 
```

末尾的分号应该去掉。否则，编译器会将其视为循环的结束，并且您`int i`仅存在于循环本身中。

因此错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T08:46:02.800

你有一个`;`后`for`循环。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T08:46:48.213

; 在for循环之后，将其取出。

# javascript - 如何在javascript中拆分值并存储在不同的变量中

> ID：12277611
> 
> 赞同：0
> 
> 时间：2012-09-05T08:44:47.387
> 
> 标签：javascript

我的代码有一个包含多个值的变量，例如： `var GlobalOpportunityTypeID="8|9|10"`

我想根据我的要求将此值拆分为不同的变量。我怎样才能做到这一点？谁能告诉我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:50:08.143

使用[split()](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/split)将值拆分为一个数组，然后[将数组解包为 variables](https://stackoverflow.com/questions/3422458/unpacking-array-into-separate-variables-in-javascript)。

```
var ids = GlobalOpportunityTypeID.split("|");
var id0 = ids[0],
    id1 = ids[1],
    id2 = ids[2]; 
```

如果变量的数量是未知的或动态的，那么您最好处理数组本身而不是将它们提取到单个变量中。

# c# - 字符串包含多个单词

> ID：12277613
> 
> 赞同：0
> 
> 时间：2012-09-05T08:44:53.260
> 
> 标签：c#, string, contains

在我的项目中，我有一个`StringBuilder`下拉列表的选定值。

```
StringBuilder builder = new StringBuilder();
builder.Append(ddl_model.SelectedValue);
builder.Append(ddl_language.SelectedValue);

foreach (string str in list)
{
    if (str.Contains(builder.ToString()))
    {
        lstpdfList.Items.Add(str);
    }
} 
```

它适用于一个值。我想让我可以检查是否包含两个或多个单词。

我有一个像 PM12_Manual_Rev1_EN 这样的文件。现在我可以找到它是否包含 PM12。但是有很多。所以我想检查是否包含 PM12 + EN。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T08:56:39.503

1）不要在foreach内部调用builder.ToString()，它每次都会重建字符串，这违背了StringBuilder的性能目的。

2）不要使用 StringBuilder，使用 List 来存储要匹配的单词，如果每个选定的值可能包含多个单词，请将它们拆分：

```
var keywords = new List<string>();
keywords.AddRange(ddl_model.SelectedValue.Split(' '));
keywords.AddRange(ddl_language.SelectedValue.Split(' '));

foreach(string str in list)
   if (keywords.Any(keyword => str.Contains(keyword))
      lstpdfList.Items.Add(str); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:57:12.200

你可以[使用正则表达式](https://stackoverflow.com/questions/2433998/system-stringcomparer-that-supports-wildcard)。

```
 string testString ="PM12_Manual_Rev1_EN";       

    var wordRegex = new Regex( "PM12.*EN", RegexOptions.IgnoreCase );

    if (wordRegex.IsMatch( testString ))
    {
        Console.WriteLine("we've found multiple matches, REGEX edition");       
    } 
```

或者您可以像这样将包含与 Linq 一起使用：

```
 string testString ="PM12_Manual_Rev1_EN";

    var checkWords = new List<String>() {"PM12", "EN"};
    if(checkWords.All(w => testString.Contains(w)))
    {
        Console.WriteLine("we've found multiple matches");      
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T09:02:21.060

您应该使用 String.Contains 方法，这是最简单的方法！它返回一个值，指示指定的 String 对象是否出现在此字符串中。

@Shaks 是对的。

# c# - 使用线程池

> ID：12277614
> 
> 赞同：0
> 
> 时间：2012-09-05T08:44:58.493
> 
> 标签：c#, threadpool

它是对这个问题的跟进。

[https://stackoverflow.com/questions/12260170/how-to-make-a-threadpool-to-be-nonblocking](https://stackoverflow.com/questions/12260170/how-to-make-a-threadpool-to-be-nonblocking)

我已经使用接口实现了它。我已经使用 Action/deleages 和使用接口使它成为非阻塞的。.net 中是否有任何其他方法可以使下面的代码成为非阻塞的？？？接口实现如下。在任何时候，我都应该只有三个函数 Main、FuncA 和 FuncB

如果有人可以提供帮助。将不胜感激。谢谢你。

```
using System;
using System.Threading;

namespace ConsoleApplication2
{
    public interface IOperation
    {
        void CallBack(int i);
    }

    public class FuncBCalculation
    {
        public int N { get { return _n; } }
        private int _n;

        public int MyValue { get; set; }
        public FuncBCalculation(int n)
        {
            _n = n;
        }

        // Wrapper method for use with thread pool.
        public void FuncB(object context)
        {
            IOperation FuncBcallback = (IOperation)context;
            Thread.Sleep(5);
            MyValue = _n + 2;
            FuncBcallback.CallBack(MyValue);
        }
    }

    public class ActualClass : IOperation
    {
        int Finalvalue = 0;
        public static IOperation MainThreadCallBack { get; set; }

        public void FuncA(int input, int i, IOperation callback)
        {
            input += 1;
            var f = new FuncBCalculation(input);
            MainThreadCallBack = callback;
            IOperation op = new ActualClass();
            ThreadPool.QueueUserWorkItem(f.FuncB, op);

        }

        //Method for callback operation
        public void CallBack(int i)
        {
            Finalvalue = i + 3;
            if (MainThreadCallBack != null)
                MainThreadCallBack.CallBack(Finalvalue);
        }
    }

    public class ThreadPoolExample : IOperation
    {
        static void Main()
        {
            ActualClass actualCall;
            const int TotalLoopCount = 1000;
            int input = 11;
            Console.WriteLine("launching {0} tasks...", TotalLoopCount);
            for (int i = 0; i < TotalLoopCount; i++)
            {
                IOperation op = new ThreadPoolExample();
                actualCall = new ActualClass();
                actualCall.FuncA(input, i, op);
            }
            Console.ReadKey();
        }

        //Method for callback operation for the main thread
        public void CallBack(int i)
        {
            Console.WriteLine("The final Result is {0}", i);
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T17:58:57.917

你可以像这样实现它：

```
class _Program
{
    public static int MyInput { get; set; }

    static void Main(string[] args)
    {
        int input = 11;
        for (int i = 0; i < 1000 ; i++)
        {
            MyInput = input + 1;
            FuncA(delegate(IAsyncResult result)
            {
                AsyncResult<Int32> funcBResult = result as AsyncResult<Int32>;
                Int32 value = funcBResult.EndInvoke() + 3;
                Console.WriteLine("Final value: " + value);
            }, null); ; // using callback method
        }
        Console.ReadLine();
    }

    public static IAsyncResult FuncA(AsyncCallback callback, Object state)
    {
        AsyncResult<Int32> result = new AsyncResult<int>(callback, state);
        ThreadPool.QueueUserWorkItem(FuncB, result);
        return result;
    }

    public static void FuncB(Object asyncResult)
    {
        AsyncResult<Int32> result = asyncResult as AsyncResult<Int32>;
        try
        {
            Int32 value = MyInput + 2;
            result.SetAsCompleted(false, value);
        }
        catch (Exception ex)
        {
            result.SetAsCompleted(false, ex);
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T10:24:11.740

找到了另一个答案，但问题是这里的订单可能会混淆。先加1，再加2 `FuncB`，再加3 `FuncA`！谁能纠正我？

```
public class MainClass
{
    public static List<int> finalResult = new List<int>();

    public static void FuncB(Object stateObject)
    {
            State state = stateObject as State;
            state.result += 2;
            MainClass.finalResult.Add(state.result);
            State.ThreadCount--;
    }

    public static void FuncA(Object stateObject)
    {
        State state = (State)stateObject;
        state.input += 1;
        State.ThreadCount++;
        ThreadPool.QueueUserWorkItem(new WaitCallback(FuncB), state);
        state.result = state.input + 3;
    }

    static void Main()
    {
        int TotalLoopCount = 1000;

        for (int i = 0; i < TotalLoopCount; i++)
        {
            State FuncAstate = new State();
            FuncAstate.input = 11;
            FuncA(FuncAstate);
        }

        while (State.ThreadCount > 0)
        {
            Console.WriteLine("Waiting for all the threads to terminate. Still {0} no of threads available in memory", State.ThreadCount);
            State.ThreadCount--;
            continue;
        }

       for (int i = 0; i < MainClass.finalResult.Count(); i++)
       {
              Console.WriteLine("The final Result {0}", MainClass.finalResult[i]);
        }

        Console.ReadKey();

    }
}
public class State
    {
        //public ManualResetEvent eventWaitHandle { get; set; }
        public int input { get; set; }
        public int result { get; set; }
        public int ThreadID { get; set; }
        //public ThreadStart threadState { get; set; }
        public static int ThreadCount { get; set; }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T12:33:54.273

```
public class State
{
    public int input { get; set; }
    public int result { get; set; }
    //public static int ThreadCount { get; set; }
    public bool FuncBSignalON { get; set; }
    //public static bool FuncAThreadON { get; set; }
   //public int TotalLoopCount { get; set; }
    //public int ThreadID { get; set; }
}

public class MainClass
{
    public static void FuncB(Object stateObject)
    {
        State state = stateObject as State;
        state.input += 2;
        state.FuncBSignalON = true;
        ThreadPool.QueueUserWorkItem(new WaitCallback(FuncA), state);
    }

    public static void FuncA(Object stateObject)
    {
        State state = (State)stateObject;
        if (!state.FuncBSignalON)
        {
            state.input += 1;
            ThreadPool.QueueUserWorkItem(new WaitCallback(FuncB), state);
        }
        else
        {
            state.result = state.input + 3;
            //FinalResult.Add(state.result);
            string[] stateResult = new string[1];
            stateResult[0] = state.result.ToString();
            //State.ThreadCount--;
            Main(stateResult);
        }
    }

    static void Main(string[] args)
    {
        if (args.Count() == 0)
        {
            int TotalLoopCount =1000; 
            for (int i = 0; i < TotalLoopCount; i++)
            {
                State FuncAstate = new State();
                FuncAstate.input = 11;
                //FuncAstate.TotalLoopCount = TotalLoopCount;
                //State.ThreadCount++;
                ThreadPool.QueueUserWorkItem(new WaitCallback(FuncA), FuncAstate);
            }
        }
        else
        {
          Console.WriteLine(args[0]);
        }
        Console.ReadKey();
    }

} 
```

终于明白了

# javascript - 使用 jQuery 删除动态创建的元素上的 mouseenter 事件

> ID：12277616
> 
> 赞同：3
> 
> 时间：2012-09-05T08:45:02.853
> 
> 标签：javascript, jquery, jquery-ui-sortable, jquery-events

在动态创建的元素上使用 jQuery UI 的可排序方法时，我的 Javascript 遇到了一些问题。当我将图像悬停时，它会显示缩略图中光标之后的图像的放大版本。然后，当我对图像进行排序/拖动时，它会显示较大的图像，其位置设置为远离缩略图。排序时应隐藏较大的图像:-)

我制作了一个筛选器，因此您更容易理解我的意思：[http ://screenr.com/jjv8](http://screenr.com/jjv8)

我用于连接事件的代码：

```
// Selected photos hover
$('ul li img').live('mouseenter', function () {
    var img = $(this);
    var imgDiv = $(this).parent().find('.hover-image');
    img.mousemove(function (e) {
        imgDiv.show();
        var x = e.pageX;
        var y = e.pageY - 50;
        imgDiv.css({ "top": y + "px", "left": x + "px" });
    });
});

$('ul li img').live('mouseleave', function () {
    $(this).parent().find('.hover-image').fadeOut('fast');
}); 
```

还有我的排序代码：

```
selectedPhotosList.sortable({
    handle: '.selected-thumbnail-image',
    start: function (event, ui) {
        ui.item.find('.selected-thumbnail-image').die('mouseenter');
        ui.item.find('.hover-image').hide();
    }
}); 
```

是的，我正在使用，`.live()`因为这是驻留在 Umbraco CMS 中的数据类型，它使用旧版本的 jQuery，所以`.on()`不起作用:-)

任何人都知道如何让它工作？

**编辑**

我发现了错误：

在我的......每次光标移动时`.live('mouseenter', function()`我都会打电话。`imgDiv.show();`

这样做是有效的：

```
// Selected photos hover
$('ul li img').live('mouseenter', function () {
    var img = $(this);
    var imgDiv = $(this).parent().find('.hover-image');
    imgDiv.show();
     img.mousemove(function (e) {
         var x = e.pageX;
         var y = e.pageY - 50;
         imgDiv.css({ "top": y + "px", "left": x + "px" });
     });
});

$('ul li img').live('mouseleave', function () {
    $(this).parent().find('.hover-image').fadeOut('fast');
}); 
```

但是，这会在使用 IE 时产生另一个错误。： Screenr：[http ://screenr.com/1Iv8](http://screenr.com/1Iv8)

悬停图像在实际触发 mousemove 功能之前显示一次：-/ 有什么方法可以否决这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:49:37.230

我建议：

`$('ul li img').off('mouseenter');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:47:42.747

.die() 应该适合你。[阅读关于它的文档](http://api.jquery.com/die/)

```
$('ul li img').die('mouseenter'); 
```

像这样的东西应该工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T10:35:36.347

找到了一个适用于 IE7+、Chrome 和 Firefox 的解决方案，虽然它有点难看（不确定这是否是轻描淡写 ;-)）：

在可排序的开始事件中，我创建了悬停图像的副本并将其存储在一个变量中，然后将其从 DOM 中删除。然后在停止事件中，我将它添加到已拖动/排序的列表项中。代码：

```
var tempHoverImage = "";
selectedPhotosList.sortable({
    handle: '.selected-thumbnail-image',
    start: function (event, ui) {
        var hoverImage = ui.item.find('.hover-image');
        tempHoverImage = hoverImage;
        hoverImage.remove();
    },
    stop: function (event, ui) {
        ui.item.prepend(tempHoverImage);
    }
}); 
```

# r - 将 .md 文件转换回 .Rmd

> ID：12277622
> 
> 赞同：3
> 
> 时间：2012-09-05T08:45:26.793
> 
> 标签：r, markdown, rstudio

也许是一个简单的问题，但我想知道是否有一个函数可以将`.md`文件重新转换回`.Rmd`最初创建它的文件，因为我似乎丢失了原始`.Rmd`文件，而不仅仅是复制和粘贴代码部分。该`.md`文件最初是使用`knit`RStudio 中的 to html 函数创建的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T10:51:51.293

I am not aware of a tool that does this out of the box. However, you could probably use a combination of the linux command line tools `grep` and `sed` to get the desired effect. I think this could be quite a lot of work to get working in a general sense, so copy/pasting in your case would be the fastest way.

# php - 从日期中删除小时、分钟和秒('r")

> ID：12277623
> 
> 赞同：-5
> 
> 时间：2012-09-05T08:45:31.880
> 
> 标签：php, date, mktime

我有一个使用这种格式的日期：

```
date("r",$dateMktime); 
```

在 $dateMktime 中，我只有年、月和日，我必须使用 date("r") 格式。

如何删除小时、分钟和秒？当我回显我的日期时，我不想看到 00:00:00。

任何想法 ？谢谢 ：）

编辑：我不能使用不同的格式，有义务使用 date('r')，我只能做 echo date("r",$dateMktime);

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:49:46.640

为什么不重新转换然后格式化？如果您“有义务”使用`r`?

```
$date = date("r", $dateMktime);
echo date('D, j M Y', strtotime($date)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:50:39.590

好吧，根据[date 的文档](http://de3.php.net/manual/en/function.date.php)，`date('r')`确实包括时间。改为使用`date('Y-m-d')`。如果无法更改，可以使用[字符串函数](http://de3.php.net/manual/en/book.strings.php)删除其余部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T08:50:46.330

```
$date=date("r",$dateMktime);
$d=explode(" ",$date);
$newdate=$d[0]." ".$d[1]." ".$d[2]." ".$d[3];
echo $date." - ".$newdate; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T09:04:48.023

你可以尝试类似的东西；

```
$dateMktime = "Thu, 21 Dec 2000 16:01:07 +0200";
$datearray = (explode(" ",$dateMktime));
echo $datearray[3];//this will return 2000 
```

您可以加入此数组的特定部分以获取您的自定义日期格式。例如;

```
echo $datearray[1]." ".$datearray[2]." ".$datearray[3];//this will return 21 Dec 2000 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-05T08:48:56.877

“r”只是给出格式为“Thu, 21 Dec 2000 16:01:07 +0200”的日期的快捷方式。

您可以使用其他格式字符串，有关详细信息，请参阅[http://php.net/manual/en/function.date.php](http://php.net/manual/en/function.date.php)。

试试`date("D, j M Y",$dateMktime);`。

如果您真的想使用`date("r",$dateMktime);`，请尝试：

```
implode(" ",array_slice(explode(" ",date("r",$dateMktime)),0,4)); 
```

这基本上只是分割空间，切出前 4 个标记，然后将它们重新连接起来。

# javascript - 在应用程序rails中找不到jquery自动完成

> ID：12277624
> 
> 赞同：0
> 
> 时间：2012-09-05T08:45:32.310
> 
> 标签：javascript, jquery, ruby-on-rails, autocomplete

我在一个 Rails 项目上工作，但我的 jquery 插件有问题：自动完成。我尝试实现一个包含多个单词的搜索引擎，我在我的网页中包含 1.8.0.min.js 和插件自动完成（jquery-ui-1.8.23.custom.min.js）以及下面的代码在另一个 .js 中还包括：

```
$(document).ready(function(){      
    var availableTags = [
    "ActionScript",
    "AppleScript",
    "Asp",
    "BASIC",
    "C",
    "C++",
    "Clojure",
    "COBOL",
    "ColdFusion",
    "Erlang",
    "Fortran",
    "Groovy",
    "Haskell",
    "Java",
    "JavaScript",
    "Lisp",
    "Scheme"
    ];
    function split( val ) {
    return val.split( /,\s*/ );
    }
    function extractLast( term ) {
    return split( term ).pop();
    }

    $( "#search" ).bind( "keydown", function( event ) {
    if ( event.keyCode === $.ui.keyCode.TAB &&
           $( this ).data( "autocomplete" ).menu.active ) {
           event.preventDefault();
        }
 })
     .autocomplete({
     minLength: 0,
        source: function( request, response ) {
        // delegate back to autocomplete, but extract the last term
        response( $.ui.autocomplete.filter(
        availableTags, extractLast( request.term ) ) );
        },
        focus: function() {
       // prevent value inserted on focus
       return false;
        },
        select: function( event, ui ) {
        var terms = split( this.value );
        // remove the current input
        terms.pop();
        // add the selected item
        terms.push( ui.item.value );
        // add placeholder to get the comma-and-space at the end
        terms.push( "" );
        this.value = terms.join( ", " );
        return false;
        }
    });
}); 
```

在我的应用程序中，这段代码不起作用，firebug 给我这个警告：

```
 TypeError: $("#search").bind("keydown", function (event) {if (event.keyCode === $.ui.keyCode.TAB && $(this).data("autocomplete").menu.active) {event.preventDefault();}}).autocomplete is not a function
    TypeError: $("#search").bind("keydown", function (e) {e.keyCode === $.ui.keyCode.TAB && $(this).data("autocomplete").menu.active && e.preventDefault();}).autocomplete is not a function 
```

当我在我的应用程序之外测试它时，它就可以工作。我在 Mandriva 12.04 TLS 上，并使用 firefox 15.0。

# android - 我的 android 应用程序崩溃了，我不知道为什么。我添加了所有权限，但仍然崩溃。

> ID：12277627
> 
> 赞同：-1
> 
> 时间：2012-09-05T08:45:44.487
> 
> 标签：android, service, broadcastreceiver

在系统启动时启动的接收器

公共类 BootBroadcastReciever 扩展 BroadcastReceiver {

```
@Override
public void onReceive(Context context, Intent intent) {

    Intent i = new Intent(context,SmsReceiver.class);
    context.startActivity(i);
} 
```

}

收听传入短信的接收者

```
public class SmsReceiver extends BroadcastReceiver {

    private String KEYWORD="GPS";

    @Override
    public void onReceive(Context context, Intent intent) {

        if (intent.getAction().equals("android.provider.Telephony.SMS_RECEIVED"))
        {

            Bundle bundle = intent.getExtras();

            if (bundle != null)
            {

                //Receiving messages

                try{
                     Object messages[] = (Object[]) bundle.get("pdus");        
                        SmsMessage smsMessage[] = new SmsMessage[messages.length];   

                        for (int n = 0; n < messages.length; n++) { 
                            smsMessage[n] = SmsMessage.createFromPdu((byte[]) messages[n]);
                            }

                                      /*Checking for a key word*/
                        if (smsMessage[0].getMessageBody().equalsIgnoreCase(KEYWORD))
                        {
                            Intent  in = new Intent(context, Service.class);
                            context.startService(in);
                        }

                }catch (Exception e){
                    Log.d("ERROR", e.getMessage());

                }
            }

        }

    }

}

package edu.na.aggas.comGpsService; 
```

当关键字出现在短信中时启动的服务

```
public class Service extends android.app.Service {

    @Override
    public IBinder onBind(Intent arg0) {
        return null;
    }

    @Override
    public void onCreate() {
        super.onCreate();
        Toast.makeText(this, "Service Created", Toast.LENGTH_LONG).show();

        LocationManager locMan = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
        LocationListener locListener = new mylocationListener();
        locMan.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, locListener);

    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        Toast.makeText(this, "Service Destroyed", Toast.LENGTH_LONG).show();
        disableGps();
    }

    @Override
    public void onStart(Intent intent, int startId) {

        super.onStart(intent, startId);
        Toast.makeText(this, "Service Started", Toast.LENGTH_LONG).show();
        enableGps();

    }

public void enableGps(){

        Intent intent = new Intent("android.location.GPS_ENABLED_CHANGE");
        intent.putExtra("enabled", true);
        sendBroadcast(intent);  
    }

    public void disableGps(){

        Intent intent = new Intent("android.location.GPS_ENABLED_CHANGE");
        intent.putExtra("enabled", false);
        sendBroadcast(intent);  
    }
         /*Inner class*/
    class mylocationListener implements LocationListener{

                       /*If the location changes get new coordinates*/
        @Override
        public void onLocationChanged(Location location) {

            if(location != null)
            {
                double plong = location.getLongitude();
                double plat = location.getAltitude();

                Toast.makeText(getBaseContext(), "Longitude: " + plong + "Latitude: " + plat, Toast.LENGTH_LONG).show();
            }
        }

        @Override
        public void onProviderDisabled(String provider) { 

        }

        @Override
        public void onProviderEnabled(String provider) {

        }

        @Override
        public void onStatusChanged(String provider, int status,Bundle extras) {

        }

    }

}

Xml

  <uses-sdk android:minSdkVersion="7" />
    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/>
    <uses-permission android:name="android.permission.RECEIVE_SMS"/>
    <uses-permission android:name="android.permission.READ_SMS"/>
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >

        <service android:name=".Service">
            <intent-filter>
                <action android:name = "edu.na.aggas.comGpsService.Service">
                </action>
            </intent-filter>      
        </service>

        <receiver android:name=".BootBroadcastReciever">
              <intent-filter>
                  <action android:name ="android.intent.action.BOOT_COMPLETED" />
                      <category android:name="android.intent.category.HOME" />
              </intent-filter>
        </receiver>

        <receiver android:name=".SmsReceiver">
            <intent-filter>
                <action android:name="android.provider.Telephony.SMS_RECEIVED" />
            </intent-filter>
        </receiver>

    </application> 
```

谁能告诉我问题出在哪里以及如何解决......？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:50:30.290

您必须将消息发送到 BroadcastReciever 所以

用这个

```
@Override
public void onReceive(Context context, Intent intent) {

    Intent i = new Intent(context,SmsReceiver.class);
    context.sendBroadcast(i);

} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-05T08:51:05.203

如果您可以从 LogCat 添加日志，我们可以为您提供更好的帮助。但是首先，您是否在清单文件中添加了以下代码：

```
<receiver android:name="BootBroadcastReciever" >

    </receiver> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-05T08:53:55.500

**Toast.makeText(this, "服务创建", Toast.LENGTH_LONG).show();**

您不能从服务中显示 Toast，要显示 Toast，您需要有活动上下文。因此，注释掉所有 Toast 语句并尝试。

# java - 如何将以下代码段转换为 JSP

> ID：12277637
> 
> 赞同：0
> 
> 时间：2012-09-05T08:46:11.223
> 
> 标签：java, jsp, logout

```
public class LoginFilter implements Filter {
    @Override
    public void doFilter(ServletRequest req, ServletResponse res,
                         FilterChain chain) throws IOException,
                                                   ServletException {
        HttpServletRequest request = (HttpServletRequest)req;
        HttpServletResponse response = (HttpServletResponse)res;
        HttpSession session = request.getSession(false);
        if (session == null ||
            session.getAttribute("currentSessionUser") == null) {
            response.sendRedirect("Loginpage.jsp"); // No logged-in user found, so redirect to login page.
            response.setHeader("Cache-Control",
                               "no-cache, no-store, must-revalidate"); // HTTP 1.1.
            response.setHeader("Pragma",
                               "no-cache"); // HTTP 1.0\.                 response.setDateHeader("Expires", 0);
        } else {
            chain.doFilter(req,
                           res); // Logged-in user found, so just continue request.
        }
    }
} 
```

我想在jsp中使用上面的代码来强制用户在注销后重定向登录页面我们如何将它转换为jsp以便我可以将它包含在我的jsp页面中。我像下面这样写它，通过这样做我们可以调用那个`chain.filter()`方法

```
<%@ page import=" java.io.IOException"%>
<%@ page import="javax.servlet.Filter"%>
<%@ page import="javax.servlet.FilterChain"%>
<%@ page import="javax.servlet.FilterConfig"%>
<%@ page import="javax.servlet.ServletException"%>
<%@ page import="javax.servlet.ServletRequest"%>
<%@ page import="javax.servlet.ServletResponse"%>
<%@ page import="javax.servlet.http.HttpServletRequest"%>
<%@ page import="javax.servlet.http.HttpServletResponse"%>
<%@ page import=" javax.servlet.http.HttpSession"%>
<%@ page import="javax.servlet.annotation.WebFilter"%>
<%
    //@Override         
    HttpServletRequest req = (HttpServletRequest) request;
    HttpServletResponse res = (HttpServletResponse) response;
    HttpSession session = req.getSession(false);
        if (session == null || session.getAttribute("userHash") == null)
        {  
        res.sendRedirect("/timescape/applicationservices/fileshare/vm/login/login.jsp"); // No logged-in user found, so redirect to login page.
        res.setHeader("Cache-Control", "no-cache, no-store, must-revalidate"); // HTTP 1.1\. 
        res.setHeader("Pragma", "no-cache"); // HTTP 1.0.
        res.setDateHeader("Expires", 0);
        } 
        else
          {
          chain.doFilter(request, response); // Logged-in user found, so just continue request. 
          }

    %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:51:35.460

假设您只需要 JSP 中的重定向，您可以轻松地做到这一点：

```
<%
if (session == null || session.getAttribute("currentSessionUser") == null) {
    response.sendRedirect("Loginpage.jsp"); // No logged-in user found, so redirect to login page.                  
    response.setHeader("Cache-Control", "no-cache, no-store, must-revalidate"); // HTTP 1.1\.                 
    response.setHeader("Pragma", "no-cache"); // HTTP 1.0.
    response.setDateHeader("Expires", 0);
    return;
}
%> 
```

这是因为在 JSP 中，总是有一个包含对象的隐式变量被调用`response`，[`HttpServletResponse`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletResponse.html)并且**总是**`session`有一个包含对象的隐式变量被调用[`HttpSession`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpSession.html)。

# vb.net - 读取和写入日志文件

> ID：12277640
> 
> 赞同：0
> 
> 时间：2012-09-05T08:46:25.403
> 
> 标签：vb.net, streamreader

我有一个程序，其中有几个并行进程写入日志文件，主程序也在读取日志并将其汇集到文本字段中。

问题是，到了一定程度，我错过了日志并且总是读取 0 字节，尽管进程继续写入它。这是我的阅读器子，一段时间后，*Dim n As Integer = stream.Read(bytes, numBytesRead, numBytesToRead)*行总是给出 0：

```
Public Function readFile(ByRef stream As FileStream) As String
    Dim bytes() As Byte = New Byte((stream.Length) - 1) {}
    Dim numBytesToRead As Integer = CType(stream.Length, Integer)

    Dim numBytesRead As Integer = 0
    While (numBytesToRead > 0)
        ' Read may return anything from 0 to numBytesToRead. 
        Dim n As Integer = stream.Read(bytes, numBytesRead, numBytesToRead)
        ' Break when the end of the file is reached. 
        If (n = 0) Then
            Exit While
        End If
        numBytesRead = (numBytesRead + n)
        numBytesToRead = (numBytesToRead - n)

    End While
    numBytesToRead = bytes.Length

    Return Encoding.UTF8.GetString(bytes)
End Function 
```

*流*参数是一个全局变量（对主 Winform 来说是全局的），声明为：

```
Private FSReaderLog As FileStream 
```

并初始化（仅在表单加载中）如下所示，打开流和中继文件内容：

```
Public Function InitLog(ByVal ruta_fichero As String) As FileStream
    Dim FS As New FileStream(ruta_fichero, FileMode.OpenOrCreate, FileAccess.ReadWrite, FileShare.ReadWrite)
    FS.SetLength(0)
    FS.Flush()
    Return FS
End Function 
```

读者有什么问题？

谢谢

# javascript - 无法从活动中调用 javascript 函数

> ID：12277644
> 
> 赞同：0
> 
> 时间：2012-09-05T08:46:37.183
> 
> 标签：javascript, android, android-activity

```
WebView myWebView = (WebView) findViewById(R.id.webview);                
    WebSettings webSettings = myWebView.getSettings();
    webSettings.setJavaScriptEnabled(true);
    webSettings.setPluginsEnabled(true);        
    myWebView.loadUrl("file:///android_asset/index.html");
    myWebView.loadUrl("javascript:hello()"); 
```

它不适用于 4.0 模拟器或真实设备。我在 html 中有适当的标签

`<script type="text/javascript">..</script>`

我可以毫无问题地从firefox的控制台触发它（它不调用警报命令，我知道它在android中不起作用）

我没有解决方案，请帮助我。

顺便说一句，这个函数调用在这里似乎没用，因为它是用于测试的，如果可行，我稍后会给出一个参数。

编辑：

```
<h1 id="title"></h1>
....

<script type="text/javascript">
function hello()
{
  console.log("hello"); 
  var title = document.getElementById("title");
  title.innerHTML = "hello";    
}
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T09:19:57.213

问题是当您调用 javascript 时，不能保证页面已经加载。确保仅在页面完全加载时调用 javascript 函数。

下面的代码（引自[http://lexandera.com/2009/01/injecting-javascript-into-a-webview/](http://lexandera.com/2009/01/injecting-javascript-into-a-webview/)）会给你一个提示。

```
final WebView webview = (WebView)findViewById(R.id.browser);
/* JavaScript must be enabled if you want it to work, obviously */
webview.getSettings().setJavaScriptEnabled(true);

/* WebViewClient must be set BEFORE calling loadUrl! */
webview.setWebViewClient(new WebViewClient() {
    @Override
    public void onPageFinished(WebView view, String url)
    {
        webview.loadUrl("javascript:(function() { " +
                "document.getElementsByTagName('body')[0].style.color = 'red'; " +
                "})()");
    }
});

webview.loadUrl("http://code.google.com/android"); 
```

# google-maps - 如何获得沿 GMaps 方向的坐标？

> ID：12277645
> 
> 赞同：0
> 
> 时间：2012-09-05T08:46:38.820
> 
> 标签：google-maps, gps, geocoding, kml

我想为远足路径创建在线地图，并且一直在使用智能手机从中收集坐标。

我有很多关于制作此类曲目的良好做法的问题，但对于初学者来说：*如果我可以编辑读数以便它们位于谷歌地图中的任何道路上，它看起来会更整洁。*我怎样才能做到这一点？
编辑：我想找到坐标，使沿着道路的轨迹看起来就像我正在使用捕捉/方向一样，即使我不是。

我尝试过 QLandkarte GT 和 Viking 等工具，使用后者，我能够手动删除多余的坐标并移动剩余的坐标，以便它们正好位于道路顶部（在 Viking 内部，使用 OpenStreetMap）。但是，当我在 Google 地图中加载已编辑的 .kml 文件时，道路的位置似乎略有不同，结果几乎没有编辑前好。

我尝试使用将 GMaps 方向导出为 .gpx 的 hack，以为我可以在道路上插入 Google 自己的坐标。但是导出的文件只有转折点的坐标，这些转折点之间有直线。

QLandkarte GT[据说](https://stackoverflow.com/questions/8625439/track-editor-with-snap-to-track-function)有一个快速道路功能（请参阅链接中的答案），但我还没有找到它，我也不知道如何获得该地区的矢量图。

然后是人们似乎使用的谷歌地球，但我再次找不到任何轨道编辑功能（在免费版本中）。

**简而言之**：
我如何编辑我现有的轨道，使其与 GMaps 中的道路相匹配......
或者
我如何获得代表 GMaps 中道路的新轨道......

...因此，当在 GMaps 中显示时，生成的轨迹与 Google 自己的方向或其他专业 GPS 数据一样平滑？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T17:29:45.017

毕竟，导出方向折线似乎可以从谷歌地图中获取这些坐标。我不确定如何，它似乎涉及将参数 output=dragdir 添加到链接中。

无论如何，有一个名为[GPS Visualizer](http://www.gpsvisualizer.com)的工具可以创建一个带有所需坐标的 .kml 文件。

编辑：只要它是唯一的，我会接受我自己的答案，但我仍然想知道更多。

# dynamics-crm - 如何在 CRM Dynamics 中复制整个数据库？

> ID：12277648
> 
> 赞同：0
> 
> 时间：2012-09-05T08:46:56.277
> 
> 标签：dynamics-crm, dynamics-crm-online

在我看来，在部署到客户之前在本地服务器上测试运行我的工作流程是一个明智的想法。完全可以肯定的是，我想将所有数据从他们的数据库复制到我的测试组织（我拥有完全访问权限）。问题是我看不到将整个 shabang 导出到 XML 电子表格的任何直接方法。

从/向数据库导出/导入**所有内容**的最佳方式是什么？源服务器和目标服务器**不**相同。

当然，我可以选择备份客户端数据库并恢复它，棕色的东西会不会影响风扇，但如果我不必这样做，它会更加专业。

客户的数据库在云中，这让我怀疑也许我根本无法访问它，而且据我所知，没有办法在那里备份数据。我错过了它还是那么**糟糕**？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T11:06:01.393

我完全同意这是明智的。通常我们的所有工作都有多个开发和测试服务器，但是通常我们不会完全镜像客户端数据库中的数据。

我们在我们的开发服务器中创建了一个具有代表性的数据样本，然后跨过 Crm 解决方案进行部署。

据我所知，没有直接的方法可以获取所有数据，如果您真的想这样做，我建议您备份他们的数据库并导入您的数据库。

（作为旁注，并非所有客户都乐于将他们的数据库副本 - 特别是如果它是一个实时系统 - 被带离现场。就个人而言，如果它是一个实时数据库，我不会把风险放在自己身上，如果数据丢失或泄漏您可能会遭受后果）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T11:36:42.983

James 对您的请求的业务方面提出了很好的观点，但是要掌握记录级别的数据，几乎没有选择。到目前为止，最简单的是底层 SQL 数据库的批量导出和导入。（作为记录，替代方法是将数据从实时迁移到不同的数据库，但这不是一项小任务，所以我什至不会在这里进一步讨论）。

您提到客户正在使用 CRM Online（“ *...客户的数据库在云中...* ”）。您可以向 CRM 在线支持提出（免费）支持请求，他们将为您提供 YourOrg_MSCRM 数据库的副本，然后可以将其重新导入到本地部署中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-10T13:38:15.013

如果您只想拥有一个包含 Microsoft CRM Online 组织副本的测试实例，Microsoft 确实提供了一种方法来做到这一点。根据客户拥有的专业用户许可证的数量，这可能是免费的，但可能需要额外付费，并且这两个实例都将计入 Microsoft CRM Online 的存储限制。您可以在此处查看完整详细信息 - [https://community.dynamics.com/crm/b/crmteamblog/archive/2014/03/20/introducing-sandbox-instances-in-crm-online.aspx](https://community.dynamics.com/crm/b/crmteamblog/archive/2014/03/20/introducing-sandbox-instances-in-crm-online.aspx)。您可以在此处查看有关如何设置沙盒实例的步骤 - [https://technet.microsoft.com/en-us/library/dn467371.aspx](https://technet.microsoft.com/en-us/library/dn467371.aspx)“将实例添加到您的订阅”。这是我与我们的一位 Microsoft CRM 客户一起使用的东西，因为它是帮助验证 Scribe Online 迁移和我们在将其投入生产之前所做的自定义更改的好方法。这样做的好处是所有内容仍然包含在同一个 Office 365 租户中，您可以限制哪些用户可以访问沙盒组织，这对于客户了解他们的数据是安全的而不是在某些未知的情况下很重要服务器或机器。

# javascript - 如何防止浏览器中的页面“抖动”

> ID：12277649
> 
> 赞同：0
> 
> 时间：2012-09-05T08:46:56.747
> 
> 标签：javascript, css, google-chrome, safari, usability

这是什么“抽搐” - 在此页面上向右滚动到顶部，然后如果您使用的是 Mac，请使用两根手指向上滚动更多...页面将进一步向上滚动（页面向下移动）显示灰色区域和将手指从触摸板上抬起后弹回。

问题是如何使用 CSS 或 JavaScript 防止这种“抽搐”效果？

我知道这是可能的，因为如果你去 facebook 或 pinterest 并点击一张图片，你会得到一个灯箱。在那个灯箱“模式”中，你不会得到这种“抽搐”效果。

我最初认为这与灯箱或 css 固定定位有关，但即使在[http://lokeshdhakar.com/projects/lightbox2/](http://lokeshdhakar.com/projects/lightbox2/) “模式”中，它仍然是“混蛋”。fb 和 pinterest 是如何做到的？

附言。使用铬或野生动物园。firefox 没有这个效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:07:15.440

Facebook 似乎通过在显示图片时在文档正文上设置 CSS 属性“溢出：隐藏”来实现这一点。我刚刚通过将以下 CSS 添加到 HTML 文件中自己测试了它，并且禁用了反弹滚动。

```
<style type="text/css">
body {
    overflow: hidden;
}
</style> 
```

当然，这将完全阻止您的页面滚动。我同意 Quentin 的观点，这是标准的 UI 行为，除非你有充分的理由，否则你不应该改变它。

# php - 表格中的 PHP curl 排序链接

> ID：12277650
> 
> 赞同：1
> 
> 时间：2012-09-05T08:47:04.907
> 
> 标签：php, curl, web-scraping

我有一张从我​​的大学网站上抓取的表格。问题是页面只显示表格中的前 20 个元素。其余的都是隐藏的，只能通过 javascript 访问。

我只想要表格中的最新元素，因为表格有一个创建列。该表格具有可单击的标题，允许您按该特定标题对表格进行排序，例如：

```
 Name ---- type ---- created on 
```

我想通过 created on 订购它。我使用 php 和 curl 来获取在以下位置创建的 url：**https://vula.uct.ac.za/portal/tool/88e64ae9-c460-4acb-84b9-dac670a373b9?panel=Main&criterion=created on&sakai_action=doSort_sites**。

我得到的结果是原始的无序列表，如果一个人不是按特定列排序的话。如果我将该链接复制并粘贴到我的浏览器中，那么它会为我提供按升序排列的列表，然后**在**随后的 URL 粘贴中降序排列。

在我粘贴 URL 并在浏览器中执行后，页面呈现后显示给用户的 url 如下： **https ://vula.uct.ac.za/portal/tool/88e64ae9-c460-4acb- 84b9-dac670a373b9?panel=主要**

谁能看到我做错了什么？

# objective-c - Reach-ability 类是否继续在 iOS 开发中发送/接收数据？

> ID：12277651
> 
> 赞同：1
> 
> 时间：2012-09-05T08:47:04.967
> 
> 标签：objective-c, ios, power-management, reachability, network-monitoring

我已经在 Reachability 类上工作了一段时间，并尝试了 Apple 示例中的一个和 ddg 中的一个。我想知道启动通知程序后可达性类是否继续发送/接收数据。

由于我正在开发一个经常连接到不同主机的应用程序，因此我决定编写一个单例并在其上附加我需要的可达性类。一旦应用程序启动，将启动可响应性类并启动它们的通知程序。我使用单例方法是因为我希望这个单例类是可移植的，并且可以应用到其他应用程序而无需大量重写。我不确定这样实施是否是个好主意，但效果很好。

但是，有人报告说，使用该应用程序后，他的设备电池消耗得更快，并且有人报告说数据使用量更大。我的应用程序不会在后台发送/接收数据，所以我开始怀疑它是否与可达性有关。

我尝试使用 Instrument 分析能源使用情况，我注意到即使我的应用程序处于空闲状态，也有连续的小数据（平均几百字节）通过网络接口进入。但是，几乎没有数据发送出去。

我知道 Reachability 在启动（解析 DNS 等）时需要使用数据，但我不确定它在启动通知程序后是否仍继续使用数据。有谁可以告诉？

我不熟悉低级编程，如果有人能解释可达性是如何工作的，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:13:04.223

我使用可达性，虽然我没有监控连接，但我浏览了代码，我看不出它会继续发送（或接收）的任何原因。

如果您的 Mac 有以太网连接，则很容易检查。启用通过以太网连接的 wifi 共享。安装小飞贼，每次开机后都会在演示模式下运行三个小时。关闭测试设备上的数据连接并通过 wifi 将其连接到您的 mac。

这将允许您查看您的测试设备正在进行的任何网络访问。

如果这不可能，您也可以在模拟器中运行您的应用程序，因为网络端应该是相同的，所以您应该能够检查。

还有很多其他工具可以跟踪网络活动，但我认为 little snitch 是最容易使用的。

# asp.net-mvc-3 - 使用 Editortemplates 在 mvc3 中动态添加控件

> ID：12277658
> 
> 赞同：0
> 
> 时间：2012-09-05T08:47:17.833
> 
> 标签：asp.net-mvc-3, razor

在我的程序中，我试图在按钮单击时动态添加额外的控件。是否可以使用 EditorTemplates？这是我的编辑器模板

```
@model chPayroll.Models.HREducation.HRInfo
      @{
          var list = (IEnumerable<SelectListItem>)TempData["PassedDivision"];
          var list1 = (IEnumerable<SelectListItem>)TempData["Country"];
        }
     @Html.HiddenFor(x => x.StaffId)
      <tr>
      <td>@Html.DropDownListFor(x => x.Country, list1, "-select-")</td>
      <td>@Html.TextBoxFor(x=>x.Board)</td>
      <td>@Html.TextBoxFor(x=>x.Level)</td>
      <td>@Html.TextBoxFor(x=>x.PassedYr)</td>
      <td>@Html.DropDownListFor(x=>x.PassedDivision,list,"-selected-")</td>
      <td><input type="file" name="file"></td>
     </tr> 
```

现在我想在按钮单击时动态添加所有控件。我从视图中调用listeditor。

```
@model chPayroll.Models.HREducation.HRInfo

<div align="left">
<fieldset style="left:0px">
@using (Html.BeginForm("Addcontrols", "HREduInformation", FormMethod.Post))
{
    <table >
        <tr>
        <th >Country</th>
        <th>Board</th>
        <th>Level</th>
        <th>Passed Year</th>
        <th>Division</th>
        <th>certificate</th>
   </tr>

        @Html.EditorFor(m => m.listInfoeditor)

    </table>
  <input type="submit" value="Add New" id="savechanges" />
}
</fieldset>
</div 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T07:51:00.040

您可以使用 Ajax 来获取呈现的控件 Html。

[编辑可变长度列表](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)

您还可以更进一步，通过在客户端使用已呈现的模板来避免 ajax 调用

# mysql - mySQL 创建两个表交替行的结果集

> ID：12277665
> 
> 赞同：2
> 
> 时间：2012-09-05T08:47:45.890
> 
> 标签：mysql

我有一个使用联合来连接两个子查询的查询，例如

```
SELECT * FROM posts WHERE postTypeId=1 (e.g. blog)
UNION
SELECT * FROM posts WHERE postTypeId=2 (e.g. news) 
```

这种方法生成的结果集依次定位两个子集（“博客”然后是“新闻”）。

我想创建一个将两者交错的结果集，在“博客”子集和“新闻”子集的行之间交替。

我觉得必须有一个简单的方法来做到这一点，但我没有找到它。

任何建议将不胜感激。

缺口

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T15:13:04.433

这是最适合我的解决方案。它与当前的任何提案都不相同，因此我独立添加了它。@a、@b 和@c 用于为每个子集创建行号，这意味着在组合结果中，3 行将共享相同的行号（“行集”）。这用作一阶排序，然后二阶排序对“行集”中的行进行排序。

```
SET @a = 0;
SET @b = 0;
SET @c = 0; 

SELECT * FROM(
  SELECT @a := @a + 1 AS sortOne, 1 AS sortTwo, posts.* FROM posts WHERE posts.postTypeId=3
    UNION
  SELECT @b := @b + 1 AS sortOne, 2 AS sortTwo, posts.* FROM posts WHERE posts.postTypeId=2
    UNION
  SELECT @c := @c + 1 AS sortOne, 3 AS sortTwo, posts.* FROM posts WHERE posts.postTypeId=1
) AS result ORDER BY sortOne, sortTwo 
```

该解决方案是由提交的解决方案派生/启发的，但我认为将它们中的任何一个标记为本身是可接受的解决方案是不合适的。所以，感谢 Thomas Clayson、Tony Hopkinson 和 rmunoz，他们的答案我投了赞成票。干杯!

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T08:56:27.193

好吧，这是我能想到的一种新颖的方法（未经测试，但您会明白要点）：

```
SELECT * FROM (
    SELECT 1 AS query, @n := @n + 1 AS rowNumber, posts.* FROM (select @n:=0), posts WHERE posts.postTypeId=1
    UNION
    SELECT 2 AS query, @n := @n + 1 AS rowNumber, posts.* FROM (select @n:=0), posts WHERE posts.postTypeId=2
) ORDER BY rowNumber, query; 
```

因此，这将执行两个查询，然后按 first`rowNumber`和 by排序`query`。你最终会得到类似的东西：

```
rowNumber | query
1         | 1
1         | 2
2         | 1
2         | 2
etc... 
```

`SELECT @n=:0`将查询的全局变量重置`n`为 0，然后`@n := @n + 1`递增每一行的值。

如果您需要更多解释，请告诉我。我希望这行得通！:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T08:57:04.033

尝试

```
Set @current_row = 0
SELECT * FROM (
  SELECT @current_row := @current_row + 1 as Position, posts.*
    FROM posts
    WHERE postTypeId=1
  UNION 
  SELECT @current_row, posts.*
    FROM posts
    WHERE postTypeId=2
) dummyTableName
ORDER BY position, postTypeId 
```

也许

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-05T08:59:00.430

这很简单，你可以在你的子查询中添加一个参数，参数“rank”，这样：

```
SET @rank=0;
SELECT @rank:=@rank+2 AS rank FROM posts WHERE postTypeId=1 (e.g. blog) 
```

然后，你得到：

```
0, ...
2, ... 
```

如果您在另一个查询中执行相同操作，但将 rank 初始化为 1，您将得到：

```
1, ...
3, ... 
```

最后“ORDER BY rank”，你会得到混合的帖子和新闻。

# blackberry - 如何使用phonegap为黑莓创建安装文件？

> ID：12277670
> 
> 赞同：0
> 
> 时间：2012-09-05T08:48:09.150
> 
> 标签：blackberry, cordova

我使用 phonegap 开发了黑莓应用程序。

在命令提示符的帮助下，我使用 BlackBerry Code 签名密钥构建项目，然后它可以成功构建并提供包含 cod 和 jad 文件的 OTAInstall 文件夹。

但是我的客户只想使用一个 jad 文件来安装他们的设备。

实际上我尝试安装没有 cod 文件的 jad 文件，当时设备显示错误。

所以，每次我将应用程序安装到我的设备上时，我都会使用包含 cod 和 jad 文件的 OTAInstall 文件夹。

如何将这么多文件转换为一个文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T10:01:15.507

只有一个 jad 文件不会安装应用程序。无论如何，您需要 jad 文件 + cod 文件，或 alx 文件 + cod 文件。

jad file + cod 代表通过浏览器OTA安装

alx 文件 + cod 代表通过 BB 桌面管理器和 USB 电缆安装桌面计算机，连接到 BB 设备。

有一种解决方法，它仅适用于桌面安装，并且有副作用。

您的应用程序不会列`Applications list`在设备选项下。

您可以使用 javaloader.exe 实用程序加载和擦除附加 BB 设备上的 cod 文件。此实用程序可以在 JDE（Java 开发环境）`bin`文件夹中找到。

因此，创建调用 javaloader 并将 cod 文件加载到连接设备的 bat 文件。并将它与您的 cod 文件一起打包到 SFX 存档中，当存档解压缩时运行该 bat 文件。

# android - android服务 - 错误：服务未注册

> ID：12277673
> 
> 赞同：31
> 
> 时间：2012-09-05T08:48:12.290
> 
> 标签：android, service

我正在尝试了解有界服务。在我尝试遵循[http://developer.android.com/guide/components/bound-services.html](http://developer.android.com/guide/components/bound-services.html)的示例程序下方。该服务可以播放、暂停和停止音频，但当我切换到另一个应用程序时，我收到以下服务未注册错误。

```
java.lang.RuntimeException: Unable to stop activity {com.example.dd_services_audio_01/com.example.dd_services_audio_01.MainActivity}: java.lang.IllegalArgumentException: Service not registered: com.example.dd_services_audio_01.MainActivity$1@2afca5d8
09-05 14:04:32.625: E/AndroidRuntime(5810):     at android.app.ActivityThread.performStopActivityInner(ActivityThread.java:2451)
09-05 14:04:32.625: E/AndroidRuntime(5810):     at android.app.ActivityThread.handleStopActivity(ActivityThread.java:2496) 
```

由于编码似乎密切关注文档示例，我不知道哪里出了问题。我使用 minSdk 级别 8 运行此应用程序。错误发生在 MainActivity.onStop 的行

```
 mService.unbindService(mConnection); 
```

任何解决这个问题的建议都会很棒。

谢谢

马丁

```
package com.example.dd_services_audio_01;

import android.app.Activity;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.ServiceConnection;
import android.os.Bundle;
import android.os.Environment;
import android.os.IBinder;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

import com.example.dd_services_audio_01.AudioPlayerService.AudioPlayerBinder;

public class MainActivity extends Activity {

private final String TAG = "MainActivity";

AudioPlayerService mService;
boolean mBound = false;

Button mPlay, mPause, mStop;

String audioFile = Environment.getExternalStorageDirectory()
        + "/justdzongsar/DJKR_AboutToGetIt.mp3";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    Log.d(TAG,"onCreate");
    setContentView(R.layout.activity_main);

    mPlay = (Button) findViewById(R.id.buttonPlay);
    mPause = (Button) findViewById(R.id.buttonPause);
    mStop = (Button) findViewById(R.id.buttonStop);

    mPlay.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            mService.play(audioFile);
        }
    });

    mPause.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            mService.pause();
        }
    });

    mStop.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            mService.stop();
        }
    });

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

@Override
protected void onStart() {
    super.onStart();
    // Bind to LocalService
    Intent intent = new Intent(this, AudioPlayerService.class);
    bindService(intent, mConnection, Context.BIND_AUTO_CREATE);

}

@Override
protected void onStop() {
    super.onStop();

    if (mBound) {
        mService.unbindService(mConnection);
        mBound=false;
    }
} 

/** Defines callbacks for service binding, passed to bindService() */
private ServiceConnection mConnection = new ServiceConnection() {

    @Override
    public void onServiceConnected(ComponentName className, IBinder service) {
        // We've bound to LocalService, cast the IBinder and get
        // LocalService instance
        AudioPlayerBinder binder = (AudioPlayerBinder) service;
        mService = binder.getService();
        mBound = true;
    }

    @Override
    public void onServiceDisconnected(ComponentName arg0) {
        mService = null;
        mBound = false;
    }
};

} 
```

和

```
package com.example.dd_services_audio_01;

import java.io.IOException;

import android.app.Service;
import android.content.Intent;
import android.media.MediaPlayer;
import android.media.MediaPlayer.OnCompletionListener;
import android.media.MediaPlayer.OnPreparedListener;
import android.os.Binder;
import android.os.IBinder;
import android.util.Log;

public class AudioPlayerService extends Service implements OnPreparedListener,
    OnCompletionListener {

private final String TAG = "AudioPlayerService";

private final IBinder mBinder = new AudioPlayerBinder();

private MediaPlayer mMediaPlayer;

private String currentDataSource;

public class AudioPlayerBinder extends Binder {
    public AudioPlayerService getService() {
        Log.v(TAG, "AudioPlayerBinder: getService() called");
        return AudioPlayerService.this;
    }
}

@Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    return mBinder;
}

@Override
public boolean onUnbind(Intent intent) {
    // All clients have unbound with unbindService()
    return false;
}

@Override
public void onStart(Intent intent, int startId) {
    Log.i(TAG,
            "AudioPlayerService: onStart() called, instance="
                    + this.hashCode());
}

@Override
public void onDestroy() {
    Log.i(TAG, "AudioPlayerService: onDestroy() called");
    releaseMediaPlayer();
}

// -----

public void play(String audioFile) {
    Log.d(TAG, "audio play called with file " + audioFile);
    if (mMediaPlayer != null && audioFile.compareTo(currentDataSource) == 0) {
        if (mMediaPlayer.isPlaying() == true) {
            return;
        }
        mMediaPlayer.start();

        return;
    }
    releaseMediaPlayer();

    try {

        mMediaPlayer = new MediaPlayer();
        mMediaPlayer.setDataSource(audioFile);

        mMediaPlayer.setOnPreparedListener(this);
        mMediaPlayer.setOnCompletionListener(this);
        currentDataSource = audioFile;

                    mMediaPlayer.prepareAsync();

    } catch (IOException ioe) {
        Log.e(TAG, "error trying to play " + audioFile, ioe);
    }

}

public void pause() {

    Log.d(TAG, "audio pause");
    if (mMediaPlayer != null && mMediaPlayer.isPlaying()) {
        mMediaPlayer.pause();
    }
}

public void seek(int timeInMillis) {
    if (mMediaPlayer != null) {
        mMediaPlayer.seekTo(timeInMillis);
    }
}

public int elapsed() {
    if (mMediaPlayer == null) {
        return 0;
    }
    return mMediaPlayer.getCurrentPosition();
}

public void stop() {
    Log.d(TAG, "audio stop");
    releaseMediaPlayer();
}

// --

private void releaseMediaPlayer() {
    if (mMediaPlayer == null) {
        return;
    }

    if (mMediaPlayer.isPlaying()) {
        mMediaPlayer.stop();
    }
    mMediaPlayer.release();
    mMediaPlayer = null;
}

@Override
public void onCompletion(MediaPlayer arg0) {
    // TODO Auto-generated method stub
    releaseMediaPlayer();
}

@Override
public void onPrepared(MediaPlayer mp) {
    if (mp != null) {
        mp.start();
    }

    // TODO Auto-generated method stub

}

} 
```

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2013-05-23T11:52:15.647

有类似的问题，但接受的答案不是我的解决方案。幸运的是，其中一条评论给了我答案：

> **取消绑定服务时不应引发onServiceDisconnected**，因此不要依赖它。如果您的 Service 和 ServiceConnection 之间的连接断开，它应该会通知您。

感谢@Waqas，我发现了错误：我只在and内部更新了`boolean binded`标志。现在我每次打电话时都添加了“binded=false” ，问题就消失了。就是这样，不要依赖**onServiceDisconnected**`onServiceConnected()``onServiceDisconnected()``unbindService()`

 *** * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-09-05T13:02:35.033

啊，这些日子之一

```
mService.unbindService(mConnection); 
```

显然是胡说八道，在错误的上下文中调用 unbind。它应该是

```
unbindService(mConnection); 
```

发布的编码中的其他错误是缺少

```
@Override
public boolean onUnbind(Intent intent) {
    // All clients have unbound with unbindService()

    releaseMediaPlayer();

    return false;
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-07-04T13:41:23.100

作为旁注，由于其他答案都没有帮助，我发现我的错误是使用不同`Context`的绑定和取消绑定。我的绑定来自应用程序上下文，但我的解除绑定来自活动上下文。

为了修复该错误，我确保对`bindService()`and使用相同的上下文`unbindService()`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-06-30T22:30:08.733

您可能需要确保 mService 不为空。以下行给了我“服务未注册”错误：

`if (mContext != null) mContext.unbindService(mServiceConn);`

这非常令人困惑，因为 mContext 和 mServiceConn 都不为空。

这修复了它：

`if (mContext != null && mService != null) mContext.unbindService(mServiceConn);`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-14T19:02:03.533

当我杀死该应用程序时，我`MediaPlayer`会停止，但 5 分钟或更短的时间它会自行重新启动。

为了解决这个问题，除了@dorjeduck 的回答之外，我还必须在 call`mediaPlayer.stop()`之前先打电话`mediaPlayer.release()`。**

# c - 如何测试用 c 编写的 c 代码或库

> ID：12277685
> 
> 赞同：0
> 
> 时间：2012-09-05T08:49:18.963
> 
> 标签：c, testing

我是测试领域的新手。我想首先问一下可以通过哪些方式测试 C 应用程序（C 框架或 C 工具），我应该如何开始，还有哪些步骤是我可以用来测试 C 代码的最佳工具。

需要一些帮助和一些文档。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T10:39:12.820

单元测试工具或框架通常做的是自动化所有输入集并检查输出的有效结果以及进行否定测试，即放置无效值并查看适当的响应，例如系统至少应该保持稳定。例如，如果一个函数说它只处理正数，理想情况下它应该能够在传递一个负数时说“无效数据”，而不是给出错误的答案或最糟糕的崩溃）

在 api 级别上说，如果你有一个接受一个数字并返回它的平方的函数，你编写一个脚本（或有一个工具），它调用该函数重复地向它传递所有有效输入（或至少所有不同类型的输入，例如每个类都包括在内）。这将意味着测试边界条件（最小最大值）、基本用例条件和负面条件等。

除了单元测试，您还可以进行白盒测试。例如代码覆盖率，即确保您执行了覆盖大部分（如果不是全部）代码路径的测试用例。

将上述部分/大部分自动化，以便每次进行更改时都可以重复执行和验证它们，这称为回归测试。

然后还有其他几个测试领域，例如本地化、全球化、安全测试等。

# sql - 父子表的sql脚本

> ID：12277688
> 
> 赞同：-3
> 
> 时间：2012-09-05T08:49:24.843
> 
> 标签：sql, parent-child, recursive-query

我有一张桌子：

```
ID  ParentID
3   1
7   2
4   3
5   4 
```

如何使用 sql 脚本（递归方式）列出这样的结果：

```
ID  ParentID
3   1
4   3
5   4
7   2 
```

你有想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T08:58:11.217

`SELECT * FROM YourTable ORDER BY ID`会给你你想要的订单。但是如果你想要递归的：

```
SELECT childs.Id AS 'Child Id', Parents.Id As 'Parent'
FROM YourTable childs
INNER JOIN YourTable parents ON childs.ParentId = parents.Id
ORDER BY Parents.Id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T08:53:36.310

```
Select * 
from MyTable 
order By ID; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T08:55:58.247

```
Select * from tablename order by id 
```

# php - CakePHP 1.3 应用模型函数

> ID：12277691
> 
> 赞同：1
> 
> 时间：2012-09-05T08:49:45.077
> 
> 标签：php, oop, cakephp, model

我正在尝试创建一个函数，该函数根据域扩展名更改站点的语言环境，但是当我尝试将 AppModel 中的变量值设置为函数时，出现错误。我不确定我做错了什么。

仅供参考：$_SERVER['HTTP_HOST'] = '.de';

```
class AppModel extends Model {

//var $locale = 'de_de'; // Example of what I need

var $locale = $this->getLocale();

    function getLocale() {

        $domain = explode('.', $_SERVER['HTTP_HOST']); 

        if ($domain[1] == 'de') {

            return 'de_de';

        } else {

        return 'en_gb';

        }

    }

} 
```

返回错误：

```
Parse error: syntax error, unexpected T_VARIABLE in /var/www/devsite/v1/site/app/app_model.php on line 7 Call Stack: 0.0002 671648 1\. {main}() 
/var/www/devsite/v1/site/app/webroot/index.php:0 0.0255 5883776 2\. Dispatcher->dispatch() /var/www/devsite/v1/site/app/webroot/index.php:83 0.0264 5949592 3\. 
Dispatcher->__getController() /var/www/devsite/v1/site/cake/dispatcher.php:116 0.0264 5949672 4\. Dispatcher->__loadController() 
/var/www/devsite/v1/site/cake/dispatcher.php:385 0.0265 5951760 5\. App->import() /var/www/devsite/v1/site/cake/dispatcher.php:413 0.0265 5953552 6\. 
App->__settings() /var/www/devsite/v1/site/cake/libs/configure.php:916 0.0265 5954000 7\. App->import() 
/var/www/devsite/v1/site/cake/libs/configure.php:1171 0.0265 5957624 8\. App->__find() /var/www/devsite/v1/site/cake/libs/configure.php:955 0.0268 5984264 9\. 
App->__load() /var/www/devsite/v1/site/cake/libs/configure.php:1019 0.0269 6047416 10\. require('/var/www/devsite/v1/site/app/app_controller.php') 
/var/www/devsite/v1/site/cake/libs/configure.php:1060 0.0269 6047560 11\. App->import() /var/www/devsite/v1/site/app/app_controller.php:8 0.0270 6051456 12\. 
App->__find() /var/www/devsite/v1/site/cake/libs/configure.php:955 0.0270 6052240 13\. App->__load() /var/www/devsite/v1/site/cake/libs/configure.php:1036 
0.0272 6164128 14\. require('/var/www/devsite/v1/site/cake/libs/sanitize.php') /var/www/devsite/v1/site/cake/libs/configure.php:1060 0.0272 6164416 15\. 
App->import() /var/www/devsite/v1/site/cake/libs/sanitize.php:2 0.0273 6165128 16\. App->__settings() /var/www/devsite/v1/site/cake/libs/configure.php:916 0.0337 8579264 17\. 
App->import() /var/www/devsite/v1/site/cake/libs/configure.php:1149 0.0337 8582864 18\. App->__find() /var/www/devsite/v1/site/cake/libs/configure.php:955 0.0338 8583952 19\. 
App->__load() /var/www/devsite/v1/site/cake/libs/configure.php:1019 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:53:42.240

错误信息说得很清楚：invalid php

您仍然必须编写有效的 PHP（即使它是 cakePHP）！使用适当的 IDE 将立即概述错误：

```
var $uses ('App'); 
```

应该

```
public $uses = array('App'); 
```

记录在案！

如果您仍在使用 PHP4，则需要“var”而不是“public”

你真的应该开始阅读基本的 php 书籍，因为你似乎缺乏基本的东西。您也不能在类声明中使用动态方法：

```
 var $locale = $this->getLocale(); 
```

您需要为此使用构造函数：

```
public function __construct($id = false, $table = null, $ds = null) {
    parent::__construct($id, $table, $ds);

    $this->locale = $this->getLocale();
} 
```

# php - 在 PHP 中将电子邮件列入白名单的最有效方法是什么？

> ID：12277694
> 
> 赞同：1
> 
> 时间：2012-09-05T08:49:54.763
> 
> 标签：php, email, whitelist

我是这方面的初学者，我尽我所能，但我需要一些帮助。我有个问题..

我有这个代码：

```
function prolancemail ( $recipient, $subject, $message, $mailformat = 'default' )
{
    global $configuration, $current_version, $MAIL_CHARSET;

    if ( $mailformat == 'default' )
    {
        $mailformat = $configuration['MAIL_FORMAT'];
    }

    if ( $mailformat == 'text/plain' )
    {
        $headers = 'From: ' . SITENAME . ' <' . $configuration['WEBMASTER_EMAIL'] . '>' . "\r\n" .
        sprintf ( $MAIL_CHARSET, $mailformat );
    }
    elseif ( $mailformat == 'text/html' )
    {
        $headers = 'To: ' . $recipient . "\r\n" .
        'From: ' . SITENAME . ' <' . $configuration['WEBMASTER_EMAIL'] . '>' . "\r\n" .
        'X-Mailer: PHPProLance ' . $current_version . "\r\n" .
        'MIME-Version: 1.0' . "\r\n" .
        sprintf ( $MAIL_CHARSET, $mailformat );
    }

    if ( mail ( $recipient, $subject, $message, $headers ) )
    { 
        return true;
    }
    else
    { 
        return false;
    } 
```

*   我想在这个函数中添加一个 .vcf 附件（或带有 vcf 文件的链接），并且（更重要的是）当接收者将收到邮件时，我想在这个函数中添加一个代码，接收者可以将我的电子邮件列入白名单从 vcf 文件（添加到他的联系人）中，这样，他将从我那里收到的下一封邮件不会转到垃圾邮件。任何想法？我想要的只是他将收到我的下一封邮件而不是在垃圾邮件文件夹中接收，我认为这可以通过白名单（我不太了解）tnx infront 来完成。

# regex - sed：无法解决这个正则表达式

> ID：12277696
> 
> 赞同：5
> 
> 时间：2012-09-05T08:49:59.220
> 
> 标签：regex, linux, sed

我正在尝试使用两个**sed**命令替换 php 文件中的两个字符串，但找不到我错的地方。

想从字符串转换

```
setlocale(LC_ALL,  $_COOKIE['lang']); 
```

和

```
putenv("LANGUAGE=".$_COOKIE['lang']); 
```

到弦乐

```
setlocale(LC_ALL,  $_COOKIE['lang'].'.utf8'); 
```

和

```
putenv("LANGUAGE=".$_COOKIE['lang'].'.utf8'); 
```

到目前为止，我已经到了以下但不起作用

```
sed -i "s/setlocale\(LC_ALL,  \$_COOKIE\['lang'\]\);.*$/setlocale\(LC_ALL,  \$_COOKIE\['lang'\]\.'\.utf-8'\)\;/" file.php

sed -i "s/putenv\('LANGUAGE='\.\$_COOKIE\['lang'\]\);.*$/putenv\('LANGUAGE='\.\$_COOKIE\['lang'\]\.'\.utf-8'\)\;/" file.php 
```

我绝对*不是*sed 和正则表达式方面的专家，所以放轻松好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T09:06:25.920

试试这两个：

```
sed 's/setlocale.LC_ALL,  ._COOKIE..lang...;/setlocale\(LC_ALL,  $_COOKIE\['\''lang'\''\].'\''.utf8'\''\);/g' file.php
sed 's/putenv..LANGUAGE...._COOKIE..lang...;/putenv\("LANGUAGE=".$_COOKIE\['\''lang'\''].'\''.utf8'\'');/g' file.php 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T08:56:33.610

你不应该逃避括号。也无需转义替换部分中的匹配字符：

```
sed "s/setlocale(LC_ALL,  \$_COOKIE\['lang'\]);.*$/setlocale(LC_ALL,  \$_COOKIE['lang'].'.utf-8')\;/" 
```

该`putenv`行包含双引号，但您的表达式搜索单引号。因此，它无法匹配。

# javascript - jquery 打印 [object XMLDocument] 而不是文件内容

> ID：12277697
> 
> 赞同：1
> 
> 时间：2012-09-05T08:50:00.503
> 
> 标签：javascript, jquery

当我单击下面的**显示联系人**链接时，它应该从本地磁盘读取文件并打印其内容。我下面的示例打印***[object XMLDocument]***而不是文件的实际内容。

我必须在打印之前解析或转换它吗？

谢谢

```
<script type="text/javascript">
    function show_contact()
    {
        jQuery.get('file:///D:/contact.html', function(data)
        {
            document.getElementById('content').innerHTML = data;
        });
    }
</script>

<a href="#" title="" onclick="show_contact()">Show Contact</a>
<br />
<p id="content">hi</p> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T08:53:06.027

将 dataType 作为第三个参数传递：

```
 jQuery.get('file:///D:/contact.html', function(data)
       {
          document.getElementById('content').innerHTML = data;
       }, 'text'); 
```

# c++ - Boost.Python.ArgumentError：python str 未转换为 std::string

> ID：12277708
> 
> 赞同：5
> 
> 时间：2012-09-05T08:50:49.140
> 
> 标签：c++, boost, boost-python

我收到一个错误，我无法尝试通过 Boost.Python 包装一个相当简单的 c++ 类。首先，类：

```
#include <boost/python.hpp>
#include <boost/shared_ptr.hpp>
#include <vector>
#include <string>

class token {
    public:
    typedef boost::shared_ptr<token> ptr_type;

    static std::vector<std::string> empty_context;
    static std::string empty_center;

    token(std::string& t = empty_center,
            std::vector<std::string>& left = empty_context,
            std::vector<std::string>& right = empty_context)
        : center(t), left_context(left), right_context(right) {}
    virtual ~token(void)  {}  

    std::vector<std::string> left_context;
    std::vector<std::string> right_context;
    std::string center;
};

std::string token::empty_center;
std::vector<std::string> token::empty_context; 
```

通过暴露于 python

```
BOOST_PYTHON_MODULE(test) {
    namespace bp = boost::python;
    bp::class_<token, token::ptr_type>("token")
    .def(bp::init<std::string&, bp::optional<std::vector<std::string>&,
            std::vector<std::string>&> >())
    ;   
} 
```

然后，当尝试在 python 中使用它时：

```
Python 2.7.2 (default, Aug 19 2011, 20:41:43) [GCC] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> from test import token
>>> word = 'aa'
>>> t = token(word)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
Boost.Python.ArgumentError: Python argument types in
    token.__init__(token, str)
did not match C++ signature:
    __init__(_object*, std::string {lvalue})
    __init__(_object*, std::string {lvalue}, std::vector<std::string,     std::allocator<std::string> > {lvalue})
    __init__(_object*, std::string {lvalue}, std::vector<std::string,     std::allocator<std::string> > {lvalue}, std::vector<std::string, std::allocator<std::string>     > {lvalue})
    __init__(_object*)
>>> 
```

谁能指出这是从哪里来的？Boost.Python 不应该负责将 python 转换`str`为`std::string`吗？

涉及的软件/库版本：

```
Boost version: 1.46.1
Python version: 2.7.2
Compiler: g++ (SUSE Linux) 4.6.2
Makefile generation: cmake version 2.8.6
Make: GNU Make 3.82 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-05T08:56:14.953

你的参数类型是`std::string &`，一个可修改的引用`std::string`。Python 字符串是不可变的，因此不能转换为可修改的引用。您的参数类型应该是`const std::string &`.

# java - 通过附加自动化已经运行的 Java 应用程序

> ID：12277711
> 
> 赞同：2
> 
> 时间：2012-09-05T08:50:58.933
> 
> 标签：java, ui-automation

我使用了一个 java 应用程序（不是我的），我想自动化它。

我之前使用过自动热键来输入文本并单击按钮，但我不确定如何使用它从 java 表中获取文本。

我需要的是解析表格中的文本，处理它，输入文本（取决于进程）并单击按钮。是否有免费的自动化工具可以实现这一目标？

问候， 布拉克

# list - sencha touch 2 列表项上的动画

> ID：12277713
> 
> 赞同：2
> 
> 时间：2012-09-05T08:51:04.377
> 
> 标签：list, sencha-touch-2

我有一个扩展 Ext.dataview.List 的列表。

我只想在其中一个列表项中播放动画。

如果是由itemTap触发的，那就简单了，因为回调提供了第三个参数，我只是在它上面运行动画。（我的意思是 Ext.Anim.run）。

但是，如果我需要独立于列表为第 n 个元素设置动画，例如由用户点击单独的按钮触发，该怎么办？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T17:10:41.517

假设您有一个具有以下配置的列表：

```
xtype:'list',
cls: 'myList',
... 
```

然后你可以访问它的 DOM 元素：

```
var items = Ext.DomQuery.select('.myList .x-list-item'); 
```

它将使用 cls 'myList' 返回列表中的所有项目，因此请确保该类只有一个列表。

从那里你可以做任何你想做的事情，比如隐藏第二个项目：

```
items[1].style.display = 'none'; 
```

希望这有帮助

# python - 尝试在 Mac OS X Lion 中安装 pip 时出现 Permission denied 错误

> ID：12277716
> 
> 赞同：14
> 
> 时间：2012-09-05T08:51:13.470
> 
> 标签：python, macos, osx-lion, pip

我正在尝试在 Mac（OS X Lion）上安装 pip。它似乎不起作用。我使用 sudo 并提示输入密码。

```
$ sudo curl https://raw.github.com/pypa/pip/master/contrib/get-pip.py | python
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 85929  100 85929    0     0  63833      0  0:00:01  0:00:01 --:--:-- 99339
Downloading/unpacking pip
  Downloading pip-1.2.tar.gz (94Kb): 94Kb downloaded
  Running setup.py egg_info for package pip

    warning: no files found matching '*.html' under directory 'docs'
    warning: no previously-included files matching '*.txt' found under directory 'docs/_build'
    no previously-included directories found matching 'docs/_build/_sources'
Installing collected packages: pip
  Running setup.py install for pip
    error: could not create '/Library/Python/2.7/site-packages/pip': Permission denied
    Complete output from command /usr/bin/python -c "import setuptools;__file__='/Users/kristoffernolgren/build/pip/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --single-version-externally-managed --record /var/folders/3_/tp_3vp9966dc65phynpzl04h0000gn/T/pip-snSujv-record/install-record.txt:
    running install

running build

running build_py

creating build

creating build/lib

creating build/lib/pip

copying pip/__init__.py -> build/lib/pip

copying pip/__main__.py -> build/lib/pip

copying pip/backwardcompat.py -> build/lib/pip

copying pip/basecommand.py -> build/lib/pip

copying pip/baseparser.py -> build/lib/pip

copying pip/download.py -> build/lib/pip

copying pip/exceptions.py -> build/lib/pip

copying pip/index.py -> build/lib/pip

copying pip/locations.py -> build/lib/pip

copying pip/log.py -> build/lib/pip

copying pip/req.py -> build/lib/pip

copying pip/runner.py -> build/lib/pip

copying pip/status_codes.py -> build/lib/pip

copying pip/util.py -> build/lib/pip

creating build/lib/pip/commands

copying pip/commands/__init__.py -> build/lib/pip/commands

copying pip/commands/bundle.py -> build/lib/pip/commands

copying pip/commands/completion.py -> build/lib/pip/commands

copying pip/commands/freeze.py -> build/lib/pip/commands

copying pip/commands/help.py -> build/lib/pip/commands

copying pip/commands/install.py -> build/lib/pip/commands

copying pip/commands/search.py -> build/lib/pip/commands

copying pip/commands/uninstall.py -> build/lib/pip/commands

copying pip/commands/unzip.py -> build/lib/pip/commands

copying pip/commands/zip.py -> build/lib/pip/commands

creating build/lib/pip/vcs

copying pip/vcs/__init__.py -> build/lib/pip/vcs

copying pip/vcs/bazaar.py -> build/lib/pip/vcs

copying pip/vcs/git.py -> build/lib/pip/vcs

copying pip/vcs/mercurial.py -> build/lib/pip/vcs

copying pip/vcs/subversion.py -> build/lib/pip/vcs

running install_lib

creating /Library/Python/2.7/site-packages/pip

error: could not create '/Library/Python/2.7/site-packages/pip': Permission denied

----------------------------------------
Command /usr/bin/python -c "import setuptools;__file__='/Users/kristoffernolgren/build/pip/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --single-version-externally-managed --record /var/folders/3_/tp_3vp9966dc65phynpzl04h0000gn/T/pip-snSujv-record/install-record.txt failed with error code 1
Storing complete log in /Users/kristoffernolgren/.pip/pip.log 
```

底部提到的错误日志。

```
------------------------------------------------------------
 run on Wed Sep  5 10:42:27 2012
Downloading/unpacking pip
  Getting page http://pypi.python.org/simple/pip
  URLs to search for versions for pip:
  * http://pypi.python.org/simple/pip/
  Getting page http://www.pip-installer.org
  Getting page http://pip.openplans.org
  Analyzing links from page http://pypi.python.org/simple/pip/
    Found link http://pypi.python.org/packages/source/p/pip/pip-1.0.1.tar.gz#md5=28dcc70225e5bf925532abc5b087a94b (from http://pypi.python.org/simple/pip/), version: 1.0.1
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.6.tar.gz#md5=083ff408ca5314cf0561ff79a048cd9a (from http://pypi.python.org/simple/pip/), version: 0.6
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.8.tar.gz#md5=468d9adc309f33ad51cee38f0d455429 (from http://pypi.python.org/simple/pip/), version: 0.8
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.8.1.tar.gz#md5=5d40614774781b118dd3f10c0d038cbc (from http://pypi.python.org/simple/pip/), version: 0.8.1
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.5.tar.gz#md5=63eed8673e40628534cc0aa9c98e8f3d (from http://pypi.python.org/simple/pip/), version: 0.5
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.2.tar.gz#md5=9eda07c8be7105aa774c7eb51c023294 (from http://pypi.python.org/simple/pip/), version: 0.2
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.2.1.tar.gz#md5=d2af655c1a87e03799442d045c1d6743 (from http://pypi.python.org/simple/pip/), version: 0.2.1
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.7.tar.gz#md5=8d4b4f7266fe0808569182e6832d74ac (from http://pypi.python.org/simple/pip/), version: 0.7
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.8.2.tar.gz#md5=df1eca0abe7643d92b5222240bed15f6 (from http://pypi.python.org/simple/pip/), version: 0.8.2
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.7.1.tar.gz#md5=420c83ad67bdcb542f772eb64392cce6 (from http://pypi.python.org/simple/pip/), version: 0.7.1
    Found link http://pypi.python.org/packages/source/p/pip/pip-1.2.tar.gz#md5=99e44d1d7f88b182459e7c19c45aee9f (from http://pypi.python.org/simple/pip/), version: 1.2
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.6.2.tar.gz#md5=9a43e0a2ce8833069f41c347932bdb25 (from http://pypi.python.org/simple/pip/), version: 0.6.2
    Found link http://pypi.python.org/packages/source/p/pip/pip-1.1.tar.gz#md5=62a9f08dd5dc69d76734568a6c040508 (from http://pypi.python.org/simple/pip/), version: 1.1
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.5.1.tar.gz#md5=d4bdaa5f5f5bf8c6263ace75a0882232 (from http://pypi.python.org/simple/pip/), version: 0.5.1
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.8.3.tar.gz#md5=0603337a81f83df2b1d2f1151565efac (from http://pypi.python.org/simple/pip/), version: 0.8.3
    Found link http://pypi.python.org/packages/source/p/pip/pip-1.0.2.tar.gz#md5=47ec6ff3f6d962696fe08d4c8264ad49 (from http://pypi.python.org/simple/pip/), version: 1.0.2
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.7.2.tar.gz#md5=cfe73090aaa0d3b0c104179a627859d1 (from http://pypi.python.org/simple/pip/), version: 0.7.2
    Found link http://pypi.python.org/packages/source/p/pip/pip-1.0.tar.gz#md5=327fc4a03df189506966e15021730550 (from http://pypi.python.org/simple/pip/), version: 1.0
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.3.1.tar.gz#md5=78102ddbb040a183dd361b5d432cdf88 (from http://pypi.python.org/simple/pip/), version: 0.3.1
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.3.tar.gz#md5=8fccb5b49c6377cbfb1949ccd7be43b3 (from http://pypi.python.org/simple/pip/), version: 0.3
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.4.tar.gz#md5=b45714d04f8fd38fe8e3d4c7600b91a2 (from http://pypi.python.org/simple/pip/), version: 0.4
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.6.3.tar.gz#md5=0602fa9179cfaa98e41565d4a581d98c (from http://pypi.python.org/simple/pip/), version: 0.6.3
    Found link http://pypi.python.org/packages/source/p/pip/pip-0.6.1.tar.gz#md5=7560e3055c66afb99ac4a7892389a237 (from http://pypi.python.org/simple/pip/), version: 0.6.1
    Skipping link http://www.pip-installer.org (from http://pypi.python.org/simple/pip/); not a file
    Skipping link http://pip.openplans.org (from http://pypi.python.org/simple/pip/); not a file
    Skipping link https://github.com/pypa/pip/issues/ (from http://pypi.python.org/simple/pip/); not a file
    Skipping link http://bitbucket.org/ianb/pip/issues/ (from http://pypi.python.org/simple/pip/); not a file
    Skipping link https://raw.github.com/pypa/pip/master/contrib/get-pip.py (from http://pypi.python.org/simple/pip/); unknown archive format: .py
    Skipping link http://www.python.org/dev/peps/pep-0381/ (from http://pypi.python.org/simple/pip/); not a file
    Skipping link http://oss.openplans.org/pip/ (from http://pypi.python.org/simple/pip/); not a file
    Skipping link http://www.virtualenv.org (from http://pypi.python.org/simple/pip/); not a file
    Skipping link http://www.doughellmann.com/projects/virtualenvwrapper/ (from http://pypi.python.org/simple/pip/); not a file
    Skipping link file:// (from http://pypi.python.org/simple/pip/); not a file
    Skipping link http://www.pip-installer.org/ (from http://pypi.python.org/simple/pip/); not a file
    Skipping link http://ionelmc.wordpress.com/ (from http://pypi.python.org/simple/pip/); not a file
    Skipping link https://github.com/pypa/pip (from http://pypi.python.org/simple/pip/); not a file
    Skipping link http://travis-ci.org/pypa/pip (from http://pypi.python.org/simple/pip/); not a file
    Skipping link http://groups.google.com/group/python-virtualenv?hl=en (from http://pypi.python.org/simple/pip/); not a file
    Skipping link http://pip.openplans.org/requirement-format.html (from http://pypi.python.org/simple/pip/); unknown archive format: .html
    Skipping link https://github.com/pypa/pip/raw/master/contrib/get-pip.py (from http://pypi.python.org/simple/pip/); unknown archive format: .py
    Skipping link http://pypi.python.org/mirrors (from http://pypi.python.org/simple/pip/); not a file
    Skipping link http://trac.openplans.org/poacheggs/ (from http://pypi.python.org/simple/pip/); not a file
    Skipping link http://virtualenv.openplans.org (from http://pypi.python.org/simple/pip/); not a file
    Skipping link http://peak.telecommunity.com/DevCenter/EasyInstall (from http://pypi.python.org/simple/pip/); not a file
    Found link https://github.com/pypa/pip/tarball/develop#egg=pip-dev (from http://pypi.python.org/simple/pip/), version: dev
  Analyzing links from page http://www.pip-installer.org/en/latest/index.html
    Skipping link http://www.pip-installer.org/en/latest/_static/nature.css (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .css
    Skipping link http://www.pip-installer.org/en/latest/_static/pygments.css (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .css
    Skipping link http://www.pip-installer.org/en/latest/index.html (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/installing.html (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/index.html#pip (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://pypi.python.org/pypi (from http://www.pip-installer.org/en/latest/index.html); not a file
    Skipping link http://www.pip-installer.org/en/latest/installing.html#prerequisites (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/installing.html#using-the-installer (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/installing.html#alternative-installation-procedures (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/usage.html (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/usage.html#install-packages (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/usage.html#uninstall-packages (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/usage.html#searching-for-packages (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/usage.html#bundles (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/requirements.html (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/requirements.html#freezing-requirements (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/requirements.html#the-requirements-file-format (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/configuration.html (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/configuration.html#examples (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/configuration.html#config-files (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/configuration.html#environment-variables (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/configuration.html#configuration-options (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/other-tools.html (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/other-tools.html#pip-compared-to-easy-install (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/other-tools.html#using-pip-with-virtualenv (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/other-tools.html#using-pip-with-buildout (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/other-tools.html#using-pip-with-the-user-scheme (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/other-tools.html#command-line-completion (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/contributing.html (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/contributing.html#release-schedule (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/contributing.html#contributing-with-code (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/contributing.html#running-the-tests (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/contributing.html#contributing-with-tests (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/contributing.html#contributing-with-bug-reports (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/contributing.html#contributing-with-ideas (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/news.html (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/news.html#changelog (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/glossary.html (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://www.pip-installer.org/en/latest/index.html#community (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .html
    Skipping link http://sphinx.pocoo.org/ (from http://www.pip-installer.org/en/latest/index.html); not a file
    Skipping link http://readthedocs.org/projects/pip/?fromdocs=pip (from http://www.pip-installer.org/en/latest/index.html); not a file
    Skipping link http://readthedocs.org/docs/pip/en/latest/ (from http://www.pip-installer.org/en/latest/index.html); not a file
    Skipping link http://readthedocs.org/docs/pip/en/1.0.1/ (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .1
    Skipping link http://readthedocs.org/docs/pip/en/1.0/ (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .0
    Skipping link http://readthedocs.org/docs/pip/en/0.8.3/ (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .3
    Skipping link http://readthedocs.org/docs/pip/en/0.7.2/ (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .2
    Skipping link http://readthedocs.org/docs/pip/en/0.6.1/ (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .1
    Skipping link http://readthedocs.org/docs/pip/en/0.5/ (from http://www.pip-installer.org/en/latest/index.html); unknown archive format: .5
  Analyzing links from page http://www.pip-installer.org/en/latest/
    Skipping link http://www.pip-installer.org/en/latest/ (from http://www.pip-installer.org/en/latest/); not a file
    Skipping link http://www.pip-installer.org/en/latest/#pip (from http://www.pip-installer.org/en/latest/); not a file
    Skipping link http://www.pip-installer.org/en/latest/#community (from http://www.pip-installer.org/en/latest/); not a file
  Using version 1.2 (newest of versions: 1.2, 1.1, 1.0.2, 1.0.1, 1.0, 0.8.3, 0.8.2, 0.8.1, 0.8, 0.7.2, 0.7.1, 0.7, 0.6.3, 0.6.2, 0.6.1, 0.6, 0.5.1, 0.5, 0.4, 0.3.1, 0.3, 0.2.1, 0.2, dev)
  Downloading from URL http://pypi.python.org/packages/source/p/pip/pip-1.2.tar.gz#md5=99e44d1d7f88b182459e7c19c45aee9f (from http://pypi.python.org/simple/pip/)
  Running setup.py egg_info for package pip
    running egg_info
    creating pip-egg-info/pip.egg-info
    writing pip-egg-info/pip.egg-info/PKG-INFO
    writing top-level names to pip-egg-info/pip.egg-info/top_level.txt
    writing dependency_links to pip-egg-info/pip.egg-info/dependency_links.txt
    writing entry points to pip-egg-info/pip.egg-info/entry_points.txt
    writing manifest file 'pip-egg-info/pip.egg-info/SOURCES.txt'
    warning: manifest_maker: standard file '-c' not found

    reading manifest file 'pip-egg-info/pip.egg-info/SOURCES.txt'
    reading manifest template 'MANIFEST.in'
    warning: no files found matching '*.html' under directory 'docs'
    warning: no previously-included files matching '*.txt' found under directory 'docs/_build'
    no previously-included directories found matching 'docs/_build/_sources'
    writing manifest file 'pip-egg-info/pip.egg-info/SOURCES.txt'
Installing collected packages: pip
  Running setup.py install for pip
    Running command /usr/bin/python -c "import setuptools;__file__='/Users/kristoffernolgren/build/pip/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --single-version-externally-managed --record /var/folders/3_/tp_3vp9966dc65phynpzl04h0000gn/T/pip-snSujv-record/install-record.txt
    running install
    running build
    running build_py
    creating build
    creating build/lib
    creating build/lib/pip
    copying pip/__init__.py -> build/lib/pip
    copying pip/__main__.py -> build/lib/pip
    copying pip/backwardcompat.py -> build/lib/pip
    copying pip/basecommand.py -> build/lib/pip
    copying pip/baseparser.py -> build/lib/pip
    copying pip/download.py -> build/lib/pip
    copying pip/exceptions.py -> build/lib/pip
    copying pip/index.py -> build/lib/pip
    copying pip/locations.py -> build/lib/pip
    copying pip/log.py -> build/lib/pip
    copying pip/req.py -> build/lib/pip
    copying pip/runner.py -> build/lib/pip
    copying pip/status_codes.py -> build/lib/pip
    copying pip/util.py -> build/lib/pip
    creating build/lib/pip/commands
    copying pip/commands/__init__.py -> build/lib/pip/commands
    copying pip/commands/bundle.py -> build/lib/pip/commands
    copying pip/commands/completion.py -> build/lib/pip/commands
    copying pip/commands/freeze.py -> build/lib/pip/commands
    copying pip/commands/help.py -> build/lib/pip/commands
    copying pip/commands/install.py -> build/lib/pip/commands
    copying pip/commands/search.py -> build/lib/pip/commands
    copying pip/commands/uninstall.py -> build/lib/pip/commands
    copying pip/commands/unzip.py -> build/lib/pip/commands
    copying pip/commands/zip.py -> build/lib/pip/commands
    creating build/lib/pip/vcs
    copying pip/vcs/__init__.py -> build/lib/pip/vcs
    copying pip/vcs/bazaar.py -> build/lib/pip/vcs
    copying pip/vcs/git.py -> build/lib/pip/vcs
    copying pip/vcs/mercurial.py -> build/lib/pip/vcs
    copying pip/vcs/subversion.py -> build/lib/pip/vcs
    running install_lib
    creating /Library/Python/2.7/site-packages/pip
    error: could not create '/Library/Python/2.7/site-packages/pip': Permission denied
    Complete output from command /usr/bin/python -c "import setuptools;__file__='/Users/kristoffernolgren/build/pip/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --single-version-externally-managed --record /var/folders/3_/tp_3vp9966dc65phynpzl04h0000gn/T/pip-snSujv-record/install-record.txt:
    running install

running build

running build_py

creating build

creating build/lib

creating build/lib/pip

copying pip/__init__.py -> build/lib/pip

copying pip/__main__.py -> build/lib/pip

copying pip/backwardcompat.py -> build/lib/pip

copying pip/basecommand.py -> build/lib/pip

copying pip/baseparser.py -> build/lib/pip

copying pip/download.py -> build/lib/pip

copying pip/exceptions.py -> build/lib/pip

copying pip/index.py -> build/lib/pip

copying pip/locations.py -> build/lib/pip

copying pip/log.py -> build/lib/pip

copying pip/req.py -> build/lib/pip

copying pip/runner.py -> build/lib/pip

copying pip/status_codes.py -> build/lib/pip

copying pip/util.py -> build/lib/pip

creating build/lib/pip/commands

copying pip/commands/__init__.py -> build/lib/pip/commands

copying pip/commands/bundle.py -> build/lib/pip/commands

copying pip/commands/completion.py -> build/lib/pip/commands

copying pip/commands/freeze.py -> build/lib/pip/commands

copying pip/commands/help.py -> build/lib/pip/commands

copying pip/commands/install.py -> build/lib/pip/commands

copying pip/commands/search.py -> build/lib/pip/commands

copying pip/commands/uninstall.py -> build/lib/pip/commands

copying pip/commands/unzip.py -> build/lib/pip/commands

copying pip/commands/zip.py -> build/lib/pip/commands

creating build/lib/pip/vcs

copying pip/vcs/__init__.py -> build/lib/pip/vcs

copying pip/vcs/bazaar.py -> build/lib/pip/vcs

copying pip/vcs/git.py -> build/lib/pip/vcs

copying pip/vcs/mercurial.py -> build/lib/pip/vcs

copying pip/vcs/subversion.py -> build/lib/pip/vcs

running install_lib

creating /Library/Python/2.7/site-packages/pip

error: could not create '/Library/Python/2.7/site-packages/pip': Permission denied

----------------------------------------
Command /usr/bin/python -c "import setuptools;__file__='/Users/kristoffernolgren/build/pip/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --single-version-externally-managed --record /var/folders/3_/tp_3vp9966dc65phynpzl04h0000gn/T/pip-snSujv-record/install-record.txt failed with error code 1
Exception information:
Traceback (most recent call last):
  File "/var/folders/3_/tp_3vp9966dc65phynpzl04h0000gn/T/unpacker-h4sW4t-scratchdir/pip/basecommand.py", line 126, in main
    self.run(options, args)
  File "/var/folders/3_/tp_3vp9966dc65phynpzl04h0000gn/T/unpacker-h4sW4t-scratchdir/pip/commands/install.py", line 228, in run
    requirement_set.install(install_options, global_options)
  File "/var/folders/3_/tp_3vp9966dc65phynpzl04h0000gn/T/unpacker-h4sW4t-scratchdir/pip/req.py", line 1093, in install
    requirement.install(install_options, global_options)
  File "/var/folders/3_/tp_3vp9966dc65phynpzl04h0000gn/T/unpacker-h4sW4t-scratchdir/pip/req.py", line 566, in install
    cwd=self.source_dir, filter_stdout=self._filter_install, show_stdout=False)
  File "/var/folders/3_/tp_3vp9966dc65phynpzl04h0000gn/T/unpacker-h4sW4t-scratchdir/pip/__init__.py", line 255, in call_subprocess
    % (command_desc, proc.returncode))
InstallationError: Command /usr/bin/python -c "import setuptools;__file__='/Users/kristoffernolgren/build/pip/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --single-version-externally-managed --record /var/folders/3_/tp_3vp9966dc65phynpzl04h0000gn/T/pip-snSujv-record/install-record.txt failed with error code 1 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-09-05T09:05:08.233

您正在运行`curl`（下载）命令`sudo`，但 python 进程本身在没有提升权限的情况下运行。

像这样运行它：

```
$ curl -O https://raw.github.com/pypa/pip/master/contrib/get-pip.py
$ sudo python get-pip.py 
```

或者，在管道部分使用`sudo`命令：`python`

```
$ curl https://raw.github.com/pypa/pip/master/contrib/get-pip.py | sudo python 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-01-29T07:57:04.690

我遇到了同样的问题。我通过以下步骤修复它：

1.  从此网址下载 get-pip.py 脚本[https://pip.pypa.io/en/stable/installing/#upgrading-pip](https://pip.pypa.io/en/stable/installing/#upgrading-pip)

2.  在终端中使用此命令：`sudo python get-pip.py`

3.  雅虎！安装成功！

[![在此处输入图像描述](../Images/74bf53590b817e222fcf04024b531c8c.png)](https://i.stack.imgur.com/d03tL.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T09:06:39.560

`curl https://raw.github.com/pypa/pip/master/contrib/get-pip.py | sudo python`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-11T21:49:41.173

可能是因为您没有 python 文件夹的权限。请试试这个，它对我有用。

*   $ sudo chown -R $USER /Library/Python/2.7

# silverlight - 当用户尝试关闭选项卡或关闭浏览器时如何通知用户

> ID：12277717
> 
> 赞同：1
> 
> 时间：2012-09-05T08:51:18.260
> 
> 标签：silverlight

首先，我总是这么说：对不起，我的英语很差。我希望你能很好地理解我。

当用户尝试关闭选项卡或关闭浏览器时，我需要通知他。有什么方法可以触发事件以避免浏览器关闭？该应用程序是在 Silverlight 中制作的。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T08:56:32.303

看看下面的例子，还有一个示例应用程序：

[http://www.blog.jonnycornwell.com/2011/01/23/using-silverlight-and-javascript-to-prevent-leaving-a-webpage/](http://www.blog.jonnycornwell.com/2011/01/23/using-silverlight-and-javascript-to-prevent-leaving-a-webpage/)

它是关于使用 Silverlight 和 JavaScript 来防止离开网页。

的JavaScript：

```
<script language="javascript" type="text/javascript">
window.onbeforeunload = askConfirm;
function askConfirm() {
    var control = document.getElementById("silverlightControl");
    var preventLeave = control.Content.Page.PreventLeave();
    if (!preventLeave) {
        return;
    }
    var message = control.Content.Page.LeaveRequested();
    return message;
}
</script> 
```

银光代码：

```
public MainPage()
{
    InitializeComponent();
    HtmlPage.RegisterScriptableObject("Page", this);
}

[ScriptableMember]
public string LeaveRequested()
{
    return "You have unsaved changes to your current document?";
}

[ScriptableMember]
public bool PreventLeave()
{
    return (bool)PreventLeaveCheckBox.IsChecked;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T09:02:42.613

这可以使用 javascript 轻松完成。例如：

 `````
<html>
    <head>
    <script type="text/javascript">
    <!--
        function closeIt(url,name)
        {
            return "Hi there! I'm a message!";
        }
        window.onbeforeunload = closeIt;
    // -->
    </script>
    </head>

    <body>
    <p>I'm a webpage!</p>
    </body>
</html> 
`````

# javascript - inline svg -- getElementById 在 Opera 中不起作用

> ID：12277724
> 
> 赞同：3
> 
> 时间：2012-09-05T08:51:55.700
> 
> 标签：javascript, svg

我有内联 svg 并希望通过以下方式获取其中的一些元素：

```
svgdoc.getElementById( 'someid' ); 
```

适用于 Firefox、chrome，但不适用于 Opera。结果是`null`。页面 (html5) 以`xhtml`(content-type: application/xhtml+xml ) 形式提供，html 根元素包含所有出现在 inline-svg (svg, inkscape, ... ) 中的命名空间声明，这些声明是用 inkscape 和直接注入源。

所以，html元素看起来像这样：

```
<!DOCTYPE html>
<html 
    xmlns="http://www.w3.org/1999/xhtml" 
    xmlns:svg="http://www.w3.org/2000/svg"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:cc="http://creativecommons.org/ns#"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
    xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"> 
```

并且包含的​​ svg 的头部如下所示：

```
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   version="1.1"
   width="581.75085"
   height="382"
   inkscape:version="0.48.3.1 r9886" > 
```

`<?xml ... ?>`声明在 html-source 中被删除。

编辑：：

上面的解释有一点点错误... 将 SVG 注入到 ajax 响应的源中，然后通过 element.innerHTML 将其注入到 dom 中。请原谅这次失败！

顺便说一句：`getElementsByTagName()`有效。

```
console.log( svgdoc.getElementByID ) --> function getElementById(){ [native code] } 
```

这真的很奇怪，这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-03-09T00:09:33.910

我不确定这是否仍然与这个问题相关，但我最近发现如果要获取的元素是 SVG 子元素并且 SVG 还不是 DOM 的子子元素，Opera 12 无法 getElementById() 。

因此，在使用新创建的 SVG 中的 ID 对元素调用 document.getElementById() 之前，我们必须通过将整个 SVG 附加到 document.body 或其中的其他容器来将整个 SVG 添加到 DOM。然后它工作。

# php - 网页设计问题

> ID：12277726
> 
> 赞同：3
> 
> 时间：2012-09-05T08:52:10.303
> 
> 标签：php

亲爱的朋友们，我需要你的帮助.. 首先一点背景..

我正在使用 codeigniter 在 PHP 中创建一个网站。问题是网站的设计变得如此复杂和令人困惑，以至于我无法理解它。这是我已经做过的事情和问题......（请多多包涵）

1.  我正在使用 MVC，代码分布在视图、模型和控制器中。但是代码变得很长，有数百个函数，每个模型超过 300 行。
2.  AM 使用类（显然）和常用功能被捆绑到库中。我还创建了基本功能的用例（使用普通流程图）。但是，当我开始编程（有很多新事物出现）一段时间后，图表和正在编写的程序之间没有相似之处，这似乎是一个我必须先写后画的练习。
3.  每次出现问题并且我必须修复一个模块时，我都必须重新学习我是如何做到的，因为它是一个混合的函数网络，调用函数调用函数。
4.  我将亿图思维导图用于基本图表，但几乎没有从图表中获得任何帮助，因为每当我在一个（图表或软件）上说话时，它都会呈现出与另一个不同的形状。

我的问题是：

1:: 我是不是做错了什么？除了使用 MVC 类和库来组织网站代码之外，还有更多内容吗？2::其他开发人员如何制作图表，我可以看到他们设计的一些真实示例。3:: 任何关于进一步组织代码的想法

您将不胜感激任何帮助形式..

虽然这是一个很长的镜头，但 **是否有一个系统可以将代码添加到他开发的图表中，而不是在一长串代码中键入一个又一个函数。**例如，当我们在流程图中设计模块时，我们可以直接在图中添加代码而不是恢复编码？？？？

# java - 在客户端使用 GWT 构建 RSS

> ID：12277728
> 
> 赞同：2
> 
> 时间：2012-09-05T08:52:15.173
> 
> 标签：java, xml, gwt

我使用 com.google.gwt.xml.client.*。

我需要在 XML 的开头和项目块内创建标题元素。但是当我选择 createElement("title") 和 appendChild(title) 时，最后我只得到一个 Element 标题。

```
private void formXMLToSend(){
  Document doc = XMLParser.createDocument();
  Element root = doc.createElement("rss");
  root.setAttribute("version", "2.0");
  doc.appendChild(root);

  Element chl = doc.createElement("channel");
  root.appendChild(chl);

  Element title = doc.createElement("title");
  title.appendChild(doc.createTextNode("sitename"));
  Element link = doc.createElement("link");
  link.appendChild(doc.createTextNode("http://mysite.com"));

  chl.appendChild(title);
  chl.appendChild(link);

  for(int i = 0; i < items.size(); i++){
    Element item = doc.createElement("item");
    Element subTitle = doc.createElement("title");
    title.appendChild(doc.createTextNode(items.get(i).getName()));
    Element descr = doc.createElement("description");
    descr.appendChild(doc.createTextNode(items.get(i).getText()));
    item.appendChild(title);
    item.appendChild(descr);
    chl.appendChild(item,link);
  }

  Window.alert(doc.toString());
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T12:21:38.273

```
public  String createRss2(List<Item> items){
    Document doc = (Document) XMLParser.createDocument();
    Element root = doc.createElement("rss");
    root.setAttribute("version", "2.0");
    doc.appendChild(root);

    Element chl = doc.createElement("channel");
    root.appendChild(chl);

    Element title = doc.createElement("title of the feed");
    title.appendChild(doc.createTextNode("sitename"));
    chl.appendChild(title);

    Element link = doc.createElement("link");
    link.appendChild(doc.createTextNode("http://mysite.com"));
    chl.appendChild(link);

    Element description = doc.createElement("description");
    description.appendChild(doc.createTextNode("some description"));
    chl.appendChild(description);

    Element lang = doc.createElement("language");
    lang.appendChild(doc.createTextNode("en"));
    chl.appendChild(lang);

    Element copyright = doc.createElement("copyright");
    copyright.appendChild(doc.createTextNode("nicolas schwarzentrub"));
    chl.appendChild(copyright);

    Element pubDate = doc.createElement("pubDate");
    pubDate.appendChild(doc.createTextNode(DateTimeFormat.getFormat("EEE, dd MMM yyyy hh:mm:ss ZZZZ").format(new Date())));
    chl.appendChild(pubDate);

    Element image = doc.createElement("image");
    Element imageUrl = doc.createElement("url");
    imageUrl.appendChild(doc.createTextNode("https://ssl.gstatic.com/gb/images/j_e6a6aca6.png"));
    Element imageTitle = doc.createElement("title");
    imageTitle.appendChild(doc.createTextNode("some title of image"));
    Element imageLink = doc.createElement("link");
    imageLink.appendChild(doc.createTextNode("http://www.google.ch/"));

    image.appendChild(imageUrl);
    image.appendChild(imageTitle);
    image.appendChild(imageLink);
    chl.appendChild(image);

    for(Item obj : items)
    {
        Element item = doc.createElement("item");

        Element itemTitle = doc.createElement("title");
        itemTitle.appendChild(doc.createTextNode(obj.getName()));
        item.appendChild(itemTitle);

        Element itemDescription = doc.createElement("description");
        itemDescription.appendChild(doc.createTextNode(obj.getText()));
        item.appendChild(itemDescription);

        Element itemLink = doc.createElement("link");
        itemLink.appendChild(doc.createTextNode(obj.getLink()));
        item.appendChild(itemLink);

        Element itemAuthor = doc.createElement("author");
        itemLink.appendChild(doc.createTextNode(obj.getAuthor()));
        item.appendChild(itemAuthor);
        //and others if needed ..
        Element itemPubDate = doc.createElement("pubDate");
        itemPubDate.appendChild(doc.createTextNode(DateTimeFormat.getFormat("EEE, dd MMM yyyy hh:mm:ss ZZZZ").format(new Date())));
        item.appendChild(itemPubDate);

        //append this item to the link element
        chl.appendChild(item);
    }

   return doc.toString();
  } 
```

要对其进行测试，请将以下内容放入 GWTTestCase

```
 List<Item> theItems = new ArrayList<TestXML.Item>();
    for(int i= 0; i<3 ; i++)
    {
    theItems.add(new Item("item "+i, "description of item "+i, "n.s","http://www.stackoverflow.com"));
    }

    System.out.println( createRss2(theItems)); 
```

以下上面的代码片段将生成下面的 xml

```
<rss version="2.0">
<channel>
    <title of the feed>sitename</title of the feed>
    <link>http://mysite.com</link>
    <description>some description</description>
    <language>en</language>
    <copyright>nicolas schwarzentrub</copyright>
    <pubDate>Wed, 05 Sep 2012 02:15:07 GMT+02:00</pubDate>
    <image>
        <url>https://ssl.gstatic.com/gb/images/j_e6a6aca6.png</url>
        <title>some title of image</title>
        <link>http://www.google.ch/</link>
    </image>
    <item>
        <title>item 0</title>
        <description>description of item 0</description>
        <link>http://www.stackoverflow.comn.s</link>
        <author />
        <pubDate>Wed, 05 Sep 2012 02:15:07 GMT+02:00</pubDate>
    </item>
    <item>
        <title>item 1</title>
        <description>description of item 1</description>
        <link>http://www.stackoverflow.comn.s</link>
        <author />
        <pubDate>Wed, 05 Sep 2012 02:15:07 GMT+02:00</pubDate>
    </item>
    <item>
        <title>item 2</title>
        <description>description of item 2</description>
        <link>http://www.stackoverflow.comn.s</link>
        <author />
        <pubDate>Wed, 05 Sep 2012 02:15:07 GMT+02:00</pubDate>
    </item>
</channel> 
```

# excel - 在c#中查询从excel表中读取数据

> ID：12277729
> 
> 赞同：2
> 
> 时间：2012-09-05T08:52:14.767
> 
> 标签：excel, c#-4.0

*感谢**Astander**回复我的询问*

我在这里有更详细的查询。

```
 string cs = "Provider=Microsoft.ACE.OLEDB.12.0;" + "Data Source=" + @"D:\\sample.xls;" + "Excel 12.0;HDR=YES;";
        OleDbConnection Excelcon = new OleDbConnection(cs);
        OleDbDataAdapter ad = new OleDbDataAdapter();
        ad.SelectCommand = new OleDbCommand("SELECT *FROM [Sheet1$]", Excelcon);
        DataTable dt = new DataTable();
        ad.Fill(dt);
        return dt; 
```

我在 select 语句中收到错误：

> **Microsoft Office Access 数据库引擎找不到对象“Sheet1$”。确保对象存在并且正确拼写其名称和路径名。**

希望有人可以帮助我找到解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T09:30:42.610

对我有用的是，创建文件时，它存储在某个特定位置。就我而言，`C:/Documents`.

我手动将位置更改为 D：这是我写的

> string connStringExcel = @"Provider=Microsoft.ACE.OLEDB.12.0; 数据源= ***D:\example.xls*** ;Extended Properties=""Excel 12.0;HDR=YES;""";`

所以，实际路径应该是

> string connStringExcel = @"Provider=Microsoft.ACE.OLEDB.12.0; 数据源=C:\A\Documents\example.xls;Extended Properties=""Excel 12.0;HDR=YES;""";`

所以在给出正确位置的路径时，我的查询就解决了。

希望它也对其他人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-10T05:49:43.180

```
// Create connection string variable. Modify the "Data Source"
// parameter as appropriate for your environment.
String sConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;" +
"Data Source=" + Server.MapPath("../ExcelData.xls") + ";" +
"Extended Properties=Excel 8.0;";

// Create connection object by using the preceding connection string.
OleDbConnection objConn = new OleDbConnection(sConnectionString);

// Open connection with the database.
objConn.Open();

// The code to follow uses a SQL SELECT command to display the data from the worksheet.

// Create new OleDbCommand to return data from worksheet.
OleDbCommand objCmdSelect =new OleDbCommand("SELECT * FROM myRange1", objConn);

// Create new OleDbDataAdapter that is used to build a DataSet
// based on the preceding SQL SELECT statement.
OleDbDataAdapter objAdapter1 = new OleDbDataAdapter();

// Pass the Select command to the adapter.
objAdapter1.SelectCommand = objCmdSelect;

// Create new DataSet to hold information from the worksheet.
DataSet objDataset1 = new DataSet();

// Fill the DataSet with the information from the worksheet.
objAdapter1.Fill(objDataset1, "XLData");

// Bind data to DataGrid control.
DataGrid1.DataSource = objDataset1.Tables[0].DefaultView;
DataGrid1.DataBind();

// Clean up objects.
objConn.Close(); 
```

参考[thisLink](https://support.microsoft.com/en-us/help/306572/how-to-query-and-display-excel-data-by-using-asp-net-ado-net-and-visua)

# matlab - 检索过去的结果

> ID：12277730
> 
> 赞同：0
> 
> 时间：2012-09-05T08:52:47.663
> 
> 标签：matlab

是否可以在命令窗口中检索以前的结果？例如，我在命令窗口中有一些矩阵和向量，并且在出现错误后关闭了 matlab。有可能找回它们吗？

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2017-02-13T20:48:23.367

不能保证崩溃后会发生什么，但一般来说，使用该命令将所有文本 （而**不是**窗口） `diary('filename.txt')` 附加到该文本文件。`CommandWindow`**`Command History`**

 **（我不知道为什么 MathWorks 不将“CommandWindow”称为“CommandWindow”，即控制台，但你在那里。）**

# javascript - Firefox：从网页强制全屏模式

> ID：12277731
> 
> 赞同：0
> 
> 时间：2012-09-05T08:52:49.820
> 
> 标签：javascript, firefox, browser

我正在开发一个基于 web 的数据库，需要通过 firefox 网络浏览器打开（因为一些 css3 元素）。我希望页面以全屏模式自动打开。我不希望数据库的用户可以访问 firefox 菜单项

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:54:27.277

**如果您只是控制网页，则**无法完成。**网页中的控件不会导致浏览器实例本身发生变化。**

 **如果允许，这将是一个安全问题。您可以考虑编写一个 Firefox 扩展来做到这一点，因为他们可以**更多地访问**浏览器实例本身。

您不应该试图隐藏 firefox 菜单控件。这似乎是您解决问题方法的一个缺陷。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T12:44:08.500

您将需要查看浏览器的全屏 API。如果您在应用程序中接受用户的小请求/信息，则可以很容易地完成。你不能强迫用户违背他的意愿进入全屏模式。这很好（出于安全原因）。

[http://hacks.mozilla.org/2012/01/using-the-fullscreen-api-in-web-browsers/](http://hacks.mozilla.org/2012/01/using-the-fullscreen-api-in-web-browsers/)**

# c++ - 模板元编程递归上限？

> ID：12277732
> 
> 赞同：18
> 
> 时间：2012-09-05T08:52:57.340
> 
> 标签：c++, templates, template-meta-programming

我正在编写一个非常简单的模板类，使用元编程来计算编译时的总和，如下所示：

```
#include <iostream>

using namespace std;

template<int N>
class Sum
{
    public:
        enum {value = N + Sum<N-1>::value };
};

template<>
class Sum<0>
{
    public:
        enum {value = 0};
};

int main()
{
    cout << Sum<501>::value << endl;
} 
```

有趣的是：

*   当我打印 Sum<500> 及以下时，它工作正常
*   当涉及 Sum<501> 时，编译失败：

    > sum.cpp:9: 从`Sum<500>' sum.cpp:9: instantiated from`Sum<501>' 实例化 sum.cpp:22: 从这里实例化
    > 
    > sum.cpp:9：错误：不完整的类型`Sum<1>' used in nested name specifier sum.cpp:9: error: enumerator value for`值'不是整数常量

*   Sum<501>会报Sum<1>的错误，Sum<502>会报Sum<2>的错误，差总是2，在我看来编译器有500的限制资源。

对此有任何想法吗？他们是打破这个限制的方法吗？

谢谢。

*编辑：*
谢谢大家，重点不在于算法，而在于编译器的限制——我知道有一种简单的方法可以得到总和:)

*编辑2：*

*   使用 gcc 4.6 +，错误信息更有帮助

    > sum.cpp:9:14: 错误: 模板实例化深度超过最大值 1024 (使用 -ftemplate-depth= 增加最大值) 实例化'class Sum<1>' sum.cpp:9:14: 从'Sum 递归实例化<1024>' sum.cpp:9:14: 从 'Sum<1025>' 实例化 sum.cpp:22:22: 从这里实例化

所以是的，使用 ftemplate-depth 是正确的方法。但是在 Windows 中呢？VC9.0 的上限是 499，似乎没有设置模板深度的选项，请参见[此处](http://msdn.microsoft.com/en-us/library/fwkeyyhe(v=VS.71).aspx)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-05T08:59:09.260

如果您使用的是 GCC，则可以使用 设置模板递归深度`-ftemplate-depth=X`，其中`X`是所需的深度：

```
g++ ...... -ftemplate-depth=750 
```

请记住，这不仅仅是您可以任意设置的一些限制。在某些时候，您会遇到操作系统和硬件限制。

关于您的实际 sum 函数，前 N 个正整数的 Sum 有一个众所周知的解析解。

（即`n*(n+1)/2`）

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-05T09:01:08.920

附录 B 规定了推荐的最低限度；对于*递归嵌套模板实例*，建议的最小限制为 1024。您的实现似乎有 500 的限制；这仍然是合规的，因为建议的最低限度只是指导方针。

您的编译器可能有一个命令行标志或其他选项来增加其递归嵌套模板实例化限制。

最简单的解决方法是使用非递归算法；在你的情况下，

```
template<int N>
class Sum
{
    public:
        enum {value = N * (N + 1) / 2 };
}; 
```

# c# - 通过asp.net将参数传递给sql触发器

> ID：12277733
> 
> 赞同：1
> 
> 时间：2012-09-05T08:52:59.337
> 
> 标签：c#, asp.net, sql-server-2008, entity-framework-4, triggers

问了一个非常菜鸟的问题。当任何用户最近插入更新和删除记录时，我实际上想跟踪我的数据库。

我创建了触发器以跟踪任何数据库更改。

这是我的 sql 触发器

```
 USE [test]
GO
/****** Object:  Trigger [dbo].[tr_trigtest1]    Script Date: 09/05/2012 16:31:18 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER TRIGGER [dbo].[tr_trigtest1] ON [dbo].[test1] FOR INSERT, UPDATE, DELETE
AS

DECLARE @bit INT ,
       @field INT ,
       @maxfield INT ,
       @char INT ,
       @fieldname VARCHAR(128) ,
       @TableName VARCHAR(128) ,
       @PKCols VARCHAR(1000) ,
       @sql VARCHAR(2000), 
       @UpdateDate VARCHAR(21) ,
       @UserName VARCHAR(128) ,
       @Type CHAR(1) ,
       @PKSelect VARCHAR(1000)

--You will need to change @TableName to match the table to be audited
SELECT @TableName = 'trigtest'

-- date and user
SELECT         @UserName = @UserName ,
       @UpdateDate = CONVERT(VARCHAR(8), GETDATE(), 112) 
               + ' ' + CONVERT(VARCHAR(12), GETDATE(), 114)

-- Action
IF EXISTS (SELECT * FROM inserted)
       IF EXISTS (SELECT * FROM deleted)
               SELECT @Type = 'U'
       ELSE
               SELECT @Type = 'I'
ELSE
       SELECT @Type = 'D'

-- get list of columns
SELECT * INTO #ins FROM inserted
SELECT * INTO #del FROM deleted

-- Get primary key columns for full outer join
SELECT @PKCols = COALESCE(@PKCols + ' and', ' on') 
               + ' i.' + c.COLUMN_NAME + ' = d.' + c.COLUMN_NAME
       FROM    INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,

              INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
       WHERE   pk.TABLE_NAME = @TableName
       AND     CONSTRAINT_TYPE = 'PRIMARY KEY'
       AND     c.TABLE_NAME = pk.TABLE_NAME
       AND     c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME

-- Get primary key select for insert
SELECT @PKSelect = COALESCE(@PKSelect+'+','') 
       + '''<' + COLUMN_NAME 
       + '=''+convert(varchar(100),
coalesce(i.' + COLUMN_NAME +',d.' + COLUMN_NAME + '))+''>''' 
       FROM    INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
               INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
       WHERE   pk.TABLE_NAME = @TableName
       AND     CONSTRAINT_TYPE = 'PRIMARY KEY'
       AND     c.TABLE_NAME = pk.TABLE_NAME
       AND     c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME

IF @PKCols IS NULL
BEGIN
       RAISERROR('no PK on table %s', 16, -1, @TableName)
       RETURN
END

SELECT         @field = 0, 
       @maxfield = MAX(ORDINAL_POSITION) 
       FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = @TableName
WHILE @field < @maxfield
BEGIN
       SELECT @field = MIN(ORDINAL_POSITION) 
               FROM INFORMATION_SCHEMA.COLUMNS 
               WHERE TABLE_NAME = @TableName 
               AND ORDINAL_POSITION > @field
       SELECT @bit = (@field - 1 )% 8 + 1
       SELECT @bit = POWER(2,@bit - 1)
       SELECT @char = ((@field - 1) / 8) + 1
       IF SUBSTRING(COLUMNS_UPDATED(),@char, 1) & @bit > 0
                                       OR @Type IN ('I','D')
       BEGIN
               SELECT @fieldname = COLUMN_NAME 
                       FROM INFORMATION_SCHEMA.COLUMNS 
                       WHERE TABLE_NAME = @TableName 
                       AND ORDINAL_POSITION = @field
               SELECT @sql = '
insert Audit (    Type, 
               TableName, 
               PK, 
               FieldName, 
               OldValue, 
               NewValue, 
               UpdateDate, 
               UserName)
select ''' + @Type + ''',''' 
       + @TableName + ''',' + @PKSelect
       + ',''' + @fieldname + ''''
       + ',convert(varchar(1000),d.' + @fieldname + ')'
       + ',convert(varchar(1000),i.' + @fieldname + ')'
       + ',''' + @UpdateDate + ''''
       + ',''' + @UserName + ''''
       + ' from #ins i full outer join #del d'
       + @PKCols
       + ' where i.' + @fieldname + ' <> d.' + @fieldname 
       + ' or (i.' + @fieldname + ' is null and  d.'
                                + @fieldname
                                + ' is not null)' 
       + ' or (i.' + @fieldname + ' is not null and  d.' 
                                + @fieldname
                                + ' is null)' 
               EXEC (@sql)
       END
END 
```

一切都很顺利，当任何记录更新、插入和删除时，我都会得到这些细节

![在此处输入图像描述](../Images/194a7a2b0a57f3ec967dba23eea1f37d.png)

我的编码

```
public partial class WebForm1 : System.Web.UI.Page
{
    private testEntities entity = new testEntities();
    protected void Page_Load(object sender, EventArgs e)
    {
        trigtest test = trigtest.Createtrigtest(10, 12);
       entity.AddTotrigtests(test);
        entity.SaveChanges();
    }
} 
```

所以现在我遇到了一个问题。是否可以通过后端代码将值传递给@username？如何修改触发器？对不起，我对 sql trigger 仍然很新鲜。不知道怎么修改

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:55:13.600

用户名由函数返回`SUser_SName()`

```
SELECT @UserName = SUser_SName(); 
```

实际返回的值取决于您的 EF 连接字符串。

# android - android，如何以编程方式设置 Radiobutton 按钮的左填充？

> ID：12277734
> 
> 赞同：4
> 
> 时间：2012-09-05T08:52:59.553
> 
> 标签：android, radio-button, padding

我用

```
appMusicTab.setButtonDrawable(R.drawable.all); 
```

设置 RadioButton 的按钮样式，

但是drawable总是在RadioGroup的左侧，如何在代码中为“按钮”设置左填充？谢谢！！

我试过了

```
appMusicTab.setPadding(20, 0, 0, 0); 
```

和：

```
 appMusicTab.setLeft(20); 
```

但那些不起作用。

这是我的代码：

```
 RadioButton appMusicTab = new RadioButton(mContext);

        appMusicTab.setText(tabInfo.name);
        appMusicTab.setTextSize(TypedValue.COMPLEX_UNIT_DIP, 25);
        appMusicTab.setGravity(Gravity.CENTER);
        appMusicTab.setId(tabInfo.id);
//        appMusicTab.setButtonDrawable(android.R.color.transparent);
        appMusicTab.setButtonDrawable(R.drawable.all);

        appMusicTab.setBackgroundResource(R.drawable.app_tab_bg);
        appMusicTab.setPadding(30, 0, 0, 0);
        RadioGroup.LayoutParams lp =
            new RadioGroup.LayoutParams(
                    RadioGroup.LayoutParams.MATCH_PARENT,
                    RadioGroup.LayoutParams.WRAP_CONTENT);
        lp.bottomMargin =MASettings.MAIN_UI_APP_TAB_MARGIN_BOTTOM;

        mAppsTab.addView(appMusicTab, lp); //mAppsTab is a RadioGroup 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T09:27:52.377

我使用带有一些透明填充的图标来解决这个问题。查了RadioButton源码，发现在代码中按钮Drawable的左内边距设置为0：buttonDrawable.setBounds(0, y, buttonDrawable.getIntrinsicWidth(), y + height);

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T09:08:45.607

为此，您必须设置 LayoutParams。

见下文：

```
qButt = new Button(this);
qButt.setPadding(0, 0, 0, 0);
TableRow.LayoutParams params = new TableRow.LayoutParams(BtnHeight,BtnHeight); // You can set any Layout params in Place of TableRow
YourParentLayout.addView(qButt,params); // Your parent layout may be any Layout in xml 
```

# javascript - FB.login 无效的 redirect_uri (xd_proxy.php)

> ID：12277735
> 
> 赞同：2
> 
> 时间：2012-09-05T08:53:02.173
> 
> 标签：javascript, facebook, facebook-graph-api, login, facebook-javascript-sdk

所以，我正在使用 Facebook JS SDK，我一直得到 191：

现在，我检查了我的设置，一切似乎都井井有条。应用程序域设置为我的基本域 (alehunt.com)，并且“使用 Facebook 登录的网站”=>“站点 URL：”设置为“http://www.alehunt.com”。我没有做任何与画布相关的事情。

在查看 FB.login 生成的登录对话框窗口的 URL 时，我很惊讶地发现 redirect_uri 没有直接指向我的应用程序，而是通过[http://static.ak.fbcdn.net/connect/ xd_proxy.php](http://static.ak.fbcdn.net/connect/xd_proxy.php)。我想知道这是否是 191 错误的原因。

现在，如果我将 redirect_uri 的那部分更改为我自己的，一切似乎都可以正常工作。对话框按应有的方式呈现。

完整的 URL 是[https://www.facebook.com/dialog/oauth?api_key=MYAPPID&app_id=MYAPPID&client_id=MYAPPID&display=popup&domain=www.alehunt.com&origin=1&redirect_uri=http%3A%2F%2Fstatic.ak.fbcdn.net% 2Fconnect%2Fxd_proxy.php%23cb%3Df2f3026b8%26origin%3Dhttp%253A%252F%252Fwww.alehunt.com%252Ff298bcee3c%26relation%3Dopener%26transport%3Dpostmessage%26frame%3Df3d63e980c&response_type=tokendk2%C](https://www.facebook.com/dialog/oauth?api_key=MYAPPID&app_id=MYAPPID&client_id=MYAPPID&display=popup&domain=www.alehunt.com&origin=1&redirect_uri=http%3A%2F%2Fstatic.ak.fbcdn.net%2Fconnect%2Fxd_proxy.php%23cb%3Df2f3026b8%26origin%3Dhttp%253A%252F%252Fwww.alehunt.com%252Ff298bcee3c%26relation%3Dopener%26transport%3Dpostmessage%26frame%3Df3d63e980c&response_type=token%2Csigned_request&scope=email&sdk=joey)

任何人都可以对此有所了解吗？为什么 JS SDK 坚持在重定向 URI 中设置所有这些？

我看到的错误是：

API错误代码：191 API错误描述：指定的URL不属于应用程序错误消息：无效的redirect_uri：应用程序配置不允许给定的URL。

我正在 Chrome 21 中进行测试

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:41:15.067

原来这是由于使用了由 Cordova (PhoneGap) 修改的 Facebook JS 客户端。仍然不确定到底是什么问题，但是当我直接从 Facebook 加载 JS 时一切正常。

# java - 使用无类委托的 Java DNS revese 查找

> ID：12277740
> 
> 赞同：0
> 
> 时间：2012-09-05T08:53:26.217
> 
> 标签：java, dns

我们正在尝试解析这个 IP 地址 81.95.126.172，挖掘产生

```
;; ANSWER SECTION:
172.126.95.81.in-addr.arpa. 974 IN      CNAME   172.128-26.126.95.81.in-addr.arpa.
172.128-26.126.95.81.in-addr.arpa. 32757 IN PTR hosted-by.futureweb.be. 
```

但在 Java 中，此测试失败，因为 getHostName() 返回相同的 IP 地址。

```
@Test
public void aaa() throws UnknownHostException {
    assertNull(System.getSecurityManager());
    assertEquals("hosted-by.futureweb.be", InetAddress.getByName("81.95.126.172").getHostName());
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:07:34.147

根据Javadocs `getHostName()`：

> 如果有安全管理器，首先调用它的 checkConnect 方法，并使用主机名和 -1 作为其参数，以查看是否允许该操作。如果不允许该操作，它将返回 IP 地址的文本表示。
> 
> **返回：** 此 IP 地址的主机名，或者如果安全检查不允许该操作，则返回 IP 地址的文本表示。

# android - Android GCM-不同应用程序的不同注册ID？

> ID：12277744
> 
> 赞同：0
> 
> 时间：2012-09-05T08:53:44.527
> 
> 标签：android, google-cloud-messaging

我正在尝试使用谷歌云消息服务。我想将它与几个不同的应用程序一起使用。我需要获得一个注册 ID，但是我是否必须为每个不同的应用程序获得一个不同的注册 ID？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:04:49.100

在 GCM 中，每个应用程序都是项目之一。因此，在具有不同应用程序的同一设备上，您将获得不同的注册 ID。欲了解更多信息，请访问[http://developer.android.com/guide/google/gcm/gcm.html](http://developer.android.com/guide/google/gcm/gcm.html)

# wpf - TextBlock 不显示所有文本

> ID：12277745
> 
> 赞同：2
> 
> 时间：2012-09-05T08:53:46.373
> 
> 标签：wpf, xaml

我对 TextBlock 的问题是它有时会切断文本。下图是它下面的 xaml 的输出。第一个 TextBlock 应该包含 Défi 最大值，但最后一个 m 被截断。当我改变部分风格时，它会重新出现，但我需要它完全像这样。这可能是什么原因？

如您所见，TextBlock 有足够的空间，下图中 TextBlock 周围的边距是蓝色的。第二个 TextBlock 有一个额外的字符，导致 TextBlock 正确显示文本。（即使其中有拼写错误；-)）

[![有效的 XHTML](../Images/c4ffd25f832c5d7e1fa65fb1eb3537b7.png)](https://i.stack.imgur.com/vsXNC.png)

```
<Window.Resources>
    <Style TargetType="TextBlock">
        <Setter Property="FontFamily" Value="Candara"/>
        <Setter Property="FontSize" Value="13"/>
        <Setter Property="FontWeight" Value="Regular"/>
        <Setter Property="Padding" Value="5"/>
        <Setter Property="Background" Value="Red"/>
        <Setter Property="TextWrapping" Value="Wrap"/>
        <Setter Property="TextAlignment"  Value="Center"/>
        <Setter Property="HorizontalAlignment" Value="Center"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
        <Setter Property="Margin" Value="0"/>
    </Style>

    <Style TargetType="Grid">
        <Setter Property="Width" Value="87"/>
        <Setter Property="Height" Value="87"/>
        <Setter Property="Background" Value="Blue"/>
        <Setter Property="Margin" Value="1"/>
    </Style>
</Window.Resources>

<StackPanel Orientation="Horizontal">
    <Grid>
        <TextBlock>Défi maximum</TextBlock>
    </Grid>
    <Grid>
        <TextBlock>Défi maximume</TextBlock>
    </Grid>
    <Grid>
        <TextBlock>3x10</TextBlock>
    </Grid>
    <Grid>
        <TextBlock>4x10</TextBlock>
    </Grid>
</StackPanel> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-05T08:56:50.627

减小字体大小或增加框宽度。

# javacard - 与 -useproxyclass 转换器选项相关

> ID：12277748
> 
> 赞同：2
> 
> 时间：2012-09-05T08:54:13.563
> 
> 标签：javacard

-useproxyclass 选项对 JCDK 3.0.1 及更高版本有什么作用？您能否分享一些与此相关的链接，材料。

我问这个的原因是如果我的小程序有任何对全局平台库的引用，那么转换器会因错误而失败：

**错误：找不到 java 编译器 (javac)。您是否安装了 Java JRE（不是 SDK）？com.sun.javacard.converter.ConverterException**

但是，如果我将此**-useproxyclass**选项传递给转换器，则不会显示错误。

# php - PHP中的上标字符导致MySQLi选择查询找到0行

> ID：12277751
> 
> 赞同：6
> 
> 时间：2012-09-05T08:54:41.360
> 
> 标签：php, mysql, character-encoding, mysqli, superscript

我正在使用 PHP 5.3.3 和 MySQL 5.1.61。有问题的列使用 UTF-8 编码，PHP 文件以 UTF-8 编码，没有 BOM。

在 Windows 上的 SQLyog 中使用 ² 字符执行 MySQLi 查询时，查询正确执行并显示正确的搜索结果。

如果我在 PHP 中执行同样的查询，它将执行但会显示 0 受影响的行。

这是我尝试过的：

*   同时使用 LIKE 而不是 =
*   将 PHP 文件的编码更改为 ANSI、UTF-8 without BOM 和 UTF-8
*   在运行查询之前执行“SET NAMES utf-8”和“latin1”
*   做了 header('Content-Type: text/html; charset=UTF-8'); 在 PHP 中
*   使用 MySQLi::real_escape_string 转义
*   做一个 filter_var($String, FILTER_SANITIZE_STRING)
*   尝试了 MySQLi stmt 绑定

我能让它正常工作的唯一方法是，如果我将 ² 换成 % 并将 = 更改为 PHP 中的 LIKE。

使用²时如何在PHP中正确查询？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T14:11:01.537

通过确保以下内容，您应该能够使查询正常工作：

## 为 UTF-8 准备 PHP

您首先需要确保将发出这些查询的 PHP 页面作为 UTF-8 编码页面提供。这将确保正确显示来自数据库的任何 UTF-8 输出。在 Firefox 中，您可以通过访问您感兴趣的页面并使用“*查看页面信息”*菜单项来检查是否是这种情况。当你这样做时，你应该看到**UTF-8**作为页面的*Encoding*的值。如果页面不是以 UTF-8 格式提供的，您可以使用以下两种方法之一。您可以在对 的调用中设置编码`header()`，如下所示：

```
header('Content-Type: text/html; charset=UTF-8'); 
```

或者，您可以在页面块中使用`meta`标签：`head`

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
```

## 为 UTF-8 准备 MySQL

接下来，您需要确保将数据库设置为使用 UTF-8 编码。这可以在服务器、数据库、表或列级别进行设置。如果您在共享主机上，您可能只能控制层次结构的表和列级别。如果您可以控制服务器或数据库，则可以通过发出以下两个命令来检查它们使用的字符编码：

```
SHOW VARIABLES LIKE 'character_set_system';
SHOW VARIABLES LIKE 'character_set_database'; 
```

可以使用如下命令更改数据库级别的编码：

```
(CREATE | ALTER) DATABASE ... DEFAULT CHARACTER SET utf8; 
```

要查看表使用的字符编码，只需执行以下操作：

```
SHOW CREATE TABLE myTable; 
```

同样，以下是更改表级编码的方法：

```
(CREATE | ALTER) TABLE ... DEFAULT CHARACTER SET utf8; 
```

我建议在层次结构中将编码设置得尽可能高。这样，您不必记住为新表手动设置它。现在，如果您的表的字符编码尚未设置为 UTF-8，您可以尝试使用如下`alter`语句对其进行转换：

```
ALTER TABLE ... CONVERT TO CHARACTER SET utf8; 
```

**使用此语句时要非常小心！**如果您的表中已有 UTF-8 值，则在您尝试转换时它们可能会损坏。但是，有[一些方法可以解决这个问题](http://codex.wordpress.org/Converting_Database_Character_Sets)。

## 强制 MySQLi 使用 UTF-8

最后，在连接到数据库之前，请确保发出适当的调用来说明您正在使用 UTF-8 编码。就是这样：

```
$db = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);

// Change the character set to UTF-8 (have to do it early)
if(! $db->set_charset("utf8"))
{
    printf("Error loading character set utf8: %sn", $db->error);
} 
```

一旦你这样做了，一切都应该按预期工作。您需要担心编码的唯一字符是 HTML 的 big 5: `<, >, ', ", and &`。您可以使用[htmlspecialchars()](http://us3.php.net/manual/en/function.htmlspecialchars.php)函数来处理它。

如果您想了解更多信息（并获取其他资源的链接），请随时查看我撰写的有关此过程的文章。有两个部分：[Unicode 和 Web：第 1 部分](http://www.borngeek.com/2008/07/25/unicode-and-the-web-part-1/)，以及[Unicode 和 Web：第 2 部分](http://www.borngeek.com/2008/08/18/unicode-and-the-web-part-2/)。祝你好运！

# crystal-reports - 如何有条件地更改水晶报表图表中的轴比例？

> ID：12277755
> 
> 赞同：4
> 
> 时间：2012-09-05T08:54:58.520
> 
> 标签：crystal-reports, charts, crystal-reports-xi

有没有办法（或解决方法）有条件地设置水晶报告图表中轴的最大值和最小值（以及甚至刻度间隔）？

我希望能够在两个不同的折线图上具有相同的比例，其中一个峰值约为 75 英尺，另一个峰值约为 110 英尺，这使得自动值选择不同的比例。手动设置这些值意味着如果数字在某个时间发生较大变化，我必须更改这些值，并且使报告在其他不同规模的业务单位上的可重用性降低。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-06T15:02:28.653

我在 Crystal Reports 中的图表也遇到了同样的问题。我能做的最好的事情是使用图表专家中轴选项卡上的“分割数”选项。此外，在“数据值”部分，在我的版本中，默认情况下未选中“自动缩放”复选框。在 Xcelsius（Crystal Dashboards）中，您可以通过单元格引用轻松设置轴范围，但 Crystal Reports 似乎没有为我们提供该选项。

# php - 如何使用 PHP 和 MySQL 对图像进行投票和排名

> ID：12277759
> 
> 赞同：-3
> 
> 时间：2012-09-05T08:55:13.050
> 
> 标签：php, mysql, ranking

我正在尝试构建一个 php 排名系统，用户可以在其中以 1-5 的比例对图像进行排名。

根据图像的排名方式决定它在排行榜上的位置（排名编号）。排名应该根据从用户那里收到的不同评级而变化。

这方面的一个例子是这里的排名系统。[http://www.newgrounds.com/portal/view/601966](http://www.newgrounds.com/portal/view/601966)（右侧，页面下方。）

我只是在寻找任何可以帮助我实现这一目标的信息。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:07:35.590

以下是您需要了解的一些事项：

你需要一个数据库。在您的数据库中，您需要存储要排名的每个图像，在名为“图像”的表中执行此操作。在此表中，您将为每个图像提供一个“自动递增”主键。（这意味着对于您添加到数据库的每个新行，主键将自动比前一行 +1）。这意味着每个图像旁边都有一个唯一的行号 - 标识该特定行。打电话给这个专栏`id`。（我们将在列中的其他表格中引用它`image_id`）。

接下来，您需要一个名为“votes”的表。在此表中，您可以存储您可能需要的各种信息，但您需要存储的只是“图像”表中的唯一图像编号和某人投票的值。你最终会得到这样的东西：

```
image_id | vote_value
1        | 3
2        | 5
1        | 3
4        | 1
4        | 3 
```

现在您可以查询此信息以获取您的排行榜。查询可能如下所示：

```
SELECT image_id, SUM(vote_value) AS rank FROM votes GROUP BY image_id ORDER_BY rank; 
```

这将为您提供按排名排序的“image_id”列表（即所有选票的总数）。

然后您可以返回到您的图像表并从该表中获取该图像的信息。

```
SELECT name, url FROM images WHERE id=#image_id we got above#; 
```

希望这对您有所帮助。:) 如果你被卡住了，回来再问一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T08:59:27.453

创建一个名为 votes 的表并将其绑定到您的 images 表：

投票：

vote_id INT(11) PK

user_id INT(11)

image_id INT(11)

评分 TINYINT(1)

# android - 如何将字符串与 SELECT 结果进行比较？

> ID：12277762
> 
> 赞同：2
> 
> 时间：2012-09-05T08:55:40.643
> 
> 标签：android, string, select

我用方法

`rawQuery("select * from schedule where week = ? and firstweek < ? and lastweek > ?", new String[]{weekday})`

位置“？” 是字符串，但如何与 Select 语句进行比较？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:57:31.123

给定查询需要三个参数，再向字符串数组添加两个：

```
new String[]{weekday, new Date(), new Date()} 
```

# java - 可以用来自 json 的 json 值填充当前对象吗？

> ID：12277765
> 
> 赞同：1
> 
> 时间：2012-09-05T08:56:05.650
> 
> 标签：java, android, gson

我想在对象构造函数中用来自 Json 的值填充对象字段。

```
public AbstractObject(String jsonSerializedObject) {
    Gson gson = new Gson();

    // Fill object values from json in *current* object
} 
```

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T20:19:25.080

Gson 还不支持“填充现有对象”。请参阅此处的问题 431。

[http://code.google.com/p/google-gson/issues/detail?id=431&q=existing](http://code.google.com/p/google-gson/issues/detail?id=431&q=existing)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-11T08:26:38.877

您可以使用 InstanceCreator 来提供要填充的对象。

```
final Foo existing;
InstanceCreator<Foo> creator = new InstanceCreator<Foo>() {
  public Foo createInstance(Type type) { return existing; }
}

Gson gson = new GsonBuilder().registerTypeAdapter(Foo.class, creator).create();
Foo value = gson.fromJson(jsonString, Foo.class);
// value should be same as existing 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-02T15:18:32.870

[http://www.javacreed.com/gson-typeadapter-example/](http://www.javacreed.com/gson-typeadapter-example/)

用要填充的对象覆盖构造函数，然后在`read(jsonReader: JsonReader)`方法中更新对象。

Kotlin 中的示例：

```
class TypeAdapterGen : TypeAdapter<Gen> {

    var mGen: Gen

    constructor(gen: Gen) : super(){
        mGen = gen
    }
} 
```

# c# - 从 FileSystemWatcher C# 捕获缺少事件

> ID：12277772
> 
> 赞同：2
> 
> 时间：2012-09-05T08:56:15.947
> 
> 标签：c#, events

我正在尝试创建一个简单的应用程序，它将所有写入某个目录的文件移动到另一个目录。那是我的问题：如果我在我的目录中一次写入 10000 个以外的文件（超过 1KB 的小 .txt 文件） - 其中一些不处理移动到输出目录。我正在使用 FileSystemWatcher 事件处理程序来解决这个问题。这是我的代码示例：

```
Class MyProgramm
{
    void Process(Object o, FileSystemEventArgs e)
    {
        //do something with e.Name file
    }
    void main()
    {
        var FSW = New FileSystemWatcher{Path = "C:\\InputDir"};
        FSW.Created += Process;
        FSW.EnableRisingEvents = true;
        Thread.Sleep(Timeout.Infinite);
    }
} 
```

最后，我们处理了一些文件，但一些书面文件仍未处理..有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T10:20:47.210

FileSystemWatcher 也有类似的问题。它似乎经常“丢球”。我通过扩展“ServiceBase”来寻求替代解决方案，该解决方案自作为 Windows 服务上线以来一直在工作。希望这可以帮助：

```
 public partial class FileMonitor : ServiceBase
    {
        private Timer timer;
        private long interval;
        private const string ACCEPTED_FILE_TYPE = "*.csv";

        public FileMonitor()
        {           
            this.ServiceName = "Service";
            this.CanStop = true;
            this.CanPauseAndContinue = true;
            this.AutoLog = true;
            this.interval = long.Parse(1000);
        }

        public static void Main()
        {
            ServiceBase.Run(new FileMonitor());
        }

        protected override void OnStop()
        {
            base.OnStop();
            this.timer.Dispose();
        }

        protected override void OnStart(string[] args)
        {
            AutoResetEvent autoEvent = new AutoResetEvent(false);
            this.timer = new Timer(new TimerCallback(ProcessNewFiles), autoEvent, interval, Timeout.Infinite);
        }

        private void ProcessNewFiles(Object stateInfo)
        {
            DateTime start = DateTime.Now;
            DateTime complete = DateTime.Now;

            try
            {
                string directoryToMonitor = "c:\mydirectory";
                DirectoryInfo feedDir = new DirectoryInfo(directoryToMonitor);
                FileInfo[] feeds = feedDir.GetFiles(ACCEPTED_FILE_TYPE, SearchOption.TopDirectoryOnly);             

                foreach (FileInfo feed in feeds.OrderBy(m => m.LastWriteTime))
                {
                    // Do whatever you want to do with the file here
                }
            }
            finally
            {
                TimeSpan t = complete.Subtract(start);
                long calculatedInterval = interval - t.Milliseconds < 0 ? 0 : interval - t.Milliseconds;
                this.timer.Change(calculatedInterval, Timeout.Infinite);
            }
        }       
    } 
```

# mysql - 在 MySQL 中创建唯一的 select 语句

> ID：12277773
> 
> 赞同：1
> 
> 时间：2012-09-05T08:56:15.937
> 
> 标签：mysql, sql

我有一个 select 语句，至少应该只返回唯一的 userId。如果这没有发生并且 userIds 是双倍的，则用户确实输入了非法内容。

为了说明，我们使用一个简单的`SELECT userId, name, FROM USER`. 现在，通常您将在表级别设置 userId 唯一/主键。只是为了我们没有的例子。

预期的结果是：

```
userId    name
---------------
1         Roel
2         Joe
3         John 
```

但结果是这样的

```
userId    name
---------------
1         Roel
1         Roel
2         Joe
3         John
3         John 
```

是否有可能以这样一种方式进行查询，当结果包含多个 userId 时会出错？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:04:13.913

只需添加`DISTINCT`. 它会让你的行独一无二。

```
SELECT DISTINCT userId, name 
FROM USER 
```

根据定义，`DISTINCT`关键字可用于仅返回不同（不同）的值。

**更新 1**

原因是您没有在表上指定约束。像这样进行表定义。

```
CREATE TABLE userList
(
    ID INT NOT NULL AUTO_INCREMENT,
    NAME VARCHAR(50) NOT NULL,
    CONSTRAINT id_PK PRIMARY (ID),
    CONSTRAINT name_unique UNIQUE (NAME)
) 
```

当你不想`ID`被auto_incremented时，你可以去掉`AUTO_INCREMENT`表定义上的单词，或者像这样创建一个表定义

```
CREATE TABLE userList
(
    ID INT NOT NULL,
    NAME VARCHAR(50) NOT NULL,
    CONSTRAINT id_PK PRIMARY (ID),
    CONSTRAINT name_unique UNIQUE (ID, NAME)
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T08:59:22.230

```
SELECT 
    UserId, COUNT(*)
FROM 
    User
GROUP BY
    UserId
HAVING 
   COUNT(*) > 1 
```

从这里返回的任何记录都将是那些有错误数据的记录。这将是确定*何时引发*错误的最简单方法，但它不会简单地为您引发错误。您可以将上述查询包装到一个过程中，并使用一些逻辑来确定是引发错误还是运行主查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T09:08:56.553

好吧，我想这在注册期间很重要......所以在允许插入之前只需 count() 给定用户名的点击次数。

其次，使名称列唯一，然后在 INSERT 时得到正确的错误

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-19T17:26:43.023

另一种解决方案是

```
SELECT *
FROM User
UNION
SELECT *
FROM User 
```

这样做的好处是您不必在 SELECT 中列出变量。通常，不明确地写列名是不好的，但我认为这种情况是有意义的罕见情况之一。

# apache - 将完整的网站地址重定向到另一个地址 - Apache

> ID：12277775
> 
> 赞同：0
> 
> 时间：2012-09-05T08:56:21.880
> 
> 标签：apache, mod-rewrite

如何通过虚拟主机重定向以下内容：

```
http://www.surveys.abc.com/index.php?sid=14414&newtest=Y&lang=en 
```

到

```
http://www.abc.com 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:00:29.513

您实际上并不需要为此使用 Apache 的 mod_rewrite。

您可以调整 index.php 中的 PHP 代码以在 $_GET 中查找适当的值，然后像这样执行 PHP 重定向：

```
if (isset($_GET['sid']) && ($_GET['sid']==14414) && isset($_GET['newtest']) && ($_GET['newtest']==Y) && isset($_GET['lang']) && ($_GET['lang']=="en") ) {
      header( 'Location: http://www.abc.com' );
} 
```

# javascript - 如何向 d3.js 饼图或圆环图添加阴影

> ID：12277776
> 
> 赞同：17
> 
> 时间：2012-09-05T08:56:21.460
> 
> 标签：javascript, svg, d3.js, pie-chart

我正在使用 d3.js 制作一个简单的圆环图。

我无法实现投影或框阴影效果来为图表添加一些深度。我试过添加css：

```
path {
  -moz-box-shadow:    3px 3px 5px 6px #ccc;
  -webkit-box-shadow: 3px 3px 5px 6px #ccc;
  box-shadow:         3px 3px 5px 6px #ccc;
} 
```

到路径标签和g标签，但无济于事。有谁知道这是否可以通过 CSS 实现或知道某种字眼？

非常感谢对这样一个基本问题的帮助。马特

```
var data = [0, 35, 65];

var w = 400,
    h = 400,
    r = Math.min(w, h) / 2,
   ir = r * 0.5,
   color = d3.scale.category20(),
   donut = d3.layout.pie().sort(null),
   arc = d3.svg.arc().innerRadius(ir).outerRadius(r);

var svg = d3.select("body").append("svg:svg")
    .attr("width", w)
   .attr("height", h)
.append("svg:g")
   .attr("transform", "translate(" + w / 2 + "," + h / 2 + ")");

var arcs = svg.selectAll("path")
    .data(donut(data))
.enter().append("svg:path")
    .attr("fill", function(d, i) { return color(i); })
    .attr("d", arc); 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-06-28T20:51:14.157

万一有人遇到这种情况。. .

```
 /* For the drop shadow filter... */
  var defs = svg.append("defs");

  var filter = defs.append("filter")
      .attr("id", "dropshadow")

  filter.append("feGaussianBlur")
      .attr("in", "SourceAlpha")
      .attr("stdDeviation", 4)
      .attr("result", "blur");
  filter.append("feOffset")
      .attr("in", "blur")
      .attr("dx", 2)
      .attr("dy", 2)
      .attr("result", "offsetBlur");

  var feMerge = filter.append("feMerge");

  feMerge.append("feMergeNode")
      .attr("in", "offsetBlur")
  feMerge.append("feMergeNode")
      .attr("in", "SourceGraphic"); 
```

然后将此过滤器附加到 svg 元素，例如线条或条形或其他任何你喜欢的东西。. .

```
svg.append("path")
  .datum(data)
  .attr("class", "line")
  .attr("d", line)
  .attr("filter", "url(#dropshadow)"); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-11-17T02:05:08.407

如果您需要控制阴影的**颜色**，这对我有用：

```
var defs = svg.append("defs");

    var filter = defs.append("filter")
        .attr("id", "dropshadow")

    filter.append("feGaussianBlur")
        .attr("in", "SourceAlpha")
        .attr("stdDeviation", 4)
        .attr("result", "blur");
    filter.append("feOffset")
        .attr("in", "blur")
        .attr("dx", 2)
        .attr("dy", 2)
        .attr("result", "offsetBlur")
    filter.append("feFlood")
        .attr("in", "offsetBlur")
        .attr("flood-color", "#3d3d3d")
        .attr("flood-opacity", "0.5")
        .attr("result", "offsetColor");
    filter.append("feComposite")
        .attr("in", "offsetColor")
        .attr("in2", "offsetBlur")
        .attr("operator", "in")
        .attr("result", "offsetBlur");

    var feMerge = filter.append("feMerge");

    feMerge.append("feMergeNode")
        .attr("in", "offsetBlur")
    feMerge.append("feMergeNode")
        .attr("in", "SourceGraphic"); 
```

d3：来自这个答案：[https ://stackoverflow.com/a/25818296/1154787](https://stackoverflow.com/a/25818296/1154787)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-09-05T09:29:28.220

您可以使用 svg 过滤器，[这是一个示例](http://bl.ocks.org/1342359)，展示了如何应用模糊过滤器。

可以在[这里](http://xn--dahlstrm-t4a.net/svg/filters/arrow-with-dropshadow-lighter.svg)看到一个 dropshadow svg 过滤器的示例。结合这两个例子来得到你需要的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-19T21:54:22.357

我使用@Erik Dahlström 发布的信息为您制作了一个带有阴影的 d3.js SVG 矩形图形的简单注释示例：[http](http://bl.ocks.org/cpbotha/5200394) ://bl.ocks.org/cpbotha/5200394 :)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-22T19:53:20.380

根据谷歌的材料设计，阴影应该接近现实世界的条件，因为人类具有巨大的感知能力。因此，阴影应该由环境分量和投射分量组成。在此处查看 Google 的规范。

[http://www.google.com/design/spec/what-is-material/environment.html#environment-light-shadow](http://www.google.com/design/spec/what-is-material/environment.html#environment-light-shadow)

以上都是很好的阴影例子，但我找不到任何复合阴影的例子，所以我想分享这个定制的过滤器。它似乎确实使最终结果看起来更现实。

```
var id = "md-shadow";
var deviation = 2;
var offset = 2;
var slope = 0.25;

var svg = d3.select("#yoursvg");
var defs = svg.select("defs");

// create filter and assign provided id
var filter = defs.append("filter")
    .attr("height", "125%")    // adjust this if shadow is clipped
    .attr("id", id);

// ambient shadow into ambientBlur
//   may be able to offset and reuse this for cast, unless modified
filter.append("feGaussianBlur")
    .attr("in", "SourceAlpha")
    .attr("stdDeviation", deviation)
    .attr("result", "ambientBlur");

// cast shadow into castBlur
filter.append("feGaussianBlur")
    .attr("in", "SourceAlpha")
    .attr("stdDeviation", deviation)
    .attr("result", "castBlur");

// offsetting cast shadow into offsetBlur
filter.append("feOffset")
    .attr("in", "castBlur")
    .attr("dx", offset - 1)
    .attr("dy", offset)
    .attr("result", "offsetBlur");

// combining ambient and cast shadows
filter.append("feComposite")
    .attr("in", "ambientBlur")
    .attr("in2", "offsetBlur")
    .attr("result", "compositeShadow");

// applying alpha and transferring shadow
filter.append("feComponentTransfer")
    .append("feFuncA")
        .attr("type", "linear")
        .attr("slope", slope);

// merging and outputting results
var feMerge = filter.append("feMerge");
feMerge.append('feMergeNode')
feMerge.append("feMergeNode")
    .attr("in", "SourceGraphic"); 
```

这可以应用于对象，就像这样..

```
var r = element.append("rect")
    .attr("class", "element-frame")
    :   // other settings
    .style("filter", "url(#md-shadow)"); 
```

# ios - 使用 iOS 框架防止“重复符号”错误

> ID：12277786
> 
> 赞同：2
> 
> 时间：2012-09-05T08:57:07.290
> 
> 标签：ios, frameworks, duplicate-symbol

Apple 在其所有框架类的标头中使用以下代码。

```
#if !defined(__COREFOUNDATION_CFARRAY__)
#define __COREFOUNDATION_CFARRAY__ 1
...
#endif 
```

在为框架设计类或类别以供框架使用时，这是消除“重复符号”链接器错误的推荐方法，还是这些保留了使用 of`#include`而不是`#import`在 c 中的保护？

对此的研究使我找到了这篇关于[包含警卫的文章](http://en.wikipedia.org/wiki/Include_guard)

注意：这个问题不是询问如何修复重复符号错误，而是询问是否有任何方法可以防止您自己的代码在项目中包含多次时导致问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T09:17:51.933

您对 include 保护的看法是正确的 - 可能有一些兼容性原因，它没有从源代码中删除。

但是，这并不能真正保护您免受重复符号的影响。

例如，

如果您有两个第三方库，每个库都使用 SBJSON 库怎么办（几周前我的同事遇到过这种情况）。

每个库都是单独编译的，所以从他们的角度来看，SBJSON 只包含一次。但是，当我开始链接我的应用程序时，我不能，因为我有重复的符号。

我不得不通过从一个 .a 库文件中手动删除符号来解决这个问题（[这个链接](http://www.tokbox.com/forums/ios/library-symbol-collision-t11433)表明这是一个很常见的问题！）

编辑：[这个链接](http://atnan.com/blog/2012/01/12/avoiding-duplicate-symbol-errors-during-linking-by-removing-classes-from-static-libraries/)是一个更清晰的逐步解决问题的方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T09:17:42.747

> Apple 在其所有框架类的标头中使用以下代码。

不一定适用于 ObjC API。但是CoreFoundation，是的，他们使用包括警卫。在许多阵营中，`#include`在 C 源代码中使用传统的 s 并`#import`用于 objc 源代码（`#import`是编译器扩展，而不是传统的 C）仍然是惯用的。

> 这是消除“重复符号”链接器错误的推荐方法吗

不，它不能防止链接器错误；它可能会在编译阶段导致重复声明错误。

如果您收到重复的符号链接器错误，则问题出在其他问题上，例如定义的可见性。为此，您应该提供一个麻烦的程序示例。

# multithreading - 将两个神经网络合二为一

> ID：12277788
> 
> 赞同：1
> 
> 时间：2012-09-05T08:57:16.760
> 
> 标签：multithreading, machine-learning, neural-network, fann

我试图对[FANN](http://leenissen.dk/fann/wp/)库进行多线程扩展。因为 FANN 不是[线程安全](http://leenissen.dk/fann/forum/viewtopic.php?t=149)的，所以我会这样做：

1.  将训练集分成*N*块（*N*是 CPU 的数量）
2.  *将ANN*复制到*N*份
3.  在他的作品上训练每个人 1 个时期
4.  结合来自*N*个副本的*ANN权重*
**   如果不是结束条件转到 2。*

 *我的问题是：如何将神经网络权重合二为一。我能把所有的东西都弄得很刻薄吗？*

# javascript - 如何使用纯javascript设置嵌套在带有id的div中的a-tags

> ID：12277789
> 
> 赞同：1
> 
> 时间：2012-09-05T08:57:17.043
> 
> 标签：javascript, jquery, css

我习惯了 JQuery，但不习惯纯 Javascript。我有这个：

```
document.getElementById("div-id a").style.javascript_property = "color: red;"; 
```

当然，它不起作用。我想要的是一个特定 div 中具有 id='div-id' 的所有 a-tags 变为红色。

在 jquery 我会写：

```
$('#div-id a').css('color', 'red'); 
```

但我需要它在纯js中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T08:59:49.073

利用：

```
var div = document.getElementById("div-id");
var list = div.getElementsByTagName("a");
for (var i = 0; i < list.length; i++) {
  list[i].style.color = "red";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T09:00:58.743

该`getElementById`方法采用表示**id**的字符串，而不是选择器。线索就在名字里。该`querySelectorAll`方法接受一个表示选择器的字符串，但它返回一个 nodeList，因此您必须像数组一样循环它。

您调用的属性名称`javascript_property`需要与 CSS 属性名称匹配（连字符变成驼峰式）（应该是`"color"`）。

您给它的值需要匹配 CSS 属性值，而不是整个规则 (so `"red"`)。

然而，这些都不是纯 JavaScript。它是 DOM（`querySelectorAll`来自 Selectors API 的除外）。

# ruby - Mongo Ruby :connecttimeoutms 消失了？

> ID：12277792
> 
> 赞同：1
> 
> 时间：2012-09-05T08:57:22.053
> 
> 标签：ruby, mongodb

`:connecttimeoutms`在使用 mongodb ruby​​ gem 设置 MongoDB 连接时，我一直在使用连接选项。像这样：

```
connection = Connection.from_uri(uri, :connecttimeoutms => connect_timeout) 
```

现在收到警告

```
connecttimeoutms is not a valid option for Mongo::Connection 
```

自从最近`bundle update`。

这个消失了吗？有谁知道我应该用什么代替它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T12:20:04.657

@sumskyi 当然是绝对正确的

经过这样的调查，它似乎是现在`:connect_timeout`并且以秒为单位测量

谢谢

# .net - 如何计算所有线程花费的时间

> ID：12277794
> 
> 赞同：1
> 
> 时间：2012-09-05T08:57:25.493
> 
> 标签：.net, vb.net, multithreading, parallel-processing

我正在使用以下 .NET 代码

```
 Class MonitorSample
  Shared Sub RunMonitor()
    Dim o As New Object()
    For i As Integer = 0 To 99
    ThreadPool.QueueUserWorkItem(Function()
       Try
       Monitor.Enter(o)
       Console.WriteLine("Thread {0} acquired lock...working", Thread.CurrentThread.ManagedThreadId)
       Console.WriteLine("Thread {0} performing some I/O operation so yielding the lock temporarily...", Thread.CurrentThread.ManagedThreadId)
       Monitor.PulseAll(o)
       Monitor.Wait(o)
       Console.WriteLine("Thread {0} reacquired lock", Thread.CurrentThread.ManagedThreadId)
       Finally
       Console.WriteLine("Thread {0} released lock", Thread.CurrentThread.ManagedThreadId)
       Monitor.PulseAll(o)
       Monitor.Exit(o)
       End Try
     Return Nothing
   End Function
  )
  Next
  Console.ReadLine()
 End Sub
 Shared Sub Main()
 Dim stopwatch As New Stopwatch()
   stopwatch.Start()
   RunMonitor()
   stopwatch.Stop()
   Console.WriteLine("Time elapsed: {0}", stopwatch.Elapsed)
 End Sub
End Class 
```

在 main 方法中，这是计算线程消耗时间的正确方法，或者我们应该以其他方式计算。

实际上，打印时间消耗的步骤首先打印，而线程稍后执行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T10:32:17.330

您的 Sub 不会按照您的意愿行事 - 这里有 2 个问题

1.  有一个`Console.Readline`which 也将在 StopWatch 内等待用户的输入
2.  您没有正确同步线程 - 幸运的是，线程通常在等待用户输入时完成，但这不允许您为线程计时。

下面应该通过在线程周围紧密移动秒表来解决此问题，并提供一个[CountDownEvent](https://stackoverflow.com/questions/4192834/waitall-for-multiple-handles-on-a-sta-thread-is-not-supported)以允许每个线程指示它何时完成。

```
 Shared Sub RunMonitor()
        Dim stopwatch As New Stopwatch()
        stopwatch.Start()
        Dim o As New Object()
        Const numThreads As Integer = 10
        ' Create an Event which signals when we are finished
        Dim allDoneEvent As New CountdownEvent(numThreads)
        For i As Integer = 0 To numThreads - 1
            ThreadPool.QueueUserWorkItem(Function()
                                             Try
                                                 Monitor.Enter(o)
                                                 Console.WriteLine("Thread {0} acquired lock...working", Thread.CurrentThread.ManagedThreadId)
                                                 Console.WriteLine("Thread {0} performing some I/O operation so yielding the lock temporarily...", Thread.CurrentThread.ManagedThreadId)
                                                 Monitor.PulseAll(o)
                                                 Monitor.Wait(o)
                                                 Console.WriteLine("Thread {0} reacquired lock", Thread.CurrentThread.ManagedThreadId)
                                             Finally
                                                 Console.WriteLine("Thread {0} released lock", Thread.CurrentThread.ManagedThreadId)
                                                 Monitor.PulseAll(o)
                                                 Monitor.Exit(o)
                                                 ' This thread indicates that it has finished its work
                                                 allDoneEvent.Signal()
                                             End Try
                                             Return Nothing
                                         End Function
          )
        Next
        ' Wait for all events to finish, or after a timeout
        allDoneEvent.Wait(10000)
        ' Stop the stopwatch before the readline
        stopwatch.Stop()
        Console.WriteLine("Time elapsed: {0}", stopwatch.Elapsed)
        Console.ReadLine()
    End Sub 
```

# python - 如何通过索引将数组值发送到另一个带有循环的数组？

> ID：12277796
> 
> 赞同：1
> 
> 时间：2012-09-05T08:57:30.960
> 
> 标签：python, arrays, scrapy

我正在学习 Python，并在 scrapy 中编写了一个小爬虫。目前，我正在使用硬编码的 url 数组列表，如下所示：

```
"http city1 /%(searchterm)s"dict(searchterm=searchterm),
"http city2 /%(searchterm)s"dict(searchterm=searchterm),
"http city3 /%(searchterm)s"dict(searchterm=searchterm), 
```

我认为可以`url_array`通过从城市数组中调用这些城市的索引来减少我的代码，将城市数组解析为这些城市的索引，这些城市在目标数组中使用循环声明来声明。

这在技术上可行吗？我的下一步应该是什么？我应该谷歌什么？

```
cities = ["hamburg", "berlin", "muenchen"]
citiesCount = len(cities)

url_array = [
http:"%(cities[1])s"
while citiesCount in range(1, len(cities):
    http:"%(cities[0+1]s"
    ] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T09:03:55.237

您的示例 URL 没有多大意义，而且问题本身（仍然，我编辑掉了最糟糕的部分）难以阅读和理解。如果可能，请尝试对其进行编辑并使其更清晰。

我不确定，但听起来你想使用[列表推导](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)：

```
url_array = [ "http://%s/stuff" % x for x in cities ] 
```

会产生：

```
url_array = [ "http://hamburg/stuff", "http://berlin/stuff" ... ] 
```

# search - JQuery Dynatree - 按名称搜索节点

> ID：12277797
> 
> 赞同：7
> 
> 时间：2012-09-05T08:57:33.080
> 
> 标签：search, dynatree, jquery-dynatree

我想开始在我的页面上使用 Dynatree，但是我可能需要按名称搜索我的树。你知道怎么做吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-02T09:19:48.017

我不仅需要匹配节点，还需要到这些节点的整个路径。我写了这个功能，它对我有用。

库的修改：

```
var clear = true;

DynaTreeNode.prototype.search = function(pattern){

    if(pattern.length < 1 && !clear){
        clear = true;
        this.visit(function(node){
            node.expand(true);
            node.li.hidden = false;
            node.expand(false);
        });
    } else if (pattern.length >= 1) {
        clear = false;
        this.visit(function(node){
            node.expand(true);
            node.li.hidden = false;
        });

        for (var i = 0; i < this.childList.length; i++){
            var hide = {hide: false};
            this.childList[i]._searchNode(pattern, hide);
        }
    } 
},

DynaTreeNode.prototype._searchNode = function(pattern, hide){

    if (this.childList){
        // parent node

        var hideNode = true;
        for(var i = 0; i < this.childList.length; i++){
            var hideChild = {hide: false};
            this.childList[i]._searchNode(pattern, hideChild);
            hideNode = hideNode && hideChild.hide;
        }
        if(hideNode && !this._isRightWithPattern(pattern)){
            this._hideNode();
            hide.hide = true;
        } else {
            hide.hide = false;
        }

    } else {
        // leaf
        if (!this._isRightWithPattern(pattern)){
            this._hideNode();
            hide.hide = true;
        } else {
            hide.hide = false;
        }
    }
},

DynaTreeNode.prototype._isRightWithPattern = function(pattern){
    if((this.data.title.toLowerCase()).indexOf(pattern.toLowerCase()) >= 0){
        return true;
    }
    return false;
},

DynaTreeNode.prototype._hideNode = function(){
    if(this.li) {
      this.li.hidden = true;
    }
} 
```

利用：

```
$("tree").dynatree("getRoot").search(pattern); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T11:55:52.023

目前没有搜索功能，但你可以使用这样的东西（未测试）

```
var match = null;
tree.visit(function(node){
    if(node.data.title === "foo"){
        match = node;
        return false; // stop traversal (if we are only interested in first match)
    }
});
alert("Found " + match); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-04T05:45:05.457

I've done it this way

```
<style>
span.occurance a.dynatree-title{background-color:#3AFF22;}
</style>

DynaTreeNode.prototype.find = function (needle) {
    needle = (needle || '');
    if (needle.length >= 1) {
        var occurs = [];
        this.visit(function (node) {
            $(node.span).removeClass('occurance'); //remove pervious findings
            if (node.data.title.indexOf(needle) != -1) {
                occurs.push(node);
                node._expandPath();
            }
        });
        for (indx in occurs) { // mark findings
            $(occurs[indx].span).addClass('occurance');
        }
    } else {
        $('span.dynatree-node.occurance').removeClass('occurance');
    }
},
DynaTreeNode.prototype._expandPath = function () {
    var path = [],
        node = this;
    while (node = node.getParent()) {
        path.push(node);
    }
    for (indx in path) {
        path[indx].expand(true)
    }
} 
```

usage:

```
[your selector].dynatree("getRoot").find('needle'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-13T14:12:54.270

感谢@mar10，我做了一个小而简单的函数来搜索带有标题的节点：

```
// If searchFrom is null, root is used
function seachFolderNodeWithName(name, searchFrom) {
    if (name == null) {
        return undefined;
    }

    if (searchFrom == null) {
        searchFrom = jQuery('#tree').dynatree("getRoot");
    }

    var match = undefined;

    searchFrom.visit(function (node) {
        if (node.data.title === name) {
            match = node;
            return false; // Break if found
        }
    });
    return match;
}; 
```

# django - 如何在 Django 模型字段中设置变量关键字？

> ID：12277798
> 
> 赞同：0
> 
> 时间：2012-09-05T08:57:36.157
> 
> 标签：django, django-models

我有这个模型：

```
class Address(models.Model):
    street                  = models.CharField(blank=True, max_length=300, verbose_name='Straat')
    house_number            = models.CharField(blank=True, max_length=10,        verbose_name='Huisnummer')
    zipcode                 = models.CharField(blank=True, max_length=300, verbose_name='Postcode')
    city                    = models.CharField(blank=True, max_length=300, verbose_name='Stad') 
```

但是，对于使用此地址模型的某些模型，我希望空白=真为空白=假。如何在创建模型时指定它？这没有用：

```
class Address(models.Model):
    blank = False
    street                  = models.CharField(blank=blank, max_length=300, verbose_name='Straat')
    house_number            = models.CharField(blank=blank, max_length=10,        verbose_name='Huisnummer')
    zipcode                 = models.CharField(blank=blank, max_length=300, verbose_name='Postcode')
    city                    = models.CharField(blank=blank, max_length=300, verbose_name='Stad')

#Create
Address(blank=True) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:22:50.937

正如[文档](https://docs.djangoproject.com/en/1.4/ref/models/fields/#django.db.models.Field.blank)所解释的，`blank`纯粹是出于验证目的。除非进行模型或表单验证，否则不会强制执行。因此，如果您需要在某些情况下允许地址表单中的空白字段，您可以简单地相应地覆盖您的表单字段（记住在表单字段中，使用`required`代替`blank`）：

```
class AddressForm(forms.ModelForm):
    street = forms.TextField(required=True)

    class Meta:
        model = Address 
```

# java - Java GUI 应用程序 - 地图上的叠加图像（背景图像）

> ID：12277799
> 
> 赞同：2
> 
> 时间：2012-09-05T08:57:46.640
> 
> 标签：java, image, user-interface, map, overlay

我想创建一个显示城市地图的简单 GUI 应用程序。

然后，我想以编程方式将酒店、餐馆等项目（资产）作为图像添加到此地图中。

**伪代码**如下

```
[set up background object with map image covering entire form]

[create hotel1 object (image, label with icon or whatever]
hotel1.image = "hotel.png";
hotel1.size-x = 30;
hotel1.size-y = 30;
hotel1.location-x = 450; (pixels)
hotel1.location-y = 300;
background-object.add(hotel1);

[create restaurant1 object (image, label with icon or whatever]
restaurant1 .image = "hotel.png";
restaurant1 .size-x = 30;
restaurant1 .size-y = 30;
restaurant1 .location-x = 600; (pixels)
restaurant1 .location-y = 400;
background-object.add(restaurant1);

[repeat for hotel2, hotel3, restaurant2 etc...] 
```

这样我就可以向地图添加任意数量的资产。我需要的其他功能是

*   更改资产的图像（例如，为资产显示不同的图像）
    `hotel1.image = "hotel_closed.png";`

*   重叠资产（如果它们靠近）

*   为每个资产注册一个点击事件处理程序
*   更改资产的可见性
    `hotel1.visible = false;`

我是一位经验丰富的.Net 程序员。这项任务在 .Net 中将是一项简单的任务，但是我不清楚在 Java 中完成上述任务的最佳方法。请有人建议实现上述目标的最佳方法。如果提出一个概念，我很高兴谷歌（我不需要完整的编码解决方案！！）

非常感谢，伊恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T09:24:00.687

您可以从很多地方开始，但不了解全部要求（即，如果您需要下载地图、平铺地图等），我只能给您一些概述建议

我会先通读一遍（没有特别的顺序）

*   [使用 JFC/Swing 创建 GUI](http://docs.oracle.com/javase/tutorial/uiswing/index.html)
*   [Swing 中的并发性](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)
*   [Swing 中的自定义绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/)
*   [2D 图形](http://docs.oracle.com/javase/tutorial/2d/index.html)
*   [基本 I/O](http://docs.oracle.com/javase/tutorial/essential/io/index.html)

我也会让自己熟悉[Java 教程](http://docs.oracle.com/javase/tutorial/)

虽然以上大部分内容都是特定于 GUI 的，但我会阅读类似的内容

*   [基本课程](http://docs.oracle.com/javase/tutorial/essential/index.html)
*   [学习 Java 语言](http://docs.oracle.com/javase/tutorial/java/index.html)

仅仅因为在 Java 中编码的位置无关紧要，这些总是有用的。

快乐的阅读:)

**更新**

哦，当然还有所有重要的[API 文档](http://docs.oracle.com/javase/7/docs/api/)（AKA JavaDocs）

**更新**

当您对所有这些都感到满意时，您可能想查看[SwingX WS](http://java.net/projects/swingx-ws)，它有一个很好的例子，可以提取 Google 和 OpenStreet Maps

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T09:11:35.600

我假设您希望您的应用程序是桌面而不是基于 Web 的。在这种情况下，我在使用第三方映射解决方案之前做了类似的事情（虽然相当复杂）。不幸的是，该解决方案需要许可证，并且无论如何都不再可用。

如果您只想在桌面应用程序中使用简单的不可滚动地图，我建议您从 Swing 解决方案开始。查看扩展 JComponent 对象并覆盖该方法

```
public void paintComponent(Graphics g){
    // use g to draw things
} 
```

使用图形对象绘制地图图像和图标。将此组件添加到您的 Swing JFrame 并设置正确的尺寸和布局。

如果你想在网页中使用它，那么其他人会更好地帮助你。

编辑：

根据此处和另一篇文章中给出的反馈，我认为您可能会从一段代码中受益，所以这里是：

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.image.BufferedImage;

import javax.swing.JFrame;
import javax.swing.JPanel;

public class SwingPaintDemo extends JPanel {

    private BufferedImage map = null;
    private BufferedImage pointer = null;

    public SwingPaintDemo() {
        this.setPreferredSize(new Dimension(200, 200));
        loadImagesFromFile(); 
    }

    private void loadImagesFromFile() {
        // load your images form file - these are fakes: 
        map = new BufferedImage(200, 200, BufferedImage.TYPE_3BYTE_BGR);
        pointer = new BufferedImage(10, 10, BufferedImage.TYPE_4BYTE_ABGR);

        Graphics g = map.getGraphics();
        g.setColor(Color.GREEN);
        g.fillRect(0, 0, 200, 200);

        g = pointer.getGraphics();
        g.setColor(Color.BLUE);
        g.fillOval(0, 0, 10, 10);
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        // paint map
        g.drawImage(map, 0, 0, this);

        // paint pointers
        g.drawImage(pointer, 50, 75, this);
    }

    // this main is for testing the class but can be used as a reference
    public static void main(String... args) {
        JFrame jf = new JFrame();
        SwingPaintDemo mapper = new SwingPaintDemo();
        jf.getContentPane().setLayout(new BorderLayout());
        jf.getContentPane().add(mapper, BorderLayout.CENTER);
        jf.setVisible(true);
        jf.pack();
    }
} 
```

您需要对其进行编辑以从文件中加载图像 - 我想让它自包含且易于运行，因此我刚刚创建了内联图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T19:22:20.697

尚未接受答案。因此，以您的伪代码为例，我使用 JavaFX 2 编写了一个快速覆盖示例。使用您提到的 JPG 文件，可以轻松地将 WebView 替换为 ImageView。

这是代码：

```
package simple.map.overlay;

import java.io.InputStream;
import javafx.application.Application;
import javafx.scene.Group;
import javafx.scene.Scene;
import javafx.scene.control.Label;
import javafx.scene.image.Image;
import javafx.scene.image.ImageView;
import javafx.scene.layout.VBox;
import javafx.scene.web.WebEngine;
import javafx.scene.web.WebView;
import javafx.stage.Stage;

public class SimpleMapOverlay extends Application 
{

    @Override
    public void start(Stage primaryStage) 
    {               
        WebView mapView = new WebView();
        WebEngine webEngine = mapView.getEngine();
        String url = "http://maps.google.com/maps?q=Baramerica,+South+Alamo+Street,+San+Antonio,+TX&hl=en&ll=29.416647,-98.488655&spn=0.025196,0.035233&sll=29.416423,-98.489814&sspn=0.006299,0.008808&hq=Baramerica,&hnear=S+Alamo+St,+San+Antonio,+Texas&t=m&z=15";
        url += "&output=embed";
        webEngine.load(url);

        VBox vBox = new VBox(5);
        vBox.getChildren().add(mapView);

        InputStream instream = SimpleMapOverlay.class.getResourceAsStream("beer.png");
        Image beerImage = new Image(instream);        

        instream = SimpleMapOverlay.class.getResourceAsStream("food.jpg");
        Image foodImage = new Image(instream);

        Marker laTunaMarker = new Marker(beerImage, "La Tuna");
        laTunaMarker.setLayoutX(210);
        laTunaMarker.setLayoutY(480);

        Marker rosariosMarker = new Marker(foodImage, "Rosarios");
        rosariosMarker.setLayoutX(360);
        rosariosMarker.setLayoutY(300);

        Group root = new Group();
        root.getChildren().add(vBox);
        root.getChildren().add(laTunaMarker);
        root.getChildren().add(rosariosMarker);
        Scene scene = new Scene(root);        

        primaryStage.setTitle("Hello Map World with Markers!");
        primaryStage.setScene(scene);
        primaryStage.show();
    }

    public static void main(String[] args) 
    {
        launch(args);
    }

    class Marker extends Group
    {
        public Marker(Image image, String text)
        {
            ImageView imageView = new ImageView(image);            
            Label label = new Label(text);            
            VBox vbox = new VBox(5);
            vbox.getChildren().add(imageView);
            vbox.getChildren().add(label);
            getChildren().add(vbox);
        }
    }

} 
```

# javascript - 在html中使用table标签时如何显示滑块

> ID：12277801
> 
> 赞同：0
> 
> 时间：2012-09-05T08:57:46.663
> 
> 标签：javascript, slider

我很想使用这个滑块：[http ://www.menucool.com/javascript-image-slider](http://www.menucool.com/javascript-image-slider)

但是当我尝试使用这样的代码时，我无法获得输出..

```
<table>
<tr>
<td>

<div id="sliderFrame">       
        <div id="slider">
            <a href="http://www.google.com" target="_blank">
                <img src="JSImageSlider/images/image-slider-1.jpg" alt="Welcome to Google"  />
            </a>
            <img src="JSImageSlider/images/image-slider-2.jpg" alt="" width="1200px"/>
            <img src="JSImageSlider/images/image-slider-3.jpg" alt="Pure Javascript. No jQuery. No flash." />
            <img src="JSImageSlider/images/image-slider-4.jpg" alt="#htmlcaption" />
            <img src="JSImageSlider/images/image-slider-5.jpg"/>
        </div>

    </div>
</td>

<td>
<div id="sliderFrame">       
        <div id="slider">
            <a href="http://www.google.com" target="_blank">
                <img src="JSImageSlider/images/image-slider-1.jpg" alt="Welcome to Google"  />
            </a>
            <img src="JSImageSlider/images/image-slider-2.jpg" alt="" width="1200px"/>
            <img src="JSImageSlider/images/image-slider-3.jpg" alt="Pure Javascript. No jQuery. No flash." />
            <img src="JSImageSlider/images/image-slider-4.jpg" alt="#htmlcaption" />
            <img src="JSImageSlider/images/image-slider-5.jpg"/>
        </div>

    </div>
</td>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:32:01.967

第一：将滑块 ID 翻倍。ID = 元素的标识！将 sliderFrame 标记为类。像这样：

```
<table>
<tr>
<td>

<div class="sliderFrame">       
        <div id="slider">
            <a href="http://www.google.com" target="_blank">
                <img src="images/image-slider-1.jpg" alt="Welcome to Google"  />
            </a>
            <img src="images/image-slider-2.jpg" alt="" width="1200px"/>
            <img src="images/image-slider-3.jpg" alt="Pure Javascript. No jQuery. No flash." />
            <img src="images/image-slider-4.jpg" alt="#htmlcaption" />
            <img src="images/image-slider-5.jpg"/>
        </div>

    </div>
</td>

<td>
<div class="sliderFrame">       
        <div id="slider2">
            <a href="http://www.google.com" target="_blank">
                <img src="images/image-slider-1.jpg" alt="Welcome to Google"  />
            </a>
            <img src="images/image-slider-2.jpg" alt="" width="1200px"/>
            <img src="images/image-slider-3.jpg" alt="Pure Javascript. No jQuery. No flash." />
            <img src="images/image-slider-4.jpg" alt="#htmlcaption" />
            <img src="images/image-slider-5.jpg"/>
        </div>

    </div>
</td>
</tr>
</table> 
```

第二：更改您的css文件：

```
.sliderFrame {position:relative;width:700px;margin: 0 auto;} 

#slider, #slider2 {
    width:700px;height:306px;
    background:#fff url(loading.gif) no-repeat 50% 50%;
    position:relative;
    margin:0 auto;
    box-shadow: 0px 1px 5px #999999;
}
#slider img, #slider2 img {
    position:absolute;
    border:none;
    display:none;
} 
```

最后一个：您的 js 代码必须实现滑块的另一个实例：

```
var sliderOptions=
{
    sliderId: "slider",
    effect: "series1",
    effectRandom: false,
    pauseTime: 2600,
    transitionTime: 500,
    slices: 12,
    boxes: 8,
    hoverPause: true,
    autoAdvance: true,
    captionOpacity: 0.3,
    captionEffect: "fade",
    thumbnailsWrapperId: "thumbs",
    license: "free"
};

var sliderOptions2 =
{
    sliderId: "slider2",
    effect: "series1",
    effectRandom: false,
    pauseTime: 2600,
    transitionTime: 500,
    slices: 12,
    boxes: 8,
    hoverPause: true,
    autoAdvance: true,
    captionOpacity: 0.3,
    captionEffect: "fade",
    thumbnailsWrapperId: "thumbs2",
    license: "free"
};

var imageSlider=new mcImgSlider(sliderOptions);
var imageSlider2=new mcImgSlider(sliderOptions2); 
```

就这样。表标签是无辜的=）

# android - QualComm Vuforia 增强现实

> ID：12277804
> 
> 赞同：3
> 
> 时间：2012-09-05T08:58:05.703
> 
> 标签：android, augmented-reality

我是增强现实的新手，我已经下载了适用于 AR 的 Android 版 Vuforia Skd，但它无法正常工作，因为有多个 C/c++ 文件。如何在 Eclipse 上运行项目我是否需要 NDK

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T00:44:55.747

我认为此页面上的指导方针非常明确。

[https://ar.qualcomm.at/sdk](https://ar.qualcomm.at/sdk)

在运行程序之前，您必须单独编译 c++ 代码，然后在 Eclipse 中清理并运行它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T09:03:38.243

我发现自己做以下事情添加路径适当地下载cygwin以进行c / c ++编译并将其路径添加到环境变量中，并在下载cygwin时从它下载make，然后使用CMD编译代码并在项目路径为 c/c++ 文件编译编写 ndk-build，然后通过 eclipse 运行代码，它将用于进一步的细节使用这个 [https://developer.qualcomm.com/mobile-development/mobile-technologies/augmented-reality](https://developer.qualcomm.com/mobile-development/mobile-technologies/augmented-reality)

# hadoop - Hadoop JobClient.getQueues() 不显示公平调度程序池

> ID：12277812
> 
> 赞同：0
> 
> 时间：2012-09-05T08:58:34.400
> 
> 标签：hadoop, mapreduce

调用 JobClient 类的 getQueues() 方法似乎只返回“默认”队列，即使公平调度程序已创建其他池并且正在运行作业。我想知道“池”和“队列”之间是否存在概念上的不匹配，但是为非默认池调用 getJobsFromQueue() 方法似乎工作得非常愉快。

是否有使用 JobClient 类从 Fair Scheduler 获取队列（或池？）名称的编程方式？或者是其他东西？

我应该补充一点，我在 Cloudera cdh4.0.1 上使用 Hadoop 2.0.0 MR1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T00:10:32.527

事实证明，您需要使用 mapred 站点配置文件中的 mapred.queue.names 属性将 Fair Scheduler 池明确命名为队列。

# php - 通过递归函数创建树

> ID：12277829
> 
> 赞同：5
> 
> 时间：2012-09-05T08:59:42.593
> 
> 标签：php, mysql, recursion

我有一张桌子

`id,name,parent_id,designation`列，

我想通过 php 中的递归函数创建树。

每个`parent_id`人都在查看`id`列，如果用户登录，那么用户可以看到自己的和下面的所有记录`parent_id`。

喜欢

一个 | 乙| c | D | E | F

如果 A 用户登录，那么他可以所有（A，B，C，D，E，F）详细信息。如果 B 登录，则查看（B，c，D，E，F）并且喜欢所有...如果 F 登录然后他只能看到自己的记录..谢谢提前

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:20:18.057

创建一个函数 fetch_parent；

```
function fetch_parent($parent_id) {
    $query = 'SELECT * FROM `my_table` WHERE `parent_id`='. $parent_id;
    // use your own sql class/function whatever to retrieve the record and store it in variable $parent
    if($parent->parent_id !== null) { // asuming a 'root' record will have null as it's parent id
        fetch_parent($parent->parent_id); // here you go with your recursion
    }
    return;
} 
```

然后只需使用您想要它的父母的记录调用该函数：

```
$first_parent_id = 8;
fetch_parent($first_parent_id); 
```

笔记：

*   $parent var 也可以是一个数组，具体取决于 mysql 结果集
*   请在查询中检查 $parent_id 是否有 mysql 注入等。

# javascript - 使用jquery垂直对齐动态加载图像

> ID：12277831
> 
> 赞同：0
> 
> 时间：2012-09-05T08:59:47.497
> 
> 标签：javascript, jquery, html, css

我想动态对齐 div 中加载的图像。我想到了一个解决方案来获取父 div 的高度并获取当前加载图像的高度，然后从父 div 中减去它并除以 2 .. 像这样的东西..

```
$(".gallery a").click(function (evt) {
      evt.preventDefault();
      $(".image").empty().append( 
      $("<img>", {src: this.href})
      );
    }); 
```

在这里我想添加这样的东西，但我不知道确切的代码

```
$("<img>", {src: this.href, style: (margin-top:350-src.height()/2}) 
```

其中 350 是说我的父 div 高度 .. 请给我一个代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:05:47.550

我在下面发布的代码中的“mydesirednumber”变量包含“获取父 div 的高度并获取当前加载图像的高度并将其从父 div 中减去并除以 2”的答案

下面的例子假设你有这样的 DOM 结构：

```
GALLERY
  - DIV CLASS="thatdiv"
     -IMAGE
     -IMAGE
     -IMAGE
  - A (anchor)
  - A (another anchor)... 
```

代码如下：

```
$(".gallery a").click(function (evt) {
      evt.preventDefault();
      //whatever else you wanted to do before, here
      var parentdivheight = $('.thatdiv').height();
      var imageheight = $(<<WHEREVER-CURRENTLYLOADING-IMAGE-IS>>).height();
      var mydesirednumber = (parentdivheight - imageheight)  /2 ;
       //whatever else you wanted to do after, here

    }); 
```

# php - 计算从任何日期开始的 +N 个每月周期（考虑闰年）

> ID：12277836
> 
> 赞同：2
> 
> 时间：2012-09-05T08:59:55.260
> 
> 标签：php, date, datetime

我有一个随机的开始日期（例如 2012-09-19）。我想在此日期之后轻松获得结束的每月周期的日期。但是，每月的周期并不完全是 30 天，而是从日期到日期，例如 9 月 19 日到 10 月 19 日。

我想轻松计算订阅开始后的第 5 个月或第 500 个月的开始和结束日期，同时考虑闰年。例如，如果订阅于闰年的 2 月 29 日开始，而非闰年的 2 月到来，则该期间的结束日期应为 2 月 28 日，而不会将未来的每月周期替换一天。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:17:44.137

这似乎很容易，使用[strtotime()](http://php.net/manual/en/function.strtotime.php)；

假设初始日期是 2012-02-29。

```
function addToDate($date, $add){
        if(!strtotime($date)) return FALSE;
        $date = strtotime($date);
        return strtotime($add, $date);
}

$result = addToDate('2012-02-29', '+50 months');
echo date('Y-m-d', $result); 
```

将导致 2016-04-29。

# php - php shell_exec 不适用于 imagemagick 命令

> ID：12277837
> 
> 赞同：3
> 
> 时间：2012-09-05T08:59:58.323
> 
> 标签：php, shell, imagemagick, exec

我尝试将 rgb 颜色转换为透明

当我在命令行中使用此代码时，它可以完美运行。

```
convert -transparent 'RGB(249,249,255)' /home/me/web/my.png /home/me/web/mynew.png 
```

但是当我将它与 php 一起使用时：

```
<?php

error_reporting(E_ALL);
ini_set('display_errors', '1');

$output = shell_exec("convert -transparent 'RGB(249,249,255)' /home/me/web/my.png /home/me/web/mynew.png");

?> 
```

我得到错误：

转换：无法打开图像`/home/me/web/mynew.png'：@error/blob.c/OpenBlob/2498。

有人有想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T09:17:48.473

您必须使用 homedir 的相对路径（因为 shell_exec），否则您必须使用绝对路径。

但是你为什么不使用[imagemagick 的 php](http://php.net/manual/en/book.imagick.php)呢？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T14:52:50.223

对我来说，这看起来像是一个访问权限问题。您的 Web 服务器尝试在您的主目录中写入一个文件。

通常，您的主目录受到保护，除了您自己之外，**没有人**可以在其中写入文件。因此，您的 Web 服务器无法在使用终端时创建新文件。

检查对包含新图像的文件夹的访问权限，并允许运行 Web 服务器的用户写入该文件夹。

# html - 如何在 IE 9 的 iframe 中为 doctype 指定 QuirksMode？

> ID：12277841
> 
> 赞同：8
> 
> 时间：2012-09-05T09:00:17.640
> 
> 标签：html, iframe, reporting-services, doctype, quirks-mode

问题：

我们有一个门户，其中 doctype 与 xhtml 1.0 兼容。然后，在门户中，我们有一个内容 iframe，我们在其中嵌入了不同的 Web 应用程序。其中一些应用程序是由我们编写的，一些是第 3 方。

现在，在该 iframe 中，我们嵌入了 Microsoft Reporting Service 报告等内容。问题是，Reporting Service Reports 需要 QuirksMode 才能“正确”呈现。并且门户在 QuirksMode 中不起作用（就我而言，这很好，因为我们只针对 9，可能还有 IE8）。门户在 IE7 中也无法正常渲染，我们将尽快放弃对 IE8 的支持。

但是，IE9 似乎从父页面继承了文档模式，因此报告服务报告以 IE9 标准模式而不是 quirks 模式呈现。所以所有的报告都显示不正确（我不是说一点点，它真的很严重，完全不正确，绝对可怕）

问题是，我们无法更改报告服务......
没有办法让报告服务（任何版本）呈现非怪异模式的 HTML。

~~根据[将 iframe 呈现在怪癖模式下吗？](https://stackoverflow.com/questions/3717932/will-an-iframe-render-in-quirks-mode) 我可以补充~~

```
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
<meta http-equiv="X-UA-Compatible" content="IE=8" /> 
```

~~让 iframe 在 QuirksMode 中呈现。~~（编辑：当我不关心门户如何呈现并将其放入时甚至不起作用）

不幸的是，门户如前所述，不兼容 IE7，所以这不是一个选项。
此外，SSRS 报告在门户之外的另一个域上运行，所以我不能以任何方式使用 JavaScript/jQuery。

有什么方法可以在 QuirksMode 中进行 iframe 渲染，而不会破坏父页面布局？
还是一种（已经存在的）使报告服务呈现有效 HTML 的方法（我当然没有时间编写自定义 HTML 呈现扩展）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T17:31:05.180

通过[MSDN](http://msdn.microsoft.com/en-us/library/gg558056%28v=VS.85%29.aspx)：

> 尽管仅当 Windows® Internet Explorer® 检测到 HTML 页面已请求对标准的最高级别支持时才使用较新的呈现引擎，但对于可能在框架和 iframe 元素中加载的子页面并不总是如此。由于**一次只能激活一个渲染引擎**，IE9 模式还包括对 Quirks 模式的仿真。

对不起，但你想做的事情在 IE9 中是不可能实现的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-14T14:59:15.677

根据 2016 年的死灵法。

如果您有同样的问题（使用 SSRS）：
SQL-Server **2016** CTP 3.3 Reporting-Service（**预览门户**）提供符合标准的 HTML。

# image-processing - 创建一堆图像时如何禁用亮度/对比度的自动调整

> ID：12277842
> 
> 赞同：0
> 
> 时间：2012-09-05T09:00:20.017
> 
> 标签：image-processing, imagej

我有大量形成时间序列的图像，但它们的亮度和对比度差异很大。在每个图像的基础上调整亮度/对比度非常容易，但是，当我用其中的一些创建 ImageStack 时，整个亮度/对比度会根据顶部图像自动调整。

那么，有没有办法禁用这种自动调整？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T11:08:08.150

阈值化和应用 LUT 之间存在区别，尽管两者都可以产生相同的效果。[ImageProcessor](http://rsbweb.nih.gov/ij/developer/api/ij/process/ImageProcessor.html)类包含设置[LUT](http://rsbweb.nih.gov/ij/developer/api/ij/process/ImageProcessor.html#setLut%28ij.process.LUT%29)和[阈值](http://rsbweb.nih.gov/ij/developer/api/ij/process/ImageProcessor.html#setThreshold%28double,%20double,%20int%29)的方法。您也应该能够关闭此类的自动阈值。

由于单独的 ImageProcessor 与堆栈中的每个切片相关联，因此您可以对每个切片应用任何 LUT 或阈值（前提是它们不是颜色）。

# visual-studio-2010 - 在 Visual Studio 2010 中添加 Nintex WorkFlow 2010 操作？

> ID：12277843
> 
> 赞同：1
> 
> 时间：2012-09-05T09:00:24.597
> 
> 标签：visual-studio-2010, sharepoint, nintex-workflow

如何在 Visual Studio 2010 中添加 Nintex WorkFlow 2010 操作以创建自定义工作流？它在线搜索。但除了 Nintex WorkFlow 2010 操作，其他人正在获取。还是想在 VS 2010 中手动创建？

任何人都知道这个问题，请帮助我。

# java - ModeShape rest api：无法取消发布节点

> ID：12277845
> 
> 赞同：0
> 
> 时间：2012-09-05T09:00:32.503
> 
> 标签：java, api, rest, modeshape

我正在使用 ModeShape 2.8.2 和 JBoss 7.1.1。ModeShape 休息服务器部署为通常的 Web 应用程序。我有一个愚蠢的问题。

我可以发布一个文件-它上传到存储中，一切都很好。

但是当我尝试取消发布时 - 我有一个例外。

根据我必须提供的 api`workspace`和`path`作为`file`参数。但是有没有如何组合`path`和`file`参数的例子？

例如，我想取消发布`/repo/file`路径上的节点。以下代码不起作用：

```
File file = new File("file");
Status status = restClient.unpublish(workspace, "/repo", file);
```

日志：

```
12:53:26,163 错误 [org.modeshape.web.jcr.rest.client.json.JsonRestClient] (http
--127.0.0.1-8080-1) 响应代码=405 方法=取消发布
12:53:26,166 错误 [com.demo.app.Controller]
(http--127.0.0.1-8080-1) 文件“C:\jboss-as-7.1.1.Final\bin\file”无法在工作区“workspa”中取消发布
ce1" 在路径 "/repo".: java.lang.RuntimeException: 文件 "file" 可以 n
不能在路径“/repo”的工作区“workspace1”中取消发布。
```

但是来自的 url`(new FileNode(workspace,"/repo",file).getUrl()`是正确的，并且对 url 的获取请求会返回有关节点的详细信息。

感谢您的任何帮助。祝你有美好的一天！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T17:44:50.027

这是一个[错误](https://issues.jboss.org/browse/MODE-1619)，已在 3.0 Modeshape 版本中得到解决。

# php - 重定向和帧

> ID：12277849
> 
> 赞同：1
> 
> 时间：2012-09-05T09:01:04.023
> 
> 标签：php, redirect, phpmyadmin, frame

在过去的几个小时里，我一直在研究这个话题，但收效甚微。我希望使用 php 从框架的内容重定向到框架的父级。.. 我认为可能的唯一原因是因为我在浏览器上禁用了 javascript，并且 phpMyAdmin 在会话超时时仍然能够重定向我。

我也意识到这很可能是不可能的，因为框架是客户端的东西，而 php 不是。

考虑到这一点，我想知道 phpMyAdmin 是如何做到的。我不希望我的 Web 应用程序需要 js。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:05:39.143

如果 iframe 具有如下所示的链接：

```
<a href="somepage.php" target="_parent">Some page</a> 
```

它应该可以工作，只要两个页面或在同一个域上。

或者，看看这个答案：[如何强制 iframe 中的链接在父窗口中打开](https://stackoverflow.com/questions/1037839/how-to-force-link-from-iframe-to-be-opened-in-the-parent-window)

# c# - Nhiibernate 多对一删除父实体

> ID：12277850
> 
> 赞同：0
> 
> 时间：2012-09-05T09:01:03.917
> 
> 标签：c#, nhibernate, mapping, many-to-one

**我有 2 节课**

```
 public class Message : IMessage
    {
      public virtual int Ik { get; private set; }
      public virtual string Description { get; set; }
    }

    public class Action
    {
      public virtual int Ik { get; set; }
      public virtual IMessage Message { get; set; }   
} 
```

**hbm映射**

```
<class entity-name="Action" name="ActionBase" table="Action" abstract="true">
        <id name="Ik" column="Ik">
            <generator class="native"/>
        </id>

        <many-to-one name="Message" column="MessageFk" class="BusinessComponents.Message.Message, BusinessComponents.Message"/>
</class> 
```

**一个问题是如何保护自己不删除消息？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T12:02:18.150

您没有在多对一中指定级联，因此它将默认为无，这意味着操作的删除操作不会删除消息。其余的将由外键处理，如果有剩余的操作引用它，它会阻止删除消息。

# android - 如何以编程方式使用Android上的Transitions在图像视图中淡入和淡出？

> ID：12277851
> 
> 赞同：1
> 
> 时间：2012-09-05T09:01:06.117
> 
> 标签：android, image, fadein, transition, fadeout

> **可能重复：**
> [如何使用Transition，android对图像使用淡入淡出效果](https://stackoverflow.com/questions/12275993/how-to-use-fade-in-and-fade-out-effect-with-an-image-using-transition-android)

[http://www.dynamicdrive.com/dynamicindex14/fadeinslideshow.htm](http://www.dynamicdrive.com/dynamicindex14/fadeinslideshow.htm)

我看过这个链接。它通过使用淡入和淡出效果显示图像。我怎么能以编程方式做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T09:16:35.323

1.  创建两个`Animation`

    ```
    Animation fadeOutAnimation = new AlphaAnimation(1.0f, 0.0f);  
    Animation fadeInAnimation = new AlphaAnimation(0.0f, 1.0f); 
    ```

2.  设定持续时间

    ```
    fadeOutAnimation.setDuration(1000);
    fadeInAnimation.setDuration(1000); 
    ```

3.  set listener - 当淡出动画完成时替换图像

    ```
    fadeOutAnimation.setAnimationListener(new AnimationListener() {

            @Override
            public void onAnimationStart(Animation animation) {
                // TODO Auto-generated method stub                  
            }

            @Override
            public void onAnimationRepeat(Animation animation) {
                // TODO Auto-generated method stub
                                }

            @Override
            public void onAnimationEnd(Animation animation) {
                //here switch the images !
                //and the begin the second animation FadeIn 
            }
        }); 
    ```

4.  ImageView.startAnimation(fadeOutAnimation);

# javascript - 将字符串Javascript中的某些字符索引大写

> ID：12277853
> 
> 赞同：3
> 
> 时间：2012-09-05T09:01:09.693
> 
> 标签：javascript, string, split

好的，我想在下面有一个 jscript

```
$(document).ready(function(){
    var str = 'post'; //the subject string
    var arr =[0,2]; //to uppercase character index 0 and 2

    str = str.split("");
    for(var i = 0; i < str.length; i++){
        if($.inArray(i,arr)){
            str[i] = str[i].toUpperCase();
        }
    }
    str = str.join('');
    alert(str);
    //the result must be PoSt
}); 
```

你可能会看到它在这里运行

[http://jsfiddle.net/laupkram/WfUUp/](http://jsfiddle.net/laupkram/WfUUp/) ​</p>

现在我想要的是提供一个主题字符串和一个数组。

主题字符串是要处理的字符串，数组包含将字符串中的字符索引表示为大写的数值。

我是否错过了我的脚本中的某些内容，这就是我得到不理想结果的原因？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T09:05:31.310

```
$(document).ready(function() {
    var str = 'post'; //the subject string
    var arr = [0, 2]; //to uppercase character index 0 and 2
    str = str.split("");
    for (var i = 0; i < arr.length; i++) {
        if (str[arr[i]]) {
            str[arr[i]] = str[arr[i]].toUpperCase();
        }
    }
    str = str.join('');
    alert(str);
    //the result must be PoSt
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T09:08:19.403

检查[$.inArray](http://api.jquery.com/jQuery.inArray/)的文档。它返回找到或未找到的元素的索引`-1`。

```
$(document).ready(function(){
    var str = 'post'; //the subject string
    var arr =[0,2]; //to uppercase character index 0 and 2

    str = str.split("");
    for(var i = 0; i < str.length; i++){
        //CHANGE HERE
        if($.inArray(i,arr) != -1){
                          //^^ change this
            str[i] = str[i].toUpperCase();
        }
    }
    str = str.join('');
    alert(str);
    //the result must be PoSt
}); 
```

​</p>

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T09:09:50.920

2 我在这里看到错误的事情：

1.  不需要`split`str，你可以正常循环。

2.  你`inArray()` 弄错了。以下来自[jquery api 的 inArray片段](http://api.jquery.com/jQuery.inArray/)

> $.inArray() 方法类似于 JavaScript 的本机 .indexOf() 方法，因为它在 > 找不到匹配项时返回 -1。如果数组中的第一个元素与值匹配，则 $.inArray() 返回 0。

因此，正如`inArray`为未找到的索引返回 -1 一样，您`if`的声明正在变为正确，因此您得到的结果为“PoST”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T09:12:42.570

我会将其重写为

```
var str = 'post'; //the subject string
var arr =[0,2]; //to uppercase character index 0 and 2

str = str.split("");
for(i = 0; i < arr.length; i++){
  str[arr[i]]=str[arr[i]].toUpperCase();

}
str = str.join('');
alert(str); 
```

[http://jsfiddle.net/NBBgz/](http://jsfiddle.net/NBBgz/)

# java - 运行 appletviewer 和 html 时出现 Class Not Found 异常

> ID：12277855
> 
> 赞同：1
> 
> 时间：2012-09-05T09:01:20.443
> 
> 标签：java, html, applet, classnotfound, appletviewer

我在从 appletviewer 或从我创建的 html 文件运行程序时遇到困难。我可以很好地运行我编译的 .class 文件，并且 eclipse 会生成我的图像，但我无法在 eclipse 之外重新创建它。我所有的文件也都在同一个目录中。

广告Applet.html：

```
<html>
<head>
<title>AdvertisementApplet</title>
</head>
<body>
<center>
<applet code=”AdvertisementApplet.class” width="400" height="300"></applet>
</center>
</body>
</html> 
```

广告Applet.java：

```
import javax.swing.JApplet;
import java.awt.*;
public class AdvertisementApplet extends JApplet{
public void paint (Graphics page){
page.setColor(Color.cyan);
page.drawRect (50, 50, 40, 40);
page.drawRect (80, 60, 40, 40);
page.drawOval (50, 50, 40, 40);
page.drawLine (50, 50, 40, 40);
page.drawString("out of clutter, find simplicity.", 110, 70);
page.drawString("—Albert Einstein", 130, 100);
    }
} 
```

错误信息：

```
load: class ”AdvertisementApplet.class” not found.
java.lang.ClassNotFoundException: ”AdvertisementApplet.class”
at sun.plugin2.applet.Applet2ClassLoader.findClass(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader.loadCode(Unknown Source)
at sun.plugin2.applet.Plugin2Manager.createApplet(Unknown Source)
at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)
at java.lang.Thread.run(Unknown Source)
Exception: java.lang.ClassNotFoundException: ”AdvertisementApplet.class” 
```

# android - Eclipse中的应用程序崩溃

> ID：12277856
> 
> 赞同：1
> 
> 时间：2012-09-05T09:01:20.910
> 
> 标签：android, eclipse, avd

我是 android 应用程序开发的新手，我已经安装了：

*   Android SDK 工具 Rev 20.0.3
*   Android SDK 工具 Rev 20.0.3
*   Android SDK 平台工具 Rev 3
*   Android 2.3.3(API 10) sdk 平台第 2 版
*   sdk api 10 rev 1 的示例
*   ADT 插件 20.0.3

当我在 Eclipse 中创建一个新项目时，它会自动生成一个`HelloWorld`应用程序。但是，当我尝试运行它时，出现以下错误。

弹出窗口显示“您的项目包含错误，请在运行您的应用程序之前修复它们等”

我已经在 Eclipse 中创建了 AVD 并设置了目标，但是这个问题仍然存在。

这是 Main.java 文件代码

```
package com.rajarshi.learnactivity;

 import android.os.Bundle;
 import android.app.Activity;
 import android.view.Menu;

   public class Main extends Activity 
   {

   @Override
   public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu)
     {
          getMenuInflater().inflate(R.menu.main, menu);
          return true;
     }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T10:59:52.923

你可以创造很多这样的，

对于您的项目错误，您可以使用 Project -> Clean Option 并尝试清理您的项目，确保 All Xml 文件正常，并且 Drawable Resources 名称正确，然后再次运行。

```
@Override
        public boolean onCreateOptionsMenu(Menu menu) {
            menu.clear();
            menu.add(1, 1, 0, "Share Info").setIcon(R.drawable.share);
            menu.add(1, 2, 1, "Chat").setIcon(R.drawable.chat);
            menu.add(1, 3, 2, "Copy Item").setIcon(R.drawable.folder);
            menu.add(1, 4, 3, "Move Item").setIcon(R.drawable.folder);
            menu.add(1, 5, 4, "Delete Item").setIcon(R.drawable.delete);
            menu.add(1, 6, 5, "Select Item").setIcon(R.drawable.folder);        
            // return super.onCreateOptionsMenu(menu);
            return true;
        } 
```

# c# - 将参数传递给 WCF 服务构造函数

> ID：12277858
> 
> 赞同：1
> 
> 时间：2012-09-05T09:01:38.587
> 
> 标签：c#, wcf, c#-4.0, self-hosting

我需要将现有的 DI 容器作为参数传递给 WCF 服务构造函数为了做到这一点，我正在使用 IInstanceProvider WCF 服务应该托管在自己的主机中**。**

```
public class CustomInstanceProvider : IInstanceProvider, IContractBehavior
{
    private readonly IUnityContainer UnityContainer;

    public CustomInstanceProvider(IUnityContainer unityContainer)
    {
        if (unityContainer == null)
        {
            throw new ArgumentNullException("unityContainer");
        }

        UnityContainer = unityContainer;
    }

    #region Implementation of IInstanceProvider

    public object GetInstance(InstanceContext instanceContext)
    {
        return new Service(UnityContainer);
    }

    public object GetInstance(InstanceContext instanceContext, Message message)
    {
        return this.GetInstance(instanceContext);
    }
    public void ReleaseInstance(InstanceContext instanceContext, object instance)
    {

    }

    #endregion

    #region Implementation of IContractBehavior

    public void Validate(ContractDescription contractDescription, ServiceEndpoint endpoint)
    {

    }

    public void ApplyDispatchBehavior(ContractDescription contractDescription, ServiceEndpoint endpoint, DispatchRuntime dispatchRuntime)
    {
        dispatchRuntime.InstanceProvider = this;

    }

    public void ApplyClientBehavior(ContractDescription contractDescription, ServiceEndpoint endpoint, ClientRuntime clientRuntime)
    {

    }

    public void AddBindingParameters(ContractDescription contractDescription, ServiceEndpoint endpoint, BindingParameterCollection bindingParameters)
    {

    }

    #endregion
} 
```

我还实现了 CustomServiceHost

```
 public class CustomServiceHost : ServiceHost
    {
        public CustomServiceHost(IUnityContainer unityContainer, Type serviceType, params Uri[] baseAddresses)
        : base(serviceType, baseAddresses)
    {
        if (unityContainer == null)
        {
            throw new ArgumentNullException("unityContainer is null");
        }

        foreach (var cd in this.ImplementedContracts.Values)
        {
            cd.Behaviors.Add(new CustomInstanceProvider(unityContainer));
        }

    }
} 
```

和 ServiceHostFactory

```
public class CustomServiceHostFactory : ServiceHostFactory
{
    private readonly IUnityContainer UnityContainer;
    public CustomServiceHostFactory(IUnityContainer unityContainer)
    {
        UnityContainer = unityContainer;
    }

    protected override ServiceHost CreateServiceHost(Type serviceType,
        Uri[] baseAddresses)
    {
        return new CustomServiceHost(UnityContainer, serviceType, baseAddresses);
    } 
```

}

我创建 WCF 服务：

```
 var uris = new Uri[1];
        uris[0] = new Uri("http://localhost:8793/Service/");
        CustomServiceHostFactory factory = new CustomServiceHostFactory(Container);
        CustomServiceHost serviceHost =  (CustomServiceHost)factory.CreateServiceHost("guy",uris);
        ServiceEndpoint endpoint = serviceHost.AddServiceEndpoint(typeof(IService), new WSHttpBinding(), "");
        serviceHost.Open(); 
```

我遇到了一个例外：

```
 An exception occurred while initializing module 'PluginsModule'. 

- The exception message was: 'ServiceHostFactory.CreateServiceHost' cannot be invoked within the current hosting environment. This API requires that the calling application be hosted in IIS or WAS.

- The Assembly that the module was trying to be loaded from was:<"PluginsModule.plugin" , Version=1.0.0.0, Culture=neutral, PublicKeyToken=null

Check the InnerException property of the exception for more information. If the exception occurred while creating an object in a DI container, you can exception.GetRootException() to help locate the root cause of the problem. 
```

请帮忙

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T11:33:16.780

好的，问题是我不需要使用 CustomInstanceProvider。ServiecInstanceProvider 仅供 IIS 使用。我希望我的服务托管在自托管中。

```
 var uris = new Uri[1];
        uris[0] = new Uri("http://localhost:8793//Service/ntService/");
        var serviceHost = new CustomServiceHost(Container,typeof(Service),uris);
        serviceHost.AddDefaultEndpoints(); 
```

这就是我所需要的：实现 IInstanceProvider 和 ServiceHost。现在我可以将参数传递给我的构造函数。

谢谢

# permissions - Concrete5 - 警告：imagejpeg() [function.imagejpeg]

> ID：12277861
> 
> 赞同：0
> 
> 时间：2012-09-05T09:01:50.927
> 
> 标签：permissions, file-permissions, concrete5

> **可能重复：**
> [以前有没有人遇到过这个 php 错误，警告：imagejpeg()？](https://stackoverflow.com/questions/12312406/has-anyone-come-across-this-php-error-before-warning-imagejpeg)

我正在将 Concrete5 站点迁移到实时服务器，并在某些页面上不断收到此错误。主要是使用 Dojo 页面过滤器插件/块的页面，但并非总是如此。

警告：imagejpeg() [function.imagejpeg]：无法打开“/home/SITENAME/public_html/files/cache/052f225905c1618003df0c5088aec7a9.jpg”进行写作：/home/SITENAME/public_html/concrete/helpers/image.php 中的权限被拒绝在第 172 行

我尝试将文件夹的权限更改为 755 并应用于封闭的文件夹，但仍然没有运气？

有任何想法吗？

如果有帮助，我正在运行 5.4.2.2。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:24:04.123

更改权限可能尚未应用于现有文件 - 与您的网络主机的技术支持人员联系（或仔细阅读他们的知识库）以获取有关如何将该目录中的所有文件设置为 644 的信息（递归 - 所以它会命中每个文件每个子文件夹也是如此）。

# ios - 显示“这是什么？” UITableViewController 为空时的消息

> ID：12277862
> 
> 赞同：1
> 
> 时间：2012-09-05T09:01:51.987
> 
> 标签：ios, cocoa-touch, uitableview

我的应用程序包含几个 UITableViewControllers，它们不一定在所有情况下都有内容。例如，如果用户没有任何草稿，则草稿屏幕为空。

在这种情况下，我想显示一条简短的消息来解释屏幕的用途，例如内置照片应用程序中的这个屏幕：

![空白屏幕上的 iOS 导航栏，其中包含两张照片的轮廓，后跟标题](../Images/69aba2d75f0cfaa57cf613a482eaa6d4.png)

在屏幕上获得描述性视图的最佳方式是什么？我不能直接继承 UIViewController，因为我依赖于一些专门与 UITableViewController 相关的 iOS 6 功能，所以据我所知，我必须在 UITableView 中显示这个视图。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:17:52.237

Subclass `UITableViewController`，然后在`-viewDidAppear:`或其他类似的适当位置，检查表中的单元格数是否为零。如果是这样，请添加此叠加层；如果没有，请确保删除覆盖。下面的示例代码：

```
@interface MyTableViewController : UITableViewController
...
@property (nonatomic, weak) UIImageView *informativeOverlayImageView;
...
@end

@implementation MyTableViewController

...

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    // Just for an example - you'll have your own logic for determining if there will be zero rows.
    if (self.myDataModel.items.count == 0 &&
        !self.informativeOverlayImageView.superview)
    {
        if (!self.informativeOverlayImageView)
        {
            self.informativeOverlayImageView = [[UIImageView alloc] initwithImage:[UIImage imageNamed:@"someImageName"]];
            [self.informativeOverlayImageView sizeToFit];
        }
        [self.view addSubview:self.informativeOverlayImageView];
    }
    else if (self.myDataModel.items.count > 0 &&
            self.informativeOverlayImageView.superview)
    {
        [self.informativeOverlayImageView removeFromSuperview];
        [self.tableView reloadData]; // Add animations to taste.
    }
}

...

@end 
```

希望这可以帮助！

# java - 在 JSP 中使用外部项目

> ID：12277863
> 
> 赞同：1
> 
> 时间：2012-09-05T09:02:08.470
> 
> 标签：java, jsp, servlets, mp4parser

我从 Google Code 下载了一个名为“mp4parser”的项目。

现在我想在我的 JSP 页面中使用它（特别是在 servlet 中）。我如何导入它？

我使用 Netbeans。

在我的项目属性中，我添加了一个库（添加 JAR/文件夹）。

然后，在我写的 servlet 代码中

```
import com.googlecode.mp4parser.*; 
```

但我收到一个错误“包不存在”。

## 解决了

首先我必须编译 mp4parser 项目，然后手动指示 JAR 文件。Netbeans 无法自行找到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T09:06:41.870

所以你得到编译时错误？发生的唯一问题是您的 Jar 不在构建路径中。请检查[如何在 netbeans 中添加 jar](https://stackoverflow.com/questions/4879903/how-to-add-a-jar-in-netbeans)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T09:08:29.760

您应该创建您下载[的项目的 jar并将其](https://stackoverflow.com/questions/602537/producing-executable-jar-in-netbeans)[添加到类路径中](https://stackoverflow.com/questions/4879903/how-to-add-a-jar-in-netbeans)，然后您就可以使用它了。

# python - python清除csv文件

> ID：12277864
> 
> 赞同：7
> 
> 时间：2012-09-05T09:02:10.273
> 
> 标签：python, csv

如何使用 python 清除完整的 csv 文件。大多数涉及删除行/列问题的论坛条目基本上都说，将要保留的内容写入新文件。我需要完全清除文件 - 我该怎么做？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-05T09:11:25.607

基本上你想截断文件，这可以是任何文件。在这种情况下，它是一个 csv 文件，因此：

```
filename = "filewithcontents.csv"
# opening the file with w+ mode truncates the file
f = open(filename, "w+")
f.close() 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-05T09:08:40.293

你的问题很奇怪，但我会逐字解释。清除文件与删除文件不同。

您想要打开`file`CSV 文件的对象，然后`truncate`打开文件，使其长度为零。

```
f = open("filename.csv", "w")
f.truncate()
f.close() 
```

如果你想删除它，那只是一个 os 文件系统调用：

```
import os
os.remove("filename.csv") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T09:04:57.563

Python csv 模块仅用于读取和写入整个 CSV 文件，但不用于操作它们。如果您需要从文件中过滤数据，那么您必须读取它，创建一个新的 csv 文件并将过滤后的行写回新文件。

# jquery - 使用 jQuery 将节点添加到 JSON 文件

> ID：12277866
> 
> 赞同：1
> 
> 时间：2012-09-05T09:02:14.593
> 
> 标签：jquery, json, web-applications, localhost

我到处寻找，但我真的找不到如何将新节点添加到位于本地主机的 JSON 文件中......请分享一些代码。

我所拥有的是：

```
$.getJSON( 'demo.json', function(data) { 

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:04:09.840

[getJSON](http://api.jquery.com/jQuery.getJSON/)只检索数据。如果愿意，您可以在回调函数中为检索到的数据添加一个节点，以便在应用程序的其余部分中使用它。

如果您希望将新节点追加并保存到文件中，则需要将新数据写入服务器上的文件中。这不能从客户端完成。当然，您可以使用[AJAX](http://api.jquery.com/jQuery.ajax/)将新数据发送到服务器并将文件保存在那里。

# visual-studio - 高级安装程序中的多个构建配置

> ID：12277870
> 
> 赞同：3
> 
> 时间：2012-09-05T09:02:25.833
> 
> 标签：visual-studio, windows-installer, advanced-installer

我在 Visual Studio 2010 中使用 Advanced Installer。我设法创建了一个 .aip 项目，但是当我想从相关的 VS 项目中添加文件时，我必须选择这些文件的确切位置。

我想使用不止一种构建配置，因此我可以使用配置转换来更改我的 .config 文件，具体取决于我选择的构建配置。

这对我来说是个问题，因为当我在`Debug`.exe 和 .dll 文件中`bin\Debug`编译时`Staging`转到`bin\Staging`.

如何让[Advanced Installer](http://www.advancedinstaller.com)获取正确的文件，即从我选择的构建配置的目标文件夹中获取它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T09:27:49.070

高级安装程序默认不支持此功能，但稍作调整即可使其正常工作。让我解释一下如何：

1.  第一个要求是将VS生成的输出文件夹放在同一个父文件夹中，因为它们都放在“bin\”中。
2.  现在您需要在 Advanced Installer GUI 中打开您的项目并执行以下操作：
3.  在 Media 页面中创建两个构建，称为 Debug 和 Staging
4.  从安装参数页面创建一个名为“配置”的属性或您想要的名称
5.  在“新建属性”对话框中，您可以选择为您的属性设置每个构建值。将它们设置为“Debug”和“Staging”，即VS创建的文件夹的名称
6.  现在转到 File -> Options -> Path Variables 并使用您当前在项目中拥有的调试/登台的完整路径定义一个新的路径变量。
7.  在“主页”选项卡的工具栏中，使用“转换路径”向导，然后保存项目。

现在，棘手的部分来了，您需要在能够以 UTF-8 格式保存文件的文本编辑器（如 Notepad++）中编辑项目文件。打开文件后，查找此 XML 节点：

```
 <COMPONENT cid="caphyon.advinst.msicomp.AppPathsComponent">
<ROW Name="BIN_DIR" Path="<your path>\bin\Debug" Type="2" Content="0"/> 
```

如果您已经在使用此功能，则此处可能有多个变量。您需要编辑该值并将“Debug”替换为“[|Configuration]”。

现在您可以保存和构建项目，它应该为两个构建中的每一个拾取正确的文件。

# windows-8 - 如何访问特定的 resw 资源文件

> ID：12277873
> 
> 赞同：4
> 
> 时间：2012-09-05T09:02:35.850
> 
> 标签：windows-8, windows-runtime

对于 C#/XAML 中的 Windows 8 应用程序，我需要访问特定的资源文件。在 WP7 中我使用了 resx 文件，现在看来我们需要使用 resw 文件。它不是语言资源文件。我的文件名为 ConfigResources.resw，它只包含一个键：“ConfigFile”和一个值：一个字符串。

如何从我的代码中访问它？我试过这个没有任何运气：

```
 var storedConfigFile = Application.Current.Resources["ConfigResources"]; 
```

那么如何从我的代码中编辑键的值呢？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-15T06:26:54.060

我最近在 CodePlex 上创建了一个名为[ResW 文件代码生成器](http://visualstudiogallery.msdn.microsoft.com/3ab88efd-1afb-4ff5-9faf-8825a282596a)的项目，它简化了在 windows 商店应用程序项目中的代码中使用本地化资源。它是一个自定义工具，可以自动生成和更新一个帮助类，类似于 .NET 完整版中使用的 ResX 文件

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-05T13:30:20.917

根据[这里](http://msdn.microsoft.com/en-us/library/windows/apps/hh694557.aspx)，您需要使用`Windows.ApplicationModel.Resources.ResourceLoader`和`Windows.ApplicationModel.Resources.Core`命名空间提供与 resw 文件的交互。

它应该看起来像这样：

```
var loader = new Windows.ApplicationModel.Resources.ResourceLoader();
var text = loader.GetString("Farewell"); 
```

或者，如果您正在创建一个跨平台库，您也可以使用`System.Resources.ResourceManager`：

> 尽管 System.Resources.ResourceManager 类包含在 .NET for Windows Store 应用程序中，但我们不建议使用它。仅在作为可移植类库项目开发且面向多个平台的库中使用 ResourceManager。

像这样从[这里](http://msdn.microsoft.com/en-us/library/windows/apps/system.resources.resourcemanager.aspx)：

```
ResourceManager rm = new ResourceManager("Strings", typeof(Example).Assembly);
string timeString = rm.GetString("TimeHeader"); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-13T20:08:26.173

有一个[示例](http://code.msdn.microsoft.com/windowsapps/Application-resources-and-cd0c6eaa)显示了在 WinRT 应用程序中读取资源的不同方法（即从 resw 文件）。

# iphone - 表格视图中的图像延迟加载

> ID：12277881
> 
> 赞同：-1
> 
> 时间：2012-09-05T09:03:07.023
> 
> 标签：iphone, objective-c, xcode

我想在我的表格视图中使用延迟加载图像概念。我的图像规则字符串数组是（`MSMutableArray`）“图像”。我怎样才能在`cellForRowAtIndexPath`.

看起来像：

```
-(UITableViewCell *) tableView:(UITableView *)AtableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    UITableViewCell *cell=[searchtable dequeueReusableCellWithIdentifier:@"cell"];

    if(!cell)
    {

        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"cell"];

        cell.textLabel.font=[UIFont systemFontOfSize:12];

        cell.imageView.image=[UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:[appSmallLogos objectAtIndex:indexPath.row]]]];

        cell.detailTextLabel.text=[appReleaseDates objectAtIndex:indexPath.row];

    }

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:06:32.633

您可以使用[SDWebImage](https://github.com/rs/SDWebImage)库，该库将异步下载和缓存图像。通过将 url 作为参数传递给它

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *MyIdentifier = @"MyIdentifier";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:MyIdentifier];

    if (cell == nil)
    {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
                                       reuseIdentifier:MyIdentifier] autorelease];
    }

    // Here we use the new provided setImageWithURL: method to load the web image
    [cell.imageView setImageWithURL:[NSURL URLWithString:@"http://www.domain.com/path/to/image.jpg"]
                   placeholderImage:[UIImage imageNamed:@"placeholder.png"]];

    cell.textLabel.text = @"My Text";
    return cell;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T09:27:51.103

试试这个代码：

```
 UIActivityIndicatorView *indicator = [[UIActivityIndicatorView alloc]initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhiteLarge];
indicator.frame = CGRectMake(your bounds);  
[cell addSubview:indicator];
[indicator bringSubviewToFront:self.view];
[indicator startAnimating];

        dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH,  0ul);
    dispatch_async(queue, ^{
     //This is what you will load lazily
        NSString *u=[NSString stringWithContentsOfFile:r.url encoding:NSUTF8StringEncoding error:nil];
        NSURL *imageURL=url;
        NSData *image=[NSData dataWithContentsOfURL:imageURL];
        dispatch_sync(dispatch_get_main_queue(), ^{
            CustomCell *cell = (CustomCell *)[tableView cellForRowAtIndexPath:indexPath];
            cell.imageView.image=[UIImage imageWithData:image];
            [cell setNeedsLayout];
  [indicator stopAnimating];

        });
    });
cell.cellDescription.text=r.url;// this is which you want to add in first time. 
```

我不确定，但试试吧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T10:13:35.133

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    TableCellLayout *cell = (TableCellLayout *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if(cell == nil)
    {
        cell = [[TableCellLayout alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    cell.cellName = [[array valueForKey:@"name"] objectAtIndex:indexPath.row];
    cell.cellImage = [UIImage imageNamed:@"placeholder.png"]; // add a placeholder    

    NSString *imageURL = [[array valueForKey:@"imageLink"] objectAtIndex:indexPath.row];
    NSURL *theURL = [NSURL URLWithString:imageURL];

    if (asynchronousImageLoader == nil){
        asynchronousImageLoader = [[AsynchronousImages alloc] init];
    }
    [asynchronousImageLoader loadImageFromURL:theURL];

    cell.cellImage = asynchronousImageLoader.image;

return cell;
} 
```

我终于设法通过以下方式设置图像：

```
– performSelectorOnMainThread:withObject:waitUntilDone: 
```

图片下载后

# android - 方法内的Android onBackPressed()

> ID：12277886
> 
> 赞同：3
> 
> 时间：2012-09-05T09:03:20.510
> 
> 标签：android, android-activity

我有一个 Activity 类，里面有一些方法。我想实现`onBackPressed()`内部，`method2`因为我有一个重要的变量要释放。我不能/不使这个变量具有更大的范围，也不能在方法 2 中释放这个变量，因为我想通过按下后退按钮来终止应用程序和方法 2 的执行。

```
public  class example extends Activity {
    public void onCreate(Bundle savedInstanceState) {
        method1();
    }

    public method 1 {
        //take some input and assign in a variable.
        method2(variable); 
    }

    public method2 {
        // do something with the variable that take before at method 1
        // and finally press back button
        onBackPressed(){}
        //free variable , finish ();
    }
} 
```

如您所知，我不能`onBackPressed()`仅在活动区域​​覆盖该方法的内部。你能为我提供一个解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T09:06:34.203

您应该覆盖`onBackPressed()`活动范围内的方法并从您的方法中调用它。

```
@Override
public void onBackPressed()
{
    super.onBackPressed();
    // Do your things.
}

public void method()
{
    onBackPressed();
} 
```

如果要在`onBackPressed`方法中添加一些复杂的逻辑，只需创建另一个带参数的逻辑即可。

```
public void myOnBackPressed(int param1, String param2)
{
    // Do your complex logic.
    onBackPressed();
}

public void method()
{
    myOnBackPressed(myInt, myString);
} 
```

# java - 使用 SimpleFramework 解析日期

> ID：12277887
> 
> 赞同：15
> 
> 时间：2012-09-05T09:03:23.280
> 
> 标签：java, date, simple-framework

我收到一个包含以下值的属性的 XML 响应：

```
Wed Sep 05 10:56:13 CEST 2012 
```

我在我的模型类中定义了一个带有注释的字段：

```
@Attribute(name = "regDate")
private Date registerDate; 
```

但是它会引发异常：

```
java.text.ParseException: Unparseable date: "Wed Sep 05 10:56:13 CEST 2012" (at offset 0) 
```

是否可以在注释中定义日期格式`SimpleFramework`？

什么格式应该覆盖这个日期字符串？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-09-19T10:31:09.570

SimpleXML 只支持一些`DateFormat`'s：

*   **yyyy-MM-dd HH:mm:ss.S z**
*   **yyyy-MM-dd HH:mm:ss z**
*   **yyyy-MM-dd z**
*   **yyyy-MM-dd**

（有关每个字符的含义，请参见[SimpleDateFormat API Doc (Java SE 7)](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)）

但是，可以编写`Transform`处理其他格式的自定义：

## 转换

```
public class DateFormatTransformer implements Transform<Date>
{
    private DateFormat dateFormat;

    public DateFormatTransformer(DateFormat dateFormat)
    {
        this.dateFormat = dateFormat;
    }

    @Override
    public Date read(String value) throws Exception
    {
        return dateFormat.parse(value);
    }

    @Override
    public String write(Date value) throws Exception
    {
        return dateFormat.format(value);
    }

} 
```

## 对应注解

```
@Attribute(name="regDate", required=true) /* 1 */
private Date registerDate; 
```

**注1：** `required=true`可选

## 如何使用它

```
// Maybe you have to correct this or use another / no Locale
DateFormat format = new SimpleDateFormat("EE MMM dd HH:mm:ss z YYYY", Locale.US);

RegistryMatcher m = new RegistryMatcher();
m.bind(Date.class, new DateFormatTransformer(format));

Serializer ser = new Persister(m);
Example e = ser.read(Example.class, xml); 
```

# php - 从另一个表php mysql更新具有先前值的表

> ID：12277889
> 
> 赞同：0
> 
> 时间：2012-09-05T09:03:25.797
> 
> 标签：php, mysql

我有两个表：table_a（名称，ID）和 table_b（任务）。

我可以选择将 table_a.name 中的值插入 table_b.Task。

但是，当我想从 table_a.name 中删除一个值并且在 table_b.Task 中找到该值时，必须使用 table_a.name 中删除的值的先前值更新 table_b.Task 值。

这是代码：

```
 $delete=$_POST['deletevalue'];
  if(isset($_POST['_submit'])){

$id=mysql_query("SELECT ID FROM table_a WHERE name='$delete'");

$x=mysql_query("SELECT MAX(ID) FROM table_a WHERE ID<$id");

$task=mysql_query("SELECT name FROM table_a WHERE ID=$x");

$query1=mysql_query("delete from table_a where name='$delete'");

$query2=mysql_query("UPDATE table_b SET Stare='$task' WHERE Task='$delete'"); 
```

PS ID 是自动递增的

当我使用此代码并显示 table_b 时，应该更新的值是空白的。请帮我让它工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:55:59.617

In php, the function mysql_query returns a resultset object.

To fetch the actual value, you need to fetch the value from the resultset. This should help:

```
$objId=mysql_query("SELECT ID FROM table_a WHERE name='$delete'");
$rowId=mysql_fetch_row($objId);
$id=$rowId[0]; 
```

Similarly, you can get the values for the other instances.

As an aside, you can combine these queries:

```
$id=mysql_query("SELECT ID FROM table_a WHERE name='$delete'");
$x=mysql_query("SELECT MAX(ID) FROM table_a WHERE ID<$id");
$task=mysql_query("SELECT name FROM table_a WHERE ID=$x"); 
```

as

```
$objTask=mysql_query("SELECT a.name FROM table_a a WHERE a.ID=(SELECT MAX(b.ID) from table_a b WHERE b.ID<(SELECT c.ID FROM table_a c WHERE c.name='$delete'))");
$rowTask=mysql_fetch_row($objTask);
$task=$rowTask[0]; 
```

This will fetch the value you require.

EDIT: Update and delete statements don't generate any resultsets as output.

# python - python中的嵌套变量

> ID：12277890
> 
> 赞同：3
> 
> 时间：2012-09-05T09:03:30.920
> 
> 标签：python

是否预期 Python 中的嵌套变量会重叠？例如：

```
for i in range(1,10):
    x = [0xFF for i in range(6)]
    print(i) 
```

预期的结果（序列）是什么？使用 Python 2.7，我得到了九个五分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T09:07:02.477

您看到的是使用列表推导的副作用。列表推导式中的迭代器变量与 for 循环中的迭代器变量*相同。*这意味着列表推导的迭代器变量*不是*表达式本身的局部变量。

例子：

```
>>> [x for x in range(10)]
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
>>> print x
9 
```

所以两个迭代器变量名应该是不同的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T09:07:48.180

Python 没有块作用域。因此，您在块内更改的变量将在该块外可见。只有类、函数和模块才能创建作用域。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T09:05:01.590

`i`将指向 range(6) 中的最后一个元素，即`5`，当您打印它时

当列表理解完成时，值为`i`5，这是您在打印时得到的

您的外部循环运行 range(1,10) 即 9 次

```
In [47]: len(range(1,10))
Out[47]: 9 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T09:22:49.763

当您声明任何变量时，它将存储该值。在 python 中，当您初始化任何变量并存储一些值时，它将一直可用，直到变量不会破坏。因此，当您在循环内编写时`x = 10`，您也会得到`x`循环的外侧。如果你想删除那个变量然后输入`del x`然后你不会得到`x`

# hibernate - 在 Hibernate 中使用注解的 dynamicUpdate=true 不起作用

> ID：12277891
> 
> 赞同：2
> 
> 时间：2012-09-05T09:03:33.863
> 
> 标签：hibernate, annotations

即使在使用 org.hibernate.annotations.entity(dynamicUpdate=true) 在实体类注释中使用 dynamicUpdate=true（用于更新选择性列而不是所有列）之后，hibernate 仍在尝试更新表的所有字段，因为我在少数列上具有“非空”约束，它会引发异常。如何解决这个问题？请尽快帮忙。。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T09:11:46.067

要使动态更新起作用，您应该首先从休眠中获取对象，然后更改字段。

```
p = session.get(Person.class,1);
p.setFirstName("Kamal"); 
```

这将导致只更新 first_name 列的查询。

以下不起作用。它将发出一个更新查询，所有其他列都设置为空。

```
p = new Person()
p.setId(1)
p.setFirstName("Kamal")
session.update(p) 
```

如果您只想更新某些列，您可以使用 update HQL 命令。不建议这样做 - 因为它会通过缓存。正确的方法是上面概述的一种，加载对象，然后更改需要更改的字段。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-02T05:56:32.343

尝试这个，

```
@org.hibernate.annotations.Entity(dynamicUpdate = true, selectBeforeUpdate = true) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-10T16:52:56.620

动态更新仅在我们首先使用 session.get(...) 获取值时起作用。在这种情况下，假设我们有 10 列并且我们想要更新 5 列，然后首先我们使用 id 获取对象，然后将新值设置为获取的对象，然后它工作得很好更多我们只为5列编写编码，如果我们从那5列更新一列，然后使用动态更新查询触发，如下所示

休眠：更新用户管理员集名称=？user_id=?

下面是我的代码，在这里我只从前端改了名字

```
Session session = sessionFactory.openSession();
Transaction tran = session.beginTransaction();
Usermaster obj = (Usermaster) session.get(Usermaster.class,
        usermaster.getUserId());
obj.setUsername(usermaster.getUsername());
obj.setName(usermaster.getName());
obj.setContact(usermaster.getContact());
obj.setEmail(usermaster.getEmail());
obj.setUserStatus(usermaster.getUserStatus());
obj.setUserType(usermaster.getUserType());
session.update(obj); 
```

# android - 在 Android 中显示另一个屏幕 Onclick

> ID：12277892
> 
> 赞同：0
> 
> 时间：2012-09-05T09:03:38.267
> 
> 标签：android

```
package com.example.example;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.widget.Button;
import android.view.View;
import android.view.View.OnClickListener;

public class MainActivity extends Activity {
    Button btn;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        this.setContentView(R.layout.activity_main);
        this.btn = (Button)this.findViewById(R.id.button);
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        this.btn.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {         
                Intent intent = new Intent(MainActivity.this, profile.class);
                startActivity(intent);
            }     
        });
    }
} 
```

我没有收到任何错误，但是我的程序也没有按我的意愿运行。我是 android 新手，我想在单击按钮后更改屏幕，因为我正在使用两个类，所以在一个类中，我的程序应该调用另一个 onclick。我怎样才能做到这一点 ？我的代码如上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T09:07:02.603

首先删除`this.setContentView(R.layout.activity_main);`，因为您声明了两次。然后声明

`btn = (Button)this.findViewById(R.id.button);`

后

`setContentView(R.layout.activity_main);`

**在清单文件中声明您的个人资料活动。检查下面的代码。**

```
@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_main);
     btn = (Button)this.findViewById(R.id.button);
    btn.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {

               Intent intent = new Intent(MainActivity.this, profile.class);
           startActivity(intent);
        }     
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T09:08:50.373

1）您的 oncreate 方法应如下所示。

```
@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_main);
     btn = (Button)this.findViewById(R.id.button);
    btn.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {

               Intent intent = new Intent(MainActivity.this, profile.class);
           startActivity(intent);
        }     
    }); 
```

2）将**配置文件**活动添加到清单中。

3）在 onClick 方法中添加日志，以便您应该知道它是否被调用。

编码快乐！！

# javascript - 更改 keydown 上的 HTML5 Canvas 元素（JS、Jquery）

> ID：12277894
> 
> 赞同：0
> 
> 时间：2012-09-05T09:03:52.800
> 
> 标签：javascript, html, canvas

我试图在按下左键时在画布上移动一些东西。

```
$(document).ready(function () {

var ctx = document.getElementById('canvas').getContext('2d');
var img = new Image();
img.onload = function(){
    ctx.drawImage(img,0,0); // draw the image at the right coords
    ctx.drawImage(img,110,110); // draw the image at the right coords
    ctx.save();
};
img.src = 'tiles/processed/1_grass.png'; // Set source path

function draw() {
    ctx.translate(20,0);
};

draw();
draw();
draw();

$(document).keydown(function(e) {
    if (e.keyCode == 37) {
        draw();
    };

});

}); 
```

现在，看起来三个draw(); 的工作，但函数内部的一个没有。

我完全错过了画布的概念（因为它本质上是静态的，并且必须一直完全重新绘制）还是我做错了什么？

（ps：我也在使用Jquery）

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:08:12.510

你从来没有真正*重绘画*布。您绘制一次 ( `img.onload`)，否则仅*平移*画布。

您的`draw`函数应该清除画布并重绘图像。

* * *

这是一个基于您的代码的简单示例：

```
$(function () {
  var ctx = document.getElementById('canvas').getContext('2d');

  function draw() {
    ctx.save();
    ctx.setTransform(1, 0, 0, 1, 0, 0);
    ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
    ctx.restore();

    ctx.fillStyle = 'black';
    ctx.fillRect(0, 0, 20, 20);
  };

  draw();
  $(document).keydown(function(evt) {
    switch(evt.keyCode) {
      case 37:
        ctx.translate(-5, 0);
        break;
      case 38:
        ctx.translate(0, -5);
        break;
      case 39:
        ctx.translate(5, 0);
        break;
      case 40:
        ctx.translate(0, 5);
        break;
    }

    draw();
  });
});​ 
```

演示：http: [//jsfiddle.net/Vx2kQ/](http://jsfiddle.net/Vx2kQ/)

* * *

不过，就个人而言，我不会`translate`用来处理那个动作。我会使用一些 x/y 坐标，存储在私有变量中。在 keydown 上，我会操纵这些坐标并重绘。

# ios - UITableView 中没有项目出现

> ID：12277900
> 
> 赞同：0
> 
> 时间：2012-09-05T09:04:11.907
> 
> 标签：ios

我有一个带有 UITableView 的简单应用程序，即使它们应该出现，也没有出现任何项目。我忘记了什么......（我知道 cellForRowAtIndexPath 被调用）

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

 - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{

    return 1;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath    *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }
    [[cell textLabel] setText:@"terlala"];
    return cell;
} 
```

使用表视图控制器调用

```
 - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
 {
     self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
     // Override point for customization after application launch.
     self.window.backgroundColor = [UIColor whiteColor];
     SillyTableViewController * CamerasViewController = [[SillyTableViewController alloc] init];
    [[self window] addSubview:[CamerasViewController view]];
    [self.window makeKeyAndVisible];
    return YES;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T10:16:03.887

检查标识符“Cell”是否在您的单元格属性检查器中

# django - 阻止不在员工中的用户的 url。姜戈

> ID：12277903
> 
> 赞同：1
> 
> 时间：2012-09-05T09:04:36.063
> 
> 标签：django, url, django-admin

我想为没有员工身份的用户屏蔽一些网址。

现在我在每个 def 中检查我的代码

```
if not request.user.is_staff:
    ... 
```

但是我有这么多方法，而且它们都在 /app/ 路径下，所以我认为可能存在一种方法来阻止非员工用户访问这些方法。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T09:10:48.900

使用`staff_member_required`装饰器：

```
from django.contrib.admin.views.decorators import staff_member_required

@staff_member_required 
```

编辑：如果您需要，代码就[在这里。](http://code.djangoproject.com/browser/django/trunk/django/contrib/admin/views/decorators.py)

# vba - 在 VBA 中更改 ChartObject 的 x 轴

> ID：12277904
> 
> 赞同：1
> 
> 时间：2012-09-05T09:04:37.020
> 
> 标签：vba, excel, charts

如果我想将我的 x 轴更改为范围内的数据`G5:G105`，`Chart 2`那么我将其放入我的 VBA 子程序中：

```
ActiveSheet.ChartObjects("Chart 2").Activate
ActiveChart.SeriesCollection(1).XValues = "='Q1'!$G$5:$G$105" 
```

如何使我可以有一些任意范围而不是固定的`$G$5:$G$105`. 我试过用

```
ActiveChart.SeriesCollection(1).XValues = "='Q1'!Range("G5").Resize(I, 1)" 
```

其中`I`是`Integer`在子例程的前面部分中定义的某个变量。

但是它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T09:25:43.310

恐怕您的范围`"='Q1'!Range("G5").Resize(I, 1)"`是字符串和代码的非法组合。试试这个范围：`Range("Q1!G5").Resize(i, 1)`.

完整示例：

```
Option Explicit

Sub ChartTest()

    Dim i As Integer

    i = 2

    ActiveSheet.ChartObjects("Chart 2").Activate
    ActiveChart.SeriesCollection(1).XValues = Range("Q1!G5").Resize(i, 1)

End Sub 
```

# c++ - C++中的文件操作

> ID：12277906
> 
> 赞同：0
> 
> 时间：2012-09-05T09:04:44.297
> 
> 标签：c++, file

我将此代码在python中转换为c ++：

```
content = file(filename, "rb").read() 
```

这是 C++ 中的代码：

```
ifstream file;
file.open(filename, fstream::binary);

file.seekg (0, ios::end);
long fileLength = file.tellg();
file.seekg(0, ios_base::beg);

char *content = new char[fileLength];
file.read(content, fileLength); 
```

当我运行 python 代码时，我在内容中得到一个长字符串（500 个字符~），而 c++ 代码只返回 4 个字符。

有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T09:14:34.633

读取整个文件的最简单方法是：

```
std::string content(
    std::istreambuf_iterator<char>(std::ifstream(filename, std::fstream::binary).rdbuf()),
    std::istreambuf_iterator<char>()); 
```

# apache - 当用户访问目录 URL 时，如何通过编辑 .htaccess 在“/index.html”中显示内容？

> ID：12277908
> 
> 赞同：1
> 
> 时间：2012-09-05T09:04:46.310
> 
> 标签：apache, .htaccess, url, redirect, http-status-codes

我在域的根目录中有一个 .htaccess。我在这个 .htaccess 文件中有以下代码：

`DirectorySlash Off`

当用户访问该域中的任何目录 URL 时，我希望服务器始终能够`/index.html`以 HTTP 状态码 200 显示内容。该`/index.html`文件位于根目录中。请不要让服务器将用户重定向到文件`/index.html`。

如何通过编辑 .htaccess 文件来实现这一点？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:09:36.443

试试这个 ：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule . /index.html [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T09:07:58.623

这应该有效：

```
RewriteEngine On
RewriteRule ^(.+)/(.*)$ index.html?directory=$1&file=$2 
```

它还将解析“目录”`GET`变量和“文件”`GET`变量。

# ruby-on-rails - 在自定义路线上使用 kaminari 进行分页

> ID：12277917
> 
> 赞同：3
> 
> 时间：2012-09-05T09:05:08.687
> 
> 标签：ruby-on-rails, pagination, kaminari

我遇到了 kaminari 问题，使用自定义“unRestful”网址时似乎无法对结果进行分页。

```
resources :provinces, :path => '', :only => [ :show ] do
  resources :sports, :only => [ :show ] do
    match ':page', :controller => 'facilities', :action => 'index'
  end
end 
```

因此，/:foo/sports/:bar 指向一个控制器，/:foo/sports/:bar/1 指向另一个 1。这是一个令人作呕的 URL 方案，但我现在没有能力更改规范。

如果我在没有 Kaminari 的情况下调用该页面，一切都会按预期进行，我会看到第一页。当我使用 Kaminari 时：

```
<%= paginate @facilities, :params => { :controller => 'facilities', :action => 'index' } %> 
```

Rails 在以下 URL 上给我一个路由错误：

```
http://lvh.me:8080/milano/sports/palestra/1

No route matches {:controller=>"facilities", :province_id=>"milano", :sport_id=>"palestra", :page=>nil} 
```

老实说，我不知道该怎么做，一切对我来说似乎都是正确的，并且找不到关于我的案子的 kaminari 小组或更多文档。

问题似乎是对分页的调用在某种程度上生成了一个页面设置为 nil 的 URL ...

有什么建议吗？

使用 rails (3.2.8) 使用 kaminari (0.14.0)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-14T06:42:08.240

在控制器中

```
 @facilities = kaminari.paginate_array(@facilities).page(params[:page]).per(params[:per_page]) 
```

在你看来`<%= page_entries_info @facilities %>`&`<%= paginate @facilities %>`

# r - read.table 以意想不到的方式解析文本文件

> ID：12277919
> 
> 赞同：1
> 
> 时间：2012-09-05T09:05:14.980
> 
> 标签：r, memory

我正在尝试使用 R（64 位）读取一个大矩阵。该矩阵有 14.000 列和 900 行。问题在于，在矩阵的某个点，R 将一行拆分为新行。分裂不止一次。我想问题出在 R 内存中，即使我使用的是 64 位。谁能帮我？提前致谢。

仅 1 行示例：（来自 shell Unix）

```
SELT 0.00134 TGH 0.776554 P53 0.23436 MYC 0.2351 BRCA 0.7654.... # (the line has 9.573 columns) 
```

在 R`read.delim()`或`read.table()`（仅读取文件）之后：

```
SELT 0.00134 TGH 0.776554 P53 0.23436   
MYC 0.2351 BRCA 0.7654.... 
```

`MYC 0.2351 BRCA 0.7654`错误地在新行上。

埃莱奥诺拉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T13:44:33.143

我有同样的问题。我的解决方案是在 .txt 文件中添加一个名称：“V1”、“V2”...“Vmax_number_of_columns”。有了这个，它起作用了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T12:11:05.927

我们验证了我们执行的并行分析的输出已损坏，因此这就是 R“未能”正确读取文件的原因。无论如何，非常感谢您的帮助！

# javascript - 多个 onbeforeunload 事件

> ID：12277921
> 
> 赞同：2
> 
> 时间：2012-09-05T09:05:17.657
> 
> 标签：javascript, google-chrome, onbeforeunload

我的 Web 应用程序遇到了一个奇怪的问题。

有一个 onBeforeUnload 事件的侦听器，我在其中提示用户确认他是否真的要离开页面。

它工作正常，符合预期。但我面临一个间歇性问题。有时，onBeforeUnload 事件会同时触发多次（大约 100 次）。所以我得到了尽可能多的“确认导航”弹出窗口。我不确定为什么会触发这么多事件。

我与用户确认他们没有按刷新或返回按钮。我添加了一些日志记录并确认了相同的内容。

它在 Firefox 和 IE 中运行良好。只有在 chrome 中，我面临这个问题。用户每天至少报告一次此问题，并且他们正在重新启动浏览器以再次使用该应用程序。

我的问题是为什么会触发多个事件。什么样的行为会导致这种情况发生？

注意：我的页面有一些 iframe。但是他们都没有 onBeforeUnload 的监听器。

编辑：

我正在使用 javascript 添加事件，如下所示。

```
 window.onbeforeunload = function() {
          return "some message here";
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:12:32.463

您应该添加一个变量并根据该变量仅显示一次提示

```
var prompted = false;

window.onbeforeunload = function(){
    if(!prompted){
        // code here
        prompted = true;

        return 'You are leaving ....';
    }
} 
```

# php - 在第三页上传递变量值，同时单击第一页和第二页之间的链接

> ID：12277924
> 
> 赞同：0
> 
> 时间：2012-09-05T09:05:24.383
> 
> 标签：php, variables

问题：我需要通过单击位于页面 01.php 上的链接将变量值传递给页面 03.php 上的变量并指向页面 02.php。是否可以？如果是 - 如何？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:07:03.323

将此值存储在会话中 - 使用`$_SESSION`数组：

在`01.php`：

```
session_start();
$_SESSION['variable'] = $value; 
```

在`03.php`：

```
session_start();
echo $_SESSION['variable']; 
```

# .htaccess - 我可以使用一个 htaccess 文件来 301 将文件列表重定向到另一个域并且文件更改名称吗

> ID：12277927
> 
> 赞同：0
> 
> 时间：2012-09-05T09:05:26.320
> 
> 标签：.htaccess, mod-rewrite, redirect, http-status-code-301

我正在将一个网站移动到另一个域，同时我正在更改网站结构和文件名。
因此，我的每个旧文件都需要重定向到新域和不同的文件名，通常位于不同的文件夹中。
这可以通过我列出旧文件和新文件的单个 .htaccess 文件来完成吗？
这个 .htaccess 看起来如何？
把这个htaccess放在哪里？仅在根目录或每个文件夹中？
或者这个问题有其他解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:13:26.750

**A1：**是的，你可以。

**A2 :**这取决于你的链接（但我可以向你保证，如果你有很多链接，他可能看起来很乱）。

**A3 :**放在根目录下就够了。

# wso2 - 具有 BRS 和数据服务功能的 WSO2 ESB

> ID：12277931
> 
> 赞同：0
> 
> 时间：2012-09-05T09:05:34.843
> 
> 标签：wso2, wso2esb

我一直在分别测试 WSO2 BRS 和 WSO2 数据服务并正常工作。下一步是在 WSO2 ESB 中添加提供这些功能的特性，但它们存在保持服务部署的错误。

BRS 功能：无法上传 . jar 与规则的类模型。（规则服务 - 3.2.0）

数据服务功能：创建新服务的各种失败，不查看数据源表，无法上传之前创建的服务。（数据服务托管 - 3.2.0）

有没有人让这些功能正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T11:22:13.503

您使用的 ESB 版本是什么？如果是 ESB 4.0.3，请安装最新版本的规则服务和数据服务功能。规则服务和数据服务版本：3.2.2

谢谢

蒂利尼

# python - 将数据从文本框发送到 Flask？

> ID：12277933
> 
> 赞同：109
> 
> 时间：2012-09-05T09:05:38.377
> 
> 标签：python, flask

我想知道是否有一种方法可以从 HTML 中的文本框中获取某些内容，将其输入到烧瓶中，然后使用 Python 解析该数据。我在想这可能涉及一些 JS，但我可能是错的。有任何想法吗？

* * *

## 回答 #1

> 赞同：190
> 
> 时间：2012-09-05T09:47:09.767

除非您想做更复杂的事情，否则将 HTML 表单中的数据输入 Flask 非常容易。

*   创建一个接受 POST 请求的视图 ( `my_form_post`)。
*   访问字典中的表单元素`request.form`。

`templates/my-form.html`：

```
<form method="POST">
    <input name="text">
    <input type="submit">
</form> 
```

```
from flask import Flask, request, render_template

app = Flask(__name__)

@app.route('/')
def my_form():
    return render_template('my-form.html')

@app.route('/', methods=['POST'])
def my_form_post():
    text = request.form['text']
    processed_text = text.upper()
    return processed_text 
```

这是关于[访问请求数据](http://flask.pocoo.org/docs/quickstart/#accessing-request-data)的 Flask 文档。

如果您需要需要验证的更复杂的表单，那么您可以查看[WTForms](http://wtforms.simplecodes.com/docs/1.0.2/crash_course.html)以及[如何将它们与 Flask 集成](http://flask.pocoo.org/docs/patterns/wtforms/)。

*注意：除非您有任何其他限制，否则您根本*不需要 JavaScript来发送数据（尽管您可以使用它）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-05T09:35:41.607

声明一个 Flask 端点以接受 POST 输入类型，然后执行必要的步骤。使用 jQuery 发布数据。

```
from flask import request

@app.route('/parse_data', methods=['GET', 'POST'])
def parse_data(data):
    if request.method == "POST":
         #perform action here 
```

```
var value = $('.textbox').val();
$.ajax({
  type: 'POST',
  url: "{{ url_for('parse_data') }}",
  data: JSON.stringify(value),
  contentType: 'application/json',
  success: function(data){
    // do something with the received data
  }
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T09:29:01.647

服务器（您的烧瓶应用程序）和客户端（浏览器）之间的所有交互都通过请求和响应进行。当用户在您的表单中点击按钮提交时，他的浏览器会使用此表单向您的服务器（flask 应用程序）发送请求，您可以获得如下表单的内容：

```
request.args.get('form_name') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T09:26:07.337

假设您已经知道如何[编写一个](http://flask.pocoo.org/docs/tutorial/views/)`Flask`响应 url 的视图，请创建一个读取数据`request.post`的视图。要添加`input box`到此帖子数据，请在您的页面上使用文本框创建一个表单。然后你可以用`jquery`做

`var data = $('#<form-id>').serialize()`

然后使用类似下面的内容异步发布到您的视图。

```
$.post('<your view url>', function(data) {
  $('.result').html(data);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-17T12:34:22.490

这对我有用。

```
def parse_data():
    if request.method == "POST":
        data = request.get_json()
        print(data['answers'])
        return render_template('output.html', data=data) 
```

```
$.ajax({
      type: 'POST',
      url: "/parse_data",
      data: JSON.stringify({values}),
      contentType: "application/json;charset=utf-8",
      dataType: "json",
      success: function(data){
        // do something with the received data
      }
    }); 
```

# php - 我可以使用 Google sitemap.php 代替 .xml 吗？

> ID：12277936
> 
> 赞同：5
> 
> 时间：2012-09-05T09:05:51.613
> 
> 标签：php, xml, sitemap

我用 PHP 编写了一个生成 XML 站点地图的脚本。它有一个 text/xml 标头并输出一个 XML 结构。我可以将此 sitemap.php 文件上传到 Google 还是需要具有 .xml 扩展名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T09:11:57.683

查看[http://www.sitemaps.org/](http://www.sitemaps.org/)。

所有规则都在这里定义。

示范见：

*   [http://www.sitemaps.org/faq.html#faq_sitemap_location](http://www.sitemaps.org/faq.html#faq_sitemap_location)
*   [http://www.sitemaps.org/protocol.html#informing](http://www.sitemaps.org/protocol.html#informing)

您只需要一个 URL，然后将该 URL 宣布为您的站点地图。

协议本身没有`.xml`要求。

通常将其放在根目录下`http://example.com/sitemap.xml`，但请阅读参考文档以了解所有详细信息，您不是必须这样做的，可能有充分的理由不这样做，并且站点地图文件的位置对其内容有影响。因此，最好阅读并仔细阅读它，以找到适合您尝试做的最佳解决方案。

# android - 在 Android Chrome 上禁用同源策略

> ID：12277938
> 
> 赞同：7
> 
> 时间：2012-09-05T09:05:54.787
> 
> 标签：android, google-chrome, same-origin-policy

有没有办法在 Android Chrome 上禁用同源策略，我搜索了其他帖子并没有找到关于 android 版本的任何答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T18:49:20.480

没有办法禁用同源策略，因为它是网络安全的基础。不过有一些方法可以解决它，比如[CORS](http://www.w3.org/TR/cors/)，它应该可以在 Chrome for Android 中使用。

# logging - 有没有办法添加一个模块来格式化对啤酒的调用？

> ID：12277940
> 
> 赞同：0
> 
> 时间：2012-09-05T09:06:00.713
> 
> 标签：logging, erlang

我想美化 Erlang 项目的日志记录。目前，它使用 lager 主要记录整数。例如：

```
lager:error("Failed with: ~p", [1]). 
```

我试图弄清楚是否有一种方法可以指定一个模块：在将参数传递给 lager 之前将调用的函数？此函数会将参数从整数转换为更易于理解的值。此外，它可以让我避免手动更改所有对 lager 的调用并将它们传递给一个函数，例如：

```
lager:error("Failed with: ~p", beautify([1])). 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:18:51.863

这是一个简单但非常丑陋的解决方案：

```
-define(beauty_log(Level, Format, Args),
    lager:Level(Format, amodule:beautify(Args))).

test() ->
    ?beauty_log(error, "Failed with: ~p", [1]). 
```

# debugging - 如何调试托管客户端使用的非托管接口

> ID：12277942
> 
> 赞同：0
> 
> 时间：2012-09-05T09:06:12.877
> 
> 标签：debugging

如何调试托管客户端使用的非托管接口。

我有一个名为 TestInterface 的接口，它是用非托管 C++ 构建的。还有一个客户端，client1，内置在托管 C# 中，它使用接口 TestInterface。当我附加客户端进程时，TestInterface 中的断点没有达到条件。

我怎样才能使它可调试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T12:30:08.100

如果是 VS2010，设置项目 | 属性 | 配置属性 | 调试 | 调试器类型 = 混合。其他版本也一样，但获取调试器类型的路径可能不同。

# java - 如何在从@Around 抛出的连接点中捕获异常

> ID：12277944
> 
> 赞同：3
> 
> 时间：2012-09-05T09:06:22.213
> 
> 标签：java, spring, security, aspectj, spring-aop

跟进我上一个问题的[评论](https://stackoverflow.com/questions/12248716/conditional-behavior-of-spring-aop-before-advice#comment16421693_12249543)。我试图从`@Around`建议中抛出一个异常，并在被调用者类和/或方法中捕获它。但我收到了这个错误：

```
Stacktraces

java.lang.Exception: User not authorized
    com.company.aspect.AuthorizeUserAspect.isAuthorized(AuthorizeUserAspect.java:77)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    java.lang.reflect.Method.invoke(Method.java:616)
    ... 
```

方面代码是：

```
@Aspect
public class AuthorizeUserAspect {
    @AuthoWired
    private UserService service;

    @Pointcut("@annotation(module)")
    public void authorizeBeforeExecution(AuthorizeUser module) {}

    @Around(value = "authorizeBeforeExecution(module)", argNames="module")
    public Object isAuthorized(ProceddingJoinPoint jp, AuthorizeUser module) throws Throwable {
        // Check if the user has permission or not
        service.checkUser();

        if ( /* User has NOT permission */ ) {
            throw new MyCustomException("User not authorized"); // => this is line 77
        }

        return jp.proceed();
    }
} 
```

而基于 Struts 的 UI 动作代码是：

```
@Component
public class DashboardAction extends ActionSupport {
    @Override
    @AuthorizeUser
    public String execute() {
        ...
    }

    private void showAccessDenied() {
       ...
    }
} 
```

问题是如何或在哪里可以捕获该异常以执行`showAccessDenied()`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T10:03:38.890

要处理未捕获的异常，`MyCustomException`您需要在 Struts 2 中定义一个全局异常处理程序。请查看本指南：[http ://struts.apache.org/2.3.4.1/docs/exception-handling.html](http://struts.apache.org/2.3.4.1/docs/exception-handling.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T09:13:17.683

对于用户界面，我建议编写一个简短的代码来捕获任何未捕获的异常。

```
class EventQueueProxy extends EventQueue {
    @Override
    protected void dispatchEvent(AWTEvent newEvent) {
        try {
            super.dispatchEvent(newEvent);
        } catch (Throwable t) {
            String message = t.getMessage();
            if (message == null || message.length() == 0) {
                message = "Fatal: " + t.getClass();
            }
            JOptionPane.showMessageDialog(null, message, "Unhandled Exception Caught!", JOptionPane.ERROR_MESSAGE);
        }
    }
} 
```

然后在 ui 类中：

```
public static void main(String args[]) {

    EventQueue queue = Toolkit.getDefaultToolkit().getSystemEventQueue();
    queue.push(new EventQueueProxy());

    //your code goes here...
} 
```

请注意，每次出现未捕获的异常时，它都会显示带有错误信息的对话框窗口。这只是对您的用户界面的建议，对于您的问题的特定情况，请使用*try*来触发授权用户的方法，并使用*catch*来触发如果用户未获得授权则应该执行的方法。在这种情况下，如果授权失败，授权方法应该抛出异常。然后将不会打印错误，而是会触发特定的方法。

这就是我要添加到您的代码中的内容：

```
@Component 
public class DashboardAction extends ActionSupport {
    @Override
    try {
        @AuthorizeUser
        public String execute() {
                 ...     
        }
    } catch (Exception e) {
        private void showAccessDenied() {
                ...
        }
    }
} 
```

# php - PHP 如何舍入到小数点后两位？

> ID：12277945
> 
> 赞同：54
> 
> 时间：2012-09-05T09:06:22.393
> 
> 标签：php, decimal, rounding, number-formatting

我需要将 PHP 中的小数四舍五入到小数点后两位，以便：

```
49.955 
```

变成……

```
49.95 
```

我试过**number_format**，但这只是将值四舍五入为**49.96**。我不能使用**substr**，因为数字可能更小（例如 7.950）。到目前为止，我一直无法找到答案。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2012-09-05T09:13:14.403

这可以工作：`floor($number * 100) / 100`

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2014-10-21T16:19:22.537

不幸的是，以前的答案（包括接受的答案）都不适用于所有可能的输入。

1)`sprintf('%1.'.$precision.'f', $val)`

以 2 的精度失败：14.239 应该返回 14.23（但在这种情况下返回 14.24）。

2)`floatval(substr($val, 0, strpos($val, '.') + $precision + 1))`

以 0 的精度失败：14 应该返回 14（但在这种情况下返回 1）

3)`substr($val, 0, strrpos($val, '.', 0) + (1 + $precision))`

以 0 的精度失败：-1 应该返回 -1（但在这种情况下返回“-”）

4)`floor($val * pow(10, $precision)) / pow(10, $precision)`

虽然我广泛使用了这个，但我最近发现了它的一个缺陷；对于某些值，它也失败了。精度为 2 ： 2.05 应该返回 2.05 （但在这种情况下返回 2.04 !!）

到目前为止，不幸的是，通过所有测试的唯一方法是使用字符串操作。我基于rationalboss one的解决方案是：

```
function floorDec($val, $precision = 2) {
    if ($precision < 0) { $precision = 0; }
    $numPointPosition = intval(strpos($val, '.'));
    if ($numPointPosition === 0) { //$val is an integer
        return $val;
    }
    return floatval(substr($val, 0, $numPointPosition + $precision + 1));
} 
```

此函数适用于正数和负数，以及所需的任何精度。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-09-05T09:12:38.297

这是一个很好的函数，它可以在不使用字符串函数的情况下完成任务：

```
<?php
function floorp($val, $precision)
{
    $mult = pow(10, $precision); // Can be cached in lookup table        
    return floor($val * $mult) / $mult;
}

print floorp(49.955, 2);
?> 
```

另一种选择是在四舍五入前减去一个分数：

```
function floorp($val, $precision)
{
    $half = 0.5 / pow(10, $precision); // Can be cached in a lookup table
    return round($val - $half, $precision);
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2019-03-19T10:48:21.270

我认为有一种非常简单的方法可以实现这一点：

```
$rounded = bcdiv($val, 1, $precision); 
```

这是一个[工作示例](http://sandbox.onlinephpfunctions.com/code/6bcf989ea7054f2849dae9a4b7c1b389018b2ce5)。您需要安装 BCMath，但我认为它通常与 PHP 安装捆绑在一起。:)[这是文档](https://secure.php.net/manual/en/function.bcdiv.php)。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-09-05T09:13:04.687

将输入乘以 100，将其 floor()，然后将结果除以 100。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-02-20T00:51:49.950

```
function roundDown($decimal, $precision)
{
    $sign = $decimal > 0 ? 1 : -1;
    $base = pow(10, $precision);
    return floor(abs($decimal) * $base) / $base * $sign;
}

// Examples
roundDown(49.955, 2);           // output: 49.95
roundDown(-3.14159, 4);         // output: -3.1415
roundDown(1000.000000019, 8);   // output: 1000.00000001 
```

此函数适用于任何精度的正小数和负小数。

此处的代码示例：http: [//codepad.org/1jzXjE5L](http://codepad.org/1jzXjE5L)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-03-19T10:55:14.573

您可以使用 bcdiv PHP 函数。

```
bcdiv(49.955, 1, 2) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-09-05T09:10:08.220

试试这个[`round()`](http://php.net/manual/en/function.round.php)功能

像这样：`round($num, 2, PHP_ROUND_HALF_DOWN);`

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-11-20T22:39:21.550

对于有需要的人，我使用了一个小技巧来克服数学函数故障，例如 floor 或**intval(9.7*100)=969**奇怪。

```
function floor_at_decimals($amount, $precision = 2)
{
    $precise = pow(10, $precision);
    return floor(($amount * $precise) + 0.1) / $precise;
} 
```

所以添加少量（无论如何都会被搁置）以某种方式解决了这个问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-03-11T10:26:41.103

```
function floorToPrecision($val, $precision = 2) {
        return floor(round($val * pow(10, $precision), $precision)) / pow(10, $precision);
    } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-09-05T09:09:27.327

使用格式化输出

```
sprintf("%1.2f",49.955) //49.95 
```

[**演示**](http://codepad.org/yqaqMnuV)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-09-05T09:09:36.183

您可以使用：

```
$num = 49.9555;
echo substr($num, 0, strpos($num, '.') + 3); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-11-30T20:33:28.647

使用正则表达式的替代解决方案应该适用于所有正数或负数，整数或小数：

```
if (preg_match('/^-?(\d+\.?\d{1,2})\d*$/', $originalValue, $matches)){
    $roundedValue = $matches[1];
} else {
    throw new \Exception('Cannot round down properly '.$originalValue.' to two decimal places');
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-09-02T12:41:14.777

基于@huysentruitw 和@Alex 的回答，我想出了以下应该可以解决问题的函数。

它通过了亚历克斯答案中给出的所有测试（为什么这是不可能的）并建立在 huysentruitw 的答案之上。

```
function trim_number($number, $decimalPlaces) {
    $delta = (0 <=> $number) * (0.5 / pow(10, $decimalPlaces));
    $result = round($number + $delta, $decimalPlaces);
    return $result ?: 0; // get rid of negative zero
} 
```

关键是在原始数字符号的基础上加减delta，以支持修剪负数。最后一件事是去掉负零 (-0)，因为这可能是不受欢迎的行为。

[链接到“测试”游乐场](https://www.tehplayground.com/umVYyMlN9rUFEP83)。

编辑： bcdiv 似乎是要走的路。

```
// round afterwards to cast 0.00 to 0
// set $divider to 1 when no division is required
round(bcdiv($number, $divider, $decimalPlaces), $decimalPlaces); 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2013-10-14T11:14:27.550

```
sprintf("%1.2f",49.955) //49.95 
```

如果您需要在不四舍五入的情况下截断小数 - 这是不合适的，因为它会在最后 49.95 **5**之前正常工作，如果数字更多，例如 49.95 **7**，它将四舍五入到 49.96
在我看来，Lght 的答案是最普遍的。

* * *

## 回答 #16

> 赞同：-5
> 
> 时间：2012-09-05T09:08:55.103

你试过了`round($val,2)`吗？

有关该[`round()`](http://php.net/manual/en/function.round.php)功能的更多信息

# android - 如何在 Android 的选项卡应用程序中导航？与我的源类

> ID：12277947
> 
> 赞同：0
> 
> 时间：2012-09-05T09:06:31.243
> 
> 标签：android, android-intent, navigation, tabview

// 下面的第四个是我项目中的第四个选项卡活动，所以在它里面有更多的其他活动，比如`MasjidsearchActivity`项目内部。它显示为单独的活动，但我想要剩余的选项卡

```
package com.hands.iagd.app;

import java.util.ArrayList;
import java.util.List;

import android.R.layout;
import android.R.string;
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ArrayAdapter;
import android.widget.ListAdapter;
import android.widget.ListView;
import android.widget.SimpleAdapter;

public class Fourth extends Activity {
static  String[] values,Masjeed,Alaram;
    String[]  adjust_calender;
    ListView lv1,lv2,lv3,lv4;
    public static List<String> Calculation_method=new ArrayList<String>();
    int index,index2;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.fourth);
    lv1=(ListView)findViewById(R.id.lv1);
    lv2=(ListView)findViewById(R.id.lv2);
    lv3=(ListView)findViewById(R.id.lv3);
    lv4=(ListView)findViewById(R.id.lv4);

values = new String[] {"Jafari","Karachi","ISNA","MWL","Makkah","Egypt","Custom","Tehran"};
Masjeed = new String[] {"IAGD Masjid"};
Alaram = new String[] {""};

String hijriString="Hijri Calender             "+Adjust_Time.hijriAdjust;
adjust_calender= new String[]{hijriString};

lv1.setAdapter(new ArrayAdapter<String>(this,
        android.R.layout.simple_list_item_single_choice,values));
lv1.setChoiceMode(ListView.CHOICE_MODE_SINGLE);

index=First.index;
lv1.setItemChecked(index, true);

lv1.setOnItemClickListener(new OnItemClickListener() {

    @Override
    public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
            long arg3) {
        // TODO Auto-generated method stub
        index=arg2;
        First.index=arg2;

        System.out.println("index " +index);
    }
});
Masjeed=MasjidsearchActivity.selectedmasjid;
lv2.setAdapter(new ArrayAdapter<String>(this,
        android.R.layout.simple_list_item_1,Masjeed));
lv2.setChoiceMode(ListView.CHOICE_MODE_SINGLE);

lv2.setItemChecked(index2, true);

lv2.setOnItemClickListener(new OnItemClickListener() {

    @Override
    public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
            long arg3) {
        // TODO Auto-generated method stub
        index2=arg2;
        First.index2=arg2;

        System.out.println("index " +index2);

        Intent masjid=new Intent(Fourth.this,MasjidsearchActivity.class);
        startActivity(masjid);
    }
});
lv3.setAdapter(new ArrayAdapter<String>(this, 
        android.R.layout.simple_list_item_1,adjust_calender));

lv3.setOnItemClickListener(new OnItemClickListener() {

    @Override
    public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
            long arg3) {
        // TODO Auto-generated method stub

            Adjust_Time.sahurORiftar="hijri";

        Intent i=new Intent(Fourth.this,Adjust_Time.class);
        startActivity(i);
    }
});

}

@Override
    protected void onResume() {
    // TODO Auto-generated method stub
    String hijriString="Hijri Calender                   "+Adjust_Time.hijriAdjust;
    adjust_calender= new String[]{hijriString};
    lv1.setAdapter(new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_single_choice,values));
    lv1.setChoiceMode(ListView.CHOICE_MODE_SINGLE);
    index=First.index;
    lv1.setItemChecked(index, true);

    lv2.setAdapter(new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_single_choice,Masjeed));
    lv2.setChoiceMode(ListView.CHOICE_MODE_SINGLE);
    index2=First.index2;
    lv2.setItemChecked(index2, true);

    lv3.setAdapter(new ArrayAdapter<String>(this, 
            android.R.layout.simple_list_item_1,adjust_calender));

    super.onResume();
}   
} 
```

//这里是 MasjidsearchActivity 类

```
package com.hands.iagd.app;

/**
 * ©2010 by androidblogger.ch
 */

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Hashtable;
import java.util.List;

import android.app.Activity;
import android.app.Dialog;
import android.content.Intent;
import android.os.Bundle;
import android.text.Editable;
import android.text.TextWatcher;
import android.view.ContextMenu;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.ContextMenu.ContextMenuInfo;
import android.view.View.OnClickListener;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ListView;
import android.widget.RadioButton;
import android.widget.SimpleAdapter;
import android.widget.TextView;
import android.widget.Toast;

public class MasjidsearchActivity extends Activity {
    RadioButton rb1 ;
    Button b1,btn;
    EditText edittext;
     ListView mainListView;
     static  String[]  selectedmasjid=new String[] {"IAGD Masjid"};;
    List<Hashtable<String,String>> list1 = new ArrayList<Hashtable<String,String>>();
     int textlength = 0;
     ArrayList<String> text_sort = new ArrayList<String>();
        ArrayList<Integer> image_sort = new ArrayList<Integer>();
        ArrayList<String> text_sort2 = new ArrayList<String>();
    // ArrayList which contains our HashMap's with different objects
    private  ArrayList<HashMap<String, Object>> myList;
    private  ArrayList<HashMap<String, Object>> myList1;
    private  ArrayList<HashMap<String, Object>> filterList;
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.masjidlist);
        b1=(Button)findViewById(R.id.button1);
        btn=(Button)findViewById(R.id.btn);
        btn.setOnCreateContextMenuListener(this);
       //rb1=(RadioButton)findViewById(R.id.radioButton1);

       /*rb1.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {

System.out.println( "inside radio buttons" );
            }});*/

        mainListView = (ListView) findViewById(R.id.main_listview);
        b1.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                IAGDAPPActivity.settingCurrentTab=3;
         Intent int1 = new Intent(MasjidsearchActivity.this, IAGDAPPActivity.class);
                    startActivity(int1);

            }});

        edittext = (EditText) findViewById(R.id.search_mycontact);
        // Create Hash Map
        myList = new ArrayList<HashMap<String, Object>>();
        myList1 = new ArrayList<HashMap<String, Object>>();
        filterList = new ArrayList<HashMap<String, Object>>();

        edittext.addTextChangedListener(new TextWatcher()
        {

       public void afterTextChanged(Editable s)
        {

        }

      public void beforeTextChanged(CharSequence s, int start,
        int count, int after)
        {

        }
    public void onTextChanged(CharSequence s, int start,
         int before, int count)
         {

       textlength = edittext.getText().length();
       text_sort.clear();
       image_sort.clear();
       text_sort2.clear();
       filterList.clear();

       for (int i = 0; i < myList1.size(); i++)
       {
           HashMap<String,Object> maps=new HashMap<String, Object>();
           maps=myList1.get(i);
           String masjidName=maps.get("MosquesNames").toString();
           String cityName=maps.get("MosqueCity").toString();
            List<String> searchStrring = new ArrayList<String>(Arrays.asList(masjidName.split(" ")));
            searchStrring.add(masjidName);
            searchStrring.add(cityName);
                for (String s123 : searchStrring) {

                    if (textlength <= s123.length())
                       {

                      if (edittext.getText().toString().
                               equalsIgnoreCase((String) s123.subSequence(0, textlength)))
                               {

                                   filterList.add(maps);
                                   break;
                                }
                }
      /* if (edittext.getText().toString().
       equalsIgnoreCase((String) masjidName.subSequence(0, textlength)))
       {
       //text_sort.add(month[i]);
       //image_sort.add(image[i]);
      // text_sort2.add(desc[i]);
           filterList.add(maps);
        }*/
       }
       }
displayList(filterList);
mainListView = (ListView) findViewById(R.id.main_listview);
mainListView.setChoiceMode(ListView.CHOICE_MODE_SINGLE);

        System.out.println("****3");      

        }
       });

        // Fill data
       // addDataToList();
        addDBFROMCSV();
        // View
         mainListView = (ListView) findViewById(R.id.main_listview);

        // Adapter
/*        SimpleAdapter aa = new SimpleAdapter(this, myList, R.layout.row,
                new String[] {"name", "address", "city", "icon"}, 
                new int[] {R.id.txt_name, R.id.txt_town, R.id.txt_phone, R.id.img_user});
        mainListView.setAdapter(aa);*/

      /*  SimpleAdapter aa = new SimpleAdapter(this, myList1, R.layout.row,
                new String[] {"MosquesNames", "MosqueAddress", "MosqueCity","icon"}, 
                new int[] {R.id.txt_name, R.id.txt_town, R.id.txt_phone, R.id.img_user});
        mainListView.setAdapter(aa);

*/      displayList(myList1);  
        // Listener
mainListView.setChoiceMode(ListView.CHOICE_MODE_SINGLE);

        mainListView.setOnItemClickListener(new OnItemClickListener() {
          public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
              // Get the HashMap of the clicked item
              HashMap<String, Object> user = myList1.get(position);

              // Get Attribute name of the HashMap
              String name = (String)user.get("MosquesNames");
              selectedmasjid =new String[] {name};

              System.out.println("name:"+selectedmasjid.length);
              // Create new Dialog
              final Dialog dialog = new Dialog(MasjidsearchActivity.this);
              dialog.setTitle(" " + name);
              TextView txtDescription = new TextView(MasjidsearchActivity.this);
              txtDescription.setPadding(10, 0, 0, 10);
              txtDescription.setText("Masjid Selected");
              dialog.setContentView(txtDescription);

              dialog.setCanceledOnTouchOutside(true);
              dialog.show();
          }
        });  

    }

    public void onCreateContextMenu(ContextMenu menu, View view,ContextMenuInfo menuInfo)
    {
    super.onCreateContextMenu(menu, view, menuInfo);
    CreateMenu(menu);
    }
    @Override

    public boolean onContextItemSelected(MenuItem item)
    {
    return MenuChoice(item);
    }

    private void CreateMenu(Menu menu)
    {

            MenuItem mnu1 = menu.add(0, 0, 0, "Register with us");
            {
                    mnu1.setAlphabeticShortcut('a');
                    //mnu1.setIcon(R.drawable.image1);
            }
            MenuItem mnu2 = menu.add(0, 1, 1, "Notify about your Masjid ");
            {
                    mnu2.setAlphabeticShortcut('b');
                    //mnu2.setIcon(R.drawable.image2);
            }
            MenuItem mnu3 = menu.add(0, 2, 2, "Cancel");
            {
                    mnu3.setAlphabeticShortcut('c');
                    //mnu3.setIcon(R.drawable.image3);
            }
        /*  MenuItem mnu4 = menu.add(0, 3, 3, "Item 4");
            {
                    mnu4.setAlphabeticShortcut('d');
            }
            menu.add(0, 4,4, "Item 5");
            menu.add(0, 5,5, "Item 6");
            menu.add(0, 6,6, "Item 7");*/
    }
    private boolean MenuChoice(MenuItem item)
    {
            switch (item.getItemId())
            {
            case 0:
                Intent i=new Intent(MasjidsearchActivity.this,Register.class);
                startActivity(i);

                //Toast.makeText(this, "You clicked on Notify",Toast.LENGTH_LONG).show();
                return true;
            case 1:
                Intent i1=new Intent(MasjidsearchActivity.this,masjidnotify.class);
                startActivity(i1);

                //Toast.makeText(this, "You clicked on Register",Toast.LENGTH_LONG).show();
                return true;
            case 2:
                //Toast.makeText(this, "You clicked on Cancel",Toast.LENGTH_LONG).show();
                return true;
            /*case 3:
                Toast.makeText(this, "You clicked on Item 4",Toast.LENGTH_LONG).show();
                return true;*/
        /*  case 4:
                Toast.makeText(this, "You clicked on Item 5",Toast.LENGTH_LONG).show();
                return true;
            case 5:
                Toast.makeText(this, "You clicked on Item 6",Toast.LENGTH_LONG).show();
                return true;

            case 6:
                Toast.makeText(this, "You clicked on Item 7",Toast.LENGTH_LONG).show();
                return true;*/
            }
            return false;

    }
    private void displayList(ArrayList<HashMap<String, Object>> myLists) {
          SimpleAdapter aa = new SimpleAdapter(this, myLists, R.layout.row,
                  new String[] {"MosquesNames", "MosqueAddress", "MosqueCity","icon"}, 
                  new int[] {R.id.txt_name, R.id.txt_town, R.id.txt_phone, R.id.img_user});
          mainListView.setAdapter(aa);
          mainListView.setChoiceMode(ListView.CHOICE_MODE_SINGLE);

    }

    private void addDBFROMCSV()
    {
         InputStream is = this.getResources().openRawResource
         (R.raw.listofmosquesinusa);
             BufferedReader reader = new BufferedReader(new InputStreamReader
         (is));
             try {
                ArrayList< String> list=new ArrayList<String>();
                 String line;
                 while ((line = reader.readLine()) != null) {
                     // do something with "line"
                 // System.out.println("llllll"+line);
                    list.add(line);
                 }
               //  System.out.println("llllll"+list);
                 ArrayList<List<String>> arrayList=new ArrayList<List<String>>();
                 for(int i=0;i<list.size();i++)
                 {
                    String s1=list.get(i);
                    List<String> list12 = new ArrayList<String>(Arrays.asList(s1.split("123456COLUMNDEVIDER")));
                 // System.out.println("List1 is "+list1);
                 // System.out.println("List size is "+list1.size());
                 arrayList.add(list12); 

                 }

                 ArrayList<List<String>> updatedList =new ArrayList<List<String>>();
                 for(int k=0;k<arrayList.size();k++)
                 {
                     List<String> l111=new ArrayList<String>();
                     List<String> l1=new ArrayList<String>();
                     l1=arrayList.get(k);

                     for(int j=0;j<l1.size();j++)
                     {

                        String sss1=l1.get(j);
                        if(sss1.length()<2)
                        {
                            l111.add(" ");
                        //  System.out.println("Values in empty"+sss1);
                        }
                        else
                        {
                            char c1=sss1.charAt(0);
                            if(c1==',' )
                            {
                                sss1=sss1.substring(1);
                            }
                            c1=sss1.charAt(sss1.length()-1);
                            if(c1==',' )
                            {
                                sss1=sss1.substring(0,sss1.lastIndexOf(","));
                            }   
                            l111.add(sss1);
                            //System.out.println("Values in "+sss1);                
                        }
                     }
                     updatedList.add(l111);
                 }
                 System.out.println("updated list"+updatedList);
             ArrayList<String> tblList=new ArrayList<String>();
             for(int i=0;i<updatedList.size();i++)
             {
             List<String> oneList=updatedList.get(i);
             String x1=oneList.get(0);
             String x2=oneList.get(1);
             String x3=oneList.get(2);
             String x4=oneList.get(3);
             String x5=oneList.get(4);
             String x6=oneList.get(5);
             String x7=oneList.get(6);
             String x8=oneList.get(7);
             String x9=oneList.get(8);
             String x10=oneList.get(9);
           //  String x11=oneList.get(10);
                 Hashtable<String, String> hm = new Hashtable<String, String>();

                hm.put("Sno", x1);
                hm.put("MosquesNames", x2);
                hm.put("MosqueAddress", x3);
                hm.put("MosqueCity", x4);
                hm.put("Mosquestate", x5);
                hm.put("Mosquezip", x6);
                hm.put("Mosquecountry", x7);
                hm.put("Mosquephn1", x8);
                hm.put("Mosquephn2", x9);
                hm.put("Mosquephn3", x10);
                //hm.put("Mosquephn3", x10);
             //     hm.put("icon", R.drawable.images);
                HashMap<String, Object> map1 = new HashMap<String, Object>();
                map1.put("Sno", x1);
                map1.put("MosquesNames", x2);
                map1.put("MosqueAddress", x3);
                map1.put("MosqueCity", x4);
                map1.put("Mosquestate", x5);
                map1.put("Mosquezip", x6);
                map1.put("Mosquecountry", x7);
                map1.put("Mosquephn1", x8);
                map1.put("Mosquephn2", x9);
            map1.put("Mosquephn3", x10);
                map1.put("icon", R.drawable.images);
                myList1.add(map1);
              //    list1.add(hm) ;

              //    add=hm.get("MosquesNames")+"  "+hm.get("MosqueAddress")+" "+hm.get("MosqueCity");
             //tblList.add(add);

             }

                    System.out.println("new:"+myList1);
             }

             catch (IOException ex) {
                 // handle exception
             }
             finally {
                 try {
                     is.close();
                 }
                 catch (IOException e) {
                     // handle exception
                 }
             }

    }
    /**
     * This method is used, to fill data into our List
     */

    private void addDataToList(){
        HashMap<String, Object> map1 = new HashMap<String, Object>();
        map1.put("icon", R.drawable.images);
        map1.put("name", "Al-Masjidul Al-Kaa'Bah");
        map1.put("address", "691 Idlewild Circle - Suite H");
        map1.put("city", "Birmingham, Alabama");

        HashMap<String, Object> map2 = new HashMap<String, Object>();
        map2.put("icon",R.drawable.images);
        map2.put("name", "Al-Masjidul Al-Kaa'Bah ");
        map2.put("address", "691 Idlewild Circle - Suite H");
        map2.put("city", "Birmingham, Alabama");

        HashMap<String, Object> map3 = new HashMap<String, Object>();
        map3.put("icon", R.drawable.images);
        map3.put("name", "Birmingham Islamic Society");
        map3.put("address", "  ");
        map3.put("city", "Birmingham, Alabama");

        HashMap<String, Object> map4 = new HashMap<String, Object>();
        map4.put("icon", R.drawable.images);
        map4.put("name", "Birmingham Mosque");
        map4.put("address","1534 19th Street");
        map4.put("city", "Birmingham, Alabama");

        HashMap<String, Object> map5 = new HashMap<String, Object>();
        map5.put("icon", R.drawable.images);
        map5.put("name", "Masjid Al-Quran");
        map5.put("address", " ");
        map5.put("city", "Birmingham, Alabama");

        myList.add(map1);
        myList.add(map2);
        myList.add(map3);
        myList.add(map4);
        myList.add(map5);
    }
} 
```

# iphone - 在iphone中生成随机数

> ID：12277954
> 
> 赞同：0
> 
> 时间：2012-09-05T09:06:40.927
> 
> 标签：iphone

嗨，在我的一个应用程序中，我必须分配不同的不同部分，并且在每个部分中我都有几个图像视图。我必须在任何图像视图上启动一个弹出框，因为我需要该图像标签值。我必须区分这些图像标记值，因为我使用了一个名为 count 的变量，它将从零开始。它将根据部分的数量增加，并将标签值分配给图像视图

```
NSString *imageTagStr = [[NSString alloc]initWithFormat:@"%d%d",count,j-1];
image1.tag = [imageTagStr intvalue]; 
```

在此我将标记值分配给图像视图，并且所有这些图像视图都是使用 for 循环以编程方式创建的。

接下来的事情是我必须长按任何部分中可用的任何图像，弹出窗口必须出现，一旦弹出窗口启动，我必须选择弹出窗口上可用的按钮，然后会出现另一个视图。

在该视图中，我将加载从数组中获取的数据。这里基于 imagetag 值意味着 substringfromindex:1 通过使用这个我得到数组中可用的数据。

现在的问题是，如果部分的数量超过 9，那么 count 将变为 10，所以如果我使用 substringfromindex 意味着我得到了（就像这个标签值中的 121 是 1 并且 count 是 12 所以如果我从可用的数组中获取对象in 21 意味着我得到了错误的数据，所以我必须解决这个问题。）

所以为了解决这个问题，我觉得生成随机的两位数字很好，我必须添加图像标签值的信息。然后总是这将是两位数，但我不知道如何生成不重复的两位数。如果有人有任何想法，请与我分享。

如果有任何示例代码，请与我分享。多谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T09:14:20.177

```
int intRanIndex = arc4random() % 100; 
```

注意：-它将返回一个随机编号。在 0 到 99 之间......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T09:22:47.583

这里不需要随机数。放

```
image1.tag = 256 * count + j; 
```

然后你可以恢复`count`并`j`使用

```
count = image1.tag / 256;
j = image1.tag % 256; 
```

这适用于`j < 256`. 如果您需要更大的值`j`，请将 256 替换为更大的因子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T09:16:34.117

```
int min=1;
int max=16;

int randNum = rand() % (max - min) + min;
NSLog(@"random number %i",randNum); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T10:43:19.727

```
int randomIndex = rand() % 10;
NSInteger unrepeated=2147483647;

NSLog(@"randomIndex :- %d",randomIndex);
NSLog(@"arrRandomValue indexOfObject:randomIndex :- %d",[arrRandomValue indexOfObject:[NSString stringWithFormat:@"%d",randomIndex]]);

if ([arrRandomValue indexOfObject:[NSString stringWithFormat:@"%d",randomIndex]]==2147483647)
{
    [arrRandomValue addObject:[NSString stringWithFormat:@"%d",randomIndex]];
    unrepeated=randomIndex;
    NSLog(@"unrepeated random no :- %d",unrepeated);
} 
```

注意：- 不重复的 var。将包含 2147483647 或不重复的 0 到 9 随机值

或者

```
int randomIndex = rand() % 10;
NSInteger unRepeted=2147483647;

NSLog(@"randomIndex :- %d",randomIndex);
NSLog(@"arrRandomValue indexOfObject:randomIndex :- %d",[arrRandomValue indexOfObject:[NSNumber numberWithInt:randomIndex]]);

if ([arrRandomValue indexOfObject:[NSNumber numberWithInt:randomIndex]]==2147483647)
{
    [arrRandomValue addObject:[NSNumber numberWithInt:randomIndex]];
    unRepeted=randomIndex;
    NSLog(@"un repeted random no :- %d",unRepeted);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-05T09:17:03.763

为什么不加 10 来计数呢？

```
NSString *imageTagStr = [[NSString alloc]initWithFormat:@"%d%d", 10+count , j-1];
image1.tag = [imageTagStr intvalue]; 
```

如果你不想这样做，我建议你看看这个答案：[非重复随机数](https://stackoverflow.com/questions/1617630/non-repeating-random-numbers)

# android - 使用键盘绘图

> ID：12277956
> 
> 赞同：0
> 
> 时间：2012-09-05T09:06:44.897
> 
> 标签：android, android-resources

我正在研究一个看起来像数字键盘的布局。

我在我的文件夹里四处寻找：

> C:\Program Files\Android\platforms\android-8\data\res\drawable-mdpi

我发现了一些我可以使用的可绘制对象，例如 sym_keyboard_feedback_ok 或 sym_keyboard_num(1-9) :)

![在此处输入图像描述](../Images/36eef7bd921de421a434185c06b351e9.png)

但是当我输入

> android.R.drawable。

没有以 sym_keyboard.. 开头的可绘制对象。

如何在不手动将它们复制到我的资源文件夹的情况下访问这些可绘制对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:53:21.440

好吧，我一直在寻找同样的东西，但后来我意识到所有 R.drawables 都无法访问。如果您查看[android.R.drawable](http://developer.android.com/reference/android/R.drawable.html)参考，您将找不到您正在寻找的那些项目。此[示例](http://mgmblog.com/2008/12/12/listing-androids-drawable-resources/)还在列表中显示了所有可访问的可绘制对象，这可能很有用。

在给定的示例中，有一个 for 循环，如果您以下列方式更改循环的间隔，您可能会找到这些项目（在我的例子中，我看到以 sym_keyboard 开头的可绘制对象）：

```
for (int idx = 17301504; idx <= 17303380; idx++) {
        data = new HashMap<String, Object>();
        try {
            String stg = Resources.getSystem().getResourceName(idx);
            data.put("line1", stg);
            data.put("line2", idx);
            data.put("img", idx);
            resourceNames.add(data);
        }
        catch (Resources.NotFoundException nfe) {
        }
    } 
```

最后，不建议使用这种方法，因为不同 API 中的 drawable 引用可能不同，所以我被迫将我最喜欢的 drawable 复制到项目中并将它们用作常规 drawable。

![带有 ics 4.0 的 HTC Sensation 上的 Drawable](../Images/021cb1a404188ce487cf0967ca9205e2.png)

# sharepoint - U2U caml 查询只带回 30 行

> ID：12277957
> 
> 赞同：0
> 
> 时间：2012-09-05T09:06:54.537
> 
> 标签：sharepoint, caml

我目前正在尝试使用 U2U caml 查询生成器来搜索共享点列表，尽管有 400 条记录，但无论我使用什么过滤器，结果都只带回 30 行，即使应该还有更多。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T12:55:02.680

您如何构建和运行查询？30 是默认列表视图中的标准项目限制，因此可能与此有关。

# grid - 未在 extjs Grid 中显示行

> ID：12277958
> 
> 赞同：1
> 
> 时间：2012-09-05T09:06:55.773
> 
> 标签：grid, extjs

我目前有一个填充网格。但是我所有的数据都在我的体外，使用 rowbody 功能。这使我的实际行无用且烦人。它在我的多余身体顶部留下了我不想要的白色行。

有人知道如何不显示这个吗？

我在css中试过了，我试过不定义列，但网格是空的。

我试过这个：

```
columns: [

{
    text: 'Name',
    //dataIndex: 'name',
    height: 1,
    width: 250,
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T10:20:45.613

您描述用例的方式我猜[DataView](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.view.View)会更好地满足您的要求。我想您可以将几乎整个代码（Iam 表示配置和模板）转移到其中，而无需编写太多新行（只要您使用模板来渲染额外主体）。

那么，您选择网格还有其他原因吗？

# c# - 即使使用 ToString()，我的搜索方法也不适用于数字

> ID：12277966
> 
> 赞同：0
> 
> 时间：2012-09-05T09:07:26.923
> 
> 标签：c#, asp.net-mvc-3, ado.net, search-form

如您所见，我有一种从表中检索字段的方法。在我看来，我在两个文本框中进行搜索。

**ClientID**是一个*字符串*，所以没问题。但是**OrderId**是一个*Int*，所以我使用 ToString() 但它仍然不起作用。

我为 OrderId 编写第二个 IF 条件的方式错了吗？谢谢你的帮助

```
public ActionResult Search(string searchString, string searchOrder)
{  
    var user = from m in db.Order   
               select m;

    if (!String.IsNullOrEmpty(searchString))
    {
        user = user.Where(s => s.Order.ClientID.Contains(searchString));
    }         

    if (!String.IsNullOrEmpty(searchOrder))
    {
        user = user.Where(c => c.Order.OrderId.ToString().Contains(searchOrder));
    }

    return this.View("Order", "PrintView", user);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T09:12:47.673

听起来您应该解析`searchOrder`为整数，然后使用：

```
user = user.Where(c => c.Order.OrderId == targetOrderId); 
```

除了别的，你*真的*想要一个`searchOrder`“15”来匹配订单 2150 吗？这听起来不太可能有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T10:38:47.323

要使用数字搜索，请将相关方法更改为以下内容：

```
 public ActionResult PrintOrders(string searchString, int searchOrder = 0)
    {
        var user = from m in db.OrderDetails   
                   select m;

        if (!String.IsNullOrEmpty(searchString))
        {
            user = user.Where(s => s.Order.ClientID.Contains(searchString));               
        }

        if (searchOrder > 0)
        {
            user = user.Where(c => c.Order.OrderId == searchOrder);               
        }

        return this.ViewPdf("Order", "PrintView", user);
    } 
```

另一种方法是：

```
 public ActionResult PrintOrders(string searchString, string searchOrder)
    { 
        var user = from m in db.OrderDetails   
                   select m;

        if (!String.IsNullOrEmpty(searchString))
        {
            user = user.Where(s => s.Order.ClientID.Contains(searchString));               
        }

        int tmp = Int32.Parse(searchOrder);

        if (tmp != 0)
        {
            user = user.Where(c => c.Order.OrderId == tmp);
        }

        return this.ViewPdf("Order", "PrintView", user);
    } 
```

视图看起来像这样：

```
@using (Html.BeginForm("PrintOrders", "Historic", FormMethod.Get, new { target = "_blank" }))
{

   Search by Client ID : @Html.TextBox("searchString")

   Search by Order ID : @Html.TextBox("searchOrder")

  <input type="submit" value="Search" />
} 
```

# c# - 何时在 C# 中使用类？

> ID：12277968
> 
> 赞同：5
> 
> 时间：2012-09-05T09:07:32.247
> 
> 标签：c#, class

我对 C# 语言比较陌生，但是在 Google 搜索和 Stack Overflow 的帮助下，我已经完成了许多应用程序，其中包括使用 Office、系统服务、进程、WMI、SQL、Linq 和 Active Directory。 ..

尽管在使这些应用程序正常运行方面取得了成功，但我仍然不确定 C# 语言中的许多事情，例如良好的代码实践和使用许多关键字等。

C#类；我知道我可以用它们做什么，我知道构造函数和析构函数、实例化和属性，但我不确定*什么时候*应该使用它们。到目前为止，我已经在不同方法中的 Form1.cs 文件中编写*了所有*代码。这些方法使用完全不同的 API 做一系列不同的事情。这显然意味着尝试维护该代码可能会变得相当困难，而且我发现在我的 Form1.cs中*找到任何东西越来越令人沮丧。*

我对你们的问题是我应该将我的代码分成不同的类吗？我试图将与 SqlConnection 和 SqlCommands 相关的内容拆分到一个单独的类中，但没有在我的 Form1.cs 中多次实例化同一个类，我看不出这更容易或有任何好处。

我一直在尝试拼凑一个新的应用程序，但这次将功能保留在它自己的类中，我希望有人可以告诉我我很愚蠢并且做错了，或者至少给我一些指导。

这个应用程序最终将从 App.Config 加载我的连接字符串，连接到 SQL 数据库并使用数据库中的多个表填充 DataSet。这绝不是功能性的，因为我无法理解整个 Classes 问题。

```
partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    string myConnectionString;

    private void Form1_Load(object sender, System.EventArgs e)
    {
        AppConfig cfg = new AppConfig();
        if (cfg.loadConfig())
        {
            myConnectionString = cfg.myConnectionString();
        }

        if (!String.IsNullOrEmpty(myConnectionString))
        {
            SQLConn SQL = new SQLConn();
            if (SQL.createConnection(myConnectionString))
            {
                MessageBox.Show("Connected!");
            }
        }
    }
}

class myDataSet
{
    DataSet DataSet()
    {
        DataSet ds = new DataSet();

        SQLConn sql = new SQLConn();

        return ds;
    }

    public void fillData()
    {
        try
        {
            SqlCommand sqlCmd = new SqlCommand("SELECT * FROM hardware");                
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
    }
}

class SQLConn : IDisposable
{
    SqlConnection sqlConn;
    public bool createConnection(string myConnectionString)
    {
        sqlConn = new SqlConnection();
        sqlConn.ConnectionString = myConnectionString;
        try
        {
            sqlConn.Open();
            return true;
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
        return false;
    }

    public void Dispose()
    {
        if (sqlConn.State == ConnectionState.Open)
        {
            sqlConn.Close();
            sqlConn.Dispose();
        }
    }
}

class AppConfig
{
    Configuration cfg;

    public bool loadConfig()
    {
        try
        {
            cfg = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
            if (!File.Exists(cfg.FilePath))
            {
                MessageBox.Show("No configuration file");
            }
            return true;
        }
        catch(Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
        return false;
    }

    public string myConnectionString()
    {
        string connectionString = ConfigurationManager.ConnectionStrings["IT_ProjectConnectionString"].ConnectionString;
        return connectionString;
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-05T09:32:18.033

OOP 背后的原则或多或少说，您应该尽可能多地拆分内容，以便将相关的内容组合在自己的类中，就像您示例中的 SQL 内容一样。另一个经常使用的例子是汽车——如果你需要处理汽车的数据，你可以创建一个包含相关变量的汽车类，如最高速度、名称、颜色和适当的方法，例如`drive(double distance)`或类似的东西。

如果您不想要该类的不同对象并且在多个点需要相同的行为，您可以通过多种方式防止多个实例：如果所有点都在您的 中`Form1`，您只需将您的类作为类成员实例化一次，然后您可以在`Form1`全班使用。如果您需要从不同的类访问它，您可以拥有一个全局变量（大多数人认为这是不好的做法）或创建您需要访问的类`static`- 这样，您根本不需要实例化它。

如果您的应用程序非常小，您可能会将其全部放在`Form1`课堂上，但正如您自己注意到的那样，它很快就会变得混乱和混乱。将类视为对代码进行排序的机会。想想什么与什么相关联，以及你期望一起找到什么，然后把这些东西放在课堂上。如果你坚持这一点，你最终得到的代码不会那么令人沮丧，并且具有清晰和合乎逻辑的结构。一旦事情变得更复杂，您就可以利用继承之类的东西，并且您可以重用执行不同应用程序中可能需要的事情（再次，例如数据库）的类。

这是一个非常简短且非常粗略的描述。我自己不知道任何关于该主题的好书（除了那些面向完全编程初学者的书籍，这在这里似乎不合适），但我建议在 OOP 上找到一本或搜索关于该主题的好的介绍文章。就个人而言，我发现 CodeProject 是一个很好的文章来源。[这是关于 OOP 的一个](http://www.codeproject.com/Articles/22769/Introduction-to-Object-Oriented-Programming-Concep)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-05T09:13:34.117

我使用单一职责原则作为设计类的指南。这是一个很好的[讨论](http://msdn.microsoft.com/en-us/magazine/cc546578.aspx#id0390008)，重点是：

> 关键是每个类都应该实现一组有凝聚力的相关功能。遵循单一职责原则的一个简单方法是不断问自己一个类的每个方法和操作是否与该类的名称直接相关。如果您发现某些方法与类名不符，则应考虑将这些方法移至另一个类。

考虑到这一点，我认为您将示例应用程序的功能拆分为单独的类是正确的。否则，您最终会得到一个具有多种职责的综合 Form1 类：读取配置值、连接到数据库、读取数据。正如您所观察到的，将代码拆分为单独的类也使程序更易于理解和导航。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T09:24:01.870

想想你的类封装了某种功能。在您的情况下，SQLConn 正在处理与数据库的连接，这意味着此类*拥有*数据库连接，并且所有流量现在都应该通过此类。这也意味着您的 myDataSet 类应该使用您的 SQLConn 类进行所有通信，因此在其中实例化 SqlCommand是*错误的。*

我认为您可能会将实例与实现中的类混淆。您正在创建 SQLConn 类的多个*实例*，首先是在连接到数据库的 OnLoad 方法上，然后在 myDataSet 类中创建。这*与*类的实例*不同。*因此，您的 myDataSet 类将使用尚未连接到数据库的 SQLConn。

您可以通过为 myDataSet 类提供您希望它工作的 SQLConn*实例来共享同一个实例：*

```
public myDataSet(SQLConn conn) 
{ 
    SQLConn sql = conn;
} 

{
    SQLConn conn = new SQLConn();
    conn.createConnection(...);
    myDataSet ds = new myDataSet(conn);
} 
```

这仍然不是一个好的设计，但它说明了如何传递*实例*与直接引用类。

# ruby-on-rails - 使用 send_file 从 Amazon S3 下载文件？

> ID：12277971
> 
> 赞同：64
> 
> 时间：2012-09-05T09:07:35.950
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, amazon-s3, ruby-on-rails-3.2

我的应用程序中有一个下载链接，用户应该可以从中下载存储在 s3 上的文件。这些文件将在看起来像这样的 url 上公开访问

```
https://s3.amazonaws.com/:bucket_name/:path/:to/:file.png 
```

下载链接在我的控制器中触发了一个动作：

```
class AttachmentsController < ApplicationController
  def show
    @attachment = Attachment.find(params[:id])
    send_file(@attachment.file.url, disposition: 'attachment')
  end
end 
```

但是当我尝试下载文件时出现以下错误：

```
ActionController::MissingFile in AttachmentsController#show

Cannot read file https://s3.amazonaws.com/:bucket_name/:path/:to/:file.png
Rails.root: /Users/user/dev/rails/print

Application Trace | Framework Trace | Full Trace
app/controllers/attachments_controller.rb:9:in `show' 
```

该文件肯定存在并且可以通过错误消息中的 url 公开访问。

如何允许用户下载 S3 文件？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2013-02-22T15:59:03.567

您也可以使用[`send_data`](http://api.rubyonrails.org/classes/ActionController/DataStreaming.html#method-i-send_data).

我喜欢这个选项，因为你有更好的控制。您没有将用户发送到 s3，这可能会让某些用户感到困惑。

我只想添加一个下载方法到`AttachmentsController`

```
def download
  data = open("https://s3.amazonaws.com/PATTH TO YOUR FILE") 
  send_data data.read, filename: "NAME YOU WANT.pdf", type: "application/pdf", disposition: 'inline', stream: 'true', buffer_size: '4096' 
end 
```

并添加路线

```
get "attachments/download" 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2014-04-18T19:58:38.233

## 为用户保持简单

我认为处理此问题的最佳方法是使用即将到期的 S3 url。其他方法存在以下问题：

*   文件首先下载到服务器，然后再下载到用户。
*   使用`send_data`不会产生预期的“浏览器下载”。
*   绑定 Ruby 进程。
*   需要额外的`download`控制器操作。

我的实现如下所示：

### 在你的`attachment.rb`

```
def download_url
  S3 = AWS::S3.new.buckets[ 'bucket_name' ] # This can be done elsewhere as well,
                                            # e.g config/environments/development.rb
  url_options = { 
    expires_in:                   60.minutes, 
    use_ssl:                      true, 
    response_content_disposition: "attachment; filename=\"#{attachment_file_name}\""
  }

  S3.objects[ self.path ].url_for( :read, url_options ).to_s
end 
```

### 在你看来

```
<%= link_to 'Download Avicii by Avicii', attachment.download_url %> 
```

而已。

* * *

`download`如果您出于某种原因仍想保留您的操作，请使用以下命令：

**在你的`attachments_controller.rb`**

```
def download
  redirect_to @attachment.download_url
end 
```

*感[谢吉列瓦](https://stackoverflow.com/a/16426114/293280)的指导。*

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2012-09-05T09:09:39.810

为了从您的网络服务器发送文件，

*   您需要从 S3 下载它（请参阅[@nzajt 的答案](https://stackoverflow.com/a/15028162/980524)）或

*   你可以`redirect_to @attachment.file.expiring_url(10)`

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-01-12T03:44:12.680

我刚刚将我的`public/system`文件夹迁移到 Amazon S3。上述解决方案有帮助，但我的应用程序接受不同类型的文档。因此，如果您需要相同的行为，这对我有帮助：

```
@document = DriveDocument.where(id: params[:id])
if @document.present?
  @document.track_downloads(current_user) if current_user
  data = open(@document.attachment.expiring_url)
  send_data data.read, filename: @document.attachment_file_name, type: @document.attachment_content_type, disposition: 'attachment'
end 
```

该文件正在保存在对象`attachment`字段中`DriveDocument`。我希望这有帮助。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-03-04T20:10:57.553

以下是最终对我有用的东西。从 S3 对象获取原始数据，然后将`send_data`其传递给浏览器。

使用`aws-sdk`此处的 gem 文档[http://docs.aws.amazon.com/AWSRubySDK/latest/AWS/S3/S3Object.html](http://docs.aws.amazon.com/AWSRubySDK/latest/AWS/S3/S3Object.html)

**全控制器方法**

```
def download
  AWS.config({
    access_key_id: "SECRET_KEY",
    secret_access_key: "SECRET_ACCESS_KEY"
  })

  send_data( 
    AWS::S3.new.buckets["S3_BUCKET"].objects["FILENAME"].read, {
      filename: "NAME_YOUR_FILE.pdf", 
      type: "application/pdf", 
      disposition: 'attachment', 
      stream: 'true', 
      buffer_size: '4096'
    }
  )
end 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-30T04:18:13.303

> 如何允许用户下载 S3 文件？

如果您能够**在将文件上传到 S3 之前在文件上设置一些元数据，**而不是在用户稍后想要下载它时尝试修补它，那么这个解决方案会简单得多：

[https://stackoverflow.com/a/24297799/763231](https://stackoverflow.com/a/24297799/763231)

> 如果您正在使用，`fog`那么您可以执行以下操作：
> 
> ```
> has_attached_file :report,
>   fog_file: lambda { |attachment|
>     {
>       content_type: 'text/csv',
>       content_disposition: "attachment; filename=#{attachment.original_filename}",
>     }
>   } 
> ```
> 
> 如果您使用 Amazon S3 作为您的存储提供程序，那么这样的事情应该可以工作：
> 
> ```
> has_attached_file :report
>   s3_headers: lambda { |attachment|
>     { 
>       'Content-Type' => 'text/csv',
>       'Content-Disposition' => "attachment; filename=#{attachment.original_filename}",
>     }
>   } 
> ```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2020-06-12T11:36:11.710

def download_pdf @post= @post.avatar.service_url

```
send_data(

    "#{Rails.root}/public/#{@post}",
    filename: "#{@post}",
    type: "image/*",
    disposition: 'inline', stream: 'true', buffer_size: '4096'
) 
```

结尾

# php - CodeIgniter 中的 textform 不采用 & 符号

> ID：12277973
> 
> 赞同：0
> 
> 时间：2012-09-05T09:07:43.593
> 
> 标签：php, mysql, codeigniter-2

目前我正在使用 CodeIgniter 进行库存项目。在 vendorlist 表单中，我有以下文本字段：姓名地址联系人和电话。

这适用于除 & （与号）符号以外的所有其他文本。当我在其后插入 & 符号和其他文本时，它根本不起作用。

在 vendorlist.php 文件中，我使用以下代码：

```
<form onsubmit="return false" id="frmvendor">
            <dl>
                <dt><label><?php echo $this->lang->line('name');?></label></dt>
                <dd><input type="text" name="vendorname" id="vendorname" value="" class="validate[required] text-input" /></dd>
            </dl>
            <dl>
                <dt><label><?php echo $this->lang->line('address');?></label></dt>
                <dd><textarea name="address" id="address" cols="22" class="validate[required] text-input"></textarea></dd>
            </dl>
            <dl>
                <dt><label><?php echo $this->lang->line('phone');?></label></dt>
                <dd><input type="text" name="phone" id="phone" value="" size="60" class="validate[required] text-input" /></dd>
            </dl>
            <dl>
                <dt><label><?php echo $this->lang->line('contactperson')?></label></dt>
                <dd><input type="text" name="contactperson" id="contactperson" value="" /></dd>
            </dl>
            <dl>
                <dt><label><?php echo $this->lang->line('active');?></label></dt>
                <dd>
                <?php echo $this->lang->line('yes');?><input type="radio" name="vendor_locked" checked="checked" value="0" id="vendor_locked" />
                <?php echo $this->lang->line('no');?><input type="radio" name="vendor_locked" value="1" id="vendor_unlocked" />
                </dd>
            </dl>
            <dl>
                <dt></dt>
                <dd><input type="submit" name="save" value="Save" /><input type="button" name="cancel" value="Cancel" onclick="resetForm('frmvendor')" /></dd>
            </dl>

            <input type="hidden" id="vendorid" name="vendor" value="" />
        </form> 
```

它如何适用于 & 符号？帮帮我，伙计们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T05:14:45.457

我得到了自己问题的解决方案。问题是 & 符号被认为是变量。所以，我在控制器上创建了一个函数，在视图文件上创建了一个函数。

在 Controller 文件中，我创建了以下函数并将 str_replace 用作：

```
function savevendor()
{
        //print_r ($_POST);
        //die();

    $this->redir->set_last_index();
    $vendor_id  =   $this->input->post('id');

    $refinevendor = str_replace("#_#","&",$this->input->post('vendor'));
    $refineaddress = str_replace("#_#","&",$this->input->post('address'));
    $refinecontactperson= str_replace("#_#","&",$this->input->post('contactperson'));

    $vendordata =   array(
                          'vendor'          =>$refinevendor,
                          'address'         =>$refineaddress,
                          'contact_person'  =>$refinecontactperson,
                          'user_id'         =>$this->session->userdata('user_id'),
                          'phone'           =>$this->input->post('phone'),
                          'upd_date'        =>date('Y-m-d'),
                          'locked'          =>$this->input->post('locked')
                          );

    if((int)$vendor_id==0){
        $arr= array_merge($vendordata,array("ent_date"=>date("Y-m-d")));
        $this->mdl_vendor->save($arr);
        echo $this->lang->line('vendor_has_been_created');
    }else{
        $this->mdl_vendor->save($vendordata,$vendor_id);
        echo $this->lang->line('this_vendor_has_been_saved');
    }
} 
```

在视图文件中，我创建了以下函数并将 .replace 用作：

函数保存供应商（）{

```
showloading();

var id = $('#vendorid').val();
var vendor = $('#vendorname').val();
var refinevendor = vendor.replace("&","\#_#");

var address = $('#address').val();
var refineaddress = address.replace("&","\#_#");

var phone = $('#phone').val();
var contactperson = $('#contactperson').val();
var refinecontactperson = contactperson.replace("&","\#_#");

var locked  =   $('input:radio[name=vendor_locked]:checked').val();
var params = 'id='+id+'&vendor='+refinevendor+'&address='+refineaddress+'&phone='+phone+'&contactperson='+refinecontactperson+'&locked='+locked+'&unq='+ajaxunq;

$.ajax({
       type     :   'POST',
       url      :   'purchase/savevendor',
       data     :   params,
       success  :   function(data){
                   showVendorTable();
                   resetForm('frmvendor');
                   hideloading(data);
               }
       }) //end of ajax 
```

}

它奏效了。我实际上做的事情是首先我用符号替换了 & 符号`#_#`，然后最后我`#_#`用 & 替换了符号。

# php - PHP流下载网站内容，直到找到字符串

> ID：12277982
> 
> 赞同：0
> 
> 时间：2012-09-05T09:08:03.473
> 
> 标签：php, sockets, web, stream, download

对象说明了一切。我需要启动一个网站流并在找到例如时停止它`</head>`。我想这样做是为了保留两端的带宽并节省脚本运行时间。

我不想将整个页面内容下载到内存中；我需要在 PHP 中以块形式出现的内容流。

*谢谢社区，我爱你们：）*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:08:03.473

```
<?php

function streamUntilStringFound($url, $string, $timeout = 30){

    // remove the protocol - prevent the errors
    $url = parse_url($url);
    unset($url['scheme']);
    $url = implode("", $url);

    // start the stream
    $fp = @fsockopen($url, 80, $errno, $errstr, $timeout);
    if (!$fp) {
        $buffer = "Invalid URL!"; // use $errstr to show the exact error
    } else {
        $out  = "GET / HTTP/1.1\r\n";
        $out .= "Host: $url\r\n";
        $out .= "Connection: Close\r\n\r\n";
        fwrite($fp, $out);
        $buffer = "";
        while (!feof($fp)) {
            $buffer .= fgets($fp, 128);
            // string found - stop downloading any new content
            if (strpos(strtolower($buffer), $string) !== false) break;
        }
        fclose($fp);
    }

    return $buffer;

}

// download all content until closing </head> is found
$content = streamUntilStringFound("whoapi.com", "</head>");

// show us what is found
echo "<pre>".htmlspecialchars($content);

?> 
```

**重要提示：（** *感谢@GordonM）*

`allow_url_fopen`需要启用`php.ini`才能使用`fsockopen()`。

# redirect - web2py 登录后重定向

> ID：12277984
> 
> 赞同：0
> 
> 时间：2012-09-05T09:08:09.387
> 
> 标签：redirect, login, web2py

我的 web2py 应用程序有一个有效的登录表单。

我不知道我改变了什么，但是在执行登录后，应用程序返回给我无效的函数默认/用户信息。

我正在使用 auth.settings.controller="user" 被重定向到正确的控制器。现在它不起作用。

应用程序应该返回到它来自的页面。仅限登录用户

解决这个问题后，我正在为自己安装一个 SVN，但在那之前。我真的不知道该怎么办

我正在使用 auth.navbar()

我的身份验证是 {{='auth' in globals() 和 auth.navbar(separators=(' ',' | ',''))}}

我的用户控制器 user.py 是

def user(): form = auth() return dict(form=form)

我的 user.py 模型是

if (request.controller=='user' or request.controller=='school' or request.controller=='timetable' and request.cookies.has_key('mycookie')): response.generic_patterns = ['*'] if request.is_local else [] database = request.cookies['mycookie'].value baza = DAL('postgres://postgres:postgres@localhost/' + database, migrate=True) from gluon.tools import Mail auth =授权（市场）

```
auth.settings.logout_next=URL('school','index?school=' + database)

auth.settings.registration_requires_approval = True
#auth.settings.reset_password_requires_verification = True
#auth.settings.login_after_registration = False
auth.settings.register_onaccept=lambda form: mail.send(to=['vid.ogris@algit.si'],
      subject='web2py registration',
      # If reply_to is omitted, then mail.settings.sender is used
      reply_to='us@example.com',
      message='Kreiral se je nov uporabnik, ki ga je potrebno potrditi') 

auth.settings.expiration = 3600
auth.define_tables()

mail=Mail()
auth.settings.mailer=mail
mail.settings.server='smtp.gmail.com:587'
mail.settings.sender='xxx@gmail.com'
mail.settings.login='xxx@gmail.com:xxx'

#auth.settings.registration_requires_verification = True

auth.messages.registration_pending = u'Registracija je v postopku odobritve. Ko bo vaš račun potrjen boste prejeli e-mail.'
auth.messages.invalid_login = 'Nepravilno geslo'
auth.messages.invalid_user = 'Uporabnik ne obstaja'

auth.settings.controller="user"

## if you need to use OpenID, Facebook, MySpace, Twitter, Linkedin, etc.
## register with janrain.com, write your domain:api_key in private/janrain.key
from gluon.contrib.login_methods.rpx_account import use_janrain
use_janrain(auth,filename='private/janrain.key') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T11:28:25.633

改变`auth.settings.controller`不起作用（这本书需要更新）。相反，您必须这样做：

```
auth = Auth(baza, controller='user') 
```

此外，而不是：

```
URL('school','index?school=' + database) 
```

你应该做：

```
URL('school','index', vars=dict(schools=database)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T07:26:51.513

Sometimes comments in html are not only comments :) I removed a line containing auth.register(), even though I though it was commented, and now it works

# java - 使用静态初始化块来提高性能

> ID：12277991
> 
> 赞同：0
> 
> 时间：2012-09-05T09:08:27.480
> 
> 标签：java, performance, static-initialization

假设生产中使用的现有代码库包含一个类 A，该类 A 包含一个方法，该方法使用 setter 填充另一个 POJO 类 B 的 N 个字段并将 POJO 返回给调用者，并且假设类 B 的所有实例将仅在以下方面有所不同两个字段，即 N - 2 个字段在 B 类的所有实例中都是相同的，如果 A 类具有对 B 类的静态引用并初始化 B 类的字段在静态中不变初始化块？这样，在每次调用时填充类 B 的 N 个字段的类 A 中的方法现在只需填充两个不同的字段。这也将消除为每次调用类 A 中的方法创建一个类型 B 的新对象的需要。这种方法在多线程应用程序中的含义是什么？

或者，我们可以将 B 类中所有不会更改的字段声明为静态，以便 A 类中的方法仅设置每次调用更改的字段。无论哪种方式，性能提升是否值得，或者这种变化是否符合过早的优化？

**例子 ：**

```
class A { 
     private static B b = new B(); 

     static {
         b.setSystem("MySystem");
         b.setVersion("1.1");
     }

     public B getB(String name) {
         b.setName(name);
         return B;

     }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T09:15:30.577

> 鉴于 B 类的所有实例仅在两个字段方面都不同

所以我知道你有不止一个 B 实例

> 这也将消除为每次调用类 A 中的方法创建一个类型 B 的新对象的需要。

但是现在您只有一个 B 实例 - 如果 A 更改了这两个字段，则代码中所有引用该 B 实例的位置都会看到更改（假设正确同步）。

=> 不清楚您是否需要一个或多个 B 实例。

> 这种方法在多线程应用程序中的含义是什么？

如果跨线程共享同一个 B 实例，则需要确保在写入和读取 B 的属性时使用正确的同步。

> 或者，我们可以将类 B 中所有不会更改的字段声明为静态

你的意思是决赛？

> 无论哪种方式，性能提升是否值得，或者这种变化是否符合过早的优化？

它认为它确实符合条件。特别是因为你似乎还不能 100% 确定你需要什么。所以和往常一样的建议：走简单的路。**如果**性能不够好，分析并确定代码的哪些部分需要改进。

如果您知道您将处于多线程环境中，您可能应该避免任何静态和可变的 - 这将使您的生活更轻松并限制并发错误的风险。

理想情况下，（1）尽量不要跨线程共享对象——如果你不能，那么（2）尝试共享不可变对象——如果你不能（3）确保你使用正确的同步并且你知道你在做什么是做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T09:21:41.800

> 给定一个包含方法的类 A，该方法使用 setter 填充另一个 POJO 类 B 的 N 个字段

所以 A 有 B 的实例或 B 的实例列表？

> 并将 POJO 返回给调用者，并假设 B 类的所有实例仅在两个字段方面是不同的，即 N - 2 个字段在 B 类的所有实例中都是相同的，

为什么不直接`N-2`在 B 本身初始化 Fields。

> 如果 A 类具有对 B 类的静态引用并初始化 B 类的在静态 init 块中不变的字段，是否会有任何性能提升？这样，在每次调用时填充类 B 的 N 个字段的类 A 中的方法现在只需填充两个不同的字段。这也将消除为每次调用类 A 中的方法创建一个类型 B 的新对象的需要。这种方法在多线程应用程序中的含义是什么？

如果你使用`Static`，那么 B 将是`A`类的一部分，而不是对象，`A`所以 B 对所有`A`实例都是通用的，你真的想要吗？

> 或者，我们可以将 B 类中所有不会更改的字段声明为静态，以便 A 类中的方法仅设置每次调用更改的字段。无论哪种方式，性能提升是否值得，或者这种变化是否符合过早的优化？

请提供一些代码。在我看来，静态块应该只用于配置对象的初始化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T09:15:21.400

如果您只保留一个 class 实例`B`，并根据需要修改并从该方法返回，那么您将不得不期待麻烦：调用者不能依赖包含他请求的数据的返回对象。在单线程应用程序中，如果在两者之间对方法进行不同的调用，则存储该值并稍后访问它会导致麻烦。在多线程应用程序中，内容甚至可能在没有来自当前线程的这种调用的情况下发生变化，因为另一个线程可能会调用该方法并导致对象发生变化。该对象甚至可能处于两者之间的不一致状态。

可能在某些情况下可以安全合理地使用它，但根据您提供的一般描述，我建议不要这样做。也许更好的解决方案是以只保存两个变化的值和对另一个对象的引用`B`的方式来分解类的不变部分，该对象包含不可修改的部分。`B`当然，这仅适用于您控制`B`.

# android - 椭圆选框/结束

> ID：12277994
> 
> 赞同：28
> 
> 时间：2012-09-05T09:08:42.150
> 
> 标签：android

我刚开始了解在文本视图中使用 ellipsize。但是我无法理解如果我设置 android:ellipsize="marquee" 而不是使用 android:ellipsize="end" 会得到什么效果。我是 android 新手。请帮忙。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2015-01-24T11:08:28.633

比视图长的单词宽到椭圆而不是在中间断开。您通常还希望设置 scrollHorizo​​ntally 或 singleLine 以便整个文本也被限制为单行，而不是仍然允许被分成多行。

必须是以下常量值之一。

假设原始值文本视图是**aaabbbccc**及其在视图内的拟合

```
Constant    Value   Description
none         0      
start        1      output will be : ...bccc
middle       2      output will be : aa...cc
end          3      output will be : aaab...
marquee      4      out put will be : aaabbbccc auto sliding from right to left 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-09-05T09:12:08.117

如果你想让你的文本视图水平滚动，那么 ellipsize "marquee" 只会起作用。Ellipsize "end" 将帮助您使用 "..." 使您的 textview ellipsize

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2013-12-11T05:25:07.627

如果您想在应用程序中使用水平滚动文本，请使用

```
android:ellipsize="marquee" 
```

其中单行大文本将滚动。

但如果你使用，

```
android:ellipsize="end" 
```

屏幕结束后的文本将显示为

> ...

# .net - 在 XAML 窗口的 ComboBox 中显示类项

> ID：12277998
> 
> 赞同：1
> 
> 时间：2012-09-05T09:08:49.107
> 
> 标签：.net, wpf, vb.net, data-binding

我对一些 WPF 控件有一些维护工作要做，这是我不太熟悉的，而且我在 WPF 中的一些基础知识上苦苦挣扎。

我有以下代码，我理解它被称为“代码隐藏”：

```
Class MainWindow
    Private _myStrings As New List(Of String)({"one", "two", "three", "four", "five"})
    Public Property myStrings As List(Of String)
        Get
            Return _myStrings
        End Get
        Set(value As List(Of String))
            _myStrings = value
        End Set
    End Property
End Class 
```

然后我有这个 WPF 的东西，它定义了一个非常丑陋的 ComboBox。

```
<Window x:Class="MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
    <Grid>
        <ComboBox Margin="0,10,0,0"
                  x:Name="cboItem" 
                  TabIndex="1"/>
    </Grid>
</Window> 
```

**问题：**我只想知道如何在 XAML 中正确创建引用以`myStrings`在 cboItem ComboBox 中显示列表？一旦我知道了这一点，我就可以开始详细了解[数据绑定概念](http://msdn.microsoft.com/en-us/library/ms752347.aspx)，但是现在，我需要有人为我解释一些非常基本的事情，比如“我如何告诉 XAML 在哪里查找数据？”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:25:49.787

`ComboBox`有一个名为的属性`ItemsSource`，可以设置为静态字符串列表，或者更常见的是，可以绑定到某个对象列表。

WPF 对象在它们的`DataContext`. 这是每个 WPF 框架元素的属性，并且会“级联”下来，因此设置`DataContext`的`Window`意味着该窗口上的每个控件也将继承相同的`DataContext`. *但是，它们*不必使用相同的上下文。每个控件都可以通过设置其`DataContext`属性来设置自己的上下文。

您已经在窗口本身（在后面的代码中）定义了字符串列表。这并不常见。WPF 中使用的一种更常见的方法是定义一个*ViewModel*类，其中包含视图所需的所有数据，然后将其设置为`DataContext`. 这就是 MVVM 模式的全部意义所在。

但是，以您的示例为例，没有什么可以阻止您将 Window 设置`DataContext`为 Window 本身：

```
<Window x:Class="MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525"
    DataContext="{Binding RelativeSource={RelativeSource Self}">
    <Grid>
        <ComboBox Margin="0,10,0,0"
                  x:Name="cboItem" 
                  TabIndex="1"
                  ItemsSource="{Binding myStrings}"/>
    </Grid>
</Window> 
```

该`DataContext`行告诉 WPF 为它的绑定查看哪个对象，并且该`ItemsSource`行告诉组合在其字符串列表的上下文中使用哪个属性。

**编辑：**要在组合上设置 DataContext，您可以执行以下操作：

```
<Window x:Class="MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
    <Grid>
        <ComboBox Margin="0,10,0,0"
                  x:Name="cboItem" 
                  TabIndex="1"
                  DataContext="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}"
                  ItemsSource="{Binding myStrings}"/>
    </Grid>
</Window> 
```