# StackOverflow 问答 000801000-000801999

# unix - 使用 Unix shell 命令将前 1000 行从文本文件移动到新文件

> ID：801004
> 
> 赞同：67
> 
> 时间：2009-04-29T05:33:11.373
> 
> 标签：unix, shell, copy

我希望将包含超过 5000 万个条目的文本文件中的前 1000 行复制到另一个新文件中，并从原始文件中删除这些行。

有没有办法在 Unix 中使用单个 shell 命令来做同样的事情？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-04-29T05:48:01.633

```
head -1000 input > output && sed -i '1,+999d' input 
```

例如：

```
$ cat input 
1
2
3
4
5
6
$ head -3 input > output && sed -i '1,+2d' input
$ cat input 
4
5
6
$ cat output 
1
2
3 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-04-29T05:38:09.317

```
head -1000 file.txt > first100lines.txt
tail --lines=+1001 file.txt > restoffile.txt 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-29T07:03:57.817

出于好奇，我找到了一个带有 GNU 版本`sed`(v4.1.5) 的盒子，并使用 11M 行文本文件测试了迄今为止建议的两种方法的（未缓存）性能：

```
$ wc -l input
11771722 input

$ time head -1000 input > output; time tail -n +1000 input > input.tmp; time cp input.tmp input; time rm input.tmp

real    0m1.165s
user    0m0.030s
sys     0m1.130s

real    0m1.256s
user    0m0.062s
sys     0m1.162s

real    0m4.433s
user    0m0.033s
sys     0m1.282s

real    0m6.897s
user    0m0.000s
sys     0m0.159s

$ time head -1000 input > output && time sed -i '1,+999d' input

real    0m0.121s
user    0m0.000s
sys     0m0.121s

real    0m26.944s
user    0m0.227s
sys     0m26.624s 
```

这是我正在使用的 Linux：

```
$ uname -a
Linux hostname 2.6.18-128.1.1.el5 #1 SMP Mon Jan 26 13:58:24 EST 2009 x86_64 x86_64 x86_64 GNU/Linux 
```

至少对于这个测试，它看起来`sed`比`tail`方法慢（27 秒 vs ~14 秒）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-29T05:51:17.757

这是一个单行但使用四个原子命令：

```
head -1000 file.txt > newfile.txt; tail +1000 file.txt > file.txt.tmp; cp file.txt.tmp file.txt; rm file.txt.tmp 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-29T08:02:05.260

Perl 方法：

```
perl -ne 'if($i<1000) { print; } else { print STDERR;}; $i++;' in 1> in.new 2> out && mv in.new in 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-18T17:39:38.393

使用管道：

```
cat en-tl.100.en | head -10 
```

# ruby-on-rails - 已成功安装 action_mailer_optional_tls 以使用 GMail 发送？

> ID：801005
> 
> 赞同：1
> 
> 时间：2009-04-29T05:33:13.683
> 
> 标签：ruby-on-rails, ruby, gmail, ssl

我为 Rails 2.3.2 和 Ruby 1.8.6 安装了 action_mailer_optional_tls，但我无法让 ActionMailer 发送电子邮件！

我收到以下错误：

> 530 5.7.0 必须先发出 STARTTLS 命令

悲伤……有人成功了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-21T20:19:28.403

我对 Rails 2.3.2 和 Ruby 1.8.6 也有类似的问题。新版本的 Rails 使用 Ruby 1.8.7 的一部分来支持 TLS。我在这篇[博文](http://www.justinball.com/2009/06/25/sending-email-with-ruby-on-rails-2-3-2-and-gmail/)中了解了更多信息。基本上，如果你有 Ruby 1.8.6，你需要安装和配置[ActionMailerTLS](http://github.com/openrain/action_mailer_tls/tree/master) gem，你可以在 github 上找到它。一旦我这样做了，我的问题就解决了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T18:42:11.737

配置 tls 设置的 environment.rb 文件中有什么内容？这就是我正在使用的：

```
config.action_mailer.smtp_settings = { 
  :tls => true,
  :address => "smtp.gmail.com",
  :port => "587",
  :domain => "mydomain.com", 
  :user_name => "user@mydomain.com", 
  :password => "mypassword", 
  :authentication => :login
} 
```

我在 rails 2.3.2 下运行的应用程序中使用该 gem 没有问题

# php - PHP：显示修剪后的 HTML 标记时出现 HTML 标记问题

> ID：801017
> 
> 赞同：3
> 
> 时间：2009-04-29T05:39:51.810
> 
> 标签：php, html, markup

我正在使用 Richtext 框控件在一页中发布一些数据。我正在使用 HTML 标记将数据保存到我的 db 表中 例如：这是 <b >my bold </b > text

我在另一页中显示此列的前 50 个字符。现在当我保存时，如果我保存一个带有粗体标签的句子（超过 50 个字符），并且在我修剪它时（用于获取前 50 个字符）在我的其他页面中，我会丢失结束 b 标签（</b> ) 。因此，粗体将应用于我在该页面中的其余内容。

我该如何解决这个问题？我如何检查哪些所有打开的标签都没有关闭？有没有简单的方法在 PHP 中做到这一点。是否有任何功能可以删除我的整个 HTML 标签/标记并将句子作为纯文本给我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T05:43:52.783

[http://php.net/strip_tags](http://php.net/strip_tags)

strip_tags 函数将删除您可能拥有的任何标签。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T05:44:21.643

是的

```
$textWithoutTags = strip_tags($html); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T15:03:59.503

我通常为此使用[HTML::Truncate](http://search.cpan.org/~ashley/HTML-Truncate-0.16/lib/HTML/Truncate.pm)。当然，作为 Perl 模块，您将无法直接在 PHP 中使用它——但源代码确实显示了一种可行的方法（即使用 HTML 解析器）。

另一种方法可能是按照您目前的操作进行截断，然后尝试使用[Tidy](http://uk.php.net/tidy)修复它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-08T15:20:44.360

如果您希望保留 HTML 标签，但要正确关闭，请参阅[PHP：截断 HTML，忽略标签](https://stackoverflow.com/questions/1193500/1193598)。否则，请继续阅读：

[strip_tags](http://php.net/strip_tags)将删除 HTML 标记，但不会删除 HTML 实体（例如`&amp;`），如果被截断，仍可能导致问题。

为了处理实体，可以使用[html_entity_decode](http://php.net/html_entity_decode)在剥离标签后解码实体，然后修剪，最后使用[htmlspecialchars](http://php.net/htmlspecialchars)重新编码实体：

```
$text = "1 &lt; 2\n";
print $text;
print htmlspecialchars(substr(html_entity_decode(strip_tags($text), ENT_QUOTES), 0, 3)); 
```

（注意使用 ENT_QUOTES 来实际转换*所有*实体。）

结果：

```
1 < 2
1 <

```

[**脚注：**以上内容仅适用于可以解码为 ISO-8859-1 的实体。如果您需要对国际字符的支持，您应该已经在使用 UTF-8 编码的字符串，并且只需要在调用[html_entity_decode](http://php.net/html_entity_decode)时指定它。]

# .net - Visual Studio 2008 - 如何进入 (F11) 反射代码

> ID：801019
> 
> 赞同：0
> 
> 时间：2009-04-29T05:40:48.610
> 
> 标签：.net, visual-studio, debugging, step-into

需要做什么才能步入 (F11) 反射代码。

我正在使用反射创建对象：

myObject.GetType().GetConstructor().Invoke(myParams)

我想进入构造函数的代码。如果我按 F11 它只是跳过构造函数的代码；（

但同时，如果我在 ctor 处设置断点并按 F5 - 它会达到此断点。

那么，我可以做些什么来启用反射代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T06:22:53.157

只是我的代码可能是导致问题的原因。

在 Visual Studio 中：

1.  工具 --> 选项
2.  调试（左侧）
3.  取消勾选右侧的“仅启用我的代码（仅限托管）”。

我不能保证这是导致问题的原因 - 但这是我最好的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T05:47:50.137

我认为问题在于技术上没有代码可以进入。假设您正在处理已编译的模块或库，那么自从它编译后，您根本无法进入它。即使您正在进入您编写的内容，该对象也是在内存中生成的，因此编译可能不再知道这些指令来自何处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T06:01:54.940

Soviut 所说的：它是编译后的代码，你不能介入。但是我在使用 CodeDOM 生成类*并将*它们写入磁盘*并*在 Debug 中编译 CodeDOM 时看到了这种情况。然后，您可以单步执行生成的类。但显然这是一个非常具体的案例。

您可能想使用 Reflector 来查看构造函数中发生了什么，但这是对情况的静态视图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-05T23:41:58.570

我之前遇到过同样的问题，但经过一些研究，我意识到 JustMyCode 是问题所在。它通常会禁用大多数内置的 vs 调试工具。删除后一切正常。如果您喜欢 JustMyCode，请将其用作您的调试工具。

# asp.net-mvc - asp.net MVC 中的数据输入屏幕

> ID：801022
> 
> 赞同：0
> 
> 时间：2009-04-29T05:43:04.267
> 
> 标签：asp.net-mvc

您可能认为这是一个愚蠢的问题，但我很困惑！

我有一个 Lecture table 的情况。

我想存储已注册的人的出勤率。

我有将要注册的人的主表，演讲表，重要的一张表是出勤，它将 Pk 存储为表其余部分的 fk。

在讲座操作员的索引视图中，将选择出勤并输入出勤信息。

**我的问题 它只显示一个页面用于考勤输入，该页面也可以在编辑模式下**打开，用于编辑考勤。

那么考勤页面和流程的设计应该是怎样的呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T06:37:37.833

一些方法：

1.  如果您定义块在哪里渲染部分/动态块（用户控件），则可以使用同一页面进行编辑和列出。您需要扩展 HtmlHelper 以便您可以传递 UserControl 的名称，并且您必须从控制器传递到您想要呈现的用户控件的视图（使用 ViewData）名称。这样，您可以使用具有不同操作和不同响应的相同模板（视图/页面）。

2.  您可以在客户端进行编辑。您可以使用 jQuery UI 库来弹出对话框进行编辑。要返回编辑信息，您可以使用 jquery .ajax 方法。随着客户端上发生的事情以及您在控制器上请求不同的操作，您将如何在设计意义上处理它并不重要。您可以使用对话框，可以转换页面上的现有元素等。

希望这可以帮助

# c# - 如何获取枚举的所有值？

> ID：801029
> 
> 赞同：18
> 
> 时间：2009-04-29T05:46:01.437
> 
> 标签：c#, enums

我想创建一个接受`Enum`类型的方法，并在数组中返回它的所有成员，如何创建这样的函数？

举个例子，我有这两个枚举：

```
public enum Family
{ 
   Brother,
   Sister,
   Father
}

public enum CarType
{ 
   Volkswagen,
   Ferrari,
   BMW
} 
```

如何创建一个函数`GetEnumList`以使其返回

1.  `{Family.Brother, Family.Sister, Family.Father}`对于第一种情况。
2.  `{CarType.Volkswagen, CarType.Ferrari, CarType.BMW}`对于第二种情况。

我试过 ：

```
private static List<T> GetEnumList<T>()
{
    var enumList = Enum.GetValues(typeof(T))
        .Cast<T>().ToList();
    return enumList;
} 
```

但我得到了一个`InvalidOperationException`：

> System.InvalidOperationException ：不能对 ContainsGenericParameters 为 true 的类型或方法执行后期绑定操作。在 System.Reflection.RuntimeMethodInfo.ThrowNoInvokeException() 在 System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] 参数, CultureInfo 文化, Boolean skipVisibilityChecks) 在 System.Reflection.RuntimeMethodInfo.Invoke(Object obj , BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfoculture) at System.Reflection.MethodBase.Invoke(Object obj, Object[] parameters)

**编辑：上面的代码工作正常——我得到一个异常的原因是因为分析器给我带来了这个错误。谢谢大家的解决方案。**

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-29T05:57:53.983

这是完整的代码：

```
 public enum Family
    {
        Brother,
        Sister,
        Father
    }

    public enum CarType
    {
        Volkswagen,
        Ferrari,
        BMW
    }

    static void Main(string[] args)
    {
        Console.WriteLine(GetEnumList<Family>());
        Console.WriteLine(GetEnumList<Family>().First());
        Console.ReadKey();
    }

    private static List<T> GetEnumList<T>()
    {
        T[] array = (T[])Enum.GetValues(typeof(T));
        List<T> list = new List<T>(array);
        return list;
    } 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-29T05:55:20.633

```
(Family[])Enum.GetValues(typeof(Family)) 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2019-08-19T11:51:21.457

与其他答案相同，但针对现代 C# 进行了更新：

```
public static List<TEnum> GetEnumList<TEnum>() where TEnum : Enum 
    => ((TEnum[])Enum.GetValues(typeof(TEnum))).ToList(); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-29T06:07:06.813

像这样？

```
private static List<string> GetEnumList<T>()
{
    return Enum.GetNames( typeof( T ) )
           .Select(s => typeof(T).Name + "." + s).ToList();
} 
```

# javascript - 为什么 null 是一个对象，null 和 undefined 有什么区别？

> ID：801032
> 
> 赞同：911
> 
> 时间：2009-04-29T05:47:08.843
> 
> 标签：javascript, object, null, undefined, typeof

为什么在 JavaScript 中被`null`认为是一个？`object`

正在检查

```
if ( object == null )
      Do something 
```

一样

```
if ( !object )
      Do something 
```

?

并且：

`null`和 和有什么不一样`undefined`？

* * *

## 回答 #1

> 赞同：1524
> 
> 时间：2009-04-29T13:31:20.257

```
(name is undefined) 
```

**你：**是什么`name`？^((*))
**JavaScript:** `name` ? 什么是`name`？我不知道你在说什么。你以前从来没有提到`name`过。您是否在（客户端）端看到了其他一些脚本语言？

```
name = null; 
```

**你：**是什么`name`？
**JavaScript：**我不知道。

简而言之; `undefined`是不存在事物概念的地方；它没有类型，并且以前从未在该范围内被引用过；`null`是已知事物存在的地方，但不知道价值是什么。

要记住的一件事`null`是，从概念上讲，它与`false`or`""`或此类不同，即使它们在类型转换之后等同，即

```
name = false; 
```

**你：**是什么`name`？
**JavaScript：**布尔值错误。

```
name = ''; 
```

**你：**是什么`name`？
**JavaScript：**空字符串

* * *

^(*：`name`在这种情况下，是指从未定义过的变量。它可以是任何未定义的变量，但是，name 几乎是任何 HTML 表单元素的属性。它可以追溯到很久以前，并且是在 id 之前建立的。它很有用，因为 id 必须是唯一的，但名称不必是唯一的。)

* * *

## 回答 #2

> 赞同：146
> 
> 时间：2009-04-29T06:44:13.370

差异可以总结为以下代码段：

```
alert(typeof(null));      // object
alert(typeof(undefined)); // undefined

alert(null !== undefined) //true
alert(null == undefined)  //true 
```

检查

`object == null`是不同的检查`if ( !object )`。

后者等于`! Boolean(object)`，因为一元运算`!`符自动将右操作数转换为布尔值。

由于`Boolean(null)`等于 false then `!false === true`。

因此，如果您的对象**不是 null**，*而是* **false**或**0**或**""**，则检查将通过，因为：

```
alert(Boolean(null)) //false
alert(Boolean(0))    //false
alert(Boolean(""))   //false 
```

* * *

## 回答 #3

> 赞同：132
> 
> 时间：2011-11-01T15:06:10.093

`null`不是[一个对象](http://www.2ality.com/2011/03/javascript-values-not-everything-is.html)，它是一个*原始值*。例如，您不能向其添加属性。有时人们错误地认为它是一个对象，因为`typeof null`返回`"object"`。但这实际上是一个错误（甚至可能在 ECMAScript 6 中修复）。

`null`和的区别`undefined`如下：

*   `undefined`: JavaScript 使用，意思是“没有价值”。未初始化的变量、缺失的参数和未知变量具有该值。

    ```
    > var noValueYet;
    > console.log(noValueYet);
    undefined

    > function foo(x) { console.log(x) }
    > foo()
    undefined

    > var obj = {};
    > console.log(obj.unknownProperty)
    undefined 
    ```

    但是，访问未知变量会产生异常：

    ```
    > unknownVariable
    ReferenceError: unknownVariable is not defined 
    ```

*   `null`: 程序员用来表示“无值”，例如作为函数的参数。

检查变量：

```
console.log(typeof unknownVariable === "undefined"); // true

var foo;
console.log(typeof foo === "undefined"); // true
console.log(foo === undefined); // true

var bar = null;
console.log(bar === null); // true 
```

作为一般规则，您应该始终在 JavaScript 中使用 === 并且永远不要使用 ==（== 执行[各种](http://www.2ality.com/2011/06/javascript-equality.html)可能产生意外结果的转换）。检查`x == null`是一种极端情况，因为它适用于`null`和`undefined`：

```
> null == null
true
> undefined == null
true 
```

检查变量是否有值的常用方法是将其转换为布尔值并查看它是否为`true`. 该转换由`if`语句和布尔运算符执行！（“不是”）。

```
function foo(param) {
    if (param) {
        // ...
    }
}
function foo(param) {
    if (! param) param = "abc";
}
function foo(param) {
    // || returns first operand that can't be converted to false
    param = param || "abc";
} 
```

这种方法的缺点：以下所有值都计算为`false`，因此您必须小心（例如，上述检查无法区分`undefined`和`0`）。

*   `undefined`,`null`
*   布尔值：`false`
*   数字：`+0`, `-0`,`NaN`
*   字符串：`""`

您可以通过使用 as 函数来测试到布尔值的转换`Boolean`（通常它是一个构造函数，与 一起使用`new`）：

```
> Boolean(null)
false
> Boolean("")
false
> Boolean(3-3)
false
> Boolean({})
true
> Boolean([])
true 
```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2009-04-29T05:52:17.350

> null 和 undefined 有什么区别？？

没有定义的属性是`undefined`。a`null`是一个对象。它的类型是`object`. null 是一个特殊的值，意思是“没有值。undefined 不是一个对象，它的类型是 undefined。

您可以声明一个变量，将其设置为 null，并且行为是相同的，只是您会看到打印出的“null”与“undefined”。您甚至可以将未定义的变量与 null 进行比较，反之亦然，条件为真：

```
 undefined == null
 null == undefined 
```

有关更多详细信息，请参阅[JavaScript null 和 undefined 之间的区别。](https://www.google.nl/search?q=JavaScript+Difference+between+null+and+undefined&gws_rd=cr&ei=lM1MWYjDOs_OwAL-_KioDg)

和你的新**编辑** **是**

```
if (object == null)  does mean the same  if(!object) 
```

在测试 if为 false 时，它​​们都只在测试 if **false**`object`时满足条件，但在测试时不满足条件 true

 **在这里检查：[Javascript 陷阱](http://blog.kodekabuki.com/post/30056940/javascript-gotcha-undefined-vs-null)

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2011-07-14T22:15:36.360

问题的第一部分：

> 为什么 null 在 JavaScript 中被视为对象？

这是他们现在无法修复的 JavaScript 设计错误。它应该是 null 类型，而不是 object 类型，或者根本没有它。在检测真实物体时需要进行额外的检查（有时会被遗忘），并且是错误的来源。

问题的第二部分：

> 检查
> 
> `if (object == null)`
> `Do something`
> 
> 与
> 
> `if (!object)`
> `Do something`

这两项检查总是都是假的，除了：

*   对象未定义或为空：两者都为真。

*   object 是原始的，并且 0、`""`或 false：首先检查 false，然后检查 true。

如果对象不是原始对象，而是真正的对象，例如`new Number(0)`、`new String("")`或`new Boolean(false)`，那么这两个检查都是错误的。

因此，如果“对象”被解释为一个真正的对象，那么两个检查总是相同的。如果允许原语，则检查对于 0 `""`、 和 false 是不同的。

在类似`object==null`的情况下，不明显的结果可能是错误的来源。`==`不建议使用，而是使用`===`。

问题的第三部分：

> 还有：
> 
> null 和 undefined 有什么区别？

在 JavaScript 中，一个区别是 null 是 object 类型，而 undefined 是 undefined 类型。

在 JavaScript 中，`null==undefined`为 true，如果忽略类型，则认为相等。为什么他们决定这样做，但是 0`""`和 false 不相等，我不知道。这似乎是一个武断的意见。

在 JavaScript 中，`null===undefined`这是不正确的，因为类型必须在`===`.

实际上，null 和 undefined 是相同的，因为它们都表示不存在。0`""`也是如此，就此而言，可能还有空容器`[]`和`{}`. 这么多类型的相同无是错误的秘诀。一种或根本没有更好。我会尽量少用。

“假”、“真”和“！” 是另一袋可以简化的蠕虫，例如，`if(!x)`单独`if(x)`就足够了，您不需要真假。

如果没有给出值，则声明`var x`的类型是未定义的，但它应该与根本没有声明 x 相同。另一个错误来源是一个空的空容器。所以最好一起声明和定义，比如`var x=1`.

人们绕着圈子转来转去，试图弄清楚所有这些各种各样的虚无，但在复杂的不同衣服中都是一样的东西。现实是

```
undefined===undeclared===null===0===""===[]==={}===nothing 
```

也许所有人都应该抛出异常。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-04-29T05:56:27.403

```
typeof null;      // object
typeof undefined; // undefined 
```

值 null 表示有意缺少任何对象值。它是 JavaScript 的原始值之一，对于布尔运算被视为虚假值。

```
var x = null;
var y; 
```

x 被声明并定义为 null

y 已声明但未定义。它被声明为没有值，因此它是未定义的。

z 未声明，因此如果您尝试使用 z 也将是未定义的。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2012-05-07T10:06:37.917

理解 null 和 undefined 的一种方法是了解它们出现的位置。

在以下情况下预期返回 null 值：

*   查询 DOM 的方法

    ```
    console.log(window.document.getElementById("nonExistentElement"));
    //Prints: null 
    ```

*   从 Ajax 请求收到的 JSON 响应

```
 {
      name: "Bob",
      address: null
    } 
```

*   [正则表达式.exec](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/exec)。

*   新功能处于不断变化的状态。以下返回 null：

```
 var proto = Object.getPrototypeOf(Object.getPrototypeOf({}));

       // But this returns undefined:

        Object.getOwnPropertyDescriptor({}, "a"); 
```

所有其他不存在的情况都由 undefined 表示（如@Axel 所述）。以下每个打印“未定义”：

```
 var uninitalised;
    console.log(uninitalised);

    var obj = {};
    console.log(obj.nonExistent);

    function missingParam(missing){
        console.log(missing);
    }

    missingParam();

    var arr = [];
    console.log(arr.pop()); 
```

当然，如果你决定写 var unitialised = null; 或自己从方法返回 null 然后在其他情况下会出现 null 。但这应该很明显。

第三种情况是当您想要访问一个变量但您甚至不知道它是否已被声明时。对于这种情况，使用 typeof 来避免引用错误：

```
if(typeof unknown !== "undefined"){
    //use unknown
} 
```

总之，在您操作 DOM、处理 Ajax 或使用某些 ECMAScript 5 功能时检查 null。对于所有其他情况，使用严格相等检查 undefined 是安全的：

```
if(value === undefined){
  // stuff
} 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2020-09-22T12:38:39.517

**TLDR**

`undefined`是 JavaScript 中的原始值，表示值的隐式缺失。未初始化的变量自动具有此值，并且没有显式`return`语句的函数 return `undefined`。

`null`也是 JavaScript 中的原始值。它表示[有意缺少对象值](https://tc39.es/ecma262/#sec-null-value)。`null`in JavaScript 旨在实现与[Java](https://www.java.com/)的互操作性。

`typeof null`返回`"object"`是因为语言设计的特殊性，源于 JavaScript 与 Java 可互操作的需求。这并不意味着`null`是一个对象的实例。这意味着：给定 JavaScript 中的原始类型树，`null`是“对象类型原始”子树的一部分。这将在下面更全面地解释。

**细节**

`undefined`是一个原始值，[表示](https://tc39.es/ecma262/#sec-undefined-value)值的隐含缺失。请注意，`undefined`直到1998 年的[JavaScript 1.3](https://developer.mozilla.org/en-US/docs/Archive/Web/JavaScript/New_in_JavaScript/1.3)才可以直接访问它。这告诉我们，`null`程序员在明确指示缺少值时使用的值。未初始化的变量自动具有值`undefined`。`undefined`是ECMAScript 规范中[独一无二的类型](https://tc39.es/ecma262/#sec-terms-and-definitions-undefined-type)。

`null`是[表示](https://tc39.es/ecma262/#sec-null-value)有意不存在对象值的原始值。在 ECMAScript 规范中`null`也是[一种独一无二的类型。](https://tc39.es/ecma262/#sec-terms-and-definitions-null-type)

`null`in JavaScript 的设计旨在实现与[Java](https://www.java.com/)的互操作性，[无论是从“外观”的角度还是从编程的角度（例如，计划于 1996 年推出的 LiveConnect Java/JS 桥）](https://twitter.com/BrendanEich/status/1271954691421691905?s=20)。此后，Brendan Eich 和其他人都对包含*两个*“缺乏价值”的值表示反感，但在 1995 年，Eich 被[命令](https://twitter.com/BrendanEich/status/1271993445180010496?s=20)“让 [JavaScript] 看起来像 Java”。

[布伦丹·艾希](https://twitter.com/BrendanEich/status/1271998084642246657?s=20)：

> 如果我没有“让它看起来像 Java”作为管理层的命令， *并且*我有更多的时间（很难混淆这两个因果因素），那么我会更喜欢类似自我的“一切都是对象”的方法：没有布尔、数字、字符串包装器。没有未定义和空值。叹。

为了适应 Java 的概念`null`，由于 Java 的强类型特性，只能将其分配给类型为引用类型（而不是原语）的变量，Eich 选择将特殊`null`值定位在对象原型链的顶部（即引用类型的顶部），并将该`null`类型作为“对象类型原语”集的一部分。

`typeof`此后不久，该运算符被添加到 1996 年 8 月 19 日发布[的 JavaScript 1.1中。](https://developer.mozilla.org/en-US/docs/Archive/Web/JavaScript/New_in_JavaScript/1.1)

来自[V8 博客](https://v8.dev/blog/react-cliff)：

> `typeof null`返回`object`，而不是`null`，尽管`null`是它自己的类型。要理解原因，请考虑将所有 JavaScript 类型的集合分为两组：
> 
> 1.  对象（即对象类型）
> 2.  原语（即任何非对象值）
> 
> 因此，`null`意味着“没有对象价值”，而`undefined`意味着“没有价值”。

> [![在此处输入图像描述](https://i.stack.imgur.com/kKxlq.png)](https://i.stack.imgur.com/kKxlq.png)

> 遵循这一思路，Brendan Eich 设计了 ​​JavaScript `typeof`，以本着 Java 的精神为右侧的所有值（即所有对象和空值）返回“对象”。这就是为什么 `typeof null === 'object'`尽管规范有一个单独的`null`类型。

> [![在此处输入图像描述](https://i.stack.imgur.com/a9e9J.png)](https://i.stack.imgur.com/a9e9J.png)

因此，Eich 设计了原始类型的层次结构以实现与 Java 的互操作性。这导致他`null`与层次结构中的“对象类型基元”一起定位。为了体现这一点，在`typeof`不久之后被添加到语言中时，他选择`typeof null`了返回`"object"`。

JavaScript 开发人员表示惊讶的`typeof null === "object"`是，一种同时具有 和 的弱类型语言 (JavaScript)与另一种仅具有 和 的强类型语言 (Java)`null`之间阻抗不匹配（或抽象泄漏）的结果被[严格定义](https://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)为引用引用类型（不是原始类型）。`undefined``null``null`

**请注意，这一切都是合乎逻辑的、合理的和可辩护的。`typeof null === "object"`不是错误，而是必须适应 Java 互操作性的二阶效应。**

出现了许多不完美的向后合理化和/或惯例，包括`undefined`暗示价值的*隐含*缺失，以及`null`表明价值的*故意*缺失；或者那`undefined`是没有值，`null`特别是没有*对象*值。

与 Brendan Eich 的相关对话，为后代截图：

[![在此处输入图像描述](https://i.stack.imgur.com/EVwWS.png)](https://i.stack.imgur.com/EVwWS.png)

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2013-04-29T15:23:52.407

JavaScript 中许多不同的 null 检查的比较：

[http://jsfiddle.net/aaronhoffman/DdRHB/5/](http://jsfiddle.net/aaronhoffman/DdRHB/5/)

```
// Variables to test
var myNull = null;
var myObject = {};
var myStringEmpty = "";
var myStringWhiteSpace = " ";
var myStringHello = "hello";
var myIntZero = 0;
var myIntOne = 1;
var myBoolTrue = true;
var myBoolFalse = false;
var myUndefined;

...trim... 
```

[http://aaron-hoffman.blogspot.com/2013/04/javascript-null-checking-undefined-and.html](http://aaron-hoffman.blogspot.com/2013/04/javascript-null-checking-undefined-and.html)

![JavaScript Null 检查比较表](https://i.stack.imgur.com/ThA4b.png)

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2012-10-07T14:47:03.740

要添加到 JavaScript Definitive Guide 6th Edition, p.41 on this page 的What [is](http://books.google.com/books?id=6TAODdEIxrgC&lpg=PA41&ots=obbpJPKzZH&dq=null%20undefined&pg=PA41#v=onepage&q=null%20undefined&f=false) *the difference between `undefined`and`null`*的答案：

> 您可能会考虑`undefined`表示系统级、意外或类似错误的值缺失，并`null`表示程序级、正常或预期的值缺失。如果您需要将这些值之一分配给变量或属性或将这些值之一传递给函数，`null`这几乎总是正确的选择。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-04-29T05:58:37.083

对于值相等（null==undefined），null 和 undefined 都是 false：它们都折叠为布尔 false。它们不是同一个对象（null！==undefined）。

undefined 是全局对象（浏览器中的“窗口”）的属性，但它是原始类型而不是对象本身。它是未初始化的变量和没有返回语句结束的函数的默认值。

null 是 Object 的一个实例。null 用于返回集合对象以指示空结果的 DOM 方法，它提供 false 值而不指示错误。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-04-30T07:55:21.010

一些精度：

null 和 undefined*是*两个不同的值。一个表示没有名称的值，另一个表示没有名称。

* * *

在 an 中发生的情况`if`如下`if( o )`：

括号 o 中的表达式被求值，然后对`if`括号中的表达式的值进行类型强制 - 在我们的例子中`o`。

JavaScript 中的 Falsy（将被强制为 false）值为：*''、null、undefined、0 和 false*。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-04-29T05:55:49.947

例如`window.someWeirdProperty`是未定义的，所以

`"window.someWeirdProperty === null"`评估为假，而

`"window.someWeirdProperty === undefined"`评估为真。

此外， checkif`if (!o)`与检查`if (o == null)`being`o`不同`false`。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-05-08T13:00:43.700

以下函数显示了为什么并且能够解决差异：

```
function test() {
        var myObj = {};
        console.log(myObj.myProperty);
        myObj.myProperty = null;
        console.log(myObj.myProperty);
} 
```

如果你打电话

```
test(); 
```

你得到

> 不明确的
> 
> 空值

第一个`console.log(...)`尝试在尚未定义时从中获取 - 所以它返回“未定义” `myProperty`。`myObj`在将 null 分配给它之后，第二个`console.log(...)`显然返回“null”，因为`myProperty`存在，但它具有`null`分配给它的值。

为了能够查询这种差异，JavaScript 具有`null`and `undefined`: While `null`is - 就像在其他语言中的对象一样，`undefined`不能是对象，因为没有`null`可用的实例（甚至不是实例）。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-08-28T04:40:43.663

在**Javascript** `null`中，它不是一种`object`类型，它是一种`primitave`类型。

**有什么不同？** **未定义**是指尚未设置的指针。 **Null**指的是空指针，例如某些东西已手动将变量设置为类型`null`

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2017-07-15T11:43:43.313

看这个：

```
 <script>
function f(a){
  alert(typeof(a));
  if (a==null) alert('null');
  a?alert(true):alert(false);
}
</script>
                                          //return:
<button onclick="f()">nothing</button>    //undefined    null    false
<button onclick="f(null)">null</button>   //object       null    false
<button onclick="f('')">empty</button>    //string               false
<button onclick="f(0)">zero</button>      //number               false
<button onclick="f(1)">int</button>       //number               true
<button onclick="f('x')">str</button>     //string               true 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-04-29T05:51:14.200

`null`是一个对象。它的类型为空。`undefined`不是一个对象；它的类型是未定义的。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2014-08-28T19:49:50.180

摘自 Nicholas C. Zakas 的“面向对象 Javascript 的原理”

> 但是为什么当类型为空时是一个对象呢？（事实上​​，设计和维护 JavaScript 的委员会 TC39 已经承认这是一个错误。你可以推断 null 是一个空对象指针，使“对象”成为逻辑返回值，但这仍然令人困惑。）

Zakas, Nicholas C. (2014-02-07)。面向对象 JavaScript 的原理（Kindle Locations 226-227）。没有淀粉出版社。Kindle版。

那说：

```
var game = null; //typeof(game) is "object"

game.score = 100;//null is not an object, what the heck!?
game instanceof Object; //false, so it's not an instance but it's type is object
//let's make this primitive variable an object;
game = {}; 
typeof(game);//it is an object
game instanceof Object; //true, yay!!!
game.score = 100; 
```

未定义的情况：

```
var score; //at this point 'score' is undefined
typeof(score); //'undefined'
var score.player = "felix"; //'undefined' is not an object
score instanceof Object; //false, oh I already knew that. 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-01-06T19:47:47.073

考虑“null”的最佳方式是回忆数据库中如何使用类似概念，它表示字段包含“根本没有值”。

*   是的，物品的价值是已知的；它*是*“定义的”。它*已*被初始化。
*   该项目的价值是：*“没有价值。”*

对于编写更容易调试的程序，这是一种非常有用的技术。“未定义”变量可能是错误的结果...... *（你怎么知道？）* ......但是如果变量包含值'null'，你知道“某人，在这个程序的某个地方，*将它设置*为'null。'”因此，我建议，当您需要摆脱变量的值时，不要“删除”......将其设置为'null。' 旧值将被孤立，很快将被垃圾回收；新的价值是，“没有价值（现在）。” 在这两种情况下，变量的状态都是确定的：“很明显，它是故意的。”

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2016-02-10T15:45:31.233

与 undefined 相比，null 的另一个有趣之处在于它可以递增。

```
x = undefined
x++
y = null
y++
console.log(x) // NaN
console.log(y) // 0
```

这对于设置计数器的默认数值很有用。您在声明中将变量设置为 -1 多少次？

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2016-03-11T12:27:18.837

1.  未定义表示已声明变量但尚未为其分配任何值，而可以将 Null 分配给表示“无值”的变量。（Null 是赋值运算符）

2.Undefined 本身是一个类型，而 Null 是一个对象。

3.Javascript本身可以将任何未分​​配的变量初始化为未定义，但它永远不能将变量的值设置为null。这必须以编程方式完成。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-10-02T06:14:27.130

使用 null 将某些东西定义为没有值，当您期望某些东西可能根本没有定义时使用 undefined。

例如，如果一个变量没有值，则将其赋值为 null。

```
var weDontHaveAValue = null; 
```

如果您希望某些内容可能根本没有定义，例如可选的选项参数，请使用 undefined。

```
if (typeof args.optionalParam !== 'undefined') { } 
```

# jms - 如果价值超过阈值，谁能给我一些关于如何生成邮件的示例代码

> ID：801033
> 
> 赞同：0
> 
> 时间：2009-04-29T05:47:47.220
> 
> 标签：jms, jmx

嗨，我正在监视 jvm，我正在获取它的静态数据，例如内存、线程数等，我想根据这些条件生成邮件通知。任何人都可以给我一些关于如何生成邮件的示例代码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T05:52:02.403

JavaMail 下载包含有关如何使用 javax.mail API 的示例：

[http://java.sun.com/products/javamail/FAQ.html#examples](http://java.sun.com/products/javamail/FAQ.html#examples)

查看javamail-1.4.2.zip中的demo文件夹

另一种方法是使用 log4j 或其他支持“Smtp/Email”附加程序的日志框架。有关如何设置电子邮件日志记录的示例，请参阅 log4j 站点。

# asp.net - 保持 ASP.Net 会话活动的最佳方法

> ID：801035
> 
> 赞同：3
> 
> 时间：2009-04-29T05:48:00.887
> 
> 标签：asp.net, asp.net-mvc, session

在用户注销之前保持 asp.net 或 asp.net mvc 会话处于活动状态的最佳方法是什么？

*即使在浏览器或计算机重新启动后，用户也应该能够激活会话...

换句话说，实现 REMEMBER ME 的最佳方式是什么...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T06:10:05.433

您可以将超时设置设置为更高的值，但您无法区分由超时引起的 session_end 或结束会话的用户。

您的问题的解决方案可能是在 Global.asax 中的 session_start 方法中恢复用户的会话。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T07:54:59.550

另一个想法是每分钟左右通过 iframe / ajax / image 标签在后台发送保持活动请求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T07:38:36.160

您可以为此目的使用会员提供程序，并在用户浏览器中设置一个 cookie 文件并检查它以进行身份​​验证

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T08:23:29.967

能够做到这一点的最好方法是在您的身份验证策略中使用 cookie 来指示用户已登录。将您的网站设置为使用表单身份验证，并将相关属性设置为使用 cookie。它可以在您的 Web.config 文件中完成：

```
<authentication mode="Forms">
    <forms loginUrl="Login.aspx" 
       protection="All" 
       timeout="30" 
       name="AppNameCookie" 
       path="/FormsAuth" 
       requireSSL="false" 
       slidingExpiration="true" 
       defaultUrl="default.aspx"
       cookieless="UseCookies"
       enableCrossAppRedirects="false"/>
</authentication> 
```

有关更多信息，请阅读：[如何：在 ASP.NET 2.0 中使用成员资格](http://msdn.microsoft.com/en-us/library/ms998347.aspx)

# c# - 紧凑的 Famework 锁 PDA 屏幕

> ID：801037
> 
> 赞同：0
> 
> 时间：2009-04-29T05:48:12.773
> 
> 标签：c#, compact-framework

在windows mobile PDA应用程序中无论如何都可以全屏显示表单，没有其他PDA系统菜单，只是我们的表单全屏显示在顶部，使用户无法退出表单（表单中会有一个退出按钮，他们可以退出通过那个），就像我们在带有 API 的 win 应用程序中所做的那样，锁定一个在没有标题栏、任务栏、而不是 ctrl-alt-delete、alt-tab 等的情况下以最大化显示的 Windows 应用程序。我在 PDA 中需要同样的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T06:01:38.090

将 WindowState 设置为 Maximized 将使表单在视觉上覆盖整个屏幕，但不会阻止用户使用设备上的硬件按钮离开屏幕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T06:07:33.850

如果这是在启动时，请尝试使用控制台应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T02:14:52.667

此外，如果您碰巧使用符号品牌产品，请从[http://support.symbol.com下载他们的 appcenter](http://support.symbol.com)

这使您可以对用户可以对系统执行的操作进行大量控制，而不仅仅是最大化屏幕，包括受密码保护的设置。

# sql-server - SQLSERVER2005中复制有什么用

> ID：801042
> 
> 赞同：1
> 
> 时间：2009-04-29T05:50:16.090
> 
> 标签：sql-server, sql-server-2005

嗨，任何人都可以告诉我 sqlserver2005 中复制的用途是什么。备份和复制看起来一样？它们有什么区别

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T06:48:09.557

备份就是这样：备份。如果发生不好的事情，它们使您能够恢复数据。

复制完全是另一种野兽。它基本上将数据分布在多个节点上，以便每个节点都有一个完整的（接近）最新的数据副本。

使用复制的原因有很多，包括但不限于：

*   高可用性，这样，如果一个节点出现故障，其他节点仍然可以服务请求。
*   地理分布，这意味着您的数据可以放置在需要它的人附近。如果您在白俄罗斯（或附近）维护一个本地副本，白俄罗斯的客户不需要一路去蒙大拿州获取数据——这是为了性能。您可能在白俄罗斯有 10,000 个客户 - 发送一份副本比拥有所有 10,000 个请求数据要快 [尽管这取决于他们请求数据的频率]。
*   优先级。如果您的报告用户（银行管理层）的服务水平协议低于您的面向客户的员工（银行出纳员）[他们*应该*]，您可以将所有管理放在副本上，以免减慢主副本的速度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T05:53:11.247

复制用于不同的目的，例如在不将负载放在“真实”数据库上的情况下制作报告。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T05:58:27.960

复制提高了系统可用性。如果一组数据库出现故障，您可以在副本之外提供服务。

备份使您免于灾难性错误，例如删除生产数据库的人为错误。请注意，在这种情况下，复制不会拯救您，因为它会尽职尽责地复制 drop 命令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T06:00:59.480

> SQL Server 复制是将数据从源数据库分发到整个企业的一个或多个目标数据库的过程。
> 
> 复制是维护报告服务器的绝佳解决方案。
> 
> 数据复制到的站点上的客户端的性能得到了提高，因为这些客户端可以在本地访问数据，而不是通过网络连接到远程数据库服务器。
> 
> 所有站点的客户都体验到复制数据的更高可用性。如果复制数据的本地副本不可用，客户端仍然可以访问数据的远程副本。

*   复制：大量数据，快速且最新。

*   备份/恢复：一些数据，可能会慢一点，以及一个特定的时间点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T08:32:45.420

复制可用于解决许多不同的场景，如下所述。

需要明确的是，复制与数据库备份不同

* * *

**场景：**

**服务器到服务器：在服务器到服务器环境中复制数据**

*   提高可扩展性和可用性
*   数据仓库和报告
*   整合来自多个站点的数据（服务器）
*   集成异构
*   数据卸载批处理

**服务器到客户端：在服务器和客户端之间复制数据**

*   与移动用户交换数据
*   消费者销售点 (POS)
*   集成数据的应用程序
*   多个站点（客户端）

有关 Microsoft SQL Server 复制的完整概述，请参阅以下 Microsoft 参考。

[http://msdn.microsoft.com/en-us/library/ms151198(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms151198(SQL.90).aspx)

选择最适合您的轨道（即开发人员/架构师），所有内容都将被揭示:-)

# c# - 使现有的 C# Windows 应用程序在 linux 上运行

> ID：801047
> 
> 赞同：0
> 
> 时间：2009-04-29T05:51:44.107
> 
> 标签：c#, windows, linux, mono

重复：[在linux中运行.NET exe](https://stackoverflow.com/questions/800999/run-net-exe-in-linux)

你好，

是否可以通过在 Linux 中重新编译而减少/无代码更改，使我现有的使用 Visual Studio 2008 和 .Net framework 2.0 制作的 Windows 窗体应用程序在 Linux 上运行？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T06:00:16.487

很有可能，但是，根据您的应用程序，您的里程可能会有所不同。no-nos 包括依赖于 COM 和 Win32 调用以及 P/Invokes 的第三方库/DLL。您可能还需要注意执行文件/目录连接的代码，因为 unix 使用“/”作为目录分隔符，而 Windows 使用“\”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-08T08:13:48.300

我建议您在 Mono IDE 中重新编译相同的代码，并进行任何可能需要的小改动。我已经做过很多次了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T05:57:51.127

您可以在这里获取一些信息：[在 linux 中运行 .NET exe](https://stackoverflow.com/questions/800999/run-net-exe-in-linux)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T06:13:14.163

是的，你可以，最后我检查了一下，他们的 DataGridView 正在改进，它现在可以隐藏列，但是他们在 dgv 上的 VirtualMode 还没有工作。

我主要将 Mono 用于远程处理，DateTime 类型现在在 Mono 2.4 中与远程处理兼容（yipee！）。之前（在 1.9 中），我必须将我的日期时间字段转换为字符串，以便它可以从远程中间层传输到远程中间层，这在 2.4 中不再需要。

使用此指南编写可移植软件：[http ://mono-project.com/Guidelines:Application_Portability](http://mono-project.com/Guidelines:Application_Portability)

一个例子：

> 要编写可移植软件，必须确保在必须连接路径时使用 System.IO.Path.DirectorySeparatorChar (http:/monodoc/P:System.IO.Path.DirectorySeparatorChar) 字符，或者更好的是，使用 System .IO.Path.Combine (http:/monodoc/M:System.IO.Path.Combine(string,string)) 方法来组合路径名。

# c++ - OpenCV cvSaveImage Jpeg 压缩系数

> ID：801054
> 
> 赞同：11
> 
> 时间：2009-04-29T05:56:25.157
> 
> 标签：c++, image, opencv, jpeg

我正在使用 OpenCV 并使用 cvSaveImage 函数保存为 jpeg，但我无法找到它使用的 Jpeg 压缩因子。

1.  什么是 cvSaveImage(...) 的 Jpeg 压缩系数
2.  使用 cvSaveImage(...) 时如何传递压缩因子

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-04T00:09:32.513

目前 cvSaveImage() 被声明为只接受两个参数：

```
int cvSaveImage( const char* filename, const CvArr* image ); 
```

但是，“[最新测试的快照](http://opencvlibrary.svn.sourceforge.net/viewvc/opencvlibrary/tags/latest_tested_snapshot/opencv/)”具有：

```
 #define CV_IMWRITE_JPEG_QUALITY 1
  #define CV_IMWRITE_PNG_COMPRESSION 16
  #define CV_IMWRITE_PXM_BINARY 32

  /* save image to file */
  CVAPI(int) cvSaveImage( const char* filename, const CvArr* image,
                          const int* params CV_DEFAULT(0) ); 
```

我一直无法找到任何文档，但我从这段代码中得到的印象是，您将构建一个 int 值数组来传递第三个参数：

```
int p[3];
p[0] = CV_IMWRITE_JPEG_QUALITY;
p[1] = desired_quality_value;
p[2] = 0; 
```

我不知道质量值是如何编码的，而且我从未尝试过，所以请谨慎购买。

**编辑：**

对此有点好奇，我下载并构建了 OpenCV 的最新主干版本，并且能够通过以下一次性代码确认上述内容：

```
#include "cv.h"
#include "highgui.h"
int main(int argc, char **argv)
{
    int p[3];
    IplImage *img = cvLoadImage("test.jpg");

    p[0] = CV_IMWRITE_JPEG_QUALITY;
    p[1] = 10;
    p[2] = 0;

    cvSaveImage("out1.jpg", img, p);

    p[0] = CV_IMWRITE_JPEG_QUALITY;
    p[1] = 100;
    p[2] = 0;

    cvSaveImage("out2.jpg", img, p);

    exit(0);
} 
```

我的“test.jpg”为 2,054 KB，创建的“out1.jpg”为 182 KB，“out2.jpg”为 4,009 KB。

假设您可以使用 Subversion 存储库中提供的最新代码，看起来您应该处于良好状态。

顺便说一句，质量参数的范围是 0-100，默认为 95。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-04-15T20:09:17.780

OpenCV 现在[有一个参数](http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html#imwrite)来设置 jpeg 质量。我不确定这是什么时候引入的，但大概是在 2.0 之后的某个时候。

```
const int JPEG_QUALITY = 80;

Mat src;
// put data in src

vector<int> params;
params.push_back(CV_IMWRITE_JPEG_QUALITY);
params.push_back(JPEG_QUALITY);

imwrite("filename.jpg", src, params); 
```

如果你使用的是 C++0x，你可以使用这个更短的符号：

```
imwrite("filename.jpg", src, vector<int>({CV_IMWRITE_JPEG_QUALITY, JPEG_QUALITY}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T06:32:37.377

1.  您可能可以通过在这里查看源代码来找到它：http: [//opencvlibrary.svn.sourceforge.net/viewvc/opencvlibrary/](http://opencvlibrary.svn.sourceforge.net/viewvc/opencvlibrary/)
2.  你不能，因为函数不接受这样的参数。如果您想控制压缩，那么我能想到的最简单的方法是首先使用 cvSaveImage()（或您选择的其他无损格式）将您的图像保存为位图，然后使用另一个图像库将其转换为 JPEG所需的压缩系数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-27T18:39:57.200

```
imwrite("filename.jpeg",src,(vector<int>){CV_IMWRITE_JPEG_QUALITY, 20}); 
```

*   `filename.jpeg`将输出文件名
*   `src`是包含变量的源图像读取
*   `(vector<int>)`类型转换
*   `{CV_IMWRITE_JPEG_QUALITY, 20}`在 imwrite 函数中作为 Param_ID 和 Param_value 传递的元素数组

# c# - 让无参数方法像 Func 一样工作

> ID：801060
> 
> 赞同：2
> 
> 时间：2009-04-29T05:58:34.807
> 
> 标签：c#, lambda, extension-methods, fluent-interface

我正在尝试使我的代码的一部分更加流畅。

我有一个字符串扩展，它从字符串发出 HTTP 请求并将响应作为字符串返回。所以我可以做类似的事情......

```
string _html = "http://www.stackoverflow.com".Request(); 
```

我正在尝试编写一个扩展，它将继续尝试请求直到它成功。我的签名看起来像...

```
public static T KeepTrying<T>(this Func<T> KeepTryingThis) {
  // Code to ignore exceptions and keep trying goes here
  // Returns the result of KeepTryingThis if it succeeds
} 
```

我打算称它为...

```
string _html = "http://www.stackoverflow.com".Request.KeepTrying(); 
```

唉，这似乎不起作用=）。我试着先把它变成一个 lambda，但这似乎也不起作用。

```
string _html = (() => "http://www.stackoverflow.com".Request()).KeepTrying(); 
```

有没有办法在保持语法相当流畅的同时做我想做的事情？建议非常感谢。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T06:05:51.060

您不能将方法组用于扩展方法或 lambda 表达式。我[不久前在博客上写过这个](http://msmvps.com/blogs/jon_skeet/archive/2008/01/08/extension-methods-on-lamdba-expressions-don-t-work-unfortunately.aspx)。

我怀疑你可以投到`Func<string>`：

```
string _html = ((Func<string>)"http://www.stackoverflow.com".Request)
                    .KeepTrying(); 
```

但这很讨厌。

一种替代方法是更改`Request()`​​为*返回*Func，并使用：

```
string _html = "http://www.stackoverflow.com".Request().KeepTrying(); 
```

或者，如果您想保持`Request`方法本身简单，只需添加一个`RequestFunc`方法：

```
public static Func<string> RequestFunc(this string url)
{
    return () => url.Request();
} 
```

然后调用：

```
string _html = "http://www.stackoverflow.com".RequestFunc().KeepTrying(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T06:16:57.227

为什么不把它转过来呢？

```
 static T KeepTrying<T>(Func<T> func) {
        T val = default(T);
        while (true) {
            try {
                val = func();
                break;
            } catch { }
        }

        return val;
    }

    var html = KeepTrying(() => "http://www.stackoverflow.com".Request()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T06:48:24.283

那么增强请求呢？

```
string _html = "http://www.stackoverflow.com".Request(RequestOptions.KeepTrying);

string _html = "http://www.stackoverflow.com".Request(RequestOptions.Once); 
```

`RequestOptions`是一个枚举。您还可以有更多选项、超时参数、重试次数等。

或者

```
public static string RepeatingRequest(this string url) {
  string response = null;
  while ( response != null /* how ever */ ) {
    response = url.Request();
  }
  return response;
}

string _html = "http://www.stackoverflow.com".RepeatingRequest(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T07:23:23.713

AFAIK您可以编写扩展`Func<T>`委托的扩展方法，但编译器不知道您的意思是什么：

```
string _html = "http://www.stackoverflow.com".Request.KeepTrying(); // won't work 
```

但是，如果您明确地强制转换委托将起作用：

```
string _html = ((Func<string>)"http://www.stackoverflow.com".Request).KeepTrying(); // works 
```

这里的问题是，在这种情况下，通过扩展方法是否真的提高了代码的可读性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T11:06:41.370

我不会为字符串编写扩展方法。使用更具体的类型，例如`Uri`.

完整代码：

```
public static class Extensions
{
    public static UriRequest Request(this Uri uri)
    {
        return new UriRequest(uri);
    }

    public static UriRequest KeepTrying(this UriRequest uriRequest)
    {
        uriRequest.KeepTrying = true;
        return uriRequest;
    }
}

public class UriRequest
{
    public Uri Uri { get; set; }
    public bool KeepTrying { get; set; }
    public UriRequest(Uri uri)
    {
        this.Uri = uri;
    }

    public string ToHtml()
    {
        var client = new System.Net.WebClient();

        do
        {
            try
            {
                using (var reader = new StreamReader(client.OpenRead(this.Uri)))
                {
                    return reader.ReadToEnd();
                }
            }
            catch (WebException ex)
            {
                // log ex
            }
        }
        while (KeepTrying);

        return null;
    }

    public static implicit operator string(UriRequest uriRequest)
    {
        return uriRequest.ToHtml();
    }    
} 
```

调用它：

```
 string html = new Uri("http://www.stackoverflow.com").Request().KeepTrying(); 
```

# c# - 通过将函数名称作为字符串传递来动态调用任何函数

> ID：801070
> 
> 赞同：26
> 
> 时间：2009-04-29T06:06:49.997
> 
> 标签：c#, reflection, function, instance

如何自动化创建实例并动态执行其功能的过程？

谢谢

编辑：也需要一个传递参数的选项。谢谢

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-04-29T06:11:20.767

您是否只想调用无参数构造函数来创建实例？类型是否也指定为字符串，还是可以将其设为通用方法？例如：

```
// All error checking omitted. In particular, check the results
// of Type.GetType, and make sure you call it with a fully qualified
// type name, including the assembly if it's not in mscorlib or
// the current assembly. The method has to be a public instance
// method with no parameters. (Use BindingFlags with GetMethod
// to change this.)
public void Invoke(string typeName, string methodName)
{
    Type type = Type.GetType(typeName);
    object instance = Activator.CreateInstance(type);
    MethodInfo method = type.GetMethod(methodName);
    method.Invoke(instance, null);
} 
```

或者

```
public void Invoke<T>(string methodName) where T : new()
{
    T instance = new T();
    MethodInfo method = typeof(T).GetMethod(methodName);
    method.Invoke(instance, null);
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-17T04:08:24.917

要调用构造函数，[Activator.CreateInstance](http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx)可以解决问题。它有一堆重载让你的生活更轻松。

如果您的构造函数是[无参数](http://msdn.microsoft.com/en-us/library/wccyzw83.aspx)的：

```
object instance = Activator.CreateInstance(type) 
```

如果您需要[参数](http://msdn.microsoft.com/en-us/library/wcxyzt4d.aspx)：

```
object instance =  Activator.CreateInstance(type, param1, param2) 
```

要调用一个方法，一旦您拥有[Type](http://msdn.microsoft.com/en-us/library/system.type.aspx)对象，您就可以调用该方法[`GetMethod`](http://msdn.microsoft.com/en-us/library/system.type.getmethod.aspx)来获取该[方法](http://msdn.microsoft.com/en-us/library/system.reflection.methodinfo.aspx)，然后[`Invoke`](http://msdn.microsoft.com/en-us/library/system.reflection.methodinfo.invoke.aspx)（带或不带参数）调用它。如果您需要它，Invoke 还会为您提供您正在调用的函数的返回值（如果它是 void 方法，则返回 null），

对于更详细的示例（粘贴到控制台应用程序中）：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using System.Reflection;

namespace Test
{
    public static class Invoker
    {
        public static object CreateAndInvoke(string typeName, object[] constructorArgs, string methodName, object[] methodArgs)
        {
            Type type = Type.GetType(typeName);
            object instance = Activator.CreateInstance(type, constructorArgs);

            MethodInfo method = type.GetMethod(methodName);
            return method.Invoke(instance, methodArgs);
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            // Default constructor, void method
            Invoker.CreateAndInvoke("Test.Tester", null, "TestMethod", null);

            // Constructor that takes a parameter
            Invoker.CreateAndInvoke("Test.Tester", new[] { "constructorParam" }, "TestMethodUsingValueFromConstructorAndArgs", new object[] { "moo", false });

            // Constructor that takes a parameter, invokes a method with a return value
            string result = (string)Invoker.CreateAndInvoke("Test.Tester", new object[] { "constructorValue" }, "GetContstructorValue", null);
            Console.WriteLine("Expect [constructorValue], got:" + result);

            Console.ReadKey(true);
        }
    }

    public class Tester
    {
        public string _testField;

        public Tester()
        {
        }

        public Tester(string arg)
        {
            _testField = arg;
        }

        public void TestMethod()
        {
            Console.WriteLine("Called TestMethod");
        }

        public void TestMethodWithArg(string arg)
        {
            Console.WriteLine("Called TestMethodWithArg: " + arg);
        }

        public void TestMethodUsingValueFromConstructorAndArgs(string arg, bool arg2)
        {
            Console.WriteLine("Called TestMethodUsingValueFromConstructorAndArg " + arg + " " + arg2 + " " + _testField);
        }

        public string GetContstructorValue()
        {
            return _testField;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-29T06:11:35.570

假设您要调用的方法不带任何参数：

```
public void InvokeMethod(Type type, string methodName)
{
    object instance = Activator.CreateInstance(type);
    MethodInfo method = type.GetMethod(methodName, BindingFlags.Instance | BindingFlags.NonPublic | BindingFlags.Public);

    method.Invoke(instance, null);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-29T07:18:39.733

我认为您的问题在这里有点过于笼统，我在这里提供了具有某些假设的解决方案。

假设：您有一个 typeName（字符串）、methodName（字符串）和一个参数（属于 SomeType）。

```
public static void InvokeMethod(string typeName, string methodName, SomeType objSomeType) {
      Type type = Type.GetType(typeName);
      if(type==null) {
        return;
      }
      object instance = Activator.CreateInstance(type); //Type must have a parameter-less contructor, or no contructor.   
      MethodInfo methodInfo =type.GetMethod(methodName, BindingFlags.Instance | BindingFlags.Public);
      if(methodInfo==null) {
        return;
      }
      methodInfo.Invoke(instance, new[] { objSomeType });  
    } 
```

让我知道我的假设是否错误。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-10-03T09:36:01.093

动态传递参数这里我采用了params string[] args，因为不同的函数有不同数量的参数所以。

```
public void Invoke(string typeName,string functionName,params string[] args)
    {

     Type type = Type.GetType(typeName);
     dynamic c=Activator.CreateInstance(type);
     //args contains the parameters(only string type)
     type.InvokeMember(functionName,BindingFlags.InvokeMethod,null,c,args);   

    } 
```

# objective-c - 绑定 NSLider 以控制 IKImageBrowserView 的缩放

> ID：801071
> 
> 赞同：2
> 
> 时间：2009-04-29T06:06:57.597
> 
> 标签：objective-c, cocoa

事实证明，为了做到这一点，必须将 NSSlider 的值绑定到 IKImageBrowserView 的 zoomValue。

我的问题是为什么它只能以这种方式工作？将 IKImageBrowserView 的 zoomValue 绑定到 NSSlider.intValue 似乎更自然（对我来说）

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T07:13:32.270

IKImageBrowserView 的文档指出：

> **setZoomValue：**
> 设置缩放值。
> 
> - (void) setZoomValue:(float)aValue;
> 
> **参数**
> *aValue*
> 缩放值。此值应大于或等于零且小于或等于一。零缩放值对应于最小尺寸（40x40 像素）。缩放值 1 表示图像适合浏览器边界。其他值被插值。

如果您传入的只是整数值，那么您只会得到“0”和“1”，它们分别对应于最小大小和“适合浏览器边界”。您还需要确保将滑块配置为具有最小值 0 和最大值 1，以使其与 IKImageBrowserView 一起使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-31T12:44:27.580

因为它不像绑定。它不像 IKImageBrowserView 的 zoomValue 成为滑块的值。这意味着滑块向 IKImageBrowserView 发送消息以将 zoomValue 设置为滑块的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T16:32:53.940

执行此操作的另一种方法是将图像浏览器的 zoomValue 和滑块的值绑定到另一个对象中的相同键。例如，如果您希望在重新启动应用程序之间记住缩放值，您可以将两个视图绑定到共享用户默认控制器中的特定键。每当任一视图更改时，它都会更改 NSUserDefaults 中的值，然后传播到另一个视图。

# c# - C# 测试活动的互联网连接。ping google.com

> ID：801075
> 
> 赞同：14
> 
> 时间：2009-04-29T06:07:54.987
> 
> 标签：c#, networking

C# 2008

我正在使用此代码来测试互联网连接。因为我的应用程序必须登录到 Web 服务器。但是，如果用户互联网连接失败或电缆被拔出。我将不得不通知用户。

```
 // Ping www.google.com to check if the user has a internet connection.
    public bool PingTest()
    {
        Ping ping = new Ping();

        PingReply pingStatus = ping.Send(IPAddress.Parse("208.69.34.231"));

        if (pingStatus.Status == IPStatus.Success)
        {
            return true;
        }
        else
        {
            return false;
        }
    } 
```

我认为我可以测试 Internet 连接的唯一方法是 ping www.google.com。因此，我使用了一个已设置为 500 毫秒的服务器计时器，并且在失效事件中它将调用此 ping 函数。如果 ping 返回 false。然后我的应用程序将采取适当的措施。

您认为使用 google 作为测试 Internet 连接的一种方式是件好事吗？如果谷歌失败了，那么我的应用程序将无法运行。轮询 1/2 秒是过多还是过少？只是想知道我的整个想法是否好？

非常感谢，

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-29T06:17:15.293

为什么要 ping 谷歌？你真正关心的唯一服务器是你想与之交谈的网络服务器，对吧？所以 ping 那个。这样，如果用户与 Web 服务器之间有任何问题，您可以通知用户——这是唯一重要的事情。

如果互联网出现问题，这意味着用户只能在他们自己的城镇内做任何事情，您可能无法访问 Google，但如果您仍然可以访问您感兴趣的网络服务器，为什么要报告问题？另一方面，如果 Web 服务器出现故障但 Google 没有，您为什么*不想*告诉用户有问题？

同样，为什么要使用 ping？为什么不向 Web 服务器上的已知 URL 发送 HTTP 请求？毕竟，如果网络已经启动，但 Web 服务器进程本身已关闭，那肯定与用户的网络出现故障一样糟糕。

编辑：我没有注意到你每半秒重复一次这个问题。这对任何人来说都不是一件愉快的事。当然，一分钟一次就足够了，不是吗？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-07-02T06:04:37.573

查看这个重复的问题，它有一个不需要 ping 的好答案：

[C# - 如何检查网络连接](https://stackoverflow.com/questions/520347/c-how-do-i-check-for-a-network-connection)

您可以订阅 System.Net.NetworkInformation.NetworkChange.NetworkAvailabilityChanged 事件，然后只有当它表明网络已关闭时，才向服务器发出 ping/web 请求以查看它是否可用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T06:31:44.807

我可能遗漏了一些东西，但是，为什么您需要在需要使用它之前测试服务器是否已启动并且 Web 服务正在运行？如果您在 Web 服务中调用某个方法并且没有得到及时响应，那么采取您认为合适或需要的任何操作？

它似乎只是设计的工程。

[编辑]

感谢您的澄清 robUK。您应该收听 NET Rocks 播客剧集“Udi Dahan Scales Web Applications！” （日期 12/08/2008）。他们讨论了向请求添加 GUID 并等到您在响应中获得相同的 GUID。也许您可以每秒触发一次，例如 10 次尝试，如果您在 10 次尝试后没有收到回复（附有 GUID），那么采取所需的操作？

祝你好运。。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-29T07:02:56.337

我有一个需要做类似事情的应用程序。我们有一些不同的架构，即发布/订阅消息总线。对于那些有兴趣听到来自各种服务的“心跳”的应用程序，我们允许他们在总线上注册他们的兴趣。每隔几秒钟左右，每个服务都会发布一条健康状态消息，然后消费者将收到该消息。如果消费者在一定时间内没有收到健康状态消息，他们可以采取适当的措施，直到再次听到。

这种设置比轮询服务器甚至更糟糕的是 ping 它更具可扩展性。想象一下，如果您有 100 或 1000 个客户端每隔几秒就轮询或 ping 您的服务器。坏的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-03-23T05:57:20.783

你可以像这样简单地测试

```
[DllImport("wininet.dll")]
private extern static bool InternetGetConnectedState(out int conn, int val); 
```

C# 完整源代码

[http://net-informations.com/csprj/communications/internet-connection.htm](http://net-informations.com/csprj/communications/internet-connection.htm)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T06:14:01.103

建议放置超过 0.5 秒，因为有时您的延迟会变高。我有时在 DSL 上甚至有 3.5 秒。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-07-12T18:23:05.273

最好看看你是否在网络上，而不是打扰服务器 ping 它。例如，请参阅[检测 Internet V. 本地局域网连接](https://stackoverflow.com/questions/2677702/detect-internet-v-local-lan-connection)。如果您在 Windows 7 / Server 2008 R2 上，您可以在连接发生变化时收到一个事件，这对每个人来说都比不断的 ping 和轮询要快乐得多。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-28T12:16:56.607

尽管我同意 Jon 的观点，ping 您的网络服务器可能是我想提出另一个解决方案的最佳想法，该解决方案可以单独使用，也可以与服务的初始 ping 一起使用。

`NetworkChange`这些是-class上的一个内置事件，`NetworkAvailabilityChanged`无论您是否在线，您都可以使用它从 Windows 获取整体状态。只需为其添加一个侦听器，然后您将在它更改时收到通知。

```
private void MyForm_Load(object sender, EventArgs e)
{
    NetworkChange.NetworkAvailabilityChanged += new NetworkAvailabilityChangedEventHandler(NetworkChange_NetworkAvailabilityChanged);
}

private void NetworkChange_NetworkAvailabilityChanged(object sender, NetworkAvailabilityEventArgs e)
{
    if (e.IsAvailable)
    {
        WriteLog("Network is available again, updating items");
        timer1_Tick(sender, EventArgs.Empty);
        return;
    }

    WriteLog("Network isn't available at the moment");
} 
```

它可从 .Net 2.0 及更高版本获得。更多信息可以在[MSDN](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.networkchange.networkavailabilitychanged.aspx)上找到。

# javascript - 如何在 Javascript 中实现可折叠的表格行？

> ID：801082
> 
> 赞同：1
> 
> 时间：2009-04-29T06:13:34.710
> 
> 标签：javascript

我希望有可以动态折叠网页中某些行的表格，例如：

```
    | 标题 | 福 | 酒吧 |
    ---------------------------------
    | + 我的第一部分 |
    ---------------------------------
    | + 我的第二部分 |
    ---------------------------------

```

可以动态扩展为

```
    | 标题 | 福 | 酒吧 |
    ---------------------------------
    | - 我的第一节 |
    ---------------------------------
    | 第一个标题 | 42 | $10.00 |
    ---------------------------------
    | 第二个标题 | 74 | $12.00 |
    ---------------------------------
    | + 我的第二部分 |
    ---------------------------------

```

当我按下`+`标志时。

是否有任何 JavaScript 库可以帮助我做这样的事情，或者是否有一些神奇的本机命令可以轻松地为我做这件事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T06:22:34.827

将每个部分放在不同的 tbody 元素中，每个元素都有一个 id 属性。使每个 tbody 的第一行成为一个单独的标题单元格（带有适当的 colspan），其中包含您的部分标题文本和 #the_tbody_id 的锚点。然后：

1.  添加CSS：

    tbody[id]:not(:target) > tr:first-child + tr { display: none !important; }

2.  或者，对于非部分 CSS3 浏览器，添加 Javascript 以隐藏每个 tbody 中的非第一行（例如，循环通过 tablelement.getElementsByTagName("tbody")），并钩住锚点以在单击时切换其显示属性（例如，循环通过 tbodyelement.getElementsByTagName("tr")）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T06:23:34.093

您只需在每个 TR 中编写一个不显示的 div。在“+”号上单击将 div 的显示更改为阻止，然后在“-”上单击再次将其更改为无。

为每个 div 分配一个唯一的 id。

例如：

```
<tr>
    <td>
       My Section>
       <div style='display:none'>
          Content goes here
       </div>
   </td>        
</tr> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T06:24:08.083

Dojo 和 Jquery 都可以为您做到这一点，但如果您不想使用 javascript 库，这对于纯 JavaScript 来说并不难。使用 onclick 事件处理程序进行 +/- 切换，编写一个执行的函数，该函数将块元素（您的一组行）设置为 display:none（css 规则）。如果你打算使用表格来显示它，不要尝试动态隐藏或显示表格行，它不会很好地工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T06:26:52.523

您可以将这些行的显示属性设置为无，并在单击时将其重置为“表格行”。

但我认为 IE 并没有适当地呈现这个......

# c# - 中文本地化支持

> ID：801083
> 
> 赞同：1
> 
> 时间：2009-04-29T06:13:45.550
> 
> 标签：c#, wpf, windows, .net-3.5, localization

我需要在 Windows 上的一个应用程序中支持中文，问题是我需要支持**中文普通话**，但我没有找到任何语言环境代码，你能澄清一下 Windows 是否支持普通话或有其他替代方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T07:11:43.367

由于该问题被标记为 C# 和 .NET 3.5，因此我假设适用以下 .NET 规范。

此页面上有提示[zh-Hans、zh-Hant 和“旧”的 zh-CHS、zh-CHT](http://blogs.msdn.com/shawnste/archive/2007/12/13/zh-hans-zh-hant-and-the-old-zh-chs-zh-cht.aspx)

> 使用 IETF 标准“zh-Hans”和“zh-Hant”名称来表示中文简体和繁体……在 .Net 2.0/3.x 中，我们仍然承认 zh-CHS 和 zh-CHT 以实现向后兼容性…… **LCID （0x0004 或 0x7C04）**

并来自[W3 I18N FAQ](http://www.w3.org/International/questions/qa-css-lang)

> “zh-Hant”和“zh-Hans”。这些语言代码不代表特定的语言。“zh-Hant”表示以繁体字书写的*中文*。同样，“zh-Hans”代表用简体中文书写的*中文*。这可以指普通话或许多其他中文。

我想关键是您提到的**中文普通话**是一种口语方言（因为需要更好的术语），而**中文（简体）**是用于在“纸上”表示该口语的“字符集”。LocaleId [0x0004](http://www.microsoft.com/resources/msdn/goglobal/default.mspx?submitted=0004&OS=Windows%20Vista)根据 coobird 的链接。

其他**口语**（**粤语**？）由不同的“字符集”表示，如**中文（繁体）**。如果您的应用程序要去台湾或香港，您可以使用 LocaleId [0x7C04](http://msdn.microsoft.com/en-us/goglobal/bb896001.aspx)。

*   NOTE: I'm not meaning 'character set' in the computerese/ASCII sense above ~ just distinguishing between the spoken and written representations. There's a whole other discussion on character sets/codepages/unicode (although generally .NET seems to cope with that stuff as long as your fonts are sorted out and you stick to UTF-8).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T06:28:26.967

[普通话](http://en.wikipedia.org/wiki/Mandarin_Chinese)是指汉语口语的一个方言家族。

也许您正在寻找[简体中文，这是](http://en.wikipedia.org/wiki/Simplified_Chinese_characters)[中华人民共和国](http://en.wikipedia.org/wiki/People%27s_Republic_of_China)和其他国家使用的书面汉字集？

**编辑**我能够从 Microsoft 找到[自然语言支持 (NLS) API 参考](http://msdn.microsoft.com/en-us/goglobal/bb896001.aspx)，我相信它提供了用于国际化的文化名称。（我不确定国际化在 .NET 中是如何工作的。）

根据该表，有七种可用于中文的文化名称/标识符。（中文的文化名称以.开头`zh`。）

如果没有更多关于国际化应该针对哪种特定中文的信息，我认为缩小范围会有点困难。（也许其他人在这个主题上有一些经验？）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T06:52:58.420

这是一个不常见的请求，但这对于语音 UI 来说可能是有意义的。这与“wpf”标签不匹配，表单是可视的。不过，您需要更好地理解问题。coobird 建议使用简体中文，但台湾岛上也使用普通话。那里的书面语言是繁体中文。

两者的本地化同样复杂 - 除了翻译文本外，您还需要确保不使用粗体文本（不适用于任一脚本）并确保当单词不再刺痛时任何换行算法都有效由空格分隔的字母。

# iphone - iPhone - UIImagePickerController 有时会显示白屏

> ID：801089
> 
> 赞同：1
> 
> 时间：2009-04-29T06:17:04.560
> 
> 标签：iphone, uiimagepickercontroller

我在我的应用程序中使用 UIImagePickerController 的共享实例。我使用相机胶卷作为图像源。

有时，当图像选择器打开时，我看不到照片库，而只能看到一个空白的白色屏幕。此问题并非每次都可重现，并且仅在某些时候发生。

有其他人遇到过这个问题吗？是内存使用吗？我在设备上进行测试时使用 Instruments 检查了应用程序，但内存似乎不是问题。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-08T16:39:03.933

该问题是由内存问题引起的。我创建了一个 UIImagePickerController 的共享实例并在整个应用程序中使用它。

# php - 寻找 PHP 和/或 Python RAD

> ID：801090
> 
> 赞同：6
> 
> 时间：2009-04-29T06:17:06.527
> 
> 标签：php, python, vcl4php

我正在寻找类似 RAD 的 PHP 和/或 Python 环境免费与否无关紧要。

它应该有一个视觉环境，人们可以使用指向和单击界面，以便可以用鼠标选择对象并移动它们。

我看过Delphi4PHP。RAD 部分很棒，但我不喜欢它所基于的框架 VCL4PHP (vcl4php.sourceforge.net) 很糟糕。为了部署一个简单的 Hello world 应用程序，我们将不得不部署 40MB 的该框架。那简直是愚蠢......

我查看了 Eclipse，但它只是一个代码 IDE。没有设计页面/窗口的视觉方式。我是否错过了任何支持此功能的插件？

有人建议我仔细看看 NetBeans IDE，所以我也查了一下，但没有找到我想要的。

我也查看了以下内容，但这些都不是真正的 RAD：

*   NuSphere PHPEd
*   VS PHP for Visual Studio
*   PHP 设计器（无论如何都不是设计器，只是一个普通的旧 IDE）

我也找不到任何血统 Python RAD 工具。

我查看了 Yes Software 的 Code Charge Studio (www.yessoftware.com)，但它不能用于开发复杂的应用程序，例如会计系统或库存管理应用程序等。它很有用，但适用于非常简单的应用程序。对视觉部分（这个人称为组件）进行更改是一场噩梦。最后它不支持 Python。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T12:47:42.903

Python 和 PHP 都有[GTK](http://www.gtk.org/)的绑定：

*   [用于 Python 的PyGTK](http://www.pygtk.org/)；
*   [PHP 的PHP GTK](http://gtk.php.net/)；

您可以使用[Glade](http://glade.gnome.org/)作为 RADD 来绘制 GTK 应用程序。

GTK 在 Windows、Linux 和 Mac OS 上运行。

如果您正在寻找嵌入所有内容的东西，我可以考虑用于 Python 的[SPE](http://pythonide.blogspot.com/)，但您确实可以单独运行 Glade。

因为任何图片都值 1000 字：

![替代文字](https://glade.gnome.org/images/glade-main-page-thumb.png)

我让 PHP 爱好者选择他们的等效语言。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T07:36:57.270

除了 WebDev 之外，我刚刚记下了一些可能对您有用的工具：

*   PHPMaker
*   造波器

对于 Python，我将在今晚晚些时候尝试 DialogBlocks。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T07:56:02.433

对于 python，如果您有 delphi 背景，请尝试[BoaConstructor](http://www.boa-constructor.sourceforge.net)，这是一个好的开始。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-29T11:14:17.700

[TurboPHP](http://www.turbophp.com/)，它现在是开源项目。

[wxPython](http://www.wxpython.org/screenshots.php)也有 GUI Builder。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T06:21:24.457

Delphi4PHP 是我所知道的唯一一个，在过去我还使用 Macromedia（现在的 Adob​​e）Dreamweaver 来生成一些代码，如果你建立一个实时站点，它有点像 RAD IDE。有点。

对于 Python，几个小时前我问了一个类似的问题，我也有兴趣了解这样的工具。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T07:10:23.370

还有[webdev](http://www.pcsoft.fr/webdev/)。它可以生成PHP。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-29T07:15:34.077

[Wingware](http://www.wingware.com/products)看起来像一个相当不错的 Python IDE

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-01T06:03:23.297

我认为 Morfik 是一个非常类似于您正在寻找的 RAD 工具。但是，您使用的编程语言不是 PHP 或 Python。它使用 ObjectPascal、c# 或 Basic：

[http://www.morfik.com](http://www.morfik.com)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-12-21T15:20:25.397

我不认为 Yogi 是一个 PITA。他很有洞察力，这很有帮助。由于这些工具中没有一个能完全符合他的要求，所以它会是正确的，然后我们所有人都会从他的研究决定中受益。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-29T17:15:19.830

您应该真正检查 Vs.php [Vs.php](http://www.jcxsoftware.com/vs.php)它是 Visual Studio（独立）或 Visual Studio 插件。现在，如果有人会为 xcode 做同样的事情......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-08-10T18:28:46.113

让我详细说明 CodeCharge Studio。我认为你仍然可以考虑这个系统。就个人而言，我一直在使用它来开发非常复杂的高负载数据库驱动的 CRM 应用程序，4.x 版本甚至可以生成基于 AJAX 的代码，并且自动完成、ajax 表单提交都是小菜一碟。使用 CCS，您有时需要进行一些调整，但这些技巧非常典型。因此，CodeCharge Studio 仍然是复杂应用程序的选择。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-08-10T22:24:22.923

既然你提到了 Delphi，你可以试试 ExtPascal - [http://code.google.com/p/extpascal/](http://code.google.com/p/extpascal/)。这个框架有第 3 方设计器支持（Delphi 和 Lazarus）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-11-20T05:18:05.000

我找到了一个 IDE，它允许用户直观地构建基于 Python 的应用程序。IDE 是开源的，来自日本。

看看这个！

[链接文本](http://www.widestudio.org/EE/wsinfo.html)

和

[链接文本](http://www.widestudio.org/EE/spec.html)

我不得不说我没有使用它。我才发现！

我仍在为 PHP 寻找一个好的 IDE，它可以让我直观地构建 GUI。

希望这对其他人有帮助。

* * *

## 回答 #14

> 赞同：-5
> 
> 时间：2009-04-29T07:01:00.570

好消息是，一旦你熟悉了责任共担的工作方式，你就不会错过它。

仔细想想：程序员真的是组装用户界面的合适人选吗？我认为即使是桌面应用程序也不会。

程序员应该写好代码，分离显示逻辑，让所有呈现的东西

*   信息架构师
*   用户界面/体验专家
*   **你来了，写代码**
*   平面设计师
*   网站建设者

- 不是那么坏的消息是，没有这样的 PHP 和 Python 工具。

# linux - 如何找到今天在 Unix/Linux 中创建的所有文件？

> ID：801095
> 
> 赞同：77
> 
> 时间：2009-04-29T06:21:21.960
> 
> 标签：linux, unix

如何在 unix/linux 中找到仅在今天而不是 24 小时内创建的所有文件

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-04-29T06:27:49.777

在我的 Fedora 10 系统上，使用`findutils-4.4.0-1.fc10.i386`：

```
find <path> -daystart -ctime 0 -print 
```

该`-daystart`标志告诉它从今天开始计算，而不是从 24 小时前开始计算。

但是请注意，这实际上会列出在最后一天 创建*或修改的文件。*`find`没有查看文件真实创建日期的选项。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2013-09-25T09:31:20.520

```
find . -mtime -1 -type f -print 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-04-29T06:26:28.860

要在当前目录及其子目录中查找仅今天修改的所有文件（仅从一天开始，即上午 12 点）：

```
touch -t `date +%m%d0000` /tmp/$$
find . -type f -newer /tmp/$$
rm /tmp/$$ 
```

[资源](http://www.mydigitallife.info/2006/01/19/find-files-that-are-modified-today-or-since-certain-time-ago-in-unix/)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2018-03-06T19:00:41.440

我经常使用它：

```
$ ls -altrh --time-style=+%D | grep $(date +%D) 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-08-29T13:09:39.020

在浏览了许多帖子后，我找到了真正有效的最佳帖子

```
find $file_path -type f -name "*.txt" -mtime -1 -printf "%f\n" 
```

这仅打印文件名， `abc.txt`而不是`/path/tofolder/abc.txt`

也可以玩或自定义`-mtime -1`

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-05-30T14:04:21.383

这对我有用。列出 5 月 30 日在当前目录中创建的文件。

```
ls -lt | grep 'May 30' 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-04-05T07:09:15.703

使用 ls 或 find 来获取今天创建的所有文件。

使用 ls ：`ls -ltr | grep "$(date '+%b %e')"`

使用查找：`cd $YOUR_DIRECTORY`；`find . -ls 2>/dev/null| grep "$(date '+%b %e')"`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-08-12T15:20:05.907

```
 find ./ -maxdepth 1 -type f -execdir basename '{}' ';' | grep `date +'%Y%m%d'` 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-09-16T08:59:16.947

如果您不小心 rsync'd 到错误的目录，上述建议可用于查找新文件，但对我来说，最简单的方法是连接 SFTP 客户端（如 Transmit），然后按日期排序并删除。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-08-27T12:56:16.893

您可以使用`find`and`ls`来完成：

```
find . -type f -exec ls -l {} \; |  egrep "Aug 26"; 
```

它将找到该目录中的所有文件，显示有用的信息`-l`（

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2021-12-12T19:54:24.520

要在 24 小时前获取文件，请执行以下命令：

```
find . -type f -mtime 1 -exec ls -l {} \; 
```

要获取今天创建的文件，请执行以下命令：

```
find . -type f -mtime -1 -exec ls -l {} \; 
```

获取在 n 天之前创建的文件，其中 +2 是在以下命令中的 2 天之前的文件：

```
find . -type f -mtime +2 -exec ls -l {} \; 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2017-03-09T11:58:51.853

请记住，8 月和 26 日之间有 2 个空格。否则，您的 find 命令将不起作用。

```
find . -type f -exec ls -l {} \; |  egrep "Aug 26"; 
```

# queue - 队列实现

> ID：801097
> 
> 赞同：1
> 
> 时间：2009-04-29T06:21:33.503
> 
> 标签：queue, firebird

在多个用户尝试访问大约 100 000 条记录的情况下，实现快速队列的最佳方法是什么。只有一个用户可以获得一个唯一的行。现在我正在使用 sql 数据库（火鸟），但有很多问题死锁/高数据库负载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T17:54:29.313

大多数情况下，死锁是由错误的事务逻辑引起的。

一般来说，交易必须短（越短越好）。

您可以从阅读一些文档开始：

[http://www.firebirdsql.org/doc/whitepapers/fb_vs_ibm_vs_oracle.htm](http://www.firebirdsql.org/doc/whitepapers/fb_vs_ibm_vs_oracle.htm)

[http://www.ibphoenix.com/main.nfs?a=ibphoenix&page=ibp_expert4](http://www.ibphoenix.com/main.nfs?a=ibphoenix&page=ibp_expert4)

# subsonic - Subsonic3 和 GUID

> ID：801098
> 
> 赞同：0
> 
> 时间：2009-04-29T06:21:52.210
> 
> 标签：subsonic, subsonic3, guid

我有一个表，其 PrimaryKey 设置为 uniqueidentifier (GUID)，并使用 sql server 2008 中的 newsequentialid() 函数自动填充...当我手动插入一行时，一切正常。但是当我使用亚音速类和存储库插入记录时，GUID 列默认为全零，数据库将输入该值。我需要它不要这样做并使用列的默认值......还有其他人能够解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T07:40:06.933

这已在 SQL 2005 的 2.0.2 中修复 - 我想知道 SQL 2008 是否存在问题。您使用的是什么版本？我想这可能还没有在 3.x 中涵盖。

# java - java中的压缩和解压对于不同的编程语言不能正常工作

> ID：801100
> 
> 赞同：0
> 
> 时间：2009-04-29T06:22:16.857
> 
> 标签：java, compression

如果我使用 java 压缩和解压缩数据，那么它工作正常我如果朋友使用 C#.NET 压缩数据而我使用 java 所以在这种情况下我无法解压缩相同的数据。

我在 java 中使用充气机和放气机。

谢谢巴皮

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T06:47:34.643

使用与 gzip 格式兼容的 GZIPInputStream 和 GZIPOutputStream。

注意：每种压缩格式都不同（尽管方法相似）并且它们必须相同才能工作。

Inflator 和 Deflator 是 GZIP 格式的缩减版本，我不希望它可以与 Java 以外的任何其他东西一起使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T06:55:33.093

java.util Deflator 和 Inflator 支持是基本的 zip 压缩和解压缩格式实现——它们不会创建独立的存档文件。相反，他们创建/读取与存档文件中一个条目的数据部分相对应的数据流。

要创建通用压缩实用程序可读的存档文件，请使用 java.util.GZIPXxx 或 java.util.ZipXxx 类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T11:05:35.520

谢谢你的支持。我改变了我的压缩逻辑。仅在此之后，我在 java 和 C#.NET 中都使用了 GZIPInputStream。我的问题解决了

谢谢巴皮

# .net - ASP.net 2.0 版是什么意思？

> ID：801114
> 
> 赞同：5
> 
> 时间：2009-04-29T06:29:14.623
> 
> 标签：.net, asp.net, .net-framework-version

ASP.NET 2.0 版究竟是什么意思？它是 .net CLR 2.0 版的版本吗？

aspnet_isapi.dll 和 aspnet_wp.exe 怎么样？它们如何适应 .net 框架的 1.1 / 2.0 / 3.5 版本？

.NET 3.5 使用 CLR 2.0。这是否意味着 ASP.NET 3.5 中除了添加类库之外没有任何变化？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T06:38:21.093

ASP.NET 2.0 是 .NET 2.0（以及 CLR 2.0）附带的框架。在大多数方面，这个数字目前与 CLR 版本最接近，因为尽管 .NET 3.0 / .NET 3.5 添加了可以（并且正在）由 ASP.NET 应用程序使用的额外程序集，但没有新的 ASP.NET 版本号.

关于你的最后一点......“没有任何变化”......好吧，运行的代码主要*由*类库决定。所以; 是的，有新的 dll，以及对旧 dll 的细微调整。但事实上，核心技术本身或多或少保持不变。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T08:35:54.447

ASP.NET 2.0 只是一个在 2.0 CLR 下运行的 ASP.NET 应用程序。这是在 IIS 管理器的应用程序属性中配置的。

针对框架 2.0、3.0 和 3.5 的应用程序在 2.0 CLR 下运行。CLR（除了一些[重大更改](http://msdn.microsoft.com/en-gb/library/ms994364.aspx)）向后兼容，因此针对框架 1.1 的应用程序通常也可以在 2.0 CLR 下运行。

IIS 中的每个应用程序池只能使用一个 CLR 版本，因此池中的所有应用程序都必须使用 ASP.NET 1.1 或 ASP.NET 2.0。如果您尝试在应用程序池中混合 CLR 版本，池中的站点将停止工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T06:39:21.293

ASP.Net 确实使用了 CLR 2.0。这也意味着有一个单独的 aspnet_wp.exe 正在运行。因此，如果您同时运行 1.1 和 2.0 asp.net 站点，您将在任务管理器中看到两个 aspnet_wp 进程。

除此之外，asp.net 2.0 还有几个新功能。我能想到的一些东西包括母版页、样式、更好的控件、拆分视图状态/控制状态、改进的视图状态压缩等等

3.5 使用 CLR 2.0，因此使用的工作进程没有区别。

有关所有信息：查看 asp.net 站点：http: [//msdn.microsoft.com/en-us/asp.net/default.aspx](http://msdn.microsoft.com/en-us/asp.net/default.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T06:49:25.217

ASP.NET 和 ASP.NET 2.0 之间有[很多不同之处。](http://msdn.microsoft.com/en-us/library/aa479401.aspx)维基百科上的[.NET Framework 页面](http://en.wikipedia.org/wiki/.NET_Framework#Versions)实际上很好地描述了框架如何从 1.1 发展到 2.0 再到 3.0 到 3.5，并且很快就会是 4.0。:)

# screen-scraping - 如何最好地代表第 3 方筛选受密码保护的站点？

> ID：801115
> 
> 赞同：2
> 
> 时间：2009-04-29T06:29:17.387
> 
> 标签：screen-scraping, usability, password-protection

我想编写一个程序来分析你的梦幻棒球队并通知你推荐的行动，可能每天多次。问题是，你不是在我的网站上玩梦幻棒球，而是在雅虎、cbs 或 espn 等网站上玩。

在大多数这些网站上，梦幻球队和联赛是不公开的，因此您必须登录并成为联赛成员才能查看联赛中的球队。

我所需要的只是将每个站点上的团队页面的纯 html 发送到我的服务器，然后我可以在那里解析和分析文件并发送用户通知。

问题是我需要用户名/密码组合才能在需要时轻松地将这些数据发送到我的服务器*，*而且我认为会有很多人不想将他们的 yahoo/espn/cbs 密码委托给我。

我想出了几种可能的方法来解决这个问题：

1.  最明显的方法是要求他们提供托管团队所在站点的凭据。然后我可以通过编程方式登录并请求我需要的数据。我猜很多人会很乐意给我他们的证书，而他们中的一些人并没有这么多。

2.  编写一个桌面客户端，然后用户下载该客户端。客户端需要他们的凭据，但它基本上可以做与基于服务器的版本完全相同的事情，登录，请求页面，并将页面发送回我的服务器。不同之处在于他们的密码永远不需要离开他们的桌面。他们的计算机需要打开，并且该程序需要运行才能使此方法起作用。

3.  编写导航到我需要的页面的浏览器插件，使用从以前登录保存的 cookie 登录到站点，然后将页面发送回我的服务器。这不需要我的软件询问他们的密码，但如果 cookie 过期，我会感到很沮丧，而且我对浏览器插件了解不多。

我敢肯定还有其他选择，但这些是我迄今为止想出的。

我有两个问题： 1\. 这种类型的任务还有哪些其他可能性？2\. 我是否高估了人们不愿意给我他们的雅虎（例如）密码？选项（1）是否高于显而易见的选择？

评论中建议我尝试使用 yahoo 管道，这看起来是一个很有希望的建议，所以我对其进行了一些探索。现在看了[这个](https://stackoverflow.com/questions/526006/post-forms-with-yahoo-pipes)，我不认为这是一个选择。所以，看起来我会选择选项 1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T07:27:03.300

使用（例如）雅虎管道可能会完成一个可能更复杂的答案。

假设您创建了一个管道，提示用户输入他们的凭据，并为他们提供一个包含他们抓取的数据的 url。他们在他们的站点中输入此 URL，而不必直接提供他们的凭据。更好的是，对于具有安全意识的人来说，可以在输入任何信息之前检查管道实际在做什么。

不利的一面是增加了复杂性（以及您必须编写和维护管道）。话虽如此，您可以从您的站点直接提供指向已发布管道的链接，以使事情尽可能简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-11T05:10:48.923

这是我几年前想做同样事情时遇到的一个问题。我们的网站是[http://benchcoach.com](http://benchcoach.com)，我们正在考虑的选项如下：

原来我们考虑获取用户的凭据和登录。然后我们会登录并抓取他们的联赛和球队信息。问题是，在阅读了几个不同的服务条款之后，这肯定违反了服务条款。最重要的是，雅虎！绝对是我们正在考虑的网站之一，他们的用户有电子邮件（我们可以访问敏感数据），还有 Yahoo! 钱包。此外，对于 Yahoo/ESPN/CBS 来说，通过 IP 地址阻止我们的程序化登录将非常简单。

我们确定的解决方案（不是 100% 满意，但似乎确实有效）是要求我们的用户安装一个小书签（如美味、digg 或 reddit），它将当前的 html 页面发布到我们的服务器，我们可以在那里解析数据并加载我们的数据库。如果他们仍然登录到他们的 Yahoo/ESPN/CBS 帐户，我们会将他们直接引导到页面，否则，这些站点会提示进行身份验证。再次单击小书签，会将页面发布到我们的服务器。

这种方法的优点是我们从未收集过任何人的凭据，因此可以减轻对安全性的任何担忧。其次，这将使 Yahoo/ESPN/CBS 无法阻止对我们服务的访问，因为我们永远不会直接连接到他们的服务器，而是用户的浏览器会将他们浏览器的内容发布到我们的服务器。

这样做的问题是需要点击 2 次才能将页面发布到我们的网站。对于头对头联赛，我们需要 3-4 个页面，因此我们的用户需要 6-8 次点击才能将他们的联赛同步到我们的服务器。我们仍在寻找这方面的选择。

一个重要的提示是，我在一年前的一次会议上遇到了 Yahoo Fantasy Football 网站的产品经理。我们讨论了我们是如何获取雅虎数据的，他确认获取凭据会违反他们的服务条款，他们可能会阻止我们。虽然我不认为他们会这样做，但如果只是为了让他们阻止我们的网站并通过关闭他们的帐户来惹恼用户，就会很难投入时间和精力来开发它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T06:50:31.517

选项 1 是显而易见的选择。信任您的网站的人将提供详细信息。屏幕抓取时没有其他方法可以登录到其他站点。

# floating-point - 单精度和双精度浮点运算有什么区别？

> ID：801117
> 
> 赞同：186
> 
> 时间：2009-04-29T06:30:19.177
> 
> 标签：floating-point, precision, processor, operations

单精度浮点运算和双精度浮点运算有什么区别？

我对与视频游戏机相关的实用术语特别感兴趣。例如，Nintendo 64 是否有 64 位处理器，如果有，那是否意味着它能够进行双精度浮点运算？PS3 和 Xbox 360 可以实现双精度浮点运算还是仅实现单精度，并且通常使用的是双精度功能（如果存在的话？）。

* * *

## 回答 #1

> 赞同：225
> 
> 时间：2009-04-29T06:41:09.557

注意：[Nintendo 64](http://en.wikipedia.org/wiki/Nintendo_64)确实有一个 64 位处理器，但是：

> 许多游戏都利用了芯片的 32 位处理模式，因为 3D 游戏通常不需要 64 位数据类型提供的更高数据精度，而且处理 64 位数据使用两倍的 RAM、缓存和带宽，从而降低整体系统性能。

来自[网络百科](http://www.webopedia.com/TERM/D/double_precision.html)：

> 术语双精度有点用词不当，因为精度并不是真正的双精度。
> double 这个词源于这样一个事实，即双精度数使用的位数是常规浮点数的两倍。
> 例如，如果一个单精度数需要 32 位，那么它的双精度数将是 64 位长。
> 
> 额外的位不仅增加了精度，还增加了可以表示的幅度范围。
> 增加精度和幅度范围的确切数量取决于程序用于表示浮点值的格式。
> 大多数计算机使用称为 IEEE 浮点格式的标准格式。

IEEE 双精度格式的精度实际上是单精度格式的*两倍*多，范围也更大。

来自[IEEE 浮点运算标准](https://web.archive.org/web/20120325162206/http://www.psc.edu/general/software/packages/ieee/ieee.php)

**单精度**

IEEE 单精度浮点标准表示需要一个 32 位字，它可以表示为从左到右从 0 到 31 的编号。

*   第一位是**符号**位，S，
*   接下来的八位是**指数**位，'E'，和
*   最后 23 位是**分数**“F”：

    ```
    S EEEEEEEE FFFFFFFFFFFFFFFFFFFFFFF
    0 1      8 9                    31 
    ```

单词表示的值V可以如下确定：

*   如果 E=255 且 F 非零，则 V=NaN（“非数字”）
*   如果 E=255 且 F 为零且 S 为 1，则 V=-Infinity
*   如果 E=255 且 F 为零且 S 为 0，则 V=Infinity
*   如果`0<E<255`then `V=(-1)**S * 2 ** (E-127) * (1.F)`where "1.F" 旨在表示通过在 F 前面加上隐式前导 1 和二进制点而创建的二进制数。
*   如果 E=0 且 F 不为零，则`V=(-1)**S * 2 ** (-126) * (0.F)`. 这些是“非标准化”值。
*   如果 E=0 且 F 为零且 S 为 1，则 V=-0
*   如果 E=0 且 F 为零且 S 为 0，则 V=0

尤其，

```
0 00000000 00000000000000000000000 = 0
1 00000000 00000000000000000000000 = -0

0 11111111 00000000000000000000000 = Infinity
1 11111111 00000000000000000000000 = -Infinity

0 11111111 00000100000000000000000 = NaN
1 11111111 00100010001001010101010 = NaN

0 10000000 00000000000000000000000 = +1 * 2**(128-127) * 1.0 = 2
0 10000001 10100000000000000000000 = +1 * 2**(129-127) * 1.101 = 6.5
1 10000001 10100000000000000000000 = -1 * 2**(129-127) * 1.101 = -6.5

0 00000001 00000000000000000000000 = +1 * 2**(1-127) * 1.0 = 2**(-126)
0 00000000 10000000000000000000000 = +1 * 2**(-126) * 0.1 = 2**(-127) 
0 00000000 00000000000000000000001 = +1 * 2**(-126) * 
                                     0.00000000000000000000001 = 
                                     2**(-149)  (Smallest positive value) 
```

**双精度**

IEEE 双精度浮点标准表示需要一个 64 位字，可以表示为从左到右从 0 到 63 的编号。

*   第一位是**符号**位，S，
*   接下来的 11 位是**指数**位，“E”，以及
*   最后的 52 位是**分数**“F”：

    ```
    S EEEEEEEEEEE FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
    0 1        11 12                                                63 
    ```

单词表示的值V可以如下确定：

*   如果 E=2047 且 F 非零，则 V=NaN（“非数字”）
*   如果 E=2047 且 F 为零且 S 为 1，则 V=-Infinity
*   如果 E=2047 且 F 为零且 S 为 0，则 V=Infinity
*   如果`0<E<2047`then `V=(-1)**S * 2 ** (E-1023) * (1.F)`where "1.F" 旨在表示通过在 F 前面加上隐式前导 1 和二进制点而创建的二进制数。
*   如果 E=0 且 F 非零，则`V=(-1)**S * 2 ** (-1022) * (0.F)`这些是“非标准化”值。
*   如果 E=0 且 F 为零且 S 为 1，则 V=-0
*   如果 E=0 且 F 为零且 S 为 0，则 V=0

参考：
ANSI/IEEE 标准 754-1985，
二进制浮点算术标准。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2017-02-24T17:22:33.503

我读了很多答案，但似乎没有一个能正确解释*double*这个词的来源。我记得几年前我的一位大学教授给出了一个很好的解释。

回顾 VonC 的回答风格，**单**精度浮点表示使用 32 位字。

*   1位**符号**，S
*   **指数**'E' 的8 位
*   **分数**的 24 位，也称为**尾数**或**系数**（即使仅表示 23 位）。我们称它为“M”（对于**尾数**，我更喜欢这个名称，因为“分数”可能会被误解）。

表示：

```
 S  EEEEEEEE   MMMMMMMMMMMMMMMMMMMMMMM
bits:    31 30      23 22                     0 
```

（只是指出，符号位是最后一个，而不是第一个。）

双**精度**浮点表示使用 64 位字。

*   1位**符号**，S
*   **指数**'E' 的11 位
*   53 位用于**分数**/**尾数**/**系数**（即使只表示 52 位），'M'

表示：

```
 S  EEEEEEEEEEE   MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
bits:     63 62         52 51                                                  0 
```

您可能会注意到，我写道，在这两种类型中，**尾数**都比其表示形式多一点信息。事实上，尾数是一个没有任何意义的数字`0`。例如，

*   0.000124 变为 0.124 × 10 ^(-3)
*   237.141 变为 0.237141 × 10 ³

这意味着尾数将始终采用以下形式

0.α [1] α [2] ...α [t] × β ^p

其中β是表示的基础。但由于分数是二进制数，α [1]总是等于 1，因此分数可以重写为 1.α [2] α [3] ...α [t+1] × 2 ^p并且可以隐式假设初始 1，为额外的位（α [t+1]）腾出空间。

现在，32 的两倍显然是 64，但这不是这个词的来源。

*精度表示***正确**的小数位数，即没有任何类型的表示错误或近似值。换句话说，它表示可以**安全**使用多少个十进制数字。

话虽如此，很容易估计可以安全使用的小数位数：

*   **单精度**：log [10] (2 ^(24) )，大约是 7~8 个十进制数字
*   **双精度**：log [10] (2 ^(53) )，大约是 15~16 个十进制数字

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-04-29T06:39:20.467

好的，机器上的基本区别是双精度使用的位数是单精度的两倍。在通常的实现中，单声道是 32 位，双声道是 64 位。

但这*意味着*什么？如果我们假设 IEEE 标准，那么单精度数的尾数约为 23 位，最大指数约为 38；双精度的尾数为 52 位，最大指数约为 308。

像往常一样，详细信息在[Wikipedia上。](http://en.wikipedia.org/wiki/IEEE_floating-point_standard)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2018-02-14T01:54:28.667

在这里添加所有精彩的答案

首先**float**和**double**都用于表示数字小数。因此，两者之间的差异源于它们可以存储数字的精度。

> **例如：**我必须存储 123.456789 一个可能只能存储 123.4567，而另一个可能能够存储确切的 123.456789。

所以，基本上我们想知道这个数字可以存储多少准确，也就是我们所说的精度。

在这里引用@Alessandro

> **精度表示正确**的小数位数，即没有任何类型的表示错误或近似值。换句话说，它表示可以**安全**使用多少个十进制数字。

Float 可以准确存储大约 7-8 位小数部分，而 Double 可以准确存储大约 15-16 位小数部分

因此，float 可以存储**双倍的小数部分。**这就是为什么 Double 被称为*double the float*

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2019-09-13T15:29:25.083

所有人都已经详细解释了，我没有什么可以补充的了。虽然我想用通俗易懂的术语或简单的英语来解释它

```
1.9 is less precise than 1.99
1.99 is less precise than 1.999
1.999 is less precise than 1.9999 
```

......

能够存储或表示“1.9”的变量提供的精度低于能够保存或表示 1.9999 的变量。这些分数在大型计算中可能会产生巨大的差异。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-04-29T06:31:28.440

基本上[单精度](http://en.wikipedia.org/wiki/Single_precision)浮点运算处理 32 位浮点数，而[双精度](http://en.wikipedia.org/wiki/Double_precision)处理 64 位。

双精度的位数增加了可以存储的最大值，同时也增加了精度（即有效位数）。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-04-29T06:55:06.467

至于“ps3 和 xbxo 360 能否实现双精度浮点运算或仅实现单精度，并且在一般情况下使用的是双精度功能（如果存在的话？）”这个问题。

我相信这两个平台都无法实现双浮点。最初的 Cell 处理器只有 32 位浮点数，与 Xbox 360 所基于的 ATI 硬件（R600）相同。后来 Cell 获得了双浮点支持，但我很确定 PS3 不会使用这种芯片。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-29T07:04:57.423

双精度意味着数字需要两倍的字长来存储。在 32 位处理器上，字都是 32 位，所以双精度数是 64 位。就性能而言，这意味着对双精度数字的运算需要更长的时间来执行。因此，您可以获得更好的范围，但对性能的影响很小。硬件浮点单元稍微减轻了这种影响，但它仍然存在。

N64 使用基于 MIPS R4300i 的 NEC VR4300，它是一个 64 位处理器，*但*处理器通过 32 位宽总线与系统的其余部分通信。因此，大多数开发人员使用 32 位数字，因为它们更快，而且当时大多数游戏不需要额外的精度（所以他们使用浮点数而不是双精度数）。

这三个系统*都可以*进行单精度和双精度浮点运算，但它们可能不是因为性能。（虽然 n64 之后几乎所有东西都使用 32 位总线，所以......）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-12-10T03:40:00.620

首先 float 和 double 都用于表示数字小数。因此，两者之间的差异源于它们可以存储数字的精度。

例如：我必须存储 123.456789 一个可能只能存储 123.4567，而另一个可能能够存储确切的 123.456789。

所以，基本上我们想知道这个数字可以存储多少准确，也就是我们所说的精度。

在这里引用@Alessandro

精度表示正确的小数位数，即没有任何类型的表示错误或近似值。换句话说，它表示可以安全使用多少个十进制数字。

Float 可以准确存储大约 7-8 位小数部分，而 Double 可以准确存储大约 15-16 位小数部分

因此，double 可以存储两倍于浮点数的小数部分。这就是为什么 Double 被称为 double the float

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-03-31T17:29:40.827

根据 IEEE754 • 浮点存储标准 • 32 位和 64 位标准（单精度和双精度） • 分别为 8 位和 11 位指数 • 中间结果的扩展格式（尾数和指数）

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2009-05-01T11:08:55.543

单精度数使用 32 位，MSB 为符号位，而双精度数使用 64 位，MSB 为符号位

单精度

`SEEEEEEEEFFFFFFFFFFFFFFFFFFFFFFF.(SIGN+EXPONENT+SIGNIFICAND)`

双精度：

`SEEEEEEEEEEEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF.(SIGN+EXPONENT+SIGNIFICAND)`

# php - PHP中的单元测试？

> ID：801126
> 
> 赞同：5
> 
> 时间：2009-04-29T06:32:37.597
> 
> 标签：php, unit-testing

我一直在考虑为我的 PHP/MySQL 项目编写单元测试。

困扰我的事情是我如何测试表单验证、ajax 功能和 UI 功能（例如单击链接）。另外，我不希望测试依赖于 UI 的一个方面，所以如果我移动一个链接，那么所有测试都会中断。

有没有人对我应该对代码的哪些部分进行单元测试、大约应该在单元测试上花费多少时间以及任何其他建议/提示有任何想法/建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T07:32:06.533

[您应该翻阅SimpleTest 文档的](http://www.simpletest.org/en/web_tester_documentation.html)这一部分，并查看他们用于测试的方法

*   页面内容
*   导航
*   饼干
*   图片
*   框架
*   表单提交
*   重定向
*   代理

即使您最终没有使用 SimpleTest，也可能值得一看。

对我来说，最有用的是测试表单提交，包括 GET 或 POST 请求中的每个参数，这些参数是站点运行所必需的每个表单。

无论您是要测试大量 UI 还是只测试小的关键区域，都取决于您。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T20:09:59.300

单元测试，至少从 Web 应用程序开发的角度来看，并不能真正涵盖 UI 设计。单元测试**可以**帮助您测试所有控制器方法的输入/输出和/或您闲逛的任何单例/全局函数。因此，如果您想获得表单验证的单元测试覆盖率，请确保您的应用程序的结构能够独立于 UI 来测试您的验证功能。

```
class SomeController extends ... {
    ... function isAPhoneNumber($string){
        if(...) {
            return true;
        }
        else (...) {
            return false;
        }
    }
} 
```

这确实使所有使您对该方法产生价值的代码都未经测试。我见过的唯一有效的测试方法是直接使用浏览器远程控件（如[Selenium](http://seleniumhq.org) ）测试 UI 。[PHPUnit 测试框架](http://www.phpunit.de/manual/3.1/en/selenium.html)具有使用 Selenium 的 PHP 驱动程序的钩子，这意味着您可以使用与其他单元测试相同的测试运行程序。

您永远不会 100% 确信一个无害的更改不会阻碍您的 Selenium 测试，但是您可以在开发过程中采取一些步骤来尽量减少这种情况。Selenium 有[多种不同的方法](http://seleniumhq.org/documentation/core/reference.html#locators)来“定位”它会单击或输入的元素。您希望使用尽可能具体的定位，因此请尝试为您的所有 (X)HTML 节点提供唯一的 ID 元素。这确保 selenium 将单击链接，无论它在页面上的哪个位置结束。

当无法使用唯一 id 时，尝试用一些具有唯一标识符的 HTML 元素包装常见元素，然后使用 selenium 的 xpath tareting 功能说“单击包含 div 中带有 id 的文本“注册”的链接“foo”，或单击 id 为“foo”的 div 中的第三个链接。

如果从上述项目中不明显，**请不要**依赖 Selenium IDE（或其他记录器）将选择的目标选择。他们的目标是确保在该确切页面上运行测试会给您相同的结果，这会给您带来非常脆弱的 xpath。始终查看您记录的测试，并修复劣质目标。

这里没有简单的答案。如果有，Web 应用程序的错误就会少很多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T06:36:27.727

试试 SeleniumHQ.org。

这是一个浏览器扩展程序，可让您像宏一样记录点击、打字和鼠标移动等。可以将宏保存为测试并回放，以测试 Web 应用程序。

看起来他们也有其他版本的产品，可以通过启动其他浏览器来执行测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T07:28:32.860

我不知道我的回答是否会有所帮助，因为我也有同样的问题。

无论如何，如果您还没有这样做，请尝试[Windmill](http://www.getwindmill.com/)，我发​​现它非常有用，快速而肮脏并且适用于主要浏览器。

更改链接不会更改测试（在我认为的大多数情况下）=）

# c# - C# Nmath 到 Python SciPy

> ID：801128
> 
> 赞同：1
> 
> 时间：2009-04-29T06:33:05.333
> 
> 标签：c#, python, scipy, nmath

我需要将一些函数从 C# 移植到 Python，但我无法正确实现下一个代码：

```
[SqlFunction(IsDeterministic = true, DataAccess = DataAccessKind.None)]
public static SqlDouble LogNormDist(double probability, double mean, double stddev)
{
    LognormalDistribution lnd = new LognormalDistribution(mean,stddev);
    return (SqlDouble)lnd.CDF(probability);
} 
```

此代码使用 CenterSpace Nmath 库。

任何人都可以帮助我在 python 中编写一个正确的函数，这将类似于这段代码？

对不起我的英语不好。

**UPD**实际上，我不明白哪些 scipy.stats.lognorm.cdf attrs 类似于 C# 概率，意思是 stddev

如果只是将现有订单复制到 python，如下面的答案，我得到错误的数字。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T08:39:10.130

Scipy 在 scipy.stats 包中定义了一堆发行版

```
import scipy.stats

def LogNormDist(prob, mean=0, stddev=1):
    return scipy.stats.lognorm.cdf(prob,stddev,mean) 
```

### 更新

好的，看起来 Scipy 的统计定义有点不标准。这是文档字符串的结尾`scipy.stats.lognormal`

> 对数正态分布
> 
> lognorm.pdf(x,s) = 1/(s *x* sqrt(2*pi)) * exp(-1/2*(log(x)/s)**2) 对于 x > 0, s > 0。
> 
> 如果 log x 服从均值 mu 和方差 sigma**2 的正态分布，则 x 服从形状参数 sigma 和尺度参数 exp(mu) 的对数正态分布。

所以也许试试

```
return scipy.stats.lognorm.cdf(prob,stddev,scipy.exp(mean)) 
```

如果这仍然不起作用，请尝试获取一些样本点，我会看看我是否能找到工作关系。

### 更新 2

糟糕，我没有意识到 scale 参数是关键字。这个现在应该可以工作了：

```
import scipy.stats

def LogNormDist(prob, mean=0, stddev=1):
    return scipy.stats.lognorm.cdf(prob,stddev,scale=scipy.exp(mean)) 
```

为您的项目干杯并祝您好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T09:46:48.660

Python 文档描述了一种方法 random.lognormvariate(mu, sigma)：

[http://docs.python.org/library/random.html](http://docs.python.org/library/random.html)

也许这就是你想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T08:29:43.023

也许您可以使用 Python.NET（这*不是*IronPython），它允许访问 .NET 组件和服务：

[http://pythonnet.sourceforge.net/](http://pythonnet.sourceforge.net/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-07T22:16:32.703

伊万，

我们没有兴趣让人们锁定在 NMath 中。这是我们在 NMath 中所做的。

```
 double t = ( Math.Log( x ) - mu_ ) / sigmaRoot2_;
  return ( 0.5 + 0.5 * Erf( t ) ); 
```

在哪里

```
private static double Erf( double x )
{
  return ( x < 0.0 ? -StatsFunctions.IncompleteGamma( 0.5, x * x ) : StatsFunctions.IncompleteGamma( 0.5, x * x ) );
} 
```

那应该有帮助...

*   特雷弗

# c# - 如何在 linq to xml 中为此 xml 数据编写此查询？

> ID：801136
> 
> 赞同：1
> 
> 时间：2009-04-29T06:37:38.490
> 
> 标签：c#, .net, linq-to-xml

我一直在阅读 msdn 中的 linq to xml 文档和其他一些教程，但到目前为止我还没有找到正确的方法来执行此查询:(

基本上，我想遍历班上的每个学生，对于每个问题，保持个人技能的计数器，即对于学生 123，计数应该是 001.101.033.002.001 - 1, 001.101.035.002.001 - 1, 001.101 .033.002.002 - 0\. 因为技能计数器是基于问题是正确的（1）还是错误的（0）。

```
<assessment name="english101" level="primary 6">
   <class id="23" name="1A">
      <student id="123" name="Jack Black">
         <question id="101" correct="1">
            <skill id="001.101.033.002.001" topicId="033" subtopicId="002" subtopicdesc="Launching a browser" topicdesc="Point and Click">Able to recognize and use desktop icon</skill>

            <skill id="001.101.035.002.001" topicId="035" topicDesc="Typing" subtopicId="002" subtopicDesc="Using Words">Able to write on screen</skill>
         </question>

         <question id="102" correct="0">
            <skill id="001.101.033.002.002" topicId="033" subtopicId="002" subtopicdesc="Launching a browser" topicdesc="Point and Click">Able to recognize and use the mouse</skill>

            <skill id="001.101.035.002.001" topicId="035" topicDesc="Typing" subtopicId="002" subtopicDesc="Using Words">Able to write on screen</skill>
         </question>
      </student>

      <student id="124" name="Tim Robbins">
         <question id="103" correct="1">
            <skill id="001.101.033.002.002" topicId="033" subtopicId="002" subtopicdesc="Launching a browser" topicdesc="Point and Click">Able to recognize and use the mouse</skill>

            <skill id="001.101.035.002.001" topicId="035" topicDesc="Typing" subtopicId="002" subtopicDesc="Using Words">Able to write on screen</skill>
         </question>

         <dtasResult>
            <skill id="001.101.033.002.002" result="weak" />

            <skill id="001.101.033.002.002" result="strong" />
         </dtasResult>
      </student>
   </class>
</assessment> 
```

到目前为止，我的代码在这里：

```
 //Open up the xml and traverse to the student nodes.
                    XElement root = XElement.Load(fileLocation);
                    IEnumerable<XElement> students = root.Elements("class").Elements("student");

                    string currentStudentId = "";
                    foreach (XElement student in students)
                    {
                        currentStudentId = student.Attribute("id").ToString();
                        //this code chunk below doesn't work!
XElement questions = root.Descendants("question")
                                                .Where(question =>
                                                question.Attribute(""));

                        Console.WriteLine(student.DescendantsAndSelf("question"));
                        Console.WriteLine();
                        Console.WriteLine();
                    } 
```

我还没有弄清楚如何为每个学生的每个问题进行循环......并且foraech中间的代码不起作用！

## 更新：

如果我想计算每个学生的总问题，我将如何修改上面的查询来做到这一点？我尝试了 grp.Count(z => z.Correct) 和其他方法，但我做不到谢谢:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T06:51:16.677

第二次编辑重新评论；我认为这可以满足您的需求...

```
var qry = from cls in doc.Root.Elements("class")
          from student in cls.Elements("student")
          from question in student.Elements("question")
          from skill in question.Elements("skill")
          select new {
            Student = (int)student.Attribute("id"),
            Skill = (string)skill.Attribute("id"),
            Correct = (int)question.Attribute("correct")
          } into denorm
          group denorm by new {
            denorm.Student,
            denorm.Skill
          } into grp
          orderby grp.Key.Student, grp.Key.Skill
          select new {
            grp.Key.Student,
            grp.Key.Skill,
            Tally = grp.Sum(x => x.Correct)
          };

foreach (var row in qry)
{
  Console.WriteLine("{0}\t{1}\t{2}",
    row.Student, row.Skill, row.Tally);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T07:16:46.383

不完全确定这是否是您想要的，但我会试一试：

```
foreach (XElement student in students)
        {
            currentStudentId = student.Attribute("id").ToString();
            Console.WriteLine(currentStudentId);
            //this code chunk below doesn't work!
            IEnumerable<XElement> correctQuestions = student.Descendants("question").
                                  Where(q => q.Attribute("correct").Value == "1");                
            //Here you would do same for false answers

            //loop through correct answers
            foreach (XElement q in correctQuestions)
            {
                IEnumerable<XElement> skills = q.Descendants("skill");
                foreach (XElement s in skills)
                {
                    //this prints "001.101.035.002.001" etc  
                    Console.WriteLine(s.Attribute("id").Value);
                }
            }
            Console.WriteLine();
        } 
```

# java - Android 架构验证

> ID：801144
> 
> 赞同：6
> 
> 时间：2009-04-29T06:39:37.330
> 
> 标签：java, android, xsd

我已经创建了`XML`一个`XSD`文件，并且我必须使用此架构验证 xml，我可以获得任何示例吗？我必须将 xsd 文件放在我的项目中，以便我可以使用该架构进行验证。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-06-15T18:50:14.697

根据[文档](http://developer.android.com/reference/javax/xml/validation/package-summary.html.) **javax.xml.validation**自 API 级别 8 起受支持。

（我会测试并尽快报告）

## 更新

好吧，问题没那么简单：

`SchemaFactory factory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);`

在第 8 级和第 9 级 API 上均失败，并出现 IllegalArgumentException，如此[处所述](http://developer.android.com/reference/javax/xml/validation/SchemaFactory.html#newInstance(java.lang.String)

谷歌在这件事上没有帮助，只是找到了同样的失败报告。API 在这里，但不是实现（默认情况下）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T16:15:33.297

[这是 Google在这里](http://code.google.com/p/android/issues/detail?id=7395)发布的一个已知问题

解决方案是使用移植到 Android 的 Apache Xerces。[这里](http://code.google.com/p/xerces-for-android/)有一个项目

您必须执行 svn chekout 并将 proyect 导出到 jar 文件以用作您的 android proyect 中的库。

SchemaFactory 实例的代码稍作更改。我给你看一个例子：

```
import mf.javax.xml.validation.Schema;
import mf.javax.xml.validation.SchemaFactory;
import mf.javax.xml.validation.Validator;
import mf.org.apache.xerces.jaxp.validation.XMLSchemaFactory;

SchemaFactory  factory = new XMLSchemaFactory();
Schema esquema = factory.newSchema(".../file.xsd"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T19:35:09.630

这可能没有多大帮助，但最后我检查了一下，Android 平台有点受限于 Java 环境。主要的问题是一些人们期望可用的 API——特别是 javax.xml.validation（JDK 1.5 的一部分和更早版本！）——不存在。

因此，您可能需要包含比在非阉割 Java 平台上更多的 jar。此外，由于黑/白名单问题（这是 Google AppEngine 的一个大问题，而且由于 Android 早于它，它也有类似的挑战），因此可能会限制可以添加哪些标准 API。

除此之外，我会尝试将 javax.xml.validation 与捆绑的 XML 解析器 Xerces 一起使用。有大量关于如何做到这一点的操作文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-17T22:29:28.953

在阅读了许多帖子并尝试了一堆不同的东西之后，我终于让 Xerces-for-Android 为我正常工作，并尝试为其他人很好地记录这个过程......希望它有所帮助:)

以下对我有用：

1.  创建验证实用程序。
2.  将 xml 和 xsd 都放入 android 操作系统上的文件中，并针对它使用验证实用程序。
3.  使用 Xerces-For-Android 进行验证。

Android确实支持我们可以使用的一些包，我创建了我的xml验证实用程序，基于：[http ://docs.oracle.com/javase/1.5.0/docs/api/javax/xml/validation/package-summary.html](http://docs.oracle.com/javase/1.5.0/docs/api/javax/xml/validation/package-summary.html)

我最初的沙盒测试使用 java 非常顺利，然后我尝试将其移植到 Dalvik 并发现我的代码不起作用。Dalvik 不支持某些东西，所以我做了一些修改。

我找到了对 android 的 xerces 的引用，所以我修改了我的沙盒测试（**以下不适用于 android，之后的示例可以**）：

```
import java.io.File;

import javax.xml.XMLConstants;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.transform.Source;
import javax.xml.transform.dom.DOMSource;
import javax.xml.transform.stream.StreamSource;
import javax.xml.validation.Schema;
import javax.xml.validation.SchemaFactory;
import javax.xml.validation.Validator;

import org.w3c.dom.Document;

/**
 * A Utility to help with xml communication validation.
 */
public class XmlUtil {

    /**
     * Validation method. 
     * Base code/example from: http://docs.oracle.com/javase/1.5.0/docs/api/javax/xml/validation/package-summary.html
     * 
     * @param xmlFilePath The xml file we are trying to validate.
     * @param xmlSchemaFilePath The schema file we are using for the validation. This method assumes the schema file is valid.
     * @return True if valid, false if not valid or bad parse. 
     */
    public static boolean validate(String xmlFilePath, String xmlSchemaFilePath) {

        // parse an XML document into a DOM tree
        DocumentBuilder parser = null;
        Document document;

        // Try the validation, we assume that if there are any issues with the validation
        // process that the input is invalid.
        try {
            // validate the DOM tree
            parser = DocumentBuilderFactory.newInstance().newDocumentBuilder();
            document = parser.parse(new File(xmlFilePath));

            // create a SchemaFactory capable of understanding WXS schemas
            SchemaFactory factory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);

            // load a WXS schema, represented by a Schema instance
            Source schemaFile = new StreamSource(new File(xmlSchemaFilePath));
            Schema schema = factory.newSchema(schemaFile);

            // create a Validator instance, which can be used to validate an instance document
            Validator validator = schema.newValidator();
            validator.validate(new DOMSource(document));
        } catch (Exception e) {
            // Catches: SAXException, ParserConfigurationException, and IOException.
            return false;
        }     

        return true;
    }
} 
```

上面的代码必须进行一些修改才能与 xerces for android ( [http://gc.codehum.com/p/xerces-for-android/](http://gc.codehum.com/p/xerces-for-android/) ) 一起使用。你需要SVN来获取项目，以下是一些婴儿床笔记：

```
download xerces-for-android
    download silk svn (for windows users) from http://www.sliksvn.com/en/download
        install silk svn (I did complete install)
        Once the install is complete, you should have svn in your system path.
        Test by typing "svn" from the command line.
        I went to my desktop then downloaded the xerces project by:
            svn checkout http://xerces-for-android.googlecode.com/svn/trunk/ xerces-for-android-read-only
        You should then have a new folder on your desktop called xerces-for-android-read-only 
```

使用上面的jar（最终我会把它做成一个jar，直接复制到我的源代码中以便快速测试。如果你想这样做，你可以用Ant快速制作jar（[http://ant.apache .org/manual/using.html](http://ant.apache.org/manual/using.html) ))，我能够获得以下内容来进行我的 xml 验证：

```
import java.io.File;
import java.io.IOException;

import mf.javax.xml.transform.Source;
import mf.javax.xml.transform.stream.StreamSource;
import mf.javax.xml.validation.Schema;
import mf.javax.xml.validation.SchemaFactory;
import mf.javax.xml.validation.Validator;
import mf.org.apache.xerces.jaxp.validation.XMLSchemaFactory;

import org.xml.sax.SAXException;

/**
 * A Utility to help with xml communication validation.
 */public class XmlUtil {

    /**
     * Validation method. 
     * 
     * @param xmlFilePath The xml file we are trying to validate.
     * @param xmlSchemaFilePath The schema file we are using for the validation. This method assumes the schema file is valid.
     * @return True if valid, false if not valid or bad parse or exception/error during parse. 
     */
    public static boolean validate(String xmlFilePath, String xmlSchemaFilePath) {

        // Try the validation, we assume that if there are any issues with the validation
        // process that the input is invalid.
        try {
            SchemaFactory  factory = new XMLSchemaFactory();
            Source schemaFile = new StreamSource(new File(xmlSchemaFilePath));
            Source xmlSource = new StreamSource(new File(xmlFilePath));
            Schema schema = factory.newSchema(schemaFile);
            Validator validator = schema.newValidator();
            validator.validate(xmlSource);
        } catch (SAXException e) {
            return false;
        } catch (IOException e) {
            return false;
        } catch (Exception e) {
            // Catches everything beyond: SAXException, and IOException.
            e.printStackTrace();
            return false;
        } catch (Error e) {
            // Needed this for debugging when I was having issues with my 1st set of code.
            e.printStackTrace();
            return false;
        }

        return true;
    }
} 
```

**一些旁注：**

为了创建文件，我制作了一个简单的文件实用程序来将字符串写入文件：

```
public static void createFileFromString(String fileText, String fileName) {
    try {
        File file = new File(fileName);
        BufferedWriter output = new BufferedWriter(new FileWriter(file));
        output.write(fileText);
        output.close();
    } catch ( IOException e ) {
       e.printStackTrace();
    }
} 
```

我还需要写一个我可以访问的区域，所以我使用了：

```
String path = this.getActivity().getPackageManager().getPackageInfo(getPackageName(), 0).applicationInfo.dataDir; 
```

有点hackish，它有效。我确信有一种更简洁的方法可以做到这一点，但是我想我会分享我的成功，因为我没有找到任何好的例子。

# delphi - 匿名方法的范围

> ID：801147
> 
> 赞同：11
> 
> 时间：2009-04-29T06:41:16.593
> 
> 标签：delphi, scope, delphi-2009, anonymous-methods

匿名方法的一个好处是我可以在调用上下文中使用本地变量。有什么理由为什么这不适用于参数和函数结果？

```
function ReturnTwoStrings (out Str1 : String) : String;
begin
  ExecuteProcedure (procedure
                    begin
                      Str1 := 'First String';
                      Result := 'Second String';
                    end);
end; 
```

当然是非常人为的例子，但我遇到了一些这很有用的情况。

当我尝试编译它时，编译器抱怨他“无法捕获符号”。此外，当我尝试这样做时，我遇到了一个内部错误。

**编辑**我刚刚意识到它适用于正常参数，如

```
... (List : TList) 
```

这不是和其他情况一样有问题吗？谁保证每当执行匿名方法时引用仍然指向活动对象？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-29T09:15:57.220

由于无法静态验证此操作的安全性，因此无法捕获var和out参数以及Result变量。当 Result 变量是托管类型时，例如字符串或接口，存储实际上是由调用者分配的，并且对该存储的引用作为隐式参数传递；换句话说，Result 变量，取决于它的类型，就像一个输出参数。

由于乔恩提到的原因，无法验证安全性。由匿名方法创建的闭包可以比创建它的方法激活的寿命更长，并且同样可以比调用它创建的方法的方法的激活寿命更长。因此，捕获的任何 var 或 out 参数或 Result 变量最终都可能成为孤立的，并且将来从闭包内部对它们的任何写入都会破坏堆栈。

当然，Delphi 并不在托管环境中运行，它也没有像 C# 那样的安全限制。语言可以让你做你想做的事。但是，在出错的情况下，这将导致难以诊断错误。不良行为将表现为例行更改值中的局部变量，而没有明显的近因；如果方法引用是从另一个线程调用的，情况会更糟。

这将很难调试。即使是硬件内存断点也将是一个相对较差的工具，因为堆栈经常被修改。需要在遇到另一个断点时（例如在方法入口时）有条件地打开硬件内存断点。Delphi 调试器可以做到这一点，但我会冒险猜测大多数人不了解该技术。

**更新**：关于您的问题的补充，按值传递实例引用的语义在包含闭包的方法之间几乎没有什么不同（并捕获 paramete0 和不包含闭包的方法。任何一种方法都可以保留对按值传递的参数；不捕获参数的方法可以简单地将引用添加到列表中，或者将其存储在私有字段中。

通过引用传递参数的情况不同，因为调用者的期望不同。这样做的程序员：

```
procedure GetSomeString(out s: string);
// ...
GetSomeString(s); 
```

如果 GetSomeString 要保留对传入变量的引用，将会非常惊讶`s`。另一方面：

```
procedure AddObject(obj: TObject);
// ...
AddObject(TObject.Create); 
```

保留一个引用并不奇怪`AddObject`，因为这个名字暗示它将参数添加到一些有状态的存储中。该有状态存储是否采用闭包的形式是该`AddObject`方法的实现细节。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-29T06:47:13.007

问题是您的 Str1 变量不是 ReturnTwoStrings“拥有”的，因此您的匿名方法无法捕获它。

它无法捕获它的原因是编译器不知道最终所有者（在调用堆栈中调用 ReturnTwoStrings 的某个位置），因此它无法确定从哪里捕获它。

**编辑：（在**[Smasher](https://stackoverflow.com/users/62391/smasher)的评论后添加）

匿名方法的核心是它们捕获变量（而不是它们的值）。

[Allen Bauer (CodeGear)在他的博客中](http://blogs.embarcadero.com/abauer/2008/10/15/38876)解释了更多[关于*变量捕获*](http://blogs.embarcadero.com/abauer/2008/10/15/38876)的内容。

还有一个[关于规避问题的 C# 问题](https://stackoverflow.com/questions/384918/how-to-circumvent-using-an-out-parameter-in-an-anonymous-method-block)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-29T06:44:40.843

函数返回后，out 参数和返回值无关紧要 - 如果您捕获匿名方法并稍后执行它，您希望它如何表现？（特别是，如果您使用匿名方法创建委托但从不执行它，则在函数返回时不会设置 out 参数和返回值。）

输出参数特别困难 - 当您稍后调用委托时，输出参数别名的变量甚至可能不存在。例如，假设您能够捕获 out 参数并返回匿名方法，但 out 参数是调用函数中的局部变量，并且它在堆栈上。如果调用方法在将委托存储在某处（或返回它）之后返回，当委托最终被调用时会发生什么？当设置了 out 参数的值时它会写入哪里？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T08:22:43.930

我将其放在单独的答案中，因为您的 EDIT 使您的问题变得非常不同。

稍后我可能会扩展这个答案，因为我有点急于联系客户。

您的编辑表明您需要重新考虑值类型、引用类型以及 var、out、const 和无参数标记的影响。

让我们先做值类型的事情。

值类型的值存在于堆栈中，并具有赋值时复制的行为。（稍后我将尝试包含一个示例）。

当您没有参数标记时，传递给方法（过程或函数）的实际值将被复制到方法内该参数的本地值。因此该方法不会对传递给它的值进行操作，而是对副本进行操作。

当你有 out、var 或 const 时，不会发生复制：该方法将引用传递的实际值。对于 var，它允许更改实际值，对于 const，它不允许。对于 out，您将无法读取实际值，但仍然可以写入实际值。

引用类型的值存在于堆上，因此对于它们来说，是否有 out、var、const 或没有参数标记几乎无关紧要：当您更改某些内容时，您会更改堆上的值。

对于引用类型，当您没有参数标记时，您仍然会得到一个副本，但那是仍然指向堆上的值的引用的副本。

这就是匿名方法变得复杂的地方：它们进行变量捕获。（巴里可能会更好地解释这一点，但我会试一试）在您编辑的情况下，匿名方法将捕获列表的本地副本。匿名方法将在该本地副本上工作，从编译器的角度来看，一切都是花花公子。

但是，您编辑的关键是“它适用于普通参数”和“谁保证在执行匿名方法时引用仍然指向活动对象”的组合。

无论您是否使用匿名方法，这始终是引用参数的问题。

例如这个：

```
procedure TMyClass.AddObject(Value: TObject);
begin
  FValue := Value;
end;

procedure TMyClass.DoSomething();
begin
  ShowMessage(FValue.ToString());
end; 
```

谁保证当有人调用 DoSomething 时，FValue 指向的实例仍然存在？答案是您必须自己保证这一点，当 FValue 的实例死亡时不调用 DoSomething。您的编辑也是如此：当底层实例死亡时，您不应该调用匿名方法。

这是引用计数或垃圾收集解决方案使生活更轻松的领域之一：实例将保持活动状态，直到对它的最后一个引用消失（这可能导致实例的寿命比您最初预期的要长！）。

因此，通过您的编辑，您的问题实际上从匿名方法变为使用引用类型参数和生命周期管理的含义。

希望我的回答可以帮助您进入该领域。

——杰伦

# unit-testing - 使用通用方法进行参数测试

> ID：801153
> 
> 赞同：11
> 
> 时间：2009-04-29T06:43:33.827
> 
> 标签：unit-testing, nunit

在 NUnit 2.5 中，您可以这样做：

```
[TestCase(1,5,7)]
public void TestRowTest(int i, int j, int k)
{
  Assert.AreEqual(13, i+j+k);
} 
```

你可以做参数测试。

但是我想知道您是否可以使用通用测试方法进行参数测试？IE：

```
[TestCase <int>("Message")]
public void TestRowTestGeneric<T>(string msg)
{
  Assert.AreEqual(5, ConvertStrToGenericParameter<T>(msg));
} 
```

或类似的东西。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-07T13:47:49.067

[这是来自 NUnit 2.5链接文本](http://nunit.com/index.php?p=releaseNotes&r=2.5)的发行说明的引用

> 参数化测试方法可能是通用的。NUnit 将根据提供的参数类型推断要使用的正确实现。通用和非通用类都支持通用测试方法。

据此，可以在非泛型类中具有泛型测试方法。如何？

我不太明白杰夫的评论。在 .net 中，泛型既是编译时又是运行时。我们可以通过反射找出方法关联的测试用例属性，找出泛型参数，然后再次使用反射调用泛型方法。它会起作用的，不是吗？

更新：好的，我现在知道怎么做，希望还为时不晚。您需要将泛型类型放在参数列表中。例如：

```
[TestCase((int)5, "5")]
[TestCase((double)2.3, "2.3")]
public void TestRowTestGeneric<T>(T value, string msg)
{
  Assert.AreEqual(value, ConvertStrToGenericParameter<T>(msg));
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-11-15T20:42:43.610

您可以制作自定义 GenericTestCaseAttribute

```
 [Test]
    [GenericTestCase(typeof(MyClass) ,"Some response", TestName = "Test1")]
    [GenericTestCase(typeof(MyClass1) ,"Some response", TestName = "Test2")]
    public void MapWithInitTest<T>(string expectedResponse)
    {
        // Arrange

        // Act
        var response = MyClassUnderTest.MyMethod<T>();

        // Assert
        Assert.AreEqual(expectedResponse, response);
    } 
```

这是 GenericTestCaseAttribute 的实现

```
[AttributeUsage(AttributeTargets.Method, AllowMultiple = true)]
public class GenericTestCaseAttribute : TestCaseAttribute, ITestBuilder
{
    private readonly Type _type;
    public GenericTestCaseAttribute(Type type, params object[] arguments) : base(arguments)
    {
        _type = type;
    }

    IEnumerable<TestMethod> ITestBuilder.BuildFrom(IMethodInfo method, Test suite)
    {
        if (method.IsGenericMethodDefinition && _type != null)
        {
            var gm = method.MakeGenericMethod(_type);
            return BuildFrom(gm, suite);
        }
        return BuildFrom(method, suite);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-24T05:57:28.660

创建一个私有方法并调用它：

```
 [Test]
    public void TypeATest()
    {
        MyTest<TypeA>();
    }

    [Test]
    public void TypeBTest()
    {
        MyTest<TypeB>();
    }

    private void MyTest<T>()
    {
        // do test.
    } 
```

# date - 如何在VB中以mm/dd/yyyy格式打印日期

> ID：801156
> 
> 赞同：6
> 
> 时间：2009-04-29T06:44:40.623
> 
> 标签：date, vb6

我需要以 mm/dd/yyyy 格式打印日期。如果日期是 2009 年 4 月 24 日，则应将日期打印为 2009 年 4 月 24 日。也就是说，还需要零填充。我使用日期函数来获取当前日期……但日期的格式为 m/dd/yyyy……

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-29T07:10:31.063

在即时窗口中测试并为我工作（作为评论输出）

```
Format(Now, "MM/dd/yyyy") '04/29/2009
Format(Date, "MM/dd/yyyy") '04/29/2009
Format(CStr(Now), "MM/dd/yyyy") '04/29/2009
Format(Date$, "MM/dd/yyyy") '04/29/2009
Format(CDate(Date), "MM/dd/yyyy")'04/29/2009 
```

所以无论是字符串还是日期时间都无关紧要。

编辑：看到你对 Fredrik 的评论。将其保存到 db 表时的外观并不重要（列日期格式将是 db 的属性，而不是您的程序（或 vb）的责任）。只需在从数据库中检索值时格式化值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T06:53:57.623

请注意，日期格式化函数中的“/”字符具有特殊含义，作为“日期分隔符”。这意味着 i 可能会被替换为执行程序的当前语言环境的日期分隔符（例如，在瑞典，它将被替换为“-”）。为了确保您确实在输出中得到“/”字符，我认为这会起作用（我没有要验证的 VB 安装）：

```
Format(date, "MM'/'dd'/'yyyy") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-04T00:11:22.873

只是为了记录，转义斜线会起作用
**`Format(dt,"MM\/dd\/yyyy")`**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T06:49:14.140

试试下面的代码：

```
Format(dt,"MM/dd/yyyy") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-16T10:30:03.990

当您以任何格式输入日期时，它将转换默认值，因此请在访问时将您的数据类型日期/时间更改为文本，然后它肯定不会影响您的工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-21T12:54:52.110

我也使用 VB6 并且需要在我的 txt 报告中格式化日期

这对我有用

```
Format$(Now, "yyyy-mm-dd-00.00.00") 
```

但前提是我将日期声明为字符串

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-02-20T06:49:56.617

您也可以根据您的要求尝试这样

```
Dim strDate As String
Dim strDate1() As String
strDate = FormatDateTime(Now, vbGeneralDate)

If InStr(strDate, " ") > 0 Then
    strDate1 = Split(strDate, " ")
    Dim datDate1 As Date
    If Month(strDate1(0)) < 10 Then
        txtDate.Text = "0" + strDate1(0)
    Else
        txtDate.Text = strDate1(0)
    End If

Else

End If 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-02-20T07:35:11.763

将 DateTime 格式化为字符串很简单。我们经常使用像“HH”这样的格式模式。但是像 ToShortDateString 这样的方法也很有用。

例子。首先我们通过 DateTime.Now 获取当前时间。当您执行这些代码示例时，您计算机上的当前 DateTime 将有所不同。这里：使用以 MMM（月份）开头的格式字符串。查看模式如何匹配程序的输出。

**将格式字符串与 DateTime 一起使用的 VB.NET 程序**

Module Module1 Sub Main() ' 使用当前时间。' ... 使用格式。' ...写入控制台。昏暗时间为 DateTime = DateTime.Now 昏暗格式为 String = "MMM ddd d HH:mm yyyy" Console.WriteLine(time.ToString(format)) End Sub End Module

**输出**

2017 年 2 月 21 日星期二 13:26

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-02-12T18:08:35.107

```
strDate = Format(strDate, "yyyy-mm-dd")
BillTime = Format(BillTime, "hh:mm:ss") 
```

# user-interface - Blackberry - 带动画的加载/等待屏幕

> ID：801161
> 
> 赞同：13
> 
> 时间：2009-04-29T06:46:57.827
> 
> 标签：user-interface, blackberry, java-me, loading, wait

有没有办法在黑莓中 显示*带有动画的“加载”屏幕？*

选项：

*   PME动画内容
*   多线程 + 图像集 + 定时器/计数器
*   标准轮辋 API
*   其他方式

有这些吗？

谢谢！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-04T11:03:09.510

费尔明，安东尼+1。谢谢大家，你给了我答案的一部分。
我的最终解决方案：

1.创建或生成（[免费的Ajax加载gif生成器](http://ajaxload.info/)）动画并将其添加到项目中。

2.创建ResponseCallback接口（见[Coderholic-Blackberry WebBitmapField](http://www.coderholic.com/blackberry-webbitmapfield/)）接收线程执行结果：

```
public interface ResponseCallback {
    public void callback(String data);  
} 
```

3.创建一个类来处理您的后台线程作业。就我而言，它是http请求：

```
public class HttpConnector 
{
  static public void HttpGetStream(final String fileToGet,
    final ResponseCallback msgs) {
    Thread t = new Thread(new Runnable() {
      public void run() {
        HttpConnection hc = null;
    DataInputStream din = null;
    try {
      hc = (HttpConnection) Connector.open("http://" + fileToGet);
      hc.setRequestMethod(HttpsConnection.GET);
      din = hc.openDataInputStream();
      ByteVector bv = new ByteVector();
      int i = din.read();
      while (-1 != i) {
        bv.addElement((byte) i);
        i = din.read();
      }
      final String response = new String(bv.toArray(), "UTF-8");
      UiApplication.getUiApplication().invokeLater(
        new Runnable() {
          public void run() {
        msgs.callback(response);
              }
            });
    } 
        catch (final Exception e) {
          UiApplication.getUiApplication().invokeLater(
            new Runnable() {
              public void run() {
                msgs.callback("Exception (" + e.getClass() + "): " 
                  + e.getMessage());
              }
            });
        } 
        finally {
          try {
            din.close();
            din = null;
            hc.close();
            hc = null;
          }
          catch (Exception e) {
          }
        }
      }
    });
  t.start();
  }
} 
```

4.创建WaitScreen（FullScreen和[AnimatedGIFField](http://www.blackberry.com/knowledgecenterpublic/livelink.exe/fetch/2000/348583/800332/800505/800345/How_To_-_Display_an_animated_GIF.html?nodeid=1405903&vernum=0)的混合体，带有ResponseCallback接口）：

```
public class WaitScreen extends FullScreen implements ResponseCallback 
{
    StartScreen startScreen;
    private GIFEncodedImage _image;
    private int _currentFrame;
    private int _width, _height, _xPos, _yPos;
    private AnimatorThread _animatorThread;
    public WaitScreen(StartScreen startScreen) {
        super(new VerticalFieldManager(), Field.NON_FOCUSABLE);
        setBackground(
            BackgroundFactory.createSolidTransparentBackground(
                Color.WHITE, 100));
        this.startScreen = startScreen;
        EncodedImage encImg = 
          GIFEncodedImage.getEncodedImageResource("ajax-loader.gif");
        GIFEncodedImage img = (GIFEncodedImage) encImg;

        // Store the image and it's dimensions.
        _image = img;
        _width = img.getWidth();
        _height = img.getHeight();
        _xPos = (Display.getWidth() - _width) >> 1;
        _yPos = (Display.getHeight() - _height) >> 1;
        // Start the animation thread.
        _animatorThread = new AnimatorThread(this);
        _animatorThread.start();
        UiApplication.getUiApplication().pushScreen(this);
    }

    protected void paint(Graphics graphics) {
        super.paint(graphics);
            // Draw the animation frame.
            graphics
              .drawImage(_xPos, _yPos, _image
                .getFrameWidth(_currentFrame), _image
                  .getFrameHeight(_currentFrame), _image,
                _currentFrame, 0, 0);
    }

    protected void onUndisplay() {
        _animatorThread.stop();
    }

    private class AnimatorThread extends Thread {
        private WaitScreen _theField;
        private boolean _keepGoing = true;
        private int _totalFrames, _loopCount, _totalLoops;
        public AnimatorThread(WaitScreen _theScreen) {
            _theField = _theScreen;
            _totalFrames = _image.getFrameCount();
            _totalLoops = _image.getIterations();

        }

        public synchronized void stop() {
            _keepGoing = false;
        }

        public void run() {
            while (_keepGoing) {
                // Invalidate the field so that it is redrawn.
                UiApplication.getUiApplication().invokeAndWait(
                  new Runnable() {
                    public void run() {
                        _theField.invalidate();
                    }
                });
                try {
                  // Sleep for the current frame delay before
                  // the next frame is drawn.
                  sleep(_image.getFrameDelay(_currentFrame) * 10);
                } catch (InterruptedException iex) {
                } // Couldn't sleep.
                // Increment the frame.
                ++_currentFrame;
                if (_currentFrame == _totalFrames) {
                  // Reset back to frame 0 
                  // if we have reached the end.
                  _currentFrame = 0;
                  ++_loopCount;
                  // Check if the animation should continue.
                  if (_loopCount == _totalLoops) {
                    _keepGoing = false;
                  }
                }
            }
        }

    }

    public void callback(String data) {
        startScreen.updateScreen(data);
        UiApplication.getUiApplication().popScreen(this);
    }
} 
```

5.最后，创建开始屏幕调用HttpConnector.HttpGetStream并显示WaitScreen：

```
public class StartScreen extends MainScreen
{
    public RichTextField text;
    WaitScreen msgs;
    public StartScreen() {       
        text = new RichTextField();
        this.add(text);
    }

    protected void makeMenu(Menu menu, int instance) {
        menu.add(runWait);
        super.makeMenu(menu, instance);
    }

    MenuItem runWait = new MenuItem("wait", 1, 1) {
        public void run() {
            UiApplication.getUiApplication().invokeLater(
                new Runnable() {
                    public void run() {
                        getFile();
                    }
            });             
        }
    };

    public void getFile() {
        msgs = new WaitScreen(this);
        HttpConnector.HttpGetStream(
            "stackoverflow.com/faq", msgs);                 
    }

    //you should implement this method to use callback data on the screen.
    public void updateScreen(String data)
    {
        text.setText(data);
    }
} 
```

**更新：**另一个解决方案[naviina.eu：本机 BlackBerry 应用程序中的 Web2.0/Ajax 样式加载弹出窗口](http://www.naviina.eu/wp/blackberry/loading-class-for-blackberry/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T12:33:14.500

这种事情的基本模式是：

让一个线程运行一个循环来更新一个变量（例如动画图像的帧索引），然后在绘制图像的字段上调用 ​​invalidate（然后休眠一段时间）。无效将排队重新绘制该字段。

在字段的paint方法中，读取变量并绘制图像的适当帧。

伪代码（不完全完整，但给你的想法）：

```
public class AnimatedImageField extends Field implements Runnable {

   private int currentFrame;
   private Bitmap[] animationFrames;

   public void run() {
     while(true) {
       currentFrame = (currentFrame + 1) % animationFrames.length;
       invalidate();
       Thread.sleep(100);
      }
    }

   protected void paint(Graphics g) {
      g.drawBitmap(0, 0, imageWidth, imageHeight, animationFrames[currentFrame], 0, 0);
    }
  } 
```

另请注意，这里我使用了一组位图，但 EncodedImage 允许您将动画 gif 视为一个对象，并包含获取特定帧的方法。

编辑：为了完整性：将其添加到 PopupScreen （如 Fermin 的回答中）或通过直接覆盖 Screen 创建自己的对话框。单独的线程是必要的，因为 RIM API 不是线程安全的：您需要执行与事件线程相关的所有 UI（或在持有事件锁时，请参阅 [BlackBerry UI Threading - The Very Basics](http://www.thinkingblackberry.com/archives/182)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-09-27T10:18:59.250

这是加载屏幕的简单代码....

```
 HorizontalFieldManager popHF = new HorizontalFieldManager();
                popHF.add(new CustomLabelField("Pls wait..."));
                final PopupScreen waitScreen = new PopupScreen(popHF);
                new Thread()
                {
                    public void run() 
                    {

                        synchronized (UiApplication.getEventLock()) 
                        {
                            UiApplication.getUiApplication().pushScreen(waitScreen);
                        }
                       //Here Some Network Call 

                       synchronized (UiApplication.getEventLock()) 
                        {
                            UiApplication.getUiApplication().popScreen(waitScreen);
                        }
                     }
                 }.start(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-29T09:17:41.007

如果它只是一个动画，你可以在弹出窗口上显示一个[动画 gif](http://www.blackberry.com/knowledgecenterpublic/livelink.exe/fetch/2000/348583/800332/800505/800345/How_To_-_Display_an_animated_GIF.html?nodeid=1405903&vernum=0)并在加载操作完成时关闭它吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-29T07:54:17.180

最简单的方法可能是使用标准 GaugeField，设置样式 GaugeField.PERCENT。这会给你一个进度条。将此添加到 PopupScreen 中，它将位于您的内容之上。就像是..

```
private GaugeField _gaugeField;
private PopupScreen _popup;

public ProgressBar() {    
    DialogFieldManager manager = new DialogFieldManager();
    _popup = new PopupScreen(manager);
    _gaugeField = new GaugeField(null, 0, 100, 0, GaugeField.PERCENT);    
    manager.addCustomField(_gaugeField);
} 
```

然后有一个更新方法，它将使用 _gaugeField.setValue(newValue); 更新进度条。

我通常从正在执行工作的任何线程调用它（在您的情况下加载，每次操作完成时，进度条都会更新。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-09-30T08:23:58.017

我建议看看这个简单的实现。我喜欢这个，但从未使用过。可能对你有帮助。

[链接文本](http://www.naviina.eu/wp/blackberry/loading-class-for-blackberry/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-08-17T12:56:56.960

如果您至少使用 BB OS 6.0，ActivityIndi​​cator 是一个不错的选择。

[http://www.brighthub.com/mobile/blackberry-platform/articles/94258.aspx](http://www.brighthub.com/mobile/blackberry-platform/articles/94258.aspx)

[http://docs.blackberry.com/en/developers/deliverables/17966/Screen_APIs_1245069_11.jsp](http://docs.blackberry.com/en/developers/deliverables/17966/Screen_APIs_1245069_11.jsp)

# sql - 用于查找无效电子邮件地址的 Sql 脚本

> ID：801166
> 
> 赞同：83
> 
> 时间：2009-04-29T06:48:16.967
> 
> 标签：sql, validation, email

数据导入是从访问数据库完成的，并且没有对电子邮件地址字段进行验证。有没有人有一个可以返回无效电子邮件地址列表（缺少@等）的 sql 脚本。

* * *

## 回答 #1

> 赞同：196
> 
> 时间：2009-04-29T06:53:15.957

```
SELECT * FROM people WHERE email NOT LIKE '%_@__%.__%' 
```

任何更复杂的东西都可能会返回假阴性并运行得更慢。

在代码中验证电子邮件地址几乎是不可能的。

编辑：相关问题

*   我前段时间回答过一个类似的问题：[TSQL Email Validation (without regex)](https://stackoverflow.com/questions/229824/tsql-email-validation-without-regex)
*   [T-SQL：检查电子邮件格式](https://stackoverflow.com/questions/423606/t-sql-checking-for-email-format)
*   [正则表达式识别电子邮件地址很难？](https://stackoverflow.com/questions/156430/regexp-recognition-of-email-address-hard)
*   [许多其他堆栈溢出问题](http://www.google.com/search?q=validation%20email%20address%20site%3Astackoverflow.com)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-04-29T06:51:31.887

这是一个快速简便的解决方案：

```
CREATE FUNCTION dbo.vaValidEmail(@EMAIL varchar(100))

RETURNS bit as
BEGIN     
  DECLARE @bitRetVal as Bit
  IF (@EMAIL <> '' AND @EMAIL NOT LIKE '_%@__%.__%')
     SET @bitRetVal = 0  -- Invalid
  ELSE 
    SET @bitRetVal = 1   -- Valid
  RETURN @bitRetVal
END 
```

然后您可以使用以下函数查找所有行：

```
SELECT * FROM users WHERE dbo.vaValidEmail(email) = 0 
```

如果您对在数据库中创建函数不满意，可以直接在查询中使用 LIKE 子句：

```
SELECT * FROM users WHERE email NOT LIKE '_%@__%.__%' 
```

[来源](http://www.vandamme.com/blog.aspx?id=624&blogid=194)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-07-06T12:32:10.007

我发现这个简单的 T-SQL 查询对于返回有效的电子邮件地址很有用

```
SELECT email
FROM People
WHERE email LIKE '%_@__%.__%' 
    AND PATINDEX('%[^a-z,0-9,@,.,_]%', REPLACE(email, '-', 'a')) = 0 
```

PATINDEX 位消除所有包含不在允许的 az、0-9、'@'、'.'、'_' 和 '-' 字符集中的字符的电子邮件地址。

可以反过来做你想做的事情：

```
SELECT email
FROM People
WHERE NOT (email LIKE '%_@__%.__%' 
    AND PATINDEX('%[^a-z,0-9,@,.,_]%', REPLACE(email, '-', 'a')) = 0) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-03-22T06:21:44.957

```
select
    email 
from loginuser where
patindex ('%[ &'',":;!+=\/()<>]*%', email) > 0  -- Invalid characters
or patindex ('[@.-_]%', email) > 0   -- Valid but cannot be starting character
or patindex ('%[@.-_]', email) > 0   -- Valid but cannot be ending character
or email not like '%@%.%'   -- Must contain at least one @ and one .
or email like '%..%'        -- Cannot have two periods in a row
or email like '%@%@%'       -- Cannot have two @ anywhere
or email like '%.@%' or email like '%@.%' -- Cant have @ and . next to each other
or email like '%.cm' or email like '%.co' -- Unlikely. Probably typos 
or email like '%.or' or email like '%.ne' -- Missing last letter 
```

这对我有用。必须应用 rtrim 和 ltrim 以避免误报。

来源：[http ://sevenwires.blogspot.com/2008/09/sql-how-to-find-invalid-email-in-sql.html](http://sevenwires.blogspot.com/2008/09/sql-how-to-find-invalid-email-in-sql.html)

Postgres 版本：

```
select user_guid, user_guid email_address, creation_date, email_verified, active
from user_data where
length(substring (email_address from '%[ &'',":;!+=\/()<>]%')) > 0  -- Invalid characters
or length(substring (email_address from '[@.-_]%')) > 0   -- Valid but cannot be starting character
or length(substring (email_address from '%[@.-_]')) > 0   -- Valid but cannot be ending character
or email_address not like '%@%.%'   -- Must contain at least one @ and one .
or email_address like '%..%'        -- Cannot have two periods in a row
or email_address like '%@%@%'       -- Cannot have two @ anywhere
or email_address like '%.@%' or email_address like '%@.%' -- Cant have @ and . next to each other
or email_address like '%.cm' or email_address like '%.co' -- Unlikely. Probably typos 
or email_address like '%.or' or email_address like '%.ne' -- Missing last letter
; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-12-13T03:57:10.987

**MySQL**

```
SELECT * FROM `emails` WHERE lower(`email`)
NOT REGEXP '[-a-z0-9~!$%^&*_=+}{\\\'?]+(\\.[-a-z0-9~!$%^&*_=+}{\\\'?]+)*@([a-z0-9_][-a-z0-9_]*(\\.[-a-z0-9_]+)*\\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}))(:[0-9]{1,5})?' 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-11-17T12:37:42.147

在 sql server 2016 及更高版本上

```
CREATE FUNCTION [DBO].[F_IsEmail] (
 @EmailAddr varchar(360) -- Email address to check
)   RETURNS BIT -- 1 if @EmailAddr is a valid email address

AS BEGIN
DECLARE @AlphabetPlus VARCHAR(255)
      , @Max INT -- Length of the address
      , @Pos INT -- Position in @EmailAddr
      , @OK BIT  -- Is @EmailAddr OK
-- Check basic conditions
IF @EmailAddr IS NULL 
   OR @EmailAddr NOT LIKE '[0-9a-zA-Z]%@__%.__%' 
   OR @EmailAddr LIKE '%@%@%' 
   OR @EmailAddr LIKE '%..%' 
   OR @EmailAddr LIKE '%.@' 
   OR @EmailAddr LIKE '%@.' 
   OR @EmailAddr LIKE '%@%.-%' 
   OR @EmailAddr LIKE '%@%-.%' 
   OR @EmailAddr LIKE '%@-%' 
   OR CHARINDEX(' ',LTRIM(RTRIM(@EmailAddr))) > 0
       RETURN(0)

declare @AfterLastDot varchar(360);
declare @AfterArobase varchar(360);
declare @BeforeArobase varchar(360);
declare @HasDomainTooLong bit=0;

--Control des longueurs et autres incoherence
set @AfterLastDot=REVERSE(SUBSTRING(REVERSE(@EmailAddr),0,CHARINDEX('.',REVERSE(@EmailAddr))));
if  len(@AfterLastDot) not between 2 and 17
RETURN(0);

set @AfterArobase=REVERSE(SUBSTRING(REVERSE(@EmailAddr),0,CHARINDEX('@',REVERSE(@EmailAddr))));
if len(@AfterArobase) not between 2 and 255
RETURN(0);

select top 1 @BeforeArobase=value from  string_split(@EmailAddr, '@');
if len(@AfterArobase) not between 2 and 255
RETURN(0);

--Controle sous-domain pas plus grand que 63
select top 1 @HasDomainTooLong=1 from string_split(@AfterArobase, '.') where LEN(value)>63
if @HasDomainTooLong=1
return(0);

--Control de la partie locale en detail
SELECT @AlphabetPlus = 'abcdefghijklmnopqrstuvwxyz01234567890!#$%&‘*+-/=?^_`.{|}~'
     , @Max = LEN(@BeforeArobase)
     , @Pos = 0
     , @OK = 1

WHILE @Pos < @Max AND @OK = 1 BEGIN
    SET @Pos = @Pos + 1
    IF @AlphabetPlus NOT LIKE '%' + SUBSTRING(@BeforeArobase, @Pos, 1) + '%' 
        SET @OK = 0
END

if @OK=0
RETURN(0);

--Control de la partie domaine en detail
SELECT @AlphabetPlus = 'abcdefghijklmnopqrstuvwxyz01234567890-.'
     , @Max = LEN(@AfterArobase)
     , @Pos = 0
     , @OK = 1

WHILE @Pos < @Max AND @OK = 1 BEGIN
    SET @Pos = @Pos + 1
    IF @AlphabetPlus NOT LIKE '%' + SUBSTRING(@AfterArobase, @Pos, 1) + '%' 
        SET @OK = 0
END

if @OK=0
RETURN(0);

return(1);

END 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-12-04T11:31:38.160

我发现这种方法更直观：

```
CREATE FUNCTION [dbo].[ContainsVailidEmail] (@Input varchar(250))
RETURNS bit
AS
BEGIN
  RETURN CASE
    WHEN @Input LIKE '%_@__%.__%' THEN 1
    ELSE 0
  END
END 
```

我使用以下方法调用它：

```
SELECT [dbo].[ContainsVailidEmail] (Email) FROM [dbo].[User] 
```

或者

如果您只打算使用一次，那么为什么不将其用作计算列，具有以下规范：

```
(case when [Email] like '%_@__%.__%' then (1) else (0) end) 
```

然后您可以直接使用它而无需调用函数。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-10-23T06:48:46.330

```
SELECT Email FROM Employee WHERE NOT REGEXP_LIKE(Email, ‘[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}’, ‘i’); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-12-31T11:29:15.390

我提出我的功能：

```
CREATE FUNCTION [REC].[F_IsEmail] (
 @EmailAddr varchar(360) -- Email address to check
)   RETURNS BIT -- 1 if @EmailAddr is a valid email address

AS BEGIN
DECLARE @AlphabetPlus VARCHAR(255)
      , @Max INT -- Length of the address
      , @Pos INT -- Position in @EmailAddr
      , @OK BIT  -- Is @EmailAddr OK
-- Check basic conditions
IF @EmailAddr IS NULL 
   OR @EmailAddr NOT LIKE '[0-9a-zA-Z]%@__%.__%' 
   OR @EmailAddr LIKE '%@%@%' 
   OR @EmailAddr LIKE '%..%' 
   OR @EmailAddr LIKE '%.@' 
   OR @EmailAddr LIKE '%@.' 
   OR @EmailAddr LIKE '%@%.-%' 
   OR @EmailAddr LIKE '%@%-.%' 
   OR @EmailAddr LIKE '%@-%' 
   OR CHARINDEX(' ',LTRIM(RTRIM(@EmailAddr))) > 0
       RETURN(0)

declare @AfterLastDot varchar(360);
declare @AfterArobase varchar(360);
declare @BeforeArobase varchar(360);
declare @HasDomainTooLong bit=0;

--Control des longueurs et autres incoherence
set @AfterLastDot=REVERSE(SUBSTRING(REVERSE(@EmailAddr),0,CHARINDEX('.',REVERSE(@EmailAddr))));
if  len(@AfterLastDot) not between 2 and 17
RETURN(0);

set @AfterArobase=REVERSE(SUBSTRING(REVERSE(@EmailAddr),0,CHARINDEX('@',REVERSE(@EmailAddr))));
if len(@AfterArobase) not between 2 and 255
RETURN(0);

select top 1 @BeforeArobase=value from  string_split(@EmailAddr, '@');
if len(@AfterArobase) not between 2 and 255
RETURN(0);

--Controle sous-domain pas plus grand que 63
select top 1 @HasDomainTooLong=1 from string_split(@AfterArobase, '.') where LEN(value)>63
if @HasDomainTooLong=1
return(0);

--Control de la partie locale en detail
SELECT @AlphabetPlus = 'abcdefghijklmnopqrstuvwxyz01234567890!#$%&‘*+-/=?^_`.{|}~'
     , @Max = LEN(@BeforeArobase)
     , @Pos = 0
     , @OK = 1

WHILE @Pos < @Max AND @OK = 1 BEGIN
    SET @Pos = @Pos + 1
    IF @AlphabetPlus NOT LIKE '%' + SUBSTRING(@BeforeArobase, @Pos, 1) + '%' 
        SET @OK = 0
END

if @OK=0
RETURN(0);

--Control de la partie domaine en detail
SELECT @AlphabetPlus = 'abcdefghijklmnopqrstuvwxyz01234567890-.'
     , @Max = LEN(@AfterArobase)
     , @Pos = 0
     , @OK = 1

WHILE @Pos < @Max AND @OK = 1 BEGIN
    SET @Pos = @Pos + 1
    IF @AlphabetPlus NOT LIKE '%' + SUBSTRING(@AfterArobase, @Pos, 1) + '%' 
        SET @OK = 0
END

if @OK=0
RETURN(0);

return(1);

END 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-02-06T11:16:50.077

```
SELECT EmailAddress AS ValidEmail
FROM Contacts
WHERE EmailAddress LIKE '%_@__%.__%'
        AND PATINDEX('%[^a-z,0-9,@,.,_,\-]%', EmailAddress) = 0
GO 
```

请查看此链接：[https ://blog.sqlauthority.com/2017/11/12/validate-email-address-sql-server-interview-question-week-147/](https://blog.sqlauthority.com/2017/11/12/validate-email-address-sql-server-interview-question-week-147/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-02-14T01:28:01.860

```
sel 'unismankur@yahoo#.co.in' as Email, 
case 
    when Email not like  '%@xx%' 
    AND  Email like  '%@%' 
    AND  CHAR_LENGTH(
     oTranslate(
      trim( Email),
      '._-@0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ',
      '')
     ) = 0
     then 'N' else 'Y'  end as Invalid_Email_Ind; 
```

这对我来说非常有效。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-06-16T05:56:18.923

```
select * from users 
WHERE NOT
(     CHARINDEX(' ',LTRIM(RTRIM([Email]))) = 0 
AND  LEFT(LTRIM([Email]),1) <> '@' 
AND  RIGHT(RTRIM([Email]),1) <> '.' 
AND  CHARINDEX('.',[Email],CHARINDEX('@',[Email])) - CHARINDEX('@',[Email]) > 1 
AND  LEN(LTRIM(RTRIM([Email]))) - LEN(REPLACE(LTRIM(RTRIM([Email])),'@','')) = 1 
AND  CHARINDEX('.',REVERSE(LTRIM(RTRIM([Email])))) >= 3 
AND  (CHARINDEX('.@',[Email]) = 0 AND CHARINDEX('..',[Email]) = 0) 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2017-07-03T10:31:47.377

```
go

create proc GetEmail

@name varchar(22),
@gmail varchar(22)

as

begin

declare @a varchar(22)

set select @a=substring(@gmail,charindex('@',@gmail),len(@gmail)-charindex('@',@gmail)+1)

if (@a = 'gmail.com)

insert into table_name values(@name,@gmail)

else

print 'please enter valid email address'

end 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2014-10-28T14:46:01.540

我知道这篇文章很旧，但经过 3 个月的时间，我遇到了各种电子邮件组合，能够制作这个 sql 来验证电子邮件 ID。

```
CREATE FUNCTION [dbo].[isValidEmailFormat]
(
    @EmailAddress varchar(500)
)
RETURNS bit
AS
BEGIN
    DECLARE @Result bit

    SET @EmailAddress = LTRIM(RTRIM(@EmailAddress));
    SELECT @Result =
    CASE WHEN
    CHARINDEX(' ',LTRIM(RTRIM(@EmailAddress))) = 0
    AND LEFT(LTRIM(@EmailAddress),1) <> '@'
    AND RIGHT(RTRIM(@EmailAddress),1) <> '.'
    AND LEFT(LTRIM(@EmailAddress),1) <> '-'
    AND CHARINDEX('.',@EmailAddress,CHARINDEX('@',@EmailAddress)) - CHARINDEX('@',@EmailAddress) > 2    
    AND LEN(LTRIM(RTRIM(@EmailAddress))) - LEN(REPLACE(LTRIM(RTRIM(@EmailAddress)),'@','')) = 1
    AND CHARINDEX('.',REVERSE(LTRIM(RTRIM(@EmailAddress)))) >= 3
    AND (CHARINDEX('.@',@EmailAddress) = 0 AND CHARINDEX('..',@EmailAddress) = 0)
    AND (CHARINDEX('-@',@EmailAddress) = 0 AND CHARINDEX('..',@EmailAddress) = 0)
    AND (CHARINDEX('_@',@EmailAddress) = 0 AND CHARINDEX('..',@EmailAddress) = 0)
    AND ISNUMERIC(SUBSTRING(@EmailAddress, 1, 1)) = 0
    AND CHARINDEX(',', @EmailAddress) = 0
    AND CHARINDEX('!', @EmailAddress) = 0
    AND CHARINDEX('-.', @EmailAddress)=0
    AND CHARINDEX('%', @EmailAddress)=0
    AND CHARINDEX('#', @EmailAddress)=0
    AND CHARINDEX('$', @EmailAddress)=0
    AND CHARINDEX('&', @EmailAddress)=0
    AND CHARINDEX('^', @EmailAddress)=0
    AND CHARINDEX('''', @EmailAddress)=0
    AND CHARINDEX('\', @EmailAddress)=0
    AND CHARINDEX('/', @EmailAddress)=0
    AND CHARINDEX('*', @EmailAddress)=0
    AND CHARINDEX('+', @EmailAddress)=0
    AND CHARINDEX('(', @EmailAddress)=0
    AND CHARINDEX(')', @EmailAddress)=0
    AND CHARINDEX('[', @EmailAddress)=0
    AND CHARINDEX(']', @EmailAddress)=0
    AND CHARINDEX('{', @EmailAddress)=0
    AND CHARINDEX('}', @EmailAddress)=0
    AND CHARINDEX('?', @EmailAddress)=0
    AND CHARINDEX('<', @EmailAddress)=0
    AND CHARINDEX('>', @EmailAddress)=0
    AND CHARINDEX('=', @EmailAddress)=0
    AND CHARINDEX('~', @EmailAddress)=0
    AND CHARINDEX('`', @EmailAddress)=0 
    AND CHARINDEX('.', SUBSTRING(@EmailAddress, CHARINDEX('@', @EmailAddress)+1, 2))=0
    AND CHARINDEX('.', SUBSTRING(@EmailAddress, CHARINDEX('@', @EmailAddress)-1, 2))=0
    AND LEN(SUBSTRING(@EmailAddress, 0, CHARINDEX('@', @EmailAddress)))>1
    AND CHARINDEX('.', REVERSE(@EmailAddress)) > 2
    AND CHARINDEX('.', REVERSE(@EmailAddress)) < 5  
    THEN 1 ELSE  0 END

    RETURN @Result
END 
```

欢迎任何建议！

* * *

## 回答 #15

> 赞同：-10
> 
> 时间：2013-03-22T12:51:37.267

```
DELETE 
FROM `contatti` 
WHERE `EMail` NOT LIKE "%.it" 
  AND `EMail` NOT LIKE "%.com" 
  AND `EMail` NOT LIKE "%.fr"  
  AND `EMail` NOT LIKE "%.net"  
  AND `EMail` NOT LIKE "%.ru"  
  AND `EMail` NOT LIKE "%.eu"  
  AND `EMail` NOT LIKE "%.org"  
  AND `EMail` NOT LIKE "%.edu"  
  AND `EMail` NOT LIKE "%.uk"  
  AND `EMail` NOT LIKE "%.de"  
  AND `EMail` NOT LIKE "%.biz"  
  AND `EMail` NOT LIKE "%.ch"  
  AND `EMail` NOT LIKE "%.bg"  
  AND `EMail` NOT LIKE "%.info"  
  AND `EMail` NOT LIKE "%.br"  
  AND `EMail` NOT LIKE "%.pt"  
  AND `EMail` NOT LIKE "%.za"  
  AND `EMail` NOT LIKE "%.vn"  
  AND `EMail` NOT LIKE "%.es"  
  AND `EMail` NOT LIKE "%.in"  
  AND `EMail` NOT LIKE "%.dk"  
  AND `EMail` NOT LIKE "%.ni"  
  AND `EMail` NOT LIKE "%.ar" 
```

并放置您想要的所有扩展名

# clickonce - ClickOnce 受信任的根证书颁发机构

> ID：801183
> 
> 赞同：1
> 
> 时间：2009-04-29T06:52:36.643
> 
> 标签：clickonce, certificate-authority

我可能还有另一个关于 SSL 的问题。

我有一个智能客户端，我使用 ClickOnce 部署它。在这个 Smart Client 应用程序中，我调用了 HTTPS Web 服务。我需要安装受信任的根证书颁发机构才能访问此 HTTPS Web 服务。

假设我想完全保留它“ClickOnce”，这意味着我不想在客户端机器上做任何事情，除了运行 ClickOnce = 我不想在客户端机器上手动安装证书（或不是），但我想在 Smart Client 之前安装它。我会将它包含在包中，并且将是第一个要安装的东西。

我的问题是：

正如我在互联网上阅读的那样，如果没有客户端计算机上的管理员权限，我就无法安装“受信任的根证书颁发机构”

这样对吗？

如果它是正确的，您是否看到了实现此目标的另一种解决方案，或者这是不可能的？

提前谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T13:19:44.583

> 这样对吗？

是的，假设你的意思是“这对吗？” 您不能在没有管理员权限的客户端计算机上安装证书，因为这会破坏证书概念的整个目的。如果没有用户的明确操作，不受信任的证书不能神奇地变得受信任。

> 我想，如果我从已经在受信任的根证书颁发机构（Thawte，...）中的某个根证书颁发机构获得 CA，它应该可以工作吗？

我假设“CA”实际上是指“证书”。CA 代表证书颁发机构。Thawte、Verisign 等是证书颁发机构。您从证书颁发机构获得证书。答案是肯定的，这会奏效，因为（你说过）他们已经受到世界上几乎每个人的信任。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-13T20:27:59.307

我不是 100% 这对你有用，但是对于我们通过我们的 web 服务与 https 进行通信的单元测试（在开发机器上没有 CA 颁发的证书），我们这样做：

在客户端，我们称之为静态方法：（我们正在使用带有 WSE3 的 Web 服务，不确定这是否依赖于此）

```
 private static void DisableCertificateChainCheckingForTestCertificateCompatibility()
    {
        ServicePointManager.ServerCertificateValidationCallback = 
           new RemoteCertificateValidationCallback(
              ValidateServerCertificate);
    }

    internal static bool ValidateServerCertificate(
        object sender,
        X509Certificate certificate,
        X509Chain chain,
        SslPolicyErrors sslPolicyErrors)
    {
        if (sslPolicyErrors == SslPolicyErrors.None)
        {
            return true;
        }

        //Allow untrusted machines
        if (sslPolicyErrors == SslPolicyErrors.RemoteCertificateChainErrors)
        {
            return true;
        }

        // Do not allow this client to communicate with unauthenticated servers.
        return false;
    } 
```

仔细检查 MSDN，我发现我曾经直接从这里获取此代码：http: [//msdn.microsoft.com/en-us/library/system.net.security.remotecertificatevalidationcallback.aspx](http://msdn.microsoft.com/en-us/library/system.net.security.remotecertificatevalidationcallback.aspx)

神速！

# eclipse - 在 Eclipse 中调试时修改/查看静态变量

> ID：801193
> 
> 赞同：121
> 
> 时间：2009-04-29T06:55:41.237
> 
> 标签：eclipse, debugging, variables, static

根据问题。在调试视图中，有变量框架。它显示了当前对象的所有成员变量的值，以及所有的局部变量，但它不显示对象类的任何静态变量。

我如何到达这些？

一些谷歌搜索建议我按下工具栏上的按钮，但变量框架的工具栏上除了“显示类型名称”、“逻辑结构”和“全部折叠”（Eclipse 3.4.2）之外什么都没有。

有什么建议吗？

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2009-04-29T07:14:00.663

在调试变量视图中，它们是视图右侧的箭头按钮。此按钮的工具提示是`Menu`。

单击此按钮时，将显示一个下拉菜单，您可以在其中选择

`Java`->`Show static variables`

注意：您不必重新启动 Eclipse。

![在此处输入图像描述](https://i.stack.imgur.com/2iIJL.png)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-29T07:14:30.757

只需将鼠标光标放在代码中的静态变量上，您就会看到分配的值。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-08-14T06:37:07.927

您可以查看静态变量，也可以在运行时进行编辑。单击指向downword 的小箭头。见下图 [![在此处输入图像描述](https://i.stack.imgur.com/mHdm8.jpg)](https://i.stack.imgur.com/mHdm8.jpg)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-29T07:01:33.533

`Window`-> `Show View`-> `Other`-> `Debug`-> `Expressions`-> 右击 Window -> `Add Watch Expression...`-> 输入你要查看的变量名

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-04T10:38:48.013

您也可以尝试在监视窗口中编写表达式，例如 self::$value

# c++ - 用于内存缓冲区或文件指针的 OpenCV

> ID：801199
> 
> 赞同：20
> 
> 时间：2009-04-29T07:02:02.080
> 
> 标签：c++, memory, opencv

openCV cvLoadImage 和 cvSaveImage 中的两个函数接受文件路径作为参数。

例如，当保存图像时，它是**cvSaveImage("/tmp/output.jpg", dstIpl)**并写入磁盘。

有没有办法给这个已经在内存中的缓冲区提供数据？因此，输出图像将在内存中，而不是磁盘写入。

我也想知道这对于 cvSaveImage 和 cvLoadImage （读取和写入内存缓冲区）。谢谢！

* * *

我的目标是将文件的编码（jpeg）版本存储在内存中。cvLoadImage 也是如此，我想将内存中的 jpeg 加载为 IplImage 格式。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-03-29T17:33:28.620

这对我有用

```
// decode jpg (or other image from a pointer)
// imageBuf contains the jpg image
    cv::Mat imgbuf = cv::Mat(480, 640, CV_8U, imageBuf);
    cv::Mat imgMat = cv::imdecode(imgbuf, CV_LOAD_IMAGE_COLOR);
// imgMat is the decoded image

// encode image into jpg
    cv::vector<uchar> buf;
    cv::imencode(".jpg", imgMat, buf, std::vector<int>() );
// encoded image is now in buf (a vector)
    imageBuf = (unsigned char *) realloc(imageBuf, buf.size());
    memcpy(imageBuf, &buf[0], buf.size());
//  size of imageBuf is buf.size(); 
```

我被问及 C 版本而不是 C++：

```
#include <opencv/cv.h>
#include <opencv/highgui.h>

int
main(int argc, char **argv)
{
    char *cvwin = "camimg";

    cvNamedWindow(cvwin, CV_WINDOW_AUTOSIZE);

    // setup code, initialization, etc ...
    [ ... ]

    while (1) {      
        // getImage was my routine for getting a jpeg from a camera
        char *img = getImage(fp);
        CvMat mat;

   // substitute 640/480 with your image width, height 
        cvInitMatHeader(&mat, 640, 480, CV_8UC3, img, 0);
        IplImage *cvImg = cvDecodeImage(&mat, CV_LOAD_IMAGE_COLOR);
        cvShowImage(cvwin, cvImg);
        cvReleaseImage(&cvImg);
        if (27 == cvWaitKey(1))         // exit when user hits 'ESC' key
        break;
    }

    cvDestroyWindow(cvwin);
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-07T01:04:17.787

SVN 版本的库中有几个未记录的函数：

```
CV_IMPL CvMat* cvEncodeImage( const char* ext, 
                              const CvArr* arr, const int* _params )

CV_IMPL IplImage* cvDecodeImage( const CvMat* _buf, int iscolor ) 
```

最新签入消息表明它们用于 bmp、png、ppm 和 tiff 的本机编码/解码（仅编码）。

或者，您可以使用标准图像编码库（例如 libjpeg）并操作 IplImage 中的数据以匹配编码库的输入结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T03:37:32.777

我假设你在linux中工作。来自 libjpeg.doc：

> JPEG 压缩操作的大致轮廓是：
> 分配和初始化 JPEG 压缩对象
> 指定压缩数据的目的地（例如，文件）
> 设置压缩参数，包括图像大小和色彩空间
> 
> jpeg_start_compress(...);
> while (扫描线仍有待写入)
> jpeg_write_scanlines(...);
> 
> jpeg_finish_compress(...);
> 释放 JPEG 压缩对象

做你想做的事情的真正诀窍是提供一个在 jpeglib.h 中定义的自定义“数据目标（或源）管理器”：

```
struct jpeg_destination_mgr {
  JOCTET * next_output_byte;    /* => next byte to write in buffer */
  size_t free_in_buffer;        /* # of byte spaces remaining in buffer */

  JMETHOD(void, init_destination, (j_compress_ptr cinfo));
  JMETHOD(boolean, empty_output_buffer, (j_compress_ptr cinfo));
  JMETHOD(void, term_destination, (j_compress_ptr cinfo));
}; 
```

基本上进行设置，以便您的源和/或目标是您想要的内存缓冲区，您应该一切顺利。

顺便说一句，这篇文章可能会好很多，但坦率地说，libjpeg62 文档非常棒。只需 apt-get libjpeg62-dev 并阅读 libjpeg.doc 并查看 example.c。如果您遇到问题并且无法解决问题，请再次发布，我相信有人会提供帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T01:19:10.713

这是一个间接的答案...

过去，我直接使用[libpng](http://www.libpng.org/pub/png/libpng.html)和[libjpeg](http://www.ijg.org/)来完成此操作。它们有一个足够低级的 API，您可以使用内存缓冲区而不是文件缓冲区进行读写。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-25T04:55:08.600

从内存缓冲区加载文件所需的只是一个不同的 src 管理器 (libjpeg)。我在 Ubuntu 8.10 中测试了以下代码。

```
/******************************** First define mem buffer function bodies **************/
<pre>
/*
 * memsrc.c
 *
 * Copyright (C) 1994-1996, Thomas G. Lane.
 * This file is part of the Independent JPEG Group's software.
 * For conditions of distribution and use, see the accompanying README file.
 *
 * This file contains decompression data source routines for the case of
 * reading JPEG data from a memory buffer that is preloaded with the entire
 * JPEG file.  This would not seem especially useful at first sight, but
 * a number of people have asked for it.
 * This is really just a stripped-down version of jdatasrc.c.  Comparison
 * of this code with jdatasrc.c may be helpful in seeing how to make
 * custom source managers for other purposes.
 */

/* this is not a core library module, so it doesn't define JPEG_INTERNALS */
//include "jinclude.h"
include "jpeglib.h"
include "jerror.h"

/* Expanded data source object for memory input */

typedef struct {
  struct jpeg_source_mgr pub;   /* public fields */

  JOCTET eoi_buffer[2];     /* a place to put a dummy EOI */
} my_source_mgr;

typedef my_source_mgr * my_src_ptr;

/*
 * Initialize source --- called by jpeg_read_header
 * before any data is actually read.
 */

METHODDEF(void)
init_source (j_decompress_ptr cinfo)
{
  /* No work, since jpeg_memory_src set up the buffer pointer and count.
   * Indeed, if we want to read multiple JPEG images from one buffer,
   * this *must* not do anything to the pointer.
   */
}

/*
 * Fill the input buffer --- called whenever buffer is emptied.
 *
 * In this application, this routine should never be called; if it is called,
 * the decompressor has overrun the end of the input buffer, implying we
 * supplied an incomplete or corrupt JPEG datastream.  A simple error exit
 * might be the most appropriate response.
 *
 * But what we choose to do in this code is to supply dummy EOI markers
 * in order to force the decompressor to finish processing and supply
 * some sort of output image, no matter how corrupted.
 */

METHODDEF(boolean)
fill_input_buffer (j_decompress_ptr cinfo)
{
  my_src_ptr src = (my_src_ptr) cinfo->src;

  WARNMS(cinfo, JWRN_JPEG_EOF);

  /* Create a fake EOI marker */
  src->eoi_buffer[0] = (JOCTET) 0xFF;
  src->eoi_buffer[1] = (JOCTET) JPEG_EOI;
  src->pub.next_input_byte = src->eoi_buffer;
  src->pub.bytes_in_buffer = 2;

  return TRUE;
}

/*
 * Skip data --- used to skip over a potentially large amount of
 * uninteresting data (such as an APPn marker).
 *
 * If we overrun the end of the buffer, we let fill_input_buffer deal with
 * it.  An extremely large skip could cause some time-wasting here, but
 * it really isn't supposed to happen ... and the decompressor will never
 * skip more than 64K anyway.
 */

METHODDEF(void)
skip_input_data (j_decompress_ptr cinfo, long num_bytes)
{
  my_src_ptr src = (my_src_ptr) cinfo->src;

  if (num_bytes > 0) {
    while (num_bytes > (long) src->pub.bytes_in_buffer) {
      num_bytes -= (long) src->pub.bytes_in_buffer;
      (void) fill_input_buffer(cinfo);
      /* note we assume that fill_input_buffer will never return FALSE,
       * so suspension need not be handled.
       */
    }
    src->pub.next_input_byte += (size_t) num_bytes;
    src->pub.bytes_in_buffer -= (size_t) num_bytes;
  }
}

/*
 * An additional method that can be provided by data source modules is the
 * resync_to_restart method for error recovery in the presence of RST markers.
 * For the moment, this source module just uses the default resync method
 * provided by the JPEG library.  That method assumes that no backtracking
 * is possible.
 */

/*
 * Terminate source --- called by jpeg_finish_decompress
 * after all data has been read.  Often a no-op.
 *
 * NB: *not* called by jpeg_abort or jpeg_destroy; surrounding
 * application must deal with any cleanup that should happen even
 * for error exit.
 */

METHODDEF(void)
term_source (j_decompress_ptr cinfo)
{
  /* no work necessary here */
}

/*
 * Prepare for input from a memory buffer.
 */

GLOBAL(void)
jpeg_memory_src (j_decompress_ptr cinfo, const JOCTET * buffer, size_t bufsize)
{
  my_src_ptr src;

  /* The source object is made permanent so that a series of JPEG images
   * can be read from a single buffer by calling jpeg_memory_src
   * only before the first one.
   * This makes it unsafe to use this manager and a different source
   * manager serially with the same JPEG object.  Caveat programmer.
   */
  if (cinfo->src == NULL) { /* first time for this JPEG object? */
    cinfo->src = (struct jpeg_source_mgr *)
      (*cinfo->mem->alloc_small) ((j_common_ptr) cinfo, JPOOL_PERMANENT,
                  SIZEOF(my_source_mgr));
  }

  src = (my_src_ptr) cinfo->src;
  src->pub.init_source = init_source;
  src->pub.fill_input_buffer = fill_input_buffer;
  src->pub.skip_input_data = skip_input_data;
  src->pub.resync_to_restart = jpeg_resync_to_restart; /* use default method */
  src->pub.term_source = term_source;

  src->pub.next_input_byte = buffer;
  src->pub.bytes_in_buffer = bufsize;
} 
```

那么用法就很简单了。您可能需要将 SIZEOF() 替换为 sizeof()。找一个标准的解压例子。只需将“jpeg_stdio_src”替换为“jpeg_memory_src”即可。希望有帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-21T15:01:05.103

这是德尔福的一个例子。它将 24 位位图转换为与 OpenCV 一起使用

```
function BmpToPIplImageEx(Bmp: TBitmap): pIplImage;
Var
  i: Integer;
  offset: LongInt;
  dataByte: PByteArray;  
Begin
  Assert(Bmp.PixelFormat = pf24bit, 'PixelFormat must be 24bit');
  Result := cvCreateImageHeader(cvSize(Bmp.Width, Bmp.Height), IPL_DEPTH_8U, 3);
  cvCreateData(Result);
  for i := 0 to Bmp.height - 1 do
  Begin        
    offset   := longint(Result.imageData) + Result.WidthStep * i;
    dataByte := PByteArray(offset);    
    CopyMemory(dataByte, Bmp.Scanline[i], Result.WidthStep);
  End;
End; 
```

# asp.net - ASP.NET 应用程序重启次数过多

> ID：801201
> 
> 赞同：3
> 
> 时间：2009-04-29T07:03:00.317
> 
> 标签：asp.net

我有一个 ASP.NET 网站，它每天每 1-2 小时重新启动一次，所以会话和其他事情都消失了，用户对此感到不满，因为他们打开一个页面并做了 20 分钟的事情，当他们提交它时，不错的“我们很抱歉”页面在那里。

我不做任何重新启动应用程序的事情（更改 web.config、更改文件，甚至是其他错误的事情，例如删除 App_Data 中通常不会导致重新启动的文件夹）。

会不会和服务器的硬件有关？它不是很强大。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T07:07:43.517

我猜这是[回收](https://stackoverflow.com/questions/358384/asp-net-recycling-app-pools-indicative-of-larger-problem)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T07:20:44.580

默认情况下，IIS 中的应用程序池会被回收 - 在超时后或在“n”次命中后。

这应该是意料之中的，并且是正常处理的一部分（尽管可以在应用程序池配置中禁用它；[IIS6](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/1eee28e2-b319-4b4e-8267-a8c0aa0dcf36.mspx?mfr=true) | [IIS7](http://technet.microsoft.com/en-us/library/cc753179.aspx)）。

这会破坏您的应用程序这一事实表明您正在使用很多东西，例如内存会话。考虑将这些移动到数据库支持的实现。除了承受应用程序池重新启动和服务器重新启动之外，这还可以让您将站点扩展到多个服务器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T07:42:41.967

[查看这篇博](http://blogs.msdn.com/tess/archive/2006/08/02/asp-net-case-study-lost-session-variables-and-appdomain-recycles.aspx)文，了解一些可能导致 appdomain 回收的原因。有很多可能的原因。

如果您无法解决问题，您可以从进程内会话状态切换到会话状态服务器或将会话状态存储在数据库中。这两个选项都很容易设置并且效果很好，但是会影响性能（我认为在 10-20% 之间）。[这里有一篇](http://blog.maartenballiauw.be/post/2007/11/ASPNET-load-balancing-and-ASPNET-state-server-(aspnet_state).aspx)关于如何设置会话状态服务器的好文章。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T07:09:39.737

听起来应用程序正在被回收或进程失败。

检查应用程序池设置[http://msdn.microsoft.com/en-us/library/aa720473(VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa720473(VS.71).aspx)

和事件查看器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T07:11:33.417

由于您提到您的服务器很小，您可能会检查您的工作进程是否消耗了您[在 machine.config 中的 processModel 中](http://msdn.microsoft.com/en-us/library/7w2sway1.aspx)设置的更多内存。这可能会导致重置。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T07:46:05.877

您确定 ASP.NET 应用程序实际上重新启动了吗？还是您认为这是因为丢失了 Session 等？

您的应用程序（和 IIS 的）会话超时变量是什么？超时的默认值为 20 分钟，这就是我要问的原因。您可以在 web.config 中设置超时，如下所示：

```
<system.web>
    <sessionState timeout="120"/>
</system.web> 
```

但除此之外，IIS 本身也有一些地方可以设置它。在 IIS6 的情况下，这些地方是：

*   虚拟目录的属性 > 主目录（选项卡）> 配置（按钮）> 选项（选项卡）> 会话超时
*   虚拟目录的属性 > ASP.net（选项卡）> 身份验证（选项卡）> Cookie 超时

我不确定两者是否真的需要，但我通常将两者设置为与我在 web.config 中设置的值相同的值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-29T07:06:40.103

是否有任何迹象表明事件日志中记录了重新启动的原因？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-29T07:16:06.243

你有没有在服务器上运行任何杀毒软件。对 web.config 的更改将导致您的应用程序重新启动 afaik，因此在某些情况下，通过 web.config 传递的防病毒软件可能会更改文件上可能导致重置的属性。

尝试禁用任何 AV 软件或从 AV 自动扫描中排除 Web 应用程序目录。

# c++ - C++ 中的 char* vs std::string

> ID：801209
> 
> 赞同：85
> 
> 时间：2009-04-29T07:08:54.013
> 
> 标签：c++, stl, stdstring, arrays

我应该什么时候使用`std::string`，什么时候应该使用来管理C++`char*`中的 s 数组？`char`

`char*`如果性能（速度）至关重要并且由于内存管理而愿意接受一些有风险的业务，您似乎应该使用。

还有其他需要考虑的场景吗？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-04-29T08:16:54.537

我的观点是：

*   如果您不调用“C”代码，切勿使用 char *。
*   始终使用 std::string：它更容易，更友好，经过优化，是标准的，它可以防止你出现错误，它已经过检查并证明可以工作。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2009-04-29T07:20:41.193

如果 s 很大以避免复制，或者指向实例的指针，您可以通过`std::string`引用传递，所以我看不出使用`char`指针有什么真正的优势。

我使用`std::string`/`wstring`或多或少的所有实际文本。`char *`但是对于其他类型的数据很有用，您可以确定它会像应有的那样被释放。否则`std::vector<char>`就是要走的路。

所有这些可能都有例外。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-29T08:12:54.313

### 原始字符串使用

是的，有时你真的可以做到这一点。当使用 const char *，分配在堆栈上的 char 数组和字符串文字时，您可以这样做，根本没有内存分配。

编写这样的代码通常比使用字符串或向量需要更多的思考和谨慎，但使用适当的技术是可以做到的。使用适当的技术，代码可以是安全的，但是您始终需要确保在复制到 char [] 时，您要么对要复制的字符串的长度有一定的保证，要么优雅地检查和处理过大的字符串。不这样做是给 strcpy 系列函数带来不安全声誉的原因。

### 模板如何帮助编写安全的字符缓冲区

至于 char [] 缓冲区的安全性，模板可以提供帮助，因为它们可以创建一个封装来为您处理缓冲区大小。像这样的模板由 Microsoft 实施，以提供 strcpy 的安全替换。这里的例子摘自我自己的代码，真实的代码还有很多方法，但这应该足以传达基本思想：

```
template <int Size>
class BString
{
  char _data[Size];

  public:
  BString()
  {
    _data[0]=0;
    // note: last character will always stay zero
    // if not, overflow occurred
    // all constructors should contain last element initialization
    // so that it can be verified during destruction
    _data[Size-1]=0;
  }
  const BString &operator = (const char *src)
  {
    strncpy(_data,src,Size-1);
    return *this;
  }

  operator const char *() const {return _data;}
};

//! overloads that make conversion of C code easier 
template <int Size>
inline const BString<Size> & strcpy(BString<Size> &dst, const char *src)
{
  return dst = src;
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-29T07:56:13.027

当您需要静态字符串常量时，您必须使用`char*`而不是使用的一种情况。`std::string`原因是您无法控制模块初始化其静态变量的顺序，并且来自不同模块的另一个全局对象可能会在初始化之前引用您的字符串。[http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml#Static_and_Global_Variables](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml#Static_and_Global_Variables)

`std::string`优点：

*   为您管理内存（字符串可以增长，实现将为您分配更大的缓冲区）
*   更高级别的编程接口，可以很好地与 STL 的其余部分配合使用。

`std::string`缺点： - 两个不同的 STL 字符串实例不能共享相同的底层缓冲区。因此，如果您按值传递，您总是会得到一个新副本。- 有一些性能损失，但我会说除非你的要求是特殊的，否则它可以忽略不计。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-04-29T07:17:29.687

您应该考虑`char*`在以下情况下使用：

*   该数组将传入参数。
*   您事先知道数组的最大大小（您知道或强加它）。
*   您不会对此数组进行任何转换。

实际上，在 C++ 中，`char*`通常用于固定的小字，如选项、文件名等...

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-29T07:54:05.327

**何时使用 c++ std::string：**

*   `string`s，总的来说，比 s 更安全`char*`，通常当你在做事情时，`char*`你必须检查事情以确保事情是正确的，在`string`课堂上这一切都是为你完成的。
*   通常在使用时`char*`，您必须释放分配的内存，您不必这样做，`string`因为它会在销毁时释放其内部缓冲区。
*   `string`s 与 c++ 配合得很好`stringstream`，格式化 IO 非常容易。

**何时使用 char** *

*   使用`char*`使您可以更好地控制“幕后”发生的事情，这意味着您可以根据需要调整性能。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-29T14:59:38.780

如果您正在编写库，请使用 (const) char* 作为参数。std::string 实现在不同的编译器之间有所不同。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-29T07:54:33.110

如果要使用 C 库，则必须处理 C 字符串。如果您想将 API 公开给 C，同样适用。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-29T08:16:28.843

您可以期望 std::string 上的大多数操作（例如 eg `find`）尽可能优化，因此它们的性能可能至少与纯 C 对应物一样好。

还值得注意的是，std::string 迭代器经常映射到指向底层 char 数组的指针。因此，就性能而言，您在迭代器之上设计的任何算法本质上都与基于 char * 的相同算法相同。

需要注意的事情是例如`operator[]`- 大多数 STL 实现不执行边界检查，并且应该将其转换为对底层字符数组的相同操作。AFAIK STLPort 可以选择执行边界检查，此时此运算符会慢一些。

那么使用 std::string 有什么好处呢？它使您免于手动内存管理；调整数组的大小变得更容易，而且您通常不必考虑释放内存。

如果您在调整字符串大小时担心性能问题，那么`reserve`您可能会发现一个有用的函数。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-29T07:11:27.300

如果您在文本等中使用字符数组，则使用 std::string 更灵活且更易于使用。如果您将其用于数据存储等其他用途？使用数组（首选向量）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-29T07:15:50.207

即使性能至关重要，您也可以更好地使用`vector<char>`- 它允许提前分配内存（reserve() 方法）并帮助您避免内存泄漏。使用 vector::operator[] 会导致开销，但您始终可以提取缓冲区的地址并对其进行索引，就像它是 char* 一样。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-04-29T08:07:30.410

AFAIK 在内部大多数 std::string 实现写入时复制，引用计数语义以避免开销，即使字符串不是通过引用传递的。

# php - 在 Zend Lucene 中搜索“Foo Bar”时如何找到“FooBar”

> ID：801211
> 
> 赞同：4
> 
> 时间：2009-04-29T07:09:52.857
> 
> 标签：php, zend-framework, lucene, zend-search-lucene, fuzzy-search

我正在使用 Zend Lucene 为 php 网站构建搜索功能，但遇到了问题。我的网站是店长（类似的东西）。

例如，我有一家名为“FooBar”的商店，但我的访客搜索“Foo Bar”并获得零结果。此外，如果一家商店被命名为“Foo Bar”并且访客搜索“FooBar”，则什么也找不到。

我试图搜索“foobar~”（模糊搜索）但没有找到名为“Foo Bar”的文章

是否有一种特殊的方式来构建索引或进行查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T10:02:52.613

选项 1：在不同点将输入查询字符串分成两部分并搜索它们。例如。在这种情况下，查询将是 (+fo +bar) OR (+foo +bar) OR (+foob +ar) 问题是这种标记化假设输入查询字符串中有两个标记。此外，您可能会得到额外的、可能不相关的结果，例如 (+foob +ar) 的结果

选项 2：在索引和查询时使用 n-gram 标记化。虽然索引“foo bar”的标记将是 fo、oo、ba、ar。使用 foobar 搜索时，标记将是 fo、oo、ob、ba、ar。使用 OR 作为运算符搜索将在顶部为您提供具有最大 n-gram 匹配的文档。这可以通过[NGramTokenizer实现](http://lucene.apache.org/java/2_4_1/api/contrib-analyzers/org/apache/lucene/analysis/ngram/NGramTokenizer.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T14:25:19.890

为最常见的名称混淆手动添加索引条目。让您的客户在特殊表格上输入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T07:23:43.510

你试过“*foo* AND *bar*”还是“*foo* OR *bar*”？它在 Ferret 中工作，我读到它是基于 Lucene 的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T00:40:48.157

如果您不关心性能，请使用 WildcardQuery （性能明显更差）：

```
new WildcardQuery( new Term( "propertyName", "Foo?Bar" ) ); 
```

对于零个或多个字符，使用'*'，对于零个或一个字符，使用'?'

如果性能很重要，请尝试使用 BooleanQuery。

# c# - WPF中Datacontext和ItemSource的区别

> ID：801233
> 
> 赞同：5
> 
> 时间：2009-04-29T07:17:16.100
> 
> 标签：c#, wpf, .net-3.5

重复：

[为什么 DataContext 和 ItemsSource 不是多余的？](https://stackoverflow.com/questions/793340/who-has-the-best-answer-for-why-datacontext-and-itemssource-are-not-redundant/793350)

* * *

在 WPF 中，我们可以通过 2 种方式将项目列表分配给 ComboBox

```
//CODE #1
//WPF
<ComboBox name="cmbItems" ItemSource={Binding} />

//C#
cmbItems.DataContext = someList; 
```

另一种方式，直接分配itemsource

```
//CODE #2
//WPF
<ComboBox name="cmbItems" ItemSource={Binding} />
//C#
cmbItems. ItemSource = someList; 
```

两者都起到了作用，但是上面的代码片段有什么区别？哪个好用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-29T07:20:47.853

DataContext 主要用于表单、控件等。

ItemSource 是在该 DataContext 上进行数据绑定的相对路径。

例如，当您创建一个表单来编辑人员详细信息时，DataContext 将是 Person，并且表单上的不同控件将分别绑定在该对象的单独属性上，例如姓名、出生日期等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T07:21:44.857

在第二个示例中，您可以省略 ItemsSource={Binding}.. 您将 ItemsSource 直接设置为后面代码中的值.. 您不需要在这里绑定。在您的第一个示例中，您设置了 DataContext，并使用绑定再次从 DataContext 中检索它。

但这并不重要......因为这两种方法都很好......

我使用以下规则：如果我有可用的集合，请将其设置在后面的代码中。如果我需要转换集合，请将其设置为某种绑定模式，以便我可以使用 IValueConverter 来完成这项工作...

# asp.net - asp.net 中注释的版本控制

> ID：801236
> 
> 赞同：0
> 
> 时间：2009-04-29T07:18:52.697
> 
> 标签：asp.net, versioning, document

什么是允许用户编辑他们的笔记的最佳方式，在每次编辑时维护笔记的版本，并允许他们比较选定的笔记版本。注释可能会使用类似于 SO 上的 WMD 编辑器输入。我将在 ASP.net 上构建它。类似于 basecamp 上的写字板。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T07:22:50.517

一个简单的方法是创建一个带有文本字段和版本号的表。每当更新和（重新）提交注释时，请保存更新文本的完整副本，并增加版本号。这样你就有了完整的编辑历史。

当然，这将意味着大量重复数据，但管理这将比尝试维护“增量”或版本之间的差异容易得多。

# windows - 窗体应用程序

> ID：801237
> 
> 赞同：-1
> 
> 时间：2009-04-29T07:19:25.283
> 
> 标签：windows, forms

我有一个二进制搜索树的 c++ 代码，我想在一个新的 Windows 窗体应用程序中使用这个代码。任何人都可以帮助我如何做到这一点。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T07:33:26.670

二进制搜索已内置到 .NET 框架中。

VB：

```
 Dim foo As New Collections.Generic.List(Of Integer)
 foo.BinarySearch(3) 
```

C＃：

```
List<Integer> foo = new List<Integer>();
foo.BinarySearch(3); 
```

如果您想用 C++ 编写所有内容，也可以编写基于 C++ 的 WinForm ...

# c# - 使用 C# 发送电子邮件的问题

> ID：801243
> 
> 赞同：0
> 
> 时间：2009-04-29T07:20:56.200
> 
> 标签：c#, email, smtp

当我尝试使用 C# 和 gmail 的 smtp 服务器发送电子邮件时，我收到了这个错误。

**“根据验证程序，远程证书无效”。**

SSL 已启用

使用的端口是 587

使用的服务器名称是“Smtp.gmail.com”。

用户名和密码正确

Outlook Express 在具有相同设置的同一台电脑上工作正常

c# 程序在其他地方也可以正常工作……我们只在客户端收到此错误。

将不胜感激任何帮助..

谢谢

编辑：@Andomar，我在哪里可以找到客户端的根证书？我该如何解决？

@Alnitak，我如何使用 System.Net.Mail 库发出 starttls ？

@David，我应该将什么作为“（对象发件人，X509Certificate 证书，X509Chain 链，SslPolicyErrors sslPolicyErrors）”的参数传递

谢谢大卫。我已经添加了这些行。但是，我仍然对发生的事情感到困惑，因为据我所知，此代码与 System.Net.Mail 没有任何直接联系。希望问题消失。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T07:39:11.367

还要检查根证书是否在客户端的受信任的根授权存储中。如果这是来自服务，那么将根证书添加到本地机器存储也可能会有所帮助。为了更好地理解原因，我发现以下策略很有帮助......

```
public bool ValidateServerCertificate( object sender, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors)
{
// No errors so continue…
if (sslPolicyErrors == SslPolicyErrors.None)
       return true;

// I’m just logging it to a label on the page, 
//  this should be stored or logged to the event log at this time. 
lblStuff.Text += string.Format("Certificate error: {0} <BR/>", sslPolicyErrors);

// If the error is a Certificate Chain error then the problem is
// with the certificate chain so we need to investigate the chain 
// status for further info.  Further debug capturing could be done if
// required using the other attributes of the chain.
      if (sslPolicyErrors == SslPolicyErrors.RemoteCertificateChainErrors)
      {
       foreach (X509ChainStatus status in chain.ChainStatus)
       {
             lblStuff.Text += string.Format("Chain error: {0}: {1} <BR/>", status.Status, status.StatusInformation);
  }
}

// Do not allow this client to communicate 
//with unauthenticated servers.
      return false;
} 
```

要添加策略，请使用以下内容，只需为应用程序域执行一次。

```
using System.Net;
...
ServicePointManager.ServerCertificateValidationCallback =
new Security.RemoteCertificateValidationCallback(ValidateServerCertificate); 
```

您也可以使用该策略完全消除错误，但解决问题比这样做更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T07:25:20.013

检查正确的根证书是否在客户端的存储中。并且客户端的系统日期是正确的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T07:29:03.297

您是否使用`STARTTLS`或假设端口 587 上的连接从一开始就是 SSL 加密的？

Google 的服务器`smtp.gmail.com`需要 STARTTLS。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-06T03:42:08.373

你设置了吗

```
 client.EnableSsl = true; 
```

因为gmail需要它

# validation - 多行 texbox 验证

> ID：801250
> 
> 赞同：1
> 
> 时间：2009-04-29T07:23:43.683
> 
> 标签：validation, textbox

我想在多行文本框的每一行中验证 5 个字符的最大长度

帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T07:47:52.173

这是一个示例：显示验证结果的**TextArea和 span。**

```
<textarea cols="30" rows="10" onblur="validateRows(this)"></textarea><br/>
<span id="validationResults" style="color:red"></span> 
```

这是验证每一行的 JavaScript 代码：

```
function validateRows(e){
   var content = e.value.split("\n");
   for(var line in content){
     var charLength = content[line].length - 1;
     var lineNumber = parseInt(line) + 1;
     if(charLength > 5){
       document.getElementById("validationResults").innerHTML += "* line " 
                         + lineNumber + " has " + charLength 
                         + " characters" + "<br/>";
     }
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T07:31:34.413

使用 split 函数（在 C# 和 Javascript 中），然后检查它的长度。

```
var temp = [TextFromTextBox].split('\n');
foreach(var s in temp)
{
   if(!ValidateFunction(s))
   {
      // code for show exception
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T08:07:39.567

这是一个 C# 版本。可以在用于服务器端验证的 Web 应用程序或 Windows 应用程序中使用。（在客户端验证的 Web 应用程序中，Jose Basilio 的代码是合适的）

```
 public static bool HasMax5CharsPerLine(TextBox target)
    {
        foreach (string Line in target.Text.Split(new char[] {'\n'}))
            if (Line.Length > 5)
                return false;
        return true;
    } 
```

# c# - 我可以将一个大 dll 分成每个类 1 个 dll 吗？

> ID：801252
> 
> 赞同：6
> 
> 时间：2009-04-29T07:24:37.317
> 
> 标签：c#, visual-studio, dll

从[我可以在 Visual Studio 2008 中从 C# 项目构建 2 个或更多 dll 吗？](https://stackoverflow.com/questions/792136/can-i-build-2-or-more-dlls-from-c-project-in-visual-studio-2008)，我有另一个想法，只创建一个大项目。之后，我通过使用构建后事件调用 Win 应用程序项目（用于单独的大 dll）将一个项目 dll（包含许多类。）分成每个类 1 个 dll。这个怎么做？

此外，我还需要在一个大 dll 中管理附件。

**更新** 我发现了一些技巧可以指导我通过**自定义构建**来解决这个问题？此外，我认为我可以创建自定义处理程序，通过使用单独的模块文件和 al.exe 生成动态程序集文件。但是这个功能超出了我的预期和不必要的（源代码很少更改）。

[多文件程序集：什么和如何](http://blogs.msdn.com/grantri/archive/2004/07/07/175745.aspx)

[如何：构建多文件程序集](http://msdn.microsoft.com/en-us/library/226t7yxe.aspx)

[POCO 自定义多文件组装和 ReSharper](http://www.simonsegal.net/blog/2008/09/25/poco-custom-multifile-assembly-and-resharper/)

**谢谢，**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-29T07:28:12.423

只是……为什么？拥有大量 dll 会对应用启动产生性能影响（由于“融合”）。它也会*立即*遭受循环引用的影响，这是一件**坏事**。

由于 .NET 代码（默认情况下）在第一次使用时会进行 JIT 处理，因此在 dll 中包含未在该应用程序中使用的额外类不会产生巨大的影响。他们只是静静地坐在那里，不打扰任何人。

每个类拥有一个 dll 的绝对管理成本将使部署等变得*难以忍受*。

总而言之，我想不出一个合理的理由这样做......

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-29T07:27:18.730

您将在这里得到的答案与另一个问题中的答案没有什么不同：[为每个单独的 dll 放入一个单独的项目](https://stackoverflow.com/questions/792136/can-i-build-2-or-more-dlls-from-c-project-in-visual-studio-2008/792179#792179)。

我想问你的是你对“类”的定义的理解是什么。每个 DLL 一个类可能意味着您对程序集、命名空间和类的工作方式不是很熟悉。

告诉我们，你真正想做什么？因为您认为解决该问题应该采取的措施（例如，为每个类创建一个 DLL）是不切实际的。

**更新**

考虑到您的需求上下文（例如，Silverlight Web 应用程序），我的结论是，*将您的类拆分为多个 DLL 不会导致*ASP.NET 网页的性能提高，因为：

*   DLL 仅由服务器使用，它们*不会*通过 HTTP 下载到您的浏览器
*   一旦 DLL 被 Web 应用程序加载，它就不会再次加载它——无论有多少用户同时使用您的站点。每台服务器一个 DLL 实例。
*   当你启动你的 web 应用程序时，它会加载它编译所依赖的*所有*DLL，无论你是否会使用它。

因此，根据您的要求，考虑到带宽限制，最好不要将 Silverlight 用于您的应用程序。您可以探索的途径是：

*   学习 AJAX 技术，特别是 JSON，（可能不是 ASP.NET AJAX 及其容易误用的 UpdatePanel）
*   学习 jQuery 以查找将在 JavaScript 中实现您想要使用 Silverlight 执行的操作的控件

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-12-07T08:21:37.417

此问题由另一个问题中解释的 MSBuild 自定义脚本解决。

```
<ItemGroup> 
  <Compile Include="Class1.cs"> 
    <Plugin>true</Plugin> 
  </Compile> 
  <Compile Include="Class2.cs" /> 
  <Compile Include="Class3.cs"> 
    <Plugin>true</Plugin> 
  </Compile> 
  <Compile Include="Program.cs" /> 
  <Compile Include="Properties\AssemblyInfo.cs" /> 
</ItemGroup> 
```

[Visual Studio 一个项目有几个 dll 作为输出？](https://stackoverflow.com/questions/3867113/visual-studio-one-project-with-several-dlls-as-output)

感谢@franko_camron 的建议。

# c# - 在 ASP.NET 中将 HTML 内容写入 Word 文档时出现问题

> ID：801255
> 
> 赞同：5
> 
> 时间：2009-04-29T07:26:58.683
> 
> 标签：c#, asp.net, ms-word, export

我正在尝试将 HTML 页面内容导出到 Word。

我的 Html 显示页面是：

1.  你最喜欢的颜色是什么？

不适用

2.  列出前三名的学校？

一国二开发三PS

还有一个点击事件的按钮。按钮单击事件将打开 MS word 并将页面内容粘贴到 word 中。

word page包含html设计页面的table属性。它只出现在 Word 2003 中。但在 Word 2007 中，word 文档包含没有表属性的文本。如何在 word 2003 中删除此表属性。

我无法添加快照。否则我会让你清楚。

我正在用aspx设计网页。我正在通过以下代码导出网页内容。

```
protected void Button1_Click(object sender, EventArgs e)
{

    Response.ContentEncoding = System.Text.Encoding.UTF7;
    System.Text.StringBuilder SB = new System.Text.StringBuilder();
    System.IO.StringWriter SW = new System.IO.StringWriter();
    System.Web.UI.HtmlTextWriter htmlTW = new System.Web.UI.HtmlTextWriter(SW);
    tbl.RenderControl(htmlTW);
    string strBody = "<html>" +
        "<body>" + "<div><b>" + htmlTW.InnerWriter.ToString() + "</b></div>" +
        "</body>" +
        "</html>";

    Response.AppendHeader("Content-Type", "application/msword");
    Response.AppendHeader("Content-disposition", "attachment; filename=" + fileName);
    Response.ContentEncoding = System.Text.Encoding.UTF7;

    string fileName1 = "C://Temp/Excel" + DateTime.Now.Millisecond.ToString();
    BinaryWriter writer = new BinaryWriter(File.Open(fileName1, FileMode.Create));
    writer.Write(strBody);
    writer.Close();
    FileStream fs = new FileStream(fileName1, FileMode.Open, FileAccess.Read);
    byte[] renderedBytes;
    // Create a byte array of file stream length 
    renderedBytes = new byte[fs.Length];
    //Read block of bytes from stream into the byte array 
    fs.Read(renderedBytes, 0, System.Convert.ToInt32(fs.Length));
    //Close the File Stream 
    fs.Close();
    FileInfo TheFile = new FileInfo(fileName1);
    if (TheFile.Exists)
    {
        File.Delete(fileName1);
    }
    Response.BinaryWrite(renderedBytes);

    Response.Flush();
    Response.End();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-17T23:26:37.100

您正在编写 HTML，声称它的内容类型为“application/msword”，然后希望获得最好的结果..

还有更多“正确”的方法可以实现您的目标。

有一些将 (X)HTML 转换为 WordML 内容的项目，其中[docx4j-ImportXHTML.NET](https://www.nuget.org/packages/docx4j-ImportXHTML.NET/)就是其中之一。披露：我坚持这一点；你可以在 StackOverflow 上找到其他地方的链接。

或者，您可以使用 Word 的 altChunk 机制，但请注意：

*   您对如何执行导入的控制较少；
*   Word 2003 不支持 AltChunk（即使有兼容包）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-30T15:56:06.187

您还可以尝试创建一个现在可以被 MS office 识别的 Open XML 文档。以下是代码示例的更多信息：http: [//msdn.microsoft.com/en-us/library/bb656295.aspx](http://msdn.microsoft.com/en-us/library/bb656295.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-18T06:25:43.407

据我了解，您正在尝试动态创建 ms word 文档，并且在 Word 2003 与 2007 中查看输出时遇到困难。

在上面的代码中，您只是简单地吐出 html 并强制它成为 ms word 文档。我很惊讶它甚至可以工作。

相反，您可能想要使用 Office Interop (Microsoft.Office.Interop.Word) 或使用 nuget 安装 DocX。在网上看一些例子，搜索“C# create word doc”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T08:07:25.933

问题不清楚。

好吧，这些链接可以帮助您理解 MSWord-C# 自动化：

[http://www.codeproject.com/KB/cs/Simple_Ms_Word_Automation.aspx](http://www.codeproject.com/KB/cs/Simple_Ms_Word_Automation.aspx)

[http://www.c-sharpcorner.com/UploadFile/amrish_deep/WordAutomation05102007223934PM/WordAutomation.aspx](http://www.c-sharpcorner.com/UploadFile/amrish_deep/WordAutomation05102007223934PM/WordAutomation.aspx)

# javascript - 从 javascript 脚本重定向 document.write

> ID：801258
> 
> 赞同：2
> 
> 时间：2009-04-29T07:28:06.200
> 
> 标签：javascript

我们想在我们的网站上投放广告，但我们正在与之交谈的广告服务器在为我们提供足够快的广告方面存在问题。

我看到的问题是我们应该包含一个`<script src="http://advertiserurl/myadvertkey"></script>`我们想要显示广告的位置，然后它将下载一个脚本并使用 document.write 插入一些 html。

问题是对广告商网站的调用速度很慢，返回的代码然后下载另一个文件（广告），这意味着在我们等待请求被填充时呈现我们的页面的速度变慢。

有没有办法从 document.write 调用中获取输出并在页面加载后将其写入？

基本上我想这样做：

```
<html>
<body>

    <script>
function onLoad() {
    var urlToGetContentFrom = 'http://advertiserurl/myadvertkey';

    //  download js from above url somehow

    var advertHtml = // do something awesome to interprete document.write output
    $('someElement').innerHTML = advertHtml;
}
    </script>

</body>
</html> 
```

或任何类似的东西，让我得到该文件的输出并显示它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T07:39:41.040

如果我理解正确，您希望将 document.write 捕获到变量而不是将其写入文档。您实际上可以这样做：

```
var advertHtml = '';
var oldWrite = document.write;

document.write = function(str)
{
    advertHtml += str;
}

// Ad code here

// Put back the old function
document.write = oldWrite;

// Later...
...innerHTML = advertHtml; 
```

不过，您仍然可以加载脚本文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T07:35:41.017

要将主页加载与广告加载分离，您可以将广告放在 iframe 中自己的页面中，或者类似地，使用 AJAX 下载脚本文件并在它出现时执行它。如果前者不足够，因为引用 URI 或其他原因，后者为您提供了一些灵活性：您可以使用字符串替换将“document.write”重写为其他内容，或者可能暂时将其替换为“document.write = custom_function; ”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-22T21:50:08.137

您可能对[我开发的 Javascript 库](http://bezen.org/javascript/index.html)感兴趣，它允许在window.onload*之后使用 document.write 加载第 3 方脚本。*在内部，该库覆盖 document.write，动态添加 DOM 元素，运行任何可能使用 document.write 的包含脚本。

我设置了[一个演示，其中我加载了 3 个 Google Ads、一个 Amazon 小部件以及动态的 Google Analytics](http://bezen.org/javascript/demo/dynamic-script-loading-with-bezen-load.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T07:40:49.600

由于同源策略，您会遇到一些跨域的安全问题。如果您有权更改广告内容/服务，我会研究 JSONP

[http://docs.jquery.com/Ajax/jQuery.getJSON#urldatacallback](http://docs.jquery.com/Ajax/jQuery.getJSON#urldatacallback)

# .net - '//' 会影响 HTTP 请求的性能吗？

> ID：801264
> 
> 赞同：1
> 
> 时间：2009-04-29T07:30:18.957
> 
> 标签：.net, asp.net, performance, url

假设在请求中意外在“/”上添加了“//”而不是任何 URL。这会影响 HTTP 请求的性能吗？

例如

1.  [http://www.microsoft.com/downloads](http://www.microsoft.com/downloads)
    v/s
2.  [http://www.microsoft.com//downloads](http://www.microsoft.com//downloads)

我问这个的原因是；在我们的一个应用程序中，由于某种原因，动态 URL 在生产服务器上构建错误。我们正在解决这个问题，但与此同时，我真的很担心由此可能出现的问题是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T07:34:41.970

好吧，我不知道 URL 是如何在服务器端解析的，但是是的，可能会对性能产生影响。

或者，好吧，影响不是正确的词。这就像一只微小的苍蝇咬住一只巨大的猛犸象......所以你不应该真的担心它。

当然，除了性能之外，最好只链接到正确的 URL。可能还有其他影响，并且该 URL 将来可能无法正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T07:55:40.220

您提供的 URL 重定向到有意义的内容只是巧合。如果那不是 url，你会在很多服务器上得到 404。

[http://slashdot.org/recent/](http://slashdot.org/recent/)

[http://slashdot.org//recent/](http://slashdot.org//recent/)

尤其是当您考虑这些天所有的 URL 重写时。

我重写了类似的内容：^ [http://site.com/directory/](http://site.com/directory/) {0,1}$

这会给你一个很好的 404 ;)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T07:41:53.983

您发布的网址确实会对性能产生影响（忽略 //）。url 使用重定向（301 代码）这一事实会降低性能，因为它会从[http://www.microsoft.com/downloads 重定向](http://www.microsoft.com/downloads) 到[http://www.microsoft.com/downloads/en /default.aspx](http://www.microsoft.com/downloads/en/default.aspx)。

当您忘记添加最后一个斜杠时也会发生这种情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T07:35:38.710

我很确定性能影响可以忽略不计，甚至不存在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T07:41:21.813

尝试使用 Firefox，似乎 FF 要求 GET [http://www.microsoft.com//downloads](http://www.microsoft.com//downloads) 收到 301 Moved 永久，然后 FF 要求正确的地址（在这种情况下，它收到另一个 301 指向[http:/ /www.microsoft.com/downloads/en/default.aspx](http://www.microsoft.com/downloads/en/default.aspx)）所以是的，存在性能问题，服务器压力并且是错误的行为

（可能不同的服务器配置可能会有所不同）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T08:42:55.223

不，没有区别。或者至少您无法欣赏其中的差异。只是比较做

```
ls /<any-path>/myFile 
```

和

```
ls /<any-path>//myFile 
```

路易斯

# android - Android - 如何通过代码将图像放置在现有布局之上？

> ID：801270
> 
> 赞同：3
> 
> 时间：2009-04-29T07:32:59.603
> 
> 标签：android, android-webview, android-imageview

我有一个`layout`在其中显示一个`webview`. 我想`webview`通过代码在特定位置添加图像。

有人可以告诉我该怎么做吗？

API Demos 中的半透明背景示例使视图覆盖整个屏幕。我只想在特定位置放置一个小图像（原点不是 0,0）

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T22:49:55.127

您是否尝试过将 WebView 和 ImageView 都放在绝对布局中？这应该让您指定图像的 X/Y 位置，并通过排序使其不断绘制在 web 视图上。

编辑：查看绝对布局：http: [//developer.android.com/guide/topics/ui/layout-objects.html#absolutelayout](http://developer.android.com/guide/topics/ui/layout-objects.html#absolutelayout)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-06T06:17:24.020

AbsoluteLayout 已被弃用，如果这让您感到困扰，您可能需要寻找替代方案。我在这里的博客文章中放了一个例子。它可能不完全是你所追求的，但应该给你一个想法：

[http://anothermobiledeveloper.blogspot.com/2011/10/using-relativelayout-instead-of.html](http://anothermobiledeveloper.blogspot.com/2011/10/using-relativelayout-instead-of.html)

# c# - 将 silverlight 类链接到 Web 应用程序

> ID：801274
> 
> 赞同：1
> 
> 时间：2009-04-29T07:35:29.037
> 
> 标签：c#, asp.net, silverlight

已经在 silverlight 类库 (dll) 中编写了所有代码并将同一个库链接到我的 web 应用程序和 silverlight 应用程序，有没有办法避免“编译器错误消息：CS0433”或者我必须为网络应用程序？

错误主要发生在调用 XElement 时...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T07:39:03.943

您的意思是您从 Web 应用程序和 Silverlight 应用程序引用单个 dll 吗？我会有两个版本的 dll（和两个项目文件）；一种是为常规 .NET（用于 Web 应用程序）构建的，另一种是为 Silverlight 构建的；主要区别在于目标框架和参考。

如果您不想处理必须维护两个项目文件（当您添加类等时），那么您可以使用[这个技巧](https://stackoverflow.com/questions/783750/is-there-a-reliable-way-to-keep-compact-framework-and-desktop-projects-in-sync-wi/784711#784711)来减少这种开销。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T02:28:34.920

您需要创建两个项目，但可以使用 Add Existing Item as a Link 添加相同的 CS 文件。[http://msdn.microsoft.com/en-us/library/9f4t9t92.aspx](http://msdn.microsoft.com/en-us/library/9f4t9t92.aspx)解释了它。

[http://www.scip.be/index.php?Page=ArticlesNET28](http://www.scip.be/index.php?Page=ArticlesNET28)是一个很好的阅读相关信息。

# c++ - 使用 qmake 查找编译器供应商/版本

> ID：801279
> 
> 赞同：10
> 
> 时间：2009-04-29T07:38:22.570
> 
> 标签：c++, qt, build-process, makefile, qmake

有没有办法通过qmake获取用户使用的编译器的版本和厂商？我需要的是在使用 g++ 3.x 时禁用构建我的项目的一些目标，并在使用 g++ 4.x 时启用它们。

**更新：**大多数答案都针对预处理器。这是我想避免的。我不希望为特定的编译器版本构建目标，我希望由构建系统做出这个决定。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-30T15:08:06.927

除了[ashcatch](https://stackoverflow.com/questions/801279/finding-compiler-vendor-version-using-qmake/801769#801769)的答案之外，`qmake`还允许您[查询命令行](http://doc.qt.io/qt-5/qmake-test-function-reference.html#system-command)并将响应作为变量返回。所以你可以这样：

```
linux-g++ {
    system( g++ --version | grep -e "\<4.[0-9]" ) {
        message( "g++ version 4.x found" )
        CONFIG += g++4
    }
    else system( g++ --version | grep -e "\<3.[0-9]" ) {
        message( "g++ version 3.x found" )
        CONFIG += g++3
    }
    else {
        error( "Unknown system/compiler configuration" )
    }
} 
```

然后，当您想使用它来指定目标时，可以使用配置范围规则：

```
SOURCES += blah blah2 blah3
g++4: SOURCES += blah4 blah5 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-08-07T10:41:42.527

我的回答基于[Caleb Huitt - cjhuitt](https://stackoverflow.com/a/807398/3045403)的。但他的方法对我不起作用。

```
*-g++ {
    GCC_VERSION = $$system("g++ -dumpversion")
    contains(GCC_VERSION, 6.[0-9]) {
        message( "g++ version 6.x found" )
        CONFIG += g++6
    } else {
        contains(GCC_VERSION, 5.[0-9]) {
            message( "g++ version 5.x found" )
            CONFIG += g++5
        } else {
            contains(GCC_VERSION, 4.[0-9]) {
                message( "g++ version 4.x found" )
                CONFIG += g++4
            } else {
                message( "Unknown GCC configuration" )
            }
        }
    }
} 
```

如您所见，您可以从 GCC 获取版本，然后将其与正则表达式进行比较。

使用方法是一样的：

```
SOURCES += blah blah2 blah3
g++4: SOURCES += blah4 blah5 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T10:33:39.153

首先，我会看一下 qmake 支持的作用域功能：

[范围和条件](http://doc.qt.io/qt-4.8/qmake-advanced-usage.html#scopes-and-conditions)

但是当我读到它时，似乎默认情况下您可以使用一般平台条件，例如`win32`or`unix`或者您可以使用 qmake 规范的名称，例如`linux-g++`. 您可以像这样测试 Visual Studio 版本（因为不同的 Visual Studio 版本使用不同的 qmake 规范），但我认为您不能像这样测试 gcc 版本（至少我不知道如何）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-11-16T17:16:49.313

我的回答是基于[dismine 的回答](https://stackoverflow.com/a/38813297/4304606)
我们可以简单地使用 $$str_member 提取主要版本号

```
gcc | clang {
    COMPILER_VERSION = $$system($$QMAKE_CXX " -dumpversion")
    COMPILER_MAJOR_VERSION = $$str_member($$COMPILER_VERSION)
    greaterThan(COMPILER_MAJOR_VERSION, 3): message("gcc 4 or later")
    greaterThan(COMPILER_MAJOR_VERSION, 4): message("gcc 5 or later")
    greaterThan(COMPILER_MAJOR_VERSION, 5): message("gcc 6 or later")
    greaterThan(COMPILER_MAJOR_VERSION, 6): message("gcc 7 or later")
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-04T12:29:37.417

我愿意

```
isEmpty(MGWVER) {
    MGW_MAJ = $$system(echo | gcc -dM -E - | fgrep __GNUC__ | cut -d\" \" -f 3)
    MGW_MIN = $$system(echo | gcc -dM -E - | fgrep __GNUC_MINOR__ | cut -d\" \" -f 3)
    MGWVER =$$MGW_MAJ$$MGW_MIN
    message(MGWVER $$MGWVER)
} 
```

它返回“48”。我用它来链接适当的 boost 库：

```
USER_BOOST_CFG=mgw$${MGWVER}-mt-s-$$(BOOST_VER)
message($$USER_BOOST_CFG)
LIBS *= -L$$(BOOST_ROOT)/lib
LIBS *= -L$$(BOOST_ROOT)/stage/lib

LIBS *= -lboost_system-$$USER_BOOST_CFG
LIBS *= -lboost_filesystem-$$USER_BOOST_CFG
LIBS *= -lboost_date_time-$$USER_BOOST_CFG 
```

有效地给予：-lboost_system-mgw48-mt-s-1_54

我在mingw。

另一个想法是查看 QMAKESPEC 变量并从中解析，提示：

```
message(QMAKESPEC $$QMAKESPEC)
SPLITED=$$section(QMAKESPEC, "/", 0, -3)
message(SPLITED $$SPLITED) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T09:16:34.440

每个编译器供应商都使用定义一些特定的符号来标识编译器和版本。您可以使用这些符号进行检查。

例如，我知道 _MSC_VER 提供了 Microsoft C++ 编译器的版本。

我还知道 Boost Libraries 使用这种特征选择和适应。

您可以查看包含文件夹中的 Boost Config 标头，位于路径： boost/config/* ，特别是在 select_compiler_config.hpp。

通过使用这些编译器特定的符号，您可以在构建代码的预处理阶段进行特征选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-29T16:06:40.087

在我的 gcc 和 g++ 版本中定义了以下宏

```
#define __GNUC__ 4 
#define __GNUC_MINOR__ 0
#define __GNUC_PATCHLEVEL__ 1 
```

另外 g++ 定义：

```
#define __GNUG__ 4 
```

# windows - Windows 服务（密钥）名称中的有效字符是什么？

> ID：801280
> 
> 赞同：17
> 
> 时间：2009-04-29T07:38:26.923
> 
> 标签：windows, windows-services

有谁碰巧知道 Windows 服务密钥名称的约定是什么，哪些字符是合法的？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-29T07:51:12.867

基于用于创建服务的底层 C++ 结构的[文档：](http://msdn.microsoft.com/en-us/library/ms682450(VS.85).aspx)

> 最大字符串长度为 256 个字符。服务控制管理器数据库保留字符的大小写，但服务名称比较始终不区分大小写。正斜杠 (/) 和反斜杠 (\) 不是有效的服务名称字符。

此外，以下规则适用于“显示名称”：

> 此字符串的最大长度为 256 个字符。该名称在服务控制管理器中保留大小写。显示名称比较始终不区分大小写。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-11-21T09:18:24.347

Richard Szalay 回复的附加信息。

根据[ServiceInstaller.ServiceName](https://docs.microsoft.com/en-us/dotnet/api/system.serviceprocess.serviceinstaller.servicename?redirectedfrom=MSDN&view=netframework-4.8#remarks)

> ServiceName 不能为空或长度为零。...它也不能包含 ... ASCII 字符集中的字符，其值小于十进制值 32。

# c++ - 是否有工具可以监视 Windows 中的同步对象（互斥体、事件、信号量）？

> ID：801284
> 
> 赞同：9
> 
> 时间：2009-04-29T07:38:40.637
> 
> 标签：c++, windows, visual-studio, synchronization

在 Windows 中，有没有工具可以监控进程同步对象的状态？IE。

*   事件/互斥：有信号或没有信号
*   信号量：计数

更好的是，记录哪个线程做了什么，例如。“线程 #5421 信号事件 - testevt”

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-29T08:28:53.447

[内存验证器](http://www.memoryvalidator.com/cpp/memory/memval_object.html)

[进程浏览器](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)

[句柄](http://technet.microsoft.com/en-us/sysinternals/bb896655.aspx) 用法：句柄 -s ==> `Print count of each type of handle open.`

**[编辑]**：

**如何使用 Process Explorer 监控进程同步对象的状态。**

打开进程资源管理器

*   在进程部分单击您的 exe（例如：MyApp.exe）
*   单击`Show Lower Pane`（或按`Ctrl+L`）。这将显示所有同步对象。（例如：我的事件）
*   右键单击同步对象（例如：myEvent），然后单击上下文菜单中的属性...。
*   这带来了同步对象的细节。在`Details`选项卡中，您可以看到

    `Event Info`（如果同步对象是事件）：提供有关状态的信息（同步对象是否发出信号）

    `Semaphore info`（如果同步对象是信号量）：提供信号量的计数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T07:50:05.647

看看英特尔的 ThreadChecker 和 Parallel Studio。他们的大多数工具都位于 Visual Studio 之上。

[http://software.intel.com/en-us/intel-vtune/](http://software.intel.com/en-us/intel-vtune/)

[http://software.intel.com/en-us/intel-thread-checker/](http://software.intel.com/en-us/intel-thread-checker/)

[http://software.intel.com/en-us/intel-vtune/](http://software.intel.com/en-us/intel-vtune/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-07T15:23:13.483

[线程验证器](http://www.softwareverify.com/cpp/thread/index.html)执行您所描述的操作。

监控线程、锁状态、单个线程对象。比 Intel 的 Thread Checker 快得多，但细节程度不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T11:58:35.067

Windbg 可能会有所帮助，但您必须学习如何使用它。

# delphi - 模拟 Indy 的传入网络消息

> ID：801289
> 
> 赞同：0
> 
> 时间：2009-04-29T07:39:13.473
> 
> 标签：delphi, networking, indy

是否可以使用 Indy 模拟传入消息（如果它很重要：我使用的是 Indy 10 和 Delphi 2009）？我希望能够在本地创建这些消息，并且我希望 Indy 相信它们来自网络中的特定客户端。所有内部 Indy 处理（选择接收消息的线程等）应该与消息通过网络到达时完全相同。

有什么想法吗？提前感谢您的任何提示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T09:03:16.347

您想要做的与 Indy 无关，因为您需要在低得多的级别上执行此操作。让 Indy 相信消息来自特定客户端的最简单方法是将适当准备的数据包注入网络堆栈。在 Google 或 Wikipedia 上阅读 TCP 数据包注入。[EtterCap](http://ettercap.sourceforge.net/)就是这样一种工具，它允许将数据包注入已建立的连接。但是，这肯定会进入灰色地带，因为某些工具在某些国家/地区是非法的。

无论如何，所有这一切都是恕我直言太复杂了。我不知道您到底想做什么，但是专门准备的客户端或服务器是在开发服务器或客户端应用程序时模拟某些行为的更好工具。你可以在本地运行它们，或者如果你需要不同的 IP 地址或子网，你可以用虚拟机做很多事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T08:40:33.933

Indy 没有为此提供任何内置机制，但我不由自主地建议构建一个小型测试应用程序（或套件），该应用程序在您的开发机器上本地运行并连接到您的 Indy 服务器应用程序以重播消息.

如果 TCP 连接是在本地或从远程主机建立的，那么它应该与您的 Indy 服务器应用程序无关，因为创建服务器线程和处理命令的机制与这两种情况相同。

我的最后一次工作涉及使用 Indy，我们所有的测试都是使用类似的 Resender 类型的应用程序完成的，该应用程序将加载本地消息文件并将这些文件发送到 Indy 服务器应用程序。

HTH，祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T16:00:34.720

您可以做的一件事是创建虚拟机来运行您的测试客户端，这样它们就不会被视为“本地机器”，并且使用 VMS 创建一个复杂的网络相当简单——只要您有足够的内存和磁盘空间。使用 VM 进行测试的另一个优点是，您可以在专注于部署的时候完全消除开发环境。令人惊讶的是，一个人可以节省多少时间。

[VirtualPC](http://www.microsoft.com/windows/products/winfamily/virtualpc/default.mspx)可从 Microsoft 免费下载，并且运行良好。 [VMWare](http://www.vmware.com/)有另一种选择，但入门成本要高一些。出于开发目的，我更喜欢桌面版本，但服务器版本也很好用。您仍然需要获得许可证才能安装虚拟操作系统。 [MSDN](http://msdn.microsoft.com/en-us/subscriptions/aa718656.aspx)会员资格可能是最便宜的方式，它允许您为其他风格的操作系统构建测试环境。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-06T20:59:57.920

Indy 具有跨平台支持的抽象堆栈机制（IDStack.pas）我认为你可以破解 Windows 的堆栈（IdStackWindows.pas）。这是一个类。你甚至可以考虑派生它并覆盖一些函数来进行破解。

# firewall - ip6tables 有 connlimit 模块吗？

> ID：801298
> 
> 赞同：0
> 
> 时间：2009-04-29T07:42:08.583
> 
> 标签：firewall, iptables

有谁知道是否有可用于 ip6tables 的 connlimit 模块？请告诉我。

谢谢，肯尼斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-07T20:43:01.947

是的，在这里（它可能需要内核补丁）：

ip6tables -p tcp --syn --dport 80 -s fe80::/64 -m connlimit --connlimit-above 16 --connlimit-mask 64 -j REJECT

# flash - 在silverlight中嵌入闪光灯

> ID：801304
> 
> 赞同：1
> 
> 时间：2009-04-29T07:44:56.173
> 
> 标签：flash, silverlight, embed

如果提供了源文件，您如何在 Silverlight 中嵌入 Flash 视频？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T09:24:35.273

最后我得到了答案，

```
string mediaUrl= http://www.youtube.com/v/h8Ek3v1RBEU&hl=en&fs=1;

HtmlElement mediaContent = HtmlPage.Document.GetElementById("MediaDiv"); 
HtmlElement mediaObject = HtmlPage.Document.CreateElement("Object");

mediaObject.Id = "mediaObject"; 
mediaContent.AppendChild(mediaObject);

HtmlElement param = HtmlPage.Document.CreateElement("param"); 
param.Id = "MediaID";

param.SetAttribute("name", "movie"); 
param.SetAttribute("value", mediaUrl);

param.SetAttribute("valuetype", "ref"); 
mediaObject.AppendChild(param);

HtmlElement embed = HtmlPage.Document.CreateElement("embed"); 
embed.SetAttribute("src", mediaUrl);

embed.SetAttribute("width", "425px"); 
embed.SetAttribute("height", "344px");

embed.SetAttribute("allowscriptaccess", "always"); 
mediaContent = HtmlPage.Document.GetElementById("MediaDiv");
        mediaContent.SetAttribute("innerHTML", jsText);
        head.AppendChild(mediaContent); 

mediaContent.SetStyleAttribute("display", "block"); 
```

这样我们就可以嵌入一个flash文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T08:04:54.630

好吧，这似乎不是一个好主意。但我尊重，因为这可能是你的要求。

类似的讨论在这里可用：http: [//channel9.msdn.com/forums/TechOff/257390-Silverlight-can-i-embed-a-flash-object-/](http://channel9.msdn.com/forums/TechOff/257390-Silverlight-can-i-embed-a-flash-object-/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T03:58:29.483

在 Silverlight 3 中有原始音频/视频功能，理论上您可以将 .flv 渲染到 Silverlight 中。话虽如此，请在此处研究您的编解码器许可证，并确保您遵守 Adob​​e 的 EULA/条款和条件等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T02:17:32.313

拉姆亚，

对不起，我不知道。Silverlight 3 是这里唯一现实的策略，可能有一些方法可以使用您自己的本机包装器或类似的东西来固定它，但使用这种方法有点冒险。

对不起！

# c++ - 如何解决 numeric_limits 的不一致定义 ::分钟（）？

> ID：801313
> 
> 赞同：13
> 
> 时间：2009-04-29T07:49:38.923
> 
> 标签：c++, standard-library

numeric_limits 特征应该是获取各种类型信息的通用方法，以便能够执行以下操作

```
template<typename T>
T min(const std::vector<T>& vect)
{
    T val = std::numeric_limits<T>::min();

    for(int i=0 ; i<vect.size() ; i++)
        val = max(T, vect[i]);

    return val;
} 
```

问题是（至少使用 MS Visual Studio 2008） numeric_limits<int>::min() 返回最小的负数，而 numeric_limits<double>::min() 返回最小的*正*数！

有人知道这种设计背后的原理吗？有没有更好的（推荐的？）使用 numeric_limits 的方法？在我上面的特定函数中，我当然可以将 T 初始化为 vect[0]，但这不是我要寻找的答案..

[另请参阅此处](http://lists.kde.org/?l=kde-devel&m=114621233629277&w=2)的（浮点特定）讨论

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-29T08:43:08.280

您可以使用 Boost 库。Numeric Conversions 库提供了一个可以一致使用的称为边界的类。

[请参阅此处](http://www.boost.org/doc/libs/1_38_0/libs/numeric/conversion/doc/html/boost_numericconversion/bounds___traits_class.html)的文档。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-20T18:27:40.117

这是一个旧线程，但有一个更新的答案：

C++11 添加了一个`lowest()`函数`std::numeric_limits`（[见这里](http://www.cplusplus.com/reference/limits/numeric_limits/)）

因此，您现在可以调用`std::numeric_limits<double>::lowest()`以获取可表示的最低负值。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-29T08:52:51.707

min() 的行为并不奇怪，它返回`FLT_MIN`, `DBL_MIN`or `INT_MIN`（或它们各自的值），具体取决于您专门研究的类型。所以你的问题应该是为什么`FLT_MIN`和`DBL_MIN`定义不同`INT_MIN`。

不幸的是，我不知道后一个问题的答案。

我怀疑它是出于实际目的而定义的。对于整数，您通常关心上溢/下溢，其中最小值和最大值变得重要。

对于浮点数，存在一种不同类型的下溢，因为计算可能导致大于零但小于该浮点类型的最小可表示小数的值。知道最小的可表示浮点值可以让您解决这个问题。另请参阅关于[次正规/非正规](http://en.wikipedia.org/wiki/Denormal)数的 Wikipedia 文章。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T09:30:04.487

我不确定理由，但这是预期的行为。好吧，从某种意义上说，这就是 Josuttis（并且可能是标准）描述它的方式！

> min()：“最小有限值（具有非规范化的浮点类型的最小规范化值）。”

尽我所能判断该类型是否*不是*整数 ( `numeric_limits<>::is_integer`) 并且*具有*非规范化 ( `numeric_limits<>::has_denorm`)`min()`将返回该类型的最小可表示值。否则它将返回最小值*-*这可能是负数。

要获得更一致的界面，请查看[Boost numeric/conversion](http://www.boost.org/doc/libs/1_38_0/libs/numeric/conversion/doc/html/index.html)库。特别是[`bounds`特征类](http://www.boost.org/doc/libs/1_38_0/libs/numeric/conversion/doc/html/boost_numericconversion/bounds___traits_class.html)。这是一个片段：

```
cout << "lowest float:" << boost::numeric::bounds<float>::lowest();
cout << "lowest int:  " << boost::numeric::bounds<int>::lowest(); 
```

您可能还会发现[boost::integer 库](http://www.boost.org/doc/libs/1_38_0/libs/integer/index.html)很有用。它为 C++ 带来了 C99 的一些整数支持（如`int_least16_t`），并可以帮助您选择最适合您特定需要的大小类型。一个例子：

```
boost::uint_t<20>::fast fastest20bits; // fastest unsigned integer that 
                                       // can hold at least 20 bits.
boost::int_max_value_t<100000>::least  // smallest integer that can store
                                       // the value 100000. 
```

我经常发现，当我需要 boost::numeric/conversion 或 boost::integer 之一时，我都需要它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T15:05:53.010

`numeric_limits<int>::min`返回**最小**的负数，所有浮点数类型，当我用 Sun CC & g++ 尝试时返回**最小的正数。**

我想这是因为“最小”和“最小”对浮点数意味着不同的东西。不过这有点奇怪。

Sun CC 和 g++ 都产生相同的结果：

> 短：最小：-32768 最大：32767
> 
> 整数：最小值：-2147483648 最大值：2147483647
> 
> 无符号整数：最小值：0 最大值：4294967295
> 
> 长：最小：-2147483648 最大：2147483647
> 
> 浮动：最小：1.17549e-38 最大：3.40282e+38
> 
> 双倍：最小：2.22507e-308 最大：1.79769e+308
> 
> 长双：最小：3.3621e-4932 最大：1.18973e+4932
> 
> 无符号短：最小值：0 最大值：65535
> 
> 无符号整数：最小值：0 最大值：4294967295
> 
> 无符号长：最小值：0 最大值：429496729

```
template<typename T>
void showMinMax()
{
    cout << "min: " << numeric_limits<T>::min() << endl;
    cout << "max: " << numeric_limits<T>::max() << endl;
    cout << endl;
}

int main()
{
cout << "short:";
showMinMax<short>()
...etc...etc.. 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T08:09:43.900

一种解决方法是

```
double val = -std::numeric_limits<double>::max(); 
```

当然，这并不能解释 numerics_limits::min() 的奇怪行为，这可能是因为整数有不同的最小/最大边界（min = -2^n，max = 2^n- 1）但不适用于双打。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-29T09:11:03.643

可以争论空向量的最小值的定义。如果向量为空，则没有最小元素。

更喜欢使用[std::min_element](http://en.cppreference.com/w/cpp/algorithm/min_element)代替：

```
int main()
{
    std::vector<int> v;
    std::generate_n(std::back_inserter(v), 1000, std::rand);

    std::vector<int>::iterator it  = std::min_element(v.begin(), v.end());
    if (it == v.end())
    {
        std::cout << "There is no smallest element" << std::endl;
    }
    else
    {
        std::cout << "The smallest element is " << *it << std::endl;
    }
} 
```

# javascript - 为什么 JSON 很重要？

> ID：801317
> 
> 赞同：27
> 
> 时间：2009-04-29T07:50:06.333
> 
> 标签：javascript, xml, json, dataformat

我最近才听说 JSON（Javascript Object Notation）。谁能解释为什么它被认为（某些网站/博客/等）很重要？我们已经有了 XML，为什么 JSON 更好（除了“原生于 Javascript”）？

编辑：嗯，主要答案主题似乎是“它更小”。但是，它允许跨域获取数据这一事实对我来说似乎很重要。或者这在实践中还没有（还）被广泛使用吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-29T07:54:20.457

XML 有几个缺点：

*   很重！
*   它提供了与 Javascript 对象模型不完全相同（但非常相似）的内容的分层表示。
*   Javascript 无处不在。无需任何外部解析器，您可以直接使用 JS 解释器处理 JSON。

显然，它并不是要完全取代 XML。对于基于 JS 的 Web 应用程序，它的优点可能很有用。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-29T07:53:24.767

JSON 通常比等效的 XML 小得多。较小的传输意味着更快的传输，从而带来更好的用户体验。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-29T07:56:31.450

JSON 更加简洁。XML:

```
<person>
    <name>John Doe</name>
    <tags>
        <tag>friend</tag>
        <tag>male</tag>
   </tags>
</person> 
```

JSON：

```
{"name": "John Doe", "tags": ["friend", "male"]} 
```

重叠的特征也更少。例如，在 XML 中，在选择使用元素（如上）和属性（`<person name="John Doe">`）之间存在矛盾。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-04-29T08:07:06.497

JSON 之所以流行，主要是因为它提供了一种方法来规避 Web 浏览器中使用的同源策略，从而允许混搭。

假设您正在域 A 上编写 Web 服务。您无法从域 B 加载 XML 数据并对其进行解析，因为这样做的唯一方法是 XMLHttpRequest，而 XMLHttpRequest 最初受到同源策略的限制，只能进行交谈仅限与包含页面位于同一域的 URL。

事实证明，由于各种原因，您*可以*跨来源请求 <script> 标签。聪明的人意识到这是解决 XMLHttpRequest 限制的好方法。它可以返回一系列 JavaScript 对象和数组文字，而不是服务器返回 XML。

（作为练习留给读者的额外问题：为什么 <script src="..."> 在没有服务器选择加入的情况下允许跨域但 XHR 不允许？）

当然，返回一个仅由对象字面量组成的 <script> 是没有用的，因为如果不将值分配给某个变量，您将无法对它做任何事情。因此，大多数服务使用 JSON 的变体，称为 JSONP ( [http://bob.pythonmac.org/archives/2005/12/05/remote-json-jsonp/](http://bob.pythonmac.org/archives/2005/12/05/remote-json-jsonp/) )。

随着混搭的普及，人们意识到 JSON 通常是一种方便的数据交换格式，尤其是当 JavaScript 是通道的一端时。例如，JSON 在 Chromium 中被广泛使用，即使在 C++ 双方都使用的情况下也是如此。这只是表示简单数据的一种很好的轻量级方式，在许多语言中都存在良好的解析器。

有趣的是，使用 <script> 标签来做 mashup 是非常不安全的，因为它本质上是故意的 XSS。因此必须引入原生 JSON ( [http://ejohn.org/blog/native-json-support-is-required/ )，这消除了格式的原始优势。](http://ejohn.org/blog/native-json-support-is-required/)但到那个时候，它已经超级流行了:)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-30T00:10:27.880

如果您使用 Javascript 工作，那么我们使用 JSON 会容易得多。这是因为 JSON 可以直接评估为 Javascript 对象，这比 DOM 更容易使用。

从上面借用并稍微修改 XML 和 JSON

```
XML:

<person>
    <name>John Doe</name>
    <tag>friend</tag>
    <tag>male</tag>
</person>

JSON:

{ person: {"name": "John Doe", "tag": ["friend", "male"]} } 
```

如果您想使用 XML 获取第二个标记对象，则需要使用功能强大但冗长的 DOM api：

```
var tag2=xmlObj.getElementsByTagName("person")[0].getElementsByTagName("tag")[1]; 
```

而对于通过 JSON 传入的 Javascript 对象，您可以简单地使用：

```
var tag2=jsonObj.person.tag[1]; 
```

当然，Jquery 使 DOM 示例更加简单：

```
var tag2=$("person tag",xmlObj).get(1); 
```

然而，JSON 只是“适合” Javascript 世界。如果您使用它一段时间，您会发现与涉及基于 XML 的数据相比，您的脑力开销要少得多。

上述所有示例都忽略了一个或多个节点可用、重复的可能性，或者该节点只有一个或没有子节点的可能性。但是，为了说明 JSON 的原生性，要使用 jsonObj 执行此操作，您只需：

```
var tag2=(jsonObj.person && jsonObj.person.tags && jsonObj.person.tags.sort && jsonObj.person.tags.length==2 ? jsonObj.person.tags[1] : null); 
```

（有些人可能不喜欢这么长的三元，但它有效）。但是 XML 会（在我看来）更糟糕（我不认为你会想要采用三元方法，因为你会不断调用 dom 方法，这些方法可能不得不根据实现再次完成工作）：

```
var tag2=null;
var persons=xmlObj.getElementsByTagName("person");
if(persons.length==1) {
    var tags=persons[0].getElementsByTagName("tag");
    if(tags.length==2) { tag2=tags[1]; }
} 
```

jQuery（未经测试）：

```
var tag2=$("person:only-child tag:nth-child(1)",xmlObj).get(0); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-29T07:54:08.320

这些网页可能会有所帮助：

1.  [JSON - xml 的无脂肪替代品](http://www.json.org/fatfree.html)
2.  [为什么 JSON 对您很重要！](http://www.xfront.com/json/index.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-29T13:06:36.743

这取决于你要做什么。这里有很多答案更喜欢 JSON 而不是 XML。仔细看的话，差别不大。

如果你有一棵对象树，你只会得到 javascript 对象树。如果您看一下使用 OOP 样式访问的压力，而不是回头看您。假设您有一个在树中构造的 A、B、C 类型的对象。您可以轻松地将它们序列化为 JSON。如果你把它们读回来，你只会得到一个 javascript 对象树。要重建您的 A、B、C，您必须手动将值填充到手动创建的对象中，或者进行一些黑客操作。听起来像是解析 XML 和创建对象？嗯，是 ：）

如今，只有最新的浏览器带有对 JSON 的原生支持。要支持更多浏览器，您有两种选择：a）您在 javascript 中加载一个 json 解析器来帮助您解析。那么，这听起来有多胖？我经常看到的另一个选项是 eval。您可以对 JSON 字符串执行 eval() 来获取对象。但这引入了一系列全新的安全问题。指定了 JSON，因此它不能包含函数。如果您不检查对象的功能，有人可以轻松地向您发送正在执行的代码。

所以它可能取决于你更喜欢什么：JSON 或 XML。最大的区别可能是访问事物的方式，无论是脚本标签 XMLHTTPRequest ......我会决定使用什么。在我看来，如果浏览器中对 XPATH 有适当的支持，我通常会决定使用 XML。但时尚是针对 json 并在 javascript 中加载额外的 json 解析器。

如果你不能决定并且你知道你需要一些真正强大的东西，你就必须看看 YAML。阅读有关 YAML 的内容非常有趣，可以更深入地了解该主题。但这实际上取决于您要做什么。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-29T17:50:49.010

JSON 是一种基于文本的对象序列化格式，它比 XML 更轻量级，并且直接与 JavaScript 的对象模型集成。这就是它的大部分优势。

它的缺点（与 XML 相比）大致是：可用工具较少（忘记标准验证和/或转换，更不用说大多数编辑器中的语法突出显示或格式良好检查），不太可能是人类可读的（有巨大的JSON 和 XML 的可读性不同，因此这必然是一个模糊的陈述），与 JavaScript 的紧密集成导致与其他环境的集成不太紧密。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-29T07:57:48.343

[JSON](http://json.org/)是一种在 Javascript 对象中序列化数据的方法。语法取自语言，因此处理 Javascript 的开发人员应该熟悉它，并且 - 作为对象的字符串化 - 它是一种在浏览器内进行交互的更自然的序列化方法，而不是成熟的 XML 衍生产品（包含所有暗示的任意设计决策）。

它轻巧直观。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-29T07:52:31.460

并不是说它更好，而是它可以将许多东西捆绑在一起，从而无需手动解析即可实现无缝数据传输！

例如 javascript -> C# Web 服务 -> javascript

# charts - Winforms / GDI+ 为图表绘制曲线

> ID：801319
> 
> 赞同：5
> 
> 时间：2009-04-29T07:52:24.643
> 
> 标签：charts, graph-layout, graph-drawing

在我的 Winforms 应用程序中，我有一个小图表。没有什么比我用线连接的一堆 x/y 点好。

画一条曲线而不是一条线来连接这些点会很好。但由于数学从来都不是我的强项，我不知道该怎么做。

任何类型的样本或建议都会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T07:59:40.163

这非常简单 - 不需要任何数学运算 - 只需使用 Graphics.DrawCurve 而不是 DrawPolygon/DrawLine（请参阅此函数的非常好的帮助）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-19T09:49:38.563

为线程复活道歉，但我不得不回复这个：

**清楚你想要达到的目标。**我不知道您项目的详细信息，但建议的方法不适用于许多应用程序。正确的解决方案取决于您是否希望绘制的曲线看起来很漂亮，或者表示有意义的数据。对于前者，绘制贝塞尔曲线很好，但它们**不是**具有数学意义，如果您试图绘制一个图表以科学严谨地解释，它们会误导用户。对于许多应用程序，您需要的是最合适的生产线。它们具有明确的函数形式，例如，2 次多项式（也称为抛物线）、对数曲线或移动平均线。所有这些都存在于 Excel 中，并且都有特定的应用程序，并且对于超出其特定职权范围的任何事情来说都是错误的选择。数据统计分析的主题可能超出了 StackOverflow 帖子的范围 - 但首先，查找“线性回归”，您所描述的内容已被该数学领域全面处理。

# javascript - 如何使用 Javascript 在文本区域中选择字符范围？

> ID：801325
> 
> 赞同：0
> 
> 时间：2009-04-29T07:53:51.893
> 
> 标签：javascript, internet-explorer-6, textarea

简单的问题 - 有没有办法使用 Javascript 选择 <textarea> 控件中显示的文本子集？

例如具有类似的功能

selectText(startCharNo, endCharNo, textareaName);

它还需要与 IE6 兼容。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T07:59:29.277

是的，有可能

```
element.focus();
if(element.setSelectionRange)
   element.setSelectionRange(startCharNo, endCharNo);
else {
   var r = element.createTextRange();
   r.collapse(true);
   r.moveEnd('character', endCharNo);
   r.moveStart('character', startCharNo);
   r.select();   
} 
```

element 是对 textarea 的引用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T07:56:59.810

创建文本范围（）

[http://www.developerfusion.com/forum/thread/48987/](http://www.developerfusion.com/forum/thread/48987/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T08:07:35.403

```
selectText(startCharNo, endCharNo, textAreaName){
   var content = document.getElementById(textAreaName).innerHTML; //value may work too
   var piece = content.subString(startCharNo, endCharNo);
   return piece;
} 
```

# mysql - 用于大量 1kB 数据块的数据库（MySQL？）

> ID：801333
> 
> 赞同：1
> 
> 时间：2009-04-29T07:55:35.167
> 
> 标签：mysql, database, performance

我有一个非常大的数据集，数据集中的每个项目的大小大约为 1kB。分布在网络上的许多应用程序需要快速查询数据。该数据集有超过一百万个项目（即 5 亿+ 1kB 数据块）。

存储此数据集的最佳方法是什么（需要允许添加更多项目并快速读取它们，但从不修改已添加的数据）？使用二进制 blob 格式的 MySQL 数据库是否合适？

还是应该将它们中的每一个都存储为文件系统上的文件？

编辑：这个数字现在是 100 万个项目，但需要能够轻松扩展到超过 5 亿个项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-04T12:44:20.950

因为不需要索引对象内部的任何东西。我不得不说文件系统可能是你最好的选择，而不是关系数据库。由于只有一个唯一的 ID 和一个 blob，因此这里实际上没有任何结构，因此将其放入数据库没有任何价值。

您可以使用 Web 服务器来提供对存储库的访问。然后是像 nginx w/memcache 这样的缓存解决方案，将其全部保存在内存中并使用负载平衡进行横向扩展。

如果您遇到进一步的性能问题，您可以删除文件系统并像 Facebook 使用他们的照片系统一样滚动自己的文件系统。这可以减少不必要的 IO 操作，用于从文件系统中提取不需要的元数据（如安全信息）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-29T07:56:57.207

那是 1 GB 的数据。你打算用数据库做什么？

那绝对只是一个文件，启动时将其读入ram。

扩展到 5 亿很容易。这只需要更多的机器。根据精确的应用程序特性，您可能能够规范化或压缩 ram 中的数据。

您可能可以将内容保存在磁盘上并使用数据库，但这严重限制了您在同时访问方面的可伸缩性。您从磁盘获得 50 次磁盘访问/秒，因此只需计算您需要多少磁盘。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-29T08:00:33.017

如果您需要检索保存的数据，那么存储在文件中肯定不是一个好主意。

MySQL 是一个不错的选择。但请确保您设置了正确的索引。

关于二进制blob。这取决于您打算存储什么。给我们更多的细节。

# perl - 我应该如何为新用户生成一个随机的字母数字初始密码？

> ID：801347
> 
> 赞同：5
> 
> 时间：2009-04-29T08:00:19.663
> 
> 标签：perl, passwords, alphanumeric

我们必须自动将带有一些数据的大量用户导入到正在运行的系统中。对于初始密码，我想使用随机字母数字密钥（8 位）更新列表（目前为 csv 格式）。

当使用特殊例程（需要 csv 文件）插入密码时，密码（在本例中为字母数字键）存储为 md5 哈希。

即我生成一个随机的字母数字密钥：

```
H2A5D39A -> MD5: 1642fccf791f15d137cf31282af79752 
```

这样我想创建一个列表，经过身份验证的用户可以向我询问他们的初始密码（字母数字密钥）。

您对“秘密”初始密码有更好的想法吗？

你将如何在 Perl 中创建字母数字键？

PS：“运行系统”，不是我们编程的，只允许字母数字密码（没有特殊字符，...）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-29T08:06:40.287

> 你将如何在 Perl 中创建字母数字键？

join'', map +(0..9,'a'..'z','A'..'Z')[rand(10+26*2)], 1..8

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-29T09:58:39.677

我可能会使用 pwgen。它很棒，因为它可以轻松定制，并且可以切换不使用不明确的字符（想想：I、l、1、O、0）。

例如：

```
=> pwgen -c -n -B 8 50
shuFak9o peiCh3Oo ohPieng9 Vohh7zuu os3Theep aeV9nuo9 aexeik4B aeChoh9s
uth3eePu baePhu3o aiS3pahn iPie4itu We9zuphi xie3Chi3 yeiRoo7c fai3ITai
aCh9ohco Echuab7v Fu9ahCho Aevae4no Peethai9 AiJio3Pa aeNge9Fo baePh7Uy
Nai7shei eeMoh9en Zeibai4n eGe7yuch Jaek7nai aeZah7sh Chei4ua4 shoo9oG9
iu7Wohho aep7De4U Fong9fo3 AhneeP7U oxae7Yoh ahF4eim3 fahm9Aiw naoNg4ie
Chie4xua jix3Uvot aChei7ai diey4Shi Yur7ee4j eeJeo9ee Bou3ahmu kaeb4Cah
Eh4Eemae oD4phoo9 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T14:21:58.340

Anonymous 的回答非常好，但是，如果您需要一个符合某些规则的随机字符串（例如至少一个大写、一个小写和一个数字），您可能需要查看[String::Random](http://search.cpan.org/dist/String-Random/lib/String/Random.pm)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T17:57:07.357

另一个要考虑的模块是[Data::Random](http://search.cpan.org/perldoc?Data::Random)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-08T16:01:56.847

我刚刚完成了对 CPAN 上可用于生成随机密码的 12 个模块的回顾：

[http://blogs.perl.org/users/neilb/2011/08/random-password-generation.html](http://blogs.perl.org/users/neilb/2011/08/random-password-generation.html)

简而言之：如果您想要一个可发音的密码，请查看[Crypt::YAPassGen](http://search.cpan.org/~giulienk/Crypt-YAPassGen-0.02/lib/Crypt/YAPassGen.pm)，否则请使用[App::Genpass](http://search.cpan.org/~xsawyerx/App-Genpass-2.04/lib/App/Genpass.pm)。

App::Genpass 避免了易混淆的字符，并为您提供比 Data::Random 或 String::Random 更好的控制（和默认值）

# python - Django 等价于 PHP 的表单值数组/关联数组

> ID：801354
> 
> 赞同：45
> 
> 时间：2009-04-29T08:04:10.513
> 
> 标签：python, django, forms

在 PHP 中，我会这样做以获取`name`数组。

```
<input type"text" name="name[]" />
<input type"text" name="name[]" /> 
```

或者，如果我想获得`name`一个关联数组：

```
<input type"text" name="name[first]" />
<input type"text" name="name[last]" /> 
```

这些东西的 Django 等价物是什么？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-04-29T12:03:36.880

[查看 QueryDict 文档](http://docs.djangoproject.com/en/dev/ref/request-response/#querydict-objects)，尤其是[`QueryDict.getlist(key)`](http://docs.djangoproject.com/en/dev/ref/request-response/#django.http.QueryDict.getlist).

由于视图中的 request.POST 和 request.GET 是 QueryDict 的实例，您可以这样做：

```
<form action='/my/path/' method='POST'>
<input type='text' name='hi' value='heya1'>
<input type='text' name='hi' value='heya2'>
<input type='submit' value='Go'>
</form> 
```

然后是这样的：

```
def mypath(request):
    if request.method == 'POST':
        greetings = request.POST.getlist('hi') # will be ['heya1','heya2'] 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2011-01-20T10:34:39.327

很抱歉挖掘了这个，但 Django 有一个 utils.datastructures.DotExpandedDict。这是它的文档的一部分：

```
>>> d = DotExpandedDict({'person.1.firstname': ['Simon'], \
        'person.1.lastname': ['Willison'], \
        'person.2.firstname': ['Adrian'], \
        'person.2.lastname': ['Holovaty']})
>>> d
{'person': {'1': {'lastname': ['Willison'], 'firstname': ['Simon']}, '2': {'lastname': ['Holovaty'], 'firstname': ['Adrian']}}} 
```

唯一的区别是您使用点而不是括号。

编辑：此机制已被表单前缀取代，但如果您仍想使用此概念，您可以在应用程序中放入旧代码： [https ://gist.github.com/grzes/73142ed99dc8ad6ac4fc9fb9f4e87d60](https://gist.github.com/grzes/73142ed99dc8ad6ac4fc9fb9f4e87d60)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-29T23:40:42.790

Django 不提供从请求对象获取关联数组（Python 中的字典）的方法。正如第一个答案指出的那样，您可以`.getlist()`根据需要使用，或者编写一个可以接受 a`QueryDict`并根据自己的喜好重新组织它的函数（例如，如果键匹配某个`key[*]`模式，则提取键/值对）。

# regex - 正则表达式 $$ 是什么意思？

> ID：801358
> 
> 赞同：2
> 
> 时间：2009-04-29T08:05:03.007
> 
> 标签：regex, linux, unix

正则表达式 $$ 的计算结果是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T14:46:46.957

在 Perl 中，嵌入`$$`到正则表达式中会导致插入 perl 进程的 PID

```
# Suppose perl has a PID of 5432
my $str1 = "some";
my $str2 = "5432";

print "1 match: $str1" if $str1 =~ /^$$/;
print "2 match: $str2" if $str2 =~ /^$$/; 
```

输出：

```
2 match: 5432 
```

插入单个`$`将匹配行尾。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T14:29:33.423

除了允许在正则表达式中进行变量插值的语言之外，这种构造不太可能发生。在这种情况下，它很可能会匹配当前进程的进程 ID（因为`$$`通常是一个保存进程 ID 的变量）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T23:12:14.703

这取决于编程语言和正则表达式引擎。

*   在 Perl 中，`/$$/`匹配当前进程的 PID（进程 ID）（在 dsm 的答案中查看更多信息）。
*   在 Ruby 中，两者都`/$$/`匹配`/$/`第一个换行符之前的空字符串，或者如果字符串中没有换行符，则匹配字符串的结尾。
*   在 Python 中，两者都`re.search('$$', s)`匹配`re.search('$', s)`最后一个换行符之前的空字符串，或者如果字符串中没有换行符，则匹配字符串的结尾。
*   （其他语言或正则表达式引擎的行为可能不同。）

请注意，与正则表达式关联的标志（通常是`s`和标志）会影响匹配的内容。上面的项目使用默认标志。`m``$`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-29T08:18:03.753

它仅取决于底层的正则表达式引擎。例如，在 vim 中，它将匹配行尾的美元符号。我猜想 Posix 将要求引擎与 '$' 匹配，因为正如 Tomalak 指出的那样，该文字的长度为 0。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T08:32:57.730

这取决于底层的正则表达式引擎。但是在.Net框架System.Text.RegularExpressions.Regex类中，正则表达式中的$指定匹配必须出现在字符串的末尾，在字符串末尾的\n之前，或者在行的末尾，所以 $$ 将匹配一切！

（$$ 在替换模式中有另一个含义，它替换了单个“$”字面量。）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-29T08:36:55.240

通常是行尾的匹配器，但这取决于您使用的语言。没有这些具体信息很难回答。

顺便说一句，在 csh 中表示进程号。它不是正则表达式。

路易斯

# java - 映射属性文件中的数据

> ID：801360
> 
> 赞同：1
> 
> 时间：2009-04-29T08:05:12.740
> 
> 标签：java, data-structures, properties

我有以下数据：

```
User   System    SubSystem
user1  System1   SubSystem1
user2  System1   SubSystem2
user3  N/A       N/A 
```

我需要能够从用户那里确定系统/子系统元组。我必须能够随时添加用户，而无需重建和重新部署系统。

我知道数据库将是这里的最佳选择，但**我不能使用数据库表。**

我目前使用哈希映射对其进行映射，但我不希望它被硬编码。我正在考虑使用属性文件，但我无法想象我将如何实现它。还有人有什么建议吗？

没关系，但我在 weblogic 10.3 上使用 JAVA。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T08:07:29.943

您可以使用 HashMap 来执行此操作（就像您现在所做的那样）并使用[XStream](http://xstream.codehaus.org/)存储它。

XStream 允许您将 Java 对象序列化/反序列化到可读/可编辑的 XML。然后，您可以将其写入（例如）文件系统，并且可以手动编辑结果。

缺点是它是 Java 对象的 XML 序列化，所以不像要编辑的属性文件那么明显。然而，它仍然非常易读，并且任何远程技术人员都可以轻松理解。这是否是适当的解决方案取决于此文件的受众。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T08:58:22.933

听起来你可以很好地将[YAML](http://www.yaml.org/)用于..
[SnakeYAML](http://trac-hg.assembla.com/snakeyaml/wiki/Documentation)看起来是一个可行的 Java 实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T08:24:09.933

我会去做一些简单的事情：

```
user1 = userValue
user1.system = systemValue
user1.system.subsystem= subsystemValue
user2 = userValue
user2.system = systemValue
user2.system.subsystem= subsystemValue 
```

user(id) 用作属性中的“主”键，并通过非常简单的字段连接来存储表值。我经常使用这个：相信我，它比看起来更强大：）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T08:51:40.500

对于这个项目，我采用了 Olivier 提出的解决方案。一些项目约束（项目的遗留问题）阻止我采用可能更好的使用 XStream 的解决方案。

感谢反馈的家伙

# nant - Nant 构建错误——嵌套构建失败

> ID：801363
> 
> 赞同：0
> 
> 时间：2009-04-29T08:07:03.500
> 
> 标签：nant

我在目录中有一个 HelloNAnt.build 文件：

```
D:\third party components\nant\WhatThis 
```

我的 nant exe 位于

```
C:\Program Files\nant 
```

所以我 cd 到`D:\third party components\nant\WhatThis`，输入以下命令行：

```
"C:\Program Files\nant\bin\nant.exe" HelloNAnt.build 
```

我得到一个构建失败的错误，说`HelloNAnt.build`这个项目中不存在目标。

究竟出了什么问题？

的内容`HelloNAnt.build`：

```
<?xml version="1.0"?>
<project name="Hello World" default="hello">
    <target name="hello">
        <echo>Hello</echo>
    </target>
</project> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T18:59:51.107

您省略了该`-buildfile`选项，该选项指定您希望 NAnt 运行的构建文件的路径：

```
"C:\Program Files\nant\bin\nant.exe" -buildfile:HelloNAnt.build 
```

但是，在您的情况下，您根本不需要提供任何选项。NAnt 将在当前目录中搜索带有`.build`扩展名的文件并运行它。

# c# - DDD：添加和删除相关实体应该如何建模？

> ID：801371
> 
> 赞同：2
> 
> 时间：2009-04-29T08:08:04.013
> 
> 标签：c#, design-patterns, domain-driven-design

假设我们在域模型中有两个聚合根：组和用户。

现在，可以将用户添加到组或从组中删除。使用存储库模式，到目前为止我只建模了以下两个接口：

```
interface IGroupRepository
{
    Group FindById(int groupId);
}
interface IUserRepository
{
    User FindById(int userId);
    IQueryable<User> GetGroupMembers(int groupId);
    void AddUserToGroup(User user, Group group);
    void RemoveUserFromGroup(User user, Group group);
} 
```

不知怎的，感觉不太对劲。我想实现一个干净的域模型，而不仅仅是一个数据访问层。什么是对上述模型进行建模的更好方法？

**编辑：**这里的根本问题似乎是，DDD 的指导方针是否可以将用户视为“子对象”，同时它也是聚合根？据我了解 DDD，它指出只能从一个地方（存储库）检索和存储聚合根，所以这就是我有点困惑的原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T08:12:51.410

如果您使用诸如 NHibernate 之类的 ORM 来充分发挥它的潜力，您可以使用如下方法：

```
class Group
{
    List<User> members;

    void Join(User user)
    {
        members.Add(user);
    }

    void Leave(User user)
    {
        members.Remove(user);
    }
} 
```

一个体面的 ORM 将跟踪成员列表的更改并将这些更改保存到数据库中。

这将使您的界面简化为：

```
interface IGroupRepository
{
    Group FindById(int groupId);
}

interface IUserRepository
{
    User FindById(int userId);
} 
```

[这](http://nhforge.org/blogs/nhibernate/archive/2009/04/13/nhibernate-mapping-lt-set-gt.aspx)应该为您提供一些关于使用 NHibernate 执行此操作的指导。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T08:16:20.640

在这种情况下，我会考虑在用户上创建一组组，反之亦然。这样您就不需要在存储库上使用专门的方法。大多数 ORM 框架都支持这种映射

```
public class User
{
    public virtual ICollection<Group> Groups {get;set;}
} 
```

# c# - 构建本地立方体

> ID：801377
> 
> 赞同：1
> 
> 时间：2009-04-29T08:10:02.260
> 
> 标签：c#, vb.net, excel, olap, cube

我需要为使用 Excel 的客户端构建一个本地 .cub 文件。

我已经收集了一些 VB 代码，但它失败了：

```
ConnLocation = "LOCATION=C:\test.cub;"
ConnDSN = "SOURCE_DSN=DSN=TEST;UID=test;PWD=pass;"
ConnCreateCube = _
"CREATECUBE=CREATE CUBE [TestCube] (" & _
"DIMENSION [account_code]);"
Connection = CreateObject("ADODB.Connection")
Connection.Provider = "msolap"
Connection.ConnectionString = _
    ConnLocation & _
   ConnDSN & _
ConnCreateCube 
```

我已将其缩减为上面的代码，`OLE DB error: OLE DB or ODBC error.`当我尝试运行它时，我得到了一个神秘的 "。

对上述任何帮助或有关解决此问题的不同方法的建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T08:20:23.797

您的连接字符串 DSN 属性似乎错误：

```
ConnDSN = "SOURCE_DSN=""DSN=TEST;UID=test;PWD=pass;""" 
```

注意引号。

我会推荐一个小的代码更改，使其更直观和故障安全：

```
ConnLoc = "C:\test.cub"
ConnDSN = "DSN=TEST;UID=test;PWD=pass"
ConnSQL = "CREATE CUBE [TestCube] (DIMENSION [account_code])"

Connection = CreateObject("ADODB.Connection")
Connection.Provider = "msolap"
Connection.ConnectionString = "LOCATION=""" & ConnLoc & """;" & _
                              "SOURCE_DSN=""" & ConnDSN & """;" & _
                              "CREATECUBE=""" & ConnSQL & """;" 
```

# sql - 有没有一种方法可以在现有表中复制新列并从 Oracle 中的其他表中复制列信息？

> ID：801379
> 
> 赞同：0
> 
> 时间：2009-04-29T08:11:44.457
> 
> 标签：sql, database, oracle

您能否将我的 oracle 项目的答案转发给我？

我有两个不同的表，发票和客户。在发票表中我已经有一个名为日期的列，在客户表中我没有日期列并且我已经创建了。我不知道如何从发票表中获取日期数据。谁能帮我回答这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T09:43:07.233

我认为使用诸如“日期”之类的关键字作为列名或表名是自找麻烦。它应该是“creation_date”或“invoice_date”——更具描述性，而不是关键字。

如果这是正确的，那么客户表中的“日期”应该是“birth_date”或“signup_date”或其他对客户有意义的东西，而不仅仅是“invoice_date”的副本。DRY 原则和规范化规则说你不应该重复数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T15:33:18.590

尚不完全清楚您想要什么，但在表上添加和填充列很容易：

1）添加一个新列：

```
alter table customer add (some_date date); 
```

（正如 duffymo 所说，Oracle 表中不能有一个名为“日期”的列——或者至少，你不应该）。

2）从另一个表中的数据填充一列：

```
update customer c
set some_date = (select max(other_date) from invoices i
                 where i.customer_id = c.customer_id
                ); 
```

我使用 max() 是因为我假设客户可能有不止一张发票。当然，您的需求可能会有所不同，但重要的是子查询必须以某种方式只为每个客户返回 1 行。

# asp.net-ajax - 成功将数据列表注册为异步回发触发器

> ID：801381
> 
> 赞同：1
> 
> 时间：2009-04-29T08:12:09.243
> 
> 标签：asp.net-ajax

我正在编写一个小型布告栏应用程序，到目前为止，它的大部分似乎都可以工作。但是，我尝试将 Ajax 面板添加到通知查看页面，但无法使其正常工作。

该站点使用定义了三个内容区域的母版页，在此页面中，这些区域用于通知过滤器、通知标题列表（在 Page.Load 事件中填充的数据列表）和当前显示的通知。当您单击标题时，它应该加载通知。

问题是我希望当前显示的通知位于 Ajax 面板上，但触发器位于不同的内容区域中。我在母版页的内容占位符之外放置了一个脚本管理器，在 aspx 页面上，我使用以下触发器在通知视图区域内的内容周围放置了一个更新面板：

```
<Triggers>
    <asp:AsyncPostBackTrigger ControlID="dlSelector" EventName="ItemCommand" />
</Triggers> 
```

在 Page.Load 事件中我有：

```
'Get the script manager first, and register the selector as a postback
Dim sm1 As ScriptManager = ScriptManager.GetCurrent(Page)
sm1.RegisterAsyncPostBackControl(dlSelector) 
```

这编译并且代码部分似乎运行正常，但我收到错误“在 UpdatePanel 'UpdatePanel1' 中找不到触发器的 ID 为 'dlSelector' 的控件。” 如果我更换

```
sm1.RegisterAsyncPostBackControl(dlSelector) 
```

和

```
sm1.RegisterAsyncPostBackControl(Page.FindControl("dlSelector")) 
```

然后我得到一个错误，FindControl 已返回 null 并再次失败。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T08:45:08.870

母版页意味着您的控件名称将被破坏
（例如 ct100_someotherstuff_nameOfControl），这就是 FindControl 空手而归的原因。您需要使用控件的正确 id 注册回发控件。

从[Rick Strahl那里阅读这篇文章，它在](http://west-wind.com/weblog/posts/5127.aspx)[这篇文章](https://stackoverflow.com/questions/799655/asp-net-findcontrol-is-not-working-how-come)中被引用。

希望能帮助到你。

# c++ - 在 c++ 中仅使用 std::string 而不是 char 数组和 std::vector/list 而不是数组是否有任何实际限制？

> ID：801385
> 
> 赞同：2
> 
> 时间：2009-04-29T08:12:59.680
> 
> 标签：c++, arrays, list, vector, std

我在我的代码中痴迷地使用向量、列表、字符串和 wstrings。是否有任何涉及到的 catch 22 让我对不时使用数组、chars 和 wchars 更感兴趣？

基本上，如果在支持标准模板库的环境中工作，是否有任何情况下使用原始类型实际上更好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T09:10:30.243

我会坚持使用 STL 类（向量、字符串等）。它们更安全、更易于使用、更高效，内存泄漏的可能性更小，而且，AFAIK，它们至少在调试时（Visual C++）对边界进行了一些额外的运行时检查。

然后，测量性能。如果您确定瓶颈在 STL 类上，则转到 C 样式字符串和数组的用法。

根据我的经验，在向量或字符串使用方面遇到瓶颈的机会非常低。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T09:51:52.500

对于 99% 的时间和 99% 的标准库实现，您会发现 std::vectors 足够快，并且您从使用它们中获得的便利性和安全性将超过任何小的性能成本。

对于那些真正需要裸机代码的极少数情况，您可以将向量视为 C 样式数组：

```
vector <int> v( 100 );
int * p = &v[0];
p[3] = 42; 
```

C++ 标准保证向量是连续分配的，因此保证可以工作。

关于字符串，便利因素几乎变得压倒性的，性能问题往往会消失。如果你回到 C 风格的字符串，你也会回到使用像 strlen() 这样的函数，这些函数本身就非常低效。

至于列表，在使用它们之前，您应该三思而后行，无论是您自己的实现还是标准。使用向量/数组可以更好地解决绝大多数计算问题。列表在文献中如此频繁出现的原因在很大程度上是因为它们是教科书和培训课程作者用来一次性解释指针和动态分配的一种方便的数据结构。我作为前培训课程作家在这里发言。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T08:17:31.400

一个问题是访问元素时的开销。即使在通过索引访问元素时使用向量和字符串，您也需要首先检索缓冲区地址，然后添加偏移量（您不需要手动执行此操作，但编译器会发出此类代码）。使用原始数组，您已经有了缓冲区地址。在某些情况下，这种额外的间接性可能会导致大量开销，并且在您想要提高性能时会受到分析。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T08:17:11.667

如果您不需要实时响应，请坚持使用您的方法。它们比字符更安全。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T08:19:03.080

您偶尔会遇到这样的情况，您可以通过自己做一些事情来获得更好的性能或内存使用（例如，std::string 通常有大约 24 字节的开销，std::string 本身中的指针有 12 字节，以及其动态分配的块上的标题块）。

我从事从 std::string 转换为 const char* 的项目节省了显着的内存（10 的 MB）。我不相信这些项目是你所说的典型。

哦，使用 STL 会损害您的编译时间，在某些时候这可能是个问题。当您的项目导致将超过 GB 的目标文件传递给链接器时，您可能需要考虑其中有多少是模板膨胀。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T09:41:37.640

我从事过几个项目，其中字符串的内存开销已经成为问题。

值得提前考虑您的应用程序需要如何扩展。如果您需要存储无限数量的字符串，将`const char*`s 用于全局管理的字符串表可以为您节省大量内存。

但一般来说，除非有很好的理由不这样做，否则绝对要使用 STL 类型。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-29T10:19:26.350

我相信默认的内存分配技术是向量的缓冲区，而字符串是每次当前分配的内存用完时分配双倍内存的技术。这可能很浪费。您当然可以提供自定义分配器...

要考虑的另一件事是堆栈与堆。静态大小的数组和字符串可以放在堆栈上，或者至少编译器会为您处理内存管理。如果较新的编译器提供相关的 C99/C++0x 功能，它们也会为您处理动态大小的数组。向量和字符串将始终使用堆，如果您有非常严格的约束，这可能会引入性能问题。

根据经验，使用已有的内容，除非它的速度/内存开销会损害您的项目……您可能会发现，对于 99% 的东西，STL 提供的类可以节省您的时间和精力，而对您的影响几乎没有影响应用性能。（即“避免过早优化”）

# sharepoint - Sharepoint - 在 Intranet 外部提供数据

> ID：801387
> 
> 赞同：1
> 
> 时间：2009-04-29T08:13:17.947
> 
> 标签：sharepoint, sharepoint-2007

我知道在内部使用 SharePoint 是免费的，但是如果我创建一个应用程序来提供外部存储在 SharePoint 中的一些数据呢？这是合法的做事方式还是我必须支付完整的SP许可证才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T08:36:46.673

只有 Windows Sharepoint Services (WSS 3.0) 是免费的，并且包含在 Windows 2003 和 2008 中，因此与它一起获得许可。如果用户需要在站点上进行身份验证（即使用表单身份验证），那么您需要为每个用户提供 Windows CAL 或外部连接器许可证。如果您没有用户帐户（“匿名访问”），那么您不需要任何额外的许可。

另一方面，Microsoft Office SharePoint Server 2007 (MOSS 2007) 是一种商业产品，需要任何内部或外部使用的许可证。

IANAL，因此请咨询 MS Licensing。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T18:40:50.983

在您的情况下，最便宜的选择可能是在 Windows Server Web 版（约 400 英镑）上安装 WSS + Sql Server 2008 Express，以避免为 CAL 或外部连接器付费。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T08:19:52.550

在内部使用 SharePoint 不是免费的。您需要为您拥有的每个服务器副本获得服务器许可证，并为在内部使用它的每个客户端提供客户端访问许可证 (CAL)。有一个单独的模型用于许可外部托管和发布的 SharePoint。

您应该与您的微软许可提供商讨论这个问题，这不是一个真正的编程问题，而是一个许可问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T22:22:41.853

提供连接到 Intrenet 的 SharePoint 需要支付许可费。您拥有自己的应用程序从 SharePoint（例如 webservices/rss）读取数据并将其公开到 Internet 的情况完全不同，并且不太可能考虑获得许可。

鉴于您只公开部分数据而不公开任何界面，您应该没问题。如果您使用 CAL 访问 SharePoint，我相信运行您访问 SharePoint 的应用程序的用户*会*用完其中一个 CAL。

您确实需要与您的 SharePoint 许可人员核实 100%。

# windows - 是否有任何理由不在 COM+ 应用程序中托管 COM 服务器？

> ID：801388
> 
> 赞同：3
> 
> 时间：2009-04-29T08:14:30.003
> 
> 标签：windows, com, interop, com+

将进程内 COM 服务器转换为进程外 COM 服务器的最简单方法是创建 COM+ 应用程序。这样做有什么可能的缺点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-11T22:29:48.250

我真的想不出任何理由来创建自己的容器或使用第 3 方（如果有的话）来支持 MTS/COM+。我的意思是它可以做你想做的所有事情：

*   允许您选择将 COM 对象分配到容器进程。
*   允许您配置它们运行的​​帐户。
*   监视容器进程并在必要时重新启动并可以回收它们。
*   甚至允许您在需要通过启动多个工作进程来服务多个线程的场景中托管 STA 组件。等等

如果不花 6 个月或更长时间，很难想象会做得比这更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T22:23:32.083

把问题翻过来，我猜你的反自我可能会问，“为什么除了 COM+ 服务器之外还有用于进程外 COM 服务器的选项？这些其他托管选项提供了哪些优势？”

我没有准备任何东西，但我正在想象一个表格 - 顶部的托管选项作为各个列中的标题，特定属性作为行中的标题。您可以评估每个不同区域或属性的每个托管选项。

我看到的主要区别在于管理模型和能力，以及灵活性。例如，在 Windows 服务中托管 COM 服务器可为您提供 Windows 服务功能 - 随操作系统启动自动启动；与 services.msc 关联的管理 UI（包括管理/操作的东西），以及将其他接口添加到该服务的灵活性（灵活性）。

# regex - 如何使用正则表达式从字符串中剥离子字符串？

> ID：801397
> 
> 赞同：1
> 
> 时间：2009-04-29T08:17:20.370
> 
> 标签：regex, ant

我有一个类路径，例如：

```
myproject/classes;myproject/lib/somecrab.zip;myproject/lib/somelib1.jar;myproject/lib/somelib2.jar;myproject/lib/somelib3.jar; 
```

现在我想清理这个类路径并扔掉我不再想要的东西。因此在这种情况下，类路径应该看起来像

```
myproject/classes;myproject/lib/somelib1.jar;myproject/lib/somelib3.jar; 
```

我怎样才能用正则表达式做到这一点？我想用一个蚂蚁脚本来做，例如

```
<pathconvert property="new.classpath" pathsep=";">
    <path refid="old.classpath" />
    <chainedmapper>
        <regexpmapper from="(.*).jar" to="\1.jar" />
    </chainedmapper>
</pathconvert> 
```

我需要如何调整正则表达式？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T08:33:08.460

如果你想做的只是去掉中间的一个连续字符串，它应该是：

```
<regexpmapper from="(.*)myproject/lib/somecrab.zip;(.*)" to="\1\2" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T08:27:13.797

我认为您需要将其表述为 (validstuffbefore)skipstuff(validstuffafter) ，然后使用 \1\2 的替换字符串

所以（可能）：

```
^([\w/]+;)((?:[\w/]+\.jar;)*)[\w/]+\.zip;?((?:[\w/]+\.jar;)*)$ 
```

并替换为：

```
\1\2\3 
```

您可能会遇到多个匹配的问题，但全局标志*应该可以*解决这个问题。

祝你好运！

# perl - 如何在 Perl 中格式化特定于区域设置的数字？

> ID：801401
> 
> 赞同：4
> 
> 时间：2009-04-29T08:18:08.560
> 
> 标签：perl, formatting, numbers

我需要根据用户选择的语言在我的 Web 应用程序中格式化数字，例如德语中的 1234.56 = "1.234,56"。像这样的东西`sprintf`目前是没有问题的，因为它们依赖于 LC_NUMERIC（这对于桌面应用程序恕我直言）而且我必须在服务器上生成每个语言环境，这是不行的。我更喜欢使用[CLDR](http://cldr.unicode.org)的格式化字符串，但还没有找到合适的模块。简而言之，我想要的是：

```
set_locale("de_DE");
print format_number(1234.56); 
```

如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-03-18T16:46:49.993

CPAN 现在有[CLDR::Number](https://metacpan.org/pod/CLDR::Number)用于基于 Unicode CLDR 的数字、百分比和货币格式。

```
use CLDR::Number;
my $cldr = CLDR::Number->new(locale => 'de-DE');  # or 'de_DE'

my $decf = $cldr->decimal_formatter;
say $decf->format(1234.5);  # '1.234,5'

my $curf = $cldr->currency_formatter(currency_code => 'EUR');
say $curf->format(1234.5);  # '1.234,50 €'

$curf->locale('de-AT');     # Austrian German
say $curf->format(1234.5);  # '€ 1.234,50' 
```

CLDR::Number 提供它使用的所有语言环境数据，目前来自 CDLR v27，因此您不必依赖不一致的操作系统语言环境数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T13:28:12.260

```
use POSIX qw( locale_h );
use Math::Currency;
set_locale(LC_ALL, "de_DE");
Math::Currency->localize();
my $eur = Math::Currency->new("1234.56");

print "$eur"; 
```

但是，这确实取决于现有的语言环境。查看 Math::Currency 的文档，了解如何为您需要的所有数据生成 Math::Currency::XX 子模块，然后在服务器上安装这些子模块。然后不需要语言环境。

我在某个地方也有一个修补过的，可以处理各种欧元。（现在如果只有作者会应用它；）

杰斯。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T08:23:02.837

perldoc perllocale 状态：

> setlocale 函数 您可以在运行时使用 POSIX::setlocale() 函数随时切换区域设置：

它还注意到模块 I18N::Langinfo，它逐个提供本地化数据。

# c# - C#：根据系统颜色创建更浅/更深的颜色

> ID：801406
> 
> 赞同：66
> 
> 时间：2009-04-29T08:19:45.357
> 
> 标签：c#, colors

> ## 复制
> 
> [如何调整颜色的亮度？](https://stackoverflow.com/questions/737217/how-do-i-adjust-the-brightness-of-a-color)
> [如何确定给定颜色的较深或较浅颜色变体？](https://stackoverflow.com/questions/97646/how-do-i-determine-darker-or-lighter-color-variant-of-a-given-color)
> [以编程方式淡化颜色](https://stackoverflow.com/questions/141855/programmatically-lighten-a-color)

* * *

说我有

```
var c = Color.Red; 
```

现在我想创建一个`Color`比那个颜色更亮或更暗的新颜色。我怎么能没有太多麻烦呢？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2009-04-29T08:27:42.170

[ControlPaint](http://msdn.microsoft.com/en-us/library/system.windows.forms.controlpaint(VS.85).aspx) .Light .Dark .DarkDark 等

```
Color lightRed = ControlPaint.Light( Color.Red ); 
```

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2012-09-26T09:27:05.627

我最近[**写了一篇关于这个的博客**](http://www.pvladov.com/2012/09/make-color-lighter-or-darker.html)。主要思想是将给定的校正因子应用于每个颜色分量。以下静态方法使用指定的校正因子修改给定颜色的亮度，并生成该颜色的更暗或更亮的变体：

```
/// <summary>
/// Creates color with corrected brightness.
/// </summary>
/// <param name="color">Color to correct.</param>
/// <param name="correctionFactor">The brightness correction factor. Must be between -1 and 1\. 
/// Negative values produce darker colors.</param>
/// <returns>
/// Corrected <see cref="Color"/> structure.
/// </returns>
public static Color ChangeColorBrightness(Color color, float correctionFactor)
{
    float red = (float)color.R;
    float green = (float)color.G;
    float blue = (float)color.B;

    if (correctionFactor < 0)
    {
        correctionFactor = 1 + correctionFactor;
        red *= correctionFactor;
        green *= correctionFactor;
        blue *= correctionFactor;
    }
    else
    {
        red = (255 - red) * correctionFactor + red;
        green = (255 - green) * correctionFactor + green;
        blue = (255 - blue) * correctionFactor + blue;
    }

    return Color.FromArgb(color.A, (int)red, (int)green, (int)blue);
} 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2010-04-22T13:22:37.870

您也可以使用`Lerp`函数来执行此操作。XNA 中有一个，但很容易自己编写。

有关C# 实现，请参阅[我对这个类似问题的回答。](https://stackoverflow.com/questions/97646/how-do-i-determine-darker-or-lighter-color-variant-of-a-given-color/2690026#2690026)

该功能允许您这样做：

```
// make red 50% lighter:
Color.Red.Lerp( Color.White, 0.5 );

// make red 75% darker:
Color.Red.Lerp( Color.Black, 0.75 );

// make white 10% bluer:
Color.White.Lerp( Color.Blue, 0.1 ); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-09-14T09:03:16.767

这些方法中的大多数确实会使颜色变暗，但它们会调整色调方式，因此结果看起来不太好。最好的答案是使用[Rich Newman 的 HSLColor](https://stackoverflow.com/a/4087601/550073)类并调整亮度。

```
public Color Darken(Color color, double darkenAmount) {
    HSLColor hslColor = new HSLColor(color);
    hslColor.Luminosity *= darkenAmount; // 0 to 1
    return hslColor;
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-08-23T15:45:03.687

[采用@Pavel 回答](https://stackoverflow.com/a/12598573/141172)的核心方法，我准备了以下两个小扩展方法，以获得更直观（至少对我而言）的签名。

```
public static Color LightenBy(this Color color, int percent)
{
    return ChangeColorBrightness(color, percent/100.0);
}

public static Color DarkenBy(this Color color, int percent)
{
    return ChangeColorBrightness(color, -1 * percent / 100.0); 
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-29T08:42:10.297

这是我用于使给定颜色变亮/变暗的一些 javascript 代码。您可以将其用作等效 C# 函数的基础

它的工作原理是计算每个 RGB 分量与纯白色的距离，然后通过提供的因子调整该距离。新距离用于计算新颜色。0到1之间的因子变暗，大于1的因子变亮

```
function Darken( hexColor, factor )
    {   
        if ( factor < 0 ) factor = 0;

        var c = hexColor;
        if ( c.substr(0,1) == "#" )
        {
            c = c.substring(1);
        }

        if ( c.length == 3 || c.length == 6 )
        {
            var i = c.length / 3;

            var f;  // the relative distance from white

            var r = parseInt( c.substr(0, i ), 16 );
            f = ( factor * r / (256-r) );
            r = Math.floor((256 * f) / (f+1));

            r = r.toString(16);
            if ( r.length == 1 ) r = "0" + r;

            var g = parseInt( c.substr(i, i), 16);
            f = ( factor * g / (256-g) );
            g = Math.floor((256 * f) / (f+1));
            g = g.toString(16);
            if ( g.length == 1 ) g = "0" + g;

            var b = parseInt( c.substr( 2*i, i),16 );
            f = ( factor * b / (256-b) );
            b = Math.floor((256 * f) / (f+1));
            b = b.toString(16);
            if ( b.length == 1 ) b = "0" + b;

            c =  r+g+b;
         }   

         return "#" + c;

    } 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-06-20T01:51:31.817

您也可以简单地处理 RGB 百分比以根据需要使其更亮或更暗，以下是如何使颜色比它更暗 x% 的示例：

```
//_correctionfactory in percentage, e.g 50 = make it darker 50%
    private Color DarkerColor(Color color, float correctionfactory = 50f)
    {
        const float hundredpercent = 100f;                        
        return Color.FromArgb((int)(((float)color.R / hundredpercent) * correctionfactory),
            (int)(((float)color.G / hundredpercent) * correctionfactory), (int)(((float)color.B / hundredpercent) * correctionfactory));
    } 
```

还有一件事，我们还可以将过程反转为更轻，只有我们得到 255 - RGB 的结果，然后将其乘以我们想要的百分比，如下例所示：

```
private Color LighterColor(Color color, float correctionfactory = 50f)
    {
        correctionfactory = correctionfactory / 100f;
        const float rgb255 = 255f;
        return Color.FromArgb((int)((float)color.R + ((rgb255 - (float)color.R) * correctionfactory)), (int)((float)color.G + ((rgb255 - (float)color.G) * correctionfactory)), (int)((float)color.B + ((rgb255 - (float)color.B) * correctionfactory))
            );
    } 
```

希望有帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-29T08:26:04.577

使用 HSI 转换器库（搜索 google）。然后，调整 I 通道以获得更浅/更​​深的颜色。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-01-04T13:50:53.503

我创建了一个网站来做这个[colorglower.com](http://colorglower.com "在十六进制中找到更亮和更暗的颜色阴影")你可以查看它以查看演示。

这是我使用的javascript代码。

```
function lighten(color) {

// convert to decimal and change luminosity
var luminosity = 0.01
var computedColors = new Array();
var newColor = "#",
    c, i, n, black = 0,
    white = 255;
for (n = 0; n < 10; n++) {
    for (i = 0; i < 3; i++) {
        c = parseInt(color.substr(i * 2, 2), 16);
        c = Math.round(Math.min(Math.max(black, c + (luminosity * white)), white)).toString(16);
        newColor += ("00" + c).substr(c.length);
    }

    computedColors[n] = newColor;
    var arrayUnique = checkIfArrayIsUnique(computedColors);
    if (arrayUnique == false) {
        computedColors.pop();
        break;
    }

    computedColors[n] = newColor;
    newColor = "#";
    luminosity += calcPercentage();
}

return computedColors; 
```

}

这段代码的作用是接收一个十六进制颜色，然后输出 10 个最浅的颜色版本并放入数组中。您可以将亮度更改为您喜欢调整阴影百分比的任何值。要使颜色变暗，您只需要更改：

```
luminosity -= calcPercentage(); 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2018-01-08T12:44:25.663

我更改了 Pavel Vladov 函数以修改甚至 RGB 分量，以获得 R/G/B 方向的任意组合的阴影：

```
Public Function ChangeColorShades(color As Color, correctionFactor As Single, bR As Boolean, bG As Boolean, bB As Boolean) As Color

    Dim red As Single = CSng(color.R)
    Dim green As Single = CSng(color.G)
    Dim blue As Single = CSng(color.B)

    If (correctionFactor < 0) Then

        correctionFactor = 1 + correctionFactor
        If bR Then
            red *= correctionFactor
        End If
        If bG Then
            green *= correctionFactor
        End If
        If bB Then
            blue *= correctionFactor
        End If

    Else
        If bR Then
            red = (255 - red) * correctionFactor + red
        End If
        If bG Then
            green = (255 - green) * correctionFactor + green
        End If
        If bB Then
            blue = (255 - blue) * correctionFactor + blue
        End If

    End If

    Return color.FromArgb(color.A, CInt(red), CInt(green), CInt(blue))
End Function 
```

# ruby - 为什么 Ruby 的 Win32Console 不适用于 Ramaze？

> ID：801415
> 
> 赞同：3
> 
> 时间：2009-04-29T08:22:37.597
> 
> 标签：ruby, windows-xp, ramaze

我已经安装了 Ramaze（在 Windows XP 上），它建议我还安装 win32console 以在它运行时获得彩色日志输出。

但是，这样做之后，我得到的是转义码而不是颜色，如下所示：

```
W [2009-04-29 09:02:55 $5064]  WARN | : ←[33mNo explicit root folder found, assuming it is C:/Projects/Ruby/Ramaze/Conferences←[0m
D [2009-04-29 09:02:55 $5064] DEBUG | : ←[34mUsing webrick←[0m
I [2009-04-29 09:02:55 $5064]  INFO | : ←[37mWEBrick 1.3.1←[0m
I [2009-04-29 09:02:55 $5064]  INFO | : ←[37mruby 1.8.6 (2008-08-11) [i386-mswin32]←[0m
D [2009-04-29 09:02:55 $5064] DEBUG | : ←[34mTCPServer.new(0.0.0.0, 7000)←[0m
D [2009-04-29 09:02:55 $5064] DEBUG | : ←[34mRack::Handler::WEBrick is mounted on /.←[0m
I [2009-04-29 09:02:55 $5064]  INFO | : ←[37mWEBrick::HTTPServer#start: pid=5064 port=7000←[0m 
```

即使在全新安装 Ruby/Ramaze/win32console 时也会发生这种情况

我的设置是：

*   带有 SP#3 的 Windows XP
*   ruby 1.8.6 (2008-08-11 补丁级别 287) [i386-mswin32]
*   rubygems 版本 1.3.1
*   win32console gem 1.2.0 版

顺便说一句，以下测试程序似乎可以工作，所以我想知道这是否是我机器上的 Ramaze/win32console 问题。

```
#!/usr/bin/ruby
require 'rubygems'
require 'win32console'

[0, 1, 4, 5, 7].each do |attr|
  puts '----------------------------------------------------------------'
  puts "ESC[#{attr};Foreground;Background"
  30.upto(37) do |fg|
    40.upto(47) do |bg|
      print "\033[#{attr};#{fg};#{bg}m #{fg};#{bg}  "
    end
  puts "\033[0m"
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T09:36:32.333

也许这不是您正在寻找的答案，但我在 Windows 上使用[MSYS/MinGW](http://www.mingw.org/wiki/msys)并且它的 bash 正确显示颜色而无需 win32console gem。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-30T14:14:37.150

尝试

```
require 'rubygems'
require 'win32console'
include Win32::Console::ANSI
include Term::ANSIColor 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-30T14:51:00.047

在 Ramaze 启动之前需要 win32console。

这是因为 Ramaze 及其日志记录机制在 win32console 之前保留了对 stdout 和 stderr 的引用来替换它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T19:26:45.050

尝试在你的 app.rb 中添加这个

```
require "win32console"
require "Win32/Console/ANSI" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T13:49:20.540

我认为这是由于您的代码与 Ramaze（或 Innate）中的代码之间的格式字符串不同造成的。

```
"\e[#{COLOR_CODE[LEVEL_COLOR[severity]]}m#{string}\e[0m" 
```

这扩展为（对于红色，并且“Hello”是字符串）：

```
"\e[31mHello\e[0m" 
```

`\e`，在 Ruby 中，被转换为`\033`，所以这不应该给我们带来麻烦：

当然，等价于`\033`

```
"\033" == "\e" # => true 
```

主要区别在于 Ramaze 没有指定背景颜色，因为如果它与终端的默认背景对比太大，可能会导致难看的输出。但是，如果您的背景是蓝色、红色、白色或 Ramaze 用于记录的任何其他前景色，它也可能完全不可读，我认为我们应该明确定义背景，并希望这也能解决您的问题窗户问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-23T14:00:30.830

我刚刚尝试了[如何在 WinXP cmd shell 中加载 ANSI 转义码或获取彩色文件列表中](https://stackoverflow.com/questions/946546/)的建议，效果很好。

基本上，我抓住了[ANSICon](http://adoxa.110mb.com/ansicon/index.html)，然后运行：

> ansicon.exe -I （那是大写的'i'）

从它被提取到的 x86 子文件夹中。这安装了 ANSI 颜色代码 DLL 作为之后打开的所有 cmd.exe 窗口的挂钩。哟，瞧 - cmd.exe 中的颜色

# linux - 如何运行时调试共享库？

> ID：801423
> 
> 赞同：46
> 
> 时间：2009-04-29T08:24:57.123
> 
> 标签：linux, debugging, aix

谁能告诉我如何在共享库上进行运行时调试？

我需要在我的共享库中运行时调试一个函数，但它被另一个程序调用。如何使用共享库执行 dbx 之类的操作？

我在 AIX 上使用 dbx。对于我正在尝试做的事情，gdb 是否比 dbx 更好？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-28T19:31:18.007

您只需要使用可执行文件调用 gdb（不管它是您的还是第 3 方的）。这是我调试*ls*命令并在 (shared) *c library*中设置断点的示例。此示例使用支持延迟（待处理）断点的 gdb 6.8，这使得这很容易：

```
gdb /bin/ls
GNU gdb 6.8-debian
Copyright (C) 2008 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu"...
(no debugging symbols found)
(gdb) b write
Function "write" not defined.
Make breakpoint pending on future shared library load? (y or [n]) y
Breakpoint 1 (write) pending.
(gdb) r
Starting program: /bin/ls
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
[Thread debugging using libthread_db enabled]
(no debugging symbols found)
(no debugging symbols found)
[New Thread 0x7f98d2d23780 (LWP 7029)]
[Switching to Thread 0x7f98d2d23780 (LWP 7029)]

Breakpoint 1, 0x00007f98d2264bb0 in write () from /lib/libc.so.6
(gdb) 
```

如您所见，gdb 自动管理可执行文件使用的所有线程。您不必为那里的线程做任何特别的事情。断点将在任何线程中工作。

或者，如果您想将调试器附加到已经运行的应用程序（我在这里使用*tail -f /tmp/ttt*作为示例）：

```
ps ux | grep tail
lothar    8496  0.0  0.0   9352   804 pts/3    S+   12:38   0:00 tail -f /tmp/ttt
lothar    8510  0.0  0.0   5164   840 pts/4    S+   12:39   0:00 grep tail

gdb
GNU gdb 6.8-debian
Copyright (C) 2008 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu"...
(no debugging symbols found)
(gdb) attach 8496
Attaching to program: /usr/bin/tail, process 8496
Reading symbols from /lib/librt.so.1...(no debugging symbols found)...done.
Loaded symbols for /lib/librt.so.1
Reading symbols from /lib/libc.so.6...(no debugging symbols found)...done.
Loaded symbols for /lib/libc.so.6
Reading symbols from /lib/libpthread.so.0...(no debugging symbols found)...done.
[Thread debugging using libthread_db enabled]
[New Thread 0x7f24853f56e0 (LWP 8496)]
Loaded symbols for /lib/libpthread.so.0
Reading symbols from /lib/ld-linux-x86-64.so.2...
(no debugging symbols found)...done.
Loaded symbols for /lib64/ld-linux-x86-64.so.2
(no debugging symbols found)
0x00007f2484d2bb50 in nanosleep () from /lib/libc.so.6
(gdb) b write
Breakpoint 1 at 0x7f2484d57bb0
(gdb) c
Continuing.
[Switching to Thread 0x7f24853f56e0 (LWP 8496)]

Breakpoint 1, 0x00007f2484d57bb0 in write () from /lib/libc.so.6
(gdb) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-29T08:42:37.503

通常调试共享库的过程与调试可执行文件的过程非常相似——主要区别在于您可能无法设置断点，直到共享库加载到内存中。您将调试器附加到主可执行文件。

如果您正在调试不属于您的应用程序，但在插件架构中使用您的模块，您仍然使用相同的方法。确保（一如既往）您有可用于共享库的调试信息。在 Windows 中，您将生成一个 .pdb 文件。对于 gcc，我认为您指定了一个特殊的编译器标志 (-g?) 以确保提供调试信息。您将调试器附加到第三方应用程序。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-06-29T09:04:52.247

洛塔尔回答的另一个例子：

我在 Linux`test.so`中使用名为. （命名方案有点单调，我现在意识到了）`test.c``python``unittest``tests/test_pwmbasic.py`

```
~/my/test/path/
    tests/
        __init__.py
        test_pwmbasic.py
    test.c
    test.so 
```

我想调试`test.so`来自刺激的内容`test_pwmbasic.py`。所以这就是我让它工作的方式......

```
$ cd ~/my/test/path
$ gdb $(which python)
   ... gdb blah ...
(gdb) b test.c:179
(gdb) run
>>> from tests.test_pwmbasic import *
>>> import unittest
>>> unittest.main()
   ... unittest blah ...
Breakpoint 1, pwmTest_setDutyCycles (dutyCycles=0x7ffff7ece910) at ./test.c:179
(gdb) print pwm_errorCode
$1 = PWM_ERROR_NONE 
```

现在我想嫁给gdb

注意：`test.c`还包括`../pwm.c`，所以我也可以在该库中使用断点

```
(gdb) b pwm.c:123 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T13:30:43.423

我记得通过创建一个使用它的模拟应用程序来测试共享库。如果您愿意做很多工作，您可以创建第二个模拟共享库，它只收集有关第三方应用程序如何使用该库的信息，然后让您的模拟应用程序重放该信息。

当然，永远不要怀疑 printf 和 fprintf 调用的强大功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T12:23:13.097

您可以尝试静态编译和链接库来调试它。
如果您的错误仅在编译为共享时出现，那么这可能会给您一些线索。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-02-17T21:44:08.153

自从我不得不在 AIX 上使用 dbx 已经很久了，我也遇到了这个问题。安装 gdb 对我来说不是一个选择。

```
dbx  /path/to/your/program
(dbx) run [args to your program]
(dbx) set $ignoreonbptrap           # I kept hitting a trace/bpt trap
(dbx) set $deferevents              # allows setting bp in not loaded shared library
(dbx) set $repeat                   # useful, repeat commands with <enter> tjust like gdb
(dbx) stop in MySharedLibraryFunc   # defers breakpoint
(dbx) cont 
```

# iphone - 如何在 iphone 中以编程方式在基于窗口的应用程序中添加一个简单的新 UIView？

> ID：801426
> 
> 赞同：2
> 
> 时间：2009-04-29T08:25:48.977
> 
> 标签：iphone, macos

我想以编程方式在基于窗口的应用程序中添加一个包含任何内容的新视图，有人可以告诉我一步一步的过程来执行此操作，以及如何以编程方式在该新视图上添加控件。

我已经创建了一个新视图并在其中添加了一个标签现在我如何添加一个按钮并且我想在我点击该按钮时更改标签的文本？有人帮我吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-29T08:34:55.900

在大多数情况下，您使用 ViewController。但是可以直接向窗口添加 UIView。也许你可以解释更多你想做的事情。

```
UIView* view = [[UIView alloc] initWithFrame:CGRectMake(0,0,320,480)];
UILabel* label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 100, 100)];
[label setFont:[UIFont boldSystemFontOfSize:18]];
[label setTextAlignment:UITextAlignmentCenter];
[label setBackgroundColor:[UIColor clearColor]];
[label setTextColor:[UIColor whiteColor]];
[label setText:@"Hello"];
[view addSubview:label];
[window addSubview:view]; 
```

您可以通过以下方式获得对窗口的引用（如果您还没有）

```
[[UIApplication sharedApplication] keyWindow]; 
```

# asp.net - 在 ASP.net 上下文中反映的问题

> ID：801429
> 
> 赞同：1
> 
> 时间：2009-04-29T08:27:11.470
> 
> 标签：asp.net, reflection

我有一个引用外部程序集的 ASP.net 应用程序，我需要动态加载和发现实现已知接口的任何类型。我遇到的问题是我反映的类型与正在运行的接口不匹配，所以我无法转换它。

例子：

此代码在 ASP.net 应用程序中运行。

```
var assembly = Assembly.LoadFile(Path.Combine(HttpRuntime.BinDirectory, "ExternalAssembly.dll"));

var type = assembly.GetExportedTypes().First<Type>(x => x.Name == "AClass"); // AClass implements IAInterface

var reflectedInterface = type.GetInterface(typeof(IAmAInterface).ToString());

if (reflectedInterface != typeof(IAmAInterface))
    throw new Exception("This makes me sad"); // This code gets run 
```

我可以看到从 bin 加载的反射接口和从 typeof 返回的接口之间的唯一区别是 typeof 程序集在临时 ASP.net 路径（C:\WINDOWS\Microsoft.NET\Framework\v2\. 0.50727\Temporary ASP.NET Files\root\08c43c8b\3adac8cf\assembly\dl3\eb7a4127\0235ea60_a3c8c901\ReflectionTest.DLL)

感谢 Paul Alexander 我已更改代码以使用解决问题的 Assembly.Load 方法而不是 Assembly.LoadFile。

wwilden：我也尝试将接口提取到它自己的程序集中，这也解决了问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T08:35:48.393

当您使用 LoadFile 时，程序集不会在运行时加载到与其他程序集相同的上下文中，因此 CLR 接口的运行时类型是不同的。您可以在 Suzanne Cook 的[Debugging Assembly Load Failures](http://blogs.msdn.com/suzcook/archive/2003/05/29/57120.aspx)中阅读更多内容。

如果您正在加载的程序集已经在 Bin 目录中 - 您可以按名称加载它。您不需要知道确切的路径，因为 Bin 文件夹已经在程序集探测路径中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T08:34:47.710

您的接口类型在哪里定义？它是否存在于反射的程序集中以及应用程序本身中？然后您实际上有两个不同的接口，即使它们具有相同的命名空间和名称。

您需要做的是从反射程序集中提取接口并将其放入另一个程序集中，您可以从反射程序集和应用程序中引用该程序集。然后它应该工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T08:50:02.040

除了您的问题之外，如果您有很多程序集要动态加载，请记住它们将保留在内存中，直到 ASP.NET 工作进程重新加载。这可能会影响服务器的性能。

您可以在单独的 AppDomain（可以卸载的最小单元）中加载程序集，在您使用 .NET 远程处理引用的 AppDomain 中加载代理类。完成后，您将卸载 AppDomain。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T09:06:08.053

[CodeProject 上有一篇](http://www.codeproject.com/KB/dotnet/ObjectToInterfaceCaster.aspx)关于这种情况的有趣文章。你有一个类，它的结构与接口相同，但没有实现接口本身。本文概述了一种动态创建实现所需接口的包装类的方法。这可能对您的情况有所帮助。

# c# - 如何为 WinForms 应用程序创建类似 IDLE 的功能

> ID：801432
> 
> 赞同：0
> 
> 时间：2009-04-29T08:28:24.667
> 
> 标签：c#, winforms, ironpython

我想向 C# WinForms 应用程序添加“类似 IDLE 的功能”，但我不太清楚如何做到这一点，也找不到任何对 Google 有用的东西。

所以基本上我想要交互式命令行界面，用户可以在其中输入一些 Python 代码并执行它（不仅仅是表达式，应该可以定义新函数）。

那么，从哪里开始呢？有没有好的教程或示例可用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T08:33:06.043

如果我没记错的话，[Python in a Nutshell](http://oreilly.com/catalog/9780596001889/)一书中有一章是关于嵌入 Python 的。也许你可以在那里找到一些有用的信息，但是由于这本书不是特定于 Windows 的，你可能需要自己修改它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T10:36:45.560

我会像这样设置我的 WinForm：添加 2 个文本框。

1：用于输出。将第一个的多行属性设置为true，并使其只读。

2：用于输入。使用 KeyUp 或 KeyPress 事件作为返回键并使用文本做你想做的事：添加命令到输出文本框，针对引擎启动代码并捕获解释器的输出

此链接（[http://groups.google.com/group/ironpy/browse_thread/thread/5e61a944c7c94d4b/0cbf29ec0f5fbb64?pli=1](http://groups.google.com/group/ironpy/browse_thread/thread/5e61a944c7c94d4b/0cbf29ec0f5fbb64?pli=1)）可能会给出一些关于针对 python 引擎启动命令的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T08:34:34.823

IronRuby 带有一个命令行解释器。IronPython 不是也有一个吗？如果是这样，源代码将是一个好的开始 :) 哦，如果不是，请务必查看 IronRuby 解释器，因为这两种语言都基于 DLR，因此非常相似，可以从两者中学习。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T21:34:55.047

通过 IronPython 邮件列表，我找到[了 IronTextBox2](http://www.codeproject.com/KB/edit/irontextbox2.aspx)，这是一个很好的例子。它需要一些调整才能使其运行，但除此之外是很好的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-22T16:09:41.960

这是我最通用的解决方案：

```
Point cursorPoint;
int minutesIdle=0;

private bool isIdle(int minutes)
{
    return minutesIdle >= minutes;
}

private void idleTimer_Tick(object sender, EventArgs e)
{
    if (Cursor.Position != cursorPoint)
    {
        // The mouse moved since last check
        minutesIdle = 0;
    }
    else
    {
        // Mouse still stoped
        minutesIdle++;
    }

    // Save current position
    cursorPoint = Cursor.Position;
} 
```

您可以设置一个以 60000 间隔运行的计时器。通过这种方式，您将只知道用户不移动鼠标的分钟数。您还可以在 Tick 事件本身上调用“isIdle”来检查每个间隔。

# xml - GML 使用标准，或使用 GML（地理 XML）的正确方法是什么

> ID：801437
> 
> 赞同：1
> 
> 时间：2009-04-29T08:31:25.970
> 
> 标签：xml, database, geometry, geography, gml-geographic-markup-lan

我们想在我们的应用程序中使用 GML；它是一个基于 GIS 的应用程序，它在虚拟现实环境中模拟真实的世界对象（即管道、道路等）。目前我们在 AutoCAD DWG 中绘制和存储几何图形，但将来我们希望更改数据库。我真的需要找到这些问题的答案。

1- GML 是否适合编码包含超过 100000 个特征的几何文件（CAD、Shape、..）（数据量和 GML 性能之间的关系是什么，有什么限制吗？）

2-我们如何检查几何数据的正确性，例如 GML 如何理解多边形的 2 个内部边界彼此相交，（通过模式？通过特殊库？或者它只是通过模式验证 GML 而不检查内部坐标数据）

3-如果我想使用数据库，我可以将 GML 数据存储在 XML Berkeley 数据库中吗？

感谢您的关注

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T23:15:52.943

**1.** GML 可以表示 CAD/GIS 数据——例如从形状文件、DWG 获得的数据。DGN 等 GML 用于建模 3D 建筑结构（有一种语言称为 CityGML 用 GML 编写（参见 Google CityGML）。GML 也可以表示地形模型和图像（GMLJP2）。GML 是 XML，因此体积可以很大，然而，现代 XML 数据库可以轻松处理具有 100,000 多个特征的数据库。GML 客户端（如 Galdos INspector（Just Google galdosinc）可以轻松处理数十万个特征（例如奥地利的所有道路）以及复杂的建筑模型（见[http://youtu.be/UR02FNfamO8](http://youtu.be/UR02FNfamO8)）。

**2.**您不能仅通过 XML 模式验证来验证几何图形（例如多边形边界交叉点），但是有一些特殊的库，Galdos 将很快提供一个 GML 验证器，例如为 Google 开发的 KML 验证器（只是 Google kmlvalidator）。后一种工具会检查 KML 的几何有效性。

**3.** GML 可以存储在任何数据库中——Oracle、PostgreSQL 等以及 XML 数据库。您应该注意，有一些称为 Web 要素服务 (WFS) 的 Web 服务提供 GML 数据。

# java - 在 Spring Java 中使用一个控制器调用 2 个或多个视图

> ID：801446
> 
> 赞同：0
> 
> 时间：2009-04-29T08:34:33.293
> 
> 标签：java, spring, jsp

我想在 spring 中使用 java 在一个控制器中调用 2 个视图。例如

```
this.controller.view('header');
this.controller.view('body');
this.controller.view('footer'); 
```

我怎样才能做到这一点？或者春天有可能吗？或者你能建议任何其他方法吗？

我可以在视图中调用视图吗？例如在`view/login.jsp`,

```
<table><tr><td>
<jsp>this.controller.view('login_form')</jsp>
</td></tr></table> 
```

是的，我在那里写的所有代码都不是有效的jsp语言，但这是我想在这个项目中做的概念。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T15:54:48.593

您似乎希望跨多个 JSP 页面重用 JSP 的片段（页眉、页脚）。如果是这种情况，请考虑使用一个专用视图（例如 login_form.jsp）并使用 JSP[包含](http://java.sun.com/products/jsp/tags/11/syntaxref1112.html)语句来合并来自该 JSP 页面的“常见”片段。

作为一个例子（login_form.jsp）：

```
<jsp:include page="header.jsp"/>
<!-- login_form specific page content goes here -->

<jsp:include page="footer.jsp"/> 
```

这将允许您跨多个 JSP 页面重用公共页眉和页脚内容。

我还建议看一下 Spring MVC（[文档](http://static.springframework.org/spring/docs/2.0.x/reference/mvc.html)），对于基于 Spring 的 Web 应用程序来说，这是一个非常好的方法。

# powershell - 连接到无线网络

> ID：801456
> 
> 赞同：4
> 
> 时间：2009-04-29T08:37:59.200
> 
> 标签：powershell, wireless

我创建了几个 PowerShell 脚本，用于配置培训课程中使用的计算机。有些课程需要连接到不同的无线网络 (SSID)。我可以指导用户如何使用 Windows XP 设施来更改他们连接的网络，但我希望能够将网络选择滚动到我的 PowerShell 脚本中关于如何在 PowerShell 中更改无线网络的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T08:40:02.000

你可能会觉得这个项目很有趣。它只是原生 API 的 .NET 包装器。您应该可以从 PowerShell 调用它而不会遇到太多麻烦：

[http://managedwifi.codeplex.com/](http://managedwifi.codeplex.com/)

# java - 如何创建安全的许可 Java EE 应用程序？

> ID：801458
> 
> 赞同：8
> 
> 时间：2009-04-29T08:39:29.227
> 
> 标签：java, jakarta-ee, licensing, security

我们正在开发由客户选择的任何数据库支持的 Java EE 应用程序。

我们将根据每个用户的许可价格向客户销售。我如何确保根据我们的条件使用该应用程序，即不容易被破解？有没有可用的教程？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T09:06:35.620

[比尔卡尔文的回答](https://stackoverflow.com/questions/475216/python-applications-can-you-secure-your-code-somehow/475394#475394)是评论中提到的问题中最有用的答案。假设您将继续实施“保护”计划，请尽量做到最低限度。其他任何事情都会极大地让用户感到沮丧，并导致重复业务减少和/或增加破解令人沮丧的系统的愿望。

根据您的问题，很难判断每个用户是否会安装该应用程序。如果是这样，您可能只需要一个许可证代码，他们必须以某种方式与您联系才能获得。如果它是客户端-服务器的事情，那么您的选择就会受到更多限制；事实上，我想不出一个我曾经在脑海中设计过或在实践中遇到过的单一解决方案不会让我感到非常*沮丧*。你也可以在这里做一个许可证代码解决方案，除了许可证代码会以某种方式携带一个有效负载，指示他们支付的用户数量，然后禁止创建/使用超过该数量的用户。不过，在那一点上，你真的是在走我提到的那条挫败线。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T09:06:14.357

如果你可以混淆 - 这是开始的方式。但是如果你使用控制框架的反转（例如spring），它可能会很痛苦。我听说也可以混淆弹簧上下文，但从未尝试过。此外（只是猜测）反射、动态代理等可能会有一些惊喜。至于许可，我可以建议使用**[TrueLicense](https://truelicense.dev.java.net/)**。它具有非常灵活的方式来处理保护的各个方面以及开箱即用的免费试用期。工作得很好并且有很好的文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T09:53:01.873

客户是否为此应用程序的支持付费？如果是这样，那么支持有可能比应用程序本身的许可带来更大的回报。如果是这样，您可以考虑**不**锁定应用程序，而是选择仅支持软件的真实副本（通过校验和等证明的未修改副本）。许多授权该软件的企业更倾向于避免任何修改（即使他们想要实际这样做的机会可能很小），以免危及他们的支持。

仅供参考：这就是 Oracle 倾向于使用其电子商务套件的方式。您可以修改几乎任何您想要的组件。不过，祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T11:50:23.667

看看 Atlassian 如何销售他们的产品。我相信这是一种非常有效的方法，并且可能也适合您。注意：订阅更新应该有附加价值！

# netbeans - 如何跨多个系统同步 netbeans 配置/插件/更新？

> ID：801464
> 
> 赞同：3
> 
> 时间：2009-04-29T08:42:10.513
> 
> 标签：netbeans, netbeans6.5

我在台式机和笔记本电脑上都使用 netbeans。在两个系统上更新和安装插件很麻烦，因此，如果有一种方法可以跨系统同步配置、插件和更新，那就太好了。

我尝试复制 ~/.netbeans 目录，但是，这也带来了其他系统中最近文件和打开项目的列表。

注意：两台机器的操作系统都是 Linux。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-12-08T11:50:01.730

有一些可能性

*   创建自己的 linux 包并管理更新
*   检查 subversion/cvs/git 无论你的 vcs 是什么
*   或使用简单的 ftp/sftp 解决方案

# mysql - 每个 MySQL（十亿）NDBCLUSTER 的最大行数？

> ID：801470
> 
> 赞同：1
> 
> 时间：2009-04-29T08:44:26.203
> 
> 标签：mysql, sql, database, cluster-computing

我有一个需要能够扩展到数十亿个条目或行的数据库。

*   每个表可以支持这么多行吗？可取吗？
*   如果在 NDBCLUSTER 中使用，单个表是否会拆分为多个集群。
*   其他负载平衡技术？
*   部署此类数据库的一些可取的方法是什么？
*   具有这么多行的数据库获得更高性能的最佳实践是什么？
*   MySQL会这样做，还是我应该去别处看看。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T09:31:29.180

我们有 2200 万行的表，而且看不到瓶颈。至少没有足够的内存无法修复。通常没有简单的是或否。这取决于您的数据、表引擎等的性质。

如果您披露了更多信息，您正在保存什么样的数据，那么回复可能会更详细。

对于大型数据库，我唯一的一般建议是，在进行复制和/或分片之前，我会超过硬件选项（出于性能原因——保留从属服务器进行备份是另一回事）。您还需要了解您的*index-fu*和明显的开关/选项，以便调整数据库服务器。

更多信息，如果你能告诉我你正在使用什么样的数据。

# java - WebSphere 6.1 中的 CPU 使用率峰值

> ID：801471
> 
> 赞同：5
> 
> 时间：2009-04-29T08:44:50.757
> 
> 标签：java, multithreading, websphere, cpu-usage, ibm-midrange

*首先，只是一点背景：*

我们的一位客户在运行我们的 Web 应用程序之一的 WebSphere 实例时遇到 CPU 使用高峰（具有其他应用程序的其他实例很好）。他们有一个测试环境和一个实时环境（都是 iSeries），它们都遇到了问题 - 每个实例设置一个应用程序。我们已经在我们自己的测试环境中本地部署了这个应用程序，也为许多其他客户部署在 iSeries 上，没有类似的问题。

*实际发生了什么：*

每隔一秒左右，WebSphere 进程的 CPU 使用率就会跳到任何地方`7%`——`20%`即使当时没有正在处理的请求。客户报告看到峰值高达`30%`. 当空闲时，这些峰值平均是`1.5%`CPU 的整体（通常使用的其他 WebSphere 实例`0%`） 。`0.1%`

*到目前为止我的调查*

所以，我看了一下线程。测试环境中的一个线程`~350`每秒使用 CPU 周期。他们实时环境中的一个类似线程`~1500`每秒使用 CPU 周期（表明它具有更大的 CPU）。这些线程的调用堆栈看起来像

```
Type  Program                  Statement         Procedure                    
      QLESPI     QSYS          17                LE_Create_Thread2__FP12crtt >
      QJVALIBJVM QSYS          7                 startThread__FPv             
 J    com/ibm/ws/util/Threa >                    run                          
 J    com/ibm/ws/util/Threa >                    run                          
 J    com/ibm/ws/util/Threa >                    getTask                      
 J    com/ibm/ws/util/Bound >                    poll 
```

底线的整个班级名称是`com/ibm/ws/util/BoundedBuffer`. 我让客户为我做一个 JVM Dump——我从中得到的唯一额外信息是线程名称：

```
Thread:  00002F82 Deferrable Alarm : 11 
```

*现在我的问题：*

*   鉴于这些症状，你们中的任何人都能找出问题所在吗？（也许这是一个长镜头！）
*   是什么`Deferrable Alarm`？从 JVM Dump 中，我可以看到 4 个具有此名称的线程。其他三个似乎做得很好。通过调试我的本地 WebSphere（在 Windows 上）并在类中添加断点`BoundedBuffer`，我看到`BoudedBuffer`s 正在轮询并定期调用一些侦听器。
*   我无权访问客户机器的 WebSphere 控制台，他们也不承认对配置进行了任何更改。不过，我可以让他们帮我检查控制台——我应该让他们看什么？
*   我可以通过 telnet 访问客户邮箱，这里还有什么可以调查的吗？查看 WebSphere 配置文件等？我应该查看哪些文件？
*   因为调用堆栈和 JVM 转储没有显式引用我们的代码，所以假设这是一个配置问题是否安全？

这是一个很长的问题，所以感谢您阅读本文。

**4 月 30 日更新 (1)**

今天早上我注意到这种行为只发生在当天的第一个请求被处理之后（无论调用哪个 Web 服务）。这将手指指向我们的应用程序或 Apache Axis。难道这只是正常的行为？！

**4 月 30 日更新 (2)**

因此，这种 CPU 活动似乎是 Web 容器的某种内务活动，或者可能是 Apache Axis 中的某种活动。我现在观察到这种情况发生在几个不同服务器上的几个不同 Web 应用程序上。没有 Web 组件的应用程序不会遭受同样的额外 CPU 开销。

我想如果它是家务工作，那么“调整”它可能会适得其反——我的意思是，让 App Server 更好地空闲可能会对它可以做的“实际”工作量产生负面影响。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-31T22:08:19.560

我建议遵循 IBM 提供的必须收集的[文档](http://www-01.ibm.com/support/docview.wss?uid=swg21331169)，并在您自己的调查中提出 PMR。你可能怀疑的事情：

*   垃圾收集（不太可能在应用程序利用率低的情况下）
*   定时器或任务（如 java.util.Timer 或 commonj 工作管理器）
*   具有复杂 SQL 查询的预测试连接（在 DataSource 的 WebSphere Application Server 数据源属性中）

我还建议使用分析器来确定原因，[YourKit 分析器](http://www.yourkit.com/)是一个相当不错的分析器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-29T01:45:40.867

您可以尝试分析应用程序并进行堆转储，这可以回答一些与内存和 cpu 使用相关的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-07T09:34:03.197

我也遇到了同样的问题，[Deferrable Alarm:x] 与 BoundedBuffer 一起使用。我唯一的区别是这是在 Windows 7 64 位机器上。绝对没有 Tvioli 或其他批处理进程在运行，没有发出请求，单个实例只是空闲。

我可以在 DEBUG 模式下运行应用程序并暂停可延迟警报线程，CPU 峰值停止、恢复并再次启动。

我检查了磁盘活动、网络活动，但那里没有发生任何事情。

我正在运行 WebSphere 6.1.0.27 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T15:42:28.787

非常本能地（不熟悉 iSeries 平台）我会查看与磁盘 IO 相关的问题。你能描述一下磁盘子系统吗？您能否查看您的应用程序是否在 iowait 中花费了异常多的时间？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T07:58:24.670

我知道这不完全符合你的问题。但如果您在 WAS 6.1 补丁 17 之前运行，可能值得一看。

[http://www-01.ibm.com/support/docview.wss?uid=swg24018437](http://www-01.ibm.com/support/docview.wss?uid=swg24018437)

希望这可以帮助。干杯约翰

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T16:31:24.290

我最好的猜测是它正在对实例进行某种类型的监视，例如 Tivoli 等。您是否排除了任何 GC 活动？

HTH 汤姆

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-30T15:16:14.433

大多数应用程序服务器都是用 java 本身实现的，WebSphere 也是如此。除了服务客户端请求之外，该服务器还必须执行其他定期工作，例如资源池管理。执行此作业将创建一些需要进行垃圾回收的临时对象。

根据您分配的堆数量、使用情况和垃圾收集器设置，将调用垃圾收集器。我会说尝试查看是否是垃圾收集器线程占用了您的 CPU。为此，将 jconsole 实用程序连接到远程 websphere 进程一天，看看堆使用量和 cpu 使用量之间是否存在任何关联。

# php - 用于存储动态二维数组的 SQL 设计和/或 PHP 类？

> ID：801475
> 
> 赞同：1
> 
> 时间：2009-04-29T08:46:32.097
> 
> 标签：php, sql, database-design

我需要一种优雅的方式来存储各种大小（x 和 y）的动态数组（基本上是没有所有功能的电子表格），主要用作 ENUM、列表、查找数据、价格表等。多语言将是一个很大的好处。速度之精华。

这是一个典型的“工作表”示例；

```
 |  1 |  2 |   3 |   4
  -------------------------------
  model A   | 2$ | 5$ |  8$ | 10$
  model B   | 3$ | 6$ |  9$ | 12$
  model C   | 4$ | 8$ | 10$ | 13$ 
```

所以，要获取信息，我会这样做；

```
 $price = this_thing_im_after ( '3', 'model B' ) ;
  echo $price ;   // Prints '9$' 
```

我在 PHP5 和 Zend 框架的世界里，但是关于设计和 SQL 的想法同样花哨，甚至来自外部世界、库、扩展等的建议，因为我不想重新发明太多的轮子. 我最需要后端的东西，稍后我会为动态工作表编写一个 GUI。想法，想法，指针？

只是一个编辑指出我不想序列化和 blob 数据，因为我想查询索引和工作表，甚至可能是数据（或支持此类的人的类型，现在*这*将是可怕的！）如果我的心情很疯狂。但同样，这对我来说不是一个破坏者；如果有人有一个很好的库或类，可以通过一些简单的查询快速序列化进出数据库，我很高兴。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T09:14:50.560

除了将整个内容序列化为一个 blob 字段之外，您可能最终会得到一个键/值表，其中您的键是 row 和 col 字段：

```
 CREATE TABLE sheet (
      sheet_id int not null,
      name varchar(32),
      rows int, -- stores max dimension if needed
      cols int, -- stores max dimension if needed
      primary key (sheet_id)
  );
  CREATE TABLE cells (
      cell_id identity, -- auto inc field for ease of updates
      sheet_id int not null, -- foreign key to sheet table
      row int not null,
      col int not null,
      value smalltext, -- or a big varchar depending on need
      primary key (cell_id), -- for updates
      unique index (sheet_id, row, col), -- for lookup
      index (value) -- for search
  );

  CREATE TABLE row_labels (
      sheet_id int not null,
      row int not null,
      label varchar(32),
      primary key (sheet_id, row)
  );

  CREATE TABLE col_labels (
      sheet_id int not null,
      col int not null,
      label varchar(32),
      primary key (sheet_id, col)
  ); 
```

这使您可以很好地对数据进行切片：

```
 // Slice [4:20][3:5]
 SELECT row, col, value FROM cells
 WHERE sheet_id = :sheet
   AND row BETWEEN 4 AND 20
   AND col BETWEEN 3 AND 5
 ORDER BY row, col

 while ($A = fetch()) {
     $cell[$A['row'][$A['col']] = $A['value']; // or unserialize($A['value']);
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T09:00:51.733

是否需要仅获取电子表格的*一部分，或通过包含的数据进行查询？*

如果您只想存储和检索整个内容，我将使用数组的明确文本表示（例如[`serialize()`](http://www.php.net/serialize)）并将其存储为 TEXT。

# c - C数组地址混淆

> ID：801476
> 
> 赞同：11
> 
> 时间：2009-04-29T08:47:12.513
> 
> 标签：c, arrays, pointers

假设我们有以下代码：

```
int main(){
    int a[3]={1,2,3};
    printf("      E: 0x%x\n", a);
    printf("  &E[2]: 0x%x\n", &a[2]);
    printf("&E[2]-E: 0x%x\n", &a[2] - a);
    return 1;
} 
```

编译运行后，结果如下：

```
 E: 0xbf8231f8
  &E[2]: 0xbf823200
&E[2]-E: 0x2 
```

我理解**&E[2]**的结果，它是 8 加上数组的地址，因为索引为 2 并且类型为 int（在我的 32 位系统上为 4 个字节），但我不知道为什么最后一行是 2 8 个？

另外，最后一行应该是什么类型——整数还是整数指针？

我想知道是否是 C 类型系统（有点铸造）使这个怪癖？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-29T08:57:53.130

你必须记住这个表达的`a[2]`真正含义。它完全等同于`*(a+2)`。如此之多，以至于`2[a]`用相同的效果代替它是完全合法的。

为了使它起作用并有意义，指针算术考虑了所指向事物的类型。但这是在幕后处理的。您只需在数组中使用自然偏移，所有细节都可以解决。

相同的逻辑适用于指针差异，这解释了您的`2`.

在幕后，在您的示例中，将索引乘以`sizeof(int)`得到一个字节偏移量，该偏移量被添加到数组的基地址中。您在两份地址打印中公开了该详细信息。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-29T08:50:29.793

当减去相同类型的指针时，结果是元素数而不是字节数。这是设计使然，以便您可以轻松索引任何类型的数组。如果您想要字节数 - 将地址转换为 char*。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-29T08:57:26.453

当您将指针增加 1 (p+1) 时，指针将通过将 (p + sizeof(Type)) 字节添加到 p 来指向下一个有效地址。（如果 Type 是 int 则 p+sizeof(int)）

类似的逻辑也适用于 p-1 （当然在这种情况下减去）。

如果你只是在这里应用这些原则：

简单来说：

```
a[2] can be represented as (a+2)
a[2]-a      ==>  (a+2) - (a)    ==> 2 
```

所以，在幕后，

```
a[2] - a[0]  
==> {(a+ (2* sizeof(int)) ) - (a+0) }  / sizeof(int) 
==> 2 * sizeof(int) / sizeof(int) ==> 2 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-29T08:51:01.150

&E[2]-2 行是做指针减法，而不是整数减法。指针减法（当两个指针都指向相同类型的数据时）返回地址的差除以它们指向的类型的大小。返回值是一个 int。

为了回答您的“更新”问题，再次执行指针算术（这次是指针加法）。在 C 中这样做是为了更容易“索引”指针指向的一块连续数据。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-29T08:52:42.907

您可能对[C 中的指针算术](https://stackoverflow.com/questions/759663/pointer-arithmetic-in-c)问题和答案感兴趣。

基本上，+ 和 - 运算符在用于指针时会考虑元素大小。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T08:56:01.527

在 C 中添加和减去指针时，使用数据类型的大小而不是绝对地址。

如果你有一个 int 指针并将数字 2 添加到它，它将前进 2 * sizeof(int)。同样，如果你减去两个 int 指针，你将得到以 sizeof(int) 为单位的结果，而不是绝对地址的差。

（使用数据类型大小的指针非常方便，例如，您可以简单地使用`p++`，而不必每次都指定类型的大小：`p+=sizeof(int)`。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-29T09:13:44.277

回复：“另外，最后一行应该是什么类型？整数，还是整数指针？？”

一个整数/数字。同理，今天 - 4 月 1 日 = 数字。不是日期

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-29T08:52:49.273

如果要查看字节差异，则必须使用 1 字节大小的类型，如下所示：

```
printf("&E[2]-E:\t0x%x\n",(char*)(&a[2])-(char*)(&a[0])) 
```

# python - 更新谷歌应用引擎中的数据

> ID：801477
> 
> 赞同：0
> 
> 时间：2009-04-29T08:47:56.460
> 
> 标签：python, google-app-engine

我正在尝试我的第一个谷歌应用引擎项目——一个简单的球员统计数据库，用于我参与的运动队。鉴于此模型：

```
class Player(db.Model):
    """ Represents a player in the club. """

    first_name = db.StringProperty()
    surname = db.StringProperty()
    gender = db.StringProperty() 
```

我想制作一个用于创建和修改播放器的基本 Web 界面。我的代码结构如下所示：

```
class PlayersPage(webapp.RequestHandler):
    def get(self):
        # Get all the current players, and store the list.
        # We need to store the list so that we can update
        # if necessary in post().
        self.shown_players = list(Player.all())

        # omitted: html-building using django template 
```

此代码生成一个非常基本的 HTML 页面，其中包含一个表单和一个表格。表格中每个玩家都有一行，看起来像这样：

```
 <tr>
    <td><input type=text name="first_name0" value="Test"></td>
    <td><input type=text name="surname0" value="Guy"></td>
    <td><select name="gender0">
        <option value="Male" selected>Male</option>
        <option value="Female" >Female</option>
      </select></td>
  </tr>
  <!-- next row: first_name1, etc. --> 
```

我的想法是，我将存储我在 self.shown_players 中使用的 Player 实例，以便以后可以在我的`post()`方法（同一类）中根据需要更新 Players，方法是：

```
def post(self):
    # some code skipped

    for i, player in enumerate(self.shown_players):
        fn = self.request.get('first_name'+str(i)).strip()
        sn = self.request.get('surname'+str(i)).strip()
        gd = self.request.get('gender'+str(i)).strip()
        if any([fn != player.first_name,
                sn != player.surname,
                gd != player.gender]):
            player.first_name = fn
            player.surname = sn
            player.gender = gd
            player.put() 
```

但是，这不起作用，因为调用该方法`self.shown_players`时不存在。`post()`我猜应用引擎每次访问页面时都会创建一个新的类实例。

我尝试了相同的想法，但将`shown_players`其放在类或模块级别（并调用它`global`），但是由于我无法预测的原因，这不起作用。例如：

```
shown_players = []
class PlayersPage(webapp.RequestHandler):
    def get(self):
        # Get all the current players, and store the list.
        # We need to store the list so that we can update
        # if necessary in post().
        global shown_players
        shown_players[:] = list(Player.all()) 
```

`shown_players`由于 HTML 生成正确，因此其中似乎具有正确的值`get()`，但在`post()`.

我该怎么办？

编辑：谢谢，所有。答案（“再次检索玩家！”）应该是显而易见的 :-) 也许有一天我会看看 memcache，但我不希望玩家列表在不久的将来超过 30 个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T08:54:58.907

在每个请求上，您都在处理同一类的新实例。这就是为什么你不能在 in 中创建一个变量`get()`并使用它的值`post()`。您可以做的是在您的 - 方法中再次检索值`post()`或将数据存储在`memcache`.

请参阅此处的 memcache 文档：

[http://code.google.com/intl/de-DE/appengine/docs/python/memcache/](http://code.google.com/intl/de-DE/appengine/docs/python/memcache/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T09:06:28.723

在您的 post 方法中，就在“for”子句之前，从存储位置检索玩家列表：

```
def post(self):
    # some code skipped

    self.shown_players = Player.all().fetch()
    for i, player in enumerate(self.shown_players):
      ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T09:05:18.040

我从未尝试过构建谷歌应用引擎应用程序，但我知道它在处理数据库等方面与 Django 有点相似。

我认为您不应该将事物存储在全局变量中，而应该分别处理每个事务。获取请求有效，因为您正在做您应该做的事情并从数据库重新请求信息。

如果你想在你的 post 函数中更新一个玩家，你可能想要传入详细信息，*[用这些详细信息再次查找玩家]*，随意修改它们。括号中的位是您缺少的步骤。

# sharepoint - SharePoint：筛选具有文件夹的列表

> ID：801481
> 
> 赞同：2
> 
> 时间：2009-04-29T08:50:58.980
> 
> 标签：sharepoint, list, filter, view, directory

我有一个 SharePoint 文档库，它具有用于组织文档的文件夹结构（但也用于通过文件夹的权限控制访问）。

库中的文档每月更新一次，我们将每个月的文档版本存储在同一个文件夹中；有一个用于过滤的“月”列将包含 Jan 09、Feb 09 等值。它看起来像这样：

```
    标题月
    ----- -----
    子文件夹 1
    子文件夹 2
[] 有趣的事实 1 月 9 日
[] 有趣的事实 2 月 9 日
[] 有趣的事实 09 年 3 月
[] 迷人的数字 1 月 9 日
[] 迷人的数字 2 月 9 日
    ...

```

现在，因为用户通常对“当前”月份最感兴趣，所以我希望他们能够应用过滤器，并选择（比如）3 月 9 日。但是，如果他们使用内置过滤器执行此操作，它还会过滤掉文件夹，它们无法再导航文件夹层次结构。这不好 - 我希望他们能够在过滤器完好无损的文件夹之间移动，这样他们就不需要继续关闭并再次打开它。

我想我也许可以使用自定义视图（选择 where type=folder 或 month=[month]），并且在一定程度上可行。但是，我只能让它在一个*固定*的月份工作，而我需要用户能够选择月份 - 也许通过页面上的下拉控件（我不想为 5 次创建 60 个视图）数月，我也不想每个月都创建一个新视图）。

我认为可以在代码中创建视图（而不是通过 UI），但我无法弄清楚如何将动态值（用户特定设置）获取到 CAML 查询中。

任何指针不胜感激！顺便说一句，我**知道**文件夹不好的教条，一切都应该只是一个列表。但是，在考虑了替代方案后，我仍然喜欢使用文件夹——如果我能解决这个问题的话。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-22T13:51:50.123

您能否创建一个从包含 Month 列的 Folder 继承的内容类型？然后，用此列表中的新文件夹内容类型替换普通文件夹内容类型。适当地设置月份，现在您的过滤器也将包含该文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T15:45:03.683

我在过滤和 SPGridView 方面做了很多工作。也许你可以从我博客上的这篇[文章中得到一些东西。](http://johanleino.spaces.live.com/blog/cns!6BE273C70C45B5D1!328.entry)正如我所说，不知道它是否会帮助你，但看看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T16:05:58.210

@Gary DATA 视图的控制过滤器（我的第二个答案）实际上确实保留了文件夹层次结构。

如果需要，您可以将其放入子文件夹，但在您的情况下，您只对显示一个特定文件夹感兴趣吗？

你正在做的是使用 SP-designer 来做，我找不到通过常规 webpart 来做的方法。

1.  在页面的“设计”视图中拖放您的共享文档库
2.  单击常用任务箭头 ( > ) 并自定义要显示的列
3.  仍然在常见任务中，应用选择的过滤器。您在这里要做的是在您的月份列上应用过滤器，以便月份列等于当前月份/年份，对吗？过滤器只会让您选择输入内容，输入当前月份，例如 5 月 9 日。然后切换到“代码”视图
4.  找到共享文档库，更具体地说，查找类似以下内容的内容： < ;Where> ;.... 这就是我之前提到的 CAML 查询。您可以对整个内容进行 HTML 解码，使其更具可读性。但本质上，过滤器是一个简单的 CAML 查询。您想修改该查询，以便您的月/年组合是当前月/年的组合。CAML 有一项称为 <MONTH/> 的功能，它以以下格式返回月份：mm/yyyy（您可能需要更改列的格式或创建一个新格式以方便您自己） - 您的 CAML 查询应该是有点像这样：

```
 <Where>
 <Eq>
   <FieldRef Name='Month'/>
   <Value Type='Number'><Month/></Value>
 </Eq>
</Where> 

```

或 html 编码：

`&lt ;Where&gt ;&lt ;Eq&gt ;&lt ;FieldRef Name='Month'/&gt ;&lt ;Value Type='Number'&gt ;&lt ;Month/&gt ;&lt ;/Value&gt ;&lt ;/Eq&gt ;&lt ;/Where&gt ;`

关键在于，您只是在数据视图的根级别创建过滤器。一旦他们点击文件夹，他们就会被扔到文档库中，并且可以查看文件夹中的所有内容。

希望这有帮助！

ps：在 html 编码上，我必须在 ';' 之前添加空格 所以你可以看到代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T23:25:29.650

我目前遇到了完全相同的问题，而不是简单的日期，我需要根据文件夹名称进行过滤，然后在页面上显示这些文件夹。一旦他们单击一个文件夹，他们就可以查看该文件夹的内容。

我还没有找到一个好的解决方案，但是对于你的，你应该能够简单地使用 contentQueryWebpart 创建一个自定义 CAML 查询。

像这样： [进一步自定义 CQWP](http://phet.net/sharepoint/post/Further-Customise-CQWP-to-Display-Draft-and-Checked-Out-Pages-By-User.aspx)

但是你会在文件夹的日期/时间上做，而不是别的。

您的查询将类似于：

```
 <![CDATA[
    <Where>
     <Gt>
       <FieldRef Name="Created" Nullable="True" Type="DateTime"/>
       <Value Type="DateTime"><Today /></Value>
     </Gt>
   </Where>
   <OrderBy>
       <FieldRef Name="Created" Nullable="True" Type="DateTime"Ascending="FALSE"/>
   </OrderBy>]]> 
```

我还会添加您要查找的文件夹的名称，以确保不会返回任何其他内容。

希望这可以帮助。如果您找到其他解决方案，请回发。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T22:47:48.500

您可能想尝试使用[由表单 webpart 过滤的 DataViewWebpart](http://philwicklund.com/archive/2009/04/11/using-the-data-view-web-part-to-search-a-sharepoint-list.aspx)来执行此操作。管理文件夹的显示，然后单击它时管理文件夹项目将是一个问题。这就是我猜不使用文件夹的原因之一。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T00:29:07.063

我想我找到了您的解决方案 - DataWebPart 实际上帮助了我....

使用它也让我们大开眼界： [ASP.NET Controls Filter Data View](http://blogs.msdn.com/sharepointdesigner/archive/2007/03/05/asp-net-controls-filter-the-data-view.aspx)

总而言之，您可以简单地使用月份年份组合填充下拉列表，通过设计器视图在页面上添加共享文档库，使用“过滤器”连接到您的 ASP.NET 下拉列表，然后您就有了一个过滤器月。您也可以使用 XSL 将其默认为某个日期，现在都在代码视图中 :)

# sql-server - 为什么 FOR 触发器在动作之前不运行？

> ID：801492
> 
> 赞同：2
> 
> 时间：2009-04-29T08:55:15.320
> 
> 标签：sql-server, triggers

我正在尝试在表上编写触发器以避免插入两个未标记为 IsDeleted 的名称。但是选择的第一部分包含插入的部分，因此条件始终为真。我虽然使用 FOR 关键字会导致触发器在 INSERTION 之前运行，但在这种情况下，插入的行已经在表中。我错了还是这就是所有 FOR 触发器的工作方式？

```
ALTER TRIGGER TriggerName
ON MyTable
FOR INSERT, UPDATE
AS
BEGIN 
    If exist (select [Name] From MyTable WHERE IsDeleted = 0 AND [Name] in (SELECT [Name] FROM INSERTED)
    BEGIN
    RAISERROR ('ERROR Description', 16, 1);
    Rollback;
    END  
END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T08:58:18.620

FOR 在数据更改后运行，INSTEAD OF 是我认为你所追求的。

编辑：正如其他人所说，INSTEAD OF 运行而不是您正在更改的数据，因此如果数据有效，您需要插入数据，而不是在无效时停止插入。

阅读此问题以获得有关触发器类型的更详细说明。

[SQL Server“AFTER INSERT”触发器看不到刚刚插入的行](https://stackoverflow.com/questions/405288/sql-server-after-insert-trigger-doesnt-see-the-just-inserted-row)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T09:00:55.510

FOR 与 AFTER 相同。如果您想“模拟” BEFORE 触发器，请使用 INSTEAD OF，请注意，这与您在正确的 BEFORE 触发器上所期望的不完全一样，即如果您未能提供必要的 INSTEAD 操作，您插入/更新的数据可能会丢失/忽略。

MSSQL 没有 BEFORE 触发器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T09:03:28.497

对于 SQL Server，FOR 在触发它的 SQL 之后运行。

来自：http: [//msdn.microsoft.com/en-us/library/ms189799.aspx](http://msdn.microsoft.com/en-us/library/ms189799.aspx)

> **为 | 后**
> 
> **AFTER**指定仅当触发 SQL 语句中指定的所有操作都已成功执行时才触发 DML 触发器。在触发此触发器之前，所有引用级联操作和约束检查也必须成功。
> 
> **当 FOR 是唯一指定的关键字时， AFTER**是默认值。
> 
> **不能在视图上定义**AFTER触发器。****

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T00:35:53.660

我最近实际上遇到了类似的问题，并找到了一种很酷的方法来处理它。我有一张表，其中一个 id 可以有几行，但其中只有一个可以标记为主要的。

在 SQL Server 2008 中，您将能够创建部分唯一索引，如下所示：

```
create unique index IX on MyTable(name) where isDeleted = 0; 
```

但是，您可以在 SQL Server 2005 中做更多的工作来完成它。诀窍是创建一个仅显示未删除行的视图，然后在其上创建一个唯一的聚集索引：

```
 create view MyTableNotDeleted_vw
 with schema_binding /* Must be schema bound to create an indexed view */
 as
 select name 
 from dbo.MyTable /* Have to use dbo. for schema bound views */
 where isDeleted = 0;

 GO

 create unique clustered index IX on MyTableNotDeleted_vw ( name ); 
```

这将有效地创建一个仅影响尚未删除的行的唯一约束，并且可能比自定义触发器执行得更好！

# sharepoint - 我可以使用共享点列表中的编辑菜单更改链接到项目的列吗？

> ID：801493
> 
> 赞同：8
> 
> 时间：2009-04-29T08:55:52.620
> 
> 标签：sharepoint, menu, hyperlink

有一个类似的问题被问到，但这并不是我想要做的。

这是问题的链接：[SharePoint 列表中的自动编号列，带有指向项目的链接](https://stackoverflow.com/questions/607291/auto-number-column-in-sharepoint-list-with-link-to-item/799866#799866)

为这个问题提供了两个解决方案。

这些解决方案中的任何一个都可以用于我拥有的导入列表，其中 Sharepoint 已决定哪些列链接到带有编辑菜单的项目？我想更改执行此操作的列，因为我需要更改格式，这意味着删除默认为带有编辑菜单的项目链接的列。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T12:54:35.680

您不能在 SharePoint 中动态更改菜单列 OOTB。要将菜单“移动”到不同的列，您应该创建一个新的计算列并使用 _EditMenuTableStart 和 _EditMenuTableEnd 字段包装呈现 (DisplayPattern)。

要查看如何执行此操作的示例，请查看CodePlex 上[iLoveSharePoint](http://www.codeplex.com/iLoveSharePoint/Release/ProjectReleases.aspx?ReleaseId=14994)项目中的“AddMenuColumn”PowerShell 脚本。该脚本非常简单，因此您应该能够在需要时将其转换为代码（或使用功能添加声明性）。

您也可以按原样使用脚本，将新菜单列添加到您的列表中。

# c# - 使用 xlinq 从 xsd 创建 xml

> ID：801496
> 
> 赞同：0
> 
> 时间：2009-04-29T08:56:31.557
> 
> 标签：c#, .net, .net-3.5, xsd, linq-to-xml

如何基于 xsd 和 c# 生成仅包含必需元素的 xml。我更喜欢使用 xlinq，但我也愿意接受替代品。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T09:00:36.070

这是一个固定的xsd吗？还是 xsd 是在运行时确定的？使用固定的 xsd，您可以将其映射到对象模型并使用`XmlSerializer`：

```
xsd foo.xsd /classes 
```

（在命令行；生成带有实体类的 foo.cs 等）

然后构建您的对象模型，并使用`XmlSerializer`它来序列化它。它*可能*有效 - 但不是动态使用 xsd 的合适选择。

# asp.net - ASP.NET：对 ASP.NET 成员资格提供程序的完全控制

> ID：801497
> 
> 赞同：1
> 
> 时间：2009-04-29T08:56:47.733
> 
> 标签：asp.net, membership, asp.net-membership

我有一个使用内置 ASP.NET 成员资格提供程序的应用程序。有两个角色（管理员和员工）。我希望管理员能够查看当前员工列表、添加或删除员工以及重置密码。到目前为止，我发现的信息很少，但 Membership.Provider.GetAllUsers 看起来很有希望。有什么办法可以在 GridView 中显示列表吗？

至少，我需要能够通过站点添加和删除用户。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T09:09:38.077

有关在 ASP.NET 中使用 Membership 和 Roleprovider 的详尽指南，请参阅本教程：[http ://aspnet.4guysfromrolla.com/articles/120705-1.aspx](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)

此处解释了以编程方式创建用户：http: [//msdn.microsoft.com/en-us/library/d8t4h2es.aspx](http://msdn.microsoft.com/en-us/library/d8t4h2es.aspx)。

但实际上，MSDN 在这个主题上非常完整。只需阅读[会员简介](http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx)并点击链接即可。你想要的一切都是完全可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T19:21:32.553

[我在http://aspnet.4guysfromrolla.com/articles/052307-1.aspx](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)找到了一个很好的教程，它使整个事情变得不那么模糊了。实施的噩梦，但它几乎可以工作。感谢您的回复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T09:09:19.997

如果您使用的是 SQL Server，则可以使用 System.Web.Security 中的默认 SqlMembershipProvider 类来执行您需要的用户管理任务。GetAllUsers() 返回一个字符串数组，因此您可以将 GridView 数据绑定到此方法的结果，以在网格中显示用户名列表。

# javascript - 我可以在Javascript中存储不同域的cookie吗

> ID：801506
> 
> 赞同：0
> 
> 时间：2009-04-29T08:58:28.977
> 
> 标签：javascript, cookies, twitter

拜托，我想通过在我的域中运行的脚本为我的浏览器设置 cookie。但我想从另一个域设置 cookie。

例如，我想设置 twitter.com 发送给我的 cookie（当我通过浏览器访问时），但我不想第一次访问他们的页面。只有当我在运行我的脚本后访问他们的页面时，我才希望他们的 cookie 已经设置。有可能吗？

我想，更改 document.cookie 的域变量可以解决问题，但它不起作用.. twitter 没有看到任何设置的 cookie。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T09:01:34.167

不，你显然不能。能够控制来自您的网站/Web 应用程序运行的域以外的域的 cookie，将是一个巨大的安全风险。因为*能够设置*，也就意味着*能够阅读*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T09:15:51.947

你可以，但它需要一些技巧，并且不能仅在 javascript 中完成。

打开 Firefox 并从 twitter.com 获取您的“auth_token”cookie

如果您有权访问 Web 服务器并且可以将其配置为接受所有主机标头。

制作一个假子域并将其添加到您的主机文件中，例如：

127.0.0.1 xxxxxxx.twitter.com

从该服务器设置一个名为“auth_token”的 cookie，其中 *.twitter.com 作为域。

这适用于 twitter，因为他们的 auth_cookie 设置为 20 年后到期。

# java - 创建自定义哈希表

> ID：801511
> 
> 赞同：1
> 
> 时间：2009-04-29T09:00:13.873
> 
> 标签：java, generics, hashtable

我需要创建一个自定义哈希表扩展 java.lang.Hashtable 并且我需要重写 get 方法以实现以下行为：

1.  如果 key == null，它将返回一个类型为 V 的新对象
2.  如果 super.get(key) == null，它也会返回一个类型为 V 的新对象。

谁能帮我。我尝试这样做，但我知道这是错误的。

```
import java.util.Hashtable;

public class CustomHashtable<K, V> extends Hashtable {
    @Override
    public synchronized V get(Object key) {
        if(key == null) return new Object();
        Object v = super.get(key);
        if(v == null){
            return new Object();
        }
    }

} 
```

请看这条线：

```
if(key == null) return new Object(); 
```

和行：

```
if(v == null){
    return new Object();
} 
```

知道错误发生在哪里..

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-29T09:05:49.927

您必须存储与 V 相关的类并创建一个新实例。例如：

```
public class CustomHashtable<K, V> extends Hashtable {
    Class<V> clazz;

    public CustomHashtable(Class<V> clazz) {
        this.clazz = clazz;
    }

    @Override
    public synchronized V get(Object key) {
        if(key == null) return newValue();
        Object v = super.get(key);
        if(v == null){
            return newValue();
        }
    }

    private V newValue() {
        try {
            return clazz.newInstance();
        } catch (InstantiationException e) {
            throw new RuntimeException (e);
        } catch (IllegalAccessException e) {
            throw new RuntimeException (e);
        }
    }
} 
```

（当然，您可能想要更改异常处理。）

另一种方法是让调用者有效地提供一个工厂来创建`V`. 您可以使用如下界面执行此操作：

```
public interface Factory<T> {
    T create();
} 
```

然后，您可以将工厂存储在自定义哈希表中，并`create`在需要时随时调用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T11:21:12.503

这里的主要问题是您试图实现的目标从根本上是错误的。检查你班级的方法。他们中的大多数现在将与`get`. 更糟糕的是，没有定义如何根据其他公共方法来实现方法——这就是继承的诅咒。

因此，创建一个代表您尝试实现的任何抽象的类。让*包含*不继承自适当的地图实现。

在这种情况下，自然地图可能不是 ye olde`Hashtable`而是[`java.util.concurrent.ConcurrentHashMap`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ConcurrentHashMap.html)。这里的重要方法是[ `putIfAbsent`][2]。不幸的是，API 文档很烂。以下是它应该如何使用：

```
public V getOrCreate(K key) {
    final V value = map.get(key);
    if (value != null) {
        return value;
    }
    V newValue = factory.create(key); // May discard.
    V oldValue = map.putIfAbsent(key, value);
    return oldValue==null ? newValue : oldValue;
} 
```

`Future`（如果你想确保你永远不会丢弃一个值，你可以使用 a 。）

为了创建，我假设了某种抽象工厂。一般来说，方法没有碰巧不会抛出异常的无参数公共构造函数。当然要避免像猪流感与 H5N1 交叉的反射。而是使用在创建时传入的适当的（特定于抽象的）抽象工厂。

```
public interface MySortOfFactory<
    T /*extends SomeEntity*/,
    A /*extends SomeInfo*/
> {
    T create(A arg);
} 
```

[2]： http: [//java.sun.com/javase/6/docs/api/java/util/concurrent/ConcurrentMap.html#putIfAbsent](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ConcurrentMap.html#putIfAbsent(K) (K , V)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T09:47:15.617

您需要创建一个新实例吗？还是返回*默认*实例就足够了？
后者可以像这样实现：

```
public class CustomHashtable<K, V> extends Hashtable<K, V> {

    /** Default instance. */
    private final V defaultValue;

    public CustomHashtable(V defaultValue) {
        this.defaultValue= defaultValue;
    }

    @Override
    public synchronized V get(Object key) {
        if(key != null) {
            V val = super.get(key);
            if(val != null) {
                return val;
            }
        }
        return defaultValue;
    }
} 
```

（但我还是更喜欢 Jon 的工厂解决方案：更灵活，也涵盖了默认实例解决方案）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T09:39:11.907

我明白你的问题，但我可以问以下问题：

*   当键为空时，您总是想要一个新对象，还是只想允许一个空键？
*   另外，当您找不到密钥时，您是否肯定需要一个新实例，或者在您找不到密钥的每种情况下都需要同一个实例？
*   您是否要将新实例放入哈希表中？
*   它必须是 Hashtable，还是 HashMap 可以？

我只是想知道您是否考虑过使用Apache Commons Collections中的[LazyMap ？](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/map/LazyMap.html)

# python - 为什么 Python informixdb 包会抛出错误！

> ID：801515
> 
> 赞同：1
> 
> 时间：2009-04-29T09:01:20.797
> 
> 标签：python, informix

我已经下载并安装了最新的 Python InformixDB 包，但是当我尝试从 shell 导入它时，我收到以下 Windows 对话框形式的错误！

**“无法在动态链接 isqlit09a.dll 中找到过程入口点 sqli_describe_input_stmt”**

任何想法发生了什么？

平台：Windows Vista（商务版），Python 2.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T19:43:50.253

您使用的是哪个版本的 IBM Informix Connect (I-Connect) 或 IBM Informix ClientSDK (CSDK)？“描述输入”功能是最近添加的，但您很可能拥有它。

您是否能够从命令 shell 连接到任何 Informix DBMS？如果不是，那么怀疑一定是您没有正确的环境。您可能需要指定 $INFORMIXDIR（或 %INFORMIXDIR% - 从这里开始我将省略 '$' 和 '%' 符号）；您需要设置 INFORMIXSERVER 才能成功连接；您需要在 PATH 上有正确的目录（在 Windows 上可能是 INFORMIXDIR/bin；在 Unix 上，可能是 INFORMIXDIR/lib 和 INFORMIXDIR/lib/esql 或 INFORMIXDIR/lib/odbc）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T05:29:22.330

其他连接数据库的方法是否有效？您可以使用（在控制面板中配置）ODBC 吗？如果 ODBC 有效，那么您可以使用 Python win32 扩展（ActiveState 发行版随附）并且有 ODBC 支持。您还可以使用 Jython，它可以通过 JDBC-ODBC 桥或 Informix JDBC 驱动程序与 ODBC 一起使用。

# linq - 在 LINQ 中删除时出现 500 错误

> ID：801525
> 
> 赞同：1
> 
> 时间：2009-04-29T09:05:04.313
> 
> 标签：linq

在执行下面的代码时，我收到 HTTP 500 Internal Server Error。

```
public bool DeleteData(int dataId, string uploaderName)
{
    using (DataClassesDataContext db = new DataClassesDataContext())
    {
        DataInfo d = db.DataInfos.Where(c => c.DataId == dataId).Single();
        db.DataInfos.DeleteOnSubmit(d);
        db.SubmitChanges();
    }        
    return true;
} 
```

这会获取“d”中的值，但在执行时`db.SubmitChanges();`我看到 500 错误。可能是什么原因？ID 列是主键，也是身份。

我还想知道如何在 LINQ 中实现“和”，如下所示：

```
DataInfo d = db.DataInfos.Where(c => c.DataId == DataId AND 
                                c.UploaderName==uploaderName).Single(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T09:11:34.033

实现“and”很容易——毕竟这是一个 C# 表达式：

```
DataInfo d = db.DataInfos.Where(c => c.DataId == DataId &&
                                c.UploaderName == uploaderName).Single(); 
```

至于 500 错误，几乎可以肯定是异常造成的，但如果没有异常的详细信息，就很难知道哪里出了问题。在您尝试修复 LINQ 错误之前，您应该确保记录任何导致请求失败的异常。这将帮助您解决未来的错误。登录到位后，您应该能够告诉我们异常是什么，此时我们可以帮助您修复它。

# .net - .NET 上的线程安全阻塞队列实现

> ID：801528
> 
> 赞同：17
> 
> 时间：2009-04-29T09:05:42.500
> 
> 标签：.net, multithreading, collections, queue

我正在寻找.NET 的线程安全阻塞队列的实现。“线程安全阻塞队列”是指： - 线程安全访问队列，其中 Dequeue 方法调用阻塞线程，直到其他线程放入（入队）某个值。

到目前为止，我已经找到了这个： [http](http://www.eggheadcafe.com/articles/20060414.asp) ://www.eggheadcafe.com/articles/20060414.asp （但它适用于.NET 1.1）。

有人可以评论/批评此实现的正确性。或者推荐另一个。提前致谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2010-01-30T19:41:03.320

作为参考，.NET 4 引入了[`System.Collections.Concurrent.BlockingCollection<T>`](http://msdn.microsoft.com/en-us/library/dd267312(VS.100).aspx)解决此问题的类型。对于非阻塞队列，您可以使用[`System.Collections.Concurrent.ConcurrentQueue<T>`](http://msdn.microsoft.com/en-us/library/dd267265(VS.100).aspx). 请注意，`ConcurrentQueue<T>`这可能会用作`BlockingCollection<T>`OP 使用的基础数据存储。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-29T09:42:00.713

这个[在 .NET 中创建阻塞队列](https://stackoverflow.com/questions/530211/creating-a-blocking-queuet-in-net/530228#530228)怎么样？

如果您需要 .NET 1.1（我从问题中不确定），只需删除泛型并替换`T`为`object`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T09:28:48.313

Queue.Synchronized [http://msdn.microsoft.com/en-us/library/system.collections.queue.synchronized(VS.71).aspx](http://msdn.microsoft.com/en-us/library/system.collections.queue.synchronized(VS.71).aspx)

无论如何都是一个起点，我从未使用过阻塞队列。抱歉，帖子不太相关。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-30T19:31:03.620

Microsoft 示例是一个很好的示例，但它没有封装到一个类中。此外，它要求使用者线程在 MTA 中运行（因为 WaitAny 调用）。在某些情况下，您可能需要在 STA 中运行（例如，如果您正在执行 COM 互操作）。在这些情况下，不能使用 WaitAny。

我有一个简单的阻塞队列类可以解决这个问题：http: [//element533.blogspot.com/2010/01/stoppable-blocking-queue-for-net.html](http://element533.blogspot.com/2010/01/stoppable-blocking-queue-for-net.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-01T17:39:25.810

是的，.NET4 包含并发集合。顺便说一句，来自 pfx 团队的关于并行扩展的非常好的手册 - h​​ttp: [//www.microsoft.com/downloads/details.aspx](http://www.microsoft.com/downloads/details.aspx?FamilyID=86b3d32b-ad26-4bb8-a3ae-c1637026c3ee&displaylang=en) ?FamilyID=86b3d32b-ad26-4bb8-a3ae-c1637026c3ee&displaylang=en 。

pfx 作为 Reactive Extensions 的一部分也可用于 .net 3.5。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T09:45:02.267

微软对此有一个非常好的示例：

```
//Copyright (C) Microsoft Corporation.  All rights reserved.

using System;
using System.Threading;
using System.Collections;
using System.Collections.Generic;

// The thread synchronization events are encapsulated in this 
// class to allow them to easily be passed to the Consumer and 
// Producer classes. 
public class SyncEvents
{
    public SyncEvents()
    {
        // AutoResetEvent is used for the "new item" event because
        // we want this event to reset automatically each time the
        // consumer thread responds to this event.
        _newItemEvent = new AutoResetEvent(false);

        // ManualResetEvent is used for the "exit" event because
        // we want multiple threads to respond when this event is
        // signaled. If we used AutoResetEvent instead, the event
        // object would revert to a non-signaled state with after 
        // a single thread responded, and the other thread would 
        // fail to terminate.
        _exitThreadEvent = new ManualResetEvent(false);

        // The two events are placed in a WaitHandle array as well so
        // that the consumer thread can block on both events using
        // the WaitAny method.
        _eventArray = new WaitHandle[2];
        _eventArray[0] = _newItemEvent;
        _eventArray[1] = _exitThreadEvent;
    }

    // Public properties allow safe access to the events.
    public EventWaitHandle ExitThreadEvent
    {
        get { return _exitThreadEvent; }
    }
    public EventWaitHandle NewItemEvent
    {
        get { return _newItemEvent; }
    }
    public WaitHandle[] EventArray
    {
        get { return _eventArray; }
    }

    private EventWaitHandle _newItemEvent;
    private EventWaitHandle _exitThreadEvent;
    private WaitHandle[] _eventArray;
}

// The Producer class asynchronously (using a worker thread)
// adds items to the queue until there are 20 items.
public class Producer 
{
    public Producer(Queue<int> q, SyncEvents e)
    {
        _queue = q;
        _syncEvents = e;
    }
    public void ThreadRun()
    {
        int count = 0;
        Random r = new Random();
        while (!_syncEvents.ExitThreadEvent.WaitOne(0, false))
        {
            lock (((ICollection)_queue).SyncRoot)
            {
                while (_queue.Count < 20)
                {
                    _queue.Enqueue(r.Next(0, 100));
                    _syncEvents.NewItemEvent.Set();
                    count++;
                }
            }
        }
        Console.WriteLine("Producer thread: produced {0} items", count);
    }
    private Queue<int> _queue;
    private SyncEvents _syncEvents;
}

// The Consumer class uses its own worker thread to consume items
// in the queue. The Producer class notifies the Consumer class
// of new items with the NewItemEvent.
public class Consumer
{
    public Consumer(Queue<int> q, SyncEvents e)
    {
        _queue = q;
        _syncEvents = e;
    }
    public void ThreadRun()
    {
        int count = 0;
        while (WaitHandle.WaitAny(_syncEvents.EventArray) != 1)
        {
            lock (((ICollection)_queue).SyncRoot)
            {
                int item = _queue.Dequeue();
            }
            count++;
        }
        Console.WriteLine("Consumer Thread: consumed {0} items", count);
    }
    private Queue<int> _queue;
    private SyncEvents _syncEvents;
}

public class ThreadSyncSample
{
    private static void ShowQueueContents(Queue<int> q)
    {
        // Enumerating a collection is inherently not thread-safe,
        // so it is imperative that the collection be locked throughout
        // the enumeration to prevent the consumer and producer threads
        // from modifying the contents. (This method is called by the
        // primary thread only.)
        lock (((ICollection)q).SyncRoot)
        {
            foreach (int i in q)
            {
                Console.Write("{0} ", i);
            }
        }
        Console.WriteLine();
    }

    static void Main()
    {
        // Configure struct containing event information required
        // for thread synchronization. 
        SyncEvents syncEvents = new SyncEvents();

        // Generic Queue collection is used to store items to be 
        // produced and consumed. In this case 'int' is used.
        Queue<int> queue = new Queue<int>();

        // Create objects, one to produce items, and one to 
        // consume. The queue and the thread synchronization
        // events are passed to both objects.
        Console.WriteLine("Configuring worker threads...");
        Producer producer = new Producer(queue, syncEvents);
        Consumer consumer = new Consumer(queue, syncEvents);

        // Create the thread objects for producer and consumer
        // objects. This step does not create or launch the
        // actual threads.
        Thread producerThread = new Thread(producer.ThreadRun);
        Thread consumerThread = new Thread(consumer.ThreadRun);

        // Create and launch both threads.     
        Console.WriteLine("Launching producer and consumer threads...");        
        producerThread.Start();
        consumerThread.Start();

        // Let producer and consumer threads run for 10 seconds.
        // Use the primary thread (the thread executing this method)
        // to display the queue contents every 2.5 seconds.
        for (int i = 0; i < 4; i++)
        {
            Thread.Sleep(2500);
            ShowQueueContents(queue);
        }

        // Signal both consumer and producer thread to terminate.
        // Both threads will respond because ExitThreadEvent is a 
        // manual-reset event--so it stays 'set' unless explicitly reset.
        Console.WriteLine("Signaling threads to terminate...");
        syncEvents.ExitThreadEvent.Set();

        // Use Join to block primary thread, first until the producer thread
        // terminates, then until the consumer thread terminates.
        Console.WriteLine("main thread waiting for threads to finish...");
        producerThread.Join();
        consumerThread.Join();
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T11:56:06.530

请记住，如果您可以完全控制调用代码，则锁定调用代码可能是更好的选择。考虑循环访问您的队列：您将不必要地多次获取锁，可能会导致性能损失。

# jquery - 子项的jquery树网格（jqgrid）xml结构

> ID：801537
> 
> 赞同：0
> 
> 时间：2009-04-29T09:07:42.637
> 
> 标签：jquery, treegrid, jqgrid

谁能告诉我jqgrid使用的子项目的XML结构。我已经阅读了文档，但它并没有清楚地解释如何创建一个包含子项目的树视图。基本上我有一个 3 层的 2 列网格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T10:12:41.840

来自演示： [http ://www.trirand.com/jqgrid35/jqgrid.html](http://www.trirand.com/jqgrid35/jqgrid.html)

（在 3.3 版中的新功能->树形网格下）

它将这个 ajax 调用作为一个帖子： [http ://www.trirand.com/jqgrid35/server.php?q=tree](http://www.trirand.com/jqgrid35/server.php?q=tree)

帖子参数如下所示：

```
_search: false
n_left: 1
n_level: 0
n_right: 8
nd: 1241000465087
nodeid: 1
page: 1
rows: 20
sidx    
sord: asc 
```

这正是返回：

```
<?xml version='1.0' encoding='utf-8'?>
<rows>
<page>1</page>
<total>1</total>
<records>1</records>
<row><cell>1</cell><cell>Cash</cell><cell>100</cell><cell>400.00</cell<cell>250.00</cell><cell>150.00</cell><cell>0</cell><cell>1</cell><cell>8</cell><cell>false</cell><cell>false</cell></row>
<row><cell>5</cell><cell>Bank's</cell><cell>200</cell><cell>1500.00</cell><cell>1000.00</cell><cell>500.00</cell><cell>0</cell><cell>9</cell><cell>14</cell><cell>false</cell><cell>false</cell></row>
<row><cell>8</cell><cell>Fixed asset</cell><cell>300</cell><cell>0.00</cell<cell>1000.00</cell><cell>-1000.00</cell><cell>0</cell><cell>15</cell><cell>16</cell><cell>true</cell><cell>false</cell></row>
</rows> 
```

对于每个子行，它都会进行另一个 ajax 调用。第一个“单元格”元素指定行号。当下一行 id 之前有一个间隙时，它知道它有子项，并将为该行放置一个扩展器。当用户选择扩展器时，它会进行另一个 ajax 调用，并返回以下内容：

```
<?xml version='1.0' encoding='utf-8'?>
<rows>
<page>1</page>
<total>1</total>
<records>1</records>
<row><cell>2</cell><cell>Cash 1</cell><cell>1</cell><cell>300.00</cell><cell>200.00</cell><cell>100.00</cell><cell>1</cell><cell>2</cell><cell>5</cell><cell>false</cell><cell>false</cell></row>
<row><cell>4</cell><cell>Cash 2</cell><cell>2</cell><cell>100.00</cell><cell>50.00</cell><cell>50.00</cell><cell>1</cell><cell>6</cell><cell>7</cell><cell>true</cell><cell>false</cell></row>
</rows> 
```

查看源代码，它指定列名，并期望它们按顺序返回。我很确定您可以编写此代码以不期望特定顺序，但这就是设置映射的方式。这几乎是[ext](http://extjs.com/)做事方式的克隆，这是一种很好的遵循方式，因为它们做得很好。

```
jQuery("#treegrid").jqGrid({
    url: 'server.php?q=tree',
    treedatatype: "xml",
    mtype: "POST",
    colNames:["id","Account","Acc Num", "Debit", "Credit","Balance"],
    colModel:[
        {name:'id',index:'id', width:1,hidden:true,key:true},
        {name:'name',index:'name', width:180},
        {name:'num',index:'acc_num', width:80, align:"center"},
        {name:'debit',index:'debit', width:80, align:"right"},      
        {name:'credit',index:'credit', width:80,align:"right"},     
        {name:'balance',index:'balance', width:80,align:"right"}        
    ],
    height:'auto',
    pager : jQuery("#ptreegrid"),
    imgpath: gridimgpath,
    treeGrid: true,
    ExpandColumn : 'name',
    caption: "Treegrid example"
}); 
```

而且，为了完整起见，让我们包含 PHP 源代码示例（经历了这么多麻烦，还不如完成它！）：

```
$node = (integer)$_REQUEST["nodeid"];
// detect if here we post the data from allready loaded tree
// we can make here other checks
if( $node >0) {
    $n_lft = (integer)$_REQUEST["n_left"];
    $n_rgt = (integer)$_REQUEST["n_right"];
    $n_lvl = (integer)$_REQUEST["n_level"];

    $n_lvl = $n_lvl+1;
    $SQL = "SELECT account_id, name, acc_num, debit, credit, balance, level, lft, rgt FROM accounts WHERE lft > ".$n_lft." AND rgt < ".$n_rgt." AND level = ".$n_lvl." ORDER BY lft";
} else { 
    // initial grid
    $SQL = "SELECT account_id, name, acc_num, debit, credit, balance, level, lft, rgt FROM accounts WHERE level=0 ORDER BY lft";
}
$result = mysql_query( $SQL ) or die("Couldn t execute query.".mysql_error());
if ( stristr($_SERVER["HTTP_ACCEPT"],"application/xhtml+xml") ) {
header("Content-type: application/xhtml+xml;charset=utf-8"); } else {
header("Content-type: text/xml;charset=utf-8");
}
$et = ">";
echo "<?xml version='1.0' encoding='utf-8'?$et\n";
   echo "<rows>";
echo "<page>1</page>";
echo "<total>1</total>";
echo "<records>1</records>";
// be sure to put text data in CDATA
while($row = mysql_fetch_array($result,MYSQL_ASSOC)) {
    echo "<row>";           
    echo "<cell>". $row[account_id]."</cell>";
    echo "<cell>". $row[name]."</cell>";
    echo "<cell>". $row[acc_num]."</cell>";
    echo "<cell>". $row[debit]."</cell>";
    echo "<cell>". $row[credit]."</cell>";
    echo "<cell>". $row[balance]."</cell>";
    echo "<cell>". $row[level]."</cell>";
    echo "<cell>". $row[lft]."</cell>";
    echo "<cell>". $row[rgt]."</cell>";
    if($row[rgt] == $row[lft]+1) $leaf = 'true';else $leaf='false';
    echo "<cell>".$leaf."</cell>";
    echo "<cell>false</cell>";
    echo "</row>";
}
echo "</rows>"; 
```

# mysql - 在Mysql中加载inFile数据

> ID：801538
> 
> 赞同：0
> 
> 时间：2009-04-29T09:08:23.523
> 
> 标签：mysql, file-upload, load-data-infile

我有一个大小为 1.5GB 或大约 1.3 千万行的文本文件。当我将此文本文件加载到 MYSQL 中相同结构的表中时，

它的 Loads only 62Lack 记录，显示 65K 警告和 Finished。什么原因，为什么它只加载一半的记录？？？

我需要增加缓冲区大小吗？如果是，那么如何？

或者还有其他原因。

你们能帮帮我吗？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T20:16:55.703

问题是当您在 mysql 中导入大量记录时，它并不总是表现良好。它只是放大数据，对有问题的记录发出警告。您可以尝试“显示警告；”，但这只会帮助您处理最后的警告。

缓冲区大小在这里应该不是问题，除非你有很多大的 blob 元素。如果是这种情况，错误日志可能会显示有关 innodb 日志文件大小的信息。

如果错误日志没有帮助，我建议您尝试将输入分成几个较小的块，以便您可以挖掘它们以找到导致问题的记录。

我不知道 crore 和 lakh 是什么意思，所以我无法评论这些数字。

文件是由您尝试将其导入的同一个 mysql 导出的，还是从另一个版本的 mysql 导出的？可能有一些版本不兼容。

# iis-6 - 站点停止时 IIS 6.0 主机标头是否处于活动状态？

> ID：801541
> 
> 赞同：1
> 
> 时间：2009-04-29T09:09:22.150
> 
> 标签：iis-6

我有一个配置了 4 个站点的 IIS 服务器，使用主机头并共享相同的 IP。在服务器移动期间，我想关闭站点并显示一个保留页面。

为此，我打算创建一个没有配置主机头的第 5 个站点（即包罗万象），一个带有维护通知的 404 处理程序，并在升级期间停止其他 4 个单独的站点。

**问题：当我停止 4 个单独的站点时，这是否也会关闭主机头集水区，以便所有流量都发送到第 5 个站点（维护页面）。**

不幸的是，我目前只能使用带有 IIS 5 的 XP 机器进行试验。我查看了 MSDN 文章，但它们似乎没有提到当个别网站停止时会发生什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T10:19:35.443

是的，当您停止具有指定主机头的地址 $IP 上的站点时，其请求将传递到仅具有地址 $IP 的站点。您的迁移方法可以正常工作。

例子：

1.  站点位于 192.168.1.1，主机标头 SpecialSite.local
2.  站点在 192.168.1.1，没有主机头

只要站点 #1 正在运行，对 SpecialSite.local 的请求就会命中它。一旦站点 #1 停止，请求将传递到该 IP #2 的“默认”站点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T10:26:15.303

如果它只有 4 个站点（我假设 4 个域名绑定到这些站点），为什么不从源站点中删除标头，将它们添加到目标站点，然后在移动完成后反转？毫无疑问，IIS 将如何处理这种情况！

# jquery - jQuery 1.3.2 版在 Firefox 中不工作

> ID：801544
> 
> 赞同：0
> 
> 时间：2009-04-29T09:10:40.460
> 
> 标签：jquery

我正在尝试做一个简单的 jQuery 教程，但它不起作用。

我已经复制并粘贴了 jquery 文件名：jquery-1.3.2

我看不出有什么问题？我正在使用火狐。

```
$(function() {
  $('a').click(function() {
    $('#box').fadeOut();
  });
});
```

```
#box {
  background: red;
  width: 300px;
  height: 300px;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<div id="box"></div>
<a href="#">Click Me</a>
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-29T09:15:12.370

将您的点击事件代码放在不同的脚本块中。

```
 <script type="text/javascript" src="jquery-1.3.2.js"></script>
    <script type="text/javascript">
        $(function() {
            $('a').click(function() {
                    $('#box').fadeOut();
            });
    }); 
    </script> 
```

你犯的错误让我想起了[降级脚本标签](http://ejohn.org/blog/degrading-script-tags/)

> 引用外部资源（通过 src 属性）的脚本标签不再能够执行嵌入在标签本身中的脚本。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-29T09:13:14.043

首先，确保您`jquery-1.3.2.js`的目录中有 。

然后，更改您的脚本标签：

```
<script type="text/javascript" src="jquery-1.3.2.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
            $('a').click(function() {
                    $('#box').fadeOut();
            });
    });
</script> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-29T16:04:14.943

您需要非常小心地放置代码的不同部分以使其正常工作。

看看这个对我有用的代码。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <title>Fade Out Red Box</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <style type="text/css">
  #box
  {
    background: red;
    width: 300px;
    height: 300px;
  }
  </style>
</head>

<body>
  <div id="box"></div>
  <a href="#">Click me</a>

  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function(){
      $("a").click(function() {
        $("#box").fadeOut("slow");
      });
    });
  </script>
</body>
</html> 
```

# php - 如何将双/更多字母替换为单个字母？

> ID：801545
> 
> 赞同：4
> 
> 时间：2009-04-29T09:10:58.790
> 
> 标签：php, regex

我需要将单词中出现两次或多次的任何字母转换为自身的单个字母。

例如：

```
School -> Schol
Google -> Gogle
Gooooogle -> Gogle
VooDoo -> Vodo 
```

我尝试了以下方法，但停留在 eregi_replace 中的第二个参数。

```
$word = 'Goooogle';
$word2 = eregi_replace("([a-z]{2,})", "?", $word); 
```

如果我使用`\\\1`替换？，它将显示完全匹配。我如何使它成为一个字母？

任何人都可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-29T09:20:02.297

看到[正则表达式只用一个替换两个（或多个）连续字符？](https://stackoverflow.com/questions/106067/regular-expression-to-replace-two-or-more-consecutive-characters-by-only-one)

顺便说一句：您应该使用`preg_*`（PCRE）函数而不是不推荐使用的`ereg_*`函数（POSIX）。

[Richard Szalay](https://stackoverflow.com/questions/801545/how-to-replace-double-more-letters-to-a-single-letter/801554#801554)的回答是正确的：

```
$word = 'Goooogle';
$word2 = preg_replace('/(\w)\1+/', '$1', $word); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T09:13:28.753

您不仅要捕获整个事物（而不仅仅是第一个字符），而且还要`{2,}`重新匹配 [az] （不是原始匹配）。如果您使用它应该可以工作：

```
$word2 = eregi_replace("(\w)\1+", "\\1", $word); 
```

哪个反向引用原始匹配。如果您愿意，可以将 \w 替换为 [az]。

您的 Goooogle 示例需要 + （无论如何，对于 JS 正则表达式引擎），但我不知道为什么。

请记住，您将需要使用“全局”标志（“g”）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-18T05:32:21.013

试试这个：

```
$string = "thhhhiiiissssss hasss sooo mannnny letterss";
$string = preg_replace('/([a-zA-Z])\1+/', '$1', $string); 
```

这是如何工作的：

```
/ ... /    # Marks the start and end of the expression.
([a-zA-Z]) # Match any single a-z character lowercase or uppercase.
\1+        # One or more occurrence of the single character we matched previously.

$1         
\1+        # The same single character we matched previously. 
```

# asp.net-mvc - 在控制器中创建操作链接

> ID：801549
> 
> 赞同：27
> 
> 时间：2009-04-29T09:12:02.783
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

在我的一个控制器操作中，我正在生成一些 XML。该 XML 中的属性之一是`href`另一个控制器和操作，带有一些参数。XML 应如下所示：

```
<projects>
  <project id="42" name="Project X", href="/projects/42"/>
  <!-- etc. -->
</projects> 
```

我不介意 URL 是相对的还是绝对的，但我的问题是：如何以类型安全的方式在控制器代码中生成 URL？

换句话说，`HtmlHelper.ActionLink`除了控制器，我该如何做？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-29T09:22:46.877

通过使用反射器找到它：

```
string href = Url.Action("DetailsAsXml", new { projectId = item.Id }); 
```

# language-agnostic - 在两种相关技术的背景下，“原生”是什么意思？

> ID：801556
> 
> 赞同：0
> 
> 时间：2009-04-29T09:13:55.663
> 
> 标签：language-agnostic, ms-access, native, dao, jet

有问题的场景与备受诟病的[Microsoft Jet 数据库引擎](http://en.wikipedia.org/wiki/Microsoft_Jet_Database_Engine)有关。断言是[数据访问对象](http://en.wikipedia.org/wiki/Data_Access_Objects)(DAO) 数据访问技术是 Jet 的“原生”，这意味着通过 DAO 模型创建对象优于通过在[Microsoft Access](http://en.wikipedia.org/wiki/Microsoft_Access)中执行的 SQL 代码执行相同操作用户界面。

此外，有人断言，如果您无法通过 DAO 创建某些东西，那么根据定义，它不是 Jet 的“原生”。

对我来说，这个“原生”的定义似乎放错了地方。有许多 Jet 对象，出于历史和 Microsoft 政治原因，在 DAO 中省略或仅部分实现（`CHECK`约束、固定宽度数据类型、`DECIMAL`数据类型、可压缩数据类型等），但包含在 Jet 的 SQL 中[数据定义语言](http://en.wikipedia.org/wiki/Data_Definition_Language)(DDL)。直觉告诉我，Jet SQL DDL 应该被认为是 Jet 引擎的“原生”。

所以我的问题是：为什么一项看似外部的技术 (DAO) 会被视为“本地”，而另一项看似内部的技术 (SQL DDL) 会被视为“非本地”？我是否应该为某些东西是“本地的”还是其他东西而烦恼？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T21:37:20.510

在我看来，这个问题并不是真诚地发布的——它完全是针对我和我为回应你的评论而做出的评论。我已经在其他地方回答了所有问题，但为了清楚起见，让我概述一下 Jet 的历史。

Jet 在 90 年代初与 Access 一起推出。在版本 1 和 2 之间，MS 收购了 Foxpro 并将其“Rushmore”技术整合到 Jet 中。在这个时间框架的某个地方，MS 开发了 DAO 作为 Jet 的接口层。我不知道 DAO 曾经作为一个数据接口层以外的任何东西存在过，它使用 Jet 进行所有数据访问，但在我看来就是这样。Jet 是一个相当不错的选择，因为使用 ODBC 和可安装的 ISAM，它可以使几乎任何当时常见的数据库格式在您的应用程序中的外观和行为方式与原生 Jet 数据的外观和行为方式相同。那时，桌面数据库市场由 dBase 及其变体和 Paradox 主导。这些都是桌面数据库引擎，而不是服务器数据库。访问服务器数据库通常是通过 ODBC，但当时对桌面数据库应用程序开发人员来说并不是那么重要。Jet 很好地连接到 ODBC 数据源并非常有效地利用它们，尽管它有时会出错（这就是为什么将 ODBCDirect 引入 Jet 的原因，它会绕过 Jet 数据处理引擎的某些方面）。

现在，随着 Access/Jet/DAO 的兴起，Visual Basic 是通用 Windows 应用程序开发的热门产品，在 Web 蓬勃发展之前，VB 是世界上使用最广泛的编程语言。DAO 和 Jet 为 VB 开发人员提供了各种数据存储的接口，并且 VB 开发工具与他们很好地集成在一起。因此，在 ODBC 之后，DAO 成为 MS 的关键数据接口层，利用 Jet 引擎处理各种数据。

当然，这有其问题，并且由于 Jet/DAO（和 VB）都是面向桌面的工具而受到很大限制。到 90 年代中后期，MS 试图从桌面软件、桌面操作系统和开发工具的提供商扩展到企业软件提供商。因此，MS 需要开发更强大的数据接口，例如用于数据库服务器的 ODBC，但要具有较新的服务器数据库提供的所有现代功能。OLEDB 是解决此问题的答案，ADO 作为 OLEDB 顶部的界面层（就像 DAO 是 Jet 顶部的界面层一样）。虽然 DAO 的目标是通过 Jet 数据库引擎提供对大量数据存储的访问，但 OLEDB 是一个更中性的数据接口层，如 ODBC，一个数据库抽象层，而 ADO 是该中性数据接口层的接口。

关于“原生”DDL 的问题，事实是在 Jet 4 之前对 SQL DDL 的支持很差。也就是说，Jet 的某些功能无法通过 SQL DDL 控制。相反，您必须使用 DAO 来控制这些功能。虽然 Jet 数据库引擎程序员当然包括 DDL 示例和 DAO 示例，但 DAO 示例能够做的更多，因为 Jet DDL SQL 从不支持 Jet 数据库的所有功能。

由于 MS 内部政治​​，似乎如此令人困惑的故障发生了。到 1999 年，当 MS 推出 Access 2000（带有新版本的 Jet，4.0）时，MS 希望退出 DAO 以支持 ADO。MS 使 ADO 成为 Access 中的默认数据接口层，即使使用 ADO 没有意义（即，您的数据存储是 Jet）。作为这项工作的一部分，MS 没有完全更新 DAO 以包含对 Jet 4 的所有新功能的支持——相反，他们将这方面的工作投入到 ADO 中。结果是 Jet 的本机数据接口层 DAO 缺乏对数据库中立接口层 ADO 提供的 Jet 功能的支持。在我看来，这是微软的一种特殊形式的混蛋。MS 故意不更新 Jet' s 本机接口层，以强制您使用非本机接口。因此，您必须使用 ADO->OLEDB->Jet 来代替 DAO->Jet，甚至对于 Jet 数据库引擎的某些本机方面（例如字段的某些数据类型）。

微软的目标是彻底消灭 DAO，实际上是消灭 Jet 本身。他们希望客户迁移到 SQL Server。

但是发生了很多事情。一方面，基于 COM 的 ADO 不能很好地适应 .NET，因此，经典的基于 COM 的 ADO 最终被放弃，并创建了 ADO.NET 来取而代之。ADO 和 ADO.NET 之间的相似之处非常肤浅，并且基于完全不同的数据交互模型，ADO.NET 几乎完全围绕断开数据的概念设计，而 ADO 不是（尽管它确实支持某些类型的断开数据）数据访问）。

随着 ADO 的退出，微软的产品线中间出现了一个漏洞。经典的 VB 开发人员或 Access 开发人员不会在 .NET 中看到太多好处，因为整个数据访问模型不适合。因此，通过 Access 2002 的发布，MS 改变了方向，将 DAO 重新作为 Jet 数据的默认数据接口层（以及 Jet 可以使用的所有其他数据存储，例如 ODBC 等）。不幸的是，虽然 MS 现在不赞成将 ADO 与 Jet 一起使用，但他们并没有选择修复与它一起使用的 DAO 的残缺版本。也许他们没有这样做，因为此时已经决定将现有的 Jet 4 分叉到 Access 开发组拥有的数据库引擎中。这最终成为了 ACE，从所有意图和目的来看，它都是 Jet 4.5。发布了一个新版本的 DAO（虽然它的用户友好名称是“Microsoft Office 12.0 Access 数据库引擎对象库”，而 DLL 名称现在是 ACEDAO.DLL）。我不知道DAO 3.6（Jet 4 版本）中缺少的功能已添加到DAO 的ACE 版本的程度。我不知道，因为我不*需要*这些功能中的任何一个，所以甚至不知道它们是什么。

无论如何，在这一点上，Jet（我们曾被承诺 Jet 4 已结束）和它的原生数据接口层（DAO，我们也曾被承诺已死）正在进行开发. 这种持续的开发现在在 Microsoft 的 Access 应用程序组中进行（与以前维护 Jet 4 的 Windows 不同）。

Microsoft 在 Access 中添加了兼容模式，以使用他们所谓的 ANSI-92 SQL 模式。这应该允许您编写与 SQL Server 的 SQL 方言“兼容”的 SQL。好吧，它支持一些东西（您可以使用 SQL Server 通配符并使用 () 来表示派生表，而不是 Jet 的螺旋 []。作为别名），但不是很接近 TSQL。但在 Access 之外，使用这种“ANSI-92”SQL 模式的唯一方法是使用 ADO 连接到 Jet。DAO 本身仍然使用 Jet 的旧 SQL 方言。这表明 Jet 本身并没有提供对这种模式的支持，而是由 Jet 之上的层提供的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T09:50:59.180

也许我在这里错了，但我一直是这样理解的：

*   MS Jet 数据库引擎绝对是一个数据库引擎（动力不足）
*   它与外界的“本机”接口是一种 SQL 方言

然而：

*   DAO 是 Microsoft 的数据库抽象层之一，设计用于 VBA 或 Windows 脚本等 COM 环境
*   它是使用 Access 开发的（可以将其视为 MS Jet 的用户界面/报告工具，因为 MS Jet 可以在没有 MS Access 的情况下存在），并且与 MS Jet 和 MS Access 紧密捆绑在一起，但它是相同的ADO 所在的类别

# asp.net-mvc - 如何在asp.net(vs2008)中开发可以在手机上查看的web应用

> ID：801568
> 
> 赞同：0
> 
> 时间：2009-04-29T09:18:07.417
> 
> 标签：asp.net-mvc, mobile-website

先生，我是 asp.net 的初学者，对于我目前的项目，我需要使用 asp.net 3.5 开发一个可以在手机和所有其他浏览器上查看的移动 Web 应用程序支持它，但不再有VS2008 中的模板来启用移动开发。楼主请多指教，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T09:48:09.530

您需要创建一个特定于您要定位的每个移动浏览器的页面，或者创建一个适用于所有最低通用功能集的页面。

使用 ASP.NET 或任何其他基于服务器的框架应该会有所不同，关键在于您如何呈现它以及为有限的移动浏览器提供什么功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T10:07:19.437

[在http://www.mobiforge.com/](http://www.mobiforge.com/)了解通用移动开发

对于 ASP.NET 特定技术，请查看[http://mdbf.codeplex.com/](http://mdbf.codeplex.com/)

有关使用 MDBF（与 ASP.NET MVC - 但基础知识仍然适用）的详细信息，请访问： [http](http://www.hanselman.com/blog/MixMobileWebSitesWithASPNETMVCAndTheMobileBrowserDefinitionFile.aspx) ://www.hanselman.com/blog/MixMobileWebSitesWithASPNETMVCAndTheMobileBrowserDefinitionFile.aspx或[http://videos.visitmix.com上的视频/MIX09/T20F](http://videos.visitmix.com/MIX09/T20F) .

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-25T10:45:38.737

要从与 Web 内容相同的 URL 发布移动内容，您可以使用手机检测软件。尝试：

[http://www.movi​​ladetection.com/](http://www.moviladetection.com/)

# asp.net - 检查网页的更新日期？

> ID：801574
> 
> 赞同：0
> 
> 时间：2009-04-29T09:20:35.010
> 
> 标签：asp.net

我希望能够运行一个小脚本，我可以用 URL 列表填充它，它会拉入并检查页面上次更新的时间？有人做过吗？

我只能通过将其粘贴到浏览器 URL 字段中来找到使用 JavaScript 执行此操作的手动方法

```
javascript:alert(document.lastModified) 
```

任何想法都受到了极大的欢迎:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T09:26:50.750

如果您在 python 脚本中使用[urllib2](http://docs.python.org/library/urllib2.html)（或者[httplib](http://docs.python.org/library/httplib.html#httplib-examples)可能更好），您可以检查为 last-modified 字段[返回的标头。](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T10:47:55.767

下面将逐步遍历 URL 数组并显示上次修改日期，如果不存在，则显示服务器请求的日期。

```
string[] urls = { "http://boflynn.net", "http://slashdot.org" };
foreach ( string url in urls )
{
    System.Net.HttpWebRequest req =
        (System.Net.HttpWebRequest) System.Net.WebRequest.Create(url);
    System.Net.HttpWebResponse resp =
        (System.Net.HttpWebResponse) req.GetResponse();
    Console.WriteLine("{0} - {1}", url, resp.LastModified);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T11:16:05.653

这取决于您所说的“上次更新”是什么意思。当然，有 Last-Modified HTTP 标头，但它可能会产生很大的误导。例如，如果页面是动态提供的，那么这个字段将是当前时间是一个很好的变化，即使页面本身的内容（对人类有用的部分）已经很长时间没有更新了. 这个页面本身就是这种现象的一个很好的例子。

如果您真的对上次更新*内容*的时间感兴趣，那么我没有立即答复。

# c# - 正则表达式获取自定义TAG之间的所有值

> ID：801575
> 
> 赞同：2
> 
> 时间：2009-04-29T09:20:38.690
> 
> 标签：c#, asp.net, regex

我有 FLASH 对象的自定义标签，我想将其包含在 cms 内容中。现在，当我阅读内容时，我想获取那些自定义标签和两者之间的值。

自定义标签：

```
<myflash filename="test.swf" width="500" height="400">
  <param name="wmode" value="somevalue"></param>
  <param name="bgcolor" value="#ffffff"></param>
  <var name="id" value="testid"></var>
</myflash> 
```

现在我需要一个正则表达式，它将从内容中读取这些整个代码块。一个内容中会有多个自定义标签。

有人可以帮忙吗？

亲切的问候，

维普尔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T09:36:09.900

正则表达式是，IMO，处理 XML 的错误工具。为什么不使用`XmlDocument`或`XDocument`等？如果那是 HTML（注意没有“X”），那么[HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)可能很有用。

通过这两者`XmlDocument`和 HTML 敏捷包，您可以使用 xpath/xquery，因此您可以简单地使用`.SelectNodes("//myflash")`. `XDocument`有类似但不同的方法：`.Descendants("myFlash")`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T09:26:37.413

您可以从一个非常简单的正则表达式开始：

```
<myflash[^>]*>(.*?)</myflash> 
```

只需确保使用“非贪婪”捕获`(.*?)`，以便`".*"`尽可能少地匹配。

此外，使用`RegexOptions.SingleLine`, 以便点匹配每个字符，包括`\n`：

```
Regex re = new Regex("<myflash[^>]*>(.*?)</myflash>", RegexOptions.SingleLine); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T14:36:38.430

正如 Marc Gravell 所说，正则表达式不适合解析 HTML（或 XML）。请参阅[您能否提供一些示例，说明为什么使用正则表达式难以解析 XML 和 HTML？](https://stackoverflow.com/questions/701166/can-you-provide-some-examples-of-why-it-is-hard-to-parse-xml-and-html-with-a-rege)为什么。最好使用 HTML 解析器。请参阅[您能否提供一个使用您最喜欢的解析器解析 HTML 的示例？](https://stackoverflow.com/questions/773340/can-you-provide-an-example-of-parsing-html-with-your-favorite-parser)有关如何在多种语言中使用解析器的示例（至少有两个使用 C# 的示例）。

# git - 如何恢复因硬盘故障损坏的 Git 对象？

> ID：801577
> 
> 赞同：94
> 
> 时间：2009-04-29T09:21:03.993
> 
> 标签：git, corruption, data-recovery

我遇到了硬盘故障，导致 Git 存储库的某些文件损坏。运行时，`git fsck --full`我得到以下输出：

```
error: .git/objects/pack/pack-6863e0a0e4b4ded6090fac5d12eba6ca7346b19c.pack SHA1 checksum mismatch
error: index CRC mismatch for object 6c8cae4994b5ec7891ccb1527d30634997a978ee from .git/objects/pack/pack-6863e0a0e4b4ded6090fac5d12eba6ca7346b19c.pack at offset 97824129
error: inflate: data stream error (invalid code lengths set)
error: cannot unpack 6c8cae4994b5ec7891ccb1527d30634997a978ee from .git/objects/pack/pack-6863e0a0e4b4ded6090fac5d12eba6ca7346b19c.pack at offset 97824129
error: inflate: data stream error (invalid stored block lengths)
error: failed to read object 0dcf6723cc69cc7f91d4a7432d0f1a1f05e77eaa at offset 276988017 from .git/objects/pack/pack-6863e0a0e4b4ded6090fac5d12eba6ca7346b19c.pack
fatal: object 0dcf6723cc69cc7f91d4a7432d0f1a1f05e77eaa is corrupted 
```

我有存储库的备份，但包含包文件的唯一备份已经损坏。所以我认为我必须找到一种方法来从不同的备份中检索单个对象，并以某种方式指示 Git 生成一个只包含正确对象的新包。

你能给我提示如何修复我的存储库吗？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-04-29T13:09:54.833

在以前的一些备份中，您的坏对象可能已经打包在不同的文件中，或者可能是松散的对象。所以你的对象可能会被恢复。

您的数据库中似乎有一些坏对象。所以你可以用手动的方式来做。

因为`git hash-object`,`git mktree`并且`git commit-tree`不要写对象，因为它们是在包中找到的，然后开始这样做：

```
mv .git/objects/pack/* <somewhere>
for i in <somewhere>/*.pack; do
  git unpack-objects -r < $i
done
rm <somewhere>/* 
```

（您的包从存储库中移出，并在其中再次解包；现在只有好的对象在数据库中）

你可以做：

```
git cat-file -t 6c8cae4994b5ec7891ccb1527d30634997a978ee 
```

并检查对象的类型。

如果类型是 blob：从以前的备份中检索文件的内容（使用`git show`or`git cat-file`或`git unpack-file`; 那么您可以`git hash-object -w`重写当前存储库中的对象。

如果类型是树：您可以使用`git ls-tree`从以前的备份中恢复树；然后`git mktree`在您当前的存储库中再次编写它。

如果类型是提交：与`git show`,`git cat-file`和相同`git commit-tree`。

当然，我会在开始此过程之前备份您的原始工作副本。

另外，请查看[如何恢复损坏的 Blob 对象](http://www.kernel.org/pub/software/scm/git/docs/v1.7.10.1/howto/recover-corrupted-blob-object.txt)。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-05-04T13:46:24.047

[Banengusk](/users/16135/banengusk/)让我走上了正轨。为了进一步参考，我想发布我为修复存储库损坏而采取的步骤。我很幸运能够在旧包或存储库备份中找到所有需要的对象。

```
# Unpack last non-corrupted pack
$ mv .git/objects/pack .git/objects/pack.old
$ git unpack-objects -r < .git/objects/pack.old/pack-012066c998b2d171913aeb5bf0719fd4655fa7d0.pack
$ git log
fatal: bad object HEAD

$ cat .git/HEAD 
ref: refs/heads/master

$ ls .git/refs/heads/

$ cat .git/packed-refs 
# pack-refs with: peeled 
aa268a069add6d71e162c4e2455c1b690079c8c1 refs/heads/master

$ git fsck --full 
error: HEAD: invalid sha1 pointer aa268a069add6d71e162c4e2455c1b690079c8c1
error: refs/heads/master does not point to a valid object!
missing blob 75405ef0e6f66e48c1ff836786ff110efa33a919
missing blob 27c4611ffbc3c32712a395910a96052a3de67c9b
dangling tree 30473f109d87f4bcde612a2b9a204c3e322cb0dc

# Copy HEAD object from backup of repository
$ cp repobackup/.git/objects/aa/268a069add6d71e162c4e2455c1b690079c8c1 .git/objects/aa
# Now copy all missing objects from backup of repository and run "git fsck --full" afterwards
# Repeat until git fsck --full only reports dangling objects

# Now garbage collect repo
$ git gc
warning: reflog of 'HEAD' references pruned commits
warning: reflog of 'refs/heads/master' references pruned commits
Counting objects: 3992, done.
Delta compression using 2 threads.
fatal: object bf1c4953c0ea4a045bf0975a916b53d247e7ca94 inconsistent object length (6093 vs 415232)
error: failed to run repack

# Check reflogs...
$ git reflog

# ...then clean
$ git reflog expire --expire=0 --all

# Now garbage collect again
$ git gc       
Counting objects: 3992, done.
Delta compression using 2 threads.
Compressing objects: 100% (3970/3970), done.
Writing objects: 100% (3992/3992), done.
Total 3992 (delta 2060), reused 0 (delta 0)
Removing duplicate objects: 100% (256/256), done.
# Done! 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2014-03-27T17:07:47.503

首先尝试以下命令（如果需要，请再次运行）：

```
$ git fsck --full
$ git gc
$ git gc --prune=today
$ git fetch --all
$ git pull --rebase 
```

然后你仍然有问题，尝试可以：

*   删除所有损坏的对象，例如

    ```
    fatal: loose object 91c5...51e5 (stored in .git/objects/06/91c5...51e5) is corrupt
    $ rm -v .git/objects/06/91c5...51e5 
    ```

*   删除所有空对象，例如

    ```
    error: object file .git/objects/06/91c5...51e5 is empty
    $ find .git/objects/ -size 0 -exec rm -vf "{}" \; 
    ```

*   通过以下方式检查“断开的链接”消息：

    ```
    git ls-tree 2d9263c6d23595e7cb2a21e5ebbb53655278dff8 
    ```

    这将告诉您损坏的 blob 来自哪个文件！

*   要恢复文件，您可能真的很幸运，它可能是您已经在工作树中签出的版本：

    ```
    git hash-object -w my-magic-file 
    ```

    再次，如果它输出丢失的 SHA1 (4b945..) 你现在就完成了！

*   假设它是一些旧版本被破坏，最简单的方法是：

    ```
    git log --raw --all --full-history -- subdirectory/my-magic-file 
    ```

    这将向您显示该文件的整个日志（请注意，您拥有的树可能不是顶级树，因此您需要自己弄清楚它在哪个子目录中），然后您现在可以重新创建再次缺少带有散列对象的对象。

*   获取所有缺少提交、树或 blob 的 ref 的列表：

    ```
    $ git for-each-ref --format='%(refname)' | while read ref; do git rev-list --objects $ref >/dev/null || echo "in $ref"; done 
    ```

    使用常规的 branch -d 或 tag -d 命令可能无法删除其中的一些 ref，因为如果 git 注意到损坏，它们将会死掉。因此，请改用管道命令 git update-ref -d $ref。请注意，对于本地分支，此命令可能会在 .git/config 中留下陈旧的分支配置。它可以手动删除（查找 [branch "$ref"] 部分）。

*   在所有 refs 都干净之后，reflog 中可能仍然存在损坏的提交。您可以使用 git reflog expire --expire=now --all 清除所有 reflog。如果您不想丢失所有的 reflog，您可以在各个 refs 中搜索损坏的 reflog：

    ```
    $ (echo HEAD; git for-each-ref --format='%(refname)') | while read ref; do git rev-list -g --objects $ref >/dev/null || echo "in $ref"; done 
    ```

    （注意在 git rev-list 中添加了 -g 选项。）然后，在每个选项上使用 git reflog expire --expire=now $ref。当所有损坏的 refs 和 reflogs 都消失后，运行 git fsck --full 以检查存储库是否干净。悬空物体没问题。

* * *

**您可以在下面找到命令的高级用法，如果使用不当，可能会导致 git 存储库中的数据丢失，因此请在不小心对 git 造成进一步损害之前进行备份。如果您知道自己在做什么，请自行承担风险。**

* * *

获取后将当前分支拉到上游分支之上：

```
$ git pull --rebase 
```

您也可以尝试检查新分支并删除旧分支：

```
$ git checkout -b new_master origin/master 
```

* * *

要在 git 中查找损坏的对象以进行删除，请尝试以下命令：

```
while [ true ]; do f=`git fsck --full 2>&1|awk '{print $3}'|sed -r 's/(^..)(.*)/objects\/\1\/\2/'`; if [ ! -f "$f" ]; then break; fi; echo delete $f; rm -f "$f"; done 
```

对于 OSX，请`sed -E`使用`sed -r`.

* * *

另一个想法是从包文件中解压所有对象以重新生成 .git/objects 中的所有对象，因此请尝试在存储库中运行以下命令：

```
$ cp -fr .git/objects/pack .git/objects/pack.bak
$ for i in .git/objects/pack.bak/*.pack; do git unpack-objects -r < $i; done
$ rm -frv .git/objects/pack.bak 
```

* * *

如果上面没有帮助，您可以尝试从另一个 repo rsync 或复制 git 对象，例如

```
$ rsync -varu git_server:/path/to/git/.git local_git_repo/
$ rsync -varu /local/path/to/other-working/git/.git local_git_repo/
$ cp -frv ../other_repo/.git/objects .git/objects 
```

* * *

在尝试结帐时修复损坏的分支，如下所示：

```
$ git checkout -f master
fatal: unable to read tree 5ace24d474a9535ddd5e6a6c6a1ef480aecf2625 
```

尝试将其删除并再次从上游结帐：

```
$ git branch -D master
$ git checkout -b master github/master 
```

如果 git 让您进入分离状态，请签出`master`并将分离的分支合并到其中。

* * *

另一个想法是递归地 rebase 现有的 master：

```
$ git reset HEAD --hard
$ git rebase -s recursive -X theirs origin/master 
```

* * *

也可以看看：

*   [重建 blob 对象以修复损坏的存储库的一些技巧。](https://www.kernel.org/pub/software/scm/git/docs/howto/recover-corrupted-blob-object.txt)
*   [如何修复损坏的存储库？](https://git.wiki.kernel.org/index.php/GitFaq#fix-broken-repo)
*   [如何从存储库中删除所有损坏的引用？](https://git.wiki.kernel.org/index.php/GitFaq#salvage)
*   [如何修复损坏的 git 存储库？（搜索）](http://www.seeques.com/24667777/how-to-fix-corrupted-git-repository.html)
*   [如何修复损坏的 git 存储库？（问号）](http://qnundrum.com/answer.php?q=852196)
*   [将 SourceTree 与 Git 一起使用时出错：“摘要”失败，代码 128：致命：无法读取树](http://answer.techwikihow.com/759224/error-sourcetree-git-summary-failed-code-128-fatal-unable-read-tree.html)
*   [恢复损坏的 Git 裸存储库](http://rewoo.wordpress.com/2012/02/14/recover-a-corrupt-git-bare-repository/)
*   [恢复损坏的 git 存储库](http://miriup.de/index.php?option=com_content&view=article&id=88:recovering-a-damaged-git-repository&catid=8:linux&Itemid=25)
*   [如何修复 git 错误：对象是空的/损坏的](http://vincesalvino.blogspot.co.uk/2013/08/git-empty-files-corrupt-objects-and.html)
*   [如何诊断和修复 git 致命：无法读取树](https://stackoverflow.com/questions/20870895/how-to-diagnose-and-fix-git-fatal-unable-to-read-tree)
*   [如何处理这个 git 错误](https://stackoverflow.com/questions/1507463/how-to-deal-with-this-git-error)
*   [如何修复损坏的 git 存储库？](https://stackoverflow.com/questions/18678853/how-to-fix-corrupted-git-repository/18687206)
*   [我如何“覆盖”而不是“合并”Git 中另一个分支上的一个分支？](https://stackoverflow.com/questions/4624357/git-how-to-overwrite-rather-than-merge-a-branch-on-another-branch)
*   [如何从另一个分支完全替换 git 中的 master 分支？](https://stackoverflow.com/questions/2862590/how-to-replace-master-branch-in-git-entirely-from-another-branch)
*   [Git：“损坏的松散对象”](https://stackoverflow.com/questions/4254389/git-corrupt-loose-object)
*   [Git重置=致命：无法读取树](https://stackoverflow.com/questions/18515101/git-reset-fatal-unable-to-read-tree)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-10-30T03:51:51.993

以下是我从损坏的 blob 对象中恢复所遵循的步骤。

1) 识别损坏的 blob

```
git fsck --full
  error: inflate: data stream error (incorrect data check)
  error: sha1 mismatch 241091723c324aed77b2d35f97a05e856b319efd
  error: 241091723c324aed77b2d35f97a05e856b319efd: object corrupt or missing
  ... 
```

损坏的 blob 是**241091723c324aed77b2d35f97a05e856b319efd**

2) 将损坏的 blob 移动到安全的地方（以防万一）

```
mv .git/objects/24/1091723c324aed77b2d35f97a05e856b319efd ../24/ 
```

3) 获取损坏 blob 的父级

```
git fsck --full
  Checking object directories: 100% (256/256), done.
  Checking objects: 100% (70321/70321), done.
  broken link from    tree 0716831e1a6c8d3e6b2b541d21c4748cc0ce7180
              to    blob 241091723c324aed77b2d35f97a05e856b319efd 
```

父哈希是**0716831e1a6c8d3e6b2b541d21c4748cc0ce7180**。

4) 获取与损坏的 blob 对应的文件名

```
git ls-tree 0716831e1a6c8d3e6b2b541d21c4748cc0ce7180
  ...
  100644 blob 241091723c324aed77b2d35f97a05e856b319efd    dump.tar.gz
  ... 
```

在备份或上游 git 存储库中找到这个特定文件（在我的例子中是*dump.tar.gz*）。然后将其复制到本地存储库中的某个位置。

5）在git对象数据库中添加以前损坏的文件

```
git hash-object -w dump.tar.gz 
```

6）庆祝！

```
git gc
  Counting objects: 75197, done.
  Compressing objects: 100% (21805/21805), done.
  Writing objects: 100% (75197/75197), done.
  Total 75197 (delta 52999), reused 69857 (delta 49296) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T10:01:13.477

Git checkout 实际上可以从修订中挑选出单个文件。只需给它提交哈希和文件名。更详细的信息[在这里。](http://jasonrudolph.com/blog/2009/02/25/git-tip-how-to-merge-specific-files-from-another-branch/)

我想安全地解决这个问题的最简单方法是恢复到最新的未提交备份，然后有选择地从较新的提交中挑选出未损坏的文件。祝你好运！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-11-07T22:07:06.567

如果您的备份已损坏，或者您有一些部分损坏的备份（如果您备份损坏的对象，可能会发生这种情况），这里有两个功能可能会有所帮助。

在您尝试恢复的存储库中运行两者。

标准警告：仅在您真的很绝望并且您已经备份了（损坏的）回购时才使用。这可能无法解决任何问题，但至少应该突出腐败程度。

```
fsck_rm_corrupted() {
    corrupted='a'
    while [ "$corrupted" ]; do
        corrupted=$(                                  \
        git fsck --full --no-dangling 2>&1 >/dev/null \
            | grep 'stored in'                          \
            | sed -r 's:.*(\.git/.*)\).*:\1:'           \
        )
        echo "$corrupted"
        rm -f "$corrupted"
    done
}

if [ -z "$1" ]  || [ ! -d "$1" ]; then
    echo "'$1' is not a directory. Please provide the directory of the git repo"
    exit 1
fi

pushd "$1" >/dev/null
fsck_rm_corrupted
popd >/dev/null 
```

和

```
unpack_rm_corrupted() {
    corrupted='a'
    while [ "$corrupted" ]; do
        corrupted=$(                                  \
        git unpack-objects -r < "$1" 2>&1 >/dev/null \
            | grep 'stored in'                          \
            | sed -r 's:.*(\.git/.*)\).*:\1:'           \
        )
        echo "$corrupted"
        rm -f "$corrupted"
    done
}

if [ -z "$1" ]  || [ ! -d "$1" ]; then
    echo "'$1' is not a directory. Please provide the directory of the git repo"
    exit 1
fi

for p in $1/objects/pack/pack-*.pack; do
    echo "$p"
    unpack_rm_corrupted "$p"
done 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-03-27T18:38:33.583

我已经通过添加一些更改来解决这个问题，就像一次`git add -A`又一次`git commit`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-01-31T07:21:26.957

Daniel Fanjul 的解决方案看起来很有希望。我能够找到该 blob 文件并将其提取（“git fsck --full --no-dangling”、“git cat-file -t {hash}”、“git show {hash} > file.tmp”）但是当我尝试使用“git hash-object -w file.tmp”更新包文件时，它显示正确的哈希但错误仍然存​​在。

所以我决定尝试不同的方法。我可以简单地删除本地存储库并从远程下载所有内容，但是本地存储库中的某些分支提前 8 次提交，我不想丢失这些更改。由于那个很小的 ​​6kb mp3 文件，我决定完全删除它。我尝试了很多方法，但最好的方法来自这里：[https ://itextpdf.com/en/blog/technical-notes/how-completely-remove-file-git-repository](https://itextpdf.com/en/blog/technical-notes/how-completely-remove-file-git-repository)

我通过运行此命令“ **git rev-list --objects --all | grep {hash}** ”获得了文件名。然后我做了一个备份（强烈建议这样做，因为我失败了 3 次）然后运行命令：

“ **java -jar bfg.jar --delete-files {文件名} --no-blob-protection 。** ”

您可以从这里获取 bfg.jar 文件[https://rtyley.github.io/bfg-repo-cleaner/](https://rtyley.github.io/bfg-repo-cleaner/)所以根据文档我应该接下来运行这个命令：

**“git reflog expire --expire=now --all && git gc --prune=now --aggressive”**

当我这样做时，我在最后一步出现错误。因此，我从备份中恢复了所有内容，这一次，在删除文件后，我签出到分支（导致该错误），然后签回主目录，并且只有在一个接一个地运行命令之后：

**"git reflog expire --expire=now --all" "git gc --prune=now --aggressive"**

然后我将我的文件添加回其位置并提交。但是，由于许多本地提交已更改，我无法将任何内容推送到服务器。所以我备份服务器上的所有内容（以防万一我搞砸了），检查受影响的分支并运行命令“ **git push --force** ”。

我从这个案例中了解到了什么？GIT 很棒，但非常敏感...我应该可以选择简单地忽略一个 f... 6kb 文件我知道我在做什么。我不知道为什么“git hash-object -w”也不起作用=（吸取的教训，推送所有提交，不要等待，不时备份存储库。我也知道如何从存储库中删除文件，如果我永远需要=)

我希望这可以节省某人的时间

# .net - System.AddIn 管道应该安装在哪里？

> ID：801579
> 
> 赞同：4
> 
> 时间：2009-04-29T09:21:15.553
> 
> 标签：.net, installation, wix, add-in

我有一个带有 WiX 安装程序的普通旧 Windows 窗体应用程序，它为所有用户安装到该`Program Files`文件夹​​中，正如您所期望的那样。[该应用程序使用System.AddIn 框架](http://msdn.microsoft.com/en-us/library/bb384241.aspx)托管加载项。

因为 System.AddIn 框架需要写入某些加载项管道文件夹（`AddIns`、`AddInSideAdapters`、和） `AddInViews`，所以我不知道安装加载项的最佳位置。我无法安装到，因为用户没有写入权限，如果我安装到用户的文件夹，则不会为任何其他用户安装加载项。`Contracts``HostSideAdapters``Program Files``Application Data`

我意识到这里有冲突的要求（用户不能乱用其他用户的加载项，加载项需要为所有用户安装，所有用户都需要写入权限）但是最好的实用途径是什么?

可惜System.AddIn框架需要写的文件不能单独存放在里面`Application Data`，但这似乎是框架的限制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-03-16T21:55:24.893

我知道很久以前有人问过这个问题，但是...

您是否尝试过 Environment.SpecialFolder.CommonApplicationData？

在 Vista/Windows 7 中，此文件夹为： `%ProgramData%`. 我不是 100% 确定它在 Windows XP 中是什么，但它可能是`%ALLUSERSPROFILE%`.

无论如何，这个文件夹应该有读/写权限，并且对所有用户都是一样的。

不要忘记为您的公司/应用程序名称创建一个子文件夹：

```
string companyName = "My Company";
string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData);
string path = Path.Combine(folderPath, companyName); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T20:09:24.340

仍然希望有更好的答案，但我认为唯一的方法是将管道安装到 Program Files 并在每次运行应用程序时复制到 Application Data。然后，您将 System.AddIn 框架指向 Application Data 中的管道副本，以便它仅尝试写入用户配置文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T14:35:01.470

呃，你不能同时拥有“所有用户”和“没有提升”。我不完全知道 System.AddIn 框架是什么，但如果它打算从用户进程（又名：不是类似进程的系统服务）运行，那么它必须写在用户配置文件下（ApplicationDataFolder 是个好地方） . 这是所有应用程序都必须遵循的非常基本的规则。根据我对您评论的有限理解，听起来 System.AddIn 框架正在打破该规则。

但我可能只是错过了一些东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-24T00:48:11.520

您需要使用 WiX 安装程序吗？将您的应用程序部署为 clickonce 解决方案会将所有管道放入用户应用程序数据文件夹中。这样每个用户都可以保留自己的模块列表。

这也将绕过可写文件夹限制。

# javascript - 包括大量 css 文件和 Javascript 文件 - 我如何优化

> ID：801581
> 
> 赞同：2
> 
> 时间：2009-04-29T09:22:13.880
> 
> 标签：javascript, css, optimization, pageload

**重复：** [多个 javascript/css 文件：最佳实践？](https://stackoverflow.com/questions/490618/multiple-javascript-css-files-best-practices)

大家好，我的应用程序几乎完成了，但问题是我注意到我包含了很多外部 javascript 文件和 css。我在这里使用了很多第三方免费插件，并且不想触摸代码，因为担心会搞砸。

但结果是我注意到我现在包含了 8 个外部 css 文件以及多达 20 个外部 Javascript 文件：O - 我不记得见过任何主要网站包含超过 2 或 3 个 css_ js 文件，所以我肯定在这里做错了什么。我该如何解决这个问题 - 我在某处读到一个大的 js 文件比 2 或 3 个文件加载速度更快，甚至是累积大小的一半。

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T10:18:56.240

一个大文件比一堆小文件好，因为在这种情况下，Web 浏览器向 Web 服务器发出一个请求，而不是 8 个请求。更重要的不是总大小的细微差别，而是请求的总[延迟](http://rescomp.stanford.edu/~cheshire/rants/Latency.html)。

想象两种情况：您下载一个 8 kB 的文件和 8 个 1kB 的文件。

1.  在第一个场景中，总时间是 80 毫秒（传输时间）+ 50 毫秒（延迟）= 130 毫秒

2.  在第二种情况下，您有 8x10 毫秒（传输时间）+ 8x50 毫秒（！）的延迟 = 480 毫秒（！）

你看到了区别。这绝不是一个全面的例子，但你明白了。

因此，如果可能，将文件合并在一起。压缩内容以减少要传输的数据量。并使用缓存来摆脱重复的请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T09:24:20.443

YUI 压缩器[http://developer.yahoo.com/yui/compressor/](http://developer.yahoo.com/yui/compressor/)

还有一个很好的教程：[http ://beardscratchers.com/journal/compressing-css-and-javascript-with-yui-compressor](http://beardscratchers.com/journal/compressing-css-and-javascript-with-yui-compressor)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T10:06:38.457

如果您按照当前加载到页面的顺序将 CSS 文件合并到一个文件中（对于 JS 文件也是如此），那么它们的工作方式将与以前完全相同；当您开始更改规则时，规则可能会意外地覆盖它们不习惯的顺序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T10:19:15.447

无论如何，您的大多数文件都应该在客户端缓存中结束，所以我不会太担心它。只要确保你设置了正确的标题。当然，如果这是您网站的首页，那么是的，您可能应该进一步优化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T09:27:20.750

阅读本文：[加快网站速度的最佳实践](http://developer.yahoo.com/performance/rules.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T09:34:39.717

在过去的项目中，我使用[SmartOptimizer 即时](http://farhadi.ir/works/smartoptimizer)压缩 JS 和 CSS 文件。这是一个基于 PHP 的文件压缩器。

通过使用及时缩小器，您不必保留单独的源文件和缩小文件。当然，继续缩小文件需要一点处理能力。此外，加载单个缩小文件更好，具有以下优点：

1.  较小的文件大小（肯定）
2.  没有组件并行下载延迟，因为脚本/样式表更少。

# c# - 抛出 ASP.NET 错误时抓取网页

> ID：801584
> 
> 赞同：0
> 
> 时间：2009-04-29T09:23:44.143
> 
> 标签：c#, asp.net

当网页抛出“潜在危险脚本”错误时，我正在尝试抓取网页。每次我这样做时，我都会得到一个服务器 500，但我可以抓取一个正常的运行页面。有没有办法在网页出错时抓取网页？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T09:34:58.110

只是猜测，但也许抛出的错误会触发服务器错误（500）？这是有道理的。您应该仍然能够从页面获取*输出*。

不过一般来说，我希望你不介意，我不得不反对你的错误处理。首先，您可以将错误放在日志中并使用工具来监控它是否存在错误。其次，如果你的*脚本*抛出异常，你可以把它交给一个像[Exceptional](http://getexceptional.com/)这样的服务，然后它会通知你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T09:52:21.330

为什么不使用[ASP.NET 健康监控](http://msdn.microsoft.com/en-us/library/ms998306.aspx)？有一个邮件提供商会自动将错误详细信息发送给您，而无需任何手动抓取，您只需一些配置文件条目即可对其进行配置。简单的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T09:58:13.593

考虑使用[ELMAH](http://code.google.com/p/elmah/)记录所有错误。您还将获得许多有用的附加信息。

更多详情请访问：

[http://msdn.microsoft.com/en-us/library/aa479332.aspx](http://msdn.microsoft.com/en-us/library/aa479332.aspx) [http://www.hanselman.com/blog/ELMAHErrorLoggingModulesAndHandlersForASPNETAndMVCToo.aspx](http://www.hanselman.com/blog/ELMAHErrorLoggingModulesAndHandlersForASPNETAndMVCToo.aspx)

# sql - Oracle WITH CLAUSE 不起作用？

> ID：801586
> 
> 赞同：3
> 
> 时间：2009-04-29T09:24:41.800
> 
> 标签：sql, oracle, ora-00942, with-clause

我正在尝试在查询中使用 WITH 子句，但不断收到消息

> ORA-00942: 表或视图不存在

我试图在这里创建一个简单的查询作为示例：

> WITH
> test AS
> (
> SELECT COUNT(Customer_ID) FROM Customer
> )
> SELECT * FROM test;

但即使这样也不起作用，它只是给出了信息：

> 从测试中选择*；2 3 4 5 6 SQL>
> SELECT * FROM test
> * 第 1 行出现错误：
> ORA-00942：表或视图不存在

我以前从未使用过 WITH 子句，这里有什么简单的东西吗？我正在使用 Oracle Database 10g Enterprise Edition Release 10.2.0.1.0 - Prod 任何建议将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T13:55:37.453

我相信您的脚本中 WITH 子句和 SELECT 之间有一个空行：

```
SQL> WITH
  2  test AS
  3  (
  4  SELECT COUNT(Customer_ID) FROM Customer
  5  )
  6  
SQL> select * from test;
select * from test
              *
ERROR at line 1:
ORA-00942: table or view does not exist 
```

这与您将错误报告为“第 1 行”和 SQL“select * from test”的事实一致，而该 SQL 应位于“第 6 行”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T11:25:32.150

您的示例有效 - 刚刚尝试过（SQL*Plus 日志如下）：

```
SQL> create table customer
  2  (customer_id number);
Table created.
SQL> with 
  2  test as 
  3  (select count(customer_id)
  4  from customer
  5  )
  6  select * from test;
COUNT(CUSTOMER_ID)
------------------
         0 
```

您确定您对客户表具有特权还是不需要模式限定符（如果它在不同的模式中）？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-03-23T22:13:53.047

您是否尝试过添加到脚本的顶部

```
SET SQLBLANKLINES ON; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T09:32:51.093

看看这个[例子](http://www.dba-oracle.com/t_with_clause.htm)

编辑

一个非常基本的示例：

```
create table emp (emp_id number, dept_id number);
insert into emp values (1,20);
insert into emp values (2,20);
insert into emp values (3,20);
insert into emp values (4,30);

with
emp_counter  as (select count(distinct emp_id) from emp),
dept_counter as (select count(distinct dept_id) from emp)
select * from emp_counter, dept_counter;

COUNT(DISTINCTEMP_ID) COUNT(DISTINCTDEPT_ID)
--------------------- ----------------------
                    4                      2 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T14:01:00.170

您收到的错误字面意思是视图表在您当前的架构中不存在，并且您的架构没有可见的同义词。例如，如果我以 greg 身份登录，并且表在 bob 中，那么我应该将表引用为 bob.test。

```
SELECT * FROM bob.test 
```

至于 WITH 语法，我不熟悉，但其他答案都很好。

# c# - 跟踪 WPF 中的内存泄漏

> ID：801589
> 
> 赞同：3
> 
> 时间：2009-04-29T09:25:39.990
> 
> 标签：c#, wpf, memory-leaks, prism, autofac

背景：我们正在构建一个快速交付 WPF 应用程序的框架。该框架使用 Autofac 作为 IoC 容器，还使用 ​​Prism v1 中的区域。我们正在使用 Microsoft 的并行扩展来安排任务。

我们面临以下问题：当我们用空视图启动应用程序时（所以只是一个带有区域和占位符控件的外壳），内存将保持稳定约 60 秒，之后它将每秒增加 4kb，然后是 4kb ，在那之后的8kb。因此，每 3 秒我们就会增加 16Kb 的内存压力。

我们试图追踪泄漏的原因是什么。我开始使用 dotTrace，但我看不出相隔 30 分钟拍摄的 2 个快照之间有任何区别。继续使用 .NET 内存分析器，因为它为我提供了更多信息，但我们再次看不到 2 个快照之间的任何差异。我们可以看到创建了许多对象，但它们也被删除了，导致 delta 为 0。所以我继续使用 windbg，但结果是一样的。

另一个奇怪的事情是，当我们启动 sysinternals dbgvw 时，我们看不到在我们的应用程序中进行任何调用。

您对我们下一步可能尝试找出什么/谁是罪魁祸首有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T14:48:59.307

如果您正在寻找非托管泄漏并使用 Visual Studio，您可以使用内置的 crt 函数获得非常有用的信息：

查看[相关问题的答案](https://stackoverflow.com/questions/45627/how-do-you-detect-avoid-memory-leaks-in-your-unmanaged-code/50095#50095)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-09-07T13:22:15.307

事实证明这是 WPF 中的一个错误，解决方法是创建一个窗口处理程序作为第一个对象或其他东西。多谢你们

# binary - 二进制流的熵编码

> ID：801591
> 
> 赞同：3
> 
> 时间：2009-04-29T09:26:21.063
> 
> 标签：binary, entropy

我想压缩二进制流。我知道在每个“1”之后找到“0”的概率更高，在每个“0”之后找到“1”的概率更高。我应该如何编码？我在考虑赖斯代码，但我没有到目前为止......提前感谢您的任何回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T09:38:26.480

您是否尝试过一些简单的霍夫曼编码？也许它不会节省那么多，但是如果代码“10”和“01”之一的概率比“00”或“11”高得多，您可以将其重新映射为“0”，将其他代码重新映射为“10” 、“110”和“111”。

当然，这不是最佳选择，因为它将您的流分成 2 位块并且只优化一种情况。但是，可以通过计算/测量更大输入集（如 4 位或 8 位）的概率来改进它，在 8 位的情况下 fe 10101010 和 01010101 将比 00000000 和 11111111 更频繁地使用。

通过算术编码或一些真正使用基于位概率的模型的压缩，您可能会获得更好的结果。

另一种简单的方法是每秒反转一次。由于您提到的概率会倾向于像 0101010 这样的许多交替流部分，这会给您提供许多像 111111 这样的流部分，通常可以通过通常的压缩算法更好地压缩这些部分。但这种方法的成功取决于“概率差距”究竟有多大。

# windows - 使用 WMI 检索当前混音器级别？

> ID：801595
> 
> 赞同：0
> 
> 时间：2009-04-29T09:27:21.450
> 
> 标签：windows, language-agnostic, audio, wmi

有没有办法使用 WMI 获得 Windows 音频混音器级别？例如，获取当前线路输入电平。

理想情况下，这适用于 XP 和 Vista，尽管我知道两者之间的音频子系统完全不同，因此我可能需要为每个解决方案提供不同的解决方案。

**编辑**：任何语言的建议都可以。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T14:43:36.527

不 - 没有任何音频控件通过 WMI 公开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T04:44:48.747

Vista 对音频系统进行了重新改造，但我发现还没有任何好的样本可用于控制混音器中的线路。

# iphone - UILabel - 自动调整大小

> ID：801596
> 
> 赞同：5
> 
> 时间：2009-04-29T09:28:01.917
> 
> 标签：iphone, cocoa-touch

如何调整 UILabel 中文本的大小以适合标签？（我不希望这 3 个点出现）

先感谢您。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-29T09:34:06.850

```
UILabel *label;
label.adjustsFontSizeToFit = YES;
label.minimumFontSize = 5.0; // or whatever else minimum font size you want 
```

......应该做的伎俩！

# mysql - 两个进程的 MySQL MISAM 并发问题

> ID：801603
> 
> 赞同：0
> 
> 时间：2009-04-29T09:31:15.187
> 
> 标签：mysql, myisam

我可能忽略了一些简单的事情，但几周来我一直试图了解这里出了什么问题，我需要一双新的眼睛。

我有一个处理 Paypal 付款通知的 CGI 应用程序。当有人订阅时，我实际上得到了一个订阅 IPN，然后是一个支付 IPN。On 就在另一个之后，所以我启动了两个 CGI 进程。我为每个日志创建一个单独的日志，并且时间戳是相同的（时间戳的分辨率 - 秒）。

CGii 应用程序旨在为新订户创建用户帐户，然后支付 IPN 将信息添加到新创建的帐户中。很简单。

问题是第二个 IPN 无法找到该帐户。我认为这是因为它在第二个 IPN 去寻找它时已经完成创建，所以我将第二个 IPN 延迟了 5 秒。

现在时间戳显示为第一个 IPN 创建帐户的函数在第二个 IPN 开始查找它之前已返回，这意味着在发出第一个 SELECT 之前插入已完成。没运气。

我想知道这是否是缓存问题： [http](http://dev.mysql.com/tech-resources/articles/mysql-query-cache.html) ://dev.mysql.com/tech-resources/articles/mysql-query-cache.html 但我不这么认为。

我在这里根本没有使用 TRANSACTIONS，但是在第二个 CGI 应用程序发出它的 SELECT 之前，我没有释放第一个 CGI 应用程序的句柄，但这应该无关紧要。我想我可以尝试发布一个我可能忽略了一些简单的事情，但我已经尝试了解这里出了什么问题了几个星期，我需要一双新的眼睛。

我有一个处理 Paypal 付款通知的 CGI 应用程序。当有人订阅时，我实际上得到了一个订阅 IPN，然后是一个支付 IPN。On 就在另一个之后，所以我启动了两个 CGI 进程。我为每个日志创建一个单独的日志，并且时间戳是相同的（时间戳的分辨率 - 秒）。

CGii 应用程序旨在为新订户创建用户帐户，然后支付 IPN 将信息添加到新创建的帐户中。很简单。

问题是第二个 IPN 无法找到该帐户。我认为这是因为它在第二个 IPN 去寻找它时已经完成创建，所以我将第二个 IPN 延迟了 5 秒。

现在时间戳显示为第一个 IPN 创建帐户的函数在第二个 IPN 开始查找它之前已返回，这意味着在发出第一个 SELECT 之前插入已完成。没运气。

我想知道这是否是缓存问题： [http](http://dev.mysql.com/tech-resources/articles/mysql-query-cache.html) ://dev.mysql.com/tech-resources/articles/mysql-query-cache.html 但我不这么认为。

我没有使用 TRANSACTIONS，但我没有尝试在 INSERT 之后发出 COMMIT。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T08:01:30.183

MYISAM 表不支持事务，所以那里不会有问题。没有任何代码可看，老实说，在我看来，您的第二个查询使用了错误的 id。除了时间戳之外，您还记录什么？我会记录整个查询并确保 id 对应并且第二个查询正在寻找正确的记录。也许尝试仅使用 SQL 手动重现这种情况，并在测试查询时将脚本排除在外。

# linux - 如何判断 Linux 进程正在等待什么？

> ID：801604
> 
> 赞同：20
> 
> 时间：2009-04-29T09:31:25.530
> 
> 标签：linux, debugging, operating-system, process

我试图找出我在 Linux 下调试的应用程序中性能瓶颈的原因。所涉及的各种进程似乎花费大量时间阻塞 I/O 请求，我想知道是否有人知道任何 Linux 技巧可以让您了解特定进程*为何*被阻塞/它正在等待什么资源？例如有什么有用的`/proc`吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-29T09:39:42.093

无论是什么过程，您都可以使用它`top`来检查状态。然后你可以通过[truss 或 strace](http://www.cyberciti.biz/faq/howto-use-linux-truss-strace-command/)运行它。那应该详细说明正在发生的事情。如果这不可能，*请将其*连接到[gdb](http://sources.redhat.com/gdb/onlinedocs/gdb.html)。[iostat 之](http://linux.die.net/man/1/iostat)类的工具可能会向您展示正在发生的一般情况（例如，如果磁盘是瓶颈）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-29T09:39:25.587

您可以使用该`strace`命令查看您的进程在做什么。您可能还会发现`lsof`在您的进程上运行以查看它正在使用的文件和套接字很有用。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-29T10:06:18.097

strace 是你的朋友，因为你可以得到每个系统调用所花费的时间，另外你可以选择你感兴趣的文件描述符和系统调用。但是你也可以得到内核的支持：看看[latencytop](http://www.latencytop.org/)

# character-encoding - 如何以编程方式获取 SAS 编码选项？

> ID：801607
> 
> 赞同：6
> 
> 时间：2009-04-29T09:32:51.127
> 
> 标签：character-encoding, sas

如何以`encoding`编程方式找出 SAS 全局选项？我可以运行`proc options`，它会给我答案，但我需要从代码中完成。

我希望能在“查看宏符号 &sysencoding”这一行得到答案，但这可能太令人期待了。我宁愿避免脆弱的事情，比如写入外部文件和重新解析。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T09:56:35.687

您可以在 Base SAS 中使用 GETOPTION 函数：

```
data _null_;
  val=GETOPTION('encoding');
  put val=;
run; 
```

在我的系统上，这给出了日志输出

```
5    data _null_;
6      val=GETOPTION('encoding');
7      put val=;
8    run;

val=LATIN1 
```

在 SCL（SAS 组件语言）中，您可以使用 OPTGETC 和 OPTGETN 函数。有关详细信息，请参阅特定版本的 SAS 系统的手册。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T14:11:09.943

在 SAS 9.2`&sysencoding`中，您将获得与`getoption('encoding')`案例不同的相同内容（[此处](http://support.sas.com/documentation/cdl/en/whatsnew/62435/HTML/default/mcrolrefwhatsnew902.htm)简要描述）。

```
157  %put &sysencoding;
wlatin1
158
159  data _null_;
160    val=GETOPTION('encoding');
161    put val=;
162  run;

val=WLATIN1 
```

# java - Java ProcessBuilder process.destroy（）不会在winXP中杀死子进程

> ID：801609
> 
> 赞同：10
> 
> 时间：2009-04-29T09:33:52.310
> 
> 标签：java

我有一个 java 应用程序，用于`ProcessBuilder`准备操作系统命令并给我一个`Process`对象。（实际的 os 命令是 rsync over ssh using cygwin）。

这在 Windows 中运行良好，但是如果我想停止使用`process.destroy()`它的进程不会杀死子 ssh 和 rsync 进程.....我必须使用 Windows 任务管理器手动杀死它们。

是否有可能`OutputStream`在我打电话之前以某种方式获取进程并发送 ctrl-c `destroy();`？

如果有人对解决方法有任何想法，那就太好了。感谢：D

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T10:22:08.853

我还认为模拟 Ctrl-C 以完全杀死 ssh 是有问题的。

我会做的是以下方法之一。要么使用 windows 命令找出谁是 ssh 的儿子（这有点问题，因为你需要知道你当前的 pid 才能接收你自己的子进程）。我相信sysinternals 的[pstools](http://technet.microsoft.com/en-us/sysinternals/bb896649.aspx "pstools")是一个很好的命令行工具，可以让您跟踪孤立进程。请参阅[此示例](http://www.rgagnon.com/javadetails/java-0593.html "例子")`taskList.exe`以使用（它可以为您提供 CSV 格式的输出 BTW）或通过执行特殊的 VBScript来控制 Windows 进程。

第二种方法是使用诸如[winp之](http://winp.kohsuke.org/ "赢了")类的java库来执行和控制ssh进程。我相信如果发送正确的消息还不够，您将能够列出其所有孩子并强行杀死他们。这将是我的首选方法。请注意，[killRecursively](https://winp.dev.java.net/nonav/apidocs/org/jvnet/winp/WinProcess.html#killRecursively() "递归地杀死")方法完全符合您的要求。

请注意，这些方法不应仅呈现您的应用程序窗口。您可以将它们封装在一个在 Windows 和 linux 机器上以不同方式运行的类中。

请注意，我没有尝试对 Windows 进程进行细粒度控制，所以我不确定我找到的这些解决方案有多成熟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T09:43:38.837

我不确定 Process.destroy() 在幕后做了什么（发送信号或类似的东西？）。

您可能会发现更好的方法是在 shell 脚本中调用您的 ssh/rsync，并让它在 stdout 上返回一个进程 ID，然后当您想要终止该进程时，`/bin/kill`使用该进程 ID 执行一个。有点乱，但也许更可靠。

请注意，如果它特别顽固，您可以`/bin/kill`使用 SIGTERM 和 SIGKILL。

# flash - 可以让 Flash 缓存大型声音资源吗？

> ID：801613
> 
> 赞同：0
> 
> 时间：2009-04-29T09:35:18.343
> 
> 标签：flash, caching, cookies, audio, streaming

我用 Flash (AS3/Flex SDK/MXMLC) 编写了一个游戏，可以从我的服务器流式传输音乐和声音文件。

我担心带宽问题——音频组件接近 3MB，如果游戏流行起来，带宽费用真的会增加。

有没有办法让 Flash 在下载音频组件后缓存它们，而不是每次在同一台 PC 上加载游戏时都流式传输它们？

我知道 SharedObjects （“cookies”），但我认为没有办法在其中存储二进制数据......或者有吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T09:47:09.313

当您说*“流”*时，我假设您的意思是通过 HTTP 进行渐进式下载。

对于初学者，您需要确保从服务器发送的媒体资产具有满足您目标的适当缓存标头。如果这些不是缓存友好的，那么文件将不会被缓存。此外，查询字符串通常会阻止客户端缓存。

在这方面，Flash 播放器并没有什么真正神奇的地方——一切都应该像一个普通的网页一样工作。

您可能需要考虑将大型静态媒体资产托管在便宜的东西上（如[Amazon S3](http://aws.amazon.com/s3/)或[CloudFront](http://aws.amazon.com/cloudfront/)）。这可以降低不需要应用程序逻辑的批量传输的成本。

**受评论启发的更新：**这是您在追求中遵循的可能大纲...

1.  首先弄清楚什么样的缓存是和没有发生的
    1.  清除浏览器缓存
    2.  浏览游戏中的用例
    3.  再次浏览它，期望看到使用相同的内容
    4.  检查 Web 服务器日志文件。第一组请求都应该有 HTTP 200 响应代码。对于第二组请求，对于已经交付的文件的“可缓存”请求，您应该*什么*也看不到，或者看到 HTTP 304（一个请求只是为了查看缓存的内容是否有效。）如果您看到相同的请求集，所有这些请求都带有200 OK，然后缓存没有发生
2.  了解有关缓存的更多信息
    1.  安装一个像 TamperData 这样的 FireFox 插件，观察缓存头
    2.  阅读规范，了解它。RFC 2616
    3.  实验

如果您已经在缓存内容但只是没有意识到，我不会感到惊讶！

# sql-server - 如何在 ASP.NET MVC 中对全文搜索进行单元测试

> ID：801627
> 
> 赞同：1
> 
> 时间：2009-04-29T09:40:57.283
> 
> 标签：sql-server, asp.net-mvc, unit-testing, full-text-search

我刚开始使用 ASP.NET MVC 和 TDD。我已经读过，在进行单元测试时，您应该专注于测试您的代码，而不是其他系统，例如数据库。但是，当基本功能驻留在数据库中时会发生什么？

我使用 MVC Storefront 系列作为如何设置我的项目和模式的初始指南。由于全文搜索必不可少，因此我已将其设置为存储库中的功能

```
IQueryable<HealthOrganization> SearchOrganizations(string phrase); 
```

现在，这个搜索的逻辑需要一个带有全文的表值函数和数据库中的一些其他函数。这些函数中的逻辑不可能在 fakerepository 中完全正确。您对对此进行单元测试并在搜索中执行 TDD 的最佳策略有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T09:45:29.007

这不是单元测试，而是集成测试。所以你几乎不能像 TDD 那样实现它。

我假设*您的*代码除了调用数据库之外没有做太多事情。因此，您不必进行很多测试。如果您可以在最低级别模拟数据库调用，则可以测试调用是否发生。如果这变得非常复杂，最好不要为它编写单元测试。只会很难维护。

要编写集成测试，您需要一个真实的数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T23:44:42.223

您可以创建一个包含一组已知项目的测试数据库，然后检查搜索代码是否返回您期望的结果。

# javascript - 使用 javascript 获取一些 http url 的来源

> ID：801628
> 
> 赞同：1
> 
> 时间：2009-04-29T09:41:18.970
> 
> 标签：javascript, ajax, url

是否可以在客户端使用 javascript 获取任何网页的源代码？用 AJAX 可能吗？

但是我需要我从中下载 url 的服务器确实看到客户端的 IP .. 使用 AJAX 它会显示我的脚本服务器 IP，对吗？

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T09:42:00.120

Javascript 无法获取其域之外的项目。

AJAX 查询只是一个异步完成的普通请求。真实请求中发生的一切都将发生在 AJAX 请求中。

关于IP的事情，请求来自客户端。由于 Javascript 是基于客户端的，因此您将在请求中看到客户端的 IP。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T09:50:05.110

如果您在执行检索的服务器上实现服务，则应该可以这样做。因此，您的 AJAX 请求将调用如下所示的 URL：

[http://myownserver.com/getContent?url=theotherserver.com](http://myownserver.com/getContent?url=theotherserver.com)

这样你就可以绕过浏览器的 XSS 安全保护，但是远程服务器会看到你自己服务器的 IP，而不是客户端的 IP。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T09:44:42.377

首先，这被称为跨站点脚本 (XSS)，被认为是一种安全风险，因此当前的浏览器不允许这样做。

更一般地说，如果您的页面包含来自服务器 X 的引用（可能是图像），那么服务器 X 将看到客户端的明显 IP，这可能是其 ISP 中的代理服务器，也可能是其真实 IP。

# java - 架构验证android

> ID：801632
> 
> 赞同：5
> 
> 时间：2009-04-29T09:42:40.603
> 
> 标签：java, android, validation, xsd

其中有一个用于模式验证`java`的类，但它在 android 中不可用。`SchemaFactory`还有其他选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T12:35:13.933

Android 目前不支持 XSchema。这在 1.0 版本中是正确的，我只是查看了 1.5 中的更改，并没有对任何 xml 包进行任何更改，所以在我看来它仍然是正确的。我没有来源> 1.0。

在 1.0 源代码中，各种解析器类中有以下注释：

```
// TODO No XSchema support in Android 1.0\. Maybe later. 
```

因此，您现在必须捆绑自己的类或完全跳过模式验证。对他们来说，这可能不是一个高优先级的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T11:03:40.253

只要`SchemaFactory`该类不需要 JNI 代码，您就可以将其`.jar`文件导入您的 Android 项目并直接使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T09:48:38.827

您可以尝试直接使用 XML 实现中的验证器。要么看看你是否可以在 Android 附带的任何 XML 解析器中找到验证器类，或者使用像[MSV这样的独立验证器](https://msv.dev.java.net/)

# sql-server-2005 - SQL2005 中的动态透视需要帮助

> ID：801635
> 
> 赞同：1
> 
> 时间：2009-04-29T09:44:03.797
> 
> 标签：sql-server-2005, tsql, pivot-table, dynamic-pivot

我有一个名称值对表，我在其中存储标签：

```
TAGID | NAME | VALUE 
```

我有一张此标签适用的“事物”表

```
THINGID | TAGID 
```

我需要一个查询来生成一个结果集，列/字段对于给定的 THINGID 都是可能的 TAG-NAMES（TAG 表中的 NAME 字段），并且值是对应的标签值。

```
THINGID | TAGNAME1 | TAGNAME2 | ... |etc. 
```

我可以找到带有固定列的示例，但没有这样的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T09:57:37.697

架构略有不同（thing_id、tag_name、tag_value）的类似内容 - 没有标签表：

```
CREATE PROCEDURE dbo.PivotData(@table VARCHAR(128), @basefield
VARCHAR(128), @namefield VARCHAR(128), @valuefield VARCHAR(128))
AS
DECLARE
 @sql NVARCHAR(MAX)
SET @sql =
 'DECLARE
 @colName VARCHAR(128),
 @sqlBegin NVARCHAR(MAX),
 @sqlMiddle NVARCHAR(MAX),
 @sqlEnd NVARCHAR(MAX),
 @counter INT
 SET @counter = 1
 SET @sqlBegin = N''SELECT DISTINCT t0.'' + ''' + QUOTENAME(@basefield) + '''
 SET @sqlMiddle = N'' FROM '' + ''' + QUOTENAME(@table) + ''' + '' AS t0 ''
 DECLARE cols CURSOR FOR
 SELECT DISTINCT TOP 100 PERCENT ' + QUOTENAME(@namefield) + '
 FROM ' + QUOTENAME(@table) + '
 WHERE ' + QUOTENAME(@basefield) + ' IS NOT NULL
 ORDER BY ' + QUOTENAME(@namefield) + '
 OPEN cols
 FETCH NEXT FROM cols INTO @colName
 WHILE @@FETCH_STATUS = 0 BEGIN
 SET @sqlBegin = @sqlBegin + '', t'' + CAST(@counter AS VARCHAR) +
''.'' + ''' + QUOTENAME(@valuefield) + ''' + '' AS '' +
QUOTENAME(@colName) + ''''
 SET @sqlMiddle = @sqlMiddle + '' LEFT OUTER JOIN '' + ''' +
  QUOTENAME(@table) + ''' + '' AS t'' + CAST(@counter AS VARCHAR) +
'' ON t0.'' + ''' +
  QUOTENAME(@basefield) + ''' + '' = t'' + CAST(@counter AS VARCHAR)
+ ''.'' + ''' +
  QUOTENAME(@basefield) + ''' + '' AND t'' + CAST(@counter AS
VARCHAR) + ''.'' + ''' + QUOTENAME(@namefield) + ''' + ''='' +
QUOTENAME(@colName, '''''''') + ''''
 SET @counter = @counter + 1
 FETCH NEXT FROM cols INTO @colName
 END
 CLOSE cols
 DEALLOCATE cols
 SET @sqlEnd = '' WHERE t0.'' + ''' + QUOTENAME(@basefield) + ''' + ''
IS NOT NULL''
 DECLARE @sql NVARCHAR(MAX)
 SET @sql = @sqlBegin + @sqlMiddle + @sqlEnd
 EXEC sp_executesql @sql'
EXEC sp_executesql @sql
RETURN 0
GO
CREATE TABLE test_data (
id int identity primary key,
person_id int,
person_data_field VARCHAR (128),
person_data_value VARCHAR (128)
)
GO
INSERT INTO dbo.test_data (person_id, person_data_field, person_data_value)
VALUES (1, 'Name', 'John')
INSERT INTO dbo.test_data (person_id, person_data_field, person_data_value)
VALUES (1, 'Surname', 'Smith')
INSERT INTO dbo.test_data (person_id, person_data_field, person_data_value)
VALUES (1, 'Email', 'John@Smith.com')
INSERT INTO dbo.test_data (person_id, person_data_field, person_data_value)
VALUES (2, 'Name', 'Sarah')
INSERT INTO dbo.test_data (person_id, person_data_field, person_data_value)
VALUES (2, 'Surname', 'Lee')
INSERT INTO dbo.test_data (person_id, person_data_field, person_data_value)
VALUES (2, 'Phone', '012345678')
GO
EXEC [dbo].[PivotData] @table='test_data',
@basefield='person_id', @namefield='person_data_field', @valuefield='person_data_value'
GO 
```

我发现这工作得太慢了，并停止进一步调整它，但它有点符合您的要求。

# xml - 如何自动将 Oracle Applications Web 表单导出为 PDF？

> ID：801639
> 
> 赞同：0
> 
> 时间：2009-04-29T09:45:02.797
> 
> 标签：xml, oracle, forms, pdf, oracle-apex

这个想法是，在数据输入时，自动将 Oracle 应用程序 (web) 表单导出为 PDF，并将其存储在数据库中。

使用 XML Publisher，可以允许用户按需导出，但我需要自动生成报告/表单 PDF。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T10:58:39.843

一种方法是使用[iText](http://www.lowagie.com/iText/)。保存表单后，编写一个小类来生成 PDF 文件，并将其存储在您想要的任何位置。

这对程序员（你）来说不是*自动*的，因为它涉及为它编写一个类，但对于不需要做任何事情来将其形式保存到 PDF 文件中的最终用户来说，它是*自动的。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-01T08:52:27.503

[这里](http://apps2fusion.com/at/ps/51-ps/260-integrating-xml-publisher-and-oa-framework)几乎涵盖了一个好的解决方案。基本上，通过一些 OAF 代码，可以将表单 XML 转换为调用 XML Publisher API 的 PDF。

不过，让表单 XML 自动生成而不需要自定义查询 + 视图对象会很有趣。

# command-line - Team City 和 MSBuild：将文件复制到另一台计算机为什么不起作用？

> ID：801640
> 
> 赞同：1
> 
> 时间：2009-04-29T09:45:17.650
> 
> 标签：command-line, msbuild, teamcity

我正在使用 TeamCity 4 使用 MSBuild 进行 CI。我的问题是，当我尝试将文件复制到 QA 服务器时，msbuild 失败，但如果我将脚本更改为在本地复制，它就可以工作。我尝试将远程共享映射为本地驱动器，但它似乎仍然不起作用。

这是我在 MSBuild 上的任务：

```
<Exec Command="$(BATCH_PATH)deploy_DEV.bat $(DEPLOY_PATH)" /> 
```

这是批处理文件的内容：

```
"C:\Program Files\Windows Resource Kits\Tools\robocopy" %1 \\RemoteServer\SharedDirectory\ /MIR 
```

有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T09:48:13.023

构建是否在系统帐户上运行？如果是这样，网络共享可能不可用或未经身份验证。您可以在本地用户帐户上运行构建代理（不推荐），或者以某种方式确保系统帐户可以使用共享。robocopy 调用的输出是什么？

您还可以尝试使用 TeamCity 的工件系统替换您的批处理文件。只需添加适当的工件路径以使构建结果可用于 TeamCity，然后应该有一个选项可以将工件复制到另一个系统（虽然不确定）。

# javascript - 如何在 IE 中获取 sIFR 嵌入标签的点击事件？

> ID：801642
> 
> 赞同：2
> 
> 时间：2009-04-29T09:45:39.240
> 
> 标签：javascript, flash, internet-explorer, sifr

我已经实现了[Scalable Inman Flash Replacement](http://en.wikipedia.org/wiki/Scalable_Inman_Flash_Replacement) (sIFR) 来转换文本。问题是，我无法`onClick`通过 iSFR 嵌入标签执行事件。

```
$(function() {
    $("embed").click(function(){
        alert('clicked over embed');
    });
}); 
```

这适用于 Firefox，但不适用于 Internet Explorer。有谁能够帮我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T19:16:31.057

Flash 电影往往会吃掉这些事件。

sIFR 3 允许您在参数中指定`onRelease`回调处理程序，`sIFR.replace()`当单击 Flash 影片时调用该处理程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-17T00:08:39.613

[在http://cufon.shoqolate.com/generate/](http://cufon.shoqolate.com/generate/)上查看 cufón 可能也值得一试

# pdf - 用于 SSRS 报告的 Pdf 打印预览

> ID：801644
> 
> 赞同：0
> 
> 时间：2009-04-29T09:47:04.150
> 
> 标签：pdf, reporting-services, reportingservices-2005

单击打印预览链接时，我们如何以 pdf 格式显示 SSRS 2005 报告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-07T21:05:36.070

想到了两种方法。一个是实现你的要求，另一个是更好的。

要实现您的要求，您需要从 ReportViewer 类派生并在 Microsoft 代码执行之前处理为“打印预览”引发的事件。在处理程序中，您会将报告呈现为 PDF 并将生成的流呈现给客户端。如果我们谈论的是 ReportViewer Web 控件，可能会涉及到自动生成的客户端 JavaScript 代码的一些调整。如果我们谈论的是 ReportViewer WinForms 控件，您可能还会考虑弄乱控件的工具栏按钮和事件处理程序。

更好的方法是使用单独的链接或按钮来调用 PDF 呈现。如果您对 ReportViewer 的工具栏不是 100% 满意，您可以随时隐藏它并显示您自己的。

# c#-2.0 - 在 Windows 应用程序中模拟会话

> ID：801651
> 
> 赞同：2
> 
> 时间：2009-04-29T09:48:35.643
> 
> 标签：c#-2.0

我正在开发一个 Windows 应用程序。我需要在 win 应用程序中模拟会话（我们在 web 应用程序中），如果用户在一段时间内不活动，他会被注销。用户登录状态保存在数据库中。

有什么创新想法？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T09:54:54.070

想到的是在计时器达到零时使用 BackgroundWorker 注销用户。此计时器会在用户执行的每个操作时重置。或者它甚至可以与鼠标或键盘事件挂钩，这样当用户不移动鼠标或不使用键盘时，计时器就会倒计时，直到达到注销时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T09:56:12.210

您不需要 Session （或 CallContext 或其他任何东西），只需要一个具有一个限制的[单例](http://www.dofactory.com/Patterns/PatternSingleton.aspx)“用户存储”：

用户登录或显示某些活动后，您必须保存其日期/时间。下次，当用户想要做某事时，只需将 (lastactivity + logouttime) 与实际日期/时间进行比较。

该过程的概述可能是：

```
 [User login]
                   |
                   !
 [User 'store' saves user date + login time]
 [This is a singleton                      ]

                  ...

[Next time user wants to do something. The   ]
[program asks user data from the user 'store']
                   |
                   !
[If the actual time is greater than user     ]
[lastactivity + LOGOUTTIME, user cannot do it]
[If not, then update last activity           ] 
```

UserStore 可以实现为*Dictionary*并用作：

```
// Log in
Singleton.UserStore.Add("John", new UserData( yourUserObject, DateTime.Now));

...

// Check (ie. in a property-get)
var userData = Singleton.UserStore["John"];
if (userData.LastActivityDate + _LOGOUTIME > DateTime.Now()) 
{
   throw UserAutomaticallyLoggedOut();
}
else
{
   userData.LastActivityDate = DateTime.Now();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T09:56:21.770

您可以在应用程序中创建一个类，该类具有某种超时，每次用户与软件交互时都会重置该超时。如果达到超时，用户将被注销。

这里棘手的事情是检测用户交互。在 ASP.NET 中非常简单，您基本上只需要检查页面请求。在 Windows 窗体应用程序中，您需要在更详细的级别上监控输入（例如，任何文本框中的任何按键都将是用户交互）。我想 KeyPreview 属性与表单上的 KeyPress 事件侦听器可能是一个很好的前进方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T09:57:37.463

那么，首先，你所说的不活跃是什么意思？在 Web 上，您试图模拟没有状态的状态。但是，在客户端应用程序中，您会收到各种事件，甚至是 MouseMove。Onde 的想法是，您可以从标准输入控件（如 TextBox、Button 等）创建 UserControl，并让它们在调用事件时更新某种计时器对象。另一种是放弃 UserControl 的东西，只更新您创建的每个事件处理程序中的计时器。可能仅根据表单本身的 MouseMove 或 KeyDown 事件更新计时器会更简单。

# c++ - Python 比 C++ 更快更轻吗？

> ID：801657
> 
> 赞同：97
> 
> 时间：2009-04-29T09:51:34.933
> 
> 标签：c++, python, performance, memory, statistics

我一直认为Python的优势在于代码可读性和开发速度，但是时间和内存使用不如C++。

[这些数据](http://benchmarksgame.alioth.debian.org/u64q/compare.php?lang=python3&lang2=gpp)让我非常震惊。

关于 Python 与 C++ 的时间和内存使用情况，您的经验告诉您什么？

* * *

## 回答 #1

> 赞同：267
> 
> 时间：2009-04-29T09:55:06.440

我认为您正在错误地阅读这些统计数据。他们表明 Python比 C++*慢*大约 400 倍，除了单个案例之外，Python 更像是一个内存猪。但是，在源大小方面，Python 完全胜出。

我使用 Python 的经验表明，在进行任何严重的数字运算时，Python 的速度比 C++ 慢 10 到 100 倍。造成这种情况的原因有很多，主要是： a) Python 是解释型的，而 C++ 是编译型的；b) Python 没有原语，包括内置类型（int、float 等）在内的一切都是对象；c) Python 列表可以保存不同类型的对象，因此每个条目都必须存储有关其类型的附加数据。这些都严重阻碍了运行时和内存消耗。

不过，这不是忽略 Python 的理由。即使有 100 倍的慢速因素，许多软件也不需要太多时间或内存。开发成本是 Python 以简洁的风格取胜的地方。这种对开发成本的改进通常超过了额外的 CPU 和内存资源的成本。但是，如果没有，那么 C++ 就赢了。

* * *

## 回答 #2

> 赞同：142
> 
> 时间：2009-04-29T10:10:04.860

枪战中所有最慢（>100x）的 Python 使用都是需要高 GFlop/s 计数的科学操作。无论如何，你不应该使用 python。使用 python 的正确方法是导入一个进行这些计算的模块，然后和家人一起度过一个轻松的下午。*那*是pythonic的方式:)

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-04-29T09:56:58.713

我的经验与基准测试相同。Python 可能很慢并且使用更多内存。我编写的代码少得多，而且它第一次工作时调试少得多。由于它为我管理内存，因此我无需进行任何内存管理，从而节省了数小时追踪核心泄漏的时间。

你有什么问题？

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-04-29T09:58:16.150

源大小并不是一个真正明智的衡量标准。例如，以下 shell 脚本：

```
cat foobar 
```

比它的 Python 或 C++ 等价物短得多。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-04-29T10:00:20.217

另外：[Psyco 与 C++](http://shootout.alioth.debian.org/gp4/benchmark.php?test=all&lang=psyco&lang2=gpp&box=1)。

这仍然是一个糟糕的比较，因为无论如何，没有人会做基准测试倾向于在纯 Python 中关注的数字易碎的东西。更好的方法是比较实际应用程序的性能，或 C++ 与 NumPy，以了解您的程序是否会明显变慢。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-29T10:12:16.617

这里的问题是您有两种不同的语言可以解决两个不同的问题……就像将 C++ 与汇编程序进行比较一样。

Python 用于快速应用程序开发以及性能是最小问题的情况。

C++*不适*用于快速应用程序开发，它继承了 C 的速度遗产——用于低级编程。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-29T10:37:54.870

与往常一样，托管且易于使用的编程语言也存在同样的问题 - 它们很慢（有时会占用内存）。

这些是用于控制而不是处理的语言。如果我必须编写应用程序来转换图像并且也必须使用 Python，那么所有处理都可以用 C++ 编写并通过绑定连接到 Python，而接口和流程控制将是 Python。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-29T09:57:25.030

我认为这些统计数据表明 Python 速度要慢得多，并且在这些基准测试中使用更多内存 - 你确定你正在以正确的方式阅读它们吗？

根据我的经验，主要是用 Python 编写网络和文件系统绑定的程序，Python 在任何重要的方面都不会明显变慢。对于这种工作，它的收益大于成本。

# asp.net - 在预编译的 asp.net 网站中 - 有关系吗？

> ID：801659
> 
> 赞同：14
> 
> 时间：2009-04-29T09:51:57.850
> 
> 标签：asp.net, web-deployment-project

我正在使用 Visual Studio 2008 上的 Web 部署项目部署一个预编译和所有页面合并的网站。请注意，所有程序集和项目都已在发布模式下编译。

我所有的页面都是在发布模式下预编译的。所以它们不会被重新编译，它们只会被运行时加载。在那种不需要页面编译的情况下，`<compilation debug="true">`system.web中的设置会有什么不同吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-29T10:05:39.190

查看以下优秀链接：

*   [ASP.NET 内存：如果您的应用程序正在生产中……那么为什么 debug=true](http://blogs.msdn.com/tess/archive/2006/04/13/575364.aspx)
*   [不要在启用 debug=”true” 的情况下运行生产 ASP.NET 应用程序](http://weblogs.asp.net/scottgu/archive/2006/04/11/Don_1920_t-run-production-ASP.NET-Applications-with-debug_3D001D20_true_1D20_-enabled.aspx)

基本上：

*   由于调试支持的开销，您的代码将运行得更慢。
*   脚本和图像不会缓存在客户端，因为如果您不断进行更改和调试，您不希望在开发中缓存内容。
*   请求不会超时。同样，当您调试代码时，您不希望请求超时。

以上都不是可取的。您会在上述链接中发现更多缺点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T09:54:14.523

根据[文档](http://msdn.microsoft.com/en-us/library/s10awwz0.aspx)：

> 指定是否编译调试二进制文件而不是零售二进制文件

但是，刚刚通过 System.Web 快速反映，我可以看到调试标志被以下使用（直接或间接）：

*   运行时编译 (ASPX/ASCX/MASTER)
*   浏览器功能文件的代码生成
*   HttpDebugHandler，在调试会话期间使用

因此，如果您的网站是预编译的，您将不会收到性能损失。但是，由于 HttpApplication 将响应 DEBUG http 动词，因此您将面临安全问题。

简而言之，设置 debug=false，即使您的站点是预编译的。

**编辑：** debug=true 将导致缓存性能（参见 Mehmet Aras 的回答）命中并且没有执行超时，但它不会降低编译页面的执行速度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T10:39:23.277

来自博客文章[ASP.Net – 再也不用担心使用 debug=true 发布您的网站](http://blog.aggregatedintelligence.com/2009/04/aspnet-never-again-fear-publishing-your.html)：

*   ASP.NET 页面的编译需要更长的时间（因为关闭了批处理编译）
*   代码通常执行较慢
*   内存占用增加
*   从 WebResources.axd 处理程序下载的脚本和图像不会被缓存
*   请求不会超时（这很糟糕，因为在生产环境中我们不希望请求被无限期地卡住）

这篇文章继续建议设置生产服务器 machine.config 以确保强制零售部署模式，这本质上意味着调试总是错误的。

# sql - 使用附加条件计算表中的非唯一行

> ID：801661
> 
> 赞同：0
> 
> 时间：2009-04-29T09:52:29.877
> 
> 标签：sql, mysql, count

我有一个包含以下字段的表用户

日期（日期时间）电子邮件（varchar）提供者（int）事件（int）

我正在查找同一电子邮件中有多少记录，这些记录发生在特定提供者的特定月份。

就像提供者 = x 和月份 = yi 一样

```
email              occurs
peter@peter.com    5
peter@peter.co.uk  2 
```

我知道它应该是 WHERE provider= x 和 MONTH(date) = y，但是我怎样才能从表格中获取所有电子邮件的计数？是否可以？

对不起，如果这不是很清楚！感谢您的帮助

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T09:59:23.433

这应该有效：

```
SELECT email, COUNT(*) AS occurs
WHERE provider = x AND YEARMONTH(date) = y
GROUP BY email
HAVING occurs > 1 
```

# linq - 制作 linq 子查询

> ID：801662
> 
> 赞同：0
> 
> 时间：2009-04-29T09:52:43.107
> 
> 标签：linq

注册表有结构

```
regid
userid

var Registered = form r in dc.registered  where ... // list contains userid as f.k. 
```

我想要已注册的用户列表。

所以像这样查询

```
var user = from u in dc.users where u.userid in // should contains in Register.userid 
```

我想了解更多关于 linq 的信息，我可以在哪里找到最好的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T10:13:26.177

我怀疑你想要：

```
var users = from u in dc.users 
            join r in Registered on u.userid equals r.userid
            select u; 
```

请注意，这将比“任何”解决方案更有效，因为它会建立一组已注册的用户 ID（作为哈希集），此时每个用户的测试很快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T09:58:05.853

我不确定你的问题是否那么清楚......但是......

此资源是 Linq 的一个很好的起点：http: [//msdn.microsoft.com/en-us/vcsharp/aa336746.aspx](http://msdn.microsoft.com/en-us/vcsharp/aa336746.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T09:59:06.617

您可以执行以下操作：

```
var innerQuery = from r in dc.Registered
                 select r;

var outerQuery = from k in dc.Users
                 where (innerQuery).Any(x => x.UserID == k.UserID)
                 select k; 
```

不知道语法是否完全正确，但这是在 LINQ 中进行子查询的一种方法。无论如何，它应该为您指明正确的方向。

关于学习 LINQ，这是另一个处理相同问题的问题：[有哪些好的 LINQ 资源](https://stackoverflow.com/questions/47740/what-are-some-good-linq-resouces)。

# linq - linq 到 XML（C# 到 VB.net 的转换）

> ID：801668
> 
> 赞同：0
> 
> 时间：2009-04-29T09:54:52.540
> 
> 标签：linq, linq-to-xml

在 VB.net 中相当于下面的内容

```
 var list = (from x in xd.Descendants("product").Attributes("title") select 
      new { Title= x.Value}).ToList(); 
```

VB.net Dim list = (From x In xd.Descendants("product").Attributes("title") _ Select New ( ??? )).ToList()

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T09:59:35.117

```
New With { .Title = x.Value } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T02:48:01.843

你真的想要一个 List(Of ) 吗？如果您的匿名类型只有一个属性，那么使用 List(Of String) 的结果会不会更容易？

这是您的查询的完整 vb.net 语法以及一些用于测试它的 XML。我通常将 .ToList 调用分开，但这主要是为了清楚起见。另请注意，使用下面的代码，在 .ToList 调用之前不会执行查询，因此出于这个原因将它们分开也可能会有所帮助。

运行此代码后，ListA 是类型`List(Of <anonymous type>)`，ListB 是类型`List(Of String)`

```
Dim testXml = <test>
                  <product title="Prod1"/>
                  <product title="Prod2"/>
                  <product title="Prod3"/>
              </test>

Dim queryA = From t In testXml...<product> _
             Select New With {.Title = t.@title}

Dim listA = queryA.ToList

Dim queryB = From t In testXml...<product> _
             Select t.@title

Dim ListB = queryB.ToList 
```

# asp.net - 如何将字符串生成器的内容写入文本框

> ID：801672
> 
> 赞同：1
> 
> 时间：2009-04-29T09:55:31.273
> 
> 标签：asp.net, vb.net

我有一个文本框，我必须在其中编写字符串生成器中的内容。以下是我的字符串生成器。

```
Dim strString As New StringBuilder()
        strString.AppendLine("<table>")
        strString.AppendLine("<tr><td>")
        strString.AppendLine("<br/><br/>")
        strString.AppendLine("<div style=""text-transform: capitalize;""><strong>Dear " & Session("PatientName") & ",")
        strString.AppendLine("</strong></div></td></tr>")
        strString.AppendLine("<br/><br/>")
        strString.AppendLine("<tr><td>")
        strString.AppendLine("Your appointment has been confirmed.")
        strString.AppendLine("<br /><br />")
        strString.AppendLine("Your appointment Time: " + Session("AppTime"))
        strString.AppendLine("<br />")
        strString.AppendLine("Your appointment Date: " + Session("AppointmentDate"))
        strString.AppendLine("</td></tr>")
        strString.AppendLine("<tr><td>")
        strString.AppendLine("<br/><br/>")
        strString.AppendLine("</table>") 
```

我使用了 textbox.text=strString.ToString()。但是在那个 html 标签中也显示了。我想在上面的文本框中写。我要写什么代码来删除 html 标签，我想用上面给定的 html 格式写？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T09:58:34.793

**这应该这样做：**

```
textbox.Text = Regex.Replace(strString.ToString(), _
                         "<(.|\n)*?>", string.Empty) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T10:23:37.103

不需要文本框中的标签，您应该执行以下操作：

```
Dim strString As New StringBuilder()
strString.AppendLine()
strString.AppendLine("Dear " & System.Threading.Thread.CurrentThread.CurrentCulture.TextInfo.ToTitleCase(Session("PatientName")) & ",")
strString.AppendLine()
strString.AppendLine("Your appointment has been confirmed.")
strString.AppendLine()
strString.AppendLine("Your appointment Time: " + Session("AppTime"))
strString.AppendLine("Your appointment Date: " + Session("AppointmentDate"))
textbox.text = strString.ToString 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T10:05:34.463

仅供参考。

您可以按照 Jose 的建议删除 html，但这不会保留 HTML Table 布局......您只会将所有内容都作为单独的行。同样，如果您尝试将其从文本框中保存回来，您将没有 HTML 格式。

# .net - .NET 缓存工具

> ID：801676
> 
> 赞同：1
> 
> 时间：2009-04-29T09:56:34.300
> 
> 标签：.net, asp.net, caching

为什么要使用第三方缓存工具？对于 ASP.NET，您会推荐哪一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T09:59:42.997

我们使用了 Velocity，但发现它非常原始，并将我们的网站重新定位到 memcached - 非常稳定的缓存。我投票给 memcached [http://www.danga.com/memcached/](http://www.danga.com/memcached/)。

# tomcat - Tomcat 启动失败，标识符无效

> ID：801688
> 
> 赞同：0
> 
> 时间：2009-04-29T09:58:34.950
> 
> 标签：tomcat, startup, tomcat6

我在一台服务器上运行的 Tomcat 6.0.18 没有问题。使用完全相同的设置，它无法在我同事的机器上启动。他甚至和我在同一个文件夹中运行（我已经停止了我的副本，而他试图让它工作）

当我们使用 bin/startup.sh 启动 tomcat 时，我们得到的是：

CATALINA_OPTS=-server -Xms768m -XX:+UseParallelGC -Xmx768m -XX:MaxPermSize=256m -XX:PermSize=128m -Djava.awt.headless=true:**不是标识符**

我在 setenv.sh 中有该定义并将其移至 startup.sh - 同样的问题。

有什么建议么？我在谷歌上的简短查看似乎表明存在多个 IP 地址问题，但我的服务器有两个以太网卡和两个 IP 地址。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T10:41:31.773

这是一个 shell 脚本，而不是 Tomcat 问题。正确的做法是：

```
export CATALINA_OPTS="....." 
```

您的同事可能使用的外壳与您不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T10:27:30.247

没有太多可以去那里。不应该引用 CATALINA_OPTS 的值吗？：

```
CATALINA_OPTS="-server -Xms768m -XX:+UseParallelGC -Xmx768m -XX:MaxPermSize=256m -XX:PermSize=128m -Djava.awt.headless=true" 
```

除此之外

*   它是否在没有安装任何选项和/或任何应用程序的情况下启动？
*   它甚至与启动实际的 java 进程一样公平吗？

# visual-studio - 用户从安装中删除文件并触发 .net 应用程序的自动重新安装

> ID：801698
> 
> 赞同：2
> 
> 时间：2009-04-29T10:02:10.540
> 
> 标签：visual-studio, visual-studio-2005, installation, project

简而言之，我在 .net 安装程序项目中进行了一项设置，如果已安装的文件被删除，则会关闭自动重新安装。

我已经使用 VS2005 构建了 ac#.net 应用程序。在客户端机器上安装后，用户抱怨说，如果他们删除安装中包含的文件，重新安装程序就会启动。重新安装程序会覆盖 application.exe.config 文件，这令人沮丧。我们允许用户修改此文件，但重新安装会导致他们的自定义丢失。

问候安迪B

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T10:07:19.453

我认为最好的做法是允许用户在文件系统用户区域的单独 user.config 文件中进行自定义。然后，您的应用程序可以检查用户是否覆盖了 app.config 中的设置并改为使用该设置。

# html - 如何使用图像类型按钮以 HTML 表单提交时删除 x 和 y？

> ID：801702
> 
> 赞同：53
> 
> 时间：2009-04-29T10:03:46.263
> 
> 标签：html, forms, url, query-string

我在我的应用程序中创建了一个表单，如下所示：

```
<form action="/search/" method="get">
   <input id="search-box" name="search" type="text" size=30 title="Search" value="" />
   <input id="search-submit" type="image" alt="Search" src="/images/search-button.gif" /> 
</form> 
```

但是当我提交表单时，会创建如下 URL：

```
mysitename.com/search/?search=hello&x=0&y=0 
```

谁能告诉我为什么这个 x 和 y 出现在我的 URL 中。如果我正在更改我的表单代码，而不是图像按钮，那么它可以正常工作，

```
<form action="/search/" method="get">
   <input id="search-box" name="search" type="text" size=30 title="Search" value="" />
   <input id="search-submit" type="submit" value="Search"/> 
</form> 
```

但我需要一个图像按钮来使我的表单看起来不错。请告诉我如何从 URL 中删除这些 x 和 y 参数。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-04-29T10:11:25.167

您将始终获得提交按钮 type="image" 的鼠标坐标

您可以使用标准的提交类型按钮，只需对其应用样式即可更改外观。

```
<input type="submit" id="search-submit" value=""
    style="background-image: url(/images/search-button.gif); border: solid 0px #000000; width: WIDTHpx; height: HEIGHTpx;" /> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T10:05:18.270

它们是单击的鼠标坐标。我不相信有任何方法可以阻止它们-如果您使用 an ，`<input type='image'>`那么您就会得到它们。为什么会出现问题？你不能忽略他们吗？

回答 Prashant 的评论：Digg 正在向（或可能是表单的处理程序）添加一个`onclick`处理程序，该处理程序构建了整洁的搜索 URL 并将浏览器重定向到该 URL，然后返回以防止提交表单本身。如果您关闭 JavaScript，您会看到您确实在 URL 中获得了和参数。聪明的！`<input>``onsubmit``false``<input>``x``y`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T10:26:56.520

```
document.getElementById("formid").submit = function() {
    location = "/search/?search=" + encodeURIComponent( document.getElementById("search-box").value );
    return false;
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-16T22:50:06.650

您可以简单地为图像按钮设置一个值，这将覆盖常规坐标行为。它对我有用。

例如 ：

```
<input type="image" value="submit" src="sup.png" name="supprimer" /> 
```

将返回 php 变量`$_POST['supprimer']`而不是其坐标作为图像按钮。希望这个技巧能帮到你。

# .net - 英国地方政府网站的基本可访问性级别是多少？

> ID：801706
> 
> 赞同：5
> 
> 时间：2009-04-29T10:05:44.167
> 
> 标签：.net, asp.net, javascript, accessibility

我正在为苏格兰的一个地方政府部门设计一个新网站，我想确保我满足该网站的最低可访问性级别。

我曾计划使用一些 jQuery 效果，以及 AJAXify 内容。但我意识到所有这些 JavaScript 可能都无法访问。

我们将使用 VS2008 ASP.NET 3.5 框架。（C# 服务器端和 SQL Server 2005 数据库）

有谁知道政府运营网站的最低标准是什么？它将面向公众，其目标用户将是 11 至 17 岁的孩子。

另外，是否有任何工具可以检查我们的网站？Visual Studio 的内置/添加工具会很棒。

我们通常为我们的管理团队设计内部站点，所以这是我们第一次不得不担心可访问性，所以如果您愿意，请以“傻瓜”风格回答！:)

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-29T10:48:36.687

您还必须遵守《残疾歧视法》——尤其是因为这是政府资源。

有关该法案的信息[http://www.direct.gov.uk/en/DisabledPeople/RightsAndObligations/DisabilityRights/DG_4001068](http://www.direct.gov.uk/en/DisabledPeople/RightsAndObligations/DisabilityRights/DG_4001068)

和[http://www.coi.gov.uk/guidance.php?page=169](http://www.coi.gov.uk/guidance.php?page=169)

以及有关网站和行为的一些信息[http://www.webcredible.co.uk/user-friendly-resources/web-accessibility/uk-website-legal-requirements.shtml](http://www.webcredible.co.uk/user-friendly-resources/web-accessibility/uk-website-legal-requirements.shtml)

和[http://www.alistapart.com/articles/accessuk](http://www.alistapart.com/articles/accessuk)

我们与很多地方议会打交道，他们的所有网站都必须可以通过屏幕阅读器访问，以便有视觉障碍的人可以使用它们，因此如果用户禁用了 JavaScript 和 CSS，它们需要能够导航。

您需要确保如果您在网站上使用任何 CSS，导航和结构会优雅地降级以使它们有意义（例如，不要将导航设置为页面上的最后一项，然后使用 CSS 将其移动到顶部） . 也不要让任何导航依赖于 Javascript（或者如果用户关闭了 JavaScript，至少有另一种导航方法）。

应验证 HTML 和 CSS 以确保没有错误。

所有图像都需要 ALT 属性

所有链接都需要标题属性

任何表格都应该有一个摘要

还有更多类似的项目，但测试应该标记这些项目。

在测试网站方面，有一些免费的屏幕阅读器可用——尽管我们在这些方面取得的成功有限，因为它们在工作方式方面受到了很大的打击。目前，“Jaws”似乎是行业“标准”，但这非常昂贵，因此您可能希望将任何测试外包给另一家公司；虽然有些理事会会自己组织。

您还应该在 Lynx 等纯文本浏览器上测试该站点。

可以在下面找到更多资源：

大白鲨[http://www.freedomscientific.com/products/fs/jaws-product-page.asp](http://www.freedomscientific.com/products/fs/jaws-product-page.asp)

免费[http://www.screenreader.net](http://www.screenreader.net) , [http://www.webaim.org/simulations/screenreader.php](http://www.webaim.org/simulations/screenreader.php) , [http://www.xpscreenreader.com/](http://www.xpscreenreader.com/)

[http://firevox.clcworld.net/](http://firevox.clcworld.net/) - 火狐插件 [http://sourceforge.net/projects/fangs/](http://sourceforge.net/projects/fangs/) - 火狐插件

可访问性检查器

功能可访问性评估器 - [http://fae.cita.uiuc.edu/](http://fae.cita.uiuc.edu/)

WAVE - [http://wave.webaim.org/](http://wave.webaim.org/) 辛西娅说 - [http://www.cynthiasays.com/](http://www.cynthiasays.com/)

TAW Web 可访问性测试 - [http://www.tawdis.net/taw3/cms/en/](http://www.tawdis.net/taw3/cms/en/)

或者下载 Firefox 可访问性检查器，其中包含对上述所有内容的检查以及 HTML 和 CSS 验证器[https://addons.mozilla.org/en-US/firefox/addon/5809](https://addons.mozilla.org/en-US/firefox/addon/5809)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T10:29:17.027

您应该首先让客户澄清这些要求，并确保他们实际研究该主题，因为他们目前可能对此一无所知，并且当有人指出时会进一步添加要求（相信我，我'曾在苏格兰政府机构工作过！）

当我在政府工作时（2004 - 2006 年），电子政务指南很重要，其中有一个关于可访问性的指南。我不记得这些是可公开访问的还是只能在 Intranet 上使用的，但我确实找到了这个页面，其中包含看起来相同的文档：[Web Guidelines](http://www.cabinetoffice.gov.uk/government_it/web_guidelines.aspx)。同样，您应该与客户澄清要遵守的正确文件是什么。他们也可能有自己的可访问性标准，具体取决于他们是什么组织（当然不是你可以说的，但我怀疑较小的委员会之一可能有这个）。

这些文档可能非常乏味且难以阅读，并且通常会导致网站丑陋，因为人们认为简单是实现可访问性的唯一方法。当然，这不是真的，因此由您来解释指南并提供违反它们的理由是必要的。

关于工具，我假设您的意思是某种自动化测试？如果是这样，答案是肯定的，它们存在，但请不要依赖它们作为您唯一的测试方法！再多的自动化测试都无法告诉您网站的真正可访问性，只有真实世界的测试才能做到这一点。然而，一个工具可以派上用场的地方是检查颜色对比度，有几个可以使用模拟各种形式的色盲的算法来呈现您的页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T10:34:31.633

我对此略有不同的看法。

为什么 jQuery / AJAX 必须让网站更难访问？

您的页面应该在没有任何 JavaScript 的情况下工作，并且您的 jQuery 和 AJAX 调用应该是页面功能的补充，在适当的情况下用“体验增强”功能替换默认行为。jQuery 的最佳元素之一是它可以帮助您将 JavaScript 与 HTML 分开。

在可访问性方面，我同意您应该询问客户——但我也认为它应该成为任何项目的一部分，甚至是内部管理控制台。雇主必须遵守残疾歧视法案中的规则，就像企业对客户一样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T10:37:47.210

您可能想阅读[中央信息办公室](http://www.coi.gov.uk/)(COI) 发布的政策文件。[提供包容性网站 PDF](http://www.coi.gov.uk/documents/guidance/delivering-inclusive-websites.pdf)

引用文档：

> 这些指南适用于希望提供包容性、可访问性网站的公共部门网站所有者和数字媒体项目经理。本文件规定了公共部门网络内容和网络创作工具的最低可访问性标准。它建议采用以用户为中心的可访问性方法，在网页设计项目的规划和采购阶段考虑用户需求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T10:38:46.507

看看 out-law.com - 一个由律师事务所（品诚梅森）运营的非常好的法律信息网站。他们的可访问性和可用性指南在这里：[http ://www.out-law.com/page-337](http://www.out-law.com/page-337)

概述很好，用简单的英语，没有法律术语，并且有一个标题为“需要什么标准？”的部分。它确实说明了问题

> 根据 Web 内容可访问性指南 (WCAG) 测试您的网站也是可访问性的重要指标。
> 
> ...
> 
> 符合 WCAG 不应该是您的主要目标，当然也不应该是您的唯一目标 - 但它可能是您检查的第一件事。

每个政府部门对最低标准都有自己的解释。我认为为政府部门设立的一些网站存在很多不一致之处。正如其他人所说 - 与客户讨论这个问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T10:48:55.780

Visual Studio 将完全根据您为站点选择的 DOCTYPE 以及所使用的 Web 浏览器版本为客户端生成可访问的 X/HTML 标记，这是一个不错的功能。

对于公共部门站点，您需要尝试确保 AJAX 或 JQuery 元素在 JavaScript 禁用时也可用。也就是说，将时髦的附加功能作为 JS 赋予用户的可选附加功能，但页面的核心功能无论如何都可以使用。

不要依赖 JQuery 来获得基本功能，因为请记住，在所有可能的情况下，屏幕阅读器可能无法理解它，而非 JS 浏览器也不会。

重要的是要注意，非 JS 浏览器并不一定意味着旧浏览器，而可能只是指设备上的 Web 浏览器，例如手机或其他我们还不知道的未来设备。

您应该确保使用像 XHTML 1.0 Strict 这样的 DOCTYPE。指定 DOCTYPE 将意味着 Visual Studio 生成特定且兼容的标记，并且 90% 满足创建“有效”代码的要求。您可以使用 W3C 验证器服务检查其他代码质量。

对于内容的可访问性，您应该考虑：

*   我使用的配色方案是否足够对比度（对于视力不佳的用户）
*   我是否在页面中使用清晰且结构良好的文本（针对盲人用户）
*   利用 CSS 和 HTML 之间的分离，并确保如果 CSS 被禁用，则页面以合理的方式呈现（至少看起来屏幕阅读器可以理解它）。
*   使用 W3C 验证器确保代码有效

希望有帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-29T10:11:10.240

这似乎没有一个直接的答案，因为在英国没有很多判例法。无论如何，这里有一个资源：

[http://www.rnib.org.uk/xpedio/groups/public/documents/PublicWebsite/public_legalcase.hcsp](http://www.rnib.org.uk/xpedio/groups/public/documents/PublicWebsite/public_legalcase.hcsp)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-29T10:12:03.590

为了履行合同，我想知道客户是否不应该对此提出意见——所谓的“要求”？

W3C: [Web Accessibility Initiative](http://www.w3.org/WAI/) (WAI) 可能有一些有趣的观点 - 特别是来自[Introduction to Web Accessibility的所有链接](http://www.w3.org/WAI/intro/accessibility.php)

有关检查的工具，请参阅[Web 可访问性评估工具的完整列表](http://www.w3.org/WAI/ER/tools/complete)。

只要您遵循 jQuery 的预期*ehnance*方法，它就应该与不可访问一样可访问

作为旁白; 您可能会发现 ASP.NET MVC 使您可以更好地控制 html，因此更有能力满足任何要求。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-29T10:33:27.190

你应该看看[**残疾歧视法案**](http://www.direct.gov.uk/en/DisabledPeople/RightsAndObligations/DisabilityRights/DG_4001068)(DDA)。

# utilities - 通用实用程序库或多个特定 dll？

> ID：801715
> 
> 赞同：2
> 
> 时间：2009-04-29T10:08:17.063
> 
> 标签：utilities, dll

将多个项目共享的“实用程序”类转储到单个实用程序库中，还是创建许多小程序集，每个程序集都必须由使用它们的项目加载，这是一个更好的主意吗？

我不太喜欢实用程序库的想法，你会得到一个完全混搭的功能，但另一方面，拥有 20 个 dll，每个 dll 都包含一个功能，这似乎也不是一个很好的解决方案。

有第三种方法吗？

编辑：这是使用.net

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T10:13:21.230

我倾向于将实用程序放入一个（或几个）更大的程序集中，但使用命名空间来获得它们之间的清晰结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T08:04:32.383

取决于您希望如何将您的工作分发给您的开发人员。这还取决于您以后是否要重用某些类。而且——如果你有一个在整个应用程序中单点使用的实用程序类——这不再是实用程序类……</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T08:16:07.180

我会选择一个带有名称空间的程序集。

当包含在许多项目中时，请注意实用程序库中的内容。否则你会遇到这样的[事情](http://ayende.com/Blog/archive/2009/04/29/let-us-burn-all-those-pesky-util-amp-common-libraries.aspx)。

# objective-c - 异步套接字 VS NSstream

> ID：801724
> 
> 赞同：2
> 
> 时间：2009-04-29T10:12:05.633
> 
> 标签：objective-c, iphone, cocoa, sockets

我必须创建一个连接到套接字服务器的示例代码，然后才能通过套接字发送多个 NSString。

在乞讨中，我开始使用 NSStream 对象，但是我在重用套接字时遇到了问题（如果 nsstream 解决方案是最好的，我可能会发布另一个问题），当我使用谷歌套接字进行 iPhone 编程时，我找到了[cocoaAsyncSocket](http://code.google.com/p/cocoaasyncsocket/)谷歌代码项目。

那么最好的是什么？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T14:48:52.410

cocoaAsyncSocket 是用于与远程套接字通信的优秀工具包。它建立在 CFSocket 之上，将为您处理大多数常见情况。一般来说，这是我针对此类问题推荐的工具包。

# nhibernate - NHibernate 多对一关系仅删除父级

> ID：801730
> 
> 赞同：1
> 
> 时间：2009-04-29T10:13:32.433
> 
> 标签：nhibernate, nhibernate-mapping, many-to-one

我在对象`Product`和`Supplier`. 我需要能够在`Supplier`不删除`Product`属于它的 s 的情况下删除。

这是类的简化版本：

```
public class Supplier {
    public virtual IList<Product> Products { get; protected set; }
}

public class Product {
    // Product belongs to a Category but Supplier is optional
    public virtual Supplier Supplier { get; set; }
    public virtual Category Category { get; set; }
} 
```

我正在使用 FluentNHibernate，但这里是它产生的映射：

```
<bag name="Products" cascade="save-update" inverse="true">
      <key column="SupplierID" />
      <one-to-many class="Me.Product, Me, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
</bag>

<many-to-one name="Supplier" column="SupplierID" /> 
```

这会在 Products 表上创建一个外键，因此当我尝试对供应商进行直接删除时，我会收到外键约束错误。我尝试将级联更改为“全部”，希望它可能只删除关系，但它删除了所有产品及其其他关联对象。

我现在能看到解决这个问题的唯一方法是迭代供应商的产品集合并将供应商属性设置为空。有没有办法通过映射实现这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T10:44:24.650

映射属性仅在实体实际加载时生效，并且在您不通过 HQL 查询时生效。例如，如果您指定`Cascade=ALL`，如果您使用 query 删除供应商`"delete from Supplier where id=:id"`，您可能会遇到相同的 FK 约束失败，因为 hql 不会触发（程序化）级联。

似乎产品是关系的拥有方，这很好。我认为你有两个选择：

*   在供应商上编写一些方法来遍历所有产品并将产品的供应商设置为空，并在删除任何供应商之前使用此方法
*   在发出供应商删除之前，请确保您的 DAO 将产品的供应商设置为 null

例子：

```
public int Delete(Supplier s) {
    return Session.CreateQuery("udpate Product set Supplier = null where Supplier = :supplier")
        .SetParameter("supplier", s)
        .ExecuteUpdate();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T11:16:47.180

**不要这样做。**

您的模型中有一个隐含或明确的断言，即所有产品都有一个供应商。外键用于强制执行此条件。在保留产品的同时删除供应商违反了您的模型，并且可能会导致您的大部分代码（依赖于始终正确）失败。

您可以做的一件事，您已经发现：对于具有此供应商的每个产品，您可以将产品的供应商设置为空。这不会违反你的条件，但相当于说“我们不知道这个产品的供应商是谁”，可能会导致代码失败。

你为什么要这样做？

# sql-server - 迁移数据库：保持关系约束？

> ID：801732
> 
> 赞同：-1
> 
> 时间：2009-04-29T10:15:52.177
> 
> 标签：sql-server, constraints

我想知道您对在 MS SQL DB 中维护关系约束有何想法。

我正在将系统从 ASP 迁移到 .NET 环境中。这带来了业务对象和其他分层编码技术，这些技术可以从用户/API 中抽象出数据库。新应用程序在实体框架 DAL 之上有一个明确的 API。

旧数据库中的应用程序数据库很大，一些表的用途将更改为开始包含二进制数据、文件等形式。我热衷于将这些数据拆分为单独的数据库以简化管理磁盘空间非常宝贵的客户站点。

保留表之间的关系约束有什么价值吗？

假设：

*   代码经过测试
*   在关系很重要的情况下，执行在事务下执行
*   只能通过 API 访问数据库，不支持第三方的其他访问。

保持约束的原因：

*   强制数据结构
*   JOIN 更快？
*   查询计划协助？

在新的 .NET 版本中删除约束的原因：

*   可以假设 API/BIZ 逻辑将管理诸如父/子之类的关系。
*   减少将 DB 部分划分到其他目录的机会（系统使用插件架构构建，大多数表可能独立运行）
*   我是否正确地认为 SQL 必须在 INSERT 期间对约束进行额外检查，而当数据库上方的 API 管理它时，这可能是不必要的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T10:27:26.457

是的，我建议保留关系约束。当然，您必须在 BLL 中处理它们，但约束也提高了性能，因为查询计划器使用它们来更有效地处理查询。

另请参阅此问题：[数据库设计中是否真的需要外键？](https://stackoverflow.com/questions/18717/are-foreign-keys-really-necessary-in-a-database-design)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T11:04:57.643

是的，除非您有特定的理由不这样做，否则您应该对表进行外键约束。即使您的应用程序经过测试，它也可能不是唯一写入数据库的内容。FK 对来自所有来源的数据强制执行参照完整性。

外键还充当数据库中关系的一种非正式文档工具。如果数据库中存在 FK，我可以使用 Visio（或任何其他支持逆向工程的工具）对架构进行逆向工程并查看关系。以性能的名义在数据库中删除外键是 ISV 用来混淆其数据库架构并带来更多支持收入的常用技术。

如果您可以将特定的、与性能相关的问题追溯到外键，则可能需要删除该键。这只可能发生在一个或两个特定的大容量表上的少量键上。它也只有在交易量非常大的系统上才有可能是必需的。根本没有理由在数据库上没有外键。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T10:53:03.400

我不支持约束“自动索引”的断言。只有唯一键和主键可以。外键没有，但在大多数情况下，我建议在“子”上设置一个与 FK 列匹配的索引。尽管如此，我仍然会推荐 FKeys，因为它们

1.  将强制执行您的数据完整性（我已经被 BL 咬了太多次了，因为它有错误并且未能完成这项工作）。
2.  为优化器提供有关数据模式的更多信息，这反过来可能会导致更好更快的执行计划。

但最重要的是，您是否考虑过将数据保存在单个数据库中，但将其分成多个文件组？您可以实现更灵活的磁盘空间管理目标，而无需跨越多个数据库的外键的麻烦

# axapta - Dynamics AX：如何从采购订单打开附加到采购申请的 docuview 文档？

> ID：801735
> 
> 赞同：1
> 
> 时间：2009-04-29T10:17:36.417
> 
> 标签：axapta, x++, dynamics-ax-2009

编辑：目标是使附加到采购***申请***的报价文件可供直接处理采购***订单***的员工以一种简单的方式使用，而无需导航回申请文件本身。

我想`DocuRef::openDocHandling`在采购订单屏幕中使用该方法，而不复制链接到采购申请的文档。我想通过添加到采购订单屏幕的按钮来执行此操作；我知道与采购订单相关联的申请编号是什么。

提前谢谢了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T07:58:39.780

在表单 PurchTable 中添加一个带有（活动）采购申请的数据源 VendPurchOrderJour。您不必显示数据源的任何字段，因此您可以使用 OnlyFetchActive 属性。然后创建表单方法“docCursor”，告诉DocuView表单哪条记录是活动的。

```
public Common docCursor()
{
    return reqDoc ? vendPurchOrderJour : purchTable;
} 
```

使用“单击”方法创建按钮：

```
void clicked()
{
    reqDoc = true;
    if (!infolog.docu().isDocuViewSet())
        infolog.docu().note(element);
    else
        infolog.docu().setActive();
} 
```

清除 PurchTable 的“active”方法中的“reqDoc”。

此解决方案不允许采购行上的文档，您可能必须像这样扩展解决方案（行是一个表单组）：

```
public Common docCursor()
{
    return reqDoc ? vendPurchOrderJour : 
                    line.contains(element.selectedControl()) ? purchLine :
                    purchTable;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T13:51:24.053

如果您想要一个按钮在未打开时打开文档视图并在打开时激活，那么您单击的方法应如下所示：

```
void clicked()
{
    if (!infolog.docu().isDocuViewSet())
        infolog.docu().note(element);
    else
        infolog.docu().setActive();
} 
```

你的问题不清楚你的目标。你想要什么？请展开。

# asp.net-mvc - 为什么 AntiForgeryToken 默认不包含在每个表单中？

> ID：801737
> 
> 赞同：4
> 
> 时间：2009-04-29T10:19:02.763
> 
> 标签：asp.net-mvc, security, csrf

我很感兴趣，为什么默认情况下每个 ASP.NET MVC 表单中都没有包含[AntiForgeryToken ？](http://msdn.microsoft.com/en-us/library/system.web.mvc.htmlhelper.antiforgerytoken.aspx)似乎总是包含它的好处超过了可能的缺点。[如果需要 Web 表单HttpRequestValidationException](http://msdn.microsoft.com/en-us/library/system.web.httprequestvalidationexception.aspx)，可以禁用此行为。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T10:47:06.393

我认为是因为您不想将它放在带有`GET`方法的表单上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T10:44:34.527

AntiForgeryToken 在 2 月份才从“MVC Futures”转移到“MVC Core”——因此很可能是时机阻止了它成为内置夹具。

另一个可能的原因是，开发 MVC 框架的团队真的把所有的权力都交给了开发人员。您可以使用其他东西代替 AntiForgeryToken，就像您可以选择使用不同的测试框架、数据框架等一样。当您从历史上看 MS 时，这是一种新方法，他们会让您使用他们提供的东西。

# c - C如何将二叉树“绘制”到控制台

> ID：801740
> 
> 赞同：76
> 
> 时间：2009-04-29T10:19:32.357
> 
> 标签：c, algorithm, layout, binary-tree

在控制台中可以使用哪些算法来绘制二叉树？该树是用 C 实现的。例如，带有数字的 BST：2 3 4 5 8 将在控制台中显示为：

![替代文字](https://i.stack.imgur.com/8a1M8.jpg)

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-04-29T10:42:05.703

查看[在 Ascii 中打印二叉树](http://web.archive.org/web/20090617110918/http://www.openasthra.com/c-tidbits/printing-binary-trees-in-ascii/)

来自下面的@AnyOneElse Pastbin：

```
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!Code originally from /http://www.openasthra.com/c-tidbits/printing-binary-trees-in-ascii/
!!! Just saved it, cause the website is down.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Printing Binary Trees in Ascii

Here we are not going to discuss what binary trees are (please refer this, if you are looking for binary search trees), or their operations but printing them in ascii.

The below routine prints tree in ascii for a given Tree representation which contains list of nodes, and node structure is this

    struct Tree 
    {
      Tree * left, * right;
      int element;
    };

This pic illustrates what the below routine does on canvas..
ascii tree

Here is the printing routine..

    b5855d39a6b8a2735ddcaa04a404c125001 

Auxiliary routines..

    //This function prints the given level of the given tree, assuming
    //that the node has the given x cordinate.
    void print_level(asciinode *node, int x, int level) 
    {
      int i, isleft;
      if (node == NULL) return;
      isleft = (node->parent_dir == -1);
      if (level == 0) 
      {
        for (i=0; i<(x-print_next-((node->lablen-isleft)/2)); i++) 
        {
          printf(" ");
        }
        print_next += i;
        printf("%s", node->label);
        print_next += node->lablen;
      } 
      else if (node->edge_length >= level) 
      {
        if (node->left != NULL) 
        {
          for (i=0; i<(x-print_next-(level)); i++) 
          {
            printf(" ");
          }
          print_next += i;
          printf("/");
          print_next++;
        }
        if (node->right != NULL) 
        {
          for (i=0; i<(x-print_next+(level)); i++) 
          {
            printf(" ");
          }
          print_next += i;
          printf("\\");
          print_next++;
        }
      } 
      else 
      {
        print_level(node->left, 
                    x-node->edge_length-1, 
                    level-node->edge_length-1);
        print_level(node->right, 
                    x+node->edge_length+1, 
                    level-node->edge_length-1);
      }
    }

    //This function fills in the edge_length and 
    //height fields of the specified tree
    void compute_edge_lengths(asciinode *node) 
    {
      int h, hmin, i, delta;
      if (node == NULL) return;
      compute_edge_lengths(node->left);
      compute_edge_lengths(node->right);

      /* first fill in the edge_length of node */
      if (node->right == NULL && node->left == NULL) 
      {
        node->edge_length = 0;
      } 
      else 
      {
        if (node->left != NULL) 
        {
          for (i=0; i<node->left->height && i < MAX_HEIGHT; i++) 
          {
            rprofile[i] = -INFINITY;
          }
          compute_rprofile(node->left, 0, 0);
          hmin = node->left->height;
        } 
        else 
        {
          hmin = 0;
        }
        if (node->right != NULL) 
        {
          for (i=0; i<node->right->height && i < MAX_HEIGHT; i++) 
          {
            lprofile[i] = INFINITY;
          }
          compute_lprofile(node->right, 0, 0);
          hmin = MIN(node->right->height, hmin);
        } 
        else 
        {
          hmin = 0;
        }
        delta = 4;
        for (i=0; i<hmin; i++) 
        {
          delta = MAX(delta, gap + 1 + rprofile[i] - lprofile[i]);
        }

        //If the node has two children of height 1, then we allow the
        //two leaves to be within 1, instead of 2 
        if (((node->left != NULL && node->left->height == 1) ||
              (node->right != NULL && node->right->height == 1))&&delta>4) 
        {
          delta--;
        }

        node->edge_length = ((delta+1)/2) - 1;
      }

      //now fill in the height of node
      h = 1;
      if (node->left != NULL) 
      {
        h = MAX(node->left->height + node->edge_length + 1, h);
      }
      if (node->right != NULL) 
      {
        h = MAX(node->right->height + node->edge_length + 1, h);
      }
      node->height = h;
    }

    asciinode * build_ascii_tree_recursive(Tree * t) 
    {
      asciinode * node;

      if (t == NULL) return NULL;

      node = malloc(sizeof(asciinode));
      node->left = build_ascii_tree_recursive(t->left);
      node->right = build_ascii_tree_recursive(t->right);

      if (node->left != NULL) 
      {
        node->left->parent_dir = -1;
      }

      if (node->right != NULL) 
      {
        node->right->parent_dir = 1;
      }

      sprintf(node->label, "%d", t->element);
      node->lablen = strlen(node->label);

      return node;
    }

    //Copy the tree into the ascii node structre
    asciinode * build_ascii_tree(Tree * t) 
    {
      asciinode *node;
      if (t == NULL) return NULL;
      node = build_ascii_tree_recursive(t);
      node->parent_dir = 0;
      return node;
    }

    //Free all the nodes of the given tree
    void free_ascii_tree(asciinode *node) 
    {
      if (node == NULL) return;
      free_ascii_tree(node->left);
      free_ascii_tree(node->right);
      free(node);
    }

    //The following function fills in the lprofile array for the given tree.
    //It assumes that the center of the label of the root of this tree
    //is located at a position (x,y).  It assumes that the edge_length
    //fields have been computed for this tree.
    void compute_lprofile(asciinode *node, int x, int y) 
    {
      int i, isleft;
      if (node == NULL) return;
      isleft = (node->parent_dir == -1);
      lprofile[y] = MIN(lprofile[y], x-((node->lablen-isleft)/2));
      if (node->left != NULL) 
      {
        for (i=1; i <= node->edge_length && y+i < MAX_HEIGHT; i++) 
        {
          lprofile[y+i] = MIN(lprofile[y+i], x-i);
        }
      }
      compute_lprofile(node->left, x-node->edge_length-1, y+node->edge_length+1);
      compute_lprofile(node->right, x+node->edge_length+1, y+node->edge_length+1);
    }

    void compute_rprofile(asciinode *node, int x, int y) 
    {
      int i, notleft;
      if (node == NULL) return;
      notleft = (node->parent_dir != -1);
      rprofile[y] = MAX(rprofile[y], x+((node->lablen-notleft)/2));
      if (node->right != NULL) 
      {
        for (i=1; i <= node->edge_length && y+i < MAX_HEIGHT; i++) 
        {
          rprofile[y+i] = MAX(rprofile[y+i], x+i);
        }
      }
      compute_rprofile(node->left, x-node->edge_length-1, y+node->edge_length+1);
      compute_rprofile(node->right, x+node->edge_length+1, y+node->edge_length+1);
    }

Here is the asciii tree structure…

    struct asciinode_struct
    {
      asciinode * left, * right;

      //length of the edge from this node to its children
      int edge_length; 

      int height;      

      int lablen;

      //-1=I am left, 0=I am root, 1=right   
      int parent_dir;   

      //max supported unit32 in dec, 10 digits max
      char label[11];  
    }; 
```

输出：

```
 2
       / \
      /   \
     /     \
    1       3
   / \     / \
  0   7   9   1
 /   / \     / \
2   1   0   8   8
       /
      7 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2012-12-07T02:11:58.913

代码：

```
int _print_t(tnode *tree, int is_left, int offset, int depth, char s[20][255])
{
    char b[20];
    int width = 5;

    if (!tree) return 0;

    sprintf(b, "(%03d)", tree->val);

    int left  = _print_t(tree->left,  1, offset,                depth + 1, s);
    int right = _print_t(tree->right, 0, offset + left + width, depth + 1, s);

#ifdef COMPACT
    for (int i = 0; i < width; i++)
        s[depth][offset + left + i] = b[i];

    if (depth && is_left) {

        for (int i = 0; i < width + right; i++)
            s[depth - 1][offset + left + width/2 + i] = '-';

        s[depth - 1][offset + left + width/2] = '.';

    } else if (depth && !is_left) {

        for (int i = 0; i < left + width; i++)
            s[depth - 1][offset - width/2 + i] = '-';

        s[depth - 1][offset + left + width/2] = '.';
    }
#else
    for (int i = 0; i < width; i++)
        s[2 * depth][offset + left + i] = b[i];

    if (depth && is_left) {

        for (int i = 0; i < width + right; i++)
            s[2 * depth - 1][offset + left + width/2 + i] = '-';

        s[2 * depth - 1][offset + left + width/2] = '+';
        s[2 * depth - 1][offset + left + width + right + width/2] = '+';

    } else if (depth && !is_left) {

        for (int i = 0; i < left + width; i++)
            s[2 * depth - 1][offset - width/2 + i] = '-';

        s[2 * depth - 1][offset + left + width/2] = '+';
        s[2 * depth - 1][offset - width/2 - 1] = '+';
    }
#endif

    return left + width + right;
}

void print_t(tnode *tree)
{
    char s[20][255];
    for (int i = 0; i < 20; i++)
        sprintf(s[i], "%80s", " ");

    _print_t(tree, 0, 0, 0, s);

    for (int i = 0; i < 20; i++)
        printf("%s\n", s[i]);
} 
```

输出：

```
 .----------------------(006)-------.                 
                      .--(001)-------.                   .--(008)--.            
                 .--(-02)       .--(003)-------.       (007)     (009)          
       .-------(-06)          (002)       .--(005)                              
  .--(-08)--.                           (004)                                   
(-09)     (-07) 
```

或者

```
 (006)                         
                           +------------------------+---------+                 
                         (001)                              (008)               
                      +----+---------+                   +----+----+            
                    (-02)          (003)               (007)     (009)          
                 +----+         +----+---------+                                
               (-06)          (002)          (005)                              
       +---------+                        +----+                                
     (-08)                              (004)                                   
  +----+----+                                                                   
(-09)     (-07) 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-04-29T10:41:22.537

一些提示：相同深度的节点之间的间距（例如，您的示例中的 2 和 4 或 3 和 8）是深度的函数。

每个打印行由具有相同深度的所有节点组成，从最左边的节点打印到最右边的节点。

因此，您需要一种方法，例如，根据节点的深度，按照最左边的顺序将节点排列在行数组中。

从根节点开始，*广度优先搜索*将按照深度和最左边的顺序访问节点。

节点之间的间距可以通过找到树的最大高度来找到，对最深的节点使用一些恒定的宽度，并且对于每个较小的深度将该宽度加倍，这样任何深度的宽度 = ( 1 + maxdepth - currentdepth ) * deepestwidth .

该数字为您提供了每个节点在任何特定深度处的打印“水平宽度”。

左节点水平*定位*在其父节点宽度的左半部分，右节点位于右半部分。您将为任何没有父节点的节点插入虚拟垫片；一个更简单的方法是确保所有叶子与最深节点的深度相同，其值为*空白。*显然，您还必须补偿值的宽度，也许通过使最大深度的宽度至少与最大值节点的打印（可能是十进制表示）一样宽。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-12-07T01:55:35.783

这是在数组中实现树时的另一种做法：

```
#include <stdio.h>
#include <math.h>

#define PARENT(i) ((i-1) / 2)
#define NUM_NODES 15
#define LINE_WIDTH 70

int main() {
    int tree[NUM_NODES]={0,1,2,3,4,5,6,7,8,9,1,2,3,4,5};
    int print_pos[NUM_NODES];
    int i, j, k, pos, x=1, level=0;

    print_pos[0] = 0;
    for(i=0,j=1; i<NUM_NODES; i++,j++) {
        pos = print_pos[PARENT(i)] + (i%2?-1:1)*(LINE_WIDTH/(pow(2,level+1))+1);

        for (k=0; k<pos-x; k++) printf("%c",i==0||i%2?' ':'-');
        printf("%d",tree[i]);

        print_pos[i] = x = pos+1;
        if (j==pow(2,level)) {
            printf("\n");
            level++;
            x = 1;
            j = 0;
        }
    }
    return 0;
} 
```

输出：

```
 0
                  1-----------------------------------2
          3-----------------4                 5-----------------6
      7---------8       9---------1       2---------3       4---------5 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-12-18T10:08:23.513

我在 c++ 中有这个小解决方案 - 它可以很容易地转换为 c。

我的解决方案确实需要一个补充数据结构来存储当前节点在树中的深度（这是因为如果您正在使用不完整的树，则给定子树的深度可能与它在完整树中的深度不一致。）

```
#include <iostream>
#include <utility>
#include <algorithm>
#include <list>

namespace tree {

template<typename T>
struct node
{
  T data;
  node* l;
  node* r;
  node(T&& data_ = T()) : data(std::move(data_)), l(0), r(0) {}
};

template<typename T>
int max_depth(node<T>* n)
{
  if (!n) return 0;
  return 1 + std::max(max_depth(n->l), max_depth(n->r));
}

template<typename T>
void prt(node<T>* n)
{
  struct node_depth
  {
    node<T>* n;
    int lvl;
    node_depth(node<T>* n_, int lvl_) : n(n_), lvl(lvl_) {}
  };

  int depth = max_depth(n);

  char buf[1024];
  int last_lvl = 0;
  int offset = (1 << depth) - 1;

  // using a queue means we perform a breadth first iteration through the tree
  std::list<node_depth> q;

  q.push_back(node_depth(n, last_lvl));
  while (q.size())
  {
    const node_depth& nd = *q.begin();

    // moving to a new level in the tree, output a new line and calculate new offset
    if (last_lvl != nd.lvl)
    {
      std::cout << "\n";

      last_lvl = nd.lvl;
      offset = (1 << (depth - nd.lvl)) - 1;
    }

    // output <offset><data><offset>
    if (nd.n)
      sprintf(buf, " %*s%d%*s", offset, " ", nd.n->data, offset, " ");
    else
      sprintf(buf, " %*s", offset << 1, " ");
    std::cout << buf;

    if (nd.n)
    {
      q.push_back(node_depth(nd.n->l, last_lvl + 1));
      q.push_back(node_depth(nd.n->r, last_lvl + 1));
    }

    q.pop_front();
  }
  std::cout << "\n";
}

}

int main()
{
  typedef tree::node<int> node;
  node* head = new node();
  head->l    = new node(1);
  head->r    = new node(2);
  head->l->l = new node(3);
  head->l->r = new node(4);
  head->r->l = new node(5);
  head->r->r = new node(6);

  tree::prt(head);

  return 0;
} 
```

它打印出以下内容：

```
 0                                                                                                
    1       2                                                                                            
  3   4   5   6 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-29T10:59:42.493

查看 Linux 中 pstree 命令的输出。它不会以您想要的确切形式产生输出，但恕我直言，这种方式更具可读性。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-29T14:29:40.117

我赞同 litb 的建议。我最近不得不这样做来打印 Windows 进程的 VAD 树，并且我使用了 DOT 语言（只需从二叉树遍历函数中打印出节点）：

[http://en.wikipedia.org/wiki/DOT_language](http://en.wikipedia.org/wiki/DOT_language)

例如，您的 DOT 文件将包含：

```
有向图名称 {
     5 -> 3;
     5 -> 8;
     3 -> 4;
     3 -> 2;
}

```

您可以使用 dotty.exe 生成图形或使用 dot.exe 将其转换为 PNG。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-09-07T04:36:57.097

一个非常简单的 C++ 解决方案在水平方向打印树：

```
5
  1
    5
  9
    7
    14 
```

代码（`Node::print()`功能很重要）：

```
#include<iostream>

using namespace std;

class Tree;

class Node{
public:
    Node(int val): _val(val){}
    int val(){ return _val; }
    void add(Node *temp)
    {
        if (temp->val() > _val)
        {
            if (_rchild)
                _rchild->add(temp);
            else
            {
                _rchild = temp;
            }
        }
        else
        {
            if (_lchild)
                _lchild->add(temp);
            else
            {
                _lchild = temp;
            }
        }
    }
    void print()
    {
        for (int ix = 0; ix < _level; ++ix) cout << ' ';
        cout << _val << endl;
        ++_level;
        if (_lchild)
        {
            _lchild->print();
            --_level;
        }
        if (_rchild)
        {
            _rchild->print();
            --_level;
        }
    }
private:
    int _val;
    Node *_lchild;      
    Node *_rchild;
    static int _level;      
};

int Node::_level = 0;       

class Tree{
public:
    Tree(): _root(0){}  
    void add(int val)
    {
        Node *temp = new Node(val);
        if (!_root)
            _root = temp;
        else
            _root->add(temp);       
    }
    void print()
    {
        if (!_root)
            return;
        _root->print();             
    }
private:
    Node *_root;    
};

int main()
{
    Tree tree;
    tree.add(5);
    tree.add(9);
    tree.add(1);
    tree.add(7);
    tree.add(5);
    tree.add(14);
    tree.print();
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-29T10:39:20.890

我认为您不应该自己编写代码，而是看一下[Tree::Visualize](http://search.cpan.org/dist/Tree-Visualize/lib/Tree/Visualize.pm)，它似乎是一个不错的 Perl 实现，具有不同的可能样式并在那里使用/移植其中一种算法。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-04-11T00:41:37.127

我有一个 Ruby 程序，它计算应该在此处绘制二叉树中每个节点的坐标：http: [//hectorcorrea.com/Blog/Drawing-a-Binary-Tree-in-Ruby](http://hectorcorrea.com/Blog/Drawing-a-Binary-Tree-in-Ruby)

这段代码使用一个非常基本的算法来计算坐标，它不是“区域有效的”，但它是一个好的开始。如果您想“实时”查看代码，可以在此处对其进行测试：http: [//binarytree.heroku.com/](http://binarytree.heroku.com/)

# asp.net - TinyMCE 将我的文本包装在 . 我可以避免这种情况吗？

> ID：801744
> 
> 赞同：7
> 
> 时间：2009-04-29T10:21:13.520
> 
> 标签：asp.net, javascript, tinymce

我[`http://tinymce.moxiecode.com/`](http://tinymce.moxiecode.com/)在 .NET 页面中使用 TinyMCE ( )。每当我加载文本

```
myTMCE.value=mycontent; 
```

我可以看到我的文本被包裹在`<p></p>`. 这对我来说是不可取的，所以我试图避免它。尝试初始化

```
 <script>
            tinyMCE.init({
                force_p_newlines: true
            })

        </script> 
```

不工作。任何的想法？在此先感谢，米。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-01-08T10:42:31.960

你需要这样做：

```
<script>
    tinyMCE.init({
        forced_root_block: false,
        //some other options here
    })
</script> 
```

默认情况下 TinyMCE 设置为根块。通过将此属性设置为 false，您可以删除文本的任何包装。以下文本来自 TinyMCE 文档：

> 此选项使您可以确保任何非块元素或文本节点都包含在块元素中。例如 **，某些东西**会产生如下输出：
> 
> **某物**
> 
> 从 3.0a1 开始默认启用此选项。

如果您将此选项设置为 false，它将永远不会在输入时生成 P 标记，或者会自动生成 BR 元素，而 Shift+Enter 将生成 P。

请注意，不使用 P 元素作为根块会严重削弱编辑器的功能。

[http://www.tinymce.com/wiki.php/Configuration:forced_root_block](http://www.tinymce.com/wiki.php/Configuration:forced_root_block)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T10:33:32.463

请参阅[此线程](http://tinymce.moxiecode.com/punbb/viewtopic.php?id=3720 "这个线程")和TinyMCE 论坛中[的答案](http://tinymce.moxiecode.com/punbb/viewtopic.php?pid=16296#p16296 "答案")。force_p_newline 是壁虎唯一的选项（即 FF）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T10:32:58.470

您可以在使用 .NET 之后去除 <p> 标记，或者，如果这适合您尝试做的事情，则只需使用普通的 <textarea> 字段进行数据输入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T10:35:08.357

TinyMCE 为文本添加了一大堆标签——它的设计目标是从任意输入（包括 html 输入）创建有效的 html。如果您想控制生成的 html 代码，最好使用另一个编辑器。

# linq - 链接到 xml

> ID：801747
> 
> 赞同：1
> 
> 时间：2009-04-29T10:22:15.407
> 
> 标签：linq, linq-to-xml

想在xml下面查询

```
 <courseList filedUnder="Courses">
  <category code="4wd" title="4wd Operation">
    <product code="lr" title="4wd Bush Driving">
        <duration>1 Day</duration> 
    </product>
    <product code="hr" title="4wd Defensive Driving">
        <duration>1 Day</duration> 
    </product>
    <product code="sr" title="Self-Recovery">
        <duration>1 Day</duration> 
    </product>
  </category>
 </courseList> 
```

现在我正在做以下事情：

```
 var list = (from x in xd.Descendants("product").Attributes("title")  
      select new { Title= x.Value}).ToList(); 
```

它只返回：标题值

我想要的是在同一个查询中也返回 Duration 值。

这怎么可能实现。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T10:27:50.777

当前，您正在选择*attributes*而不是*elements*。要包括持续时间，您将需要整个元素。

```
var list = xd.Descendants("product")
             .Select(element => new 
                 { Title = element.Attribute("title").Value,
                   Duration = element.Element("duration").Value })
             .ToList(); 
```

（请注意，这不会进行任何类型的错误检查 - 最好有一个标题属性和一个持续时间元素......）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T10:29:24.283

```
var list = (from x in xd.Descendants("product")
             select new { 
                Title= x.Attribute("title") != null ? x.Attributes("title").Value : "",
                Duration = x.Element("duration") != null ? x.Element("duration").Value : ""
             }
           ).ToList(); 
```

# c# - LINQ 中的不相交联合

> ID：801757
> 
> 赞同：22
> 
> 时间：2009-04-29T10:28:14.957
> 
> 标签：c#, .net, linq, disjoint-union

我有两组（IList），我需要第一个列表中的所有项目，其中项目不在第二个列表中。

谁能指出我用 LINQ 语句实现这一目标的最佳方法？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-29T10:30:52.813

方法如何[`Except`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.except.aspx)：

```
var firstMinusSecond = first.Except(second); 
```

# apache-flex - 没有得到鼠标退出事件

> ID：801760
> 
> 赞同：0
> 
> 时间：2009-04-29T10:30:09.803
> 
> 标签：apache-flex, button, events, mouseout, event-handling

我在 flex 中有这段代码，我在其中注册了鼠标移出事件侦听器 -

```
... 
var b:Button = new Button(); 
b.addEventListener(MouseEvent.MOUSE_OUT, buttonOutHandler);
... 
private function buttonOutHandler(evt:MouseEvent):void { 
 ... 
} 
```

我面临的问题是，有时当我将鼠标移出按钮的显示对象时，我没有收到鼠标移出事件。

主要是当我将它快速移出按钮区域时。我做错什么了吗？有关如何实现此功能的任何建议，以免我错过活动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T13:54:12.527

您可以尝试安装 MouseOut 的 rollOut 事件。非常相似，但又不同。如果您添加侦听器的任何内容都有自己的孩子，那么您应该明确地使用 rollOut 事件。

# java - Char Array vs String：哪个更适合存储一组字母

> ID：801768
> 
> 赞同：8
> 
> 时间：2009-04-29T10:33:32.977
> 
> 标签：java, performance, coding-style, constants

我需要存储一个代码的常量类 4 字母。我可以：

```
static final String CODE_LETTERS = "TRWAG"; 
```

或者

```
static final char[] CODE_LETTERS = {'T', 'R', 'W', 'A', 'G'}; 
```

之后，我可以通过两种方式获得其中一个字符：

```
final char codeLetter = CODE_LETTERS.charAt(index); 
```

或者

```
final char codeLetter = CODE_LETTERS[index]; 
```

什么是最好的方法？。请注意修正、性能等。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-29T10:40:56.173

两者都不正确，但是由于您要单独处理`char`s 我会亲自使用`char []`. 也就是说，即使可以衡量，这对性能的影响也将是微不足道的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-29T10:48:48.243

在这种情况下，性能无关紧要。如果它真的应该是恒定的，你就不能使用这种`char[]`方法。考虑：

```
public class Test
{
  static final char[] CODE_LETTERS = {'T', 'R', 'W', 'A', 'G'};

  public static void main(String[] args) throws Exception
  {
    System.out.println(CODE_LETTERS[0]); // T
    CODE_LETTERS[0] = 'x';
    System.out.println(CODE_LETTERS[0]); // x
  }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-29T10:36:30.897

除非您要连续数百万次获取角色，否则您无需担心性能。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-06T19:32:34.683

字符串是不可变的，char[] 不是。如果您将其定义为类中的公共“常量”，则 String 是真正的常量。

例如，如果你有这个：

```
public class MyClass { 
    public static final char[] CODE_LETTERS = {'h', 'e', 'l', 'l', 'o'};
    ....
} 
```

我可以偷偷摸摸地这样做：

```
MyClass.CODE_LETTERS[0] = 'Q'; 
```

Bam，我改变了你的“常数”的值。

关键字只影响对数组的`final`引用，它不适用于数组元素。我一直看到类似的错误`Collections.unmodifiableList()`，人们认为它保护了他们的列表，但客户端代码仍然可以访问和修改列表元素。

因此，要回答您的问题，请使用字符串。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-29T10:41:56.123

这几乎可以肯定是过早的优化。如果您需要将其提供给其他方法，则通过使用字符数组在性能上节省的任何内容都可能会丢失可读性，因为接受 a`String`而不是 a更规范`char[]`。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-29T10:56:48.553

的含义`String`确实匹配一组`char`. 因此`char[]`，作为一个实现，虽然没有设置含义，但不会添加`String`. OTOH，您可能会在`String`. 另一方面，[java.util.Arrays](http://java.sun.com/javase/6/docs/api/java/util/Arrays.html)也有一些有用的方法，例如 [binarySearch][2]。

也许你想要做的是为一组引入一个抽象，`char`它可能会在使用`String`最简单的可能工作、线性扫描a `char[]`（如果你不扫描很远）、二进制搜索、位集之间改变实现。稀疏位集、散列、泛洪过滤等。

[2]: [http://java.sun.com/javase/6/docs/api/java/util/Arrays.html#binarySearch(char[]](http://java.sun.com/javase/6/docs/api/java/util/Arrays.html#binarySearch(char[]) , int, int, char)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-29T10:42:40.570

由于字符串使用 char[] 来保存您的字母，因此真正的答案是 char[] 更快。如有疑问，请查看源代码，String 中没有魔法，它只是像任何其他类一样使用 int 和 char[] 之类的原语。

你真的不应该关心这种微不足道的事情。在程序中发生了更多的事情，担心单个字符串是否比使用 char 数组更快。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-29T11:14:32.520

您将看到字符串和字符数组之间的性能差异的唯一一次是在探查器下，然后只是因为探查器会做错事。一旦 JVM 确定这足够热以进行优化，现代 JVMS (JDK 6+) 将为这两个访问生成相同的代码。

不过要回答你的问题；如果您使用的是 Java 5，请使用枚举，如果您使用的是 Java5 之前的版本，请使用[Java 枚举模式](http://www.javacamp.org/designPattern/enum.html)。

它将使您的代码更具可读性，因为您不需要在某处跟踪偏移量，您只需使用枚举即可。此外，它*会*更快，因为您将能够执行以下操作：

```
 final char codeLetter = enum.getCodeLetter(); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-29T15:12:30.250

看起来您应该考虑使用**enum**。请参阅[枚举类型](http://java.sun.com/docs/books/tutorial/java/javaOO/enum.html)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-04-25T16:56:59.787

Funny, I just wrote a [blog entry](http://www.garretwilson.com/blog/2011/04/24/java-characters-class.xhtml) about this yesterday. You need a specialized class wrapped around the char[]. My [Characters](https://svn.globalmentor.com/java/trunk/globalmentor-core/src/main/java/com/globalmentor/java/Characters.java) class is a lightweight way to keep an immutable set of characters, and provides highly efficient methods for things like searching. It's open source.

# macros - nmake - 模拟 eval 函数

> ID：801778
> 
> 赞同：1
> 
> 时间：2009-04-29T10:36:56.697
> 
> 标签：macros, nested, eval, nmake

我想在 b.mak makefile 中获取名为 $(MYVAR)_SOME_SUFFIX 的变量的值。相反，我得到“b.mak(2)：致命错误 U1001：语法错误：宏中的非法字符 '$'”

```
# ---- a.mak ----
all :
    set MYVAR=SOME_PREFIX
    nmake -f b.mak
#--- END ---

# ---- b.mak ----
all:
    @echo $($(MYVAR)_SOME_SUFFIX)
#--- END --- 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-11T18:53:50.440

[你可以用内联文件](http://msdn.microsoft.com/en-us/library/aa242511(VS.60).aspx)做你想做的事。

```
# ---- piotr1.mak ----

all :
nmake -nologo -f piotr2.mak MYVAR=BBB

#--- END ---

# ---- piotr2.mak ----

AAA_SETTING=17
BBB_SETTING=24

AVAR=$(MYVAR)_SETTING

all:
# create and invoke a temporary cmd file
    @<<myecho.cmd
@echo off
setlocal
REM insert nMAKE  macros into environment of the command
set AAA_SETTING=$(AAA_SETTING)
set BBB_SETTING=$(BBB_SETTING)
REM now echo the value of whichever env var is named by the
REM nmake macro, AVAR.
echo %$(AVAR)%
endlocal
<<

#--- END --- 
```

当我运行时，`nmake -f piotr1.mak`我得到期望值回显到控制台：24。

# haskell - 我应该使用 GHC Haskell 扩展吗？

> ID：801785
> 
> 赞同：78
> 
> 时间：2009-04-29T10:39:14.883
> 
> 标签：haskell, ghc

当我学习 Haskell 时，我发现现实生活中的代码中使用了很多[语言扩展。](http://haskell.org/ghc/docs/latest/html/users_guide/ghc-language-features.html)作为初学者，我应该学习使用它们，还是应该不惜一切代价避免它们？我看到它破坏了与 Haskell 98 的兼容性，并将代码限制为几乎只有 GHC。但是，如果我在 Hackage 上浏览软件包，我发现它们中的大多数无论如何都是 GHC 专用的。

那么，社区对使用语言扩展的态度是什么？

如果可以使用扩展，我如何区分我可以“安全”使用的扩展（那些可能成为下一个 Haskell 标准的一部分）和那些主要是“实验性”的？例如，我认为[-XDisambiguateRecordFields](http://haskell.org/ghc/docs/latest/html/users_guide/syntax-extns.html#disambiguate-fields)很好用，但将来可能会支持它吗？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-04-29T23:07:52.087

有一些 GHC 扩展非常好，没有它就无法生存。我最喜欢的是

*   多参数类型类
*   作用域类型变量
*   更高等级的类型
*   广义代数数据类型 (GADT)

其中最重要的是多参数类型类。

一些 GHC 扩展非常具有推测性和实验性，您可能需要谨慎使用。识别稳定且受信任的扩展的一个好方法是查看它是否计划包含在[Haskell Prime](http://hackage.haskell.org/trac/haskell-prime/)中，它有望成为 Haskell 98 的继任者。

我赞同 Don Stewart 的建议，即每个扩展都应使用`LANGUAGE`源文件中的编译指示进行标记。 *不要*使用命令行选项启用扩展。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-04-29T16:13:24.003

是的，酌情使用扩展。

但一定要*有意*启用它们——仅当您决定需要它们时。`{-# LANGUAGE Rank2Types #-}`通过（例如）在每个模块的基础上执行此操作。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-04-29T12:39:25.797

一般来说，人们确实大量使用 GHC 扩展，因为它们非常有用，而且 Haskell 98 已经很老了。一旦有了更新的标准，人们可能会更加努力地坚持下去。

[您可以在此处](http://hackage.haskell.org/trac/haskell-prime/wiki/Status)找到下一个标准的提案状态。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-05-02T18:31:34.283

这里的其他答案很好。我要补充一点，GHC 扩展并不像它们可能的那样容易受到未来攻击（*），因为 GHC 似乎是最流行的 Haskell 编译器，而且我认为这种情况不会很快改变。

(*) 与“面向未来”相反

# sas - 在 SAS 中删除表

> ID：801788
> 
> 赞同：15
> 
> 时间：2009-04-29T10:39:25.973
> 
> 标签：sas, proc-sql, drop-table

在 SAS 中删除表的最*有效方法是什么？*

我有一个程序循环和丢弃大量表，想知道PROC SQL之间是否存在性能差异；和过程数据集；一次删除一个表..

或者如果有另一种方式也许？？？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-29T14:24:25.277

如果外包给操作系统是合理的，那可能是最快的。否则，我的不科学观察似乎表明 drop table in`proc sql`是最快的。这让我感到惊讶，因为我预计`proc datasets`会是最快的。

在下面的代码中，我创建了 4000 个虚拟数据集，然后尝试使用不同的方法将它们全部删除。第一个是使用 sql，在我的系统上删除文件大约需要 11 秒。

接下来的两个都使用`proc datasets`. 首先为每个数据集创建一个删除语句，然后删除。第二个只是发出一个全面的 kill 命令来删除工作目录中的所有内容。（我曾期望这种技术是最快的）。两个 proc 数据集例程都报告了大约 20 秒来删除所有 4000 个文件。

```
%macro create;
proc printto log='null';run;
%do i=1 %to 4000;
data temp&i;
x=1;
y="dummy";
output;run;
%end;
proc printto;run;
%mend;

%macro delsql;
proc sql;
%do i=1 %to 4000;
drop table temp&i;
%end;
quit;
%mend;

%macro deldata1;
proc datasets library=work nolist;
   %do i=1 %to 4000;
   delete temp&i.;
   %end;
run;quit;
%mend;

%macro deldata2;
proc datasets library=work kill;
run;quit;
%mend;

option fullstimer;
%create;
%delsql;

%create;
%deldata1;

%create;
%deldata2; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-30T13:22:04.717

我试图摆弄操作系统删除方法。

不推荐使用 X 命令删除。它花了很**长时间**！

然后我尝试在数据步骤中使用系统命令：

```
%macro delos;
data _null_;
do i=1 to 9;
delcmd="rm -f "!!trim(left(pathname("WORK","L")))!!"/temp"!!trim(left(put(i,4.)))!!"*.sas7*";
rc=system(delcmd);
end;
run;
%mend; 
```

如您所见，我必须将删除操作拆分为 9 个单独的删除命令。原因是，我使用通配符“*”，而底层操作系统 (AIX) 将它们扩展为一个列表，然后它变得太大而无法处理......

该程序基本上为九个文件组“temp[1-9]*.sas7*”中的每一个构造一个删除命令并发出该命令。

使用 cmjohns answer 中的 create 宏函数创建 4000 个数据表，我可以使用这种方法在 5 秒内删除它们。

因此，正如我所料，直接删除操作系统是批量删除的最快方式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-29T18:23:28.870

我们在讨论表还是数据集？

表意味着数据库表。要快速摆脱这些，使用 proc SQL 传递工具将是最快的。特别是如果您可以连接到数据库一次并删除所有表，然后断开连接。

如果我们讨论 SAS 中的数据集，我认为 proc sql 和 proc 数据集都非常相似。从应用程序的角度来看，它们都通过相同的推论来创建删除文件的系统命令。我从 SAS 用户组或演示文稿中看到的所有测试都表明，使用一种方法而不是另一种方法是微不足道的，并且基于许多变量。

如果您必须拥有绝对最快的方法来删除数据集/表，您可能只需要对其进行测试。SAS 的每次安装和设置都不同，足以保证测试。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-12T07:44:50.147

就哪个更快而言，不包括非常大的数据，我敢打赌它们之间几乎没有区别。然而，在处理永久 SAS 数据集时，我更喜欢使用 PROC DATASETS 而不是 PROC SQL，只是因为我觉得使用 SAS 设计的方法而不是 SQL 实现更好地处理永久数据集

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-05-13T15:34:16.797

类似命名的临时表的简单解决方案：

如果所有表都以相同的前缀开头，例如 p1_table1 和 p1_table2，则以下代码将删除以 p1 开头的任何表

`proc datasets; delete p1: ; run;`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-12-08T11:31:06.670

proc delete 是另一种解决方案，尽管没有记录。

[http://www.sascommunity.org/wiki/PROC_Delete](http://www.sascommunity.org/wiki/PROC_Delete)

# c# - WPF 转换器：文化从何而来

> ID：801789
> 
> 赞同：9
> 
> 时间：2009-04-29T10:40:11.480
> 
> 标签：c#, .net, wpf, converter

我创建了一个 WPF 转换器类：

```
public class DoubleConverter : IValueConverter
{
    public object Convert(object value, Type TargetType, object parameter, CultureInfo culture)
    {
        //blah blah
    }
} 
```

我想知道谁设置了传递的文化参数。我希望它与当前的 Windows 设置相同，但似乎有所不同。

任何人？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-29T10:42:58.960

[此页面](http://serialseb.blogspot.com/2007/04/wpf-tips-1-have-all-your-dates-times.html)描述了 WPF 的一个错误（功能？），其中文化将始终为 en-US，除非您采取行动以另行指定以及如何修复它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-02-25T23:34:50.970

实际上，使用[该页面上](http://serialseb.blogspot.com/2007/04/wpf-tips-1-have-all-your-dates-times.html)描述的技术是一个坏主意——它没有考虑用户在控制面板中对其格式设置所做的任何自定义。

相反，只需完全忽略传递给转换器的文化参数；如果您需要将文化传递给其他东西，请使用 CultureInfo.CurrentCulture。（因为这是 Parse 和 ToString 的默认设置，所以您通常不需要传递它。）

# .net - 如何通过 WMI 获取 IIS 应用程序信息

> ID：801797
> 
> 赞同：4
> 
> 时间：2009-04-29T10:43:13.280
> 
> 标签：.net, windows, iis, wmi

如何使用 WMI 获取 IIS 应用程序（虚拟文件夹）的实际目录路径？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T11:52:53.753

使用[Scriptomatic V2](http://www.microsoft.com/downloads/details.aspx?familyid=09dfc342-648b-4119-b7eb-783b0f7d1178&displaylang=en)工具查看更多类似的示例：

```
出错时继续下一步常量 wbemFlagReturnImmediately = &h10
常量 wbemFlagForwardOnly = &h20

arrComputers = Array("*")
对于 arrComputers 中的每个 strComputer
   WScript.Echo
   WScript.Echo "==========================================
   WScript.Echo "计算机：" & strComputer
   WScript.Echo "==========================================

设置 objWMIService = GetObject("winmgmts:\" & strComputer & "\root\MicrosoftIISv2")
   设置 colItems = objWMIService.ExecQuery("SELECT * FROM IIsWebVirtualDir_IIsWebVirtualDir", "WQL", _
                                          wbemFlagReturnImmediately + wbemFlagForwardOnly)

对于 colItems 中的每个 objItem
      WScript.Echo "GroupComponent:" & objItem.GroupComponent
      WScript.Echo "PartComponent:" & objItem.PartComponent
      WScript.Echo
   下一个
下一个

```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-02-21T15:47:47.887

当然，它已经 3 岁了，但这是一个很好的小问题。如果解决方案必须使用 .NET 的规范包括 PowerShell，那么就可以解决问题。总有一天有人可能想知道：

```
$server = 'ServerName'
$query = "Select Path From IIsWebVirtualDirSetting WHERE Name = 'W3SVC/1/ROOT'"
Get-WmiObject -namespace "root/microsoftiisv2" -query $query -computername $server -authentication 6 
```

结果对象将包含一个名为“Path”的属性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-30T02:01:58.270

这是一个纯粹的 .Net 选项，它应该返回与 Isalamon 的答案相同的结果。

从我的[WmiMacros](https://github.com/ImaginaryDevelopment/FsInteractive/blob/master/WmiMacros.fs)

示例用法（替换`strComputer`）

```
Macros.WmiMacros.QueryWmiAdvanced  (Macros.WmiMacros.ScopeItem.Creation("\\\\strComputer\\root\\MicrosoftIISv2", true,true)) "SELECT * FROM IIsWebVirtualDir_IIsWebVirtualDir"
|> Seq.map (fun e-> e.Properties.["GroupComponent"].Value, e.Properties.["PartComponent"].Value) 
```

* * *

更详细的用法：

```
let webServerSettings = 
    Macros.WmiMacros.QueryWmiAdvanced  (Macros.WmiMacros.ScopeItem.Creation("\\\\strComputer\\root\\MicrosoftIISv2", true,true)) "SELECT Name,ServerComment FROM IIsWebServerSetting" 
    |> Seq.map (fun e -> e.Properties.["Name"].Value,e.Properties.["ServerComment"].Value)
let webVirtualDirs = 
    Macros.WmiMacros.QueryWmiAdvanced  (Macros.WmiMacros.ScopeItem.Creation("\\\\strComputer\\root\\MicrosoftIISv2", true,true)) "SELECT AppRoot,Name FROM IIsWebVirtualDir"
    |> Seq.map (fun e -> e.Properties.["Name"].Value,e.Properties.["AppRoot"].Value)
let webVirtualDirSettings = 
    Macros.WmiMacros.QueryWmiAdvanced  (Macros.WmiMacros.ScopeItem.Creation("\\\\strComputer\\root\\MicrosoftIISv2", true,true)) "SELECT Name,Path,AppPoolId FROM IIsWebVirtualDirSetting"
    |> Seq.map (fun e -> e.Properties.["Name"].Value,e.Properties.["Path"].Value,e.Properties.["AppPoolId"].Value)
// webServerSettings.Dump("ss");
// webVirtualDirs.Dump("vd");
query { 
    for name,sc in webServerSettings do 
    join (vname,appRoot) in webVirtualDirs on ((name.ToString() + "/ROOT") = vname.ToString())
    join (sname,path,appPoolId) in webVirtualDirSettings on (name.ToString()+ "/ROOT" = sname.ToString() )
    select (appRoot,name,sc,path,appPoolId)
    } 
```

* * *

详细实现代码：

```
type ScopeItem = 
    | Scope of ManagementScope
    | Creation of string*bool*bool

let private createAdvancedScope (path:string) requiresDomainSecurity requiresPacketSecurity = 
    let scope = 
        if requiresDomainSecurity then  
            let conn = ConnectionOptions(Authority=sprintf "ntlmdomain:%s" Environment.UserDomainName)
            ManagementScope(path, conn)
        else 
        ManagementScope(path, null)
    if requiresPacketSecurity then scope.Options.Authentication <- AuthenticationLevel.PacketPrivacy
    scope.Connect()
    scope

let QueryWmiAdvanced (scopeInput: ScopeItem) query = 
        let scope = 
            match scopeInput with
            | Scope s -> s
            | Creation (path, requiresDomainSecurity, requiresPacketSecurity) -> createAdvancedScope path requiresDomainSecurity requiresPacketSecurity
            // createAdvancedScope path requiresDomainSecurity requiresPacketSecurity
        let query = new ObjectQuery(query)
        use searcher = new ManagementObjectSearcher(scope, query)
        use results = searcher.Get()
        results |> Seq.cast<ManagementObject>  |> Array.ofSeq 
```

# asp.net - 2147467259 7FFFBFFB（十六进制）错误

> ID：801803
> 
> 赞同：1
> 
> 时间：2009-04-29T10:46:27.830
> 
> 标签：asp.net, data-binding, compilation

当我尝试在我的 DataList 上运行 DataBind() 以增强连接到 .xsd 文件中 GetOfferPhotosAccPhotoTableAdapter 的 ObjectDataSource 时，我收到错误：（翻译）

> 类型 webpresence.App_Code.OfferDetailsTableAdapters .GetOfferPhotosAccPhotoTableAdapter 有多种含义，它可以来自程序集 C:\Users\Admin User\AppData\Local\Temp\Temporary ASP.NET Files\root\8c09cffe\c354bcf3\App_Code.hdvmwn8q.DLL 或来自F:\C_Sharp\C_Sharp_Projs\webpresence\webpresence\bin\webpresence.DLL 在类型名称中明确设置程序集。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T10:56:08.400

尝试做一个“干净的解决方案”，重建，然后再次运行。

如果失败，请重新启动 Visual Studio

如果失败，请手动清除该临时目录...

基本上你有一个未清理的引用 dll 导致编译器发疯，因为它在 2 个地方看到你的类/方法并且不知道要使用哪个，尽管我不知道你的主题的相关性是什么。

# oracle - Oracle Ref Cursor Vs Select into 异常处理

> ID：801805
> 
> 赞同：3
> 
> 时间：2009-04-29T10:47:12.400
> 
> 标签：oracle, plsql, cursor

我有几个场景：

1.  需要以预定义的顺序从三个不同的表中读取列的值，并且只有 1 个表会有数据

2.  如果记录存在给定条件的记录，则从表 1 读取数据，否则从表 2 中读取给定条件的数据

在 Oracle 存储过程中

现在处理这些的方法是首先将给定查询的计数放入变量中，如果计数 > 0，那么我们执行相同的查询以读取实际数据，如下所示：

```
select count(*) from table1 into v_count
if v_count > 0
then
    select data into v_data from table1
end if;

Return v_data 
```

这样做是为了避免 no_data_found 异常，否则我需要三个异常处理程序块来捕获每个表访问的 no_data_found 异常。

目前我正在用 Cursors 重新实现它，这样我就有了这样的东西：

```
cursor C1 is
    select data from table1;
Open C1
Fetch C1 into v_data
if C1%FOUND
then
    Close C1
    Return v_data
End If 
```

我想从性能的角度找出哪一个更好 - 一个带有游标，或者一个将 Select 放入变量并具有三个 no_data_found Exception 块的那个。我不想使用我们目前拥有的两阶段查询过程。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T13:24:32.443

我不知道您为什么如此热衷于避免异常？出什么问题了：

```
begin
    begin
        select data into v_data from table1;
    exception
        when no_data_found then
        begin
            select data into v_data from table2;
        exception
            when no_data_found then
            begin
               select data into v_data from table3;
            exception
                when no_data_found then
                    v_data := null;
            end;
        end;
    end;
    return v_data;
end; 
```

我相信这将比您的其他解决方案执行得更好，因为它做了尽可能少的工作来达到预期的结果。

请参阅[忽略 Oracle DUP_VAL_ON_INDEX 异常有多糟糕？](https://stackoverflow.com/questions/350860/how-bad-is-ignoring-oracle-dupvalonindex-exception)我证明了使用异常比计数来查看是否有任何数据表现得更好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T11:15:11.660

```
select count(*) from table1 into v_count
if v_count > 0 then
    select data into v_data from table1;
else
    v_data := null;
end if;
return v_data; 
```

不等于

```
begin
    select data into v_data from table1;
    return v_data;
exception
    when no_data_found then
        return null;
end; 
```

在多用户环境中。在第一种情况下，有人可以在您检查是否存在的点和您读取数据的点之间更新表。

性能方面，我不知道哪个更好，但我知道第一个选项对 sql 引擎进行两次上下文切换，而第二个选项只进行一次上下文切换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T12:45:33.270

您现在处理方案 1 的方式并不好。当一个就足够时，您不仅要执行两个查询，而且正如 Erik 指出的那样，它打开了在两个查询之间更改数据的可能性（除非您使用只读或可序列化事务）。

鉴于您说在这种情况下，数据将恰好位于三个表之一中，那么这个怎么样？

```
SELECT data
  INTO v_data FROM
  (SELECT data FROM table1
   UNION ALL
   SELECT data FROM table2
   UNION ALL
   SELECT data FROM table3
  ) 
```

您可以用来避免编写多个找不到数据的处理程序的另一个“技巧”是：

```
SELECT MIN(data) INTO v_data FROM table1;
IF v_data IS NOT NULL THEN
   return v_data;
END IF;

SELECT MIN(data) INTO v_data FROM table2;
...etc... 
```

但我真的没有看到比拥有三个异常处理程序更好的理由。

对于您的第二种情况，我认为您的意思是两个表中可能都有数据，并且您希望使用表 1 中的数据（如果存在），否则使用表 2 中的数据。同样，您可以在单个查询中执行此操作：

```
SELECT data
  INTO v_data FROM
  (SELECT data FROM
    (SELECT 1 sort_key, data FROM table1
     UNION ALL
     SELECT 2 sort_key, data FROM table2
    )
   ORDER BY sort_key ASC
  )
  WHERE ROWNUM = 1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-27T17:14:28.303

```
DECLARE
    A VARCHAR(35);
    B VARCHAR(35);
BEGIN
    WITH t AS
    (SELECT OM_MARCA, MAGAZIA FROM ifsapp.AKER_EFECTE_STOC WHERE (BARCODE = 1000000491009))
    SELECT
    (SELECT OM_MARCA FROM t) OM_MARCA,
    (SELECT MAGAZIA FROM t) MAGAZIA
    INTO A, B
    FROM DUAL;
    IF A IS NULL THEN
       dbms_output.put_line('A este null');
    END IF;
    dbms_output.put_line(A);
    dbms_output.put_line(B);
END;
/ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-10T07:45:40.807

“Dave Costa”的 MIN 选项的增强版...

```
SELECT COUNT(1), MIN(data) INTO v_rowcount, v_data FROM table2; 
```

现在`v_rowcount`可以检查值 0、>1（大于 1），其中正常的选择查询将抛出`NO_DATA_FOUND`或`TOO_MANY_ROWS`异常。值“1”将表明存在确切的一行并将服务于我们的目的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T12:00:48.820

使用循环的“for row in cursor”形式，如果没有数据，循环将不会处理：

```
declare cursor
t1Cur is
 select ... from table1;
t2Cur is
 select ... from table2;
t3Cur is
 select ... from table3;
t1Flag boolean FALSE;
t2Flag boolean FALSE;
t3Flag boolean FALSE;
begin
for t1Row in t1Cur loop
  ... processing, set t1Flag = TRUE
end loop;
for t2Row in t2Cur loop
  ... processing, set t2Flag = TRUE
end loop;
for t3Row in t3Cur loop
  ... processing, set t3Flag = TRUE
end loop;
... conditional processing based on flags
end; 
```

# .net - 期权表格如何运作？

> ID：801806
> 
> 赞同：0
> 
> 时间：2009-04-29T10:47:33.740
> 
> 标签：.net, winforms

winforms 选项系统是如何工作的？

我看过一篇通过 xml 序列化实现功能的文章。是否可以通过使用静态或常量变量的类来实现此功能？我不太记得了，但是即使应用程序关闭，consts/static 变量也会保持状态吗？

当然，我知道关键是在应用程序关闭时保持状态，为此，甚至可以使用数据库（矫枉过正）。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T10:50:28.287

查看 .Net 2.0 或更高版本中的应用程序设置[http://msdn.microsoft.com/en-us/library/aa730869(VS.80).aspx](http://msdn.microsoft.com/en-us/library/aa730869(VS.80).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T10:51:05.633

当应用程序关闭时，变量不会保持状态。您需要将要维护的值存储在某处，并在需要时将其读回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T12:05:55.347

因为当进程终止时，进程维护的状态被破坏，所以必须将必须在终止后幸存的任何数据持久保存到非易失性存储（如硬盘）中，序列化是实现此目的的一种方法。

序列化很受欢迎，因为它创建了一个抽象，允许应用程序保存和恢复数据，而不必关心如何存储或检索数据的细节。

虽然最终信息必须最终存储在非易失性存储中，但还有其他保留信息的方法具有不同的优点和缺点。

序列化的主要吸引力在于不需要关心存储的细节，因为这是由对持久化对象成员的反射决定的，但是这种反射也可以被视为相对于通常很大的性能的缺点反射类型所导致的打击，除此之外，将对象持久化为 XML 是很常见的，就资源使用而言，其解析可能非常密集。

序列化 API 支持不同的格式化程序，例如通常生成更小的文件的二进制格式化程序，尽管我不认为这个格式化程序的输出在 windows 版本中是一致的。

另一种存储选项是注册表 API，它通常比生成或解析 XML 更快，但是对于新应用程序来说，它的使用有点不鼓励

我希望这有点帮助，我不禁觉得我可能只是有点漫不经心

# c# - 这个加密的 QueryString 有什么问题 - Base-64 字符数组的长度无效

> ID：801808
> 
> 赞同：1
> 
> 时间：2009-04-29T10:48:13.393
> 
> 标签：c#, asp.net, base64, request.querystring

我正在加密文本并通过 QueryString 发送它。

```
"8ZnSq13yv2yYVDsehDnNUNp/yIFqsAQh4XNPbV1eLMpk/dMWpc/YnMMEBy29MlgcYqpV2XPOf/Rpiz5S85VN/fkLbGTCkL/clBHh983Cp s=" 
```

解密函数如下

```
public static string Decrypt(string stringToDecrypt)//Decrypt the content
{
    try
    {
        byte[] key = Convert2ByteArray(DESKey);
        byte[] IV = Convert2ByteArray(DESIV);
        int len = stringToDecrypt.Length;
        byte[] inputByteArray = Convert.FromBase64String(stringToDecrypt);

        DESCryptoServiceProvider des = new DESCryptoServiceProvider();
        MemoryStream ms = new MemoryStream(); 

        CryptoStream cs = new CryptoStream(ms, des.CreateDecryptor(key, IV), CryptoStreamMode.Write);
        cs.Write(inputByteArray, 0, inputByteArray.Length);

        cs.FlushFinalBlock();

        Encoding encoding = Encoding.UTF8; return encoding.GetString(ms.ToArray());
    }
    catch (System.Exception ex)
    {
        throw ex;
    }
} 
```

我应该怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T10:52:16.240

倒数第三个字符是空格。我猜它`+`在被放在查询字符串上之前是原始的。+ 是 URL 上代表空格的特殊字符，因此 QueryString 将其转换为您的空格。

尝试通过您的 Base64 字符串

```
Server.UrlEncode(string); 
```

在重定向之前 & 将正确地将 + 转义为 %urlchar 然后通过

```
Server.UrlDecode(string); 
```

在另一边解析之前

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T10:51:27.800

`p`我在和之间看到了一个空格`s`。这不是 base64 字符串中允许的字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T10:53:03.663

问题很可能是您的字符串包含在请求查询中具有特殊含义的字符。'/' 、 '=' 和 ' ' 例如。

您可以在发送之前对字符串进行编码，或者更好的是，将其添加到请求的表单正文中并以这种方式发送而不是查询字符串。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-29T10:54:39.400

对我来说看起来很短... Base64 字符串的长度应该可以被 4 整除，必要时用尾随 '=' 填充 - 你是否缺少尾随 '='，即它应该是“8ZnSq13yv2yYVDsehDnNUNp/yIFqsAQh4XNPbV1eLMpk/dMWpc/YnMMEBy29MlgcYqpV2XPOf/ Rpiz5S85VN/fkLbGTCkL/clBHh983Cps=="?

# asp.net - 如何在嵌套的用户控件中模拟回发？

> ID：801812
> 
> 赞同：1
> 
> 时间：2009-04-29T10:49:35.013
> 
> 标签：asp.net, user-controls, postback

我正在做一个带有一页的 asp.net 应用程序。在此页面中，我定义了一个用户控件。该用户控件也定义了一个菜单（三个按钮）和 3 个用户控件。根据单击的按钮，三个用户控件之一变为可见的真或假。

在这三个用户控件中，我有一个按钮和一个消息，我想在单击菜单按钮时显示消息“它不是回发”，当单击用户控件的按钮时，消息将是“是的，它是回传！！！”。

问题是使用用户控件或页面的属性“IsPostBack”，消息永远不会是“它不是回发”，因为单击菜单的按钮来显示嵌套的用户控件。

这是页面的结构：

```
page
  parent usercontrol
    menu
    nested usercontrol 1
      message
      button
    nested usercontrol 2
    nested usercontrol 3 
```

我知道可以使用 ViewState 来完成，但是有一种方法可以模拟 IsPostBack 属性或知道真正的用户控件回发时间是什么时候？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T14:58:02.607

我有这个问题的解决方案。当元素触发时，Request.Form 集合中的事件被发送到服务器，因此我在嵌套的用户控件中创建了一个属性，用于检查 Request.Form 集合中是否存在子控件（在用户控件本身中定义）：

```
public bool IsUserControlPostBack
    {
        get 
        { 
            foreach (Control c in Controls)
                foreach(string key in Page.Request.Form.AllKeys)
                    if( c.ClientID == key.Replace('$','_'))
                        return true;

            return false;
        }
    } 
```

此代码可以是用户控件的属性，或者，如果它被多次调用，则可以是在用户控件的 OnInit 事件上设置的变量。

# ruby - 在 Ruby 中获取 CGI 参数（query_string、path_info 等）

> ID：801814
> 
> 赞同：3
> 
> 时间：2009-04-29T10:50:42.857
> 
> 标签：ruby, cgi

我正在尝试从 Ruby 文件中获取 query_string。例如;

[http://localhost/rubyfile.rb?hello=world](http://localhost/rubyfile.rb?hello=world)

我希望能够问什么是你好并让它打印“世界”，但对于我的生活，我无法在任何地方找到正确的语法/方法。甚至 Ruby 文档也显得有些茫然。

```
#!/program files (x86)/ruby/bin/ruby

require 'cgi'
cgi_request = CGI::new("html4") 
```

这只是在文件运行时启动一个新的 CGI 生成，但我如何找到 query_string？

```
puts cgi.params[query_string] 
```

似乎不起作用-我认为我完全缺少某些东西并且我很愚蠢，但是...

它应该很简单，不是吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T11:00:18.403

以下应该有效：

```
require "cgi"
cgi_request = CGI::new("html4")

puts "Content-Type: text/html; charset=UTF-8"
puts
puts cgi_request['hello']
puts cgi_request.query_string
puts cgi_request.params['hello'] 
```

# asp.net - 如何将 mm/dd/yyyy 转换为 dd/mm/yyyy

> ID：801818
> 
> 赞同：0
> 
> 时间：2009-04-29T10:51:37.177
> 
> 标签：asp.net, vb.net

我有一个文本框，其中日期格式为 mm/dd/yyyy。我想用 vb 将它从 mm/dd/yyyy 转换为 dd/mm/yyyy 在 asp.net 到 DateTime 变量。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T10:58:05.897

```
DateTime.ParseExact("12/21/2008", "MM/dd/yyyy", CultureInfo.InvariantCulture).ToString("dd'/'MM'/'yyyy") 
```

更新：鉴于您希望最后有一个 DateTime ，您可以解析原始格式：

```
DateTime.ParseExact("12/21/2008", "MM/dd/yyyy", CultureInfo.InvariantCulture) 
```

日期格式仅在将日期显示为字符串时使用（在内部，日期没有格式；它只是一个数字）。如果要将其存储在 DateTime 中，则只需正确解释输入即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T11:04:10.767

如果你正在处理一个 DateTime 对象，你可以像这样转换：

```
yourDateTime.ToString("dd/MM/yyyy")) 
```

# c# - .NET RegExp 引擎搜索性能优化

> ID：801820
> 
> 赞同：2
> 
> 时间：2009-04-29T10:51:58.707
> 
> 标签：c#, .net, regex, performance, optimization

我有大约 35,000 个字符串的列表集合

典型的字符串如下所示：

```
"<i>füüs</i>ampri tähis;lüh ld-st<i>anno</i>, aastal;<i>maj</i> lüh pr-st<i>argent</i>, raha (kursisedelitel)" 
```

基本上这个字符串包含一堆爱沙尼亚语的单词:)

我需要允许用户对 35,000 个字符串执行 RegExp 搜索

如果我使用 /ab.*/ 表达式执行搜索，则搜索时间不到一秒

如果我使用 /.*ab/ 表达式执行搜索，则搜索大约需要 10 秒

我的问题是：如何使第二次搜索更快（少于 1.5 秒）？

非常感谢你

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T11:23:25.680

正则表达式的处理方式使它们的表现如此不同。根据您的示例进行解释：

*   **`/.*ab/`**   这个表达式由两个子表达式组成， the`.*`和 literal `ab`。这将被处理如下：在正常的贪婪模式下，每个量词因此匹配被扩展到它的最大值，`.*`将首先匹配整个字符串。然后它将尝试匹配以下内容`ab`。但由于不可能（我们已经在字符串的末尾）回溯将用于找到两个子表达式匹配的最后一个点。所以匹配的`.*`减少了一个字符，然后再次`ab`测试。如果无法匹配整个表达式，则`.*`再次匹配的将减少一个字符，直到匹配整个表达式。在最坏的情况下`ab`，字符串中没有，算法将执行*n*+1 回溯和额外测试，`ab`直到它可以确定匹配是不可能的。

*   **`/ab.*/`**   该表达式也包含两个子表达式。但是这里的顺序发生了变化，首先是文字`ab`，然后是`.*`. 处理如下：算法首先尝试`ab`通过比较一个字符与另一个字符来找到文字。如果有匹配，它会尝试找到一个匹配，因为`.*`这显然很容易。

这两个正则表达式之间的主要区别在于，第二个正则表达式的开头是静态部分，结尾是变量部分。这使得不需要回溯。

尝试一些正则表达式分析工具，例如[RegexBuddy](http://www.regexbuddy.com/)，以直观地查看差异。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T11:04:19.660

使用[编译的正则表达式](http://en.csharp-online.net/CSharp_Regular_Expression_Recipes%E2%80%94Compiling_Regular_Expressions)以获得更好的性能

[http://en.csharp-online.net/CSharp_Regular_Expression_Recipes](http://en.csharp-online.net/CSharp_Regular_Expression_Recipes) —Compiling_Regular_Expressions

复制粘贴完整的 url，看起来这个链接有渲染问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-22T22:52:45.333

对于慢速`.*ab`表达，我可以建议两种可能的修改。

我使用 Regex Hero 中的基准测试功能，使用这个测试字符串“1234567890 ab 1234567890”执行了我的测试。

**一个**。比原来快 5 倍

```
^.*ab
RegexOptions.None 
```

或者

**乙**。比原版快 8 倍

```
.*ab
RegexOptions.RightToLeft 
```

有时，实验是有回报的。选项是我的`RightToLeft`“啊哈！” 片刻。`ab.*`通过防止发生大规模回溯，这基本上可以返回与您的其他表达式相同的性能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T11:04:56.740

我有一个疯狂的想法，您也可以以相反的顺序存储字符串并使用 /ba 搜索这些字符串。`*`/ 如果用户输入 /。`*`ab/。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T11:16:52.203

您的第二个表达式将匹配 'ab' 和它之前的所有字符（新行除外）。您可以尝试仅搜索 /ab/，获取匹配项的索引，然后将匹配项之前的字符串部分连接到匹配项。

# asp.net-mvc - 在 ASP.NET MVC 中使用实体框架时出现问题

> ID：801821
> 
> 赞同：1
> 
> 时间：2009-04-29T10:52:10.873
> 
> 标签：asp.net-mvc, entity-framework

我使用实体框架在 ASP.NET MVC 中实现我的数据访问层。我在视图中遇到问题。

当我在 VIEW 中的代码类似于：

我在运行时遇到错误：

你调用的对象是空的。

说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详细信息：System.NullReferenceException：对象引用未设置为对象的实例。

源错误：

第 14 行：

第 15 行：<%= Model.FirstName %> 第 16 行：

第 17 行：

这是从强类型视图模板生成的。我确保将模型引用添加到 web.config 我在使用 LINQ to SQL 时没有遇到此错误

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T20:20:17.730

由于我无法对答案发表评论，因此我将通过新答案进行评论。我注意到您的属性称为“FirstName”，您是否有机会尝试做[本](http://www.asp.net/learn/mvc/tutorial-26-cs.aspx)教程？这是您遇到问题的编辑操作吗？

因为这是我和我的两个同学遇到的完全相同的问题。以下是对该问题的更详细说明：

这是控制器动作：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Contact contactToEdit) {
    if (!ModelState.IsValid)
        return View();

    try {
        var originalContact = (from c in base._entities.ContactSet
                               where c.Id == contactToEdit.Id
                               select c).First();
        base._entities.ApplyPropertyChanges(originalContact.EntityKey.EntitySetName, contactToEdit);
        base._entities.SaveChanges();

        return RedirectToAction("Index");
    } catch(Exception e) {
        return View();
    }
} 
```

调用 ApplyPropertyChanges 时会引发[异常](http://msdn.microsoft.com/en-us/library/)。(InvalidOperationException) 异常消息：

> {System.InvalidOperationException：ObjectStateManager 不包含引用“ContactManager.Models.Contact”类型对象的 ObjectStateEntry。
> 在 System.Data.Objects.ObjectContext.ApplyPropertyChanges(String entitySetName, Object changed)
> at ContactManager.Controllers.HomeController.Edit(Contact contactToEdit) 在 C:\Users\Jeroen\Desktop\ContactManager\ContactManager\ContactManager\Controllers\HomeController.cs ：第 65 行}

当我在 ApplyPropertyChanges 之前添加这一行时：

```
System.Data.Objects.ObjectStateEntry x = base._entities.ObjectStateManager.GetObjectStateEntry(originalContact); 
```

x 确实包含正确类型的条目。（[调试图像](https://imgur.com/2GvtF.png)）

注意：我与教程略有不同，并将实体对象放在超类中，因此我不必在所有控制器中声明相同的对象。但是在遵循教程时会出现同样的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-06T07:57:54.197

我想到了！问题出在 VIEW 通常情况下，使用 (Html.BeginForm(new { Id = Model.Id }))

如果您的数据库中的主键是 CategoryID，您会认为您应该修改代码以

Id = 型号.CategoryID

但是，实际上，你应该这样做，

使用 (Html.BeginForm(new { CategoryID = Model.CategoryID }))

否则，它不会填充模型。

重温，希望对你有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T11:06:14.303

看起来您的模型没有在控制器中正确填充。您的问题中没有足够的信息来确定到底出了什么问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-23T03:09:50.213

有时**Model**为 null，因为带有该方法的 select 语句`.FirstOrDefault()`没有带来有效的对象。

您可以随时更改`.FirstOrDefault()`并`.First()`重新编译您的解决方案。

# ruby-on-rails - 按指定顺序按 id 查找 ActiveRecord 对象的干净方法

> ID：801824
> 
> 赞同：29
> 
> 时间：2009-04-29T10:53:00.293
> 
> 标签：ruby-on-rails, sqlite, activerecord, find, rails-activerecord

我想获得一个给定 id 数组的 ActiveRecord 对象数组。

我以为

```
Object.find([5,2,3]) 
```

将返回一个包含对象 5、对象 2、然后是对象 3 的数组，但我得到的数组顺序为对象 2、对象 3 和对象 5。

ActiveRecord Base [find 方法 API](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#M002208)提到您不应该按提供的顺序期望它（其他文档没有给出此警告）。

一个潜在的解决方案是在[Find by ids array 中以相同的顺序给出的？](http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/158dc2d879b2fb1)，但 order 选项似乎对 SQLite 无效。

我可以编写一些 ruby​​ 代码来自己对对象进行排序（有点简单且缩放效果不佳或更好缩放且更复杂），但是有更好的方法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-30T07:41:30.013

并不是 MySQL 和其他数据库自己对事物进行排序，而是它们不对其进行排序。当您调用`Model.find([5, 2, 3])`时，生成的 SQL 类似于：

```
SELECT * FROM models WHERE models.id IN (5, 2, 3) 
```

这没有指定顺序，只是您想要返回的记录集。事实证明，通常 MySQL 会按`'id'`顺序返回数据库行，但不能保证这一点。

让数据库以有保证的顺序返回记录的唯一方法是添加一个 order 子句。如果您的记录将始终以特定顺序返回，那么您可以向数据库添加一个排序列并执行`Model.find([5, 2, 3], :order => 'sort_column')`. 如果不是这种情况，则必须在代码中进行排序：

```
ids = [5, 2, 3]
records = Model.find(ids)
sorted_records = ids.collect {|id| records.detect {|x| x.id == id}} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-09-13T19:19:19.397

根据我之前对 Jeroen van Dijk 的评论，您可以使用两行更有效地执行此操作`each_with_object`

```
result_hash = Model.find(ids).each_with_object({}) {|result,result_hash| result_hash[result.id] = result }
ids.map {|id| result_hash[id]} 
```

供参考这里是我使用的基准

```
ids = [5,3,1,4,11,13,10]
results = Model.find(ids)

Benchmark.measure do 
  100000.times do 
    result_hash = results.each_with_object({}) {|result,result_hash| result_hash[result.id] = result }
    ids.map {|id| result_hash[id]}
  end
end.real
#=>  4.45757484436035 seconds 
```

现在另一个

```
ids = [5,3,1,4,11,13,10]
results = Model.find(ids)
Benchmark.measure do 
  100000.times do 
    ids.collect {|id| results.detect {|result| result.id == id}}
  end
end.real
# => 6.10875988006592 
```

**更新**

您可以在大多数使用 order 和 case 语句中执行此操作，这是您可以使用的类方法。

```
def self.order_by_ids(ids)
  order_by = ["case"]
  ids.each_with_index.map do |id, index|
    order_by << "WHEN id='#{id}' THEN #{index}"
  end
  order_by << "end"
  order(order_by.join(" "))
end

#   User.where(:id => [3,2,1]).order_by_ids([3,2,1]).map(&:id) 
#   #=> [3,2,1] 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-29T16:13:19.853

显然 mySQL 和其他数据库管理系统会自行排序。我认为您可以绕过这样做：

```
ids = [5,2,3]
@things = Object.find( ids, :order => "field(id,#{ids.join(',')})" ) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-03-22T07:08:27.857

一个可移植的解决方案是在您的 ORDER BY 中使用 SQL CASE 语句。您可以在 ORDER BY 中使用几乎任何表达式，并且 CASE 可以用作内联查找表。例如，您需要的 SQL 如下所示：

```
select ...
order by
    case id
    when 5 then 0
    when 2 then 1
    when 3 then 2
    end 
```

这很容易用一点 Ruby 生成：

```
ids = [5, 2, 3]
order = 'case id ' + (0 .. ids.length).map { |i| "when #{ids[i]} then #{i}" }.join(' ') + ' end' 
```

以上假设您在 ; 中使用数字或其他一些安全值`ids`。如果不是这种情况，那么您需要使用[ActiveRecord SQL sanitizer 方法](http://api.rubyonrails.org/classes/ActiveRecord/Sanitization/ClassMethods.html#method-i-sanitize_sql)[`connection.quote`](http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/Quoting.html#method-i-quote)之一来正确引用您的.`ids`

然后使用`order`字符串作为您的订购条件：

```
Object.find(ids, :order => order) 
```

或在现代世界中：

```
Object.where(:id => ids).order(order) 
```

这有点冗长，但它应该适用于任何 SQL 数据库，并且隐藏丑陋并不难。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-03-13T18:30:41.160

正如我[在这里](https://stackoverflow.com/a/29039262/1103543)回答的那样，我刚刚发布了一个 gem ( [order_as_specified](https://github.com/panorama-ed/order_as_specified) )，它允许您像这样进行本机 SQL 排序：

```
Object.where(id: [5, 2, 3]).order_as_specified(id: [5, 2, 3]) 
```

刚刚经过测试，它可以在 SQLite 中运行。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-04-22T00:57:56.803

Justin Weiss就在两天前写了[一篇关于这个问题的博客文章。](http://www.justinweiss.com/blog/2015/04/20/how-to-select-database-records-in-an-arbitrary-order/)

告诉数据库首选顺序并直接从数据库加载按该顺序排序的所有记录似乎是一种好方法。[他的博客文章中](http://www.justinweiss.com/blog/2015/04/20/how-to-select-database-records-in-an-arbitrary-order/)的示例：

```
# in config/initializers/find_by_ordered_ids.rb
module FindByOrderedIdsActiveRecordExtension
  extend ActiveSupport::Concern
  module ClassMethods
    def find_ordered(ids)
      order_clause = "CASE id "
      ids.each_with_index do |id, index|
        order_clause << "WHEN #{id} THEN #{index} "
      end
      order_clause << "ELSE #{ids.length} END"
      where(id: ids).order(order_clause)
    end
  end
end

ActiveRecord::Base.include(FindByOrderedIdsActiveRecordExtension) 
```

这使您可以编写：

```
Object.find_ordered([2, 1, 3]) # => [2, 1, 3] 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-10-29T20:40:57.270

这是一种高性能（哈希查找，而不是检测中的 O(n) 数组搜索！）单线，作为一种方法：

```
def find_ordered(model, ids)
  model.find(ids).map{|o| [o.id, o]}.to_h.values_at(*ids)
end

# We get:
ids = [3, 3, 2, 1, 3]
Model.find(ids).map(:id)          == [1, 2, 3]
find_ordered(Model, ids).map(:id) == ids 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-08-24T11:00:35.157

在 Ruby 中执行此操作的另一种（可能更有效）方法：

```
ids = [5, 2, 3]
records_by_id = Model.find(ids).inject({}) do |result, record| 
  result[record.id] = record
  result
end
sorted_records = ids.map {|id| records_by_id[id] } 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-06-04T21:08:04.903

这是我能想到的最简单的事情：

```
ids = [200, 107, 247, 189]
results = ModelObject.find(ids).group_by(&:id)
sorted_results = ids.map {|id| results[id].first } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-29T16:44:37.423

```
@things = [5,2,3].map{|id| Object.find(id)} 
```

这可能是最简单的方法，假设您没有太多要查找的对象，因为它需要为每个 id 访问数据库。

# iphone - 为什么自实现的 getter 应该保留并自动释放返回的对象？

> ID：801828
> 
> 赞同：12
> 
> 时间：2009-04-29T10:54:08.280
> 
> 标签：iphone, cocoa-touch, memory-management, uikit

例子：

```
- (NSString*) title {
    return [[title retain] autorelease];
} 
```

二传手实际上已经保留了它，对吗？实际上没有人应该绕过 Setter ......所以我想知道为什么 getter 不只是返回对象？它实际上已经保留了。或者如果同时另一个对象被传递给setter，是否需要这样做？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-29T11:30:03.527

从这里[http://www.macosxguru.net/article.php?story=20030713184140267](http://www.macosxguru.net/article.php?story=20030713184140267)

```
- (id)getMyInstance
    {
        return myInstanceVar ;
    } 
```

或者

```
- (id)getMyInstance
{
    return [[myInstanceVar retain] autorelease] ;
} 
```

有什么不同 ？第二个允许调用者获取容器对象的实例变量，处置容器并继续使用实例变量直到当前自动释放池的下一次释放，而不会受到间接产生的实例变量释放的伤害通过释放其容器：

```
aLocalVar = [aContainer getAnInstanceVar] ;
[aContainer release];
doSomething(aLocalVar); 
```

如果“get”是以第一种形式实现的，你应该写：

```
aLocalVar = [[aContainer getAnInstanceVar] retain];
[aContainer release];
doSomething(aLocalVar);
[aLovalVar release]; 
```

第一种形式在代码执行速度方面效率更高一些。但是，如果您正在编写供他人使用的框架，也许应该推荐第二个版本：它使使用您的框架的人的生活更轻松：他们不必过多考虑自己在做什么……； ) 如果您选择第一个样式版本，请在文档中明确说明……无论您选择哪种方式，请记住，从版本 1 更改为版本 2 是为了保存客户端代码，当从版本 2 回到版本 1 时会破坏现有的客户端代码……</p>

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-29T20:32:49.247

这不仅适用于有人释放容器的情况，因为在这种情况下，他们应该自己保留对象更明显。考虑这段代码：

```
NSString* newValue = @"new";
NSString* oldValue = [foo someStringValue];
[foo setSomeStringValue:newValue];
// Go on to do something with oldValue 
```

这看起来很合理，但是如果 setter 和 getter 都没有使用 autorelease，那么“继续做某事”部分可能会崩溃，因为 oldValue 现在已被释放（假设没有其他人保留它）。您通常希望使用[Apple 的访问器方法示例](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/MemoryMgmt/Articles/mmAccessorMethods.html)中的技术 1 或技术 2，因此上述代码将按照大多数人的预期工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-05-18T04:34:29.083

比较这段代码

```
 return [[title retain] release]; // releases immediately 
```

有了这个

```
 return [[title retain] autorelease]; // releases at end of current run loop (or if autorelease pool is drained earlier) 
```

第二个保证客户端将有一个未释放的对象可以使用。

这在这样的情况下很有用（客户端代码）：

```
 NSString *thing = [obj title];
 [obj setTitle:nil]; // here you could hit retainCount 0!
 NSLog(@"Length %d", [thing length]); // here thing might be dealloced already! 
```

**您的方法中的保留（和使用的`autorelease`代替`release`）`title`可防止此代码爆炸。**`release`在当前调用堆栈执行完毕（当前运行循环结束）之前，自动释放的对象不会调用其方法。这使调用堆栈中的所有**客户端**代码都有机会使用此对象，而不必担心它会被释放。

**要记住的重要事项：**这不是 Java、Ruby 或 PHP。仅仅因为你在你的 [原文如此] 变量中有一个对象的引用并不能确保你不会从你下面得到它。你必须保留它，但**你必须记得释放它。**自动释放可以避免这种情况。您应该**始终**使用自动释放，除非您正在处理具有多次迭代的属性或循环（除非出现问题，否则可能甚至不会）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T19:13:59.187

我以前从未见过这种模式，但对我来说似乎毫无意义。如果客户端代码在父对象上调用“释放”，我想目的是保持返回值的安全。它并没有真正伤害任何东西，但我怀疑这种情况经常出现在精心设计的库中。

* * *

喔好吧。从 smorgan 链接到的文档来看，这似乎是苹果目前推荐人们使用的方法之一。我想我还是更喜欢老派的版本：

```
- (NSString *) value
{
    return myValue;
}

- (void) setValue: (NSString *) newValue
{
    if (newValue != myValue)
    {
       [myValue autorelease]; // actually, I nearly always use 'release' here
       myValue = [newValue retain];
    }
} 
```

# windows-mobile - Windows Mobile - 禁用电源按钮

> ID：801832
> 
> 赞同：1
> 
> 时间：2009-04-29T10:57:10.673
> 
> 标签：windows-mobile, windows-mobile-5.0

有没有人成功地捕获了 WM5 设备上的电源/待机按钮，这样您的代码甚至阻止了用户“关闭”屏幕？

我有一个以横向使用屏幕的应用程序，我想捕获电源键按下，以便（a）用户可以用双手握住设备而不会意外关闭屏幕电源和（作为奖励 - b) 将其用作 UI 按钮。

也许有人有低级黑客？我使用的是 iPaq RX1950(s) 上提供的 WM5。

请记住，**没有不可能的事情**——尤其是对于 WM5。如果我同时自己回答，我会更新问题。

* * *

## 更新！

我发现了三个有效的技巧，按可用性的相反顺序：

1.  修补 keybddr.dll（在此设备上），通过您喜欢的方式重新注入 ROM。在这个带有工厂 ROM 的设备上 - 它可以工作，但我不想永久禁用它。

2.  同步到电源管理消息队列并在设备出现故障时将其“打开”。

3.  更改注册表中的“电源状态”，使它们（大多数）都“打开”。这样，我可以使用 RAPI 禁用电源按钮，并让设备上的软件在事件 x、y 和 z 上“重置”注册表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T15:56:49.953

电源按钮的实现取决于 OEM，因此一台设备上的解决方案不太可能在另一台设备上运行。由于 Windows Mobile 设备中的实现差异很大，您会发现许多低级功能都是如此。

替代方案涉及事物的组合

*   在无人值守模式下运行您的应用程序
*   监控电源变化事件
*   当设备更改为无人值守模式时，请求完全开启模式

电源管理的完整讨论超出了我可以在这里讨论的范围。您可以在此处阅读更多信息：http: [//www.codeproject.com/KB/mobile/WiMoPower1.aspx](http://www.codeproject.com/KB/mobile/WiMoPower1.aspx)

还有一个示例显示如何在此处注册电源事件：http: [//www.codeproject.com/KB/mobile/WiMoQueue.aspx](http://www.codeproject.com/KB/mobile/WiMoQueue.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T14:53:04.127

以下代码不会禁用电源按钮，但如果设备关闭，它将在 10 秒内重新打开设备。它还将禁用任何省电功能。

```
using System;
using System.Runtime.InteropServices;
using System.Collections.Generic;
using System.Text;

namespace Core.Mobile
{
    /// <summary>
    /// Allows manipulation the power management i.e. system standby
    /// </summary>
    public static class PowerManipulation
    {
        #region Private variables
        private static System.Threading.Timer _timer = null;
        private const int INTERVAL = 10000; //10 seconds
        #endregion
        #region Public methods
        /// <summary>
        /// Prevents the application from suspending/sleeping
        /// </summary>
        public static void DisableSleep()
        {
            if (_timer == null)
            {
                _timer = new System.Threading.Timer(new System.Threading.TimerCallback(Timer_Tick), null, 0, INTERVAL);
            }
            try
            {
                PowerPolicyNotify(PPN_UNATTENDEDMODE, 1);  //Ensure the application still runs in suspend mode
            }
            catch { }
        }
        /// <summary>
        /// Allows suspend/sleep operations
        /// </summary>
        public static void EnableSleep()
        {
            if (_timer != null)
            {
                _timer.Dispose();
                _timer = null;
            }
            try
            {
                PowerPolicyNotify(PPN_UNATTENDEDMODE, 0);
            }
            catch { }
        }
        #endregion
        #region Private methods
        /// <summary>
        /// Internal timer for preventing standby
        /// </summary>
        private static void Timer_Tick(object state)
        {
            try
            {
                SystemIdleTimerReset();
                SetSystemPowerState(null, POWER_STATE_ON, POWER_FORCE);
            }
            catch { }
        }
        #endregion
        #region PInvoke
        private const int PPN_UNATTENDEDMODE = 0x00000003;
        private const int POWER_STATE_ON = 0x00010000;
        private const int POWER_STATE_OFF = 0x00020000;
        private const int POWER_STATE_SUSPEND = 0x00200000;
        private const int POWER_FORCE = 4096;
        private const int POWER_STATE_RESET = 0x00800000;
        /// <summary>
        /// This function resets a system timer that controls whether or not the
        /// device will automatically go into a suspended state.
        /// </summary>
        [DllImport("CoreDll.dll")]
        private static extern void SystemIdleTimerReset();
        /// <summary>
        /// This function resets a system timer that controls whether or not the
        /// device will automatically go into a suspended state.
        /// </summary>
        [DllImport("CoreDll.dll")]
        private static extern void SHIdleTimerReset();
        /// <summary>
        /// This function allows the current power state to be manipulated, i.e. turn the device on
        /// </summary>
        [DllImport("coredll.dll", SetLastError = true)]
        static extern int SetSystemPowerState(string psState, int StateFlags, int Options);
        /// <summary>
        /// This function sets any power notification options
        /// </summary>
        [DllImport("CoreDll.dll")]
        static extern bool PowerPolicyNotify(int dwMessage, int onOrOff);
        #endregion
    }
} 
```

# wpf - 在代码中加载 BitmapImage

> ID：801833
> 
> 赞同：4
> 
> 时间：2009-04-29T10:57:26.227
> 
> 标签：wpf, bitmapimage

从我的程序集（A）中，我想调用另一个程序集（B）中的一个方法，该方法传递一个图像。然后该图像显示在 WPF 窗口中 - 该窗口是 B 项目的一部分。

我似乎无法使用 pack:// uri 传递 ImageSource，因为这是在 B 的上下文中评估的，所以我想我需要在 A 中使用 CachedBitmap (?) 缓存图像。

```
 BitmapImage img = new BitmapImage(new Uri("Images/32px-Nuvola_apps_cache.png", UriKind.Relative));
        CachedBitmap cbmp = new CachedBitmap(img, BitmapCreateOptions.PreservePixelFormat, BitmapCacheOption.Default); 
```

如果我将图像设置为嵌入式资源并将其作为流加载，我已经设法让它工作，但这不是 WPF 方式。

从包装上看：我应该能够做到这一点的文档，但我在下面尝试了这些但没有任何工作；

"Images/32px-Nuvola_apps_cache.png": **"找不到部分路径"** "pack://application:,,,Images/32px-Nuvola_apps_cache.png": **"URI 前缀无法识别。"** . "pack://siteoforigin:,,,Images/32px-Nuvola_apps_cache.png": **"无法识别 URI 前缀。"**

我想要做的就是将一个 Resource .png 文件加载到内存中，然后将它批量传递给另一个程序集中的方法。

谢谢保罗。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-29T11:30:01.813

尝试：

```
pack://application:,,,/YourAssemblyName;component/Images/32px-Nuvola_apps_cache.png 
```

# java - 如何在不增加文件限制的情况下在 Java 中打开 20000 个客户端？

> ID：801838
> 
> 赞同：1
> 
> 时间：2009-04-29T10:59:11.653
> 
> 标签：java, linux, nio

每当我打开一个套接字通道时。如果客户端接受，则在内部创建 1 个文件描述符，因此我可以在 Linux 中创建最多 1024 个客户端。
但是我想在不增加 Linux 中文件描述符限制的情况下创建更多客户端（ulimit -n 20000） 那么如何在 Java 中创建更多套接字？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T11:23:53.073

如果您的会话限制为 1024 个文件描述符，那么您不能使用比单个 JVM 更多的文件描述符。

但是由于 ulimit 是每个进程的限制，您可能可以通过启动更多 JVM 来绕过它（即，要获得 2048 个连接，请启动两个 JVM，每个使用 1024）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T11:29:35.200

如果您使用的是 UDP，您可以自己在单个本地套接字上进行多路复用吗？您将能够通过源地址和端口分隔传入的数据包。

如果是 TCP，那么你就不走运了，关闭每个套接字后的[TIME_WAIT](http://www.google.com/search?q=time_wait)时间段会使事情变得更糟。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T13:39:57.583

限制 RLIMIT_NOFILE 由操作系统强制执行，并限制进程可以创建的最高 fd。一个 fd 用于打开的每个文件、管道和套接字。

有硬限制和软限制。任何进程（如您的 shell 或 jvm）都可以更改软值，但只有特权进程（如 root 用户运行的 shell）可以更改硬值。

a) 如果不允许您更改机器上的限制，请找可以更改的人。

b) 如果您由于某种原因懒得输入 ulimit，我想您可以使用 JNA 调用底层系统调用：[man setrlimit(2)](http://linux.die.net/man/2/setrlimit)。（.exec() 不会这样做，因为它是内置命令）

另请参阅[使用 Ulimit](http://certcities.com/editorial/columns/story.asp?EditorialsID=214)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-29T11:31:04.493

为什么不能增加 ulimit ？这似乎是一种人为的限制。java代码（afaik）无法让您访问系统以重置ulimit - 它需要在进程开始之前设置 - 在启动脚本或类似的东西中。

JBoss 启动脚本在启动 Jboss 之前执行“ulimit -n $MAX_FD”...

伦

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T15:34:12.613

我们最近提高了 ulimit，因为我们的 java 进程抛出了很多“打开的文件太多”异常。

现在是 65536，我们没有遇到任何问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T11:30:12.967

如果你真的想处理大量的连接，那么实现可扩展的最糟糕的方法是实现一个轻量级的数据服务器进程，它除了接受数据并将数据转发到父进程之外没有任何责任。

这样，当每个数据服务器饱和时，您只需生成一个新实例即可为自己提供另外 1024 个连接。如果需要，您甚至可以让它们存在于单独的机器上。

# git - 最近开始使用 git ......刚刚注意到我的文件的克隆最后附加了“〜”......为什么会发生这种情况

> ID：801840
> 
> 赞同：1
> 
> 时间：2009-04-29T10:59:53.040
> 
> 标签：git, commit, ignore

我使用 git 在我的存储库中提交更改，

遵循这些步骤

```
git add .
git commit -m "message" 
```

但注意到在存储库中也存在更改的文件的克隆新文件`~`在末尾附加了“”符号。

为什么会这样？以及将来如何防止它？
还有一些关于如何用“~”删除文件的想法会很棒

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-29T11:08:43.407

您的编辑器正在生成格式为 FILENAME~ 的备份文件。（Emacs 会这样做；否则可以说服它。）您没有要求 git 忽略以 ~ 结尾的文件。随着`git add .`您告诉 git 添加您没有要求它忽略的所有内容。

参见： [gitignore](http://git-scm.com/docs/gitignore)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-29T11:13:16.300

要完成[bendin的回答](https://stackoverflow.com/questions/801840/started-using-git-recently-just-noticed-clones-of-my-files-with-appende/801860#801860)，请在您的工作目录中添加一个`.gitignore`文件，例如：

```
*~
*.bak
*.old 
```

必须添加并提交该 .gitignore 文件才能通过 ' `git clone`' 持续存在，因为存在[多个级别的 'gitignore'](https://stackoverflow.com/questions/653454/how-do-you-make-git-ignore-files-without-using-gitignore/653495#653495)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T04:59:50.857

> 还有一些关于如何用“~”删除文件的想法会很棒

使用 gitignore 您可以忽略尚未跟踪的文件，但是如果您添加了一个文件，然后在您的 .gitignore 中匹配它，它仍然会在内容更改时标记为已更新。

因此，从未来的提交中删除它的方法是使用：

```
git rm *~ 
```

另一方面，如果您想从旧提交中删除临时文件，您应该查看[git filter-branch](http://git-scm.com/docs/git-filter-branch)。如果您已经发布了您的 repo，请小心，因为此命令会重写历史记录，因此请备份您的 repo 并注意如果您选择这种方式，您正在做什么。

# javascript - Javascript：我可以访问隐藏 iframe 中加载的文件的源吗

> ID：801843
> 
> 赞同：0
> 
> 时间：2009-04-29T11:00:42.477
> 
> 标签：javascript, iframe, visibility

我找到了将隐藏的 iframe 放入我的 html 并将 url 加载到其中的代码：

```
var i = document.createElement('iframe');
i.style.display = 'none';
i.onload = function() { i.parentNode.removeChild(i); };
i.src = 'http://www.google.com';
document.body.appendChild(i); 
```

我想问一下，我可以用javascript访问这个iframe中加载的google.com的源代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T11:27:38.743

如果 iframe 中的页面托管在与“父”页面相同的主机名上，您可以使用 JavaScript 从父页面访问子页面的 DOM。

如果子页面位于另一个主机名，JS 的安全功能将阻止这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T11:03:37.897

iframe 的安全功能将阻止您使用 JavaScript 访问 iframe 内的源代码。如果你想“屏幕刮”你应该做两件事......

1) 检查您是否可以使用正在抓取的数据。

2) 使用服务器端脚本来加载和解析页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-14T14:51:59.590

[http://www.dyn-web.com/tutorials/iframes/](http://www.dyn-web.com/tutorials/iframes/) - 试试这个它可以帮助 Joe AWungshi

# java - 流口水收集模式问题

> ID：801844
> 
> 赞同：0
> 
> 时间：2009-04-29T11:01:40.663
> 
> 标签：java, drools

我有这样的规则 LHS

```
when 
    $location : Location() 
    $cabinets : ArrayList() from collect ( Cabinet() from $location.elements() )
then 
```

当我在 RHS 中打印 @cabinets 的内容时，我看到它包含所有元素（还有那些不属于 Cabinet 类的元素）。

我只想从 $location>elements() 收集橱柜。

我做错了什么 ？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-04-29T11:24:14.650

您的问题是关于“来自”模式，而不是“收集”模式。

以下规则应该有助于测试：

```
when 
  $location : Location() 
  $cabinet : Cabinet() from $location.elements()
then 
```

这条规则应该针对所在位置的每个机柜触发。

您可以尝试在[规则用户用户列表中发布您的问题](https://lists.jboss.org/mailman/listinfo/rules-users)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-29T11:12:43.320

我想你会说一些类似的东西

```
Cabinet(class == Cabinet.class) 
```

我不认为 Drools 正在对 Cabinet 类进行显式类型检查，因为您有它们 afaik。

# c# - linq to xml (c# to vb.net 转换)

> ID：801845
> 
> 赞同：2
> 
> 时间：2009-04-29T11:02:16.573
> 
> 标签：c#, vb.net, .net-3.5, linq-to-xml, lambda

下面的 VB.net 语法是做什么用的？

```
 var list = xd.Descendants("product")
   .Select(element =>new 
   { 
      Title = element.Attribute("title").Value,                   
      Duration = element.Element("duration").Value 
   }).ToList(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T13:21:06.850

如果您使用的是 VB，则有一些语法糖：

```
Dim list = 
   From element In xd...<product>
   Select New With { _ 
       .Title = element.@title, _
       .Duration = element.<duration>.Value } 
```

好的部分是，如果您的文档有一个 xsd（并且您可以通过 Visual Studio 从一个或多个 xml 文档推断它来创建一个），您几乎可以像命名空间一样导入它，Visual Studio 会给您编写查询时的智能感知完成。

一些参考资料：

*   [LinqToXML 概述的 MSDN 页面](http://msdn.microsoft.com/en-us/library/bb384460.aspx)
*   [各种语法元素的 MSDN 参考页](http://msdn.microsoft.com/en-us/library/bb384974.aspx)
*   [XML 模式推理工具](http://msdn.microsoft.com/en-us/vbasic/bb840042.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T11:26:12.757

尝试这个：

```
Dim list = 
   From element In xd.Descendants("product")
   Select New With { _ 
       .Title = element.Attribute("title").Value, _
       .Duration = element.Element("duration").Value } 
```

您不需要使用 Linq 语法，只需使用底层扩展即可：

```
Dim list = xd.Descendants("product"). _
    Select(Function(element) _ 
        New With { _ 
           .Title = element.Attribute("title").Value, _
           .Duration = element.Element("duration").Value _
        }). _
    ToList() 
```

# solr - 获取 SolrQuery 完整的查询字符串

> ID：801847
> 
> 赞同：3
> 
> 时间：2009-04-29T11:03:20.847
> 
> 标签：solr

我在我的应用程序的 dao 层中使用 Solrj。我想知道的是我怎样才能得到

请求的完整查询字符串。

例如： `select?q=*:*&fq=active:true`

方法 SolrQuery.getQuery() 仅返回 q=XXX 部分（`*:*`在我的示例中）

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T01:01:23.280

我没有合适的环境来测试它，但`SolrQuery.toString()`应该让你足够接近。

# windows - 用于检查调试 XPath 查询的工具/实用程序

> ID：801858
> 
> 赞同：28
> 
> 时间：2009-04-29T11:07:34.517
> 
> 标签：windows, xpath

有没有人对用于创建/调试 Windows 的 XPath 查询的工具/实用程序有任何建议？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-29T11:09:42.797

[SketchPath](http://qutoric.com/sketchpath/)看起来可能会有所帮助（并且是免费的）

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-29T13:10:25.347

如果你有 Notepad++，有一个 XML 工具插件。该插件中的工具包括一个简单的 XPath 表达式求值器。Sketchpatch 更加完整（我已经尝试过了，它很好）但是如果你一直使用 Notepad++，那么了解这个插件是值得的。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-06-09T02:35:29.237

Notepad++ 有一个新插件：[XPatherizerNPP](http://code.google.com/p/xpatherizernpp/ "XpatherizerNPP")。它与 XML Tools 相比的最大优势是反向查找功能。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-04-13T21:19:17.540

Codeplex 上有几个不错的选择。

XPathVisualiser 在[http://xpathvisualizer.codeplex.com/](http://xpathvisualizer.codeplex.com/)

XMLExplorer 在[http://xmlexplorer.codeplex.com/](http://xmlexplorer.codeplex.com/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T16:43:08.453

Liquid XML Studio 带有一个[XPath 可视化器](http://www.liquid-technologies.com/XmlStudio/XPath-Expression-Builder.aspx)。独立版在社区版中是免费的。如果你想将它集成到 Visual Studio 中，那么你必须购买它。

它会在您键入时突出显示结果，并在 XPath 表达式上自动完成。

![替代文字](https://www.liquid-technologies.com/Images/ScreenShots/ScreenShot_XPath.png)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T11:10:01.923

我一直在使用[XmlSpy](http://www.altova.com/products/xmlspy/xmlspy.html)。

# .net - Excel Yield 函数的 .NET 实现

> ID：801859
> 
> 赞同：2
> 
> 时间：2009-04-29T11:08:34.563
> 
> 标签：.net, excel, .net-3.5, finance

Excel 的名为“Analysis ToolPak”的加载项提供了“收益”功能，用于计算支付​​定期利息的证券收益。

函数运行良好并返回正确的数据。

我的理解是基于某种迭代的函数，在我的代码中实现它并不容易。

我的问题是有人知道/看过 C#（最终是其他语言）的实现并且可以分享吗？或者（也许）一些提示如何实现它？比我可以分享:)

**编辑：**

感谢所有向我发布“公式”的人，但这对我来说并不完全有用。
请注意，MS 的公式仅适用于 1 种情况：
**“当有一个息票期或更少直到赎回时”，**

否则：

**“（...）产量是通过一百次迭代计算出来的。”**
并且没有针对这种情况的确切公式

我可以阅读方程式并实现它们（希望如此），但我的问题是是否有人已经或看到已经用编程语言实现了函数。

我不懒，但我不喜欢打破敞开的门......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T12:11:59.543

假设一个函数传递了公式所需的所有变量，如上所述

[http://office.microsoft.com/en-us/excel/HP052093451033.aspx](http://office.microsoft.com/en-us/excel/HP052093451033.aspx)

然后

```
return (((redemption/100 + rate/frequency) - ( par/100 + ( A/E * rate/frequency ))) / (par/100+( A/E * rate/frequency ))) * ((frequency*E)/DSR); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T11:35:52.377

整个公式在这里：

[http://office.microsoft.com/en-us/excel/HP052093451033.aspx](http://office.microsoft.com/en-us/excel/HP052093451033.aspx)

在 Google 上首次匹配“excel 产量”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-08T05:48:22.923

首先，您需要 PRICE 函数的实现。YIELD 然后使用*牛顿求解器求解*PRICE 函数以获得正确的收益率和给定的目标价格。价格函数的代码和牛顿求解器的代码可以在这个类似的帖子中找到：[java implementation of excel price,yield functions](https://stackoverflow.com/questions/9467318/java-implementation-of-excel-price-yield-functions/10057709#10057709)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T11:40:50.477

如果您不想浏览网页，这里是公式。

我试图发布图像，但我是新用户，它不允许我。

[图形显示公式](http://office.microsoft.com/global/images/default.aspx?AssetID=ZA060512691033)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-02T10:19:27.473

```
using Excel = Microsoft.Office.Interop.Excel; 

 Excel.Application xl = new Excel.Application();
        Excel.WorksheetFunction wsf = xl.WorksheetFunction;
        //static settlementDate
        var settlementDate = xl.Evaluate("=DATEVALUE(" + '"' + "9/4/2013" + '"' + ")");
        //static maturityDate
        var maturityDate = xl.Evaluate("=DATEVALUE("+ '"' +"12/5/2014"+ '"' +")");
        var rate = "0.05250";
        var priceLevel = "1.04800";
        //assuming that redemption is 100, frequency is Quarterly and basis is Actual/365
        var resultInPercentage = xl.Evaluate("=YIELD(" + settlementDate + "," +         maturityDate + ",.05250,(1.04800*100),100,2,3)") * 100; 
```

# visual-studio - 如何在 Visual Studio 编译期间自动激活错误列表窗口？

> ID：801867
> 
> 赞同：2
> 
> 时间：2009-04-29T11:11:46.973
> 
> 标签：visual-studio, visual-studio-2008, ide, automation

如何在 Visual Studio 编译期间自动激活错误列表窗口，而不是默认的输出窗口？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T11:54:09.727

选项/项目和解决方案/常规/始终显示错误列表...

如果需要，您还可以取消选中“构建开始时显示输出窗口”。

# security - 保持基于 apt 的发行版，作为 Web 服务器运行，保持最新

> ID：801871
> 
> 赞同：0
> 
> 时间：2009-04-29T11:12:49.560
> 
> 标签：security, debian-based

我正在配置运行 Debian 5.0 的生产 Web 服务器。如何使基于 apt 的发行版保持最新。有什么最佳实践或神奇的方法吗？通过 ssh 登录并`apt-get upgrade`手动运行似乎不合理。

**编辑：** 在评论中进行了一些讨论后，我现在决定手动升级服务器，但想知道如何及时了解要应用的软件包。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T11:32:52.507

自动更新您的服务器*可能会*出现问题；安装可能会失败，新软件包的行为可能略有不同（debian 非常擅长避免这种情况），或者情况可能已经改变，只有在软件包安装强制服务重启时才会变得明显，等等。所以我建议不要使用无人看管的软件包安装。

话虽如此，您可以查看[cron-apt](http://www.debuntu.org/how-to-email-notification-upon-available-package-updates-with-cron-apt)，您可以对其进行配置，或者提前下载软件包，并提醒您可用的更新，这样您所要做的就是登录并安装它们。

此外/或者，您可以订阅[debian-security-announce](http://lists.debian.org/debian-security-announce/)，它会发送新安全更新的通知。

# sharepoint - 使用新 ID 重定向的 Sharepoint 列表

> ID：801878
> 
> 赞同：5
> 
> 时间：2009-04-29T11:15:06.357
> 
> 标签：sharepoint, sharepoint-designer

我在 Sharepoint 中有一个列表，使用自定义新表单我添加了一个自定义列表表单控件（列表的“新项目表单”）并将 SaveButton 更改为标准输入 HTML 按钮，并添加了一个“onclick”事件如下：

```
onclick="javascript: {ddwrt:GenFireServerEvent('__commit;__redirect={NewFormWizard2.aspx?id=}')}" 
```

这就像保存数据并重定向到 NewFormWizard2.aspx?id= 页面一样。

如何获取要传递到重定向页面的已创建项目的 ID？

因此，一旦表单完成，它将重定向到 NewFormWizard2.aspx?id=23

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-03-19T19:16:25.980

jtherkel 很接近，但在重定向 URL 的末尾缺少一个“}”。我在下面使用了一个额外的 concat

```
<input type="button" value="Submit" name="btnSave" onclick="javascript: {ddwrt:GenFireServerEvent(concat('__commit;__redirect={lists/MyListName/DispForm.aspx?ID=',/dsQueryResponse/Rows/Row/@ID,'}'))}" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T22:08:24.243

我不确定该 ID 将存在于您托管 Javascript 的页面上的哪个位置。它是出现在查询字符串中还是出现在页面上的字段中？

请求或响应中没有任何内容可以识别该项目。我在做一些网络负载测试时遇到了这个问题。

我只能建议您使用 web 服务创建项目，因为它会为您提供一些返回 xml。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-11T10:30:28.970

[您可以使用 JavaScript http://www.sharepointdrive.com/blog/Lists/Posts/Post.aspx?ID=9](http://www.sharepointdrive.com/blog/Lists/Posts/Post.aspx?ID=9)来实现这一点

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-31T04:22:43.010

我希望这会有所帮助： 1- 在 SharePoint Designer 中创建新页面，例如将其命名为“LastItem.aspx”并在其上放置一个数据视图，其中包含目标列表项的单个表单视图。2-将分页限制为一条记录，设置按ID排序和降序并过滤列表以仅显示由[当前用户]创建的项目。3-现在您不需要将任何查询字符串传递到此页面。只需将列表的 NewForm.aspx 中的默认“确定”按钮替换为标准 HTML 输入按钮，并将其添加到其定义中“onclick="javascript: {ddwrt:GenFireServerEvent(concat('__commit;__redirect={LastItem.aspx} "。提交新项目到列表后，您将被重定向到已创建项目的编辑视图。您可以对 LastItem 中的保存按钮执行相同操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T16:33:03.903

此答案不能解决“新表单”问题，但它可能会帮助其他人使用包含现有列表项的屏幕的语法。

我在我的 SharePoint (MOSS 2007) 环境中对此进行了快速测试。

onclick="javascript: {ddwrt:GenFireServerEvent(concat('__commit;__redirect={NewFormWizard2.aspx?id=',/dsQueryResponse/Rows/Row/@ID))}"

concat 语法是一条 XSLT 指令，它告诉处理器将单引号括起来的值组合起来。我根据我在这里找到的信息改编了这个答案。

在自定义列表表单中加载值 [http://wssdevelopment.blogspot.com/2007_04_01_archive.html](http://wssdevelopment.blogspot.com/2007_04_01_archive.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-25T10:34:40.777

找到了一种使用纯 javascript (JQuery) 和来自[http://darrenjohnstone.net/](http://darrenjohnstone.net/)的 SPAPI 代码的方法。

该列表包含两个字段，title 和 BodyCopy

我已经创建了一个表单，询问标题和问题，两个文本字段，然后提交按钮调用以下函数：（请注意，ServerAddress 和 LIST_question 需要更新为您自己的详细信息）。

然后，该函数使用 LISTS.ASMX 中的 SOAP 服务上传详细信息，并使用响应获取新项目的 ID 并重定向页面。

```
var LIST_question = '{xxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}';
var ServerAddress = 'http://xxx/';

function submitQuestion()
    {
    var title = new String($("#title").val());
    var t = new String($("#question").val());
    t=t.trim();
    if(t=="")
        return;

    title=title.trim();
    if(title=="")
        return;

    var lists = new SPAPI_Lists(ServerAddress) ;
    // 
    var newItem = { Title :  title, BodyCopy : t};
    var items = lists.quickAddListItem(LIST_question, newItem); 
    var id=-1; 
    if (items.status == 200) 
    { 
        var rows = items.responseXML.getElementsByTagName('z:row');
        if(rows.length ==1)
        {
            var r = rows[0];
            var id = r.getAttribute('ows_ID'); 
            window.location.href='DispForm.aspx?ID='+id;

        }
        else
        {
            alert("Error: No row added");
        }

    } 
    else
    { 

        alert('There was an error: ' + items.statusText); 
        return;
    }
} 
```

# debugging - 如何将 OSDictionary 转储（打印）到控制台/日志？

> ID：801883
> 
> 赞同：2
> 
> 时间：2009-04-29T11:16:02.720
> 
> 标签：debugging, macos, kernel, iokit

我想从我的 kext 检查 OSDictionary 的内容。有没有方便的方法将内容打印到 system.log 或类似文件？（阿拉CFShow（））？

thx->adv,

|K<

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T13:27:25.680

我找到了一个代码片段来帮助解决这个问题（打印 dict 键）：

```
static void printDictionaryKeys (OSDictionary * inDictionary, char * inMsg) 
```

来源在这里： [printDictionaryKeys()](http://www.opensource.apple.com/source/xnu/xnu-2422.1.72/iokit/Kernel/IOPlatformExpert.cpp?txt)

# javascript - 如何在 JavaScript 中实现 Master 详细信息类查找功能？

> ID：801888
> 
> 赞同：0
> 
> 时间：2009-04-29T11:17:09.410
> 
> 标签：javascript, oop, class

我有这个代码：

```
function Item(id, itemType, itemData, itemCategoryId, itemRank) {
    this.id = id;
    this.itemType = itemType;
    this.itemData = itemData;
    this.itemCategoryId = itemCategoryId;
    this.itemRank = itemRank;
}
function Category(id) {
    this.id = id;
} 
```

我想为`Item`我给它的类编写一个函数，`CategoryId`它将返回具有此类别 ID 的所有项目对象。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T11:24:49.453

我看不到数组....

我假设会有一个项目原型（*[注意 javascript 中没有类](http://www.javaranch.com/journal/2008/10/Journal200810.jsp#a1)*），它看起来像这样：

```
function Item(id, categoryId, data, rank) {
  this.id = id;
  this.categoryId = categoryId;
  this.data = data;
  this.rank = rank;
}

function Items() {
  this.items = [];
  this.findByCategory = function(categoryId) { 
    var result = [];
    for(var i=0;i<this.items.length;i++) {
       if (categoryId == this.items[i].categoryId) 
          result.push(this.items[i]);
    }
    return result;
  }
  this.add = function(id, categoryId, data, rank) {
    this.items.push(new Item(id, categoryId, data, rank));  
  }
}

var items = new Items();
items.add(2, 0, null, null); 
items.add(1, 1, null, null); // I'm not going to care about data and rank here
items.add(2, 1, null, null); 
items.add(3, 1, null, null); 
items.add(4, 2, null, null); 
items.add(5, 3, null, null); 

var cat1 = items.findByCategory(1);
alert(cat1); // you will get a result of 3 objects all of which have category 1 
```

# c# - 在 WPF 中，如何绑定到 ViewModel 并将各种 XAML 元素绑定到 ViewModel 的方法？

> ID：801889
> 
> 赞同：1
> 
> 时间：2009-04-29T11:17:22.293
> 
> 标签：c#, wpf, data-binding, xaml

我可以像这样绑定 ListBox：

**XAML：**

```
<UserControl x:Class="TestDynamicForm123.Views.ViewCustomers"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <StackPanel Margin="10">
        <ListBox ItemsSource="{Binding}"/>
    </StackPanel>
</UserControl> 
```

**代码背后：**

```
using System.Windows.Controls;
using TestDynamicForm123.ItemTypes;

namespace TestDynamicForm123.Views
{
    public partial class ViewCustomers : UserControl
    {
        public ViewCustomers()
        {
            InitializeComponent();

            DataContext = Customers.GetAll();
        }
    }
} 
```

**查看型号：**

```
using System.Collections.ObjectModel;

namespace TestDynamicForm123.ItemTypes
{
    class Customers : ItemTypes
    {
        protected ObservableCollection<Customer> collection;

        public static ObservableCollection<Customer> GetAll()
        {
            ObservableCollection<Customer> customers = new ObservableCollection<Customer>();
            customers.Add(new Customer() { FirstName = "Jay", LastName = "Anders", Age = 34 });
            customers.Add(new Customer() { FirstName = "Jim", LastName = "Smith", Age = 23 });
            customers.Add(new Customer() { FirstName = "John", LastName = "Jones", Age = 22 });
            customers.Add(new Customer() { FirstName = "Sue", LastName = "Anders", Age = 21 });
            customers.Add(new Customer() { FirstName = "Chet", LastName = "Rogers", Age = 35 });
            customers.Add(new Customer() { FirstName = "James", LastName = "Anders", Age = 37 });
            return customers;
        }
    }
} 
```

但是我如何“将它提升一个级别”，以便我可以**在后面的代码中绑定到客户本身并在我的 XAML 中绑定到客户的各种方法**，例如 GetAll() 用于 ListBox 和 GetBest() 用于另一个控件等？

我在后面的代码中使用这种语法进行了尝试：

```
DataContext = new Customers(); 
```

XAML 中的这两种语法都不起作用：

```
<ListBox ItemsSource="{Binding GetAll}"/> (returns blank ListBox)
<ListBox ItemsSource="{Binding Source={StaticResource GetAll}}"/> (returns error) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T11:26:54.580

您需要使用[`ObjectDataProvider`](http://msdn.microsoft.com/en-us/library/system.windows.data.objectdataprovider.aspx)绑定到方法，但这应该是例外而不是规范。通常，您的 VM 只会公开您绑定到的属性，包括公开所有相关`Customer`s 的属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T11:28:26.073

您需要为您的视图创建一个视图模型类 (CustomersViewModel)。CustomersViewModel 将通过您的视图 (ViewCustomers) 可以绑定到的属性公开数据和命令（ICommand 接口）。然后，您可以将 ViewCustomers 的 DataContext 设置为 CustomersViewModel 的实例。查看以下有关 WPF 中的模型-视图-视图模型模式的 MSDN 文章。

[具有模型-视图-视图模型设计模式的 WPF 应用程序](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)

# apache - 删除 .htaccess 身份验证限制

> ID：801890
> 
> 赞同：0
> 
> 时间：2009-04-29T11:17:56.973
> 
> 标签：apache, authentication, .htaccess

我有一个具有 .htaccess 身份验证的项目，但我想为某个资产文件夹删除它。

我尝试在该文件夹中添加一个 htaccess：

```
AuthType none
Satisfy Any

Allow from All
Order Allow, Deny 
```

但这似乎不起作用:(对此有任何想法。非常感谢

**编辑** 我试图取消保护的目录不是真正的目录，而是重写规则。我无权访问 httpd.conf

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T20:45:29.510

我猜没有看到你的完整 .htaccess ，但是这样的事情呢：

```
RewriteEngine On
RewriteRule ^assets/ - [E=allow-assets:1]
Allow from env=allow-assets 
```

这可以放在父目录的 .htaccess 中，而不是资产中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T13:12:22.800

如果您可以访问 /etc/httpd.conf，您可能会这样做——是吗？

# .net - .NET：使用正则表达式查找十六进制字符串

> ID：801892
> 
> 赞同：1
> 
> 时间：2009-04-29T11:18:05.477
> 
> 标签：.net, regex

我需要正则表达式方面的帮助。

我有大量不同内容的文本文件。但是每个文件都包含一个十六进制密钥。每个键都有 16 个十六进制数字 ( `"E4 34 F1 FB..."`)，并且总是以`"00"`or开头`"01"`。在某些情况下，它们只有一个分隔符 ( `":"`)。

以下是一些示例键：

```
00:C461F0538ECC84F1AF43DBBDC49E5DA3
00:F4F599D15353650F1566CFEB5CB891C1
011EC3991261BFD8D74BBCFE1E3108628C
003E05F7730347E43437F1FBCAB3A8B461
018FAE7FFB2DBB64F646F705525DEB25F8
00)339EDE5269DD018C2FD5338AD18C3A2F
00B8491FDF00C618A155350F47349E7B04

```

如何在 .NET（VB.NET 或 C#）中使用正则表达式从字符串中提取这些键？

这里有几个用于测试的字符串：

```
KAJSDF00ASLJKHFLAKJSDHFLAK01JSH00:C461F0538ECC84F1AF43DBBDC49E5DA3DFLKJAHSDFJAVHBEVBERJHVBQEJHRVBQJERBV
JKLABDVJ01KBQLKJFBVQLEJKRBVL00:F4F599D15353650F1566CFEB5CB891C1QERBVJHQEBRVJHQBERFVHBQERVJHBQEJH
RVBQJHERVBJHQBRVJHQEBRVJHWEBRV011EC3991261BFD8D74BBCFE1E3108628CWKBERVJHWERFGUQHERULIFHQW
EIFH2FPO00I134FWFQWHEF34HFQREW018FAE7FFB2DBB64F646F705525DEB25F8F2347YQ3EFQO84R93U48UY8RTU13
R1R0100910R14UYR891UYFR1UEF98U1FPH00)3​​39EDE5269DD018C2FD5338AD18C3A2F138294FH190324FU134UF19834YF

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T11:32:21.917

以下正则表达式将匹配您的密钥并且不区分大小写

```
(?:00|01):?[a-fA-F0-9]{32} 
```

这是假设 OP 意味着一个 32 字符的字符串。如果它是 16 个字符的字符串，则将 {32} 更改为 {16}。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T11:23:55.167

```
0[01][\:\(\)]?([0-9A-F]){16} 
```

没有正则表达式解析器来测试它，但应该搜索

*   0,
*   后跟一个 0 或 1，
*   随后可能（但不是强制）出现“:”、“(”或“)”
*   后跟 16 个连续字符，可能值为 (0123456789ABCDEF)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T11:23:48.037

```
 string data = @"KAJSDF00ASLJKHFLAKJSDHFLAK01JSH00:C461F0538ECC84F1AF43DBBDC49E5DA3DFLKJAHSDFJAVHBEVBERJHVBQEJHRVBQJERBVJKLABDVJ01KBQLKJFBVQLEJKRBVL00:F4F599D15353650F1566CFEB5CB891C1QERBVJHQEBRVJHQBERFVHBQERVJHBQEJHRVBQJHERVBJHQBRVJHQEBRVJHWEBRV011EC3991261BFD8D74BBCFE1E3108628CWKBERVJHWERFGUQHERULIFHQWEIFH2FPO00I134FWFQWHEF34HFQREW018FAE7FFB2DBB64F646F705525DEB25F8F2347YQ3EFQO84R93U48UY8RTU13R1R0100910R14UYR891UYFR1UEF98U1FPH00)339EDE5269DD018C2FD5338AD18C3A2F138294F";
    for (Match match = Regex.Match(data, "0[01]:?[0-9A-F]{16}"); match.Success; match = match.NextMatch()) {
        Console.WriteLine(match.Value);
    } 
```

# sql-server - SQL server：将行转换为列

> ID：801895
> 
> 赞同：8
> 
> 时间：2009-04-29T11:20:15.190
> 
> 标签：sql-server, tsql, rows

我有一个带有列的表`sales(int)`，`month(int)`。我想检索每个月对应的销售额总和。我需要以与每个月对应的 12 列的形式输出，其中将有一条记录包含每个列（月）的销售额。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-29T11:28:43.377

您应该看一下[PIVOT](http://msdn.microsoft.com/en-us/library/ms177410.aspx)以使用列切换行。这可以防止每个月的 select 语句。像这样的东西：

```
DECLARE @salesTable TABLE
(
    [month] INT,
    sales INT
)

-- Note that I use SQL Server 2008 INSERT syntax here for inserting
-- multiple rows in one statement!
INSERT INTO @salesTable
VALUES (0, 2) ,(0, 2) ,(1, 2) ,(1, 2) ,(2, 2)
      ,(3, 2) ,(3, 2) ,(4, 2) ,(4, 2) ,(5, 2)
      ,(6, 2) ,(6, 2) ,(7, 2) ,(8, 2) ,(8, 2)
      ,(9, 2) ,(10, 2) ,(10, 2) ,(11, 2) ,(11, 2)

SELECT [0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11]
FROM
(
    SELECT [month], sales
    FROM @salesTable
) AS SourceTable
PIVOT
(
    SUM(sales)
    FOR [month] IN ([0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11])
) AS PivotTable 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T00:17:32.690

这是编写枢轴的另一种方法，它可以让您获得更多控制权（尤其是对列名）。生成动态 SQL 也更容易一些。

它类似于罗宾的答案，但具有只打桌子一次的优势：

```
select
  Sales1 = sum( case when Month = 1 then Sales end )
, Sales2 = sum( case when Month = 2 then Sales end )
, Sales3 = sum( case when Month = 3 then Sales end )
-- etc..
from SalesTable; 
```

我做了一些调查，似乎新的枢轴运算符只是这种查询的语法糖。查询计划最终看起来相同。

有趣的是，unpivot 运算符似乎也只是语法糖。例如：

如果你有这样的表：

```
Create Table Sales ( JanSales int, FebSales int, MarchSales int...) 
```

你可以写：

```
 select unpivoted.monthName, unpivoted.sales
 from Sales s
 outer apply (
    select 'Jan', JanSales union all
    select 'Feb', FebSales union all
    select 'March', MarchSales
 ) unpivoted( monthName, sales ); 
```

并获取未透视的数据...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T11:26:41.430

不漂亮......但这很好用

```
SELECT
    (SELECT SUM(Sales) FROM SalesTable WHERE [Month] = 1) [Sales1],
    (SELECT SUM(Sales) FROM SalesTable WHERE [Month] = 2) [Sales2],
    (SELECT SUM(Sales) FROM SalesTable WHERE [Month] = 3) [Sales3],
    (SELECT SUM(Sales) FROM SalesTable WHERE [Month] = 4) [Sales4],
    (SELECT SUM(Sales) FROM SalesTable WHERE [Month] = 5) [Sales5],
    (SELECT SUM(Sales) FROM SalesTable WHERE [Month] = 6) [Sales6],
    (SELECT SUM(Sales) FROM SalesTable WHERE [Month] = 7) [Sales7],
    (SELECT SUM(Sales) FROM SalesTable WHERE [Month] = 8) [Sales8],
    (SELECT SUM(Sales) FROM SalesTable WHERE [Month] = 9) [Sales9],
    (SELECT SUM(Sales) FROM SalesTable WHERE [Month] = 10) [Sales10],
    (SELECT SUM(Sales) FROM SalesTable WHERE [Month] = 11) [Sales11],
    (SELECT SUM(Sales) FROM SalesTable WHERE [Month] = 12) [Sales12] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T11:29:18.867

您可以使用[OLAP](http://www.devx.com/dbzone/Article/21410)来完成。[这](http://www.microsoft.com/sqlserver/2005/en/us/Analysis-Services.aspx)是有关该主题的 MSDN 文档的另一个链接。

使用 OLAP，您可以使用您拥有的信息和您需要的布局创建一个多维数据集。

如果您不想这样做，则必须使用 .NET、Java、TransacSQL 或您喜欢的语言创建汇总表来操作 SQLServer 数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-08T13:34:43.150

要轻松地将列转换为具有其名称的行，您应该使用 XML。在我的博客中，我通过示例对此进行了描述：[链接](http://sql-tricks.blogspot.com/2011/04/sql-server-rows-transpose.html)

# .net - 软件版本控制：Windows Installer 和 .Net 版本的区别

> ID：801899
> 
> 赞同：4
> 
> 时间：2009-04-29T11:22:42.767
> 
> 标签：.net, wix, windows-installer, versioning

微软推广 .Net 已经超过 8 年了。

.Net 程序集使用 4# 版本控制，如*major.minor[.build[.revision]]*。参考[这里](http://msdn.microsoft.com/en-us/library/system.version.aspx)

同时，Windows Installer 仍然建议使用 3# 版本控制，例如*major.minor.build*。参考[这里](http://msdn.microsoft.com/en-us/library/aa370859.aspx)

两个系统的版本控制不同。将 .Net 程序集版本映射到安装程序并不直接。使用 Windows Installer 安装 .Net 应用程序是相当复杂的，尤其是当有人想要为版本中的任何更改实施升级产品时。

如何克服这种情况？即使版本有最小的变化，我们也想升级我们的产品。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T04:56:54.467

这不是要克服的。接受和设计是一种设计限制。令人讨厌的是，但在可预见的将来可能会改变。Windows Installer ProductVersions 基于 3 个部分。另外，请记住前两部分不能超过 255，但第三部分可以达到 65,535。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T11:36:45.463

为什么要将 .NET 程序集版本直接映射到您的产品版本？您的产品中真的只有一个组件吗？

我见过的大多数产品配置管理流程通常使用清单（也称为材料清单）跟踪产品版本，其中列出了该产品版本中包含的二进制文件、配置文件和文档的版本。这将您的开发过程与发布过程分离，这是一件好事，尤其是对于商业产品。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T11:59:25.237

.NET 和 Windows 安装程序使用的版本解决了不同的问题。在 .NET 中，加载程序使用程序集版本来确定要加载的程序集版本。请记住，您可以将同一程序集的多个版本部署到 GAC 并让它们并排可用。您甚至可以拥有指定要加载的程序集的确切版本的策略。我可以在 GAC 中拥有不同版本的程序集 A，并让应用程序 1 使用版本 1，应用程序 2 使用版本 2。虽然我对 Windows 安装程序不太了解，但我认为它正在使用版本和产品 guid 来保持跟踪安装的应用程序的版本，以便它可以确定您正在安装的应用程序是否比已安装的应用程序更新并警告用户或先卸载它或让用户选择。

# java - 读取代理java后面的https网页数据

> ID：801908
> 
> 赞同：1
> 
> 时间：2009-04-29T11:26:30.387
> 
> 标签：java, proxy, https

我想阅读一个安全的网页数据，比如[https://www.paypal.com](https://www.paypal.com)，我在代理后面。我试过了

```
System.setProperty("java.net.useSystemProxies","true");
System.setProperty("htttps.proxyHost","myproxyhost");
System.setProperty("https.proxyPort","443");

URL u = new URL("https://www.paypal.com");
URLConnection uc = u.openConnection();
uc.setDoOutput(true);

StringBuffer sbuf=new StringBuffer();
BufferedReader in = new BufferedReader(
new InputStreamReader(uc.getInputStream()));

String res = in.readLine();
System.out.println(" Response from paypal "+res);
while ((res = in.readLine()) != null){
       sbuf.append(res).append(",");
}
in.close();

System.out.println(" Total Data received  "+sbuf); 
```

我一直收到 UnknownHostException，我成功地使用 http 网站获取数据。我错过了什么吗？

谢谢，罗希特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T11:45:30.730

您的`proxyHost`设置中有 3 个 T，即您正在使用`htttps`而不是`https`.

# .net - 为什么在使用 SqlCommand 时某些 sql 查询要慢得多？

> ID：801909
> 
> 赞同：19
> 
> 时间：2009-04-29T11:26:34.893
> 
> 标签：.net, sql, sqlcommand

`System.Data.SqlClient.SqlCommand`我有一个存储过程，它从 Sql Server Management Studio 执行（2 秒）比运行时（2 分钟后超时）要快得多。

这可能是什么原因？

* * *

详细信息：在 Sql Server Management Studio 中，这将在 2 秒内运行（在生产数据库上）：

```
执行 sp_Stat
    @DepartmentID = 空

```

在 .NET/C# 中，2 分钟后以下超时（在生产数据库上）：

```
string selectCommand = @"
EXEC sp_Stat
    @DepartmentID = NULL";
string connectionString = "server=***;database=***;user id=***;pwd=***";
using (SqlConnection connection = new SqlConnection(connectionString))
{
    using (SqlCommand command = new SqlCommand(selectCommand, connection))
    {
        connection.Open();
        using (SqlDataReader reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
            }
        }
    }
} 
```

我也尝试了`selectCommand = "sp_Stat"`,`CommandType = StoredProcedure`和 an `SqlParameter`，但结果相同。

没有`EXEC`它也是一样的结果。

在一个几乎没有数据的开发数据库上，这两种情况都在不到 1 秒的时间内完成。所以这与数据库中有很多数据有关，但它似乎只发生在.NET中......

* * *

Marc Gravell 所写的关于不同`SET`价值观的内容在所呈现的案例中有所不同。

SQL Server Profiler 显示 Sql Server Management Studio 运行以下`SET`.NET Sql Client Data Provider 没有：

```
 SET ROWCOUNT 0 
SET TEXTSIZE 2147483647 
SET NOCOUNT OFF 
SET CONCAT_NULL_YIELDS_NULL ON 
SET ARITHABORT ON 
SET LOCK_TIMEOUT -1 
SET QUERY_GOVERNOR_COST_LIMIT 0 
SET DEADLOCK_PRIORITY NORMAL 
SET TRANSACTION ISOLATION LEVEL READ COMMITTED 
SET ANSI_NULLS ON 
SET ANSI_NULL_DFLT_ON ON 
SET ANSI_PADDING ON 
SET ANSI_WARNINGS ON 
SET CURSOR_CLOSE_ON_COMMIT OFF 
SET IMPLICIT_TRANSACTIONS OFF 
SET QUOTED_IDENTIFIER ON
SET NOEXEC, PARSEONLY, FMTONLY OFF 
```

当我包含这些内容时，相同的查询在 SSMS 和 .NET 中花费了相同的时间。负责人`SET`是...

```
SET ARITHABORT ON 
```

我学到了什么？也许使用分析器而不是猜测......

（起初的解决方案似乎与参数嗅探有关。但我混淆了一些东西......）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-29T11:56:14.900

另一件可能很重要的事情是启用[的`SET`选项。](http://msdn.microsoft.com/en-us/library/ms190356.aspx)其中一些选项更改查询计划足以更改配置文件。如果您正在查看（例如）计算 + 持久（并且可能索引）列，有些可能会产生巨大影响：如果`SET`选项不兼容，则可以强制重新计算值，而不是使用索引value - 可以将索引搜索更改为表扫描 + 计算。

尝试使用分析器查看哪些`SET`选项正在“起作用”，并查看使用这些选项是否会改变事情。

另一个影响是连接字符串；例如，如果您启用 MARS，它可以以微妙的方式改变行为。

最后，事务（隐式 ( `TransactionScope`) 或显式）可能会产生*巨大*的影响，具体取决于隔离级别。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-29T11:35:12.987

这几乎可以肯定是由于“不正确”的缓存查询计划。这已经出现了好几次了。

你有最新的统计数据吗？定期计划的索引维护计划？

您可以通过将其添加到存储过程定义中来测试它是否肯定是由于缓存的查询计划：

```
CREATE PROCEDURE usp_MyProcedure WITH RECOMPILE... 
```

这将重新索引整个数据库（如果数据库非常大，请注意！）：

```
exec sp_msforeachtable "dbcc dbreindex('?')" 
```

所以帖子：

[Managment Studio 和 TableAdapter 之间存储过程的执行时间差异很大。](https://stackoverflow.com/questions/452467/big-difference-in-execution-time-of-stored-proc-between-managment-studio-and-tabl)

[SQL Server 中的参数嗅探（或欺骗）](https://stackoverflow.com/questions/211355/parameter-sniffing-or-spoofing-in-sql-server)

[为 SQL Server 2005 优化未知数？](https://stackoverflow.com/questions/650914/optimize-for-unknown-for-sql-server-2005)

[同一个存储过程的不同执行计划](https://stackoverflow.com/questions/505995/different-execution-plan-for-the-same-stored-procedure)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-28T03:43:40.970

有一个类似的问题，事实证明，连接字符串中的 MultipleActiveResultSets=true （应该影响最小）使得通过远程连接提取 150 万条记录需要 25 分钟而不是大约 2 分钟。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T11:30:44.010

我们有一个类似的问题，在 SSMS 中查询将在 2 秒内完成，而从 .NET 客户端调用时则需要 90 多秒（我们编写了几个 VB/C# 应用程序/站点来测试它。）

我们怀疑查询计划会有所不同，并使用显式循环（“内循环连接”和“带索引”）提示重写了查询。这解决了问题。

# iphone - iPhone BitmapImageRep

> ID：801910
> 
> 赞同：0
> 
> 时间：2009-04-29T11:26:37.250
> 
> 标签：iphone, cocoa

我有一个包含 JPEG 图像数据的缓冲区。我需要在 UIImageView 中显示此图像。我需要将此图像缓冲区转换为 UIImage 的对象并按如下方式使用它

NSData *data = [NSData dataWithContentsOfFile:appFile]; UIImage *theImage = [[UIImage alloc] initWithData:data];

我得到了显示的图像，但与实际分辨率相比，分辨率较低。我是否需要先将其转换为位图，然后将其与 UIImage 一起使用？我似乎无法使用 NSBitmapImageRep。关于如何实现这一目标的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T16:39:47.403

如果 UIImageView 框架尺寸与源图像尺寸不同，您将获得图像的调整大小版本。质量可能非常粗糙，具体取决于正在执行的转换量。

我在网上的某个地方找到了这段代码（对不起原作者 - 我已经失去了归属），它执行更平滑的调整大小：

```
UIImage* resizedImage(UIImage *inImage, CGRect thumbRect)
{
    CGImageRef          imageRef = [inImage CGImage];
    CGImageAlphaInfo    alphaInfo = CGImageGetAlphaInfo(imageRef);

    // There's a wierdness with kCGImageAlphaNone and CGBitmapContextCreate
    // see Supported Pixel Formats in the Quartz 2D Programming Guide
    // Creating a Bitmap Graphics Context section
    // only RGB 8 bit images with alpha of kCGImageAlphaNoneSkipFirst, kCGImageAlphaNoneSkipLast, kCGImageAlphaPremultipliedFirst,
    // and kCGImageAlphaPremultipliedLast, with a few other oddball image kinds are supported
    // The images on input here are likely to be png or jpeg files
    if (alphaInfo == kCGImageAlphaNone)
        alphaInfo = kCGImageAlphaNoneSkipLast;

    // Build a bitmap context that's the size of the thumbRect
    CGContextRef bitmap = CGBitmapContextCreate(
                                                NULL,
                                                thumbRect.size.width,       // width
                                                thumbRect.size.height,      // height
                                                CGImageGetBitsPerComponent(imageRef),   // really needs to always be 8
                                                4 * thumbRect.size.width,   // rowbytes
                                                CGImageGetColorSpace(imageRef),
                                                alphaInfo
                                                );

    // Draw into the context, this scales the image
    CGContextDrawImage(bitmap, thumbRect, imageRef);

    // Get an image from the context and a UIImage
    CGImageRef  ref = CGBitmapContextCreateImage(bitmap);
    UIImage*    result = [UIImage imageWithCGImage:ref];

    CGContextRelease(bitmap);   // ok if NULL
    CGImageRelease(ref);

    return result;
} 
```

# django - 如何将 timedelta 放入 django 模型中？

> ID：801912
> 
> 赞同：49
> 
> 时间：2009-04-29T11:26:47.450
> 
> 标签：django

使用inspectdb，我能够从postgres 到django 中获得一个“间隔”字段。在 Django 中，它是一个 TextField。我检索到的对象确实是一个 timedelta 对象！

现在我想把这个 timedelta 对象放在一个新模型中。最好的方法是什么？因为在 TextField 中放置 timedelta 会导致对象的 str 版本......

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2015-04-08T13:35:20.080

从 Django 1.8 开始，您可以使用[DurationField](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.DurationField)。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-04-29T11:40:52.473

您可以轻松地将 timedelta 标准化为以天或秒为单位的单个浮点数。

这是“归一化到天”的版本。

```
float(timedelta.days) + float(timedelta.seconds) / float(86400) 
```

您可以轻松地将浮点数转换为 timedelta。

```
>>> datetime.timedelta(2.5)
datetime.timedelta(2, 43200) 
```

因此，将您的 timedelta 存储为浮点数。

这是“归一化到秒”版本。

```
timedelta.days*86400+timedelta.seconds 
```

这是相反的（使用秒）

```
datetime.timedelta( someSeconds/86400 ) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-04-16T12:23:10.030

[https://bitbucket.org/schinckel/django-timedelta-field/src](https://bitbucket.org/schinckel/django-timedelta-field/src)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-05-14T01:16:07.307

首先，定义你的模型：

```
class TimeModel(models.Model):
    time = models.FloatField() 
```

要存储 timedelta 对象：

```
# td is a timedelta object
TimeModel.objects.create(time=td.total_seconds()) 
```

要从数据库中获取 timedelta 对象：

```
# Assume the previously created TimeModel object has an id of 1
td = timedelta(seconds=TimeModel.objects.get(id=1).time) 
```

**注意：**我在这个例子中使用 Python 2.7。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-06-06T05:47:58.050

有一张可以追溯到 2006 年 7 月的票与此相关： [https ://code.djangoproject.com/ticket/2443](https://code.djangoproject.com/ticket/2443)

编写了几个补丁，但其中一个已提交到项目中： [https ://github.com/johnpaulett/django-durationfield](https://github.com/johnpaulett/django-durationfield)

与这里的所有其他答案相比，这个项目是成熟的，并且会被合并到核心，除了它的包含目前被认为是“臃肿”。

就个人而言，我刚刚尝试了一堆解决方案，这是一个效果很好的解决方案。

```
from django.db import models
from durationfield.db.models.fields.duration import DurationField

class Event(models.Model):
    start = models.DateTimeField()
    duration = DurationField()

    @property
    def finish(self):
        return self.start + self.duration 
```

结果：

```
$ evt = Event.objects.create(start=datetime.datetime.now(), duration='1 week')
$ evt.finish
Out[]: datetime.datetime(2013, 6, 13, 5, 29, 29, 404753) 
```

在管理员中：

**更改事件**

期间：`7 days, 0:00:00`

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-07-25T12:16:14.393

对于 PostgreSQL，请在此处使用 django-pgsql-interval-field：[http ://code.google.com/p/django-pgsql-interval-field/](http://code.google.com/p/django-pgsql-interval-field/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-03-03T11:03:20.260

把它放在那里可能是解决这个问题的另一种方法。首先安装这个库：[https ://pypi.python.org/pypi/django-timedeltafield](https://pypi.python.org/pypi/django-timedeltafield)

然后：

```
import timedelta

class ModelWithTimeDelta(models.Model):
    timedeltafield = timedelta.fields.TimedeltaField() 
```

在管理员中，您将被要求使用以下格式在字段中输入数据：3 天、4 小时、2 分钟

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-01-07T07:41:23.303

[这里](https://stackoverflow.com/a/46297988/9070016)解释了一种解决方法。如果您使用的是 Postgresql，那么将`F`表达式的结果乘以`timedelta`解决问题。例如，如果你有 a`start_time`和 a`duration`的分钟数，你可以`end_time`这样计算：

```
YourModel.objects.annotate(
    end_time=ExpressionWrapper(F('start_time') + timedelta(minutes=1) * F('duration'), output_field=DateTimeField())
) 
```

# hibernate - 使用休眠 hbm2ddl.auto=update ：如何更改列不再需要值？

> ID：801915
> 
> 赞同：5
> 
> 时间：2009-04-29T11:27:11.537
> 
> 标签：hibernate, hbm2ddl

我有一个曾经不是 null="true" 的属性。该字段不再需要值，因此我将其更改为 not-null="false" 但表未在数据库中更新。添加新属性不会带来任何问题。

hbm2ddl.auto=update 是否可以自动更改表以删除 not-null="true"？（我知道我可以编写一个 sql 脚本来更改它，但想让它自动更新）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T07:55:05.727

据我所知： hbm2ddl.auto=update 不会更改已包含数据的表的非空值。

最后我只是写了一个sql脚本来更改表。

# python - 通知容器对象：最佳实践

> ID：801931
> 
> 赞同：4
> 
> 时间：2009-04-29T11:31:06.270
> 
> 标签：python, architecture, containers, notifications

我有两个课程：Account 和 Operator。Account 包含一个 Operator 列表。现在，每当操作员（在列表中）收到一条消息时，我想通知 Account 对象也执行一些业务逻辑。

关于如何实现这一目标，我想到了三种选择：

1) 在 Operator 内持有对容器 [Account] 对象的引用并直接调用方法。由于循环引用，并不是绝对好。

2) 使用事件。据我所知，Python 中没有内置的事件处理机制。所以，这个实现起来有点棘手。

3) 不要直接向 Operator 发送消息。相反，只操作帐户，并在它们内部，在内部，处理程序操作员。这个有点限制，因为在这种情况下，我不能将引用传递给运算符。

我想知道从架构的角度来看哪种方法最有利。你通常如何处理这个任务？

如果您能指出 Python 中的代码片段，那就太好了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T12:15:23.200

你想太多了。严重地。Python 不是 C++；您的担忧在 Python 中不是问题。只需写出在您的问题域中有意义的内容。

“由于循环引用，不是绝对好。”

为什么不？循环在这里根本无关紧要。双向关系是很棒的事情。使用它们。Python 垃圾可以很好地收集它们，而无需您考虑。

您对相互（双向）关系有什么可能的问题？

“...仅操作帐户，在它们内部，在内部，处理程序运算符。这个有点限制，因为在这种情况下，我不能传递对运算符的引用。”

什么？你的操作符是 Python 对象，传递你想要的一切。所有 Python 对象（实际上）都是引用，不要担心。

操作 Operator 对象时可能遇到什么问题？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T12:00:25.203

观察者模式没有“一刀切”的解决方案。但通常，最好定义一个 EventManager 对象，感兴趣的各方可以在其中注册某些事件并在这些事件发生时发布这些事件。它只是创建了更少的依赖关系。

请注意，您需要使用全局 EventManager 实例，这在测试期间或从一般 OO 的角度（它是一个全局变量）可能会出现问题。我强烈建议不要一直传递 EventManager，因为这会使您的代码混乱。

在我自己的代码中，注册事件的“关键”是事件的类。EventManager 使用字典（事件类 -> 观察者列表）来知道哪个事件去哪里。在通知代码中，您可以使用它`dict.get(event.__class__, ())`来查找您的侦听器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-29T12:14:12.643

我会为此使用事件处理。您不必自己实现它——我使用[pydispatcher](http://pydispatcher.sourceforge.net/)来处理这种事件，而且它总是工作得很好（它在内部使用弱引用，以避免循环引用问题）。

此外，如果您使用的是 gui 框架，您可能已经有一个可以挂钩的事件框架，例如[PyQt](http://www.riverbankcomputing.co.uk/software/pyqt/intro)有信号和槽。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-29T12:15:39.020

```
>>> class Account(object):
...     def notify(self):
...         print "Account notified"
...
>>> class Operator(object):
...     def __init__(self, notifier):
...         self.notifier = notifier
...
>>> A = Account()
>>> O = Operator(A.notify)
>>> O.notifier()
Account notified
>>> import gc
>>> gc.garbage
[]
>>> del A
>>> del O
>>> gc.garbage
[] 
```

关于实例方法，您可能不知道的一件事是，在使用点语法时查找它们时会绑定它们。换句话说，`A.notify`自动将 notify 的 self 参数绑定到 A。然后您可以保持对该函数的引用，而不会产生无法回收的垃圾。

最后，您始终可以将[Kamaelia](http://www.kamaelia.org/Home)用于此类事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T13:00:07.960

网络上到处都有观察者模式片段。可靠代码的良好来源是活动状态，例如：

[http://code.activestate.com/recipes/131499/](http://code.activestate.com/recipes/131499/)

# java - 在 Java/JSTL 中格式化文件大小

> ID：801935
> 
> 赞同：5
> 
> 时间：2009-04-29T11:32:16.033
> 
> 标签：java, jsp, formatting, jstl

我想知道是否有人知道在 Java/JSP/JSTL 页面中格式化文件大小的好方法。

是否有一个 util 类可以做到这一点？
我搜索了公地，但一无所获。有自定义标签吗？
是否已经存在为此的库？

理想情况下，我希望它的行为类似于Unix 的**ls**命令上的**-h**开关

 **34 -> 34
795 -> 795
2646 -> 2.6K
2705 -> 2.7K
4096 -> 4.0K
13588 -> 14K
28282471 -> 27M
28533748 -> 28M

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T11:47:27.887

一个快速的谷歌搜索从 Appache hadoop 项目返回给我[这个。](https://github.com/apache/hadoop/blob/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/StringUtils.java)从那里复制：（Apache 许可证，2.0 版）：

```
private static DecimalFormat oneDecimal = new DecimalFormat("0.0");

  /**
   * Given an integer, return a string that is in an approximate, but human 
   * readable format. 
   * It uses the bases 'k', 'm', and 'g' for 1024, 1024**2, and 1024**3.
   * @param number the number to format
   * @return a human readable form of the integer
   */
  public static String humanReadableInt(long number) {
    long absNumber = Math.abs(number);
    double result = number;
    String suffix = "";
    if (absNumber < 1024) {
      // nothing
    } else if (absNumber < 1024 * 1024) {
      result = number / 1024.0;
      suffix = "k";
    } else if (absNumber < 1024 * 1024 * 1024) {
      result = number / (1024.0 * 1024);
      suffix = "m";
    } else {
      result = number / (1024.0 * 1024 * 1024);
      suffix = "g";
    }
    return oneDecimal.format(result) + suffix;
  } 
```

它使用 1K = 1024，但如果您愿意，可以调整它。您还需要使用不同的 DecimalFormat 处理 <1024 的情况。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-10-08T16:15:03.263

您可以使用 commons-io`FileUtils.byteCountToDisplaySize`方法。对于 JSTL 实现，您可以在 classpath 上有 commons-io 时添加以下 taglib 函数：

```
<function>
  <name>fileSize</name>
  <function-class>org.apache.commons.io.FileUtils</function-class>
  <function-signature>String byteCountToDisplaySize(long)</function-signature>
</function> 
```

现在在您的 JSP 中，您可以执行以下操作：

```
<%@ taglib uri="/WEB-INF/FileSizeFormatter.tld" prefix="sz"%>
Some Size: ${sz:fileSize(1024)} <!-- 1 K -->
Some Size: ${sz:fileSize(10485760)} <!-- 10 MB --> 
```

# perl - 如何检查 Perl 中的 DBI 查询是否返回了多个记录？

> ID：801939
> 
> 赞同：3
> 
> 时间：2009-04-29T11:33:04.457
> 
> 标签：perl, hash, count, dbi

我已经在网站上搜索了这个，但找不到任何回答我问题的东西。这让我想到了细节：

我正在使用简单的选择查询来查询数据库，实际上（给定场景）它不应该返回超过大约 5 到 6 条记录。我只是想检查是否已退回多个。如果已经返回了多个（在 else 语句中），如果只返回了一个，那么我会继续执行脚本。

```
我的 $sql = qq { 选择 col1，col2，col3
                 从表
            在哪里 col1 = 'foo'
          };

我的 $sth = $dbc->prepare_cached($sql) 或 die "Could not prepare statement:" 。$dbc->errstr;

$sth->execute() 或 die "Could not execute statement:" 。$sth->errstr;

# 不知道如何有效地检查返回的多于一行，如果为真，仍然会继续进行......这是我的问题！我在想一个嵌套的 if 来查看是否返回了任何行，然后检查一行或多行？但是我该如何检查（比如计数功能？）
if (我的 $ref = $sth->fetchrow_hashref()) {

 # 返回一行...

} 别的 {
 # 不止一行返回了...呃哦！
}

```

如果你们知道一个我找不到的线程来回答这个问题，只需重定向我，我就会取消这个线程！

问候，BorisTheBulletDodger！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T14:15:09.420

```
my $sth = $dbh->prepare("SELECT col1, col2, col3 FROM tablename");
$sth->execute();
my $rows = $sth->fetchall_arrayref({});
if (@$rows == 0) {
    die "no rows returned";
} elsif (@$rows > 1) {
    die "too many rows returned";
}
my $row = $rows->[0];
print "col1 is $row->{col1}\n"; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-29T13:06:38.273

```
my $sth = $dbh->prepare();
$sth->execute();

my $row = $sth->fetchrow_hashref();
my $second = $sth->fetchrow_hashref();

if ($second) {
  print "2+ rows\n";
} elsif ($row) {
  print "1 row\n";
} else {
  print "no rows\n";
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-29T12:30:16.940

唯一能权威地确定 a 是否找到了不止一行的`SELECT`方法是尝试检索不止一行。DBI 确实提供了该`->rows`属性，但它只保证对非`SELECT`语句有效。

[如何检查数据库查询是否会返回结果](https://stackoverflow.com/questions/290133/how-can-i-check-if-a-database-query-will-return-results)？也可能证明是有用的，即使这不是同一个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T12:20:19.430

使用其中一种`fetchall_*`or`selectall_*`方法（请参阅[DBI 文档](http://search.cpan.org/~timb/DBI-1.607/DBI.pm)），因为您最多只有 5-6 个。然后确定你到底得到了多少行。

# java - 从泛型 T 派生类

> ID：801940
> 
> 赞同：11
> 
> 时间：2009-04-29T11:33:06.640
> 
> 标签：java, generics, reflection, derived-class

我有一个参数化的休眠 dao，它执行基本的 crud 操作，当参数化用作委托来完成给定 dao 的基本 crud 操作时。

```
public class HibernateDao <T, ID extends Serializable> implements GenericDao<T, ID> 
```

我希望能够在运行时从 T 派生 Class 以在 Hibernate 中创建条件查询，例如：

```
public T findByPrimaryKey(ID id) {
    return (T) HibernateUtil.getSession().load(T.getClass(), id);
} 
```

我知道：

```
T.getClass() 
```

不存在，但是有什么方法可以在运行时从 T 派生正确的 Class 对象？

我看过泛型和反射，但没有想出合适的解决方案，也许我遗漏了一些东西。

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-29T11:38:29.047

您可以将 Class 作为构造函数参数传递。

```
public class HibernateDao <T, ID extends Serializable> implements GenericDao<T, ID> {

    private final Class<? extends T> type;

    public HibernateDao(Class<? extends T> type) {
        this.type = type;
    }

    // ....

} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-20T12:57:37.300

有一种方法可以使用反射找出`class`类型参数：`T`

```
private Class<T> persistentClass = (Class<T>)
    ((ParameterizedType)getClass().getGenericSuperclass()).getActualTypeArguments()[0]; 
```

这是我使用它的方式：

```
public class GenericDaoJPA<T> implements GenericDao<T> {

    @PersistenceContext
    protected EntityManager entityManager;

    protected Class<T> persistentClass = figureOutPersistentClass();

    private Class<T> figureOutPersistentClass() {
        Class<T> clazz = (Class<T>)((ParameterizedType) (getClass().getGenericSuperclass())).getActualTypeArguments()[0];
        log.debug("persistentClass set to {}", clazz.getName());
        return clazz;
    }

    public List<T> findAll() {
        Query q = entityManager.createQuery("SELECT e FROM " + persistentClass.getSimpleName() + " e");
        return (List<T>) q.getResultList();
    }

} 
```

我想这仅在您`ConcreteEntityDao`是`HibernateDao<ConcreteEntity,...>`.

我在这里找到了它：www.greggbolinger.com/blog/2008/04/17/1208457000000.html

# svn - 如何维护略有不同的软件？

> ID：801941
> 
> 赞同：2
> 
> 时间：2009-04-29T11:33:21.447
> 
> 标签：svn, version-control

我有一些在定制硬件上运行的项目。现在硬件发生了变化，这需要一些软件更改。因此，“旧硬件”的来源 A 和“新硬件”的来源 B，95% 相同。

如果将来添加新功能，则必须对两个版本都执行此操作。换句话说，A 和 B 将并存，从现在开始将始终需要相同的更改。

我刚刚开始使用 Subversion，因此我对所有可能性都不是很熟悉。

据我了解，B 的新分支将从那时起将两者分开，这不是我所需要的。

维护 A 和 B 以便将来的更改将应用​​于两个版本而无需手动应用两次的最佳方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-29T11:41:13.050

我认为不需要任何复杂的版本控制。只需将您的资源组织成这样的结构：

```
Project
|-CommonSource95%
|-HardwareA
|-HardwareB 
```

使用 makefile 或 #ifdefs 自定义特定硬件的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T11:40:17.763

如果可能的话，我会维护一个源代码树并使用#ifdefs 来定制特定处理器的代码（假设您使用的是 C 或 C++）。如果您可以将依赖于硬件的部分隔离到少量文件中，则此方法尤其有效。如果你能做到这一点，就不需要额外的颠覆魔法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T11:51:50.917

以某种方式隔离特定于某个硬件版本的代码：将其放入不同的功能或使用宏来交换不同的部分。这就是高级操作系统所说的“设备驱动程序”。

在构建文件或运行时，确定您需要的版本并激活它。函数指针是你的朋友。

分解出通用代码并从两个版本中使用它。这样，您可以减少代码重复，您可以同时查看两个版本。如果您使用 SVN 修订版将其分开，这是不可能的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T09:02:19.443

我不会通过在您的版本控制系统中分支来解决这个问题。分支可能会发散到难以在它们之间移植更改的程度。

这个问题让我想起了[Apache Portable Runtime](http://apr.apache.org/)项目。您可以对代码使用相同的想法：将不同硬件的实现差异隐藏在[硬件抽象层](http://en.wikipedia.org/wiki/Hardware_abstraction_layer)后面。这一层的不同实现可以在同一个主干中彼此相邻。大多数代码不应该关心硬件并通过 HAL 访问它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T11:37:07.707

在 SVN 中，您可以为“旧”和“新”硬件创建分支。

# asp.net - 如何实现 ASP.Net 表单身份验证

> ID：801943
> 
> 赞同：4
> 
> 时间：2009-04-29T11:33:47.263
> 
> 标签：asp.net, forms-authentication

我只是想知道如何在 asp.net 中使用 FormAuthentication

在我们的项目中，我们基于 web 服务，它会在成功登录时返回一个 XML 文档，其中包含我们需要的所有凭据。存储和访问返回信息的最佳方式是什么？

谢谢

编辑：感谢您的回复。我不能使用默认的提供者，因为提供者已经给了我们。

基本上，我想知道的是在成功登录时存储 Guid 和 Integer 的最有效方法是什么，以便我的 asp.net 应用程序可以轻松访问它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T12:09:25.837

会话["GUID"] = 值；会话[“INT”] = 值；

当您只需要 2 个微小的值时，出于性能原因，不建议将 XML Dom 对象或 xml 放入 Session 对象中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T12:15:35.837

当您创建您的`FormsAuthenticationTicket`时，您可以将`UserData`属性设置为您喜欢的任何内容，包括来自 Web 服务的数据。这些数据在放入表单身份验证 cookie 时将全部加密，并在每个后续请求中解密。该信息将在您可以通过访问`Ticket`的对象的属性中获得。`FormsIdentity``HttpContext.Current.User.Identity`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T11:43:23.747

怎么办？这是一个复杂的主题，没有人可以在这里完全回答。

我可以告诉您，实现它的最简单方法是使用标准 SQL Server 支持的表单身份验证提供程序。 [这是有关如何设置它的分步说明。](http://msdn.microsoft.com/en-us/library/ms998317.aspx)

但是，当存在数据库问题时，它可能会有些混乱。这些通常是由常见问题引起的，一些谷歌搜索通常会很快解决。

另外请记住，表单身份验证通常需要通过网络发送明文密码。因此，在生产环境中必须使用 SSL 保护您的登录 URL。

# c# - Mjpeg VLC 和 HTTP 流媒体

> ID：801944
> 
> 赞同：4
> 
> 时间：2009-04-29T11:34:35.920
> 
> 标签：c#, http, streaming, vlc, mjpeg

我正在生成一个 MJpeg 流并尝试将其流式传输到 VLC 并在那里播放。

编码：

```
 public void SendMultiPartData(String contentType, Func<byte[]> getData)
    {
        MemoryStream mem = null;
        response.StatusCode = 200;
        for ( byte[] buffer = getData(); buffer != null && buffer.Length > 0; buffer = getData())
        {
            response.ContentType = "multipart/x-mixed-replace; boundary=--testboundary";
            ASCIIEncoding ae = new ASCIIEncoding();
            byte[] boundary = ae.GetBytes("\r\n--testboundary\r\nContent-Type: " + contentType + "\r\nContent-Length:" + buffer.Length + "\r\n\r\n");
            mem = new MemoryStream(boundary);
            mem.WriteTo(response.OutputStream);
            mem = new MemoryStream(buffer);
            mem.WriteTo(response.OutputStream);
            response.OutputStream.Flush();
        }
        mem.Close();
        listener.Close();
    } 
```

如果我尝试使用 Firefox 打开流，则完全没有问题，尽管使用 VLC 它不起作用（VLC 似乎继续阅读但从不显示视频）

我一直在嗅探 VLC-to-VLC 流，它们似乎用作 HTTP 标头“application/octet-stream”而不是 multipart/x-mixed-replace

有任何想法吗 ？

提前谢谢，何塞

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T18:51:45.393

何塞，我遇到了完全相同的问题。Firefox 播放我的流，但 VLC 没有。我通过了很多方法来解决这个问题，包括调试 VLC 源代码，但无处可去。顺便说一句，我的（REST）URL 看起来像[http://server:port/livevideo/xyz](http://server:port/livevideo/xyz) 然后，我想我应该试试[http://server:port/livevideo/xyz.mjpeg](http://server:port/livevideo/xyz.mjpeg) 猜猜看，VLC 开始播放视频了！我认为 VLC 可能需要比内容类型更多的提示才能确定它是 mjpeg 流。希望这可以帮助。

辛迪

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T21:39:33.203

你有没有试过这个：

```
Response.Buffer = false;
Response.BufferOutput = false; 
```

或者这些的一些变化？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-09T20:21:43.360

我无法让 Firefox 播放我的流（尽管 chrome 播放它还可以）。对于 VLC，我将缓冲区设置为 0 毫秒（在高级打开选项下），它似乎从那里开始工作，尽管我的数据速率正在扼杀它。

# perl - 如何在 Perl 中重命名导出的函数？

> ID：801949
> 
> 赞同：2
> 
> 时间：2009-04-29T11:36:03.373
> 
> 标签：perl, exporter, typeglob

我有一些导出各种功能的 Perl 模块。（我们已经有几年没有在新模块中使用 @EXPORT 了，但保留它是为了与旧脚本兼容。）

我已经重命名了许多函数和方法以更改为一致的命名策略，并认为然后添加一个行列表，例如

```
*directory_error      = *directoryError; 
```

在模块的末尾只会将旧名称别名为新名称。

这有效，除非导出旧名称，并且调用脚本以非限定名称调用函数：在这种情况下，它报告未找到子例程（在调用模块中）。

我猜发生的事情是，当别名尚未创建时，Exporter 会在 BEGIN 中准备列表；但我尝试将 typeglob 赋值放在 BEGIN 块中，但没有帮助。

我已经尝试过 AUTOLOAD，但当然这不会使该名称在调用上下文中可用。当然，我可以编写一系列包装函数，但这很乏味。我可能会自动生成包装函数，但我不确定如何。

任何关于处理此问题的简洁方法的建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T17:01:11.610

## 出口

手动调用 @EXPORT =() 东西变得有点憔悴。

```
package Bar;
use strict;
use warnings;

use Sub::Exporter -setup => {
    exports => [qw[ foo ]],
    groups  => {
        default => [qw[ foo ]],
    }
};

sub foo(){

};

1; 
```

利用：

```
use strict;
use warnings;
use Bar  foo => { -as-> 'Foo' }; 
```

Sub::Exporter 可以做很多很棒的事情，比如组导出、组排除、构建器方法（即：它导出的 subs 的工作方式由传递的参数决定，subs 是在其他 subs 中生成的，等等）

*   [Sub::Exporter 教程](http://p3rl.org/Sub::Exporter::Tutorial)
*   [子::出口商](http://p3rl.org/Sub::Exporter)

## 重命名

对于重命名事物，最好有一个辅助函数，它只是作为一个遗留函数，当 Carp() 被调用时，它会推荐指向它的代码，以将其移动到新方法。这将提高代码范围内的一致性。

然后，当您的测试停止发出警告时，您可以删除旧功能。

```
sub old {  # line 1
   Carp::carp('Legacy function \'old\' called, please move to \'newmethod\' '); 
   goto &newmethod; # this passes @_ literally and hides itself from the stack trace. 
} # line 4

sub newmethod { # line 6
   Carp::cluck('In New Method'); 
   return 5;
} # line 9

print old(), "\n";  # line 11 
```

```
已调用旧函数“旧”，请移至 code.pl 第 2 行的“新方法”
    main::old() 在 code.pl 第 11 行调用
在 code.pl 第 7 行的新方法中
    main::newmethod() 在 code.pl 第 11 行调用
5

```

请注意 newmethod 中的警告看起来与直接调用它们的方式完全相同。

# 

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T13:21:26.880

以下对我有用。这似乎是您所描述的；你一定在某个地方犯了错误。

主脚本：

```
use strict;
use warnings;
use Bar;

baz(); 
```

模块：

```
package Bar;
use strict;
use warnings;

require Exporter;
our @ISA    = qw(Exporter);
our @EXPORT = qw(baz);

sub Baz { print "Baz() here\n" }

*baz = *Baz;

1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T14:06:51.390

如果您希望两个名称都可见，则必须导出这两个名称。使用迈克尔卡曼的答案作为基础，你需要

```
our @EXPORT = qw(Baz baz); 
```

或者

```
our @EXPORT    = qw(Baz);
our @EXPORT_OK = qw(baz); 
```

如果您希望能够调用程序中的任何一个。仅仅因为它们指向同一个 coderef 并不意味着该 coderef 的所有名称都将在一个名称时被导出。

# svn - Codeplex + SVN。SVN桥有多好？

> ID：801950
> 
> 赞同：6
> 
> 时间：2009-04-29T11:36:30.860
> 
> 标签：svn, version-control, codeplex, amazon-elastic-beanstalk

我避免使用 CodePlex，因为它缺乏对适当 SVN 的支持，并且被关于缺点的投诉所劝阻。最近，我一直想将我的项目从 beanstalk 移植到 codeplex，因为后者更具社交性。

你遇到过什么问题，对SVN的支持有多好。SVN桥有多好？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T13:55:10.543

当 CodePlex 有客户端程序时，客户端 SvnBridge 对我来说一直是个问题。然而，他们已经将 SvnBridge 移到了他们的服务器场中，并且运行得非常好。我在 CodePlex 上有 3 个项目，其中 2 个使用他们的源代码控制。其中两个项目是从 SourceForge 迁移而来的。SourceForge 的 UI 越来越差，而 CodePlex 一直在倾听用户的意见并改善了用户体验。

我遇到的主要问题是您的提交没有获得连续的 ID。id 池与运行它的 TFS 服务器上的所有其他项目共享。据我所知，目前有 6 个 TFS 服务器托管 CodePlex 项目。

我自己托管其中一个项目的源代码控制，因为我需要为一些事情添加自定义钩子脚本。除此之外，CodePlex 还不错。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T11:47:44.203

先试试看。在 CodePlex 上建立一个“虚拟”项目，不要发布它，然后找出来。

我已经使用 CodePlex 和 Tortoise SVN 一段时间了，这很好，但我可能没有做你想做的事。

CodePlex 为您提供 30 天（我认为）来设置您的项目而不发布它。您可以轻松设置项目，确保您感兴趣的 SVN 命令有效，然后发布或中止。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-02-17T07:35:26.587

SVN 网桥太 buggggggggggggggggggy ！！！我没有检查大多数项目，使用 git-svn、hgsubversion、bzr-svn，......我很生气的是它在中间失败，HTTP 200 OK 或者在 git-svn 中完全没有响应。我建议人们不要在 Codeplex 中选择 TFS/SVN 选项，请选择 Git/Mercurial；如果他们想继续使用 SVN，或者切换到 GoogleCode 或 SourceForge。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T01:48:10.370

我在 CodePlex 上管理一个小项目（使用 Subversion），我对这种体验并不特别满意。最大的问题是：

1.  对 Subversion 功能的不完整/错误支持。例如，我可以创建一个新文件夹，但不能将任何内容移入其中。命令行客户端在与 SVN 服务器通信时不断出错，并锁定存储库。

2.  缓慢的源代码控制访问。真的很慢，即使是小文件。浏览历史很痛苦。

我还没有尝试过更多的“高级”功能，比如分支和合并，但从我读到的内容来看，它目前不受支持。

因此，您可以将 CodePlex 与 TF$ 一起使用，或者转到 Google Code、SourceForge、GitHub 等...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-26T11:16:03.300

来自[底格里斯论坛](http://tortoisesvn.tigris.org/ds/viewMessage.do?dsForumId=757&dsMessageId=2611987)

> 我自己做了一些测试，发现问题出在 serf 库上。svn 1.7 使用 serf 而不是 neon 作为默认库。您可以在服务器配置文件中将其设置回霓虹灯：设置->网络->编辑，然后在文件底部添加该行
> 
> `http-library = neon`
> 
> 然后保存文件。这将解决您在使用 Codeplex 时遇到的问题。
> 
> 斯特凡

# c - 使用 OpenGL 和 GLFW 操作 C 数组

> ID：801954
> 
> 赞同：1
> 
> 时间：2009-04-29T11:37:28.080
> 
> 标签：c, opengl, glfw

我正在尝试构建一个应用程序来模拟一些移动的基本球体。

我面临的问题是，当我真正需要数据时，它看起来并没有被分配给 init 语句之外的数组。这与我声明包含粒子的数组的方式有关吗？

我想创建一个可以从各种方法访问的结构数组，因此在我使用的包含语句下方的文件顶部：

```
struct particle particles[];

// Particle types
enum TYPES { PHOTON, NEUTRINO };

// Represents a 3D point
struct vertex3f
{
    float x;
    float y;
    float z;
};

// Represents a particle
struct particle
{
    enum TYPES type;
    float radius;
    struct vertex3f location;
}; 
```

我有一个初始化方法，它创建数组并将粒子分配给它

```
void init(void)
{
    // Create a GLU quadrics object
    quadric = gluNewQuadric();
    struct particle particles[max_particles];

    float xm = (width / 2) * -1;
    float xp = width / 2;
    float ym = (height / 2) * -1;
    float yp = height / 2;

    int i;
    for (i = 0; i < max_particles; i++)
    {
        struct particle p;

        struct vertex3f location;
        location.x = randFloat(xm, xp);
        location.y = randFloat(ym, yp);
        location.z = 0.0f;

        p.location = location;
        p.radius = 0.3f;

        particles[i] = p;        
    }
} 
```

然后是一个draw方法里面的一个方法来绘制设定的场景

```
// Draws the second stage
void drawSecondStage(void)
{

    int i;

    for (i = 0; i < max_particles; i++)
    {
        struct particle p = particles[i];

        glPushMatrix();
        glTranslatef(p.location.x , p.location.y, p.location.z );
        glColor3f( 1.0f, 0.0f, 0.0f );
        gluSphere( quadric, 0.3f, 30, 30 );
        glPopMatrix();

        printf("%f\n", particles[i].location.x);
    }
} 
```

这是我的代码的副本[http://pastebin.com/m131405dc](http://pastebin.com/m131405dc)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T11:41:01.990

问题是这个定义：

```
struct particle particles[]; 
```

它不保留任何内存，只是定义一个空数组。您需要在这些方括号中添加一些内容。奇怪的是，您对这个数组中各个位置的所有写入都没有导致段错误崩溃......

您可以尝试使用`max_particles`，尽管我不确定`const`在 C 定义中使用变量（尽管是一个）是否合法。

经典的解决方案是使用预处理器，如下所示：

```
#define MAX_PARTICLES 50

struct particle particles[MAX_PARTICLES]; 
```

然后在各个循环中使用 MAX_PARTICLES。我建议将文字放在括号中：

```
struct particle particles[50]; 
```

然后像这样编写循环：

```
for(i = 0; i < sizeof particles / sizeof *particles; i++) 
```

这是一个编译时划分，所以它不会花费你任何东西，并且你正在重新使用定义本身来提供数组中的元素数量，这（IMO）很优雅。您当然可以采取一些中间方式并定义一个新的宏，如下所示：

```
#define MAX_PARTICLES  (sizeof particles / sizeof *particles) 
```

# jquery - 如何在提交输入字段时为每个关键字附加前缀？

> ID：801958
> 
> 赞同：1
> 
> 时间：2009-04-29T11:39:01.040
> 
> 标签：jquery, webforms

我有一个输入字段，当按下回车键时（因为没有提交字段），我希望 javascript 在提交表单时在每个关键字的前面添加 @ 字符。

### 例如：

文本将输入为...

*家，个人，电话*

但是提交的值将是......

*@home、@personal、@call*

### 到目前为止，我有：

```
$("#inputfield").keydown(function(e){
    如果（e.keyCode == 13）{
        $("#inputfield") // 不确定接下来要添加什么
        。提交（）;
    }

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T11:42:55.137

这应该可以解决问题：

```
$("#inputfield").keydown(function(e){
if (e.keyCode == 13) {
    $('#inputfield').val($('#inputfield').val().split(',').map(function(item) {
            return '@'+item;
         }).join(',')); 
    $(this).submit();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T11:44:41.807

您必须在空格处拆分字段的值，然后在每个数组值前面添加一个 @，然后将其添加回作为输入的值。另外我建议监听表单的提交事件，而不是输入字段中的回车键。

```
 $('#form').submit( function() {
   var words = $('#inputfield').val().split(' ');
   var newwords = new Array();
   for(i=0, x=words.length; i<x; i++){
    newwords.push('@'+words[i]);
   }
   $('#inputfield').val( newwords.join(' ') );
   //we do not return false because we want the form to submit
 }); 
```

# objective-c - 为什么变量的行为如此奇怪？

> ID：801959
> 
> 赞同：2
> 
> 时间：2009-04-29T11:40:08.153
> 
> 标签：objective-c, cocoa, memory-management, variables, object

我认为objective-c中的变量只是对内存中某个对象的引用。所以根据我的理解，结果一定是“一”，因为最后我将对象的内存地址str1分配给了str2，而之前我已经分配了str2的内存地址来测试。

```
NSString *str1 = [NSString stringWithCString:"one"];
NSString *str2 = [NSString stringWithCString:"two"];

test = str2; // test is an instance variable. I use no getter/setter here! just for testing!
str2 = str1;
NSLog(test); // = "two" ?? 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T11:48:01.130

这就是指针的工作方式。您看到的结果是正常且正确的。

让我们列出所有变量以及它们在声明时在内存中指向的字符串：

```
str1 -> "One"
str2 -> "Two" 
```

然后，您执行一些分配指令：

```
test = str2; 
```

这会将指针的值分配`str2`给`test`。所以指针是

```
str1 -> "One"
str2 -> "Two"
test -> "Two" 
```

然后

```
str2 = str1; 
```

将指针的值分配`str1`给`str2`。现在指针是

```
str1 -> "One"
str2 -> "One"
test -> "Two" 
```

然后你打印`test`，它指向`str2`最初指向的东西，即“二”。

我认为您认为，既然您分配`str2`了 的值`str1`和`test`的值`str2`，那么 的值就会以`str1`某种方式级联到`test`. 不是这种情况。一旦`test`'s 的值被分配，有关该值来自何处的信息就会丢失。如果您希望`test`' 的值与 ' 相同`str1`，则可以颠倒赋值操作的顺序：

```
str2 = str1;
test = str2; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T15:08:39.540

变量是一个容器。该作业将右侧的任何内容放入左侧的任何内容中。换句话说，它将值从一个变量复制到另一个变量；在这种情况下，这些值是指针（内存地址）。

所以这就是你所做的：

1.  取`str2`变量中的地址并将相同的地址放入`test`变量中。
2.  取`str1`变量中的地址并将相同的地址放入`str2`变量中。

第 2 步不影响`test`变量；您对该变量的唯一分配是在步骤 1 中。

重要提示：您不是在复制*地址中*的内容；您正在复制*地址本身*。仍然只有一个“two”字符串，但在第 1 步和第 2 步之间，该对象*的地址*在`str2`and`test`中。然后，在步骤 2 中，将 in`str2`中的地址替换为“one”字符串的地址，该地址也存在于 中`str1`，`test`作为唯一仍然保存“two”字符串地址的变量。

顺便说一句，`stringWithCString:`已弃用。使用`stringWithUTF8String:`或`stringWithCString:encoding:`代替。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T11:51:09.047

你有这个：

```
test = str2; // test is an instance variable.testing!
str2 = str1;
NSLog(test); // = "two" ?? 
```

现在，让我们假设所有这些变量都是整数。

在第一行， variable`test`设置为 variable 的值`str2`。在第二行， variable`str2`设置为 variable 的值`str1`。在第三行，我们打印出 的值`test`，这确实`str2`是我们分配`str2`给 test 时的值。`str2`我们随后分配了不同的值真的无关紧要。

好的，但是变量实际上是指针，你说，而不是整数。

没关系：将指针视为只是一个数字，即内存中某处的地址。并将其传递给 NSLog 使 NSLog 打印的不是指针的值，而是指针指向的值，它是一个 char 数组。

# powershell - 如何找到执行脚本的源路径？

> ID：801967
> 
> 赞同：64
> 
> 时间：2009-04-29T11:42:06.760
> 
> 标签：powershell, powershell-1.0

我希望能够知道我的执行脚本是从哪个路径运行的。
这通常不是 $pwd。

我需要调用与我的脚本相关的文件夹结构中的其他脚本，虽然我可以对路径进行硬编码，但在尝试从“开发”升级到“测试”时，这既令人反感，又有点让人头疼“生产”。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2011-08-08T16:35:39.357

最初由PowerShell 团队的[Jeffrey Snover](http://blogs.msdn.com/powershell/archive/2007/06/19/get-scriptdirectory.aspx)发布的无处不在的脚本（在[Skyler 的回答](https://stackoverflow.com/a/803314/712526)中给出）以及 Keith Cedirc 和 EBGreen 发布的变体都存在一个严重的缺陷——*代码是否报告您所期望的取决于您调用它的位置！*

**我下面的代码通过简单地引用脚本**范围而不是**父**范围来克服这个问题：

```
function Get-ScriptDirectory
{
    Split-Path $script:MyInvocation.MyCommand.Path
} 
```

为了说明这个问题，我创建了一个测试工具，它以四种不同的方式评估目标表达式。（括号中的术语是以下结果表的关键。）

1.  内联代码 [inline]
2.  内联函数，即主程序中的函数【内联函数】
3.  点源函数，即相同的函数移动到单独的 .ps1 文件 [点源]
4.  模块函数，即相同的函数移动到单独的 .psm1 文件 [模块]

最后两列显示了使用脚本作用域（即 $script:）或使用父作用域（使用 -scope 1）的结果。“脚本”的结果意味着调用正确地报告了脚本的位置。“模块”结果意味着调用报告了包含该函数的模块的位置，而不是调用该函数的脚本；这表明这两个函数都有一个缺点，即您不能将函数放入模块中。

撇开模块问题不谈，表中的显着观察是，**使用父作用域方法在大多数情况下都失败了**（实际上，成功率是成功率的两倍）。

![输入组合表](https://i.stack.imgur.com/O5p1m.png)

最后，这是测试车辆：

```
function DoubleNested()
{
    "=== DOUBLE NESTED ==="
    NestCall
}

function NestCall()
{
    "=== NESTED ==="
    "top level:"
    Split-Path $script:MyInvocation.MyCommand.Path
    #$foo = (Get-Variable MyInvocation -Scope 1).Value
    #Split-Path $foo.MyCommand.Path
    "immediate func call"
    Get-ScriptDirectory1
    "dot-source call"
    Get-ScriptDirectory2
    "module call"
    Get-ScriptDirectory3
}

function Get-ScriptDirectory1
{
    Split-Path $script:MyInvocation.MyCommand.Path
    # $Invocation = (Get-Variable MyInvocation -Scope 1).Value
    # Split-Path $Invocation.MyCommand.Path
}

. .\ScriptDirFinder.ps1
Import-Module ScriptDirFinder -force

"top level:"
Split-Path $script:MyInvocation.MyCommand.Path
#$foo = (Get-Variable MyInvocation -Scope 1).Value
#Split-Path $foo.MyCommand.Path

"immediate func call"
Get-ScriptDirectory1
"dot-source call"
Get-ScriptDirectory2
"module call"
Get-ScriptDirectory3

NestCall
DoubleNested 
```

ScriptDirFinder.ps1 的内容：

```
function Get-ScriptDirectory2
{
    Split-Path $script:MyInvocation.MyCommand.Path
#   $Invocation = (Get-Variable MyInvocation -Scope 1).Value
#   Split-Path $Invocation.MyCommand.Path
} 
```

ScriptDirFinder.psm1 的内容：

```
function Get-ScriptDirectory3
{
    Split-Path $script:MyInvocation.MyCommand.Path
#   $Invocation = (Get-Variable MyInvocation -Scope 1).Value
#   Split-Path $Invocation.MyCommand.Path
} 
```

我不熟悉 PowerShell 2 中引入的内容，但很可能是 PowerShell 1 中不存在脚本范围，当时 Jeffrey Snover 发布了他的示例。

当我发现他的代码示例在网络上广泛传播时，我感到很惊讶，但当我尝试时它立即失败了！但那是因为我使用它与 Snover 的示例不同（我不是在脚本顶部而是从另一个函数内部调用它（我的“嵌套两次”示例）。）

**2011.09.12 更新**

您可以在我刚刚在 Simple-Talk.com 上发表的文章中阅读有关模块的其他提示和技巧： [进一步深入兔子洞：PowerShell 模块和封装](http://www.simple-talk.com/dotnet/.net-tools/further-down-the-rabbit-hole-powershell-modules-and-encapsulation/)。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-10-09T23:44:38.280

您为 Powershell 1.0 版标记了您的问题，但是，如果您可以访问您知道的 Powershell 3.0 版`$PSCommandPath`，`$PSScriptRoot`这使得获取脚本路径更容易一些。有关详细信息，请参阅[此页面上的“其他脚本功能”部分。](https://technet.microsoft.com/en-us/library/hh847841.aspx)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-01T18:21:01.010

几年来，我们在大多数脚本中一直使用这样的代码，没有任何问题：

```
#--------------------------------------------------------------------
# Dot source support scripts
#--------------------------------------------------------------------
$ScriptPath = $MyInvocation.MyCommand.Path
$ScriptDir  = Split-Path -Parent $ScriptPath
. $ScriptDir\BuildVars.ps1
. $ScriptDir\LibraryBuildUtils.ps1
. $ScriptDir\BuildReportUtils.ps1 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-29T16:58:57.700

我最近遇到了同样的问题。以下文章帮助我解决了这个问题：http: [//blogs.msdn.com/powershell/archive/2007/06/19/get-scriptdirectory.aspx](http://blogs.msdn.com/powershell/archive/2007/06/19/get-scriptdirectory.aspx)

如果您对它的工作原理不感兴趣，这里是您在文章中需要的所有代码：

```
function Get-ScriptDirectory
{
$Invocation = (Get-Variable MyInvocation -Scope 1).Value
Split-Path $Invocation.MyCommand.Path
} 
```

然后您只需执行以下操作即可获得路径：

```
$path = Get-ScriptDirectory 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-29T13:41:41.900

我认为您可以使用找到运行脚本的路径

```
$MyInvocation.MyCommand.Path 
```

希望能帮助到你 ！

塞德里克

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T13:34:21.450

这是 PS 中的怪事之一（至少在我看来）。我敢肯定这是有充分理由的，但对我来说仍然很奇怪。所以：

如果您在脚本中但不在函数中，则 $myInvocation.InvocationName 将为您提供包括脚本名称在内的完整路径。如果你在一个脚本和一个函数中，那么 $myInvocation.ScriptName 会给你同样的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-30T21:27:37.297

谢谢msorens！这真的帮助了我的自定义模块。如果有人有兴趣自己制作，这就是我的结构。

```
MyModule (folder)
 - MyModule.psd1 (help New-ModuleManifest)
 - MyScriptFile.ps1 (ps1 files are easy to test) 
```

然后在 MyModule.psd1 中引用 MyScriptFile.ps1。引用 NestedModules 数组中的 .ps1 会将函数置于模块会话状态而不是全局会话状态。（[如何编写模块清单](http://msdn.microsoft.com/en-us/library/windows/desktop/dd878297%28v=vs.85%29.aspx)）

```
NestedModules = @('.\MyScriptFile.ps1','.\MyOtherScriptFile.ps1') 
```

MyScriptFile.ps1 的内容

```
function Get-ScriptDirectory {
    Split-Path $script:MyInvocation.MyCommand.Path
}

try {
    Export-ModuleMember -Function "*-*"
}
catch{} 
```

运行 MyScriptFile.ps1 时，try/catch 隐藏了 Export-ModuleMember 的错误

将**MyModule**目录复制到此处找到的路径之一**$env:PSModulePath**

```
PS C:\>Import-Module MyModule
PS C:\>Get-Command -Module MyModule

CommandType     Name                                               ModuleName                                                                                                                                                
-----------     ----                                               ----------                                                                                                                                                
Function        Get-ScriptDirectory                                MyModule 
```

# xml - 加载 XML 文件时从文本节点的内容中去除前导和尾随空格

> ID：801972
> 
> 赞同：3
> 
> 时间：2009-04-29T11:43:26.117
> 
> 标签：xml, apache-flex, flash, actionscript-3, whitespace

在 actionscript 3 中，当尝试加载 XML 文件时

```
<Element><Property> a </Property></Element> 
```

节点 "property" 中的值将只是*"a"*，删除尾随和前导空格。

我做了[http://bugs.adobe.com/jira/browse/ASC-3125](http://bugs.adobe.com/jira/browse/ASC-3125)推荐的，但没有成功。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T22:19:10.050

如前所述，XML.prettyPrinting 不起作用。最后它通过添加得到修复`XML.ignoreWhitespace = false;`

在该行代码之后，不会删除尾随空格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T14:26:50.687

我相信如果你把它放在 CDATA 标记中，你会得到空格。

```
<Element><Property><![CDATA[ a ]]></Property></Element> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T15:03:44.763

```
XML.prettyPrinting = false 
```

应该可以正常工作，这就是我用来解决这个确切问题的方法。但请注意，这是一个全局设置，可能会在您的应用程序的其他地方导致新的错误。

# c - 在 Objective-C 类中混合 C 函数

> ID：801976
> 
> 赞同：43
> 
> 时间：2009-04-29T11:44:42.730
> 
> 标签：c, objective-c, cocoa, callback

我正在编写一个 Objective-C 类，但它使用了一个用 C 编写的 API。这很好，因为将 C 调用与 Objective-C 调用混合会导致一些问题。

但是，其中一个 API 调用需要回调方法（示例）：

```
success = CFHostSetClient(host, MyCFHostClientCallBack, &context); 
```

`MyCFHostClientCallBack`像这样定义的 C 函数在哪里：

```
static void MyCFHostClientCallBack(CFHostRef host, CFHostInfoType typeInfo, const CFStreamError *error, void *info); 
```

1.  可以/我如何调用一个 Objective-C 方法来代替它？
2.  我可以/应该将 C 函数与我的 Objective-C 调用混合吗？
3.  如何将 C 函数与 Objective-C 方法混合使用？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-05-06T10:11:43.830

混合 C 和 Objective-C 方法和函数是可能的，这是一个在 iPhone 应用程序中使用 SQLite API 的简单示例：（[课程网站](http://stanford.edu/class/cs193p/cgi-bin/index.php)）

> 下载[Zip 文件 (09_MySQLiteTableView.zip)](http://stanford.edu/class/cs193p/cgi-bin/drupal/system/files/sample_code/09_MySQLiteTableView.zip)

C 函数需要`@implementation`在 Objective-C (.m) 文件的外部声明。

```
int MyCFunction(int num, void *data)
{
     //code here...
}

@implementation

- (void)MyObjectiveCMethod:(int)number withData:(NSData *)data
{
      //code here
}

@end 
```

因为 C 函数在它之外，所以`@implementation`它不能调用类似的方法

```
[self doSomething] 
```

并且无法访问 ivars。

只要回调函数采用`userInfo`or`context` 类型参数（通常为 type ），就可以解决此问题`void*`。这可用于将任何 Objective-C 对象发送到 C 函数。

正如在[示例代码](http://stanford.edu/class/cs193p/cgi-bin/drupal/system/files/sample_code/09_MySQLiteTableView.zip)中一样，这可以通过正常的 Objective-C 操作进行操作。

另外请阅读这个答案：[Mixing C functions in an Objective-C class](https://stackoverflow.com/questions/801976/mixing-c-functions-in-an-objective-c-class/802059#802059)

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-04-29T12:05:39.700

要从 C 回调调用 Objective-C 代码，我会使用类似的东西：

```
void * refToSelf;
int cCallback()
{
    [refToSelf someMethod:someArg];
}

@implementation SomeClass
- (id) init
{
     self = [super init];
     refToSelf = self;
}
- (void) someMethod:(int) someArg
{
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-01-17T18:18:19.160

> 可以/我如何调用一个 Objective-C 方法来代替它？

你不能。

> 我可以/应该将 C 函数与我的 Objective-C 调用混合吗？

是的。编写一个 C 函数并将其用作 CF 函数的回调。

> 如何将 C 函数与 Objective-C 方法混合使用？

您可以在上下文结构中设置`self`为`info`指针。这将被传递给回调。然后，在回调中，将`info`指针转换回`id`：

```
MyClass *self = (id)info; 
```

然后，您可以发送`self`消息。但是，您仍然不能直接访问实例变量，因为 C 函数在该`@implementation`部分之外。您必须使它们成为属性。您可以使用[类扩展](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/CustomizingExistingClasses/CustomizingExistingClasses.html)来做到这一点。（与该文档所说的相反，您不会在 内部声明扩展名`@implementation`，而是在与它相同的文件中声明扩展名，通常在其上方。）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-29T11:58:05.893

在这种情况下，我一直觉得有用的是在 C API 之上制作一个 Obj-C 包装器。使用 C 函数实现你需要的东西，并在其上构建一个（或两个）Objective-C 类，这样外部世界就会看到。例如，在这样的回调的情况下，您可能会创建一个 C 函数来调用其他对象上的 Obj-C 委托方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-09T08:13:59.923

`.m`内部调用函数`.c`：

*   `CrifanLib.h`

```
#ifndef CrifanLib_h
#define CrifanLib_h

#include <stdio.h>

void fileModeToStr(mode_t mode, char * modeStrBuf);

#endif /* CrifanLib_h */ 
```

*   `CrifanLib.c`

```
#include "CrifanLib.h"

#include <stdbool.h>

void fileModeToStr(mode_t mode, char * modeStrBuf) {
    // buf must have at least 10 bytes
    const char chars[] = "rwxrwxrwx";
    for (size_t i = 0; i < 9; i++) {
//        buf[i] = (mode & (1 << (8-i))) ? chars[i] : '-';
        bool hasSetCurBit = mode & (1 << (8-i));
        modeStrBuf[i] = hasSetCurBit ? chars[i] : '-';
    }
    modeStrBuf[9] = '\0';
} 
```

`Objective-C`由's调用`.m`：

```
#include “CrifanLib.h"

@interface JailbreakDetectionViewController ()

@end

@implementation JailbreakDetectionViewController
…

char* statToStr(struct stat* statInfo){
    char stModeStr[10];
    fileModeToStr(statInfo->st_mode, stModeStr);
...
}

... 
```

完毕。

# java - 用于 Web 应用程序设计的各种 Java 框架如何结合在一起

> ID：801977
> 
> 赞同：2
> 
> 时间：2009-04-29T11:44:51.433
> 
> 标签：java, jakarta-ee, frameworks, seam

我是 Java Web 应用程序开发的新手。到目前为止，我使用的只是普通的旧 servlet、jdbc 和 jsps。我开始阅读所有框架，但我完全困惑并迷失在一大堆框架中？所以这里有一些问题：

1.  EJB3 和 Hibernate 是竞争技术还是可以一起使用。
2.  如果我使用了 JBoss Seam，我是否还需要使用 Hibernate 来满足我的 ORM 需求，或者 Seam + EJB3 可以解决这个问题？
3.  如果我必须使用 JBoss Seam 开发 web 应用程序，我需要学习哪些典型框架？是以下部分还是全部：Seam (ofcourse) JSF EJB3 Hibernate Spring Inversion of control container
4.  我可以使用 JBoss Seam 在 JBoss Portal 上开发应用程序吗？

谢谢维卡斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T12:10:32.730

*1\. EJB3 和 Hibernate 是竞争技术还是可以一起使用。*

他们有相互竞争的 API（JPA 与 Hibernate 的 API 不同），但是 Hibernate 可以插入到 JPA 下，只是不要期望与为 Hibernate 编码的东西的互操作性 - 特别是 jBPM（3.2）即使在 Seam（2.1.1）下也不能完全互操作.

*2\. 如果我使用了 JBoss Seam，我是否还需要使用 Hibernate 来满足我的 ORM 需求，还是 Seam + EJB3 可以解决这个问题？*

正如我所理解的那样，你可以做任何一个。

*3\. 如果我必须使用 JBoss Seam 开发 web 应用程序，我需要学习哪些典型框架？是以下部分还是全部：Seam (ofcourse) JSF EJB3 Hibernate Spring Inversion of control container*

JSF——Seam 真正有意义的必要条件——我建议关注 facelets 作为创建 JSF 页面的主要方式。语法很好而且很熟悉——普通的旧命名空间限定 XHTML 与位于不同命名空间中的服务器端组件。完全微不足道和干净，不像我尝试过的其他任何东西。

EJB3 - 如果你喜欢，或者不喜欢，由你决定。以这种方式前进会将您拖入 Java EE，这仍然让我有些害怕，尽管它有很多好处。

休眠 - 如果您愿意，由您决定。JPA 实体管理器提供了替代方案。

Spring IoC，呃……是的，如果你喜欢，这又取决于你。Seam 负责有状态的会话和会话范围的 bean（通常是表示逻辑层的一部分），而 Spring 最适合无状态上下文，例如与数据库和任何 SOA 客户端等后端服务的接口。

我发现 Seam + JSF (facelets) + Hibernate + Spring 是通过 jBPM 创建 UI 以及用于交付内容页面的另一个项目的非常好的组合，尽管这并不是 Seam 的真正用途。

4.  我可以使用 JBoss Seam 在 JBoss Portal 上开发应用程序吗？

对不起，不能帮你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-13T11:31:09.343

Regarding question #4.

JBoss Seam can be used inside of JBoss Portal if a bridge is used.

There is currently a [JBoss Portlet Bridge](http://jboss.org/portletbridge/) project that is in CR stage and approaching release.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T15:20:09.043

1.  EJB3 和 Hibernate 是互补的技术。EJB3 定义了 JPA (API)，Hibernate 可以用作 JPA 的持久性提供者。

2.  您仍然需要使用持久性提供程序之一，它可能是 Hibernate、OpenJPA 等。

3.  JSF 和 EJB3。

4.  关于 Seam 和 Portal 开发：更好的问题是 JSF 和 Portal 协同工作的效果如何？

他们当然可以一起工作——这里有相关的教程：[使用 JSF、Ajax 和 Seam 开发 Portlet](http://www.infoq.com/articles/jsf-ajax-seam-portlets-pt-1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T12:45:42.003

1.  是和不是。EJB3（或者更确切地说是 JPA）是一种通过 Java5 注释声明 OR 映射以及查询它们的接口的规范。你仍然需要一个实现。Hibernate Annotations 将是映射的实现，而 Hibernate EntityManager 是查询接口的实现——它们使用“主要”Hibernate 来完成他们的工作。您应该能够混合和匹配这些 - 可以使用 JPA 注释，并使用 Hibernate 的 API，如 HQL 和 Criteria。
2.  取决于，主要取决于应用服务器。一个功能齐全的应用程序服务器可以为您处理 JPA 内容，您可以通过 web.xml 和 appserver 控制台进行配置。当然，这不包括混搭。不管应用程序服务器如何，您仍然可以自己滚动，以编程方式/使用 Spring/其他方式访问查询 API。
3.  JSF 是使用 Seam 的先决条件。至于 EJB3/JPA 与 Hibernate - 偏好问题。您不需要了解太多/任何 Hibernate 即可将其用作 JPA 实现。JPA 强烈基于 Hibernate 的 API，因此两者之间的差异可能相当小。Spring 并不是绝对必要的，JBoss 正在尽最大努力通过 Web Beans 获得一些市场份额。Seam 的某些功能与 Spring 的某些功能重叠。尽管 Spring 是高度模块化的，并且涵盖了很多内容，因此您应该能够挑选您想要的 Spring 功能。
4.  不会知道。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T14:02:46.687

JBoss Seam 是一个元框架，它结合了 EJB3 和 JSF 框架，并以依赖注入的形式包装它们。作为一种 J2EE 技术，您通常将其部署在应用程序服务器中——这就是 JBoss Portal 的用武之地。

JBoss Portal 是 JBoss 组织的商业产品。它将各种 J2EE 组件以“模块”的形式捆绑在一起，这些组件将包括 EJB3、JSF 和[JBoss Application Server](http://en.wikipedia.org/wiki/JBoss)。

查看[此链接](http://docs.jboss.com/seam/latest/reference/en-US/html/Book-Preface.html)，并滚动到底部以了解 Seam 和 Portal 的组合位置。Portal 站点描述了它提供的模块（我假设它们附带一个定价模型），Seam 支持由[Portlet 模块](http://www.jboss.com/products/platforms/portals/platformcomponents/)提供。

# sql-server - 使用存储过程将数据插入 varchar 字段时出现问题

> ID：801978
> 
> 赞同：0
> 
> 时间：2009-04-29T11:45:30.683
> 
> 标签：sql-server, db2

我正在将一些数据从 DB2 上传到 SQL2005。该表包含一个文本字段，在 DB2 中长度为 2000 个字符，但在 SQL 中设置为 varchar(2000)。

当我在查询浏览器中运行我的插入时，它处理得很好并且数据被正确复制，但是当相同的语句在我的存储过程中运行时，该字段的数据仅被错误地复制并显示为一系列奇怪的字符。

该字段有时可能包含控制字符，但即使不包含控制字符也会出现问题。

是否需要将设置应用于我的存储过程才能使插入正常工作？

或者我是否需要对数据使用强制转换或转换才能使其正确显示。

谢谢。

更新：感谢您的建议。现在看来问题是由我们用来创建包含 DB2 数据库的链接服务器的软件引起的。当通过存储过程运行时，这无法处理 2000 个字符长的字段，但在交互运行时可​​以。

我最终解决了这个问题，将字段拼接成 10 200 个字符长的字段以供上传，然后当它们在 SQL 数据库中时再次重新加入它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T11:55:31.300

听起来来自 db2 的数据是在不同的字符集中。您应该确保它不是 EBCDIC 或类似的东西。

此外，尝试从 SQL Server Management Studio（查询浏览器）调用您的存储过程，看看它是否可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T19:43:21.500

您可能希望将 varchar(2000) 更改为 nvarchars(2000) （在存储过程和表中 - 我假设它作为参数存在）。这将允许它们保存两个字节字符。这将取决于 DB2 配置，但可能是它正在导出 UTF-16（或类似的）而不是 UTF-8。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-09T13:03:22.067

这个问题是由我们用来创建到 DB2 数据库的链接服务器的第 3 方软件引起的。当通过存储过程运行时，这无法处理 2000 个字符长的字段，但在交互运行时可​​以。

我最终解决了这个问题，将字段拼接成 10 200 个字符长的字段以供上传，然后当它们在 SQL 数据库中时再次重新加入它们。

# asp.net - 在 ASP.NET 中，什么条件会导致 OnServerClick="foo" 失败，从而永远不会调用 "foo()"？

> ID：801981
> 
> 赞同：1
> 
> 时间：2009-04-29T11:46:36.453
> 
> 标签：asp.net

我编写了一个在数千个站点上运行的 ASP.NET 应用程序。但至少在一个站点，以下代码失败：

```
void foo(Sender o, EventArgs e)  
{
    ....
}

<input runat="server" ....  OnServerClick="foo" ... 
```

您是否经历过 OnServer 事件失败？我在这个站点上进行了实验，但无法得出导致它失败的确切魔法，但是 IIS Windows 身份验证可能是相关的，或者这行代码可能是相关的，基于打开和关闭，注释掉：

```
void Page_Init (object sender, EventArgs e) {ViewStateUserKey = Session.SessionID;} 
```

但是这些东西有什么关系呢？再一次，同样的代码在成千上万的其他站点上工作。

那么，您是否遇到过由代码之外的设置或条件触发的 OnServer 事件失败？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T11:50:17.927

AutoEventWireUp="false" 在页面指令中，在 web.config 中设置或在 machine.config 中设置机器范围

False = 事件不会自动绑定。

其他可能性：EnableViewState 设置或 Viewstate 在传输中被剥离/损坏。

[配置中的 MachineKey 设置和加密视图状态的组合](http://msdn.microsoft.com/en-us/library/ms998288.aspx)

临时 ASP.Net 文件可能已损坏

未修补/错误的 .net 运行时

可能会从 machine.config 开始

# emacs - 如何在 Emacs 中使用 astyle？

> ID：801983
> 
> 赞同：11
> 
> 时间：2009-04-29T11:46:47.623
> 
> 标签：emacs

我正在使用具有以下规格的 windows emacs。

***2009-02-26 的 GNU Emacs 23.0.91.1 (i386-mingw-nt5.1.2600)***

我希望能够运行 astyle 以便它可以通过使用键盘命令或菜单重新格式化代码。emacs 中的其他等价物是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-29T14:00:40.717

这样的事情可能会做：

```
(defun astyle-this-buffer (pmin pmax)
  (interactive "r")
  (shell-command-on-region pmin pmax
                           "astyle" ;; add options here...
                           (current-buffer) t 
                           (get-buffer-create "*Astyle Errors*") t)) 
```

这将在选定区域上运行“astyle”命令。

或者，您可以通过键入类似的内容来简单地使用 emacs 的内置代码格式

```
 C-x h C-M-\ 
```

（即选择整个缓冲区并运行`indent-region`）

# sql - SQL `LIKE` 复杂度

> ID：801984
> 
> 赞同：2
> 
> 时间：2009-04-29T11:46:54.237
> 
> 标签：sql, database, complexity-theory, sql-like

有谁知道`LIKE`最流行数据库的 SQL 运算符的复杂性是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-29T11:54:51.830

让我们分别考虑三个核心案例。这个讨论是特定于 MySQL 的，但也可能适用于其他 DBMS，因为索引通常以类似的方式实现。

**`LIKE 'foo%'`如果在索引列上运行，速度很快。**MySQL 索引是 B 树的变体，因此在执行此查询时，它可以简单地将树下降到对应于 的节点`foo`，或具有该前缀的第一个节点，然后向前遍历树。所有这些都非常有效。

**`LIKE '%foo'`不能通过索引加速，会导致全表扫描。**如果您有其他可以使用索引执行的条件，它只会扫描初始过滤后剩余的行。

*但是有一个技巧*：如果您需要进行后缀匹配 -`.foo`例如搜索带有扩展名的文件名 - 您可以通过添加与原始内容相同但字符顺序相反的列来实现相同的性能。

```
ALTER TABLE my_table ADD COLUMN col_reverse VARCHAR (256) NOT NULL;
ALTER TABLE my_table ADD INDEX idx_col_reverse (col_reverse);
UPDATE my_table SET col_reverse = REVERSE(col); 
```

搜索以then`col`结尾的行`.foo`变成：

```
SELECT * FROM my_table WHERE col_reverse LIKE 'oof.%' 
```

**最后，还有`LIKE '%foo%'`，没有捷径。**如果没有其他限制标准可以将行数减少到可行的数量，则会导致严重的性能损失。您可能需要考虑使用全文搜索解决方案，或者其他一些专门的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T11:48:24.483

取决于 RDBMS、数据（可能还有数据的大小）、索引以及 LIKE 的使用方式（带或不带前缀通配符）！

你问的问题太笼统了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T11:50:52.853

如果您询问性能影响：

like 的问题是它使数据库无法使用索引。在 Oracle 上，我认为它不再使用索引（但我仍在使用 Oracle 9）。如果通配符仅在末尾，则 SqlServer 使用索引。我不知道其他数据库。

# java - Java 多线程和安全发布

> ID：801993
> 
> 赞同：45
> 
> 时间：2009-04-29T11:49:42.887
> 
> 标签：java, multithreading, safe-publication

在阅读了《[Java 并发实战](http://jcip.net/)》和《[OSGI 实战](http://neilbartlett.name/blog/osgibook/)》之后，我发现一个特定的主题非常有趣；安全出版。以下来自JCIP：

> 为了安全地发布对象，对象的引用和对象的状态必须同时对其他线程可见。正确构造的对象可以通过以下方式安全地发布：
> 
> *   *从静态*初始化程序初始化对象引用。
> *   将对它的引用存储到*volatile*字段中。
> *   将对它的引用存储到*最终*字段中。
> *   将对它的引用存储到由（*同步*）锁正确保护的字段中。

我的第一个问题：有多少 Java 开发人员知道这个（问题）？有多少真实世界的 Java 应用程序真正遵循这一点，这真的是一个真正的问题吗？我有一种感觉，99% 的已实现 JVM 并不那么“邪恶”，即不能保证线程（实际上它实际上（几乎）“不可能”）看到陈旧的数据，因为引用没有遵循上面的“安全出版成语”。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-29T15:21:11.710

按比例来说，可以说很少有程序员充分理解同步和并发。谁知道现在有多少服务器应用程序管理金融交易、医疗记录、警察记录、电话等，这些应用程序充满了同步错误并且基本上是偶然工作的，或者非常偶尔会失败（从未听说有人得到幻影电话计入他们的电话费？）的原因从未真正调查过或深究。

对象发布是一个特殊的问题，因为它经常被忽略，并且它是编译器进行优化的地方，如果你不知道它可能会导致意外行为：在 JIT 编译的代码中，存储一个指针，然后增加它并存储数据是一件非常合理的事情。你可能认为它是“邪恶的”，但在低层次上，它确实是你期望的 JVM 规范的样子。（顺便说一句，我听说在 JRockit 中运行的实际程序遇到了这个问题——这不是纯粹的理论问题。）

如果您知道您的应用程序存在同步错误，但在当前硬件上的当前 JVM 中没有出现异常行为，那么 (a) 恭喜；(b) 现在是时候开始“从容地走向消防通道”，在需要升级太多组件之前修复代码并教育程序员。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-29T16:14:10.473

“这真的是一个真正的问题吗？”

是的，一点没错。即使是最简单的 Web 应用程序也必须面对与并发相关的问题。例如，Servlet 由多个线程访问。

另一个问题是线程和并发很难正确处理。这几乎太难了。这就是为什么我们看到像事务内存这样的趋势出现的原因，以及像 Clojure 这样的语言有望使并发更容易处理。但在这些成为主流之前，我们还有很长的路要走。因此，我们必须用我们所拥有的做到最好。阅读 JCiP 是一个很好的开始。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-29T11:58:20.793

首先，“安全发布”并不是真正的成语（IMO）。它直接来自语言。

曾出现过不安全发布问题的案例，例如使用 NIO。

大多数 Java 代码都写得很糟糕。线程代码显然比一般的业务线代码更难。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-29T13:32:47.320

这不是“邪恶”的问题。这**是**一个真正的问题，并且随着未来几年多核架构的兴起将变得更加明显。由于不正确的同步，我看到了非常真实的生产错误。为了回答您的另一个问题，我想说很少有程序员意识到这个问题，即使在其他“优秀”的开发人员中也是如此。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T12:04:53.727

我会说很少有程序员能解决这个问题。您看到的最后一个使用 volatile 关键字的代码示例是什么时候？但是，大多数其他有条件的提到 - 我只是理所当然地认为是最佳实践。

如果开发人员完全忽略了这些条件，他们很快就会遇到多线程错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T13:46:54.883

我的经验（在许多不同类型的环境中进行短期和咨询我见过的大多数应用程序）都同意这种直觉 - 我从未见过一个完整的系统结构清晰，可以仔细管理这个问题（嗯，我也几乎从未见过清晰架构的整个系统）。我曾与极少数对线程问题有深入了解的开发人员合作过。

特别是对于网络应用程序，您通常可以侥幸逃脱，或者至少似乎可以侥幸逃脱。如果你有基于 spring 的实例来管理你的对象创建和无状态 servlet，你通常可以假装没有同步这样的东西，这就是很多应用程序最终的结果。最终有人开始将一些共享状态放在它不属于的地方，3 个月后有人注意到一些奇怪的间歇性错误。对于许多人来说，这通常“足够好”（只要您不编写银行交易）。

有多少 Java 开发人员知道这个问题？很难说，因为这在很大程度上取决于你在哪里工作。******