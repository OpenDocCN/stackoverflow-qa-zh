# StackOverflow 问答 11227000-11227999

# sql - LLBLGen 查看生成的 SQL 语句

> ID：11227000
> 
> 赞同：1
> 
> 时间：2012-06-27T13:09:49.607
> 
> 标签：sql, sql-server-2008, llblgenpro, llblgen

我正在使用 LLBLGen 访问使用 LLBLGen 运行时框架的 SQL Express 数据库。使用 Visual Studio 2010。

我已经创建了一个谓词表达式，但是它似乎没有做我认为应该做的事情，我如何查看发送到数据库的生成的 SQL？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:29:37.617

对于 2.6：

[http://www.llblgen.com/documentation/2.6/hh_start.htm](http://www.llblgen.com/documentation/2.6/hh_start.htm)

您将需要使用 ORMPersistenceExecution 开关。

如果是另一个版本，所有文档都可以在这里找到：

[http://www.llblgen.com/documentation/](http://www.llblgen.com/documentation/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T14:48:01.673

您可以启用内置跟踪，您可以像这样配置它（该值是日志级别阈值）：

```
<system.diagnostics>
    <switches>
        <add name="SqlServerDQE" value="3" />
        <add name="AccessDQE" value="4" />
        <add name="OracleDQE" value="4" />
        <add name="FirebirdDQE" value="4" />
        <add name="MySqlDQE" value="4" />
        <add name="DB2DQE" value="4" />
        <add name="PostgreSqlDQE" value="4" />
        <add name="SybaseAsaDQE" value="4" />
        <add name="SybaseAseDQE" value="4" />
        <add name="ORMGeneral" value="0" />
        <add name="ORMStateManagement" value="0" />
        <add name="ORMPersistenceExecution" value="3" />
        <add name="LinqExpressionHandler" value="3" />
    </switches>
</system.diagnostics> 
```

如果您正在进行大量开发/调试，我还可以建议您使用探查器：

[http://www.ormprofiler.com/](http://www.ormprofiler.com/)（作者：Frans Bouma）

[http://llblgenprof.com/](http://llblgenprof.com/) (by Ayende)

# ssrs-2008 - ssrs-2008 的布局问题

> ID：11227001
> 
> 赞同：4
> 
> 时间：2012-06-27T13:09:59.560
> 
> 标签：ssrs-2008, dynamics-crm-2011

我在 ssrs-2008 中创建的基于 fetch xml 的 CRM 2011 自定义发票报告的布局方面遇到了一些问题。

一个数据集可以包含多张发票。详细信息包含在父组上，按发票编号分组。发票标题位于组标题行中的一个矩形中，并重复以获取所有页面上的报表标题。发票页脚位于组页脚行中的一个矩形中。父组后面有一个分页符，以确保每张发票都从一个新页面开始。到目前为止，一切都很好...

我现在的问题是发票页脚必须放在最后一页的底部，并且细节只能有一定的高度。如果超出高度，则必须在下一页继续。有什么方法可以在 ssrs-2008 中实现这一目标？

我已经尝试过使用详细信息中的行数，但由于行高是动态的（发票行描述可能需要多个文本行），这将不起作用。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-25T06:37:42.840

您想限制每页的行数吗？如果是，请按照以下步骤操作，

1]转到表的属性

2]转到组选项卡并添加组（将此组放在所有其他现有组的顶部）

3] 添加表达式 =Ceiling((RowNumber(Nothing))/15) （15 将是每页的行数。）

4]检查最后的分页符并取消选中包括组页眉和包括组页脚复选框。

# python - z3 (py) smt-lib2 输出

> ID：11227004
> 
> 赞同：3
> 
> 时间：2012-06-27T13:10:08.437
> 
> 标签：python, z3, smt

如何以 SMT-LIB2 格式输出使用 z3py 所做的断言？我在文档中找不到任何提及。我找到了一个标志`Z3_PRINT_SMTLIB_FULL`，但我不知道如何设置它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T15:43:42.697

您可以使用方法 sexpr()。例如： [http ://rise4fun.com/Z3Py/9t](http://rise4fun.com/Z3Py/9t)

```
x, y = Reals('x y')
print (x + y * 3).sexpr() 
```

有 Python API 的在线文档。例如， sexpr() 方法记录在：

[http://research.microsoft.com/en-us/um/redmond/projects/z3/z3.html#ExprRef](http://research.microsoft.com/en-us/um/redmond/projects/z3/z3.html#ExprRef)

# salesforce - Salesforce 错误 保存此记录时工作流或批准字段更新导致错误

> ID：11227008
> 
> 赞同：-1
> 
> 时间：2012-06-27T13:10:22.373
> 
> 标签：salesforce

我有一个名为 application 的对象。我正在尝试更新该对象的所有记录，当时它抛出错误消息“保存此记录时工作流或批准字段更新导致错误。请联系您的管理员解决它。部门未定义：[]”。为什么我收到此错误？具有一些带有字段更新操作的工作流规则的应用程序对象。我正在尝试用 abc 字段更新 xyz 字段。abc 是一个公式字段，它返回值为 null。我正在使用 null 更新 xyz 字段，我认为只有我收到此错误的原因。这是否正确，如果正确，如何解决此问题。请告诉我。

谢谢，维诺德。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T03:29:22.143

鉴于返回的错误，并且缺少提供的信息，我最好的猜测是您正在除以 NULL，除以 0，或者您正在引用一个名为的字段，该字段`Division`不存在。在后者的情况下，也许你失踪了`__c`？

无论哪种方式，如果在这种情况下不提供更多详细信息，您将不可能得到特别有用的答案。

# web-services - tns：尝试连接到 SOAP Web 服务时包含错误

> ID：11227010
> 
> 赞同：1
> 
> 时间：2012-06-27T13:10:33.507
> 
> 标签：web-services, soap, xsd

我有一个外部 Web 服务：`http://188.254.16.92:7777/gateway/services/SID0003022?WSDL` 当我尝试连接到它时（通过使用 XML Spy 或 Informatica Powercenter），我收到一个错误：

```
File http://188.254.16.92:7777/gateway/services/SID0003022?WSDL is not valid.
    File http://188.254.16.92:7777/gateway/services/SID0003022/N1503900007/SID0003022/P48559386/OwsmImport.xsd is not valid.
        Invalid XML schema: ''tns:Include' is already declared in schema document 'http://188.254.16.92:7777/gateway/services/SID0003022/P1139237197/SID0003022/N1503900007/SID0003022/P48559386/OwsmImport.xsd'.'
            Error location: xs:schema / xs:element 
```

据我所知，xsd-schema 没有问题。我对这个话题很陌生，所以如果这个问题很愚蠢，我深表歉意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:08:36.790

看起来好像从不同的位置两次引用了架构：

/N1503900007/SID0003022/P48559386/OwsmImport.xsd

和

/P1139237197/SID0003022/N1503900007/SID0003022/P48559386/OwsmImport.xsd

如果是这种情况，那么服务 wsdl 就存在问题，尽管在没有看到 wsdl 的情况下无法进一步确认。

# java - JAXB。通过两个 xsd 验证 XML

> ID：11227012
> 
> 赞同：2
> 
> 时间：2012-06-27T13:10:37.397
> 
> 标签：java, jakarta-ee, jaxb

是否可以在通过两个 xsd 解组时验证 xml？我知道您通过执行以下操作将 xml 解组为具有多个上下文的对象：

```
context = JAXBContext.newInstance("onepackagecontext:secondpackagecontext"); 
```

我可以使用一种模式进行验证：

```
unmarshaller.setSchema(getSchema(url)); 
```

我该怎么做才能使用两个 XSD 进行验证？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T18:30:43.467

你可以这样做：

```
final InputStream isMain = this.getClass().getResourceAsStream( "/real.xsd" );

final InputStream isImport=
    this.getClass().getResourceAsStream( "/import.xsd" );

final InputStream isInclude =
    this.getClass().getResourceAsStream( "/include.xsd" );

final Source include = new StreamSource( isInclude );
final Source imp = new StreamSource( isImport );
final Source main = new StreamSource( isMain  );

final Source[] schemaFiles = new Source[] {
    include, imp, main
};

final SchemaFactory sf = SchemaFactory.newInstance( XMLConstants.W3C_XML_SCHEMA_NS_URI );
final Schema schema = sf.newSchema( schemaFiles );

final JAXBContext jc =
    JAXBContext.newInstance( YourJaxb.class );

final Unmarshaller unmarshaller = jc.createUnmarshaller();

final JAXBElement<YourJaxb> jaxbElement =
    unmarshaller.unmarshal( 
        YourJaxb.class );

final JAXBSource source = new JAXBSource( jc, jaxbElement.getValue() );
final ValidationErrorHandler val = new ValidationErrorHandler();
final Validator validator = schema.newValidator();
validator.setErrorHandler( val );
validator.validate( source ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T13:41:57.790

我看不出这应该起作用的原因。如果两个模式之间没有关系，这可能会出现问题
如果您看一下从 XSD 生成 Java 类的示例 - 如果您向生成器提供两个不相关的 XSD，则可能会导致尝试创建多重继承和问题像那样。我怀疑您在这里可能有一些糟糕的设计
我建议您重新访问这些模式，看看如何将它们统一到一个能够满足您需求的模式中。

# facebook - 带有 FB 应用程序的网页在 Mac（Safari 和 FF）上完全为空（空白），尽管在 PC 上可以（包括 Safari）

> ID：11227016
> 
> 赞同：1
> 
> 时间：2012-06-27T13:10:51.080
> 
> 标签：facebook, macos

有谁知道，为什么申请

[https://www.facebook.com/balconi.cz/app_329635017093632](https://www.facebook.com/balconi.cz/app_329635017093632) 或 [https://apps.facebook.com/posli-dortik-balconi/](https://apps.facebook.com/posli-dortik-balconi/)

不是在 Mac OS 上查看？那里完全是空白页。

它在 Safari 和 Mac 上的 FF 上都不起作用。但在 PC 上所有常见的浏览器都可以，包括 Safari。

编辑：我在那里没有使用任何闪光灯，所以闪光灯不是原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:49:48.183

它在 Windows 上也不适用于我。

那是因为您试图在 iframe 中显示身份验证对话框——Facebook 不允许这样做（除非您已经拥有访问令牌并在对话框 URL 中提供它）。他们发送一个 HTTP 响应标头，说明此页面不应显示在 iframe 内，现代浏览器尊重该标头。

使用 JavaScript 将顶部窗口重定向到身份验证对话框的地址：

```
top.location.href = "…{url}…"; 
```

# python - 在小部件内填充字段/生成值的正确方法

> ID：11227022
> 
> 赞同：1
> 
> 时间：2012-06-27T13:11:16.497
> 
> 标签：python, tkinter

所以我有一个 Tkinter 小部件，它可以在线抓取结果。我希望它向小部件输出一些值，而不是 Python IDLE 控制台。我该怎么做？我会以编程方式/动态设置标签吗？我查找的每个示例都是如何将内容最初放入条目小部件中，这不是我想要的。

例如，假设您有一个小部件框

```
----------
[        ]
[ Search ]
[        ]
[ Output ]
---------- 
```

每当我单击搜索时，我都希望输出值显示在输出部分。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T16:23:20.300

You can modify the contents of a label with the `configure` method. For example:

```
import Tkinter as tk
import time

class SampleApp(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)
        self.button = tk.Button(self, text="Show time", command=self.on_show_time)
        self.label = tk.Label(self)
        self.button.pack()
        self.label.pack()

    def on_show_time(self):
        self.label.configure(text=time.asctime())

app = SampleApp()
app.mainloop() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:40:21.583

当然可以。您可以设置一个变量来保存 Tkinter 标签的值。使用该变量，您可以随时调用 .get() 和 .set() 对其进行更改。

下面是一个简单的例子，它只是用 time.time() 的当前值更新标签

```
import Tkinter
import time

class DynamicLabelExample(Tkinter.Frame):
   def __init__(self, parent):
      Tkinter.Frame.__init__(self, parent)
      self.pack()
      Tkinter.Button(self, text="Search", command=self.update_output).pack()
      self.output_container = Tkinter.StringVar()
      Tkinter.Label(self, textvariable=self.output_container).pack()

   def update_output(self):
      self.output_container.set(time.time())

root = Tkinter.Tk()
ex = DynamicLabelExample(root)
root.mainloop() 
```

`self.output_container`是我们每次按下按钮时都会操作的 Tkinter StringVar。

[资源](http://effbot.org/tkinterbook/label.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T13:23:16.407

是的，你会在 gui 中设置一个标签。您可以使用`text=StringVar`. 您拥有的变量在哪里`StringVar`，当您更改 的值时`StringVar`，它会更改标签的值。此外，`StringVar`必须是一个`tkinter` `stringvar`对象。

# javascript - twitter bootstrap popover 插件错误 - this.isHTML 不是函数

> ID：11227023
> 
> 赞同：1
> 
> 时间：2012-06-27T13:11:18.130
> 
> 标签：javascript, jquery, twitter-bootstrap, popover

我直接从他们的页面复制了示例：

[http://jsfiddle.net/D2RLR/631/](http://jsfiddle.net/D2RLR/631/)

...我收到以下错误：

```
this.isHTML is not a function
[Break On This Error]       
$tip.find('.popover-title')[this.isHTML(title) ? 'html' : 'text'](title) 
```

有什么想法吗？

这是我导入 JS 文件的顺序：

```
 <script type="text/javascript" language="javascript" src="../Scripts/jquery.validate.js"></script>
    <script type="text/javascript" language="javascript" src="../Scripts/lib/bootstrap-modal.js"></script>
    <script type="text/javascript" language="javascript" src="../Scripts/lib/bootstrap-typeahead.js"></script>
    <script type="text/javascript" language="javascript" src="../Scripts/lib/bootstrap-alert.js"></script>
    <script type="text/javascript" language="javascript" src="../Scripts/lib/bootstrap-tooltip.js"></script>
    <script type="text/javascript" language="javascript" src="../Scripts/lib/bootstrap-tab.js"></script>        
    <script type="text/javascript" language="javascript" src="../Scripts/lib/bootstrap-datepicker.js"></script>
    <script type="text/javascript" language="javascript" src="../Scripts/lib/bootstrap-popover.js"></script>
    <script type="text/javascript" language="javascript" src="../Scripts/lib/date.js"></script>  
    <script type="text/javascript" language="javascript" src="../Scripts/lib/knockout-2.1.0.js"></script> 
    <script type="text/javascript" language="javascript" src="../Scripts/lib/knockout.mapping.js"></script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:38:54.950

`bootstrap-tooltip.js`之前加载`bootstrap-popover.js`它会起作用：

[http://jsfiddle.net/jyN9H/](http://jsfiddle.net/jyN9H/)

那是因为`popover`扩展了 BOOTSTRAP-TOOLTIP.js。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T22:36:19.423

我遇到了同样的问题，并且使用的是 bootstrap-tooltip v 2.0.2 而不是较新的 v 2.0.4。升级到 2.0.4 就成功了。谢谢亚当。

# mysql - 如何在codeigniter中搜索文本？

> ID：11227025
> 
> 赞同：0
> 
> 时间：2012-06-27T13:11:28.410
> 
> 标签：mysql, codeigniter, search, activerecord

我正在尝试在我的网站上实现搜索表单。

使用 codeigniter 活动记录和 mysql 我在我的模型中执行以下功能：

```
$search_query = 'charge fees for project';

    function get_search_results($search_query){
            $data = '';

            $this->db->like('title', $search_query);
            $this->db->or_like('content', $search_query);               

            $query = $this->db->get('faq'); 

            foreach ($query->result() as $row) {
                $data[] = array(
                    'id' => $row->id,
                    'category' => $row->category,
                    'sub_category' => $row->sub_category,
                    'title' => $row->title,
                    'content' => $row->content,
                    'date' => $row->date
                );
            }

            return $data;
    } 
```

在我的数据库中，我有一行包含以下数据：

```
row->title - What fees does the website charge?
row->content - We charges total fees. When your account is successfully project created. 
```

即使标题和内容中都存在这些关键字，我的搜索查询也不会返回任何结果。我怎样才能让我的搜索查询来挑选数据库条目中的关键字并返回结果？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:50:27.883

您应该在运行查询之前拆分`search_query`变量：

```
$search_query_values = explode(' ', $search_query);
$counter = 0;
foreach ($search_query_values as $key => $value) {
    if ($counter == 0) {
        $this->db->like('title', $value);
    }
    else {
        $this->db->or_like('title', $value);
        $this->db->or_like('content', $value);
    }
    $counter++;
}
$query = $this->db->get('faq'); 
```

我建议使用`LIKE`only with`word%`来提高性能。编码：

`$this->db->like('title', $value, 'after');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:32:48.817

小心使用本说明

```
$this->db->like('title', $search_query); 
```

您缺少在第三个参数中提供 after 或 before 。默认情况下它会这样做。%my_string% 阅读用户指南。

[http://codeigniter.com/user_guide/database/active_record.html](http://codeigniter.com/user_guide/database/active_record.html)

# mysql - 将标签附加到 SELECT 上的 * 列

> ID：11227026
> 
> 赞同：0
> 
> 时间：2012-06-27T13:11:28.697
> 
> 标签：mysql, database

对于一列，它很简单：

```
SELECT myColumn as 'My super sweet column', yourColumn FROM myTable;
# Results in:
# +-----------------------+------------+
# | My super sweet column | yourColumn |
# +-----------------------+------------+
# |                     1 |          0 |
# +-----------------------+------------+ 
```

我将如何实现...？

```
SELECT * as 'Random_'* FROM myTable;
# To result in:
# +-----------------+-------------------+
# | Random_myColumn | Random_yourColumn |
# +-----------------+-------------------+
# |               1 |                 0 |
# +-----------------+-------------------+ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:15:08.423

没有合理的方法可以做你想做的事。您必须列出所有列名及其别名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T13:36:07.430

运行以下命令：

```
show columns from yourTable; 
```

此查询的结果集的每一行代表一列，此结果集的第一列是列名。知道了这一点，您可以顺序处理表的列并获取表的列的名称。使用表列的名称，您可以生成查询。

如果要为所有运行的表生成这种查询

```
show tables; 
```

并处理从 yourTable 命令运行显示列的每个表（将 yourTable 替换为表名）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T13:35:48.483

您*可以*使用[信息架构表](http://dev.mysql.com/doc/en/information-schema.html)来创建手动重命名每列的查询：

```
SELECT CONCAT('SELECT ', GROUP_CONCAT(
         '`',        REPLACE('`', '``', COLUMN_NAME), '` AS
          `Random_', REPLACE('`', '``', COLUMN_NAME), '`'
       ), ' FROM myTable') INTO @qry
FROM   INFORMATION_SCHEMA.COLUMNS
WHERE  TABLE_SCHEMA = 'myDB' AND TABLE_NAME = 'myTable'; 
```

此时，`@qry`包含字符串（除了我为可读性添加的空格）：

```
SELECT `myColumn`   AS `Random_myColumn`,
       `yourColumn` AS `Random_yourColumn`
FROM   myTable 
```

然后可以[准备](http://dev.mysql.com/doc/en/sql-syntax-prepared-statements.html)执行：

```
PREPARE stmt FROM @qry; 
```

执行：

```
EXECUTE stmt; 
```

最后解除分配：

```
DEALLOCATE PREPARE stmt; 
```

但是，您正在寻求这样做的事实*表明*您的应用程序不知道的模式`myTable`（即它是动态的）。这*通常是*不好的做法，并且可能表明您需要[规范化](http://en.wikipedia.org/wiki/Database_normalization)数据结构。

此外，我不太明白为什么结果集中的列名对您很重要，因为您的应用程序可以根据需要引用它们？

# javascript - jquery/javascript 查找触发动作的元素

> ID：11227027
> 
> 赞同：0
> 
> 时间：2012-06-27T13:11:31.603
> 
> 标签：javascript, jquery, javascript-events

任何建议如何 console.log 触发悬停动作的元素？这仅用于调试我在 iOS 上的奇怪行为。

我不需要查找执行操作的项目，而是执行操作的人员。例如，在一个简单的鼠标悬停上，我想 console.log 鼠标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:15:21.287

使用本机 javascript，在`window.event`事件触发时填充对象，并且`event.srcElement`将为您提供触发事件的 DOM 对象。

使用 jQuery，`this`事件处理程序中的引用也会为您提供处理事件的 DOM 对象。

这些都不会告诉您这`mouseover`是由鼠标触发的，但它们会给出所涉及的 DOM 元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:15:13.333

如果是鼠标悬停，只需检查“originalEvent”：

```
$('div').mouseover(function(event){
   console.log(event.originalEvent);
});​ 
```

如果您的函数中只有事件，最好检查它是否是鼠标悬停：

```
if(event.type=="mouseover"){
    console.log(event.originalEvent);
} 
```

[请参阅此处](http://jsfiddle.net/Yy6bP/2/)的 jsfiddle 。

# c# - 从正在拖动鼠标的画布中删除内容

> ID：11227031
> 
> 赞同：0
> 
> 时间：2012-06-27T13:11:41.063
> 
> 标签：c#, canvas, windows-8, microsoft-metro, windows-runtime

我正在开发一种类似于地铁风格的油漆应用程序。我想应用橡皮擦功能。那么我怎样才能制作这样一个工具来擦除画布上的内容，就像我们在 MS Paint 中所做的那样呢？

我不想清除整个画布，无论我在哪里单击或拖动指针，指针所经过的路径都应该被擦除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T23:12:20.693

要记住的重要一点是，您不是在“擦除”。您在鼠标经过的区域上使用小的 while 像素进行绘画。有 100 种不同的方法可以做到这一点，但没有任何内置方法可以让这变得简单。

您可能需要检测鼠标（或手指）触摸的每个像素（或您选择的任何测量单位），并在页面上已绘制的任何其他内容上放置一个白色的 Rectangle 控件。

这主要是一个管理大量 Rectangle 对象的游戏，并在适当的时候更改它们的颜色。如果您尝试擦除较大矩形的一部分，您应该重新考虑您的方法。

# php - 使用 PHP 从数组的表示到数组

> ID：11227036
> 
> 赞同：0
> 
> 时间：2012-06-27T13:11:46.577
> 
> 标签：php, arrays, multidimensional-array

一个真正的php新手，如果问题太简单，对不起。

我正在学习在线课程，但我刚刚陷入了数组章节。

它们显示了数组的以下表示：

```
$years
: array = 
  0: array = 
    0: string = 6465
    1: string = 1964-1965
  1: array = 
    0: string = 6566
    1: string = 1965-1966
  2: array = 
    0: string = 6667
    1: string = 1966-1967
  3: array = 
    0: string = 6768
    1: string = 1967-1968 
```

而且我不知道如何将其转换为正确的 PHP 数组。

你能告诉我阵列是怎样的吗？

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T13:17:31.383

```
$years = array(
    array( "6465", "1964-1965" ),
    array( "6566", "1965-1966" ),
    ...
); 
```

ETC

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T13:22:08.403

[加布里埃尔贝克的回答](https://stackoverflow.com/a/11227139/417562)是绝对正确的。另外一点，从 PHP 5.4 开始，有一种替代的缩写数组语法：

```
$years = [
    ['6465', '1964-1965'],
    ['6566', '1965-1966'],
    ['6667', '1966-1967'],
    ['6768', '1967-1968']
]; 
```

请注意，这在以前的 PHP 版本中不起作用，但它显然更易于理解和清晰。

数组语法记录在[PHP 手册](http://php.net/manual/en/language.types.array.php)中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T13:20:14.377

应该是这样的

```
$years = array( 
  0 => array( 
    0 => 6465,
    1 => 1964-1965,
  ),
  1 => array(
    0 => 6566,
    1 => 1965-1966,
  ),
  2 => array( 
    0 => 6667,
    1 => 1966-1967,
  ),
  3 => array( 
    0 => 6768,
    1 => 1967-1968,
  ),
) 
```

# jquery - 将参数从 jquery 选项卡传递给控制器

> ID：11227037
> 
> 赞同：2
> 
> 时间：2012-06-27T13:11:49.033
> 
> 标签：jquery, asp.net-mvc-3, jquery-tabs

我在单击按钮时加载带有参数的 jquery 对话框。（能够做到）这个对话框将打开一个局部视图，它包含 jquery 选项卡（包含两个选项卡）。我想根据条件将对话框中收到的参数传递给更正 jquery 选项卡，以便它进入控制器。

我能够在对话框中获取参数。我正在尝试将参数从 jquery 选项卡传递到控制器，但它始终为空。代码如下：

**对话框的JS**

```
//open jquery dialog
var diag = $('#MyDiv');

diag.load("/Controller/Action?item=" + $(this).id, '', function () {
}); 

//this is working

$(diag).dialog('open'); 
```

**控制器**

```
//on controller to loading partial view
public ActionResult Action(int item)
{
     Model mmodel = new Model();
     mmodel.itemid= item;
    return PartialView("_partialview", mmodel);
} 
```

**html标记**

```
//partial view which will show tabs. i want to pass paramater from tab to controller
<div id="tabContainer">
    <ul>
        <li><a href="SomeAction1?itemid=" + @Model.itemid>Tab1</a></li>
        <li><a href="SomeAction2">Tab2</a></li>
    </ul>
</div>
}
<script type="text/javascript">    
    $(document).ready(function () {
        $("#tabContainer").tabs();
    });
</script> 
```

如何将参数“itemid”传递给控制器​​中的 SomeAction1？有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:36:48.097

```
 <li>
     @Url.ActionLink("Tab1","SomeAction",new {itemid=Model.itemid})
  </li> 
```

使用 HTML Helper 方法而不是硬编码路径始终是一个好习惯。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-27T13:21:40.943

试试下面1]

```
 <li><a href="SomeAction1/" + @Model.itemid>Tab1</a></li>
<li><a href="SomeAction2">Tab2</a></li> 
```

2] 将您的操作参数重命名为 Itemid

```
public ActionResult Action(int itemid) 
```

如果您看到 ViewSource，那么它应该看起来像 belwo，其中 007 是 itemid

```
/SomeAction1/007 
```

# php - 搜索功能在php中不起作用

> ID：11227038
> 
> 赞同：-4
> 
> 时间：2012-06-27T13:11:51.723
> 
> 标签：php, mysql, html, database, phpmyadmin

我有一个表格，用户可以在其中注册俱乐部的个人信息，并将其存储在数据库中。一切正常，包括 MySQL。但是，我的搜索功能有问题。搜索页面应该是粘性形式。用户应该能够搜索并显示结果......就像他们在搜索框中输入名字或姓氏......然后结果显示数据库中的所有信息，满足特定条件谁能帮我修复我的搜索功能所有页面代码都在下面给出......谢谢！

这是我的表单页面代码.....

```
<html>
<head>

<style type="text/css">
table
{
    border-collapse:collapse;
    border-color:#FFFFFF;
}
body
{
    background-color:#39B3A7;
}
</style>

<?php
global $fname,$lname,$age,$gender,$course,$email;

if(!empty($_POST['register']))
{

    $fname=$_POST['fname'];
    $lname=$_POST['lname'];
    $age=$_POST['age'];
    $gender=$_POST['gender'];
    $course=$_POST['course'];
    $email=$_POST['email']; 

        if (preg_match("/[a-zA-Z ]+$/", $_POST['fname']))  {
            $fname = trim($_POST['fname']);
        }
         else 
        {
        echo '<p>The First name is empty or has illegal characters! To edit please go the link Display Data Information</p>';
        $error = true;
        }

        if (preg_match("/[a-zA-Z ]+$/", $_POST['lname']))  {
            $lname = trim($_POST['lname']);
        }
         else 
        {
        echo '<p>The last name is empty or has illegal characters! To edit please go the link Display Data Information</p>';
        $error = true;
        }

        if(isset($_POST['age']))
        {
            $age=$_POST['age'];
        }
        else
        {
            echo "<p>Please enter your age</p>";
        }

        if(isset($_POST['gender']))
        {   
            $gender = $_POST['gender']; 
        }
        else
        {
            echo "<p>No gender found! So, we assume you are SHEMALE</p>";
        }

        if(isset($_POST['course']))
        {
             $course = $_POST['course'];
        }
        else
        {
            echo "<p>Please Select Course!</p>";

        }

        // Validate the email:
    if (preg_match("/^[\w.-]+@[\w.-]+\.[A-Za-z]{2,6}$/", $_POST['email'] )){
    $email = trim($_POST['email']);
    }
    else 
    {
    echo '<p>The email is empty or has illegal characters! To edit please go the link Display Data Information</p>';
    $error = true;
    }
        echo "<br/>";
        echo "<br/>";
        echo "<br/>";

}

    if($fname&&$lname&&$age&&$gender&&$course&&$email)
    {
    require_once('connection.php');
    $query = mysql_query("INSERT INTO members SET FirstName='$fname', LastName='$lname', Gender='$gender', Age='$age',          Email='$email', Course='$course'") or die(mysql_error());

        if($query){
            echo"Your Data Successfully Saved"; 
        }
        else
        {
            echo "Please recheck your Data!";
        }

}

?>
</head>

<body>
<h2><strong>Register Student Account</strong></h2>
<form action="student_form.php" method="post" >
<table border="1">

  <tr>
    <td>First Name</td>
    <td>:</td>
    <td><input type="text" name="fname"  size="30" maxlength="50"/></td>
  </tr>

 <tr>
    <td>Last Name</td>
    <td>:</td>
    <td><input type="text" name="lname" size="30" maxlength="50"/></td>
  </tr>

  <tr>
    <td>Age</td>
    <td>:</td>
    <td><input type="text" name="age"  size="3" /></td>
  </tr>

    <tr>
    <td >Gender </td>
    <td> : </td>
    <td> Male
    <input type="radio" name="gender" value="Male"/>

    Female
    <input type="radio" name="gender" value="Female"/></td>

  </tr>

  <tr>
    <td valign="top">Course</td>
    <td valign="top"> : </td>
    <td> <input type="radio" name="course" value="Bachelor Of Computing"/>Bachelor Of Computing<br/>
   <input type="radio" name="course" value="Bachelor Of Science"/>Bachelor Of Science<br/> 
   <input type="radio" name="course" value="Bachelor Of Software Engineering"/>Bachelor Of Software Engineering<br/>
    <input type="radio" name="course" value="Bachelor Of Networking"/>Bachelor Of Networking<br/>
    <input type="radio" name="course" value="Bacelor Of IT"/>Bacelor Of IT <br/>
    <input type="radio" name="course" value="Bachelor Of Computer Science"/>Bachelor Of Computer Science</td>
  </tr>

 <tr>
    <td>Email Address</td>
    <td>:</td>
    <td><input type="text" name="email"  size="30" maxlength="50"/></td>
</tr>

</table>
    <input type="submit" name="register" value="REGISTER"/>

</form><br>
<p><a href="student_form.php" >Home</a></p>
<p><a href="display_data.php">Display Data Information</a>
<p><a href="search.php">To search for Members</a>
</body>
</html> 
```

这是我的连接页面代码....

```
<?php
$username = "root";
$password = "";

$con = mysql_connect('localhost',$username,$password) or die(mysql_error());

$db=mysql_select_db("taylor");

?> 
```

这是我的 display_data 代码....

```
<html>
<head>
<style type="text/css">
table
{
    border-collapse:collapse;
    border-color:#FFFFFF;   
}
body
{
    background-color:#39B3A7;
}

</style>
</head>

<body>

<table border="1">
  <tr>
    <th>First Name</th>
    <th>Last Name</th>
     <th>Email</th>
    <th>Age</th>
    <th>Gender</th>
  <th>Course</th>
    <th>Action</th>
  </tr>
  <?php
  include('connection.php');
    $query=mysql_query("SELECT * FROM members");
    while($rows=mysql_fetch_array($query)){
  ?>

  <tr>
    <td><?php echo $rows['FirstName']; ?></td>
    <td><?php echo $rows['LastName']; ?></td>
     <td><?php echo $rows['Email']; ?></td>
      <td><?php echo $rows['Age']; ?></td>
    <td><?php echo $rows['Gender']; ?></td>

    <td><?php echo $rows['Course']; ?></td>
      <td>
      <a href="edit.php?id=<?php echo $rows['Id']; ?>">Edit</a>
      <a href="delete.php?id=<?php echo $rows['Id']; ?>">Delete</a>
      </td>
  </tr>
  <?php
    }
  ?>
</table>
<p><a href="student_form.php">Home</a></p>
</body>
</html> 
```

这是我的

这是我的搜索页面代码....

```
<html>
<head>
<?php
//require_once('student_form.php');
if(isset($_POST['submit'])){ 
$id=$_REQUEST['id']; 
$fname=$_POST['fname'];
    //connect  to the database 
include('connection.php');
//-query  the database table 
$sql="SELECT  * FROM members WHERE FirstName=" . $fname; 
    //-run  the query against the mysql query function 
    $result=mysql_query($sql); 

    while($row=mysql_fetch_array($result)){ 
                $fname=$row['FirstName']; 
                $lname=$row['LastName']; 
                $email=$row['Email'];
                $age =$row['Age'];
                $gender=$row['Gender'];
                $course = $row['Course'];

    //-display  the result of the array 
    echo  "<ul>\n"; 
    echo  "<li>" . $fname . " " . $lname .  "</li>\n"; 
    echo  "<li>" . $email . "</li>\n";
    echo  "<li>" . $age . "</li>\n";
    echo  "<li>" . $gender . "</li>\n";
    echo  "<li>" . $course . "</li>\n"; 

    echo  "</ul>"; 
    } 
} 
?>
</head>
<body>
<form action="search.php" method="post">
<table>
    <tr>
    <td><strong>search box</strong></td>
    <td><strong>:</strong></td>
    <td><input type="text" name="search" value="Enter First Name of The member"size="30"/><input type="submit" value="Search"/></td>

</table>
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T13:18:53.333

```
"SELECT  * FROM members WHERE FirstName='" . $fname."'"; 
```

当您进行查询时，您的字符串应包含在引号中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T13:23:18.400

如果您要搜索，则需要使用`LIKE`语法，而不是`WHERE`

```
$sql="SELECT  * FROM members WHERE FirstName LIKE '". $fname ."%'"; 
```

`LIKE & %`使其成为通配符。现在您说要按第一个和最后一个进行搜索，但是您只传递了第一个变量并且只查询了第一个字段，因此您还需要传递姓氏并在 SQL 中添加 OR 并封装名字如果稍后扩展 sql，括号中的 like 或 lastname like 可以获得更好的性能。

```
$sql="SELECT  * FROM members WHERE (FirstName LIKE '". $fname ."%' OR LastName LIKE '". $lname ."%')"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-28T21:49:45.450

你也可以这样做，知道 The`LIKE & %`使它成为通配符。

```
 $sql="SELECT  * FROM members WHERE (FirstName LIKE '". $fname ."%' OR LastName LIKE '". $lname ."%')"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-26T23:42:11.140

尝试

```
$sql=""SELECT  * FROM members WHERE FirstName = '$fname'"; 
```

它应该工作。

# c# - 使用javascript返回的asp表单

> ID：11227039
> 
> 赞同：0
> 
> 时间：2012-06-27T13:11:55.967
> 
> 标签：c#, javascript, asp.net, forms

我有一个 ASP 表单，我正在使用 Google 地理编码从邮政编码中获取经纬度。在 Internet Explorer 中，表单会提交，但在 Google Chrome 中不会。`return`如果我从 中删除，它似乎会发布`OnClientClick="return findLatLng()"`，但是 javascript 部分不会更新表单。我想知道为什么我需要`return`以及我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T21:45:06.223

取自 MSUH 评论，这是错误的：如果 findlatlng 返回 true 页面将回发，如果返回 false 则不会，return 用于检查我们是否要继续执行后面代码中定义的点击事件。

# tomcat - 同一台服务器上的多个 tomcat ...ajp 停止工作

> ID：11227041
> 
> 赞同：0
> 
> 时间：2012-06-27T13:11:58.903
> 
> 标签：tomcat, ajp

我有一种情况，我在 Windows 的同一台服务器上安装了多个 Tomcat。每个 Tomcat 都有自己的端口。第一个监听 8080 ajp 8009，第二个监听 8081 ajp 8010。

我的问题是：从端口 8080 到 8086 运行 7 个 tomcat 工作正常，但前 3 个 (8009,8010,8011) 的 ajp 停止工作（如果每个 Tomcat 单独运行，它们工作）。似乎最多可以运行 4 个 ajp 侦听器。怎么会这样？任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T22:32:22.077

检查您的关闭端口是否与您的 AJP 端口重叠。

# .net - 使用高级选项打印（纸盘选择、双面打印、装订）

> ID：11227042
> 
> 赞同：4
> 
> 时间：2012-06-27T13:12:01.243
> 
> 标签：.net, printing, duplex, office-automation, tray

我们有一个管理打印文件的项目。起初我想知道为什么不能在一个地方设置打印选项。例如，第一页和其他页面的**打印机托盘选择**可以使用**MS Word 自动化**完成：

```
var doc = _applicationObject.Documents.OpenNoRepairDialog(FileName: ref sourceFile, ReadOnly: ref readOnly,
                                                                 AddToRecentFiles: ref addToRecentFiles,
                                                                 Visible: ref visible);
doc.PageSetup.FirstPageTray = (WdPaperTray) firstPageTrayCode;
doc.PageSetup.OtherPagesTray = (WdPaperTray) otherPagesTrayCode;
_applicationObject.ActivePrinter = printerPath;
doc.Activate();
_applicationObject.PrintOut(Background: ref backgroundPrint, FileName: sourceFile);
doc.Close(ref saveChanges, ref _missing, ref _missing); 
```

在上面的代码中，打印机托盘被指定为整数，因为某些打印机没有托盘的标准值（我们在 HP 遇到了这个问题 -[这里](http://www.ecrion.com/Help/Products/XFRenderingServer/XFUltrascaleHelp1/use_printer_tray_selection.htm)描述了托盘代码）。所以我们首先检索打印机有哪些托盘，使用代码：

```
var setting = new PrinterSettings();
setting.PrinterName = myPrinterName;
foreach (PaperSource tray in setting.PaperSources)
{
    Console.WriteLine("\t{0}: #{1}", tray.SourceName, tray.RawKind);
} 
```

这段代码没有问题。

但是这里无法指定双面打印和装订选项。可以使用**驱动程序函数 OpenPrinter 和 SetPrinter来完成****双面**打印，就像[这里](http://www.codeproject.com/Articles/6899/Changing-printer-settings-using-C)描述的一样，微软也在[这个论坛帖子](http://support.microsoft.com/kb/230743)中推荐。 **主食**完全**不清楚**，如果有人知道如何实现这一点，请告诉我。使用 Stapling 枚举，就像在[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/system.printing.stapling.aspx)中一样，是没有用的，因为它需要自定义渲染文档才能打印。

 ******我描述了情况以及部分是如何实现的。*这在我们的环境中运行良好*：Windows Server 2008 R2、MS Office 2010 x32、打印机 HP LaserJet P2055 和 Ricoh Nashuatec DSm635。使用原生和通用 PCL6/PCL5e 驱动程序进行测试：双面打印和托盘选择按预期工作。

*但是在将应用程序部署到客户端后*，打印机（HP LaserJet 4250 和 Ricoh Aficio MP C7501）**总是从默认托盘进行打印，并且没有双面打印**。尝试了几个不同的驱动程序，结果完全相同。

在这两种环境中，打印机都是网络打印机。因此，为了使他们应用双面设置，使用打印机驱动程序，我们需要在服务器上安装本地驱动程序并制作本地打印机，正如我的微软在[此支持论坛线程](http://support.microsoft.com/kb/230743)上推荐的那样。

尽管使用的环境和打印机看起来非常相似，但其中一个可以工作，而另一个则不能。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T10:36:15.663

如果其他人需要它，我想出了一个解决方法，基于将打印机设置内存块存储在二进制文件中，然后恢复它。这个想法在[这篇博](http://nicholas.piasecki.name/blog/2008/11/programmatically-selecting-complex-printer-options-in-c-shar/)文中有所描述，但是当我简单地复制粘贴时它对我不起作用（它仅适用于某些驱动程序和某些设置，而其他打印选项被忽略）。

所以我重新做了一点，现在它可以支持我在任何我测试过的打印机（使用兼容的驱动程序）上尝试过的所有设置。当然，例如，如果您使用另一台打印机的驱动程序，它将无法正常工作。

这种方法的缺点当然是您应该首先将默认打印机首选项（在控制面板中）设置为您需要的。当然，这并不总是可能的，但至少在某些情况下它会有所帮助。

因此，能够将打印机设置存储到文件中的测试工具的完整源代码，再次将此文件加载到打印机并使用指定的设置文件打印文档：

```
using System;
using System.Collections.Generic;
using System.Drawing.Printing;
using System.IO;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using Microsoft.Office.Interop.Word;

namespace PrintAdvancedTest
{
    [StructLayout(LayoutKind.Sequential)]
    public struct PRINTER_DEFAULTS
    {
        public int pDatatype;
        public int pDevMode;
        public int DesiredAccess;
    }

    [StructLayout(LayoutKind.Sequential)]
    public struct PRINTER_INFO_2
    {
        [MarshalAs(UnmanagedType.LPStr)]
        public readonly string pServerName;
        [MarshalAs(UnmanagedType.LPStr)]
        public readonly string pPrinterName;
        [MarshalAs(UnmanagedType.LPStr)]
        public readonly string pShareName;
        [MarshalAs(UnmanagedType.LPStr)]
        public readonly string pPortName;
        [MarshalAs(UnmanagedType.LPStr)]
        public readonly string pDriverName;
        [MarshalAs(UnmanagedType.LPStr)]
        public readonly string pComment;
        [MarshalAs(UnmanagedType.LPStr)]
        public readonly string pLocation;
        public IntPtr pDevMode;
        [MarshalAs(UnmanagedType.LPStr)]
        public readonly string pSepFile;
        [MarshalAs(UnmanagedType.LPStr)]
        public readonly string pPrintProcessor;
        [MarshalAs(UnmanagedType.LPStr)]
        public readonly string pDatatype;
        [MarshalAs(UnmanagedType.LPStr)]
        public readonly string pParameters;
        public IntPtr pSecurityDescriptor;
        public readonly Int32 Attributes;
        public readonly Int32 Priority;
        public readonly Int32 DefaultPriority;
        public readonly Int32 StartTime;
        public readonly Int32 UntilTime;
        public readonly Int32 Status;
        public readonly Int32 cJobs;
        public readonly Int32 AveragePPM;
    }

    public class PrintSettings
    {
        private const short CCDEVICENAME = 32;
        private const short CCFORMNAME = 32;

        //Constants for DEVMODE
        // Constants for DocumentProperties
        private const int DM_MODIFY = 8;
        private const int DM_COPY = 2;
        private const int DM_IN_BUFFER = DM_MODIFY;
        private const int DM_OUT_BUFFER = DM_COPY;
        // const intants for dmOrientation
        private const int DMORIENT_PORTRAIT = 1;
        private const int DMORIENT_LANDSCAPE = 2;
        // const intants for dmPrintQuality
        private const int DMRES_DRAFT = (-1);
        private const int DMRES_HIGH = (-4);
        private const int DMRES_LOW = (-2);
        private const int DMRES_MEDIUM = (-3);
        // const intants for dmTTOption
        private const int DMTT_BITMAP = 1;
        private const int DMTT_DOWNLOAD = 2;
        private const int DMTT_DOWNLOAD_OUTLINE = 4;
        private const int DMTT_SUBDEV = 3;
        // const intants for dmColor
        private const int DMCOLOR_COLOR = 2;
        private const int DMCOLOR_MONOCHROME = 1;
        // const intants for dmCollate
        private const int DMCOLLATE_FALSE = 0;
        private const int DMCOLLATE_TRUE = 1;
        // const intants for dmDuplex
        private const int DMDUP_HORIZONTAL = 3;
        private const int DMDUP_SIMPLEX = 1;
        private const int DMDUP_VERTICAL = 2;

        //const for security access
        private const int PRINTER_ACCESS_ADMINISTER = 0x4;
        private const int PRINTER_ACCESS_USE = 0x8;
        private const int STANDARD_RIGHTS_REQUIRED = 0xF0000;

        private const int PRINTER_ALL_ACCESS =
            (STANDARD_RIGHTS_REQUIRED | PRINTER_ACCESS_ADMINISTER
             | PRINTER_ACCESS_USE);

        /* field selection bits */
        private const int DM_ORIENTATION = 0x00000001;
        private const int DM_PAPERSIZE = 0x00000002;
        private const int DM_PAPERLENGTH = 0x00000004;
        private const int DM_PAPERWIDTH = 0x00000008;
        private const int DM_SCALE = 0x00000010;
        private const int DM_POSITION = 0x00000020;
        private const int DM_NUP = 0x00000040;
        private const int DM_DISPLAYORIENTATION = 0x00000080;
        private const int DM_COPIES = 0x00000100;
        private const int DM_DEFAULTSOURCE = 0x00000200;
        private const int DM_PRINTQUALITY = 0x00000400;
        private const int DM_COLOR = 0x00000800;
        private const int DM_DUPLEX = 0x00001000;
        private const int DM_YRESOLUTION = 0x00002000;
        private const int DM_TTOPTION = 0x00004000;
        private const int DM_COLLATE = 0x00008000;
        private const int DM_FORMNAME = 0x00010000;
        private const int DM_LOGPIXELS = 0x00020000;
        private const int DM_BITSPERPEL = 0x00040000;
        private const int DM_PELSWIDTH = 0x00080000;
        private const int DM_PELSHEIGHT = 0x00100000;
        private const int DM_DISPLAYFLAGS = 0x00200000;
        private const int DM_DISPLAYFREQUENCY = 0x00400000;
        private const int DM_ICMMETHOD = 0x00800000;
        private const int DM_ICMINTENT = 0x01000000;
        private const int DM_MEDIATYPE = 0x02000000;
        private const int DM_DITHERTYPE = 0x04000000;
        private const int DM_PANNINGWIDTH = 0x08000000;
        private const int DM_PANNINGHEIGHT = 0x10000000;
        private const int DM_DISPLAYFIXEDOUTPUT = 0x20000000;

        [StructLayout(LayoutKind.Sequential)]
        public struct DEVMODE
        {
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = CCDEVICENAME)]
            public string dmDeviceName;
            public short dmSpecVersion;
            public short dmDriverVersion;
            public short dmSize;
            public short dmDriverExtra;
            public int dmFields;
            public short dmOrientation;
            public short dmPaperSize;
            public short dmPaperLength;
            public short dmPaperWidth;
            public short dmScale;
            public short dmCopies;
            public short dmDefaultSource;
            public short dmPrintQuality;
            public short dmColor;
            public short dmDuplex;
            public short dmYResolution;
            public short dmTTOption;
            public short dmCollate;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = CCFORMNAME)]
            public string dmFormName;
            public short dmUnusedPadding;
            public short dmBitsPerPel;
            public int dmPelsWidth;
            public int dmPelsHeight;
            public int dmDisplayFlags;
            public int dmDisplayFrequency;
        }

        static void Main(string[] args)
        {
            Dictionary<string, Action> commands = new Dictionary<string, Action>
                                                      {
                                                          {"save", PrinterPreferencesSave},
                                                          {"print", PrinterPreferencesPrint},
                                                          {"set", PrinterPreferencesSet},
                                                          {"info", PrinterInfo}
                                                      };

            while (true)
            {
                Console.Write("Command ({0}): ", string.Join(", ", commands.Keys));
                string command = Console.ReadLine();
                Action action;
                if (!commands.TryGetValue(command, out action))
                {
                    Console.WriteLine("Invalid command");
                }
                else
                {
                    action();
                }
            }
        }

        static void PrinterPreferencesSave()
        {
            Console.Write("Printer name: ");
            string printerName = Console.ReadLine();
            Console.Write("Settings file path format: ");
            string SettingsFileNameFormat = Console.ReadLine();
            string testName;

            while (true)
            {
                Console.Write("SAVE: Settings set name: ");
                testName = Console.ReadLine();
                if (testName == "end")
                {
                    break;
                }
                getDevMode(printerName, string.Format(SettingsFileNameFormat, testName));
            }
        }

        static void PrinterPreferencesPrint()
        {
            Console.Write("Printer name: ");
            string printerName = Console.ReadLine();
            Console.Write("Settings file path format: ");
            string SettingsFileNameFormat = Console.ReadLine();
            Console.Write("Document to print: ");
            string docToPrintPath = Console.ReadLine();

            string testName;
            while (true)
            {
                Console.Write("PRINT: Settings set name: ");
                testName = Console.ReadLine();
                if (testName == "end")
                {
                    break;
                }
                string filePath = string.Format(SettingsFileNameFormat, testName);
                if (!File.Exists(filePath))
                {
                    Console.WriteLine("File {0} not exists", filePath);
                    return;
                }
                var success = setDevMode(printerName, filePath);
                if (success)
                {
                    PrintWordDocument(docToPrintPath, printerName);
                }
            }
        }

        static void PrinterPreferencesSet()
        {
            Console.Write("Printer name: ");
            string printerName = Console.ReadLine();
            Console.Write("Settings file path format: ");
            string SettingsFileNameFormat = Console.ReadLine();

            string testName;
            while (true)
            {
                Console.Write("SET: Settings set name: ");
                testName = Console.ReadLine();
                if (testName == "end")
                {
                    break;
                }
                string filePath = string.Format(SettingsFileNameFormat, testName);
                if (!File.Exists(filePath))
                {
                    Console.WriteLine("File {0} not exists", filePath);
                    return;
                }
                var success = setDevMode(printerName, filePath);
                if(!success)
                {
                    Console.WriteLine("Failed");
                }
            }
        }

        private static void PrinterInfo()
        {
            Console.Write("Printer name: ");
            string printerName = Console.ReadLine();

            IntPtr hDevMode;                        // handle to the DEVMODE
            IntPtr pDevMode;                        // pointer to the DEVMODE
            DEVMODE devMode;                        // the actual DEVMODE structure

            //var printController = new StandardPrintController();
            PrinterSettings printerSettings = new PrinterSettings();
            printerSettings.PrinterName = printerName;

            // Get a handle to a DEVMODE for the default printer settings
            hDevMode = printerSettings.GetHdevmode(printerSettings.DefaultPageSettings);

            // Obtain a lock on the handle and get an actual pointer so Windows won't
            // move it around while we're futzing with it
            pDevMode = GlobalLock(hDevMode);

            // Marshal the memory at that pointer into our P/Invoke version of DEVMODE
            devMode = (DEVMODE)Marshal.PtrToStructure(pDevMode, typeof(DEVMODE));

            Dictionary<string, int> dmConstants = new Dictionary<string, int>
                                                      {
                                                          {"DM_ORIENTATION", 0x00000001},
                                                          {"DM_PAPERSIZE", 0x00000002},
                                                          {"DM_PAPERLENGTH", 0x00000004},
                                                          {"DM_PAPERWIDTH", 0x00000008},
                                                          {"DM_SCALE", 0x00000010},
                                                          {"DM_POSITION", 0x00000020},
                                                          {"DM_NUP", 0x00000040},
                                                          {"DM_DISPLAYORIENTATION", 0x00000080},
                                                          {"DM_COPIES", 0x00000100},
                                                          {"DM_DEFAULTSOURCE", 0x00000200},
                                                          {"DM_PRINTQUALITY", 0x00000400},
                                                          {"DM_COLOR", 0x00000800},
                                                          {"DM_DUPLEX", 0x00001000},
                                                          {"DM_YRESOLUTION", 0x00002000},
                                                          {"DM_TTOPTION", 0x00004000},
                                                          {"DM_COLLATE", 0x00008000},
                                                          {"DM_FORMNAME", 0x00010000},
                                                          {"DM_LOGPIXELS", 0x00020000},
                                                          {"DM_BITSPERPEL", 0x00040000},
                                                          {"DM_PELSWIDTH", 0x00080000},
                                                          {"DM_PELSHEIGHT", 0x00100000},
                                                          {"DM_DISPLAYFLAGS", 0x00200000},
                                                          {"DM_DISPLAYFREQUENCY", 0x00400000},
                                                          {"DM_ICMMETHOD", 0x00800000},
                                                          {"DM_ICMINTENT", 0x01000000},
                                                          {"DM_MEDIATYPE", 0x02000000},
                                                          {"DM_DITHERTYPE", 0x04000000},
                                                          {"DM_PANNINGWIDTH", 0x08000000},
                                                          {"DM_PANNINGHEIGHT", 0x10000000},
                                                          {"DM_DISPLAYFIXEDOUTPUT", 0x20000000},
                                                      };
            Console.WriteLine("Allow set: {0}. Details: {1}", Convert.ToString(devMode.dmFields, 16), string.Join(",", dmConstants.Where(c=>(devMode.dmFields & c.Value)==c.Value).Select(c=>c.Key)));

            //private const int DM_POSITION = 0x00000020;
            //private const int DM_NUP = 0x00000040;
            //private const int DM_DISPLAYORIENTATION = 0x00000080;
            //private const int DM_DEFAULTSOURCE = 0x00000200;
            //private const int DM_PRINTQUALITY = 0x00000400;
            //private const int DM_COLOR = 0x00000800;
            //private const int DM_YRESOLUTION = 0x00002000;
            //private const int DM_TTOPTION = 0x00004000;
            //private const int DM_FORMNAME = 0x00010000;
            //private const int DM_LOGPIXELS = 0x00020000;
            //private const int DM_BITSPERPEL = 0x00040000;
            //private const int DM_PELSWIDTH = 0x00080000;
            //private const int DM_PELSHEIGHT = 0x00100000;
            //private const int DM_DISPLAYFLAGS = 0x00200000;
            //private const int DM_DISPLAYFREQUENCY = 0x00400000;
            //private const int DM_ICMMETHOD = 0x00800000;
            //private const int DM_ICMINTENT = 0x01000000;
            //private const int DM_MEDIATYPE = 0x02000000;
            //private const int DM_DITHERTYPE = 0x04000000;
            //private const int DM_PANNINGWIDTH = 0x08000000;
            //private const int DM_PANNINGHEIGHT = 0x10000000;
            //private const int DM_DISPLAYFIXEDOUTPUT = 0x20000000;

            WriteDevModePropertyInfo("DeviceName", devMode.dmDeviceName, null);
            WriteDevModePropertyInfo("SpecVersion", devMode.dmSpecVersion.ToString(), null);
            WriteDevModePropertyInfo("DriverVersion", devMode.dmDriverVersion.ToString(), null);
            WriteDevModePropertyInfo("Size", devMode.dmSize.ToString(), null);
            WriteDevModePropertyInfo("DriverExtra", devMode.dmDriverExtra.ToString(), null);
            WriteDevModePropertyInfo("Orientation", devMode.dmOrientation.ToString(), (devMode.dmFields & DM_ORIENTATION) == DM_ORIENTATION);
            WriteDevModePropertyInfo("PaperSize", devMode.dmPaperSize.ToString(), (devMode.dmFields & DM_PAPERSIZE) == DM_PAPERSIZE);
            WriteDevModePropertyInfo("PaperLength", devMode.dmPaperLength.ToString(), (devMode.dmFields & DM_PAPERLENGTH) == DM_PAPERLENGTH);
            WriteDevModePropertyInfo("PaperWidth", devMode.dmPaperWidth.ToString(), (devMode.dmFields & DM_PAPERWIDTH) == DM_PAPERWIDTH);
            WriteDevModePropertyInfo("Scale", devMode.dmScale.ToString(), (devMode.dmFields & DM_SCALE) == DM_SCALE);
            WriteDevModePropertyInfo("Copies", devMode.dmCopies.ToString(), (devMode.dmFields & DM_COPIES) == DM_COPIES);
            WriteDevModePropertyInfo("Duplex", devMode.dmDuplex.ToString(), (devMode.dmFields & DM_DUPLEX) == DM_DUPLEX);
            WriteDevModePropertyInfo("YResolution", devMode.dmYResolution.ToString(), null);
            WriteDevModePropertyInfo("TTOption", devMode.dmTTOption.ToString(), null);
            WriteDevModePropertyInfo("Collate", devMode.dmCollate.ToString(), (devMode.dmFields & DM_COLLATE) == DM_COLLATE);
            WriteDevModePropertyInfo("FormName", devMode.dmFormName.ToString(), null);
            WriteDevModePropertyInfo("UnusedPadding", devMode.dmUnusedPadding.ToString(), null);
            WriteDevModePropertyInfo("BitsPerPel", devMode.dmBitsPerPel.ToString(), null);
            WriteDevModePropertyInfo("PelsWidth", devMode.dmPelsWidth.ToString(), null);
            WriteDevModePropertyInfo("PelsHeight", devMode.dmPelsHeight.ToString(), null);
            WriteDevModePropertyInfo("DisplayFlags", devMode.dmDisplayFlags.ToString(), null);
            WriteDevModePropertyInfo("DisplayFrequency", devMode.dmDisplayFlags.ToString(), null);
        }

        private static void WriteDevModePropertyInfo(string settingName, string value, bool? allowSet)
        {
            Console.WriteLine("{0} {1} {2}", allowSet.HasValue ? (allowSet.Value ? "+" : "-") : " ", settingName.PadRight(20, '.'), value);
        }

        [DllImport("kernel32.dll", ExactSpelling = true)]
        public static extern IntPtr GlobalFree(IntPtr handle);

        [DllImport("kernel32.dll", ExactSpelling = true)]
        public static extern IntPtr GlobalLock(IntPtr handle);

        [DllImport("kernel32.dll", ExactSpelling = true)]
        public static extern IntPtr GlobalUnlock(IntPtr handle);

        [DllImport("kernel32.dll", EntryPoint = "GetLastError", SetLastError = false,
            ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]
        private static extern Int32 GetLastError();

        [DllImport("winspool.Drv", EntryPoint = "ClosePrinter", SetLastError = true,
            ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]
        private static extern bool ClosePrinter(IntPtr hPrinter);

        [DllImport("winspool.Drv", EntryPoint = "DocumentPropertiesA", SetLastError = true,
            ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]
        private static extern int DocumentProperties(IntPtr hwnd, IntPtr hPrinter,
                                                     [MarshalAs(UnmanagedType.LPStr)] string pDeviceNameg,
                                                     IntPtr pDevModeOutput, ref IntPtr pDevModeInput, int fMode);

        [DllImport("winspool.Drv", EntryPoint = "GetPrinterA", SetLastError = true,
            CharSet = CharSet.Ansi, ExactSpelling = true,
            CallingConvention = CallingConvention.StdCall)]
        private static extern bool GetPrinter(IntPtr hPrinter, Int32 dwLevel,
                                              IntPtr pPrinter, Int32 dwBuf, out Int32 dwNeeded);

        [DllImport("winspool.Drv", EntryPoint = "OpenPrinterA",
           SetLastError = true, CharSet = CharSet.Ansi,
           ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]
        private static extern bool
            OpenPrinter([MarshalAs(UnmanagedType.LPStr)] string szPrinter,
                        out IntPtr hPrinter, ref PRINTER_DEFAULTS pd);

        [DllImport("winspool.drv", CharSet = CharSet.Ansi, SetLastError = true)]
        private static extern bool SetPrinter(IntPtr hPrinter, int Level, IntPtr
                                                                              pPrinter, int Command);

        [DllImport("kernel32.dll")]
        static extern IntPtr GlobalAlloc(uint uFlags, int dwBytes);

        public static void getDevMode(string printerName, string filepath)
        {
            PRINTER_DEFAULTS PrinterValues = new PRINTER_DEFAULTS();
            PrinterValues.pDatatype = 0;
            PrinterValues.pDevMode = 0;
            PrinterValues.DesiredAccess = PRINTER_ALL_ACCESS;

            IntPtr ptrZero = IntPtr.Zero;
            IntPtr hPrinter;
            IntPtr pDevMode = new IntPtr();

            //get printer handle
            OpenPrinter(printerName, out hPrinter, ref PrinterValues);

            //allocate memory for ptr to devmode, 0 argument retrieves bytes required
            int bytes = DocumentProperties(new IntPtr(0), hPrinter, printerName, ptrZero, ref pDevMode, 0);
            pDevMode = GlobalAlloc(0, bytes);

            //set the pointer
            DocumentProperties(new IntPtr(0), hPrinter, printerName, pDevMode, ref ptrZero, DM_OUT_BUFFER);

            //write the devMode to a file
            using (FileStream fs = new FileStream(filepath, FileMode.Create))
            {
                for (int i = 0; i < bytes; i++)
                {
                    fs.WriteByte(Marshal.ReadByte(pDevMode, i));
                }
            }
            //free resources
            GlobalFree(pDevMode);
            ClosePrinter(hPrinter);
        }

        public static bool setDevMode(string printerName, string filepath)
        {
            if(!File.Exists(filepath))
            {
                return false;
            }

            IntPtr hPrinter;
            int bytes = 0;
            IntPtr pPInfo;
            IntPtr pDevMode;
            PRINTER_INFO_2 pInfo = new PRINTER_INFO_2();

            PRINTER_DEFAULTS PrinterValues = new PRINTER_DEFAULTS();
            PrinterValues.pDatatype = 0;
            PrinterValues.pDevMode = 0;
            PrinterValues.DesiredAccess = PRINTER_ALL_ACCESS;

            //retrieve the devmode from file
            using (FileStream fs = new FileStream(filepath, FileMode.Open))
            {
                int length = Convert.ToInt32(fs.Length);
                pDevMode = GlobalAlloc(0, length);
                for (int i = 0; i < length; i++)
                {
                    Marshal.WriteByte(pDevMode, i, (byte)fs.ReadByte());
                }
            }

            //get printer handle
            OpenPrinter(printerName, out hPrinter, ref PrinterValues);

            //get bytes for printer info structure and allocate memory
            GetPrinter(hPrinter, 2, IntPtr.Zero, 0, out bytes);
            if (bytes == 0)
            {
                throw new Exception("Get Printer Failed");
            }
            pPInfo = GlobalAlloc(0, bytes);

            //set pointer to printer info
            GetPrinter(hPrinter, 2, pPInfo, bytes, out bytes);

            //place the printer info structure
            pInfo = (PRINTER_INFO_2)Marshal.PtrToStructure(pPInfo, typeof(PRINTER_INFO_2));

            //insert the new devmode
            pInfo.pDevMode = pDevMode;
            pInfo.pSecurityDescriptor = IntPtr.Zero;

            //set pointer to new printer info
            Marshal.StructureToPtr(pInfo, pPInfo, true);

            //update
            SetPrinter(hPrinter, 2, pPInfo, 0);

            //free resources
            GlobalFree(pPInfo);
            GlobalFree(pDevMode);
            ClosePrinter(hPrinter);

            return true;
        }

        private static void PrintWordDocument(string path, string printerName)
        {
            object readOnly = true;
            object addToRecentFiles = false;
            object visible = false;
            object backgroundPrint = false;
            object saveChanges = false;
            object sourceFile = path;

            var wordApplication = new Application();
            var doc = wordApplication.Documents.OpenNoRepairDialog(FileName: ref sourceFile, ReadOnly: ref readOnly,
                                                                 AddToRecentFiles: ref addToRecentFiles,
                                                                 Visible: ref visible);
            wordApplication.ActivePrinter = printerName;
            doc.Activate();
            wordApplication.PrintOut(Background: ref backgroundPrint, FileName: sourceFile);
            object _missing = Type.Missing;
            doc.Close(ref saveChanges, ref _missing, ref _missing);
        }
    }
} 
```

**更新 2018-12-04（5.5 年后）：**此代码中的 Marshal.StructureToPtr 调用存在一个令人讨厌的罕见问题，今天我终于得到了[该问题](https://stackoverflow.com/questions/13476055/marshal-structuretoptr-fails-in-module-ntdll-dll)的答案（请参阅 Hans Passant 的评论）。我无法验证这是否真的有效，因为我不再从事该项目，但如果您尝试使用此代码，似乎您可能需要应用该修复程序。******

# java - 如何从 ByteArrayOutputStream 中删除字节？

> ID：11227066
> 
> 赞同：2
> 
> 时间：2012-06-27T13:13:10.080
> 
> 标签：java, bytearrayoutputstream

因此，我的 ByteArrayOutputStream 的前四个字节包含我的流中标头的长度。我需要从流中删除该标题并继续我的业务。

```
ByteArrayOutputStream oStream = new ByteArrayOutputStream();
/* populate ByteArrayOutputStream */

//grab first int
int headerLength = oStream.toByteArray()[4];

//remove headerLength
String newString = oStream.toString().substring(jsonLength, oStream.size());
oStream.write(newString.getBytes()); 
```

我认为这不是解决此问题的正确方法，有人有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T13:26:09.017

简单的答案是首先写入 4 个字节......如果你能做到的话。

另一个答案是编写一个自定义的 FilterOutputStream 子类，它忽略写入的前 4 个字节。

另一个是提取字节，然后使用 Arrays.copy 方法之一创建一个新的字节数组，其中包含您需要的原始“切片”；例如

```
byte[] subarray = Arrays.copyOfRange(original, 4, original.length - 4); 
```

或者，如果您的应用程序可以处理字节数组末尾的“未定义”区域，您可以执行以下操作：

```
System.arraycopy(array, 4, array.length - 4, array, 0);  // YMMV - check javadoc 
```

* * *

最后，根据您使用字节数组的目的，您很有可能可以忽略前 4 个字节而不删除它们。例如，您可以在将字节写入流、从字节创建字符串、将字节复制到 ByteBuffer 等时执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T13:25:32.200

没有办法做你所要求的。
您必须使用 remove 方法发明自己的 OutputStream。
我建议这个 OutputStream 将接受另一个 OutputStream 作为参数，并且当您执行写入时，它将累积字节（使用与 ByteArrayOutputStream 类似的技术）
删除后，您将可以访问您的内部数据结构（比如说数组）和将编写删除算法（例如 - 从数组中删除 M 条目，从位置 N 开始）。
另一种选择是扩展 ByteArrayOutputStream - 我刚刚检查了它的[代码](http://kickjava.com/src/java/io/ByteArrayOutputStream.java.htm)，结果发现内部缓冲区是受保护的（该字段名为“buf”） - 所以在这个上实施我的上述建议。代码应如下所示（未给出完整代码）：

```
public class MyByteArrayOutputStream extends ByteArrayOutputStream {
   //Implement all the CTORs

   public int remove (int startFrom, int length)  {
       //Implement removal algorithm on array on the field "buf" 
       //return the number of removed elements
   }
} 
```

# visual-c++ - 32位版本的mfc100u.dll？

> ID：11227072
> 
> 赞同：2
> 
> 时间：2012-06-27T13:13:19.170
> 
> 标签：visual-c++, mfc

我有一个用 VS2010 开发的 32 位应用程序，但是依赖项walker 说它依赖于一个名为 mfc100u.dll 的 64 位文件。

这里的问题是某些计算机无法启动该应用程序。

我无法找到有关此的明确信息。该文件是否有 32 位和 64 位版本？如果是这样，我如何确保 32 位应用程序使用一个版本而 64 位应用程序使用另一个版本？（如果这些应用程序在同一个目录中？）

如果 32 位有不同的名称，它是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T14:12:27.570

Dependency walker 通常可以指示 DLL 的 64 位，但这是错误的。在运行 32 位应用程序时，WOW64 使用称为文件系统重定向器的东西：

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa384187(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa384187(v=vs.85).aspx)

所有对 System32 目录的请求都被重定向到 syswow64 文件夹（无论您是否希望它们）。

如果包含 64 位 DLL，应用程序将不会加载，您会在启动时收到某种“坏图像”错误。

尝试运行 32 位版本的 Dependency Walker，看看它是否适合您。

**更新：** MFC 和 C 运行时的 32 位和 64 位版本具有相同的名称。它们通常使用可再分发的 MSI 文件进行部署，Windows 将在运行时处理链接。但是，如果您绝对必须将特定版本链接到您的应用程序，则需要将它们部署在与您的应用程序相同的文件夹中。不要尝试在同一个文件夹中混合 32/64 位版本。以下是微软对这个主题的看法：

[http://msdn.microsoft.com/en-us/library/ms235264.aspx](http://msdn.microsoft.com/en-us/library/ms235264.aspx)

注意：为了使事情复杂化，同一文件有不同的可再发行版本，例如 VS2010 SP1 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-08T08:19:36.040

msvcr100.dll 不是为在 Windows 上运行而设计的，或者它包含错误。尝试使用原始安装介质重新安装程序，或联系您的系统管理员或软件供应商支持。

# web.xml - web.xml 中的类路径是什么？

> ID：11227080
> 
> 赞同：2
> 
> 时间：2012-06-27T13:13:52.387
> 
> 标签：web.xml

我在 web.xml 中遇到了这段代码，但我不明白它的作用。

```
<context-param>
   <param-name>contextConfigLocation</param-name>
   <param-value>classpath:my-main-spring.xml</param-value>
</context-param> 
```

我可以知道 web.xml 中的类路径做什么吗？我在哪里可以找到更多关于这件事的参考或阅读材料？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T03:00:12.023

很抱歉提出愚蠢的问题，我已经从这个线程中得到了答案>[如何将一个项目的 spring-config.xml 导入另一个项目的 spring-config.xml？](https://stackoverflow.com/questions/5113579/how-to-import-spring-config-xml-of-one-project-into-spring-config-xml-of-another).

# c# - 编写方法时如何防止某些形式的输入？

> ID：11227086
> 
> 赞同：6
> 
> 时间：2012-06-27T13:14:00.060
> 
> 标签：c#, for-loop, console

我仍然是高级编程语言编程的初学者，所以我不知道这是否是一个简单的解决方案，但无论如何我很乐意学习。我用 C# 编写了一个小警报程序，让用户输入警报需要在多少秒内响起。它工作得很好，但用户需要提供的输入必须是一个数字。当用户输入任何形式的文本时，程序就会崩溃。现在，如何防止用户输入文本、调用函数或在用户输入时执行其他操作，而不是程序崩溃？

这是我现在的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Test
{
    class Alarm
    {
        public static void play()
        {
            int sec;
            sec = Convert.ToInt16(Console.ReadLine());

            for (int i = 0; i < seconds; ++i)
            {
                System.Threading.Thread.Sleep(1000);
            }

            for (int i = 0; i < 10; i++)
            {
                Console.Beep();
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-27T13:16:36.967

您应该在转换之前完成检查：

```
int sec;

if (int.TryParse(Console.ReadLine(), out sec)
{
  // this is valid continue
}
else
{
  // show error highlighting that entry must be a number
} 
```

`int.TryParse`将返回一个布尔值，突出显示输入是否可解析为 int。如果成功，它还会将您的`sec`变量设置为该值。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-27T13:18:00.153

您可以无限循环，直到用户输入一个数字：

```
int number = 0;
while(!Int32.TryParse(Console.ReadLine(), out number))
{
    Console.WriteLine("Please input a number.");
} 
```

`Int32.TryParse`如果转换失败则返回`false`，而不是抛出异常，如果成功则在第二个`out`参数中返回结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T13:16:30.850

您应该使用尝试解析方法。

像这样的东西：

```
 int number;
  bool result = Int32.TryParse(Console.ReadLine(), out number); 
```

如果结果为真，那么它已经成功解析它，这意味着它是一个整数。如果不是，它就失败了，这意味着它不是整数。

然后，您可以使用 number 作为解析为 int32 的值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-27T13:21:22.567

已经有人在这里回答了。我喜欢把它做成`extension method`这样，这样我就可以在很多地方调用它。

```
public static bool IsNumeric(this string theValue)
{
  long retNum;
  return long.TryParse(theValue, System.Globalization.NumberStyles.Integer, 
            System.Globalization.NumberFormatInfo.InvariantInfo, out retNum);
} 
```

然后我会这样称呼它

```
if(Console.ReadLine().IsNumeric())
{
    //The value is numeric. You can use it    
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-27T13:17:48.880

代替

```
sec = Convert.ToInt16(Console.ReadLine()); 
```

和

```
try {
    sec = Convert.ToInt16(Console.ReadLine());
}

catch(Exception e ){
    Console.Writeline(" Enter numbers only");
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-27T13:18:35.127

您尝试做的通常称为[Input Validation](http://en.wikipedia.org/wiki/Data_validation)。在您的情况下，您需要在解析之前检查他们是否输入了一个数字。Int16 有一个[TryParse](http://msdn.microsoft.com/en-us/library/9hh1awhy.aspx)函数可以帮助您。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-27T13:23:45.967

添加一个单独的函数，该函数使用 try 语句来捕获当您尝试将无效字符串转换为整数时产生的错误。

```
int readInput()
{
    int sec;
    while(true)
    {
        try
        {
            sec = Convert.ToInt16(Console.ReadLine());
            return sec;
        }
        catch(Exception e) 
                    { 
                            Console.WriteLine("Enter an integer!");
                    }
    }
    return 0;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-27T15:29:09.187

如果您想做一些比显示错误消息并要求用户重新输入数据更优雅的事情，您可以尝试处理每个按键，因为它发生在[Console.Readkey()](http://msdn.microsoft.com/en-us/library/471w8d85.aspx)中，如果会导致字符串不是'，则拒绝它们一个数字。

几年前我在 TurboPascal 中做过类似的事情。

这是从内存中编写的伪代码，但应该让您走上正确的道路。如果您需要采用浮点值以及整数，或者负数和正数，您需要添加更多逻辑来处理这些情况。

```
string enteredText = "";
char key;
bool done = false;
while (!done) 
{
   key = Console.ReadKey();
   if (key is number)
       enteredText += key;
   else if (key is backspace)
   {
       //remove the last char from enteredText.  Handle case where enteredText has length 0
       Console.Write(backspace); 
   }
   else if ((key is enter) && (enteredText.Length > 0))
       done = true;
   else
   {
       // invalid char.
       //MSDN says the char is echoed to the console so remove it
       Console.Write(backspace);
       //Beep at the user?
   }
} 
```

# html - iOS Safari Mobile：不显示正确尺寸的大图像

> ID：11227090
> 
> 赞同：3
> 
> 时间：2012-06-27T13:14:19.127
> 
> 标签：html, css, ios, mobile-safari

当我显示宽度为 1600 像素的图像时，它会正确显示。但是当我显示一个宽度为 1920 像素的图像时，Safari 显示的图像要小得多。

我用：

```
<!-- in the header -->
<meta name="viewport" content="width=device-width;" />

<!-- correct -->
<img src="content/dummy/brand_backgroud_1600_1.jpg" alt="">

<!-- to small -->
<img src="content/dummy/brand_backgroud_1920_1.jpg" alt=""> 
```

我该如何解决这个问题，而不在元标记中设置整体宽度？

这发生在装有 iOS 5.1 的 iPhone 和 iPad 上

**编辑：** 即使使用这个最简单的 html 页面：

```
<!DOCTYPE html>
<html lang="de">

<head>

    <meta charset="UTF-8" />

    <meta name="description" content="" />
    <meta name="keywords" content="" />

    <title></title>

</head>

<body>

    <img src="content/dummy/brand_backgroud_1920_1.jpg" alt="">
    <img src="content/dummy/brand_backgroud_1600_1.jpg" alt="">

</body>
</html> 
```

我得到这个结果：

![在此处输入图像描述](../Images/fdd3475d485bd84a902faaa32b8d4878.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T13:37:45.203

一种方法可能是将图像宽度设置为“100%”，将高度设置为“自动”。这样，所有图像，无论其像素宽度如何，都将显示为其父容器的完整宽度。这实际上也是支持 Retina 的巧妙技巧。

编辑：好的，现在我明白你在说什么了。您希望用户看到全尺寸的 1600 或 1920 图像，并且您不希望 iOS 对其进行缩放。

编辑＃2：所以我尝试了一些不同的事情 - 你是对的。当图像大小高于某个 px 值时，iOS 似乎正在“缩放”没有明确设置宽度或高度的图像。当您明确设置它们时，它们会按预期工作。这似乎是您目前唯一的解决方案。

```
<img src="image_1600.jpg" alt="" style="width: 1600px; height: auto" />
<img src="image_1920.jpg" alt="" style="width: 1920px; height: auto" /> 
```

# c++ - curl CURLE_WRITE_ERROR 错误

> ID：11227095
> 
> 赞同：0
> 
> 时间：2012-06-27T13:14:54.377
> 
> 标签：c++, curl

我在 cpp 中使用 curl_multi_info_read。

如果其他设备没有响应请求，我希望得到 curl 错误代码 CURLE_COULDNT_CONNECT，但我得到错误代码 CURLE_WRITE_ERROR（从 msg->data.result 检索）。

为什么我会收到错误 CURLE_WRITE_ERROR？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T08:35:18.307

CURLE_WRITE_ERROR (23)

将接收到的数据写入本地文件时发生错误，或者从写入回调将错误返回给 libcurl。

请发布您的代码，以便我们提供帮助。

# wcf - 引用 WCFExtras 的 WCF 项目的 MSBUILD 失败

> ID：11227102
> 
> 赞同：1
> 
> 时间：2012-06-27T13:15:09.763
> 
> 标签：wcf, msbuild

我可以使用 Visual Studio 2010 在本地构建，但我们的自动构建无法从 WCFExtras.dll 读取元数据。有任何想法吗？谢谢！

[http://wcfextras.codeplex.com/](http://wcfextras.codeplex.com/)

```
 CSC : fatal error CS0008: Unexpected error reading metadata from file 'c:\Workspace\.unison\XXXXService\Lib\WCFExtras.dll' -- 'Record not found on lookup.'
     [exec] Done Building Project "C:\Workspace\.unison\XXXXService\XXXXService.csproj" (default targets) -- FAILED.
     [exec] Build FAILED.
     [exec] "C:\Workspace\.unison\XXXXService\XXXXService.csproj" (default target) (1) ->
     [exec] (CoreCompile target) -> 
     [exec]   CSC : fatal error CS0008: Unexpected error reading metadata from file 'c:\Workspace\.unison\XXXXService\Lib\WCFExtras.dll' -- 'Record not found on lookup.' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:29:20.643

验证在您的程序集的版本框架和您的部署环境的版本框架之间不存在版本框架的不匹配

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-26T19:24:52.913

我想我遇到了这个问题，因为我有 Project1 和 Project1Console，我将 Project1Console 设置为输出程序集名称 Project1，这样我就可以获得 Project1.exe

我认为当 pdb 已经由 Project1 和混乱创建时，尝试为 Project1Console 创建 Project1.pdb 会导致事情发生爆炸。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-06T15:31:12.503

我有一个类似的问题。对我来说，这是由两个同名的独立项目引起的。命名冲突导致运行时错误，通过重命名第一个项目（即 from `Configuration`to `ConfigurationProvider`）修复了这些错误。

但是，重命名后，我开始收到`Record not found on lookup`错误消息。似乎后一个问题源于`AssemblyName`仍然没有改变（保留以前的`Configuration`命名）。

更改`AssemblyName`（在属性-> 应用程序下）为我解决了这个问题。

TL;DR - 两个项目具有相同的`AssemblyName`.

# translation - 在传输请求/任务中按顺序翻译字符串

> ID：11227104
> 
> 赞同：3
> 
> 时间：2012-06-27T13:15:14.020
> 
> 标签：translation, abap, transport

我编写了一些 ABAP 程序并在自定义消息类中创建了一些消息，它们位于特定的传输请求/任务下。我需要翻译在该传输请求/任务中找到的对象的所有可翻译字符串（消息、文本符号、选择文本等）。

是否有任何工具（事务、程序等）可以顺序翻译所有这些字符串，而无需手动逐个探索对象？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T18:52:05.847

使用[翻译工作清单](http://help.sap.com/saphelp_NW04/helpdata/en/77/571a1f492011d1894a0000e829fbbd/frameset.htm)。为此将要翻译的对象分组到单独的包中可能是明智的 - 这也有助于打包和交付更高版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T13:42:06.847

您可以使用 tcode SE63 来翻译您的消息、程序、屏幕基本上所有内容。

例如，您可以使用此路径来翻译 ABAP 程序中的文本元素：

> se63 -> 翻译 -> ABAP 对象 -> 短文本 -> ABAP 文本 -> REPT 文本元素。

写下您的程序名称及其主要语言和目标语言。去吧。

希望对您有所帮助。

塔尔哈

# class - 是否可以为已编译的 java 文件找到 jdk 供应商

> ID：11227105
> 
> 赞同：3
> 
> 时间：2012-06-27T13:15:16.240
> 
> 标签：class, java, compiled

我试图找出我的类文件的 jdk 供应商，但没能找到。

任何人都可以帮助我找出是否可以找到编译的 java 文件的 jdk 供应商。如果是，那么如何？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T13:22:13.543

请参阅[http://en.wikipedia.org/wiki/Java_class_file](http://en.wikipedia.org/wiki/Java_class_file)。类文件头中没有该信息的位置，仅适用于 Cafe Babe 和类格式版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T13:29:04.790

Java 类文件结构有 10 个基本部分：

```
 Magic Number: 0xCAFEBABE
    Version of Class File Format: the minor and major versions of the class file
    Constant Pool: Pool of constants for the class
    Access Flags: for example whether the class is abstract, static, etc.
    This Class: The name of the current class
    Super Class: The name of the super class
    Interfaces: Any interfaces in the class
    Fields: Any fields in the class
    Methods: Any methods in the class
    Attributes: Any attributes of the class (for example the name of the sourcefile, etc.) 
```

在 java 类文件结构中的任何地方都没有提到 jdk 供应商。您可以阅读`Inside the Java Virtual Machine`第 6 章`The Java Class File`，我相信您将无法找到有关 JDK Vendor 的任何信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T13:41:44.640

不，这在现实中是不可能的。

[`attributes`理论上，Java 编译器可以在表](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.7)中包含一个非标准属性来保存编译器供应商名称。（JVM 特别允许使用非标准属性，并且要求 JVM 忽略任何它不理解的属性。）但是，我知道没有编译器可以做到这一点。

# windows - 按钮的 Windows 加速器，加倍 & 符号后

> ID：11227108
> 
> 赞同：2
> 
> 时间：2012-06-27T13:15:25.273
> 
> 标签：windows, button, powerbuilder, accelerator

我正在使用 PowerBuilder（我猜这与这个问题无关，尽管我可能错了）。

我正在尝试将按钮上的文本设置为“Save && &New”，它应该读作“Save & New”，并带有下划线的“N”。

确实如此，但我不能在“N”上使用加速器。（按 Alt-N 只会发出哔哔声。）

如果我将真正的加速器放在双 & 符号之前，例如“&Save && New”，当我按下 Alt-S 时它可以正常工作。

我想要在＆符号之后的“新建”上，因为我在同一个窗口上有另一个按钮“&Save && Close”，我想区分这两个按钮。

这是 Windows 错误吗？动力生成器？任何解决方法，除了改写，使用更冗长的“和”而不是＆符号等？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:21:04.647

绝对是PB问题。PB 使用它找到的第一个 & 符号来识别快捷键。我不知道有什么方法可以在按钮文本中添加一个＆符号，而不会以某种方式搞砸你的快捷方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:48:51.817

这似乎是一个 PB 错误：我通过将按钮标签设置为`some && &test`

*   不强调“测试”的第一个字母
*   将按钮加速器设置为...“&”（！）

如果我将加倍的 & 符号移回`some &test`，则加速器通常是“t”（使用或不使用 alt 键）。

# windows - joomla 未安装在 Windows 7 终极 64 位

> ID：11227110
> 
> 赞同：0
> 
> 时间：2012-06-27T13:15:40.933
> 
> 标签：windows, joomla, installation

`joomla 2.5`当我单击下一步按钮时，我在填写所有信息（如用户名、密码和数据库名称）后，在第四步中安装到我的计算机中，该过程将继续，而不是第五步。我正在使用`wamp server`64 位。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:57:56.967

只需检查您是否选择了正确版本的数据库，如 Mysql 或 Mysqli。对于测试，您可以使用 XAMPP 检查安装。在相关字段中复制详细信息时检查间距等。HTH :)

# ios - 在initWithCoder中没有调用drawLayer？

> ID：11227112
> 
> 赞同：0
> 
> 时间：2012-06-27T13:15:41.153
> 
> 标签：ios, uiview, calayer, initwithcoder

我正在尝试复制具有某些属性的 UIView。UIView 覆盖了 drawLayer: 方法来绘制自定义形状。

我正在使用 NSKeyedArchiver、粘贴板和 NSKeyedUnarchiver 来取回属性。创建了一个 UIView 实例并设置了属性 - 到目前为止一切都很好。

在 drawlayer 方法中创建了一些属性，它们具有默认值，而不是复制的值。我的问题是，当调用 initWithCoder 并创建实例时，不调用 drawRect 或 drawLayer 吗？为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:37:34.987

当需要渲染或重新渲染内容时，drawLayer/drawRect 会按需（谨慎地）调用。它可能在初始化期间没有被调用，因为没有必要。当视图进入屏幕并需要渲染时，应该稍后调用它。

另外，你说你在drawLayer中创建一些属性？考虑将它们移出一些初始化方法，并使绘图方法只专注于绘图。

# c++ - 使用可移动节点创建有向图（使用 QT / Boost）

> ID：11227115
> 
> 赞同：4
> 
> 时间：2012-06-27T13:16:01.260
> 
> 标签：c++, qt, boost, graph, directed-graph

我正在寻找一种工具来创建有向图，例如，当我单击一个节点时，我可以在其中移动节点并扩展/缩小图形。我想在 QT 界面中使用图形。我想过尝试 Boost Graph Library，但似乎我只能用它创建图形的图像文件。我对 BGL 的了解还不是很深。那么有谁知道是否可以使用 BGL 来绘制图形，然后我可以在其中移动节点？是否可以在 QT 中使用它？还是有其他工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:20:06.453

尝试记住节点边缘图本身没有任何图形表示。因此，为什么 Boost Graph Library 可能无法提供您想要的那种 GUI。

当您了解问题的那一部分时，您的问题与以下问题非常相似：

*   [在 Web UI 中可视化有向图的建议](https://stackoverflow.com/q/1448319/594137)
*   [Java有向图框架[关闭]](https://stackoverflow.com/q/10602045/594137)
*   [用于设计有向图的开源库](https://stackoverflow.com/q/2376987/594137)
*   [有向层次图的良好用户界面](https://stackoverflow.com/q/7133308/594137)

我个人还没有看到旨在成为有向图用户界面框架的 Qt 实现。然而，Qt 将非常有能力，它的[QGraphicsScene](http://qt-project.org/doc/qt-4.8/qgraphicsscene.html)类是您研究的一个很好的起点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-06-03T09:43:44.937

看一下 Qt Visual Graph Editor 项目：

[https://arsmasiuk.github.io/qvge/](https://arsmasiuk.github.io/qvge/)

具有表示图 + 节点/边的基类以获取灵感。支持读取和导出各种常见的图形标记格式（例如 GraphViz 文件）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-17T17:30:49.670

我知道[QuickQuanva](https://github.com/cneben/QuickQanava)和[NodeGraphQt](https://github.com/jchanvfx/NodeGraphQt)框架。然而，后者是用 Python 编写的。

# html - 如何将多个图像添加到 html5 画布

> ID：11227117
> 
> 赞同：3
> 
> 时间：2012-06-27T13:16:04.753
> 
> 标签：html, html5-canvas

我正在尝试将多个图像添加到**Html5 画布**，但每次我尝试删除最后一个图像并显示最新的图像时它都会失败。这是我的代码：

```
var imgArray = ['abc.png','455.jpg'];
    for(i = 0; i < 2; i++){
        var canvas = document.getElementById('canvas');
        var context = canvas.getContext("2d");
        var imageObj = new Image();
        imageObj.src = imgArray[i];
        imageObj.onload = function() {
        context.drawImage(this,0,0);
    };
} 
```

如果我运行此代码，它会在画布上显示第二张图像并删除第一张图像。有没有办法保留两个图像？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T13:29:14.473

实际上 onLoad 总是使用变量的**最后一个**值。所以存储（计算） img x, y**之前**的坐标。像这样：

```
imageObj.setAtX = i * 10;
imageObj.setAtY = i * 10;
imageObj.onload = function() {
     context.drawImage(this, this.setAtX, this.setAtY);
}; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-12-04T19:42:34.517

我用easeljs试过了。这可能会帮助你。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Upload and display images on HTML5 Canvas</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=320; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">  
    <script src="http://code.createjs.com/easeljs-0.5.0.min.js"></script> 
    <script type="text/javascript" src="libs/upclick-min.js"></script>
</head>
<body onload="init()">
    <div>
        <input id="uploader" type="button" value="Upload picture from hard disk">       
    </div>
    <canvas  width="1000" height="550" id="canvas"></canvas>
    <script type="text/javascript">
        var canvas;
        var stage;      
        var uploader = document.getElementById('uploader');
        /**
         * UPLOAD SCRIPT 
         * This script uses the upclick-min.js library to upload files on a webserver folder
         * using a PHP script ("upload/upload.php")
         * Project homepage: http://code.google.com/p/upload-at-click/
         */
        upclick(
        {
          element: uploader,
          action: 'upload/upload.php', 

          onstart:
            function(filename)
            {
              //alert('Start upload: '+filename);
            },

          oncomplete:
            function(response_data) 
            {
              // Check upload Status
              if (response_data != "FAIL") {      
                // Draw the picture into Canvas     
                // "response_data" contains the image file name returned from the PHP script
                displayPicture("upload/" + response_data);
                }
            }
        });
        /**
         * Init 
         */

        init = function () {
            canvas = document.getElementById("canvas");
            stage = new createjs.Stage(canvas);
        }
        /**
         * Load and display the uploaded picture on CreateJS Stage 
         */
        displayPicture = function (imgPath) {
            var image = new Image();
            image.onload = function () {
                // Create a Bitmap from the loaded image
                var img = new createjs.Bitmap(event.target)

                // scale it
                img.scaleX = img.scaleY = 0.5;

                /// Add to display list
                stage.addChild(img);

                //Enable Drag'n'Drop 
                enableDrag(img);

                // Render Stage
                stage.update(); 
            }
            // Load the image
            image.src = imgPath;
        }
        /**
         * Enable drag'n'drop on DisplayObjects
         */
        enableDrag = function (item) {
            // OnPress event handler
            item.onPress = function(evt) {
                var offset = {  x:item.x-evt.stageX, 
                                y:item.y-evt.stageY};

                // Bring to front
                stage.addChild(item);

                // Mouse Move event handler
                evt.onMouseMove = function(ev) {

                    item.x = ev.stageX+offset.x;
                    item.y = ev.stageY+offset.y;
                    stage.update();
                }
            }
        }
    </script>   
</body>
</html> 
```

上传/上传.php

```
<?php
$tmp_file_name = $_FILES['Filedata']['tmp_name'];
$ok = move_uploaded_file($tmp_file_name, $_FILES['Filedata']['name']);

// This message will be passed to 'oncomplete' function
echo $ok ? $_FILES['Filedata']['name'] : "FAIL";

?> 
```

lib/upclick-min.js

```
function upclick(d){var g={element:null,action:"about:blank",action_params:{},maxsize:0,onstart:null,oncomplete:null,dataname:"Filedata",target:null,zindex:"auto"};for(var h in g)d[h]=d[h]?d[h]:g[h];var k=d.element;if(typeof k=="string")k=document.getElementById(k);var e=k.ownerDocument,b,c=e.createElement("div"),n="frame"+(new Date).getTime().toString().substr(8);c.innerHTML='<iframe name="'+n+'" src="about:blank" onload="this.onload_callback()"></iframe>';var i=c.childNodes[0];i.onload_callback=
function(){var a=e.createElement("form");c.appendChild(a);a.method="post";a.enctype="multipart/form-data";a.encoding="multipart/form-data";if(d.target){a.target=d.target;a.setAttribute("target",d.target)}else{a.target=n;a.setAttribute("target",n)}a.action=d.action;a.setAttribute("action",d.action);a.style.margin=0;a.style.padding=0;a.style.height="80px";a.style.width="40px";a.runat="server";var j=d.action_params;for(var p in j){var m=e.createElement("input");m.type="hidden";m.name=p;m.value=String(j[p]);
a.appendChild(m)}if(d.maxsize){j=e.createElement("input");j.type="hidden";j.name="MAX_FILE_SIZE";j.value=String(d.maxsize);a.appendChild(j)}b=e.createElement("input");b.name=d.dataname;b.type="file";b.size="1";b.runat="server";a.appendChild(b);b.style.position="absolute";b.style.display="block";b.style.top=0;b.style.left=0;b.style.height=a.style.height;b.style.width="80px";b.style.opacity=0;b.style.filter="alpha(opacity=0)";b.style.fontSize=8;b.style.zIndex=1;b.style.visiblity="hidden";b.style.marginLeft=
"-40px";var o=function(){if(b.value){var f=d.onstart;f&&f(b.value);a.submit()}};if(b.addEventListener)b.addEventListener("change",o,false);else if(b.attachEvent)b.attachEvent("onpropertychange",function(f){if(!f)f=window.event;f.propertyName=="value"&&o()});else b.onpropertychange=o;i.onload_callback=function(){var f=null;if(i.contentWindow)f=i.contentWindow;else if(i.contentDocument)f=i.contentDocument.defaultView;f=f.document.body.innerHTML;var q=d.oncomplete;q&&q(f);a.reset()}};i.style.display=
"none";i.width=0;i.height=0;i.marginHeight=0;i.marginWidth=0;e.body.insertBefore(c,e.body.firstChild);c.style.position="absolute";c.style.overflow="hidden";c.style.padding=0;c.style.margin=0;c.style.visiblity="hidden";c.style.width="0px";c.style.height="0px";if(d.zindex=="auto"){g=0;var l;for(h=k;h.tagName!="BODY";){l=h.currentStyle?h.currentStyle:getComputedStyle(h,null);l=parseInt(l.zIndex);l=isNaN(l)?0:l;g+=l+1;h=h.parentNode}c.style.zIndex=g}else c.style.zIndex=d.zindex;g=function(a){if(!a)a=
window.event;c.style.width="0px";c.style.height="0px";if(e.elementFromPoint(a.clientX,a.clientY)===k){c.style.width="40px";c.style.height="80px"}};if(c.addEventListener)c.addEventListener("mousemove",g,false);else c.attachEvent&&c.attachEvent("onmousemove",g);g=function(a){if(!a)a=window.event;var j=y=0;if(a.pageX)j=a.pageX;else if(a.clientX)j=a.clientX+(e.documentElement.scrollLeft?e.documentElement.scrollLeft:e.body.scrollLeft);if(a.pageY)y=a.pageY;else if(a.clientY)y=a.clientY+(e.documentElement.scrollTop?
e.documentElement.scrollTop:e.body.scrollTop);c.style.left=j-20+"px";c.style.top=y-40+"px";c.style.width="40px";c.style.height="80px"};if(k.addEventListener)k.addEventListener("mousemove",g,false);else k.attachEvent&&k.attachEvent("onmousemove",g)}; 
```

来源。观看视频以了解其工作原理 ^^ [http://www.fabiobiondi.com/blog/2012/10/upload-images-from-the-user-hard-driveto-an-html5-canvas-easel-js-应用/](http://www.fabiobiondi.com/blog/2012/10/upload-images-from-the-user-hard-driveto-an-html5-canvas-easel-js-application/)

# android - Android - 从应用程序获取视频时有没有办法定义视频分辨率？

> ID：11227119
> 
> 赞同：6
> 
> 时间：2012-06-27T13:16:07.353
> 
> 标签：android, resolution, video-capture

我不熟悉android编程，

我想知道在android应用程序中拍摄视频时是否有办法设置视频分辨率？

或者，以后有没有办法降低分辨率。

我们需要减小我们捕获的视频的文件大小。

谢谢

沙尼

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-27T13:31:22.650

在录制视频时，您可以控制三件事来管理生成的文件大小。这三个都可以作为`MediaRecorder`类中的方法使用：

1.  框架尺寸（宽 x 高）。使用方法`setVideoSize(int width, int height)`。帧尺寸越小，视频文件越小。

2.  编码比特率 - 这控制每帧的压缩质量。使用方法`setVideoEncodingBitRate (int bitRate)`。较低的比特率会导致更高的压缩率，这反过来会导致质量降低和视频文件大小减小。这仅适用于 API 级别 8 及更高级别。

3.  视频“速度” - 每秒捕获多少帧。使用`setVideoFrameRate (int rate)`方法。速率越低，您将捕获的帧越少 - 导致视频文件更小。这仅适用于 API 级别 11 及更高级别。请记住，要获得流畅的视频，您至少需要每秒 24 帧。

查看 MediaRecorder 的文档以获取更多信息。

# iphone - 在@interface 中声明 IBOutlet 是什么意思？

> ID：11227121
> 
> 赞同：1
> 
> 时间：2012-06-27T13:16:12.557
> 
> 标签：iphone, objective-c, iboutlet

`@interface`在vs中声明 IBOutlet 是什么意思？在一个简单的测试中，分配在任何一种情况下都有效。

```
@interface MyViewController : UIViewController <UITextFieldDelegate> {

    IBOutlet UITextField *textField;
    IBOutlet UILabel *label;
    NSString *string;
    /*IBOutlet*/ UILabel *total;//What does it mean to declare IBOutlet here?
}

@property (nonatomic, retain) IBOutlet UILabel *total; 
```

`.h`

```
@synthesize total;
total.text = @"23"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T13:22:39.987

该术语`IBOutlet`只是 Xcode 的占位符。通过它，Xcode 可以帮助您将实例变量连接到图形元素。

这是我以前的旧答案：[iOS 内存管理问题](https://stackoverflow.com/questions/9055926/ios-memory-management-issue)。

看一看。它涵盖了很多东西。

我还建议阅读**Mike Ash**的[nib-memory-management](http://www.mikeash.com/pyblog/friday-qa-2012-04-13-nib-memory-management.html)。

 **希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T13:18:53.657

这意味着 ivar 将是一个 IBOutlet。就像您当前的财产是 IBOutlet 一样。

你在命名你的 ivar 和 property 时犯了一个更大的错误。

`total.text`并且`self.total.text`在你的文件中不是一回事。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-27T13:18:55.467

IB 没有区别，但是，在您的财产到位后，您`UILabel`将被保留并且您必须释放它（如果您不使用 ARC）。如果您不使用`@property`，则该标签不归您所有，您无需释放它。**

# apache - 将 apache 配置与乘客和 mod_proxy 混淆

> ID：11227123
> 
> 赞同：1
> 
> 时间：2012-06-27T13:16:13.260
> 
> 标签：apache, passenger

我无法弄清楚如何为以下内容配置 apache：

www.server.com/mstar 应该通过乘客

但其他任何东西，例如：www.server.com/ www.server.com/index.hmtl 等都应该通过 mod 代理。

所以，我需要检查它是否有 /mstar 作为路径的第一个组件，如果有，让它通过乘客服务。但其他任何事情都应该通过 mod_proxy。

就像是：

```
<VirtualHost *:80>
    ServerName beta.server.com

    DocumentRoot /home/ruby/webapps/m-star/current/public

    <Location /mstar>
        PassengerEnabled on
        RailsBaseURI /mstar
        # This relaxes Apache security settings.
        AllowOverride all
        # MultiViews must be turned off.
        Options -MultiViews FollowSymLinks
        Order allow,deny
        Allow from all
    </Location>

    ProxyPass / http://beta.server.com:8890
    ProxyPassReverse / http://beta.server.com:8890
    <Location />
        PassengerEnabled off
        Order allow,deny
        Allow from all
    </Location>
</VirtualHost> 
```

但是，这当然是行不通的。

你能给我一些关于在 apache 配置和乘客配置中查看什么来完成此操作的指示吗？

我得到了以下工作：

正如我所描述的，我得到了以下工作：

```
<VirtualHost *:80>
ServerName beta.server.com

ProxyRequests Off
<Proxy *>
    Order deny,allow
    Allow from all
</Proxy>

PassengerEnabled off

ProxyPassMatch ^/(?!mstar)(.*) http://beta.server.com:8890/$1
ProxyPassReverse / http://beta.server.com:8890

DocumentRoot /home/ruby/webapps/m-star/current/public
<Directory "/home/ruby/webapps/m-star/current/public">
    PassengerEnabled on
    RailsBaseURI /mstar
    # This relaxes Apache security settings.
    AllowOverride all
    # MultiViews must be turned off.
    Options -MultiViews FollowSymLinks
    Order allow,deny
    Allow from all
</Directory>

</VirtualHost> 
```

# c++ - 通缉：软件系统用户的编译工具

> ID：11227124
> 
> 赞同：0
> 
> 时间：2012-06-27T13:16:26.520
> 
> 标签：c++

我不确定这个问题的标题是否切中要害。我已经用 C C++ for Windows 编写了一个大型软件系统，并希望为该系统的用户提供添加编译代码的选项。用户应该能够做基本的事情，并与我的程序交换数据。

目前实现的方式是通过 DLL。但是为此，需要一个成熟的编译器，这并不像我希望的那么容易。是否有可以创建 Windows DLL 的微型 C 编译器？

另一个想法是 Java 原生接口。但这需要一个完整的Java系统在后台运行，在里面运行代码并不容易。

你还有其他建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:20:38.177

任何解释语言？（TCL 和 Lua 被设计为扩展语言，但您几乎可以轻松地与任何其他语言交互）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-17T11:29:51.727

其中一种方法是添加脚本。您的应用程序可以托管脚本环境并在那里公开其服务。用户将能够执行 JScript/VBScript 脚本并与您的应用程序交互。优点是，通过合理的努力，您可以将众所周知且有据可查的脚本语言的功能引入您的应用程序（我想那里甚至还有用于脚本的调试器）。您将需要塑造您的应用程序服务，因为 COM 接口和脚本将能够使用您在 C++ 端分配的方法名称自动访问它们。

*   [C++、Win32 和脚本：向您的应用程序添加脚本支持的快速方法](http://www.codeproject.com/Articles/349554/Cplusplus-Win32-and-Scripting-Quick-way-to-add-Scr)
*   [MSDN 入口点 - IActiveScript 接口](http://msdn.microsoft.com/en-us/library/ky29ffxd%28v=vs.94%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T09:13:22.477

解释性语言还不够好。我需要速度。该软件本身是一种解释性语言。所以我添加了对微型 C 编译器的支持。它只是 C，我确实检查了 mingw，它可能不会像这个那么小。感谢您的所有提示。

几个月后添加：

实际上，我现在有两个工具：TinyC 和 Python。它们之间的速度差异很明显（5-10 倍），但这通常无关紧要。Python 对用户来说要容易得多，尽管我设法将两者很好地集成到 Euler GUI 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T14:39:16.590

正如另一个人所说，您最好提供嵌入式语言。

我会加入 javascript 并使用[google v8 引擎](http://code.google.com/p/v8/) 通过使用 javascript，您可以获得几乎所有人都可以使用和编程的语言。您可以嵌入其他 javascript 引擎，例如[SpiderMonkey](https://developer.mozilla.org/en/SpiderMonkey)。请参阅此[答案](https://stackoverflow.com/questions/93692/which-javascript-engine-would-you-embed-in-an-application)以了解如何选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-27T13:25:55.123

python集成怎么样？

您可以创建一个与您的应用程序交互的 python 接口。Python 相当容易学习，应该很容易与 c/c++ 集成。[python 文档对此有自己的章节。](http://docs.python.org/extending/index.html)

您还可以使用[swig](http://www.swig.org/Doc1.3/Python.html)之类的工具来生成界面。

这样做的好处是他们不必编译任何东西。他们可以只提供可以加载到您的应用程序并在软件中运行的 python 文件。这是 python 的一个众所周知的用途，它的简单语法促进了这一点。

# c - C：将不同的单词保存到链表中

> ID：11227131
> 
> 赞同：-2
> 
> 时间：2012-06-27T13:16:37.140
> 
> 标签：c, copy, linked-list, unique, distinct

> **可能重复：**
> [将不同的单词保存到链表中](https://stackoverflow.com/questions/11207176/save-distinct-words-into-linked-list)

我正在尝试编写一个从 1 个链表中读取单词的代码。

然后确定不同/唯一的单词，并将这些单词保存到另一个链表中。

不幸的是代码不起作用，需要帮助来解决这个问题。

这是我到目前为止所得到的，我已经添加了评论希望它有所帮助。

```
struct list {

    char string[50];
    struct list *next;
};

list *header;
list *next = NULL;

struct distinct {

    char string[50];
    struct distinct *dnext; 
};

distinct *track;
distinct *dnext;

void checkdistinct() {

        int dwcheck = 0;  //as boolean to check whether distinct word is found
        list *ori;        //first struct
        ori = header->next;
        distinct *copy;   //second struct
        distinct *check = NULL;

        track = (distinct*)malloc(sizeof(distinct));
        track->dnext=NULL;
        copy = track;

        if(copy == track) {   // direct copy first time
            strcpy(copy->string, ori->string);
        }
        else {}

        while(ori->next!=NULL) { // while original struct did not end
            check = track;      

            while(check->dnext != NULL) { //check end when second list ends
                    if(strcmp(ori->string, check->string)!=0) {
                        check = check->dnext;
                    }
                    else if(strcmp(ori->string, check->string)==0) {
                        dwcheck = 1;
                        ori = ori->next; // original list will move one node next
                        check = check->dnext; // check pointer continues
                    }
            }

            copy->dnext = (distinct*)malloc(sizeof(distinct)); // new node for new word
            copy = copy->dnext;

            if(dwcheck != 1) { // when boolean = false, original will move one node next, next word will be copied
                ori = ori->next;   // as the node is moved one node (above) when boolean = true
            }
            else if(dwcheck == 1) {
                strcpy(copy->string, ori->string);
            }

            dwcheck = 0; // reset
            copy->dnext=NULL; // set not copied node as NULL each time
            check = NULL; // reset
        }

    } 
```

我的第一个清单：你好我的名字叫超人

我的第二个列表：你好，我的名字 <-- 仍然是

抱歉编码不好，仍然是新手。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:22:58.667

我认为最好先对原始列表进行排序。然后你可以这样做：

```
prev = 0; current = first string;

while (current) {
  if (strcmp(prev, current)!=0) {
     add current to distinct list;
  } 
  prev = current;
  current = current->next;
} 
```

这部分对我来说也没有意义，因为它永远都是真的：

```
 copy = track;

    if(copy == track) {   // direct copy first time
        strcpy(copy->string, ori->string);
    } 
```

# javascript - 如何在jquery中找到第一个父元素

> ID：11227133
> 
> 赞同：12
> 
> 时间：2012-06-27T13:16:42.380
> 
> 标签：javascript, jquery, html, dom

考虑下面的html -

```
<div class="container1">
   <div class="container2">
      <div class="container3">
         <div class="container4">
             <div class="element">
             ...
         </div>
      </div>
   </div>
</div> 
```

如果我想获取`<div class="element">`元素并且我参考了`container1`. 在 jquery 中，我所做的是，

```
$(".container1").find(".element") 
```

代替 -

```
$(".container1").children().children().children().find(".element") 
```

当我引用任何父元素时，这是查找任何子元素的过程。但是，当我引用子元素并想要获取父元素时，每次我必须上一级 -

```
$(".element").parent().parent().parent().parent() 
```

而我不能这样做——

```
$(".element").findParent() 
```

我在 jquery 中没有遇到任何像 findParent() 这样的方法。有没有我不知道的？还是由于某种原因它不存在？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-27T13:18:09.363

```
$(".element").parents(); 
```

将给`.element`*（包括`html`和`body`）的所有父母*

**[演示](http://jsfiddle.net/QStkd/509/)**

要找到任何特定的父母，假设`container1`然后

```
$('.element').parents('.container1') 
```

**[演示](http://jsfiddle.net/QStkd/508/)**

jQuery[`.parents()`](http://api.jquery.com/parents)通常会找到所有父母，但如果你传递了一个选择器，那么它会搜索它。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-06-27T13:18:01.413

只需使用

```
$(".element").closest('#container1'); 
```

如果没有`id`找到那个祖先，那么

`$(".element").closest('#container1').length`将会`0`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-14T13:47:51.343

为了亲自获得第一个父母，我使用以下结构：

```
var count_parents = $(".element").parents().length;
$(".element").parents().eq(count_parents - 1); 
```

希望对某人有所帮助。

# ruby-on-rails - has_secure_password 在创建时保存安全密码，而不是在更新时

> ID：11227134
> 
> 赞同：0
> 
> 时间：2012-06-27T13:16:44.093
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在使用“has_secure_password”方式在数据库中存储安全密码。当管理员创建用户时（在我的应用程序中创建用户，用户不能自己创建帐户），在用户模型中，password_digest 由创建随机密码的方法填充（参见代码）。然后保存记录时，它会被安全保存。所以用户方法是创建一个密码摘要说“TY5665^%^”，然后将它保存在数据库中说“Y^6&$d%$56GFT”。伟大的！

```
before_validation :create_random_password, :on => :create

 def create_random_password
    self.password_digest = SecureRandom.hex(5)
  end 
```

但是当新用户登录并更改他的个人资料中的密码时，新密码会保存好，但不安全！假设用户将其更改为“password1”，它也会在数据库中保存为“password1”。那么为什么安全密码在创建时有效，但在更新时无效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:38:41.553

在没有看到您的更新代码的情况下，请确保您的更新是 :password，而不是 :password_digest。创建进入 :password_digest 的密码哈希背后的魔力只从 :password 开始。

很惊讶您可以将自己的密码直接保存到 :password_digest 中，并且在身份验证时它会起作用。我认为它会采用用户提供的密码，对其进行哈希处理，然后将哈希值与 :password_digest （这不可能是他们的密码）进行比较。

这就是我所做的，这可能会解决问题：

```
before_create :set_temporary_password

def set_temporary_password
  self.temporary_password = SecureRandom.hex(5)
end 
```

发送用户 self.temporary_password，当他们更新它时，将 temporary_password 更改为 nil。然后您可以知道用户何时有需要更改的临时密码。

# c# - UnderlyingSystemType 何时与当前 Type 实例不同

> ID：11227136
> 
> 赞同：21
> 
> 时间：2012-06-27T13:16:53.657
> 
> 标签：c#, .net, clr, base-class-library

`System.Type`包含一个`UnderlyingSystemType`属性。MSDN[指出](httpS://msdn.microsoft.com/en-us/library/system.type.underlyingsystemtype.aspx)：

> 指示由公共语言运行时提供的表示此类型的类型。

在大多数情况下，此属性仅返回当前`Type`实例。

我的问题是，在什么情况下这个属性*不*返回当前`Type`实例本身。在这些情况下，当前`Type`实例和返回的底层系统类型是什么类型？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-27T13:30:04.977

老实说，我从来没有自己做过，但我知道可以创建自己`RuntimeType`的指定类型的类似定义。

如果你注意到这个`Type`类是抽象的并且有很多抽象成员。发生的情况是*您的*类型（无论它是什么）自动从类创建`RuntimeType`派生并为您的类型实现它。`Type`

因此，`UnderlyingSystemType`在普通情况下的属性`RuntimeType`将返回`Type`属性相等的值，而在覆盖实现的情况下，（那是为了影响反射行为，但我再说一遍，我个人以前从未这样做过），将返回用户定义的类型值。

**编辑**

实际上，家伙在评论中提供的链接是一个很好的链接：

[什么时候类型不是类型？](http://bradwilson.typepad.com/blog/2009/02/when-is-a-type-not-a-type.html)

# java - java - 如何使用java swing不可见地截取屏幕截图？

> ID：11227137
> 
> 赞同：-6
> 
> 时间：2012-06-27T13:17:07.157
> 
> 标签：java, image, swing, screenshot

> **可能重复：**
> [Java Swing：获取`Image`JFrame](https://stackoverflow.com/questions/5853879/java-swing-obtain-image-of-jframe)

我想偷偷拍jpanel的截图怎么办。

我不知道请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:30:08.800

我不确定“隐形”是什么意思。检查它是否有帮助。

要将快照从 java.awt.Components 保存为 JPEG 或任何其他格式文件，您只需：

*   创建一个与组件尺寸相同的 BufferedImage。
*   将 Component 的内容绘制到 BufferedImage 中。
*   使用 JPEG 包和标准 FileOutputStream 将 BufferedImage 保存到文件中。

* * *

```
void getSnapShot(JPanel panel ){  
       BufferedImage bufImg = new BufferedImage(panel.getSize().width, panel.getSize().height,BufferedImage.TYPE_INT_RGB);  
       panel.paint(bufImg.createGraphics());  
       File imageFile = new File("."+File.separator+snapshotLocation);  
    try{  
        imageFile.createNewFile();  
        ImageIO.write(bufImg, "jpeg", imageFile);  
    }catch(Exception ex){  
    }  
} 
```

# javascript - 禁用链接，直到所有动画停止并再次启用它们

> ID：11227140
> 
> 赞同：0
> 
> 时间：2012-06-27T13:17:32.103
> 
> 标签：javascript, jquery, css

我有一个像动画一样的图像滑块，不同之处在于一张幻灯片中有几个元素，在我的例子中，有 4 张图片来自场景的左侧或右侧。

问题是如何使触发动画功能的链接被禁用，直到动画100％完成，然后再次启用。

这是我的代码...

```
$(document).ready(function() {

//
$('.package_box_menu li').children().click(function(){

    $(this).showProducts($(this).attr("id"))

});

jQuery.fn.showProducts = function (clickedSeason) {

    var nextToShowSide = $('.'+[clickedSeason]+'_img1').attr("rel");            
    var active = $('img[ rel |= active]').attr('season');

    if (nextToShowSide == 'right') {var whereTo = '-1000px'; var currentToHideSide ="left" };
    if (nextToShowSide == 'left') {var whereTo = '3000px'; var currentToHideSide ="right" };    

    show();
    hide(active, whereTo, currentToHideSide);

    function show(){

        var allToShow = ($('img[ season |= '+[clickedSeason]+']').get()).length;            
        for (var i = 1; i<= allToShow ; i++){
            var delay =  $('.'+[clickedSeason]+'_img'+[i]).attr('delay');
            var position = $('.'+[clickedSeason]+'_img'+[i]).attr('left');
            $('.'+[clickedSeason]+'_img'+[i]).stop().delay(delay).animate({'margin-left': position }, 1000, 'easeOutExpo').attr('rel','active');            
        }       
    };

    function hide(active, whereTo, currentToHideSide){

        var all = ($('img[ rel |= active]').get()).length;
        for (var i = 1; i<= all ; i++){
            if ($('.'+[active]+'_img'+[i]).attr('rel') == 'active') {
                $('.'+[active]+'_img'+[i]).stop().delay([i]+'00').animate({'margin-left': whereTo }, 1000, 'easeInExpo').attr('rel', currentToHideSide );
            }
        } 

    };

};

jQuery().showProducts('spring');

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:21:38.383

如果您只是想确保在制作动画时未点击链接，请将其添加到您的点击中。

```
$('.package_box_menu li').children().click(function(){
    if($('img[class$=img1]').is(':animated')) {
      event.preventDefault();
      return false;
    }

    $(this).showProducts($(this).attr("id"));

}); 
```

这只会在动画时拒绝点击，然后在停止时工作。*$(this) 可以替换为正在动画的东西，例如你的幻灯片*:)

**笔记**

由于没有显示 HTML，我不得不对我使用的选择器做出一些假设 'img[class$=img1]' 这是一个 img，其中类以 'img1' 结尾，取自`'_img1').attr("rel");`

将您的网站复制到 Fiddle 并使用我[在此处提到的更改](http://jsfiddle.net/qE4Vc/)

# php - 字符 a 与 MySQL 数据库中的 A 相同

> ID：11227143
> 
> 赞同：2
> 
> 时间：2012-06-27T13:17:40.670
> 
> 标签：php, mysql, unicode, utf-8

我想开发一个短url系统，比如bitly，我的数据库有问题。我无法区分数据库中的 a 和 A 。

这是我保存在数据库中的内容：

```
1   aaaaaaa a   a   a   a   a   a   a   aaaaaaa 1340802562  
3   aaaaaab a   a   a   a   a   a   b   aaaaaab 1340802562  
5   aaaaaac a   a   a   a   a   a   c   aaaaaac 1340802562  
7   aaaaaad a   a   a   a   a   a   d   aaaaaad 1340802562 
```

在 id 2，我应该有 aaaaaaB。这是表结构属性：

```
1   id  bigint(20)      UNSIGNED    Nu  None    AUTO_INCREMENT    Schimbare   Aruncă     More 
     2  combination varchar(8)  utf8_general_ci     Nu  None          Schimbare   Aruncă     More 
     3  a   varchar(2)  utf32_general_ci        Nu  None          Schimbare   Aruncă     More 
     4  b   varchar(2)  utf8_general_ci     Nu  None          Schimbare   Aruncă     More 
     5  c   varchar(2)  utf8_general_ci     Nu  None          Schimbare   Aruncă     More 
     6  d   varchar(2)  utf8_general_ci     Nu  None          Schimbare   Aruncă     More 
     7  e   varchar(2)  utf8_general_ci     Nu  None          Schimbare   Aruncă     More 
     8  f   varchar(2)  utf8_general_ci     Nu  None          Schimbare   Aruncă     More 
     9  g   varchar(2)  utf32_general_ci        Nu  None          Schimbare   Aruncă     More 
     10 url varchar(255)    utf8_general_ci     Nu  None          Schimbare   Aruncă     More 
     11 time    int(10)         Nu  None          Schimbare   Aruncă     More 
     12 status  int(10)         Nu  None          Schimbare   Aruncă     More 
```

这是代码：

```
<?php
require_once('Controller.php');

class ShortLink extends Controller {
  public $chars="aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPq1Qr2Rs3St4Tu5Uv6Vw7Wx8Xy9Yz0Z";
  public function generate() {
    $this->DBconnect();
    echo $length = strlen($this->chars);
    for($a=0;$a<$length;$a++) {
      for($b=0;$b<$length;$b++) {
        for($c=0;$c<$length;$c++) {
          for($d=0;$d<$length;$d++) {
            for($e=0;$e<$length;$e++) {
              for($f=0;$f<$length;$f++) {
                for($g=0;$g<$length;$g++) {
                  $combination = $this->chars[$a].$this->chars[$b].$this->chars[$c].$this->chars[$d].$this->chars[$e].$this->chars[$f].$this->chars[$g];
                  mysql_query("
                    INSERT INTO `short` (
                      `id`,
                      `combination`,
                      `a`,
                      `b`,
                      `c`,
                      `d`,
                      `e`,
                      `f`,
                      `g`,
                      `url`,
                      `time`,
                      `status`
                    )
                    VALUES (
                      NULL,  '".($combination)."', '".($this->chars[$a])."',  '".($this->chars[$b])."',  '".($this->chars[$c])."',  '".($this->chars[$d])."',  '".($this->chars[$e])."',  '".($this->chars[$f])."',  '".($this->chars[$g])."',  '".($combination)."',  '".(time())."',  '0');");
                }
              }
            }
          }
        }
      }
    }
    $this->DBdisconnect();
  }
}
$ShortLink = new ShortLink();
$ShortLink->generate();
?> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-27T13:19:50.627

看到所有这些了`utf8_general_ci`吗？该`_ci`部分表示排序规则不区分大小写。

[http://dev.mysql.com/doc/refman/5.6/en/charset-unicode-sets.html](http://dev.mysql.com/doc/refman/5.6/en/charset-unicode-sets.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-27T13:20:14.713

“a”与“A”相同的原因是您的排序规则：`utf8_general_ci`

末尾的“ci”代表“不区分大小写”。

您需要更改排序规则。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T13:21:28.263

" `LIKE BINARY`" 可能会有所帮助

[http://dev.mysql.com/doc/refman/5.1/en/string-comparison-functions.html#operator_like](http://dev.mysql.com/doc/refman/5.1/en/string-comparison-functions.html#operator_like)

# wcf-rest - wcf 宁静服务中的长时间计算

> ID：11227153
> 
> 赞同：1
> 
> 时间：2012-06-27T13:18:12.113
> 
> 标签：wcf-rest, webhttpbinding

我有一个 WCF RESTful 服务，它工作正常，问题是该服务公开了一个“计算”方法，完成计算可能需要几分钟，而且由于 REST 是一种无状态方法，我的想法已经用完了！

我应该保持会话吗？

我该怎么做回调？

10分钟在网站上等待回复很不方便，但我必须找到解决方案。

**PS：服务一定要安静，不能减少计算时间。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:43:36.143

我询问了您的客户，因为如果他们只是.Net，您可以实现异步编程模型，但因为它们不是......

您可以在这篇文章中执行类似的操作 - [WCF Rest Asynchronous Calling Methods](https://stackoverflow.com/questions/6507957/wcf-rest-asynchronous-calling-methods)

基本上，您的方法将产生一个额外的线程来执行实际的计算工作，并立即在主线程中将某种令牌返回给调用客户端。然后，客户端可以在轮询方法中使用此令牌来检查计算是否完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:21:14.280

您可以创建单向 WebMethod 来提交初始计算请求。在您的计算代码中，您需要更新数据库表或与进度类似的数据库表，无论是百分比还是完成。

然后，您需要使用上表创建一个额外的“轮询”方法，您可以使用它来检查状态。

当您的计算方法将其标记为完成时，您可以调用最终的“GetResults”方法来完成此操作。

我们对通过 Web 服务提交的大文件导入做了类似的事情，并且效果很好。

一些信息；

[http://msdn.microsoft.com/en-us/library/system.web.services.protocols.soapdocumentmethodattribute.oneway(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/system.web.services.protocols.soapdocumentmethodattribute.oneway(v=vs.71).aspx)

# android - 进度对话框和上下文 - 窗口泄露

> ID：11227159
> 
> 赞同：0
> 
> 时间：2012-06-27T13:18:33.967
> 
> 标签：android, android-layout

我目前正在尝试定义一个单独的类来显示 ProgressDialogs，因为我不想在每个活动中创建单独的 progressDialog 实例。我目前正在将当前活动上下文发送到该方法。事情似乎工作正常，但有时（非常随机）它会导致异常声明窗口泄漏。我什至知道如果我试图在已完成的上下文上显示对话框，则会发生窗口泄漏。而且我认为这里的问题可能是因为代码的其他部分在显示我的对话框之前完成了我的上下文。所以我只想确保如果上下文有任何问题，我的方法不会显示对话框。有什么方法可以知道我传递的上下文当前是否在屏幕上可见，这样我就不会遇到这些窗口泄漏的异常。

并且还尝试用 getApplicationContext() 替换上下文。但是此更改根本不显示进度对话框。

任何帮助将不胜感激。

谢谢大家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:25:03.403

关闭 onPause() 方法中的对话框。

# wpf - 如何摆脱底部的 WPF Datagrid 额外空间（行？）？

> ID：11227163
> 
> 赞同：0
> 
> 时间：2012-06-27T13:18:46.483
> 
> 标签：wpf, datagrid, row, space

我有这个数据网格，有时它会在底部显示那个可怕的灰色空间，它甚至似乎没有要显示的模式......有时它在那里，有时它不存在。我已经尝试将 CanUserAddRows 设置为 false，但它没有修复它。它也不是我收藏中的额外项目，我只是用调试器检查了它。我真的需要消除这种行为，有什么想法吗？

![数据网格额外空间](../Images/546fffdd54227513e3f8c02e3e9148b3.png)

```
<DataGrid x:Name="NotesDataGrid" ItemsSource="{Binding Notes, UpdateSourceTrigger=PropertyChanged}" Margin="0" Height="Auto" AutoGenerateColumns="False" CanUserAddRows="False" RowHeaderWidth="0" 
                  GridLinesVisibility="All" HorizontalGridLinesBrush="#FFF7F7F7" VerticalGridLinesBrush="#FFF7F7F7" Padding="0"
                  AlternatingRowBackground="#FFFBFBFB" ColumnHeaderStyle="{DynamicResource dgColumnHeaderStyle}" CellStyle="{DynamicResource dgCellStyle}" RowStyle="{DynamicResource dgRowStyle}" LostFocus="NotesDataGrid_LostFocus"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T18:37:26.423

我遇到了同样的问题，这是由于`DataGrid`'`MaxHeight`属性没有设置为行大小的倍数，所以剩余空间显示在`DataGrid`. 例如：如果有 5 行高度为 10 像素，并且`MaxHeight`属性设置为 55，那么底部将有 5 像素的空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:40:19.817

您是否尝试将 DataGrid.Background 设置为 white ？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T13:26:58.523

将您的 DataGrid 包装在 Grid 中并尝试`DataGrid.VerticalAlignment="Top"`

```
 <Grid><DataGrid VerticalAlignment="Top" ... /></Grid> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-22T13:27:23.447

我知道这个问题已经很久没有提出来了。但无论如何我遇到了同样的问题，我可以通过设置 Datagrid 的属性来解决它。

```
IsReadOnly="True" 
```

# python - 检测进程中止

> ID：11227164
> 
> 赞同：2
> 
> 时间：2012-06-27T13:18:50.150
> 
> 标签：python, subprocess, popen

我正在使用 python 从 python 运行一些 c++ 二进制应用程序`subprocess.Popen`。我该如何处理这个过程的中止？例如，我的 c++ 中断了断言，我在控制台中看到：

```
binary: /usr/include/.../file.hpp:42: Assertion `min <= max' failed.
Aborted 
```

进程关闭，但如何使用 popen 句柄在 python 中捕获它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:34:18.457

你可以捕捉到`SIGABRT`信号。但是，请记住，在信号处理程序完成后，如果没有进一步的崩溃，可能无法继续。

我确实建议您尝试修复导致断言失败的任何问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T14:14:58.793

如果您已致电`handle = subprocess.Popen(...)`，您将不得不在某个时候致电[`handle.wait()`。它的返回值](http://docs.python.org/library/subprocess.html#subprocess.Popen.wait)同时`returncode`也是进程句柄对象的属性，显示进程是否正常完成（值>=0）或是否因信号而死亡（值<0）。

例子：

```
>>> import subprocess
>>> subprocess.call("kill -ABRT $$", shell=True)
-6
>>> a = subprocess.Popen("kill -ABRT $$", shell=True)
>>> a.wait()
-6
>>> subprocess.call("kill -SEGV $$", shell=True)
-11 
```

一个 C 程序看起来像

```
#include <assert.h>

int main() {
    assert(0);
} 
```

我可以

```
>>> import subprocess
>>> subprocess.call(["./ass"])
ass: ass.c:4: main: Assertion `0' failed.
-6 
```

所以我有同样的效果。

# ios - 如何让我的应用程序不断更新电池电量？

> ID：11227169
> 
> 赞同：0
> 
> 时间：2012-06-27T13:19:00.570
> 
> 标签：ios, battery, uidevice

我的应用程序中有一个电池电量指示器，我希望它还在电池电量指示器页面上进行更新。目前，如果我让我的应用程序在该屏幕上保持打开状态并且电池电量发生变化（超过 5%），应用程序就会崩溃。我需要在我的代码中添加什么来做到这一点？这是我的代码：

```
- (void)viewDidLoad {
[super viewDidLoad];

deviceType.text = [[UIDevice currentDevice] model];

[[UIDevice currentDevice] setBatteryMonitoringEnabled:YES];
[[UIDevice currentDevice] batteryLevel];

// Enable monitoring of battery status
[[UIDevice currentDevice] setBatteryMonitoringEnabled:YES];

// Request to be notified when battery charge or state changes
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(batteryStatus) name:UIDeviceBatteryLevelDidChangeNotification object:nil];
}

- (void) viewWillAppear:(BOOL)animated {
UIDevice *device = [UIDevice currentDevice];
device.batteryMonitoringEnabled = YES;
LabelBatteryStatus.text = [NSString stringWithFormat:@"%.0f%%", device.batteryLevel * 100];
[device addObserver:self forKeyPath:@"batteryLevel" options:0x0 context:nil];
[super viewWillAppear:animated];
}

- (void) viewDidDisappear:(BOOL)animated {
UIDevice *device = [UIDevice currentDevice];
device.batteryMonitoringEnabled = NO;
[device removeObserver:self forKeyPath:@"batteryLevel"];
[super viewDidDisappear:animated];
}

- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context {
UIDevice *device = [UIDevice currentDevice];
if ([object isEqual:device] && [keyPath isEqual:@"batteryLevel"]) {
    LabelBatteryStatus.text = [NSString stringWithFormat:@"%.0f%%", device.batteryLevel * 100];
}
} 
```

当我加载和卸载页面时，此代码适用于我的应用程序，但我希望它在页面上时也能正常工作。

提前谢谢你。

# image-processing - 图像处理滤镜

> ID：11227173
> 
> 赞同：0
> 
> 时间：2012-06-27T13:19:15.907
> 
> 标签：image-processing, computer-vision

我正在实现 Box 过滤器，我想知道我是否应该允许过滤器掩码大小（如 3 X 5 或其他大小），其中宽度与高度不同。

到目前为止，我只实现了掩码大小为 3x3 或 5x5 的过滤器。允许宽度与高度不同是否有效？我想我可以允许用户指定这样的掩码，但如果他得到奇怪的结果，那是他的错吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:43:36.827

**盒子过滤器**传统上实现为`N x N`，但您可以将其更改为您喜欢的任何内容。

顺便说一句，OpenCV 让您可以[创建自己的过滤器，`cv::filter2D()`](http://opencv.itseez.com/doc/tutorials/imgproc/imgtrans/filter_2d/filter_2d.html)但该功能不允许您创建非二次过滤器。然而，[`cv::blur()`](http://opencv.willowgarage.com/documentation/cpp/image_filtering.html#cv-blur)这是一个盒子过滤器，让你传递`N x M`尺寸。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T01:04:23.553

请注意，如果您的应用程序需要使用多个不同大小的框过滤器对**同一**图像进行重复框过滤，则首先计算给定图像的积分（即 O(N)，以像素数 N 为单位）效率更高)，然后根据积分计算每个滤波器的输出（同样在 O(N) 中）。对于 m 个过滤器，这给出了一个 m * O(N) 算法，而不管盒子大小。如果您使用几个大框进行过滤，这通常是一个很大的性能提升。

有关 OpenCV 实现，请参见[此处](http://opencv.willowgarage.com/documentation/cpp/miscellaneous_image_transformations.html#cv-integral)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T13:25:23.257

是的，它是有效的。

过滤器可以在不同的维度上有所不同。如果您使用的镜头在中心周围不均匀，这也可能发生在光学中。

# iphone - 如何在目标 c 中在 Twitter 中发布文本内容

> ID：11227175
> 
> 赞同：0
> 
> 时间：2012-06-27T13:19:17.437
> 
> 标签：iphone, objective-c, twitter

我使用了[这个 URL](http://amanpages.com/wordpress/sample-iphone-example-project/twitteragent-tutorial-tweet-from-iphone-app-in-one-line-code-with-auto-tinyurl/)中的一个方法（它应该让你从你的应用程序中发推文）。程序运行并发送消息“成功运行”，但是当我去 Twitter 时，这条推文还没有发布。

我的代码：

```
#import "TwitterAgent.h"

-(void)TwiterPress
{
    [[TwitterAgent defaultAgent] twit:@"Test" withLink:@"http://www.touch-code-magazine.com" makeTiny:YES];
} 
```

正如网站所说，一切似乎都正常工作，但推文并未显示在 Twitter 中。

我还想制作一个将用户定向到登录页面的按钮和另一个将发布推文的按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:21:35.680

使用[ShareKit](http://getsharekit.com/)

它变得非常容易共享文本、图像或 URL。

# nsuserdefaults - NSUserDefaults for 循环用于 switchCollection

> ID：11227177
> 
> 赞同：0
> 
> 时间：2012-06-27T13:19:34.000
> 
> 标签：nsuserdefaults

我已经创建了一个 mySwitchCollection，我需要从中检索 boolForKey 值以打开或关闭我的视图上的开关。这是代码，但我有问题 [defs boolForKey:arrayCostanti[i]];

arrayCostanti 是一个静态的 NSString *arrayCostanti[] = {k3D,kAnimazione};

如何将我的 arrayCostanti[i] 值推送到 boolForKey？

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.

    //Leggo dal defs gli stati di ogni switch e gli setto lo stato
    //NSUserDefaults
    NSUserDefaults *defs = [NSUserDefaults standardUserDefaults];

    //mySwitch1.on = [defs boolForKey: k3D];

    //ciclo for per settare tutti gli stati degli switch che ho raccolto nel mySwitchCollection
    for (int i = 0; i <= 45; i++){
     mySwitchCollection[i].on = [defs boolForKey:arrayCostanti[i]];
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:35:30.730

您还需要确保正确存储它。

我将假设 'k3D' 是为您的密钥定义的 NSString。

```
// saving
mySwitch1.on = YES;

[[NSUserDefaults standardUserDefaults] setObject:[NSNumber numberWithBool:mySwitch1.on] forKey:k3D];

// retrieving

BOOL switchOn = [[NSUserDefaults standardUserDefaults] boolForKey:k3D]; 
```

要记住的重要一点是 NSUserDefaults 只能存储主要的对象类型，而 BOOL 不是其中之一。因此，请确保首先将您的 BOOL 设置为 NSNumber，您应该一切顺利。

# ruby-on-rails-3.1 - 如何在 Twitter 的 Bootstrap 固定导航栏中动态刷新项目（理想情况下是 bages）？

> ID：11227182
> 
> 赞同：0
> 
> 时间：2012-06-27T13:19:43.373
> 
> 标签：ruby-on-rails-3.1, twitter-bootstrap, navbar

我正在使用 twitter boostrap 固定导航栏。我正在尝试刷新（经常使用javascript刷新功能拉动）导航栏的菜单项之一（理想情况下刷新与此菜单项相关联的推特徽章，例如“电子邮件10”，这里的徽章是“10”并且会喜欢刷新它以显示，例如，未读电子邮件的数量。感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:22:34.360

给它一个唯一的 id：

```
<span class="badge badge-important" id="email-count">6</span> 
```

在您的 javascript 代码中，使用 jQuery 选择它并设置数字：

```
$("#email-count").text(emails); 
```

# api - Soundcloud 直播评论流

> ID：11227183
> 
> 赞同：0
> 
> 时间：2012-06-27T13:19:45.220
> 
> 标签：api, comments, streaming, live, soundcloud

我正在开发一个应用程序，并希望实时显示给定 Soundcloud 曲目的所有评论。我们创建了一个自定义的 html5 音频播放器，它不是标准可嵌入 soundcloud 播放器的格式。评论应该出现在给定的空间中，并跟随歌曲的进度。当歌曲播放 5 秒等时，它将显示带有“5 秒”时间戳的评论。

目前我们只发现您必须为每条新评论进行单独的 API 调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T17:06:58.017

SoundCloud 的自定义播放器目前不支持此功能。

但是，如果您使用 SoundCloud JS SDK 的 SC.stream 函数构建播放器，则可以使用 ontimedcomments 选项：

SC.stream("/tracks", { autoPlay: true, ontimedcomments: function(comments){ console.log("First Comment at this timestamp", comments[0].body); } });

唯一的缺点是您必须自己构建播放器 UI。这篇文章中还有更多示例：http: [//developers.soundcloud.com/blog/rich-media-using-timed-comments](http://developers.soundcloud.com/blog/rich-media-using-timed-comments)

# java - 如何加载股票图标图像？

> ID：11227203
> 
> 赞同：2
> 
> 时间：2012-06-27T13:20:50.900
> 
> 标签：java, icons, swt

我正在创建带有图标的工具栏，但我面临一个问题：找不到如何为保存、打开、新建等按钮加载库存图标...

我知道如何使用我的图标，但我不想创建自己的图标或在某个地方寻找，我喜欢带有库存系统图标的应用程序。

我正在寻找跨平台的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:59:02.280

此外，[Dispaly.getSystemImage()](http://www.java2s.com/Tutorial/Java/0280__SWT/UsingSystemIconImage.htm)，目前 SWT 不支持它（根据这个[错误报告](https://bugs.eclipse.org/bugs/show_bug.cgi?id=93606)）。您可以查看附加到错误报告的补丁并修改您平台的代码以提取其他图标/资源。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-27T13:35:08.623

请参阅[Eclipse 图标](http://eclipse-icons.i24.cc/)。它们在 EPS 下获得许可，因此可以免费使用。

# r - 使用数据框数组在 for 循环中创建数据框

> ID：11227209
> 
> 赞同：2
> 
> 时间：2012-06-27T13:21:10.427
> 
> 标签：r

我有一个如下所示的数据框。我需要根据 RL 中可用的区域提取 df

```
 >avg_data
    region  SN      value
    beta    1       32
    alpha   2       44
    beta    3       55
    beta    4       60
    atp     5       22

    > RL
           V1
    1 beta
    2 alpha 
```

该数据框应该在类似 REGR[beta] 的数组中，其中应该包含与 beta 相关的信息，如下所示

```
 region  SN      value
    beta    1       32
    beta    3       55
    beta    4       60 
```

类似地对于 REGR[alpha]

```
 region  SN      value
    alpha   2       44 
```

这样我就可以将 REGR 作为绘图图的参数传递。

```
 REGR <- data.frame()

    for (i in levels(RL$V1)){
     REGR[i,] <- avg_data[avg_data$region==i, ];
    } 
```

我在上面的代码中犯了一些错误。请纠正我..谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:48:27.917

`split`您可能对这个功能感兴趣。从帮助页面，拆分`divides the data in the vector x into the groups defined by f`.

因此，对于您的数据，它可能类似于：

```
> split(avg_data, avg_data$region)
$alpha
  region SN value
2  alpha  2    44

$atp
  region SN value
5    atp  5    22

$beta
  region SN value
1   beta  1    32
3   beta  3    55
4   beta  4    60 
```

如果您想过滤掉 RL 中没有出现的记录，我可能会在使用该`%in%`函数的预处理步骤中执行此操作并`[`进行提取：

```
x <- avg_data[avg_data$region %in% RL$V1,]
#-----
  region SN value
1   beta  1    32
2  alpha  2    44
3   beta  3    55 
```

`split`如果您想放弃 atp，这就是我要喂的东西。

如果您只是想绘图，上面的方法可能会过大。这是一个`sapply`用于遍历每个区域级别并绘制图的示例：

```
sapply(unique(x$region), function(z) 
  plot(x[x$region == z,"value"], main=z[1])) 
```

# javascript - JQuery 偏移和 ScrollTop 问题

> ID：11227215
> 
> 赞同：0
> 
> 时间：2012-06-27T13:21:20.657
> 
> 标签：javascript, jquery

我正在尝试根据窗口内的滚动位置来修复元素位置。

我认为这就像获取固定元素应该固定的元素的偏移量一样简单，然后当 window.scrollTop 等于它时添加 CSS，但这很奇怪。

似乎元素的偏移量大于 scrollTop 最大数字。

有没有其他方法可以让它工作？

我希望它在滚动页脚方面具有与此相同的功能；

[http://be.blackberry.com/](http://be.blackberry.com/)

但我不想克隆元素，我想检测它何时接近页面底部，然后更改元素底部的位置。

提前致谢。

乙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:46:01.530

这应该可以帮助您朝着正确的方向前进：

```
var footer = $("#footer");
// min amount to show when not scrolled to the bottom of the page.
var minVisable = 25;

$(parent.document).scroll(function() {
    // check position
    if (window.scrollY + window.innerHeight + minVisable > $("html").height()) {
        // if at the bottom of the page, stick the footer to it
        footer.css("position","absolute").css("top", $("html").height() - footer.height());
    } else {
        // else keep top part of footer on the screen
        footer.css("position","fixed").css("top", window.innerHeight - minVisable );
    }
}); 
```

# winapi - 如何获取窗口 proc 参数？

> ID：11227218
> 
> 赞同：-1
> 
> 时间：2012-06-27T13:21:25.847
> 
> 标签：winapi, assembly, nasm

我尝试使用程序集 NASM 创建最简单的 WinAPI 窗口。我有 Window Proc 的问题。查看注释行：

```
%宏 API 2
    导入 %1 %2
    外部 %1
%end 宏

API GetModuleHandleA, kernel32.dll
API LoadIconA,user32.dll
API LoadCursorA,user32.dll
API RegisterClassExA, user32.dll
API CreateWindowExA, user32.dll
API MessageBoxA, user32.dll
API SendMessageA, user32.dll
API DefWindowProcA、user32.dll
API ExitProcess，kernel32.dll
API GetMessageA、user32.dll
API DispatchMessageA、user32.dll
API TranslateMessage,user32.dll
API ShowWindow,user32.dll
API 更新窗口，user32.dll
API GetCommandLineA,kernel32.dll
API PostQuitMessage,user32.dll

段 .data USE32
    windowName db "你好世界！", 0
    命令行 dd 0
    hWnd dd 0
    hInst dd 0
    h光标dd 0
    类名数据库“moje_okno”，0

    blad db "Blad!!!",0

段.bss
    结构 WNDCLASSEX
        .sSize resb 4
        .style resb 4
        .wndProc resb 4
        .clsExtra resb 4
        .wnd额外资源 4
        .hInstance resb 4
        .hIcon resb 4
        .hCursor resb 4
        .background resb 4
        .sMenuName resb 4
        .sClassName resb 4
        .hIconSm resb 4
    末端结构

    wndClass 结构 WNDCLASSEX
    朋友

全球..开始
段 .text USE32
..开始：
    推0
    调用 [GetModuleHandleA]
    mov dword [hInst], eax ; 应用程序句柄

    推双字 0x00007f00 ；MAKEINTRESOURCE(32512)
    推双字 0
    调用 [LoadCursorA]
    mov dword [hCursor], eax ; 光标句柄

    mov dword [wndClass + WNDCLASSEX.sSize], dword 48 ; 结构尺寸
    mov dword [wndClass + WNDCLASSEX.style], dword 0 ; 风格
    mov dword [wndClass + WNDCLASSEX.wndProc], wndproc ; 窗口进程
    mov dword [wndClass + WNDCLASSEX.clsExtra], dword 0
    mov dword [wndClass + WNDCLASSEX.wndExtra], dword 0
    mov eax, dword [hInst]
    mov dword [wndClass + WNDCLASSEX.hInstance], eax ; 处理
    mov dword [wndClass + WNDCLASSEX.hIcon], dword 0
    mov eax, dword [hCursor]
    mov dword [wndClass + WNDCLASSEX.hCursor], eax
    mov dword [wndClass + WNDCLASSEX.background], dword 0
    mov dword [wndClass + WNDCLASSEX.sMenuName], dword 0
    mov dword [wndClass + WNDCLASSEX.sClassName], className ; 班级名称
    mov dword [wndClass + WNDCLASSEX.hIconSm], dword 0

    推送 wndClass
    调用 [RegisterClassExA]
    在 sprawdz_blad 附近打电话；检查 RegisterClassExA 的返回值

    推 0 ; 参数
    push dword [hInst] ; 处理
    推 0 ;hMenu
    推 0 ;父母
    推 200 ;高度
    推 200 ;宽度
    按 200 ;y
    按 200 ;x
    推 0 ;风格
    push className ;窗口名称
    push className ;窗口类
    push 0 ;扩展样式
    调用 [CreateWindowExA]
    推入
    在 sprawdz_blad 附近调用；检查 CreateWindowExA 的返回值。返回 0

    推0
    调用 [退出进程]

wndproc：
    ; 在这里我需要访问窗口过程参数：HWND、MSG、WPARAM、LPARAM
    ; 我试过：
     流行音乐
     流行音乐
     流行音乐
     流行音乐
    ; 但它不起作用
    ; 这些注册表中没有正确的值

    ret

盒子：
    推0
    推杆
    推杆
    推0
    调用 [MessageBoxA]
    ret

sprawdz_blad:
    流行音乐
    cmp eax, 0
    好的；如果函数返回 0 一切正常

    推0
    推杆
    推杆
    推0
    调用 [MessageBoxA]

    推1
    调用 [退出进程]
行：
    ret

```

我试图让它工作几个小时，但我没有想法。请帮忙。问候，米哈尔。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T03:25:36.690

一个被调用的子程序，无论是您自己调用还是由 Windows 调用（如 wndproc），都将其返回地址作为堆栈中的第一件事。你不想弹出这个！要访问参数，您需要查看堆栈的更远位置。尝试类似...

 `````
wndproc:
    mov eax, [esp + 4]
    mov ebx, [esp + 8]
 ; etc... 
````  `看看有没有帮助...

最好的，弗兰克``

# asp.net-mvc-3 - 将 Fancybox DIV 附加到表单标签

> ID：11227220
> 
> 赞同：0
> 
> 时间：2012-06-27T13:21:29.993
> 
> 标签：asp.net-mvc-3, model, fancybox, partial-views

Fancybox 在我的 DOM 底部附加了它的 DIV 标签。有没有办法让它附加在 FORM 标记中？我将它绑定到表单标签中的一个元素，但是当我在 Chrome 中检查文档时，Fancybox DIV 被添加到底部。

这样做的原因是我正在使用 MVC3 并在fancybox 中加载部分视图。那部分正在工作。模型绑定器在回发时将fancybox 中的字段排除在外，因为它们位于表单之外。

我究竟做错了什么？

```
<script type='text/javascript'>//<![CDATA[ 
  $(window).load(function(){
    $(document).ready(function() {
      $(".clickMe").fancybox({
        content: $('#test')
      });
    });
  });//]]>  
</script>

<body>
  <form id='testform'>
    <a href="#emailViewFancybox" class="clickMe">Click Me</a>
  </form>
  <div style="display: none;" id='test'>
     Tri-tip brisket ribeye fatback ground round pork chop. Strip steak tenderloin t-bone tri-tip, spare ribs tongue prosciutto meatloaf. Beef ribs ham sirloin, biltong ham hock venison jowl andouille flank pork belly. Meatball strip steak chicken, capicola prosciutto hamburger spare ribs.
  </div>      
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:26:46.033

我在将 JQuery 对话框作为表单的一部分时遇到了类似的问题。我最终不得不使用 javascript 将生成的 div 在生成后移动到表单中。

# c# - .net 中的 CRC32 十六进制

> ID：11227228
> 
> 赞同：0
> 
> 时间：2012-06-27T13:21:50.103
> 
> 标签：c#, vb.net, crc32

我正在尝试找到一个 CRC32 计算算法，它以正 8 字符 HEX 输出数据（例如 winrar CRC）。

找到的所有算法都返回一个我不知道如何处理的正/负整数......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T13:27:36.543

我敢打赌，您找到的所有 CRC32 算法都会返回一个 32 位整数（例如`int`or `uint`）。当您查看它时，您可能会将其视为以 10 为底的数字。通过查看，我的意思是将整数格式化为字符串，而不将任何格式选项传递给[`Int32.ToString`](http://msdn.microsoft.com/en-us/library/6t7dwaa5.aspx)or [`String.Format`](http://msdn.microsoft.com/en-us/library/fht0f5be.aspx)。

如果您将 Visual Studio 放入十六进制视图，您将获得“预期”输出。在这种情况下，算法都是正确的，但是，您的*期望*不正确！

相反，请使用[数字格式](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)来生成您想要的字符串表示：

```
uint crc32 = Crc32Class.GetMeAValue(data);

// For example, we'll write base-10 and base-16 the output to the console
Console.WriteLine("dec: {0}", crc32);
Console.WriteLine("hex: {0:X8}", crc32); 
```

# iphone - 如何保留传递给ARC中块的对象

> ID：11227231
> 
> 赞同：1
> 
> 时间：2012-06-27T13:21:57.490
> 
> 标签：iphone, objective-c, block

我有这段代码，我有一些我想并行执行的任务，问题是一个电影对象在调度可以处理之前在每个运行循环上释放。有没有办法在 ARC 中保留它？现在我在调度之外处理大部分逻辑并使用__block将其传递，但​​是如果这是一个耗时的过程并且想要在调度块中处理它我应该怎么做？

```
for (HTMLNode *movie in movieContainer) {
  dispatch_group_async(group, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
// time consuming process on movie object
});

dispatch_group_notify(group, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
   // combine the results
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T13:58:45.140

大多数时候，您不必这样做。块自动捕获默认使用的所有变量，但是，当使用快速迭代时，会出现异常。

因为快速迭代使用`__unsafe_unretained`原始指针而不是强指针（为了速度），所以在这种情况下，您可以简单地使用 strong 限定迭代变量：

```
for (HTMLNode __strong *movie in movieContainer) {
  dispatch_group_async(group, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
// time consuming process on movie object
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:52:49.023

使用关键字创建一个局部变量并将其`__strong`影响为电影对象。然后在你的 dispatch_async 调用中使用这个强大的局部变量。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-27T13:54:56.433

手动保留释放

```
#import <objc/runtime.h>
id objc_retain(id);
void objc_release(id);

objc_retain(object);
objc_release(object); 
```

或者

变量与

```
__strong 
```

# ruby-on-rails - Rails 3.1 时区 UTC 和中央时区混淆

> ID：11227232
> 
> 赞同：1
> 
> 时间：2012-06-27T13:22:05.577
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, ruby-on-rails-3.1, timezone

我对 RoR 比较陌生，并且在时区转换方面遇到了麻烦。当从数据库中获取数据（存储在美国中部时间）时，它认为那里的时间是 UTC 并尝试转换它们，因此使它们错了 5 个小时。我的 application.rb 文件中有这个：

```
config.time_zone = 'Central Time (US & Canada)'
config.active_record.default_timezone = 'Central Time (US & Canada)' 
```

如果我删除这些配置指令之一，时间将无法正确保存。只要我有它们，时间就会正确存储在数据库中，但 RoR 无法正确读取它们。为了解决这个问题，我必须将从数据库获得的所有时间转换为 UTC。我必须相信有更好的方法。

我也尝试设置 ENV['TZ']，但这似乎没有任何作用。

```
ENV['TZ'] = "US/Central" 
```

任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-24T09:42:56.497

实际上，对我来说，AR 拒绝将值设置为来自 :utc/:local 的其他值

```
config.active_record.default_timezone = 'Central Time (US & Canada)' 
```

这一行最后的日志充满了回退到 :local 的警告

有效的是完全切换系统时区

```
ENV['TZ'] = "US/Central" 
```

确保使用正确的 tz 名称。Unix 时区名称不是 ActiveSupport::TimeZone 使用的名称

请参阅ActiveSupport **::TimeZone::MAPPING**

另外，请注意，在此之后 Time.now == Time.current; 它也会在指定的时区给出时间；

所以这更像是一种黑客攻击而不是一种解决方案。

# html - 拆分表格单元以添加更多列和行

> ID：11227236
> 
> 赞同：0
> 
> 时间：2012-06-27T13:22:23.627
> 
> 标签：html, css

我正在尝试构建此布局：

![在此处输入图像描述](../Images/bf501a0b6bbe3a97d3c6b8c5d2e28741.png)

我这个时候有这个：http: [//jsfiddle.net/Gh6mB/12/](http://jsfiddle.net/Gh6mB/12/)

问题是 div #detalhes 并没有占用水平方向的所有可用空间。此 div 必须分为左侧（用于图像）和右侧，以显示其他信息。我已经将 div 的 stype 更改为 table-cell、table-row 和 table 但它不起作用。您可以在全屏结果中看到这一点：http: [//jsfiddle.net/Gh6mB/12/embedded/result/](http://jsfiddle.net/Gh6mB/12/embedded/result/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:31:21.030

得到它的工作[http://jsfiddle.net/Gh6mB/21/](http://jsfiddle.net/Gh6mB/21/)

将此添加到您的 div #detalhes

```
display:block; float:left; width:100%; 
```

并删除了这个

```
position:relative; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:32:26.053

当您使用 div 和浮动时，您还必须考虑调整页面大小来移动东西，另一种选择....

简单的解决方案，使用表格。

```
<table width="100%"><tr><td width="90%" colspan="2"></td><td width="10%"></tr><tr><td width="10%"></td><td width="80%"></td><td width="10%"></tr></table> 
```

colspan 将占据第一列的 2 行，将 css 用于图像等

# iphone - ARC Autoreleased，没有设置池

> ID：11227237
> 
> 赞同：0
> 
> 时间：2012-06-27T13:22:24.377
> 
> 标签：iphone, xcode, automatic-ref-counting

我在我的代码中使用 ARC，我收到了错误

```
Object 0x781b8e0 of class __NSCFString autoreleased with no pool in place - just leaking - break on objc_autoreleaseNoPool() to debug 
```

它打破的线是

```
 return UIApplicationMain(argc, argv, nil, NSStringFromClass([HomePageAppDelegate class])); 
```

因为我使用的是 ARC，所以我不能`NSAutoReleasePool`像往常一样使用它。我可以使用什么来修复此错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T13:24:41.337

您使用以下`@autoreleasepool`构造：

```
@autoreleasepool {
    // main code here
} 
```

这将创建一个`NSAutoReleasePool`与括号相同的范围，它也可以在 MRC 代码中使用。它的优点是在发生异常时被清理，并且可以很容易地用于安全地调度线程。

要了解更多信息，请访问这篇关于[过渡到 ARC 发行说明的文章](https://developer.apple.com/library/ios/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html%23//apple_ref/doc/uid/TP40011226-CH1-SW8)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:24:27.833

在它显示的行上使用它`warning`

```
@autoreleasepool{
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T13:24:48.233

创建一个启用 ARC 的新测试应用程序。查看“main.m”中的代码以了解 Apple 的建议。

# xml - .net wcf webservice xml序列化-如何将对象序列化为特定的xml字符串

> ID：11227238
> 
> 赞同：1
> 
> 时间：2012-06-27T13:22:24.840
> 
> 标签：xml, wcf, serialization

我正在做一个 .net wcf webservice 来输出以下 xml 架构。（以下 shema 只是一个例子）

```
**<CarListOutput>
    <CarList>
      <Car>
        <Make />
        <Model /> 
        <Year />
      </Car>
      <Car>
        <Make />
        <Model /> 
        <Year />
      </Car>
    </CarList>
    <ExceptionList>
       <CustomError>
         <type />
         <errorMessage/>
       </CustomError>  
    </ExceptionList>      
</CarListOutput>** 
```

我有自己的“汽车”类（以及“CustomError”），并且我的返回对象“汽车列表”（还有“CustomError 列表”）准备好正确的数据。我可以单独将此对象序列化为 xml 字符串或 XElement（汽车列表和自定义错误列表）。我的问题是如何将对象转换为与上述 xml 相同的对象？我想做与上面的 xml 相同的操作，因为客户端需要特定的 xml（具有确切的名称）。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T17:51:46.960

用数据成员 CarList 和 exceptionList 创建一个类 CarListOutput，让您的操作联系人返回 CarListOutput 类型的对象。要进一步控制 CarListOutput XML 格式，请使用 XmlSerializerFormat。[您可以在http://msdn.microsoft.com/en-us/library/ms733901.aspx](http://msdn.microsoft.com/en-us/library/ms733901.aspx)阅读有关 XmlSerializer 的更多信息

# iis-7 - 使用 IIS7，您如何为某些 ftp 用户而不是其他用户强制执行 FTPS？

> ID：11227239
> 
> 赞同：0
> 
> 时间：2012-06-27T13:22:31.960
> 
> 标签：iis-7, ftps

我们在 IIS7 中配置了 ftp 以允许使用 SSL 证书。我们需要确保您的大多数用户使用 FTPS，但由于遗留系统，我们无法强制所有 ftp 用户使用 SSL。我们需要做些什么来实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T20:08:32.507

他没有说 SFTP，他说 FTPS 是基于 SSL 的 FTP……基于 SSL 的 FTP 确实是通过 SSL 连接运行的 FTP（不是 ssh），并且受 IIS 7.x 支持。像用户一样，我也无法找到强制执行 FTPS 和禁止明文身份验证的机制... IIS 7.x 的 FTP 服务器似乎只提供 FTPS 作为选项，但没有提供机制（我还可以找到）用于执行/要求它。

# php - Php: array_filter changes data format

> ID：11227240
> 
> 赞同：0
> 
> 时间：2012-06-27T13:22:32.653
> 
> 标签：php, arrays, json, filter

In the code below I would expect

```
t2: [{"value":"".....}, {}, {}] 
```

but instead I get

```
t2: {"0":{"value":"",.. , "1":{}, .. } 
```

even casting

```
json_encode( (array) $t2); 
```

doesn't make it work
thx

```
function filter($var) {
    return($var->id < 4);
}

$t1=json_decode('[{"value":"","id":"0","key":"algo"},{"value":"0.8","id":"-1","key":"cout"},{"value":"2012-07-21","id":"3","key":"date"},{"value":"","id":"0","key":"europe"},{"value":"","id":"0","key":"inria"},{"value":"1","id":"4","key":"ndOfRates"},{"value":"part","id":"0","key":"offre"},{"value":"","id":"0","key":"paris"},{"value":"Ut enim quisque sibi plurimum confidit et ut quisque maxime virtute et sapientia sic munitus est, ut nullo egeat suaque omnia in se ipso posita iudicet, ita in amicitiis expetendis colendisque maxime excellit. Quid enim? Africanus indigens mei? Minime hercule! ac ne ego quidem illius; sed ego admiratione quadam virtutis eius, ille vicissim opinione fortasse non nulla, quam de meis moribus habebat, me dilexit; auxit benevolentiam consuetudo. Sed quamquam utilitates multae et magnae consecutae sunt, non sunt tamen ab earum spe causae diligendi profectae. Hae duae provinciae bello quondam piratico catervis mixtae praedonum a Servilio pro consule missae sub iugum factae sunt vectigales. et hae quidem regiones velut in prominenti terrarum lingua positae ob orbe eoo monte Amano disparantur. Ultima Syriarum est Palaestina per intervalla magna protenta, cultis abundans terris et nitidis et civitates habens quasdam egregias, nullam nulli cedentem sed sibi vicissim velut ad perpendiculum aemulas: Caesaream, quam ad honorem Octaviani principis exaedificavit Herodes, et Eleutheropolim et Neapolim itidemque Ascalonem Gazam aevo superiore exstructas. Post hoc impie perpetratum quod in aliis quoque iam timebatur, tamquam licentia crudelitati indulta per suspicionum nebulas aestimati quidam noxii damnabantur. quorum pars necati, alii puniti bonorum multatione actique laribus suis extorres nullo sibi relicto praeter querelas et lacrimas, stipe conlaticia victitabant, et civili iustoque imperio ad voluntatem converso cruentam, claudebantur opulentae domus et clarae. Et quoniam apud eos ut in capite mundi morborum acerbitates celsius dominantur, ad quos vel sedandos omnis professio medendi torpescit, excogitatum est adminiculum sospitale nequi amicum perferentem similia videat, additumque est cautionibus paucis remedium aliud satis validum, ut famulos percontatum missos quem ad modum valeant noti hac aegritudine colligati, non ante recipiant domum quam lavacro purgaverint corpus. ita etiam alienis oculis visa metuitur labes.","id":"4","key":"text"},{"value":"on","id":"0","key":"type"}]');

$t2 = array_filter($t1, "filter");

echo 't2: '.json_encode($t2); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:29:26.320

In PHP, there is no difference between associative and numeric arrays. Therefore, when converting to JSON, `json_encode` has to infer from the array's keys whether it should be encoded as an array or an object. It does this by testing to see if (a) the keys are numeric and (b) if they are sequential, starting with `0`; if both tests pass, it will be encoded as an array.

When you use `array_filter`, you remove some of the keys. The others are not renumbered, so the keys are no longer sequential. This means that `json_encode` infers that this should be an object rather than an array when encoded in JSON.

You can correct this by renumbering the keys. Use `array_values` to do this:

```
echo 't2: '.json_encode(array_values($t2)); 
```

# r - R列表的交集

> ID：11227252
> 
> 赞同：5
> 
> 时间：2012-06-27T13:23:15.347
> 
> 标签：r

我有 2 个列表，每个列表都有多个变量（我认为这是正确的术语）。我想找到每个变量的交集。请参见下面的示例：

```
x<-list(A=c(1,2,3),B=c(4,5,6),C=c(7,8,9)) #input
y<-list(A=c(1,3,6,7),B=c(5,7,8),C=c(7,9,10)) #input
xinty<-list(A=c(1,3),B=5,C=c(7,8)) # desired output 
```

我尝试了以下方法，但这显然是错误的。任何建议将不胜感激。谢谢。

```
xinty<-lapply(x,function(x) intersect(x,y)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T13:26:31.023

关于什么：

```
mapply(intersect, x,y) 
```

# iphone - RestKit GET 查询参数

> ID：11227255
> 
> 赞同：6
> 
> 时间：2012-06-27T13:23:23.653
> 
> 标签：iphone, ios, get, restkit

我已经使用 RestKit 0.10.0 一段时间了，到目前为止，我只将序列化对象发布到我的服务器：

```
[[RKObjectManager sharedManager] postObject:serializedObject
                                 usingBlock:^(RKObjectLoader *loader) {
                                     loader.delegate = self;
                                     loader.objectMapping = responseMapping;
                                     loader.serializationMIMEType = RKMIMETypeFormURLEncoded;
                                     loader.targetObject = nil;
                                 }]; 
```

到现在为止还挺好。但我现在需要使用一些查询参数向服务器发出 GET 请求。想到的第一件自然的事情就是和我发布对象一样：

*   为封装查询参数的对象创建序列化映射
*   为从服务器接收的对象创建响应映射
*   为 RKRequestMethodGET 定义和使用路由器（而不是 RKRequestMethodPOST）
*   使用 getObject:usingBlock（而不是 postObject:usingBlock）发出请求

我很快发现这不是这样做的方法，因此在搜索了可用资源（[RestKit Wiki](https://github.com/RestKit/RestKit/wiki)、[RestKit Google 组](https://groups.google.com/forum/?fromgroups#!forum/restkit)）之后，我现在知道两种被认为是有效的解决方案：

*   将查询参数附加到资源路径。

这完美地工作。

```
NSDictionary *queryParams = [NSDictionary dictionaryWithObjectsAndKeys:
                                          token, @"accessToken",
                                          [NSNumber numberWithInt:level], @"level",
                                          [NSNumber numberWithInt:count], @"count",
                                          nil];

NSString* resourcePath = [PEER_SUGGESTIONS_CONTROLLER_PATH stringByAppendingQueryParameters:queryParams];

[[RKObjectManager sharedManager] loadObjectsAtResourcePath:resourcePath
                                                usingBlock:^(RKObjectLoader *loader) {
                                                    loader.delegate = self;
                                                    loader.objectMapping = responseMapping;
                                                }]; 
```

*   在加载程序块中设置查询参数。

这不会发送查询参数。

```
RKParams *params = [RKParams params];
[params setValue:token forParam:@"accessToken"];
[params setValue:[NSNumber numberWithInt:level] forParam:@"level"];
[params setValue:[NSNumber numberWithInt:count] forParam:@"count"];

[[RKObjectManager sharedManager] loadObjectsAtResourcePath:PEER_SUGGESTIONS_CONTROLLER_PATH
                                                usingBlock:^(RKObjectLoader *loader) {
                                                    loader.delegate = self;
                                                    loader.objectMapping = responseMapping;
                                                    loader.params = params;
                                                }]; 
```

我的问题是：

1.  为什么第二种解决方案不起作用？
2.  为什么第一个解决方案无需将 loader.targetObject 设置为 nil 就可以工作，尽管我在 JSON 响应中没有任何根键路径？
3.  在什么情况下我应该使用 getObject:usingBlock 方法？它的预期目的是什么？
4.  我应该使用 loader.params 做什么？[wiki](https://github.com/RestKit/RestKit/wiki/Object-mapping)中的对象映射教程说此属性可用于封装 POST 参数，但我看不到重点，因为我可以将参数包装在使用 postObject:usingBlock 方法发送的序列化对象中。

谢谢。

[稍后编辑]

关于我的第二个问题的答案：在发出 POST 请求时，我一直在加载程序块中将 targetObject 设置为 nil，因为否则 RestKit 将尝试使用发送对象映射作为响应（查看此[链接](https://groups.google.com/forum/?fromgroups#!topic/restkit/D3dazrNVXEo)以获取相关讨论）。但是由于我使用的是 loadObjectsAtResourcePath:usingBlock:，所以没有对象被发送，因此响应自然会映射到响应映射上，而不必将 targetObject 设置为 nil。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T20:16:22.760

> 1.  为什么第二种解决方案不起作用？

params 用于创建 HTTP 正文，在 GET/HEAD 请求中不使用该正文。

> 1.  为什么第一个解决方案无需将 loader.targetObject 设置为 nil 就可以工作，尽管我在 JSON 响应中没有任何根键路径？

我认为 targetObject 默认为 nil 。您通常不设置它，如果需要，请求将创建它。我唯一一次使用它是在请求没有主键或其他奇怪问题的对象时。

> 1.  在什么情况下我应该使用 getObject:usingBlock 方法？它的预期目的是什么？

这是一种方便的方法，因此您不必记住所有正确的语法。在内部，它只是使用 GET 发送一个对象加载请求。

编辑：

如果您有要更新的对象，请使用此选项。

> 1.  我应该使用 loader.params 做什么？来自 wiki 的对象映射教程说这个属性可以用来封装 POST 参数，但我看不到重点，因为我可以将参数包装在使用 postObject:usingBlock 方法发送的序列化对象中。

无论您在 params 中输入什么，都将被序列化为 HTTP 正文（或正文流）。同样， postObject:usingBlock: 只是一种方便的方法，因此您不必记住所有内容。

RestKit 是开源的。如果您不确定它是如何工作的，您可以在内部自由地遵循参数。如果您的应用程序和 Web 服务设计良好，您应该能够使用便捷的方法。有时你不能，然后你可以像以前那样使用原始表单。

编辑：Q Hrm，引用你的要点弄乱了数字......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-14T13:31:50.310

我解决了向 RKObjectLoader 添加一个类别，即：

对于方法

```
-(void)getObject:(id<NSObject>)object usingBlock:(RKObjectLoaderBlock)block; 
```

我在 Category 中添加了一个修改后的方法：

```
-(void)getObject:(id<NSObject>)object queryParameters:(NSDictionary*)queryParameters usingBlock:(void(^)(RKObjectLoader *))block; 
```

**这是列表 fpr 文件“RKObjectManager+QueryParameters”：**

```
//
//  RKObjectManager+QueryParameters.h
//  AlphaClient
//
//  Created by Antonio Rossi on 14/07/12.
//

#import <RestKit/RestKit.h>

@interface RKObjectManager (QueryParameters)

- (void)getObject:(id<NSObject>)object queryParameters:(NSDictionary*)queryParameters usingBlock:(void(^)(RKObjectLoader *))block;
- (void)sendObject:(id<NSObject>)object queryParameters:(NSDictionary*)queryParameters method:(RKRequestMethod)method usingBlock:(void(^)(RKObjectLoader *))block;

@end 
```

**这是文件“RKObjectManager+QueryParameters.m”的列表：**

```
//
//  RKObjectManager+QueryParameters.m
//  AlphaClient
//
//  Created by Antonio Rossi on 14/07/12.
//

#import "RKObjectManager+QueryParameters.h"

@implementation RKObjectManager (QueryParameters)

- (void)getObject:(id<NSObject>)object queryParameters:(NSDictionary*)queryParameters usingBlock:(void(^)(RKObjectLoader *loader))block {
    [self sendObject:object queryParameters:queryParameters method:RKRequestMethodGET usingBlock:block];
}

- (void)sendObject:(id<NSObject>)object queryParameters:(NSDictionary*)queryParameters method:(RKRequestMethod)method usingBlock:(void(^)(RKObjectLoader *))block {
    NSString *resourcePath = [self.router resourcePathForObject:object method:method];
    [self sendObject:object toResourcePath:resourcePath usingBlock:^(RKObjectLoader *loader) {
        loader.method = method;

        // need to transform the original URL because when method is GET the additional paramentes don't get added
        RKURL *originalBaseURL = [RKURL URLWithBaseURL:[loader.URL baseURL]];
        NSString *resourcePath = [self.router resourcePathForObject:object method:RKRequestMethodGET];
        RKURL *authTokenURL = [originalBaseURL URLByAppendingResourcePath:resourcePath queryParameters:queryParameters];
        [loader setURL:authTokenURL];

        block(loader);
    }];
}

@end 
```

另一个步骤是添加`#import "RKObjectManager+QueryParameters.h"`您的实现文件。在这个新方法中，假设`router`RKObjectManager 的属性在调用它之前已经定义好了。

# ruby - 无法将代码分成没有错误的方法

> ID：11227256
> 
> 赞同：0
> 
> 时间：2012-06-27T13:23:26.013
> 
> 标签：ruby, subroutine, roman-numerals

我正在做一个 Ruby Kata（罗马数字转换器），我试图将我的代码分开，所以它不是一个巨大的块。

这是我到目前为止所拥有的：

```
def roman s
  total = convert s[0,1]

  (0..s.length).each do |i|
    case convert (s[i+1,1]).to_i >= convert (s[i,1])
      when true : total += convert s[i+1,1]
      when false: total -= convert s[i+1,1]
    end
  end

  total
end

def convert s

  case s
    when 'I' :  1
    when 'V' :  5
    when 'X' :  10
    when 'L' :  50
    when 'C' :  100
    when 'D' :  500
    when 'M' : 1000
    else 0
 end 
```

我想在罗马方法中移动 case 语句，所以它现在看起来像这样：

```
case preceding_number_is_lower_than_next_number s,i 
```

除了添加方法：

```
def preceding_number_is_lower_than_next_number s,i
  convert (s[i+1,1]).to_i >= convert (s[i,1])
end 
```

但是，当我这样做并给它输入“XXXI”时，它会从给出正确的输出 29 变为不正确的输出 10。

由于它是完全相同的代码运行，只是重构，我无法想象为什么行为会发生变化。

有任何想法吗？

# c#-4.0 - C# for-loop 循环表达式语法

> ID：11227258
> 
> 赞同：4
> 
> 时间：2012-06-27T13:23:29.637
> 
> 标签：c#-4.0, for-loop, syntax, reflector, dotpeek

我对 C# 中 for 循环的循环表达式有一个很好的问题。

我总是喜欢学习和扩展我的知识，所以我经常使用我的反射器来观察和学习其他人。最近我在一个我认为是 C# 程序集的程序集中环顾四周。

我遇到了这个：

```
public virtual void DoRows(Parse rows)
{
  for (; rows != null; {
    Parse more;
    rows = more;
  }
  )
  {
    more = rows.More;
    this.DoRow(rows);
  }
} 
```

我从来不知道我可以在循环表达式中使用代码块。所以我启动了 MSDN 并查看了 C# 的语言参考，但一无所获。

C++ 参考资料显示了一些有趣的东西（http://msdn.microsoft.com/en-us/library/b80153d8.aspx），但我不是 C++ 开发人员，我强烈感觉该组件不是用 C++ 编写的.

dotPeek 说该程序集是 v4.0.30319 / msil 程序集。

现在问题如下： - 这是 C++ 还是 C# 代码结构？！- 我们可以在 C# 中做这样的事情吗？

我无法重现看起来像这样并在 VS2010 中编译的代码。

@edit：更改了代码结构中的组装一词。

@edit II：感谢您的所有回答。我认为这要么是 dotPeek 反射器中的错误，要么是我们发现了一些 for-loop-expression 复活节彩蛋。这就是 Red Gate 所说的相同方法：

```
public virtual void DoRows(Parse rows)
{
    while (rows != null)
    {
        Parse more = rows.More;
        this.DoRow(rows);
        rows = more;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:26:31.737

没有 C++ 或 C# 程序集之类的东西。代码编译完成后，就是 ILCode。反射器获取此 ILCode 并将其反编译为您选择的语言。

这可能导致代码在 ILCode 中有效，但在目标语言中无效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:25:56.657

编译为 IL 是一个多对一的操作，反编译器在反编译时有关于他们选择的众多选项中的哪一个的规则。通常，不同的语言会产生无法直接用另一种语言重现的 IL。

在这种情况下，反编译器选择不当并且生成的 C# 无效（反编译器中的错误），或者它无法将代码反编译成等效的 C#。

# vba - Visio VBA 获取文本的边界框

> ID：11227259
> 
> 赞同：1
> 
> 时间：2012-06-27T13:23:31.910
> 
> 标签：vba, visio, shapesheet

我在 Visio 中有一个形状，它是一个组。组形状可以编辑其文本，并且在编辑时，我希望其中一个子形状位于组形状中文本的右侧。

为此，我创建了一个将组形状作为参数的 VBA 函数，并在 shapesheet 上的 TextText 事件中调用它。

因此，例程只需在组形状上调用 BoundingBox(visBBoxUprightText) 以获取文本的边界并将子形状定位到 bbox 的右侧。但边界似乎是错误的。他们有时会回到最后一个字符的左侧或右侧。

visBBoxUprightText 标志是否应该意味着除了在呈现的文本字符周围获取矩形坐标之外的其他含义？

编辑：再看一看，我看到 BoundingBox 方法查看 shape.type 属性以确定边界框包含的内容。如果形状类型是 visGroup ，那么它也将包括子形状，并且似乎没有标志来强制它将组视为简单形状。

所以我想现在的问题是，有没有办法获得文本的边界框，忽略子形状？我尝试放置一个单独的子形状来保存文本，现在它就像一个魅力。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T18:29:21.847

Visio 不允许您获取文本的边界框，而忽略分组形状中子形状的文本。

# coldfusion - java.lang.OutOfMemoryError：EntitySave 上的 Java 堆空间

> ID：11227260
> 
> 赞同：2
> 
> 时间：2012-06-27T13:23:41.717
> 
> 标签：coldfusion, coldfusion-9

我知道这个错误意味着什么，它是什么不寻常的东西抛出它。

```
EntitySave(arguments.entity); 
```

给了我一个

```
java.lang.OutOfMemoryError: Java heap space 
```

为什么？

注意：没有转储或其他任何东西抛出此错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T08:56:21.490

对了，找到答案了。抱歉，我没有提供很多 ORM 新的信息，也不知道如何查看日志。

无论如何，我发现“内存不足”只发生在“插入”上。看着我的实体，我包含了一个 preInsert() 函数，在这个函数中我有......

```
if(structKeyExists(this,"SETCREATEDBY")){
  local.accountuser = getService("accountService").getAccountLoggedIn();
  writeDump(this);
                this.setcreatedBy(local.accountuser); 

} 
```

所以是的，我的错，我确实有一个垃圾场！！！！很抱歉浪费你的时间吸取教训，我保证！:)

# c - 我需要 C 中的空间索引

> ID：11227265
> 
> 赞同：8
> 
> 时间：2012-06-27T13:23:52.353
> 
> 标签：c, glib

我正在研究[我的 gEDA 分支](http://repo.or.cz/w/geda-gaf/berndj.git)，并希望摆脱现有的简单基于图块的系统¹以支持真正的空间索引²。

有效地找到*点*的算法是不够的：我需要找到非零范围的对象。考虑具有边界矩形的对象，这几乎可以捕获我在索引中需要的详细程度。给定一个搜索矩形，我需要能够有效地找到边界矩形在搜索矩形内部或相交的所有对象。

索引不能是只读的：gschem 是一个原理图捕获程序，它的重点是在原理图周围移动东西。所以事情将会发生变化。因此，虽然我可以承受插入比搜索贵一点，但它不能*太贵*，而且删除也必须既可行又合理便宜。但最重要的要求是渐近行为：如果不能为 O(1)，则搜索应该为 O(log n)。插入/删除最好是 O(log n)，但 O(n) 就可以了。我绝对不想要任何 > O(n) （每个动作；显然 O(n log n) 是所有对象操作所期望的）。

我有哪些选择？我觉得自己不够聪明，无法评估[各种选择](http://en.wikipedia.org/wiki/Spatial_index#Spatial_index)。理想情况下，会有一些 C 库可以为我做所有聪明的事情，但我会机械地实现一个我可能会或可能不会完全理解的算法，如果我必须这样做。顺便说一句，gEDA 使用 glib，如果这有助于提出建议。

脚注：

¹标准 gEDA 将示意图划分为固定数量（目前为 100 个）的“图块”，用于加快在边界矩形中搜索对象的速度。这显然足以使大多数原理图足够快地进行搜索，但是这样做的方式会导致其他问题：太多的函数需要指向事实上的全局对象的指针。瓦片的几何形状也是固定的：可以通过平移（也可能是缩放）到仅由一个瓦片覆盖的区域来完全击败这个瓦片系统。

²一个合理的答案是保留平铺系统的元素，但要修复它的弱点：教它跨越整个空间，并在必要时细分。但在我独裁决定这是最好的方法之前，我希望其他人加两分钱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T14:25:09.647

您的需求听起来与游戏和物理模拟的碰撞检测算法中使用的非常相似。有几个开源 C++ 库可以在 2-D [(Box2D)](http://box2d.org/)或 3-D [(Bullet Physics)](http://bulletphysics.org/)中处理这个问题。尽管您的问题是针对 C 的，但您可能会发现它们的文档和实现很有用。

通常这分为[两个阶段](http://ianqvist.blogspot.com/2010/07/broad-and-narrow-phase-collision.html)：

1.  通过轴对齐边界框 (AABB) 逼近对象的快速宽相位，并确定接触或重叠的 AABB 对。
2.  一个较慢的窄阶段，计算 AABB 接触或重叠的对象对的几何重叠点。

物理引擎还使用空间相干性来进一步减少比较的对象对，但这种优化可能对您的应用程序没有帮助。

宽相通常使用 O(N log N) 算法（如[Sweep 和 prune](http://en.wikipedia.org/wiki/Sweep_and_prune) ）实现。您可以通过将其与当前的 tile 方法结合使用来加速这一过程（[Nvidia 的 GPUGems 之一](http://http.developer.nvidia.com/GPUGems3/gpugems3_ch32.html)描述了这种混合方法）。窄阶段对于每对来说都是相当昂贵的，并且对于您的需求来说可能是多余的。GJK[算法](http://en.wikipedia.org/wiki/Gilbert%E2%80%93Johnson%E2%80%93Keerthi_distance_algorithm)通常用于此步骤中的凸对象，尽管对于更特殊的情况（例如：盒/圆和盒/球碰撞）存在更快的算法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T14:27:44.733

混合点和线的一个很好的数据结构是 R-tree 或其派生类之一（例如 R*-Tree 或 Hilbert R-Tree）。鉴于您希望该索引是动态的和可序列化的，我认为使用[SQLite 的 R*-Tree 模块](http://www.sqlite.org/rtree.html)将是一种合理的方法。

如果您可以容忍 C++，[libspatialindex](https://github.com/libspatialindex/libspatialindex)具有成熟且灵活的 R-tree 实现，支持动态插入/删除和序列化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T13:59:04.107

这听起来像是一个非常适合四叉树的应用程序（假设您只对 2D 感兴趣。）[四叉树](http://en.wikipedia.org/wiki/Quadtree)是分层的（有利于搜索）并且它的空间分辨率是动态的（允许在需要它的区域具有更高的分辨率）。

我总是推出自己的四叉树，但这里有一个看起来很合理的库：http: [//www.codeproject.com/Articles/30535/A-Simple-QuadTree-Implementation-in-C](http://www.codeproject.com/Articles/30535/A-Simple-QuadTree-Implementation-in-C)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-27T14:07:20.927

这很容易做到。很难做到快。听起来像是我处理的一个问题，其中有大量的最小值、最大值列表，并且给定一个值，它必须返回与该值重叠的最小值、最大值对。你只是在两个维度上拥有它。因此，您可以为每个方向使用两棵树。然后对结果做一个交集。这真的很快。

```
#include <iostream>
#include <fstream>
#include <map>

using namespace std;

typedef unsigned int UInt;

class payLoad {
public:
    UInt    starts;
    UInt    finishes;
    bool    isStart;
    bool    isFinish;
    payLoad ()
    {
        starts = 0;
        finishes = 0;
        isStart = false;
        isFinish = false;
    }
};

typedef map<UInt,payLoad> ExtentMap;

//==============================================================================
class Extents
{
    ExtentMap   myExtentMap;

public:

    void ReadAndInsertExtents ( const char* fileName )
    {
        UInt start, finish;
        ExtentMap::iterator EMStart;
        ExtentMap::iterator EMFinish;

        ifstream efile ( fileName);
        cout << fileName << " filename" << endl;

        while (!efile.eof()) {
            efile >> start >> finish;
            //cout << start << " start " << finish << " finish" << endl;
            EMStart = myExtentMap.find(start);
            if (EMStart==myExtentMap.end()) {
                payLoad pay;
                pay.isStart = true;
                myExtentMap[start] = pay;
                EMStart = myExtentMap.find(start);
                }
            EMFinish = myExtentMap.find(finish);
            if (EMFinish==myExtentMap.end()) {
                payLoad pay;
                pay.isFinish = true;
                myExtentMap[finish] = pay;
                EMFinish = myExtentMap.find(finish);
            }
            EMStart->second.starts++;
            EMFinish->second.finishes++;
            EMStart->second.isStart = true;
            EMFinish->second.isFinish = true;

//          for (EMStart=myExtentMap.begin(); EMStart!=myExtentMap.end(); EMStart++)
//              cout << "| key " << EMStart->first << " count " << EMStart->second.value << " S " << EMStart->second.isStart << " F " << EMStart->second.isFinish << endl;

        }

        efile.close();

        UInt count = 0;
        for (EMStart=myExtentMap.begin(); EMStart!=myExtentMap.end(); EMStart++)
        {
                count += EMStart->second.starts - EMStart->second.finishes;
                EMStart->second.starts = count +  EMStart->second.finishes;
        }

//      for (EMStart=myExtentMap.begin(); EMStart!=myExtentMap.end(); EMStart++)
//          cout << "||| key " << EMStart->first << " count " << EMStart->second.starts << " S " << EMStart->second.isStart << " F " << EMStart->second.isFinish << endl;

    }

    void ReadAndCountNumbers ( const char* fileName )
    {
        UInt number, count;
        ExtentMap::iterator EMStart;
        ExtentMap::iterator EMTemp;

        if (myExtentMap.empty()) return;

        ifstream nfile ( fileName);
        cout << fileName << " filename" << endl;

        while (!nfile.eof()) 
        {
            count = 0;
            nfile >> number;
            //cout << number << " number ";

            EMStart = myExtentMap.find(number);
            EMTemp = myExtentMap.end();

            if (EMStart==myExtentMap.end()) {           // if we don't find the number then create one so we can find the nearest number.
                payLoad pay;
                myExtentMap[ number ] = pay;
                EMStart = EMTemp = myExtentMap.find(number);
                if ((EMStart!=myExtentMap.begin()) && (!EMStart->second.isStart)) 
                {
                    EMStart--;
                }
            }

            if (EMStart->first < number) {
                while (!EMStart->second.isFinish) {
                    //cout << "stepped through looking for end - key" << EMStart->first << endl;
                    EMStart++;
                    }
                if (EMStart->first >= number) {
                    count = EMStart->second.starts;
                    //cout << "found " << count << endl;
                    }
            }
            else if (EMStart->first==number) {
                count = EMStart->second.starts;
                }

            cout << count << endl;

            //cout << "| count " << count << " key " << EMStart->first << " S " << EMStart->second.isStart << " F " << EMStart->second.isFinish<< " V " << EMStart->second.value << endl;

            if (EMTemp != myExtentMap.end()) 
            {
                myExtentMap.erase(EMTemp->first);
            }
        }
        nfile.close();      
    }

};

//==============================================================================

int main (int argc,  char* argv[]) {
    Extents exts;

    exts.ReadAndInsertExtents ( "..//..//extents.txt" );
    exts.ReadAndCountNumbers ( "..//../numbers.txt" );

    return 0;
} 
```

范围测试文件为 1.5mb：

```
0 200000
1 199999
2 199998
3 199997
4 199996
5 199995
....
99995 100005
99996 100004
99997 100003
99998 100002
99999 100001 
```

数字文件就像：

```
102731
104279
109316
104859
102165
105762
101464
100755
101068
108442
107777
101193
104299
107080
100958
..... 
```

即使从磁盘读取这两个文件，extent 为 1.5mb，数字为 780k，而且值和查找的数量非常大，运行时间不到几分之一秒。如果在记忆中它会闪电般快速。

# facebook-insights - Facebook Insights 不适用于具有主页重定向的域？

> ID：11227266
> 
> 赞同：0
> 
> 时间：2012-06-27T13:23:53.687
> 
> 标签：facebook-insights

我有一个 301 将自身从[http://www.domainname.com](http://www.domainname.com)重定向到[http://www.domainname.com/subfolder/的域](http://www.domainname.com/subfolder/)

Facebook 元属性标签出现在子文件夹的每个页面上，当我将它添加到我的 Insights Dashboard 中时，它被 Facebook 识别。然而，洞察数据没有显示任何东西——不是网站、点赞按钮或评论框。

有什么建议吗？这可能与域主页将自己重定向到子文件夹的事实有关吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:41:48.667

如果[Facebook 的调试工具](https://developers.facebook.com/tools/debug)无法读取标签，则您无法声明该域。检查您是否将 Facebook 爬虫从您的重定向中排除，否则它将无法访问您的元标记。

# grails - Grails BuildConfig 中的 IntelliJ mavenLocal 警告

> ID：11227267
> 
> 赞同：1
> 
> 时间：2012-06-27T13:23:58.333
> 
> 标签：grails, groovy

此警告开始在 IntelliJ 中显示：
“org.codehaus.groovy.grails.resolve.config.RepositoriesConfigurer”中的“mavenLocal”不能应用于“（）”

这是来自 BuildConfig.groovy 的相关片段。

```
repositories {
    inherits true // Whether to inherit repository definitions from plugins
    grailsPlugins()
    grailsHome()
    grailsCentral()
    mavenLocal()
    mavenRepo "https://mycompany.artifactoryonline.com/mycompany/repo"
    mavenCentral()
} 
```

环境：
OSX 10.6.8
Grails 2.0.3
IntelliJ 11.1.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:43:25.997

RepositoriesConfigurer 中的 mavenLocal 方法定义如下：

```
void mavenLocal(String repoPath) {
    ...
} 
```

所以是的，mavenLocal 需要一个路径，但很高兴得到 null，这意味着使用默认的存储库路径（用户主目录下的 .m2/repository）。

据我了解，在这种情况下， mavenLocal() 解析为调用 mavenLocal(null) 。

mavenLocal 可能应该更改为

```
void mavenLocal(String repoPath = null) {
    ...
} 
```

使 repoPath 是可选的更明显，并摆脱 IntelliJ 中的警告

# batch-file - 批处理文件重命名文件

> ID：11227273
> 
> 赞同：3
> 
> 时间：2012-06-27T13:24:18.250
> 
> 标签：batch-file

我们在一个像这样命名的目录中有几千个文件：

```
EXP_10000021.XM_ 
```

并且需要删除前导 1 所以新的文件名是：

```
EXP_0000021.XM_ 
```

我不擅长批处理文件 - 任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-27T13:31:08.627

如果您的文件名都以`EXP_1`它开头，那很容易。

```
setlocal EnableDelayedExpansion
for %%A in (EXP_1*.XM_) do (
  set "filename=%%A"
  set "newName=EXP_!filename:~5!"

  rem ** remove the ECHO when it seems to work
  ECHO ren !filename! !newName!
) 
```

# fortran - 在 Fortran 中，以“#”开头和/或以“c”结尾的常量是什么意思？

> ID：11227282
> 
> 赞同：3
> 
> 时间：2012-06-27T13:24:49.120
> 
> 标签：fortran, gfortran

我需要编译以前使用 Compaq Fortran 编译器的旧 Fortran 程序。我似乎无法弄清楚以“#”开头的常量是什么。gfortran 说它是一个语法错误，我似乎找不到很多答案。

```
CHAR2 = IATA(KK) - #20202030
CHAR3 = IATA(KK+1) - #20202030 
```

什么样的常数是`#20202030`？根据评论，此代码应在 IATA 中采用两个 ASCII 字符并将它们转换为二进制。有人可以解释一下吗？

再向下：

```
IF (IATA(KK+1) .EQ. #2020202C) THEN 
```

现在末尾有一个“C”。这意味着什么？

如何将其移植到 gfortran？感觉就像我错过了一些明显的东西。请赐教。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-27T13:50:06.840

您正在查看的是非标准 Fortran。正如评论之一所暗示的，在 Compaq Fortran 中，`#`用作十六进制常量的前缀。正如另一条评论所暗示的，十六进制常量的标准前缀是 Z 并且数字应该用 '' 标记括起来。所以非标准`#2020202C`应该转化为标准`Z'2020202C'`。

至于尾随`C`，我认为这只是一个十六进制数字。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-27T15:05:16.987

只是一个评论：

除了是非标准表示法的十六进制文字外，这些也是适合 32 位整数值的 ASCII 字符串。当存储在内存中时，`#20202030`是`'___0'`或`'0___'`取决于架构的字节序，`#2020202C`而是`'___,'`或`',___'`（下划线表示空白）。用空格填充是标准的 Fortran 行为，将 8 位字符存储到用空格而不是 NUL-s 填充的 32 位类型中，例如使用`#20202030`代替`#00000030`，对于 Fortran 程序员来说应该不足为奇。

在 C 和 C++ 中`'0'`，从另一个字符中减去是一种非常常见的方法，可以将 、 等字符转换`0`为`1`它们`2`的数字等价物（这绝对不能用于特殊的 Unicode 符号）。例如，由于 ASCII 码是`'9' - '0'`0x39 （57），而 ASCII 码是 0x30（48），因此给出。Fortran 不像C 和 C++ 那样将整数视为整数，并且必须使用它们或将它们转换为它们的 ASCII 代码，但该代码仍然像 C/C++ 那样工作。`9``9``0``CHARACTER``ICHAR()``IACHAR()`

`IATA`数组是如何定义的？如何为其元素分配值？

# ruby-on-rails - 导轨 3.2.6；耙 0.9.2.2; db:迁移中止

> ID：11227284
> 
> 赞同：2
> 
> 时间：2012-06-27T13:24:54.983
> 
> 标签：ruby-on-rails, ruby, rake

我是 Rails 的新手，并且正在关注他们网站上的入门指南。

`$ rake db:migrate`在以下部分运行时出现错误：http: [//guides.rubyonrails.org/getting_started.html#generating-a-model](http://guides.rubyonrails.org/getting_started.html#generating-a-model)

它在以下部分第一次起作用：http: [//guides.rubyonrails.org/getting_started.html#running-a-migration](http://guides.rubyonrails.org/getting_started.html#running-a-migration)

所以我不知道出了什么问题。

当我跑`$ rake db:migrate`

```
==  CreateComments: migrating =================================================
-- create_table(:comments)
rake aborted!
An error has occurred, this and all later migrations canceled:

private method `test' called for #<ActiveRecord::ConnectionAdapters::TableDefinition:0x007f83a27503c8>

Tasks: TOP => db:migrate
(See full trace by running task with --trace) 
```

所以我按照说明用`--trace`参数运行它；我想知道是否有人知道这意味着什么，问题是什么？

```
** Invoke db:migrate (first_time)
** Invoke environment (first_time)
** Execute environment
** Invoke db:load_config (first_time)
** Invoke rails_env (first_time)
** Execute rails_env
** Execute db:load_config
** Execute db:migrate
==  CreateComments: migrating =================================================
-- create_table(:comments)
rake aborted!
An error has occurred, this and all later migrations canceled:

private method `test' called for #<ActiveRecord::ConnectionAdapters::TableDefinition:0x007f8bacbba730>
/Users/parnmatt/Sites/test-rails/blog/db/migrate/20120627130542_create_comments.rb:5:in `block in change'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/schema_statements.rb:160:in `create_table'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:466:in `block in method_missing'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:438:in `block in say_with_time'
/Users/parnmatt/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/benchmark.rb:280:in `measure'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:438:in `say_with_time'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:458:in `method_missing'
/Users/parnmatt/Sites/test-rails/blog/db/migrate/20120627130542_create_comments.rb:3:in `change'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:407:in `block (2 levels) in migrate'
/Users/parnmatt/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/benchmark.rb:280:in `measure'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:407:in `block in migrate'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:123:in `with_connection'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:389:in `migrate'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:528:in `migrate'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:720:in `block (2 levels) in migrate'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:775:in `call'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:775:in `block in ddl_transaction'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/transactions.rb:208:in `transaction'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:775:in `ddl_transaction'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:719:in `block in migrate'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:700:in `each'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:700:in `migrate'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:570:in `up'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/migration.rb:551:in `migrate'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.6/lib/active_record/railties/databases.rake:153:in `block (2 levels) in <top (required)>'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'
/Users/parnmatt/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/gems/rake-0.9.2.2/bin/rake:33:in `<top (required)>'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/bin/rake:19:in `load'
/Users/parnmatt/.rvm/gems/ruby-1.9.3-p0/bin/rake:19:in `<main>'
Tasks: TOP => db:migrate 
```

这是生成的迁移代码：

```
class CreateComments < ActiveRecord::Migration
  def change
    create_table :comments do |t|
      t.string :commenter
      t.test :body
      t.references :post

      t.timestamps
    end
    add_index :comments, :post_id
  end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T14:44:19.803

看起来当您运行生成器时，您对正文说的是“测试”而不是“文本”。

应该是：$ rails generate model Comment commenter:string body:text post:references

Rake 不知道 t.test 是什么类型...本来应该是 t.text

# php - 在 Symfony 2 中获取所有请求参数

> ID：11227285
> 
> 赞同：74
> 
> 时间：2012-06-27T13:24:55.177
> 
> 标签：php, symfony, request

在 symfony 2 控制器中，每次我想从帖子中获取值时，我都需要运行：

```
$this->getRequest()->get('value1');
$this->getRequest()->get('value2'); 
```

有没有办法将这些合并到一个返回数组的语句中？Zend 的 getParams() 之类的东西？

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2012-06-27T13:30:22.747

您可以`$this->getRequest()->query->all();`获取所有 GET 参数并`$this->getRequest()->request->all();`获取所有 POST 参数。

所以在你的情况下：

```
$params = $this->getRequest()->request->all();
$params['value1'];
$params['value2']; 
```

有关 Request 类的更多信息，请参阅[http://api.symfony.com/2.8/Symfony/Component/HttpFoundation/Request.html](http://api.symfony.com/2.8/Symfony/Component/HttpFoundation/Request.html)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-10-25T09:16:47.903

使用最近的 Symfony 2.6+ 版本作为最佳实践，请求作为带有操作的参数传递，在这种情况下，您不需要显式调用 $this->getRequest()，而是调用 $request->request->all()

```
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Route;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Template;
use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\HttpKernel\Exception\BadRequestHttpException;
use Symfony\Component\HttpKernel\Exception\NotAcceptableHttpException;
use Symfony\Component\HttpFoundation\RedirectResponse;

    class SampleController extends Controller
    {

        public function indexAction(Request $request) {

           var_dump($request->request->all());
        }

    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-10-01T07:31:28.740

由于您在控制器中，因此为操作方法提供了一个`Request`参数。

您可以使用 访问所有 POST 数据`$request->request->all();`。这将返回一个键值对数组。

使用 GET 请求时，您可以使用`$request->query->all();`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-09-19T12:46:02.617

对于**Symfony 3.4**，您可以访问**GET**和**POST**的数据，就像这样

邮政：

```
$data = $this->request->request->all(); 
```

得到：

```
$data = $this->request->query->all(); 
```

# php - 无需登录的 php 安全投票系统

> ID：11227286
> 
> 赞同：5
> 
> 时间：2012-06-27T13:24:57.197
> 
> 标签：php, cookies, ip, voting, vote

有没有办法让一个相当安全的系统在无需登录的情况下进行投票。我现在使用 cookie 来设置该人是否已投票，并将用户 ip 插入数据库中。

如果该用户删除了他的 cookie，他将能够再次投票。这就是为什么我检查用户的 ip 是否存在于数据库中，以及该 IP 是否在最后 30 秒内投票。这样他就必须删除他的 cookie 并更改他的 IP 地址才能再次投票。

我知道对此没有 100% 的防故障解决方案，但有没有更安全的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T13:46:47.913

有两种方法可以改善您的结果，但如果您需要，请自行阅读和判断：

### 更持久的 cookie

有[Evercookie 项目](http://samy.pl/evercookie/)，它在很多地方存储了类似 cookie 的信息。它比普通 cookie 更难删除。

我个人认为这个项目应该被认为是一个概念证明，实际使用它是不道德的

### 更好的用户识别

您可以使用浏览器指纹识别，而不是仅仅查看 IP 地址来识别回访者。EFF 通过他们的[Panopticlick 项目](https://panopticlick.eff.org/)表明，浏览器版本、操作系统版本、已安装的附加组件等的组合通常是独一无二的。[Piwik 网络分析工具](http://piwik.org)也使用这种用户启发式方法来区分访问者。我不知道实现，但它是 FOSS 和 PHP，所以你应该能够找到那部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T13:28:28.847

您可以同时使用这两种解决方案 - 但它仍然不是很安全。您可以阻止子网投票 (192.168.1.xxx) 以防止动态 IP 更改，但随后您也阻止了多达 254 人投票 - 它不会阻止代理。

我见过很多使用的一种方法是让它看起来像你允许重复投票。即：在最终用户端显示他们的重复投票已被计算在内，但实际上并没有在您自己的数据库中计算它。

但实际上，登录系统大约是唯一相对“安全”的方式——但如果有人足够坚定，那显然也可以被玩弄。

希望这可以帮助。

*   伊根

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-16T00:16:13.400

您可以为用户代理做广告（在短时间内，两个冲浪者完全相同的机会通常很小：[https](https://panopticlick.eff.org/index.php?action=log&js=yes) ://panopticlick.eff.org/index.php?action=log&js=yes ）但是再次'如果有人足够坚定，这显然也可以玩。

# pdf - 理解 PDF 代码中的数字

> ID：11227287
> 
> 赞同：2
> 
> 时间：2012-06-27T13:24:59.647
> 
> 标签：pdf, pdf-generation

我想知道在我解密文件后是否有人能够告诉我以下数字的含义。我遇到了损坏的文件问题，我正在尝试找出损坏的位置，以便将来尝试修复它。

有问题的数字位于以下代码中的星号之间：

```
h
W
n
q
/ttf37 141 Tf
0.000 0.000 0.000 sc
BT
1 0 0 1 **1980.000000 12593.000000** Tm
(8953 - 18) Tj
ET
Q
Q
q
720 12518 m
1875 12518 l
1875 12308 l
720 12308 l 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T13:52:06.403

查看[PDF 参考 1.7](http://www.adobe.com/devnet/pdf/pdf_reference_archive.html)，特别是第 406 页的表 5.5，了解`Tm`（代表*Transformation matrix*）运算符的定义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T14:07:01.950

正如[@Alex Pigeon](https://stackoverflow.com/a/11227818/501196)所说，`Tm`指定将应用于所有后续运算符的转换矩阵。变换矩阵可以用于图形操作的旋转、平移、缩放等，并且可以与之前的变换相结合。

除了 PDF 规范之外，您还可以使用术语[仿射变换](http://en.wikipedia.org/wiki/Affine_transformation)来获取更多详细信息。

# sql-server-2008 - 从 Pivot tsql 中删除空列

> ID：11227288
> 
> 赞同：1
> 
> 时间：2012-06-27T13:25:00.870
> 
> 标签：sql-server-2008, tsql, pivot, pivot-without-aggregate

我在 tsql 中开发了一个枢轴，如下所示：

```
MaturityBand    AAA     AA+     AA      AA-     A+      A       A-      Grand_Total 
Less than 1 yr  NULL    NULL    NULL    NULL    NULL    NULL    7.92    7.92
1 to 5 yrs      NULL    NULL    0.44    NULL    NULL    1.95    8.96    11.35
5 to 10 yrs     NULL    NULL    1.33    NULL    NULL    4.11    4.04    9.98
10 to 20 yrs    NULL    NULL    1.14    NULL    NULL    0.74    1.07    2.95
>20 years       NULL    NULL    0.15    NULL    NULL    NULL    0.14    0.29
Total           NULL    NULL    3.06    NULL    NULL    6.8     22.13   31.99 
```

我想要做的是删除空列，以便上面变成下面：

```
MaturityBand    AA      A       A-      Grand_Total 
Less than 1 yr  NULL    NULL    7.92    7.92
1 to 5 yrs      0.44    1.95    8.96    11.35
5 to 10 yrs     1.33    4.11    4.04    9.98
10 to 20 yrs    1.14    0.74    1.07    2.95
>20 years       0.15    NULL    0.14    0.29
Total           3.06    6.8     22.13   31.99 
```

这可能吗？

（如有必要，我可以发布我的代码。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:30:53.437

`WHERE`不， or子句中的过滤器`HAVING`适用于行，而不是列。如果您不想要特定列，则只能从`SELECT`子句中手动将其排除。

```
SELECT 
MaturityBand, AA, A, [A-], Grand_Total 
FROM
(
   /*put your pivot query here*/
)some_alias 
```

这是我今天为动态枢轴写的答案（如评论中建议的 aF.）。

[动态透视查询](https://stackoverflow.com/questions/11220196/dynamic-pivot-query/11224988#11224988)

试一试，请告诉我结果。实际上，如果这行得通，我会感到惊讶。

# perl - 在 perl 脚本中使用 config/properties 文件中的变量

> ID：11227291
> 
> 赞同：1
> 
> 时间：2012-06-27T13:25:05.810
> 
> 标签：perl, configuration-files, cpan

如果我有一个与我的 perl 脚本分开的可配置变量页面，我如何在其中使用它们？

假设我在文件中有这些变量..

```
database.properties:

    database = "dbi:Oracle:host=host-321;sid=XE;port=1337","User","Passwd"

    table1 = CHANNEL

    table2 = NODE 
```

...我的 perl 脚本的这些部分需要它们：

```
my $dbh = DBI->connect($database);

open ROW,">","./report/archive/rprt-$now/row_counts.txt" or die "Unable to create file: $!";
    my $chanRows = $dbh->selectrow_array("SELECT COUNT(*) FROM $table1");
    my $nodeElemsRows = $dbh->selectrow_array("SELECT COUNT(*) FROM $table2 WHERE NODE_TYPE > 1");
    my $nodeDeviceRows = $dbh->selectrow_array("SELECT COUNT(*) FROM $table2 WHERE NODE_TYPE = 1");
    print ROW "Channels: $chanRows\n";
    print ROW "Network Elements: $nodeElemsRows\n";
    print ROW "Devices: $nodeDeviceRows";
close ROW; 
```

显然，只是简单地将 $database、$table1 和 $table2 放在那里不会有任何好处，那么正确的方法是什么？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T13:42:34.840

您可以使用[Config::Tiny](https://metacpan.org/module/Config%3a%3aTiny)。您的配置文件可能如下所示：

```
[databaseproperties]

    database = "dbi:Oracle:host=host-321;sid=XE;port=1337","User","Passwd"

    table1 = CHANNEL

    table2 = NODE 
```

你的脚本是这样的：

```
#!/usr/bin/env perl
use strict;
use warnings;
use Config::Tiny;
my $config = Config::Tiny->new;
$config = Config::Tiny->read('myconfig');
my $database = $config->{databaseproperties}->{database};
print "DATABASE = $database\n";
my $table1 = $config->{databaseproperties}->{table1};
print "TABLE-1  = $table1\n";
my $table2 = $config->{databaseproperties}->{table2};
print "TABLE-2  = $table2\n"; 
```

# javascript - 如何在事件中使 div 滑动到窗口底部

> ID：11227292
> 
> 赞同：1
> 
> 时间：2012-06-27T13:25:17.723
> 
> 标签：javascript, jquery, css

当我单击一个按钮时，我正在尝试将 div 临时滑动到屏幕底部的 FIXED 位置。我希望它滑回按钮释放时的位置，但我无法让它工作。我的代码如下

```
$("#chatContainer").css("position", "fixed");
$("#chatContainer").animate({ top: '60%' }, 'slow'); 
```

因为位置是临时固定的，所以Div从屏幕中间弹出，然后向下滑动。我希望它从底部滑动并粘在那里直到释放咔嗒声。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:35:50.930

这是我尝试的方式（在我的脑海中）：

1.  获取相关容器的窗口 x/y 坐标。
2.  $.clone 它，然后将克隆的 x/y 坐标设置为与原始位置相同（这样它似乎正在从原始位置移动）。
3.  执行必要的动画（隐藏原始>动画克隆到新位置>在新位置重新显示原始>淡出/删除克隆）

您可能需要进行一些调整以避免克隆上不必要的绑定等，因为克隆“只是为了展示”。

我不确定这是技术上的“最佳”方式，但我会尝试采用这种方式来获得所需的用户体验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T13:54:17.277

此代码假定您的滑动`div`是在一个容器内，但它应该很容易调整以使用浏览器窗口作为参考：

```
var speed = .5; // higher number = faster animation
var originalPosition = null;

$('#container').mousedown(function(){
    var $slider = $('#slider');
    var start = $slider.position().top;
    if(!originalPosition) {
        originalPosition = {top: start};
    }
    var end = $(this).height() - $slider.height();
    var duration = (2/speed) * (end - start);
    $slider.css({
        position: 'absolute',
        top: start+'px',
    }).stop().animate({
        top: end+'px'
    },duration);
}).mouseup(function(){
    var $slider = $('#slider');
    $slider.stop();
    var start = $slider.position().top;
    var end = originalPosition.top;
    var duration = (2/speed) * (start - end);
    $slider.animate({
        top: end+'px'
    },duration,function(){
        $(this).css({position: 'static'});
    });
}); 
```

这是一个例子：[**jsFiddle：DEMO**](http://jsfiddle.net/jackwanders/W4aAh/)

该解决方案的好处是可以根据`div`需要滑动的距离来调整动画的持续时间。这样，动画的“速度”是恒定的。

# apache - 在 ssh 隧道中连接被拒绝到 apache 转发代理设置

> ID：11227293
> 
> 赞同：2
> 
> 时间：2012-06-27T13:25:21.613
> 
> 标签：apache, proxy, ssh, mod-proxy, tunnel

我正在尝试在小型服务器中设置私有转发代理。我的意思是在会议期间使用它通过 ssh 隧道将我的互联网访问隧道连接到代理服务器。

所以我在 apache-2.2 中创建了一个虚拟主机，运行代理、proxy_http 和 proxy_connect 模块。我使用这个配置：

```
<VirtualHost localhost:8080>
        ServerAdmin xxxxxxxxxxxxxxxxxxxx
        ServerName yyyyyyyyyyyyyyyyyyyy

        ErrorLog /var/log/apache2/proxy-error_log
        CustomLog /var/log/apache2/proxy-access_log combined

        <IfModule mod_proxy.c>
                ProxyRequests On
                <Proxy *>
                        # deny access to all IP addresses except localhost
                        Order deny,allow
                        Deny from all
                        Allow from 127.0.0.1
                </Proxy>
                 # The following is my preference. Your mileage may vary.
                 ProxyVia Block
                ## allow SSL proxy
                AllowCONNECT 443
        </IfModule>
</VirtualHost> 
```

重新启动 apache 后，我创建了一个从客户端到服务器的隧道：

```
#> ssh -L8080:localhost:8080 <server address> 
```

并尝试通过该隧道访问互联网：

```
#> links -http-proxy localhost:8080 http://www.linux.org 
```

我希望看到请求的页面。而是出现“连接被拒绝”错误。在打开 ssh 隧道的外壳中，我得到了这个：

> 通道 3：打开失败：连接失败：连接被拒绝

有人知道为什么拒绝此连接吗？

# regex - 使用正则表达式和 powershell 重命名文件名的一部分

> ID：11227297
> 
> 赞同：0
> 
> 时间：2012-06-27T13:25:24.407
> 
> 标签：regex, powershell-2.0

我有一些文件想使用 regex 和 powershell 重命名，但我不确定这些文件的模式。

我需要重命名的文件名示例以及它们最终的外观。ps 将名称放在“”中以说明空格。

**现在如何命名文件**

“[abs] anima.some e147 name [480p].avi”
“anima.some e147 name #anim group .avi”
“anima.some e147 name [480p].avi”
“anima some e147 name [480p].avi”

**他们应该如何命名**

“动漫一些 e147.avi”</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T15:28:39.157

这个怎么样：

```
# Create array of filenames
$files = 
"[abs] anima.some e147 name [480p].avi",
"anima.some e147 name #anim group .avi",
"anima.some e147 name [480p].avi",
"anima some e147 name [480p].avi"

# Setup patterns to match against
$pattern1 = "\[\w+\] ([^.]+).([\w]+) ([\S]+) [\w]+ \[[\w]+\].avi"
$pattern2 = "([^.\s]+).([\w]+) ([\S]+) .*.avi"

# Loop through file names and attempt matching
foreach($f in $files)
{
    if($f -match $pattern1)
    {
        $string = (Get-Culture).TextInfo.ToTitleCase($matches[1]) + " " + $matches[2] + " " + $matches[3] + ".avi"
        $string
    }
    elseif($f -match $pattern2)
    {
        $string = (Get-Culture).TextInfo.ToTitleCase($matches[1]) + " " + $matches[2] + " " + $matches[3] + ".avi"
        $string
    }
    else
    {
        "unmatched file: " + $f
    }
} 
```

输出是：

```
Anima some e147.avi
Anima some e147.avi
Anima some e147.avi
Anima some e147.avi 
```

# apache - Apache 将流量从端口 80 路由到其他端口

> ID：11227301
> 
> 赞同：1
> 
> 时间：2012-06-27T13:25:50.193
> 
> 标签：apache, node.js, routing

我有一个处理许多 VirtulServers 的 Apache 服务器，一切正常。我不知道它在内部是如何工作的，但确实如此。

我最近对 ​​nodejs 做了一些修改，在这台服务器上做实验，在 8080 端口上。现在我想继续生产，我已经设置了一个指向我的服务器的域名，但我想避免我现在拥有的丑陋的 example.org:8080/ URL。我怎么能告诉正在监听 80 的 Apache 将流量从 example.org 路由到 123.12.12.123:8080，反之亦然，而不会中断对其他 VirtualServer 的访问？

我尝试过 ModRewrite [L]，但指定端口和域会强制它出现在浏览器的地址栏中，这更难看。我尝试了 ModRewrite [P] 和 ProxyPass，但没有成功（都给出 500 错误）。接下来我应该尝试什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:30:44.073

使用 mod_proxy 模块而不是 mod_rewrite。

你需要这些行：

```
ProxyRequests off
ProxyPass http://example.org http://123.12.12.123:8080
ProxyPassReverse http://example.org http://123.12.12.123:8080 
```

而已。哦，是的，那是 ProxyPass OFF。不开。

# objective-c - 如何编写包含字典数组的plist

> ID：11227305
> 
> 赞同：0
> 
> 时间：2012-06-27T13:25:56.973
> 
> 标签：objective-c, plist

我是 iPhone 的新开发者。我在主包中有一个 plist 文件（名为“Favorites”）。

我需要为 20 个字典项编写具有以下结构的数据。我该怎么写？

```
<array>
<dict>
    <key>PubDate</key>
    <date>2011-08-12T23:15:12Z</date>
    <key>ImageName</key>
    <string>abc.png</string>
    <key>Title</key>
    <string>ABCDEF</string>
    <key>Description</key>
    <string>Suggestions?</string>
</dict>
<dict>
    <key>PubDate</key>
    <date>2011-08-12T23:15:12Z</date>
    <key>ImageName</key>
    <string>abc.png</string>
    <key>Title</key>
    <string>ABCDEF</string>
    <key>Description</key>
    <string>Suggestions?</string>
</dict>
<dict>
    <key>PubDate</key>
    <date>2011-08-12T23:15:12Z</date>
    <key>ImageName</key>
    <string>abc.png</string>
    <key>Title</key>
    <string>ABCDEF</string>
    <key>Description</key>
    <string>Suggestions?</string>
</dict> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:42:17.133

好吧，不要指望人们会为您写出所有代码，但这可能与您正在寻找的内容很接近。

```
//Put this where you want to write the data. add is the filename you want to save under
    [info writeToFile:[self saveFilePath:add] atomically:YES];

//Put this somewhere in your class
- (NSString*) saveFilePath: (NSString *) add
{
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,NSUserDomainMask, YES);
    NSString *path = [paths objectAtIndex:0];
    NSString *filename = [path stringByAppendingPathComponent:add];
    return filename;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:49:28.050

我会建议你制作一个 Java 类型字典，因为字典是不可变的，所以你创建一次就不能添加或删除对象。对于类似 Java 的字典，您需要使用 NSMutableDictionary....

# android - Android 培训 - 缺少源代码？

> ID：11227306
> 
> 赞同：0
> 
> 时间：2012-06-27T13:25:59.207
> 
> 标签：android

从[http://developer.android.com/training/index.html开始](http://developer.android.com/training/index.html)

我选择了 [FIRST CLASS > ] 按钮，该按钮将我带到 [http://developer.android.com/training/basics/firstapp/index.html](http://developer.android.com/training/basics/firstapp/index.html) 。一页解释了这些课程的先决条件

*   下载 Android SDK 入门包。
*   为 Eclipse 安装 ADT 插件（如果您将使用 Eclipse IDE）。
*   使用 SDK 管理器下载最新的 SDK 工具和平台。

和其他一些设置项目，然后让 您选择 *[First Lesson]*或*[Creating an Android Project* [] .html](http://developer.android.com/training/basics/firstapp/creating-project.html)

选择*[Creating an Android Project]*会将您带到一个页面，该页面很好地引导您扔掉创建空白项目所需的表单（此时没有代码），然后为您提供选择*[next course]*的选项- 或者 - 您可以放弃到页面底部并选择*[NEXT]*两个选项都将您带到同一个地方“Running You App”（仍然没有代码行）

运行您的应用程序的第一段说如果您按照*[上一课]*创建一个 Android 项目，它包含一组默认的“Hello World”源文件，允许您立即运行应用程序。

```
- - - 
```

到目前为止，我在任何培训页面中都没有看到“Hello World”的任何源代码或文件。我错过了什么？教程是否遗漏了一步？我确信我可以毫无问题地从头开始编写一个“hello world”程序，但如果我以前从未玩过 Android 的话。这对我来说很容易成为表演的终结者。这些课程中是否缺少他们的一些信息，或者我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:29:19.137

他们最近重新做了他们的网站，似乎已经删除了一些曾经在那里的课程/教程。我还没有阅读任何内容来解释原因（我假设他们觉得他们已经过时，不符合当前标准）或者他们是否会回来。

# oracle - 休眠。重启 Oracle 数据库

> ID：11227310
> 
> 赞同：0
> 
> 时间：2012-06-27T13:26:22.767
> 
> 标签：oracle, hibernate, jboss

我有一个使用 Hibernate 3.0 的 Web 应用程序。当我重新启动我的数据库服务器时，是否总是需要重新启动 jboss 服务器？

我可以在不重新启动 jboss 服务器的情况下重新连接到数据库吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T14:59:35.520

取决于池配置。

如果启用“验证连接”检查，通过在处理连接到调用者之前传递要执行的 SQL，您的应用程序将不会获得无效连接。这意味着连接将被丢弃，如果连接断开，将获取一个新的连接。当然，您为此付出的代价是往返于服务器。

但通常情况下，您可以忽略这一点，让异常分类器处理此情况。如果驱动程序抛出 JDBC 问题，这个“排序器”将分析它们并确定连接是否可以返回到池中。我不确定异常排序器的 MySQL 实现，所以，它可能值得一试。如果它没有帮助，您始终可以扩展现有的排序器并将您的逻辑添加到它。

# c# - 参考参数返回未知大小的数组。怎么处理？

> ID：11227314
> 
> 赞同：3
> 
> 时间：2012-06-27T13:26:34.260
> 
> 标签：c#, .net, arrays, com, ref

COM 组件公开了一个 API，该 API 需要一个对象类型的 ref 参数。根据此 API 的文档，它将用值数组填充 ref 对象。现在我的问题在于 prod env 我无法预测我将返回的元素数量。

以下代码将起作用。

```
 COMClass objCOM = new COMClass ();
     object colOfInts= new int[10]; // What if I don't know the following will return array of size 10?
     int errorcode = objCOM.FillThisIn(ref colOfInts); 
```

但是，如果我不知道 API 在 ref 中返回的数组大小怎么办？

在这里更新

```
 object colOfInts = null;
        int errorcode = objCOM .FillThisIn(ref colOfInts); 
```

现在，当我检查类型时，我得到 System.Int32[*]

基本上我需要遍历这个数组并检查一个元素的存在

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T16:59:55.000

您将返回一个下限不是 0 的数组。这在 COM 互操作中并不少见，下一个可能的选择是 1。您不必复制它，您可以使用 Array.GetValue() 访问元素。Array.GetLowerBound() 告诉你从哪里开始，Array.GetLength() 或 Array.GetUpperBound() 告诉你要走多远。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T16:58:17.923

如果你要返回一个数组`System.Int32`，你可能只需要转换：

```
 object colOfInts = null; 
    int errorcode = objCOM .FillThisIn(ref colOfInts); 

    int[] arrayOfInts = (int[]) colOfInts; 
```

然后`arrayOfInts.Length`将有数组中的元素数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T14:17:15.337

最后我得到了一些解决方案。忘了提 erroCode 会有数组的大小。

```
 int[] test = new int[errorCode];            
        Buffer.BlockCopy((System.Array)colOfInts, 0, test, 0, errorCode * sizeof(int)); 
```

# symfony - 水貂痛风司机。无法在 Symfony 2.0 上安装 fabpot/goutte

> ID：11227318
> 
> 赞同：0
> 
> 时间：2012-06-27T13:26:49.020
> 
> 标签：symfony, composer-php, behat, mink, goutte

我正在使用带有 Symfony 2.0.15 的作曲家并迁移到最新的 Behat 2.4。这是在我的`composer.json`：

```
"require-dev": {
    "behat/behat": "2.4@stable",
    "behat/mink-extension": "*",
    "behat/symfony2-extension": "*",
    "behat/mink-browserkit-driver":  "*",
    "behat/mink-goutte-driver":  "dev-master",
    "behat/common-contexts": "*",
    "kriswallsmith/buzz": ">=0.5.0"
} 
```

我跑：`php composer.phar update --dev`

并且有一个错误：

```
Your requirements could not be solved to an installable set of packages.

Problem 1
- Installation request for behat/mink-goutte-driver dev-master -> satisfiable by behat/mink-goutte-driver dev-master.
- don't install fabpot/goutte 1.0.x-dev|install fabpot/goutte dev-master
- behat/mink-goutte-driver dev-master requires fabpot/goutte 1.0.* -> satisfiable by fabpot/goutte 1.0.x-dev.
- Conclusion: remove symfony/symfony v2.0.15
- fabpot/goutte dev-master requires symfony/dom-crawler 2.1.* -> satisfiable by symfony/symfony 2.1.x-dev, symfony/dom-crawler v2.1.0-BETA1, symfony/dom-crawler 2.1.x-dev, symfony/symfony v2.1.0-BETA1.
- Can only install one of: symfony/symfony v2.0.15, symfony/symfony 2.1.x-dev.
- Can only install one of: symfony/symfony v2.1.0-BETA1, symfony/symfony v2.0.15.
- don't install symfony/symfony v2.0.15|don't install symfony/dom-crawler v2.1.0-BETA1
- don't install symfony/dom-crawler 2.1.x-dev|don't install symfony/symfony v2.0.15
- Installation request for symfony/symfony == 2.0.15.0 -> satisfiable by symfony/symfony v2.0.15. 
```

如果我正确理解了这个错误，那是因为`fabpot/goutte`包依赖于 Symfony 2.1 包并且不适用于 Symfony 2.0。纠正我，如果我错了。

这是我的`behat.yml`：

```
default:
    formatter:
      parameters:
        paths: false
     context:
      class: 'Site\PublicBundle\Features\Context\FeatureContext'
      parameters:
        base_url:  'http://test-anton.site.com'
    extensions:
      Behat\Symfony2Extension\Extension:
        mink_driver: true
        bundle: 'PublicBundle'
        kernel:
          env: test
          debug: true
      Behat\MinkExtension\Extension:
        default_session: symfony2
        base_url:  'http://test-anton.site.com' 
```

这是我失败场景的示例：

```
Scenario: User can view homepage
    When I go to "/"
    Then the response code should be 200 
```

`"When I go to"`- 是 MinkContext 步骤，但`"Then the response code should be 200"`- 是来自 Behat\CommonContexts\WebApiContext 的步骤。当我只使用 MinkContext 中的步骤时 -`"Then the response status code should be 200"`它工作得很好。

* * *

最后的答案是`Behat\CommonContexts\WebApiContext`与 Behat 2.4 不兼容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T08:09:21.140

可能是一个愚蠢的问题，但你使用 goutte 吗？我最近进行了类似的更新，我只需要 mink-browserkit-driver。

我不确定为什么 goutte 依赖于 2.1，并且将它与 2.0 一起使用可能会有风险。如果您真的需要它，请尝试在您的 composer.json 中为 goutte 定义一个自定义存储库（并对 Symfony 的要求撒谎）。

**更新**

请注意，错误消息显示“*调用成员函数 getUri()* ”。它与[getCurrentUri()](https://github.com/Behat/MinkBrowserKitDriver/blob/master/src/Behat/Mink/Driver/BrowserKitDriver.php#L117)相关：

```
public function getCurrentUrl()
{
     return $this->client->getRequest()->getUri();
} 
```

这意味着客户端在那里，但*getRequest()*返回 null。这表明尚未提出请求。

您在访问其 URL 之前是否提出过请求？

安装 Goutte 不会解决您的问题（您根本不需要它）。

# css - CSS 选择器 ul li a {...} vs ul > li > a {...}

> ID：11227322
> 
> 赞同：40
> 
> 时间：2012-06-27T13:26:58.030
> 
> 标签：css, css-selectors

1.  `ul > li > a {...}`CSS和CSS有什么区别`ul li a {...}`？
2.  哪个更有效，为什么？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-06-27T13:41:27.103

“ `>`”是[子选择器](http://www.w3.org/TR/CSS2/selector.html#child-selectors)

“ `”是[后代选择器](http://www.w3.org/TR/CSS2/selector.html#descendant-selectors)`

 `不同之处在于，后代可以是元素的子元素，也可以是元素的子元素的子元素，也可以是子元素的子元素的子*元素*。

子元素只是直接包含在父元素中的元素：

```
<foo> <!-- parent -->
  <bar> <!-- child of foo, descendant of foo -->
    <baz> <!-- descendant of foo -->
    </baz>
  </bar>
</foo> 
```

对于此示例，`foo *`将匹配`<bar>`and `<baz>`，而`foo > *`仅匹配`<bar>`.

至于你的第二个问题：

> 哪个更有效，为什么？

我实际上不会回答这个问题，因为它与开发完全无关。CSS 渲染引擎是如此之快，以至于除了使 CSS 选择器尽可能短之外，几乎没有*优化 CSS 选择器的理由。

与其担心微优化，不如专注于编写对手头的情况有意义的选择器。在为嵌套列表设置样式时，我经常使用`>`选择器，因为区分正在设置样式的列表级别很重要。

[* 如果在渲染页面时确实存在问题，则可能是页面上的元素过多，或者 CSS 过多。然后你必须运行一些测试来看看实际问题是什么。]

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-06-27T13:31:59.917

`ul>li`a `li`_ `ul`_ `ul li`_ `li`_`ul`

对于 HTML：

```
<ul>
  <li><span><a href='#'>Something</a></span></li>
  <li><a href='#'>or Other</a></li>
</ul> 
```

和 CSS：

```
li a{ color: green; }
li>a{ color: red; } 
```

的颜色`Something`将保持绿色，但`or Other`将是红色

第 2 部分，您应该编写适合情况的规则，我认为速度差异会非常小，并且可能会被编写更多代码所涉及的额外字符所掩盖，并且肯定会被开发人员花费的时间所掩盖关于它。

但是，根据经验，您的规则越具体，CSS 引擎就越能更快地找到您想要应用它的 DOM 元素，所以我希望`li>a`它比`li a`DOM 搜索更早缩短。这也意味着嵌套锚的样式不符合该规则，这是您想要的吗？<~~ 更相关的问题。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-27T13:32:13.090

`ul > li > a`仅选择直接子级。在这种情况下，只会选择里面第一层`<a>`的第一层。`<li>``<ul>`

`ul li a`另一方面将在无序列表中的`<a>`ALL -s 中选择 ALL -s`<li>`

示例`ul > li`

```
ul > li.bg {
  background: red;
}
```

```
<ul>
  <li class="bg">affected</li>
  <li class="bg">affected</li>    
  <li>
    <ol>
      <li class="bg">NOT affected</li>
      <li class="bg">NOT affected</li>
    </ol>
  </li>
</ul>
```

如果您使用`ul li`- 所有`li`-s 都会受到影响

**更新**CSS 选择器从高到低的顺序是这样的：

*   身份证，例如`#header`
*   类，例如`.promo`
*   类型，例如`div`
*   相邻的兄弟姐妹，例如`h2 + p`
*   孩子，例如`li > ul`
*   后代，例如`ul a`
*   通用，即`*`
*   属性，例如`[type="text"]`
*   伪类/元素，例如`a:hover`

所以你最好的选择是使用`children`选择器而不是`descendant`. 然而，普通页面上的差异（无需经过数万个元素）可能绝对可以忽略不计。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-27T13:45:02.117

1）例如HTML代码：

```
<ul>
    <li>
        <a href="#">firstlink</a>
        <span><a href="#">second link&lt;/a>
    </li>
</ul> 
```

和CSS规则：

```
1) ul li a {color:red;} 
2) ul > li > a {color:blue;} 
```

">" - 符号表示将只搜索子选择器（parentTag > childTag）

所以第一个 css 规则将适用于所有链接（第一个和第二个），第二个规则将仅适用于第一个链接

2) 至于效率 - 我认为第二个会更快 - 就像 JavaScript 选择器一样。该规则从右到左读取，这意味着当规则将被浏览器解析时，它会获取页面上的所有链接： - 在第一种情况下，它将查找页面上每个链接的所有父元素并过滤所有存在父标签的链接“ul " 和 "li" - 在第二种情况下，如果它是 "li" 标签，它将只检查链接的父节点 -> 检查 "li" 的父标签是否是 "ul"

像这样的东西。希望我为您正确描述所有内容

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-07-02T09:38:52.707

在这里`> a`指定根的颜色`li.active.menu-item`

#primary-menu > li.active.menu-item > a

```
#primary-menu>li.active.menu-item>a {
  color: #c19b66;
}
```

```
<ul id="primary-menu">
  <li class="active menu-item"><a>Coffee</a>
    <ul id="sub-menu">
      <li class="active menu-item"><a>aaa</a></li>
      <li class="menu-item"><a>bbb</a></li>
      <li class="menu-item"><a>ccc</a></li>
    </ul>
  </li>

  <li class="menu-item"><a>Tea</a></li>
  <li class="menu-item"><a>Coca Cola</a></li>
</ul>
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-27T13:44:28.417

回答您的第二个问题-性能受到影响-如果您将这些选择器与单个（无嵌套）ul 一起使用：

```
<ul>
    <li>jjj</li>
    <li>jjj</li>    
    <li>jjj</li>
</ul> 
```

子选择器`ul > li`比`ul li`因为它更具体而更高效。浏览器“从右到左”遍历 dom，因此当它找到 a 时，`li`它会在子选择器的情况下查找 any`ul`作为父级，而`ul`在后代选择器`

# c#-4.0 - 在 MonoTouch/MonoDroid 上，IsolatedStorage.GetFileNames 失败

> ID：11227327
> 
> 赞同：0
> 
> 时间：2012-06-27T13:27:20.050
> 
> 标签：c#-4.0, mono, xamarin.ios, xamarin.android, isolatedstorage

我正在尝试 MonoTouch/MonoAndroid，一切都很顺利，直到我调用了 IsolatedStorageFile.GetFileNames(string) 函数。参数是“Foo/Foo1/*”。结果是没有消息的 SecurityException。

目录“Foo/Foo1”存在，因为它刚刚被使用 IsolatedStorageFile.GetDirectoryNames() 调用找到。

我在引发异常的 Mono 源中发现了这一点（在 IsolatedStorageFile.cs 中）：

```
DirectoryInfo[] subdirs = directory.GetDirectories (path);
// we're looking for a single result, identical to path (no pattern here)
// we're also looking for something under the current path (not
outside isolated storage)
if ((subdirs.Length == 1) && (subdirs [0].Name == path) && (subdirs[0].FullName.IndexOf(directory.FullName) >= 0)) {
  afi = subdirs [0].GetFiles (pattern);
} else {
  // CAS, even in FullTrust, normally enforce IsolatedStorage
  throw new SecurityException ();
} 
```

我无法使用调试器进入它，所以我不知道为什么条件为假。这在 iOS 和 Android 上都会发生。很久以前在 [http://www.digipedia.pl/usenet/thread/12492/1724/#post1724](http://www.digipedia.pl/usenet/thread/12492/1724/#post1724)上记录了一个类似的问题，但没有回复。

相同的代码在 Windows Phone 7 上运行没有问题（使用 \ 作为路径分隔符）。

有没有人知道可能是什么原因造成的？目录名称中的大写字母有问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T17:41:51.827

这是 Mono 中的一个错误。隔离存储不适用于连续包含多个目录的路径（例如 Foo/Foo1/*）

我将 GetFileNames() 方法的代码从 Mono 复制到我的项目中，以便我可以调试它。我发现问题出在此条件的第二个术语中（IsolatedStorageFile.cs:846）：

```
if ((subdirs.Length == 1) && (subdirs [0].Name == path) &&(subdirs[0].FullName.IndexOf(directory.FullName) >= 0)) {
  afi = subdirs [0].GetFiles (pattern);
} else {
  // CAS, even in FullTrust, normally enforce IsolatedStorage
  throw new SecurityException ();
} 
```

例如，当传递给 GetFileNames() 的路径为“Foo/Bar/*”时，subdirs[0].Name 将为“Bar”，而路径将为“Foo/Bar”，条件将失败导致异常。

# android - 此 Android SDK 需要 Android Developer Toolkit 版本 14.0.0 或更高版本。.... 请将 ADT 更新到最新版本

> ID：11227335
> 
> 赞同：19
> 
> 时间：2012-06-27T13:28:01.843
> 
> 标签：android, sdk, adt

请帮助我解决以下错误：

```
This Android SDK requires Android Developer Toolkit version 14.0.0 or above.  
Current version is 12.0.0.v201106281929-138431\.  Please update ADT to the latest version. 
```

我在使用 Eclipse 时遇到了这个错误问题。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-06-27T13:33:51.583

此错误是由于 ADT 和 SDK 之间的不兼容而发生的。

要解决这个问题：

1.  Eclipse > 帮助
2.  安装新软件
3.  [将此](https://dl-ssl.google.com/android/eclipse/)添加到“使用”部分，然后按 Enter
4.  开发者工具出现在列表中后，勾选并点击下一步
5.  下载完成后重启eclipse

类似的问题已经在这里讨论过：[Eclipse: won't let me use Android SDK, wrongly claim my ADT is out of date](https://stackoverflow.com/questions/7852823/eclipse-wont-let-me-use-android-sdk-wrongly-claims-my-adt-is-out-of-date)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-27T13:33:36.027

原因是您更新了 android sdk 但您的 android adt 插件不是最新的。所以更新你的 Eclipse 插件可以解决这个问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-07-19T08:34:00.237

1.  在 Eclipse 中转到帮助。
2.  选择“安装新软件”菜单项。
3.  在此对话框中，单击“添加...”按钮。这将打开一个新的、较小的对话框。
4.  输入名称“ADT”和位置：“ [https://dl-ssl.google.com/android/eclipse/](https://dl-ssl.google.com/android/eclipse/) ”
5.  加载后你会得到开发者工具和 NDK 插件
6.  如果需要，请检查两者或检查开发人员工具。
7.  点击下一步
8.  接受许可，然后完成

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-03-30T10:51:08.933

如果你不想更新你的 ADT 版本，你可以这样做来解决你的问题。

修改 ${android-sdk}/tools/lib/plugin.prop **plugin.version**到你当前的版本，重启eclipse。

```
# begin plugin.prop
plugin.version=22.3.0
# end plugin.prop 
```

好好享受。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-02-27T01:22:40.707

对于那些遇到此问题的人：

Eclipse 说 ADT 需要更新 - 你点击检查更新 - 它告诉你没有更新

您需要以管理员身份运行 Eclipse。这将立即解决问题。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-27T13:32:07.997

Eclipse -> 帮助 -> 检查更新

检查“Android 开发工具”并安装更新

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-06-27T15:21:11.620

作为一般规则，Eclipse 中的 ADT 插件版本与特定的 SDK 版本配对。它没有很好的记录，但是如果您在任何时候更新一个，您需要更新另一个。工具和插件的版本号通常是同步的，但在某些情况下，它们不同步。事实上，目前（6 月 27 日）SDK 版本为 19，插件版本为 18。当然，当 Google IO 启动时，这将在今天晚些时候发生变化。目的是保持版本号同步，但并不总是这样。

您可以从 Android 工具站点获取旧版本的 ADT 和/或 SDK。在某些情况下，您必须弄清楚直接下载旧包的 URL 的秘密，但它们就在那里。

不过应该没必要。插件和 SDK 可与平台的所有早期版本一起使用，因此您应该始终安全地直接从 Android 开发者网站安装最新的 SDK 和插件。

# c - 比较 bmps 的亮度

> ID：11227340
> 
> 赞同：1
> 
> 时间：2012-06-27T13:28:17.507
> 
> 标签：c, image, image-processing

我有两个相同场景的 bmp 文件，我想确定一个是否比另一个更亮。同样，我有一组具有不同对比度的 bmp 和另一组具有不同饱和度的 bmp。如何比较这些图像的亮度、对比度和饱和度？这些测试图像由传感器制造商提供的工具保存。我正在使用 gcc 4.5。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:59:27.570

要比较两张图像的亮度，您需要比较像素的灰度值（是的，一张一张）。在 RGB 颜色空间中，亮度（灰度值）是 R、G 和 B 的平均值，所以你有`brightness = (R+G+B) / 3`
比较对比度，尤其是饱和度将证明不是那么容易，首先你可以看看[HSL 和HSV](http://en.wikipedia.org/wiki/HSL_and_HSV)，但总的来说，我建议买一本关于图像处理主题的好书。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T15:42:23.307

(R+G+B)/3 的答案实际上甚至不是一个很好的亮度近似值（至少从我们今天所知道的情况来看）！

**[BRIGHTNESS]** 你真正应该做的是将亮度转换为另一种色标，并使用包含亮度的色标通道比较亮度。看这里！！！

[确定RGB颜色亮度的公式](https://stackoverflow.com/questions/596216/formula-to-determine-brightness-of-rgb-color)

这里有很多关于将RGB转换为亮度等的答案......

**[对比]** 对比度是像素值在整个可能的像素值范围内分布的函数。可以通过将所有像素的直方图放在一起来理解对比度（其中 x 轴表示一个像素值，y 轴表示该值有多少像素），并分析直方图以了解是否存在良好的分布。整个范围，或者不是。比较对比度可以通过多种方式完成，但可能是一个很好的起点，即找到每个图像的像素值中心点（直方图数据的平均值），以及可能的一些直方图宽度参数（假设宽度约为中心点并且足够大以包含所有像素的 90%），并比较两个图像的中心和宽度参数。这只是一个起点。

**[饱和度]** 为了比较饱和度，可以将图像转换为 HSL 颜色空间。HSL 中的 S 代表饱和度。在这个色彩空间中比较饱和度就像上面概述的比较亮度一样！！！

# xaml - Windows 8 应用程序：构建这种不同大小布局的最佳方式？

> ID：11227342
> 
> 赞同：1
> 
> 时间：2012-06-27T13:28:25.633
> 
> 标签：xaml, windows-8

我查看了 windows 8 应用程序开发资源，总是有这种带有不同模板项的 fency 布局（见下文），但我找不到应该如何完成的示例。

![带有请求布局示例的图像](../Images/304538537e68bf135bd044759c9c75a3.png)

有没有人有样品，甚至知道怎么做？

**更新**

也许这个问题有点不清楚。我想知道您在所有 Windows 8 演示应用程序和上图中看到的设计是如何完成的。例如，通常有不同的标题（朋友、餐馆、愿望清单……），下面有列表。此列表有时包含 10x10 的图像，而其他图像则为 20x10（请参见图像中的 3 col）。是否有内置的简单方法来实现这一点，或者他们只是以某种方式堆叠列表和模板（使用堆栈面板等）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T14:07:10.153

我在开发中心的文档中找到了一些东西：http: [//msdn.microsoft.com/en-US/library/windows/apps/xaml/hh465351](http://msdn.microsoft.com/en-US/library/windows/apps/xaml/hh465351)

有一个名为“VariableSizedWrapGrid”的控件可以处理这种布局！ [http://msdn.microsoft.com/en-US/library/windows/apps/xaml/windows.ui.xaml.controls.variablesizedwrapgrid](http://msdn.microsoft.com/en-US/library/windows/apps/xaml/windows.ui.xaml.controls.variablesizedwrapgrid)

# jquery - 寻找比这种 IF、 ELSEIF、ELSE 方法更好的解决方案

> ID：11227343
> 
> 赞同：2
> 
> 时间：2012-06-27T13:28:26.493
> 
> 标签：jquery

这段代码有效，但我确信有一种更有效的方法可以使用我的新手级别以上的人可能会提供帮助的功能来完成这项工作。

我正在根据类型的 div 计数更改按钮标签文本字符串。如果计数为零，则隐藏按钮。如果计数等于 1，则该术语是单数的。如果计数大于一，则该术语是复数。

```
var countAll = $('li.posts').size();
var countText = $('div.text').size();
var countPhoto = $('div.photo').size();
var countQuote = $('div.quote').size();
var countLink = $('div.link').size();
var countChat = $('div.chat').size();
var countAudio = $('div.audio').size();
var countVideo = $('div.video').size();
var countAnswer = $('div.answer').size();
var countConversation = $('div.conversation').size();

$('.showAll').html("show all " + countAll + " posts ");

if (countText == 1) {
       $('.showText').html(countText + " text");
   } else if (countText > 1) {
        $('.showText').html(countText + " texts");
      } else {
        $('.showText').hide();
   };

if (countPhoto == 1) {
       $('.showPhoto').html(countPhoto + " photo");
   } else if (countPhoto > 1) {
        $('.showPhoto').html(countPhoto + " photos");
      } else {
        $('.showPhoto').hide();
   };

if (countQuote == 1) {
       $('.showQuote').html(countQuote + " quote");
   } else if (countQuote > 1) {
        $('.showQuote').html(countQuote + " quotes");
      } else {
        $('.showQuote').hide();
   };

if (countLink == 1) {
       $('.showLink').html(countLink + " link");
   } else if (countLink > 1) {
        $('.showLink').html(countLink + " links");
      } else {
        $('.showLink').hide();
   };   

if (countChat == 1) {
       $('.showChat').html(countChat + " chat");
   } else if (countChat > 1) {
        $('.showChat').html(countChat + " chats");
      } else {
        $('.showChat').hide();
   };

if (countAudio == 1) {
       $('.showAudio').html(countAudio + " audio");
   } else if (countAudio > 1) {
        $('.showAudio').html(countAudio + " audios");
      } else {
        $('.showAudio').hide();
   };

if (countVideo == 1) {
       $('.showVideo').html(countVideo + " video");
   } else if (countVideo > 1) {
        $('.showVideo').html(countVideo + " videos");
      } else {
        $('.showVideo').hide();
   };

if (countAnswer == 1) {
       $('.showAnswer').html(countAnswer + " answer");
   } else if (countAnswer > 1) {
        $('.showAnswer').html(countAnswer + " answers");
      } else {
        $('.showAnswer').hide();
   };

if (countConversation == 1) {
       $('.showConversation').html(countConversation + " conversation");
   } else if (countConversation > 1) {
        $('.showConversation').html(countConversation + " conversations");
      } else {
        $('.showConversation').hide();
   }; 
```

在此先感谢您的帮助！仍然在学习。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T13:35:25.877

在这种情况下，您可以使用一个通用的方法来接收选择器和文本：

```
var countAll = $('li.posts').size();
$('.showAll').html("show all " + countAll + " posts "); 
//Call the provided method foreach of your divs and links, one call for each, 
// instead of the relevant .size() and IF..ELSE blocks
SetVisibilityAndText('div.text', '.showText','text');
SetVisibilityAndText('div.photo', '.showPhoto', 'photo');
//etc for your other selectors / divs

function SetVisiblityAndText(countSelector, linkSelector, text){
 var count = $(countSelector).size();
  if (count == 1) {        
     $(linkSelector).html(count + " " +text);    
  } 
  else if (count > 1) {         
     $(linkSelector).html(count + " "+ text+ "s");       
  }  
  else 
  {         
      $(linkSelector).hide();    
  }; 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T13:39:54.557

你可以这样做：

html:

```
<label class='show' id='photo'>
<div class='photo'></div>.. etc 
```

js：

```
$('label.show').each(function(){
   var id = $(this).attr('id');
   var count = $('div.'+id).count();
   var mul = (count > 1) ? 's' : '';
   $(this).html(count+' '+id+mul);
}); 
```

我敢肯定这看起来会更好......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-27T13:55:37.467

有两种关键方法可以改进此代码：

1.  使用函数或`for`循环删除重复代码。
2.  使用三元删除`else if`

# 函数/For循环

您多次重复代码结构。最好的方法是编写一次代码，并使其执行多次。我将同时使用函数和 for 循环。你的基本结构总是一样的——取一个 div 标签，获取大小，然后编辑一个 class 标签`.show<name>`。

# 三元

三元构造基于`if-else-return`并适合 1 行。它将根据布尔测试为您提供两个值之一。例如：

```
if (number>1) return "votes" else return "vote"` 
```

其语法是`((test) ? "value-if-true" : "value-if-false")`.

# 您的最终产品：

```
$('.showAll').html("show all " + $('li.posts').size() + " posts ");

var counts = ["text", "photo", "quote", "link", "chat", "audio", "video", "answer", "conversation"];

function showcount(name) {
    var divcount = $("div."+name).size()
    var classname = ".show" + name.charAt(0).toUpperCase() + name.slice(1);
    if (divcount >= 1) {
        $(classname).html(divcount + " " + name + ((divcount==1) ? "" : "s"));
    }
    else {
        $(classname).hide();
    }
}

for (var i=0; i<counts.length; i++) {
    showcount(counts[i]);
} 
```

我没有测试过这个；请让我知道它是否有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T13:38:19.507

您可以将所有逻辑集中在一个函数中：

```
function check( count, el ){
var $el = $(el);
if (count == 1) {
       $( el ).html(count + " text");
    } else if (count > 1) {
        $el.html(count + " texts");
    } else {
        $el.hide();
    } 
} 
```

然后使用它：

```
check( countText, '.showText' );
check( countPhoto, '.showPhoto' );
//.... 
```

# php - PHP包含一个文件2目录

> ID：11227347
> 
> 赞同：3
> 
> 时间：2012-06-27T13:28:30.580
> 
> 标签：php, path, include, require

这是我的情况。我有一个**config.php**文件，我想在我的所有文件夹之间共享。它位于我的**根目录中：includes/config.php**。

我在我的*管理*文件夹中，并试图包含该配置文件。

```
// Does not work
require_once "../../includes/config.php";

// This will kind-of-work.. see below
require_once $_SERVER['DOCUMENT_ROOT'] . "/includes/config.php"; 
```

第二行的问题是我有 3 个不同的环境。本地主机、开发和生产。

我在 config.php 中定义了这些环境和所有设置。如果我正在生产，那么第二条线将完美运行。但是在我的开发和本地主机环境中..文件不在根目录中，它们在子文件夹中..所以唯一可行的方法是：

```
require_once $_SERVER['DOCUMENT_ROOT'] . "/sub_folder/includes/config.php"; 
```

好吧，根据环境，我的 config.php 文件中有一个 PATH 常量，但我无法访问它，因为我试图包含该文件！

所以我不确定解决这个问题的最佳方法。我希望这是有道理的。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T13:40:34.593

如果您将配置文件设置为 .ini 文件而不是 php。你有一个函数叫做

```
parse_ini_file($filePath); 
```

在 ini 文件中，您可以定义“生产”、“开发”、“暂存”环境。

这是实现可扩展性的更好方法。

这个 wiki 页面更好地解释了 ini 文件语法

[http://en.wikipedia.org/wiki/INI_file](http://en.wikipedia.org/wiki/INI_file)

如果您想使用 php 文件，请在 config.php 中定义您的环境，并在所有常量上包装 if 条件。

对于，您可以使用的目录结构

```
realpath(dirname(__FILE__)) 
```

这比

```
$_SERVER['DOCUMENT_ROOT'] 
```

希望这可以帮助..

卡尔提克

# pdo - MODx 查询自定义数据库表

> ID：11227348
> 
> 赞同：0
> 
> 时间：2012-06-27T13:28:31.360
> 
> 标签：pdo, modx

请参阅下面的代码。我正在尝试从数据库中获取一些数据是 modx。数据就在那里，这意味着，当我在 phpmyadmin 中查询数据库时，我得到了结果。我无法弄清楚为什么它在 modx 中不起作用。

```
$sql =  'SELECT * FROM orders ORDER BY created DESC LIMIT 1';

$stmt = $modx->prepare($sql);
$stmt->execute(); 

// Put data in array
$order_data = $stmt->fetch(PDO::FETCH_ASSOC);
if ($order_data == '') {
    return 'Resultset empty for user '. $user_id.'.<br />'.$sql;
} else {
    return 'Data found!';
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-21T17:44:13.140

您需要遍历输出，结果将是一个数组数组。

下面的示例将返回数据并按照块格式呈现

```
<?php
$sql = "SELECT * FROM `table_name`";
$query = $modx->query($sql);
$rows = array();
if ($query) {
    // loop through the result set and inspect one row at a time
    while ($row = $query->fetch(PDO::FETCH_ASSOC)) {
        array_push($rows, $row);
        $output .= $modx->getChunk($tpl,$row);
    }
}
$output = "<table border=\"1\" cellpadding=\"5\" >
<th>ID</th><th>row1_Head</th><th>row2_Head</th><th>row3_Head</th><th>row4_Head</th><th>row5_Head</th>
$output</table>";
return $output; 
```

* * *

这是块的一个例子：

```
<tr>
<td>[[+id]]</td> <td>[[+row1]]</td> <td>[[+row2]]</td> <td>[[+row3]]</td> <td>[[+row4]]</td> <td>[[+row5]]</td> 
</tr> 
```

现在在资源中调用您的代码段，例如

```
[[!Snippet_name? &tpl=`chunk_name`]] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T23:34:13.147

也许尝试使用 xPDO：

```
$sql = 'SELECT * FROM orders ORDER BY created DESC LIMIT 1';

$c = new xPDOCriteria($modx,$sql);
if ($c->stmt && $c->stmt->execute()) {
    $order_data = $c->stmt->fetch(PDO::FETCH_ASSOC);
    var_dump($order_data);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-27T10:58:44.017

```
$sql =  'SELECT * FROM orders ORDER BY created DESC LIMIT 1'; 
```

假设您的架构就像

```
<?xml version="1.0" encoding="UTF-8"?>
<model package="your_package_name" baseClass="xPDOObject" platform="mysql" defaultEngine="MyISAM" version="1.1">
    <object class="Orders" table="orders" extends="xPDOSimpleObject">
        <field key="order_no" dbtype="varchar" precision="255" phptype="string" null="false" />
        <!-- and everything else below  -->

    </object>

    <!-- and everything else below  -->
</model> 
```

你需要做的就这么简单：

```
$modx->addPackage('your_package_name'); // Add your table schema to MODX object

$orders = $modx->getCollection('Orders'); // class's name, not table's name
$output = '';
if ($orders){
    $outputArray = array();
    foreach ($orders as $order) {
        $orderArray = $order->toArray();
        $outputArray[] = $modx->getChunk('your_row_chunk_name', $orderArray);
    }
    $wrapper = array(
        'orders' => @implode("\n", $outputArray);
    );
    $output = $modx->getChunk('your_wrapper_chunk_name', $wrapper);
}

return $output; 
```

# python - python gnupg 签名，并验证

> ID：11227349
> 
> 赞同：2
> 
> 时间：2012-06-27T13:28:41.533
> 
> 标签：python, gnupg

我正在尝试查看是否可以让 python-gnupg 模块使用 python 脚本来签名和验证文件。我有以下代码，调用时不会解释任何错误。

然而，当我认为我已经签署了文件（`example.txt`）时，代码最后会打印“未验证”。

我一定在文档中遗漏了一些东西，但是在我阅读它之后，这就是我想出的用于签名和验证的内容。请问有什么帮助吗？

```
import gnupg

gpg = gnupg.GPG(gnupghome="/home/myname") 

stream = open("example.txt", "rb")

signed_data = gpg.sign_file(stream)

verified = gpg.verify_file(stream)

print "Verified" if verified else "Unverified" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T02:46:37.100

你的代码有一些问题，

1.)`gpg = gnupg.GPG(gnupghome="/home/myname")`需要`gpg = gnupg.GPG(gnupghome="/home/myname/.gnupg")`

2.) 您正在尝试使用 验证流`verify_file(stream)`，但是流仍然是原始未签名文件的句柄。您首先需要将签名数据写入新文件并调用`verify_file()`该文件的句柄，或者验证结果`sign_file`。

下面是演示的工作示例，使用 sign_file 的结果 - 但在我们开始之前，解决脚本中发生的问题的方法，您可以查看 stderr 在 gnupg 方法的返回对象上的输出。例如，您可以通过打印输出来查看签名数据的结果`signed_data.stderr`。同样对于`verify_file`方法的返回。

上代码 -

```
import gnupg

gpg = gnupg.GPG(gnupghome="/home/myname/.gnupg")

stream = open("example.txt", "rb")

signed_data = gpg.sign_file(stream)

verified = gpg.verify(signed_data.data)

print "Verified" if verified else "Unverified" 
```

我希望这有帮助！

# android - 像路径一样绘制 .png 图像

> ID：11227352
> 
> 赞同：0
> 
> 时间：2012-06-27T13:29:06.650
> 
> 标签：android, graphics, draw, paint, imagebrush

所以我有一个 PNG 文件，我在我的应用程序中用作自定义画笔。随着动作事件的发生，我不断重绘它以提供画笔效果。但是如果我拖得太快，我会错过像素，并且一些画笔看起来很糟糕——就像图像只是相互绘制一样。

有什么办法可以在`drawpath`模式下绘制它吗？

下面的代码是我的`onDraw`方法。该`mbitmapBrush`变量具有 PNG 图像文件，`pos.a`并且`pos.b`是当前运动事件的“x”和“y”坐标。

```
 @Override
    protected void onDraw(Canvas canvas) {
        Paint paint=mPaint;
        canvas.drawColor(0xFFAAAAAA);
mCM.set(new float[]{1f, 1f, 1f, 0f, 1f,
    0f, 1f, 3f, 0f, 4f,
    1f, 4f, 1f, 1f, 0f,
    1f, 0f, 0f, 1f, 0f });
ColorMatrixColorFilter cm3=new ColorMatrixColorFilter(mCM);

paint.setColorFilter(cm3);

        canvas.drawBitmap(mBitmap, 0, 0, mBitmapPaint);
        for (Vector2 pos : mPositions) {

            canvas.drawBitmap(mBitmapBrush, pos.a, pos.b, paint);
            //canvas.drawCircle(pos.a, pos.b, 7, mPaint);
        }

        //canvas.drawBitmap(mBitmapBrush, clickX, clickY, null);
        //canvas.drawPath(mPath, mPaint);

    invalidate();
    } 
```

# android - Android：当繁重的后台任务运行时，OpenGL 渲染暂停

> ID：11227353
> 
> 赞同：7
> 
> 时间：2012-06-27T13:29:08.810
> 
> 标签：android, opengl-es, frame-rate

我正在通过 OpenGL 渲染对象，并且在大多数情况下都获得了 60fps 的平滑帧速率。直到我在后台线程中做一些繁重的事情，比如从 REST API 中获取东西，处理它，然后将对象添加到图中（低优先级的东西，我更关心 UI 流动性）。然后渲染器将暂停很长一段时间，最多 1 秒（大约只要后台线程运行），然后像什么都没发生一样恢复。我注意到这一点是因为动画同时开始，并且在此期间卡住了。后台线程设置为最低优先级，垃圾收集确实需要 100-200 毫秒，但不是整个秒。当我在后台任务中的任何位置设置调试点时，渲染继续正常，没有任何延迟。

我繁重的后台线程是否有可能使 OpenGL 线程饿死？如果是这样，我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T20:15:54.803

当然！需要为 GPU 提供数据，而这是由 CPU 完成的。因此，如果系统出现瓶颈，例如 I/O 或 CPU 处理，那么 GPU 将无法获得支持。例如，动画传统上是在 CPU 上完成的。这就是为什么您可以在 PC 上使用相同的图形芯片但使用不同的 CPU 获得更高帧速率的许多游戏。

我也同意分​​析是一个非常好的主意。如果可以的话，我建议进行分析以确保它实际上是 REST 调用，或者 REST 调用是否是许多事情之一

我注意到关于 REST 处理的一件事，这发生在我身上。由于 REST 有时会处理大量字符串，并且如果您不使用 StringBuilder，最终可能会触发大量垃圾收集。但是，听起来您并没有得到这个。

# sharpsvn - 使用 SharpSvn 提交包含修改过的文件的整个文件夹。

> ID：11227358
> 
> 赞同：2
> 
> 时间：2012-06-27T13:29:21.920
> 
> 标签：sharpsvn

我在我的 C# 项目中使用 SharpSvn。我有一个包含一些文本文件的文件夹和另一个包含子文件夹的文件夹。我在版本控制下添加文件夹并提交它。到现在为止还挺好。这是我的代码：

```
using (SvnClient client = new SvnClient())
                    {

                        SvnCommitArgs ca = new SvnCommitArgs();

                        SvnStatusArgs sa = new SvnStatusArgs();
                        sa.Depth = SvnDepth.Empty; 

                        Collection<SvnStatusEventArgs> statuses;

                        client.GetStatus(pathsConfigurator.FranchisePath, sa, out statuses);
                        if (statuses.Count == 1)
                        {
                            if (!statuses[0].Versioned)
                            {
                                client.Add(pathsConfigurator.FranchisePath);
                                ca.LogMessage = "Added";
                                client.Commit(pathsConfigurator.FranchisePath, ca);
                            }
                            else if (statuses[0].Modified)
                            {
                                ca.LogMessage = "Modified";
                                client.Commit(pathsConfigurator.FranchisePath, ca);
                            }

                        }
                    } 
```

我对其中一个文本文件进行了一些更改，然后再次运行代码。修改未提交。这个条件是假的：

```
if (statuses.Count == 1) 
```

并且 if 块中的所有逻辑都不会执行。

我没有写这个逻辑，也不能完全得到这行代码：

```
client.GetStatus(pathsConfigurator.FranchisePath, sa, out statuses);
                        if (statuses.Count == 1) {} 
```

我去了 API 的官方网站，但找不到有关此的文档。

1.  更熟悉这个 API 的人可以告诉这两行是做什么的吗？

2.  需要对此代码进行哪些更改，因此如果文件夹的某些内容`pathsConfigurator.FranchisePath`发生更改，则整个文件夹都将提交更改。任何有关工作示例的建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T16:44:51.883

提交一个包含所有内容的目录非常简单：只需在该目录上调用 commit 即可。

默认的提交深度是`SvnDepth.Infinity`这样可以直接工作的。您可以通过提供一个`SvnCommitArgs`对象来设置其他选项`SvnClient.Commit()`

# php - 脚本的 PHP Windows 环境变量

> ID：11227361
> 
> 赞同：0
> 
> 时间：2012-06-27T13:29:28.333
> 
> 标签：php, windows

在**Windows**中是否可以像在 linux 中那样进行**符号链接？**

如果将文件放入`/usr/bin`名为 sample 的文件中，我可以通过以下方式访问它：

```
$ sample 
```

在 Windows 中，我的环境变量中有 PHP，所以我可以运行：

```
$ php filename.php 
```

**这行不通。有点我想要它**。我尝试将我的脚本放在 Windows 环境变量中并通过 php 运行它，例如：

```
$ php sample 
```

但它只在我这样做时才有效

```
$ php c:/path/sample

or

$ cd c:/path/sample
$ php sample 
```

有人知道吗？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:33:34.917

因为 /usr/bin 在 PATH 中，而 C:/path 似乎不在。或者我不明白这个问题？

# java - 骡子定制变压器

> ID：11227364
> 
> 赞同：0
> 
> 时间：2012-06-27T13:29:42.480
> 
> 标签：java, mule, transformer

我在找出如何在 Mule 3.2 中创建可以输入和输出文件的自定义转换器时遇到了一些麻烦。我已经对转换代码进行了原型设计，效果很好，但我找不到任何关于如何在转换器中获取文件的文档。

这是我目前所拥有的，但即使这样也会引发错误：

```
@ContainsTransformerMethods
  public class xmlToJson {

  @Transformer
  public File xmlIn(File file) {
    // logic to go here
    return file;
  }
} 
```

这是引发的异常：

```
ERROR 2012-06-27 14:08:37,664 [main] org.mule.tooling.server.application.
ApplicationDeployer: null
java.lang.IllegalStateException: Cannot convert value of type [convert.xmlToJson]
to required type [org.mule.api.processor.MessageProcessor] for property 'messageProcessors[0]': no matching editors or conversion strategy found 
```

我似乎找不到任何文档或教程来说明如何构建自定义转换器以接收文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:00:25.307

带注释的变压器通常用于自动转换，如下所述：

[http://www.mulesoft.org/documentation/display/MULE3USER/Creating+Custom+Transformers](http://www.mulesoft.org/documentation/display/MULE3USER/Creating+Custom+Transformers)

可能更适合您的用例的是通过扩展 AbstractTransformer 创建自定义转换，如下所述：

[http://www.mulesoft.org/documentation/display/MULE3USER/Creating+Custom+Transformer+Class](http://www.mulesoft.org/documentation/display/MULE3USER/Creating+Custom+Transformer+Class)

您可以在以下链接中找到有关如何使用这两种方法的好教程

[http://www.mulesoft.org/documentation/display/MULE3EXAMPLES/Invoking+Component+Methods](http://www.mulesoft.org/documentation/display/MULE3EXAMPLES/Invoking+Component+Methods)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-04-07T08:44:59.600

为了创建具有自定义逻辑的自定义转换器，您需要创建扩展 AbstractMessageTransformer 的自定义类，然后您应该覆盖此抽象类中的 transformMessage()。之后，只有您可以在任何转换器标签中提供您的自定义类。带注释的转换器将在 Mule 中注册，如果 Mule 需要从 sourceType 转换为 returnType，它们将被自动调用。

```
@ContainsTransformerMethods
public class MyCustomTransformers
{
 @Transformer
  public URL stringToURL(String string) throws MalformedURLException
   {
     return new java.net.URL(string);
   }
} 
```

这里 sourceType 是 String，returnType 是 URL。因此，每当 Mule 本身需要从 String 转换为 URL 时，都会使用这个转换器。

这是在 Mule 中创建自定义转换器的一个很好的链接

[http://javacodinggeeks.blogspot.in/2015/05/writing-custom-transformers-in-mule.html](http://javacodinggeeks.blogspot.in/2015/05/writing-custom-transformers-in-mule.html)

# php - 如何使用 CodeIgniter 加载另一个数据库？

> ID：11227366
> 
> 赞同：5
> 
> 时间：2012-06-27T13:29:50.143
> 
> 标签：php, codeigniter

我有一个 CodeIgniter 和一些 Mysql 数据库。但是知道我想设置另一个数据库来工作，并且在一些操作之后禁用它。例如，我有函数 make_some_actions_with_db()，现在我需要这样的东西：

```
public function action()
{
//load db
make_some_actions_with_db();
//disable db
} 
```

所以，现在我需要知道如何设置新的默认数据库以及如何设置另一个（第一个）数据库。谢谢你。

**更新：** 它不起作用：

```
 public function update_record_insert_test()
    {
        if ($this->facebook->getUser())
        {
            $another_db_settings['hostname'] = 'localhost';
            $another_db_settings['username'] = 'root';
            $another_db_settings['password'] = '';
            $another_db_settings['database'] = 'name';
            $another_db_settings['dbdriver'] = "mysql";
            $another_db_settings['dbprefix'] = "";
            $another_db_settings['pconnect'] = TRUE;
            $another_db_settings['db_debug'] = TRUE;
            $another_db_settings['cache_on'] = FALSE;
            $another_db_settings['cachedir'] = "";
            $another_db_settings['char_set'] = "utf8";
            $another_db_settings['dbcollat'] = "utf8_general_ci";
            $this->load->database($another_db_settings);

            $_POST['id']='AccountPagesView.a_book/1000';
            $_POST['value']='test';
            $_POST['old_value']='not';
            $welcome=new Welcome();
            $welcome->update_record();
        }
        else
        {
            $url=$this->facebook->getLoginUrl(array('next' => base_url().'update_record_insert_test'));
            redirect($url);
        }
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-27T13:49:27.413

在您`config/database.php`的数据库中配置为“默认”组，如下所示：

```
$db['default']['hostname'] = 'host';
$db['default']['username'] = 'username';
$db['default']['password'] = 'password';
$db['default']['database'] = 'database'; 
```

这允许您像这样指定其他组：

```
$db['second']['hostname'] = 'host';
$db['second']['username'] = 'username';
$db['second']['password'] = 'password';
$db['second']['database'] = 'database';

$db['third']['hostname'] = 'host';
$db['third']['username'] = 'username';
$db['third']['password'] = 'password';
$db['third']['database'] = 'database'; 
```

然后，您可以使用以下方法连接到另一个数据库：

```
$defaultDB = $this->load->database('default', TRUE);
$secondDB = $this->load->database('second', TRUE); 
```

通过`true`作为第二个值传递，它将返回数据库对象，允许您对每个数据库安全地使用相同的方法，如下所示：

```
$default->get('table');
$second->get('different_table'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:52:34.013

如果您想更改默认数据库连接（我不推荐），您可以执行以下操作：

```
$another_db_settings['hostname'] = '';
$another_db_settings['username'] = '';
$another_db_settings['password'] = '';
$another_db_settings['database'] = '';
$another_db_settings['dbdriver'] = "mysql";
$another_db_settings['dbprefix'] = "";
$another_db_settings['pconnect'] = TRUE;
$another_db_settings['db_debug'] = TRUE;
$another_db_settings['cache_on'] = FALSE;
$another_db_settings['cachedir'] = "";
$another_db_settings['char_set'] = "utf8";
$another_db_settings['dbcollat'] = "utf8_general_ci";
$this->load->database($another_db_settings); 
```

然后可以通过 $this->db 访问新数据库，但我建议按照 cchana 的建议进行操作，并将新连接分配给另一个变量

```
$new_db = $this->load->database($another_db_settings, TRUE); 
```

# php - Facebook PHP SDK 应用程序将照片上传到页面

> ID：11227369
> 
> 赞同：3
> 
> 时间：2012-06-27T13:29:57.087
> 
> 标签：php, facebook, photo-upload

我正在尝试创建一个将图像上传到页面的 Facebook 应用程序。我可以设法将照片上传到用户的相册，但不能上传到页面。

这是我的代码：

```
require_once('php-sdk/facebook.php');

 $config = array(
  'appId' => 'XXXXXXXX',
  'secret' => 'YYYYYYYYYYYYYYYY',
  'fileUpload' => true,
 );

$facebook = new Facebook($config);
$user_id = $facebook->getUser();    

$photo = $_POST['image'];
$message = "Lorem ipsum";

echo $user_id;

  if ($user_id) {
       $ret_obj = $facebook->api('/XXXXXXXXXX/photos', 'POST', array(
        'access_token'  => $access_token,
                    'source' => '@' . $photo,
                    'message' => $message
                                    )
                                  );

} catch(FacebookApiException $e) {

    $login_url = $facebook->getLoginUrl( array(
                   'scope' => 'user_photos,publish_stream,photo_upload'
                   )); 
         echo 'Please <a href="' . $login_url . '">login.</a>';
    print_r($e);
            error_log($e->getType());
            error_log($e->getMessage());
  }   
  echo '<br /><a href="' . $facebook->getLogoutUrl() . '">logout</a>';
 } else {

  $login_url = $facebook->getLoginUrl( array( 'scope' =>user_photos,publish_stream,photo_upload,manage_pages' ) );
     echo 'Please <a href="' . $login_url . '">login.</a>';

} 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T11:04:12.407

当你这样做时：

```
$facebook->api('/XXXXXXXXXX/photos', 'POST', array( 
```

... XXXXXXXXXX 是您的 appId 还是 albumId？您必须调用您的**相册 ID**。

还要确保您使用的是正确的 $access_token。确保查看：

> [https://graph.facebook.com/yourPageID?fields=access_token&access_token=YourPersonalAccessToken](https://graph.facebook.com/yourPageID?fields=access_token&access_token=YourPersonalAccessToken)

你的PersonalAccessToken 是：

> 此页面的页面管理员`access_token`；当前用户必须是该页面的管理员；仅在通过`fields`URL 参数特别请求时返回。

您必须授予图形 api`manage_pages`权限。

# plugins - SocialEngine 4 登录双进程

> ID：11227371
> 
> 赞同：0
> 
> 时间：2012-06-27T13:30:00.020
> 
> 标签：plugins, module, signing, socialengine

我正在尝试创建 2 种类型的登录程序，因为我将拥有 2 种不同类型的用户。有什么模块或插件可以解决这个问题吗？或者我必须创建自己的模块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T17:37:36.680

您可以在“个人资料问题”页面的管理面板中为不同的个人资料类型创建不同的个人资料问题。这将允许您的用户选择个人资料类型，例如粉丝或乐队，然后根据所选类型出现一组不同的问题。有关个人资料问题页面的更多信息，请参阅：http: [//support.socialengine.com/questions/156/Admin-Panel-Settings-Profile-Questions](http://support.socialengine.com/questions/156/Admin-Panel-Settings-Profile-Questions)

# actionscript-3 - 鼠标悬停时如何在AS3中的蒙版和背景图像之间创建一个循环

> ID：11227384
> 
> 赞同：0
> 
> 时间：2012-06-27T13:30:26.530
> 
> 标签：actionscript-3

我是 AS3 的新手，对于我的一项任务，我需要修改现有代码（复制粘贴和修改）以产生一定的效果。我需要创建的效果是当我在舞台上鼠标悬停时，当我在舞台上鼠标移出时，蒙版将与背景图像形成一个循环并恢复正常（蒙版层不可见）。这是需要修改的代码。

```
 var mymask:Sprite=new Sprite();
    var isOver:Boolean=false;
    var spotSize:Number=0;

    pic2.addChild(mymask);
    pic2.mask=mymask;
    pic2.mouseEnabled=false;

    mymask.x=0;
    mymask.y=0;

    function drawSpot(r:Number):void{
        mymask.graphics.clear();
        mymask.graphics.lineStyle(1,0x000000);
        mymask.graphics.beginFill (0x00000F);
        mymask.graphics.drawRect(0,0,r,900);
        mymask.graphics.endFill();

        spotSize=r;
    }

    pic1.addEventListener(MouseEvent.ROLL_OVER, mouseOver);

    function mouseOver(e:MouseEvent):void{

        isOver=true;
    }

    pic1.addEventListener(MouseEvent.ROLL_OUT, mouseOut)

    function mouseOut(e:MouseEvent):void{
        isOver=false;
    }

    stage.addEventListener(Event.ENTER_FRAME, enter);

    function enter(e:Event):void{
        var cursorSize:Number=spotSize;
        if(isOver==true && cursorSize<1)
        drawSpot(cursorSize+999);
        if(isOver==false && cursorSize>10)
        drawSpot(cursorSize-999);

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T20:46:29.793

听起来您正试图通过修改上面的代码来为圆形蒙版设置动画？如果是这样，这就是所需的代码更改。

在您的 drawSpot 方法中，将行：更改 `mymask.graphics.drawRect(0,0,r,900);` 为： `mymask.graphics.drawCircle(pic2.width * .5, pic2.height * .5, r);`

然后在你的输入方法中，

```
function enter(e:Event):void{
    var cursorSize:Number=spotSize;
    if(isOver==true && cursorSize<999)
    drawSpot(cursorSize+1);
    if(isOver==false && cursorSize>0)
    drawSpot(cursorSize-1);

} 
```

你正在做的是说如果鼠标已经结束并且 cursorSize 小于完整值（你之前有 999，所以我保留它）然后将大小增加 1。它将继续每帧执行此操作，直到大小为 999或更高（或鼠标不再结束）。

如果鼠标未悬停且遮罩的大小不为 0，则它将每帧减小 1 的大小，直到为 0 或更小。

如果你想让它跑得更快，只需将 +1 和 -1 更改为更大的数字

# python - 单个选项卡中的多个框架 ttk.Notebook

> ID：11227388
> 
> 赞同：1
> 
> 时间：2012-06-27T13:30:38.800
> 
> 标签：python, user-interface, tkinter, ttk

我有以下代码部分（不完整），我想在 ttk 'Notebook' 的单个选项卡中包含几个框架。

```
win1 = Tk()    
n = ttk.Notebook(win1)

choice_frame = ttk.Frame(n, style="Black.TLabel")
choice_frame.grid(row=2, column=1, sticky="N,S,E,W", padx=1, pady=1)
choice_frame.grid_columnconfigure(0, weight=3)
choice_frame.grid_rowconfigure(0, weight=1)

frame_text = ttk.Frame(n, style="Black.TLabel")
frame_text.grid(row=0, column=0, sticky = "N")
frame_text.grid_columnconfigure(0, weight=3)
frame_text.grid_rowconfigure(0, weight=1)

frame_table = ttk.Frame(n, style="Black.TLabel")
frame_table.grid(row=2, column=0, padx=1, pady=1, sticky= " N, S, E, W ")
frame_table.grid_columnconfigure(0, weight=3)
frame_table.grid_rowconfigure(0, weight=1)

n.add(frame_table, text="One") # Would like same tab not two separate ones
n.add(choice_frame, text="One")
n.grid(sticky="N") 
```

我还想知道是否有一种方法可以在窗口被拖出并最大化时自动调整每个尺寸。我之前尝试过：

```
frame_table.grid_propagate(0) 
```

但这似乎不允许高度和宽度尺寸保持不变。我希望我的“桌子”位于窗口的中心，但可以根据窗口大小进行调整。

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T18:04:36.553

`grid_propagate`不能解决您的任何问题。

每个选项卡只能包含一个框架，但该单个框架可以包含您想要的任何内容。因此，为选项卡创建一个容器框架，然后将所有其他框架放入容器框架中。这是该类存在的主要原因之一`Frame`——构建便于布局的小部件容器。

至于调整大小，问题可能是您没有为主窗口的行和列添加权重。尽管这也可能与您`grid`用于将框架放置在笔记本中的事实有关；你不能用来`grid`在笔记本中放置项目。

# c# - 使用表达式树传递值不起作用

> ID：11227389
> 
> 赞同：0
> 
> 时间：2012-06-27T13:30:38.847
> 
> 标签：c#, reflection, expression-trees

我正在研究一个函数，它接受一个委托类型和一个类型的委托，`Action<Object[]>`并创建一个给定类型的动态函数，如果调用，它将所有参数传递给给定的操作句柄：

```
 public static T GetEventDelegate<T>(Action<Object[]> handler) where T : class
    {
        if (!typeof(T).IsSubclassOf(typeof(Delegate)))
            throw new Exception("T must be a delegate type");

        Type[] argTypes = typeof(T).GetMethod("Invoke").GetParameters().Select((para) => para.ParameterType).ToArray();

        List<ParameterExpression> lstArgs = new List<ParameterExpression>(
            argTypes.Select((arg)=>Expression.Parameter(arg))    
        );

        ParameterExpression result = Expression.Variable(typeof(Object[]));

        var assignExpression = Expression.NewArrayInit(typeof(Object),lstArgs.ToArray());

        var callExpression = Expression.Call(handler.Method, result);

        var block = Expression.Block(
            new List<ParameterExpression>(){result},
            new Expression[]{assignExpression,callExpression}
        );

        var del = Expression.Lambda(block, lstArgs.ToArray()).Compile();

        return Delegate.CreateDelegate(typeof(T), del, "Invoke") as T;
    }

    private static void testDel()
    {
        var del = GetEventDelegate<EventHandler>(
            (x) =>
            {
                //Error, because x == null
                Debug.Print(x.ToString());
            }
       );
        del("testString", new EventArgs());
    } 
```

不幸的是，动作处理程序只传递了一个*空*`testDel()`值（请参阅 参考资料）。

你能帮我找出错误吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:46:02.007

您的问题是因为您将结果 ParameterExpression 初始化为 Object 类型，但从未实际为其分配值。这几乎编译成（在调用编译之后）是：

```
void Func(arguments..)
{
   Object result;
   new object[](arguments...);
   method(result);
} 
```

您从未使用分配表达式将数组实际分配给结果。

与您的问题无关，您可以在创建 lambda 时使用 Expression.Lambda() 因为您具有泛型的类型。

# javascript - 高级选项卡 - 选项卡内的选项卡 - JQuery

> ID：11227392
> 
> 赞同：1
> 
> 时间：2012-06-27T13:30:50.703
> 
> 标签：javascript, tabs

我在现有选项卡中创建选项卡时遇到问题。我现在拥有的标签可以在[http://jakobmillerwt.com/scripts.html](http://jakobmillerwt.com/scripts.html)找到。它现在所做的是我可以在 All-Knight-Paladin-Mage 之间切换并在下面打开替代方案。我想要做的是为导航中的每个链接创建一个选项卡。

例如。我按下 Knight，然后打开链接 Killer Caiman、Blue Djnn 和 Quara。当我按下其中任何一个时，我希望标签像主标签一样滑到一边，它会在里面的内容上显示一个 div。

```
<ul class="nav">
            <li class="nav-one"><a href="#featured" class="current">All</a></li>
            <li class="nav-two"><a href="#core">Knight</a></li>
            <li class="nav-three"><a href="#jquerytuts">Paladin</a></li>
            <li class="nav-four last"><a href="#classics">Mage</a></li>
</ul>

<div class="list-wrap">

    <ul id="featured">
        <li><a href="http://forums.xenobot.net/showthread.php?3297-Jakob-Miller-Free-Scripting-Service&p=48933#post48933">[30+] Terramite - Farmine </a></li>
        <li><a href="http://forums.xenobot.net/showthread.php?3297-Jakob-Miller-Free-Scripting-Service&p=45763#post45763">[30+] Chakoya - Svargrond</a></li>
    </ul>

     <ul id="core" class="hide">
        <li><a href="http://forums.xenobot.net/showthread.php?3297-Jakob-Miller-Free-Scripting-Service&p=47002&viewfull=1#post47002">[100+] Killer Caiman - Farmine</a></li>
        <li><a href="http://forums.xenobot.net/showthread.php?3297-Jakob-Miller-Free-Scripting-Service&p=50059&viewfull=1#post50059">[100+] Blue Djinn - Yalahar</a></li>
        <li><a href="http://forums.xenobot.net/showthread.php?3297-Jakob-Miller-Free-Scripting-Service&p=50102#post50102">[140+] Quara - Hydra Island</a></li>

     </ul>

     <ul id="jquerytuts" class="hide">
        <li>Stuff in here!</li>
     </ul>

     <ul id="classics" class="hide">
        <li>Stuff in here!</li>
     </ul>

</div> <!-- END List Wrap --> 
```

这是我现在拥有的 HTML 代码。

```
#example-one { 
background: #E1E1E1; 
padding: 10px; 
margin: 0 0 15px 0; 
-moz-box-shadow: 0 0 5px #666; 
-webkit-box-shadow: 0 0 5px #666; 
width:420px; 
border-radius:6px;
margin-left:auto;
margin-right:auto;
border:1px solid #CCC;
}

#example-one .nav { overflow: hidden; margin: 0 0 10px 0;}
#example-one .nav li { width: 97px; float: left; margin: 0 10px 0 0; }
#example-one .nav li.last { margin-right: 0; }
#example-one .nav li a { display: block; padding: 5px; background: #959290; color: white; font-size: 14px; text-align: center; border: 0; border-radius:3px; font-family:Arial, Helvetica, sans-serif;}
#example-one .nav li a:hover { background-color: #111; }

#example-one ul { list-style: none; text-decoration:none;}
#example-one ul li a { display: block; border-bottom: 1px solid #666; padding: 4px; color: #666; text-decoration:none;}
#example-one ul li a:hover, #example-one ul li a:focus { background: #999; color: white; border-radius: 3px; }
#example-one ul li:last-child a { border: none; }

#example-one li.nav-one a.current, ul.All li a:hover { background-color: #03F; color: white; }
#example-one li.nav-two a.current, ul.Knight li a:hover { background-color: #03F; color: white; }
#example-one li.nav-three a.current, ul.Paladin li a:hover { background-color: #03F; color: white; }
#example-one li.nav-four a.current, ul.Mage li a:hover { background-color: #03F; color: white; } 
```

的CSS。

```
(function($) {

    $.organicTabs = function(el, options) {

        var base = this;
        base.$el = $(el);
        base.$nav = base.$el.find(".nav");

        base.init = function() {

            base.options = $.extend({},$.organicTabs.defaultOptions, options);

            // Accessible hiding fix
            $(".hide").css({
                "position": "relative",
                "top": 0,
                "left": 0,
                "display": "none"
            }); 

            base.$nav.delegate("li > a", "click", function() {

                // Figure out current list via CSS class
                var curList = base.$el.find("a.current").attr("href").substring(1),

                // List moving to
                    $newList = $(this),

                // Figure out ID of new list
                    listID = $newList.attr("href").substring(1),

                // Set outer wrapper height to (static) height of current inner list
                    $allListWrap = base.$el.find(".list-wrap"),
                    curListHeight = $allListWrap.height();
                $allListWrap.height(curListHeight);

                if ((listID != curList) && ( base.$el.find(":animated").length == 0)) {

                    // Fade out current list
                    base.$el.find("#"+curList).fadeOut(base.options.speed, function() {

                        // Fade in new list on callback
                        base.$el.find("#"+listID).fadeIn(base.options.speed);

                        // Adjust outer wrapper to fit new list snuggly
                        var newHeight = base.$el.find("#"+listID).height();
                        $allListWrap.animate({
                            height: newHeight
                        });

                        // Remove highlighting - Add to just-clicked tab
                        base.$el.find(".nav li a").removeClass("current");
                        $newList.addClass("current");

                    });

                }   

                // Don't behave like a regular link
                // Stop propegation and bubbling
                return false;
            });

        };
        base.init();
    };

    $.organicTabs.defaultOptions = {
        "speed": 200
    };

    $.fn.organicTabs = function(options) {
        return this.each(function() {
            (new $.organicTabs(this, options));
        });
    };

})(jQuery); 
```

和Javascript。

我试图通过使用将功能放在选项卡内

```
$(function() {

    $("#example-one").organicTabs();
}); 
```

但它不想工作。

# java - 如何用括号编码替换url中的括号？

> ID：11227394
> 
> 赞同：0
> 
> 时间：2012-06-27T13:30:54.077
> 
> 标签：java, regex

我需要一个正则表达式模式，它将查找 urls 中的括号并将其替换为它的 urls 编码。

例如一个基本网址，如：

```
http://www.mysite.com/bla/blabla/abc[1].txt 
```

将转向：

```
http://www.mysite.com/bla/blabla/abc%5B1%5D.txt 
```

有人可以帮忙吗？

EDIT1：我最初使用 commons-httpclient 来访问这种 url。当我使用第一个 URL 时，我得到一个“转义的绝对路径无效”异常。

我不能使用 URLENCODER，因为当我使用它时，我得到一个“主机参数为空”异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:33:24.243

以下行应该可以解决问题

```
String s = URLEncoder.encode("http://www.mysite.com/bla/blabla/abc[1].txt", "UTF-8"); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-27T13:33:52.357

你试过 URLEncoder.encode 吗？

在 java.net.URLEncoder 包中。

编辑：

好的，我明白了...您不能将整个 URL 传递给 URLEncoder。URLEncoder 主要用于对查询参数进行编码。

试试这个：

```
URI uri = new URI("http", "www.mysite.com", "/bla/blabla/abc[1].txt",null);
    System.out.println(uri.toASCIIString()); 
```

# spring - java.lang.ClassNotFoundException：org.springframework.web.servlet.DispatcherServlet

> ID：11227395
> 
> 赞同：92
> 
> 时间：2012-06-27T13:30:58.810
> 
> 标签：spring, maven, spring-mvc, maven-2

我正在使用**spring 3.1.0.RELEASE**，我的servlet容器是**tomcat 7**，我的IDE是**eclipse indigo** ，并且包含**DispatcherServlet** 的jar **spring-webmvc-3.1.0.RELEASE.jar** 存在于lib文件夹中，但是当运行应用程序，我得到了异常：

 **```
java.lang.ClassNotFoundException: org.springframework.web.servlet.DispatcherServlet
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1678)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1523)
    at org.apache.catalina.core.DefaultInstanceManager.loadClass(DefaultInstanceManager.java:525)
    at org.apache.catalina.core.DefaultInstanceManager.loadClassMaybePrivileged(DefaultInstanceManager.java:507)
    at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:126)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1099)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1043)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:4957)
    at org.apache.catalina.core.StandardContext$3.call(StandardContext.java:5284)
    at org.apache.catalina.core.StandardContext$3.call(StandardContext.java:5279)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662) 
```

请告知我为什么会收到此异常，以及如何解决它。

编辑：以下是我的配置文件：

**1- .springBeans：**

```
<?xml version="1.0" encoding="UTF-8"?>
<beansProjectDescription>
    <version>1</version>
    <pluginVersion><![CDATA[2.9.0.201203011806-RELEASE]]></pluginVersion>
    <configSuffixes>
        <configSuffix><![CDATA[xml]]></configSuffix>
    </configSuffixes>
    <enableImports><![CDATA[false]]></enableImports>
    <configs>
        <config>src/main/webapp/WEB-INF/checkout-servlet.xml</config>
    </configs>
    <configSets>
    </configSets>
</beansProjectDescription> 
```

**2- web.xml：**

```
<web-app>
  <display-name>Checkout</display-name>

  <servlet>
    <servlet-name>checkout</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>

  <servlet-mapping>
    <servlet-name>checkout</servlet-name>
    <url-pattern>*.action</url-pattern>
  </servlet-mapping>

</web-app> 
```

**3-结帐-servlet.xml：**

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">

    <context:component-scan base-package="com.myapp"/>

    <bean id="myService" class="com.myapp.MyService"/>

</beans> 
```

同样在尝试访问应用程序中的任何页面时，我得到了异常：

```
HTTP Status 404 - Servlet checkout is not available

type Status report

message Servlet checkout is not available

description The requested resource (Servlet checkout is not available) is not available.
Apache Tomcat/7.0.22 
```

* * *

## 回答 #1

> 赞同：257
> 
> 时间：2012-10-16T08:53:38.720

您需要在部署程序集中添加“Maven 依赖项”

*   右键单击您的项目并选择属性。
*   单击部署程序集。
*   点击添加
*   单击“Java 构建路径条目”
*   选择 Maven 依赖项”
*   单击完成。

重新构建和部署

注意：这也适用于*非 Maven*项目。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-06-27T21:49:27.610

两个可能的答案：

1-您的库中没有包含 spring-beans 和 spring-context jar。如果您使用的是 maven（这将有很大帮助），那么这两行就足够了

```
<dependency>
 <groupId>org.springframework</groupId>
  <artifactId>spring-context</artifactId>
   <version>3.1.0.RELEASE</version>
</dependency>
<dependency>
 <groupId>org.springframework</groupId>
  <artifactId>spring-webmvc</artifactId>
   <version>3.1.0.RELEASE</version>
</dependency> 
```

2- 必要的 jar 在您的类路径中，但未部署在 tomcat 上。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2014-07-05T11:35:43.920

我在使用 Idea Intellij 和 Spring 4 时遇到了同样的问题。我解决了这个问题，我想与你分享答案。

我使用 tomcat 7/idea intellij 13/spring 4。

pom.xml 依赖项：

```
 <properties>
    <spring.version>4.0.5.RELEASE</spring.version>
  </properties>

  <dependencies>     
    <dependency>
      <groupId>org.springframework</groupId>
      <artifactId>spring-core</artifactId>
      <version>${spring.version}</version>
    </dependency>

    <dependency>
enter code here
      <groupId>org.springframework</groupId>
      <artifactId>spring-context</artifactId>
      <version>${spring.version}</version>
    </dependency>

    <dependency>
      <groupId>org.springframework</groupId>
      <artifactId>spring-jdbc</artifactId>
      <version>${spring.version}</version>
    </dependency>

    <dependency>
      <groupId>org.springframework</groupId>
      <artifactId>spring-web</artifactId>
      <version>${spring.version}</version>
    </dependency>

    <dependency>
      <groupId>org.springframework</groupId>
      <artifactId>spring-webmvc</artifactId>
      <version>${spring.version}</version>
    </dependency>

    <dependency>
      <groupId>org.springframework</groupId>
      <artifactId>spring-test</artifactId>
      <version>${spring.version}</version>
      <scope>test</scope>
    </dependency>

    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>4.11</version>
      <scope>test</scope>
    </dependency>

    <dependency>
      <groupId>org.slf4j</groupId>
      <artifactId>slf4j-log4j12</artifactId>
      <version>1.7.2</version>
    </dependency>
        <dependency>
      <groupId>commons-dbcp</groupId>
      <artifactId>commons-dbcp</artifactId>
      <version>1.4</version>
    </dependency>
  </dependencies> 
```

在idea Intellij 中，您需要转到文件-> 项目设置-> 工件。

然后 ![在此处输入图像描述](../Images/72b8951352204c9221f47408108cfebc.png)

清理 -> 重建项目 -> 构建工件，一切都会好的。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2018-06-03T09:39:41.627

这为我解决了这个问题。这很容易而且很简单地解释了。

第1步

*   右键单击项目
*   点击属性

第2步

*   单击部署程序集选项卡中的
*   单击添加...

第 3 步

*   单击 Java 构建路径条目

第4步

*   单击 Maven 依赖项
*   点击完成按钮

第 5 步

*   再次将 Spring MVC 应用程序重新部署到 Tomcat
*   重启Tomcat
*   项目清单

[类未发现异常](https://crunchify.com/how-to-fix-java-lang-classnotfoundexception-org-springframework-web-servlet-dispatcherservlet-exception-spring-mvc-tomcat-and-404-error/)

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2012-06-28T08:54:54.213

我发现在**部署程序**集中，有以下条目：

```
[persisted container] org.maven.ide.eclipse.maven2_classpath_container 
```

我删除了它，并添加了`maven dependencies`条目，现在它工作正常。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-03-09T03:26:19.307

如果所有这些建议都不起作用，您应该重新创建服务器（Tomcat 或类似的）。这解决了我的问题。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-12-30T16:44:27.810

在您的 pom.xml 中包含以下依赖项

```
<dependency>
 <groupId>org.springframework</groupId>
  <artifactId>spring-webmvc</artifactId>
   <version>{spring-version}</version>
</dependency> 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-01-29T13:42:49.990

我面临着同样的问题。当我在本地查看 maven 存储库 .m2 文件夹（....m2\repository\org\springframework\spring-webmvc）时，我发现了两个 3.2.0.RELEASE 文件夹。所以我删除了一个。然后我去project，右键->properties->deployment essembly->add maven dependencies。清理构建，然后重新启动服务器。然后 DispatcherServlet 被加载。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-11-13T13:30:35.123

1.  转到您正在工作的**项目的****属性**
***   选择**部署程序集**菜单并单击**添加按钮***   选择**Java Build Path Entries**并单击**Maven Dependencies***   **构建**项目并运行**

 **[![在此处输入图像描述](../Images/3822fddd652194f3fb6949eaf644f34c.png)](https://i.stack.imgur.com/yFtIk.jpg)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-11-02T09:46:35.040

在我的情况下，我在使用 maven 的更新项目实用程序后遇到了这个问题。我尝试了您建议的所有解决方法，但似乎没有任何效果。最后，解决方案只是从服务器中删除项目以确保它是干净的，然后再次添加它。然后它起作用了，我希望这个解决方案可以帮助你们中的任何人。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-02-18T04:58:50.177

您可以使用 GlassFish 服务器，错误将得到解决。我尝试使用 tomcat7 和 tomcat8，但此错误不断出现，但使用 GlassFish 解决了。我觉得是服务器的问题。

这些是tomcat7的结果： [![使用 tomcat7 的结果](../Images/83e3e13a20a93d38e18b388631a2d654.png)](https://i.stack.imgur.com/3VlnU.png)

以下是 GlassFish 的结果： [![GlassFish 的结果](../Images/067d2e8c2d18fe06e8485769d11b4e41.png)](https://i.stack.imgur.com/hXsHQ.png)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-06-12T19:05:23.277

右键单击您的项目并选择属性。单击部署程序集。单击添加单击“Java 构建路径条目”选择 Maven 依赖项“单击完成。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-01-23T17:37:53.987

它可能对某人有用，所以我会在这里发布。我错过了对我的这种依赖`pom.xml`

```
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
    <exclusions>
        <exclusion>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-tomcat</artifactId>
        </exclusion>
    </exclusions>
</dependency> 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-08-31T15:19:51.347

我通过以下步骤解决了：

*   在项目中右击 > 配置 > 转换为 Maven 项目
*   转换完成后，在项目中右键 > Maven > 更新项目

这修复了项目的“部署程序集”设置。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-02-24T17:56:29.980

将 jar 文件从类路径移动到**web-inf/lib**，然后运行一个新的 tomcat 服务器。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-02-01T04:37:01.483

我找到了一个简单的解决方案，只需将您的 jars 添加到 WEB-INF-->lib 文件夹中..

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-08-23T19:20:45.097

我在 WebSphere 中遇到了同样的问题，但即使我验证了 Spring 依赖项在那里并且它在 tomcat 中运行得很好，也找不到解决方案。我最终卸载了应用程序，但仍然收到错误，所以我认为 WebSphere 挂在了一些损坏的实例上。

为了解决这个问题，我必须重新安装应用程序，停止它，卸载它，然后重新安装它。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-11-28T12:40:55.387

对我来说，这是一个错误`pom.xml`- 我设置`<scope>provided<scope>`了我的依赖项，这使得它们在`mvn package`阶段不会被复制。

我的症状是 OP 发布的错误消息，并且运行包后 .war 内的 WEB-INF/lib 路径中未包含 jar 包。当我删除范围时，罐子出现在输出中，现在一切正常。****

# ssis - SSIS 包无法打开全局共享内存以与性能 DLL 进行通信

> ID：11227397
> 
> 赞同：18
> 
> 时间：2012-06-27T13:31:13.370
> 
> 标签：ssis, package

我正在处理从数据库读取并输出平面文件的 .dtsx 文件。在使用 SQL 的 Execute Package Utility 测试包时，我收到了以下警告：

```
Warning: Could not open global shared memory to communicate 
  with performance DLL; 
  data flow performance counters are not available.  
  To resolve, run this package as an administrator, 
  or on the system's console. 
```

在我的研究中，我收到了关于如何处理这个问题的混合信息。有人说这是源和数据转换之间的数据类型问题。另一个人说这只是一个警告，只要你不需要性能计数器（我不相信我这样做），就可以忽略它。我还发现在没有 SQL Service Pack 的情况下运行 xp 的计算机上存在问题，但我使用的是 Windows 7。

我应该关心这个警告吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-05-19T10:24:28.643

如果您想防止出现此警告，您可以将用于执行包的用户帐户（例如您的帐户和/或 SQL Server 代理帐户）添加到本地组“性能监视器用户”中。

如果对任何服务（例如 SQL Server 代理）进行此更改，则需要重新启动服务才能使更改生效。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-27T18:02:06.850

我的理解是 UAC 不允许 VS/BIDS 访问性能计数器。对于日常包执行，你很好。它不会影响 SSIS 的运行能力，也不会改变数据转换的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-09-28T15:42:46.183

@Nathan 修复对我不起作用

它的排序是以管理员身份运行 Visual Studio ...即使我的帐户在本地管理员组中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-14T11:48:43.143

“本地管理员”组允许您在单独请求时以管理员权限运行，例如“以管理员身份运行”。这并不意味着您始终以管理员权限运行所有内容

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-27T14:30:58.897

在我的示例中，我有一个 oledb 命令对象，但在它之前没有对象。它正在执行单个插入语句，但因此我仅使用“Select 1 as NeededColumnInput”添加了一个对象，然后将其连接到 oledb 命令对象。然后我的工作。

# jquery - jQuery 数组从特定索引开始并移动到数组末尾

> ID：11227398
> 
> 赞同：0
> 
> 时间：2012-06-27T13:31:20.173
> 
> 标签：jquery, arrays, indexing, fancybox, fancybox-2

我正在使用 Fancybox jQuery 插件，当点击事件发生时我手动调用它。我面临的问题是当我使用一组图像以便能够使用箭头在它们之间导航时。为此，组中的所有图像都具有相同的“rel”属性。下面的代码似乎一切正常，我已经设法编写了，但问题出在第一个加载的图像上，因为即使我点击第二个图像 - 第一个显示在灯箱中，因为这是第一个索引创建的数组。

所以我的问题是 - 我如何重新排列数组，以便单击的项目将成为第一个，而前面的项目将移动到数组的末尾 - 基本上是移动项目。

示例是：

```
var thisArray = [ item-1, item-2, item-3 ];
var thisArray = [ item-2, item-3, item-1 ]; 
```

我的代码如下（我也已经有了'currentIndex'变量，它返回被点击元素的索引：

```
lightbox : function(obj) {
    "use strict";
    obj.live('click', function(e) {
        e.preventDefault();
        var thisObj = $(this);

        var thisOptions = {
            beforeLoad  : function() {
                $('body').css('overflow', 'hidden');
            },
            afterClose  : function() {
                $('body').css('overflow', 'auto');
            },              
            scrolling   : 'no',
            fitToView   : true,
            margin      : 0,
            padding     : 0,
            closeBtn    : false,
            closeClick  : true,
            arrows      : true,
            helpers     : {
                title : {
                    type : 'inside'
                },
                overlay : {
                    speedIn  : 0,
                    speedOut : 300,
                    opacity  : 1,
                    css      : {
                        cursor : 'pointer',
                        'background-color' : '#000'
                    },
                    closeClick: true
                }
            }
        };

        var thisAttrRel = thisObj.attr('rel');
        if (thisAttrRel) {
            var thisObjs = $('a[rel='+thisAttrRel+']');
            if (thisObjs.length > 1) {
                var currentIndex = thisObjs.index(thisObj);
                var thisItems = [];
                jQuery.each(thisObjs, function() {
                    var thisHref = $(this).attr('href');
                    var thisTitle = $(this).attr('title');
                    thisItems.push({ 'href' : thisHref, 'title' : thisTitle });
                });
                jQuery.fancybox.open(thisItems, thisOptions);
            }
        } else {
            thisOptions.href = thisObj.attr('href'),
            jQuery.fancybox(thisOptions);
        }       

    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:21:29.363

好的 - 因为我在任何地方都找不到答案，所以我尝试并设法创建了一种重新排列数组的方法 - 这里适用于那些也遇到同样问题的人：

```
arrayReArrange : function(thisFirst, thisArray) {
    "use strict";
    if (thisFirst !== 0 && thisArray && thisArray.length > 0) {
        var thisNewArray = [];
        var i = 0;
        var thisIndex = 0;
        while (i < (thisArray.length + thisFirst)) {
            if (thisFirst === i) {
                thisNewArray.push(thisArray[thisIndex]);
            } else if (thisNewArray.length > 0) {
                thisNewArray.push(thisArray[thisIndex]);
            }
            if (thisIndex === (thisArray.length - 1)) {
                thisIndex = 0;
            } else {
                thisIndex++;
            }               
            i++;
        }
        return thisNewArray;
    } else {
        return thisArray;
    }
} 
```

现在我可以从我的 lightbox() 方法中调用它：

```
lightbox : function(obj) {
    "use strict";
    obj.live('click', function(e) {
        e.preventDefault();
        var thisObj = $(this);

        var thisOptions = {
            beforeLoad  : function() {
                $('body').css('overflow', 'hidden');
            },
            afterClose  : function() {
                $('body').css('overflow', 'auto');
            },              
            scrolling   : 'no',
            fitToView   : true,
            margin      : 0,
            padding     : 0,
            closeBtn    : false,
            closeClick  : true,
            arrows      : true,
            helpers     : {
                title : {
                    type : 'inside'
                },
                overlay : {
                    speedIn  : 0,
                    speedOut : 300,
                    opacity  : 1,
                    css      : {
                        cursor : 'pointer',
                        'background-color' : '#000'
                    },
                    closeClick: true
                }
            }
        };

        var thisAttrRel = thisObj.attr('rel');
        if (thisAttrRel) {
            var thisObjs = $('a[rel='+thisAttrRel+']');
            if (thisObjs.length > 1) {                  
                var thisItems = [];
                jQuery.each(thisObjs, function() {
                    var thisHref = $(this).attr('href');
                    var thisTitle = $(this).attr('title');
                    thisItems.push({ 'href' : thisHref, 'title' : thisTitle });
                });
                var currentIndex = thisObjs.index(thisObj);
                thisItems = systemObject.arrayReArrange(currentIndex, thisItems);
                console.log(thisItems);
                jQuery.fancybox.open(thisItems, thisOptions);
            }
        } else {
            thisOptions.href = thisObj.attr('href'),
            jQuery.fancybox(thisOptions);
        }       

    });
} 
```

# c# - 尽管进行了强制转换，但反序列化了不正确的类

> ID：11227399
> 
> 赞同：1
> 
> 时间：2012-06-27T13:31:20.310
> 
> 标签：c#, deserialization

在反序列化存储为 MySQL 数据库中的 BLOB 的多个对象时遇到问题。

每个对象类都有自己的反序列化函数。

```
Class1 c1Holder = (Class1)binFormatter.Deserialize(memStream); 
```

工作正常，但随后...

```
Class2 c2Holder = (Class2)binFormatter.Deserialize(memStream); 
```

...调用 Class1 反序列化函数。当我使用 VS 2010 调试器逐步完成它时，它将在第二次尝试时调用正确的函数。还...

```
Class3 c3Holder = (Class3)binFormatter.Deserialize(memStream); 
```

...调用 Class1 反序列化函数，然后是 Class2 函数，最后是正确的函数。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T15:18:19.407

从评论：

> 无法将“Assembly.Class1”类型的对象转换为“Assembly.Class4”类型。
> 
> 无法将“Assembly.Class2”类型的对象转换为“Assembly.Class4”类型。
> 
> 无法将“Assembly.Class3”类型的对象转换为“Assembly.Class4”类型。

这表明您只是期望数据的类型与实际不同。BinaryFormatter 的要点是，如果你序列化一个 Class7，那么它将反序列化为一个 class7。对于其他序列化程序，您通常需要告诉它要将其反序列化为什么，只要它们看起来相似，就允许不同的类型可以互换。

所以使用 BinaryFormatter：如果你想获得 Class2，请*序列化*Class2。

为了清楚起见，以下内容：

```
Class2 c2Holder = (Class2)binFormatter.Deserialize(memStream); 
```

没有**说**“将其反序列化为 Class2” - 它更像是：

```
object tmp = binFormatter.Deserialize(memStream);
Class2 c2Holder = (Class2)tmp; 
```

即“将其序列化为任何内容，然后将其转换为 Class2”。如果它*不是*Class2，它将失败。这不是转换等 - 只是类型检查。

如果您需要有关使用相似但不同类型的序列化的建议，请告诉我。

# c++ - 带有 OPC XML-DA 添加属性的 gSOAP

> ID：11227404
> 
> 赞同：2
> 
> 时间：2012-06-27T13:31:26.023
> 
> 标签：c++, xml, wsdl, gsoap, opc

我正在尝试开发一个可以通过 OPC XML-DA 规范访问数据的肥皂客户端：[这里](http://www.opcfoundation.org/DownloadFile.aspx?CM=3&RI=231&CN=KEY&CI=278&CU=97)

我使用 gSOAP 提供的工具从 OPC Foundations WSDL 生成 gSOAP 头文件。（以下相关部分）

我似乎无法让 gSOAP 正确地向标签添加属性。（见下面的输出部分）。是否有内置的方法来执行此操作，或者是否需要修改 WSDL/gSOAP 标头？

WSDL 提取：

```
<s:complexType name="ItemValue">
<s:sequence>
<s:element minOccurs="0" maxOccurs="1" name="DiagnosticInfo" type="s:string" />
<s:element minOccurs="0" maxOccurs="1" name="Value" />
<s:element minOccurs="0" maxOccurs="1" name="Quality" type="s0:OPCQuality" />
</s:sequence>
<s:attribute name="ValueTypeQualifier" type="s:QName" />
<s:attribute name="ItemPath" type="s:string" />
<s:attribute name="ItemName" type="s:string" />
<s:attribute name="ClientItemHandle" type="s:string" />
<s:attribute name="Timestamp" type="s:dateTime" />
<s:attribute name="ResultID" type="s:QName" />
</s:complexType> 
```

生成的 gSOAP 标头

```
class ns1__ItemValue
{ public:
/// Element DiagnosticInfo of type xs:string.
    char*                                DiagnosticInfo                 0;  ///< Optional element.
/// Element 'Value' has no type or ref: assuming XML content.
    _XML                                 Value                          0;  ///< Optional element.
/// Element Quality of type "http://opcfoundation.org/webservices/XMLDA/1.0/":OPCQuality.
    ns1__OPCQuality*                     Quality                        0;  ///< Optional element.
/// Attribute ValueTypeQualifier of type xs:QName.
   @_QName                               ValueTypeQualifier             0;  ///< Optional attribute.
/// Attribute ItemPath of type xs:string.
   @char*                                ItemPath                       0;  ///< Optional attribute.
/// Attribute ItemName of type xs:string.
   @char*                                ItemName                       0;  ///< Optional attribute.
/// Attribute ClientItemHandle of type xs:string.
   @char*                                ClientItemHandle               0;  ///< Optional attribute.
/// Attribute Timestamp of type xs:dateTime.
   @time_t*                              Timestamp                      0;  ///< Optional attribute.
/// Attribute ResultID of type xs:QName.
   @_QName                               ResultID                       0;  ///< Optional attribute.
/// A handle to the soap struct that manages this instance (automatically set)
    struct soap                         *soap                          ;
}; 
```

生成的代码

```
class SOAP_CMAC ns1__ItemValue
{
public:
    char *DiagnosticInfo;   /* optional element of type xsd:string */
    char *Value;    /* optional element of type xsd:anyType */
    class ns1__OPCQuality *Quality; /* optional element of type ns1:OPCQuality */
    char *ValueTypeQualifier;   /* optional attribute */
    char *ItemPath; /* optional attribute */
    char *ItemName; /* optional attribute */
    char *ClientItemHandle; /* optional attribute */
    time_t *Timestamp;  /* optional attribute */
    char *ResultID; /* optional attribute */
    struct soap *soap;  /* transient */
public:
    virtual int soap_type() const { return 18; } /* = unique id SOAP_TYPE_ns1__ItemValue */
    virtual void soap_default(struct soap*);
    virtual void soap_serialize(struct soap*) const;
    virtual int soap_put(struct soap*, const char*, const char*) const;
    virtual int soap_out(struct soap*, const char*, int, const char*) const;
    virtual void *soap_get(struct soap*, const char*, const char*);
    virtual void *soap_in(struct soap*, const char*, const char*);
             ns1__ItemValue() : DiagnosticInfo(NULL), Value(NULL), Quality(NULL), ValueTypeQualifier(NULL), ItemPath(NULL), ItemName(NULL), ClientItemHandle(NULL), Timestamp(NULL), ResultID(NULL), soap(NULL) { }
    virtual ~ns1__ItemValue() { }
}; 
```

输出

```
<ns1:Items
    ClientItemHandle="Channel1.Device1"
    ItemName="Channel_1.Device_1.Tag_1"
    ValueTypeQualifier="xsd:unsignedInt">
    <Value
        xmlns="http://opcfoundation.org/webservices/XMLDA/1.0/">
        5
    </Value>
</ns1:Items> 
```

需要的输出

```
<ns1:Items
    ClientItemHandle="Channel1.Device1"
    ItemName="Channel_1.Device_1.Tag_1"
    ValueTypeQualifier="xsd:unsignedInt">
    <Value
        xmlns="http://opcfoundation.org/webservices/XMLDA/1.0/"
        xsi:Type="xsd:unsignedInt">
        5
    </Value>
</ns1:Items> 
```

输出是指生成并通过线路发送到远程服务器的 XML。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T18:55:25.920

这里有一些可能会有所帮助的东西。我现在无法测试它，所以这只是一个建议。查看“无效指针”：[http ://www.cs.fsu.edu/~engelen/soapdoc2.html#tth_sEc11.9](http://www.cs.fsu.edu/~engelen/soapdoc2.html#tth_sEc11.9)

```
struct myStruct 
{ 
   int __type; // the SOAP_TYPE pointed to by p 
   void *p; 
}; 
```

正如我从文档中了解的那样，这用于序列化任何内容，并指定它的类型。因此，用此结构替换 Value 元素的 _XML 类型可能会起作用。然后你只需要用相应的值设置 __type 属性：

```
struct ns1_Value {
   int __type; // the SOAP_TYPE pointed to by p 
   void *p; 
}
struct ns1_Value value; 
int n; 
value.p = &n; 
value.__type = SOAP_TYPE_int; 
```

解决问题的另一种方法可能是序列化原始 xml 而不是 <Value> 元素......或者考虑一些扩展 xs:anyType 的 xs:element，但定义了一个 xs:type.. 实际上 gSoap 是一个很酷的产品，但要充分利用它，您需要学习如何破解它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T14:58:13.223

@Tisho，感谢您的意见。

事实证明，OPC Foundation 提供的 WSDL 缺少在 value 元素上指定类型。我们的解决方案是添加一个 s:anyType 类型，这允许我们使用多态类型，例如：
xsd_ *unsignedInt
xsd* _string
xsd__anyType

由于所有类型都继承自 xsd__anyType，并且包含了一个虚拟 soap_type 函数，我们可以使用任何类型，并将它们存储在值中，然后 gSOAP 神奇地使用 soap_type 来确定 var 是什么类型。

OPC Foundation 的 WSDL 的相关部分已修改：

```
<s:complexType name="ItemValue">
  <s:sequence>
    <s:element minOccurs="0" maxOccurs="1" name="DiagnosticInfo" type="s:string"/>
    <s:element minOccurs="0" maxOccurs="1" name="Value" type="s:anyType"/> <!-- Here -->
    <s:element minOccurs="0" maxOccurs="1" name="Quality" type="s0:OPCQuality"/>
  </s:sequence>
  <s:attribute name="ValueTypeQualifier" type="s:QName"/>
  <s:attribute name="ItemPath" type="s:string"/>
  <s:attribute name="ItemName" type="s:string"/>
  <s:attribute name="ClientItemHandle" type="s:string"/>
  <s:attribute name="Timestamp" type="s:dateTime"/>
  <s:attribute name="ResultID" type="s:QName"/>
</s:complexType> 
```

这是新的 gSOAP 生成的标头

```
class ns1__ItemValue : public xsd__anyType
{ public:
/// Element DiagnosticInfo of type xs:string.
    char*                                DiagnosticInfo                 0;  ///< Optional element.
/// Element Value of type xs:anyType.
    xsd__anyType*                        Value                          0;  ///< Optional element.
/// Element Quality of type "http://opcfoundation.org/webservices/XMLDA/1.0/":OPCQuality.
    ns1__OPCQuality*                     Quality                        0;  ///< Optional element.
/// Attribute ValueTypeQualifier of type xs:QName.
   @_QName                               ValueTypeQualifier             0;  ///< Optional attribute.
/// Attribute ItemPath of type xs:string.
   @char*                                ItemPath                       0;  ///< Optional attribute.
/// Attribute ItemName of type xs:string.
   @char*                                ItemName                       0;  ///< Optional attribute.
/// Attribute ClientItemHandle of type xs:string.
   @char*                                ClientItemHandle               0;  ///< Optional attribute.
/// Attribute Timestamp of type xs:dateTime.
   @time_t*                              Timestamp                      0;  ///< Optional attribute.
/// Attribute ResultID of type xs:QName.
   @_QName                               ResultID                       0;  ///< Optional attribute.
}; 
```

# c++ - 为我的对象分配特定/显式内存位置

> ID：11227406
> 
> 赞同：0
> 
> 时间：2012-06-27T13:31:29.580
> 
> 标签：c++, pointers, memory-address

我可以在 C++ 中创建一个对象，明确指定它的内存地址吗？这是因为我的每个实体（对象）都有单独的 ID。因此，如果我能做到这一点，我将能够仅通过添加指针来遍历我的所有对象。考虑：我有一个内存位置为 x 的对象。我想创建具有内存位置 x+（下一个对象的唯一 ID）*K 的下一个对象，其中 K 是两个对象之间的恒定间隙（例如）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-27T13:32:53.607

您可以使用放置`new`运算符指定内存。

> 因此，如果我能做到这一点，我将能够仅通过添加指针来遍历我的所有对象。

并不真地。**忽略告诉您这样做的答案！**您不能在数组之外进行指针运算。仅仅因为你有 2 个对象`o1`，`o2`一个位于，另一个位于`0x4`，`0x5`并不意味着它`&o1 + 1`会产生`&o2`。事实上，这是未定义的行为。

为此，您可以动态分配内存，或者更好的是，使用 a`std::vector`和使用迭代器。（这就是他们的目的）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-27T13:36:02.987

C++ 放置 new 运算符可以满足您的需求。只要确保为它们分配足够的内存即可。

见： http: [//www.parashift.com/c++-faq-lite/dtors.html#faq-11.10](http://www.parashift.com/c++-faq-lite/dtors.html#faq-11.10)

上面链接中的示例：

```
char memory[sizeof(Fred)];
void* place = memory;

Fred* f = new(place) Fred(); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-27T13:38:37.030

您可以使用安德鲁斯回答并分配一个对象数组。

在 C++ 中，您还可以使用特殊形式的 new 运算符在预分配地址处创建对象：

```
char memory[sizeof(MyClass[100])]; // memory for an array of 100 MyClass-objects

// Cast to MyClass-Array to let the compiler calculate
// the start addresses of the array elements.
MyClass * array = reinterpret_cast<MyClass *>(memory);

// create object with index 5
MyClass * pointerToSixthEntry= new (&array[5]) MyClass();

// Use the object by its index (no pointer arithmetic needed)
array[5].sayHelloWorld(); 
```

这称为[放置新](http://www.parashift.com/c++-faq-lite/dtors.html#faq-11.10)。

这很丑陋，我不会这样做。如果它不是真正的内存/运行时关键，您可以考虑使用以索引为键的 STL 映射。作为一个积极的副作用，您可以免费跟踪使用/未使用的 ID。

使用预先分配的向量也可能有所帮助。检查 Luchian 的答案和评论。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-27T14:24:54.017

Qestion 你的 id，这些也是连续的并且没有缺失值吗？

如果是这样的话

我认为 std::map 适合您的需求，键（您的 id）已排序，（只需在递归中插入）并且您可以使用迭代器（指针算术）。

[http://www.cplusplus.com/reference/stl/map/](http://www.cplusplus.com/reference/stl/map/)

# ruby-on-rails-3 - Draper：如何将装饰模型的所有允许属性和公共方法转换为 json

> ID：11227410
> 
> 赞同：3
> 
> 时间：2012-06-27T13:31:40.063
> 
> 标签：ruby-on-rails-3, json, backbone.js, draper, hamlc

我正在寻找一种将装饰模型转换为 json 以在我的客户端模板中使用的简单方法。我想找到一个解决方案，其中装饰模型的所有允许属性和公共方法都将保留在 json 中。

目前我有带有rails后端的骨干RIA。我正在使用 haml_coffee_assets gem 进行客户端模板。Draper 在那里为我的用户模型提供装饰

```
class ContactDecorator < Draper::Base

  include Draper::LazyHelpers

  decorates :user

  allows :login, :id, :total_unread, :total_messages

  def for_json
    {
        :new_messages => new_messages,
        :avatar_link => avatar_link,
        :login_name_link => login_name_link,
        :id => model.id,
        :name => model.login,
        :avatar => model.avatar.url(:small),
        :humanized_messages_number =>
    }
  end

  def  humanized_messages_number
    pluralize(user['total_messages'], t("share_my_trip.messages.Message"), t("share_my_trip.messages.Messages")) + " #{new_messages}"
  end

  def new_messages
    model['total_unread'].to_i > 0 ? "(#{model['total_unread'].to_i} #{t("share_my_trip.messages.new")})" : ''
  end

  def avatar_link
    link_to(image_tag(model.avatar.url(:small), :size => "32x32", :onerror => "this.src='/avatars/original/missing.png'"), share_my_trip_user_path(:id => model.login), :id => "user-nick-#{model.id}", :class => "author")
  end

  def login_name_link
    link_to(model.login, share_my_trip_user_path(:id => model.login), :id => "user-nick-#{model.id}", :class => "author")
  end

end 
```

我的控制器代码如下所示：

```
def index
  @dialogs = ContactDecorator.decorate(current_user.contacts).collect{|c| c.for_json}
end 
```

而在我看来，我只是在初始化主干应用程序：

```
:javascript
  App.init({dialogs: #{@dialogs.to_json}}) 
```

有没有办法删除丑陋的#for_json 装饰器方法？

# android - 如何获取草稿短信的地址

> ID：11227411
> 
> 赞同：4
> 
> 时间：2012-06-27T13:31:48.537
> 
> 标签：android, sms

我无法获得草稿 SMS 的地址，它总是`null`使用以下代码给我 iam

```
 public static final Uri SMS_PROVIDER = Uri.parse("content://sms");     
     Cursor oCursorSMS = mContext.getContentResolver().query(SMS_PROVIDER, null,null,null, null);                                                           
oCursorSMS.moveToFirst();                                     
        final String[] columns = oCursorSMS.getColumnNames();                           
        for (int i = 0; i < columns.length; i++) {
            String ss = cursor.getString(i);
            } 
```

当我阅读草稿短信时，地址栏返回`null`我已经搜索了很多，关于这个问题有很多问题，但没有人有答案。谁能帮我这个

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-26T15:50:07.217

从 uri`content://mms-sms/conversations?simple=true`您可以访问线程表，在线程表中有一个列`recipient_ids` 可用于获取地址，请参阅我的答案[here](https://stackoverflow.com/questions/12492602/fetch-address-from-canonical-addresses-table/12493252#12493252)以了解如何执行此操作。基本上，你想`thread_id`从你的短信中获取，然后用它来查看线程表，即过滤器应该是`_id = thread_id_from_sms`. 现在获取 recipient_ids 并使用它来查找地址`content://mms-sms/canonical-addresses`

# jquery - 在表单提交时将 Javascript 数组添加到 POST 变量

> ID：11227413
> 
> 赞同：5
> 
> 时间：2012-06-27T13:31:56.303
> 
> 标签：jquery, post

我有一个 Javascript 数组，我想在提交表单时将其添加到 post 数组中。除了已经从表单发布的其他变量之外，还应添加 Javascript 数组。有没有办法在 JQuery 中做到这一点？

前任。

形式：

```
<form id="my-form" action="/create.php" method="post">
<input id="first_name" type="text" /> 
<input id="last_name" type="text" /> 
</form> 
```

Javascript数组：

```
<script type="text/javascript">

var external_ids = [{"name":"SSN","value":"555-55-5555"},    
{"name":"PID","value":"GBNT22"}];

</script> 
```

如果可能的话，这就是我希望生成的 PHP $_POST 数组的样子：

```
Array
(
    [first_name] => John
    [last_name] => Smith
    [external_ids]=>
        (
            [SSN] => 555-55-5555
            [PID] => GBNT22
        )
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:44:45.187

你去：

```
var external_ids = [{"name": "SSN", "value": "555-55-5555"},
                    {"name": "PID", "value": "GBNT22"}];

// form fields
var values = {};
var fields = $('#myForm :input');
$.each(fields, function(i, field) {
    var dom = $(field),
        name = dom.attr('id'),
        value = dom.val();
    values[name] = value;
});

// add array
values.external_ids = {};
$.each(external_ids, function(i, field) {
    values.external_ids[field.name] = field.value;
});

// post data
$.post('/endpoint', values);​ 
```

也可以在这个[jsfiddle](http://jsfiddle.net/qbE6g/1/)中找到代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T13:34:11.050

jQuery 上有 serialize() 函数。你检查过这个吗？

或者你可以使用这样的东西：

```
function onSubmit(){
    var toSend = [
        first_name : 'John',
        last_name : 'Smith',
        external_ids : {
            SSN: '555-55-5555',
            PID: 'GBNT22'
        }
    ];

    $.post( yourUrl, toSend, function(data){
        //callback
    } ); 
```

}

# windows-8 - 如何在window8 slate中进行捏缩放

> ID：11227415
> 
> 赞同：-1
> 
> 时间：2012-06-27T13:32:00.713
> 
> 标签：windows-8, microsoft-metro

如何在 windows8 slate 中多次放大或缩小。

你能用C#提供答案吗？

谢谢，

龙树菩萨

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:11:30.047

```
<SemanticZoom.ZoomedOutView>
    <!-- Put the GridView for the zoomed out view here. -->   
</SemanticZoom.ZoomedOutView>

<SemanticZoom.ZoomedInView>
    <!-- Put the GridView for the zoomed in view here. -->       
</SemanticZoom.ZoomedInView> 
```

# mysql - mysql存储过程未从事件调度程序触发

> ID：11227417
> 
> 赞同：0
> 
> 时间：2012-06-27T13:32:04.877
> 
> 标签：mysql

有人可以告诉我这个sp有什么问题吗？逻辑似乎没问题，但是当我重新查看表时，它根本不起作用。

```
 DELIMITER //
DROP PROCEDURE IF EXISTS add_zero_yearly_sales_proc //
CREATE PROCEDURE add_zero_yearly_sales_proc() 
READS SQL DATA
BEGIN 

DECLARE num_of_sales INT DEFAULT 0;
DECLARE last_ins_date DATETIME;
DECLARE done INT DEFAULT 0;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

SET last_ins_date = DATE_SUB(NOW(), INTERVAL 2 YEAR);

ins_loop: WHILE last_ins_date < NOW() DO
SELECT COUNT(sales_amount_sold) INTO num_of_sales
FROM yearly_sales
WHERE sales_date_sold BETWEEN DATE_FORMAT(last_ins_date,'%Y-%m-01 00:00:01') AND DATE_FORMAT(LAST_DAY(last_ins_date),'%Y-%m-%d 23:59:59');

IF num_of_sales = 0 THEN  

INSERT INTO yearly_sales(sales_date_sold, sales_amount_sold,sales_quantity) 
VALUES (CONCAT(DATE_FORMAT(last_ins_date,'%Y-%m-01 00:00:01')),0, 0);

END IF ;

SET num_of_sales = 0;
SET last_ins_date = DATE_ADD(last_ins_date, INTERVAL 1 MONTH);

END WHILE ins_loop;
SET done = 0;

END ;//
DELIMITER ; 
```

我创建了一个每小时触发一次的事件来调用此过程。该过程应该检查 yearly_sales 表中是否有月份没有任何销售值，如果是，则为数量和数量添加 0 值，并为日期添加月初。我已经检查过了，但它似乎不起作用。

这也是我创建的每小时调用一次的事件

```
 DELIMITER //  
CREATE    
EVENT `hourly_sales_evt`  
ON SCHEDULE EVERY 1 HOUR STARTS DATE_FORMAT(NOW(),'%Y-%m-%d %H:55:00')
ON COMPLETION PRESERVE
DO BEGIN 
    CALL add_zero_yearly_sales_proc();
END //
DELIMITER ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:09:23.243

该过程看起来不错，逻辑应该有效。但是，我想问你 - 你为什么`sales_date_sold`从第一秒开始检查 - `DATE_FORMAT(last_ins_date,'%Y-%m-01 00:00:01')`，不应该是 DATE_FORMAT(last_ins_date,'%Y-%m-01 00:00:00') 吗？

还有一点：你在循环中多次执行SELECT语句，是没有效果的。尝试使用月份数创建其他（可能是临时表）并连接两个表以找出没有任何销售的月份。在这种情况下，您将一步获得结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T14:55:14.717

可能是全局事件调度程序处于停止/禁用状态。

要打开事件调度程序，请运行以下任一命令：

```
SET GLOBAL event_scheduler = ON;
SET @@global.event_scheduler = ON;
SET GLOBAL event_scheduler = 1;
SET @@global.event_scheduler = 1; 
```

当事件调度器打开时，事件调度器线程作为守护进程列在输出中`SHOW PROCESSLIST`，其状态如下所示：

```
mysql> SHOW PROCESSLIST\G
*************************** 1\. row ***************************
     Id: 1
   User: root
   Host: localhost
     db: NULL
Command: Query
   Time: 0
  State: NULL
   Info: show processlist
*************************** 2\. row ***************************
     Id: 2
   User: event_scheduler
   Host: localhost
     db: NULL
Command: Daemon
   Time: 3
  State: Waiting for next activation
   Info: NULL
2 rows in set (0.00 sec) 
```

将事件调度程序设置为 ON 后，您会看到它正在工作。

**参考**：[MySQL 事件调度器配置](http://dev.mysql.com/doc/refman/5.6/en/events-configuration.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T14:05:24.230

我在这里猜测没有做太多挖掘，但我认为这是你的问题：

```
READS SQL DATA
...
INSERT INTO yearly_sales(sales_date_sold, sales_amount_sold,sales_quantity) 
VALUES (CONCAT(DATE_FORMAT(last_ins_date,'%Y-%m-01 00:00:01')),0, 0); 
```

# rotation - Three.js 默认旋转带轨迹球控制

> ID：11227418
> 
> 赞同：1
> 
> 时间：2012-06-27T13:32:05.173
> 
> 标签：rotation, webgl, three.js, trackball

我有一个场景，在三个.js中有几个网格，网格之间的距离是固定的。问题是整个小组都颠倒了。我的第一个想法是用 pi 在 z 轴上旋转相机。这不起作用，因为我使用的轨迹球控件重置了这个旋转。有没有办法覆盖默认旋转？

# linux - 在 Glassfish 上部署时，Cargo 插件抛出 CargoException - 部署失败：null

> ID：11227419
> 
> 赞同：39
> 
> 时间：2012-06-27T13:32:06.863
> 
> 标签：linux, maven, ubuntu, glassfish, cargo

我正在尝试在远程 Glassfish 服务器（版本 3.1.1（版本 12））上使用 Cargo Maven 插件部署 Web 应用程序。Glassfish 服务器以及位于不同 Linux 服务器 (Ubuntu) 上的 Java 代码。我已经在 pom 文件中配置了所有必要的属性，并在 Windows 机器上测试了部署。有用。但它在 Linux Ubuntu 上失败了，但有一个有趣的例外：

```
27-Jun-2012 14:36:05    [ERROR] Failed to execute goal org.codehaus.cargo:cargo-maven2-plugin:1.2.1:deploy (default-cli) on project my-web-project-app: Execution default-cli of goal org.codehaus.cargo:cargo-maven2-plugin:1.2.1:deploy failed: Deployment has failed: null -> [Help 1]
27-Jun-2012 14:36:05    org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.codehaus.cargo:cargo-maven2-plugin:1.2.1:deploy (default-cli) on project mca-staff-app: Execution default-cli of goal org.codehaus.cargo:cargo-maven2-plugin:1.2.1:deploy failed: Deployment has failed: null
27-Jun-2012 14:36:05            at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:225)
27-Jun-2012 14:36:05            at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
27-Jun-2012 14:36:05            at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
27-Jun-2012 14:36:05            at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
27-Jun-2012 14:36:05            at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
27-Jun-2012 14:36:05            at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
27-Jun-2012 14:36:05            at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
27-Jun-2012 14:36:05            at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:319)
27-Jun-2012 14:36:05            at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
27-Jun-2012 14:36:05            at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
27-Jun-2012 14:36:05            at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
27-Jun-2012 14:36:05            at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
27-Jun-2012 14:36:05            at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
27-Jun-2012 14:36:05            at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
27-Jun-2012 14:36:05            at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
27-Jun-2012 14:36:05            at java.lang.reflect.Method.invoke(Method.java:597)
27-Jun-2012 14:36:05            at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
27-Jun-2012 14:36:05            at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
27-Jun-2012 14:36:05            at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
27-Jun-2012 14:36:05            at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
27-Jun-2012 14:36:05    Caused by: org.apache.maven.plugin.PluginExecutionException: Execution default-cli of goal org.codehaus.cargo:cargo-maven2-plugin:1.2.1:deploy failed: Deployment has failed: null
27-Jun-2012 14:36:05            at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:110)
27-Jun-2012 14:36:05            at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
27-Jun-2012 14:36:05            ... 19 more
27-Jun-2012 14:36:05    Caused by: org.codehaus.cargo.util.CargoException: Deployment has failed: null
27-Jun-2012 14:36:05            at org.codehaus.cargo.container.spi.deployer.AbstractJsr88Deployer.waitForProgressObject(AbstractJsr88Deployer.java:285)
27-Jun-2012 14:36:05            at org.codehaus.cargo.container.spi.deployer.AbstractJsr88Deployer.deploy(AbstractJsr88Deployer.java:126)
27-Jun-2012 14:36:05            at org.codehaus.cargo.maven2.DeployerDeployMojo.performDeployerActionOnSingleDeployable(DeployerDeployMojo.java:56)
27-Jun-2012 14:36:05            at org.codehaus.cargo.maven2.AbstractDeployerMojo.performDeployerActionOnAllDeployables(AbstractDeployerMojo.java:178)
27-Jun-2012 14:36:05            at org.codehaus.cargo.maven2.AbstractDeployerMojo.doExecute(AbstractDeployerMojo.java:98)
27-Jun-2012 14:36:05            at org.codehaus.cargo.maven2.AbstractCargoMojo.execute(AbstractCargoMojo.java:311)
27-Jun-2012 14:36:05            at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
27-Jun-2012 14:36:05            ... 20 more 
```

有人在 Linux 上使用 maven Cargo 插件进行远程应用程序部署吗？或者也许有人知道这里有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-11-17T14:22:21.857

默认密码是 adminadmin。如果您没有密码，则使用“”使用货物作为密码将导致错误，如果密码字段为空。

使用以下代码 `enter code here` `enter code here` org.codehaus.cargo `enter code here` cargo-maven2-plugin `enter code here` 1.7.16 `enter code here` ... `enter code here` `enter code here`

`enter code here` `enter code here` deploy `enter code here` pre-integration-test `enter code here` `enter code here` start</goal redeploy `enter code here` `enter code here` `enter code here` `enter code here` undeploy `enter code here` post-integration-test `enter code here` `enter code here` undeploy `enter code here` stop `enter code here` `enter code here`

# android - Android 应用程序无法在 Armv6 上启动 - 无法找到本机库

> ID：11227422
> 
> 赞同：1
> 
> 时间：2012-06-27T13:32:12.870
> 
> 标签：android, armv7, armv6, android-ndk

我找不到问题的答案。

我开发了市场上可用的 Android 应用程序。到目前为止，很少有人购买它并且它可以工作，但一位客户收到此错误：

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{com.esenthel.rts/android.app.NativeActivity}: java.lang.IllegalArgumentException: Unable to find native library: Project
 at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
 at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
 at android.app.ActivityThread.access$1500(ActivityThread.java:117)
 at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
 at android.os.Handler.dispatchMessage(Handler.java:99)
 at android.os.Looper.loop(Looper.java:130)
 at android.app.ActivityThread.main(ActivityThread.java:3687)
 at java.lang.reflect.Method.invokeNative(Native Method)
 at java.lang.reflect.Method.invoke(Method.java:507)
 at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
 at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
 at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.IllegalArgumentException: Unable to find native library: Project
 at android.app.NativeActivity.onCreate(NativeActivity.java:187)
 at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
 at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615) 
```

似乎找不到应用程序文件“无法找到本机库：项目”

客户说他有ARMV6 CPU。我确实为 ARM5 和 ARM7 编译了应用程序。查看 APK 文件时，我可以确认我有这些文件：

```
lib/armeabi/libProject.so
lib/armeabi-v7a/libProject.so 
```

应用程序是使用最新的 Android NDK SDK 构建的，内部没有 Java 代码，只有 C++。使用 Ant 手动构建（不涉及 Eclipse）

AndroidManifest.xml

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android" package="com.esenthel.rts" android:versionCode="2" android:versionName="2">
   <uses-sdk android:minSdkVersion="9" android:targetSdkVersion="14"/>
   <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
   <uses-permission android:name="android.permission.INTERNET"/>
   <uses-permission android:name="android.permission.GET_ACCOUNTS"/>
   <uses-feature android:glEsVersion="0x00020000"/>
   <application android:label="Esenthel RTS" android:hasCode="false" android:debuggable="false" android:icon="@drawable/icon">
      <activity android:name="android.app.NativeActivity" android:label="Esenthel RTS" android:theme="@android:style/Theme.NoTitleBar.Fullscreen" android:screenOrientation="fullSensor" android:configChanges="orientation">
         <meta-data android:name="android.app.lib_name" android:value="Project"/>
         <intent-filter>
            <action android:name="android.intent.action.MAIN"/>
            <category android:name="android.intent.category.LAUNCHER"/>
         </intent-filter>
      </activity>
   </application>
</manifest> 
```

有问题的应用程序在这里[https://play.google.com/store/apps/details?id=com.esenthel.rts](https://play.google.com/store/apps/details?id=com.esenthel.rts)

让我再重复一遍，该应用程序适用于 ARM7 - Asus Transformer Prime、Htc Evo 3D、Sony Ericsson Xperia Neo、Samsung Galaxy Tab 10.1

但无法在未知的 ARM6 CPU 上启动

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T21:22:20.667

问题是客户设备上的“内存不足”，在他腾出空间后，应用程序开始工作。

# apache-flex - 如何在 Flex 中包含所有带有附加编译器选项的类

> ID：11227424
> 
> 赞同：0
> 
> 时间：2012-06-27T13:32:13.760
> 
> 标签：apache-flex

> **可能重复：**
> [如何包含额外的编译器选项“includes”和“include-libraries”？](https://stackoverflow.com/questions/11170503/how-to-include-additional-compiler-optionsincludes-and-include-libraries)

我想在我的 flex 项目中包含一个自定义包，其中包含使用附加编译器选项的数百个 fxg 对象。我可以使用哪个特定选项以及我应该如何声明？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:15:22.490

-includes 用于 MXMLC 和 -includes-classes 用于 COMPC。

# c# - 将未初始化的对象存储在数组中，然后构造？

> ID：11227426
> 
> 赞同：0
> 
> 时间：2012-06-27T13:32:15.743
> 
> 标签：c#, asp.net

我认为这在 c# 中是不可能的，但无论如何我都会发布它。

鉴于我的代码

```
Control ctrlA = null, ctrlB = null;
var ctrlCollection = new []{ctrlA, ctrlB};
for (int i = 0; i < ctrlCollection.length;i++)
ctrlCollection[i] = new Control(); 
```

是否可以构造这两个对象并让它们引用它们各自的变量（`ctrlA`和`ctrlB`）？就目前而言， ctrlA 和 ctrlB 仍将具有空引用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T13:36:50.323

不，这不对。（至少，除非您想使用指针或其他东西，否则不会）这对您有用吗？

```
var ctrlCollection = new Control[2];
for (int i = 0; i < ctrlCollection.Length; i++)
    ctrlCollection[i] = new Control();
Control ctrlA = ctrlCollection[0], ctrlB = ctrlCollection[1]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T13:35:46.200

这行不通。该集合仅存储对其内容的引用，在您的情况下`ctrlA`和`ctrlB`. 当语句`ctrlCollection[i] = new Control();`被执行时，这个引用被另一个替换。

`ctrlA`仍将指向原始`ctrlA`引用（为空），`ctrlCollection[i]`指向新初始化的`Control`对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T13:36:16.510

这与显式定义数组的长度基本相同。无需向数组添加空值，然后在数组项中使用新实例化的控件覆盖空值。

```
var ctrlCollection = new Control[2];
for (int i = 0; i < ctrlCollection.Length; i++)
    ctrlCollection[i] = new Control(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T13:40:46.540

```
var ctrlCollection = new []{ctrlA, ctrlB}; 
for (int i = 0; i < ctrlCollection.length;i++) 
{
    ctrlCollection[i] = new Control();
} 
Control ctrlA = ctrlCollection[0];
Control ctrlB = ctrlCollection[1]; 
```

无法想象您为什么要这样做，但这应该可以满足我的要求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-27T13:43:19.557

假设您的收藏大小是固定的，您可以这样做：

```
Control ctrlA, ctrlB;
var controls = new[] {
  ctrlA = new Control(),
  ctrlB = new Control()
}; 
```

这要求变量声明在与数组初始化`Control`相同的范围内。`Control`

# c - opensolaris 上的 dtrace libc 探针

> ID：11227429
> 
> 赞同：0
> 
> 时间：2012-06-27T13:32:33.887
> 
> 标签：c, dtrace, opensolaris

当我尝试跟踪 getenv 函数时，我得到了：

```
-bash-4.0#/usr/sbin/dtrace -n 'pid$target:libc:getenv:entry' -p 2017
dtrace: invalid probe specifier pid$target:libc:getenv:entry: probe description 
pid2017:libc:getenv:entry does not match any probes

-bash-4.0# /usr/sbin/dtrace -n 'pid$target:libc::entry' -p 2017
dtrace: invalid probe specifier pid$target:libc::entry: probe description pid2017:libc::entry does not match any probes 
```

来自 myapp 的 ldd：

```
libz.so.1 =>     /lib/libz.so.1
libm.so.2 =>     /lib/libm.so.2
libdl.so.1 =>    /lib/libdl.so.1
libpthread.so.1 =>   /lib/libpthread.so.1
libbz2.so.1 =>   /usr/lib/libbz2.so.1
libsocket.so.1 =>    /lib/libsocket.so.1
libnsl.so.1 =>   /lib/libnsl.so.1
libsendfile.so.1 =>  /lib/libsendfile.so.1
libxml2.so.2 =>  /lib/libxml2.so.2
libc.so.1 =>     /lib/libc.so.1
libmp.so.2 =>    /lib/libmp.so.2
libmd.so.1 =>    /lib/libmd.so.1
libscf.so.1 =>   /lib/libscf.so.1
libuutil.so.1 =>     /lib/libuutil.so.1
libgen.so.1 =>   /lib/libgen.so.1
libsmbios.so.1 =>    /usr/lib/libsmbios.so.1 
```

为什么会这样？是否有任何解决方案可以使 libc 函数能够通过 dtrace 进行跟踪？

此致

# javascript - jQuery 不响应单选检查

> ID：11227430
> 
> 赞同：1
> 
> 时间：2012-06-27T13:32:35.833
> 
> 标签：javascript, jquery, html, radio

当我检查收音机时，我希望在 jQuery 中出现一个框，但我没有标记并且没有任何反应。

这是代码。

HTML：

```
<script src="https://sites.google.com/site/lightdownloads154/jquery.alerts.js" type="text/javascript"></script>
<link rel="stylesheet" href="https://sites.google.com/site/lightdownloads154/jquery.alerts.css" type="text/css" />

<center><textarea rows="10" cols="17" style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);" wrap="soft">- Todos os links e arquivos que se encontram no blog, estão hospedados na própria Internet, somente indicamos onde se encontra.

- Qualquer arquivo protegido por algum tipo de lei deve permanecer, no máximo, 24 horas em seu computador.

- Eles podem ser baixados apenas para teste, devendo o usuário apagá-lo ou compra-lo após 24 horas.

- A aquisição desses arquivos pela internet é de única e exclusiva responsabilidade do usuário.

- Os donos, webmasters e qualquer outra pessoa que tenha relacionamento com a produção do blog não tem responsabilidade alguma sobre os arquivos que o usuário venha a baixar e para que ira utiliza-los.
</textarea><center>
<center>
<input name="accept" type="radio" id="accept" /> Eu aceito <input name="refuse" type="radio" id="refuse" /> Não aceito </center></center>
</center> 
```

​ JavaScript：

```
 $(document).ready(function() {

      $("#accept").click(function() {
          jAlert($('input[name=accept]:checked').attr('Obrigado por aceitar os Termos.'));
      });

      $("#refuse").click(function() {
          jAlert('refuse', 'Se não aceita os termos de uso retire-se do blog.', 'Termos de uso');
      });
  }); 
```

[演示](http://jsfiddle.net/neto737/XkBSv/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:39:02.943

这基本上修复了您的代码：http: [//jsfiddle.net/XkBSv/7/](http://jsfiddle.net/XkBSv/7/)

*   ~~jAlert 未在您的脚本中定义，您可能没有为此包含外部脚本。~~
*   jAlert 导致语法错误。
*   您还没有关闭导致语法错误的 ready 事件。

您可能还想将输入名称更改为相同的值，以便它们实际上可以充当单选按钮。

**更新**

jAlert 中的语法错误可能是因为它`;`在闭包之前没有，如果我在代码之前添加代码而不是 html 中的链接，它确实有效！

见[http://jsfiddle.net/XkBSv/13/](http://jsfiddle.net/XkBSv/13/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T14:00:23.013

1.  Google 将对这些文件的请求重定向到 HTML 文件，这就是您收到错误的原因：`uncaught SyntaxError: Unexpected token <`或者在此之后没有遇到任何 JavaScript 执行。

    [https://sites.google.com/site/lightdownloads154/jquery.alerts.js](https://sites.google.com/site/lightdownloads154/jquery.alerts.js) https://sites.google.com/site/lightdownloads154/jquery.alerts.css

    使用以下内容：

    [http://labs.abeautifulsite.net/archived/jquery-alerts/demo/jquery.alerts.js](http://labs.abeautifulsite.net/archived/jquery-alerts/demo/jquery.alerts.js) http://labs.abeautifulsite.net/archived/jquery-alerts/demo/jquery.alerts.css

2.  这条线什么都不做：

    `$('input[name=accept]:checked').attr('Obrigado por aceitar os Termos.')`

    jQuery 正在寻找具有名称的属性，`Obrigado por ...`并且由于它不存在，所以什么也不返回。

3.  您需要将具有相同 name 属性的单选按钮分组，并使用 value 属性进行区分。

演示：http: [//jsfiddle.net/iambriansreed/MXZJJ/](http://jsfiddle.net/iambriansreed/MXZJJ/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-27T13:45:33.297

尝试这个：

```
 <!DOCTYPE html>
        <html>
        <head>
            <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
            <link href="http://labs.abeautifulsite.net/archived/jquery-alerts/demo/jquery.alerts.css" rel="stylesheet" type="text/css"/>

            <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
            <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
            <script src="http://labs.abeautifulsite.net/archived/jquery-alerts/demo/jquery.alerts.js"></script>

            <script>
                $(document).ready(function() {

                    $("#accept").change(function() {
                        if($(this).attr("checked")){
                            jAlert('This is a custom alert box', 'Radio accept selected');
                        }

                    });

                    $("#refuse").change(function() {
                        if($(this).attr("checked")){
                            jAlert('This is a custom alert box', 'Radio refuse selected');

                        }

                    });

                });

            </script>
        </head>
        <body style="font-size:62.5%;">

        <input  type="radio" name = "radioGroup" id="accept" value="accepted" /> Accepted
<input  type="radio" name = "radioGroup" id="refuse" value="rejected" /> Not Accepted </center></center>

        </body>
        </html> 
```

# ios - UITableViewController 总是显示搜索栏

> ID：11227435
> 
> 赞同：0
> 
> 时间：2012-06-27T13:32:45.247
> 
> 标签：ios, uitableview, search

在 iOS 5 中，有没有办法永远不隐藏搜索栏`UITableViewController`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-27T13:35:35.807

`UITableViewController`那时我不会推荐 a ，`UIViewController`a在它上面而不是在标题上的 a 就可以完成这项工作。在更个人的观点中，我不会推荐任何东西，我觉得它对它真正提供的东西太严格了。如果出于某种原因我正在使用 a并且客户要求我在屏幕上添加一个新元素，那我基本上就完蛋了。`UITableVIew``UISearchBar``UITableViewController``UITableViewController`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-05T17:05:32.303

我知道这是一个老问题，但我找到了一个解决方案，它适用于经典的 UITableViewController 和 UTSearchDisplayController。

我为 searchBar 1st 创建了一个容器视图，然后将搜索栏放入其中。容器不得裁剪到边界。在此之后，您可以更改搜索栏相对于容器的位置。这样做的一个问题是，搜索栏无法处理用户交互。所以我们需要使用我们自己的容器来获取低于其真实框架的事件。

我们的容器类：

```
@interface _SearchContainerView : UIView
@end

@implementation _SearchContainerView
- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event {
    if (self.subviews.count > 0) {
        UISearchBar *searchBar = (UISearchBar *) self.subviews[0];
        CGRect f = searchBar.frame;
        f = CGRectMake(0, 0, f.size.width, f.origin.y + f.size.height);
        if (CGRectContainsPoint(f, point)) return YES;
    }
    return [super pointInside:point withEvent:event];
}
@end 
```

如果您以编程方式创建 searchBar，则可以使用以下类似代码进行设置：

```
- (void)setSearchEnabled:(BOOL)searchEnabled {
    if (searchBar == nil && searchEnabled) {
        searchBar = [[UISearchBar alloc] initWithFrame:CGRectMake(0, 0, self.tableView.bounds.size.width, 44)];
        searchDisplayController = [[UISearchDisplayController alloc] initWithSearchBar:searchBar
                                                                contentsController:self];
        searchBar.autoresizingMask = UIViewAutoresizingFlexibleLeftMargin | UIViewAutoresizingFlexibleTopMargin
                                     | UIViewAutoresizingFlexibleRightMargin | UIViewAutoresizingFlexibleWidth;
        searchDisplayController.delegate = self;
        searchDisplayController.searchResultsDataSource = self;

        searchContainer = [[_SearchContainerView alloc] initWithFrame:searchBar.frame];
        [container addSubview:searchBar];
        container.clipsToBounds = NO;

        self.tableView.tableHeaderView = container;

    }  else {
        [searchBar removeFromSuperview];
        self.tableView.tableHeaderView = nil;
        searchBar = nil;
        searchDisplayController = nil;
        searchContainer = nil;
    }
} 
```

然后可以根据tableView的滚动位置来改变位置：

```
-(void)scrollViewDidScroll:(UIScrollView *)scrollView {
    if (searchBar == nil || searchDisplayController.isActive) return;
    CGRect b = self.tableView.bounds;
    // Position the searchbar to the top of the tableview
    searchBar.frame = CGRectMake(0, b.origin.y, b.size.width, 44);
} 
```

最后一部分是搜索后恢复所有内容：

```
- (void)searchDisplayControllerDidEndSearch:(UISearchDisplayController *)controller {
    // Restore header alpha
    searchContainer.alpha = 1.0;
    // Place the searchbar back to the tableview
    [searchBar removeFromSuperview];
    [searchContainer addSubview:searchBar];
    // Refresh position and redraw
    CGPoint co = self.tableView.contentOffset;
    [self.tableView setContentOffset:CGPointZero animated:NO];
    [self.tableView setContentOffset:co animated:NO];
} 
```

# android - 如何为文件设置图标？

> ID：11227441
> 
> 赞同：0
> 
> 时间：2012-06-27T13:33:05.033
> 
> 标签：android

我正在创建不同类型的文件。例如文件扩展名为.txt、.doc、.xml、.java、.jpg、.png等。如何设置与文件匹配的图标。例如，我正在创建一个 pdf 文件。如何将 pdf 图标设置为该 pdf 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:39:40.470

您不必为文件显式设置图标，除非您使用自己的扩展名创建文件。

操作系统将理解文件类型并相应地绑定图标。

这就是为什么在 Windows 中，如果您手动更改文件的扩展名，图标会自动更改。同样的情况也适用于 Android。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:57:44.877

如果您想通过您的 android 应用程序创建不同的文件并希望显示文件列表以及我们可以在 Windows 操作系统中看到的图标，那么您必须将每个文件扩展名的所有不同图像放在可绘制文件夹中。示例 - pdfImage.png、jpgImage.png、pngImage.png 等。现在您必须处理文件名以确定文件扩展名运行时。然后更新您的 iconView （一个`ImageView`项目），如：

```
iconView.setImageBitmap(bitmap); // bitmap is the Bitmap image 
```

或者

```
iconView.setBackgroundResource(R.drawable.pdfImage_icon); 
```

# java - Android 和 JSOUP 入门

> ID：11227443
> 
> 赞同：-1
> 
> 时间：2012-06-27T13:33:08.937
> 
> 标签：java, javascript, android, html, jsoup

我目前正在尝试制作一个 Android 应用程序并得出结论，我必须使用 JSOUP 来完成它。我正在使用 JSOUP 从 Internet 中提取数据，然后将其发布到我的应用程序上。

我想弄清楚的是如何从 url 中提取多位数据，然后在他们自己的 XML String TextView 中使用它们中的每一个（如果这是正确的？）

这是我要提取的 HTML 的片段。

* * *

a href="http://www.campusdish.com/en-US/CSMA/OldDominion/Locations/rda.aspx?RCN=m12296&MI=122&RN=BACoN TURKEY SLICED" OnCick="javascript: NewWindow('http:// www.campusdish.com/en-US/CSMA/OldDominion/Locations/rda.aspx?RCN=m12296&MI=122&RN=BACON TURKEY SLICED', 'RDA_window', 'width=450, height=600, scrollbars=no, toolbar=否，目录=否，状态=否，菜单栏=否，copyhistory=no');return false" Class="recipeLink">BACON TURKEY SLICED

* * *

我正在尝试提取单词*BACON TURKEY SLICED*

问题是我根本不懂 JSOUP。就像我对它有一个想法，但我似乎无法实际使用它等等。我想知道是否有人可以尝试推动我朝着正确的方向前进。

另外，我试过阅读食谱，但没有成功。

如果有人可以提供帮助，非常感谢！

## 编辑

这里还有两个。我相信它们是完全相同的东西。

a href="http://www.campusdish.com/en-US/CSMA/OldDominion/Locations/rda.aspx?RCN=m4903&MI=122&RN=STATION OMELET" OnClick="javascript: NewWindow('http://www .campusdish.com/en-US/CSMA/OldDominion/Locations/rda.aspx?RCN=m4903&MI=122&RN=STATION OMELET', 'RDA_window', 'width=450, height=600, scrollbars=no, toolbar=no,目录=no, status=no, menubar=no, copyhistory=no');return false" Class="recipeLink">STATION OMELET

a href="http://www.campusdish.com/en-US/CSMA/OldDominion/Locations/rda.aspx?RCN=m784&MI=122&RN=CEREAL HOT GRITS" OnClick="javascript: NewWindow('http:// www.campusdish.com/en-US/CSMA/OldDominion/Locations/rda.aspx?RCN=m784&MI=122&RN=CEREAL HOT GRITS', 'RDA_window', 'width=450, height=600, scrollbars=no, toolbar=否，目录=否，状态=否，菜单栏=否，copyhistory=no');return false" Class="recipeLink">CEREAL HOT GRITS

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:46:42.093

因此，此答案将假设您对以下内容感兴趣：

*   <a href=".." >你想要的文字</a>
*   所有这些 <a> 标签都有`style`属性“recipeLink”。

给定你的例子，这里是一个字符串：

```
String tastyTurkeySandwich= "<a href=\"http://www.campusdish.com/en-US/CSMA/OldDominion/Locations/rda.aspx?RCN=m12296&amp;MI=122&amp;RN=BACoN  TURKEY  SLICED\" OnCick=\"javascript: NewWindow('http://www.campusdish.com/en-US/CSMA/OldDominion/Locations/rda.aspx?RCN=m12296&amp;MI=122&amp;RN=BACON  TURKEY  SLICED', 'RDA_window',  'width=450, height=600, scrollbars=no, toolbar=no,  directories=no, status=no, menubar=no, copyhistory=no');return false\" Class=\"recipeLink\">BACON  TURKEY  SLICED</a>"; 
```

您可以使用以下代码提取（第一个）文本：

```
Document doc = Jsoup.parse(tastyTurkeySandwich);
Elements links = doc.select("a[href].recipeLink");
// This will just print the text in the first one
System.out.println(links.first().text()); 
```

迭代一个`Elements`（实现`Iterable`接口的）实例：

```
for (Element link : links) {
    // Calling link.text() will return BACON TURKEY SLICED etc. etc.
    System.out.println(link.text());
} 
```

简而言之：

1.  `a[href]`将匹配所有具有 href 属性的 <a> 标记。
2.  该`.recipeLink`部分将过滤该选择以仅包含具有 recipeLink 样式的链接。

# java - 使用现有 GoogleMap API 的 Android MapView

> ID：11227446
> 
> 赞同：0
> 
> 时间：2012-06-27T13:33:22.600
> 
> 标签：java, android, google-maps, maps, android-mapview

我搜索了 SO 和 Google，但没有找到任何答案。

我正在传递以下数据，需要在 android 中显示它。 [http://maps.google.com/maps/ms?msid=214791092532835797516.0004bc20df4e3c6ddf92a&msa=0&ll=52.812827,-2.079865&spn=0.003761,0.011689&](http://maps.google.com/maps/ms?msid=214791092532835797516.0004bc20df4e3c6ddf92a&msa=0&ll=52.812827,-2.079865&spn=0.003761,0.011689&amp)

目前，我将它显示在一个以 IFrame 作为其唯一元素的 web 视图中。但我真的需要在 MapView 中显示它。我创建了一个 MapView 并让它工作。我现在需要在 MapView 中显示数据，如上面的 url 所示。

虽然我可以看到纬度/经度值，但是否可以获取自定义地图并将其添加到 MapView 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T07:58:47.260

尝试从 URL 获取 KML 文件，msid 将匹配。

[https://maps.google.com/maps/ms?msid=214791092532835797516.0004bc20df4e3c6ddf92a&msa=0&ll=52.812827,-2.079865&spn=0.003761,0.011689](https://maps.google.com/maps/ms?msid=214791092532835797516.0004bc20df4e3c6ddf92a&msa=0&ll=52.812827,-2.079865&spn=0.003761,0.011689)

KML 文件的链接为：[https ://maps.google.com/maps/ms?ie=UTF8&authuser=0&msa=0&output=kml&msid=214791092532835797516.0004bc20df4e3c6ddf92a](https://maps.google.com/maps/ms?ie=UTF8&authuser=0&msa=0&output=kml&msid=214791092532835797516.0004bc20df4e3c6ddf92a)

您必须解析 KML 以获取位置

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://earth.google.com/kml/2.2">
<Document>
  <name>Untitled</name>
  <description><![CDATA[]]></description>
  <Style id="style3">
    <IconStyle>
      <Icon>
        <href>http://maps.gstatic.com/mapfiles/ms2/micons/blue-dot.png</href>
      </Icon>
    </IconStyle>
  </Style>
  <Style id="style2">
    <IconStyle>
      <Icon>
        <href>http://maps.gstatic.com/mapfiles/ms2/micons/blue-dot.png</href>
      </Icon>
    </IconStyle>
  </Style>
  <Style id="style1">
    <IconStyle>
      <Icon>
        <href>http://maps.gstatic.com/mapfiles/ms2/micons/blue-dot.png</href>
      </Icon>
    </IconStyle>
  </Style>
  <Placemark>
    <name>The Octagon</name>
    <description><![CDATA[<div dir="ltr">This is the description for the octagon</div>]]></description>
    <styleUrl>#style3</styleUrl>
    <Point>
      <coordinates>-2.081995,52.812881,0.000000</coordinates>
    </Point>
  </Placemark>
  <Placemark>
    <name>Sports centre</name>
    <description><![CDATA[<div dir="ltr">This is the description for the sports centre</div>]]></description>
    <styleUrl>#style2</styleUrl>
    <Point>
      <coordinates>-2.080439,52.812202,0.000000</coordinates>
    </Point>
  </Placemark>
  <Placemark>
    <name>Blackheath lane</name>
    <description><![CDATA[]]></description>
    <styleUrl>#style1</styleUrl>
    <Point>
      <coordinates>-2.072489,52.813522,0.000000</coordinates>
    </Point>
  </Placemark>
</Document>
</kml> 
```

我想这会从 URL 中获取您的位置，但我不确定如何轻松自定义 android 地图。

更新：

解析 KML 文件，stackoverflow 链接： [如何使用 kml 文件在地图上绘制路径？](https://stackoverflow.com/questions/3109158/how-to-draw-a-path-on-a-map-using-kml-file/3109723#3109723)

# php - 使用选择框在 html 中显示 mysql 数据 没有用jquery刷新页面的标签

> ID：11227449
> 
> 赞同：0
> 
> 时间：2012-06-27T13:33:30.140
> 
> 标签：php, jquery, mysql

我正在尝试在 ul li 标签中填充 mysql 表。我不可能成功。我不知道如何使用 jquery 来获取 mysql 数据。你们能帮帮我吗？我在 getdata.php 上得到了我的结果，没有任何问题。但是，如果不刷新页面，我无法成功在 main.php 中显示结果。

主文件

```
 <form name="cnt" id="cnt" action="get_shipping_price.php" method="Post" >
                          <select id="c_list" name="country" style="width:160px;" onChange="this.form.submit()">
            <?php
            $countries = $database->getCountry();
            foreach ($countries as $country) {
                echo '<option value="' . $country['printable_name'] . '" ' . ($req_user_info['country'] == $country['numcode'] ? 'selected="selected"' : '') . '>' . $country['printable_name'] . '</option>';
            }
         ?>
            </select>
            </form>

    <!-- result list box -->
               <div id="result_box">
                   <ul>
                        <li class="blue_heading">A</li>
                            <li class="blue_heading">O / E</li>
                            <li class="blue_heading">I / I</li>
                            <li class="lgray_lis"></li>
                            <li class="lgray_lis"></li>
                            <li class="lgray_lis"></li>
                            <li class="dgray_lis"></li>
                            <li class="dgray_lis"></li>
                            <li class="dgray_lis"></li>
                    </ul>
                </div> 
```

获取数据.php

```
<?php
include("include/database.php");
if(isset($_POST['country']) )
{
  $cnt_id = $_POST['country'];

 $result = $database->select("Select * From zone Where DHL = '$cnt_id' "); 
  foreach ($result as $row) {
   $row['zone'];
  }
}

 $result = $database->select("Select * From price_in_dis");

  foreach ($result as $indis)   
{ 
  if ($row['zone'] == 1)
    {

    echo "<ul>";
    echo "<li>" .'y'.$indis['A']. "</li>"; 

    echo "</ul>";

  }

   if ($row['zone'] == 2)
     {
    echo "<ul>";
    echo "<li>" .$dis['C']. "</li>" ;
    echo "</ul>";

  }

   if ($row['zone'] == 3)
    {

    echo "<ul>";
    echo "<li>" .$dis['D']. "</li>" ;
    echo "</ul>";

  }

}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:34:05.960

我看到3个选项，

*   使用表单或其他东西提交值。

*   使用传递变量值的链接使 Li 可点击。

*   使用 Ajax 和 Jquery 在“点击提交”上制作一些功能。有很多不同的方法可以做到这一点，例如，您可以创建一个隐藏的表单。（只有在客户端和服务器双方都添加一些安全性时，我才推荐这个）

无论如何，您都需要一个 php 文件，不同之处在于您传递参数的方式。

# c# - 获取 ListView 中对象的数据库 ID 并从用户控件 ListView 更新 ListView

> ID：11227450
> 
> 赞同：2
> 
> 时间：2012-06-27T13:33:30.593
> 
> 标签：c#, asp.net, listview

我正在创建一个网站，并面临以下问题。我有 2 个列表视图。第一个 ListView 位于名为 Sidebar.ascx 的用户控件中：

```
<asp:ListView ID="sidebarListView" runat="server" DataKeyNames="Id" DataSourceID="SqlDataSourceSidebar">
 <ItemTemplate>
  <div class="sidebarItem" runat="server">
     <div>
        <asp:Label ID="NameLabel" runat="server" Text='<%# Eval("Name") %>' />
     </div>
  </div>
 </ItemTemplate>
 <LayoutTemplate>
  <div class="sidebarMain">
     <asp:PlaceHolder runat="server" ID="itemPlaceHolder" />
  </div>
 </LayoutTemplate>
</asp:ListView>

<asp:SqlDataSource ID="SqlDataSourceSidebar" runat="server" ConnectionString="<%$ ConnectionStrings:TudengiDBConnectionString %>" SelectCommand="SELECT [Id], [Name] FROM [Faculties] ORDER BY [Name]"></asp:SqlDataSource> 
```

它必须只显示名称。

第二个列表视图在我的 Default.aspx 中

```
<asp:UpdatePanel runat="server" UpdateMode="Conditional">
  <ContentTemplate>
     <asp:ListView ID="RecentItemsListView" runat="server" DataSourceID="SqlDataSource1"
        GroupItemCount="3">
        <LayoutTemplate>
           <div class="recentItemsMain">
              <asp:PlaceHolder runat="server" ID="groupPlaceHolder" />
           </div>
           <asp:DataPager ClientIDMode="Static" ID="DataPager1" runat="server" PageSize="9">
              <Fields>
                 <asp:NumericPagerField />
              </Fields>
           </asp:DataPager>
        </LayoutTemplate>
        <GroupTemplate>
           <div class="recentItems">
              <asp:PlaceHolder runat="server" ID="itemPlaceHolder" />
           </div>
        </GroupTemplate>
        <ItemTemplate>
           <div class="recentItem" runat="server">
              <div>
                 <asp:Image ID="PictureThumb" runat="server" ImageUrl='<%#CreateThumbnail((string)Eval("Picture"),130,130) %>' />
              </div>
              <asp:Label ID="AuthorLabel" runat="server" Text='<%# Eval("Author") %>' />
              <div>
                 <asp:Label ID="NameLabel" runat="server" Text='<%# Eval("Name") %>' />
              </div>
           </div>
        </ItemTemplate>
        <GroupSeparatorTemplate>
           <div class="groupSeparator">
           </div>
        </GroupSeparatorTemplate>
     </asp:ListView>

  </ContentTemplate>
</asp:UpdatePanel>

<asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionStrings:TudengiDBConnectionString %>" SelectCommand="SELECT [Id], [Name], [Faculty_Id], [User_Id], [Author], [Picture], [Location] FROM [Books] ORDER BY [DateAdded] DESC"> 
```

我需要的是 Default.aspx 中的 ListView 在没有 WHERE 子句的情况下显示数据，但是当在侧边栏用户控件中单击项目时，我需要更新 Default.aspx ListView 以仅显示 [Faculty_Id] 所在的数据= 用户控件中 ListView 项的 ID。

当我只能显示 NAME 字段时，如何获取 ListView 对象的数据库 ID？我是否也必须显示 ID，然后对用户隐藏该列？解决这种情况的正确方法是什么？

感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T15:46:30.067

```
<asp:ListView ID="sidebarListView" runat="server" DataKeyNames="Id" DataSourceID="SqlDataSourceSidebar" OnItemCommand="sidebarListView_ItemCommand">
<ItemTemplate>
  <div class="sidebarItem" runat="server">
     <div>
        <asp:LinkButton ID="NameLabel" runat="server" Text='<%# Eval("Name") %>' CommandName="Select" CommandArgument='<%# Eval("Id") %>' />
     </div>
  </div>
</ItemTemplate> 
```

这就是我最终的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:39:12.147

您可以做的是向`NameLabel`控件添加一个属性。例如调用它`myID`：

```
<asp:Label ID="NameLabel" runat="server" Text='<%# Eval("Name") %>' myID='<%# Eval("ID") %>'/> 
```

然后从您的代码中访问该属性以获取您的 ID：

```
string ID = NameLabel.Attributes["myID"]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T13:52:27.527

向您的项目模板添加一个隐藏字段以保存数据库 ID。

```
<ItemTemplate>
   <asp:HiddenField ID="hdnFacultyID" runat="server" Value='<%# Eval("FacultyID") %>' />
   <div class="recentItem" runat="server">
   ...
   </div>
 </ItemTemplate> 
```

在适当的 ListView 处理程序中，您可以像这样访问数据库 ID。

```
((HiddenField)e.item.FindControl("hdnFacultyID")).Value 
```

# c# - NHibernate.MappingException：没有持久性：NHibernateExperiment.Player - 我找不到解决方案

> ID：11227456
> 
> 赞同：3
> 
> 时间：2012-06-27T13:33:58.033
> 
> 标签：c#, .net, nhibernate

我尝试使用 NHibernate ORM 制作一个项目，有一次当我认为我完成了所有工作时，它给了我一个**NHibernate.MappingException: No persister for** exception 我读到问题可能是我没有添加程序集在配置文件中，但我这样做了，而且它也没有修复......

如果有人有一点时间，请帮助我解决问题。

这是**我**用来添加新 Player 对象的代码

```
private void btnInsert_Click(object sender, EventArgs e)
        {
            Player playerData = new Player();
            SetPlayerInfo(playerData);

            using (ISession session = SessionFactory.OpenSession)
            {
                using (ITransaction transaction = session.BeginTransaction())
                {
                    try
                    {
                        session.Save(playerData); // here it spits
                        transaction.Commit();
                        GetPlayerInfo();
                    }
                    catch (Exception ex)
                    {
                        transaction.Rollback();
                        throw ex;
                    }
                }
            }

        }

private void GetPlayerInfo()
        {
            using (ISession session = SessionFactory.OpenSession)
            {
                IQuery query = session.CreateQuery("FROM Player");
                IList<Player> pInfos = query.List<Player>();
                dgvDisplay.DataSource = pInfos;
            }
        }

private void SetPlayerInfo(Player playerData)
        {
            playerData.PlayerName = tbxName.Text;
            playerData.PlayerAge = Convert.ToInt32(tbxAge.Text);
            playerData.DOJ = Convert.ToDateTime(dtpDOJ.Text);
            playerData.BelongsTo = cmbBelongsTo.SelectedItem.ToString();
        } 
```

这里是映射**Player.hbm.xml**代码

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" auto-import="true">
  <class name="NHibernateExperiment.Player, NHibernateExperiment" lazy="true">
    <id name="PlayerId">
      <generator class="native"/>
    </id>
    <property name="PlayerName" column ="PlayerName"/>
    <property name="PlayerAge" column ="PlayerAge"/>
    <property name="DOJ" column="DOJ"/>
    <property name="BelongsTo" column="BelongsTo"/>
  </class>

</hibernate-mapping> 
```

这是**App.config**代码

```
 <configuration>
  <configSections>
    <section name="hibernate-configuration" type="NHibernate.Cfg.ConfigurationSectionHandler, NHibernate" />
  </configSections>
  <hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
    <session-factory>
      <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
      <property name="connection.driver_class">NHibernate.Driver.SqlClientDriver</property>
      <property name="connection.connection_string">Server=GRITCAN;database=testDB;Integrated Security=SSPI;</property>
      <property name="dialect">NHibernate.Dialect.MsSql2008Dialect</property>
      <property name="show_sql">true</property>          
      <property name='proxyfactory.factory_class'>NHibernate.ByteCode.LinFu.ProxyFactoryFactory, NHibernate.ByteCode.LinFu</property>          
    </session-factory>
  </hibernate-configuration>
</configuration> 
```

这是**堆栈跟踪**

在 NHibernateExperiment.Form1.btnInsert_Click(Object sender, EventArgs e) 在 E:\projects\tests\NHibernate\NHibernateExperiment\NHibernateExperiment\Form1.cs: 系统中 System.Windows.Forms.Control.OnClick(EventArgs e) 的第 72 行。 Windows.Forms.Button.OnClick(EventArgs e) 在 System.Windows.Forms.Button.OnMouseUp(MouseEventArgs 事件) 在 System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks) 在 System.Windows。 Forms.Control.WndProc(Message& m) 在 System.Windows.Forms.ButtonBase.WndProc(Message& m) 在 System.Windows.Forms.Button.WndProc(Message& m) 在 System.Windows.Forms.Control.ControlNativeWindow.OnMessage( Message& m) 在 System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) 在 System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam,IntPtr lparam) 在 System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG& msg) 在 System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr dwComponentID, Int32 reason, Int32 pvLoopData) 在System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context) 在 System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context) 在 System.Windows.Forms.Application.Run(Form mainForm ) 在 E:\projects\tests\NHibernate\NHibernateExperiment\NHibernateExperiment\Program.cs:第 16 行中的 NHibernateExperiment.Program.Main() System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args) 在 System.AppDomain.ExecuteAssembly （字符串 assemblyFile，证据 assemblySecurity，String[] args) 在 Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly() 在 System.Threading.ThreadHelper.ThreadStart_Context(Object state) 在 System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)在 System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) 在 System.Threading.ThreadHelper.ThreadStart()对象状态）在 System.Threading.ThreadHelper.ThreadStart()对象状态）在 System.Threading.ThreadHelper.ThreadStart()

我在 **NHibernate.dll**和**NHibernate.ByteCode.LinFu.dll项目中添加了以下 2 个引用**

**非常感谢你的帮助！**

* * *

谢谢你们。**.hbm.xml**文件的**构建操作**是**Content**。正如你建议我的那样，我将其更改为**嵌入式资源**并且一切正常:)

 ******* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T13:38:57.057

您是否使映射文件成为嵌入式资源？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T13:45:15.270

检查 xml 映射是否被标记为嵌入资源。此外，我建议您使用 Fluent nHibernate 库 - 这是一种无需编写大量 xml 映射的自由，只有 .net 类

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-24T16:55:10.610

工作解决方案：

**Form1.cs** 使用 NHibernate；使用 NHibernate.Cfg; 使用系统；使用 System.Collections.Generic；使用 System.ComponentModel；使用 System.Data；使用 System.Drawing；使用 System.Linq；使用 System.Text；使用 System.Threading.Tasks；使用 System.Windows.Forms；

```
namespace NHibernateTutorialPart1
{
    public partial class Form1 : Form
    {

        private Configuration myConfiguration;
        private ISessionFactory mySessionFactory;
        private ISession mySession;

        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            myConfiguration = new Configuration();
            myConfiguration.Configure("hibernate_mysql.cfg.xml");
            mySessionFactory = myConfiguration.BuildSessionFactory();
            mySession = mySessionFactory.OpenSession();

            using (mySession.BeginTransaction())
            {
                Contact lbContact=new Contact{FirstName="Nisha", LastName="Shrestha",ID=0};
                mySession.Save(lbContact);
                mySession.Transaction.Commit();
            }
        }
    }
}

**hibernate_mysql.cfg.xml**

<?xml version="1.0" encoding="utf-8" ?>
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
  <session-factory>
    <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
    <property name="dialect">NHibernate.Dialect.MySQLDialect</property>
    <property name="connection.driver_class">NHibernate.Driver.MySqlDataDriver</property>
    <property name="connection.connection_string">
      User Id=root;
      Server=localhost;
      Password=Password1;
      Database=nhibernatecontacts;
    </property>

    <!--This is good for Debugging but not otherwise-->
    <property name="show_sql">true</property>

    <!--<property name="proxyfactory.factory_class">NHibernate.ByteCode.LinFu.ProxyFactoryFactory, NHibernate.ByteCode.LinFu</property>-->
    <mapping assembly="NHibernateTutorialPart1"/>
  </session-factory>
</hibernate-configuration>

**contact.hbm.xml**

<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   assembly="NHibernateTutorialPart1"
                   namespace="NHibernateTutorialPart1">
  <class name="Contact" table="contact">
    <id name="ID" column="ID">
      <generator class="identity" />
    </id>
    <property name="FirstName" />
    <property name="LastName" />
  </class>
</hibernate-mapping>

**Contact class**

namespace NHibernateTutorialPart1
{
    public class Contact
    {

        public virtual int ID { get; set; }
        public virtual string FirstName { get; set; }
        public virtual string LastName { get; set; }

    }
}

**App.config**

<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
    <section name="hibernate-configuration" type="NHibernate.Cfg.ConfigurationSectionHandler,NHibernate"/>
  </configSections>
</configuration>

You need to add reference for lesi.collection and NHibernate
You need to do embeded resource for contact.hbm.xml and hibernate_mysql.cfg.xml 
```

我使用了 mysql 工作台，在其中创建了一个新模式和一个带有 id、名字和姓氏的新表。

No persister for exception 的解决方案是我忘记在 contact.hbm.xml 中给出表名******

# android - 在 Android 应用程序中显示多语言字符

> ID：11227460
> 
> 赞同：2
> 
> 时间：2012-06-27T13:34:12.010
> 
> 标签：android, html-parsing, json, multilingual

我的回复中出现了多语言字符。其中一些的HTML代码是中国（中文）日本（日语），हिंदी印地语[印度]），한국의（韩语）。如何在我的应用程序中显示这些字符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T15:24:35.430

这将帮助您尝试

```
public class MultiLanguageActivity extends Activity {
TextView china;
String ch="&#25490;&#39592;&#27927;&#20928;&#65292;&#20999;&#22359;&#65292;";
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    china=(TextView)findViewById(R.id.chinese);
        china.setText(Html.fromHtml(ch));
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T13:56:13.190

您可以使用 textView.setText(Html.fromHtml(yourInstance.toString()));，我认为它可以解决您的问题

# javascript - 一个更简单的正则表达式来解析带引号的字符串

> ID：11227463
> 
> 赞同：7
> 
> 时间：2012-06-27T13:34:20.447
> 
> 标签：javascript, regex

问题很简单。我有一个包含多个元素的字符串，这些元素嵌入在单引号中：

```
var str = "'alice'   'anna marie' 'benjamin' 'christin'     'david' 'muhammad ali'" 
```

我想解析它，以便将所有这些名称放在一个数组中：

```
result = [
 'alice',
 'anna marie',
 'benjamin',
 'christin',
 'david',
 'muhammad ali'
] 
```

目前我正在使用此代码来完成这项工作：

```
var result = str.match(/\s*'(.*?)'\s*'(.*?)'\s*'(.*?)'\s*'(.*?)'/); 
```

但是这个正则表达式太长而且不灵活，所以如果`str`字符串中有更多的元素，我必须编辑正则表达式。

进行此解析的最快和最有效的方法是什么？性能和灵活性在我们的 Web 应用程序中很重要。

我看过以下问题，但它们不是我的答案：

*   [带引号的字符串的正则表达式](https://stackoverflow.com/questions/3364041/regular-expression-for-quoted-string)
*   [正则表达式 - 如何查找单词和引用的短语](https://stackoverflow.com/questions/3095501/regular-expression-how-to-find-words-and-quoted-phrases)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-27T13:38:25.773

定义一次模式并使用全局`g`标志。

```
var matches = str.match(/'[^']*'/g); 
```

如果您希望标记周围没有单引号，通常的方法是在 REGEX 中使用子匹配 - 但是 JavaScript 不支持在使​​用`g`标志时捕获子组。解决此问题的最简单（尽管不一定最有效）的方法是在之后迭代地删除它们：

```
if (matches)
    for (var i=0, len=matches.length; i<len; i++)
        matches[i] = matches[i].replace(/'/g, ''); 
```

[编辑] - 正如其他答案所说，您可以`split()`改用，但前提是您可以依赖字符串中的每个标记之间始终存在一个空格（或一些通用分隔符）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T14:03:23.530

当正则表达式对象`global`设置了标志时，您可以针对一个字符串多次执行它以查找所有匹配项。它通过在上次运行中匹配的最后一个字符之后开始下一次搜索来工作：

```
var buf = "'abc' 'def' 'ghi'";
var exp = /'(.*?)'/g;
for(var match=exp.exec(buf); match!=null; match=exp.exec(buf)) {
  alert(match[0]);
} 
```

就个人而言，我发现它是解析字符串的一种非常好的方法。

**编辑：**表达式`/'(.*?)'/g`匹配单引号（'）之间的任何内容，修饰符`*?`是非贪婪的，它大大简化了模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-26T19:24:11.923

# 不同的方法

我来到这里需要一种方法，可以解析引号和非引号的字符串，保留引号和非引号的顺序，然后将其与围绕它们的特定标签一起输出以用于 React 或 React Native 所以我最终没有在这里使用答案，因为我不确定如何让它们满足我的需要，然后改为这样做。

```
function parseQuotes(str) {
  var openQuote = false;
  var parsed = [];
  var quote = '';
  var text = '';
  var openQuote = false;

  for (var i = 0; i < str.length; i++) {
    var item = str[i];
    if (item === '"' && !openQuote) {
      openQuote = true;
      parsed.push({ type: 'text', value: text });
      text = '';
    }
    else if (item === '"' && openQuote) {
      openQuote = false;
      parsed.push({ type: 'quote', value: quote });
      quote = '';
    }
    else if (openQuote) quote += item;
    else text += item;  
  }

  if (openQuote) parsed.push({ type: 'text', value: '"' + quote });
  else parsed.push({ type: 'text', value: text });

  return parsed;
} 
```

当给出这个时：

```
'Testing this "shhhh" if it "works!" " hahahah!' 
```

产生：

```
[
  {
    "type": "text",
    "value": "Testing this "
  },
  {
    "type": "quote",
    "value": "shhhh"
  },
  {
    "type": "text",
    "value": " if it "
  },
  {
    "type": "quote",
    "value": "works!"
  },
  {
    "type": "text",
    "value": " "
  },
  {
    "type": "text",
    "value": "\" hahahah!"
  }
] 
```

这使您可以轻松地将标签包装在它周围，具体取决于它是什么。

[https://jsfiddle.net/o6seau4e/4/](https://jsfiddle.net/o6seau4e/4/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T13:45:25.063

单程;

```
var str = "'alice' 'benjamin' 'christin' 'david'";
var result = {};

str.replace(/'([^']*)'/g, function(m, p1) {
    result[p1] = "";
});

for (var k in result) {
    alert(k);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-19T17:02:29.053

如果有人来到这里并需要更复杂的字符串解析，包括单引号或双引号以及转义引号的能力，这就是正则表达式。在 JS 和 Ruby 中测试。

```
r = /(['"])((?:\\\1|(?!\1).)*)(\1)/g
str = "'alice'  ddd vvv-12 'an\"na m\\'arie' \"hello ' world\" \"hello \\\" world\" 'david' 'muhammad ali'"
console.log(str.match(r).join("\n"))
  'alice'
  'an"na m\'arie'
  "hello ' world"
  "hello \" world"
  'david'
  'muhammad ali' 
```

请参阅未找到未引用的字符串。如果目标是还要找到非引号单词，那么一个小修复就可以了：

```
r = /(['"])((?:\\\1|(?!\1).)*)(\1)|([^'" ]+)/g
console.log(str.match(r).join("\n"))
  'alice'
  ddd
  vvv-12
  'an"na m\'arie'
  "hello ' world"
  "hello \" world"
  'david'
  'muhammad ali' 
```

# spring-security - 从 spring-security.xml 文件中禁用 Spring Security

> ID：11227464
> 
> 赞同：7
> 
> 时间：2012-06-27T13:34:21.027
> 
> 标签：spring-security

请帮助我的建议。

我需要通过 xml 文件中的某个变量在我的应用程序上禁用/启用 spring 安全性。

我的 spring-security.xml 文件

```
<beans:beans xmlns="http://www.springframework.org/schema/security"
xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.springframework.org/schema/beans 
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/security 
    http://www.springframework.org/schema/security/spring-security-3.1.xsd">

<http auto-config="true">
    <intercept-url pattern="/*" access="ROLE_ADMIN" />
    <logout logout-success-url="/mainpage" />
            <login login-success-url="/mainpage" />
</http>

<authentication-manager>
    <authentication-provider>
        <user-service>
            <user name="hey" password="there" authorities="ROLE_ADMIN" />
        </user-service>
    </authentication-provider>
</authentication-manager> 
```

怎么可能做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-27T13:42:29.460

> 安全
> 
> 通过将此属性设置为 none，可以将请求模式映射到空过滤器链。不会应用任何安全性，并且 Spring Security 的任何功能都将不可用。

[http://static.springsource.org/spring-security/site/docs/3.1.x/reference/appendix-namespace.html#nsa-http-security](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/appendix-namespace.html#nsa-http-security)

所以：

```
<http auto-config="true" security="none"> 
```

和往常一样，“none”参数可以是一个springEL表达式（无论如何都是一个子集）。

希望这就是你要找的

编辑：

忘了说它的新特性是 Spring Security 3.1

[http://static.springsource.org/spring-security/site/docs/3.1.x/reference/new-3.1.html#new-3.1-highlevel](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/new-3.1.html#new-3.1-highlevel)

编辑2：

对于更动态的解决方案，请使用 bean 配置文件。[http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/new-in-3.1.html#d0e1293](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/new-in-3.1.html#d0e1293)和[http://blog.springsource.com/2011/02/ 11/spring-framework-3-1-m1-released/](http://blog.springsource.com/2011/02/11/spring-framework-3-1-m1-released/)

# android - Android等效shell命令

> ID：11227465
> 
> 赞同：0
> 
> 时间：2012-06-27T13:34:21.200
> 
> 标签：android, shell

我正在寻找以下 Android adb shell 命令的等效 Linux 命令：

```
%ANDROID%\platform-tools\adb.exe shell ^
 /system/bin/chmod 0777 /data/local/asl-native 
```

这将用于授予特定目录或文件的读取和写入权限。

我尝试过使用以下 Linux 命令：

```
/system/bin/chmod u+rw /data/local/filename 
```

但是，似乎该文件没有被授予权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:41:17.980

大多数 Android 系统不允许您以超级用户（即 root）身份运行，如果没有该权限，您将无法进行此操作。

[您可以在此处](http://developer.android.com/guide/topics/data/data-storage.html#filesInternal)阅读更多关于文件存储如何在 Android 上工作的信息。

# node.js - 对于嵌入式客户端-服务器架构，node.js 是最佳选择吗？

> ID：11227468
> 
> 赞同：0
> 
> 时间：2012-06-27T13:34:29.357
> 
> 标签：node.js, embedded, client-server

我们有一个嵌入式盒子。CPU 的规格为中速 (600MHz)，RAM 介于 512MB 到 2GB 之间，具体取决于配置。该系统由数据层组成，用于处理来自硬件的传入数据，并且需要在远程和 HDMI 输出上显示。

看到远程方面与本地显示一样重要，我们构建了一个客户端-服务器解决方案。对于服务器来说，它只需要响应数据请求。数据需要来自另一个进程（IPC 交互）的内部，并将其格式化为客户端返回。

对于我们正在考虑使用 node.js 的服务器。数据被指定为格式化为 json 消息，因此使用 JavaScript 和 json 很简单。

但是，是否有更好的/其他服务器选项可供考虑？

主要要求是服务器可以扩展为与数据进程交互，并能够处理和响应请求。

我们可以自己编写它，但觉得必须已经有可用的技术可以利用。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:23:11.480

*我假设您只需要作为网页输出。*

这取决于。
如果您的团队非常了解 java/servlet，您可以使用简单的 jetty/servlet/jsp 组合。

但是，如果您的团队擅长使用 javascript/node.js，那就去吧。虽然，我不确定您的稳定性要求，因为 node.js 非常稳定，但尚未达到 1.0。

# google-analytics - 你可以推送一个有值但没有标签的 _trackEvent 吗？

> ID：11227472
> 
> 赞同：1
> 
> 时间：2012-06-27T13:34:49.857
> 
> 标签：google-analytics, google-analytics-api

如果在指定值时输入标签是多余的，您是否必须指定标签？你只是输入一个空白字符串、空值还是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T16:03:43.087

[_trackEvent()](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiEventTracking#_gat.GA_EventTracker_._trackEvent)的Google 文档建议`undefined`根据需要使用可选参数。

# php - 通过 Ajax/JSONP 调用外部 PHP 文件跨域写入 JSON 文件

> ID：11227473
> 
> 赞同：0
> 
> 时间：2012-06-27T13:34:51.347
> 
> 标签：php, ajax, json, jquery, cross-domain

**更新并解决**

感谢@Christofer Eliasson 的提示。添加：

```
header("access-control-allow-origin: *"); 
```

我的PHP文件解决了这个问题。也许不是处理问题的最美丽的方式，但这是有效的。

为了使它更好/更安全：

```
$http_origin = $_SERVER['HTTP_ORIGIN'];

if ($http_origin == "http://domain1.com")
{  
    header('Access-Control-Allow-Origin: *');
} 
```

* * *

这是另一个**跨域**相关问题。

我在 domain1.com 上有一个简单的 HTML 表单，用户可以将他/她的电子邮件添加到邮件列表中，这里是一个简单的 json 文件“mails.json”，托管在第二个域 (domain2.com) 上。

当用户提交他/她的电子邮件时，会调用一个 JS 脚本，其目的是检查电子邮件并将表单的数据（这里是用户的电子邮件）通过 ajax GET 发送到 domain2.com 上托管的 mails.json 文件和JSONP。

Ajax 调用托管在 domain2.com 上的 PHP 脚本，该脚本应该获取用户的电子邮件并将其写入 mails.json。此外，它应该向 domain1.com 发送一些关于成功或错误的消息，因为用户之前已经输入了他的电子邮件。

目前，电子邮件已发送并保存到 mails.json，但我无法让我的 PHP 脚本将有关其执行的消息发送回 domain1。感谢您的建议，并随时检查和修改下面的代码。

托管在**domain1.com上的 HTML 表单**

```
<div id="mail">
<form method="post" action="http://domain2.com/script.php" class="notifyme">
    <input type="email" value="" name="email" class="email" id="email" placeholder="Type your email here" required>
    <input type="submit" value="Get notified &raquo;" id="submit" name="submit">
    <div class="clear"></div>
</form>

<div class="errmail hide"><span class="uremail"></span> is not a valid email address. Try again :)</div>
<div class="error hide">Ouch :( <span class="uremail"></span> is already registered.</div>
<div class="success hide">Thank You :) <span class="uremail"></span> will be notified once we're ready.</div>

</div> 
```

**domain1.com**上托管的 Javascript 文件

 **```
//jQuery Initialization
$(function(){

// Form
$('#submit').click(function () { //onSubmit

$('.error,.errmail,.success').hide();       
    var email = $('input[name=email]').val();

    //Email validation      

    var pattern = new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);

    var valid = pattern.test(email);
    if (!valid && email !== 'undefined') {  
            $('.errmail').removeClass('hide').show('fast');

            if (!email){$('.uremail').append('This');}
            else{$('.uremail').append(email);}
            return false;
   } else {

        //start Ajax
        $.ajax({

            url: "http://domain2.com/script.php?json_callback=?",
            dataType: "jsonp text",       
            //GET method is used
            type: "GET",

            //pass the data         
            data: 'email=' + email,   

            //Do not cache the page
            cache: false,

            //Cross Domain
            crossDomain: true,

            //success
            success: function (html) {    

                //if list.php returned 1/true (send mail success)
               if (html==1) {                  
                $('.success').removeClass('hide').show('fast');$('.uremail').append(email);              

                } 
                else if (html == 0){
                $('.error').removeClass('hide').show('fast');$('.uremail').append(email); 
                }

                else { alert('Sorry, unexpected error. Please try again later.');  }           
            } 

        });
        }

        //cancel the submit button default behaviours
        return false;
    }); 
}); 
```

**更新**

托管在**domain2.com上的 PHP“script.php”文件**

```
header('content-type: application/json; charset=utf-8');
$http_origin = $_SERVER['HTTP_ORIGIN'];

if ($http_origin == "http://domain1.com")
{  
    header('Access-Control-Allow-Origin: *');
}

$logname    = 'mails.json';
$logcontents = file_get_contents($logname);

//Retrieve form data.
$email = ($_GET['email']) ?$_GET['email'] : $_POST['email'];

//flag to indicate which method it uses. If POST set it to 1
if ($_POST) $post=1;

    if(strpos($logcontents,$email) !== false) {
    if ($_POST) {die('You are already subscribed.');}
    else{ $result = 0;echo $result; }
    } 

    else {
        $filecontents = $email.',';
        $fileopen = fopen($logname,'a+');
        $filewrite = fwrite($fileopen, json_encode($filecontents) );
        $fileclose = fclose($fileopen);
                if(!$fileopen or !$filewrite or !$fileclose) {
                    if ($_POST) {die('Error occured');}
                    else{ $result = 0;echo $result; }
                    } 
                else {
                    if ($_POST) {echo 'Your email has been added.';}
                    else{ $result = 1;echo $result; }
                    }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:41:03.830

当您在脚本开头设置正确的内容类型标头时，您可以使用常规的`echo`. 您只需首先准备数据以匹配 JSONP 格式。像这样的东西：

```
<? 
    // Some data to return
    $data = array(1, 2, 3, 4, 5, 6, 7, 8, 9);
    // JSONP response
    echo $_GET['callback'] . '('.json_encode($data).')';
?>

// For this example, the response would be something like this:
// jsonp1277656587731([1,2,3,4,5,6,7,8,9]) 
```

当您使用 jQuery 执行 JSONP ajax 请求时，jQuery 将自动发送回调 GET 变量供您在服务器端使用。如示例所示。

一些额外的阅读：[http ://www.geekality.net/2010/06/27/php-how-to-easily-provide-json-and-jsonp/](http://www.geekality.net/2010/06/27/php-how-to-easily-provide-json-and-jsonp/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:55:08.293

过去我遇到过类似的问题，我确实尝试过修改网络服务器（Apache2）上的跨域设置，但没有运气。通过点击并尝试，我从我的 ajax 调用的“url”参数中删除了主机名，它对我有用。我仍然没有完全理解。

你能快速检查 url 参数吗：

```
 http://domain2.com/script.php?json_callback=? 
```

只是：

```
 script.php?json_callback=?. 
```

可能有额外的网络服务器配置设置..但只是想看看是否有效....**

# ruby-on-rails - 在私有/安全的 Rails 应用程序中使用 Google Analytics 是否安全？

> ID：11227476
> 
> 赞同：4
> 
> 时间：2012-06-27T13:35:04.303
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku, google-analytics

我在 Rails 中构建了一个私有/安全的 Web 应用程序，并有一些 beta 用户在上面。我想使用某种类型的分析来跟踪站点上的并发用户、站点上的时间、频率以及他们正在使用的应用程序的哪些功能/部分。

谷歌分析会很棒，但我不太愿意使用它，因为我不确定信息的私密性以及它是否会损害我的网络应用程序的安全性——密码和其他敏感信息是通过表单提交的，存储在数据库中，并被用户查看。

我很好奇其他基于网络的私人应用程序正在使用什么。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T13:59:16.923

如果您需要有关 Google Analytics 如何处理您的数据的详细信息，您应该阅读[Google 隐私中心](http://www.google.com/intl/en_uk/analytics/privacyoverview.html)页面。

简短的回答是，我不会担心在您的应用中使用 Google Analytics。

# c# - 网格面板中的 EXT.NET 组合框显示值而不是文本

> ID：11227483
> 
> 赞同：1
> 
> 时间：2012-06-27T13:35:26.277
> 
> 标签：c#, combobox, render, ext.net, gridpanel

我在 EXT.NET 中有一个大问题。我有一个网格面板，里面有一个组合框。组合框工作正常，但是当网格加载时，如果我单击组合框进行编辑，组合框会显示值而不是文本。如果我在组合框中选择了一个可能的项目，保存结果并重试编辑相同的组合框，此时显示的值是正确的（我看到了 Text 并且 thi 是正确的。）按照我的代码：

渲染函数：

```
var StatusRenderer = function (value, st) {
        var ind = st.find("Value", value);
        var r = st.getAt(ind);
        if (Ext.isEmpty(r)) {
            return "";
        }
        return r.data.Text;
    }; 
```

网格面板中的列：

```
<ext:Column ID="ColumnProfilo" runat="server" DataIndex="Profilo" Text="Profilo">
                            <Renderer Handler="return StatusRenderer(value, #{StoreProfilo});" />
                            <Editor>      
                                <ext:ComboBox ID="ComboBoxProfilo" SelectOnFocus="true" EmptyText="Select a Class"  TriggerAction="All" QueryMode="Local" runat="server" DisplayField="Text" ValueField="Value">
                                    <Store>
                                        <ext:Store ID="StoreProfilo" runat="server" AutoLoad="true" >
                                            <Model>
                                                <ext:Model ID="ModelProfilo" runat="server" IDProperty="Value">
                                                    <Fields>
                                                        <ext:ModelField Name="Text" />
                                                        <ext:ModelField Name="Value" />
                                                    </Fields>
                                                </ext:Model>
                                            </Model>            
                                        </ext:Store>
                                    </Store>
                                    <Listeners>
                                        <BeforeQuery Handler="delete queryEvent.combo.lastQuery;" />
                                    </Listeners>
                                </ext:ComboBox>
                            </Editor>
                        </ext:Column> 
```

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-10T13:17:56.310

请查看此示例并使用 " 而不是 Handler="..

[http://examples1.ext.net/#/GridPanel/Data_Presentation/Editor_Field_Mapping/](http://examples1.ext.net/#/GridPanel/Data_Presentation/Editor_Field_Mapping/)

# c# - 在 SAPI 中使用 System.speech.recognition 和 ISpRecognizer 有什么区别？

> ID：11227487
> 
> 赞同：0
> 
> 时间：2012-06-27T13:35:36.923
> 
> 标签：c#, .net, speech-recognition, sapi

我正在创建一个简单的语音识别应用程序，并且可以使用 system.speech.recognition 命名空间实现识别。我在 MSDN 中遇到了 ISpRecognizer，我想知道如何使用它和其他类来改进我的应用程序。

注意：我还需要在我的应用程序中优先考虑用户定义的语法和听写语法

# ruby-on-rails - 当我使用设计 gem 进行注册/登录时如何使用代码创建用户

> ID：11227490
> 
> 赞同：0
> 
> 时间：2012-06-27T13:35:44.627
> 
> 标签：ruby-on-rails, devise

我正在为我的应用程序使用 Devise gem。现在我想使用代码创建一个用户，但是在数据库表“用户”中密码是加密的。所以我希望我不能直接将它保存为

```
 new_user = User.new
 new_user.email = "xyz@xys.com"
 new_user.password = "1sdf" - i cannot use this becs its actually : encrypted_password
 new_user.save 

```

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:50:15.663

你应该能够做到这一点，设计的 encrypted_pa​​ssword 方法将处理加密你传入的密码并将其存储在数据库中

```
u = User.new(:email => "foo@bar.com", :password => '1sdf', :password_confirmation =>       '1sdf')
u.save 
```

在 Rails 控制台中尝试一下。

# c++ - 删除向量的任何元素 > 绑定到成员函数

> ID：11227495
> 
> 赞同：4
> 
> 时间：2012-06-27T13:35:58.063
> 
> 标签：c++, vector, c++11, bind, std-function

如何删除绑定到对象成员函数的`this`函数：

```
std::vector<std::function<void(int)>> callbacks;

class MyClass {
public:
    MyClass() {
        callbacks.push_back(
            std::bind(&MyClass::myFunc,this,std::placeholders::_1)
        );
    }
    ~MyClass() {
        auto it = std::remove_if( std::begin(callbacks),
                                  std::end(callbacks),
                                  [&](std::function<void(int)>& f) {
                return // <-- this is my question
                       //     true (remove) if f is bound to member function 
                       //     of this
        });
        callbacks.erase(it,std::end(callbacks));
    }
    void myFunc(int param){...}
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T16:40:34.063

```
 typedef decltype(std::bind(&MyClass::myFunc,this,std::placeholders::_1)) bound_type;

    auto it = std::remove_if( std::begin(callbacks),
                              std::end(callbacks),
                              [](const std::function<void(int)>& f) {
          return f.target<bound_type>() != nullptr;
    }); 
```

如果成员函数模板`std::function::target<T>`是 type ，则返回指向目标对象的指针`T`，否则返回 null。所以你只需要能够命名目标对象的类型，你可以从`decltype`. 真的很简单:-)

NB 将删除该类型的*任何*回调，而不仅仅是那些`this`为被销毁的特定对象绑定指针的回调。如果您试图阻止在对象被销毁后对其调用回调并且无法识别向量的哪些元素引用了哪些对象，您可以考虑将 shared_ptr 放在您的类中，然后将 weak_ptr 存储到它回调，可用于检测对象是否已被销毁：

```
class MyClass
{
    struct NullDeleter { void operator()(void*) const { } };
    std::shared_ptr<MyClass> sp;

    static void safe_invoke(void (MyClass::*f)(int), const std::weak_ptr<MyClass>& wp, int i)
    {
        if (std::shared_ptr<MyClass> safe_this = wp.lock())
            (safe_this.get()->*f)(i);
    }

public:
    MyClass() : sp(this, NullDeleter()) {
        callbacks.push_back(
            std::bind(safe_invoke, &MyClass::myFunc ,std::weak_ptr<MyClass>(sp),
                      std::placeholders::_1)
        );
    }; 
```

`invoke`这在调用成员函数之前使用将 转换`weak_ptr`为 a的函数来包装对成员函数的`shared_ptr`调用。如果对象已被销毁，则该对象`shared_ptr`将为空，因此该函数什么也不做。当它变得无效时，这实际上并不会删除回调，但确实可以安全地调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T15:05:58.390

在一般情况下，如果没有大量额外工作，您将无法做到。类型擦除从对象中清除此信息，并且`std::function`不直接公开此信息。

您的具体示例可能只有一个成员函数可以作为候选删除，但是具有 5 个成员的类可以存储为回调呢？您需要测试所有这些，并且还可以使用几乎无法检测到的 lambda 绑定成员函数。

如果出现以下情况，这是一种解决方案：

*   所有回调都是从内部注册的`MyClass`
*   容器被修改以存储额外信息
*   你愿意做所有额外的簿记

```
std::vector<std::pair<std::function<void(int)>, void*>> callbacks;

class MyClass{
  static unsigned const num_possible_callbacks = 2; // keep updated
  std::array<std::type_info const*, num_possible_callbacks> _infos;
  unsigned _next_info;

  // adds type_info and passes through
  template<class T>
  T const& add_info(T const& bound){
    if(_next_info == num_possible_callbacks)
      throw "oh shi...!"; // something went out of sync
    _infos[_next_info++] = &typeid(T);
    return bound;
  }
public:
  MyClass() : _next_info(0){
    using std::placeholders::_1;
    callbacks.push_back(std::make_pair(
        add_info(std::bind(&MyClass::myFunc, this, _1)),
        (void*)this));
    callbacks.push_back(std::make_pair(
        add_info([this](int i){ return myOtherFunc(i, 0.5); }),
        (void*)this));
  }

  ~MyClass(){
    using std::placeholders::_1;

    callbacks.erase(std::remove_if(callbacks.begin(), callbacks.end(),
        [&](std::pair<std::function<void(int)>, void*> const& p) -> bool{
          if(p.second != (void*)this)
            return false;
          auto const& f = p.first;
          for(unsigned i = 0; i < _infos.size(); ++i)
            if(_infos[i] == &f.target_type())
              return true;
          return false;
        }), callbacks.end());
  }

  void myFunc(int param){ /* ... */ }
  void myOtherFunc(int param1, double param2){ /* ... */ }
}; 
```

[Ideone 上的实时示例。](http://ideone.com/sTLRD)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-27T17:48:41.517

我曾经需要做这样的事情，我通过在包含函数的类中存储对象的共享指针向量来解决它，并在它们被销毁时按值从向量中删除函数，这也使这变得自动化。

# android - 数组列表中的索引越界异常

> ID：11227500
> 
> 赞同：0
> 
> 时间：2012-06-27T13:36:24.033
> 
> 标签：android, exception, arraylist

我正在开发一个应用程序，我在其中解析了公共 facebook 个人资料的 Json。我得到了 imageurl 的字符串并将它们保存到 ArrayList 中，然后在 listView 中实现。一切都很顺利，但有时我的应用程序会因为“数组索引超出范围”或“内存空间异常”而出现错误。无法解决此问题。帮帮我。提前致谢。

我也附上我的代码。

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View row = View.inflate(SocialActivity.this, R.layout.facebook_row, null);
    ImageView iv_user = (ImageView)row.findViewById(R.id.iv_user_pic);
    TextView tv_title, tv_description, tv_time;
    tv_title = (TextView)row.findViewById(R.id.tv_title);
    tv_description = (TextView)row.findViewById(R.id.tv_discription);
    tv_time = (TextView)row.findViewById(R.id.tv_time);
    Button btn_count = (Button)row.findViewById(R.id.btn_arrow);
    //bitmap = DownloadImage(alJson.get(position).strPicUrl);
    tv_title.setText(alJson.get(position).strName);
    tv_description.setText(alJson.get(position).strMessage);
    tv_time.setText(alJson.get(position).strDate);
    btn_count.setText(alJson.get(position).strCount);
    if((alJson.get(position).strPicUrl).equals(null){
        iv_user.setBackgroundResource(R.drawable.contact_img);
    } else{
        iv_user.setImageBitmap(al_bitmap.get(position));
    }
    return row;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:39:10.867

确保 alJson.size() 不为 0
，并尝试记录 alJson.size() 和位置以查看这些值是否有问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:47:03.267

也许你的 ArrayList alJson 是空的，所以在使用它之前检查一下：

```
int listsize = alJson.size();
if(listsize>=0 && listsize<=position)
{
    tv_title.setText(alJson.get(position).strName);
    tv_description.setText(alJson.get(position).strMessage);
    tv_time.setText(alJson.get(position).strDate);
    btn_count.setText(alJson.get(position).strCount);

    if((alJson.get(position).strPicUrl).equals("null"){
     iv_user.setBackgroundResource(R.drawable.contact_img);
    }
    else{

    iv_user.setImageBitmap(al_bitmap.get(position));

    }
}
else
{
 //DO SOME CODE HERE
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-16T08:19:36.373

使位置变量最终解决了我的问题

```
public View getView(final int position, View convertView, ViewGroup parent) 
```

# sql-server - 重写 T-SQL 按位逻辑

> ID：11227503
> 
> 赞同：2
> 
> 时间：2012-06-27T13:36:35.610
> 
> 标签：sql-server, tsql, bit-manipulation

如何重写此 T-SQL 代码以产生相同的结果

```
 SELECT   ACC.Title,
            ACC.AdvertiserHierarchyId,
            1 AS Counter
    FROM    admanAdvertiserHierarchy_tbl ACC
    JOIN    dbo.admanAdvertiserObjectType_tbl AOT ON AOT.AdvertiserObjectTypeId = ACC.AdvertiserObjectTypeId
              WHERE  (EXISTS
                         (SELECT 1
                          FROM    dbo.admanAdvertiserHierarchy_tbl CAMP
                          JOIN    dbo.admanAdvertiserAdGroup_tbl AG ON CAMP.AdvertiserHierarchyId = AG.AdvertiserHierarchyId
                          JOIN    dbo.admanAdvertiserCreative_tbl AC ON AC.AdvertiserAdGroupId = AG.AdvertiserAdGroupId
                          AND     CAMP.ParentAdvertiserHierarchyId = ACC.AdvertiserHierarchyId
                          WHERE   CAMP.ERROR = 0
                                  AND AC.Dirty & 7 > 0
                                  AND AC.ERROR = 0
                                  AND AG.ERROR = 0 )) 
```

它阻止优化器有效地使用索引。试图达到以下结果

```
 Title                               AdvertiserHierarchyId       Counter
    trcom65@travelrepublic.co.uk        15908                       1
    paul570@travelrepublic.co.uk        37887                       1
    es88@travelrepublic.co.uk           37383                       1
    it004@travelrepublic.co.uk          27006                       1
    011                                 10526                       1
    013                                 10528                       1
    033                                 12013                       1
    062                                 17380                       1
    076                                 20505                       1 
```

这是脏 tinyint 列的计数

```
 Dirty   total
    0       36340607
    1       117569
    2       873553
    3       59 
```

链接到静态原因表

```
 DirtyReasonId   Title
    0               Nothing
    1               Overnight Engine
    2               End To End
    3               Overnight And End To End
    4               Pause Resume
    5               Overnight Engine and Paused
    6               Overnight Engine E2E and Paused
    7               All Three 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T15:57:07.237

如果您特别询问 BITWISE AND 运算符的使用，我相信您是正确的，并且 SQL Server 不太可能将其视为 sargable，至少，与 Dirty 作为前导列的索引不同。

您只显示正在使用的最低两位（Dirty 的最大值为 3），但您正在测试最低三位。

因此，`AC.Dirty > 0`假设 3 是 Dirty 的最大值，将返回等效结果。但是有可能设置了其他（高阶）位，例如 Dirty 可以设置为 8。因此，如果目的是只检查最低三位，那么我们需要确保只测试这三个最低位。这个表达式可以做到这一点，其中一个谓词是 sargable：

```
( AC.Dirty > 0 AND AC.Dirty % 8 > 0 ) 
```

这基本上首先测试是否设置了任何位`AC.Dirty`，然后检查是否设置了最后三位中的任何一个。（我们使用 MODULO 除法运算符返回 AC.Dirty 除以 8 的余数，这当然会返回 0 到 7 之间的整数值。如果我们得到一个零，那么我们知道低三位都没有已设置，否则我们知道至少有一个位已设置。

需要明确一点：谓词 on`AC.Dirty > 0`是多余的。如果您想确保数据库至少可以考虑使用现有索引`Dirty`作为前导列，则将其包含在此处。

* * *

我会提到另一个要考虑的选项是在表达式上添加一个持久的 COMPUTED COLUMN，并在其上创建一个索引。但这对于您在这里需要的东西来说似乎有点矫枉过正。

* * *

如果您特别询问有关在表`admanAdvertiserCreative_tbl`(AC) 上使用索引的问题，那么您最好的候选人可能会覆盖`(AdvertiserAdGroupId, Error, Dirty)`.

* * *

下面的 SQL 重写应该返回等效的结果，可能具有更好的性能（取决于您的数据分布、索引等）

基本上，将 EXISTS（相关子查询）替换为子查询的 JOIN。子查询返回 CAMP.ParentAdvertiserHierarchyId 的不同值，这是您为关联子查询而引用的列。

这可能会或可能不会使用任何索引，具体取决于可用的索引。（它可能在主键上有聚集唯一索引，在外键上有非聚集索引，这应该有助于连接性能。）

未经测试：

```
SELECT  ACC.Title,
        ACC.AdvertiserHierarchyId,
        1 AS Counter
FROM    admanAdvertiserHierarchy_tbl ACC
JOIN    dbo.admanAdvertiserObjectType_tbl AOT 
        ON AOT.AdvertiserObjectTypeId = ACC.AdvertiserObjectTypeId
JOIN   (SELECT    CAMP.ParentAdvertiserHierarchyId
          FROM    dbo.admanAdvertiserHierarchy_tbl CAMP
          JOIN    dbo.admanAdvertiserAdGroup_tbl AG 
            ON    CAMP.AdvertiserHierarchyId = AG.AdvertiserHierarchyId
          JOIN    dbo.admanAdvertiserCreative_tbl AC 
            ON    AC.AdvertiserAdGroupId = AG.AdvertiserAdGroupId
         WHERE    CAMP.ERROR = 0
           AND    ( AC.Dirty > 0 AND AC.Dirty % 8 > 0 )
           AND    AC.ERROR = 0
           AND    AG.ERROR = 0 )
         GROUP BY CAMP.ParentAdvertiserHierarchyId
       ) c
  ON c.ParentAdvertiserHierarchyId = ACC.AdvertiserHierarchyId 
```

# javascript - window.innerWidth 不适用于 Internet Explorer windows mobile

> ID：11227507
> 
> 赞同：0
> 
> 时间：2012-06-27T13:36:46.640
> 
> 标签：javascript, internet-explorer, mobile, windows-7, windows-mobile

所以我只是想输出文档的当前视口

```
$('#dimensions').text(window.innerWidth + 'x' + window.innerWidth); 
```

不起作用并在 Internet Explorer 移动设备中返回为 undefinedxundefined。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T12:42:53.283

找到了答案，我不应该一直在寻找“windows mobile”而只是寻找普通的 Internet Explorer：

`document.body.clientWidth`

# php - 从输入字符串格式化日期时间

> ID：11227510
> 
> 赞同：1
> 
> 时间：2012-06-27T13:36:49.053
> 
> 标签：php

我正在做一个日期搜索过滤器，我的日期显示为“jnY G:i (26.6.2012 15:22)”。用户可以输入整个日期或部分日期：“26.6”、“6.2012”、“6”、“15:22”都是有效输入。因为我需要在数据库中检查这个日期，所以需要将格式更改为数据库的格式。为此，我使用：

```
$datum = '25.6.2012';
$date = DateTime::createFromFormat('j.n.Y',$datum);
echo $date->format('Y-m-d H:i'); 
```

如果 $datum 的格式不是 jnY，我会收到错误消息（如果我只输入 jn 或上述字符串部分之一，我会收到错误消息）。

还有一个问题是，对于输入的字符串'jnY'，我得到了正确的日期输出，它也将当前时间添加到日期字符串中（它不在初始日期字符串中）。示例：我输入“22.6.2012”，然后得到输出“2012-06-22 15:33”。

这两个问题可以用现有的 php 函数解决还是我应该自己解决？

帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:45:51.223

您可以在数组中列出可接受的数据格式，然后循环`DateTime::createFromFormat()`查看是否有任何输入产生可接受的日期：

```
$formats = array( 'j.n', 'j.n.Y');
$datum = '25.6.2012'; $date = false;

foreach( $formats as $format) {
    $date = DateTime::createFromFormat( $format, $datum);
    if( !($date === false)) break;
}

if( $date === false) {
    echo "Invalid date!\n";
} 
```

最后，如果你想摆脱新创建的对象中的当前时间并将时间设置为`00:00:00`，只需使用[`setTime()`](http://us3.php.net/manual/en/datetime.settime.php)date 对象上的方法：

```
// Sets the time to O hours, 0 minutes, 0 seconds
$date->setTime( 0, 0, 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:45:54.187

对于第一个问题，您需要自己编写一些代码，因为您可以接受的一些输入不在可识别的输入格式中。规范化输入值将需要您完全解析它（正则表达式是一个很好的开始方式），然后您可以`DateTime::createFromFormat`毫无问题地调用。

`!`对于第二个问题，在格式字符串的开头放置一个感叹号可以解决时间问题。从[文档](http://php.net/manual/en/datetime.createfromformat.php)中：

> 如果 format 包含字符`!`，则 format 中未提供的部分生成时间以及 ! 左侧的值将设置为 Unix 纪元的相应值。
> 
> Unix 纪元是 1970-01-01 00:00:00 UTC。

但是，由于您将需要完全解析上面提到的输入，所以这件事没有实际意义。另请注意，感叹号会导致年、月和日的缺失值使用可能不受欢迎的默认值。

# qt - 如何将 QDeclarativeItem 转换为 QImage

> ID：11227513
> 
> 赞同：0
> 
> 时间：2012-06-27T13:36:59.313
> 
> 标签：qt

我需要在诺基亚 Qt 中将 QDeclarativeItem 对象转换为 QImage 对象，有什么办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:19:20.903

你可以得到你的项目的边界矩形

```
QRectF QGraphicsItem::boundingRect() 
```

您还需要一个指向您的 QDeclarativeView 的指针，您可以使用它来将此矩形呈现为 QImage

```
void QGraphicsView::render ( QPainter * painter,
    const QRectF & target = QRectF(), const QRect & source = QRect(),
    Qt::AspectRatioMode aspectRatioMode = Qt::KeepAspectRatio ) 
```

（未经测试。）

# html - Internet Explorer 8 不会修改打印样式表中的 HTML5 标记

> ID：11227518
> 
> 赞同：8
> 
> 时间：2012-06-27T13:37:04.030
> 
> 标签：html, printing, header, footer, nav

我之前在处理打印样式表时遇到了 IE8 的问题。我正在使用 HTML5 和几个布局标签，包括页眉、导航和页脚。

由于某种原因，在我的打印样式表中显示：无；这些标签上的声明在 IE8 中被忽略（我只能假设后续的较低版本）。我首先认为 IE9 中的开发人员工具可能会导致错误的表示，但是我在 VirtualBox 中安装了 Windows XP，这也显示了问题。

我猜这是因为 IE9 以下的任何东西都无法正确看到 HTML5 标签。打印样式表隐藏了 Firefox 和 Chrome 中的布局标签。

有没有办法解决这个问题？

编辑：

这是我目前所拥有的：

```
<link rel="stylesheet" href="<?php echo get_template_directory_uri(); ?>/style.css" type="text/css" media="screen" />
<link rel="stylesheet" href="<?php echo get_template_directory_uri(); ?>/css/print.css" type="text/css" media="print" /> 
```

忽略 PHP 语句，它们特定于我的 CMS，即 WordPress。

然后我简单地将布局标签隐藏在 print.css 中：

```
nav,footer { 
display:none;
} 
```

这适用于 IE9、Firefox、Chrome，但不适用于低于 IE9 的任何设备。它似乎忽略了 HTML5 标签。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-11T12:38:12.673

我建议你试试[html5shiv](http://code.google.com/p/html5shiv/)。主要的 shiv`document.createElement()`和你一样，但它已经像疯了一样被优化/缩小。更重要的是，它包括[printshiv](https://github.com/aFarkas/html5shiv/blob/master/src/html5shiv-printshiv.js)（IE 打印保护器），它可以让您为 HTML5 元素设置样式以进行打印。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-10T13:29:48.317

使用[Modernizr](http://modernizr.com/download/)。在 Extra 中，确保选择了 html5shiv /w printshiv。在您的网站上包含这个 javascript 库，它应该像魅力一样工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T14:31:50.000

由于我所能做的只是猜测而没有实际看到代码，我的第一个猜测是在 css 声明之后使用的 html5 shiv，而 css 只是跳过了 html 5 标签，而不对它们应用 css 样式。尝试将脚本设置在最顶部，在头部的任何 css 链接标签之前。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T14:33:53.723

您可以通过包含一对函数`onbeforeprint`并`onafterprint`在其中隐藏/显示应该是`display:none`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-13T07:36:43.207

我强烈建议使用[样板](http://html5boilerplate.com/)来解决您的麻烦。是一个很好的网络标准汇编和几乎每个浏览器中的一些已知和常见问题。它使用[modernizr](http://modernizr.com/)并有一个很棒的样式表，其中有一个 @media 打印，您可以使用它来解决所有浏览器中的所有打印问题。

# objective-c - iOS 模拟器崩溃日志

> ID：11227519
> 
> 赞同：16
> 
> 时间：2012-06-27T13:37:13.797
> 
> 标签：objective-c, xcode, debugging, crash-reports

当我使用 iOS 模拟器并且应用程序崩溃时，我找不到崩溃日志。我一直在寻找整个互联网，无法弄清楚如何启用它们。我知道我可以在实际设备上运行并以这种方式获取崩溃日志，但我现在尝试修复的错误往往会导致程序挂在调试器中。然后没有 qlaunchsuccess 数据包发送，这是一个巨大的痛苦，尤其是当我必须一遍又一遍地运行程序时。我能找到的唯一建议是使用 CrashReporterPrefs，但是搜索我的硬盘驱动器没有发现任何与此类似的东西。我还深入研究了 XCode 的包内容和 iOS 模拟器的文件。iOS 模拟器有一个崩溃日志文件夹，但它是空的。任何人都知道如何让这个工作？谢谢。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-05-03T03:54:39.083

1.  使用 Xcode 运行您的应用程序以将应用程序安装到 iOS 模拟器
2.  在没有 Xcode 的模拟器上启动您的应用程序
3.  重现崩溃的步骤
4.  崩溃日志应显示在此目录下

    ~/库/日志/诊断报告/

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-20T15:57:56.790

如果您没有运行 Xcode（我的是 4.5.2），而只是模拟器（我的是 6.0），那么当应用程序崩溃时，它会保存崩溃报告。要查看它，请打开 Application/Utilities/Console 和

(1) 确保它显示日志列表（查看控制台左上角以确保未隐藏）

(2) 在“诊断和使用信息”下有一个“用户诊断报告”，如果你打开应该有你的崩溃报告

(3)控制台右侧区域有日志

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2012-06-27T14:32:44.373

崩溃日志只是调试器已经为您提供的输出。当您在附加到调试器的模拟器中运行时，您遇到了崩溃，您可以在调试导航器中查看回溯信息（默认键绑定为 cmd+5）

# javafx - JavaFX ScatterChart 数据未出现在正确的位置

> ID：11227523
> 
> 赞同：0
> 
> 时间：2012-06-27T13:37:32.900
> 
> 标签：javafx, javafx-2

在 Swing 中使用 JavaFX，我为场景创建了 JFXPAnel 和 ScatterChart。

但是从图表来看，数据并不完全正确。看起来好像是在数据点而不是形状的中心绘制了左上角的图标。

这是我正在使用的示例数据。您会注意到所有 Y 值都是整数。但是当显示图表时，图标位于该值的线下方。这是一个 JavaFX 错误，还是我做错了什么？

```
 XYChart.Series series1 = new XYChart.Series();
    series1.setName("Effects");
    series1.getData().add(new XYChart.Data(4.2, 2));
    series1.getData().add(new XYChart.Data(2.8, 2));
    series1.getData().add(new XYChart.Data(6.2, 2));
    series1.getData().add(new XYChart.Data(1, 1));
    series1.getData().add(new XYChart.Data(1.2, 1));
    series1.getData().add(new XYChart.Data(4.4, 1));
    series1.getData().add(new XYChart.Data(8.5, 1));
    series1.getData().add(new XYChart.Data(6.9, 1));
    series1.getData().add(new XYChart.Data(9.9, 1));
    series1.getData().add(new XYChart.Data(0.9, 1));
    series1.getData().add(new XYChart.Data(3.2, 3));
    series1.getData().add(new XYChart.Data(4.8, 3));
    series1.getData().add(new XYChart.Data(7.3, 3));
    series1.getData().add(new XYChart.Data(1.8, 3));
    series1.getData().add(new XYChart.Data(7.3, 3));
    series1.getData().add(new XYChart.Data(2.7, 3));

    XYChart.Series series2 = new XYChart.Series();
    series2.setName("Cause");

    series2.getData().add(new XYChart.Data(2.4, -1));
    series2.getData().add(new XYChart.Data(3.2, -1));
    series2.getData().add(new XYChart.Data(1.8, -1));
    series2.getData().add(new XYChart.Data(3.2, -1));
    series2.getData().add(new XYChart.Data(7.4, -1));
    series2.getData().add(new XYChart.Data(3.5, -2));
    series2.getData().add(new XYChart.Data(9.3, -2));
    series2.getData().add(new XYChart.Data(8.1, -2));

    XYChart.Series series3 = new XYChart.Series();
    series3.setName("Events");
    series3.getData().add(new XYChart.Data(5.2, 0));
    series3.getData().add(new XYChart.Data(2.9, 0));
    series3.getData().add(new XYChart.Data(3.3, 0)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T15:54:20.180

您遇到了一个问题[http://javafx-jira.kenai.com/browse/RT-18389](http://javafx-jira.kenai.com/browse/RT-18389)已在 2.2 版本中修复。

2.2的开发预览版可以从这里下载：[http ://www.oracle.com/technetwork/java/javafx/downloads/devpreview-1429449.html](http://www.oracle.com/technetwork/java/javafx/downloads/devpreview-1429449.html)

如果您需要散点图与 2.1 一起使用，您可以使用下一个解决方法：[如何在 JavaFX 2.0 中将点放在散点图的中心？](https://stackoverflow.com/questions/8394328/how-can-i-center-the-dots-on-a-scatter-chart-in-javafx-2-0)

# java - 跨 Tomcat 上的动态 Web 项目引用类

> ID：11227524
> 
> 赞同：0
> 
> 时间：2012-06-27T13:37:34.110
> 
> 标签：java, tomcat, dynamic, web

我有两个动态 Web 项目 - A 和 B。项目 B 引用项目 A 中的类。项目 A 在本地的 Tomcat 上运行良好。项目 B 也在 Tomcat 本地运行，但是当我在 Tomcat 上引用项目 A 类运行它时，项目 A 中的类在 Tomcat 中丢失，因此引发类未找到异常。

由于我无法 jar 项目 A 文件，如何将项目 A 中的类获取到本地 Tomcat 部署，以便项目 B 在引用项目 A 类时可以运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:47:38.077

如果两个 Web 应用程序共享一些公共类，那么这些类应该从 Web 应用程序代码库中重构出来并放入一个单独的库（jar 文件）中。然后可以将此 jar 作为依赖项添加到您的 Web 应用程序中。

# zend-framework - Zend：AJAX 之后的表单验证

> ID：11227528
> 
> 赞同：0
> 
> 时间：2012-06-27T13:37:46.720
> 
> 标签：zend-framework

我有一个用 Zend 完成的表格。我在对话框中使用 ajax 加载它。它有2个选择。根据在第一个选择中选择的内容，它会加载第二个选择的内容。但是，当我提交表单时，我收到验证错误，因为在创建第二个表单时不存在第二个表单的选项。

有没有办法解决这个“问题”？它做了它需要做的事情，但我不希望它再验证该字段。任何方式来指定我不想要那个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:52:08.463

您可以禁用`inArray`验证器。在构造表单的`select`元素时，设置

```
'registerInArrayValidator' => false 
```

此外，另一种解决方案是重载该`isValid`方法，检查第一个`select`元素的选定选项，然后填充第二个元素的选项。然后打电话`parent::isValid`检查表格是否真的有效。

# c# - 禁用按钮 C#

> ID：11227529
> 
> 赞同：0
> 
> 时间：2012-06-27T13:37:47.950
> 
> 标签：c#, asp.net, button, visibility

SetVisibility 检查数据库是否应该启用所有按钮。我想禁用所有按钮`if setvisility(UserID) == false`

这部分代码只禁用交替的向上和向下按钮。有人可以建议为什么会这样吗？

```
else
{
    Button b = e.Item.FindControl("btnmoveup") as Button;
    b.Enabled = false;
    Button b2 = e.Item.FindControl("btnmovedown") as Button;
    b2.Enabled = false;
} 
```

这是完整的代码：

```
if (e.Item.ItemType == ListItemType.Item)
{
    String userID = User.Identity.Name.Split('\\')[1];
    if (setvisibility(userID) == true)
    {
        if (e.Item.ItemIndex == 0)
        {
            Button b = e.Item.FindControl("btnmoveup") as Button;
            b.Enabled = false;
        }

        DataView view = (DataView)SqlDataSource1.Select(DataSourceSelectArguments.Empty);
        DataTable result = view.ToTable();
        if (e.Item.ItemIndex == (result.Rows.Count) - 1)
        {
            Button b2 = e.Item.FindControl("btnmovedown") as Button;
            b2.Enabled = false;
        }
    }
    else // How to disable all the buttons ? 
    {
        Button b = e.Item.FindControl("btnmoveup") as Button;
        b.Enabled = false;
        Button b2 = e.Item.FindControl("btnmovedown") as Button;
        b2.Enabled = false;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T13:40:13.333

采用：

```
if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem ) 
```

# javascript - 使用jquery计算页面中第一级UL LI的数量

> ID：11227530
> 
> 赞同：1
> 
> 时间：2012-06-27T13:37:48.533
> 
> 标签：javascript, jquery

我有一些 jquery 将计算我的菜单中的项目，并为 li 分配一个以 px 为单位的计算宽度。

这是代码：

```
$(document).ready(function(){
    $('div#new-menu-lower ul li').css('width', ($('div#new-menu-lower ul').width() / $('div#new-menu-lower ul li').length));
    $(function() {
        var menuWidth = $('div#new-menu-lower ul').width();
        var listItems = $('div#new-menu-lower ul li').length;
        var itemWidth = Math.floor(menuWidth * (1/listItems)) - 40;
        $('div#new-menu-lower ul li').css('width', itemWidth);
    });
}); 
```

问题`listItems`显示为 38 个项目，并且似乎计算了每个错误的 li。它应该只计算第一个 ul li 不是子元素。

我能做些什么来阻止这种情况发生吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T13:38:43.313

改变

```
var listItems = $('div#new-menu-lower ul li').length; 
```

到

```
var listItems = $('div#new-menu-lower > ul > li').length; 
```

您需要 jQery**[父 > 子](http://api.jquery.com/child-selector/)**选择器来完成您的工作。

来自 jQuery 文档：

> 选择“parent”指定的元素的“child”指定的所有直接子元素。
> 
> 作为 CSS 选择器，所有现代 Web 浏览器都支持子组合器，包括 Safari、Firefox、Opera、Chrome 和 Internet Explorer 7 及更高版本，但尤其是 Internet Explorer 6 及更低版本。但是，在 jQuery 中，此选择器（以及所有其他选择器）适用于所有支持的浏览器，包括 IE6。
> 
> 子组合器 (E > F) 可以被认为是后代组合器 (EF) 的一种更具体的形式，因为它只选择第一级后代。

# php - Clearinterval 在 ajaxrequest 中不起作用

> ID：11227534
> 
> 赞同：0
> 
> 时间：2012-06-27T13:38:11.010
> 
> 标签：php, javascript, ajax

我进行了 ajax 调用并调用了一个运行正常的 setInterval 函数。不幸的是，当我试图阻止它时，它不起作用。

```
 function test(str)
        {
        if (window.XMLHttpRequest)
          {// code for IE7+, Firefox, Chrome, Opera, Safari
          xmlhttp=new XMLHttpRequest();
          }
        else
          {// code for IE6, IE5
          xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
          }
        xmlhttp.onreadystatechange=function()
          {
          if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
                if (str=="?stage=3"){
                    test('?stage=4');
                } 
                if (str=="?stage=4"){
                     document.getElementById("main").innerHTML+=xmlhttp.responseText;
 prog=window.clearInterval(prog);

                }else{
                    document.getElementById("main").innerHTML+=xmlhttp.responseText;        
                }

            }
          else
          {
            if (str=="?stage=3"){
                var prog = self.setInterval( "ajaxrequest('progress_track.php', 'main')", 1000 );
            } 
        }
          }
        xmlhttp.open("GET","test.php"+str,true);
        xmlhttp.send();
        } 
```

非常感谢任何帮助。

**编辑：**

我重新编写了我的代码，因为我发现它以某种方式调用了 setinveral 函数的 3 倍。这段代码只调用了 2 次。我只是不明白为什么。

```
var prog = 0;
function test(str)
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200 && str=="?stage=3")
    {
        test('?stage=4');   
    }else{
        if( str=="?stage=3"){
        prog = self.setInterval( "ajaxrequest('progress_track.php', 'main')", 1000 );   
        }
    }
    if (xmlhttp.readyState==4 && xmlhttp.status==200 && str=="?stage=4")
    {
        prog=window.clearInterval(prog);    
    }
    if (xmlhttp.readyState==4 && xmlhttp.status==200 && str!="?stage=4" && str!="?stage=3")
    {
        document.getElementById("main").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","test.php"+str,true);
xmlhttp.send();
} 
```

但是cleariterval仍然无法正常工作。

**编辑：**

我发现了问题。使用这段代码，它永远不会处于这种状态：

```
if (xmlhttp.readyState==4 && xmlhttp.status==200 && str=="?stage=4")
    {
        prog=window.clearInterval(prog);    
    } 
```

现在唯一的问题是为什么不呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:41:36.400

您需要在更高的范围内声明“prog”。您可以将其移到函数声明之外：

```
var prog;
function test(str) {
  ...
  if (str=="?stage=3"){
    prog = self.setInterval( 
      "ajaxrequest('progress_track.php', 'main')", 1000 
    );
  }
  ...
} 
```

你现在得到它的方式，`prog`当你打电话时是不确定的`clearInterval()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:41:51.440

它不起作用的原因是因为您正在声明变量以将计时器 ID 保留在函数中，但您却试图在定义之前使用它。当您尝试清除它时，该变量未定义。您可以做的是在外部定义变量然后使用它。像这样的东西：

```
var prog = 0;

function test(str)
    {
    if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if (str=="?stage=3"){
                test('?stage=4');
            } 
            if (str=="?stage=4"){
                 document.getElementById("main").innerHTML+=xmlhttp.responseText;
                 prog=window.clearInterval(prog);

            }else{
                document.getElementById("main").innerHTML+=xmlhttp.responseText;        
            }

        }
      else
      {
        if (str=="?stage=3"){
            prog = self.setInterval( "ajaxrequest('progress_track.php', 'main')", 1000 );
        } 
    }
      }
    xmlhttp.open("GET","test.php"+str,true);
    xmlhttp.send();
} 
```

您可能还想在清除之前检查它是否为 0。如果为 0，则表示尚未设置，不需要清除。

# android - 如何从 Google Place API JSON (android) 获取位置

> ID：11227537
> 
> 赞同：0
> 
> 时间：2012-06-27T13:38:24.720
> 
> 标签：android, json, google-places-api

我在下面输入了获取位置数组以获取纬度，但它不起作用。我的代码有什么错误吗？我可以得到结果，但我无法得到几何图形。

```
 JSONTokener jsonParser = new JSONTokener(strResult);  
 JSONObject jsonObject = new JSONObject(strResult);

 JSONArray routeObject = jsonObject.getJSONArray("results");

routeObject.getJSONObject(0).getJSONArray("geometry").getJSONObject(0).getJSONArray("location").getJSONObject(0).getDouble("lat") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:26:23.597

我从未使用过`google-places-api`，但我只是尝试了一些东西。我只是从[https://developers.google.com/maps/documentation/places/place-search-response获取示例文件](https://developers.google.com/maps/documentation/places/) **并将**其复制到文件中作为输入。（编辑：我正在使用[http://code.google.com/p/google-gson/](http://code.google.com/p/google-gson/)进行解码）

我解码 JsonFile 的代码看起来像这样，并为您提供了`latitude`您正在寻找的内容：

```
 JsonParser parser = new JsonParser();
        JsonObject obj = (JsonObject)parser.parse(new FileReader(path));

        for(Entry<String, JsonElement> entry : obj.entrySet()) {
            String key = entry.getKey();
            System.out.println(key);

            if(key.trim().equals("results".trim())) {
                for(JsonElement ele2 : entry.getValue().getAsJsonArray()) {
                    System.out.println(ele2.getAsJsonObject().get("geometry").getAsJsonObject().get("location").getAsJsonObject().get("lat"));
                }
            }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T14:07:58.127

我这样做：

谷歌地图网址：

[http://maps.google.com/maps/geo?q=](http://maps.google.com/maps/geo?q=) "+fullAddress;

我读了它：

```
JSONObject response = new JSONObject(result);
JSONObject point = response.getJSONArray("Placemark").getJSONObject(0).getJSONObject("Point");

            lat = point.getJSONArray("coordinates").getString(1);
            lng = point.getJSONArray("coordinates").getString(0); 
```

希望能帮助到你！

# objective-c - RestKit 多对多关系在连接表中保存新行，在主表中保存空值

> ID：11227548
> 
> 赞同：0
> 
> 时间：2012-06-27T13:39:00.937
> 
> 标签：objective-c, ios, many-to-many, restkit

我使用 RestKit 在本地缓存来自远程服务器的数据。在其中，我在类别 <<-->> 新闻之间有多对多的关系。映射似乎工作正常，尽管它还在我的类别表中保存了空值（它也保存了正确的类别）。如下图所示：

![在此处输入图像描述](../Images/aba03d139e0873da983e6adc180cd582.png)

它似乎保存了 30 个空行，我的连接表中也有 30 个（非空）行，所以这里可能存在相关性。

我得到的 JSON 如下所示：`"categories":[{"category_id":1},{"category_id":4}]`

我有两个继承自`NSManagedObject`.

```
@interface News : NSManagedObject
    [...]
    @property (nonatomic, retain) NSSet *categories;
@end

@interface Category : NSManagedObject
[...]
    @property (nonatomic, retain) NSSet *news;
@end 
```

我`@dynamic`两个都用。

我的映射如下所示：

```
RKManagedObjectMapping *categoryMapping = [RKManagedObjectMapping mappingForClass:[Category class] inManagedObjectStore:objectManager.objectStore];

categoryMapping.primaryKeyAttribute = @"categoryId";
categoryMapping.rootKeyPath = @"categories";
[categoryMapping mapKeyPath:@"id" toAttribute:@"categoryId"];
[...]

RKManagedObjectMapping* newsMapping = [RKManagedObjectMapping mappingForClass:[News class] inManagedObjectStore:objectManager.objectStore];

newsMapping.primaryKeyAttribute = @"newsId";
newsMapping.rootKeyPath = @"news";
[newsMapping mapKeyPath:@"id" toAttribute:@"newsId"];
[...]

// Categories many-to-many (not fully working yet).
[newsMapping mapKeyPath:@"categories" toRelationship:@"categories" withMapping: categoryMapping];

// Register the mappings with the provider
[objectManager.mappingProvider setObjectMapping:newsMapping forResourcePathPattern:@"[path-to-JSON]"];
[objectManager.mappingProvider setObjectMapping:categoryMapping forResourcePathPattern:@"[path-to-JSON]"]; 
```

我像这样获取数据（很像 Twitter RestKit 示例）：

```
- (id)init
{
    self = [super init];
    if (self) {
        [self loadCategories];
        [self loadCategoriesFromDataStore];

        [self loadNews];
        [self loadNewsFromDataStore];
    }
    return self;
}

- (void)loadCategoriesFromDataStore
{    
    NSFetchRequest* request = [Category fetchRequest];
    NSSortDescriptor* descriptor = [NSSortDescriptor sortDescriptorWithKey:@"categoryId" ascending:YES];
    [request setSortDescriptors:[NSArray arrayWithObject:descriptor]];
    _categories = [Category objectsWithFetchRequest:request];
}

- (void)loadNewsFromDataStore
{    
    NSFetchRequest* request = [News fetchRequest];
    NSSortDescriptor* descriptor = [NSSortDescriptor sortDescriptorWithKey:@"createdAt" ascending:NO];
    [request setSortDescriptors:[NSArray arrayWithObject:descriptor]];
    _news = [News objectsWithFetchRequest:request];
}

- (void)loadCategories 
{
    // Load the object model via RestKit
    RKObjectManager *objectManager = [RKObjectManager sharedManager];
    [objectManager loadObjectsAtResourcePath:@"[link-to-JSON]" delegate:self];
}

- (void)loadNews 
{
    // Load the object model via RestKit
    RKObjectManager *objectManager = [RKObjectManager sharedManager];
    [objectManager loadObjectsAtResourcePath:@"[link-to-JSON]" delegate:self];
}

- (void)objectLoader:(RKObjectLoader*)objectLoader didLoadObjects:(NSArray*)objects {
    [[NSUserDefaults standardUserDefaults] synchronize];
    [self loadCategoriesFromDataStore];
    [self loadNewsFromDataStore];
} 
```

任何想法我做错了什么？

**注意：** 当有 15 条新闻时，似乎也将 30 行保存到连接表中，我不知道这是否是连接表的正常行为。

**更新：**它还映射了连接表中的错误类别 ID（即类别 66，空行）。

**更新 2：** JSON 获取我的类别 {"categories":{[...], "id":1, [...]} 的请求

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:58:32.583

这一行是错误的：

```
[categoryMapping mapKeyPath:@"id" toAttribute:@"categoryId"]; 
```

它应该是

```
[categoryMapping mapKeyPath:@"category_id" toAttribute:@"categoryId"]; 
```

编辑：您拥有的对象映射将映射两种 JSON 格式。

1) {"categories":[{"id":7},{"id":12}]} 当你有资源路径 @"[path-to-JSON]"

2) {"news":[{"id":5, "categories":[{"id":7}]}]} 当你有资源路径 @"[path-to-JSON]"

（顺便说一下，我认为这些实际路径是不同的）

其他任何内容，例如您在问题顶部发布的 JSON，都将不起作用。您看到的问题是因为在您的 JSON 中找不到主键属性，所以当对象保存到核心数据时，会创建一个没有主键的新实体。

# javascript - NodeJS，使用 Eclipse 调试器进行变量检查？

> ID：11227554
> 
> 赞同：1
> 
> 时间：2012-06-27T13:39:16.250
> 
> 标签：javascript, eclipse, debugging, node.js, v8

我正在关注[https://github.com/joyent/node/wiki/Using-Eclipse-as-Node-Applications-Debugger](https://github.com/joyent/node/wiki/Using-Eclipse-as-Node-Applications-Debugger) 并给我留下了一些问题

1.  如何查看变量包含哪些内容？
2.  如何执行任意命令？

这类似于 webkit 的检查器。你可以在那里做这两件事，它有一个控制台选项卡来执行你想要的任何东西，输入变量的名称将显示它的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T17:27:36.260

暂时我已经建立了自己的工具。 [https://github.com/ketamynx/node-codein](https://github.com/ketamynx/node-codein)

# ruby - OpenSSL 错误 savon nginx 独角兽，sslv3 警报意外消息

> ID：11227558
> 
> 赞同：0
> 
> 时间：2012-06-27T13:39:23.003
> 
> 标签：ruby, nginx, openssl, unicorn, savon

在私有 vps（Ubuntu 10.04.4 LTS）上使用 rails (3.1) 应用程序很难启动和运行。

使用 savon 调用肥皂服务时出现以下错误

```
OpenSSL::SSL::SSLError (SSL_connect returned=1 errno=0 state=SSLv2/v3 read server hello A: sslv3 alert unexpected message):
lib/modules/soap_client.rb:32:in `create_payment'
app/controllers/payments_controller.rb:34:in `create' 
```

奇怪的是，这个完全相同的应用程序代码在**Heroku**上运行没有问题，结果是我现在托管它。

这似乎是一个服务器端的问题。

还有其他人在使用**savon** togeheter 和**nginx**、**unicorn**和 ubuntu 10.04 时遇到类似问题吗？

还尝试使用 set savon 忽略 SSL 验证

```
@client = Savon::Client.new do
     http.auth.ssl.verify_mode = :none
     wsdl.document = SOAP_URL
end 
```

Savon 版本是 0.9.9

红宝石版本 1.9.2p180

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T19:57:05.170

没有适合您的解决方案，但我首先要研究的是两台服务器上的 OpenSSL 版本。Heroku 可能提供了 Ubuntu 10.04 上不可用的更新或修补版本。

另外，我会通过在您的 ubuntu 系统上手动运行 OpenSSL s_client 来检查：

```
openssl s_client -ssl3 -host <fqdn> -port <port> 
```

假设问题出在哪里，这将有助于将问题隔离到 OpenSSL。

# android - 避免图片在WebView Android中加载和抓取URL

> ID：11227562
> 
> 赞同：0
> 
> 时间：2012-06-27T13:39:44.300
> 
> 标签：android, url, webview, load, image

如何避免加载所有图片，在`WebView`？我还需要获取这些图片的 URL。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:22:00.800

如果您正在为 API 级别 11 或更高级别进行开发，则可以使用[`WebViewClient.shouldInterceptRequest`](http://developer.android.com/reference/android/webkit/WebViewClient.html#shouldInterceptRequest%28android.webkit.WebView,%20java.lang.String%29)来处理加载图像的请求。该方法的第二个参数是资源的 URL。

[`WebResourceResponse`](http://developer.android.com/reference/android/webkit/WebResourceResponse.html)如果您不希望加载原始图像，则必须返回对象，可能是占位符/错误图像。

# javascript - Javascript：错误的日期计算

> ID：11227563
> 
> 赞同：0
> 
> 时间：2012-06-27T13:39:46.177
> 
> 标签：javascript, html

所以我刚刚发布了一个关于这段代码的问题（得到了回答）：

```
$(document).ready(Main); 

function Main() { 
    ConfigDate();         
} 

function ConfigDate() { 
    var currentTime = new Date(); 
    var dayofWeek = currentTime.getDay(); 

    var daysSinceThursday = (dayofWeek + 3) % 7 
    var lastThursday = new Date(currentTime.getDate() - daysSinceThursday); 
    var dd = lastThursday.getDate(); 

    var mm = lastThursday.getMonth() + 1; 
    var yyyy = lastThursday.getFullYear(); 

    $("#last_thursday").text(yyyy + " / " + mm + " / " + dd); 
} 
```

现在的问题是，出现在我的单元格中的日期是 1969 / 12 / 31（甚至不是星期四）。

计算上个星期四的日期时我做错了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T13:46:08.480

这是因为`.getDate()`返回月份中的某一天。因此，您正在根据小于 30 的序列号构建日期，这甚至不会将您的秒数设置为 1 以上。

使用`.setDate()`而不是建立一个新的日期：

```
date.setDate(date.getDate() - daysSinceThursday); 
```

`.setDate()`将修改您现有的日期对象，它不会返回新日期。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T13:45:22.517

您正在尝试仅根据上周四的月份日期设置日期。尝试这样的事情：

```
var daysSinceThursday = (dayofWeek + 3) % 7;
var lastThursday = new Date(currentTime.getTime());
lastThursday.setDate(currentTime.getDate() - daysSinceThursday);
var dd = lastThursday.getDate();

var mm = lastThursday.getMonth() + 1; 
var yyyy = lastThursday.getFullYear(); 
```

[http://jsfiddle.net/rAuRF/3/](http://jsfiddle.net/rAuRF/3/)

# asp-classic - 使用 VBScript 和 ASP Classic 的服务器时间

> ID：11227565
> 
> 赞同：2
> 
> 时间：2012-06-27T13:39:48.973
> 
> 标签：asp-classic, vbscript

我创建了一个应用程序以在达到目标日期和时间后显示新闻稿，并想知道这是从服务器还是客户端获取时间，因为我想使用服务器的时间，这样别人就不会只需更改他们的时钟以查看它。

这是我的代码：

```
 <%
dim strDate
dim strTime
dim strTarget_time
dim strTarget_date
dim strBreak
dim strRuleBreak
dim strToday

strDate = Date()
strTime = Time()
strright_now = Now()
strTarget_time = "3:27:00 PM"
strTarget_date = "6/26/2012"
strBreak = "<br />"
strRuleBreak = "<br /><hr><br />"
strToday = Now()

response.write("<h2>TEST VARIABLES</h2>")
response.write("<p><strong>Today's date:</strong> " & strDate & strBreak)
response.write("<strong>Current time:</strong> " & strTime & strBreak)
response.write("<strong>Target date:</strong> " & strTarget_date & strBreak)
response.write("<strong>Target time:</strong> " & strTarget_time & "</p>")
response.write(strRuleBreak)

'TIME TESTER
response.write("<h2>TIME TESTER</h2>")
response.write("<p><nobr>Testing to see if it is past the target time of: " & strTarget_time & "</nobr></p>")
if strTime >= cdate(strTarget_time) then
response.write("<p>Yes, it is now " & Now() & ", which <strong>IS</strong> past the target time of: " & strTarget_time & "</p>")
else
response.write("<p>No, it is now " & Now() & ", which is <strong>NOT</strong> past the target time of: " & strTarget_time & "</p>")
end if

response.write(strRuleBreak)

'DATE TESTER
response.write("<h2>DATE TESTER</h2>")
response.write("<p><nobr>Testing to see if it is past the target date of: " & strTarget_date & "</nobr></p>")
if strToday >= cdate(strTarget_date) then
response.write("<p>Yes, it is now " & Now() & ", which <strong>IS</strong> past the target date of: " & strTarget_date & "</p>")
else
response.write("<p>No, it is now " & Now() & ", which is <strong>NOT</strong> past the target date of: " & strTarget_date & "</p>")

end if 
response.write(strRuleBreak)

'DATE AND TIME TESTER
response.write("<h2>DATE AND TIME TESTER</h2>")
response.write("<p><nobr>Testing to see if it is past the target of: " & strTarget_date & "&nbsp;-&nbsp;" & strTarget_time & "</nobr></p>" & strBreak)
if strToday >= cdate(strTarget_date) AND strTime >= cdate(strTarget_time) then
response.write("<p>Yes, it is now " & Now() & ", which <strong>IS</strong> past the target of: " & strTarget_date & "&nbsp;-&nbsp;" & strTarget_time & "</p>")
else
response.write("<p>No, it is now " & Now() & ", which is <strong>NOT</strong> past the target of: " & strTarget_date & "&nbsp;-&nbsp;" & strTarget_time & "</p>")

end if 
response.write(strRuleBreak)

%> 
```

因此，在这种情况下，如果时间和日期是 2012 年 6 月 26 日下午 3:27 之后，则该部分将显示。我主要是问，因为我想澄清这是使用客户端还是服务器端时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T13:44:09.773

这将是服务器端，因为这是执行 ASP 代码的地方。为了获取客户端日期时间，您需要使用脚本在浏览器中运行 - 通常是 JavaScript。

# neo4j - Neo4j Key-Value List 推荐实现

> ID：11227567
> 
> 赞同：3
> 
> 时间：2012-06-27T13:40:06.627
> 
> 标签：neo4j, key-value

我使用 Neo4j 已经有一段时间了，并且使用 Neo4j 启动并运行了一个应用程序，它一切都运行良好，Neo4j 在解决这个问题方面真的很酷，但我现在需要扩展应用程序并一直在尝试暗示。Neo4j 中的数据键值列表，我不确定最好的方法。

我有一个列表，该列表的长度约为 700 万个元素，因此仅将整个列表存储在内存中并自己管理它有点长。我对此进行了测试，它会消耗 3Gb。

我的选择是：

*   (a) Neo4j 只是不适合这项工作的工具，我应该使用实际的键值数据存储。这样做有点不利，因为我必须为这个数据列表引入另一个数据存储。
*   (b) 使用 Neo4j，通过为每个键值创建一个节点，将键和值设置为节点上的属性，但是除了有一个索引将这些节点组合在一起之外没有任何关系，将键值的键暴露为索引上的键。
*   (c) 创建一个节点并将所有键值作为属性保存，这感觉不对，因为当获取节点时，它将把整个东西加载到内存中，然后我必须搜索我感兴趣的属性在，我还不如自己管理列表。
*   (d) 键是实际指向两个节点的两部分键，因此创建关系并将值设置为关系上的属性。我开始走这条路，但是在查找特定键/值时，它并不简单快速，所以远离这个。

选项“a”或“b”感觉要走的路。
任何意见，将不胜感激。

示例场景

我们有节点 A 和节点 B，这两个节点之间存在关系。节点都具有“foo”的属性，其中 foo 具有一定的价值。在此示例中，节点 A 的 foo=X 和节点 B 的 foo=Y

然后我们有这个 K/Vs 列表。其中一个 K/V 是 Key:X+Y=Value:Z 所以，最初的想法是在节点 A 和节点 B 之间创建另一个关系，并在持有 Z 的关系上存储一个属性。然后在“foo”上创建一个索引以及新关系上的关系 idx。

当给定 Key X+Y 时获取值。查找逻辑将是获取节点 A（来自 X）和节点 B（来自 y），然后遍历节点 A 关系到节点 B 查找这种新的关系类型。虽然这会起作用，但我不喜欢我必须查找与节点之间的所有关系以查找特定类型的事实，这是低效的。特别是如果有许多不同类型的关系。

所以结论是选择“A”或“B”，或者我正在尝试对 Neo 做一些不切实际的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:47:24.840

不要试图在 Neo4j 属性中存储 700 万个项目——你是对的，这是错误的。

Redis 和 Neo4j 经常搭配得很好，但我不太明白你想要做什么或者你在“d”中的意思——什么是键/值对，它们与节点和图中的关系？例子会有所帮助。

更新：使用图形数据库执行此操作的最自然方法是将其作为属性存储在两个节点之间的边缘上。然后你可以使用 Gremlin 来获取它的值。

例如，要返回存在于具有某些属性的两个顶点（节点）之间的边上的属性：

```
start = g.idx('vertices')[[key:value]]            // start vertex
edge = start.outE(label).as('e')                  // edge
end = edge.inV.filter{it.someprop == somevalue}   // end vertex
prop = end.back('e').prop                         // edge property
return prop 
```

您可以将其存储在您建议的索引中，但这会增加系统的复杂性，如果您需要在遍历过程中引用数据，那么您将不得不存储重复数据或在 Redis 中查找它您可以执行的遍历，请参见：

让 Gremlin 在遍历图表时与 Redis 实时对话 [https://groups.google.com/d/msg/gremlin-users/xhqP-0wIg5s/bxkNEh9jSw4J](https://groups.google.com/d/msg/gremlin-users/xhqP-0wIg5s/bxkNEh9jSw4J)

更新 2：

如果顶点的 ID`a`和`b`是提前知道的，那么它就更容易了：

```
g.v(a).outE(label).filter{it.inVertex.id == b}.prop 
```

如果顶点`a`和`b`是提前知道的，那么它是：

```
a.outE(label).filter{it.inVertex == b}.prop 
```

# javascript - 在jquery中制作带有功能的按钮？

> ID：11227568
> 
> 赞同：0
> 
> 时间：2012-06-27T13:40:09.643
> 
> 标签：javascript, jquery

我正在尝试制作一个带有单击功能的按钮来运行我的 jquery：

```
Function tester(){alert("test")} 
```

我的原始 html 按钮代码是：

```
<button class="t1" id="52" onClick="tester()">sometext</button> 
```

但我想只使用 jquery 代码来制作按钮......

我怎样才能用jquery制作这个按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:45:02.753

您可以使用 append() 函数

有一个 div

```
<div id="buttonholder"> </div> 
```

jQuery :

```
$('#buttonholder').append('<button class="t1" id="52" onClick="tester()">sometext</button>'); 
```

或者

```
$('<button class="t1" id="52" onClick="tester()">sometext</button>').appendTo('#buttonholder'); 
```

顺便提一句

**函数**.. **f**应该很小

# java - 适用于 Java 的 GAE Google App Engine Captcha（无第 3 方）

> ID：11227572
> 
> 赞同：1
> 
> 时间：2012-06-27T13:40:18.370
> 
> 标签：java, google-app-engine, awt, captcha, recaptcha

我需要 Java 中的 GAE 验证码解决方案。我的客户只能访问托管我的应用程序的 IP，因此他们不能依赖重新验证码或此类解决方案。

由于 awt 图像类被阻止。你知道任何简单的图像生成解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T15:29:38.667

我找到了一个适用于 GAE 的文本到图像库： [Litetext](http://code.google.com/p/litetext/)

但这对于验证码来说还不够安全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T23:19:51.817

[您可以使用Images API](https://developers.google.com/appengine/docs/java/images/overview)构建自己的 CAPTCHA 图像。将每个字母字符的一个或多个图像预加载到 Blobstore 中，然后使用可用转换的组合。这些包括调整大小、旋转、翻转、裁剪和合成，这将使您走得很远。结果可能不会非常抵抗协同的自动攻击，但总比没有好。

# javascript - Jquery .Change 和 .load 一起

> ID：11227575
> 
> 赞同：0
> 
> 时间：2012-06-27T13:40:22.240
> 
> 标签：javascript, jquery

我希望在使用 jquery 更改另一个文本框时更新一个文本框。这是我所拥有的：

```
$('#inputs').change(function() {
    var first_name=$(".first_name").val();
    var last_name=$(".last_name").val();
    var username=$(".username").val();
    var category=$(".category").val();
    if ((!empty(first_name))&&(!empty(last_name))&&(!empty(username))&&(category!="empty")) {
      form1.process.disabled = false;
    }
    else {
      form1.process.disabled = true;
    }
    $('.tweet').load('ajax.php?first='+first_name+'&last='+last_name+'&username='+username+'&category='+category);
}); 
```

但什么都没有发生。Ajax.php（不要问它为什么这么叫）很好。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:45:43.127

看起来你错过了`?`in `ajax.php?first=...`。无论页面本身是否正常工作，您的 ajax.php 网址都已损坏。

# jquery - jQuery中的'this'对象

> ID：11227577
> 
> 赞同：3
> 
> 时间：2012-06-27T13:40:25.843
> 
> 标签：jquery, this

`this`有人可以告诉我和有什么区别`jQuery(this)`吗？我发现我的代码在我使用 ' `this`' 时有效，而如果我使用`jQuery(this)`它则不起作用。)不`jQuery(this`查询当前对象并返回它吗？

我想知道被点击的图像的索引（我现在有了 index() 方法，但仍然希望通过下面的逻辑得到它）这是完整的代码：（根据请求编辑）

```
for(i=0;i<5;i++)
{
jQuery("#div1").append("<img src='slider.jpg'>");
}
imgArr=jQuery("#div1>img");
jQuery("#div1>img").click(display);
function display()
{
  for(i=0;i<imgArr.length;i++)
  {
     if(this==imgArr[i])
     {
      alert(i);
     }
  }
} 
```

在这里，如果我用它替换`this`它`jQuery(this)`不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T13:42:18.260

我想“this”是对您的第一个示例中的 DOM 元素的引用？

jQuery(this) 实际上是一个围绕一个或多个 DOM 元素的 jQuery 包装器。因此，当您与 DOM 元素进行比较时，它永远不会相等。

如果您想要来自 jQuery 包装器的 DOM 元素，请使用索引器获取第一个元素：

```
jQuery(this)[0] === this 
```

# wix - WIX 我在哪里可以找到 WixUi_en-us 文件？

> ID：11227578
> 
> 赞同：0
> 
> 时间：2012-06-27T13:40:27.703
> 
> 标签：wix, wix3.5, wix3, wix-extension

我已经安装了 Wix 3.5，我想自定义一些对话框，我在哪里可以找到 WixUi_en-us 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T14:46:46.720

[您需要从这里](http://wix.codeplex.com/releases/view/60102)下载 WiX 3.5 源代码。

解压缩文件。您要查找 UIExtension 文件夹，该文件夹位于结构类似的目录中`src\ext\UIExtension\wixlib`

编辑：乍一看，我没有看到那里发布的 WiX 3.5 源代码。也许别人知道。但是，如果您只需要该字符串文件，则可以通过下载最新[WiX 3.6 版本](http://wixtoolset.org/releases)之一的源代码来获取它。就特定文件而言，不确定是否有任何变化。

# python - 在 OSX 上的 python 中获取挂载类型信息

> ID：11227579
> 
> 赞同：1
> 
> 时间：2012-06-27T13:40:31.163
> 
> 标签：python, macos, mount

`/Volumes`有没有一种方法可以让我获得有关我在 OSX文件夹中的挂载的一些信息？

我希望能够区分磁盘映像（如 dmgs）和其他类型的磁盘映像（如硬盘或网络挂载）。

我尝试解析输出`mount -v`并查看是否`read-only`在行中，但我怀疑这是一种特别准确的判断方式，也不是一个好方法。

是否有任何模块或方法可以为我提供此信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T14:03:33.253

看看`diskutil(8)`和`hdiutil(1)`工具。

# jquery - JQuery 比较表数据

> ID：11227583
> 
> 赞同：0
> 
> 时间：2012-06-27T13:40:41.720
> 
> 标签：jquery, comparison

我有一个按日期分隔的大型数据表（显示测试数据）。我使用 JQuery 对这些数据进行后处理排序（该表是在 Perl 中构建的，并且确实无法在那里进行排序）。在此数据按日期排序后，我想在每天之间添加一条分隔线。

例如，我想要从 6 月 5 日开始的五个测试运行，然后是一个空白行（一个空白的“tr”，稍后会添加数据，但在这里并不重要），然后是 6 月 4 日的运行，然后一个空白行，然后是 6 月 3 日运行，等等。

这是我拥有的表格示例：http: [//jsfiddle.net/pyUz8/1/](http://jsfiddle.net/pyUz8/1/)

这是我的**伪代码**，只是不确定如何在 JQuery 中执行此操作：

> now = thisDate.substring(0,10) //只看日期，时间无所谓 then = previousDate.substring(0,10)
> 
> 如果（然后！= 现在）插入（`"<tr></tr>"`）；//在当时和现在之间

如何在 JQuery 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:10:33.273

遍历每一行，将当前日期与下一个日期进行比较，如果日期不同，则在当前行之后插入一个 tr。像这样的东西：

```
$('tr').each(function(){
  var current_date = $(this).children('.date_cell').val() // or whatever you call your date cell
  var next_date = $(this).next().children('.date_cell').val() // also strip these evaluations from the time as you described...
  if (current_date != next_date){
    $(this).after('<tr class="blank_row"></tr>)
  }
}) 
```

# visual-c++ - Visual C++：为什么派生类的观察视图不显示基类的字段？

> ID：11227584
> 
> 赞同：0
> 
> 时间：2012-06-27T13:40:46.267
> 
> 标签：visual-c++

我已将一些 MyClass 类拆分为 2 个类 MyClassBase 和 MyClassDerived，例如，请参见附图：

# 我的类派生

我只看到成员 MyClassDerived，没有其他基类成员的详细信息 [http://i46.tinypic.com/14ljwxs.jpg](http://i46.tinypic.com/14ljwxs.jpg)

我需要展开以查看更多班级成员

# 我的课

我看到更多的班级成员没有扩展 [http://i45.tinypic.com/mwfbzt.jpg](http://i45.tinypic.com/mwfbzt.jpg)

为什么手表不显示更多成员，有什么选项可以让手表显示更多成员吗？

# ruby - 自定义 IRB 输出

> ID：11227590
> 
> 赞同：1
> 
> 时间：2012-06-27T13:40:53.150
> 
> 标签：ruby, irb, inspect

我创建了一个名为 SpecialArray 的类，我想自定义 irb 显示的输出类型。目前，当我创建类的新实例时，irb 返回整个对象。这是我目前看到的：

```
1.9.3p194 :022 > SpecialArray.new([1,2,0,6,2,11]) 
=> #<UniqueArray:0x007ff05b026ec8 @input=[1, 2, 0, 6, 2, 11], @output=[1, 2, 0, 6, 11]> 
```

但我只想显示我定义为输出的内容。换句话说，我想看到这个。

```
1.9.3p194 :022 > SpecialArray.new([1,2,0,6,2,11]) 
=> [1, 2, 0, 6, 11] 
```

我需要做什么来指定 irb 应该只显示输出？

解决方案：

这是我最终创建的方法。

```
def inspect
  output.inspect
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T13:45:49.027

IRB 调用[`Object#inspect`](http://ruby-doc.org/core-1.9.3/Object.html#method-i-inspect)方法来获取对象的字符串表示形式。您只需要像这样覆盖此方法：

```
class Foo
  def inspect
    "foo:#{object_id}"
  end
end 
```

然后在 IRB 中你会得到：

```
>> Foo.new
=> foo:70250368430260 
```

在您的特定情况下，只需`SpecialArray#inspect`返回底层数组的字符串表示，例如：

```
SpecialArray
  def inspect
    @output.inspect
  end
end 
```

# android - 如何从另一个类引用当前或主要活动

> ID：11227591
> 
> 赞同：65
> 
> 时间：2012-06-27T13:40:54.560
> 
> 标签：android, android-activity, android-context

我经常发现自己需要访问需要引用某些活动的方法。例如，要使用`getWindowManager`，我需要访问一些 Activity。但通常我使用这些方法的代码位于其他没有引用活动的类中。到目前为止，我要么存储了对主要活动的引用，要么将某些活动的上下文传递给了类。有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2015-01-22T18:04:42.697

如果您已经有一个有效的上下文，只需使用这个： `Activity activity = (Activity) context;`

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-06-27T13:43:38.037

传递上下文是参考活动的更好方法。

您可以将 Context 传递给另一个类。

**活动中::**

```
AnotherClass Obj  = new AnotherClass(this); 
```

**在另一个班级**

```
class AnotherClass{

public AnotherClass(Context Context){

    }

} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-27T13:47:07.917

您可以在活动中实现必要的方法并实现[Handler](http://developer.android.com/reference/android/os/Handler.html)。然后，只需将处理程序实例传递给您的类，您可以在其中获取处理程序的消息并将其发送到目标。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-02T12:57:04.693

我找到了一种将 Activity 带到我没有在论坛中讨论过的非活动类的方法。这是在多次尝试使用 getApplicationContext() 并将上下文作为参数传递给构造函数的失败之后，这些尝试都没有提供 Activity。我看到我的适配器正在将传入的上下文转换为 Activity，所以我对我的非活动类构造函数进行了相同的转换：

```
public class HandleDropdown extends Application{
...
    public Activity activity;
...
public HandleDropdown() {
    super();
}
public HandleDropdown(Activity context) {
    this.activity = context;
    this.context = context;
}
public void DropList(View v,Activity context) {
    this.activity = context;
    this.context = context; 
...
} 
```

在将 Context 转换为 Activity 之后，我可以在需要 Activity 上下文的任何地方使用 this.activity。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-03-11T18:26:27.620

我是 android 新手，所以我的建议可能看起来很笨拙，但是如果您只是创建对您的活动的引用作为私有属性并在 OnCreate 方法中分配它呢？您甚至可以像这样使用 OnCreate 创建您的 CustomActivity，并从您的 CustomActivity 派生所有活动，而不是由 adnroid 提供的通用 Activity。

```
class blah extends Activity{
  private Activity activityReference;
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        activityReference = this;
    }

}
```

之后你可以按照你想要的方式使用它，即

```
Intent i = new Intent(activityReference, SomeOtherActivity.class) 
```

ETC

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-27T13:52:48.527

您可以使您的应用程序实例成为单例，并在需要 Context 时使用它

这个问题有一个例子：
[Android Application as Singleton](https://stackoverflow.com/questions/9178245/android-application-as-singleton)

这样，当您需要 Context 时，您可以使用
`Context context = MyApplication.getInstance()`

这可能不是最干净的解决方案，但到目前为止它对我来说效果很好

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-06-27T14:34:50.933

我们为此建立了一个框架。我们有一个`BaseActivity`继承自的类，`Activity`它覆盖了所有生命周期方法，并有一些静态（类）变量来跟踪活动堆栈。如果有任何东西想知道当前活动是什么，它只需调用一个静态方法，`BaseActivity`该方法返回我们私有管理堆栈顶部的活动。

这有点hacky，但它有效。我不确定我会推荐它。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-06-27T13:46:32.143

活动通信有多种方式。

您可以使用：

*   startActivityForResult 方法

*   广播消息和接收者的系统（你可以从实际活动中广播一个事件，并在目标活动中注册一个接收者。记住目标活动必须事先初始化且未完成）

*   正如您所说，在您需要的任何地方存储目标活动的引用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-27T13:49:12.030

处理您想要执行这些方法的类中的 Intent，并在 Bundle 中将您的信息发送给它，如下所示：

```
 Intent i = new Intent("android.intent.action.MAIN");
    i.setComponent(new ComponentName("com.my.pkg","com.my.pkg.myActivity"));
    Bundle data = new Bundle();

    i.putExtras(data);

    startActivityForResult(i); 
```

然后使用 OnActivityResultListener 获取新数据。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-07-14T04:11:50.963

我通过使单例类具有以下类的实例作为成员来解决此问题。

```
public class InterActivityReferrer <T> {
    HashMap<Integer, T> map;
    ArrayList<Integer> reserve;

    public InterActivityReferrer() {
        map = new HashMap<>();
        reserve = new ArrayList<>();
    }

    public synchronized int attach(T obj) {
        int id;
        if (reserve.isEmpty()) {
            id = reserve.size();
        }
        else {
            id = reserve.remove(reserve.size() - 1);
        }

        map.put(id, obj);
        return id;
    }

    public synchronized T get(int id) {
        return map.get(id);
    }

    public synchronized T detach(int id) {
        T obj = map.remove(id);
        if (obj != null) reserve.add(id);
        return obj;
    }
} 
```

此类可以获取一个 T 对象并返回一个由 attach() 分配给该对象的唯一整数。除非 HashMap 失败，否则分配的整数不会相互冲突。每个分配的整数将在其对应的对象被 detach() 分离时被释放。附加新对象时，将重用释放的整数。

从单例类：

```
public class SomeSingleton {
    ...
    private InterActivityReferrer<Activity> referrer = new InterActivityReferrer<>();
    ...
    public InterActivityReferrer<Activity> getReferrer() {return referrer;}
} 
```

从需要参考的活动中：

```
 ...
    int activityID = SomeSingleton.getInstance().getReferrer().attach(this);
    ... 
```

现在有了这个，一个与这个活动实例相对应的唯一整数被返回。并且可以使用 Intent 和 putExtra() 将整数传递到另一个启动活动中。

```
 ...
    Intent i = new Intent(this, AnotherActivity.class);
    i.putExtra("thisActivityID", activityID);
    startActivityForResult(i, SOME_INTEGER);
    ... 
```

从另一个活动：

```
 ...
    id refereeID = getIntent().getIntExtra("thisActivityID", -1);
    Activity referredActivity = SomeSingleton.getInstance().getReferrer().get(refereeID);
    ... 
```

最后可以参考活动。并且 InterActivityReferrer 可以用于任何其他类。

我希望这有帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-11-29T15:58:56.173

```
public static Activity getLaunchActivity()
{
    final Class<?> activityThreadClass = Class.forName("android.app.ActivityThread");

    final Method methodApp = activityThreadClass.getMethod("currentApplication");
    App = (Application) methodApp.invoke(null, (Object[]) null);
    Intent launcherIntent = App.getPackageManager().getLaunchIntentForPackage(App.getPackageName());
    launchActivityInfo = launcherIntent.resolveActivityInfo(App.getPackageManager(), 0);
    Class<?> clazz;
    try
    {
        clazz = Class.forName(launchActivityInfo.name);
        if(clazz != null)
            return Activity.class.cast(clazz.newInstance());
    }
    catch (Exception e)
    {}

    return null;
} 
```

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2012-06-27T14:10:11.530

只是一个猜测，因为我还没有这样做，但它可能会起作用。

1) 通过使您的 Android Application 类成为 Singleton 来获取您的 applicationContext。

2）从上下文中获取您的 ActivityManager 类。

3) 使用 ActivityManager 上的 getRunningTasks() 获取 RunningTaskInfos 列表。

4) 从列表中获取第一个 RunningTaskInfo 元素，该元素应该是最近启动的任务。

5) 在该 RunningTaskInfo 上调用 topActivity，它应该为您返回该任务的活动堆栈上的顶部活动。

现在，这似乎比这里提到的任何其他方法都要做更多的工作，但是您可能可以将其封装在一个静态类中并随时调用它。似乎它可能是在不添加对活动的引用的情况下获得堆栈顶部活动的唯一方法。

# automapper - AutoMapper 版本 1.0.0.155 所需的源代码

> ID：11227596
> 
> 赞同：1
> 
> 时间：2012-06-27T13:41:09.427
> 
> 标签：automapper

我需要 AutoMapper 版本 1.0.0.155 的源代码

如果您可以共享可以下载的链接，那将很有帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T13:53:22.237

这是[v1.0.zip — 1.0 版](https://github.com/AutoMapper/AutoMapper/tags)。如您所述，它具有修订版 155。

# android - 每行中具有动态列数的 GridView

> ID：11227597
> 
> 赞同：10
> 
> 时间：2012-06-27T13:41:12.317
> 
> 标签：android

如何在`GridView`.

![在此处输入图像描述](../Images/772b8b593f9767d36b3cc1a1fcc712ed.png)

列表中的项目数是动态的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:46:11.580

我猜这不是单个 GridView 而是多个布局的组合。只需制作一个 LinearLayout 并根据内容决定要连续使用哪种布局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:52:56.353

要获得您看到的布局，您可以使用以下内容：

```
<LinearLayout android:orientation="vertical">
    <!-- First row -->
    <View />

    <!-- Second row -->
    <LinearLayout android:orientation="horizontal" />

    <!-- Third row -->
    <LinearLayout android:orientation="horizontal" />

    <!-- Fourth row -->
    <View />

</LinearLayout> 
```

如果您还想要分页效果，您可以使用 ViewPager

[http://android-developers.blogspot.it/2011/08/horizo​​ntal-view-swiping-with-viewpager.html](http://android-developers.blogspot.it/2011/08/horizontal-view-swiping-with-viewpager.html)

# java - getApplicationContext() 返回 null

> ID：11227604
> 
> 赞同：1
> 
> 时间：2012-06-27T13:41:29.083
> 
> 标签：java, junit, javabeans, applicationcontext

我制作了一个 config.xml 文件，其中包含一个 bean，并且来自一个我正在调用该 bean 的类。

我的代码在这里调用 bean。

```
admin = (WebServiceOperations)getApplicationContext().getBean("webService"); 
```

它给出了 nullPointerException，因为方法 getApplicationContext() 给出了 null。

我的类路径中的配置文件也是。

我的配置文件是：

```
<oxm:jaxb2-marshaller id="marshaller" contextPath="a.b.c" />
<bean id="enrollment" class="org.springframework.ws.client.core.WebServiceTemplate">    
    <property name="marshaller" ref="marshaller" />
    <property name="unmarshaller" ref="marshaller" />
    <property name="defaultUri"
        value="http://dev05:8080/webService/enrol"/>
</bean> 
```

错误是

```
junit.framework.AssertionFailedError: Exception in constructor: test_M (java.lang.NullPointerException
at com.gfe.services.integration.TestAdminMethodsWebService.<init>(TestAdminMethodsWebService.java:45)
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
at java.lang.reflect.Constructor.newInstance(Constructor.java:532)
at junit.framework.TestSuite.createTest(TestSuite.java:61)
at junit.framework.TestSuite.addTestMethod(TestSuite.java:283)
at junit.framework.TestSuite.<init>(TestSuite.java:146)
at org.junit.internal.runners.JUnit38ClassRunner.<init>(JUnit38ClassRunner.java:69)
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
at java.lang.reflect.Constructor.newInstance(Constructor.java:532)
at org.junit.internal.requests.ClassRequest.buildRunner(ClassRequest.java:33)
at org.junit.internal.requests.ClassRequest.getRunner(ClassRequest.java:28)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.<init>(JUnit4TestReference.java:33)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestClassReference.<init>(JUnit4TestClassReference.java:25)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestLoader.createTest(JUnit4TestLoader.java:48)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestLoader.loadTests(JUnit4TestLoader.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:452)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
at junit.framework.Assert.fail(Assert.java:47)
at junit.framework.TestSuite$1.runTest(TestSuite.java:97)
at junit.framework.TestCase.runBare(TestCase.java:134)
at junit.framework.TestResult$1.protect(TestResult.java:110)
at junit.framework.TestResult.runProtected(TestResult.java:128)
at junit.framework.TestResult.run(TestResult.java:113)
at junit.framework.TestCase.run(TestCase.java:124)
at junit.framework.TestSuite.runTest(TestSuite.java:232)
at junit.framework.TestSuite.run(TestSuite.java:227)
at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:81)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

请帮助我任何形式的帮助都是可观的。谢谢你。

# windows - 如何从本地 svn 副本（而不是 svn 服务器）签出子文件夹？

> ID：11227608
> 
> 赞同：2
> 
> 时间：2012-06-27T13:41:34.983
> 
> 标签：windows, svn

对于一些简单的 Windows 批处理脚本，我想在某个版本的 svn 存储库的本地工作副本中临时创建某个文件夹的副本。我不想直接从 svn 服务器结帐（因为我的脚本需要知道服务器地址是什么，并且可能需要进行身份验证等）而且我不能只复制子文件夹，因为隐藏的 .svn 文件夹更高。

我一直在尝试一些变体（使用`repo`包含`.svn`隐藏文件夹的文件夹）：

```
svn co file:///E:/repo/paper@48 E:/temprepo 
```

但这不起作用。我的 Windows 7 命令提示符回答为

```
svn: E180001: Unable to connect to a repository at URL 'file:///E:/repo/paper'
svn: E180001: Unable to open an ra_local session to URL
svn: E180001: Unable to open repository 'file:///E:/repo/paper' 
```

我做错了什么，或者我正在尝试的事情是不可能的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T14:45:36.583

你的问题似乎有点模棱两可。我可以想到两种看待这个问题的方法。

1.  假设您只想要 svn 工作副本中的子文件夹副本，而没有 .svn 文件夹。您可以使用`svn export`像这样复制工作副本的给定子文件夹 - `svn export E:\repo\paper E:\temprepo`。

2.  引用：

    > 而且我不能只复制子文件夹，因为隐藏的 .svn 文件夹更高。

    *编辑：*此文件结构仅在 subversion v 1.7 中可用。在具有 1.6.x 版本的 subversion 客户端中，工作副本中的子文件夹应该是独立的。这意味着您可以将其复制到另一个地方，并`svn update`在其中进行诸如此类的颠覆操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T16:24:32.183

正如您在问题中正确提到的那样，您拥有 subversion 存储库的工作副本，而不是它自己的存储库。

您只能签出恰好是您的颠覆服务器的存储库。

当您签出存储库时，存储库内容的原始版本位于“.svn”文件夹中。

当您的工作副本与原始内容不同时，这就是 svn 向您显示差异的方式，而无需将其请求路由到服务器。

它还保留您的服务器地址的元数据和您在执行时可以看到的其他信息`svn info`。这还包含您的服务器地址作为 svn url。

您的工作副本和“.svn”文件夹完全识别出它所在的存储库。

我希望你明白为什么你不能从你自己的工作副本中签出。

# python - 从十进制中删除尾随零

> ID：11227620
> 
> 赞同：61
> 
> 时间：2012-06-27T13:42:09.507
> 
> 标签：python, decimal

我有一长串小数，我必须根据某些条件调整 10、100、1000、..... 1000000 的因子。当我将它们相乘时，有时我想去掉一个无用的尾随零（尽管并非总是如此）。例如...

```
from decimal import Decimal

# outputs 25.0,  PROBLEM!  I would like it to output 25
print Decimal('2.5') * 10

# outputs 2567.8000, PROBLEM!  I would like it to output 2567.8
print Decimal('2.5678') * 1000 
```

是否有一个函数可以告诉十进制对象删除这些无关紧要的零？我能想到的唯一方法是转换为字符串并使用正则表达式替换它们。

可能应该提到我正在使用 python 2.6.5

编辑 senderle 的好回答让我意识到我偶尔会得到一个像 250.0 这样的数字，当归一化时会产生 2.5E+2。我想在这些情况下，我可以尝试将它们整理出来并转换为 int

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2012-06-27T13:48:03.073

您可以使用该[`normalize`](http://docs.python.org/2/library/decimal.html#decimal.Decimal.normalize)方法来消除额外的精度。

```
>>> print decimal.Decimal('5.500')
5.500
>>> print decimal.Decimal('5.500').normalize()
5.5 
```

为避免在小数点左侧去除零，您可以这样做：

```
def normalize_fraction(d):
    normalized = d.normalize()
    sign, digits, exponent = normalized.as_tuple()
    if exponent > 0:
        return decimal.Decimal((sign, digits + (0,) * exponent, 0))
    else:
        return normalized 
```

或者更紧凑，按照[user7116](https://stackoverflow.com/questions/11227620/drop-trailing-zeros-from-decimal/11227743#comment14749895_11227743)`quantize`的建议使用：

```
def normalize_fraction(d):
    normalized = d.normalize()
    sign, digit, exponent = normalized.as_tuple()
    return normalized if exponent <= 0 else normalized.quantize(1) 
```

您也可以按照[此处](https://stackoverflow.com/a/18769210/577088)`to_integral()`所示使用，但我认为使用这种方式更能自我记录。`as_tuple`

我在几个案例中测试了这两个；如果您发现某些内容不起作用，请发表评论。

```
>>> normalize_fraction(decimal.Decimal('55.5'))
Decimal('55.5')
>>> normalize_fraction(decimal.Decimal('55.500'))
Decimal('55.5')
>>> normalize_fraction(decimal.Decimal('55500'))
Decimal('55500')
>>> normalize_fraction(decimal.Decimal('555E2'))
Decimal('55500') 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2012-06-27T13:54:51.040

这样做可能有更好的方法，但您可以使用它`.rstrip('0').rstrip('.')`来实现您想要的结果。

以您的数字为例：

```
>>> s = str(Decimal('2.5') * 10)
>>> print s.rstrip('0').rstrip('.') if '.' in s else s
25
>>> s = str(Decimal('2.5678') * 1000)
>>> print s.rstrip('0').rstrip('.') if '.' in s else s
2567.8 
```

这是 gerrit 在评论中指出的问题的解决方法：

```
>>> s = str(Decimal('1500'))
>>> print s.rstrip('0').rstrip('.') if '.' in s else s
1500 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2013-09-12T16:04:16.920

[文档中的`Decimal`常见问题](https://docs.python.org/library/decimal.html#decimal-faq)解答：

```
>>> def remove_exponent(d):
...     return d.quantize(Decimal(1)) if d == d.to_integral() else d.normalize()

>>> remove_exponent(Decimal('5.00'))
Decimal('5')

>>> remove_exponent(Decimal('5.500'))
Decimal('5.5')

>>> remove_exponent(Decimal('5E+3'))
Decimal('5000') 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2017-03-08T10:20:23.237

常见问题解答（[https://docs.python.org/2/library/decimal.html#decimal-faq](https://docs.python.org/2/library/decimal.html#decimal-faq)）中提到了答案，但没有解释。

要删除分数部分的尾随零，您应该使用`normalize`：

```
>>> Decimal('100.2000').normalize()
Decimal('100.2')
>> Decimal('0.2000').normalize()
Decimal('0.2') 
```

但这对于在尖锐部分带有前导零的数字来说是不同的：

```
>>> Decimal('100.0000').normalize()
Decimal('1E+2') 
```

在这种情况下，我们应该使用 `to_integral'：

```
>>> Decimal('100.000').to_integral()
Decimal('100') 
```

所以我们可以检查是否有分数部分：

```
>>> Decimal('100.2000') == Decimal('100.2000').to_integral()
False
>>> Decimal('100.0000') == Decimal('100.0000').to_integral()
True 
```

然后使用适当的方法：

```
def remove_exponent(num):
    return num.to_integral() if num == num.to_integral() else num.normalize() 
```

尝试一下：

```
>>> remove_exponent(Decimal('100.2000'))
Decimal('100.2')
>>> remove_exponent(Decimal('100.0000'))
Decimal('100')
>>> remove_exponent(Decimal('0.2000'))
Decimal('0.2') 
```

现在我们完成了。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-08-31T09:46:26.693

使用格式说明符`%g`。它似乎删除到尾随零。

```
>>> "%g" % (Decimal('2.5') * 10)
'25'
>>> "%g" % (Decimal('2.5678') * 1000)
'2567.8' 
```

它也可以在没有该`Decimal`功能的情况下工作

```
>>> "%g" % (2.5 * 10)
'25'
>>> "%g" % (2.5678 * 1000)
'2567.8' 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-04T21:50:43.850

### 我最终这样做了：

```
import decimal

def dropzeros(number):
    mynum = decimal.Decimal(number).normalize()
    # e.g 22000 --> Decimal('2.2E+4')
    return mynum.__trunc__() if not mynum % 1 else float(mynum)

print dropzeros(22000.000)
22000
print dropzeros(2567.8000)
2567.8 
```

注意：将返回值转换为字符串会将您限制为 12 位有效数字

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-08-07T23:26:04.660

[A-IV 答案的](https://stackoverflow.com/a/18769210/2234013)略微修改版本

**注意**将`Decimal('0.99999999999999999999999999995').normalize()`四舍五入`Decimal('1')`

```
def trailing(s: str, char="0"):
    return len(s) - len(s.rstrip(char))

def decimal_to_str(value: decimal.Decimal):
    """Convert decimal to str

    * Uses exponential notation when there are more than 4 trailing zeros
    * Handles decimal.InvalidOperation
    """
    # to_integral_value() removes decimals
    if value == value.to_integral_value():
        try:
            value = value.quantize(decimal.Decimal(1))
        except decimal.InvalidOperation:
            pass
        uncast = str(value)
        # use exponential notation if there are more that 4 zeros
        return str(value.normalize()) if trailing(uncast) > 4 else uncast
    else:
        # normalize values with decimal places
        return str(value.normalize())
        # or str(value).rstrip('0') if rounding edgecases are a concern 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2022-01-15T10:20:19.643

您可以使用 %g 来实现此目的：

'%g'%(3.140)

用 Python 吗？2.6: '{0:g}'.format(3.140)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-08-18T12:08:20.827

这应该有效：

```
'{:f}'.format(decimal.Decimal('2.5') * 10).rstrip('0').rstrip('.') 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-07-20T13:30:44.333

只是为了显示不同的可能性，我曾经`to_tuple()`达到相同的结果。

```
def my_normalize(dec):
    """
    >>> my_normalize(Decimal("12.500"))
    Decimal('12.5')
    >>> my_normalize(Decimal("-0.12500"))
    Decimal('-0.125')
    >>> my_normalize(Decimal("0.125"))
    Decimal('0.125')
    >>> my_normalize(Decimal("0.00125"))
    Decimal('0.00125')
    >>> my_normalize(Decimal("125.00"))
    Decimal('125')
    >>> my_normalize(Decimal("12500"))
    Decimal('12500')
    >>> my_normalize(Decimal("0.000"))
    Decimal('0')
    """
    if dec is None:
        return None

    sign, digs, exp = dec.as_tuple()
    for i in list(reversed(digs)):
        if exp >= 0 or i != 0:
            break
        exp += 1
        digs = digs[:-1]

    if not digs and exp < 0:
        exp = 0

    return Decimal((sign, digs, exp)) 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2015-04-05T10:22:40.930

为什么不使用 10 的倍数中的模块 10 来检查是否有余数？没有余数意味着您可以强制 int()

```
if (x * 10) % 10 == 0:
    x = int(x) 
```

x =`2/1`
输出：`2`

x =`3/2`
输出：`1.5`

# objective-c - 如何定义初始化程序以使用 BaseClass 对象填充 BaseClass 属性？

> ID：11227626
> 
> 赞同：0
> 
> 时间：2012-06-27T13:42:22.883
> 
> 标签：objective-c, ios

我有两节课：

```
BaseClass : NSObject
AdvanceClass : BaseClass 
```

在 AdvanceClass 我有一个初始化程序：

```
-(id)initWithBaseObject:(BaseClass *)bObj
{
    if(self = [super init]) {
        self = (AdvanceClass*)bObj;
    }

    return self;
} 
```

然后当我打电话时得到 TRUE 时：

```
[myObject isKindOfClass:[BaseClass class]] 
```

为什么？我正在将 bObj 转换为 AdvanceClass 对象。

我在这里要做的是将 BaseClass 的所有属性与 bObj 对象的属性一起分配。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:45:22.363

```
-(id)initWithBaseObject:(BaseClass *)bObj
{
    if(self = [super init]) {
        self = (AdvanceClass*)bObj; // this line of code discards the self = [super init]; and makes self a reference to a casted BaseClass object
        self.property1 = bObj.property1; // this is what you need to do for each property and remove the line with the cast
    }

    return self;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T14:37:28.337

我刚刚意识到最好的方法是编写一个公共方法`BaseClass`并从初始化程序中调用它。在这种情况下，您只能编写一次，并且只是进行编辑。

```
-(id)initWithBaseObject:(BaseClass *)bObj
{
    if(self = [super init]) {
        [self setBaseProperties:bObj];
    }

    return self;
} 
```

在 BaseClass.m

```
-(void)setBaseProperties:(BaseClass*)bObj
{
    _prop1 = bObj.prop1;
    _prop2 = bObj.prop2;
    .
    .
    .
} 
```

这是显而易见的解决方案，我很傻。

# excel - 使用 UTF-8 编码的 VBA Excel 宏写入文件

> ID：11227632
> 
> 赞同：3
> 
> 时间：2012-06-27T13:42:41.270
> 
> 标签：excel, vba, unicode, utf-8

我在 excel 中创建一个宏来处理电子表格并将内容（文本）写入文件。我需要将此文件编码为 UTF-8。我尝试使用 OpenTextFile(... TristateTrue) 和 StrConv(.. vbUnicode) 将文件作为 unicode 打开，但这些仅将其转换为 UTF-16。我在网上到处搜索，找不到任何东西。这甚至可能吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-23T04:22:16.977

```
Dim fsT As Object
Set fsT = CreateObject("ADODB.Stream")
fsT.Type = 2 'Specify stream type - we want To save text/string data.
fsT.Charset = "utf-8" 'Specify charset For the source text data.
fsT.Open 'Open the stream And write binary data To the object
fsT.WriteText "special characters: äöüß"
fsT.SaveToFile sFileName, 2 'Save binary data To disk 
```

参考： [保存使用 VBA 编码的 UTF-8 文本文件](https://stackoverflow.com/questions/2524703/save-text-file-utf-8-encoded-with-vba)

# jquery - 复选框显示为未选中，但已选中

> ID：11227636
> 
> 赞同：2
> 
> 时间：2012-06-27T13:43:04.577
> 
> 标签：jquery, ruby-on-rails, checkbox

我对 jQuery 很陌生，所以如果我遗漏了一些明显的东西，我深表歉意，但是......我只想在用户单击复选框时隐藏我的表单的一部分。

所以，我写了这个小的 jQuery 脚本：

```
$("#belonging_entire_world").toggle(function() {
            $("#access_for_friends, #access_for_groups").fadeOut();
        }, function(){ 
            $("#access_for_friends, #access_for_groups").fadeIn();
}); 
```

当我单击标记为“belonging_entire_world”的复选框时，它会隐藏我想要的表单部分（由#access_for_friends 和#access_for_groups 表示的部分），如果我再次单击，它会再次显示该部分但复选框“belonging_entire_world” “我检查过的总是在视觉上未经检查......

如果我在脚本运行后打开 firebug，我会看到我的复选框确实具有 checked=checked 属性......仍然，它在浏览器中看起来未选中（在所有浏览器中！）......

我尝试在切换功能的第一个功能中添加以下内容：

```
$("#belonging_entire_world").attr('checked', true); 
```

但仍然......它仍然好像没有被检查......

这让我发疯，我没有看到删除 jQuery 代码的另一个选项，我真的不明白......我把视图的一部分放在下面：

```
<div id="Belonging-Access-Control">
      <h2> Who will be able to see & access this? </h2>
      <div class="field" id="entire_world">
        <%= f.check_box(:entire_world) %>
        <%= f.label(:entire_world, "The entire world!") %>
      </div>

      <div class="field" id="access_for_friends">
        <%= f.check_box(:access_for_friends) %>
        <%= f.label(:access_for_friends, "My friends") %>
      </div> 
```

和页面的 HTML，在我选中复选框（萤火虫输出）后：

```
<div id="Belonging-Access-Control">
<h2> Who will be able to see &amp; access this? </h2>
<div id="entire_world" class="field">
<input type="hidden" value="0" name="belonging[entire_world]">
<input id="belonging_entire_world" type="checkbox" value="1" name="belonging[entire_world]" checked="checked">
<label for="belonging_entire_world">The entire world!</label>
</div>
<div id="access_for_friends" class="field" style="display: none;">
<input type="hidden" value="0" name="belonging[access_for_friends]">
<input id="belonging_access_for_friends" type="checkbox" value="1" name="belonging[access_for_friends]">
<label for="belonging_access_for_friends">My friends</label>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:29:33.210

使用 .toggle() 似乎有问题。如果你使用这个功能可以吗？：

```
$("#belonging_entire_world").click(function() {
    if (this.checked) {
        $("#access_for_friends, #access_for_groups").fadeOut();
    } else {
        $("#access_for_friends, #access_for_groups").fadeIn();
    }
}); 
```

如果您想要相反的淡入淡出，您可以切换淡入淡出。如果复选框开始为“已选中”，这可能是一个更好的解决方案。因此，此代码将根据复选框的状态隐藏/显示其他 div，而不是切换它所在的阶段。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-27T15:10:10.600

.toggle() 如前所述有效，但是我个人更喜欢的另一种方法是检查复选框的[状态](http://api.jquery.com/checked-selector/)

这样，您可以链接不同的条件事件以显示/隐藏表单中的额外部分。

# javascript - 多个文本区域的字数限制

> ID：11227647
> 
> 赞同：0
> 
> 时间：2012-06-27T13:43:28.247
> 
> 标签：javascript, html, css, forms, textarea

我正在创建一个包含四个 textarea 表单的网站。每个表格都有字数限制。

*   textarea1：250字限制
*   textarea2：500字限制
*   textarea3：500字限制
*   textarea4：250字限制

我尝试使用在尝试解决此问题时发现的现有示例，但似乎没有任何效果。

```
 <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script>
var maxwords = 250;
//
function check_length(obj, cnt, rem)
{
    var ary = obj.value.split(" "); // doubled spaces will throw this off
    var len = ary.length;
    cnt.innerHTML = len;
    rem.innerHTML = maxwords - len;
    if (len > maxwords) {
        alert("Message in '" + obj.name + "' limited to " + maxwords + " words.");
        ary = ary.slice(0,maxwords-1);
        obj.value = ary.join(" "); // truncate additional words
        cnt.innerHTML = maxwords;
        rem.innerHTML = 0;
        return false;
    }
    return true;
} 

</script> 
```

HTML

```
 <textarea name="Message 1" onkeypress="
 return check_length(this,
 document.getElementById('count1'),
 document.getElementById('remaining1'));"></textarea>
Word count: <span id="count1">0</span> &nbsp;
Words remaining: <span id="remaining1">250</span>

<textarea name="Message 2" onkeypress="
 return check_length(this,
 document.getElementById('count2'),
 document.getElementById('remaining2'));"></textarea>
Word count: <span id="count2">0</span> &nbsp;
Words remaining: <span id="remaining2">500</span> 
```

有谁知道这个问题的解决方案？

在此先感谢，汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:07:11.193

向您的函数添加一个额外的参数，并从每个函数调用中将 maxWords 发送给它：

```
function check_length(obj, cnt, rem, maxwords)
{
//... rest of the function would stay the same 
```

当你调用它时，包括最大单词

```
<textarea name="Message 2" onkeypress="
 return check_length(this,
 document.getElementById('count2'),
 document.getElementById('remaining2'), 250);"></textarea>
Word count: <span id="count2">0</span> &nbsp;
Words remaining: <span id="remaining2">500</span> 
```

要删除剩余的单词，

```
function check_length(obj, cnt, maxwords)
{
    var ary = obj.value.split(" "); // doubled spaces will throw this off
    var len = ary.length;
    cnt.innerHTML = len;

    if (len > maxwords) {
        alert("Message in '" + obj.name + "' limited to " + maxwords + " words.");
        ary = ary.slice(0,maxwords-1);
        obj.value = ary.join(" "); // truncate additional words
        cnt.innerHTML = maxwords;
        return false;
    }
    return true;
} 
```

在您的 HTML 中，

```
<textarea name="Message 1" onkeypress="
return check_length(this,
document.getElementById('count1'),250);"></textarea>
Word count: <span id="count1">0</span> &nbsp; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T14:08:00.893

您的函数的问题是您总是检查插入的单词数量与`maxwords`变量（设置为 250 个单词作为第一个 textarea 限制）

所以更好的尝试是将额外的参数传递给具有原始限制的函数（每个文本区域不同）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T14:08:41.723

为这些文本区域插入一个`class`属性，（例如`class='area250'`，`class='area500'`等等）然后在函数中包含一个 if 语句

```
function check_length(obj, cnt, rem)
    {
        if(window.event.srcElement.getAttribute('class')=='area250')
            maxwords=250;
        else if(window.event.srcElement.getAttribute('class')=='area500')
            maxwords=500;
        else .......................................

    } 
```

# bash - 使用 BASH 和 Expect 进行远程 SSH 和命令执行

> ID：11227648
> 
> 赞同：3
> 
> 时间：2012-06-27T13:43:31.197
> 
> 标签：bash, ssh, expect

我正在尝试使用 bash 脚本实现以下目标：

1.  尝试 SSH 连接，如果失败，如果 SSH 连接成功则报错
2.  一旦确认，执行'top'命令并将结果保存到文件
3.  从远程服务器返回 scp 文件

我知道invidiual命令，这将是：1）检查ssh连接：

```
ssh -q user@ip exit 
```

`echo $?`

这应该在成功时返回“0”，在错误时返回“255”。

2）执行顶部并保存到文件将是：

```
top -n 1 -b > /tmp/top.out 
```

3) 来自远程主机的 scp back 文件

```
expect -c "
   set timeout 1
   spawn scp user@host:/tmp/top.out root@anotherhost:/.
   expect yes/no { send yes\r ; exp_continue }
   expect password: { send password\r }
   expect 100%
   sleep 1
   exit
" 
```

现在把这完全是我的问题，更具体地说：

*   使用 expect 测试 SCP 连接时，我似乎无法获得返回的“0”和“255”值。

    *   我似乎无法再次使用 expect 执行 top 命令，即这不起作用：

    期望 -c " 设置超时 1 生成 ssh 用户@主机顶部 -n 3 -b > /tmp/top.out 期望密码：{ 发送密码\r } 睡眠 1 退出 "

    *   因此第三位也不起作用。

任何帮助表示赞赏。请记住，我的脚本是带有**#!/bin/bash**声明的 .sh 脚本——由于各种原因，我不能使用*#!/usr/bin/expect*。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T14:45:16.797

现在那是丑陋的东西。有很多陷阱，可能您不太确定使用 shell 或普通 argv 数组执行的位置。此外，期望的东西不是应该做的方式，那只是脆弱的**。**

（AFAIK，`expect`主要用于与调制解调器（AT 命令集）等进行通信）。

对自动 ssh 和 scp 使用 SSH 密钥而不是密码。一旦你完成了（甚至之前，但你必须手动输入密码），在你的 shell 中启动它：

```
$ ssh user@server "top -n 1 -b" > /tmp/top.out 
```

并且该文件将在您的**本地**计算机上。（因为重定向是在本地完成的，而不是远程完成的）。无需 scp。

这里的所有都是它的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-07T15:30:41.597

检查这个： [https ://stackoverflow.com/a/23632210/524743](https://stackoverflow.com/a/23632210/524743)

```
expect <<'END'
log_user 0
spawn sh -c {echo hello; exit 42}
expect eof
puts $expect_out(buffer)

lassign [wait] pid spawnid os_error_flag value

if {$os_error_flag == 0} {
    puts "exit status: $value"
} else {
    puts "errno: $value"
}
END

hello

exit status: 42 
```

从期望手册页

> 等待[参数]
> 
> 延迟直到衍生的进程（或当前进程，如果没有被命名）终止。
> 
> wait 通常返回四个整数的列表。第一个整数是等待的进程的 pid。第二个整数是对应的 spawn id。如果发生操作系统错误，则第三个整数为 -1，否则为 0。如果第三个整数为 0，则第四个整数是衍生进程返回的状态。如果第三个整数是-1，第四个整数就是操作系统设置的errno值。还设置了全局变量 errorCode。

# c - 如何检查 sqlite3 中的默认列值在“c”/本机 sqlite3 中设置为无限

> ID：11227650
> 
> 赞同：3
> 
> 时间：2012-06-27T13:43:36.727
> 
> 标签：c, sqlite

我尝试如下使用 sqlite3 建立一个图形，只是想知道如何检查图形中的“无限”值是否被 sqlite3 视为无限。

```
sqlite> create table graph(nodeA INT, nodeB INT, length INT DEFAULT inf);

sqlite> insert into graph values(1,2,0);
sqlite> insert into graph values(1,3,null);
sqlite> insert into graph values (2,3,"inf");

sqlite> select * from graph;
1|2|0
1|3|
2|3|inf 
```

有什么好的建议吗？

# xml - XML DTD - xPath 1.0

> ID：11227654
> 
> 赞同：0
> 
> 时间：2012-06-27T13:43:44.567
> 
> 标签：xml, xpath

我有这个 dtd：

```
<!ELEMENT db (obj, prop*)>
<!ELEMENT obj (obj*)>
<!ATTLIST obj
    id ID #REQUIRED
>
<!ELEMENT prop (#PCDATA)>
<!ATTLIST prop
    objs IDREFS #REQUIRED
> 
```

我需要编写一个 xPath，它返回所有“prop”，其中“objs”包含带有孩子的“obj”。例如：

```
<db>
    <obj id="a007">
    <obj id="a008"> </obj>
        <obj id="a009">
            <obj id="a011"> </obj>
        </obj>
    </obj>   
    <obj id="a011"> </obj>
    <prop objs="a007 a011">
        "first"
    </prop>
    <prop objs="a007">
        "second"
    </prop>
    <prop objs="a009 a007">
        "third"
    </prop>
</db> 
```

a 希望它返回第二和第三。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:09:48.033

尝试 path `/db/prop[not(id(@objs)[not(obj)])]`，它会选择根元素的那些`prop`元素子节点，其中找不到没有子元素的元素。`db``id(@objs)``obj`

# matlab - 如何比较两张图片的质量？

> ID：11227657
> 
> 赞同：4
> 
> 时间：2012-06-27T13:43:50.340
> 
> 标签：matlab, image-processing, image-comparison, image-enhancement

我在特定图像上应用了两种不同的图像增强算法并得到了两个结果图像，现在我想比较这两个图像的质量，以找出这两个算法的有效性，并根据比较找到更合适的一个这两个图像的特征向量。那么在这种情况下我应该比较什么合适的特征向量？

我在比较图像的纹理特征以及哪个特征向量更合适的上下文中询问。

我需要数学支持来验证基于图像评估的任何一种算法的有效性，例如使用对比度和方差。那么还有其他方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T09:15:10.087

更好的方法是通过比较图像光谱来做一些噪声/信号比？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T18:21:48.730

Slayton 是对的，你需要一个指标和一种衡量它的方法，这本身就是一个学术项目。但是，我可以直接想到一种方法，不确定它是否对您手头的特定任务有意义：

* * *

**指标**：所有像素的绝对值（[色差）之和。](http://en.wikipedia.org/wiki/Color_difference)越低，图像越相似。

**方法**：对于每个像素，获取原始图像和处理后图像在 LAB 空间中的绝对色差（或准确地说是距离）并将其相加。不要破坏你试图理解完整的维基百科文章和编码的一天，这已经完成了。尝试重新使用这些方法`getDistanceLabFrom(Color color)`或`getDistanceRgbFrom(Color color)`从此[PHP 实现](https://github.com/hasbridge/php-color)。
当我需要一种方法来匹配 jpg 图片中的像素颜色时，它对我来说就像一种魅力——这基本上是相同的原理。

* * *

它背后的理论（就我有限的理解而言）：它正在对 rgb 或（更好的）实验室色彩空间作为一个三维空间进行数学抽象，然后计算距离，这就是它运作良好的原因 - 几乎没有用当我从一维的角度看颜色代码时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T10:44:11.520

通常的方法是从参考图像（一个好的）开始，然后在其上添加一些噪声（以受控方式）。

然后，您的算法应该尽可能多地消除添加的噪声。结果很容易与信噪比进行比较（参见维基百科）。

现在，该方法很容易应用于简单的噪声模型，但如果您的目标是改善更复杂的外观问题，则必须设计一种应用噪声的方法，这并不容易。

另一种非常常见的方法是 slayton 推荐的方法：让所有同事欣赏算法的输出，然后平均他们的印象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-10T21:49:36.977

如果您只有 2 张图片并且没有参考（最高质量）图片，那么您可以在那里看到我粗鲁的解决方案/bash 脚本：[https ://photo.stackexchange.com/questions/75995/how-do-i-compare-两个相似图像清晰度/117823#117823](https://photo.stackexchange.com/questions/75995/how-do-i-compare-two-similar-images-sharpness/117823#117823)

它获取 2 个文件名并输出更高质量的文件名。它假设图像的内容是相同的（相同的源图像）。虽然它可以被愚弄。

# php - 如何将 Jquery UI 滑块的文件添加到 wordpress？

> ID：11227660
> 
> 赞同：0
> 
> 时间：2012-06-27T13:43:52.547
> 
> 标签：php, jquery, wordpress

这是 nagendra，我是 wordpress 的新手，谁能解释如何将 Jquery ui 滑块添加到幻灯片以获取价格标签参考链接：http: [//jqueryui.com/demos/slider/#range](http://jqueryui.com/demos/slider/#range)代码到 wordpress？请清楚地告诉我有关在 wordpress 中包含代码的文件。请让我知道有人知道查询吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:51:16.357

`wp_enqueue_script`如有必要，在您的主题文件中使用`functions.php`以加载 jquery-ui 和 jquery。

此处的文档：http: [//codex.wordpress.org/Function_Reference/wp_enqueue_script](http://codex.wordpress.org/Function_Reference/wp_enqueue_script)

# html - 通过 http 标头添加 favicon

> ID：11227661
> 
> 赞同：8
> 
> 时间：2012-06-27T13:43:54.423
> 
> 标签：html, http-headers, favicon

假设我想在动态生成的页面（特别是 ADF Faces 页面，但这无关紧要）上添加一个网站图标。我无法修改生成的 html 的标签。所以我尝试在 servlet 标头中添加一个 http-header。我希望我的标题与 html 头元素相同：

```
<link rel="shortcut icon" href="http://foo.com/favicon.ico"> 
```

我这样添加它：

```
httpResponse.addHeader("Link", "<http://foo.com/favicon.ico>; rel=\"shortcut icon\""); 
```

在我的浏览器中，我看到了这个标题作为响应：

```
Link: <http://foo.com/favicon.ico>; rel="shortcut icon" 
```

但是，不幸的是，这在 IE 或 Chrome 中没有任何影响。有人试图实现同样的目标吗？难道我做错了什么？那应该工作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T14:09:47.503

答案是：这种方法依赖于尚未实施的拟议标准（草案）（感谢[Salman A](https://stackoverflow.com/users/87015/salman-a)指出这一点）。虽然如果它工作会很棒。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-03T00:58:15.897

是的，链接标头自 2010 年 10 月以来一直是[RFC 5988](http://datatracker.ietf.org/doc/rfc5988/)中定义的标准，但我见过的唯一[链接关系适用于样式表，并且仅在某些浏览器中。](http://www.iana.org/assignments/link-relations/link-relations.xml)

另请参阅：[HTTP 标头样式表](https://stackoverflow.com/questions/8091996/http-header-stylesheets)

@dragn 的建议是完全可行的，并且在规范中浏览器不采用的原因超出了我的范围。还有一些其他有用的关系，例如预取、书签和词汇表等等。他们至少可以通知用户存在链接并将其作为下拉菜单或菜单提供。也许需要一个插件来向浏览器供应商展示我们希望它做什么，因为他们似乎都感到困惑。有什么建议么？

现在我想我们必须等到 2020 年才能使用这个功能，这似乎是趋势。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-20T11:28:37.483

# *对对对“**草稿**”..*

反正..

## 如果你想看看如何*在实践*中使用它，这里有一个例子[（取自[icompile.eladkarako.com](http://icompile.eladkarako.com)）]

```
<ifModule mod_headers.c>
  Header set Link <http://icompile.eladkarako.com/favicon.ico>; REL="shortcut icon"; TYPE="image/x-icon"
  Header set Link <http://icompile.eladkarako.com/favicon.ico>; REL="icon"; TYPE="image/x-icon"
  Header set Link <http://icompile.eladkarako.com/img/apple-touch-icon.png>; REL="apple-touch-icon"; TYPE="image/png"; sizes="316x316"
</ifModule> 
```

它将在当前的 Chromium/Google Chrome/Google Canary 中工作，

（并且确定如果您将开关设置为`advance web-features`in `chrome://flags`）

# ruby-on-rails - 资产管道图像子目录 heroku

> ID：11227662
> 
> 赞同：2
> 
> 时间：2012-06-27T13:43:54.653
> 
> 标签：ruby-on-rails, ruby, heroku, sass, assets

好的，所以我在*assets/images/icons中有一个名为**icons*的子目录。

 *在我使用 sass 的 css 中，如果我这样做：

`background: transparent image-url("mobile.png") no-repeat left center;`

然后推送到heroku，它完美无缺，背景显示没有问题。

但如果我这样做：

`background: transparent image-url("icons/mobile.png") no-repeat left center;`

背景根本没有出现。

到目前为止我发现了什么：

*   我的 css 中所有显示图像的背景 url（不在子目录中的）都是`/assets/mobile-circle-header-fac4f74ae28c8147aaf9dbca8fb110e8.png`
*   子目录中未显示的图像就像`/assets/icons/mobile.png`没有摘要一样。
*   当我通过 image_tag 调用它们时，子目录中的图像会显示在我的 html 中，因此问题必须与 sass 隔离。

如果您需要更多信息，请尽管询问。

谢谢！

**编辑**

当我将子目录重命名为“图标”以外的其他名称时，它可以工作：O，有什么想法吗？哈哈...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-05T16:29:29.117

哈 - 只是有同样的错误，这是因为`Icon?`在 ~/.gitignore_global 中。我一定是这样添加的，操作系统生成的文件就是注释。

注意 - 您可以查看 heroku 上的资产预编译目录

```
$ heroku run bash
$ ls public/assets 
```

查看您的资产是否已编译。默认情况下，应添加所有图像子目录。这可能有助于确定是否存在其他问题。*

# windows - ITransferSource::MoveItem 移动没有内容的文件夹

> ID：11227663
> 
> 赞同：1
> 
> 时间：2012-06-27T13:44:04.050
> 
> 标签：windows, shell, drag-and-drop, explorer

我开发 NSE。它有文件和文件夹。实现了接口 ITransferSource 的组件。在拖放 (MOVE) 方法期间，调用 ITransferSource::MoveItem()。MOVE 必须作为 COPY&DELETE 实现，因此我为文件和 E_NOINTERFACE 返回 HRESULT_FROM_WIN32(ERROR_NOT_SAME_DEVICE)。文件已成功移动，但文件夹未成功移动。以下是资源管理器执行的调用顺序：

1.  ITransferSource::MoveItem() - 我返回 E_NOINTERFACE
2.  ITransferSource::OpenItem() - 我返回用于读取文件夹的资源。
3.  IShellItemResources::GetSize() - 我为文件夹返回 0
4.  IShellItemResources::GetAttributes() - 我返回 FILE_ATTRIBUTE_DIRECTORY IShellFolder::EnumObjects() - 资源管理器进入文件夹并枚举子项。对于每个项目，检查项目是否为文件夹。
5.  ITransferSource::RemoveItem() - 文件夹被删除

如您所见，文件夹被复制和删除，但子项被跳过。Explorer 知道它们存在（通过 EnumObjects）但不会复制它们。

# jquery - 如何使用 jquery post 向服务器提交数据

> ID：11227665
> 
> 赞同：-1
> 
> 时间：2012-06-27T13:44:08.370
> 
> 标签：jquery, json, post

我正在使用 jquery post 在服务器上提交数据，并且数据具有 json 数组作为其中一个值。

```
$.post({
type: "POST",
url: "http://someurl",
data: {
    id = 12345, order_items: [{
        "product_id": "1065",
        "sku": {
            "SKU": "RHJ",
            "msg": "In Stock"
        },
        "qty": "1"
    }]
    cup = 0, 
    rec = 0
}, 
```

});

现在我怎样才能发布它并得到结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:47:36.873

而不是 $>post 使用 $.ajax 请求，这将为您提供很好的控制权。

```
$.ajax(
{
    type : 'POST',
    data : $(this).serialize(), // this = $('#form_id') is form id
    url  : $(this).attr('action'),
    //dataType:'json',
    success : function(data)
    {
        $('#wrapper').html(data);
    }
}); 
```

# python - 获取 OAuth 身份验证 URL 时出错

> ID：11227666
> 
> 赞同：0
> 
> 时间：2012-06-27T13:44:08.913
> 
> 标签：python, oauth-2.0, appharbor, httplib2

我在使用 AppHarbor API 之前授权用户的 Python 桌面应用程序中有以下代码。我正在遵循[知识库](http://support.appharbor.com/kb/api/oauth-v2)中提到的步骤，并具有以下身份验证代码：

```
 def OnAuthenticate(self, event):
    client_id = "" # My App's client id
    client_secret_key = "" # My App's secret key
    consumer = oauth2.Consumer(key=client_id, secret=client_secret_key)

    request_token_url = "https://appharbor.com/user/authorizations/new?client_id="+client_id+"&redirect_uri=http://localhost:8095"

    client = oauth2.Client( consumer )
    resp, content = client.request(request_token_url, "GET")
    ... 
```

但是，在发送请求时，响应不正确，这是错误：

```
client.request(request_token_url, "GET")
TypeError: must be string or buffer, not None 
```

我在这里缺少什么吗？

* * *

编辑：以下是抛出的堆栈跟踪：

```
 resp, content = client.request(request_token_url, "GET")
    File "C:\Python27\Lib\site-packages\oauth2-1.5.211-py2.7.egg\oauth2\__init__.py", line 682, in request
    connection_type=connection_type)
    File "C:\Python27\lib\site-packages\httplib2-0.7.4-py2.7.egg\httplib2\__init__.py", line 1544, in request
    (response, content) = self._request(conn, authority, uri, request_uri, method, body, headers, redirections, cachekey)
    File "C:\Python27\lib\site-packages\httplib2-0.7.4-py2.7.egg\httplib2\__init__.py", line 1342, in _request
   (response, content) = self.request(location, redirect_method, body=body, headers = headers, redirections = redirections - 1)
    File "C:\Python27\Lib\site-packages\oauth2-1.5.211-py2.7.egg\oauth2\__init__.py", line 662, in request
    req.sign_request(self.method, self.consumer, self.token)
    File "C:\Python27\Lib\site-packages\oauth2-1.5.211-py2.7.egg\oauth2\__init__.py", line 493, in sign_request
    self['oauth_body_hash'] = base64.b64encode(sha(self.body).digest())
    TypeError: must be string or buffer, not None 
```

在调试到调用后，我到达了发出请求的 httplib2._request 函数

```
(response, content) = self._conn_request(conn, request_uri, method, body, headers) 
```

这导致以下页面出现错误响应 = 302（在内容对象中显示）

```
<html><head><title>Object moved</title></head><body>
<h2>Object moved to <a href="https://appharbor.com/session/new?returnUrl=%2Fuser%
 2Fauthorizations%2Fnew%3Foauth_body_hash%3D2jmj7l5rSw0yVb%252FvlWAYkK%252FYBwk%
 253D%26oauth_nonce%3D85804131%26oauth_timestamp%3D1340873274%
 26oauth_consumer_key%3D26bacb38-ce5a-4699-9342-8e496c16dc49%26oauth_signature_method%
 3DHMAC-SHA1%26oauth_version%3D1.0%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%
 253A8095%26client_id%3D26bacb38-ce5a-4699-9342-8e496c16dc49%26oauth_signature%
 3DXQtYvWIsvML9ZM6Wfs1Wp%252Fy3No8%253D">here</a>.</h2>
 </body></html> 
```

该函数接下来从内容中删除主体以调用另一个主体设置为无的请求，从而导致引发错误。

```
(response, content) = self.request(location, redirect_method, body=body, headers = headers, redirections = redirections - 1) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T12:22:50.440

我对Python lib不熟悉，但是您是否考虑过这是否是因为您需要带用户通过[三足流Twitter流](https://github.com/simplegeo/python-oauth2)并使用您在问题中提到的url作为authorize_url？获得代码后，您可以通过 POST 到此 url: 来检索令牌`https://appharbor.com/tokens`。

您可能还想仔细查看[桌面 OAuth .NET 示例](http://blog.appharbor.com/2012/06/21/oauth-for-net-desktop-applications)，以更好地了解其工作原理。

# c# - 文件无法访问，因为它被另一个进程异常使用

> ID：11227668
> 
> 赞同：2
> 
> 时间：2012-06-27T13:44:15.700
> 
> 标签：c#, wpf, visual-studio, image, file-io

我正在 WPF 应用程序中执行图像读取/复制操作。请看以下代码：

```
try
{
  if (sourceDir != "")
    File.Copy(sourceDir, Path.Combine(backupDir, ecode + ".jpg"), true);
}
catch (Exception exx)
{
    MessageBox.Show(exx.ToString());
} 
```

现在让我们用一个场景来解释问题：
第一次执行此代码时`sourceDir`，`Path.Combine(backupDir, ecode + ".jpg")`值是：
**sourceDir** ="C:\Users\Public\Pictures\Sample Pictures\Desert.jpg"
**Path.Combine(backupDir, ecode + ".jpg" )** ="D:\IEPL-archives-Do not Modify\DATA\654.jpg"
它第一次工作正常，文件被复制到其目标文件夹。

但是第二次使用以下值执行此代码时：
**sourceDir** ="C:\Users\Public\Pictures\Sample Pictures\Penguins.jpg"
**Path.Combine(backupDir, ecode + ".jpg")** ="D:\ IEPL-archives-Do not Modify\DATA\654.jpg"
它抛出以下异常：

![在此处输入图像描述](../Images/66bf50568365fa86ef20a15281375ba8.png)

我也在 UI 中显示相同的图像，这导致了这个异常。这是在 UI 中显示图像的代码：

```
image1.Source = new BitmapImage(new Uri(GetPicture(txtBarcode.Text), UriKind.RelativeOrAbsolute));
private string GetPicture(string _eid)
    {
        string picname = "";
        if (File.Exists(@"D:\IEPL-archives-Do not Modify\DATA\" + _eid + ".jpg"))
            picname = @"D:\IEPL-archives-Do not Modify\DATA\" + _eid + ".jpg";
        else if (File.Exists(@"D:\IEPL-archives-Do not Modify\DATA\" + _eid + ".jpeg"))
            picname = @"D:\IEPL-archives-Do not Modify\DATA\" + _eid + ".jpeg";
        else if (File.Exists(@"D:\IEPL-archives-Do not Modify\DATA\" + _eid + ".png"))
            picname = @"D:\IEPL-archives-Do not Modify\DATA\" + _eid + ".png";
        else if (File.Exists(@"D:\IEPL-archives-Do not Modify\DATA\" + _eid + ".gif"))
            picname = @"D:\IEPL-archives-Do not Modify\DATA\" + _eid + ".gif";
        else if (File.Exists(@"D:\IEPL-archives-Do not Modify\DATA\" + _eid + ".JPG"))
            picname = @"D:\IEPL-archives-Do not Modify\DATA\" + _eid + ".JPG";
        else if (File.Exists(@"D:\IEPL-archives-Do not Modify\DATA\" + _eid + ".JPEG"))
            picname = @"D:\IEPL-archives-Do not Modify\DATA\" + _eid + ".JPEG";
        else if (File.Exists(@"D:\IEPL-archives-Do not Modify\DATA\" + _eid + ".PNG"))
            picname = @"D:\IEPL-archives-Do not Modify\DATA\" + _eid + ".PNG";
        else if (File.Exists(@"D:\IEPL-archives-Do not Modify\DATA\" + _eid + ".GIF"))
            picname = @"D:\IEPL-archives-Do not Modify\DATA\" + _eid + ".GIF";
        else
            picname = @"Images\defaultPicture.jpg";
        return picname;
    } 
```

请建议我如何修改代码以免出现这种冲突？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T14:00:22.203

您应该使用`BitmapCacheOption.OnLoad`. 这将释放文件上的锁定。

```
BitmapImage bi = new BitmapImage();
bi.BeginInit();

bi.CacheOption = BitmapCacheOption.OnLoad;
bi.UriSource = new Uri(GetPicture(txtBarcode.Text), UriKind.RelativeOrAbsolute);

// End initialization.
bi.EndInit();
image1.Source = bi; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T14:04:03.560

根据之前的评论，可能是文件句柄在 UI 中显示后保持打开状态。所以我猜在你第一次复制它然后显示它之后，句柄可能永远不会关闭。

而且，当您不断覆盖相同的目标图像名称时，代码会引发上述异常。

例如，如果您使用某种方法`Image.FromFile()`，情况正是如此。这确实使句柄保持打开状态，直到应用程序结束......

[更新问题后编辑]

您需要将缓存选项更改为：

从[MSDN 文档](http://msdn.microsoft.com/de-de/library/system.windows.media.imaging.bitmapimage.cacheoption.aspx)：

> 如果您希望关闭用于创建 BitmapImage 的流，请将 CacheOption 设置为 BitmapCacheOption.OnLoad。默认的 OnDemand 缓存选项保留对流的访问，直到需要图像为止，并且清理由垃圾收集器处理。

*（从文档中复制的代码。）*

```
// Define a BitmapImage.
Image myImage = new Image();
BitmapImage bi = new BitmapImage();

// Begin initialization.
bi.BeginInit();

// Set properties.
bi.CacheOption = BitmapCacheOption.OnLoad; // <-- This is the important one
bi.CreateOptions = BitmapCreateOptions.DelayCreation;
bi.DecodePixelHeight = 125;
bi.DecodePixelWidth = 125;
bi.Rotation = Rotation.Rotate90;
MessageBox.Show(bi.IsDownloading.ToString());
bi.UriSource = new Uri("smiley.png", UriKind.Relative);

// End initialization.
bi.EndInit();
myImage.Source = bi;
myImage.Stretch = Stretch.None;
myImage.Margin = new Thickness(5); 
```

加载图像后，不要忘记抛出`NotifyPropertyChanged`WPF 识别更改的事件... ;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T14:02:03.843

我认为第一步是确定哪个进程锁定了您的文件。为此，我建议使用[来自 Sysinternals 的 Handle](http://technet.microsoft.com/en-us/sysinternals/bb896655.aspx)。一旦出现异常，请使用该应用程序进行检查。

如果其他答案建议的延迟足以复制文件，则可能是您无法真正使用该工具进行检查。在这种情况下，您需要一个自动化的解决方案来确定谁在锁定文件。您可以使用 WMI 来做到这一点。

现在，我的猜测是*您的进程*正在锁定文件，~~这意味着来自`File.Copy`~~.

编辑：好的，现在我们知道您是打开文件的人...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T14:09:31.580

您可以将文件加载到内存中，然后可以从内存数据中创建 BitmapImage。

```
 BitmapImage GetImage( String filepath)
    {
        byte[] rawImageBytes = File.ReadAllBytes(filepath);
        BitmapImage imageSource = null;

        try
        {
            using ( MemoryStream stream = new MemoryStream( rawImageBytes  ) )
            {
                stream.Seek( 0, SeekOrigin.Begin );
                BitmapImage b = new BitmapImage();
                b.SetSource( stream );
                imageSource = b;
            }
        }
        catch ( System.Exception ex )
        {
        }

        return imageSource;
    } 
```

字节数组到 BitmapImage 代码取自[这个 SO question](https://stackoverflow.com/questions/3335819/byte-to-bitmapimage-in-silverlight)

# c++ - 数组遍历与指针，缓存效率方面

> ID：11227669
> 
> 赞同：2
> 
> 时间：2012-06-27T13:44:16.907
> 
> 标签：c++, arrays, caching, pointers

```
void foo(Node* p[], int size){

    _uint64 arr_of_values[_MAX_THREADS];

    for (int i=0 ; i < size ; i++ ){
         arr_of_values[i] = p[i]->....;

         // much code here 
         // 
      }
 } 
```

对比

```
void foo(Node* p[], int size){

    _uint64 arr_of_values[_MAX_THREADS];

    Node* p_end = p[size];
    for ( ; p != p_end ; ){            
         arr_of_values[i] = (*p)->.....;
         p++;

         // much code here 
         // 
     }

} 
```

我创建了这个函数来演示我在问什么：

从缓存效率方面来看，什么更有效：采用 p[i] 还是使用 *p++？

（我永远不会在其余代码中使用 p[ix]，但我可以在以下计算中使用 p[i] 或 *p）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:50:50.067

最重要的是避免[虚假分享](http://herbsutter.com/2009/05/15/effective-concurrency-eliminate-false-sharing/)。`arr_of_values`每个线程写入自己的插槽，但 8 或 16 个插槽共享一个缓存线（取决于 CPU），从而导致大量错误共享问题。在插槽之间添加填充以缓存对齐每个线程的插槽，或者在堆栈上累积并在最后只写入一次：

```
void foo(Node* p[], int size){

    _uint64 arr_of_values[_MAX_THREADS];

    Node* p_end = p[size];
    for ( ; p != p_end ; ){            
         temp = .....;
         p++;
         // much code here 
         // 
     }  
     arr_of_values[i] = temp;
} 
```

通过指针访问或通过索引访问的问题与今天的编译器无关。

您的下一步行动应该是：获取[软件优化手册](http://www.intel.com/intelpress/sum_swcb2.htm)的副本。阅读。措施。修复测量的热点，而不是猜测。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T13:59:52.497

从缓存的角度来看，问题不在于您访问元素的方式。在这种情况下使用指针或数组索引是等效的。

BTW Node* p[] 是一个指针数组。因此，您可能已将 Node 对象分配到遥远的内存区域。（例如使用几个 ptr = new Node()）。在以下情况下可获得最佳缓存性能：

1.  您的节点连续存储到内存中
2.  节点大小不超过缓存大小。

# java - 如何创建格式化文本以在 Java Swing 组件中显示（JTextPane、JEditorPane...）

> ID：11227671
> 
> 赞同：1
> 
> 时间：2012-06-27T13:44:26.323
> 
> 标签：java, swing, text, jtextpane, jeditorpane

我已经搜索和研究了所有我能找到的答案，但没有结果。所以我再次寻求帮助。

我想在桌面 java swing 应用程序中显示格式化文本。该文本将在某些变量对象的基础上以编程方式生成，并且不可编辑。

我不知道是否最好使用 JTextPane 或 JEditorPane 或什么。问题是我在任何地方都找不到解释如何使用它们的手册或教程。我必须创建一个 HTMLDocument 来插入文本吗？如何创建它？...

在这种情况下显示文本是正确的方法吗？或者我可以使用表格或标签或类似的东西。

我需要你的一些建议，如果有一些我可以学习如何做的地方，请告诉我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T15:06:58.583

这里看看这个代码示例，如果你想再修改一下，也可以添加 Font 作为参数并在指定位置使用适当的参数。写一些东西`JTextField`然后按`ENTER`几次。

```
import java.awt.*;    
import java.awt.event.*;    
import javax.swing.*;    
import javax.swing.border.*;    
import javax.swing.text.AttributeSet;
import javax.swing.text.SimpleAttributeSet;
import javax.swing.text.StyleConstants;
import javax.swing.text.StyleContext;

public class TextPaneTest extends JFrame {

    private JPanel topPanel;
    private JTextPane tPane;
    private JTextField tfield;
    private int counter;
    private Color[] colours = {
                                Color.RED,
                                Color.BLUE,
                                Color.DARK_GRAY,
                                Color.PINK,
                                Color.BLACK,
                                Color.MAGENTA,
                                Color.YELLOW,
                                Color.ORANGE
                              };

    public TextPaneTest() {
        counter = 0;   
    }

    private void createAndDisplayGUI() {    
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);         

        EmptyBorder eb = new EmptyBorder(new Insets(10, 10, 10, 10));

        tPane = new JTextPane();                
        tPane.setBorder(eb);
        tPane.setMargin(new Insets(5, 5, 5, 5));
        JScrollPane scroller = new JScrollPane();
        scroller.setViewportView(tPane);

        tfield = new JTextField();
        tfield.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent ae) {
                counter++;
                if (counter == 8)
                    counter = 0;
                String text = tfield.getText() + "\n";
                appendToPane(tPane, text, colours[counter]);    
                tfield.selectAll();
            }
        });     

        getContentPane().add(scroller, BorderLayout.CENTER);
        getContentPane().add(tfield, BorderLayout.PAGE_END);

        setSize(200, 100);
        setVisible(true);
        tfield.requestFocusInWindow();
    }

    private void appendToPane(JTextPane tp, String msg, Color c) {
        StyleContext sc = StyleContext.getDefaultStyleContext();
        AttributeSet aset = sc.addAttribute(SimpleAttributeSet.EMPTY, StyleConstants.Foreground, c);

        aset = sc.addAttribute(aset, StyleConstants.FontFamily, "Lucida Console");
        aset = sc.addAttribute(aset, StyleConstants.Alignment, StyleConstants.ALIGN_JUSTIFIED);

        int len = tp.getDocument().getLength();
        tp.setCaretPosition(len);
        tp.setCharacterAttributes(aset, false);
        tp.replaceSelection(msg);
    }

    public static void main(String... args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new TextPaneTest().createAndDisplayGUI();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T13:49:42.240

> 我已经搜索和研究了所有我能找到的答案，但没有结果。所以我再次寻求帮助。

*   在 Oracle [How to Use Editor Panes and Text Panes](http://docs.oracle.com/javase/tutorial/uiswing/components/editorpane.html)中对所有内容进行了详细描述，包括对样式文本的支持

> 我必须创建一个 HTMLDocument 来插入文本吗？如何创建它？...

*   不是你不需要创建 HTML 内容，关于 HTML 是 Oracle 教程[How to Use HTML in Swing Components](http://docs.oracle.com/javase/tutorial/uiswing/components/html.html)

> 在这种情况下显示文本是正确的方法吗？或者我可以使用表格或标签或类似的东西。

*   对于样式文本是`JEditorPane`/`JTextPane`最好的选择

*   教程或[此处的示例](http://www.java2s.com/Tutorial/Java/0240__Swing/Catalog0240__Swing.htm)

# google-app-engine - Google App Engine 频道 API 消息队列

> ID：11227675
> 
> 赞同：0
> 
> 时间：2012-06-27T13:44:36.843
> 
> 标签：google-app-engine, channel-api

如果客户端已连接然后断开连接 - 假设他的连接丢失 5 分钟；服务器是否将无法传递的消息排队？

在本地开发服务器上似乎是这种情况？

如果在生产中是这种情况 - 消息排队等待多长时间？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T14:06:56.273

在生产中，如果您的服务器收到 /_ah/channel/disconnected/ POST，则消息将被丢弃。

在实践中，有一点点缓存。如果你例如。由于您的 wifi 连接断开，您的连接非常短暂地丢失，在此期间发送的消息可能会排队并传递。但在这种情况下，您不应该收到断开连接的 POST。

# asp.net-mvc - 添加视图对话框 MVC3

> ID：11227676
> 
> 赞同：3
> 
> 时间：2012-06-27T13:44:40.890
> 
> 标签：asp.net-mvc, asp.net-mvc-3, t4

我正忙于更改在我的控制器中单击“添加视图”对话框时生成的默认 T4 模板。我知道如何更改模板。但是以下我无法理解。

当用户单击添加视图时，我希望能够生成以下内容。

1.  一个局部视图，只包含默认生成的视图的 Form 部分
2.  调用上面生成的局部视图的视图。

是否可以使用 T4 模板生成 2 个这样的文件？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T16:09:01.487

为什么？你会经常一遍又一遍地做同样的事情吗？如果是这样，那么 T4 模板可能有意义。如果您要执行一次或两次，则只需手动修改文件。

# facebook - 分享facebook后重定向用户

> ID：11227677
> 
> 赞同：0
> 
> 时间：2012-06-27T13:44:41.833
> 
> 标签：facebook, redirect, share

我想在用户在 facebook 上分享后将他们重定向到特定页面，我在这里找到了一个很好的答案：

[facebook分享和发布后重定向用户](https://stackoverflow.com/questions/9368337/redirect-user-after-facebook-share-and-publish)

这是脚本

```
<script type="text/javascript">
FB.init({appId: "YOUR_APP_ID", status: true, cookie: true});
  function share_me() {
    FB.ui({
      method: 'feed',
      app_id: 'YOUR_APP_ID',
      link: 'SHARE_URL',
      picture: 'PIC_URL',
      name: 'SHARE_NAME',
      caption: 'SHARE_CAPTION',
      description: 'SHARE_DESCRIPTION'
    },
    function(response){
      if(response && response.post_id) {
        self.location.href = 'SUCCESS_URL'
      }
      else {
        self.location.href = 'CANCEL_URL'
      }
    });
  }
</script>";
  <div onclick="share_me()">Share</div> 
```

但是当我使用脚本时，根本没有重定向，即使用户点击“取消”，请帮我解决这个问题，因为我从 1 周开始就在寻找这样的方法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T15:23:31.107

尝试使用另一个 javascript 函数进行重定向，例如 window.location = "YOUR_PAGE"

# vb.net - 在 Visual Basic 中创建垄断和 Ludo

> ID：11227683
> 
> 赞同：0
> 
> 时间：2012-06-27T13:44:55.153
> 
> 标签：vb.net

我想在 Visual Basic.NET 2010 中创建一个垄断棋盘和卢多游戏。
我应该如何表示棋盘？我在考虑图片框，但后来它们变得太笨拙而无法单独处理。你能创建图片框数组吗？

另外，由于我只是一个新手程序员，你能告诉我Visual Basic的哪些功能对这个游戏有用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T13:52:30.070

无需在窗体设计器中添加控件，您始终可以在 VB（和 C#）中以编程方式添加它们。这使您可以自由地将它们存储在您想要的任何位置，就像在二维数组中一样。请务必将它们也添加到`Form.Controls`属性中。

```
Dim board as New PictureBox(M-1, N-1) {}

myform.SuspendLayout() ' Diminishes flicker.
For i As Integer = 0 To M - 1
    For k As Integer = 0 To N - 1
        Dim pic = New PictureBox()
        'TODO: set the properties of the PictureBox here
        board(i, k) = pic
        myForm.Controls.Add(pic)
    Next k
Next i
myForm.ResumeLayout() 
```

还可以考虑将其添加`PictureBoxes`到 a`TableLayoutPanel`而不是直接将它们添加到表单中。

`Board`而且，当然，创建一个类并处理该类中的所有板逻辑而不是在表单事件处理程序中执行逻辑是一个好主意。其他类如`Player`or`Game`或`Score`也可以提供帮助。

最好不要创建 PictureBox 的二维数组，而是创建某个类的数组，这些`Square`类可以存储其他信息，例如正方形的状态或留在正方形上的图形列表或对特殊的引用适用于正方形的规则等等。你在游戏的设计上有很大的自由度。将游戏逻辑与 UI 细节分开的智能设计更易于处理，并且可以更轻松地发展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T14:11:35.093

我会考虑创建一个 UserControl，而不是使用 PictureBox，它封装了与板上的正方形相关的所有 UI 相关逻辑。例如，您可能希望棋盘上的所有方块都有一个特定的右键单击上下文菜单，或者在双击时做一些特别的事情。在 Monopoly 中，您可能希望每个方块都有一个属性名称、价格、颜色等。

# asp.net - 在 Internet 重新连接期间丢失会话变量

> ID：11227684
> 
> 赞同：1
> 
> 时间：2012-06-27T13:44:55.797
> 
> 标签：asp.net

我已经在这个问题上寻求帮助，但没有找到任何类似的东西。

我有一个 asp.net 网站，其中 1 个用户（我知道）在注销（表单身份验证）和丢失会话变量时遇到问题。

我认为基本上正在发生的事情是用户正在使用移动互联网连接，有时会不稳定并断开连接并重新连接，有时但并不总是使用新的 IP 地址。我认为这正在破坏存储在会话状态中的值。

这是任何人都遇到过的问题吗？如果是这样，你如何解决它？我想如果更多的人以这种方式连接到互联网，情况可能会变得更糟。

通常错误是 View state mac 错误，但并非总是如此。

当然，它可能与互联网连接问题无关。

非常感谢

# javascript - 通过 CSS 获取 css 值并在 Selenium 中使用

> ID：11227685
> 
> 赞同：1
> 
> 时间：2012-06-27T13:44:58.163
> 
> 标签：javascript, css, testing, selenium, selenium-ide

我尝试获取一些网站属性（单元格的颜色）并在 Selenium 中进行比较。

当我把这个：

```
javascript:window.getComputedStyle(document.getElementById("simple_cname"),null).getPropertyValue("background-color"); 
```

在 Chrome Omnibox 中，我收到了正确的答案，但是当我使用 storeEval 或 assertEval 尝试获取此值时，它无法正常工作。
编辑：我把这样的硒命令。我使用 storeEval ，当我回显该值时，它会返回此命令。我使用火狐。我使用 Chrome 只是为了检查命令是否正确。（应该是 "rgb(220, 22, 92)" ） edit2: 是的，命令没问题，但是我在 Selenium-IDE 工具中使用它时遇到了问题。当我将它与 storeEval 命令一起使用时，它不会返回该值。日志：[info] 脚本为：var test javascript:window.getComputedStyle(document.getElementById("simple_cname"),null).getPropertyValue("background-color"); 回声测试；[信息] 执行：|echo | ${测试} | | [信息] echo: var test javascript:window.getComputedStyle(document.getElementById("simple_cname"),null).getPropertyValue("background-color"); 回声测试；

* * *

我把这样的硒命令。我使用 storeEval ，当我回显该值时，它会返回此命令。我使用火狐。我使用 Chrome 只是为了检查命令是否正确。（应该是 "rgb(220, 22, 92)" ）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T08:34:11.173

您需要删除该`javascript:`部分并引用`document`为`window.document`。该命令将如下所示：

```
window.getComputedStyle(window.document.getElementById('simple_cname'),null).getPropertyValue('background-color'); 
```

该`javascript:`部分仅在从 URL 栏中运行代码时才需要，在其他*任何*地方都是多余的。使用[`Console`](https://developers.google.com/chrome-developer-tools/docs/console)代替您的多功能框在 Chrome 中运行 JS 命令。

该部分下[的文档](http://release.seleniumhq.org/selenium-core/1.0.1/reference.html)`document`中提到了->`window.document`事物。`storeEval`

另外，请注意，您的脚本只能在现代浏览器中运行，它会在 IE < 9 中失败。如果您对此感到满意，那很好。如果没有，[谷歌有解决方案](https://www.google.com/search?q=js%20get%20style)。

# iphone - 无法捕获 AVCaptureVideoPreviewLayer

> ID：11227691
> 
> 赞同：1
> 
> 时间：2012-06-27T13:45:18.633
> 
> 标签：iphone, ios, avcapture

在我的应用程序中，我正在使用以下代码打开一个视频预览层：

```
 AVCaptureDeviceInput *captureInput = [AVCaptureDeviceInput 
                                      deviceInputWithDevice:[AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo] 
                                      error:nil];
/*We setupt the output*/
AVCaptureVideoDataOutput *captureOutput = [[AVCaptureVideoDataOutput alloc] init];

captureOutput.alwaysDiscardsLateVideoFrames = YES; 

dispatch_queue_t queue;
queue = dispatch_queue_create("cameraQueue", NULL);
[captureOutput setSampleBufferDelegate:self queue:queue];
dispatch_release(queue);
NSString* key = (NSString*)kCVPixelBufferPixelFormatTypeKey; 
NSNumber* value = [NSNumber numberWithUnsignedInt:kCVPixelFormatType_32BGRA]; 
NSDictionary* videoSettings = [NSDictionary dictionaryWithObject:value forKey:key]; 
[captureOutput setVideoSettings:videoSettings]; 

self.captureSession = [[AVCaptureSession alloc] init];
[self.captureSession addInput:captureInput];
[self.captureSession addOutput:captureOutput];
/*We use medium quality, ont the iPhone 4 this demo would be laging too much, the conversion in UIImage and CGImage demands too much ressources for a 720p resolution.*/
[self.captureSession setSessionPreset:AVCaptureSessionPresetMedium];

CGRect Vframe;
Vframe = CGRectMake(self.viewNo2.frame.origin.x, self.viewNo2.frame.origin.y, self.viewNo2.frame.size.width, self.viewNo2.frame.size.height);   

/*We add the Custom Layer (We need to change the orientation of the layer so that the video is displayed correctly)*/
self.customLayer = [CALayer layer];
self.customLayer.frame = Vframe;
self.customLayer.contentsGravity = kCAGravityResizeAspect;
[self.view.layer addSublayer:self.customLayer];

CGRect VFrame1;
VFrame1 = CGRectMake(self.viewNo3.frame.origin.x, self.viewNo3.frame.origin.y, self.viewNo3.frame.size.width, self.viewNo3.frame.size.height);   

/*We add the Custom Layer (We need to change the orientation of the layer so that the video is displayed correctly)*/
self.customLayer1 = [CALayer layer];
self.customLayer1.frame = VFrame1;
self.customLayer1.contentsGravity = kCAGravityResizeAspect;
[self.view.layer addSublayer:self.customLayer1]; 

///*We add the imageView*/
//self.imageView = [[UIImageView alloc] init];
//self.imageView.frame = CGRectMake(9, 9, 137, 441);
//[self.view addSubview:self.imageView];
/*We add the preview layer*/

CGRect VFrame2;
VFrame2 = CGRectMake(self.viewNo1.frame.origin.x, self.viewNo1.frame.origin.y, self.viewNo1.frame.size.width, self.viewNo1.frame.size.height);   

self.prevLayer = [AVCaptureVideoPreviewLayer layerWithSession: self.captureSession];
self.prevLayer.frame = VFrame2;

self.prevLayer.videoGravity = AVLayerVideoGravityResizeAspectFill;
[self.view.layer addSublayer: self.prevLayer];
/*We start the capture*/
[self.captureSession startRunning]; 
```

当我尝试使用此方法捕获屏幕时：

```
-(IBAction)Photo{

CGRect rect = [self.view bounds];
UIGraphicsBeginImageContextWithOptions(rect.size,YES,0.0f);
CGContextRef context = UIGraphicsGetCurrentContext();
[self.view.layer renderInContext:context];   
UIImage *viewImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();
UIImageWriteToSavedPhotosAlbum(viewImage, nil, nil, nil);} 
```

prevLayer 没有被捕获，我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T04:12:02.443

`AVCaptureVideoPreviewLayer`不响应捕获屏幕`UIGraphicsGetImageFromCurrentImageContext()`。这只是苹果所做的一个奇怪的规则。获取当前屏幕图像的唯一方法是从`AVCaptureInput`. 然后可以手动将其添加到您的屏幕截图中。

# php - mod_rewrite 在访问没有 www 的站点时添加 .php 扩展名。字首

> ID：11227695
> 
> 赞同：1
> 
> 时间：2012-06-27T13:45:24.640
> 
> 标签：php, apache, .htaccess

我的 .htaccess 文件如下：

```
Options -Multiviews
RewriteEngine On
RewriteCond %{HTTP_HOST} ^example.com
RewriteRule ^(.*)$ http://www.example.com/$1 [R=301]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ $1.php 
```

我遇到的问题是，当我尝试在没有 www 的情况下访问我的网站时。前缀，.php 扩展名被添加到地址，这通常会导致问题。例如，如果我尝试使用地址 example.com 访问我的主页，该地址将转换为 www.example.com/.php。我要万维网。要添加，但最后添加的 .php 扩展名只会导致错误。我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:50:12.457

我相信问题出在你的最后一行。执行第一条规则后，Mod Rewrite 不会停止。尝试将最后一个规则修饰符添加到重定向规则：

```
RewriteRule ^(.*)$ http://www.example.com/$1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:48:09.510

您需要告诉 apache 在 301 重定向后停止处理规则，通过添加 L 来执行此操作 - 例如：

```
RewriteRule ^(.*)$ http://www.example.com/$1 [R=301,L] 
```

另外：如果您在第一行启用多视图并删除最后 3 行，您会做得更好；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T13:54:00.347

从 .htaccess 中删除以下行并尝试..

```
RewriteRule ^(.*)$ $1.php 
```

# objective-c - 方法返回 0

> ID：11227699
> 
> 赞同：1
> 
> 时间：2012-06-27T13:45:35.813
> 
> 标签：objective-c, calculator

我正在做cs193p课程的基础计算器作业，但我的
`+evaluateExpression:usingVariables:`方法不起作用。它总是返回 0。

这是我的方法：

```
+ (double)evaluateExpression: (id)anExpression usingVariablevalues: (NSDictionary *)variables {
CalculatorBrain *worker = [[[CalculatorBrain alloc] init] autorelease];
double returnValue = 10.0;
if ([anExpression isKindOfClass:[NSMutableArray class]]) {
    for (id term in anExpression) {
        NSLog(@"%f", returnValue);         // breakpoint
        if ([term isKindOfClass:[NSString class]]) {                                    // string
            if ([term hasPrefix:@"%"] && [term length] == 2) {                          // variable
                double value = [(NSNumber *)[variables objectForKey:[term substringFromIndex:1]] doubleValue];
                NSLog(@"Variable: %@, value: %d", [term substringFromIndex:1], value);
                [worker setOperand:value];
            }
            else if ([term length] == 1) {                                              // operation
                returnValue = [worker performOperation:term];
            }
            else {
                NSLog(@"Invalid expression.\n\tMultiple character operation found: %@", term);
            }
        }
        else if ([term isKindOfClass:[NSNumber class]]) {                                   // operand
            double value = [term doubleValue];
            [worker setOperand:value];
        }
        else {
            NSLog(@"Invalid expression.\n\tWrong type in expression: %@, The value is: %@.",[term class], term);    // Wrong type in expression
        }

    }
}
else {
    NSLog(@"Invalid expression.\n\tThe expression is of the wrong type: %@.", [anExpression class]);    // expression is of wrong type
}
//returnValue = worker.operand;
return returnValue;
} 
```

有什么提示吗？它总是返回 0。

```
/* Ouput from Console */
2012-06-27 20:01:05.487 Calculator[2823:207] 0
2012-06-27 20:01:05.488 Calculator[2823:207] 0
2012-06-27 20:01:05.489 Calculator[2823:207] 0
2012-06-27 20:01:05.490 Calculator[2823:207] Variable: x, value: 0
2012-06-27 20:01:05.490 Calculator[2823:207] 0
2012-06-27 20:01:05.491 Calculator[2823:207] 0
2012-06-27 20:01:05.491 Calculator[2823:207] 0 
```

注意：我在开始时将 returnValue 设置为 10.0 以检查它是否完全改变了。

**更新：**

我发现它从字典中得到 0。我认为调用代码是原因：

```
- (IBAction) performSampleExpression {
    NSMutableArray *expr = [[NSMutableArray alloc] init]; 
    [expr addObject:[NSNumber numberWithDouble:3.0]];
    [expr addObject:@"+"];
    [expr addObject:@"%x"];
    [expr addObject:@"*"];
    [expr addObject:[NSNumber numberWithDouble:4.0]];

    NSDictionary *varsdict = [NSDictionary dictionaryWithObjectsAndKeys:[NSNumber numberWithDouble:10.0], @"x", nil];

    double result = [CalculatorBrain evaluateExpression:expr usingVariablevalues:varsdict];
    if (!result) NSLog(@"result = nil");
    NSLog(@"%f", result);

    display.text = [NSString stringWithFormat:@"%f", result];
    [expr release];
} 
```

结果不是零。

**更新 2：**

使用调试器（很好的提示。这可能会解决它。）我发现了一些奇怪的东西：

在这条线上：（第一次）

```
returnValue = worker.operand; 
```

它说 returnValue 仍然是 10，而不是 3（worker.operand IS）。
作业失败了，还是应该这样？（就是想）。

**更新 3：**

好的，这里发生了一些非常奇怪的事情：我在 return 语句的最后一行设置了一个断点`+evaluateExpression:usingVariables:`，它说
`returnValue = 4`。
这意味着，实际问题出在`-performSampleExpression`. 我究竟做错了什么？

**更新 4：**

变身帮`@"%d", double`了`@"%f", double`大忙。这就解释了奇怪的控制台输出。但是，它解决了它，因为我更新了显示，如显示`[setText:@"%d", result];`导致我的双精度显示为 0 由于错误的演员阵容。
我通过使用调试器发现了这一点，因此建议的人实际上解决了它。（我要求的是`hints`，而不是解决方案。毕竟，功课是要学习的）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:08:44.390

您是否尝试过一次单步执行代码并检查变量值？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T14:15:23.870

可能的问题可以显示在：

```
 returnValue = [worker performOperation:term]; 
```

和

```
returnValue = worker.operand; 
```

您应该在此行（或下面的行）中停止调试器，并注意如何更改您的值`returnValue`。

![屏幕](../Images/c51e83a7bce9310265f15879ae07ca9c.png)

您停止应用点击屏幕上的位置，应用停止，然后使用 F6（或 Fn+F6）跳转到下一行。在下方（在控制台中），您可以看到该值。

**编辑**

您可以尝试此解决方案 - 将分配更改为：

```
CalculatorBrain *worker = [[[CalculatorBrain alloc] init] autorelease]; 
```

并删除行：

```
 [worker release]; 
```

此版本在返回之前可能会在没有 NSCopying @protocol 的情况下引起问题。

**自动释放和 NSCopying**

为了更好地理解编译此代码：

```
NSMutableArray *arrOne = [[NSMutableArray alloc] initWithObjects:@"1",@"2", nil];
NSMutableArray *arrTwo = [[NSMutableArray alloc] init];

arrTwo = arrOne;
[arrOne addObject:@"3"]; //After that arrTwo "shold" be 1,2 and arrOne 1,2,3\. No! There both 1,2,3!

for(int i=0;i<[arrTwo count];i++)
    NSLog(@"%@",[arrTwo objectAtIndex:i]); 
```

因此，您可以考虑如何分配变量。在上面的示例中，释放内存不应该影响返回值，但是通过使用带有返回对象的自动释放，您不必分配任何东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T15:29:07.520

我在您的代码中看到了一点内存泄漏：

所以，而不是这个： `[worker release];`

试试这一行：`[worker autorelease];`

我不确定它是否导致了问题，但您的版本肯定看起来不太好。

# android - 如何根据用户方向显示谷歌地图

> ID：11227703
> 
> 赞同：1
> 
> 时间：2012-06-27T13:45:47.763
> 
> 标签：android, google-maps

我正在使用`Google Maps`以显示当前用户位置。虽然使用北部总是在顶部，但我的问题是：可以根据用户方向改变它吗？例如，如果用户转向南方，那么南方应该在顶部。
我怎样才能做到这一点？

我的应用程序 minimun sdk 版本是 2.2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T14:05:53.183

您可以处理传感器事件（这可以为您提供用户的方位），然后您必须使用动画旋转 MapView。

您可以使用 location.getBearing(); 以得到用户的承担。然后，您可以旋转视图

```
// Create an animation instance 
Animation an = new RotateAnimation(from, to, pivotX, pivotY); 
// Set the animation's parameters 
an.setDuration(duration); 
an.setFillAfter(true); 
// Aply animation to view 
mapView.setAnimation(an); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T19:37:31.400

我建议使用`mapView.setRotation(bearing)`. 这就是我使用的（我有一个类似于你的应用程序）。我不确定引入了什么 API 级别，但它适用于我（2.3.4）。确保您`mapView.invalidate()`在旋转地图后致电。

# javascript - 将 JQuery 点击事件附加到锚点 ID

> ID：11227707
> 
> 赞同：4
> 
> 时间：2012-06-27T13:45:59.270
> 
> 标签：javascript, jquery, jquery-mobile, jquery-click-event

我有一个简单的SO。为什么我不能将点击事件直接附加到锚点 ID？我应该指出我也在使用 JQuery Mobile。

```
 <div id="foobarNavbar" data-role="navbar" style="display:none;">
                <ul>
                    <li><a id="foo" href="#foo" data-icon="plus">New Event</a></li>
                    <li><a id="bar" href="#bar" data-icon="grid">Events</a></li>
                </ul>
            </div><!-- /foobarNavbar--> 
```

我正在尝试将点击事件附加到 foo。这不起作用：

```
 $('#foo').bind('click', function(e) 
        {   
            e.preventDefault();
            console.log("You clicked foo! good work");
        }); 
```

这确实有效，但给了我 foo 和 bar 的点击事件。是否无法绑定到锚 ID 还是我犯了菜鸟错误？

```
 $('#foobarNavbar ul li a').bind('click', function(e) 
        {   
            e.preventDefault();
            console.log("You clicked foo! good work");
            console.log(e);
        }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:49:24.030

将该代码包装在文档中`ready`，如果您没有任何其他脚本错误并且加载了 jQuery，它应该可以工作。

```
$(function(){
   $('#foo').click(function(e) 
   {   
      e.preventDefault();
      console.log("You clicked foo! good work");
   });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T14:01:01.080

> 重要提示：使用 $(document).bind('pageinit')，而不是 $(document).ready()
> 
> 在 jQuery 中学习的第一件事是调用 $(document).ready() 函数中的代码，以便在加载 DOM 后立即执行所有内容。但是，在 jQuery Mobile 中，Ajax 用于在您导航时将每个页面的内容加载到 DOM 中，并且 DOM 就绪处理程序仅针对第一页执行。要在加载和创建新页面时执行代码，您可以绑定到 pageinit 事件。此事件在本页底部有详细说明。

我试图使用准备好的文档而不是 pageinit 进行绑定。第一个功能

```
$('#foo').bind('click', function(e) 
        {   
            e.preventDefault();
            console.log("You clicked foo! good work");
        }); 
```

移动到“pageinit”事件时工作正常。但是，我仍然不确定为什么第二个代码示例有效但第一个无效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T13:54:04.263

就像那样，我猜它会起作用......

```
$('#foobarNavbar').on('click','#foo', function(e) {   
   e.preventDefault();
   e.stopPropagation();
   console.log("You clicked foo! good work");
   console.log(e);
}); 
```

# html - rails 示例应用程序：如何在列出的每个用户的右侧呈现一个文本表单（每行一个）

> ID：11227708
> 
> 赞同：0
> 
> 时间：2012-06-27T13:46:01.537
> 
> 标签：html, ruby-on-rails, ruby

Ruby on Rails：

我想要

*   <%= 渲染 'shared/intro_form' %>

为显示的每个用户行呈现一个表单

*   <%= 渲染@users %>

我知道我需要以某种方式将前一行嵌入到后者中，也许使用“each...do”语句，但我无法找出正确的语法。谢谢！

```
<% provide(:title, 'All users') %>
<h1>All users</h1>

<%= will_paginate %>

<ul class="users">
    <li><%= render @users %></li>
    <li><%= render 'shared/intro_form' %></li>
</ul>

<%= will_paginate %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:48:44.553

[http://guides.rubyonrails.org/layouts_and_rendering.html](http://guides.rubyonrails.org/layouts_and_rendering.html)

3.4.5 渲染集合

```
<%= render :partial => "shared/intro_form", :collection => @users %> 
```

# jquery - 遵循教程后，Jquery DataTables 不显示

> ID：11227716
> 
> 赞同：2
> 
> 时间：2012-06-27T13:46:15.900
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, datatables

问题现在已解决。

我通过删除与页面滚动的粘性标题的 javascript 部分来修复它。当代码在 application.html.erb 中时，我真的不知道为什么我的 javascript 很糟糕

* * *

当我的 application.html.erb 如下所示时，我的数据表将起作用：

```
<!DOCTYPE html>
<html>

    <head>
        <title>Dummyapp1</title>
          <%= stylesheet_link_tag "application" %>
          <%= javascript_include_tag "application", "contractens" %>
          <%= csrf_meta_tags %>

    <div>

    </head>

<body>
==rest of script== 
```

当我的 application.html.erb 看起来像这样时它不起作用：

```
<!DOCTYPE html>
<html>

    <head>
        <title>Dummyapp1</title>
          <%= stylesheet_link_tag "application" %>
          <%= javascript_include_tag "application", "contractens" %>
          <%= csrf_meta_tags %>

    <div>

</div>

    <!-- If you have jQuery directly, then skip next line -->
    <script src="http://www.google.com/jsapi"></script>

    <script type="text/javascript">
    // If you have jQuery directly, then skip next line
    google.load("jquery", "1");

    function sticky_relocate() {
      var window_top = $(window).scrollTop();
      var div_top = $('#sticky-anchor').offset().top;
      if (window_top > div_top)
        $('#sticky').addClass('stick')
      else
        $('#sticky').removeClass('stick');
      }
    // If you have jQuery directly, use the following line, instead
    // $(function() {
    // If you have jQuery via Google AJAX Libraries
    google.setOnLoadCallback(function() {
      $(window).scroll(sticky_relocate);
      sticky_relocate();
      });
    </script>

    </head>

<body> 
```

我按照这个[Railscasts](http://railscasts.com/episodes/340-datatables?view=asciicast)教程来获取 rails 中的数据表。我在我的另一个应用程序中有这个。在那里它工作正常。我做了与其他应用程序相同的事情，但它显示的是文本而不是实际的表格。

这是我对表格的看法：

```
 <h1>Listing contracten</h1>

    <table id="contractens" class="display">
      <thead>
          <tr>
            <th>Naam</th>
            <th>Omschrijving</th>
            <th>Datumingang</th>
            <th>Contractduur</th>
            <th>Opzegtermijn</th>
            <th>Betalingstermijn</th>
          </tr>
      </thead>
    <tbody>
      <%= @contractens.each do |contracten| %>
      <tr>
        <td><%= contracten.naam %></td>
        <td><%= contracten.omschrijving %></td>
        <td><%= contracten.datumingang %></td>
        <td><%= contracten.contractduur %></td>
        <td><%= contracten.opzegtermijn %></td>
        <td><%= contracten.betalingstermijn %></td>
      </tr>
    <% end %>
    </tbody>
    </table>

<%= link_to "Nieuw", new_contracten_path %> 
```

我的javascript文件填写正确。

这是问题的屏幕截图：

![问题](../Images/520131d5181e00b806dcdcc2e09e07fb.png)

希望你能帮我 ：）

编辑：它应该看起来像这样，没有 css：

![在此处输入图像描述](../Images/3ed69711f6bbc3bf416e76cf2d9bbad5.png)

使用 css 应该是这样的：

![在此处输入图像描述](../Images/4629502c5cfc4fd869ed56f685a709c1.png)

这是我的 contractens.js.coffee ：

```
jQuery ->
        $('#contractens').dataTable
          sPaginationType: "full_numbers"
          bJQueryUI: true 
```

这是我的 application.js：

```
//= require jquery
//= require jquery_ujs
//= require dataTables/jquery.dataTables
//= require_tree . 
```

这是我的application.css：

```
/*
*= require_self
*= require dataTables/jquery.dataTables
*= require_tree .
*/ 
```

编辑2：

当我有一个javascript函数可以在单击复选框时隐藏一个div。当我有

```
jQuery ->
        $('#contractens').dataTable 
```

在我的contractens.js.coffee 中它确实有效，但是当我有：

```
jQuery ->
        $('#contractens').dataTable
        sPaginationType: "full_numbers"
        bJQueryUI: true 
```

它也不起作用。所以我猜有些东西阻止了jquery。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T14:13:38.253

改变

```
<%= @contractens.each do |contracten| %> 
```

为了

```
<% @contractens.each do |contracten| %> 
```

`<%= %>`需要输出时使用标记集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-02T07:05:01.950

我也有同样的问题，我改变了这个问题：在我的 application.js 中：

```
//= require jquery
//= require jquery_ujs
//= require dataTables/jquery.dataTables
//= require_tree . 
```

到

```
//= require jquery
//= require_tree .
//= require jquery_ujs
//= require dataTables/jquery.dataTables 
```

它现在有效。

# javascript - 无法使用 Jquery 从选择中选择第一个元素

> ID：11227719
> 
> 赞同：0
> 
> 时间：2012-06-27T13:46:21.663
> 
> 标签：javascript, jquery, jquery-ui

我正在根据第一个下拉列表中选择的值填充下拉列表。从服务器发送回的数据采用 JSON 格式，并使用 JQuery 解析和填充第二个选择标记

```
<select name="abc" id="jobName">
  <option value="-1">Please select a  Job</option>
 </select> 
```

这是我的 Jquery 代码

```
var selectedGroup = document.getElementById(groupDropDownId);
var groupdata = selectedGroup.options[selectedGroup.selectedIndex].value;
var formInput='group='+groupdata;

$.getJSON('search/getSchedulerJobListForGroup',formInput,function(data) {

    $('.result').html('' + data.jobList + '');
    $.each(data.jobList,function(index, value){
    var jobId = document.getElementById(resetDropDownId);
    var option=new Option(value,value);
    try{
         jobId.add(option);
       }
        catch(e){
          jobId.appendChild(option);
         }
       });
      });

    $("#jobName")[0].selectedIndex = 1;
    // $("#jobName").val($("#triggerjobName option:first").val()); 
```

在上面的代码`groupDropDownId`中是下拉列表的 ID，根据其值，第二个下拉列表将被填充。`resetDropDownId`是我试图从从服务器获取的 JSON 数据中填充的第二个下拉列表的 ID。

填写下拉菜单后，它还会创建一个空选项标签，默认情况下它会被选中。我不确定是否可以为该空选项添加一些默认值，以便我可以选择该默认选项值，例如“请选择 bla bla”。

我也尝试从下拉列表中选择第一个元素，但似乎没有什么对我有用。我想知道我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:10:03.610

根据您的问题，您似乎想知道如何在动态填充的选择列表中更改元素的值和文本。

目前，您有此`$("#jobName")[0].selectedIndex = 1;`声明`outside of your getJSON request`。如果将它移到 getJSON 函数内部，它将按预期工作。

如果要设置该对象的值和文本，则需要使用 ->

```
$('#jobId option:first').val("Some Value").text("other stuff"); 
```

您可以使用来自 JSON 对象的动态填充选择列表来查看工作中的 JS Fiddle。

[小提琴](http://jsfiddle.net/Pf6nz/)

# php - 如何在php中打印具有特定行和列格式的表格？

> ID：11227720
> 
> 赞同：0
> 
> 时间：2012-06-27T13:46:23.957
> 
> 标签：php, mysql

我有这张桌子![在此处输入图像描述](../Images/0939dc21ca7fd985389da4d43eb675c7.png)

我的目标是有一张像这样的桌子

![在此处输入图像描述](../Images/917e7e130f9f59659c7599ffb4e81c26.png)

该表有 8 行 3 列

我已经存储了这些问题，但我很难以这种格式打印它。

其中在打印 4 个问题后，它将转到另一个单元格并再次打印 4 个问题，然后一旦已经有 3 列，它将创建一个新行并再次执行相同的步骤。（8 行和 3 列）

问题按序号排序。[在下表中，第 1 4 个问题是 1,2,3,4，然后它右边的单元格是 6,7,8,9 等等....]

我已经坚持了将近8个小时了....

这是我当前的代码：

```
select = "SELECT q.QuestionID, q.QuestionText, q.m, q.l, q.GroupNo, q.SequenceNo FROM question2 q Order By q.SequenceNo";
$result = mysql_query($select);
$question_id = "";
$question_text = "";
$question_m = "";
$question_l = "";
$question_group = "";
//$table = "<table border='1' cellspacing='1'>";
$count_row = 0;
$array = array();
//$count_column = 0;
while($row = mysql_fetch_array($result))
{
    $question_id = $row['QuestionID'];
    $question_text = $row['QuestionText'];
    $question_m = $row['m'];
    $question_l = $row['l'];
    $question_group = $row['GroupNo'];
    $question_sequence = $row['SequenceNo'];

    if($count_row > 2)
    {
        $array[] .= "</div>";   
    }

    $array[] .= "<div style='border=1px';'>";
    $array[] .= $question_text ."<br/>";
    $count_row++;
}

$table .= "</table>";
echo $table; 
```

先生/女士，您的回答会很有帮助。谢谢++

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:55:59.603

```
$querstions = array();
$query = "SELECT QuestionID, QuestionText, m, l, GroupNo, SequenceNo FROM question2 ORDER BY SequenceNo";
$resource = mysql_query($query);
while($row = mysql_fetch_array($result))
{
   $querstions[$row['QuestionID']] = $row;
}

/* print table head */
echo "<table><thead>....

/* split up question in master_rows with 12 question each */
foreach(array_chunk($querstions, 12) as $master_row)
{
    echo ...

    foreach(range(0, 3) as $row_nr)
    {
        echo ... $master_row[$row_nr] ...;

        echo ... $master_row[$row_nr + 4] ...;

        echo ... $master_row[$row_nr + 8] ...;
    }

    echo ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T14:04:25.530

我不确定我是否完全理解这个问题，但你可以试试这个。我相信它会给你你想要的输出。

```
$row_count = 0;
echo "<table border=1>";

while($row = mysql_fetch_array($result)) {

    if($row_count%12 == 0) {
    echo "<tr>";
    }

    if($row_count%4 == 0) {
    echo "<td>";
    }

    echo $row['QuestionText']."<br>";

    if($row_count%4 == 3) {
    echo "</td>";
    }
    if($row_count%12 == 11) {
    echo "</tr>";
    }
    $row_count++;

}
echo "</table>"; 
```

它应该为您提供如下所示的输出：

```
<table border=1>
<tr>
<td>0<br>1<br>2<br>3<br></td>
<td>4<br>5<br>6<br>7<br></td>
<td>8<br>9<br>10<br>11<br></td>
</tr>
<tr>
<td>12<br>13<br>14<br>15<br></td>
<td>16<br>17<br>18<br>19<br></td>
<td>20<br>21<br>22<br>23<br></td>
</tr>
<tr>
<td>24<br>25<br>26<br>27<br></td>
<td>28<br>29<br>30<br>31<br></td>
<td>32<br>33<br>34<br>35<br></td>
</tr>
...
</table> 
```

# vim - 使 NERDTree 打开光标上次所在的文件

> ID：11227721
> 
> 赞同：3
> 
> 时间：2012-06-27T13:46:28.327
> 
> 标签：vim, nerdtree

我发现 NERDTree 真正令人讨厌的一件事是，当我打开一个五分钟前刚刚查看的文件时，该文件是从一开始就打开的，而不是光标上次打开的位置。

如果我使用 :b 缓冲区列表打开文件（它已经打开过一次），我没有这个问题，因为我被直接传送到我的光标最后的位置。这很有帮助，因为我的源文件很大。

有没有办法让 NERDTree 先在缓冲区列表中查看文件是否已经打开？或者也许还有其他方法可以解决我的问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T14:01:09.110

受此[Vim 提示](http://vim.wikia.com/wiki/Restore_cursor_to_file_position_in_previous_editing_session)的启发，我的 vimrc 中有以下内容，它会在打开光标时自动将光标移动到最后一个位置。NERDTree 似乎可以正常工作

```
au BufReadPost *
     \ if line("'\"") > 1 && line("'\"") <= line("$") |
     \   exe "normal! g`\"" |
     \ endif 
```

请注意，光标位置存储在您的 viminfo 文件中，因此`viminfo`应适当设置该选项。我认为默认值很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T08:01:52.650

试试这个，它确实恢复了光标的最后一个位置

> 设置隐藏

# c# - 斑马条纹列表框项目 XAML/C# Windows Phone 7.5

> ID：11227724
> 
> 赞同：2
> 
> 时间：2012-06-27T13:46:40.097
> 
> 标签：c#, xaml, windows-phone-7.1, zebra-striping

我想斑马纹一个列表框，它是从搜索返回的可观察对象集合生成的。

代码是这样的

```
 <ListBox x:Name="searchResultsListBox" Margin="0, 115, -12, 0">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,17">
                                <StackPanel Width="411">
                                    <TextBlock Text="{Binding Registration}" Margin="12, -6, 12, 0" TextWrapping="Wrap" FontSize="30" Foreground="White"/>
                                    <TextBlock Text="{Binding SalePrice}" Margin="12, -6, 12, 0" TextWrapping="Wrap" Style="{StaticResource PhoneTextSubtleStyle}" Foreground="#AFA7A0"/>
                                </StackPanel>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox> 
```

我将如何对其进行条纹处理，使第一个`<stackpanel>`是黄色，第二个是白色，第三个是黄色等等？

谢谢，丹尼。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T11:57:36.100

创建一个您将在列表框中使用的自定义控件。这将包含：

<StackPanel Orientation="Horizo​​ntal" Margin="0,0,0,17">
<Border Width="411">
<TextBlock Text="{Binding Registration}" Margin="12, -6, 12 , 0" TextWrapping="Wrap" FontSize="30" Foreground="White"/>
<TextBlock Text="{Binding SalePrice}" Margin="12, -6, 12, 0" TextWrapping="Wrap" Style=" {StaticResource PhoneTextSubtleStyle}" Foreground="#AFA7A0"/>
</Border >
</StackPanel>

维护可观察集合项中的索引。
将列表框绑定到可观察集合。

# c++ - C++ 命名空间问题

> ID：11227727
> 
> 赞同：0
> 
> 时间：2012-06-27T13:46:59.260
> 
> 标签：c++, namespaces

我有三个类，它们都来自不同的命名空间，如下所示：

类A.h

```
namespace outer
{
    namespace inner
    {
        class ClassA
        {
           ....
        };
    }
} 
```

B类.h

```
namespace inner
{
    class ClassB
    {
        ...
    };
} 
```

类C.h

```
#include <classB.h>

namespace outer
{
    namespace inner2
    {
        using inner::ClassB; // error here, says outer::inner2::ClassB has not been declared.

        class ClassC
        {
            ....
        };
     }
} 
```

我被困在这请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-27T13:48:09.493

你需要

```
using ::inner::ClassB; 
```

因为在 中`namespace outer`，您有 2 个选项`inner`

*   `::inner`- 全局命名空间
*   `::outer::inner`-`outer`命名空间

默认情况下，`using inner::ClassB;`将尝试`ClassB`从`outer::inner`.

# html - 选择元素 - 防止选择改变

> ID：11227731
> 
> 赞同：2
> 
> 时间：2012-06-27T13:47:34.817
> 
> 标签：html

如何取消组合框 (SELECT) 元素的更改事件。HTML SELECT 元素没有 onbefore 或 onchange 事件。如果我放：

```
<SELECT onchange="return false;">
    <OPTION value=a>A</OPTION>
    <OPTION value=b>B</OPTION>
</SELECT> 
```

活动没有取消。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T13:58:15.373

您需要保存`<select>`某处的原始值。这样您就可以将值更改回来。

取消事件，仅此而已。它只是取消事件，不会更改值。

示例（使用 jQuery）：

```
$(function(){
    $('select').each(function(){
        $(this).data('selected', $(this).val()); // back up value
    }).change(function(){
        if(confirm('Are you sure you want to change the element?')){
            $(this).data('selected', $(this).val()); // back up new value
        }
        else{
            $(this).val($(this).data('selected')); // restore old value
        }
    });
}); 
```

演示：http: [//jsfiddle.net/pL2B4/](http://jsfiddle.net/pL2B4/)

纯 JavaScript 解决方案（无 jQuery）：

```
var select = document.getElementsByTagName('select');
for (var i = 0, len = select.length; i < len; i++) {
    var el = select[i];
    el.setAttribute('data-selected', el.value);
    el.addEventListener('change', function() {
        if (confirm('Are you sure you want to change the element?')) {
            el.setAttribute('data-selected', el.value);
        }
        else {
            el.value = el.getAttribute('data-selected');
        }
    });
}​ 
```

演示：http: [//jsfiddle.net/pL2B4/1/](http://jsfiddle.net/pL2B4/1/)

# javascript - 搜索下拉项

> ID：11227736
> 
> 赞同：3
> 
> 时间：2012-06-27T13:47:49.683
> 
> 标签：javascript, jquery, html

我的问题听起来有点奇怪，但我需要那个功能，这就是我的问题，

我正在尝试编写一个控件，它的作用就像一个带有复选框列表项的下拉菜单，搜索后我在这里得到了相同的功能

[http://dropdown-check-list.googlecode.com/svn/trunk/doc/dropdownchecklist.html](http://dropdown-check-list.googlecode.com/svn/trunk/doc/dropdownchecklist.html)

我的要求是在类似于自动完成的下拉列表中进行搜索，当用户键入关键字时，它应该过滤下拉值，我是 Jquery 的新手，非常感谢任何帮助。

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T20:11:00.863

我做了一些这样的......首先创建一个div在这里插入一个控件，下面创建一个

*   数据在这里

抱歉...我是新来的，我无法上传图片！

# perl - Net::Twitter::Lite 无法使用 OAuth 进行身份验证

> ID：11227738
> 
> 赞同：0
> 
> 时间：2012-06-27T13:47:52.407
> 
> 标签：perl, twitter, oauth

我正在尝试为我的推文获得回复。我使用 Net::Twitter::Lite：

```
my $nt = Net::Twitter::Lite->new(%consumer_tokens, %access_tokens, legacy_lists_api=>1);
my $mentions = $nt->mentions();
print Dumper $mentions; 
```

但在那之后我只有一个错误：无法使用 OAuth 进行身份验证。有任何想法吗？

我可以发布类似的推文： `my $status = $nt->update({ status => 'some text' });` 但我无法得到回复。

**更新**

工作：

```
#!/usr/bin/perl
use warnings;
use strict;
use Net::Twitter::Lite;
use Data::Dumper;

my %consumer_tokens = (
consumer_key    => 'xxxxxxxxxxxxxxxxxxxxxxxx',
consumer_secret => 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx',
);
my %access_tokens=(
access_token => 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx',
access_token_secret => 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx',
);

my $nt = Net::Twitter::Lite->new(%consumer_tokens, %access_tokens, legacy_lists_api=>1);

#217932132083970049
my $status = $nt->update({ status => 'Happy Perl People!' });
print Dumper $status; 
```

不工作：

```
#!/usr/bin/perl
use warnings;
use strict;
use Net::Twitter::Lite;
use Data::Dumper;

my %consumer_tokens = (
consumer_key    => 'xxxxxxxxxxxxxxxxxxxxxxxx',
consumer_secret => 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx',
);
my %access_tokens=(
access_token => 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx',
access_token_secret => 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx',
);

my $nt = Net::Twitter::Lite->new(%consumer_tokens, %access_tokens, legacy_lists_api=>1);

#217932132083970049
my $mentions = $nt->mentions();
print Dumper $mentions; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T03:58:04.383

首先它注册api并生成信息，修改脚本并列出

```
use strict;
use warnings;
use Net::Twitter::Lite;

my $nt = Net::Twitter::Lite->new(
  consumer_key        => 'key_here', #first 
  consumer_secret     => 'consumer_secret_here', #
  access_token        => 'access_token', #second, generate token 
  access_token_secret =>  'access_token_secret', # 
  legacy_lists_api => 0,
);

my $result = eval { $nt->update('otra prueba') };

warn "$@\n" if $@; 
```

# sql-server - 从字符串转换为唯一标识符时转换失败

> ID：11227739
> 
> 赞同：-1
> 
> 时间：2012-06-27T13:47:55.247
> 
> 标签：sql-server, sql-server-2008, tsql

我有一个查询，它根据提供的唯一标识符 Id 选择一个表，所以当我将 Id 提供给一个值时，它会返回结果，但是如果我像下面这样传递它，我会收到一条错误消息。请建议在这种情况下如何使用 Convert 或 Cast 来解决此问题。谢谢

```
SELECT * FROM TBL WHERE ID='' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T14:23:58.040

假设`@id`是一个字符串参数，并且该`ID`列不可为空，您可以做一些像这样愚蠢的事情：

```
SELECT * FROM TBL WHERE ID = COALESCE(NULLIF(@id, ''), ID); 
```

`NULL`但实际上，如果没有值，而不是空字符串，您应该传递。这首先不应该是字符串参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:53:03.977

根据对此答案的评论，解决方案应该是这样的（在伪代码中）：

```
if textbox1.Text.ToString().Equals('') {
    SELECT * FROM TBL
}
else {
    SELECT * FROM TBL WHERE ID='"+textbox1.text+"' 
} 
```

您可以`IF`在 C# 应用程序中执行此操作。

# php - 文本的原点：imagettftext

> ID：11227741
> 
> 赞同：1
> 
> 时间：2012-06-27T13:48:01.833
> 
> 标签：php, imagettftext

我正在使用 imagettftext 函数在我的图像上写入文本，但问题是当我将 x,y 位置设置为 0,0 时，它确实在图像的左上角写入文本。

有没有办法让我的原点左上角？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-27T07:17:40.473

来自 PHP 手册：

> x 和 y 给出的坐标将定义第一个字符的基点（大约是字符的左下角）。这与 imagestring() 不同，其中 x 和 y 定义第一个字符的左上角。例如，“左上角”是 0, 0。

因此，如果您想要左上角的原点，您可以使用`imagestring()`或者您可以将字母高度与`imagettftext()`函数的 y 点相加。

要获取字母的高度，您可以使用`imagettfbbox()`以下函数：

```
$bbox = imagettfbbox ( $size , $angle , $fontfile , $text );
$y_offset = abs($bbox[7] - $bbox[1]);
imagettftext ( $image , $size , $angle , $x , $y + $y_offset , $color , $fontfile , $text ); 
```

# c# - asp.net 回发超时

> ID：11227747
> 
> 赞同：2
> 
> 时间：2012-06-27T13:48:18.357
> 
> 标签：c#, asp.net, postback

我有一个带有几个文本框和一个提交按钮的 aspx 页面。单击提交按钮后，会从屏幕上的表格/文本框创建一个 xml 文件。

如果立即执行此操作，则效果很好，但如果您在 20 分钟左右后单击该按钮，则页面会出错。

我有：

```
 <location path="Default.aspx">
        <system.web>
          <httpRuntime executionTimeout="1000000000"/>
        </system.web>
      </location> 
```

在 web.config 和`<asp:ScriptManager ID="ScriptManager1" runat="server" AsyncPostBackTimeout="1000000000" />`aspx 页面上，但它仍然在大约 20 分钟左右后超时。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T05:05:08.133

默认会话时间为 20 分钟 [Msdn](http://msdn.microsoft.com/en-us/library/h6bb9cz9.aspx)

这是其中一种方式

1\. [http://weblogs.asp.net/stevewellens/archive/2009/06/09/ah-ah-ah-ah-staying-alive-staying-alive.aspx](http://weblogs.asp.net/stevewellens/archive/2009/06/09/ah-ah-ah-ah-staying-alive-staying-alive.aspx)

检查此解决方案

2.[如何避免web.config中的会话超时](https://stackoverflow.com/q/5354541/1053241)

3\. [https://stackoverflow.com/a/412502/1053241](https://stackoverflow.com/a/412502/1053241)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T13:51:53.803

在您的 web.config 中，您很可能拥有

```
 <sessionState timeout="20"></sessionState> 
```

不过，您不应该真正将会话超时时间延长

[如何设置会话超时超过 20 分钟？](https://stackoverflow.com/questions/1725925/how-to-set-session-timeout-more-than-20-min) 这篇文章解释了检查会话超时的所有相关位置

此外，当您部署应用程序时，请记住检查 IIS 超时配置

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T13:52:18.900

可能 Session 结束了，尝试设置 SessionTimeOut，或者写一个 JavaScript 函数，定时发送 AJAX 请求，让 Session 保持活跃。但我真的不认为你是在正确的方式，如果会话结束你应该重定向到登录页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T14:11:13.837

这是保持会话活跃的一个很好的例子：http: [//www.dotnetcurry.com/ShowArticle.aspx? ID=453](http://www.dotnetcurry.com/ShowArticle.aspx?ID=453)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-27T14:31:52.180

此外，您可以警告用户他们即将退出系统并询问他们是否希望继续使用该站点，而不是延长您的会话

[http://programmerramblings.blogspot.co.uk/2011/07/aspnet-session-timeout-control-with.html](http://programmerramblings.blogspot.co.uk/2011/07/aspnet-session-timeout-control-with.html)

此控件可让您执行此操作

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-14T14:13:15.147

我在单个页面和按钮单击事件中设置它。如果您不希望在配置中更改应用程序范围的超时，似乎可以解决问题。

```
HttpContext.Current.Server.ScriptTimeout = 90000; 
```

# iphone - xcode：无法显示故障的确切行

> ID：11227748
> 
> 赞同：3
> 
> 时间：2012-06-27T13:48:20.663
> 
> 标签：iphone, ios, xcode

我一直看到这样的错误，但是 xcode 从未显示错误实际发生的行，如何设置 xcode 以直接显示故障线？到目前为止，它只是指向 main 函数。

```
2012-06-27 21:46:33.513 Chapeng[838:f803] -[SendGiftViewController giftButtonClicked]: unrecognized selector sent to instance 0x6e392a0 
```

回溯：

```
 (lldb) bt
* thread #1: tid = 0x1f03, 0x92f359c6 libsystem_kernel.dylib`__pthread_kill + 10, stop reason = signal SIGABRT
    frame #0: 0x92f359c6 libsystem_kernel.dylib`__pthread_kill + 10
    frame #1: 0x916e6f78 libsystem_c.dylib`pthread_kill + 106
    frame #2: 0x916d7bdd libsystem_c.dylib`abort + 167
    frame #3: 0x01e38e78 libc++abi.dylib`_Unwind_DeleteException
    frame #4: 0x01e3689e libc++abi.dylib`_ZL17default_terminatev + 34
    frame #5: 0x01c94f17 libobjc.A.dylib`_objc_terminate + 94
    frame #6: 0x01e368de libc++abi.dylib`_ZL19safe_handler_callerPFvvE + 13
    frame #7: 0x01e36946 libc++abi.dylib`std::terminate() + 23
    frame #8: 0x01e37b3e libc++abi.dylib`__cxa_rethrow + 83
    frame #9: 0x01c94e15 libobjc.A.dylib`objc_exception_rethrow + 47
    frame #10: 0x01612de0 CoreFoundation`CFRunLoopRunSpecific + 304
    frame #11: 0x01612c9b CoreFoundation`CFRunLoopRunInMode + 123
    frame #12: 0x0222b7d8 GraphicsServices`GSEventRunModal + 190
    frame #13: 0x0222b88a GraphicsServices`GSEventRun + 103
    frame #14: 0x0061b626 UIKit`UIApplicationMain + 1163
    frame #15: 0x00001ec2 Chapeng`main + 130 at main.m:16
(lldb) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T13:51:06.950

在 上添加符号断点`objc-exception-throw`。[此处](http://developer.apple.com/library/mac/#recipes/xcode_help-breakpoint_navigator/articles/adding_a_symbolic_breakpoint.html)提供了有关此的教程。这应该使 GDB / LLDB 在发送无法识别的选择器时停止执行。

编辑：阅读您的回溯后，您的 IB 连接似乎无效。检查视图控制器上的所有按钮，并确保它们链接到正确的选择器。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-27T13:52:05.810

按`cmd`+ `shift`+`f`并粘贴`giftButtonClicked`。它将显示项目中的字符串列表，查找您从任何类调用此方法的位置。将引发此错误，因为`giftButtonClicked`在调用时方法无法识别

# java - 创建流而不是临时文件并使用它们并丢弃它们

> ID：11227755
> 
> 赞同：1
> 
> 时间：2012-06-27T13:48:45.203
> 
> 标签：java, servlets, stream

我想写入流并立即使用它，而不是将其写入文件并读取。文件不是线程安全的，我认为它可能会影响性能。

```
 //set property to an existing file
    prop.setProperty("$quoteValidity",""no");
    prop.setProperty("$date", "today");
    prop.setProperty("$quantitySum",  Integer.toString(quantitySum));

    //store it in temporary location
    prop.store(new FileOutputStream("<Temp file location>"), null);

    //open that temp file as stream
    InputStream propfile = new FileInputStream("<Temp file location>");

    List<Order> orderList = XmlToList.makeOrderFromNodeList(orderNode);
    //use that temp file
    Testground.generateXlsx(propfile,orderList); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:11:21.467

尝试使用 ByteArrayOutputStream 而不是 FileOutputStream。然后你可以打电话

```
 byte[] bytes=byteArrayOutputStream.toByteArray() 
```

在 ByteArrayOutputStream 上获取字节

然后构造一个 ByteArrayInputStream(bytes) 并将其传递给 Testground

# c# - 注销后在窗口服务中打印

> ID：11227756
> 
> 赞同：1
> 
> 时间：2012-06-27T13:48:46.393
> 
> 标签：c#, service, window

用户注销事件后是否可以通过窗口服务打印文件或执行任何操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:58:51.130

您可以使用以下链接查找 `Microsoft.Win32.SystemEvents`和`SessionEnded`事件以捕获注销

[http://msdn.microsoft.com/en-us/library/microsoft.win32.systemevents.aspx](http://msdn.microsoft.com/en-us/library/microsoft.win32.systemevents.aspx)

或通过以下方式

```
 BOOL WTSRegisterSessionNotification(
  __in  HWND hWnd,
  __in  DWORD dwFlags
); 
```

[http://msdn.microsoft.com/en-us/library/aa383841%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa383841%28VS.85%29.aspx)

# php - 在 PHP 中循环多维数组时遇到问题

> ID：11227759
> 
> 赞同：0
> 
> 时间：2012-06-27T13:48:53.737
> 
> 标签：php, arrays, multidimensional-array

我有以下数组。它包含昵称和名称：

```
$nickAndNames = array( 
    array( "Johnie", "John Larson" ),
    array ("Maggie", "Margaret London" ),
    array("Nic","Nicholas Carradine")
); 
```

你能帮我打印第一个元素吗？我的意思是约翰尼、玛吉、尼克。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T13:50:51.857

数组的每个元素都是另一个数组。这个内部数组的每个元素依次包含 2 个元素：元素 0（一个字符串，昵称）和元素 1（另一个字符串，名字）。因此，您首先需要遍历`$nicksAndNames`数组，然后显示内部数组的第一个元素（即元素 0）：

```
// loop through $nickAndNames and assign, in turn, each inner array
// to a variable named $nickAndName
foreach ($nickAndNames as $nickAndName) {
    // this $nickAndName variable now contains the inner array, something like:
    // array("Johnie", "John Larson"), so "Johnie" is the first element,
    // element 0
    echo $nickAndName[0];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T13:51:33.377

您想使用[foreach](http://php.net/manual/en/control-structures.foreach.php)循环遍历数组，然后打印第一个元素 index `0`。

```
$nickAndNames = array( 
    array( "Johnie", "John Larson" ),
    array ("Maggie", "Margaret London" ),
    array("Nic","Nicholas Carradine")
);

foreach ($nickAndNames as $name) {
    echo $name[0];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T13:51:01.367

这将遍历所有名称：

```
foreach( $nickAndNames as $data)
    echo $data[0]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T13:51:00.363

看这里：

```
foreach ($nickAndNames as $key => $value) {
    var_dump($value[0]);
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-06-27T13:51:10.977

这应该给你一些工作：

```
foreach ($nickAndNames as $person)
{
    reset($person); // May not be needed.
    print current($person);
} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-06-27T13:53:57.657

如果您可以使用正确命名的键值对来更正您的数组，如下所示，

```
$nickAndNames = array( 
         array( "nickname" => "Johnie", "name" => "John Larson" ),
         array ("nickname" => "Maggie", "name" => "Margaret London" ),
         array("nickname" => "Nic","name" => "Nicholas Carradine")
         ); 
```

你可以做

```
foreach($nickAndNames as $nickAndName){
    if(is_array($nickAndName))
    {
        foreach($nickAndName as $nN)
        {
             echo 'nickname = '. $nN['nickname'];
             echo 'name = '. $nN['name'];
        }
    }
    else
    {
        echo 'nickname = '. $nN['nickname'];
        echo 'name = '. $nN['name'];
    }
} 
```

希望这可以帮助，

卡尔提克

# windows-8 - 在 Windows 8 Metro 风格应用程序中将数据保存为键值对？

> ID：11227761
> 
> 赞同：0
> 
> 时间：2012-06-27T13:49:01.427
> 
> 标签：windows-8, microsoft-metro

在我的应用程序中，我想将数据保存为键值对。这怎么可能？

# java - 在 Java 平铺游戏中移动角色？

> ID：11227762
> 
> 赞同：0
> 
> 时间：2012-06-27T13:49:11.193
> 
> 标签：java, graphics, javafx

（对不起英语，我是法国学生，也是java初学者）

我已经看过处理 Java 游戏中置换字符的主题，但我仍然有两个问题。我使用基于数组 int[][] ( [http://img15.hostingpics.net/pics/91631150ex.png](http://img15.hostingpics.net/pics/91631150ex.png) ) 和 PaintComponent 方法的土地 2d 等轴测图：

如果我想流畅地移动一个角色（很快就会由一个有腿、胳膊和头的小人物来表示），我不知道：

*   如何在不严重影响绘图的情况下以图形方式将表格中一个框的人物移动到另一个框
*   如何移动角色，即使使用 JavaFX 我也无法提供轨迹和动作（以及腿移动角色动作）

感谢阅读和帮助:)

编辑：我已经听说过 JavaFX 中的 TimeLine，但它只提供基本的翻译，不是吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:00:26.980

首先，我想建议您彻底浏览图形设置指南的链接，我认为您可以克服您的问题 [http://www.ffxivcore.com/tutorials/article/6-ffxiv-graphical-settings-guide/](http://www.ffxivcore.com/tutorials/article/6-ffxiv-graphical-settings-guide/)

# c# - 图像控制的必填字段验证器

> ID：11227764
> 
> 赞同：1
> 
> 时间：2012-06-27T13:49:17.760
> 
> 标签：c#, asp.net, server-side, dynamically-generated

**旧标题：防止动态创建的控件保留价值**

**旧信息：** 我需要这样做的原因是因为我正在尝试为 Image 控件的必填字段验证器创建一个解决方法。我的代码的工作方式是我在按钮旁边有一个图像控件，用户单击按钮，然后被提示上传图像。我需要确保在用户进入下一阶段之前上传图像。

由于图像控件没有必填字段验证器，因此我创建了一个文本框，假设每次在回发时重新创建图像控件时都会显示图像控件的 imageURL。但是，文本框始终保留最初创建控件的值。

***注意：页面上的所有控件都是动态创建的。

我要做的第一件事是创建图像控件并将其添加到 HTML 表中。这工作正常。之后，我找到表格单元格并将文本框添加到具有图像控件的单元格中：

```
HtmlTableCell tc = (HtmlTableCell)customProperties.FindControl("tcControl_" + (i + 1).ToString());
RadBinaryImage rbi = (RadBinaryImage)customProperties.FindControl("CustomControl" + (i + 1).ToString());

TextBox photoValue = new TextBox();
photoValue.ID = "CustomControl" + (i + 1).ToString() + "_txt";
photoValue.Text = rbi.imageUrl; 
```

每次我创建所有控件时都会发生这种情况。对于所有控件，它们都保留其值，这是我不希望发生这种情况的唯一控件。有谁知道如何做到这一点？或者另一种验证图像控件的方法？

感谢您的宝贵时间，感谢所有评论/答案（：

**解决了：**

[我创建了我在此处](http://www.4guysfromrolla.com/webtech/tips/t040302-1.shtml)找到的复选框列表必填字段验证器的修改版本。 这是代码：出于安全原因，我用######## 替换了命名空间。

```
using System;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.ComponentModel;
using Telerik.Web.UI;

namespace #######################################
{
    public class RequiredFieldValidatorForImages :
                        System.Web.UI.WebControls.BaseValidator
    {
        private Control _ctrl;

        public RequiredFieldValidatorForImages()
        {
            base.EnableClientScript = false;
        }

        protected override bool ControlPropertiesValid()
        {
            Control ctrl = FindControl(ControlToValidate);

            if (ctrl != null)
            {
                _ctrl = (Control)ctrl;
                return (_ctrl != null);
            }
            else
                return false;  // raise exception
        }

        protected override bool EvaluateIsValid()
        {
            try
            {
                Image rbi = (Image)_ctrl;
                return rbi.ImageUrl != "~/images/noimages.jpg";
            }
            catch
            {
                RadBinaryImage rbi = (RadBinaryImage)_ctrl;
                return rbi.ImageUrl != "~/images/noimages.jpg";
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:48:54.270

**解决了：**

[我创建了我在此处](http://www.4guysfromrolla.com/webtech/tips/t040302-1.shtml)找到的复选框列表必填字段验证器的修改版本。 这是代码：出于安全原因，我用######## 替换了命名空间。

```
using System;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.ComponentModel;
using Telerik.Web.UI;

namespace #######################################
{
    public class RequiredFieldValidatorForImages :
                        System.Web.UI.WebControls.BaseValidator
    {
        private Control _ctrl;

        public RequiredFieldValidatorForImages()
        {
            base.EnableClientScript = false;
        }

        protected override bool ControlPropertiesValid()
        {
            Control ctrl = FindControl(ControlToValidate);

            if (ctrl != null)
            {
                _ctrl = (Control)ctrl;
                return (_ctrl != null);
            }
            else
                return false;  // raise exception
        }

        protected override bool EvaluateIsValid()
        {
            try
            {
                Image rbi = (Image)_ctrl;
                return rbi.ImageUrl != "~/images/noimages.jpg";
            }
            catch
            {
                RadBinaryImage rbi = (RadBinaryImage)_ctrl;
                return rbi.ImageUrl != "~/images/noimages.jpg";
            }
        }
    }
} 
```

# wcf - svc 不工作

> ID：11227765
> 
> 赞同：0
> 
> 时间：2012-06-27T13:49:18.473
> 
> 标签：wcf, iis, svc

我有一些问题并试图解决几天..

我安装了 iis 6.0，但我更新了 7.5 express 和 7.0。看起来是7.5版本。。

所以，我将 wcf 发布到 localhost 并设置 4501 端口。运行 iis 时可以看到文件 `http://localhost:4501/`

但 svc 文件不起作用。当我单击或键入 `http://localhost:4501/Products.svc` 时，它不起作用，我看到一个空白网站.. 什么都没有..

但是如果我在 Visual Studio 中运行 svc 客户端，asp.net 开发服务器可以工作，我的 svc 文件也可以工作.. (http://localhost:4501/Products.svc) 一切都一样..

我不明白为什么 IIS 不能正常工作？

我认为 6.0 不支持.. 我使用代理，我可以使用代理连接到我的全局 ip，或者我的朋友打开它.. 但仍然 svc 文件不起作用..

我认为问题是 iis .. 但是从全局角度来看，asp.net 开发服务器也不起作用，但它可以在 localhost 上运行..

我打开了所有端口，向防火墙添加了一些新规则并关闭了防火墙（调制解调器和计算机）

我真的变疯了。。

编辑：我尝试连接 ip，`http://myGlobaLIp:4501` 我可以在本地主机上看到我的文件，但如果我尝试`http://myGlobalIp:4501/Products.svc`，我会得到空白页..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:59:38.723

这是您的问题：当您从 Visual Studio 运行时，它会自动为您运行一个虚拟 IIS，并分配 ip/port...在这种情况下它是`http://localhost:4501/`. 当您设置站点并在 IIS 中运行它时，您必须在网站设置期间设置这些值。

您需要在 IIS 中创建一个网站，然后指向您的代码（将其发布到诸如 c:\inetpub\wwwroot\myapp 之类的位置）然后您需要设置您的 web 服务应该在哪个端口上运行。

然后，转到 http://{您的 ip 或机器名}:{在 IIS 中配置的端口，而不是 VS 虚拟 IIS 端口}/Products.svc

以下是 Microsoft 帮助您部署网站（或 wcf Web 服务）的分步说明：[http://technet.microsoft.com/en-US/library/f6c26eb7-ad7e-4fe2-9239-9f5aa4ff44ce。 aspx](http://technet.microsoft.com/en-US/library/f6c26eb7-ad7e-4fe2-9239-9f5aa4ff44ce.aspx)

祝你好运

# javascript - 是否可以使用 Javascript 或 jQuery 将 mp3 文件转换为 m4r？

> ID：11227769
> 
> 赞同：2
> 
> 时间：2012-06-27T13:49:29.880
> 
> 标签：javascript, jquery, web

是否可以使用 Javascript 或 jQuery 将 mp3、wav 等转换为 m4r 格式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T13:57:23.687

假设您有一个可以更改文件格式的库。

我们还假设您只需要应用程序在当前浏览器上运行，`FileAPI`这样您就可以访问上传的文件（如果没有或除非您使用或或等效技术，`FileReference`您将无法访问它们）。`FileAPI``FileReference``Flash``Java Applets`

您将无法将输出文件**写**回给用户，因为不允许 JavaScript 访问本地文件系统。

您唯一的解决方案是将转换后的文件发送到服务器，然后服务器使用强制下载指令将其发送回您，以便提示用户下载结果。

现在回到是否有一个可以转换的库（甚至是原生 JavaScript）......我还没有听说过。构建一个并非不可能，但它是不切实际的，并且不会运行得很快。

## 编辑：

让我们不要忘记***Node.js***！

它是一个使用 Google Chrome 的**V8** JavaScript 解释器/编译器的后端服务器。它运行 JavaScript 作为后端脚本引擎。

如果您使用文件系统、数据库和一切（或任何其他后端系统）并且仍在使用 JavaScript，则您可以访问它。您也可以使用库。要么是用 JavaScript 编写的，要么是用其他语言编写的库，这些库已经链接到 Node.js 的接口。

## 编辑2：

有一个完全用 JavaScript 编写的 PC 模拟器。如果您愿意，它会运行二进制可执行文件。它被称为[JSLinux](http://bellard.org/jslinux/)。

如果您感觉特别吵闹，您可以获取`ffmpeg`二进制可执行文件（使用静态链接编译）。并将其作为 uuencoded 字符串嵌入到您的应用程序代码中，然后使用 JSLinux 执行命令并获取结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T14:08:56.680

实际上，可以使用最新的 js 技术在客户端上执行此操作。一个网络工作者线程可以在后台完成工作。至少在 Firefox 和 Chrome 中，还可以使用新的[W3C 文件 API](http://dev.w3.org/2006/webapi/FileAPI/)读取（“在内存中上传”）和写入（“从内存中下载”）文件，请参见[此处](https://stackoverflow.com/questions/6076047/create-a-download-link-from-a-blob-url)。

[我设法使用谷歌的 GWT](http://code.google.com/p/lib-gwt-file/)通过拖放从客户端和在客户端内读取文件，这最终是纯 JavaScript，因此它必须也可以“本地”执行。

除此之外，会话算法当然必须在 javascript web worker 中实现以避免阻塞 gui。这应该是最难的部分，但并非不可能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T13:54:28.717

您需要一个后端来执行此操作。您可能想查看[FFmpeg](http://www.ffmpeg.org/)的[PHPExtension](http://ffmpeg-php.sourceforge.net/)

# linux - 有没有办法在 Linux 终端中开发 Rational Team Concert (RTC) 项目？

> ID：11227774
> 
> 赞同：2
> 
> 时间：2012-06-27T13:49:51.267
> 
> 标签：linux, git, unix, rtc

我是一名新员工，我更喜欢在 UNIX 环境中工作，但是我参与的项目是在 IBM WebSphere 环境中开发的——IBM WID 连接到 RTC 存储库。我可以从 UNIX 开发什么方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T11:52:24.227

[对不起，没有阅读问题的标题-修改答案]

RTC 有一个在 Linux 上运行良好的命令行界面。这个接口的主要用途是版本控制操作，链接到工作项。RTC v3 的参考指南在这里： http: [//pic.dhe.ibm.com/infocenter/clmhelp/v3r0m1/index.jsp](http://pic.dhe.ibm.com/infocenter/clmhelp/v3r0m1/index.jsp)。搜索“源代码控制命令行参考”（位于帮助的参考部分），或者 RTC 的最新发布版本是 v4 - [http://pic.dhe.ibm.com/infocenter/clmhelp/v4r0/index。 .jsp](http://pic.dhe.ibm.com/infocenter/clmhelp/v4r0/index.jsp) _ 搜索相同的字符串“源代码管理命令行参考”。

您还可以选择直接在 Linux 中使用 WID（基于 Eclipse 的开发环境）。WID 7.0 支持 Linux（请参阅[http://www-01.ibm.com/support/docview.wss?uid=swg27016959](http://www-01.ibm.com/support/docview.wss?uid=swg27016959)）。

如果您使用的是其他版本的 WID - 搜索该版本的系统要求以查看是否支持 Linux。

从 WID 的角度来看 - RTC 作为 Eclipse 插件安装到 WID 环境中，以提供源代码管理、工作项/任务管理和构建功能。

正如 VonC 正确指出的那样 - 您需要了解跨平台依赖关系，但这些不应该阻止您在 Linux/Unix 平台上使用 WID 和 RTC。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T14:20:44.737

“从 Linux 到 Windows，从 Mac 到大型机，从 Eclipse 到 Visual Studio，我们都能满足您的需求”，[他们的网站](https://jazz.net/products/rational-team-concert/)说。据我所知，RTC由web软件+UI（多平台）、eclipse（多平台）、多平台运行的websphere和不同平台支持的源码控制组成。此外，Linux/Unix 列在其[支持的环境中](http://www-01.ibm.com/software/rational/products/rtc/sysreq/)。所以是的，您应该能够从 UNIX 进行开发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T07:14:27.877

您可以在 Linux 上进行开发，但要注意经典的跨平台问题，例如：

*   [潜在的案例问题](https://jazz.net/forum/questions/47355/how-insensitive-suggestions-about-rtc-naming-conventions)：您可以存储
*   [权限未保存](https://jazz.net/forum/questions/48370/file-permissions-in-scm)：RTC 不存储/恢复文件权限，除了“执行”位，它仅适用于 Unix 系统，因为 Windows 使用文件的扩展名来确定“可执行性”，而不是执行位。
*   [eol 样式](https://jazz.net/forum/questions/29972/linux-rtc-client-checking-in-read-only-dos-mode-files)（或[混合 eol](https://jazz.net/forum/questions/63732/mixing-line-delimiters-destroys-change-history)）：分配给文本文件的默认 EOL RTC 是 `PLATFORM`，并且 RTC 将尝试将您的文本文件转换为行尾。

# java - 作业帮助：列出构造函数和异常

> ID：11227781
> 
> 赞同：0
> 
> 时间：2012-06-27T13:50:14.013
> 
> 标签：java, list, exception, constructor

我目前正在远离学校上课，我的教授没有帮助，所以我想知道是否有人可以指点我该做什么。给我的指示如下：

您可以创建自己的列表类 (MyList)，它可以容纳任意数量的项目，最多不超过数组的实际大小。您的班级将维护存储在数组中的实际项目数的计数器。该数组将是 Object 类型，因此您的数组可以包含任何 Object 或 Object 的子类。您的课程应提供以下方法：

*   `void append(Object o)`– 将对象附加到列表的末尾。`ListFullException`如果列表已满，则抛出 a 。

*   `Object at(int index)`– 返回指定位置的对象，`ArrayIndexOutOfBoundsException`如果索引无效，则抛出一个。

*   `void remove(int index)`– 删除索引处的元素并将其后的元素向下移动以填充空白空间。`ArrayIndexOutOfBoundsException`如果索引无效并且`ListEmptyException`列表为空且没有可删除的内容，则抛出。

*   `MyList(int size)`– 构造函数，它采用大小来制作数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:23:20.630

您可以在 MyList 类的底层实现中使用 ArrayList。

在构造函数中，使用传递的大小来初始化数组列表，如：

```
arrayList=new ArrayList<Object>(size); 
```

在 append 方法中，您可以简单地将传递的对象添加到 arrayList（在进行大小检查并抛出 ListFullException 之后）：

```
arrayList.add(obj); 
```

类似地，分别使用 ArrayList 的 remove 和 get 方法来实现 remove 和 objectAt 功能。

# taxonomy - 本体：OWL - 在类之间创建连接

> ID：11227786
> 
> 赞同：10
> 
> 时间：2012-06-27T13:50:34.527
> 
> 标签：taxonomy, ontology, owl, protege

我有一个用 OWL 和 Protege 编写的本体。但我没有找到在类之间创建关系的解决方案。当然，有一个“子类”关系，但我想定义我自己的关系。所以我有一个类层次结构（由“子类”关系组成），但我想创建一个关系，即“has_Relation”，以连接两个类。

我的目标是编写一个 java 程序，在其中我可以获得“哪个类是类的父类？”的信息。和“has_Relation 连接到哪个类？”

（我不是在谈论个人 - 我只是在谈论班级）

非常感谢您提前提供的帮助！

最好的问候纳坦

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-28T08:04:42.530

最简单的方法是使用注解属性。在 Protégé 中，选择要与另一个类关联的类，然后单击`+`“注释”选项卡中的“注释”旁边。然后`has_Relation`使用窗口左上角的第二个按钮添加属性。然后选择 Entity IRI 选项卡和 Classes 子选项卡，选择要关联的其他类，然后就完成了。

`has_Relation`但是，如果是对象属性或数据类型属性，则不应这样做。如果是这种情况，您可以使用“双关语”，也就是说，您可以在“个人”选项卡中创建与要关联的类同名的新个人。然后你把他们当成正常人来联系。请注意，这在 OWL 2 DL 中是允许且有效的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-05-02T14:32:41.217

有点晚了，但是：

您还可以转到选项卡菜单并激活对象属性选项卡（Window> Tabs -> Object Properties）

然后，您可以创建自己的对象属性并将其域和范围分配给您想要的任何类（单个属性的描述区域）。

# c# - 为什么我的 Excel office 对象会留下 EXCEL.exe 进程？

> ID：11227794
> 
> 赞同：3
> 
> 时间：2012-06-27T13:51:00.290
> 
> 标签：c#, asp.net, excel, dispose, office-interop

> **可能重复：**
> [如何在 C# 中正确清理 Excel 互操作对象](https://stackoverflow.com/questions/158706/how-to-properly-clean-up-excel-interop-objects-in-c-sharp)

我有一个使用 C# 的 Office 互操作库的应用程序。

这个库是从 IIS7 托管的 ASP.NET 应用程序中调用的。

相关的代码位是：

```
/// <summary>
/// Provides excel functions.
/// </summary>
public class ExcelStuff : IDisposable
{
    #region Excel Components

    // The following are pre-allocated Excel objects that must be explicitly disposed of.

    private Excel.Application xApp;
    private Excel.Workbooks xWorkbooks;
    private Excel.Workbook xWorkbook;
    private Excel.Sheets xWorksheets;
    private Excel.Worksheet xWorksheet;
    private Excel.ChartObjects xCharts;
    private Excel.ChartObject xMyChart;
    private Excel.Chart xGraph;
    private Excel.SeriesCollection xSeriesColl;
    private Excel.Series xSeries;

    #endregion

    /// <summary>
    /// Initializes a new instance of the <see cref="ExcelStuff" /> class.
    /// </summary>
    public ExcelStuff()
    {
    }

    /// <summary>
    /// Does some work.
    /// </summary>
    public void DoWork()
    {
        byte[] data = new byte[0];

        worker = new Thread(() =>
        {
            // Do some work.
        });

        worker.Start();
        worker.Join();

        worker.Abort();
        worker = null;

        Dispose();
    }

    /// <summary>
    /// Disposes the current object and cleans up any resources.
    /// </summary>
    public void Dispose()
    {
        // Cleanup
        xWorkbook.Close(false);
        xApp.Quit();

        // Manual disposal because of COM
        xApp = null;
        xWorkbook = null;
        xWorksheets = null;
        xWorksheet = null;
        xCharts = null;
        xMyChart = null;
        xGraph = null;
        xSeriesColl = null;
        xSeries = null;

        GC.Collect();
    }
} 
```

你会注意到代码中有很多冗余，这是我解决这个问题的绝望尝试。**所以请不要告诉我打电话效率低下`GC.Collect()`或者`Dispose()`从班内打电话不好 - 我已经知道这些事情了。**

我想知道的是，`EXCEL.exe`当我尽最大努力清理尽可能多的对象时，为什么这段代码让孤立的进程在服务器上运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T14:07:04.793

正如评论中提到的那样，Marshal.ReleaseComObject 是我用来清理 excel 对象的。这是我的代码示例：

```
 wb.Close(false, System.Reflection.Missing.Value, System.Reflection.Missing.Value);

        while (System.Runtime.InteropServices.Marshal.ReleaseComObject(wb) != 0)
        { }

        excelApp.Quit();

        while (System.Runtime.InteropServices.Marshal.ReleaseComObject(excelApp) != 0)
        { } 
```

这似乎对我有用。祝你好运！

**编辑：**对不起，没有看到这是一个重复。Mods可以用这个做任何事情......

# c# - Outlook MailItem 作为流

> ID：11227797
> 
> 赞同：4
> 
> 时间：2012-06-27T13:51:06.793
> 
> 标签：c#, stream, outlook, office-interop

是否可以将 a`MailItem`直接作为**Stream**返回？（*`MailItem`来自`Microsoft.Office.Interop.Outlook`*）

现在我找到了一个临时解决方案，首先将 a 保存`MailItem`到目录，打开它并将流返回到文件，然后再次删除文件。

在处理大量电子邮件时，这个临时解决方案很慢，我想用例如直接返回一个`MailItem`as来替换它`MemoryStream`。

如何才能做到这一点？

（**由于评论而编辑：**慢是一部分，但另一个代码部分（无法修改）只接受一个流，这就是我正在寻找将 MailItem 作为流打开的解决方案的方式）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T17:06:29.250

我想到了你的慢问题。我在写我的时候遇到了一些可能会产生巨大影响的东西。

当我在非缓存模式下使用 Outlook 时，检索并打开每封电子邮件，然后将其移动到已处理的文件夹中，至少可以说是很困难的。当我将它置于缓存模式时，当然我必须编写代码以确保它能够同步所有内容，因此我在开始之前就有了最新信息。

当它被缓存时，您可以同时打开许多邮件项目，并且并行处理，通常在非缓存模式下它会在 32 左右停止！它的开放理念（和我们的）不同。

所以，我也尝试了一个 imap 类，sheesh 让我们再也不要谈论那是什么错误。

如果您有一些代码，也许我们可以提供帮助？如果你没有缓存模式，我可能会挖掘出我是如何强制它同步所有代码的，它不像我想象的那么好和简单（我可能错过了一些东西），但它工作得非常可靠，现在可以处理所有备份电子邮件我明白了。。

# javascript - 如何使用 Jquery Validation 插件专门验证某个表单字段

> ID：11227802
> 
> 赞同：2
> 
> 时间：2012-06-27T13:51:12.660
> 
> 标签：javascript, jquery

我正在使用[Jquery Validation 插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)在提交之前在客户端验证我的表单。

一旦用户填写了该字段（onblur），我的表单中有一个特定字段，我想使用 ajax 对服务器进行验证。（基本上是用户名字段，我想在服务器上检查用户名是否可用并相应地显示一条消息）

这是我用来验证表单的代码：

```
$(document).ready(function()
{
     $("#signupForm").validate({
        submitHandler: ajaxSubmitForm});

}); 
```

（ajaxSubmitForm只是提交表单的js代码）

如何使用 Jquery Validation 插件让用户名字段在更改时将其值发送到服务器（使用 ajax）并让服务器返回一个结果，该结果以某种方式将该字段标记为在客户端上有效，以便其余的验证作品？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T13:37:02.493

您可以使用该元素上的[远程规则来执行此操作。](http://docs.jquery.com/Plugins/Validation/Methods/remote#options)你会这样申请：

```
$('#signupForm').validate({
    rules: {
        username: {
            remote: 'check_username.php' // this is the service page that returns true/false
        }
    }
}); 
```

然后要触发模糊验证，请添加以下内容：

```
$('input[name="username"]').on('blur', function() {
    $('#signupForm').validate().element(this); // this triggers the single element validation
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T14:21:23.130

submitHandler 在第一次提交表单之前不会触发。如果您想在用户第一次填写表单时检查用户名的唯一性，您需要一个单独的函数。下面的示例假设您有一个页面运行 SQL 查询以查看提供的用户名是否存在于数据库中，然后返回一个 json 字符串，例如`"{taken:false}"`用户名是否唯一

```
$('#yourForm [name="username"]').on('blur',function(){
    var username = $(this).val();
    $.get('check/username.php',{username:username},function(data) {
        if(data.taken) {
            // highlight the field and indicate that the username is already taken
        }
    },'json');
} 
```

调用的细节`$.get`取决于你的后端是如何设置的。但总的来说，这个过程会：

*   用户输入用户名
*   用户模糊了场外
*   对服务器进行 $.get 或 $.ajax 调用以检查用户名的唯一性
*   如果来自服务器的响应表明用户名不是唯一的，请处理您的验证（突出显示该字段，添加**X**图标等）并且要么
    *   在用户名唯一之前阻止表单提交，或者
    *   让表单提交并返回重复用户名的错误

**更新**

如果要为验证插件创建新规则，可以执行以下操作：

```
function isUsernameUnique(username,field) {
  var unique = false;
  $.ajax({
    url: 'path/to/usernameCheck/',
    data: { username: username },
    async: false,
    success: function(data) { unique = data.unique; }
  });
  return unique;
}

$.validator.addMethod(
    'uniqueUsername',
    isUsernameUnique,
    'That username is already in use. Please choose a unique username.'
); 
```

然后，在表单的 validate 函数中：

```
$('#yourForm').validate({
  ...
  rules: {
    username: { uniqueUsername: true }
    ...
  }
  ...
}); 
```

并且，您的用户名字段的单独`blur`功能：

```
$('[name="username"]').on('blur',function(){
  var unique = isUsernameUnique($(this).val(),$(this));
  if(!unique) {
    // handle error
  }
}); 
```

这使您可以为预提交验证和验证插件重用相同的功能。但是，我在这里看到两个问题：

1 - 在您第一次提交后，$.fn.validate() 将急切地验证您的用户名字段，这意味着`blur`不再需要用户名字段上的事件。也许您可以在第一次提交后禁用它以防止不必要的 ajax 调用

2 - 它不是 100% DRY，因为您需要在`blur`事件处理程序中进行自己的错误处理

# symfony - symfony2、behat 和 mink：重定向后访问容器

> ID：11227805
> 
> 赞同：0
> 
> 时间：2012-06-27T13:51:19.693
> 
> 标签：symfony, behat, mink

我有一个 behat+mink 场景，其中一个步骤访问一个 URL (mink)，并且控制器

*   将某些东西放入容器中的服务中
*   执行重定向到另一个 URL

问题是控制器重定向重置了容器，所以重新构造了服务，下面的behat步骤不能再访问了

有没有办法访问容器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T08:03:37.367

在[CommonContexts](https://github.com/Behat/CommonContexts)中有一个[MinkRedirectContext](https://github.com/Behat/CommonContexts/blob/master/Behat/CommonContexts/MinkRedirectContext.php)。您可以使用它来防止重定向。这样您就可以在重定向之前检查容器。

# algorithm - 网店中的“您可能会喜欢这些产品”是如何实现的？

> ID：11227807
> 
> 赞同：4
> 
> 时间：2012-06-27T13:51:28.190
> 
> 标签：algorithm, e-commerce, amazon, implementation

一些电子商务平台具有建议功能，一旦您在购物篮中有一件商品，他们就会告诉您“您可能也喜欢这个产品”。一些，如亚马逊，依赖预先存在的客户行为数据，他们的功能被称为“购买此商品的客户也购买了”，但有些人似乎通过其他方式提出建议。

这些“其他手段”是什么？他们在网上商店中使用什么样的算法来实现此功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T13:54:26.840

他们使用数据挖掘，而您询问的这种特定算法称为“最近邻”算法。

这是我写的关于算法的文章的链接（以及许多其他文章）。

[http://www.ibm.com/developerworks/opensource/library/os-weka3/index.html](http://www.ibm.com/developerworks/opensource/library/os-weka3/index.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-27T13:57:19.913

该过程称为`Business Intelligence`，数据将存储在数据仓库中，并且可以使用诸如`SSAS`. 该过程将涉及将大量数据（谁购买了什么以及何时购买）分组到`data cubes`. 对这些立方体进行分析，并用于将您的购买与购买相同产品的其他人进行比较，然后推荐他们的购买（购买此商品的其他客户，也购买了此商品....商品 X）。其他各种人工智能算法用于比较其他客户趋势的模式，例如他们如何购物、他们在哪里点击等。所有这些数据都被积累起来，然后添加到数据立方体中进行分析。

数据挖掘算法概述如下，您可以查找`Decision Tree Modelling algorithm`BI 如何确定趋势和模式（在本例中为建议）：

[http://msdn.microsoft.com/en-us/library/ms175595.aspx](http://msdn.microsoft.com/en-us/library/ms175595.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-27T14:01:25.203

关于这种算法的最好的书是：[Programming Collective Intelligence](http://shop.oreilly.com/product/9780596529321.do)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-28T09:23:12.510

电子商务页面上的大多数建议都是使用某种推荐系统（[http://en.wikipedia.org/wiki/Recommender_system](http://en.wikipedia.org/wiki/Recommender_system)）创建的。像 Mahout ( [http://mahout.apache.org/](http://mahout.apache.org/) ) 这样的工具已经实现了最常用的方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-30T18:42:43.557

正如一些较早的人所回答的那样，这称为推荐引擎。它也被称为协同过滤技术。很少有工具可以做到这一点，Mahout 就是其中之一。请参阅我写的博客，其中讨论了我们使用[Mahout 和 Hadoop 构建推荐引擎](https://krishnasblog.com/2012/06/29/implementing-a-recommender-engine-using-hadoop-and-mahout/)的用例。作为这方面的先驱，我还编写了一个[组件架构](https://krishnasblog.com/2012/06/24/hadoop-and-mahout-in-data-mining/)，说明每个组件如何组合在一起解决数据挖掘问题。

Mahout 可以在独立模式下工作，也可以与 Hadoop 一起工作。使用其中任何一个的决定实际上归结为需要挖掘的历史数据的大小。如果数据大小为 TB 和 PB 量级，则通常将 Mahout 与 Hadoop 结合使用。Weka 是另一个类似的开源项目。所有这些都属于称为机器学习框架的类别。我希望它有所帮助。

# java - 为什么处理排序数组比处理未排序数组更快？

> ID：11227809
> 
> 赞同：26250
> 
> 时间：2012-06-27T13:51:36.160
> 
> 标签：java, c++, performance, cpu-architecture, branch-prediction

这是一段 C++ 代码，它显示了一些非常特殊的行为。出于某种奇怪的原因，对数据进行排序（*在*定时区域之前）奇迹般地使循环快了近六倍。

```
#include <algorithm>
#include <ctime>
#include <iostream>

int main()
{
    // Generate data
    const unsigned arraySize = 32768;
    int data[arraySize];

    for (unsigned c = 0; c < arraySize; ++c)
        data[c] = std::rand() % 256;

    // !!! With this, the next loop runs faster.
    std::sort(data, data + arraySize);

    // Test
    clock_t start = clock();
    long long sum = 0;
    for (unsigned i = 0; i < 100000; ++i)
    {
        for (unsigned c = 0; c < arraySize; ++c)
        {   // Primary loop
            if (data[c] >= 128)
                sum += data[c];
        }
    }

    double elapsedTime = static_cast<double>(clock()-start) / CLOCKS_PER_SEC;

    std::cout << elapsedTime << '\n';
    std::cout << "sum = " << sum << '\n';
} 
```

*   如果没有`std::sort(data, data + arraySize);`，代码将在 11.54 秒内运行。
*   使用排序后的数据，代码运行时间为 1.93 秒。

（排序本身比遍历数组需要更多时间，因此如果我们需要为未知数组计算它，实际上不值得这样做。）

* * *

最初，我认为这可能只是语言或编译器异常，所以我尝试了 Java：

```
import java.util.Arrays;
import java.util.Random;

public class Main
{
    public static void main(String[] args)
    {
        // Generate data
        int arraySize = 32768;
        int data[] = new int[arraySize];

        Random rnd = new Random(0);
        for (int c = 0; c < arraySize; ++c)
            data[c] = rnd.nextInt() % 256;

        // !!! With this, the next loop runs faster
        Arrays.sort(data);

        // Test
        long start = System.nanoTime();
        long sum = 0;
        for (int i = 0; i < 100000; ++i)
        {
            for (int c = 0; c < arraySize; ++c)
            {   // Primary loop
                if (data[c] >= 128)
                    sum += data[c];
            }
        }

        System.out.println((System.nanoTime() - start) / 1000000000.0);
        System.out.println("sum = " + sum);
    }
} 
```

有类似但不太极端的结果。

* * *

我的第一个想法是排序将数据带入[缓存](https://en.wikipedia.org/wiki/CPU_cache)，但后来我认为这是多么愚蠢，因为数组刚刚生成。

*   到底是怎么回事？
*   为什么处理排序数组比处理未排序数组更快？

该代码总结了一些独立的术语，因此顺序无关紧要。

* * *

**关于不同/更高版本的编译器和选项的相同效果的**相关/后续问答：****

 ***   [为什么处理未排序数组的速度与使用现代 x86-64 clang 处理已排序数组的速度相同？](https://stackoverflow.com/q/66521344)
*   [gcc 优化标志 -O3 使代码比 -O2 慢](https://stackoverflow.com/q/28875325)

* * *

## 回答 #1

> 赞同：33859
> 
> 时间：2012-06-27T13:56:42.820

**你是[分支预测](https://en.wikipedia.org/wiki/Branch_predictor)失败的受害者。**

* * *

## 什么是分支预测？

考虑一个铁路枢纽：

[![显示铁路枢纽的图像](../Images/99fa1b644ec190e81842f5d58a8e0285.png)](https://commons.wikimedia.org/wiki/File:Entroncamento_do_Transpraia.JPG) [[图片](https://commons.wikimedia.org/wiki/File:Entroncamento_do_Transpraia.JPG)由 Mecanismo 提供，来自 Wikimedia Commons。在[CC-By-SA 3.0](https://creativecommons.org/licenses/by-sa/3.0/deed.en)许可下使用。]

现在为了争论，假设这是在 1800 年代——在远距离或无线电通信之前。

你是一个路口的操作员，你听到火车来了。你不知道它应该走哪条路。你停下火车问司机他们想要哪个方向。然后你适当地设置开关。

*火车很重并且有很大的惯性，所以它们需要很长时间才能启动和减速。*

有没有更好的办法？你猜火车会开往哪个方向！

*   如果你猜对了，它会继续。
*   如果你猜错了，船长会停下来，后退，然后对你大喊大叫来拨动开关。然后它可以重新启动另一条路径。

**如果你每次都猜对**了，火车就永远不用停下来。
**如果你猜错的次数太频繁**，火车将花费大量时间停止、倒车和重新启动。

* * *

**考虑一个 if 语句：**在处理器级别，它是一个分支指令：

![包含 if 语句的已编译代码的屏幕截图](../Images/3a9d1834f42c8423cdd8e31b3d035fbf.png)

你是一个处理器，你看到一个分支。你不知道它会朝哪个方向发展。你做什么工作？您停止执行并等待前面的指令完成。然后你继续沿着正确的路径前进。

*现代处理器很复杂并且有很长的流水线。这意味着他们需要永远“热身”和“减速”。*

有没有更好的办法？你猜这个分支会往哪个方向走！

*   如果你猜对了，你继续执行。
*   如果你猜错了，你需要刷新管道并回滚到分支。然后，您可以重新启动另一条路径。

**如果你每次都猜对**了，执行将永远不会停止。
**如果您经常猜错**，您会花费大量时间停止、回滚和重新启动。

* * *

这是分支预测。我承认这不是最好的类比，因为火车只能用旗帜指示方向。但是在计算机中，处理器直到最后一刻才知道分支将走向哪个方向。

您将如何策略性地猜测以最小化火车必须倒车并沿另一条路径行驶的次数？你看看过去的历史！如果火车 99% 的时间都是左转，那么你猜是左转。如果它交替，那么你交替你的猜测。如果它每 3 次去一个方向，你猜同样...

***换句话说，您尝试识别一种模式并遵循它。***这或多或少是分支预测器的工作方式。

大多数应用程序都有良好的分支。因此，现代分支预测器通常会达到 >90% 的命中率。但是当面对无法识别的模式的不可预测的分支时，分支预测器实际上是无用的。

进一步阅读：[维基百科上的“分支预测器”文章](https://en.wikipedia.org/wiki/Branch_predictor)。

* * *

## 正如上面所暗示的，罪魁祸首是这个 if 语句：

```
if (data[c] >= 128)
    sum += data[c]; 
```

注意数据均匀分布在 0 到 255 之间。当对数据进行排序时，大约前一半的迭代不会进入 if 语句。之后，它们都将进入 if 语句。

这对分支预测器非常友好，因为分支连续多次朝同一个方向移动。即使是一个简单的饱和计数器也能正确预测分支，除了它切换方向后的几次迭代。

**快速可视化：**

```
T = branch taken
N = branch not taken

data[] = 0, 1, 2, 3, 4, ... 126, 127, 128, 129, 130, ... 250, 251, 252, ...
branch = N  N  N  N  N  ...   N    N    T    T    T  ...   T    T    T  ...

       = NNNNNNNNNNNN ... NNNNNNNTTTTTTTTT ... TTTTTTTTTT  (easy to predict) 
```

但是，当数据完全随机时，分支预测器就变得毫无用处，因为它无法预测随机数据。因此可能会有大约 50% 的错误预测（不比随机猜测好）。

```
data[] = 226, 185, 125, 158, 198, 144, 217, 79, 202, 118,  14, 150, 177, 182, ...
branch =   T,   T,   N,   T,   T,   T,   T,  N,   T,   N,   N,   T,   T,   T  ...

       = TTNTTTTNTNNTTT ...   (completely random - impossible to predict) 
```

* * *

**可以做什么？**

如果编译器无法将分支优化为条件移动，如果您愿意牺牲可读性来换取性能，您可以尝试一些技巧。

代替：

```
if (data[c] >= 128)
    sum += data[c]; 
```

和：

```
int t = (data[c] - 128) >> 31;
sum += ~t & data[c]; 
```

这消除了分支并用一些按位操作替换它。

[（请注意，这个 hack 并不严格等同于原始 if 语句。但在这种情况下，它对 的所有输入值都有效`data[]`。）]

**基准测试：Core i7 920 @ 3.5 GHz**

C++ - Visual Studio 2010 - x64 版本

| 设想 | 时间（秒） |
| --- | --- |
| 分支 - 随机数据 | 11.777 |
| 分支 - 排序数据 | 2.352 |
| 无分支 - 随机数据 | 2.564 |
| 无分支 - 排序数据 | 2.587 |

Java - NetBeans 7.1.1 JDK 7 - x64

| 设想 | 时间（秒） |
| --- | --- |
| 分支 - 随机数据 | 10.93293813 |
| 分支 - 排序数据 | 5.643797077 |
| 无分支 - 随机数据 | 3.113581453 |
| 无分支 - 排序数据 | 3.186068823 |

观察：

*   **使用分支：**已排序数据和未排序数据之间存在巨大差异。
*   **使用技巧：**排序数据和未排序数据之间没有区别。
*   在 C++ 的情况下，当数据被排序时，hack 实际上比使用分支慢一点。

一般的经验法则是避免关键循环中的数据相关分支（例如在此示例中）。

* * *

**更新：**

*   `-O3`带有或在 x64 上的GCC 4.6.1`-ftree-vectorize`能够生成条件移动，因此已排序数据和未排序数据之间没有区别 - 两者都很快。

    （或者有点快：对于已经排序的情况，`cmov`可能会更慢，特别是如果 GCC 将其放在关键路径上而不是 just`add`上，尤其是在 Broadwell 之前的 Intel 上，其中`cmov`有 2 个周期延迟：[gcc 优化标志 -O3 使代码比 -O2 慢](https://stackoverflow.com/questions/28875325/gcc-optimization-flag-o3-makes-code-slower-than-o2))

*   即使在`/Ox`.

*   [英特尔 C++ 编译器](https://en.wikipedia.org/wiki/Intel_C++_Compiler)(ICC) 11 做了一些神奇的事情。它[交换了两个循环](https://en.wikipedia.org/wiki/Loop_interchange)，从而将不可预测的分支提升到外循环。它不仅不受错误预测的影响，而且速度也是 VC++ 和 GCC 生成的速度的两倍！换句话说，ICC 利用测试循环击败了基准测试......

*   如果您为英特尔编译器提供无分支代码，它会直接对其进行矢量化......并且与分支（使用循环交换）一样快。

这表明即使是成熟的现代编译器在优化代码的能力上也会有很大的不同......

* * *

## 回答 #2

> 赞同：4465
> 
> 时间：2012-06-27T13:54:45.240

**分支预测。**

对于排序数组，条件`data[c] >= 128`首先`false`是一系列值，然后是`true`所有后面的值。这很容易预测。使用未排序的数组，您需要支付分支成本。

* * *

## 回答 #3

> 赞同：3623
> 
> 时间：2012-06-28T02:14:03.600

数据排序后性能显着提高的原因是分支预测惩罚被删除，正如[Mysticial 的回答](//stackoverflow.com/questions/11227809/why-is-it-faster-to-process-a-sorted-array-than-an-unsorted-array/11227902#11227902)中所解释的那样。

现在，如果我们看一下代码

```
if (data[c] >= 128)
    sum += data[c]; 
```

我们可以发现这个特定`if... else...`分支的含义是在满足条件时添加一些东西。这种类型的分支可以很容易地转换为**条件移动**语句，该语句将在系统中编译为条件移动指令：`cmovl`，`x86`。分支和潜在的分支预测惩罚被移除。

`C`因此，在`C++`中，将直接编译（没有任何优化）到条件移动指令中的语句`x86`是三元运算符`... ? ... : ...`。所以我们把上面的语句改写成等价的：

```
sum += data[c] >=128 ? data[c] : 0; 
```

在保持可读性的同时，我们可以检查加速因子。

在 Intel [Core i7](//en.wikipedia.org/wiki/Intel_Core#Core_i7) -2600K @ 3.4 GHz 和 Visual Studio 2010 发布模式上，基准测试为：

**x86**

| 设想 | 时间（秒） |
| --- | --- |
| 分支 - 随机数据 | 8.885 |
| 分支 - 排序数据 | 1.528 |
| 无分支 - 随机数据 | 3.716 |
| 无分支 - 排序数据 | 3.71 |

**x64**

| 设想 | 时间（秒） |
| --- | --- |
| 分支 - 随机数据 | 11.302 |
| 分支 - 排序数据 | 1.830 |
| 无分支 - 随机数据 | 2.736 |
| 无分支 - 排序数据 | 2.737 |

结果在多次测试中是稳健的。当分支结果不可预测时，我们得到了很大的加速，但当它是可预测的时，我们会受到一点影响。事实上，当使用条件移动时，无论数据模式如何，性能都是相同的。

`x86`现在让我们通过调查它们生成的程序集来更仔细地观察。为简单起见，我们使用两个函数`max1`和`max2`。

`max1`使用条件分支`if... else ...`：

```
int max1(int a, int b) {
    if (a > b)
        return a;
    else
        return b;
} 
```

`max2`使用三元运算符`... ? ... : ...`：

```
int max2(int a, int b) {
    return a > b ? a : b;
} 
```

在 x86-64 机器上，`GCC -S`生成下面的程序集。

```
:max1
    movl    %edi, -4(%rbp)
    movl    %esi, -8(%rbp)
    movl    -4(%rbp), %eax
    cmpl    -8(%rbp), %eax
    jle     .L2
    movl    -4(%rbp), %eax
    movl    %eax, -12(%rbp)
    jmp     .L4
.L2:
    movl    -8(%rbp), %eax
    movl    %eax, -12(%rbp)
.L4:
    movl    -12(%rbp), %eax
    leave
    ret

:max2
    movl    %edi, -4(%rbp)
    movl    %esi, -8(%rbp)
    movl    -4(%rbp), %eax
    cmpl    %eax, -8(%rbp)
    cmovge  -8(%rbp), %eax
    leave
    ret 
```

`max2`由于使用指令，使用更少的代码`cmovge`。但真正的收获是`max2`不涉及分支跳转，`jmp`如果预测结果不正确，这将产生显着的性能损失。

那么为什么有条件的移动表现更好呢？

在典型的`x86`处理器中，一条指令的执行分为几个阶段。粗略地说，我们有不同的硬件来处理不同的阶段。所以我们不必等待一条指令完成来开始新的指令。这称为**[流水线](//en.wikipedia.org/wiki/Pipeline_(computing))**。

在分支情况下，后面的指令是由前面的指令决​​定的，所以我们不能进行流水线操作。我们必须等待或预测。

在条件移动情况下，执行条件移动指令分为几个阶段，但前面的阶段喜欢`Fetch`并且`Decode`不依赖于前一条指令的结果；只有后期需要结果。因此，我们等待一条指令执行时间的一小部分。这就是为什么当预测很容易时条件移动版本比分支慢的原因。

《*[Computer Systems: A Programmer's Perspective》一书，第二版](https://rads.stackoverflow.com/amzn/click/com/0136108040)*详细解释了这一点。您可以查看第 3.6.6 节中的*条件移动指令*、整个第 4 章中的*处理器架构*以及第 5.11.2 节中有关*分支预测和错误预测惩罚*的特殊处理。

有时，一些现代编译器可以将我们的代码优化为具有更好性能的汇编，有时一些编译器不能（有问题的代码使用 Visual Studio 的本机编译器）。当场景变得如此复杂以至于编译器无法自动优化它们时，了解分支和条件移动之间的性能差异可以帮助我们编写性能更好的代码。

* * *

## 回答 #4

> 赞同：2491
> 
> 时间：2012-07-03T02:25:30.523

如果您对可以对此代码进行的更多优化感到好奇，请考虑以下几点：

从原始循环开始：

```
for (unsigned i = 0; i < 100000; ++i)
{
    for (unsigned j = 0; j < arraySize; ++j)
    {
        if (data[j] >= 128)
            sum += data[j];
    }
} 
```

通过循环交换，我们可以安全地将这个循环更改为：

```
for (unsigned j = 0; j < arraySize; ++j)
{
    for (unsigned i = 0; i < 100000; ++i)
    {
        if (data[j] >= 128)
            sum += data[j];
    }
} 
```

然后，您可以看到`if`条件在整个`i`循环执行过程中是恒定的，因此您可以提升`if`输出：

```
for (unsigned j = 0; j < arraySize; ++j)
{
    if (data[j] >= 128)
    {
        for (unsigned i = 0; i < 100000; ++i)
        {
            sum += data[j];
        }
    }
} 
```

然后，您会看到内部循环可以折叠成一个表达式，假设浮点模型允许它（`/fp:fast`例如被抛出）

```
for (unsigned j = 0; j < arraySize; ++j)
{
    if (data[j] >= 128)
    {
        sum += data[j] * 100000;
    }
} 
```

那个速度比以前快了 100,000 倍。

* * *

## 回答 #5

> 赞同：2046
> 
> 时间：2012-10-12T05:53:33.240

毫无疑问，我们中的一些人会对识别对 CPU 的分支预测器有问题的代码的方法感兴趣。Valgrind 工具`cachegrind`有一个分支预测器模拟器，通过使用`--branch-sim=yes`标志启用。在这个问题中的示例上运行它，外部循环的数量减少到 10000 并使用 编译`g++`，得到以下结果：

**排序：**

```
==32551== Branches:        656,645,130  (  656,609,208 cond +    35,922 ind)
==32551== Mispredicts:         169,556  (      169,095 cond +       461 ind)
==32551== Mispred rate:            0.0% (          0.0%     +       1.2%   ) 
```

**未分类：**

```
==32555== Branches:        655,996,082  (  655,960,160 cond +  35,922 ind)
==32555== Mispredicts:     164,073,152  (  164,072,692 cond +     460 ind)
==32555== Mispred rate:           25.0% (         25.0%     +     1.2%   ) 
```

`cg_annotate`深入研究我们看到的循环产生的逐行输出：

**排序：**

```
 Bc    Bcm Bi Bim
      10,001      4  0   0      for (unsigned i = 0; i < 10000; ++i)
           .      .  .   .      {
           .      .  .   .          // primary loop
 327,690,000 10,016  0   0          for (unsigned c = 0; c < arraySize; ++c)
           .      .  .   .          {
 327,680,000 10,006  0   0              if (data[c] >= 128)
           0      0  0   0                  sum += data[c];
           .      .  .   .          }
           .      .  .   .      } 
```

**未分类：**

```
 Bc         Bcm Bi Bim
      10,001           4  0   0      for (unsigned i = 0; i < 10000; ++i)
           .           .  .   .      {
           .           .  .   .          // primary loop
 327,690,000      10,038  0   0          for (unsigned c = 0; c < arraySize; ++c)
           .           .  .   .          {
 327,680,000 164,050,007  0   0              if (data[c] >= 128)
           0           0  0   0                  sum += data[c];
           .           .  .   .          }
           .           .  .   .      } 
```

这使您可以轻松识别有问题的行 - 在未排序的版本中，该`if (data[c] >= 128)`行在 cachegrind 的分支预测器模型下导致 164,050,007 个错误预测的条件分支 ( `Bcm`)，而在排序版本中仅导致 10,006 个。

* * *

或者，在 Linux 上，您可以使用性能计数器子系统来完成相同的任务，但使用 CPU 计数器具有本机性能。

```
perf stat ./sumtest_sorted 
```

**排序：**

```
 Performance counter stats for './sumtest_sorted':

  11808.095776 task-clock                #    0.998 CPUs utilized          
         1,062 context-switches          #    0.090 K/sec                  
            14 CPU-migrations            #    0.001 K/sec                  
           337 page-faults               #    0.029 K/sec                  
26,487,882,764 cycles                    #    2.243 GHz                    
41,025,654,322 instructions              #    1.55  insns per cycle        
 6,558,871,379 branches                  #  555.455 M/sec                  
       567,204 branch-misses             #    0.01% of all branches        

  11.827228330 seconds time elapsed 
```

**未分类：**

```
 Performance counter stats for './sumtest_unsorted':

  28877.954344 task-clock                #    0.998 CPUs utilized          
         2,584 context-switches          #    0.089 K/sec                  
            18 CPU-migrations            #    0.001 K/sec                  
           335 page-faults               #    0.012 K/sec                  
65,076,127,595 cycles                    #    2.253 GHz                    
41,032,528,741 instructions              #    0.63  insns per cycle        
 6,560,579,013 branches                  #  227.183 M/sec                  
 1,646,394,749 branch-misses             #   25.10% of all branches        

  28.935500947 seconds time elapsed 
```

它还可以通过反汇编进行源代码注释。

```
perf record -e branch-misses ./sumtest_unsorted
perf annotate -d sumtest_unsorted 
```

```
 Percent |      Source code & Disassembly of sumtest_unsorted
------------------------------------------------
...
         :                      sum += data[c];
    0.00 :        400a1a:       mov    -0x14(%rbp),%eax
   39.97 :        400a1d:       mov    %eax,%eax
    5.31 :        400a1f:       mov    -0x20040(%rbp,%rax,4),%eax
    4.60 :        400a26:       cltq   
    0.00 :        400a28:       add    %rax,-0x30(%rbp)
... 
```

有关更多详细信息，请参阅[性能教程](https://perf.wiki.kernel.org/index.php/Tutorial)。

* * *

## 回答 #6

> 赞同：1493
> 
> 时间：2013-04-24T06:26:28.820

我刚刚阅读了这个问题及其答案，我觉得缺少答案。

我发现在托管语言中特别有效的消除分支预测的一种常用方法是使用表查找而不是使用分支（尽管在这种情况下我没有对其进行测试）。

这种方法通常在以下情况下有效：

1.  它是一个小表，很可能缓存在处理器中，并且
2.  您正在一个非常紧凑的循环中运行事物和/或处理器可以预加载数据。

**背景和原因**

从处理器的角度来看，您的内存很慢。为了弥补速度上的差异，您的处理器中内置了几个高速缓存（L1/L2 高速缓存）。所以想象一下，你正在做你的漂亮计算，并发现你需要一块内存。处理器将执行其“加载”操作并将这块内存加载到缓存中——然后使用缓存来完成其余的计算。因为内存相对较慢，所以这个“负载”会减慢你的程序。

与分支预测一样，这在奔腾处理器中进行了优化：处理器预测它需要加载一段数据并尝试在操作实际命中缓存之前将其加载到缓存中。正如我们已经看到的，分支预测有时会出错——在最坏的情况下，您需要返回并实际等待内存加载，这将花费很长时间（**换句话说：失败的分支预测是不好的，内存分支预测失败后加载太可怕了！**）。

对我们来说幸运的是，如果内存访问模式是可预测的，处理器会将其加载到其快速缓存中，一切都很好。

我们首先要知道什么是*小*？虽然通常越小越好，但经验法则是坚持使用 <= 4096 字节大小的查找表。作为上限：如果您的查找表大于 64K，则可能值得重新考虑。

**构建表**

所以我们发现我们可以创建一个小表。接下来要做的是获得一个查找功能。查找函数通常是使用几个基本整数运算（和、或、异或、移位、加、删除甚至乘）的小函数。您希望通过查找功能将您的输入翻译成表格中的某种“唯一键”，然后它会简单地为您提供您希望它完成的所有工作的答案。

在这种情况下：>= 128 意味着我们可以保留该值，< 128 意味着我们摆脱它。最简单的方法是使用“AND”：如果我们保留它，我们用 7FFFFFFF 与它；如果我们想去掉它，我们用 0 与它。还要注意 128 是 2 的幂——所以我们可以继续制作一个包含 32768/128 整数的表，并用一个 0 和很多7FFFFFFFF 的。

**托管语言**

您可能想知道为什么这在托管语言中运行良好。毕竟，托管语言使用分支检查数组的边界，以确保您不会搞砸......

好吧，不完全是...... :-)

在消除托管语言的这个分支方面已经做了很多工作。例如：

```
for (int i = 0; i < array.Length; ++i)
{
   // Use array[i]
} 
```

在这种情况下，编译器很明显永远不会遇到边界条件。至少 Microsoft JIT 编译器（但我希望 Java 会做类似的事情）会注意到这一点并完全删除检查。哇，这意味着没有分支。同样，它将处理其他明显的情况。

如果您在托管语言中的查找遇到问题——关键是在`& 0x[something]FFF`查找函数中添加一个以使边界检查可预测——并观察它的运行速度。

**本案结果**

```
// Generate data
int arraySize = 32768;
int[] data = new int[arraySize];

Random random = new Random(0);
for (int c = 0; c < arraySize; ++c)
{
    data[c] = random.Next(256);
}

/*To keep the spirit of the code intact, I'll make a separate lookup table
(I assume we cannot modify 'data' or the number of loops)*/

int[] lookup = new int[256];

for (int c = 0; c < 256; ++c)
{
    lookup[c] = (c >= 128) ? c : 0;
}

// Test
DateTime startTime = System.DateTime.Now;
long sum = 0;

for (int i = 0; i < 100000; ++i)
{
    // Primary loop
    for (int j = 0; j < arraySize; ++j)
    {
        /* Here you basically want to use simple operations - so no
        random branches, but things like &, |, *, -, +, etc. are fine. */
        sum += lookup[data[j]];
    }
}

DateTime endTime = System.DateTime.Now;
Console.WriteLine(endTime - startTime);
Console.WriteLine("sum = " + sum);
Console.ReadLine(); 
```

* * *

## 回答 #7

> 赞同：1334
> 
> 时间：2013-02-15T07:24:16.033

由于在数组排序时数据分布在 0 到 255 之间，因此前半部分左右的迭代不会进入- 语句`if`（该`if`语句在下面共享）。

```
if (data[c] >= 128)
    sum += data[c]; 
```

问题是：是什么让上述语句在某些情况下不像排序数据那样执行？这里出现了“分支预测器”。分支预测器是一种数字电路，它试图猜测分支（例如，`if-then-else`结构）在确定之前会走哪条路。分支预测器的目的是改善指令流水线中的流程。分支预测器在实现高效性能方面发挥着关键作用！

**让我们做一些基准测试以更好地理解它**

- 语句的性能`if`取决于其条件是否具有可预测的模式。如果条件始终为真或始终为假，处理器中的分支预测逻辑将选择该模式。另一方面，如果模式是不可预测的，则 - 语句的`if`开销会大得多。

让我们在不同的条件下测量这个循环的性能：

```
for (int i = 0; i < max; i++)
    if (condition)
        sum++; 
```

以下是具有不同真假模式的循环时间：

```
Condition                Pattern             Time (ms)
-------------------------------------------------------
(i & 0×80000000) == 0    T repeated          322

(i & 0xffffffff) == 0    F repeated          276

(i & 1) == 0             TF alternating      760

(i & 3) == 0             TFFFTFFF…           513

(i & 2) == 0             TTFFTTFF…           1675

(i & 4) == 0             TTTTFFFFTTTTFFFF…   1275

(i & 8) == 0             8T 8F 8T 8F …       752

(i & 16) == 0            16T 16F 16T 16F …   490 
```

“<strong>bad”真假模式可以`if`比“<strong>good”模式慢六倍！当然，哪种模式好，哪种模式不好取决于编译器和特定处理器生成的确切指令。

所以分支预测对性能的影响是毫无疑问的！

* * *

## 回答 #8

> 赞同：1267
> 
> 时间：2013-07-22T08:29:30.290

避免分支预测错误的一种方法是构建一个查找表，并使用数据对其进行索引。Stefan de Bruijn 在他的回答中讨论了这一点。

但是在这种情况下，我们知道值在 [0, 255] 范围内，并且我们只关心 >= 128 的值。这意味着我们可以轻松提取一个位来告诉我们是否需要一个值：通过移位数据向右 7 位，我们剩下 0 位或 1 位，我们只想在有 1 位时添加值。我们称这个位为“决策位”。

通过使用决策位的 0/1 值作为数组的索引，我们可以使代码无论数据是否排序都同样快。我们的代码总是会添加一个值，但是当决策位为 0 时，我们会在我们不关心的地方添加该值。这是代码：

```
// Test
clock_t start = clock();
long long a[] = {0, 0};
long long sum;

for (unsigned i = 0; i < 100000; ++i)
{
    // Primary loop
    for (unsigned c = 0; c < arraySize; ++c)
    {
        int j = (data[c] >> 7);
        a[j] += data[c];
    }
}

double elapsedTime = static_cast<double>(clock() - start) / CLOCKS_PER_SEC;
sum = a[1]; 
```

此代码浪费了一半的添加，但从未出现分支预测失败。它在随机数据上的速度比带有实际 if 语句的版本快得多。

但是在我的测试中，显式查找表比这稍微快一点，可能是因为索引到查找表比位移略快。这显示了我的代码如何设置和使用查找表（`lut`在代码中难以想象地称为“查找表”）。这是 C++ 代码：

```
// Declare and then fill in the lookup table
int lut[256];
for (unsigned c = 0; c < 256; ++c)
    lut[c] = (c >= 128) ? c : 0;

// Use the lookup table after it is built
for (unsigned i = 0; i < 100000; ++i)
{
    // Primary loop
    for (unsigned c = 0; c < arraySize; ++c)
    {
        sum += lut[data[c]];
    }
} 
```

在这种情况下，查找表只有 256 字节，所以它非常适合缓存并且速度很快。如果数据是 24 位值并且我们只想要其中的一半，那么这种技术将无法正常工作……查找表太大而无法实用。另一方面，我们可以结合上面显示的两种技术：首先移动位，然后索引查找表。对于我们只需要上半部分值的 24 位值，我们可能会将数据右移 12 位，并留下一个 12 位值作为表索引。12 位表索引意味着一个包含 4096 个值的表，这可能是实用的。

索引到数组的技术，而不是使用`if`语句，可用于决定使用哪个指针。我看到一个实现二叉树的库，而不是有两个命名指针（`pLeft`和`pRight`或其他），而是有一个长度为 2 的指针数组，并使用“决策位”技术来决定遵循哪一个。例如，而不是：

```
if (x < node->value)
    node = node->pLeft;
else
    node = node->pRight; 
```

这个库会做类似的事情：

```
i = (x < node->value);
node = node->link[i]; 
```

这是此代码的链接：[Red Black Trees](https://web.archive.org/web/20190207151651/https://www.eternallyconfuzzled.com/tuts/datastructures/jsw_tut_rbtree.aspx) , *Eternally Confuzzled*

* * *

## 回答 #9

> 赞同：1140
> 
> 时间：2013-07-24T07:57:39.443

在排序的情况下，您可以比依赖成功的分支预测或任何无分支比较技巧做得更好：完全删除分支。

实际上，该阵列被划分在一个连续的区域中`data < 128`，另一个是`data >= 128`。[因此，您应该通过二分法搜索](https://en.wikipedia.org/wiki/Dichotomic_search)（使用比较）找到分区点`Lg(arraySize) = 15`，然后从该点进行直接累加。

像（未选中）

```
int i= 0, j, k= arraySize;
while (i < k)
{
  j= (i + k) >> 1;
  if (data[j] >= 128)
    k= j;
  else
    i= j;
}
sum= 0;
for (; i < arraySize; i++)
  sum+= data[i]; 
```

或者，稍微更加模糊

```
int i, k, j= (i + k) >> 1;
for (i= 0, k= arraySize; i < k; (data[j] >= 128 ? k : i)= j)
  j= (i + k) >> 1;
for (sum= 0; i < arraySize; i++)
  sum+= data[i]; 
```

一种更快的方法，它给出了排序或未排序的**近似**`sum= 3137536;`解决方案是：（假设真正均匀分布，16384 个样本，期望值为 191.5）**:-)**

* * *

## 回答 #10

> 赞同：934
> 
> 时间：2015-07-03T15:35:52.687

由于分支预测，上述行为正在发生。

要了解分支预测，首先必须了解**指令流水线**：

任何指令都被分解为一系列步骤，以便不同的步骤可以同时并行执行。这种技术被称为指令流水线，用于增加现代处理器的吞吐量。为了更好地理解这一点，请[在 Wikipedia 上查看此示例](https://en.wikipedia.org/wiki/Pipeline_(computing)#Concept_and_motivation)。

通常，现代处理器的流水线很长，但为了方便起见，我们只考虑这 4 个步骤。

1.  IF——从内存中获取指令
2.  ID——解码指令
3.  EX -- 执行指令
4.  WB——写回CPU寄存器

***4 级流水线一般用于 2 条指令。*** ![一般4级流水线](../Images/0c5dd9f2bb000d829236c53e0d079856.png)

回到上面的问题，让我们考虑以下说明：

```
 A) if (data[c] >= 128)
                                /\
                               /  \
                              /    \
                        true /      \ false
                            /        \
                           /          \
                          /            \
                         /              \
              B) sum += data[c];          C) for loop or print(). 
```

如果没有分支预测，将发生以下情况：

要执行指令 B 或指令 C，处理器必须等到指令 A 未到达流水线中的 EX 阶段，因为执行指令 B 或指令 C 的决定取决于指令 A 的结果。所以流水线看起来像这样。

***当 if 条件返回 true 时：*** ![在此处输入图像描述](../Images/421f5ba7612d45064b33894982bcfbad.png)

***当 if 条件返回 false 时：*** ![在此处输入图像描述](../Images/f9e715179db13540a52aba18bb54c077.png)

由于等待指令 A 的结果，在上述情况下花费的总 CPU 周期（没有分支预测；对于真和假）是 7。

**那么什么是分支预测呢？**

分支预测器将尝试猜测分支（if-then-else 结构）在确定之前会走哪条路。它不会等待指令 A 到达流水线的 EX 阶段，但它会猜测决定并转到该指令（在我们的示例中为 B 或 C）。

***如果猜对了，管道看起来像这样：*** ![在此处输入图像描述](../Images/e42818064601bf1f1d85da5701acf7d8.png)

如果稍后检测到猜测错误，则丢弃部分执行的指令，流水线从正确的分支重新开始，从而产生延迟。在分支错误预测的情况下浪费的时间等于管道中从获取阶段到执行阶段的阶段数。现代微处理器往往具有相当长的流水线，因此误预测延迟在 10 到 20 个时钟周期之间。管道越长，对好的[分支预测器](https://en.wikipedia.org/wiki/Branch_predictor)的需求就越大。

在OP的代码中，第一次有条件的时候，分支预测器没有任何信息来预测，所以第一次它会随机选择下一条指令。稍后在 for 循环中，它可以根据历史记录进行预测。对于按升序排序的数组，有三种可能：

1.  所有元素都小于 128
2.  所有元素都大于 128
3.  一些开始的新元素小于 128，后来它变得大于 128

让我们假设预测器在第一次运行时总是假设真正的分支。

所以在第一种情况下，它总是会选择真正的分支，因为历史上它的所有预测都是正确的。在第二种情况下，最初它会预测错误，但经过几次迭代后，它会正确预测。在第三种情况下，它最初会正确预测，直到元素小于 128。之后它会失败一段时间，当它在历史上看到分支预测失败时会自行纠正。

在所有这些情况下，失败的数量都会太少，因此，只有几次它需要丢弃部分执行的指令并从正确的分支重新开始，从而减少 CPU 周期。

但是在随机未排序数组的情况下，预测将需要丢弃部分执行的指令并在大多数情况下从正确的分支重新开始，并且与排序数组相比会导致更多的 CPU 周期。

* * *

## 回答 #11

> 赞同：827
> 
> 时间：2015-10-11T21:05:18.123

官方答案将来自

1.  [英特尔 - 避免分支错误预测的成本](https://software.intel.com/en-us/articles/avoiding-the-cost-of-branch-misprediction)
2.  [英特尔 - 分支和循环重组以防止错误预测](https://software.intel.com/en-us/articles/branch-and-loop-reorganization-to-prevent-mispredicts)
3.  [科学论文——分支预测计算机架构](https://scholar.google.com/scholar?q=branch%20prediction%20computer%20architecture&hl=da&as_sdt=0&as_vis=1&oi=scholart)
4.  书籍：JL Hennessy、DA Patterson：计算机体系结构：定量方法
5.  科学出版物中的文章：TY Yeh、YN Patt 在分支预测方面做了很多这样的文章。

您还可以从这个可爱的[图表](https://en.wikipedia.org/wiki/Branch_predictor#/media/File:Branch_prediction_2bit_saturating_counter-dia.svg)中看到为什么分支预测器会混淆。

[![2位状态图](../Images/319171ab82c68f0f8b08c3c451ff83ff.png)](https://i.stack.imgur.com/pBMV2.png)

原始代码中的每个元素都是一个随机值

```
data[c] = std::rand() % 256; 
```

所以预测器会随着`std::rand()`打击而改变方向。

另一方面，一旦排序后，预测器将首先进入强不采用状态，当值变为高值时，预测器将在三个运行中从强烈不采用到强烈采用变化。

* * *

* * *

## 回答 #12

> 赞同：797
> 
> 时间：2015-09-23T14:57:47.163

在同一行中（我认为任何答案都没有强调这一点）很高兴提到有时（特别是在性能很重要的软件中——比如在 Linux 内核中）你可以找到一些 if 语句，如下所示：

```
if (likely( everything_is_ok ))
{
    /* Do something */
} 
```

或类似地：

```
if (unlikely(very_improbable_condition))
{
    /* Do something */    
} 
```

两者实际上都是使用 GCC 之类的东西定义的宏，`likely()`以帮助编译器插入预测代码以支持考虑用户提供的信息的条件。GCC 支持其他可以改变正在运行的程序的行为或发出低级指令（如清除缓存等）的内置指令。请参阅[此文档](https://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html)，了解可用的 GCC 内置指令。`unlikely()``__builtin_expect`

通常这种优化主要出现在执行时间很重要且至关重要的硬实时应用程序或嵌入式系统中。例如，如果您正在检查仅发生 1/10000000 次的错误情况，那么为什么不通知编译器呢？这样，默认情况下，分支预测会假设条件为假。

* * *

## 回答 #13

> 赞同：781
> 
> 时间：2015-10-10T00:30:42.687

C++ 中常用的布尔运算在编译后的程序中产生许多分支。如果这些分支在循环内部并且难以预测，它们会显着减慢执行速度。布尔变量存储为 8 位整数，其值为`0`for`false`和`1`for `true`。

布尔变量在某种意义上是超定的，即所有将布尔变量作为输入的运算符都会检查输入是否具有除`0`or之外的任何其他值`1`，但将布尔变量作为输出的运算符不能产生除`0`or之外的任何其他值`1`。这使得以布尔变量作为输入的操作比必要的效率低。考虑示例：

```
bool a, b, c, d;
c = a && b;
d = a || b; 
```

这通常由编译器通过以下方式实现：

```
bool a, b, c, d;
if (a != 0) {
    if (b != 0) {
        c = 1;
    }
    else {
        goto CFALSE;
    }
}
else {
    CFALSE:
    c = 0;
}
if (a == 0) {
    if (b == 0) {
        d = 0;
    }
    else {
        goto DTRUE;
    }
}
else {
    DTRUE:
    d = 1;
} 
```

这段代码远非最佳。如果发生错误预测，分支可能需要很长时间。`0`如果可以肯定地知道操作数除了和之外没有其他值，则布尔运算可以变得更加高效`1`。编译器不做这种假设的原因是，如果变量未初始化或来自未知来源，它们可能具有其他值。`a`如果并且`b`已经初始化为有效值，或者它们来自产生布尔输出的运算符，则可以优化上述代码。优化后的代码如下所示：

```
char a = 0, b = 1, c, d;
c = a & b;
d = a | b; 
```

`char`用于代替，`bool`以便可以使用按位运算符 ( `&`and `|`) 代替布尔运算符 ( `&&`and `||`)。位运算符是只占用一个时钟周期的单条指令。OR 运算符 ( `|`) 即使`a`并且具有除or`b`以外的其他值也可以工作。如果操作数具有除and以外的其他值，AND 运算符 ( ) 和 EXCLUSIVE OR 运算符 ( ) 可能会给出不一致的结果。`0``1``&``^``0``1`

`~`不能用于 NOT。相反，您可以在已知为的变量上创建布尔值 NOT`0`或`1`通过对它进行 XOR 运算`1`：

```
bool a, b;
b = !a; 
```

可以优化为：

```
char a = 0, b;
b = a ^ 1; 
```

`a && b`不能替换为`a & b`if `b`is 一个不应该被评估的表达式 if `a`is `false`( `&&`will not evaluate `b`, `&`will)。同样，`a || b`不能替换为`a | b`if `b`is 一个不应评估 if is 的`a`表达式`true`。

如果操作数是变量，则使用位运算符比操作数是比较时更有利：

```
bool a; double x, y, z;
a = x > y && z < 5.0; 
```

在大多数情况下是最优的（除非您希望`&&`表达式产生许多分支错误预测）。

* * *

## 回答 #14

> 赞同：435
> 
> 时间：2017-06-18T11:40:43.007

这是肯定的！...

**由于代码中发生的切换，**分支预测使逻辑运行速度变慢！**这就像你要走一条笔直的街道或一条有很多转弯的街道，肯定会更快地完成笔直的！...**

 **如果数组已排序，则您的条件在第一步为 false: `data[c] >= 128`，然后在到街道尽头的整个过程中变为真值。这就是你如何更快地到达逻辑的结尾。另一方面，使用未排序的数组，您需要大量的转动和处理，这肯定会使您的代码运行速度变慢......

看看我在下面为你创建的图像。哪条街会更快完工？

[![分支预测](../Images/831871ebfdc0b1141059607965b2c0d2.png)](https://i.stack.imgur.com/cSmCa.jpg)

所以以编程方式，**分支预测**会导致过程变慢......

最后，很高兴知道我们有两种分支预测，每种都会以不同的方式影响您的代码：

**1.静态**

**2.动态**

[![分支预测](../Images/f2c1e991069968c74a62ef158648e8ae.png)](https://i.stack.imgur.com/ZfhDu.jpg)

> 微处理器第一次遇到条件分支时使用静态分支预测，而动态分支预测用于条件分支代码的后续执行。
> 
> 为了有效地编写代码以利用这些规则，在编写**if-else**或**switch**语句时，首先检查最常见的情况，然后逐步降低到最不常见的情况。对于静态分支预测，循环不一定需要任何特殊的代码排序，因为通常只使用循环迭代器的条件。

* * *

## 回答 #15

> 赞同：399
> 
> 时间：2017-01-12T01:50:28.280

这个问题已经被很好地回答了很多次了。我仍然想提请小组注意另一个有趣的分析。

最近这个例子（稍微修改了一点）也被用来演示如何在 Windows 上的程序本身中分析一段代码。在此过程中，作者还展示了如何使用结果来确定代码在排序和未排序情况下大部分时间花费在哪里。最后，这篇文章还展示了如何使用 HAL（硬件抽象层）的一个鲜为人知的特性来确定在未排序的情况下发生了多少分支错误预测。

链接在这里： [**自我分析的演示**](//www.geoffchappell.com/studies/windows/km/ntoskrnl/api/ex/profile/demo.htm)

* * *

## 回答 #16

> 赞同：361
> 
> 时间：2017-11-06T16:15:16.070

正如其他人已经提到的，神秘的背后是[分支预测器](https://en.wikipedia.org/wiki/Branch_predictor)。

我不是想添加一些东西，而是以另一种方式解释这个概念。wiki 上有一个简明的介绍，其中包含文本和图表。我喜欢下面的解释，它使用图表直观地阐述分支预测器。

> 在计算机体系结构中，分支预测器是一个数字电路，它试图猜测分支（例如 if-then-else 结构）在确定之前会走哪条路。分支预测器的目的是改善指令流水线中的流程。分支预测器在许多现代流水线微处理器架构（如 x86）中实现高效性能方面发挥着关键作用。
> 
> 双向分支通常使用条件跳转指令来实现。条件跳转可以“不执行”并继续执行条件跳转后紧跟的第一个代码分支，也可以“执行”并跳转到程序内存中第二个代码分支所在的不同位置存储。在计算出条件并且条件跳转已经通过指令流水线中的执行阶段之前，是否会进行条件跳转是不确定的（见图 1）。

[![图1](../Images/658fa8fa08a28223dc7243aa75f7b388.png)](https://i.stack.imgur.com/unxnb.png)

基于所描述的场景，我编写了一个动画演示来展示指令在不同情况下如何在管道中执行。

1.  没有分支预测器。

> 如果没有分支预测，处理器将不得不等到条件跳转指令通过执行阶段，然后下一条指令才能进入流水线中的取指阶段。

该示例包含三个指令，第一个是条件跳转指令。后两条指令可以进入流水线，直到条件跳转指令执行完毕。

[![没有分支预测器](../Images/19f33bab1d83a03a015da5fa1b0f2397.png)](https://i.stack.imgur.com/GMFQ6.gif)

完成 3 条指令需要 9 个时钟周期。

2.  使用分支预测器，不要进行条件跳转。让我们假设预测**没有**进行条件跳转。

[![在此处输入图像描述](../Images/34d7707bb6bb6fff395659dd5d9f80d2.png)](https://i.stack.imgur.com/Ms5p1.gif)

完成 3 条指令需要 7 个时钟周期。

3.  使用分支预测器并进行条件跳转。让我们假设预测**没有**进行条件跳转。

[![在此处输入图像描述](../Images/a8ccd2c845da02bdeb3a4d8e543ad0f0.png)](https://i.stack.imgur.com/HIpG3.gif)

完成 3 条指令需要 9 个时钟周期。

> 在分支错误预测的情况下浪费的时间等于管道中从获取阶段到执行阶段的阶段数。现代微处理器往往具有相当长的流水线，因此误预测延迟在 10 到 20 个时钟周期之间。因此，使管道更长会增加对更高级分支预测器的需求。

如您所见，我们似乎没有理由不使用 Branch Predictor。

这是一个非常简单的演示，阐明了分支预测器的基本部分。如果这些 gif 令人讨厌，请随时从答案中删除它们，访问者还可以从[BranchPredictorDemo获取现场演示源代码](https://github.com/Eugene-Mark/BranchPredictorDemo)

* * *

## 回答 #17

> 赞同：275
> 
> 时间：2017-08-04T10:07:12.513

**分支预测增益！**

重要的是要了解分支错误预测不会减慢程序的速度。错过预测的代价就像不存在分支预测一样，您等待表达式的评估来决定运行什么代码（下一段中的进一步说明）。

```
if (expression)
{
    // Run 1
} else {
    // Run 2
} 
```

只要有`if-else`\`switch`语句，就必须计算表达式以确定应该执行哪个块。在编译器生成的汇编代码中，插入了条件[分支](https://en.wikipedia.org/wiki/Branch_(computer_science))指令。

分支指令可能导致计算机开始执行不同的指令序列，从而偏离其按顺序执行指令的默认行为（即，如果表达式为假，则程序跳过`if`块的代码），具体取决于某些条件，即我们案例中的表达式评估。

话虽如此，编译器会在实际评估结果之前尝试预测结果。它将从`if`块中获取指令，如果表达式为真，那就太好了！我们获得了评估它所需的时间，并在代码中取得了进展；如果不是，那么我们运行了错误的代码，刷新了管道，运行了正确的块。

### 可视化：

假设您需要选择路线 1 或路线 2。等待您的伙伴查看地图，您已在 ## 停下来等待，或者您可以选择路线 1，如果幸运的话（路线 1 是正确的路线），那么太好了，您不必等待您的搭档检查地图（您节省了他检查地图的时间），否则您只会折返。

虽然冲洗管道的速度非常快，但如今赌一把是值得的。预测排序数据或变化缓慢的数据总是比预测快速变化更容易和更好。

```
 O      Route 1  /-------------------------------
/|\             /
 |  ---------##/
/ \            \
                \
        Route 2  \-------------------------------- 
```

* * *

## 回答 #18

> 赞同：238
> 
> 时间：2017-12-22T13:13:05.870

在 ARM 上，不需要分支，因为每条指令都有一个 4 位条件字段，它测试（以零成本）处理器状态寄存器中可能出现的[16 种不同不同条件](https://community.arm.com/developer/ip-products/processors/b/processors-ip-blog/posts/condition-codes-1-condition-flags-and-codes)中的任何一种，以及指令上的条件是否为false，该指令被跳过。这消除了对短分支的需要，并且该算法不会有分支预测命中。**因此，由于排序的额外开销，该算法的排序版本将比 ARM 上的未排序版本运行得更慢。**

该算法的内部循环在 ARM 汇编语言中类似于以下内容：

```
MOV R0, #0   // R0 = sum = 0
MOV R1, #0   // R1 = c = 0
ADR R2, data // R2 = addr of data array (put this instruction outside outer loop)
.inner_loop  // Inner loop branch label
    LDRB R3, [R2, R1]   // R3 = data[c]
    CMP R3, #128        // compare R3 to 128
    ADDGE R0, R0, R3    // if R3 >= 128, then sum += data[c] -- no branch needed!
    ADD R1, R1, #1      // c++
    CMP R1, #arraySize  // compare c to arraySize
    BLT inner_loop      // Branch to inner_loop if c < arraySize 
```

***但这实际上是更大图景的一部分：***

`CMP`操作码总是更新处理器状态寄存器 (PSR) 中的状态位，因为这是它们的目的，但大多数其他指令不会触及 PSR，除非您`S`在指令中添加可选后缀，指定 PSR 应根据指令的结果。**就像 4 位条件后缀一样，能够在不影响 PSR 的情况下执行指令是一种减少 ARM 上分支需求的机制，同时也便于在硬件层面进行乱序调度**，因为在执行一些操作 X 后会更新状态位，随后（或并行）您可以做一堆明确不应该影响（或受其影响）状态位的其他工作，然后您可以测试 X 之前设置的状态位的状态。

条件测试字段和可选的“设置状态位”字段可以组合，例如：

*   `ADD R1, R2, R3`执行`R1 = R2 + R3`而不更新任何状态位。
*   `ADDGE R1, R2, R3`仅当影响状态位的先前指令导致大于或等于条件时才执行相同的操作。
*   `ADDS R1, R2, R3`执行加法，然后根据结果是负数、零、进位（无符号加法）或溢出（有符号加法）更新处理器状态寄存器中的`N`、`Z`和标志。`C``V`
*   `ADDSGE R1, R2, R3`仅当测试为真时才执行加法`GE`，然后根据加法结果更新状态位。

大多数处理器架构没有这种能力来指定是否应该为给定操作更新状态位，这可能需要编写额外的代码来保存和稍后恢复状态位，或者可能需要额外的分支，或者可能会限制处理器的输出顺序执行效率：大多数 CPU 指令集架构在大多数指令之后强制更新状态位的副作用之一是，很难区分哪些指令可以并行运行而不会相互干扰。更新状态位有副作用，因此对代码有线性化影响。**ARM 在任何指令上混合和匹配无分支条件测试以及在任何指令之后更新或不更新状态位的选项的能力对于汇编语言程序员和编译器来说都非常强大，并且可以生成非常高效的代码。**

当您不必分支时，您可以避免因短分支而刷新管道的时间成本，并且可以避免多种形式的推测评估的设计复杂性。许多最近发现的处理器漏洞（Spectre 等）的缓解措施的初始简单实施对性能的影响向您展示了现代处理器的性能在多大程度上取决于复杂的推测评估逻辑。凭借较短的流水线和大幅减少的分支需求，ARM 不需要像 CISC 处理器那样依赖推测评估。（当然，高端 ARM 实现确实包括推测性评估，但它只是性能故事的一小部分。）

如果您曾经想知道为什么 ARM 取得了如此惊人的成功，那么这两种机制的出色效率和相互作用（与另一种机制相结合，可以让您向左或向右“桶移”任何算术运算符或偏移内存访问的两个参数之一）零额外成本的运营商）是故事的重要组成部分，因为它们是 ARM 架构效率的一些最大来源。早在 1983 年，ARM ISA 的原始设计师 Steve Furber 和 Roger（现为 Sophie）Wilson 的才华怎么强调都不为过。

* * *

## 回答 #19

> 赞同：214
> 
> 时间：2017-10-03T09:47:54.423

这是关于分支预测的。它是什么？

*   分支预测器是一种古老的性能改进技术，它仍然在现代架构中找到相关性。虽然简单的预测技术提供了快速查找和功率效率，但它们的误预测率很高。

*   另一方面，复杂的分支预测——无论是基于神经的还是两级分支预测的变体——提供了更好的预测精度，但它们消耗更多的能量并且复杂度呈指数级增长。

*   除此之外，在复杂的预测技术中，预测分支所花费的时间本身就非常高——从 2 到 5 个周期不等——这与实际分支的执行时间相当。

*   分支预测本质上是一个优化（最小化）问题，其重点在于以最少的资源实现尽可能低的未命中率、低功耗和低复杂度。

实际上有三种不同的分支：

**前向条件分支**- 基于运行时条件，PC（程序计数器）更改为指向指令流中的前向地址。

**向后条件分支**- PC 更改为在指令流中向后指向。分支基于某些条件，例如当循环结束时的测试表明循环应该再次执行时，向后分支到程序循环的开头。

**无条件分支**- 这包括没有特定条件的跳转、过程调用和返回。例如，一个无条件跳转指令在汇编语言中可能被简单地编码为“jmp”，并且指令流必须立即被定向到跳转指令指向的目标位置，而可能被编码为“jmpne”的条件跳转仅当先前“比较”指令中两个值的比较结果显示值不相等时，才会重定向指令流。（x86 架构使用的分段寻址方案增加了额外的复杂性，因为跳转可以是“近”（段内）或“远”（段外）。每种类型对分支预测算法都有不同的影响。）

**静态/动态分支预测**：微处理器第一次遇到条件分支时使用静态分支预测，而动态分支预测用于条件分支代码的后续执行。

参考：

*   *[分支预测器](//en.wikipedia.org/wiki/Branch_predictor)*

*   *[自我剖析的示范](//www.geoffchappell.com/studies/windows/km/ntoskrnl/api/ex/profile/demo.htm)*

*   *[分支预测回顾](//courses.cs.washington.edu/courses/csep548/06au/lectures/branchPred.pdf)*

*   *[分支预测](https://web.archive.org/web/20190601170841/https://web.njit.edu/%7Erlopes/Mod5.3.pdf)（使用回路机）*

* * *

## 回答 #20

> 赞同：205
> 
> 时间：2017-11-23T14:28:29.353

除了分支预测可能会减慢您的速度之外，排序数组还有另一个优点：

您可以有一个停止条件，而不仅仅是检查值，这样您就只循环相关数据，而忽略其余数据。
分支预测只会错过一次。

```
 // sort backwards (higher values first), may be in some other part of the code
 std::sort(data, data + arraySize, std::greater<int>());

 for (unsigned c = 0; c < arraySize; ++c) {
       if (data[c] < 128) {
              break;
       }
       sum += data[c];               
 } 
```

* * *

## 回答 #21

> 赞同：188
> 
> 时间：2017-12-07T17:28:29.557

由于称为分支预测的现象，排序数组的处理速度比未排序数组快。

分支预测器是一个数字电路（在计算机体系结构中），试图预测分支将走向哪条路，从而改善指令流水线中的流程。电路/计算机预测下一步并执行它。

做出错误的预测会导致返回上一步，并执行另一个预测。假设预测正确，代码将继续执行下一步。错误的预测会导致重复相同的步骤，直到发生正确的预测。

你的问题的答案很简单。

在未排序的数组中，计算机会做出多个预测，从而导致出错的机会增加。而在排序数组中，计算机做出的预测更少，从而减少了出错的机会。做出更多预测需要更多时间。

排序数组：直路

```
____________________________________________________________________________________
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT 
```

未排序的数组：弯曲的道路

```
______   ________
|     |__| 
```

分支预测：猜测/预测哪条路是直的，并在不检查的情况下跟随它

```
___________________________________________ Straight road
 |_________________________________________|Longer road 
```

虽然两条路都到达同一个目的地，但笔直的路较短，而另一条路较长。如果那时你选错了，那就没有回头路了，如果你选择更长的路，你会浪费一些额外的时间。这类似于计算机中发生的情况，我希望这有助于您更好地理解。

* * *

我还想从评论中引用[@Simon_Weaver](/u/16940)：

> 它不会做出更少的预测——它会做出更少的错误预测。它仍然必须通过循环预测每次......

* * *

## 回答 #22

> 赞同：173
> 
> 时间：2012-12-30T16:16:46.597

我在 MacBook Pro（Intel i7，64 位，2.4 GHz）上使用 MATLAB 2011b 对以下 MATLAB 代码尝试了相同的代码：

```
% Processing time with Sorted data vs unsorted data
%==========================================================================
% Generate data
arraySize = 32768
sum = 0;
% Generate random integer data from range 0 to 255
data = randi(256, arraySize, 1);

%Sort the data
data1= sort(data); % data1= data  when no sorting done

%Start a stopwatch timer to measure the execution time
tic;

for i=1:100000

    for j=1:arraySize

        if data1(j)>=128
            sum=sum + data1(j);
        end
    end
end

toc;

ExeTimeWithSorting = toc - tic; 
```

上述MATLAB代码的结果如下：

```
 a: Elapsed time (without sorting) = 3479.880861 seconds.
  b: Elapsed time (with sorting ) = 2377.873098 seconds. 
```

@GManNickG 中的 C 代码结果我得到：

```
 a: Elapsed time (without sorting) = 19.8761 sec.
  b: Elapsed time (with sorting ) = 7.37778 sec. 
```

基于此，看起来 MATLAB比没有排序的 C 实现慢了近*175 倍，而使用排序则慢了**350 倍*。换句话说，（分支预测的）效果对于 MATLAB 实现是*1.46*倍，对于 C 实现是*2.7 倍。*

* * *

## 回答 #23

> 赞同：110
> 
> 时间：2018-12-09T06:18:17.047

其他答案的假设需要对数据进行排序是不正确的。

以下代码不会对整个数组进行排序，而是仅对其中的 200 个元素段进行排序，因此运行速度最快。

仅对 k 元素部分进行排序会在线性时间内完成预处理`O(n)`，而不是`O(n.log(n))`对整个数组进行排序所需的时间。

```
#include <algorithm>
#include <ctime>
#include <iostream>

int main() {
    int data[32768]; const int l = sizeof data / sizeof data[0];

    for (unsigned c = 0; c < l; ++c)
        data[c] = std::rand() % 256;

    // sort 200-element segments, not the whole array
    for (unsigned c = 0; c + 200 <= l; c += 200)
        std::sort(&data[c], &data[c + 200]);

    clock_t start = clock();
    long long sum = 0;

    for (unsigned i = 0; i < 100000; ++i) {
        for (unsigned c = 0; c < sizeof data / sizeof(int); ++c) {
            if (data[c] >= 128)
                sum += data[c];
        }
    }

    std::cout << static_cast<double>(clock() - start) / CLOCKS_PER_SEC << std::endl;
    std::cout << "sum = " << sum << std::endl;
} 
```

这也“证明”了它与排序顺序等任何算法问题无关，确实是分支预测。

* * *

## 回答 #24

> 赞同：96
> 
> 时间：2019-10-14T23:34:40.167

* * *

## 回答 #25

> 赞同：87
> 
> 时间：2019-10-23T21:35:40.250

This question is rooted in *branch prediction models* on CPUs. I'd recommend reading this paper:

[**Increasing the Instruction Fetch Rate via Multiple Branch Prediction and a Branch Address Cache**](https://pdfs.semanticscholar.org/5634/4be375cfed0f79cb9d009ac838682e1bace3.pdf)

When you have sorted elements, the [IR](https://en.wikipedia.org/wiki/Instruction_register) can not be bothered to fetch all CPU instructions, again and again. It fetches them from the cache.

* * *

## 回答 #26

> 赞同：23
> 
> 时间：2021-04-14T08:08:30.667

**[BRANCH PREDICTION](https://www.computerhope.com/jargon/b/branch-prediction.htm#:%7E:text=Branch%20prediction%20is%20a%20technique,architectures%2C%20such%20as%20the%20x86.)**

This is called **branch prediction**. Without branch prediction, the processor would have to wait until the conditional jump instruction has passed the execute stage before the next instruction can enter the fetch stage in the pipeline. The branch predictor attempts to avoid this waste of time by trying to guess whether the conditional jump is most likely to be taken or not taken. The branch that is guessed to be the most likely is then fetched and speculatively executed. If it is later detected that the guess was wrong, then the speculatively executed, incurring a delay.

```
data[c] >= 128 
```

Take more help from this link: [Multiple Branch Prediction for Wide-Issue Superscalar](https://www.semanticscholar.org/paper/Multiple-Branch-Prediction-for-Wide-Issue-Hwang-Chen/432c5b138f2c14a9e625fc11e6fd2fcc053707bd)

* * *

## 回答 #27

> 赞同：17
> 
> 时间：2021-11-05T10:05:03.933

*An answer for quick and simple understanding (read the others for more details)*

This concept is called **branch prediction**

Branch prediction is an optimization technique that predicts the path the code will take before it is known with certainty. This is important because during the code execution, the machine prefetches several code statements and stores them in the pipeline.

The problem arises in conditional branching, where there are two possible paths or parts of the code that can be executed.

When the prediction was true, the optimization technique worked out.

When the prediction was false, to explain it in a simple way, the code statement stored in the pipeline gets proved wrong ant the actual code has to be completely reloaded, which takes up a lot of time.

As common sense suggests, predictions of something sorted are way more accurate than predictions of something unsorted.

branch prediction visualisation:

sorted
[![sorted](../Images/337c6522eb8685b57d7dc65c8e0d832e.png)](https://i.stack.imgur.com/BhphM.png) unsorted [![unsorted](../Images/9937dd6d3eee5d9c8fceb0ee211d24db.png)](https://i.stack.imgur.com/2Z7Ct.png)

* * *

## 回答 #28

> 赞同：8
> 
> 时间：2021-10-26T09:25:28.920

## Why is processing a sorted array faster than processing an unsorted array?

**Example from the code:**

```
// CPP program to demonstrate processing
// time of sorted and unsorted array
#include <iostream>
#include <algorithm>
#include <ctime>
using namespace std;

const int N = 100001;

int main()
{
    int arr[N];

    // Assign random values to array
    for (int i=0; i<N; i++)
        arr[i] = rand()%N;

    // for loop for unsorted array
    int count = 0;
    double start = clock();
    for (int i=0; i<N; i++)
        if (arr[i] < N/2)
            count++;

    double end = clock();
    cout << "Time for unsorted array :: "
        << ((end - start)/CLOCKS_PER_SEC)
        << endl;
    sort(arr, arr+N);

    // for loop for sorted array
    count = 0;
    start = clock();

    for (int i=0; i<N; i++)
        if (arr[i] < N/2)
            count++;

    end = clock();
    cout << "Time for sorted array :: "
        << ((end - start)/CLOCKS_PER_SEC)
        << endl;

    return 0;
} 
```

**Execution Timing:**

[![timing of execution](../Images/4895ee90942909f52464c3d164df35bd.png)](https://i.stack.imgur.com/9kOtq.png)

**Conclusion:**

Observe that time taken for processing a sorted array is less as compared to an unsorted array. The reason for this optimization for the sorted arrays is branch prediction.

**What is branch prediction?**

Branch prediction in computer architecture focuses on determining whether a conditional branch (jump) in a program's instructions pipeline is likely to be taken or not. Because they must guess the address field to fetch before the current instruction is executed, all pipelined processors do branch prediction in some manner.

**How is branch prediction inapplicable on the above case ?**

The if condition checks that arr[i] < 5000, but if you observe in case of a sorted array, after passing the number 5000 the condition is always false, and before that, it is always true. The CPU will recognize that pattern and be able to predict correctly which instruction to execute next after the conditional branch, instead of sometimes having to rewind after guessing wrong.

**Working Of Branch Prediction Algorithm:**

Branch prediction works on the pattern the algorithm is following or basically the history, how it got executed in previous steps. If the guess is correct, then CPU continues executing and if it goes wrong, then the CPU needs to flush the pipeline and roll back to the branch and restart from the beginning.****

# c++ - 如何以更有效的方式在 C++ 中创建文件夹？

> ID：11227814
> 
> 赞同：1
> 
> 时间：2012-06-27T13:52:00.227
> 
> 标签：c++, directory

在我的 C++ 项目中，我提供了一个选项来备份为存储记录而创建的文件，该选项通过在该目录中创建一个文件夹来备份用户给定路径中的文件。相同的代码如下：

```
void backup()
{
 char a[40],c[40],b[40];
 product p1;
 clrscr();
 ifstream fp1("products.dat", ios::binary);
 ifstream fp2("purchase.dat",ios::binary);
 ifstream fp3("sales.dat",ios::binary);
 if(fp1==NULL || fp2==NULL || fp3==NULL)
 {
  cout<<"\n\tError-No or Incomplete Database...";
 }
 else
 {
  cout<<d_line;
  cout<<"\t\t\t       Database backup";
  cout<<"\n\t\t\t       -------- ------";
  cout<<line;
  cout<<"\n\tEnter the Directory in which you want to create backup:";
  gets(a);
  strcpy(b,a);
  strcpy(c,a);
  strcat(a,"/backup_b");
  strcat(b,"/backup_b");
  strcat(c,"/backup_b");
  mkdir(a);
  strcat(a,"/products.dat");
  strcat(b,"/purchase.dat");
  strcat(c,"/sales.dat");
  ofstream fp1_t(a, ios::binary | ios::trunc);
  ofstream fp2_t(b, ios::binary | ios::trunc);
  ofstream fp3_t(c, ios::binary | ios::trunc);

  if(fp1_t==NULL || fp2_t==NULL ||fp3_t==NULL)
  {
   cout<<"\n\n\tError During creating backup...\n";
  }
  else
  {
   while(!fp1.eof())
   {
    fp1.read((char *) &p1,sizeof(struct product));
    if(fp1.fail())
    {
     break;
    }
    else
    {
     fp1_t.write((char *) &p1,sizeof(struct product));
    }
   }
   while(!fp2.eof())
   {
    fp2.read((char *) &p1,sizeof(struct product));
    if(fp2.fail())
    {
     break;
    }
    else
    {
     fp2_t.write((char *) &p1,sizeof(struct product));
    }
   }
   while(!fp3.eof())
   {
    fp3.read((char *) &p1,sizeof(struct product));
    if(fp3.fail())
    {
     break;
    }
    else
    {
     fp3_t.write((char *) &p1,sizeof(struct product));
    }
   }
   fp1_t.close();
   fp2_t.close();
   fp3_t.close();
  }
  fp1.close();
  fp2.close();
  fp3.close();
  cout<<line;
  cout<<"\n\tBackup Created Successfully...";
 }
 cout<<line<<conti;
 getch();
} 
```

**我想知道，在 C++ 中创建文件夹是否有比我正在做的更有效的方法？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T14:28:44.820

好吧，当然还有更多独立于平台的方法，以及更多类型安全的方法。尝试[提升文件系统](http://www.boost.org/doc/libs/1_49_0/libs/filesystem/v3/doc/index.htm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T14:02:42.990

如果您使用的是 Windows，那么`CreateDirectory`是最简单的选择。这是一个例子：

```
#include "Windows.h"
...
    CreateDirectory("C:\\temp\\sampledir", NULL);
... 
```

它是 Windows API 的一部分，记录在这里：[MSDN entry for CreateDirectory function](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363855%28v=vs.85%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-24T15:38:23.017

我总是使用以下函数来创建文件夹。我使用它是因为，一方面，我不想使用任何 3rd-party 库，例如`boost`; 同时，仅仅调用 WIN32 API`CreateDirectory()`是不够聪明的，它可以让我们创建一个目录，但它只有在父目录已经存在时才有效。这个功能克服了这个限制。例如，它可以`test`通过传入'./subfolder/test'来创建一个文件夹，即使文件夹`subfolder`不存在。此外，如果文件夹已经存在，则不受影响，但如果不存在，则创建它。

```
void create_directory(char* Path)
{
    char DirName[256];
    char* p = Path;
    char* q = DirName;  

    while(*p)
    {
        if (('\\' == *p) || ('/' == *p))
        {
            if (':' != *(p-1))
            {
                CreateDirectory(DirName, NULL);
            }
        }
        *q++ = *p++;
        *q = '\0';
    }
    CreateDirectory(DirName, NULL);
} 
```

# ruby - Ruby 中的 0..size 和 0...size 有什么区别？

> ID：11227815
> 
> 赞同：1
> 
> 时间：2012-06-27T13:52:00.757
> 
> 标签：ruby

我正在阅读一些 ruby​​ 代码，并查看`0..size`并`0...size`在类似情况下使用。

有什么区别，还是它们只是相同的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T13:54:08.857

其实很简单。`..`包括范围内的结束值（`2..5`2,3,4,5 也是如此）并`...`排除它（`2..5`2,3,4 也是如此）。仅此而已。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T13:54:30.397

`..`（两个点）表示 ju 想要一个包含范围。`...`（三个点）表示您想要一个范围但省略最后一个元素。例子：

`0..5`返回`0, 1, 2, 3, 4, 5`

`0...5`返回`0, 1, 2, 3, 4`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T13:55:05.377

`..`创建一个 inclusive `Range`，`...`创建一个 Range 对象，其中排除了右限制。

```
(0..5).to_a
# => [0, 1, 2, 3, 4, 5] 

(0...5).to_a
# => [0, 1, 2, 3, 4] 
```

# git - Git 在一个简单的情况下无法合并，但运行我的合并工具显示没有冲突

> ID：11227820
> 
> 赞同：0
> 
> 时间：2012-06-27T13:52:10.287
> 
> 标签：git, version-control, merge, versioning

Git 在一个简单的情况下无法合并，但运行我的合并工具不会显示任何冲突，并且仅关闭合并工具会产生正确的合并结果。

我正在使用 git 版本 1.7.10.msysgit.1 并且我在合并时遇到了这个奇怪的问题。

我有一个包含“123”的文件，然后分支 A 和分支 B 都是从文件的上述版本生成的。

在分支 B 我将“新行”添加到文件的第 2 行以获得“123 新行”

然后在分支 B 我将“123”更改为“12345”

在分支 A 上，我选择了 B 的更改，添加了“新行”

在分支 A 上，我与 B 合并，当我在文本编辑器中打开文件时出现“123”“12345”冲突，但如果我启动合并工具，不做任何更改并关闭它，冲突会自动解决，我可以继续。

我想知道的是，当没有人触及分支 A 的第一行时，为什么 git 会认为文件的第一行存在冲突。

有没有办法让 git 在这些情况下自动合并而不打扰我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:56:25.060

这是因为您选择了从 B 到 A 的更改。这实质上是“复制”了修改该行的提交。现在，在两个分支的共同祖先之后，两个不同的提交修改了同一行。因此，git 无法知道哪个提交是您想要的正确提交，因此它表明存在冲突让您选择。

# javascript - Facebook Flash AS3 应用程序 - swc 不起作用

> ID：11227827
> 
> 赞同：0
> 
> 时间：2012-06-27T13:52:31.957
> 
> 标签：javascript, facebook, actionscript-3, flash

我已经下载了[GraphAPI_Web_1_8_1.swc](http://code.google.com/p/facebook-actionscript-api/downloads/detail?name=GraphAPI_Web_1_8_1.swc)并发现它不能按预期工作。

```
 Facebook.init("APP_CODE",handler); 
```

例如处理程序，永远不会被调用。

我的目标是开发一个没有 Javascript“助手”的 AS3 应用程序。那可能吗？我在哪里可以找到一些资源让我开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T17:22:00.677

Facebook ActionScript SDK 的 Web 实现建立在 JavaScript SDK 之上。查看[Adob​​e 教程](http://www.adobe.com/devnet/facebook/articles/flex_fbgraph_pt3.html)，了解如何设置嵌入 SWF 的网页。

# html - 应用线性渐变时伪选择器不起作用

> ID：11227831
> 
> 赞同：0
> 
> 时间：2012-06-27T13:52:47.823
> 
> 标签：html, css

我正在使用简单的伪选择器 css 功能。当我将鼠标悬停在表格单元格上时，它们会改变背景颜色，很简单。但是当表格单元格的原始背景颜色是线性渐变时， td:hover 不再起作用。这是我的代码：

CSS：

```
#rightDiv td{
    font-size: 18px;
    color: #ffffff;
    padding: 10px 5px;  
    /*background: rgba(0,0,0,0.7);*/
    background: -moz-linear-gradient(top, rgba(55,160,252,1) 0%, rgba(8,126,216,1) 46%, rgba(28,97,175,1) 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(55,160,252,1)), color-stop(46%,rgba(8,126,216,1)), color-stop(100%,rgba(28,97,175,1))); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top, rgba(55,160,252,1) 0%,rgba(8,126,216,1) 46%,rgba(28,97,175,1) 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top, rgba(55,160,252,1) 0%,rgba(8,126,216,1) 46%,rgba(28,97,175,1) 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top, rgba(55,160,252,1) 0%,rgba(8,126,216,1) 46%,rgba(28,97,175,1) 100%); /* IE10+ */
    background: linear-gradient(top, rgba(55,160,252,1) 0%,rgba(8,126,216,1) 46%,rgba(28,97,175,1) 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#37a0fc', endColorstr='#1c61af',GradientType=0 ); /* IE6-8 */
    border: 1px solid #444444;  
}

#rightDiv td:hover{
    color: #444444;
    background: rgba(255,255,255,0.4);
    border: 1px solid #999999;
    text-decoration: none;
}

#rightDiv a{
    color: #fff;
}

#rightDiv a:hover{
    color: #444444;
} 
```

HTML：

```
<div id="rightDiv">
    <table width="100%" height="100%">  
            <tr><td><a href="" target="_blank">Our Plans</a></td></tr>
            <tr><td><a href="" target="_blank">Our tariffs vs local mobile</a></td</tr>             
            <tr><td><a href="" target="_blank">Our service vs other VoIP</a></td></tr>          
            <tr><td><a href="" target="_blank">Our tariffs vs Skype</a></td></tr>                       
            <tr><td><a href="" target="_blank">Tariff lookup</a></td></tr>          
            <tr><td><a href="">Become an Agent/Franchisee</a></td></tr>           
    </table>
</div> 
```

关于为什么线性渐变会破坏我的伪类的任何建议？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T14:46:36.303

我在 JSFiddle 上进行了设置，似乎一切都按预期正常工作。[http://jsfiddle.net/syjcE/](http://jsfiddle.net/syjcE/)

我看到的唯一一件事是您将 td:hover 背景颜色设置为白色（背景：rgba(255,255,255,0.4);）。我所做的只是将背景颜色更改为实际颜色，以便您可以看到它正在工作。

如果我误解了这个问题，请告诉我。

# java - Spring Web Flow 转换未触发

> ID：11227837
> 
> 赞同：0
> 
> 时间：2012-06-27T13:53:03.430
> 
> 标签：java, spring, spring-webflow-2

我正在使用 Spring Web Flow 2，并且在让我的转换正确触发时遇到了一个基本问题。我在互联网上进行了大量搜索，但无法找到有关如何从视图侧触发转换的深入解释。我有两种状态：enterBookingDetails 和 reviewBooking。EnterBookingDetails 工作正常 - 页面正在加载，在提交事件时，reviewBooking 已加载。我的问题是，我无法从 reviewBooking 到工作的任何过渡。这是我所拥有的：

预订流程.xml：

```
<var name="bookingForm" class="com.mypackage.CarBookingForm"/>

<view-state id="enterBookingDetails" model="bookingForm">
    <transition on="submit" to="reviewBooking" />
</view-state>

<view-state id="reviewBooking" model="bookingForm">
    <transition on="confirm" to="bookingConfirmed" />
    <transition on="revise" to="enterBookingDetails" />
    <transition on="cancel" to="bookingCancelled" />
</view-state>

<end-state id="bookingConfirmed" />

<end-state id="bookingCancelled" /> 
```

进入BookingDetails.jsp（摘录）：

```
<form:form modelAttribute="bookingForm">
    Pickup: <form:input path="pickUpLocation"/><br />
    Dropoff: <form:input path="dropOffLocation"/><br />
    <input type="submit" name="_eventId_submit" value="Confirm"/>
    <input type="submit" name="_eventId_other" value="Other"/>
</form:form> 
```

reviewBooking.jsp（摘录）：

```
Pickup Loc: ${bookingForm.pickUpLocation}<br />
Dropoff Loc: ${bookingForm.dropOffLocation}<br />

<form>
    <input type="submit" name="_eventId_confirm" value="Confirm" />
    <input type="submit" name="_eventId_revise" value="Revise" />
    <button type="submit" name="_eventId_cancel">Cancel</button>
    <input type="hidden" name="_flowExecutionKey" value="${flowExecutionKey}" />
</form> 
```

当单击“reviewBooking”上的任何按钮时，用户将返回“enterBookingDetails”，没有填充任何表单数据。在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T21:18:41.233

好的，我发现了问题所在。所有的转换实际上都在触发。问题是这两个有问题的转换进入了结束状态，我没有意识到默认情况下这些转换结束了流程，然后重定向回第一页。

# ios - 调用 imageWithContentsOfFile 后 UIImage 为空

> ID：11227839
> 
> 赞同：0
> 
> 时间：2012-06-27T13:53:06.403
> 
> 标签：ios

![在此处输入图像描述](../Images/847dcfd330c9583a211aa4b4ba77ad5c.png) 如您所见，我已将国旗放在 Xcode 中的文件夹中，并试图将其显示到导航栏。但是，它没有出现，我发现：

`NSString *imageName = [NSString stringWithFormat:@"%@.icns",countryName]; UIImage *image = [UIImage imageWithContentsOfFile:imageName];`

图像是“零”。

任何的想法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:56:54.063

检查文件是否确实存在。我怀疑它没有。使用`[NSFileManager defaultManager] fileExistsAtPath:`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T13:57:33.017

你可以这样使用

```
 NSString *imageName = [NSString stringWithFormat:@"%@.icns",countryName];
 UIImage *image =  [UIImage imageNamed:imageName]; 
```

请试试这个

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T13:58:21.050

您将 NSString 发送到此处的图像路径在哪里

```
 UIImage imageWithContentsOfFile:imageName 
```

发送该方法的路径。或像这样

```
 UIImage *image = [UIImage imageNamed:[NSString stringwithFormat:@"%@.icns",countryName]]; 
```

# java - StringTemplate：如果条件为真，则增加值

> ID：11227844
> 
> 赞同：1
> 
> 时间：2012-06-27T13:53:26.950
> 
> 标签：java, stringtemplate, stringtemplate-4

我想知道 StringTemplate 是否有/支持数字的递增。
情况是：

**输入：**是一个具有“`isKey()`和`getName()`”吸气剂的对象数组。
输出应该是（`i=0; IF !obj.getKey() THEN ps.setObject(i++,obj.getName)) ENDIF`）：

```
ps.setObject(1,"Name");  
ps.setObject(2,"Name");  
ps.setObject(3,"Name");  
... 
```

**目前我有下一个 ST**：`<objs:{<if(it.key)><else>ps.setObject(<i>, <it.name;>);<"\n"><endif>}>`
如果第一个是关键，则输出：

```
ps.setObject(2,"Name");  
ps.setObject(3,"Name");  
ps.setObject(4,"Name");  
... 
```

现在问题我需要找到一种方法将“i”替换为仅在条件为真时才会增加的东西。

遇到此类问题的PLS建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:59:55.470

一般来说，为了响应 ST 获取状态而更改状态并不是一个好主意，因此在开始生成*之前，应该在模型中对非关键字段进行编号。*

为托管该属性`nonKeyIndex`的模型类添加一个 getter 。`name`遍历所有兄弟姐妹，并根据需要对它们进行编号（即从一个开始并跳过编号中的键）。现在您可以使用此 ST 生成所需的输出：

```
<objs:{<if(it.key)><else>ps.setObject(<it.nonKeyIndex>, <it.name;>);<"\n"><endif>}> 
```

有时可能无法将方法添加`nonKeyIndex`到模型类中。在这种情况下，您应该将您的类包装到专门设计用于使用字符串模板的视图类中，并在那里添加额外的属性：

```
public class ColumnView {
    private final Column c;
    private int nonKeyIdx;
    public ColumnView(Column c) {this.c = c;}
    public String getName() { return c.getName(); }
    public boolean getKey() { return c.getKey(); }
    public int getNonKeyIndex() { return nonKeyIdx; }
    public void setNonKeyIndex(int i) { nonKeyIdx = i; }
} 
```

# jquery - jQuery 模板引号

> ID：11227846
> 
> 赞同：0
> 
> 时间：2012-06-27T13:53:37.717
> 
> 标签：jquery, debugging, escaping, jquery-templates, string-interpolation

例如：

```
<span class="'"+${Status}+"'">${Name}</span> 
```

我正在尝试将我的 CSS 类设置为我正在显示其姓名的用户的状态。

上面的语法是错误的。

如何嵌入`${Status}`引号中的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-01T22:52:36.817

使用单引号分隔符：

```
 <span class='${Status}'>${Name}</span> 
```

# eclipse - eclipse中的Maven依赖问题

> ID：11227850
> 
> 赞同：3
> 
> 时间：2012-06-27T13:53:44.377
> 
> 标签：eclipse, maven, dependencies

我在 Eclipse 的工作区中打开了多个相关项目。其中一个项目对另一个项目的输出 jar 具有 Maven 依赖关系。在这个项目中，对依赖项中类的任何引用总是显示为红色（未识别），并且我没有看到代码完成或 javadoc 显示它们。如果我手动将 jar 添加到类路径，那么我不再有这个问题。问题是，我不想在每次修订更改时都手动添加 jar，这就是 Maven 的用途。关于如何解决这个问题的任何想法？这对我来说似乎是一个错误，但我不确定......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T10:54:02.010

执行此操作的正确方法如下：

*   确保安装`m2e`或`m2eclipse`（取决于您的 Eclipse 版本）：http: [//www.eclipse.org/m2e/](http://www.eclipse.org/m2e/)
*   仅使用 POM 文件中的依赖项部分，不要摆弄 Eclipse 项目引用。右键单击项目，然后选择*Maven > Update Project Configuration*将项目重置为 Maven 默认设置。这样，*m2e*就拥有依赖项的所有权。
*   如果您没有该选项，您可能需要启用项目以供 Maven 使用。右键单击项目，然后*Maven > Enable Workspace Resolution*或*Maven > Enable Dependency Management*。
*   确保所有引用的项目都在 Eclipse 中打开并启用了 Maven*特性*。
*   检查每个项目的 Maven 设置，确保*groupId*、*artifactId*和*version*与您在 Eclipse 中打开的项目匹配。因此，如果您依赖的项目在 Eclipse 中具有*1.0.0-SNAPSHOT*版本，请确保依赖项目的 POM 文件在*依赖项部分引用了**1.0.0-SNAPSHOT*版本。
**   为每个项目启用*工作区分辨率。*右键单击项目，然后*Maven > Enable Workspace Resolution*。*   最后，如果项目仍然没有解决，再次右键单击项目，然后*Maven > Update Dependencies**

 *这应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-13T11:03:08.720

我遇到了同样的问题，并通过右键单击项目并从上下文菜单中选择 Maven -> Disable Workspace Resolution 来解决问题。如上所述，我已经尝试从 POM 文件更新项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-25T20:19:13.897

为了解决这个问题，您通常可以从工作项目中复制 Eclipse .classpath 文件，因为假设您的结构是标准 Maven 项目，这里没有任何特定的项目。这将告诉 Eclipse 允许 Maven 管理依赖项和构建。从 Eclipse UI 似乎没有简单的方法可以做到这一点。*

# api - 使用我的网站 API 对用户进行身份验证

> ID：11227851
> 
> 赞同：1
> 
> 时间：2012-06-27T13:53:45.777
> 
> 标签：api, cakephp, authentication, backbone.js, authorization

我试图弄清楚如何在我正在创建的网站 API 中实现安全性。让我解释一下我的应用程序的设计。

我正在编写一个在线发票应用程序，以允许用户创建、存储和发送发票。该应用程序分为两部分，用户输入和查看发票等的前端......以及处理网站所有处理的后端（保存，更新数据等......）

我坚持的是如何为我的网站实现某种安全性，以便用户输入用户名和密码，然后在后端进行身份验证，后端将知道哪个用户正在与它交谈（希望这是有道理的）

前端通过 RESTful API 与后端通信，但是当前端向 API 发送请求时，后端如何知道用户是谁以及是否允许用户访问 API。

我的前端是使用 Backbone.js 编写的，并使用 JSON 与后端 API 进行通信。后端是用 CakePHP 编写的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T16:05:32.457

有几种 API 身份验证模式，您可以在此处阅读更多相关信息[https://support.3scale.net/howtos/api-configuration/authentication-patterns](https://support.3scale.net/howtos/api-configuration/authentication-patterns)，特别是“标准身份验证模式”部分

你基本上必须给用户一个秘密令牌，然后在 API 调用请求将该令牌发送到后端，这样你就可以在两端关联用户

如果您像我一样想要省去所有实施的麻烦，您可以使用 3scale 免费帐户 (http://www.3scale.net) 为您管理身份验证，这样您甚至可以进行访问控制，限制API 调用等。在此处查找更多详细信息：[http ://www.3scale.net/2012/06/the-10-minute-api-up-running-3scale-grape-heroku-api-10-minutes/](http://www.3scale.net/2012/06/the-10-minute-api-up-running-3scale-grape-heroku-api-10-minutes/)

该示例使用了 ruby​​ 插件，但在 GH github.com/3scale/3scale_ws_api_for_php 中也提供了一个 php 插件

# linux - 使用 openCV 人脸检测的 Linux 应用程序列表

> ID：11227852
> 
> 赞同：2
> 
> 时间：2012-06-27T13:53:47.323
> 
> 标签：linux, opencv, embedded-linux

我需要使用对象检测特别是使用 openCV 进行人脸检测的任何知名 Linux 应用程序的列表。我尝试用谷歌搜索这样的 Linux 应用程序，但找不到。如果有人知道任何使用 openCV 的 Linux 应用程序，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T15:44:52.803

你可以去`digiKam`。它使用 OpenCV 和某些其他库，如`libkface`人脸检测。

查看 digikam 的官方网站：[http ://www.digikam.org/](http://www.digikam.org/)

甚至他们在 2012 年的 GSoC 项目想法之一就是在 OpenCV 的帮助下实现人脸识别：[链接](http://community.kde.org/GSoC/2012/Ideas#Project%3a_Face_Recognition)

甚至[`Libface`](http://libface.sourceforge.net/file/Home.html)KDE 库（也用于 digiKam）出于某些目的使用 opencv。

你可以在`libkface`这里找到来源：[链接](https://projects.kde.org/projects/extragear/libs/libkface/repository)

# php - PHP 错误/成功重定向

> ID：11227855
> 
> 赞同：1
> 
> 时间：2012-06-27T13:53:53.927
> 
> 标签：php, exception-handling

我对 PHP 错误有一个不错的理解（我没有像以前那样使用 or die()），但我仍然不完全理解如何以一种不是的方式向用户传递致命错误消息左上角的纯文本。

说我有这个代码：

```
try {  
$conn = new PDO("mysql:host=host; dbname=userDB", $username, $password); 
$stmt = $conn->prepare("UPDATE employee SET password = :newpass WHERE password = :tempPass");
$conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$stmt->execute(array('tempPass' => $tempPass, 'newpass' => $newpassword));
echo'success!<br>';
echo"<a href='main_login.php'>Back</a>";

    }  
catch(PDOException $e) {  
        echo 'ERROR:   '. $e->getMessage();  
    } 
```

这一切都很好，但无论成功与否，这都是一个丑陋的肯定信息。

我应该将我的用户重定向到不同的页面来传递此消息吗？

如果是这样，我应该如何将消息存储/传输到单个页面？我不想创建 user_success.php、user_failure.php、user_epic_failure.php、every_other_case.php。它效率不高，并且限制了我的能力。

我听说将这些消息存储到会话错误变量中是一种很好的方法，但这是最好的方法吗？是否应该有一个专门的错误页面和专门的成功页面作为我传递消息的模板？

我只想要漂亮的错误消息。这是不是要求太过分了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:57:48.943

永远不要向用户显示系统错误消息，这可能会给潜在的黑客提供有关您系统的信息。有一个通用错误页面，如果发生致命错误，您可以从 catch 子句重定向到该页面。
对于不会导致致命错误并停止代码执行的所有其他错误，只需继续执行代码并在必要时在页面顶部显示错误消息即可。

# jquery - Magento - 从自定义 PHP 文件更新购物车

> ID：11227856
> 
> 赞同：0
> 
> 时间：2012-06-27T13:53:57.617
> 
> 标签：jquery, magento, post, cart

我需要能够从我通过 jQuery 的 post 函数发布到的自定义 PHP 文件中更新用户购物车中的产品数量。我正在尝试使用 Magento 的功能，但我只得到一个空白页。有人知道如何更新购物车数据吗？

这就是返回空白页的原因...

```
<?php
include_once '/app/Mage.php';
$test = Mage::getModel('checkout/cart')->getQuote()->getData(); 
var_dump($test);
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T11:45:02.340

首先，在您的 magento 文件夹（index.php 所在的位置）中尝试这个脚本，以便包含路径是相对的，

第二：

```
<?php
    require_once "app/Mage.php";
    Mage::app('default'); // initialize -the- app so you could access the singletons (like sessions, quotes, etc);
    $test = Mage::getSingleton('checkout/cart')->getQuote()->getData();  // load the cart singleton 
    var_dump($test);

    // take note that there isn't a closing PHP tag.. just observing the Zend Coding standards 
```

此外，在处理与会话相关的单例（购物车、报价单）时，您可能希望获取和恢复会话 ID（如果已知）。请记住，从您的自定义 PHP 文件进行测试和从实际的 magento 应用程序进行测试会产生不同的 SID。您必须提供一种以某种方式在两者之间“共享”它的方法。在 之后插入以下内容`Mage:app();`：

```
$frontend = Mage::getSingleton('core/session', array('name' => 'frontend'));
$frontend->setSessionId($sid); 
```

# mysql - MYSQL 具有多个与不同 where 条件相对应的 Select

> ID：11227858
> 
> 赞同：0
> 
> 时间：2012-06-27T13:53:58.843
> 
> 标签：mysql, greatest-n-per-group

我想执行一个 mysql 语句，其中我有一个不属于 where 条件的选择。这是我的代码：

```
 SELECT oil.empid
     , oil.mileage
     , oil.`date`
     , max(oil.mileage) AS expr1

FROM
  oil
WHERE
  oil.mileage < (SELECT max(oil.mileage) AS expr1
                 FROM
                   oil)

GROUP BY
  oil.empid
ORDER BY
  oil.mileage 
```

现在这选择了第二大里程，但我想要的是第二和最大的里程。我相信我只需要在 WHERE 之外选择 max(mileage)，但我不知道该怎么做。谢谢你的帮助

编辑：如果为这些 1497 输入的数据是

里程数：100、100000 和 200000

对于 empid 2000

里程：100 , 1500 , 5000

我想要这个：

```
 empid|2nd max  | max
 1497 | 100000  |  200000
 2000 | 1500    |  5000 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:58:52.140

这可能是一个幼稚的回应，但为什么不这样做：

```
SELECT oil.empid
      , oil.mileage
      , oil.`date`
      , max(oil.mileage) as expr1
FROM oil
GROUP BY oil.empid, oil.`date`
ORDER BY oil.mileage DESC
LIMIT 2 
```

**更新**
鉴于 OP 的更新，很明显我们需要一种完全不同的查询，如下所示：

```
SELECT outer.empid
       , (SELECT first.mileage
          FROM oil as first
          WHERE first.empid = outer.empid
          ORDER BY first.mileage DESC
          LIMIT 1) AS max
       , (SELECT second.mileage
          FROM oil as second
          WHERE second.empid = outer.empid
          ORDER BY second.mileage DESC
          LIMIT 1
          OFFSET 1) as 2nd_max
FROM oil as outer 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T14:02:26.040

您可以在 MySQL 的子句中使用`LIMIT`with来查找第二个里程。这样您就可以通过不使用昂贵的.`OFFSET``ORDER BY``GROUP BY`

（更新）在OP澄清后：

```
SELECT oil.empid
     , oil.mileage
     , oil.date
FROM
        oil
    JOIN
        ( SELECT DISTINCT empid
          FROM oil
        ) AS emp
            ON  oil.empid = emp.empid
            AND oil.mileage >= 
                ( SELECT mileage
                  FROM oil AS o
                  WHERE o.empid = emp.empid
                  ORDER BY mileage DESC
                  LIMIT 1  OFFSET 1
                )
ORDER BY
    oil.empid
  , oil.mileage               --- ASC or DESC here, your choice
; 
```

# php - 使用 SimpleXML 解析 á 等有趣的字符

> ID：11227859
> 
> 赞同：0
> 
> 时间：2012-06-27T13:53:59.040
> 
> 标签：php, character-encoding, xml-parsing, simplexml

在接收和编写我的 XML 时，一些字段是这样通过的：`Benedíková`

但是当我用类似的代码解析它时

```
$xml = simplexml_load_file($filename); 
print_r($xml); 
```

...字段更改为：

`BenedÃ­kovÃ¡`

我怎样才能干净地解析它，以便保留 á 或 í 之类的字符？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-24T01:35:02.030

正如 PHP 手册中所记录的那样，当您从`SimpleXMLElement`is 中读取字符串时，总是使用 UTF-8 编码以 Unicode 格式。

这与文档中使用的编码无关。

因此，如果您的网站不使用 UTF-8 作为编码，您可能希望切换到它，*或者*您可能希望将这些 UTF-8 字符串重新编码为您网站的编码。

我通常会建议第一个（将网站转换为使用 UTF-8），但更改它并不总是很容易（而且并不总是正确的做法），因此这两种变体都有其用途。

另见：

*   [simplexml_load_string() 不喜欢外语](https://stackoverflow.com/q/5943555/367456)（与 2011 年 5 月完全相同）
*   [PHP SimpleXML asXML 写入 ANSI 编码文件](https://stackoverflow.com/q/6940104/367456)

# textmate - TextMate - 命令 - 更改当前行号

> ID：11227862
> 
> 赞同：0
> 
> 时间：2012-06-27T13:54:04.313
> 
> 标签：textmate

我目前正在尝试在 TextMate 中创建一个模板。该模板非常基本：

```
<?php

?> 
```

没什么特别的。但是我想在创建模板时将文本光标放在开始和结束标记之间。

我知道这可以通过 AppleScript 和可能的宏来完成，并且可以通过创建一个在创建模板时执行的片段来完成，但我觉得应该有一个更简单的方法。

任何帮助都会很棒。

- 编辑 -

我深表歉意。再谷歌搜索一下，我找到了答案：

[http://henrik.nyh.se/2007/02/snippet-power-templates-in-textmate](http://henrik.nyh.se/2007/02/snippet-power-templates-in-textmate)

谢谢。谢谢，凯尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:16:41.347

我可以通过更多的谷歌搜索找到答案。

[http://henrik.nyh.se/2007/02/snippet-power-templates-in-textmate](http://henrik.nyh.se/2007/02/snippet-power-templates-in-textmate)

# android - 调整图像大小，使用android中的动画翻转图像

> ID：11227869
> 
> 赞同：0
> 
> 时间：2012-06-27T13:54:25.017
> 
> 标签：android, android-animation

我正在制作一些动画，其中有四个图像。我想做如下：

*   将它们从右向中心翻转
*   然后从中间到左边

右侧应较小，翻转时应居中，图像尺寸应放大。

下一个图像应该到中心，当前图像应该到左侧，并且图像的大小应该通过动画（或缩放）减小。

基本上我希望图像从右向中心增长，然后向左侧收缩......从左到右也是如此。谁能告诉我怎么做这个动画？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:36:40.367

也许[`android-3d-flip-view-transition`](http://code.google.com/p/android-3d-flip-view-transition/)是您正在寻找的东西？还有[FlipAnimator](http://code.google.com/p/myandroidwidgets/source/browse/trunk/FlipAnimatorExample/src/com/beanie/examples/animation/FlipAnimator/FlipAnimator.java)类，它真的取决于你想如何实现它，但据我所知，它们都允许你指定关键点，这样你就可以像书一样从左到右翻转，或者像在 iOS 中一样居中翻转。单击某些应用程序右下角的小“i”信息按钮。

# javascript - 编写一个合适的 jQuery 插件的麻烦

> ID：11227873
> 
> 赞同：0
> 
> 时间：2012-06-27T13:54:32.710
> 
> 标签：javascript, jquery

我正在重写要在实习期间构建的 RSS 阅读器中使用的 jQuery 插件。该插件使用 Google 的 Feed API 提取 JSON 格式的 RSS 提要并将其返回给开发人员，从而允许他们微调该提要在网页上的显示方式。我一直在关注官方的[jQuery 插件创作](http://docs.jquery.com/Plugins/Authoring)页面作为参考。

在参考页面上，代码示例说您需要将插件添加到 jQuery 的原型中：`$.fn`. 这是我所做的：

```
(function($) {
    "use strict";

    $.fn.rssObj = function(newUrl) {
        var RSSFeed = function(newUrl) {
            /*
             * An object to encapsulate a Google Feed API request.
             */

            this.feedUrl = newUrl;
        };

        RSSFeed.prototype.load = function() {
            var feed = new google.feeds.Feed(this.feedUrl);
            feed.load(function(result) {
                console.log(result);
            });
        };

        return new RSSFeed(newUrl);
    };

})(jQuery); 
```

当我尝试通过执行来使用这个插件时`$.rssObj("http://rss.test.com")`，我的浏览器给了我这个错误：

```
$.rssObj() is not a function 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T13:56:46.337

*如果您希望您的函数在 jQuery实例*`$.fn`上可用（例如，您从中获取的对象等） ，您可以添加。如果您希望您的函数可以直接从对象中获得，您可以直接将其添加到该对象中。*`$("your selector here")``$`*

 *这是一个显示每个示例的示例：

```
// Creating the plugin
(function($) {

  // This will be on *instances*
  $.fn.green = function() {
    // `this` is the jQuery instance we were called on
    return this.css("color", "green");
  };

  // This will be on the $/jQuery object itself
  $.blue = function(selector) {
    // You don't use `this` here (you could if you want,
    // it will be === $/jQuery, but there's no reason to)
    $(selector).css("color", "blue");
    return this;
  };

})(jQuery);

// Usage
jQuery(function($) {

  // Make all divs green with a border
  $("div").green().css("border", "1px solid green");

  // Make all paragraphs blue
  $.blue("p");

});
```

```
<div>I'm a div</div>
<p>I'm a paragraph</p>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-08T21:22:27.443

看看我在哪里做了作者想要做的[**事情！**](http://jsfiddle.net/Pp44S/)我只是使用了我多年来一直使用的这个模板：

```
(function($) {
    if (!$.myExample) { // check your plugin namespace does not already exist
        $.extend({  //  this will allow you to add your plugin to the jQuery lib
            myExample: function(elm, command, args) {
                //  keep in mind, right here you might want to do a class or data check to determine which direction this call is going
                //  for example, upon init the plugin on an element you may add the plugin name as a class, 
                //      this way, when it's recalled, you can see it alrady has that class and might be calling a command,
                //          thus make an if statemnt to push the process through
                return elm.each(function(index){
                    // do work to each element as its passed through
                    // be sure to use something like
                    //    return elm.each(function(e) { dor work });
                    // as your final statement in order to maintain "chainability"
                });
            }
        });
        $.fn.extend({   //  this gives the chainability functionality seen with $ funcs like: $("#eleID").css("color", "red") <--returns original element object
            myExample: function(command) {
                return $.myExample($(this), command, Array.prototype.slice.call(arguments, 1));
            }
        });
        $.myExample.props = {   //  Here you can establish specific properties to your plugin, prehaps even make them "Over-writable"
            key1: "value",
            key2: "value"
        };
        $.myExample.methods = { //  Here you can establish specific methods/functions for your plguin to carry out and maintain your namespace as well
            key1: function(param) {
                /*  do work */
            },
            key2: function(param) {
                /*  do work */
            }
        };
        //  This next part is not seen in many plugins but useful depending on what you're creating
        $.myExample.init = function(param) {    //  If you have an initialize method to apply, namespace it in here and calll on initializing your plugin
            var key = "value",
                key2 = {
                    subKey: "value"
                };
                /*
                /  run any number of initializing functions here
                /  I prefer to make my param a value that can be a
                /   string with a possible object
                /   the string for holding a base configuration
                /   the object for any change in properties or base values for that config
                */
        };
        $.myExample.defaults = {    //  establish base properties here that can be over-written via .props, but their values should never truly change
            key1: "value",
            key2: {
                prop1: {
                    subKey1: "value",
                    subKey2: "value"
                },
                prop2: {
                    subKey1: "value"
                }
            },
            key3: function(param) {

            }
        };
    }
})(jQuery); 
```*

# pycharm - pycharm - 我如何在整个项目中找到替换单词？

> ID：11227874
> 
> 赞同：19
> 
> 时间：2012-06-27T13:54:35.377
> 
> 标签：pycharm

正如问题所问，我如何在 pycharm 中为整个项目中的一个词运行查找/替换？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-27T14:08:37.790

`Edit`| `Find`| [在路径中替换](http://www.jetbrains.com/pycharm/webhelp/finding-and-replacing-text-in-project.html)。

捷径：`Ctrl + Shift + R`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-11-22T17:49:13.820

对于那些来自谷歌并且只想在整个项目 中**找到一些东西的人：**`CTRL+H`

对于替换，没有键盘快捷键。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-09-09T06:57:20.757

# [快速回答]

*   在项目中查找和替换 == > `Ctrl`++`Shift``R`
*   在本地文件中查找和替换 ==> `Ctrl`+`R`

* * *

[**注意**]：

有时，它已调整`H`为`R`

# ios - 魔法记录持久性问题

> ID：11227875
> 
> 赞同：2
> 
> 时间：2012-06-27T13:54:39.153
> 
> 标签：ios, cocoa, core-data, magicalrecord

我有以下问题：

首先...我将 MagicalRecord 用于整个 CoreData

*   我有两个实体：A 和 B
*   他们彼此之间有关系
*   我创建了一个实体 A 的实例
*   我创建了几个实例 ob Entity B 并设置了关系
*   我不调用 [[NSManagedObjectContext defaultContext] save];
    *   没关系
    *   关系没问题...我可以使用 findByAttribute 方法检查它
*   如果我称之为保存，那么关系就会被破坏......
    *   使用 findByAttribute 的相同检查不再找到结果

我完全不知道我做错了什么，或者它是否是 CoreData / MagicalRecord 中的错误......

我做了一个显示问题的示例项目。 [https://github.com/bliblablo/MagicalRecordsProblem](https://github.com/bliblablo/MagicalRecordsProblem)

您可以按照以下步骤查看问题：

*   点击“创建”
*   点击“添加”
*   点击“检查”
*   查看结果的日志输出
*   点击“保存”
*   再次单击“检查”并在日志中查看问题:)

任何帮助都非常感谢！非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T19:00:10.290

听起来我`ObjectID`在默认上下文中没有刷新临时的问题。

有关详细信息，请参阅我对[NSPredicate 未执行](https://stackoverflow.com/questions/11212702/nspredicate-not-executed/11407413#11407413)的回答。

如果您尚未对其进行整理，请尝试`NSManagedObject`在各个点检查实例的 ObjectID。特别是如果您（或 Magical Record）正在使用该对象作为 an 的一部分`NSPredicate`来进行以后的提取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:32:05.460

我认为这不是 MR 错误。这是来自核心数据的错误。看到这个帖子。 [http://wbyoung.tumblr.com/post/27851725562/core-data-growth-pains](http://wbyoung.tumblr.com/post/27851725562/core-data-growing-pains)

# excel - 将excel中的5000个地址的单列拆分为列

> ID：11227884
> 
> 赞同：0
> 
> 时间：2012-06-27T13:55:09.700
> 
> 标签：excel

地址在单列中，地址之间的唯一分隔符是空行。我有 5000 个地址，每个地址大约有 4 - 6 个由行分隔的字段。数据是从另一个系统预先格式化的。

任何人都知道这是否可以分成每个地址的列？我在想一个宏可以做到这一点，但我认为这个问题对于文本到列或任何其他基本公式来说太复杂了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:06:00.127

您或许可以使用[**RealCool Import Manager**](http://www.realcoolsoft.com/import-manager-1-0/)来执行此操作。[它使您可以将文本文件（请参阅此屏幕截图](http://www.realcoolsoft.com/wp-content/uploads/2011/04/main.png)）中的重复字段识别为字段，然后解析文件以将它们提取到单独的 Excel 列中。

# php - json_decode 失败

> ID：11227886
> 
> 赞同：1
> 
> 时间：2012-06-27T13:55:16.043
> 
> 标签：php, json

我有以下 JSON 格式的字符串：

```
{

"hooks":[
        {
        "type":"subscribe",
        "id":1331741592.6925,
        "email":"JoeX@test-email.com",
        "status":"Active",
        "custom_fields":"{\"first_name\":\"Joe\",\"last_name\":\"X\"}",
        "ip_created":"24.199.200.142",
        "list_id":"33",
        "list_type":"internal",
        "list_name":"Administrator List 2",
        "list_optin":false
        },
        {
        "type":"subscribe",
        "id":1331741592.7067,
        "email":"JaneY@test-email.com",
        "status":"Active",
        "custom_fields":"{\"first_name\": \"Jane\",\"last_name\":\"Y\"}",
        "ip_created":"24.199.200.142",
        "list_id":"33",
        "list_type":"internal",
        "list_name":"Administrator List 2",
        "list_optin":false
        }
    ]

} 
```

我想使用 PHP`json_decode()`函数将其放入关联数组中。

当我运行脚本时，调试将新数组的值显示为`null`，因此我认为解码失败。我们没有运行 PHP 5.3，所以我不能使用`json_last_error()`. 这是代码：

```
$hooks = (the JSON string from above);
$hooksArray = json_decode($hooks, true); 
```

任何想法为什么`$hooksArray`会回来`null`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:11:30.207

JSON 字符串是否在您的 PHP 源代码中？也许它没有正确解释转义的反斜杠。

我在 Python 中尝试了以下实验以供参考：通过 REPL 将 JSON 数据转储为多行字符串，并使用 json.loads() 对其进行解码。它在 custom_fields 字符串的第一个实例中被字符串内引号阻塞。当我检查多行字符串时，所有转义都消失了，只剩下引号。

当我将相同的 JSON 数据放入外部文件并加载它时，它工作正常。

我将 JSON 数据放在一个外部文件中，并用 '\\"' 替换了所有 '\"' 实例，然后第一个实验开始工作。

也许这也对你有用。

# php - Zend_Translate 是否可以从语言文件中返回多个“片段”内容？

> ID：11227887
> 
> 赞同：0
> 
> 时间：2012-06-27T13:55:16.173
> 
> 标签：php, zend-framework, zend-translate

今天开始在谷歌上搜索，以研究在我最近被分配到的 Zend 1.6.x 项目中实现 Zend_Translate。但我发现很难获得可用/适当的信息来源。

实现了简单的数组适配器，效果很好。

实现的基本覆盖如下：

在语言文件中：

```
 return array(
    'testKey' => 'Hello World!'); 
```

在 SomeController.php 中：（添加翻译到注册表）

> ```
> public function init()
> { 
>     ...
>       $this->_translate = Zend_Registry::get('translate');
>     ...
> } 
> ```

在视图中：

> echo $translate->_('testKey');

我想知道是否可以从语言数组中检索多个元素？就像是：

```
$phraseList= $translate->_('lanKey1','lanKey1'..'n');
//or
$phraseList= $translate->_( array('lanKey1','lanKey1'..'n') ); 
```

或者至少有人有资源可以指出，或者有研究方向吗？

非常感谢，大卫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T15:00:37.223

不，您一次可以通过一件物品。

你可以参考源代码。它是比文档更好的资源。

```
/**
     * Translates the given string
     * returns the translation
     *
     * @param  string             $messageId Translation string
     * @param  string|Zend_Locale $locale    (optional) Locale/Language to use, identical with locale
     *                                       identifier, @see Zend_Locale for more information
     * @return string
     */
    public function _($messageId, $locale = null)
    {
        return $this->translate($messageId, $locale);
} 
```

仅供参考：[Zend_Translate_Adapter](http://framework.zend.com/code/filedetails.php?repname=Zend%20Framework&path=/trunk/library/Zend/Translate/Adapter.php)

# java - 允许在迭代时添加和删除的 Java 集合

> ID：11227888
> 
> 赞同：5
> 
> 时间：2012-06-27T13:55:19.560
> 
> 标签：java, collections, frameworks, concurrent-collections

如果有任何框架实现具有以下行为的集合，我很感兴趣。

* * *

假设它最初包含： [1, 2, 3]

*   我迭代它（使用迭代器）并到达元素 2，现在我将 4 添加到末尾（集合现在将是 [1, 2, 3, 4]）。
*   现在我创建一个新的迭代器并迭代集合，得到 [1, 2, 3, 4]
*   我继续使用第一个迭代器进行迭代，它只会给我 3 并返回
*   现在重置第一个迭代器会给我 [1, 2, 3, 4] （类似于创建一个新的）。

同样应该适用于删除元素。如果我删除 3 而不是添加，第二个迭代器应该给我 [1, 2] 而第一个迭代器仍然会给我 3 和结尾。

* * *

所以当我得到和迭代器时，我希望它给我创建迭代器时拥有的集合（即使我稍后迭代它，我会迭代一点并稍后继续），当我重置迭代器时，它会被垃圾收集将更新到最新版本，我应该能够在不同时间创建多个迭代器实例，这些实例将根据创建迭代器时数组的内容提供不同的版本。

我需要它与多个线程一起工作，并且最好有一个有效的实现。

有谁知道这样一个集合的任何实现，还是我必须自己实现它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-27T13:59:38.370

[`java.util.concurrent.CopyOnWriteArrayList`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/CopyOnWriteArrayList.html)将表现得像这样，除了没有 Java 集合具有迭代器的“重置”——但是获取一个新的迭代器而不是重置具有您在此处请求的效果。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-27T13:59:49.550

您描述的内容与[`CopyOnWriteArrayList`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/CopyOnWriteArrayList.html)工作方式非常相似：

*   一旦开始迭代，就可以更改集合（包括来自另一个线程）而不影响迭代
*   如果您创建一个新的迭代器，它将基于创建时的集合
*   它是线程安全的

下面的简单示例具有以下输出：

> 迭代器 1 - 1
> 4 已添加
> 迭代器 2 - 1
> 迭代器 2 - 2
> 迭代器 2 - 3
> 迭代器 2 - 4
> 迭代器 1 - 2
> 迭代器 1 - 3

```
public static void main(String[] args) throws InterruptedException {
    final List<Integer> list = new CopyOnWriteArrayList<Integer>();
    list.addAll(Arrays.asList(1, 2, 3));
    new Thread(new Runnable() {

        @Override
        public void run() {
            for (Integer i : list) {
                System.out.println("Iterator 1 - " + i);
                try {
                    Thread.sleep(10);
                } catch (InterruptedException e) {}
            }
        }
    }).start();
    Thread.sleep(10);
    list.add(4);
    System.out.println("4 has been added");
    for (Integer i : list) {
        System.out.println("Iterator 2 - " + i);
    }

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-27T14:05:22.843

您可以使用 guava 库中的[ImmutableCollections](http://code.google.com/p/guava-libraries/wiki/ImmutableCollectionsExplained)。

> 返回的 ImmutableList 经常——不总是，但经常——一个常量开销视图，而不是显式副本。也就是说，它通常比普通的 List 更聪明——例如，它将使用支持集合的有效 contains 方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-27T14:06:10.283

你可以利用[`java.util.concurrent.CopyOnWriteArrayList<E>`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/CopyOnWriteArrayList.html)

*根据文件：*

> ArrayList 的线程安全变体，其中所有可变操作（添加、设置等）都是通过制作底层数组的新副本来实现的。

**它的成本很高，但线程安全。**

> 这通常成本太高，但是当遍历操作的数量大大超过突变时，它可能比替代方法更有效，并且在您不能或不想同步遍历但需要排除并发线程之间的干扰时很有用。“快照”风格的迭代器方法使用对创建迭代器时数组状态的引用。

由于迭代发生在一种快照上，因此不支持对其自身的操作（ `remove`、`set`和`add`） 。`Iterator`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-27T14:08:04.430

javolution 有线程安全的 FastMap

# perl - Perl Plucene 索引搜索

> ID：11227890
> 
> 赞同：1
> 
> 时间：2012-06-27T13:55:33.463
> 
> 标签：perl, lucene

更多地使用 Perl Plucene 模块，并且创建了我的索引，我现在正尝试搜索它并返回结果。

我创建索引的代码在这里......你可以跳过这个并继续阅读：

```
#usr/bin/perl
use Plucene::Document;
use Plucene::Document::Field;
use Plucene::Index::Writer;
use Plucene::Analysis::SimpleAnalyzer;
use Plucene::Search::HitCollector;
use Plucene::Search::IndexSearcher;
use Plucene::QueryParser;
use Try::Tiny;
my $content = $ARGV[0];
my $doc = Plucene::Document->new;
my $i=0;
$doc->add(Plucene::Document::Field->Text(content => $content));
my $analyzer = Plucene::Analysis::SimpleAnalyzer->new();

if (!(-d "solutions" )) {
        $i = 1;
}

if ($i)
{
    my $writer = Plucene::Index::Writer->new("solutions", $analyzer, 1); #Third param is 1 if creating new index, 0 if adding to existing
    $writer->add_document($doc);
    my $doc_count = $writer->doc_count;
    undef $writer; # close
}
else
{
    my $writer = Plucene::Index::Writer->new("solutions", $analyzer, 0);
    $writer->add_document($doc);
    my $doc_count = $writer->doc_count;
    undef $writer; # close
} 
```

它创建了一个名为“解决方案”的文件夹和各种文件......我假设我创建的文档的索引文件。现在我想搜索我的索引......但我没有想出任何东西。这是我的尝试，由 Plucene::Simple examples of CPAN 指导。这是在我从命令行使用参数“lol”运行上述内容之后。

```
#usr/bin/perl  

  use Plucene::Simple;

  my $plucy = Plucene::Simple->open("solutions");
  my @ids = $plucy->search("content : lol"); 
  foreach(@ids)
  {
    print $_;
  } 
```

遗憾的是，没有打印任何内容）-=。我觉得查询索引应该很简单，但也许我自己的愚蠢限制了我这样做的能力。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T13:03:16.893

我及时发现了三件事：

*   Plucene 是一个非常低效的概念证明，如果您要使用这个工具，Lucene 的 Java 实现是 BY FAR 的最佳选择。这是一些证据：[http ://www.kinosearch.com/kinosearch/benchmarks.html](http://www.kinosearch.com/kinosearch/benchmarks.html)
*   Lucy 是一个更好的选择，它做同样的事情并且拥有更多的文档和社区（根据对问题的评论）。
*   如何做我在这个问题中提出的问题。

我将分享两个脚本 - 一个用于将文件导入新的 Plucene 索引，另一个用于搜索该索引并检索它。Plucene 的一个真正有效的例子......在互联网上很难找到它。此外，我在对这些模块进行 CPAN 处理时遇到了巨大的麻烦......所以我最终去了 CPAN 站点（只是 Google），获取了 tar 并将它们放入我的 Perl 库（我在 Strawberry Perl，Windows 7 上）我自己，但随意。然后我会尝试运行它们并 CPAN 它所需要的所有依赖项。这是一种草率的做事方式……但我就是这样做的，现在它可以工作了。

```
#usr/bin/perl
use strict;
use warnings;
use Plucene::Simple;
my $content_1 = $ARGV[0];
my $content_2 = $ARGV[1];
my %documents;

 %documents = (
"".$content_2 => { 

                     content => $content_1
                   }
);

print $content_1;
my $index = Plucene::Simple->open( "solutions" );
for my $id (keys %documents) 
{
        $index->add($id => $documents{$id});
}
 $index->optimize; 
```

那么这是做什么的......你用你选择的两个命令行参数调用脚本 - 它创建一个“第二个参数”=>“第一个参数”形式的键值对。将其视为 apache 站点 (http://lucene.apache.org/solr/api/doc-files/tutorial.html) 上教程中的 XML。第二个参数是字段名。

任何人，这将在脚本运行的目录中创建一个文件夹 - 在该文件夹中将是由 lucene 创建的文件 - 这是你的索引！我们现在需要做的就是使用 Lucene 的强大功能搜索该索引，而 Plucene 使这一切变得容易。脚本如下：

```
#usr/bin/perl  
use strict;
use warnings;
use Plucene::Simple;
my $content_1 = $ARGV[0];
my $index = Plucene::Simple->open( "solutions" );

my (@ids, $error);
my $query = $content_1;
@ids = $index->search($query);
foreach(@ids)
{
    print $_."---seperator---";
} 
```

您可以通过使用 ONE 参数从命令行调用它来运行此脚本 - 例如，让它与您调用前一个脚本的第一个参数相同。如果你这样做，你会看到它打印了之前示例中的第二个参数！所以你已经取回了那个值！并且鉴于您有其他具有相同值的键值对，这也会打印它们！他们之间有“---分隔符---”！

# c# - 子窗口定位

> ID：11227892
> 
> 赞同：2
> 
> 时间：2012-06-27T13:55:37.983
> 
> 标签：c#, wpf, parent-child

我知道这已经被问过（[Get Absolute Position of element within the window in wpf](https://stackoverflow.com/questions/386731/get-absolute-position-of-element-within-the-window-in-wpf)），但我还没有能够正确实现。我正在尝试相对于父窗口中的控件打开一个子窗口。到目前为止，我有这个；

```
messageWindow = new Message(true);
Point relativePoint = btn1.TransformToAncestor(this).Transform(new Point(0, 0));
messageWindow.Left = relativePoint.X;
messageWindow.Top = relativePoint.Y;
messageWindow.Show(); 
```

现在，虽然这确实影响了子窗口 ( `messageWindow`) 的位置，但它似乎并没有将它放在`btn1`父控件上/旁边。我遇到的另一个问题是，如果我移动父窗口，然后回想这个方法已经关闭了原始`messageWindow`窗口的新实例显示在旧位置（即使`btn1`在新位置）。我觉得这很奇怪，想知道是否有人可以帮我解决这个问题。

**更新**

感谢 Charleh 解释说我只是相对于窗口中的控制位置设置它们，而不是相对于整个屏幕。所以现在的问题是获取父窗口在屏幕上的位置并将其也添加到 XY 中。我怎么会得到这个？刚刚尝试了这段代码（虽然我会说实话，我不太明白）总线似乎仍然没有密切关注。在屏幕上获取窗口位置的好方法是什么？

```
messageWindow= new Message(true);
Point relativePoint = btn1.TransformToAncestor(this).Transform(new Point(0, 0));
PresentationSource ScreenPos = PresentationSource.FromVisual(this);

messageWindow.Left = relativePoint.X + (96.0 * ScreenPos.CompositionTarget.TransformToDevice.M11);
messageWindow.Top = relativePoint.Y + (96.0 * ScreenPos.CompositionTarget.TransformToDevice.M22);
messageWindow.Show(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T14:02:50.723

`relativePoint`是控件*相*对于的位置`Window`，而不是屏幕。设置（子窗口）的`Left`和`Right`点时，点是*相*对于屏幕的，而不是相对于父窗口的。`messageWindow`

 *为了获得正确的位置，您需要找到父窗口的位置，然后进行一些数学运算以找到控件相对于屏幕的位置，而不是应该为您提供所需位置的窗口放置子窗口。*

# android - 如何从列表中删除行，重新加载 listView 然后在现有文件中写入字符串？

> ID：11227894
> 
> 赞同：1
> 
> 时间：2012-06-27T13:55:48.543
> 
> 标签：android, android-listview, android-alertdialog, android-adapter, android-file

我想从数组中删除数组索引，然后用我的新数组重新加载 listView，然后将字符串写入 android 中的现有文件。我正在使用以下代码：

```
 OnItemLongClickListener longClickListener = new OnItemLongClickListener(){

            @Override
            public boolean onItemLongClick(AdapterView<?> arg0, View arg1,
                    int position, long arg3) {
                itemPosition = position;

                AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(context);
                alertDialogBuilder.setTitle("Warning");

                alertDialogBuilder
                .setMessage("Are you sure?")
                .setCancelable(false)
                .setPositiveButton("Yes",new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog,int id) {
                        ArrayList<String> itemsList = new ArrayList<String>();
                        for(int i=0; i<items.length; i++){
                            itemsList.add(items[i]);
                        }

                        itemsList.remove(itemPosition);
                        items = new String[itemsList.size()];
                        for(int i=0; i<itemsList.size(); i++){
                            items[i] = itemsList.get(i);
                        }

                        adapter.notifyDataSetChanged();

                        String newData = "";

                        for(int i=0; i<items.length; i++){
                            newData = newData+items[i];
                            if(i < items.length-1){
                                newData = newData+"NEXTLINE";
                            }
                        }
                        // write string to existing file
                        try {
                            fos = openFileOutput(FILENAME, Context.MODE_PRIVATE);
                            fos.write(newData.getBytes());
                            fos.close();
                        } catch (FileNotFoundException e) {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                        } catch (IOException e) {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                        }

                    }
                  })
                .setNegativeButton("No",new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog,int id) {
                        // if this button is clicked, just close
                        // the dialog box and do nothing
                        dialog.cancel();
                    }
                });

                AlertDialog alertDialog = alertDialogBuilder.create();
                alertDialog.show();

                return true;
            }

        }; 
```

当我在警报上单击是时，我的应用程序没有响应，一段时间后我的手机要求终止该应用程序？谁能告诉我这段代码有什么问题？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:15:57.243

问题出在下面的代码片段中......可能是您的列表大小过大，并且您正在循环三次，并且在两者之间您也在列表中刷新。

```
 ArrayList<String> itemsList = new ArrayList<String>();
                    for(int i=0; i<items.length; i++){
                        itemsList.add(items[i]);
                    }

                    itemsList.remove(itemPosition);
                    items = new String[itemsList.size()];
                    for(int i=0; i<itemsList.size(); i++){
                        items[i] = itemsList.get(i);
                    }

                    adapter.notifyDataSetChanged();

                    String newData = "";

                    for(int i=0; i<items.length; i++){
                        newData = newData+items[i];
                        if(i < items.length-1){
                            newData = newData+"NEXTLINE";
                        } 
```

尝试在此单击上调试和减少代码和循环...

# html - 带有服务器链接的 Phonegap 应用程序无法加载 Childbrowser 插件

> ID：11227895
> 
> 赞同：0
> 
> 时间：2012-06-27T13:55:58.530
> 
> 标签：html, cordova, anchor, childbrowser

我有一个基于 PhoneGap 的应用程序。该应用程序仅包含一个 index.html 文件，其中包含依赖 PhoneGap 的 js 和插件文件文件，并且工作正常。在 index.html 文件中，我使用 window.location 从服务器加载 url。我想使用 window.location 从应用程序中包含的服务器 html 文件中调用 childbrowser 插件。这意味着从服务器加载的 html 文件具有将在子浏览器中加载的锚链接。我尝试将 childbrowser 插件包含到应用程序中并从服务器 js 调用事件，但它不起作用。任何想法。请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T04:02:00.847

一旦您`window.location`在服务器上设置 URL 并离开`index.html`，PhoneGap 将不再加载，因此您无法使用 ChildBrowser。

`window.location`您需要使用`childBrowser.showWebPage()`in而不是设置`index.html`：

```
window.plugins.childBrowser.showWebPage( 'example.com/your-page-on-server' ); 
```

# ios - 使用 ios 进行 glib 编译

> ID：11227901
> 
> 赞同：0
> 
> 时间：2012-06-27T13:56:31.300
> 
> 标签：ios, c, glib

我正在尝试在 ios 中编译 glib，但在 gio/tests/appinfo-test.h 中出现错误

```
#include <stdlib.h>
#include <gio/gio.h>
int 
main (int argc, char *argv[])
{
  const gchar *envvar;
  gint pid_from_env;
  envvar = g_getenv ("GIO_LAUNCHED_DESKTOP_FILE_PID");
  g_assert (envvar != NULL);
  pid_from_env = atoi (envvar);
  g_assert_cmpint (pid_from_env, ==, getpid ());

  envvar = g_getenv ("GIO_LAUNCHED_DESKTOP_FILE");
  g_assert_cmpstr (envvar, ==, SRCDIR "/appinfo-test.desktop"); //got the error here that "Use of undefined identifier 'SRCDIR' "
  return 0;
} 
```

请帮帮我...谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T01:33:46.773

我无法根据给定的信息弄清楚您如何尝试在 ios 中编译示例代码，但您可以添加

```
#define SRCDIR 
```

之前`main()`。

示例代码似乎`glib/gio/tests/appinfo-test.c`在源存储库中。`SRCDIR`定义`-DSRCDIR=\""$(srcdir)"\"`为`Makefile.am`.

# javascript - 选择选项时，如何防止ASP.NET下拉列表启动其onClick事件？

> ID：11227907
> 
> 赞同：1
> 
> 时间：2012-06-27T13:57:00.133
> 
> 标签：javascript, drop-down-menu, onclick

我有一个 ASP.NET 下拉列表，当用户单击展开箭头以显示选项列表时，它需要执行一些 javascript，但当前选择一个选项也会触发 onclick 事件，这是我不想要的。

有没有办法在不使用某种标志的情况下做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:02:58.007

您需要防止该嵌套元素的点击冒泡

```
thatElementOnclickFunction = function (evt) {
    evt = evt || window.event;
    evt.cancelBubble = true;
    if(evt.stopPropagation) evt.stopPropagation();
} 
```

# google-chrome-extension - 是否可以将 Jetpack 扩展转换为 chrome 扩展？

> ID：11227911
> 
> 赞同：0
> 
> 时间：2012-06-27T13:57:12.690
> 
> 标签：google-chrome-extension, firefox-addon-sdk

是否可以将 FF Jetpack 扩展转换为 chrome 扩展？我读过一些关于包装器的东西，但我不知道他们是否已经实现了一个。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T20:45:27.473

不。一般来说，基于 Firefox Add-on SDK 的扩展更强大 - [chrome 授权](https://addons.mozilla.org/en-US/developers/docs/sdk/1.6/dev-guide/tutorials/chrome.html)让他们可以访问所有浏览器内部，这是 Chrome 扩展根本没有的访问级别。即使只看 SDK 提供的 API，它与 Chrome 的扩展 API 也有很大的不同，任何类型的泛型转换都是不可能的。但是，您通常可以手动转换扩展，但重新实现必要的部分。

# search-engine - 用于垂直搜索的 Sphider

> ID：11227914
> 
> 赞同：1
> 
> 时间：2012-06-27T13:57:21.163
> 
> 标签：search-engine, sphider

我正在研究构建垂直搜索引擎的不同工具。我遇到过[http://www.sphider.eu/](http://www.sphider.eu/)，我认为它工作正常。

但是，我不确定它可以索引多少页。文档中似乎没有关于此的信息。我想我将为这个特定的搜索引擎索引大约一百个站点，并且我必须每天至少重新索引一次。

蜘蛛能做到这一点吗？还是我应该寻找其他解决方案？

# c# - 检查未排序的联赛中是否缺少数字

> ID：11227920
> 
> 赞同：0
> 
> 时间：2012-06-27T13:57:39.163
> 
> 标签：c#, visual-studio-2010, .net-4.0, datagridview

我在屏幕上显示了一个 datagridview。用户可以将名为“Pareto”的末尾列更改为他/她喜欢的任何整数。但是有一个问题，所有记录都在一个联赛中。用户也可能希望简单地留下一个号码并返回它，因此不允许丢失号码是不可能的。

基本上我需要一种方法来检查列是否缺少未排序行中的数字，并将每个缺少的数字存储到数组/列表中以供我输出。

通常我喜欢这些小逻辑问题但是在我今天编码的循环之后，我的大脑被烧毁了......所以任何输入都会很棒！

本来想先通过count获取网格中的最大记录（没问题）

然后将其用作从 1 到“maxCount”的范围。找出所有缺失的数字。听起来很简单，直到我想到它没有排序的事实。

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T14:02:23.453

不清楚**真正的**工作流程，但是..

事实是，`DataGridView`未*排序*是纯粹的`UI`东西。您`data` *可以*分类并绑定到`DataGrid`通孔`DataView`或任何其他中间`View`层。

一次用户插入该值，您可以执行二进制搜索（排序集合搜索中最快的）以找到感兴趣的值。

**编辑**

如果您需要检查 (1..500) 中的一组数字中遗漏的数字，首先您可以对所有数字进行排序，就像我在数据模型中的帖子中定义的那样。

```
List<int> sortedAlreadyAvailableNumbers ... 
```

制作后

```
var missingNumbers =  Enumerable.Range(1, 500).Except(sortedAlreadyAvailableNumbers ); 
```

希望这可以帮助。

# php - PHP - 将文件转换为二进制文件并使用 HTTP POST 发送

> ID：11227923
> 
> 赞同：4
> 
> 时间：2012-06-27T13:57:45.387
> 
> 标签：php, http, post

我将使用 php 转换一些文件并将其作为 HTTP POST 请求的一部分发送。我的代码有一部分：

```
 $context = stream_context_create(array(
        'http' => array(
            'method' => 'POST',
            'header' => "Content-type: " . $this->contentType."",
            'content' => "file=".$file
        )
            ));
    $data = file_get_contents($this->url, false, $context); 
```

变量是否`$file`必须是我要发送的文件的字节表示？

那是在不使用表单的情况下在 php 中发送文件的正确方法吗？你有什么线索吗？

还有什么是使用PHP将文件转换为字节表示的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T14:08:41.873

您可能会发现使用 CURL 更容易，例如：

```
function curlPost($url,$file) {
  $ch = curl_init();
  if (!is_resource($ch)) return false;
  curl_setopt( $ch , CURLOPT_SSL_VERIFYPEER , 0 );
  curl_setopt( $ch , CURLOPT_FOLLOWLOCATION , 0 );
  curl_setopt( $ch , CURLOPT_URL , $url );
  curl_setopt( $ch , CURLOPT_POST , 1 );
  curl_setopt( $ch , CURLOPT_POSTFIELDS , '@' . $file );
  curl_setopt( $ch , CURLOPT_RETURNTRANSFER , 1 );
  curl_setopt( $ch , CURLOPT_VERBOSE , 0 );
  $response = curl_exec($ch);
  curl_close($ch);
  return $response;
} 
```

其中 $url 是您要发布到的位置， $file 是您要发送的文件的路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T14:47:04.663

奇怪的是，我刚刚写了一篇文章并说明了同样的情况。（[phpmaster.com/5-inspiring-and-useful-php-snippets](http://phpmaster.com/5-inspiring-and-useful-php-snippets)）。但是为了让你开始，这里的代码应该可以工作：

```
<?php
$context = stream_context_create(array(
        "http" => array(
            "method" => "POST",
            "header" => "Content-Type: multipart/form-data; boundary=--foo\r\n",
            "content" => "--foo\r\n"
                . "Content-Disposition: form-data; name=\"myFile\"; filename=\"image.jpg\"\r\n"
                . "Content-Type: image/jpeg\r\n\r\n"
                . file_get_contents("image.jpg") . "\r\n"
                . "--foo--"
        )
    ));

    $html = file_get_contents("http://example.com/upload.php", false, $context); 
```

In situations like these it helps to make a mock web form and run it through Firefox with firebug enabled or something, and then inspect the request that was sent. From there you can deduce the important things to include.

# sql - PIVOT 分层数据

> ID：11227924
> 
> 赞同：4
> 
> 时间：2012-06-27T13:57:45.983
> 
> 标签：sql, sql-server, pivot

我有一张这样的桌子：

```
ID 名称 parentId
--------------------------------
5 滚筒 2
2 油漆和刷子 1
1 装饰 NULL

```

使用 PIVOT 或任何其他单个查询，我可以获得如下输出：

```
cat1id cat1name cat2id cat2name cat3id cat3Name
-------------------------------------------------- ----------------------
1 装饰 2 油漆和刷子 5 滚筒

```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-09T14:22:46.353

您可以使用`PIVOT`,`UNPIVOT`和递归查询来执行此操作。

静态版本，是您将值硬编码到转换后的位置：

```
;with hd (id, name, parentid, category)
as
(
  select id, name, parentid, 1 as category
  from yourtable
  where parentid is null
  union all
  select t1.id, t1.name, t1.parentid, hd.category +1
  from yourtable t1
  inner join hd
    on t1.parentid = hd.id
),
unpiv as
(
  select value, 'cat_'+cast(category as varchar(5))+'_'+ col col_name
  from
  (
    select cast(id as varchar(17)) id, name, parentid, category
    from hd
  ) src
  unpivot
  (
    value for col in (id, name)
  ) un
)
select [cat_1_id], [cat_1_name],
                   [cat_2_id], [cat_2_name],
                   [cat_3_id], [cat_3_name]
from unpiv
pivot
(
  max(value)
  for col_name in ([cat_1_id], [cat_1_name],
                   [cat_2_id], [cat_2_name],
                   [cat_3_id], [cat_3_name])
) piv 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/1ab32/18)

动态版本，值在运行时生成：

```
;with hd (id, name, parentid, category)
as
(
  select id, name, parentid, 1 as category
  from yourtable
  where parentid is null
  union all
  select t1.id, t1.name, t1.parentid, hd.category +1
  from yourtable t1
  inner join hd
    on t1.parentid = hd.id
)
select category categoryNumber
into #temp
from hd

DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + quotename('cat_'+cast(CATEGORYNUMBER as varchar(10))+'_'+col) 
                  from #temp
                  cross apply (select 'id' col
                               union all 
                               select 'name' col) src
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = ';with hd (id, name, parentid, category)
              as
              (
                select id, name, parentid, 1 as category
                from yourtable
                where parentid is null
                union all
                select t1.id, t1.name, t1.parentid, hd.category +1
                from yourtable t1
                inner join hd
                  on t1.parentid = hd.id
              ),
              unpiv as
              (
                select value, ''cat_''+cast(category as varchar(5))+''_''+ col col_name
                from
                (
                  select cast(id as varchar(17)) id, name, parentid, category                 
                  from hd
                ) src
                unpivot
                (
                  value for col in (id, name)
                ) un
              )
              select '+@cols+'
              from unpiv
              pivot
              (
                max(value)
                for col_name in ('+@cols+')
               ) piv'

execute(@query)

drop table #temp 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/1ab32/17)

两者的结果相同：

```
| CAT_1_ID | CAT_1_NAME | CAT_2_ID |        CAT_2_NAME | CAT_3_ID | CAT_3_NAME |
--------------------------------------------------------------------------------
|        1 | Decorating |        2 | Paint and Brushes |        5 |    Rollers | 
```

# vb.net - 使用 VB 2010 从 Excel 中捕获弹出窗口、警报和异常

> ID：11227938
> 
> 赞同：1
> 
> 时间：2012-06-27T13:58:50.473
> 
> 标签：vb.net, excel, exception, popup, alerts

这是我第一次在 stackoverflow 上发帖。我昨天开始学习 VB 2010（虽然我确实知道一些 Ruby），并且在谷歌上搜索了很多这个问题，但没有找到太多。

我编写了一个程序，它采用 CSV 文件路径列表（所有 .XLS 文件）并尝试打开它们。这些 Excel 工作簿被另一个程序标记为不可读；我的程序尝试捕获导致错误的警告、弹出窗口或异常。它适用于大多数例外情况（密码保护、不可读的内容、危险文件等），但不会捕获一些需要您单击“确定”按钮才能继续的弹出窗口。也许它们没有被归类为例外或其他东西，我很想知道。至少获得它们的文本形式会很棒。这是我的脚本：

```
Private Sub runReportButton_Click(ByVal sender As System.Object, ByVal e As        System.EventArgs) Handles runReportButton.Click
    Dim Exl As New Excel.Application()
    Exl.Visible = False
    Exl.DisplayAlerts = False

    For Each row As DataGridViewRow In dgvReport.Rows
        If Not IsNothing(row.Cells(0).Value) Then
            If row.Cells(0).Value.ToString.Contains(".xls") Then

                Try
                    'Open the workbook and attempt to catch the error!'
                    'Use bogus passwords to cause Password Protected Error, Readonly disabled so the Password popup shows.  Update links disabled because it wasn't being caught anyways'
                    Dim wb As Excel.Workbook = Exl.Workbooks.Open(row.Cells(0).Value.ToString, [ReadOnly]:=False, [WriteResPassword]:="WWWWWWWWWWW", [Password]:="WWWXWXWWWXW", [UpdateLinks]:=False)
                    row.Cells(4).Value = "Could not catch an error :("
                    wb.Close(0)
                    dgvReport.Refresh()
                Catch ex As Exception
                    'Writes the Exception Message to the data grid view'
                    row.Cells(4).Value = ex.Message
                End Try
                ProgressBar1.Value += 1
            End If
        End If
        Exl.Quit()
    Next row
    dgvReport.Refresh()
End Sub 
```

我遇到问题的原因是某些弹出窗口仅在我手动打开文件时才会出现。即使 Excel 设置为可见并显示警报，以编程方式打开和关闭文件也不会出现任何弹出窗口。一个特别的警告如下：

> “此工作簿中的一个或多个工作表的名称包含方括号：[]。为避免在引用这些工作表时出现意外结果，请从其名称中删除任何方括号。”

这似乎不是一个致命错误，但它会导致其他程序将其标记为不可读，因为我们无法确定内容的完整性（即意外结果）。所以我需要的不是忽略这些弹出窗口或改进其他程序，而是捕获这个讨厌的弹出消息。如果有人可以阐明此弹出窗口行为的二元性或提供不同的方法来捕获警报，将不胜感激！

# python - 在linux上使用python将文件写入usb

> ID：11227943
> 
> 赞同：5
> 
> 时间：2012-06-27T13:59:01.613
> 
> 标签：python, file, usb

如果问题如此愚蠢，我深表歉意，但我是 linux 和 python 的新手。关键是我需要编写一个 python 脚本来检测连接的 USB 棒并向其写入文件。我使用opensuse（但脚本应该适用于任何Linux发行版。在理想情况下）。当前版本可以检测 USB 并在该 USB 已安装时写入文件。但是只有当我在文件管理器中浏览它时，才会在我的机器上安装 USB。直到那个 USB 被检测为一个分区但没有挂载点。那么，如何强制系统挂载 USB，或者如何使用 devname 或 devpath 或我可以从 hal 管理器获得的其他信息写入文件。我不能使用“mount”命令，因为它需要root权限

简化的源代码：

```
import dbus, gobject, os

class DeviceAddedListener:
    def __init__(self):
        self.bus = dbus.SystemBus()
        self.hal_manager_obj = self.bus.get_object( "org.freedesktop.Hal", "/org/freedesktop/Hal/Manager")
        self.hal_manager = dbus.Interface(self.hal_manager_obj, "org.freedesktop.Hal.Manager")
        self.hal_manager.connect_to_signal("DeviceAdded", self.added)

    def show(self, name, udi):
        d_object = self.bus.get_object('org.freedesktop.Hal', udi)
        d_interface = dbus.Interface(d_object,'org.freedesktop.Hal.Device')

        if d_interface.QueryCapability("volume"):
            print name
            props = [ "block.device", "volume.label",  "volume.is_mounted", "volume.mount_point", "volume.size"]
            for p in props:
                print '\t', p, " = ",
                try:
                    print d_interface.GetProperty(p)
                except:
                    print "Fail"

    def added(self, udi): 
        self.show("DeviceAdded", udi)
        self.bus.add_signal_receiver(self.property_modified,
            "PropertyModified",
            "org.freedesktop.Hal.Device", 
            "org.freedesktop.Hal",
            udi,
            path_keyword = "sending_device" )

    def property_modified(self, numupdates, updates, sending_device = None): 
        self.show("PropertyModified", sending_device) 

if __name__ == '__main__':
    from dbus.mainloop.glib import DBusGMainLoop
    DBusGMainLoop(set_as_default=True)
    loop = gobject.MainLoop()
    DeviceAddedListener()
    print "running"
    loop.run() 
```

usb插入时的输出

```
DeviceAdded
block.device  =  /dev/sdb1
volume.label  =  @
volume.is_mounted  =  0
volume.mount_point  =  
volume.size  =  4009722368 
```

usb插入并挂载时的输出

```
 block.device  =  /dev/sdb1
volume.label  =  @
volume.is_mounted  =  1
volume.mount_point  =  /media/@
volume.size  =  4009722368 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T14:54:01.760

您将不得不使用`mount`，因为出于安全原因，内核控制操作系统中的挂载分区。您*可以*在没有超级用户/管理员权限的情况下使用 mount。尝试这样的事情：

确保`/mnt/usb1/`您要挂载到的目录 ( ) 已经存在，然后

```
mount /dev/sdb1 /mnt/usb1 -o noauto,users,rw,umask=0 
```

还有一个叫做 autofs 的东西允许自动挂载：

[http://linuxconfig.org/automatically-mount-usb-external-drive-with-autofs](http://linuxconfig.org/automatically-mount-usb-external-drive-with-autofs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T02:48:41.267

HAL 它已停产，我认为最好使用 UDisk 与笔 USB 配合使用。然后，您可以使用方法 FilesystemMount 和 FilesystemUnmount，我在这里创建一个示例（https://gist.github.com/3037221）并在此处进行官方文档（http://hal.freedesktop.org/docs/udisks/Device. html#Device.FilesystemMount）。

# java - Hashmap EmployeeStore 的编辑方法

> ID：11227944
> 
> 赞同：1
> 
> 时间：2012-06-27T13:59:03.163
> 
> 标签：java, methods, hashmap, edit

我正在制作一个 EmployeeStore，它将存储姓名、dob、id、电子邮件地址等......我需要编写一个编辑方法。我已经用谷歌搜索了，但我找不到如何做到这一点，有人可以帮忙吗？这是我的代码：

```
//Imports.
import java.util.Scanner;
//********************************************************************  
public class MainApp
{
    private static Scanner keyboard = new Scanner(System.in);

    public static void main(String[] args)
    {
        new MainApp().start();

    }
    public void start()
    {
        EmployeeStore Store = new EmployeeStore();
        Store.add(new Employee ("James O' Carroll", 18,"hotmail.com"));

        Store.add(new Employee ("Andy Carroll", 1171,"yahoo.com"));

        Store.add(new Employee ("Luis Suarez", 7,"gmail.com"));
//Test Code with the new Hashmap.       
        /*Store.print();
        Store.clear();
        Store.print();

        Store.add(new Employee ("James O' Carroll", 18,"hotmail.com"));

        Store.add(new Employee ("Andy Carroll", 1171,"yahoo.com"));

        Store.add(new Employee ("Luis Suarez", 7,"gmail.com"));

        Store.print();
        Store.remove("Andy Carroll");
        Store.print();*/
//********************************************************************  
        //Switch Statement for use of a menu.
         int choice;
            do {
                choice = getMenuChoice("1.\tLibrarian\n2.\tPublic User\n3.\tExit\n\n", 3, "Please enter choice:", "Error [1,3] only");
                switch (choice) {
                    case 1:
                        System.out.println("Librarian Functionality...\n");
                        break;
                    case 2:
                        System.out.println("Public User functionality...\n");

                        break;
                    case 3:
                        System.out.println("Program Finished");

                }
            }
            while (choice != 3);
}
//********************************************************************  
      public static int getMenuChoice(String menuString, int limit, String prompt, String errorMessage) 
      {
            System.out.println(menuString);
            int choice = inputAndValidateInt(1, limit, prompt, errorMessage);
            return choice;
       }
//********************************************************************  

        public static int inputAndValidateInt(int min, int max, String prompt, String errorMessage) {
            int number;
            boolean valid;
            do {
                System.out.print(prompt);
                number = keyboard.nextInt();
                valid = number <= max && number >= min;
                if (!valid) {
                    System.out.println(errorMessage);
                }
            } while (!valid);
            return number;
        }
//********************************************************************  
}

//Imports:

//********************************************************************
//Employee Class.
public class Employee
{
//Variables.
    private String employeeName;
    private int employeeId;
    private String employeeEmail;
//********************************************************************  
//Constructor.
    public Employee(String employeeName, int employeeId, String employeeEmail) 
    {
        this.employeeName = employeeName;
        this.employeeId = employeeId;
        this.employeeEmail = employeeEmail;
    }
//********************************************************************
//Getters.
    public String getEmployeeEmail() {
        return employeeEmail;
    }
    public void setEmployeeEmail(String employeeEmail) {
        this.employeeEmail = employeeEmail;
    }
    public String getEmployeeName() {
        return employeeName;
    }
    public int getEmployeeId() {
        return employeeId;
    }
//********************************************************************
//toString method.
    public String toString() {
        return "Employee [employeeName=" + employeeName + ", employeeId="
                + employeeId + ", employeeEmail=" + employeeEmail + "]";
    }
//********************************************************************

}
//Imports.
import java.util.HashMap;
//********************************************************************
import java.util.Map;

public class EmployeeStore 
{
    HashMap<String, Employee> map;

//Constructor.  
    public EmployeeStore()
    {
        map = new HashMap<String,Employee>();
    }
//********************************************************************
//Hashmap Methods.
//Add to the Hashmap : Employee.
    public void add(Employee obj)
    {

        map.put(obj.getEmployeeName(), obj);
    }
//********************************************************************
//Remove from the Hashmap : Employee.
    public void remove(String key)
    {
      //Remove the Employee by name.
        map.remove(key);
    }
//********************************************************************
//Clear the Hashmap : Employee.
    public void clear()
    {
        map.clear();
    }
    //********************************************************************
//Print the Hashmap : Employee. 
    public void print()
    {
        System.out.println("\n********Employee's in the Company.********");
        for (Employee employee : map.values())
        {
            System.out.println("Employee Name:\t" + employee.getEmployeeName());
            System.out.println("Employee Id:\t" + employee.getEmployeeId());
            System.out.println("E-mail:\t"+ employee.getEmployeeEmail());
        }

    }

//********************************************************************  
//********************************************************************

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T14:04:14.230

您需要从 HashMap 中获取 Employee 对象，然后修改该对象。例如，要更改电子邮件：

```
//in class EmployeeStore
String email = somehowGetNewEmail();
Employee toEdit = map.get(somehowGetName());
toEdit.setEmail(email) 
```

交替：

```
//in EmployeeStore
public Employee get(String name){
    return map.get(name);
}

//in any class with reference to an EmployeeStore "store"
store.get(name).editSomething(something); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T14:08:16.650

HashMap 存储对对象的引用。这意味着当您从 HashMap 读取（“获取”）对象并对其属性进行更改时，更改将被保留，而无需您将其写回 HashMap。

因此，您所要做的所有编辑方法就是调用 map.get(name) 并对返回的 Employee 对象进行更改。请注意，您不能以这种方式更改 HashMap 的键。为了“重命名”员工，您必须从哈希映射中删除旧键的值并将其插入到新键下。

# android - 微调器侦听器不起作用

> ID：11227951
> 
> 赞同：0
> 
> 时间：2012-06-27T13:59:20.223
> 
> 标签：android

我的应用程序因此代码而崩溃.. 它甚至无法启动.. 任何想法，谢谢我的应用程序因此代码而崩溃.. 它甚至无法启动.. 任何想法，谢谢

```
package com.about.bysk;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemSelectedListener;
import android.widget.Spinner;
import android.widget.Toast;

public abstract class AboutActivity extends Activity implements
        OnItemSelectedListener {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        Spinner spinner = (Spinner) findViewById(R.id.spin);
        spinner.setOnItemSelectedListener(new OnItemSelectedListener() {

            public void onItemSelected(AdapterView<?> arg0, View arg1,
                    int arg2, long arg3) {
                Toast.makeText(null, "a", 5);

            }

            public void onNothingSelected(AdapterView<?> arg0) {
                // TODO Auto-generated method stub

            }
        });
    }
} 
```

这使我的应用程序崩溃。请帮忙..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:01:07.140

你必须`Listener`为你的微调器设置，你的类必须实现`OnItemSelectedListener`

```
public class YourClass extends Activity implements OnItemSelectedListener { ... } 
```

然后你必须`Listener`为你的微调器设置：

```
spinner.setOnItemSelectedListener(this); 
```

或者你可以像匿名类一样使用它

```
spinner.setOnItemSelectedListener(new OnItemSelectedListener() {
    @Override
    public void onItemSelected(AdapterView<?> parentView, View selectedItemView, int position, long id) { ... }

    @Override
    public void onNothingSelected(AdapterView<?> parentView) { ... }
}); 
```

**注意：**如果要显示 Toast，必须调用`show()`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T14:01:24.323

您还没有将 lisnter 设置为 spinner

根据您的代码执行以下操作...

1-公共类 AboutActivity 扩展 Activity `implement OnItemSelectedListener`{

2-微调器。`setOnItemSelectedListener(this)`;

3- Toast.makeText(AboutActivity.this,"RootBox",Toast.LENGTH_LONG)。`show()`;

您不能将 null 作为上下文传递给 Toast

```
Toast.makeText(AboutActivity.this, "a", Toast.LENGTH_LONG).show(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T14:03:52.083

你忘了 setlistner ......你也用 toast 调用 show 方法！

# objective-c - 在 UIResponder 链上发送事件？

> ID：11227953
> 
> 赞同：1
> 
> 时间：2012-06-27T13:59:26.060
> 
> 标签：objective-c, ios, events, uiresponder

我刚刚创建了一个自定义 UIViewController，其中包含一些用户操作，例如触摸。我想处理 parentObject 中的用户交互。换句话说，创建 ViewController 的那个。

在其他语言中，我习惯于使用向上推送的事件。所以我的父对象会在 ViewController 对象的引用上有某种监听器，它可以对它做出反应。

Objective C 将如何处理这种类型的交互？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T14:03:43.673

这可以通过 1) 响应者链、2) 通知和 3) 委托来完成。

1.  所有的 UI 对象都形成了响应者链，从当前聚焦的元素开始，然后是父视图，以此类推，通常直到应用程序对象。通过向 nib 中的特殊 First Responder 对象发送操作，您将把它扔到响应者链中，直到有人处理它。您可以使用这种机制来触发事件，而无需知道谁以及何时处理它们。这类似于 HTML 事件模型。

2.  NSNotificationCenter 发送的通知可以被任意数量的监听器接收。这是与例如 C# 事件最接近的模拟。

3.  委托是向单个对象发送事件的最简单机制。该类声明`delegate`了可以分配给任何对象的弱属性named，以及该对象应该实现的协议。许多类使用这种方法；主要问题是您不能以这种方式拥有多个听众。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T14:04:41.477

听起来您需要实现一个委托协议，这将允许您的“子”视图控制器与它的“父”进行通信

请参阅[http://developer.apple.com/library/ios/#documentation/General/Conceptual/DevPedia-CocoaCore/Delegation.html](http://developer.apple.com/library/ios/#documentation/General/Conceptual/DevPedia-CocoaCore/Delegation.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T14:03:06.617

您应该查看委托/委托以了解两个视图控制器之间的交互。你需要先了解它是如何工作的。

[https://developer.apple.com/library/mac/#documentation/General/Conceptual/DevPedia-CocoaCore/Delegation.html](https://developer.apple.com/library/mac/#documentation/General/Conceptual/DevPedia-CocoaCore/Delegation.html)

# ios - iPhone/iOS 的 PhoneGap/Cordova Barcodescanner 插件

> ID：11227955
> 
> 赞同：1
> 
> 时间：2012-06-27T13:59:36.993
> 
> 标签：ios, cordova, phonegap-plugins, barcode

我在为 iPhone 上的 Phonegap 集成条形码扫描器插件时遇到了一些麻烦。我从这个 github 存储库获得了我的插件：

[https://github.com/phonegap/phonegap-plugins/](https://github.com/phonegap/phonegap-plugins/)

我遵循了说明中的所有步骤，包括将所有相关源添加到项目的构建路径的步骤。我也关闭了自动引用计数。我认为每个文件都在正确的位置，但无论如何我都遇到了这个错误：

```
Undefined symbols for architecture armv7:
  "_OBJC_CLASS_$_ALAssetsLibrary", referenced from:
  objc-class-ref in CDVBarcodeScanner.o
  "_CVPixelBufferGetBytesPerRow", referenced from:
  -[CDVbcsProcessor getLuminanceSourceFromSample:imageBytes:] in CDVBarcodeScanner.o
  -[CDVbcsProcessor getImageFromSample:] in CDVBarcodeScanner.o
  "_CVPixelBufferUnlockBaseAddress", referenced from:
  -[CDVbcsProcessor getLuminanceSourceFromSample:imageBytes:] in CDVBarcodeScanner.o
  -[CDVbcsProcessor getImageFromSample:] in CDVBarcodeScanner.o
  "_CVPixelBufferGetHeight", referenced from:
  -[CDVbcsProcessor getLuminanceSourceFromSample:imageBytes:] in CDVBarcodeScanner.o
  -[CDVbcsProcessor getImageFromSample:] in CDVBarcodeScanner.o
  "_kCVPixelBufferPixelFormatTypeKey", referenced from:
  -[CDVbcsProcessor setUpCaptureSession] in CDVBarcodeScanner.o
  "_CVPixelBufferGetBaseAddress", referenced from:
  -[CDVbcsProcessor getLuminanceSourceFromSample:imageBytes:] in CDVBarcodeScanner.o
  -[CDVbcsProcessor getImageFromSample:] in CDVBarcodeScanner.o
  "_CVPixelBufferLockBaseAddress", referenced from:
  -[CDVbcsProcessor getLuminanceSourceFromSample:imageBytes:] in CDVBarcodeScanner.o
  -[CDVbcsProcessor getImageFromSample:] in CDVBarcodeScanner.o
  "_CVPixelBufferGetWidth", referenced from:
  -[CDVbcsProcessor getLuminanceSourceFromSample:imageBytes:] in CDVBarcodeScanner.o
  -[CDVbcsProcessor getImageFromSample:] in CDVBarcodeScanner.o
ld: symbol(s) not found for architecture armv7
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

当我尝试插件的测试项目时，我努力将其部署到 iphone，但是当我按下“扫描”时，我收到一个错误，即缺少 cordova-1.7.0.js 文件。我正在使用 xcode 4，并且在 xCode 上安装了 cordova 1.7.0。在网上我找不到解决方案或类似问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T00:26:39.600

将以下库添加到您的 Xcode 项目中：

AVFoundation.framework

AssetsLibrary.framework

**CoreVideo.framework**

**libiconv.dylib**

选择您的目标，然后显示构建阶段。在 Link Binary With Libraries 下，单击添加按钮，然后选择上面的框架。

以粗体列出的库是导致此错误发生的原因。[这是从https://github.com/phonegap/phonegap-plugins/tree/master/iOS/BarcodeScanner](https://github.com/phonegap/phonegap-plugins/tree/master/iOS/BarcodeScanner)找到的说明的摘录

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T15:04:21.127

我更新到 xCode 4.3.3，然后错误消失了。也许错误是由于错误而发生的。插件仍然无法正常工作，但我认为这是另一个原因，不再与此问题相关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T15:44:54.317

根据[https://groups.google.com/forum/?fromgroups#!topic/phonegap/D5R450L5kLI](https://groups.google.com/forum/?fromgroups#!topic/phonegap/D5R450L5kLI)上的讨论，您可能已经完成了我刚才所做的事情。在您的目标设置的构建阶段下，有 2 组 Link Binary With Libraries。我正在添加到较低的空的。将所有库添加到上面的非空库修复它。

# r - R.oo 包不会安装在 RStudio 服务器上

> ID：11227965
> 
> 赞同：1
> 
> 时间：2012-06-27T14:00:00.753
> 
> 标签：r, rstudio

我对 RStudio 服务器上的 R.oo 包安装失败感到困惑，知道如何解决它吗？

```
Installing package(s) into ‘/home/rstudio/R/library’
(as ‘lib’ is unspecified)
trying URL 'http://ftp.heanet.ie/mirrors/cran.r-project.org/src/contrib/R.oo_1.9.3.tar.gz'
Content type 'application/x-gzip' length 372217 bytes (363 Kb)
opened URL
==================================================
downloaded 363 Kb

* installing *source* package ‘R.oo’ ...
** package ‘R.oo’ successfully unpacked and MD5 sums checked
** R
** inst
** preparing package for lazy loading
Error in match(el, set, 0L) : object 'R.KEYWORDS' not found
Error : unable to load R code in package ‘R.oo’
ERROR: lazy loading failed for package ‘R.oo’
* removing ‘/home/rstudio/R/library/R.oo’
Warning in install.packages :
  installation of package ‘R.oo’ had non-zero exit status 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T19:47:59.690

截至昨晚：我可以在两个不同的 RStudio 服务器上确认这个问题，一个运行 R.2.14.1，另一个运行 R.2.15.1，所以它不是 R 版本。一个是我们的 linux 服务器，另一个是 amazon EC2 服务器。在本地 RStudio（OSX；R.2.15.0）上安装也没问题。

但是：截至一个小时前，这个问题已经消失了。在两个 RStudio 服务器上，R.oo 现在都可以正常安装。所以，再试一次！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T08:48:00.853

根据 R.oo 和 R.KEYWORDS 软件包的作者，R.KEYWORDS 的最新版本（v1.4.2）和 R.oo 之间存在不兼容（cran 版本 1.9.3 不兼容，不是最后一个一个 v1.9.8)。他最近纠正了这一点。

# ruby - Ruby 奇怪的场景打开存储在变量中的目录

> ID：11227968
> 
> 赞同：1
> 
> 时间：2012-06-27T14:00:20.177
> 
> 标签：ruby, file, directory

我有一个 Ruby 脚本，它打开一个目录并将内容打印到屏幕上：

```
rootDir = '/Users'
puts rootDir

Dir.foreach(rootDir) do |folder|
  next if folder == '.' or folder == '..'

  puts folder if(File.directory? rootDir+'/'+folder)

end 
```

当我在终端中运行它时，我收到以下错误：

```
/Users
imager.rb:77:in `open': No such file or directory - /Users (Errno::ENOENT)
from imager.rb:77:in `foreach'
from imager.rb:77 
```

第 77 行是 Dir.foreach 行。但是当我运行以下代码时，它可以完美运行：

```
rootDir = '/Users'
puts rootDir

Dir.foreach('/Users') do |folder|
  next if folder == '.' or folder == '..'

  puts folder if(File.directory? '/Users'+'/'+folder)

end 
```

似乎文件夹路径存储在rootDir中时，找不到该文件夹​​。有任何想法吗？/Users 与脚本不在同一目录中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:03:09.503

刚刚想出了解决办法。文件夹 /Users 是从终端读取的，并存储在一个文件中。当我从终端读取它时，我做了一个 .chomp，但是当我将它存储在一个文件中时，我将 \n 保留在最后。从文件中读取它把它放回最后。哎呀。

# c# - 通过 C# 和德语变音符号 (Ä,Ü,Ö,ä,ü,ö) 导入 DOS-CSV

> ID：11227972
> 
> 赞同：1
> 
> 时间：2012-06-27T14:00:23.270
> 
> 标签：c#, excel, csv, utf-8

我有以下问题：我有一些**Excel 表格**，必须将它们导出为**DOS-CSV**格式（出于某些原因）。结果是，德语变音符号**(Ä,Ü,Ö,ä,ü,ö)**未正确导出。在下一步中，必须将这些 CSV 文件导入**Winform 应用程序**。现在是否可以在导入期间取回正确的字符 Ä,Ü,Ö,ä,ü,ö？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T15:12:06.377

# php - Symfony 2 使用 POST 重定向

> ID：11227975
> 
> 赞同：17
> 
> 时间：2012-06-27T14:00:44.060
> 
> 标签：php, symfony, request

在 Symfony 2 中，我的控制器中有以下代码：

```
// prepare to render the seller info panel
$response = array(
    'data' => $data,
);

// render the seller info panel
return $this->redirect($this->generateUrl('route', $response)); 
```

路线是：

```
route:
    pattern:  /listing/complete/{data}
    defaults: { _controller: FooBundle:Foo:action }
    requirements:
        _method:  POST 
```

这不起作用，因为重定向正在发出 GET 请求。我也尝试过这种模式，但它与路线不匹配：

```
route:
    pattern:  /listing/complete
    defaults: { _controller: FooBundle:Foo:action }
    requirements:
        _method:  POST 
```

我发现路由文档没有帮助。有没有办法让重定向发出 POST 请求？路线会是什么样子，我是否必须在控制器中做任何事情才能实现？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2015-06-24T16:26:31.930

进行 POST 请求重定向的最新方法（从**Symfony 2.6**开始）很简单：

```
return $this->redirectToRoute('route', [
    'request' => $request
], 307); 
```

代码`307`保留了请求方法，同时`redirectToRoute()`是一种快捷方式。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-27T14:07:37.007

重定向 POST 请求是不可能的，因为浏览器必须重新发送 POST 数据（它不会）。在这种情况下，您应该做的是使用[转发。](http://symfony.com/doc/current/book/controller.html#forwarding-to-another-controller)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-21T18:00:51.657

当我使用`$this->generateUrl`传递的参数时，我遇到了同样的错误。但是，当我尝试这样做时，我的重定向有效：

```
$this->get('router')->generate('route_name', array('param1' => 'paramVal')) 
```

（我知道它现在对你没有多大帮助。）

# security - Symfony2：“jms_security_extra”错误下无法识别的选项“method_access_control”

> ID：11227977
> 
> 赞同：0
> 
> 时间：2012-06-27T14:00:53.657
> 
> 标签：security, symfony

所以我试图通过 JMSSecurityExtraBundle 为我的一些方法配置安全访问。我只是按照这里的说明进行操作：[JMSSecurityBundle Doc](http://jmsyst.com/bundles/JMSSecurityExtraBundle/master/method_security_authorization)。

我最终在我的 config.yml 文件中有这个：

```
jms_security_extra:
    secure_controllers:  true
    secure_all_services: false
    method_access_control:
        'MyBundle:.*:postEntityDelete': 'hasRole("ROLE_SUPER_ADMIN")' 
```

现在我只是得到了那个错误：

```
InvalidConfigurationException: Unrecognized options "method_access_control" under "jms_security_extra" 
```

我怎么可能错了这么少？问题在哪里，我该如何解决这个问题？

提前致谢！

编辑：

部门：

```
[JMSSecurityExtraBundle]
    git=https://github.com/schmittjoh/JMSSecurityExtraBundle.git
    target=/bundles/JMS/SecurityExtraBundle

[metadata]
    git=https://github.com/schmittjoh/metadata.git
    version=1.1.0 ; <- make sure to get 1.1, not 1.0

[JMSAopBundle]
    git=https://github.com/schmittjoh/JMSAopBundle.git
    target=/bundles/JMS/AopBundle

[cg-library]
    git=https://github.com/schmittjoh/cg-library.git

[JMSDiExtraBundle]
    git=https://github.com/schmittjoh/JMSDiExtraBundle.git
    target=/bundles/JMS/DiExtraBundle 
```

部门锁：

```
symfony v2.0.13
twig v1.7.0
monolog 1.0.2
doctrine-common 2.1.4
doctrine-dbal 2.1.6
doctrine 2.1.6
swiftmailer v4.1.7
assetic v1.0.3
twig-extensions 446d870272cd87a720e95242eade38a2acf56eaa
metadata 1.0.0
SensioFrameworkExtraBundle cb61b92ed55241d93ed9726bc3f5f47c7d2ce8fe
JMSSecurityExtraBundle e752f888c51425f71382c056961f10f2be642102
SensioDistributionBundle 20b66a408084ad8752f98e50f10533f5245310bf
SensioGeneratorBundle b1ccb78c1743f30817b0fce9bb5c6baff6ed7bf8
AsseticBundle v1.0.1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:31:24.650

你使用的是什么版本的 symfony 和 bundle？您链接的文档在 master 分支之后。左上角有更改版本的链接。1.0 似乎没有那个配置选项。

deps 文件应包含：

```
[JMSSecurityExtraBundle]
  git=http://github.com/schmittjoh/JMSSecurityExtraBundle.git
  target=/bundles/JMS/SecurityExtraBundle
  version=origin/master 
```

您还可以在此处查看遇到相同问题的其他人[https://github.com/schmittjoh/JMSSecurityExtraBundle/issues/24](https://github.com/schmittjoh/JMSSecurityExtraBundle/issues/24)

# ruby-on-rails - Rails ActiveRecord 查询扩展性差

> ID：11227983
> 
> 赞同：0
> 
> 时间：2012-06-27T14:01:17.303
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有以下 ActiveRecord 查询。在我的测试环境中消息数为 50 时运行良好，但当我们投入生产时，消息数增长到 5000 条时，响应时间接近 30 秒。不好。

我怎样才能更有效地进行此查询，因此随着消息数量的增加保持快速。如果尚未完成，查询会从所有消息中查找所有警报。

```
class AlertsController < ApplicationController
  before_filter :get_user
  respond_to :json, :html

 def index
    @messages = current_user.messages.where(:active => true).order("created_at ASC")

    @alerts = Array.new
    @messages.each do |message|
        if (message.alerts.count > 0)
          @alerts = @alerts + message.alerts.where(:completed => false)
        end
    end

    respond_to do |format|
      format.html
      format.json
    end
  end

end

class Alert < ActiveRecord::Base
    belongs_to :message

class Message < ActiveRecord::Base
  has_many :alerts, dependent: :destroy 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T14:20:49.200

根据 Jesse 的回答，更好的方法是创建一个仅选择 的范围`pending_alerts`，这样您可以传递更少的数据，并让数据库完成更多的工作。

```
class Message < ActiveRecord::Base
  scope :pending_alerts, lambda {
    alerts.where(:completed => false)
  }
} 
```

然后在控制器中：

```
@messages = current_user.messages.includes(:pending_alerts).where(:active => true).order("created_at ASC")  
@alerts = @messages.map { |m| m.alerts } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T14:08:15.400

这似乎是一个 n+1 问题。此处的文档（搜索[N + 1 个查询问题的解决方案](http://guides.rubyonrails.org/active_record_querying.html)）

```
@messages = current_user.messages.includes(:alerts).where(:active => true).order("created_at ASC") 
```

然后使@alerts 更简单：

```
@alerts = @messages.map do |message|
  message.alerts.select {|alert| !alert.completed}
end 
```

# r - 如何在 R 中以最小的努力为数据集中的所有变量创建直方图？

> ID：11227987
> 
> 赞同：8
> 
> 时间：2012-06-27T14:01:26.617
> 
> 标签：r, ggplot2, histogram

探索新数据集：可视化许多（所有）变量的最简单、最快捷的方法是什么？

理想情况下，输出显示彼此相邻的直方图，具有最小的混乱和最大的信息。这个问题的关键是处理大型和不同数据集的灵活性和稳定性。我正在使用 RStudio，通常处理大量杂乱的调查数据。

一个开箱即用`Hmisc`且效果很好的示例是：

```
library(ggplot2)
str(mpg)

library(Hmisc)
hist.data.frame(mpg) 
```

不幸的是，在其他地方我遇到了数据标签的问题（plot.new() 中的错误：数字边距太大）。对于更大的数据集，它也崩溃了`mpg`，我还没有弄清楚如何控制分箱。此外，我更喜欢`ggplot2`. 请注意，我刚刚开始学习 R，并且已经习惯了商业软件提供的舒适解决方案。

关于这个主题的更多问题：

[R 直方图 - 变量太多](https://stackoverflow.com/questions/6428432/r-histogram-too-many-variables)

...？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-27T14:01:27.133

可能有三种广泛的方法：

1.  来自软件包的命令，例如`hist.data.frame()`
2.  循环变量或类似的宏结构
3.  堆叠变量和使用构面

**套餐**

其他可能有用的可用命令：

```
library(plyr)
library(psych)
multi.hist(mpg) #error, not numeric
multi.hist(mpg[,sapply(mpg, is.numeric)]) 
```

或者可能`multhist`来自`plotrix`，我还没有探索过。它们都没有提供我一直在寻找的灵活性。

**循环**

作为 R 初学者，每个人都建议我远离循环。所以我做到了，但也许在这里值得一试。任何建议都非常受欢迎。也许您可以评论如何将图形组合到一个文件中。

**堆叠**

我的第一个怀疑是堆叠变量可能会失控。但是，对于一组合理的变量，这可能是最佳策略。

我想出的一个例子使用了这个`melt`函数。

```
library(reshape2)
mpgid <- mutate(mpg, id=as.numeric(rownames(mpg)))
mpgstack <- melt(mpgid, id="id")
pp <- qplot(value, data=mpgstack) + facet_wrap(~variable, scales="free")
# pp + stat_bin(geom="text", aes(label=..count.., vjust=-1))
ggsave("mpg-histograms.pdf", pp, scale=2) 
```

（如您所见，我尝试在条形上放置值标签以获得更多信息密度，但效果不佳。x 轴上的标签也不太理想。）

这里没有完美的解决方案，也不会有一刀切的命令。但也许我们可以更轻松地探索新的数据集。

# java - 在 Java 中存储枚举的顺序

> ID：11227990
> 
> 赞同：12
> 
> 时间：2012-06-27T14:01:28.817
> 
> 标签：java, algorithm, enums, guava

在 Java 中，EnumSet 使用`long`( `RegularEnumSet`) 或`long[]`( `JumboEnumSet`) 将其包含的项目存储在位掩码/位向量中。我现在遇到了一个用例，其中我有数千个域对象（让我们称之为它们），每个对象都将按照每个对象不同的顺序`Node`显示枚举的所有项目（让我们称之为）。`Flag`

目前我将 Order 存储为 Guava [`ImmutableSet`](https://google.github.io/guava/releases/23.0/api/docs/com/google/common/collect/ImmutableSet.html)，因为这样可以保证保留插入顺序。但是，我已使用[此页面上解释的方法](http://javaspecialists.co.za/archive/Issue029.html "确定 Java 中的内存使用情况")来比较 an `EnumSet<Flag>`、 an`ImmutableSet<Flag>`和 a中的内存使用情况`Flag[]`。以下是 a) Flag 有 64 个枚举项和 b) 所有三个变体都包含所有 64 个项时的结果：

> EnumSet：32 字节
> ImmutableSet：832 字节
> 数组：272 字节

所以我的问题是：有没有一种聪明的方法可以将枚举排序打包成一个数值，以获得小于数组的内存占用？如果它有所作为：在我的用例中，我会假设排序总是包含所有 Enum 项目。

澄清一下：我的枚举比那个小得多，到目前为止我没有任何内存问题，这种情况也不可能给我带来内存问题。只是这种低效率困扰着我，即使在这个微观层面上也是如此。

更新：

根据各种答案和评论的建议，我想出了这个使用字节数组的数据结构。警告：它没有实现 Set 接口（不检查唯一值），并且它不会扩展到超出一个字节可以容纳的大型枚举。此外，复杂性非常糟糕，因为 Enum.values() 必须反复查询（[有关此问题的讨论，请参见此处](http://code.google.com/p/guava-libraries/issues/detail?id=1022 "ImmutableList<E> enumUniverse()")），但这里有：

```
public class EnumOrdering<E extends Enum<E>> implements Iterable<E> {
    private final Class<E> type;
    private final byte[] order;

    public EnumOrdering(final Class<E> type, final Collection<E> order) {
        this.type = type;

        this.order = new byte[order.size()];

        int offset = 0;
        for (final E item : order) {
            this.order[offset++] = (byte) item.ordinal();
        }

    }

    @Override
    public Iterator<E> iterator() {
        return new AbstractIterator<E>() {
            private int offset = -1;
            private final E[] enumConstants = type.getEnumConstants();

            @Override
            protected E computeNext() {
                if (offset < order.length - 1) {
                    return enumConstants[order[++offset]];
                }
                return endOfData();
            }
        };
    }
} 
```

内存占用为：

> 枚举排序：104

到目前为止，这是一个相当不错的结果，这要感谢 bestsss 和 JB Nizet！

更新：我已将代码更改为仅实现 Iterable，因为其他任何事情都需要对 equals / hashCode / contains 等进行合理的实现。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T17:16:52.173

> 有没有一种聪明的方法可以将枚举排序打包成一个数值

是的，您可以将排序表示为数值，但要使用它，您需要转换回字节/整数数组。而且因为有64个！64 个值和 64 个可能的排序！大于`Long.MAX_VALUE`，您需要将数字存储在`BigInteger`. 我想这将是存储排序的最节省内存的方式，尽管由于必须将数字转换为数组，您在内存中获得的东西会丢失时间。

有关在数字/数组表示之间进行转换的算法，请参阅[此问题](https://stackoverflow.com/questions/1506078/fast-permutation-number-permutation-mapping-algorithms)。

这是上面的替代方案，不知道它是否像那个一样有效，并且您必须将代码从`int`基于- 的转换`BigInteger`，但它应该足以给您这个想法：

```
/**
   * Returns ith permutation of the n numbers [from, ..., to]
   * (Note that n == to - from + 1).
   * permutations are numbered from 0 to n!-1, if i is outside this
   * range it is treated as i%n! 
   * @param i
   * @param from
   * @param n
   * @return
   */
  public static int[] perm(long i, int from, int to)
  {
    // method specification numbers permutations from 0 to n!-1.
    // If you wanted them numbered from 1 to n!, uncomment this line.
    //  i -= 1;
    int n = to - from + 1;

    int[] initArr  = new int[n];             // numbers [from, ..., to]
    int[] finalArr = new int[n];             // permutation of numbers [from, ..., to]

    // populate initial array
    for (int k=0; k<n; k++)
      initArr[k] = k+from;

    // compute return array, element by element
    for (int k=0; k<n; k++) {
      int index = (int) ((i%factorial(n-k)) / factorial(n-k-1));

      // find the index_th element from the initial array, and
      // "remove" it by setting its value to -1
      int m = convertIndex(initArr, index);
      finalArr[k] = initArr[m];
      initArr[m] = -1;
    }

    return finalArr;
  }

  /** 
   * Helper method used by perm.
   * Find the index of the index_th element of arr, when values equal to -1 are skipped.
   * e.g. if arr = [20, 18, -1, 19], then convertIndex(arr, 2) returns 3.
   */
  private static int convertIndex(int[] arr, int index)
  {
    int m=-1;
    while (index>=0) {
      m++;
      if (arr[m] != -1)
        index--;
    }

    return m;
  } 
```

基本上，您从 init 数组的自然顺序开始，然后遍历您的最终数组，每次都计算接下来应该放置哪些剩余元素。此版本通过将值设置为 -1 从 init 数组中“删除”元素。`List`使用or可能更直观`LinkedList`，我刚刚从我周围的一些旧代码中粘贴了这个。

使用上述方法并以此为`main`：

```
public static void main(String[] args) {
    int n = (int) factorial(4);
    for ( int i = 0; i < n; i++ ) {
      System.out.format( "%d: %s\n", i, Arrays.toString( perm(i, 1, 4 ) ) );
    }
} 
```

您会得到以下输出：

```
0: [1, 2, 3, 4]
1: [1, 2, 4, 3]
2: [1, 3, 2, 4]
3: [1, 3, 4, 2]
4: [1, 4, 2, 3]
5: [1, 4, 3, 2]
6: [2, 1, 3, 4]
7: [2, 1, 4, 3]
8: [2, 3, 1, 4]
9: [2, 3, 4, 1]
10: [2, 4, 1, 3]
11: [2, 4, 3, 1]
12: [3, 1, 2, 4]
13: [3, 1, 4, 2]
14: [3, 2, 1, 4]
15: [3, 2, 4, 1]
16: [3, 4, 1, 2]
17: [3, 4, 2, 1]
18: [4, 1, 2, 3]
19: [4, 1, 3, 2]
20: [4, 2, 1, 3]
21: [4, 2, 3, 1]
22: [4, 3, 1, 2]
23: [4, 3, 2, 1] 
```

[这是 ideone 上的可执行版本](http://ideone.com/bq35C)。

判断`BigInteger.bitLength()`，应该可以在不超过 37 个字节中存储 64 个元素的排序（加上使用`BigInteger`实例的开销）。我不知道这是否值得麻烦，但它是一个很好的练习！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T14:19:33.983

如果您有 64 个枚举值，则可以使用字节数组，其中每个字节将包含枚举项之一的序号。这将需要`3 * (64 + 16) = 240`3 个 64 字节数组的字节（16 字节是字节数组的成本，无论其长度如何）。

这仍然会浪费空间，因为每个字节能够存储 8 位，但您只需要 6 来存储从 0 到 63 的数字。因此您可以应用一个巧妙的打包算法，使用 3 个字节（24 位）来存储 4 个枚举序数. 这将导致`3 * (64 * 3 / 4 + 16) = 192`字节。

我不擅长字节操作，所以我将把实现留给你作为练习。

# c++ - SSPI - 禁用 AES256 算法

> ID：11227991
> 
> 赞同：0
> 
> 时间：2012-06-27T14:01:30.207
> 
> 标签：c++, ssl, sspi

我想使用 SSPI(Schannel) 建立安全连接。
我不能用作 AES256 来加密套件。正如我在[这里](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379810%28v=vs.85%29.aspx)看到的，我必须定义自己的算法列表来禁用 AES256 密码套件，我将 ALG_ID 参数设置为 CALG_RSA_KEYX 芯片，但我在 Wireshark 捕获中看到我的应用程序仍然选择“TLS_RSA_WITH_AES_256_CBC_SHA”。

下面的代码片段显示了如何创建安全上下文。此代码取自[此处](http://www.coastrd.com/c-schannel-smtp)，我将其更改为采用算法列表，而不是使用默认的操作系统算法：

```
TimeStamp        tsExpiry;
SECURITY_STATUS  Status;
DWORD            cSupportedAlgs = 0;
ALG_ID           rgbSupportedAlgs[16];
PCCERT_CONTEXT   pCertContext = NULL;

certEnhkeyUsage.rgpszUsageIdentifier = usages; 

// Build Schannel credential structure. Currently, this sample only
// specifies the protocol to be used (and optionally the certificate, 
// of course). Real applications may wish to specify other parameters as well.
ZeroMemory( &SchannelCred, sizeof(SchannelCred) );

SchannelCred.dwVersion  = SCHANNEL_CRED_VERSION;

SchannelCred.grbitEnabledProtocols = dwProtocol;

rgbSupportedAlgs[0] = CALG_RSA_KEYX;
cSupportedAlgs++;
SchannelCred.cSupportedAlgs    = cSupportedAlgs;
SchannelCred.palgSupportedAlgs = rgbSupportedAlgs;

// Flags indicate the context behaviour.
SchannelCred.dwFlags |= SCH_CRED_NO_DEFAULT_CREDS;
SchannelCred.dwFlags |= SCH_CRED_AUTO_CRED_VALIDATION;

// Create an SSPI credential.
Status = g_pSSPI->AcquireCredentialsHandleA( NULL,                 // Name of principal    
                                             UNISP_NAME_A,         // Name of package
                                             SECPKG_CRED_OUTBOUND, // Flags indicating use
                                             NULL,                 // Pointer to logon ID
                                             &SchannelCred,        // Package specific data
                                             NULL,                 // Pointer to GetKey() func
                                             NULL,                 // Value to pass to GetKey()
                                             phCreds,              // (out) Cred Handle
                                             &tsExpiry );          // (out) Lifetime (optional)

if(Status != SEC_E_OK) printf("**** Error 0x%x returned by AcquireCredentialsHandle\n", Status);

return Status; 
```

有人可以解释一下为什么吗？为了禁用 AES_256，我该怎么做？

提前致谢。

# java - 灰度到二进制？

> ID：11227994
> 
> 赞同：1
> 
> 时间：2012-06-27T14:01:46.973
> 
> 标签：java, android, eclipse, binary, grayscale

我正在尝试将灰度图像转换为二进制。我的代码将位图转换为灰度，但我不知道如何将该图像转换为二进制。这是我目前拥有的代码。请帮我！！！谢谢！

```
package com.example.vanderbilt;

import android.app.Activity;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.ColorMatrix;
import android.graphics.ColorMatrixColorFilter;
import android.graphics.Paint;
import android.os.Bundle;
import android.widget.ImageView;

import org.opencv.android.Utils;
import org.opencv.core.Mat;
import org.opencv.imgproc.Imgproc;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory; 
```

公共类二进制扩展活动{

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.binary);
    ImageView img = (ImageView) findViewById(R.id.ivBinary);

    /*
     * Bitmap bmp = BitmapFactory.decodeResource(getResources(),
     * R.drawable.sample4); Bitmap bmpGray = toGrayscale(bmp);
     * img.setImageBitmap(bmpGray);
     */

    Bitmap bmp = BitmapFactory.decodeResource(getResources(),
            R.drawable.sample4);
    Mat imgToProcess = Utils.bitmapToMat(bmp);

    for (int i = 0; i < imgToProcess.height(); i++) {
        for (int j = 0; j < imgToProcess.width(); j++) {
            double y = 0.3 * imgToProcess.get(i, j)[0] + 0.59
                    * imgToProcess.get(i, j)[1] + 0.11
                    * imgToProcess.get(i, j)[2];
            imgToProcess.put(i, j, new double[] { y, y, y, 255 });
        }
    }

    int widthM, heightM, rowsM, colsM;
    colsM = imgToProcess.cols();
    rowsM = imgToProcess.rows();
    heightM = imgToProcess.height();
    widthM = imgToProcess.width();

    Bitmap bmpOut = Bitmap.createBitmap(imgToProcess.cols(),
            imgToProcess.rows(), Bitmap.Config.ARGB_8888);
    Utils.matToBitmap(imgToProcess, bmpOut);
    img.setImageBitmap(bmpOut);

}

    public Bitmap toGrayscale(Bitmap bmpOriginal) {
    int width, height;
    height = bmpOriginal.getHeight();
    width = bmpOriginal.getWidth();

    Bitmap bmpGrayscale = Bitmap.createBitmap(width, height,
            Bitmap.Config.RGB_565);
    Canvas c = new Canvas(bmpGrayscale);
    Paint paint = new Paint();
    ColorMatrix cm = new ColorMatrix();
    cm.setSaturation(0);
    ColorMatrixColorFilter f = new ColorMatrixColorFilter(cm);
    paint.setColorFilter(f);
    c.drawBitmap(bmpOriginal, 0, 0, paint);
    return bmpGrayscale;
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T07:11:46.627

我过去用 android 做了一些图像过滤，对于 ThresholdingFilter 我使用了这个代码：

```
public class ThresholdingFilter {

    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  METHODS  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    /**
     * Methods that apply a Thresholding Effect on image
     * 
     * @param imageIn the input image
     * @param threshold Integer - value (0-255)  prefered value (threshold = 125)
     * @return
     */ 

    public static AndroidImage process(AndroidImage imageIn, int threshold) {

        // The Resulting image
        AndroidImage imageOut;

        // Initiate the Output image
        imageOut = new AndroidImage(imageIn.getImage());

        // Do Threshold process
        for(int y=0; y<imageIn.getHeight(); y++){
            for(int x=0; x<imageIn.getWidth(); x++){

                if(imageOut.getRComponent(x,y) < threshold){
                    imageOut.setPixelColor(x, y, 0,0,0);
                }
                else{
                    imageOut.setPixelColor(x, y, 255,255,255);
                }               
            }
        }   

        // Return final image
        return imageOut;
    }

} 
```

AndroidImage 是 Android 位图的自定义包装类

```
public class AndroidImage {

     //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  ATTRIBUTES  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    // Original bitmap image
    private Bitmap image;

    // Format of the image (jpg/png)
    private String formatName;

    /** Dimensions of image */

    // Width of the image
    private int width;

    // Height of the image
    private int height;

    // RGB Array Color
    protected int[] colorArray;

    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  METHODS  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  

    /**
     * Constructor
     * 
     * @param img the Bitmap from which we create our AndroidImage Object 
     */

    public AndroidImage(Bitmap img){        
        this.image =  img;
        this.formatName = "jpg";
        this.width = img.getWidth();
        this.height = img.getHeight();
        updateColorArray();
    }

    /**
     * Method to reset the image to a solid color
     * 
     * @param color - color to reset the entire image to
     */

    public void clearImage(int color){
        for(int y=0; y<height; y++){
            for(int x=0; x<width; x++){
                image.setPixel(x, y, color);
            }
        }
    }

    /**
     * Method to set color array for image - called on initialization by constructor
     * 
     * 
     */

    private void updateColorArray(){
        colorArray = new int[width * height];
        image.getPixels(colorArray, 0, width, 0, 0, width, height);
        int r, g, b;
        for (int y = 0; y < height; y++){
            for (int x = 0; x < width; x++){
                int index = y * width + x;
                r = (colorArray[index] >> 16) & 0xff;
                g = (colorArray[index] >> 8) & 0xff;
                b = colorArray[index] & 0xff;
                colorArray[index] = 0xff000000 | (r << 16) | (g << 8) | b;
            }
        }
    }

    /**
     * Method to set the color of a specific pixel
     * 
     * @param x
     * @param y
     * @param color
     */

    public void setPixelColor(int x, int y, int color){
        colorArray[((y*image.getWidth()+x))] = color;
        image.setPixel(x, y, color);
    }

    /**
     * Method to get the color of a specified pixel
     * 
     * @param x
     * @param y
     * @return color
     */

    public int getPixelColor(int x, int y){
        return colorArray[y*width+x];
    }

    /**
     * Method to set the color of a specified pixel from an RGB combination
     * 
     * @param x
     * @param y
     * @param c0
     * @param c1
     * @param c2
     */

    public void setPixelColor(int x, int y, int c0, int c1, int c2){
        colorArray[((y*image.getWidth()+x))] = (255 << 24) + (c0 << 16) + (c1 << 8) + c2;
        image.setPixel(x, y, colorArray[((y*image.getWidth()+x))]);
    }

    /**
     * Method to get the RED color of a specified pixel 
     *  
     * @param x
     * @param y
     * @return color of R component
     */

    public int getRComponent(int x, int y){
        return (getColorArray()[((y*width+x))]& 0x00FF0000) >>> 16;
    }

    /**
     * Method to get the GREEN color of a specified pixel
     *  
     * @param x
     * @param y
     * @return color of G component
     */

    public int getGComponent(int x, int y){
        return (getColorArray()[((y*width+x))]& 0x0000FF00) >>> 8;
    }

    /**
     * Method to get the BLUE color of a specified pixel
     *  
     * @param x
     * @param y
     * @return color of B component
     */

    public int getBComponent(int x, int y){
        return (getColorArray()[((y*width+x))] & 0x000000FF);
    }

    /**
     * Method to rotate an image by the specified number of degrees
     * 
     * @param rotateDegrees
     */

    public void rotate (int rotateDegrees){
        Matrix mtx = new Matrix();
        mtx.postRotate(rotateDegrees);
        image = Bitmap.createBitmap(image, 0, 0, width, height, mtx, true);
        width = image.getWidth();
        height = image.getHeight();
        updateColorArray();
    }

     // Setters and Getters

    /**
     * @return the image
     */

    public Bitmap getImage() {
        return image;
    }

    /**
     * @param image the image to set
     */

    public void setImage(Bitmap image) {
        this.image = image;
    }

    /**
     * @return the formatName
     */

    public String getFormatName() {
        return formatName;
    }

    /**
     * @param formatName the formatName to set
     */

    public void setFormatName(String formatName) {
        this.formatName = formatName;
    }

    /**
     * @return the width
     */

    public int getWidth() {
        return width;
    }

    /**
     * @param width the width to set
     */

    public void setWidth(int width) {
        this.width = width;
    }

    /**
     * @return the height
     */

    public int getHeight() {
        return height;
    }

    /**
     * @param height the height to set
     */

    public void setHeight(int height) {
        this.height = height;
    }

    /**
     * @return the colorArray
     */

    public int[] getColorArray() {
        return colorArray;
    }

    /**
     * @param colorArray the colorArray to set
     */

    public void setColorArray(int[] colorArray) {
        this.colorArray = colorArray;
    }

} 
```

希望对你有帮助

# mysql - Innodb - 运行 INSERT INTO SELECT - 在整个事情完成之前不会显示记录吗？

> ID：11227995
> 
> 赞同：1
> 
> 时间：2012-06-27T14:01:47.753
> 
> 标签：mysql, sql, innodb

我有一个包含 2600 万条记录的表，并且想向其中添加一些列，所以我用添加的列创建了一个新表，然后做了一个 `INSERT INTO table_new SELECT (field1,field2) FROM table_old`

我被告知这比尝试向现有表中添加列要快。

无论如何，有 2600 万条记录，这需要很长时间，并且使用 MySQL Workbench 监视进程，我看到进程仍在运行（40 小时并且还在计数）。

但是，当我执行 a 时`SELECT * FROM table_new`，我还没有看到任何记录。使用 InnoDB，是否要等到整个事务完成后才能看到新表中的 2600 万条记录中的任何一条？或者我应该实时看到插入的记录吗？

我正在查看状态变量`Innodb_rows_inserted`，昨天它之前一直在稳定增长，我认为应该代表我从 0 到 2600 万的进度，但现在它固定在 1400 万并且不再实时增加：S，但我的`INSERT INTO SELECT`进程仍在运行。我担心出了什么问题。

如何检查一切是否按预期工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T14:55:39.450

如果您想在*运行时*跟踪大型提交的进度，您可以将 INSERT 作为过程运行。

这会增加一点开销，但是您可以在每 x 条记录后添加一个提交点（例如，在下面的示例中，每 100 条记录后提交）

注意：这是为 Oracle 编写的，因此您的里程可能会有所不同，但希望您能够根据自己的需要进行翻译。

```
declare
    v_counter       NUMBER := 0;
    cursor c_table_old is
        select *
        from table_old;
begin

    FOR l_table_old in c_table_old LOOP
        insert into table_new (field1, field2) 
        values (l_table_old.field1,
                l_table_old.field2);

        v_counter := v_counter + 1;

        IF (MOD(v_counter, 100) = 0) THEN
            commit;
        END IF;

    END LOOP;

end;
/ 
```

# java - 从特定标签下的网页中提取图像

> ID：11227997
> 
> 赞同：-7
> 
> 时间：2012-06-27T14:01:59.943
> 
> 标签：java, html, web, html-parsing, web-scraping

我想知道如何提取网页中特定标签下的所有图像。例如，如果它位于：

```
<div class="img-style">
<img src="http://blah.../x.jpg"> 
```

我想使用 JAVA 提取该特定 div 类下的所有图像。是否可能，任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T14:06:50.157

我喜欢这个用于抓取互联网[http://jsoup.org/](http://jsoup.org/)的库。我在大约 30 分钟内启动并运行了一个解析器，并且在我的空闲时间只写了 3 个月的 java。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T14:15:42.403

这里有其他很棒的 Java 的 HTML 抓取库：[TagSoup](http://home.ccil.org/~cowan/XML/tagsoup/)、[HTMLUnit](http://htmlunit.sourceforge.net/)、[Web-Harvest](http://web-harvest.sourceforge.net/)。使用库会比从头开始使用自己的库更快、更容易。下次提供一些你尝试过/看过的方法

# android - Android：EditText TextWatcher 中的无限循环

> ID：11227998
> 
> 赞同：0
> 
> 时间：2012-06-27T14:02:00.337
> 
> 标签：android, android-edittext

这段代码有两个问题。感谢上一个问题中的一些好人，我让它正常工作，但现在我再次看到自己处于无限循环中，我不知道这是从哪里来的。我在这里要做的是一个刽子手游戏：处理在 EditText (litera) 中读取的单个字符，然后在一个单词 (cuvAles) 中搜索它，然后我想用相应的字母替换下划线。

这是有问题的功能：

```
litera.addTextChangedListener(new TextWatcher(){
            public void afterTextChanged(Editable s) {}
            public void beforeTextChanged(CharSequence s, int start, int count, int after){}
            public void onTextChanged(CharSequence s, int start, int before, int count){
                 String ghici = litera.getText().toString();

                if(!ghici.equals("")){
                System.out.println(ghici);
                litera.setText("");

                if(cuvAles.contains(ghici)){
                    int poz = 0;
                    while(cuvAles.indexOf(ghici, poz)!= -1){
                        poz = cuvAles.indexOf(ghici);
                        String spatii = cuvant.getText().toString();
                        String spatii2 = spatii.substring(0, poz*2-1) + ghici + spatii.substring(poz*2+1, spatii.length()-2);
                        cuvant.setText(spatii2);
                    }
                }
                else gresite.append(ghici+" ");
                } 
            }   
        }); 
```

这里有两个问题：

1)`String spatii2 = spatii.substring(0, poz*2-1) + ghici + spatii.substring(poz*2+1, spatii.length()-1);`引发 StringIndexOutOfBounds 异常。我认为这是 spatii.length() 部分，但我尝试使用 -2 仍然无法正常工作。这个词与下划线不匹配的原因是我在它们之间有空格要清楚。

2）如果我删除另一个问题（用一个常量替换字符串），我会得到一个无限循环（我认为这是一个无限循环，因为程序停止响应并且我看到 logcat 中的 GC 疯狂地工作）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T14:19:44.250

在更新您的edittext之前删除文本更改侦听器，因为它将继续调用您的文本更改侦听器..

```
litera.addTextChangedListener(new TextWatcher(){
            public void afterTextChanged(Editable s) {}
            public void beforeTextChanged(CharSequence s, int start, int count, int after){}
            public void onTextChanged(CharSequence s, int start, int before, int count){
                 String ghici = litera.getText().toString();

     litera.removeTextChangedListener(this);            

                if(!ghici.equals("")){
                System.out.println(ghici);
                litera.setText("");

                if(cuvAles.contains(ghici)){
                    int poz = 0;
                    while(cuvAles.indexOf(ghici, poz)!= -1){
                        poz = cuvAles.indexOf(ghici);
                        String spatii = cuvant.getText().toString();
                        String spatii2 = spatii.substring(0, poz*2-1) + ghici + spatii.substring(poz*2+1, spatii.length()-2);
                        cuvant.setText(spatii2);
                    }
                }
                else gresite.append(ghici+" ");
                } 
            }   
        }); 
```

# mapping - DDD 更新集合或更新引用

> ID：11227999
> 
> 赞同：0
> 
> 时间：2012-06-27T14:02:00.490
> 
> 标签：mapping, domain-driven-design, relationship, updates

我仍然对ddd感到困惑，所以如果这没有意义，请原谅我。假设我有

```
public class Customer{
    public IList<Order> Orders{get;set;}  // should be encapsulated i know
}

public class Order{
    private Customer _readOnlyCustomer;
    public virtual Customer ReadOnlyCustomer { get { return _readOnlyCustomer; } }
    // possibly
    public virtual void SetCustomer(Customer customer) {_readOnlyCustomer = customer}
} 
```

首先，我正在做私有的 readonlyCustomer 业务，因为我的理解是一个聚合根不应该修改另一个聚合根，虽然我不能直接强制执行此操作来处理 fluentnhibernate 映射问题，但我至少可以以警告的方式命名它它是不可修改的。我什至可以在映射中将字段设为只读，这实际上会强制执行此操作，尽管考虑到我的下一个问题，这可能是一个问题，而且我不确定如何在客户方面强制执行此操作，因为我可以从customer.orders 收集并修改它。任何关于这个问题的想法都将受到欢迎。但我真正的问题是。

如果我要创建一个新订单。将客户设置在订单上并保存并让 nhibernate 更新 Customer.Orders 集合是否有意义，或者我应该将带有客户集的订单添加到 Customer.Orders 集合然后保存客户。

当我写这篇文章时，我意识到，我过去的做法是不让子代中引用父代，而只是更新父代上的集合。我认为这在 NH 中具有 db 调用优势，可以更轻松地处理保存，但更难遍历。现在我将对象视为 Ag Roots 或 Entities，我发现它有助于 Ag Roots 的遍历和自治，从而在集合和实例之间建立双向关系。

请帮助我了解使用哪种方式和/或我是否正确看待事物。谢谢， 雷夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T11:10:35.850

> // 应该封装我知道

由于强制封装可能会变得非常混乱，因此请随意放弃它。
依赖约定——注意应该修改什么以及在哪里修改。

> 公共虚拟客户 ReadOnlyCustomer

您的客户是否在谈论只读客户？我打赌不会。

> 如果我要创建一个新订单。将客户设置在订单上并保存并让 nhibernate 更新 Customer.Orders 集合是否有意义，或者我应该将带有客户集的订单添加到 Customer.Orders 集合然后保存客户。

您没有将客户设置为订单。您不会向客户添加订单。

客户订购产品。这反映了代码中的样子：

```
class customer
  method order(product)
    orders.Add(new Order(product)) 
```