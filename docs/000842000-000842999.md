# StackOverflow 问答 000842000-000842999

# c# - PowerBuilder 中的 .NET 互操作

> ID：842017
> 
> 赞同：4
> 
> 时间：2009-05-08T22:03:17.617
> 
> 标签：c#, .net, interop, powerbuilder

我正在寻找一种在 PB 对象和 .NET (C#) 对象之间进行双向通信的方法。在查看 Brad 的 GUI 控件的 .NET 版本时，我看到了如何为 .NET 对象提供对 PB 对象的引用。但在该示例中，它被转换为 PowerObject（基本上）。该 C# 代码仅在 PB 对象上调用 TriggerEvent()。

我想在 C# 中创建一个名为 foo1 的自定义类。我想在 foo1 上创建一个名为 bar1() 的方法。

我想在 PB 中创建一个名为 foo2 的自定义类。我想在 foo2 上创建一个名为 bar2() 的方法。

我希望能够在 foo2 中创建 foo1 的实例。我希望能够从 foo2 中调用 foo1.bar1()。

（直到这里我都很好。）

我希望能够从 foo1 中引用 foo2。我希望能够从 foo1 中调用 foo2.bar2()。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T17:44:18.870

我使用这里的想法来创建我的 C# 控件，并且它可以从 PB 和 Qt 调用它。

[将 Windows 窗体公开为 ActiveX 控件](http://www.codeproject.com/KB/miscctrl/exposingdotnetcontrols.aspx)

您可能还想查看 P/Invoke

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T15:02:37.873

我确信有一种更有效的方法可以做到这一点，但使用 COM 可能是最简单的。

*   [在 PowerBuilder 中使用 COM](http://www.techno-kitten.com/Changes_to_PowerBuilder/New_In_PowerBuilder_7/PB7_New_-_Building_COM_MTS_com/pb7_new_-_building_com_mts_com.html)
*   [在 .NET 中使用 COM](http://www.codeproject.com/KB/COM/cominterop.aspx)

有人会说 COM 永远不是正确的答案，但我说使用正确的工具完成正确的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T20:11:29.030

如果您想连接使用不同技术编写的对象，PowerBuilder（版本 6、7 和 8.0）只能正确理解 BINARY 合约。实际上，它意味着具有 IDispatch 接口的 COM 对象（所谓的 OleAutomation）。它与 VB6 或 jscript（使用 wscript）等解释语言可以使用的对象相同。

您不必处理 ConnectionPoints 在对象之间进行异步通信。使用您自己的常规界面。

不要使用 Watcom C++ 编译器来构建任何“代理对象”——几年前它是非常弱的编译器。我试图编译和构建一些解决方案，它在编译过程中显示了许多内部错误。MS C++ 编译器完成了编译，没有任何问题。

请记住，您的对象应该与公寓兼容。PB 仅使用 STA（单线程单元）。请检查一下——也许最近发生了一些变化。

# ssh - ssh -D ; 但反过来呢？

> ID：842021
> 
> 赞同：24
> 
> 时间：2009-05-08T22:04:34.200
> 
> 标签：ssh, tunneling

是否可以像这样使用动态端口转发设置 SSH 隧道：

ssh -D

但反过来呢？也就是说我想在我的本地机器上启动连接并在那里进行动态端口转发，并让我的朋友将他的浏览器连接到隧道的另一端。

如果我的朋友键入以上内容，上述内容非常有效，但我不想让他 ssh 访问我的机器，只是让他代理他的浏览器。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-08T22:13:48.390

对于 openssh，请参见`-R`开关：

```
 -R [bind_address:]port:host:hostport
         Specifies that the given port on the remote (server) host is to
         be forwarded to the given host and port on the local side.  This
         works by allocating a socket to listen to port on the remote
         side, and whenever a connection is made to this port, the connec‐
         tion is forwarded over the secure channel, and a connection is
         made to host port hostport from the local machine. 
```

虽然可能有更好的解决方案，但您可以`remotehost`通过以下方式在您朋友的计算机上的端口 24680 上创建一个 SOCKS 代理。首先，做

```
ssh -R 24680:localhost:12345 remotehost 
```

然后，做

```
ssh -D 12345 localhost 
```

显然，两个会话需要同时保持活动状态。

# design-patterns - 函数式编程的原则、最佳实践和设计模式

> ID：842026
> 
> 赞同：23
> 
> 时间：2009-05-08T22:06:19.263
> 
> 标签：design-patterns, functional-programming, principles

在用函数式编程语言编写代码时，是否有任何已知的原则、最佳实践和设计模式可以遵循？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-08T22:34:11.973

有折叠、展开、地图等。

我考虑使用它们的最佳实践，因为很容易推断它们的行为，并且它们经常传达函数的目的（例如，只需看看著名[的 Haskell 程序员的进化，](http://www.willamette.edu/~fruehr/haskell/evolution.html)并将大一和大四进行对比，和教授）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-09T02:14:06.330

设计模式：**让类型指导您的编码**。

1.  找出您要返回的类型。

2.  知道某些类型构造函数带有某些语法，并利用它来使所需的类型更小。这里有两个例子：

    *   如果你试图返回一个函数类型`T1 -> T2`，写起来*总是*安全的

        ```
        \ x -> ... 
        ```

        现在在正文中，您尝试生成一个类型的值`T2`，这是一个较小的类型，而且您获得了一个额外`x`的类型值`T1`，这可能会使您的工作更轻松。

        如果 lambda 被证明是不必要的，您可以随时 eta-reduce 稍后将其删除。

    *   如果你试图产生一对类型`(T1, T2)`，你总是可以尝试产生一个`x`类型`T1`的值和一个类型的值`y`，`T2`然后形成对`(x, y)`。同样，您已将问题简化为具有较小类型的问题。

3.  一旦类型尽可能小，请查看范围内所有 let-bound 和 lambda-bound 变量的类型，并了解如何生成所需类型的值。通常，您希望对所有函数使用所有参数；如果你不这样做，请确保你能解释原因。

在许多情况下，尤其是在编写多态函数时，这种设计技术可以将复杂函数的构造减少到只有一两个选择。类型指导程序的构造，因此编写正确类型的函数的方法很少——而且通常只有一种没有明显错误的方法。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-09T02:03:07.730

最佳实践：使用代数数据类型并利用模式匹配编译器的*详尽检查*。尤其是，

*   `_`永远不要在顶层匹配通配符模式。

*   设置编译器选项，以便模式匹配中缺少的大小写是错误，而不是警告。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-08T22:10:38.817

不要遵循原则，遵循你的鼻子。保持功能简短。寻找降低代码复杂度的方法，这通常但不一定意味着最简洁的代码。了解如何使用内置的高阶函数。

编写函数后立即重构并减小函数的代码大小。这样可以节省时间，因为明天您将不会想到问题和解决方案。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-09T02:06:38.237

设计模式：*让编译器*为您的函数推断类型，并确保这些类型与您期望的一样通用。如果类型是多态性的还是多态性的，找出原因。

例如，如果你在 Haskell 中编写一个排序函数，期望

```
Ord a => [a] -> [a] 
```

如果你的类型是

```
Num a => [a] -> [a] 
```

或者

```
[a] -> b 
```

那么事情就大错特错了。

最佳实践：一旦您与编译器确认类型符合您的预期，*就为每个顶级函数放置一个显式类型签名*。（或者，如果您使用 ML 或 Caml，请编写显式接口。）设置编译器选项，以便缺少签名的值触发错误。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-08-26T06:57:30.867

我会用可能有点模糊的原则来回答：**努力使您的代码美观**作为最重要的方面。[引用](http://quotes.cat-v.org/programming/)大卫·格伦特的话：

> 美在计算中比技术中的其他任何地方都更重要，因为软件是如此复杂。美丽是对抗复杂性的终极防御。

和布赖恩·克尼汉：

> 控制复杂性是计算机编程的本质。

如果你追求这个目标，它将引导你编写**易于阅读**和理解的代码（这非常重要），将代码拆分成具有明确目的的小而紧凑的部分。它将引导您学习如何以特定语言以最佳方式表达您的想法。

（所有这些不仅适用于函数式语言，而且在它们中编写漂亮的代码要容易得多。）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-08T22:48:37.260

[John Hughes 的《为什么函数式编程很重要》](http://www.cs.chalmers.se/~rjmh/Papers/whyfp.html)很好地解释了为什么懒惰和高阶（一等）函数提供了很多功能较少的语言所[缺少的东西，并补充了设计模式](http://c2.com/cgi/wiki?AreDesignPatternsMissingLanguageFeatures)。

在 Haskell 的上下文中，我认为[Real World Haskell](http://book.realworldhaskell.org/)这本书对习语、抽象和类型类等有一些很好的实用建议。Typeclassopedia[也](http://www.haskell.org/sitewiki/images/8/85/TMR-Issue13.pdf)总是有用的。核心的、非常抽象的类型类可以被视为设计模式，除非它们由编译器/类型系统和语言的一部分强制执行（如果您学习如何使用它们）。

在 Lisp 的上下文中，Paul Graham 写了一本名为 On Lisp 的书（[可在线获得](http://www.paulgraham.com/onlisp.html)），他在其中展示了函数式语言是创建自定义编程语言然后用它编写程序的理想选择。因此，嵌入式领域特定语言本身就是一种设计模式。

# python - Django 相当于 COUNT 和 GROUP BY

> ID：842031
> 
> 赞同：33
> 
> 时间：2009-05-08T22:08:32.503
> 
> 标签：python, sql, django, django-queryset, django-aggregation

我知道 Django 1.1 有一些新的聚合方法。但是我无法弄清楚以下查询的等价物：

```
SELECT player_type, COUNT(*) FROM players GROUP BY player_type; 
```

是否可以使用 Django 1.1 的模型查询 API 或者我应该只使用普通 SQL？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-05-09T07:40:12.897

如果您使用的是 Django 1.1 beta（主干）：

```
Player.objects.values('player_type').order_by().annotate(Count('player_type')) 
```

*   `values('player_type')`- 仅包含`player_type`字段到`GROUP BY`子句中。
*   `order_by()`- 排除可能导致不需要的字段包含在`SELECT`和中的默认排序`GROUP BY`。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-08T22:25:40.920

Django 1.1 确实支持计数等聚合方法。您可以[在此处找到完整的文档](http://docs.djangoproject.com/en/dev/topics/db/aggregation/)。

要回答您的问题，您可以使用以下内容：

```
from django.db.models import Count
q = Player.objects.annotate(Count('games'))
print q[0]
print q[0].games__count 
```

这将需要根据您的实际模型进行微调。

编辑：上面的代码片段基于每个对象生成聚合。如果要对模型中的特定字段进行聚合，可以使用以下`values`方法：

```
from django.db.models import Count
q = Player.objects.values('playertype').annotate(Count('games')).order_by()
print q[0]
print q[0].games__count 
```

`order_by()`是必需的，因为默认排序中的字段会自动选择，即使它们没有显式传递给`values()`. 此调用`order_by()`清除任何排序并使查询按预期运行。

此外，如果要计算用于分组的字段（相当于`COUNT(*)`），可以使用：

```
from django.db.models import Count
q = Player.objects.values('playertype').annotate(Count('playertype')).order_by()
print q[0]
print q[0].playertype__count 
```

# php - 我应该编写自己的 CMS 吗？

> ID：842036
> 
> 赞同：7
> 
> 时间：2009-05-08T22:10:28.663
> 
> 标签：php, ruby-on-rails, wordpress, content-management-system, forum

我计划在今年六月开始我的第一个个人项目：一个关于学生的社区。我想要的是一个 wiki，里面有关于大学的信息，一个人们可以讨论的论坛和一个包含新闻、文章等的博客，所有这三个都相互集成。

现在，要走的路似乎是 wordpress+mediawiki+一些论坛软件，但我一直有这些想法，想尝试一下并编写自己的 CMS。我有一些 RoR 和 PHP 知识，但肯定没有到可以编写自己的 CMS 的程度，尤其是完全从头开始。

你认为我需要多长时间才能实现它？我认为/估计我每天可以花 3 到 5 个小时在上面工作，我希望整个网站在 8 月底之前启动并运行（这给了我大约 300 个小时的工作时间，因为我也打算花一些时间。 ..什么都不做！：P）。

问题是，值得吗？它会帮助我提高我的编程技能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T22:20:39.497

从您的目标来看，似乎在 Drupal 中只需最少的工作即可轻松完成。

www.drupal.org

论坛和用户博客是内置的，我很确定我在某处看到了一个 wiki 模块。

但是，如果您要获得学习体验 - 自己动手将是一种学习体验。无论您是否真正完成它，当您完成时，您都会更好地理解 RoR 和/或 PHP。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-08T22:56:06.417

推出你自己的:)

您将获得经验（这是无价的），最重要的是，您最终会得到一些不臃肿的东西......

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-08T22:26:34.037

你应该做什么取决于你自己的判断，但你*应该*做的是实现像 Drupal 这样的东西。

Drupal 是一个用于社区站点的 CMS。它不是最容易理解和使用的系统，但它非常可定制。

以下是您可以用来开始学习 Drupal 的一些参考资料：[http://www.packtpub.com/drupal/book](http://www.packtpub.com/drupal/book) [http://drupal.org/node/367131](http://drupal.org/node/367131)

每当您必须在为自己编写内容和使用现有软件之间做出选择时，您需要考虑四个关键信息。

1.  会有多复杂？
2.  现有系统与我的需求的匹配程度如何？
3.  实现现有系统与自己编写系统的成本是多少
4.  我多久需要它？

如果它不是很复杂，没有其他东西能很好地满足您的需求，那么创建它会很便宜（在时间和金钱上），并且您不需要立即使用它，然后继续做自己的事情。

否则，请加入现有的开源 CMS 之一并开始在那里做出贡献。你不仅会从经验丰富的程序员那里得到很好的反馈，而且你会成为一些非常棒的软件的一部分。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-08T22:23:04.403

我的情况有点类似，尽管规模较小。我需要一个.net 中的博客软件，但现有的并不是那么好，所以我开始了自己的。以下是我的想法：

1.  不要试图制作 1:1 的副本。自己动手让你有机会只实施你需要的东西，而忽略其他一切。
2.  从小处着手。Wordpress 和 Mediawiki 拥有多年的编码经验。试图自己复制它是行不通的。
3.  博客和论坛一开始非常简单，但一旦处理了所见即所得编辑器、反垃圾邮件技术、浏览器兼容性问题等问题，就会变得非常复杂。
4.  这是获得对您的语言和“企业”技术的认真体验的好方法，但是如果您没有经验并且在截止日期前，您真的应该首先考虑扩展已经在市场上的东西。

如果你愿意在开始时偷工减料，我认为在 300 小时内构建一个 CMS 肯定是可行的。但是不要开始考虑诸如插件架构、管理员和文档的出色用户体验之类的东西——如果您想将您的 CMS 发布给其他人，这些点非常重要，但对于内部使用来说并不是那么重要。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-08T22:21:20.990

不。

“不要重新发明轮子，除非你打算更多地了解轮子”。

我将专注于学习每个工具以及如何将它们集成在一起，而不是编写 CMS。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-30T15:58:22.117

作为一个真正的开发者，你会渴望大量的定制。很多预打包的 CMS/博客都有插件系统，但对我来说，当我必须通过数据库条目向系统注册代码时，它们都觉得有点奇怪。

老实说，我用 wordpress 写过我的博客，用 PHP 重写了我自己的博客，从那以后我用 Django 重写了两次。

每一次都变得更快，每一次你想做更多的事情，每一次你都了解创建大型项目的人必须经历的所有可用性和安全性问题。

重写是一次宝贵的经验，我永远不会接受“不要重新发明轮子”的论点。我觉得好像我可以看看一个轮子并告诉你它有什么问题，考虑到我个人发明了它=P

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-08T22:14:14.253

它可能在那个时间范围内取决于您对 ruby​​ on rails 和 php 的使用程度。

但是，我只会使用那里的东西。真的值得花时间自己做吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-08T22:15:55.467

要创建与 wordpress+mediawiki+某些论坛软件质量相同的东西，需要花费数千小时。

但是，如果您只是为自己构建它以供使用，那么您会遇到很多“足够好”的东西，这会节省您的时间。所以我会说... 不到 1,000 小时。这听起来有点模糊，不是吗？我已经编程了 14 年，但我仍然无法估算项目的时间，哈哈。当然，项目的定义也很模糊。

要回答这个问题是否值得，这真的是你自己的问题。如果这是您对做的事情感到兴奋，那么这可能是一个很好的学习机会。大约 7 年前（在 Google Analytics 出现之前），我编写了一个相当强大的网络流量跟踪和统计引擎。这对我来说是一次很棒的学习经历，我不后悔这样做。当然，另一方面，就像我自己一样，你会投入大量的工作来做一些你几乎没有机会从中赚钱的事情。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-08T22:20:45.843

我想说考虑一下你为什么要这样做，如果是为了进一步了解你的编程知识并学习一些新东西，那就去尝试它并自己构建它，否则我只会使用可用的工具来组合它。

至于时间框架？我对自己的技能估计很烂，所以没有机会估计你的:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-08T22:22:26.933

如果你想去学习经验，那么我认为你应该这样做。Phil Haack 写了一篇名为[Rolling Your Own Blog Engine](http://haacked.com/archive/2006/10/06/Rolling_Your_Own_Blog_Engine.aspx)的好博客文章，其中列出了您将遇到的问题。

这并不像许多人试图让它听起来那么容易。事实上，您*可以*在几个小时内编写一个非常小的博客引擎（有些人会说几分钟，但跟随[Rails 视频](http://rubyonrails.org/screencasts)并不能真正算作您自己的开发时间），但这并没有多大用处除了你自己之外的任何人。其他用户将需要更多功能。

只要确保您有足够的时间来摆脱困境，并在需要时使用 B 计划（wordpress+mediawiki+一些论坛软件）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-08T22:28:07.747

[我想你会找到关于开发 Bug 跟踪工具的好资源的](https://stackoverflow.com/questions/559843/good-resources-for-developing-a-bug-tracking-tool)类似答案？

正如我在那里所说，这真的取决于你的最终目标。

虽然我同意许多人已经说过的话——为什么要重新发明轮子？- 对您有用的答案将取决于您要做什么。

**第 1 点：**
如果 [您|您的公司] 只需要一个 CMS，那里有很多工具，免费的和其他的，高质量的和其他的，为什么要编写自己的？

**第 2 点：**
如果您正在寻找一种学习体验，寻找一些可以学习 [ChoiceLanguage] 的东西，和/或[只是想了解更多有关轮子](http://www.codinghorror.com/blog/archives/001145.html)的信息，这里有很多文章和一些开源项目您可以查看代码以了解它们是如何工作的（或视情况而定）。

我发现有时从开源项目开始至少可以帮助我摆脱大量代码。我采用了一个经典的 ASP 论坛包并将其变成了一个 CMS - 但花了一年左右的时间，我得到了报酬。YMMV

**最后：**
如果后者是您的最终目标，那么请务必阅读文章，进行研究，然后编写代码。

如果是前者，您可能想看看已经完成的事情 -[除非它将成为您的业务核心竞争力](http://www.joelonsoftware.com/articles/fog0000000026.html)。

最终，您得到的答案将取决于您提出的问题。从一开始就清楚将有很长的路要走。;)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-08T22:36:05.777

多少时间因素是不可能回答的，因为我们坦率地说，不知道你有多好或你有什么资源。不过，我要说的是，您引用的每个示例可能至少落后一千工时，这是非常非常保守的。

至于要不要自己开发？嗯，这真的取决于你想要完成什么。想要高效地利用时间？无论如何，不​​！使用预先存在的解决方案。想要通过案例研究来学习更好的编程吗？那是一个完全不同的场景。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-08T22:37:32.543

在我看来，如今成功的社区网站都是专门建立的。它们没有很多无关的垃圾，易于导航并且使用起来很有趣。StackOverflow 就是一个很好的例子。要使您的网站成功，您的用户界面将非常重要。

如果您想最终控制您的用户界面，那么最好的办法就是自己构建它。您可以从您喜欢的代码库开始，或者至少将其用作工作示例。

幸运的是，只要您具备合理的编程技能，就可以开始使用当今可用的 Web 工具，在克服合理的学习曲线后，您就可以非常高效。

归根结底，如果您自己构建它，您将拥有一个非常灵活的网站，并且看起来完全符合您的要求。如果您使用其他人的代码，您将更快地建立网站并具有更多功能，但它不会那么灵活，您可能必须在外观和感觉上做出一些让步。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-09T13:12:17.163

我必须强调 barfoon 的评论，不要重新发明轮子。学习其他人的 CMS 并学习如何使用和开发它有很多学习经验。

此外，如果您参加一个开源项目并了解他们如何决定设计他们的产品，您将学到很多东西。 *然后*，在了解他们的工作原理后，您可以为项目做出贡献，甚至可以自己扩展，但这种方式有几个优点：

*   你知道你在做什么（CMS 可能是一项艰巨的任务）
*   取决于您选择哪一个，现有的 CMS 产品有大量的社区支持，这很有价值
*   通过查看他们的代码，您可能已经学会了一种好方法
*   学习他们的产品/代码比构建自己的产品/代码花费的时间更少，因此与从头开始构建产品/代码相比，您不太可能失去动力

也就是说，我个人建议您看看[Magnolia](http://www.magnolia-cms.com/)。它有社区支持，它是开源的，它是一个质量体系。

吉拉克

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-09T21:50:35.377

对于您定义的项目范围，我自己会使用 WordPress。[Simple Press Forum](http://simplepressforum.com/)是一个强大的、功能齐全的 WordPress 论坛插件，它很容易集成 MediaWiki。还有一个[WordPress wiki 插件项目](http://wordpresswiki.org/)，可以使用您似乎愿意投入的时间。WordPress 可以在一个周末完成您所描述的一切。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-13T22:46:41.477

你不需要重新发明轮子来获得经验。

我会去Wordpress。我将它用于我的网站 (www.norwegianfashion.no)，我相信我有一个相当先进的网站。我当然提高了我的 PHP 编程技能。

我也尝试过了解 Drupal。这是非常好的CMS，但学习起来很痛苦。

即使在其他 CMS 系统 (.NET) 上进行了 5 年的开发，经过 1 个月的尝试，我仍然无法掌握 Drupal。

我不是铁杆程序员，但我相信 CMS 应该相当容易使用。

所以我选择了 Wordpress。它有其局限性，但您可以创建自己的插件来弥补这一点。

# java - Java Swing 中的 PropertyGrid

> ID：842040
> 
> 赞同：5
> 
> 时间：2009-05-08T22:12:39.437
> 
> 标签：java, .net, swing

Java Swing 是否具有类似于 .NET 中的 PropertyGrid 的控件？

如果是这样，它是哪一个？或者至少哪一个最接近它？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T23:16:58.410

对此没有内置组件，但有几个第三方项目。特别是，[Java-Bean-Examiner](https://sourceforge.net/projects/beanexaminer/) (GPL) 看起来很有希望。

![Java-Bean-Examiner](https://sourceforge.net/p/beanexaminer/screenshot/114043.jpg) [![Java-Bean-Examiner](https://i.stack.imgur.com/5QIx8.jpg)](https://i.stack.imgur.com/5QIx8.jpg)
[（来源：[sourceforge.net](http://sourceforge.net/dbimage.php?id=114041)）]

**编辑：**还有[L2FProd 通用组件](https://web.archive.org/web/20150726091919/http://l2fprod.com/common/)（[Apache 许可](https://l2fprod-common.dev.java.net/)，您可能会发现它比 GPL 更有吸引力）：

[L2FProd 属性表 http://l2fprod.com/common/images/PropertySheetPanel.gif](http://l2fprod.com/common/images/PropertySheetPanel.gif)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T14:37:39.430

[在GitGub](https://github.com/sarxos/l2fprod-common)上 Fork L2FProd 通用组件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T05:34:52.700

我建议使用[JGoodies](http://www.jgoodies.com/)（表单和外观）来创建您自己的属性编辑器。它应该很快就能完成，而且您可以让它看起来比使用默认的 Swing 外观和布局更好。

# jquery - 防止jQuery中重复的ajax事件

> ID：842043
> 
> 赞同：0
> 
> 时间：2009-05-08T22:12:49.530
> 
> 标签：jquery, ajax, user-interface

在前一个 ajax 事件完成之前阻止的好方法是什么？

我关注[了你如何像在 Stackoverflow 中一样制作一个向上投票的按钮？](https://stackoverflow.com/questions/719194/how-can-you-make-a-vote-up-down-button-like-in-stackoverflow)但是如果我足够快地单击按钮，它将向服务器发送多个（可能是不一致的）事件。我该怎么做才能强制用户在注册另一个点击之前等待？

编辑：我也不希望它在全球范围内阻止 - 只是为了那个按钮/项目。我需要维护哈希吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T22:20:27.327

好吧，既然我写了，我想我也可以回答这个问题；）

执行此操作的“常见”方法是使用指示变量来指示请求正在进行中，并在一切发生之前/之后相应地更新它。对于我在该问题中的代码，您将对其进行如下编辑：

在 click 函数之外，添加以下内容：

```
var voting = false; // not initially voting 
```

在 click 函数的最顶部，添加以下内容：

```
if(voting) return false; // if voting, return
voting = true; // if not, set voting to true 
```

在两个 post 回调中，添加以下内容：

```
voting = false; // done voting, set back to false 
```

如果您想在每个问题/答案/项目的基础上维护一个指标，您可以这样做：

首先，替换此代码：

```
var id = $(this).parents('div.answer').attr('id').split('_')[1]; 
```

有了这个：

```
var parent = $(this).parents('div.answer'); // get the parent div
if(parent.data('voting')) return false; // if voting, return
parent.data('voting', true); // if not, update the marker
var id = parent.attr('id').split('_')[1]; // get the id 
```

然后在两个帖子回调中，添加以下内容：

```
parent.data('voting', false); // done voting, set back to false 
```

在这种情况下，我们将使用 jQuery 的[数据](http://docs.jquery.com/Core)将特定问题/答案/项目的投票状态存储在包含的 DIV 中，并在发生任何事情时相应地更新它。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T22:20:59.697

使用[jQuery.fn.one](http://docs.jquery.com/Events/one#typedatafn)绑定一次事件，然后在回调函数中再次绑定

```
myFunc = function() {
   $.post(url, data, function(data){
      $('#button').one('click', myFunc)
   }
};

$('#button').one('click', myFunc); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T22:16:53.217

使用开始和结束 AJAX 事件来设置一个全局变量，声明忙碌，直到请求完成。显示该操作正在执行的消息，以告知用户。

如果 Jquery 适合您的应用程序，它有很多功能可以提供帮助：

[http://docs.jquery.com/Ajax](http://docs.jquery.com/Ajax)

# .net - 如何使用 .NET（C# 或 VB.NET）在 PlaceCategory 中列出 MapPoint 2009 中的所有位置？

> ID：842044
> 
> 赞同：3
> 
> 时间：2009-05-08T22:12:51.887
> 
> 标签：.net, com, mappoint

我安装了 MapPoint 2009，并向我的 C# 项目添加了对“Microsoft MapPoint 16.0 对象库（北美）”COM 组件的引用。

如果我执行以下操作，我可以获得特定城市内所有“地点”的列表：

```
var m = new MapPoint.Application();
var map = m.ActiveMap;
MapPoint.FindResults r = map.FindPlaceResults("West Bend, WI"); 
```

但是，有没有办法只查询所有“警察局”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-03T03:26:49.353

我想这不能用 MapPoint 2009 完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-24T16:51:45.157

克里斯在这里有点慢，但我在 2009 年还不是会员！

您可以在 GUI 和 API 中将显示设置为“仅限警察局”。你能试试吗？

此外，您可以浏览所有 POI 列表并选择警察局。

我知道几年前我已经按照这些思路编写了一些代码。该应用程序是针对旅行亭的——因此可以查询“此时附近的夜总会”之类的内容。我必须回到我的代码，但绝对可以使用上述方法之一。

# xslt - 替换 XSLT 中的属性值

> ID：842048
> 
> 赞同：1
> 
> 时间：2009-05-08T22:14:50.493
> 
> 标签：xslt, templates, attributes

我正在尝试执行 XSL 转换。但是属性替换不起作用。我有这个 XSL：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:output encoding="UTF-8"
doctype-public="-//WAPFORUM//DTD WML 1.1//EN"
doctype-system="http://www.wapforum.org/DTD/wml_1.1.xml"/>

<xsl:template match="/">

<wml xml:lang="da">
<card id="FrontPage" title="{head/title}">
Why doesn't the title get inserted?

<p id="changed">The server processed this Jan 1st. 2009.</p>
</card></wml>
</xsl:template></xsl:stylesheet> 
```

将要转换的 XML 是一个 XHTML 1.0 过渡文档。该文档自然包含一个 html/head/title 元素。我希望将 title 元素的文本内容插入到 card 元素的 title 属性中：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>DMI - The weather on Faroe Islands</title>
(...) 
```

我使用 PHP 5.2.0 和 libxslt 版本 1.1.19。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T22:18:56.817

您缺少 html 命名空间声明。尝试以下操作：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:xhtml="http://www.w3.org/1999/xhtml">

  <xsl:output encoding="UTF-8"
              doctype-public="-//WAPFORUM//DTD WML 1.1//EN"
              doctype-system="http://www.wapforum.org/DTD/wml_1.1.xml"
              indent="yes"/>

  <xsl:template match="/">

    <wml xml:lang="da">
      <card id="FrontPage" title="{xhtml:html/xhtml:head/xhtml:title}">
        <p id="changed">The server processed this Jan 1st. 2009.</p>
      </card>
    </wml>
  </xsl:template>
</xsl:stylesheet> 
```

请注意，您可以将前缀从更改为`xhtml`您喜欢的任何更短的值。

还有另一个较小的问题（这可能是基于一个常见的误解）：`/`表示文档根与文档中最顶层的节点不同（`html`）。最顶层节点通常称为“根节点”，这是不正确的，即`/`与最顶层节点不匹配。因此`xhtml:html`必须添加到 XPath 表达式中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T22:18:46.350

将您的模板匹配表达式更改为`/html`：

```
<xsl:template match="/html"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T22:18:48.300

有两个问题：

```
<xsl:template match="/">
  <wml xml:lang="da">
     <card id="FrontPage" title="{html/head/title}"> 
```

文档根 ("/") 不是`<html>`元素。它*在*`<html>`元素之前。

此外，正如 divo 正确指出的那样，您缺少 XHTML 命名空间：

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:x="http://www.w3.org/1999/xhtml"
  exclude-result-prefixes="x"
>

  <xsl:output 
    encoding="UTF-8" 
    doctype-public="-//WAPFORUM//DTD WML 1.1//EN"
    doctype-system="http://www.wapforum.org/DTD/wml_1.1.xml"
  />

  <xsl:template match="/">
    <wml xml:lang="da">
      <card id="FrontPage" title="{x:html/x:head/x:title}">
        <p id="changed">The server processed this Jan 1st. 2009.</p>
      </card>
    </wml>
  </xsl:template>
</xsl:stylesheet> 
```

# xml - 我可以使用 XSLT 将 XML 解析为子文件吗？（+ 替代语言/方法）

> ID：842054
> 
> 赞同：1
> 
> 时间：2009-05-08T22:17:59.207
> 
> 标签：xml, xslt, split

大家好，我有高度重复的数据，深度为 5 个节点（包括根），需要拆分。（我将在一分钟内包含一个快速示例。）我想要做的是基于 3rd-depth 节点将一个 ~5mb XML 文件解析为更小的子文件。但在那之后，它变得更加复杂。

该任务的要求如下：

1.  子文件必须维护被提取的第 3 级节点的分层父级，包括它们的属性。
2.  子文件必须保留所有属性和子节点。
3.  如果 XSLT 无法处理该作业，请在 Ruby 中尝试。*如果您不擅长 XSLT，但可以告诉我如何在 Ruby 甚至 Python 中做到这一点，请随时用这些语言提供答案。*（否则尝试坚持使用 XSLT 或伪代码。）

DOM 层次结构：

```
<xml attr="whatever">
  <major-group name="whatever">
    <minor-group name="whatever">
      <another-group name="whatever">
        <last-node name="whatever"></last-node>
      </another-group>
    </minor-group>
  </major-group>
</xml> 
```

我需要将其拆分为**次要组**元素，同时保留其孩子和直接父母，并将所有这些（对于每个次要组）放在一个外部文件中。我有几个文件要以这种方式拆分。

而且...以前从未在 Ruby 中解析过 XML，并且刚刚开始使用 XSLT，我还不能编写脚本来完成我的任务。

我很想知道 XSLT 是否能胜任这项任务。 `:>`

**编辑：**

这是我生成的代码，能够在文件开头显示样式表。

```
<?xml version="1.0"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0">
  <xsl:output method="xml"/>
  <xsl:template match="minor-group">
    <xsl:variable name="filename"><xsl:value-of select="concat(@name,'.xml')"/></xsl:variable>
    <xsl:result-document href="{$filename}">
      <xsl:text disable-output-escaping="yes">
        <![CDATA[<?xml-stylesheet type="text/xsl" href="../web.xslt"?>]]>
      </xsl:text> 
      <xml>
        <xsl:attribute name="whatever"><xsl:value-of select="../../@whatever" /></xsl:attribute>
        <major-group>
          <xsl:attribute name="whatever"><xsl:value-of select="../@whatever" /></xsl:attribute>
          <xsl:copy-of select="."/>
        </major-group>
      </xml>
    </xsl:result-document>
  </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T23:44:12.337

要提取“次要组”元素列表，需要以下 XPath 表达式之一。

```
/xml/major-group/minor-group （显式方式）
/*/*/* （通用的，任何三级元素方式）

```

在您选择的脚本语言中，将文档读入 DOM，在 XPath 查询上构造一个循环，将结果写入不同的输出文件。

使用 XSLT 1.0，一次不能生成多个输出文档。然而，XSLT 2.0 通过[`<xsl:result-document>`指令](http://www.w3.org/TR/xslt20/#element-result-document)支持这一点。

如果您可以使用 XSLT 2.0 引擎，您可以尝试该路线。我在 IBM 的 developerWorks 网站上找到的一个随机页面显示了如何开始：[提示：在 XSLT 2.0 中创建多个文件](http://www.ibm.com/developerworks/xml/library/x-tipmultxsl.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T22:30:52.437

我不相信您可以仅使用 XSLT 将一个文件解析为多个输出文件。

如果您要使用 Ruby 将 XML 分解为不同的 XML 文件，然后将单独的 XML 文件多次应用于 XSLT，它应该可以工作。

# c# - 如何将 TimeSpan 转换为格式化字符串？

> ID：842057
> 
> 赞同：130
> 
> 时间：2009-05-08T22:18:55.257
> 
> 标签：c#, timespan

我有两个 DateTime 变量，beginTime 和 endTime。通过执行以下操作，我得到了它们的不同：

```
TimeSpan dateDifference = endTime.Subtract(beginTime); 
```

我现在如何使用 C# 以 hh hrs、mm mins、ss secs 格式返回一个字符串。

如果差异为 00:06:32.4458750

它应该返回这个 00 hrs, 06 mins, 32 secs

* * *

## 回答 #1

> 赞同：200
> 
> 时间：2010-12-12T19:42:45.487

我刚刚构建了一些 TimeSpan 扩展方法。以为我可以分享：

```
public static string ToReadableAgeString(this TimeSpan span)
{
    return string.Format("{0:0}", span.Days / 365.25);
}

public static string ToReadableString(this TimeSpan span)
{
    string formatted = string.Format("{0}{1}{2}{3}",
        span.Duration().Days > 0 ? string.Format("{0:0} day{1}, ", span.Days, span.Days == 1 ? string.Empty : "s") : string.Empty,
        span.Duration().Hours > 0 ? string.Format("{0:0} hour{1}, ", span.Hours, span.Hours == 1 ? string.Empty : "s") : string.Empty,
        span.Duration().Minutes > 0 ? string.Format("{0:0} minute{1}, ", span.Minutes, span.Minutes == 1 ? string.Empty : "s") : string.Empty,
        span.Duration().Seconds > 0 ? string.Format("{0:0} second{1}", span.Seconds, span.Seconds == 1 ? string.Empty : "s") : string.Empty);

    if (formatted.EndsWith(", ")) formatted = formatted.Substring(0, formatted.Length - 2);

    if (string.IsNullOrEmpty(formatted)) formatted = "0 seconds";

    return formatted;
} 
```

* * *

## 回答 #2

> 赞同：148
> 
> 时间：2010-03-31T11:29:23.050

通过将其转换为日期时间，您可以获得本地化格式：

```
new DateTime(timeSpan.Ticks).ToString("HH:mm"); 
```

* * *

## 回答 #3

> 赞同：129
> 
> 时间：2012-11-02T10:05:20.753

这是最短的解决方案。

```
timeSpan.ToString(@"hh\:mm"); 
```

* * *

## 回答 #4

> 赞同：47
> 
> 时间：2009-05-08T22:22:10.053

[TimeSpan.ToString()](http://msdn.microsoft.com/en-us/library/1ecy8h51.aspx)会为您解决问题吗？如果没有，看起来该页面上的代码示例描述了如何对`TimeSpan`对象进行自定义格式设置。

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2009-05-08T22:29:39.317

使用带有多个参数的 String.Format()。

```
using System;

namespace TimeSpanFormat
{
    class Program
    {
        static void Main(string[] args)
        {
            TimeSpan dateDifference = new TimeSpan(0, 0, 6, 32, 445);
            string formattedTimeSpan = string.Format("{0:D2} hrs, {1:D2} mins, {2:D2} secs", dateDifference.Hours, dateDifference.Minutes, dateDifference.Seconds);
            Console.WriteLine(formattedTimeSpan);
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2011-04-30T05:15:32.273

```
 public static class TimeSpanFormattingExtensions
   {
      public static string ToReadableString(this TimeSpan span)
      {
         return string.Join(", ", span.GetReadableStringElements()
            .Where(str => !string.IsNullOrWhiteSpace(str)));
      }

      private static IEnumerable<string> GetReadableStringElements(this TimeSpan span)
      {
         yield return GetDaysString((int)Math.Floor(span.TotalDays));
         yield return GetHoursString(span.Hours);
         yield return GetMinutesString(span.Minutes);
         yield return GetSecondsString(span.Seconds);
      }

      private static string GetDaysString(int days)
      {
         if (days == 0)
            return string.Empty;

         if (days == 1)
            return "1 day";

         return string.Format("{0:0} days", days);
      }

      private static string GetHoursString(int hours)
      {
         if (hours == 0)
            return string.Empty;

         if (hours == 1)
            return "1 hour";

         return string.Format("{0:0} hours", hours);
      }

      private static string GetMinutesString(int minutes)
      {
         if (minutes == 0)
            return string.Empty;

         if (minutes == 1)
            return "1 minute";

         return string.Format("{0:0} minutes", minutes);
      }

      private static string GetSecondsString(int seconds)
      {
         if (seconds == 0)
            return string.Empty;

         if (seconds == 1)
            return "1 second";

         return string.Format("{0:0} seconds", seconds);
      }
   } 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-05-08T22:27:10.540

格式化 a 的最简单方法`TimeSpan`是将其添加到 a`DateTime`并格式化：

```
string formatted = (DateTime.Today + dateDifference).ToString("HH 'hrs' mm 'mins' ss 'secs'"); 
```

只要时差不超过 24 小时，此方法就有效。

该`Today`属性返回一个`DateTime`时间分量为零的值，因此结果的时间分量就是该`TimeSpan`值。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-05-08T22:30:26.913

根据[Microsoft 文档](http://msdn.microsoft.com/en-us/library/system.timespan.days.aspx "微软文档")，TimeSpan 结构将 Hours、Minutes、Second 和 Milliseconds 公开为整数成员。也许你想要类似的东西：

```
dateDifference.Hours.ToString() + " hrs, " + dateDifference.Minutes.ToString() + " mins, " + dateDifference.Seconds.ToString() + " secs" 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-05-09T18:36:28.813

您可以使用以下代码。

```
public static class TimeSpanExtensions
{
  public static String Verbose(this TimeSpan timeSpan)
  {
    var hours = timeSpan.Hours;
    var minutes = timeSpan.Minutes;

    if (hours > 0) return String.Format("{0} hours {1} minutes", hours, minutes);
    return String.Format("{0} minutes", minutes);
  }
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-01-06T20:11:25.257

感谢 Peter 的扩展方法。我对其进行了修改以更好地使用更长的时间跨度：

```
namespace ExtensionMethods
{
    public static class TimeSpanExtensionMethods
    {
        public static string ToReadableString(this TimeSpan span)
        {
            string formatted = string.Format("{0}{1}{2}",
                (span.Days / 7) > 0 ? string.Format("{0:0} weeks, ", span.Days / 7) : string.Empty,
                span.Days % 7 > 0 ? string.Format("{0:0} days, ", span.Days % 7) : string.Empty,
                span.Hours > 0 ? string.Format("{0:0} hours, ", span.Hours) : string.Empty);

            if (formatted.EndsWith(", ")) formatted = formatted.Substring(0, formatted.Length - 2);

            return formatted;
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-02-29T17:55:07.187

我也有类似的问题，并提出了我自己的扩展，但它似乎与其他所有东西都有点不同。

```
 public static string TimeSpanToString(this TimeSpan timeSpan)
    {
        //if it's negative
        if (timeSpan.Ticks < 0)
        {
            timeSpan = timeSpan - timeSpan - timeSpan;
            if (timeSpan.Days != 0)
                return string.Format("-{0}:{1}", timeSpan.Days.ToString("d"), new DateTime(timeSpan.Ticks).ToString("HH:mm:ss"));
            else
                return new DateTime(timeSpan.Ticks).ToString("-HH:mm:ss");
        }

        //if it has days
        else if (timeSpan.Days != 0)
            return string.Format("{0}:{1}", timeSpan.Days.ToString("d"), new DateTime(timeSpan.Ticks).ToString("HH:mm:ss"));

        //otherwise return the time
        else
            return new DateTime(timeSpan.Ticks).ToString("HH:mm:ss");
    } 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2012-05-02T01:54:04.737

我知道这个问题比较老，但 .Net 4 现在支持[自定义 TimeSpan 格式](http://msdn.microsoft.com/en-us/library/ee372287.aspx)。

我也知道有人提到过它，但它让我感到困惑，将 Ticks 转换为 DateTime 可以工作，但不能正确处理超过 24 小时的跨度。

```
new DateTime((DateTime.Now - DateTime.Now.AddHours(-25)).Ticks).ToString("HH:mm") 
```

这将使您获得 01:00 而不是您所期望的 25:00。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-08-03T14:01:21.277

我知道这是一个迟到的答案，但这对我有用：

```
TimeSpan dateDifference = new TimeSpan(0,0,0, (int)endTime.Subtract(beginTime).TotalSeconds); 
```

dateDifference 现在应该排除小于一秒的部分。也适用于 .net 2.0。

* * *

## 回答 #14

> 赞同：-12
> 
> 时间：2011-09-14T20:45:04.867

```
''' <summary>
''' Return specified Double # (NumDbl) as String using specified Number Format String (FormatStr, 
''' Default = "N0") and Format Provider (FmtProvider, Default = Nothing) followed by space and,  
''' if NumDbl = 1, the specified Singular Unit Name (SglUnitStr), else the Plural Unit Name 
''' (PluralUnitStr).
''' </summary>
''' <param name="NumDbl"></param>
''' <param name="SglUnitStr"></param>
''' <param name="PluralUnitStr"></param>
''' <param name="FormatStr"></param>
''' <param name="FmtProvider"></param>
''' <returns></returns>
''' <remarks></remarks>
Public Function PluralizeUnitsStr( _
    ByVal NumDbl As Double, _
    ByVal SglUnitStr As String, _
    ByVal PluralUnitStr As String, _
    Optional ByVal FormatStr As String = "N0", _
    Optional ByVal FmtProvider As System.IFormatProvider = Nothing _
    ) As String

    PluralizeUnitsStr = NumDbl.ToString(FormatStr, FmtProvider) & " "

    Dim RsltUnitStr As String

    If NumDbl = 1 Then
        RsltUnitStr = SglUnitStr
    Else
        RsltUnitStr = PluralUnitStr
    End If

    PluralizeUnitsStr &= RsltUnitStr

End Function

''' <summary>
''' Info about a # Unit.
''' </summary>
''' <remarks></remarks>
Public Class clsNumUnitInfoItem
    ''' <summary>
    ''' Name of a Singular Unit (i.e. "day", "trillion", "foot")
    ''' </summary>
    ''' <remarks></remarks>
    Public UnitSglStr As String

    ''' <summary>
    ''' Name of a Plural Unit (i.e. "days", "trillion", "feet")
    ''' </summary>
    ''' <remarks></remarks>
    Public UnitPluralStr As String

    ''' <summary>
    ''' # of Units to = 1 of Next Higher (aka Parent) Unit (i.e. 24 "hours", 1000 "million", 
    ''' 5280 "feet")
    ''' </summary>
    ''' <remarks></remarks>
    Public UnitsInParentInt As Integer
End Class ' -- clsNumUnitInfoItem

Dim TimeLongEnUnitInfoItms As clsNumUnitInfoItem() = { _
    New clsNumUnitInfoItem With {.UnitSglStr = "day", .UnitPluralStr = "days", .UnitsInParentInt = 1}, _
    New clsNumUnitInfoItem With {.UnitSglStr = "hour", .UnitPluralStr = "hours", .UnitsInParentInt = 24}, _
    New clsNumUnitInfoItem With {.UnitSglStr = "minute", .UnitPluralStr = "minutes", .UnitsInParentInt = 60}, _
    New clsNumUnitInfoItem With {.UnitSglStr = "second", .UnitPluralStr = "seconds", .UnitsInParentInt = 60}, _
    New clsNumUnitInfoItem With {.UnitSglStr = "millisecond", .UnitPluralStr = "milliseconds", .UnitsInParentInt = 1000} _
    } ' -- Dim TimeLongEnUnitInfoItms

Dim TimeShortEnUnitInfoItms As clsNumUnitInfoItem() = { _
    New clsNumUnitInfoItem With {.UnitSglStr = "day", .UnitPluralStr = "days", .UnitsInParentInt = 1}, _
    New clsNumUnitInfoItem With {.UnitSglStr = "hr", .UnitPluralStr = "hrs", .UnitsInParentInt = 24}, _
    New clsNumUnitInfoItem With {.UnitSglStr = "min", .UnitPluralStr = "mins", .UnitsInParentInt = 60}, _
    New clsNumUnitInfoItem With {.UnitSglStr = "sec", .UnitPluralStr = "secs", .UnitsInParentInt = 60}, _
    New clsNumUnitInfoItem With {.UnitSglStr = "msec", .UnitPluralStr = "msecs", .UnitsInParentInt = 1000} _
    } ' -- Dim TimeShortEnUnitInfoItms

''' <summary>
''' Convert a specified Double Number (NumDbl) to a long (aka verbose) format (i.e. "1 day, 
''' 2 hours, 3 minutes, 4 seconds and 567 milliseconds") with a specified Array of Time Unit 
''' Info Items (TimeUnitInfoItms), Conjunction (ConjStr, Default = "and"), Minimum Unit Level 
''' Shown (MinUnitLevInt) (0 to TimeUnitInfoItms.Length - 1, -1=All), Maximum Unit Level Shown 
''' (MaxUnitLevInt) (-1=All), Maximum # of Unit Levels Shown (MaxNumUnitLevsInt) (1 to 0 to 
''' TimeUnitInfoItms.Length - 1, 0=All) and Round Last Shown Units Up Flag (RoundUpBool).  
''' Suppress leading 0 Unit Levels.
''' </summary>
''' <param name="NumDbl"></param>
''' <param name="NumUnitInfoItms"></param>
''' <param name="ConjStr"></param>
''' <param name="MinUnitLevInt"></param>
''' <param name="MaxUnitLevInt"></param>
''' <param name="MaxNumUnitLevsInt"></param>
''' <param name="RoundUpBool"></param>
''' <param name="FormatStr"></param>
''' <param name="FmtProvider"></param>
''' <returns></returns>
''' <remarks></remarks>
Public Function NumToLongStr( _
    ByVal NumDbl As Double, _
    ByVal NumUnitInfoItms As clsNumUnitInfoItem(), _
    Optional ByVal ConjStr As String = "and", _
    Optional ByVal MinUnitLevInt As Integer = -1, _
    Optional ByVal MaxUnitLevInt As Integer = -1, _
    Optional ByVal MaxNumUnitLevsInt As Integer = 0, _
    Optional ByVal RoundUpBool As Boolean = False, _
    Optional ByVal FormatStr As String = "N0", _
    Optional ByVal FmtProvider As System.IFormatProvider = Nothing _
    ) As String
    NumToLongStr = ""

    Const TUnitDelimStr As String = ", "

    If (MinUnitLevInt < -1) OrElse (MinUnitLevInt >= NumUnitInfoItms.Length) Then
        Throw New Exception("Invalid MinUnitLevInt: " & MaxUnitLevInt)
    End If

    If (MaxUnitLevInt < -1) OrElse (MaxUnitLevInt >= NumUnitInfoItms.Length) Then
        Throw New Exception("Invalid MaxDetailLevelInt: " & MaxUnitLevInt)
    End If

    If (MaxNumUnitLevsInt < 0) OrElse (MaxNumUnitLevsInt > NumUnitInfoItms.Length) Then
        Throw New Exception("Invalid MaxNumUnitLevsInt: " & MaxNumUnitLevsInt)
    End If

    Dim PrevNumUnitsDbl As Double = NumDbl
    Dim CurrUnitLevInt As Integer = -1
    Dim NumUnitLevsShownInt As Integer = 0

    For Each UnitInfoItem In NumUnitInfoItms
        CurrUnitLevInt += 1

        With UnitInfoItem

            Dim CurrNumUnitsDbl As Double = PrevNumUnitsDbl * .UnitsInParentInt
            Dim CurrTruncNumUnitsInt As Integer = Math.Truncate(CurrNumUnitsDbl)
            PrevNumUnitsDbl = CurrNumUnitsDbl
            If CurrUnitLevInt < MinUnitLevInt Then Continue For
            PrevNumUnitsDbl -= CurrTruncNumUnitsInt

            'If (CurrUnitLevInt > TimeUnitInfoItms.Length) _
            '    OrElse _
            '    ( _
            '    (CurrUnitLevInt > MaxUnitLevInt) AndAlso _
            '    (MaxUnitLevInt <> -1) _
            '    ) _
            '    OrElse _
            '    ( _
            '    (NumUnitLevsShownInt + 1 > MaxNumUnitLevsInt) AndAlso _
            '    (MaxNumUnitLevsInt <> 0) _
            '    ) Then Exit For

            If (CurrUnitLevInt = (NumUnitInfoItms.Length - 1)) OrElse _
                (CurrUnitLevInt = MaxUnitLevInt) OrElse _
                ((NumUnitLevsShownInt + 1) = MaxNumUnitLevsInt) Then

                If NumUnitLevsShownInt > 0 Then
                    Dim TUnitDelimStrLenInt As Integer = TUnitDelimStr.Length
                    NumToLongStr = NumToLongStr.Remove( _
                        NumToLongStr.Length - TUnitDelimStrLenInt, _
                        TUnitDelimStrLenInt)
                    NumToLongStr &= " " & ConjStr & " "
                End If

                Dim CurrNunUnitsRoundedInt As Integer
                If RoundUpBool Then
                    If CurrNumUnitsDbl <> CurrTruncNumUnitsInt Then
                        CurrNunUnitsRoundedInt = CurrTruncNumUnitsInt + 1
                    Else
                        CurrNunUnitsRoundedInt = CurrTruncNumUnitsInt
                    End If
                Else
                    CurrNunUnitsRoundedInt = Math.Round( _
                        value:=CurrNumUnitsDbl, mode:=MidpointRounding.AwayFromZero)
                End If

                NumToLongStr &= _
                    PluralizeUnitsStr(CurrNunUnitsRoundedInt, _
                        .UnitSglStr, .UnitPluralStr, FormatStr, FmtProvider)
                Exit For

            Else ' -- Not (MaxUnitLevInt or MaxNumUnitLevsInt)

                If NumUnitLevsShownInt > 0 OrElse CurrTruncNumUnitsInt <> 0 Then
                    NumToLongStr &= _
                        PluralizeUnitsStr(CurrTruncNumUnitsInt, _
                            .UnitSglStr, .UnitPluralStr, FormatStr, FmtProvider) & _
                        TUnitDelimStr
                    NumUnitLevsShownInt += 1
                End If

            End If ' -- Else Not (MaxUnitLevInt or MaxNumUnitLevsInt)

        End With ' -- UnitInfoItem

    Next UnitInfoItem

End Function

''' <summary>
''' Call NumToLongStr with a specified TimeSpan's (TS) TotalDays.
''' </summary>
''' <param name="TS"></param>
''' <param name="TimeUnitInfoItms"></param>
''' <param name="ConjStr"></param>
''' <param name="MinUnitLevInt"></param>
''' <param name="MaxUnitLevInt"></param>
''' <param name="MaxNumUnitLevsInt"></param>
''' <param name="RoundUpBool"></param>
''' <param name="FormatStr"></param>
''' <param name="FmtProvider"></param>
''' <returns></returns>
''' <remarks></remarks>
Public Function TimeSpanToStr( _
    ByVal TS As TimeSpan, _
    ByVal TimeUnitInfoItms As clsNumUnitInfoItem(), _
    Optional ByVal ConjStr As String = "and", _
    Optional ByVal MinUnitLevInt As Integer = -1, _
    Optional ByVal MaxUnitLevInt As Integer = -1, _
    Optional ByVal MaxNumUnitLevsInt As Integer = 0, _
    Optional ByVal RoundUpBool As Boolean = False, _
    Optional ByVal FormatStr As String = "N0", _
    Optional ByVal FmtProvider As System.IFormatProvider = Nothing _
    ) As String

    Return NumToLongStr( _
        NumDbl:=TS.TotalDays, _
        NumUnitInfoItms:=TimeUnitInfoItms, _
        ConjStr:=ConjStr, _
        MinUnitLevInt:=MinUnitLevInt, _
        MaxUnitLevInt:=MaxUnitLevInt, _
        MaxNumUnitLevsInt:=MaxNumUnitLevsInt, _
        RoundUpBool:=RoundUpBool, _
        FormatStr:=FormatStr, _
        FmtProvider:=FmtProvider _
        )

End Function

''' <summary>
''' Call TimeSpanToStr with TimeLongEnUnitInfoItms.
''' </summary>
''' <param name="TS"></param>
''' <param name="MinUnitLevInt"></param>
''' <param name="MaxUnitLevInt"></param>
''' <param name="MaxNumUnitLevsInt"></param>
''' <param name="RoundUpBool"></param>
''' <param name="FormatStr"></param>
''' <param name="FmtProvider"></param>
''' <returns></returns>
''' <remarks></remarks>
Public Function TimeSpanToLongEnStr( _
    ByVal TS As TimeSpan, _
    Optional ByVal MinUnitLevInt As Integer = -1, _
    Optional ByVal MaxUnitLevInt As Integer = -1, _
    Optional ByVal MaxNumUnitLevsInt As Integer = 0, _
    Optional ByVal RoundUpBool As Boolean = False, _
    Optional ByVal FormatStr As String = "N0", _
    Optional ByVal FmtProvider As System.IFormatProvider = Nothing _
    ) As String

    Return TimeSpanToStr( _
        TS:=TS, _
        TimeUnitInfoItms:=TimeLongEnUnitInfoItms, _
        MinUnitLevInt:=MinUnitLevInt, _
        MaxUnitLevInt:=MaxUnitLevInt, _
        MaxNumUnitLevsInt:=MaxNumUnitLevsInt, _
        RoundUpBool:=RoundUpBool, _
        FormatStr:=FormatStr, _
        FmtProvider:=FmtProvider _
        )
End Function 
```

# python - 是否有一种可移植的方式来获取 Python 中的当前用户名？

> ID：842059
> 
> 赞同：690
> 
> 时间：2009-05-08T22:20:20.120
> 
> 标签：python, portability

是否有一种可移植的方式在 Python 中获取当前用户的用户名（即，至少在 Linux 和 Windows 下都可以使用）。它会像这样工作`os.getuid`：

```
>>> os.getuid()
42
>>> os.getusername()
'slartibartfast' 
```

我四处搜索，很惊讶没有找到明确的答案（尽管也许我只是在谷歌上搜索得很糟糕）。[pwd](http://www.python.org/doc/2.5.2/lib/module-pwd.html)模块提供了一种相对简单的方法来实现这一点，例如，Linux，但它不存在于 Windows 上。一些搜索结果表明，在某些情况下（例如，作为 Windows 服务运行），在 Windows 下获取用户名可能会很复杂，尽管我尚未对此进行验证。

* * *

## 回答 #1

> 赞同：984
> 
> 时间：2009-05-08T22:30:51.030

查看[getpass](http://docs.python.org/library/getpass.html)模块

```
import getpass
getpass.getuser()
'kostya' 
```

可用性：Unix、Windows

* * *

ps 根据下面的评论“*此函数查看各种环境变量的值以确定用户名。因此，不应依赖此函数用于访问控制目的（或可能任何其他目的，因为它允许任何用户冒充任何其他）。* ”

* * *

## 回答 #2

> 赞同：148
> 
> 时间：2010-05-24T17:53:51.867

你最好的选择是`os.getuid()`结合`pwd.getpwuid()`：

```
import os
import pwd

def get_username():
    return pwd.getpwuid( os.getuid() )[ 0 ] 
```

有关详细信息，请参阅 pwd 文档：

[http://docs.python.org/library/pwd.html](http://docs.python.org/library/pwd.html)

* * *

## 回答 #3

> 赞同：113
> 
> 时间：2009-10-20T13:00:12.223

您还可以使用：

```
 os.getlogin() 
```

* * *

## 回答 #4

> 赞同：88
> 
> 时间：2009-05-08T22:35:54.733

您可能可以使用：

```
os.environ.get('USERNAME') 
```

或者

```
os.environ.get('USER') 
```

但这并不安全，因为可以更改环境变量。

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2010-01-02T21:35:30.767

这些可能会起作用。我不知道它们在作为服务运行时的行为。它们不可移植，但这就是`os.name`和`if`语句的用途。

```
win32api.GetUserName()

win32api.GetUserNameEx(...) 
```

见： [http ://timgolden.me.uk/python/win32_how_do_i/get-the-owner-of-a-file.html](http://timgolden.me.uk/python/win32_how_do_i/get-the-owner-of-a-file.html)

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2013-02-09T01:23:29.800

如果您需要它来获取用户的主目录，下面可以被认为是可移植的（至少是 win32 和 linux），是标准库的一部分。

```
>>> os.path.expanduser('~')
'C:\\Documents and Settings\\johnsmith' 
```

您也可以解析此类字符串以仅获取最后一个路径组件（即用户名）。

请参阅：[os.path.expanduser](http://docs.python.org/2/library/os.path.html#os.path.expanduser)

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2013-12-05T14:39:01.947

对我来说，使用`os`模块看起来最适合可移植性：在 Linux 和 Windows 上效果最好。

```
import os

# Gives user's home directory
userhome = os.path.expanduser('~')          

print "User's home Dir: " + userhome

# Gives username by splitting path based on OS
print "username: " + os.path.split(userhome)[-1] 
```

输出：

视窗：

> 用户的主目录：C:\Users\myuser
> 
> 用户名：myuser

Linux：

> 用户主目录：/root
> 
> 用户名：root

无需安装任何模块或扩展。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2013-11-08T17:47:29.550

结合`pwd`和`getpass`方法，基于其他答案：

```
try:
  import pwd
except ImportError:
  import getpass
  pwd = None

def current_user():
  if pwd:
    return pwd.getpwuid(os.geteuid()).pw_name
  else:
    return getpass.getuser() 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2020-12-09T20:10:50.393

[psutil](https://github.com/giampaolo/psutil)提供了一种可移植的方式，它不像`getpass`解决方案那样使用环境变量。它不太容易出现安全问题，并且可能是今天公认的答案。

```
import psutil

def get_username():
    return psutil.Process().username() 
```

在底层，这结合了`getpwuid`基于 unix 的`GetTokenInformation`方法和 Windows 的方法。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2014-09-16T17:31:25.180

至少对于 UNIX，这是可行的……

```
import commands
username = commands.getoutput("echo $(whoami)")
print username 
```

**编辑：** 我刚刚查了一下，这适用于 Windows 和 UNIX：

```
import commands
username = commands.getoutput("whoami") 
```

在 UNIX 上，它返回您的用户名，但在 Windows 上，它返回您的用户组、斜杠、您的用户名。

--

IE

UNIX 返回：“用户名”

Windows 返回：“域/用户名”

--

这很有趣，但可能并不理想，除非您无论如何都在终端中做某事......在这种情况下，您可能会`os.system`开始使用。例如，不久前我需要将我的用户添加到一个组中，所以我做了（这是在 Linux 中，请注意）

```
import os
os.system("sudo usermod -aG \"group_name\" $(whoami)")
print "You have been added to \"group_name\"! Please log out for this to take effect" 
```

我觉得这更容易阅读**，**您不必导入 pwd 或 getpass。

我也觉得拥有“域/用户”可能对 Windows 中的某些应用程序有所帮​​助。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2019-05-13T13:47:17.570

仅使用标准 python 库：

```
from os import environ,getcwd
getUser = lambda: environ["USERNAME"] if "C:" in getcwd() else environ["USER"]
user = getUser() 
```

适用于 Windows（如果您在驱动器 C 上）、Mac 或 Linux

或者，您可以立即调用删除一行：

```
from os import environ,getcwd
user = (lambda: environ["USERNAME"] if "C:" in getcwd() else environ["USER"])() 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2010-02-04T19:52:09.073

我前段时间编写了 plx 模块，以便在 Unix 和 Windows 上以可移植的方式获取用户名（除其他外）： http: [//www.decalage.info/en/python/plx](http://www.decalage.info/en/python/plx)

用法：

```
import plx

username = plx.get_username() 
```

（它需要 Windows 上的 win32 扩展）

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-11-20T08:12:32.520

您可以通过 Windows API 获取 Windows 上的当前用户名，尽管通过 ctypes FFI ( [GetCurrentProcess](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683179) → [OpenProcessToken](http://msdn.microsoft.com/en-us/library/aa379295) → [GetTokenInformation](http://msdn.microsoft.com/en-us/library/windows/desktop/aa446671) → [LookupAccountSid](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379166) ) 调用有点麻烦。

我编写了一个可以直接从 Python 执行此操作的小模块[getuser.py](https://gist.github.com/mkropat/7559409)。用法：

```
import getuser
print(getuser.lookup_username()) 
```

它适用于 Windows 和 *nix（后者使用`pwd`其他答案中描述的模块）。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2021-04-28T11:47:55.670

以上都不适用于我的情况（向下滚动到实际解决方案）。
我在所有解决方案中遇到的问题是使用以下命令运行命令时用户名错误`sudo`：

*   `psutil`解决方案：

```
$ python3
>>> import psutil
>>> psutil.Process().username()
'ubuntu' # OK!

$ sudo su
$ python3
>>> import psutil
>>> psutil.Process().username()
'root' # OK!

$ sudo python3
>>> import psutil
>>> psutil.Process().username()
'root' # WRONG, should be ubuntu! 
```

*   `getpass`解决方案：

```
$ python3
>>> import getpass
>>> getpass.getuser()
'ubuntu' # OK!

$ sudo su
$ python3
>>> import getpass
>>> getpass.getuser()
'root' # OK!

$ sudo python3
>>> import getpass
>>> getpass.getuser()
'root' # WRONG, should be ubuntu! 
```

*   `pwd`+`os.getuid`解决方案：

```
$ python3
>>> import os, pwd
>>> pwd.getpwuid( os.getuid() )[ 0 ]
'ubuntu' # OK!

$ sudo su
$ python3
>>> import os, pwd
>>> pwd.getpwuid( os.getuid() )[ 0 ]
'root' # OK!

$ sudo python3
>>> import getpass
>>> getpass.getuser()
'root' # WRONG, should be ubuntu! 
```

*   `os.getlogin`工作方式有点不同，但仍然是错误的：

```
$ python3
>>> import os
>>> os.getlogin()
'ubuntu' # OK!

$ sudo su
$ python3
>>> import os
>>> os.getlogin()
'ubuntu' # WRONG, should be root!

$ sudo python3
>>> import os
>>> os.getlogin()
'ubuntu' # OK! 
```

*   `os.getenv`给出相同的结果：

```
$ python3
>>> import os
>>> os.getenv('SUDO_USER', os.getenv('USER'))
'ubuntu' # OK!

$ sudo su
$ python3
>>> import os
>>> os.getenv('SUDO_USER', os.getenv('USER'))
'ubuntu' # WRONG, should be root!

$ sudo python3
>>> import os
>>> os.getenv('SUDO_USER', os.getenv('USER'))
'ubuntu' # OK! 
```

切换`SUDO_USER`并`USER`给出错误的结果`sudo python3`以防万一。

## 实际解决方案（非便携式）

解决方案有点棘手，并且依赖于默认的根主目录位置，但适用于所有情况：

```
$ python3
>>> import os
>>> 'root' if os.path.expanduser('~') == '/root' else os.getenv('SUDO_USER', os.getenv('USER'))
'ubuntu' # OK!

$ sudo su
$ python3
>>> import os
>>> 'root' if os.path.expanduser('~') == '/root' else os.getenv('SUDO_USER', os.getenv('USER'))
'root' #  OK!

$ sudo python3
>>> import os
>>> 'root' if os.path.expanduser('~') == '/root' else os.getenv('SUDO_USER', os.getenv('USER'))
'ubuntu' # OK! 
```

# direct3d - Direct3D 10 和着色器管理

> ID：842068
> 
> 赞同：2
> 
> 时间：2009-05-08T22:22:16.683
> 
> 标签：direct3d, shader, directx-10

我正在使用 DirectX 10 编写 3d 应用程序，我想知道 Shadermanagement 的处理方式如何。

在应用程序启动时预加载所有着色器然后根据需要使用它们是否最有效，或者如果数量增加，这是否训练硬件资源？

另外我想知道通过着色器排序渲染是否是速度考虑因素，以便最小化着色器开关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T22:31:00.140

我没有用过 DX10，只有 DX9，但我猜这些东西还是一样的。

根据您的应用程序，您实际上可能会在运行时生成着色器（许多当前复杂的 3D 游戏都会这样做）。

预加载着色器并不是一个坏主意，这取决于您是否生成着色器、有多少个、您的内存考虑因素是什么——这取决于。但是，预加载着色器（我假设您的意思是创建 ID3DXEffect 实例）仅在运行时占用内存，而不占用 CPU。

按着色器排序是个好主意。一般来说，按材质排序是一个好主意，因为切换着色器确实会产生一些开销（不会过多，但根据应用程序的复杂性会很明显）。

[要对您的绘制调用进行排序，请阅读以下内容： http](http://realtimecollisiondetection.net/blog/?p=86) ://realtimecollisiondetection.net/blog/?p=86

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-18T09:05:07.547

在 D3D10 中，所有设备资源都是虚拟化的，因此您不会用完它们。当然，如果你不注意自己在做什么，你仍然可以耗尽卡上的物理资源并导致大量的颠簸。

此外，他们还显着更改了设备状态以降低切换状态的成本，包括着色器。

但是您真正要问的是“对于我的应用程序，方法 X 比方法 Y 快吗？” 尽管 D3D10 简化了状态管理以更快地切换状态，但回答上述问题的唯一方法是对**您的****应用**程序和数据进行性能测量。

realtimecollectiondetection.net 博客文章只是在讨论对绘制调用进行排序。这将导致更少的状态切换。不管状态切换有多快，做的越少总是越快。所以这是一个很好的一般建议。

# database - 您如何将一级类别重写为两级类别？

> ID：842071
> 
> 赞同：0
> 
> 时间：2009-05-08T22:23:02.390
> 
> 标签：database, seo, categories

假设在我的旧网站上，我有一个级别的产品类别，其中一个类别是“BMW Cars”。在其中，我有一些产品：“328i”、“M3”、“M5”、“X5”......所以基本上它是所有东西的大混合 - 因为一开始我们没有将产品线分成更细的类别。

现在我们正在建设一个新站点，并且有一个 2 层结构......现在我们有顶级“宝马汽车”和“宝马轿车”、“宝马跑车”、“宝马 SUV”等子猫......

关键问题 -> 我们在哪里重写旧的“宝马汽车”类别页面？我们是否将其指向顶级“宝马汽车”？这似乎合乎逻辑，但是：在另一个示例中，如果我们当前站点中的大多数产品都适合新站点的子类别之一，但有一小部分并不真正属于：

假设我们的旧宝马汽车有 90% 的轿车和 10% 的 SUV，将其转发到我们的新顶级捕获所有“宝马汽车”是否更合适，或者将其指向轿车是否可以，即使有些产品没有t 属于（显然是 SUV 的）...

如果它是 80/20 或 95/5 怎么办......截止百分比是多少，或者我们应该始终指向顶层以“安全”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T22:28:56.590

不要看汽车的百分比。查看访问的百分比。如果您网站上 90% 的宝马是轿车，10% 是 SUV，但 95% 的访问者搜索的是 SUV 而不是轿车，那么重定向到 SUV 可能更合适。

但就个人而言，我只会重定向到顶级“宝马汽车”。对于那些在旧的“BMW Cars”页面进行博彩并在更改后再次访问它的人来说，这是最不令人惊讶的。没有汽车会突然从他们的视野中消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T22:30:03.280

更接近 100/0 是具有最少样式和信息的点击页面。快速加载并带有两个突出的链接“轿车”和“所有汽车”，如果您对此感到困扰。您可以保存一个 cookie，以便尽管第一次给您的客户带来不便，但如果他们访问相同的链接，则该页面可以从那时起自动重定向。

# java - 实用的 GUI 工具包？

> ID：842075
> 
> 赞同：14
> 
> 时间：2009-05-08T22:25:43.353
> 
> 标签：java, python, ruby, user-interface, cross-platform

我正在考虑具有良好编程语言绑定（Java、Ruby 和 Python）的跨平台。什么是“最平坦”的学习曲线，但又有足够的能力来执行大多数标准的 GUI 功能？你们会推荐什么？[FOX](http://en.wikipedia.org/wiki/WxWidgets)、[wx](http://en.wikipedia.org/wiki/WxWidgets)、[Tk](http://en.wikipedia.org/wiki/Tk_%28framework%29)还是[Qt](http://en.wikipedia.org/wiki/Qt_(framework))？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-08T22:34:06.093

我会选择Qt。它适用于所有主要平台，并且正在不断改进。您也可以快速入门。有 Java、Ruby 和 Python 的绑定。
另外，如果您正在编写开源程序，它是免费的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-08T22:36:20.910

老实说，我用 Tk、wx 和 Qt 构建了一些东西，我同样讨厌它们。Qt 的可视化编辑器是我认为的三个中最不讨厌的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-08T22:46:36.377

一路WX！我不是 GUI 专家、设计师，甚至不是“GUI 人”，但最近我需要为产品配置工具编写前端（实际上它是工具的集合，但我们想要一个单一的界面来访问和运行它们全部）。
这些工具都是用 Python 编写的，所以我自然而然地转向了 Python 的 UI。
我选择了 wxPython... 一个“导入 wx” 和一些教程之后，我敲打着框架、笔记本和按钮面板，就像我知道自己在做什么一样。
当我遇到困难时，我找到了很多可以帮助我的示例，并且 wxPython 文档非常有用——尽管它们只是 C++ 文档，但它们仍然非常直观。
快速的网络搜索会找到大量的 wxPython 教程来帮助您入门。

我已经编写和重构了几次 UI，但我在不到 1 天的时间里就有了一个干净、可工作的原型。该工具是跨平台的，所有的窗口和框架都与本机窗口系统（WinXP、Win2K3、Gnome 等）相匹配——我绝对印象深刻。如果我必须用任何其他语言编写 UI，我肯定会寻找 wx 实现。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-08T22:57:48.517

Tk 仍然是一个非常可行的解决方案。学习曲线很大程度上取决于你。许多人，像我一样，可以或已经在大约一天内学会了 Tcl 和 Tk 的所有基础知识。经过多年的使用，有些仍然与语法作斗争。这完全取决于您在“忘却”使用 C 和 Java 等传统语言学到的东西方面的​​能力。如果您有任何 lisp 的背景知识，您可能可以在一个早上学习 Tcl。

Tk 的另一个好处是它可以与 Tcl、Perl、Python 和 Ruby（以及其他）一起使用，因此您不会被特定语言所束缚。虽然，没有 Tk 到 Java 的直接端口。用一种语言学习它，您的知识将很容易转移到其他语言。Tk 与 Tcl 和 Python 一起开箱即用，因此对于这些语言，无需安装其他任何东西。

不过，我要说的是，在过去几周编写了数百行 Python/Tkinter 代码之后，当涉及到 GUI 时，我非常*非常*喜欢用 Tcl 进行编码，但这更像是个人的事情，而不是其他任何事情。

有关 Tk 与 Tcl、Ruby 和 Perl 的更多信息，请参阅[http://www.tkdocs.com](http://www.tkdocs.com)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-08T22:44:18.893

如果您正在考虑使用 Java，那么[SWT](http://www.eclipse.org/swt/)是一个出色的跨平台 GUI 工具包。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-09T16:06:15.283

我强烈推荐[Rapid GUI Programming python 开发](http://www.amazon.ca/Rapid-GUI-Programming-Python-Development/dp/0132354187)书。[作者页面](http://www.qtrac.eu/pyqtbook.html)。

我记得 Elsevier 已经发布了一本 Python-GUI 的书，但是链接和名字现在让我忘记了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-08T22:44:06.037

我没有使用过 Qt，所以我无法判断它，但我使用过 wx，它很容易使用并且仍然很精简。此外，wxWidgets 在每个平台上都为您提供了本机小部件，这是一个巨大的优势（尤其是对于 Mac）。当其他人模仿原生平台的外观和感觉时，wxWidgets 直接使用原生小部件，这在许多情况下更快。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-08T23:01:36.713

如果 Java 是您的首选语言，请考虑[Groovy](http://en.wikipedia.org/wiki/Groovy_%28programming_language%29)。它是一种非常好的动态语言，它位于 Java 之上，并且在编写 GUI 方面具有一些非常好的特性（SwingBuilder）。如果不是因为我在 Tcl/tk 方面的高产，我认为 Groovy 将是我个人的第二选择，即使我不是 Java 或 Swing 本身的忠实粉丝。Groovy 看起来从这两者中消除了很多乏味。

有关更多信息，请参阅[使用 Groovy 进行 GUI 编程](http://groovy.codehaus.org/GUI+Programming+with+Groovy)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-09T06:40:54.050

我推荐Gtk。这是一个不错的、跨平台的、漂亮的工具包。它在设计时考虑了语言绑定，并允许创建漂亮的语言绑定（pygtk、ruby/gtk2、java-gnome、gtk# 等）。Gtk+ 很容易学习。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-07-21T02:05:10.903

我只想提一下，Qt 不仅仅是一个 GUI 工具包。您可以使用它获得更多，所有这些都很好地集成到框架中，如果您正在考虑跨平台开发，那么它非常值得使用。唯一的问题是，如果你想通过它的 Python 绑定 PyQt 使用它，你要么必须支付 PyQt 商业许可证（昂贵）或 GPL 你的代码。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-03-08T22:48:16.280

Gtk 是一个很棒的跨平台工具包。此外，ruby 的绑定都在 ruby​​gem 中可用，因此非常易于安装。Gtk 用于许多程序，例如 nautilus，并且有很多很多的功能。权衡是 Gtk 做了这么多，它有点复杂。

当我编写一个 gui 时，我拒绝手动编写每个小部件，我坚持使用图形环境来构建我的表单。我认为这意味着使用 Glade 或 QT Creator。我尝试了 QT Creator，发现它太慢了，我无法使用它，所以我用 glade 构建了我的表单。

当您在 glade 中构建表单时，表单的属性会保存在 XML 文件中，您的语言可以读取该文件。许多语言都有“Gtk::Builder”模块来读取 XML 文件，然后使用 GTK 在运行时在屏幕上显示表单。因此，如果您使用 glade，您可以使用您选择的语言（C java、ruby、python），并且您不需要“手动编码”所有表单。

考虑到语言的选择，我会选择 ruby​​。

公平地说，我没有尝试过 wxRuby 或 Tk。但我知道我不想手动编写 GUI。你可以在 visualruby.net 上看到我在这方面的工作。我使用 ruby​​ 和 glade 来创建许多 GUI。

# javascript - Adobe AIR 无限制访问...如何限制它？

> ID：842076
> 
> 赞同：4
> 
> 时间：2009-05-08T22:25:52.837
> 
> 标签：javascript, dialog, air, installation

我在 Adob​​e AIR 中编写了我的第一个应用程序，但我注意到在安装对话框中它说我的程序可以不受限制地访问文件系统等，我认为这可能会吓到潜在用户。

有什么办法可以限制它，使消息不会出现在对话框中？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T05:09:51.673

没有。您无法隐藏警告 - 这是一件好事，因为（目前）还没有办法制作*无法*完全访问用户文件系统的 AIR 应用程序。理论上，任何 AIR 应用程序*都可以*在不通知用户的情况下删除随机文件，因此警告是非常必要的。我相信受限制的 AIR 应用程序是 Adob​​e 为未来计划的东西，但到目前为止还没有。

您可以在该对话框中控制的唯一想法是，如果您使用用户信任的证书签署您的应用程序，那么您的姓名将出现在“发布者”字段中。否则它将是“未知的”。

（请注意，如果用户确实安装了您的应用程序，那么在将来他们升级时，您可以替换自定义对话框。但是对于初始安装，您会使用标准对话框。）

# apache-flex - 使用 Flash Runtime 作为平台（类似于 JVM/CLR）

> ID：842095
> 
> 赞同：0
> 
> 时间：2009-05-08T22:30:50.470
> 
> 标签：apache-flex, compiler-construction, flash

有谁知道是否存在任何编译器可以从 Flex 以外的源代码生成将在 Flash 运行时运行的程序？

即类似于 Groovy、Scala 等编译器如何为 JVM 生成字节码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T22:38:21.387

您的意思是“除了 ActionScript 3”。Flex 是一个用于构建 RIA 的 AS3 框架。

Adobe 有一个名为 Adob​​e Alchemy 的项目，它提供了编译 C/C++ 代码并在 AVM（ActionScript 虚拟机）中运行它的工具。

[http://labs.adobe.com/technologies/alchemy/](http://labs.adobe.com/technologies/alchemy/)

可能还有其他人，但我不记得了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T00:14:39.207

您可以查看 OpenLaszlo，它是一种 flex 替代方案，它编译为 flash 运行时：

[www.openlaszlo.org/](http://www.openlaszlo.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T22:44:51.357

Actionscript 是 javascript 的严格超集，因此很明显首先要提到这一点。所以AS编译器可以直接消费javascript。

这使您可以访问诸如 jQuery、extJS 等“语言”。

# winforms - Windows 窗体 C#.net 部署问题

> ID：842101
> 
> 赞同：0
> 
> 时间：2009-05-08T22:32:58.780
> 
> 标签：winforms, deployment

我刚刚完成了一个 WinForms 应用程序，它运行良好！现在，是时候部署了。问题是，我不想创建一个安装文件，而是一个可执行文件，例如“myApp.exe”。这样做的原因是因为它将在 CD 媒体上重新分发，并且当 CD 插入用户的 PC 时，它应该作为独立应用程序自动运行。

这里有什么想法吗？

其次，如何从应用程序中创建对 CD 上包含的“.txt”文件的引用？我想提供文件的链接，但我不确定如何进行路径引用。

TIA...我真的很困惑这里！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T23:39:01.337

当您在代码中引用“.txt”文件时，只需使用执行应用程序的相对路径即可。例如，如果您的 .txt 文件与可执行文件位于同一目录中，请在没有任何路径的情况下引用它们（“filename.txt”），或者您可以使用（“.\filename.txt”）。

至于不安装您的应用程序，只需确保您没有使用任何需要在客户端上安装的第三方库，只需烧录您的应用程序 /bin/ 目录的内容并使用 autorun.ini 文件启动您的可执行程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T22:39:02.227

您可以在 exe 中使用嵌入式资源而不是单独的文件：http: [//jopinblog.wordpress.com/2007/11/12/embedded-resource-queries-or-how-to-manage-sql-code-in-your -网络项目/](http://jopinblog.wordpress.com/2007/11/12/embedded-resource-queries-or-how-to-manage-sql-code-in-your-net-projects/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T12:14:27.863

@Shalan，回复：你的答案：

当心！你会惹恼你的用户和维护程序员！

我已经看到并修复了这个错误至少几十次。

你确定你知道当前目录是什么？例如，OpenFileDialog 和 SaveFileDialog 可以更改它，然后您将无法找到您的 .dot 文件。

如果用户使用不同的工作目录启动应用程序怎么办？那么你也会失败。请记住，您无法控制您的工作目录——如果用户更改默认目录，您的应用程序将会失败。

如果您必须找到应用程序可执行文件的路径，请考虑将[Application.StartupPath](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.startuppath.aspx)与[System.IO.Path](http://msdn.microsoft.com/en-us/library/system.io.path.aspx)一起使用。例如：

```
string dotSubPath = System.IO.Path.Combine("Assets", "MyDocument.dot");
string templatePath = System.IO.Path.Combine(Application.StartupPath, dotSubPath); 
```

这将始终根据应用程序的启动目录获取路径，而不仅仅是工作目录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T11:53:50.773

对于那些感兴趣的人，对我也有用的，我需要来自应用程序可执行文件的参考路径，是使用“Environment.GetCurrentDirectory”

例如，我提供了我的 MS Word .dot 模板的路径：

```
Object templatePath = Environment.GetCurrentDirectory + "\\Assets\\MyDocument.dot"; 
```

# merge - 如何使用 opendiff 合并两个目录？

> ID：842102
> 
> 赞同：0
> 
> 时间：2009-05-08T22:33:38.497
> 
> 标签：merge, directory

这应该很简单吧？我想比较两个目录，foo 和 bar。我想挑选 foo 中的更改并将它们放在 bar 中。如果我跑

```
opendiff foo bar -merge bar 
```

要将 bar 指定为合并目录，当我在单个文件上“保存合并”时没有任何反应。如果我没有指定合并并从保存对话框中选择 bar 作为我的合并目录，它会给我一个错误。

我肯定错过了什么吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2010-06-04T18:03:24.120

这是关于 opendiff 的文档：

[http://www.manpagez.com/man/1/opendiff/](http://www.manpagez.com/man/1/opendiff/)

# visual-c++ - 什么可能会阻止 DLL 使用 LoadLibrary 加载？

> ID：842111
> 
> 赞同：5
> 
> 时间：2009-05-08T22:37:05.760
> 
> 标签：visual-c++, dll, loadlibrary, jdedwards

我有一个 JD Edwards 业务功能，它是用 Microsoft Visual C++ 作为 C 模块编写的。我正在使用 LoadLibrary 访问第三方 DLL。在独立的测试程序中，代码运行得很好。当我从 JDE 中运行它时，LoadLibrary 返回 NULL，GetLastError 返回 126，这意味着`The specified module could not be found`根据 MSDN。我已经尝试输入 DLL 的完整路径，是的，我记得将路径中的 \ 字符加倍。没有不同。

我已经检查以确保没有任何依赖项会阻止 DLL 加载；DUMPBIN /DEPENDENTS 返回以下内容：

```
WSOCK32.dll
USER32.dll
GDI32.dll
WINSPOOL.DRV
ADVAPI32.dll
KERNEL32.dll 
```

这些看起来像标准的 Windows DLL，所以我很茫然。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T22:51:16.193

缺少依赖？您是否与[Dependency Walker](http://www.dependencywalker.com/)确认找到所有引用的库？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T15:36:57.333

如果在 LoadLibrary 调用期间附加调试器，它可能会向调试输出发送错误信息。除了此处的其他建议外，如果清单中有错误，则会出现此问题。

我很确定它对你来说是一个依赖问题。试试 ProcMon 的东西，并尝试在 Vista 上运行，看看是否能解决问题。[您可以在此处](http://www.microsoft.com/downloads/details.aspx?FamilyID=21eabb90-958f-4b64-b5f1-73d0a413c8ef&displaylang=en)获取测试 VPC 映像。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-05T15:19:14.043

我曾经陷入同样的​​噩梦。无法诊断任何东西，我刚刚发现重置 dll 搜索列表顺序路径（这里的关键字可能是“列表”，而不是“顺序”）解决了这个问题。

SetDllDirectory(NULL);

解释是中间的第三方DLL可能是在搞乱它，没有恢复它的原始状态。这可以解释为什么只有您的测试应用程序在工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-08T11:43:03.417

此外，可以使用配置文件选项运行[Dependency walker 。](http://www.dependencywalker.com/)在这种情况下，exe 必须在依赖 walker 中加载。之后可以使用菜单“配置文件”。

然后启动应用程序并填充 dll 树。这还将显示是否缺少延迟加载 dll 和其他内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-22T19:47:48.313

如果您无法通过检查依赖项找到答案，我建议您专注于架构可能导致的问题。

您提到您正在使用独立的测试环境，但是当您在常规环境中尝试时它不起作用。业务功能设置是否在服务器中运行？

自从我上次使用 JDE 以来已经有一段时间了。我记得有一次我用 C 语言编写了一个 BSFN，以一种同步方式调用多个 UBE，它在我的本地机器上运行良好，但在我在服务器上测试时却无法运行。服务器无法找到 DLL（即使我提供了路径）和一些必需的设置存在一些问题。此外，在我的情况下，有一个关键的区别：在我的机器上，BSFN 将等待 UBE 的完成并捕获状态，在服务器上它不会，它还与对象的设置有关.

同样，如果您没有发现任何有用的信息，请尝试在 www.jdelist.com 上寻求帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T15:32:48.870

您可以尝试在[ProcMon](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)运行时进行测试，看看在启用文件监视时是否有任何错误可见。

# java - 为什么只执行 java 方法的前缀返回类型？

> ID：842114
> 
> 赞同：0
> 
> 时间：2009-05-08T22:37:50.127
> 
> 标签：java, static, methods, protected

我试图理解一些 java 代码，由于某种原因，这些代码似乎执行了它的返回类型类（SQLExecutionInfo 类），而在方法中没有其他任何东西。也许这就是java的工作原理（即不管方法体中的内容是否首先执行返回的类的类型？？）

该方法由此开始：

```
protected Query.SQLExecutionInfo compileSingleQDB(StatementExpression statement, boolean keyNeeded) throws StatementException, XMLDBCException {

//body of method
System.out.println("body of method");
}

/*****THE REFERENCED SQLExecutionInfo class is a subclassed within Query.java***********/

public static class SQLExecutionInfo {
    public SqlExpression sql = null;
    public StatementInfo sInfo = null;
    public Mapper mapper = null;
    public List childrenQueries = null;
    public int[] idPosition = null;
    public int idCount = -1;

    public SQLExecutionInfo() {
    }

    public SQLExecutionInfo(SqlExpression sql, Mapper mapper) {
        System.out.println("POINT ALPHA2:"+ sql);
        this.sql = sql;
        this.mapper = mapper;
    } 
```

由于某种原因，compileSingleQDB 方法（即主体）中没有任何内容被执行，但是调用了类 SQLExecutionInfo 并调用了 System.out.println("POINT ALPHA2:"+ sql)。

谁能向我解释这是为什么？

谢谢，巴勃罗

请让我提供更多信息：

这个让我很疑惑

代码执行全部从这里开始：

```
 System.out.println("POINT SQL:"+jdbcExecInfo.sql); // Returns null at this stage    
try {
   System.out.println("POINT A");
   jdbcExecInfo = compileSingleQDB(((Variable) Qdb.get(0)).getExpression(), false);
   System.out.println("POINT B");
    } catch (Exception e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
    }
System.out.println("POINT SQL:"+jdbcExecInfo.sql); // Somehow now has a value  ???? 
```

不知何故，它仍然达到 B 点，即使我输入：`Thread.dumpStack(); and new Error().printStackTrace();`

在 compileSingleQDB 方法中什么也没有出现。

即使我撕掉 compileSingleQDB 方法的内部结构并将其替换为：

```
protected Query.SQLExecutionInfo compileSingleQDB(StatementExpression statement, boolean keyNeeded) throws XQueryException, XMLDBCException {

    return null;
} 
```

字符串 jdbcExecInfo.sql 仍然以某种方式获得一个值

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T22:59:09.357

您发布的代码不足以解释该行为。请注意，类型或类不是“调用”的。print 语句在构造函数中，因此显然`SQLExecutionInfo`在某处创建了一个实例（不，Java 不会自动执行此操作）。在未执行末尾的 print 语句时发生这种情况`compileSingleQDB()`可能有多种原因：抛出异常、多线程或只是错误的代码。

尝试减少代码以查明问题，直到您自己找到它或者您有一个足够小的版本来完全发布，以便我们可以重现该行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T22:40:43.677

编辑问题后，我之前的答案不适用。

我的猜测是这个示例缺少一些相关代码。

# python - 将批处理文件输出管道传输到 Python 脚本

> ID：842120
> 
> 赞同：3
> 
> 时间：2009-05-08T22:41:21.693
> 
> 标签：python, windows, scripting, batch-file, io

我正在尝试编写一个运行批处理文件并将该批处理文件的命令行输出作为输入的python脚本（在Windows中）。批处理文件运行我无权访问的进程，并根据这些进程是否成功提供输出。我想从批处理文件中获取这些消息并在 python 脚本中使用它们。有人对如何做到这一点有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-09T00:24:23.880

```
import subprocess

output= subprocess.Popen(
    ("c:\\bin\\batch.bat", "an_argument", "another_argument"),
    stdout=subprocess.PIPE).stdout

for line in output:
    # do your work here

output.close() 
```

请注意，最好以“ `@echo off`”开头您的批处理文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T00:01:12.123

这是一个运行 test.bat 并显示输出的示例 python 脚本：

```
import os

fh = os.popen("test.bat")
output = fh.read()
print "This is the output of test.bat:", output
fh.close() 
```

test.bat 的来源：

```
@echo off
echo "This is test.bat" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T22:47:00.430

试试 subprocess.Popen()。它允许您将 stdout 和 stderr 重定向到文件。

# .net - 如何使用 Request.Context.Browser 对象改进浏览器检测？

> ID：842121
> 
> 赞同：0
> 
> 时间：2009-05-08T22:41:25.280
> 
> 标签：.net, browser

我在 .NET 2.0 中使用 HTTP 处理程序，需要检测浏览器和版本。如何在 .NET 2.0 中实现[Ocean 的 Browsercaps ？](http://owenbrady.net/browsercaps/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T15:04:55.293

您可以通过电子邮件向相关软件包的维护者 Owen Brady 发送电子邮件。他确实有一个独立于微软 Browsercaps 处理器运行的软件版本。[2.0版本](http://owenbrady.net/projects/Ocean2.Web.HttpCapabilities.zip)

# .net - .Net 每个返回值的事件都有多个事件处理程序

> ID：842122
> 
> 赞同：3
> 
> 时间：2009-05-08T22:41:54.203
> 
> 标签：.net, event-handling

如果我有一个事件，其处理程序返回一个布尔值，如果我附加多个事件会发生什么？

看这个例子

```
public class MyClass
{
 public delegate bool MyEventHandler(object sender, EventArgs e);
 public event MyEventHandler Submit;

 public void DoSubmissions()
 {
  if (Submit != null && Submit(this, null))
  {
   Console.Write("HOORAY");
  }
 }
} 
```

所以在我的示例中，处理程序在成功提交时返回 true。但是我为事件分配了两个处理程序……会发生什么？使用第一个处理程序的返回值？第二个？两者都不？两个都？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T23:22:03.687

一般来说，这是一个糟糕的设计。

考虑使用像[CancelEventArgs](http://msdn.microsoft.com/en-us/library/system.componentmodel.canceleventargs.aspx)这样的模式，您可以在其中将返回值嵌入 EventArgs。这让未来的处理程序可以检查和/或更改值。A 的`ref`工作方式相同，因为它会[从 handler 传递到 handler](http://msdn.microsoft.com/en-us/library/system.delegate.aspx)，但在 IMO 中有点出乎意料：

> 当签名包含通过引用传递的参数时，参数的最终值是调用列表中的每个方法顺序执行并更新参数值的结果。

但是，是的 - 在您的示例中，它是[最后一个处理程序，称为](http://msdn.microsoft.com/en-us/library/system.delegate.aspx)：

> 当委托调用的方法的签名包含返回值时，委托返回调用列表中最后一个元素的返回值。

[保证按照](http://msdn.microsoft.com/en-us/library/aa691375(VS.71).aspx)添加顺序：

> [addition] 操作的结果是一个新的委托实例，当被调用时，它会调用第一个操作数，然后调用第二个操作数

但是，由于没有处理程序知道它是第一个、中间还是最后一个 - 这对我来说似乎没用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T22:47:13.737

使用要注册的最后一个事件的返回值。

# c# - 格式化生成的 C# 代码

> ID：842123
> 
> 赞同：2
> 
> 时间：2009-05-08T22:42:32.297
> 
> 标签：c#, formatting, code-generation

## 复制

> [C# 正确格式化（缩进、对齐）C#](https://stackoverflow.com/questions/681500/c-to-format-indent-align-c-properly)

* * *

我正在生成一堆代码，并希望它的初始输出（前 ctrl+K、Ctrl+D）看起来合理。管理缩进是一件非常痛苦的事情，必须有一个实用程序或类可以嵌入到我的代码生成器中。我将其嵌入到 VS 加载项和构建过程中，因此我对外部程序不感兴趣。我需要一些我可以以编程方式调用的东西。

建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T22:48:10.287

使用 Microsoft .NET Framework 提供的[IndentedTextWriter](http://msdn.microsoft.com/en-us/library/system.codedom.compiler.indentedtextwriter.aspx)来帮助缩进代码。类文档中包含示例用法。

# regex - 用逗号替换第一个下划线的正则表达式

> ID：842125
> 
> 赞同：0
> 
> 时间：2009-05-08T22:43:40.050
> 
> 标签：regex, vim

我有这个模式

```
a,abc_def_eghi
1,234_556
5,567_987_ghi 
```

我想`_`用`,`. 我知道`%s/old/new/g`要替换 Vim 中的内容。

结果

```
a,abc,def_eghi
1,234,556
5,567,987_ghi 
```

你能建议一些替代方案吗

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-08T22:46:20.247

这`g`是“全球”。如果您将其关闭，则替换将仅在每行上应用一次。

```
%s/old/new/ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T22:47:28.620

如果您只想替换第*一次*出现的匹配项，请不要使用`g`修饰符。也就是说，使用`s/old/new/`而不是`s/old/new/g`. 更多 vim 搜索/替换提示和技巧可以在[Wikia](http://vim.wikia.com/wiki/Search_and_replace)上找到。

# c# - 有没有办法确定当前的 Outlook 活动级别？

> ID：842126
> 
> 赞同：0
> 
> 时间：2009-05-08T22:43:42.093
> 
> 标签：c#, outlook-2007, outlook-addin

我正在使用 C# (VS2008) 编写 Outlook 2007 插件，我们只想在 Outlook 不忙于做其他事情时发送一些后台电子邮件项目。是否有 .net 方法可以查看 Outlook 是否正忙于做其他事情（可能是由于其他加载项等占用 CPU 周期）？

或者，有没有办法发送电子邮件，使它们永远不会出现在发件箱中？我们需要一种不需要安装任何额外软件的方法。

感谢您的任何意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-10T08:44:00.320

我能想到的就是监控OST文件的日期时间。不是很好，但它是一些东西。你在这方面做得如何？

# .net - 标准线程安全的 .Net 字典

> ID：842130
> 
> 赞同：3
> 
> 时间：2009-05-08T22:44:34.883
> 
> 标签：.net, multithreading, dictionary

[MSDN](http://msdn.microsoft.com/en-us/library/3fcwy8h6.aspx)指出，对 .NET`Dictionary<K,V>`类型的变异访问不是线程安全的。有标准的线程安全版本吗？

*注意：* “不，没有”是一个有效的答案，如果它是真的。在那种情况下（看起来是这样），我会去做锁的事情。

* * *

## 几乎重复

[在 .NET 中实现线程安全字典的最佳方法是什么？](https://stackoverflow.com/questions/157933/whats-the-best-way-of-implementing-a-thread-safe-dictionary-in-net)（不准确，因为我想要一个标准类型，而不是我自己实现的东西）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T22:49:56.617

没有。考虑这段代码，其中每个方法/属性都是线程安全的

```
if (!SFdict.Contains(key))
{
   SFdict[key] = value;
} 
```

尽管每个动作都可以是线程安全的，但代码块有一个竞争条件，b/c 有两个方法调用和两个不同的临界区。唯一的方法是手工

```
lock(lck)
{
   if (!dict.Contains(key))
   {
      dict[key] = value;
   }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T22:57:21.717

虽然[`Hashtable`](http://msdn.microsoft.com/en-us/library/system.collections.hashtable(VS.71).aspx)不是通用的，但只要您正确使用它，它就是线程安全的（一个写入器，多个读取器，没有枚举）。

> **线程安全**
> 
> 为了支持一个或多个写入器，对 Hashtable 的所有操作都必须通过 Synchronized 方法返回的包装器来完成。
> 
> 通过集合进行枚举本质上不是线程安全的过程。即使一个集合是同步的，其他线程仍然可以修改该集合，这会导致枚举器抛出异常。为了保证枚举过程中的线程安全，您可以在整个枚举过程中锁定集合，也可以捕获其他线程更改导致的异常。

它与 a 虽然不同-如果您尝试获取不存在的值，`Dictionary<K, V>`它将返回`null`，而不是抛出 a （因此存储空值可能会出现问题）。`KeyNotFoundException`如果您知道尝试添加新密钥的线程永远不会超过一个，并且可以处理该`null`问题，那么这是一个非常有用的集合。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-03-21T02:30:52.213

.NET 4.0 现在有一个[`ConcurrentDictionary<K,T>`](https://msdn.microsoft.com/en-us/library/dd287191(v=vs.100).aspx)似乎可以做你想做的事的类。[同样在 .NET 4.5 中](https://msdn.microsoft.com/en-us/library/dd287191(v=vs.110).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T22:49:35.790

除了重复问题的答案之外，您可能还想看看[这个使用`ReaderWriterSlim`](http://devplanet.com/blogs/brianr/archive/2008/09/26/thread-safe-dictionary-in-net.aspx). `ReaderWriterSlim`实际上应该比简单的锁定（有效地使用`Monitor`）提供一些性能优势 - 一定要看看。

# matlab - 在 Matlab 中找到带有噪声数据的近似局部最大值

> ID：842131
> 
> 赞同：3
> 
> 时间：2009-05-08T22:44:49.423
> 
> 标签：matlab, maximize, noise

matlab FAQ 描述了一种查找局部最大值的单行方法：

```
index = find( diff( sign( diff([0; x(:); 0]) ) ) < 0 ); 
```

但我相信这只有在数据或多或少平滑的情况下才有效。假设您有数据以小间隔上下跳跃，但仍有一些近似的局部最大值。您将如何找到这些点？您可以将向量分成 n 部分，并找到不在每个部分边缘的最大值，但应该有一个更优雅和更快的解决方案。

单线解决方案也很棒。

**编辑：**我正在处理嘈杂的生物图像，我试图将它们分成不同的部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T23:03:52.090

我不确定您正在处理什么类型的数据，但这是我用来处理语音数据的一种方法，可以帮助您找到局部最大值。它使用信号处理工具箱中的三个函数：[HILBERT](http://www.mathworks.com/access/helpdesk/help/toolbox/signal/hilbert.html)、[BUTTER](http://www.mathworks.com/access/helpdesk/help/toolbox/signal/butter.html)和[FILTFILT](http://www.mathworks.com/access/helpdesk/help/toolbox/signal/filtfilt.html)。

```
data = (...the waveform of noisy data...);
Fs = (...the sampling rate of the data...);
[b,a] = butter(5,20/(Fs/2),'low');  % Create a low-pass butterworth filter;
                                    %   adjust the values as needed.
smoothData = filtfilt(b,a,abs(hilbert(data)));  % Apply a hilbert transform
                                                %   and filter the data. 
```

然后，您将在**smoothData**上执行最大值查找。使用 HILBERT 首先在数据上创建一个正包络，然后 FILTFILT 使用来自 BUTTER 的滤波器系数对数据包络进行低通滤波。

有关此处理如何工作的示例，这里有一些图像显示了一段录制语音的结果。蓝线是原始语音信号，红线是包络（使用 HILBERT 获得），绿线是低通滤波结果。下图是第一个的放大版本。

![替代文字](https://i37.photobucket.com/albums/e77/kpeaton/audio_proc.png)

**随机尝试：**

这是我起初的一个随机想法......您可以尝试通过找到最大值的最大值来重复该过程：

```
index = find(diff(sign(diff([0; x(:); 0]))) < 0);
maxIndex = index(find(diff(sign(diff([0; x(index); 0]))) < 0)); 
```

但是，根据信噪比，不清楚需要重复多少次才能获得您感兴趣的局部最大值。这只是一个随机的非过滤选项。=)

**最大发现：**

以防你好奇，我见过的另一种单线最大值查找算法（除了你列出的那个）是：

```
index = find((x > [x(1) x(1:(end-1))]) & (x >= [x(2:end) x(end)])); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T02:08:15.813

根据您的需要，过滤噪声数据通常很有帮助。看看[MEDFILT1](http://www.mathworks.com/access/helpdesk/help/toolbox/signal/medfilt1.html)，或者使用[CONV](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/conv.html)和[FSPECIAL](http://www.mathworks.com/access/helpdesk/help/toolbox/images/fspecial.html)。在后一种方法中，您可能希望使用 CONV 的“相同”参数和 FSPECIAL 创建的“高斯”过滤器。

完成过滤后，将其输入最大值查找器。

**编辑：** *运行时复杂性*

假设输入向量的长度为 X，滤波器内核长度为 K。

中值滤波器可以通过运行插入排序来工作，所以它应该是 O(X *K + K log K)。没看源码，其他实现也是可以的，但基本上应该是O(X* K)。

当 K 较小时，conv 使用直接的 O(X*K) 算法。当 X 和 K 几乎相同时，使用快速傅立叶变换会更快。该实现是 O(X log X + K log K)。Matlab 足够聪明，可以根据输入大小自动选择正确的算法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T23:05:57.483

如果您的数据上下跳跃很多，那么该函数将有许多局部最大值。所以我假设你不想找到所有的局部最大值。但是，您对局部最大值的标准是什么？如果您有一个标准，那么可以为此设计一个方案或算法。

我现在猜想也许你应该先对你的数据应用一个低通滤波器，然后找到局部最大值。尽管过滤后的局部最大值的位置可能与之前的位置不完全对应。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T03:52:59.977

有两种方法可以查看此类问题。人们可以将其视为主要的平滑问题，使用过滤工具对数据进行平滑处理，然后才使用各种插值（可能是插值样条）进行插值。找到插值样条的局部最大值是一件很容易的事情。（请注意，您通常应该在这里使用真正的样条，而不是 pchip 插值。在 interp1 中指定“三次”插值时采用的方法 Pchip 不会准确定位落在两个数据点之间的局部最小值。）

解决此类问题的另一种方法是我倾向于使用的方法。这里使用最小二乘样条模型来平滑数据并产生近似值而不是插值。这种最小二乘样条具有允许用户大量控制将他们对问题的知识引入模型的优点。例如，科学家或工程师通常拥有关于所研究过程的信息，例如单调性。这可以构建到最小二乘样条模型中。另一个相关的选项是使用平滑样条。它们也可以通过内置的正则化约束来构建。如果您有样条工具箱，那么 spap2 将具有适合样条模型的一些实用程序。然后 fnmin 会找到一个最小化器。（最大化器很容易从最小化代码中获得。）

当数据点等距时，采用过滤方法的平滑方案通常最简单。不等间距可能会推动最小二乘样条模型。另一方面，结位置可能是最小二乘样条中的一个问题。我在所有这些中的观点是表明任何一种方法都有优点，并且可以产生可行的结果。

# c# - 使用 C# 正则表达式转换字符串中的大小写

> ID：842135
> 
> 赞同：3
> 
> 时间：2009-05-08T22:45:19.047
> 
> 标签：c#, regex, string

我怎样才能转换这个字符串：

`bKk_035A_paint-House_V003`
到
`BKK_035a_paint-House_v003`

使用正则表达式（例如 Regex.Replace）？
此正则表达式匹配字符串：

```
^(?<Group1>[a-z][a-z0-9]{1,2})_(?<Group2>\d{3}[a-z]{0,2})_(?<Group3>[a-z-]+)_(?<Group4>v\d{3,5})$ 
```

*   Group1 = 大写
*   Group2 = 小写
*   Group3 = 不变
*   Group4 = 小写

感谢您的帮助，
帕特里克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T22:55:32.750

正则表达式与第一个字符串不匹配...

我假设您想要前 3 个字符大写，其余的小写？

这是第一遍：

```
const string mod = @"^([a-z][a-z0-9]{1,2})(_\d{3}[a-z]{0,2}_[a-z]+_v{1}\d{3,5})$";
var converted = 
    new Regex(mod, RegexOptions.IgnoreCase)
        .Replace(input1, 
            m => string.Format(
                   "{0}_{1}",
                   m.Groups[1].ToString().ToUpper(),
                   m.Groups[2].ToString().ToLower()
                 )
                ); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T23:13:49.757

另一种替代使用`Split`和`Join`方法。

```
 const string input = "bKk_035A_paint-House_V003";
    string[] strParts = input.Split('_');
    strParts[0] = strParts[0].ToUpperInvariant();
    strParts[1] = strParts[1].ToLowerInvariant();
    strParts[3] = strParts[3].ToLowerInvariant();
    string result = String.Join("_", strParts); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T00:01:27.787

## 我使用的最终代码

```
string input = "lAl_058a_068b_COMP_dsj_V001.txt";
string regex = @"^(?<Group1>[a-z][a-z0-9]{1,2})_(?<Group2>\d{3}[a-z]{0,2})_(?<Group3>[a-z-]+)_(?<Group4>v\d{3,5})$";

StringBuilder sb = new StringBuilder(input);
Match m = Regex.Match(input, regex, RegexOptions.IgnoreCase | RegexOptions.Multiline);
if (m.Success)
{
    Group g;
    g = m.Groups["Group1"];
    sb.Replace(g.Value, g.Value.ToUpper(), g.Index, g.Length);
    g = m.Groups["Group2"];
    sb.Replace(g.Value, g.Value.ToLower(), g.Index, g.Length);
    g = m.Groups["Group4"];
    sb.Replace(g.Value, g.Value.ToLower(), g.Index, g.Length);
} 
```

感谢您的所有评论，帕特里克

# php - 将 Rails 与 PHP 与非技术人员进行比较

> ID：842144
> 
> 赞同：4
> 
> 时间：2009-05-08T22:48:16.077
> 
> 标签：php, ruby-on-rails, zend-framework

我最近在一家小公司接受了采访，该公司希望大大增加其网络影响力，包括重写他们的 Flash 主页和开设一个电子商务网站。如果得到这个职位，我将成为员工中唯一的开发人员。

我已经使用 Rails 很多年了，并且有一段时间没有研究 PHP。但是，如果我要得到这份工作，我会推荐该框架，因为员工中还没有任何精通开发的人。

我认为对于许多非程序员来说，PHP 作为构建网站的语言仍然具有巨大的知名度，因此它作为许多公司的逻辑默认设置。

如果我得到这份工作，我如何在不涉及技术术语的情况下比较 Rails 与 PHP（使用适当的框架）的优缺点？这里的一个关键考虑因素是，该领域的 LAMP 开发人员可能比 Rails 开发人员多得多，我不希望我自己的个人偏好影响代码库的长期可持续性。

还是我应该接受 PHP/Zend 站点与 Rails 站点一样好，即使开发起来不那么有趣？

（请不要宗教争论！）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-09T00:49:41.557

我要说的第一件事是（恕我直言）你的方法是错误的，因为你已经从一个结论开始（“我想在 Rails 中这样做”），你现在正在寻找一个理由。

更糟糕的是，这种态度近乎疏忽大意，因为您对客户负有道德甚至法律义务，您应该首先解决他们的需求，而不是您的需求。

[继续经典 ASP 站点](https://stackoverflow.com/questions/523346/continue-a-classic-asp-site-or-insist-a-language-change)中出现了同样的问题还是坚持更改语言？

这里要说明的重要一点是，使用 Rails（通常表示 Ruby on Rails，尽管它可能是 Groovy 等），您将框架与语言 (PHP) 进行比较。有**许多**PHP 框架，因此如果您将 Ruby on Rails 与 PHP + 一些您同样熟悉的框架或一些框架进行比较，那么很多编码速度问题即使没有完全消失，也会减少。

根据经验，我可以告诉您，非技术用户会关注以下部分或全部内容：

1.  开发成本；
2.  主办费用；
3.  外观和感觉；
4.  网站功能；
5.  能够找到开发人员；
6.  稳定;
7.  现有功能；和
8.  风险。

(1) 值得商榷。如果您以 Ruby 方式做事，Ruby on Rails 可能会非常快，但如果需求迫使您放弃预订，则可能会变得非常困难。有趣的是，Microsoft 堆栈倾向于以相同的方式工作（尽管它们通常有更大的保留来进一步扩展该隐喻）。

这是[我在使用 Rails 2 年后转回 PHP 的 7 个原因](http://www.oreillynet.com/ruby/blog/2007/09/7_reasons_i_switched_back_to_p_1.html)。同意或不同意，这类帖子提出了您至少需要考虑和/或解决的问题。

(2) 我认为是 PHP 的胜利。PHP 共享主机非常便宜，但价格也不高。如果该站点将获得适度的流量或存在重大的安全问题，您最终将在站点上托管它或使用某种形式的 VPS 或专用托管，此时问题将成为一个问题。

(3) 并没有那么不同。Ruby 是倾斜的两个原型（正在集成）等，而 PHP 对任何 Javascript 框架（有优点和缺点）更开放，并且两者都可以在 HTML 和 CSS 中做任何事情。

同样适用于（4）。没有什么是你可以做的，你不能做的。

(5) 显然是 PHP 的胜利。您可能不会雇用数百名开发人员，但如果您继续前进或被替换，很容易找到具有相关经验的其他人，这**对非技术人员**很重要（对技术人员也应该很重要）。

(6) 对于 PHP 来说，要么是感知的，要么是真正的胜利。我的意思是Ruby on Rails——至少在我的经验中——以不稳定和/或浪费资源着称。诸如 Zed Shaw 臭名昭著的[Rails Is A Ghetto](http://www.zedshaw.com/rants/rails_is_a_ghetto.html)咆哮之类的帖子就是例证。这显然是一个咆哮，但那里也有一些有效的观点。

(7) 是一个有趣的问题。Rails 要求（或者更确切地说“是”）一个 ORM 框架，并且像许多 ORM 框架一样，它们在处理“遗留”数据时可能会遇到真正的问题。我把它放在引号中，因为 ORM 有一个讨厌的习惯，即把没有按照他们的方式做的任何事情都声明为“遗留”（例如复合键）。

如果您可以完全控制此站点上的数据模型并且没有现有的数据模型可以支持，那么这个问题可能是 Rails 的胜利，但您拥有的约束越多，这将是 PHP 的轻量级（通常是原始 SQL）的胜利方法。

您可能想看看[Using an ORM or plain SQL?](https://stackoverflow.com/questions/494816/using-an-orm-or-plain-sql)

(8) 确实总结了以上所有内容。公司将非常关注最终结果的可预测性，而更可预测、不那么性感的最终结果通常会胜出。

我要说的最后一件事是，如果您同时拥有 Rails 和 PHP 经验（如您所见）并且您需要询问 Rails 的（非技术）优点是什么，也许您需要重新检查您是什么做以及为什么要做。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-08T22:57:24.603

我不会争辩说 Rails 比 PHP 或类似的东西更好，因为对于这些人来说，他们并不真正关心。他们关心的是：

1.  他们获得了一个好的网站（因此，使用 Rails，因为你更擅长使用它），并且
2.  它不会成为维护的负担（因此，使用 PHP，因为它更容易找到程序员）

只需让他们知道这些事实，并按照这些思路争论你的观点，让他们做出决定。另外值得一提的是，Rails 是一个不断发展的社区（如果我相信博客的话……），随着时间的推移，开发人员的可用性会越来越好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T23:50:12.167

假设一个人的团队在不久的将来就足够了，并且您不打算在那段时间离开公司，那么论点很简单：

Rails 在更短的时间内为您提供了一个稳定的网站（因为您对它很有经验，如果没有其他原因），这意味着公司可以更快地获得更多收入。如果他们最终确实需要雇用另一位开发人员，那么寻找/雇用具有 Rails 经验的人的成本增加（如果真的有的话）将是合理的。

然而，我确实认为 Rails 带来了更快的开发、更少的错误、更容易的可扩展性和更易于维护的代码库。这意味着该公司实际上将在现在和长期内节省开发时间和金钱。

> > 即使开发不那么有趣？

坦率地说：你*喜欢*使用 Rails。快乐的员工更有效率。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T00:12:23.313

我认为品牌并不重要。如果该站点最好用 PHP 完成，那么没有任何支持 rails 的论据看起来不错。如果该站点最好在 Rails（或 django）中完成，那么这应该是显而易见的。

如果您要成为一个单人团队，我会在 Rails 中构建它，因为您是开发人员，这就是您所知道的。即使是非技术人员也应该明白，雇佣 Rails 开发人员用纯 PHP 构建网站是愚蠢的。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-05-09T00:45:22.097

为了说明 rails 的情况，我只会向他们展示 Zend 的配置页面。

# javascript - 在 HTML/CSS 中实现列

> ID：842147
> 
> 赞同：0
> 
> 时间：2009-05-08T22:49:25.790
> 
> 标签：javascript, html, css, dhtml

我有一堆包含文本信息的 DIV。它们都是相同的宽度（可能是 400 像素左右），但高度不同。出于空间原因，我希望有两到三列这些 DIV（有点像报纸上的广告部分）。请参阅下面有吸引力的 ascii-art :)

```
DIV1      DIV3
DIV1      DIV3
DIV1    
DIV1      DIV4
DIV1      DIV4
DIV1      DIV4
          DIV4   
DIV2      DIV4
DIV2 
```

DIV 是 javascript 驱动的，并在页面加载时更改高度。我也不应该更改它们的顺序（每个 DIV 都有一个标题，它们按字母顺序排序）。

到目前为止，我还没有找到一个好的方法来做到这一点。HTML 流程是从左到右，然后从上到下，但我需要从上到下，然后从左到右。

我尝试了一个包含两列的表的简单实现，并将 DIV 放在一列中，另一半放在另一列中。有时间看起来很合理（当每列中 DIV 的平均高度接近时），另一半看起来很糟糕。

我想如果我是 javascript 大师，我可以在 DIV 扩展后测量它们，将它们加起来，然后在运行时将它们从一个表列移动到另一个......但这超出了我的能力，我不确定无论如何都是可能的。

有什么建议么？

谢谢

更新：

感谢您的评论。很明显我问这个问题做得不好:(

DIV 只是包含/分组相似内容的一种方式——并没有真正将它们用于布局本身。它们的宽度相同，但高度不同。我想把它们吐在一个页面上，*神奇地*:) 将它们排列成两列，两列的高度几乎相同 - 就像报纸专栏一样。我不知道开始时 DIV 有多高，所以我不知道将每个 DIV 放在哪一列（这意味着如果我知道它们的高度，我会将它们分成两个表格单元格，但我不知道不知道）。所以上面的例子只是一个简单的例子——它可能在运行时证明 DIV 1 大于其他 3 的组合（在这种情况下 DIV2 应该浮动到 column2 的顶部），或者 DIV 4 可能是大的（在这种情况下，DIV 1、2 和 3 都在 column1 中，而 DIV4 可以单独在 column2 中）

基本上，我希望有一种方法可以创建两列，并根据需要让内容从 column1*神奇地*流向 column2（就像 Word 一样）。我怀疑这无法完成，但我的 HTML/CSS 知识非常基础，所以也许......？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T14:16:07.873

[CSS3 多列模型](http://www.w3.org/TR/css3-multicol/)草案可以满足您的需求。Firefox 似乎支持[某些属性的 -moz 版本](https://developer.mozilla.org/en/CSS3_Columns)和 Safari/Chrome [-webkit 版本](http://www.zenelements.co.uk/blog/css3-multiple-columns/)；我不知道 IE8 或 Opera。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T23:03:59.283

您可以将 div1 和 div2 包装在一个包装 div 中，将 div 3 和 div 4 包装在一个包装 div 中，然后将这两个包装在一个外包装中。使用一些 css 来获得正确的格式，你应该很高兴。html 可能看起来像这样：

```
<div class="wrap">
  <div class="col">
     <div>div1</div>
     <div>div2</div>
  </div>
  <div class="col">
     <div>div3</div>
     <div>div4</div>
  </div>
</div> 
```

然后，有一些像这样的CSS：

```
.wrap {
  position: relative;
  overflow: auto;
}
.col {
  float: left;
  width: 400px;
} 
```

那应该做正确的事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T23:03:08.380

使用浮点数，如下所示：

```
<style>
.col1{
 width: 400px;
 height: 100px;
 float: left;
}
.col2{
 width: 400px;
 height: 150px;
 float: left;
}
.col3{
 width: 400px;
 height: 200px;
 float: left;
}
</style>
<div style="width: 1200px;">
  <div class="col1">div1</div>
  <div class="col2">div2</div>
  <div class="col3">div3</div>
  <div class="col1">div1</div>
  <div class="col2">div2</div>
  <div class="col3">div3</div>
  <div class="col1">div1</div>
  <div class="col2">div2</div>
  <div class="col3">div3</div>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T05:40:43.337

> DIV 是 javascript 驱动的

好吧，不管你是什么意思，向我们展示代码。如果我们可以看到您的 JS 是如何构建 DIV 的，我们可能会看到如何以不同的方式创建它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T14:19:46.297

是否可以将它们集成到诸如[http://960.gs/](http://960.gs/)之类的 css-grid 中？

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-08T23:33:57.823

用表格来做这件事。

我开始在工作中使用桌子，坦率地说？在 CSS 中做这些事情是一团糟，而且更难调试。

# sql - 创建外键 SQL

> ID：842151
> 
> 赞同：2
> 
> 时间：2009-05-08T22:49:56.757
> 
> 标签：sql, sql-server, foreign-keys

如何创建外键

来自表 tGeoAnswers 列“locationId”

表 tLocations 列“id”？

```
ALTER TABLE 
        tGeoAnswers 
ADD 
        FK_Answer_Location 
FOREIGN KEY 
        (locationId)
REFERENCES 
        tLocations(id) 
```

我正在尝试我找到的这段代码，但出现以下错误：

列“FK_Answer_Location”的定义必须包含数据类型

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T22:54:45.263

```
ALTER TABLE tGeoAnswers ADD CONSTRAINT FK_Answer_Location ... 
```

否则，它假定您要添加一个名为`FK_Answer_Location`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-08T22:59:32.413

假设 MsSql Server/T-SQL，使用[ALTER TABLE](http://msdn.microsoft.com/en-us/library/ms190273.aspx)：

```
 ALTER TABLE tGeoAnswers
 ADD CONSTRAINT FK_Answer_Location
 FOREIGN KEY (LocationId) REFERENCES tLocation (Id) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-08T22:55:22.673

[请查看http://www.1keydata.com/sql/sql-foreign-key.html](http://www.1keydata.com/sql/sql-foreign-key.html)底部的`ALTER TABLE ADD ... FOREIGN KEY`语法。

# hibernate - 休眠注释，通过接口查询hql？

> ID：842154
> 
> 赞同：0
> 
> 时间：2009-05-08T22:51:40.247
> 
> 标签：hibernate, interface, hql

hql 的休眠（我使用的是 3.4 版）文档说它支持接口，但我无法让它工作。我有一些持久类（不是从彼此继承，而是共享许多功能），它们都共享一个接口（CategorizableEntity）。我可以在我的 java 代码中将它与 instanceof 一起使用，但我无法查询它（“来自 CategorizableEntity”）。

我用@Entity 对其进行了注释，但是休眠不会让我像其他人一样映射它。这可能吗？有没有我找不到的特殊方法来映射它？

谢谢！约书亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-17T17:27:06.463

尝试使用接口的全名（例如：java.util.Set 而不是 Set）

# php - 在这段 PHP 代码中找不到错误

> ID：842160
> 
> 赞同：1
> 
> 时间：2009-05-08T22:54:15.327
> 
> 标签：php, drupal

我在此代码上收到 T_String 错误，它在第二行 ($form['com...) 上说得更准确，我根本不明白为什么。

```
function _maxlength_comment_type_form_alter(&$form, $form_state, $form_id) {
    $form['comment']['comment_max_length'] = array(
     '#type' => 'select',
     '#title' => t('Maximum comment length'),
     '#default_value' => variable_get('comment_max_length_'. $form['#node_type'] -> type, 160),
     '#options'=> drupal_map_assoc(array(140,160,180,200)),
     '#description' => t('numero maximo de caracteres permitidos.'),
     '#weight' => -1,
     ); 
```

我将此代码添加到 Maxlength drupal 模块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T23:00:43.410

可能是这部分：

```
'comment_max_length_'. $form['#node_type'] -> type 
```

尝试摆脱箭头周围的空间？

* * *

编辑 - 我不相信上面的代码实际上是一个问题，虽然我仍然建议删除空格作为风格问题，所以很明显你正在这样做：

```
'comment_max_length_'. ($form['#node_type']->type) 
```

而不是这个：

```
('comment_max_length_' . $form['#node_type']) 
```

您的代码有效且可在 My PC ^(TM)上使用。

* * *

另一个编辑：

确保`$form['comment']`也已定义。也许在函数的开头添加它。

```
if (!isset($form['comment'])) $form['comment'] = array(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T23:03:53.057

我可以看到两个问题，上面提到的一个 nickf ，即箭头的任何一侧都不应该有空格：

```
'comment_max_length_'. $form['#node_type'] -> type 
```

此外，它后面不应该有逗号（因为它是数组中的最后一项）：

```
'#weight' => -1,` 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T23:04:28.063

如何将这个巨大的陈述分解成更小的陈述，以便更好地查明问题？

# windows - Windows（特别是 Vista）如何确定我的应用程序是否挂起？

> ID：842161
> 
> 赞同：9
> 
> 时间：2009-05-08T22:54:24.157
> 
> 标签：windows, windows-vista, windows-xp

我有一个与此处描述的问题非常相似的问题： [http ://www.eggheadcafe.com/software/aspnet/30579866/prevent-vista-from-markin.aspx](http://www.eggheadcafe.com/software/aspnet/30579866/prevent-vista-from-markin.aspx)

该线程建议任务管理器向进程发送 WM_NULL 并期望进程在超时限制（5 秒？）内使用此消息。当我在谷歌上搜索“WM_NULL 挂起”时，有很多关于相同技术的引用。

但是，我的应用程序的队列中没有看到任何 WM_NULL 消息，而它在一个冗长的操作中工作 - 我有一个辅助线程，它每 0.5 秒切换到主线程并调用 PeekMessage() 寻找 WM_NULL，但它没有找不到！

那么，Windows（Vista）使用什么方法来判断一个应用程序是否挂起呢？

我的应用程序应该使用哪些消息，以便 Windows 认为应用程序是响应式的？

更多细节 ：

除了寻找 WM_NULL 的 PeekMessage() 之外，我们还为鼠标事件调用 PeekMessage()，因为我们还想了解用户是否选择了窗口的某个区域，在该区域绘制了一个停止标志。如果该区域被选中，我们设置一个标志，主线程中的冗长操作会定期检查，如果选中停止标志，则将停止。Vista 的问题在于，当它声明应用程序无响应时，它会将其窗口替换为幽灵窗口 - 请参阅[PeekMessage() 的描述](http://msdn.microsoft.com/en-us/library/ms644943(VS.85).aspx)：

> 如果顶层窗口停止响应消息超过几秒钟，系统会认为该窗口没有响应并用具有相同 z 顺序、位置、大小和视觉属性的幻影窗口替换它。这允许用户移动它、调整它的大小，甚至关闭应用程序。但是，这些是唯一可用的操作，因为应用程序实际上没有响应。调试应用程序时，系统不会生成幻像窗口。

这个幽灵窗口不允许鼠标选择进入我们的窗口，因为窗口不再出现在屏幕上！所以我的目标是首先防止这个鬼窗出现......

经过更多调查：

在我添加了[迈克尔](https://stackoverflow.com/users/67132/michael)在回答这个问题时建议的代码之后

```
while (PeekMessage(&msg, NULL, 0, 0, PM_REMOVE))
{
    TranslateMessage(&msg);
    DispatchMessage(&msg);
} 
```

该应用程序不再被 Windows 视为挂起；但是我不能使用这个解决方案，因为应用程序开始对选择各种按钮等做出反应（这不应该发生）。所以我试着看看有哪些消息进来了。我使用了 Spy++ 并调试打印，两者都只显示了两种消息：WM_TIMER 和 0x0118 (WM_SYSTIMER)。所以我修改了这样的代码

```
 while (PeekMessage(&msg, NULL, WM_TIMER, WM_TIMER, PM_REMOVE) ||
        PeekMessage(&msg, NULL, 0x0118, 0x0118, PM_REMOVE))
 {
    TranslateMessage(&msg);
    DispatchMessage(&msg);
 } 
```

令人惊讶的是，应用程序再次挂起！

现在我真的被困住了。如果我拦截进来的唯一消息，并让应用程序处理它们，为什么 Windows 仍然认为应用程序不处理事件？

任何有意义的建议将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T23:01:07.480

TaskManager 可能使用[IsHungAppWindow](http://msdn.microsoft.com/en-us/library/ms633526.aspx)来确定应用程序是否挂起。根据 MSDN，如果应用程序未等待输入、未在启动处理中或未在 5 秒内处理消息，则认为应用程序已挂起。所以不需要 WM_NULL 。

您不需要使用任何特定消息 - 只需定期发送消息并将长任务移出 UI 线程。如果您可以每 0.5 秒调用一次 PeekMessage，请将其替换为以下内容：

```
while (PeekMessage(&msg, NULL, 0, 0, PM_REMOVE))
{
    TranslateMessage(&msg);
    DispatchMessage(&msg);
} 
```

这将完全耗尽您的消息队列，并使您看起来对用户更具响应性。不要过滤单个消息，例如鼠标消息。如果可能，您应该每 0.5 秒以上执行一次，并且长期尝试将长时间的工作从 UI 线程中移开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-12T12:07:43.003

解决方案是在发送消息后额外调用一次。

```
 // check for my messages
while (PeekMessage(&msg, NULL, WM_TIMER, WM_TIMER, PM_REMOVE) ||
        PeekMessage(&msg, NULL, 0x0118, 0x0118, PM_REMOVE))
 {
    TranslateMessage(&msg);
    DispatchMessage(&msg);
 }

// only to prevent ghost-window on vista!
// we dont use the result and let the message in the queue (PM_NOREMOVE)
PeekMessage(&msg, NULL, 0, 0, PM_NOREMOVE); 
```

# ruby-on-rails - rake db:migrate 是否是正确的命令以重新同步 schema.rb 与您的数据库架构？

> ID：842162
> 
> 赞同：18
> 
> 时间：2009-05-08T22:54:39.367
> 
> 标签：ruby-on-rails, schema, migration, rake

我运行“rake db:migrate”以将 schema.db 与我的数据库模式重新同步。但它失败了，说我的一张表已经存在。我认为它试图重新创建表。如果您只想更新 schema.rb 以反映您在数据库中独立于 Rails 所做的任何更改，如果不是“rake db:migrate”，您应该使用什么命令？关于这类事情的最佳文档来源是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-08T23:41:20.877

“rake db:migrate” 将尝试为您的项目运行所有未完成的迁移。如果您只想转储架构，请执行“rake db:schema:dump”。
但我认为你有一个问题，它说该表已经存在。您的一项迁移失败，因为它尝试添加的表已经存在于您的数据库中。你是手工制作的吗？您是否进行了迁移，但没有为它写下来？您需要先解决此问题，然后才能编写未来的迁移。如果这只是一个错误，并且表格在那里并且正确并且您想忽略它。我的建议是通过在失败的迁移中注释掉创建表来解决它。然后运行“rake db:migrate”。然后，但是创建表回来了。这将更新您的架构版本。
确保你写下所有迁移的正确记录。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2011-06-02T22:42:57.950

尝试

```
RAILS_ENV=development rake db:drop 
```

前

```
RAILS_ENV=development rake db:migrate 
```

而且要快乐！

**确保在测试或开发环境中运行它，因为这将删除数据库/表**

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2010-08-04T23:31:47.653

我发现偶尔，当事情变得有点奇怪时，你会发现自己处于 Rails 想要运行迁移的情况下，它应该正确地考虑已经完成（表已经存在等）。您可以通过查找其编号（文件名开头的数字部分）来标记迁移完成，进入 mysql 并发出如下查询：

```
insert into schema_migrations values('20090521153438'); 
```

（或无论您的迁移次数是多少）

或者，如果它是使用 Desert 的 migrate_plugin 运行的插件迁移：

```
insert into plugin_schema_migrations values('my_plugin', '005'); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-02-19T11:46:37.837

`rake db:migrate:reset`将删除所有表，运行所有迁移并创建一个新`schema.rb`文件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-08T23:07:25.653

尝试`rake db:schema:dump`或`rake db:migrate:redo`。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-03-23T09:33:29.370

使用**`rake db:schema:dump`**.

```
$ rake -T | grep schema
rake db:schema:dump # Create a db/schema.rb file that is portable
                    #  against any database supported by ActiveRecord 
```

`rake db:schema:dump``db/schema.rb`无需再次运行任何迁移或删除任何表（这意味着丢失这些表中的数据）即可重新创建文件，因此这是您可以首先尝试的侵入性最小的方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-08T23:50:22.603

回答您关于文档的最后一个问题：

*   rails 2.1+ 的 rails rake 任务指南：[http ://www.tutorialspoint.com/ruby-on-rails-2.1/rails-and-rake.htm](http://www.tutorialspoint.com/ruby-on-rails-2.1/rails-and-rake.htm)
*   关于迁移的一个很好的截屏视频：[http ://railscasts.com/episodes/107-migrations-in-rails-2-1](http://railscasts.com/episodes/107-migrations-in-rails-2-1)

# c - XML 到 C 结构和 C 结构到 XML

> ID：842169
> 
> 赞同：7
> 
> 时间：2009-05-08T22:56:59.877
> 
> 标签：c, xml, parsing, data-structures, structure

我喜欢用 C 进行服务器端编程，但需要与一些 XML 进行互操作。

我需要编写一些函数，给定一个 C 结构或嵌套结构，以及另一个描述 C 结构中元素的结构（或嵌套结构），将其作为 XML 输出。另一个函数读取 XML，验证它是否匹配 C 结构的描述，并填充 C 结构。

我很确定这已经做过很多次了，但是那里有太多关于 XML 的其他信息，以至于我没有任何运气来编写一个不会返回很多不相关内容的 Google 查询。

我不是在寻找库——只需几百行 C 代码即可解析 XML。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-02-10T21:11:31.453

他没有要求 XML 解析器。他正在寻求一个库，该库可以自动序列化/反序列化复杂的 C 结构与 XML 之间的序列化（这显然将依赖于下面的 XML 解析器）。

[Libpdel](http://www.freebsdsoftware.org/devel/libpdel.html)很旧，但支持做你想做的事（通过“结构”的东西）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T23:10:50.747

如果您没有找到任何预制库或代码，您可以这样做的一种方法是编写一个 toXML() 函数，就像通常的 toString() 函数一样。然后是 toStruct(char*) 将 XML 反序列化回结构

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T00:58:39.913

在一般情况下，您将无法仅用几百行代码解析 XML。有几个 XML 解析器库，其中[expat 浮现](http://expat.sourceforge.net/)在脑海中。Expat 是用 C 编写的，并且具有 C 友好的 API。

假设您不会对您支持的数据类型发疯，序列化可能会更容易。

无论哪种方式，这会让您头疼的地方在于维护`struct`布局和 XML 模式之间的对应关系。

您可能想研究像[SCEW](http://www.nongnu.org/scew/)这样的库，它们旨在隐藏 expat 实现的事件驱动性质并呈现更像 DOM 树的东西。还有各种在 expat 之上实现 SOAP 的库，这些库必然需要处理进出 XML 数据包的数据编组。

# jquery - jQuery帖子问题

> ID：842178
> 
> 赞同：2
> 
> 时间：2009-05-08T22:59:19.963
> 
> 标签：jquery, post

```
//post data
function SubmitForm(method)
{
var login = document.form.login.value;
var password = document.form.password.value;
$.post("../content/backend.php", { login: login,password: password,method: method});
} 
```

我正在尝试使用上述调用发布数据。在 Firefox 中，萤火虫闪现一个错误，但没有给我时间评估我唯一能看到的是与以下代码相关的 jquery 错误点。

```
// Send the data
    try {
        xhr.send(s.data);
    } catch(e) {
        jQuery.handleError(s, xhr, null, e);
    } 
```

有人知道为什么会这样吗？整页贴在下面

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="yes" name="apple-mobile-web-app-capable" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<link href="../pics/homescreen.png" rel="apple-touch-icon" />
<meta content="minimum-scale=1.0, width=device-width, maximum-scale=0.6667,    user-scalable=no" name="viewport" />
<link href="../css/style.css" rel="stylesheet" type="text/css" />
<script src="../javascript/functions.js" type="text/javascript"></script>
<script type="text/javascript" src="../includes/jquery.js"></script>

<script type="text/javascript">
function SubmitForm(method)
{
var login = document.form.login.value;
var password = document.form.password.value;
$.post("../content/backend.php", { login: login,password: password,method: method});
}
</script>
<title>Login</title>
</head>
<body>
<div id="topbar">
<div id="leftnav">
<a href="../index.php"><img alt="home" src="../images/home.png" /></a>      </div>
</div>
<div id="title">Login</div>
</div>
<div id="content">
<span class="graytitle">Login</span>
<ul class="pageitem">
<form name="form" method="post" action="#">
<li class="form"><input placeholder="Username" type="text" id="login"/></li>
<li class="form"><input placeholder="Password" type="password" id="password"/></li>
<li class="form"><button onClick="SubmitForm('login')" name="button">Login</button></li>
</ul>
</form>
</div>
<div id="footer"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T23:10:57.050

您的提交函数应返回 false 以停止事件传播。

```
function SubmitForm(method)
{
var login = document.form.login.value;
var password = document.form.password.value;
try {
    $.post("../content/backend.php", { login: login,password: password,method: method});
} catch(e) {
    alert(e);
}
return false
} 
```

停止调用默认的偶数处理程序。

还将调用包装在 try/catch 中以使调试更容易。我们很难调试代码，因为我们没有被调用的脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-06T06:17:53.880

代替

```
"../content/backend.php" 
```

尝试这个

```
"/yourrootfolder/content/backend.php" 
```

# .net - WPF根据对象属性在ContextMenu上隐藏MenuItem

> ID：842192
> 
> 赞同：5
> 
> 时间：2009-05-08T23:03:44.913
> 
> 标签：.net, wpf, contextmenu, menuitem

我需要以编程方式显示/隐藏菜单项，最好的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T10:21:58.327

好吧，要添加 MenuItem，您需要以下内容：

```
var menuItem = new MenuItem() { Header = "Menu Name", Name = "Identifier", IsCheckable = true, IsChecked = visible };
menuItem.Click += new RoutedEventHandler(contextMenu_onClick);
int position = contextMenu.Items.Add(menuItem); 
```

（但你可能已经得到了这个）。

您将需要某种方式将菜单项与属性绑定 - 但如果没有看到您的应用程序，我无法真正建议最佳方式。有存储对象的 Tag 属性；存储字符串的 Uid 属性；Name 属性也存储一个字符串。

尽管：

```
menuItem.Visibility = Visibility.Visible; 
```

和

```
menuItem.Visibility = Visibility.Collapsed; 
```

应该切换项目的可见性。

**编辑：**使用 Collapsed 将隐藏菜单项，而不是在菜单中保留空间 - 你真的不希望上下文菜单中有空格。*（为此感谢Botz3000）*

然后在更改属性值的代码中，您将使用我上面描述的链接找到您希望显示/隐藏的菜单项。拥有该项目后，您可以切换它的值：

```
menuItem.Visibility = menuItem.Visibility == Visibility.Visible ? Visibility.Collapsed : Visibility.Visible; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-29T19:06:02.877

确定要隐藏`MenuItem`吗？使用 WPF 的命令框架禁用它更常见：

```
<MenuItem Header="_MenuName" Command="{x:Static local:MyCommands.SomeCommand}" />

...

<!-- In the menu item or any of its ancestors: -->
<SomeControl.CommandBindings>
    <CommandBinding Command="{x:Static local:MyCommands.SomeCommand}" Executed="Save_Executed" CanExecute="Save_CanExecture" />
</SomeControl.CommandBindings> 
```

WPF 将使用 的`bool`结果`Save_CanExecute`来确定`MenuItem`' 命令当前是否可以执行，并`MenuItem`相应地启用/禁用。

# apache - Web 服务器 - 我什么时候应该使用分块传输编码？

> ID：842197
> 
> 赞同：1
> 
> 时间：2009-05-08T23:04:41.120
> 
> 标签：apache, encoding, webserver, chunked-encoding

查看各种 Web 服务器 HTTP 标头，我注意到 Google.com 具有：

```
client-transfer-encoding: "chunked" 
```

什么是分块传输编码，我应该在我的网络服务器上使用它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T23:22:18.740

分块可用于分多个部分发送 HTTP 请求或响应，并在后续部分不可用时发送一部分。

多个请求-响应对可以通过单个 HTTP 连接传输。（这是为了避免后续请求的 TCP connect() 开销。）要实现这一点，客户端需要知道服务器响应在哪里结束。如果服务器生成*Content-Length*标头，则客户端可以对字节数进行倒计时。当没有字节要读取时，客户端可以发起下一个请求。但是，如果服务器事先不知道完整响应的长度，它如何生成*Content-Length标头？*解决方案是使用*chunked*而不是*Content-Length*。

默认情况下，Apache（1.3 和 2）只要有意义（并且 HTTP 客户端支持它）就将静态文件作为*分块发送。*您不必采取任何行动。如果您编写自己的 Web 应用程序，您可能会考虑手动生成分块响应。

更多信息请参见[http://www.research.att.com/~bala/papers/h0vh1.html](http://www.research.att.com/~bala/papers/h0vh1.html)和[http://developers.sun.com/mobility/midp/questions/chunking/](http://developers.sun.com/mobility/midp/questions/chunking/)。

# javascript - 有更好的onchange吗？

> ID：842200
> 
> 赞同：2
> 
> 时间：2009-05-08T23:06:25.127
> 
> 标签：javascript

我有一个 textarea，当它发生变化时，我想调用一个函数。

但是，标准的 onchange 事件会在焦点离开文本区域后触发。我真正想要的是在用户开始输入时立即触发。

我可以绑定onkeypress，但这不能处理，比如用鼠标将文本粘贴到文本区域。此外，它还会触发 Tab 和其他不变的按键。

有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T23:08:18.990

你可以添加一个

```
onkeyup="SomeFunction();" 
```

编辑：啊，太快了。我没有看到“鼠标粘贴”。

编辑2：

```
<script type="text/javascript">
    var ival = "";
    var checkup = window.setInterval("checkChange();", 100);
    function checkChange() {
        var nval = document.getElementById("test").value;
        if (nval!=ival) { alert("change in the text"); ival=nval; }
     }
</script>
<input type="text" id="test" name="test" value="" /> 
```

示例来自：[http ://bytes.com/topic/javascript/answers/703623-capturing-event-when-user-right-click-paste-into-text-box](http://bytes.com/topic/javascript/answers/703623-capturing-event-when-user-right-click-paste-into-text-box)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T23:14:48.477

onKeyPress 将起作用，只是在粘贴编码的情况下-您会知道它已粘贴，因为它将包含换行符，就像您只是在文本字段中输入一样-换行符将不存在

只需检查换行符并使用 onKeyPress

# null - 我们真的需要NULL吗？

> ID：842203
> 
> 赞同：1
> 
> 时间：2009-05-08T23:08:38.337
> 
> 标签：null

> **可能重复：**
> [null 的目的是什么？](https://stackoverflow.com/questions/584507/what-is-the-purpose-of-null)

是否真的需要NULL？在我编写的大多数 OO 语言中，总是有一种方法可以将变量设置为 NULL 值，这会导致各种有趣的问题。

你觉得呢？你有没有什么想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T23:13:22.100

NULL 有点像上帝。如果它不存在，我们最终将不得不创建一个。某些东西必须代表未分配的引用的值（无论是因为它从未被分配还是在某个时候被清除）。唯一的选择是使用一个有效地替代 NULL 的对象。这样做的问题是，如果你做了所有这些来避免 NullPointerException，现在你将简单地用 UnexpectedObject 异常或 ClassCastException 或其他什么替换它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T23:12:33.707

可以设计一种没有 NULL 但未初始化的值指向实际上不做任何事情的单例虚拟对象的语言。您可以将指针与此虚拟对象的引用进行比较，并且对对象上的方法的调用将不会导致任何操作或运行时错误。

对于像 C++ 或 Java 这样的静态类型语言，这种技术很难实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T23:14:55.527

在具有垃圾收集的语言中，变量是实际存储位置（与 Python 的标签相反），`NULL`需要该值以允许在变量范围结束之前以干净的方式释放内存。

此外，甚至许多用伪代码编写的算法都使用了特殊`NULL`值。它随处可见。它是计算机科学的核心概念。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T23:30:38.813

通常有两个特殊值。有些语言同时处理两者，有些只处理 1 并与另一种抛出错误，有些将两者合并。这两个值是`Null`和`Undefined`。

*   `Undefined`会尝试使用一个*完全不存在*的变量。

*   `Null`将尝试使用存在但*没有值*的变量。

`Null`可能很有用，因为它是一个保证值，表明有问题，或者超出了可能答案的域/范围。以 Java 为例：

如果您没有`null`，如果您在 a 中查找`HashMap`Map 中不存在的东西怎么办？你会返回什么？如果您返回一个对象，那么您如何知道该对象是否意味着那里什么都没有，或者这就是 Map 中的实际内容。解决方法可能包括创建您自己的“NON_EXIST”常量对象，但这与`null`已经存在的东西本质上是一样的。另一种解决方法可能是抛出异常。现在您正在查看主要的性能影响。

同样，它的想法是拥有可以使用的保证允许值。它始终对您可用，并且始终与通常从您正在执行的操作返回的“真实值”集脱节。 `Null`因此特意用来表示特殊的东西。

就像我之前暗示的那样，这里也可以进行一些优化，因为`Null`它是一个特殊的值。在像 Java 这样的语言中，如果您最初仅通过变量引用对象，则将该变量设置为`null`您正在删除该引用并允许 Java 的垃圾收集器收集现在未引用的数据。相反，如果您让该变量永远存在，那么可能永远不会再次使用的大块内存将继续持有资源。这是一个人为的例子，但它证明了一点，在一些资源密集型 Java 程序中，您会看到这些对`null`.

# wxpython - wxPython：wx.Panel 和 wx.Window 有什么区别？

> ID：842208
> 
> 赞同：4
> 
> 时间：2009-05-08T23:10:49.377
> 
> 标签：wxpython, wxwidgets

我的印象是面板更好。真的吗？

一个比另一个有什么优势？有什么理由使用一个而不是另一个？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-09T09:24:06.250

wx.Window 是所有小部件的基类（不一定是所有**窗口**- 名称具有误导性）。

wx.Panel 是 wx.Window 的子类，它更适合在其中包含小部件。例如，默认情况下，它允许使用“选项卡”在小部件之间移动，并以对子小部件更有用的方式处理焦点事件。

# objective-c - 如何从 Cocoa 中的 CFStringTokenizer 获取令牌类型？

> ID：842211
> 
> 赞同：1
> 
> 时间：2009-05-08T23:12:18.763
> 
> 标签：objective-c, cocoa, string, core-foundation

CFStringTokenizer 文档在 CFStringTokenizerAdvanceToNextToken() 中有两个相互冲突的语句：

> *CFStringTokenizerAdvanceToNextToken*
> 
> ...
> 
> *返回值*
> 
> 令牌生成器成功找到令牌并将其设置为当前令牌时的令牌类型。如果标记器找不到标记，则返回 kCFStringTokenizerTokenNone。有关可能的值，请参阅“令牌类型”。</p>
> 
> ...
> 
> 如果找到一个token，则将其设置为当前token，函数返回true；否则当前令牌无效并且函数返回 false。

第一段（返回标记类型）是我希望看到的：例如，它可以让您检查标记是否完全由非字母数字字符组成。然而，第二段（返回真或假）似乎是实际发生的事情。

任何想法为什么会这样，或者如何解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T23:48:43.637

标题注释没有提到返回真或假，当标题和在线文档不同意时，通常是标题是正确的。

在一个简单的测试中，我能够获得 0 和 1 以外的返回值，因此您看到的问题可能更具体；您可以发布失败的示例代码吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T07:34:43.040

如果您正在寻找的是忽略 CFNumber 类型标记的能力，那么您可以使用：

```
while (tokenType != kCFStringTokenizerTokenNone) {
    if ( (tokenType & kCFStringTokenizerTokenHasHasNumbersMask) == 0) { // ignore numbers
        range = CFStringTokenizerGetCurrentTokenRange(tokenizer);
        NSString *token = [string substringWithRange:NSMakeRange(range.location, range.length)];
        [tokensArray addObject:token];
    }
    tokenType = CFStringTokenizerAdvanceToNextToken(tokenizer);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T02:27:40.867

它们可能意味着“非零”和“零”更广泛意义上的“真”和“假”。如果它找到一个标记，则函数返回`kCFStringTokenizerTokenNormal`（为 1）或掩码的某种组合（无论哪种方式，非零/“真”）。如果不是，则函数返回`kCFStringTokenizerTokenNone`（为零/“假”）。

不过，这肯定是含糊不清的语言，因此请在[Apple Bug Reporter](https://bugreport.apple.com/)上提交文档错误。

# drupal - 在 Drupal 6 中，如何使特定内容类型始终与灯箱 2 一起显示？

> ID：842217
> 
> 赞同：0
> 
> 时间：2009-05-08T23:14:04.797
> 
> 标签：drupal, dynamic, lightbox, lightbox2

做 node/%/lightbox2 就可以了，但我不知道如何建立到节点的动态链接！

理想情况下，每个节点都有一个缩略图，该缩略图将触发 lightbox2-viewed 节点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T10:06:58.597

这种“节点库”的选项之一可能是创建一个视图，它首先按您想要的节点类型进行过滤。其次，您对该视图进行主题化，以便指向节点的链接指向“node/number/lightbox2”，还添加一个 rel="lightbox" 属性以启用使用 lightbox2 进行查看。

文本节点的图形缩略图不是一项简单的任务，它需要编写一个自定义模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-12T13:14:23.850

这是很好的信息，如何让节点不显示页眉、页脚等——只显示那个节点的内容？我现在看到的唯一方法是制作一个 page.tpl.php，它作为基于节点类型的选择器，但不是那种混乱吗？

文本节点不仅仅是文本节点——其中会有一个图像（强制），我可以对其进行自动缩略图化，并且该缩略图会显示在视图中。那个听起来是对的吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-30T19:00:22.310

在没有块、页脚或页眉的情况下显示它，您可以选择使其成为页面窗格，或创建自定义页面或使用覆盖 PHP 模板，在其中省略不需要的内容。

# java - 使用 spnego 凭据访问不同的页面

> ID：842222
> 
> 赞同：0
> 
> 时间：2009-05-08T23:18:47.967
> 
> 标签：java, jetty, spnego

我有一个使用 serverA 中的 jetty 6.1.12 提供服务的应用程序。serverA 使用 spnego 过滤器进行了kerberized，当我从浏览器运行它时运行良好。我现在正试图从 serverA 中的一个类访问不同的站点 (serverB)。这个新站点使用相同的身份验证方案，即，如果用户可以看到 serverA 上的页面，他也可以看到 serverB 上的页面。有没有办法从 Web 服务器 (serverA) 获取 kerberos 凭据并将其传递到其他地方？

错误报告（[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6549811](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6549811)）说 spnego 委托很久以前就修复了，所以我认为必须有办法做到这一点。

我正在使用 Java 1.6。要对 serverB 进行 http 调用，我使用的是 apache commons httpclient 3.1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T18:30:18.197

我发现，问题不在于码头。当我对 login.conf 文件和 Http(s)URLConnection 使用 jass.conf 而不是 commons httpclient 时，委派似乎有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-04T15:47:34.700

这是一个展示如何进行凭证委托的项目[http://spnego.sourceforge.net/credential_delegation.html](http://spnego.sourceforge.net/credential_delegation.html)。免费和开源项目使用 SpnegoHttpURLConnection 类从 serverA 到 serverB 进行调用。

# mysql - 在 MySql 中将表绑定在一起

> ID：842224
> 
> 赞同：0
> 
> 时间：2009-05-08T23:22:10.050
> 
> 标签：mysql, database

我有一个包含公司信息（即姓名、地址、业务描述......）的表和另一个包含用户信息（即名字、姓氏、电子邮件和密码）的表。如何将公司表绑定到用户表，以便在用户登录时，公司与用户正确关联？我会在公司表中有一个用户 ID 列吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T23:26:17.403

假设几个用户可能属于一个公司，但只有一个公司可能与一个用户相关联，那么用户表中的 companyid 最有意义。

要将两个表连接在一起，您希望在所有情况下都匹配，请使用 INNER JOIN：

```
SELECT u.*, c.companyname FROM users u 
INNER JOIN companies c ON u.companyid = c.companyid 
```

显然，以上是一个模拟查询，需要进行定制以匹配您的架构/要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T23:25:49.433

您正在寻找[联接](http://en.wikipedia.org/wiki/Join_(SQL))。

公司将与用户建立一对多的关系，因此您需要在用户表中创建一个名称为 company_id 的列，然后像这样查询它以获取用户及其公司：

```
SELECT * FROM users INNER JOIN companies ON users.company_id = companies.id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T23:26:48.963

不，您可能会有一对多的关系。因此，一家公司包含许多员工。但是一名员工只属于一家公司（为简单起见）。

这需要用户表中的外键指向公司的 id。

# stored-procedures - SubSonic 不映射包中的存储过程

> ID：842226
> 
> 赞同：0
> 
> 时间：2009-05-08T23:24:08.283
> 
> 标签：stored-procedures, subsonic

我在 MS SQL 中使用过 SubSonic，效果非常好！！！！有谁知道 Oracle 的 SPS in Packages 是什么？请帮忙。需要尽快交付功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T16:41:05.040

不支持 Oracle 软件包。我不确定是否有计划在短期内支持他们。

# javascript - 是否有跨浏览器的方式来通过 css 扩展点击文本？

> ID：842228
> 
> 赞同：3
> 
> 时间：2009-05-08T23:25:09.763
> 
> 标签：javascript, css, hover, highlight, expand

首先，这是我想做的事情：

```
Row 1
Row 2
Row 3 
```

我有代码设置，因此当我将鼠标悬停在第 1 行、第 2 行或第 3 行上时，该行会突出显示。这是通过 css 完成的。

我希望能够（例如）单击 row1 然后它看起来像这样：

```
Row 1
  Some text here
Row 2
Row 3 
```

该文本将保留在那里，直到我单击另一行时它才会消失。例如，假设我接下来点击了第 2 行。

```
Row 1
Row 2
  Even more text here
Row 3 
```

我找到了有关使用 javascript 执行此操作并设置文本可见性的代码，但我不确定如何在没有大量重复代码的情况下执行此操作...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T23:32:36.343

如果你有比这个特性所需的更多的 javascript，jQuery 是合理的，它会派上用场。使用 jQuery，它会像

```
$(".classOfYourRows").
    click(function(){
        $(".classOfChildren").hide();
        $(".classOfChildren", this).show();

    }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T23:40:20.927

CSS：

```
.outer {
  display: block;
}

.outer .inner {
  display: none;
  margin-left: 10px;
}

.outer:hover {
  background-color: #EEEEEE;
}

.outer:active .inner {
  display: block;
} 
```

HTML：

```
<div class="outer">
    Row 1
    <div class="inner">some text</div>
</div>
<div class="outer">
    Row 2
    <div class="inner">some text</div>
</div>
<div class="outer">
    Row 3
    <div class="inner">some text</div>
</div> 
```

我认为这与不使用 Javascript 的情况一样接近。

编辑：我想我可能误读了这个问题，我以为他不想使用 Javascript。哦，好吧，无论如何我都会留下我的答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T23:36:18.737

处理这个问题的唯一真正的跨浏览器方法是使用 Javascript，因为不幸的是，许多旧浏览器不支持 :hover 伪类在锚元素以外的任何东西上。

您可能想查看 MooTools 的[Fx.Slide](http://demos.mootools.net/Fx.Slide)效果，或者其他所有人都提到的 JQuery。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-09T14:55:58.547

我可能也会为此使用 jQuery，但是由于 OP 根本没有提到这里是一个普通的 JavaScript 解决方案，只在 FF3/Mac 上测试过，但有理由相信它是跨浏览器的（如果我请纠正我'我错了）：

```
<html>
    <head>
        <style type="text/css">
        #data h2 {
            /* colour should be same as BG colour, stops element expanding 
                on hover */
            border: 1px solid #fff;
            /* indicates to user that they can do something */
            cursor: pointer;
        }

        #data h2:hover { /* Note this isn't supported in IE */
            border: 1px solid #333;
        }

        .hidden p {
            display:none;
        }
        </style>
        <script type="text/javascript">
        function init() {
            var list = document.getElementById('data');
            var rows = list.getElementsByTagName('li');
            var active;
            for(var i = 0; i < rows.length; i++) {
                var row = rows[i];
                // Hide if not the first, otherwise make active
                if(i != 0) {
                    row.className = "hidden";
                } else {
                    active = row;
                }
                row.getElementsByTagName('h2').item(0).onclick = function() {
                    active.className = "hidden";
                    this.parentNode.className = "";
                    active = this.parentNode;
                }
            }
        }
        </script>
    </head>
    <body onload="init()">
        <!-- I'm using <ul> here since you didn't state the actual markup, 
            but you should be able to adapt it to anything -->
        <ul id="data">
            <li>
                <h2>Row 1</h2>
                <p>Some text here</p>
            </li>
            <li>
                <h2>Row 2</h2>
                <p>Some text here</p>
            </li>
            <li>
                <h2>Row 3</h2>
                <p>Some text here</p>
            </li>
        </ul>
    </body>
</html> 
```

请注意，只有在启用 JavaScript 时才会隐藏行内容，这是一个重要的（并且经常被忽略！）可访问性方面。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T23:30:01.327

如果您想要一种简单的跨浏览器方式，我强烈建议您使用[jQuery](http://jquery.com/)

# hyperthreading - 超线程编程语言

> ID：842233
> 
> 赞同：2
> 
> 时间：2009-05-08T23:26:52.300
> 
> 标签：hyperthreading

超线程可以用哪些语言实现？它只是面向对象系统的一部分还是可以在 C 中实现？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T23:30:18.953

任何支持线程的语言和运行时都将支持超线程。

超线程是一种在多个线程之间多路复用 CPU 的方法——只有一个真正的 CPU，但它对操作系统来说是两个 CPU 可见的，因此可以在其上调度两个线程。CPU 在一个线程上的任何停顿（如等待内存、长时间的 FPU 操作等）都允许 CPU 从另一个线程执行代码。

[更多关于Wikipedia](http://en.wikipedia.org/wiki/Hyper-threading)上的超线程的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-05T23:32:07.480

超线程在很大程度上与在系统中拥有更多处理器相同。即使您的语言不支持线程，仍然可以让您的程序生成另一个自身副本或生成将（如果操作系统支持它）在可用处理器上平衡的工作进程。

您需要查找您的语言的线程支持，但要注意线程很容易使您的程序复杂化，并且可能导致难以发现错误，因为代码可以异步执行。

因此，您的问题的答案是“可能，但这取决于”。

至于您的其他问题，您可以根据您的运行时和编译器支持轻松地再次在 C 中实现多个线程。例如，OpenMP 扩展[http://en.wikipedia.org/wiki/OpenMP](http://en.wikipedia.org/wiki/OpenMP)可能对您有用。

# big-o - 当 n 的值变得非常小时时，Big-O？

> ID：842242
> 
> 赞同：5
> 
> 时间：2009-05-08T23:31:45.580
> 
> 标签：big-o

我错过了介绍 big-O 的课程，认为它非常简单。然而，当 n 变得非常小时，老师似乎仍然说了一些关于 O(n) 偏离函数的内容？我在书中的任何地方都找不到这个。有人可以启发我吗？我们对 O(n) 的探索是在排序算法的背景下进行的，如果这有任何意义的话。

谢谢基因

编辑：感谢它一直以来的帮助。我有一个后续问题。是否有一种相对简单的数学方法来找出 n 对于 O(n) 而言太小的点？

> **相关问题**
> 
> > [是否有任何 O(1/n) 算法？](https://stackoverflow.com/questions/905551/are-there-any-o1-n-algorithms)
> > [Θ(n) 和 O(n) 有什么区别？](https://stackoverflow.com/questions/471199/what-is-the-difference-between-n-and-on)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-08T23:34:47.587

Big O 没有描述函数的执行时间，只是描述了增长。所有函数都有一些需要添加的常数因子或开销。当 n 较低时，这种开销可能会使算法的任何改进大大相形见绌 - 每次操作需要 50ms 但具有 O(n) 的算法对于较小的 n 会执行得更差比每次操作需要 5 毫秒但有 O(n*n) 的算法。

这就是为什么，一般来说，对于小集合，大 O 并不重要。对于大多数具有简单比较的对象，对 10 个项目的快速排序不会明显比冒泡排序快，对 100 个项目的线性搜索可能会比二叉树快，等等。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-08T23:47:39.177

Big-O 符号背后的概念是算法的渐近性能。随着 N 变大，Big-O 表示法中的项开始支配总时间。例如，在 O(N^2) 算法中，总时间 T(N) 可能是：

```
T(N) = a * N * N + b * N + c 
```

随着 N 越来越大，无论 b 或 c 的值如何，N^2 中的项都占主导地位。

但是，当 N 很小时，b 和 c 项很重要。

例如，如果 a = 0.001、b = 1,000 和 c = 1,000,000。

```
 N                ~ T(N) [1 significant figure]
 1                1,000,000                (almost all c)
 1,000            2,000,000                (50:50 split on b and c)
 1,000,000        2,000,000,000            (50:50 split on a and b)
 1,000,000,000    1,000,000,000,000,000    (almost all a) 
```

因此，如果您忽略低阶项，则低 N 的性能将被完全歪曲。在高 N 时，低阶项无关紧要。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-08T23:39:55.157

随着参加的讲座数量（N）变得非常少，课程材料变得更难理解。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T23:40:55.513

也许以下是“当 n 变得非常小时 O(n) 偏离函数”的示例：

例如，考虑一个需要时间“50 乘以 n，加上 n 的平方”的操作。

当 n 很大时，“n 平方”项将占主导地位，因此该操作可以说是“O(n 平方)”。

然而，当 n 很小时，“n 平方”项将可以忽略不计，“50 倍 n”项将占主导地位，因此当（且仅当）n 很小时，它可以说是 O(n) .

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T23:44:05.973

为了扩展上述答案，Big-Oh 表示法测量函数的最终增长或其限制行为。

f = O(g) 当且仅存在一个 N 和一个常数 c（它可以是 N 的函数）使得对于所有 n > N，
f(n) <= c*g(n)

假设 f = 10000000*n 和 g = n^2。

f = O(g)，但是如果你看 n 的值太小，比如小于 10000000 并设置 c = 1，你会看到 g(n) <= f(n)。

* * *

再举一个更极端的例子，你宁愿处理复杂度为 n^100000 的算法还是复杂度为 2^(.0000000001n) 的算法。对于合理的问题大小，后者更好。使很多 CS 如此美丽的原因在于它允许这种类型的滥用，但是，大多数自然算法都没有利用它。大多数多项式时间算法都有小常数（至少经过一些工作）。

祝你好运！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T11:39:59.917

根据定义：
f(n)= **Θ(g(n))**表示所有**函数 f(n)的****集合**，因此需要有常数**c1**和**c2**以及**n0**，其中所有这些情况都为**真**：

 *******   *c1。g(n)*是一个非负项或 0。
*   *c1。g(n) <= f(n)* [g(n) 需要是某个 n 的下限]
*   *f(n) <= c2 。g(n)* [g(n) 也需要是上限，因为我们正在定义 Θ]。
*   对于所有**大于我们选择的 n0 的 n**

所以我们需要做的就是选择一个使所有条件都为真的 c1、c2 和 n0。因此，对于 c1 c2 的某些组合，如果您选择 n < n0，则不能保证您的绑定有效。我想这就是你老师所说的“偏差”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T06:46:45.443

一个很大的题外话，但为了完整起见，我想提一些其他的符号，它们与 Big_o 符号相关，通常用于理论计算机科学，您可能会在计算机科学文献中找到这些符号：Big-Θ 符号，the Big-Θ notation，the Big-Ω 符号和 little-o 符号。这些只是对增长率的其他（更严格的）描述。little-o 表示法很容易被误认为是 big-O 表示法。

little-o 也是两个函数 f(x) 和 g(x) 之间的关系。说 'f(x) is little-o of g(x)' 意味着 f(x) 比 g(x) 增长得快得多。用更多的数学术语来说，当 x 接近无穷大时，f(x)/g(x) 的极限为零。

正如前面的答案中提到的，big-O 表示法用于描述算法增长率的上限。它实际上是两个函数 f(x) 和 g(x) 之间的关系，其中 f(x) = O(g(x)) 随着 x 趋于无穷大。

请参阅[Big-o 维基百科页面](http://en.wikipedia.org/wiki/Small_o_notation#Related_asymptotic_notations)，以获得对不同符号的简洁明了的介绍。

# python - 哪个更准确，x**.5 还是 math.sqrt(x)？

> ID：842245
> 
> 赞同：22
> 
> 时间：2009-05-08T23:33:00.883
> 
> 标签：python, floating-point

我最近发现，`x**.5`在`math.sqrt(x)`Python 中并不总是产生相同的结果：

```
Python 2.6.1 (r261:67517, Dec 4 2008, 16:51:00) [MSC v.1500 32 bit (Intel)]
on win32
>>> 8885558**.5 - math.sqrt(8885558)
-4.5474735088646412e-13 
```

检查所有低于 10**7 的整数，这两种方法对几乎正好 0.1% 的样本产生了不同的结果，对于较大的数字，误差的大小（缓慢地）增加。

那么问题来了，哪种方法更准确呢？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-09T00:17:04.847

两者都不是更准确，它们都与实际答案相差相等：

```
>>> (8885558**0.5)**2
8885557.9999999981
>>> sqrt(8885558)**2
8885558.0000000019

>>> 2**1023.99999999999
1.7976931348498497e+308

>>> (sqrt(2**1023.99999999999))**2
1.7976931348498495e+308
>>> ((2**1023.99999999999)**0.5)**2
1.7976931348498499e+308

>>> ((2**1023.99999999999)**0.5)**2 - 2**1023.99999999999
1.9958403095347198e+292
>>> (sqrt(2**1023.99999999999))**2 - 2**1023.99999999999
-1.9958403095347198e+292 
```

[http://mail.python.org/pipermail/python-list/2003-November/238546.html](http://mail.python.org/pipermail/python-list/2003-November/238546.html)

> 数学模块包装了平台C库的同名数学函数；`math.pow()`如果您需要（或只是想要）与调用 C 的 C 扩展的高度兼容性，这是最有用的`pow()`。
> 
> `__builtin__.pow()`是 Python 中缀`**` 运算符的实现，也处理复数、无界整数幂和模幂运算（C `pow()`不处理任何这些）。

** 更完整。`math.sqrt`可能只是 sqrt 的 C 实现，可能与`pow`.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-08T23:37:57.827

pow 函数和 math.sqrt() 函数都可以计算比默认浮点类型可以存储的结果更准确的结果。我认为您看到的错误是浮点数学限制的结果，而不是函数的不准确性。另外，因为在取 7 位数字的平方根时，~10^(-13) 的差异是什么时候出现的问题？即使是最准确的物理计算也很少需要这么多有效数字......

使用 math.sqrt() 的另一个原因是它更容易阅读和理解，这通常是以某种方式做事的好理由。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-09T00:20:14.653

用于`decimal`查找更精确的平方根：

```
>>> import decimal
>>> decimal.getcontext().prec = 60
>>> decimal.Decimal(8885558).sqrt()
Decimal("2980.86531061032678789963529280900544861029083861907705317042") 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-08T23:44:21.743

每当您在语言中内置的两个函数之间进行选择时，更具体的函数几乎总是等于或优于通用函数（因为如果情况更糟，编码人员只会按照术语来实现它通用函数）。Sqrt 比通用取幂更具体，因此您可以期待它是一个更好的选择。至少在速度方面是这样。就准确性而言，您处理的数字不够精确，无法分辨。

注意：为了澄清，sqrt 在 Python 3.0 中更快。在旧版本的 Python 中速度较慢。请参阅 JF Sebastians 的测量结果，[在 Python 中哪个更快：x**.5 或 math.sqrt(x)？](https://stackoverflow.com/questions/327002/python-which-is-faster-x-5-or-math-sqrtx).

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-08T23:49:19.797

这必须是某种特定于平台的东西，因为我得到不同的结果：

```
Python 2.5.1 (r251:54863, Jan 13 2009, 10:26:13) 
[GCC 4.0.1 (Apple Inc. build 5465)] on darwin
>>> 8885558**.5 - math.sqrt(8885558)
0.0 
```

您使用的是什么版本的 python 以及什么操作系统？

我的猜测是它与推广和选角有关。换句话说，由于您正在执行 8885558**.5，因此必须将 8885558 提升为浮点数。根据操作系统、处理器和 Python 版本，所有这些都以不同的方式处理。欢迎来到浮点运算的美妙世界。:-)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-09T00:56:23.740

我在 Win XP Python 2.5.1 上遇到了同样的问题，而我在 32 位 Gentoo Python 2.5.4 上没有。这是C库实现的问题。

现在，在 Win 上，`math.sqrt(8885558)**2`给`8885558.0000000019`，而`(8885558**.5)**2`给`8885557.9999999981`，似乎等于相同的 epsilon。

我说不能真正说出哪个是“更好”的选择。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-08T23:46:46.933

我没有同样的行为。也许错误是特定于平台的？在 amd64 上我得到这个：

```
Python 2.5.2（r252:60911，2008 年 3 月 10 日，15:14:55）
[GCC 3.3.5 (propolice)] 在 openbsd4 上
输入“帮助”、“版权”、“信用”或“许可”以获取更多信息。
>>> 导入数学
>>> 数学.sqrt(8885558) - (8885558**.5)
0.0
>>> (8885558**.5) - 数学.sqrt(8885558)
0.0

```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-09T07:48:40.410

理论上 math.sqrt 应该比 math.pow 有更高的精度。请参阅牛顿计算平方根的方法 [0]。但是，python float（或 C double）的十进制位数的限制可能会掩盖差异。

[0] [http://en.wikipedia.org/wiki/Integer_square_root](http://en.wikipedia.org/wiki/Integer_square_root)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-09-23T23:01:38.807

我执行了相同的测试并得到了相同的结果，10000000 中有 10103 个差异。这是在 Windows 中使用 Python 2.7。

不同之处在于四舍五入。我相信当两个结果不同时，只有一个[ULP](http://en.wikipedia.org/wiki/Unit_in_the_last_place)是浮点数可能的最小差异。真正的答案在两者之间，但是 a`float`没有能力准确地表示它，它必须是四舍五入的。

如另一个答案中所述，该[`decimal`模块](http://docs.python.org/2/library/decimal.html)可用于获得比 a 更好的准确性`float`。我利用它来更好地了解真正的错误，并且在所有情况下`sqrt`都比`**0.5`. 虽然差不了多少！

```
>>> s1 = sqrt(8885558)
>>> s2 = 8885558**0.5
>>> s3 = decimal.Decimal(8885558).sqrt()
>>> s1, s2, s3
(2980.865310610327, 2980.8653106103266, Decimal('2980.865310610326787899635293'))
>>> s3 - decimal.Decimal(s1)
Decimal('-2.268290468226740188598632812E-13')
>>> s3 - decimal.Decimal(s2)
Decimal('2.2791830406379010009765625E-13') 
```

# api - REST - 支持多种可能的标识符

> ID：842261
> 
> 赞同：68
> 
> 时间：2009-05-08T23:39:52.690
> 
> 标签：api, url, rest, url-rewriting

对于我正在开发的网站，我们正在改进一种资源的 URL - 具体来说，从数字 ID 转向唯一的描述性字符串。一个类似的例子是从通过数字数据库 ID 识别用户切换到通过用户名识别用户（不是我们的具体情况，而是类似的）。因此，用于访问用户信息的 URL 看起来像：

```
/users/48573 
```

现在看起来像

```
/users/thisisausername. 
```

唯一的问题是，对于 API 的旧用户，我们仍然需要能够以某种方式通过数字 ID 获取它们。我们不需要 REST URL 本身重定向（例如`/users/48573`不应该重定向到`/users/thisisausername`），我们只需要一个使用旧标识符获取正确数据的方法。该解决方案应该提供一种通过 ID 访问用户信息（方便地包括新标识符，用户名）的替代方式，或者只通过 ID 访问用户名。一些可能的解决方案可能是：

*   使用一个节点来指定一些替代的识别方法，例如`/users/byid/48573`
*   使用查询参数来指定一些替代的识别方法，例如`/users/48573?fetchby=id`或`/users/48573?byid=true`
*   将 username-by-id 视为另一种资源，例如`/identifiers/username/48573`

其中哪一个（如果有）最接近正确的 REST？你会如何处理这个问题？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-03-16T19:31:08.887

我认为添加路径段/前缀是最好的答案。由于这些是唯一的辅助键，这与搜索（返回一组项目）不同，因此使用查询参数（未缓存）似乎不是最佳选择。

就个人而言，我计划使用由“=”分隔的路径段前缀，例如“name=”或“email=”：

```
user/123456
user/name=john.doe
user/email=john.doe@john.doe 
```

这在功能上等同于添加路径段（例如“user/name/john.doe”），但我觉得它更接近于概念模型。当然，这是一个无关紧要的细节，因为 RESTful API 无论如何都不应该指定固定的 URI 结构。

不使用查询参数也可以自然地访问子资源：

```
user/name=john.doe/inbox/df87bhJXrg63 
```

像 Java 的 JAX-RS 这样的框架支持使用任何你想要的分隔符：

```
@GET
@Path("user/{id}")
User getUser(@PathParam("id") UUID id);

@GET
@Path("user/name={name}")
User getUserByName(@PathParam("name") String name);

@GET
@Path("user/email={email}")
User getUserByEmail(@PathParam("email") String email); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-08T23:47:21.300

您的第一个选择可能是最好的。

按 ID 搜索用户：

```
/users/id/48573 
```

按短名称搜索用户：

```
/users/name/thisisausername 
```

如果他们省略了该路径参数，您可以始终默认使用新的短用户名格式。

我经常看到的另一个选项是使用如下查询参数：

```
/users?id=48573
/users?name=thisisausername 
```

我认为第一个看起来更干净，更具可读性。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-06-08T22:45:24.873

一个很老的问题，但我也有同样的问题，最终找到了解决方案：在你的路径参数中使用正则表达式。

这是我编写该用例的方式

```
@GET
@Path("/{id : \\d+}")
@Produces(APPLICATION_JSON)
public Response getById(@PathParam("id") long id) {
 <<your code>>
}

@GET
@Path("/{name}")
@Produces(APPLICATION_JSON)
public Response getByName(@PathParam("name") String name) {
 <<your code>>
} 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-05-18T17:21:22.280

我会考虑使用可选后缀来限定字符串：

```
/users/48573/id

/users/48573/name 
```

如果您收到没有后缀的字符串：

```
/users/48573 
```

然后检查字符串，看看它是 ID 还是名称。

如果您只得到一个有效的 ID 而不是一个名字，那么它是一个 ID 检索，相当于：

```
/users/48573/id 
```

如果您只得到一个名称，那么它是按名称检索，相当于：

```
/users/48573/name 
```

如果您可以通过 ID 或名称检索该值，那么您将返回 300 响应错误并将指向这两种可能性的链接返回给客户端：

```
/users/48573/id

/users/48573/name 
```

传统消费者继续“按原样”工作，但偶尔会出现重复的 ID/姓名对，他们会收到新的 300 响应错误。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2009-07-20T18:06:40.240

如果这是一个问题，您的 API 不是 RESTful。[引用](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)罗伊菲尔丁的话：

> REST API 不得定义固定的资源名称或层次结构（客户端和服务器的明显耦合）。服务器必须可以自由控制自己的命名空间。相反，允许服务器通过在媒体类型和链接关系中定义这些指令来指导客户端如何构建适当的 URI，例如在 HTML 表单和 URI 模板中完成。[这里的失败意味着客户端由于带外信息而假设资源结构，例如特定于域的标准，它是面向数据的等价于 RPC 的功能耦合]。
> 
> 除了初始 URI（书签）和适合目标受众（即，任何可能使用 API 的客户端都可以理解）的标准化媒体类型集之外，应该在没有任何先验知识的情况下输入 REST API。从那时起，所有应用程序状态转换必须由客户端选择服务器提供的选项驱动，这些选项出现在接收到的表示中或用户对这些表示的操作暗示。转换可以由客户端对媒体类型和资源通信机制的了解来确定（或限制），这两者都可以在运行中（例如，按需编码）得到改进。[这里的失败意味着带外信息正在推动交互而不是超文本。]

# c++ - 需要帮助将一个 wchar_t 附加到另一个！C++

> ID：842268
> 
> 赞同：3
> 
> 时间：2009-05-08T23:41:22.577
> 
> 标签：c++

我已经尝试过 wcscat() 但我遇到了运行时访问冲突。

```
wchar_t* a = L"aaa";
wchar_t* b = L"bbb";
wchar_t* c;
c = wcscat(a, b); 
```

有人可以告诉我这里有什么问题吗？或者另一种方法来解决我的问题？谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-08T23:47:00.583

`wcscat`不会创建新字符串 - 它只是附加`b`到`a`. `b`因此，如果要确保不会导致运行时访问冲突，则需要确保`a`. 在上述情况下：

```
wchar_t a[7] = L"aaa";
wchar_t b[]  = L"bbb";
wchar_t* c;
c = wcscat(a, b); 
```

您仍然可以从函数中获取返回值，但它只会返回`a`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T23:45:49.477

使用 c++ 内置的 wstring：

```
#include <string>
using std::wstring;

int main()
{
    wstring a = L"aaa";
    wstring b = L"bbb";
    wstring c = a + b;
} 
```

`wcscat`适用于 c 风格的字符串，而不是 c++ 风格的字符串。执行此操作的 c 方法是

```
wchar_t* a = L"aaa";
wchar_t* b = L"bbb";
wchar_t c[7];
wcscpy(c, a);
wcscat(c, b); 
```

编辑：哇，现在我编辑了它，它看起来像是我复制了下面的答案之一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T23:46:59.367

该`wcscat`函数将第二个参数附加到第一个参数中的字符串缓冲区。看起来这可能是您在 C 中使用字符串的第一次体验。您可以通过执行以下操作使您的示例工作：

```
wchar_t* a = L"aaa";
wchar_t* b = L"bbb";
wchar_t c[7];
wcscpy(c, a);
wcscat(c, b); 
```

使用 C 字符串操作函数时，您必须确保为开始执行的字符串操作分配足够的缓冲区空间（C 运行时不会为您执行此操作）。在这种情况下，这意味着`c`缓冲区必须包含足够的空间来保存结果字符串。我已经预先计算出结果是 6 个字符长加上尾随的 null，这意味着我需要分配 7 个字符。

# c++ - 如何判断一个C++模板是否有指定方法

> ID：842273
> 
> 赞同：0
> 
> 时间：2009-05-08T23:45:08.887
> 
> 标签：c++, templates

假设我正在编写一个`GCD`同时使用`operator/`和的函数模板`operator%`。对于某些类型，例如，复数或多项式都可以有效地计算（即，当除以多项式时，您“免费”获得余数）。所以我的一些类模板已经`divmod`实现，它返回一对商和余数。

但是，某些类，尤其是内置类型，例如`int`，没有`divmod`（或等效）实现。如果我要写一个`GCD`使用`divmod`我会歧视其他类型（反之亦然）。我还没有想出一个不需要`GCD`重复大部分代码的模板专业化。

我在这里有什么选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T23:54:59.673

我会在此基础上选择类型特征和模板专业化。您可以使用元编程来确定该类型是否具有 divmod，并在此基础上提供通用算法的特定部分。也就是说，将算法的公共部分提取到通用代码中，该代码根据类型特征为不同部分调用专门的函数。

查看[boost::type_traits 库](http://www.boost.org/doc/libs/1_38_0/libs/type_traits/doc/html/index.html)，了解类型特征的实现，以及[基于策略的设计](http://en.wikipedia.org/wiki/Policy-based_design)，了解如何通过（策略）模板在通用代码库中注入不同的行为。

# wpf - 在 WPF 中，如何为窗口的宽度设置动画？

> ID：842276
> 
> 赞同：0
> 
> 时间：2009-05-08T23:46:54.157
> 
> 标签：wpf, animation

正如标题所说，我应该如何为窗口的高度或宽度设置动画？我可以做类似的事情：

```
var wdw = new Window();
var ani = new DoubleAnimation(wdw.Width + 150, TimeSpan.FromSeconds(0.2));
wdw.Show();
wdw.BeginAnimation(SomeDependencyProperty, ani) 
```

...但 Width 似乎不是依赖属性。我错过了什么吗？有没有正确的方法来做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T00:18:32.347

没关系，我的问题是我正在做一个 wdw.ShowDialog() （我的例子没有）

# javascript - JavaScript 中的函数调用

> ID：842279
> 
> 赞同：0
> 
> 时间：2009-05-08T23:47:12.157
> 
> 标签：javascript, function, call

我很难过，我似乎无法调用这个简单的 Javascript 函数。谢谢！

```
 <html>
 <head>

<script type="text/javascript">

    function increase()
    {
        alert(" the button was pressed");
    }

</script>         
 </head>

 <body>

 <form action="Test.html" method="post">

   <input type="submit" onclick="increase();" />

</form>   

 </body>
 </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T23:59:18.680

试试这个：

```
<input type="button" id="buttonId">Button</input>

<script language="javascript">
    function increase() { alert(" the button was pressed"); } 

    document.getElementById("buttonId").onClick=increase;
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T00:09:08.987

很难说你哪里出错了。看起来您只是在定义一个函数。这将在页面加载时运行增加函数：

```
<script type="text/javascript">
  function increase() {
    alert(" the button was pressed");
  }
  increase();
</script> 
```

这将在按下按钮时运行该函数。

```
<script type="text/javascript">
  function increase() {
    alert(" the button was pressed");
  }
</script>
<button onclick="increase()">text</button> 
```

听起来你才刚刚开始，这太棒了。我也建议买一本书。几年前，我读了 Jeremy Keith 的[DOM Scripting](http://domscripting.com/book/)，还不错。另外，尝试在网上四处寻找教程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T23:49:10.187

你试过这个吗？您需要在脚本标签之间放置 JavaScript：

```
<script type="text/javascript">
    function increase() { alert(" the button was pressed"); } 
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T23:54:37.100

除了 Praveen 所说的，我同意，[这里](http://www.hunlock.com/blogs/Essential_Javascript_--_A_Javascript_Tutorial)和[这里](http://www.w3schools.com/js/default.asp)都有很好的初学者教程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-01T12:34:06.580

在您的代码中，表单在您单击按钮时提交。
你需要做的是返回 false；这样表格就不会提交..

```
<form action="#" method="POST">
  <input type="submit" onclick="return false; increase();">
</form> 
```

# php - 文件重写不起作用？

> ID：842281
> 
> 赞同：0
> 
> 时间：2009-05-08T23:47:25.590
> 
> 标签：php, file

测试.php

```
<?php
$filec = fopen('test.txt','w');

$arr = file('test.txt');

foreach ($arr as $key => $value) {
    fwrite($filec,$value);
}

fclose($filec);
?> 
```

测试.txt

```
asdjlaksjd
asdhfwejkyhtjkre
jfdhgdjkf'hgjldsff
sfjnkbnm,cv
sm,nxcm,b,
sdjlhfskld
jfsdfwerwlur
slfdjsdkljfklsdjf 
```

当我运行 test.php 时，test.txt 被清空。有谁知道为什么？

呼应 $value 等似乎有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T23:50:46.987

当您使用 调用`fopen`时`w`，您实际上是在清除文件。当你打电话时`file`，你正在从那个清除的文件中读取。

把电话放在`file`电话之前`fopen`。

# c# - 如何创建自定义 Outlook 项目？

> ID：842285
> 
> 赞同：4
> 
> 时间：2009-05-08T23:48:31.547
> 
> 标签：c#, outlook, vsto, outlook-addin

我了解 Outlook 已设置项目，即邮件、任务、日历、便笺等。如何创建 Outlook 将识别为其他项目的自定义项目？我知道，当您添加 Business Contact Manager 时，它会创建“机会”之类的项目

你能覆盖一个项目，或者继承一个项目并改变/添加属性和方法吗？

例子：

```
olAppointmentItem           1         Represents an AppointmentItem 
olContactItem               2         Represents a ContactItem 
olDistributionListItem      7         Represents an DistListItem 
olJournalItem               4         Represents a JournalItem 
olMailItem                  0         Represents a MailItem 
olNoteItem                  5         Represents a NoteItem 
olPostItem                  6         Represents a PostItem 
olTaskItem                  3         Represents a TaskItem 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T09:23:47.857

Outlook 能够创建自定义表单。您使用表单设计器插件来查看 Outlook，所有版本的 Outlook 都内置了一个。您可以使用工具 | 启动设计会话。表格 | 设计一个表单命令。或者，在 Outlook 2003 或更早版本中打开任何 Outlook 项目，然后选择工具 | 表格 | 设计这个表格。

当你设计一个表单时，你会从现有的表单开始，比如约会、任务等。最接近空白表单的是邮寄表单。

表单后面可以有 VBScript 代码来响应用户操作——验证数据、将其与数据库同步、创建新的 Outlook 项目等。要添加代码，一旦您处于表单设计模式，请单击工具栏上的查看代码命令或丝带。

然后，您可以将表单发布到组织表单库中，以便每个人都可以访问它们。它们也可以直接发布到文件夹中。个人表单发布到文件夹或您的个人表单库。

在 Outlook 帮助中有很多关于这类事情的帮助文档，谷歌也会返回大量的网站来告诉你如何做。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-07T00:03:25.973

> 您不能创建新的“类型”；但是您当然可以通过添加自己的属性来重用现有类型。

该评论不正确。您当然可以使用自定义表单，您只需先将它们发布到表单库，并让用户可以访问它们。通常它们是基于其中一种默认项类型的设计，也可以作为默认项类型与文件夹关联。

编辑：（根据评论请求更新帖子）

A.创建并发布自定义表单 - [http://office.microsoft.com/en-au/outlook/HA012106101033.aspx](http://office.microsoft.com/en-au/outlook/HA012106101033.aspx)

B. 以编程方式创建自定义表单的实例。

```
Outlook.Application olApp = new Outlook.Application();
    //mapifolder for earlier versions (such as ol 2003)
    Outlook.Folder contacts = olApp.Session.GetDefaultFolder(Outlook.olDefaultFolders.olFolderContacts);
    //must start with IPM.   & must be derived from a base item type, in this case contactItem.
    Outlook.ContactItem itm = (Outlook.ContactItem)contacts.Items.Add(@"IPM.Contact.CustomMessageClass");
    itm.Display(false); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T22:23:55.610

您不能创建新的“类型”；但是您当然可以通过添加自己的属性来重用现有类型。

# iphone - iPhone 上 XML 解析的最佳方法

> ID：842292
> 
> 赞同：5
> 
> 时间：2009-05-08T23:49:47.767
> 
> 标签：iphone, objective-c

我已经熟悉了 iPhone SDK 中的 NSXMLParser，但我发现它的事件驱动性质对于我的目的来说很尴尬。我只是想提取一些元素值，但是这个必须处理 startElement、foundCharacters 和 endElement 的概念似乎比它真正应该做的工作更多。我只是以错误的方式看待这个问题，还是有一种更简单的基于树/DOM 的方式在 iPhone SDK 中使用 XML？

如果建议只使用 NSXMLParser，是否可以使用某些设计模式来防止我的代码在 startElement 方法中有 5 级嵌套 ifs？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-09T00:44:35.220

如果您使用的是 iPhone，则使用基于树的解析可能会占用大量内存。相信我，我去过那里，在过去五个月的主要 iPhone 应用程序开发过程中，我尝试了许多不同的方法。在您下载包含 400 条非常长的评论的某人的评论流之前，基于树的解析工作正常，原始数据大约为 600KB。除了生成的 XML 树的大小之外，在创建该树时内部分配的内存可能是巨大的。

我最终创建了一个 NSXMLParser 的变体，它从提供的 NSInputStream 中提取数据，而不是使用单个数据块，并且一次只将 1KB 传递给 libxml 进行处理（NSXMLParser 也使用 libxml，但传递了 100% 的数据一气呵成）。

源代码可[在 github 上](http://github.com/AlanQuatermain/aqtoolkit/tree/master)找到（查看 StreamingXMLParser 文件夹）。您还会在其中找到一个委托超类；对于大多数解析需求，您可以继承 AQXMLParserDelegate`-start[Element]WithAttributes: (NSDictionary *) attrs`并在您的子类中实现和`-end[Element]`。当发现开始和结束标记时，将为您调用这些方法，并且在结束标记内，您可以使用它`self.characters`来访问元素的内容字符或 CDATA。

有关不同解析器的相对内存占用的更多信息（尽管是在 Mac 上，而不是在 iPhone 上），请参阅我的原始博客文章[和](http://alanquatermain.net/post/93651539/aqxmlparser-big-memory-win)NSXMLDocument 的后续[文章](http://alanquatermain.net/post/93664991/aqxmlparser-test-redux)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T23:59:52.393

考虑以下代码片段，它使用[libxml2](http://www.xmlsoft.org/)、[Matt Gallagher 的 libxml2 包装器](http://cocoawithlove.com/2008/10/using-libxml2-for-parsing-and-xpath.html)和[Ben Copsey 的 ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest-CFNetwork-wrapper-for-HTTP-requests)来解析 XML 文档。

type的`nodes`实例`NSArray*`将包含`NSDictionary*`您可以递归解析以获取所需数据的对象。

或者，如果您知道 XML 文档的架构，您可以编写一个[XPath](http://www.w3schools.com/XPath/xpath_examples.asp)查询来直接获取 a`nodeContent`或`nodeAttribute`值。

```
ASIHTTPRequest *request = [ASIHTTPRequest alloc] initWithURL:[NSURL URLWithString:@"http://stackoverflow.com/"];
[request start];
NSError *error = [request error];
if (!error) {
    NSData *response = [request responseData];
    NSLog(@"Root node: %@", [[self query:@"//" withResponse:response] description]);
}
else 
    @throw [NSException exceptionWithName:@"kHTTPRequestFailed" reason:@"Request failed!" userInfo:nil];
[request release];

...

- (id) query:(NSString *)xpathQuery withResponse:(NSData *)respData {
    NSArray *nodes = PerformXMLXPathQuery(respData, xpathQuery);
    if (nodes != nil)
        return nodes;
    return nil;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T12:21:41.260

重新利用 Seismic XML 中的代码提供了一个非常好的 API，可以从 XML 创建 NSObject 子类。

> 如果建议只使用 NSXMLParser，是否可以使用某些设计模式来防止我的代码在 startElement 方法中有 5 级嵌套 ifs？

我取决于你想要做什么。您可以将元素名称放在字典中，并根据字典中的相关对象采取行动——这实际上是 SeismicXML 所做的。

# c# - 使用包含未知但相似对象的哈希表 (C#)

> ID：842298
> 
> 赞同：4
> 
> 时间：2009-05-08T23:51:35.080
> 
> 标签：c#, .net, oop

我有一个可以包含任意数量的对象的哈希表。所有这些对象都实现了一些类似的方法/属性以及它们自己的一些。

例如，哈希表中的所有对象都可能有一个名为 PrintText 的方法，该方法采用字符串类型的单个参数。然而，所有对象都是从不同的类实例化的。

我是否可以在运行前不知道其类型的情况下通过其键从哈希表中提取特定对象，并访问其所有自己的方法和属性（不仅仅是常见的）？

通常我会做类似的事情，

MyClass TheObject = MyHashTable[Key];

但是被拉出的对象可以从任何类派生，所以在这种情况下我不能这样做。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-08T23:57:37.767

您可以定义一个包含常用方法和属性的接口，并在所有类中实现此接口。然后您可以轻松访问这些方法和属性。

但是要访问对象的特定方法（不包含在接口中），您需要知道对象的类型。

更新：

从你的问题中不清楚，但是当你写一个哈希表时，我假设你的意思是[Hashtable 类](http://msdn.microsoft.com/en-us/library/system.collections.hashtable.aspx)。在这种情况下，您应该查看[通用 Dictionary 类](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)（自 .NET 2.0 起可用）。此类将使您的代码类型安全，并使您免于大量类型转换，例如：

```
IMyInterface a = new MyObject();

// with Hashtable
Hashtable ht = new Hashtable();
ht.Add("key", a);
IMyInterface b = (IMyInterface)ht["key"];

// with Dictionary
var dic = new Dictionary<string, IMyInterface>();
dic.Add("key", a);
 // no cast required, value objects are of type IMyInterface :
IMyInterface c = dic["key"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T23:58:24.783

要解决常见方法和属性的问题，您可以通过使您的类实现相同的接口来解决。但是，我看不到您如何访问非普通成员。您可以尝试使用反射。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T23:59:47.667

C# 4 中的动态。早期版本中的反射。

编辑：在某些情况下，定义一个通用接口可以是实现您所描述的性质的一种有效而清晰的方法。（受接受的答案和/或其他人提及它的“启发”——不记得时间线了）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T00:07:42.327

你可以说：

```
object theObject = MyHashTable[Key]; 
```

然后你可以说：

```
theObject.GetType()
  .GetMethod("PrintText")
  .Invoke(theObject, new object[] {"paramvalue"}); 
```

# iphone - UIView 动画交互不好

> ID：842309
> 
> 赞同：3
> 
> 时间：2009-05-08T23:54:51.330
> 
> 标签：iphone, animation, uiview

我看到似乎是单独动画之间的交互，我非常感谢任何消除这种影响的建议。

基本上：我有一个 iPhone 应用程序，它在根视图上包含一个按钮“a”。点击“a”将视图推送到导航视图控制器堆栈上，并带有翻转动画。推送的视图有一个按钮可以将视图弹出回根目录。

底层代码：

```
- (IBAction)pushOneView{
TheAppDelegate *delegate = [[UIApplication sharedApplication] delegate];
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:0.5];
[UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
[UIView setAnimationTransition: UIViewAnimationTransitionFlipFromRight 
                    forView:delegate.navigationController.view cache:NO];
[delegate.navigationController 
            pushViewController:oneViewController animated:NO];
[UIView commitAnimations]; 
```

}

这似乎工作正常，动画非常流畅。

根视图还包括一个子视图（“panelView”）和另一个按钮“b”。panelView 可以显示其他两个子视图中的任何一个——在这些子视图之间点击“b”交换，并带有旋转动画。编码：

```
-(IBAction)swapPanels{
UIViewController *coming;
UIViewController *going;
float rotation;

if (self.aPanel.view.superview == nil) {
    coming = aPanel;
    going = bPanel;
    rotation = 3.14;
}
else {
    coming = bPanel;
    going = aPanel;
    rotation = -3.14;
}

// First half of spin
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:0.25];
CGAffineTransform swirlTransform = CGAffineTransformMakeRotation(rotation);
panelView.transform = swirlTransform;
[panelView setAlpha:0.1];
[UIView commitAnimations];

// Finish spin
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:0.25];
CGAffineTransform secondTransform = 
                        CGAffineTransformRotate(swirlTransform, rotation);
panelView.transform = secondTransform;
[panelView setAlpha:1];
[UIView commitAnimations];

// Swap the panels
[going.view removeFromSuperview];
[panelView insertSubview:coming.view atIndex:0]; 
```

}

这似乎也可以正常工作。每个可交换面板都包含一个选择器和一些标签。

但是，我注意到如果在它之前执行了“b”转换，那么“a”转换会变得缓慢而生涩。换句话说，如果我启动应用程序，来回运行'a'几次，它运行顺利。然后来回练习'b'几次。然后再试一次'a'......'a'现在是生涩的，并且会一直如此，直到应用程序重新启动。

这是 100% 可重复的。使用模拟器很微妙，但在设备上却很明显。我已经测试过泄漏——泄漏工具没有显示任何泄漏。如果动画从 'b' 操作中移除（只是注释掉动画步骤），则在执行 'b' 子视图交换后*不会观察到对 'a' 的影响。*如果将拾取器从可更换的面板笔尖中移除，同样会消除这种影响。如果“a”动画过渡设置为缓存，那么在“b”之后它不会在中间卡顿，而是似乎忽略动画，只是交换视图（这可能是感知问题）。

如果我不清楚：我不会同时触发这些单独的操作。动画 'a'，在 'b' 被执行之后——并且完成——与 'b' 从未被执行是不一样的。动画后我应该做清理工作吗？我的子视图交换代码有缺陷吗？或者...？

在此先感谢您的任何建议。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-09T03:20:01.100

您的“b”部分确实有两个重叠的动画。当您使用开始/提交块创建动画时，它会被移交给后台线程来执行。在您的“b”部分中，应该连续的两个动画实际上几乎同时被触发。这可能会导致奇怪的行为，可能就像您所看到的那样。

我建议使用如下代码在您的第一个动画中将回调添加到委托方法：

```
[UIView setAnimationDelegate:self];
[UIView setAnimationDidStopSelector:@selector(rotationAnimationFinished:finished:context:)]; 
```

在“b”中的第一个动画块中（“旋转的前半部分”部分）。然后你需要在你的类中定义回调方法，在这种情况下

```
- (void)rotationAnimationFinished:(NSString *)animationID finished:(BOOL)finished context:(void *)context; 
```

在该委托方法中，将在旋转动画的第一部分完成时调用，放置您的“b”方法中的剩余代码（“完成旋转”注释之后的所有内容）。

通过将这些动画分开，这可能会防止您看到的怪异现象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T17:39:51.250

Brad 的回答似乎*确实*让我找到了一个解决方案：这些症状继续表明运行那些“b”动画的某些东西使系统处于与启动时不同的状态。最后，我想到 panelView 的**transform**属性是在“b”动画之后设置的……也许这会影响包含 panelView 的超级视图的进一步动画。

所以我按照 Brad 的建议设置了方法，在“b”动画完成后执行——但该方法所做的只是将 panelView 转换设置回默认值：CGAffineTransformIdentity：

*   (void)spinFinished:(NSString *)animationID 完成:(BOOL)完成上下文:(void *)context { panelView.transform = CGAffineTransformIdentity; }

有了这个，“a”动画的“b”后执行似乎恢复了正常。再次感谢布拉德，感谢您在这里的帮助。非常*感谢*。

# outlook - 使用语法高亮将差异输出粘贴到 Microsoft Outlook

> ID：842313
> 
> 赞同：1
> 
> 时间：2009-05-08T23:55:41.280
> 
> 标签：outlook, diff, paste

如何将差异输出 () 复制到 Outlook 电子邮件中，以便可以**通过语法突出显示**`diff old-version.cpp new-version.cpp`将其发送给其他人？

 **我想将差异输出通过管道传输到一个程序，该程序将使用格式（`p4 diff file.cpp | rtfpatch`）将其复制到剪贴板，或者有一个 Outlook 插件，可以让我选择一些文本，单击一个按钮，然后它会被着色。

我使用 Windows（XP 和 Vista）、Perforce、Visual Studio、Beyond Compare 3、Outlook 2007。任何使用这些工具组合的东西都可以很好地工作（我不想改变我的主要差异程序等）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T02:50:25.250

您可以在会话菜单中使用 Beyond Compare 的“文本比较报告”命令来执行此操作。使用“交错”布局样式、“HTML 报告”输出样式和“复制到剪贴板”命令，它会将其作为彩色 HTML 复制到剪贴板。我没有 Outlook 进行测试，但它确实可以将其粘贴到 Word 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-28T17:53:14.373

我发现的另一个不错的解决方案是 vim 插件。[cliphtml.vim](http://www.h4ck3r.net/2010/05/27/vim-to-clipboard-highlighted-code/)为您提供`:ClipHtml`ex 命令，它将整个文件或选定区域复制到剪贴板，并带有 vim 的突出显示。

需要蟒蛇。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T00:03:43.850

许多编辑器能够将语法高亮文件导出为 HTML。从那里，您可以将 HTML 粘贴到 Outlook 中。例如，要在 Vim 中将文件导出为 HTML，请使用`:TOhtml`.

[这个 Visual Studio 插件](http://www.jtleigh.com/people/colin/software/CopySourceAsHtml/)也提供“导出到 HTML”功能。值得一试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T00:16:21.637

我想出了一个解决方案来制作一个使用 p4diff.exe 程序从 Perforce 中区分文件的批处理文件。

它的问题是 p4diff 输出整个文件，而不仅仅是更改的部分（我也更喜欢统一差异）。此外，区分特定版本需要从命令行调用 rtfdiff（自定义工具仅针对 HEAD 进行区分）。

[p4v 自定义工具](http://www.perforce.com/perforce/perforce/doc.current/manuals/p4v/custom_tools.html)定义（将其写入 tool.xml，然后将其导入 p4v 的管理自定义工具菜单）：

```
<CustomToolDef>
  <Definition>
    <Name>RTF Diff</Name>
    <Command>c:\scripts\rtfdiff.bat</Command>
    <Arguments>%f</Arguments>
  </Definition>
  <AddToContext>true</AddToContext>
</CustomToolDef> 
```

rtfdiff.bat 在哪里

```
:: Use p4diff to get copy-pasteable diff output.

:: setlocal so we use the default after script terminates
setlocal
set P4DIFF=c:\Perforce\p4diff.exe
:: Diff all inputs to allow multiple revisions (must be in increasing order)
p4 diff %* 
```

这将允许您右键单击文件并选择“RTF Diff”或通过命令行 ( `rtfdiff.bat file.txt#1 file.txt#2`) 调用 rtfdiff.bat。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T10:02:37.437

要将 html 粘贴到 Outlook 中，您应该尝试将其粘贴到 msg 的源中。右键单击 HTML 消息的正文并选择查看源，然后将您的 html 粘贴到其中。

另一种方法是在批处理文件中编写脚本，并将 Message html body 设置为等于您的 html 文本并发送。在 stackoverflow 上有很多通过脚本发送电子邮件的示例。有多种方法可以做到这一点，具体取决于您安装的内容等。一个示例是 使用 CDO
[从 Windows 脚本发送邮件](https://stackoverflow.com/questions/152323/send-mail-from-a-windows-script)

# delphi - 你能推荐一个真正超级原生的德尔福图形引擎吗？

> ID：842315
> 
> 赞同：0
> 
> 时间：2009-05-08T23:57:14.177
> 
> 标签：delphi, delphi-2009, charts, graphing

我们一直在使用 Pro Essentials 图表（gigasoft.com），但它不能很好地与 delphi 配合使用，所以它一直在引起问题。

我们需要显示波形和条形图（不能同时显示）。波形可能有数千个点。我们需要一些功能非常齐全的“活”产品。

我们的应用程序是本机 win32 delphi 2009 应用程序。

谢谢你的建议！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-09T02:03:29.897

试试 TeeChart

[http://www.steema.com/](http://www.steema.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T04:10:08.720

[阿格帕斯](http://aggpas.org)怎么样？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T00:26:34.997

我会尝试[LMD ChartPack](http://www.lmd.de/products/vcl/lmdchartpack/)。LMD 多年来一直在制作原生 Delphi 产品 - 如果它们能够处理您的场景，它们可能会很好地工作。

一些波形和条形图都应该能够做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T03:24:32.353

[试试这个链接](http://delphi.about.com/od/toppicks/tp/aatpmapchart.htm)。它列出了许多仅用于 Delphi 的组件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-11T05:45:26.563

试试我们的**RMChart**。

不是原生的 Delphi 组件，而是一个免费软件，我一直在我的许多应用程序中使用它。

# php - 横幅印象跟踪 - 数据库设计

> ID：842329
> 
> 赞同：1
> 
> 时间：2009-05-09T00:01:57.927
> 
> 标签：php, mysql, database-design, schema

寻找一些关于数据库设计的好建议，以跟踪多个横幅展示。

IE 我在 x 域上有 5 个横幅

我想在每个横幅上构建关于每个横幅每天展示次数等的数据。因此也可以查找其他日期范围。

最好是每天每行有一个日期，还是只跟踪每行的每次展示。

希望你能给点建议。

并提前感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T00:08:06.460

我建议创建最灵活的设计，使您可以在未来需求扩展时创建新报告。您建议客户需要有关“每日展示次数”的报告。如果他们稍后进来并说“一天中的什么时间展示次数最多”怎么办？“他们什么时候点击最多”怎么样？

所以最灵活的方法是每次展示都有 1 条记录，其中每条记录只是 banner_id 时间戳

稍后，您可以创建一个存储过程来聚合历史数据，从而清除您积累的大量数据 - 从而创建您关心的粒度级别的报告。我可以想象存储一个月的每小时数据和一年的每日数据。存储的过程只会写入存档表：

*   横幅 ID
*   时间间隔标识符（月/年的月数据，或日/月/年的日数据等）
*   展示次数

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T02:22:07.107

为什么要重新发明轮子？有很多免费的广告服务器。我听说过的最值得注意的是[OpenX](http://www.openx.org/)（以前是 phpAdsNew）。如果不出意外，您可以安装它并查看他们如何设置数据库。

# inversion-of-control - 您通常将 StructureMap 注册表类放在您的解决方案中的什么位置？

> ID：842334
> 
> 赞同：1
> 
> 时间：2009-05-09T00:07:55.773
> 
> 标签：inversion-of-control, structuremap

这是当前的布局：

解决方案：

*   核

    *   领域
    *   接口
*   数据访问

    *   提供者
    *   会议
*   服务

*   用户界面

*   单元测试

*   集成测试

我通常会尽量保持我的核心域实体/ POCO 尽可能轻而没有太多外部依赖项。所以我认为将它放在服务层中可能是有意义的，因为它通常具有对所有层的项目引用。

我注意到在 CodeCampServer 中，他们实际上为他们的 IoC 配置创建了一个名为 DependencyResolution 的单独项目：

[http://code.google.com/p/codecampserver/source/browse/trunk#trunk/src/DependencyResolution](http://code.google.com/p/codecampserver/source/browse/trunk#trunk/src/DependencyResolution)

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T03:17:20.800

IOC 配置应该放在一边。它不一定需要在一个单独的项目中，但它需要远离应用程序代码。我们将它放在 CodeCampServer 中的另一个项目中，以使“偏向一边”更加真实。但是在当前的生产应用程序中，我们将其保存在主项目中的单独命名空间中。我们合并项目以增加编译时间。

# javascript - 有没有办法选择兄弟节点？

> ID：842336
> 
> 赞同：131
> 
> 时间：2009-05-09T00:09:02.167
> 
> 标签：javascript, dom, siblings

出于某些性能原因，我试图找到一种仅选择所选节点的兄弟节点的方法。

例如，

```
<div id="outer">
  <div id="inner1"></div>
  <div id="inner2"></div>
  <div id="inner3"></div>
  <div id="inner4"></div>
</div> 
```

如果我选择了 inner1 节点，有没有办法让我访问它的兄弟`inner2-4`节点？

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2009-05-09T00:12:06.717

嗯......当然......只需访问父母，然后是孩子。

```
 node.parentNode.childNodes[] 
```

或者...使用 jQuery：

```
$('#innerId').siblings() 
```

**编辑：Cletus 一如既往地鼓舞人心。我进一步挖掘。这就是 jQuery 本质上获取兄弟姐妹的方式：**

```
function getChildren(n, skipMe){
    var r = [];
    for ( ; n; n = n.nextSibling ) 
       if ( n.nodeType == 1 && n != skipMe)
          r.push( n );        
    return r;
};

function getSiblings(n) {
    return getChildren(n.parentNode.firstChild, n);
} 
```

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2011-11-02T08:35:04.623

```
var sibling = node.nextSibling; 
```

这将在它之后立即返回兄弟姐妹，或者 null 没有更多的兄弟姐妹可用。同样，您可以使用`previousSibling`.

**[编辑]**再三考虑，这不会给出下一个`div`标签，而是节点后的空格。似乎更好

```
var sibling = node.nextElementSibling; 
```

也存在一个`previousElementSibling`.

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2017-07-18T04:43:00.823

快的：

```
var siblings = n => [...n.parentElement.children].filter(c=>c!=n) 
```

[https://codepen.io/anon/pen/LLoyrP?editors=1011](https://codepen.io/anon/pen/LLoyrP?editors=1011)

获取父母的孩子作为一个数组，过滤掉这个元素。

编辑：

并过滤掉文本节点（感谢[pmrotule](https://stackoverflow.com/users/1895428/pmrotule)）：

```
var siblings = n => [...n.parentElement.children].filter(c=>c.nodeType == 1 && c!=n) 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2017-09-08T21:38:23.593

从 2017 年开始：
直截了当的回答：`element.nextElementSibling`获得正确的元素兄弟。你也有`element.previousElementSibling`前一个

从这里获得所有下一个兄弟姐妹非常简单

```
var n = element, ret = [];
while (n = n.nextElementSibling){
  ret.push(n)
}
return ret; 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-08-15T14:52:16.957

你检查过 jQuery 中的“Sibling”方法吗？

```
 sibling: function( n, elem ) {
        var r = [];

        for ( ; n; n = n.nextSibling ) {
            if ( n.nodeType === 1 && n !== elem ) {
                r.push( n );
            }
        }

        return r;
    } 
```

n.nodeType == 1 检查元素是否为 html 节点并且 n!== 排除当前元素。

我认为您可以使用相同的功能，所有代码似乎都是香草 javascript。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-04-01T23:51:42.843

**有几种方法可以做到这一点。**

**以下任何一项都可以解决问题。**

```
// METHOD A (ARRAY.FILTER, STRING.INDEXOF)
var siblings = function(node, children) {
    siblingList = children.filter(function(val) {
        return [node].indexOf(val) != -1;
    });
    return siblingList;
}

// METHOD B (FOR LOOP, IF STATEMENT, ARRAY.PUSH)
var siblings = function(node, children) {
    var siblingList = [];
    for (var n = children.length - 1; n >= 0; n--) {
        if (children[n] != node) {
            siblingList.push(children[n]);
        }  
    }
    return siblingList;
}

// METHOD C (STRING.INDEXOF, ARRAY.SPLICE)
var siblings = function(node, children) {
   siblingList = children;
   index = siblingList.indexOf(node);
   if(index != -1) {
       siblingList.splice(index, 1);
   }
   return siblingList;
} 
```

**仅供参考：jQuery 代码库是观察 A 级 Javascript 的绝佳资源。**

**这是一个出色的工具，它以非常精简的方式展示了 jQuery 代码库。** [http://james.padolsey.com/jquery/](http://james.padolsey.com/jquery/)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-03-10T08:44:52.057

以下函数将返回一个包含给定元素的所有兄弟元素的数组。

```
const getSiblings = node => [...node.parentNode.children].filter(c => c !== node)

// get "c" element siblings (excluding itself)
const siblingsToC = getSiblings(document.querySelector('.c'))

console.log( siblingsToC )
```

```
<ul>
  <li class='a'>a</li>
  <li class='b'>b</li>
  <li class='c'>c</li>
  <li class='d'>d</li>
  <li class='e'>e</li>
</ul>
```

只需将所选元素`getSiblings()`作为唯一参数传递给函数即可。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-06-20T19:25:45.047

使用[document.querySelectorAll()](https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll)和[循环和迭代](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/for)

```
function sibblingOf(children,targetChild){
  var children = document.querySelectorAll(children);
  for(var i=0; i< children.length; i++){
    children[i].addEventListener("click", function(){
      for(var y=0; y<children.length;y++){children[y].classList.remove("target")}
      this.classList.add("target")
    }, false)
  }
}

sibblingOf("#outer >div","#inner2");
```

```
#outer >div:not(.target){color:red}
```

```
<div id="outer">
      <div id="inner1">Div 1 </div>
      <div id="inner2">Div 2 </div>
      <div id="inner3">Div 3 </div>
      <div id="inner4">Div 4 </div>
 </div>
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-08-07T10:04:03.437

以下是如何获得上一个、下一个和所有兄弟姐妹（双方）：

```
function prevSiblings(target) {
   var siblings = [], n = target;
   while(n = n.previousElementSibling) siblings.push(n);
   return siblings;
}

function nextSiblings(target) {
   var siblings = [], n = target;
   while(n = n.nextElementSibling) siblings.push(n);
   return siblings;
}

function siblings(target) {
    var prev = prevSiblings(target) || [],
        next = nexSiblings(target) || [];
    return prev.concat(next);
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-08-16T00:51:58.703

jQuery

```
$el.siblings(); 
```

本机 - 最新，Edge13+

```
[...el.parentNode.children].filter((child) =>
  child !== el
); 
```

本机（替代） - 最新，Edge13+

```
Array.from(el.parentNode.children).filter((child) =>
  child !== el
); 
```

原生 - IE10+

```
Array.prototype.filter.call(el.parentNode.children, (child) =>
  child !== el
); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-09T00:40:44.993

```
var childNodeArray = document.getElementById('somethingOtherThanid').childNodes; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-04-18T04:52:54.537

1）将所选类添加到目标元素
2）查找父元素的所有子元素，不包括目标元素
3）从目标元素中删除类

```
 <div id = "outer">
            <div class="item" id="inner1">Div 1 </div>
            <div class="item" id="inner2">Div 2 </div>
            <div class="item" id="inner3">Div 3 </div>
            <div class="item" id="inner4">Div 4 </div>
           </div>

function getSiblings(target) {
    target.classList.add('selected');
    let siblings = document.querySelecttorAll('#outer .item:not(.currentlySelected)')
    target.classList.remove('selected'); 
return siblings
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-03-23T16:16:47.940

[您可以使用currentNode.nextSibiling](https://developer.mozilla.org/en-US/docs/Web/API/Node/nextSibling)属性访问以下兄弟节点。

这是您可以在事件委托方式中执行的操作，这是一种添加事件侦听器的动态方式

```
 document.addEventListener('click', (event) => {
   if (event.target.matches("#inner1")) {
    console.log(event.targert.nextSibling); //inner2 div
    console.log(event.targert.nextSibling.nextSibling); //inner3 div 
    /* The more of the property you keep appending the further it goes to 
    the next sibling */
   }
 }) 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2016-03-24T21:49:20.187

```
x1 = document.getElementById('outer')[0]
      .getElementsByTagName('ul')[1]
      .getElementsByTagName('li')[2];
x1.setAttribute("id", "buyOnlineLocationFix"); 
```

# shell - 如何告诉 Zsh 将当前 shell 的历史记录写入我的历史记录文件？

> ID：842338
> 
> 赞同：22
> 
> 时间：2009-05-09T00:09:32.370
> 
> 标签：shell, zsh

我在一个拥有大量需要大量选项的工具的地方工作，所以我非常依赖我的 shell 的历史。我什至不时地备份它，以确保我不会丢失有用的、冗长的命令。

我刚刚输入了这些命令之一，我想确保它已刷新到历史文件中，但我在后台有一个长期运行的作业，我无法输入`exec zsh`. 在这种情况下我还能做些什么吗？

（当然，我可以将它复制并粘贴到一个文件中，但存在一个`flush-history`命令会更合乎逻辑。）

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-09T00:21:56.333

要将 shell 历史记录写入历史文件，请执行

```
fc -W 
```

`fc`有一些有用的标志，在`man zshbuiltins`.

您还可以在每个命令之后完全自动读取和写入历史文件（从而与每个正在运行的 zsh 自动共享您的历史文件），方法是`setopt -o sharehistory`. 在 中阅读更多与历史相关的选项`man zshoptions`。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-11-09T18:03:37.453

我也刚刚发现：

```
setopt INC_APPEND_HISTORY 
```

来自`man zshoptions`：

```
INC_APPEND_HISTORY
   This  options  works like APPEND_HISTORY except that new history
   lines are added to the $HISTFILE incrementally (as soon as  they
   are  entered),  rather  than waiting until the shell exits.  The
   file will still be periodically re-written to trim it  when  the
   number  of  lines grows 20% beyond the value specified by $SAVE-
   HIST (see also the HIST_SAVE_BY_COPY option). 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-07-07T23:13:34.553

并使用

```
fc -R 
```

在现有的 zsh shell 中读取历史记录（在写入之后）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-07T17:37:03.767

将下面的行添加到 ~/.zshrc，它将保存 1000 个我们通过更改 HISTSIZE 和 SAVEHIST 的值来增加的条目

```
HISTSIZE=1000
if (( ! EUID )); then
  HISTFILE=~/.zsh_history_root
else
  HISTFILE=~/.zsh_history
fi
SAVEHIST=1000 
```

# .net - 什么是好的传真服务器？

> ID：842340
> 
> 赞同：3
> 
> 时间：2009-05-09T00:10:49.543
> 
> 标签：.net, windows, fax

有什么推荐的在 Windows 中使用的传真服务器吗？为传入的传真寻找良好的 API 支持。（其中很多都适合外向）。我想在服务器获取传真并设置电话号码白名单以过滤垃圾邮件后以编程方式将传入的传真路由到电子邮件 - 全部在代码中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T14:47:51.897

我发现的两个最佳解决方案是[hylafax.org](http://www.hylafax.org/)和 jConnect。hylafax 的优势在于其 100% 免费和开源。由于您在这里发帖，因此您很有可能拥有完成这项工作的技术能力，如果您这样做了，您将获得丰厚的回报。[Haylafax](http://www.hylafax.org/)功能齐全，可以免费完成所有您想要的发送和接收。另一方面，如果您使用本地号码， [jConnect](https://www.j2.com/)是免费的，他们只收取免费电话费。两者都是很好的解决方案，但我会先尝试[Halafax](http://www.hylafax.org/)。

希望有帮助！让我知道您对 Hylafax 的看法。

*编辑*没有看到你上面的评论，Hylafax 没有 Windows 支持，抱歉 :( 但他们已经为这些预编译了 bin...

Debian Ubuntu Fedora Mandrake Red Hat CentOS Solaris SUSE FreeBSD OpenBSD NetBSD

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T14:56:59.010

我绝对会推荐看 Biscom。他们同时拥有传真服务器和传真托管解决方案。他们已经经营了23年，是一家非常稳定的公司。 [http://biscom.com/index.htm](http://biscom.com/index.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-30T13:41:20.467

我强烈推荐 FAXCOM [windows 传真服务器](http://www.biscom.com/products_solutions/faxcom_server.htm):)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-17T14:44:58.600

我强烈建议您选择查看[链接文本](http://www.freeswitch.org/ "自由开关")。它将在 Windows 或 linux 上运行，用 C 编写，非常高效/快速。如果您要进行大量传真并且不介意花一点时间来设置系统，那么这就是您要走的路。

这是一个免费的解决方案，您只需要从运营商处购买 VoIP 服务即可运行。有数千家这样的公司可供选择，而且价格非常便宜。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T00:13:09.490

我个人使用过 MyFax.com，它们是托管服务。他们将传真作为电子邮件附件发送给您——如果您已经拥有处理传入邮件的代码，则非常方便。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-09T08:27:04.900

PamFax 提供了一种传真服务，可以与来自各种编程语言（例如 PHP、Python、Ruby）的 API 一起使用。[http://www.pamfax.biz/en/developers/introduction/](http://www.pamfax.biz/en/developers/introduction/)有所有细节。免责声明：我为 PamFax 背后的公司 PamConsult 工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-07-30T22:25:30.807

如果您需要自定义托管商务传真解决方案和传真 API，请务必查看[eFax Corporate 。](http://enterprise.efax.com)他们有一个开发工具包、自定义管理门户并且是安全的。它们可能是您正在寻找的东西。

# assembly - 实模式，中断向量替换

> ID：842341
> 
> 赞同：6
> 
> 时间：2009-05-09T00:10:52.740
> 
> 标签：assembly, x86, bootloader, interrupt-handling

我正在尝试更多地了解系统是如何在上面所有漂亮的图形下真正工作的。因此，我目前正在使用 BIOS 在启动时加载的 512 字节内存，目前我猜还不能真正将其称为引导加载程序。无论如何，我正在替换一个中断向量，但有问题。更换中断 09h（键盘）后，它可以正常工作，按键时会输出“内存混乱”。但后来什么都没有。之后的每一次按键都无济于事。我不知道系统是否崩溃，或者我的处理程序是否遗漏了一些东西，下面是代码：

```
jmp start
times 100 db 0 ; Cleared space for stack

start:
xor ax, ax
mov ax, start
sub ax, 80
mov sp, ax 

mov al, 0x09   ; Interupt number
mov bl, 4
mul bl
mov bx, ax
xor ax, ax
mov es, ax
mov [es:bx], word prints ; My interupt handler
add bx, 2
mov [es:bx], word 0x00

bloader:
    jmp bloader

prints:
    cli
    push ax
    push bx
    push si
    mov si, msg       ; Message to print
    mov bl, 0x07
    mov bh, 0x00
    printnb:
        lodsb     ; Grab byte from message
        cmp al, 0 ; End of message
        je printf
        mov ah, 0x0E
        int 0x10  ; Print byte
        jmp printnb
    printf:
        mov al, 0x20
        out 0x20, al ; Inform interupt controller interupt has been handled
        pop si
        pop bx
        pop ax
        sti
        iret ; Interupt return

msg db "Memory messing",0

times 510 - ($ - $$) db 0
dw 0xAA55 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T00:39:12.377

自从我处理键盘中断以来已经有很长时间了，但是我认为您实际上缺少的是处理键盘硬件，因此它将清除中断条件并准备好生成另一个中断。

就像是：

```
 in     al, 60h     ; Read input buffer 
```

可能就是全部。

如果有机会，我会看看我在编写键盘驱动程序时是否有任何旧笔记或代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T00:44:29.260

我的猜测（我从未编写过键盘中断处理程序）是您还需要与键盘硬件交谈，以检索击键（否则键盘将不知道何时生成下一个中断）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-24T11:01:10.300

我发现了另一个问题。如果我们为具有两个单独的移动指令的 ISR 设置一个新的中断向量，那么有可能在这两个 mov 指令之间发生一个中断，然后它从一个损坏的向量中获取地址，其中包含旧位置的一部分和ISR 的新位置的其他部分。但是在这个位置上没有 ISR，没有中断结束指令，也没有 iret 指令。

为了防止此类不良事件，我们必须在这些移动指令周围放置一个 cli 和 sti 以设置新的中断向量。

```
cli
mov [es:bx], word prints ; My interupt handler
mov [es:bx+2], word 0x00
sti 
```

短剑

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T00:37:54.393

这只是一个疯狂的猜测，但问题可能在于您正在从 int 9h 处理程序调用 int 10h。尝试直接写入屏幕内存（只需在 0b800h:0 处增加字节并检查屏幕左上角的字符）。如果每次按键都增加，那么你不应该从 int 9h 调用 int 10h。

# arrays - 在 template.php Drupal 中定义数组

> ID：842352
> 
> 赞同：1
> 
> 时间：2009-05-09T00:13:20.067
> 
> 标签：arrays, drupal, function

我有一个包含数组的 drupal 函数。我想重新定义该数组中的一个变量。我是否只是将整个函数复制粘贴到 template.php 并将变量更改为我想要的？谢谢。

# c# - DataGrid 重绘速度慢

> ID：842354
> 
> 赞同：5
> 
> 时间：2009-05-09T00:15:17.770
> 
> 标签：c#, datagrid

我正在使用 System.Windows.Forms.DataGrid。它填充了大约 3000 行，并且重绘非常缓慢。如果我最小化和最大化我的表单，所有其他控件只会显示，但我最终会看到 DataGrid 逐行重绘。此 DataGrid 中的所有内容都是只读的，如果这有所作为。

**更新：**

我不确定如何为我的项目正确实施 CellValueNeeded() 事件，或者它是否有助于提高 DataGrid 的性能。

我正在创建一个包含 DataGridView 的用户控件（请参见下面的代码）。当调用 SetProject() 方法时，我的控件设置为我的 Project 类的特定实例。然后控件使用静态方法 Informa.Data.GetProjectDataTable(Project proj) 从 Project 中提取 DataTable。然后将 DataGrid 的 DataSource 属性设置为返回的 DataTable。

这是我第一次使用 ADO 或 DataGrids 做任何事情，所以请耐心等待。看起来 CellValueNeed() 允许我覆盖 DataGrid 如何为其中一个单元格查找值，但在我的情况下，这比 MSDN 上的示例复杂得多。我的数据的实际来源是各种 Node 对象的树形结构，其根是 Project 实例。每个节点都可以有一组可变的属性，用户也可以在运行时对其进行扩展。然后还有许多其他复杂性，节点从其父节点继承属性值，并从其子节点汇总其他属性。

Informa.Data.GetProjectDataTable() 消除了所有这些疯狂并生成所有节点的所有属性的单个平面数据表。在这一点上，我不关心能否将此表的任何更改与原始树结构相关联，或者在树结构更改时更新表的特定部分。我要做的就是在 DataGrid 中向用户显示数据。

那么我是否实现 CellValueNeeded() 从项目提供的 DataTable 中读取？我认为 DataGrid 已经知道如何有效地将 DataTable 用作数据源？

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using Informa;

namespace Informa
{
public partial class ProjectGridControl : UserControl
{
    private Project proj;

    public ProjectGridControl()
    {
        InitializeComponent();
    }

    public void SetProject(Project proj)
    {
        this.proj = proj;
        UpdateGridControl();
    }

    public void UpdateGridControl()
    {
        if (this.proj == null)
        {
            this.dataGrid.DataSource = null;
        }
        else
        {
            //Extracts a DataTable from the project and sets it as the 
            //DataSource of the property grid
            this.dataGrid.DataSource = Informa.Data.GetProjectDataTable(proj);
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-09T15:08:26.177

曾经有一只名叫 MacroSoft 的小狼，它和 Vidia the Sheep 一起度过了一段时间。他们制作了地球上最慢的文本和网格渲染，并在硬件发展繁荣的一年将所有工作推到了 CPU 上；一直以来，绵羊确保进一步放慢速度。

如果我是对的，你欠很多人的一封信:-)

您正在运行 NVidia 卡及其糟糕的驱动程序或类似的，并且看到 MSFT 拒绝修复 GDI+ 以与友好的供应商一起进行硬件加速（即使 Mono 会在他们决定为您提供一些节能和适当的硬件重用之前完成它；您知道体面的工程）。

将您的 DataGridView 包装成一个新类型（即继承）并将其 DoubleBuffered 属性设置为 true，更改设计器代码以使用该新类型。

可见的“逐行”渲染是这个行业在 2009/2010 年的糟糕程度，台式机上的超级计算机和单个 DLL，一家大公司拒绝修复，但很乐意让它在 Mounta-Dismounta-Vista 上执行得更慢而收费。小丑..

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-09T15:49:00.947

您是否打开了列的自动调整大小？由于启用了自动调整大小，我让用户在我们的应用程序中遇到了只有 10 行的大幅减速。基本上，一个网格允许用户选中/取消选中一个框以将一行添加到另一个网格，而第二个网格会随着每添加一行而出现指数级减速。

经过一些分析后，我发现将 5 行添加到第二个表需要大约 12 秒。最后尝试关闭列的自动调整大小，现在它是即时的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-02-04T01:40:12.970

我在绘制 datagridview 时遇到了很大的麻烦。我需要我的屏幕尽可能大，而且它的物理尺寸对疼痛速度的影响似乎比数据量等要大得多。对我来说真正的诀窍是设置 CellBorderStyle=None （显然每个单元格都负责绘制自己的边框，这似乎很荒谬，因为单元格边框保持固定在屏幕上，所以每个单元格在滚动时都不需要不断地重新绘制自己的边框，但无论如何......）。

现在，没有单元格边框的网格并不是一个好的网格。但幸运的是，您可以为列和行设置 DividerWidth。这些值默认为 0，但将它们设置为 1（如果您想要更厚，则设置为更高）将使您的“单元格”边框在外观上与 CellBorderStyle=Single 相同，但这次是“静态”绘制的（因为没有更好的词) 为整个datagridview。

此外，如果您有很多行，请将 AutoResize 属性设置为 False。

至少在我的情况下，油漆速度的提高是巨大的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-09T00:22:56.707

DataGridView 应该在虚拟模式下处理 3000 行而没有问题。

确保将[VirtualMode](https://stackoverflow.com/questions/842354/datagrid-slow-to-redraw)设置为 true （您提到您尝试过），并正确实现[CellValueNeeded](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellvalueneeded.aspx)。

有关详细信息，请阅读[有关 VirtualMode 的 MSDN 演练](http://msdn.microsoft.com/en-us/library/15a31akc.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-17T20:02:33.810

在 Visual Studio 2015 中，将 2 个`DataGridView`AutoSize 列设置为 None

```
dgv1.AutoSizeRowsMode = DataGridViewAutoSizeRowsMode.DisplayedCellsExceptHeaders; 
```

导致非常缓慢的行添加和用户列调整大小的问题。

因此，如果我**REM**退出上述行，则 UX 现在很快。看到[`AutoSizeRowsMode`](https://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.autosizerowsmode(v=vs.110).aspx)和大概相同的问题[`AutoSizeColumnsMode`](https://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.autosizecolumnsmode(v=vs.110).aspx)

# cryptography - 带有 WinCrypt 和 CryptImportKey 的硬编码 AES-256 密钥

> ID：842357
> 
> 赞同：3
> 
> 时间：2009-05-09T00:16:57.033
> 
> 标签：cryptography, aes, cryptoapi

我需要让 Win32 应用程序加载硬编码的 AES-256 密钥，最好使用 WinCrypt.h 方法。我的密钥是无符号字符 [32]，但我找不到要传递给 CryptImportKey 的密钥 blob 的正确格式。一切似乎都给了我无效的参数错误。有没有办法做到这一点？

（同样重要的是如何在 WinCrypt 中设置 IV。我根本不知道该怎么做）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-11T18:53:15.820

解决了。我使用了错误的 bType 并使用 256 作为 keySize 而不是 32。

```
BYTE myPrivateKey[] = 
    {1,2,3,4,5,6,7,8,9,10,
    11,12,13,14,15,16,17,18,19,20,
    21,22,23,24,25,26,27,28,29,30,
    31,32};
BYTE myIV[] = 
    {1,2,3,4,5,6,7,8,9,10,
    11,12,13,14,15,16};

struct aes256keyBlob
{
    BLOBHEADER hdr;
    DWORD keySize;
    BYTE bytes[32];
} blob;

blob.hdr.bType = PLAINTEXTKEYBLOB;
blob.hdr.bVersion = CUR_BLOB_VERSION;
blob.hdr.reserved = 0;
blob.hdr.aiKeyAlg = CALG_AES_256;
blob.keySize = 32;
memcpy(blob.bytes, myPrivateKey, 32);

HCRYPTKEY hKey;
if (CryptImportKey(hCryptProv, (BYTE*)&blob, sizeof(aes256keyBlob), NULL, 0, &hKey))
{
    if(CryptSetKeyParam(hKey, KP_IV, myIV, 0))
    {
        //do decryption here
    }
    else{/*error*/}

    CryptDestroyKey(hKey);
}
else{/*error*/} 
```

# ruby-on-rails - 重新定义 Rails 的方法

> ID：842359
> 
> 赞同：16
> 
> 时间：2009-05-09T00:17:21.383
> 
> 标签：ruby-on-rails, ruby

Rails 方法`Array#to_sentence`允许执行以下操作：

```
['a', 'b', 'c'].to_sentence # gives: "a, b, and c" 
```

我想扩展此方法以允许它占用一个块，以便您可以执行以下操作（其中 people 是 Person 对象的数组，具有 name 属性）：

```
people.to_sentence { |person| person.name }
# => "Bill, John, and Mark" 
```

我写扩展方法没有问题。但我不知道把它放在哪里。Rails 核心扩展在`ActiveSupport`. 我需要一个始终加载并预加载用户定义代码的地方（在任何应用程序代码之前）。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-09T00:30:58.170

创建`config/initializers/super_to_sentence.rb`. 此目录中的所有文件都是在加载 Rails 后加载的，因此您将有机会覆盖 Rails 的`Array#to_sentence`.

对于要在 Rails 加载之前加载的代码，请将其添加到`config/environment.rb`.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-09T07:10:44.057

我喜欢这样做：

```
# config/initializers/app.rb
Dir[File.join(Rails.root, "lib", "core_ext", "*.rb")].each {|l| require l }

# lib/core_ext/array.rb
class Array
  def to_sentence_with_block(*args, &block)
    if block_given?
      # do something...
      # to_sentence_without_block(*args) perhaps?
    else
      to_sentence_without_block(*args)
    end
  end
  alias_method_chain :to_sentence, :block
end 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-12T10:12:50.310

我认为这是一个丑陋的想法。你为什么不写

```
people.collect { |person| person.name }.to_sentence 
```

这看起来几乎一样，不会让其他阅读您的代码的人感到困惑（就像 2 年后的自己一样）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-16T05:34:46.307

只是在网上搜索，似乎好的做法是将它添加到 lib/

所以如果你想扩展一些 ruby​​ 类（在我的例子中是 DateTime），只需将代码放在 .rb 中，然后放在 config/environment.rb 中：

```
 config.after_initialize do
    require "lib/super_datetime.rb"
  end 
```

我的 super_datetime.rb 看起来像这样（来自[http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/140184](http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/140184)的代码）：

```
class DateTime
  def days_in_month
    self::class.civil(year, month, -1).day
  end
  alias dim days_in_month
  def weekdays
    (1..dim).to_a
  end
end 
```

重新启动您的服务器，您将可以访问所有 DateTime 对象的新方法。

# javascript - JavaScript、DHTML、jQuery：如何在 3 个 html 下拉菜单中实现“双向”主从关系（选择框）

> ID：842367
> 
> 赞同：0
> 
> 时间：2009-05-09T00:21:59.533
> 
> 标签：javascript, jquery

我们有一个要求让我在网上浏览了很长一段时间。这是问题场景。我们有一个网页，这里的页面包含三个下拉菜单，如下图所示（虚拟字段 - 但实际业务数据也在同一行）

在这里，我们有三个下拉菜单，数据根据其他两个中的选择动态填充。让我给你举个例子。每当有人单击下拉按钮时 - 下拉列表的值应使用其他两个下拉列表中选择的值动态生成。请参阅以下场景：

如果某人在第一个下拉菜单中预先选择了“Honda”并且他点击了“里程”下拉菜单 - “里程”下拉菜单应该：
a. 清除以前的选项（如果有）
b. 动态填充选项对于所有适用于“本田”的里程数（根据数据库）
c. 显示带有新选项的下拉菜单。

此外，无论选择的下拉菜单的任何顺序如何，流程都应该正常工作。

这是我遇到问题的地方 - 如果我为下拉列表编写“OnClick”处理程序并使用 AJAX 调用来获取值 - 下拉值已填充但在 IE 上 - 下拉列表再次折叠。此外，在 Firefox 中，选项填充正常 - 但下拉菜单有点过于动画（可以理解，因此我删除了所有选项并添加新选项）。

此外，如果可以在浏览器上处理整个过滤，那就太好了（因为 AJAX 调用需要一些时间）

```
如果您在上面的原始帖子中看不到它，这是图像 -
http://www.imagechicken.com/uploads/1241831231099054800.jpg

```

问候，
-阿什什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T00:43:22.913

您的问题是当用户单击它时您正在更新下拉内容。最好在相关下拉列表更改时更新下拉列表。例如：

```
$('#drop1').change(function(){
    $('#drop2').load(url, {option: $('#drop1').val()})
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T13:15:35.420

@Nadia 描述的轮询解决方案或 onchange 解决方案可能是您最好的选择。

# .net - 公共语言运行时实现了哪些语言？

> ID：842371
> 
> 赞同：0
> 
> 时间：2009-05-09T00:24:08.590
> 
> 标签：.net, clr

有谁知道针对 .NET 公共语言运行时的语言的完整列表？

我对 Windows 实现特别感兴趣，但如果有一个列表包含其他平台（Mono 等）上的 CLI 语言，那么这也很有帮助。我似乎无法在 Google 中发现这些信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T00:29:52.383

正如布赖恩在上面的评论中所指出的，语言被/被完全实现和/或仍在被维护的程度差异很大。

Brian Ritchie 维护了一个完整的 wiki 列表， [https://bitbucket.org/brianritchie/wiki/wiki/.NET%20Languages](https://bitbucket.org/brianritchie/wiki/wiki/.NET%20Languages)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T00:48:43.493

VB.net 与之前的版本相比怎么样？效果很好，而且看起来很完美......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-02T20:27:14.483

Progress OpenEdge 使用 CLR .net 网桥。

# turing-machines - JFLAP 图灵机快捷方式问题

> ID：842379
> 
> 赞同：0
> 
> 时间：2009-05-09T00:29:48.077
> 
> 标签：turing-machines, jflap

在[JFLAP](http://jflap.org)中，有一些图灵机转换的快捷方式。只要当前磁带符号不是指示符号，这些快捷方式之一就允许您进行转换。例如，转换 !g,x;R 基本上表示“如果当前磁带符号不是 g，则进行此转换”。

到现在为止还挺好。但我想要的过渡是 !□,~;R 基本上说“只要当前符号不是字符串结尾（空单元格）符号就向右移动”。问题是我不知道如何输入“！□”。

JFLAP[在线文档](http://www.jflap.org/tutorial/turing/one/index.html#syntax)有这样的说法：

> 第一个快捷方式是存在使用“！”的选项 字符来传达“除此字符之外的任何字符”的含义。例如，关于过渡（！a；x，R），如果头部遇到除“a”之外的任何字符，它将用“x”替换字符并向右移动。要写表达式“！□”，只需在输入命令时输入“1”即可。

我该如何做最后一句话试图向我解释的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T00:59:40.143

好的，我刚刚意识到文档有错字。在它说“输入“1””的地方，它应该说“！”。JFLAP 看到了裸露的“！” 并附加“□”。感谢 Zifre……我更加努力了。

# asp.net - Web部署项目帮助

> ID：842383
> 
> 赞同：0
> 
> 时间：2009-05-09T00:32:44.373
> 
> 标签：asp.net, asp.net-mvc, projects

我在哪里可以获得有关 Web 部署项目 2008 的完整参考资料？

我已经搜索过了，但似乎只有关于 WDP 特定特征的博客帖子或论坛问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T06:49:38.647

我不相信 WDP 有单一的文档来源。[ScottGu 博客文章](http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)具有最多的信息和[博客文章的链接，其中包含有关它们在 2005 版本中如何工作的更多信息，](http://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx)与 2008 版本基本相同。

博客文章中没有涉及到它们的内容（我认为构建事件是唯一的，这些是标准的 MSBuild 概念，因此您可以在周围找到它们）。您是否遇到了特定的问题或您想要实现的目标？

# java - 更改 LinkedList 中的参数

> ID：842384
> 
> 赞同：1
> 
> 时间：2009-05-09T00:33:51.827
> 
> 标签：java, linked-list

我是java新手，所以我遇到了一些“烦人”的问题。我有一个 Employee 类，其中包含一个`int idNumber`和一个`int phone number`. 然后我有一个`LinkedList<Employee>`排序依据`idNumber`。我想更改某个电话号码`idnumber`。我一直在使用迭代器，但我不知道我是否做得对，我对此表示怀疑。

```
public void setNewPhoneNumber(int idnumber, int newphone){
        Iterator<IndexC> it = listEmployee.iterator();   
        IndexC employeeTemp = null;

        boolean found = false;
        while(it.hasNext() && !found){ 
                employeeTemp = it.next();
                if(employee.getIdNumber()== idnumber){
                    employeeTemp.setNewPhoneNumber(newphone);
                    found = true; 
                }
        }  
} 
```

是的，我知道`employee.setNewPhoneNumber`是错的，但我不知道哪种正确的方法可以改变链表上的值。（抱歉英语不好，不是母语人士）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T01:02:23.803

迭代器很痛苦；foreach 结构要好得多：

```
public void setNewPhoneNumber(int idnumber, int newphone) {
        for (Employee employee : listEmployee)
                if (employee.getIdNumber() == idnumber) {
                    employee.setNewPhoneNumber(newphone);
                    return; 
                }
} 
```

我不清楚 IndexC 是什么，而且我不经常使用 LinkedList - 我在这里可能遗漏了一些微妙之处 - 但我认为你最好避免使用迭代器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T00:45:02.097

*   您不是“更改链接列表中的参数”，而是尝试在列表中查找对象并更改该对象的属性
*   您应该使用 Map（例如 HashMap）而不是 List，这样您就不必迭代了。
*   如果您进行迭代，请使用 for 循环：`for(IndexC employeeTemp: employeeTemp){}`
*   更改电话号码通常会通过一个`setPhoneNubmer()`方法来完成，但这完全取决于`IndexC`类是否有这样的方法。看看那个类的定义。
*   提出问题时，请始终包含错误消息！“它不起作用”是一个非常无用的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T00:55:23.587

它不起作用的一个原因是列表中没有满足 (employee.getIdNumber()== idnumber) 的 IndexC。

也许您应该发布一些额外的代码，例如，该列表是在哪里创建的，您是否填写了任何内容？

此外，什么是行不通的？新电话号码的设置，还是从列表中检索元素？

在这两种情况下，我认为您应该发布这两种方法，即

```
getIdNumber(); 
```

正如 Mike B. 所说，也许使用 Map 实现会更好。由于您正在考虑顺序，因此 SortedMap（例如 TreeMap）实现可能会更好。

在任何情况下，请记住您必须覆盖 IndexC 中的两个方法（使用地图时）。否则，事情会变得一团糟。

*   等于
*   哈希码

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T01:25:11.253

我的错，IndexC 是 Employee 类，“糟糕的复制过去”对不起。我不喜欢 LinkedList，但我必须将它与 +5000 个条目一起使用（学校练习）。我认为不建议使用 for 有这么多条目。类作为集合，获取，克隆..

```
class Manager{
private LinkedList<Employee> listE = new LinkedList<Emploee>;

public void setNewPhoneNumber(int idnumber, int newphone)
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-09T00:47:07.583

[http://java.sun.com/j2se/1.4.2/docs/api/java/util/LinkedList.html](http://java.sun.com/j2se/1.4.2/docs/api/java/util/LinkedList.html)

你想使用一个 int 递增的 for 循环，直到你找到你想要的对象。然后您想使用 listEmployee.get() 来获取您想要的对象并对其进行编辑。

但是，如果您需要随机访问此类项目，那么您不应该使用链接列表。将其粘贴在 ArrayList 中。这有更好的随机访问时间。

附带说明一下，如果 id 编号从 0 开始排列，您甚至不需要 for 循环。你可以简单地 listEmployee.get(idNumber)

# firefox - 在 Firefox 中实现 about:config 等配置设置的最流行方法是什么？

> ID：842385
> 
> 赞同：1
> 
> 时间：2009-05-09T00:34:50.563
> 
> 标签：firefox, configuration-management

我想实现/使用现有的跨平台配置设置工具，例如`about:config`在 Firefox 中。它必须在 Windows 和 Mac 上工作。有没有人们推荐的库或设计模式？

另外，如果我要使用一个库，它必须是“像啤酒一样免费”并且不能是 GPL 许可证。apache许可证就可以了。

Windows 端使用 C++/MFC，Mac 端使用 Objective-C。必须在两个平台上读取配置文件，但它们不必共享同一个库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T00:36:56.827

属性文件/ini 文件。

*   Python 有一个库。（[配置解析器](http://docs.python.org/library/configparser.html)）
*   C++ 可能不少，但这是谷歌热门。（[粗鲁配置](http://rudeserver.com/config/)）
*   Java有[ini4j](http://ini4j.sourceforge.net/)
*   .NET 有[nini](http://davidhayden.com/blog/dave/archive/2004/07/03/348.aspx)

# java - 通过 JNI C 代码将 PNG 图像作为 BufferedImage 加载到 Java 中

> ID：842386
> 
> 赞同：2
> 
> 时间：2009-05-09T00:35:01.187
> 
> 标签：java, java-native-interface, bufferedimage

我有以下问题。我有 C 代码，它获取 PNG 图像作为基本的原始数据并将其保存在内存中。我希望通过使用 JNI 将这些原始数据转换为 Java 中的 BufferedImage。有没有人知道这样做的任何方式或以前这样做过？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T07:48:02.487

我假设您知道如何使用 JNI 调用函数的基础知识。这并不复杂，尽管它可能会让人头疼。

如果你想快速完成它，只需将 PNG 写入一个临时文件，通过 JNI 传递文件名并使用 ImageIO 加载它。

如果你想变得更复杂，并且避免需要文件路径，你可以在[ByteArrayInputStream上使用](https://docs.oracle.com/javase/7/docs/api/java/io/ByteArrayInputStream.html)[ImageIO.read(InputStream)](https://docs.oracle.com/javase/7/docs/api/javax/imageio/ImageIO.html#read(javax.imageio.stream.ImageInputStream)) ，它包装你通过 JNI 传入的字节数组。您可以从 C 中调用[NewByteArray()](http://java.sun.com/j2se/1.4.2/docs/guide/jni/spec/functions.html#wp17318)，然后使用[SetByteArrayRegion](http://java.sun.com/j2se/1.4.2/docs/guide/jni/spec/functions.html#wp22933)设置数据。

最后，您可能会考虑使用 HTTP 来传输数据，Apache[有一组您可以使用的组件](http://hc.apache.org/)，其中包括一个小型 Web 服务器，您可以从 C 代码 POST 到 Java。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T06:50:12.813

如果您以前从未使用过 JNI，我建议您查看[JNI Programmer's Guide and Specification](http://java.sun.com/docs/books/jni/html/titlepage.html)。

总之，你要做的是：

1.  用关键字创建一个 Java 方法`native`，没有实现。
2.  使用`javah`带有本机方法的类上的命令来生成头文件（.h）。`javah`附带JDK安装。
3.  在 C/C++ 中实现您的本机 Java 函数。
    1.  搜索类 java.awt.image.BufferedImage。
    2.  搜索您要使用的构造函数。
    3.  使用指定的构造函数创建一个 BufferedImage 对象。
    4.  搜索 setPixel 方法。
    5.  运行该方法来设置图像中的每个像素值。您需要运行它的*高度*x*宽度*次。
    6.  返回对象。
4.  将您的本机文件编译到共享库中。
5.  在您的 Java 类中加载您的共享库。
6.  运行您的 Java 类，指示链接您的共享库。

还有其他方法可以复制图像的原始数据，但我解释的这种方式就足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T11:06:43.163

由于 Java 库支持 PNG，我将添加一种机制，将所有字节从 C 复制到 Java，并按照[Chad Okere](https://stackoverflow.com/questions/842386/load-a-png-image-into-java-as-bufferedimage-through-jni-c-code/842884#842884)的建议使用 ImageIO 类。

此外，考虑使用 JNA 让生活更轻松（[例如使用 JNA 绘制 Windows 光标](https://stackoverflow.com/questions/739870/extract-cursor-image-in-java/740528#740528)）。

# c++ - 如何在指针向量之间动态转换？

> ID：842387
> 
> 赞同：4
> 
> 时间：2009-05-09T00:36:50.323
> 
> 标签：c++, stl, boost

我有：

```
class T {};

class S: public T {};

vector<T*> v;
vector<S*> w;

transform(v.begin(), v.end(), dynamic_cast_iterator<S*>(w.begin())); 
```

但是，当然，dynamic_cast_iterator 不存在。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-09T00:58:22.673

这是一种解决方案（使用[boost lambda](http://www.boost.org/doc/libs/1_39_0/doc/html/lambda.html)）：

```
#include <boost/lambda/lambda.hpp>
#include <boost/lambda/casts.hpp>
#include <algorithm>
#include <iterator>
#include <iostream>

namespace bll = boost::lambda;

struct A { virtual ~A() { } };
struct B : A { void f() { std::cout << "hello, world" << std::endl; } };

int main() {
    std::vector<A*> a; a.push_back(new B);
    std::vector<B*> b;
    std::transform(a.begin(), a.end(), std::back_inserter(b), 
                   bll::ll_dynamic_cast<B*>(bll::_1));
    b[0]->f();
    delete a[0];
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-09T01:55:30.197

您可以`dynamic_cast_iterator`使用[`boost::transform_iterator`](http://www.boost.org/doc/libs/1_38_0/libs/iterator/doc/transform_iterator.html). 它必须在对 的调用中应用于源迭代器`transform`，而不是目标迭代器。

```
#include <算法>
#include <向量>
#include <boost/iterator/transform_iterator.hpp>

//首先定义一个dynamic_casts的一元函子对象。
//(这比使用 boost::lambda 更容易，因为写的类型
//boost::lambda::ll_dynamic_cast 相当棘手。）
模板 <类型名目标>
结构体动态施法者
{
    typedef 目标结果类型；
    模板 <类型名来源>
    目标 operator()(Source s) const
    {
         返回 dynamic_cast<目标>(s);
    }
};

模板 <类型名目标，类型名迭代器>
boost::transform_iterator<dynamic_caster<Target>, Iterator>
make_dynamic_cast_iterator(迭代器)
{
    返回 boost::make_transform_iterator(it, dynamic_caster<Target>());
}

//然后像这样使用：
主函数（）
{
    标准::向量<T*> v;
    //（填充 v）

    标准::向量<S*> w;
    std::transform(make_dynamic_cast_iterator<S *>(v.begin()),
              make_dynamic_cast_iterator<S *>(v.end()),
              w.开始（））；
    //或者从v初始化一个向量
    标准::向量<S*> x(
        make_dynamic_cast_iterator<S *>(v.begin()),
        make_dynamic_cast_iterator<S *>(v.end()));

}

```

# asp.net - 将枚举值映射到 ASP.NET 中的下拉（组合框）列表

> ID：842390
> 
> 赞同：1
> 
> 时间：2009-05-09T00:38:04.440
> 
> 标签：asp.net

我有一个带有下拉 (asp:DropDownList) 控件的 ASP.NET 页面。我也有一个定义的 ENUM

```
Public Enum myEnumType As Integer
  A
  B
  C
End Enum 
```

我想用 ENUM 值之一定义每个 asp:ListItem 的“值”属性（当然，A、B、C 表示为字符串）。我还想将每个的“文本”值分配为一些不相关的字符串（例如“狗”、“猫”、“蚂蚁”）。

我想使用这种语法：

```
<asp:DropDownList ID="myCombo" runat="server">
  <asp:ListItem Text="cat" Value="<%= myEnumType.A.toString() %>" />
  <asp:ListItem Text="dog" Value="<%= myEnumType.B.toString() %>" />
  <asp:ListItem Text="ant" Value="<%= myEnumType.C.toString() %>" />
</asp:DropDownList> 
```

但是在这种类型的控件中使用 <%= 是无效的。

如何在声明性 ASP.NET 中执行此操作（而不是使用代码创建每个项目）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T01:25:41.407

代码没有多大意义。为什么在这种情况下使用 Enum？就像使用常量一样。看起来您可以摆脱硬编码值。

```
<asp:DropDownList ID="myCombo" runat="server">
  <asp:ListItem Text="cat" Value="A" />
  <asp:ListItem Text="dog" Value="B" />
  <asp:ListItem Text="ant" Value="C" />
</asp:DropDownList> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T06:56:17.133

MathewMartin 的答案似乎真的很低效。这不是更好/更清洁的方法吗？

```
string[] names = Enum.GetNames(typeof(MyFavoriteEnum));
int[] values = (int[])Enum.GetValues(typeof(MyFavoriteEnum));
for(int i =0; i<names.Length;i++){
   dropDown.Items.Add(
      new ListItem(
        names[i],
        values[i].ToString()
       )
   );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T12:19:20.860

```
foreach(var item in Enum.GetValues(typeof(MyEnum)))
{
    lbEnum.Items.Add(new ListItem(Enum.GetName(typeof(MyEnum), item), item.ToString()));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T02:31:35.367

为什么不绑定数据？

```
enum MyFavoriteEnum { A=1, B=2, C=3 }
for(int i =0; i<Enum.GetNames(typeof(MyFavoriteEnum)).Length;i++)
{
   ListItem li = new ListItem(
       Enum.GetNames(typeof(MyFavoriteEnum))[i],
       ((int)Enum.GetValues(typeof(MyFavoriteEnum)).GetValue(i)).ToString()
       );
    dropDown.Items.Add(li);
} 
// Edited to make it actually work 
```

# jquery - Jquery $.ajax() json 调用 *.js 文件导致浏览器询问“保存/打开”

> ID：842399
> 
> 赞同：0
> 
> 时间：2009-05-09T00:44:30.960
> 
> 标签：jquery, ajax, json, browser, callback

当我使用 {...'dataType' : 'script'...} 时，我可以向具有 '.js' 扩展名的 url 发出 $.ajax() 请求。但是，当我使用 {...'dataType' : 'json'...} 时，浏览器（到目前为止，Opera 和 FF，但我敢打赌它是通用的）要求保存/打开请求的结果。

请注意，我的“成功”回调运行良好，并且可以正常使用生成的 json 对象。

我的问题是，我是否应该从资源中删除 *.js 扩展名并传递一个 'json=true' 选项？或者有没有一种方便的方法来阻止浏览器尝试呈现/保存/打开结果？（我说的方便，当然，不是每个用户都必须在浏览器中设置的东西。）

另请注意，我使用的是 Rails，因此标题顺序路由问题使我无法使用 Accept 标题来解决此问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T00:52:21.783

我在这里可能错了，但我怀疑您忘记从事件处理程序中返回 false 。因此，您的请求正在传播到默认处理程序。或者正如 nickf 指出的那样，一个导致脚本失败的错误。尝试将代码包装在 try catch 中，看看是否有任何错误：

```
try {
   // your code
} catch(e) {
   alert(e);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T06:46:32.807

哦。这是一场骚乱。显然，重要的是**不要注释掉“return false;”语句。在事件处理程序的末尾。**

我一定是在注释掉处理程序末尾附近的一些其他代码时无意中这样做的。

请继续关注未来更多 1337 h4x0r 建议！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T00:48:11.310

那么，JSON 文件的“正确”文件扩展名是`.json`，而不是`.js`. 你试过吗？

# command-line - `xargs -t` 是输出stderr 还是stdout，你能控制吗？

> ID：842401
> 
> 赞同：1
> 
> 时间：2009-05-09T00:44:51.990
> 
> 标签：command-line, xargs

假设我有一个包含 hi.txt 和 blah.txt 的目录，我在 linux-ish 命令行上执行以下命令

`ls *.* | xargs -t -i{} echo {}`

您将看到的输出是

```
echo blah.txt
blah.txt
echo hi.txt
hi.txt 
```

我想重定向stderr输出（比如'echo blah.txt'失败......），**只留下xargs -t命令的输出**写入std out，但它看起来好像也是stderr。

`ls *.* | xargs -t -i{} echo {} 2> /dev/null`

有没有办法控制它，让它输出到标准输出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T01:28:54.147

采用：

```
ls | xargs -t -i{} echo {} 2>&1 >/dev/null 
```

将`2>&1`标准错误从`xargs`标准输出发送到当前的位置；将`>/dev/null`原始标准输出发送到`/dev/null`. 因此，最终结果是标准输出包含回显命令，并`/dev/null`包含文件名。`sed`我们可以讨论文件名中的空格以及使用脚本将“echo”放在每行的前面是否更容易（没有`-t`选项），或者您是否可以使用：

```
ls | xargs -i{} echo echo {} 
```

（测试：Solaris 10，Korn Shell ；应该可以在其他 shell 和 Unix 平台上工作。）

* * *

如果您不介意查看命令的内部工作原理，我确实设法将错误输出`xargs`与执行的命令的错误输出分开。

```
al * zzz | xargs -t 2>/tmp/xargs.stderr -i{} ksh -c "ls -dl {} 2>&1" 
```

（非标准）命令`al`每行列出一个参数：

```
for arg in "$@"; do echo "$arg"; done 
```

第一个重定向 ( `2>/tmp/xargs.stderr`) 将错误输出发送`xargs`到文件`/tmp/xargs.stderr`。执行的命令是 ' `ksh -c "ls -dl {} 2>&1"`'，它使用 Korn shell`ls -ld`在文件名上运行，任何错误输出都会转到标准输出。

中的输出`/tmp/xargs.stderr`如下所示：

```
ksh -c ls -dl x1 2>&1
ksh -c ls -dl x2 2>&1
ksh -c ls -dl xxx 2>&1
ksh -c ls -dl zzz 2>&1 
```

我使用 ' `ls -ld`' 代替`echo`来确保我正在测试错误 - 文件`x1`、`x2`和`xxx`存在，但`zzz`不存在。

标准输出上的输出如下所示：

```
-rw-r--r--   1 jleffler rd          1020 May  9 13:05 x1
-rw-r--r--   1 jleffler rd          1069 May  9 13:07 x2
-rw-r--r--   1 jleffler rd            87 May  9 20:42 xxx
zzz: No such file or directory 
```

在没有包含在“ ”中的命令的情况下运行时`ksh -c "..."`，I/O 重定向作为参数传递给命令（“ `ls -ld`”），因此它报告它找不到文件“ `2>&1`”。也就是说，`xargs`它本身并不使用 shell 来进行 I/O 重定向。

可以安排各种其他重定向，但基本问题是`xargs`没有规定将自己的错误输出与其执行的命令分开，因此很难做到。

另一个相当明显的选择是使用`xargs`编写一个 shell 脚本，然后让 shell 执行它。这是我之前展示的选项：

```
ls | xargs -i{} echo echo {} >/tmp/new.script 
```

然后，您可以使用以下命令查看命令：

```
cat /tmp/new.script 
```

您可以运行命令以丢弃错误：

```
sh /tmp/new.script 2>/dev/null 
```

而且，如果您也不想看到命令的标准输出，请附加`1>&2`到命令的末尾。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T03:16:29.580

所以我相信你想要的是标准输出

*   xargs 执行的实用程序的标准输出
*   xargs -t 生成的命令列表

您想忽略已执行实用程序生成的 stderr 流。

如果我错了，请纠正我。

首先，让我们创建一个更好的测试工具：

```
% cat myecho
#!/bin/sh
echo STDOUT $@
echo STDERR $@ 1>&2
% chmod +x myecho
% ./myecho hello world
STDOUT hello world
STDERR hello world
% ./myecho hello world >/dev/null
STDERR hello world
% ./myecho hello world 2>/dev/null
STDOUT hello world
% 
```

所以现在我们有了实际输出到 stdout 和 stderr 的东西，所以我们可以确定我们只得到了我们想要的东西。

执行此操作的切线方法不是使用 xargs，而是使用 make。回应一个命令然后执行它就是 make 所做的。那是它的包。

```
% cat Makefile
all: $(shell ls *.*)

$(shell ls): .FORCE
  ./myecho $@ 2>/dev/null

.FORCE:
% make
./myecho blah.txt 2>/dev/null
STDOUT blah.txt
./myecho hi.txt 2>/dev/null
STDOUT hi.txt
% make >/dev/null
% 
```

如果您使用 xargs，那么您需要修改 xargs 使用的实用程序，以便它抑制 stderr。然后，您可以使用`2>&1`其他人提到的技巧将 xargs -t 生成的命令列表从 stderr 移动到 stdout。

```
% cat myecho2
#!/bin/sh
./myecho $@ 2>/dev/null
% chmod +x myecho2
% ./myecho2 hello world
STDOUT hello world
% ls *.* | xargs -t -i{} ./myecho2 {} 2>&1
./myecho blah.txt 2>/dev/null
STDOUT blah.txt
./myecho hi.txt 2>/dev/null
STDOUT hi.txt
% ls *.* | xargs -t -i{} ./myecho2 {} 2>&1 | tee >/dev/null
% 
```

因此，这种方法有效，并将您想要标准输出的所有内容折叠起来（省略您不想要的内容）。

如果您发现自己经常这样做，您可以编写一个通用实用程序来抑制 stderr：

```
% cat surpress_stderr
#!/bin/sh
$@ 2>/dev/null
% ./surpress_stderr ./myecho hello world
STDOUT hello world
% ls *.* | xargs -t -i{} ./surpress_stderr ./myecho {} 2>&1
./surpress_stderr ./myecho blah.txt 2>/dev/null
STDOUT blah.txt
./surpress_stderr ./myecho hi.txt 2>/dev/null
STDOUT hi.txt
% 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T01:05:54.887

看起来 xargs -t 进入了标准错误，您对此无能为力。

你可以这样做：

`ls | xargs -t -i{} echo "Foo: {}" >stderr.txt | tee stderr.txt`

在命令运行时仅在终端上显示 stderr 数据，然后通过 grep 通过 stderr.txt 查看是否发生任何意外情况，如下所示`grep -v Foo: stderr.txt`

另请注意，在 Unix 上，`ls *.*`并不是显示所有内容的方式。如果您想查看所有文件，请`ls`自行运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T01:06:45.510

`xargs -t`在执行命令之前将要执行的命令回显到 stderr。如果您希望它们改为回显到 stderr，则可以使用以下构造将 stderr 传递到 stdout `2>&1`：

```
ls *.* | xargs -t -i{} echo {} 2>&1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-10T19:39:14.340

据我了解，您使用 GNU Parallel [http://www.gnu.org/software/parallel/](http://www.gnu.org/software/parallel/)会做正确的事情：

```
ls *.* | parallel -v echo {} 2> /dev/null 
```

# c++ - 如何在恒定空间中对单链表进行排序？

> ID：842407
> 
> 赞同：1
> 
> 时间：2009-05-09T00:47:48.160
> 
> 标签：c++, sorting, linked-list

我有一个单链表，由于内存限制，我需要在恒定空间中对其进行排序（换句话说，不应使用与列表中项目数成正比的额外空间）。

链表的结构是：

*   `head.item`=您要排序的有效负载；和
*   `head.next`= 下一项。

在我建立另一个列表的地方，我需要在原地完成对恒定空间折扣解决方案的要求。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-09T01:11:21.020

在常量空间中对链表进行排序很容易，您只需调整指针即可。最简单的方法是使用只交换相邻元素的排序算法。我将提供冒泡排序，只是因为您对效率没有要求：

```
# Enter loop only if there are elements in list.

swapped = (head <> null)
while swapped:
    # Only continue loop if a swap is made.

    swapped = false

    # Maintain pointers.

    curr = head
    next = curr.next
    prev = null

    # Cannot swap last element with its next.

    while next <> null:
        # Swap if items in wrong order.

        if curr.item > next.item:
            # Notify loop to do one more pass.

            swapped = true

            # Swap elements (swapping head is special case).

            if curr == head:
                head = next
                temp = next.next
                next.next = curr
                curr.next = temp
                curr = head
            else:
                prev.next = curr.next
                curr.next = next.next
                next.next = curr
                curr = next
            endif
        endif

        # Move to next element.

        prev = curr
        curr = curr.next
        next = curr.next
    endwhile
endwhile 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T00:55:31.260

几种方法：

*   在列表上使用冒泡排序，如果列表很小，这应该足够快
*   将列表复制到数组并使用堆排序或快速排序，然后将其复制回来
*   在列表中使用 bogosort。最好的案例复杂度是`O(n)`它应该非常快*

**请注意，预期的运行时复杂度是`O(n*n!)`*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-05T21:31:32.880

对于链表的就地排序，我建议合并排序。它是稳定的，并且在 NlgN 时间内运行。

# c# - 可以从 Silverlight 访问 Windows 7 传感器和位置平台吗？

> ID：842411
> 
> 赞同：1
> 
> 时间：2009-05-09T00:49:03.383
> 
> 标签：c#, windows, silverlight, sensors

是否可以从 Silverlight 访问 Windows 7 传感器和位置平台？特别是我想知道位置数据（GPS）和环境光传感器。

编辑：我假设这样做的方法是在代码隐藏文件中使用 C#。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T00:53:30.257

不，Silverlight 应该是跨平台的，Win7 中的 Sensor 和 Location 东西在 Win7 以外的任何地方都不可用。您可以尝试一些 Silverlight + .NET 的复杂组合，但是当整个 .NET/WPF 平台可用时使用 Silverlight 将是愚蠢的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T01:06:13.027

Silverlight 安全模型在这里解释（有点）[http://blogs.msdn.com/shawnfa/archive/2007/05/09/the-silverlight-security-model.aspx](http://blogs.msdn.com/shawnfa/archive/2007/05/09/the-silverlight-security-model.aspx)

Win7 Sensor API 是本机 API，来自 .NET 需要 P/Invoke 调用，这在 silverlight 上下文中被称为关键代码（IMO 命名非常糟糕，但你有它）并且需要位于中间层，所以它应该是可行的，但不会是便携的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-22T03:47:47.977

借助 Silverlight 4 中的新功能，特别是在浏览器和 com-inter-op 之外，这绝对是可能的。

我仍然不知道 Silverlight 3。

# wcf - 如何使用 SSL 保护启用 Silverlight 的 WCF Web 服务？

> ID：842415
> 
> 赞同：7
> 
> 时间：2009-05-09T00:50:20.510
> 
> 标签：wcf, silverlight

如何使用 SSL 保护启用 Silverlight 的 WCF Web 服务？我尝试将其设置为类似于受 SSL 保护的常规 WCF 服务，但它似乎不起作用。您在*Web.Config*中设置了什么，在 Silverlight 的*ServiceReferences.ClientConfig*中设置了什么？

我注意到在 Silverlight 客户端应用程序的 ServiceReferences.ClientConfig 文件中，“Binding”标签只允许 basicHttpBinding 而不允许 wsHttpBinding。这是否意味着您无法保护启用 Silverlight 的 WCF 服务？如果是这样，有更好的方法来保护它吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-11T22:03:11.533

我配置了三个关键位置以在我自己的应用程序中使用 https。

**网页配置**

在行为标签中包括这一行：

```
<serviceMetadata httpsGetEnabled="true"/> 
```

对于 MEX 端点，请确保使用 https 协议：

```
<endpoint address="mex" binding="mexHttpsBinding"
          contract="IMetadataExchange" /> 
```

创建自定义绑定。重要的部分是运输安全：

```
 <basicHttpBinding>
    <binding name="myServicesBinding">
      <security mode="Transport"/>
    </binding>
  </basicHttpBinding> 
```

您还可以包括通常的授权内容：

```
<authorization>
  <allow users="?"/>
  <deny users="*"/>
</authorization> 
```

**银光**

在 Silverlight 端，将 ServiceReference 指向现在安全的服务，或者在代码中手动设置连接。ServiceReferences.ClientConfig 文件中应该包含安全内容：

```
<security mode="Transport"/> 
```

代码版本如下所示：

```
BasicHttpBinding b = new BasicHttpBinding(BasicHttpSecurityMode.Transport); 
```

可能还有更复杂的事情可以做，但这对大多数人来说应该已经足够好了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-09-25T19:51:52.957

To create Silverlight-Enabled WCF Web Service using SSL you have to do the following steps:

1.  Create standard Silverlight-Enabled WCF Web Service using Visual Studio 2010
2.  Change 3 places of webconfig.xml:

    a. In serviceMetadata change httpGetEnabled to httpsGetEnabled like this:

    ```
    <behaviors >
      <serviceBehaviors > 
        <behavior name="" > 
          <serviceMetadata httpsGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
      </serviceBehaviors>
    </behaviors> 
    ```

    b. In binding change httpTransport to httpsTransport:

    ```
    <bindings>
      <customBinding>
        <binding name="Project.Web.YourService.customBinding0">
          <binaryMessageEncoding/>
          <httpsTransport/>
        </binding>
      </customBinding>
    </bindings> 
    ```

    c. in endpoint change binding="mexHttpBinding" to binding="mexHttpsBinding":

    ```
    <service name="Project.Web.YourService.YourService">
      <endpoint address="" binding="customBinding" bindingConfiguration="Project.Web.YourService.customBinding0"
      contract="Project.Web.YourService.YourService" />
      <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
    </service> 
    ```

3.  Don't use ServiceReferences.ClientConfig. Create everything in code behind - it's easy to deploy on server:

    ```
    CustomBinding binding = new CustomBinding(new BinaryMessageEncodingBindingElement(), new HttpsTransportBindingElement());         
    YourServiceReference.YourServiceClient service = new YourServiceReference.YourServiceClient (binding, new EndpointAddress(new Uri( "https:yourhostname/YourService.svc").AbsoluteUri));        
    service.YourMethodCompleted += new EventHandler<YourServiceReference.YourMethodCompleted EventArgs>(service_YourMethodCompleted );
    service.YourMethodAsync(); 
    ```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-09T08:23:23.103

> 在 Silverlight 客户端应用程序的 ServiceReferences.ClientConfig 文件中，“Binding”标签仅允许 basicHttpBinding 而不允许 wsHttpBinding。这是否意味着您无法保护启用 Silverlight 的 WCF 服务？

不，不是那个意思。您可以拥有`basicHttpBinding`并且仍然为其分配传输级安全性（HTTPS 和 SSL）。那应该不是问题。

马克

PS：其中许多链接为您提供了更多洞察力和众所周知的“啊哈！” :-)

*   [http://winterdom.com/2007/11/basichttpbindingwithtransportsecurity](http://winterdom.com/2007/11/basichttpbindingwithtransportsecurity)
*   [http://silverlight.net/forums/p/13275/44170.aspx](http://silverlight.net/forums/p/13275/44170.aspx)
*   [http://kevindockx.blogspot.com/2009/02/username-authentication-with.html](http://kevindockx.blogspot.com/2009/02/username-authentication-with.html)
*   [http://www.pixel73.com/blog/Default.aspx?g=posts&t=4173](http://www.pixel73.com/blog/Default.aspx?g=posts&t=4173)
*   [http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2008/03/19/WCF-Integration-in-Silverlight-2-Beta-1.aspx](http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2008/03/19/WCF-Integration-in-Silverlight-2-Beta-1.aspx)
*   [http://geekswithblogs.net/scottthompson/archive/2009/03/25/setting-up-ssl-between-silverlight-and-wcf-under-iis7.aspx](http://geekswithblogs.net/scottthompson/archive/2009/03/25/setting-up-ssl-between-silverlight-and-wcf-under-iis7.aspx)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-05-09T00:59:03.843

Silverlight 不支持 WS* - 基本上将客户端配置中的 URL 更改为 https:// url - 这就是你所能做的

# c - 子串提取练习

> ID：842418
> 
> 赞同：2
> 
> 时间：2009-05-09T00:53:00.050
> 
> 标签：c, algorithm

给定 2 个字符串，编写一个函数，如果字符串 A 是字符串 B 的子字符串，则返回与字符串 A 匹配的字符串 B 的位置。否则返回 -1。例子：

```
strA = "ello"
strB = "Hello_World"
Your function should return 1.

strA = "blah"
strB = "blha"
Your function should return -1. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T01:00:46.380

这是作业吗？无论如何，查看[string.h 文档](http://www.cplusplus.com/reference/clibrary/cstring/)，您应该可以轻松找到所需的内容。您将需要在其中一个函数上编写一个非常薄的包装器。或者，当然，你可以自己写。

编辑：好吧，其他人给出了答案，所以这是我的尝试。

```
#include <string.h>

ssize_t str_index(const char *strA, const char *strB)
{
    const char *result;
    return (result = strstr(strB, strA)) ? (result - strB) : -1;  
} 
```

唯一的技巧是参数顺序与 strstr 相反，您返回的是 ssize_t 而不是 char *，因此失败代码为 -1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T01:00:51.357

蛮力版：

```
int strpos(char* a, char* b) {
  int n1, n2, i, j;
  n1 = strlen(a);
  n2 = strlen(b);
  for (i = 0; i < n1-n2; i++) {
    for (j = 0; j < n2; j++) {
      if (a[i+j] != b[j]) break;
      else if (j+1 == n2) return i;
    }
  }
  return -1;
} 
```

更有效的算法：[维基百科：字符串搜索](http://en.wikipedia.org/wiki/String_searching)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T01:05:17.227

```
#include <string.h>

int search(char* a, char* b) {
    char* pos;
    pos = strstr(b, a);
    if(pos == 0) return -1;
    return (int)(pos-b);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T01:03:13.940

这听起来几乎完全像一个家庭作业问题。在这不是作业问题的奇怪情况下，C 库函数 strstr 返回一个指针，该指针指向另一个字符串中第一次出现的字符串（如果不存在，则返回 null）。从那里，使用指针算法确定索引是微不足道的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-11T05:11:06.640

尝试学习 strstr。它在 string.h 中可用**从来没有**理由对标准库中已有的东西进行编码。除非当然，这是一个家庭作业问题:)

# google-app-engine - Google App Engine 大文件上传

> ID：842426
> 
> 赞同：15
> 
> 时间：2009-05-09T00:58:01.113
> 
> 标签：google-app-engine, gwt, upload

我正在尝试将数据上传到 Google App Engine（使用 GWT）。我正在使用 FileUploader 小部件，servlet 使用 InputStream 读取数据并直接插入数据存储区。在本地运行它，我可以成功上传大文件，但是当我将它部署到 GAE 时，我受到 30 秒请求时间的限制。有没有办法解决？或者有什么方法可以将文件拆分成更小的块并发送更小的块？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-09-12T05:37:19.433

通过使用[BlobStore](http://code.google.com/appengine/docs/python/blobstore/overview.html)，你有一个[1 GB 的大小限制](http://code.google.com/appengine/docs/python/blobstore/overview.html#Quotas_and_Limits)和一个[特殊的处理程序，不出所料地称为 BlobstoreUpload 处理程序，](http://code.google.com/appengine/docs/python/tools/webapp/blobstorehandlers.html#BlobstoreUploadHandler)它不应该给你上传超时问题。

另请查看[http://demofileuploadgae.appspot.com/](http://demofileuploadgae.appspot.com/)（[源代码](http://code.google.com/p/gwt-examples/source/browse/trunk/DemoUpload/src/org/gonevertical/upload/#upload/server%3Fstate%3Dclosed)，[源答案](https://stackoverflow.com/questions/3409375/uploading-a-video-to-google-app-engine-blobstore/3652940#3652940)），它完全符合您的要求。

[另外，请查看[GWT-Examples](http://code.google.com/p/gwt-examples/)的其余部分。]

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-10T14:46:58.213

目前，GAE 对文件上传（和响应大小）施加了 10 MB 的限制，并对许多其他内容施加了 1 MB 的限制；因此，即使您的网络连接速度足够快，可以在 30 秒的窗口内增加 10 MB 以上的数据，那也无济于事。谷歌已经说过（我昨天在 Pycon Italia Tre 上听到 Guido van Rossum 提到过）它计划在未来克服这些限制（至少对于按使用付费超过配额的 GAE 用户来说）计划扩展到不付费的 GAE 用户，通常需要接受较小的配额才能免费使用 GAE）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T14:20:36.730

您需要上传到另一台服务器 - 我相信 30 秒超时无法解决。如果有办法，请指正！我很想知道怎么做！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-09T16:59:10.057

如果您的请求已用完请求时间，则您无能为力。也许您的文件太大了，您需要在客户端上对它们进行分块（使用 Flash 或 Java 之类的东西或[pupload 之](http://www.plupload.com/)类的上传框架）。

将文件获取到应用程序后，还有另一个问题 - 数据存储限制。在这里，您有两个选择：

*   您可以使用[BlobStore](http://code.google.com/appengine/docs/java/blobstore/overview.html)服务，该服务具有非常好的 API 来处理 50 兆字节的大型上传

*   您可以使用[bigblobae 之](http://github.com/honzasterba/bigblobae)类的东西，它可以在常规 appengine 数据存储中存储几乎无限大小的 blob。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-12T11:21:15.603

30 秒响应时间限制仅适用于代码执行。因此，将实际文件作为请求正文的一部分上传不包括在内。只有当客户端将请求完全发送到服务器并且您的代码开始处理提交的请求时，计时器才会启动。因此，您的客户端连接速度有多慢并不重要。

[使用 Datastore 在 Google App Engine 上上传文件和 30 秒响应时间限制](https://stackoverflow.com/questions/2340128/uploading-file-on-google-app-engine-using-datastore-and-30-sec-response-time-lim)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-26T11:39:22.030

我同意将数据分块到较小的 Blob 并有两个表，一个包含元数据（文件名、大小、下载次数等），另一个包含块，这些块通过外键与元数据表相关联，我认为这是可行的...

或者，当您上传所有块时，您可以简单地将它们放在一个具有一张表的 blob 中。

但问题是，您将需要一个胖客户端来提供分块数据，例如 Java Applet，它需要由您的客户端签名和信任，以便它可以访问本地文件系统

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-24T21:07:36.447

最接近的方法是在将其存储在 GAE 中时将其拆分为多个块，然后在下载时通过发出单独的 AJAX 请求将其拼凑在一起。

# language-agnostic - 我充电够吗？我想我可能把自己置于一个奇怪的境地

> ID：842431
> 
> 赞同：7
> 
> 时间：2009-05-09T00:59:19.350
> 
> 标签：language-agnostic

这是我粗略数字的情况。我想知道我的想法（在底部）对你们来说是否合理。（旁注：我在这里阅读了许多相关问题，尽管它们很有帮助，但似乎没有一个涉及这个特定问题。）

两年来，我在 X 公司担任高级开发人员。我是全职的，W-2，每年赚 10 万美元。（大约 50 美元/小时）。

[然后我被解雇了，但这不是重点。我在一个大城市，很容易找到工作。我很高兴在家而不是在办公室工作。]

两个月来，我为网络公司 Y 公司做了一些自由职业项目。这是 1099，我每小时收费 80 美元。（我在 2 个月左右的时间里做了 100 个小时左右，并认为我需要尽快获得其他客户）。

Y 公司热爱我的工作，并因此获得了新工作。他们想要更多我的时间，并为我提供了一份为期 6 个月的合同，无论时间长短，都按固定月费支付（他们假设每周 40 左右）。我仍然在远程工作。

所以...

由于显而易见的原因，我的自由职业者率高于我以前的 W-2 全职率。我也意识到，由于自由职业者“全职”需要大量的管理和销售，我永远不会真正以 80 美元的价格每周工作 40 小时。（我一直在考虑向其他客户收取更多费用，比如每小时 100 美元。）

但是，我意识到，从 Y 公司的角度来看，为我提供 6 个月的聘用合同的安全性应该会降低我的小时费率（批量折扣？），因为我现在有更多的计费时间和更少的管理。不过，这仍然必须是对我以前的 W-2 工作的加薪，因为它值得我花时间，特别是由于缺乏福利和更复杂的税收情况。

现在我希望我最初为最初的自由职业项目向 Y 公司收取 100 美元/小时，这样我就可以给他们一个更好的交易，并为这份为期 6 个月的合同向他们收取 80 美元/小时。

对不起，啰嗦了这么多，但我希望你们能明白我的意思。从本质上讲，我应该给他们一个较低的小时数，但我真的不想这样做。

我的假设是否正确，就小时费率而言，

**全职-W-2 < 长期 1099 < 短期-基于项目的 1099** ?

如果是这样，与 Y 公司保持我的小时费率不变并有效地取消他们的批量折扣的良好谈判策略可能是什么？“你在那些单独的项目上得到了超低的利率！”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T02:28:09.090

> Y 公司热爱我的工作，并因此获得了新工作。他们想要更多我的时间，并为我提供了一份为期 6 个月的合同，无论时间长短，都按固定月费支付（他们假设每周 40 左右）。我仍然在远程工作。

你确定吗？每当我被要求按“固定月费”工作时，这都是试图获得大量“免费”时间（实际上是大幅降息）的一种不太微妙的方式。

我不知道任何可以在 40 小时后退出的咨询项目，特别是如果客户得到“推动”，他们需要尽早而不是稍后需要东西......紧迫性始终是他们的，并且经常制造而不是“真正的” ”。

所以，如果他们想要你并且想要折扣，那么在 6 个月内给他们每小时 70 美元的每小时合同。这样他们就可以获得折扣，并且您可以免受加班和任何可能出现的紧急情况的影响。

其他任何事情，你都会被冲洗掉。几乎可以保证。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-09T01:15:06.410

我不是来自美国，所以 W-2 和 1099 部分超出了我的范围，但我会解决其余的问题，因为这些问题非常普遍。

一般来说，经验法则是，如果你每年赚 10 万美元，你应该收取 100 美元/小时或非常接近的费用。这是为了涵盖部分或全部：

*   没有事假/病假；
*   无带薪年假；
*   没有奖金；
*   没有培训；
*   保险（健康、公共责任、职业赔偿等）；
*   如果您每周的工作时间不固定，则收入会有所不同；
*   雇主可以比全职员工更容易摆脱你。

现在这是我在澳大利亚和欧洲的经历，那里实际上有相当重要的公共医疗保健。我可能会想象，由于您不在美国，因此健康保险费用可能会更高，因此您可能应该要求每小时 120 美元以上。

**注意：**如果您不支付专业赔偿保险之类的费用，或者您没有某种法律保护（例如通过有限责任公司经营），那么您就是在玩火，我**强烈**建议您寻求专业建议一种结构和/或获得相关保险，以充分保护您、您的资产和您的家人（如果您有的话）。

当然，您必须根据当前的市场条件来平衡这一切，这并不是那么好（但因地区而异）。

我喜欢按小时计费的方案，因为它“公平”。我的意思是，如果你每周工作 80 小时来得到一些东西，那么你就会得到报酬。您只需为您所做的事情获得报酬，仅此而已。这很简单。

现在雇主通常不喜欢它，因为他们不一定能预测（并因此预算）成本。

下一步是按日收费。我通常会尝试抵制这种情况，但在某些情况下我会这样做。如果是这样，您需要准确定义一天是什么。

*   如果你工作，你能得到半天的报酬吗？一整天？
*   您是否需要工作一定小时数才能获得当天的报酬？
*   无论您一天工作多少小时，您是否只获得一整天的报酬？
*   您可以每周获得超过 5 天的报酬吗？

一般来说，对于这种情况，我会根据每天 8 小时的工作时间将我的小时费率乘以 9。您承担了一些风险，因此您需要为此获得报酬。

除此之外，您可以每周一次，然后每月一次。他们也有必须定义什么是一周或一个月的问题。每月平均有 20 或 21 个工作日，因此将您的每日费率乘以 21-25 以获得月费率。

至于谈判策略，几乎可以使用上面列出的要点。如果每小时 120 美元听起来很多（对他们来说），请指出所涉及的所有成本，这也是他们节省的成本。使用您已证明的往绩为您的优势，因为我可以向您保证，没有什么比不称职的软件开发对公司更具有灾难性的了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-09T01:16:47.840

你可以告诉他们合同最多只限 40 小时/周，如果他们需要你超过这个时间，那么它将按照你的新费率 100 美元/小时，如果你给他们折扣，这可能不是问题在前 40 小时。

然后将其记为经验教训，并为任何新客户更改您的费率。:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-09T01:05:10.787

6 个月，每周 40 小时 = 几乎 1000 小时，因此，对于您从每小时费率中减少的每一美元，您将给它们打折 1000 美元，因此 IMO 每小时减少 5-6 美元应该足够重要。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-09T01:19:22.700

这个“折扣”已经进入讨论了吗？如果没有，最简单的解决方案就是继续隐含假设付款没有变化——记住，“折扣”是一种慷慨，而不是强制性的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-09T01:19:52.873

我不是专家，但我会向 Y 公司解释，原来的价格是折扣。如果你能说服他们你一直在收取最低限度的费用，而不是试图从他们身上榨取更多的钱，我认为他们会认为这是积极的。

如果你完全冷静地把你的费率降低了很大一部分，我认为在他们的脑海里，他们会认为你一开始就是在玩弄他们。

打个比方，假设你去停车场。推销员最初报价 30,000 美元。你带着 20,000 美元回来。他毫不犹豫地接受了。实际上，您最终可能会得到一笔不错的交易，但无论如何，推销员都会被认为是阴暗的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-09T01:07:19.627

> 他们想要更多我的时间，并为我提供了一份为期 6 个月的合同，无论时间长短，都按固定月费支付（他们假设每周 40 左右）。我仍然在远程工作。

我的论点是：

我可能最终每周工作超过 40 小时。如果您更喜欢 6 个月的保证合同，按小时支付而不是按固定费率支付，我们可以重新协商。

但是，我还要说 6 个月的合同不一定是“长期” - 更多的是“中期”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-10T13:56:10.970

所以1：你不想降低你的利率，2：他们想要一个固定利率。

对他们来说，固定部分可能比下部更重要。所以打电话给他们，先和他们谈谈，看看这是不是真的。如果它是关于被修复，或者关于更便宜。其次，向他们解释你不能降低你的利率。对此有很多论据。祝你好运！

# subsonic - 如何使用 SubSonic 构建动态查询

> ID：842450
> 
> 赞同：0
> 
> 时间：2009-05-09T01:08:55.613
> 
> 标签：subsonic

我需要根据不同的条件构建（并运行）一个查询。当我构建要运行的文字 SQL 时，这意味着连接字符串以动态构建 SQL。

我将如何使用 SubSonic？例如，如果我需要在某些情况下添加 WHERE 子句，在其他情况下添加 ORDER BY。构建和运行此查询的代码看起来如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T04:40:13.093

这是 v2.1+ 和 BaseClass 设置为 RepositoryRecord 的示例：

```
var q = DB.Select().From<Product>();

if (someCondition) 
    q.Where(Product.ProductIdColumn).IsEqualTo(1);

if (order == "ASC")
    q.OrderAsc(Product.Columns.ProductId)
else
    q.OrderDesc(Product.Columns.ProductId)

var results = q.ExecuteAsCollection<ProductCollection>(); 
```

# windows-vista - Microsoft Access 2007 accdr 扩展 Vista 64 位操作系统

> ID：842452
> 
> 赞同：0
> 
> 时间：2009-05-09T01:10:01.710
> 
> 标签：windows-vista, 64-bit, runtime, ms-access-2007

有没有人在 Windows Vista 64 位版本上测试过 Microsoft Access 2007 .accdr 应用程序？我销售一个使用 Access 2007 运行时的共享软件程序，对于使用该设置的一个客户来说，存在某种问题。根据用户“。当我尝试执行程序时，它会打开 IE，然后打开对话框以打开、保存或取消“myprogram.accdr”文件。如果我选​​择运行，它就会消失然后返回回到同一个问题”

听起来这以某种方式映射到了 IE。在我的 Windows XP 系统上，它启动 Access 并运行该程序。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T08:22:04.823

64 位不支持 MS Access，因为它需要一个不可用的 64 位 JET 引擎，微软只发布了一个 32 位 JET 引擎。因此，您的应用程序必须在 WOW 上运行，因此它以 32 位运行，因此能够使用 32 位喷气发动机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-22T02:37:51.567

它工作得很好。使用访问安装程序打包器拉毛 3 周后。我明白了它的工作。您的引用必须添加到打包程序中，否则您将收到运行时错误。数十亿.. 不是真正的 4 或 5\. 然后它不会识别内置函数，如日期、时间、已加载....等。

所以是的，它会起作用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-09T01:22:04.503

客户是否使用 64 位 IE？Access 2007 只有 32 位。32 位 IE 可能会正常工作。

# development-environment - 如何设置多开发者 Biztalk 环境？

> ID：842460
> 
> 赞同：5
> 
> 时间：2009-05-09T01:22:35.237
> 
> 标签：development-environment, biztalk

如果我们有 3 个开发人员在同一个 Biztalk 项目上工作，那么设置我们的开发环境的最佳方式是什么？

我们正在使用 TFS 来存储 Biztalk 项目。

我们是否应该使用 1 台 sql server 和 1 台 Biztalk 服务器，然后让 1 台或更多台开发人员机器访问 sql 和 biztalk 服务器？我们遇到的问题是，当 1 个开发人员编译和部署他们的更改时，如果他们也尝试编译和部署他们的工作，它可能会影响其他开发人员。

我们应该让每个开发人员在他们的机器上还是在他们自己的虚拟机中托管他们自己完整的 sql 和 biztalk 服务器以进行本地开发？我们发现的问题是每个开发人员都可以修改他们的服务器设置，而这些设置没有存储在源代码管理中。当将更改部署到测试服务器时，这可能会导致混乱。另一个较小的问题是每个开发人员都需要安装 sql server、biztalk server 和 windows server。

是否有另一种方法来设置多开发者 biztalk 开发环境？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-09T16:12:03.260

您*总是*希望每个开发人员在他们自己的机器上都安装完整的 BizTalk。相信我，否则它是行不通的，因为在尝试部署/测试/调试更改时，你们只会不断地互相交流。

也就是说，您还需要一个集中的开发/测试环境，您可以在其中部署代码以进行更完整的集成测试，并确保所有人的所有更改都可以一起看到。

您关于配置的观点是正确的，但仅在一定程度上。这是因为您应该将解决方案配置*作为*源代码的一部分并将其保存在源代码管理中。一旦您在开发中领先一点，这一点尤其重要，因为您需要开始为每个环境（开发、测试、生产等）维护多个版本的绑定文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T20:32:58.427

tomasr 是对的。此外，如果您有不错的硬件和大量 RAM，您可能需要设置完整开发人员环境的 VM 映像，然后将其分享给您的所有团队。不如本地硬件快，但确实允许您回滚更改，如果您真的搞砸了，更换您的虚拟机，然后每个人都拥有相同的环境 - 理想情况下接近目标环境。设置一个连续构建服务器也是最重要的，如果你的项目很小，你可以让每个签入来导致一个完整的构建、BizTalk 部署、MSI 的导出然后运行测试。稍后，随着您的解决方案越来越多，您可能不得不转向仅持续构建 C# 更改，然后说每晚或一天几次，您会做一个完整的。我们已经使用 CruiseControl.net、Nant、nunit 和各种 power shell 脚本完成了这项工作，这非常耗时，

# version-control - 是否可以在 TFS 源代码控制中进行仅服务器重命名？

> ID：842461
> 
> 赞同：0
> 
> 时间：2009-05-09T01:22:36.330
> 
> 标签：version-control, tfs

最近，我和我的团队一直在努力将我们继承的源代码变成我们可以接受的东西。此过程的一部分是使源代码管理图像看起来更像大多数人在浏览存储库时可能期望找到的图像。

原始结构包含一个名为“Branches”的分支，其内容是可以在 Subversion 等系统的“Tags”文件夹中找到的内容。由于“分支”对我的口味来说有点过于非特定，我想将其更改为“标签”——但似乎我不能这样做，除非我创建一个映射到存储库根目录的工作区然后创建它的工作副本。在这个项目上，这是一个**巨大**的文件传输（很多旧标签）。

请告诉我，我刚刚忽略了显而易见的事情，应该花更多时间阅读说明。如果不先将所有内容拉到客户端，就没有简单的方法吗？我真的很喜欢 TFS 的大部分方面，但在 Subversion 中这需要 15 秒或更短的时间——所以我希望我只是遗漏了一些东西。

在此先感谢任何响应者。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T04:30:05.133

您不需要获取整个文件夹，但需要获取文件夹本身。您不能从 IDE 中执行此操作，但可以从命令行执行此操作：

```
tf get c:\dev\ 
```

因为我们没有指定 /recursive 选项，所以它只会获取 c:\dev\ 的直接子级，这将是诸如树干和分支之类的文件夹。

为此，您可以重命名文件夹：

```
tf rename c:\dev\branches c:\dev\tags 
```

然后签入重命名。

问候，

William D. Bartholomew（团队系统 MVP）

# c# - 从流式阅读器读取一行而不消耗？

> ID：842465
> 
> 赞同：27
> 
> 时间：2009-05-09T01:23:51.787
> 
> 标签：c#, readline, streamreader, gedcom

有没有办法提前读一行来测试下一行是否包含特定的标签数据？

我正在处理一种有开始标签但没有结束标签的格式。

我想阅读一行将其添加到结构中，然后测试下面的行以确保它不是新的“节点”，如果它关闭该结构并创建一个新的，则如果它没有继续添加

我能想到的唯一解决方案是让两个流阅读器同时进行锁定步骤，​​但这似乎很浪费（如果它甚至可以工作的话）

我需要像 peek 但 peekline 这样的东西

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-09T02:43:54.730

问题是底层流甚至可能不可搜索。如果您查看流读取器实现，它使用缓冲区，因此即使流不可搜索，它也可以实现 TextReader.Peek() 。

您可以编写一个简单的适配器来读取下一行并在内部对其进行缓冲，如下所示：

```
 public class PeekableStreamReaderAdapter
    {
        private StreamReader Underlying;
        private Queue<string> BufferedLines;

        public PeekableStreamReaderAdapter(StreamReader underlying)
        {
            Underlying = underlying;
            BufferedLines = new Queue<string>();
        }

        public string PeekLine()
        {
            string line = Underlying.ReadLine();
            if (line == null)
                return null;
            BufferedLines.Enqueue(line);
            return line;
        }

        public string ReadLine()
        {
            if (BufferedLines.Count > 0)
                return BufferedLines.Dequeue();
            return Underlying.ReadLine();
        }
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-09T02:31:25.180

您可以存储访问 StreamReader.BaseStream.Position 的位置，然后读取下一行，进行测试，然后在读取该行之前找到该位置：

```
 // Peek at the next line
            long peekPos = reader.BaseStream.Position;
            string line = reader.ReadLine();

            if (line.StartsWith("<tag start>"))
            {
                // This is a new tag, so we reset the position
                reader.BaseStream.Seek(pos);    

            }
            else
            {
                // This is part of the same node.
            } 
```

这是很多寻找和重新阅读相同的行。使用一些逻辑，您可以完全避免这种情况 - 例如，当您看到一个新标签开始时，关闭现有结构并开始一个新结构 - 这是一个基本算法：

```
 SomeStructure myStructure = null;
        while (!reader.EndOfStream)
        {
            string currentLine = reader.ReadLine();
            if (currentLine.StartsWith("<tag start>"))
            {
                // Close out existing structure.
                if (myStructure != null)
                {
                    // Close out the existing structure.
                }

                // Create a new structure and add this line.
                myStructure = new Structure();                   
                // Append to myStructure.
            }
            else
            {
                // Add to the existing structure.
                if (myStructure != null)
                {
                    // Append to existing myStructure
                }
                else
                {
                    // This means the first line was not part of a structure.
                    // Either handle this case, or throw an exception.
                }
            }
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T04:01:31.737

为什么困难重重？无论如何都返回下一行。检查它是否是一个新节点，如果不是，将其添加到结构中。如果是，则创建一个新结构。

```
// Not exactly C# but close enough
Collection structs = new Collection();
Struct struct;
while ((line = readline()) != null)) {
    if (IsNode(line)) {
        if (struct != null) structs.add(struct);
        struct = new Struct();
        continue;
    }
    // Whatever processing you need to do
    struct.addLine(line);
}
structs.add(struct); // Add the last one to the collection

// Use your structures here
foreach s in structs {

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T04:51:50.070

这是我到目前为止所做的。我走的分割路线比逐行路线的流式阅读器要多。

我敢肯定，有一些地方正在变得更加优雅，但现在它似乎正在发挥作用。

请让我知道你在想什么

```
struct INDI
    {
        public string ID;
        public string Name;
        public string Sex;
        public string BirthDay;
        public bool Dead;

    }
    struct FAM
    {
        public string FamID;
        public string type;
        public string IndiID;
    }
    List<INDI> Individuals = new List<INDI>();
    List<FAM> Family = new List<FAM>();
    private void button1_Click(object sender, EventArgs e)
    {
        string path = @"C:\mostrecent.ged";
        ParseGedcom(path);
    }

    private void ParseGedcom(string path)
    {
        //Open path to GED file
        StreamReader SR = new StreamReader(path);

        //Read entire block and then plit on 0 @ for individuals and familys (no other info is needed for this instance)
        string[] Holder = SR.ReadToEnd().Replace("0 @", "\u0646").Split('\u0646');

        //For each new cell in the holder array look for Individuals and familys
        foreach (string Node in Holder)
        {

            //Sub Split the string on the returns to get a true block of info
            string[] SubNode = Node.Replace("\r\n", "\r").Split('\r');
            //If a individual is found
            if (SubNode[0].Contains("INDI"))
            {
                //Create new Structure
                INDI I = new INDI();
                //Add the ID number and remove extra formating
                I.ID = SubNode[0].Replace("@", "").Replace(" INDI", "").Trim();
                //Find the name remove extra formating for last name
                I.Name = SubNode[FindIndexinArray(SubNode, "NAME")].Replace("1 NAME", "").Replace("/", "").Trim(); 
                //Find Sex and remove extra formating
                I.Sex = SubNode[FindIndexinArray(SubNode, "SEX")].Replace("1 SEX ", "").Trim();

                //Deterine if there is a brithday -1 means no
                if (FindIndexinArray(SubNode, "1 BIRT ") != -1)
                {
                    // add birthday to Struct 
                    I.BirthDay = SubNode[FindIndexinArray(SubNode, "1 BIRT ") + 1].Replace("2 DATE ", "").Trim();
                }

                // deterimin if there is a death tag will return -1 if not found
                if (FindIndexinArray(SubNode, "1 DEAT ") != -1)
                {
                    //convert Y or N to true or false ( defaults to False so no need to change unless Y is found.
                    if (SubNode[FindIndexinArray(SubNode, "1 DEAT ")].Replace("1 DEAT ", "").Trim() == "Y")
                    {
                        //set death
                        I.Dead = true;
                    }
                }
                //add the Struct to the list for later use
                Individuals.Add(I);
            }

            // Start Family section
            else if (SubNode[0].Contains("FAM"))
            {
                //grab Fam id from node early on to keep from doing it over and over
                string FamID = SubNode[0].Replace("@ FAM", "");

                // Multiple children can exist for each family so this section had to be a bit more dynaimic

                // Look at each line of node
                foreach (string Line in SubNode)
                {
                    // If node is HUSB
                    if (Line.Contains("1 HUSB "))
                    {

                        FAM F = new FAM();
                        F.FamID = FamID;
                        F.type = "PAR";
                        F.IndiID = Line.Replace("1 HUSB ", "").Replace("@","").Trim();
                        Family.Add(F);
                    }
                        //If node for Wife
                    else if (Line.Contains("1 WIFE "))
                    {
                        FAM F = new FAM();
                        F.FamID = FamID;
                        F.type = "PAR";
                        F.IndiID = Line.Replace("1 WIFE ", "").Replace("@", "").Trim();
                        Family.Add(F);
                    }
                        //if node for multi children
                    else if (Line.Contains("1 CHIL "))
                    {
                        FAM F = new FAM();
                         F.FamID = FamID;
                        F.type = "CHIL";
                        F.IndiID = Line.Replace("1 CHIL ", "").Replace("@", "");
                        Family.Add(F);
                    }
                }
            }
        }
    }

    private int FindIndexinArray(string[] Arr, string search)
    {
        int Val = -1;
        for (int i = 0; i < Arr.Length; i++)
        {
            if (Arr[i].Contains(search))
            {
                Val = i;
            }
        }
        return Val;
    } 
```

# wcf - 如何在启用 Silverlight 的 WCF Web 服务中设置身份验证？

> ID：842470
> 
> 赞同：1
> 
> 时间：2009-05-09T01:28:51.743
> 
> 标签：wcf, silverlight

在启用 Silverlight 的 WCF Web 服务中设置用户名和密码身份验证的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-18T07:10:44.993

对我来说最好的方法是表单身份验证......使用 ASP.NET 应用程序服务。

基本上，您在处理身份验证、角色和配置文件的 WCF 服务中公开 3 个 *.svc 文件。后面没有代码，因为它内置在 .net 程序集中。您必须在 .config 中进行一些配置（请参阅链接）才能启用它们。

详细信息：http: [//blogs.msdn.com/brada/archive/2008/05/03/accessing-the-asp-net-authentication-profile-and-role-service-in-silverlight.aspx](http://blogs.msdn.com/brada/archive/2008/05/03/accessing-the-asp-net-authentication-profile-and-role-service-in-silverlight.aspx)

关于 ASPNETDB.MDF 的旁注

通常，所有用户帐户和配置文件都位于 ASPNETDB.MDF 中，该文件位于 APP_Data 文件夹中的本地文件中，但我发现这很笨拙，尤其是在权限方面，所以我将它保存在我的主 WCF 数据库中，但如果你有，你可以选择另一个连接字符串。为了初始化它，我运行了“C:\Windows\Microsoft.NET\Framework\v2.0.50727\a spnet_regsql -C *Data Source=localhost;Initial Catalog=MYDB;Persist Security Info=True;User ID=**;Password= ****；" * -A all" 将 ASP.NET 成员表和存储过程包含到我选择的数据库中。如果你这样做..确保覆盖默认的 LocalSQLServer 连接字符串，否则它不会在 web.config 中找到这样的数据库你的 asp.net 网站

<connectionStrings> <clear/> <add name="LocalSQLServer" connectionString="Data Source=localhost;Initial Catalog=MYDB;Persist Security Info=True;User ID=**;Password=****;" providerName="System.Data.SqlClient" />

实际添加用户帐户和角色

1) 从 Visual Studio 2) 单击您的 ASP.NET 网站 3) 上面应该有一个名为“网站”的菜单...选择 ASP.NET 配置，您的浏览器将从配置网站开始，该网站将编辑您的配置和使用帐户和角色更新配置的数据库

我希望这有帮助

# tdd - 当应用程序是 100% CRUD 时应用 TDD

> ID：842476
> 
> 赞同：49
> 
> 时间：2009-05-09T01:39:14.930
> 
> 标签：tdd

我经常遇到这个问题，我不知道如何克服这个障碍。我真的很想开始学习和应用测试驱动开发（或 BDD，或其他），但似乎我想要应用的每个应用程序几乎只是标准数据库 CRUD 的东西，我不确定如何去应用它。除了持久化到数据库之外，这些对象几乎什么都不做。没有需要测试的复杂逻辑。有一个网关，我最终需要测试第 3 方服务，但我想先完成应用程序的核心。

每当我尝试编写测试时，我最终只会测试我可能一开始就不应该测试的基本东西（例如 getter/setter），但看起来对象没有其他任何东西。我想我可以测试持久性，但这对我来说似乎永远不对，因为你不应该实际访问数据库，但如果你模拟它，那么你真的没有测试任何东西，因为你控制了吐回的数据；就像我看过很多例子，其中有一个模拟存储库，它通过循环和创建已知值列表来模拟数据库，并且测试验证“存储库”可以拉回某个值......我是没有看到这样的测试点，因为“存储库”当然会返回该值；它在课堂上是硬编码的！好，

我想错了吗？

例如，运行工厂联系人管理应用程序。我们有联系人，假设我们可以向联系人发送消息。因此，我们有两个实体：`Contact`和`Message`，每个都有共同的属性（例如，名字、姓氏、联系人的电子邮件，以及消息的主题和正文和日期）。如果这些对象都没有任何实际行为或需要执行任何逻辑，那么在设计这样的应用程序时如何应用 TDD？该应用程序的唯一目的基本上是拉出联系人列表并将其显示在页面上，显示表单以发送消息等。我在这里没有看到任何有用的测试——我可以想到一些测试，但它们几乎就是为了说“看，我有测试！”而进行的测试。而不是实际测试某种逻辑（虽然 Ruby on Rails 很好地利用了它，但我并不认为测试验证是一个“有用的”测试，因为它应该是框架为你处理的事情）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-09T02:08:32.193

“该应用程序的唯一目的基本上是拉一个联系人列表”

好的。测试一下。“拉”是什么意思？这听起来像“逻辑”。

“在页面上显示它们”

好的。测试一下。显示正确的？那里的一切？

" 显示发送消息的表单，"

好的。测试一下。正确的领域？输入的验证都有效吗？

“之类的。”

好的。测试一下。查询是否有效？找到正确的数据？显示正确的数据？验证输入？为无效输入生成正确的错误消息？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-09T02:26:22.120

我现在正在开发一个纯 CRUD 应用程序但是我看到了单元测试用例的很多好处（注意——我没有说 TDD）

我先写代码，*然后*再写测试用例——但不要太分开——不过很快

我还测试了 CRUD 操作——数据库的持久性。

当我完成持久性 - 并转到 UI 层 - 我将有相当大的信心相信我的服务\持久层是好的 - 然后我可以在那一刻只专注于 UI。

所以恕我直言——TDD\单元测试总是有好处的（不管你怎么称呼它，取决于你对它的感觉有多极端）——即使对于 CRUD 应用程序你只需要为你的应用程序找到正确的策略

只要使用常识......你会没事的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-13T23:53:02.413

我觉得我们将 TDD 与单元测试混淆了。

单元测试是测试行为单元的特定测试。这些测试通常包含在集成构建中。S.Lott 为这些类型的测试描述了一些优秀的候选人。

TDD 用于设计。我经常发现我在使用 TDD 时编写的测试不会被丢弃或演变成单元测试。这背后的原因是，当我在做 TDD 时，我正在测试我的设计，而我正在设计我的应用程序、类、方法、域等......

针对您的情况，我同意 S.Lott 暗示的是，您需要一套单元测试来测试应用程序中的特定行为。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-26T08:32:08.887

在我看来，TDD 一个简单的 CRUD 应用程序有点像在吉他上练习音阶 - 你可能会认为只是发现你的演奏有多大的进步是无聊和乏味的。在开发方面 - 您可能会编写耦合较少的代码 - 更可测试。此外，您更有可能从代码使用者的角度看待事物——您实际上会使用它。这可能会产生许多有趣的副作用，例如更直观的 API、更好的关注点分离等。当然，有脚手架生成器可以为您执行基本的 CRUD，并且它们确实有专门用于原型设计的地方，但是它们通常与框架相关联各种各样的。为什么不先关注核心领域，推迟框架 / UI / 数据库决策，直到您对所需的核心功能有了更好的了解 - TDD 也可以帮助您做到这一点。在您的示例中：您希望消息成为队列还是分层树等？您希望它们实时加载吗？排序/搜索呢？你需要支持 JSON 还是只支持 html？使用 BDD / TDD 更容易看到这类问题。如果您正在执行 TDD，您甚至可以在不使用框架的情况下测试您的核心逻辑（并等待它加载/运行）使用 BDD / TDD 更容易看到这类问题。如果您正在执行 TDD，您甚至可以在不使用框架的情况下测试您的核心逻辑（并等待它加载/运行）使用 BDD / TDD 更容易看到这类问题。如果您正在执行 TDD，您甚至可以在不使用框架的情况下测试您的核心逻辑（并等待它加载/运行）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-09T07:13:49.120

跳过它。一切都会好起来的。我确定你有一个截止日期。（/讽刺）

下个月，我们可以根据用户反馈回过头来优化查询。打破我们不知道我们不应该打破的东西。

如果您认为该项目将持续 2 周然后永远不会重新打开，那么自动化测试可能是在浪费时间。否则，如果您对“拥有”此代码几个月的既得利益，并且它处于活动状态，请构建一些测试。使用您的判断来判断风险最大的地方。更糟糕的是，如果你打算在公司工作几年，并且让其他队友轮流研究系统的各个部分，并且一年后可能又轮到你了，那就做一些测试。

不要过度，而是要“在里面插几根针”，这样如果事情开始“四处走动”，你就会有一些警报来引起人们对事情的注意。

我的大部分测试都是 JUnit 或批处理“差异”类型测试，以及我几年前编写的一个基本的屏幕刮板类型工具（编写一些正则表达式 + wget/curl 类型的东西）。我听说 Selenium 应该是 Web 应用 UI 测试的好工具，但还没有尝试过。任何人都有本地 GUI 应用程序的可用工具？？？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-09T06:00:12.403

只是一个想法...

获取 CRUD 的要求，使用[watij](http://watij.com)或[watir](http://wtr.rubyforge.org/)或[AutoIt](http://www.autoitscript.com/AutoIt/)等工具来创建测试用例。开始创建 UI 以通过测试用例。一旦你启动了 UI 并且可能只通过了一个测试，就开始为该测试编写逻辑层，然后是 db 层。

对于大多数用户来说，UI 就是系统。请记住为您正在构建的每个新层编写测试用例。所以与其从 db 到 app 到 ui 层开始，不如从相反的方向开始。

归根结底，你可能已经积累了一套强大的回归测试集，让你对安全地进行重构有信心。

这只是一个想法...

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-09T02:16:18.523

我明白您在说什么，但最终您的模型将变得足够先进，以至于它们需要（或通过自动化测试大大增强）。如果不是，那么您本质上是在开发一个有人已经为您开发的电子表格。

既然您提到了 Rails，我会说对每个属性进行标准的创建/读取/更新/删除测试是一个好主意，特别是因为您的测试应该注意权限（我认为这是巨大的）。这还可以确保您的迁移按预期工作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-09T02:52:13.273

我现在正在开发一个 CRUD 应用程序。此时我正在做的是在我的 Repository 对象上编写单元测试并测试 CRUD 功能是否正常工作。我发现这本身也对实际的数据库代码进行了单元测试。通过这种方式，我们在数据库代码中发现了很多错误。所以我建议你继续前进并继续进行单元测试。我知道在 CRUD 应用程序上应用 TDD 并不像您在博客或杂志上看到的那样迷人，但它正在服务于它的目的，当您处理更复杂的应用程序时，您会变得更好。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-03-25T12:16:20.757

如今，除了 UI 之外，CRUD 应用程序不需要太多手写代码，因为有 101 个框架可以生成数据库和数据访问代码。

所以我会考虑减少手写代码的数量，并自动化 UI 的测试。然后我会使用需要手工编写的奇数位逻辑的 TDD。

# special-characters - 在 Google 中查找特殊字符

> ID：842478
> 
> 赞同：68
> 
> 时间：2009-05-09T01:39:55.383
> 
> 标签：special-characters, google-search

你知道如何用谷歌查找特殊字符吗...？

我正在查看 bash 代码，并且有 ## 运算符。我想知道它做了什么，但我无法找到保护角色的方法（我不确定这是否可能）。

当您正在寻找一些代码模式时，这尤其令人讨厌，某些字符总是被忽略。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-09T01:48:22.647

[如此处](http://www.google.com/support/websearch/bin/answer.py?hl=en&answer=134479)所述， Google 会从查询中去除大部分标点符号，因此它不会帮助您使用 bash 语法。

在 bash 文档中搜索字符串“##”非常容易：只需运行“info bash”，点击“s”，然后输入“##”作为搜索字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-11-18T18:56:53.533

google strips puntuation, imho, because:

*   it's somewhere used for special search (chars like - to exclude, +to add and 10..20 to specify a range)
*   to avoid spammers to get email addresses (characters like @ or .) in my experience, it's even impossible to escape special characters. the only solution I found, by now, is using yahoo [http://it.search.yahoo.com/](http://it.search.yahoo.com/)

# silverlight - 具有动态高度的 Silverlight

> ID：842481
> 
> 赞同：5
> 
> 时间：2009-05-09T01:42:09.900
> 
> 标签：silverlight, height

我有一个 silverlight 应用程序，我希望它能够像常规 HTML 页面一样调整大小。也就是说，我希望 silverlight 插件的大小在高度上扩展和收缩，以适应我在 silverlight 应用程序中填充的动态数据和控件。所以，假设我有一个带有网格和按钮的页面。用户按下按钮，网格得到一堆带有图像的行，使网格的自然大小高于浏览器窗口。我想有一些东西来调整silverlight插件的大小以适应网格的DesiredSize。以下以及其他几种尝试均无效：

```
// handler in my main page.
 void MainGrid_LayoutUpdated(object sender, EventArgs e)
 {
     HtmlPage.Window.Invoke("setSilverlightSize", this.MainGrid.DesiredSize.Height);
 }

<body style="height:100%;margin:0;">
    <form id="mainForm" runat="server" style="height:100%;">
        <asp:ScriptManager ID="ScriptManager" runat="server"></asp:ScriptManager>
        <div id="SilverlightContainer"  style="height:100%;">
            <asp:Silverlight ID="SLMain" runat="server" Source="~/ClientBin/My.Silverlight.Main.xap" Version="2.0" Width="100%" Height="100%" />
        </div>
    </form>
    <script type="text/javascript">
        function setSilverlightSize(val) {
            var host = document.getElementById("SilverlightContainer");
            host.style.height = val + "px";
        }
    </script>
</body> 
```

MainGrid 的所需大小总是希望是窗口的大小。海盗说。

-r

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T11:46:28.930

1.  将溢出设置为“自动”
2.  将滚动设置为“否”
3.  将边距设置为“0”
4.  将包含的 div 的宽度和高度设置为“100%”
5.  将 Silverlight 控件的宽度和高度设置为“100%”

这应该涵盖您的所有基础。请参阅下面的一些示例 HTML。

尝试这个：

```
<style type="text/css"> 
html, body { overflow:auto } 
</style>
<head>
    <title>My App</title>
</head>
<body id="bodyId" style="margin:0;" scroll="no">
    <form id="form1" runat="server">
        <asp:ScriptManager ID="ScriptManager1" runat="server"></asp:ScriptManager>
         <div style="position: fixed; height: 100%; width: 100%">
            <avn:Silverlight 
                ID="xamlHost" 
                runat="server" 
                Source="~/ClientBin/THE.xap" 
                MinimumVersion="x.x.xxxxx" 
                Width="100%" 
                Height="100%" 
                />
         </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T00:48:45.243

我用过这个，似乎效果很好。需要获得 Render"ed" 大小。

```
private void LayoutRoot_LayoutUpdated(object sender, System.EventArgs e)
{
    // Set the size of the SL object to the new rendered size of the Grid.
    ResizeSilverlightOnject(this.LayoutRoot.RenderSize.Height);
}

private void ResizeSilverlightObject( double height )
{
    HtmlPage.Window.Invoke( "ResizeObject", new object[] { height } );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T19:55:54.200

在我的例子中，我创建了一个事件并将高度数据发送到我的浏览器以处理来自 javascript 的高度值这是我的 HTML 代码：

```
/*
When Silverlight is loaded attach silverlight events
*/
function OnSilverlightLoaded(sender, args) {
    //Getting Silverlight object on page
    _silverlightControlHost = document.getElementById("SilverlightObject");
    //Subscribe to it events
    _silverlightControlHost.Content.SilverlightApp.SetHeightEvent = SetHeightEvent;
} 
```

这是我的 Silverlight 代码：

```
[ScriptableType]
public partial class MainPage
{
    //Register the event to be as accessible from script
    [ScriptableMember]
    public event EventHandler<HeightEventHandler> SetHeightEvent;

    public MainPage()
    {
        InitializeComponent();

        //Register this instance to be accessible from script
        HtmlPage.RegisterScriptableObject("SilverlightApp", this);
    }

    public void SomeMethod()
    {
        if (this.SetHeightEvent != null)
            this.SetHeightEvent(this, new HeightEventHandler() { Altura = _heightSilverObj.ToString() });
    }
}

[ScriptableType]
public class HeightEventHandler : EventArgs
{
    public string Altura { get; set; }
} 
```

这是有效的！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-17T15:39:47.883

如果您尝试使用验证摘要确定高度（与此问题稍微无关，但很有用），请尝试以下操作：在您的 Page.xaml.cs // 将原始高度存储在 Page_Loaded 事件中

```
void Page_Loaded(object sender, RoutedEventArgs e)
{
        SetupPage();
        this.ValidationSummary.SizeChanged += new SizeChangedEventHandler(ValidationSummary_SizeChanged);
}
void ValidationSummary_SizeChanged(object sender, SizeChangedEventArgs e)
    {
        if (this.OriginalPageHeight == 0.0)
        {
            this.OriginalPageHeight = this.RenderSize.Height;
        }
        else
        {
            double expandSize = this.OriginalPageHeight + e.NewSize.Height;
            ResizeSilverlightObject(expandSize);
        }
    } 
```

编辑：添加了 Javascript 函数和 cs 函数

```
 function ResizeObject(height) {
        var host = document.getElementById("uploaderHost");
        host.style.height = height + "px";
    }

public void ResizeSilverlightObject(double height)
    {
       HtmlPage.HtmlWindow.Invoke("ResizeObject", new object[] { height });

    } 
```

# php - Windows PHP上的PostgreSQL问题

> ID：842483
> 
> 赞同：3
> 
> 时间：2009-05-09T01:46:39.530
> 
> 标签：php, postgresql, wamp

我在 Windows 上使用 WAMP，它安装 PHP、Apache 和 MySQL。

我现在正在研究需要 PostgreSQL 的新东西。当前安装对我不起作用，因为我不断收到以下错误：

> 调用未定义的函数 pg_query()

总是

> 未定义函数

我已经为 windows 安装了 PostgreSQL 8.3.7-1，添加了`php_pgsql.dll`，`php_pdo_pgsql.dll`甚至`libpq.dll`，在 postgreSQL 的 PHP 页面上的注释说 Windows 用户需要从 PHP 5.2.6 开始

不过，我不断收到这些错误...

有人可以建议最好的行动方案吗？或者我应该卸载 apache 和其他所有东西，然后单独重新安装每个组件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T09:19:54.513

xampp 不会“告诉”apache/php 使用哪个 php.ini。因此 php 使用其默认查找策略来查找 .ini 文件。如果您没有更改任何内容，这将是 apache 二进制文件所在目录 xampp/apache/bin/php.ini 中的那个。您是否编辑了此文件并删除了 extension=php_pgsql.dll 之前的分号？有疑问时问

```
echo 'php.ini: ', get_cfg_var('cfg_file_path');
```

您必须编辑哪个文件。
xampp 默认将 php 作为模块安装，您必须重新启动 apache 才能让 php 再次读取 php.ini。之后

```
echo extension_loaded('pgsql') ? 'yes':'no';
```

应该打印*yes*。如果它没有停止 apache 服务，打开一个命令 shell，进入你的 xampp 目录并输入

```
apache_start.bat
```

这会将 apache 作为控制台应用程序启动，您可以在此控制台中看到启动错误（而不是 Windows 的事件管理器）。如果缺少 dll，您将收到一个消息框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T02:23:10.130

您是否在 php ini 文件中启用它？

对 phpinfo() 的调用说为扩展安装了什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T11:23:42.703

根据您在 Apache 的 error.log 中看到的错误类型，有关[此](https://stackoverflow.com/questions/551734/php-not-loading-phppgsql-dll-on-windows/552712)问题的答案可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-30T12:38:25.737

我做了和你一样的事情并解决了这个问题。但我的问题是针对 xampp 的。可能你应该重新安装你的 wamp。

# unix - 如何在 unix 中拆分具有偏移值的日志文件？

> ID：842490
> 
> 赞同：1
> 
> 时间：2009-05-09T01:55:04.237
> 
> 标签：unix, split

我的盒子上有一个非常大的日志文件（9GB——我知道我需要修复它）。我需要拆分成块，以便将其上传到亚马逊 S3 进行备份。S3 的最大文件大小为 5GB。所以我想把它分成几个块，然后上传每个块。

这就是问题所在，我的服务器上只有 5GB 可用空间，所以我不能只进行简单的 unix 拆分。这是我想做的事情：

1.  抓取日志文件的前 4GB 并吐出到一个单独的文件中（称为段 1）
2.  将该段 1 上传到 s3。
3.  rm segment1 释放空间。
4.  从日志文件中获取中间的 4GB 并上传到 s3。像以前一样清理
5.  获取剩余的 1GB 并上传到 S3。

我找不到用偏移量分割的正确 unix 命令。Split 只做等量的事情，而 csplit 似乎也没有我需要的东西。有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T02:10:30.707

一个（复杂的）解决方案是先压缩它。文本日志文件应该很容易从 9G 降到远低于 5G，然后删除原始文件，为您提供 9G 的可用空间。

然后直接通过管道传输该压缩文件，`split`以免占用更多磁盘空间。你最终会得到一个压缩文件和三个要上传的文件。

上传它们，然后删除它们，然后解压缩原始日志。

=====

一个更好的解决方案是只计算行数（比如 300 万行）并使用 awk 脚本来提取和发送各个部分：

```
awk '1,1000000 {print}' biglogfile > bit1
# send and delete bit1

awk '1000001,2000000 {print}' biglogfile > bit2
# send and delete bit2

awk '2000001,3000000 {print}' biglogfile > bit3
# send and delete bit3 
```

`bit1`然后，在另一端，您可以`bit3`单独处理或重新组合它们：

```
mv bit1 whole
cat bit2 >>whole ; rm bit2
cat bit3 >>whole ; rm bit3 
```

当然，这种拆分可以使用 Unix 中的任何标准文本处理工具来完成：`perl`, `python`, `awk`,`head/tail`组合。这取决于您对什么感到满意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T02:13:56.940

首先， gzip -9 你的日志文件。

然后，编写一个小的 shell 脚本来使用 dd：

```
#!/bin/env sh

chunk_size = 2048 * 1048576; #gigs in megabytes
input_file = shift;    

len = `stat '%s' $input_file`
chunks = $(($len/$chunk_size + 1))

for i in {0...$chunks}
do
  dd if=$input_file skip=$i of=$input_file.part count=1 bs=$chunk_size
  scp $input_file.part servername:path/$input_file.part.$i
done 
```

我只是把它从我的头顶上掉下来，所以我不知道它是否会在没有修改的情况下工作，但你需要的是与此非常相似的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T02:14:48.433

你可以使用dd。您需要在每个块中指定 bs（内存缓冲区大小）、skip（要跳过的缓冲区数）和 count（要复制的缓冲区数）。

因此，使用 10Meg 的缓冲区大小，您将执行以下操作：

```
# For the first 4Gig
dd if=myfile.log bs=10M skip=0 count=400 of=part1.logbit
<upload part1.logbit and remove it>
# For the second 4Gig
dd if=myfile.log bs=10M skip=400 count=400 of=part2.logbit
... 
```

您还可以从压缩要传输的数据中受益：

```
dd if=myfile.log bs=10M skip=800 count=400 | gzip -c > part3.logbit.gz 
```

可能有更友好的方法。

dd has some real shortcomings. If you use a small buffer size, it runs much more slowly. But you can only skip/seek in the file by multiples of bs. So if you want to start reading data from a prime offset, you're in a real fiddle. Anyway I digress.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T02:16:23.390

Coreutils split creates equal sized output sections, excepting for the last section.

```
split --bytes=4GM bigfile chunks 
```

# c# - 通知图标不显示

> ID：842494
> 
> 赞同：2
> 
> 时间：2009-05-09T01:57:42.047
> 
> 标签：c#, winforms, notifyicon

我正在编写一个简单的应用程序，我想用 notifyIcon 而不是表单来控制它，我已经按照我通过 Google 找到的示例进行了操作，但我的 notifyIcon 不会出现。我究竟做错了什么？

```
 static class MainEntryClass
    {
        /// 
        /// The main entry point for the application.
        /// 
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            C2F TestApp = new C2F();
            Application.Run();
            TestApp.Dispose();
        }
    }

    class C2F 
    {
        public C2F()
        {
            InitializeComponent();
            loadSettings();
        }

        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(C2F));
            this.niC2F = new System.Windows.Forms.NotifyIcon(this.components);
            this.contextMenuStrip1 = new System.Windows.Forms.ContextMenuStrip(this.components);
            this.settingsToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.separatorToolStripMenuItem = new System.Windows.Forms.ToolStripSeparator();
            this.exitToolStripMenuItem = new System.Windows.Forms.ToolStripMenuItem();
            this.contextMenuStrip1.SuspendLayout();
            // 
            // niC2F
            //
            this.niC2F.BalloonTipText = "MyApp";
            this.niC2F.Icon = ((System.Drawing.Icon)(Clipboard2File.Properties.Resources.ResourceManager.GetObject("MyIcon.ico")));
            this.niC2F.Text = "MyApp";
            this.niC2F.ContextMenuStrip = this.contextMenuStrip1;
            this.niC2F.ShowBalloonTip(5);
            this.niC2F.Visible = true;
            this.niC2F.MouseClick += new System.Windows.Forms.MouseEventHandler(this.niC2F_MouseClick);
            // 
            // contextMenuStrip1
            // 
            this.contextMenuStrip1.Items.AddRange(new System.Windows.Forms.ToolStripItem[] {
            this.settingsToolStripMenuItem,
            this.separatorToolStripMenuItem,
            this.exitToolStripMenuItem});
            this.contextMenuStrip1.Name = "contextMenuStrip1";
            this.contextMenuStrip1.Size = new System.Drawing.Size(153, 76);
            // 
            // settingsToolStripMenuItem
            // 
            this.settingsToolStripMenuItem.Name = "settingsToolStripMenuItem";
            this.settingsToolStripMenuItem.Size = new System.Drawing.Size(152, 22);
            this.settingsToolStripMenuItem.Text = "Settings";
            this.settingsToolStripMenuItem.Click += new System.EventHandler(this.settingsToolStripMenuItem_Click);
            // 
            // separatorToolStripMenuItem
            // 
            this.separatorToolStripMenuItem.Name = "separatorToolStripMenuItem";
            this.separatorToolStripMenuItem.Size = new System.Drawing.Size(149, 6);
            this.separatorToolStripMenuItem.Click += new System.EventHandler(this.exitToolStripMenuItem_Click);
            // 
            // exitToolStripMenuItem1
            // 
            this.exitToolStripMenuItem.Name = "exitToolStripMenuItem1";
            this.exitToolStripMenuItem.Size = new System.Drawing.Size(152, 22);
            this.exitToolStripMenuItem.Text = "Exit";
        }

        private System.ComponentModel.IContainer components = null;
        private Form1 frmSettings = new Form1();
        private Settings C2FSettings = new Settings();
        private System.Windows.Forms.NotifyIcon niC2F;
        private System.Windows.Forms.ContextMenuStrip contextMenuStrip1;
        private System.Windows.Forms.ToolStripMenuItem settingsToolStripMenuItem;
        private System.Windows.Forms.ToolStripSeparator separatorToolStripMenuItem;
        private System.Windows.Forms.ToolStripMenuItem exitToolStripMenuItem;
     } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-09T07:05:18.453

我实际上刚刚完成了一个以 NotifyIcon 开始的项目。您的代码（我猜您只是提供了一个片段）与我的非常相似。

我检查了你的代码，我必须做的唯一改变就是改变你调用图标的方式：

```
this.niC2F.Icon = new System.Drawing.Icon(@"C:\PathToIcon\iconfile.ico"); 
```

下面是一个带有右键菜单和双击功能的工作示例：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows.Forms;

namespace TestApp
{
    static class MainEntryClass
    {
        /// 
        /// The main entry point for the application.
        /// 
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            C2F TestApp = new C2F();
            Application.Run();
        }
    }

    class C2F
    {
        System.ComponentModel.Container component;
        System.Drawing.Icon icon;
        ContextMenuStrip rightClickMenu = new ContextMenuStrip();
        NotifyIcon trayIcon;
        ToolStripMenuItem options = new ToolStripMenuItem();
        ToolStripMenuItem restore = new ToolStripMenuItem();
        ToolStripMenuItem exit = new ToolStripMenuItem();
        ToolStripSeparator seperator = new ToolStripSeparator();

        public C2F()
        {
            InitializeComponent();
        }

        private void InitializeComponent()
        {
            icon = new System.Drawing.Icon(@"C:\PathToIcon\iconfile.ico");
            component = new System.ComponentModel.Container();
            trayIcon = new NotifyIcon(component);
            trayIcon.Text = "Bill Reminder";
            trayIcon.Icon = icon;
            trayIcon.Visible = true;
            trayIcon.DoubleClick += new EventHandler(trayIcon_DoubleClick);
            trayIcon.ContextMenuStrip = rightClickMenu;

            rightClickMenu.Items.AddRange(new System.Windows.Forms.ToolStripItem[]
            {
                options,
                seperator,
                restore,
                exit
            });

            options.Font = new System.Drawing.Font("Segoe UI", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            options.Text = "Options";
            options.Click += new EventHandler(options_Click);

            restore.Font = new System.Drawing.Font("Segoe UI", 9F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            restore.Text = "Restore Window";
            restore.Click += new EventHandler(restore_Click);

            exit.Font = new System.Drawing.Font("Segoe UI", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            exit.Text = "Exit";
            exit.Click += new EventHandler(exit_Click);
        }

        void exit_Click(object sender, EventArgs e)
        {
            Application.Exit();
        }

        void restore_Click(object sender, EventArgs e)
        {
            FormName showWindow = new FormName();
            showWindow.Show();
        }

        void options_Click(object sender, EventArgs e)
        {
            Settings_Window settings = new Settings_Window();
            settings.Show();
        }

        void trayIcon_DoubleClick(object sender, EventArgs e)
        {
            FormName showWindow = new FormName();
            showWindow.Show();
        }
    }

} 
```

希望这对您有帮助，如果您有任何问题，请告诉我！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-13T18:02:21.550

未显示 NotifyIcon 的另一个原因是，如果 Windows Explorer 以提升的权限运行，而您的托盘应用程序却没有（当然仅在具有 UAC 的系统上）。

如果 explorer.exe 崩溃或被杀死，然后用户从提升的任务管理器手动重新启动它，就会发生这种情况。

NotifyIcon 控件内部使用 Shell_NotifyIcon 本机方法，但不检查返回值。如果 Shell_NotifyIcon 返回 FALSE，您将永远不会收到通知。

我不得不在 Shell_NotifyIcon 上用 WinDbg 断点，GetLastError 给了我 ERROR_ACCESS_DENIED。所以我意识到有一个权限问题，它可能是由重新启动的资源管理器提升引起的。进一步的测试证实了这一假设。

然而，这是相当罕见的情况。

# java - 接下来使用 Java Scanner 读取文本（模式模式）

> ID：842496
> 
> 赞同：3
> 
> 时间：2009-05-09T01:59:55.663
> 
> 标签：java, java.util.scanner, next

我正在尝试使用 Scanner 类读取一行，使用 next(Pattern pattern) 方法捕获冒号之前和冒号之后的文本，以便 s1 = textbeforecolon 和 s2 = textaftercolon。

该行如下所示：

东西：别的东西

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-09T03:03:06.697

有两种方法可以做到这一点，具体取决于您想要什么。

如果你想用冒号分割整个输入，那么你可以使用该`useDelimiter()`方法，就像其他人指出的那样：

```
// You could also say "scanner.useDelimiter(Pattern.compile(":"))", but
// that's the exact same thing as saying "scanner.useDelimiter(":")".
scanner.useDelimiter(":");

// Examines each token one at a time
while (scanner.hasNext())
{
    String token = scanner.next();
    // Do something with token here...
} 
```

`String`如果你想用冒号分隔每一行，那么使用's`split()`方法会容易得多：

```
while (scanner.hasNextLine())
{
    String[] parts = scanner.nextLine().split(":");
    // The parts array now contains ["something", "somethingelse"]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T02:49:53.140

我从来没有在扫描仪上使用过 Pattern。

我一直只是用字符串更改分隔符。 [http://java.sun.com/j2se/1.5.0/docs/api/java/util/Scanner.html#useDelimiter(java.lang.String)](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Scanner.html#useDelimiter(java.lang.String))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T02:50:22.763

```
File file = new File("someFileWithLinesContainingYourExampleText.txt");
Scanner s = new Scanner(file);
s.useDelimiter(":");

while (!s.hasNextLine()) {
    while (s.hasNext()) {
        String text = s.next();
    System.out.println(text);
    }

    s.nextLine();
} 
```

# java - 不丢弃数据包的距离向量的线程

> ID：842497
> 
> 赞同：1
> 
> 时间：2009-05-09T01:59:56.223
> 
> 标签：java, algorithm, multithreading, vector, distance

我正在网络架构 1 中完成我的作业，我必须在每个节点上实现距离矢量路由。

在每个节点上，我都有一个线程，它`DatagramPacket`仅在特定端口上侦听包含来自相邻节点的路由信息​​的传入 s。当数据报到达时，线程处理该数据报，如果其内部路由表中有更新，则将其路由信息发送给所有邻居。

我正在尝试用 Java 来实现。

我面临的问题是，当数据报到达时，我需要对其进行处理。如果在此期间有任何其他数据报到达，则将其丢弃，因为线程当前正在处理信息。这意味着我丢失了信息。

谁能帮我这个？

我正在使用从 java 中的套接字读取的常用方式。

```
DatagramSocket socket = new DatagramSocket(4445, InetAddress.getByName("127.0.0.1"));
while (true) {
    try {
        byte[] buf = new byte[2000];

        // receive request
        DatagramPacket recvRequest = new DatagramPacket(buf, buf.length);

        socket.receive(recvRequest);

        //Some process of data in datagram

    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T02:46:21.463

您可以在一个线程中处理接收到的数据报，因此您的带有套接字侦听器的线程可以继续接收新的数据报。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-14T02:39:08.197

这是我提交的最后一个项目。它可能有一些不正确的文档和 Java 的一些错误使用。由于这个项目在本地系统上运行，而不是使用不同的 IP 地址和相同的端口号，我正在做其他方式。

NetworkBoot.java 为每个路由器提供初始邻居详细信息。

谢谢-Sunny Jain

```
enter code here 
```

/* * 文件名：Router.java * 公共类名：Router * */

//~--- JDK 导入 ------------------------------------------ ------------------

导入 java.io.IOException；

导入 java.net.DatagramPacket；

导入 java.net.DatagramSocket；

导入java.net.InetAddress；

导入 java.util.HashMap；

导入 java.util.Iterator；

导入 java.util.Set；

导入 java.util.concurrent.LinkedBlockingQueue；

导入 javax.swing.SwingUtilities；

/** * * NA1 项目 2009 年春季学期 * @author Sunny jain * * */

公共类路由器扩展线程{

```
/**
 * HashMap containing list of neighbors and cost to reach them.
 */
private HashMap<Integer, Integer> hmapDirectNeighbours = new HashMap<Integer, Integer>(61);
/**
 * HashMap containing list of destination as key and routing info to them as value.
 * Routing info contains RouteDetail object.
 * @see RouteDetail
 */
private HashMap<Integer, RouteDetail> hmapRoutes = new HashMap<Integer, RouteDetail>();
/**
 * DatagramSocket
 */
private DatagramSocket dSoc;
/**
 * DatagramPacket
 */
private DatagramPacket dpackReceive,  dpackSend;
/**
 * Inetaddress of system on which runs this algorithm.
 */
private InetAddress localAddress;
/**
 * port to listen at for incoming route info from neighbors.
 */
int port;
private LinkedBlockingQueue<DatagramPacket> lbq = new LinkedBlockingQueue<DatagramPacket>();

/**
 * Made constructor private to force initialization by specifying port
 * compulsory.
 */
private Router() {
}

/**
 * Constuctor taking port number as parameter and creates a datagramSocket
 * to listen for incoming DatagramPacket on that socket.
 * @param port
 */
public Router(int port) {
    try {
        this.port = port;
        localAddress = InetAddress.getByName("127.0.0.1");
        dSoc = new DatagramSocket(port, localAddress);
    } catch (Exception ex) {
        System.out.println("Error while creating socket : " + ex.getMessage());
    }
    this.start();

    SwingUtilities.invokeLater(new Runnable() {
        public void run() {
            while (true) {
                try {
                    received_Route_Info(lbq.take());
                } catch (InterruptedException ex) {
                    System.out.println("Error while reading elements from datagram queue");
                }}}});
}

public void setRouterBootInfo(String strNeighboursInfo) {
    String[] strNeighbouringNodes = strNeighboursInfo.split(";");

   for (int i = 0; i < strNeighbouringNodes.length; i++) {

        String[] strNodeIpAndPort = strNeighbouringNodes[i].split(":");

        hmapDirectNeighbours.put(Integer.valueOf(strNodeIpAndPort[0]), Integer.valueOf(strNodeIpAndPort[1]));
        hmapRoutes.put(Integer.valueOf(strNodeIpAndPort[0]), new RouteDetail(null, Integer.valueOf(strNodeIpAndPort[1])));
    }
    propagateChanges();
// entry in Route table....No need for infinity as we creat entry when a node is reachable.
}

@Override
public void run() {
    while (true) {
        try {
            byte[] buf = new byte[250];
            // receive request
            dpackReceive = new DatagramPacket(buf, buf.length);
            dSoc.receive(dpackReceive);
            lbq.put(dpackReceive);
        } catch (InterruptedException ex) {
            ex.printStackTrace();
            dSoc.close();
        } catch (IOException e) {
            e.printStackTrace();
            dSoc.close();
        }
    }

}

/**
 * This method is called for each DatagramPacket received containing new
 * routing information.
 *
 * This method checks whether this packet came from neighboring node
 * (routers) only. If true it applies Distance vector algorithm on data
 * present in datagram packet and due to this information if their is any
 * change in local routing information that it displays current local
 * updated routing information and also sends this updated information to
 * other neighbours only.
 *
 * @param dataPckt
 * @see  #validate_Is_Packet_From_Neighbor(java.net.DatagramPacket)
 * @see #apply_Routing_Algorithm(java.net.DatagramPacket, java.util.HashMap)
 * @see #print_route_info()
 * @see #send_Updates_To_Neighbors(routesInfo)
 */
private void received_Route_Info(DatagramPacket dataPckt) {
    if (dataPckt.getPort() == 4000) {
        setRouterBootInfo(getStringFromBytes(dataPckt));
    } else if (validate_Is_Packet_From_Neighbor(dataPckt)) {
        if (apply_Routing_Algorithm(dataPckt, create_HashMap_Routes(getStringFromBytes(dataPckt)))) {

            // if their is change in routing information.
            propagateChanges();
        }
    }
}

/**
 * Validates whether the Datagram packet received is from the neighbors only.
 * @param datagrampckt DatagramPacket comtaining routing information.
 * @return true if datagrampckt is from neighbors only otherwise false.
 */
private boolean validate_Is_Packet_From_Neighbor(DatagramPacket datagrampckt) {
    return hmapDirectNeighbours.containsKey(Integer.valueOf(datagrampckt.getPort()));
}

/**
 * Returns byte representaion of data contained in DatagramPacket pkt.
 * @param pkt DatagramPacket
 * @return byte representation of data contained in pkt
 */
private String getStringFromBytes(DatagramPacket pkt) {
    String strData = new String(pkt.getData());
    return strData.substring(0, strData.lastIndexOf(';'));
}

/**
 * Applies Distance Vector algorithm using newly received routing information
 * and information presently with this node (Router).
 * @param datagrampckt DatagramPacket containing routing information.
 * @param newRoutes HashMap of routes new information received with
 * destination as key and cost to that destination as value.
 */
private boolean apply_Routing_Algorithm(DatagramPacket dataPckt, HashMap<Integer, Integer> newRoutes) {
    boolean updated = false;
    Integer pktSourse = Integer.valueOf(dataPckt.getPort());

    // Get a set of the routes
    Set<Integer> set = newRoutes.keySet();

    // Get an iterator
    Iterator<Integer> iterator = set.iterator();

    // Display elements.
    while (iterator.hasNext()) {
        Integer key = iterator.next();
        Integer nextHopCost = hmapRoutes.get(pktSourse).getPathCost();
        int optionalCost = newRoutes.get(key) + (nextHopCost == null ? 0 : nextHopCost);
        if (hmapRoutes.containsKey(key)) {
            RouteDetail routeDetail = hmapRoutes.get(key);

            if (routeDetail.getPathCost().compareTo(optionalCost) > 0) {
                routeDetail.setNextHop(pktSourse);
                routeDetail.setPathCost(optionalCost);
                hmapRoutes.put(key, routeDetail);
                updated = true;

            // try to verify above statement
            }
        } else {
            if (!key.equals(port)) {
                RouteDetail newRouteDetail = new RouteDetail(pktSourse, optionalCost);
                hmapRoutes.put(key, newRouteDetail);
                updated = true;
            }
        }
    }

    return updated;
}

/**
 * When internal routing information is chaged, send this information to
 * other neighbors.
 * @param routesInfo byte representaion of routing information.
 */
private void send_Updates_To_Neighbors(byte[] routesInfo) {

    // Get a set of the routes
    Set<Integer> set = hmapDirectNeighbours.keySet();

    // Get an iterator
    Iterator<Integer> iterator = set.iterator();

    // Display elements.
    while (iterator.hasNext()) {
        dpackSend = new DatagramPacket(routesInfo, routesInfo.length, localAddress, iterator.next().intValue());

        try {
            dSoc.send(dpackSend);
        } catch (IOException ex) {
            System.out.println("Error while sending route updates : " + ex.getMessage());
        }
    }
}

/**
 * Parses routeInfo to creat an HashMap based on this informationin the
 * format as HashMap of <<Integer:Destination>,<Integer: Cost to this destination>>
 * @param routeInfo contains routing information as String in the syntax
 * of {<Destination>:<Cost to destination>;}
 * @return Hashmap<<Integer:Destination>,<Integer: Cost to this destination>>
 */
private HashMap<Integer, Integer> create_HashMap_Routes(String routeInfo) {
    HashMap<Integer, Integer> routes = new HashMap<Integer, Integer>();
    String[] straRoute = routeInfo.split(";");

    for (int i = 0; i < straRoute.length; i++) {
        String[] straDestAndCost = straRoute[i].split(":");

        routes.put(Integer.parseInt(straDestAndCost[0]), Integer.parseInt(straDestAndCost[1]));
    }

    return routes;
}

/**
 * Converts current routing information stored as HashMap to String
 * presentation in format as {<Destination>:<Cost to destination>;}
 *
 * @return String representaion of routing information.
 * @see #hmapRoutes.
 */
private String create_String_Of_Routes() {
    StringBuilder strB = new StringBuilder();

    // Get a set of the routes
    Set<Integer> set = hmapRoutes.keySet();

    // Get an iterator
    Iterator<Integer> iterator = set.iterator();

    // Display elements.
    while (iterator.hasNext()) {
        Integer destination = iterator.next();

        strB.append(destination);
        strB.append(":");
        strB.append(hmapRoutes.get(destination).getPathCost());
        strB.append(";");
    }

    return strB.toString();
}

/**
 * Prints the current routing information stored in <code>hmapRoutes</code>
 * to default output stream of this program.
 * @see #hmapRoutes.
 */
public void print_route_info() {
    RouteDetail route;
    StringBuilder builder;

    // PRINT THE CURRENT ROUTING INFO AT THIS NODE
    System.out.println("");
    System.out.println("    TABLE AT NODE WITH PORT  : " + port);
    System.out.println("--------------------------------------------------------------------------------");
    System.out.println("\t\tTo  \t|\t Via\t|\tCost\t\t");
    System.out.println("--------------------------------------------------------------------------------");

    // Get a set of the routes
    Set<Integer> set = hmapRoutes.keySet();

    // Get an iterator
    Iterator<Integer> iterator = set.iterator();

    // Display elements.
    while (iterator.hasNext()) {
        Integer key = iterator.next();

        route = hmapRoutes.get(key);
        builder = new StringBuilder();
        builder.append("\t\t" + key.intValue());
        builder.append("\t|\t" + (route.getNextHop() == null ? "   -" : route.getNextHop()));
        builder.append("\t|\t" + route.getPathCost() + "\t\t");
        System.out.println(builder.toString());
    }
}

/**
 * This class provides details for each destination.
 * It provides detail of cost that will be incurred to reach that
 * destination and next router on that path.
 */ 
```

私有类 RouteDetail {

```
 Integer nextHop;
    Integer pathCost;

    public RouteDetail(Integer nextHop, Integer pathCost) {
        this.nextHop = nextHop;
        this.pathCost = pathCost;
    }

    public Integer getNextHop() {
        return nextHop;
    }

    public void setNextHop(Integer nextHop) {
        this.nextHop = nextHop;
    }

    public Integer getPathCost() {
        return pathCost;
    }

    public void setPathCost(Integer pathCost) {
        this.pathCost = pathCost;
    }
}

private void propagateChanges() {
    print_route_info();
    send_Updates_To_Neighbors(create_String_Of_Routes().getBytes());
}

public static void main(String[] args) {
    new Router(Integer.parseInt(args[0]));
} 
```

}

/* * 文件名：NetworkBoot.java * 公共类名：NetworkBoot * */

导入 java.io.IOException；

导入 java.net.DatagramPacket；

导入 java.net.DatagramSocket；

导入java.net.InetAddress；

/** * * NA1 项目 2009 年春季学期 * @author Sunny jain * * */

公共类 NetworkBoot {

```
public static void main(String[] args) {
    try {
        DatagramSocket dSoc = new DatagramSocket(4000, InetAddress.getByName("127.0.0.1"));
        String[] sendD = {"4006:3;4007:5;4009:2;", "4005:3;4007:3;4008:6;", "4005:5;4006:3;", "4009:2;4006:6;", "4008:2;4005:2;"};
        for (int i = 0, port = 4005; i < 5; i++) {
            dSoc.send(new DatagramPacket(sendD[i].getBytes(), sendD[i].length(), InetAddress.getByName("127.0.0.1"), port++));
        }
    } catch (IOException ex) {
        ex.printStackTrace();
    }
} 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T03:49:18.910

我没有在 Java 中做到这一点，但是，您可以（或应该）将多个同时数据报缓冲区传递给套接字（或者使用多个线程，每个线程调用同步接收方法，或者最好使用一个线程调用异步接收方法）不止一次）。

将多个同时的数据报缓冲区传递给套接字的优点是显而易见的：即套接字仍然有一个缓冲区（接收下一个数据报到该缓冲区），即使它已经填充了一个缓冲区（带有前一个数据报）并将该缓冲区传回给你。

您可能会问，“缓冲区将按什么顺序传回给我？” 答案是“没关系”。如果您处理数据报的顺序很重要，那么数据报本身应该包含一个序列号（因为数据报在通过网络路由时可能会出现乱序，无论您是否已经同时将多个传递到本地套接字“同时”收到的结果可能会不按顺序送回给您）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T20:20:03.190

DatagramSocket socket = new DatagramSocket(4445, InetAddress.getByName("127.0.0.1")); while (true) { try { // 注意 final .. final byte[] buf = new byte[2000];

```
 // receive request
    DatagramPacket recvRequest = new DatagramPacket(buf, buf.length);

    socket.receive(recvRequest);

    //Some process of data in datagram
    (new Thread(new Runnable() {
        public void run () {
            // do stuff with data in buf
            ...
        }
    })).start();

} catch (IOException e) {
    e.printStackTrace();
} 
```

}

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T07:13:13.730

值得记住的是 UDP 是有损传输，而尽量减少数据包丢失是一个好主意，您永远不应该假设您会收到每个数据包，（或者数据包将按照您发送它们的顺序到达）

# php - 使用 Curl 登录 meetup.com

> ID：842498
> 
> 赞同：3
> 
> 时间：2009-05-09T01:59:59.110
> 
> 标签：php, curl

我正在尝试自动登录 www.meetup.com，但没有取得多大成功：-

这是我的代码：-

```
 <?
$username="my@email.com";
$password="123abc";
$url="http://meetup.com";
$cookie="cookie.txt";

$postdata = "email=". $username ."&password=". $password . "&submitButton=Login";
$ch = curl_init();
curl_setopt ($ch, CURLOPT_URL, $url . "/login");

curl_setopt ($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
curl_setopt ($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.6");
curl_setopt ($ch, CURLOPT_TIMEOUT, 60);
curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 0);
curl_setopt ($ch, CURLOPT_COOKIEJAR, $cookie);
curl_setopt ($ch, CURLOPT_REFERER, "http://www.meetup.com/");

curl_setopt ($ch, CURLOPT_POSTFIELDS, $postdata);
curl_setopt ($ch, CURLOPT_POST, 1);
$result = curl_exec ($ch);
curl_close($ch);
echo $result;

exit;
?> 
```

没有喜悦——有什么想法吗？

谢谢

乔纳森

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T02:05:17.100

他们可能会在第一次加载页面时给你一个会话 cookie

尝试使用 CURLOPT_COOKIEJAR 发出请求，然后使用 CURLOPT_COOKIEFILE 和 CURLOPT_COOKIEJAR 发出登录请求

也为了它，这是我使请求看起来更清洁的功能

```
function curl_http_request ($url, $options)
{
    $handle = curl_init($url);
    curl_setopt_array($handle, $options);
    ob_start();
    $buffer = curl_exec($handle);
    ob_end_clean();
    curl_close($handle);
    return $buffer;
} 
```

使用示例

```
$options = array(
    CURLOPT_RETURNTRANSFER => TRUE
);

curl_http_request($url, $options); 
```

这应该工作

```
// set global curl options
$curloptions = array(
        CURLOPT_USERAGENT => 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.6',
        CURLOPT_TIMEOUT => 60,
        CURLOPT_COOKIEJAR => $cookie,
        CURLOPT_COOKIEFILE => $cookie,
        CURLOPT_REFERER => 'http://www.meetup.com/'
);

// set userinfo
$username = 'bobsmit@gmail.com';
$password = 'bobsmit@gmail.com';
$cookie = 'cookie.txt';

// clear cookie.txt (fresh session)
$handle = fopen($cookie, 'w');
fclose($handle);

// make a dummy request to generate a session
curl_http_request('http://www.meetup.com/login/', $curloptions);

// login
curl_http_request('http://www.meetup.com/login/', 
    array(
        CURLOPT_POSTFIELDS => 'email=' . urlencode($username) . '&password=' . urlencode($password) . '&rememberme=on&submitButton=Login&returnUri=http%3A%2F%2Fwww.meetup.com%2F&op=login',
        CURLOPT_POST => TRUE
    ), $curloptions
);

//example request
echo curl_http_request('http://www.meetup.com/account/', 
    array(
        CURLOPT_FOLLOWLOCATION => TRUE,
        CURLOPT_RETURNTRANSFER => TRUE
    ), $curloptions
);

function curl_http_request ($url, $moreoptions = array(), $options = array())
{
    foreach ($moreoptions as $k => $v) $options[$k] = $v;
  $handle = curl_init($url);
  curl_setopt_array($handle, $options);
  ob_start();
  $buffer = curl_exec($handle);
  ob_end_clean();
  curl_close($handle);
  return $buffer;
} 
```

希望这个有效:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-19T19:33:07.663

请使用`$url=https://secure.meetup.com`并替换该`curl_setopt ($ch, CURLOPT_REFERER, "http://www.meetup.com/");` 行`curl_setopt ($ch, CURLOPT_REFERER, "");`

所以它会工作......

# javascript - 我应该如何从另一个 js 文件中包含一个 js 文件？

> ID：842504
> 
> 赞同：13
> 
> 时间：2009-05-09T02:05:46.287
> 
> 标签：javascript, reference

从另一个 javascript 文件添加对 javascript 文件的引用的最佳方法是什么？

假设我的网页中包含一个 js 文件。此 javascript 依赖于另一个文件。所以我想在我的 js 文件中引用依赖项，而不是从 html 代码中。我的想法正确吗？

我知道我可以创建一个`script`DOM 元素，然后将其附加到页面，但这对我来说很糟糕。

你有什么建议吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-09T02:19:41.887

`script`据我所知，创建DOM 元素是唯一可用的方法。在检查了 jQuery 和 YUI 的源代码后，我找不到更好的方法。两者都使用这种技术。查看jQuery 中的[globalEval](http://code.jquery.com/jquery-latest.js)函数和 YUI中的 _ [scriptNode 函数](http://yui.yahooapis.com/2.7.0/build/yuiloader/yuiloader.js)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-09T03:08:59.787

```
document.write( '<script language="javascript" src="myotherscript.js" />' ); 
```

# iphone - 扩展多个 CALayer 的性能问题

> ID：842505
> 
> 赞同：0
> 
> 时间：2009-05-09T02:06:19.423
> 
> 标签：iphone, objective-c, calayer, frame-rate

我有两个 CALayer 子类，每个子类都有自己的 drawLayer:(CALayer *)layer inContext:(CGContextRef)ctx 委托。它们都是简单的图层（一些用 CG 路径绘制的单色形状），但我需要同时缩放大约 12 个实例，而且我在帧速率方面遇到了一些问题。我将所有图层标记为不透明以尝试释放一些循环，并尝试使用隐式和显式基本动画（在边界属性本身上），以及将 CA3DTransform 矩阵分配给变换属性。

有谁知道在保持良好帧速率的同时快速调整对象大小的好方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T11:27:28.700

这听起来并不超出 iPhone 的能力范围。

一种解决方案可能是将它们渲染为图像并对其进行缩放？这（或多或少）是 CoreAnimation 会做的事情。听起来你有一个缺陷 - 也许你应该发布你的代码并且人们可以查看它。

你在哪里进行重绘，你在重绘什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T18:03:59.097

我同意罗杰的观点。

检查您的`drawLayer:inContext:`方法（或您用来绘制的任何方法）被调用的频率。一个简单的 NSLog 就可以做到这一点。如果它们不断被调用，请考虑 Roger 的渲染图像并对其进行缩放的想法。

您可能必须启动性能工具才能找到您的瓶颈。

# zend-framework - 使用 Zend Framework 1.8 的引导模块

> ID：842513
> 
> 赞同：0
> 
> 时间：2009-05-09T02:10:49.380
> 
> 标签：zend-framework

我试图弄清楚如何使用自动加载器和 Zend_Application 实现模块化结构。

我的结构没问题，但是对标签 1.8 的最后一次提交停止工作。

[任何人都可以尝试这段代码，看看发生了什么？](https://sites.google.com/site/jorgejorge/base.zip)

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-15T13:12:19.520

你读过[autloading-modular-forms-models-in-zend-framework-18](http://think-robot.com/2009/07/autloading-modular-forms-models-in-zend-framework-18/)吗？我建议在此处发布您的 Bootstrap.php 文件的内容。

# c - 免费的 C 语言 IDE？

> ID：842520
> 
> 赞同：6
> 
> 时间：2009-05-09T02:14:53.847
> 
> 标签：c, ide

谷歌搜索“c ide -C++”会为 C++ 生成太多结果，以及不相关的结果。这些搜索词似乎太短而无法产生相关结果。有没有人有一个免费的 Win32 C IDE 的链接，它可以像 Visual Studio 一样进行逐步调试？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-09T02:18:03.840

Visual Studio 有一个免费的速成版。

[http://www.microsoft.com/express/default.aspx](http://www.microsoft.com/express/default.aspx)

编辑：VS 确实编译 C 和 C++

> Microsoft Visual C++ 是 Microsoft 对 C 和 C++ 编译器和相关语言服务以及与 Visual Studio IDE 集成的特定工具的实现。它可以在 C 模式或 C++ 模式下编译。对于 C，它遵循 ISO C 标准，其中包含 C99 规范的部分内容以及库形式的特定于 MS 的添加。

来源：[http ://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Included_products](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Included_products)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-09T02:29:59.803

Eclipse 有一个[C 开发工具](http://www.eclipse.org/cdt/)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-09T03:55:32.203

尽管似乎很多人没有意识到这一点，但[Netbeans](http://www.netbeans.org/)也有 C++ 插件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-09T02:18:57.723

[Dev-C++](http://www.bloodshed.net/devcpp.html)是用于 c/c++ 的开源 IDE

这是功能列表：

*   支持基于 GCC 的编译器
*   集成调试（使用 GDB）
*   专案经理
*   可定制的语法高亮编辑器
*   类浏览器
*   代码完成
*   功能列表
*   分析支持
*   快速创建 Windows、控制台、静态库和 DLL
*   支持用于创建您自己的项目类型的模板
*   Makefile 创建
*   编辑和编译资源文件
*   工具经理
*   打印支持
*   查找和更换设施
*   CVS 支持

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-09T02:18:58.267

[lcc32](http://www.cs.virginia.edu/~lcc-win32/) ,[铭文工作室](http://en.kioskea.net/telecharger/telecharger-608-mingw-developer-studio)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-09T02:30:54.573

现在很多 IDE 都支持非常多的语言，而且大多数 C++ IDE 都对 C 有很好的支持。

我推荐[Code::Blocks](http://www.codeblocks.org/)，一个免费的、跨平台的 IDE，它支持许多编译器。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-09T02:19:25.850

“C++ IDE”也适用于 C 代码。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-09T02:39:44.817

我应该指出，MSVC 有 C 编译器。如果您将文件命名为 .c，它将使用 C 编译器而不是 C++ 编译器。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-12T14:13:10.407

[打开 Watcom C/C++](http://openwatcom.org/index.php/Main_Page) - 不仅是 IDE，还有用于开发的整套编译器和工具

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-14T00:12:39.977

Eclipse——虽然它笨重且讨厌并且喜欢崩溃，但它可能是免费 IDE 中最好的解决方案。

# visual-studio - 用于测量在解决方案/项目上花费的时间的 Visual Studio 插件

> ID：842524
> 
> 赞同：8
> 
> 时间：2009-05-09T02:18:00.737
> 
> 标签：visual-studio, visual-studio-2008, plugins, project-management, project-planning

有没有人知道一个 Visual Studio (2008) 插件，它试图跟踪您在任何给定的解决方案或项目上花费了多长时间？

我意识到这会很困难，就像在工作中我可能会整天打开解决方案，但只能在它上面工作几个小时，断断续续。

但是在家里，我可能只在处理解决方案时才打开它。

无论如何，有什么东西至少可以尝试跟踪花费的时间吗？一些/任何源代码控制报告是否实现了这一点？

这将是我粗略了解我在一堆项目上花费了多长时间的资源。

干杯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T09:21:20.360

对于个人时间管理，您可以考虑[RescueTime](http://www.rescuetime.com)。它是一个外部监控应用程序，可以收集有关您使用计算机的内容和使用时间的统计信息。

不确定它是否可以区分在 Visual Studio 中打开的不同解决方案，但它可以区分 Office 文档（尽管此功能仅适用于高级帐户）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-04-14T10:37:44.140

你可以试试我最近发布的[Visual Time Spent](http://www.svprogramming.net/visual-time-spent/index.html)插件。它与 Visual Studio 2008/2010 集成并跟踪在解决方案、项目和文件上花费的时间。空闲时间被检测为超过 2 分钟没有活动。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T09:29:03.760

我不知道有什么工具可以完成你正在寻找的东西，我什至认为它不准确（如果有的话）。我仍然会推荐[Hour Guard](http://www.nchsoftware.com/timesheet/index.html)作为个人时间测量工具。它是免费的并且非常有效。

# oracle - PLSQL - 删除用户的所有数据库对象

> ID：842530
> 
> 赞同：18
> 
> 时间：2009-05-09T02:19:29.047
> 
> 标签：oracle, stored-procedures, plsql, schema

我正在尝试使用一个过程（无参数）来删除位于启动该过程的模式中的所有用户创建的数据库对象，但我真的不确定如何去做。这是我到目前为止所拥有的，但我认为我的做法是错误的。

```
 create or replace procedure CLEAN_SCHEMA is
cursor schema_cur is
select 'drop '||object_type||' '|| object_name||  DECODE(OBJECT_TYPE,'TABLE',' CASCADE CONSTRAINTS;',';')
from user_objects;
schema_rec schema_cur%rowtype;
begin
select 'drop '||object_type||' '|| object_name||  DECODE(OBJECT_TYPE,'TABLE',' CASCADE CONSTRAINTS;',';')
into schema_rec
from user_objects;
end;
/ 

```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-10-19T13:48:06.783

```
create or replace
FUNCTION                DROP_ALL_SCHEMA_OBJECTS RETURN NUMBER AS
PRAGMA AUTONOMOUS_TRANSACTION;
cursor c_get_objects is
  select object_type,'"'||object_name||'"'||decode(object_type,'TABLE' ,' cascade constraints',null) obj_name
  from user_objects
  where object_type in ('TABLE','VIEW','PACKAGE','SEQUENCE','SYNONYM', 'MATERIALIZED VIEW')
  order by object_type;
cursor c_get_objects_type is
  select object_type, '"'||object_name||'"' obj_name
  from user_objects
  where object_type in ('TYPE');
BEGIN
  begin
    for object_rec in c_get_objects loop
      execute immediate ('drop '||object_rec.object_type||' ' ||object_rec.obj_name);
    end loop;
    for object_rec in c_get_objects_type loop
      begin
        execute immediate ('drop '||object_rec.object_type||' ' ||object_rec.obj_name);
      end;
    end loop;
  end;
  RETURN 0;
END DROP_ALL_SCHEMA_OBJECTS; 
```

创建上面的函数（自治的所以可以通过函数调用 DDL）然后你可以：

```
select DROP_ALL_SCHEMA_OBJECTS from dual; 
```

当您想删除所有对象时，请确保不要尝试删除正在运行的过程（我不关心过程，这就是为什么我在 object_type 列表中没有过程或函数）

如果你想放弃所有你需要的匿名块

但我需要能够从只允许 ansi sql（而不是 plsql）的工具执行此操作，因此是存储过程。

享受。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-11T11:40:48.387

```
declare
  cursor ix is
    select *
      from user_objects
     where object_type in ('TABLE', 'VIEW', 'FUNCTION', 'SEQUENCE');
begin
 for x in ix loop
   execute immediate('drop '||x.object_type||' '||x.object_name);
 end loop;
end; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-17T06:20:37.647

谢谢马丁·布兰布利，

我觉得我们可以通过以下方式简化您的答案。

```
CREATE OR REPLACE
procedure  DROP_ALL_SCHEMA_OBJECTS AS
PRAGMA AUTONOMOUS_TRANSACTION;
cursor c_get_objects is
  select object_type,'"'||object_name||'"'||decode(object_type,'TABLE' ,' cascade constraints',null) obj_name
  FROM USER_OBJECTS
  where object_type in ('TABLE','VIEW','PACKAGE','SEQUENCE','SYNONYM', 'MATERIALIZED VIEW', 'TYPE')
  order by object_type;
BEGIN
  begin
    for object_rec in c_get_objects loop
      execute immediate ('drop '||object_rec.object_type||' ' ||object_rec.obj_name);
    end loop;
  end;
END DROP_ALL_SCHEMA_OBJECTS;

/

execute DROP_ALL_SCHEMA_OBJECTS; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-09T02:30:44.557

除非用户很难重新申请权限，否则删除用户并重新创建它们可能更容易。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T04:36:19.920

你所拥有的是一个好的开始。

这是其余的：

*   您有一个游标和一个选择语句。您只需要光标。
*   下一步是使用动态 PLSQL 调用 drop 语句。我会使用 EXECUTE IMMEDIATE 语句。只需选择要删除的内容的名称并将其作为绑定变量提交给 EXECUTE IMMEDIATE，它就更加优雅和性能友好。
*   为了删除调用该方法的架构对象而不是拥有该方法的架构，您必须使用“AUTHID CURRENT_USER”。有关详细信息，请参阅[Oracle 文档](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14261/subprograms.htm#i18574)。
*   其他要删除的东西：包、函数、过程（如果您在运行时尝试删除此方法，系统可能会挂起然后超时）、Java 类、触发器、视图、类型

最后，这显然是一种非常危险的方法，因此您可能需要考虑将其放入脚本而不是存储过程中，这样它就不会留在数据库中供任何人运行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-10T11:51:24.960

你很接近 - 正如其他人指出的那样，你需要一个“立即执行”的语句。你应该考虑：

*   与其创建一个过程来执行此操作，不如将其作为匿名 PL/SQL 块运行，这样您就不会遇到尝试删除正在运行的过程的问题。

*   添加对 TABLE 对象类型的测试，并在这种情况下修改 drop 语句以包含级联选项以通过外键约束处理作为其他表的“父级”的表。请记住，您可能会以不考虑会阻止删除的依赖项的顺序生成游标列表。

*   同样在依赖关系的主题上，最好先删除表（在游标中添加一个 DECODE，为该对象类型分配一个较低的数值，并按此值排序游标选择）。如果您有 TYPE 类型的 Oracle 对象用作表定义中的列类型，则必须首先删除该表。

*   如果您使用 Oracle Advanced Queuing，则必须使用 AQ 包 API 调用删除与此相关的对象。尽管您可以使用常规的 DROP TABLE 删除 Oracle 生成的表以支持队列，但您会发现自己处于无法删除相关队列或将它们添加回来的第 22 条位置。至少到 10g 版本，当这种情况存在时，如果不将数据库置于特殊模式，您甚至无法删除包含模式

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-03-02T14:26:10.453

感谢**Martin Brambley**和**Vijayan Srinivasan**！

但是 Vijayan Srinivasan 的版本是不正确的，因为 'TYPE' 类型的依赖对象有时会在删除它们时产生错误：

> ORA-02303: 不能用类型或表依赖项删除或替换类型

我的版本从 Schema 中删除所有对象，并附加：

*   删除过程和函数（期望 'DROP_ALL_SCHEMA_OBJECTS'）
*   删除所有作业和 dbms_jobs
*   删除所有 db_links
*   不要删除嵌套表，因为*不支持删除嵌套表*

```
创建或替换
程序 DROP_ALL_SCHEMA_OBJECTS AS
PRAGMA AUTONOMOUS_TRANSACTION;
游标 c_get_objects 是
  select uo.object_type object_type_2,'"'||uo.object_name||'"'||decode(uo.object_type,'TABLE','级联约束',null) obj_name2
  FROM USER_OBJECTS uo
  其中 uo.object_type 在（'TABLE'，'VIEW'，'PACKAGE'，'SEQUENCE'，'SYNONYM'，'MATERIALIZED VIEW'，'FUNCTION'，'PROCEDURE'）
        而不是（uo.object_type = 'TABLE' 并且存在（从 user_nested_tables unt 中选择 1，其中 uo.object_name = unt.table_name））
        而不是（uo.object_type = 'PROCEDURE' 和 uo.object_name = 'DROP_ALL_SCHEMA_OBJECTS'）
  按 uo.object_type 排序；
游标 c_get_objects_type 是
  选择 object_type, '"'||object_name||'"' obj_name
  来自用户对象
  其中 object_type in ('TYPE');
游标 c_get_dblinks 是
  选择 '"'||db_link||'"' obj_name
  来自 user_db_links；
游标 c_get_jobs 是
  选择 '"'||object_name||'"' obj_name
  来自用户对象
  其中 object_type = '工作';
游标 c_get_dbms_jobs 是
  选择工作 obj_number_id
  来自 user_jobs
  其中 schema_user != 'SYSMAN';
开始
  开始
    c_get_objects 循环中的 object_rec
      立即执行 ('drop '||object_rec.object_type_2||' ' ||object_rec.obj_name2);
    结束循环；
    c_get_objects_type 循环中的 object_rec
      开始
        立即执行 ('drop '||object_rec.object_type||' ' ||object_rec.obj_name);
      结尾;
    结束循环；
    c_get_dblinks 循环中的 object_rec
        立即执行('删除数据库链接'||object_rec.obj_name);
    结束循环；
    c_get_jobs 循环中的 object_rec
        DBMS_SCHEDULER.DROP_JOB(job_name => object_rec.obj_name);
    结束循环；
    犯罪;
    c_get_dbms_jobs 循环中的 object_rec
        dbms_job.remove(object_rec.obj_number_id);
    结束循环；
    犯罪;
  结尾;
结束 DROP_ALL_SCHEMA_OBJECTS；

/

执行 DROP_ALL_SCHEMA_OBJECTS；
删除程序 DROP_ALL_SCHEMA_OBJECTS；

出口;

```

# c# - 在 C# 中，我如何查询 Windows 服务器上正在运行的服务列表？

> ID：842533
> 
> 赞同：27
> 
> 时间：2009-05-09T02:22:55.590
> 
> 标签：c#, windows

我想查询在远程机器上作为特定用户运行的服务列表，然后检查每个服务的运行状况。我正在构建一个自定义控制台。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-05-09T02:37:35.680

**`ServiceController.GetServices("machineName")`**`ServiceController`返回特定机器的对象数组。

这个：

```
namespace AtYourService
{
    using System;
    using System.ServiceProcess;

    class Program
    {
        static void Main(string[] args)
        {
            ServiceController[] services = ServiceController.GetServices();

            foreach (ServiceController service in services)
            {
                Console.WriteLine(
                    "The {0} service is currently {1}.",
                    service.DisplayName,
                    service.Status);
            }

            Console.Read();
        }
    }
} 
```

产生：

```
The Application Experience service is currently Running.

The Andrea ST Filters Service service is currently Running.

The Application Layer Gateway Service service is currently Stopped.

The Application Information service is currently Running.

etc... 
```

当然，我使用无参数版本在我的机器上获取服务。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-09T03:07:34.813

要使用 ServiceController 方法，我将查看在上一个问题中实现的模拟解决方案：[.Net 2.0 服务控制器.GetServices()](https://stackoverflow.com/questions/210296/net-2-0-servicecontroller-getservices/212673#212673)

FWIW，这是带有显式主机、用户名、密码的 C#/WMI 方式：

```
using System.Management;

static void EnumServices(string host, string username, string password)
{
    string ns = @"root\cimv2";
    string query = "select * from Win32_Service";

    ConnectionOptions options = new ConnectionOptions();
    if (!string.IsNullOrEmpty(username))
    {
        options.Username = username;
        options.Password = password;
    }

    ManagementScope scope = 
        new ManagementScope(string.Format(@"\\{0}\{1}", host, ns), options);
    scope.Connect();

    ManagementObjectSearcher searcher = 
        new ManagementObjectSearcher(scope, new ObjectQuery(query));
    ManagementObjectCollection retObjectCollection = searcher.Get();
    foreach (ManagementObject mo in retObjectCollection)
    {
        Console.WriteLine(mo.GetText(TextFormat.Mof));
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-09T02:24:15.760

您可以为此使用 wmi (System.Management)。您也可以使用`ServiceController.GetServices()`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-16T08:21:35.593

这将使用您可以在参数中提及的所需服务名称检查您的系统服务名称

```
namespace ServiceName
{
using System;
using System.ServiceProcess;

class Service
{

public static bool IsServiceInstalled(string serviceName)
{

 ServiceController[] services = ServiceController.GetServices();

 foreach (ServiceController service in services)
 {
   if (service.ServiceName == serviceName)
     return true;
 }
 return false;
   }
 }
 } 
```

# java - 将相对目录添加到 java 类路径并使用 ClassLoader().getResourceAsStream("")

> ID：842538
> 
> 赞同：5
> 
> 时间：2009-05-09T02:25:15.413
> 
> 标签：java, directory, classpath, classloader

是否可以将相对目录（即 foo/bar/plugh）添加到 java 类路径并使用

```
InputStream in = getClassLoader().getResourceAsStream("xyzzy.properties"); 
```

获取 foo/bar/plugh/xyzzy.properties？

我的类路径如下所示：

```
foo.jar;foo/bar/plugh;xyz.jar 
```

而且我可以使用 foo 和 xyz jar 中的类和资源，但不能使用 plugh 目录中的类和资源。在这些情况下，`in`始终为空。

我无法让它工作，并且不确定这是否只是不受支持，我错过了一些微妙的东西，或者我做错了什么。我需要使用绝对路径吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T02:39:21.917

也许我误解了你想要做什么，但如果你的类路径中有一个文件夹，这意味着它下面的所有文件也应该在类路径中。如果没有，您始终可以在类路径上传递每个 .properties 文件。

但无论哪种方式，由于包含该文件的文件/文件夹位于类路径中，您应该能够做到：

```
InputStream in = new FileInputStream("classpath:xyz.properties") 
```

并且由于“foo/bar/plugh”在类路径中，它会查找 xyz.properties 的位置之一是“foo/bar/plugh”。

# c# - 如何获取应用程序的活动 ChildWindow？

> ID：842539
> 
> 赞同：4
> 
> 时间：2009-05-09T02:25:28.410
> 
> 标签：c#, winapi, keypress, user32, childwindow

我想向某个不是 Windows 中的活动应用程序的应用程序发送一个 pressKey 事件，所以我必须使用 sendMessage/postMessage api 调用。

但是，我需要知道在应用程序中处于活动状态的确切子窗口并向其发送 pressKey 消息...

我正在使用 GetTopWindow 和 GetWindow(GW_CHILD) api调用来获取主窗口的顶部子窗口，并使用获得的子窗口再次执行以获取顶部的孙子窗口，并继续这样做直到我找到一个没有更多子窗口的子窗口. 这对某些应用程序非常有用，但在某些情况下则不然。有时父窗口是活动窗口，而不是其子窗口之一，因此获取父窗口的顶部子窗口将不起作用，因为我将向错误的窗口发送消息。

我发现这样做的唯一方法（获取实际活动窗口的处理程序）是使用 GuiThreadInfo api 调用，但它仅在目标应用程序是 Windows 中的活动应用程序时才有效。正如我在开头提到的那样，处理程序并非如此。

我可以使用 setForegroundWindow api 调用将应用程序置于顶部，但我不想这样做。我还尝试了 AttachThreadInput 和 GetFocus api 调用，但同样，它们仅在目标应用程序是 Windows 中的活动应用程序时才有效。

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T00:22:54.727

我从您尝试过的事情中假设您知道如何获取主窗口的句柄，但如果您不只是发表评论，我会为此发布一个片段。

我结合了我在网上找到的一些东西来解决这个问题，但主要的是[这个](http://blogs.msdn.com/oldnewthing/archive/2007/10/08/5351207.aspx)。我没有一个很好的应用程序来测试它，但它适用于一个简单的案例。一个例外是，我认为如果您在应用程序中使用工具窗口，它不会在编码时发现它，因为我认为 GetLastActivePopup 方法不包括它们（不确定，也没有测试这种情况）。

```
[DllImport("user32.dll")]
[return: MarshalAs(UnmanagedType.Bool)]
static extern bool IsWindowVisible(IntPtr hWnd);

[DllImport("user32.dll")]
static extern IntPtr GetLastActivePopup(IntPtr hWnd);

[DllImport("user32.dll", ExactSpelling = true)]
static extern IntPtr GetAncestor(IntPtr hwnd, uint gaFlags);

const uint GA_PARENT = 1;
const uint GA_ROOT = 2;
const uint GA_ROOTOWNER = 3;

    public static IntPtr GetAppActiveWindow(IntPtr hwnd)
    {
        IntPtr activeAppWindow = IntPtr.Zero;

        if (hwnd != IntPtr.Zero)
        {
            //Get the root owner window (make sure we are at the app window
            //if you already have a handle to the main window shouldn't have 
            //to do this but I put it in just in case
            hwnd = GetAncestor(hwnd, GA_ROOTOWNER);

            while ((activeAppWindow = 
                      GetLastActivePopup(hwnd)) != activeAppWindow)
            {
                if (IsWindowVisible(activeAppWindow))
                    break;
                hwnd = activeAppWindow;
            }
        }

        return activeAppWindow;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T01:57:20.490

如果您知道 Window 标题和 Window 类名，请查看 FindWindow() 和 FindWindowEx() 看看它们是否满足您的需求。

FindWindow()： http: [//msdn.microsoft.com/en-us/library/ms633499.aspx](http://msdn.microsoft.com/en-us/library/ms633499.aspx)
FindWindowEx()： http://msdn.microsoft.com/en-us/library/ms633500(VS.85 [)。 aspx](http://msdn.microsoft.com/en-us/library/ms633500(VS.85).aspx)

# iis-7 - IIS 7 压缩

> ID：842555
> 
> 赞同：0
> 
> 时间：2009-05-09T02:43:56.930
> 
> 标签：iis-7

我知道 IIS 允许您压缩作为服务器的文件。知道压缩比是多少吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T02:56:21.813

压缩总是在很大程度上取决于您要压缩的内容。例如，HTML 文件将比 JPEG 文件缩小得多。

此外，服务器和 Web 浏览器都必须支持一种压缩方法，才能在 HTTP 传输中使用这种压缩方法。**gzip**和**deflate**是最常见的（请参阅[此页面](http://en.wikipedia.org/wiki/HTTP_compression)）。压缩率取决于使用的方法以及被压缩的实际数据。

# python - Python中如何防止一段代码被KeyboardInterrupt打断？

> ID：842557
> 
> 赞同：69
> 
> 时间：2009-05-09T02:47:10.727
> 
> 标签：python

我正在编写一个通过 pickle 模块缓存一些结果的程序。`dump`目前发生的情况是，如果我在操作发生时按 ctrl-c，则会`dump`被中断并且生成的文件已损坏（即仅部分写入，因此无法`load`再次编辑。

有没有办法使`dump`，或者一般来说是一段代码，不可中断？我当前的解决方法如下所示：

```
try:
  file = open(path, 'w')
  dump(obj, file)
  file.close()
except KeyboardInterrupt:
  file.close()
  file.open(path,'w')
  dump(obj, file)
  file.close()
  raise 
```

如果中断了重新启动操作似乎很愚蠢，所以我正在寻找一种推迟中断的方法。我该怎么做呢？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2014-02-20T21:09:02.450

下面是一个上下文管理器，它为`SIGINT`. 如果调用上下文管理器的信号处理程序，则仅在上下文管理器退出时将信号传递给原始处理程序来延迟信号。

```
import signal
import logging

class DelayedKeyboardInterrupt:

    def __enter__(self):
        self.signal_received = False
        self.old_handler = signal.signal(signal.SIGINT, self.handler)

    def handler(self, sig, frame):
        self.signal_received = (sig, frame)
        logging.debug('SIGINT received. Delaying KeyboardInterrupt.')

    def __exit__(self, type, value, traceback):
        signal.signal(signal.SIGINT, self.old_handler)
        if self.signal_received:
            self.old_handler(*self.signal_received)

with DelayedKeyboardInterrupt():
    # stuff here will not be interrupted by SIGINT
    critical_code() 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-05-09T02:57:23.497

将函数放入线程中，并等待线程完成。

除非使用特殊的 C api，否则不能中断 Python 线程。

```
import time
from threading import Thread

def noInterrupt():
    for i in xrange(4):
        print i
        time.sleep(1)

a = Thread(target=noInterrupt)
a.start()
a.join()
print "done"

0
1
2
3
Traceback (most recent call last):
  File "C:\Users\Admin\Desktop\test.py", line 11, in <module>
    a.join()
  File "C:\Python26\lib\threading.py", line 634, in join
    self.__block.wait()
  File "C:\Python26\lib\threading.py", line 237, in wait
    waiter.acquire()
KeyboardInterrupt 
```

看看中断是如何延迟到线程完成的？

在这里它适合您的使用：

```
import time
from threading import Thread

def noInterrupt(path, obj):
    try:
        file = open(path, 'w')
        dump(obj, file)
    finally:
        file.close()

a = Thread(target=noInterrupt, args=(path,obj))
a.start()
a.join() 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-05-09T06:26:34.710

使用[信号](http://docs.python.org/library/signal.html)模块在进程期间禁用 SIGINT：

```
s = signal.signal(signal.SIGINT, signal.SIG_IGN)
do_important_stuff()
signal.signal(signal.SIGINT, s) 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-09T11:49:51.580

在我看来，为此使用线程是一种矫枉过正。您可以通过简单地循环执行直到成功写入来确保文件被正确保存：

```
def saveToFile(obj, filename):
    file = open(filename, 'w')
    cPickle.dump(obj, file)
    file.close()
    return True

done = False
while not done:
    try:
        done = saveToFile(obj, 'file')
    except KeyboardInterrupt:
        print 'retry'
        continue 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-03-20T03:32:46.910

这个问题是关于阻塞的`KeyboardInterrupt`，但对于这种情况，我发现原子文件写入更干净并提供额外的保护。

使用原子写入，要么正确写入整个文件，要么不正确写入。Stackoverflow 有[多种解决方案](https://stackoverflow.com/questions/2333872/atomic-writing-to-file-with-python)，但我个人喜欢只使用[atomicwrites](https://pypi.org/project/atomicwrites/)库。

运行后`pip install atomicwrites`，只需像这样使用它：

```
from atomicwrites import atomic_write

with atomic_write(path, overwrite=True) as file:
    dump(obj, file) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-10-04T16:59:26.697

一种通用的方法是使用一个上下文管理器，它接受一组信号来挂起：

```
import signal

from contextlib import contextmanager

@contextmanager
def suspended_signals(*signals):
    """
    Suspends signal handling execution
    """
    signal.pthread_sigmask(signal.SIG_BLOCK, set(signals))
    try:
        yield None
    finally:
        signal.pthread_sigmask(signal.SIG_UNBLOCK, set(signals)) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-03-02T23:22:54.683

我一直在思考对这个问题的答案的批评，我相信我已经实施了一个更好的解决方案。上下文管理器在下面`signal_fence`，然后解释了它对先前答案的改进。请阅读此函数的文档字符串以更好地了解其接口和保证。

```
@contextmanager
def signal_fence(
    signum: signal.Signals,
    *,
    on_deferred_signal: Callable[[int, Optional[FrameType]], None] = None,
) -> Iterator[None]:
    """
    A `signal_fence` creates an uninterruptible "fence" around a block of code. The
    fence defers a specific signal received inside of the fence until the fence is
    destroyed, at which point the original signal handler is called with the deferred
    signal. Multiple deferred signals will result in a single call to the original
    handler. An optional callback `on_deferred_signal` may be specified which will be
    called each time a signal is handled while the fence is active, and can be used
    to print a message or record the signal.

    A `signal_fence` guarantees the following with regards to exception-safety:

    1\. If an exception occurs prior to creating the fence (installing a custom signal
    handler), the exception will bubble up as normal. The code inside of the fence will
    not run.
    2\. If an exception occurs after creating the fence, including in the fenced code,
    the original signal handler will always be restored before the exception bubbles up.
    3\. If an exception occurs while the fence is calling the original signal handler on
    destruction, the original handler may not be called, but the original handler will
    be restored. The exception will bubble up and can be detected by calling code.
    4\. If an exception occurs while the fence is restoring the original signal handler
    (exceedingly rare), the original signal handler will be restored regardless.
    5\. There is a one opcode window where an exception will prevent the original
    handler from being restored (even less likely than #4). This is unavoidable, but
    the exception will bubble up and can be detected by calling code.
    6\. No guarantees about the fence's behavior are made if exceptions occur while
    exceptions are being handled.

    A `signal_fence` can only be used on the main thread, or else a `ValueError` will
    raise on creation.
    """
    handled: Optional[Tuple[int, Optional[FrameType]]] = None

    def handler(signum: int, frame: Optional[FrameType]) -> None:
        nonlocal handled
        if handled is None:
            handled = (signum, frame)
        if on_deferred_signal is not None:
            try:
                on_deferred_signal(signum, frame)
            except:
                pass

    # https://docs.python.org/3/library/signal.html#signal.getsignal
    original_handler = signal.getsignal(signum)
    if original_handler is None:
        raise ValueError(
            "signal_fence cannot be used with signal handlers that were not installed"
            " from Python"
        )
    if isinstance(original_handler, int) and not isinstance(
        original_handler, signal.Handlers
    ):
        raise NotImplementedError(
            "Your Python interpreter's signal module is using raw integers to"
            " represent SIG_IGN and SIG_DFL, which shouldn't be possible!"
        )

    # N.B. to best guarantee the original handler is restored, the @contextmanager
    #      decorator is used rather than a class with __enter__/__exit__ methods so
    #      that the installation of the new handler can be done inside of a try block,
    #      whereas per [PEP 343](https://www.python.org/dev/peps/pep-0343/) the
    #      __enter__ call is not guaranteed to have a corresponding __exit__ call if an
    #      exception interleaves
    try:
        signal.signal(signum, handler)
        try:
            yield
        finally:
            if handled is not None:
                if isinstance(original_handler, signal.Handlers):
                    if original_handler is signal.Handlers.SIG_IGN:
                        pass
                    elif original_handler is signal.Handlers.SIG_DFL:
                        signal.signal(signum, signal.SIG_DFL)
                        os.kill(os.getpid(), signum)
                    else:
                        assert_never(original_handler)
                elif callable(original_handler):
                    original_handler(*handled)
                else:
                    assert_never(original_handler)
    finally:
        # N.B. there is a one opcode window in between the start of this finally block
        #      and the SETUP_EXCEPT (`try:`) where an exception on this thread could
        #      prevent the original handler from being restored. This is unavoidable
        #      and simply the reality of using a language like Python.
        # N.B. designing for the use case of "one solitary KeyboardInterrupt", it is
        #      necessary to try-except the restoration of the original handler
        try:
            signal.signal(signum, original_handler)
        except:
            signal.signal(signum, original_handler)
            raise 
```

一个完整的模块可以在这个要点中找到：[https ://gist.github.com/bbatliner/d5b99ca20ce434e2f9ebfdb06a87ac79](https://gist.github.com/bbatliner/d5b99ca20ce434e2f9ebfdb06a87ac79)

首先，为什么不使用线程（接受的答案）？在非守护线程中运行代码确实保证线程将在解释器关闭时加入，但主线程（例如`KeyboardInterrupt`）上的任何异常都不会阻止主线程继续执行。考虑一下如果线程方法正在使用主线程`finally`在`KeyboardInterrupt`.

其次，使用上下文管理器解决[@benrg](https://stackoverflow.com/users/5670773/benrg)对最受好评的答案的反馈：

> 1.  如果在调用信号之后但在返回之前引发异常`__enter__`，则信号将被永久阻塞；

`@contextmanager`我的解决方案通过在装饰器的帮助下使用生成器上下文管理器来避免这个错误。有关更多详细信息，请参阅要点或上方的[完整评论](https://gist.github.com/bbatliner/d5b99ca20ce434e2f9ebfdb06a87ac79#file-signal_fence-py-L75)。

> 2.  此代码可能会在主线程以外的线程中调用第三方异常处理程序，而 CPython 绝不会这样做；

我不认为这个错误是真实的。`signal.signal`需要从主线程调用，`ValueError`否则引发。这些上下文管理器只能在主线程上运行，因此只会从主线程调用第三方异常处理程序。

> 3.  如果信号返回一个不可调用的值，`__exit__`将崩溃

我的解决方案处理信号处理程序的所有可能值并适当地调用它们。此外，我[`assert_never`](https://hakibenita.com/python-mypy-exhaustive-checking)还受益于静态分析器中的详尽检查。

请注意，`signal_fence`它旨在处理主线程上的**一个**中断，例如`KeyboardInterrupt`. 如果您的用户正在发送垃圾邮件 Ctrl+C，那么没有什么可以为您节省的。

我已经对该代码进行了全面的单元测试，并相信它是迄今为止最强大的解决方案。

# search - 无法在 Zsh 的 Man 的 TAB 完成中进行两个词搜索

> ID：842558
> 
> 赞同：0
> 
> 时间：2009-05-09T02:48:17.107
> 
> 标签：search, zsh, zsh-completion

**问题：**有一个制表符补全，它接受两个单词并从中为 Man 计算最佳匹配，然后返回最佳匹配

**示例：**下面的伪代码至少应该给我 Zsh 的 reverse-menu-complete 命令。现在，如果没有 zgrep，我无法在手册中搜索手册。

```
man zsh:reverse <TAB> 
```

其中“：”是我想要的分隔符。

**初始问题：**当我在 Zsh 搜索手册中按 TAB 一个单词时，TAB 完成会运行哪些文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T07:47:17.067

我将尝试提供有关 zsh 补全系统如何工作的见解以及对这个问题的不完全理解。

在 zsh 中使用 TAB 补全时运行的文件`man`位于该`/usr/share/zsh/${ZSH_VERSION}/functions`目录下。树因分布而异，但文件名为，并为、和`_man`提供补全。`man``apropos``whatis`

_man 被调用后，它的工作方式如下（粗略描述）：

1.  如果完成`man`并被`--local-file`指定为第一个标志，则调用标准文件完成（`_files`）
2.  `manpath`从一组默认值 /构造变量`$MANPATH`。这是将搜索联机帮助页的地方
3.  确定我们是否`man`使用节号参数调用，如果是 - 仅搜索那些节
4.  如果`zstyle ':completion:*:manuals' separate-sections true`使用了，则在输出中单独的部分（不要在它们之间混合）
5.  调用`_man_pages`以提供匹配的手册页列表
6.  `_man_pages`现在对`compfiles -p pages '' '' "$matcher" '' dummy '*'`. `pages`是所有目录的变量，其中包含所请求部分的联机帮助页。实际的通配模式是由隐式参数`$PREFIX`和最后一个参数构造的`compfiles`-`*`在这种情况下。这导致`/usr/share/man/man1`被转换为`/usr/share/man/man1/foo*`
7.  新的 glob 模式列表是 glob 的，获取与该模式匹配的所有文件
8.  `_man_pages`然后从文件中删除任何后缀并将它们添加到选择的完成小部件列表中`compadd`

现在，如您所见，联机帮助页列表直接由`$PREFIX`变量确定。为了`zsh:foo`仅列出`zsh*`包含单词的手册页`foo`，需要将其拆分为`:`字符（如果有）。

以下添加`_man_pages`部分解决了该问题（zsh 4.3.4）：

原来的：

```
_man_pages() {
  local matcher pages dummy sopt

  zparseopts -E M+:=matcher

  if (( $#matcher )); then
    matcher=( ${matcher:#-M} )
    matcher="$matcher"
  else
    matcher=
  fi

  pages=( ${(M)dirs:#*$sect/} )

  compfiles -p pages '' '' "$matcher" '' dummy '*'
  pages=( ${^~pages}(N:t) )

  (($#mrd)) && pages[$#pages+1]=($(awk $awk $mrd))

  # Remove any compression suffix, then remove the minimum possible string
  # beginning with .<->: that handles problem cases like files called
  # `POSIX.1.5'.

  [[ $OSTYPE = solaris* ]] && sopt='-s '
  if ((CURRENT > 2)) ||
      ! zstyle -t ":completion:${curcontext}:manuals.$sect" insert-sections
  then
    compadd "$@" - ${pages%.(?|<->*(|.gz|.bz2|.Z))}
  else
    compadd "$@" -P "$sopt$sect " - ${pages%.(?|<->*(|.gz|.bz2|.Z))}
  fi
} 
```

修改（查找##mod 评论）：

```
_man_pages() {
  local matcher pages dummy sopt

  zparseopts -E M+:=matcher

  if (( $#matcher )); then
    matcher=( ${matcher:#-M} )
    matcher="$matcher"
  else
    matcher=
  fi

  pages=( ${(M)dirs:#*$sect/} )

  ##mod
  # split components by the ":" character
  local pref_words manpage_grep orig_prefix
  # save original prefix (just in case)
  orig_prefix=${PREFIX}
  # split $PREFIX by ':' and make it an array
  pref_words=${PREFIX//:/ }
  set -A pref_words ${=pref_words}
  # if there are both manpage name and grep string, use both
  if (( $#pref_words == 2 )); then
      manpage_grep=$pref_words[2]
      # PREFIX is used internally by compfiles
      PREFIX=$pref_words[1]
  elif (( $#pref_words == 1 )) && [[ ${PREFIX[1,1]} == ":" ]]; then
      # otherwise, prefix is empty and only grep string exists
      PREFIX=
      manpage_grep=$pref_words[1]
  fi

  compfiles -p pages '' '' "$matcher" '' dummy '*'
  ##mod: complete, but don't strip path names
  pages=( ${^~pages} )

  (($#mrd)) && pages[$#pages+1]=($(awk $awk $mrd))

  ##mod: grep pages
  # Build a list of matching pages that pass the grep
  local matching_pages
  typeset -a matching_pages

  # manpage_grep exists and not empty 
  if (( ${#manpage_grep} > 0 )); then
      for p in ${pages}; do
          zgrep "${manpage_grep}" $p > /dev/null
          if (( $? == 0 )); then
              #echo "$p matched $manpage_grep"
              matching_pages+=($p)
          fi
      done
  else
  # there's no manpage_grep, so all pages match
      matching_pages=( ${pages} )
  fi

  #echo "\nmatching manpages: "${matching_pages}
  pages=( ${matching_pages}(N:t) )
  # keep the stripped prefix for now
  #PREFIX=${orig_prefix}

  # Remove any compression suffix, then remove the minimum possible string
  # beginning with .<->: that handles problem cases like files called
  # `POSIX.1.5'.

  [[ $OSTYPE = solaris* ]] && sopt='-s '
  if ((CURRENT > 2)) ||
      ! zstyle -t ":completion:${curcontext}:manuals.$sect" insert-sections
  then
    compadd "$@" - ${pages%.(?|<->*(|.gz|.bz2|.Z))}
  else
    compadd "$@" -P "$sopt$sect " - ${pages%.(?|<->*(|.gz|.bz2|.Z))}
  fi
} 
```

但是，它仍然没有完全工作（如果取消注释该`#echo "$p matched $manpage_grep"`行，您可以看到它确实构建了列表） - 我怀疑在内部某个地方，完成系统看到，例如，“zshcompctl”与前缀“zsh”不匹配:foo"，并且不显示结果匹配。在剥离 grep 字符串后，我试图保持`$PREFIX`原样，但它仍然不想工作。

At any rate, this at least should get you started.

# javascript - 如何强制 XUL 树在代码中滚动？

> ID：842559
> 
> 赞同：0
> 
> 时间：2009-05-09T02:48:44.140
> 
> 标签：javascript, xul

我有一个用 XUL 编写的应用程序，其中包含一个包含许多项目的自定义树视图。我有一个允许删除所选项目的按钮，但我的问题是，每当按下此按钮时，树都会一直滚动到顶部。我试图通过重新选择旧索引处的项目来解决这个问题，但不幸的是这不会滚动视图。有没有办法让树视图不滚动到顶部或强制它重新滚动回原始位置？

我的代码看起来像这样：

```
onRemoveNilSelection: function(event) {
  var selectedIndex = this._tree.currentIndex;
  this._treeView.removeItem(selectedIndex);
  this._tree.view = this._treeView;
  this._treeView.selection.select(selectedIndex);
}, 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T15:44:57.083

使用[boxObject 的 scrollToRow() 函数](https://developer.mozilla.org/en/XUL_Tutorial/Tree_Box_Objects#Scrolling_the_Tree)。

如果你的树在 this._tree 上，

```
this._tree.boxObject.scrollToRow(selectedIndex); 
```

# c++ - LSB AppChecker：针对未使用库的 GCC 链接

> ID：842563
> 
> 赞同：3
> 
> 时间：2009-05-09T02:52:58.077
> 
> 标签：c++, linux, gcc, shared-libraries, portability

我正在使用 LSB AppChecker 检查共享对象 (.so) 的可移植性。
它报告的问题之一是有一个外部库（libm.so.6）没有被使用，但无论如何都链接到了。

如何防止 GCC 链接到这个不需要的库？

**编辑：**
ldd 命令对我的共享对象的输出是：

```
 linux-gate.so.1 =>  (0x009ff000)
    libstdc++.so.6 => /usr/lib/libstdc++.so.6 (0x003dc000)
    libm.so.6 => /lib/libm.so.6 (0x00110000)
    libgcc_s.so.1 => /lib/libgcc_s.so.1 (0x00137000)
    libc.so.6 => /lib/libc.so.6 (0x0021d000)
    /lib/ld-linux.so.2 (0x0097f000) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T04:45:58.477

将 -Wl,-as-needed 参数作为链接器命令行的一部分传递。这将自动删除您实际上没有使用符号的任何直接库依赖项。

```
$ g++ -o test test.cpp -lm; readelf -d test|grep '(NEEDED)'
 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
$ g++ -o test test.cpp -lm -Wl,-as-needed; readelf -d test|grep '(NEEDED)'                                                                    
 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6] 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-09T04:24:05.847

除非您在自己的链接命令中指定 -lm，否则您正在使用的另一个库可能依赖于数学库。从这个问题被标记为 c++ 的事实来看，您可能会将其视为与 libstdc++ 链接的副作用，并且您无能为力。

```
% ldd /usr/lib/libstdc++.so.6                                                                                      
        linux-gate.so.1 =>  (0x4001e000)
        libm.so.6 => /lib/tls/i686/cmov/libm.so.6 (0x40127000)
        libc.so.6 => /lib/tls/i686/cmov/libc.so.6 (0x4014d000)
        /lib/ld-linux.so.2 (0x40000000)
        libgcc_s.so.1 => /lib/libgcc_s.so.1 (0x402b1000) 
```

# windows-vista - 在 Vista 中修改文件类型的动词

> ID：842566
> 
> 赞同：1
> 
> 时间：2009-05-09T02:56:57.133
> 
> 标签：windows-vista, user-interface

在 XP 中，您可以通过“工具”->“文件夹选项”更改文件类型（打开、编辑、打印等）的动词。我在Vista中找不到这个。

我知道有一种编程/注册表方式可以做到这一点，但是如何在 UI 中改变它呢？谷歌搜索对我没有多大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-01-26T12:56:01.857

在 Vista（和更高版本）中删除了文件类型选项卡，并且没有真正的替代品，您可以获得最接近的是控制面板中的[默认程序](https://msdn.microsoft.com/en-us/library/windows/desktop/cc144154(v=vs.85).aspx#ui)部分，但它不能让您对动词进行相同的控制，您只能选择来自您机器上安装的产品提供的固定列表。

您还可以查看一个名为[Default Programs Editor的 3rd-party 程序。](https://defaultprogramseditor.com/)

# java - 按下回车后如何使Java控制台输入消失

> ID：842568
> 
> 赞同：1
> 
> 时间：2009-05-09T02:58:09.407
> 
> 标签：java, input, console

我正在使用 Scanner 类通过控制台从用户那里获取一些输入。每当用户在屏幕上输入内容并按下回车键时，输入就会停留在屏幕上，例如：

这是提示 // 用户编写命令并按下回车键

*   命令
*   命令的输出在这里

//使用写入命令3

*   命令
*   命令的输出在这里
*   命令3
*   command3 的输出在这里

无论如何我可以让输入的命令在按回车后不留在控制台中吗？

例如：

//用户写命令

*   命令的输出在这里

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T04:00:03.580

简短的回答：不，不是直接来自 Java。Java 对控制台的控制非常有限：您只能对其进行读写。控制台上显示的任何内容都无法以编程方式擦除。

长答案：在 Java 中，所有控制台操作都是通过输入和输出流处理的——<code>System.in 是输入流，`System.out`并且`System.err`是输出流。如您所见，[在 Java中无法修改输出流](http://java.sun.com/javase/6/docs/api/java/io/OutputStream.html)——本质上，输出流真正所做的只是将字节输出到某个目的地（这就是它被称为“流”的原因之一——它是单向的).*

我能看到的唯一解决方法是改用一个[`Console`](http://java.sun.com/javase/6/docs/api/java/io/Console.html)对象（来自`System.console()`）。具体来说，该`readPassword()`方法不会将用户键入的任何内容回显到控制台。但是，这种方法存在三个问题。首先，`Console`该类仅在 Java 1.6 中可用。其次，我不建议将其用于密码以外的输入，因为它会使输入命令比预期的更麻烦。第三，它仍然不会从屏幕上删除提示，我认为这会破坏你想要达到的目的。

* - 从技术上讲，`System.out`and`System.err`都是 , 的实例`PrintStream`，但`PrintStream`几乎只是一个灵活的版本`OutputStream`——a`PrintStream`仍然像一个正常的输出流，因为输出是一种单向操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T10:45:07.413

您将很难使用标准库来做到这一点。

如果您不想[自己做](http://illegalargumentexception.blogspot.com/2009/04/java-unicode-on-windows-command-line.html)，您可以使用像[JLine](http://jline.sourceforge.net/)这样的 3rd 方库来做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T06:53:00.407

嗯 - 我一直认为，如果你将退格字符 ('\b') 发送到 sysout，它会清除 - 但我从未真正尝试过它（这些天不要做太多的控制台编程）。

还没有尝试过，但是[该线程](http://www.physicsforums.com/showthread.php?t=111640)的底部似乎表明它应该可以工作。

请注意，这可能不适用于 IDE 控制台，但可能适用于常规 OS 控制台...

我将实际证明它可以作为 OP 的练习 :-)

# windows - windbg 转储命令失败，错误 0x8007012b

> ID：842569
> 
> 赞同：4
> 
> 时间：2009-05-09T02:58:12.387
> 
> 标签：windows, windbg, minidump

客户正试图捕获挂起的小型转储。他启动 WindDbg 并成功附加到该过程。WinDbg 显示其标题：

```
Microsoft (R) Windows Debugger Version 6.11.0001.404 AMD64
Copyright (c) Microsoft Corporation. All rights reserved. 
```

并枚举加载的模块。

他输入转储命令：

```
.dump /m c:\problem.dmp 
```

它报告：

```
Creating c:\problem.dmp - mini user dump
WriteMemoryFromProcess.Read(0x1f1e000, 0x2000) failed, 0x8007012b
Dump creation failed, Win32 error 0n299
"Only part of a ReadProcessMemory or WriteProcessMemory request was completed." 
```

错误 0x299 是：由于文件系统限制，请求的操作无法完成

任何想法这意味着什么或如何诊断？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T06:50:39.623

看看 /mA 开关，它是在 6.10.3中[引入的：](http://voneinem-windbg.blogspot.com/2008/11/windbg-version-6103233-is-out-i-still.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T04:10:31.323

键入**net helpmsg 299**，错误 299 是

*仅完成了 ReadProcessMemory 或 WriteProcessMemory 请求的一部分。*

在 winerror.h 中，这是**ERROR_PARTIAL_COPY**

该进程是64位进程吗？ [http://winprogger.com/?p=26](http://winprogger.com/?p=26)列出了可能发生此错误的几个原因。

# python - 在多操作系统支持的 Python 脚本中设置路径有哪些好方法

> ID：842570
> 
> 赞同：5
> 
> 时间：2009-05-09T03:00:43.270
> 
> 标签：python

在编写可以在不同操作系统环境（Windows/*nix）中执行的Python脚本时，有哪些设置路径的好方法？在下面的示例中，我希望将日志文件存储在当前目录下的日志文件夹中。这是一种可接受的方法（我对 Python 比较陌生）还是有更好的方法来实现这一点？谢谢

```
if os.name == 'nt':
    logdir=('%s\\logs\\') % (os.getcwd())
else:
    logdir=('%s/logs/') % (os.getcwd())

logging.basicConfig(level=logging.INFO,
    format='%(asctime)s %(name)-12s %(levelname)-8s %(message)s',
    datefmt='%m-%d-%y %H:%M:%S',
    filename='%slogfile.log' % (logdir),
    filemode='a') 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-09T03:06:00.307

一定要看看`os.path`。它包含许多您需要的“安全”跨操作系统路径操作功能。例如，我总是在您概述的场景中这样做：

```
os.path.join(os.path.abspath(os.path.dirname(__file__)), 'logs') 
```

另请注意，如果要获取路径分隔符，可以使用：

```
os.path.sep 
```

例如，这将在 Windows 上产生“\\”，在 Linux 上产生“/”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T03:33:23.567

首先，始终使用 os.path 进行路径操作。

更重要的是，所有路径都应该在配置文件中提供。

对于日志记录，请使用[fileConfig](http://docs.python.org/library/logging.html#logging.fileConfig)函数。

对于其他一切，请确保有一个配置文件或命令行参数或环境变量。

# wpf - 使用 MEF 导入 WPF DataTemplate？

> ID：842571
> 
> 赞同：24
> 
> 时间：2009-05-09T03:01:13.877
> 
> 标签：wpf, mvvm, datatemplate, mef

我将 MEF 视为一个可扩展性框架，我几乎被卖掉了，除了一点：

假设我想同时导入 ViewModel 和 View 来显示它。我认为“正确”的做法是让 MEF 部分导出 ViewModel 类和显示 ViewModel 的 DataTemplate。例如，假设您正在构建一个类似 Visio 的应用程序，并且您想要导入一个形状库。每个形状都需要一个在 Xaml 中定义的 View 和一个包装一些底层 Model 对象的 ViewModel。

这可能吗？DataTemplate 的 Import 合同是什么样的？如何让 WPF 知道导入的 DataTemplate？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-05-10T01:41:55.897

是的，我能够通过以下方式完成这项工作：

在我的主机 WPF 应用程序中，我添加了这个导入：

```
 [ImportMany("ApplicationResources", typeof(ResourceDictionary))]
    public IEnumerable<ResourceDictionary> Views { get; set; } 
```

然后在我的复合部分中，我在常规 ResourceDictionary Xaml 文件中声明了 ViewModel 和 ViewModel 的数据模板。然后我为 ResourceDictionary 创建了一个代码，如下所示（在此示例中，ViewModel 称为 ItemViewModel，ResourceDictionary 称为 ItemView）：

```
[Export("ApplicationResources", typeof(ResourceDictionary))]
public partial class ItemView : ResourceDictionary 
{
    public ItemView()
    {
        InitializeComponent();
    }
} 
```

作为参考，示例 ResourceDictionary 的 Xaml 如下所示：

```
<ResourceDictionary 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:MyCompany.MyProduct"
    x:Class="MyCompany.MyProduct.ItemView">

    <DataTemplate DataType="{x:Type local:ItemViewModel}">
        ...
    </DataTemplate>

</ResourceDictionary> 
```

然后，回到我的主机 WPF 应用程序，在我成功撰写之后，在我显示主窗口之前，我这样做：

```
// Add the imported resource dictionaries
// to the application resources
foreach (ResourceDictionary r in Views)
{
    this.Resources.MergedDictionaries.Add(r);
} 
```

这似乎成功地在 WPF 看到 ItemViewModel 的任何地方应用 DataTemplate。

**编辑**：对于任何感兴趣的人，我发布了一个名为[SoapBox Core](http://soapboxcore.com/)的开源应用程序框架，它广泛使用这种方法将视图导入应用程序资源。它工作得很好，你可以自己下载源代码，看看它是如何工作的。

# .net - 使用 wcf 公开 SyndicationFeedFormatter 或 IList

> ID：842572
> 
> 赞同：0
> 
> 时间：2009-05-09T03:01:49.960
> 
> 标签：.net, wcf, silverlight

我想用 wcf 和 basicHttpBinding 公开一个 SyndicationFeedFormatter。我继续收到如下所示的错误。我已经包含了接口/类和 web.config wcf 配置。

我试图公开 SyndicationFeedFormatter 以及 IList 但无法克服以下错误。有没有人能够做到这一点或有人确认问题是什么？

谢谢 - 戴夫

错误信息

System.ServiceModel.Dispatcher.NetDispatcherFaultException：格式化程序在尝试反序列化消息时抛出异常：尝试反序列化参数[http://tempuri.org/:GetFeaturesResult](http://tempuri.org/:GetFeaturesResult)时出错。InnerException 消息是“第 1 行位置 123 中的错误。元素“ [http://tempuri.org/:GetFeaturesResult](http://tempuri.org/:GetFeaturesResult) ”包含“ [http://schemas.datacontract.org/2004/07/System.ServiceModel.Syndication: Rss20FeedFormatter](http://schemas.datacontract.org/2004/07/System.ServiceModel.Syndication:Rss20FeedFormatter) ' 数据合约

我的界面/合同看起来像

```
[ServiceContract]
[ServiceKnownType(typeof(Atom10FeedFormatter))]
[ServiceKnownType(typeof(Rss20FeedFormatter))]
public interface IGetData {

    [OperationContract]
    SyndicationFeedFormatter GetFeatures();

    [OperationContract]
    IList<SyndicationItem> GetFeatures2(); 
```

}

我的方法看起来像....

```
 public SyndicationFeedFormatter GetFeatures()() {
        // Generate some items...
        SyndicationFeed feed = new SyndicationFeed() {
            Title = new TextSyndicationContent("Mike's Feed"),
            Description = new TextSyndicationContent("Mike's Feed Description")
        };

        feed.Items = from i in new int[] { 1, 2, 3, 4, 5 }
                     select new SyndicationItem() {
                         Title = new TextSyndicationContent(string.Format("Feed item {0}", i)),
                         Summary = new TextSyndicationContent("Not much to see here"),
                         PublishDate = DateTime.Now,
                         LastUpdatedTime = DateTime.Now,
                         Copyright = new TextSyndicationContent("MikeT!"),
                     };

        return (new Rss20FeedFormatter(feed));
    }

    public IList<SyndicationItem> GetFeatures2() {

        List<string> includeList = new List<string>();
        includeList.Add("Feature");

        IList<SyndicationItem> mylist = ReaderManager.GetFeedByCategory2(includeList, null, null);
        return mylist;

    } 
```

我的 web.config 如下所示

binding="webHttpBinding" contract="SLNavigationApp.Web.IGetData"> -->

```
 <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />

     </service>
 </services>

 <behaviors>
     <endpointBehaviors>
         <behavior name="webHttpBehavior">
             <webHttp />
         </behavior>
     </endpointBehaviors>
     <serviceBehaviors>
         <behavior name="SLNavigationApp.Web.GetDataBehavior">
             <serviceMetadata httpGetEnabled="true" />
             <serviceDebug includeExceptionDetailInFaults="true" />
         </behavior>
    </serviceBehaviors>
 </behaviors> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T16:07:01.163

我很困惑：您使用的是 WebHttpBinding 还是 BasicHttpBinding？您绝对应该使用前者，这应该可以工作。

如果您尝试使用 BasicHttpBinding，您介意分享原因吗？SyndicationFeedFormatter 类不是 DataContracts 或 XmlSerializable（这是您需要支持 BasicHttpBinding 的），因此在这种情况下它可能不起作用，除非您做一些额外的工作。我可能会尝试解决这个问题，只需将我的 ServiceContract 更改为返回 Message 对象，如下所示：

```
[ServiceContract]
[ServiceKnownType(typeof(Atom10FeedFormatter))]
[ServiceKnownType(typeof(Rss20FeedFormatter))]
public interface IGetData {
    [OperationContract]
    Message GetFeatures();

} 
```

...

```
SyndicationFeedFormatter frm = new Rss20FeedFormatter(feed);
return Message.CreateMessage(
   MessageVersion.None, "GetFeatures", 
   new FeedBodyWriter(frm)
   ); 
```

...

```
class FeedBodyWriter : BodyWriter {
   SyndicationFeedFormatter formatter;
   public FeedBodyWriter(SyndicationFeedFormatter formatter) : base(false) {
      this.formatter = formatter;
   }
   protected override void OnWriteBodyContents(XmlDictionaryWriter writer) {
      formatter.WriteTo(writer);
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-01T21:55:20.160

酷，我想知道为什么我的服务没有生成浏览器可读的内容。我也在使用 basicHttpBinding（因为所有其余的调用都来自 Silverlight）。

作为一个不相关的旁注：

您可以更改： from i in new int[] { 1, 2, 3, 4, 5 }

To: from i in Enumerable.Range(1, 5)

这可能非常方便！当我从服务器提取分页 XML 数据时，我通常在 XLINQ 查询中将其用作“Enumerable.Range(1, pagecount)”。

# .net - 为什么 WPF 支持绑定到对象的属性，但不支持绑定字段？

> ID：842575
> 
> 赞同：27
> 
> 时间：2009-05-09T03:04:57.707
> 
> 标签：.net, wpf, binding, field

我有一个 WCF 服务，它通过如下结构传递状态更新：

```
[DataContract]
public struct StatusInfo
{
    [DataMember] public int Total;
    [DataMember] public string Authority;
}
...
public StatusInfo GetStatus() { ... } 
```

我在 ViewModel 中公开一个属性，如下所示：

```
public class ServiceViewModel : ViewModel
{
    public StatusInfo CurrentStatus
    {
        get{ return _currentStatus; }
        set
        { 
            _currentStatus = value;
            OnPropertyChanged( () => CurrentStatus );
        }
    }    
} 
```

XAML 就像这样：

```
<TextBox Text="{Binding CurrentStatus.Total}" /> 
```

当我运行该应用程序时，我在输出窗口中看到错误，表明找不到 Total 属性。我检查并仔细检查并正确输入。我突然想到这些错误特别表明找不到“属性”。因此，向结构添加属性使其工作正常。但这对我来说似乎很奇怪，WPF 无法处理与字段的单向绑定。从语法上讲，您在代码中以相同的方式访问它们，并且只为 StatusInfo 结构创建自定义视图模型似乎很愚蠢。我是否错过了有关 WPF 绑定的内容？您可以绑定到字段还是属性绑定是唯一的方法？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-09T09:59:49.347

绑定*通常*不适用于字段。大多数绑定部分基于 ComponentModel`PropertyDescriptor`模型，该模型（默认情况下）适用于属性。这将启用通知、验证等（这些都不适用于字段）。

由于我无法解释的更多原因，公共领域是一个坏主意。它们应该是属性，事实。同样，可变结构是一个**非常**糟糕的主意。尤其重要的是，它可以防止意外的数据丢失（通常与可变结构相关联）。这应该是一个类：

```
[DataContract]
public class StatusInfo
{
    [DataMember] public int Total {get;set;}
    [DataMember] public string Authority {get;set;}
} 
```

它现在将按照您认为的方式运行。如果你希望它是一个**不可变**的结构，那没关系（但数据绑定当然是单向的）：

```
[DataContract]
public struct StatusInfo
{
    [DataMember] public int Total {get;private set;}
    [DataMember] public string Authority {get;private set;}

    public StatusInfo(int total, string authority) : this() {
        Total = total;
        Authority = authority;
    }
} 
```

但是，我首先会质疑为什么这是一个结构。用 .NET 语言编写结构是**非常罕见的。**请记住，WCF“mex”代理层无论如何都会在消费者处将其创建为一个类（除非您使用程序集共享）。

* * *

回答“为什么使用结构”回复（“未知（谷歌）”）：

如果这是对我问题的回答，那么它在很多方面都是错误的。首先，*作为变量*的值类型通常（首先）分配在堆栈上。如果它们被推送到堆上（例如在数组/列表中），那么与类的开销没有太大区别——一小部分对象头加上一个引用。结构应该总是**很小**的。具有多个字段的东西会过大，并且会破坏您的堆栈或由于 blitting 而导致缓慢。此外，结构应该是不可变的——除非你**真的**知道你在做什么。

几乎任何代表对象的东西都应该是不可变的。

如果您正在访问数据库，那么与进程外并且可能通过网络相比，struct vs class 的速度不是问题。即使它有点慢，这与正确处理相比毫无意义 - 即将对象视为对象。

**作为超过1M 个**对象的一些指标：

```
struct/field: 50ms
class/property: 229ms 
```

基于以下内容（速度差异在于对象分配，而不是字段与属性）。所以大约慢了 5 倍，但仍然**非常非常快**。由于这不会成为您的瓶颈，因此不要过早地优化它！

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
struct MyStruct
{
    public int Id;
    public string Name;
    public DateTime DateOfBirth;
    public string Comment;
}
class MyClass
{
    public int Id { get; set; }
    public string Name { get; set; }
    public DateTime DateOfBirth { get; set; }
    public string Comment { get; set; }
}
static class Program
{
    static void Main()
    {
        DateTime dob = DateTime.Today;
        const int SIZE = 1000000;
        Stopwatch watch = Stopwatch.StartNew();
        List<MyStruct> s = new List<MyStruct>(SIZE);
        for (int i = 0; i < SIZE; i++)
        {
            s.Add(new MyStruct { Comment = "abc", DateOfBirth = dob,
                     Id = 123, Name = "def" });
        }
        watch.Stop();
        Console.WriteLine("struct/field: "
                  + watch.ElapsedMilliseconds + "ms");

        watch = Stopwatch.StartNew();
        List<MyClass> c = new List<MyClass>(SIZE);
        for (int i = 0; i < SIZE; i++)
        {
            c.Add(new MyClass { Comment = "abc", DateOfBirth = dob,
                     Id = 123, Name = "def" });
        }
        watch.Stop();
        Console.WriteLine("class/property: "
                   + watch.ElapsedMilliseconds + "ms");
        Console.ReadLine();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T15:51:46.723

我只能猜测为什么它们只支持属性：也许是因为它似乎是 .NET 框架中的通用约定，从不公开可变字段（[可能是为了维护二进制兼容性](http://blogs.msdn.com/abhinaba/archive/2006/04/11/572694.aspx)），并且他们以某种方式期望所有程序员都遵循相同的约定。

此外，尽管使用相同的语法访问字段和属性，但数据绑定使用反射，并且（所以我听说）必须以不同的方式使用反射来访问字段而不是访问属性。

# c# - 酷 UI 模板 VS Jquery 模板

> ID：842580
> 
> 赞同：0
> 
> 时间：2009-05-09T03:11:36.707
> 
> 标签：c#, asp.net, jquery

我读过这篇文章[ScuttGu](http://weblogs.asp.net/scottgu/archive/2006/10/22/Tip_2F00_Trick_3A00_-Cool-UI-Templating-Technique-to-use-with-ASP.NET-AJAX-for-non_2D00_UpdatePanel-scenarios.aspx)

用于利用用户控件制作客户端模板。

还有这个

[爱诺西亚](http://encosia.com/2008/06/26/use-jquery-and-aspnet-ajax-to-build-a-client-side-repeater/)

关于性能，它们是否相同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T04:15:27.380

OK Encosia (Dave Ward) 的示例使用 JQuery 插件 JTemplate 来完成它的工作。ScottGu 使用了更多的 ASP.Net 堆栈。

也就是说，ScottGu 的样品缺乏一些细度。

至于表现……我讨厌这个问题。变数太多。但...

ScottGu 的示例将在网络上移动更多位。您实际上是通过 Web 服务调用将整个 html 输出发送到浏览器。

Encosia 的示例是将可能的最原始数据形式 (JSON) 发送到浏览器，然后使用 JQuery/JTemplate/Javascript 将其转换为 html。

理论上，Encosia 的例子会表现得更好。通过网络传输的数据越少，服务器负载也应该越少。但这将是更多的浏览器工作（这里充其量是名义上的）。

也就是说，对于少量数据，我怀疑这是否会很重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T06:14:16.050

这两个示例都使用 JSON，您可以在使用 .NET Web 服务时免费获得。因此，通过线路传输的数据量将是相同的。

在客户端，不了解[ScriptServiceAttribute](http://msdn.microsoft.com/en-us/library/system.web.script.services.scriptserviceattribute.aspx)生成的库的客户端性能，但是自己做和使用该库之间的差异可能很小。

Ecnosia 示例使用 jTemplates。在获取大型列表并在重复部分（如 html 表）中显示它们时，jTemplates 可以为您提供良好的性能提升。

* * *

**回复*devmania*：**

Scott 的版本在服务器端应用模板，然后将格式化的 html+data 发送到客户端。这里的 html 可能是一个真正的开销（如果是表格，请考虑所有 tr、td、样式属性、标签之间的间距……）。

jTemplates 呈现客户端。数据以更高效和紧凑的 JSON 格式发送（只是数据，而不是 html）。jTemplates 必须读取的模板也小得多，因为它只包含第一行的定义。

是的，在服务器端渲染要容易得多。服务器端在渲染方面也可以更加灵活，因为您可以访问客户端没有的数据源。

在许多情况下，客户端可以更有效。此外，使用一些 javascript，您可以使其像服务器端渲染一样灵活。但是，我认为复杂的客户端渲染需要更多时间来开发。

# java - Java 用户界面框架？

> ID：842581
> 
> 赞同：6
> 
> 时间：2009-05-09T03:12:03.680
> 
> 标签：java, user-interface, swing, groovy, javafx

我即将用 Java 构建一个 UI，我正在尝试确定我应该使用什么。我绝对不想使用香草秋千。

需要注意的是，它必须添加到现有的 Swing 应用程序中。我在看 JavaFX 和 Groovy Swing Builder。对于前者，似乎对嵌入 Swing 的支持相当差。

有人有其他建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-09T04:48:42.293

时髦的家伙正在研究**Griffon**： http: [//groovy.codehaus.org/Griffon](http://groovy.codehaus.org/Griffon)。

我相信它应该模拟一个控制台类型的 GUI，如 Web UI。

另一个可能的答案是**JavaFX**。这是他们的 hello world 应用程序的链接：http: [//javafx.com/docs/gettingstarted/javafx/create-first-javafx-app.jsp](http://javafx.com/docs/gettingstarted/javafx/create-first-javafx-app.jsp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T03:50:15.100

您是否考虑过使用 NetBeans？

[http://www.netbeans.org/features/java/swing.html](http://www.netbeans.org/features/java/swing.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T04:44:14.067

我不太确定您在寻找什么，但[SwingX](http://swinglabs.org/)可能符合要求。

> 包含对 Swing GUI 工具包的扩展，包括提供富客户端应用程序通常需要的功能的新的和增强的组件。亮点包括：
> 
> *   对表格、树和列表进行排序、过滤、突出显示
> *   查找/搜索
> *   自动完成
> *   登录/认证框架
> *   树表组件
> *   可折叠面板组件
> *   日期选择器组件
> *   每日提示组件

（不过， [SwingLabs](http://swinglabs.org/)目前似乎已经倒闭。）

* * *

**编辑：**在二读时，我猜您实际上是在谈论声明性 UI 构建器？在这种情况下，我将向您推荐我的[另一个答案，](https://stackoverflow.com/questions/761237/suggestions-for-declarative-gui-programming-in-java/761258#761258)其中我推荐了[javabuilders](http://code.google.com/p/javabuilders/)，一个基于[YAML](http://en.wikipedia.org/wiki/YAML)的 Swing UI 构建器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T06:34:38.357

我过去使用过[JIDE](http://www.jidesoft.com)。它的对接框架非常棒。

# ruby-on-rails - Ruby on Rails 路由

> ID：842584
> 
> 赞同：2
> 
> 时间：2009-05-09T03:14:09.977
> 
> 标签：ruby-on-rails

我是 RoR 的新手，对路由有疑问。我已经建立了一个应用程序和一个简单的用户登录系统（是的，我知道那里已经有一个登录生成器，我只是想自己尝试一下）。我对某个操作有一个 before_filter 来检查用户是否登录。如果没有，它会将它们重定向到登录页面。这就是我的路由方式，这看起来对吗？

```
map.resources :user, :collection => { :login => :get } 
```

还有，为什么我要改变

```
:login => :get 
```

至

```
:login => :post 
```

它是否显示“显示”视图？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T04:21:28.537

```
map.resources :user, :collection => { :login => :get } 
```

将对应一个 URL，如“/users/login”

```
map.resources :users, :member => { :login => :get } 
```

将对应一个 URL，如“/users/123/login”

因为 :user 是指一个资源，它会将 url 映射到一个动作，这取决于除了 url 之外的请求方法。

因此，上面的第一个路由会将 GET 映射到 /users/login 到登录操作，但是当您将其更改为 :post 时，它会将 GET 映射到 /users/login 到默认值，即“用户”控制器和 ID 为“登录”的用户的“显示”操作 - 这不是您想要的。（它会将 POST 映射到 /users/login 到“登录”操作）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T03:47:42.797

它很接近，但您可能想尝试：

```
map.resources :users, :member => { :login => :get } 
```

它们的关键区别在于，`:collection`当您的新路由处理该资源的集合（例如“索引”）而不是资源的单个实例（例如单个用户登录）时，应该使用关键字。

此外，如果`/users/user_id/login`重定向到登录页面，您仍然在那里执行 GET 操作。当您提交要使用 POST 的表单时。所以本质上你是在告诉 Rails 在收到 GET 时期待一个 POST。我只能推测是完全忽略了`login`路由，只返回 URL 中表示的任何用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T04:49:50.807

我建议为您的登录系统使用单独的资源。很多人使用会话，所以你有

```
map.resource :session 
```

然后，您将使用常规的 crud 方法，例如 #new 和 #create 来分别显示和提交登录表单。您还需要创建一个会话控制器来处理这些请求。

# c# - 获取进程的内存使用情况

> ID：842585
> 
> 赞同：31
> 
> 时间：2009-05-09T03:15:10.550
> 
> 标签：c#

我在弄清楚如何准确地获得进程的 ram 使用情况时遇到了一些麻烦。（它当前消耗了多少内存，而不是保留了多少，或者它的最大值或最小值）

假设我有一个在后台运行的进程，Java.exe，它允许使用 1024mb 的内存，我如何知道它当前使用了多少内存。

我自己开始了这个过程，所以我可以访问 Process 对象，我想更清楚地说明什么属性是适合我的。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-02-17T13:46:47.200

我在 msdn 上找到了这个，它正在工作

```
System.Diagnostics.Process proc = ...; // assign your process here :-)

int memsize = 0; // memsize in KB
PerformanceCounter PC = new PerformanceCounter();
PC.CategoryName = "Process";
PC.CounterName = "Working Set - Private";
PC.InstanceName = proc.ProcessName;
memsize = Convert.ToInt32(PC.NextValue()) / (int)(1024);
PC.Close();
PC.Dispose(); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-09T03:35:42.483

如果您纯粹对物理内存感兴趣，您可能需要[WorkingSet64](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.workingset64.aspx)，它给出“为相关进程分配的物理内存量”。了解此值不断波动，此调用为您提供的值可能不是最新的。您可能还对[PeakWorkingSet64](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.peakworkingset64.aspx)感兴趣，它给出了“相关进程使用的最大物理内存量”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-08-22T16:15:33.963

太好了，我希望这与任务管理器中描述的一样，并尝试：

```
Process.PrivateMemorySize64
Process.PeakVirtualMemorySize64
Process.PeakPagedMemorySize
Process.PagedSystemMemorySize64
Process.PagedMemorySize64
Process.NonpagedSystemMemorySize64
Process.WorkingSet64 
```

**这些都**不起作用，但**性能计数器**可以！

```
PerformanceCounter PC = new PerformanceCounter();
PC.CategoryName = "Process";
PC.CounterName = "Working Set - Private";
PC.InstanceName = "processNameHere";
memsize = Convert.ToInt32(PC.NextValue()) / (int)(1024);
PC.Close();
PC.Dispose(); 
```

多谢 ！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-25T19:21:12.187

Win32 [GetSystemInfo 函数](https://docs.microsoft.com/en-us/windows/win32/api/sysinfoapi/nf-sysinfoapi-getsysteminfo)也有效。

在此 Memory.dll 项目中，它实际上已成功用于实践过程中的字节数组扫描： [https ://github.com/erfg12/memory.dll/blob/042db0cf75e4152a7adf1ea47e6f23f1ad763fb6/Memory/memory.cs#L1909](https://github.com/erfg12/memory.dll/blob/042db0cf75e4152a7adf1ea47e6f23f1ad763fb6/Memory/memory.cs#L1909)

# semantic-web - 在 owl "Dl query" 如何在 protege 中使用高级值查询

> ID：842588
> 
> 赞同：0
> 
> 时间：2009-05-09T03:18:41.213
> 
> 标签：semantic-web, owl, protege4, dlquery, manchester-syntax

我正在开发一个本体，但我的 Dl 查询有问题

有一类叫“花”

这个类有一些花名的子类

还有另一类叫做“flowersColor”

它具有这些值（“红色”、“绿色”和“蓝色”）作为个体——而不是子类——

每朵花都有一种或多种颜色

我想寻找一朵红色且只有红色的花

我的 DL 查询是：

“花和有颜色值红色”

这个查询会给我所有红色的花，即使它有其他颜色

但是我想要所有只有红色的花朵

我想写这样的东西

“flower and hasColor only value red” <- 这在语法上是不正确的

我主要是如果颜色是“红色”和“绿色”的组合，那么我不想在我的结果中看到它

我希望你能在我的查询中帮助我

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-30T16:42:36.277

请记住，OWL 使用开放世界假设，因此您在可以通过描述逻辑推断的内容方面受到一定限制。

因此，正如 Kaarel 所提到的，您的“查询”可能是：

```
flower and (hasColor only {red}) 
```

然而，这在开放世界假设中是无法证明的。在宇宙的某个地方，可能有一个声明，它断言：

```
<RedRose> :hasColor :StackOverflow . 
```

其中，当与您的断言（您试图查询）结合使用时：

```
<RedRose> :hasColor :Red .
<RedRose> a :Flower . 
```

将导致 DL 查询不返回任何结果。因此，由于开放世界假设，以及理论上存在狂野、不准确和不相关的断言（至少从您的角度来看），DL 查询将失败，因为它只能推断它可以证明是真的陈述。

但是，您的示例查询可以在 OWL 限制中使用，以确定某物是否*不是*其他物。例如，如果你有一个类 ( `:OnlyRedFlower`)，它必须只有红色，但它有蓝色（你已经断言了这个额外的颜色），那么你可以推断这朵新花*不在*的集合中`:OnlyRedFlower`。

更新：对于那些有兴趣自己尝试的人，这是我根据这个问题创建的本体：

```
<?xml version="1.0"?>
<!DOCTYPE rdf:RDF [
    <!ENTITY owl "http://www.w3.org/2002/07/owl#" >
    <!ENTITY xsd "http://www.w3.org/2001/XMLSchema#" >
    <!ENTITY owl2xml "http://www.w3.org/2006/12/owl2-xml#" >
    <!ENTITY rdfs "http://www.w3.org/2000/01/rdf-schema#" >
    <!ENTITY rdf "http://www.w3.org/1999/02/22-rdf-syntax-ns#" >
    <!ENTITY onto "http://www.elastra.com/onto/2009/5/30/onto.owl#" >
]>
<rdf:RDF xmlns="http://stackoverflow.com/users/64881/ontology_842588.rdf#"
     xml:base="http://stackoverflow.com/users/64881/ontology_842588.rdf"
     xmlns:owl2xml="http://www.w3.org/2006/12/owl2-xml#"
     xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
     xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
     xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
     xmlns:owl="http://www.w3.org/2002/07/owl#"
     xmlns:onto="http://www.elastra.com/onto/2009/5/30/onto.owl#">
    <owl:Ontology rdf:about="">
        <rdfs:comment xml:lang="en"
            >Example for http://stackoverflow.com/questions/842588/in-owl-dl-query-how-to-use-advanced-valu-query-in-protege</rdfs:comment>
    </owl:Ontology>
    <owl:ObjectProperty rdf:about="&onto;hasColor"/>
    <owl:Class rdf:about="&onto;Color"/>
    <owl:Class rdf:about="&onto;ExampleFlower">
        <rdfs:subClassOf rdf:resource="&onto;Flower"/>
    </owl:Class>
    <owl:Class rdf:about="&onto;Flower"/>
    <owl:Class rdf:about="&onto;OnlyRedFlower">
        <owl:equivalentClass>
            <owl:Class>
                <owl:intersectionOf rdf:parseType="Collection">
                    <rdf:Description rdf:about="&onto;Flower"/>
                    <owl:Restriction>
                        <owl:onProperty rdf:resource="&onto;hasColor"/>
                        <owl:allValuesFrom>
                            <owl:Class>
                                <owl:oneOf rdf:parseType="Collection">
                                    <rdf:Description rdf:about="&onto;Red"/>
                                </owl:oneOf>
                            </owl:Class>
                        </owl:allValuesFrom>
                    </owl:Restriction>
                </owl:intersectionOf>
            </owl:Class>
        </owl:equivalentClass>
        <rdfs:subClassOf rdf:resource="&onto;Flower"/>
    </owl:Class>
    <owl:Class rdf:about="&onto;OtherFlower">
        <rdfs:subClassOf rdf:resource="&onto;Flower"/>
    </owl:Class>
    <onto:Color rdf:about="&onto;Blue">
        <rdf:type rdf:resource="&owl;Thing"/>
    </onto:Color>
    <onto:Flower rdf:about="&onto;BlueOrchid">
        <rdf:type rdf:resource="&owl;Thing"/>
        <onto:hasColor rdf:resource="&onto;Blue"/>
    </onto:Flower>
    <onto:Color rdf:about="&onto;Red">
        <rdf:type rdf:resource="&owl;Thing"/>
    </onto:Color>
    <onto:Flower rdf:about="&onto;RedRose">
        <rdf:type rdf:resource="&owl;Thing"/>
        <onto:hasColor rdf:resource="&onto;Red"/>
    </onto:Flower>
</rdf:RDF> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T16:07:17.073

您所追求的查询是：

```
flower and (hasColor only {red}) 
```

请注意，`{.}`构造函数从个人或个人列表创建一个类。因此，您可以在语法上需要类的任何地方使用它，例如

```
(not {blue}) subClassOf
             {red} and {green,blue} or (hasColor max 10 ({red} or {blue})) 
```

# c# - C# 中的静态常量

> ID：842590
> 
> 赞同：53
> 
> 时间：2009-05-09T03:21:12.237
> 
> 标签：c#, string, constants

我有这个代码；

```
using System;

namespace Rapido
{
    class Constants
    {
        public static const string FrameworkName = "Rapido Framework";
    }  
} 
```

Visual Studio 告诉我：`The constant 'Rapido.Constants.FrameworkName' cannot be marked static`

我怎样才能使这个常量在其他类中可用，而不必创建它的新实例？（即直接通过 访问它`Rapido.Constants.FrameworkName`）

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2009-05-09T03:28:27.010

```
public static class Constants
{
    public const string FrameworkName = "Rapido Framework";
} 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-05-09T03:25:45.613

const 已经是静态的，因为它不能在实例之间更改。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-09T03:30:58.487

您无需将其声明为静态 - public const string 就足够了。

# python - 使用 ruby 或 python 在文件中查找

> ID：842598
> 
> 赞同：4
> 
> 时间：2009-05-09T03:29:51.607
> 
> 标签：python, ruby, search, file, grep

流行的文本编辑器具有以下在对话框中打开的“在文件中查找”功能：

```
 Look For:       __searchtext__
 File Filter:    *.txt; *.htm
 Start From:     c:/docs/2009
 Report:         [ ] Filenames [ ]FileCount only
 Method:         [ ] Regex     [ ]Plain Text 
```

事实上，几个流行的文本编辑器都有这个。

我想做同样的事情，但使用 python 或 ruby​​ 类而不是文本编辑器。这样一来，这种脑死的简单操作就可以在任何支持 ruby​​ 或 python 的平台上通过脚本运行。

**问题：** 我不想自己写这个，所以有没有人知道一个 ruby​​ 或 python 脚本可以接受相同或相似的简单输入 args 并执行你所期望的？

我正在寻找可以进行蛮力线性搜索的东西，与索引搜索无关。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T04:23:14.413

我知道你说过你不想自己写它，但是对于它的价值，它会很容易使用`os.walk`——你可以做这样的事情：

```
results = []
if regex_search:
    p = re.compile(__searchtext__)
for dir, subdirs, subfiles in os.walk('c:/docs/2009'):
    for name in fnmatch.filter(subfiles, '*.txt'):
        fn = os.path.join(dir, name)
        with open(fn, 'r') as f:
            if regex_search:
                results += [(fn,lineno) for lineno, line in enumerate(f) if p.search(line)]
            else:
                results += [(fn,lineno) for lineno, line in enumerate(f) if line.find(__searchtext__) >= 0] 
```

（那是Python，顺便说一句）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T06:33:25.100

Grepper 是 David A. Black 的 Ruby 宝石，它正是这样做的：

```
g = Grepper.new
g.files = %w{ one.txt two.txt three.txt }
g.options = %w{ B2 }   # two lines of before-context
g.pattern = /__search_string__/
g.run

g.results.each do |file, result|
  result.matches.each do |lineno, before, line, after|
    etc.... 
```

我相信它会使用 grep 并将结果包装在 Ruby 对象中，这意味着它采用与 grep 相同的选项。安装：

```
sudo gem install grepper 
```

# c# - 为什么 C# 不允许 const 和 static 在同一行？

> ID：842609
> 
> 赞同：25
> 
> 时间：2009-05-09T03:51:21.853
> 
> 标签：c#, java, constants, final

为什么 C# 不允许 const 和 static 在同一行？在 Java 中，您必须将字段声明为“静态”和“最终”以充当常量。为什么 C# 不允许您将 const 声明为 final？

我进一步区分，在 Java 中，每个接口都是公共的和抽象的，无论是否明确声明。const 本质上不是静态的吗？为什么 C# 对此犹豫不决？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-09T04:24:18.793

**const**和**static**确实意味着不同的东西，不同的存储机制，不同的初始化。**static**是读/写的，因此必须为存储分配内存并且必须在运行时初始化。静态可以用文字值或表达式初始化**。**相反，**const**是不可变的，必须使用*编译时常*量（通常是文字值或可以在编译时完全评估的表达式）进行初始化。该值在编译时是已知的，因此它可以直接嵌入到生成的代码中，因此不需要在运行时分配存储空间。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-09T03:54:48.037

常量本质*上是*静态的，所以这将是多余的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-04-15T20:48:59.677

如前所述， Java 中的**static final**与C#中的**static readonly**相同。事实上，你是说这个成员是静态的，它的内容是不能改变的。您也可以在这两种情况下指定静态构造函数的值。

但是C# 中的**const**是完全不同的东西。它更符合 C 中的常量（**DEFINE**指令），但考虑到了 OOP。它是静态的，因为它是常量——每个实例都有这个具有相同值的常量，没有构造函数可以设置它。也有可能有人想在不必创建实例的情况下访问常量。当您考虑它时，非静态常量是没有意义的。你几乎可以说常量不是对象的一部分——它们只是用它来提供上下文，一个强名称。

Java 没有等价于**const**。您可以在某处读到**static final**等同于**DEFINE**，但这太模糊了。完全不同的机制，没有什么共同点，但最终导致代码的结果是相同的——代码的可维护性和可读性更好。

您只需要停止将 C# 中的常量视为静态成员，因为它们不是。**将它们视为DEFINE**的 OOP 版本。**当您考虑封装时， final**和**readonly**字段的唯一原因是防止您自己的代码意外更改其值。这对我来说听起来并不固定。

总结：

*   最终 = 只读
*   静态最终 = 静态只读
*   不适用 = 常量

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-09T04:54:48.907

确实，[C# **const**意味着**static**](http://msdn.microsoft.com/en-us/library/98f28cdx.aspx) BUT，C#在关键字[**readonly**](http://msdn.microsoft.com/en-us/library/acdd6hb7.aspx)中有一个等效于 Java 的**final**关键字。[](http://msdn.microsoft.com/en-us/library/acdd6hb7.aspx)

 **所以，事实上，C# 允许**const final**，它在 C# 中是**静态只读**的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-09T04:10:09.170

因为允许和不要求固有的修饰符会引起混淆。如果你看到

```
static const int A = 3
const int B = 5 
```

你可能认为它们是两种不同的常数。
即使是 VB 2008（如果您愿意，它可能非常冗长）也不允许这样做。

# c# - 从 C# 调用 .DLL 的奇怪问题

> ID：842612
> 
> 赞同：1
> 
> 时间：2009-05-09T03:53:43.673
> 
> 标签：c#, pinvoke, htmltidy

我正在尝试从 C# 调用 HtmlTidy 库 dll。网上流传着一些例子，但没有确定的……而且我遇到了无穷无尽的麻烦。我很确定问题出在 p/invoke 声明上……但如果我知道我哪里出错了，那就危险了。

我从[http://www.paehl.com/open_source/?HTML_Tidy_for_Windows](http://www.paehl.com/open_source/?HTML_Tidy_for_Windows)获得了 libtidy.dll，这似乎是当前版本。

这是一个控制台应用程序，演示了我遇到的问题：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Runtime.InteropServices;

namespace ConsoleApplication5
{
    class Program
    {
        [StructLayout(LayoutKind.Sequential)]
        public struct TidyBuffer
        {
            public IntPtr bp;         // Pointer to bytes
            public uint size;         // # bytes currently in use
            public uint allocated;    // # bytes allocated
            public uint next;         // Offset of current input position
        };

        [DllImport("libtidy.dll")]
        public static extern int tidyBufAlloc(ref TidyBuffer tidyBuffer, uint allocSize);

        static void Main(string[] args)
        {
            Console.WriteLine(CleanHtml("<html><body><p>Hello World!</p></body></html>"));
        }

        static string CleanHtml(string inputHtml)
        {
            byte[] inputArray = Encoding.UTF8.GetBytes(inputHtml);
            byte[] inputArray2 = Encoding.UTF8.GetBytes(inputHtml);

            TidyBuffer tidyBuffer2;
            tidyBuffer2.size = 0;
            tidyBuffer2.allocated = 0;
            tidyBuffer2.next = 0;
            tidyBuffer2.bp = IntPtr.Zero;

            //
            // tidyBufAlloc overwrites inputArray2... why? how? seems like
            // tidyBufAlloc is stomping on the stack a bit too much... but
            // how? I've tried changing the calling convention to cdecl and
            // stdcall but no change.
            //
            Console.WriteLine((inputArray2 == null ? "Array2 null" : "Array2 not null"));
            tidyBufAlloc(ref tidyBuffer2, 65535);
            Console.WriteLine((inputArray2 == null ? "Array2 null" : "Array2 not null"));
            return "did nothing";
        }
    }
} 
```

总而言之，我有点难过。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T12:46:31.860

您正在使用 TidyBuffer 结构的旧定义。新结构更大，因此当您调用 allocate 方法时，它会覆盖 inputArray2 的堆栈位置。新定义是：

```
 [StructLayout(LayoutKind.Sequential)]        
    public struct TidyBuffer        
    {
        public IntPtr allocator;  // Pointer to custom allocator            
        public IntPtr bp;         // Pointer to bytes            
        public uint size;         // # bytes currently in use            
        public uint allocated;    // # bytes allocated            
        public uint next;         // Offset of current input position        
    }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T05:44:16.933

对于它的价值，我们在工作中尝试了 Tidy 并切换到 HtmlAgilityPack。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T04:58:06.497

尝试将您的 tidyBufAlloc 声明更改为：

```
[DllImport("libtidy.dll", CharSet = CharSet.Ansi)]
private static extern int tidyBufAlloc(ref TidyBuffer Buffer, int allocSize); 
```

注意 CharSet.Ansi 添加和“int allocSize”（而不是 uint）。

此外，请参阅此[示例代码](http://members.optushome.com.au/cornwill73/samplecode/Tidy.cs)以获取在 C# 中使用 HTML Tidy 的示例。

在您的示例中，如果 inputHTML 很大，例如 50K，则 inputArray 和 inputArray2 也将分别为 50K。

然后，您还尝试在 tidyBufAlloc 调用中分配 65K。

如果指针未正确初始化，则很有可能正在使用随机的 .NET 堆地址。因此会覆盖部分或全部看似无关的变量/缓冲区。很可能只是运气，或者您已经分配了大缓冲区，您没有覆盖可能导致无效内存访问错误的代码块。

# c# - 为 .NET 数据访问层使用 MySql 存储过程

> ID：842616
> 
> 赞同：1
> 
> 时间：2009-05-09T03:55:39.300
> 
> 标签：c#, .net, mysql, stored-procedures, data-access-layer

我正在使用 .NET 2.0 和/或 3.5。奇怪的是，每次我添加查询时，无论是通过 TableAdapter 还是数据集中的普通查询，使用 MySQL 存储过程（无论是选择、更新、插入、删除），向导都没有完成（对话框突然消失，我回到了设计器模式，并且查询没有添加到 tableadapter 或数据集表单中）。MySQL 存储过程是否需要特殊的格式，或者 MySQL 存储过程的解决方法？

我正在使用 MySQL 5.1.33 便携式 XAMPP 1.7.1 PHP 5.2.9 Apache 2.2.11 phpMyAdmin 3.1.3.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-22T18:37:16.140

我也有同样的事情发生。对我的修复如下：我的存储过程参数之一是“过滤器”。我将其更改为“p_filter”，问题就消失了。我仍在处理的问题是在我得到的过滤器的最后一个屏幕上：

您的 sql 语法有错误；检查与您的 mysql 服务器版本相对应的手册，以在第 1 行的“NULL”附近使用正确的语法

我引入了一个不接受参数的存储过程，并且使用数据集向导创建 TableAdapter 没有任何问题。

# mysql - 我认为 curtime()、now() 和 current_timestamp 是 MySql 中有效的默认日期时间值吗？

> ID：842617
> 
> 赞同：3
> 
> 时间：2009-05-09T03:55:42.577
> 
> 标签：mysql, datetime, default-value

我正在使用最新版本的 MySql，并尝试更改表以使用 curtime() 或 now() 或 current_timestamp 作为日期时间列（created_at、updated_at）的默认值。对于这三个，alter 都失败了，说这些是无效的默认值。任何想法在日期时间字段中生成当前时间的适当默认值是什么？

```
ALTER TABLE `music_library_development`.`albums` 
MODIFY COLUMN `created_at` DATETIME NOT NULL DEFAULT current_timestamp,
MODIFY COLUMN `updated_at` DATETIME NOT NULL DEFAULT current_timestamp;

ALTER TABLE `music_library_development`.`albums` 
MODIFY COLUMN `created_at` DATETIME NOT NULL DEFAULT now(),
MODIFY COLUMN `updated_at` DATETIME NOT NULL DEFAULT now();

ALTER TABLE `music_library_development`.`albums` 
MODIFY COLUMN `created_at` DATETIME NOT NULL DEFAULT curtime(),
MODIFY COLUMN `updated_at` DATETIME NOT NULL DEFAULT curtime(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T04:02:32.217

尝试使用[TIMESTAMP](http://dev.mysql.com/doc/refman/5.0/en/timestamp.html)列类型：

```
MODIFY COLUMN `updated_at` TIMESTAMP NOT NULL DEFAULT current_timestamp; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-27T11:25:45.777

更改表 music_library_development 更改 created_at created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP；

更改表 music_library_development 更改 updated_at updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP

# algorithm - 分支和界限

> ID：842626
> 
> 赞同：4
> 
> 时间：2009-05-09T04:08:56.053
> 
> 标签：algorithm, search, branch-and-bound

有人可以为我解释一下分支定界搜索技术吗？我需要使用分支定界搜索算法从任何随机图的任何开始节点到结束节点找到一条成本最小的路径。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-09T15:40:05.530

B&B的基本理念是：

1.  当解决一个优化问题（“找到一个满足标准 Y 的 X 以最小化成本 f(X)”）时，你会逐步构建一个解决方案——在任何时间点，你都有一个*部分解决方案*，它有一个*成本*。
2.  如果问题的性质是部分解决方案的成本只能保持不变或随着您继续添加部分而增加，那么您知道**如果已经有部分解决方案，继续添加部分是没有意义的成本更低的完整解决方案**。在这种情况下，您可以放弃（或“修剪”或“深挖”）此部分解决方案的进一步处理。

许多问题都具有后一种性质，使 B&B 成为一种广泛适用的算法技术。

搜索解决方案的过程可以用*搜索树*来表示，其中根节点表示尚未做出决定的起点，从节点引出的每条边都表示关于要包含在部分解决方案中的某事的决定。每个节点都是一个部分解决方案，包括从根到该节点做出的决策（边）。

**示例：**如果我们想解决数独难题，根节点将代表仅填写最初提供的数字的棋盘；从这个根开始可能有 9 条边，每条边代表将数字 1-9 分配给左上角单元格的决定。这 9 个部分解决方案节点中的每一个都可以有 8 个分支，表示对位置 (1, 2) 的单元格的有效分配，依此类推。通常，每条边代表程序中的一个递归步骤。

使用 B&B，在最好的情况下，可以尽早找到一个好的解决方案，这意味着可以在根附近修剪搜索树中没有希望的区域；但在最坏的情况下，将生成整个有效解决方案树。出于这个原因，B & B 通常只用于解决没有更快算法已知的问题（例如 NP-hard 问题）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T04:27:25.323

[此链接](http://horicky.blogspot.com/2008/07/branch-and-bound-algorithm.html)提供了与 B & B 相关的概念的图形表示。

[此链接](http://www.codersource.net/csharp_branch_and_bound_algorithm_implementation.aspx)在可下载的 zip 文件中提供了算法和**示例 C# 代码的说明。**

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T09:03:49.077

网络上有很多关于分支定界算法的参考资料。

[在这里](http://www.cse.ohio-state.edu/~gurari/course/cis680/cis680Ch20.html)你可以找到一些理论解释。

而 C# 中的代码在[这里](http://www.codersource.net/Samples/Branch_Bound_code.zip)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-26T18:33:36.990

很棒的答案@j_random_hacker !!!!

请参阅 Papadimitriou 和 Steiglitz，组合优化中的第 439 页（示例 18.2）。

这本书是经典之作，它讨论了您的确切问题。

# css - 外部 CSS 的 Firefox 3 语法错误

> ID：842627
> 
> 赞同：4
> 
> 时间：2009-05-09T04:09:03.277
> 
> 标签：css, firefox, syntax-error, firefox-3

使用以下 html/css 时，在 Firefox 3.0.10/Leopard 中出现奇怪的语法错误：

foo.html：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<html lang="en">
<head>
  <link rel="stylesheet" href="foo.css"/>
</head>
<body>
Foo
</body>
</html> 
```

foo.css：

```
div {
  color: #FF0000;
} 
```

我在控制台中得到的错误是：

```
Error: syntax error
Source File: file://path/to/foo.css
Line: 1, Column: 1
Source Code:
div { 
```

这不是 CSS，因为将它粘贴到内联 STYLE 标记的正文中可以正常工作。这不是链接标签，因为将 HREF 指向堆栈溢出的 css 文件不会出错。感觉就像一个 Firefox 错误，但我找不到任何文档。这是一个已知问题，是否有解决方法？它使调试或验证变得困难。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T04:35:58.533

它给你文件中第一个字符的错误，这是一个'd'，它排除了我的“隐藏”特殊字符之类的东西。我猜firefox由于某种原因无法在本地打开文件，或者该文件被意外保存为一种编码，尽管它在对话框中显示正常，但不能正常解析。也许它被错误地保存为Unicode？

如果您可以将我们链接到实际文件，这将有所帮助，因为您的语法（尽管标记不完全有效，但我认为不是这样）在您粘贴的 .css 文件中是完美的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T04:59:03.033

正如评论中所建议的那样，答案原来是“关闭扩展（它是 YSlow）”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T04:20:16.260

文件是写在windows上的吗？也许您需要将回车/换行重新格式化为 mac os x。尝试在命令行上通过类似 dos2unix 的方式运行该文件。也可能是你没有看到的[炸弹。](http://en.wikipedia.org/wiki/Byte-order_mark)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T04:24:58.027

我的猜测是有一些隐藏字符可能被意外保存在文件中。尝试重新保存 CSS 文件，或重新键入第一行，然后重新保存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-20T23:28:06.773

如果您来自 Google 并使用本地 html，请注意 Firefox 会阻止对使用该`file://`协议的外部 CSS 的请求，因为它在技术上是跨域请求。

一个快速的解决方法是将包含您的站点的目录提供给 localhost over `http://`。如果你安装了 python 解释器，你可以很容易地做到这一点：

```
python3 -m http.server 8080 
```

然后通过浏览器访问 localhost：

```
firefox localhost:8080 
```

您可以`8080`用任何其他端口替换。

# resolution - 我应该支持网站的标准“最低”分辨率是多少？

> ID：842638
> 
> 赞同：13
> 
> 时间：2009-05-09T04:19:06.497
> 
> 标签：resolution

### 复制：

> [推荐的网站分辨率（宽度和高度）？](https://stackoverflow.com/questions/456250)

我倾向于将 1024x768 视为现代网络浏览器将运行的最低屏幕分辨率，但在将这种分辨率用于商业网站时我担心，因为我觉得我可能会伤害那些被更小的东西困住的人/年纪大了。所以我问，实际上，我应该期望我的网站在浏览器“最大化”的情况下完美运行的最小屏幕分辨率是多少？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-09T04:21:25.277

寻找上网本以获得新的最低要求。我会说 1024x600 是合理的。

**编辑：**您可以随时查看任何数量的网站，这些网站可以为您提供有关浏览器使用情况的统计信息。这是谷歌为我找到的一个：

[http://www.w3schools.com/browsers/browsers_display.asp](http://www.w3schools.com/browsers/browsers_display.asp)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-09T05:23:14.987

来自 Jacob 的 Nielsen Alertbox 中的一篇名为[Screen Resolution and Page Layout](http://www.useit.com/alertbox/screen_resolution.html)的文章：

> 针对 1024x768 优化网页，但使用可以很好地拉伸任何分辨率（从 800x600 到 1280x1024）的流畅布局。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-09T04:27:04.047

取决于你的听众。如果主要是美国消费者在家里，那么我认为你用 1024x768 是安全的。对于学校、企业和全球国际观众，您将需要 800x600，因为学校和企业不太可能升级计算机，而且各个国家/地区的国际观众可能因任何原因无法获得更大的屏幕。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-09T04:36:38.030

我还可以建议您测试*最大*分辨率吗？由于人们使用固定字体大小等，许多网站在 1920x1200 时无法使用（没有缩放）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-09T05:11:41.690

亲爱的上帝，我们忘记了吗？

HTML（一种逻辑页面描述语言）的全部意义在于您永远不必考虑或担心显示设备。

如果显示设备是盲人的文本阅读器，会发生什么？

还是控制台上的纯文本浏览器？

但这不是重点。要点是 HTML*逻辑地*描述了页面。如果您在页面的逻辑描述中进行了纯粹的物理描述，那么您就错了。您正在编写网页，就像您正在发出 HTML 的 Word 一样！

您需要编写您的网站，以便它在逻辑上运行 - 也就是说，您将渲染问题完全交给渲染代理。如果你不这样做，那你就错了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-09T04:33:27.820

考虑使用适应用户屏幕的流畅布局。大多数具有固定布局的网站迫使大多数用户查看以最小公分母为目标的网站，即使 90% 的访问者有更高的可用分辨率。这会导致布局过度填充导航 chrome 和少量内容。

如果您必须使用固定布局，请考虑从 MSN 中获取提示，将屏幕分成 760 和 224 像素列。如果访问者的分辨率为 800（您可以在 JavaScript 中检测到），则隐藏 224 像素列。

**来自评论的更新**：至于确定一个安全的最小值，尽管我将您的屏幕设置为 800x600，然后浏览一些流行的公共网站 - MSN、Yahoo 等，看看他们做了什么。这是一个不错的选择，他们在这一领域投入了大量研究，采用他们所做的通常是一个安全的选择

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-09T04:27:54.137

1024x768 没问题。大多数人都有该分辨率设置，而没有设置的人的用户体验不会受到严重影响。此外，为了确保您的页面能很好地适应浏览器，考虑到滚动条等，请将您的页面设置为 960 像素。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-09T10:42:47.683

1) 我的浏览器没有最大化。我的屏幕大小无关紧要。我的浏览器窗口的大小确实如此。

2) iPhone 的屏幕分辨率为 480x320。NewEgg 目前以低于 200 美元的价格列出了至少一台 1920x1080 显示器。设计到这两种分辨率中的任何一种都会使您的网站在另一种上完全无法使用。即使您将差异和设计拆分为 1024x768，您也会在 200 美元的显示器上得到一条覆盖一半屏幕宽度的条纹（在 IMO 看来，这看起来像废话），并且在 iPhone 上仍然完全无法使用。

屏幕不仅越来越大。它们也越来越小。趋势正在转向流畅的布局而不是固定宽度，这是有充分理由的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-09T04:20:40.627

我通常设计800宽的网站。

高度不是问题，因为用户可以滚动。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-09T04:28:39.597

正如马克所说，现在有很多上网本。它们中的大多数现在具有 1024x600 尺寸，但也有一些“较旧”的上网本的分辨率仍然较低。例如，我的有 * *wince* * 800x480。

如果你想真正兼容，就选择800，否则，我会说你用1024好，至于高度，用户可以随时滚动。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-09T04:31:16.547

不要忘记滚动条、工具栏和侧边栏会稍微限制空间。即使您假设分辨率至少为 1024*768，也不要将页面设置为 1024 宽。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-09T04:50:34.317

绝对是 1024 宽（如 980px 左右可用），但请不要为固定高度设计。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-09T07:25:58.733

我会看看这些统计数据：[http](http://www.w3schools.com/browsers/browsers_display.asp) ://www.w3schools.com/browsers/browsers_display.asp 。

截至 2009 年 1 月，只有 4% 的访问 W3Schools 的人使用 800x600 作为分辨率。其余的至少使用 1024x768。

不过，请注意这 4% 中有多少可能是您的用户的一部分。

# linux - 以不同的语言运行 Qt 应用程序？

> ID：842641
> 
> 赞同：7
> 
> 时间：2009-05-09T04:20:28.147
> 
> 标签：linux, qt, localization, internationalization

我正在开发一个曾经是 KDE 应用程序的 Qt 应用程序。在过去，我只需要使用一些语法，例如：

```
KDELANG=de ./my_app 
```

那是用德语运行 my_app，而且只有 my_app。它可能不是 KDELANG，但它是一些类似的环境变量。

我花了很多时间试图从谷歌哄骗这个答案，我放弃了。必须有某种方法可以用其他语言运行 Qt（如果重要，则为 4.5）应用程序，而无需切换我的整个语言环境即可到达那里。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T04:34:47.630

我用 KDE 游戏 Kolf 试了一下，

```
(export LANG=de_DE.UTF-8; kolf)
(export LANG=en_US.UTF-8; kolf) 
```

帮我把它转换成德语或英语。

我用 QT 应用程序 qtparted 验证了它

```
(export LANG=de_DE.UTF-8; qtparted) 
```

在我的英文桌面上也出现了德文。显然，我必须安装德语文件才能使翻译后的应用程序正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-07-26T18:09:30.340

就像任何其他 Linux 应用程序一样，Qt 应用程序遵循一种相当复杂的方式来选择应用程序消息区域设置：环境变量`LANGUAGE`优先于`LC_ALL`、`LC_ALL`over `LC_MESSAGES`、`LC_MESSAGES`over `LANG`（[详细信息](https://superuser.com/q/392439)）。

因此，以下任何一个命令都可以更改应用程序的消息区域设置，如返回`QLocale::system().name()`：

```
LANGUAGE=de ./my_app
LANGUAGE=   LC_ALL=de ./my_app
LANGUAGE=   LC_ALL=   LC_MESSAGES=de ./my_app
LANGUAGE=   LC_ALL=   LC_MESSAGES=   LANG=de   ./my_app 
```

**笔记：**

*   我在 Lubuntu 19.10 下用 Qt 5.12 测试了这个（意思是，使用 LXQt 桌面）。

*   完全取决于 Qt 应用程序如何适应`QLocale::system()`. 它可能根本不评估`QLocale::system()`，或者找不到它的翻译文件等。

*   您也可以在表格中给出上述命令`env LANGUAGE=de ./application`。该`env`命令有更多选项来控制其子进程将看到的环境。

*   环境变量（此处`de`）中指定的区域设置值不必*对应*于系统范围内安装并在 中列出的任何区域设置`locale -a`。

*   当仅指定一种语言（如`de`）时，Qt 将自动使用默认国家/地区扩展它，并在 中返回它`QLocale::system().name()`，例如`de_DE`.

*   当指定错误的值（例如`xy`）时，Qt 将返回默认的`C`语言环境`QLocale::system().name()`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T01:30:36.750

好吧，说来话长，但事实证明，翻译实际上是失败的，这就是这里的全部潜在问题。我首先尝试的显而易见的事情很好。由于这不是 KDE，我只使用了普通的：

```
LANG=de ./my_app 
```

现在我已经修复了调试代码中的错误（哦，具有讽刺意味），我可以清楚地看到翻译文件（确实存在）没有被加载。啊。那好吧。继续。这没东西看。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-09-12T18:27:48.627

如果您使用的是等离子桌面，请从系统设置 -> 语言环境下安装语言包并运行应用程序，如下所示：`KDE_LANG=fr ./appName` fr 代表法语，您可以选择您感兴趣的语言。

# ajax - 使用 AJAX 有什么缺点吗？

> ID：842664
> 
> 赞同：3
> 
> 时间：2009-05-09T04:37:01.353
> 
> 标签：ajax

使用 AJAX 有什么缺点吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-09T04:39:28.413

没有与浏览器的历史集成。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-09T04:48:23.307

如果您构建的站点*需要*Ajax 来查看内容和执行任务，那么您将遇到几个主要问题。仅 Ajax 的内容/功能对以下内容不可见/不可用：

*   搜索机器人
*   许多手机
*   关闭 Javascript 的人

等等等等

**但是，如果您使用渐进增强**原则构建站点，这些问题就解决了，您仍然可以为大多数用户提供易用的 Ajax。

**渐进式增强**涉及首先使用**准系统 (X)HTML**根据类似 REST 的原则创建您的站点（至少在需要 POST 请求以更改状态的范围内）。简单的语义标记；忘记 CSS 和 Javascript。

第一步是做到这一点，并让您的整个网站（或尽可能多的网站）以这种方式很好地为搜索机器人和类似 Lynx 的用户代理工作。

然后添加一个**视觉层**：CSS/graphics/media 进行视觉润色，但不要显着改变您原来的 (X)HTML 标记；允许原始纯文本网站保持完整和正常运行。保持标记干净！

三是添加**行为层**：Javascript（Ajax）。为使用支持 Ajax 的 JS 的用户/浏览器提供更快、更流畅、更好的体验……但仅限于那些用户。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T04:39:11.053

浏览器兼容性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-09T04:47:47.740

对数据的异步访问意味着在每种操作组合中都更难使事情正确进行。

javascript 的依赖性使该网站对某些人无法使用。在资源有限的环境中，javascript 性能也可能成为瓶颈。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T04:43:28.437

用户可能无法通过客户端知道进行了 AJAX 操作，或者它是否失败。从失败的 AJAX 调用导致的客户端错误中恢复可能很困难。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-09T04:57:39.573

做功能测试真的很困难。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-09T12:13:32.890

最终，问题在于它引入了复杂性。AJAX 站点固有的大多数问题（书签、浏览器历史记录、优雅降级等）都可以通过良好的设计来克服，因此设计良好的启用 AJAX 的站点实际上并没有任何缺点。问题是创建这样一个网站需要大量的设计和能够管理复杂性的非常优秀的开发人员。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-09T04:41:14.760

无法在没有“轮询”的情况下更新客户端，这意味着每 X 秒查询一次服务器。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-09T05:08:05.880

它需要javascript。你必须向你的朋友承认你是多么的“Web 2.0”。而不是顽固的老派：对我来说，这都是用于布局的表格和用于导航的框架。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-09T05:24:08.947

是的，旧浏览器或未启用 javascript 的浏览器不支持 Ajax。如今，大多数浏览器都支持 Ajax —— 甚至像 iPhone 上的移动浏览器。

对我来说最大的问题是 Ajax 增加了项目的复杂性。

那里有许多 ajax 库，它们可以让生活更轻松。在大多数情况下，这些库很容易用于创建“Hello World”应用程序。大多数时候被 Ajax 库搁置的主要问题之一是（客户端）错误处理/日志记录。

对于较大的项目，开发人员必须了解库的内部结构，这为项目增加了新的学习规则。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-09T08:56:06.520

我们的一些大客户——出于安全原因——做出关闭 javascript 的公司决定。因此没有 AJAX 是可能的。

如果您要为给定的客户端使用 AJAX 开发某些东西，请确保您的客户端被允许使用 javascript。

将您的应用程序限制在合理数量的浏览器和浏览器版本上。

跨浏览器兼容性会让你的生活变得悲惨。

# apache-flex - 您如何解决将接口对象转换回其基类的需要？

> ID：842665
> 
> 赞同：1
> 
> 时间：2009-05-09T04:37:54.020
> 
> 标签：apache-flex, actionscript-3, interface

这个问题通常适用于接口，但我将使用 AS3/Flex 作为我的语言。如何在不同的语言中应用它应该是 [大部分] 显而易见的。

如果我创建了一个基类，并且它扩展了一个接口，则定义了一个明确的约定：对于接口中的每个方法，基类都*必须*实现所述方法。

这很容易。但是我不明白为什么您有能力将接口实例转换回其原始基类。当然，我不得不这样做几次（下面的例子非常接近我正在努力的情况），但这并不意味着我理解它:^)

这是一个示例界面：

```
public interface IFooable extends IUIComponent {
    function runFoo():void;
} 
```

假设我创建了一个基类，它扩展了 VBox 并实现了接口：

```
public class Foo extends VBox implements IFooable {
    public Foo() {
        super();
        //stuff here to create Foo..blah blah
    }
    public function runFoo():void {
        // do something to run foo
    }
} 
```

现在，我使用接口的原因是因为我想保证“runFoo”总是被实现。这是我的所有类都应该具备的通用功能，无论它们如何实现它。因此，我的父类（一个应用程序）将通过其接口实例化 Foo：

```
public function init():void {
    var foo:IFooable = new Foo();
    foo.percentHeight = 100; //works because of IUIComponent
} 
```

*但是*，如果我想将 Foo 添加到 Application 容器，我现在必须将其转换回基类（或不同的基类）：

```
public function init():void {
    var foo:IFooable = new Foo();
    foo.percentHeight = 100;

    addChild(foo as DisplayObject); //_have_ to cast, because addChild takes a 'DisplayObject' class type

    //could also do this:
    //addChild(foo as VBox);
} 
```

不就是隐藏 Foo 的实现的初衷吗？仍然假设 Foo*是*一个 DisplayObject。不幸的是，如果不进行强制转换，就不可能将自定义对象添加到容器中。

我完全错过了什么吗？这真的只是 Flex/AS3 中的一种现象吗？如果你在一种语言的基础 API 中有一个容器，并且它只允许你添加某种类类型的子类，那么你如何抽象出实现呢？

作为记录，[这个问题](https://stackoverflow.com/questions/539436/cast-interface-to-its-concrete-implementation-object-or-vice-versa)似乎是在询问这种操作是否*可行*，但它并没有真正解决为什么它可能是糟糕的设计（以及如何修复它）。

* * *

第二个想法：

**抽象类**：

正如 Matthew 所指出的，抽象类有助于解决其中的一些问题：我可以创建一个继承自 DisplayObject（或者，在我的情况下是 VBox，因为它是 DisplayObject 的子级）的基本抽象类，并让基类实现界面。因此，任何扩展抽象类的类都需要实现其中的方法。

好主意——但 AS3 没有抽象类（据我所知，无论如何）。

所以，我*可以*创建一个实现接口并扩展VBox的基类，并从它继承，我可以在需要扩展的方法中插入代码；如果基类是执行程序，则此类代码将引发错误。不幸的是，这是运行时检查，而不是编译时强制执行。

不过，这仍然是一个解决方案。

* * *

**上下文**：

一些上下文可能会有所帮助：

我有一个可以有任意数量的子容器的应用程序。这些子容器中的每一个都有各自的配置选项、参数等。然而，应用程序本身有一个全局 ApplicationControlBar，它将包含用于访问这些配置选项的入口点菜单。因此，每当我向主应用程序添加子组件时（通过“addChild”），它也会在 ApplicationControlBar 菜单中“注册”自己的配置选项。这保留了容器本身的可配置性知识，但允许更统一的方式访问它们。

因此，当我创建每个容器时，我想通过它们的接口实例化它们，这样我就可以保证它们可以注册到 ApplicationControlBar。但是当我将它们添加到应用程序时，它们需要成为基类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T00:15:31.580

@James Ward，这绝对是我希望的语言，可能是 IDisplayObject 接口。这将解决 AS3 中 OOP 显示编程中的许多问题。

关于最初的问题，我过去使用过并且在 www.as3dp.com 上看到过的内容是在接口中包含一个 getDisplay():DisplayObject 方法，该方法通常会由其实现者返回“this” . 它不太理想，但有效。

@Matthew Flaschen，虽然我们没有 AS3 原生的 Abstarct 类，但通常的做法是使用 Abstract 一词命名该类，即：AbstarctMyObject，然后将其视为 Java 和其他语言中的抽象对象。Flash 播放器团队非常清楚我们对真正抽象类的需求，我们很可能会在下一版本的 ActionScript 语言中看到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T05:02:00.467

好的，我一般地回答，因为你说，“这真的只是 Flex/AS3 中的一种现象吗？”。

在您的 init 方法中，显然您总是使用 foo 调用 addChild。这意味着 foo 必须始终是 DisplayObject 的实例。您还希望它成为 IFooable 的一个实例（尽管这里不清楚为什么）。由于 DisplayObject 是一个类，您可以考虑使用实现 IFooable 的 DisplayObject 的子类（例如 FooableDisplayObject）。在 Java 中，这将在下面。我不熟悉 AS，但我认为这表明这里的接口没有任何普遍缺陷。

```
interface IFooable
{
    public void runFoo();
}

class DisplayObject
{

}

abstract class FooableDisplayObject extends DisplayObject implements IFooable
{

}

class Foo extends FooableDisplayObject
{
    public void runFoo()
    {

    }
}

public void init()
{
    FooableDisplayObject foo = new Foo();
    foo.percentHeight = 100;

    addChild(foo);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T05:26:16.353

我认为这是 Flex 的/Flash 的 API 不正确的地方。我认为`addChild`应该采用接口而不是类。但是，由于情况并非如此，因此您必须对其进行投射。另一种选择是猴子补丁`UIComponent`，以便它采用接口或添加另一种方法，如`addIChild(IUIComponent)`. 但这很乱。所以我建议你[提交一个错误](http://bugs.adobe.com/flex)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-19T02:25:06.253

这里的情况是，它应该是最佳实践的相反方式......您不应该将您的界面转换为显示对象，而是将您的实例作为显示对象，然后将其转换为您的界面以应用特定方法.

假设我有一个基类 Page 和其他子类 Homepage、Contactpage 等。现在您不必将东西应用到基类，因为它是一种抽象，而是为子类设计接口。

假设子页面实现了一个接口来处理 init、addedtostage、loader 和其他任何东西，以及另一个处理逻辑的接口，并最终将基本请求作为显示对象进行管理。

开始设计实现..一个人应该只使用专门的东西的接口并从它主要所属的地方扩展子类..现在页面具有要显示的“基本”含义（设计明智......“基本”- class 是一个显示对象），但可能需要一些专门化，为此构建一个接口来覆盖它。

```
 public class Page extends Sprite{...}
        public interface IPageLoader{ function loadPage():void{}; function initPage():void{}; }
        public class Homepage extends Page implements IPageLoader
        { function loadPage():void{/*do stuff*/}; function initPage():void{/*do stuff*/}; }

        var currentpage:Page;
        var currentpageLoader:IPageLoader;

        currentpage = new Homepage;
        currentpageLoader = currentpage as IPageLoader;

        currentpageLoader.loadPage();
        currentpageLoader.initPage();

        addChild(currentpage);
        Tween(currentpage, x, CENTER); 
```

# crystal-reports - 如何在水晶报表 10.0 版中抑制子报表？

> ID：842675
> 
> 赞同：0
> 
> 时间：2009-05-09T04:41:33.980
> 
> 标签：crystal-reports, c#-2.0

我需要压制子报告。我有一个名为“TransactionType”的参数字段；只有当 TransactionType 为“Multiple”时，我才需要显示子报表选项；否则，它应该显示为空白。我已经检查了子报告中的抑制选项。如果 transactiontype 是 Multiple 然后显示 subreport 或者不显示子报告，我需要一个抑制子报告的公式。这个怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T02:35:57.277

将子报表单独放入页脚部分。在部分属性中（通过部分专家到达那里）将抑制选项的公式设置为
(TransactionType <> "Multiple") Then True;

# crystal-reports - 水晶报表 - 标题抑制

> ID：842685
> 
> 赞同：1
> 
> 时间：2009-05-09T04:47:35.650
> 
> 标签：crystal-reports

在水晶报表中，当上一页上的记录完成时，我们如何在 pagenumber >= 2 上抑制页眉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T05:21:40.997

转到标题的部分专家。使用复选框抑制它，然后在抑制公式中执行此操作（使用基本语法）：

如果 pagenumber > 1 那么公式 = true

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T04:58:49.070

也许[这](http://www.c-sharpcorner.com/UploadFile/mahesh/MultiPageHeadersInCR07182006145156PM/MultiPageHeadersInCR.aspx)会有所帮助？只需制作几个标题和一个隐藏在非第一页上的条件......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-17T09:49:29.883

如果 Detail 部分没有记录，您可能想隐藏第二页的页眉。

请看一下

[水晶报表页面明细记录数](https://stackoverflow.com/questions/5089400/number-of-details-records-on-the-crystal-report-page/8164928#8164928)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-26T09:22:03.167

在抑制公式框中，您只需输入

```
Pagenumber<>1 
```

除了第一页之外的所有页面都是如此，因此将抑制除第一页之外的所有页面。

# ajax - 为什么浏览器不让您打开常规连接而不是 Ajax 或 Comet？

> ID：842689
> 
> 赞同：1
> 
> 时间：2009-05-09T04:49:36.253
> 
> 标签：ajax, comet, browser

如果要在浏览器和服务器之间打开双向连接，唯一的选择是轮询（锤击服务器），或者使用彗星（粗鲁且容易断开连接）。

为什么浏览器不让你打开一个普通的 TCP 连接？没有这种能力有什么实际好处吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T05:02:45.410

底层协议 HTTP 基本上是一个半双工通信协议，也是无状态的，不支持全双工通信。然而，随着 HTML 5 websockets 的出现，事情将会改变。Websockets 是 HTML 5 规范中正在考虑的新标准。一旦规范最终确定并且所有浏览器供应商都调整了标准，您就可以使用 websockets 通过浏览器本身建立专用的 TCP 连接。

我们还必须记住，HTTP 基本上是为了在地理分布的团队之间传递文档和共享信息而设计的，它本身并不是一种通信协议。

话虽如此，已经有公司构建了一些消息传递网关，使您能够实现全双工通信。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-11T13:51:39.600

防火墙。非 HTTP 流量通常会被防火墙阻止，因此打开一个随机 TCP 端口进行通信通常会失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T05:01:57.517

鉴于此功能可通过 flash 有效获得，因此没有真正的安全理由 - 但如今，没有浏览器希望成为第一个实现此类非标准扩展的浏览器。此外，没有简单的方法来处理线程，这可能会使使用套接字相当尴尬。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T05:07:08.193

多年来，为了提供更丰富的体验，网络的许多方面或元素都被劫持了。Comet 只是一个例子，它利用长寿命连接来允许服务器端推送。最初，网页只是作为文本的超链接文档，而不是我们今天经常看到的丰富应用程序。对最初想法的攻击和滥用将继续存在，直到有一天这些事情变得更加标准化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-02T23:41:22.587

您的问题的答案基本上是否定的，无法在浏览器中打开客户端和服务器之间的双向连接没有明显的优势。不能这样做的原因很简单，这不是 Web 浏览器的意图，Web 浏览器是为轮询/检索文档而开发的。随着富 Internet 应用程序的出现，人们希望拥有这样的功能，但以前这从来不是浏览器的目标。目前，最终协议或现有协议的实现存在一个空白，该协议将管理浏览器和服务器之间的双向通信。现有技术用于在不同程度上模拟这种行为（AJAX、Comet 等），或者可以使用嵌入式对象（Java、Flash、

我们将只需要等待（或采取行动）编写标准并遵循实施。更有可能的是，实现实际上会首先出现，我们将有一大堆新的跨浏览器兼容性问题来享受:) 哦，最前沿！

# python - 如何使用表示为 unicode 的 python 对象列表

> ID：842696
> 
> 赞同：4
> 
> 时间：2009-05-09T04:51:29.883
> 
> 标签：python, unicode

我有一个包含 unicode 数据的对象，我想在它的表示中使用它，例如

```
# -*- coding: utf-8 -*-

class A(object):

    def __unicode__(self):
        return u"©au"

    def __repr__(self):
        return unicode(self).encode("utf-8")

    __str__ = __repr__ 

a = A()

s1 = u"%s"%a # works
#s2 = u"%s"%[a] # gives unicode decode error
#s3 = u"%s"%unicode([a])  # gives unicode decode error 
```

现在，即使我从**repr**返回 unicode，它仍然会给出错误，所以问题是我如何使用这些对象的列表并从中创建另一个 unicode 字符串？

平台详情：

```
"""
Python 2.5.2 (r252:60911, Jul 31 2008, 17:28:52)
[GCC 4.2.3 (Ubuntu 4.2.3-2ubuntu7)] on linux2
'Linux-2.6.24-19-generic-i686-with-debian-lenny-sid'
""" 
```

也不知道为什么

```
print a # works
print unicode(a) # works
print [a] # works
print unicode([a]) # doesn't works 
```

python 组回答 [http://groups.google.com/group/comp.lang.python/browse_thread/thread/bd7ced9e4017d8de/2e0b07c761604137?lnk=gst&q=unicode#2e0b07c761604137](http://groups.google.com/group/comp.lang.python/browse_thread/thread/bd7ced9e4017d8de/2e0b07c761604137?lnk=gst&q=unicode#2e0b07c761604137)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T09:52:02.703

`s1 = u"%s"%a # works`

这是有效的，因为在处理 'a' 时，它使用它的 unicode 表示（即**unicode**方法），

但是，当您将其包装在诸如 '[a]' 之类的列表中时...当您尝试将该列表放入字符串中时，所调用的是 unicode([a]) （与列表的情况），列表的字符串表示形式，它将使用 'repr(a)' 在其输出中表示您的项目。这将导致一个问题，因为您正在传递一个包含 'a' 的 utf-8 编码版本的 'str' 对象（一个字节字符串），并且当字符串格式试图将其嵌入到您的 unicode 字符串中时，它会尝试使用 hte 默认编码（即 ASCII）将其转换回 unicode 对象。因为 ascii 没有它试图转换的任何字符，所以它失败了

您想要做的事情必须这样做：`u"%s" % repr([a]).decode('utf-8')`假设您的所有元素都编码为 utf-8（或 ascii，从 unicode 的角度来看，这是一个 utf-8 子集）。

为了获得更好的解决方案（如果您仍然希望字符串看起来像列表 str），您必须使用之前建议的内容，并使用 join，如下所示：

你`'[%s]' % u','.join(unicode(x) for x in [a,a])`

尽管这不会处理包含您的 A 对象列表的列表。

我的解释听起来非常不清楚，但我希望你能理解它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T06:17:06.293

尝试：

```
s2 = u"%s"%[unicode(a)] 
```

您的主要问题是您进行的转换比您预期的要多。让我们考虑以下几点：

```
s2 = u"%s"%[a] # gives unicode decode error 
```

从[Python 文档](http://docs.python.org/library/stdtypes.html#string-formatting-operations)，

```
    's' 字符串（使用 str() 转换任何 python 对象）。
    如果提供的对象或格式是 unicode 字符串，
    结果字符串也将是 unicode。

```

在处理 %s 格式字符串时，将应用 str([a])。此时您拥有的是一个包含一系列 unicode 字节的字符串对象。如果您尝试打印，则没有问题，因为字节直接传递到您的终端并由终端呈现。

```
>>> x = "%s" % [a]
>>> print x
[©au] 
```

当您尝试将其转换回 unicode 时，就会出现问题。本质上，函数 unicode 在包含 unicode 编码字节序列的字符串上被调用，这就是导致 ascii 编解码器失败的原因。

```
    >>> u"%s" % x
    回溯（最近一次通话最后）：
      文件“”，第 1 行，在
    UnicodeDecodeError：“ascii”编解码器无法解码位置 1 的字节 0xc2：序数不在范围内（128）
    >>> unicode(x)
    回溯（最近一次通话最后）：
      文件“”，第 1 行，在
    UnicodeDecodeError：“ascii”编解码器无法解码位置 1 的字节 0xc2：序数不在范围内（128）

```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-11T06:49:41.293

首先，问问自己你想要达到什么目标。如果您想要的只是列表的可往返表示，您应该简单地执行以下操作：

```
class A(object):
    def __unicode__(self):
        return u"©au"
    def __repr__(self):
        return repr(unicode(self))
    __str__ = __repr__

>>> A()
u'\xa9au'
>>> [A()]
[u'\xa9au']
>>> u"%s" % [A()]
u"[u'\\xa9au']"
>>> "%s" % [A()]
"[u'\\xa9au']"
>>> print u"%s" % [A()]
[u'\xa9au'] 
```

这就是它应该如何工作的方式。python 列表的字符串表示不是用户应该看到的，因此在其中包含转义字符是有意义的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T08:43:17.893

如果您想使用`unicode()`能够对象的列表来创建 unicode 字符串，请尝试以下操作：

```
u''.join([unicode(v) for v in [a,a]]) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-11T07:28:10.233

由于这个问题涉及很多令人困惑的 unicode 内容，我想我会分析这里发生的事情。

这一切都归结为内置`__unicode__`类的实现。基本上，它相当于：`__repr__``list`

```
class list(object):
    def __repr__(self):
        return "[%s]" % ", ".join(repr(e) for e in self.elements)
    def __str__(self):
        return repr(self)
    def __unicode__(self):
        return str(self).decode() 
```

实际上，[`list`甚至没有定义`__unicode__`and`__str__`方法](http://svn.python.org/view/python/tags/r252/Objects/listobject.c?view=markup)，当您考虑它时，这是有道理的。

当你写：

```
u"%s" % [a]                          # it expands to
u"%s" % unicode([a])                 # which expands to
u"%s" % repr([a]).decode()           # which expands to
u"%s" % ("[%s]" % repr(a)).decode()  # (simplified a little bit)
u"%s" % ("[%s]" % unicode(a).encode('utf-8')).decode() 
```

最后一行是 repr(a) 的扩展，使用`__repr__`问题中的实现。

如您所见，该对象首先以 utf-8 编码，稍后才使用系统默认编码进行解码，该编码通常不支持所有字符。

正如提到的其他一些答案，您可以编写自己的函数，甚至子类列表，如下所示：

```
class mylist(list):
    def __unicode__(self):
        return u"[%s]" % u", ".join(map(unicode, self)) 
```

请注意，此格式不可往返。它甚至可能具有误导性：

```
>>> unicode(mylist([]))
u'[]'
>>> unicode(mylist(['']))
u'[]' 
```

当然，您可以编写一个`quote_unicode`函数来使其可往返，但现在是时候问自己[有什么意义](http://#846989)。和函数旨在创建对用户有意义的对象表示`unicode`。`str`对于程序员来说，有这个`repr`功能。原始列表不是用户应该看到的。这就是`list`该类不实现该`__unicode__`方法的原因。

为了更好地了解什么时候会发生什么，请使用这个小类：

```
class B(object):
    def __unicode__(self):
        return u"unicode"
    def __repr__(self):
        return "repr"
    def __str__(self):
        return "str"

>>> b
repr
>>> [b]
[repr]
>>> unicode(b)
u'unicode'
>>> unicode([b])
u'[repr]'

>>> print b
str
>>> print [b]
[repr]
>>> print unicode(b)
unicode
>>> print unicode([b])
[repr] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-09T04:54:18.207

```
# -*- coding: utf-8 -*-

class A(object):
    def __unicode__(self):
        return u"©au"

    def __repr__(self):
        return unicode(self).encode('ascii', 'replace')

    __str__ = __repr__

a = A()

>>> u"%s" % a
u'\xa9au'
>>> u"%s" % [a]
u'[?au]' 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-09T05:05:23.190

**repr**和**str**都应该返回 str 对象，至少到 Python 2.6.x。您收到解码错误，因为 repr() 正在尝试将您的结果转换为 str，但它失败了。

我相信这在 Python 3.x 中已经改变了。

# math - 对人类听觉的 FFT 数据进行归一化

> ID：842704
> 
> 赞同：5
> 
> 时间：2009-05-09T04:55:27.080
> 
> 标签：math, signal-processing, fft

音频的典型 FFT 看起来与此非常相似，大部分动作发生在最左侧

[http://www.flight404.com/blog/images/fft.jpg](http://www.flight404.com/blog/images/fft.jpg)

他将它乘以一个部分正弦波以使其达到底部，但文章对这部分并不太具体。它也似乎是对数据集的“足够好”修改，而不是基于某些属性的修改。我知道人类的听觉更适合更高的频率，因此，大多数音乐都会放大低音和衰减高音，这样我们听起来两者的强度相对相等。

我的问题是需要对 FFT 进行哪些修改以补偿此标准衰减？

```
for(i = 0; i < fft.length; i++){
     fft[i] = fft[i] * Math.log(i + 1); // does, eh, ok but the high
                                        // end is still not really "loud"
                                        // enough
} 
```

编辑 ：：

[http://en.wikipedia.org/wiki/Equal-loudness_contour](http://en.wikipedia.org/wiki/Equal-loudness_contour)

我偶然发现了这篇文章，我认为这可能是前进的方向，但仍然可能需要抵消 FFT 的某些特性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T17:51:56.230

我认为[等响度轮廓](http://en.wikipedia.org/wiki/Equal-loudness_contour)正是正确的方向。然而，它的形状取决于绝对压力水平。换句话说，我们的听觉灵敏度曲线会随着声压的变化而变化。

如果您没有关于绝对水平的信息，则没有“正确的标准化”。如果这是一个问题，取决于您要对数据做什么。

响度等值线在 ISO 226 中进行了标准化，但此文档不可免费下载。不过，它应该在一个体面的大学图书馆里。这是[响度轮廓的另一个来源](http://www.sengpielaudio.com/Acoustics226-2003.pdf)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T00:26:38.450

首先，您确定要这样做吗？补偿某些事情是有意义的，例如麦克风响应不平坦，但不是人类感知。人们习惯于听到声音具有真实世界中声音的频谱内容，而不是沿着感知等响度曲线。如果您以您建议的方式播放您修改过的声音，那听起来会很奇怪。也许有些人喜欢音乐增强低频，但这是品味问题，而不是心理物理学。

或者您可能出于其他原因进行补偿，例如，考虑到对较低频率的较差灵敏度可能会增强压缩算法。这是这个主意吗？

如果您确实想通过等响度曲线进行归一化，则应注意大多数曲线和方程都是根据声压级 (SPL)。SPL 是波形幅度平方的对数，因此当您使用 FFT 时，使用它们的平方（功率谱）可能是最容易的。（或者，当然，您可以通过其他方式进行补偿，例如，在上面的等式中乘以 sqrt(log(i+1)) - 假设对数是反等响度曲线的近似值。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T05:02:14.833

所以你想提高高端频率的水平？听起来像具有最小乘数的高通滤波器可能会起作用，这样您就不会过多地衰减低频信号。拿起一本关于过滤器设计的好书，也许可以用[这个小程序到处乱逛](http://www.dsptutor.freeuk.com/FIRFilterDesign/FIRFilterDesign.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T17:13:18.393

在第一个采样器的旧时代，这是在 MOTU Boost 人之前 :) 它不是 FFT，而是简单（我认为首先是 Fairlight 或 Roland）对原始或生成的时域信号进行归一化（如果您正在进行节拍切片） , 回收式); 你不能那样做吗？还是仅在您进行补偿以抵消它之后才进行 FFT？

否则似乎是一个两阶段程序，我个人会按照任务原样离开 FFT。

# c++ - 如何从命令行使用 MSBuild 构建所有内容？

> ID：842706
> 
> 赞同：7
> 
> 时间：2009-05-09T04:55:44.240
> 
> 标签：c++, visual-studio-2008, msbuild

这是有效的吗？

```
MSBuild /t=all /configuration=all 
```

我想使用 Visual Studio 2008 中的 MSBuild 从命令行构建 sln 文件中所有项目的所有配置等。

我不想在调用 MSBuild 时指定它们，sln/proj 文件都有这些信息。如果我将配置添加到项目文件，我不想更改我的构建脚本。

所以对于目标我可以使用 BuildAll。如果我将配置留空，它将全部构建还是“BuildALL”对配置也有效？

编辑

基本上我要问的是给定一个 SLN 或 VCProj 文件，我希望 msbuild 迭代所有配置并自行构建它，或者一些可以发现它们的机制，因此我不必在命令行或在脚本。

即，当我添加或删除配置时，我不想更新我的构建脚本。这似乎是一件非常合理的事情。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-09T05:01:07.193

默认情况下，您无法使用 MSBuild 命令行选项构建所有配置。为此，您需要创建一个新目标（VS 项目）。

我这样做的方式是：

```
msbuild /t:BuildAll /Configuration:"Debug;Release;ContinuousIntegration" 
```

我制作了一个标准 Target，并将其命名为 BuildAll，对于我想要自动化的每个项目，我只需创建该 Target 并使其依赖于您想要自动构建的所有目标。

# c# - 匹配 SQL 中最接近的短语

> ID：842718
> 
> 赞同：0
> 
> 时间：2009-05-09T05:00:14.230
> 
> 标签：c#, sql, linq

我需要在 t-sql 或 linq 中编写一个查询，以匹配包含大多数用户输入单词的 db 记录。

示例：db 中的 nvarchar 字段：“快速棕色狐狸跳过懒狗”

用户输入：“棕牛”

该程序将匹配该记录，因为它有单词 brown。

让我知道是否需要提供更多示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T05:34:07.613

假设您在 MS SQL Server 环境中使用 T-SQL，那么您应该使用[全文搜索](http://msdn.microsoft.com/en-us/library/ms142571.aspx)技术。它为您提供速度，并让您远离重新发明轮子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T05:11:01.693

我们通常使用 UDF 将字符串拆分为表格数据，并且可以使用类似的命令。

```
declare @searchStr nvarchar(100)
set @searchStr = 'brown fox'
selecT T.* from test T, dbo.fnc_SplitSTring(@searchStr,' ')
where   T.name like '%' + token + '%'

CREATE   FUNCTION [dbo].[fnc_SplitString]
(
@InString varchar(8000),
@Delim char(1)
)
RETURNS @Return table
(
Position int identity,
Token varchar(100) -- Maximum token size is 100 chars...
)
As
BEGIN
    Declare @CR varchar(1),
    @LF varchar(1)
    Set @CR = char(10)
    Set @LF = char(13)
    -- 
    If @InString is null return
    -- 
    Declare @Pos int
    Declare @Pattern char(3)
    Set @Pattern = '%' + @Delim + '%'
    -- 
    Declare @Token varchar(30)
    SELECT @InString = @InString + @Delim -- add trailing delimiter
    SELECT @Pos = PATINDEX(@Pattern, @InString)
    WHILE (@Pos <> 0) BEGIN
        SELECT @Token = ltrim(rtrim(SUBSTRING(@InString, 1, @Pos - 1)))
        Select @Token = replace(@Token, @CR, '')
        Select @Token = replace(@Token, @LF, '')
        Insert @Return Values (@Token)
        SELECT @InString = STUFF(@InString, 1, PATINDEX(@Pattern, @InString),'')
        SELECT @Pos = PATINDEX(@Pattern, @InString)
    END
-- 
return
-- 
END 
```

# c# - .NET 网络浏览器控制自动化

> ID：842731
> 
> 赞同：3
> 
> 时间：2009-05-09T05:06:58.613
> 
> 标签：c#, flash, automation, sendmessage

我正在尝试在我的 C# 程序的 webbrowser 控件中运行的 flash 游戏上自动化一些东西。使用 user32 的 sendmessage dll，我可以点击常规页面（如 google）上的坐标，但它不适用于 flash 内容。我有什么办法可以做到这一点？Flash游戏也无法检测到它。我在 autoit 中有一个工作，但我想用 c# 重写它并使其工作最小化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T05:31:18.587

为什么不使用 System.Diagnostics.Process 类从 C# 程序中调用 Autoit/Autohotkey 脚本？

```
ProcessStartInfo psi = new ProcessStartInfo("your_script.ahk");
psi.CreateNoWindow = true;

Process procScript = Process.Start(psi);
procScript.WaitForExit(); 
```

请注意 CreateNoWindow=true 以确保它隐藏运行，并注意 WaitForExit() 以使您的代码等待进程返回。

AutoIt 和 AutoHotkey 有一些非常强大的自动化命令，这些命令经过多年的改进。很难重现同样可靠的类似 C#/.NET 功能，相信我已经尝试过了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-13T15:17:04.620

使用 SendMessage 或 PostMessage 将起作用。您需要发送 3 条消息，WM_MOUSEMOVE，然后是 WM_MOUSEDOWN，然后是 WM_MOUSEUP。WM_MOUSEMOVE 必须指示与 WM_MOUSEDOWN 和 WM_MOUSEUP 不同的位置。WM_MOUSEDOWN 和 WM_MOUSEUP 应该在同一个位置。为我工作。

# objective-c - Cocoa 自定义通知示例

> ID：842737
> 
> 赞同：69
> 
> 时间：2009-05-09T05:10:24.923
> 
> 标签：objective-c, cocoa, notifications

有人可以给我看一个带有自定义通知的 Cocoa Obj-C 对象的示例，如何触发、订阅和处理它？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-05-09T05:25:07.307

```
@implementation MyObject

// Posts a MyNotification message whenever called
- (void)notify {
  [[NSNotificationCenter defaultCenter] postNotificationName:@"MyNotification" object:self];
}

// Prints a message whenever a MyNotification is received
- (void)handleNotification:(NSNotification*)note {
  NSLog(@"Got notified: %@", note);
}

@end

// somewhere else
MyObject *object = [[MyObject alloc] init];
// receive MyNotification events from any object
[[NSNotificationCenter defaultCenter] addObserver:object selector:@selector(handleNotification:) name:@"MyNotification" object:nil];
// create a notification
[object notify]; 
```

有关更多信息，请参阅[NSNotificationCenter](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSNotificationCenter_Class/Reference/Reference.html#//apple_ref/doc/uid/20000219-2831)的文档。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2010-06-22T13:26:41.050

**第1步：**

```
//register to listen for event    
[[NSNotificationCenter defaultCenter]
  addObserver:self
  selector:@selector(eventHandler:)
  name:@"eventType"
  object:nil ];

//event handler when event occurs
-(void)eventHandler: (NSNotification *) notification
{
    NSLog(@"event triggered");
} 
```

**第2步：**

```
//trigger event
[[NSNotificationCenter defaultCenter]
    postNotificationName:@"eventType"
    object:nil ]; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-10T16:18:22.997

确保在释放对象时取消注册通知（观察者）。Apple 文档指出：“在释放观察通知的对象之前，它必须告诉通知中心停止向其发送通知”。

对于本地通知，下一个代码适用：

```
[[NSNotificationCenter defaultCenter] removeObserver:self]; 
```

对于分布式通知的观察者：

```
[[NSDistributedNotificationCenter defaultCenter] removeObserver:self]; 
```

# c++ - 运算符重载

> ID：842753
> 
> 赞同：0
> 
> 时间：2009-05-09T05:20:44.570
> 
> 标签：c++

我是 C++ 新手，这是我从 fortran 升级后的第一周。抱歉，如果这是一个简单的问题，但有人可以帮助我处理运算符重载。我写了一个有两个类的程序。一个对象包含一个向量和两个标量，另一个类只包含第一个对象。在此代码的测试实现中，我怀疑运算符重载有问题。该计划试图实现以下目标：

1) 初始化第一个结构。2) 初始化包含已初始化的第一个结构的第二个结构。导入后，值 val0 = 10 将添加到封闭结构 structure2.structure1 中向量的每个元素。3) 输出结构1 和结构2 变量进行比较。

对于这个简单的程序，我的输出是：

100
100
0
0
0 0 10
1 1 11
2 2 12
3 3 13
...

我期待：

100
100
0
10
0 0 10
1 1 11
2 2 12
3 3 13
...

显然，我重载的 = 运算符正在正确复制我的向量，但是其中一个标量？有人可以帮忙吗？

```
#include <iostream>
using namespace std;

typedef double* doublevec;

// This first class contains a vector, a scalar N representing the size of the vector, and another scalar used for intializing the vector.
typedef class Structure1
{
 int N, vec0;
 doublevec vec;
public: 
 // Constructor and copy constructor.
 Structure1(int Nin, int vecin) : N(Nin), vec0(vecin) { vec = new double [N]; for(int i = 0; i < N; i++) { vec[i] = i + vec0; } }
 Structure1(const Structure1& structurein);
 // Accessor functions:
 int get_vec0() { return vec0; }
 int get_N() { return N; }
 doublevec get_vec() { return vec; }
 // Overide equivalence operator:
 Structure1& operator=(const Structure1& right)
 {
  //Handle Self-Assignment
  if (this == &right) return *this;
  N = right.N;
  vec0 = right.vec0;
  for (int i = 0; i < N; i++)
  {
   vec[i] = right.vec[i];   
  }
  return *this;
 }
 // Destructor:
 ~Structure1() { delete []vec; }
} Structure1;

Structure1::Structure1(const Structure1& structurein)
{
 N = structurein.N;
 vec = new double[N];
 for(int i = 0; i < N; i++)
 {
  vec[i] = structurein.vec[i];
 }
}

// This class just contains the first structure.
typedef class Structure2
 {
  Structure1 structure;
  // Mutator Function:
  void mutate_structure();
 public:  
  // Constructor:
  Structure2(const Structure1& structurein) : structure(structurein) { mutate_structure(); }
  // Accessor Function:
  Structure1 get_structure() { return structure; }
  // Destructor:
  ~Structure2() {}
 } Structure2;

void Structure2::mutate_structure()
{
 int N = structure.get_N();
 Structure1 tempstruct(N,10);
 structure = tempstruct;
}

int main (int argc, char * const argv[])
{
 const int N = 100;
 Structure1 structure1(N,0);
 Structure2 structure2(structure1);

 cout << structure1.get_N() << endl;
 cout << structure2.get_structure().get_N() << endl;
 cout << structure1.get_vec0() << endl;
 cout << structure2.get_structure().get_vec0() << endl;

 for(int i = 0; i < N; i++)
 {
  cout << i << " " << structure1.get_vec()[i] << " " << structure2.get_structure().get_vec()[i] << endl;
 }

 return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T05:30:55.420

看起来 vec0 没有被您的复制构造函数初始化......

尝试将您的复制构造函数修改为：

```
Structure1::Structure1(const Structure1& structurein)
{
    N = structurein.N;
    vec = new double[N];
    for (int i = 0; i < N; i++)
    {
        vec[i] = structurein.vec[i];
    }
    // ADD THIS LINE
    vec0 = structurein.vec0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T05:33:14.540

您的复制构造函数 Structure1::Structure1(const Structure1 &) 不会复制 vec0。它根本没有被初始化，所以得到内存中的任何东西。

此外，您可能需要检查 Structure1 的 operator=。如果将大向量分配给小向量，则可能会溢出目标中的数组。您可能需要在 operator= 中重新分配内存。

# google-app-engine - GAE - 浏览 jsp 页面时出错

> ID：842761
> 
> 赞同：0
> 
> 时间：2009-05-09T05:24:05.547
> 
> 标签：google-app-engine, jsp

我创建了一个空白项目（通过使用 eclipse 插件），创建一个默认的 jsp 页面，运行 GAE 服务器，浏览到这个 jsp，我得到了错误

JRE：1.6，编译器：1.6

## JSP 文件：

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://
www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;
charset=ISO-8859-1">
<title>Insert title here</title>
</head>
<body>

</body>
</html> 
```

## 错误：

```
HTTP ERROR: 500

Unable to compile class for JSP

Generated servlet error:
    [javac] C:\DOCUME~1\zeroonea\LOCALS~1\Temp
\Jetty_0_0_0_0_8080_war____ut4fm1\jsp\org\apache\jsp\index_jsp.java:7:
cannot access javax.servlet.jsp.HttpJspPage

Generated servlet error:
    [javac] bad class file: G:\Program Files\for JAVA\eclipse\plugins
\com.google.appengine.eclipse.sdkbundle_1.2.0.v200904062334\appengine-
java-sdk-1.2.0\lib\shared\geronimo-jsp_2.1_spec-1.0.1.jar(javax/
servlet/jsp/HttpJspPage.class)
    [javac] class file has wrong version 49.0, should be 48.0
    [javac] Please remove or make sure it appears in the correct
subdirectory of the classpath.
    [javac] public final class index_jsp extends
org.apache.jasper.runtime.HttpJspBase
    [javac]              ^
    [javac] 1 error

RequestURI=/index.jsp
Caused by:

org.apache.jasper.JasperException: Unable to compile class for JSP

Generated servlet error:
    [javac] C:\DOCUME~1\zeroonea\LOCALS~1\Temp
\Jetty_0_0_0_0_8080_war____ut4fm1\jsp\org\apache\jsp\index_jsp.java:7:
cannot access javax.servlet.jsp.HttpJspPage

Generated servlet error:
    [javac] bad class file: G:\Program Files\for JAVA\eclipse\plugins
\com.google.appengine.eclipse.sdkbundle_1.2.0.v200904062334\appengine-
java-sdk-1.2.0\lib\shared\geronimo-jsp_2.1_spec-1.0.1.jar(javax/
servlet/jsp/HttpJspPage.class)
    [javac] class file has wrong version 49.0, should be 48.0
    [javac] Please remove or make sure it appears in the correct
subdirectory of the classpath.
    [javac] public final class index_jsp extends
org.apache.jasper.runtime.HttpJspBase
    [javac]              ^
    [javac] 1 error

        at org.apache.jasper.compiler.DefaultErrorHandler.javacError
(DefaultErrorHandler.java:84)
        at org.apache.jasper.compiler.ErrorDispatcher.javacError
(ErrorDispatcher.java:332)
        at org.apache.jasper.compiler.Compiler.generateClass(Compiler.java:
412)
        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:472)
        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:451)
        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:439)
        at org.apache.jasper.JspCompilationContext.compile
(JspCompilationContext.java:511)
        at org.apache.jasper.servlet.JspServletWrapper.service
(JspServletWrapper.java:295)
        at org.apache.jasper.servlet.JspServlet.serviceJspFile
(JspServlet.java:292)
        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:236)
        at com.google.appengine.tools.development.PrivilegedJspServlet.access
$101(PrivilegedJspServlet.java:23)
        at com.google.appengine.tools.development.PrivilegedJspServlet$2.run
(PrivilegedJspServlet.java:59)
        at java.security.AccessController.doPrivileged(Native Method)
        at com.google.appengine.tools.development.PrivilegedJspServlet.service
(PrivilegedJspServlet.java:57)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:806)
        at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:
487)
        at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter
(ServletHandler.java:1093)
        at
com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter
(TransactionCleanupFilter.java:43)
        at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter
(ServletHandler.java:1084)
        at org.mortbay.jetty.servlet.ServletHandler.handle
(ServletHandler.java:360)
        at org.mortbay.jetty.security.SecurityHandler.handle
(SecurityHandler.java:216)
        at org.mortbay.jetty.servlet.SessionHandler.handle
(SessionHandler.java:181)
        at org.mortbay.jetty.handler.ContextHandler.handle
(ContextHandler.java:712)
        at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:
405)
        at com.google.apphosting.utils.jetty.DevAppEngineWebAppContext.handle
(DevAppEngineWebAppContext.java:54)
        at org.mortbay.jetty.handler.HandlerWrapper.handle
(HandlerWrapper.java:139)
        at com.google.appengine.tools.development.JettyContainerService
$ApiProxyHandler.handle(JettyContainerService.java:306)
        at org.mortbay.jetty.handler.HandlerWrapper.handle
(HandlerWrapper.java:139)
        at org.mortbay.jetty.Server.handle(Server.java:313)
        at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:
506)
        at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete
(HttpConnection.java:830)
        at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:514)
        at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:211)
        at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:381)
        at org.mortbay.io.nio.SelectChannelEndPoint.run
(SelectChannelEndPoint.java:396)
        at org.mortbay.thread.BoundedThreadPool$PoolThread.run
(BoundedThreadPool.java:442)

Powered by Jetty:// 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T05:27:20.483

Eclipse 没有使用您认为使用的 JDK/JRE...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-15T15:42:51.183

这是因为您应该使用 JDK 而不是 JRE。

如果您安装了 JDK，请确保 eclipse 在首选项/Java 下使用它。如果没有，安装一个。

问候优素福

# .net - 如何使用 .NET 遍历网站的目录结构？

> ID：842767
> 
> 赞同：0
> 
> 时间：2009-05-09T05:28:22.087
> 
> 标签：.net

简单的问题。

如何使用 .NET 遍历网站的目录结构？

我想要做的是访问特定目录，然后扫描文件以查找 .html 文件，然后下载它们。

我知道使用 WebClient.DownloadString() 来复制文件，但是如何通过目录进行搜索？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T06:03:51.270

Http 没有目录列表/遍历作为规范的一部分。您可以做的最好的事情是希望目录的默认页面是一个列表，然后您必须解析它以查找指向同一目录中文件的链接。`<a>`列表的格式没有标准，但是提取所有标签的 href 属性然后检查它们是否符合以下条件应该不会太难：

*   没有斜线，例如“file.html”
*   同一目录的完整路径，例如“/the/directory/file.html”，只要您正在查看“/the/directory”
*   同一服务器上同一目录的完整路径，例如“ [http://the.server/the/directory/file.html](http://the.server/the/directory/file.html) ”

如果网络服务器没有为您提供目录列表，您总是可以采用完整的网络蜘蛛方法（只需解析页面中的所有链接并访问同一服务器上的所有链接并解析它们等，然后构建建立你自己的树结构），但许多网站并不容易做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T07:06:16.347

您应该解析下载的文件并搜索`<a>`标签以提取链接。递归地重复该过程，直到您下载了所有需要的页面。

尝试名为[Html Agility Pack](http://www.codeplex.com/htmlagilitypack)的特殊库。这个 .Net 库有一个致命的功能，它

> 是一个敏捷的 HTML 解析器，它构建一个读/写 DOM 并支持普通的 XPATH 或 XSLT。

之后，使用文档很容易，使用 XPATH 提取任何信息也很容易。

# java - Java WebStart 和认可的目录

> ID：842779
> 
> 赞同：3
> 
> 时间：2009-05-09T05:38:58.537
> 
> 标签：java, java-web-start, jnlp, endorsed

如何在 java webstart .jnlp 文件中指定我的一些 jars 覆盖了 JRE 内置实现？就像在常规应用程序上背书的 lib 属性一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-10T06:54:44.820

似乎没有办法在 web start 中定义认可的目录。

即使将 java.endorsed.dirs 属性定义到某个本地目录也不起作用。可能java在运行时已经启动后设置变量。

对此有两种可能的解决方案：

1.  从 web start 应用程序中，仅使用 java.endorsed.dirs 和 web start 应用程序将执行的所有依赖项（类路径和 args）运行命令行 java。您每次都必须处理 jnlp jar 更新。

2.  第一次运行需要用户或将所需的 jar 自动复制到 JRE/lib/endorsed 目录。然后需要重新启动 web start 应用程序。请注意，此方法将为所有将与 JRE 一起运行的 Java 应用程序放置经过认可的 jar。

# qt - Qpainter.rotate() 问题 - qgis

> ID：842782
> 
> 赞同：1
> 
> 时间：2009-05-09T05:43:30.570
> 
> 标签：qt, qpainter, qgis

我正在定制 QuantumGIS，它使用 Qt 的 Qpainter 来绘制和绘制......

我正在尝试在画布上绘制一条多段线，该多段线作为消息队列的更新......绘制非常好......但在我作为更新获得的多段线或多边形对象中还包括一个角度场用于物体的旋转。问题是，当我尝试在 qpainter 使用painter.rotate() 方法绘制折线之前旋转线时，线旋转得很好，但绘制的线的位置会发生变化......并且它会在每次缩放和Qgis画布的平底锅..在设置painter.rotate（）之前，我正在保存画家状态并在绘制之后再次恢复其状态，我认为这类似于OpenGL的push / popMatrix函数。Qpainter 的保存恢复功能是否类似于 opengl 的 push/popMatrix 功能？

这是一个代码片段：

```
p->save();
  //p->rotate(45);
  p->scale( 1.0 / rasterScaleFactor, 1.0 / rasterScaleFactor );
  p->drawPolyline( pa );
  p->restore(); 
```

帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T08:49:30.907

阅读[文档](http://doc.trolltech.com/4.5/qpainter.html#save)，您会看到 QPainter::save() 仅“保存当前的画家状态”。它不会重置转换。您的问题是因为原始转换矩阵与您自己的比例或旋转混合在一起。您的代码片段太少，无法理解绘画的上下文，但我认为您需要在多段线绘画之前适当地重置或修改转换，可能使用[QPainter::setTransform()](http://doc.trolltech.com/4.5/qpainter.html#setTransform)。

[我还建议阅读QPainter 文档](http://doc.trolltech.com/4.5/qpainter.html#details)中的 Coordinate Transformations 部分，并尝试[相关示例](http://doc.trolltech.com/4.5/painting-transformations.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T14:28:53.837

你最好的选择是在[QGIS 邮件列表中问这个问题](http://www.qgis.org/community/mailing-lists.html "QGIS 邮件列表")

# javascript - 使用 JavaScript 循环旋转的 Div

> ID：842789
> 
> 赞同：-1
> 
> 时间：2009-05-09T05:53:46.083
> 
> 标签：javascript, html, css, dhtml

是否可以使用 JavaScript 在循环旋转中旋转 Div。我在一个 HTML 页面中有四个 DIV。我需要循环旋转这些 DIV。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-10T04:06:01.277

其实并不难：

```
function moveDiv(t,mdiv) {
            t = t + 0.05; // "time"
            var r = 10, //radius of circle
                xcenter = 400, //x location of circles centre on screen
                ycenter = 400, //y location of circles centre on screen
                x = Math.floor(xcenter + (r * Math.cos(t))), //circles parametric function
                y = Math.floor(ycenter + (r * Math.sin(t))); //circles parametric function
            mDiv.style.top = x + "px"; //set divs new coordinates
            mDiv.style.left = y + "px"; //set divs new coordinates

            setTimeout(function() { //make sure the animation keeps going
                moveDiv(t,mdiv);
            }, 100);
}
    myDiv = //get div element
    moveDiv(1,myDiv); //start the animation 
```

尚未测试，但这就是它应该如何工作。确保将这些 div 的 css“位置”属性设置为绝对或固定。还要看看圆的[参数方程](http://en.wikipedia.org/wiki/Parametric_equation)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T03:13:46.457

不确定我是否理解这个问题，但请看一下“循环”jQuery 插件： http: [//www.malsup.com/jquery/cycle/](http://www.malsup.com/jquery/cycle/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T05:59:01.250

您也许可以使用[Raphaël](http://raphaeljs.com/) JavaScript 库来完成类似的事情。

史蒂夫

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T05:57:35.933

这有可能做到……但并不容易，而且您将无法保持 div 内内容的原始感觉。

除非我误解了你的问题，如果你只是在谈论通过 4 个 div 循环......这绝对是可能的，而且非常容易。但是如果你问你是否可以旋转实际的 div ......

# mysql - MySQL：复制数据与连接

> ID：842791
> 
> 赞同：3
> 
> 时间：2009-05-09T05:56:47.667
> 
> 标签：mysql, performance, join

假设我有两个表：source 和 article，并且我希望阅读文章及其来源的具体细节，我可以（1）对这两个表使用 join；或者（2）将详细信息复制到文章记录（这会使数据单元变大，但查询会很简单）。哪个更有效率？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T06:49:54.543

> 哪个更有效率？

简单地说（也许太简单了）：您正在用内存换取 CPU 周期——这可能会导致更差的可缓存性并降低性能。

正确回答您的问题的唯一方法是了解*您的环境*并衡量性能。确保包含“正确”的索引表。为数据库创建一个真实的负载——例如，确保您不会一遍又一遍地为相同的行访问缓存。

提前问问自己是否值得从什么性能增益（1%、10%、100%）开始非规范化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T07:01:37.607

这是一个设计决策，这意味着没有你分析的所有细节（目标、约束、用户需求等），但我使用了一些经验法则；

1/ 2 个表之间的连接通常不是很昂贵，并且很容易调整（例如，您说更新很少，我认为插入/删除不是很广泛，并且大多是选择，因此这很可能是一种情况该索引将加快）

2/ 在设计模式时，首先将其规范化到可能/合理的最高程度，然后当现实世界的场景证明它是值得的时，去规范化。（并且通常决定对特定项目进行规范化然后去规范化效果很好，未能规范化通常不会产生好的结果。

3/ 在一段时间内，标准化是有回报的（在以后的几年中，当您尝试对系统进行一些更改时，设计良好的基础确实受到欢迎和赞扬）

4/ 在我看来，非规范化最适合报告将使用即席查询的情况。或者换句话说，我认为非规范化的主要原因是让具有高查询写入/使用比率的报告编写者的生活更轻松

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-09T06:40:39.667

取决于数据。假设您有大量的文章和小型的作者表。如果您想做很多查询来获取一些文章数据和作者姓名（默认情况下在文章表中），那么您将对每个“作者”行进行简单的主键查找，并且小表可能适合内存，因此在文章表中包含作者姓名不会带来巨大的性能提升。此外，这种[非规范化](http://en.wikipedia.org/wiki/Denormalization)也会使“文章”表更大一些（每个作者的名字都会重复很多次），所以它会占用更多的缓存。

另一方面，如果你想查询每个作者的文章数量，从两个表中获取这些数据意味着每次都要聚合很多行。但是，如果您将这个数字包含在“作者”表中，那么获得它就意味着只需要一次查找，并且每增加一篇文章就会增加一个增量。因此，如果您对这种结果感兴趣，非规范化可能是有意义的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-09T06:04:50.550

取决于，您是否想要数据库中的重复数据？然后，当您需要更新某些内容时，您必须在多个位置进行更新。有时可以有一些重复的数据，但要避免将所有数据连接在一起可能会对您产生负面影响。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T11:16:19.910

如果读取性能是优先考虑的因素，您可以使用[*Materialized Views*](http://en.wikipedia.org/wiki/Materialized_view)。由于 MySQL 不支持它们（我认为），您可以[模拟它们](http://www.shinguz.ch/MySQL/mysql_mv.html)。

此解决方案使您可以保持原始数据库的规范化，但您可以通过来自 MV 的简单查询获得性能。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-09T08:23:34.740

复制数据可能会给您带来更高的性能。请注意，我写了可能是因为您将遇到缓存问题。另一方面，在复制数据时，您会使系统更难维护（顺便说一句，您违反了 DB 范式）。如果您必须支付的价格只是一个表连接，那么只需支付它。确保在要加入的列上有 indexex，然后价格就不会那么贵了。

底线：除非至关重要，否则切勿复制数据。

# visual-studio-2008 - Visual Studio 2008 SP1“包加载失败”错误

> ID：842794
> 
> 赞同：4
> 
> 时间：2009-05-09T05:59:01.797
> 
> 标签：visual-studio-2008, entity-framework

我最近安装了 VS08 SP1，以便可以使用实体框架。但是，在使用 edmx 文件加载项目时，我收到指向“Microsoft.Data.Entity.Design.Package”的“包加载失败”错误。

不幸的是，在谷歌上搜索只会出现在我从未安装过的实体框架 CTP 上安装 SP1 的问题。

这是我尝试过的：

*   多次卸载、重新安装 SP1 并重新启动。
*   在安装 SP1 之前和之后使用[Visual Studio 2008 Service Pack 准备工具。](http://www.microsoft.com/downloads/details.aspx?FamilyId=A494B0E0-EB07-4FF1-A21C-A4663E456D9D&displaylang=en)
*   使用 Visual Studio SDK 中的“包负载分析器”。测试通过，但在测试之后显示前面提到的错误。

编辑：好的，我在登录时运行了 VS，我看到了错误

```
Field not found: 'Microsoft.VisualStudio.Modeling.Shell.CommonModelingCommands.PrintPreview'. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T06:06:28.020

希望此链接对您有所帮助。这是同一种情况。

[http://support.microsoft.com/kb/962353](http://support.microsoft.com/kb/962353)

[http://www.thedatafarm.com/Blog/2007/09/03/EntityFrameworkToolsPackageLoadFailureWhenOpeningUpEDMXInDesignerFAQsAreComing.aspx](http://www.thedatafarm.com/Blog/2007/09/03/EntityFrameworkToolsPackageLoadFailureWhenOpeningUpEDMXInDesignerFAQsAreComing.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T06:06:11.123

我对包加载失败的直觉反应是打开一个 VS 命令提示符并运行“devenv /resetskippkgs”（不带引号），这并不总是能解决问题。如果您使用的是 Vista+，则需要运行提升的提示。

# sql-server - SQL：在 UNION 查询中使用 Top 1 和 Order By

> ID：842798
> 
> 赞同：19
> 
> 时间：2009-05-09T06:05:59.160
> 
> 标签：sql-server, sql-order-by, union

我有一张如下表

```
Rate Effective_Date
---- --------------
5.6  02/02/2009
5.8  05/01/2009
5.4  06/01/2009
5.8  12/01/2009
6.0  03/15/2009 
```

我应该找到对当前日期及其之后有效的所有费率。所以为了得到当前的有效利率，我使用

```
SELECT TOP 1 * from table 
where effective_date < '05/05/2009' 
order by effective date desc 
```

对于当前日期之后的费率，查询是

```
SELECT * from table 
where effective_date > '05/05/2009' 
```

为了结合这两个结果，我使用联合作为

```
SELECT TOP 1 * from table 
where effective_date < '05/05/2009' 
order by effective date desc

UNION

SELECT * from table 
where effective_date > '05/05/2009' 
```

预期的结果是

```
Rate Effective Date
---- --------------
5.8  05/01/2009
5.4  06/01/2009
5.8  12/01/2009
6.0  03/15/2009 
```

但我得到的实际结果是

```
Rate Effective Date
---- --------------
5.6  02/02/2009
5.4  06/01/2009
5.8  12/01/2009
6.0  03/15/2009 
```

我不知道为什么会发生这种情况？有什么建议么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-09T06:32:46.287

它是这样工作的：

```
select *
from (
    select top 1 *
    from table
    where effective_date <= '05/05/2009'
    order by effective_date desc
) as current_rate

union all

select *
from table
where effective_date > '05/05/2009' 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-09T06:36:51.940

作为联合的一部分的 select 语句中的 Order By 将被忽略。因此，您的 TOP 1 正在选择一些任意记录（可能是表的聚集键的第一条记录）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-09T06:37:42.873

与 Union 一起使用时，Order By 无效...

我使用 Common Table Expression 和一些 Rank 和 Case 语句技巧处理了一个快速而肮脏的东西，以获得您正在寻找的结果..

```
WITH CTE_RATES ( RATE, EFFECTIVE_DATE, CUR, SORT )
AS (
    SELECT 
        Rate,
        Effective_date,
        CASE WHEN Effective_date > '5/5/2009' THEN 1
             ELSE 0
        END,
        RANK() OVER (PARTITION BY
                         CASE WHEN EFFECTIVE_DATE > '5/5/2009' THEN 1
                              ELSE 0
                         END
                     ORDER BY EFFECTIVE_DATE DESC)
    FROM TestTable
)

SELECT RATE, EFFECTIVE_DATE
FROM (
    SELECT RATE, EFFECTIVE_DATE 
    FROM CTE_RATES 
    WHERE CUR = 0 AND SORT = 1

    UNION ALL

    SELECT RATE, EFFECTIVE_DATE
    FROM CTE_RATES
    WHERE CUR = 1
    ) AS QRY
ORDER BY EFFECTIVE_DATE 
```

为了解释正在发生的事情......

CTE 定义从查询返回的速率、日期、当前和排序标志...

CASE 将结果分为搜索日期之前的结果和搜索日期之后的结果。我们在联合中使用案例 (Cur) 的结果从分区列表中提取结果。

然后 Rank() 函数通过根据 CASE 语句用于分隔列表的相同标准创建分区来对列表进行排序。然后我们以降序方式按生效日期排序。这将采用“过去”列表并使其成为最新的“过去”条目排名 1..

然后在查询的联合部分..

在顶部，我们从“过去”列表 (cur = 0) 和“过去”列表中的第一个条目中获取排名和日期.. (sort = 1).. 这将返回 1 条记录（或如果没有搜索日期之前的记录，则为 0)..

然后我们将它与“当前”列表中的所有记录合并（cur = 1）

然后最后.. 我们采用 UNION 的结果.. 并在生效日期之前订购它，为我们提供所有当前记录和“最新”的先前记录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T06:28:32.817

我相信上述查询通过使用 < 和 > 而不是 <= 和 >= 排除了 05/01/2009。

# semantic-web - OWL 中的奇怪查询行为！

> ID：842801
> 
> 赞同：3
> 
> 时间：2009-05-09T06:07:56.190
> 
> 标签：semantic-web, owl, dlquery, manchester-syntax

在 OWL 中，此查询工作正常

```
"person and hasChild min 3" 
```

它工作正常，它给了我所有有 3 个以上孩子的人

但这一个不起作用

```
"person and hasChild max 3" 
```

它应该给我所有少于 3 个孩子的人，但是它不起作用

有人对此有任何想法吗？

为什么“min”有效，而“max”没有给出任何结果！？？？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-10T15:57:32.700

第二个查询“不起作用”的原因是**Open World Assumption**，也可能（缺少）**Unique Name Assumption**。

说你说：

```
John lives in Paris.
Mary lives in Paris. 
```

以下问题由 OWL 推理器以下列方式回答。

```
Who lives in Paris?  John, Mary
Does at least one thing live in Paris?  YES
Do at least two things live in Paris?  Maybe
Is Paris a person?  Maybe
Is John and Mary the same thing?  Maybe
Is Paris and Mary the same thing?  Maybe
Does at most one thing live in Paris?  Maybe 
```

每当 OWL 推理器返回*Maybe*时，用户界面（例如 Protege）往往什么都不显示。

为了获得您可能想要的答案，您需要在知识库中添加更多信息，例如

```
Mary is not John.
Everybody who lives in Paris is either John or Mary. 
```

希望这可以帮助。看看您最近在 Stack Overflow 上收到的问题有多少浏览量，我认为最好暂时在 Protege 邮件列表中提出这些问题。或者更好的是，查看邮件列表档案。与开放世界假设相关的问题每周至少出现一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-06T04:42:13.713

为了补充 Kaarel 的观点并对您的示例查询进行评论，推理者将查看您拥有的断言三元组并问：“是否存在其他断言三元组，我目前没有，断言此人有其他孩子这会让他们超过‘三个孩子’的限制？” 由于这个问题的答案是“可能”，推理者将无法推断（作为事实）您示例中的人最多有三个孩子。

由于开放世界假设，推理者很难证明否定断言。您的“人不得有超过三个孩子”的查询遇到了这个问题。为了实现您正在寻找的内容，您可以断言该人键入一类有三个或三个以下孩子的父母。再说一次，如果你这样做了，你可能一开始就不需要查询。

# asp.net - linq 2sql 和 Ado.net 实体框架与存储过程的性能比较？

> ID：842805
> 
> 赞同：1
> 
> 时间：2009-05-09T06:22:11.507
> 
> 标签：asp.net, asp.net-mvc, linq-to-sql, entity-framework

嗨，我正在开发一个 asp.net 网站，该网站一次将有很多用户在线。我正在为它编写非常有效的存储过程。我应该使用哪个 ORM 工具？

Ado.net 实体框架还是 linq2sql？

需要性能，因为我们的要求是在 4 秒内加载每个页面。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T06:45:00.657

嗨，我想您需要在较旧的 stackoverflow 问题中进行快速搜索。

这就是我发现的...... [Link1](https://stackoverflow.com/questions/8676/entity-framework-vs-linq-to-sql)和[Link2](https://stackoverflow.com/questions/257016/linq-to-sql-vs-entity-framework-performance)我想这些会帮助你决定你会选择什么；）

您也可以访问这些页面： 1- [Entity Framework 与 LINQ TO SQL](http://blogs.msdn.com/swiss_dpe_team/archive/2008/11/06/entity-framework-vs-linq-to-sql.aspx) 2- [ADO.NET Entity Framework 性能比较](http://blogs.msdn.com/adonet/archive/2008/03/27/ado-net-entity-framework-performance-comparison.aspx) 3- [LINQ to Entities 与 LINQ to SQL - 我应该使用什么以及何时使用？](http://dotnetaddict.dotnetdevelopersjournal.com/adoef_vs_linqsql.htm)

# apache - 使用 SSI 打印文档路径

> ID：842812
> 
> 赞同：1
> 
> 时间：2009-05-09T06:29:35.000
> 
> 标签：apache, ssi

我目前正在尝试在 Apache 中使用 SSI 打印文档路径。我已经设法让它工作了，除了我必须在一开始就在“http://”中硬编码。我目前的代码是：

```
You are currently here: <a href="http://<!--#echo var="HTTP_HOST" --><!--#echo var="REQUEST_URI" -->">http://<!--#echo var="HTTP_HOST" --><!--#echo var="REQUEST_URI" -->url.shtml</a> 
```

问题是，当我通过 https 查看此文档时，它仍然显示“http”，这意味着它无法链接到自身。

有什么方法可以做到这一点，而无需在“http://”中进行硬编码？我在网上看过，但大多数例子都是这样做的。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T11:54:44.140

```
<!--#if expr="$SERVER_PORT = 80" -->
  <!--#set var="protocol" value="http" -->
<!--#elif expr="$SERVER_PORT = 443" -->
  <!--#set var="protocol" value="https" -->
<!--#endif --> 
```

然后你可以使用 <!--#echo var="protocol" -->

# java - Java将int转换为字节时的奇怪行为？

> ID：842817
> 
> 赞同：132
> 
> 时间：2009-05-09T06:33:59.420
> 
> 标签：java

```
int i =132;

byte b =(byte)i; System.out.println(b); 
```

令人难以置信。为什么是输出`-124`？

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2009-05-09T08:00:46.560

在 Java 中，an`int`是 32 位。A`byte`是 8 `bits`。

Java 中的大多数原始类型都是有符号的，并且`byte`, `short`, `int`, 并`long`以二进制补码形式编码。（`char`类型是无符号的，符号的概念不适用于`boolean`。）

在这个数字方案中，最高有效位指定数字的符号。如果需要更多位，则最高有效位（“MSB”）被简单地复制到新的 MSB。

因此，如果您有 byte `255`:`11111111` 并且您想将其表示为`int`（32 位），您只需将 1 复制到左侧 24 次。

现在，读取负二进制补码的一种方法是从最低有效位开始，向左移动直到找到第一个 1，然后反转每一位。结果数字是该数字的正数

例如：`11111111`转到`00000001`= `-1`。这就是 Java 将显示的值。

您可能想要做的是知道字节的无符号值。

您可以使用位掩码来完成此操作，该掩码会删除除最低有效 8 位之外的所有内容。(0xff)

所以：

```
byte signedByte = -1;
int unsignedByte = signedByte & (0xff);

System.out.println("Signed: " + signedByte + " Unsigned: " + unsignedByte); 
```

会打印出来：`"Signed: -1 Unsigned: 255"`

这里到底发生了什么？

我们使用按位与来屏蔽所有无关的符号位（最低有效 8 位左侧的 1）。当将 int 转换为字节时，Java 会删除最左边的 24 位

```
1111111111111111111111111010101
&
0000000000000000000000001111111
=
0000000000000000000000001010101 
```

由于第 32 位现在是符号位而不是第 8 位（我们将符号位设置为 0，即为正数），因此 Java 将字节中的原始 8 位读取为正值。

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2012-01-31T19:29:44.727

`132`以位为单位（以[10 为底](http://en.wikipedia.org/wiki/Decimal)）`1000_0100`以位为单位（以[2](http://en.wikipedia.org/wiki/Binary_number)为单位），Java`int`以 32 位存储：

```
0000_0000_0000_0000_0000_0000_1000_0100
```

整数到字节的算法是左截断；算法`System.out.println`是[二进制补码](http://en.wikipedia.org/wiki/Two%27s_complement)（二进制补码是如果最左边的位是`1`，则解释为负[的补码](http://en.wikipedia.org/wiki/Ones%27_complement)（反转位）减一。）；因此`System.out.println(int-to-byte(` `))`是：

*   解释为（if-leftmost-bit-is-1[negative(invert-bits(minus-one(] left-truncate( `0000_0000_0000_0000_0000_0000_1000_0100`) [)))])
*   =interpret-as( if-leftmost-bit-is-1[negative(invert-bits(minus-one(] `1000_0100`[)))] )
*   =解释为（负（反转位（减一（`1000_0100`））））
*   =解释为（负（反转位（`1000_0011`）））
*   =解释为（否定（`0111_1100`））
*   =解释为（否定（124））
*   =解释为（-124）
*   =-124 多田！！！

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-05-09T06:36:21.113

Java中的字节是有符号的，所以它的范围是-2^7到2^7-1——即-128到127。由于132高于127，你最终会绕到132-256=-124。也就是说，本质上是添加或减去 256 (2^8) 直到它落入范围内。

有关更多信息，您可能需要阅读[二的补码](http://en.wikipedia.org/wiki/Two%27s_complement)。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-05-09T06:41:21.070

132 超出了 -128 到 127 字节的范围（Byte.MIN_VALUE 到 Byte.MAX_VALUE），而是将 8 位值的最高位视为带符号的，这表明在这种情况下它是负数。所以这个数字是 132 - 256 = -124。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-04-13T09:39:44.300

这是一种非常机械的方法，没有分散注意力的理论：

1.  将数字转换为二进制表示（使用计算器好吗？）
2.  只复制最右边的 8 位 (LSB) 并丢弃其余的。
3.  从第 2 步的结果来看，如果最左边的位为 0，则使用计算器将数字转换为十进制。这是你的答案。
4.  否则（如果最左边的位是 1）你的答案是否定的。保持所有最右边的零和第一个非零位不变。并将其余部分颠倒过来，即用 0 代替 1，用 1 代替 0。然后使用计算器转换为十进制并附加一个负号表示该值为负数。

这种更实用的方法是根据上面的许多理论答案。所以，那些还在阅读那些说要使用模数的 Java 书籍的人，这绝对是错误的，因为我上面概述的 4 个步骤绝对不是模数运算。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-07-03T21:35:22.707

[补码方程：](https://en.wikipedia.org/wiki/Two%27s_complement)

[![在此处输入图像描述](https://i.stack.imgur.com/cOIj4.png)](https://i.stack.imgur.com/cOIj4.png)

* * *

在 Java 中，`byte`(N=8) 和`int`(N=32) 由上面显示的 2s 补码表示。

从等式中，a [7]为负，`byte`但 为正`int`。

```
coef:   a7    a6  a5  a4  a3  a2  a1  a0
Binary: 1     0   0   0   0   1   0   0
----------------------------------------------
int:    128 + 0 + 0 + 0 + 0 + 4 + 0 + 0 =  132
byte:  -128 + 0 + 0 + 0 + 0 + 4 + 0 + 0 = -124 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-01-05T09:46:02.550

通常在书中，您会发现从 int 转换为 byte 的解释是通过模除法执行的。这不是严格正确的，如下所示实际发生的情况是 int 数的二进制值中的 24 个最高有效位被丢弃，如果设置了剩余的最左边位，则将其指定为负数，从而造成混乱

```
public class castingsample{

public static void main(String args[]){

    int i;
    byte y;
    i = 1024;
    for(i = 1024; i > 0; i-- ){

      y = (byte)i;
      System.out.print(i + " mod 128 = " + i%128 + " also ");
      System.out.println(i + " cast to byte " + " = " + y);

    }

}

} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-07-23T02:41:13.683

一种模拟其工作方式的快速算法如下：

```
public int toByte(int number) {
    int tmp = number & 0xff
    return (tmp & 0x80) == 0 ? tmp : tmp - 256;
} 
```

这是如何工作的？看看[daixtr 的](https://stackoverflow.com/a/29602198)答案。他的答案中描述的精确算法的实现如下：

```
public static int toByte(int number) {
    int tmp = number & 0xff;
    if ((tmp & 0x80) == 0x80) {
        int bit = 1;
        int mask = 0;
        for(;;) {
            mask |= bit;
            if ((tmp & bit) == 0) {
                bit <<=1;
                continue;
            }
            int left = tmp & (~mask);
            int right = tmp & mask;
            left = ~left;
            left &= (~mask);
            tmp = left | right;
            tmp = -(tmp & 0xff);
            break;
        }
    }
    return tmp;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-04-18T13:45:01.447

如果你想从数学上理解这一点，比如它是如何工作的

所以基本上数字 b/w -128 到 127 将与它们的十进制值相同，高于其（你的数字 - 256）。

例如。132，答案将是 132 - 256 = - 124 即

256 + 你在数字 256 + (-124) 中的答案是 132

另一个例子

```
double a = 295.04;
int b = 300;
byte c = (byte) a;
byte d = (byte) b; System.out.println(c + " " + d); 
```

输出将是 39 44

(295 - 256) (300 - 256)

*注意：它不会考虑小数点后的数字。*

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-07-13T12:08:05.503

从概念上讲，您的数字会重复减去 256，直到它在 -128 到 +127 的范围内。因此，在您的情况下，您从 132 开始，然后一步以 -124 结束。

在计算上，这对应于从原始数字中提取 8 个最低有效位。（请注意，这 8 位中的最高有效位成为符号位。）

请注意，在其他语言中，此行为未定义（例如 C 和 C++）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-12-30T08:38:15.243

1.  在 java int 中需要 4 个字节=4x8=32 位
2.  字节 = 8 位范围=-128 到 127

将“int”转换为“byte”就像将大物体装进小盒子

如果登录 -ve 采用 2 的补码

示例 1：设数字为 130

步骤 1：130 位 = 1000 0010

第 2 步：考虑第一个 7 位和第 8 位是符号（1=-ve 和 =+ve）

第 3 步：将第一个 7 位转换为 2 的补码

```
 000 0010   
          -------------
            111 1101
       add         1
          -------------
            111 1110 =126 
```

第 4 步：第 8 位为“1”，因此符号为 -ve

第5步：130的字节=-126

示例 2：设数字为 500

步骤 1：500 位 0001 1111 0100

第 2 步：考虑第一个 7 位 =111 0100

第 3 步：剩余位为 '11' 给出 -ve 符号

第 4 步：接受 2 的赞美

```
 111 0100
      -------------
        000 1011 
    add        1
      -------------
        000 1100 =12 
```

第 5 步：500 的字节=-12

示例 3：数字=300

```
 300=1 0010 1100

 1st 7 bits =010 1100

 remaining bit is '0' sign =+ve need not take 2's compliment for +ve sign

 hence 010 1100 =44

 byte(300) =44 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2017-01-16T08:09:06.113

```
 N is input number
case 1: 0<=N<=127  answer=N;
case 2: 128<=N<=256 answer=N-256 
case 3: N>256   
        temp1=N/256;
        temp2=N-temp*256;
        if temp2<=127   then answer=temp2;
        else if temp2>=128  then answer=temp2-256;
case 4: negative  number input
        do same procedure.just change the sign of the solution 
```

# sql-server - 有什么方法可以使用 Management Studio 2005 连接到 MS SQL Server 2008？

> ID：842827
> 
> 赞同：2
> 
> 时间：2009-05-09T06:41:17.983
> 
> 标签：sql-server, ssms

有什么方法可以使用 Management Studio 2005 连接到 MS SQL Server 2008？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T06:43:15.527

请参见：

[修复：在 SQL Server 2005 中使用 SQL Server Management Studio 连接到 SQL Server 2008 实例时可能会遇到问题](http://support.microsoft.com/kb/946127)

（特别是 SQL Server 2005 SP2 累积更新 #5）

# python - 在生产中使用 Sql Server 和 Django

> ID：842831
> 
> 赞同：52
> 
> 时间：2009-05-09T06:45:30.217
> 
> 标签：python, sql-server, django, pyodbc

有人最近有使用 SQL Server 数据库后端部署 Django 应用程序的经验吗？我们的工作场所在 SQL Server 上投入了大量资金，如果没有足够开发的后端，我们将不支持 Django。

我知道 mssql.django-pyodbc 和 django-mssql 作为非官方支持的后端。这两个项目似乎只有一个人贡献，尽管贡献似乎有些规律，这有点令人担忧。

是否有任何其他支持良好的 SQL Server 后端？我在这里提到的两个对于生产来说“足够好”了吗？你有什么经验？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-09T15:47:54.473

如前所述，django-pyodbc 是一个不错的选择。PyODBC 可能是目前最成熟的 Python SQL Server 库。

您可能遇到的唯一问题是 pyodbc 不能很好地支持存储过程（您可以调用它们，但您无法从它们中获取结果）。您*可以*使用 pymssql 调用它们，但我会尽可能避免使用它，因为它不支持标准 DB-API 接口并且可能会发生变化。如果你需要这样做，最好的办法是直接使用[adodbapi](http://adodbapi.sourceforge.net/)（它包含在 python win32 包中，你可能最终会安装它）。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2017-10-31T06:47:01.930

这些日子

*   [django-mssql](https://django-mssql.readthedocs.io/)：导致错误“NoneType not callable”`./manage.py migrate`
*   [avidal/django-pyodbc](https://github.com/avidal/django-pyodbc)：未维护。取而代之：
    *   [django-pyodbc](https://github.com/lionheart/django-pyodbc/)：不支持 python 3
    *   [django-pyodbc-azure](https://github.com/michiya/django-pyodbc-azure/tree/master)：到目前为止为我工作
        *   编辑：似乎没有维护。提出[问题 125](https://github.com/michiya/django-pyodbc-azure/issues/125#issuecomment-350962115)询问状态
        *   编辑：得到维护者的回复。将很快与 Django 2.0 保持同步
        *   编辑：维护者为 django 2.0 发布了 2.0 版
        *   编辑：维护者为 django 2.1 发布了 2.1 版

编辑：这里是包版本

```
Django==1.11.6
django-mssql==1.8
pyodbc==4.0.19
django-pyodbc==1.1.1
django-pyodbc-azure==1.11.0.0 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2018-02-16T02:32:59.393

这是这个问题的“现代”答案。我在生产 Ubuntu 16.04 服务器上成功部署了 Django 1.11，该服务器连接到在另一台服务器上运行的 MS SQL Server 2017。

首先，安装本机 MS ODBC 驱动程序“ODBC Driver 17 for SQL Server”：

```
# https://docs.microsoft.com/en-us/sql/connect/odbc/linux-mac/installing-the-microsoft-odbc-driver-for-sql-server#ubuntu-1404-1604-and-1710
sudo su
curl https://packages.microsoft.com/keys/microsoft.asc | apt-key add -
curl https://packages.microsoft.com/config/ubuntu/16.04/prod.list > /etc/apt/sources.list.d/mssql-release.list
apt-get update
ACCEPT_EULA=Y apt-get install msodbcsql
apt-get install unixodbc-dev

# test you can actually get to port 1433 on the server that is running MS SQL:
nc -z -v -w5 host.where.sql.server.is.running.com 1433

# add /opt/mssql-tools/bin to your PATH in .bash_profile, e.g.:
# PATH="$HOME/bin:$HOME/.local/bin:/opt/mssql-tools/bin:$PATH"
# source ~/.bash_profile
# now, test that you can actually connect to MS SQL Server:
sqlcmd -S host.where.sql.server.is.running.com -U db_username -P db_password 
```

其次，确保你有`pip install`这些模块：

```
# https://github.com/michiya/django-pyodbc-azure
django-pyodbc-azure==1.11.9.0

# https://github.com/mkleehammer/pyodbc/wiki
pyodbc==4.0.22 
```

第三，修改 Django 的 DATABASES 条目`settings.py`：

```
DATABASES = {
    'default': {
        'ENGINE': 'sql_server.pyodbc',
        'NAME': 'db_name',
        'USER': 'db_username',
        'PASSWORD': 'db_password',
        'HOST': 'host.where.sql.server.is.running.com',
        'PORT': '1433',
        'OPTIONS': {
            'driver': 'ODBC Driver 17 for SQL Server',
            'isolation_level': 'READ UNCOMMITTED',  # prevent SELECT deadlocks
        },
    },
} 
```

我省略了我的其余配置（nginx、Gunicorn、Django REST 框架等），但这超出了这个答案的范围。

更新：这已经在生产中运行了 6 个多月，并且当多个连接在同一个表上执行 SELECT 查询时，除了 MS SQL Server 特定的死锁之外没有任何问题，该`isolation_level`设置已修复。该系统每天大约有 2000 个新用户。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-09T15:32:45.933

我们在公司的生产中使用 django-mssql。我们也有一个使用 mssql 的现有系统。对我个人而言，这是我做过的最好的设计决定，因为现在我可以使用 django 大大提高了我的工作效率。

我提交了一个补丁，但是当我开始使用 django-mssql 并进行了一两周的测试时。从那时起（2008 年 10 月）我们在 django 上运行我们的系统并且它运行稳定。我也试过 pyodbc 但我不太喜欢。

我们正在运行一个修复系统，其中所有事务都通过该系统运行 40 个重度用户。如果您有更多问题，请告诉我。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-08T19:26:50.713

我看到很多人`django_mssql`在 Windows 上安装后收到以下错误：

```
django.core.exceptions.ImproperlyConfigured: 'sqlserver_ado' 不是可用的数据库后端。
尝试使用 django.db.backends.XXX，其中 XXX 是以下之一：
  'dummy'、'mysql'、'oracle'、'postgresql_psycopg2'、'sqlite3'
错误是：没有名为 sqlserver_ado.base 的模块

```

解决方案是安装以下插件：

[http://sourceforge.net/projects/pywin32/](http://sourceforge.net/projects/pywin32/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-09T15:12:55.733

还没有在生产中使用它，但是我对 django-mssql 的初步体验非常可靠。您只需要 Python Win32 扩展并将 sqlserver_ado 模块放到您的 Python 路径中。从那里，您只需将`sql_server.pyodbc`其用作您的`DATABASE_ENGINE`. 到目前为止，我还没有注意到任何遗漏，但我也没有完全了解它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-09-09T10:44:57.743

使用以下**官方 Microsoft 包**将 SQL 服务器连接到 Django。

```
pip install mssql-django 
```

**设置**

```
 DATABASES = {
    'default': {
        'ENGINE': 'mssql',
        'NAME': 'mydb',
        'USER': 'user@myserver',
        'PASSWORD': 'password',
        'HOST': 'myserver.database.windows.net',
        'PORT': '',

        'OPTIONS': {
            'driver': 'ODBC Driver 17 for SQL Server',
        },
    },
}

# set this to False if you want to turn off pyodbc's connection pooling
DATABASE_CONNECTION_POOLING = False 
```

**更多信息**：[https ://github.com/microsoft/mssql-django](https://github.com/microsoft/mssql-django)

# ruby - 如何在类内部（但在任何方法之外）调用 attr_accessor 属性？

> ID：842839
> 
> 赞同：0
> 
> 时间：2009-05-09T06:51:23.403
> 
> 标签：ruby, attributes

我在课堂上使用 HTTParty，我想使用 default_params 方法。但是，我还希望能够在使用初始化实例化我的类时设置属性。

```
class MyClass
  include HTTParty

  attr_accessor :param1, :param2

  # This or @param1 doesn't work.
  default_params :param1 => self.param1, :param2 => self.param2

  def initialize(param1, param2)
    self.param1 = param1
    self.param2 = param2
  end
end 
```

这样我可以做到

```
m = MyClass.new('hey', 'hello') 
```

代替

```
m = MyClass.new
m.param1 = 'hey'
m.param2 = 'hello' 
```

但我想将这些属性与 default_params 一起使用。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T07:05:59.343

Ruby 在方法声明中对此有一个语法。

```
class MyClass
  attr_reader :param1, :param2
  def initialize(param1 = "default", param2 = 5) 
    @param1, @param2 = param1, param2
  end
end

MyClass.new.param2
# => 5 
```

我从未使用过 HTTParty，我不确定该`default_params`方法的作用，所以我不知道这是否是您正在寻找的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T08:17:05.083

从 Github存储库中查看[此示例文件](http://github.com/jnunemaker/httparty/blob/8da360fb4dbc54041a0e65e5b78a83ad408b7db4/examples/aaws.rb)`initialize`中的方法。我以前没有使用过 HTTParty，但这看起来就像你所追求的。

此外，从您的示例来看，您似乎正在混淆类方法和实例变量。

# c++ - 窗户挂钩问题

> ID：842843
> 
> 赞同：0
> 
> 时间：2009-05-09T07:01:05.423
> 
> 标签：c++, winapi, hook, subclass

正在使用这个：

```
SetWindowsHookEx(WH_CALLWNDPROC, ...); 
```

我可以看到我想要处理的消息，但我想阻止这些消息到达目标窗口。所以我尝试了这个：

```
SetWindowsHookEx(WH_GETMESSAGE, ...); 
```

当我这样做时，我可以修改消息，并阻止目标窗口处理它，但是这个钩子看不到我需要处理的消息。我想这是因为它被发布到目标窗口的队列中，而不是发送？有没有办法解决这个问题？我听说窗口子类化可能能够做到这一点，但我可以在不同的进程中对窗口进行子类化吗？有没有办法使用钩子来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T19:57:00.437

您不能在另一个进程中对窗口进行子类化，但钩子 DLL 应该能够对您感兴趣的窗口进行子类化。WH_GETMESSAGE 和 WH_CALLWNDPROC 钩子在接收消息的进程的上下文中运行，所以此时您有一个“in”子类化目标的窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T07:25:49.357

您可以尝试对目标窗口进行[子类](http://msdn.microsoft.com/en-us/library/ms644898(VS.85).aspx)化，然后过滤消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-17T17:35:46.400

钩子文档表明这无法完成，但我认为这种策略可能有效：使用 SetWindowsHookEx(WH_CALLWNDPROC, ... )

在该过程中，只需将要丢弃的消息修改为未使用的 WM_ 值。

```
LRESULT CALLBACK CallWndProc(int nCode,WPARAM wParam,LPARAM lParam)
{
   CWPSTRUCT *C=(CWPSTRUCT *)lParam;

   if ( ...we are interested in this one) {
     ..deal with this message here...
     //Modify the message so that the client will ignore it
     C->message=WM_USER+44; //presumably ignored by client
   }       
   return GetNextHook(...);
} 
```

讨厌但容易？

# java - Displaytag 导出选项不起作用

> ID：842845
> 
> 赞同：4
> 
> 时间：2009-05-09T07:03:12.640
> 
> 标签：java, struts2

我正在使用 Displaytag 框架进行分页和导出。我也在使用 Strut2Tiles 集成。

每当我调用任何动作类时，它都会返回一个列表并通过 Displaytag 我成功地在我的页面上显示记录。为此，我的 jsp 页面代码如下所示：

```
 <s:set name="selectedPageSize" value="selectedPageSize" scope="request"/>
        <s:set value="accountList" scope="request" name="accountList"/>
            <display:table name="accountList" export="true" class="table" requestURI="" id="accountList" pagesize="${selectedPageSize}" >
            <display:setProperty name="export.pdf" value="true" /> 
            <display:column property="id" sortable="true" class="sort-title"/>
            <display:column property="name" sortable="true"/>
            <display:column property="contactPerson" sortable="true"/>
            <display:column property="phone1" sortable="true"/>
            <display:column property="phone2" sortable="true"/>
            <display:column property="fax" sortable="true"/>
            <display:column property="email" sortable="true"/>
            <display:column property="webSite" sortable="true"/>
            <display:column property="address1" sortable="true"/>
            <display:column property="address2" sortable="true"/>
            <display:column property="countryId.name" title="Country" sortable="true"/>
            <display:column property="stateId.name" title="State" sortable="true"/>
            <display:column property="countryId.name" title="City" sortable="true"/>

            <display:column property="isDeleted" sortable="true"/>

            <display:column title="Delete">
                <s:url id="removeUrl" action="finance/deleteAccount.action">
                    <s:param name="id" value="#attr.accountList.id" />
                </s:url>
                <s:a href="%{removeUrl}" theme="ajax" targets="accountList">Remove</s:a>
            </display:column>

            <display:column  title="Update">
                <s:url id="updateUrl" action="finance/updateAccount.action">
                    <s:param  value="#attr.accountList.id" name="id"/>
                </s:url>
                <s:a href="%{updateUrl}&action=update" targets="accountlist">Update</s:a>
            </display:column> 
```

实际上这个页面是通过瓷砖配置显示的。

在这里，我启用了导出选项，因此它向我显示了导出选项，例如 CSV、EXCEL、XML。但是，当我单击该 CSV 链接时，我的网络浏览器会挂起，这意味着它上面没有显示任何内容

对于该导出解决方案，我还在 web.xml 中添加了过滤器。我的 web.xml 看起来像：

```
<filter>
    <filter-name>struts2</filter-name>
    <filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class>
</filter>

<filter-mapping>
    <filter-name>struts2</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
  <filter>
    <filter-name>ResponseOverrideFilter</filter-name>
    <filter-class>org.displaytag.filter.ResponseOverrideFilter</filter-class>
</filter>

<filter-mapping>
    <filter-name>ResponseOverrideFilter</filter-name>
    <url-pattern>*.action</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>ResponseOverrideFilter</filter-name>
    <url-pattern>*.jsp</url-pattern>
</filter-mapping>

<listener>
    <listener-class>org.apache.struts2.tiles.StrutsTilesListener</listener-class>
</listener>
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/classes/webApplicationContext.xml</param-value>
</context-param>

<welcome-file-list>
    <welcome-file>jsp/welcome.jsp</welcome-file>
</welcome-file-list> 
```

我还包括以下 displaytag 库列表：1) displaytag-1.2.jar 2) displaytag-export-poi-1.2.jar 3) displaytag-portlet-1.2.jar

我得到的例外是：

```
2009-05-09 12:02:38,234 DEBUG (org.displaytag.tags.TableTag:1524) - Exportfilter NOT enabled
2009-05-09 12:02:38,312  WARN (org.displaytag.tags.TableTag:63) - Exception: [.TableTag] Unable to reset response before returning exported data. You are not using an export filter. Be sure that no other jsp tags are used before display:table or refer to the displaytag documentation on how to configure the export filter (requires j2ee 1.3).
ApplicationDispatcher[/PaginationTry2] PWC1231: Servlet.service() for servlet jsp threw exception
Exception: [.TableTag] Unable to reset response before returning exported data. You are not using an export filter. Be sure that no other jsp tags are used before display:table or refer to the displaytag documentation on how to configure the export filter (requires j2ee 1.3). 
```

请回复，我被这个问题困住了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T21:11:53.413

您是否尝试过重新排序 web.xml 中的过滤器，以便 DisplayTag 的 ResponseOverrideFilter 成为链中的第一个过滤器，即在您的 struts2 过滤器之前？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-05T12:55:50.677

配置您的显示标签表：

```
<display:table name="sessionScope.searchProviderLRSharingList"
id="row"
requestURI="/**ACTION_MAPPING_CALLED_TO_GET_THE_RESULTS**"
...
...
</display:table> 
```

在 web.xml 中配置过滤器：

```
<filter>
    <filter-name>ResponseOverrideFilter</filter-name>
    <filter-class>org.displaytag.filter.ResponseOverrideFilter</filter-class>
</filter> 
```

ResponseOverrideFilter **ACTION_MAPPING_CALLED_TO_GET_THE_RESULTS**

# sql - MySQL MyISAM 表的性能......非常缓慢，非常缓慢

> ID：842849
> 
> 赞同：3
> 
> 时间：2009-05-09T07:06:18.123
> 
> 标签：sql, mysql, performance, query-optimization, myisam

我有一个表结构，可以总结如下：

```
pagegroup
* pagegroupid
* name 
```

有 3600 行

```
page
* pageid
* pagegroupid
* data 
```

参考页组；有 10000 行；每个页面组可以有 1-700 行之间的任何内容；数据列的类型为 mediumtext，该列每行包含 100k - 200kbytes 数据

```
userdata
* userdataid
* pageid
* column1
* column2
* column9 
```

参考页面；大约有 300,000 行；每页可以有大约 1-50 行

上面的结构非常简单，问题是从用户数据到页面组的连接非常非常慢，即使我已经索引了所有应该索引的列。为此类联接（userdata inner_join page inner_join pagegroup）运行查询所需的时间超过 3 分钟。考虑到我根本没有选择数据列这一事实，这非常慢。查询时间过长的示例：

```
SELECT userdata.column1, pagegroup.name
FROM userdata
INNER JOIN page USING( pageid )
INNER JOIN pagegroup USING( pagegroupid ) 
```

请帮助解释为什么需要这么长时间以及我能做些什么来使它更快。

## 编辑#1

解释以下乱码返回：

```
id  select_type  table      type    possible_keys        key      key_len  ref                         rows    Extra
1   SIMPLE       userdata   ALL     pageid                                                             372420
1   SIMPLE       page       eq_ref  PRIMARY,pagegroupid  PRIMARY  4        topsecret.userdata.pageid   1
1   SIMPLE       pagegroup  eq_ref  PRIMARY              PRIMARY  4        topsecret.page.pagegroupid  1 
```

## 编辑#2

```
SELECT
u.field2, p.pageid
FROM
userdata u
INNER JOIN page p ON u.pageid = p.pageid;
/*
0.07 sec execution, 6.05 sec fecth
*/

id  select_type  table  type    possible_keys  key      key_len  ref                rows     Extra
1   SIMPLE       u      ALL     pageid                                              372420
1   SIMPLE       p      eq_ref  PRIMARY        PRIMARY  4        topsecret.u.pageid 1        Using index

SELECT
p.pageid, g.pagegroupid
FROM
page p
INNER JOIN pagegroup g ON p.pagegroupid = g.pagegroupid;
/*
9.37 sec execution, 60.0 sec fetch
*/

id  select_type  table  type   possible_keys  key          key_len  ref                      rows  Extra
1   SIMPLE       g      index  PRIMARY        PRIMARY      4                                 3646  Using index
1   SIMPLE       p      ref    pagegroupid    pagegroupid  5        topsecret.g.pagegroupid  3     Using where 
```

## 故事的道德启示

如果遇到诸如此类的性能问题，请将中/长文本列保留在单独的表中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T08:53:36.667

userdata表中columnX的数据类型和用途是什么？需要注意的是，任何文本数据类型（即不包括 char、varchar）都会强制在磁盘上创建任何临时表。现在，由于您正在执行没有条件、分组或排序的直接连接，它可能不需要任何临时表，除了聚合最终结果。

如果您向我们展示您的索引是如何创建的，我认为这也会非常有帮助。要记住的一件事是，虽然 InnoDB 将表的主键连接到每个索引，但 MyISAM 没有。这意味着如果你索引列*名*并用 LIKE 搜索它，但仍然想获取页组的*id*；然后查询仍然需要访问表以获取*id*，而不是能够从索引中检索它。

这意味着，在您的情况下，如果我正确理解您对**apphacker**的评论，就是获取每个用户页面组的名称。查询优化器希望使用索引进行连接，但对于每个结果，它还需要访问表以检索页组名称。如果*name*上的数据类型不大于中等 varchar，即没有文本，您还可以创建一个索引 (id, name)，使查询能够直接从索引中获取名称。

作为最后的尝试，您指出如果介质文本不在页表中，整个查询可能会更快。

1.  我想这个列被排除在您正在运行的查询之外？
2.  您还可以尝试将页面数据与页面“配置”分开，即它属于哪个组。然后你可能会有类似的东西：
    *   页面
        *   pageId
        *   pageGroupId
    *   页面数据
        *   pageId
        *   数据

这有望使您更快地加入，因为 Pages 中的任何列都不会占用太多空间。然后，当您需要显示某个页面时，您可以加入 pageId 列上的 PageData 表以获取显示特定页面所需的数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T07:11:56.207

弄清楚 MySQL 对您的查询做了什么的简单方法是让它向您解释查询。运行它并查看输出：

```
EXPLAIN SELECT userdata.column1, pagegroup.name
FROM userdata
INNER JOIN page USING( pageid )
INNER JOIN pagegroup USING( pagegroupid ) 
```

MySQL 会告诉你它处理查询的顺序以及它使用的索引。您创建索引的事实并不意味着 MySQL 实际使用它们。

另请参阅[使用 EXPLAIN 优化查询](http://dev.mysql.com/doc/refman/5.0/en/using-explain.html)

**编辑**

EXPLAIN 的输出看起来不错。它对 userdata 表进行全表扫描，但这是正常的，因为您想返回其中的所有行。优化这一点的最佳方法是重新考虑您的应用程序。您真的需要返回所有 372K 行吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T09:08:22.137

我假设 userdata 表非常大并且不适合内存。MySQL 必须从硬盘读取整个表，即使它只需要两个小列。

您可以通过定义包含查询所需的所有内容的索引来尝试消除扫描整个表的需要。这样，索引就不是一种便于搜索主表的方法，而是表本身的简写版本。MySQL 只需从磁盘读取速记表。

索引可能如下所示：

```
column1, pageid 
```

这必须是非集群的，否则它将成为大表的一部分，违背了它的目的。有关 MySQL 如何决定要集群的索引的想法，请参阅[此页面](http://dev.mysql.com/doc/refman/5.0/en/innodb-index-types.html)。最简单的方法似乎是确保您在 pageid 上有一个主键，它将被聚集，因此辅助 column1+pageid 索引将是非聚集的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T07:10:16.570

一个可能的问题是 MySQL 每个查询只使用一个索引，并且您可能没有包含这些列的单个索引——或者 MySQL 的查询优化器没有选择它。`EXPLAIN SELECT`&c 在这里告诉你什么？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T07:45:55.720

我将从分解查询开始，以确定是否有一个慢和一个快的部分，或者两者是否都很慢（抱歉，我不喜欢 USING 语法，所以我将使用 ON）：

```
SELECT 
  u.userdata, p.pageid
FROM
  userdata u
  INNER JOIN page p ON u.pageid = p.pageid

SELECT 
  p.pageid, g.pagegroupid
FROM
  page 
  INNER JOIN pagegroup g ON p.pagegroupid = g.pagegroupid 
```

这给了你什么？运行这些`EXPLAIN EXTENDED`将提供额外的提示。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-09T07:53:40.633

看起来您正在对所有行进行连接`userdata`，然后尝试选择所有内容。那是每`page`一个`pagegroup`with `userdata`。条款在哪里`WHERE`？没有`LIMIT`，您想要多少个结果？`userdata`为什么不将结果中的行倒数`explain`，这应该会加快查询速度。呵呵。

# visual-studio - Visual Studio F# 错误

> ID：842855
> 
> 赞同：1
> 
> 时间：2009-05-09T07:17:14.683
> 
> 标签：visual-studio, f#, intellisense

我正在学习 F#，但遇到了一个智能感知错误

```
let rec fib n = 
    match n with
    | 1 -> 1
    | 2 -> 2
    | _ -> fib(n-1) + fib(n-2)

fib 6 <-- This line says "This expression should have type 'unit', but has type 'int' 
```

有谁知道我如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T07:33:42.600

如果您将该代码输入到交互式控制台中，您会希望它打印出答案。但是在程序中，您需要编写一行代码来处理`fib`函数返回的值。要么给结果一个名字，要么把它写到控制台（它的类型为`unit`，即“没有返回值的动作”），或者类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T17:30:11.633

我想我可能会补充一点，你错误地定义了你的斐波那契重复。看看你的代码：

```
let rec fib n =
    match n with
    | 1 -> 1
    | 2 -> 2
    | _ -> fib(n-1) + fib(n-2);; 
```

现在让我们将这个函数映射到一个列表上：

```
[0 .. 8] |> List.map fib 
```

**进程因 StackOverflowException 而终止。**

**检测到会话终止。**

**按 Enter 重新启动。**

*哎呀。*

即使我将列表理解调整为不包括零：

```
[1 .. 8] |> List.map fib 
```

验证它：int list = [1; 2；3；5个；8个；13; 21; 34]

我们确实得到了接近斐波那契数列的东西，但不是确切的数列……您可能认为这对于了解为什么会发生智能感知错误并不重要……

但是现在仔细看看这个......还要注意我使用的是'n'而不是'_'：

```
let rec fib n =
    match n with
    | 0 -> 0
    | 1 -> 1
    | n -> fib(n-1) + fib(n-2);; 
```

val fib : int -> int

```
[0 .. 8] |> List.map fib;; 
```

验证它：int list = [0; 1个；1个；2；3；5个；8个；13; 21]

现在这是正确的顺序。

# python - 在 Python 中查找多个子字符串之一的最有效方法是什么？

> ID：842856
> 
> 赞同：30
> 
> 时间：2009-05-09T07:20:49.307
> 
> 标签：python, regex, string, substring

我有一个可能的子字符串列表，例如`['cat', 'fish', 'dog']`. 实际上，该列表包含数百个条目。

我正在处理一个字符串，我正在寻找的是找到任何这些子字符串第一次出现的索引。

澄清一下，对于`'012cat'`结果是 3，对于`'0123dog789cat'`结果是 4。

我还需要知道找到了哪个子字符串（例如，它在子字符串列表中的索引或文本本身），或者至少匹配的子字符串的长度。

有明显的蛮力方法可以实现这一点，我想知道是否有任何优雅的 Python/regex 解决方案。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-09T07:34:52.783

我会假设正则表达式比单独检查每个子字符串更好，因为*从概念上讲*，正则表达式被建模为[DFA](https://en.m.wikipedia.org/wiki/Deterministic_finite_automaton)，因此当输入被消耗时，所有匹配项都在同时被测试（导致对输入字符串进行一次扫描）。

所以，这里有一个例子：

```
import re

def work():
  to_find = re.compile("cat|fish|dog")
  search_str = "blah fish cat dog haha"
  match_obj = to_find.search(search_str)
  the_index = match_obj.start()  # produces 5, the index of fish
  which_word_matched = match_obj.group()  # "fish"
  # Note, if no match, match_obj is None 
```

***更新：*** 在将单词组合成一个替代单词的单一模式时应该小心。以下代码构建了一个正则表达式，但会[转义任何正则表达式特殊字符](http://docs.python.org/2.7/library/re.html#re.escape)并对单词进行排序，以便较长的单词有机会在相同单词的任何较短前缀之前匹配：

```
def wordlist_to_regex(words):
    escaped = map(re.escape, words)
    combined = '|'.join(sorted(escaped, key=len, reverse=True))
    return re.compile(combined)

>>> r.search('smash atomic particles').span()
(6, 10)
>>> r.search('visit usenet:comp.lang.python today').span()
(13, 29)
>>> r.search('a north\south division').span()
(2, 13)
>>> r.search('012cat').span()
(3, 6)
>>> r.search('0123dog789cat').span()
(4, 7) 
```

***结束更新***

应该注意的是，您将希望尽可能少地形成正则表达式（即 - 调用 re.compile()）。最好的情况是您提前知道您的搜索是什么（或者您计算一次/不经常），然后将 re.compile 的结果保存在某处。我的示例只是一个简单的废话函数，因此您可以看到正则表达式的用法。这里还有一些正则表达式文档：

[http://docs.python.org/library/re.html](http://docs.python.org/library/re.html)

希望这可以帮助。

***更新：***我不确定python如何实现正则表达式，但要回答Rax关于re.compile()是否有限制的问题（例如，你可以尝试将多少个单词“|”一次匹配） ，以及运行编译的时间量：这些似乎都不是问题。我尝试了这段代码，这足以说服我。（我本可以通过添加时间和报告结果来做得更好，以及将单词列表放入一个集合中以确保没有重复......但这两项改进似乎都过大了）。这段代码基本上是即时运行的，并让我相信我能够搜索 2000 个单词（大小为 10），并且它们中的一个将适当地匹配。这是代码：

```
import random
import re
import string
import sys

def main(args):
    words = []
    letters_and_digits = "%s%s" % (string.letters, string.digits)
    for i in range(2000):
        chars = []
        for j in range(10):
            chars.append(random.choice(letters_and_digits))
        words.append(("%s"*10) % tuple(chars))
    search_for = re.compile("|".join(words))
    first, middle, last = words[0], words[len(words) / 2], words[-1]
    search_string = "%s, %s, %s" % (last, middle, first)
    match_obj = search_for.search(search_string)
    if match_obj is None:
        print "Ahhhg"
        return
    index = match_obj.start()
    which = match_obj.group()
    if index != 0:
        print "ahhhg"
        return
    if words[-1] != which:
        print "ahhg"
        return

    print "success!!! Generated 2000 random words, compiled re, and was able to perform matches."

if __name__ == "__main__":
    main(sys.argv) 
```

***更新：***应该注意的是，正则表达式中事物的顺序 ORed*很重要*。看看以下受[TZOTZIOY](https://stackoverflow.com/users/6899/)启发的测试：

```
>>> search_str = "01catdog"
>>> test1 = re.compile("cat|catdog")
>>> match1 = test1.search(search_str)
>>> match1.group()
'cat'
>>> match1.start()
2
>>> test2 = re.compile("catdog|cat")  # reverse order
>>> match2 = test2.search(search_str)
>>> match2.group()
'catdog'
>>> match2.start()
2 
```

这表明顺序很重要：-/。我不确定这对 Rax 的应用程序意味着什么，但至少行为是已知的。

***更新：***我发布了[这个关于在 Python](https://stackoverflow.com/questions/844183/python-regular-expression-implementation-details)中实现正则表达式的问题，希望能让我们深入了解这个问题中发现的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-09T07:24:07.800

```
subs = ['cat', 'fish', 'dog']
sentences = ['0123dog789cat']

import re

subs = re.compile("|".join(subs))
def search():
    for sentence in sentences:
        result = subs.search(sentence)
        if result != None:
            return (result.group(), result.span()[0])

# ('dog', 4) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-09T21:54:58.720

我只想指出 DisplacedAussie 的回答和 Tom 的回答之间的时间差。两者都在使用一次时很快，所以你不应该有任何明显的等待，但是当你计时时：

```
import random
import re
import string

words = []
letters_and_digits = "%s%s" % (string.letters, string.digits)
for i in range(2000):
    chars = []
    for j in range(10):
        chars.append(random.choice(letters_and_digits))
    words.append(("%s"*10) % tuple(chars))
search_for = re.compile("|".join(words))
first, middle, last = words[0], words[len(words) / 2], words[-1]
search_string = "%s, %s, %s" % (last, middle, first)

def _search():
    match_obj = search_for.search(search_string)
    # Note, if no match, match_obj is None
    if match_obj is not None:
         return (match_obj.start(), match_obj.group())

def _map():
    search_for = search_for.pattern.split("|")
    found = map(lambda x: (search_string.index(x), x), filter(lambda x: x in search_string, search_for))
    if found:
        return min(found, key=lambda x: x[0])

if __name__ == '__main__':
    from timeit import Timer

    t = Timer("_search(search_for, search_string)", "from __main__ import _search, search_for, search_string")
    print _search(search_for, search_string)
    print t.timeit()

    t = Timer("_map(search_for, search_string)", "from __main__ import _map, search_for, search_string")
    print _map(search_for, search_string)
    print t.timeit() 
```

输出：

```
(0, '841EzpjttV')
14.3660159111
(0, '841EzpjttV')
# I couldn't wait this long 
```

为了可读性和速度，我会选择汤姆的答案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-09T07:40:42.643

这是一个模糊的理论答案，没有提供代码，但我希望它可以为您指明正确的方向。

首先，您需要更有效地查找子字符串列表。我会推荐某种树结构。从根开始，如果任何子字符串以 开头，则添加一个`'a'`节点，如果任何子字符串以 开头，则`'a'`添加一个`'b'`节点`'b'`，依此类推。对于这些节点中的每一个，继续添加子节点。

例如，如果您有一个包含单词“ant”的子字符串，那么您应该有一个根节点、一个子节点`'a'`、一个孙节点`'n'`和一个曾孙节点`'t'`。

节点应该很容易制作。

```
class Node(object):
    children = []

    def __init__(self, name):
        self.name = name 
```

字符在哪里`name`。

逐个字母地遍历您的字符串。跟踪您所在的字母。在每个字母处，尝试使用接下来的几个字母来遍历树。如果你成功了，你的字母编号将是子串的位置，你的遍历顺序将指示找到的子串。

澄清编辑：DFA 应该比这种方法快得多，所以我应该赞同[汤姆的回答](https://stackoverflow.com/questions/842856/whats-the-most-efficient-way-to-find-one-of-several-substrings-in-python/842871#842871)。我只保留这个答案以防您的子字符串列表经常更改，在这种情况下使用树*可能*会更快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T08:02:09.503

首先，我建议您按升序对初始列表进行排序。因为扫描较短的子串比扫描较长的子串要快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-09T08:31:56.763

这个怎么样。

```
>>> substrings = ['cat', 'fish', 'dog']
>>> _string = '0123dog789cat'
>>> found = map(lambda x: (_string.index(x), x), filter(lambda x: x in _string, substrings))
[(10, 'cat'), (4, 'dog')]
>>> if found:
>>>     min(found, key=lambda x: x[0])
(4, 'dog') 
```

显然，您可以返回元组以外的其他内容。

这通过以下方式起作用：

*   将子字符串列表过滤到字符串中的那些
*   构建包含子字符串索引的元组列表，以及子字符串
*   如果找到子字符串，则根据索引找到最小值

# visual-c++ - 未解决的外部符号链接错误

> ID：842857
> 
> 赞同：1
> 
> 时间：2009-05-09T07:22:01.287
> 
> 标签：visual-c++, dll, linker

我有一个需要使用鼠标钩子的项目，所以我在我的解决方案中添加了一个鼠标钩子 DLL 项目。重建时，我收到以下错误：

```
Error   3   error LNK2005: "struct HHOOK__ * MyHook" (?MyHook@@3PAUHHOOK__@@A) already defined in projdialog.obj    projdialogDlg.obj
Error   4   error LNK2005: "struct HINSTANCE__ * MyInstance" (?MyInstance@@3PAUHINSTANCE__@@A) already defined in projdialog.obj    projdialogDlg.obj
Error   5   error LNK2019: unresolved external symbol "void __cdecl Hook(void)" (?Hook@@YAXXZ) referenced in function "public: void __thiscall CProjdialogDlg::OnLButtonDown(unsigned int,class CPoint)" (?OnLButtonDown@CProjdialogDlg@@QAEXIVCPoint@@@Z)  projdialogDlg.obj
Error   6   error LNK2019: unresolved external symbol "void __cdecl Unhook(void)" (?Unhook@@YAXXZ) referenced in function "public: void __thiscall CProjdialogDlg::OnLButtonUp(unsigned int,class CPoint)" (?OnLButtonUp@CProjdialogDlg@@QAEXIVCPoint@@@Z)  projdialogDlg.obj
Error   7   fatal error LNK1120: 2 unresolved externals .\Debug/projdialog.exe 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T14:12:59.013

1) "struct HH​​OOK__ * MyHook" (?MyHook@@3PAUHHOOK__@@A) 已在 projdialog.obj 中定义

通常会发生此错误，如果该函数通过重复包含头文件而被包含两次，您可以注意（或）使用此链接器选项 FORCE:MULTIPLE

2) 未解决的外部符号错误。编译器找不到 Hook & Unhook 的函数定义。

如果它在另一个文件中定义，则包含该头文件。并将其添加到您正在调用该函数的文件的顶部。extern void __cdecl Unhook(void);

如果它是一个 API 并且 dll 是隐式链接的。在附加依赖项中添加 dll 的 .lib。

# sql-server - SQL Server/ADO.NET：锁定问题

> ID：842859
> 
> 赞同：0
> 
> 时间：2009-05-09T07:22:29.333
> 
> 标签：sql-server, locking

我知道这是一个非常模糊的问题，所以请原谅我。

我曾经工作过的一家公司联系我说，自从他们升级到 SQL Server 2008 后，他们遇到了大量的“锁定”问题。

我真的不知道这是什么意思。我什至不知道如何在 SQL Server 中看到这些“锁定”错误。这不是我的专业领域。

一个不再在那里工作的 DBA 处理 SQL Server 的东西，我的程序可能每天向他们的数据库写入大约 100,000 条记录。

就在我离开之前，我将所有数据层代码从 ADO.NET SqlCommand 存储过程更改为 LINQ to SQL。

有人知道我从哪里开始尝试帮助他们吗？我没有得到报酬，只是想帮助一家陷入困境的初创企业。

我什至如何开始对此进行故障排除？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T16:11:24.337

您只能从更准确地描述他们所看到的问题开始——以及他们报告的“锁定”是向他们报告的内容，还是他们*认为*自己遇到的问题。

在明确问题是在系统的哪个级别产生之前，甚至不可能开始尝试查看答案。

就“看到”锁定问题而言，SQL Server Management Studio 中的活动管理器（或 2k8 中的任何一个）将在一定程度上显示锁定，但实际上这比您目前的位置领先一步.

现在的关键问题是他们看到的错误**到底**是什么以及它发生在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T17:06:00.467

总有一种情况，我们必须使用带 WITH (NO LOCK) 的 SELECT 语句，但在敏感环境中不建议这样做，因为它会启用脏读（未提交的依赖项）。但是大多数死锁问题都发生在更新操作期间，因此您应该更好地关注系统中的更新语句。我建议你使用 UPDATE 和 ROWLOCK 命令，这样 SQL Server 将只锁定表的单行而不是整个 tablelock 或 Pagelock。

您遇到性能问题和死锁这一事实可能表明存在更严重的问题。例如，如果 SQL-Server 没有为查询找到合适的索引，它将进行全表或索引扫描而不是范围扫描；强制它使用 Tablock 而不是 Paglock(s)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T16:19:15.523

[如何使用 SQL Server 2005 Profiler 跟踪死锁](http://www.simple-talk.com/sql/learn-sql-server/how-to-track-down-deadlocks-using-sql-server-2005-profiler/)，应该与 SQL 2008 一起使用

我知道 StackOverflow 作者有一些类似的问题， [http://www.codinghorror.com/blog/archives/001166.html](http://www.codinghorror.com/blog/archives/001166.html)

我只想告诉他们安装 MS SQL 2008 SP1 和大多数修补程序。

# cocoa - 你如何给文本字段一个默认字体和一些填充？

> ID：842862
> 
> 赞同：2
> 
> 时间：2009-05-09T07:25:39.950
> 
> 标签：cocoa, textfield

我要做的是更改文本字段的默认字体并给它一些填充，以便当一个人开始输入时，他们会从文本字段的边缘开始进一步输入。

抱歉，如果我的问题很模糊，我不是故意的，如果您需要更多信息，请发表评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T07:50:55.053

在回答您的第一个问题时，您可以`NSTextField`使用以下`setFont:size:`方法更改 an 的字体（因为`NSTextField`继承自`NSControl`- docs [here](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSControl_Class/Reference/Reference.html#//apple_ref/occ/instm/NSControl/setFont:)）：

```
NSTextField *textField;     //Pointer to your text field
...
NSFont *f = [NSFont fontWithName:@"Arial" size:12];
[textField setFont:f]; 
```

在回答您的第二个问题时，我认为[这](https://stackoverflow.com/questions/670015/nstextfield-with-padding-on-the-right)可能会为您指明正确的方向 - 但是您必须调整代码以在文本字段的左侧而不是右侧应用填充。

# macos - 是什么让 Think Pascal 调试器如此具有传奇色彩？

> ID：842866
> 
> 赞同：8
> 
> 时间：2009-05-09T07:28:54.343
> 
> 标签：macos, debugging, pascal

我一直在磨练编码刀并重新投入开发。几年前，许多人提到（经典）Mac 上的赛门铁克 Think Pascal 调试器绝对是蜜蜂的膝盖，其他任何地方都没有。考虑到没有人尝试克隆所述调试器，我发现该声明很奇怪……究竟是什么让这个特定的调试器如此特别？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-12T15:49:53.177

在开发 Macintosh Pascal 时（1984 年），以在（赛门铁克之前）工作的人的身份回答这个问题。

它具有革命性的原因有两个：首先，它是一个增量编译器。摆脱编辑-编译-链接-测试循环是一个巨大的好处。如果你谷歌 Mel Conway（Think 的首席科学家），我相信你会发现一些关于构建增量编译器的笔记（我在发布之前查看了他的主站点，它似乎正在建设中）。

第二个原因是它是一个 GUI，而其他什么都不是，并且与实际的程序代码一起工作。相比之下，我不相信 MS-DOS 或 Mac 的符号调试器直到几年后才可用（我记得 1985/86 年的一个 Mac 项目，在那里我一直在解释其余的程序集转储团队），它们与源代码级调试相去甚远。微软在 1988 年发布了带有 Quick C 的源代码级调试器 (iirc)；我从未使用过 Turbo-Pascal 或 Turbo-C，所以不知道他们有什么。

今天，几乎每个 IDE 都为您提供相同或更好的调试功能......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T22:19:16.413

我喜欢认为帕斯卡。调试器很棒，在当时是不可想象的。直到在过去几年中使用 Eclipse，我才获得了接近 TP 给我的“哇”的感觉——到目前为止，一切都是妥协，退后一步。

THINK Pascal 对用户界面和可用性给予了我试图给予我用它编写的程序的那种关注。它的程序员给了我尊重，认为它可能对我很重要，什么东西是彩色的，或者我可以在哪里访问它，花时间考虑这个并做出了很好的选择。尽管当时和以后的其他工具更强大 - 例如 MPW，Apple 的 Macintosh Programmer's Workshop - 它们的功能无法访问，组织不善（从天真的用户的角度来看）并且不友好 - 你必须“在俱乐部” " 来利用它（基本上，这意味着成为一个 unixy 命令行用户）。想想帕斯卡把好东西放在我能拿到的地方。

很难重构我对 TP 的喜爱，想出让它变得很棒的特定功能，我很抱歉。如果我有机会，我会打开我的旧电子邮件帐户，看看我是否能提出具体细节。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T15:33:53.437

虽然我希望听到更多人的意见，但我突然想到，你们中的大多数人都处于最新的前沿，甚至没有多少人记得 Windows 95，更不用说经典的 Mac OS （即系统 6）......这本身就是一件好事，不要误会我的意思，但我没有考虑到这一点。

虽然迈克罗宾逊添加了一个有趣的见解，但我在谷歌上搜索了一下，发现了以下三个链接。长话短说，Think Pascal 调试器似乎也是一个可以执行任意代码的解释器……因此可以设置断点，隔离错误，然后在代码窗口中键入建议的修复程序并查看代码执行... 或类似的东西。自然，我希望听到尽可能多的人的意见，但现在：

[这是公开可用的 Think Pascal 4.5.a1](http://www.lysator.liu.se/~ingemar/tp45d4/think.html)

[Mac 68k Liberation Army 论坛上关于 Think Pascal 的一个有趣主题](http://68kmla.net/forums/viewtopic.php?f=15&t=9259)

[与 Codewarrior 的比较](http://pascal-central.com/tplus.html)

# ruby-on-rails - 在 Rails 中使用 memcached 的最佳实践？

> ID：842872
> 
> 赞同：14
> 
> 时间：2009-05-09T07:36:27.023
> 
> 标签：ruby-on-rails, ruby, memcached

随着我们应用程序中的数据库事务变得越来越耗时，我们开始使用 memcached 来减少传递给 MySQL 的查询量。

总而言之，它运行良好，确实节省了大量时间。

但由于缓存作为一种解决方法“悄无声息地出现”，为应用程序提供更多动力，我们的许多模型现在都包含如下代码：

```
def self.all_cached

  Rails.cache.fetch('object_name') {

    find(

      :all,
      :include => [associations])

    }

end 
```

这变得越来越痛苦，因为填充和刷新缓存发生在应用程序的多个类中。

现在，我想知道是否有更好的方法来抽象 memcached 逻辑，使其在所有需要的模型中更强大和更易于使用？

我正在考虑使用某种 memcached-module，它包含在所有需要的模块中。

但在玩之前，我想：让我们先问专家:-)

谢谢

马特

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-12T16:55:08.063

我建议检查现有的插件，两个大插件是[cache_fu](http://github.com/defunkt/cache_fu/tree/master)和[cache money](http://github.com/nkallen/cache-money/tree/master)。对于您希望从缓存中加载模型及其关联的用例，我强烈建议您尝试使用 Cache Money，它几乎是自动执行的：

```
def parent < ActiveRecord::Base
  has_many children
end

def child < ActiveRecord::Base
  index :parent_id
end

#now you can do the following without ever hitting the DB
parents = Parent.find :all
parents.each{ |p| p.children } 
```

Cache Money 真正的大胜利在于，当您扩大到数据库复制滞后成为问题的程度时，通过缓存写入可以节省您的时间。这对于 Rails 尤其重要，因为复制滞后很容易导致 500 个错误，并且通常是您不希望遇到的噩梦。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-09T10:32:22.700

是的，我认为将一个 memcached 模块包含在您需要的所有模型中是最好的解决方案。你的思路很棒：）

# dll - 创建 DLL：如何使用 dll 创建新的 dll？

> ID：842873
> 
> 赞同：1
> 
> 时间：2009-05-09T07:36:39.190
> 
> 标签：dll, visual-studio-2005

在 Visual Studio 2005 中：我想基于另一个 dll 创建一个 dll。例如：我要创建一个DLL——new.dll，而它使用了一个DLL——old.dll；如何创建一个 new.dll 里面有 old.dll？我的意思是，当我使用 new.dll 时，我不需要在我的项目中包含 old.dll 吗？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T01:38:36.850

你有old.dll的源代码吗？你的 dll 是 .net dll 吗？

gac的方法是针对.net dll的，不是针对一般的dll的。

如果不是.net dll，则需要先构建一个库（.lib）。并让你的 new.dll 与库链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T08:00:16.777

您必须在 gac 中注册 dll

[http://www.dotnetspider.com/forum/ViewForum.aspx?ForumId=16430](http://www.dotnetspider.com/forum/ViewForum.aspx?ForumId=16430)

# delphi - Delphi 有时会将文本格式文件 (DFM) 恢复为二进制格式吗？

> ID：842879
> 
> 赞同：10
> 
> 时间：2009-05-09T07:41:18.290
> 
> 标签：delphi, forms, binary, dfm

我们的 Delphi 7 开发团队以文本模式存储表单文件 (dfm)，并使用源代码控制系统 (Subversion) 来跟踪更改。

有时，我们注意到一个表单文件在修订之间返回二进制格式，导致像 TortoiseMerge 这样的差异工具抱怨。

使用 Subversion 更改日志，我可以看到 DFM 文件之前以文本形式存储。软件开发人员从不手动将存储文件格式更改回二进制。

你遇到过同样的事情吗？这是一个已知问题吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-10-20T03:47:39.723

This does happen in Delphi 7 but is fixed in later versions. Usually you access forms in the IDE by opening the .pas file and then switching to the Form View. Right click your form and it will show that it is "Text DFM" ticked if you have done this before.

You will experience the problem you have described of a text DFM switching to a binary DFM when in the Delphi 7 IDE you open the .dfm file directly. eg. File->Open->Somefile.dfm .. Right click the dfm and choose "View as Form". Now right click the form, you will see that the "Text DFM" is unticked.

We were getting the problem when we opened up a DFM which was a grep search result. It had us perplexed also, and would cause corruption of the dfm in cvs as it was checked in as text.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-09T15:33:04.310

我已经看到在 Delphi 7 中发生这种情况，当从另一个项目的另一个表单继承的表单在 Delphi 中自行打开而它所属的项目没有打开时。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-11T00:04:24.187

当 IDE 感到困惑时，有时会发生这种情况。

它通常在您在 Delphi 7 IDE 中出现访问冲突后开始。

Sometimes also one or mor of your Delphi editor buffers inside the IDE become readonly (while the files on disk are still read/write).

The behaviour occurs much less than in Delphi 5 or 6, but sometimes it does occur in Delphi 7.

The best thing you can do is restart the Delphi 7 IDE as soon as you get an access violation.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-09T08:21:39.690

如果有人用不同版本的 Delphi 打开项目（或更改了默认设置），他可能会以不同的格式保存表单。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-10T21:06:36.100

您可能有兴趣研究 Beyond Compare 的使用，而不是 TortoiseSVN 的内置合并工具。Beyond Compare 是用 Delphi 编写的，并且本机知道如何读取二进制 DFM。这意味着无论您的 DFM 是以二进制还是文本形式存储在 Subversion 中，这都不再是一个问题（甚至没有问题）。Beyond Compare V3 还进行 3 路合并，这使得合并多个提交等变得非常容易。即使忽略区分二进制 DFM 的能力，它仍然是比 TortoiseSVN 的内置工具更好的差异查看器。我强烈推荐它，而且它非常便宜（我与 Scooter Software 没有任何关系，除了是一个非常满意的客户）。

[滑板车软件](http://www.scootersoftware.com/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-09T20:56:55.113

我们当然遇到过这种情况。我们专门使用 D7。

从来没有深入了解它，因为它每年只发生六次左右，虽然它很麻烦，但很容易补救。

我很想看看 Lars 的回答，并且肯定会在下次发生这种情况时看看这是否是可能的原因。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-17T05:40:26.610

We also have this issue from time to time, and it seems to be related to looking at the DFM's source (Alt-F12) and then doing a Visual Source Safe operation (e.g. check-in).

# php - 具有完整 jQuery 集成的 PHP 框架？

> ID：842886
> 
> 赞同：11
> 
> 时间：2009-05-09T07:48:42.033
> 
> 标签：php, jquery, frameworks

我厌倦了在 PHP 上重新发明轮子并爱死 jQuery，那么哪个框架适合我的需求？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2011-03-26T07:52:46.953

[Agile Toolkit](http://agiletoolkit.org/)是一个**PHP UI 框架**，带有面向对象的用户界面。以递归方式呈现对象时会生成纯 HTML。jQuery 和 jQuery UI 小部件用于**增强**输出和实现 AJAX。这是一个简单的代码片段：

```
class page_users extends Page {
    function page_index(){

        $crud=$this->add('CRUD');
        $crud->setModel('User',null,array('id','email','name','status'));
        if($crud->grid){
            $crud->grid->addColumn('expander','more','More...');
        }
    }
    function page_more(){
        $tt=$this->add('Tabs');
        $tabs=$this->add('Tabs');
        $tab=$tt->addTab('BasicInfo');
        $tab->add('MVCForm')->setModel('User')->loadData($_GET['id']);

        $tabs->addTabURL('../password','Password');
        $tabs->addTabURL('../activity','Activity');
        $tabs->addTabURL('../engage','Engage');
    }
} 
```

界面基于 jQuery UI CSS 框架，因此可以使用 Themeroller 进行主题化。与 HTML、JS 或 AJAX 的交互由 Agile Toolkit 处理，但可以由开发人员增强或替换。**仅**上面的代码就会产生这个：

![敏捷工具包截图](https://i.stack.imgur.com/NBQiE.png)

对象结构设计精良，可用于各大Web项目。Agile Toolkit 在开源许可下可用。

参见：[atk4](/questions/tagged/atk4 "显示标记为“atk4”的问题")

我是这个出色工具包[的作者之一。](http://agiletoolkit.org/about/authors)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-09T07:53:58.057

[http://www.symfony-project.org/plugins/sfJqueryReloadedPlugin](http://www.symfony-project.org/plugins/sfJqueryReloadedPlugin)

[http://bakery.cakephp.org/articles/view/jquery-helper](http://bakery.cakephp.org/articles/view/jquery-helper)

[http://framework.zend.com/manual/en/zendx.jquery.html](http://framework.zend.com/manual/en/zendx.jquery.html)

[http://qcu.be/](http://qcu.be/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-03-25T06:52:10.760

[QCubed](http://qcu.be)是从头开始编写的，使用 jQuery 作为所有客户端交互的支持组件。它具有所有 jQuery 控件的服务器端 PHP 包装器。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-04-06T14:01:48.273

Yii 框架是围绕 jQuery 编写的，包括 Zii，一个基于 jQuery UI 的界面生成器。它非常快速且非常完整。

[http://www.yiiframework.com/](http://www.yiiframework.com/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-01-03T17:39:23.767

QCubed。我使用 QCubed。所有的 JQuery UI 和控件都可以用 PHP 创建。另外，让事情从整页重新加载到 ajax 甚至 Javascript 都是小菜一碟。它简直太可爱了。

可能存在其他框架并且做得很好，但 QCubed 对我来说实在是太不可抗拒了。查看它的“codegen”功能。:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-10T22:55:07.467

Drupal 也使用 jQuery。根据您进行的开发类型，您可能会发现 drupal 是一个不错的工具，它不仅是一个框架，而且还是一个成熟的 CMS，它使您能够进行真正的快速开发。然而，您可能会觉得使用 Zend 框架、cakePHP 或 codeIgniter 等框架可以更好地控制。 [www.drupal.org](http://www.drupal.org)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-01-03T00:45:32.930

Silverstripe CMS 包含一个名为 Sapphire 的 MVC 框架，它与 CMS 以及开箱即用的 JQuery 紧密集成。

[http://silverstripe.org/](http://silverstripe.org/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-01-04T14:33:01.360

我现在在一个项目中使用[QCubed](http://qcu.be)，它比我自己尝试将 jQuery 集成到我的项目中让事情进展得更快。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-11-03T16:16:48.197

我觉得如果我们可以简单地使用 contrib 模块，并且不必做更少的主题工作，Drupal 就很强大。对于较大的项目，Drupal 意味着更多的工作和更少的控制，而对于小型任务，它通常需要花费时间来禁用它拥有的太多东西。另一件事是 Drupal 对非技术用户不是那么友好。我个人非常喜欢 Drupal，但是当我想到有时做一些小事需要时间，以及我们对它缺乏控制时（虽然它非常灵活，但它增加了时间来做很多形式的改变，例如实现某事），我希望有另一种简单的出路。

特别是在drupal的主题化方面，通过广泛使用视图，我们只是减少了开发时间，但同时主题化工作增加了，当我们更改视图时，也意味着修改该视图的主题。虽然它是一个很好的 CMS 并且功能强大、健壮、安全等，但更多地关注开发人员友好性而不是用户友好性和设计师友好性等。

我刚刚阅读了一些关于 Yii 框架的东西并开始喜欢它，尽管它没有 Drupal 那样的那么多 contrib 模块，这是 Drupal 的优势。我也喜欢我们在 Code Igniter 中的控制方式。

我认为应该有一些方法可以停止在 PHP 中重新发明轮子，一些框架有很多组件和库可供使用，因此开发人员可以只关注业务规则，而不是试图弄清楚如何隐藏标签上的标签在某些 CMS 中形成。有人知道那里有这样的解决方案吗？帮助将不胜感激。

PS：我并不是说 Drupal 不好，因为我已经在几个项目中使用它并且仍然使用它，只是我正在寻找一种更快的开发方法和更简单的主题方法，而不是设计和开发社区可以采用。

# c# - 如何在 ListBox 中添加列表？

> ID：842887
> 
> 赞同：1
> 
> 时间：2009-05-09T07:48:44.700
> 
> 标签：c#, .net, asp.net

再次问好; 我需要在 ListBoxes 中显示 X、Y、Risk。但我做不到。

```
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            List<TrainigSet> listtraining = new List<TrainigSet>();
            TrainigSet tr = new TrainigSet();
            double[] X = { 2, 3, 3, 4, 5, 6, 7, 9, 11, 10 };
            double[] Y = { 4, 6, 4, 10, 8, 3, 9, 7, 7, 2 };
            string[] Risk = { "Kötü", "iyi", "iyi", "kötü", "kötü", "iyi", "iyi", "kötü", "kötü", "kötü" };
            for (int i = 0; i < X.Length; i++)
            {
                tr.X = X[i];
                tr.Y = Y[i];
                tr.Risk = Risk[i];
                listtraining.Add(tr);
            }
            for (int i = 0; i < listtraining.Count; i++)
            {
                ListBox1.Items.Add(listtraining[i].X.ToString());
                ListBox2.Items.Add(listtraining[i].Y.ToString());
                ListBox3.Items.Add(listtraining[i].Risk.ToString());
            }
        }
    }
}

public class TrainigSet
{
    public double X { get; set; }
    public double Y { get; set; }
    public string Risk { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T07:57:46.440

您必须将 TrainingSet 的实例化/创建移动到 for 循环中（您想为添加到 listtraining 的每个项目创建一个新实例）：

```
double[] X = { ... };
double[] Y = { ... };
string[] Risk = { ... };

for (int i = 0; i > X.Length; i++)
{
    TrainigSet tr = new TrainigSet(); // create a new TrainingSet
    ...
    listtraining.Add(tr);
} 
```

否则，您将一遍又一遍地修改同一个 TrainingSet 实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T09:25:18.633

您还可以像这样使用带有公共 X、Y 和风险的 TrainingResult 类

```
public class TrainingResult
{
   public double X{get;set;}
   public double Y{get;set;}
   public string Risk {get;set};
} 
```

并创建一个列表。接下来你可以像这样绑定它：

```
ListBoxX.DataSource = List<TrainingResult>
ListBoxX.DataMember = "X";
ListBoxX.DataBind();

ListBoxX.DataSource = List<TrainingResult>
ListBoxY.DataMember = "Y";
ListBoxY.DataBind();

ListBoxRisk.DataSource = List<TrainingResult>
ListBoxRisk.DataMember = "Risk";
ListBoxRisk.DataBind(); 
```

这样做的好处是您在 x,y 和风险之间有更清晰的关系，并获得（对我而言）更具可读性的代码。缺点是 DataMember 是一个字符串值。

# java - GZIPInputStream解压对长度超过532字节的压缩数据不起作用

> ID：842896
> 
> 赞同：1
> 
> 时间：2009-05-09T07:56:15.493
> 
> 标签：java, compression

我在java中使用gZipInputStream创建了压缩和解压缩它适用于少量数据，但如果压缩后的数据长度大于532，那么我的解压缩不能正常工作。

谢谢巴皮

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T10:30:21.537

重申其他人所说的话：

*   通常情况下**str.length() != str.getBytes().length()**。许多操作系统使用可变长度编码（如[UTF-8、UTF-16 或 Windows-949](http://illegalargumentexception.blogspot.com/2009/04/i18n-unicode-at-windows-command-prompt.html#charsets_unicode)）。
*   使用[OutputStream.close](http://java.sun.com/javase/6/docs/api/java/util/zip/DeflaterOutputStream.html#close())方法确保正确写入所有数据。
*   使用[InputStream.read](http://java.sun.com/javase/6/docs/api/java/io/InputStream.html#read(byte[]))的返回值查看已读取多少字节。不能保证一次性读取所有数据。
*   使用 String 类进行编码/解码时[要小心。](http://illegalargumentexception.blogspot.com/2009/05/java-rough-guide-to-character-encoding.html#javaencoding_stringclass)

字符串压缩/解压方法

```
 private static byte[] compress(String str, Charset charset) {
    ByteArrayOutputStream buffer = new ByteArrayOutputStream();
    try {
      OutputStream deflater = new GZIPOutputStream(buffer);
      deflater.write(str.getBytes(charset));
      deflater.close();
    } catch (IOException e) {
      throw new IllegalStateException(e);
    }
    return buffer.toByteArray();
  }

  private static String decompress(byte[] data,
      Charset charset) {
    ByteArrayOutputStream buffer = new ByteArrayOutputStream();
    ByteArrayInputStream in = new ByteArrayInputStream(data);
    try {
      InputStream inflater = new GZIPInputStream(in);
      byte[] bbuf = new byte[256];
      while (true) {
        int r = inflater.read(bbuf);
        if (r < 0) {
          break;
        }
        buffer.write(bbuf, 0, r);
      }
    } catch (IOException e) {
      throw new IllegalStateException(e);
    }
    return new String(buffer.toByteArray(), charset);
  }

  public static void main(String[] args) throws IOException {
    StringBuilder sb = new StringBuilder();
    while (sb.length() < 10000) {
      sb.append("write the data here \u00A3");
    }
    String str = sb.toString();
    Charset utf8 = Charset.forName("UTF-8");
    byte[] compressed = compress(str, utf8);

    System.out.println("String len=" + str.length());
    System.out.println("Encoded len="
        + str.getBytes(utf8).length);
    System.out.println("Compressed len="
        + compressed.length);

    String decompressed = decompress(compressed, utf8);
    System.out.println(decompressed.equals(str));
  } 
```

*（请注意，因为这些是内存中的流，所以我对如何打开或关闭它们并不[严格。）](http://illegalargumentexception.blogspot.com/2008/10/java-how-not-to-make-mess-of-stream.html)*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T08:03:31.310

对我来说看起来像是一个字符编码/解码问题。一个应该`Readers/Writers`用来写字符串，例如`String.getBytes()`. 使用`String(new byte[])`构造**不是***正确的*方法..

您真的应该使用循环来读取并检查返回的**字节读取值**，以确保所有内容都被读回！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T08:15:58.160

我建议你使用 gCompress.close() 而不是 finish();

我还建议您不能依赖 str.length() 足够长来阅读。存在数据可能更长的风险，因此字符串将被截断。

您还忽略了 read() 的返回值。read() 只保证 read() 一个字节，不太可能准确读取 str.length() 字节的数据，因此您可能有很多尾随 nul 字节 \0。相反，您可以期望阅读 str.getBytes().length()

# sql - 为什么这个查询只返回非空子表的结果？

> ID：842902
> 
> 赞同：0
> 
> 时间：2009-05-09T08:01:20.253
> 
> 标签：sql, database, database-agnostic

这是我们正在运行的查询的简化版本，我们需要在主父表中查找子行匹配的所有行。当子表之一为空时，以下查询不返回任何结果。

主表有两个子表：

```
CREATE TABLE main (id INT PRIMARY KEY, name VARCHAR(8));

CREATE TABLE child1(id INT PRIMARY KEY, main_id int, name VARCHAR(8));
ALTER TABLE child1 add constraint fk_child1_main foreign key (main_id) references main (id);

CREATE TABLE child2(id INT PRIMARY KEY, main_id int, name VARCHAR(8));
ALTER TABLE child2 add constraint fk_child2_main foreign key (main_id) references main (id);

INSERT INTO main (id, name) VALUES (1, 'main');
INSERT INTO child1 (id, main_id, name) VALUES (2, 1, 'child1'); 
```

child2 中没有行，当它为空时，以下查询不返回任何行：

```
SELECT
  main.*
FROM
  main
INNER JOIN
  child1
ON
  main.id = child1.main_id
INNER JOIN
  child2
ON
  main.id = child2.main_id
WHERE
  child1.name = 'child1' OR
  child2.name = 'DOES NOT EXIST'; 
```

如果将一行添加到 child2，即使它与 WHERE 子句不匹配，SELECT 也会返回主表中的行。

```
INSERT INTO child2 (id, main_id, name) VALUES (4, 1, 'child2'); 
```

我已经在 Derby 和 SQLite 上对此进行了测试，所以这看起来与数据库通用。

为什么会这样？

我能做些什么来修复它？

我可以更改为 UNION 单独的 SELECT，但这更冗长，而且，我们正在动态生成 SQL，我宁愿不必更改我们的代码。

另一个解决方法是向数据库添加一个愚蠢的行，但这很混乱。

PS 主表是资产管理系统中的一个会话表，记录客户查找的资产。有不同类型的查找，每种类型都有一个单独的子表，此外还有一个属性子表，用于可以搜索的会话的键/值对。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T08:15:19.550

当 child2 没有行时，由于对 child2 表的内部连接，查询不会返回任何行。如果您对没有行的表进行内部联接，则永远不会得到任何结果 - 如果您想在 child2 为空时获得结果，则必须外部联接到 child2。

当 child2 确实有一行时，查询返回结果的原因是由于 where 子句：

```
在哪里
  child1.name = 'child1' 或
  child2.name = '不存在';

```

内连接表示 child2 中必须有具有匹配 ID 的内容，但 where 子句中有一个 OR，因此您将得到结果，因为 child1.name = 'child1'。之后，数据库就不必费心查看 child2 表了。

要解决这个问题：

我有预感，您只想在满足某些条件时返回子行。您应该对它们都进行外连接，并且也许还将您的额外条件从 where 子句移动到 join 子句，如下所示：

```
选择
  主要的。*
从
  主要的
左外连接
  孩子1
在
  main.id = child1.main_id
  AND child1.name = 'child1'
左外连接
  孩子2
在
  main.id = child2.main_id
  AND child2.name = '随便'

```

*   外连接意味着即使一张表是空的，您也有机会获得结果。

*   将额外条件 (child1.name = ...) 从 WHERE 子句移到外连接意味着您只有在条件为真时才能获得表信息。（我认为这可能是您想要做的，但可能不是，在这种情况下，将条件留在您最初拥有它们的 WHERE 子句中。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T08:18:00.370

它没有返回任何内容，因为您使用的是内部连接。

将内连接更改为左连接

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T08:18:00.853

当您说 INNER JOIN 时，您是在要求查询返回在连接两侧都有结果的行。这意味着任何没有匹配子行的行都将被删除。

听起来您正在寻找的是 LEFT JOIN ，它将包括连接（主）左侧的所有行，即使它们在右侧（child1，child2）没有匹配的条目。

这是标准行为，对于不熟悉 SQL 的人来说是一个非常常见的问题。 [维基百科](http://en.wikipedia.org/wiki/Join_(SQL))有所有的细节，否则一个快速的[谷歌搜索](http://www.google.co.nz/search?q=left+right+inner+outer+join)会带来很多结果。

# asp.net - 如何使用 Ajax 使 SO 标签自动完成

> ID：842906
> 
> 赞同：3
> 
> 时间：2009-05-09T08:02:42.577
> 
> 标签：asp.net, ajax, autocomplete

谁能告诉我如何使用 Ajax 实现 Stack Overflow 标签自动完成文本框之类的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T08:16:14.167

最简单和最简单的方法是使用[Ajax Controls Toolkit](http://www.asp.net/ajax/ajaxcontroltoolkit/)中的[AutoCompleteExtender](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/AutoComplete/AutoComplete.aspx)。

这使用 WebService 将数据提供给控件，并且可以链接到现有的 TextBox。但是，您也可以使用 PageMethod 来提供扩展程序。

或者，您可以使用 JavaScript 和 ScriptManager 自行开发，但这可能非常棘手。我最近尝试过使用 JQuery，它肯定更简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T13:01:56.277

我强烈建议您查看这个[jquery 自动完成插件](http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/)，我已经在我的几个 Web 项目中使用了该插件，并获得了客户的好评。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T08:15:47.723

首先，您必须创建一个用于检索单词的网络服务

[http://www.csharpcorner.com/UploadFile/raj1979/AutoComplete02142008113654AM/AutoComplete.aspx](http://www.csharpcorner.com/UploadFile/raj1979/AutoComplete02142008113654AM/AutoComplete.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T08:45:50.803

我建议您阅读一本出色的书[“Pragmatic Ajax”](https://rads.stackoverflow.com/amzn/click/com/0976694085)，它会引导您完成这样一个示例。

# c - 从 C 中的命令行编辑正文

> ID：842907
> 
> 赞同：1
> 
> 时间：2009-05-09T08:02:43.340
> 
> 标签：c, input

我正在用 C 编写一些小程序——一些登录、注销、创建帐户、发送消息到另一个帐户的交易——我可以在这些程序的基础上进行构建、更改、创新和完善，以提高我的 C 技能.

我想弄清楚的是如何实现“撰写消息”选项的一部分。在提示您输入消息的收件人、主题和正文后，我希望能够返回并编辑它们——而不必重新输入整个内容。因此，如果我选择“编辑消息”选项，它会写出我拥有的内容，然后让我回去更改一些内容。

我在[x86 汇编](https://en.wikipedia.org/wiki/X86_assembly_language)中做过类似的事情，或者开始做类似的事情，所以我基本上了解这将如何在机器级别实现，但我不知道如何在 C 中实现它。如何我这样做？

像下面这样的事情在 C 语言中让我感到困惑：

*   处理潜在冗长输入的好方法
*   如何写出文本并允许用户编辑它，而不会超过某个点
*   如何控制光标的位置

另外，如果之前已经这样做过，并且存在一个用于此类功能的库（甚至是我不知道的标准库），请注意我**确实想推出自己**的学习目的。

我想我脑海中的方法是一次读取一个字符的消息正文，以便我可以考虑回车并创建多行消息。但我不确定我将如何退格通过它。我想从命令行（？）这样做真的很难。

如果不是不可能，将光标移回并擦除已经超出输入缓冲区的字符......我每次都必须“重新绘制屏幕”吗？就像我可以控制整个控制台并在某些位置读取和写入击键吗？还是离机器太近了？我有点用汇编来做，但是使用了 16 位中断，我不允许在 C 中使用它......这是我在汇编中写的：

*（以前的图已经消失了）*

程序会将一个字节值转换为代表该字节的两个字符代码，然后跳到右列并写入原始字节（显示为一个字符），然后跳回并写出另外两个十六进制数字，在下一个插槽...等等，从左到右，从上到下...这很简单，但我*不*知道如何在 C 中实现它。我所能做的就是[INT 21](https://en.wikipedia.org/wiki/MS-DOS_API)样式的输入和输出，写行到向上滚动窗口的控制台，依此类推。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T08:45:24.547

ANSI C 中没有办法制作可移植的行编辑器。如果您自己滚动，则*必须*为您希望程序运行的每个新操作系统重新滚动它。

如果我可以提出一个建议，我会使用一个预先存在的库来完成所有那些艰苦的、特定于平台的肮脏工作，并通过这种方式学习如何处理诸如任意长度输入之类的事情。然后，当你的代码工作（并且很好）时，学习如何做所有这些肮脏的工作，并拿走图书馆的拐杖。这样一来，您就不会处理整个事情 - 您正在将其分解成更易于管理的部分。

即使这有点过于简单化了。我花了很长时间来学习如何处理任意长度的输入。

另外，要知道，如果你希望你的代码是可移植的，删除库依赖意味着，如果你想移植它，你必须要么 a) 重写所有肮脏的工作代码，要么 b) 添加图书馆回来了。

以一个笑话结束这一切，这是你的图书馆大脑：

> Pigmaei gigantum humeris impositi plusquam ipsi gigantes viident。
> *（如果我看得更远一点，那就是站在巨人的肩膀上。）*
> *——艾萨克·牛顿*

这是你没有图书馆的大脑：

> 如果我没有看到其他人那么远，那是因为巨人站在我的肩膀上。
> *——哈尔·阿贝尔森*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T08:11:31.120

你说你想避免使用库（标准或其他），但不幸的是，在 C 中，所有输入和输出都是通过库执行的——语言本身绝对没有输入/输出设施。

所以你注定要使用某种库。鉴于您似乎想要一个文本界面，我建议看一下[curses](https://en.wikipedia.org/wiki/Curses_%28programming_library%29)的便携式版本[PDCurses](https://en.wikipedia.org/wiki/PDCurses)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T08:08:53.357

我写了一个文本编辑器。

我做 C 已经二十年了。

文本的数据结构是我写过的最复杂的单一数据结构；这是一种数据结构，可以如您指定的那样有效地处理任意长度的文本。

如果您是 C 的新手，那么您咬的比咀嚼的要多。

我建议一个简单的数据结构，比如缓冲区或链表——你不能处理任意长度的文本，但总比没有好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T08:09:00.953

这与系统（OS）高度相关。我认为您正在尝试在 Windows 上执行此操作。

您可以使用[Windows 控制台 API](http://msdn.microsoft.com/en-us/library/ms682073(VS.85).aspx)来执行此操作。

*如果您想研究一些库以供参考（在您自己动手之前），一个好的库是[GNU Readline](http://gnuwin32.sourceforge.net/packages/readline.htm)。*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T09:30:38.387

至于保存数据，我猜[绳索](https://en.wikipedia.org/wiki/Rope_%28data_structure%29)将是可用的最佳数据结构：在简化形式中，它是一棵字符串树。当您想在屏幕上打印它时，您需要做的就是预先订购并打印它。将一条线一分为二涉及一个相对简单的树操作：添加一个叶子。困难的部分是拆分字符串本身（复制字符串，将旧端设置为0，添加叶子，添加指针）......

现在，有一个跟踪光标的问题......你可以留下一个面包屑跟踪从根到光标当前所在的位置。

还考虑了一个可调整大小的控制台......也就是说，如果你想让你的编辑器在终端是 80 或 200 个字符宽的情况下工作......

# delphi - 哪些 Amazon Web 服务可以与 Delphi 一起“开箱即用”使用？

> ID：842909
> 
> 赞同：6
> 
> 时间：2009-05-09T08:03:45.303
> 
> 标签：delphi, soap, delphi-2009, amazon-web-services

Delphi 的特征矩阵显示：“2007 年添加！更新了 SOAP 功能以支持 Amazon、eBay、MapPoint 等。

我能够构建一个有效的客户端，而无需针对 Amazon Simple Queue Service 的特殊解决方法。使用 Amazon SimpleDB，我运气不佳（但不是因为 Delphi，请参阅[此处](https://stackoverflow.com/questions/842948)）。

您已成功测试或使用了哪些 Amazon Web 服务与 Delphi 2007（或 2009）一起使用？

是否有必要使用特殊的解决方法来使其工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T21:19:18.327

我在我当前的客户项目中使用了[n 个软件 Amazon Integrator 。](http://www.nsoftware.com/ibiz/amazon/)它并不便宜，但支持亚马逊的大部分服务（Simple Storage Service (S3)、Simple Queue Service (SQS)、SimpleDB、Elastic Compute Cloud (EC2) 和 E-Commerce Service (AWS)）。它不是“开箱即用”的解决方案，而是借助第三方组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T17:45:46.030

这取决于您所说的“开箱即用”的含义。使用 AWS，您可以进行 SOAP 或 REST 调用，这意味着您应该能够使用几乎任何您喜欢的语言。如果您想使用帮助程序库，我还没有听说过 Delphi 的任何帮助程序库。

作为参考，您可以查看 SimpleDB： [http ://docs.amazonwebservices.com/AmazonSimpleDB/latest/DeveloperGuide/APIRequests.html](http://docs.amazonwebservices.com/AmazonSimpleDB/latest/DeveloperGuide/APIRequests.html)

# asp.net-mvc - 确定 ActionResult 后如何重定向？

> ID：842913
> 
> 赞同：0
> 
> 时间：2009-05-09T08:07:40.973
> 
> 标签：asp.net-mvc, redirect, actionresult

在 ASP.NET MVC 中，我想做类似的事情：

*   让基本控制器检查`ActionResult`.
*   如果`ActionResult`是 a `ViewResult`，则为所有视图加载一些共享数据。
*   如果共享数据满足某些特定条件，则重定向到登录页面。

你将如何实现它？

* * *

我考虑了以下问题，但似乎重定向不起作用（由于操作已经执行？）。有没有解决的办法？

```
public abstract class BaseController : Controller
{
    protected override void OnActionExecuted
        (ActionExecutedContext filterContext)
    {
        base.OnActionExecuted(filterContext);

        // If the result is a view result,
        // then it loads the shared data (for use in shared view):
        if (filterContext.Result is ViewResult)
            LoadSharedData();
    }

    private void LoadSharedData()
    {
        // TODO: Loads the data that is common for all views.
        // TODO: If the shared data fulfills some specific criteria,
        //       it will redirect to a login page.
        Redirect("http://someurl");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T08:11:55.767

我想我通过尝试找到了答案：

```
filterContext.Result = Redirect("http://someurl"); 
```

有用。

# git - 无法通过 Git Pull 更新我的 Git 本地存储库

> ID：842915
> 
> 赞同：7
> 
> 时间：2009-05-09T08:08:45.400
> 
> 标签：git, pull

我在本地 Git 存储库中删除了一个文件。我希望通过更新我的 Git 存储库来恢复文件。

我运行以下失败

```
git pull 
```

它说 upToDate，但我没有得到最新的文件。github上的public repo没有使用SVN，所以问题不可能是SVN。

**如何更新本地 Git**存储库，以便将删除的文件恢复到计算机？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-09T08:34:07.850

如果尚未提交：

```
 git checkout path/to/file 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-09T08:36:18.703

八月可能是解决您问题的最佳方法。

您还可以恢复到您提取的最后一个版本：

```
git reset --hard 
```

# c# - 什么是 Ubuntu 下 C++ 或 Mono 的最佳编程 IDE？

> ID：842918
> 
> 赞同：5
> 
> 时间：2009-05-09T08:09:51.123
> 
> 标签：c#, c++, linux, mono

正如标题所说：在 Ubuntu 下编写 C++ 或 Mono 时你选择的 IDE 是什么？Eclipse 是一种可行的方法吗？MonoDevelop 是否足够成熟？其他 IDE 呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-09T09:28:23.493

就 C# 而言，您并没有太多选择，MonoDevelop 是要走的路，根据我对它的一点经验，它已经足够好了（我的大部分 C# 工作都是在 VS2005 中完成的）。

至于 C++，我已经成功地使用 Netbeans (6.5 + 6.7beta) 来编辑和构建一个旧的遗留应用程序，它使用手工制作的 Makefile 和许多其他你在最近的任何 C++ 项目中都找不到的可怕东西。在我们的例子中，在设置（创建项目，然后手动添加包含路径等等）时需要做一些手把手的事情，但在那之后，工作几乎完美无缺。代码补全效果很好，即使通过各种级别的神秘模板使用，尽管在一种情况下确实存在问题（一些从 Liquid XML 4 自动生成的代码）。

如果你也打算用 Java 开发并且不依赖于 Eclipse 或其他任何东西，我认为 Netbeans 是一个非常好的全能 IDE，考虑到它们支持 groovy、php、ruby 和 python想要。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-09T08:38:51.757

我个人最近一直在使用[CodeLite](http://www.codelite.org/)进行 C++ 编程，我非常喜欢它而不是 Code::Blocks，完整的功能列表请参见[此处](http://codelite.org/Main/ReadMore)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-09T14:39:56.493

EMACS 适用于一切。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-09T08:12:45.953

我不了解 Mono，但对于 C++，我可以推荐 Code::Blocks。虽然它不在 Ubuntu 存储库中，所以你必须自己获取包，但他们已经为 Ubuntu 预编译了包。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-09T09:27:49.393

我正在使用[NetBeans IDE](http://www.netbeans.org/)进行 C++ 编程。它有很多特性：C++ 项目支持、句法和语义突出显示等等。请参阅此[页面](http://www.netbeans.org/features/cpp/index.html)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-09T08:29:39.500

[KDevelop](http://www.kdevelop.org/)对于纯粹的 C/C++ 开发来说是相当完整的。

对于 C#，我会选择 MonoDevelop，因为没有其他支持代码完成的替代方案。[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)最好在 Wine 下尝试。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-09T09:12:25.483

我发现 ubuntu 下的 C++ eclipse 相当容易破解。它有很多可能出错的隐藏内容（比如突然拒绝构建某个项目），C++ 索引器会让你发疯。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-09T08:13:12.037

我到处使用 Eclipse。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-09T09:47:45.740

我也在为 Java、C/C++ 和 PHP 使用 Eclipse。我安装了 Code::Blocks 但我不喜欢它的界面，而且 Code::Blocks 无法生成 makefile（它有一个名为 cbmakefile 的插件，但要让它工作非常困难）。NetBeans 是一个非常好的 IDE，但它有点重，我可以在 Eclispe 的 NetBeans 中找到我想要的任何东西。

对于 Mono，我认为 MonoDevelop 已经足够好了

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-09T14:47:24.830

当然，正如建议的那样，您可以将 MonoDevelop 用于 C#。如果您愿意，也可以将其用于 C++ *。*我不相信它支持 C++/CLR（或者即使 Mono 支持 C++/CLR）。

对于 C++，我更喜欢简单的 emacs。无论如何，C++ 是一种相当难以提供一些更“高级”IDE 特性的语言。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-25T15:17:03.097

我以前用过 Code::blocks ，但现在我想我要进入 codelight 了，我认为它非常棒。Eclipse 很重，而且似乎只为 Java 设计。Kdev 也很好，但我从来没有真正用作开发人员。平台。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-10T00:12:09.920

对于 C++，我使用 QtCreator，1.1 版修复了很多东西。它简单而强大。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-09T15:30:54.580

我还没有真正使用它，但你可以看看 qtcreator。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-29T16:01:15.777

带有 C/C++ 插件的 NetBeans 6.5。Mono 的 SharpDevelop。

这两者都可以通过 Ubuntu 自带的包管理工具轻松安装。

# sql - 如何使用 SQL Server 2005 从一个表中透视数据

> ID：842926
> 
> 赞同：1
> 
> 时间：2009-05-09T08:15:07.490
> 
> 标签：sql, sql-server-2005, pivot

我想从具有以下列的单个表创建一个查询。

SEQNO 是唯一键

```
Name   ID   Amount   Date          JOBID       SEQNO
Mark    9    200     1/2/09         1001         1
Peter   3    300     1/2/09         1001         2
Steve   1    200     2/2/09         1001         3
Mark    9    200     3/2/09         1001         4
Peter   3    300     4/2/09         1001         5
Steve   1    200     5/2/09         1001         6
Hally   1    200     5/2/09         1002         7 
```

查询应按 SUBJOBID 和日期范围以这种格式输出：-

```
**NAME      ID      1/2       2/2     3/2     4/2     5/2      JOBID**<br>
Mark        9       200       NULL    200     NULL    NULL     1001   
Peter       3       300       NULL    NULL    300     NULL     1001   
Steve       1       NULL      200     NULL    NULL    200      1001 
```

我一直在为此进行枢轴查询。但我似乎无处可去。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T19:13:40.140

这实际上可以通过一个[`PIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)函数很容易地完成。由于另一个答案没有显示与如何执行它相关的代码，因此这里有两种`PIVOT`获取数据的方法。

首先是使用**Static Pivot**。静态数据透视是当您提前知道将数据转换为列时。

```
select *
from 
(
    select name, id, convert(char(5), dt, 101) dt, jobid, amount
    from test
) x
pivot
(
    sum(amount)
    for dt in ([01/02], [02/02], [03/02], [04/05], [05/05])
)p
order by jobid, name 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/6ac75/1)

第二种方法是使用**动态 PIVOT**在运行时识别要转换为列的值。

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(convert(char(5), dt, 101)) 
                    from test
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT name, id, ' + @cols + ', jobid from 
             (
                select  name, id, convert(char(5), dt, 101) dt, jobid, amount
                from test
            ) x
            pivot 
            (
                sum(amount)
                for dt in (' + @cols + ')
            ) p 
            order by jobid, name'

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/6ac75/2)

两者都会产生相同的结果。当您事先不知道要转换为列的值时，动态效果很好。

# iphone - 从 uinavigationbar 单击后退按钮时重新加载视图

> ID：842928
> 
> 赞同：1
> 
> 时间：2009-05-09T08:15:28.910
> 
> 标签：iphone, objective-c, uiviewcontroller, uinavigationbar

应用程序显示有关行星、它们的卫星等的信息。它显示行星列表，让用户选择一个行星并查看其详细信息，然后将其加入书签/取消书签。我有一个向用户显示所选行星详细信息的视图，它还包含一个添加/删除书签按钮。如果用户单击该按钮，则添加/删除该书签，并将另一个视图推送到当前视图之上，以告诉用户该书签已被删除。

现在的问题是，当用户单击状态视图上显示的导航栏左侧的后退/行星详细信息按钮并返回行星详细信息视图时，仍会显示添加/删除（以之前显示的为准）按钮，而它现在应该根据我编写的代码删除/添加（根据先前加载的按钮）。

我能理解的是，当用户单击该后退按钮时，不会重新加载前一个视图，只会弹出状态视图。有没有一种方法可以让应用程序运行 setNeedsDisplay 或当用户单击状态视图上的后退按钮时可以重新加载书签详细信息 viewDidLoad 代码的方法？

还是有其他可能的解决方案？

这让用户非常困惑，因为他认为他刚刚删除/添加了书签，但按钮仍在要求他添加/删除......

代码的其他部分也使用该状态视图向用户显示操作的结果，因此我无法更改其代码，或者我可以检查其中的前一个视图，检查它是否是行星详细信息，然后重新加载其内容...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T08:27:35.417

获取在 viewDidLoad 方法中设置按钮的代码并将其移动到 viewWillAppear 中。当您重新进入视图时，它应该正确更新按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T08:46:10.287

我找到了一个解决方案：此类代码（在 popViewController 或此类事件之后更改按钮）应编写在 viewWillApear 中，以使其在每次加载视图时都运行，无论如何。

感谢 irc.freenode.net 上 #iphonedev 上的 Quentarez 和 crackity_jones。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-03T19:09:41.900

设置代表正确和

```
- (void)navigationController:(UINavigationController *)navigationController
                 willShowViewController:(UIViewController *)viewController
                 animated:(BOOL)animated
{
    NSLog(@"navigationController willShowViewController");
} 
```

# c++ - memcpy 没有按预期做

> ID：842935
> 
> 赞同：1
> 
> 时间：2009-05-09T08:18:25.970
> 
> 标签：c++, c, memcpy

我有这段代码输出错误的结果。

```
#include <stdio.h>
#include <string.h>

int main() 
{
  unsigned char bytes[4];
  float flt=0;

  bytes[0]=0xde;
  bytes[1]=0xad;
  bytes[2]=0xbe;
  bytes[3]=0xef;

  memcpy( &flt, bytes, 4);

  printf("bytes 0x%x float %e\n", flt, flt);
  return 0;
} 
```

我得到的输出是

> 字节 0xc0000000 浮点数 -2.000001e+00

我期待得到

> 字节 0xdeadbeef 浮点数 -6.2598534e+18

编辑＃1，正如指出的那样，字节顺序可能不同，这将导致以下结果

> 字节 0xefbeadde 浮点数 -1.1802469e+29

我不明白的是从 float 转换为 unsigned int 导致 0xc0000000 （同一 printf 语句中的 float 为 -2.0000 我将归因于编译器优化）

这是以前在另一台计算机上工作的。这可能是架构更改。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-09T08:33:57.557

这不是 memcpy 的问题。

1.  `float`总是`double`在传递`...`printf 时转换为，因此在大多数英特尔架构上您无法获得 4 个字节。
2.  当您`0xdeadbeef`在此代码中进行扩展时，您假设您的架构是 BIG endian。有许多小端架构，例如 Intel x86。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-09T08:22:07.600

您确实意识到当传递给像 printf() 这样的可变参数函数时，浮点数会被提升为双倍？所以当你说：

```
printf("bytes 0x%x float %e\n", flt, flt); 
```

您正在尝试将真正的两个 8 字节值视为两个 4 字节值，从而给出（我相信）未定义的行为。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T08:40:41.377

printf 中的“%x”需要一个无符号整数。你给它一个浮点数，它会自动转换，这不是你想要的。你想做这样的事情：

```
printf("bytes 0x%x float %e\n", *((unsigned int *)&flt), flt); 
```

哦，正如其他人指出的那样，如果您使用的是 x86，您将不会看到 0xdeadbeef，更像是 0xefbeadde。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T08:40:43.000

看看这是否更好：

```
printf("bytes 0x%x float %e\n", *(int *)&flt, flt); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T08:58:18.573

要查看参数提升，请将声明从 float 更改为 double。在我的机器上，打印：

```
bytes 0xefbeadde float -1.860545e+230 
```

0xefbeadde 是 deadbeaf 的大端序。double 的最后 4 个字节未定义，因此 float 后显示的数字会有所不同。

您提到它可以在另一台计算机上运行，​​那是什么类型的计算机？一定是小端，其中 sizeof(float) == sizeof(double) :)

# asp.net - 如何从javascript调用vb函数

> ID：842937
> 
> 赞同：1
> 
> 时间：2009-05-09T08:19:37.700
> 
> 标签：asp.net, vb.net

我正在使用带有事件 OnFocus=("this.blur();") 的文本框（txtFileType），所以我不能为此文本框使用 textchanged 事件，我编写了一个 vb 代码来使用基于存储过程的存储过程计算我的 FileNumber文本框的值 (txtFileType)。

我可以从可以在客户端使用的javascript调用这个vb代码吗..请帮助举个例子..或任何其他可能的方式..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T01:34:23.810

听起来您需要通过页面调用 Web 服务方法来处理。试试[这个例子](http://www.codeproject.com/Articles/14610/Calling-Web-Services-from-HTML-Pages-using-JavaScr)，让我知道它是否有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T12:55:44.847

我假设您的 vb 代码将驻留在服务器端。您可以将服务器端方法公开为服务并使用 javascript 调用它。出于 ajax 的目的，您可能可以查看 Microsoft 本身的[本教程](http://www.asp.net/ajax/documentation/live/tutorials/ExposingWebServicesToAJAXTutorial.aspx)。

# delphi - 确定父组件

> ID：842938
> 
> 赞同：0
> 
> 时间：2009-05-09T08:20:27.667
> 
> 标签：delphi, popup, toolbar, parent, owner

我们在工具栏上有 TToolbarButton(s)，每个都有它自己关联的 TPopupMenu。弹出菜单都是一样的，所以我们希望所有工具栏按钮只有一个菜单。我遇到的问题是确定哪个 ToolbarButton 调用了弹出菜单。

我尝试了以下方法，但我不断收到访问冲突。

...

```
with (Sender as TPopupMenu) do
  ShowMessage((GetParentComponent as TPopupMenu).Name); 
```

...

任何想法如何获取弹出菜单的父级？

谢谢，彼得。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T09:47:43.337

尝试

```
 with (sender as  TPopupMenu)  do
      ShowMessage(PopupComponent.Name); 
```

那应该给你按下的 TToolButton。

# c - 以编程方式生成 C Win32 DLL

> ID：842941
> 
> 赞同：3
> 
> 时间：2009-05-09T08:21:44.480
> 
> 标签：c, winapi, compiler-construction

我需要重复生成一个带有注册信息功能的 Win32 DLL。此函数使用文字返回客户特定的注册信息，并为每个客户构建一个单独的 DLL。

我有一个正常工作的测试版本，其中包含一位客户的硬编码信息。某些站点的紧迫性要求我手动生成一些 DLL，但我想为客户端提供一个动态发出 C 源代码并按需构建 DLL 的应用程序。

最好的方法是什么？我有 VS 2008 C++ Express，因此有 cl.exe 编译器。我目前的方法只是让 C# 应用程序带有一个用于 C 源的字符串常量，在生成之前，用所需参数替换其中的标记，然后通过脱壳和运行 cl.exe 来构建和链接。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-25T19:11:47.703

将所有客户信息作为字符串资源放在 .rc 文件中。将相应的 .res 文件链接到您的 DLL 中。DLL 中依赖于该客户信息的所有代码都将调用 LoadString 来获取它。

然后构建一个名为“UpdateDLL.exe”的单独程序（或函数），它使用 Win32 API：BeginUpdateResource、UpdateResource 等...用新信息更新 DLL。

运送以下物品：

1.  一个预编译的 DLL，在资源中包含用于客户信息的空（或默认）字符串。

2.  将 DLL 名称和客户信息文件作为命令行参数的 UpdateDLL.exe 工具。

3.  您的客户运行“UpdateDLL.exe customer.dll myinfo.txt”以使用他的信息更新他的 DLL 副本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T10:51:41.937

.NET 工具（尤其是编译器）包含在 .NET Framework 安装中。如果您可以避免需要 DLL 是本机 Win32，则使用 Code DOM 和框架支持来动态创建托管 DLL。

要从 Win32 桥接到 .NET，COM 是最简单的方法，但这需要注册。为避免您的动态 dll 需要注册，请创建一个公开 COM 接口的桥管理 dll，将其与您的应用程序一起分发并在安装时注册。它加载（也可以创建）动态创建的 dll。

这样您就无需确保用户为 cl.exe 和 link.exe 安装了 Win32 SDK（或其他途径）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T09:01:18.147

我的一般想法是有一个这样的程序：

```
string UserName = "PLACEHOLDER UserName                     ";
string RegCode  = "PLACEHOLDER RegCode                      ";
bool CheckRegistration(string UserName, RegCode) {
  ...
} 
```

将此编译为`.dll`文件。对于每个用户，加载`.dll`文件，找到里面的两个`PLACEHOLDER`s，替换成真实的用户数据。确保用空格填充字符串。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T19:24:05.737

将文字定义为`#define`s，然后您需要做的就是生成一个头文件。一个自动化的构建系统将负责其余的工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T09:06:33.937

我假设您需要生成的大部分 DLL 都是完全相同的，唯一改变的是每个客户的数据，可以说是一个字符串。如果是这种情况，那么最简单的方法是在您的代码中添加一个足够大的字符串数组，并用一些已知且独特的模式填充它。说类似的东西`"MYSTART-------------MYEND"`并编译DLL。
要生成每个客户端的 DLL，您不必实际重新编译 DLL，只需将那个唯一的字符串替换为每个客户端的字符串。您需要确保您替换的字符串与您在代码中添加的字符串大小完全相同，这样您就不会在文件中添加任何字节。
您可以使用十六进制编辑器或使用 3 行 python/perl 脚本手动执行此搜索和替换。

# delphi - 没有 WS-Security 的用于 SOAP 的 Amazon SimpleDB WSDL 是否正确？

> ID：842948
> 
> 赞同：0
> 
> 时间：2009-05-09T08:25:58.917
> 
> 标签：delphi, soap, wsdl, amazon-web-services, amazon-simpledb

[SimpleDB 文档](http://docs.amazonwebservices.com/AmazonSimpleDB/latest/DeveloperGuide/index.html?NotUsingWSSecurity.html)包括对 ListDomains 方法的此示例请求。请注意，有 Signature、Timestamp、AWSAccessKeyId 和 Version 子元素：

```
 <SOAP-ENV:Body>
    <ListDomainsRequest xmlns=" http://sdb.amazonaws.com/doc/2007-11-07">
      <Signature>SZf1CHmQnrZbsrC13hCZS061ywsEXAMPLE&lt;</Signature>
      <Timestamp>2009-02-16T17:39:51.000Z</Timestamp>
      <AWSAccessKeyId>1D9FVRAYCP1VJS767E02EXAMPLE</AWSAccessKeyId>
      <Version>2007-11-07</Version>
      <Action>ListDomains</Action>
    </ListDomainsRequest>
  </SOAP-ENV:Body> 
```

[WSDL](http://sdb.amazonaws.com/doc/2007-11-07/AmazonSimpleDB.wsdl)对ListDomains 使用此定义：

```
<xs:element name="ListDomains">
    <xs:complexType>
        <xs:sequence>
            <xs:element name="MaxNumberOfDomains" type="xs:int" minOccurs="0"/>
            <xs:element name="NextToken" type="xs:string" minOccurs="0"/>
        </xs:sequence>
    </xs:complexType>
</xs:element>
...
<wsdl:operation name="ListDomains">
    <soap:operation soapAction="ListDomains"/>
    <wsdl:input>
        <soap:body use="literal"/>
        </wsdl:input>
        <wsdl:output>
            <soap:body use="literal"/>
        </wsdl:output>
    </wsdl:operation> 
```

签名、时间戳、AWSAccessKeyId 和版本信息不在 ListDomains 定义中。

AWS 客户支持已经对此进行了调查，并表示这是设计的：

> [“WSDL 将继续只涵盖应用程序级元素，因为它是一种更简洁的方法，更适合长期的“带有 WS-Security 的 SOAP”信封/主体模型。”](http://developer.amazonwebservices.com/connect/thread.jspa?threadID=30814)

示例请求是否正确？例如，在 Delphi 中导入 WSDL 不会为授权元素生成代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T08:33:48.087

好吧，看起来授权元素确实不是 WSDL 的一部分，这有点奇怪......

更有趣的是——亚马逊文档谈到在 SOAP 标头中提供该信息——然而，他们的示例清楚地把它放在了`<SOAP-ENV:Body>`元素中......

如果您在 Delphi 代码或 WSDL 本身中手动添加这些附加元素，会发生什么情况？您能否对其进行调整以使 SimpleDB 服务对此感到满意？

马克

# javascript - 如何在 iframe 中加载 javascript 作为标头的一部分并将其用于子框架

> ID：842953
> 
> 赞同：0
> 
> 时间：2009-05-09T08:30:19.780
> 
> 标签：javascript, iframe

在 iframe 中加载 javascript 就像 gmail 在隐藏的 iframe(js_frame) 中加载 javascript 并使其上下文敏感。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-01T17:09:06.133

要访问父框架的 JavaScript，您只需使用**parent**关键字。例如：

child.htm:

```
<script>
  var childVariable = 'child';

  function showParentVariable() {
    alert('from child: '+parent.parentVariable);
  }

  window.onload = function() {
    if (!!parent.child && parent.child===window) {
      parent.showChildVariable();
    }
  }
</script> 
```

父.htm：

```
<iframe src="child.htm"></iframe>
<script>
  var parentVariable = 'parent';
  var child = window.frames[0];

  function showChildVariable() {
    alert('from parent: '+child.childVariable);
  }

  window.onload = function() {
    child.showParentVariable();
  }
</script> 
```

这是一个现场演示：[子](http://jsbin.com/ufupu/edit) [父](http://jsbin.com/odoca/edit)

不过，我不知道您所说的“上下文敏感”是什么意思。

# php - PHP foreach循环遍历多维数组

> ID：842956
> 
> 赞同：34
> 
> 时间：2009-05-09T08:33:30.037
> 
> 标签：php, arrays, loops, multidimensional-array

我有一个数组：

```
$arr_nav = array( array( "id" => "apple", 
          "url" => "apple.html",
          "name" => "My Apple" 
        ),
        array( "id" => "orange", 
          "url" => "orange/oranges.html",
          "name" => "View All Oranges",
        ),
        array( "id" => "pear", 
          "url" => "pear.html",
          "name" => "A Pear"
        )       
 ); 
```

我想使用 foreach 循环来替换（它只允许我设置数字：

```
for ($row = 0; $row < 5; $row++) 
```

能够显示相关数组值的a`.first`和类`.last`

**编辑**

我希望将数据回显为：

```
<li id="' . $arr_nav[$row]["id"] . '"><a href="' . $v_url_root . $arr_nav[$row]["url"] . '" title="' . $arr_nav[$row]["name"] . '">"' . $arr_nav[$row]["name"] . '</a></li>' . "\r\n"; 
```

非常感谢您的快速回复。StackOverflow 摇滚！

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-09T08:54:47.910

```
$last = count($arr_nav) - 1;

foreach ($arr_nav as $i => $row)
{
    $isFirst = ($i == 0);
    $isLast = ($i == $last);

    echo ... $row['name'] ... $row['url'] ...;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-04T18:44:51.977

```
<?php
$php_multi_array = array("lang"=>"PHP", "type"=>array("c_type"=>"MULTI", "p_type"=>"ARRAY"));

//Iterate through an array declared above

foreach($php_multi_array as $key => $value)
{
    if (!is_array($value))
    {
        echo $key ." => ". $value ."\r\n" ;
    }
    else
    {
       echo $key ." => array( \r\n";

       foreach ($value as $key2 => $value2)
       {
           echo "\t". $key2 ." => ". $value2 ."\r\n";
       }

       echo ")";
    }
}
?> 
```

**输出：**

```
lang => PHP
type => array( 
    c_type => MULTI
    p_type => ARRAY
) 
```

**[参考源代码](http://phptutors.wordpress.com/2013/04/04/php-arrays-example/)**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T08:40:51.423

如果您在谈论 a.first 和 a.last 时指的是数组的第一个和最后一个条目，则如下所示：

```
foreach ($arr_nav as $inner_array) {
    echo reset($inner_array); //apple, orange, pear
    echo end($inner_array); //My Apple, View All Oranges, A Pear
} 
```

PHP 中的数组有一个内部指针，您可以使用[reset](http://de.php.net/manual/en/function.reset.php)、[next](http://de.php.net/manual/en/function.next.php)、[end](http://de.php.net/manual/en/function.end.php)操作该指针。检索键/值适用于[key](http://de.php.net/manual/en/function.key.php)和[current](http://de.php.net/manual/en/function.current.php)，但在许多情况下使用[每个](http://de.php.net/manual/en/function.each.php)可能会更好..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T09:10:06.313

```
<?php
$first = reset($arr_nav); // Get the first element
$last  = end($arr_nav);   // Get the last element
// Ensure that we have a first element and that it's an array
if(is_array($first)) { 
   $first['class'] = 'first';
}
// Ensure we have a last element and that it differs from the first
if(is_array($last) && $last !== $first) {
   $last['class'] = 'last';
} 
```

现在你可以在你的 html-generator 中回显类。可能需要某种检查以确保已设置类，或为数组提供默认的空类。

# fluent-nhibernate - Fluent NHibernate 映射没有原始类文件的连接子类

> ID：842961
> 
> 赞同：0
> 
> 时间：2009-05-09T08:36:01.827
> 
> 标签：fluent-nhibernate, nhibernate-mapping

我有一个库，其中包含一个名为 Recipient 的类，它在库中拥有自己的流畅映射设置。

现在在另一个项目中，我创建了一个名为 SentEmail 的新类，它继承自 Recipient，我希望能够基于原始 Recipient 映射创建一个新的映射类文件。如果我可以更新我会使用的原始 ClassMap 文件

JoinedSubClass("ID", m => *MAPPING HERE* );

但是，因为我无法调整原始班级地图，所以我不知道如何做到这一点。

必须有另一种方法给这只猫剥皮，如果有人有任何想法，他们将不胜感激。

谢谢

**更新**

还有一件事我忘了提到新的 SentEmail 模型类中的部分细节存储在一个单独的表中到收件人表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T09:42:45.567

如果您根本无法调整原始映射，那么您就不走运了；否则您可以使用该`AddPart`方法添加一个单独的`JoinedSubClassPart`.

*顺便说一句：*你的设计听起来有点奇怪。`SentEmail`听起来它不应该真的继承自`Recipient`. `SentEmail`将继承自`Email`, 或`SuccessfulRecipient`从`Recipient`; `Recipient`和`Email`是两个独立的概念。

# ruby-on-rails - 使用 RESTfully 会话在控制器之间传递数据

> ID：842963
> 
> 赞同：2
> 
> 时间：2009-05-09T08:36:56.800
> 
> 标签：ruby-on-rails, controller

我在我的代码中使用了一个*可怕*的模式，我知道必须有更好的方法来做到这一点。帮助我重新思考我在做什么。

我的网站是一种讨论论坛。所有对讨论的回复都在 DiscussionsController#show 页面上进行，内联。

但是，有些回复是无效的 - 例如，如果您尝试发布没有文本的回复，它会将您返回到 DiscussionsController#show 并显示错误消息。

以下是我如何实现此工作流程的简要概述：

1.  用户转到 DiscussionsController#show。这个模板上有一个回复表格。没有明确的 RepliesController#new 操作。
2.  用户提交回复表单，该表单被 POST 到 replies_path 并在 RepliesController#create 中处理。
3.  RepliesController#create 无法保存回复，因为它无效（回复中的 validates_length_of 使对象无效）。
4.  RepliesController#create 将回复对象放入 session[:new_reply] 并重定向到用户来自的讨论路径。
5.  DiscussionsController#show 处理会话对象...

像这样：

```
if session[:new_reply]
  @new_reply = session[:new_reply]
  session.delete(:new_reply)
end 
```

现在 show.html.erb 有一个新生成的 @new_reply 对象来检查错误。

这显然有问题 - 您不应该将整个对象存储在会话中。但是由于我们试图保存在 RepliesController#create 中的回复对象从未保存，我如何在控制器操作调用之间保存它？

或者，如果有更大的设计解决方案，请随时分享。这太丑了，它伤害了我。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T23:13:25.927

我会将回复存储在 [flash](http://api.rubyonrails.org/classes/ActionController/Flash.html)中，而不是会话，这对于通过操作传递消息/对象很有用。

如果回复无效并重定向，控制器将简单地将回复存储在闪存中：

```
if @reply.save
   ...
else
   flash[:reply] = @reply
end 
```

并且您在讨论/显示页面上的表单逻辑需要更聪明一些，并在 Flash 或新的回复中获取回复（我假设您正在讨论/显示操作中创建）：

```
form_for(flash[:reply] || @reply) do
  ...
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T10:31:07.587

不如不重定向，`render :action => "discussions/show"`而是做。我本来想说你也必须设置`@discussion`变量，但应该这样做，因为回复是讨论中的嵌套资源，对吧？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-18T17:19:59.073

我会说你这样做的方式是合理的。不是最干净的，但它是 RESTful 的。

Radar 的建议很棒，但在当前版本的 Rails 中，使用`render :action => "discussions/show"`不会产生正确的行为，至少在我的尝试中，没有嵌套资源路由。使用`render :controller => "discussions", :action => "show"`会产生另一种行为，这不是发布者想要的。

# iphone - 将字符串转换为 CLLocationCoordinate2D

> ID：842970
> 
> 赞同：8
> 
> 时间：2009-05-09T08:40:05.327
> 
> 标签：iphone, string, nsstring, location, coordinates

我有一个包含 NSString 的数组。其中一些是纬度和经度，我需要将其与以下代码一起使用。

latText 和 lonText 是我试图用作坐标的字符串....

```
 CLLocationCoordinate2D pinlocation=mapView.userLocation.coordinate;

    pinlocation.latitude = latText;

    pinlocation.longitude  =lonText; 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-09T10:27:09.030

```
pinlocation.latitude = [latText doubleValue]; 
```

# php - 如何在 PHP 日期时间中添加秒数

> ID：842974
> 
> 赞同：1
> 
> 时间：2009-05-09T08:41:49.347
> 
> 标签：php, datetime

如何在日期时间中添加秒数。前任。我有日期时间 2009-01-14 06:38:18 我需要在该日期添加 -750 秒并希望得到日​​期时间

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T08:45:34.533

您需要将该日期转换为[unix timestamp](http://en.wikipedia.org/wiki/Unix_timestamp)，其中此类操作很简单：

```
$unix_timestamp = strtotime('2009-01-14 06:38:18');
$new_string = date('Y-m-d H:i:s', $unix_timestamp - 750); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T08:59:15.810

strtotime() 还支持一些日期/时间算法。

```
$ts = strtotime('2009-01-14 06:38:18 -750 seconds');
echo date('Y-m-d H:i:s', $ts);
```

或者例如

```
$ts = strtotime('2009-01-14 06:38:18 next monday');
echo date('Y-m-d H:i:s', $ts);
```

打印 2009-01-19 00:00:00

# regex - 在用户代理字符串中匹配非 S P1 IE6 的最佳正则表达式模式？

> ID：842985
> 
> 赞同：1
> 
> 时间：2009-05-09T08:52:00.540
> 
> 标签：regex, user-agent

我需要一些代码来匹配所有不是 SP1 的 IE6 版本（Windows XP SP2 的一部分，令人困惑的呃）。这是为不能正确处理它的 IE 版本关闭 gzip。

我想出的最好的是：

```
MSIE [1-6]\.(?!.*?SV1) 
```

有人有更好的模式吗？上面的正则表达式所做的基本上是向前看，以确保 SV1（表示 SP1）不存在。

出于测试目的，这不应匹配：

```
Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4325) 
```

但这应该：

```
Mozilla/4.0 (Windows; MSIE 6.0; Windows NT 6.0) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-07T21:07:58.790

为什么要使用单个正则表达式，而两个会更简单。伪代码：

```
if String.matches('\bMSIE [1-6]\b') AND NOT String.matches('\bSV1\b') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T14:16:49.893

您的正则表达式可以很好地匹配您正在寻找的用户代理，但您应该知道，某些浏览器的用户代理字符串中包含“MSIE 6.0”以实现兼容性。这是[用户代理字符串的列表](http://www.zytrax.com/tech/web/browser_ids.htm)。

# parsing - 如何阅读写在图像上的文字？

> ID：842986
> 
> 赞同：2
> 
> 时间：2009-05-09T08:52:21.707
> 
> 标签：parsing, image, ocr

我需要将一些扫描的文档解析为文本数据。是否可以使用某些软件解析写在图像上的文本。

如果是，请推荐任何此类在线实用程序或软件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T08:59:47.290

也许一些 OCR 软件会有所帮助？

[http://en.wikipedia.org/wiki/Optical_character_recognition](http://en.wikipedia.org/wiki/Optical_character_recognition)

# php - 如何在 CakePHP 中使用空格正则表达式模型验证字母数字？

> ID：842987
> 
> 赞同：0
> 
> 时间：2009-05-09T08:52:26.030
> 
> 标签：php, regex, validation, cakephp

我有一个用户注册表单，我只希望用户指定他们的名字和姓氏（即 Donalg Doonsberry）。如果用户没有以这种方式提供他们的姓名，则输入将被拒绝。我认为这样的事情适用于我在 cakephp 中的正则表达式用户验证：

```
 'name'=>array('Name has to be comprised of letters.
                '=>array('rule'=>array('custom', '/[A-Za-z ]+/')
           )), 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T08:58:49.650

您必须小心验证名称......怎么样：

*   Donalg McDonald <- 单词中间的大写字母
*   Donalg Fooble-Whiffery <- 连字符
*   Donalg Dénsbnérry-McDonald Sr. 3rd <- 你明白了

要以您指定的格式验证名称：

```
/[A-Z][a-z]+ [A-Z][a-z]+/ 
```

宽容一点：

```
/([\w.-]+ )+[\w+.-]/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T17:08:01.383

就个人而言，我不会打扰名字/姓氏验证。您只能验证它们的长度（蛋糕中有一个内置的验证规则）并确保您输入“allowEmpty”=> true，如果这是您想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-06T19:01:15.583

我使用下面的代码来验证带有 alphaNumeric 和空格的字段。

```
'rule1' = array(
   'rule' => array('custom','/([\w.-]+ )+[\w+.-]/'),
   'required' => true,
   'message' => 'Required field.'
) 
```

我希望能帮助你。

# android - Android 项目使用 Ant 构建良好，但出现运行时错误

> ID：842997
> 
> 赞同：-1
> 
> 时间：2009-05-09T09:01:41.997
> 
> 标签：android, ant

我正在使用 ANT 构建 android 项目，我在 lib 文件夹中添加外部 jar 并尝试构建它完美构建的项目，但我收到运行时错误...我看到一些组他们说 build.xml必须使用这些更改进行修改

```
<target name="dex" depends="compile"> 
    <exec executable="${dx}" failonerror="true"> 
        <arg value="-JXmx384M" /> 
        <arg value="--dex" /> 
        <arg value="--output=${basedir}/${intermediate-dex}" /> 
        <arg value="--locals=full" /> 
        <arg value="--positions=lines" /> 
        <arg path="${basedir}/${outdir-classes}" /> 
    </exec> 
</target> 
```

在最后一个参数之后添加一个新参数：

但是当我添加相同的内容时，它没有构建是否有任何机构出现相同的问题......并且错误是没有指定命令

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-05-11T03:58:37.987

> 处理“javax/xml/XMLConstants.class”时遇到问题：[2009-05-11 09:24:13 - ChitMeAndroidClient] 尝试将核心 VM 类包含在核心库以外的其他东西中。

您可能已尝试将桌面虚拟机中的核心库包含到应用程序中，这肯定不会起作用。如果您真的打算构建一个核心库——它只适合作为创建完整虚拟机二进制文件的一部分，而不是编译应用程序——然后使用该`--core-library`选项来抑制此错误消息。如果您继续使用`--core-library`但实际上正在构建应用程序，那么请注意您的构建在某些时候仍然会失败；您将被剥夺阅读此有用错误消息的乐趣。

这是编译时错误.......

# c# - 如果有多个属性，如何对列表类型进行通用排序？

> ID：842998
> 
> 赞同：6
> 
> 时间：2009-05-09T09:02:47.953
> 
> 标签：c#, .net, asp.net, generics

我有一个具有属性（类类型）的列表泛型。我需要 Z 参数的排序方法（TrainingSet）：

```
public override List<TrainingSet> CalculatedDistancesArray
    (List<TrainigSet> ts, double x, double y, int k)
{
    for (int i =0; i < ts.Count; i++)
    {
        ts[i].Z = (Math.Sqrt(Math.Pow((ts[i].X - x), 2) 
                  + Math.Pow((ts[i].Y - y), 2)));
    }
    // I want to sort according to Z
    ts.Sort(); //Failed to compare two elements in the array.
    List<TrainingSet> sortedlist = new List<TrainingSet>();
    for (int i = 0; i < k; i++)
    {
        sortedlist.Add(ts[i]);
    }
    return ts;
}

public class TrainigSet
{
    public double X { get; set; }
    public double Y { get; set; }
    public double Z { get; set; }
    public string Risk { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-09T09:07:48.643

仅对单个属性进行排序很容易。使用需要 a 的重载`Comparison<T>`：

```
// C# 2
ts.Sort(delegate (TrainingSet o1, TrainingSet o2) 
       { return o1.Z.CompareTo(o2.Z)); }
);

// C# 3
ts.Sort((o1, o2) => o1.Z.CompareTo(o2.Z)); 
```

对多个属性进行排序有点棘手。我有类以复合方式建立比较，以及建立“投影比较”，但如果你真的只想按 Z 排序，那么上面的代码将变得尽可能简单。

如果您使用的是 .NET 3.5 并且您实际上并不需要就地对列表进行排序，则可以使用 OrderBy 和 ThenBy，例如

```
return ts.OrderBy(t => t.Z); 
```

或更复杂的比较：

```
return ts.OrderBy(t => t.Z).ThenBy(t => t.X); 
```

这些将由`orderby`查询表达式中的子句表示：

```
return from t in ts
       orderby t.Z
       select t; 
```

和

```
return from t in ts
       orderby t.Z, t.X
       select t; 
```

（如果需要，您也可以按降序排序。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T09:06:44.030

```
var sortedList = 
      list.OrderBy(i => i.X).ThenBy(i => i.Y).ThenBy(i => i.Z).ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-10T15:48:28.080

你可以试试这个。它对我有用：

```
ts.Sort(delegate(TrainingSet a, TrainingSet b) { return a.X.CompareTo(b.X) != 0 ? a.X.CompareTo(b.X) : a.Y.CompareTo(b.Y); }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T11:36:12.093

使用框架 3.5，这将是：

```
public override List<TrainingSet> CalculatedDistancesArray(List<TrainigSet> ts, double x, double y, int k) {
   foreach (TrainigSet t in ts) {
      t.Z = Math.Sqrt(Math.Pow(t.X - x, 2) + Math.Pow(t.Y - y, 2));
   }
   return ts.OrderBy(t => t.Z).Take(k).ToList();
} 
```

注意：这不会改变 ts 列表的顺序，而是创建一个新的排序列表来返回。

（我假设您实际上想要返回列表中的前 k 个项目，而不是像您在问题代码中所做的那样返回 ts 列表。）

使用框架 2 需要更多代码：

```
public override List<TrainingSet> CalculatedDistancesArray(List<TrainigSet> ts, double x, double y, int k) {
   foreach (TrainigSet t in ts) {
      t.Z = Math.Sqrt(Math.Pow(t.X - x, 2) + Math.Pow(t.Y - y, 2));
   }
   ts.Sort(delegate (TrainigSet t1, TrainigSet t2) { return t1.Z.CompareTo(t2.Z)); });
   List<TrainigSet> result = new List<TrainigSet>(k);
   for (int i = 0; i < k ; i++) {
      result.Add(ts[i]);
   }
   return result;
} 
```

如果您仅使用 Z 值进行排序，则可以跳过`Math.Sqrt`调用并将该值保留为距离的平方，因为它的排序与距离完全相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T16:43:30.543

如果您在类型“TrainingSet”上实现 IComparable<TrainingSet>，您将能够使用列表中的 Sort 方法。您将必须实现“CompareTo”方法。然后，您可以简单地将您的实现委托给您的双类型 Z 的“CompareTo”。这将避免您的异常。

# c - .h 和 .m 代表什么？

> ID：842999
> 
> 赞同：2
> 
> 时间：2009-05-09T09:03:10.310
> 
> 标签：c, objective-c, abbreviation

### 完全重复：

> [为什么 Objective C 文件使用 .m 扩展名？](https://stackoverflow.com/questions/652186/why-do-objective-c-files-use-the-m-extension)

我在想 .h 代表标题。我想 .m 可以代表主要，但我不知道。你们中有人真的*知道*吗？

只是为了澄清，我知道哪个文件中有什么。（即我知道每种文件类型的用途。）我只是好奇文件扩展名是否有任何特殊含义。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T09:06:36.370

*   h -**标题**
*   m -**方法**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T09:08:18.737

.h 代表标题，而 .m 代表实现

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T09:04:47.497

对，.h 代表头文件。.m 适用于您的代码，例如 c++ 中的 .cpp

问候， 布克**********