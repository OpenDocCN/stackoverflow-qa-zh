# StackOverflow 问答 000791000-000791999

# mysql - 使用可扩展性选项设置多个 MySQL 数据库

> ID：791000
> 
> 赞同：1
> 
> 时间：2009-04-26T14:56:30.780
> 
> 标签：mysql, scalability, mysql-proxy

我需要设置一个 MySQL 环境，该环境将支持随着时间的推移添加许多独特的数据库（实际上是数千个）。我假设在某些时候我需要开始添加 MySQL 服务器，并且希望我的环境事先为这种情况做好准备，以便轻松过渡到第 2、第 3、第 100 个服务器。

并且只是为了让它变得有趣，如果解决方案被建模以便查询数据库的应用程序将所有查询发送到单个地址并接收结果，那将非常方便。它应该不知道服务器的数量和位置。数据库名称是唯一的，可用于确定哪个服务器拥有数据库。

我已经进行了一些研究，MySQL Proxy 成为主要候选者，但我无法找到任何关于使其按上述方式执行的具体信息。

任何人？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T15:10:01.107

好问题。我知道有几家公司已经做到了这一点（Facebook 跃居最大）。没有人高兴，但其他选择也很糟糕。

您需要考虑更多的事情——当其中一些数据库或服务器出现故障时会发生什么？当您需要执行跨数据库查询时会发生什么（即使您现在不这么认为，您也会这样做）。

这是 FriendFeed 解决方案： http: [//bret.appspot.com/entry/how-friendfeed-uses-mysql](http://bret.appspot.com/entry/how-friendfeed-uses-mysql)

这有点“背道而驰”，因为他们基本上使用 MySQL 作为美化的键值存储。我不确定他们为什么不直接去掉中间人，而是使用 BerkeleyDB 之类的东西来存储他们的对象。连接管理，也许？似乎 MySQL 开销对于可以很容易添加的东西（著名的遗言）支付的代价太高了。

您真正要寻找的（我认为）是分布式无共享数据库。有几个是基于 MySQL 和 PostgreSQL 等开源技术构建的，但没有一个是免费的。如果您有购买情绪，请查看以下公司：[Greenplum](http://www.greenplum.com)、[AsterData](http://www.asterdata.com)、[Netezza](http://www.netezza.com)、[Vertica](http://www.vertica.com)。

还有大量的各种分布式键值存储解决方案。由于缺乏更好的参考，这里是一个起点：[http](http://www.metabrew.com/article/anti-rdbms-a-list-of-distributed-key-value-stores/) ://www.metabrew.com/article/anti-rdbms-a-list-of-distributed-key-value-stores/ 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T20:13:29.090

您的问题听起来与我们面临的问题相似 - 您充当白标，并且每个客户都需要拥有自己的单独数据库。假设这个概念与您的概念相似，我们所做的是利用一个“主”数据库来存储客户端的主机名和数据库名称（可以缓存在应用程序层中）。然后，客户端正在访问的服务器可以将其数据源动态地转移到所需的数据库。这使我们能够扩展到数千个客户端数据库，分散在服务器上。

# c++ - joySetCapture 不适用于 fChanged = false

> ID：791002
> 
> 赞同：1
> 
> 时间：2009-04-26T14:58:36.720
> 
> 标签：c++, windows

我正在使用带有**fChanged**（第 4 个参数）= true 的 joySetCapture。

我只有在位置改变时才会收到消息，我应该这样做。但是，按下操纵杆按钮时，我没有收到任何消息。

如果我使用 fChanged = false，则定期消息的 wParam 会正确更新。

如何仅在更改位置或按钮*时才获取消息，而不使用定期消息？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T15:36:39.450

的文档[`joySetCapture`](http://msdn.microsoft.com/en-us/library/ms709363(VS.85).aspx)说如果`fChanged`是真的，那么只有当位置变化超过阈值时*才会发送消息。*由于它没有提到按钮，我会假设按下按钮时它不会发送消息。这对我来说似乎是糟糕的设计，但如果是这样，那么你必须处理它。

为什么不想使用定期轮询消息？只要您将轮询间隔设置为合理的值（例如 60 Hz 刷新率为 16 ms），我可以向您保证，轮询操纵杆不会成为您的应用程序的瓶颈，所以这不是性能问题. 没有理由将轮询间隔设置为非常小的值，因为硬件根本不会那么快地发送更新，所以你只会浪费处理相同数据的周期。

最后，多媒体操纵杆 API 有点过时，已被 DirectX 取代。您应该改用 DirectInput，以便您可以处理具有 4 个以上按钮或 2 个以上轴的操纵杆。此外，如果您使用的是 Xbox 360 控制器，您应该使用 XInput 库来处理这些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T01:34:14.820

除非您需要与 Win98 之前的 Windows 兼容，否则为什么不直接使用 DirectInput API？无论如何，joy* API 只是[DirectInput API 的封装。](http://msdn.microsoft.com/en-us/library/bb219802(VS.85).aspx)

# delphi - 如何检测 Delphi 类是否具有虚拟构造函数？

> ID：791004
> 
> 赞同：2
> 
> 时间：2009-04-26T14:58:53.350
> 
> 标签：delphi, delphi-2009, rtti

例如，有没有办法找出这个类有一个虚拟构造函数（在运行时）？

```
 TMyClass = class(TObject)
     MyStrings: TStrings;
     constructor Create; virtual;   
   end; 
```

例如，在这段代码中，我想测试 Clazz 引用的类是否具有虚拟构造函数：

```
procedure Test;
var
  Clazz: TClass;
  Instance: TObject;
begin
  Clazz := TMyClass;
  Instance := Clazz.Create;
end; 
```

是否有一个简单的解决方案，例如使用 RTTI，它适用于 Delphi 6 到 2009？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T15:24:57.467

通过 TypInfo 单元，看起来没有任何方法可以判断一个方法是否使用 RTTI 是虚拟的。但是，如果您有类引用，您可能可以通过检查 VMT 来滚动您自己的方法。

根据 Allen Bauer 的说法，在对[这个问题](https://stackoverflow.com/questions/760513/where-can-i-find-information-on-the-structure-of-the-delphi-vmt)的回答中，您可以在 vmtClassName 指向的值之前立即找到 VMT 的结尾。第一个用户定义的虚拟方法（如果有）位于类引用的地址。换句话说，`pointer(Clazz)^`. 既然您知道了 VMT 的用户定义部分的起点和终点，那么创建一个 while 循环将表中的每个指针与指向 Clazz.create 的方法指针的 Code 部分进行比较应该不会太难强制转换为 TMethod。如果你得到一个匹配，那么它是一个虚拟方法。如果不是，那就不是。

是的，这有点小技巧，但它会起作用。如果有人能找到更好的解决方案，他们就会有更多的权力。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T20:05:07.263

你知道，我想得越多，我就越不喜欢我给出的最终被接受的答案。问题是，编写的代码只能处理编译时已知的信息。如果将 Clazz 定义为 TClass，那么将 Clazz.Create 放在 TMethod 中总是会给您一个指向 TObject.Create 的方法指针。

您可以尝试将 Clazz 定义为“TMyClass 的类”。问题是，你已经有了一个虚拟构造函数，所以它将为你提供它可以达到的最高级别的构造函数，它会覆盖该构造函数。但是从您的评论来看，您试图找到的是一个非虚拟构造函数（使用**reintroduce;**），它会破坏您的虚拟构造。您很可能正在使用工厂模式，这可能是一个问题。

唯一的解决方案是使用 RTTI 来查找实际附加到类的构造函数。您可以获得“名为 Create 的方法”的方法指针，并在我在其他答案中解释的技巧中使用它。为此，您的基本虚拟构造函数必须声明为**已发布**。这将强制所有覆盖它的方法也被发布。问题是，仍然有人可以使用**reintroduce；**在更高的地方声明一个未发布的构造函数，你的计划就会崩溃。您无法保证后代类会做什么。

这个问题没有技术解决方案。唯一真正有效的是教育。你的用户需要知道这个类是由一个工厂实例化的（或者你需要虚拟构造函数的任何原因），如果他们在派生类中重新引入构造函数，它可能会破坏事情。为此在文档中添加注释，并在源代码中添加注释。这几乎就是你能做的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T14:51:48.507

迈克尔，

我得到你的问题，但由于你的源代码没有编译，我认为你错过了你的问题的重点;-)

我的回答稍微详细说明了梅森在第二个回答中试图解释的内容。

手头的问题是您的问题暗示您有一个“类引用”（如 TClass 或 TComponentClass），它引用了具有虚拟构造函数的基类。但是，TClass 没有（TClass 引用具有非虚拟构造函数的类），但 TComponentClass 有。

使用类引用反汇编对构造函数的调用时，您会看到不同之处。通过类引用调用虚拟构造函数时，代码与调用非虚拟构造函数时的代码略有不同：

*   调用虚拟构造函数具有间接性
*   调用非虚拟构造函数进行直接调用

这个反汇编显示了我的意思：

```
TestingForVirtualConstructor.dpr.37: ComponentClassReference := TMyComponentClass;
00416EEC A1706D4100       mov eax,[$00416d70]
TestingForVirtualConstructor.dpr.38: Instance := ComponentClassReference.Create(nil); // virtual constructor
00416EF1 33C9             xor ecx,ecx
00416EF3 B201             mov dl,$01
00416EF5 FF502C           call dword ptr [eax+$2c]
TestingForVirtualConstructor.dpr.39: Instance.Free;
00416EF8 E8CFCDFEFF       call TObject.Free
TestingForVirtualConstructor.dpr.41: ClassReference := TMyClass;
00416EFD A1946E4100       mov eax,[$00416e94]
TestingForVirtualConstructor.dpr.42: Instance := ClassReference.Create(); // non-virtual constructor
00416F02 B201             mov dl,$01
00416F04 E893CDFEFF       call TObject.Create
TestingForVirtualConstructor.dpr.43: Instance.Free;
00416F09 E8BECDFEFF       call TObject.Free 
```

因此，当您有一个构造函数是虚拟的类引用类型的变量，并且您通过该变量调用该构造函数时，您可以确定该变量中的实际类将具有一个虚拟构造函数。

您无法确定在哪个实际类上实现了该构造函数（好吧，不是没有额外的调试信息，例如来自 .DCU、.MAP、.JDBG 或其他来源）。

这是编译的示例代码：

```
program TestingForVirtualConstructor;

{$APPTYPE CONSOLE}

uses
  Classes, SysUtils;

type
  TMyComponentClass = class(TComponent)
    MyStrings: TStrings;
    constructor Create(Owner: TComponent); override;
  end;

constructor TMyComponentClass.Create(Owner: TComponent);
begin
  inherited;
end;

type
  TMyClass = class(TObject)
    MyStrings: TStrings;
    constructor Create();
  end;

constructor TMyClass.Create();
begin
  inherited;
end;

procedure Test;
var
  // TComponentClass has a virtual constructor
  ComponentClassReference: TComponentClass;
  ClassReference: TClass;
  Instance: TObject;
begin
  ComponentClassReference := TMyComponentClass;
  Instance := ComponentClassReference.Create(nil); // virtual constructor
  Instance.Free;

  ClassReference := TMyClass;
  Instance := ClassReference.Create(); // non-virtual constructor
  Instance.Free;
end;

begin
  try
    Test;
  except
    on E: Exception do
      Writeln(E.Classname, ': ', E.Message);
  end;
end. 
```

回到你原来的问题：当你的类引用引用了一个具有虚拟构造函数的基类时，你确信你总是会使用间接调用一个虚拟构造函数。当您的类引用引用具有非虚拟构造函数的基类时，您肯定会始终使用直接调用来调用非虚拟构造函数。

希望这对您的问题有更多的了解。

——杰伦

# svn - 如何通过每次 svn commit 运行命令来生成文档

> ID：791014
> 
> 赞同：5
> 
> 时间：2009-04-26T15:08:15.540
> 
> 标签：svn, documentation

是否可以让 svn 在每次提交之前运行一些命令？我在存储库中有一些 LaTeX 文档，并希望始终在存储库中以 PDF 格式提供最新版本的已编译文档。Doxygen 文档也是如此。

我敢打赌，有一些魔法`svn:something`属性或类似的东西，但还没有找到任何东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-26T15:09:44.803

您可以轻松地做相反的事情。`svn commit`创建一个在构建内容后运行的 shell 脚本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T17:46:19.670

如果你自动生成文档，为什么要把它放在存储库中呢？您每次都创建它，因此对其进行版本化也没有意义（毕竟它是生成的）。我宁愿使用预提交钩子来生成文档并将其放到一个公共的地方来访问它，而不是将它存储在存储库中——将它存储在存储库中会产生冗余，从我的角度来看应该避免这种冗余。

（而且我同意预提交钩子不应该修改正在提交的内容：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T15:12:14.503

所有这些操作都在服务器端进行控制。查看存储库目录，您会发现一个带有大量示例脚本的 hooks 文件夹。你想要预提交钩子。

请记住，如果您在 Windows 上运行服务器，则这些脚本在没有环境的情况下执行，因此不要假设设置了路径并使用绝对路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T15:10:21.450

使用[预提交挂钩](http://svnbook.red-bean.com/nightly/en/svn.reposadmin.create.html#svn.reposadmin.create.hooks)

# c# - C#：如何在列表视图中添加图像？

> ID：791016
> 
> 赞同：0
> 
> 时间：2009-04-26T15:08:36.977
> 
> 标签：c#, winforms

如此体面的问题，我如何添加图像（我用谷歌搜索，但他们说我必须添加大约 50 行代码才能做到这一点，为什么？）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T15:15:42.933

这取决于您希望图像出现在哪个项目上。

*   要在每个项目的左侧设置图标，首先设置控件的 LargeImageList 和/或 SmallImageList 属性，然后设置项目的 ImageIndex 属性。
*   要在项目的任何其他位置显示图像，您需要使用列表视图控件的所有者绘图功能。[MSDN 中](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.ownerdraw.aspx)有一个示例，尽管这可能与您已经找到的 50 行代码相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T15:25:20.803

WinForms 的一个大问题是它只是对原生 Windows UI 控件的一个小抽象。只要 WinForms 支持所需的功能，例如 Tim 提到的 ListView 上的图标，完成任务相对容易，但一旦 WinForms 不支持您想要的功能，您几乎需要从头开始实现它。WinForms 中的幸运列表控件提供了一种相对简单的方法来使用所有者绘图功能来绘制您自己的内容。

更简单的方法是查看 WPF，它在需要更专业的功能时是更通用的框架**。**虽然这需要 .Net 框架 3.0 或更高版本，并且学习曲线有点陡峭。

# asp.net - 如何从数据库中打印页面中的值

> ID：791025
> 
> 赞同：0
> 
> 时间：2009-04-26T15:12:39.073
> 
> 标签：asp.net, database

如何在 asp.net 2008 的页面中显示信息（从数据库中获取）

目前我使用 GridView，但它在 TABLE 中显示信息。我想在正常行中显示它。

例如：我的数据库中有这张表

[http://www.rofof.com/img2/4jpqfn26.gif](http://www.rofof.com/img2/4jpqfn26.gif)

[替代文字 http://www.rofof.com/img2/4jpqfn26.gif](http://www.rofof.com/img2/4jpqfn26.gif)

我想在我的页面中打印一条信息：

> 你是A，你的ID是：1

不使用 GridView。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T15:21:37.880

您如何将数据从数据库获取到您的网格视图？您还想只显示一条记录还是显示多条记录？

如果您想显示所有记录，Repeater 是一个很好的控件。您可以以与绑定网格相同的方式绑定它，然后定义您的模板以呈现您想要的 html。

如果您只想显示一条记录，您可以在页面后面的代码中执行此操作。例如：

```
Page_Load()
{
   if (!IsPostBack) //Make sure this only runs first time we call page
   {
     //Get your data from the DB, can't help here unless 
     //you provide more details. 
       MyData data=....
       myLabel.Text="You are " + data["name"].ToString() ....
   }
} 
```

如果您使用有关数据源的更多详细信息更新您的问题（您是否使用数据表自定义对象等...）。我可以用更好的例子来更新我的答案

# ruby-on-rails - 连接到 options_for_select 的数组常量的问题

> ID：791026
> 
> 赞同：0
> 
> 时间：2009-04-26T15:13:59.850
> 
> 标签：ruby-on-rails, ruby

我有以下代码：

```
<%= select_tag :role, options_for_select(Project::COMPANY_ROLES.concat(['Other...']), @relationship.role) %> 
```

出于某种原因，它将“其他...”连接到 COMPANY_ROLES，但将其保存在加载的视图之后。

第一次运行 = 1 个“其他...”选项

第 2 次运行 = 2 个“其他...”选项

第 3 次运行 = 3 个“其他...”选项

我只是希望它在运行时连接而不是保存状态。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T15:44:59.337

尝试：

```
<%= select_tag :role, options_for_select(Project::COMPANY_ROLES + ['Other...'], @relationship.role) %> 
```

# c# - 我应该将枚举 ID/值存储在数据库中还是 C# 枚举中？

> ID：791030
> 
> 赞同：12
> 
> 时间：2009-04-26T15:16:17.720
> 
> 标签：c#, database, enums, constants

假设我的数据库表有`UserType`,`SalesType`等列。

我应该有数据库表`UserTypeID`，`userTypeName`还是应该只创建一个 C# 枚举？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-26T15:21:05.947

两者有什么问题？如果值是用户定义或更改的，则绝对`enum`不合适。

如果值是严格不变的（例如性别），您可以将它们作为`enums`便于在应用程序中引用，也可以在数据库中作为单独的表来强制执行外键并作为参考。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-26T15:40:39.847

这取决于。我在下面列出了每种方法的一些优点和缺点。一般来说，如果应用程序需要使用一个值来做出决策，我更喜欢枚举。正如 Mehdrad 提到的，您可以使用这两种方法，但需要额外的努力来保持列表同步。

查找表：

*   参照完整性可以通过外键强制执行
*   易于添加或删除现有值
*   可以扩展表格以添加其他字段（活动标志等）
*   如果使用业务对象，则需要额外的类
*   报告中易于使用的价值和描述

枚举：

*   检查约束可以强制数据完整性
*   如果代码需要使用值进行分支，则最佳选择（例如 x == SalesType.Web 与 x == "WEB"）
*   需要软件版本才能更改值
*   无法在 SQL 查询中显示描述（没有 CASE）
*   枚举可能不适合在 UI 中显示（有解决方法）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T15:25:35.453

如果列表足够稳定以使用枚举，那么我将在您的代码中使用枚举加上数据库中的表（使其成为数据一致性的外键）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T16:01:44.850

在我的项目中，我使用我的应用程序[dbscript](http://devio.wordpress.com/category/dbscript/)从数据库生成 C# const，因此代码始终与 db 值匹配。

当然，如果您的代码根据 Type 字段的值执行特定操作，则只需要使用 C# 枚举。

# algorithm - 统计估计算法

> ID：791036
> 
> 赞同：3
> 
> 时间：2009-04-26T15:20:09.477
> 
> 标签：algorithm, math

我不确定这个问题是否适合 Stack Overflow，但无论如何我都会尝试一下。我有一些数据如下：

![替代文字](https://i.stack.imgur.com/c2Jaz.png)

我还有另一组数据，我相信它们遵循类似的分布，但我只知道总百分比（例如 30% 而不是 17%。）任何人都可以建议一种算法来根据新的总数估计每个单独层的 %s % 和原始分布？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T01:13:57.737

**第 1 步：**如果您的总体百分比为 17% → 30%，则实际（总计）105 → ~189。

**第 2 步：**此数字需要分布在**实际列中的所有元素上**

从这里开始，事情变得非线性，我们需要一些公式来从 POssible 得出实际值。这需要是总数的函数。

即，功能（可能，总计（实际））=实际。

如果我们能达到上述要求，那么它可能会起作用；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T00:57:58.527

你的问题不清楚。如果您想通过包含您获得的附加数据来估计新的总百分比，您必须有与您的百分比相关联的数量，以便您可以创建一个有意义的加权平均值。

如果您想确定新数据集是否具有与历史数据不同的分布，则有几个测试主要对低于特定值的累积实际值与预期值百分比进行钝角计算。关于比较两个总体分布的主题有很多文献。

对于配对样本，如果您不能对数据的分布做出任何假设，则[Wilcoxon-Rank是一种标准方法。](http://en.wikipedia.org/wiki/Wilcoxon_signed-rank_test)对于非配对数据，存在[非参数统计](http://books.google.com/books?id=1Nrzy56BGPwC&pg=PA114&lpg=PA114&dq=distribution+free+rank+test&source=bl&ots=tRstainvDm&sig=Yv4hcjTkOBqCwEio0zvYxQl4M84&hl=en&ei=0wD1SbKwCJe-M8a6gLkP&sa=X&oi=book_result&ct=result&resnum=1#PPA55,M1)，但它们需要一些深入研究。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-22T13:05:49.200

如果您的新总数为 x，则将 (22/627)*x 尽可能放在第 1 层，将 (21/627)*x 作为第 1 层的实际值，这将为您提供与之前第 1 层相同的百分比。然后对其他层做同样的事情（第 2 层可能是 (45/627)*x 等）。

# drop-down-menu - Joomla 1.0 - 需要在现有模板中添加下拉菜单

> ID：791043
> 
> 赞同：1
> 
> 时间：2009-04-26T15:23:36.253
> 
> 标签：drop-down-menu, menu, joomla, menubar

将下拉菜单添加到 Joomla 1.0 中的现有模板（无法升级）的最佳和最简单的方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-20T19:43:16.893

模块 SwFreeMenu 适用于 1.0 afaik。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T15:32:01.037

取决于您在该菜单中提供什么样的选项。如果它只是一些静态的东西，比如`Select language: (options) English, German, Spanish`，您可以通过在正确的位置编辑模板的 HTML 标记来直接将其添加到模板中。

但是，如果您打算做一些更动态的事情，那么模板不是破解的地方。您可能想要创建一个“模块”并将其添加到您的站点模块列表中，并添加到模板定义的所需位置。然后您可以设置该模块将出现在哪些页面上。我相信你可以复制一个像搜索框这样的简单模块，然后更改模块的代码。我以前没有做过，但我敢打赌这很简单。

# windows-services - 无法访问 SAN 存储设备

> ID：791049
> 
> 赞同：1
> 
> 时间：2009-04-26T15:26:18.900
> 
> 标签：windows-services, ftp, filesystems

我正在尝试以编程方式 FTP 存储在 SAN 设备上的备份文件。该设备已映射到服务器上。我通过从桌面上的图标运行它来测试应用程序，它运行良好。当我通过 Windows 服务运行程序时，我收到一条错误消息，提示找不到驱动器。运行服务的帐户是本地帐户。我认为问题可能出在那个帐户上，所以我创建了一个新用户并在该帐户下运行服务。出现相同的错误消息。有没有人遇到过这个问题并找到解决这个问题的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T15:30:11.137

驱动器映射仅对登录用户存在。出于这个原因，它们对服务不可见，因为它在较低级别上运行。如果要使用服务中的存储位置，则需要使用一些 ftp 客户端。

网络共享出现同样的问题，您无法从服务访问映射到网络驱动器的网络共享。从服务访问这些共享的正确方法是使用类似于`"\\SANS\Backuplocation"`.

# algorithm - 使用 O(1) 辅助空间迭代二叉树

> ID：791052
> 
> 赞同：25
> 
> 时间：2009-04-26T15:28:30.750
> 
> 标签：algorithm, language-agnostic, tree, memory-management, binary-tree

是否可以在 O(1) 辅助空间中迭代二叉树（不使用堆栈、队列等），或者这已被证明是不可能的？如果可能，怎么做？

编辑：如果有指向父节点的指针，我得到的关于这可能的响应很有趣，我不知道这可以做到，但取决于你如何看待它，这可能是 O(n) 辅助空间。此外，在我的实际用例中，没有指向父节点的指针。从现在开始，请在回答时假设这一点。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-26T18:53:09.277

天哪，我必须从 Knuth 那里实际输入它。该解决方案由 Joseph M. Morris [ *Inf. 过程。信件* **9**  (1979), 197-200]。据我所知，它在 O(NlogN) 时间内运行。

```
static void VisitInO1Memory (Node root, Action<Node> preorderVisitor) {
  Node parent = root ;
  Node right  = null ;
  Node curr ;
  while (parent != null) {
    curr = parent.left ;
    if (curr != null) {
      // search for thread
      while (curr != right && curr.right != null)
        curr = curr.right ;

      if (curr != right) {
        // insert thread
        assert curr.right == null ;
        curr.right = parent ;
        preorderVisitor (parent) ;
        parent = parent.left ;
        continue ;
      } else
        // remove thread, left subtree of P already traversed
        // this restores the node to original state
        curr.right = null ;
    } else
      preorderVisitor (parent) ;

    right  = parent ;
    parent = parent.right ;
  }
}

class Node
{
  public Node left  ;
  public Node right ;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-26T15:33:26.447

如果您在每个孩子中都有指向父母的链接，这是可能的。当你遇到一个孩子时，访问左子树。回来时检查一下你是否是你父母的左孩子。如果是这样，请访问右子树。否则，继续往上走，直到你成为左孩子或直到你碰到树的根。

在此示例中，堆栈的大小保持不变，因此不会消耗额外的内存。当然，正如 Mehrdad 所指出的，到父节点的链接可以被认为是 O(n) 空间，但这更多的是树的属性，而不是算法的属性。

如果您不关心遍历树的顺序，则可以将积分映射分配给根为 1 的节点，根的子节点为 2 和 3，子节点为 4、5、 6、7 等等。然后通过递增计数器并通过其数值访问该节点来循环遍历树的每一行。您可以跟踪可能的最高子元素并在计数器通过时停止循环。从时间上看，这是一个效率极低的算法，但我认为它需要 O(1) 空间。

（我借用了堆编号的想法。如果你有节点 N，你可以在 2N 和 2N+1 找到孩子。你可以从这个数字倒推找到孩子的父母。）

这是该算法在 C 中的一个示例。请注意，除了创建树之外没有 malloc，并且没有递归函数，这意味着堆栈占用恒定空间：

```
#include <stdio.h>
#include <stdlib.h>

typedef struct tree
{
  int value;
  struct tree *left, *right;
} tree;

tree *maketree(int value, tree *left, tree *right)
{
  tree *ret = malloc(sizeof(tree));
  ret->value = value;
  ret->left = left;
  ret->right = right;
  return ret;
}

int nextstep(int current, int desired)
{
  while (desired > 2*current+1)
      desired /= 2;

  return desired % 2;
}

tree *seek(tree *root, int desired)
{
  int currentid; currentid = 1;

  while (currentid != desired)
    {
      if (nextstep(currentid, desired))
    if (root->right)
      {
        currentid = 2*currentid+1;
        root = root->right;
      }
    else
      return NULL;
      else
    if (root->left)
      {
        currentid = 2*currentid;
        root = root->left;
      }
    else
      return NULL;
    }
  return root;  
}

void traverse(tree *root)
{
  int counter;    counter = 1; /* main loop counter */

  /* next = maximum id of next child; if we pass this, we're done */
  int next; next = 1; 

  tree *current;

  while (next >= counter)
    {   
      current = seek(root, counter);
      if (current)
      {
          if (current->left || current->right)
              next = 2*counter+1;

          /* printing to show we've been here */
          printf("%i\n", current->value);
      }
      counter++;
    }
}

int main()
{
  tree *root1 =
    maketree(1, maketree(2, maketree(3, NULL, NULL),
                            maketree(4, NULL, NULL)),
                maketree(5, maketree(6, NULL, NULL),
                            maketree(7, NULL, NULL)));

  tree *root2 =
      maketree(1, maketree(2, maketree(3,
          maketree(4, NULL, NULL), NULL), NULL), NULL);

  tree *root3 =
      maketree(1, NULL, maketree(2, NULL, maketree(3, NULL,
          maketree(4, NULL, NULL))));

  printf("doing root1:\n");
  traverse(root1);

  printf("\ndoing root2:\n");
  traverse(root2);

  printf("\ndoing root3:\n");
  traverse(root3);
} 
```

*我为代码的质量道歉——这在很大程度上是一个概念证明。此外，该算法的运行时间并不理想，因为它做了很多工作来弥补无法维护任何状态信息的问题。从好的方面来说，这确实符合 O(1) 空间算法的要求，用于以任何顺序访问树的元素，而不需要子链接到父链接或修改树的结构。*

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-26T16:20:16.007

你可以破坏性地做到这一点，在你走的时候断开每一片叶子的链接。这可能适用于某些情况，即当您之后不再需要树时。

通过扩展，您可以在销毁第一个二叉树时构建另一棵二叉树。您将需要一些内存微管理来确保峰值内存永远不会超过原始树的大小加上可能有点恒定。不过，这可能会产生相当多的计算开销。

*编辑：* 有办法！您可以使用节点本身通过暂时反转它们来照亮备份树的路径。当你访问一个节点时，你将它的`left-child`指针指向它的父节点，它的`right-child`指针指向你最后一次右转路径（此时可以在父节点的`right-child`指针中找到），并将其真正的子节点存储在现在冗余的父级`right-child`指针或在您的遍历状态中。下一个访问儿童的`left-child`指针。您需要保留一些指向当前节点及其附近的指针，但不要保留“非本地”。当你回到树上时，你扭转了这个过程。

我希望我能以某种方式说清楚；这只是一个粗略的草图。您必须在某处查找它（我确信这在计算机编程艺术中的某处提到过）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-26T15:32:24.780

**为了保留树并且只使用 O(1) 空间，如果......**

*   每个节点的大小都是固定的。
*   整个树在内存的一个连续部分（即一个数组）
*   您无需遍历树，只需遍历数组

**或者，如果您在处理树时销毁它......：**

*   @Svante 提出了这个想法，但我想用破坏性的方法稍微扩展**一下。**
*   如何？可以继续取一棵树最左边的**叶子**节点(for(;;) node = node->left etc...，然后处理，然后删除。如果树中最左边的节点不是叶子节点，然后处理并删除右节点最左边的叶节点。如果右节点没有子节点，则处理并删除它。

**它不会工作的方式......**

如果您使用递归，您将隐式使用堆栈。对于某些算法（不适用于此问题），尾递归将允许您使用递归并具有 O(1) 空间，但由于任何特定节点可能有多个子节点，因此在递归调用之后还有工作要做，O(1 ) 空间尾递归是不可能的。

您可以尝试一次解决 1 个级别的问题，但是如果没有辅助（隐式或显式）空间，就无法访​​问任意级别的节点。例如，您可以递归查找所需的节点，但这会占用隐式堆栈空间。或者您可以将所有节点存储在每个级别的另一个数据结构中，但这也需要额外的空间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T15:33:50.067

如果节点具有指向其父节点的指针，则可以实现此目的。当您返回树（使用父指针）时，您还传递了您来自的节点。如果您来自的节点是您现在所在节点的左孩子，那么您将遍历右孩子。否则，您会回到它的父级。

编辑以响应问题中的编辑：如果您想遍历整个树，那么不，这是不可能的。为了爬回树上，你需要知道去哪里。但是，如果您只想遍历树下的*单个*路径，那么这可以在 O(1) 额外空间中实现。只需使用 while 循环向下迭代树，保持一个指向当前节点的指针。继续沿着树向下，直到找到所需的节点或找到叶节点。

编辑：这是第一个算法的代码（检查 iterate_constant_space() 函数并与标准 iterate() 函数的结果进行比较）：

```
#include <cstdio>
#include <string>
using namespace std;

/* Implementation of a binary search tree. Nodes are ordered by key, but also
 * store some data.
 */
struct BinarySearchTree {
  int key;      // they key by which nodes are ordered
  string data;  // the data stored in nodes
  BinarySearchTree *parent, *left, *right;   // parent, left and right subtrees

  /* Initialise the root
   */
  BinarySearchTree(int k, string d, BinarySearchTree *p = NULL)
    : key(k), data(d), parent(p), left(NULL), right(NULL) {};
  /* Insert some data
   */
  void insert(int k, string d);
  /* Searches for a node with the given key. Returns the corresponding data
   * if found, otherwise returns None."""
   */
  string search(int k);
  void iterate();
  void iterate_constant_space();
  void visit();
};

void BinarySearchTree::insert(int k, string d) {
  if (k <= key) { // Insert into left subtree
    if (left == NULL)
      // Left subtree doesn't exist yet, create it
      left = new BinarySearchTree(k, d, this);
    else
      // Left subtree exists, insert into it
      left->insert(k, d);
  } else { // Insert into right subtree, similar to above
    if (right == NULL)
      right = new BinarySearchTree(k, d, this);
    else
      right->insert(k, d);
  }
}

string BinarySearchTree::search(int k) {
  if (k == key) // Key is in this node
    return data;
  else if (k < key && left)   // Key would be in left subtree, which exists
    return left->search(k); // Recursive search
  else if (k > key && right)
    return right->search(k);
  return "NULL";
}

void BinarySearchTree::visit() {
  printf("Visiting node %d storing data %s\n", key, data.c_str());
}

void BinarySearchTree::iterate() {
  visit();
  if (left) left->iterate();
  if (right) right->iterate();
}

void BinarySearchTree::iterate_constant_space() {
  BinarySearchTree *current = this, *from = NULL;
  current->visit();
  while (current != this || from == NULL) {
    while (current->left) {
      current = current->left;
      current->visit();
    }
    if (current->right) {
      current = current->right;
      current->visit();
      continue;
    }
    from = current;
    current = current->parent;
    if (from == current->left) {
      current = current->right;
      current->visit();
    } else {
      while (from != current->left && current != this) {
        from = current;
        current = current->parent;
      }
      if (current == this && from == current->left && current->right) {
        current = current->right;
        current->visit();
      }
    }
  }
}

int main() {
  BinarySearchTree tree(5, "five");
  tree.insert(7, "seven");
  tree.insert(9, "nine");
  tree.insert(1, "one");
  tree.insert(2, "two");
  printf("%s\n", tree.search(3).c_str());
  printf("%s\n", tree.search(1).c_str());
  printf("%s\n", tree.search(9).c_str());
  // Duplicate keys produce unexpected results
  tree.insert(7, "second seven");
  printf("%s\n", tree.search(7).c_str());
  printf("Normal iteration:\n");
  tree.iterate();
  printf("Constant space iteration:\n");
  tree.iterate_constant_space();
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-26T16:20:29.313

使用称为线程树的结构，可以在没有（每个节点两个位）额外存储的情况下拥有从节点指向其祖先的指针。在线程树中，空链接由位状态而不是空指针表示。然后，您可以用指向其他节点的指针替换空链接：左链接指向中序遍历中的后继节点，右链接指向前驱节点。这是一个 Unicode-heavy 图（X 表示用于控制树的头节点）：

```
                                         ╭─┬──────────────────────────────────────╮
   ╭──────────────────────────▶┏━━━┯━━━┯━━▼┓│ │
   │ ╭─╂─ │ X │ ─╂╯ │
   │ ▼ ┗━━━┷━━━┷━━━┛ │
   │ ┏━━━┯━━━┯━━━┓ │
   │ ╭────╂─ │ A │ ─╂──╮ │
   │ ▼ ┗━━━┷━━━┷━━━┛ │ │    
   │ ┏━━━┯━━━┯━━┓ ▲ │ ┏━━━┯━━━┯━━━┓ │
   │ ╭─╂─ │ B │ ─╂────┤ ├────────╂─ │ C │ ─╂──────╮ │
   │ ▼ ┗━━━┷━━━┷━━━┛ │ ▼ ┗━━━┷━━━┷━━━┛ ▼ │  
   │┏━━━┯━━┯━━┓ ▲ │ ┏━━━┯━━┯━━━┓ ▲ ┏━━━┯━━┯━━━┓ │
   ╰╂─ │ D │ ─╂─╯ ╰───╂ │ E │ ─╂╮ │ ╭╂─ │ F │ ─╂╮ │
    ┗━━━┷━━┷━━┛ ┗━━━┷━━━┷━━━┛▼ │ ▼┗━━━┷━━━┷━━┛▼ │
                                    ▲ ┏━━━┯━━━┯━━┓ │ ┏━━━┯━━━┯━━━┓ ▲ ┏━━━┯━━━┯━━━┓│
                                    ╰─╂─ │ G │ ╂──┴─╂─ │ H │ ─╂─┴─╂─ │ J │ ─╂╯
                                      ┗━━━┷━━━┷━━━┛ ┗━━━┷━━━┷━━━┛ ┗━━━┷━━━┷━━━┛

```

一旦你有了结构，进行中序遍历就非常非常容易了：

```
Inorder-Successor ( *p* )
     *p 指向一个节点。该例程在
    中序遍历并返回指向该节点的指针*

    *q* ← *p* .right
     If  *p* .rtag = 0 Then 
        While  *q* .ltag = 0 Do 
            *q* ← *q* .left
         End While 
    End If

    返回 *q*

```

更多关于线程树的信息可以在*计算机编程艺术*Ch.2 §3.1 中找到，或者散布在 Internet 上。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-11-03T07:37:15.363

Harry Lewis 和 Larry Denenberg 的“数据结构及其算法”描述了用于二叉树的常量空间遍历的链接反转遍历。为此，您不需要每个节点的父指针。遍历使用树中现有的指针来存储用于回溯的路径。需要 2-3 个额外的节点引用。在每个节点上加上一点，以便在我们向下移动时跟踪遍历方向（向上或向下）。在我对书中这些算法的实现中，分析表明这种遍历的内存/处理器时间要少得多。java中的一个实现是[here](http://harisankar-krishnaswamy.blogspot.in/2013/10/a-coder-post-link-inversion-traversal.html)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-24T21:49:25.760

[http://en.wikipedia.org/wiki/XOR_linked_list](http://en.wikipedia.org/wiki/XOR_linked_list)

将您的父节点编码为叶指针

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-03-11T17:55:52.843

对的，这是可能的。这是我的迭代示例，它具有 O(n) 时间复杂度和 O(1) 空间复杂度。

```
using System;

public class Program
{
    public class TreeNode {
      public int val;
      public TreeNode left;
      public TreeNode right;
      public TreeNode(int val=0, TreeNode left=null, TreeNode right=null) {
          this.val = val;
          this.left = left;
          this.right = right;
      }
    }
    public static void Main()
    {
        TreeNode left = new TreeNode(1);
        TreeNode right = new TreeNode(3);
        TreeNode root = new TreeNode(2, left, right);

        TreeNode previous = null;
        TreeNode current = root;
        TreeNode newCurrent = null;

        while(current != null) {
            if(current.left == null) {
                if(current.right == null) {
                    if(previous == null) {
                        Console.WriteLine(current.val);
                        break;
                    }
                    Console.WriteLine(current.val);
                    current = previous;
                    previous = previous.left;
                    current.left = null;
                } else {
                    newCurrent = current.right;
                    current.right = null;
                    current.left = previous;
                    previous = current;
                    current = newCurrent;
                }
            } else {
                newCurrent = current.left;
                current.left = previous;
                previous = current;
                current = newCurrent;
            }
        }
    }
} 
```

每次看到 时`Console.WriteLine(current.val);`，您都应该将代码用于值处理。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-04-26T15:41:24.073

我认为你不可能做到这一点，因为你应该以某种方式找到你在路径中离开的节点并确定你总是需要 O(height) 空间。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2012-04-24T21:24:00.937

是否可以在 O(1) 辅助空间中迭代二叉树。

```
struct node { node * father, * right, * left; int value; }; 
```

这种结构将使您能够在二叉树的任何方向上移动 1 步。
但仍在迭代中，您需要保持路径！

# iphone - Objective-C 中的自动释放和“分配”属性？（在 iPhone 上）

> ID：791061
> 
> 赞同：1
> 
> 时间：2009-04-26T15:33:22.220
> 
> 标签：iphone, objective-c, memory-management, properties, autorelease

我有一个 UITableView 的实例，以及一个遵循委托和数据源协议的单独类。我这样做是这样的：

```
SubjectTableViewHandler *handler = [[[SubjectTableViewHandler alloc] init] retain];
tv.delegate = handler;
tv.dataSource = handler;
[handler autorelease]; 
```

我不想将处理程序维护为 ivar，如果我`retain`在最后取消调用，当`autorelease`发生这种情况时，它会被发送`release`，然后添加到池中，这会导致 EXC_BAD_ACCESS。所以目前，保留计数是：

```
(1) At init: 1
(2) At retain: 2
(3) delegate/datasource properties are 'assign', still 2
(4) At autorelease: 1, now in autorelease pool. 
```

但是由于属性是“分配”的，它们永远不会被释放，保留计数永远不会达到 0，处理程序也永远不会被释放。有没有比将处理程序维护为 ivar 并在方法中释放它更有效的方法来实现这一点`dealloc`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T15:49:37.767

当您使用 init 初始化对象时，您声明了它的所有权并且没有理由调用保留。您也不想调用 autorelease，因为这会导致对象在运行循环中被释放。

由于您需要保留处理程序（以便您的 tableView 可以调用委托/数据源方法）和方法返回后对处理程序的引用（这样您可以在完成显示 tableView 时释放它），最干净的方法是使其成为 ivar。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T15:48:44.163

正如您所提到的，我能看到的唯一解决方案是使其成为 ivar，并与表并行存储、分配和解除分配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-03T19:02:04.643

这一切都取决于您对表格视图的使用。

常见的做法是创建一个视图控制器，它是表的委托，表可能是控制器的成员。

作为另一种选择，您可以从 UITableView 继承并使其成为自身的委托。

有时最好使用单例委托。

此外，在表委托方法中，第一个参数是 tableview，因此一个委托对象可以服务多个表。

# silverlight - 如何将 Silverlight 库链接到普通类库的文件

> ID：791064
> 
> 赞同：2
> 
> 时间：2009-04-26T15:35:03.947
> 
> 标签：silverlight

我遇到了一个 Silverlight 项目，该项目需要使用普通的 Classlibrary 来执行某些功能。由于您不能直接引用 Classlibrary，因此该项目将 Silverlight 库链接到文件。

想知道如何做到这一点，您可以在下面的屏幕截图中看到我所指的内容。

[替代文字 http://img9.imageshack.us/img9/9840/referenceshortcut.jpg](http://img9.imageshack.us/img9/9840/referenceshortcut.jpg)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-26T15:42:50.870

您需要向您的 silverlight 库“添加现有项目”。不要简单地单击“添加”，而是单击添加按钮侧面的箭头并选择“添加为链接”。这将创建一个从原始文件到您的 silverlight 库的“快捷方式”。

显然，您需要确保您的班级不使用任何不在 silverlight BCL 中的内容。

# php - 如何将 Apache 和 PHP 恢复为 Leopard 默认值？

> ID：791066
> 
> 赞同：0
> 
> 时间：2009-04-26T15:35:58.813
> 
> 标签：php, apache, macos

我使用Apple 网站上的[本指南](http://developer.apple.com/mac/articles/internet/phpeasyway.html)在我的计算机上启用 PHP，但我丢失了所有 Apache 配置文件。我运行了我在 Google 上找到的在 Mac OS X 上恢复 Apache 的脚本：

```
#!/bin/sh
# run with ./apache_refresh.sh
#If permissions error do: chmod u+x filename.sh
#WARNING THIS MAY DELETE OR CHANGE YOUR APACHE SETTING SO BACKUP IF YOU HAVE ANYTHING YOU WANT TO SAVE

echo "*******************************   Starting Apache Server Refresh - Leopard"

#make a temp directory to work with, you can change this if you choose
echo "*******************************   Creating the source folder"
mkdir ~/Desktop/apache-temp
cd ~/Desktop/apache-temp

#get current apache version, update or change if necessary 
echo "*******************************   Downloading Apache Server"
curl -O http://www.gtlib.gatech.edu/pub/apache/httpd/httpd-2.2.11.tar.gz

#if you change the apache version above be sure to change it here as well
echo "*******************************   Extracting Apache Server"
tar xzvf httpd-2.2.11.tar.gz
cd httpd-2.2.11

#you can change the default install paths, "Darwin" is the default leopard install, if you don't know what this means then don't change this!
echo "*******************************   Configuring Darwin Layout"
./configure --enable-layout=Darwin \
--enable-mods-shared=all \
--with-ssl=/usr \
--with-mpm=prefork \
--disable-unique-id \
--enable-ssl \
--enable-dav \
--enable-cache \
--enable-proxy \
--enable-logio \
--enable-deflate \
--with-included-apr \
--enable-cgi \
--enable-cgid \
--enable-suexec

#make the files
echo "*******************************   Compiling Apache Server"
make

#install the files
echo "*******************************   Installing Apache Server"
sudo make install

#backup hosts file
echo "*******************************   Backing up hosts file"
cd /private/etc
sudo cp hosts hosts.backup

#delete hosts file
echo "*******************************   Deleting Hosts File"
sudo rm hosts

echo "*******************************   Creating New Hosts File"
cd ~/Desktop/apache-temp
cat > hosts << EOF
##
# Host Database
#
# localhost is used to configure the loopback interface
# when the system is booting.  Do not change this entry.
##
127.0.0.1   localhost
255.255.255.255 broadcasthost
::1             localhost 
fe80::1%lo0 localhost
EOF

#move new hosts file to /etc dir
echo "*******************************   Moving Hosts Filer"
sudo mv ~/Desktop/apache-temp/hosts /etc

#set hosts file permissions
echo "*******************************   Setting Hosts File Permissions"
cd /private/etc
sudo chown root hosts

#backup httpd.conf file
echo "*******************************   Backing up httpd.conf File"
cd /private/etc/apache2
sudo cp httpd.conf httpd.conf.backup

#delete to httpd.conf file
echo "*******************************   Deleting httpd.conf File"
sudo rm httpd.conf

#copy httpd.conf file from originals folder
echo "*******************************   Copying New httpd.conf File"
cd original
sudo cp httpd.conf /private/etc/apache2/httpd.conf

#backup httpd-vhosts.conf file
echo "*******************************   Backing up httpd-vhosts.conf File"
cd /private/etc/apache2/extra
sudo cp httpd-vhosts.conf httpd-vhosts.conf.backup

#copy httpd-vhosts.conf file from originals extra folder
echo "*******************************   Copying New httpd-vhosts.conf File"
cd /private/etc/apache2/original/extra
sudo cp httpd-vhosts.conf /private/etc/apache2/extra/httpd-vhosts.conf

#remove the temp folder
echo "*******************************   Remove the temp folder"
rm -R ~/Desktop/apache-temp

echo "*******************************   Starting Apache Server"
sudo apachectl start

echo "*******************************   Done" 
```

Apache 已恢复，但 /etc/apache2 中的 httpd.conf 文件看起来不像 Leopard 附带的 httpd.conf。因此，我无法遵循互联网上大多数 Leopard 特定指南。有什么方法可以将 Apache 2 + PHP 恢复为 Leopard 默认值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T15:41:48.253

当我遇到类似情况时，我最终做的是从 OS X 安装磁盘上的 pkg 文件中提取我需要的文件。我相信相关文件存在于一个名为 BSD 的包中，您可以使用[unpkg](http://www.timdoug.com/unpkg/)提取该包。然后，找到您想要的文件并手动将它们复制到安装的位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T22:16:03.407

尝试在 Leopard 磁盘上使用[Pacifist 。](http://www.charlessoft.com/)它擅长重新安装系统的特定位。

# delphi - 如何从类引用创建 Delphi 对象并确保构造函数执行？

> ID：791069
> 
> 赞同：21
> 
> 时间：2009-04-26T15:40:53.123
> 
> 标签：delphi, class, constructor, reference, delphi-2009

如何使用类引用创建对象的实例，并确保执行构造函数？

在此代码示例中，不会调用 TMyClass 的构造函数：

```
type
   TMyClass = class(TObject)
     MyStrings: TStrings;
     constructor Create; virtual;
   end;

constructor TMyClass.Create;
begin
   MyStrings := TStringList.Create;
end;

procedure Test;
var
   Clazz: TClass;
   Instance: TObject;
begin
   Clazz := TMyClass;
   Instance := Clazz.Create;
end; 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-26T16:13:37.973

用这个：

```
type
  TMyClass = class(TObject)
    MyStrings: TStrings;
    constructor Create; virtual;
  end;
  TMyClassClass = class of TMyClass; // <- add this definition

constructor TMyClass.Create;
begin
   MyStrings := TStringList.Create;
end;

procedure Test;
var
  Clazz: TMyClassClass; // <- change TClass to TMyClassClass
  Instance: TObject;
begin
   Clazz := TMyClass; // <- you can use TMyClass or any of its child classes. 
   Instance := Clazz.Create; // <- virtual constructor will be used
end; 
```

或者，您可以使用 TMyClass 的类型转换（而不是“TMyClass 的类”）。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2010-09-18T16:46:25.103

Alexander 的解决方案很好，但在某些情况下还不够。假设您希望设置一个 TClassFactory 类，其中可以在运行时存储 TClass 引用，并在以后检索任意数量的实例。

这样的类工厂永远不会知道它所拥有的类的实际类型，因此无法将它们转换为相应的元类。要在这种情况下调用正确的构造函数，以下方法将起作用。

首先，我们需要一个简单的演示类（不要介意公共字段，它只是用于演示目的）。

```
interface

uses
  RTTI;

type
  THuman = class(TObject)
  public
    Name: string;
    Age: Integer;

    constructor Create(); virtual;
  end;

implementation

constructor THuman.Create();
begin
  Name:= 'John Doe';
  Age:= -1;
end; 
```

现在我们完全通过 RTTI 并使用正确的构造函数调用来实例化 THuman 类型的对象。

```
procedure CreateInstance();
var
  someclass: TClass;
  c: TRttiContext;
  t: TRttiType;
  v: TValue;
  human1, human2, human3: THuman;
begin
  someclass:= THuman;

  // Invoke RTTI
  c:= TRttiContext.Create;
  t:= c.GetType(someclass);

  // Variant 1a - instantiates a THuman object but calls constructor of TObject
  human1:= t.AsInstance.MetaclassType.Create;

  // Variant 1b - same result as 1a
  human2:= THuman(someclass.Create);

  // Variant 2 - works fine
  v:= t.GetMethod('Create').Invoke(t.AsInstance.MetaclassType,[]);
  human3:= THuman(v.AsObject);

  // free RttiContext record (see text below) and the rest
  c.Free;

  human1.Destroy;
  human2.Destroy;
  human3.Destroy;
end; 
```

你会发现对象“human1”和“human2”已经被初始化为零，即Name=''和Age=0，这不是我们想要的。对象 human3 保存了 THuman 的构造函数中提供的默认值。

但是请注意，此方法要求您的类具有不带参数的构造方法。[以上所有内容都不是我构思的，而是在Rob Love 的 Tech Corner](http://robstechcorner.blogspot.com/2009/09/so-what-is-rtti-rtti-is-acronym-for-run.html)中进行了精彩且更详细的解释（例如，c.Free 部分）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-27T06:35:26.983

请检查是否可以选择覆盖 AfterConstruction。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-26T16:12:38.507

您的代码稍作修改：

```
type
  TMyObject = class(TObject)
    MyStrings: TStrings;
    constructor Create; virtual;
  end;
  TMyClass = class of TMyObject;

constructor TMyObject.Create;
begin
  inherited Create;
  MyStrings := TStringList.Create;
end;

procedure Test; 
var
  C: TMyClass;
  Instance: TObject;
begin
   C := TMyObject;
   Instance := C.Create;
end; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-05T21:42:18.760

您可以在基类中创建一个抽象方法，并在构造函数中调用它，并在从类引用创建时在要执行的子类中覆盖。

# gpl - 我可以使用 upx packer 压缩商业程序吗？

> ID：791075
> 
> 赞同：2
> 
> 时间：2009-04-26T15:43:46.080
> 
> 标签：gpl, upx

我可以使用 upx packer 压缩商业程序吗？还是 GPL 限制我这样做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T16:00:13.013

是的你可以。请查看[UPX 许可证](http://upx.sourceforge.net/upx-license.html)。商业应用程序有一个特殊例外，因此它们可以使用 UPX。

Zifre 注意：UPX 是 GPL，但它与使用 GIMP 创建图像不同，因为部分 UPX 代码已添加到商业应用程序（解压缩部分）。这就是为什么需要许可证中的例外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T17:30:49.007

UPX 的问题是加载程序存根被包含到您的程序中。这就是为什么 UPX 许可证中 GPL 有一个例外：

> 压缩可执行文件的特殊例外
> 
> 每个 UPX 压缩程序中嵌入的存根是 UPX 和 UCL 的一部分，并且包含受我们版权保护的代码。GNU 通用公共许可证的条款仍然适用，因为压缩程序是与我们的存根链接的一种特殊形式。
> 
> Markus FXJ Oberhumer 和 Laszlo Molnar 特此授予您自由使用和分发所有 UPX 压缩程序（包括商业程序）的特别许可，但须遵守以下限制：
> 
> 1.  您必须使用完全未经修改的 UPX 版本来压缩您的程序；使用我们的预编译版本，或者（由您选择）使用我们分发的未修改 UPX 源的自编译版本。
> 2.  这也意味着 UPX 存根必须完全未修改，即嵌入在压缩程序中的存根必须与官方未修改 UPX 版本生成的存根在字节上相同。
> 3.  解压器和存根中的任何其他代码必须由未修改的 UPX 存根专门用于在程序启动时解压您的程序。存根的任何部分都不能被您的程序读取、复制、调用或以其他方式使用或访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T15:51:39.853

IANAL，但程序的输出不是衍生作品。你可以压缩任何你想要的东西，包括商业程序。

编辑：另外，这样想，如果你不能这样做，那么你使用 GIMP 创建的任何图像都必须在 GPL 下，例如。GPL 仅在您分发程序或其衍生作品时才重要。

# unit-testing - 使用 JMockit 期望模拟工具包

> ID：791080
> 
> 赞同：2
> 
> 时间：2009-04-26T15:49:21.370
> 
> 标签：unit-testing, jmockit

我正在尝试使用 JMockit 期望来模拟 java.awt.Toolkit.beep()。我的测试用例中有以下代码：

```
new Expectations() {
    Toolkit mock;

    {
        mock.beep();
    }
}.endRecording(); 
```

当我运行测试用例（JUnit 4）时，我在“new Expectations”行得到以下异常：

```
java.lang.ClassFormatError: Code attribute in native or abstract methods in class file $Mock 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T16:37:01.973

默认的 jmock 只能模拟接口。要模拟课程，您需要遵循[这些说明](http://www.jmock.org/mocking-classes.html)

# .net-3.5 - 从 SQL Compact Edition 获取 auto_increment ID

> ID：791092
> 
> 赞同：1
> 
> 时间：2009-04-26T16:06:36.260
> 
> 标签：.net-3.5, sql-server-ce

我在 VS2008 上使用 ASP.NET MVC 和 SQL Compact Edition 对应用程序进行原型设计。我有 2 个实体彼此之间存在多对多关系。当我通过手工制作的 SQL 将对象保存到数据库时，我需要找出它们的 ID，以便我可以将记录放入两个实体之间的映射表中。auto_increment ID 字段实际上是表的唯一唯一标识符。那么在我完成插入之后，如何重新加载记录并获取新分配的 ID？

RE：代码即艺术，我使用的是 .NET 3.5 库中的内置 SqlCeConnection、SqlCeCommand 和 SqlCeDataReader 对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-29T02:13:56.007

在对数据库的后续调用中使用“SELECT @@IDENTITY”。

Compact 是单用户访问，您无需担心事务等以防止其他插入。

# c++ - 那里有围绕 Win32 的无锁 SList 的像样的 C++ 包装器吗？

> ID：791097
> 
> 赞同：3
> 
> 时间：2009-04-26T16:11:21.927
> 
> 标签：c++, windows, linked-list, lock-free

Windows 提供了一个无锁的单链表，如本页所述： [Win32 SList](http://msdn.microsoft.com/en-us/library/ms684121(VS.85).aspx)

我想知道是否存在围绕此功能的良好 C++ 包装器。当我说好时，我的意思是它尽可能地导出通常的 STL 接口，支持迭代器等。我宁愿使用别人的实现也不愿坐下来编写一个 STL 类型的容器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-12T17:30:33.423

您将永远无法在 SList 之上分层 STL 样式界面。为了避免内存管理问题，列表中唯一可访问的节点是列表的头部。访问该节点的唯一方法是将其从列表中弹出。这可以防止两个线程拥有相同的节点，然后一个线程删除该节点，而另一个线程仍在使用它。这就是我所说的“内存管理问题”，也是无锁编程中的常见问题。您总是可以弹出第一个节点，然后跟随 SLIST_ENTRY 结构中的“下一个”指针，但这是一个非常糟糕的主意，除非您可以保证列表不会缩小，并且在您阅读它时节点被释放。当然，这仍然会从列表中删除头节点。

基本上你试图错误地使用 SList 。对于听起来你想做的事情，你只需要使用一个 STL 容器并使用锁来保护对它的访问。STL 算法不适用于 SList 等可变的无锁数据结构。

话虽如此，您可以围绕 SList 创建一个 C++ 包装器，但它与 STL 不兼容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T17:42:44.907

值得注意的是，问题中引用的页面上的已发布接口实际上并未实现链接列表（尽管这可能是底层结构）-它实现了堆栈。因此，如果您想要 std::list 等类提供的链表功能，这可能不适合您。

还要注意堆栈不能支持迭代器（它们基本上只支持推送和弹出），所以很多关于支持迭代器和算法的讨论都是一厢情愿的想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T00:29:35.747

您可以使用 boost 和 ::boost::iterator_facade 快速启动并运行。

不，它不是最优的或可移植的，迭代器语义是你应该听到 Alexandrescou 在 DevCon 突然反对的东西。您没有锁定容器，而是锁定（并可能重新锁定和解锁）操作。而锁定操作意味着串行执行，非常简单。有大量迭代器操作将对正在创建的抽象造成不必要的惩罚。

从火星的角度来看，迭代器隐藏了指针，并隐藏在一个半 OO 概念下，这与 OO-vs-Distributed 开发的几率一样。我肯定会使用“程序”界面并让用户/维护者付费注意为什么它是必要的。无锁操作仅与围绕它的“所有并行代码”一样好。自 96 年以来，随着人们不断给予 scoped_lock 包装重新发明的经典示例，它产生了漂亮的串行代码。

或者使用 atomic 和 Sutter 的 DDJ 条目作为穷人前进道路的参考（以及后来 10 多年的 Pentium Pro 无序性）。

（真正发生的事情是 boost 和 DDJ 在 .net 和 MS CCR 列车之后运行，该列车在不变性之后运行，以及英特尔列车在无锁开发的良好 OO 类似抽象之后运行。问题是它不能做得很好，有些人一次又一次地与之抗争；很像 TBB 的 concurrent_vector 胡说八道。同样的原因异常从来没有实现为非问题，尤其是跨环境，以及 C++ 未充分利用 CPU 中的向量处理的同样原因编译器等等等等..)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-26T17:09:25.610

我认为一个薄包装应该很容易编写。1-2 页之类的东西，可能都在 .h 文件中。而不是梳理谷歌我已经自己写了。

# python - 如何提供特定于平台的模块实现？

> ID：791098
> 
> 赞同：2
> 
> 时间：2009-04-26T16:11:50.507
> 
> 标签：python

我需要通过提供多种实现来使模块中的一个功能独立于平台，而无需更改任何导入它的文件。以下作品：

`do_it = getattr(__import__(__name__), "do_on_" + sys.platform)`

...但是如果将模块放入包中，则会中断。

另一种方法是 if/elif，在 do_it() 中对其他函数进行硬编码调用。

有更好的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T16:15:23.897

将平台支持代码放在包中的不同文件中。然后将其添加到人们应该从中导入的文件中：

```
if sys.platform.startswith("win"):
    from ._windows_support import *
elif sys.platform.startswith("linux"):
    from ._unix_support import *
else:
    raise ImportError("my module doesn't support this system") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T16:18:59.770

使用`globals()['do_on_' + platform]`而不是`getattr`调用，无论它是否在包内，您的原始想法都应该有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T08:28:37.520

如果您需要创建一个特定于平台的类实例，您应该查看工厂模式： [链接文本](http://en.wikipedia.org/wiki/Factory_method_pattern)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T08:47:17.697

[Dive Into Python](http://diveintopython.net/file_handling/index.html#d0e14344)提供了异常选项。

# emacs - 首选带有 Emacs 文件名完成的某些文件扩展名

> ID：791099
> 
> 赞同：4
> 
> 时间：2009-04-26T16:12:29.693
> 
> 标签：emacs

我有很多目录，里面装满了一堆 TeX 文档。所以，有很多文件具有相同的基本文件名和不同的扩展名。但是，其中只有一个是可编辑的。我想要一种方法来让 Emacs 相信，如果我在一个我有的目录中

```
document.tex
document.log
document.pdf
document.bbl
document.aux
... 
```

我在小缓冲区里做

```
~/Documents/.../doc<TAB> 
```

它填写“document.tex”，因为这是该目录中唯一真正正确可编辑的文档。有人知道这样做的好方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T04:06:37.603

我已经编写了一些应该做你想做的代码。基本思想是设置变量`'completion-ignored-extensions`以匹配您要跳过的扩展名，但前提是存在`.tex`文件。这段代码就是这样做的。

```
(defadvice find-file-read-args (around find-file-read-args-limit-choices activate)
  "set some stuff up for controlling extensions when tab completing"
  (let ((completion-ignored-extensions completion-ignored-extensions)
        (find-file-limit-choices t))
    ad-do-it))

(defadvice minibuffer-complete (around minibuffer-complete-limit-choices nil activate)
  "When in find-file, check for files of extension .tex, and if they're found, ignore .log .pdf .bbl .aux"
  (let ((add-or-remove
     (if (and (boundp 'find-file-limit-choices) find-file-limit-choices
          (save-excursion
        (let ((b (progn (beginning-of-line) (point)))
              (e (progn (end-of-line) (point))))
          (directory-files (file-name-directory (buffer-substring-no-properties b e)) nil "\\.tex$"))))
     'add-to-list
       'remove)))
(mapc (lambda (e) (setq completion-ignored-extensions
            (funcall add-or-remove 'completion-ignored-extensions e)))
      '(".log" ".pdf" ".bbl" ".aux")))
  ad-do-it) 
```

享受。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T16:38:44.060

在您的情况下，最简单的方法可能就是自定义变量“completion-ignored-extensions”。

但是，这意味着 emacs 总是会忽略诸如“.log”和“.pdf”之类的东西，这可能不是您想要的。如果您希望它更具选择性，您可能必须有效地重新实现函数 file-name-completion。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T19:49:48.767

如果您愿意安装一个大型库并阅读一些文档，您可以查看[Icicles](http://www.emacswiki.org/emacs/Icicles)并定义一个满足您需求的[排序函数。](http://www.emacswiki.org/emacs/Icicles_-_Sorting_Candidates)另一种选择是[ido ，其 wiki 页面有一个](http://www.emacswiki.org/emacs/InteractivelyDoThings)[按 mtime 排序](http://www.emacswiki.org/emacs/InteractivelyDoThings#toc8)的示例，应该很容易更改为按文件扩展名的功能排序。

# c# - C#，编写更长的方法还是更短的方法？

> ID：791101
> 
> 赞同：9
> 
> 时间：2009-04-26T16:12:39.677
> 
> 标签：c#, .net, methods

我对此有两种相互矛盾的看法。一些消息来源说应该使用更少的方法来减少方法调用，但其他一些消息来源说编写更短的方法有利于让 JIT 进行优化。

那么，哪一方是正确的呢？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-26T16:15:53.680

在大多数情况下，实际进行方法调用的开销都非常小。除非您能清楚地识别出需要重新审视该问题的问题（您不会），否则您永远不需要担心它。

更重要的是你的代码是简单的、可读的、模块化的、可维护的和可修改的。方法应该做一件事，只做一件事，并将子事情委托给其他例程。这意味着您的方法应该尽可能短，但不能更短。与试图智取编译器或运行时相比，使用更不容易出错和错误的代码，因为它很简单，您将看到更多的性能优势。

说方法应该长的来源是**错误**的，在很多层面上。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-26T16:16:01.057

没有，你应该有相对较短的方法来实现*可读性*。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-26T16:16:29.153

关于函数大小没有一个简单的规则。该指南应该是一个功能应该做“一件事”。这有点模糊，但随着经验变得更容易。小函数通常会带来可读性。偶尔需要大的。

担心方法调用的开销是过早的优化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-26T16:22:31.930

指导您确定大小方法的最佳单一标准是**保持它们的可测试性**。如果您可以（并且确实做到了！-）对每个方法进行彻底的单元测试，那么您的代码可能会非常好；如果你在测试上吝啬，你的代码可能充其量是平庸的。如果一种方法难以彻底测试，那么该方法可能“太大”——尝试做太多事情，因此也更难阅读和维护（以及测试不佳，因此可能是错误）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-26T16:17:30.693

与往常一样，它是关于找到一个良好的平衡。最重要的是**该方法只做一件事**。更长的方法往往会做不止一件事。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-26T17:20:58.157

编写代码时要考虑的最重要的成本是可维护性。您将花费*更多**时间*来维护应用程序和修复错误，而不是修复性能问题。

在这种情况下，与维护一个大而笨重的方法的成本相比，调用一个方法的成本几乎可以肯定是微不足道的。简洁的小方法更容易维护和理解。此外，调用该方法的成本几乎肯定不会对您的应用程序的性能产生重大影响。如果是这样，您只能通过使用探查器来断言。众所周知，开发人员不善于事先识别性能问题。

一般来说，一旦发现性能问题，它们就很容易修复。使方法或更重要的是代码库可维护的成本要高得多。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-26T16:18:35.217

首先，您绝对不应该在方法数量级别上对性能进行微优化。您很可能不会获得任何可衡量的性能优势。只有当你有一些在紧密循环中被调用数百万次的方法时，这可能是一个想法——但在你需要它之​​前不要开始优化它。

您应该坚持使用简短简洁的方法，它只做一件事，使方法的意图清晰。这将为您提供更易于阅读的代码，更易于理解并促进代码重用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-02T09:27:57.527

就个人而言，我不怕长方法，只要编写它们的人写得好（每个子任务由 2 个换行符隔开，前面有一个很好的注释，等等。另外，标识非常重要。）。事实上，很多时候我什至更喜欢它们（例如，在编写使用顺序逻辑以特定顺序执行操作的代码时）。

另外，我真的不明白为什么将一个长方法分成 100 个片段会提高可读性（正如其他人所建议的那样）。只有相反。您最终只会到处乱跳并在内存中保留代码片段，只是为了全面了解代码中发生的事情。再加上可能缺少注释、错误的函数名称、许多相似的函数名称，你就有了完美的混乱配方。此外，您可以在尝试减小方法的大小时走到另一端：创建 MANY 类和 MANY 函数，每个类和函数都可能采用 MANY 参数。我认为这也不会提高可读性（特别是对于一个不知道每个类/方法做什么的项目的初学者）。

而“一个功能应该做'一件事'”的要求是非常主观的。“一件事”可能会增加一个变量，直到为“同一件事”做大量工作。

我的规则只是可重用性：相同的代码不应该在很多地方多次出现。如果是这种情况，您需要一个新功能。其余的只是哲学谈话。在一个“你为什么把你的方法做得这么大”的问题中，我回答说，“如果代码很简单，为什么不呢？”。

（只是我的意见 - 随心所欲地投反对票）

# c++ - 是否值得提前声明库类？

> ID：791108
> 
> 赞同：8
> 
> 时间：2009-04-26T16:15:51.917
> 
> 标签：c++, forward-declaration

我刚刚开始学习 Qt，使用他们的教程。我目前正在学习教程 7，我们在其中创建了一个新的 LCDRange 类。LCDRange（.cpp文件）的实现使用Qt QSlider类，所以在.cpp文件中是

```
#include <QSlider> 
```

但在标题中是一个前向声明：

```
class QSlider; 
```

根据 Qt，

> 这是另一个经典技巧，但使用频率要低得多。因为我们在类的接口中不需要QSlider，只在实现中，我们在头文件中使用类的前向声明，并在.cpp文件中包含QSlider的头文件。
> 
> 这使得大型项目的编译速度更快，因为编译器通常将大部分时间用于解析头文件，而不是实际的源代码。仅此一项技巧通常可以将编译速度提高两倍或更多。

这值得做吗？这似乎是有道理的，但还有一件事需要跟踪——我觉得将所有内容都包含在头文件中会简单得多。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-26T16:50:34.720

绝对地。C/C++ 构建模型是……咳咳……不合时宜（最好说）。对于大型项目，它变成了一个严肃的 PITA。

正如 Neil 正确指出的那样，这**不**应该是你的类设计的默认方法，除非你真的需要，否则不要走自己的路。

**打破循环包含引用**是您必须使用前向声明的原因之一。

```
// a.h
#include "b.h"
struct A { B * a;  }

// b.h
#include "a.h"  // circlular include reference 
struct B { A * a;  }

// Solution: break circular reference by forward delcaration of B or A 
```

**减少重建时间**——想象一下下面的代码

```
// foo.h
#include <qslider>
class Foo
{
   QSlider * someSlider;
} 
```

现在每个直接或间接拉入 Foo.h 的 .cpp 文件也拉入 QSlider.h 及其所有依赖项。那可能是数百个 .cpp 文件！（预编译的头文件有点帮助 - 有时很有帮助 - 但它们将磁盘/CPU压力转变为内存/磁盘压力，因此很快就会达到“下一个”限制）

如果头文件只需要一个引用声明，这种依赖通常可以限制在几个文件中，例如 foo.cpp。

**减少增量构建时间**- 在处理您自己的（而不是稳定的库）头文件时，效果更加明显。想象一下你有

```
// bar.h
#include "foo.h"
class Bar 
{
   Foo * kungFoo;
   // ...
} 
```

现在，如果您的大部分 .cpp 需要拉入 bar.h，它们也会间接拉入 foo.h。因此， foo.h 的每次更改都会触发所有这些 .cpp 文件的构建（甚至可能不需要知道 Foo！）。如果 bar.h 使用 Foo 的前向声明，则对 foo.h 的依赖仅限于 bar.cpp：

```
// bar.h
class Foo;
class Bar 
{
   Foo * kungFoo;
   // ...
}

// bar.cpp
#include "bar.h"
#include "foo.h"
// ... 
```

**它是如此普遍，以至于它是一种模式**——PIMPL[模式](http://www.google.de/search?q=PIMPL+pattern)。它的用途有两个：首先它提供真正的接口/实现隔离，另一个是减少构建依赖关系。在实践中，我会以 50:50 衡量它们的有用性。

**您需要**在标头中引用，不能直接实例化依赖类型。这限制了可以应用前向声明的情况。如果您明确地这样做，通常会为此使用实用程序类（例如[boost::scoped_ptr](http://www.boost.org/doc/libs/1_38_0/libs/smart_ptr/scoped_ptr.htm)）。

**构建时间值得吗？** [绝对](http://xkcd.com/303/)，我会说。在最坏的情况下，构建时间随着项目中文件的数量呈多项式增长。其他技术——比如更快的机器和并行构建——只能提供百分比增益。

构建速度越快，开发人员测试他们所做的事情的频率越高，单元测试运行的频率越高，构建中断的修复速度就越快，开发人员最终拖延的情况就越少。

在实践中，管理构建时间虽然对大型项目（例如，数百个源文件）至关重要，但它仍然对小型项目产生“舒适差异”。此外，事后添加改进通常是一种耐心练习，因为单个修复可能只会缩短 40 分钟构建的几秒钟（或更少）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-26T16:51:27.697

我用它所有的时间。我的规则是，如果它不需要标题，那么我提出一个前向声明（*“如果必须使用标题，如果可以使用前向声明”*）。唯一糟糕的是我需要知道类是如何声明的（结构/类，也许如果它是一个模板我需要它的参数，......）。但在绝大多数情况下，它只是归结为类似的`"class Slider;"`东西。如果某些事情需要更多的麻烦才能被声明，人们总是可以像标准一样声明一个特殊的前向声明头`iosfwd`。

不包含头文件不仅会减少编译时间，还会避免污染命名空间。包括标题在内的文件将感谢您尽可能少地包含，以便他们可以继续使用干净的环境。

这是粗略的计划：

```
/* --- --- --- Y.hpp */
class X;
class Y {
    X *x;
};

/* --- --- --- Y.cpp */
#include <x.hpp>
#include <y.hpp>

... 
```

有一些智能指针专门设计用于处理指向不完整类型的指针。一个非常有名的是[`boost::shared_ptr`](http://www.boost.org/doc/libs/1_38_0/libs/smart_ptr/shared_ptr.htm).

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-26T16:20:41.950

是的，它确实有帮助。如果您担心编译时间，要添加到您的曲目中的另一件事是预编译头文件。

查找[常见问题解答 39.12](http://www.parashift.com/c++-faq-lite/misc-technical-issues.html#faq-39.12)和[39.13](http://www.parashift.com/c++-faq-lite/misc-technical-issues.html#faq-39.13)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-26T16:27:28.627

标准库对标准头文件中的一些 iostream 类执行此操作`<iosfwd>`。但是，它不是一种普遍适用的技术 - 请注意，其他标准库类型没有这样的头文件，并且它不应该（恕我直言）是您设计类层次结构的默认方法。

尽管这似乎是程序员最喜欢的“优化”，但我怀疑像大多数优化一样，他们中很少有人真正为他们的项目的构建计时，无论是否有这样的声明。我在这方面的有限实验表明，在现代编译器中使用预编译头文件使其变得不必要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T17:03:12.457

大型项目的编译时间存在巨大差异，即使是具有精心管理的依赖关系的项目。您最好养成前向声明的习惯，并尽可能避免头文件，因为在许多使用 C++ 的软件商店中，它是必需的。您在标准头文件中看不到它的原因是因为它们大量使用模板，此时向前声明变得困难。对于 MSVC，您可以使用 /P 在实际编译之前查看预处理文件的外观。如果您没有在项目中进行任何前向声明，那么看看需要完成多少额外处理可能会是一次有趣的经历。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-26T16:55:31.710

一般来说，没有。

我曾经尽可能多地转发声明，但不再是。

就 Qt 而言，您可能会注意到有一个`<QtGui>`包含文件将拉入所有 GUI 小部件。此外，还有`<QtCore>`,`<QtWebKit>`等`<QtNetwork>`。每个模块都有一个头文件。Qt 团队似乎也认为这也是首选方法。他们在他们的模块文档中这么说。

确实，编译时间可能会增加。但根据我的经验，它并没有那么多。如果是这样，下一步将是使用预编译的头文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-26T17:45:48.360

当你写...

# 包括“foo.h”

...您因此指示传统的构建系统“任何时候库文件 foo.h 中有任何更改，丢弃此编译单元并重新构建它，即使 foo.h 发生的所有事情都是添加注释，或在 foo.h 包含的某个文件中添加注释；即使发生的所有事情都是一些极其挑剔的同事重新平衡了花括号；即使除了一个压力很大的同事在 foo.h 中检查时没有发生任何事情，但未更改且不经意间更改了它的时间戳。”

为什么要发出这样的命令？库头文件，因为通常它们比应用程序头文件有更多的人类阅读器，因此对对二进制文件没有影响的更改具有特殊的漏洞，例如改进的函数和参数文档或版本号或版权日期的凸点。

C++ 规则允许在编译单元中的任何位置重新打开**命名空间（与****struct**或**class**不同）以支持前向声明。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-04-26T17:02:02.617

前向声明对于打破循环依赖非常有用，有时可以与您自己的代码一起使用，但将它们与库代码一起使用可能会破坏另一个平台或其他版本的库的程序（即使您的如果您不够小心，请编写代码）。恕我直言，不值得。

# c# - 是否可以在 NVelocity 中默认为安静引用？

> ID：791114
> 
> 赞同：0
> 
> 时间：2009-04-26T16:18:30.787
> 
> 标签：c#, .net, templates, nvelocity

我正在使用 NVelocity 构建电子邮件。我不想将每个引用都标记为安静（$!name 而不是 $name），我想默认为安静引用。

可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T06:32:51.823

在 NVelocity 中设置它的唯一方法是设置一些标准属性。查看[支持的 Velocity RuntimeConstants 属性](http://velocity.apache.org/engine/releases/velocity-1.6.2/apidocs/org/apache/velocity/runtime/RuntimeConstants.html)，没有任何这样的属性，所以我想这是不可能的。

# ruby-on-rails - 在我的本机浏览器中查看 Ruby on Rails 脚本

> ID：791118
> 
> 赞同：1
> 
> 时间：2009-04-26T16:19:37.773
> 
> 标签：ruby-on-rails, ruby

我是使用 Ruby 开发的新手，并且大部分时间都在使用 irb 来试验代码。对于较长的脚本，能够在我的本机浏览器中运行它们会很有帮助（类似于我通过 MAMP 运行 php 脚本的方式）。我相信有一种方法可以使用 localhost:3000 来做到这一点，但我无法让它工作。所以我的问题是，在我的本地浏览器中查看 Ruby 脚本的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T16:31:03.720

好吧，在 IRB 中运行一些 Ruby 代码与使用 Rails 框架无关。

按照教程[（例如本教程）](http://wiki.rubyonrails.org/getting-started/first-rails-app-walkthrough)学习 Rails 框架本身，现在您对 Ruby 语言有了一些了解。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T18:06:35.380

我看不出这对您有什么帮助，但是如果您愿意，可以很容易地将您的代码放入一个简单的[Sinatra](http://www.sinatrarb.com/)路由中，并将代码的结果提供给浏览器。然后你就可以……</p>

```
require 'rubygems'
require 'sinatra'
get '/' do
  "Hello World! This is file #{$0} live from Boulder!"
end 
```

当您访问本地计算机上的服务器时，它会打印您在方法中输入的任何内容。

不过，我很想知道您为什么要这样做而不是 IRB。在大多数情况下，这似乎是一种不正当的编码方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T07:20:54.737

[Rack](http://rack.rubyforge.org/)是一个 Ruby 网络服务器接口，你可能想用它来连接你的 ruby​​ 脚本和服务器。

# .net - 谷歌分析 API 和 .Net

> ID：791125
> 
> 赞同：24
> 
> 时间：2009-04-26T16:22:06.050
> 
> 标签：.net, asp.net-mvc, api, google-analytics, analytics

谷歌几天前宣布了[分析数据导出 API ，从而使获取网站的分析数据变得更加容易。](http://googledataapis.blogspot.com/2009/04/google-analytics-data-export-api-has.html)API 与 Java 和 Javascript 客户端一起首次亮相，但没有直接的 .Net 支持（除了直接支持 XML）。不过，该 API 似乎与其他 Google 数据 API 类似，并且有一个[.Net 客户端用于这些](http://code.google.com/p/google-gdata/). 有没有人尝试使用该库中的组件来获取分析数据？

我正在构建一个 ASP.Net MVC 站点，并认为我会使用 Google Analytics 来生成“查看最多”列表之类的东西（因为 Google 可能更擅长清除虚假请求、机器人等） . 如果你对这个想法有任何想法，我也很感激听到他们的声音。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T14:48:45.280

检查 Google 的 .NET 库的[主干](http://code.google.com/p/google-gdata/source/browse/)，他们添加了分析支持。

还可以查看他们的群组帖子：

[http://groups.google.com/group/gdata-dotnet-client-library/browse_thread/thread/2d2eec9103b731c6](http://groups.google.com/group/gdata-dotnet-client-library/browse_thread/thread/2d2eec9103b731c6)

和

[http://groups.google.com/group/gdata-dotnet-client-library/browse_thread/thread/70c6638734823b8d](http://groups.google.com/group/gdata-dotnet-client-library/browse_thread/thread/70c6638734823b8d)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T10:16:39.713

在这里查看我的帖子位置： [http ://www.akamarketing.com/blog/103-introducing-google-analytics-api-with-aspnet-c.html](http://www.akamarketing.com/blog/103-introducing-google-analytics-api-with-aspnet-c.html)

它没有使用您提到的内置库，但运行良好。整个 API 是 XML/HTTP，因此使用起来非常方便。你基本上是向谷歌索要一个网页，然后检查你所需要的响应。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-07-28T09:04:29.700

```
 //For this you will have to add some dll in your .net project i.e.
 using DotNetOpenAuth.OAuth2;
 using Google.Apis.Authentication.OAuth2;
 using Google.Apis.Authentication.OAuth2.DotNetOpenAuth;
 using Google.Apis.Analytics.v3;
 using Google.Apis.Analytics.v3.Data;
 using Google.Apis.Services;

 public ActionResult GetAnalyticsData(string GroupType, string date_from, string date_to)
    {
        try
        {

            AnalyticsService gas = AuthenticateUser();

            // Creating our query
            DataResource.GaResource.GetRequest r = gas.Data.Ga.Get("ga:88028792", date_from, date_to, "ga:visits, ga:pageviews, ga:users, ga:newUsers, ga:sessions");
            //Hour,Day,Week,Month
            if (GroupType == "Hour") { r.Dimensions = "ga:nthHour"; }
            else if (GroupType == "Day") { r.Dimensions = "ga:nthDay"; }
            else if (GroupType == "Week") { r.Dimensions = "ga:nthWeek"; }
            else if (GroupType == "Month") { r.Dimensions = "ga:nthMonth"; }

            //d: Execute and fetch the results of our query
            GaData d = r.Execute();

            List<TotalsForAllResults> tr = new List<TotalsForAllResults>();
            List<CustomeData> cd = new List<CustomeData>();

            foreach (var item in d.Rows)
            {
                CustomeData mydata = new CustomeData();
               // mydata.CreatedDate = item[0].ToString();
                mydata.visits = Convert.ToInt32(item[1]);
                mydata.pageviews = Convert.ToInt32(item[2]);
                mydata.users = Convert.ToInt32(item[3]);
                mydata.newUsers = Convert.ToInt32(item[4]);
                mydata.sessions = Convert.ToInt32(item[5]);

                #region Date Conversion

                DateTime Now = DateTime.Parse(date_from, CultureInfo.InvariantCulture, DateTimeStyles.None);
                DateTime TempDate = new DateTime(Now.Year, Now.Month, Convert.ToInt32(Now.ToString("dd")));

                if (GroupType == "Day")
                {    
                    TempDate = TempDate.AddDays((Convert.ToInt32(item[0])));  
                    mydata.CreatedDate = TempDate.ToLongDateString();
                }
                else if (GroupType == "Hour")
                {
                    TempDate = TempDate.AddHours((Convert.ToInt32(item[0])));
                    mydata.CreatedDate = TempDate.ToString("dddd, MMM dd, yyyy hh:mm tt"); 
                }
                else if (GroupType == "Month")
                {                        
                    TempDate = TempDate.AddMonths((Convert.ToInt32(item[0])));
                    mydata.CreatedDate = TempDate.ToString("MMMM, yyyy");
                }
                else
                {
                    //DateTime NewDate = DateTime.Parse(date_from, CultureInfo.InvariantCulture, DateTimeStyles.None);
                    //NewDate = NewDate.AddDays(((Convert.ToInt32(item[0]) + 1) - 1) * 7);
                    //string NewDate1 = NewDate.ToLongDateString();
                    mydata.CreatedDate = item[0].ToString();
                }

                #endregion

                cd.Add(mydata);
            }

            foreach (var item in d.TotalsForAllResults)
            {
                TotalsForAllResults tfa = new TotalsForAllResults();
                tfa.metrics = item.Key;
                tfa.count = Convert.ToInt32(item.Value);
                tr.Add(tfa);
            }

            // At this point, d should contain the number of visitors you got between dates
            return Json(new { TotalsForAllResults = tr, LineChartData = cd });
        }
        catch (Exception ex)
        {
            return Json(null);
        }

    }

 public AnalyticsService AuthenticateUser()
    {
        // This is the physical path to the key file you downloaded when you created your Service Account
        String key_file = @"E:\be8eab1c9893eac9f9fdac95cd64bcc58c86a158-privatekey.p12";//@"C:\Users\path\XXXXX-privatekey.p12";

        // Is the "Email Address", not the "Client ID" one!!!
        String client_id = "450122396803-jt0vt4do8ui6ah74iv1idh1pt9jsvqa6@developer.gserviceaccount.com"; //"0000000-xxxxx@developer.gserviceaccount.com";

        // Probably the password for all is "notasecret"
        String key_pass = "notasecret";

        String scope_url = "https://www.googleapis.com/auth/" + Google.Apis.Analytics.v3.AnalyticsService.Scopes.Analytics.ToString().ToLower();
        //scope_url = "https://www.googleapis.com/auth/analytics";
        //scope_url = "https://www.googleapis.com/auth/analytics.readonly";

        AuthorizationServerDescription desc = GoogleAuthenticationServer.Description;
        X509Certificate2 key = new X509Certificate2(key_file, key_pass, X509KeyStorageFlags.Exportable);

        AssertionFlowClient client = new AssertionFlowClient(desc, key) { ServiceAccountId = client_id, Scope = scope_url };
        OAuth2Authenticator<AssertionFlowClient> auth = new OAuth2Authenticator<AssertionFlowClient>(client, AssertionFlowClient.GetState);
        //AnalyticsService gas = new AnalyticsService(auth);
        AnalyticsService gas = new AnalyticsService(new BaseClientService.Initializer() { Authenticator = auth });

        return gas;
    }

 using System;
 using System.Collections.Generic;
 using System.Linq;
 using System.Web;

namespace GAExampleMVC.Models
{
public class TotalsForAllResults
{
    public string metrics { get; set; }
    public int count { get; set; }
    public double Percent { get; set; }
    public DateTime Time { get; set; }

}

public class CustomeData
{
    public string CreatedDate { get; set; }
    public int visits { get; set; }
    public int pageviews { get; set; }
    public int users { get; set; }
    public int newUsers { get; set; }
    public int sessions { get; set; }
    public string avgSessionDuration { get; set; }
    public double bounceRate { get; set; }
    public double percentNewSessions { get; set; }
    public double percentNewVisits { get; set; }
    public string Location { get; set; }
    public int uniquePageviews { get; set; }
    public string pagePath { get; set; }

} 
```

}

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-11-23T21:06:41.150

[Google 已经发布了一种新的 API，它在Google Api Explorer](https://code.google.com/apis/explorer)中列出，您可以看到[Google Analytics](https://code.google.com/apis/explorer/#_s=analytics&_v=v3)的条目。还有一个为所有这些 API 提供 .dll的[.Net 客户端。](http://code.google.com/p/google-api-dotnet-client/)这是谷歌，所以它仍处于测试阶段，但我正在开发它，没有任何问题。

# sysadmin - 为什么从二进制文件构建不需要 Root 访问权限？

> ID：791126
> 
> 赞同：1
> 
> 时间：2009-04-26T16:22:10.747
> 
> 标签：sysadmin, binaryfiles

当我在我部门的服务器中时，我无法使用诸如“apt-get install nethack”之类的命令。我必须从二进制文件构建 nethack 才能使其正常工作，至少有人告诉我。我无法理解原因。为什么我需要从二进制文件构建东西？为什么禁止使用诸如“apt-get”之类的命令？为什么我不需要 Root 访问权限来从二进制文件构建？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T16:33:57.643

`apt-get`是为所有用户安装软件包的系统级命令。

如果您下载并编译，您只会创建二进制文件的本地“副本”，而不是系统范围的。如果您尝试使用`make install`此方法完成安装过程很可能会失败，因为您没有足够的权限来安装程序以供所有用户访问（与您无法运行的原因相同`apt-get install`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T16:55:31.260

当你从源代码编译一个程序时，你可以给它'--prefix=~/'。这会导致它相对于您自己的主目录安装（因此二进制程序通常以'~/bin' 结尾，手册页在'~/man' 等）。这不会造成任何问题，因为您已经有权在此处写信。

另一方面，apt-get 将软件包安装在全局文件系统（'/bin/'、'/usr/bin/' 等）中，这可能会影响其他用户，因此非常正确地需要管理访问权限。

如果你想安装一些程序，你可以使用命令

```
apt-get source app-name 
```

即使您不是 root，这*也可以*工作，因为它只会将源代码获取到应用程序名称并将其放在当前目录中，这比必须追踪源代码更容易，并且有更好的机会让它工作，因为您下载了应该在您的系统上运行的版本。

或者，您应该让您的系统管理员安装您需要的程序，因为这是他的工作（如果您需要它们，您团队的其他成员很可能也会这样做）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T16:32:31.313

因为 apt-get 将在系统范围内安装程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T16:32:50.720

apt-get 写入已安装文件的位置（/bin、/usr/bin、...）仅限于 root 访问。我想当您从源代码构建时，您不会执行 bulid 的安装步骤。您将需要为安装设置一个前缀，以便软件包最终出现在您可以编写的地方。 [该线程](http://www.mail-archive.com/debian-mentors@lists.debian.org/msg58471.html)讨论了一些关于为 apt-get 设置前缀的内容，您可能希望将前缀设置为类似

```
~/software/ 
```

然后将生成的 bin 目录添加到您的 PATH。

# javascript - 伪经典与“JavaScript 方式”

> ID：791131
> 
> 赞同：18
> 
> 时间：2009-04-26T16:26:10.003
> 
> 标签：javascript

刚读完 Crockford 的“ **[JavaScript: The Good Parts](http://oreilly.com/catalog/9780596517748/)** ”，我有一个关于他对伪经典与原型方法的立场的问题。其实我对他的立场并不感兴趣；我只是想了解他的论点，以便建立自己的立场。

在书中，Crockford 似乎推断构造函数和“all that jazz”不应该在 JavaScript 中使用，他提到了 'new' 关键字是如何被糟糕地实现的——即可以用 'new' 调用非构造函数关键字，反之亦然（可能导致问题）。

我以为我明白他来自哪里，但我想我不明白。

当我需要创建一个新模块时，我通常会这样开始：

```
function MyModule(something) {
    this.something = something || {};
} 
```

然后我会在它的原型中添加一些方法：

```
MyModule.prototype = {
    setSomething : function(){},
    getSomething : function(){},
    doSomething : function(){}
} 
```

我喜欢这个模型；这意味着我可以在需要时创建一个新实例，并且它有自己的属性和方法：

```
var foo = new MyModule({option1: 'bar'});
// Foo is an object; I can do anything to it; all methods of the "class"
// are available to this instance. 
```

**我的问题是**：如何使用更适合 JavaScript 的方法实现上述目标？换句话说，如果“JavaScript”是一个人，她会建议什么？

另外：当 Crockford 说一种特定的设计模式比另一种“更具表现力”时，他是什么意思？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-26T17:08:11.180

### 请参阅：[JavaScript 的“新”关键字是否被认为是有害的？](https://stackoverflow.com/questions/383402/is-javascript-s-new-keyword-considered-harmful)

重要的是要记住，像许多其他 JavaScript 程序员一样，Crockford 最初接触该语言时着眼于“修复”它——使其更像其他（所谓的“经典”）OO 语言。所以编写了大量的结构化代码，构建了库和框架，然后......然后他们开始意识到这并不是真的必要；如果你按照自己的方式处理 JS，你可以相处得很好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-26T17:11:00.270

在我的理解中，您所拥有的示例的原型变体如下所示：

```
Object.beget = function (o) { /* Crockfords replacement for the new */ }

var myModule = {
    something : null,
    getSomething : function () {},
    setSomething : function () {},
    doSomething : function () {}
}; 
```

然后你可以这样做：

```
var foo = Object.beget(myModule);
foo.something = bar; 
```

**更新：**您还可以使用构建器模式来替换这样的构造函数：

```
var myModuleBuilder = {
    buildMyModule : function (something) {
        var m = Object.beget(myModule);
        m.something = something || {};
        return m;
    }
} 
```

那么你可以这样做：

```
var foo = myModuleBuilder.buildMyModule(something); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T16:34:01.170

您的实现是有问题的，因为您正在替换整个原型对象，丢失了继承的函数原型的属性，并且如果您编写其他类，它也会破坏，或者至少使其更加困难，以后使用继承的能力一样的方法。

更适合 Javascript 的方法是：

```
var MyClass = function (storeThis) {
 this.storage = storeThis
}

MyClass.prototype.getStorage = function (){
   return this.storage;
}

MyClass.prototype.setStorage = function (newStorage){
  this.storage = newStorage;
} 
```

用它：

```
var myInstance = new MyClass("sup");
alert("myInstance storage: " + myInstance.getStorage());
myInstance.setStroage("something else"); 
```

至于 'new' 关键字和 Crawford 的问题，我无法真正回答，因为我没有读过这本书，但我可以看到如何通过使用 new 关键字调用任何函数来创建新对象，包括应该是类的方法的函数。

当有人说某事（例如设计模式）更具“表现力”时，他或她通常意味着该设计模式清晰易懂，易于理解它正在实现什么以及如何实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-03T05:17:49.267

Javascript 不是一个人，所以她不能真正建议你做什么。

上面的答案都没有提到简单的继承功能样式，我倾向于发现它是最简单的。

```
function myModuleMaker(someProperty){
  var module = {}; //define your new instance manually

  module.property = someProperty; //set your properties

  module.methodOne = function(someExternalArgument){
    //do stuff to module.property, which you can, since you have closure scope access
  return module;
  }
} 
```

现在创建一个新实例：

```
var newModule = myModuleMaker(someProperty); 
```

您仍然可以通过这种方式获得伪经典的所有好处，但是您会遇到一个缺点，即您每次实例化时都在制作所有实例方法的新副本。这可能仅在您开始拥有数百个（甚至数千个）实例时才有意义，这是大多数人很少遇到的问题。如果您要创建真正庞大的数据结构或使用许多实例进行硬核动画，那么使用伪经典会更好。

我认为很难说这两种方法本身都是“不好的做法”。

# binary - oauth 指南中的“8 位数组”是什么意思？

> ID：791138
> 
> 赞同：0
> 
> 时间：2009-04-26T16:30:13.300
> 
> 标签：binary, oauth

[oauth 的初学者指南](http://www.hueniverse.com/hueniverse/2008/10/beginners-gui-1.html)说：

> 二进制数据不直接由 OAuth 规范处理，而是假定存储在非 UTF-8 编码的 8 位数组中。

我不明白这是什么意思？如何将二进制存储在 8 位数组中？[关于位数组](http://en.wikipedia.org/wiki/Bit_array)的维基百科文章对我没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T16:38:18.913

*8 位数组*很可能意味着具有字节大小元素的数组或字节数组。其中一个字节由 8 位或一个八位字节组成。数组包含的数据区域然后被称为是字节可寻址的。

# .net - 与 Microsoft .NET 的图形兼容性

> ID：791148
> 
> 赞同：1
> 
> 时间：2009-04-26T16:35:32.023
> 
> 标签：.net, windows-services, graphic

我使用 Microsoft .NET 创建了一个小型应用程序。MS .NET 版本没有问题，问题在于 2.0 版本本身。

这是一个图形问题。该应用程序不会在两个不同的 Windows XP 上显示相同的用户界面。一种是经典风格，另一种是XP风格。这在 Vista 下也显示不一样。

区别不大（我的意思是文本框不会变成按钮！）但是设计完全丢失了（颜色改变和控件的位置。）这意味着我的应用程序在其他计算机上看起来很糟糕，这是不好，因为我花了很多时间设计它，尽管它可以毫无问题地使用。它看起来很糟糕

我怎么解决这个问题？为未来的应用设计？WPF 是一个解决方案还是更糟？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T18:47:38.837

你有几个选择：

1.  关闭视觉样式并在所有操作系统上看起来像**经典 UI 。**
2.  **不要使用系统颜色**并将所有颜色硬固定为实数。
3.  使用第 3方可**换肤 UI 框架**，例如 Developer Express [http://devexpress.com/Products/NET/Controls/WinForms/Skins/](http://devexpress.com/Products/NET/Controls/WinForms/Skins/) [（来源：][[devexpress.com](https://devexpress.com/Products/NET/Controls/WinForms/Skins/i/skins/Office2007Black.png)][）][![黑色的](https://i.stack.imgur.com/eoCdY.png)](https://i.stack.imgur.com/eoCdY.png)

4.  转到 WPF - 它在所有支持它的操作系统**上**看起来都一样（抗锯齿可能不同）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T16:40:58.017

你试过使用[`Application.EnableVisualStyles`](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.enablevisualstyles.aspx)吗？您是否隔离了两台不同 XP 计算机之间的差异？我并不完全清楚你的应用程序在这两种情况下是什么样子的——如果你可以在你的问题中添加一个屏幕截图，那将会有很大帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T06:07:58.263

您应该问自己的一个问题是您是否真的想忽略用户所做的 UI 设置。如果他们选择了 XP 风格，那么你真的应该忽略它并给他们展示其他风格吗？

# python - 灵药反射

> ID：791150
> 
> 赞同：3
> 
> 时间：2009-04-26T16:36:33.240
> 
> 标签：python, sqlalchemy, pylons, python-elixir

我定义了一些工作正常的实体；对于元编程问题。我现在需要反映模型中定义的字段属性。

例如：

```
class Foo(Entity):
      bar = OneToMany('Bar')
      baz = ManyToMany('Baz') 
```

设置了哪种类型的关系：“ManyToMany”、“OneToMany”甚至是普通的“Field”，以及关系目标？

有什么简单的方法可以反映 Elixir 实体吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T18:01:52.847

您可以像在 Python 中的任何地方一样在 Elixir 中进行自省——获取 with 的所有属性名称，提取给定名称的属性`class Foo`with ，使用or检查属性的类型，等等。作为属性传递给的字符串任何子类（包括and ）的构造函数最终作为关系子类的结果实例 r 的属性。`dir(Foo)``getattr(Foo, thename)``type(theattr)``isinstance``'Bar'``Relationship``OneToMany``ManyToMany``r.of_kind`

Python 标准库中的模块`inspect`可能是一种更友好的自省方式，但 dir / getattr / isinstance &c 在许多情况下是完全可以接受的。

# rm - 无法删除终端中的特殊命名文件

> ID：791155
> 
> 赞同：1
> 
> 时间：2009-04-26T16:39:35.260
> 
> 标签：rm

某些程序使 ta 我的根目录虚拟文件，例如

```
-1
-2
-3
...
-n 
```

我跑不成功

```
rm -1 
```

还有

```
rm "-1" 
```

终端认为 -1 是选项。

**如何删除**终端中的文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-26T16:41:54.507

您可以使用`rm ./-1`./ 表示当前目录，并且由于参数不以破折号开头，因此不会将其解释为选项。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-26T16:45:54.527

据我记得添加 -- 作为命令行上的一个选项将导致 rm 命令从字面上考虑所有剩余的参数，所以命令

```
rm -- -1 
```

将删除有趣的命名文件。请注意，您仍然可以使用 shellextensions（例如 '*' 或 '?'），因为 shell在命令运行*之前*会扩展它们（与 DOS 不同）。

*编辑*：当我第一次遇到这个问题时，我不知道 -- 开关所以我写了一个小的 c 程序，它将删除与第一个参数相同的文件名。这很容易做到，因为*所有*posix 操作系统都包含`unlink`系统调用，该系统调用会删除具有作为参数给出的名称的文件（将以下内容转储到终端中）：

```
remove_arg.c << EOF
#include<unistd.h>
int main(int argc, char **argv){
  unlink(argv[1]);
}
EOF
gcc -o remove_arg remove_arg.c
./remove_arg -1 
```

这应该适用于任何 unix 系统，尽管您可能必须更改`gcc`为`cc`本地 c 编译器的名称或名称。

# c# - C# 3.0 - 如何将文件从 MemoryStream 保存到数据库？

> ID：791161
> 
> 赞同：2
> 
> 时间：2009-04-26T16:41:17.267
> 
> 标签：c#, c#-3.0, memorystream

我正在尝试将 PDF 文件保存到 SQL Server，并且我已经有一种生成 PDF 的方法，但会打开一个显示该文件的窗口。

但是，现在我必须生成一个 PDF，但必须将它保存到图像字段中的数据库中。

我必须从准备保存、显示等的 MemoryStream 对象中保存这个文件。

我有这个：

```
MemoryStream m = PDFHelper.gereratePDF(text, title); 
```

我在谷歌上搜索，我想我必须将此 MemoryStream 转换为 FileStream 以便我可以将其保存到 DB，但我不知道如何。

谢谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T16:47:48.407

为什么需要先将其保存到文件才能将其保存到数据库中？

如果你这样做，最好的方法可能是使用[`MemoryStream.WriteTo`](http://msdn.microsoft.com/en-us/library/system.io.memorystream.writeto.aspx)，传入`FileStream`. 但是，如果您只需要将数据作为字节数组写入数据库，则可以使用该[`ToArray`](http://msdn.microsoft.com/en-us/library/system.io.memorystream.toarray.aspx)方法。

（将数据写入数据库的确切方式将取决于您通常如何访问数据库。如果您告诉我们更多相关信息，我们可能会提供更具体的建议。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T17:04:01.287

这是一个示例方法。使用 memorystream.ToArray() 将文档作为字节数组传递。

```
public static Boolean SaveDocument(Guid candidateId, String fileName, String contentType, Byte[] data) {
    Boolean bResult = false;

    Database db = DatabaseFactory.CreateDatabase(Databases.Hphr.ToString());
    using (DbCommand dbCommand = db.GetStoredProcCommand("CandidateDocumentSave")) {
        db.AddInParameter(dbCommand, "CandidateId", DbType.Guid, candidateId);
        db.AddInParameter(dbCommand, "FileName", DbType.String, fileName);
        db.AddInParameter(dbCommand, "ContentType", DbType.String, contentType);
        db.AddInParameter(dbCommand, "FileType", DbType.String, Path.GetExtension(fileName).Substring(1));
        db.AddInParameter(dbCommand, "Data", DbType.Binary, data);
        db.ExecuteNonQuery(dbCommand);
        bResult = true;
    } // using dbCommand
    return bResult;
} // method::SaveDocument 
```

# wpf - 您可以在 ListBox.SelectedItems 上使用 ValidationRules 吗？

> ID：791172
> 
> 赞同：1
> 
> 时间：2009-04-26T16:48:20.823
> 
> 标签：wpf, validation, validationrules

我想用来`ValidationRules`验证一些`ListBox`控件是否至少选择了一项。

我试过这样做：

```
<ListBox ItemsSource="{Binding Path=AvailableItems}"
         Behaviors:MultiSelectorBehaviours.SynchronizedSelectedItems="{Binding ChosenItems}"
         x:Name="ListBoxItems">  
    <ListBox.Tag>
        <Binding ElementName="ListBoxItems" Path="SelectedItem">
            <Binding.ValidationRules>
                <ValidationRules:NotNullValidationRule />
            </Binding.ValidationRules>
        </Binding>
    </ListBox.Tag>
</ListBox> 
```

但我`NotNullValidationRule`从来没有被叫过。请注意，这`SynchronizedSelectedItems`是一个特殊的附加属性，我用来将 同步`SelectedItems`到自定义集合（[在此处描述](https://stackoverflow.com/questions/782980/whats-the-simplest-way-to-bind-a-list-of-checkboxes-to-a-list-of-checked-values/786764#786764)）。这就是为什么我对应用的“假”`Binding`进行验证的原因`Tag`。

有没有办法验证`ListBox.SelectedItems`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T17:11:18.163

验证仅在 TwoWay 和 OneWayToSource 模式绑定中完成。如果您转动 Binding，将 SelectedItem 绑定到 TwoWay 或 OneWayToSource 模式下的标记，则会触发验证。

验证是为了保护目标属性。因此，当您设置 Tag 时，验证会确保 Tag 有效并且可以使用新值设置 SelectedItem。以下代码有效（SelectedItem 自动绑定 TwoWay IIRC。）

```
<ListBox x:Name="list">
    <ListBox.SelectedItem>
        <Binding ElementName="list" Path="Tag">
            <Binding.ValidationRules>
                <local:SelectedValidationRule />
            </Binding.ValidationRules>
        </Binding>
    </ListBox.SelectedItem> 
</ListBox> 
```

# java - 从 Eclipse 插件编辑 web.xml 的 API？

> ID：791174
> 
> 赞同：1
> 
> 时间：2009-04-26T16:50:16.140
> 
> 标签：java, eclipse, eclipse-plugin, web.xml

从 Eclipse 插件编辑 web.xml 的最简单方法是什么？（我正在寻找一个 API——而不是使用 PrintWriter 等）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T23:14:48.000

我发现最简单的方法是获取 WebApp 对象。例如，要向 web.xml 添加一个 servlet：

```
import org.eclipse.jst.j2ee.model.ModelProviderManager;
import org.eclipse.jst.javaee.web.WebApp;

WebApp webApp = (WebApp) ModelProviderManager.getModelProvider(project).getModelObject();
Servlet servlet = WebFactory.eINSTANCE.createServlet();
servlet.setServletName("myServlet"); //$NON-NLS-1$
servlet.setServletClass("org.my.class.path"); //$NON-NLS-1$
webApp.getServlets().add(servlet); 
```

可以类似地添加其他标签，例如 servlet-mappings 和过滤器。

# iphone - 使用 NSURLConnection 异步没有返回数据

> ID：791177
> 
> 赞同：7
> 
> 时间：2009-04-26T16:50:43.330
> 
> 标签：iphone, objective-c, cocoa-touch, asynchronous, nsurlconnection

我在一些看起来相当
简单但我似乎无法开始工作的事情上度过了一段时光。我正在构建一个
从网络主机检索数据的 iPhone 应用程序。我正在尝试
与主机建立异步连接，因为我想
在连接期间保持设备空闲。（sendSynchronousRequest 冻结
电话，直到请求完成。）这是我的连接代码：

```
//temp url to see if data is returned:
NSURL *theURL = [NSURL URLWithString:@"http://www.theappleblog.com/feed"];

NSURLRequest *dataRequest = [NSURLRequest requestWithURL:theURL
             cachePolicy:NSURLRequestReloadIgnoringLocalCacheData
             timeoutInterval:60];

/* establish the connection */  
theConnection = [[NSURLConnection alloc]
                 initWithRequest:dataRequest
                        delegate:self
                startImmediately:YES];

if (theConnection == nil) { 
    NSLog(@"Connection Failure!");
    self.urlData = nil; 
} else {
    self.urlData = [[NSMutableData data] retain];   
} 
```

我已经设置了所有适当的委托方法：

```
-(void)connection:(NSURLConnection *)connection
       didReceiveResponse:(NSURLResponse*)response
{
    [urlData setLength:0];
    UIApplication *application = [UIApplication sharedApplication];
    application.networkActivityIndicatorVisible = YES;
    NSLog(@"Received Response!");
} 
```

 ````
-(void)connection:(NSURLConnection *)connection
       didReceiveData:(NSData*)incrementalData
{
    [self.urlData appendData:incrementalData];

    NSNumber *resourceLength = [NSNumber
              numberWithUnsignedInteger:[self.urlData length]];
    NSLog(@"resourceData length: %d", [resourceLength intValue]);
    NSLog(@"filesize: %d", self.urlDataSize);
    NSLog(@"float filesize: %f", [self.urlDataSize floatValue]);
} 
```

 ````
-(void)connectionDidFinishLoading:(NSURLConnection*)connection
{
    NSLog(@"Connection finished loading\n");
    NSLog(@"Succeeded! Received %d bytes of data",[urlData length]);
    _isFinished = YES;
    UIApplication *application = [UIApplication sharedApplication];
    application.networkActivityIndicatorVisible = NO;
} 
```

 ````
- (void)connection:(NSURLConnection *)connection
        didFailWithError:(NSError *)error
{
    NSLog(@"Error: %@",[error localizedDescription]);
} 
```

As you can see, I've got a boat-load of log messages because I wanted
to see if *anything* was coming through at all. My connection test
comes back as TRUE but no data ever gets loaded. Like I said, I'm sure
I must be doing (or not doing) something *really* stupid. But what?
Any help would be most appreciated.

Thanks, Lawrence

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T22:28:16.257

The problem was that I was continuing program flow and not stopping to allow the connection to finish downloading. Thank you for all of the suggestions.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T06:18:19.640

A few suggestions:

*   In your first snippet, instead of `theConnection` try assigning to `self.theConnection` to make sure the property accessor methods are called. In various places you also interchange `self.urlData` and `urlData`. Might want to make them all consistent by going through `self`.

*   You may want to make the `dataRequest` a property as well and go through `self` to make sure it gets retained.

*   `self.urlData = [[NSMutableData data] retain];` -- you shouldn't need that extra retain. Going through `self` does it for you. The extra retain will make it so the object will stick around and leak even when all is done.

*   On a related note, in your NSLogs make sure you print out the retain count for each object. Also, you may want to have a general clean-up routine around to release these structures (or sets `self.foo = nil`) so at any point if it barfs out you can call the routine to get things cleaned up.

*   Get a copy of Charles or WireShark (or run tcpdump in the console) and watch the network traffic. It'll help pinpoint at what stage in the flow it's failing.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T20:23:06.050

Initial thought - is the object that has all this code being retained properly? It could be it's being released, and thus deallocating the connection...

Otherwise you should at least see the response.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T21:33:05.833

Nothing obviously wrong up there. I have code that's substantially the same and works fine. The only differences I see are:

*   I use NSURLRequestUseProtocolCachePolicy instead of NSURLRequestReloadIgnoringLocalCacheData

*   I use connection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self]; instead of specifying startImmediately: YES (since it's the default)

It would be helpful to know which, if any, of your delegate methods are getting called. At the very least, you ought to get at least one or the other of connectionDidFinishLoading or connectionDidFail being called. If not, then something's probably wrong with your delegate setup - are you ABSOLUTELY sure that the delegate method signatures are correct, and that you're passing in the right item as the delegate?

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-26T21:58:35.617

It's hard to zero in on anything since it's not clear from your question which, if any of the NSLog statements executes. Please be a little more clear about the results you're getting.

From a quick look the only thing that looks like a potential problem is that you have a race condition when you set up the connection. If the network is especially fast there's a slim but nonzero chance that -connection: didReceiveData: will be called before self.urlData has been allocated. I'd suggest allocating urlData either before initiating the connection or in -connection:didReceiveResponse: to prevent this.

If that doesn't fix it, more information from you is needed.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T00:04:40.400

This doesn't answer your question directly, but you might consider looking into Ben Copsey's [`ASIHTTPRequest`](http://allseeing-i.com/ASIHTTPRequest-CFNetwork-wrapper-for-HTTP-requests) library, which wraps around `CFNetwork` classes and includes asynchronous, threaded request code that takes a lot of work out of doing this properly.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T09:04:07.360

You say this code works fine using the asynchronous method? Testing that URL, it redirects to another, so what if you implement the redirection delegate methods? What if you try some different URLs?

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T00:27:03.043

Is the app otherwise responsive? Is the runloop running? What does the app do after starting the request -- does it return from its event handler back to the runloop? (If not, you'll never get any of your callbacks, because they're delivered via the runloop.)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-13T02:38:17.530

NSURLConnection is designed to work with any type of protocol, not just HTTP. This means that connection:didFail:withError is called for *connection* errors, but not for *protocol* errors. You're not checking for protocol errors -- you have to catch them in connection:didReceiveResponse:. The trick is that the response object that is passed in is actually a NSHTTPURLResponse object. If you check the response's statusCode, I'll bet you're getting an HTTP error such as 404 or server 500.

# delphi - 在 Delphi 中使用“with”创建的引用对象实例

> ID：791181
> 
> 赞同：8
> 
> 时间：2009-04-26T16:53:14.587
> 
> 标签：delphi, with-statement

有没有办法引用使用“with”语句创建的对象实例？

例子：

```
with TAnObject.Create do
begin
  DoSomething(instance);
end; 
```

DoSomething 将使用实例引用，就好像您将实例从声明的变量引用传递给创建的对象一样。

例子：

```
AnObject := TAnObject.Create; 
```

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-26T18:08:35.733

好吧，你可以使用这样的方法：

```
// implement:

type
  TSimpleMethod = procedure of object;

function GetThis(const pr: TSimpleMethod): TObject;
begin
  Result := TMethod(pr).Data;
end;

// usage:

  with TStringList.Create do
  try
    CommaText := '1,2,3,4,5,6,7,8,9,0';
    ShowText(TStringList(GetThis(Free)));
  finally
    Free;
  end; 
```

或类助手：

```
type 
  TObjectHelper = class helper For TObject
  private
    function GetThis: TObject; Inline;
  public
    property This: TObject read GetThis;
  end;

...

function TObjectHelper.GetThis: TObject;
begin
  Result := Self;
end; 
```

但是，实际上，以前的回答是正确的：您最好忘记“with”语句。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-26T17:21:00.590

您永远不应该使用`with`其中任何一个，因为未来的更改可能会比您预期的更多地引入该范围。

以此为例：

```
procedure Test;
var
    x: Integer;
begin
    with TSomeObject.Create do
    begin
        DoSomethingWithX(x);
        Free;
    end;
end; 
```

然后在 TSomeObject 类上添加一个 X 属性。现在，您认为它将使用哪个 X？局部变量还是对象的 X 属性？

最好的解决方案总是只创建一个具有短名称的局部变量，并将对象别名为该变量。

```
procedure Test;
var
    x: Integer;
    o: TSomeObject;
begin
    o := TSomeObject.Create;
    o.DoSomethingWithX(x);
    o.Free;
end; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-27T11:40:17.297

您自己给出了答案：声明局部变量。如果你愿意，你可以使用**with**关键字。

```
var
  MyInstance: TMyObject;
begin
  MyInstance := TMyObject.Create;
  with MyInstance do
  try
    Foo;
    Bar;
    DoSomething(MyInstance);
  finally
    Free;
  end;
end; 
```

在上面的示例中，使用**with**的唯一原因是代码可读性，这是非常主观的，您也可以放弃**with**关键字并直接使用 MyInstance。这只是个人品味的问题。我不同意“从不使用”的答案，但你应该知道它的缺点。

另请参阅此问题：[delphi "with" 关键字是一种不好的做法吗？](https://stackoverflow.com/questions/514482/is-delphi-with-keyword-a-bad-practice)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T21:47:19.303

Brian 的 Notify 处理程序示例的补充是使用绝对变量（仅限 win32）：

```
procedure Notify( Sender : TObject ); 
var 
  Something : TSomeThing absolute Sender;
begin 
  if Sender is TSomething then 
  begin
    VerySimpleProperty := Something.Something;
    OtherProperty := Something.SomethingElse;
  end;
end; 
```

它基本上避免了必须分配局部变量或进行大量类型转换。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T09:06:13.017

我已经学会了艰难的方式 - 仅在以下情况下使用“With”：

```
With TMyForm.Create( Owner ) do
  try
    ShowModal
  finally
    Free;
  end;

procedure Notify( Sender : TObject );
begin
  With Sender as TSomething do
    VerySimpleProperty := Something      
end; 
```

即尽可能简单地保持 With 的可见性。当您考虑到调试器无法解析“With”这一事实时，使用简单的局部变量或完全声明目标（即 MyRecord.Something）实际上会更好更清晰

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-15T18:40:33.283

现在这是不可能的，但我们可以通过说服编译器创建者来实现：

```
 With TForm1.Create (Nil) Do  // New TForm1 instance
    Try
      LogForm (");  // That same instance as parameter to an outer method (solution)
      "ShowModal;  // Instance.ShowModal
    Finally
      "Free;  // Instance.Free
    End; 
```

我的建议是：

1.  每个 With 标头不超过一个对象/记录。
2.  不允许嵌套 Withs。
3.  使用 " 表示对象/记录（双引号类似于同上标记：[http](http://en.wikipedia.org/wiki/Ditto_mark) ://en.wikipedia.org/wiki/Ditto_mark ）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-17T01:36:03.873

对于 FMX，您应该使用 GetObject 示例：

```
with TLabel.Create(box1) do
begin
    Font.Size := 34;
    Font.Style := [TFontStyle.fsBold];
    TextAlign := TTextAlign.taCenter;
    box1.AddObject(GetObject);
end;; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-05-25T15:39:22.517

有一个很好的技巧可以做到这一点。在项目单元中的某处定义此解决方法功能。

```
// use variable inside 'with ... do'
// WSelf function returns TObject associated with its method.
//   I would recommend to use the method 'Free'
// WSelf(Free) as <TObjectN>
type TObjectMethod = procedure of object;
function WSelf(const MethodPointer: TObjectMethod): TObject;
begin
  Result := TMethod(MethodPointer).Data;
end; 
```

用法示例。

```
var
    SL: TStringList;
begin
    SL := TStringList.Create;
    try
        with TStringList.Create do
        try
            Add('1');
            Add('2');
            Add('3');
            // (WSelf(Free) as TStringList) references to the object
            //   created by TStringList.Create
            SL.Assign(WSelf(Free) as TStringList);
        finally
            Free;
        end;
    finally
        ShowMessage(SL.Text);
        SL.Free;
    end;
end; 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2018-07-03T16:18:39.097

Delphi 中最好的方法是使用变量来处理该实例。

# c# - Java 与 C# 和 .NET 之间的差异

> ID：791186
> 
> 赞同：13
> 
> 时间：2009-04-26T16:56:26.920
> 
> 标签：c#, java, windows, linux, user-interface

提前为可能的火焰线道歉，但这不是我想要的。

我只在 Linux 中使用 C 和 C++ 进行过认真的开发，并且我正在寻求涉足 Windows。我一直在做一些阅读和询问，在我看来，使用 C# 的 .NET 是为 Windows 开发面向商业用户的商业应用程序的方式。

对我来说，一个重要的考虑是将用户界面集成到桌面中，因为这是用户最终与之交互的内容。例如，是否可以在 Java 中重新创建 Office 2007 GUI 的外观，或者这是否只能在 .NET 中实现？

我也担心便携性。将来，我可能希望将应用程序移植到 Linux。我知道单声道项目，但我想知道使用 Java 是否会更好。

简而言之，在开发主要用于 Windows 的商业、面向用户的业务应用程序时，Java 和 C# 之间的权衡是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-26T17:09:27.090

最重要的一点是“主要用于 Windows”。

如果您*只*需要在 Windows 上工作，C# 可能比 Java 更好。有更多种类的视觉样式与 Windows 很好地融合在一起。它还使与本地代码（例如 Win32 API 或 COM 库的位）的互操作比 Java 更容易。我个人更喜欢它作为一种语言，但那是另一回事。

如果您需要在其他平台上运行，我会认真考虑 Java。虽然[Mono](http://mono-project.com)有很大的发展势头，但它与 .NET 的兼容性不如 Java 在它支持的各种平台上的兼容性。

所以基本上，非常仔细地权衡“可能想要移植”方面 - 从我的角度来看，这是决定的驱动因素。一旦你决定做一个移植，如果你的 90% 的客户都在 Windows 上并不重要——剩下的 10% 仍然需要工作，并且工作良好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-26T19:02:47.053

首先，您的 GUI 在 Windows 上是否看起来不错将更多地取决于您的 GUI 设计技能，而不是您选择的语言或工具包。

Windows 窗体并没有真正让您使用记录的 API 完全访问 Windows GUI 功能。您必须调用本机 API 函数或至少使用特定于 Windows 的消息来实现某些效果。另外，我认为没有内置方式可以访问 Office 2007 风格的功能区控件。为此，您需要一个 3rd 方组件。

许多 .Net 应用程序依赖 3rd 方小部件集来实现美观的 GUI。请注意，这些通常依赖于 P/Invoke 或其他特定于 Windows 的功能，因此不适用于单声道。所以如果你真的想要一个跨平台的 GUI，.Net 不是最好的选择。

您也可以在 Windows Presentation Foundation 中执行 .Net GUI，但同样不支持单声道。

GTK# 在 Unix 和 Windows 上运行良好，尽管它在 Windows 上看起来略逊一筹。

Java Swing 是非常跨平台的，并且具有平台原生的外观和感觉，看起来相当不错。您可以下载 Netbeans 以查看它的运行情况。

SWT 是 Java 的替代工具包，其跨平台兼容性略低于 Swing，但仍然很受欢迎。Eclipse 使用这个工具包，因此下载它以查看它的使用情况。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T18:52:55.627

由于您已使用 C++，因此您可以使用 C++ 和 Qt for GUI。这是一个很好的跨平台 GUI 库，您可以重新编译代码以在 Windows、Mac 和 Linux 中以一致的外观工作。

当然，您可以使用它制作漂亮的界面，但可能不如 MS Office 界面（Microsoft blend）那么酷。

您可以将其视为一种选择。 [http://www.qtsoftware.com/products/](http://www.qtsoftware.com/products/)

示例 [http://www.qtsoftware.com/qt-in-use](http://www.qtsoftware.com/qt-in-use)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T18:37:33.387

如果应用程序主要用于 Windows - 使用 .NET。如果您以后认真考虑移植 - 避免使用 P/Invoke、2.0 以上的 .NET 功能和具有丰富 GUI（不在 Mono 上运行）的 3rd 方工具包 现有不错的商业 .NET 跨平台应用程序，包括不错的[http://www.codicesoftware.com/xpfront.aspx](http://www.codicesoftware.com/xpfront.aspx) [塑料单片机 UI http://www.plasticscm.com/screenshots/gui27/visual/brexplorer04.png](http://www.plasticscm.com/screenshots/gui27/visual/brexplorer04.png) 和许多其他 - [http://www.mono-project。 com/Companies_Using_Mono](http://www.mono-project.com/Companies_Using_Mono)

此外，许多开发人员更喜欢 VS IDE 而不是 Eclipse 和 C# 而不是 Java。但如果您的应用程序主要是 Windows - 我敢打赌最好使用 .NET。特别是如果 GUI 集成是主要问题，因为让 Java 应用程序看起来像原生 Windows 仍然很痛苦。在 .NET 下，有很多用于 Ribbon 接口的控件（包括本机接口）。尝试以适当的外观为 Java 找到相同的东西，你就会明白我的意思

使用 Mono（如果您将保留主要规则），大多数时候您不会遇到将 Mono 本身移植和嵌入到应用程序中的问题。

# c# - 使用反射来处理 Linqed 属性

> ID：791187
> 
> 赞同：1
> 
> 时间：2009-04-26T16:56:47.200
> 
> 标签：c#, linq, generics, reflection, or-designer

我正在尝试编写一个通用方法，该方法将加载具有特定 ID 的特定类型的记录。这是一种有效的方法：

```
 public abstract class LinqedTable<T> where T : LinqableTable {
    public static T Get(long ID) {
        DataContext context = LinqUtils.GetDataContext<T>();
        var q = from obj in context.GetTable<T>()
                        where obj.ID == ID
                        select obj;
        return q.Single<T>();
    }
}

public abstract class LinqableTable {
    public abstract long ID { get; set; }
} 
```

您可以忽略对`LinqUtils.GetDataContext<T>()`;的调用 这是一个实用功能，我必须处理我的程序中有多个数据上下文的事实。关键是现在我可以将我的任何类声明为 的子类`LinqableTable`，并且只需调用`LinqedTable<MyType>.Get(ID)`.

然而，这有一些限制。首先，它强制我的所有表都有一个类型为 I 的身份字段`long`，名为`ID`。其次，因为我使用的是抽象方法，所以我不得不去 O/R 设计器，将系统中每个 ID 字段的继承属性更改为“覆盖”。

我想要更多的灵活性。所以很自然地，我尝试了反思，并得出以下结论：

```
 public abstract class LinqedTable<T> where T : LinqableTable {
    public static T Get(long ID) {
        DataContext context = LinqUtils.GetDataContext<T>();
        var q = from obj in context.GetTable<T>()
                        where obj.IDValue == ID
                        select obj;
        return q.Single<T>();
    }
}

public abstract class LinqableTable {
    internal long IDValue {
        get { return (long)IDProperty.GetValue(this, null); }
        set { IDProperty.SetValue(this, value, null); }
    }
    internal PropertyInfo IDProperty {
        get { return this.GetType().GetProperty(IDPropertyName); }
    }
    internal protected virtual string IDPropertyName {
        get { return "ID"; }
    }
} 
```

从理论上讲，这允许我覆盖 ID 列名称，转换为`long`任何整数数据类型都可以，并且我不需要将我的所有 ID 列定义为`overrides`.

**但**

Linq 不喜欢这样。在调用`q.Single<T>();`我得到一个运行时错误：

`The member 'EISS.Utils.LinqableTable.IDValue' has no supported translation to SQL.`

好的，今天我了解到 Linq 在后端做了某种魔术；它不会实例化`obj`，只是读取`IDValue`属性。所以一定有一些属性需要在`IDValue`属性上设置，让 Linq 做它的事情。

但是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T17:10:22.893

Linq to SQL 尝试将您的 linq-query 转换为 SQL，但它不知道如何将您的属性转换为数据库中的列名。

一个很好的解释可以在这里找到： [simple linq to sql has no supported translation to SQL](https://stackoverflow.com/questions/332670/simple-linq-to-sql-has-no-supported-translation-to-sql)

但如何解决，是另一回事。我已经成功使用了这个线程的方法：

[http://social.msdn.microsoft.com/forums/en-US/linqprojectgeneral/thread/df9dba6e-4615-478d-9d8a-9fd80c941ea2/](http://social.msdn.microsoft.com/forums/en-US/linqprojectgeneral/thread/df9dba6e-4615-478d-9d8a-9fd80c941ea2/)

或者您可以使用 scott guthrie 在此处提到的动态查询：

[http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-16T15:42:04.283

阅读了这些帖子：[使用 LINQ to SQL 和 C# 的通用数据访问](http://www.c-sharpcorner.com/UploadFile/scottlysle/GenericL2SinCS07212008041344AM/GenericL2SinCS.aspx)、 [LINQ-to-SQL：通用主键函数](http://csainty.blogspot.com/2008/04/linq-to-sql-generic-primary-key.html)和 [使用类型调用通用方法](http://www.eggheadcafe.com/conversation.aspx?messageid=29446785&threadid=29446774)

我和我的同事提出了以下摘要：

我们将以下方法添加到我们的数据上下文中（在部分类中）。

```
public T GetInstanceByPrimaryKey<T>(object primaryKeyValue) where T : class
{
    var table = this.GetTable<T>();
    var mapping = this.Mapping.GetTable(typeof(T));
    var pkfield = mapping.RowType.DataMembers.SingleOrDefault(d => d.IsPrimaryKey);

    if (pkfield == null)
        throw new Exception(String.Format("Table {0} does not contain a Primary Key field", mapping.TableName));

    var param = Expression.Parameter(typeof(T), "e");

    var predicate =
        Expression.Lambda<Func<T, bool>>(Expression.Equal(Expression.Property(param, pkfield.Name), Expression.Constant(primaryKeyValue)), param);

    return table.SingleOrDefault(predicate);
} 
```

然后，我们需要从类型名称和主键值中实例化：

```
string name = "LinqObjectName";
int primaryKey = 123;

var dc = new YourDataContext();

Type dcType = dc.GetType();
Type type = dcType.Assembly.GetType(String.Format("{0}.{1}", dcType.Namespace, name));

MethodInfo methodInfoOfMethodToExcute = dc.GetType().GetMethod("GetInstanceByPrimaryKey");
MethodInfo methodInfoOfTypeToGet = methodInfoOfMethodToExcute.MakeGenericMethod(name);
var instance = methodInfoOfTypeToGet.Invoke(dc, new object[] { primaryKey });

return instance; 
```

希望这可以帮助！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-26T17:05:18.990

由于引用 LINQ-to-SQL IQueryable 的 LINQ 语句被转换为 SQL 查询，因此您将不得不使用 AsEnumerable 扩展（这反过来会导致读取数据库中的所有项目）并在其上执行与反射相关的工作可数的。
**编辑**
根据需要这里是一个澄清
正如评论中指定的那样，我的意思是这样的：

```
 (from obj in context.GetTable<T>() select obj).AsEnumerable().Where(x => x.IDValue == ID)
```

与在 IQueryable 上执行的查询不同，后者可以完美地转换为 SQL，例如

```
 context.GetTable().Where(x => x.Text == "Hello")
```

它被转换为类似于

```
SELECT * FROM TABLE_MAPPED_TO_TYPE_T WHERE Text = 'Hello'
```

针对 IEnumerable 执行的查询（在您的情况下）将通过获取表的所有条目然后按代码应用指定的过滤器来执行。

# c# - 如何在 .NET DLL 中嵌入 SQLite 数据库，然后从 C# 中使用它？

> ID：791198
> 
> 赞同：11
> 
> 时间：2009-04-26T17:07:23.117
> 
> 标签：c#, .net, sqlite, dll, embed

我目前正在为我正在计划的一个项目进行一些评估工作。

我最近查看了针对我的应用程序的数据存储机制的解决方案，并且在研究时偶然发现了 SQLite。我目前将 SQLite 与 System.Data.SQLite 包装器一起使用。

我真的很喜欢它的工作方式，但我遇到了一个无法解决的问题，而且我在互联网上也找不到任何关于我的问题的帮助。

我希望将我的 SQLite 数据库嵌入到我的一个应用程序 DLL（即 Title.Storage.dll）中，以便在此 DLL 中使用。这可能吗？

那我怎样才能访问数据库呢？

如果我可以使用类似的东西会很棒：

```
SQLiteConnection con = new SQLiteConnection();
con.ConnectionString="DataSource=Title.Storage.storage.db3";
con.Open(); 
```

在此先感谢并致以最诚挚的问候，

3福克斯

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-26T17:17:24.497

程序集不是用于文件存储，而是用于代码存储。虽然您可以将文件存储在程序集中，但它们是只读的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-11T07:35:43.303

这是不可能的。您可以做的是将数据库嵌入到您的 dll 项目中并将其转储到文件系统上的某个位置（可能是 AppData？）并从那里读取和写入。将 db 直接放在可执行文件（或 dll）中可能不是一个好主意，因为它除了在技术上不可行之外，还会增加应用程序的大小。

拥有一个可分发的可执行文件是我喜欢的口味问题。在你的情况下，但问题更多。这不仅仅是单独嵌入 db 文件，与之关联的 dll 呢？步骤是2：

1）将与您的数据库关联的必要dll（`System.Data.SQLite`？）添加到您的项目中`Embedded Resource` *（不一定是 a `Resource file`）*，并让系统自动解决程序集冲突。[在这里抓住它](https://stackoverflow.com/a/10600046/661933)怎么做。

2）现在将您的 db 文件添加到您`Resources`的项目中（并提取它）

```
static void DumpDatabase()
{
    var dbFullPath = Utility.GetDbFullPath(); //your path
    if (File.Exists(dbFullPath))
        return; //whatever your logic is

    File.WriteAllBytes(dbFullPath, Properties.Resources.myDb);
} 
```

甚至**最好**不要将数据库嵌入到您的项目中，而是编写逻辑以在您的应用程序中创建数据库。如果明天您需要更改 SQLite 的版本，比如从 3 到 4，该怎么办？使用第一种方法，您需要为自己创建一个数据库并将其重新嵌入到项目中。但是，如果您正在编写在应用程序中创建数据库的逻辑，那么更新 SQLite 版本只需更改 ADO.NET dll（代码保持不变）。可能是这样的：

```
static void DumpDatabase()
{
    var dbFullPath = Utility.GetDbFullPath();
    if (File.Exists(dbFullPath))
        return; //whatever your logic is

    CreateDb(dbFullPath);
}

static void Create(string dbFullPath)
{
    SQLiteConnection.CreateFile(dbFullPath);

    string query = @"

    CREATE TABLE [haha] (.............)
    CREATE TABLE ..............";

    Execute(query);
} 
```

并在连接字符串中添加`FailIfMissing=False;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T17:38:38.120

如果您使用的是 NTFS，则可以使用备用数据流。在我的项目中，我们使用名为 :DB 的备用流将 SQLite 数据库隐藏在另一个文件中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T17:37:04.440

我不认为将数据存储在 DLL 中是一个好主意，但是有一种肮脏的方法可以做到这一点。

从 DLL 加载数据：

1.  使用 System.Reflection.Assembly 从 DLL 文件加载字符串。（字符串是 DB 的转储）
2.  在内存中创建空的 SQLite DB。
3.  使用加载的字符串作为对 DB 的查询来恢复其内容。

现在您可以在内存中进行任何查询。

要将数据保存到 DLL：

1.  将 DB 内容转储为字符串。
2.  创建包含用 C# 代码包装的 SQL 转储的临时文件。
3.  使用“csc”（或 Mono 中的“gmcs”）编译它。

这很愚蠢，但它应该工作。希望你永远不会那样编码。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-24T02:20:50.230

SQLite 被打包和分发为带有几个（我认为是 3 个）头文件的单个 C 文件。这意味着您可以用一个编译命令编译整个 50000 行程序并得到一个 .o 文件。从那里，您可以将它与您链接到该 DLL 的其他文件链接到您的应用程序 DLL。

一旦你将 sqlite3.o 构建到你的应用程序 DLL 中，它的 SQLite API 中的符号就会对你的程序可用，就像你的其他 C/C++ DLL 对你的 C#/VB 程序可用一样。

查看 www.sqlite.org/amalgamation.html 了解更多信息。

# css - “强制”用户更新浏览器是一种好习惯吗？

> ID：791202
> 
> 赞同：3
> 
> 时间：2009-04-26T17:08:50.760
> 
> 标签：css, browser, internet-explorer-6

我帮助为当地的非营利组织开发了一个网站。我已要求使用该网站的人提供反馈。我遇到了 IE6 的问题，修复该问题会在 IE6 中引入其他问题，以至于引入另一个 CSS 文件只是为了修复 IE6。我偶然发现了一种基本上“强制”用户更新到更新版本的方式。这是好习惯吗？

编辑：“更新”的作用是在顶部显示推荐更新的IE黄色栏，如果用户点击它，浏览器将开始更新。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-26T17:11:46.120

不可以。请记住，很多用户，例如在政府机构等工作的用户，没有选择他们工作站上的软件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-26T17:11:03.780

我认为向用户“强制”任何东西都不是一种好的做法——即使你可以——*尤其是*当它像 IE 一样重要时。

诚然，用户从 IE6 升级*通常是*明智的，但他们可能有充分的理由继续使用 IE（例如，他们使用旧版应用程序/网站）。

除非您的应用程序对您的用户来说是“关键任务”，否则如果您的网站推荐，他们也不太可能升级。如果您还记得几年前，很多网站都有“使用...查看最佳”链接/图标 - 但人们很少愿意升级他们的浏览器只是为了更轻松地查看网站。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-26T17:11:44.870

如果您在 Intranet 中进行部署，那么这可能是一种可行的解决方案。否则，根据浏览器版本阻止用户访问您的网站不是很明智。除非您不关心失去流量/用户群等。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-26T17:21:42.117

在我现在工作的网站上，我必须为旧版本的 IE 加载不同的样式表，但我从一开始就内置了该功能。我指出旧的 IE 用户代理在网站主页上使用友好消息说该页面看起来不太好，因为他们使用的是带有 MS 下载页面链接的旧版本。该网站还拥有相对较少的固定用户数（每天<500 个唯一用户）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-26T17:13:51.667

只要确保向您的用户推荐它来升级浏览器，您就无法使用过时的浏览器解决与他们相关的所有问题。

不过不要强求。

哦，任何仍然将他们的网络锁定在 IE6 中的 IT 管理员都需要了解它有多崩溃......

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-26T17:17:50.380

除非您有支持 IE6 的特定要求，否则就别管它了。如果它看起来很糟糕或无法使用，那就是它的方式。如果他们抱怨，就说你不支持 IE6。如果有足够多的人抱怨，您可以考虑更新您的网站以支持它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-26T17:12:48.330

不，“强迫”用户不是一个好习惯......

想想公司中的用户，他们的桌面被“锁定”，因此不允许用户安装软件。

如果可能的话，最好让您的网站在较旧的浏览器上很好地降级，这样用户至少可以看到一些合理的东西，如果不是完美的话。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-26T17:13:53.307

不，这不是一个好主意。如果必须，请使用条件评论系统来适应 IE6，或者，如果失败，请给他们留下一条“您的浏览器坏了，抱歉”的消息，解释他们应该升级的原因。但允许他们选择。武力从来都不是，或者至少很少是使用的好东西。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-26T17:15:12.880

我要做的是确保基本的东西在 IE6 上工作，然后使用条件包含向用户显示通知，说明他们的浏览器太旧，无法支持您的网站设计，并且他们可能会获得更好的体验较新的浏览器。这可以在不必完全破坏用户体验的情况下完成。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-26T17:18:33.090

强制用户升级浏览器不是一个好习惯，尤其是当您有很多用户从公司网络访问系统时。大多数大公司在他们的网络上都有标准化的桌面[操作系统和所有软件]，他们在尽职调查、几项安全、[与他们现有的软件]集成测试之后，花费自己的时间来升级网络上的浏览器， ETC。 。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-26T17:48:03.707

我同意前面的大部分答案。此外，您应该考虑是否建议人们升级到 IE 以外的浏览器。

您可以做的一件事是拆分 CSS 文件并使用服务器端脚本（或者可能是条件注释）来选择要加载的 CSS。'基本' CSS，无论浏览器如何都将被加载并在它们中很好地呈现（或根本不呈现，视情况而定），以及将在此之上工作并被加载的“增强” CSS仅在 IE7+ 和其他现代浏览器中。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-26T19:04:58.453

我认为该网站在 IE6 中应该仍然可以使用，但我个人不会费心让它看起来不错。古怪的 CSS 或蓝色背景的透明 PNG？嗯，这太糟糕了。

# entity-relationship - ER图

> ID：791221
> 
> 赞同：0
> 
> 时间：2009-04-26T17:15:04.473
> 
> 标签：entity-relationship

只是想知道 ER 图 1 和 ER 图 2 有什么区别？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T17:50:51.500

我认为您的意思是标准化水平一和二。看到[这个](http://en.wikipedia.org/wiki/Database_normalization#Normal_forms)。

# java - 使用 SwingWorker 时应该如何处理异常？

> ID：791223
> 
> 赞同：23
> 
> 时间：2009-04-26T17:16:05.390
> 
> 标签：java, swing, swingworker

我在 Java 6 中使用 SwingWorker 以避免在事件调度线程上运行长时间运行的代码。

如果在我的 done() 方法中调用 get() 返回异常，那么处理异常的适当方法是什么？

我特别担心可能的 InterruptedExceptions。JavaDoc 示例只是忽略了异常，但多年来我了解到吞下异常会导致难以调试的代码。

示例用法如下：

```
new SwingWorker<String, Void>() {

    @Override
    protected String doInBackground() throws Exception {
        // do long-running calculation
        return result;
    }

    @Override
    protected void done() {
        try {
            setTextField(get());
        } catch (InterruptedException e) {
            e.printStackTrace();  
        } catch (ExecutionException e) {
            e.printStackTrace();  
        }
    }
}.execute(); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2011-06-03T18:44:07.530

这是一个旧帖子，但我想澄清一下：

SwingWorker.get 抛出 InterruptedException、ExecutionException 作为检查异常。

此外，它还会引发一个非常具体的未经检查的异常，即 CancellationException。当然，它可能会抛出任何未经检查的异常，但 CancellationException 不是“异常”和意外的异常。当您在调用取消之后尝试调用 get 方法时会抛出它。

当在 doInBackground 中引发异常时，将引发 ExecutedException。原始异常包含在 ExecutionException 中。当调用 get() 方法时，将抛出 ExecutionException。取出原始异常并进行管理的想法很好。（正如 Emil H 指出的那样）。

CancellationException 未选中，我认为应该选中。API 实现不检查它的唯一借口是它有一个状态方法 isCancelled()。
您可以：
- 测试 isCancelled() 并且如果为真，则不要调用 get()，因为它会抛出 CancellationException
- 用 try-catch 包围 get() 并添加 CancellationException，因为编译器不会请求未选中
- 事实上CancellationException 未被选中，让您可以忘掉所有这些东西并获得惊喜。
- 做任何事情，因为你不会取消工人

中断异常。如果使用 cancel(true) 取消 SwingThread，doInBackground 中的第一个可中断方法调用（肯定是 Thread.sleep、this.wait，可能还有一些 IO 方法）将抛出 InterruptException。但是这个异常没有包含在 ExecuteException 中。doInBackground 将因异常中断而终止。如果它被捕获并转换为其他异常，则这些异常将被忽略，因为此时 cancel 已经在 EDT 上调用了 SwingThread.done，如果 done 调用了 get，它只得到标准的 CancellationException。*不是中断异常！*

如果使用 cancel(false) 取消，则不会在 doInBackground 中引发 InterruptException。如果您使用 cancel(true) 取消但在 doInBackground 中没有可中断的方法调用，则相同。在这些情况下，doInBackground 将遵循其自然循环。此循环应测试 isCancelled 方法并正常退出。如果 doInBackground 不这样做，它将永远运行。我没有测试过是否存在超时，但我不这么认为。

对我来说，它仍然只是一个**灰色地带**。哪些情况下get会抛出InterruptedException？我想看一些简短的代码，因为我无法产生类似的异常。:-)

PS 我在另一个 Question&Answer 中记录了在 doInBackground 退出之前调用完成和状态更改侦听器以防取消。既然这是真的，那么在设计 doInBackground 方法时，这不是一个错误，需要特别注意。如果您对此感兴趣，请参阅[SwingWorker：何时调用 done 方法？](https://stackoverflow.com/questions/6204141/swingworker-when-exactly-is-called-done-method)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T17:51:34.040

这在很大程度上取决于后台作业可能导致的错误类型。如果 doInBackground 中的作业抛出异常，它将作为嵌套的 ExecutionException 传播到 done 方法。在这种情况下，最佳实践是处理嵌套异常，而不是 ExecutionException 本身。

例如：如果工作线程抛出异常，表明数据库连接已丢失，您可能希望重新连接并重新启动作业。如果要完成的工作依赖于某种已经被使用的资源，最好为使用提供重试或取消选择。如果抛出的异常对用户没有任何影响，只需记录错误并继续。

据我所知，我相信 InterruptedException 不会成为问题，因为您在 done 方法中调用 get 方法，因为只有在等待后台作业时 get 调用被中断时才会抛出 InterruptedException结束。如果发生类似的意外事件，您可能希望显示错误消息并退出应用程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T05:07:00.663

这既是一个界面问题，也是一个错误处理问题。许多应用程序添加了一些列出正在运行的后台作业的小表格。其中一个异常可能会闪现产生错误的表行，或者做一些破坏性的事情，比如显示警报。这取决于异常的严重程度。我认为您可能必须回答的更难的问题是，我们讨论了多少种可能不同类型的异常，以及它们的相对严重性是什么。

我认为一个简单的妥协可能是为您最严重的错误提供模式警报，以及其他任何事情，只需记录事件直到它a）阻止用户继续进行或b）用户关闭文档/窗口，此时例如，您可以在询问是否要保存任何未保存的缓冲区的同时显示在后台处理任务期间发生的异常列表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-02T05:58:24.250

我建议让错误一直传播到操作开始的地方。

例如，如果用户单击按钮以从数据源获取数据。如果出现问题，无论是凭据错误、网络错误、数据库错误还是其他任何问题，您都不适合在该工作线程中设置逻辑来尝试在那里解决它。

但是如果你让它传播到任务开始的地方，你可以从那里进行适当的错误更正，例如再次弹出凭据对话框，显示“重试”对话框，甚至显示错误消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-26T17:20:18.610

假设这是一个 GUI 应用程序，您可能希望在异常时提供有关失败操作的视觉反馈。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-22T16:31:16.730

我应该澄清我原来的帖子。不要简单地在 done() 方法中捕获某些异常类型。在 doInBackground() 中执行的任何代码都可能引发任何类型的异常，并且仅在您的问题中捕获异常可能会导致在 EDT（事件调度线程或主 GUI 线程）上引发异常。在 done() 方法中捕获所有异常类型只是使用 SwingWorkers 时的一个好习惯。

```
@Override
protected void done()
{
    try
    {
        if(!super.isCancelled())
        {
            super.get();
        }
    }
    catch(Exception ex)
    {
        ex.printStackTrace();
    }
} 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-04-26T19:07:09.883

我猜你不会用 C# 得到很多这样的问题。您需要了解异常是什么并适当地处理它（这通常是让它在堆栈中更进一步）。

`InterruptedException``Thread.interrupt`- 当线程在等待（大致）时被（被）中断时抛出。为什么要中断线程？通常你希望线程停止它正在做的事情——重置中断状态并退出。例如，如果小程序线程在一个小程序应该消失后继续运行更长的时间，插件将中断小程序线程。但是，在这种情况下，provided`done`被正确调用，您根本不应该等待。因此，将异常包装在一个中是合适的`IllegalStateException`（API 文档可能应该说明这一点）。这是一个非常糟糕的 API。/模式可能更有意义`publish`。`process`

`ExecutionException`- 您需要处理包装的异常。如果您不希望出现特定类型的异常，请将其包装在未经检查的异常中。

一般来说，我会建议明确区分 EDT 上发生的事情和 EDT 外发生的事情。因此，避免`SwingWorker`在生产代码中。

# macos - 无法通过 MacPorts 在 Mac 中更新我的 Bash

> ID：791227
> 
> 赞同：38
> 
> 时间：2009-04-26T17:18:33.263
> 
> 标签：macos, bash, macports

我通过 MacPorts 将我的 Bash 更新为 3.2.48 失败。

似乎我没有激活它，因为我得到了

```
echo $BASH_VERSION
3.2.17(1)-release 
```

**您如何使最新的 Bash 处于活动状态**，以便我为我的登录 shell 获取它？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-04-26T17:25:49.797

运行以下代码，例如将您的 shell 更改为 MacPorts 安装的最新 Bash

```
chsh -s /opt/local/bin/bash 
```

如果这给了你信息，

> " `non-standard shell`"

你需要添加

```
/opt/local/bin/bash 
```

到

```
/etc/shells 
```

请注意，这`/etc/shells`只是一个文本文件，因此如果您以 root 身份进行身份验证，则可以直接对其进行编辑。您可以通过命令以编程方式更改它

```
sudo -s
Password:
# echo /opt/local/bin/bash >> /etc/shells 
```

如果您的第一个 chsh 命令失败，如果您设法更改了上述文件，请立即再次运行它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T21:23:54.750

我猜它已安装但未用作您的登录外壳。

您可以在命令行上使用 dscl 更改 shell。

在 dscl 提示符下键入以下内容：

```
list Local/Default/Users
read Local/Default/Users/<your username here>
change Local/Default/Users/<your username here> UserShell /bin/bash /opt/local/bin/bash 
```

如果有帮助，我的[博客上有另一个使用 dscl 的示例。](http://hasno.info "博客")

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-15T21:34:32.933

您可以使用以下 shell 脚本将登录 shell 从现有的 Mac OS X 登录 shell（默认情况下`/bin/bash`随 Mac OS X 提供）切换到 MacPorts ：`/opt/local/bin/bash`

```
#!/opt/local/bin/bash
if [ `grep /opt/local/bin/bash /etc/shells` ]; 
then 
    echo /opt/local/bin/bash | chsh -s /opt/local/bin/bash;     
else 
    echo /opt/local/bin/bash | sudo tee -a /etc/shells; 
    chsh -s /opt/local/bin/bash; 
fi 
```

# css - 使用 CSS 强制侧边栏高度 100%（带有粘性底部图像）？

> ID：791231
> 
> 赞同：81
> 
> 时间：2009-04-26T17:20:39.653
> 
> 标签：css, sidebar, sticky

几个小时以来，我一直把头撞在墙上，试图弄清楚这个问题，并认为它一定是我遗漏的一些小东西。我在网上搜索过，但我发现似乎没有任何效果。HTML 是：

```
<body>
  <div id="header">
    <div id="bannerleft">
    </div>

    <div id="bannerright">
      <div id="WebLinks">
        <span>Web Links:</span>
        <ul>
          <li><a href="#"><img src="../../Content/images/MySpace_32x32.png" alt="MySpace"/></a></li>
          <li><a href="#"><img src="../../Content/images/FaceBook_32x32.png" alt="Facebook"/></a></li>
          <li><a href="#"><img src="../../Content/images/Youtube_32x32.png" alt="YouTube"/></a></li>
        </ul>
      </div>
    </div>
  </div>
  <div id="Sidebar">
    <div id="SidebarBottom">
    </div>
  </div>
  <div id="NavigationContainer">
    <ul id="Navigation">
      <li><a href="#">Nav</a></li>
      <li><a href="#">Nav</a></li>
      <li><a href="#">Nav</a></li>
      <li><a href="#">Nav</a></li>
      <li><a href="#">Nav</a></li>
      <li><a href="#">Nav</a></li>
    </ul>
  </div>
  <div id="Main">
    <!-- content -->
  </div>
</body> 
```

我的完整 CSS 是：

```
* {
  margin: 0px;
  padding: 0px;
}

body {
  font-family: Calibri, Sans-Serif;
  height: 100%;
}

#header {
  width: 100%;
  z-index: 1;
  height: 340px;
  background-image: url("../../Content/images/bannercenter.gif");
  background-repeat: repeat-x;
}

#header #bannerleft {
  float: left;
  background-image: url("../../Content/images/bannerleft.gif");
  background-repeat: no-repeat;
  height: 340px;
  width: 439px;
  z-index: 2;
}

#bannerright {
  float: right;
  background-image: url("../../Content/images/bannerright.gif");
  background-repeat: no-repeat;
  width: 382px;
  height: 340px;
  background-color: White;
  z-index: 2;
}

#Sidebar {
  width: 180px;
  background: url("../../Content/images/Sidebar.png") repeat-y;
  z-index: 2;
  height: 100%;
  position: absolute;
}

#SidebarBottom {
  margin-left: 33px;
  height: 100%;
  background: url("../../Content/images/SidebarImage.png") no-repeat bottom;
}

#NavigationContainer {
  position: absolute;
  top: 350px;
  width: 100%;
  background-color: #bbc4c3;
  height: 29px;
  z-index: 1;
  left: 0px;
}

#Navigation {
  margin-left: 190px;
  font-family: Calibri, Sans-Serif;
}

#Navigation li {
  float: left;
  list-style: none;
  padding-right: 3%;
  padding-top: 6px;
  font-size: 100%;
}

#Navigation a:link, a:active, a:visited {
  color: #012235;
  text-decoration: none;
  font-weight: 500;
}

#Navigation a:hover {
  color: White;
}

#WebLinks {
  float: right;
  color: #00324b;
  margin-top: 50px;
  width: 375px;
}

#WebLinks span {
  float: left;
  margin-right: 7px;
  margin-left: 21px;
  font-size: 10pt;
  margin-top: 8px;
  font-family: Helvetica;
}

#WebLinks ul li {
  float: left;
  padding-right: 7px;
  list-style: none;
}

#WebLinks ul li a {
  text-decoration: none;
  font-size: 8pt;
  color: #00324b;
  font-weight: normal;
}

#WebLinks ul li a img {
  border-style: none;
}

#WebLinks ul li a:hover {
  color: #bcc5c4;
} 
```

我希望侧边栏与我的页面内容一起拉伸高度，并将侧边栏底部图像始终留在侧边栏的底部。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2011-12-09T20:44:34.323

这对我有用

```
.container { 
  overflow: hidden; 
  .... 
} 

#sidebar { 
  margin-bottom: -5000px; /* any large number will do */
  padding-bottom: 5000px; 
  .... 
} 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-12-28T17:02:56.047

在 CSS 的 flexbox 变得更加主流之前，您始终可以绝对定位侧边栏，将其与顶部和底部相距零像素，然后在主容器上设置边距以进行补偿。

**JSFiddle**

[http://jsfiddle.net/QDCGv/](http://jsfiddle.net/QDCGv/)

**HTML**

```
<section class="sidebar">I'm a sidebar.</section>

<section class="main">I'm the main section.</section> 
```

**CSS**

```
section.sidebar {
  width: 250px;
  position: absolute;
  top: 0;
  bottom: 0;
  background-color: green;
}

section.main { margin-left: 250px; } 
```

**注意**：这是一种非常简单的方法，但您会发现`bottom`它的意思不是“页面底部”，而是“窗口底部”。如果您的主要内容向下滚动，侧边栏可能会突然结束。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-04-26T17:32:38.690

**更新：**由于这个答案仍然得到上下投票，并且在撰写本文时已有*八年之久*：现在可能有更好的技术。原始答案如下。

* * *

显然，您正在寻找[仿列](http://www.alistapart.com/articles/fauxcolumns/)技术:-)

通过计算高度属性的方式，您不能`height: 100%`在具有自动高度的东西中设置。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-01-17T10:31:39.373

我会使用**css 表格**来实现 100% 的侧边栏高度。

基本思想是将侧边栏和主 div 包装在一个容器中。

给容器一个`display:table`

并给 2 个子 div（侧边栏和主）一个`display: table-cell`

像这样。。

```
#container {
display: table;
}
#main {
display: table-cell;
vertical-align: top;
}
#sidebar {
display: table-cell;
vertical-align: top;
} 
```

看看这个**[LIVE DEMO](http://jsfiddle.net/danield770/QXZYe/1/)**，我使用上述技术修改了您的初始标记（我为不同的 div 使用了背景颜色，以便您可以看到哪些是哪些）

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-09-17T21:00:29.910

弹性盒（[http://caniuse.com/#feat=flexbox](http://caniuse.com/#feat=flexbox)）

首先将所需的列包装在 div 或部分中，例如：

```
<div class="content">
    <div class="main"></div>
    <div class="sidebar"></div>
</div> 
```

然后添加以下 CSS：

```
.content {
    display: -webkit-box;
    display: -moz-box;
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-02-01T18:29:09.997

除了@montrealmike 的回答，我可以添加我的改编吗？

我这样做了：

```
.container { 
  overflow: hidden; 
  .... 
} 

#sidebar { 
  margin-bottom: -101%;
  padding-bottom: 101%; 
  .... 
} 
```

我做了“101%”的事情是为了迎合（极其罕见的）可能有人在一个高度超过 5000 像素的大屏幕上查看该网站的可能性！

很好的答案，蒙特利尔麦克。它对我来说非常有效。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-08-22T21:21:09.067

我在不同的项目中多次遇到这个问题，但我找到了适合我的解决方案。您必须使用四个 div 标签 - 一个包含侧边栏、主要内容和页脚。

首先，为样式表中的元素设置样式：

```
#container {
width: 100%;
background: #FFFAF0;
}

.content {
width: 950px;
float: right;
padding: 10px;
height: 100%;
background: #FFFAF0;
}

.sidebar {
width: 220px;
float: left;
height: 100%;
padding: 5px;
background: #FFFAF0;
}

#footer {
clear:both;
background:#FFFAF0;
} 
```

您可以根据需要编辑不同的元素，只要确保不要更改页脚属性“clear:both” - 这非常重要。

然后，只需像这样设置您的网页：

```
<div id=”container”&gt;
<div class=”sidebar”&gt;</div>
<div class=”content”&gt;</div>
<div id=”footer”&gt;</div>
</div> 
```

[我在http://blog.thelibzter.com/how-to-make-a-sidebar-extend-the-entire-height-of-its-container](http://blog.thelibzter.com/how-to-make-a-sidebar-extend-the-entire-height-of-its-container)上写了一篇更深入的博客文章。请让我知道，如果你有任何问题。希望这可以帮助！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-26T17:24:40.270

也[许多列布局开箱即用](http://www.alistapart.com/articles/multicolumnlayouts/)是您正在寻找的？

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-10-15T20:14:37.687

我想，今天可能有人会为此使用 flexbox。请参阅[圣杯示例](http://philipwalton.github.io/solved-by-flexbox/demos/holy-grail/)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-10-06T08:25:34.770

我和乔恩面临同样的问题。TheLibzter 让我走上了正轨，但必须留在侧边栏底部的图像不包括在内。所以我做了一些调整...

重要的：

*   包含侧边栏和内容 (#bodyLayout) 的 div 的定位。这应该是相对的。
*   必须保持在 sidbar 底部的 div 的定位 (#sidebarBottomDiv)。这应该是绝对的。
*   内容宽度+侧边栏宽度必须等于页面宽度（#container）

这是CSS：

```
 #container
    {
        margin: auto;
        width: 940px;
    }
    #bodyLayout
    {
        position: relative;
        width: 100%;
        padding: 0;
    }
    #header
    {
        height: 95px;
        background-color: blue;
        color: white;
    }
    #sidebar
    {
        background-color: yellow;
    }
    #sidebarTopDiv
    {
        float: left;
        width: 245px;
        color: black;
    }
    #sidebarBottomDiv
    {
        position: absolute;
        float: left;
        bottom: 0;
        width: 245px;
        height: 100px;
        background-color: green;
        color: white;
    }
    #content
    {
        float: right;
        min-height: 250px;
        width: 695px;
        background-color: White;
    }
    #footer
    {
        width: 940px;
        height: 75px;
        background-color: red;
        color: white;
    }
    .clear
    {
        clear: both;
    } 
```

这是html：

```
<div id="container">
    <div id="header">
        This is your header!
    </div>
    <div id="bodyLayout">
        <div id="sidebar">
            <div id="sidebarTopDiv">
                This is your sidebar!                   
            </div>
            <div id="content">                  
            This is your content!<br />
            The minimum height of the content is set to 250px so the div at the bottom of
            the sidebar will not overlap the top part of the sidebar.
            </div>
            <div id="sidebarBottomDiv">
                This is the div that will stay at the bottom of your footer!
            </div>
            <div class="clear" />
        </div>
    </div>
</div>
<div id="footer">
    This is your footer!
</div> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-03-14T00:07:04.963

我意识到这是一篇旧帖子，但我试图为我的网站设计一个侧边栏。这行得通吗？

```
#sidebar-background
{
    position:fixed;
    width:250px;
    top:0;
    bottom:0;
    background-color:orange;
}

#content-background
{
    position:fixed;
    right:0;
    top:0;
    bottom:0;
    left:250px;
    background-color:pink;
}

#sidebar
{
    float:left;
    width:250px;
}

#content
{
    float:left;
    width:600px;
}

<div id="sidebar-background"></div>
<div id="content-background"></div>

<div id="sidebar">Sidebar stuff here</div>
<div id="content">Stuff in here</div> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-26T17:29:57.680

我认为您的解决方案是将您的内容容器和侧边栏包装在包含 div 的父级中。将侧边栏浮动到左侧并为其提供背景图像。为内容容器创建至少与侧边栏宽度相同的宽边距。添加[清除浮动黑客](http://www.positioniseverything.net/easyclearing.html)以使其全部工作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-01-31T11:16:59.423

如果您使用固定宽度的侧边栏，请使用正文背景提供与侧边栏相同宽度的图像。还将 background-repeat:repeat-y 放入您的 CSS 代码中。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-06-25T15:58:30.203

侧边栏的绝对位置，顶部：0 和底部：0 以及包装器（或容器）的相对位置，包含所有元素，它完成了！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-11-11T03:35:23.557

试试这个。它强制导航栏随着内容的添加而增长，并保持主要区域居中。

```
 <html>
        <head>
            <style>
                    section.sidebar {
          width: 250px;
          min-height:100vh;
          position: sticky;
          top: 0;
          bottom: 0;
          background-color: green;
        }

        section.main { position:sticky; top:0;bottom:0;background-color: red; margin-left: 250px;min-height:100vh; }
            </style>
            <script lang="javascript">
            var i = 0;
            function AddOne()
            {
                for(i = 0;i<20;i++)
                {
                var node = document.createElement("LI");
                var textnode = document.createTextNode(' Water ' + i.toString());

                node.appendChild(textnode);
                document.getElementById("list").appendChild(node);
                }

            }
            </script>
        </head>
        <body>
                <section class="sidebar">
                    <button id="add" onclick="AddOne()">Add</button>
                    <ul id="list">
                        <li>bullshit 1</li>
                    </ul>
                </section>
                <section class="main">I'm the main section.</section>
        </body>    
    </html> 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-10-08T12:21:45.433

这是[丹尼尔答案的简化版本](https://stackoverflow.com/a/14377025/2351696)

```
.container {
  display: table;
  height: 260px;
}
#sidebar {
  display: table-cell;
  vertical-align: top;
  background-color:red;
  position:relative;
} 

#sidebarbottom
{
  height:30px;
  position:absolute;
  bottom:0;
}
```

```
<div class="container">
  <div id="sidebar">
    SIDEBAR HERE
    <div id="sidebarbottom">
      Sidebar Bottom
    </div>
  </div>
</div>
```

# iphone - 在 Objective-C 中随机化 NSArray 的规范方法

> ID：791232
> 
> 赞同：38
> 
> 时间：2009-04-26T17:20:51.823
> 
> 标签：iphone, objective-c, random

是否有规范的方法可以在 Objective-C 中随机化一个数组？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-04-26T22:39:46.860

我的实用程序库在 NSMutableArray 上定义了这个类别来做到这一点：

```
@interface NSMutableArray (ArchUtils_Shuffle)
- (void)shuffle;
@end

// Chooses a random integer below n without bias.
// Computes m, a power of two slightly above n, and takes random() modulo m,
// then throws away the random number if it's between n and m.
// (More naive techniques, like taking random() modulo n, introduce a bias 
// towards smaller numbers in the range.)
static NSUInteger random_below(NSUInteger n) {
    NSUInteger m = 1;

    // Compute smallest power of two greater than n.
    // There's probably a faster solution than this loop, but bit-twiddling
    // isn't my specialty.
    do {
        m <<= 1;
    } while(m < n);

    NSUInteger ret;

    do {
        ret = random() % m;
    } while(ret >= n);

    return ret;
}

@implementation NSMutableArray (ArchUtils_Shuffle)

- (void)shuffle {
    // http://en.wikipedia.org/wiki/Knuth_shuffle

    for(NSUInteger i = [self count]; i > 1; i--) {
        NSUInteger j = random_below(i);
        [self exchangeObjectAtIndex:i-1 withObjectAtIndex:j];
    }
}

@end 
```

`srandom(time(NULL))`确保在调用之前的某个时间为随机数生成器（例如）播种；否则输出不会很随机。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-04-21T11:01:41.207

这里是！

```
- (NSArray*)shuffleArray:(NSArray*)array {

    NSMutableArray *temp = [[NSMutableArray alloc] initWithArray:array];

    for(NSUInteger i = [array count]; i > 1; i--) {
        NSUInteger j = arc4random_uniform(i);
        [temp exchangeObjectAtIndex:i-1 withObjectAtIndex:j];
    }

    return [NSArray arrayWithArray:temp];
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-26T18:34:39.790

```
if ([array count] > 1) {
    for (NSUInteger shuffleIndex = [array count] - 1; shuffleIndex > 0; shuffleIndex--)
        [array exchangeObjectAtIndex:shuffleIndex withObjectAtIndex:random() % (shuffleIndex + 1)];
} 
```

确保使用 srandomdev() 或 srandom() 为 random() 函数播种。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-26T17:25:08.740

如果这就是您所要求的，SDK 中没有内置任何内容。

但是，您可以使用几乎任何您想要的随机化或洗牌算法。不同的算法在随机性、效率等方面有不同的权衡。

[http://en.wikipedia.org/wiki/Shuffling#Shuffling_algorithms](http://en.wikipedia.org/wiki/Shuffling#Shuffling_algorithms)

对于从可变数组开始“就地”随机播放的算法，请使用

```
insertObject:atIndex:
removeObjectAtIndex: 
```

对于重建数组的算法，将原始数组提供给它并构建一个新数组。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-10-15T05:33:16.100

我的解决方案是一个类别方法，它返回数组的副本（自动释放），其中元素随机化（使用 arc4random）。

```
@interface NSArray (CMRandomised)

/* Returns a copy of the array with elements re-ordered randomly */
- (NSArray *)randomised;

@end

/* Returns a random integer number between low and high inclusive */
static inline int randomInt(int low, int high)
{
    return (arc4random() % (high-low+1)) + low;
}

@implementation NSArray (CMRandomised)

- (NSArray *)randomised
{
    NSMutableArray *randomised = [NSMutableArray arrayWithCapacity:[self count]];

    for (id object in self) {
        NSUInteger index = randomInt(0, [randomised count]);
        [randomised insertObject:object atIndex:index];
    }
    return randomised;
}

@end 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-29T23:13:53.107

没有在`NSArray`（即有一个像这样的实例方法`arrayWithRandomizedIndices`）或`NSMutableArray`（即有像这样的方法）上创建一个类别的规范方法`randomizeIndices`。

这是我图书馆中的一个示例，属于`NSMutableArray`. 它将随机重新排序数组，而不是打乱一些条目。

```
- (void) randomizeIndices
{
  if (self == nil || [self count] <= 1)
  {
    return;
  }

  int count = [self count];

  NSMutableArray* copySelf = [NSMutableArray arrayWithArray:self];
  NSMutableArray* mutableResultArray = [NSMutableArray alloc];
  mutableResultArray = [mutableResultArray initWithCapacity:count];
  [mutableResultArray autorelease];

  int objectsMovedCount = 0;

  for (int i = 0; i < count; i++)
  {
    int index = rand() % (count - objectsMovedCount);
    id anObject = [copySelf objectAtIndex:index];
    [mutableResultArray addObject:anObject];
    [copySelf removeObjectAtIndex:index];
    objectsMovedCount++;
  }
  [self setArray:mutableResultArray];
} 
```

`srand(time(0));`在调用此方法之前或在该方法的早期调用或类似的调用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-01T23:24:34.090

NSArray 随机化作为 Objective-C 类别方法：

```
@implementation NSArray (NGDataDynamics)

- (NSArray *)jumbled
{
  NSMutableArray *jumbled = self.mutableCopy;

  NSUInteger idx = self.count-1;
  while(idx)
  {
    [jumbled exchangeObjectAtIndex:idx
                 withObjectAtIndex:arc4random_uniform(idx)];
    idx--;
  }

  return jumbled;
}

@end 
```

如图所示：[NSArray 随机化和迷幻](http://noblegesture.wordpress.com/2013/07/01/nsarray-randomization-psychedelia/ "NSArray 随机化和迷幻")

# mod-rewrite - 如何在不更改 url 的情况下将 www.foo.com/bar 重定向到 www.foo.com:8080？

> ID：791239
> 
> 赞同：2
> 
> 时间：2009-04-26T17:22:19.947
> 
> 标签：mod-rewrite, redirect

如何在不“真正”更改网址栏中的网址的情况下将 www.foo.com/bar 重定向到 www.foo.com:8080？

所以我希望 www.foo.com/bar（+ 可能的 GET 参数/子文件夹）始终显示在 url 栏中。

这可以用 mod_rewrite 完成吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T17:25:42.590

您需要一个代理 ( [mod_proxy](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html) ) 来执行此操作。这是[mod_rewrite 的`RewriteRule`](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriterule)示例：

```
RewriteCond %{SERVER_PORT} ^80$
RewriteRule ^ http://%{HTTP_HOST}:8080%{REQUEST_URI} [P] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T17:26:30.887

不，它不能。:8080 告诉浏览器连接到服务器的端口。如果它不存在，它将假定您拥有的任何协议前缀的默认值（http = 80、https = 443、ftp = 21 等）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-02T12:33:14.317

这样做的原因可能和我的情况一样。家庭网络服务器和路由器阻止端口 80 作为路由器的故障设置页面，所以为了在我的情况下运行 Xampp，我使用端口 8080

# c# - 动画列表框中删除的项目

> ID：791247
> 
> 赞同：5
> 
> 时间：2009-04-26T17:27:13.383
> 
> 标签：c#, .net, wpf, xaml, expression-blend

我的应用程序中有一些列表框绑定到 ObservableCollections，如果项目被删除，我想为它制作动画。

我已经找到了一个关于使用 FrameworkElement.Loaded 事件为添加的项目设置动画的问题，但当然这与 Unloaded 事件的工作方式不同。

有什么方法可以在数据模板中使用吗？

编辑：我已经连接到我的 ItemsSource 中的 CollectionChanged 事件并尝试手动应用动画。目前它看起来像这样：

```
 ListBoxItem item = stack.ItemContainerGenerator.ContainerFromIndex(0) as ListBoxItem;
        item.LayoutTransform = new ScaleTransform(1, 1);

    DoubleAnimation scaleAnimation = new DoubleAnimation(); 
    scaleAnimation.From = 1; 
    scaleAnimation.To = 0; 
    scaleAnimation.Duration = new Duration(new TimeSpan(0, 0, 0, 0, 500));
    ScaleTransform transform = (ScaleTransform)item.LayoutTransform;
    transform.BeginAnimation(ScaleTransform.ScaleYProperty, scaleAnimation); 
```

问题是，它根本不起作用。该项目仍然只是弹出。调用该方法时该项目仍然存在，所以它不应该在它消失之前播放动画吗？还是我做错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-12T19:27:56.237

我通过向绑定项目添加 IsRemoved 属性解决了这个问题。然后绑定 ListViewItem 容器模板中的事件触发器，当此 bool 更改为 true 时播放删除动画。同时，Task 以与动画持续时间匹配的 Task.Delay(n) 启动，然后从集合中实际删除。请注意，此删除需要分派给拥有该列表的线程以避免跨线程异常。

```
void Remove(MyItem item, IList<MyItem> list)
{
    item.IsRemoved = true;

    Task.Factory.StartNew(() =>
        {
            Task.Delay(ANIMATION_LENGTH_MS);
            Dispatcher.Invoke(new Action(() => list.Remove(item)));
        });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T13:06:37.063

我目前无法访问代码窗口，所以这有点过时了，但是您可以使用 Unloading 事件扩展 FrameworkElement，然后从 ObservableCollection 中的 CollectionChanged 启动它。这意味着使用自定义 ObservableColleciton 和自定义 FrameworkElement 类，但它可以为您提供所需的东西？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T11:47:34.967

事实证明，即使我在删除它们之前提出了一个事件，它们也会立即被删除。因此，当我将它用作可观察堆栈时，我通过将已删除的元素留在集合中并稍后将其删除来解决此问题。像这样：

```
public class ObservableStack<T> : ObservableCollection<T> 
{
    private T collapsed;
    public event EventHandler BeforePop;

    public T Peek() {
        if (collapsed != null) {
            Remove(collapsed);
            collapsed = default(T);
        }
        return this.FirstOrDefault();
    }

    public T Pop() {
        if (collapsed != null) { Remove(collapsed); }
        T result = (collapsed = this.FirstOrDefault());
        if (BeforePop != null && result != null) BeforePop(this, new EventArgs());
        return result;
    }

    public void Push(T item) {
        if (collapsed != null) {
            Remove(collapsed);
            collapsed = default(T);
        }
        Insert(0, item);
    }
} 
```

可能不是最好的解决方案，但它可以完成工作（至少如果我只将它用作堆栈）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-13T04:54:59.023

您可以使用 Present.Commands Fluent API 在命令执行期间更改视觉状态。我在这里发布了一个使用它在列表框中添加和删除项目的动画示例 [http://adammills.wordpress.com/2011/01/11/mvvm-animation-of-listbox-present-commands/](http://adammills.wordpress.com/2011/01/11/mvvm-animation-of-listbox-present-commands/)

# c# - 使用 ReSharper 更新命名空间的最快方法？

> ID：791253
> 
> 赞同：76
> 
> 时间：2009-04-26T17:37:52.140
> 
> 标签：c#, resharper

我一直在进行一些重构和重组，并且已经移动了一堆文件。

我想更新每个文件，使其根据其新位置具有“正确”的命名空间。使用 ReSharper，我可以进入每个文件，它向我显示命名空间不正确，但这样我必须一次处理每个文件。

无论如何要更新文件夹或项目中每个文件的名称空间？

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2010-07-05T13:03:35.210

**更新：使用 R#5.0 及更高版本阅读此问题的任何人都应注意，[这现在是一项功能](http://www.jetbrains.com/resharper/webhelp/Refactorings__Adjust_Namespaces.html)：**

ReSharper -> 重构 -> 调整命名空间...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T14:32:20.900

这不是您想要做的......但希望它会有所帮助。

转到类视图，然后使用 Ctrl+R,R 重命名命名空间。它将在所有使用它的文件/文件夹中更新该名称空间。只要您的名称空间是一致的，它应该会获得与更改文件夹中的所有名称空间相同的结果。

如果您的命名空间不一致，并且您只是在整理，那么恐怕您面前有很多点击（或者您可能已经这样做了）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T17:48:14.953

我认为 R# 没有这个功能。您可以使用 CTRL-SHIFT-H 查找和替换字符串。

# c# - 你如何存根 IQueryable .哪里（功能 ) 与犀牛模拟？

> ID：791256
> 
> 赞同：6
> 
> 时间：2009-04-26T17:40:18.983
> 
> 标签：c#, unit-testing, nunit, rhino-mocks, iqueryable

在我现在正在处理的 .net 3.5 项目中，我正在为服务类编写一些测试。

```
public class ServiceClass : IServiceClass
{
     private readonly IRepository _repository;

     public ServiceClass(IRepository repository)
     {
          _repository = repository;
     }

     #region IServiceClass Members

     public IEnumerable<ActionType> GetAvailableActions()
     {
         IQueryable<ActionType> actionTypeQuery = _repository.Query<ActionType>();
         return actionTypeQuery.Where(x => x.Name == "debug").AsEnumerable();
     }

     #endregion
} 
```

我很难弄清楚如何存根或模拟

```
actionTypeQuery.Where(x => x.Name == "debug") 
```

部分。

这是我到目前为止得到的：

```
[TestFixture]
public class ServiceClassTester
{
    private ServiceClass _service;
    private IRepository _repository;
    private IQueryable<ActionType> _actionQuery;
    [SetUp]
    public void SetUp()
    {
        _repository = MockRepository.GenerateMock<IRepository>();
        _service = new ServiceClass(_repository);
    }

    [Test]
    public void heres_a_test()
    {
        _actionQuery = MockRepository.GenerateStub<IQueryable<ActionType>>();

        _repository.Expect(x => x.Query<ActionType>()).Return(_actionQuery);
        _actionQuery.Expect(x => x.Where(y => y.Name == "debug")).Return(_actionQuery);

        _service.GetAvailableActions();

        _repository.VerifyAllExpectations();
        _actionQuery.VerifyAllExpectations();
    }

} 
```

[注：类名已更改以保护无辜]

但这失败`System.NullReferenceException`了

```
_actionQuery.Expect(x => x.Where(y => y.Name == "debug")).Return(_actionQuery); 
```

所以我的问题是：

如何使用 RhinoMocks 模拟或存根 IQueryable.Where 函数并让此测试通过？

如果我当前的设置不允许我模拟或存根 IQueryable，那么请给出合理的解释。

感谢您阅读这个冗长的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T17:52:15.180

在不使用 Rhino 模拟的情况下，您可以创建一个 List，然后在其上调用 .AsQueryable()。例如

```
var actionTypeList = new List<ActionType>() {
    new ActionType {},  //put your fake data here
    new ActionType {}
};

var actionTypeRepo = actionTypeList.AsQueryable(); 
```

这至少会给你一个假的存储库，但它不会让你验证方法是否被调用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-27T00:26:58.990

`Where`是扩展方法，这不是接口 IQueriable 实现的方法。查看 IQueriable 的成员：http: [//msdn.microsoft.com/en-us/library/system.linq.iqueryable_members.aspx](http://msdn.microsoft.com/en-us/library/system.linq.iqueryable_members.aspx)

扩展方法是静态的，不能被模拟。IMO，没有必要 mock `Where`，因为它是语言的一部分。您应该只模拟存储库。

编辑，示例：

```
[TestFixture]
public class ServiceClassTester
{
    private ServiceClass _service;
    private IRepository _repository;
    private IQueryable<ActionType> _actionQuery;

    [SetUp]
    public void SetUp()
    {
        _service = new ServiceClass(_repository);

        // set up the actions. There is probably a more elegant way than this.
        _actionQuery = (new List<ActionType>() { ActionA, ActionB }).AsQueryable();

        // setup the repository
        _repository = MockRepository.GenerateMock<IRepository>();
        _repository.Stub(x => x.Query<ActionType>()).Return(_actionQuery);
    }

    [Test]
    public void heres_a_test()
    {
        // act
        var actions = _service.GetAvailableActions();

        // assert
        Assert.AreEqual(1, actions.Count());
        // more asserts on he result of the tested method
    }

} 
```

注意：您不需要期待调用，因为您的方法取决于模拟的返回值。如果它不调用它，它将在断言上失败。这使您的测试更易于维护。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-27T00:51:58.570

我最初也想模拟像“IQueryable.Where(Func)”这样的调用，但我认为它是在错误的级别进行测试。相反，在我的测试中，我只是模拟了 IQueryable 然后检查结果：

```
// Setup a dummy list that will be filtered, queried, etc
var actionList = new List<ActionType>()
{
    new ActionType() { Name = "debug" },
    new ActionType() { Name = "other" }
};
_repository.Expect(x => x.Query<ActionType>()).Return(actionList);

var result = _service.GetAvailableActions().ToList();

// Check the logic of GetAvailableActions returns the correct subset 
// of actionList, etc:
Assert.That(result.Length, Is.EqualTo(1));
Assert.That(result[0], Is.EqualTo(actionList[0]);

_repository.VerifyAllExpectations(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T20:12:59.623

我有类似的问题，我试图将谓词表达式存根到包含字符串的 Find-method，但 String 是引用类型，当然是不可变的。在我创建 testPredicate 之前没有成功，我将其传递给存根、实际 SUT 并最终断言。下面的代码有效。

```
 [Test()]
    public void Search_Apartment_With_Spesific_Address()
    {
        //ARRANGE
        var repositoryMock = MockRepository.GenerateMock<IApartmentRepository>();
        var notificationMock = MockRepository.GenerateMock<INotificationService>();
        var service = new ApartmentService(repositoryMock, notificationMock);
        var apartment = new List<Apartment> {new Apartment {Address = "Elm Street 2"}}.AsQueryable();

        Expression<Func<Apartment, bool>> testPredicate = a => a.Address == "Elm Street 2";
        repositoryMock.Stub(x => x.Find(testPredicate)).Return(apartment);

        //ACT
        service.Find(testPredicate);

        //ASSERT
        repositoryMock.AssertWasCalled(x => x.Find(testPredicate));
    } 
```

# c++ - 在 C++ 中从整数中插入和删除逗号

> ID：791258
> 
> 赞同：6
> 
> 时间：2009-04-26T17:41:17.187
> 
> 标签：c++

这里非常菜鸟，所以最好假设我对任何答案一无所知。

我一直在写一个小应用程序，它运行良好，但可读性对我的数字来说是一场噩梦。

本质上，我要做的就是在屏幕上显示的数字中添加逗号，以使其更易于阅读。有没有一种快速简便的方法来做到这一点？

我一直在使用 stringstream 来获取我的数字（我不确定为什么此时甚至建议这样做，在我完成的教程中只是建议这样做），例如（裁剪掉不相关的位）：

```
#include <iostream>
#include <string>
#include <sstream>
using namespace std;

int items;
string stringcheck;

...

    cout << "Enter how many items you have: ";
        getline (cin, stringcheck);
        stringstream(stringcheck) >> items;

...

    cout << "\nYou have " << items << " items.\n"; 
```

当该数字被输入为大的数字时，除此之外，阅读起来就变得非常令人头疼。

有什么快速简便的方法可以让它打印“13,653,456”而不是像现在这样的“13653456”（当然，假设这是输入的内容）？

注意：如果重要的话，我将把它作为 Microsoft Visual C++ 2008 Express Edition 中的控制台应用程序。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-26T17:44:01.610

尝试[`numpunct`](http://en.cppreference.com/w/cpp/locale/numpunct)切面并重载[`do_thousands_sep`](http://en.cppreference.com/w/cpp/locale/numpunct/thousands_sep)函数。有一个[例子](http://en.cppreference.com/w/cpp/locale/numpunct/thousands_sep#Example)。我还破解了一些可以解决您的问题的东西：

```
#include <locale>
#include <iostream>

class my_numpunct: public std::numpunct<char> {
    std::string do_grouping() const { return "\3"; }
}; 

int main() {
    std::locale nl(std::locale(), new my_numpunct); 
    std::cout.imbue(nl);
    std::cout << 1000000 << "\n"; // does not use thousands' separators
    std::cout.imbue(std::locale());
    std::cout << 1000000 << "\n"; // uses thousands' separators
} 
```

# asp.net - RegularExpressionValidator 不检测空字符串

> ID：791260
> 
> 赞同：12
> 
> 时间：2009-04-26T17:43:00.020
> 
> 标签：asp.net

我将以下正则表达式设置为`ValidationExpression`Web 表单中 RegularExpressionValidator 的属性。当我在验证控件中输入非法字符时，验证器会检测到它并显示错误消息。

```
<appSettings>
  <add key="categoryPattern" value="^[a-zA-Z0-9_+\-() ]{1,50}$" />
</appSettings> 
```

我的验证器：

```
<asp:RegularExpressionValidator ValidationExpression="<%$ AppSettings:categoryPattern %>" 
```

我的服务器端验证：

```
Regex rex = new Regex(ConfigurationManager.AppSettings["categoryPattern"]);
if (!rex.Match(categoryName).Success)
{
    throw new ArgumentException("CategoryName must match expression: " + rex); 
```

如您所见，客户端和服务器端应用了完全相同的模式。

但是，当我清除已验证的控件并提交一个空字符串时，验证器认为没问题，并且我从服务器端验证中收到错误消息。任何人都知道这里出了什么问题，除了 RegularExpressionValidator 的合同损坏？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-26T17:46:22.947

这是设计使然。您还应该添加一个`RequiredFieldValidator`强制用户输入。`RegularExpressionValidator`假定空字段是有效的（甚至不运行它们`Regex`）。这背后的原因是，例如，您可能`Email address 2`在表单中有一个不需要的可选字段，但如果输入了它，它应该是一个有效的电子邮件地址。为了轻松实现这一点，其他验证器会忽略空字段，如果您需要它们，您只需添加另一个`RequiredFieldValidator`.

事实上，没有必要在服务器上**手动重新验证。**ASP.NET 验证器还支持构建它的服务器端验证。你可以只检查`Page.IsValid`财产。

# c# - WPF自定义错误处理对话框？

> ID：791270
> 
> 赞同：10
> 
> 时间：2009-04-26T17:48:08.217
> 
> 标签：c#, wpf, exception, error-handling

我正在尝试设置我的 WPF 应用程序，以便在未处理异常时弹出错误对话框。在好的 ol' WinForms 中，这可以通过添加

```
Application.ThreadException += new System.Threading.ThreadExceptionEventHandler(Application_ThreadException); 
```

到您的 Program.cs 文件，然后在事件处理代码中显示您想要的任何对话框。在 WPF 中，我尝试使用

```
app.Dispatcher.UnhandledException += new System.Windows.Threading.DispatcherUnhandledExceptionEventHandler(Dispatcher_UnhandledException); 
```

但是，当我在错误处理自定义窗口上使用 Show() 时，应用程序会立即转到“blahblah.exe 已停止工作...”并关闭。如果我使用 ShowDialog()，则该窗口在关闭之前一直可用，然后弹出相同的“...已停止工作...”对话框并消失。

在 WinForms 中，关闭任何错误对话框似乎会允许应用程序继续运行，具体取决于异常的严重程度。我似乎无法弄清楚如何在 WPF 中正确执行此操作。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-26T17:58:13.963

您需要在 EventArgs 中将 Handled 设置为 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-06T17:05:01.867

在 Aplication.xaml.vb 中，这个文件有很多方法可以帮助他们，故事板和其他东西，你需要在这个文件中类似的东西。对我有用，希望对你有用

```
Private Sub Application_DispatcherUnhandledException(ByVal sender As Object, ByVal e As System.Windows.Threading.DispatcherUnhandledExceptionEventArgs) Handles Me.DispatcherUnhandledException

        Dim lWinError As New winError("Ocurrio un error no controlado en la aplicacion")
        lWinError.ShowDialog()
        e.Handled = True
    End Sub 
```

# sql - 将返回表中最早日期和最晚日期的 TSQL 查询

> ID：791279
> 
> 赞同：1
> 
> 时间：2009-04-26T17:53:39.123
> 
> 标签：sql, sql-server, tsql, sql-server-2008

我在 sql server 2008 数据库中有一个表，其中包含一堆记录以及一个日期列。当表格中出现新条目时，日期会自动插入。因此，它包含已创建记录的日期。

我正在尝试运行一个查询，该查询将返回此表中的最早日期和最晚日期。

我尝试过类似的东西；

```
SELECT    TOP(1) DateAdded AS firstdate 
FROM      News 
ORDER BY  DateAdded DESC;  

SELECT    TOP(1) DateAdded AS lastdate 
FROM      News 
ORDER BY  DateAdded ASC; 
```

但它只返回'firstdate'。

谁能指导我如何实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T17:57:09.193

```
SELECT 
       MIN(DateAdded) As FirstDate,
       MAX(DateAdded) As LastDate
FROM
       News; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T17:58:29.983

答案是使用聚合。

```
SELECT
    MIN(DateAdded) AS firstdate,
    MAX(DateAdded) AS lastdate
FROM
    News; 
```

您的查询返回 2 个结果：虽然每个结果都单独工作

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-09T09:59:18.513

你可以使用这样的东西：

```
 select DateAdded     from (SELECT DateAdded,
           row_number() over (order by DateAdded desc) as rn,
           count(*) over () as added_value
    FROM News
) t
where rn = 1
   or rn = added_value
ORDER BY DateAdded DESC 
```

# web-services - 用于 Web 服务的 IDE 的功能

> ID：791284
> 
> 赞同：1
> 
> 时间：2009-04-26T17:58:15.087
> 
> 标签：web-services, ide, soa

IDE 中有哪些面向服务的架构/Web 服务功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T18:11:16.320

许多 IDE 只是让您输入 Web 服务的 URL 并通过单击按钮自动生成客户端代理。这意味着您还可以获得 Web 服务的智能感知 - 但即使您以其他方式生成服务，通常也会出现这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T17:40:04.800

如果您谈论的是 Java Web 服务，我建议您查看 Eclipse Web 工具平台。 [http://www.eclipse.org/webtools/](http://www.eclipse.org/webtools/)

有一些 Web 服务向导可以自顶向下（从 wsdl 文件）自底向上（从 java bean）生成服务，也可以从 WSDL 生成客户端代理。还有“Web Services Explorer”，它可以让您在不生成客户端的情况下测试 Web 服务，还可以让您搜索和发布到 UDDI 注册中心。

# sqlite - SQLite - 复杂的查询

> ID：791286
> 
> 赞同：2
> 
> 时间：2009-04-26T17:58:59.280
> 
> 标签：sqlite

我使用以下查询从表中获取随机行：

```
SELECT value_id FROM table1 ORDER BY RANDOM() LIMIT 1 
```

我有 3 个表：table1 和 table2 - 它们是具有行 ID 及其值的表。还有 table3，它的列 ID 是 table1 和 table2 中的行 ID。

IE ：

```
table1:
1 - Canada
2 - USA
3 - UK
4 - France
5 - Africa
6 - China

table2:
1 - New York
2 - Vancouver
3 - Paris
4 - London
5 - Ottawa
6 - Los Angeles

table3: (without table3 rowid)
1 - 2
1 - 5
2 - 1
2 - 6
3 - 4
4 - 3 
```

所以从表 3 中我可以说纽约是美国的一个城市，依此类推。在 table3 中，我也可以有未定义的值。（在示例中它们是非洲和中国，所以我不想让它们出现在结果中）

我想要做的是从 table1 中获取随机 ID，但只有在 table3 中定义的那些。在这种特殊情况下，我不想收到 5 和 6 结果。

如何重写我的查询以实现我的目标？

先感谢您。

编辑：问题是，当我试图获取 table3 中未定义的行时，应用程序会出现问题。它不是 NULL，正如我之前写的，它只是在 table3 中不存在。如何重写查询以正确处理我的案例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T18:08:34.033

您还没有告诉我们其中的字段`table3`是如何命名的，但是假设它们被命名`tab1_id`并且`tab2_id`具有明显的含义，请尝试：

```
SELECT table1.value_id 
FROM table1 INNER JOIN table3 ON table1.value_id=table3.tab1_id
WHERE table3.tab2_id IS NOT NULL
ORDER BY RANDOM() LIMIT 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T18:17:47.753

Order by Random() 意味着它将按不同的列随机排序。

用这个：

```
SELECT value_id FROM table3
  WHERE rowid>=random() % (SELECT max(rowid) FROM table3) 
  AND second_value IS NOT NULL
  LIMIT 1; 
```

不知道 column2 的名称，所以我称它为 second_value

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T18:08:24.517

不是 SQLite 问题，而是通用 SQL 问题。您想在字段值中测试 NULL，例如

```
SELECT f1 FROM table
 WHERE f2 IS NOT NULL
ORDER BY RANDOM() LIMIT 1; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T20:45:41.627

```
SELECT rowid FROM table1
WHERE rowid IN ( SELECT DISTINCT table1_id FROM table3 )
ORDER BY RANDOM() LIMIT 1; 
```

这个查询的意思是“随机选择一行，`table1`其中有一个条目`table3`”。

表 1 中的每一行都具有被选中的可能性 ( `DISTINCT`)，只要它在 中至少被引用一次`table3`。

如果您试图从 table1 中获取 table3 中的所有列，那么您应该删除 " `ORDER BY RANDOM() LIMIT 1`" 子句。

# c# - 关系数据库和面向对象语言

> ID：791291
> 
> 赞同：2
> 
> 时间：2009-04-26T18:02:20.350
> 
> 标签：c#, .net, linq

在典型的 ASP.NET Web 应用程序体系结构中，我们使用诸如 C# 之类的 OO 语言和诸如 SQL Server 之类的关系数据库来存储数据。

我正在读一本关于 Linq 的书，上面写着“问题是 OO 编程语言和关系数据库之间存在差距”

作者到底想暗示什么？

**编辑：感谢您的回答。我不确定我是否理解 LINQ 将如何解决这个问题。我可能错了，但似乎 LINQ 是用于数据库通信的 API，就像 ADO.NET**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T18:10:32.297

它们是非常不同的数据模型和做事方式。这是一个相当宗教的论点，没有给予任何回报，也没有预期的怜悯。

都在这里：[对象关系阻抗失配](http://en.wikipedia.org/wiki/Object-Relational_impedance_mismatch)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T18:21:11.567

面向对象编程是关于有效地建模行为。关系模型是关于有效地建模数据。

这导致了非常不同的模型，这些模型在某些领域是不兼容的。这称为对象关系阻抗失配。[谷歌它](http://www.google.nl/search?hl=nl&lr=&rlz=1G1GGLQ_NLNL278&ei=6aX0ScKdMMTI-AaohbGdDw&sa=X&oi=spell&resnum=0&ct=result&cd=1&q=object+relational+impedance+mismatch&spell=1)。

Ted Neward 就此写了一篇相当不错的文章，名为[《计算机科学的越南》](http://blogs.tedneward.com/2006/06/26/The+Vietnam+Of+Computer+Science.aspx)。如果你愿意，你可以忽略大部分越南部分。

至于 LINQ 如何融入等式：它并没有解决不匹配问题，但它提供了一种使与数据库的通信更容易的方法，至少减轻了部分痛苦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T18:17:04.823

RDBMS 的基石之一是规范化——就我的观点而言，同一位数据永远不会超过一个位置。

使用对象可以合理地假设您的 SalesInvoice obj 可能由多个发票行对象和客户对象、交货地址等以及与之配套的方法组成。

在一个和另一个之间跳跃是困难的。以收货地址为例，我们是否将其存储在销售发票表中，如果与客户相同怎么办，如果不同怎么办？我们有送货地址表吗？

它是一个复杂的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T18:04:03.450

[http://en.wikipedia.org/wiki/Object-relational_mapping#Problem_description](http://en.wikipedia.org/wiki/Object-relational_mapping#Problem_description)

# c# - 如何使用 C# 在 Excel 图表上切换行/列？

> ID：791293
> 
> 赞同：3
> 
> 时间：2009-04-26T18:05:56.783
> 
> 标签：c#, excel, excel-2007

我希望图表的系列名称显示为我的信息的列名称。这在我有超过 1 列时有效，但是当只有 1 列信息时，它似乎将系列名称设置为数字 1。

我在 Excel 中手动复制了它，它似乎假设列名是图表的名称。绕过它的方法似乎进入“选择数据”选项，然后选择“切换行/列”选项。

因此我的问题是，如何使用 C# 复制此选项？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-04T16:19:35.990

想通了这一点-在设置图表信息的来源时，您需要将`PlotBy`参数指定为`xlRows`. 我正在传递，`Type.Missing`因此它默认为`xlColumns`例如

```
Excel.ChartObject.SetSourceData(chartRange, Excel.xlRowCol.xlRows); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T15:47:51.137

这是我在代码中解决问题的一点。我仍在使用 Excel 2003。但以防万一这有帮助：

```
if(Chart.HasTitle)
    Chart.ChartTitle.Text = "";  //Excel put a title on the chart when there's only one series. 
```

# java - 修复 Java 中的流程布局

> ID：791301
> 
> 赞同：0
> 
> 时间：2009-04-26T18:08:43.673
> 
> 标签：java, layout, jframe

嗨，我已经用 Java 为我的程序创建了一个 GUI，并且我使用了 flowlayout（对borderlayout 没有太多的运气），但是如果用户调整程序的大小，使用 flowlayout，一切都会失去对齐，所以我想知道是否存在阻止程序的框架被调整大小？如果是这样怎么办？

谢谢你

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T18:14:45.467

JFrame::setResizable(假)

但这是不好的做法；您需要调查其他布局并可能使用多种布局来实现您的目标。见[这里](http://java.sun.com/docs/books/tutorial/uiswing/layout/visual.html)。

见[api](http://java.sun.com/javase/6/docs/api/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T18:14:59.977

为了停止一个`JFrame`或`JDialog`所有你需要做的就是调用`setResizable(false)`你的框架或对话框上的方法。

您可以在构造函数中执行此操作，例如：

```
public YourWindowNAme(){
    // stuff
    setResizable(false);
    // more stuff
} 
```

或者它可以被称为外部，如：

```
instanceOfYourWindow.setResizable(false); 
```

[这](http://java.sun.com/javase/6/docs/api/java/awt/Frame.html#setResizable(boolean))是该方法的 API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T18:35:58.333

当您有更好的时间时，您可能会感兴趣：http: [//www.netbeans.org/files/documents/4/475/matisse.html](http://www.netbeans.org/files/documents/4/475/matisse.html)

它是 Netbeans 6 附带的新布局管理器。

# java - 如何从 Java.awt.print.PrinterJob 获取 PageFormat

> ID：791306
> 
> 赞同：0
> 
> 时间：2009-04-26T18:13:23.350
> 
> 标签：java, swing, printing, dimensions

我正在尝试使用 PageFormat 信息在打印之前修改基于 javax.swing 的打印输出。我对如何从 PrintJob（使用 getPrinterJob() 和 printDialog() 获得）获取 PageFormat 感到困惑。我知道有 getPageFormat 方法，但我不知道如何获取 PrintRequestAttributeSet（它不是 printJob.getPrintService().getPrintAttributes()）。老实说，我真正想知道的是页面的宽度和高度。关于我如何做到这一点的任何想法？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-12-01T20:14:53.190

运行“假”打印作业的方法是行不通的，至少从长远来看是这样。我尝试过这个。起初效果很好……然后一些客户开始报告奇怪的行为。

事实证明，对于**某些**打印机和某些配置，即使是“假”作业也会导致打印机出现活动。没有打印文档页面，但队列活动、作业标题页，有时还有一些垃圾输出（我记得）。在某些情况下，伪造的队列条目足以干扰正常打印，并使用户感到困惑。

是的，提前获取 PageFormat 是一件很痛苦的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T21:50:15.433

~~如果您只需要页面宽度和高度，我认为 PageFormat.getImageableWidth() 和 PageFormat.getImageableHeight() 就是您要找的。~~

抱歉，这不是你想要的。这对于黑客来说怎么样：

```
printable.setFakeJob(true);
job.print();
printable.setFakeJob(false);
job.print(); 
```

在您的可打印文件中，

```
public int print(Graphics graphics, PageFormat pf, int pageIndex) {
    if (isFakeJob()) {
        /* use passed-in PageFormat to set up whatever you need to set up */
        return NO_SUCH_PAGE;
    } else {
        /* do your actual printing */
    }
} 
```

不漂亮，诚然。

# html - 将 HTML 转换为纯文本？

> ID：791311
> 
> 赞同：0
> 
> 时间：2009-04-26T18:16:51.640
> 
> 标签：html, imap, exchange-server, exchange-server-2003

我可以使用 Lumisoft 的 IMAP 客户端从 Microsoft Exchange 读取电子邮件。我已设置交换服务器设置以将任何邮件转换为纯文本。但是，当我阅读信息时，它似乎仍然包含 HTML/CSS。

从电子邮件正文中删除 HTML/CSS 的最佳方法是什么？或者我似乎错过了交换服务器上的设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T21:17:32.487

我通常采用其中一种方法...

1.  使用正则表达式。如果您必须想出一个也适用于各种无效标记的解决方案，那么要做到正确可能有点困难，但我敢打赌，其他人在您之前已经做到了（提示：谷歌或搜索 SO）。

2.  使用 HTML 解析器库。您可以在那里找到任何流行的编程语言。我推荐使用 Html Agility Pack。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T22:30:53.073

我不确定您的设置是如何工作的，是否可以运行脚本等。显然，HTML 解析器将是解析 HTML 的最佳方式。例如，使用 Hpricot（一个 Ruby HTML 解析库），您可以`puts doc.find_element('body').inner_text`打印文档的文本内容。

# python - 在键相等的情况下按键和值排序

> ID：791316
> 
> 赞同：1
> 
> 时间：2009-04-26T18:19:29.433
> 
> 标签：python, sorting, oauth

[官方 oauth 指南](http://www.hueniverse.com/hueniverse/2008/10/beginners-gui-1.html)提出了以下建议：

> 重要的是不要尝试对名称和值的组合字符串执行排序操作，因为某些已知的分隔符（例如'='）会由于它们对字符串值的影响而导致排序顺序发生变化。

如果是这种情况，那么这样做的有效方法是什么？初始排序后的第二次迭代寻找相等的键？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T18:27:11.663

只需对元组列表（名称、值）进行排序——Python 会为您进行字典排序。

# iphone - 保留周期：为什么这是一件坏事？

> ID：791322
> 
> 赞同：10
> 
> 时间：2009-04-26T18:25:27.643
> 
> 标签：iphone, cocoa-touch, memory-management

有两个对象 A 和 B。A 创建 B 并保留它。B 有一个指向 A 的实例变量，并保留它。所以双方互相挽留。有人说，这种牢固的联系再也不能断了。

但真的是这样吗？

如果 B 将释放 A，那么 A 可以轻松释放 B，因此 B 将被释放。A 将在它的其他所有者（我想肯定有人）释放它后立即被释放。

还是这个问题只适用于 A 不创建 B，而只是通过将它保留在实例变量中来保持对它的强引用的情况？我仍然不明白为什么不能再次打破这种联系。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-26T18:50:22.543

循环还不错，但它们经常被避免，因为它们会使确保您没有内存泄漏变得很棘手。尤其是当对象被“引用计数”时，就会发生泄漏。在使用引用计数的语言或系统中，对象会跟踪指向它的引用的数量。每次删除引用时，计数都会减少，当计数为零时，没有引用，因此可以删除对象。

这通常会自行处理，无需任何仔细考虑即可正常工作。如果你有一组没有循环的对象并且你删除了对根对象的引用，那么它将被删除，这意味着它对它拥有的对象的引用将被删除，被引用的对象将有它们的引用计数归零。它们将被删除，级联将导致所有对象被删除。

但是......如果你有一个循环，这个级联不起作用。您可能有一组对象并且您不再需要它们，因此您删除了对这些对象的唯一引用，但是因为存在一个循环对象相互引用。这意味着它们的引用计数永远不会归零，也不会被删除。这是内存泄漏。

显然，您可以在放弃对不再需要的一组对象的引用之前进行一些仔细的管理并打破循环。但是……正如我刚才所说，这需要仔细管理。很容易出错。这是发生内存泄漏的主要原因之一。

当您不再需要一组对象时，为了避免泄漏风险和正确打破循环的棘手工作，程序员通常会尽量避免循环。在没有人了解整个系统的许多程序员的大型项目中，这一点变得更加重要。如果有循环，程序员将不得不小心并花很长时间研究彼此的代码以避免循环。

一些带有垃圾收集器的语言（例如 C#）可以删除一组不再需要的对象，即使该组包含循环。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-26T18:50:38.783

如果您知道，可以打破保留周期。通常它会导致讨厌的错误（内存泄漏）。在您的示例中：

```
A* a = [[A alloc] initAndCreateB]; 
```

现在，一个未命名的 B 实例（由 A 创建）的保留计数为 1。由于我们持有对 A 的引用，而匿名 B 实例持有对 A 的强引用，因此 A 的保留计数为 2。

假设我们使用 A 完成：

```
[a release];
return 12; 
```

现在，A 的保留计数为 1。它不会被释放，它的内存丢失了。这就是保留周期不好的原因。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-26T23:21:24.420

打破保留循环的方法是有一个单独的“关闭”方法。

IE

```
A retains B
B retains A 
```

完成后，在 A 释放 B 的 A 上调用一个方法（我将其称为“ `close`”）。然后您可以释放 A，整个循环将释放（假设其他地方没有保留）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-26T18:50:15.023

问题是这样的：A指向并保留B，B指向并保留A。当没有其他对A或B的引用时，将无法释放它们，因为您的应用程序没有任何引用他们当时。这称为引用循环，它是任何引用计数系统中常见的一种内存泄漏。在大多数高级语言中解决此问题的方法是使用垃圾收集而不是引用计数。

# asp.net - 看不到我在网站中使用的图片

> ID：791323
> 
> 赞同：0
> 
> 时间：2009-04-26T18:26:47.233
> 
> 标签：asp.net, master-pages

我为我的网站使用模板，并用图像控件填充其单元格并使用图片的 URl 设置它，但是当我上传我的网站时，我看不到该图片。

我为所有图像创建了一个新文件夹，并为此网站使用母版页。

链接：[http ://www.aaaa.ir/az/](http://www.aalaa.ir/az/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-26T18:32:06.097

请包含显示 ImageUrl 路径的 ASP.NET 代码。如果图像的路径不正确，就会发生这种情况。尝试使用“~”格式化路径。像这样：

```
<asp:Image runat="server" ImageUrl="~/image/header.jpg" /> 
```

代替：

```
<asp:Image runat="server" ImageUrl="image/header.jpg" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T18:36:15.150

MasterPages 通常需要对 URL 和路径进行特殊处理。这称为 URL 变基。您以波浪字符 (~) 开始路径以引用网站的根目录。

查看网页的源代码，这是 ASP.Net 提供的图像标签之一：

```
src="Image/Logo%2004.jpg" 
```

因此，尝试在开头添加“~/”，如下所示：

```
src="~/Image/Logo%2004.jpg" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T18:49:33.090

您的图像文件夹中没有图像...

[http://www.aaaa.ir/az/image/](http://www.aalaa.ir/az/image/)

# svn - 使用 SVNSERVE 托管 Subversion 服务器、配置文件等

> ID：791324
> 
> 赞同：1
> 
> 时间：2009-04-26T18:26:53.833
> 
> 标签：svn, multiple-repositories

我有一个 SVNSERVE 服务器设置为托管多个存储库。

**简短的问题在这里**

我的问题实际上是这样的：我在存储库之外的主目录中有 authz、passwd 和 svnserve.conf，这似乎有效，因为这里的更改将给予或拒绝对相关存储库的访问。

但是，由于使用 TeamCity 时出现错误，我发现每个存储库也有自己的这些文件集，但那里的内容几乎完全是空的。我是否需要将主要配置文件的相关部分复制到每个存储库中？

* * *

**暂定解决方案**

好的，看来我在下面链接到的网页（[此页面](http://www.digitalsanctum.com/2007/04/25/svn-not-authorized-to-open-root-of-edit-operation/)）毕竟是正确的。通过编辑存储库本地`svnserve.conf`文件，并添加单行：

```
anon-access=none 
```

然后它似乎工作。请注意，这也是我所做的一切。主要的、全局的、存储库外的`svnserve.conf`文件和相关文件似乎仍然包含所有相关信息，因为此处的更改仍然允许或拒绝用户访问存储库，但添加该行使 TeamCity 停止抱怨。

再次删除线路后立即运行控制测试，看看它是否仍然失败。

* * *

**这里长篇大论**

目录结构是这样的：

```
E:
 +-- Repositories
     +-- LVK
     +-- PrivateProjects
     +-- ExternalProjects
     +-- XYZ
     +-- etc. 
```

现在，我在 Repositories 目录中，有以下文件（文件内容如下）：

```
svnserve.conf
authz
passwd 
```

svnserve.conf 看起来像这样：

```
[general]
password-db=passwd
authz-db=authz
realm=VKarlsen Subversion Server
anon-access=read
auth-access=write 
```

authz 看起来像这样：

```
[/]
lassevk=rw
*=r

[LVK:/]
lassevk=rw
*=r

[PresentationMode:/]
lassevk=rw
*= 
```

和其他一些存储库等。

和 passwd 看起来像这样（但显然不是正确的密码）：

```
[users]
lassevk=MYSECRETPASSWORD 
```

现在，我想知道的是，TeamCity 正在抱怨一条错误消息：“root 'svn://localhost/PrivateProjects/VS.NET/LVK_ReleaseScript' #2: svn: Not authorized to open root编辑操作”。

[我在这里](http://www.digitalsanctum.com/2007/04/25/svn-not-authorized-to-open-root-of-edit-operation/)找到了这个页面，但它说要确保你的 svnserve.conf 文件中有以下内容：

```
anon-access=none 
```

但是，我确实`anon-access=read`在文件中有，但我的问题实际上是这样的：每个存储库也有一个 conf 子目录，其中包含与上面完全相同的文件，只是内容不同。事实上，除了将 Realm 值设置为与我的主 svnserve.conf 文件相同的值之外，这些文件完全是空的。

它是否正确？我是否需要将主 svnserve.conf 文件中的相关点点滴滴复制到每个存储库的配置文件中？

例如，这是 LVK 存储库下三个文件的内容：

授权：

```
[groups]

[/] 
```

密码：

```
[users] 
```

svnserve.conf：

```
[general]
realm = VKarlsen Subversion Server 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T20:18:42.347

我一直认为您至少需要在每个存储库`svnserve.conf`的`conf/`子目录中包含（因为 SVN 不会自动知道在其他任何地方查找它）。这是我在自己的存储库中使用的设置：每个存储库都有自己的副本`svnserve.conf`，但只有一个全局`passwd`and `authz`，所有`svnserve.conf`文件都通过绝对路径引用。

# operators - 按位补码运算符 (~ tilde) 是如何工作的？

> ID：791328
> 
> 赞同：210
> 
> 时间：2009-04-26T18:29:46.510
> 
> 标签：operators, bitwise-operators, complement

为什么〜2等于-3？运营商是如何`~`工作的？

* * *

## 回答 #1

> 赞同：319
> 
> 时间：2009-04-26T18:35:04.250

请记住，负数存储为正数**的二进制补码**。例如，以下是二进制补码中 -2 的表示：（8 位）

```
1111 1110 
```

你得到这个的方法是取一个数字的二进制表示，取它的补码（反转所有位）并加一。两个从 0000 0010 开始，通过反转位我们得到 1111 1101。加一个得到上面的结果。第一位是符号位，表示负数。

那么让我们看看我们如何得到~2 = -3：

再来两个：

```
0000 0010 
```

简单地翻转所有位，我们得到：

```
1111 1101 
```

那么，二进制补码中的 -3 是什么样的？从正3开始：0000 0011，将所有位翻转为1111 1100，加一成为负值（-3），1111 1101。

因此，如果您只是将 2 中的位取反，您将得到 -3 的二进制补码表示。

## 补码运算符 (~) 只是翻转位。由机器来解释这些位。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-04-26T18:33:01.570

`~`翻转值中的位。

为什么`~2`与`-3`数字如何按位表示有关。数字表示为[二进制补码](http://en.wikipedia.org/wiki/Two's_complement)。

所以，2是二进制值

```
00000010 
```

~2 翻转位，所以现在的值是：

```
11111101 
```

其中，是-3的二进制表示。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-04-26T20:04:18.450

正如其他人提到的那样`~`，只是翻转了位（将 1 更改为 0，将 0 更改为 1），并且由于使用[了二进制补码](http://en.wikipedia.org/wiki/Two%27s_complement)，因此您得到了所看到的结果。

要添加的一件事是*为什么*使用二进制补码，这是为了使对负数的运算与对正数的运算相同。想像为了得到零`-3`而`3`应该添加的数字，你会看到这个数字是`1101`，记住二进制加法就像小学（十进制）加法一样，只有当你得到 2 而不是 10 .

```
 1101 +
 0011 // 3
    =
10000
    =
 0000 // lose carry bit because integers have a constant number of bits. 
```

因此`1101`，`-3`翻转你得到`0010`的两个位。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-26T20:22:13.617

这个操作是一个补充，而不是一个否定。

考虑 ~0 = -1，然后从那里开始工作。

求反的算法是“补，增”。

你知道吗？还有一个反数*是*对称的“反码”，它同时具有 0 和 -0。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-04-04T18:40:10.493

我知道这个问题的答案是很久以前发布的，但我想分享我的答案。

要找到一个数的补码，首先要找到它的二进制等价物。这里，十进制数以二进制形式`2`表示`0000 0010`。现在通过反转其二进制表示的所有数字（将所有 1 翻转为 0，将所有 0 翻转为 1）来取其一个补码，这将导致：

```
0000 0010 → 1111 1101 
```

这是十进制数2的反码。由于二进制数的第一位，即符号位是1，这意味着它存储的数字的符号为**负**。（这里所指的数字**不是**2，而是 2 的反码）。

现在，由于数字存储为 2 的补码（取一个数字的补码加 1），所以要将这个二进制数 , 显示`1111 1101`为十进制，首先我们需要找到它的 2 的补码，即：

```
1111 1101 → 0000 0010 + 1 → 0000 0011 
```

这是 2 的补码。二进制数 的十进制表示`0000 0011`是`3`。而且，由于符号位如上所述是 1，所以得到的答案是`-3`。

**提示：**如果你仔细阅读这个过程，那么你会发现一个补码运算符的结果实际上是数字（操作数 - 应用此运算符）加上一个负号。您也可以尝试使用其他号码。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-07-14T07:21:27.457

诠释一个= 4; System.out.println(~a); 结果将是：-5

java中任何整数的'~'代表数字的1的补码。例如我取〜4，这意味着二进制表示0100。首先，整数的长度是四个字节，即4 * 8（1字节8位）= 32。所以在系统内存中 4 现在表示为 0000 0000 0000 0000 0000 0000 0000 0100 ~ 运算符将对上述二进制数执行 1 的补码

即1111 1111 1111 1111 1111 1111 1111 1011->1的补码最高有效位表示否的符号（-或+）如果它是1然后符号是'-'如果它是0然后符号是'+'根据这个我们的结果是一个负数，在java中负数以2的补码形式存储，我们必须将获得的结果转换为2的补码（首先执行1的补码，然后将1加到1的补码）。除了最高有效位 1 （这是我们的数字的符号表示）之外，所有 1 都将变为零，这意味着剩余的 31 位 1111 1111 1111 1111 1111 1111 1111 1011 （获得 ~ 运算符的结果） 1000 0000 0000 0000 0000 0000 0000 0100（1 的补码）

## 1（2 的补码）

1000 0000 0000 0000 0000 0000 0000 0101 现在结果是 -5 查看此视频链接 <[Java 中的位操作符] [https://youtu.be/w4pJ4cGWe9Y](https://youtu.be/w4pJ4cGWe9Y)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-12-23T20:04:09.707

简单地 ...........

作为任何数字的 2 的补码，我们可以通过将所有 1 反转为 0 来计算，反之亦然，而不是我们将 1 添加到它。

这里 N= ~N 总是产生结果 -(N+1) 。因为系统以 2 的补码形式存储数据，这意味着它像这样存储 ~N。

```
 ~N = -(~(~N)+1) =-(N+1). 
```

例如：：

```
 N = 10  = 1010
  Than ~N  = 0101
  so ~(~N) = 1010
  so ~(~N) +1 = 1011 
```

现在点是从哪里来的减号。我的观点是假设我们有 32 位寄存器，这意味着 2^31 -1 位参与操作，并保留一位在早期计算（补码）中发生变化的位，通常存储为符号位，通常为 1。我们得到的结果为~10 = -11。

〜（-11）=10；

如果 printf("%d",~0); 以上是真的 我们得到结果：-1;

但是 printf("%u",~0) 比结果： 4294967295 在 32 位机器上。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-09-18T10:36:22.960

* * *

位补运算符 (~) 是一**元运算**符。

它按照以下方法工作

首先它将给定的十进制数转换为其对应的*二进制* 值。即在 2 的情况下，它首先将 2 转换为 0000 0010（到 8 位二进制数）。

然后它将数字中的所有1转换为0，并将所有零转换为1；然后数字将变为1111 1101。

这是 -3 的 2 的补码表示。

为了使用补码找到无符号值，即简单地将 1111 1101 转换为十进制 (=4294967293)，我们可以在打印期间简单地使用 %u。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2021-03-30T17:27:00.127

简单来说，`~`就是求对称值（到-0.5）。

`~a`并且`a`应该在0和-1的中间对称于镜子。

**-5,-4,-3,-2,-1 | 0、1、2、3、4**

```
~0 == -1
~1 == -2
~2 == -3
~3 == -4 
```

其原因在于计算机如何表示负值。

说，如果正值用于`1`计数，负值则使用`0`。

```
1111 1111 == -1

1111 1110 == -2; // add one more '0' to '1111 1111'

1111 1101 == -3; // add one more '0' to '1111 1110' 
```

最后，`~i == -(i+1)`.

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-02-09T04:16:24.313

我认为对于大多数人来说，混淆部分来自十进制数和有符号二进制数之间的差异，所以让我们先澄清一下：

对于人类十进制世界：01 表示 1，-01 表示 -1，对于计算机的二进制世界：101 表示 5，如果它是无符号的。101 表示 (-4 + 1) 如果有符号，而有符号数字位于位置 x。| X

所以 2 的翻转位 = ~2 = ~(010) = 101 = -4 + 1 = -3 混淆来自于混淆了有符号的结果（101=-3）和无符号的结果（101=5）

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-04-30T07:56:55.357

**基本上行动是补充而不是否定。**

**这里 x= ~x 总是产生结果 -(x+1) 。**

x = ~2

**-(2+1)**

-3

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-11-04T18:52:45.657

**tl; dr** `~`翻转位。结果，符号发生了变化。`~2`是负数 ( `0b..101`)。要输出负数，`ruby`请打印:`-`的二进制补码。正数按原样输出。`~2``-(~~2 + 1) == -(2 + 1) == 3`

有一个内部值及其字符串表示形式。对于正整数，它们基本上重合：

```
irb(main):001:0> '%i' % 2
=> "2"
irb(main):002:0> 2
=> 2 
```

后者相当于：

```
irb(main):003:0> 2.to_s
"2" 
```

`~`翻转内部值的位。`2`是`0b010`。`~2`是`0b..101`。两个点 ( `..`) 代表无限个`1`'。由于结果的最高有效位 (MSB) 为`1`，因此结果为负数 ( `(~2).negative? == true`)。要输出负数，`ruby`打印`-`，然后是内部值的二进制补码。二进制补码是通过翻转位，然后添加来计算的`1`。的二进制补码`0b..101`是`3`。像这样：

```
irb(main):005:0> '%b' % 2
=> "10"
irb(main):006:0> '%b' % ~2
=> "..101"
irb(main):007:0> ~2
=> -3 
```

总而言之，它翻转了位，从而改变了符号。要输出一个负数，它会打印`-`，然后是`~~2 + 1`( `~~2 == 2`)。

之所以`ruby`像这样输出负数，是因为它将存储的值视为绝对值的二进制补码。换句话说，存储的是`0b..101`. 这是一个负数，因此它是某个值的二进制补码`x`。要找到`x`，它对 进行二进制补码`0b..101`。是 的补码的补码`x`。这是`x`（例如`~(~2 + 1) + 1 == 2`）。

如果您应用于`~`负数，它只会翻转位（但会改变符号）：

```
irb(main):008:0> '%b' % -3
=> "..101"
irb(main):009:0> '%b' % ~-3
=> "10"
irb(main):010:0> ~-3
=> 2 
```

更令人困惑的是`~0xffffff00 != 0xff`（或任何其他 MSB 等于 的值`1`）。让我们稍微简化一下：`~0xf0 != 0x0f`. 那是因为它被视为`0xf0`一个正数。这实际上是有道理的。所以，`~0xf0 == 0x..f0f`。结果是负数。的二进制补码`0x..f0f`是`0xf1`。所以：

```
irb(main):011:0> '%x' % ~0xf0
=> "..f0f"
irb(main):012:0> (~0xf0).to_s(16)
=> "-f1" 
```

如果您不打算将按位运算符应用于结果，则可以将`~`其视为`-x - 1`运算符：

```
irb(main):018:0> -2 - 1
=> -3
irb(main):019:0> --3 - 1
=> 2 
```

但这可以说没有多大用处。

**一个例子**假设你有一个 8 位（为简单起见）网络掩码，你想计算`0`' 的数量。您可以通过翻转位并调用`bit_length`( `0x0f.bit_length == 4`) 来计算它们。但是`~0xf0 == 0x..f0f`，所以我们必须切断不需要的位：

```
irb(main):014:0> '%x' % (~0xf0 & 0xff)
=> "f"
irb(main):015:0> (~0xf0 & 0xff).bit_length
=> 4 
```

或者您可以使用 XOR 运算符 ( `^`)：

```
irb(main):016:0> i = 0xf0
irb(main):017:0> '%x' % i ^ ((1 << i.bit_length) - 1)
=> "f" 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2020-08-09T15:41:17.190

这里，二进制（8 位）中的 2 是 00000010，其 1 的补码是 11111101，从 1 的补码中减去 1，我们得到 11111101-1 = 11111100，这里的符号是 - 因为第 8 个字符（从 R 到 L）是 1 找到 1补充那个没有。即00000011 = 3，符号为负，这就是我们在这里得到-3的原因。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2020-12-29T20:54:51.253

这简单：

```
Before starting please remember that 
 1  Positive numbers are represented directly into the memory.
 2\. Whereas, negative numbers are stored in the form of 2's compliment.
 3\. If MSB(Most Significant bit) is 1 then the number is negative otherwise number is 
    positive. 
```

您正在寻找〜2：

```
Step:1 Represent 2 in a binary format 
       We will get, 0000 0010 
```

```
Step:2 Now we have to find ~2(means 1's compliment of 2)
                  1's compliment       
       0000 0010 =================> 1111 1101 

       So, ~2 === 1111 1101, Here MSB(Most significant Bit) is 1(means negative value). So, 
       In memory it will be represented as 2's compliment(To find 2's compliment first we 
       have to find 1's compliment and then add 1 to it.) 
```

```
Step3:  Finding 2's compliment of ~2 i.e 1111 1101

                   1's compliment                   Adding 1 to it
        1111 1101 =====================> 0000 0010 =================> 0000 0010
                                                                      +       1
                                                                      ---------
                                                                      0000 0011 
        So, 2's compliment of 1111 1101, is 0000 0011 
```

```
Step4:  Converting back to decimal format.
                   binary format
        0000 0011 ==============> 3

       In step2: we have seen that the number is negative number so the final answer would  
       be -3

                                So, ~2 === -3 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-02-11T15:47:24.667

首先，我们必须将给定的数字拆分为其二进制数字，然后通过在最后一个二进制数字上添加来反转它。执行后，我们必须给前一个数字提供相反的符号，我们找到了补全 ~2=-3 解释: 2s 二进制形式是 00000010 更改为 11111101 这是一个补码，然后补全 00000010+1=00000011 这是三的二进制形式和 -sign Ie,-3

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-11-27T18:40:50.340

位运算符是一个一元运算符，根据我的经验和知识，它适用于符号和幅度方法。

例如 ~2 将导致 -3。

这是因为按位运算符将首先表示符号和幅度的数字，即 0000 0010（8 位运算符），其中 MSB 是符号位。

然后稍后它将采用负数 2，即 -2。

-2 在符号和大小上表示为 1000 0010（8 位运算符）。

后来它在 LSB (1000 0010 + 1) 上加了一个 1，得到 1000 0011。

这是-3。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-03-30T14:51:02.630

**Javascript 波浪号 (~) 将给定值强制为一个的补码——所有位都被反转。** 这就是波浪号的全部作用。这不是自以为是的标志。*它既不增加也不减少任何数量。*

```
0 -> 1
1 -> 0
...in every bit position [0...integer nbr of bits - 1] 
```

在使用 JavaScript 等高级语言的标准桌面处理器上，BASE10 有符号算术是最常见的，但请记住，它不是唯一的一种。CPU 级别的位会根据许多因素进行解释。在“代码”级别，在本例中为 JavaScript，它们根据定义被解释为 32 位有符号整数（让我们将浮点数排除在外）。把它想象成量子，那些 32 位同时代表了许多可能的值。这完全取决于您查看它们的转换镜头。

```
JavaScript Tilde operation (1's complement)

BASE2 lens
~0001 -> 1110  - end result of ~ bitwise operation

BASE10 Signed lens (typical JS implementation)
~1  -> -2 

BASE10 Unsigned lens 
~1  -> 14 
```

以上所有内容同时为真。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-09-19T13:33:04.960

这是一种可以解释的方式：

让我们以为什么~2 = -3为例，（为简单起见使用8位系统进行解释）

1）我们有 2 ---> 00000010

2）我们可以得到〜2 ---> 11111101 #通过简单地切换位。

[但常见的错误是有些人试图将直接获得的~2 的二进制值转换为十进制（以 10 为底）数字，在这种情况下，它是 253。这不是我们找到补码的方式。]

3) 现在我们找到一个二进制数，将其与 2~ 的二进制值相加得到 0 (00000000) 作为结果。在这种情况下，它是 00000011（即 3），因为如果我们将 00000011 加到我们拥有的 11111101 中，我们得到 100000000，但是由于我们使用的是 8 位系统并且 1 在第 9 位，所以它被忽略了完全，所以我们最终得到 00000000。

4)从第(3)点我们可以说~2+3 = 0，因此我们可以说~2 = -3

注意：-3 的值就是 11111101，可以用同样的方式解释。

# php - 如何在 mysql 记录中包含换行符？

> ID：791330
> 
> 赞同：-1
> 
> 时间：2009-04-26T18:30:55.570
> 
> 标签：php, mysql, formatting

当有人键入以下内容以放入数据库时​​：

```
Hello,

My name is John and I am 22, and looking for a good time.

My Phone Number is:
555-NOT-REAL

Sincerely,
John D. 
```

我希望断线留在那里，但似乎当我将值拉回时，它会如下所示。

```
Hello, My name is John and I am 22, and looking for a good time. My Phone Number is: 555-NOT-REAL Sincerely,John D. 
```

是否有一种特殊的字段可以保持所输入文本的格式？我很确定它已经在那里，因为当我查看数据库中的字段时，确实会出现断线。也许这是我检索它的方式？

我宁愿不必编写一些东西来放入 HTML 标签，哈哈。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-26T18:35:31.020

如果您在浏览器中显示文本，则*必须*放入 HTML 标记。浏览器不会自动为您放置换行符。这通常使用以下[`nl2br`](http://www.php.net/nl2br)功能完成：

```
nl2br($message); 
```

但是，您也可以将文本包裹在[`<pre>`](http://www.w3.org/TR/html401/struct/text.html#h-9.3.4)标签周围，但我不建议这样做：

```
<pre>$message</pre> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T18:36:46.507

阅读：[nl2br](http://us3.php.net/manual/en/function.nl2br.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T18:40:01.757

```
<?php
$string= "this
is
a
string";

echo $string. "<br />";

echo nl2br($string);
?> 
```

输出：

```
this is a string
this
is
a
string 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T18:34:28.790

如果我没记错的话（自从我玩 MySQL 已经有一段时间了），你应该用转义序列替换换行符 \n

# java - 在接口中使用抽象关键字

> ID：791336
> 
> 赞同：8
> 
> 时间：2009-04-26T18:33:41.023
> 
> 标签：java, oop

我知道“公共接口”和“公共抽象接口”之间的区别，但是当应用于方法时有区别吗？

```
public interface IPluggableUi {
    abstract public JComponent getPanel();
    abstract public void initUi();
} 
```

或者

```
public interface IPluggableUi {
    public JComponent getPanel();
    public void initUi();
} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-26T18:41:09.210

接口中声明的方法默认是公共的和抽象的。

然而，人们可以：

```
public interface myInterface{
     public abstract void myMethod();
} 
```

但是，不鼓励使用这些修饰符。应用于接口声明的抽象修饰符也是如此。

特别是，关于您的问题：

“为了与旧版本的 Java 平台兼容，作为一种风格，允许但不鼓励为接口中声明的方法冗余指定抽象修饰符。”

来源：http: [//java.sun.com/docs/books/jls/second_edition/html/interfaces.doc.html](http://java.sun.com/docs/books/jls/second_edition/html/interfaces.doc.html)

第 9.4 节：抽象方法声明。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-26T19:19:25.953

附注：在接口中定义的值默认是*public static final*所以

整数值 = 5；

是相同的

公共静态最终 int VALUE = 5;

在一个界面中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-26T18:35:50.177

不，你也可以写

```
public interface IPluggableUi {
    JComponent getPanel();
    void initUi();
} 
```

这是同一件事

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T18:35:59.333

不可以。您只能将`abstract`方法应用于抽象基类。

接口指定了最终必须由具体（非抽象类）实现的方法集。

Abstract 将指定一个未在抽象基类中实现的方法，而该方法*必须*在具体子类中实现。

（另请注意，该`public`关键字在接口上的方法规范上是多余的）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-26T19:29:20.140

Java 中没有公共抽象接口。所有接口都是“抽象的”，因为它们不能被实例化。所有功能都是自动“抽象”的，因为它们需要实现。

# python - wxPython 在 Vista 下崩溃

> ID：791341
> 
> 赞同：2
> 
> 时间：2009-04-26T18:35:21.223
> 
> 标签：python, windows-vista, wxpython

我正在关注 wxPython 的[入门指南](http://wiki.wxpython.org/Getting%20Started)。但不幸的是，[第一个“Hello World”示例](http://wiki.wxpython.org/Getting%20Started#head-6e8427493dcc765fb873a1838adfbd6b8d08e0ee)崩溃了。对话框窗口显示得很好，但是只要我将鼠标移到窗口上，就会出现“pythonw.exe 已停止工作”的 Windows 消息。

我用：

*   Python 2.6.2
*   [wxPython2.8-win32-unicode-2.8.9.2-py26](http://downloads.sourceforge.net/wxpython/wxPython2.8-win32-unicode-2.8.9.2-py26.exe)
*   Vista（安装了最新的 SP 和更新）32 位，以管理员身份运行

有什么想法可能是错的，或者如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T19:11:20.480

请参阅此处了解原因：[http ://www.tejerodgers.com/snippets/2009/why-wxpython-crashes-python-26/](http://www.tejerodgers.com/snippets/2009/why-wxpython-crashes-python-26/)

请参阅 wxPython 的 README 以获得可以让您解决问题的技巧。

已发现一个修复程序，并将包含在下一个版本中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T19:09:28.800

32 位还是 64 位 Vista？当您进行安装时，您是否“以管理员身份运行”？我在早期也遇到了一些关于 vista 权限的问题。

此外，如果不仅仅是安装问题，这可能是一个修复。

[http://www.python-forum.org/pythonforum/viewtopic.php?f=4&t=11331](http://www.python-forum.org/pythonforum/viewtopic.php?f=4&t=11331)

希望这可以帮助...

# flash - 如何对 Flash 应用程序进行站点锁定？

> ID：791352
> 
> 赞同：1
> 
> 时间：2009-04-26T18:38:09.560
> 
> 标签：flash, actionscript-3, locking, whitelist

我有一个 Flash 应用程序，我很快就会在我的网站上发布它。我希望能够将其“锁定”到该站点以防止：

*   在另一个站点上托管 .SWF（在非法下载之后），以及
*   如果 .SWF 包含在另一个站点的 iFrame 中，则阻止打开

同时允许：

*   无需我定义 URL 的所有变体即可通过/启用的网站白名单（即：www.abc.com、abc.com、abc.com/game/、games.abc.com 等）

有一些商业应用程序需要花费数百美元来执行这项任务，但我很确定它可以通过以下方式完成：

```
root.loaderInfo.url 
```

不知何故。有没有人知道如何去做这件事？我最担心的是 iFrame 预防，因为当网站窃取闪存时，他们通常只是 iframe 到您自己的网站以节省带宽成本。

我使用的是 Flex SDK（不是 Flash IDE），所以一些纯 AS3 代码可以帮到我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T07:45:26.503

此代码将报告加载 URL。您可以在主加载器中使用它来显示未经授权的消息，或者如果它与您的期望不匹配，则根本不加载：

```
public static function Domain(root:Sprite):String {
    var currentDomain:String = root.loaderInfo.url.split("/")[2];
    var fqdn:Array = currentDomain.split(".");
    var rdi:int = 1;
    var tli:int = 2; 
    if (fqdn.length == 2) {
        rdi--;
        tli--;
    }

    return fqdn[rdi] + "." + fqdn[tli];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T18:43:56.490

检查服务器上的引用代理是图像主机经常使用的常用技巧。然而，网络从根本上设计为灵活的链接功能，因此没有可靠的方法来阻止所有可能性。最好的解决方案是需要闪存文件联系身份验证服务器并检查原始站点传递给它的一些字符串。

# logging - 如何将 NAnt 日志输出保存到文件中？

> ID：791357
> 
> 赞同：6
> 
> 时间：2009-04-26T18:43:59.110
> 
> 标签：logging, nant

在我的构建脚本中，如何为 NAnt 的日志消息设置目标？

理想情况下，我只想指定一个文件路径。然后，在每次构建时，NAnt 都会用它的消息输出覆盖这个文件的内容。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-26T19:12:44.580

您可以为此使用[NANT 记录器和侦听器](http://nant.sourceforge.net/release/0.85-rc1/help/fundamentals/listeners.html#DefaultLogger)。一种选择是将日志文件参数传递给命令。该文件在每次执行时都会被覆盖。

您可以有一个批处理文件，为每个构建文件和相应的输出调用 NAnt。

```
NAnt.exe -build:[build file for PROJ1] -logfile:c:\temp\BuildOutput1.txt
NAnt.exe -build:[build file for PROJ2] -logfile:c:\temp\BuildOutput2.txt
.
. 
```

如果您还没有这样做，我建议您研究一下[持续集成](http://en.wikipedia.org/wiki/Continuous_integration)应用程序，例如[CruiseControl.NET 。](http://cruisecontrol.sourceforge.net/)

# jquery - 将内容推送到页面外

> ID：791358
> 
> 赞同：0
> 
> 时间：2009-04-26T18:44:43.167
> 
> 标签：jquery, css

我正在设置一个页面，右侧有一个矢量沙发，鼠标悬停时它会滑出。我的目标是让沙发左侧的内容滑到页面左侧。

我是否需要将我的元素设置为绝对然后滑动？我可能会使用 animate() 将沙发移出调整正确的 css 属性。

默认情况下它会滑到左边吗？

对此有任何想法，我知道如何将其滑出，但不知道如何使内容滑到页面左侧。

示例 HTML 结构： http: [//pastie.org/458876](http://pastie.org/458876)

新代码：

```
$(document).ready(function() {
  $('#slidemarginleft button').click(function() {
 var $marginLefty = $(this).next();
 $marginLefty.animate({
   marginLeft: parseInt($marginLefty.css('marginLeft'),10) == 0 ?
  $marginLefty.outerWidth() :
  0
 });
  });
}); 
```

假设我使用上面的代码将沙发从左向右移动

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T18:46:37.513

是的，使元素滑出页面的唯一方法是使用固定和/或绝对定位（除了简单地使元素大于页面）。

我不确定“它”是否会落在页面的左侧，因为我不确定容器是如何设置的。我敢肯定，如果您要举一个 HTML 外观的示例，很多人会愿意做出更好的猜测。（使用 jsbin.com 是设置示例的好地方）

# asp.net - .NET MVC 还是普通的旧 ASP.NET？

> ID：791359
> 
> 赞同：7
> 
> 时间：2009-04-26T18:44:54.677
> 
> 标签：asp.net, asp.net-mvc, data-access-layer

这是一个大喊大叫，因为我过去几天一直在学习.NET，这个过程让我有点困惑而不是开悟。作为背景信息，我了解 PHP（甚至使用 CakePHP 相当容易地创建整个应用程序）和 Rails。

我想知道我应该追求 ASP.NET 还是应该坚持学习 ASP.NET MVC？当我浏览一些 ASP.NET 教程时，基础知识似乎相当简单，但不知何故，当我浏览的每个示例都在没有 DAL 的情况下将 SQL 语句直接插入示例时，我只是有点担心。

所以，如果我只是没有做任何好的研究，是否有任何书籍/网站可以帮助解决这个问题？还是我应该去学习.NET MVC？

如果您想知道为什么我不坚持使用 PHP 或 Rails，我刚刚了解到，为了工作的安全，我可能只需要了解一点 .NET。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-26T18:55:10.613

ASP .net MVC 将更接近您的 Rails 体验。

ASP .net Web Forms（通常称为ASP.net）显然不同，但是如果您是为了找工作而学习，那么它会付出很长时间（有很多很多的网站，内部和面向公众）基于 ASP .net Web 表单构建。有一些使用 ASP.net MVC 的新兴网站，但还有很长的路要走。

所以，这取决于你的目标。如果您只需要了解“一点 .net”，请使用 MVC，因为您将了解这些概念。如果您需要了解“.net Web 堆栈”，那么大多数人会想到 Web 表单，而不是 MVC ......

是的，微软世界中的样本往往是“较轻的一面”。几乎不可能找到没有“拖拖拉拉”感觉的演示，这是一个真正的问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-26T18:54:43.390

我认为您所看到的无 DAL 示例是为了简单起见以这种方式编写的。严肃的 ASP.Net 应用程序总是使用 BLL 和 DAL 等层。DAL 的分离只是在简单的示例中被省略了——这确实会导致不了解的人对示例的不幸误解。

我认为 MVC 更难编程，只有在有特定原因使用它时才最好使用它——SEO 优化、TDD 开发。它忽略了 ASP.Net WebForms 中可用的许多复杂功能，并且经常与经典 ASP 进行比较。而且，我不相信 MVC 已在许多企业环境中被广泛采用，因此，如果您想学习其他人使用的方法，请坚持使用基本的 ASP.Net 并保存 MVC 以备后用。

作为一个对其他编程语言有丰富经验的 .Net 初学者，我建议您继续使用 WebForms 学习 ASP.Net。如果您正在寻找一个严肃的 DAL 示例，我强烈推荐ASP.Net 网站上的[这个冗长的教程。](http://www.asp.net/learn/data-access/)它具有您寻求的所有架构改进，并且可能有助于学习如何使用许多数据显示控件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-26T18:55:33.357

我会选择 ASP.Net MVC 而不是 ASP.Net WebForms，原因之一是：测试。MVC 从一开始就被设计成一个可插拔和可测试的系统。测试是或者至少应该是开发周期中不可分割的一部分。由于能够模拟或替换核心 API 的一部分，测试 MVC 比 WebForms 更容易。在 WebForms 中做同样的事情要么是不可能的，要么非常笨拙。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-26T19:05:12.663

我的一位同事在[http://www.mindscape.co.nz/staff/jeremy/index.php/2009/02/loving-aspnet-mvc上写下了他在现实世界项目中使用 ASP.NET MVC 的经验/](http://www.mindscape.co.nz/staff/jeremy/index.php/2009/02/loving-aspnet-mvc/)以及他与普通旧 ASP.NET 的比较。他的结论是“我认为 MVC 是在 .NET 框架上构建 Web 应用程序的前进方向。”

他还编写了一些详细的演练，展示了如何将 ASP.NET MVC 与 ORM 一起使用，这可能有助于解决您“在没有 DAL 的情况下直接将 SQL 放在示例中”的问题（他还涵盖了单元测试之类的内容）。参见[http://www.mindscape.co.nz/staff/jeremy/index.php/2009/03/aspnet-mvc-part1/](http://www.mindscape.co.nz/staff/jeremy/index.php/2009/03/aspnet-mvc-part1/)，[http://www.mindscape.co.nz/staff/jeremy/index。 php/2009/03/aspnet-mvc-part2/](http://www.mindscape.co.nz/staff/jeremy/index.php/2009/03/aspnet-mvc-part2/)， http: [//www.mindscape.co.nz/staff/jeremy/index.php/2009/03/aspnet-mvc-part3/](http://www.mindscape.co.nz/staff/jeremy/index.php/2009/03/aspnet-mvc-part3/)和[http://www。 mindscape.co.nz/staff/jeremy/index.php/2009/03/aspnet-mvc-part4/](http://www.mindscape.co.nz/staff/jeremy/index.php/2009/03/aspnet-mvc-part4/)。免责声明：这些是根据我们的商业 ORM 编写的，但我希望很容易转化为您自己喜欢的数据访问技术。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-26T18:49:33.653

Rob Conery 写了一本关于 ASP.MVC 的书，所以你可能会发现他有偏见。尽管如此，我发现他的[论点](http://codebetter.com/blogs/rob.conery/archive/2009/04/22/i-spose-i-ll-just-say-it-you-should-learn-mvc.aspx)很有说服力。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-26T18:58:09.607

最近阅读[ASP.NET 3.5 应用程序架构和设计](https://rads.stackoverflow.com/amzn/click/com/1847195504)- 这是对 ASP.NET 中设计的许多不同方面的合理研究，包括[数据访问层](http://en.wikipedia.org/wiki/Data_access_layer)、[N 层架构](http://en.wikipedia.org/wiki/N_tier_architecture_(computing))、设计模式和涉及[MVC](http://en.wikipedia.org/wiki/Model_view_controller)等主题。如果要找一本书，它可以作为 ASP.NET 最佳实践的概述。

我不得不同意其他人的观点，您最好直接考虑使用 ASP.NET MVC，因为您当前的技能将更好地转化为该框架。我建议看一下[Professional ASP.NET MVC 1.0](https://rads.stackoverflow.com/amzn/click/com/0470384611)。

# c# - 试图让 asp.net ajax 下拉列表自动完成扩展器工作的简单示例！

> ID：791361
> 
> 赞同：3
> 
> 时间：2009-04-26T18:47:03.300
> 
> 标签：c#, ajax, textbox, autocomplete

我想测试下拉列表自动完成 ajax 扩展的工作。我正在 Visual Web Developer Express 2008 中对此进行测试。

1）我在 default.aspx 表单上删除了一个文本框 2）从 Ajax 工具箱中删除了一个脚本控件 3）将自动完成扩展扩展到文本框

顺便说一句，此时，如果我显示 AutoCompleteExtender 的属性，则 ServicePath 属性为黑色。如果我点击那里，VWDE2008 会崩溃（！）

我想要一种简单的方法来测试自动完成功能，最好不设置 web 服务（或者如果使用 web 服务，只需简单说明）。我想显示一个简单的 C# 列表中的选项，例如城市，例如：

`Copenhaguen, Denmark`
`Miami, Florida, USA`
`Paris, France`

直接在代码中声明（不从数据库中读取）。在这一点上，大多数人都建议改用 jquery。我找不到一个简单的（非视频）教程来设置它！

任何人都可以帮忙吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T21:47:38.280

您可以将 AutoComplete 与 PageMethod 一起使用，而不是使用 Web 服务。方法装饰类似，但代码保留在页面“中”，并且可以访问会话变量等。

我在这里找到了一个看起来不错的设置示例：

[http://allwrong.wordpress.com/2007/03/13/ms-ajax-autocomplete-extender-using-a-page-method/](http://allwrong.wordpress.com/2007/03/13/ms-ajax-autocomplete-extender-using-a-page-method/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-16T12:33:24.060

有一种更简单的方法是使用 Jquery 自动完成插件，这适用于 pagemethod 和 Web 服务以及 WCF 服务
[TextBox AutoComplete 与 ASP.NET 和 jQuery UI](http://www.dotnetcurry.com/ShowArticle.aspx?ID=515)

# postgresql - 如何在不知道其名称的情况下访问 postgresql 中记录类型的字段？

> ID：791364
> 
> 赞同：2
> 
> 时间：2009-04-26T18:48:41.173
> 
> 标签：postgresql, plpgsql

我正在用这个编写一个 PL/pgSQL 函数：

```
cols_to_select := according to a set of rules, we get the name of the columns

FOR I IN EXECUTE 'SELECT '||cols_to_select||' FROM tabl' LOOP
  -- how to access to fields of record I without knowing their names?
  -- 

END LOOP; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T18:54:12.317

这是我想出的一种方法：

```
cols_to_select := according to a set of rules, we get the name of the columns

FOR I IN EXECUTE 'SELECT ARRAY['||cols_to_select||'] as AR FROM tabl' LOOP
  -- how to access to fields of record I without knowing their names?
  FOR j IN 1..array_upper(I.ar,1) LOOP
    RAISE NOTICE '%', I.AR[j];
  END LOOP;

END LOOP; 
```

此解决方案的问题是当列具有不同类型时会失败。

# apache-flex - 如何仅在 AS3 中制作 Flash PreLoader？

> ID：791368
> 
> 赞同：3
> 
> 时间：2009-04-26T18:49:40.063
> 
> 标签：apache-flex, flash, actionscript-3, preloader

我想在我的应用程序中加入一个 Flash 预加载器，但我只使用 Flex SDK/AS3/记事本来编写这个野兽的代码。我无权访问 Flash IDE。

网上有很多关于如何在 CS4 中进行操作的教程和帮助文件，但代码本身没有。任何人都可以在这里给我方向吗？

大多数示例似乎都围绕着将加载器符号放置在第一帧中，在应用程序的其余部分之前 - 但我无法从 flex 中访问时间线或帧（或者至少，我认为我没有！ ）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-26T19:08:31.640

您将需要阅读一些 AS3 编译器指令——在这种情况下，相关的指令是工厂类。

本质上，您将需要创建一个类来加载扩展 MovieClip 的主类。'preloader' 类可以监控 bytesloaded/bytestotal 然后实例化你的主类。不直观的部分（至少对我而言）包括指令：[Frame(factoryClass="pathToYourLoaderClass")]

在您要预加载的主类的顶部。

下面是一个很棒的博客，其中包含更多信息和一个很好的解决方案。

[http://www.bit-101.com/blog/?p=946](http://www.bit-101.com/blog/?p=946)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T19:18:23.850

对于 flex 应用程序，您设置应用程序的 preloader 属性。这通常是无聊的灰色进度条，但可以是任何显示对象。请记住，要让预加载器实际显示它必须被加载，因此需要保持较小。因此，不建议使用任何属于 Flex 框架的类，因为必须先下载框架，然后才能显示预加载器。

如果您正在做一个完全没有 Flex 的直接 AS3 项目，那么您需要查看 Frame 元数据标签。在这里查看更多信息：

[http://www.bit-101.com/blog/?p=946](http://www.bit-101.com/blog/?p=946) [http://blogs.adobe.com/rgonzalez/2006/06/modular_applications_part_2](http://blogs.adobe.com/rgonzalez/2006/06/modular_applications_part_2)

# html - 推拉门定心

> ID：791369
> 
> 赞同：1
> 
> 时间：2009-04-26T18:49:41.203
> 
> 标签：html, css

我很快就制作了一个[滑动门示例](http://www.alistapart.com/articles/slidingdoors/)，但我将其合并到我的标题中。页眉的格式应该是一个固定高度的页眉，左边有一个标志，右边有滑动门导航按钮。标题的背景应该跨越浏览器的整个宽度，但是实际的标题（即右侧的标题徽标和导航）应该具有大约 900 像素的固定宽度并居中。

关于如何实现这一目标的任何想法？我尝试了以下方法：

```
<div id="header-outer">
    <div id="header-container">
        <a id="logo" href="<?php echo get_option('home'); ?>/"></a>

        <div id="header-nav">
            <ul>
                <li><a href="#">Home</a></li>
                <li><a href="#">Projects</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Portfolio</a></li>
                <li><a href="#">Blog</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
        </div>
    </div>
</div> 
```

和以下CSS：

```
div#header-nav {
    float:left;
    width:100%;
    background:rgb(33,33,33);
    font-size:90%;
    line-height:normal;
    margin-top:90px;
}

div#header-nav ul {
    margin:0;
    padding:0;
    list-style:none;    
}

div#header-nav ul li {
    float:left;
    margin:0 2px 0 2px;
    padding:0 0 0 4px;
    background: url('images/tab_left.png') no-repeat left top;
}

div#header-nav a {
    display:block;
    background: url('images/tab_right.png') no-repeat right top;
    padding:5px 10px 4px 6px;
    text-decoration:none;
    color:#333;
}

div#header-outer {
    background: rgb(33,33,33);
    height:100px;
    display:block;
    clear:both;
}

div#header-container {
    text-align:center;
    margin:0 auto;
    width:900px;
    padding:0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T14:50:07.963

只是想了解您的问题。

你想让它像这样显示吗...

```
---------|--------------------------------------------------|---------
         |                                                  |
         |  Logo                                Navigation  |
         |                                                  |
---------|--------------------------------------------------|--------- 
```

或者像这样...

```
---------|--------------------------------------------------|---------
         |                                                  |
         |                 Logo  Navigation                 |
         |                                                  |
---------|--------------------------------------------------|--------- 
```

如果您在第一个示例之后，那么使用以下 css 应该很容易......

```
＃标识 {
    向左飘浮; /* 将 logo 向左浮动 */
}

div#header-nav {
    浮动：对；/* 必须删除 100% 的宽度，以便 nav 可以接受浮动 */
    背景：RGB（33,33,33）；
    字体大小：90%；
    行高：正常；
    边距顶部：90px；
}

div#header-nav ul {
    边距：0；
    填充：0；
    列表样式：无；
}

div#header-nav ul li {
    向左飘浮;
    边距：0 2px 0 2px；
    填充：0 0 0 4px；
    背景： url('http://kieransenior.co.uk/images/tab_left.png') no-repeat left top;
}

div#header-nav {
    显示：块；
    背景： url('http://kieransenior.co.uk/images/tab_right.png') no-repeat right top;
    填充：5px 10px 4px 6px；
    文字装饰：无；
    颜色：#333;
}

div#header-outer {
    背景：RGB（33,33,33）；
    高度：100px；
    显示：块；
    明确：两者；
}

div#header-container {
    文本对齐：居中；
    边距：0 自动；
    宽度：900 像素；
    填充：0；
}

```

如果您希望它像第二个示例一样显示，您可能必须手动将徽标和导航居中，因为我不确定是否可以在 CSS 跨浏览器中这样做。但我可能错了，请随时纠正我。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T18:59:00.827

对不起，我最后回答了我自己的问题。我不确定它有多正确。这就是我想出的：

```
 <div id="header-container">
        <div id="header">
            <div id="header-logo"><a href="<?php echo get_option('home'); ?>/"><img src="<?php bloginfo('stylesheet_directory') ?>/images/logo.png" /></a></div>
            <ul>
                <li id="active"><a href="#">Home</a></li>
                <li><a href="#">Projects</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Portfolio</a></li>
                <li><a href="#">Blog</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
        </div>
    </div> 
```

以及以下 CSS：

```
div#header {
    float:right;
    width:100%;
    font-size:85%;
    line-height:normal;
    background: rgb(33,33,34) url('images/top_bg.png') repeat-x;
}

div#header-logo {
    margin:0 auto;
    width:900px;
}

div#header-logo a {
    float:left; 
}

img {
    border:0;
    float:left;
}

div#header ul {
    margin:0 auto;
    width:900px;
    padding:60px 0 0 0;
    float:right;
    list-style:none;    
}

div#header ul li {
    float:left;
    margin:0 2px 0 2px;
    padding:0 0 0 4px;

}

div#header ul li a {
    display:block;
    font-weight:bold;
    padding:5px 10px 7px 6px;
    text-decoration:none;
    color:#ddd;
    margin:0;
}

div#header ul li#active {

    background: url('images/tab_left.png') no-repeat left top;
}

div#header ul li#active a {
    color:#333;
    background: url('images/tab_right.png') no-repeat right top;
}

div#header ul li a:hover {
    color:#fff; 
    background: url('images/nav_back.png') no-repeat center bottom;
}

div#header-container {
    background: rgb(33,33,33);
    margin:0;
    padding:0;
    width:100%;
    height:40px;
} 
```

# asp.net-mvc - 标准 ASP.NET MVC ModelBinder 的文档在哪里？

> ID：791370
> 
> 赞同：6
> 
> 时间：2009-04-26T18:50:03.853
> 
> 标签：asp.net-mvc, modelbinders

对于 ASP.NET MVC 中标准模型绑定器的功能，我似乎无法找到任何权威的最新（即 1.0 最终版）文档，特别是在绑定涉及集合的复杂对象方面（以及这对 HTML 表单的命名要求）

我找到了 Phil Haack 的一篇博文（[http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)），但它在顶部有一条注释说它是已过时并将更新。这里还有一个有用的答案：[Custom Model Binder for Complex Composite objects HELP](https://stackoverflow.com/questions/714634)，但我不知道他是怎么知道这些东西的。

此页面：[http](http://www.asp.net/learn/mvc/#MVC_ActionFilters) ://www.asp.net/learn/mvc/#MVC_ActionFilters标题为“动作过滤器和模型绑定器”，但仅实际包含有关过滤器的信息。

我是否被迫阅读源代码或购买新的“前额帮”书（并希望它比我过去错误购买的其他 Wrox 书更好）？还是我在某处错过了一个很好的参考？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T19:01:03.907

对于绑定涉及集合的复杂对象，请查看[我](https://stackoverflow.com/questions/711184/asp-net-mvc-example-of-editing-multiple-child-records/712817#712817)对[这个问题](https://stackoverflow.com/questions/711184/asp-net-mvc-example-of-editing-multiple-child-records)的回答。

# sql - 如何一次在一系列范围内查询 count()？

> ID：791373
> 
> 赞同：2
> 
> 时间：2009-04-26T18:50:27.503
> 
> 标签：sql, database

我正在尝试在 phpBB 论坛上撰写论坛排名的细分。论坛排名由您的帖子数定义：如果您有 1-9 个帖子，您就是 1 级；10-24，你是2级；等等。（最高排名是超过 2000 个帖子。）

现在，我的论坛排名统计页面只是在做一堆愚蠢的查询：

```
SELECT COUNT(*) from _users WHERE post_count>=1 AND post_count<10;
SELECT COUNT(*) from _users WHERE post_count>=10 AND post_count<25; 
```

... 等等。

查询会在几秒钟内运行，所以我真的很好奇（以供将来参考）解决这个问题的更好方法 - 感觉应该有一个我可以运行的查询将返回类似于此的结果：

```
rank_id | count
1       | 5000
2       | 2000
... 
```

我确实有另一个表格，其中列出了排名以及达到该排名所需的最少帖子数。不确定这是否有必要，或者是否有更聪明的方法来编写我的查询。

如果有帮助，我正在使用 MySQL DB，但我对跨数据库的答案更感兴趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T19:03:49.547

在它们之间粘贴一个 UNION。

```
SELECT COUNT(*) from _users WHERE post_count>=1 AND post_count<10;
UNION
SELECT COUNT(*) from _users WHERE post_count>=10 AND post_count<25; 
```

或者，您可以使用 CASE WHEN 来堆叠它们并将结果相加以将其放在一行中。

```
SELECT
   SUM(CASE WHEN post_count>=1 AND post_count<10 THEN 1 ELSE 0 END) AS Between_1_10
   SUM(CASE WHEN post_count>=10 AND post_count<25 THEN 1 ELSE 0 END) AS Between_10_25
   SUM(CASE WHEN post_count>=25 AND post_count<100 THEN 1 ELSE 0 END) AS Between_25_100
FROM 
   _users 
```

或者另一种方式来做到这一点......

```
SELECT 
     Count(*) 
     , Category
FROM
(
    SELECT
       CASE 
          WHEN post_count>=1 AND post_count<10 THEN '1_To_10'
          WHEN post_count>=10 AND post_count<25 THEN '10_To_25'
          WHEN post_count>=25 AND post_count<100 THEN '25_To_100'
          ELSE 'Over_100' 
       END As Category
    FROM
       _users
) as InnerTable
GROUP BY
   Category 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T18:59:41.663

我想你正在寻找`SELECT CASE...WHEN.`

# mysql - 令人困惑的 MySQL 查询

> ID：791376
> 
> 赞同：1
> 
> 时间：2009-04-26T18:52:35.550
> 
> 标签：mysql

我有两张桌子，`staff`和`phones`。

`Staff`只有一个字段，`staff_id`. `Phones`具有三个字段`staff_id`：`phone_type`和`number`。

我想显示所有员工的staff_id、手机号码和家庭电话号码。但我不知道如何在结果中将手机号码和家庭电话号码作为单独的列。到目前为止，这是我一直在尝试的，它将两种类型的数字放在同一列中。

```
SELECT staff.staff_id, phones.number
FROM staff
LEFT JOIN phones ON ( staff.staff_id = phones.staff_id && ( phones.field_type = 'Cell' || phones.field_type = 'Home' ) ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T19:02:06.477

您需要使用数据透视查询，类似于下面未经测试的代码：

```
select staff.staff_id,
       MAX(IF(phones.field_type='Cell', phones.number, null)) as Cell,
       MAX(IF(phones.field_type='Home', phones.number, null)) as Home
from   staff,
       phones
where  phones.staff_id = staff.staff_id
group by staff.staff_id 
```

注意 - 多次加入电话表也可以，但上面的解决方案应该表现得更好，并且可以很容易地扩展到额外的phones.field_types。

另请参阅[http://dev.mysql.com/doc/refman/5.1/en/select.html](http://dev.mysql.com/doc/refman/5.1/en/select.html)（搜索“pivot”）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T18:59:06.937

你不能这样做，因为你不能给列赋值。
您必须进行 2 次连接：

```
SELECT staff.staff_id, cells.number, home.number FROM staff 
  JOIN phones AS cells ON (...)
  JOIN phones AS home ON (...)
  WHERE cells.field_type='Cell' AND home.field_type='Home'; 
```

它会起作用，但你不会在一栏中有工作人员的家庭和手机号码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T19:01:23.937

您需要加入电话表两次。

```
SELECT staff.staff_id, cellPhones.number, homePhones.number,
FROM staff
LEFT JOIN phones cellPhones ON ( staff.staff_id = phones.staff_id && phones.field_type = 'Cell' )
LEFT JOIN phones homePhones ON ( staff.staff_id = phones.staff_id && phones.field_type = 'Home' ) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T19:01:42.313

这就像我的地址簿的问题。

你可以在这里找到答案： [SQL Database questions with addressbook table design](https://stackoverflow.com/questions/369213/sql-database-problems-with-addressbook-table-design)

# c# - 比多个 Catch 块更优雅的异常处理？

> ID：791390
> 
> 赞同：53
> 
> 时间：2009-04-26T19:00:33.470
> 
> 标签：c#, .net, exception, error-handling

使用 C#，有没有更好的方法来处理多种类型的异常，而不是一堆丑陋的 catch 块？

这种情况的最佳实践是什么？

例如：

```
try
{
    // Many types of exceptions can be thrown
}
catch (CustomException ce)
{
    ...
}
catch (AnotherCustomException ace)
{
    ...
}
catch (Exception ex)
{
    ...
} 
```

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-04-26T19:04:00.967

在我看来，一堆“丑陋”的 catch 块是处理这种情况的最佳方法。

我喜欢这个的原因是它非常明确。您明确说明要处理哪些异常以及应如何处理它们。在大多数情况下，尝试将处理合并为更简洁的形式的其他形式会失去可读性。

我的建议是坚持这一点，并处理您希望明确处理的异常，每个异常都在它们自己的 catch 块中。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-04-26T19:07:01.100

我同意 Reed：这是最好的方法。

我会添加这些评论：

只抓住你要做的事情。如果您无法解决问题，那么捕获特定异常是没有意义的。

不要过度使用 catch 块。在许多无法解决异常的情况下，最好让异常冒泡到一个中心点（例如 Page_Error）并在那里捕获它。然后，您记录异常并向用户显示一条消息。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-04-26T19:49:33.417

您唯一能做的就是模拟 VB.NET 的异常过滤器：

```
try {
    DoSomething();
} catch (Exception e) {
    if (!ex is CustomException && !ex is AnotherCustomException) {
       throw;
    }
    // handle
} 
```

有时这更好，有时则不然。如果处理程序中有一些我想要的通用逻辑，我主要会使用它，但异常不共享基本类型。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-04-26T19:05:03.600

不幸的是，[C# 没有](http://blogs.msdn.com/toub/archive/2004/03/05/84698.aspx)像 VB.NET 这样的用户异常过滤器，因此您仅限于：

1.  捕获所有异常的共同祖先。这可能是也可能不是您想要的，因为您可能不想捕获其他后代异常类型。
2.  将异常处理逻辑移动到另一个方法中并从每个处理程序中调用它。
3.  为每个处理程序重复异常逻辑。
4.  将异常处理逻辑移动到支持过滤器的语言中，例如 VB.NET。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-26T21:47:19.933

如果您需要编写大量这样的代码，我建议您检查一些[AOP](http://en.wikipedia.org/wiki/Aspect-oriented_programming)框架。我个人使用[PostSharp](http://www.postsharp.net/)。然后您可以将所有异常处理代码隐藏到方面。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-26T19:17:43.850

您应该查看企业库[异常处理块](http://msdn.microsoft.com/en-us/library/dd203116.aspx)。它允许通过策略（包装策略、传播策略、替换策略、日志记录策略等）对异常进行更精细的控制。您可以使用它来标准化编写异常块的方式并使用配置来精确处理发生的情况特定类型的异常。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-26T20:51:18.617

这种方式不好吗？

如果您只想处理一个异常：

```
try
{
    // Many types of exceptions can be thrown
}
catch (TheExceptionIWantToHandle ex)
{
    // handle it
}
catch (Exception ex)
{
    // suppress all other exceptions
} 
```

如果要处理除一个以外的所有异常：

```
try
{
    // Many types of exceptions can be thrown
}
catch (TheExceptionIDoNotWantToHandle ex)
{
    // suppress all other exceptions
}
catch (Exception ex)
{
    // handle it
} 
```

好不好？

* * *

## 回答 #8

> 赞同：-6
> 
> 时间：2009-04-26T19:10:07.223

仅捕获您需要专门解决的问题并离开

```
catch(Exception e)
{
} 
```

对于其他所有内容（或跳过它并将此异常提供给堆栈）

# c - 从函数内重新分配

> ID：791404
> 
> 赞同：1
> 
> 时间：2009-04-26T19:06:11.647
> 
> 标签：c, malloc

我有一个名为 ball 的结构、多个球、一个球数组和一个我想向数组添加新球的函数：

结构：

```
typedef struct ball{
    BITMAP *image;
    int x;
    int y;
    int vector_x;
    int vector_y;
} ball; 
```

（*非工作*功能）：

```
void add_balls(int *num_balls, ball **myballs){
    num_balls++;
    *myballs = realloc(*myballs, *num_balls * sizeof(ball));
    *myballs[*num_balls-1]->x =  rand() % 640;
    *myballs[*num_balls-1]->y = rand() % 480;
    *myballs[*num_balls-1]->vector_x = rand() % 10;
    *myballs[*num_balls-1]->vector_y = rand() % 10;
    *myballs[*num_balls-1]->image = load_bitmap("blue_ball.bmp", NULL); 
 } 
```

和main中的函数调用：

```
add_balls(&num_balls, &myballs); 
```

对该函数的调用失败并显示以下错误消息：

```
p.c: In function ‘add_balls’:
p.c:19: error: invalid type argument of ‘unary *’
p.c:20: error: invalid type argument of ‘unary *’
p.c:21: error: invalid type argument of ‘unary *’
p.c:22: error: invalid type argument of ‘unary *’
p.c:23: error: incompatible types in assignment 
```

有什么帮助吗？

这有帮助。它现在可以编译，但我在运行时遇到分段错误错误。如果感兴趣，这是完整的代码：

```
#include <allegro.h>
#include <stdlib.h>
#include <time.h>
#include <math.h>

#define NUM_BALLS 10

typedef struct ball{
    BITMAP *image;
    int x;
    int y;
    int vector_x;
    int vector_y;
} ball;

void add_balls(int *num_balls, ball **myballs){
    num_balls++;
    myballs = realloc(*myballs, *num_balls * sizeof(ball));
    myballs[*num_balls-1]->x =  rand() % 640;
    myballs[*num_balls-1]->y = rand() % 480;
    myballs[*num_balls-1]->vector_x = rand() % 10;
    myballs[*num_balls-1]->vector_y = rand() % 10;
    myballs[*num_balls-1]->image = load_bitmap("blue_ball.bmp", NULL);  
 }

int main() 
{
    allegro_init();
    install_keyboard();
    srand(time(0));

    install_timer();

    set_color_depth(32);
    set_gfx_mode(GFX_AUTODETECT_WINDOWED, 640,480,0,0);

    BITMAP *buffer = NULL;
    buffer = create_bitmap(640,480);

    ball *myballs;
    myballs  = malloc(NUM_BALLS * sizeof(ball));
    int num_balls = NUM_BALLS;

    BITMAP *bg = NULL;
    bg = load_bitmap("bg.bmp",NULL);

    int i;
    for(i=0;i<num_balls;i++){
        myballs[i].x =  rand() % 640;
        myballs[i].y = rand() % 480;
        myballs[i].vector_x = rand() % 10;
        myballs[i].vector_y = rand() % 10;
        myballs[i].image = load_bitmap("blue_ball.bmp", NULL);
    }

    int bg_vector_x;
    float bg_vector_y;

    while(!key[KEY_ESC]){
        vsync();
        for(i=0;i<num_balls;i++){

            if(myballs[i].x + myballs[i].vector_x > 640 || myballs[i].x + myballs[i].vector_x < 0){
                myballs[i].vector_x *= -1;
            }
            if(myballs[i].y + myballs[i].vector_y > 480 || myballs[i].y + myballs[i].vector_y < 0){
                myballs[i].vector_y *= -1;
            }

            myballs[i].x += myballs[i].vector_x;
            myballs[i].y += myballs[i].vector_y;
        }

        if(key[KEY_UP]){
            add_balls(&num_balls, &myballs);
        }

        clear_bitmap(buffer);

        int ii;     
        for(i=0;i<3;i++){
            for(ii=-1;ii<3;ii++){
                draw_sprite(buffer, bg ,(bg_vector_x%528)+(i*528),100*cos(bg_vector_y) + ii*353);       
            }
        }
        bg_vector_x++;
        bg_vector_y+=0.1;

        for(i=0;i<num_balls;i++){
            draw_sprite(buffer, myballs[i].image, myballs[i].x,myballs[i].y);
        }

        blit(buffer, screen, 0,0,0,0,640,480);
    }

    for(i=0;i<num_balls;i++){
        destroy_bitmap(myballs[i].image);
    }
    free(myballs);
    destroy_bitmap(buffer);
}

END_OF_MAIN() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T20:00:08.430

在你修改的add_balls函数中你增加了指针num_balls，你实际上想要增加指针的内容，(*num_balls)++；

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T23:04:05.240

除了 Adam Rosenfield 和 Baruch Even 的回答之外，您还应该考虑`realloc()`失败时会发生什么。

`p = realloc(p, s)`很危险，因为当它失败时，它会设置指针，`NULL`但不会释放它曾经指向的内存。如果发生这种情况，您的程序最终将泄漏原始内存块（如果它没有首先崩溃）。相反，您应该将 的结果分配`realloc()`给另一个变量，以便您可以处理它返回的情况`NULL`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-26T19:10:40.390

```
*myballs[*num_balls-1]->x 
```

这取消引用了太多次 - myballs 是一个指针数组（或者换句话说，指向指针数组的第一个元素的指针） - 只是失去 myballs 前面的星号，现在你会得到指针 from您可以访问该结构（或者，将 -> 转换为 .）。符号 -> 是您从指向该结构的指针访问结构成员的简写，而不是从指向该结构的取消引用指针访问。

```
myballs[*num_balls-1]->x 
```

或者

```
(*myballs[*num_balls-1]).x 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-27T01:20:15.010

您的原始代码非常接近正确。第一个问题比较容易解决。线

```
num_balls++; 
```

应该

```
(*num_balls)++; 
```

您正在增加指向的位置`num_balls`，而不是增加它指向的值。当你后来取消引用它时，它指向了其他一些内存——在这个特定的使用场景中，它可能指向堆栈中的下一个局部变量`main()`，即变量`bg`。

您的另一个问题是操作顺序问题。数组索引比取消引用具有更高的运算符优先级，因此该行

```
*myballs[*num_balls-1]->x = rand() % 640; 
```

相当于

```
*(myballs[*num_balls-1]->x) = rand() % 640 
```

`myballs`是指向`ball`s 数组的指针。如果`*num_balls-1`不是 0，您将访问错误的内存。无论如何，成员变量`x`不是指针，因此您无法取消引用它，因此编译器会将您保存在此处并显示语法错误。正确的代码是确保在获取数组索引之前取消引用：

```
(*myballs)[*num_balls-1].x = rand() % 640; 
```

这就是你想要的，即取消引用指针以获取指向原始数组的指针，获取你想要的元素，并分配给成员变量`x`. 中的其余行`add_ball()`应类似地重写。

您的代码的另一个问题是性能问题而不是正确性问题，那就是您正在`blue_ball.bmp`为每个球重新加载图像。最好通过只加载一次位图来*实例*化位图，然后让每个球都引用该实例，而不是每次都重新加载它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-26T23:33:52.423

假设我了解您要执行的操作，则以下内容（未经测试）会更好：

```
#include <assert.h>

void add_balls(int *num_balls, ball **myballs){
    int n = ++*num_balls;
    ball *pb = realloc(*myballs, n * sizeof(ball));

    /* fail loudly and early on lack of memory. */
    assert(pb); 
    *myballs = pb;

    /* note the pre-decrement of n here to make obvious the common n-1 */
    pb[--n]->x =  rand() % 640;
    pb[n]->y = rand() % 480;
    pb[n]->vector_x = rand() % 10;
    pb[n]->vector_y = rand() % 10;
    pb[n]->image = load_bitmap("blue_ball.bmp", NULL); 
 } 
```

尽管可以在最初编写的数组元素引用中使用足够的括号使所有运算符优先级正确，但结果基本上是人类无法阅读的。事实上，从右到左的关联性`->`与 的从左到右的关联性奇怪地混合在一起，`*`并被数组索引进一步混淆。

您可能希望改进错误处理。特别是，如果内存不可用，简单地拒绝添加球可能是有意义的。在这种情况下，最好不要存储新指针（或新计数），直到`realloc()`知道它已经工作。

# php - jquery + php + json 有点丢失

> ID：791408
> 
> 赞同：2
> 
> 时间：2009-04-26T19:09:27.007
> 
> 标签：php, javascript, jquery, json

我开始使用 jquery $.ajax() 但我无法取回我想要的......我发送这个：

```
$(function() {
  $.ajax({
    url: "graph_data.php",
    type: "POST",
    data: "casi=56&nada=48&nuevo=98&perfecto=100&vales=50&apenas=70&yeah=60",
    dataType: "json",
    error: function(xhr, desc, exceptionobj) {
      document.writeln("El error de XMLHTTPRequest dice: " + xhr.responseText);
    },
    success: function(json) {
      if (json.error) {
        alert(json.error);
        return;
      }
      var output = "";
      for (p in json) {
        output += p + " : " + json[p] + "\n";
      }
      document.writeln("Results: \n\n" + output);
    }
  });
}); 
```

我的php是：

```
<?php

$data = $_POST['data'];

function array2json($data){ 
    $json = $data;

    return json_encode($json);
}
?> 
```

当我执行此操作时，我得出：

> 结果：

就像我曾经在 php 中有一个 echo array2json 语句一样，但它只是给出了胡言乱语......我真的不知道我做错了什么，我已经用谷歌搜索了大约 3 个小时，只是得到了基本相同的东西。另外我不知道如何以另一种方式将参数传递给 $.ajax 函数中的“数据：”，例如从网页获取信息，有人可以帮我吗？

* * *

**编辑**

我做了你的建议，它现在打印数据非常感谢你=）但是，我想知道，我怎样才能将数据发送到 jQuery 中的“数据：”部分，所以它从假设用户输入中获取它，我也是正在检查 php 文档，它说我可以写如下内容：

```
json_encode($a,JSON_HEX_TAG|JSON_HEX_APOS|JSON_HEX_QUOT|JSON_HEX_AMP) 
```

但是，如果我这样做，我会收到一条错误消息，说 json_encode 接受 1 个参数，而我给了 2 个……知道为什么吗？我正在使用 php 5.2

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-26T19:11:38.890

首先：您传递给 PHP 脚本的数据将在 中`$_POST`，而不是在`$_POST['data']`.

下一步：您需要`array2json`使用一些数据实际调用该函数......这是完整的代码示例吗？

另外，我不确定`array2json`应该做什么......为什么不`json_encode`直接打电话？

对于您的示例，您可以简单地使您的 PHP 文件如下所示：

```
print json_encode($_POST); 
```

最后，你应该得到一个像[Firebug](http://getfirebug.com/)这样的工具来轻松调试你的 AJAX 调用。

**编辑**：

为了从用户那里发送数据，您所要做的就是在页面的任何地方都有一个[表单](http://www.w3schools.com/html/html_forms.asp)，然后捕获它的[提交](http://docs.jquery.com/Events/submit#fn)事件并[序列化](http://docs.jquery.com/Ajax/serialize)数据，或者只是[获取](http://docs.jquery.com/Attributes/val)单个输入字段的值。然后你可以用它来构造你的数据查询，作为一个字符串或一个对象。还有一个非常流行的 jQuery[表单插件](http://malsup.com/jquery/form/)，它使这一切变得更容易。

您收到错误的原因是因为[`json_encode`](http://www.php.net/json_encode)直到 PHP 5.3.0 才添加的第二个参数。因此，如果您在此之前有任何东西，您将无法使用它。

# iphone - 复杂的 iPhone 表格视图，诀窍在哪里？

> ID：791410
> 
> 赞同：1
> 
> 时间：2009-04-26T19:09:57.643
> 
> 标签：iphone, uitableview

我想知道人们如何在 iPhone 模拟器中填充一个类似于 Safari 首选项中的表格视图。

我想我有一个 tableview 控制器，然后我以编程方式添加控件？（一个接一个！？）我错过了什么技巧吗？如果我使用资源列表或数组，我能得到相同的结果吗？我的意思是，有一个复杂的设置，漂亮的图标，标签等......

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T21:51:19.020

Safari 的 iPhone 首选项是一个包含多个自定义表格单元类别的分组表格视图——它看起来至少有三种不同的类型。其中一些可能只是带有文本和附件视图的标准单元格。您可以通过继承 UITableViewCell 来创建自定义表格单元格。在 –tableView:cellForRowAtIndexPath: 的实现中，为节和行返回适当类型的单元格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-23T07:19:44.460

你应该看看苹果的 UICatalouge 样本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T21:18:14.543

您的 tableview 数据源需要实现 cellForRowAtIndexPath，以便它为需要显示的任何行提供适当类型的单元格。您可以创建包含其他控件的单元格。您*可以*在 InterfaceBuilder 中创建原型单元，但到目前为止，我总是以编程方式完成。

# jquery - 使用 jQuery 进行离线数据存储和访问

> ID：791412
> 
> 赞同：4
> 
> 时间：2009-04-26T19:10:26.537
> 
> 标签：jquery, google-gears, offline-mode

有没有人有在 jquery 上编写离线数据存储和访问应用程序的经验。我的服务器端应用程序将是一个 ASP.Net 应用程序。基本上，我将提供我的网络应用程序的精简版本，以便用户可以在离线时访问一些数据，并在他们再次连接时可以同步数据。我听说过 google gears，但想听听使用过它或对此主题了解更多的人的意见。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T01:09:10.277

没有插件很难做到，因为你唯一的选择是一个有 4k 限制的 Cookie。

看起来其他人建议的 jquery-store 使用 Flash 作为数据存储。 [http://code.google.com/p/jquery-jstore/](http://code.google.com/p/jquery-jstore/)。我有偏见，除非绝对必要，否则我不喜欢闪光灯。我有它和记忆的问题。所以这里有一些其他的选择：

Google Gears 似乎是您想要的。 [http://gears.google.com/](http://gears.google.com/)

Gears 它不是 jQuery 特定的。有人正在为它编写一个 jQuery 包装器[http://code.google.com/p/jquery-offline/](http://code.google.com/p/jquery-offline/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-12T09:36:42.823

这可能会有所帮助[jquery-offline](https://github.com/wycats/jquery-offline#readme)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-27T11:05:41.583

为此有一些 jquery 插件：http: [//plugins.jquery.com/taxonomy/term/1589](http://plugins.jquery.com/taxonomy/term/1589)

这也是一篇关于此事的好帖子：

# actionscript-3 - 如何停止加载 Flash 文件 (.swf) (ActionScript 3)

> ID：791422
> 
> 赞同：0
> 
> 时间：2009-04-26T19:17:12.823
> 
> 标签：actionscript-3, flash

假设我有一个大的 .swf 文件。说，它是10MB。在用户单击第 1 帧中的按钮之前，我不希望浏览器加载整个文件。

我不想使用外部文件。我只想让 Flash Player 先下载 10KB，显示第 1 帧，然后停止，直到用户单击按钮。

甚至可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T19:32:24.737

据我所知，没有办法在 swf 文件中的特定点停止加载 Flash Player。

您是否有任何特殊原因要避免使用外部文件？因为我建议为此使用一个小的 10KB 预加载器 swf。一旦用户单击该按钮，它就会使用 flash.net.URLLoader 加载您的 10MB 主 swf 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T22:53:24.393

不使用外部文件是不可能的。要使用外部文件执行此操作，只需执行 Shrill 所说的操作

但更好的问题是为什么？如果第一帧为 10kb，则在加载 10kb 的文件时，第一帧将准备好播放。

您可以等到第一帧加载完毕并播放它（其余的将在后台不可见地下载），然后一旦用户单击按钮，它就会执行以下两项操作：如果其他所有操作都已完成，然后继续，如果没有，则监视其余的加载过程，直​​到它是，然后继续:)

swf 文件是一种可流式传输的格式，利用它没有任何问题！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T22:52:49.230

Flash Player 将 SWF 文件视为流格式。这意味着当 Flash Player 下载第 1 帧的内容时，它将通过显示该帧上的内容并执行该帧上的代码来处理该帧。Flash Player 将同时开始下载第 2 帧。

如果你放置一个 stop(); 帧 #1 上的命令，则播放将停止，但 Flash Player 将继续下载其余帧。这样你就可以制作一个预加载器。您在第一帧停止播放，创建一个 onEnterFrame 来监控 SWF 文件的加载量，一旦 100% 继续播放。

对您的问题的简短回答，不，您不能阻止 Flash Player 下载以下帧，您确实需要使用外部 SWF 文件来达到您的目的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T19:26:00.227

我不认为这是可能的。您可以通过查看我相信的电影剪辑的 framesLoaded 属性来确保用户无法在整个电影完成下载之前单击第 1 帧中的按钮，但我认为您实际上不能在下载过程中停止剪辑.

# mysql - 使用正则表达式处理编码字符的 MySQL 查询

> ID：791426
> 
> 赞同：1
> 
> 时间：2009-04-26T19:18:37.483
> 
> 标签：mysql, regex

我的问题涉及在给定初始搜索字符串的情况下在 MySQL 表中搜索匹配城市名称的列表，目的是处理使用 html 实体 (ö) 编码的特殊字符，例如 ö 等。

例子：

有一张表叫做“城市”。城市名称的列称为“名称”。有两个城市 Hamberg (id 1) 和 Hämeenlinna (id 2) 存储为 Hämeenlinna。

有人使用字符串“Ham”进行搜索。标准查询，例如

```
SELECT id, name FROM cities WHERE name LIKE '%Ham' 
```

只会返回第一个。

我有一个正则表达式，可以从实体中解析出字符，但它是在 PHP 中实现的，并在下面提供以确保完整性。

```
preg_replace("/&(.).*;/", '$1', $city_name); 
```

**是否有一个查询包含大多数具有实体的单个字符？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T19:22:29.020

您不应该在数据库中使用 HTML 字符引用。相反，您应该选择正确的[编码和排序规则](http://dev.mysql.com/doc/refman/5.1/en/charset.html)，并以纯文本形式存储数据。

# c# - 未引用导入 App_Code 的文件

> ID：791427
> 
> 赞同：1
> 
> 时间：2009-04-26T19:18:46.187
> 
> 标签：c#, .net, asp.net, assemblies

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T19:33:01.817

对于第一个问题，我们需要更多的上下文。您可以发布类定义或至少是标题吗？还有它被引用的地方？

对于第二个问题，使用 bin\Debug 之外的问题。obj 文件夹主要由编译器和编译系统使用，用于存放在编译过程中使用的临时文件。这些文件在许多方面都是临时的，可以通过许多操作删除。依赖 bin\debug 中的文件要好得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-07-11T14:32:36.343

第一个问题的答案是：

*   右键单击 App_Code 文件夹中的 .cs 文件并检查其属性
*   确保构建操作设置为编译

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T20:27:30.297

对于第一个问题，尝试右键单击您的 App_Code 文件夹并从该菜单中添加一个新类。然后从旧文件中复制您的代码。看看情况如何。

对于第二个问题。听起来您已经添加了“项目参考”。当您这样做时，Visual Studio 会在构建时自动将 DLL 从类库输出文件夹（在本例中为 obj/debug）复制到 Web 应用程序 Bin 文件夹中。如果您已添加项目引用，则无需直接添加对 DLL 的其他引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-07T02:38:37.147

对于您的 1\. 问题：从 app_code 剪切 .cs 文件，将它们粘贴到根目录。更改 .cs 文件名。更改要编译的 .cs 文件内容的属性。编译您的项目，然后您可以将它们添加回 app_code 文件夹。

# java - ArrayList 中的 Java 排序对象

> ID：791429
> 
> 赞同：5
> 
> 时间：2009-04-26T19:20:32.767
> 
> 标签：java, collections

嗨，我有 Card 类...在另一个类中，我创建了 Card 对象的 arrayList。我将如何根据卡的值对 arrayList 进行排序？王牌是最低的牌面值，国王是最高的牌面值。

A,2,3,4,5,6,7,8,9,T,J,Q,K

```
public class Card {

        char rank, suit;

        public Card(char rank, char suit){
                this.rank = rank;
                this.suit = suit;
        }

        public void setCard(char rank, char suit){
                this.rank = rank;
                this.suit = suit;
        }

        public char getRank(){
                return rank;
        }

        public char getSuit(){
                return suit;
        }

        public void setRank(char rank){
                this.rank = rank;
        }

        public void setSuit(char suit){
                this.suit = suit;
        }

        public String toString(){
                String str = "";
                str += this.getRank();
                str += this.getSuit();
                return str;
        }

          public boolean equals(Object obj){
               Card card = (Card) obj;
               if(this.rank == card.getRank() && this.suit == card.getSuit()){
                   return true;
               }
               return false;
           }

    public boolean isValidCard(Card card){
        char s = card.getSuit();
        char r = card.getRank();
        if(s=='H' || s=='S' || s=='D' || s=='C'){
            if(r=='A' || r=='2' || r=='3' || r=='4' || r=='5' || r=='6' || r=='7' || 
                    r=='8' || r=='9' || r=='T' || r=='J' || r=='Q' || r=='K'){
                return true;
            }                   
        }
        return false;
     }

    public boolean allowedInHigherPiles(Card card, Game game, int pile){
        if(pile>=5 && game.getPile(pile).cards.size()==0){
                if(card.getRank()!='K')
                        return false;
        }
        return true;
    }

} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-26T19:30:15.770

如果您使用 enum 来表示等级和套件而不是 char，则代码会更简洁。

其实[http://jcp.org/aboutJava/communityprocess/jsr/tiger/enum.html](http://jcp.org/aboutJava/communityprocess/jsr/tiger/enum.html)有一个Card sample说明了Enum的使用

相关代码位复制如下

```
public class Card implements Comparable, java.io.Serializable {
    public enum Rank { deuce, three, four, five, six, seven, eight, nine, ten,
                       jack, queen, king, ace }
    public enum Suit { clubs, diamonds, hearts, spades }

    private final Rank rank;
    private final Suit suit;

    private Card(Rank rank, Suit suit) {
        if (rank == null || suit == null)
            throw new NullPointerException(rank + ", " + suit);
        this.rank = rank;
        this.suit = suit;
    }

    public Rank rank() { return rank; }
    public Suit suit() { return suit; }

    public String toString() { return rank + " of " + suit; }

    public int compareTo(Object o) {
        Card c = (Card)o;
        int rankCompare = rank.compareTo(c.rank);
        return rankCompare != 0 ? rankCompare : suit.compareTo(c.suit);
    }

    private static List<Card> sortedDeck = new ArrayList<Card>(52);
    static {
        for (Iterator<Rank> i = Rank.VALUES.iterator(); i.hasNext(); ) {
            Rank rank = i.next();
            for (Iterator<Suit> j = Suit.VALUES.iterator(); j.hasNext(); )
                sortedDeck.add(new Card(rank, j.next()));
        }
    }

    // Returns a shuffled deck
    public static List<Card> newDeck() {
        List<Card> result = new ArrayList<Card>(sortedDeck);
        Collections.shuffle(result);
        return result;
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-26T19:24:48.217

一种选择是实现 Comparable 接口，然后覆盖 compareTo 完成此操作后，使用 Collections.sort(myCollection) 对列表进行排序很容易；

您最好避免实现 Comparable 并创建一个[Comparator](http://java.sun.com/javase/6/docs/api/)对象，并且有一个 Collections.sort 版本采用比较器。

然后，您的比较函数可以简单地检查牌的等级，并在忽略花色的情况下返回结果。

您可能想阅读有关[所有这些订购业务](http://java.sun.com/docs/books/tutorial/collections/interfaces/order.html)的 Java 教程。

更新：Bjorn 正确地指出，当类具有自然排序顺序时，应该使用 Comparable。我个人的观点是，对于纸牌并没有真正的“自然顺序”，因为不同的游戏对 Ace 的解释不同，因此最好通过提供 Comparable 作为类的一部分来避免分配“语义”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-26T20:15:03.493

缺少的 CompareTo 代码：

```
ArrayList<Card> aCardList = new ArrayList<Card>();

    Collections.sort(aCardList, new Comparator<Card>() {

        @Override
        public int compare(Card o1, Card o2) {
            if (o1.getRank() > o2.getRank())
                return -1;
            else if (o1.getRank() < o2.getRank())
                return 1;
            else
                return 0;
        }
    }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T19:27:20.223

您可以实现[Comparable](http://java.sun.com/javase/6/docs/api/java/lang/Comparable.html)接口，以便按等级比较元素。然后[Collections.sort](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#sort(java.util.List))将自动执行您期望它执行的操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T19:27:50.753

您可以使用[java.util.Collections](http://java.sun.com/j2se/1.5.0/docs/api/index.html?java/util/Collections.html)类对其进行排序。特别是，两种方法可能会派上用场：

```
 static <T extends Comparable<? super T>>
 void sort(List<T> list)
      Sorts the specified list into ascending order, according to the natural ordering of its elements.

static <T> void sort(List<T> list, Comparator<? super T> c)
      Sorts the specified list according to the order induced by the specified comparator. 
```

对于第一种方法，您应该让您的 Card 类实现 Comparable 接口。对于第二种方法，您应该提供一个自定义比较器。

这样做是为了让集合框架知道如何比较您的 Card 对象。

因此，例如（第一种方法），您将拥有以下代码：

在你的卡片课上

```
public Class Card implements Comparable{

//member and method definitions.

public int compareTo(Object o){
   //null checks && stuff missing.

   /*compares two cards based on rank.*/   
}

List<Card> cards = getAllCards();//returns an unsorted list implementation of Card objects.

java.util.Collections.sort(cards); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-26T19:33:21.987

几个更短的方法

```
public String toString() {
   return "" + rank + suit;
}

public boolean isValidCard(){
    return "HSDC".indexOf(suit) != -1 &&
         "A23456789TJQK".indexOf(rand) != -1;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-07-12T09:31:09.530

```
public class ClassName implements Comparable<Object> {

    // Variables --------------------------------------------
    private double  comparedVariable; 

    // Constructor ------------------------------------------
    public ClassName (){}

    // Functions --------------------------------------------
    //returns the fuel weight
    public double getComparedVariable() {
        return comparedVariable;
    }

    // Overrides --------------------------------------------
    @Override
    public int compareTo(Object o) {

        ClassName classObject = (ClassName) o;

        if (this.comparedVariable> classObject.getComparedVariable())
            return 1; //make -1 to sort in decreasing order
        else if (this.comparedVariable< classObject.getComparedVariable())
            return -1;//make 1 to sort in decreasing order
        else
            return 0;
    }

} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-06-26T11:02:41.440

```
public class player {
     String Fname = "";
    String Lname = "";
    ArrayList<Card> cards= new ArrayList<Card> ();
    public String getFname() {
        return Fname;
    }

    public void setFname(String Fname) {
        this.Fname = Fname;
    }

    public String getLname() {
        return Lname;
    }

    public void setLastname(String Lname) {
        this.Lname = Lname;
    }

    public ArrayList<Card> getCards() {
        return cards;
    }

    public void setCards(ArrayList<Card> cards) {
        this.cards = cards;
    }

    public player(String fname,String lname) {
        this.Fname = fname;
        this.Lname = lname;
    }

    public void AddCard(Card card){
        cards.add(card);
    }

    public void showCards(){
        System.out.println(""+Fname+" "+Lname+" holds the following cards");
        for (int i=0;i<cards.size();i++)
        {
            System.out.print(cards.get(i).toString());
        }
        System.out.println();
    }

    public void Sortcardsbyface()
    {
        for (int i = 0; i < cards.size() - 1; i++)
        {
            int j = i;
            for (int k = i + 1; k < cards.size(); k++)
            {
                Card c = new Card();
                if (c.toInt(cards.get(k).getFace()) < c.toInt(cards.get(j).getFace()))
                {
                    j=k;
                }

            }

            Card temp = cards.get(j);
            cards.set(j,cards.get(i));
            cards.set(i,temp);

        }
        showCards();
    }
}

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package pokegame;

/**
 *
 * @author admin
 */
public class Card {
     private String face;
    private char suit; 

    Card(char suit,String face) {
        this.suit = suit;
        this.face = face;
    }

    Card() {

    }

    public String getFace() {
        return face;
    }

    public void setFace(String face) {
        this.face = face;
    }

    public char getSuit() {
        return suit;
    }

    public void setSuit(char suit) {
        this.suit = suit;
    }

    public String toString(){
        return face+suit;  
    }

    public int toInt(String face){
        switch(face){
            case "A":
                return 1;
            case "J":
                return 11;
            case "Q":
                return 12;
            case "K":
                return 13;
            case "2":
                return 2;
            case "3":
                return 3;
            case "4":
                return 4;        
            case "5":
                return 5;        
            case "6":
                return 6;
            case "7":
                return 7;    
            case "8":
                return 8;    
            case "9":
                return 9;    
            case "10":
                return 10;    

            default:
                return 0;
        }
    }

} 
```

# c# - 网站 --> 添加引用也会创建带有 pdb 扩展名的文件

> ID：791430
> 
> 赞同：0
> 
> 时间：2009-04-26T19:21:12.563
> 
> 标签：c#, .net, asp.net, assemblies

Q1 存储在 Bin 目录中的任何程序集都会被 Web 应用程序自动引用。我们可以通过*网站添加程序集引用 --> 添加引用*或简单地将 dll 复制到 Bin 文件夹中。但我注意到，当我们通过*Website --> Add Reference 添加引用*时，带有 .pdb 扩展名的附加文件被放置在 Bin 中。如果还需要这些文件，那么为什么即使我们只将引用的dll放入Bin，而不是pdb文件，引用仍然有效

Q2 似乎如果你在 web 项目中添加一个新项目，这个类将自动添加到项目列表中，我们可以从这个项目的所有页面中引用它。

那么添加到项目列表中的所有文件是否都会被自动引用？

谢谢

**编辑：**

> 关于第二个问题，您正在向命名空间添加一个公共类，因此该项目和该命名空间中的其他类将可见。

我对程序集了解不多，但我假设添加到项目中的 item( class ) 对该项目中的其他类可见的原因是因为在 web 项目中所有类都被编译成单个程序集和因为同一程序集中包含的公共类总是彼此可见的事实？

非常感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T19:24:41.290

1.  PDB 用于在堆栈跟踪中为您提供行号。它总是可选的
2.  不，您需要从每个项目中具体引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T19:27:26.823

[PDB 文件](http://msdn.microsoft.com/en-us/library/ms241903.aspx)是一个“编程数据库”，由调试器使用。不必编译或运行您的应用程序。（顺便说一下，您不应该部署您的 PDB 文件）。

[关于第二个问题，您正在向命名空间](http://msdn.microsoft.com/en-us/library/z2kcy19k(VS.80).aspx)添加一个公共类，因此该项目和该命名空间中的其他类将可见。[您可以使用访问修饰符](http://msdn.microsoft.com/en-us/library/ms173121(VS.80).aspx)更改类的可见性（谁可以“看到”该类）。

# php - Magento 1.3 - 左侧菜单

> ID：791434
> 
> 赞同：0
> 
> 时间：2009-04-26T19:24:10.700
> 
> 标签：php, magento, templates, menu, catalog

我想知道是否有人有解决方案来启用 Magento 1.3 中的左侧菜单。我找到了我想使用的文件

```
design/frontend/default/default/template/catalog/navigation/left.phtml 
```

但我不确定如何自定义我的模板以启用它。我发现的教程似乎与早期版本的 magento 有关。

编辑-我尝试了该解决方案，但它仅在我的视图中移动标注元素，分类菜单仍显示在页面顶部而不是左侧窗格中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T02:48:17.667

您必须更改页面布局模板以启用左侧栏菜单，这可以在 admin 、 CMS -> Manage Pages ... 将布局更改为 '...with left bar' 选项。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-07T03:24:46.733

您可以在布局 XML 文件中设置模板。

# memory-management - 为什么纯函数式语言不使用引用计数？

> ID：791437
> 
> 赞同：47
> 
> 时间：2009-04-26T19:24:54.113
> 
> 标签：memory-management, functional-programming, garbage-collection, reference-counting, purely-functional

在纯函数式语言中，数据是不可变的。使用引用计数，创建引用循环需要更改已创建的数据。似乎纯函数式语言可以使用引用计数而不必担心循环的可能性。是对的吗？如果是这样，他们为什么不呢？

我知道在许多情况下引用计数比 GC 慢，但至少它减少了暂停时间。在暂停时间不好的情况下，可以选择使用引用计数。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-27T02:08:01.570

相对于 Java 和 C# 等其他托管语言，**纯函数式语言的分配非常疯狂**。它们还分配不同大小的对象。已知最快的分配策略是从连续的空闲空间（有时称为“托儿所”）进行分配，并保留一个硬件寄存器以指向下一个可用的空闲空间。从堆分配变得与从堆栈分配一样快。

引用计数与这种分配策略根本不兼容。引用计数将对象放在空闲列表中，然后再次将它们删除。引用计数还需要在创建新对象时更新引用计数所需的大量开销（如上所述，纯函数式语言确实如此疯狂）。

在以下情况下，引用计数往往会做得很好：

*   几乎所有堆内存都用于保存活动对象。
*   相对于其他操作而言，分配和指针分配并不常见。
*   引用可以在另一个处理器或计算机上进行管理。

要了解当今最好的高性能引用计数系统是如何工作的，请查看[David Bacon](http://domino.research.ibm.com/comm/research_people.nsf/pages/bacon.index.html)和[Erez Petrank](http://www.cs.technion.ac.il/~erez/)的工作。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-26T19:28:44.183

您的问题是基于错误的假设。完全有可能拥有循环引用和不可变数据。考虑以下使用不可变数据创建循环引用的 C# 示例。

```
class Node { 
  public readonly Node other;
  public Node() { 
    other = new Node(this);
  }
  public Node(Node node) {
    other = node;
  }
} 
```

这种类型的技巧可以在许多函数式语言中完成，因此任何收集机制都必须处理循环引用的可能性。我并不是说循环引用不可能使用引用计数机制，只是必须处理它。

### 由[ehemient编辑](https://stackoverflow.com/users/20713)

作为对评论的回应......这在Haskell中是微不足道的

```
data Node a = Node { other :: Node a }
recursiveNode = Node { other = recursiveNode } 
```

在 SML 上几乎没有任何努力。

```
datatype 'a node = NODE of unit -> 'a node
val recursiveNode : unit node =
    let fun mkRecursiveNode () = NODE mkRecursiveNode
    in mkRecursiveNode () end 
```

不需要突变。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-26T19:30:54.333

我认为有几件事。

*   **有循环：许多语言*中***的“let rec”确实允许创建“循环”结构。除此之外，不变性通常并不意味着没有循环，但这违反了规则。
*   **引用计数在列表中很糟糕**：我不知道引用计数集合适用于您经常在 FP 中找到的长单链表结构（例如，速度慢，需要确保尾递归，...）
*   **其他策略有好处**：正如您所提到的，其他 GC 策略通常仍然更适合内存局部性

（曾几何时，我想我可能真的“知道”这一点，但现在我试图记住/推测，所以不要把它当作任何权威。）

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-12-22T21:49:06.470

> 是对的吗？

不完全的。您可以使用纯函数式编程简单地通过同时定义相互递归的值来创建循环数据结构。例如，在 OCaml 中：

```
let rec xs = 0::ys and ys = 1::xs 
```

但是，可以定义语言，使其无法通过设计创建循环结构。结果被称为*单向堆*，其主要优点是垃圾收集可以像引用计数一样简单。

> 如果是这样，他们为什么不呢？

有些语言确实禁止循环并使用引用计数。Erlang 和 Mathematica 就是例子。

例如，在 Mathematica 中，当您引用一个值时，您会对其进行深层复制，因此改变原始值不会改变副本：

```
In[1] := xs = {1, 2, 3}
Out[1] = {1, 2, 3}

In[2] := ys = xs
Out[2] = {1, 2, 3}

In[3] := xs[[1]] = 5
Out[3] = 5

In[4] := xs
Out[4] = {5, 2, 3}

In[5] := ys
Out[5] = {1, 2, 3} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-25T04:23:59.780

想想这个关于[Lisp 机器](http://en.wikipedia.org/wiki/Lisp_machine)的发明者[David Moon的](http://scholar.google.com/scholar?q=david+moon&hl=en&lr=&btnG=Search)[寓言](http://en.wikipedia.org/wiki/AI_koans)：

> 有一天，一位学生来找 Moon 说：“我知道如何做一个更好的垃圾收集器。我们必须保留每个 cons 指针的引用计数。”
> 
> 穆恩耐心地给学生讲了以下故事：
> 
> > “有一天，一个学生来到月球说：‘我知道如何做一个更好的垃圾收集器......

* * *

## 回答 #6

> 赞同：-6
> 
> 时间：2009-04-26T19:28:12.687

引用计数比 GC 慢得多，因为它对 CPU 不利。并且 GC 大部分时间可以等待空闲时间，并且 GC 可以并发（在另一个线程上）。所以这就是问题所在 - GC 是最不邪恶的，并且许多尝试表明了这一点。

# java - PPP 的免费 C/C++ 和 Java 实现？

> ID：791452
> 
> 赞同：1
> 
> 时间：2009-04-26T19:32:39.213
> 
> 标签：java, c, ppp

是否有通过串行线路使用的点对点协议 (PPP) 的免费 C/C++ 和 Java 实现？C/C++ 实现将进入嵌入式硬件，因此可移植性是一个问题。我不是在寻找一个完整的 TCP/IP 堆栈，只是提供一个面向连接的基础来构建的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T20:26:13.797

大多数基于 Linux 的系统中使用的是 C 语言，名为[Paul's PPP Package](http://ppp.samba.org/)。

FreeBSD 有一个完全不同的，也是用 C 编写的，但我没有使用它的经验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T20:29:19.153

在 linux 中，我使用 chat 和 pppd 在 linux 中通过串行线路使用 ppp。（添加 gprs 调制解调器以获得互联网连接）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T21:04:44.450

我找到了一个名为 TINI 的库，其中包含一个 ppp java 实现
[http://raud.ut.ee/~tec/static/api/tini1.15/javadocs/firmware/index.html](http://raud.ut.ee/~tec/static/api/tini1.15/javadocs/firmware/index.html)

更多描述在这里
[http://www.maxim-ic.com/products/ibutton/software/1wire/1wire_api.cfm](http://www.maxim-ic.com/products/ibutton/software/1wire/1wire_api.cfm)

希望能帮助到你

# installation - 如何通过 .msi 包修改 machine.config

> ID：791455
> 
> 赞同：2
> 
> 时间：2009-04-26T19:33:51.143
> 
> 标签：installation, windows-installer, machine.config

我正在尝试创建一个将部署 .NET 托管数据提供程序的安装程序。为了让数据提供者在应用程序下拉列表中显示为提供者，我必须在 machine.config 的部分中添加提供者：

```
<system.data>
    <DbProviderFactories>
      <add name="My Data Provider" 
           invariant="Sample.MyDataProvider" 
           description="My Data Provider" 
           type="Eli.Sample.MyDataProvider, Sample.MyDataProvider, Version=1.0.0.0, Culture=neutral, PublicKeyToken=5b9d34470b87a97f" 
      />
    </DbProviderFactories>
</system.data> 
```

我该怎么做呢？只是一个指针就可以了。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T13:19:01.397

如果您使用 Wix，则可以使用[XmlConfig](http://wix.sourceforge.net/manual-wix2/wix_xsd_xmlconfig.htm)元素。

```
<util:XmlConfig 
        Id="Machine_Config_Xml_Root"
        File="[WindowsFolder]Microsoft.NET\Framework\v2.0.50727\CONFIG\Machine.Config"
        Action="create" 
        On="install"
        ElementPath="//configuration/system.data/DbProviderFactories" 
        Name="add"
        Node="element" 
        Sequence="1"> 
 </util:XmlConfig> 
 <util:XmlConfig 
        Id="Machine_Config_Xml_2"
        File="[WindowsFolder]Microsoft.NET\Framework\v2.0.50727\CONFIG\Machine.Config"
        ElementPath="Machine_Config_Xml_Root"
        Name="name"
        Value="My Data Provider" 
        Sequence="2"> 
 </util:XmlConfig>
 <util:XmlConfig 
        Id="Machine_Config_Xml_2"
        File="[WindowsFolder]Microsoft.NET\Framework\v2.0.50727\CONFIG\Machine.Config"
        ElementPath="Machine_Config_Xml_Root"
        Name="invariant"
        Value="Sample.MyDataProvider" 
        Sequence="2"> 
 </util:XmlConfig>
 <util:XmlConfig 
        Id="Machine_Config_Xml_2"
        File="[WindowsFolder]Microsoft.NET\Framework\v2.0.50727\CONFIG\Machine.Config"
        ElementPath="Machine_Config_Xml_Root"
        Name="description"
        Value="My Data Provider" 
        Sequence="2"> 
 </util:XmlConfig>
 <util:XmlConfig 
        Id="Machine_Config_Xml_2"
        File="[WindowsFolder]Microsoft.NET\Framework\v2.0.50727\CONFIG\Machine.Config"
        ElementPath="Machine_Config_Xml_Root"
        Name="type"
        Value="Eli.Sample.MyDataProvider, Sample.MyDataProvider, Version=1.0.0.0, Culture=neutral, PublicKeyToken=5b9d34470b87a97f" 
        Sequence="2"> 
 </util:XmlConfig>

 <util:XmlConfig 
    Id="Machine_Config_Xml_Uninstall_1"
    File="[WindowsFolder]Microsoft.NET\Framework\v2.0.50727\CONFIG\Machine.Config"
    Action="delete"
    On="uninstall"
    ElementPath="//configuration/system.data/DbProviderFactories/add[\[]@invariant='Sample.MyDataProvider'[\]]"
    Sequence="1">
 </util:XmlConfig> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T19:49:17.940

您需要创建一个[自定义安装程序操作](http://msdn.microsoft.com/en-us/library/d9k65z2d(VS.80).aspx)并将其添加到您的 MSI 以执行此操作（我假设您正在使用 Visual Studio 安装项目执行此操作）。

# sqlite - 如何知道一行是否不存在？

> ID：791457
> 
> 赞同：1
> 
> 时间：2009-04-26T19:36:53.337
> 
> 标签：sqlite

我有以下查询：

```
SELECT rowid FROM table1 ORDER BY RANDOM() LIMIT 1 
```

而且我还有另一张桌子（table3）。在该表中，我有 table1_id 和 table2_id 列。table1_id 是指向 table1 中的行的链接，而 table2_id 是指向另一个表中的行的链接。

我希望在我的查询中只获得 table3 中定义的那些结果。只有那些在其 table1_id 列中有 table1 rowid 的人。可能根本没有任何列引用某个 table1 rowid，所以在这种情况下，我不想接收它们。

我怎样才能实现这个目标？

更新：我尝试了以下查询，但不起作用：

```
SELECT rowid FROM table1
WHERE rowid IN (SELECT table1_id FROM table3 WHERE table1_id = table1.rowid)
ORDER BY RANDOM() LIMIT 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T20:34:37.363

```
SELECT rowid FROM table1
WHERE rowid IN ( SELECT DISTINCT table1_id FROM table3 )
ORDER BY RANDOM() LIMIT 1; 
```

这个查询的意思是“随机选择一行，`table1`其中有一个条目`table3`”。

表 1 中的每一行都具有被选中的可能性 ( `DISTINCT`)，只要它在 中至少被引用一次`table3`。

如果您试图获得多个结果，那么您应该删除 " `ORDER BY RANDOM() LIMIT 1`" 子句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T04:17:09.093

假设您想选择的*不仅仅是*一个 rowid，您需要**从您感兴趣的表之间的[JOIN](http://en.wikipedia.org/wiki/Join_(SQL))**中选择。SQLite 没有完整的标准 JOIN 功能，因此您需要重新工作查询，以便它可以使用[LEFT OUTER JOIN](http://en.wikipedia.org/wiki/Join_(SQL)#Left_outer_join)。

```
SELECT table1.rowid, table1.other_field
FROM table3
    LEFT OUTER JOIN table1 ON table3.table1_id = table1.rowid
ORDER BY RANDOM()
LIMIT 1; 
```

# objective-c - 在Objective C中传递浮点“byref”？

> ID：791458
> 
> 赞同：0
> 
> 时间：2009-04-26T19:37:27.140
> 
> 标签：objective-c

有没有办法将浮点“byref”传递给目标C中的方法？这是我所拥有的概述：

方法签名：

```
- (void) MyMethod: (float*) min max:(float*) max; 
```

方法：

```
- (void) MyMethod: (float*) min max:(float*) max
{
} 
```

试图调用它：

```
float min1 = 0; float max1 = 0; 
[self MyMethod: min:&min1 max:&max1]; 
```

我收到以下警告，并且在尝试调用 MyMethod 时代码异常终止：

警告：“MyClass”可能不会响应“+MyMethod:min:max:”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T19:42:00.657

您的方法的签名声明为

```
- (void) MyMethod: (float*) min max:(float*) max 
```

但你称它为

```
- MyMethod:min:max: 
```

...其中包括一个不在声明中的额外“分钟：”。

尝试将您的呼叫代码更改为

```
float min1 = 0; float max1 = 0; 
[self MyMethod:&min1 max:&max1]; 
```

看看这是否会有所改善。

但是，我看到您的错误消息抱怨签名“+ MyMethod:min:max:”，这也表明您正在尝试将消息发送到*类*而不是类的*实例*；你将不得不纠正这一点。

最后，Objective-C 代码中的方法选择器通常以小写字母开头；您可能想阅读常见[的 Objective-C 命名约定](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/CodingGuidelines/CodingGuidelines.html)。

# database - 唯一的基类实例

> ID：791459
> 
> 赞同：1
> 
> 时间：2009-04-26T19:37:30.777
> 
> 标签：database, singleton, base

我正在开发一个包含三个类的 C++ dll：说基类`Base`和`Derived1`类`Derived2`。场景：

```
class Base
{
   //ctor, dtor, members and methods here
}

class Derived1 : public Base
{
   //ctor, dtor, members and methods here
}

class Derived2 : public Base
{
   //ctor, dtor, members and methods here
} 
```

我正在使用 MS VC++ 2008 Express 创建的 dll，我想在 Turboc++ 下使用它（borland：非常好的 ide/rad）。

我`Derived1`通过 facotry 方法导出，并通过客户端代码`Derived1`生成`Derived2`. 两者都`Derived1`共享`Derived2`一个包含在另一个 dll 中的指针函数，所以我将该指针函数放在基类下。

这是问题所在。一旦我创建一个实例（通过工厂）`Derived1`并且它可以创建多个实例`Derived2`，`Base`类构造函数被调用更多次（1`Derived1`次和多次`Derived2`）。

如何防止 Base 的多个实例？

**另一个问题：**

在我之前描述的场景中，`Derived1`调用 和 的多个实例并`Derived2`扩展唯一的公共基类。我问：这是一个糟糕的设计？有没有比我使用的更好的类及其继承层次结构的另一种设计？`Derived1``Derived2`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T19:41:51.717

您不能阻止 Base 的多个实例。您可以防止指针的多个实例 - 使其成为静态：

```
class Base {
    public:
        // save first pointer I get passed
        Base( sometype * p ) {
            if ( myptr == 0 ) {
               myptr = p;
            }
        }

    private:

       static sometype * myptr;
}; 
```

在 C++ 源文件中，您需要定义 myptr：

```
sometype * Base::myptr = 0; 
```

# visual-studio-2008 - 什么是 ec2-授权？

> ID：791460
> 
> 赞同：1
> 
> 时间：2009-04-26T19:39:11.177
> 
> 标签：visual-studio-2008, amazon-ec2

我是 EC2 的新手，正在尝试对其进行设置，以便我可以从 VS2008 直接发布到它。每个人都不断提到使用“ec2-authorize”来启用某些东西，但这到底是什么？似乎无处解释它是什么或从哪里访问它。我在实际的 ec2 实例中从命令行尝试了它，但那里什么也没有。

PS 我正在使用 EC2 的 Windows 实例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T20:41:03.977

你到底想做什么？管理大量实例或只是将新代码发布/部署到一个实例？

[ec2-authorize](http://docs.amazonwebservices.com/AWSEC2/2009-03-01/DeveloperGuide/index.html?CLTRG-authorize.html)是一个简单的命令，用于控制与您的实例相关的防火墙规则，例如您的 Web 服务器的端口 80。

您不必安装 Java，如果它只是少数实例/操作，您可以使用[EC2 控制台](http://console.aws.amazon.com/ec2/home)，它支持来自 EC2 API 的大部分操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T20:22:07.533

啊，我想我终于找到了：

[http://developer.amazonwebservices.com/connect/entry.jspa?externalID=351&categoryID=88](http://developer.amazonwebservices.com/connect/entry.jspa?externalID=351&categoryID=88)

不幸的是，这意味着我必须安装 Java。***叹*

# php - 与php保持实时连接？

> ID：791464
> 
> 赞同：3
> 
> 时间：2009-04-26T19:41:54.930
> 
> 标签：php, performance, keep-alive, output-buffering

我正在做一个项目，让我不断地为新数据 ping 一个 php 脚本，所以如果我正确理解这一点，这意味着被 ping 的 php 脚本会无限期地反复运行。它有效，但我猜它对服务器造成了巨大的压力，并且可能被认为是丑陋和糟糕的做法。我说得对吗？

有什么办法可以保持与脚本的连接并利用 php 的内置输出缓冲来刷新我需要的内容，但是使用某种循环保持脚本无限运行，这样当新数据可用时它可以是输出。这也是一个坏主意吗？

我只是在寻找有更多经验的输入表单开发人员。

最后一件事...

是否有任何其他方法可以保持数据的持续流动（不包括闪光灯或 Silverlight 等技术）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T19:46:37.137

如果您当前的工作并在针对您可能在此应用程序中预期的负载进行测试时继续工作，那么这并不是真正的不良做法。如果它有效，保持简单并不是犯罪。任何符合您所描述的内容都将违背网络原始模型的纹理，因此您正在冒险进入摇摇欲坠的领域。

我建议您查看[Comet](http://www.google.com/search?q=comet+programming)技术。它最流行的是与您想要的相反 - 服务器将信息连续推送到页面 - 但它显然可以双向工作。尽管您的里程可能会有所不同，但我听说了一些好事。正如维基百科所描述的：

> 在 Web 开发中，Comet 是描述 Web 应用程序模型的新词，在该模型中，长期持有的 HTTP 请求允许 Web 服务器将数据推送到浏览器，而无需浏览器显式请求。Comet 是实现这种交互的多种技术的总称。所有这些方法都依赖于浏览器中默认包含的功能，例如 Javascript，而不是非默认插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T19:51:03.973

看起来 php 似乎不是最好的语言选择。可能考虑使用诸如 scala 或 erlang 之类的东西来更好地处理这种类型的长期消息传递。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T19:53:05.293

您必须学习如何在 php 中使用套接字。

从这里开始：http: [//php.net/manual/en/book.sockets.php](http://php.net/manual/en/book.sockets.php)

这里是关于编写独立 php 应用程序的有用手册：[Advanced PHP Programming](https://rads.stackoverflow.com/amzn/click/com/0672325616)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T19:58:34.767

我会说这取决于。如果您希望由客户端启动数据传输，那么您最好的选择是一些 ajax（如 getxmlhttpobject 或 iframe，如果您想作弊 :P）。如果您希望由服务器启动传输，那么 php 可能不是您要使用的语言。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-26T20:16:25.253

您可以使用 ajax 来进行 http-streaming。看看[ajaxpatterns](http://ajaxpatterns.org/HTTP_Streaming)。

# asp.net - 当前使用表单身份验证构建时，在 Web 应用程序中支持活动目录是否困难？

> ID：791466
> 
> 赞同：0
> 
> 时间：2009-04-26T19:42:40.453
> 
> 标签：asp.net, active-directory, forms-authentication

我有一个当前仅支持 asp.net 表单身份验证的 Web 应用程序。

我的用户业务逻辑目前是这样的：

Users.GetUserByID(userID); Users.LoginUser（用户名，密码）；

即它是非常模块化的，我希望支持活动目录不会很困难。

我可以同时支持 AD 和表单吗？如果是，我该怎么办，只需为第一次登录使用 AD 的人插入一个新用户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-26T19:50:43.397

不，您唯一需要做的就是将您的会员提供者与 Active Directory 会员提供者联系起来。但是有一些主要区别，用户将始终使用特定的用户名登录，因此不需要用户名和密码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-22T12:05:28.710

AD 的默认提供程序是“windows 集成身份验证”，这不能与表单身份验证混合匹配。但是，如果您决定实现自定义提供程序，那么您可以维护您的业务逻辑。您将不得不编写 AD 集成代码。是的，如果您愿意，您可以使用 AD 的 API 自动添加用户。

# wcf - 如何获取 wcf 应用程序的工作路径？

> ID：791468
> 
> 赞同：69
> 
> 时间：2009-04-26T19:43:34.413
> 
> 标签：wcf, path, httpcontext

我想获取 WCF 应用程序的工作文件夹。我怎么才能得到它？

如果我尝试

```
HttpContext.Current.Request.MapPath(HttpContext.Current.Request.ApplicationPath) 
```

我得到一个空引用异常（Http.Current 对象为空）。

* * *

我对工作文件夹的意思是我的 WCF 服务正在运行的文件夹。如果我设置`aspNetCompatibilityEnabled="true"`，我会收到此错误：

> 服务器没有提供有意义的回复；这可能是由于合同不匹配、会话过早关闭或内部服务器错误造成的。

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2009-06-02T21:49:42.873

我的 IIS6 托管 WCF 应用程序需要相同的信息，我发现这对我有用：

```
string apPath = System.Web.Hosting.HostingEnvironment.ApplicationPhysicalPath; 
```

一如既往，YMMV。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-04-26T19:54:33.263

**请参阅下面的ongle的答案。它比这个要好得多。**

*更多信息后更新*

以下对我有用。我使用我通过 Service1.svc 在 IIS 上托管的新 WCF 服务对其进行了测试。

1.  添加`<serviceHostingEnvironment aspNetCompatibilityEnabled="true"/>`到网络配置。`<system.serviceModel>..</ ..>`已经存在。
2.  使用“允许模式”添加`AspNetCompatibilityRequirementsAttribute`到服务。
3.  用于`HttpContext.Current.Server.MapPath(".");`获取根目录。

下面是服务类的完整代码。我没有对 IService1 接口进行任何更改。

```
[AspNetCompatibilityRequirements(RequirementsMode=AspNetCompatibilityRequirementsMode.Allowed)]
public class Service1 : IService1
{
    public void DoWork()
    {
        HttpContext.Current.Server.MapPath(".");
    }
} 
```

以下是 web.config 的摘录。

```
<system.serviceModel>
    <!-- Added only the one line below -->
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true"/>

    <!-- Everything else was left intact -->
    <behaviors>
        <!-- ... -->
    </behaviors>
    <services>
        <!-- ... -->
    </services>
</system.serviceModel> 
```

**旧答案**

工作文件夹是什么意思？WCF 服务可以以多种不同的方式和不同的端点托管，因此工作文件夹有点模糊。

您可以通过调用[Directory.GetCurrentDirectory()](http://msdn.microsoft.com/en-us/library/system.io.directory.getcurrentdirectory.aspx)来检索正常的“工作文件夹” 。

HttpContext 是一个 ASP.Net 对象。即使 WCF 可以托管在 IIS 上，它仍然不是 ASP.Net，因此大多数 ASP.Net 技术在默认情况下都不起作用。OperationContext 是 WCF 的 HttpContext 等价物。OperationContext 包含有关传入请求、传出响应等信息。

尽管最简单的方法可能是通过在 web.config 中切换它来以[ASP.Net 兼容模式运行服务。](http://blogs.msdn.com/wenlong/archive/2006/01/23/516041.aspx)这应该使您可以访问 ASP.Net HttpContext。它会限制您使用 *HttpBindings 和 IIS 托管。要切换兼容模式，请将以下内容添加到 web.config。

```
<system.serviceModel>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true"/>
</system.serviceModel> 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2010-03-01T20:18:45.387

取决于你想要什么。我通常想解析像“~/folder/file”这样的url。这是有效的。

```
System.Web.Hosting.HostingEnvironment.MapPath("~/folder/file"); 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2013-06-04T09:24:16.507

更一般地说，我正在使用这个

```
AppDomain.CurrentDomain.BaseDirectory 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-04-26T20:21:15.150

aspNetCompatibilityEnabled="true" 应该已经解决了我的问题，但是我收到了这个错误：

> 服务器没有提供有意义的回复；这可能是由于合同不匹配、会话过早关闭或内部服务器错误造成的。

我通过从当前的应用程序域获取运行 WCF 服务的物理路径解决了我的问题：

```
AppDomain.CurrentDomain.BaseDirectory 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-26T19:52:41.160

为了引用 HttpContext 对象等 ASP.NET 功能，您需要在 ASP.NET 兼容模式下运行 WCF 应用程序。本文[介绍](http://blogs.msdn.com/wenlong/archive/2006/01/23/516041.aspx)了如何执行此操作。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-05-09T09:00:39.617

在 WCF 中使用 HostingEnvironment.ApplicationPhysicalPath 来查找您的应用程序物理路径。使用 System.Web.Hosting 使用命名空间；

# asp.net - .net Web 应用程序的登录类型

> ID：791469
> 
> 赞同：1
> 
> 时间：2009-04-26T19:43:36.270
> 
> 标签：asp.net, authentication

除了表单身份验证之外，应用程序理想情况下应该支持哪些其他常见的身份验证形式？

它只是活动目录还是 LDAP 也是必须的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T19:48:26.227

一般只需要支持一种认证即可。

使用表单身份验证，您必须提供一个包含用户名和密码的数据库表。并且您应该为用户提供更改密码等的功能。Membershp 提供程序使这一切变得更容易。

如果您可以选择使用 Active Directory 或其他 LDAP，则可以免除您建立和维护登录名的负担。如果您可以选择该选项，我建议您使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T19:48:58.113

您可能只想支持一种形式的身份验证。除了您可以使用的 Forms 身份验证之外，这里还有几个。

*   Windows 身份验证：http: [//msdn.microsoft.com/en-us/library/ms998358.aspx](http://msdn.microsoft.com/en-us/library/ms998358.aspx)
*   OpenId：[http ://www.eggheadcafe.com/tutorials/aspnet/4b3c7c9b-fe80-4e6e-a34e-0e9efed5c575/integrate-openid-authenti.aspx](http://www.eggheadcafe.com/tutorials/aspnet/4b3c7c9b-fe80-4e6e-a34e-0e9efed5c575/integrate-openid-authenti.aspx)

# java - Java jogl 小程序绘图不起作用？

> ID：791470
> 
> 赞同：1
> 
> 时间：2009-04-26T19:44:39.713
> 
> 标签：java, opengl, applet, jogl

我的 jogl 小程序屏幕是空白的。我的油漆代码有这个：

```
 public void paint(Graphics g){
        canvas.update(g);
    } 
```

如果我添加 g.fillRect(0,0,50,50); 它会绘制填充的矩形，但仍然不是 jogl 的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T19:09:25.197

我不太清楚你程序的其余部分是什么样的。但是你应该知道 JOGL 组件不像其他组件那样绘制；换句话说，如果此代码位于 GLAutoDrawable 的实例上（即 GLJPanel 或 GLCanvas），那么它不会做任何有用的事情。

您需要做的是创建一个 GLEventListener 并将其附加到 GLAutoDrawable。然后您需要`display (GLDrawable drawable)`使用绘制 3D 场景的代码来实现。

[本教程](http://today.java.net/pub/a/today/2003/09/11/jogl2d.html)有助于您入门。

# c# - 浏览asp.net页面时如何保持控件状态

> ID：791478
> 
> 赞同：0
> 
> 时间：2009-04-26T19:49:22.230
> 
> 标签：c#, asp.net-2.0

当我们使用 asp.net 页面时，我们可以通过多种方法从一个页面导航到另一个页面。

当您想要保留当前用户导航的历史时，这个问题变得更加复杂。

假设我们有一个表格。用户将通过向一个或多个字段添加值来开始填充它，但在我的情况下，他可以在我们回发当前页面之前创建到另一个页面的导航，这当然会使控件失去其值。

如何通过 asp.net 页面之间的回发保持控件状态。

我应该使用 SessionState 还是为每个用户缓存它？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-26T19:56:24.787

您几乎可以选择会话状态、cookie 或使用数据库进行本地状态维护。我通常通过将我的所有页面组合到单个 .aspx 中的单独面板来解决此问题。这样我就可以使用对象持久性和视图状态。而不是从一个页面导航到另一个页面，我只需要根据用户的导航选择来切换不同面板的 .visible 属性。

反渗透

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T19:59:23.627

答案在不同的应用程序类型中大多不同。例如，如果您计划您的应用程序将有很多人存储在会话中，这将成为一项昂贵的操作，但对于小型应用程序来说它工作得很好。在所有情况下，您都可以创建一些将临时输入的数据存储到数据库中的机制，这种方法适用于任何地方，但它比内存缓存慢。为了提供正确的建议，请详细解释一下您的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T20:01:01.593

您可以使用 Session 变量或 ASP.NET Cache 对象来存储状态，以便用户可以在离开页面后继续填写表单。但是，如果问题是数据输入是一个冗长的过程，用户可能希望暂停并在以后恢复，请让他们选择将当前进度保存到数据库。如果用户试图离开该页面，请提醒他们可能会丢失当前的工作并让他们选择保存它。

# asp.net-mvc - ASP.NET MVC 框架需要什么应用程序信任级别？

> ID：791488
> 
> 赞同：7
> 
> 时间：2009-04-26T19:55:23.340
> 
> 标签：asp.net-mvc, permissions, shared-hosting, medium-trust

我正在尝试在可能的共享主机中部署简单的 asp.net mvc 框架应用程序，我得到这样的错误：

安全异常描述：应用程序试图执行安全策略不允许的操作。要授予此应用程序所需的权限，请联系您的系统管理员或在配置文件中更改应用程序的信任级别。

异常详细信息：System.Security.SecurityException：请求“System.Security.Permissions.ReflectionPermission，mscorlib，Version=2.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”类型的权限失败。

源错误：

在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。
[http://test.pakabink.lt/](http://test.pakabink.lt/)

在我的控制面板中，我正在设置“ASP.NET 2.0 完全信任”。我需要要求服务器管理员更改什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T20:33:32.297

您应该能够以中等信任度部署和运行 MVC 框架。托管公司可能已经取消了其他一些许可，但它应该可以工作。您是否使用默认的 MVC 项目进行测试？如果您正在使用其他组件（例如，结构图），则可能会导致错误。

查看Phil Haack 的[Bin Deploying ASP.NET MVC](http://haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx)关于部署和所需的信任级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T22:35:23.773

中等信任不允许某些反射操作。我猜你的代码的某些部分确实或调用了代码的其他部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-11T15:34:25.643

Web 部署将一些 System.Web dll 复制到 bin 文件夹，例如 System.web.MVC 但不是全部。确定缺少哪些是需要大量调试的，就像前面关于反射方法的评论所说的那样。

# asp.net-mvc - 微软实体框架

> ID：791490
> 
> 赞同：6
> 
> 时间：2009-04-26T19:55:57.847
> 
> 标签：asp.net-mvc, visual-studio, entity-framework, .net-3.5

我不确定这个问题是否适合 SO，但我敢肯定这里有几个人经历过：

我正在尝试遵循 ASP.NET 网站上的 MVC 教程，并且有一点可以让您将 ADO.NET 实体添加到项目中，但由于某种原因，它没有出现在用于添加的对话框中新物品。我已经安装了 .NET 3.5 的 SP1，所以我不知道为什么它没有出现。有人知道我需要安装或勾选其他东西才能显示吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T19:58:47.060

实体数据源出现在工具箱的数据部分。

[以下是来自MSDN 博客](http://blogs.msdn.com/adonet/archive/2008/05/14/can-t-find-the-entity-data-source.aspx)的一些有用信息，供在工具箱中看不到该项目的人使用：

**找不到实体数据源？**

如果使用 SP1 升级 RTM 版本的 Visual Studio 2008，EntityDataSource 控件默认不会出现在 Web 项目工具箱的数据组中。要将控件添加到工具箱：

*   ·打开Visual Studio
*   ·打开或创建一个Web 应用程序或项目。
*   ·确保工具箱工具窗口可见。
*   ·右键单击工具箱，在数据组中单击“选择项目...”选项。
*   ·等待“选择工具箱项目”窗口出现。
*   ·在“.NET Framework Components”选项卡下的组件列表中向下滚动，直到找到
    “EntityDataSource”
*   ·确保在EntityDataSource 组件旁边标记了复选框，然后单击OK 按钮。

如果您在列表中看不到“EntityDataSource”，您可能需要手动添加程序集。为此，请单击“选择工具箱项目”窗口中的“浏览”按钮。然后浏览“C:\Program Files\Reference Assemblies\Microsoft\Framework\v3.5”下的 System.Web.Entity.dll 或配置中的等效文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T04:29:59.327

您需要 Visual Studio Team System 2008 数据库版 GDR。

[http://blogs.msdn.com/gertd/archive/2008/11/25/visual-studio-team-system-2008-database-edition-gdr-rtm.aspx](http://blogs.msdn.com/gertd/archive/2008/11/25/visual-studio-team-system-2008-database-edition-gdr-rtm.aspx)

# c# - C# Web Service和Web Site共享库，服务返回不同“类型”的库对象

> ID：791496
> 
> 赞同：1
> 
> 时间：2009-04-26T19:59:19.150
> 
> 标签：c#, class-library, web-services

我在同一个解决方案中有一个 Web 服务和一个网站（都是 C#）（现在）；我在解决方案中也有一个类库。Web 服务和网站都引用这个类库。

Web 服务有一个 WebMethod，它从库中创建一个对象并返回它。该网站调用它并尝试将其放入 Trainer 对象（再次，来自同一个库）

```
 ProFitWebService.Service serviceConn = new ProFitWebService.Service();
    ProFitLibrary.Trainer authenticatedTrainer = (ProFitLibrary.Trainer)serviceConn.GetAuthenticatedTrainer(_TrainerLogin.UserName); 
```

但是会发生以下情况：“无法将类型 ProFitWebService.Trainer 转换为 ProFitLibrary.Trainer”

这是网络方法：

```
[WebMethod]
public ProFitLibrary.Trainer GetAuthenticatedTrainer(string email)
{
    ProFitLibrary.Trainer returnTrainer = new ProFitLibrary.Trainer();
    SqlCommand cmd = new SqlCommand("SELECT * FROM Trainers WHERE EmailAddress = '" + email + "'", conn);
    conn.Open();

    SqlDataReader reader;
    reader = cmd.ExecuteReader();

    while (reader.Read())
    {
        returnTrainer.TrainerId = reader.GetInt32(reader.GetOrdinal("TrainerId"));
        returnTrainer.FirstName = reader.GetString(reader.GetOrdinal("FirstName"));
        returnTrainer.LastName = reader.GetString(reader.GetOrdinal("LastName"));
        returnTrainer.PhoneNumber = reader.GetString(reader.GetOrdinal("PhoneNumber"));
        returnTrainer.Address = reader.GetString(reader.GetOrdinal("Address"));
        returnTrainer.City = reader.GetString(reader.GetOrdinal("City"));
        returnTrainer.PostalCode = reader.GetString(reader.GetOrdinal("PostalCode"));
        returnTrainer.EmailAddress = reader.GetString(reader.GetOrdinal("EmailAddress"));
    }

    return returnTrainer;
} 
```

**更新：**在网站上将 Trainer 对象更改为 ProFitWebService.Trainer 解决了问题：

```
 ProFitWebService.Service serviceConn = new ProFitWebService.Service();
    ProFitWebService.Trainer authenticatedTrainer = (ProFitWebService.Trainer)serviceConn.GetAuthenticatedTrainer(_TrainerLogin.UserName); 
```

我认为这个问题的答案很简单，从 Web 服务返回的库对象将始终是基于类型/前缀的服务 - 我不应该从网站和服务中引用类库 - 我应该总是创建 WebService对象的版本 - ProFitWebService.Trainer 等。

当您在 Web 服务中使用库时，有人可以确认这是一种标准做法吗？或者，如果我让这变得更加困难，那真的是！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T20:52:34.637

创建对 Web 服务的 Web 引用时，您将获得为您生成的代理类。这些代理类看起来像您的库中的类，但它们的类型不同。如果要将 Web 服务返回的对象视为共享库中的类型，则需要在库版本和这些类型的代理版本之间进行转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T20:21:44.820

当使用反射时，当实际程序集不同时 - 不同版本，编译时甚至有时使用程序集的不同副本时，可能会发生这种类型的事情。我不确定您的代码是否使用反射...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T20:51:20.693

这里的问题是 Web 服务的客户端实际上是一个代理或生成的对象，而不是您期望的正常类型。我认为您必须将类型映射到您想要的实例中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-20T16:06:27.740

我所做的是为每个类创建扩展方法以将它们转换为正确的签名。当您在 6 个 Web 服务之间共享 20 个业务课程时，就没有那么有趣了 :'(

# asp.net - 如何在 asp.net 中验证日期

> ID：791500
> 
> 赞同：3
> 
> 时间：2009-04-26T19:59:58.150
> 
> 标签：asp.net, datetime, date

自“曾经”以来，我一直有这个日期问题

我住在一个我们使用英国日期格式的国家，例如 dd/mm/yyyy，但每次我尝试对托管在美国服务器中的 sql db 进行查询时，100% 的时间都会遇到错误。

`Convert.ToDateTime("2007-17-5")`产生错误，而 as`Convert.ToDateTime("2007-5-17")`也会产生错误。

许多验证方法，许多 t-sql 查询和许多其他方法，我在大多数项目中都尝试并部分解决了，但是，我想知道是否有人有一种通用方法将字符串转换为不会导致的日期任何问题？

或有关使用日期的任何好的资源？

------------ 编辑... -----------------

即使我正确地格式化日期，即使我确定有，对 sql 服务器的查询也不会产生任何值。例如，如果我正在搜索属于 2009 年 1 月 1 日之间的日期的记录（即 2009 年 1 月 1 日）到 2009 年 1 月 5 日（即 2009 年 5 月 1 日）没有返回记录。当我尝试在 sql server 的查询生成器中更改日期时，它给了我一个错误，说它不是我输入的有效日期......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T20:11:07.450

使用[DateTime.TryParseExact](http://msdn.microsoft.com/en-us/library/ms131044.aspx)并给出一些格式，代表您的日期字符串

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T20:44:47.493

您在 UI 中处理了很多日期验证。

首先，在你的 webconfig 中，你需要设置你的文化：

```
<globalization requestEncoding="utf-8" responseEncoding="utf-8" culture="en-GB" uiCulture="en-GB" /> 
```

您可以通过将 Type 属性设置为“Date”来使用客户端上的 CompareValidator 控件。

```
<CompareValidator ID="id" runat="server"
  ControlToValidate="controltovalidateid"
  ErrorMessage="Invalid Date"
  Type="Date" /> 
```

为了限制用户选项，我使用了 ASP.NET 中的日历控件。该控件的一个好处是您可以在属性中设置日期格式：

```
<ajaxToolkit:Calendar runat="server"
  TargetControlID="Date1"
  CssClass="ClassName"
  Format="dd/mm/yyyy"
  PopupButtonID="Image1" /> 
```

**其他信息**

*   [AJAX 控制工具包下载](http://www.codeplex.com/AjaxControlToolkit)
*   [日历控件：AJAX 控件工具包示例](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/Calendar/Calendar.aspx)
*   [比较验证器](http://www.w3schools.com/aspnet/control_comparevalidator.asp)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T13:37:38.613

**2007-5-17**不是有效的国际日期 (ISO 8601)，**2007-05-17**是。如果您要使用国际格式**CCYY-MM-DD**您需要包括前导**0** s

[http://www.w3.org/QA/Tips/iso-date](http://www.w3.org/QA/Tips/iso-date)

[http://www.saqqara.demon.co.uk/datefmt.htm](http://www.saqqara.demon.co.uk/datefmt.htm)

# ruby-on-rails - 如何防止 backgroundrb 启动同一任务的多个副本？

> ID：791503
> 
> 赞同：0
> 
> 时间：2009-04-26T20:00:52.263
> 
> 标签：ruby-on-rails, ruby, scheduled-tasks, backgroundrb

比如说，我有一个工作人员使用 backgroundrb 的 cron 调度功能设置为每 15 分钟运行一次。然后，比如说，如果一个 worker 实例的运行时间超过 15 分钟，我不希望第二个 worker 由 backgroundrb 并行启动。我该如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T21:04:27.947

好吧，我想我会自己回答这个问题。诀窍是不要`reload_on_schedule true`在你的工人中指定。

# java - 如何在 POI 中使用 getViewableIterator

> ID：791505
> 
> 赞同：2
> 
> 时间：2009-04-26T20:02:38.407
> 
> 标签：java, coldfusion, iterator, apache-poi

我目前正在使用 POI 尝试从一批 Word 文档中提取文本，并且我需要能够确定文档包含哪些条目。我已经能够拉动文档根目录并拉动第一个条目，但我希望能够查看所有条目。该`getEntries()`方法似乎提供了此功能，但我不知道如何使用`getViewableIterator()`将它们拉出来。

以下是我在代码方面的内容：

```
<cfset myFile = createObject("java", "java.io.FileInputStream").init(fileInputPath)>
<cfset fileSystem = CreateObject( "java", "org.apache.poi.poifs.filesystem.POIFSFileSystem" ).Init(myFile)>

<cfloop from="1" to="#fileSystem.getRoot().getEntryCount()#" index="i">
     <cfset viewableIterator = fileSystem.getRoot().getEntries().next().getViewableIterator()>
     <cfset nextEntry = fileSystem.getRoot().getEntries().next()>
     <cfif viewableIterator.hasNext()>
         <cfdump var="#nextEntry.getShortDescription()#">
         <cfset viewableIterator.remove()>
     </cfif>
</cfloop> 
```

在第一个循环中，我能够很好地获得第一个条目。但是，`java.lang.IllegalStateException`一旦`remove()`执行，我就会收到错误。显然我没有`remove()`正确使用该方法，但我无法找到任何应​​该如何正确使用该方法的示例。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T12:51:06.657

Kinky Solutions 成名的 Ben Nadel 编写了一个可以处理您的情况的组件。如果他的项目对您有帮助，请查看并报告。

[POI 实用程序 ColdFusion 组件](http://www.bennadel.com/projects/poi-utility.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T20:31:24.423

我不太了解您的 XML 标记（通常我以正常形式使用 Java，带有花括号和其他东西），但通常 Java 迭代器的工作方式如下：

```
while(iterator.hasNext()) {
  x = iterator.next(); // get element
  // do with x what you want
  if (/*you want to remove x from the underlying list*/)
      iterator.remove();
} 
```

在实践中，remove 很少使用，以防您想要遍历一个集合并删除其中不再需要的所有内容。如果集合是只读的，或者您尝试同时使用两个不同的迭代器对其进行两次迭代，则 remove 可能会失败。只需坚持使用 hasNext 和 next 即可。

# objective-c - @property 原子性的经验法则？

> ID：791509
> 
> 赞同：1
> 
> 时间：2009-04-26T20:04:49.680
> 
> 标签：objective-c

在 Objective-C 中（在桌面或 iPhone 平台上）何时应该使用非原子属性，而不是默认的原子属性，是否有一个好的经验法则？我理解其中的区别——原子性以牺牲性能为代价保证了整个价值——但我看到的大多数示例都使用非原子属性（并且不是不稳定的），因此显然在某些情况下需要原子性，而在某些情况下则不需要。

谁能给我一个简单的指导方针，告诉我什么时候应该使用原子属性，什么时候应该使用非原子属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T20:15:26.300

你应该`nonatomic`尽可能地支持。通常，这意味着只能从单个线程设置/访问的属性*或*访问受某种更高级别同步保护的属性。需要注意的是，`atomic`属性访问并不能保证线程安全。换句话说，依赖于`atomic`属性值的算法本身必须是线程安全的，这样整个系统才能是线程安全的。考虑到这一点，通常可以`nonatomic`在保持系统线程安全的同时制作属性。

# perl - 为什么升级 Perl 后我的 Perl CGI 脚本无法编译？

> ID：791514
> 
> 赞同：1
> 
> 时间：2009-04-26T20:06:21.470
> 
> 标签：perl, cgi

升级 Perl 后，我在 Perl CGI 脚本中收到一些错误：

> 未加引号的字符串“type”可能与 convertit.cgi 第 183 行的未来保留字发生冲突。无法在 convertit.cgi 第 183 行修改标量赋值中的常量项，靠近“”text/javascript\">flashPreloadFinish (' [http:// www.myurl.com/mysite.html](http://www.myurl.com/mysite.html) ');\n";" convertit.cgi 有编译错误。

第 183-184 行：

```
print "<script type=\"text/javascript\">flashPreloadFinish
('http://www.myurl.com/mysite.html');</script>\n";
print "</body></html>\n"; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T03:39:34.033

请参阅我的[Perl CGI 脚本疑难解答](http://www.perlmonks.org/?node_id=380424)或[brian 的解决任何 Perl 问题的指南](http://www252.pair.com/comdog/brian's_guide.pod)。他们都将引导您完成步骤以找出问题所在。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T20:08:46.317

较早的行有一个未闭合的“。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-26T21:40:16.410

我没有看到您的代码有任何问题，但我建议将其重写为

```
print <<'EOT';
<script type="text/javascript">flashPreloadFinish('http://www.myurl.com/mysite.html');</script>
</body></html>
EOT 
```

# ms-access - 如何绕过 Access 2007 中的启动表单？

> ID：791517
> 
> 赞同：2
> 
> 时间：2009-04-26T20:09:15.740
> 
> 标签：ms-access, ms-access-2007

嗨，我想进入 Access 2007 中的 VB 模块。通常我会通过 Alt+F11 来完成，但它不起作用。

谢谢，

尼科尔兹

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T20:18:41.067

尝试在按住 shift 键的同时启动它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T18:11:36.230

从 Access 2007 开始，我的理解是，如果程序员禁用启动绕过热键 - 就无法绕过它。但是，它不是菜单中的选项 - 您必须以编程方式写入禁用功能。否则，Shift 键是绕过启动脚本的最常见热键。

# .net - 自定义或皮肤 .net DataGridView 控件

> ID：791522
> 
> 赞同：2
> 
> 时间：2009-04-26T20:14:17.193
> 
> 标签：.net, winforms, datagridview

有谁知道皮肤.net Windows Forms DataGridView 控件有多容易或有多可能？我想使控件与当前的外观大不相同。

例如，想想开源应用程序 Boxee。它有一个完全自定义的界面，这就是我想推动控件的程度。我知道我可以使用 WPF 来代替，它专为这种类型的使用而设计，但不幸的是我不能在目标应用程序中使用 .net 3.5。

此外，如果有人知道专为皮肤设计的开源或廉价 DataGridView 控件，请告诉我。我很感激帮助。

谢谢你，

-拉尔夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T21:16:32.317

由于 WinForms 控件是由非托管 user32.dll 呈现的，因此对它们进行蒙皮几乎是不可能的。您需要或多或少地从头开始重新实现行绘制逻辑。如果您最终实现了绘画事件并覆盖了默认绘画行为，有一些文章可以帮助您：[MSDN](http://msdn.microsoft.com/en-us/library/hta8z9sz.aspx)和[Alex Yakhnin 的博客](http://blogs.msdn.com/priozersk/archive/2007/11/11/datagrid-with-a-custom-header-and-selection.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T22:54:08.807

为 DataGridView 创建新的行和列并不难。我已经采取了它来实现进度条和丰富的动画，没有任何障碍。

这是一篇让我开始创建自定义列的示例文章：

[http://www.devx.com/codemag/Article/35186](http://www.devx.com/codemag/Article/35186)

浏览 DGV 控件的属性，已经可以进行很多自定义。很容易剥离大部分控件生成的样式，然后通过子类化构建自己的样式。只要您可以接受在布局中使用矩形列和行，这当然是一个可行的选择。

# java - Java 或 .NET 的跨语言配置

> ID：791531
> 
> 赞同：3
> 
> 时间：2009-04-26T20:19:41.487
> 
> 标签：java, .net, language-agnostic, configuration

我找到[了这个问题](https://stackoverflow.com/questions/239832/how-do-you-share-configuration-information-or-business-rules-between-languages)，但没有看到一个好的答案。我对配置文件特别感兴趣，比如 XML。是否有用于读取配置文件的跨语言标准/工具？XML 本身只是一种媒介，但我想要工具、库和标准，就像 .NET 的[ConfigurationSection 类](http://msdn.microsoft.com/en-us/library/system.configuration.configurationsection.aspx)中存在的那些。

我的主要目标是 Java 和 .NET。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-06-23T22:05:02.190

我遇到了这个问题。我知道这个问题已有十多年的历史了，但今天 YAML 可以成为这个问题的答案。YAML 社区还维护了一系列用于各种编程语言的库和工具。

详情请查看 YAML 主页：[https ://yaml.org/](https://yaml.org/)

# c - 为什么要在汇编中编程？

> ID：791533
> 
> 赞同：89
> 
> 时间：2009-04-26T20:21:13.200
> 
> 标签：c, performance, low-level, assembly

我有一个问题要问所有的铁杆低级黑客。我在博客中看到了这句话。我真的不认为来源很重要（如果你真的在乎，那就是 Haack），因为它似乎是一个常见的陈述。

> 例如，许多现代 3-D 游戏都有用 C++ 和汇编编写的高性能核心引擎。

就程序集而言 - 是用程序集编写的代码，因为您不希望编译器发出额外的指令或使用过多的字节，或者您正在使用无法用 C 表达的更好的算法（或无法表达没有编译器把它们弄乱了）？

我完全明白理解底层的东西很重要。我只是想在你理解它之后理解*为什么程序在汇编中。*

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2009-04-26T21:51:42.717

我认为您误读了以下声明：

> 例如，许多现代 3-D 游戏都有用 C++ 和汇编编写的高性能核心引擎。

游戏（以及如今的大多数程序）与“用 C++ 编写”不同的是“用汇编语言编写”。那个博客并不是说游戏的很大一部分是用汇编设计的，或者一群程序员坐在那里以汇编作为他们的主要语言进行开发。

这*真正*意味着开发人员首先编写游戏并使其在 C++ 中运行。然后他们对其进行分析，找出瓶颈是什么，如果值得，他们会在组装中优化它们。或者，如果他们已经有经验，他们知道哪些部分会成为瓶颈，并且他们已经从他们构建的其他游戏中获得了优化的部分。

汇编中的编程*要点与往常一样：***速度**。*在汇编程序中编写大量*代码会很荒谬，但是编译器没有意识到一些优化，并且对于足够小的代码窗口，人类会做得更好。

例如，对于浮点，编译器往往非常保守，并且可能不知道您的体系结构的一些更高级的特性。如果您愿意接受一些错误，通常可以比编译器做得更好，如果您发现花费大量时间在汇编中编写一小段代码是值得的。

以下是一些更相关的示例：

**游戏中的例子**

*   [来自英特尔](http://software.intel.com/en-us/articles/achieving-performance-an-approach-to-optimizing-a-game-engine/)的关于使用 SSE 内在函数优化游戏引擎的文章。最终代码使用了intrinsic（不是inline assembler），所以纯汇编的量很小。但他们会查看编译器的汇编器输出，以准确确定要优化的内容。

*   Quake 的[快速反平方根](http://www.lomont.org/Math/Papers/2003/InvSqrt.pdf)。同样，该例程中没有汇编程序，但您需要了解一些有关架构的知识才能进行这种优化。作者知道哪些操作快（乘法、移位），哪些操作慢（除法、sqrt）。所以他们提出了一个非常棘手的平方根实现，完全避免了缓慢的操作。

**高性能计算**

*   在游戏领域之外，科学计算领域的人们经常对事物进行优化，以使它们能够在最新的硬件上快速运行。把它想象成你不能在物理上作弊的游戏。

    最近的一个很好的例子是[Lattice Quantum Chromodynamics (Lattice QCD)](http://en.wikipedia.org/wiki/Lattice_QCD)。 [本文](http://sc06.supercomputing.org/schedule/pdf/gb110.pdf)描述了该问题如何归结为一个非常小的计算内核，该内核针对[IBM Blue Gene/L](http://en.wikipedia.org/wiki/Blue_Gene)上的 PowerPC 440 进行了大量优化。每个 440 都有两个 FPU，它们支持一些特殊的三元运算，编译器很难利用这些运算。如果没有这些优化，Lattice QCD 的运行速度会慢得多，当您的问题需要在昂贵的机器上运行数百万小时的 CPU 时，这将是代价高昂的。

    如果您想知道*为什么*这很重要，请查看来自这项工作[的 Science 中的文章。](http://www.sciencemag.org/cgi/content/abstract/322/5905/1224)使用 Lattice QCD，这些人根据第一原理计算了质子的质量，并在去年表明 90% 的质量来自强结合能，其余来自夸克。这就是[E=mc ²](http://en.wikipedia.org/wiki/Mass-energy_equivalence)的作用。 [这是一个摘要](http://room538ccpp.wordpress.com/2008/11/23/ab-initio-qcd-calculation-of-the-proton-mass/)。

对于上述所有情况，应用程序**并不是**100% 以汇编方式设计或编写的——甚至没有接近。但是当人们真正需要速度时，他们会专注于编写代码的关键部分以在特定硬件上运行。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-04-26T20:25:32.533

我已经很多年没有用汇编语言编码了，但我可以给出几个我经常看到的原因：

*   并非所有编译器都可以利用某些 CPU 优化和指令集（例如，英特尔偶尔添加的新指令集）。等待编译器编写者赶上来意味着失去竞争优势。

*   更容易将实际代码与已知的 CPU 架构和优化相匹配。例如，您了解的获取机制、缓存等。这应该对开发人员是透明的，但事实并非如此，这就是编译器编写者可以优化的原因。

*   某些硬件级别的访问只能通过汇编语言进行（例如，在编写设备驱动程序时）。

*   汇编语言的形式推理有时实际上比高级语言更容易，因为您已经知道代码的最终或几乎最终布局是什么。

*   在没有 API 的情况下编程某些 3D 图形卡（大约 1990 年代后期）在汇编语言中通常更实用和高效，有时在其他语言中则不可能。但同样，这涉及到基于加速器架构的真正专家级游戏，例如以特定顺序手动将数据移入和移出。

我怀疑很多人在使用高级语言时会使用汇编语言，尤其是当该语言是 C 时。手动优化大量通用代码是不切实际的。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-04-26T20:32:40.347

汇编程序编程的一个方面是其他人没有提到的——当您知道应用程序中的每个字节都是您自己努力的结果，而不是编译器的结果时，您会感到满足。我一秒钟都不想像 80 年代初那样用汇编程序编写整个应用程序，但有时我确实怀念那种感觉……

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-04-26T20:24:45.750

通常，外行的组装比 C 慢（由于 C 的优化），但许多游戏（我清楚地记得[Doom](http://en.wikipedia.org/wiki/Doom_(video_game))）必须在组装中有游戏的特定部分，这样它才能在普通机器上顺利运行。

[这是我所指的示例。](http://www.pc-guru.cz/techniky-zobrazeni-3d-doom)

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-04-26T21:12:19.160

在我的第一份工作（80 年代）中，我开始使用汇编语言进行专业编程。对于嵌入式系统，内存需求——RAM 和 EPROM——很低。您可以编写易于占用资源的紧凑代码。

到 80 年代后期，我已经切换到 C。代码更容易编写、调试和维护。非常小的代码片段是用汇编程序编写的——对我来说，这是我在自己滚动的 RTOS 中编写上下文切换的时候。（除非它是一个“科学项目”，否则你不应该再做的事情。）

您将在一些 Linux 内核代码中看到汇编程序片段。最近我在自旋锁和其他同步代码中浏览过它。这些代码需要访问原子测试和设置操作、操作缓存等。

我认为您很难为大多数通用编程优化现代 C 编译器。

我同意@altCognito 的观点，你的时间可能最好花在更努力地思考问​​题并做得更好。出于某种原因，程序员经常关注微观效率而忽视宏观效率。汇编语言提高性能是一种微观效率。退后一步以更广泛地了解系统可以暴露系统中的宏观问题。解决宏观问题通常可以带来更好的性能提升。一旦解决了宏观问题，就会崩溃到微观层面。

我想微观问题在单个程序员的控制范围内，并且在较小的域中。在宏观层面上改变行为需要与更多的人交流——一些程序员会避免这样做。整个牛仔vs团队的事情。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-04-26T20:29:04.427

“是的”。但是，要明白，在大多数情况下，用汇编程序编写代码的好处并不值得付出努力。在汇编中编写它所获得的回报往往比仅仅专注于更努力地思考问​​题并花时间思考更好的做事方式所获得的回报要小。

主要负责编写 Quake 的 John Carmack 和 Michael Abrash 以及进入 IDs 游戏引擎的所有高性能代码在[本书](https://rads.stackoverflow.com/amzn/click/com/1576101746)中详细介绍了这一点。

我也同意 Ólafur Waage 的观点，即今天，编译器非常聪明，并且经常采用许多利用隐藏架构提升的技术。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-04-27T01:59:39.127

如今，至少对于顺序代码，一个体面的编译器几乎总能胜过经验丰富的汇编语言程序员。但对于矢量代码，这是另一回事。例如，广泛部署的编译器在利用 x86 SSE 单元的矢量并行功能方面做得并不好。我是一名编译器编写者，**利用 SSE**是我自己而不是信任编译器的理由。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-04-26T20:36:35.127

SSE 代码在汇编中比编译器内在函数更好，至少在 MSVC 中。（即不创建额外的数据副本）

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-05-08T08:23:59.047

我的源代码中有三到四个汇编程序例程（大约 20 MB 源代码）。所有这些都是[SSE(2)](http://en.wikipedia.org/wiki/SSE2)，并且与（相当大 - 认为 24​​00x2048 和更大）图像的操作有关。

出于爱好，我在编译器上工作，那里有更多的汇编器。运行时库通常充满了它们，它们中的大多数都与违反正常程序制度的东西有关（比如异常的助手等）

我的微控制器没有任何汇编程序。大多数现代微控制器都有如此多的外围硬件（中断控制的计数器，甚至整个[正交编码器](http://en.wikipedia.org/wiki/Rotary_encoder)和串行构建块），以至于通常不再需要使用汇编程序来优化循环。按照目前的闪存价格，代码存储器也是如此。此外，通常还有一系列引脚兼容的设备，因此如果您系统地用完 cpu 电源或闪存空间，升级通常不是问题

除非你真的出货了 100000 台设备，并且编程汇编器可以通过在闪存芯片中安装更小的类别来真正节省大量资金。但我不属于这一类。

很多人认为嵌入式是汇编程序的借口，但他们的控制器比开发[Unix](http://en.wikipedia.org/wiki/Unix)的机器拥有更多的 CPU 能力。（Microchip 配备 40 和 60 [MIPS](http://en.wikipedia.org/wiki/Instructions_per_second#Million_instructions_per_second)微控制器，价格低于10[美元](http://en.wikipedia.org/wiki/United_States_dollar)）。

然而，很多人都被遗留问题所困扰，因为改变微芯片架构并不容易。此外，HLL 代码非常依赖于体系结构（因为它使用硬件外围设备、寄存器来控制 I/O 等）。因此，有时有充分的理由继续在汇编程序中维护项目（我很幸运能够从头开始在新架构上设置事务）。但人们常常自欺欺人说他们真的需要汇编程序。

当我们问我们是否可以使用 GOTO 时，我仍然喜欢一位教授给出的答案（但您也可以将其读为 ASSEMBLER）：**“如果您认为值得写一篇 3 页的文章说明您为什么需要该功能，您可以使用它. 请连同你的结果一起提交论文。”**

我将其用作低级功能的指导原则。不要太拥挤而无法使用它，但要确保你正确地激励它。甚至设置一两个人为的障碍（如文章）以避免将复杂的推理作为正当理由。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-04-27T02:19:29.967

缺陷倾向于逐行运行（语句、代码点等）；虽然对于大多数问题，汇编确实会比高级语言使用更多的行，但有时它是最好的（最简洁，最少的行）映射到手头的问题。这些案例中的大多数都涉及通常的嫌疑人，例如嵌入式系统中的驱动程序和位碰撞。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-04-26T22:29:21.923

一些指令/标志/控制根本不存在于 C 级别。

例如，检查 x86 上的溢出是简单的溢出标志。此选项在 C 中不可用。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-05-18T16:01:16.500

游戏非常需要性能，尽管同时优化器非常好，但“大师级程序员”仍然能够通过在组装中手动编码正确的部分来挤出更多的性能。

永远不要在没有先分析它的情况下开始优化你的程序。分析后应该能够识别瓶颈，如果找到更好的算法等不再削减它，您可以尝试在汇编中手动编写一些东西。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-04-26T20:28:17.910

如果您参与了所有 Y2K 修复工作，那么如果您了解 Assembly，您可能会赚很多钱。仍然有很多遗留代码是写在里面的，而且这些代码有时需要维护。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-04-28T08:47:44.987

如果您正在编程具有 128 字节 RAM 和 4K 程序存储器的低端 8 位微控制器，那么您在使用汇编时没有太多选择。有时，尽管在使用功能更强大的微控制器时，您需要在准确的时间执行某些操作。汇编语言很有用，因为您可以计算指令并测量代码使用的时钟周期。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-04-26T20:32:49.007

另一个原因可能是可用的编译器对于架构来说不够好，并且程序中所需的代码量没有那么长或复杂，以至于程序员会迷失在其中。尝试为嵌入式系统编写微控制器，通常组装会容易得多。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-04-26T20:39:10.707

除了提到的其他事情之外，所有高级语言都有一定的局限性。这就是为什么有些人选择在 ASM 中编程，以完全控制他们的代码。

其他人则喜欢非常小的可执行文件，在 20-60KB 的范围内，例如检查[HiEditor](http://programmerstools.org/node/701)，它是由 HiEdit 控件的作者实现的，用于 Windows 的极好的强大的编辑控件，语法高亮和标签只有 ~50kb）。在我的收藏中，我有超过 20 个这样的黄金控件，从 Excell 像 ssheets 到 html 渲染。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-04-26T20:52:09.957

我想很多游戏开发者会对这些信息感到惊讶。

我所知道的大多数游戏都尽可能少地使用组装。在某些情况下，根本没有，最坏的情况是一两个循环或函数。

这句话过于笼统，远没有十年前那么真实。

但是，嘿，单纯的事实不应该阻碍真正的黑客为支持组装而进行的十字军东征。;)

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-04-28T09:01:11.553

它似乎没有被提及，所以我想我会添加它：在现代游戏开发中，我认为至少有一些正在编写的程序集根本不适合 CPU。[它以着色器程序](http://en.wikipedia.org/wiki/Shader_%28computer_science%29)的形式用于 GPU 。

这可能出于各种原因需要，有时仅仅是因为使用的任何高级着色语言都不允许以所需指令的确切数量来表达确切的操作，以适应某些大小约束、速度或任何组合. 就像汇编语言编程一样，我猜。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-04-27T00:09:02.887

除了非常小的 CPU 上的非常小的项目之外，我不会着手对整个项目进行汇编编程。但是，通常会发现性能瓶颈可以通过一些内部循环的策略性手工编码来缓解。

在某些情况下，真正需要的只是用优化器无法弄清楚如何使用的指令替换某些语言结构。一个典型的例子是在 DSP 应用程序中，向量运算和乘法累加运算对于优化器来说很难发现，但很容易编写代码。

例如，某些型号的 SH4 包含 4x4 矩阵和 4 个向量指令。通过将 3x3 矩阵上的等效 C 操作替换为适当的指令，我看到了颜色校正算法的*巨大*性能改进，代价是将校正矩阵扩大到 4x4 以匹配硬件假设。这是通过编写不超过 12 行汇编来实现的，并对相关数据类型和存储进行匹配调整到周围 C 代码中的少数几个地方。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-04-28T22:43:38.503

迄今为止，我见过的几乎所有中型到大型游戏引擎或库都有一些手动优化的汇编版本，可用于矩阵运算，例如 4x4 矩阵连接。在处理大型矩阵时，编译器似乎不可避免地会错过一些巧妙的优化（重用寄存器、以最有效的方式展开循环、利用特定于机器的指令等）。这些矩阵操作函数也几乎总是配置文件上的“热点”。

我还看到手动编码的程序集大量用于自定义调度——比如 FastDelegate，但编译器和机器特定。

最后，如果你有中断服务例程，asm 可以改变世界——有些操作你只是不想在中断下发生，你希望你的中断处理程序“快速进入和退出”。 .. 如果它在 asm 中，您几乎*完全*知道 ISR 中会发生什么，并且它鼓励您保持简短（无论如何这是一个好习惯）。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-04-26T21:03:30.727

上次我在汇编器中编写代码时，我无法说服编译器生成与 libc 无关、位置无关的代码。

下次可能出于同样的原因。

当然，我以前也有其他[原因](http://linuxassembly.sourceforge.net)。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2009-05-04T18:41:09.767

我继续做的唯一汇编程序编码是用于资源匮乏的嵌入式硬件。正如利德所提到的，汇编仍然非常适合需要快速且易于理解的代码的[ISR 。](http://en.wikipedia.org/wiki/Interrupt_handler)

对我来说，第二个原因是保持我对汇编功能的了解。能够检查和理解 CPU 执行我的指令所采取的步骤感觉很好。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2009-07-24T16:51:25.963

我只亲自与一位开发人员谈过他对汇编的使用。他正在研究处理便携式 mp3 播放器控制的固件。组装工作有两个目的：

1.  速度：需要尽量减少延迟。
2.  成本：通过代码最少，运行它所需的硬件可能会稍微不那么强大。当批量生产数百万台时，这可以加起来。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2019-02-05T03:00:20.010

很多人喜欢诋毁汇编语言，因为他们从来没有学过用它编码，只是模糊地遇到过它，这让他们感到震惊或有些害怕。真正有才华的程序员会明白，抨击 C 或汇编是毫无意义的，因为它们是互补的。事实上，一个的优点就是另一个的缺点。C 的有组织的语法规则提高了清晰度，但同时放弃了所有强大的集合，因为没有任何结构规则！C 代码指令用于创建非阻塞代码，这可能会强制明确编程意图，但这是一种功耗。在 C 中，编译器不允许在 if/elseif/else/end 内跳转。或者您不允许在彼此重叠的不同变量上编写两个 for/end 循环，你不能编写自我修改的代码（或者不能以一种无缝的简单方式）等等。传统的程序员被上面的内容吓坏了，甚至不知道如何使用这些方法的力量，因为它们已经被提出来遵循传统的规则. 这是事实：今天我们的机器具有计算能力，可以做比我们使用它们的应用程序更多的事情，但是人脑无法在无规则的编码环境（=汇编）中对它们进行编码，并且需要限制性规则，这极大地减少频谱并简化编码。由于上述限制，我自己编写的代码无法用 C 代码编写而不会变得非常低效。而且我还没有谈到速度，大多数人认为这是在汇编中写作的主要原因，好吧，如果您的思想仅限于用 C 语言思考，那么您将永远是编译器的奴隶。我一直认为国际象棋大师是理想的汇编程序员，而 C 程序员只是玩“Dames”。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-04-27T19:39:26.910

不再是速度，而是**控制**。速度有时来自控制，但这是在汇编中编码的**唯一原因。**其他所有原因都归结为控制（即 SSE 和其他手动优化、设备驱动程序和设备相关代码等）。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-10-21T19:58:50.440

如果我能够胜过[GCC](http://en.wikipedia.org/wiki/GNU_Compiler_Collection)和 Visual C++ 2008（也称为 Visual C++ 9.0），那么人们就会有兴趣采访我了解它是如何实现的。

这就是为什么目前我只是在汇编中阅读内容并在需要时只写 __asm int 3 。

我希望这有帮助...

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2009-10-25T21:36:25.890

我已经有几年没有写汇编了，但我以前的两个原因是：

*   事情的挑战！几年前我经历了几个月的时间，当时我用[x86 程序集](http://en.wikipedia.org/wiki/X86_assembly_language)编写所有东西（[DOS](http://en.wikipedia.org/wiki/DOS)和 Windows 3.1 的时代）。它基本上教会了我一大堆低级操作、硬件[I/O](http://en.wikipedia.org/wiki/Input/output)等。
*   对于某些事情，它的尺寸很小（在编写[TSR时再次使用 DOS 和](http://en.wikipedia.org/wiki/Terminate_and_Stay_Resident)[Windows 3.1](http://en.wikipedia.org/wiki/Windows_3.1x)）

我一直在看编码汇编，这无非是挑战和乐趣。我没有其他理由这样做:-)

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2014-07-04T17:45:05.023

我曾经接手过一个 DSP 项目，以前的程序员主要用汇编代码编写，除了用 C 语言编写的音调检测逻辑，使用浮点（在定点 DSP 上！）。音调检测逻辑以大约 1/20 的实时速度运行。

我最终从头开始重写了几乎所有内容。除了一些小的中断处理程序和几十行与中断处理和低级频率检测相关的代码外，几乎所有东西都在 C 中，它们的运行速度是旧代码的 100 倍以上。

我认为要记住的重要一点是，在许多情况下，使用小型例程来提高速度的机会比使用大型例程要大得多，特别是如果手写汇编程序可以将所有内容都放入寄存器但编译器不会相当管理。如果一个循环足够大以至于它无论如何都不能将所有内容保存在寄存器中，那么改进的机会就会少得多。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2010-01-15T08:50:57.487

为 Android 手机上的 Java 应用程序解释字节码的 Dalvik VM 使用汇编程序作为调度程序。这部[电影](http://sites.google.com/site/io/dalvik-vm-internals)（大约 31 分钟，但值得观看整部电影！）解释了如何

> “仍然存在人类比编译器做得更好的情况”。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2010-01-15T08:55:42.780

我没有，但我已经指出至少要尝试，并在未来的某个时候努力尝试（希望很快）。当我使用高级语言进行编程时，了解更多低级内容以及幕后工作原理并不是一件坏事。不幸的是，作为开发人员/顾问和父母的全职工作很难获得时间。但我会在适当的时候放弃，这是肯定的。

# java - 如何在 Emacs 中为 C++/Java 折叠？

> ID：791539
> 
> 赞同：5
> 
> 时间：2009-04-26T20:24:32.457
> 
> 标签：java, c++, emacs

我知道有关为 LaTex 折叠的[线程。](https://stackoverflow.com/questions/575060/how-can-you-have-folds-for-a-latex-file-in-xemacs)但是，当我编码时，我想要 C++/Java 的折叠。

**如何**在 Emacs for C++/Java 中进行自动或手动折叠？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-26T20:49:24.987

hs-minor-mode 是你想要的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-27T05:19:56.367

我对 hs-minor-mode 的自定义如下

```
(add-hook 'c-mode-common-hook
  (lambda()
    (local-set-key (kbd "C-c <right>") 'hs-show-block)
    (local-set-key (kbd "C-c <left>")  'hs-hide-block)
    (local-set-key (kbd "C-c <up>")    'hs-hide-all)
    (local-set-key (kbd "C-c <down>")  'hs-show-all)
    (hs-minor-mode t))) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-27T04:44:38.653

您可以使用[CEDET](http://cedet.sf.net)来执行此操作。这个包提供了 global-semantic-tag-folding-mode，它允许折叠函数、类/结构、注释、命名空间等。它比其他包更有效，因为它具有有关代码的所有语法信息。

有[关于 CEDET 的介绍文章](http://xtalk.msk.su/~ott/en/writings/emacs-devenv/EmacsCedet.html)，可以快速开始使用它

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-26T20:28:14.697

确保你有 fold-mode.el。然后，插入

```
// {{{

// }}} 
```

围绕您的代码。重新加载缓冲区，瞧！你会有褶皱。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-28T01:18:11.637

您可以尝试[选择显示](http://emacs.wordpress.com/2007/01/16/quick-and-dirty-code-folding/)。它更像是根据缩进级别快速折叠所有代码。它非常适合获取类/功能摘要或快速移动。

但是，如果您想要折叠代码块，那么[HideShow](http://www.emacswiki.org/cgi-bin/wiki/HideShow)，就像 Arkadiy 指出的那样，可能更合适。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-27T04:59:03.580

对于 Java，请使用[JDEE](http://jdee.sourceforge.net/)。对于 C/C++，请参阅有关 CEDET 的其他答案。

# javascript - 如何在 Javascript 中以相同的方式获取文本框、文本区域和收音机的值？

> ID：791544
> 
> 赞同：1
> 
> 时间：2009-04-26T20:26:49.097
> 
> 标签：javascript, html, dhtml

我想要一个函数/代码，它将返回用户为其名称/id 传递给它的字段提交的值。该字段是文本框、文本区域、单选还是选择都无关紧要。例如，该字段可以是：

```
<input type='radio' name='a_21' value='test' id='a_21_0' />
<input type='radio' name='a_21' value='test2' id='a_21_1' /> 
```

或者

```
<textarea name="a_21" rows="30" cols="6"></textarea> 
```

当我打电话时：

```
function getVal('a_21'); 
```

它应该返回选定的值。

我怎样才能做到这一点？将要：

```
document.myForm.field.value 
```

也适用于文本区域、下拉菜单和收音机？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-26T20:34:45.380

问题是不同的小部件有不同的用途。例如，`<select>`具有多个可用选项、多个复选框甚至单个复选框（其值将只是“开”或“关”）的框不会有单个值，因此它们的行为与其他小部件不同是可以的.

但是如果你想要一个函数，你可以这样做：

```
function getVal(obj){
  if(obj.value){
    return obj.value;
  }

  if(obj.selectedIndex){
    return obj.options[obj.selectedIndex];
  }

  if(obj.checked){
    return obj.checked;
  }

 return null;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-26T20:36:25.517

使用 jQuery，您可以执行以下操作：

```
$('[name="a_21"]').val(); 
```

这将为您提供名称为 a_21 的字段的值，无论字段类型如何。

**注意：**不需要引号，但由于复选框数组，我已经习惯了添加它们：

```
<input type="checkbox" name="ids[]" value="1" />
<input type="checkbox" name="ids[]" value="2" /> 
```

我认为安全比试图弄清楚为什么它不起作用要好。

# iphone - iPhone SDK 3.0 针对 2.2.1 SDK

> ID：791546
> 
> 赞同：0
> 
> 时间：2009-04-26T20:27:35.930
> 
> 标签：iphone

刚刚获得了 iPhone SDK 的最新测试版。这是即将发布的 iPhone SDK 3.0 版本的更新。不幸的是，针对 3.0 平台，我没有收到一堆错误。很高兴知道我可以标记未来的工作，但我需要先完成一些其他工作。不幸的是，“目标”字段不再向我显示 2.2.1 SDK，并且默认为 3.0，导致我想稍后修复无数错误。

我应该采取什么措施来解决这个问题？我已经尝试更改项目属性中的默认基础 SDK 无济于事。安装 3.0 是否基本上删除了 2.2.1 SDK？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T16:31:23.517

弄清楚了。我遇到的错误发生在 beta 版本中，所以这可能不应该是一个持久的解决方案，但是如果其他人在尝试使用 XCode+iPhone0S3 安装的最新 beta 时遇到问题，你会发现你只能针对3.0 操作系统后，您在概览下拉列表中选择它。即使您之前针对的是不同的活动 SDK，一旦您选择 3.0 目标，它们也会全部消失。

解决这个问题的方法是删除所有用户特定的项目文件并重新打开项目。在此之前，请确保基础 SDK 是 2.2.1 等。

这比仅针对以前的 SDK 下载 2GB 稳定的 XCode 要容易得多。

希望这可以帮助某人。

# .net - 从部分受信任的代码中调用非托管代码的正确方法

> ID：791551
> 
> 赞同：3
> 
> 时间：2009-04-26T20:29:48.857
> 
> 标签：.net, security, sharepoint, com, interop

从在部分受信任的环境中执行的代码中通过 .Net 互操作调用非托管代码（例如 COM API）的正确方法是什么？

在为 Microsoft SharePoint 开发 ASP.Net WebPart 时，我必须通过其 COM API 与另一个系统进行通信。我通过将 SharePoint 的权限更改为完全权限暂时解决了这个问题。后来我通过在授予 SharePoint UnmanagedCode 权限的最小设置之上实现自定义安全性来改进这一点，但这并不是什么大的改进，因为非托管代码可以跳过 CAS 的其余部分。

根据我收集到的信息，我可能需要一个完全受信任的程序集，它允许部分受信任的调用者并充当托管域和非托管域之间的层。此外，我想需要一些额外的设置，以允许部分受信任的代码调用完全受信任的代码，而完全受信任的代码不会受到部分受信任代码的权限的影响。

那么正确的方法是什么以及如何在实践中实施呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T08:29:31.513

是的，您需要一个完全受信任的程序集，它允许部分受信任的调用者并充当托管域和非托管域之间的层。

如果您编写的代码必须与部分受信任的代码交互或从部分受信任的上下文中操作，您应该考虑以下因素：

*   库必须使用强名称签名，以便由多个应用程序共享。强名称允许将您的代码放置在全局程序集缓存中，并允许消费者验证特定的移动代码片段是否确实来自您。
*   默认情况下，强名称共享库会自动执行隐式 LinkDemand 以获得完全信任，而库编写者无需执行任何操作。
*   如果调用者没有完全信任但仍尝试调用此类库，则运行时将引发 SecurityException 并且不允许调用者链接到该库。
*   为了禁用自动 LinkDemand 并防止引发异常，您可以将 AllowPartiallyTrustedCallersAttribute 属性放在共享库的程序集范围内。此属性允许从部分受信任的托管代码调用您的库。
*   被授予访问具有此属性的库的部分可信代码仍受本地机器策略定义的进一步限制。
*   部分受信任的代码无法以编程方式调用没有 AllowPartiallyTrustedCallersAttribute 属性的库。如果默认情况下应用程序未获得完全信任，则管理员必须选择修改安全策略并授予应用程序完全信任，然后才能调用此类库。

来源： [MSDN：使用来自部分受信任代码的库](http://msdn.microsoft.com/en-us/library/8skskf63(VS.71).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T05:14:36.007

调用的代码需要具有 UnmanagedCode 权限。那部分是不可避免的。问题是，您将如何获得具有 UnmanagedCode 权限的代码？不幸的是，我对 WebPart/SharePoint 及其限制了解不多，无法在这里为您提供帮助。

# winapi - 标记为“执行”和“读取”的可执行部分？

> ID：791553
> 
> 赞同：2
> 
> 时间：2009-04-26T20:31:54.437
> 
> 标签：winapi, memory, executable, portable-executable

我注意到（至少在 Win32 上）在可执行文件中，代码段（.text）设置了“读取”访问位以及“执行”访问位。**代码读取**自身而不是**执行**自身是否有任何真正的正当理由？我认为这是其他部分的用途（例如 .rdata）。

（具体来说，我说的是[`IMAGE_SCN_MEM_READ`](http://elfz.laacz.lv/ms_exe_spec.html#L41).）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T20:35:25.397

`IMAGE_SCN_MEM_EXECUTE |IMAGE_SCN_MEM_READ`映射到内存中`PAGE_EXECUTE_READ`，相当于 PAGE_EXECUTE_WRITECOPY。这是启用写时复制访问所必需的。Copy-on-write 意味着任何修改页面的尝试都会导致创建一个新的、进程私有的页面副本。

需要 write-copy 有几个不同的原因：

*   需要由加载程序重新定位的代码必须具有此设置，以便加载程序可以进行修复。这是很常见的。
*   在单个部分中包含代码和数据的部分也需要这样做，以启用修改进程全局变量。单个部分中的代码和数据可以节省空间，并可能通过将代码和代码使用的全局变量放在同一页面上来提高局部性。
*   试图修改自身的代码。我相信这是相当罕见的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T20:53:49.813

编译时常量，特别是对于 long long 或 double 值，通常使用 mov 寄存器加载，*地址*语句来自代码段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T20:43:08.280

我能想到的一个阅读代码的例子是允许自我修改代码。代码必须能够自我阅读才能进行自我修改。

还要考虑对面。禁止代码读取自身有什么好处？我在这一点上挣扎了一会儿，但我看不出这样做有什么好处。

# web-services - 快速入门 jboss（或 tomcat）+ beans 教程

> ID：791554
> 
> 赞同：0
> 
> 时间：2009-04-26T20:32:03.657
> 
> 标签：web-services, jakarta-ee, jboss

我对 Eclipse 中用于启动将在 jboss 上运行的 Java EE 项目的无数选项感到有些畏惧。一旦我有一个配置好的环境，我就知道我在做什么，但希望有人能指点我一步一步的教程，告诉我如何从写我的第一堂课到真正让 jboss 在启动时拿起它并采取行动.

我认为本教程需要涉及让 ANT 生成战争文件的部分任务。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T21:21:30.853

[EJB 3 教程解释 Ant 并展示如何使用注释和 JBoss 创建会话和实体 bean](http://www.laliluna.de/ejb-3-ant-tutorial-jboss.html)

# vb.net - 从制表符分隔的文本文件复制到自身

> ID：791558
> 
> 赞同：1
> 
> 时间：2009-04-26T20:33:38.863
> 
> 标签：vb.net, copy-paste, csv

我有一个制表符分隔的文本文件：

```
name    \t loan period \t loan amount
John    \t 5 years     \t 6000
Sarah   \t 5 years     \t 6000
Jane    \t 1 month     \t 100 
```

我正在寻找将“贷款期”=“5年”的行复制到“贷款期”=“1个月”的行，以进行比较。新行将附加在结果文件的末尾。

我希望达到的最终结果是：

```
name    \t loan period \t loan amount
John    \t 5 years     \t 6000
Sarah   \t 5 years     \t 6000
Jane    \t 1 month     \t 100
John    \t 1 month     \t 100
Sarah   \t 1 month     \t 100 
```

我一直在用 Visual Basic .Net 玩弄这个，到目前为止，这就是我想出的

```
 Dim strData As String
    Dim i As Short
    Dim strLine() As String
    lngSize = 0

FileOpen(1, txtloanlistinput.Text, OpenMode.Input)
    While Not EOF(1)
        i = i + 1
        strData = LineInput(1)
    End While
    FileClose(1)
    ReDim loanlist(i)
    strData = ""
    lngSize = i
    i = 0
    FileOpen(2, txtloanlistinput.Text, OpenMode.Input)
    While Not EOF(2)
        i = i + 1
        strData = LineInput(2)
        If i = 1 Then
            strData = LineInput(2)
        End If
        strLine = Split(strData, Chr(9))
        loanlist(i).strName = strLine(0)
        loanlist(i).strLoanPeriod = strLine(1)
        loanlist(i).curLoanAmount = strLine(2)
    End While
    FileClose(1)
    FileClose(2) 
```

我对如何继续画一个空白，并认为我会寻求帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T20:53:34.213

一种方法：

遍历文件一次并将每个名称与 5 年放入某个数组中。然后使用 File.AppendText(path) 返回一个 StreamWriter。遍历您的名称数组并将其写入 StreamWriter，然后刷新并关闭。

查看[File.AppendText 文档](http://msdn.microsoft.com/en-us/library/system.io.file.appendtext(VS.71).aspx)以获取示例代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T21:51:58.677

有点难看，但只是一个开始。

//C＃

```
 OpenFileDialog dialog = new OpenFileDialog();            
        dialog.ShowDialog();            
        string filePath = dialog.FileName;
        //in this list we store the match of 5 years.
        List<string[]> fiveYears = new List<string[]>();
        //open a reader.
        StreamReader tr = new StreamReader(filePath);
        //reaing 1° line.
        string line=tr.ReadLine();
        while (line != null && line != "" && line != "\n")
        {
            //split de line by tabs.
            string[] lineByTabs = line.Split('\t');
           //if the second term equals '5 years'
            if (lineByTabs[1].Equals("5 years"))
            {
                //change from  5 years to 1 month, and to a lonan of 100.
                lineByTabs[1] = "1 month";
                lineByTabs[2] = "100";
                fiveYears.Add(lineByTabs);                   
            }
            line = tr.ReadLine();
        }
        //close reader
        tr.Close();
        //open the file and apend lines.
        TextWriter tw = new StreamWriter(filePath, true);

        foreach (string[] lines in fiveYears)
        {
            tw.WriteLine(lines[0] + "\t" + lines[1] + "\t" + lines[2]);
        }
        tw.Close();

    } 
```

'vb.net

```
 Dim dialog As OpenFileDialog = New OpenFileDialog
    Dim filePath, line As String
    Dim fiveYears As List(Of String()) = New List(Of String())
    Dim lineByTabs As String()
    Dim tr As StreamReader
    Dim tw As TextWriter
    dialog.ShowDialog()
    filePath = dialog.FileName

    tr = New StreamReader(filePath)

    line = tr.ReadLine()

    While Not line = ""

        lineByTabs = line.Split(vbTab)

        If lineByTabs(1).Equals("5 years") Then

            lineByTabs(1) = "1 month"
            lineByTabs(2) = "100"
            fiveYears.Add(lineByTabs)
        End If
        line = tr.ReadLine()
    End While

    tr.Close()

    tw = New StreamWriter(filePath, True)

    For Each lines As String() In fiveYears
        tw.WriteLine(lines(0) + vbTab + lines(1) + vbTab + lines(2))
    Next
    tw.Close() 
```

希望能帮助到你

**注意：** fly 必须以新行结束。并遵循给定的格式（3 列）。

# python - 我可以在 Python 2.5 中使用哪个 JSON 模块？

> ID：791561
> 
> 赞同：63
> 
> 时间：2009-04-26T20:34:15.757
> 
> 标签：python, json

我想使用 Python 的[JSON](http://docs.python.org/library/json.html)模块。它仅在 Python 2.6 中引入，我现在坚持使用 2.5。Python 2.6 提供的特定 JSON 模块是否可作为可与 2.5 一起使用的单独模块提供？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-04-26T20:35:22.760

您可以使用[simplejson](http://pypi.python.org/pypi/simplejson)。

如[答案](https://stackoverflow.com/a/2119597)表[pkoch](https://stackoverflow.com/users/5128/pkoch)所示，您可以使用以下 import 语句根据已安装的 python 版本获取 json 库：

```
try:
    import json
except ImportError:
    import simplejson as json 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2010-01-22T18:41:57.850

致威尔斯和其他人：

> 这里已经很晚了，但是如何根据安装的 python 版本编写脚本来导入 json 或 simplejson 呢？

就是这样：

```
`try:
    import json
except ImportError:
    import simplejson as json` 
```

* * *

 `## 回答 #3

> 赞同：4
> 
> 时间：2010-12-24T20:09:29.683

我编写了 cjson 1.0.6 补丁，我的建议是不要使用 cjson——cjson 在处理 unicode 等方面还有其他问题。我认为 cjson 的速度不值得处理这些错误——编码/解码 json 通常只需要处理典型 Web 请求所需的一小部分时间......

python 2.6+中的json基本上是simplejson带入标准库我相信......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T05:03:22.680

我更喜欢 cjson，因为它更快：[http ://www.vazor.com/cjson.html](http://www.vazor.com/cjson.html)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-09T19:13:40.283

我也在使用 Python 2.5 进行编程，并且想要一个合适的库。这是我的做法。

[从http://pypi.python.org/simple/simplejson/](http://pypi.python.org/simple/simplejson/)下载了名为 simplejson-2.0.6-py2.5-linux-i686.egg 的 simplejson egg 文件

使用以下命令安装它：

`sudo python ./ez_setup.py ./simplejson-2.0.6-py2.5-linux-i686.egg`

然后通过执行以下操作将 json 库导入脚本文件：

```
import sys
sys.path.append("/home/coolkid/Android/simplejson/simplejson-2.0.6-py2.5-linux-i686.egg")
try: import simplejson as json
except ImportError: print ("import error") 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2019-06-25T18:23:57.220

[`json`](https://docs.python.org/3/library/json.html)是一个*内置模块*，你不需要安装它`pip`。

# .net - 将列功能添加到自定义中继器

> ID：791571
> 
> 赞同：0
> 
> 时间：2009-04-26T20:39:50.953
> 
> 标签：.net, custom-controls, repeater

我正在尝试扩展我拥有的自定义中继器，以便以表格方式显示（与 Gridview 相当相似）。我在概念上希望实现的是获得可以通过以下方式应用的东西：

```
<my:customrepeater id="rpt" runat="server">
    <cols>
        <col Header="ID">##ID##</col>
        <col Header="Name">##Name##</col>
    </cols>
</my:customrepeater> 
```

任何人都可以提出一种可以实现的方法吗？我可以以某种方式为实现 ITemplate 的类创建一个集合吗？

谢谢，史蒂夫

！编辑！

我通过在转发器中创建一个具有 ITemplate 属性和 generic.list(of Col) 属性的新类 (Col) 来实现它。因此，要添加项目，我执行以下操作：

```
 <Columns>
     <my:Col Header="1"><ColTemplate>test</ColTemplate></my:Col>
     <my:Col Header="2"><ColTemplate>test2</ColTemplate></my:Col>
     <my:Col Header="3"><ColTemplate>test3</ColTemplate></my:Col>
  </Columns> 
```

让我知道是否有人有更好的解决方案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T11:53:26.480

我通过在转发器中创建一个具有 ITemplate 属性和 generic.list(of Col) 属性的新类 (Col) 来实现它。因此，要添加项目，我执行以下操作：

```
<Columns>
    <my:Col Header="1"><ColTemplate>test</ColTemplate></my:Col>
    <my:Col Header="2"><ColTemplate>test2</ColTemplate></my:Col>
    <my:Col Header="3"><ColTemplate>test3</ColTemplate></my:Col>
</Columns> 
```

看到没有其他建议出现，我想我应该将其标记为已回答并在此处提供我的解决方案。

干杯

# asp.net - 母版页上的 FormView 无法通过 ContentPlaceHolder 边界查看数据绑定控件

> ID：791572
> 
> 赞同：1
> 
> 时间：2009-04-26T20:40:45.960
> 
> 标签：asp.net, master-pages, formview

我有许多类似结构的 FormView。为了避免重复标记，我创建了一个包含 FormView 的母版页，并在 FormView 中放置了一个 ContentPlaceHolder。特定的数据绑定控件——这是唯一在页面之间发生变化的东西——然后位于使用该母版页的页面上。

所以我有一个看起来像这样的母版页：

```
<%@ master ... %>
...
<form runat=server>
...
   <asp:formview runat="server" ... >
      <edititemtemplate>
         ... Lots of common markup ...
         <asp:contentplaceholder id='FormRows' runat='server' />
         ... Lots more common markup ...
       </edititemtemplate>
    </asp:formview>
...
</form> 
```

以及使用该母版页的页面，如下所示：

```
<%@ page masterpagefile="Form.Master" ... %>
<asp:content contentplaceholderid="FormRows" runat="server" >
   ...
   <p>
     Field One: 
     <asp:textbox runat=server text='<%#Bind("Field1")%>' id='Field1' />
   </p>
   <p>
     Field Two: 
     <asp:textbox runat=server text='<%#Bind("Field2")%>' id='Field2' />
   </p>
   ...
</asp:content> 
```

使用现有记录，FormView 可以看到数据绑定控件（Field1 等）并用正确的数据填充它们。但是在插入或更新时，它看不到它们，并且它们不包含在插入或更新中。在`FormView_ItemInserting`事件中，`e.Values`是空的；同样在`FormView_ItemUpdating`事件中，`e.NewValues`是空的。

所以：

1.  有没有办法让母版页上的 FormView 看透 ContentPlaceholder 内的数据绑定控件？

2.  如果做不到这一点，是否有一种直接的方法来识别数据绑定的控件，`<%#Bind(...)%>`以便我可以手动将它们添加到值包中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T14:33:25.217

有几件事让我想到为什么这个设置不起作用，并且可能导致代码多于标记。

如果您在母版页中定义了数据源，它将不会处理来自每个页面的不同数据绑定控件，而无需向母版页添加更多逻辑以更改查询等。

所有表单视图都将耦合在一起，从而增加未来更改的复杂性

我会为每个 FormView 使用单独的页面，以减少代码的复杂性、调试和更改的能力

只是我的两分钱

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T00:55:15.563

你也许可以做这样的事情......

为您的“数据页面”定义一个接口，该接口具有返回可绑定数据源的方法签名。

```
public interface IFormViewChild {
   IEnumerable GetFormData();
} 
```

然后你可以让你的“数据页面”实现那个接口......

```
public class ChildDataPage : Page, IDataPage {
   public IEnumerable GetFormData() {
      // code to return stuff here
   }
} 
```

最后，在您的母版页的 Load() 事件中...

```
if (Page is IFormViewChild) {
   myFormViewControl.DataSource = ((IFormViewChild)Page).GetFormData();
   myFormViewControl.DataBind();
} 
```

请记住，这都是直接输入此 Web 表单编辑器的所有伪代码。所以它可能是错误的。但它可能不是:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T23:58:29.370

你在哪里有服务器表单标签？可能在母版页的内容占位符中，因此您的值在提交后不会发送到服务器页面

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T04:35:11.807

我认为这将被证明是困难的，如果不可能的话；事实上，我很惊讶数据绑定完全有效！

您可能想要尝试封装 FormView 控件的不同方法。

您可以尝试将 FormView 控件放置在具有 PlaceHolder 的 .ascx 控件中，您现在拥有 ContentPlaceHolder。

然后在每个 ASPX 页面上，您可以有一个包含占位符填充符的镜像 ASCX 页面。您可以给它们相同的名称（Page1.aspx 使用 Page1.ascx）或设置像 Page1-Content.ascx 这样的命名约定，以便您的 FormView ascx 会弄清楚它的填充控件的名称，使用 Page.LoadControl()通过路径加载控件，并在初始化阶段插入该内容。

现在，您的内容控件具有能够拥有公共属性的优势，因此您可以绑定到这些公共属性，并让这些属性将数据往返于填充 .ascx 文件中的适当服务器控件。

不幸的是，它是文件的两倍（因为每个页面都需要 ASPX 和 ASCX），但与替代方案（复制所有代码）相比，它的工作量相当低

当然，您还没有告诉我们您所有的通用标记是什么，但是您的通用标记也可以进入 CommonMarkupHeader.ascx 和 CommonMarkupFooter.ascx 并包含在每个页面的唯一 FormView 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T15:01:13.563

这是一个临时解决方案 - 不优雅，但它有效。在 Form.Master 的代码隐藏中，我有以下内容：

```
 Private Sub FormView1_ItemInserting(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.FormViewInsertEventArgs) Handles FormView1.ItemInserting
        ManuallyAddValues(e.Values)
    End Sub

    Private Sub FormView1_ItemUpdating(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.FormViewUpdateEventArgs) Handles FormView1.ItemUpdating
        ManuallyAddValues(e.NewValues)
    End Sub

    Private Sub ManuallyAddValues(ByRef Values As IOrderedDictionary)
        For Each Field As Core.Field In FormView1.DataSourceControl.IncludedFields
            If Values(Field.Name) Is Nothing Then
                Dim DataboundControl As Control = FormView1.FindControl("FormRows").FindControl(Field.Name)
                Values.Add(Field.Name, GetValue(DataboundControl))
            End If
        Next
    End Sub 
```

这不是那么优雅，因为

1.  我必须知道所有数据绑定控件的名称
2.  这依赖于每个控件的 ID 与字段名匹配的假设
3.  'GetValue' 函数（此处未包括）是一个笨拙的解决方案：它检查各种类型（文本框、下拉列表、复选框等）并从适当的属性（textbox.text、dropdownlist.selectedvalue、checkbox.txt）中获取字符串值。检查等）。

我仍然希望至少有一种方法可以了解与 '<%#Bind("Foo")%>' 语法绑定的内容并直接获取该信息。

# .net - 无法使用 ADO.NET Entity Framework 执行存储过程

> ID：791581
> 
> 赞同：9
> 
> 时间：2009-04-26T20:47:57.847
> 
> 标签：.net, vb.net, entity-framework, stored-procedures, ado.net

我创建了一个简单的无参数存储过程，已粘贴在下面。我已将存储过程导入到我的实体模型并创建了一个函数导入。从未创建模型中的函数，我无法使用 ADO.NET 实体框架执行此存储过程。我在 XML 视图中打开了 .edmx 文件，并确认此存储过程没有错误。我究竟做错了什么？从Entity Framework中调用这么简单的存储过程真的不可能吗？我已将导入函数的返回类型设置为无，因为此存储过程不需要返回任何记录集或值。

存储过程：

```
ALTER PROC [dbo].[Inventory_Snapshot_Create]

AS

SET NOCOUNT ON

DECLARE @Inventory_Snapshot_ID int

INSERT INTO Inventory_Snapshots (snapshot_timestamp)
VALUES (GETDATE())

SET @Inventory_Snapshot_ID = SCOPE_IDENTITY()

INSERT INTO Inventory_Snapshot_Products (inventory_snapshot_id,
    idProduct, stock)

    SELECT @Inventory_Snapshot_ID, idProduct, stock
    FROM products

SET NOCOUNT OFF 
```

尝试执行存储过程的代码：

```
Dim db As New MilkModel

db.Inventory_Snapshot_Create() 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-07-07T08:32:50.833

首先将其添加到模型中，然后转到实体容器，然后导入函数。

完整的细节在这里：

[http://msdn.microsoft.com/en-us/library/bb896231.aspx](http://msdn.microsoft.com/en-us/library/bb896231.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-26T21:44:46.227

谢谢，pmarflee。

我实际上是来这里发布我的解决方案的，同时也看到了你的回复。这段代码实际上使用了实体框架的连接，并执行了我导入到模型中的存储过程。Microsoft 一直在推动我们的开发人员使用 Entity Framework 而不是 LINQ to SQL 和其他 DAL 生成器，但 EF*确实*根本不需要它。在它成为更完整的解决方案之前，我不会在未来的项目中使用它。

这就是我最终做的事情：

```
Dim db As New MilkModel

'==
'Begin dirty hack to execute parameterless/resultless stored
'procedure using Entity Framework (well, sort of using EF). 
'http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/44a0a7c2-7c1b-43bc-98e0-4d072b94b2ab/
'==
Dim con As DbConnection = db.Connection

con.Open()

Dim cmd As DbCommand = con.CreateCommand()

With cmd
    .CommandType = CommandType.StoredProcedure
    .CommandText = "MilkModel.Inventory_Snapshot_Create"
    .ExecuteNonQuery()
    .Dispose()
End With

con.Dispose()
'==
'End dirty hack
'== 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-03-25T15:36:14.010

任何存储过程都可以通过 EF 调用。创建一个 SP 并将其添加到您的模型中。进一步转到模型浏览器，右键单击sp，然后单击添加函数导入，在这里选择您的SP，并选择它返回的类型，如果它没有返回则选择“无”。如果它返回一个 sclar 类型，则选择该类型，如果它返回一个记录集，则选择复杂。单击获取列信息，它将显示返回的列。单击创建新的复杂类型。并单击确定。如果它返回其中一个实体，则单击选项实体并从列表框中选择实体类型。

现在你在你的代码中调用它。

如果它返回一个复杂类型使用代码：

`MyEntities _entities = new MyEntities(); var p = from d in _entities.GetOrderInfo() select d;`

如果它什么都不返回，则使用代码： `MyEntities _entities = new MyEntities(); _entities.Cancel_Sale(ucode, oid);`

如需进一步查询，请访问

[http://dubeyniraj.blogspot.com/](http://dubeyniraj.blogspot.com/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-26T21:31:45.947

我认为您不能将存储过程添加到 EF 模型，除非它与实体上的特定 CRUD 操作相关联。但是，您可以引用实体容器对象的**Connection**属性来访问 EF 正在使用的基础 ADO.NET 连接对象。然后，您可以使用传统的 ADO.NET 代码调用您的存储过程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-27T14:21:59.783

万一其他人对此感到疑惑...

存储过程和实体框架的主要问题是需要定义返回类型。例如，如果您有一个从表中返回一些行的存储过程，则需要告知实体框架这些行的结构是什么样的。它需要这个，以便它可以生成所有代理类并序列化和反序列化事物。

当您转到模型 - rigkt click - inport 函数时，您可以选择一个存储过程，但它期望返回类型为无、标量或实体类型（ee 基于数据库中的表）。如果您愿意，可以添加复杂类型。右键单击模型 - 选择添加 - 复杂类型。然后定义列及其数据类型。

完成此操作后，您刚刚创建的类将显示在上面提到的实体类型列表下。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-03-26T13:08:32.233

对于我的项目，我实际上使用的是 FirebirdSql DB，我不知道它是否真的适合实体框架，因为我使用它给我带来了一些问题，而且它的性能不那么好。

但无论如何，如果我（函数）导入一个包含一些插入操作的存储过程，出于某种原因，什么也没有发生。换句话说，如果我在我的模型（EDCX）中添加这样的 SP：

```
create procedure insert_stuff(thing varchar(40))
returns response(50)
as
begin
    insert into stuffs(thing) values (thing);

    response = 'done!';

    suspend;
end; 
```

然后我这样称呼它：

```
FirebirdContext.InsertStuff("Hi there!"); // it should return an ObjectResult<String>
FirebirdContext.SaveChanges(); 
```

好吧，实际上什么也没发生。什么都没有。既没有异常，也没有结果，也没有插入，一切都是完美的，没有警告没有编译错误。有趣的是，如果我在存储过程脚本中添加一个删除，删除就可以了！！但是没有插入！

如图所示，该表非常简单，我已经导入了其他存储过程并且它们可以工作，但是因为它们包含查询、更新和删除，如果它们得到了插入......没办法！会不会是 Firebird Ado.NET 提供程序中的错误？还是我必须设置我错过的东西？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-11-15T13:48:58.660

如果想避免使用 DBCommand，我通过使 SP 返回一组与实体定义匹配的列来使其工作。

# javascript - 如何将事件绑定到附加元素？

> ID：791583
> 
> 赞同：0
> 
> 时间：2009-04-26T20:50:08.777
> 
> 标签：javascript, jquery

我尝试使用 jquery 效果显示错误消息，`fadeTo`并尝试通过附加按钮和使用淡出来隐藏消息，但似乎不起作用。

我所做的是：

```
$("#sub_error")
  .fadeTo(200, 0.1, function()
  {
    $("#sub_error")
      .html(error.join("<br/><br/>"))
      .append('<br/><input type="button" name="err_ok" id="err_ok" value="ok">')
      .addClass('subboxerror')
      .fadeTo(900,1);
  });

$("#err_ok").click(function() 
{
  $("#sub_error").fadeOut("slow");
}); 
```

我做错了什么，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T20:56:00.883

#err_ok 元素最初不存在，因此 .click() 处理程序未应用于它。

你可以解决这个问题

```
$("#err_ok").click(function () {
  $("#sub_error").fadeOut("slow");
}); 
```

在函数中并在 DOM 中创建元素后调用该函数。

编辑：这应该是一个完整的解决方案：

```
$("#sub_error").fadeTo(200, 0.1, function() {
    $("#sub_error")
      .html(error.join("<br/><br/>"))
      .append('<br/><input type="button" name="err_ok" id="err_ok" value="ok">')
      .addClass('subboxerror')
      .fadeTo(900, 1);
    bindEvents();
});

function bindEvents() {
    $("#err_ok").click(function() {
        $("#sub_error").fadeOut("slow");
    });
} 
```

还有一个“ [live](http://docs.jquery.com/Events/live) ”函数也可以将事件绑定到未来创建的 DOM 元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T21:00:23.043

FWIW，在 JQuery 错误跟踪器上有关于 fadeTo/fadeOut 错误的提交票。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T21:09:42.443

有几种方法可以做到这一点。一，您可以在插入元素后将点击处理程序附加到元素：

```
$("#sub_error").fadeTo(200, 0.1, function() {
    $("#sub_error")
      .html(error.join("<br/><br/>"))
      .append('<br/><input type="button" name="err_ok" id="err_ok" value="ok">')
      .addClass('subboxerror')
      .fadeTo(900, 1)
      .find('#err_ok')
      .click( function() {
        $("#sub_error").fadeOut("slow");
      });
}); 
```

或者二，您可以使用实时事件处理程序，以便任何具有“err_ok” id 的元素在创建时都会获得点击处理程序。

```
$('#err_ok').live('click', function() {
    $('#sub_error').fadeOut('slow');
}); 
```

# regex - JavaCC的警告“正则表达式选择：FOO永远不能匹配为：BAR”的解释和解决方案？

> ID：791591
> 
> 赞同：5
> 
> 时间：2009-04-26T20:53:47.020
> 
> 标签：regex, parsing, javacc

我正在自学在一个爱好项目中使用 JavaCC，并有一个简单的语法来编写解析器。解析器的一部分包括以下内容：

```
TOKEN : { < DIGIT : (["0"-"9"]) > }
TOKEN : { < INTEGER : (<DIGIT>)+ > }
TOKEN : { < INTEGER_PAIR : (<INTEGER>){2} > }
TOKEN : { < FLOAT : (<NEGATE>)? <INTEGER> | (<NEGATE>)? <INTEGER>  "." <INTEGER>  | (<NEGATE>)? <INTEGER> "." | (<NEGATE>)? "." <INTEGER> > } 
TOKEN : { < FLOAT_PAIR : (<FLOAT>){2} > }
TOKEN : { < NUMBER_PAIR : <FLOAT_PAIR> | <INTEGER_PAIR> > }
TOKEN : { < NEGATE : "-" > } 
```

使用 JavaCC 编译时，我得到输出：

```
Warning: Regular Expression choice : FLOAT_PAIR can never be matched as : NUMBER_PAIR

Warning: Regular Expression choice : INTEGER_PAIR can never be matched as : NUMBER_PAIR 
```

我确信这是一个简单的概念，但我不明白这个警告，作为解析器生成和正则表达式的新手。

这个警告是什么意思（在你可以得到的新手术语中）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T23:51:26.953

我不知道JavaCC，但我是一名编译器工程师。

`FLOAT_PAIR`规则是模棱两可的。考虑以下文本：

```
0.0 
```

`FLOAT 0`后面可以是`FLOAT .0`; 或者它可以`FLOAT 0.`跟随`FLOAT 0`; 两者都导致 FLOAT_PAIR。或者它可能是一个单一的 FLOAT `0.0`。

但是，更重要的是，您正在以一种永远不可能奏效的方式使用带有组合的词法分析。考虑这个数字：

```
12345 
```

这可以被解析为`INTEGER 12, INTEGER 345`导致`INTEGER_PAIR`. 或者它可以被解析为`INTEGER 123, INTEGER 45`另一个`INTEGER_PAIR`. 或者它可能是`INTEGER 12345`另一个令牌。存在问题是因为您不需要`INTEGER_PAIR`(or `FLOAT_PAIR`) 的词法元素之间有空格。

您几乎不应该尝试在词法分析器中处理这样的对。相反，您应该将普通数字 (`INTEGER`和`FLOAT`) 作为标记处理，并在解析器中处理诸如否定和配对之类的事情，其中​​空格已被处理和剥离。

（例如，您将如何处理`"----42"`？这是大多数编程语言中的有效表达式，可以正确计算多个否定，但不会由您的词法分析器处理。）

另外，请注意，词法分析器中的个位数整数不会匹配为`INTEGER`，它们会输出为`DIGIT`。不过，我不知道 JavaCC 为您解决这个问题的正确语法。您想要的`DIGIT`不是定义为令牌，而只是您可以在其他令牌的定义中使用的东西；或者，将`DIGIT`( `[0-9]`) 的定义直接嵌入到您`DIGIT`在规则中使用的任何位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T20:59:53.713

我没有使用过 JavaCC，但 NUMBER_PAIR 可能是模棱两可的。

我认为问题归结为这样一个事实，即 FLOAT_PAIR 和 INTEGER_PAIR 可以匹配相同的确切事物，因为 FLOAT 可以匹配 INTEGER。

但这只是一个从未见过 JavaCC 语法的猜测 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T22:24:37.240

这可能意味着对于每一个`FLOAT_PAIR`你只会得到一个`FLOAT_PAIR`令牌，而不是一个`NUMBER_PAIR`令牌。该`FLOAT_PAIR`规则已经匹配了所有输入，JavaCC 不会尝试查找更多匹配规则。那将是我的解释，但我不了解 JavaCC，所以请持保留态度。

也许您可以以某种方式指定这`NUMBER_PAIR`是主要产品，并且您不希望获得任何其他令牌作为结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T20:32:19.263

感谢巴里凯利的回答，我想出的解决方案是：

```
 SKIP : { < #TO_SKIP : " " | "\t" > }
    TOKEN : { < #DIGIT : (["0"-"9"]) > }
    TOKEN : { < #DIGITS : (<DIGIT>)+ > }
    TOKEN : { < INTEGER : <DIGITS> > }
    TOKEN : { < INTEGER_PAIR : (<INTEGER>) (<TO_SKIP>)+ (<INTEGER>) > }
    TOKEN : { < FLOAT : (<NEGATE>)?<DIGITS>"."<DIGITS> | (<NEGATE>)?"."<DIGITS> > } 
    TOKEN : { < FLOAT_PAIR : (<FLOAT>) (<TO_SKIP>)+ (<FLOAT>) > }
    TOKEN : { < #NUMBER : <FLOAT> | <INTEGER> > }
    TOKEN : { < NUMBER_PAIR : (<NUMBER>) (<TO_SKIP>)+ (<NUMBER>) >}
    TOKEN : { < NEGATE : "-" > } 
```

我完全忘记了包含用于分隔两个标记的空格，我还使用了“#”符号来停止匹配标记，并且仅用于其他标记的定义。以上由JavaCC编译，没有警告或错误。

然而，正如巴里所指出的，有理由反对这样做。

# java - ilasm / ildasm 的 Java 字节码等价物

> ID：791600
> 
> 赞同：5
> 
> 时间：2009-04-26T21:00:19.877
> 
> 标签：java, bytecode

对于 CIL / MSIL，我可以在文本编辑器中编写代码并使用 ilasm / ildasm 进行编译/反编译。

我可以使用 Reflector 查看由 .NET 类生成的 CIL。

在 Java 世界中， javap -c 显示了反汇编的字节码。

如何编译 Java 字节码？（即 ilasm / ildasm 的 Java 等价物）。

是否有支持 Java 字节码的 IDE？

IDE 是否支持调试，即单步执行/断点等？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T21:17:44.483

[Eclipse 的字节码大纲插件](http://asm.ow2.org/eclipse/index.html)

要使用字节码，您可以使用 ASM 或[BCEL](http://jakarta.apache.org/bcel/manual.html)

看看 org.apache.bcel.util.BCELifier，它接受一个给定的类并将其转换为一个 BCEL 程序（当然是在 Java 中）。它将向您展示如何使用 BCEL 生成某些代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-09-27T14:28:16.887

茉莉：

[http://jasmin.sourceforge.net/](http://jasmin.sourceforge.net/)

它是 Java 字节码的汇编器。虽然上面的海报指出，手动编码 Java 字节码可能不是很有用，但 Jasmin 已被用作以 JVM 作为运行时的编译器的后端。因此，您的编译器可以输出 Jasmin 汇编程序指令，然后 Jasmin 将它们转换为 Java 类。

# filter - 无法将 Google 定义转换为标准输出

> ID：791610
> 
> 赞同：-1
> 
> 时间：2009-04-26T21:07:43.120
> 
> 标签：filter, stdout

我的目标是在终端过滤我的谷歌结果，这样我就只能得到谷歌的定义。

我正在尝试在 Mac 的终端中运行以下命令

```
open http://www.google.com/search?q=define:cars&ie=utf-8&oe=utf-8:en-GB:official&client=vim 
```

Firefox 的类似命令是

```
open http://www.google.com/search?q=define:cars&ie=utf-8&oe=utf-8:en-GB:official&client=firefox-a 
```

**您可以使用哪个客户端将 Google 的 html 页面添加到您的标准输出中？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T21:20:14.727

[要不通过他们的网络界面使用 Google 搜索，几乎可以肯定的是使用他们的API](http://code.google.com/apis/ajaxsearch/)会更好。

但是，`curl`如果这是您必须做的事情，我认为这是用于下载网页的正确工具（可能不是）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T21:26:12.060

“得到”

```
GET 'http://www.google.com/search?q=define:cars&ie=utf-8&oe=utf-8:en-GB:official&client=vim' 
```

另见“头”。

该命令可以安装在 Gnu/Linux 操作系统上：

```
[elcuco@pinky ~]$ rpm -qf `which GET`
perl-libwww-perl-5.808-2mdv2008.1 
```

理论上，您也可以使用“wget”并使用以下方式输出到标准输出：

```
wget http://www.google.com -O - --quiet 
```

但是我不能让它与这个示例 URL 一起工作。

# php - 为什么我的 MySQL INSERT 查询插入 3 个相同的行？

> ID：791611
> 
> 赞同：0
> 
> 时间：2009-04-26T21:08:04.990
> 
> 标签：php, mysql, insert

我正在尝试使用 PHP 和 MySQL 跟踪用户在我的网站上搜索的内容（从首页上的简单搜索表单）。

在我所有的查询结束时，我正在使用这个查询：

```
INSERT INTO `DiggerActivity_Searches` (
`SearchTerms`,
`SearchType`,
`NumResults`,
`Location`,
`Date`,
`Time`
) VALUES (
'SearchKeywords',
'SearchTypes',
'NumberOfResults',
'User'sLocation',
'CurDate',
'CurTime'
) 
```

现在，只要有一个新的搜索关键字，它就会插入 3 个相同的行。但是，如果我刷新页面，它应该只插入 1 行。

这些值像这样作为 GET 传递（我已经重写了 URL 的东西）：

> [http://www.mysite.com/Search-Category-Search_these_words](http://www.mysite.com/Search-Category-Search_these_words)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T22:03:50.847

您可能想首先检查您的脚本是否执行了 3 次查询或脚本被调用了 3 次（例如通过某些浏览器插件）。
如果您没有安装调试器，您可以使用类似的东西

```
功能跟踪日志（）{
    静态 $magic = null;
    if (is_null($magic)) {
        $magic = uniqid();
    }

    $s = $魔法。' '。微时间（真）。":\r\n";
    foreach( debug_backtrace() as $d) {
        $s .=''。$d['file'].'@'.$d['line']."\r\n";
    }

    file_put_contents('trace_log.txt', $s, FILE_APPEND);
}

...
跟踪日志（）；
mysql_query(....) // 或 stmt->execute() 或任何你用来执行查询的东西。

```

如果 trace_log.txt 中每个日志条目的第一个值（“魔术”id）发生变化，您的脚本将被多次调用。如果对 trace_log() 的所有三个调用都相同，则您的脚本将执行该查询 3 次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T21:54:32.070

您的表缺少主键。我建议一个 PK 像搜索 ID 或类似的东西

[在唯一键 - 维基百科](http://en.wikipedia.org/wiki/Primary_key)上阅读更多相关信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T06:37:15.923

只知道你不是一个人在处理这个奇怪的错误。

在过去的几天里，我的网站上也出现了同样的问题。我最近添加的唯一内容是第三方横幅广告。

解决方案：我注释掉了横幅广告脚本（提示：来自以 G 开头的搜索引擎），一切都恢复正常了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T13:35:02.997

我只是要发表评论，需要更多的声誉，所以......

无论如何，类似的事情发生在我身上。原来我在标题上方回显调试信息，导致浏览器自动重新加载。最简单的检查方法就是使用

```
<script type="text/javascript">alert("loading");</alert> 
```

在标题中，看看你看到了多少次。

# silverlight - HCI：让用户预先等待，还是摊销？

> ID：791613
> 
> 赞同：1
> 
> 时间：2009-04-26T21:10:01.070
> 
> 标签：silverlight, hci

我正在编写一个 Silverlight 应用程序，该应用程序查询 Web 服务以填充树控件。每个元素将至少有 2 级子级，因此如下所示：

```
a
+-b
  +-c
d
+-g
  +-h
e
+-i
  +-j
f
+-k
  +-l 
```

Web服务API是这样的，我一次只能得到一个级别的子节点，所以第一次旅行，我可以得到a，d，e，f。要获得 b,g,i,k，我必须进行 4 次旅行。同样，我必须再进行 4 次旅行才能获得 c、h、j、l。（该服务实际上允许我在一次旅行中获取所有节点，但它并没有给我提供父子关系:-()

我的问题是：我应该让用户在获取树视图的所有节点时提前等待一段时间，还是应该只获取前几个节点，然后按需获取其他节点，或者在后台获取任务？此外，节点可以异步更改，所以如果我提前获取所有节点，我需要一个树视图的“刷新”按钮，如果我按需执行，我将必须有一个缓存策略。

哪个最适合用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T21:21:31.510

一种折衷方案，您预先加载第一个级别，然后根据需要在后台加载其余项目，由按需覆盖。如果您首先加载节点宽度（例如 a,d,e,f 然后 b,g,i,k）而不是深度优先（例如 a,d,e,f 然后 b,c），您可以将加载重定向到专注于最近扩展的节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T06:33:09.770

简短的回答是让用户尽可能少地等待。如果他们在应用程序加载时必须等待 10-20 秒，他们会诅咒你的名字，但不会注意到树节点扩展需要 0.1-0.2 秒。

我有一个具有类似结构的生产应用程序。我无法预先加载，因为它会有效地加载整个数据库。这是我的策略：

*   树控件从根下方展开的 1 级开始。
*   每个未展开的节点都有一个虚拟子节点，以便显示 [+] 展开图标
*   当一个节点展开时，它会触发一个被应用程序捕获的事件。如果唯一的子节点是虚拟节点，则删除虚拟节点并从数据库中加载子节点。
*   可见节点不会自动反映数据的变化，但是树的上下文菜单有一个刷新项，可用于刷新节点。

我考虑过异步显示更新，但倾向于避免它，因为大量数据可以显示在树中，如果我要检查它们是否有变化，我会警惕数据库负载。

该应用程序是 WinForms，使用 .NET 2.0 用 C# 编写。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T06:21:45.523

就个人而言，作为用户，我更希望预先加载所有数据，这样一旦应用程序完成加载，我就可以相信我不再需要等待（或者至少很少等待）

但是，我想这取决于您的应用程序/数据的几个特征：

*   ***数据的动态性如何？它的更新频率是否高于用户浏览节点的频率？*** 如果是这样，那么您将不得不在用户浏览数据时读取数据，否则您可能只能偶尔更新它并在执行重要操作之前检查最新数据。
*   ***用户在正常使用过程中会探索多少数据？*** 如果他们不断探索整棵树，那么加载整棵树很重要。另一方面，如果大多数用户通常只会扩展树的一小部分，那么按需加载可能会更好，这样您就不会浪费时间加载他们永远不会看到的数据。
*   ***这对性能有多大影响？加载所有数据真的需要很长时间吗？*** 如果数据不是太多，也许整个东西可以在几秒钟内加载，在这种情况下，实现优化的工作量对最终用户来说并不重要，反过来也不会有很好的回报投资。

很可能您对这些问题没有明确的答案，但是当您解决这个有趣的问题时，它们可能是很好的考虑因素。

# xcode - 防止 xcode 和 interface builder 调整预览图像的大小

> ID：791616
> 
> 赞同：0
> 
> 时间：2009-04-26T21:12:54.527
> 
> 标签：xcode

由于某种原因，当我将图像添加到 xcode 时，xcode 显示的预览小于原始图像。该图像在 Interface Builder 中也显示得更小（大约一半大小），但是当我运行应用程序时，一切都很好。

有没有办法防止 xcode 和 Interface Builder 调整图像预览的大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T05:20:28.143

图像的 DPI 设置不是 72 dpi，这就是 xcode 和 interface builder 调整预览大小的原因。

为避免/修复它，请将图像设置为 72 dpi。

# asp.net - 您将如何在 asp.net mvc 应用程序中将 InitParameters 发送到 Silverlight？

> ID：791617
> 
> 赞同：2
> 
> 时间：2009-04-26T21:13:16.880
> 
> 标签：asp.net, asp.net-mvc, silverlight

以前，我将信息传递给 Page_Load 方法内的 Silverlight 控件。IE

```
protected void Page_Load(object sender, EventArgs e)
{
   MainContainer.InitParameters = "info=" + CurrentUserID.ToString();
} 
```

在 MVC 中，没有代码隐藏的概念，我将用户 ID 作为模型的一部分传递，但以下代码似乎不起作用：

```
<asp:Silverlight id="MainContainer"
   InitParameters="info=<%= Model.CurrentUserID %>" runat="server"
   Source="~/ClientBin/SilverlightControls.xap" ... /> 
```

如果您查看呈现给浏览器的代码，它会转义 MVC 标记，因此它会像这样发送：

```
value="info=&lt;%= Model.CurrentUserID %>" 
```

如果我尝试硬编码 InitParameters="info=1"，它会起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T22:39:19.607

不要使用 <asp:Silverlight runat="server" /> 控件，它是一个 webforms 控件，并不真正属于 MVC 世界。您需要自己创建 <object> 标记 - 也许创建您自己的 Html 辅助扩展方法来创建它。

看看这篇博文： [集成 Silverlight 和 ASP.NET MVC](http://timheuer.com/blog/archive/2009/02/09/silverlight-as-a-view-in-aspnet-mvc.aspx)

HTH，查尔斯

# python - 最好的 Python 播客？

> ID：791618
> 
> 赞同：38
> 
> 时间：2009-04-26T21:13:29.563
> 
> 标签：python, podcast

任何人都可以推荐与 Python 相关的优秀播客吗？它可以是关于 Python 或其生态系统的任何内容（如 django、pylons 等）。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-26T21:19:31.310

[Google Code University](http://code.google.com/edu/languages/index.html)（有几种语言）
[Python Podcasts](http://advocacy.python.org/podcasts/)
[Python Learning Foundation](http://www.awaretek.com/python/index.html)
[Python411 on PodcastAlley.com](http://www.podcastalley.com/podcast_details.php?pod_id=5786)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T00:49:19.560

我对 Python411 并没有想太多——我下载的那一集主要是主持人谈论他打算如何编写一个 GAE 网站。

正如 Geo 所指出的，[本周在 Django中是（或可能是）一个很好的 Python 播客。](http://thisweekindjango.com/)显然，由于它专注于 Django 开发，因此讨论了很多 Djangoisms，但是也分享了很多通用的 Python 知识。TWID 目前正在进行改造，请关注[@djangodose](http://twitter.com/djangodose)以获取更新。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-27T06:34:13.240

[Changelog](http://thechangelog.com/)（阅读博客，听播客，非常好）有一些 Python 资料，例如：

*   [http://thechangelog.com/post/1174335646/episode-0-3-6-django-dash](http://thechangelog.com/post/1174335646/episode-0-3-6-django-dash)
*   [http://thechangelog.com/post/1087757312/episode-0-3-4-mongrel2-guitar-and-more-with-zed-shaw](http://thechangelog.com/post/1087757312/episode-0-3-4-mongrel2-guitar-and-more-with-zed-shaw)
*   [http://thechangelog.com/post/610697985/episode-0-2-4-facebook-open-source-projects-tornado-hip](http://thechangelog.com/post/610697985/episode-0-2-4-facebook-open-source-projects-tornado-hip)

在一些 .NET 播客上有一些 IronPython 相关的节目：

*   [http://www.hanselminutes.com/default.aspx?showID=177](http://www.hanselminutes.com/default.aspx?showID=177)
*   [http://www.dotnetrocks.com/default.aspx?showNum=429](http://www.dotnetrocks.com/default.aspx?showNum=429)
*   [http://www.craigmurphy.com/blog/?p=708](http://www.craigmurphy.com/blog/?p=708)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-29T03:50:55.207

*   blip.tv 上提供了一些 Pycon[演讲](http://blip.tv/search?q=pycon)
*   Pycon 播客可[在此处获得](http://advocacy.python.org/podcasts/pycon.rss)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-26T21:16:24.393

[thisweekindjango](http://thisweekindjango.com/)

# apache-flex - Flex 缓慢的第一个 Http 请求

> ID：791619
> 
> 赞同：0
> 
> 时间：2009-04-26T21:15:07.250
> 
> 标签：apache-flex, actionscript-3, web-services, httpwebrequest

当我使用 loader.load(request); 第一次，我的 flex 在发布数据之前冻结了 10 秒（我可以实时看到 Web 服务器的结果）。但是，如果使用其他数据但相同的 request.url 重做类似的 POST，它是瞬时的。

```
// Multi form encoded data
variables = new URLVariables();
variables.user = "aaa";
variables.boardjpg = new URLFileVariable(data.boardBytes, "foo.jpg");
request = new URLRequestBuilder(variables).build();
request.url = "http://localhost:8000/upload/";

loader.load(request); 
```

我怎么能看到什么需要这么长时间？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-11T10:57:23.347

好的，这是一个老问题，无论如何我发现它搜索其他东西如此快速添加此 URLFileVariables 或 URLRequestBuilder 是 AS3 中的核心类，所以我猜你正在使用一些自定义库来构建你的请求。我不知道你用的是哪个库，但似乎目的是为了序列化一些二进制数据来构建一个 POST。序列化通常在第一次需要一些时间（查找初始化等），然后会更快，一个众所周知的例子是他不同风格的 Remoting

# .net - 使用免费服务易于实施用于地理编码的 .net 库？

> ID：791620
> 
> 赞同：6
> 
> 时间：2009-04-26T21:15:59.930
> 
> 标签：.net, geocoding

我需要使用.Net 对地址进行地理编码（从地址获取纬度/经度），以存储在数据库中。

要研究什么库/项目来完成它？

在这里搜索后，在 google 和[codeplex.com](http://www.codeplex.com/site/search?projectSearchText=GeoCoding "codeplex.com")上，我发现有一些选项，似乎他们会按照我的要求做......但其中一些可能是废话和浪费时间 - 还有一些可能只是恒星。

去哪一个？你用过它们中的任何一个吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-04-14T03:00:27.180

查看[GeoCoding.Net](https://github.com/chadly/Geocoding.net) - 适用于 Google、Yahoo 和 Bing 的通用地理编码 API

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T22:49:55.027

使用 Google Maps API 或 Microsoft MapPoint API 这很容易做到。这在很大程度上取决于您的使用要求，即您计划持续进行多少地理编码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T22:21:58.510

我们使用[geoNames](http://www.geonames.org/export/web-services.html)来满足我们的地理编码需求。只需连接，发送您的查询，它就会返回 XML 或 JSON（在某些情况下）。 [这是一篇](http://www.codeproject.com/KB/WCF/GeoNames-WCFClient.aspx)关于如何将其与 WCF 连接起来的文章。

# ruby-on-rails - 将 :attr_accessible 与基于角色的授权一起使用

> ID：791626
> 
> 赞同：2
> 
> 时间：2009-04-26T21:20:05.680
> 
> 标签：ruby-on-rails, security, security-roles

在我的在线商店中，允许用户更改其订单的某些属性（例如，他们的帐单地址），但不能更改其他属性（例如，发起 IP 地址）。另一方面，管理员可以修改*所有*订单属性。

鉴于此，我如何使用它`:attr_accessible`来正确保护我的 Order 模型？或者我是否必须使用它来标记管理员可以修改的所有属性，以及`Order.update_attributes(params[:order])`在普通用户可以访问的控制器操作中避免使用的所有属性？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T08:55:16.333

一般来说， attr_accessible 不是您要寻找的工具，而且 Rails 没有内置任何您想要的东西。

如果您想对谁可以更新模型中的特定属性进行细粒度控制，您可以执行以下操作：

```
class Order < ActiveRecord::Base
  def update_attributes_as_user(values, user)
    values.each do |attribute, value|
      # Update the attribute if the user is allowed to
      @order.send("#{attribute}=", value) if user.can_modify?(attribute)
    end
    save
  end
end 
```

然后您可以更改您的`Order.update_attributes(params[:order])`to`Order.update_attributes_as_user(params[:order], current_user)`并假设您实现了`User#can_modify?`在正确情况下返回 true 的方法，它应该可以工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-08-26T15:39:43.957

我有同样的问题，现在我正在使用这个 gem [http://github.com/dmitry/attr_accessible_block](http://github.com/dmitry/attr_accessible_block)

它很容易在一些生产网站中使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T21:46:43.307

是的，您必须修改操作，因此在操作内检查权限。`Order#update_attributes`普通用户无法拨打电话。

我不记得一个基于角色的授权插件，它允许你正在寻找的东西。这是因为这些插件混合到控制器而不是模型中。他们还需要混入`ActiveRecord::Base`以检查`attr_accesible`等。

# iphone - 具有多列的 UITableView 的多列标题

> ID：791628
> 
> 赞同：4
> 
> 时间：2009-04-26T21:20:53.383
> 
> 标签：iphone, cocoa-touch, uitableview

我创建了一个包含多个列的 UITableView 来显示足球联赛表。现在我真正需要的是一个标题来标记每一列，理想情况下它会位于表格视图的顶部。我该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T12:30:34.163

与其将其设置为第一`UITableView`部分的标题，不如在您的情况下将其设置为整个表格的标题更有意义。这可以通过 的[`tableHeaderView`](http://developer.apple.com/iPhone/library/documentation/UIKit/Reference/UITableView_Class/Reference/Reference.html#//apple_ref/occ/instp/UITableView/tableHeaderView)属性来完成`UITableView`。例如：

```
UIView *myHeaderView = ...
[myTableView setTableHeaderView:myHeaderView]; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-27T06:50:21.737

您可以创建一个自定义 UIView 并将其设置为 UITableView 的第一节标题。在你的 UITableViewDelegate 的 tableView:viewForHeaderInSection: 方法中返回它。您只需对其进行设计，使其与自定义单元格内的“列”对齐。

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2009-04-27T00:32:42.097

对于 iPhone 应用程序来说，这是一个奇怪的界面，假设您正在尝试复制 HTML 表格的外观和感觉，包括标题、单元格等。

如果这是您想要的，为什么不使用一个`UIWebView`对象来显示您的表格呢？

# c# - 将文件流式传输到字节并返回的正确术语

> ID：791635
> 
> 赞同：0
> 
> 时间：2009-04-26T21:24:57.960
> 
> 标签：c#, file, streaming, naming

我有以下方法：

```
 public static byte[] ConvertFileToBytes(string filePath)
    {
        var fInfo = new FileInfo(filePath);
        var numBytes = fInfo.Length;
        var dLen = Convert.ToDouble(fInfo.Length / 1000000);

        var fStream = new FileStream(filePath, FileMode.Open, FileAccess.Read);
        var br = new BinaryReader(fStream);

        var data = br.ReadBytes((int)numBytes);
        br.Close();

        fStream.Close();
        fStream.Dispose();

        return data;
    }

    public static void ConvertBytesToFile(byte[] file, string filePath)
    {
        var ms = new MemoryStream(file);

        var fs = new FileStream(filePath, FileMode.Create);

        ms.WriteTo(fs);

        ms.Close();
        fs.Close();
        fs.Dispose();
    } 
```

**这些方法的正确名称是什么？**（因为将*XXX*转换为*YYY*只是不会在实用程序库中剪切它）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-26T21:28:23.910

[File.ReadAllBytes](http://msdn.microsoft.com/en-us/library/system.io.file.readallbytes.aspx)和[File.WriteAllBytes](http://msdn.microsoft.com/en-us/library/system.io.file.writeallbytes.aspx)怎么样;)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T21:29:55.063

通常使用的术语是“序列化”和“反序列化”（或有时“编组”和“解组”）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T00:12:43.690

WriteAllBytes 和 ReadAllBytes 是一个很好的建议，但要回答您的问题...

Save() 将是重命名 ConvertToFile() 和 Object.CreateFromFile() 的一个不错的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T21:30:07.340

Marshalling/Unmarshalling 可能是合适的术语。

[http://en.wikipedia.org/wiki/Marshalling_(computer_science)](http://en.wikipedia.org/wiki/Marshalling_(computer_science))

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-26T21:31:38.367

在 C++ 中，它们被称为读写。

# c++ - 未定义符号：_sf_open（OSX 上的简单音频内容）

> ID：791636
> 
> 赞同：2
> 
> 时间：2009-04-26T21:26:03.590
> 
> 标签：c++, linker, libsndfile

我正在尝试进入 C++ 编程领域，但我对这些小细节非常挣扎。现在，我正试图让下面的代码片段工作，显然它会编译，但不会链接。（错误信息是这篇文章的底部）

我`libsndfile`用来打开音频文件，链接器似乎没有找到它的正确库文件。这是在 OS X 10.5 上。

我已经从 mega-nerd.com 下载了 libsndfile 并通过 ususal `configure`、 `make`、`sudo make install`过程安装了它。还有什么我需要做的吗？

编辑：如果有任何问题，我的系统上安装了 macports。

这是我的代码：

```
#include <iostream>
#include <string>
#include <sndfile.h>
#include "stereoSplit.h"
using namespace std;

int stereoSplit(string filename)
{
    cout << filename;
    SF_INFO sfinfo;
    sfinfo.format = 0;
    SNDFILE * soundfile;
    soundfile = sf_open( filename.c_str(), SFM_READ, &sfinfo );
    return 0;
}

int main (int argc, char const *argv[])
{
    return stereoSplit("testStereo.wav");
} 
```

这是完整的错误消息：

```
Undefined symbols:
  "_sf_open", referenced from:
      stereoSplit(std::basic_string<char, std::char_traits<char>, std::allocator<char> >)in cc3hvkkk.o
ld: symbol(s) not found
collect2: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T21:37:40.597

您需要在库中链接。您的编译器命令应类似于：

```
g++ mystuff.cpp -lsndfile 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-07-23T00:47:46.723

要在 Xcode 中链接库，请选择项目目标，将新项目添加到 Link binary with libraries，然后在您的计算机上找到 libsndfile.1.dynlib。

# c - C 语言：#DEFINed 值弄乱了 8 位乘法。为什么？

> ID：791638
> 
> 赞同：6
> 
> 时间：2009-04-26T21:27:05.473
> 
> 标签：c, embedded, overflow, multiplication, msp430

我有以下 C 代码：

```
#define PRR_SCALE 255
...
uint8_t a = 3;
uint8_t b = 4;
uint8_t prr;
prr = (PRR_SCALE * a) / b;
printf("prr: %u\n", prr); 
```

如果我编译它（使用 msp430 平台编译器，对于名为[contiki](http://www.sics.se/contiki/)的小型嵌入式操作系统），结果为 0，而我预期为 191。（uint8_t 被 typedef 为无符号字符）

如果我将其更改为：

```
uint8_t a = 3;
uint8_t b = 4;
uint8_t c = 255;
uint8_t prr;
prr = (c * a) / b;
printf("prr: %u\n", prr); 
```

它运行正常并打印 191。

在 Ubuntu 机器上使用 gcc 编译这个“通常”的简单版本会在两种情况下打印正确的值。

我不确定这是为什么。我可以通过预先将 DEFINed 值分配给变量来规避它，但我宁愿不这样做。

有人知道这是为什么吗？也许有一个链接到有关此的更多信息？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-26T22:03:08.633

简短的回答：你的编译器有问题。（正如其他人所建议的那样，溢出没有问题。）

在这两种情况下，算术都是在 中完成的`int`，保证至少有 16 位长。在前一个片段中是因为`255`是一个`int`，在后者中是因为[积分提升](http://www.google.com/search?q=integral+promotion)。

正如您所指出的，gcc 可以正确处理此问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T21:33:15.320

255 被处理为整数文字，并导致整个表达式基于 int 而不是基于 unsigned char。第二种情况强制类型正确。尝试更改您的#define，如下所示：

```
 #define PRR_SCALE ((uint8_t) 255) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T11:47:36.653

如果有问题的编译器是 mspgcc，它应该将已编译程序的汇编程序列表与二进制/十六进制文件一起列出。其他编译器可能需要额外的编译器标志来执行此操作。或者甚至可能在二进制文件上运行一个单独的反汇编程序。

这是寻找解释的地方。由于编译器优化，呈现给处理器的实际代码可能与原始 C 代码没有太多相似之处（但通常做相同的工作）。

单步执行代表错误代码的几条汇编指令应该可以揭示问题的原因。

我的猜测是编译器以某种方式优化了整个计算，因为定义的常量在编译时是已知的部分。255*x 可以优化为 x<<8-x （更快更小）也许优化的汇编代码出了点问题。

我花时间在我的系统上编译这两个版本。通过主动优化，mspgcc 生成以下代码：

```
#define PRR_SCALE 255
uint8_t a = 3;
uint8_t b = 4;
uint8_t prr;
prr = (PRR_SCALE * a) / b;
    40ce:   3c 40 fd ff     mov #-3,    r12 ;#0xfffd
    40d2:   2a 42           mov #4, r10 ;r2 As==10
    40d4:   b0 12 fa 6f     call    __divmodhi4 ;#0x6ffa
    40d8:   0f 4c           mov r12,    r15 ;
printf("prr: %u\n", prr);
    40da:   7f f3           and.b   #-1,    r15 ;r3 As==11
    40dc:   0f 12           push    r15     ;
    40de:   30 12 c0 40     push    #16576      ;#0x40c0
    40e2:   b0 12 9c 67     call    printf      ;#0x679c
    40e6:   21 52           add #4, r1  ;r2 As==10 
```

我们可以看到，编译器直接将255*3的结果计算为-3（0xfffd）。这就是问题所在。不知何故，255 被解释为 -1 有符号 8 位而不是 255 无符号 16 位。或者先解析为 8 位，然后符号扩展为 16 位。管他呢。

已经在 mspgcc 邮件列表中开始了有关此主题的讨论。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T21:48:16.780

我不确定为什么定义不起作用，但您可能会遇到`uint8_t`变量的翻转。255 是 的最大值`uint8_t (2^8 - 1)`，因此如果将其乘以 3，则必然会遇到一些微妙的翻转问题。

编译器可能正在优化您的代码，并预先计算您的数学表达式的结果并将结果推送到 prr 中（因为它适合，即使中间值不适合）。

检查如果你像这样分解你的表达式会发生什么（这不会像你想要的那样）：

```
prr = c * a; // rollover!
prr = prr / b; 
```

您可能只需要使用更大的数据类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T07:15:46.353

在 case-1 中我能想到的一个区别是，

PRR_SCALE 文字值可以进入 ROM 或代码区域。MUL 操作码可能存在一些差异，例如，

```
case-1: [register], [rom]
case -2: [register], [register] 
```

这可能根本没有意义。

# internet-explorer - 检查 IE8 中的 http 响应标头

> ID：791642
> 
> 赞同：54
> 
> 时间：2009-04-26T21:30:22.470
> 
> 标签：internet-explorer, http, http-headers, ie-developer-tools

我正在寻找一个 ie8 插件，它可以显示像 firebug 或 httpliveheaders 这样的 http 标头。任何建议表示赞赏。

编辑：我可能是盲人，但*似乎*内置的开发人员工具（F12）*没有*显示 http 标头。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-04-26T22:28:37.167

您可能正在寻找[Fiddler2](http://www.fiddler2.com/fiddler2/)

> Fiddler 是一个 Web 调试代理，它记录您的计算机和 Internet 之间的所有 HTTP(S) 流量。Fiddler 允许您检查所有 HTTP(S) 流量、设置断点以及“摆弄”传入或传出数据。Fiddler 包括一个强大的基于事件的脚本子系统，并且可以使用任何 .NET 语言进行扩展。
> 
> Fiddler 是免费软件，可以调试几乎任何应用程序的流量，包括 Internet Explorer、Mozilla Firefox、Opera 等等。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-04-28T14:41:46.847

如果您想在 IE 中查看 HTTP 标头，我建议使用[DebugBar](http://www.my-debugbar.com/wiki/Doc/DebugbarInstall)。
我已经用 IE8 对其进行了测试，并且没有任何问题。它还有一些其他有用的功能，例如验证 HTML 或查看 cookie。

但是，我发现此工具存在两个问题：

*   个人使用是免费的，否则需要付费。
*   dynaTrace 与 DebugBar 存在一些兼容性问题。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-06-12T16:43:32.397

不是一个完整的答案，而是朝着正确方向迈出的一步：

在[http://blogs.msdn.com/b/ie/archive/2010/04/22/ie9-developer-tools-network-tab.aspx](http://blogs.msdn.com/b/ie/archive/2010/04/22/ie9-developer-tools-network-tab.aspx)它说：

> [IE9] 开发人员工具包括一些新功能和对 IE8 工具的改进：
> 
> ```
> A new tab for inspecting network traffic. 
> ```

因此在 IE8 开发者工具中检查网络流量是不可能的。您需要安装其他东西。有关最终解决方案，请参阅其他答案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-06-20T15:38:33.873

跳过 IE，使用[`curl`](http://curl.haxx.se/docs/manpage.html "男人卷曲").

此命令将输出 google.com 的标头，就好像 IE8 请求它们一样：

```
curl -s -A="Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)" -D - -o /dev/null http://www.google.com 
```

使用的选项如下：

*   `-s`静音模式，所以它不显示进度表。
*   `-A=...`指定[您要使用的用户代理](http://www.useragentstring.com/pages/Internet%20Explorer/ "一些例子")（示例是 XP 上的 IE8）。
*   `-D -`转储标头，破折号指定`STDOUT`.
*   `-o /dev/null`重定向响应的正文，因此您看不到 html。
*   最后，您要测试的 url。

您应该看到如下内容：

```
HTTP/1.1 200 OK
Date: Thu, 20 Jun 2013 15:35:22 GMT
Expires: -1
Cache-Control: private, max-age=0
... 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-10T17:20:28.220

由于 IE 8 中没有为此内置任何东西，因此另一种方法是为 Windows 找到 wget 的独立副本 - 例如[http://users.ugent.be/~bpuype/wget/](http://users.ugent.be/~bpuype/wget/)。

`wget -S <url>`将显示标题（并留下一个 html 文件，您可以进一步查看或删除该文件）。这似乎比 Fiddler2 方法更轻量级。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-22T09:54:56.920

[Proxomitron](http://www.proxomitron.info/)（不需要管理员权限）和[Proximodo](http://proximodo.sourceforge.net/)（更现代的克隆，但需要管理员权限才能安装）是充当浏览器和 Internet 之间的代理的独立软件，它们允许您检查和修改所有标题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-27T17:18:43.247

IE 11 的 F12 工具中的网络选项卡实际上包括标题信息。您必须查看详细信息。根本不需要使用任何 3rd 方工具。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-10-28T01:24:05.827

1.  `F12`在 IE 中按
2.  转到网络选项卡-> 详细信息。

您将看到 HTTP 标头信息

* * *

## 回答 #9

> 赞同：-18
> 
> 时间：2009-04-26T21:33:30.343

IE8 自带开发工具， http: [//msdn.microsoft.com/en-us/library/dd565628 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/dd565628(VS.85).aspx)

# apache-flex - 样式化 UITextField

> ID：791645
> 
> 赞同：1
> 
> 时间：2009-04-26T21:32:24.137
> 
> 标签：apache-flex, actionscript-3

我一直在尝试在运行时确定“标签”宽度的不同方法，以便我可以调整“标签”的大小，因为我不希望它被截断。我终于通过*UITextField*找到了一个简单的解决方案，它允许我设置*.autoSize*这很棒！但是，现在我正在尝试*UITextField*的“样式”（简单地调整字体和字体大小），但似乎我必须使用“ *.htmlText* ”手动完成（如果这是唯一的方法，我会很乐意接受） ）。

我正在使用*.text*来设置标签的值。

我的测试用例涉及一个*HBox*（我实际上使用的是 Grid 但它们应该是相同的，并且我已经对两者进行了测试）：

1.  我为*HBox*设置样式，并将样式传递到*UITextField*。我不相信这对我有用，因为我内部还有其他组件需要以不同的方式设置样式。
2.  我试过：*UITextFormat*和*TextFormat*（我看到*.htmlText 相应*地更新，但输出没有更新。然后我注意到每当我调用*hbox.addChild(myUITextField)*它都会覆盖*.htmlText*
3.  我已经尝试在调用*addChild之前和/或之后使用**myUITextField.setStyle("fontSize", 20)*设置样式，根据我上面提到的，这两者都没有对显示产生影响。

 *正在进行更改，但是当我将其添加到显示时，它们似乎被覆盖了。

***那么除了手动设置 UITextField 以及我在.htmlText*中的内容之外，我还需要做些什么来设置 UITextField 的样式？** 只要有一些不截断文本的简单方法，不使用 UITextField 的解决方案就可以了。

编辑：我只想做 textField.setStyle('fontSize', 20) 并期望每次我更改文本时，我都不需要使用 HTML 来配合它（所以我可以做 textField.text = '别的东西'，并期望它的字体大小仍然为 20）。这就是我不使用*.htmlText*的意思（对不起，如果我之前不清楚）。

**第二次编辑**：我想我应该提出整个问题，也许这会澄清我做错了什么或无法实现。

我的意图是有一个*网格*并在其中添加文本。我不希望它换行或滚动，因此当当前行的子项总宽度超过某个数字时，我将其添加到*Grid中的下一行。*为了将它添加到下一行，我需要能够计算文本的宽度。我希望能够根据案例单独设置该文本的样式，并且可能还有其他组件（例如*TextInput*）。基本上我想要完成的是“填空”。

我已经包含了代码来显示我目前正在做的事情，并且它有点工作。它可能与最初的样式问题无关，但我不知道如何调整每个 UITextField 之间的距离，但除此之外，这符合我想要完成的目标。与问题相关的是：我想将每个*UITextField*（当前设置*.htmlText*）的样式更改为有点简单的方式，尽管就像我之前提到的那样，如果这是唯一的解决方案，我很乐意接受使用*.htmlText 。*

所以我有一个带有 x 行的网格，在每一行中，我只有一个 GridItem。根据输入，我将 UITextField 和 TextInput 添加到 GridItem 中，必要时继续下一个 GridItem。如果你有更好的方法，那就更好了，但我想我真正想要的是找到一种不同的造型方式。

还有**另一个问题**，我不确定将 TextField 添加到显示中的确切方法。我试过：

```
var t : TextField = new TextField();
t.text = "I'm a TextField";
hBox.addChild(t);   // doesn't work
//this.addChild(t); // doesn't work either 
```

但我收到以下错误：

TypeError：错误 #1034：类型强制失败：无法将 flash.text::TextField@172c8f9 转换为 mx.core.IUIComponent。

这就是我所拥有的。

```
private function styleQuestionString(str : String) : String {
  return '<FONT leading="1" face="verdana" size="20">' + str + '</FONT>';
}

private function loadQuestion(str : String) : void {
  /* Split the string */
  var tmp : Array = str.split("_");

  /* Track the current width of the GridItem */
  var curWidth : int = 0;

  /* Display components that we will add */
  var txtField : UITextField = null;
  var txtInput : TextInput = null;

  /* Track the current GridItem */
  var curGridItem : GridItem = null;

  /* Track the GridItem we can use */
  var gridItemAC : ArrayCollection = new ArrayCollection();

  var i : int = 0;

  /* Grab the first GridItem from each GridRow of Grid */
  var tmpChildArray : Array = questionGrid.getChildren();
  for (i = 0; i < tmpChildArray.length; i++) {
    gridItemAC.addItem((tmpChildArray[i] as GridRow).getChildAt(0));
  }
  curGridItem = gridItemAC[0];
  gridItemAC.removeItemAt(0);

  /* Used to set the tab index of the TextInput */
  var txtInputCounter : int = 1;

  var txtFieldFormat : UITextFormat = new UITextFormat(this.systemManager);
  txtFieldFormat.leading = "1";

  //var txtFieldFormat : TextFormat = new TextFormat();
  //txtFieldFormat.size = 20;

  /* Proper Order
    txtField = new UITextField();
    txtField.text = tmp[curItem];
    txtField.autoSize = TextFieldAutoSize.LEFT;
    txtField.setTextFormat(txtFieldFormat);
  */

  var txtLineMetrics : TextLineMetrics = null;
  var tmpArray : Array = null;

  curGridItem.setStyle("leading", "1");

  var displayObj : DisplayObject = null;

  for (var curItem : int= 0; curItem < tmp.length; curItem++) {
    /* Using UITextField because it can be auto-sized! */

    /** CORRECT BLOCK (ver 1)
    txtField = new UITextField();
    txtField.text = tmp[curItem];
    txtField.autoSize = TextFieldAutoSize.LEFT;
    txtField.setTextFormat(txtFieldFormat);
    ***/

    tmpArray = (tmp[curItem] as String).split(" ");

    for (i = 0; i < tmpArray.length; i++) {
      if (tmpArray[i] as String != "") {
        txtField = new UITextField();
        txtField.htmlText = styleQuestionString(tmpArray[i] as String);
        //txtField.setTextFormat(txtFieldFormat); // No impact on output
        txtLineMetrics = curGridItem.measureHTMLText(txtField.htmlText);
        curWidth += txtLineMetrics.width + 2;

        if (curWidth >= 670) {
          curGridItem = gridItemAC[0];
          curGridItem.setStyle("leading", "1");
          if (gridItemAC.length != 1) {
            gridItemAC.removeItemAt(0);
          }
          // TODO Configure the proper gap distance
          curWidth = txtLineMetrics.width + 2;
        }
        displayObj = curGridItem.addChild(txtField);
      }
    }

    //txtField.setColor(0xFF0000);  // WORKS

    if (curItem != tmp.length - 1) {
      txtInput = new TextInput();
      txtInput.tabIndex = txtInputCounter;
      txtInput.setStyle("fontSize", 12);
      txtInputCounter++;
      txtInput.setStyle("textAlign", "center");
      txtInput.width = TEXT_INPUT_WIDTH;
      curWidth += TEXT_INPUT_WIDTH;

      if (curWidth >= 670) {
        curGridItem = gridItemAC[0];
        if (gridItemAC.length != 1) {
          gridItemAC.removeItemAt(0);
        }
        // TODO Decide if we need to add a buffer
        curWidth = TEXT_INPUT_WIDTH + 2;
      }
      curGridItem.addChild(txtInput);
      txtInputAC.addItem(txtInput);

      /* Adds event listener so that we can perform dragging into the TextInput */
      txtInput.addEventListener(DragEvent.DRAG_ENTER, dragEnterHandler);
      txtInput.addEventListener(DragEvent.DRAG_DROP, dragDropHandler);
      txtInput.addEventListener(DragEvent.DRAG_EXIT, dragExitHandler);
    }

    /* Add event so that this label can be dragged */
    //txtField.addEventListener(MouseEvent.MOUSE_MOVE, dragThisLabel(event, txtField.text));
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-03T23:23:54.733

经过大约 8 小时的寻找解决方案来解决看似如此简单的问题后，我终于在这里偶然发现了您的帖子……谢谢！

我一直在试图让 TextField 工作并且没有喜悦，标签很好，但格式有限，我需要能够使用嵌入字体和旋转。阅读以上内容后，这终于对我有用：

```
var myFormat:TextFormat = new TextFormat();
myFormat.align = "center";
myFormat.font = "myFont";
myFormat.size = 14;
myFormat.color = 0xFFFFFF;

var newTxt:UITextField = new UITextField();
newTxt.text = "HELLO";
addChild(newTxt);
newTxt.validateNow();
newTxt.setTextFormat(myFormat); 
```

最后两个步骤之前的 addChild 顺序至关重要！（myFont 是我正在使用的嵌入式字体）。

再一次……一千谢谢你的……

约翰

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T23:06:08.903

根据提问者的反馈进行编辑：我没有意识到您只想将一种样式应用于整个文本字段，我以为您想为各个部分设置样式。这对您来说更简单，根本不会给您带来任何麻烦:)

```
 var textFormat: TextFormat = new TextFormat("Arial", 12, 0xFF0000);
myText.setTextFormat(textFormat); 
```

请注意，这会将样式设置为 TextField 中的文本，不一定是您输入的未来文本。因此，在调用 setTextFormat 之前将文本放在字段中，并在每次更改时再次设置以确保它停留。

最好使用普通的 TextField 而不是组件。如果您仍然想要该组件，您可能需要调用 textArea.validateNow() 以使其更新为新样式（尽管不是 100% 确定该样式）Adobe 组件是出了名的糟糕，应该避免使用。:(

要查看 TextFormat 对象上的所有可用选项，请参见[此处](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/text/TextFormat.html)

结束编辑 ---------

这很容易在一个普通的旧 TextField 中使用 CSS。

```
 var myCSS: String = "Have some CSS here, probably from a loaded file";
var myHTML: String = "Have your HTML text here, and have it use the CSS styles";

// assuming your textfield's name is myText
var styleSheet: StyleSheet = new StyleSheet();
styleSheet.parseCSS(myCSS);
myText.autoSize = TextFieldAutoSize.LEFT;
myText.styleSheet = styleSheet;
myText.htmlText = myHTML; 
```

支持的 HTML 标签可以在[这里](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/text/TextField.html#htmlText)
找到支持的 CSS 可以在[这里找到](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/text/StyleSheet.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-22T21:46:45.383

将 Textfield 添加到容器时遇到问题的原因是它没有实现 IUIComponent 接口。如果要添加它，则需要使用 UITextField。然而，这给我带来了我自己的造型问题，让我想到了这个问题。

我知道的几件事：

1.  TextField 使用 TextFormat 定义设置样式，并将其应用于文本字段。正如布莱恩所说，秩序很重要。

2.  setStyle 对 IUITextField 没有任何作用，并且 TextFormat 方法似乎与普通 TextField 中的工作方式不同。（编辑＃2：啊哈。您需要覆盖 UITextFields 上的“validateNow”函数才能使用 setTextFormat 函数）

3.  要自动调整 TextArea，您需要执行以下操作（从 TextArea 继承）：

`import mx.core.mx_internal; use namespace mx_internal; ... super.mx_internal::getTextField().autoSize = TextFieldAutoSize.LEFT; this.height = super.mx_internal::getTextField().height;`

我想，不久前在 StackOverflow 上找到了这段代码。向原作者道歉。但想法是您需要访问“mx_internal”原始文本字段。

4.  Text 和 TextArea 有环绕选项。（标签没有）。因此，如果您设置 Text 对象的显式宽度，则可以使用 measureHeight 选项调整大小并避免截断。

（编辑：那是＃4，但stackoverflow将其解析为1 ...）

# c# - System.Net.WebClient 奇怪地失败了

> ID：791658
> 
> 赞同：12
> 
> 时间：2009-04-26T21:41:09.917
> 
> 标签：c#, webclient, system.net

我正在尝试从 TFS 服务器上的报告服务实例下载一些数据。
鉴于代码应该在未加入域的计算机上运行，​​我想我会自己设置凭据。不走运，得到了 HTTP 401 Unauthorized 回复。好的，所以我连接了 Fiddler 看看发生了什么。

但那是当我得到[海森堡](http://en.wikipedia.org/wiki/Uncertainty_principle)的时候——电话现在顺利通过了。因此，身份验证在 Fiddler 连接的情况下通过，但在没有它的情况下失败。Webclient 是坏了还是我在这里错过了一些深刻的东西？

```
private void ThisWorksWhenDomainJoined()
    {
        WebClient wc = new WebClient();
        wc.Credentials = CredentialCache.DefaultNetworkCredentials;
        wc.DownloadString("http://teamfoundationserver/reports/........");  //Works
    }

    private void ThisDoesntWork()
    {
        WebClient wc = new WebClient();
        wc.Credentials = new NetworkCredential("username", "password", "domain");
        wc.DownloadString("http://teamfoundationserver/reports/........");  //blows up wih HTTP 401
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-29T10:42:22.223

看看这个链接：
[HTTP Authorization and .NET WebRequest, WebClient Classes](http://www.hashemian.com/blog/2007/06/http-authorization-and-net-webrequest.htm)

我和你有同样的问题。我只添加了一行，它开始工作了。试试这个

```
private void ThisDoesntWork()
    {
        WebClient wc = new WebClient();
        wc.Credentials = new NetworkCredential("username", "password", "domain");
        //After adding the headers it started to work !
        wc.Headers.Add(HttpRequestHeader.UserAgent, "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)");
        wc.DownloadString("http://teamfoundationserver/reports/........");  //blows up wih HTTP 401
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T16:15:49.780

试试这个 ...

```
var credCache = new CredentialCache();
credCache.Add(new Uri("http://teamfoundationserver/reports/........""),
                      "Basic", 
                      new NetworkCredential("username", "password", "DOMAIN"));
wc.Credentials = credCache; 
```

如果这不起作用，请尝试将“基本”替换为“协商”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T16:07:58.597

当你使用它时会发生什么？

```
wc.Credentials = CredentialCache.DefaultCredentials; 
```

另外，您确定您拥有正确的用户名、密码和域吗？

另外：我想知道当 .net 破坏它们或类似的东西时，Fiddler 是否会改变一些 unicode 字符。如果您的用户/通行证/域具有 unicode，请尝试将其转义，`"\u2638"`而不是`"☺"`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-08T19:19:50.100

我能够通过使用 CredentialCache 对象来解决此错误，如下所示：

```
WebClient wc = new WebClient();
CredentialCache credCache = new CredentialCache();
credCache.Add(new Uri("http://mydomain.com/"), "Basic",
new NetworkCredential("username", "password"));

wc.Credentials = credCache;

wc.DownloadString(queryString)); 
```

# css - CSS 定位和显示顺序

> ID：791660
> 
> 赞同：2
> 
> 时间：2009-04-26T21:43:17.963
> 
> 标签：css

我有一个 HTML 块：

```
<ul>
  <li>a</li>
  <li>b</li>
  <li class="nav">c</li>
  <li class="nav">d</li>
</ul> 
```

和一个 CSS 规则集：

```
ul li {
 display: inline;
}

li.nav {
 float: right;
} 
```

这不符合我的意图：我希望它像这样显示：

```
ab                                      cd 
```

但相反的是

```
ab                                      dc 
```

不同之处在于元素的显示顺序。如何按句法顺序显示“nav”类的列表项？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T21:51:59.580

好吧，显而易见的快速解决方法是颠倒列表中元素的顺序：

```
<ul>
  <li>a</li>
  <li>b</li>
  <li class="nav">d</li>
  <li class="nav">c</li>
</ul> 
```

我猜会发生什么，每当渲染引擎遇到一个元素时，`float:right`它都会将该元素尽可能向右推。所以它首先遇到“c”并将其一直推到右侧，然后遇到“d”并将其推到尽可能远的位置——但“c”已经占据了最右边的位置，所以“d” "停留在它的左边。本质上，元素是按从右到左的顺序而不是从左到右的顺序排列的。

我认为，另一种选择是将元素分成两个列表，然后将`float: right`样式作为一个整体应用于第二个列表（即`<ul>`元素）。

```
<ul>
  <li>a</li>
  <li>b</li>
</ul>
<ul class="nav">
  <li>c</li>
  <li>d</li>
</ul> 
```

和

```
ul li {
 display: inline;
}

ul.nav {
 float: right;
} 
```

这样列表本身会浮动到右边距，但其中元素的顺序不会颠倒。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T14:17:54.537

我通过将列表分成两部分并将`float`它们放到各自的位置来解决这个问题。我用 a 包裹了两个列表`div`并应用于[`overflow: auto`](http://www.quirksmode.org/css/clearing.html)它。我最终的 CSS 代码如下所示：

```
ul li {
 display: inline
}

div.post-info-wrap {
 overflow: auto
}

ul.post-info {
 float: left
}

ul.nav {
 float: right
} 
```

我的标记如下：

```
<div class="post-info-wrap">
  <ul class="post-info">
    <li/>
  </ul>
  <ul class="nav">
    <li/>
  </ul>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T21:51:17.617

如果您希望 c & d 显示在右侧的块中，则必须将它们放在一个块元素中，而不是`float`在两者上设置属性。我不认为像这样的列表元素`<li>`是您意图的正确选择。您不想显示单个列表，因此您可以尝试使用两个列表（其中一个具有`float`属性）或仅使用简单`<div>`元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T21:56:58.303

所以实际上你想要一个导航列表和其他一些列表？为什么不使用 2 个列表？

```
<ul class="other">
  <li>a</li>
  <li>b</li>
 </ul>
<ul class="nav">
 <li>c</li>
 <li>d</li>
</ul> 
```

和CSS：

```
ul li {
display: inline;
}

.other{
float:left;
}

.nav {
float: right;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T18:51:44.340

浮动`ul`您希望内容/容器所在的位置，并按照您希望显示的顺序浮动 li。

```
<div id="myblock">
   <ul>
     <li>1</li>
     <li>2</li>
     <li>3</li>
   </ul>
</div> 
```

CSS

```
#myblock ul {
   display:inline;
   float:right;
}

#myblock li {
   float:left;
 } 
```

相反（向左浮动，但顺序相反）

```
#myblock ul {
   display:inline;
   float:left;
}

#myblock li {
   float:right;
 } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-26T22:06:48.110

试试这个：

```
 ul {
        text-align: right;
    } 
    ul li {
     display: inline;
    }

    ul li.default {
     float: left;
    }
    li.nav {
     float: auto;
    }

<ul>
  <li class="default">a</li>
  <li class="default">b</li>
  <li class="nav">c</li>
  <li class="nav">d</li>
</ul> 
```

# jsf - 将 kaptcha 与 JSF 一起使用

> ID：791661
> 
> 赞同：1
> 
> 时间：2009-04-26T21:43:30.520
> 
> 标签：jsf, captcha

我正在尝试使用[http://code.google.com/p/kaptcha/](http://code.google.com/p/kaptcha/)这看起来是一种包含 CAPTCHA 的非常简单的方法。我的演示应用程序是 JSF，虽然JSP[的说明很简单](http://code.google.com/p/kaptcha/wiki/HowToUse)，但我不知道如何在 JSF 中使用它们。我如何在 JSF 中翻译这个？

> 在管理提交操作的代码中：
> 
> `String kaptchaExpected = (String)request.getSession() .getAttribute(com.google.code.kaptcha.Constants.KAPTCHA_SESSION_KEY); String kaptchaReceived = request.getParameter("kaptcha");`
> 
> `if (kaptchaReceived == null || !kaptchaReceived.equalsIgnoreCase(kaptchaExpected)) { setError("kaptcha", "Invalid validation code."); }`

我试着把它放在我的：

```
public String button1_action() {
    // TODO: Process the action. 
    return "success";
} 
```

但它不理解请求对象:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T10:53:35.537

这个等效的 JSF 操作应该这样做：

```
 // bind to <h:inputText value="#{thisbean.kaptchaReceived}" />
  private String kaptchaReceived;

  public String getKaptchaReceived() {
    return kaptchaReceived;
  }

  public void setKaptchaReceived(String kaptcha) {
    kaptchaReceived = kaptcha;
  }

  public String button1_action() {
    if (kaptchaReceived != null) {
      FacesContext context = FacesContext
          .getCurrentInstance();
      ExternalContext ext = context.getExternalContext();
      Map<String, Object> session = ext.getSessionMap();
      String kaptchaExpected = session
          .get(com.google.code.kaptcha.Constants.KAPTCHA_SESSION_KEY);
      if (kaptchaReceived.equalsIgnoreCase(kaptchaExpected)) {
        return "success";
      }
    }
    return "problem";
  } 
```

这假定您想在 JSF 视图中使用[h:inputText](http://java.sun.com/javaee/javaserverfaces/1.2_MR1/docs/tlddocs/h/inputText.html)和[h:graphicImage](http://java.sun.com/javaee/javaserverfaces/1.2_MR1/docs/tlddocs/h/graphicImage.html)而不是 HTML 元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-12T05:30:24.530

实现验证器是验证 kaptcha 的另一种简单方法。

```
<h:inputText id="kaptcha" autocomplete="off" required="true">
     <f:validator validatorId="kaptchaValidator" />
</h:inputText>
<h:message for="kaptcha" styleClass="errorMessage"/> 
```

- - 验证器 - -

```
public class KaptchaValidator implements Validator {

@Override
public void validate(FacesContext facesContext, UIComponent uiComponent, Object value) throws ValidatorException {

HttpSession session = (HttpSession) facesContext.getExternalContext().getSession(true);

        String kaptchaExpected = (String) session.getAttribute(com.google.code.kaptcha.Constants.KAPTCHA_SESSION_KEY);

        String kaptchaReceived = (String) value;

        if (kaptchaReceived == null || !kaptchaReceived.equalsIgnoreCase(kaptchaExpected)) {
            FacesMessage message = new FacesMessage();

            message.setDetail("Invalid Security Code.");
            message.setSummary("Invalid security code.");
            message.setSeverity(FacesMessage.SEVERITY_INFO);

            throw new ValidatorException(message);
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T06:15:44.033

您可以使用以下代码从可从 FacesContext 访问的 JSF 外部上下文中检索请求对象：

```
HttpServletRequest request = (HttpServletRequest) FacesContext.getCurrentInstance().getExternalContext().getRequest(); 
```

* * *

**编辑**（感谢[麦克道尔](https://stackoverflow.com/users/304/mcdowell)）：

另一种方法是使用`FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap()`方法来访问请求参数...

# php - 在线指纹认证

> ID：791677
> 
> 赞同：3
> 
> 时间：2009-04-26T21:54:36.267
> 
> 标签：php, linux, verification, fingerprint

该公司有一个基于网络的打卡应用程序，但我的老板想让员工使用他们的指纹而不是共享密码来打卡。是否有任何可以使用的免费/开源/商业 SDK？使用基于 Java 或 ActiveX 的可嵌入组件？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T22:06:28.250

我发现的大多数工具都是商业产品。但希望他们能引导您朝着正确的方向前进。

*   [Griaule 指纹识别软件](http://www.griaulebiometrics.com/page/en-us/index)
*   [通用匹配系统软件开发套件](http://www.123id.us/products_developer_cvtsdk.html)
*   [OSS 生物铸造](http://www.biofoundry.com/products/biofoundryFreeTrial.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T22:25:09.610

您使用的是哪种指纹读取器？

1) Microsoft Fingerprint Reader（以前的 Digital Persona） 2) Eikon Reader 3) 其他？

一个简单的解决方案是利用任何一个随附的自动表单填写工具，并围绕密码是预定义的 64+ 字节长的随机数据块构建密码系统。保留您的基于 Web 的系统，但有一个非常简单的形式，不鼓励在客户端（通过 javascript）输入密码，并说明用户应该触摸指纹扫描仪来打卡/打卡。

如果可能的话，让每个员工通过注册系统设置他们的指纹自动登录，让他们看向别处，然后在他们不看的情况下私​​下输入密码。

当然，这很容易被精通技术的员工使用星号键（在 Windows 上）或 dom 浏览器/调试器等工具破解，但它应该提供最低级别的安全性，至少不会那么容易共享作为您当前的系统（我收集的是您的目标）。

此外，指纹并不能真正为确定的攻击提供任何类型的安全性。傻腻子、强力胶水和五分钟可以可靠地复制周围的任何印刷品。只要你接受这个问题，你就没事。

# c# - 在编写任何锁之前我应该 对多线程问题进行单元测试吗？

> ID：791682
> 
> 赞同：8
> 
> 时间：2009-04-26T21:58:05.277
> 
> 标签：c#, .net, multithreading, unit-testing, tdd

我正在编写一个我知道需要锁的类，因为该类必须是线程安全的。但由于我是测试驱动开发，我知道在为它创建测试之前我不能编写一行代码。而且我发现很难做到，因为测试最终会变得非常复杂。在这些情况下你通常会怎么做？有什么工具可以帮助解决这个问题吗？

这个问题是 .NET 特定的

有人问代码：

```
public class StackQueue
{
    private Stack<WebRequestInfo> stack = new Stack<WebRequestInfo>();
    private Queue<WebRequestInfo> queue = new Queue<WebRequestInfo>();

    public int Count
    {
        get
        {
            return this.queue.Count + this.stack.Count;
        }
    }

    public void Enqueue(WebRequestInfo requestInfo)
    {
        this.queue.Enqueue(requestInfo);
    }

    public void Push(WebRequestInfo requestInfo)
    {
        this.stack.Push(requestInfo);
    }

    private WebRequestInfo Next()
    {
        if (stack.Count > 0)
        {
            return stack.Pop();
        }
        else if (queue.Count > 0)
        {
            return queue.Dequeue();
        }
        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T22:08:28.840

好吧，您通常可以使用诸如`ManualResetEvent`在释放门之前让一些线程进入预期的问题状态......但这仅涵盖线程问题的一小部分。

对于线程错误的更大问题，有[CHESS](http://msdn.microsoft.com/en-us/devlabs/cc950526.aspx)（正在进行中） - 将来可能是一个选项。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-26T22:12:43.460

您不应该在单元测试中真正测试线程安全。您可能应该有一组单独的线程安全压力测试。

* * *

好的，现在您已经发布了代码：

```
public int Count
    {
        get
        {
            return this.queue.Count + this.stack.Count;
        }
    } 
```

这是一个很好的例子，说明你在编写单元测试时会遇到麻烦，这会暴露代码中的线程问题。此代码可能需要同步，因为 this.queue.Count 和 this.stack.Count 的值可能会在计算总数的过程中发生变化，因此它可能会返回一个不“正确”的值。

但是 - 考虑到类定义的其余部分，实际上没有什么依赖于 Count 给出一致的结果，那么它是否“错误”真的很重要吗？如果不知道程序中的其他类如何使用它，就无法知道这一点。这使得对线程问题的测试成为集成测试，而不是单元测试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-26T23:26:55.077

在编写多线程代码时，你必须比平时更多地使用你的大脑。您必须对每一行代码进行逻辑推理，无论它是否是线程安全的。这就像证明一个数学公式的正确性——你不能仅仅通过给出公式为真的 N 值的例子来证明“N + 1 > N for all N”之类的事情。类似地，通过编写试图暴露问题的测试用例来证明一个类是线程安全的也是不可能的。通过测试，只能证明有故障，但不能证明没有故障。

您能做的最好的事情就是尽量减少对多线程代码的需求。最好应用程序不应该有多线程代码（例如通过依赖线程安全库和合适的设计模式），或者它应该被限制在一个非常小的区域。您的`StackQueue`类看起来很简单，因此您只需稍加思考就可以使其安全地成为线程安全的。

假设`Stack`and`Queue`实现是线程安全的（我不知道 .NET 的库），您只需要使`Next()`线程安全。`Count`已经是线程安全的，因为没有客户端可以安全地使用从它返回的值而不使用基于客户端的锁定 -[方法之间的状态依赖关系](http://www.ibm.com/developerworks/java/library/j-jtp09263.html#2.2)否则会破坏代码。

`Next()`不是线程安全的，因为它在方法之间具有状态依赖关系。如果线程 T1 和 T2`stack.Count`同时调用并返回 1，则其中一个将获得 的值`stack.Pop()`，但另一个将`stack.Pop()`在堆栈为空时调用（然后出现 throw `InvalidOperationException`）。`Pop()`您将需要一个堆栈和队列，其中包含and的非阻塞版本`Dequeue()`（空时返回 null 的版本）。然后，当这样编写代码时，代码将是线程安全的：

```
private WebRequestInfo Next()
{
    WebRequestInfo next = stack.PopOrNull()
    if (next == null)
    {
        next = queue.DequeueOrNull();
    }
    return next;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-26T22:15:35.670

多线程会导致非常复杂的问题，几乎不可能为它们编写单元测试。您可能会设法编写一个在代码上执行时失败率为 100% 的单元测试，但在您通过后，代码中很可能仍然存在竞争条件和类似问题。

线程问题的问题在于它们随机出现。即使您通过了单元测试，也不一定意味着代码可以工作。所以在这种情况下，TDD 给人一种虚假的安全感，甚至可能被认为是一件坏事。

还值得记住的是，如果一个类是线程安全的，您可以在多个线程中毫无问题地使用它——但如果一个类不是线程安全的，它并不立即意味着您不能从多个线程中毫无问题地使用它。在实践中它仍然可以是线程安全的，但没有人只想对它不是线程安全的负责。如果它在实践中是线程安全的，那么就不可能编写由于多线程而失败的单元测试。（当然，大多数非线程安全的类确实不是线程安全的，并且会愉快地失败。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-26T22:15:41.940

TDD 是一种工具——而且是一个很好的工具——但有时您会遇到使用特定工具无法很好地解决的问题。我建议，如果开发测试过于复杂，您应该使用 TDD 来开发预期的功能，但也许依靠代码检查来确保您自己添加的锁定代码是适当的并且允许您的类成为线程-安全的。

一种可能的解决方案是开发将进入锁内部的代码并将其放入自己的方法中。然后你也许可以伪造这个方法来测试你的锁定代码。在您的假代码中，您可以简单地建立一个等待，以确保访问代码的第二个线程必须等待锁，直到第一个线程完成。在不确切知道您的代码做什么的情况下，我不能比这更具体。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-26T22:47:54.063

特别是对于多核系统，您通常可以测试线程问题，只是不确定性。

我通常这样做的方式是启动多个线程，这些线程会遍历相关代码并计算意外结果的数量。这些线程运行一段时间（通常为 2-3 秒），然后使用 Interlocked.CompareExchange 添加它们的结果，然后正常退出。我的测试启动了它们，然后在每个上调用 .Join，然后检查错误数是否为 0。

当然，这不是万无一失的，但是对于多核 CPU，它通常可以很好地向我的同事证明该对象存在需要解决的问题（假设预期用途需要多线程访问） .

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-26T22:07:40.977

需要明确的是，并非所有类都需要锁来保证线程安全。

如果您的测试最终过于复杂，则可能是您的类或方法过于复杂、两个紧密耦合或承担过多责任的症状。尽量遵循单一责任原则。

你介意发布更多关于你的班级的具体信息吗？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-28T19:43:13.007

我同意其他发帖者的观点，即应避免使用多线程代码，或者至少将其限制在应用程序的一小部分。但是，我仍然想要一些方法来测试这些小部分。我正在开发[MultithreadedTC Java library](http://www.cs.umd.edu/projects/PL/multithreadedtc/overview.html)的 .NET 端口。我的移植名为[Ticking Test](http://code.google.com/p/donkirkby/source/browse/#svn/trunk/TickingTest)，源代码发布在 Google Code 上。

MultithreadedTC 允许您编写一个测试类，其中包含几个标有 TestThread 属性的方法。每个线程可以等待某个滴答计数到达，或者断言它认为当前滴答计数应该是什么。当所有当前线程都被阻塞时，协调器线程会增加滴答计数并唤醒任何正在等待下一个滴答计数的线程。如果您有兴趣，请查看[MultithreadedTC 概述](http://www.cs.umd.edu/projects/PL/multithreadedtc/overview.html)以获取示例。MultithreadedTC 是由一些编写[FindBugs](http://findbugs.sourceforge.net/)的人编写的。

我在一个小项目上成功地使用了我的端口。主要缺失的功能是我无法在测试期间跟踪新创建的线程。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-27T00:50:57.263

大多数单元测试是按顺序而不是并发运行的，因此它们不会暴露并发问题。

由具有并发专业知识的程序员进行代码检查是您​​最好的选择。

那些邪恶的并发问题通常不会出现，除非您在该领域有足够的产品来生成一些统计相关的趋势。有时很难找到它们，因此通常最好避免一开始就编写代码。如果可能，请使用预先存在的线程安全库和完善的设计模式。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-06-01T12:34:40.593

*   你会发现你的“不变”——无论客户端线程的数量和交错如何，它都必须保持真实。这是困难的部分。
*   然后编写一个生成多个线程的测试，练习该方法并断言不变量仍然成立。这将失败 - 因为不存在使其线程安全的代码。红色的
*   添加代码使其线程安全并通过压力测试。绿色的。根据需要重构。

有关更多详细信息，请参阅 GOOS 书籍中与多线程代码相关的章节。

# c++ - OpenGL: glTexImage2D conflicts with glGenLists & glCallList?

> ID：791687
> 
> 赞同：0
> 
> 时间：2009-04-26T21:59:22.060
> 
> 标签：c++, c, opengl

I have a simple OpenGL application where I have 2 objects displayed on screen:

1) particle system, where each particle is texture mapped with glTexImage2D() call. In the drawEvent function, I draw it as a GL_TRIANGLE_STRIP with 4 glVertex3f.
2) a 3D text loaded from an object file, where each point is loaded using glNewList/glGenLists and store each point as glVertex. I draw it by making call to glCallList.

The problem is as soon as I call glTexImage2D() to map my particle with a .bmp file, the 3D text would not show on the screen. The particle would look fine. (this is not expected)

If I dont call glTexImage2D, I see both the 3D text and particle system. In this case, particle system looks horrible because I didnt texture map with anything. (this is expected)

Does anyone know why using call list and glTexImage2D might conflict with each other?

**EDIT** i also forgot to mention: I do call glBindTexture(GL_TEXTURE_2D, this->texture); inside the drawLoop before particle system is called.

**EDIT2** i only call glTexImage2D() once at system start up (when I texture mapped the bitmap)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T22:12:16.707

It might not be a conflict of glTexImage2D and glCallList at all. Is your texture mapping ok ? have you set the texture coordinates propperly? Try checking for a vertex to texture coordinates missmatch.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T22:30:03.967

glTexImage2D uploads the texture to the video-ram (simplified said).

If OpenGL would allow you to place a glTexImage2D call inside the list it had to store the pixel-data in the list as well. Now what happends if you would execute the list? You would upload the same image data into the same texture all over gain.

That makes no sense, therefore it's left out.

If you want to change textures between draw calls use glBindTexure. That call sets the current texture. It's much faster.

Regarding your image-upload via glTexImage2D: Do that only once for each texture. Either at the start of your program (if it's small) or each time you load new content from disk.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-02T07:17:37.337

I already solve this problem. Before use GL_TEXTURE_2D, you need set enable function=> glEnable(GL_TEXTURE_2D); And before use glCallList, you also need set disable function => glDisable(GL_TEXTURE_2D);

# command-line - ant：在命令行上列出文件夹

> ID：791690
> 
> 赞同：1
> 
> 时间：2009-04-26T22:03:49.333
> 
> 标签：command-line, ant, variables, directory

我是蚂蚁新手。我正在寻找一种方法来做到这一点

我有一个文件夹，其中包含可变数量的子文件夹。假设子文件夹是 s1,s2,s3...,sN（N 未知）

我需要创建并执行这个命令行

java -jar myjar.jar s1\ s2\ s3\ ... sN\

我想使用标准任务，但我不知道如何在命令行上列出文件夹。

任何帮助将不胜感激！

阿尔贝托

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T22:40:42.957

我认为“文件集”类型是您正在寻找的：

[http://ant.apache.org/manual/Types/fileset.html](http://ant.apache.org/manual/Types/fileset.html)

“jar”任务可以使用隐式文件集，或者您可以在 jar 任务中定义自定义文件集。

[http://ant.apache.org/manual/Tasks/jar.html](http://ant.apache.org/manual/Tasks/jar.html)

请参阅 jar 页面底部的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T09:24:12.573

您可以创建一个 ant 自定义任务，该任务获取父目录、目录集或模式集，并将所有名称写入 ant 属性

在此处查看更多信息[http://ant.apache.org/manual/develop.html](http://ant.apache.org/manual/develop.html)

# c - 使用 libcurl 和 SSL 进行对等验证

> ID：791694
> 
> 赞同：1
> 
> 时间：2009-04-26T22:05:31.373
> 
> 标签：c, windows, ssl, https, libcurl

我正在使用 Windows 中的 Visual Studio 2008 使用 Openssl 编译的 libcurl 将数据发布到 HTTPS 服务器，并且在将 CURLOPT_SSL_VERIFYPEER 设置为 0 的情况下一切正常。我尝试遵循[http://curl.haxx.se/docs/sslcerts。 html](http://curl.haxx.se/docs/sslcerts.html)以及手册中的几乎每个“SSL 和安全选项”选项。我想知道正确的选项组合是什么以及证书文件应该是什么样子。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-02-19T04:53:54.443

[您可以从官方网站](http://curl.haxx.se/docs/caextract.html "official site")找到有关如何提取 CA 证书的信息

# java - RxTx 库的许可限制是什么

> ID：791695
> 
> 赞同：2
> 
> 时间：2009-04-26T22:06:11.683
> 
> 标签：java, licensing, serial-port, lgpl

我想制作一个使用[RxTx](http://users.frii.com/jarvi/rxtx/index.html)版本 2.2pre2 的应用程序来处理串行端口。什么是许可证限制，因为它是一个“LGPL v 2.1 + Linking Over Controlled Interface”许可库，如果我不使用 Sun 的 javax.comm.* 接口，但在导入 Java 时使用 RxTx 自己的 gnu.io.*文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T22:26:53.927

从过去使用 RXTX 开始，我的理解是，如果您直接使用 gnu.io 接口，则将适用标准 LGPL 许可条款。

# emacs - 无法将文件导入您的 .emacs

> ID：791700
> 
> 赞同：8
> 
> 时间：2009-04-26T22:08:36.483
> 
> 标签：emacs

**如何将新的[代码](http://edward.oconnor.cx/elisp/google.el)块（一个 Emacs lisp 库）导入`.emacs`文件中？**

我不想把所有东西都放在一个巨大的`.emacs`文件中。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-26T22:19:38.483

将文件`google.el`放在一个目录中，比如说`~/lisp`，然后放在你的 .emacs 中：

```
(add-to-list 'load-path "~/lisp")
(require 'google) 
```

如果要添加目录及其子目录，可以查看[此 SO question 中的答案](https://stackoverflow.com/questions/221365/emacs-lisp-how-to-add-a-folder-and-all-its-first-level-sub-folders-to-the-load-p)。

而且，随着您添加越来越多的`'require`行，您会注意到启动时速度变慢。在这一点上，你会想知道如何[让 Emacs 启动得更快](https://stackoverflow.com/questions/778716/how-can-i-make-emacs-start-up-faster/779145) ，我当然最喜欢[我的回答](https://stackoverflow.com/questions/778716/how-can-i-make-emacs-start-up-faster/779145#779145)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T22:32:30.090

如果您需要一次加载多个文件，[elisp-load-dir可以提供帮助。](http://www.cs.huji.ac.il/~osigor/emacs/src/htmlized/elisp-load-dir.el.html)我用它来加载每个主题的设置文件，而这些文件只在实际需要时自动加载繁重的东西：

```
.emacs
.emacs.d/
  lisp/
    elisp-load-dir.el
    ... other .el files that provide a feature
  rc/
    ... many small .el file that set variables, defaults, etc for me 
```

所以我的 .emacs 真的很小，它只是添加`~/.emacs.d/lisp`到加载路径，所以我可以在那里安装第三方扩展。然后它需要`elisp-load-dir`并使用它来加载我拥有的任何配置文件`~/.emacs.d/rc`：

```
(add-to-list 'load-path "~/.emacs.d/lisp")
(require 'elisp-load-dir)
(elisp-load-dir "~/.emacs.d/rc")
;; then comes all the custom-set-faces stuff that emacs puts there 
```

这些`rc/*.el`文件基本上就是你放入的文件`.emacs`，除了它是模块化的。例如，我经常使用的每种模式都有一个，一个用于启动、禁用启动画面、工具栏等……</p>

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T22:42:32.313

您还可以在 .emacs 文件中添加一个简单的加载语句：

```
(load "/path/to/library.el") 
```

不过，坦率地说，我喜欢 Trey 的解决方案：它将所有 .el 文件保存在一个位置。

编辑：根据 Trey 的声明，删除了“require”声明。

# f# - 如何使用 printf 自定义自定义类型的输出？

> ID：791706
> 
> 赞同：38
> 
> 时间：2009-04-26T22:12:18.907
> 
> 标签：f#, printf, string-formatting, f#-interactive

我已经阅读了大量的*Expert F#*，并且正在构建一个实际的应用程序。在调试时，我已经习惯于传递这样的 fsi 命令以使 repl 窗口中的内容清晰易读：

```
fsi.AddPrinter(fun (x : myType) -> myType.ToString()) 
```

我想扩展它以使用 printf 格式化程序，所以我可以输入例如

```
printf "%A" instanceOfMyType 
```

并控制自定义类型的输出。这本书暗示可以做到这一点（第 93 页，“通用结构格式可以扩展为使用任何用户定义的数据类型，F# 网站上涵盖的主题”），但我没有找到任何关于如何真正做到这一点。有谁知道怎么做？甚至可能吗？

**编辑：**

我应该包含一个代码示例，它是我正在处理的记录类型，例如

```
type myType = 
    {a: int}        
    override m.ToString() = "hello"

let t = {a=5}
printfn "%A" t
printfn "%A" (box t) 
```

两个打印语句都产生：

```
{a = 5;} 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-11-23T23:51:44.953

看起来在 F# 2.0 中执行此操作的正确方法是使用[`StructuredFormatDisplay`](http://msdn.microsoft.com/en-us/library/ee370334.aspx)属性，例如：

```
[<StructuredFormatDisplay("hello {a}")>]
type myType = {a: int} 
```

在此示例中`{a = 42;}`，您将获得`hello 42`.

这对对象、记录和联合类型的工作方式相同。虽然模式必须是格式`"PreText {PropertyName} PostText"`（*PreText*和*PostText*是可选的），但这实际上比`ToString()`因为：

1.  `PropertyName`可以是任何类型的属性。如果它不是字符串，那么它也将受到结构化格式的约束。[Don Syme 的博客](http://blogs.msdn.com/b/dsyme/archive/2010/01/08/some-tips-and-tricks-for-formatting-data-in-f-interactive-and-a-in-sprintf-printf-fprintf.aspx)给出了一个以这种方式递归格式化树的示例。

2.  它可能是一个计算属性。所以你实际上可以`ToString()`开始为记录和联合类型工作，尽管是以一种相当迂回的方式：

    ```
    [<StructuredFormatDisplay("{AsString}")>]
    type myType = 
        {a: int}
        override m.ToString() = "hello"
        member m.AsString = m.ToString()  // a property that calls a method 
    ```

顺便说一句，`ToString()`如果您调用`printfn "%O"`而不是`printfn "%A"`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-26T23:00:49.570

嗯...我隐约记得对此进行了一些更改，但我忘记了它们是在 CTP (1.9.6.2) 之前还是之后发生的。

无论如何，在 CTP 上，我看到

```
type MyType() =
    override this.ToString() = "hi"
let x = new MyType()
let xs = Array.create 25 x
printfn "%A" x
printfn "%A" xs 
```

当在 VFSI 窗口中进行评估时，我会做我想要的，并且

```
x;;
xs;; 
```

也打印得很好。所以，我想我不清楚这与想要的有什么不同？

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-26T23:01:41.237

如果您覆盖 ToString 方法，那应该可以。

# python - 将列表转换为字典的最佳方法，其中键是每个对象的值？

> ID：791708
> 
> 赞同：5
> 
> 时间：2009-04-26T22:14:22.180
> 
> 标签：python

我正在尝试获取对象列表，并将该列表转换为字典。dict 值将是列表中的每个对象，而 dict 键将是在每个对象中找到的值。

这是一些代表我在做什么的代码：

```
class SomeClass(object):

    def __init__(self, name):
        self.name = name

object_list = [
    SomeClass(name='a'),
    SomeClass(name='b'),
    SomeClass(name='c'),
    SomeClass(name='d'),
    SomeClass(name='e'),
]

object_dict = {}
for an_object in object_list:
    object_dict[an_object.name] = an_object 
```

现在该代码可以工作了，但它有点难看，而且有点慢。谁能举一个更快/“更好”的例子？

*编辑：* 好的，谢谢回复。我必须说我很惊讶地看到更多的 Pythonic 方式**似乎**比手工制作的方式慢。

*编辑2：* 好的，我更新了测试代码以使其更具可读性，有这么多测试呵呵。

这是我们在代码方面所处的位置，我将作者放在代码中，如果我搞砸了，请告诉我。

```
from itertools import izip
import timeit

class SomeClass(object):

    def __init__(self, name):
        self.name = name

object_list = []

for i in range(5):
    object_list.append(SomeClass(name=i))

def example_1():
    'Original Code'
    object_dict = {}
    for an_object in object_list:
        object_dict[an_object.name] = an_object

def example_2():
    'Provided by hyperboreean'
    d = dict(zip([o.name for o in object_list], object_list))

def example_3():
    'Provided by Jason Baker'
    d = dict([(an_object.name, an_object) for an_object in object_list])

def example_4():
    "Added izip to hyperboreean's code, suggested by Chris Cameron"
    d = dict(izip([o.name for o in object_list], object_list))

def example_5():
    'zip, improved by John Fouhy'
    d = dict(zip((o.name for o in object_list), object_list))

def example_6():
    'izip, improved by John Fouhy'
    d = dict(izip((o.name for o in object_list), object_list))

def example_7():
    'Provided by Jason Baker, removed brackets by John Fouhy'
    d = dict((an_object.name, an_object) for an_object in object_list)

timeits = []
for example_index in range(1, 8):
    timeits.append(
        timeit.Timer(
            'example_%s()' % example_index,
            'from __main__ import example_%s' % example_index)
    )

for i in range(7):
    timeit_object = timeits[i]
    print 'Example #%s Result: "%s"' % (i+1, timeit_object.repeat(2)) 
```

列表中有 5 个对象，我得到以下结果：

```
 Example #1 Result: "[1.2428441047668457, 1.2431108951568604]"
    Example #2 Result: "[3.3567759990692139, 3.3188660144805908]"
    Example #3 Result: "[2.8346641063690186, 2.8344728946685791]"
    Example #4 Result: "[3.0710639953613281, 3.0573830604553223]"
    Example #5 Result: "[5.2079918384552002, 5.2170760631561279]"
    Example #6 Result: "[3.240635871887207, 3.2402129173278809]"
    Example #7 Result: "[3.0856869220733643, 3.0688989162445068]" 
```

和50：

```
 Example #1 Result: "[9.8108220100402832, 9.9066231250762939]"
    Example #2 Result: "[16.365023136138916, 16.213981151580811]"
    Example #3 Result: "[15.77024507522583, 15.771029949188232]"
    Example #4 Result: "[14.598290920257568, 14.591825008392334]"
    Example #5 Result: "[20.644147872924805, 20.64064884185791]"
    Example #6 Result: "[15.210831165313721, 15.212569952011108]"
    Example #7 Result: "[17.317100048065186, 17.359367847442627]" 
```

最后，使用 500 个对象：

```
 Example #1 Result: "[96.682723999023438, 96.678673028945923]"
    Example #2 Result: "[137.49416589736938, 137.48705387115479]"
    Example #3 Result: "[136.58069896697998, 136.5823769569397]"
    Example #4 Result: "[115.0344090461731, 115.1088011264801]"
    Example #5 Result: "[165.08325910568237, 165.06769108772278]"
    Example #6 Result: "[128.95187497138977, 128.96077489852905]"
    Example #7 Result: "[155.70515990257263, 155.74126601219177]" 
```

感谢所有回复！我对结果感到非常惊讶。如果有任何其他关于更快方法的提示，我很想听听。谢谢大家！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-26T22:23:57.413

在 python 3.0 中，您可以使用 dict 理解：

```
{an_object.name : an_object for an_object in object_list} 
```

这在 Python 2 中也是可能的，但它有点难看：

```
dict([(an_object.name, an_object) for an_object in object_list]) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-26T22:21:48.090

```
d = dict(zip([o.name for o in object_list], object_list)) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-26T23:31:40.497

如果您关心速度，那么我们可以稍微改进一下。您的“详细”解决方案（非常好）不会创建中间数据结构。另一方面，hyperboreean 的解，

```
d = dict(zip([o.name for o in object_list], object_list)) 
```

创建两个不必要的列表：`[o.name for o in object_list]`创建一个列表，并`zip(_, _)`创建另一个列表。这两个列表仅在创建字典时被迭代一次。

我们可以通过用生成器表达式替换列表推导来避免创建一个列表：

```
d = dict(zip((o.name for o in object_list), object_list)) 
```

替换`zip`为`itertools.izip`将返回一个迭代器并避免创建第二个列表：

```
import itertools
d = dict(itertools.izip((o.name for o in object_list), object_list)) 
```

我们可以用同样的方式修改 Jason Baker 的解决方案，只需删除方括号：

```
d = dict((an_object.name, an_object) for an_object in object_list) 
```

# javascript - 无法在 jQuery 中为浏览消息制作 SO 浮动效果

> ID：791709
> 
> 赞同：0
> 
> 时间：2009-04-26T22:15:26.623
> 
> 标签：javascript, jquery

我对按下最新链接时SO的浮动效果感兴趣： ![替代文字](https://i.stack.imgur.com/3eJgh.png)

**你会在 jQuery 中使用哪个库来制作浮动效果？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T22:38:06.223

如果您查看该页面并查看源代码，您可以确切地看到他们在做什么。当单击链接时，实际上只有大约 10 行 javascript 会滚动到您要排序的部分：

```
$.scrollTo("#answers-table", 400); 
```

然后它使用排序链接上提供的 href 使用 jQuery 调用 API：

```
var url = $(this).attr('href');
$.post(url, function(result) {/*function code is below*/}) 
```

然后为回调指定的函数将您刚刚滚动到的整个 div 替换为结果：

```
var domelement = $(result);
$("#answers-table").html(domelement); 
```

实际的选项卡样式只是为链接指定不同的类以更改颜色。这也不*完全*是完成事情的顺序，但它非常接近。

如果讨论 StackOverflow 网站的工作方式是否违反任何类型的 TOS，请告诉我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T22:18:01.390

这看起来像标签，但有一些 CSS 让它看起来不同。 [http://jqueryui.com/demos/tabs/](http://jqueryui.com/demos/tabs/)

# wpf - 将系统焦点设置在我的应用程序上

> ID：791714
> 
> 赞同：3
> 
> 时间：2009-04-26T22:18:27.677
> 
> 标签：wpf, focus

我有一个主要在后台运行的应用程序。我想要它处理的某些系统事件导致应用程序从前台应用程序中窃取焦点，无论是什么。但 UIElement.Focus() 似乎只在 WPF 应用程序中设置焦点。也就是说，如果 WPF 应用程序整体已经拥有焦点，那么 Focus() 会将焦点设置到正确的控件。但我需要从另一个应用程序中窃取焦点并将其放在我的应用程序上。我怎样才能做到这一点？

我*不*想要系统模式对话框。也就是说，在窗口窃取焦点后，用户应该可以立即切换到另一个应用程序而无需关闭我的应用程序的窗口。

当应用程序需要窃取系统焦点时，它可能已经处于恢复、最小化甚至“最小化到托盘”状态。因此，假设它被最小化并在恢复窗口时窃取焦点是不可接受的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T22:23:40.363

如果您不介意做 som p/invokes，该`SetForegroundWindow`功能应该能够帮助您： http:
[//pinvoke.net/default.aspx/user32/SetForegroundWindow.html](http://pinvoke.net/default.aspx/user32/SetForegroundWindow.html)

# webbrowser-control - 如何将 Web 浏览器控件的 URL 属性设置为字符串

> ID：791716
> 
> 赞同：5
> 
> 时间：2009-04-26T22:19:54.317
> 
> 标签：webbrowser-control, uri

我在 C# 中使用 Web 浏览器控件，我希望能够根据程序中发生的其他事情插入不同的 URL。如何将 URL 属性设置为代码中的字符串？我可以将字符串转换为 System.Uri 类型吗？

```
string link;
string searchedtitle = "The+Italian+Job";
link = "http://www.imdb.com/find?s=all&q=" + searchedtitle + "&x=0y=0";
WbBrowser.Url = link; // This is what I don't know how to do 
```

达到这种效果的东西是理想的，我可以在其他地方更改程序中的“searchedtitle”并且仍然让它正常运行。不幸的是，*Url*属性的类型是`System.Uri`，而我只有一个`System.String`.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-26T22:22:21.440

WbBrowser.Url 属于[Uri](http://msdn.microsoft.com/en-us/library/system.uri.aspx)类型，因此您需要使用

```
WbBrowser.Url = new Uri(link); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-26T22:33:35.563

请注意，设置 URL 与调用 Navigate() 函数完全相同。Navigate 将字符串作为参数作为 URL，省去了将 URL 转换为字符串的步骤。

# ruby-on-rails - 评估 :dependent => :destroy

> ID：791721
> 
> 赞同：4
> 
> 时间：2009-04-26T22:23:52.983
> 
> 标签：ruby-on-rails, ruby, activerecord, associations

在 Rails 2.2.2（ruby 1.8.7-p72）中，我想在实际执行之前评估破坏对象的影响。即我希望能够生成将受 :dependent => :destroy 影响的所有对象的列表（通过对象的关联）。我要解决的真正问题是为用户提供将要删除的所有内容的列表，并让他们确认操作。

谁能推荐一个解决这个问题的好方法？我刚刚开始研究 ActiveRecord::Associations，但没有取得太大进展。

更新：在我的特殊情况下，我有各种级别的对象（A --> B --> C）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T14:26:26.257

这应该可以帮助您入门...显然您必须对其进行自定义，但这列出了依赖于类 BlogEntry 销毁的所有关联名称：

```
BlogEntry.reflect_on_all_associations.map do |association|
  if association.options[:dependent] == :destroy
    # do something here...
    association.name
  end
end.compact
=> [:taggings, :comments] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T22:45:25.957

只需手动维护一个关联对象的列表与依赖破坏（可能无论如何都要做），然后为每个对象设置 named_scopes 以拉入包含的对象以进行显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T03:19:30.150

我想说的是，如上所述，有一种向用户显示受影响记录的方法，然后有两个按钮/链接，一个是删除，可能会为用户提供确认警报，询问他们是否检查了另一个链接他们将影响的所有记录的列表。

然后，如果你想确定你也可以通过在数据库中将它们标记为已删除而不是实际删除它们来进行软删除，这可能会派上用场，我不知道你将如何处理自动依赖删除，可能使用acts_as_paranoid，或者某种在父模型上带有回调的自卷版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-26T15:08:02.470

最近我写了一个简单的 Rails 插件来解决这个问题。
在 github 上查看：http: [**//github.com/murbanski/affected_on_destroy/tree**](http://github.com/murbanski/affected_on_destroy/tree)

# c# - 用英语月份填充组合框

> ID：791734
> 
> 赞同：4
> 
> 时间：2009-04-26T22:32:46.923
> 
> 标签：c#, .net, datetime, globalization

我必须用英语填写一个带有月份的组合框：一月，二月等。我做了接下来的事情：

```
private string[] AmericanMonths
{
  get
  {
    var arr = new string[12];
    var americanCulture = new CultureInfo("en-US");
    for (int i = 0; i < 12; i++)
    {
      arr[i] = new DateTime(2000, i + 1, 1).ToString("MMMM", americanCulture);
    }
    return arr;
  }
}

comboMonth.Items.AddRange(AmericanMonths); 
```

您怎么看，哪种方式更好（性能）？

有没有办法将表示月份数的整数转换为其名称？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-26T22:37:59.000

CultureInfo 已经在框架中包含月份名称列表。你可以写：

```
var americanCulture = new CultureInfo("en-US");
comboMonth.Items.AddRange(americanCulture.DateTimeFormat.MonthNames.Take(12)); //to remove last empty element 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T22:41:12.817

CultureInfo 具有[DateTimeFormat](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.datetimeformat.aspx)属性，其中包含有关日期时间格式的信息。从那里您可以使用[GetMonthName](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.getmonthname.aspx)或[GetAbbreviatedMonthName](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.getabbreviatedmonthname.aspx)。或者，您可以通过 DateTimeFormatInfo 的[MonthNames](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.monthnames.aspx)属性获取月份名称数组。

# security - 为什么安全程序如此难以开发（对我而言）？

> ID：791737
> 
> 赞同：1
> 
> 时间：2009-04-26T22:36:53.480
> 
> 标签：security

**社区 Wiki 问题**

每次我从事涉及密码或保护数据的项目时，我都会陷入极其复杂的 API 和问题中。我在开发安全应用程序方面没有接受过太多正式培训，但在数据库、GUI 和构建过程方面我也没有接受过太多正式培训。许多其他编程领域感觉更直观。

安全只是一个比许多其他领域复杂得多的领域吗？我倾向于认为不是。安全接口和系统是否不如其他系统成熟？我倾向于认为这些系统的成熟压力很大。在 UNIX 上，“受信任的环境”一直是标准，直到 90 年代的某个地方。UNIX 只是因为它在这个领域的根源而受苦吗？

技术变化很快。自从我上学以来，计算世界变得更加分散和重要。安全是否被拖了后路？有没有什么新技术有前途？你和我一样受苦吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-26T22:44:42.073

良好的安全性很难，非常非常难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T23:02:16.480

除了其他答案的考虑之外，这也是因为安全性是有效保护和有效易用性之间的平衡。由于其严格的安全性而过于复杂而无法使用的系统可能会使用户失败，从而放弃它。您作为设计师/开发人员的角色也是在这两种对立力量之间找到适当的折衷方案，这往往会带来更多麻烦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T22:56:32.110

我认为安全是如此之难，因为人们倾向于做他们不应该做的事情，并尽最大努力克服他们发现的任何障碍。

只有当这种意志力被用于好事时……

# apache-flex - 为什么当我在 Flex 中子类 TextArea 时没有实例化“textField”？

> ID：791741
> 
> 赞同：1
> 
> 时间：2009-04-26T22:38:49.263
> 
> 标签：apache-flex, inheritance

我正在尝试使用 TextArea 和继承来在受保护的`textField`属性上实现一些附加功能。

不幸的是，当我创建子类的新实例时，此属性设置为`null`. 我可能误解了工作方式`super()`，但我认为它会在构造函数完成后被实例化。

这是一小段扩展的代码`TextArea`：

```
public final class ExtTextArea extends TextArea {

  public function ExtTextArea() {
    super();
  }

  public function testTextField():void {
    if (textField == null)
      Alert.show("null!");
    }
  }
} 
```

调用代码很简单：

```
var extTextArea:ExtTextArea = new ExtTextArea();
extTextArea.testTextField(); 
```

每次运行此代码时都会出现 in `Alert`。`ExtTestArea`

为什么是这样？我还需要做些什么才能访问该`textField`物业吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T23:01:52.657

由于*textField*是“呈现此 TextArea 文本的内部 UITextField”，我相信它会保持为*空，直到您通过**.addChild(...)*将其添加到显示中。我进行了快速测试，以验证一旦将其添加到显示中，它就不再为空。您可能希望将事件处理程序添加到“创建完成”事件并在那时调整它（我认为）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T23:05:47.797

Flex SDK 自带源代码，所以你可以看一下这个字段是什么时候初始化的。它没有在构造函数中初始化，但是您会看到由 createChildren() 实例化的新 TextField，当组件添加到布局容器时会调用它。

# c++ - 如何使用 GDI+ 从资源中加载图像？

> ID：791743
> 
> 赞同：3
> 
> 时间：2009-04-26T22:39:39.217
> 
> 标签：c++, winapi, gdi+

我正在尝试从我的应用程序中的资源将非 bmp 图像（在我的情况下为 png）加载到位图/图像实例中。由于位图构造函数只有位图资源的重载，这就是我遇到的问题：

我在全局堆上分配内存，然后将资源数据复制到其中。然后我为该全局内存块创建一个 IStream（使用 CreateStreamOnHGlobal）并使用获取该流的 Image/Bitmap 构造函数。基本上它可以工作，尽管我不确定这是不是最好的方法：我注意到如果我在创建图像后释放该内存块，它就不会被绘制（调用 DrawImage 不会产生任何东西） . 这提出了两个问题：

1.  如何管理该内存块的生命周期？我怀疑它会在图像被破坏时被释放。

2.  Image/Bitmap 类是否使用压缩形式的 png 数据，并在每次调用 DrawImage 时将其转换为原始数据？看起来效率很低。

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T02:55:51.197

使用非位图资源时，我的代码基于[codeproject](http://www.codeproject.com/KB/GDI-plus/cgdiplusbitmap.aspx)中的代码。

```
IStream* pStream = NULL;
::CreateStreamOnHGlobal(m_hBuffer, FALSE, &pStream)
m_pBitmap = Gdiplus::Bitmap::FromStream(pStream);
pStream->Release(); 
```

一旦你从流中创建位图，就查看该代码，然后调用`Release()`流以删除流上的引用计数，从而将流的生命周期与位图联系起来。

然后，您可以使用您希望管理该指针的任何机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T13:15:19.750

将位图转换为[CachedBitmap](http://msdn.microsoft.com/en-us/library/ms534425(VS.85).aspx)然后摆脱内存。

# c# - Web 部署项目工具和 Web 应用程序项目

> ID：791748
> 
> 赞同：1
> 
> 时间：2009-04-26T22:42:35.807
> 
> 标签：c#, .net, asp.net, assemblies

Q1 - 据我所知，Visual Studio 在编译 Web 应用程序项目时不使用 aspnet_compiler.exe。并且由于 Web 部署项目 (WDP) 工具仅用于操作由 aspnet_compiler.exe 创建的输出，我不明白 VS 2008 如何也可以选择将 WDP 与 Web 应用程序项目一起使用？！

Q2 - 什么是库存项目？

谢谢

**编辑：**

所以我对 Visual Studio 在编译 Web 应用程序项目时不使用 aspnet_compiler.exe 的事实是正确的？

非常感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T06:04:46.323

aspnet_compiler 也将编译 .aspx/.ascx /.ashx 等文件（不仅仅是背后的代码）。视觉工作室没有。因此，如果您想预编译这些文件，请使用 Web 部署项目和/或手动预编译。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T05:41:16.863

Web 应用程序项目是真正的项目 - 它们真正构建并在输出 (bin) 文件夹中生成单个程序集，以及引用程序集的任何副本等。这就是 Web 部署项目将打包的内容。

请记住，在 .NET 2.0 和 Visual Studio 2005 之前，Web 应用程序项目和 Web 部署项目是创建 Web 项目的唯一方法。在许多情况下，更好的问题是“网站伪项目如何工作” ”。

# sorting - 基于比较的排序技术的局限性

> ID：791753
> 
> 赞同：5
> 
> 时间：2009-04-26T22:46:55.627
> 
> 标签：sorting

在大多数需要对数据进行排序的场景中，都会选择比较排序。归并排序、快速排序、插入排序和其他比较排序等技术可以处理不同的数据类型和效率，下限为 O(nLog(n))。

我的问题是

1.  基于比较的排序技术有什么限制吗？
2.  将使用非比较排序技术的任何类型的场景？

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T22:57:29.780

你自己或多或少地回答了。基于比较的排序技术仅限于 O(n Log(n)) 的下限。基于非比较的排序技术不受此限制。非排序算法的普遍问题是必须更好地了解域，因此它们不像基于比较的技术那样通用。

[Pigeonhole 排序](http://en.wikipedia.org/wiki/Pigeonhole_sort)是一个很棒且非常简单的示例，只要可能的键值的数量接近元素的数量，它就会非常快。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T22:59:43.257

显然，比较排序的局限性在于时间因素——[有些比其他的好](http://www.sorting-algorithms.com/)，但是如果数据集足够大，它们在某些时候都会变得太慢。诀窍是根据您要排序的数据的种类和组合选择正确的数据。

非比较排序基于忽略数据的其他因素，例如[计数排序](http://en.wikipedia.org/wiki/Counting_sort)将通过检查每个元素对数据集合进行排序 - 不将其与集合中的任何其他值进行比较。计数排序对于根据某些数据对集合进行排序很有用，如果您有一个整数集合，它会通过将所有值为 1 的元素先放入目标，然后将所有值为 2 的元素等放入目标来对它们进行排序（好的，它使用“稀疏”数组快速放大集合并重新排序值，留下空白，但这是基本原则）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-29T04:14:05.697

很容易看出，为什么比较排序需要大约 N log N 比较。有N个！排列，我们知道 ln (N!) 大约是 N ln N - N + O(ln N)。在大 O 表示法中，我们可以忽略低于 N ln N 的项，因为 ln 和 log 仅相差常数，我们得到最终结果 O(N log N)

# c# - 尝试使用 Linq to XML (C#) 解析 XML 树

> ID：791756
> 
> 赞同：6
> 
> 时间：2009-04-26T22:49:59.237
> 
> 标签：c#, .net, xml, linq, linq-to-xml

我想在我的对象结构中反映 XML 树，但我是 LINQ to XML 的初学者

我有一个具有以下结构的 XML：

```
<questions>
<question id="q1">
  <number>1</number>
  <text>some text11</text>
  <answers>
     <answer>
      <v>some text11</v>
    </answer>
    <answer>
      <v>some text11</v>
    </answer>
  </answers>
</question>
<question id="q2">
  <number>2</number>
  <text>some text2</text>

<answers>
    <answer>
      <v>some text22</v>
    </answer>
    <answer>
      <v>some text22</v>
    </answer>
  </answers>
</question>
<question id="q3">
  <number>3</number>
  <text>some text3</text>
  <answers>
    <answer>
      <v>some text33</v>
    </answer>
    <answer>
      <v>some text33</v>
    </answer>
    <answer>
      <v>some text33</v>
      <addDescription>some text333</addDescription>
      <textBox/>
    </answer>
  </answers>
</question>
</questions> 
```

...我有以下课程：

```
public class Question
{
    public string text { get; set; }
    public IList<Anwser> anwsers = new List<Anwser>();
}

public class Anwser
{
    public string content { get; set; }
} 
```

...并且我已经构建了以下（错误的）Linq 查询：

```
 List<Question> questions = (from xml in xdoc.Element("survey").Elements("questions").Elements("question")
                                    select new Question()
                                               {
                                                   text = xml.Element("text").Value,
                                                   anwsers =
                                                       (from anwsers in
                                                            xdoc.Element("survey").Elements("questions").Elements("question").Elements(
                                                            "answers").Elements(
                                                            "answer")
                                                        select new Anwser()
                                                                   {
                                                                       content = anwsers.Element("v").Value
                                                                   }

                                                       ).ToList()
                                            }).ToList(); 
```

当然，这样我每次都会从添加到每个列表的所有问题中获得所有答案。如何解决这个问题？我可以想象这很简单，但我不知道:)

先感谢您！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-26T23:04:00.670

您的代码无法正常工作，因为您要取回所有答案元素，因为您没有根据它们来自的问题来限制它们。您可以添加此限制，或者代替基于文档的子查询，您可以基于问题元素本身进行子查询。

```
List<Question> questions = (from question in xdoc.Element("survey").Element("questions").Elements("question")
         select new Question
         {
           text = question.Element("text").Value,
           anwsers = (from answer in question.Element("answers").Elements("answer")
                select new Anwser
                {
                  content = answer.Element("v").Value
                }).ToList()
         }).ToList(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-26T23:13:50.210

你非常亲近。在选择新的部分你不需要 () 之后的类名。您还想使用 .Descendents() 而不是 .Elements()。唯一的另一部分是答案应该使用 xml var 而不是返回到原始文档，这将为您提供与问题相关的答案。

```
List<Question> questions = (from xml in xdoc.Descendants("question")
                                    select new Question
                                    {
                                        text = xml.Element("text").Value,
                                        answers =
                                            (from anwsers in xml.Descendants("answer")
                                             select new Answer
                                             {
                                                 Content = anwsers.Element("v").Value
                                             }

                                            ).ToList()
                                    }).ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T23:04:45.630

如果要将其更改为，则问题似乎是您从内部选择中的 xdoc 开始：

```
from answer in xml.Elements("answers").Elements("answer") 
```

你应该没事。这应该可以工作，因为 xml 包含 question 元素。

# javascript - 如何在 Bash 中执行 javascript？

> ID：791758
> 
> 赞同：3
> 
> 时间：2009-04-26T22:52:00.793
> 
> 标签：javascript, bash

我尝试直接从 Bash 访问[http://www.ocwconsortium.org/](http://www.ocwconsortium.org/)的页面。当您将数学写入右上角的字段时，该页面就会出现。我测试过

> 打开[http://www.ocwconsortium.org/#mathematics](http://www.ocwconsortium.org/#mathematics)

但它会导致主页。这显然是一些 javascript 的东西。如何直接从第一页上的 Bash 获得结果？

**[澄清]**

让我们举个例子。对于.bashrc 中的数学搜索引擎，我有以下几行：

```
alias mathundergradsearch='/Users/user/bin/mathundergraduate' 
```

单独文件中的内容：

```
#!/bin/sh                                                                                                                                                                     

q=$1
w=$2
e=$3
r=$4
t=$5

open "http://www.google.com/cse?cx=007883453237583604479%3A1qd7hky6khe&ie=UTF-8&q=$q+$w+$e+$r+$t&hl=en" 
```

现在，我想要与示例类似的东西。不同之处在于其他站点包含 javascript 或不允许我查看参数的内容。由于看不到详细信息，我怎么知道将搜索参数放在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T23:06:51.973

[Links 网络浏览器](http://links.sourceforge.net/)或多或少从命令行运行（如 lynx）并支持基本的 javascript。

尽管帖子的标题听起来很笼统，但您的问题非常具体。我不清楚你最终要达到什么目的。显然，您可以访问严重依赖 javascript 的网站（否则您将无法在此处发布您的问题），因此我确信您可以在普通浏览器中打开上述网站。

如果您只想从命令行执行 javascript（如标题所示），那么通过 cygwin 运行 bash 很容易。您只需调用 cscript.exe 并提供您希望执行的 .js 脚本名称。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T23:50:03.383

```
open "http://www.ocwconsortium.org/index.php?q=mathematics&option=com_coursefinder&uss=1&l=&s=&Itemid=166&b.x=0&b.y=0&b=search" 
```

您需要引号，因为 URL 包含 shell 认为特殊的字符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T23:18:19.467

我没有得到 JavaScript 处理的任何东西 - 它只是带我去

```
http://www.ocwconsortium.org/index.php?q=mathematics&option=com_coursefinder&uss=1&l=&s=&Itemid=166&b.x=0&b.y=0&b=search 
```

更换`mathematics`（之后`q=`）应该工作。您也许可以删除一些查询字符串，但我尝试了几件事，但效果不佳。

不要忘记对 URL 的查询进行编码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T22:53:16.720

您将需要解析响应，找到通过 JavaScript 打开的 URL，然后找到`open`该 URL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-05T12:49:14.063

看看这个：[http](http://www.phantomjs.org/) ://www.phantomjs.org/ 。

PhantomJS 它是一个 CLI 工具，可以在没有 Chrome 的情况下运行真正的、成熟的浏览器。

# iphone - iPhone URL 请求：向 HTTP 标头字段添加值

> ID：791760
> 
> 赞同：6
> 
> 时间：2009-04-26T22:53:02.710
> 
> 标签：iphone, cocoa, cocoa-touch

我正在尝试为 URL 请求的标头添加一个值。

像这样的东西很好用：

```
[urlRequest addValue:@"gzip" forHTTPHeaderField:@"Accept-Encoding"]; 
```

但这甚至没有出现在标题中：

```
NSString *authString = [[NSString alloc] initWithString:
                          [defaults objectForKey:@"auth"]];
[urlRequest addValue:authString forHTTPHeaderField:@"iphoneID"]; 
```

我完全被难住了。auth 字符串的长度约为 90 个字符。这是一个问题吗？

*编辑：* 这是我正在尝试的代码：

```
NSString *authString = [[NSString alloc] initWithString:[defaults objectForKey:@"auth"]]; 
[urlRequest addValue:authString forHTTPHeaderField:@"iphoneid"]; 
[urlRequest addValue:@"gzip" forHTTPHeaderField:@"Accept-Encoding"]; 
```

我可以看到通过 Wireshark 发送的 Accept-Encoding 标头，但找不到 iphoneid。它只是一个字符串，长度为 80-90 个字符。

*另一个更新：* 所以看来问题不在于“iphoneid”字段，而是我试图传递给它的 authString。我刚刚使用 @"something" 创建的其他字符串工作正常，但我从 NSUserDefaults 中提取的身份验证字符串没有出现。

关于如何调试的建议？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-29T01:43:33.620

## 真正的问题。

我从 NSUserDefaults 中提取的字符串已经有一个行尾。当设置为标题时，`\r\n`会附加另一个，这显然是无效的。因此，标头不会出现在任何传出数据包中。

## 修复：

在设置为标题值之前，使用它来修剪字符。

`[yourString stringByTrimmingCharactersInSet: [NSCharacterSet whitespaceAndNewlineCharacterSet]];`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T21:55:37.480

测试清单：

*   验证此时您确实有一个 NSMutableURLRequest（而不是 NSURLRequest）。特别是，检查您的日志中是否存在由于“无法识别的选择器”而导致的异常。

*   验证 urlRequest 不为零。

*   切换到 setValue:forHTTPHeaderField: 而不是 addValue:forHTTPHeaderField:。

*   把 forHTTPHeaderField: 值换成@"Accept-Encoding" 看看是不是这个字段有问题

*   交换 @"gzip" 为 auth 以查看值是否是问题所在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T03:24:12.417

您需要 Charles Web 代理，以查看真正出站和入站的标头值。然后您可以查看问题是否真的出在您的代码中，或者服务器上的某些魔术丢弃了一些东西。

有一个免费试用版，安装后，如果您点击记录模拟器发送的任何流量将通过代理。非常好。

[http://www.charlesproxy.com/](http://www.charlesproxy.com/)

# c# - 关于C#中数组浅拷贝的问题

> ID：791764
> 
> 赞同：2
> 
> 时间：2009-04-26T22:53:49.073
> 
> 标签：c#, arrays, string, shallow-copy

只是为了确保我正确理解了引用类型的浅表副本，并且我没有在这里构造巨大的内存泄漏：

```
// Adds text to the beginning of the log RTB
// Also keeps the log RTB trimmed to 100 lines
var lines = new string[rtbLog.Lines.Length + 1];
lines[0] = "text";
Array.Copy(rtbLog.Lines, 0, lines, 1, rtbLog.Lines.Length);

if (lines.Length > 100)
{
    Array.Resize(ref lines, 100);
}

rtbLog.Lines = lines; 
```

这将首先将引用复制到 rtbLog.Lines 中的字符串到行中。然后它将前 100 个引用从行复制到一个新的字符串数组中。

这意味着 rtbLog.Lines 最初引用的数组、最初由行引用的数组（在调整大小之前），最后是任何不包含在行中的字符串（在调整大小之后），都​​会被垃圾收集。（我希望这是有道理的）

正确的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T23:00:43.923

Array.Resize 方法有点用词不当。它应该真正命名为 CopyToNewArrayWithSize。在后台，此 API 将创建一个新数组并将指定的数据复制到该数组中。然后通过引用返回新数组。

至于垃圾收集。通过将 Lines 属性重置为新数组，您确实成功地删除了对数组的原始引用。只要没有其他对数组的引用，它就会在将来的某个时候被垃圾收集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T23:43:26.100

是的，不再使用的原始数组和字符串被垃圾收集得很好。

如果您在创建数组之前计算所需的大小，则不必调用`Resize`（因为这将创建数组的另一个副本）。

```
// Adds text to the beginning of the log RTB
// Also keeps the log RTB trimmed to 100 lines
int size = Math.Min(rtbLog.Lines.Length + 1, 100);
string[] lines = new string[size];
lines[0] = "text";
Array.Copy(rtbLog.Lines, 0, lines, 1, size - 1);
rtbLog.Lines = lines; 
```

# bash - 无法像使用 CTRL-r 一样转发搜索 Bash 历史记录

> ID：791765
> 
> 赞同：237
> 
> 时间：2009-04-26T22:53:57.527
> 
> 标签：bash, search

我正在尝试与`CTRL`-类似地搜索我的 bash 历史记录`r`，但要向前。

`CTRL`当我经常打一次- `r`，再次找到以前的命令时，这对我来说一直很痛苦。

你如何像反向搜索一样向前搜索你的 Bash 历史？

* * *

## 回答 #1

> 赞同：374
> 
> 时间：2009-04-26T23:09:34.933

您也可以向前搜索。来自 bash 信息手册，“ [8.2.5 在历史记录中搜索命令](http://www.gnu.org/software/bash/manual/html_node/Searching.html)”：

> 要在历史记录中向后搜索特定字符串，请键入`C-r`。`C-s`通过历史输入向前搜索。

然而，Ctrl-S 的问题是有时会与 XON/XOFF 流控制（例如在 Konsole 中）发生冲突。然而，搜索是一项 readline 功能，您应该能够将其绑定到其他一些键。更新：更简单更好的是通过运行禁用 XON/XOFF

```
stty -ixon 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2013-03-15T11:10:09.370

恕我直言，最好的技巧是使用`pgup`and启用`pgdown`。把它放在你的`~/.inputrc`

```
"\e[5~": history-search-forward
"\e[6~": history-search-backward 
```

注销/登录，键入第一个字母，然后`pgup`或`pgdown`搜索整个历史记录

`ctrl-R`搜索所有包含单词的行，而 history-search-forward 搜索以单词开头的行

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2015-05-29T05:15:19.107

您可能想尝试[https://github.com/dvorka/hstr](https://github.com/dvorka/hstr)，它允许使用（可选）基于度量的排序对 Bash 历史进行“建议框样式”过滤，即它在向前和向后方向上都更加高效和快速：

![在此处输入图像描述](https://i.stack.imgur.com/LZ9jK.png)

它可以很容易地[绑定](https://github.com/dvorka/hstr/blob/master/CONFIGURATION.md)到`Ctrl-r`和/或`Ctrl-s`

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2013-02-07T15:01:23.487

我通常按`ESC`​​终端，然后按`>`. 它至少会重置，然后您可以尝试少点击`CTRL`+ `R`。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2020-09-30T08:32:17.173

另一种解决方案是使用：

`history | grep <searched expression>`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-07-28T22:23:24.753

正如许多人所经历的那样，由于[软件流控制](https://en.wikipedia.org/wiki/Software_flow_control)`ctrl`（XON/XOFF 流控制）， +`s`冻结（和`ctrl`+`q`解冻）终端，您可以按照接受的答案中所述禁用它。

虽然我不能说我真的有意使用了该功能，但我确实希望该选项能够暂停快速移动的终端文本流，因此我不想完全禁用它。

因此，我没有将其关闭，而是通过将以下内容放在我的 .bashrc 中来反弹 xoff 功能

```
stty stop '^P' 
```

它将 xoff 绑定到`ctrl`+ `p`（并且 ctrl+q 仍然解冻）。我使用“p”表示“暂停”，这确实掩盖了 bash 先前的命令功能`previous-history`。就我个人而言，我总是使用向上箭头键，所以这对我来说并不重要，但你可以选择不同的键。

这会自动释放`ctrl`+ `s`for`forward-search-history`

# jquery - 我可以为其内容创建具有可变高度的尾声滑块导航吗？

> ID：791775
> 
> 赞同：0
> 
> 时间：2009-04-26T22:58:11.263
> 
> 标签：jquery, css, variables, height, coda-slider

如今，大多数人都非常了解 Coda Slider 效果，但即使使用谷歌搜索并在这里进行搜索，我也找不到我的答案。

**问题**如何创建使用水平滑动/滚动*但*在滑动动画期间将其高度调整为内容所需高度的 Coda Slider 样式导航？

例如，第一张“幻灯片”中只有一张图片（400 像素宽，300 像素高），但下一张幻灯片包含大量信息，包括图片、文本和视频内容，总宽度为 400 像素，高度为 800 像素。现在，开始创建一个 800 像素高的容器只是浪费幻灯片 1 的空间，因此我需要根据单个幻灯片的内容所需的高度动态更改幻灯片容器的高度。

这可能吗？也许那里有一个教程，你们中的一个可以指出我。

在技​​术方面，我非常适应 xHTML 和 CSS，但只是 jQuery 和 PHP 的业余爱好者。虽然这不应限制您的回答，但请在解释时牢记这一点。

非常感谢您的阅读，我期待您的想法、解决方案和一般意见。

詹尼斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T00:21:18.863

我最近推出了自己的。这是（希望）一个有用的起点。

这是我的“下一个按钮”的代码。

```
var canSlide = true;
$('.next').bind('click', function() {

            if (!canSlide) { return false } // prevent queuing up of multiple clicks

            $('.prev').fadeIn(500);

            canSlide = false;

            $('.testimonials-container').animate({ left: '-=1011px' }, 1000, function() { canSlide = true });            

            if (currentPane == totalPanes) {

                $('.next').fadeOut(500);
                canScroll = false;

            } else {
                currentPane++;

            } 
```

要让它调整它的高度，您只需在动画的 JSON 参数中添加一个高度。如

```
.animate({left: '-=1011px', height: newHeight + 'px'}) 
```

当然，您需要一些 JavaScript 来计算下一个高度应该是多少！

# java - 有没有其他方法可以在 Java 中实现克隆？

> ID：791787
> 
> 赞同：6
> 
> 时间：2009-04-26T23:03:04.730
> 
> 标签：java, reference, vector, clone, subclass

在我的 Java 项目中，我有一个包含各种类型交易者的向量。这些不同类型的交易者是交易者类的子类。现在，我有一个将 Trader 作为参数并在向量中存储 50 次左右的方法。我遇到了问题，因为存储同一个对象 50 次只是存储同一个对象的 50 个*引用*。我需要存储该对象的 50 个*副本*。我已经研究过实现[Clone](http://en.wikipedia.org/wiki/Clone_(Java_method))，但我不希望定义 Trader 类型的程序员不得不担心使他们的类可克隆。[此外，正如this page](http://www.javapractices.com/topic/TopicAction.do?Id=71)所指出的，实现克隆会产生各种问题。我认为复制构造函数也不会起作用，因为如果我在 Trader 类中定义了一个，它就不会知道它正在复制的 Trader 的类型，而只会创建一个通用的 Trader。我能做些什么？

编辑：我真的不想制作某个对象的精确副本。我真正想做的是将一定数量的交易者添加到向量中。问题是用户需要在参数中指定他想要添加的交易者类型。这是我正在尝试做的一个示例：（尽管我的语法完全是虚构的）

```
public void addTraders(*traderType*)
{
    tradervect.add(new *traderType*())
} 
```

我怎样才能在 Java 中实现这样的目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T23:27:15.827

只需添加一个抽象复制方法。您可以使用协变返回类型，以便指定派生类型以返回派生实例，这可能很重要，也可能不重要。

```
public interface Trader {
    Trader copyTrader();
    ...
}

public final class MyTrader implements Trader {
    MyTrader copyTrader() {
        return new MyTrader(this);
    }
    ...
} 
```

有时您可能希望一般处理`Trader`需要克隆的派生类型的集合，然后返回正确类型的集合。为此，您可以以惯用的方式使用泛型：

```
public interface Trader<THIS extends Trader> {
    THIS copyTrader();
    ...
}

public final class MyTrader implements Trader<MyTrader> {
    public MyTrader copyTrader() {
        return new MyTrader(this);
    }
    ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T23:31:18.920

我有点不清楚为什么要存储同一对象的 50 个左右的克隆，除非原始交易者用作后来交易者的原型（参见模式）。

如果要对对象进行精确复制，则必须考虑多态性问题。如果允许将给定类的子类化的人添加状态成员，那么您已经对 equals 和 compareTo 等函数感到头疼，该克隆只是您需要特殊处理的另一种情况。

我不同意克隆总是邪恶的，有时是必要的。然而，在子类化的情况下，很多事情变得棘手。

我建议您阅读（当您有机会时）Bloch 的“Effective Java”，其中涵盖了他的很多主题。Bracha 的观点是，让其他人扩展你的类不是一个好主意，如果你这样做，你需要很好地记录他们必须做什么，并希望他们遵循你的指示。真的没有办法绕过它。您可能还想让您的交易者不可变。

继续正常实现 Clone，并在类头中非常清楚地指出任何从您的 Trader 继承并添加状态成员的人都必须实现 X 方法（指定哪个）。

寻找绕过实际 Cloneable 并且仍然 Clone 的技巧并不能克服继承问题。这里没有灵丹妙药。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T23:13:51.333

一种选择：如果可以使对象可序列化，则可以对其进行序列化然后反序列化以制作副本，类似于通过 RMI 传递对象时发生的情况。

快速复制方法：

```
public MyObject copy() {
    ObjectOutputStream oos = null;
    ObjectInputStream ois = null;
    try {
        ByteArrayOutputStream bos =  new ByteArrayOutputStream();
        oos = new ObjectOutputStream(bos);
        oos.writeObject(this);
        oos.flush();
        ByteArrayInputStream bin =
            new ByteArrayInputStream(bos.toByteArray());
        ois = new ObjectInputStream(bin);
        return (MyObject)ois.readObject();
    } catch(Exception e) {
        return null;
    } finally {
        try {
            oos.close();
            ois.close();
        } catch (Exception e) {
            return null;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T02:49:19.600

Uri 说得对，状态多态性打开了一大堆蠕虫。

我认为继承 Cloneable 并覆盖 clone() 可能是最简单的方法。我相信，您可以使返回类型协变。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-04-26T23:29:24.307

一种方法是使其成为类似于 Java 自己的 String 的 final 类，这将对 Trader 类的对象进行任何更改以在内存中创建一个新副本，但它无法对其进行子类化。

另一种（更好的）方法是使用工厂方法来创建和复制 Trader 对象，这意味着您不能允许使用默认构造函数，即使其成为私有的。通过这种方式，您可以控制类具有的实例数。请参阅[http://en.wikipedia.org/wiki/Factory_method](http://en.wikipedia.org/wiki/Factory_method)

```
public class Trader {

    /* prevent constructor so new cant be used outside the factory method */
    private Trader() {
    }

    /* the factory method */
    public static Trader createTrader(int whatKindOfTrader) {

        switch (whatKindOfTrader) {
        case 0:
            return new Trader1(); // extends Trader
        case 1:
        default:
            return new Trader2(); // extends Trader
        }
        return new Trader3(); // or throw exception
    }
} 
```

你甚至可以指定另一个重载方法，或者第二个参数，它接受一个 Trader 并将其复制到一个新的，从而替换克隆。顺便说一句，您可能想要覆盖 clone() 方法并抛出 CloneNotSupportedException，以防止默认对象克隆。

# assembly - x86 架构中的“欧盟”是什么？（计算有效地址？）

> ID：791798
> 
> 赞同：8
> 
> 时间：2009-04-26T23:07:48.680
> 
> 标签：assembly, x86, cpu-architecture

我在某处读到 x86 指令中的有效地址（如 LEA 指令）是由“EU”计算的。什么是欧盟？计算有效地址究竟涉及什么？

我只了解了 MC68k 指令集（UC Boulder 首先教这个），我无法通过搜索网络找到好的 x86 网页。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T00:06:45.730

英特尔自己的[软件开发人员手册](http://www.intel.com/products/processor/manuals/)是有关 x86 的一个很好的信息来源，尽管它们可能有点矫枉过正（并且更像参考而不是教程）。

EU（执行单元）参考最有可能与 ALU（算术逻辑单元）形成对比，后者通常是处理器中负责算术和逻辑指令的部分。然而，欧盟也有（或有）一些算术能力，用于计算内存地址。x86 LEA 指令将这些功能传达给汇编程序员。

通常，您可以为 x86 指令提供一些非常复杂的内存地址：

```
sub eax, [eax + ebx*4 + 0042] 
```

当 ALU 处理算术减法时，EU 负责生成地址。

借助 LEA，您可以将有限的地址生成功能用于其他目的：

```
lea ebx, [eax + ebx*4 + 0042] 
```

与之比较：

```
mul ebx, 4
add ebx, eax
add ebx, 0042 
```

我链接的页面上的“第 1 卷”有一节“3.7.5”讨论寻址模式 - 您可以为期望内存操作数（其中 LEA 是其中一个）的指令提供什么样的内存地址，反映什么样的EU（或任何称为内存接口部分）的算术能力。

“第 2 卷”是指令集参考，包含所有指令（包括 LEA）的明确信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-09T06:05:58.097

“EU”是执行单元的总称。ALU 是执行单元的一个示例。FADD 和 FMUL，即浮点加法器或乘法器，是其他示例 - 就这一点而言，是（是）用于加载和存储的存储单元。

与 LEA 指令相关的 EU 是 ALU（加、减、AND/OR 等）和 AGU（地址生成单元）。AGU 耦合到内存管道、TLB、数据缓存等。

当我编写第一个代码生成指南时，典型的 Intel x86 CPU 有 2 个 ALU、1 个连接到 AGU 的加载管道、一个连接到第二个 AGU 的存储地址管道和一个存储数据管道。截至 2016 年，大多数都有 3 或 4 个 ALU 和不止一个负载管道。

LEA 是一个 3 输入指令 - BaseReg+IndexReg*Scale+Offset。就像 x86 的内存寻址模式一样，它实际上有第四个输入，即段基址，它不是 LEA 计算的一部分。3 个投入的成本必然高于 ADD 所需的 2 个投入。

在某些机器上，ALU 只能执行 2 个输入操作。因此 LEA 只能在 AGU 上执行，特别是用于加载的 AGU（因为存储 ALU 不写入寄存器）。这可能意味着您不能在加载的同时执行 LEA，或同时执行两个 LEA，而您可以在同一个周期中执行两个 Adds 和一个加载。

在其他机器上，LEA 可以由一个、两个或三个 ALU 完成。可能代替 AGU - 可能和 ALU 一样。这证明了更大的灵活性。

或者，简单的 LEA，例如 reg *scale+offset，可以在 ALU 上完成，而最大的 LEA，例如 breg+ireg* scale+offset，可能会受到限制，甚至可能分解为两个微指令。

因此，问题归结为：哪个欧盟（执行单位）处理哪些 LEA？ALU 还是 AGU？答案取决于机器。

Generic text in an optimization guide may simply say "EU" rather than "AGU or ALU, depending on the model" or "whichever EU is capable of handling that particular LEA".

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-26T23:15:27.740

EU = 执行单位？

有效地址是如果`LEA`指令是实际执行某种算术或其他数据访问的指令，则将被访问的地址。它的“预期”用途是从指针算术或数组索引操作计算结果指针。但是，因为它可以执行乘法和加法的某种组合，它也用于优化一些常规计算。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T23:35:26.087

多年来，单个系列中处理器的内部结构发生了很大变化，因此需要使用确切的 cpu 模型来澄清“欧盟”参考。与您的 m68k 体验类似，68000、010、020、030、040 和 060 的指令集大部分相同，但它们的内部结构确实不同，因此任何对内部名称的引用都需要带有它们的部件号。

# emacs - 无法将目录及其所有子目录添加到 Emacs 中的加载路径

> ID：791812
> 
> 赞同：5
> 
> 时间：2009-04-26T23:19:57.700
> 
> 标签：emacs, lisp, elisp

这个问题类似于[一个](https://stackoverflow.com/questions/221365/emacs-lisp-how-to-add-a-folder-and-all-its-first-level-sub-folders-to-the-load-p)。

但是，将所有可实现的子目录也放入文件夹中是不同的。

**Jouni 的代码可以实现第一级文件夹**

```
(let ((base "~/Projects/emacs"))
  (add-to-list 'load-path base)
  (dolist (f (directory-files base))
    (let ((name (concat base "/" f)))
      (when (and (file-directory-p name) 
                 (not (equal f ".."))
                 (not (equal f ".")))
        (add-to-list 'load-path name))))) 
```

**如何在 Emacs 中将目录及其所有子目录放入 load-path？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-27T00:12:40.397

我在另一个问题中的[回答](https://stackoverflow.com/questions/221365/emacs-lisp-how-to-add-a-folder-and-all-its-first-level-sub-folders-to-the-load-p/702280#702280)确实处理了多个级别的子目录。

**参考代码**

```
(let* ((my-lisp-dir "~/.elisp/")
       (default-directory my-lisp-dir)
       (orig-load-path load-path))
  (setq load-path (cons my-lisp-dir nil))
  (normal-top-level-add-subdirs-to-load-path)
  (nconc load-path orig-load-path)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-09T19:28:35.593

这是对 Jouni 答案的改编，它使用了您可以定制的辅助函数。

辅助函数的一个优点是您可以在它发生意外时跟踪它，因为它是一个纯函数，因此不会对您的加载路径产生副作用。我尝试使用 normal-top-level-add-subdirs-to-load-path，但其中的所有内容都非常有副作用，并且依赖于不可预测的特殊变量，因此编写干净的新鲜内容更容易。请注意，我的答案不使用 inode，因此可能效率较低。

这种方法的第二个优点是它可以让你定制你想忽略的文件。

```
(defun add-to-load-path-with-subdirs (directory & optional endp)
  (let ((newdirs (lp-subdir-list 目录)))
    (if endp (setq load-path (append load-path newdirs))
      (setq 加载路径 (nconc newdirs 加载路径)))))

(defconst +lp-忽略列表+
  （列表“CVS”“.git”“.svn”“..”“.”））

(defun lp-subdir-list (base &optional 忽略)
  （除非忽略
    (setq 忽略 +lp-ignore-list+))
  （让（（待定（列表基数））
 (retval 无))
    （待定时
      (let ((dir (pop pending)))
 （推 dir retval）
 （dolist（f（目录文件目录））
   (let ((name (concat dir "/" f)))
     (when (and (not (member f ignore))
         （文件-目录-p 名称））
       （推送名称待定）
       （推送名称 retval））））））
    （反向 retval）））

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-15T01:53:32.387

简单的回答：

```
 (normal-top-level-add-subdirs-to-load-path) 
```

# prolog - Prolog — 对称谓词

> ID：791822
> 
> 赞同：3
> 
> 时间：2009-04-26T23:28:05.760
> 
> 标签：prolog, predicate, symmetric

我必须在 prolog 中模拟家谱。我有对称谓词的问题。 **事实：**

```
parent(x,y).
male(x).
female(y).
age(x, number). 
```

**规则：**

`blood_relation`让我头疼。这就是我所做的：

```
blood_relation(X,Y) :- ancestor(X,Y).
blood_relation(X,Y) :- uncle(X,Y)
                    ; brother(X,Y)
                    ; sister(X,Y)
                    ; (mother(Z,Y),sister(X,Z))
                    ; (father(Z,Y),sister(X,Z))
                    ; (father(Z,Y),brother(X,Z)).
blood_relation(X,Y) :- uncle(X,Z)
                    , blood_relation(Z,Y). 
```

我得到了我认为令人满意的结果（我有双重打印 - 我可以解决这个问题），问题是我希望这种关系是对称的。现在不是。

```
blood_relation(johns_father, john):yes 
blood_relation(john,johns_father): no 
```

所以..有没有办法解决这个问题。我需要查询：所有不在血缘关系中的对..

## 更新：

> 第一个陈述应该满足什么样的关系？血液关系（X，Y）：-血液关系（X，Y）。

对不起..这是一个糟糕的复制/粘贴..它

```
blood_relation(X,Y):-ancestor(X,Y). 
```

现在固定在上面。

以下是其他规则：

```
father(X,Y) :-
  parent(X,Y),male(X).  
mother(X,Y) :-
  parent(X,Y),female(X).  
brother(X,Y) :-
  parent(Z,X),parent(Z,Y),
  male(X).  
sister(X,Y) :-
  parent(Z,X),parent(Z,Y),
  female(X).  
grandFather(X,Y) :-
  parent(Z,Y),parent(X,Z),
  male(X).  
grandMother(X,Y) :-
  parent(Z,Y),
  parent(X,Z),female(X).  
uncle(X,Y) :-
  mother(Z,Y),brother(X,Z).  
ancestor(X,Y) :-
  ancestor(X,Y).  
ancestor(X,Y) :-
  parent(X,Z),ancestor(Z,Y). 
```

母亲的兄弟在叔叔的定义中。这有点奇怪。我有需要实施的规则，除此之外我不知道如何实施规则。我只是困惑。

知道如何制作`blood_relation`对称吗？并且`not_blood_relation`是新规则。我需要查询。这个真的让我很头疼。也许是因为关系写得像废话。

而且没有更多的事实。就这样。所有规则，所有事实。

查询..`not(blood_relation(X,Y))`不起作用，我真的不知道为什么。例如查询：

```
age(X,Y), Y>18,  
not(parent(X,Z)),write(X),nl,fail. 
```

工作得很好

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-30T02:50:27.980

使特定谓词对称的天真的解决方案与一个体面的解决方案相差不远。为了概括起见，让我们看一下友谊关系，这样人们就不会被叔叔之类的人绊倒。

以下是一些详细说明友谊关系的事实（例如，数字是用户 ID，参数的特定顺序来自谁发起了友谊）。

```
friends(1,2).
friends(5,2).
friends(7,4). 
```

您最初会认为像 " `friends(A,B) :- friends(B,A).`" 这样的规则可以解决问题，但这会导致无限递归，因为它告诉 prolog 如果它只是再交换一次参数，它可能会起作用。有一个谓词“ `@</2`”，它告诉您一个术语（甚至是一个变量）是否以“术语的标准顺序”出现在另一个之前。技术含义在这里并不是那么重要，但我们关心的是，对于两个不同的术语，它只对它们的一个排序是正确的。我们可以用它来打破无限递归！

这条规则将负责使“ `friend/2`”对称。

```
friends(A,B) :- A @< B, friends(B,A). 
```

*尽管这很简洁，但您应该*为大型项目采用一种方法。回想一下，我的事实列表中 args 的顺序有一些实际意义（谁发起了友谊）。添加最终规则破坏了未来对该信息的访问，并且对于阅读代码的其他人来说，将对称属性隐藏在一行代码中，这在面对硬编码数据块时很容易被忽略。

考虑工业级解决方案：

```
friended(1,2).
friended(5,2).
friended(7,4).

friends(A,B) :- friended(A,B).
friends(A,B) :- friended(B,A). 
```

它比较笨重，但它在不使用晦涩的谓词的情况下清晰地读取并保留了原始信息（有一天您可能会在实际应用程序中再次需要这些信息）。

--

至于查找*不*具有特定属性的对，请确保在使用否定查找实际个体时始终包含一些谓词以在规则中提供上下文。

```
potential_enemies(A,B) :- user(A), user(B), \+ friends(A,B). 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T00:29:36.597

有点像家庭作业，不是吗...

大多数 prolog 初学者都没有想到的一个技巧是列表模式匹配。考虑像 [a1,[[a2],[b2,[[e3],[f3]]],[c2]]] 这样的树，如`<tree`>=[root,[ `<tree1`>, `<tree2`>,...]]：

```
%Y is immediate child of X?
child(X,Y,[X|S]) :- member([Y|_],S).

%pick one tree in S and check
child(X,Y,[X|S]) :- member([Z|SS],S),child(Z,Y,[Z|SS]).

%X and Y end up with same root?
sib(X,Y,[R|T]) :- child(R,X,[R|T]), child(R,Y,[R|T]). 
```

我认为你可以改进这一点，使用对作为根，添加性别，为树成员的特定关系命名......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T00:33:50.767

第一个陈述应该满足什么样的关系？

```
blood_relation(X,Y):-blood_relation(X,Y). 
```

这并没有告诉你任何你还不“知道”的东西，并且会导致你递归头痛。至于“否”的答案，看起来您已经从要获得的查询中获得了所有答案，而解释器只是告诉您没有更多答案。

你真的应该发布更多的事实，以及 uncle/2 的定义，你有没有理由不匹配母亲的兄弟，只是她的妹妹？您还有很多其他问题需要解决:-)。

对于不是血缘关系的一切，试试这个：

```
not_blood_relation(X, Y) :- blood_relation(X, Y), !, fail.
not_blood_relation(X, Y). 
```

并问自己为什么它有效！

# c# - 文本框控件中的自动缩放字体，使其尽可能大并且仍然适合文本区域边界

> ID：791830
> 
> 赞同：4
> 
> 时间：2009-04-26T23:32:46.123
> 
> 标签：c#, .net, winforms

我需要一个 TextBox 或某种类型的多行标签控件，它会自动调整字体大小以使其尽可能大，同时让整个消息适合文本区域的边界。

我想看看是否有人在开发我自己的控件之前实现了这样的用户控件。

示例应用程序：有一个文本框，它将是窗口窗体上的一半区域。当出现大约 100-500 个字符的消息时，它将把所有文本放在控件中并设置尽可能大的字体。使用支持 Mono 的 .NET 库的实现将是一个加分项。

如果知道有人已经实现了控件...如果有人知道如何测试给定文本是否完全适合文本区域，这对于我滚动自己的控件很有用。

编辑：我最终为 RichTextBox 编写了一个扩展。一旦我确认所有问题都已解决，我将很快发布我的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-03-12T19:54:32.723

我必须解决同样的基本问题。上面的迭代解决方案非常慢。所以，我用以下方式对其进行了修改。同样的想法。只使用计算的比率而不是迭代。可能，没有那么精确。但是，要快得多。

对于我的一次性需求，我只是在包含我的文本的标签上扔了一个事件处理程序。

```
 private void PromptLabel_TextChanged(object sender, System.EventArgs e)
    {
        if (PromptLabel.Text.Length == 0)
        {
            return;
        }

        float height = PromptLabel.Height * 0.99f;
        float width = PromptLabel.Width * 0.99f;

        PromptLabel.SuspendLayout();

        Font tryFont = PromptLabel.Font;
        Size tempSize = TextRenderer.MeasureText(PromptLabel.Text, tryFont);

        float heightRatio = height / tempSize.Height;
        float widthRatio = width / tempSize.Width;

        tryFont = new Font(tryFont.FontFamily, tryFont.Size * Math.Min(widthRatio, heightRatio), tryFont.Style);

        PromptLabel.Font = tryFont;
        PromptLabel.ResumeLayout();
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T03:22:12.390

我还没有看到执行此操作的现有控件，但您可以通过使用 RichTextBox 和 TextRenderer 的 MeasureText 方法并反复调整字体大小来实现这一点。它效率低下，但它有效。

此函数是 RichTextBox 上的“TextChanged”事件的事件处理程序。

我注意到的一个问题：

键入时，即使禁用滚动条，文本框也会滚动到当前插入符号。这可能会导致顶线或左侧被切掉，直到您使用箭头键向上或向左移动。假设您可以将顶行显示在文本框的顶部，则大小计算是正确的。我包含了一些有时（但并非总是）有帮助的滚动代码。

此代码假定自动换行已禁用。如果启用自动换行，可能需要修改。

* * *

编码：

```
[DllImport("user32.dll")]
public static extern int SendMessage(IntPtr hWnd, uint wMsg, int wParam, uint lParam);

private static uint EM_LINEINDEX = 0xbb;

private void richTextBox1_TextChanged(object sender, EventArgs e)
{
    // If there's no text, return
    if (richTextBox1.TextLength == 0) return;

    // Get height and width, we'll be using these repeatedly
    int height = richTextBox1.Height;
    int width = richTextBox1.Width;

    // Suspend layout while we mess with stuff
    richTextBox1.SuspendLayout();

    Font tryFont = richTextBox1.Font;
    Size tempSize = TextRenderer.MeasureText( richTextBox1.Text, richTextBox1.Font);

    // Make sure it isn't too small first
    while (tempSize.Height < height || tempSize.Width < width)
    {
        tryFont = new Font(tryFont.FontFamily, tryFont.Size + 0.1f, tryFont.Style);
        tempSize = TextRenderer.MeasureText(richTextBox1.Text, tryFont);
    }

    // Now make sure it isn't too big
    while (tempSize.Height > height || tempSize.Width > width)
    {
        tryFont = new Font(tryFont.FontFamily, tryFont.Size - 0.1f, tryFont.Style);
        tempSize = TextRenderer.MeasureText(richTextBox1.Text, tryFont);
    }

    // Swap the font
    richTextBox1.Font = tryFont;

    // Resume layout
    richTextBox1.ResumeLayout();

    // Scroll to top (hopefully)
    richTextBox1.ScrollToCaret();
    SendMessage(richTextBox1.Handle, EM_LINEINDEX, -1, 0);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-12T20:44:59.357

我想出的解决方案是编写一个扩展标准 RichTextBox 控件的控件。

以与常规 RichTextBox 控件相同的方式使用扩展控件，并具有以下增强功能：

*   调整大小或文本更改后调用 ScaleFontToFit() 方法。
*   水平对齐字段可用于居中对齐文本。
*   设计器中设置的字体属性将用于整个区域。不能混合字体，因为一旦调用 ScaleFontToFit 方法它们就会改变。

此控件结合了多种技术来确定文本是否仍适合其边界。如果文本区域是多行的，它会检测滚动条是否可见。我找到了一种巧妙的方法来检测滚动条是否可见，而无需使用我在[Patrick Smacchia 的一篇文章中找到的巧妙技术进行任何 winapi 调用。](http://codebetter.com/blogs/patricksmacchia/archive/2008/07/07/some-richtextbox-tricks.aspx). 当 multiline 不正确时，垂直滚动条永远不会出现，因此您需要使用不同的技术，该技术依赖于使用 Graphics 对象呈现文本。图形渲染技术不适用于多行框，因为您必须考虑自动换行。

这里有一些片段展示了它是如何工作的（下面提供了源代码的链接）。此代码可以很容易地用于扩展其他控件。

```
 /// <summary>
    /// Sets the font size so the text is as large as possible while still fitting in the text
    /// area with out any scrollbars.
    /// </summary>
    public void ScaleFontToFit()
    {
        int fontSize = 10;
        const int incrementDelta = 5; // amount to increase font by each loop iter.
        const int decrementDelta = 1; // amount to decrease to fine tune.

        this.SuspendLayout();

        // First we set the font size to the minimum.  We assume at the minimum size no scrollbars will be visible.
        SetFontSize(MinimumFontSize);

        // Next, we increment font size until it doesn't fit (or max font size is reached).
        for (fontSize = MinFontSize; fontSize < MaxFontSize; fontSize += incrementDelta)
        {
            SetFontSize(fontSize);

            if (!DoesTextFit())
            {
                //Console.WriteLine("Text Doesn't fit at fontsize = " + fontSize);
                break;
            }
        }

        // Finally, we keep decreasing the font size until it fits again.
        for (; fontSize > MinFontSize && !DoesTextFit(); fontSize -= decrementDelta)
        {
            SetFontSize(fontSize);
        }

        this.ResumeLayout();
    }

    #region Private Methods
    private bool VScrollVisible
    {
        get
        {
            Rectangle clientRectangle = this.ClientRectangle;
            Size size = this.Size;
            return (size.Width - clientRectangle.Width) >= SystemInformation.VerticalScrollBarWidth;
        }
    }

    /**
     * returns true when the Text no longer fits in the bounds of this control without scrollbars.
    */
    private bool DoesTextFit()
    {
            if (VScrollVisible)
            {
                //Console.WriteLine("#1 Vscroll is visible");
                return false;
            }

            // Special logic to handle the single line case... When multiline is false, we cannot rely on scrollbars so alternate methods.
            if (this.Multiline == false)
            {
                Graphics graphics = this.CreateGraphics();
                Size stringSize = graphics.MeasureString(this.Text, this.SelectionFont).ToSize();

                //Console.WriteLine("String Width/Height: " + stringSize.Width + " " + stringSize.Height + "form... " + this.Width + " " + this.Height);

                if (stringSize.Width > this.Width)
                {
                    //Console.WriteLine("#2 Text Width is too big");
                    return false;
                }

                if (stringSize.Height > this.Height)
                {
                    //Console.WriteLine("#3 Text Height is too big");
                    return false;
                }

                if (this.Lines.Length > 1)
                {
                    //Console.WriteLine("#4 " + this.Lines[0] + " (2): " + this.Lines[1]); // I believe this condition could be removed.
                    return false;
                }
            }

            return true;
    }

    private void SetFontSize(int pFontSize)
    {
        SetFontSize((float)pFontSize);
    }

    private void SetFontSize(float pFontSize)
    {
        this.SelectAll();
        this.SelectionFont = new Font(this.SelectionFont.FontFamily, pFontSize, this.SelectionFont.Style);
        this.SelectionAlignment = HorizontalAlignment;
        this.Select(0, 0);
    }
    #endregion 
```

ScaleFontToFit 可以进行优化以提高性能，但我保持简单，以便于理解。

[在此处下载最新的源代码。](http://www.blakerobertson.com/code/csharp/AutoScalingRichTextBox "单击此处获取源代码和演示应用程序") 我仍在积极致力于开发此控件的项目，因此我很可能会在不久的将来添加一些其他功能和增强功能。因此，请检查该站点以获取最新代码。

我的目标是使用 Mono 框架使这个控件在 Mac 上工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-27T04:45:04.313

我对 Windows 窗体托管窗口的面板中的文本框有类似的要求。（我将面板注入到现有表单上）。当面板的大小发生变化（在我的情况下）时，文本将调整大小以适合框。代码

```
parentObject.SizeChanged += (sender, args) =>
{
   if (textBox1.Text.Length > 0)
   {
       int maxSize = 100;

       // Make a Graphics object to measure the text.
       using (Graphics gr = textBox1.CreateGraphics())
       {
            for (int i = 1; i <= maxSize; i++)
            {
                 using (var test_font = new Font(textBox1.Font.FontFamily, i))
                   {
                        // See how much space the text would
                        // need, specifying a maximum width.
                        SizeF text_size =
                                    TextRenderer.MeasureText(
                                        textBox1.Text,
                                        test_font,
                                        new Size(textBox1.Width, int.MaxValue),
                                        TextFormatFlags.WordBreak | TextFormatFlags.TextBoxControl);

                                try
                                {
                                    if (text_size.Height > textBox1.Height)
                                    {
                                        maxSize = i - 1;
                                        break;
                                    }
                                }
                                catch (System.ComponentModel.Win32Exception)
                                {
                                    // this sometimes throws a "failure to create window handle" error.
                                    // This might happen if the TextBox is invisible and/or
                                    // too small to display a toolbar.
                                    // do whatever here, add/delete, whatever, maybe set to default font size?
                                    maxSize = (int) textBox1.Font.Size;
                                }
                            }
                        }
                    }

                    // Use that font size.
                    textBox1.Font = new Font(textBox1.Font.FontFamily, maxSize);

                }
            }; 
```

# javascript - 有没有办法让 JavaScript 文件在 AIR 中加载另一个文件？

> ID：791834
> 
> 赞同：0
> 
> 时间：2009-04-26T23:34:38.680
> 
> 标签：javascript, air

我一直在尝试用 JavaScript 为 AIR 应用程序构建自己的（小）框架，但遇到了一个特殊的问题：我找不到 JavaScript 文件加载另一个文件的方法。似乎加载 JavaScript 的唯一方法是让 HTML 文件加载它。

它是否正确？JavaScript 文件真的没有办法加载另一个文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T03:10:06.070

您是否尝试过创建脚本元素、设置 src 属性并将其添加到文档正文？我不认为通常的 document.write() 诡计有效，但我很确定应该添加一个脚本元素。

（*我相信所有路径都相对于 Air 应用程序本身的根目录。*）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T09:07:15.353

应用程序沙盒模式中的安全限制不允许在加载事件之后实例化任何新的 JavaScript 代码（在该事件期间，您仍然可以加载和评估 JS）。

至于加载数据，您应该能够在任何时候使用 XHR 检索您想要的任何文本数据，而不受任何限制。

# java - java线程提前终止且可疑

> ID：791835
> 
> 赞同：5
> 
> 时间：2009-04-26T23:34:55.730
> 
> 标签：java, multithreading

我在传递给线程 t 的 Runnable 中有以下代码：

```
public void run() {
        logger.debug("Starting thread " + Thread.currentThread());

        try {
            doStuff();
        } catch (Exception e) {
         logger.debug("Exception in Thread " + Thread.currentThread());
        } 

        logger.debug("End of thread " + Thread.currentThread());
    } 
```

我遇到了一个错误，我在以下情况下看到死锁

*   我的日志只打印了线程消息的开头
*   线程转储显示线程 t（应该正在执行这个）不再运行

有没有什么神奇的方法可以让这个线程提前终止而不记录线程结束消息或抛出异常？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-26T23:51:20.120

你确定`doStuff()`没有抛出一个`Error`？更改`catch (Exception e)`为`catch (Throwable t)`。在 Java 中使用 杀死线程是可能的`Thread.stop()`，但这是极不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T00:01:14.230

你确定你在哪里**开始（）**线程，然后你也**加入（）**它吗？

```
Runnable myRunnable=new Runnable(){
  @Override
  public void run(){
    // your original code goes here
  }
};

Thread myThread=new Thread(myRunnable);

myThread.start();

myThread.join(); // magic happens here! it waits for the thread to finish ;) 
```

顺便说一句，**join()**可能会抛出一个**InterruptedException**，所以如果在线程运行时有什么东西打断了你的线程，join 会通过抛出这个异常来通知你。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T00:53:53.153

当你捕捉时`Exception`，你会捕捉到任何`RunnableException`和任何声明的抛出`Exception`，但你不会捕捉到任何延伸的东西`Error`。如果你真的想捕捉**任何**东西，那么你需要捕捉`Throwable`。

如果您只想为记录目的而这样做，并且您不关心线程退出的原因，您可以这样做：

```
public void run() {
  logger.debug("Starting thread " + Thread.currentThread());
  try {
    // The work of your Thread
  } finally {
    logger.debug("End of thread " + Thread.currentThread());
  } 
} 
```

并且该`finally`语句保证执行，除非线程停止或死锁或以其他方式停止执行而没有异常。

在我的大多数程序中，我安装了一个[UncaughtExceptionHandler](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.UncaughtExceptionHandler.html)以便了解每个意外死亡的线程。这对跟踪故障有很大帮助。这是从 Java 5 开始添加到该语言中的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T23:44:47.080

当然，线程可能会在`try/catch`块结束之后但在最后一条`logger.debug`语句之前被中断。在这种情况下，它会抛出一个`InterruptedException`原则上可能不会在任何地方记录的情况（如果默认异常处理程序设置为忽略此类事情）。

不过，这似乎是一个不太可能发生的情况……不过，如果不了解程序的其余部分，就很难知道发生了什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T06:22:50.273

每当您捕获一般异常时，我建议您记录它，以便您知道异常是什么以及它导致的。不这样做根本不会帮助你。

# groovy - Groovy 语言有多稳定？

> ID：791837
> 
> 赞同：23
> 
> 时间：2009-04-26T23:35:45.430
> 
> 标签：groovy

我们正在用 Java 编写一个大型生产系统，我正在考虑是否可以用一种基于 JVM 的动态语言编写一些组件。从 Java 互操作性的角度来看，Groovy 似乎是最佳选择。但是，Groovy 实现是否足够可靠，可以在生产环境中使用（我假设如此），Groovy 语言规范本身是否足够稳定，以至于我们不必在一两年内大幅修改我们的生产代码？你有什么经验？

总结 (5/30/09)：很好的评论，我的感觉是在将 Groovy 用于关键任务生产用途时应该谨慎，它适用于诸如组合测试用例之类的辅助用途，并且有一个中间立场可能很好，但先做你的功课。性能是一个问题，需要与开发人员生产力的提高相平衡。基于 Groovy 的使用，Bill 和 Ichorus 给出了同样有用的答案，所以这是一次抛硬币。

更新（2009 年 12 月 3 日）：最近我一直在认真研究另一种 JVM 语言[Scala](http://www.scala-lang.org/)。它是由当前 javac 编译器的原作者和 Java Generics 的共同设计者 Martin Odersky 设计和实现的。Scala 是一种强类型，但使用类型推断来去除大量样板。它是面向对象和函数式编程的完美结合。詹姆斯·高斯林[喜欢它](http://www.adam-bien.com/roller/abien/entry/java_net_javaone_which_programming)。Groovy 的作者 James Strachan[也喜欢它](http://java.dzone.com/articles/scala-long-term-replacement)。而 Odersky 编写 javac 的经验意味着 Scala 的原始[性能与 Java](http://shootout.alioth.debian.org/u32q/benchmark.php?test=all&lang=all&lang2=java&box=1)不相上下，令人印象深刻。

更新（2011 年 4 月 26 日）：看看[Groovy++](http://code.google.com/p/groovypptest/)，它是 Groovy 的静态类型扩展，其[性能](http://code.google.com/p/groovypptest/wiki/Performance)与 Java 相当。看起来很有趣。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-27T01:19:36.757

*编辑*：差不多四年后，Groovy 变得更加稳固。

**我可以全心全意地推荐它用于生产级项目。**

* * *

我一直在使用 Groovy 来支持生产应用程序，为此它足够稳定。至于在真正的生产代码中实际拥有 Groovy；我不认为我会那样做。Groovy 做了太多令人惊讶的事情。在过去一年左右的时间里，它在这方面已经变得更好了，但是每隔一段时间我就会遇到一个由于生成的代码而有点难以追踪的错误（我的问题似乎围绕着范围界定）。

我已经摆脱了 Groovy（尽管我们使用的简单而可靠的东西仍然存在）并使用了 Python（jython 实现），在我看来，这更加可预测。此外，python 在可读性方面胜过 Groovy。

您可以在 Groovy 中编写一些非常有趣的代码，包括闭包和运算符重载等等。

这些语言用于辅助代码的方便和速度……如果需要，可以随时切换。没有一个在生产中。我认为我不会将它们投入生产，除非它是作为一种权宜之计，以便在紧急情况下将一些关键的东西拿出来，或者作为概念或原型的证明。

如果将它投入实际生产，它必须处于最可怕的情况下，我会指派一个人用纯 Java 重写它以供下一个版本使用。我有 98% 的把握在生产中两者都可以，但 2% 的风险太大了。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-04-27T04:56:38.013

我们有几个在 Grails 上运行的生产应用程序（使用 Groovy 作为语言）。到目前为止，没有任何问题产生。至于 JVM 兼容性，看看过去 5 年中 JVM 字节码的变化有多大……就像添加了 1 条指令，但没有一条指令被淘汰。

明年会出现新版本的 Groovy 吗？是的。你会被要求改变他们吗？不。尽管您可能想要，但 1.6 是一个巨大的速度改进。

这给我们带来了 Groovy 的主要缺点，即速度问题。显然，Groovy 比纯 Java 慢。对于某些操作，当前数字最多慢10**倍。**也就是说，您的 CPU 是您应用程序的瓶颈吗？对我们来说，主要是数据库访问和延迟。如果你也一样，如果 CPU 花费 200 毫秒而不是 35 毫秒来处理页面请求，那又有什么关系呢？

这是 Groovy 的唯一问题吗？没有。动态语言有重构困难，因为代码中的任何地方都不一定有完整的类规范。然而，这部分被较小的代码大小所平衡，这使得更容易找到修改代码的地方。

无论如何，Groovy 是一种非常适合生产使用的语言。如果您担心可靠性，请将其与 Java 混合用于您的“关键”代码。这是 Groovy 中最好的部分......它与 Java 类的混合是多么容易。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-27T13:08:52.683

我目前正在探索仅使用 Groovy 编写单元测试。这具有以下效果

1.  允许使用比 Java 更简单的语法来完成编写测试的潜在乏味部分。
2.  使 Groovy 代码脱离生产环境。
3.  允许用非 Java 语言编写大部分代码库。

当然，我们还没有开始，但这至少是我尝试将替代 JVM 语言引入我们的新项目（可能还有现有项目）的方式。我和你有同样的担忧，在性能方面比在稳定性方面更是如此。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-27T00:08:39.643

脚本语言在句法特性方面发展“太快”。

如果您想要一种可以多年保持兼容的 JVM 语言，
**Java**是您唯一的选择；）

顺便说一句，我不认为脚本语言会自动确保代码的可读性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-11T18:41:30.477

在我之前的公司，我们使用 Grails/Groovy 作为我们的主要后端，根据那次经验，我会说在我可能遇到的大多数情况下我会选择 Groovy 而不是 Java，因为它可以与 Java 无缝互操作，并且在其他方​​面更有趣和富有表现力。此外，我希望数据库几乎总是我的应用程序的瓶颈，而不是语言性能，据我记得，我们没有遇到任何 groovy 的稳定性问题/错误。

但就我个人而言，在大多数情况下，这通常不是关于 Groovy 与 Java 的关系——而是关于 Groovy/Java + 可用库与其他语言，如 Python/Jython/JavaScript/Ruby + 可用库。还有很多其他的考虑因素，比如社区的力量、特定应用程序的相关技术的成熟度等。特别是对于 Web 开发，Grails 是不错的，但社区似乎缺乏。我的总体意见是，我会继续使用 python 或 Node.js。如果我需要 JVM，我会使用与 jython 兼容的 Python Web 开发环境。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-10-11T20:32:48.320

我已经用 Groovy 玩了一个月左右。简单性很棒，动态语言功能也很酷。但是，速度绝对是个问题。此外，groovy 控制台真的很糟糕。你不能做你可以做的事情，例如在 python 中。每隔一段时间，我必须重新启动控制台，重新导入，等等。它还会忘记我在控制台模式下放入变量中的值；不知何故，他们神秘地超出了范围。（是因为 JVM 吗？我不知道。）我想不出一个例子，但是我在 Groovy 控制台中得到的行为与我在 Grails 控制台中得到的行为不同，并且与我在脚本中编写代码所得到的不同。

还有几个警告。请注意，Groovy 几乎但不是 100% 兼容 Java。例如，这不会编译：

```
public class HelloWorld {

    public static void main(String args[]) {
        System.out.println( "Hello, world!\n");
    }
} 
```

另请查看[如何在 Groovy 中获取类路径？](https://stackoverflow.com/questions/5212442/how-to-get-classpath-in-groovy/19326531)

# f# - 如何创建“配对”函数以匹配字符串列表？

> ID：791841
> 
> 赞同：1
> 
> 时间：2009-04-26T23:44:18.017
> 
> 标签：f#

[我在F# Wiki Book on List](http://en.wikibooks.org/wiki/F_Sharp_Programming/Lists)上做一个练习（滚动到底部）来创建一个`Pair`方法。

我能够毫无问题地配对一个整数列表，但为字符串列表引发了 F# 异常。对于像我这样的 F# 初学者来说，破译异常意味着什么太神秘了。

这是我最初尝试`Pair`在`fsi.exe`

```
> let pair l =
-     let rec loop acc = function
-         | [] -> acc
-         | (hd1 :: hd2 :: tl) -> loop ((hd1, hd2) :: acc) tl
-     List.rev(loop [] l)
-
- printfn "%A" ([1..10] |> pair)
- printfn "%A" ([ "one"; "two"; "three"; "four"; "five" ] |> pair);;

      let rec loop acc = function
  -----------------------^

stdin(2,24): warning FS0025: Incomplete pattern matches on this expression. 
    For example, the value '[_]' will not be matched

val pair : 'a list -> ('a * 'a) list

[(1, 2); (3, 4); (5, 6); (7, 8); (9, 10)]
Microsoft.FSharp.Core.MatchFailureException: 
Exception of type 'Microsoft.FSharp.Core.MatchFailureException' was thrown.
   at FSI_0002.clo@2T.Invoke(List`1 acc, List`1 _arg1)
   at FSI_0002.pair[T](List`1 l)
   at <StartupCode$FSI_0002>.$FSI_0002._main()
stopped due to error 
```

`Pair`整数版本
和函数签名也是如此

```
val pair : 'a list -> ('a * 'a) list 
```

表示`Pair`对通用列表进行操作。

**问题：**那为什么`Pair`不能在字符串列表上工作？

**[ANSWER]**（我的版本）
简单地返回`else`case (_) 的累积列表就可以了。
警告也得到了处理。

```
let pair l =
    let rec loop acc = function
//        | [] -> acc
        | (hd1 :: hd2 :: tl) -> loop ((hd1, hd2) :: acc) tl
        | _ -> acc
    List.rev(loop [] l)

printfn "%A" ([1..10] |> pair)
printfn "%A" ([ "one"; "two"; "three"; "four"; "five" ] |> pair) 
```

**[EDIT2]**好吧，为了完整起见，我还将发布我的版本`Unpair`。

```
let unpair l = [for (a,b) in l do yield! a :: b :: []] 
```

这是使用解决方案版本针对我的 100 万个项目列表进行的一些有缺陷的基准测试

```
#light

open System;

let pn l = printfn "%A" l

let duration f = 
    let startTime = DateTime.Now;
    let returnValue = f()
    let endTime = DateTime.Now;
    printfn "Duration (ms): %f" (endTime - startTime).TotalMilliseconds
    returnValue

let ll =  [for a in 1..1000000 do yield (a)]
let tl = [for a in 1..1000000 do yield (a,a)]

let pair1 l =
    let rec loop acc = function
        | [] | [_] -> List.rev acc
        | h1 :: h2 :: tl -> loop ((h1, h2) :: acc) tl
    loop [] l

let unpair1 l =
    let rec loop acc = function
        | [] -> List.rev acc
        | (h1, h2) :: tl -> loop (h2 :: h1 :: acc) tl
    loop [] l

let pair2 l =
    let rec loop acc = function
        | (hd1 :: hd2 :: tl) -> loop ((hd1, hd2) :: acc) tl
        | _ | [_] -> acc
    List.rev(loop [] l)

    let unpair2 l = [for (a,b) in l do yield! a :: b :: []]

pn(duration (fun() -> ll |> pair1))
pn(duration (fun() -> tl |> unpair1))

pn(duration (fun() -> ll |> pair2))
pn(duration (fun() -> tl |> unpair2)) 
```

基准测试结果：

```
Solution version
PAIR -> Duration (ms): 255.000000
UNPAIR -> Duration (ms): 840.000000

My version
PAIR -> Duration (ms): 220.000000
UNPAIR -> Duration (ms): 1624.000000 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T23:53:43.343

我不认为您的 Pair 版本适用于奇数列表。您碰巧测试了偶数个整数和奇数个字符串。我认为您要匹配的第二个论点意味着至少包含两个成员的列表。因此，您断开 2 断开 2 并获得一个包含 1 个元素的列表，并且您的条件都不匹配。

[_] 是一个包含任何内容的 1 项列表。您必须提供与其匹配的谓词。

# java - XMPP 客户端不兼容

> ID：791846
> 
> 赞同：1
> 
> 时间：2009-04-26T23:49:02.840
> 
> 标签：java, client, xmpp, instant-messaging

我目前正在开发一个项目，该项目正在构建一个基于 java 的桌面应用程序以与网站交互。我们想要整合 IM 功能，所以我们决定使用 XMPP。

问题是我们的应用程序有其他功能，任何使用另一个客户端连接到我们的 XMPP 服务器的人都会导致我们的网站出现问题（例如，我们的客户端将能够发送具有用户无法发送的特定消息类型的消息）使用，但与另一个客户端他们可以发送这些消息类型）。

有没有人可以只允许我们的客户端访问 XMPP 服务器或阻止其他客户端使用某些功能？我知道这违背了开放标准的想法，但我们不想从头开始构建专有的 IM 解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T00:18:21.490

您*正在*构建一个专有的解决方案，它可能不是完全从头开始，这不一定是一件坏事。但请不要将其称为 XMPP 服务，除非您要支持 XMPP 客户端。您将获得与需要您的专有浏览器的“网站”相同的反应。

对于可以协商的功能，请查看[功能协商](http://xmpp.org/extensions/xep-0020.html)，您可能会说您的服务器对其他客户端没有特定功能，但您自己的秘密支持它。这实际上不会阻止尝试进行某些操作，因此这是一个非常糟糕的解决方案。

您可以在不构建桌面应用程序的情况下获得即时消息传递功能（所有的平台支持都令人头疼）。考虑一下[Orbited](http://orbited.org/ "轨道的")，它可以为您提供所需的即时消息交互性，并且可以更轻松地集成到服务器上。

顺便说一句，不应该有任何消息会导致您的网站出现问题，也不应该有导致问题的 URL 或查询组合等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T13:54:37.707

不确定您的所有要求，但听起来您可能可以使用 XMPP 的 pubsub 或 pep 功能。这些是 XMPP 的扩展，允许您创建可以在用户到用户级别访问的专用有效负载（个人事件协议 XEP-0163）。如果它只是对所有感兴趣的人的一般通知，那么 PubSub (XEP-0060) 可能就是你想要的。

这些协议允许保护对 pubsub 节点的访问，并且不会受到标准聊天消息的影响，因为它们是不同的协议。

# iphone - 如何合并我的 Xcode 项目文件？

> ID：791854
> 
> 赞同：4
> 
> 时间：2009-04-26T23:52:32.847
> 
> 标签：iphone, xcode

当我开始开发我的第一个应用程序时，我假设将文件拖到 xcode 中会将它们放在我项目的实际目录中。不是这样。显然 Xcode 在桌面上引用了它们。

有没有一种简单的方法可以将所有引用的文件复制到项目目录中？我的桌面很乱。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T18:56:45.343

使用 Finder 将所有文件重新定位到您想要的位置。然后，打开您的 Xcode 项目，对于每个丢失的文件（以红色显示），使用 Get Info 命令并编辑路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T18:53:12.573

将引用添加到 Xcode 项目后，确实没有直接的方法可以做到这一点。一种解决方案（虽然乏味且有点吓人）是从 Xcode 中删除引用并将这些文件重新拖动到您的项目中，并选中“复制文件...”选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-16T20:22:45.437

即使您在拖入文件时选中“复制文件...”复选框，它也会在“必要时”完成，而不会告诉我们何时认为不需要复制文件。我发现检查捆绑包是否独立的最佳方法是将其压缩为 .zip（整个文件夹），将其移动到临时文件夹，解压缩然后浏览所有文件，或者简单地编译并跑。

令人惊奇的是，Xcode 没有像 iTunes 那样的整合功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T23:56:58.267

在 Xcode 中，您可以右键单击项目并选择“添加 -> 现有文件...” 当您选择了所有文件后，单击“添加”，然后选中顶部的复选框“复制文件...”

# c++ - 我应该使用 C++ 选择哪个 Windows GUI 系统？

> ID：791856
> 
> 赞同：1
> 
> 时间：2009-04-26T23:55:23.933
> 
> 标签：c++

现在有很多方法可以编写 Windows 应用程序，win32、MFC、ATL、.NET、WinForms，可能还有一些我不知道的其他方法。我应该选择哪一个？我想要一个可以在全新安装的 Vista 上运行的、现代且易于使用的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-26T23:58:06.237

我强烈推荐[Qt](http://qt.nokia.com/)。它是跨平台的，非常易于使用并获得 LGPL 许可。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-27T00:15:40.373

如果您是 C++ 的业余爱好者，那么学习 WinForms 会比任何本机 Visual C++ 框架（Win32、MVC 等）都容易得多。WPF 将为您提供全方位的最佳服务。它比 WinForms 更难掌握，但可以管理，因此可以让你远离讨厌的 Win32 东西。

原生框架很好，主要是如果您想处理最后一点性能或需要为诸如外壳扩展之类的东西保持较小的占用空间。

我建议至少首先检查 WinForms 以快速了解这些原则。如果 WinForms 不适合您，那么如果您觉得需要更多低级控制，则可以使用 C++；如果您希望获得更多闪亮的功能，例如皮肤和主题，则可以使用 WPF。

**编辑：**
尽管如果您查看 WPF，请记住新的 Vista 仅包含 .Net 3.0，因此 3.5 和 3.5 SP1 功能需要单独的运行时安装。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T09:16:23.663

实际上，从 Qt 开始很容易——你会得到一个完整的 SDK，包括。一个非常好的 IDE，作为一个简单的包和一个智能集成到 VisualStudio。

加上允许任何人编写开源和闭源/商业应用程序而无需支付任何费用的 LGPL 许可——商业支持/许可是可选的！

Qt 的最大优势是非常容易学习和非常干净的 C++ API，它可以做的不仅仅是构建 GUI 应用程序（它支持低级网络和文件 io 等）。

最好的问候，克里斯

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T00:03:56.860

简短的回答......这取决于。

你的技能/背景是什么？为什么要开发桌面应用程序？是为了工作还是作为实验让你学习新东西？是否会有多个其他开发人员在研究它，他们的技能是什么？

我个人的偏好是 winforms，因为这是我花费最多时间编写代码的（在 C# 中）。它们组合起来非常迅速，并且 VS IDE 非常快速且稳定地构建应用程序的 UI 元素。您可以使用 Click Once 发布/部署它们，这允许在您进行更改和更新时轻松更新客户端。

或者，您可能想查看 WPF，它是 .NET 3.5 中的新 Presentation Foundation。这将允许您为桌面应用程序利用更新的“更闪亮”的 UI 体验。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T00:09:59.013

使用 Scenic Ribbon，直接 Win32 会变得更好。适用于 Vista 和 Windows 7。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-27T00:17:27.407

我可能有偏见（我们不是所有人吗？），但是由于您的问题表明您对**Windows**开发感兴趣并且您想要一个**现代**且**易于使用**的 GUI 框架，该框架可与**Vista**开箱即用，显而易见的答案是**.NET WinForms**。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-27T07:21:05.437

我个人更喜欢gtkmm。尽管它看起来不如 Qt 或 Windows 上的原生框架，但我认为 API 是我尝试过的所有框架中最透明的。感觉很OOish，而且很容易学。您可以使用 Glade 轻松创建 GUI 布局，但您也可以仅使用代码创建体面的设计。在这方面，gtkmm 类似于 Java GUI 编程。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-27T14:37:27.137

我会推荐 WxWidgets。API易于理解；它有很好的样本记录；它是跨平台的。如果您正在编写一个将拥有大量用户的应用程序，您最终会希望可以选择在不同的操作系统上运行它。通过选择仅适用于 Microsoft 的 API，您将永久置身于 Microsoft 角落。退出将需要对您的软件进行认真的重构，这将需要您学习另一个 API。听从我的建议，从跨平台 API 开始——它会在未来为您省去很多麻烦。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-27T14:42:59.620

我会推荐[C++Builder 2009](http://www.codegear.com/products/cppbuilder)，它可以创建适用于 Windows 2000、XP 和 Vista 的应用程序。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-27T14:46:02.077

如果你走微软路线，一定要检查他们最近在哪些框架上投入了最多的精力。例如，MFC 是一个较旧的框架，不应该用于新开发，因为 MS 没有在其中投入任何时间，而且附加 MFC 组件的市场已经枯竭并被吹走。

基本上，在选择 MS 支持的技术时，请确保您选择一种尚未淘汰的技术。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-27T15:04:03.220

所以你是一个只有 PHP 知识的学生？甚至在考虑使用 GUI 之前，您就需要使用适当的语言来加快速度。我建议您使用 C#，因为您已经习惯了花括号并且您想对 Windows 进行编程。WinForms 是 .Net 的一部分，而不是一个单独的东西。只需下载 Visual Studio 2008 Express 即可启动并运行。顺便说一句，任何语言的 GUI 编程都很难，尤其是在您从玩具程序阶段过渡到真正的应用程序之后。

如果您对 C++ 有更高的了解，我会建议您使用 Qt。仅仅因为新的 LGPL 许可消除了最后的障碍。它还具有跨平台、高质量、高性能的特点，现在拥有一家大公司（诺基亚）的资金支持，以确保进一步发展。

# sql - 循环数据库关系。好，坏，例外？

> ID：791868
> 
> 赞同：2
> 
> 时间：2009-04-27T00:06:58.117
> 
> 标签：sql, rdbms, entity-relationship, relational-model

一段时间以来，我一直推迟开发我的应用程序的这一部分，纯粹是因为我想以一种循环的方式来做这件事，但是从我记得我的讲师在学校告诉我的事情中感觉这是一个坏主意。

我有一个订单系统的设计，忽略了与这个示例无关的所有内容：

*   信用卡
*   顾客
*   命令

我想要这样，

*   客户可以有信用卡（0-n）
*   客户有订单（1-n）
*   订单有一位客户(1-1)
*   订单有一张信用卡(1-1)
*   信用卡可以有一个客户（1-1）（唯一的 id，所以我们可以忽略 cc 号码的唯一性，丈夫/妻子可以共享 cc 实例等）

基本上最后一部分是问题出现的地方，有时信用卡被拒绝并且他们希望使用不同的信用卡，这需要更新他们的“当前”卡，但这只能更改用于该订单的当前卡，而不是客户可能在磁盘上的其他订单。

这有效地在三个表之间创建了一个圆形设计。

可能的解决方案：要么

创建圆形设计，提供参考：

*   cc 参考订购，
*   客户参考抄送
*   客户参考订购

或者

*   客户参考抄送
*   客户参考订购
*   创建引用所有三个表 id 的新表并在订单上放置唯一的，以便在任何时候只有一个 cc 可能是该订单的最新

本质上，两者都对相同的设计进行建模，但翻译方式不同，此时我最喜欢后一种选择，因为它看起来不那么圆，更中心化。（如果这有道理的话）

我的问题是，

*   如果有的话，每个人的优点和缺点是什么？
*   循环关系/依赖的陷阱是什么？
*   这是该规则的有效例外吗？
*   有什么理由我应该选择前者而不是后者？

谢谢，让我知道您是否需要澄清/解释任何事情。

--更新/编辑--

我注意到我所说的要求中有一个错误。在尝试为 SO 简化事情时基本上丢球了。Payments 那里还有另一个表，它增加了另一个层。问题是，订单可以进行多次付款，并且可以使用不同的信用卡。（如果您真的想知道其他付款方式）。

在这里说明这一点是因为我认为根本问题仍然是相同的，而这只确实增加了另一层复杂性。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T00:16:53.193

一个客户可以关联 0 个或多个信用卡，但关联是动态的 - 它可以来来去去。正如您指出的那样，一张信用卡可以与多个客户相关联。所以这最终是一个 n:m 表，可能带有“活动”的标志列。

一个订单与 0 或 1 张信用卡有静态关系，并且在一次销售完成后，你不能乱动 cc 值，无论 cc 与客户之间的关系发生什么变化。订单表应在销售时独立存储有关 cc 的所有相关信息。没有理由将销售与任何其他表中的任何其他信用卡列相关联（这可能会改变 - 但不会影响销售）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T00:17:42.693

唔？

一个客户有几张信用卡，但只有一张当前的。一个订单有一个分配的卡片。顾客买东西时，先试他的默认卡，否则他可能会更换他的主卡？

我在这里看不到循环引用；当用户的信用卡发生变化时，他的订单保持不变。你的桌子最终会变成：

*   客户：身份证，当前卡
*   信用卡：id、number、customer_id
*   订单：id、Card_id、Customer_id

**编辑：**哎呀，忘记了一个字段，谢谢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T00:24:30.913

我认为问题在于订单的建模。一个订单应该能够与一张以上的信用卡关联，而不是一个订单只有一张信用卡，而其中一张信用卡在任何时候都处于活动状态。本质上，订单和信用是多对多的。为了在 DB 中对此进行建模，您需要引入一个关联表，比如 PaymentHistory。现在，当订单需要新信用卡时，您可以简单地创建一张新信用卡，并将其与订单关联，并将关联的 PaymentHistory 标记为活动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T00:24:40.057

无论您的数据具有循环关系的原因是什么，如果您“忘记”声明其中一个以使您的表具有批量加载顺序，您会更开心。

当您最不期望它时，它会派上用场。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-29T00:46:30.547

这是一岁，但有一些值得一提的观点。

NB 对于在线非账户流程：客户最好定义为买方，并且可能还有另一种类型的客户 - 受益人/收件人。您可以为其他人购买/购买机票和鲜花等，因此这两个角色需要明确区分，因为它们涉及不同的业务流程（一个是支付，另一个是发送货物）。

如果这是一个非帐户流程，那么您不应该保留信用卡详细信息。这是一个安全风险——你保留这些信息会让买家处于风险之中。信用卡是实时处理的，然后信息应该被丢弃。

帐户客户：唯一的例外是当有人开设帐户并提供他们的信用卡信息以供后续购买时使用。在这种情况下，信用卡信息的更改将在交易之外发生 - 作为账户管理流程的一部分。

要点是确保在开始建模和编码之前完全了解业务流程。

# php - 通过 AJAX 将关联数组传递给 PHP

> ID：791876
> 
> 赞同：1
> 
> 时间：2009-04-27T00:13:36.400
> 
> 标签：php, javascript, jquery, ajax

我正在尝试通过 AJAX 将其传递给 PHP 脚本：

```
 var answers={};
  for (x=0; x< allAnswers.length; x++)
   {
       answers.x=new Array();
       answers.x['id']==allAnswers[x]['id'];
       answers.x['val']=$("#field_" + x).val();
   }

   var data={};
   data.id=questions[qId]['id'];
   data['answers']=answers;

   $.post('index.php',data); 
```

PHP 设置为`print_r($_POST)`，这是输出：

```
answers [object Object]

id       3 
```

我做错了什么？

编辑：更改代码以使用数组，即：

```
 var answers=new Array();
   for (x=0; x< allAnswers.length; x++)
   {
       answers[x]=new Array();
       answers[x]['id']=allAnswers[x]['id'];
       answers[x]['val']=$("#field_" + x).val();
   }
   var data={};
   data.id=questions[qId]['id'];
   data['answers[]']=answers;

   $.post('index.php',data); 
```

给出这个 print_r：

```
Array
(
    [id] => 3
    [answers] => Array
        (
            [0] => 
            [1] => 
        )

) 
```

想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T02:13:17.220

替换这个：

```
var answers=new Array();
for (x=0; x< allAnswers.length; x++) {
    answers[x]=new Array();
    answers[x]['id']=allAnswers[x]['id'];
    answers[x]['val']=$("#field_" + x).val();
} 
```

有了这个：

```
var answers = new Array();
for (x=0; x< allAnswers.length; x++) {
    answers[x] = {};
    answers[x]['id']=allAnswers[x]['id'];
    answers[x]['val']=$("#field_" + x).val();
} 
```

你想要一个对象数组，而不是数组数组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T00:34:31.453

你一遍又一遍地重新声明 answers.x，所以你只会得到最后一个。x 是实际的变量名称，而不是您正在考虑的值。此外，您在“allAnswers”行上有一个双重相等。尝试：

```
var answers = new Array();
for (x=0; x< allAnswers.length; x++)
   {
       answers[ x ]=new Array();
       answers[ x ]['id'] = allAnswers[x]['id'];
       answers[ x ]['val'] = $("#field_" + x).val();
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T00:34:01.280

啊，这更有意义；您之前格式化的方式与输入不匹配。

Anyhoo，answers 对象是一个 JavaScript 对象；PHP 不知道如何处理它。我建议您在传递给 PHP 之前解析各个项目，或者在 PHP 端使用 json_decode() 。

# c# - 覆盖 Equals 并与字符串进行比较

> ID：791887
> 
> 赞同：4
> 
> 时间：2009-04-27T00:23:14.787
> 
> 标签：c#, equals

我已经定义了一个带有字符串成员的 C# 类。出于所有目的，将此类视为字符串的子类（除非这是不允许的）。我用它来表示一个与特定格式匹配的强类型字符串字段（我已经大大简化了这一点）。

```
public class field
{
    private readonly string m_field;
    public field(string init_value)
    {
        //Check the syntax for errors
        if (CheckSyntax(init_value))
        {
            m_field = init_value;
        }
        else
        {
            throw new ArgumentOutOfRangeException();
        }
    }

    public override string ToString()
    {
        return m_field;
    }
} 
```

现在，我希望能够将此类直接与任何其他字符串（对象或文字）进行比较。因此，我在课堂上实现了以下内容：

```
public override bool Equals(object obj)
{
    if (obj == null)
    {
        return false;
    }

    return this.m_field == obj.ToString();
}

public override int GetHashCode()
{
    return this.m_field.GetHashCode();
}

public static bool operator ==(field x, Object y)
{
    if ((object)x == null && y == null)
    {
        return true;
    }
    else if ((object)x == null || y == null)
    {
        return false;
    }
    else
    {
        return (x.m_field == y.ToString());
    }
}

public static bool operator !=(field x, Object y)
{
    return !(x == y);
} 
```

现在，当我编写单元测试时，根据我将参数传递给 Assert.AreEqual 的顺序，我会得到不同的结果：

```
string valid = "Some String";
field target = new field(valid);
Assert.AreEqual(target, valid); // PASSES
Assert.AreEqual(valid, target); // FAILS 
```

我假设这是因为在第一个断言中，它调用了 field.Equals()，而在第二个断言中，它调用了 String.Equals()。显然我从错误的角度来处理这个问题。谁能给我一些见解？

另一件事。我不能在这里使用结构（值类型），因为在我的实际情况下，我在基类中定义所有这些并从它继承。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-27T00:28:42.107

基本上你不能做你想做的事——你不可能`string`为了平等的目的而承认你的班级。您将永远无法使其具有自反性-您将永远无法使其遵守`object.Equals`.

我个人会尝试重新设计它，以便您没有将验证作为类型本身的一部分 - 使其成为业务实体（或任何它们）的相关属性的一部分。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-27T00:35:05.897

这在[Effective Java](http://books.google.com/books?id=ka2VUBqHiWkC&pg=PA33&dq=obey+general+contract+equals+java)中作为第 8 条进行了详细描述：在覆盖时遵守一般合同`equals`。

> 该`equals`方法实现了等价关系。

它是自反的、对称的、传递的、一致的，并且对于任何非空引用 x，`x.equals(null)`必须返回`false`。引用的打破对称性的例子与你的相似。

`field`class 知道`string`class，但内置`string`类不知道`field`. 这是一种单向互操作性，应该删除。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-27T00:29:27.657

我会劝阻任何人将您的字段类隐式用作字符串，并强制使用这种类型的用法：

```
string valid = "Some String";
field target = new field(valid);
Assert.AreEqual(target.toString(), valid); 
Assert.AreEqual(valid, target.toString()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T00:57:58.947

根据大家的反馈，以及我自己的需求，下面是我提出的一个可能的解决方案（我正在修改 Equals 方法如下）：

```
public override bool Equals(Object obj)
{
    if (obj == null)
    {
        return false;
    }

    field f = obj as field;
    if (f != null)
    {
        return this == f;
    }
    else
    {
        return obj.Equals(this);
    }
} 
```

这似乎允许它在依赖 Equals 和 GetHashCode 方法来确定值是否已经存在的字典和集合类中正确使用。

此外，现在这些都失败了：

```
string valid = "Some String";
field target = new field(valid);
Assert.AreEqual(target, valid); // FAILS
Assert.AreEqual(valid, target); // FAILS 
```

这些都通过了：

```
string valid = "Some String";
field target = new field(valid);
Assert.AreEqual(target.ToString(), valid); // PASSES
Assert.AreEqual(valid, target.ToString()); // PASSES 
```

这些都通过了：

```
field f1 = new field("Some String");
field f2 = new field("Some String");
Assert.AreEqual(f1, f2); // PASSES
Assert.AreEqual(f2, f1); // PASSES 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T06:02:43.410

这是字符串#Equals

```
public override bool Equals(object obj)
{
    string strB = obj as string;
    if ((strB == null) && (this != null))
    {
        return false;
    }
    return EqualsHelper(this, strB);
} 
```

向 String#Equals 提供除字符串以外的参数将返回 false。我建议“重新考虑”来解决这个问题。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-03-18T17:09:09.350

如果您在内部尝试验证 x 或 y 是否为空，我建议使用**object.ReferenceEquals() 。**

```
public static bool operator ==(field x, Object y)
{
    if (object.ReferenceEquals(x, null) && object.ReferenceEquals(y, null))
    {
        return true;
    }
    else if (object.ReferenceEquals(x, null) || object.ReferenceEquals(y, null))
    {
        return false;
    }
    else
    {
        return (x.m_field == y.ToString());
    }
} 
```

# iphone - iPhone OpenGL ES 2d 背景纹理

> ID：791895
> 
> 赞同：0
> 
> 时间：2009-04-27T00:30:36.970
> 
> 标签：iphone, graphics, opengl-es, textures

我有一个 1024 x 1024 的图像，我在我的游戏中用作背景纹理。

我想知道它们是否是处理绘制大背景纹理的正确方法。

我目前是如何做的：

```
texCoord { 0,0,1,0,0,1,1,1 }
vertice { 0,0,0,height,width,0,width,height }
texCoordPointer(texCoord)
vertexPointer(vertice)

bind the texture
enable client (texCoordArr, vertexCoordArr)
drawArray
disable client (texCoordArr, vertexCoordArr) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T00:50:01.680

没关系...

我不知道 iPhone 上的 GL|ES 是否支持 glDrawTexOES 扩展，但如果支持，您可以保护一些代码行。但它不会使绘图更快。

还有一些额外的提示：

*   尝试使纹理与屏幕一样大。如果实际分辨率在 480*320 左右，则无需将图像存储为 1024*1024。如果您缩放或平移图像，那当然是另一回事了。

*   如果您不为背景上传 mipmap，您可能会节省相当多的内存。

# java - Java 插件模式

> ID：791896
> 
> 赞同：2
> 
> 时间：2009-04-27T00:30:58.340
> 
> 标签：java, plugin-pattern

我是一名 Java 初学者，如果有人能解释如何在 Java 中实现 Martin Fowler 的插件模式，我将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-27T00:37:33.287

简单地说，您为要执行的操作定义一个接口，并在运行时传递一个实现该接口的对象。因此，例如，您可能通过本地共享内存和远程 TCP/IP 进行通信。您构建一个接口，调用它`IConnection`具有`send()`and `recv()`，然后在两个类中实现它，`LocalConnection`and `LongDistanceConnection`。

然后你有一些其他需要交流的类，比方说`TelephoneCall`。

要拨打本地电话，您可以

```
TelephoneCall call = new TelephoneCall(new LocalConnection()); 
```

要拨打长途电话，您可以

```
TelephoneCall call = new TelephoneCall(new LongDistanceConnection()); 
```

并且构造函数的签名是

```
 public TelephoneCall(IConnection connect); 
```

# java - 在 EAR 中获取 JAR 中文件的绝对路径？

> ID：791897
> 
> 赞同：8
> 
> 时间：2009-04-27T00:32:22.300
> 
> 标签：java, file, jakarta-ee, path, jar

我有一个作为 EAR 文件部署的 J2EE 应用程序，该文件又包含一个用于业务层代码（包括一些 EJB）的 JAR 文件和一个用于 Web 层代码的 WAR 文件。EAR 文件被部署到 JBoss 3.2.5，它解压了 EAR 和 WAR 文件，而不是 JAR 文件（这不是问题，只是仅供参考）。

JAR 文件中的一个文件是一个 MS Word 模板，其绝对路径需要传递给一些本机 MS Word 代码（使用[Jacob](http://danadler.com/jacob/)，FWIW）。

问题是，如果我尝试获取这样的文件（从 JAR 文件中的某些代码中）：

```
URL url = getClass().getResource("myTemplate.dot");
File file = new File(url.toURI()); // <= fails!
String absolutePath = file.getAbsolutePath();
// Pass the absolutePath to MS Word to be opened as a document 
```

...然后`java.io.File`构造函数抛出 IllegalArgumentException “URI 不是分层的”。URL 和 URI 都有相同的 toString() 输出，即：

```
jar:file:/G:/jboss/myapp/jboss/server/default/tmp/deploy/tmp29269myapp.ear-contents/myapp.jar!/my/package/myTemplate.dot 
```

这大部分路径在文件系统上是有效的，但其余的则不是（在 JAR 文件内部）：

```
G:/jboss/myapp/jboss/server/default/tmp/deploy/tmp29269myapp.ear-contents 
```

获取此文件的绝对路径的最简单方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T00:38:13.830

我目前的解决方案是将文件复制到服务器的临时目录，然后使用复制的绝对路径：

```
File tempDir = new File(System.getProperty("java.io.tmpdir"));
File temporaryFile = new File(tempDir, "templateCopy.dot");
InputStream templateStream = getClass().getResourceAsStream("myTemplate.dot");
IOUtils.copy(templateStream, new FileOutputStream(temporaryFile));
String absolutePath = temporaryFile.getAbsolutePath(); 
```

我更喜欢不涉及复制文件的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T01:01:51.887

除非您传递 URI 字符串的代码或应用程序接受指定 jar/zip 文件中位置的格式，否则将文件复制到临时位置的解决方案可能是最好的解决方案。

如果经常引用这些文件，您可能希望缓存提取文件的位置，并在每次需要时验证它们的存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T01:30:30.147

您应该将内容复制到临时文件（可能带有缓存），因为尝试访问应用程序容器的内部文件是您要避免的依赖项。甚至可能根本没有提取的文件（它可以直接从 JAR 加载）。

# php - 高效的 PHP 自动加载和命名策略

> ID：791899
> 
> 赞同：39
> 
> 时间：2009-04-27T00:33:30.737
> 
> 标签：php, naming-conventions, spl-autoload-register

像现在的大多数 Web 开发人员一样，我非常享受用于 Web 应用程序和网站的可靠 MVC 架构的好处。在使用 PHP 进行 MVC 时，自动加载显然非常方便。

我喜欢[`spl_autoload_register`](http://www.php.net/spl_autoload_register)简单地定义一个`__autoload()`函数，因为如果您合并不同的基本模块，每个模块都使用自己的自动加载，这显然会更加灵活。但是，我从来没有对自己编写的加载函数感觉很好。它们涉及大量的字符串检查和目录扫描，以寻找可能要加载的类。

例如，假设我有一个应用程序，其基本路径定义为，以及一个包含名为和`PATH_APP`的目录的简单结构。我经常使用一种命名结构，即文件被命名并位于适当的目录中，默认情况下模型通常没有特定的方案。我可能有一个像这样的结构的加载器函数，它被注册到：`models``views``controllers``IndexView.php``IndexController.php``spl_autoload_register`

```
public function MVCLoader($class)
{
    if (file_exists(PATH_APP.'/models/'.$class.'.php')) {
        require_once(PATH_APP.'/models/'.$class.'.php');
        return true;
    }
    else if (strpos($class,'View') !== false) {
        if (file_exists(PATH_APP.'/views/'.$class.'.php')) {
            require_once(PATH_APP.'/views/'.$class.'.php');
            return true;
        }
    }
    else if (strpos($class,'Controller') !== false) {
        if (file_exists(PATH_APP.'/controllers/'.$class.'.php')) {
            require_once(PATH_APP.'/controllers/'.$class.'.php');
            return true;
        }
    }
    return false;
} 
```

如果在那之后没有找到，我可能有另一个功能来扫描模型目录中的子目录。然而，所有的 if/else-ing、字符串检查和目录扫描对我来说似乎效率低下，我想改进它。

我很好奇其他开发人员可能会采用什么文件命名和自动加载策略。我正在寻找专门用于高效自动加载的好技术，而不是自动加载的替代品。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-27T01:09:34.083

这是我在所有项目中一直使用的（直接取自上一个项目的源代码）：

```
public static function loadClass($class)
{
    $files = array(
        $class . '.php',
        str_replace('_', '/', $class) . '.php',
    );
    foreach (explode(PATH_SEPARATOR, ini_get('include_path')) as $base_path)
    {
        foreach ($files as $file)
        {
            $path = "$base_path/$file";
            if (file_exists($path) && is_readable($path))
            {
                include_once $path;
                return;
            }
        }
    }
} 
```

如果我查找 SomeClass_SeperatedWith_Underscores 它将查找 SomeClass_SeperatedWith_Underscores.php 后跟 SomeClass/SeperatedWith/Underscores.php 根植于当前包含路径中的每个目录。

**编辑：**我只是想说明我用它来提高开发效率，而不一定是处理时间。如果您的路径上有 PEAR，那么您可以只使用这些类，而不必在需要它们时包含它们。

我倾向于将我的类保存在目录层次结构中，下划线分解命名空间......如果我愿意，这段代码可以让我保持文件结构整洁，或者如果我愿意，可以注入一个没有嵌套目录的快速类文件（对于将一个或两个类添加到它是被告的图书馆，但不是我目前正在从事的项目的一部分。）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-27T01:34:18.390

我找到了这个解决方案：

我创建了一个脚本，它遍历我的类库文件夹（其中包含单独模块/系统的子文件夹），并解析文件内容以查找类定义。如果它在 php 文件中找到类定义（非常简单的正则表达式模式），它会创建一个符号链接：

```
class_name.php -> actual/source/file.php 
```

这让我可以使用一个简单的自动加载函数，它只需要类名和主符号链接文件夹的路径，而不必进行任何路径/字符串操作。

最好的部分是我可以完全重新排列我的源代码或添加一个新的子系统，然后运行链接生成脚本来自动加载所有内容。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-27T02:12:30.937

如果您想要效率，那么您根本不应该使用自动加载功能。自动加载功能是为了懒惰。包含它们时，您应该提供包含文件的显式路径。如果您的自动加载功能可以找到这些文件，那么您可以编写代码来明确地找到它们。当您处理代码的视图部分并即将加载新的视图类时，通过让自动加载函数处理它，它首先假设您的类是模型类？那是低效的。相反，您的代码应该是：

```
include_once $this->views_path . $class . '.php'; 
```

如果您需要多个“视图”路径，请创建一个加载视图的函数：

```
public function load_view($class) {
    // perhaps there's a mapping here instead....
    foreach ($this->views_paths as $path) {
        $filename = $path . $class . '.php';
        if (file_exists($filename)) {
            include_once $filename;
        }
    }
    throw ....
} 
```

在任何情况下，在包含发生的地方，您都拥有关于您要加载的类的最大/最准确的信息。使用该信息完全加载类是唯一有效的类加载策略。是的，您最终可能会得到更多的类变量或（天堂禁止）一些全局变量。但这比只是懒惰并为您的班级扫描文件系统的某些部分要好得多。

# coldfusion - ColdFusion 中的 CFINVOKE 与 java.lang.OutOfMemoryError

> ID：791904
> 
> 赞同：2
> 
> 时间：2009-04-27T00:35:09.140
> 
> 标签：coldfusion, heap-memory

我遇到了 ColdFusion 堆的问题。这是我正在试验的一个小示例应用程序。我认为在`cfinvoke`调用该`init`方法后它会破坏组件本地的所有变量。但显然情况并非如此。该应用程序如下所示工作，但如果我在其中的循环中添加一个零，`index.cfm`它就会中断。什么存储在堆中导致这种情况？有没有解决的办法？

**索引.cfm：**

```
<cfloop from="1" to="1000" index="i">  
    <cfinvoke component="test" method="init" returnvariable="x">  
</cfloop>  
<cfoutput><p>#x#</p></cfoutput> 
```

**测试.cfc：**

```
<cfcomponent output="false">  
    <cffunction name="init" returntype="string">  
        <cfset var test = structNew()>  
        <cfloop from="1" to="1000" index="i">  
            <cfset test[i] = i>  
        </cfloop>  
        <cfreturn Now()>  
    </cffunction>  
</cfcomponent> 
```

**这是错误消息：**

```
 SEVERE: Servlet.service() for servlet CfmServlet threw exception  
 javax.servlet.ServletException: ROOT CAUSE:  
 java.lang.OutOfMemoryError: Java heap space` 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T12:48:37.817

这是一个已知问题，目前无法解决。似乎 CF 不能正确处理垃圾收集。据我所知，在请求完成之前，它不会破坏和释放组件使用的内存。

正因为如此，取决于你的组件有多少属性将决定你可以创建多少个属性，直到你得到堆错误。

我知道这对你的问题没有帮助，但至少现在你可以采取措施来防止它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T15:31:34.900

rio747 是正确的，在请求结束之前内存不会释放，所以你只是内存不足。我敢说您可能可以运行它并得到错误，删除 0 它将运行；java垃圾收集正在运行，但直到请求结束。

您解决问题的唯一选择是不在单个请求中创建尽可能多的对象（也许更多关于为什么这是必要的信息？）或增加可用于冷融合的内存量。

我不认为这真的是一个问题，或者 CF 没有正确处理垃圾收集；从 java 的角度来看，只要该请求处于活动状态，该对象仍然可以被使用和引用。我的意思是，您对 cfinvoke 及其工作原理是正确的，但这并不意味着 jvm 可以在这些内存位置上实际运行垃圾收集，直到请求结束。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-25T14:05:18.873

我刚刚发布了一个新的博客文章，它展示了如果你的内存低于某个阈值，你可以如何进行程序化垃圾收集。希望它有所帮助：-

[ [http://www.beetrootstreet.com/blog/index.cfm/2009/6/25/Clearing-ColdFusion-memory-using-garbage-collection-when-memory-gets-low][1]](http://www.beetrootstreet.com/blog/index.cfm/2009/6/25/Clearing-ColdFusion-memory-using-garbage-collection-when-memory-gets-low][1])

# sql - PLSQL - 触发器：无法修改映射到非键保留表的列

> ID：791909
> 
> 赞同：0
> 
> 时间：2009-04-27T00:41:33.790
> 
> 标签：sql, plsql, triggers

我想做的是使用触发器来更新库存表中的销售数量，当订单被放置在特许销售表中时（使用插入）。我承认我在 PLSQL 上很烂，所以我不确定我是否以正确的方式去做这件事。我得到的错误是：

```
 SQL> insert into concessions_sold
  2  values(33, 104, '26-Apr-09', 50);
insert into concessions_sold
            *
ERROR at line 1:
ORA-01779: cannot modify a column which maps to a non key-preserved table 
```

`我的代码：`

 ````
 create or replace trigger LabEx5_1 after insert on Concessions_sold
for each row
begin
if inserting then
update
( 
select i.quantity 
from inventory i, concessions_sold cs, concession c
where i.inventory_id = c.inventory_id and c.concession_id = cs.concession_id
)
set quantity = :new.quantity;
end if;
end LabEx5_1;
/ 

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T00:48:58.967

您正在尝试更新触发器中的连接视图，这对何时可以完成有几个限制；有关详细信息，请参阅[Oracle 文档。](http://download.oracle.com/docs/cd/B28359_01/server.111/b28310/views001.htm#insertedID5)

这个 UPDATE 应该做你想要实现的目标：

```
UPDATE inventory i 
 SET i.quantity = :new.quantity 
 WHERE i.inventory_id = 
  (SELECT c.inventory_id 
    FROM concessions c 
     WHERE c.concession_id = :new.concession_id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T01:45:37.723

首先，如果您使用“For Each Row”触发器，那么您不能对整个表进行操作，只能对一行进行操作，所以

```
select i.quantity 
from inventory i, concession c
where i.inventory_id = c.inventory_id and c.concession_id = cs.concession_id 
```

应该改为

```
select i.quantity 
from inventory i, concessions_sold cs, concession c
where i.inventory_id = c.inventory_id and c.concession_id = :new.concession_id 
```

其次，更新应该是这样的：

```
update inventory
set quantity = :new.quantity
where inventory_id = ( 
  select inventory_id from concession c where concession_id = :new.concession_id 
) ; 
```

所以触发器应该是这样的：

```
create or replace 
trigger LabEx5_1 after insert on Concessions_sold
for each row
begin
  if inserting then
    update inventory
      set quantity = :new.quantity
    where inventory_id = ( 
      select inventory_id from concession c 
      where concession_id = :new.concession_id 
    ) ;
  end if;
end LabEx5_1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T02:54:24.767

几件事：

1.  “插入后”和“如果（插入）”是多余的。删除“如果（插入）”，这是不必要的，因为您的触发器仅限于 AFTER INSERT。只需添加更多代码即可阅读。

2.  似乎您正在尝试在售出商品时降低库存。我没有看到你真的这样做。

3.  这是嵌入查询没有与之关联的键。（这是您的错误消息来自）。

```
select i.quantity 
from inventory i, concessions_sold cs, concession c
where i.inventory_id = c.inventory_id and c.concession_id = cs.concession_id 
```

4.  您没有 where 子句，并且您的 inline-select 不会限制从库存表返回的行。如果你确实让它工作，你将更新你的库存表中的每一行。

使您的实际更新子句起作用。

```
 UPDATE (
    SELECT **i.inventory_id**, i.quantity   
    FROM Inventory i
      , Concessions_sold cs
      , Concessions c   
    WHERE i.inventory_id = c.inventory_id   
    AND c.concession_id = **:NEW.concession_id** 
  )
  SET quantity = :new.quantity 
```

现在它的工作有几个问题： 1。链接表是不必要的。2\. 内联 SQL 使这条 UPDATE 语句更难阅读，因此以后更难修改。

我会更明确：

```
 UPDATE Inventory
SET quatity = quanaity - :new.quanity
WHERE inventory_id IN (
  SELECT inventory_id
  FROM Conessions c
  JOIN c.concession_id = :NEW.concession_id
  ) 
```

显然，没有检查是否确实存在库存数量，您可能需要考虑其他一些事情。

所以你的新触发器看起来像这样。

```
 CREATE or REPLACE TRIGGER LabEx5_1 AFTER INSERT ON Concessions_sold
FOR EACH ROW
BEGIN
  UPDATE Inventory
  SET quatity = quanaity - :NEW.quanity
  WHERE inventory_id IN (
    SELECT inventory_id
    FROM Conessions c
    JOIN c.concession_id = :NEW.concession_id
    );
END LabEx5_1; 
```

# process - 找不到半小时未使用的进程

> ID：791912
> 
> 赞同：1
> 
> 时间：2009-04-27T00:42:29.093
> 
> 标签：process, ps

您可以通过以下方式获得地下流程

```
ps ux 
```

我正在寻找一种方法来查找我 30 分钟没有接触过的进程。

**如何找到半小时未使用的进程？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T00:51:04.627

定义“未触及”和“未使用”。`f`您可以在类似 BSD 的系统、`-o`Solaris 和类似 Sys/V 的系统中使用 ps(1) 上的参数找到很多东西。

### 更新

回复评论：

好吧，你可以做到。例如，考虑一个执行周期性 ps 的东西，并将使用的 CPU 时间与时间一起存储。（实际上，您可以通过调用适当系统调用的 C 程序来更好地做到这一点，但这实际上是一个实现细节。）存储采样时间和 PID，并注意 PID 的 CPU 时间在适当的时间间隔内没有发生变化。这甚至可以使用 awk 或 perl 程序来实现，例如

```
while true; do
  ps _flags_
  sleep 30
done | awk -f myprog | tail -f 
```

这样每次 awk 获得`ps`输出时，它都会对其进行处理，识别候选者，并将它们发送出去以显示通过`tail -f`.

但是你很可能有不经常被调用的守护进程；我不清楚单独的 CPU 时间是一个很好的衡量标准。

这就是定义你真正想做的事情的重点：可能有一种方法可以做到这一点，但我想不出*单独*的 ps 标志组合可以做到这一点。

# symbian - 如何为诺基亚等手机的 Symbian OS 开发应用程序

> ID：791916
> 
> 赞同：11
> 
> 时间：2009-04-27T00:46:14.543
> 
> 标签：symbian, nokia, mobile-phones

我想为 Symbian OS 手机开发应用程序，并尝试使用 Java 编程以外的其他途径。我想体验如何使用 C 和 C++ 在手机上编程。

您能否就在开发此类应用程序时使用哪些工具提供一些提示。我的目标是诺基亚手机..

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-27T12:35:01.300

现在 Carbide IDE 全部免费，业余与专业 Symbian OS 开发之间的主要区别是：
- 使用免费开发证书来签署您的应用程序，而不是支付威瑞信和测试机构来识别和验证您的应用程序。
- 使用免费的 GCCE 编译器而不是更优化的 RVCT。

诺基亚论坛绝对是一个很好的资源。
我还建议[http://developer.symbian.org](http://developer.symbian.org)和[http://www.newlc.com](http://www.newlc.com)

无耻插件：了解 Symbian OS 原生 C++ 开发的最新书籍在
[http://www.quickrecipesonsymbianos.com](http://www.quickrecipesonsymbianos.com)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-10-14T06:28:48.467

有两种选择：

*   Symbian C++：按照链接[http://www.developer.nokia.com/Develop/Other_Technologies/Symbian_C++/中的说明进行操作](http://www.developer.nokia.com/Develop/Other_Technologies/Symbian_C++/)

*   Qt C++/QML：详细说明见 [http://www.developer.nokia.com/Develop/Qt/Getting_started/](http://www.developer.nokia.com/Develop/Qt/Getting_started/)

Qt C++/QML 更适合最新的 Symbian 平台应用程序开发。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-27T18:17:13.630

Qt c++ 是最好的选择。我看到许多移动应用程序开发人员正在使用 Qt C++ 开发应用程序。所以我建议使用 Qt C++。

# macos - 无法使用 Launchctl 启动颠覆

> ID：791922
> 
> 赞同：3
> 
> 时间：2009-04-27T00:50:00.697
> 
> 标签：macos, svn, launchd

我正在尝试使用 Launchctl 启动 svnserve 进程，但我一直收到错误消息“没有返回 plist：/Library/LaunchAgents/org.tigris.subversion.svnserve.plist”。这是 svnserve 是 /opt/local/bin/svnserve 的地方，这是 plist 文件有什么想法这里可能有问题吗？

```
<dict>
  <key>Disabled</key>
  <false/>
  <key>Label</key>
  <string>org.tigris.subversion.svnserve</string>
  <key>ProgramArguments</key>
  <array>
      <string>/opt/local/bin/svnserve</string>
      <string>--inetd</string>
      <string>--root=/Users/Sunit/Repositories</string>
  </array>
  <key>ServiceDescription</key>
  <string>SVN Version Control System/string>
  <key>Sockets</key>
  <dict>
    <key>Listeners</key>
    <array>
      <dict>
        <key>SockFamily</key>
        <string>IPv4</string>
        <key>SockServiceName</key>
        <string>svn</string>
        <key>SockType</key>
        <string>stream</string>
      </dict>
      <dict>
        <key>SockFamily</key>
        <string>IPv6</string>
        <key>SockServiceName</key>
        <string>svn</string>
        <key>SockType</key>
        <string>stream</string>
      </dict>
    </array>
  </dict> 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-27T17:57:37.763

该文件不是有效的 XML - 您没有`<string>`正确关闭第 13 行的标签，并且您永远不会关闭最外面的`<dict>`标签。

您可以使用`plutil -lint`来检查属性列表的有效性，或者简单地使用属性列表编辑器、Xcode 或第三方属性列表编辑器以图形方式构建属性列表。

# windows - 如何在我们的应用程序之外控制鼠标指针

> ID：791925
> 
> 赞同：2
> 
> 时间：2009-04-27T00:50:30.180
> 
> 标签：windows, mouse, pointers, screen, capture

我想用我的应用程序控制鼠标指针并能够使用我的程序与其他程序交互，例如我希望我的应用程序能够单击另一个应用程序上的按钮

我应该如何解决这个问题？（任何编程语言都可以，如果您有任何建议，请告诉我）

事后思考：我想在 Windows 操作系统中执行此操作，并想测试我的 GUI 以查看它是否适用于不同的场景。任何语言都适合我，因为这不是最终产品的一部分，但我更喜欢其中一种语言（Python、Java、C# 或 MATLAB）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T00:56:31.273

有很多方法可以做到这一点，你没有提到你的应用程序的任何细节（系统、目标等）。

如果您的目标是简单的自动化，我建议您在 Windows 上编写一个快速的 AutoIt 脚本。[http://www.autoitscript.com/autoit3/index.shtml](http://www.autoitscript.com/autoit3/index.shtml)

如果这不是您要查找的内容，请提供更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T00:56:43.893

好的，这*确实*是特定于操作系统和窗口的。但是您正在寻找的短语是“鼠标抓取”。

正如@Mitch 所建议的那样，除非你有一个*非常*好的理由——比如可能是一个 GUI 测试应用程序？- 然后抓住鼠标并以这种方式弄乱它是*非常*糟糕的形式。

# visual-studio - 如何以编程方式为 Visual Studio 添加跟踪点？

> ID：791930
> 
> 赞同：1
> 
> 时间：2009-04-27T00:53:38.147
> 
> 标签：visual-studio, debugging

我正在寻找一种方法来监视我拥有源代码的正在运行的程序。基本上，当用户运行它时，我需要知道顺序调用了哪些函数和参数。

我可以为所有函数编写跟踪输出代码来实现这一点。但是，我不允许修改源代码。我发现 Visual Studio 2005 中的 Tracepoint 允许我这样做 - 输出日志信息而不修改源。但我需要将它们添加到所有功能中。

由于我有数千个文件和函数，我需要找到一种以编程方式执行此操作的方法。我发现了 DTE.Debugger.Breakpoints.Add 能够添加断点。但是，我找不到任何跟踪点的方法。或者项目的断点信息存储在哪里？我在 sln 或 vcproj 中找不到它。或者有没有办法以编程方式将断点转换为跟踪点？我看到我可以通过更改“当命中”属性对话框手动更改它。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-03-10T18:00:30.170

您应该将断点转换为 EnvDTE80.Breakpoint2。然后你就可以使用

```
breakpoint.BreakWhenHit = false; 
breakpoint.Macro = "YourMacro"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T01:13:07.647

.NET 分析器将允许您查看执行了哪些方法以及每个方法需要多长时间，而无需修改源代码。它基本上将特殊代码注入到已编译的程序集中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-17T20:33:00.703

我认为这是解决方案...这个宏在程序的 Main 方法中添加了一个断点，然后将所有断点转换为跟踪点。

```
Sub AddBreakpointToMain()
     Dim bp As EnvDTE80.Breakpoint2
     Dim bps As EnvDTE.Breakpoints

     bps = DTE.Debugger.Breakpoints.Add("Main")
     For Each bp In bps
         bp.Tag = "SetByMacro"
         bp.BreakWhenHit = False
         bp.Message = "Hi, this is your tracepoint calling."
     Next
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-17T05:05:43.003

解决方案的第一部分：

DTE.ExecuteCommand("EditorContextMenus.CodeWindow.Breakpoint.InsertTracepoint")

它打开光标所在行的 TP 窗口。不过，您仍然必须点击 Return 才能选择 OK。足以满足我的需求-至少您不必右键单击等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T02:48:19.913

您还可以查看面向方面的编码。据我了解，这将更改由属性控制的编译程序集，通常用于向所有方法/属性添加跟踪。

[如何将 Trace() 添加到 C# 中的每个方法调用？](https://stackoverflow.com/questions/559148/how-can-i-add-a-trace-to-every-method-call-in-c)

# c++ - 何时将对象值添加到堆上的向量是安全的？

> ID：791937
> 
> 赞同：1
> 
> 时间：2009-04-27T00:56:51.663
> 
> 标签：c++

假设我有一个名为 vertex 的结构，它有一个添加两个顶点的方法：

```
struct vertex {
    float x, y, z;

    // constructs the vertex with initial values
    vertex(float ix, float iy, float iz);

    // returns the value c = this + b
    vertex operator+(vertex b);
};

vertex::vertex(float ix, float iy, float iz){
    this->x = ix; this->y = iy; this->z = iz;
}

vertex vertex::operator+(vertex b){
    vertex c;
    c.x = this->x + b.x;
    c.y = this->y + b.y;
    c.z = this->z + b.z;
    return c;
} 
```

在另一个调用函数中，我想将两个顶点添加在一起并将结果添加到`vector<vertex*>`. 什么时候可以安全地使用返回的值添加到给定的向量中？如果从来没有，我将如何实现它？

例如，

```
vector<vertex*> v;
vertex a(1, 2, 3);
vertex b(4, 5, 6);
v.push_back(&(a + b)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T01:01:12.917

这是不安全的，因为您正在存储指向自动或临时变量的指针，该指针将在当前函数终止时被回收。

将动态分配的对象与自动分配的对象混合是一个严重的风险。有时最好的策略是完全禁止自动分配（例如，通过将构造函数设为私有并使用工厂方法创建新实例）。然后，您将负责在某些时候消除这些。

第二种选择（不一定是您想要的）是按价值做所有事情。有一个顶点向量而不是顶点*，并且在存储顶点时只复制顶点。你的类的编写方式，所有字段都是原语，所以这可能已经足够好了，你不会遇到性能或深拷贝语义问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T01:03:46.047

它永远不会保存，因为您将指向临时对象的指针添加到向量中。该临时对象将在该行执行后被销毁，从而使向量具有无效指针。

你有两种可能。要么不将指针存储在向量中`vector<vertex>`而是使用 a ，要么在添加临时对象时显式分配临时对象的新副本：

```
v.push_back(new vertex(a+b)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T01:10:56.280

另一种选择是将智能指针插入 std 容器，例如 boost:shared_ptr，因为共享指针将为您处理内存管理。但是，您需要从 Shared_Ptr vertex::operator+(vertex b) 返回一个共享指针，这意味着返回值仍将在堆上。

如果您不熟悉 boost:shared_ptr，那么只需按照其他帖子的建议按价值做所有事情。这实际上是 stl 标准做法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T01:31:09.710

这是不安全的，因为您添加到向量中的顶点值**不在**堆上。返回的顶点对象在堆栈上，因此一旦当前函数终止，它们的内存位置可能会被覆盖。如果向量（或其副本）在当前函数结束后仍然存在，则无法保证其指针仍将引用有效的顶点对象。

这种情况最危险的部分是这些顶点对象可能会在创建它们的函数结束后很长时间在内存中存活。我曾经看过一个这样的例子，一个学生在一个很长的构造函数中用指向值对象的指针填充了一个向量。向量是对象中的成员字段，所以在构造函数结束后它仍然存在。因为构造函数很长，所以向量指向的值对象直到另一个函数执行到一半才被覆盖。在调试器中观察向量的内容会产生令人困惑的错觉，即对象在内存中自发损坏。

除非您确实需要将这些顶点存储为指针，否则最安全的策略是将它们存储为向量中的值对象：`vector<vertex>`而不是`vector<vertex*>`. 您仍然可以将不同的运算符链接在一起；事实上，将它们一起更改为值对象应该更容易，因为您不会经常需要取消引用指针。

# dependency-injection - 关于工厂模式和依赖注入的得墨忒耳定律

> ID：791940
> 
> 赞同：2
> 
> 时间：2009-04-27T00:57:56.577
> 
> 标签：dependency-injection, law-of-demeter

我有一个关于依赖注入的问题。

说我想创建一个类，调用它，WebGetTask

WebGetTask 需要对 HttpService 的依赖

错误代码 1 代码：

```
private HttpService  httpService;
...   
List<WebGetTask> list = new ArrayList<WebGetTask>();   
for(...)   
{   
   list.add(new WebGetTask(httpService)); 
}
... 
```

行。我知道这很糟糕，因为 httpService 被注入，但它从未使用过，除了在新的 WebGetTask 上创建

好的坏代码2代码：

```
private WebGetTaskFactory webGetTaskFactory;
...  
List<WebGetTask> list = new ArrayList<WebGetTask>();  
for(...)  
{   
    list.add(webGetTaskFactory.newTask());  
}  
... 
```

我认为这更好，因为我们使用工厂但是...但是..

从我站的地方，我可以看到在 WebGetTaskFactory 中我们仍在注入一个 HttpService 并且除了创建一个新的 WebGetTask 的唯一目的之外没有对它做任何事情

所以回顾一下我的问题是我如何设计一个工厂类（WebGetTaskFactory），当新对象在其构造函数上需要依赖项（HttpService）而不简单地注入和传递依赖项（HttpService）时创建新对象（WebGetTask）？或者更确切地说，这是这样做的方法吗？如果是这样，那么一切都很好，如果不是，那么请指导我如何正确使用DI和工厂模式。谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-27T01:15:37.233

我将假设您显示的代码是 DownloadManager 类的一部分，并且您通过构造函数注入依赖项。在这种情况下，我希望将所有内容粘合在一起的启动代码如下所示：

```
IHttpService httpService = new HttpService();
IWebGetTaskFactory webGetTaskFactory = new WebGetTaskFactory(httpService);
IDownloadManager downloadManager = new DownloadManager(webGetTaskFactory); 
```

DownloadManager 类只知道 IWebGetTaskFactory 接口。它不知道IHttpService，从而满足得墨忒耳定律。

**编辑：**重新阅读您的问题后，您似乎担心您没有“使用”工厂中的 HttpService，除非将其传递给新的 WebGetTask。还行吧。WebGetTaskFactory 和 WebGetTask 都需要一个 HttpService 实例来完成它们的工作。这并不违反得墨忒耳定律。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T01:14:56.440

好的，在 LoD 下传递一个实现对象（构造函数中的一个“插件”）并没有什么特别的错误。重要的是该类的接口并没有告诉您太多*关于*该实现的信息。

如果您的 WebGetTask 接口依赖于 HttpService 的确切实现，*则*违反了得墨忒耳定律。

这里的技巧是考虑 WebGetTask 的接口签名。这个名字本身就表明你没有完全遵循得墨忒耳法则——或最少知识原则——因为你定义了一个类（1）被定义为特定于网络，而（2）是一个动词的一个名词。

现在，这些都不一定是错误的，但如果你愿意的话，它们都是“OO 气味”，这表明你可能没有足够客观地思考。

因此，让我们尝试“重构”设计。首先，考虑一个没有与之关联的“网络”的 GetTask。然后，您可以在构建时或稍后构建一个服务对象并将其传递。如果是 HttpService，那很好，但是您的类的用户不需要任何关于幕后内容的信息。

第二件事，让我们把它变成一个名词。称它为 TaskFactory——你的直觉引导你到那里——带有一个接受 IOService 的 ctor，我刚刚发明了它作为由 HttpService 实现的抽象接口。

现在，你有（这是一种 Java/C++ 伪代码，不要对语法细节感到兴奋）：

```
 class Task { ... }
 class TaskFactory {
    public TaskFactory(IOServer svc){...}
    public Task get(){...}
 } 
```

你通过写作来使用它

```
 TaskFactory fac = new TaskFactory(new HttpService());
 Task tsk = fac.get(); 
```

现在，我们至少了解 TaskFactory、IO 服务和 Tasks 的内部结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T01:27:44.583

DI 有两种方式：第一种是构造函数，当只注入一两个对象时很有用，另一种是 setter（实际上根据需要设置多个 setter）。

如果您想对 DI 使用工厂方法，原则上它与基于构造函数的方法相同。

示例 1，对于构造函数 DI：

```
list.add( new WebGetTask( httpService ) ) ; 
```

示例 2，对于设置器 DI：

```
WebGetTask webGetTask = new WebGetTask();
webGetTask.setHttpService(httpService);
// set other dependencies
list.add(webGetTask); 
```

当您需要在创建行为可能不同但具有相同接口（即 LoD）的对象时需要使用一些更大的逻辑时，工厂方法最适合。让我们假设有一个基于工厂参数动态实现的 DownloadManager 接口。

示例3，创建逻辑封装成工厂方法：

```
public static DownloadManager createDownloadManager(HttpService httpService){

    if(null!=httpService){
      WebGetTask webGetTask = new WebGetTask();
      webGetTask.setHttpService(httpService);
      // set other dependencies
      return new DownloadManagerImpl1(webGetTask);
    } else {
      return new DownloadManagerImpl2();
    } // if-else
} 
```

# c# - 如何将不同的请求对象传递给相同的格式化方法？

> ID：791946
> 
> 赞同：0
> 
> 时间：2009-04-27T01:04:55.000
> 
> 标签：c#

编辑问题：这应该很清楚。

```
 using System;

        namespace UpdateDateTimeFields
        {
        class Program
        {
        static void Main(string[] args)
        {
        string dateTimeFormat = "dd/MM/yyy HH:mm:ss";

        DateTime time = DateTime.Now;
        Update(time, dateTimeFormat);  //Should update time

        movemnet mymove = new movemnet();
        mymove.FromDate = DateTime.Now;
        mymove.ToDate = DateTime.Now;
        mymove.Name = "Test_Movement";
        Update(mymove, dateTimeFormat); //should update FromDate, ToDate

        ParentClass cls = new ParentClass();
        cls.mv.FromDate = DateTime.Now;
        cls.mv.ToDate = DateTime.Now;
        cls.CurrentDate = DateTime.Now;
        cls.Comment = "ParentClass_Comment";
        Update(cls, dateTimeFormat); //should update FromDate, ToDate, CurrentDate

    }

    private static void Update<T>(T Request, string format)
    {
       // How can this be acheived ???

        //tried with Using Reflection to Get and Set values of Properties - NO JOY !!!
    }
}

internal class movemnet
{
    public DateTime FromDate { get; set; }
    public DateTime ToDate { get; set; }
    public string Name { get; set; }
}
internal class ParentClass
{
    public movemnet mv { get; set; }
    public DateTime CurrentDate { get; set; }
    public string Comment { get; set; }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T01:48:41.867

你不应该这样做。如果您希望您的班级以特定格式公开*属性，您应该让您的班级这样做。*您不应该公开任何班级的*字段*。您应该在头脑中和代码中将数据本身和数据*视图*分开。

您绝对不应该使用反射来遍历类中的每个字段，检查 DateTime 的类型并设置格式。你绝对不应该做类似...

```
var fields = req1.GetType().GetFields( 
   BindingFlags.Instance | BindingFlags.NonPublic )
  .Where( f=> f.FieldType == typeof( DateTime ) ); 
```

只是输入那个代码我觉得很脏。:)

# c# - 如何防止以下代码中出现 StackOverflow 错误？

> ID：791947
> 
> 赞同：1
> 
> 时间：2009-04-27T01:07:50.717
> 
> 标签：c#, console

我有以下代码为 WCF 控制台托管应用程序提供自动刷新功能。

当 Console.ReadKey 接受无效字符时，它会重新启动 ReadKey 方法。如果用户在此代码上敲击键盘的时间足够长，它将进入 StackOverflowException。

有没有人有办法重新编写这段代码，以免导致堆栈崩溃？

```
[STAThread]
static void Main(string[] args)
{
    bool restart = true;
    while(restart)
    {
        using (var myWcfHost = new MyWcfHost())
        {
            myWcfHost.start();

            Console.WriteLine("Press Enter to quit or Ctrl+R to restart");

            restart = WaitForRestart();
        }
    }
}

private static bool WaitForRestart()
{
    // clear users input
    Console.CursorLeft = 0;
    Console.Write(' ');
    Console.CursorLeft = 0;

    // read users input
    var key = Console.ReadKey();
    if ((key.Modifiers & ConsoleModifiers.Control) != 0
        && key.Key == ConsoleKey.R)
    {
        // refersh the settings
        ConfigurationManager.RefreshSection("appSettings");
        return true;
    }
    if (key.Key == ConsoleKey.Enter || key.Key == ConsoleKey.Escape)
    {
        return false;
    }
    return WaitForRestart();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T01:11:29.647

用循环替换递归：

```
private static bool WaitForRestart()
{
    while (true)
    {
        // clear users input
        Console.CursorLeft = 0;
        Console.Write(' ');
        Console.CursorLeft = 0;

        // read users input
        var key = Console.ReadKey();
        if ((key.Modifiers & ConsoleModifiers.Control) != 0
            && key.Key == ConsoleKey.R)
        {
            // refersh the settings
            ConfigurationManager.RefreshSection("appSettings");
            return true;
        }
        if (key.Key == ConsoleKey.Enter || key.Key == ConsoleKey.Escape)
        {
            return false;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T01:13:47.083

看起来每次按下无效键时，您都会将另一个 WaitForRestart 推入堆栈，最终导致溢出异常。我认为这可以解决：

```
private static bool WaitForRestart()
{
// clear users input
Console.CursorLeft = 0;
Console.Write(' ');
Console.CursorLeft = 0;

while (true) 
{
    // read users input
    var key = Console.ReadKey();
    if ((key.Modifiers & ConsoleModifiers.Control) != 0
        && key.Key == ConsoleKey.R)
    {
        // refersh the settings
        ConfigurationManager.RefreshSection("appSettings");
        return true;
    }
    if (key.Key == ConsoleKey.Enter || key.Key == ConsoleKey.Escape)
    {
        return false;
    }
}
} 
```

# c++ - 在现代 C++ 应用程序中使用 Win32 代码时，是否应该使用正确的转换？

> ID：791953
> 
> 赞同：4
> 
> 时间：2009-04-27T01:11:36.073
> 
> 标签：c++, winapi, visual-c++

例如，可以在整个 MSDN 文档中找到以下演员表：

```
(LPTSTR)&lpMsgBuf 
```

我是否应该费心将其转换为：

```
static_cast<LPTSTR>(&lpMsgBuf); 
```

或者我应该保留所有惯用的 C-esque Win32 部分，因为它们通常在文档中找到，并为我的其余代码保存更惯用的 C++ 样式/用法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-27T01:24:15.187

引入新风格的演员表是有原因的：它们更安全、更容易解释/自我评论、更容易看到、更容易 grep。

所以使用它们。

更明确地说，我们的意思是您不能只转换为某些东西，您必须说明*为什么*要转换（我在继承层次结构中转换（dynamic_cast），我的转换是实现定义的并且可能不可移植（reinterpret_cast） ，我正在抛弃 constness (const_cast) 等）。

它们故意又长又丑，所以演员表会在读者面前跳出来（并阻止使用过多演员表的编程风格）。

它们更安全，因为例如，如果不明确这样做，您就无法抛弃 constness。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-27T01:42:17.203

我不会在代码中添加旧式强制转换或新式强制转换，而是利用 C++ 的运算符重载来添加采用正确类型参数的 Windows API 函数的内联重载版本。（只要这是为新开发人员记录的，希望它不会太混乱。）

例如，`FormatMessage`的第五个参数通常是一个`LPTSTR`，但如果你传递`FORMAT_MESSAGE_ALLOCATE_BUFFER`标志，第五个参数是一个指向 LPTSTR 的指针。所以我会定义一个这样的函数：

```
inline DWORD WINAPI FormatMessage(
  __in      DWORD dwFlags,
  __in_opt  LPCVOID lpSource,
  __in      DWORD dwMessageId,
  __in      DWORD dwLanguageId,
  __out     LPTSTR *lpBuffer,
  __in      DWORD nSize,
  __in_opt  va_list *Arguments
) {
    assert(dwFlags & FORMAT_MESSAGE_ALLOCATE_BUFFER);
    return FormatMessage(dwFlags, lpSource, dwMessageId, dwLanguageId, static_cast<LPTSTR>(&lpBuffer), nSize, Arguments);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-27T01:18:24.250

MSDN 文档与 C++ 标准。

我会选择后者。我认为这也是有效 C++ 中讨论的规则之一。你不应该**在**一个程序中混合两种风格。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-27T01:27:35.380

您根本不需要演员表——从外观上看，它`lpMsgBuf`是一个指向字符数组的指针（从上下文中不清楚它们是 ANSI 字符还是宽字符），您可以将其直接传递给各种 Win32 函数.

没有必要获取地址——如果`lpMsgBuf`是静态数组（例如`char lpMsgBuf[SIZE]`），那么获取它的地址是多余的，相当于它的第一个元素的地址。如果它是一个指针，那么获取它的地址会产生 a `char**`（或者`wchar_t**`如果它是宽的），这不是你想要传递的——如果 Win32 函数期望一个`LPSTR`（即 a `char*`）并且你将它传递`char**`给 a `char*`，很多会导致坏事。编译器不会让您传递`char**`给期望 a`char*`没有强制转换的函数——使用强制转换使编译器静音是错误的，因为编译器试图告诉您一些重要的事情。

如果您在这种情况下无法在不强制转换的情况下传递您想要的参数，那么您几乎可以肯定传递它是错误的。修复代码，这样您就不需要演员表了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T01:29:37.437

如果 lpMsgBuf 已经是一个指向 T-string 的指针，并且如果 API 期望指针直接指向 T-string，那么您根本不应该使用任何强制转换。换句话说，如果数据类型已经正确，那么最好不要使用不必要的强制转换。原因是过度使用强制类型转换会使您在强制类型转换关闭编译器的同时使您对错误视而不见。

如果 lpMsgBuf 已经是一个指向 T-string 的指针，并且如果 API 需要一个指向 T-string 的指针，但 API 希望指向指针的指针转换为指向 T-string 的类型指针（并且 API 将转换它使用它时回来），那么你做对了。

如果 lpMsgBuf 是指向其他东西（类型正确）的指针，并且 API 需要指向您的类型的指针，但 API 需要这些铸造游戏，那么您做对了。

如果 lpMsgBuf 是一个指向 T-string 的指针，并且 API 需要一个指向 T-string 的指针，那么通过使用 & 运算符，您正在构造一个指向 API 不期望的 T-string 指针的指针，并且通过使用强制转换，您是在告诉编译器将该指向指针的指针转换为指向 T-string 的类型指针，即使该值仍指向指针。因此，您成功关闭了编译器，但您仍然向您或您的客户提供了垃圾结果。

因此，如果没有更多关于哪个 MSDN 页面告诉您创建指向指针并为哪个 API 玩铸造游戏的详细信息，我们无法猜测您是否做得对，或者您是否误读了 MSDN，或者 MSDN 是否在告诉你写不好的代码。

现在，如果转换实际上是正确的，那么选择使用哪种语法取决于您在程序其余部分中的风格。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T01:49:12.957

大多数情况下，MSDN Win32 示例代码与 C*和*C++ 兼容。使用普通的旧 C 语言编写 Windows 程序是完全允许的（并且在某个时间点是标准做法）。

由于 C++ 转换在 C 中不可用，因此修改示例以利用它们将需要维护两个示例代码副本。由于 C 代码在 C++ 中的工作方式与 C++ 中的一样，因此保留旧式类型转换会更容易。

# git - 使用 Git 下载特定标签

> ID：791959
> 
> 赞同：2048
> 
> 时间：2009-04-27T01:15:12.417
> 
> 标签：git, git-clone, git-tag

我试图弄清楚如何下载 Git 存储库的特定标签 - 它是当前版本之后的一个版本。

我在 git 网页上看到了以前版本的标签，对象名称是长十六进制数字。

但是`Tagged release 1.1.5`根据网站，版本名称是“”。

我尝试了这样的命令（更改了名称）：

```
git clone http://git.abc.net/git/abc.git my_abc 
```

我确实得到了一些东西——一个目录、一堆子目录等。

如果它是整个存储库，我如何获得我正在寻找的版本？如果没有，我如何下载该特定版本？

* * *

## 回答 #1

> 赞同：2998
> 
> 时间：2009-04-27T01:53:48.190

```
$ git clone 
```

将为您提供整个存储库。

克隆后，您可以列出标签，`$ git tag -l`然后签出特定标签：

```
$ git checkout tags/<tag_name> 
```

更好的是，签出并创建一个分支（否则您将位于以标签的修订号命名的分支上）：

```
$ git checkout tags/<tag_name> -b <branch_name> 
```

* * *

## 回答 #2

> 赞同：433
> 
> 时间：2012-06-14T09:33:03.717

```
git clone --branch my_abc http://git.abc.net/git/abc.git 
```

将克隆 repo 并将您留在您感兴趣的标签上。

1.8.0 的**git clone**状态的文档。

> --branch 还可以在结果存储库中的该提交处获取标签并分离 HEAD。

* * *

## 回答 #3

> 赞同：207
> 
> 时间：2015-07-28T02:35:15.220

为了只签出给定的部署标签，我使用例如：

```
git clone -b 'v2.0' --single-branch --depth 1 https://github.com/git/git.git 
```

如果一个人只对最新的代码而不是完整的存储库感兴趣，这似乎是从远程存储库中签出代码的最快方法。这样，它类似于“svn co”命令。

注意：根据[Git 手册](https://git-scm.com/docs/git-clone)，默认情况下传递`--depth`标志。`--single-branch`

> - 深度
> 
> 创建一个浅克隆，其历史记录被截断为指定的提交次数。暗示 --single-branch 除非给出 --no-single-branch 以获取所有分支尖端附近的历史记录。如果你想浅层地克隆子模块，也可以通过 --shallow-submodules。

* * *

## 回答 #4

> 赞同：99
> 
> 时间：2009-04-27T01:54:51.370

我不是 git 专家，但我认为这应该可行：

```
git clone http://git.abc.net/git/abc.git
cd abc
git checkout my_abc 
```

或者

```
git clone http://git.abc.net/git/abc.git
cd abc
git checkout -b new_branch my_abc 
```

第二个变体基于标签建立一个新的分支，这样你就可以避免“分离的 HEAD”。[（git结帐手册）](http://git-scm.com/docs/git-checkout)

每个 git 存储库都包含整个修订历史记录，因此克隆存储库可以让您访问最新的提交，以及之前的所有内容，包括您正在寻找的标签。

* * *

## 回答 #5

> 赞同：81
> 
> 时间：2009-12-09T21:46:32.963

您可以使用 git archive 下载给定标签或提交 id 的 tar 球：

```
git archive --format=tar --remote=[hostname]:[path to repo] [tag name] > tagged_version.tar 
```

您还可以导出标签的 zip 存档。

1.  列出标签：

    ```
    git tag

    0.0.1
    0.1.0 
    ```

2.  导出标签：

    ```
    git archive -o /tmp/my-repo-0.1.0.zip --prefix=my-repo-0.1.0/ 0.1.0 
    ```

3.  笔记：

    *   您无需指定格式。它将被输出文件名拾取。
    *   指定前缀将使您的代码导出到目录（如果包含尾部斜杠）。

* * *

## 回答 #6

> 赞同：54
> 
> 时间：2015-06-25T06:28:00.463

**使用`--single-branch`开关** *（从 Git 1.7.10 开始可用）*。语法是：

```
git clone -b <tag_name> --single-branch <repo_url> [<dest_dir>] 
```

例如：

```
git clone -b 'v1.9.5' --single-branch https://github.com/git/git.git git-1.9.5 
```

好处：Git 将接收对象并（需要）仅解析指定分支/标签的增量 - 同时签出完全相同数量的文件！根据源存储库，这将为您节省大量磁盘空间。（另外，它会更快。）

* * *

## 回答 #7

> 赞同：33
> 
> 时间：2015-09-10T18:57:43.827

首先获取该特定遥控器中的所有标签

```
git fetch <remote> 'refs/tags/*:refs/tags/*' 
```

**或者**只是简单地输入

```
git fetch <remote> 
```

然后检查可用的标签

```
git tag -l 
```

然后使用以下命令切换到该特定标签

```
git checkout tags/<tag_name> 
```

希望这会帮助你！

* * *

## 回答 #8

> 赞同：19
> 
> 时间：2010-05-12T12:23:57.773

如果您的标签可以使用 linux`sort`命令排序，请使用以下命令：

```
git tag | sort -n | tail -1 
```

例如。如果`git tag`返回：

```
v1.0.1
v1.0.2
v1.0.5
v1.0.4 
```

`git tag | sort -n | tail -1`将输出：

```
v1.0.5 
```

`git tag | sort -n | tail -2 | head -1`将输出：

```
v1.0.4 
```

（因为您要求第二个最近的标签）

要签出标签，首先克隆 repo，然后输入：

```
git checkout v1.0.4 
```

..或您需要的任何标签。

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2014-12-11T17:28:54.233

```
git fetch <gitserver> <remotetag>:<localtag> 
```

====================================

我只是这样做了。首先，我确定我知道标签名称的拼写。

```
git ls-remote --tags gitserver; : or origin, whatever your remote is called 
```

这给了我 git 服务器上的标签列表供我选择。原始发帖人已经知道他的标签名称，所以这一步不是每个人都需要的。输出看起来像这样，尽管实际列表更长。

```
8acb6864d10caa9baf25cc1e4857371efb01f7cd    refs/tags/v5.2.2.2
f4ba9d79e3d760f1990c2117187b5010e92e1ea2    refs/tags/v5.2.3.1
8dd05466201b51fcaf4ca85897347d82fcb29518    refs/tags/Fix_109
9b5087090d9077c10ba22d99d5ce90d8a45c50a3    refs/tags/Fix_110 
```

我选择了我想要的标签并获取了它，仅此而已。

```
git fetch gitserver Fix_110 
```

然后我在我的本地机器上标记了这个，给我的标签取了相同的名字。

```
git tag Fix_110 FETCH_HEAD 
```

我不想像其他人建议的那样克隆远程存储库，因为我正在处理的项目很大，我想在一个干净的环境中进行开发。我觉得这比建议克隆整个存储库的解决方案更接近原始问题“我试图弄清楚如何下载特定标签”。我不明白为什么任何人如果想查看 DOS 0.1 源代码（例如）就必须拥有 Windows NT 和 Windows 8.1 源代码的副本。

我也不想像其他人建议的那样使用 CHECKOUT。我有一个分支检查出来，不想影响它。我的目的是获取我想要的软件，以便我可以挑选一些东西并将其添加到我的开发中。

可能有一种方法可以获取标记本身，而不仅仅是被标记的提交的副本。我必须自己标记获取的提交。编辑：啊，是的，我现在找到了。

```
git fetch gitserver Fix_110:Fix_110 
```

您在哪里看到冒号，即远程名称：本地名称，这里它们是标签名称。这运行不会打乱工作树等。它似乎只是将东西从远程复制到本地机器，所以你有自己的副本。

```
git fetch gitserver --dry-run Fix_110:Fix_110 
```

添加 --dry-run 选项后，您可以查看该命令的功能，如果您想验证它是您想要的。所以我想一个简单的

```
git fetch gitserver remotetag:localtag 
```

是真正的答案。

=

关于标签的单独说明......当我开始新事物时，我通常在 git init 之后标记空存储库，因为

```
git rebase -i XXXXX 
```

需要提交，问题就出现了“你如何重新调整包含你的第一个软件更改的更改？” 所以当我开始工作时

```
git init
touch .gitignore
[then add it and commit it, and finally]
git tag EMPTY 
```

即在我第一次真正更改之前创建一个提交，然后再使用

```
git rebase -i EMPTY 
```

如果我想重新调整我所有的工作，**包括第一次更改**。

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2010-04-26T14:39:00.013

我检查了[git checkout 文档](http://git-scm.com/docs/git-checkout)，它揭示了一件有趣的事情：

> git checkout -b <new_branch_name> <start_point> ，其中 <start_point> 是开始新分支的提交的名称；默认为 HEAD

所以我们可以提到标签名称（因为标签只不过是提交的名称），比如：

> >> git checkout -b 1.0.2_branch 1.0.2
> *以后，修改一些文件*
> >> git push --tags

PS：在Git中，你不能直接更新一个标签（因为标签只是一个提交的标签），你需要签出与分支相同的标签，然后提交到它，然后创建一个单独的标签。

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2013-03-15T16:41:01.907

根据 Peter Johnson 的回答，我为自己创建了一个不错的小别名：

```
alias gcolt="git checkout $(git tag | sort -V | tail -1)" 
```

又名“git checkout 最新标签”。

这依赖于 GNU 版本的 sort，它可以适当地处理像 lOranger 指出的情况：

```
v1.0.1
...
v1.0.9
v1.0.10 
```

如果你在 Mac 上，`brew install coreutils`然后调用 gsort 代替。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2015-01-21T13:25:06.257

尝试：

```
git clone -b <name_of_the_tag> <repository_url> <destination> 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2017-09-30T12:19:41.377

[签出标签](https://git-scm.com/book/en/v2/Git-Basics-Tagging)

如果你想查看一个标签指向的文件的版本，你可以做一个 git checkout，虽然这会使你的存储库处于“分离的 HEAD”状态，这有一些不良的副作用：

```
$ git checkout 2.0.0
Note: checking out '2.0.0'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by performing another checkout.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -b with the checkout command again. Example:

  git checkout -b <new-branch-name>

HEAD is now at 99ada87... Merge pull request #89 from schacon/appendix-final

$ git checkout 2.0-beta-0.1
Previous HEAD position was 99ada87... Merge pull request #89 from schacon/appendix-final
HEAD is now at df3f601... add atlas.json and cover image 
```

在“分离的 HEAD”状态下，如果您进行更改然后创建提交，标签将保持不变，但您的新提交将不属于任何分支并且将无法访问，除非通过确切的提交哈希。因此，如果您需要进行更改（例如，您正在修复旧版本上的错误），您通常需要创建一个分支：

```
$ git checkout -b version2 v2.0.0
Switched to a new branch 'version2' 
```

如果您这样做并提交，您的 version2 分支将与您的 v2.0.0 标记略有不同，因为它会随着您的新更改向前移动，所以要小心。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2013-03-28T13:26:25.450

我这样做是通过 github API：

```
curl -H "Authorization: token %(access_token)s" -sL -o /tmp/repo.tar.gz "http://api.github.com/repos/%(organisation)s/%(repo)s/tarball/%(tag)s" ;\
tar xfz /tmp/repo.tar.gz -C /tmp/repo --strip-components=1 ; \ 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-05-19T05:43:05.060

我做了如下

```
git checkout tags/20210511 -b 20210511-release 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-09-03T03:47:18.007

我经常用一个

```
git clone  --branch <tag_name> <repo_url> 
```

# assembly - 访问汇编条件代码

> ID：791961
> 
> 赞同：0
> 
> 时间：2009-04-27T01:15:54.753
> 
> 标签：assembly, boolean-logic

CF：**进位标志**

ZF：**零标志**

我目前正在阅读一本关于使用 AT&T 语法在 linux 平台上进行 intel x86 汇编的书，书中说，**setbe D**的效果相当于：

**D** ← **CF** & ~ **ZF**

我明白这一点，但它可以简单地写成：

**D ←** **CF** | **采埃孚**

这仅在 CF/ZF 为 1/1 或 1/0 时与 ~ZF&CF 不同。哪个更准确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T01:25:46.320

想想真值表。

```
| CF | ZF | CF &~ZF | CF|ZF |
+---------------------------+
   0    0      0        0
   0    1      0        1
   1    0      1        1
   1    1      0        1 
```

真值表是不同的，所以不，它们不一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T01:47:25.147

`setbe`如果 将结果设置为 1 `(ZF=1) or (CF=1)`。如果您正在阅读的文档说它设置了它`(ZF=0) and (CF=1)`，那就错了。请参阅[80386 程序员参考手册](http://pdos.csail.mit.edu/6.828/2008/readings/i386/SETcc.htm)。下面是详细分析：

`setbe`如果前面比较的结果是小于或等于，则将结果设置为 1 ，**当****作为无符号整数进行比较时****（**有符号整数的等价物是，对于**小于**或等于）。**`setle`**

 ******执行指令时`cmp`，从源操作数中减去目标操作数，并丢弃结果。唯一的输出是条件标志的设置。请记住，当我们减去两个数字时`A-B`，我们实际上是在添加`A+(~B)+1`二进制补码，其中`~B`的补码是`B`（即所有位都被翻转）。

我们来看6个案例：

```
案例 0：比较 1 和 0
    0 - 1
  = 0 + ~1 + 1
  = 0x00000000 + 0xffffffffe + 1
  = 0xffffffff ≠ 0，无进位
  ==> ZF = 0，CF = 0

案例 1：比较 0 和 0
    0 - 0
  = 0 + ~0 + 1
  = 0x00000000 + 0xffffffff + 1
  = 0x00000000 = 0，带进位
  ==> ZF = 1，CF = 0

案例 2：比较 0 和 1
    1 - 0
  = 1 + ~0 + 1
  = 0x00000001 + 0xffffffff + 1
  = 0x00000001 ≠ 0，带进位
  ==> ZF = 0，CF = 1

案例 3：将 UINT_MAX 与 0 进行比较
    0 - 4294967295
  = 0 + ~4294967295 + 1
  = 0x00000000 + 0x00000000 + 1
  = 0x00000001 ≠ 0，无进位
  ==> ZF = 0，CF = 0

案例 4：比较 0 和 UINT_MAX
    4294967295 - 0
  = 4294967295 + ~0 + 1
  = 0xffffffff + 0xffffffff + 1
  = 0xffffffff ≠ 0，带进位
  ==> ZF = 0，CF = 1

案例 5：比较 UINT_MAX 和 UINT_MAX
    4294967295 - 4294967295
  = 4294967295 + ~4294967295 + 1
  = 0xffffffff + 0x00000000 + 1
  = 0x00000000 = 0，带进位
  ==> ZF = 1，CF = 1

```

第一个参数小于或等于第二个参数的情况是情况 1、2、4 和 5。所有这些情况都满足`(ZF=1) or (CF=1)`，而比较为假的其余情况满足相反的条件，`(ZF=0) and (CF=0)`。请注意，我们还列举了 CF 和 ZF 的所有可能组合。因此，我们得出结论，正确的行为`setbe`是设置 on `(ZF=1) or (CF=1)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T01:41:07.283

SETBE 低于或等于（CF=1 或 ZF=1） 你确定 CF & ~ZF 是正确的吗？指令可以是 SETB 还是 SETL ？

# iphone - 从 UIScrollView 中删除子视图和内存泄漏

> ID：791963
> 
> 赞同：1
> 
> 时间：2009-04-27T01:19:20.313
> 
> 标签：iphone, memory-leaks, uiscrollview

我目前正在开发一个应用程序，它`UIView`在`UIScrollView`. 这`UIScrollView`是在一个`UIViewController`.

在一个循环中，我正在创建新`UIView`的 s，`autorelease`它们并将它们添加到滚动视图中。这可能是问题吗？

当我尝试释放视图控制器时，所有带有标签、图像等的子视图都留在内存中。

摆脱这些物体的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T01:37:22.690

我认为这可能是正在发生的事情：

当您将 UIView 添加到 UIScrollView 时，UIScrollView 将保留它。您还在 UIView 上调用 autorelease，因此该对象现在由 UIScrollView 和 NSAutoreleasePool 保留。当您释放 viewController 时，它会将保留计数减一，但在您到达当前 NSAutoreleasePool 的排水调用之前，不会释放对象。

也许尝试不自动释放循环中的对象。只需将它们添加到 UIScrollView，然后手动释放它们。这样，UIScrollView 将成为这些对象的唯一所有者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T01:22:35.423

没有看到一些代码就不可能说出来。发布您认为可疑的代码片段。确保您遵循[Cocoa 内存管理编程指南中](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)列出的所有规则。

# c - 确定字符串是否是 C 中的有效 IPv4 地址

> ID：791982
> 
> 赞同：25
> 
> 时间：2009-04-27T01:32:13.233
> 
> 标签：c, string

确定字符串是否包含 IPv4 地址的好方法是什么？我应该使用`isdigit()`吗？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-04-27T01:47:34.740

我[对 C++ 提出了类似的问题](https://stackoverflow.com/questions/318236/how-do-you-validate-that-a-string-is-a-valid-ip-address-in-c)。您应该能够使用我当时想出的稍微修改过的（用于 C 的）版本。

```
bool isValidIpAddress(char *ipAddress)
{
    struct sockaddr_in sa;
    int result = inet_pton(AF_INET, ipAddress, &(sa.sin_addr));
    return result != 0;
} 
```

您需要`#include <arpa/inet.h>`使用[inet_pton()](http://beej.us/guide/bgnet/html/multi/inet_ntopman.html)函数。

根据对问题的评论进行更新：如果您想知道 C 风格的字符串是否*包含*IP 地址，那么您应该结合到目前为止给出的两个答案。使用正则表达式查找与 IP 地址大致匹配的模式，然后使用上面的函数检查匹配是否是真实的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-27T08:28:07.007

这是我不久前为嵌入式系统编写的例程，它在网络上生成各种可疑模式。因此，它完全*不*使用像网络库甚至标准 C 库这样的花哨的东西，而是更喜欢避开所有现代的东西，比如字符串标记和（不寒而栗）正则表达式库 :-) 为此，它适合于您可以在任何环境中找到自己，而且速度快得令人眼花缭乱。

虽然，如果您在具有类似 的环境中`checkIp4Addess()`，我建议您改用它。这表明你在做嵌入式的东西时有时不得不忍受的东西（尽管它*是*一个真正的解决方案）。

```
int isValidIp4 (char *str) {
    int segs = 0;   /* Segment count. */
    int chcnt = 0;  /* Character count within segment. */
    int accum = 0;  /* Accumulator for segment. */

    /* Catch NULL pointer. */

    if (str == NULL)
        return 0;

    /* Process every character in string. */

    while (*str != '\0') {
        /* Segment changeover. */

        if (*str == '.') {
            /* Must have some digits in segment. */

            if (chcnt == 0)
                return 0;

            /* Limit number of segments. */

            if (++segs == 4)
                return 0;

            /* Reset segment values and restart loop. */

            chcnt = accum = 0;
            str++;
            continue;
        }
        /* Check numeric. */

        if ((*str < '0') || (*str > '9'))
            return 0;

        /* Accumulate and check segment. */

        if ((accum = accum * 10 + *str - '0') > 255)
            return 0;

        /* Advance other segment specific stuff and continue loop. */

        chcnt++;
        str++;
    }

    /* Check enough segments and enough characters in last segment. */

    if (segs != 3)
        return 0;

    if (chcnt == 0)
        return 0;

    /* Address okay. */

    return 1;
} 
```

它适用于点分十进制地址表示（四段），但由于这几乎是迄今为止最常见的形式，我不认为有太大的限制。*很久以前*还有其他表示（可能仍然有效），但很少看到它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-06T11:33:38.793

```
int validateIP4Dotted(const char *s)
{
    int len = strlen(s);

    if (len < 7 || len > 15)
        return 0;

    char tail[16];
    tail[0] = 0;

    unsigned int d[4];
    int c = sscanf(s, "%3u.%3u.%3u.%3u%s", &d[0], &d[1], &d[2], &d[3], tail);

    if (c != 4 || tail[0])
        return 0;

    for (int i = 0; i < 4; i++)
        if (d[i] > 255)
            return 0;

    return 1;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T01:35:20.790

我会使用这个正则表达式（由[正则表达式示例](http://www.regular-expressions.info/examples.html)提供）：

```
`\b(?:\d{1,3}\.){3}\d{1,3}\b` 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T01:57:54.060

我将给出“不想要两个问题”的解决方案：

```
#include <string.h>

int isIp_v4( char* ip){
        int num;
        int flag = 1;
        int counter=0;
        char* p = strtok(ip,".");

        while (p && flag ){
                num = atoi(p);

                if (num>=0 && num<=255 && (counter++<4)){
                        flag=1;
                        p=strtok(NULL,".");

                }
                else{
                        flag=0;
                        break;
                }
        }

        return flag && (counter==3);

} 
```

编辑：strtok 可能不是线程安全的（感谢 Adam Rosenfield）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-27T08:04:47.050

在 url/uri rfc 3986 中，Augmented Backus-Naur Form (ABNF) ipv4 地址定义为：

```
 IPv4address = dec-octet "." dec-octet "." dec-octet "." dec-octet

  dec-octet   = DIGIT                 ; 0-9
              / %x31-39 DIGIT         ; 10-99
              / "1" 2DIGIT            ; 100-199
              / "2" %x30-34 DIGIT     ; 200-249
              / "25" %x30-35          ; 250-255 
```

我以以下形式使用正则表达式实现了检查：

```
// Although the RFC says ipv6 octects like 001 are not valid, it would be risky
// not to accept those
#define decoct "([01]?[0-9]?[0-9]|2[0-4][0-0]|25[0-5])"
#define ipv4 "(" decoct "\\." decoct "\\." decoct "\\." decoct ")" 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-07-08T09:23:06.973

这是我尝试使用非常低级的 C 编程（实际上在我的一个 PIC 微控制器程序中使用）。它不使用 string.h 库。它不使用指针，因为我使用的这个编译器不能很好地使用它们，无论如何你可以使用它们。考虑到这一点并预先定义一个变量来处理传入的数据缓冲区，如下所示：

```
#define isdigit(x)  isamong(x,"0123456789")
char    IPACK_Buff[IPACK_SIZE]; 

// Check if string is a valid IP
int IPACK_is_valid_ip(int len)
{
    int i = 0;
    int j = 0;
    int NumDots = 0;
    char number[4] = "000\0";

    // Check first  char is numeric
    if (!isdigit(IPACK_Buff[0])) 
        return 0;

    for (i = 0 ; i< len; i++)
    {
        if (isdigit(IPACK_Buff[i]))
        {
            number[j] = IPACK_Buff[i];
            j++;
            if (j>3)    
                return 0;
        }
        else if (IPACK_Buff[i] == '.')
        {
            if (atof(number)> 255) return 0;
            memset(number, '\0', 4);

            j = 0;
            NumDots++;
            if(NumDots>3)
                return 0;
        }
    }

    if (NumDots == 3)
    {
        return 1;
    }
    else 
        return 0;
}// 
```

希望这个功能对大家有帮助。再次，考虑到这个函数在批评之前编程的低级别。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-22T16:42:44.900

我需要弄清楚传入的字符串是否“包含”有效的 IP 地址，如果是，则返回指向传入字符串的有效 IP 地址部分的指针。如果不是，则返回一个空指针。

这是似乎可以工作的代码，虽然还没有经过很好的测试，但我只是写了它并快速尝试了一下。我还没有添加检查以将数字限制为单字节值，但请检查以确保它们限制为三位数。

```
int IsDigit(char ch)
{
   int is_digit = 0;
   if ( ch >= '0' && ch <= '9' )
   {
      is_digit = 1;
   }
   return is_digit;
}

#define FIND_IP_START         0
#define FIND_IP_DIGIT         1
#define FIND_IP_DIG_OR_DEC    2
#define FIND_IP_DECIMAL       3
#define FIND_IP_DIG_OR_END    4
#define FIND_IP_END           5
#define FIND_IP_DONE          6

char * StringContainsValidIpAddress(char * input_buf_pointer)
{
   char * pos       = input_buf_pointer;
   int    octets    = 0; 
   int    digits    = 0;
   int    state     = FIND_IP_START;
   char * ip_string = 0;

   char   ch        = *pos; 

   while ( (ch != NULL) && (state != FIND_IP_DONE) )
   {
      switch ( state )
      {
      case FIND_IP_START:
         if ( IsDigit(ch) )
         {
            ip_string = pos;  //potential start of ip string
            digits = 1;   // first digit
            octets = 1;   // of first octet
            state = FIND_IP_DIG_OR_DEC;
         }
         break;
      case FIND_IP_DIGIT:
         if ( IsDigit(ch) )
         {
            digits = 1;    // first digit
            octets++;      // of next octet
            if ( octets == 4 )
            {
               state = FIND_IP_DIG_OR_END;
            }
            else
            {
                   state = FIND_IP_DIG_OR_DEC;
            }
         }
         else
         {
            // Start over
            state = FIND_IP_START;
         }
         break;
      case FIND_IP_DIG_OR_DEC:
         // Here we are looking for another digit 
         // of the same octet or the decimal between 
         // octets.
         if (ch == '.')
         {
               state = FIND_IP_DIGIT;
         }
         else if ( IsDigit(ch) )
         {
            digits++;      // next digit
            if ( digits == 3 )
            {
               state = FIND_IP_DECIMAL;
            }
         }
         else
         {
            // Start over
            state = FIND_IP_START;
         }
         break;
      case FIND_IP_DECIMAL:
         if (ch == '.')
         {
               state = FIND_IP_DIGIT;
         }
         break;
      case FIND_IP_DIG_OR_END:
         // Here we are looking for another digit 
         // of the same octet or the end (which could
         // be a space or CR or LF or really any 
         // non-digit).
         if ( IsDigit(ch) )
         {
            digits++;      // next digit
            if ( digits == 3 )
            {
               state = FIND_IP_END;
            }
         }
         else
         {  
            *pos = 0;  // Null terminate the IP address string
            state = FIND_IP_DONE;
         }
         break;
      case FIND_IP_END:
         if ( !IsDigit(ch) )
         {
            *pos = 0;  // Null terminate the IP address string
            state = FIND_IP_DONE;
         }
         break;
      case FIND_IP_DONE:
         break;
      default:
         break;
      }

      // Fetch the next character
      ch = *++pos; 
   } 

   if (state == FIND_IP_DONE) 
   {
      return ip_string; 
   }
   else
   {
      return 0;
   }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-07-31T17:28:08.617

像这样从头开始做。此代码包含检查字符串是否包含 IPv4 IP 地址的工具。

```
#define MAX_HEX_NUMBER_COUNT 8 

int ishexdigit(char ch) 
{
   if((ch>='0'&&ch<='9')||(ch>='a'&&ch<='f')||(ch>='A'&&ch<='F'))
      return(1);
   return(0);
}

int IsIp6str(char *str)
{ 
   int hdcount=0;
   int hncount=0;
   int err=0;
   int packed=0;

   if(*str==':')
   {
      str++;    
      if(*str!=':')
         return(0);
      else
      {
         packed=1;
         hncount=1;
         str++;

         if(*str==0)
            return(1);
      }
   }

   if(ishexdigit(*str)==0)
   {
      return(0);        
   }

   hdcount=1;
   hncount=1;
   str++;

   while(err==0&&*str!=0)   
   {                      
      if(*str==':')
      {
         str++;
         if(*str==':')
         {
           if(packed==1)
              err=1;
           else
           {
              str++;

          if(ishexdigit(*str)||*str==0&&hncount<MAX_HEX_NUMBER_COUNT)
          {
             packed=1;
             hncount++;

             if(ishexdigit(*str))
             {
                if(hncount==MAX_HEX_NUMBER_COUNT)
                {
                   err=1;
                } else
                {
                   hdcount=1;
                   hncount++;
                   str++;   
                }
             }
          } else
          {
             err=1;
          }
       }
    } else
    {
           if(!ishexdigit(*str))
           {
              err=1;
           } else
           {
              if(hncount==MAX_HEX_NUMBER_COUNT)
              {
                 err=1;
              } else
              {
                  hdcount=1;
                  hncount++;
                  str++;   
              }
           }
        }
     } else
     {  
        if(ishexdigit(*str))
        {
           if(hdcount==4)
              err=1;
           else
           {
              hdcount++;          
              str++;
           }
         } else
            err=1;
     } 
   }

   if(hncount<MAX_HEX_NUMBER_COUNT&&packed==0)
      err=1;

    return(err==0);
}

int IsIp4str(char *str) 
{
   int nnumber=0;
   int value=0;
   int err=0;

   if(*str>='0'&&*str<='9')
   {
      value=*str-'0';
      str++;
   } else
      return(0);

   nnumber=1;

   while(err==0&&*str!=0)
   {
      if(*str>='0'&&*str<='9')
      {
         if(255/value>=10)
         {
            value*=10;

            if(255-value>=(*str-'0'))
            {
               value+=(*str-'0');
               str++;
            } else
                err=1;
         } else
           err=1;
      }  else
      {
         if(*str=='.')
         {      
            str++;
            if(*str>='0'&&*str<='9')
            {
               if(nnumber==4)
                  err=1;
               else
               {
                  if(*str=='0')
                  {
                     *str++;
                     if(*str!='.'&&*str!=0)
                        err=1;
                     else
                     {
                        nnumber++;
                        value=0;
                     }
                  } else
                  {
                     nnumber++;
                     value=*str-'0';
                     str++;
                  }
               }
            } else
            {
               err=1;
            }
         } else
           if(*str!=0)
             err=1;
      }
   }

   if(nnumber!=4)
      err=1;

   return(err==0);
} 
```

函数 IsIp4str(char *str) 测试字符串是否包含 IP 地址版本四地址格式。IsIp6str(char *str) 函数测试字符串是否包含 IP 地址版本六地址格式。

如果字符串 str 包含 IP 地址，函数 IsIp4str(char *str) 和 IsIp6str(char *str) 返回 true，如果字符串 str 不包含 IP 地址，则返回 false。

如果你需要检查字符串是否包含IP地址IPv6格式，它可以做int IsIp6str(char *str)函数。它的工作方式与

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-06-08T18:09:55.147

这是我一直在研究的一个功能的开始，虽然不完整，但它可能会激发想法或评论。该功能背后的思想是；

1.  检查传递的 char 指针或字符串是没有端口的 IPv4 地址，使用其最小/最大大小、字符串中的点数以及冒号 : 字符是否存在。
2.  如果字符串不是带或不带端口的 IPv4，则检查字符串是否为 IPv6，如果不是 IPv6，则无法识别 IP 格式，因为它尚未实现。

我认为这取决于您想深入了解问题，了解可能发生的问题的深度。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h>
#include <arpa/inet.h>

int isIP(char *ip)
{
    char *data_ptr = ip;    // Create a pointer to passed data
    int orig_str_size = 0;  // Create an int to hold passed data size
    int str_index = 0;      // Create an int to iterate individual ip characters
    int dot_count = 0;      // Create an int to check for the number of dots

    // Count the number of characters in data_ptr
    while (*data_ptr++ != '\0'){ orig_str_size++; }

    if(orig_str_size <= 0) // If nothing
    {
        printf("Get a grip, ip is empty\n\n");
        exit(0);
    }
    else // If within IPv4 size range
    if(orig_str_size >= 7 && orig_str_size <= INET_ADDRSTRLEN)
    {
        char *data1_ptr = ip; // Create a pointer to passed data
        printf("Within IPv4 range, %i characters in length\n\n", orig_str_size);

        // Count the number of dots in the string, 3 for IPv4
        for(str_index; str_index < orig_str_size; str_index++)
        {
            if(data1_ptr[str_index] == '.'){ dot_count++; }
        }

        // If theres 3 dots, while ignoring dots, check each char is a digit 
        if(dot_count == 3)
        {

            printf("There's three dots in the string\n\n");
            data1_ptr = ip;
            str_index = 0;

            // Iterate the string char by char
            for(str_index; str_index < orig_str_size; str_index++)
            {
                // Ignoring dots
                if(data1_ptr[str_index] != '.')
                { 
                    // If isdigit() is happy its a digit and isalpha() happy not alphabetic
                    if(isdigit(data1_ptr[str_index]) && !isalpha(data1_ptr[str_index]))
                    {
                        printf("Digit found and is not alphabetic\n\n");
                        continue;
                    }
                    else
                    if(!isdigit(data1_ptr[str_index]) && isalpha(data1_ptr[str_index]))
                    {
                        printf("Not a recognised IPv4 address, character detected in string\n\n");
                        exit(0);
                    }
                }
            }

            return 0;
        }
    }
    else // If IPv6
    if(orig_str_size > 0 && orig_str_size > INET_ADDRSTRLEN && orig_str_size <= INET6_ADDRSTRLEN)
    {
        printf("Within IPv6 range %i\n\n", orig_str_size);
        return 0;
    }
    else
    {
        printf("Unknown target format, the format you provided as a target is not implemented\n\n");
        exit(0);
    }

} 
```

**TCP/IP 网络互联**

RFC791 - 互联网协议 - [https://www.rfc-editor.org/rfc/rfc791](https://www.rfc-editor.org/rfc/rfc791)

CISCO Internetworking 手册[http://docwiki.cisco.com/wiki/Internetworking_Technology_Handbook](http://docwiki.cisco.com/wiki/Internetworking_Technology_Handbook)

开放系统互连参考模型[http://docwiki.cisco.com/wiki/Internetworking_Basics#Open_Systems_Interconnection_Reference_Model](http://docwiki.cisco.com/wiki/Internetworking_Basics#Open_Systems_Interconnection_Reference_Model)

CISCO TCP/IP 网络故障排除[https://www.cisco.com/en/US/docs/internetworking/troubleshooting/guide/tr1907.pdf](https://www.cisco.com/en/US/docs/internetworking/troubleshooting/guide/tr1907.pdf)

[IPv4 允许的最大 TCP/IP 网络端口号是多少？](https://stackoverflow.com/questions/113224/what-is-the-largest-tcp-ip-network-port-number-allowable-for-ipv4)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-09-13T01:14:36.823

```
//  you can even use the v value array to return the unsigned int 
//  version of the IP if desired in an unsigned int reference.   

bool isvalidip(const char * s) 
{
  char t[8];
  int p = 0;
  int v[8];
  int numnum = 0;
  for (int i = 0; i < (int) strlen(s); i++) {
    char c = s[i];
    int cgood = 0;
    if (c >= '0' && c <= '9' && p < 4) {
      t[p++] = c;
      t[p] = 0;
      cgood++;
      continue;
    }
    if (p == 4) return false;
    if (c == '.') {
      if (!p) return false;
      v[numnum++] = atoi(t);
      p = 0;
      cgood++;
      continue;
    }
    if (!cgood) return false; // not a valid character
    if (numnum > 4) return false; // we have a lot of dots....
  }
  v[numnum++] = atoi(t); // we did not have a dot, we had a NULL.....
  if (numnum != 4) return false; // we must have had 4 valid numbers....
  for (int i = 0; i < 4; i++)
  {
    if (v[i] < 0 || v[i] > 255) return false; // octet values out-of-range
  }
  return true; //we good..
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-01-25T20:16:51.353

我修改了一个答案以使其更完整并附上所有代码（包括测试）

```
#include <stdio.h>
#include <assert.h>
#include <string.h>

int validateIP4Dotted(char *str, unsigned int pIPAddress[])
{
    int segs = 0; /* Segment count. */
    int chcnt = 0; /* Character count within segment. */
    int accum = 0; /* Accumulator for segment. */

    /* Catch NULL pointer. */

    if (str == NULL)
        return 0;

    /* Process every character in string. */

    while (*str != '\0')
    {
        /* Segment changeover. */

        if (*str == '.')
        {
            pIPAddress[segs] = accum;
            /* Must have some digits in segment. */

            if (chcnt == 0 || chcnt > 3)
                return 0;

            /* Limit number of segments. */

            if (++segs == 4)
                return 0;

            /* Reset segment values and restart loop. */

            chcnt = accum = 0;
            str++;
            continue;
        }
        /* Check numeric. */

        if ((*str < '0') || (*str > '9'))
            return 0;

        /* Accumulate and check segment. */

        if ((accum = accum * 10 + *str - '0') > 255)
            return 0;

        /* Advance other segment specific stuff and continue loop. */

        chcnt++;
        str++;
    }

    /* Check enough segments and enough characters in last segment. */
    pIPAddress[segs] = accum;

    if (segs != 3)
        return 0;

    if (chcnt == 0 || chcnt > 3)
        return 0;

    if (pIPAddress[0] >=224)
        return 0;
    /* Address okay. */

    return 1;
}

int main()
{
    unsigned int IpAddress[4];
    char str_ip[128];

    strcpy(str_ip, "192.168.1.10");
    assert(validateIP4Dotted(str_ip, IpAddress));
    assert(
            IpAddress[0] == 192 && IpAddress[1] == 168 && IpAddress[2] == 1
                    && IpAddress[3] == 10);

    strcpy(str_ip, "0.0.0.0");
    assert(validateIP4Dotted(str_ip, IpAddress));
    assert(
            IpAddress[0] == 0 && IpAddress[1] == 0 && IpAddress[2] == 0
                    && IpAddress[3] == 0);

    strcpy(str_ip, "/192.168.1.10");
    assert(!validateIP4Dotted(str_ip, IpAddress));

    strcpy(str_ip, "192..168.1.10");
    assert(!validateIP4Dotted(str_ip, IpAddress));

    strcpy(str_ip, ".192.168.1.10");
    assert(!validateIP4Dotted(str_ip, IpAddress));

    strcpy(str_ip, "192.168.1.10.");
    assert(!validateIP4Dotted(str_ip, IpAddress));

    strcpy(str_ip, "192.168.1.10.10");
    assert(!validateIP4Dotted(str_ip, IpAddress));

    strcpy(str_ip, "192.168.1.");
    assert(!validateIP4Dotted(str_ip, IpAddress));

    strcpy(str_ip, "192.168.1");
    assert(!validateIP4Dotted(str_ip, IpAddress));

    strcpy(str_ip, "255.168.1.10");
    assert(!validateIP4Dotted(str_ip, IpAddress));

    strcpy(str_ip, "10.260.1.10");
    assert(!validateIP4Dotted(str_ip, IpAddress));

    strcpy(str_ip, "10.200.0001.10");
    assert(!validateIP4Dotted(str_ip, IpAddress));

    return 0;
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-05-27T15:06:32.567

试试这个代码：

```
int ipValid(char *ip) {
int i,j,start,dotcount=0,x=0,end,c=0;
int n= strlen(ip);
start=0;
for(i=0;i<n;i++)
{
    if(ip[i]=='.'||i==n-1)
    {
        c=0;x=0;
        if(ip[i]=='.')
          {
            dotcount++;
            end=i-1;
           } 
        else if(i==n-1)
           end=i;
        for(j=start;j<=end;j++)
        {
            c++;
            x=x*10+(ip[j]-48);

        }
        if(c<4&&x>=0&&x<=255)
        {
            if(i==n-1)
                break;
            else
                start=i+1;
        }
        else
        {
            return 0;
        }
    }
}
if(dotcount==3)
   return 1;
else
   return 0;} 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2011-02-22T14:00:06.460

我认为下面的 C 代码片段应该可以工作

```
bool validate_ip4(const char* buffer)
{
    if (NULL == buffer) return false;

    register const      char*   pos     = buffer;
    register unsigned   char    ch      = *pos;
    register unsigned   short   count   = 0;

    while (ch != NULL)
    {
        if (!((ch >= '0' && ch <= '9') || ch == '.')) return false;

        if (ch == '.')
            if (++count > 3) return false;

        ch = *++pos;
    }

    if (count == 3 && *--pos != '.') return true;

    return false;
} 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2012-12-03T07:14:09.790

对于数字和点表示法表示 IPv4 IP 地址检查，inet_addr() 比 inet_aton() 好得多。

# c++ - 链表内存管理

> ID：791983
> 
> 赞同：1
> 
> 时间：2009-04-27T01:32:16.227
> 
> 标签：c++, stl

如何释放包含动态分配对象的链表？我尝试使用`list<class*>`列表，但后来我无法使用该`insert()`函数将对象插入列表。有谁知道是什么原因？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T10:45:03.980

`std::list<boost::shared_ptr<YourType> >``YourType::~YourType`当列表被删除时，将自动调用列表中的每个（智能）指针。如果你删除一个列表元素，它会调用`YourType::~YourType`那个元素。你仍然可以打电话`list.insert(new YourType`）

链接：[www.boost.org](http://www.boost.org)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T01:37:22.987

> 如何释放包含动态分配对象的链表？

遍历列表，删除每个链接的包含对象，或者在某些情况下更好的是，编写一个删除包含对象的链接 dtor。

> 我尝试使用列表列表，但后来我无法使用 insert() 函数将对象插入列表。有谁知道是什么原因？

不是没有看到你的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T01:34:59.543

STL 使用的解决方案是让容器拥有它所包含的对象。在这种情况下，每个节点都将负责在调用其析构函数时释放其对象。您仍然负责释放您传入的对象的副本。

## 编辑

如果您尝试使用 stl [List](http://www.sgi.com/tech/stl/List.html)并遇到错误，则可能是您尝试放入其中的对象未实现复制构造函数。如果您尝试将指针以外的内容粘贴到列表中，则可能会发生这种情况。如果您对指针感到满意，您可以考虑将它们存储在容器中，而不是对象本身。这将要求您在完成后自己在指针上调用“删除”。这通常是通过在删除节点时对包含在节点中的指针调用“删除”来完成的，或者在完成处理后通过遍历列表并在每个节点的内容上调用“删除”来完成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T01:35:32.630

从头到尾遍历列表，一个一个地删除。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T02:28:13.050

`delete`在清除列表之前，您必须迭代列表和动态分配的对象。

> 使用新指针的容器时，请记住在容器被销毁之前删除指针。

关于使用问题`insert()`：我不太确定您面临的问题是什么。从解释中，我假设您正在尝试将 的对象插入`Class`到列表中，其中列表包含指向`Class`. 您能否详细说明插入的问题？

删除动态分配对象的伪代码：

版本 1：简单

```
list<Class*>::const_iterator iter = m_ClassList.begin();
list<Class*>::const_iterator endIter = m_ClassList.end();
for(;iter!= endIter ; ++iter)
{
   delete *iter;
}
ClassList.clear(); 
```

版本 2：使用 for_each 的更好版本

```
struct DeleteClassObject 
{
  //Functor
  template<typename T>
  void operator()(const T* ptr) const
  {
      delete ptr;
   }
}
//loops through list and deletes the dynamically allocated objects using
//functor DeleteClassObject
for_each( m_ClassList.begin(), m_ClassList.end(), DeleteClassObject ());
DeleteClassObject.clear() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T11:11:55.820

您可以使用 Boost 中的 ptr_list

[http://www.boost.org/doc/libs/1_38_0/libs/ptr_container/doc/ptr_list.html](http://www.boost.org/doc/libs/1_38_0/libs/ptr_container/doc/ptr_list.html)

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-04-27T11:03:06.450

编辑：这是错误的，对不起

*如果您使用的是 std::list，那么有一个明确的功能可以删除您放入的所有对象。 std::list test; test.clear(); 哦，还有 .clear() 也调用了析构函数。要使用此类列表的插入功能，您需要通过迭代器指定位置。test.insert(test.end(), 5); 但是有不止1个插入功能，[here](http://www.cplusplus.com/reference/stl/list/)你可以找到更多细节*

编辑

有人可以在投票时发表评论吗？

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2009-04-27T01:41:39.420

在具有自动内存管理（垃圾收集）的语言/环境中启动您的项目。那么这样的事情将是你最不关心的。这将节省您将精力投入到其他事情上的时间。

# prototype - 使用 Tcl/Tk 对桌面应用程序进行原型设计的优缺点

> ID：791984
> 
> 赞同：3
> 
> 时间：2009-04-27T01:32:44.730
> 
> 标签：prototype, user-interface, desktop, tcl, tk

我已经开始使用 Tcl 制作桌面应用程序的原型，并打算将这个想法展示给一些风险投资家。桌面应用程序和 Tcl 都不是流行的，所以我想准备好反驳对这项技术的任何反对意见。以下是我所看到的专业人士，我确信我期待充实大量的缺点，但希望也有更多的专业人士。

1.  我最初在去年的一份雇佣合同中开始使用 Java 编写一些相同的代码，并且出于法律原因，我想使用一种完全不同的语言来区分我的工作
2.  虽然代码目前作为命令行脚本运行，但有必要应用 UI，Tk 足以满足原型的需求，并且 Tk 与 Tcl 紧密集成。
3.  由于我一般远离 Java，我预见到“生产”，而不是原型，UI 是用 C++ 编写的。Tcl 很容易嵌入到 C++ 应用程序中，因此在将性能关键部分移植到 C++ 之前，底层 TCL 引擎将最初能够被嵌入

我知道一个潜在的骗局是“Tk UI 很丑”，但是如上所述，Tk UI 将用于原型，无论如何，Tk 丑陋的问题已经由您真正提出：[为什么要考虑 Tk GUI丑陋？](https://stackoverflow.com/questions/349409/why-are-tk-guis-considered-ugly)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T01:56:19.383

Tcl/Tk 擅长几件事。一，很容易在很短的时间内开发出工作原型。第二，Tcl 社区比任何其他语言都更好地解决了分发问题。如果这对您很重要，请阅读 starkits 和 starpacks。Tcl 对虚拟文件系统的内置支持以及将所有内容打包到单个可执行文件（或独立的应用程序和依赖于平台的运行时）的能力是首屈一指的。

Tcl 也将 unicode 嵌入到核心中（并且已经有很长一段时间了），这与某些脚本语言不同，其中 unicode 似乎是事后才添加的。这与体面的消息目录支持相结合，使国际化和本地化变得非常容易（从右到左的语言除外）。

如果没有关于您的程序的确切性质的更多详细信息，很难说为什么 Tcl/Tk 可能是适合您的解决方案。它并不适合所有产品，但很多人会惊讶于 Tcl 擅长的东西有多少。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T22:18:23.047

我准备的 VC 问题是：

“你打算如何为此雇用人员？”

我个人的经验是，一种语言的招聘情况（数量和质量）通常比语言特征本身更重要。

还要小心使用需要更多技能的解决方案来捍卫自己的位置，例如嵌入解释器、多语言项目、运行时更改等。这再次，因为熟练的人员是瓶颈。

Ps 我个人拒绝所有非本地 GUI。所以我也讨厌 Java 有一段时间了。但我想这在用于原型设计时并不适用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T01:58:16.743

不要将“丑陋”的原型骗局视为只有 1 个骗局。与非程序员交谈时，它算作 5 或 6 个缺点：[通读一遍，我的观点就在那里](http://www.joelonsoftware.com/articles/fog0000000356.html)

在不了解您的程序的性质的情况下，很难更具体。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-16T15:15:11.187

Tk 有主题的 GUI，并且已经有很长一段时间了。让 TK GUI 看起来接近原生是很容易的。TK 在系统资源上也相当容易（当然比 Winforms 更快更小）。

Tcl 的关键论点是将其用作应用程序的脚本和扩展机制。如果您使用内置 Tcl 解释器用 C++ 编写应用程序，并且可以从 Tk 获得您想要的东西，那么您很可能能够用它自己的脚本语言编写应用程序的重要部分。这将比编写本机 C++ GUI 更快、更容易。但是，Tk 的功能并不是特别丰富，因此您希望在承诺之前可以做自己想做的事情。

# java - Tomcat servlet 应用程序的后台线程

> ID：791986
> 
> 赞同：61
> 
> 时间：2009-04-27T01:32:58.473
> 
> 标签：java, multithreading, tomcat

我对 Tomcat 不是很熟悉，在我的脑海中，它基本上被抽象为一个 cgi 服务器，可以在调用之间保存 JVM——不过我知道它可以做的远不止这些。

我正在寻找一种在 Tomcat 服务器启动时启动*后台*线程的方法，该线程会定期更新服务器上下文（在我的特定情况下，这是一个线程，它监听来自其他一些服务的心跳并更新可用性信息，但可以想象有多种用途）。

有没有标准的方法来做到这一点？上下文的启动和更新/查询？

任何指向相关文档和/或代码示例的指针将不胜感激。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-04-27T01:45:35.477

如果要在部署 WAR 时启动线程，可以在 web.xml 中定义上下文侦听器：

```
<web-app>
    <listener>
       <listener-class>com.mypackage.MyServletContextListener</listener-class>
    </listener>
</web-app> 
```

然后实现该类，例如：

```
public class MyServletContextListener implements ServletContextListener {

    private MyThreadClass myThread = null;

    public void contextInitialized(ServletContextEvent sce) {
        if ((myThread == null) || (!myThread.isAlive())) {
            myThread = new MyThreadClass();
            myThread.start();
        }
    }

    public void contextDestroyed(ServletContextEvent sce){
        try {
            myThread.doShutdown();
            myThread.interrupt();
        } catch (Exception ex) {
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-27T01:48:09.230

> 我正在寻找一种在 Tomcat 服务器启动时启动后台线程的方法

我认为您正在寻找一种在Tomcat 启动*Web 应用程序时启动后台线程的方法。*

这可以使用[ServletContextListener](http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/servlet/ServletContextListener.html)来完成。它在 web.xml 中注册，将在您的应用程序启动或停止时调用。然后，您可以创建（然后停止）您的线程，使用普通的 Java 方法来创建线程（或 ExecutionService）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-03-17T13:35:04.193

将块`<load-on-startup>1</load-on-startup>`放入`<servlet>`web.xml 将强制您的 servlet`init()`在 Tomcat 启动后立即发生，而不是等待第一个请求到达。如果您想从`init()`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-24T09:33:27.353

我只是对克里斯给出的非常详细的答案做一个小改动；我将设置`myThread`为一个守护线程，`myThread.setDaemon(true);`只要您有其他需要您的后台线程的非守护线程在工作，它基本上就会保持线程处于活动状态。当所有这些线程完成时，您的守护程序线程将被 JVM 停止，您无需在`contextDestroyed`. 但这只是我的 2 美分。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-12-04T17:49:36.283

另一种方法是，如果您使用基于 spring 的框架，您可以在 beans.xml 中指定要初始化的类/线程。所以当tomcat启动时，beans.xml会初始化里面提到的所有类。如果需要，您还可以传递构造函数参数。以下是相同的示例。

豆类.xml

```
<bean id="monitoringSvc" class="com.mypackage.MonitoringService">
    <constructor-arg value="60"></constructor-arg>
</bean> 
```

监控服务.java

```
public class MonitoringService{

     private MyThread myThread;

     public MonitoringService(int seconds){
          myThread = new MyThread(seconds);
          myThread.start();
     }
} 
```

# fluent-nhibernate - 根据您的经验，有多少人会为我的新项目推荐流利的 NHibernate 而不是 Nhibernate 的做事方式？

> ID：791990
> 
> 赞同：8
> 
> 时间：2009-04-27T01:34:36.003
> 
> 标签：fluent-nhibernate

我只想做一个快速调查，看看 Fluent Nhibernate 是否受到好评，或者它是否有很多问题。我喜欢 Nhibernate，但我肯定看到了用 xml 进行映射的问题。

因此，我期待社区成员提供一些见解并帮助我选择其中一个。

我目前不考虑 linq2sql 或实体框架。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-27T02:14:07.593

我喜欢 Fluent NHibernate，如果你要开始一个新项目，我认为它已经足够成熟了。在新项目中使用它应该可以让 Fluent NHibernate 项目随着您的进展而继续成熟。有可能发生破坏性更改（最近发生在约定映射中），但您应该能够处理这些更改。我在映射方面遇到了一些问题，但该项目对错误报告非常敏感，并且大部分都按预期工作。

映射选项是：

*   Xml 映射 - NHibernate 的标准。维护难题是众所周知的，但优点是您可以访问 NHibernate 提供的所有配置选项。Fluent 中仍然添加了一些较少使用的配置选项（至少在我上次关注时）。因此，如果您预计会有一些疯狂的映射，您可能需要考虑这个选项。

*   标准映射 - 由 Fluent 提供。您可以通过代码创建映射，并且更适合重构和创作。根据我的经验，没什么好说的，除此之外它运行良好并且是对 xml 选项的重大改进。

*   自动映射 - 由 Fluent 提供。允许您按约定映射对象属性，并尝试自动创建映射。这是一个好主意，但我认为它还有一些成熟的工作要做。我目前正在使用这种映射方法，它工作正常，但我最终编写了大量约定并指定了对象关系，感觉它并没有从标准映射中节省很多精力。

Fluent NHibernate 还提供了很好的测试助手来测试你的映射和一些配置 API，可以使 NHibernate 更容易配置。总的来说，这是一个很好的项目，它为 NHibernate 提供了一些不错的附加功能。

* * *

编辑：

还有一点需要注意：如果您从 Fluent NHibernate 开始并认为它不适用于您的场景，您可以轻松地迁移回 xml 映射。Fluent NHibernate 允许您导出它创建的映射，并且您可以使用这些导出不会丢失您已经完成的任何映射工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-27T01:50:31.427

在 vanilla NH 上使用 Fluent Nhibernate 的最大优势之一是与 PersistenceSpecification `<T`> 的良好集成测试：

```
[Test]  
public void TestProductSave()  
  {  
   new PersistenceSpecification<Product>()  
      .CheckProperty(x => x.ProductName, "Wax")  
      .CheckProperty(x => x.Price, 20)  
      .VerifyTheMappings();  
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T02:00:22.090

我一直在我的一个新项目中使用 fluent。到目前为止，我遇到的唯一小问题是它在开箱即用的 Castle Windsor 中表现不佳，但扩展 Windsor 来完成这项工作很容易。除此之外，我一直很喜欢它。它比 XML 映射更简洁。

fluent 的好处在于它不是全有或全无的投资。您可以用流利的方式编写大部分映射，如果发现任何问题，您可以在标准 XML 映射中映射这些类，直到流利的问题得到解决。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T19:56:19.117

像任何好的答案一样，这取决于。

我没有像我想要的那样从自动映射功能中获得尽可能多的里程。我经常不得不使用预先存在的数据库。

我已经有几个使用 NHibernate 的项目，所以使用 hbm 映射并不困难。在我弄清楚如何包含在 hbm 模式中之后，它就容易多了。

我从 fluent-nhibernate 中获得的一个真正优势是能够重构我的域类并让我的映射自动更改。我并没有真正注意到编写映射的速度有多大提高。

像任何东西一样，YMMV。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T19:36:03.550

我正在将 FNH 用于一个新项目。我最喜欢的是直接从实体类生成和构建数据库的能力。

我不得不为属性编写一些约定，但我宁愿为每个类维护多个列表。

# assembly - 关于汇编 CF(Carry) 和 OF(Overflow) 标志

> ID：791991
> 
> 赞同：30
> 
> 时间：2009-04-27T01:34:49.653
> 
> 标签：assembly, x86, flags

众所周知，CF 表示无符号进位，OF 表示有符号溢出。那么汇编程序如何区分无符号和有符号数据，因为它只是一个位序列？（通过类型信息的额外内存存储，或通过位置信息或其他方式？）这两个标志可以互换使用吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-04-27T01:53:59.937

区别在于使用哪些指令来操作数据，而不是数据本身。现代计算机（大约从 1970 年开始）使用称为二进制补码的整数数据表示，其中加法和减法在有符号和无符号数上的工作方式完全相同。

*   表示的不同之处在于对最高有效位（也称为*符号位*）的解释。对于无符号数，当数字处于完全正范围的上半部分时，设置最高有效位。对于有符号数，当数字在整个范围的下半部分和负半部分时，设置最高有效位。

*   不同的指令可能对同一位使用不同的解释。例如，大多数大型机器都有有符号和无符号乘法指令。具有“小于”指令的机器可能同时具有签名和未签名的风格。

*   OF（溢出标志）表明进位是否翻转了结果中最高有效位的符号，使其与参数的最高有效位不同。如果将数字解释为无符号数，则溢出标志无关紧要，但如果将它们解释为有符号数，则 OF 表示，例如，将两个大的正数相加，结果为负数。

*   CF（进位标志）表明一个位是否完全从字中取出（例如进入第 33 位或第 65 位）。如果数字被解释为无符号，进位标志意味着加法溢出，结果太大而无法放入机器字中。溢出标志无关紧要。

您的问题的答案是汇编代码有几种区分有符号数据和无符号数据的方法：

*   它可以选择 CF 或 OF 进行有符号或无符号比较。
*   它可以选择有符号或无符号乘除法指令。
*   它可以选择有符号或无符号右移（有符号复制高位；无符号移位为零）。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-27T02:43:16.900

不要尝试对标志进行操作编码。那是不可能的。相反，只尝试去了解真相：没有迹象。然后你会发现区分的不是符号类型，而是你自己。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-27T01:59:43.633

处理有符号和无符号数据有不同的操作码。如果一个程序想要比较两个有符号整数，它会使用操作码`jl`、`jle`、`jg`和`jge`，其中 l 和 g*分别*代表 less和*g* reater。如果一个程序想要比较两个无符号整数，它使用操作码`jb`、`jbe`、`ja`和`jae`，其中 a 和 b 分别代表*a* bove 和*b* elow。在所有情况下，e 都代表“或等于”。这些操作码用于基于比较的分支。

类似地，还有一些`setCC`指令，根据比较将一个字节设置为 0 或 1。这些功能相同 - 有`setl`, `setle`, `setg`, `setge`, `setb`, `setbe`, `seta`, `setae`, 等。

签名的操作码测试标志 ZF、OF 和 SF。无符号操作码测试标志 ZF、CF 和 SF。请参阅 80386 程序员参考手册中有关[JCC](http://pdos.csail.mit.edu/6.828/2008/readings/i386/Jcc.htm)指令和[setCC](http://pdos.csail.mit.edu/6.828/2008/readings/i386/SETcc.htm)指令的部分，了解测试的确切条件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-27T01:48:18.343

它没有。只要条件发生，标志就会被设置。程序员应该知道他正在使用哪些类型的 int，并从中知道他是否关心要检查哪个标志。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-27T02:38:28.830

没有办法要求 CPU 测试并返回一个字节/字/长的类型。

0xFF 可能包含“255”或“-1”，这完全取决于您的程序所说的字节类型。

“type”、“signess”等结构仅存在于 Java 等高级语言中，而不存在于 CPU 级别。最后，一切对 CPU 来说都是一个字节，这取决于我们的程序来组织和知道如何解释和操作这些值......

在状态中找到的 CPU 标志不会强制执行任何范例，这取决于您的代码进行测试并做出相应的反应。

在 Intel CPU 上，MMX 和 FPU 寄存器实际上占用相同的寄存器。因此不可能同时混合 FPU 和 MMX 类型的指令，因为来自一个操作的值会破坏另一个操作。需要任一模式的程序通常以一种模式完成其操作，例如发出 FPU 指令，然后可能会启动 MMX，但绝不会同时启动这两种模式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-27T01:47:01.903

通常汇编程序不带变量的特殊信息来指示它们是有符号的还是无符号的。程序员的工作是知道何时检查哪些标志以及何时使用哪些条件（即使用 JA 而不是 JG）。

因此，您需要知道您将使用哪种类型的变量，以便知道要使用哪些命令。这就是为什么大多数编程语言在程序员交替使用有符号/无符号类型（即没有显式转换）时会发出警告的原因，因为这可以在硬件中完成，但会产生意想不到的结果。******`*````