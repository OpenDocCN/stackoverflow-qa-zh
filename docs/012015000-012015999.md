# StackOverflow 问答 12015000-12015999

# c - 在main中调用此函数时是否从内存中删除局部变量

> ID：12015002
> 
> 赞同：2
> 
> 时间：2012-08-18T01:12:54.860
> 
> 标签：c, data-structures, global-variables, local

> **可能重复：**
> [可以在其范围之外访问局部变量的内存吗？](https://stackoverflow.com/questions/6441218/can-a-local-variables-memory-be-accessed-outside-its-scope)
> [局部变量的返回地址](https://stackoverflow.com/questions/11876772/returning-address-of-local-variable)

我有一个问题，首先看代码

```
 #include <stdio.h>

int sum();          /* function declaration */

int main()
{
    int *p2;
    p2 = sum();         /* Calling function sum and coping its return type to pointer variable p2  */
    printf("%d",*p2);
} /*  END of main  */ `

int sum()           
{
    int a = 10;
    int *p = &a;
    return p;
} /*  END of sum */ 
```

我认为答案是 10 和变量 a 的地址，但是我的 tesacher 说 a 是函数的本地变量，所以 a 并且当函数返回或完成执行时，它的值将从内存位置中删除。我尝试了这段代码，答案当然是 10 和地址，我使用 GNU/GCC 编译器。谁能说出什么是对什么是错。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T01:18:43.947

您的老师是绝对正确的：即使您将程序修复为 return`int*`代替`int`，您的程序仍然包含*未定义的行为*。问题是`a`曾经放置的内存已经成熟，可以在`sum`返回后重用。内存可能保持不变供您访问，因此您甚至可以打印十个，但这种行为仍然未定义：它可能在一个平台上运行并在其他十个平台上崩溃。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T01:22:25.780

你可能会得到正确的结果，但这只是因为你很幸运，当 sum() 返回时，*a*的内存返回给系统，它可以被任何其他变量使用，所以值可能是改变了。

例如：

```
#include <stdio.h>

int* sum();          /* function declaration */
int* sum2();          /* function declaration */

int main()
{
    int *p2;
    p2 = sum();         /* Calling function sum and coping its return type to pointer variable p2  */
    sum2();
    printf("%d",*p2);
}

int* sum()           
{
    int a = 10;
    int *p = &a;
    return p;
} /*  END of sum */

int* sum2()           
{
    int a = 100;
    int *p = &a;
    return p;
} /*  END of sum */ 
```

使用此代码，*a*将被 sum2() 重用，从而用 100 覆盖内存值。

在这里你只返回一个指向 int 的指针，假设你正在返回一个对象：

```
TestClass* sum()           
{
    TestClass tc;
    TestClass *p = &tc;
    return p;
} 
```

然后当你取消引用 tc 时，会发生奇怪的事情，因为它指向的内存可能完全被搞砸了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T01:18:50.543

您的指针仍然指向您的 10 所在的内存位置。但是，从 Cs 的角度来看，内存是未分配的，可以重用。在堆栈上放置更多项目或分配内存可能会导致该部分内存被重用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-18T01:33:08.540

函数 sum 中的对象`a`有`automatic lifetime`。`return`一旦程序流（函数末尾的语句）离开它在（函数体）中声明的范围，它的生命周期就会结束。

之后，访问所`a`居住的内存将按照您的预期进行，召唤龙或让您的计算机着火。这在 C 中称为**未定义行为**。然而，C 标准本身没有说明，`deleting something from memory`因为它没有内存的概念。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-18T12:50:45.990

*从逻辑*上讲，一旦退出`a`就不再存在；`sum`它的生命周期仅限于函数的范围。 *从物理*上讲，`a`占用的内存仍然存在，并且仍然包含值 10 的位模式，但是该内存现在可供其他东西使用，并且可能在您使用之前被覆盖`main`。您的输出可能是 10，也可能是垃圾。

试图在该变量的生命周期之外访问该变量的值会导致未定义的行为，这意味着编译器可以自由地以任何它想要的方式处理这种情况。它不必警告你你正在做任何奇怪的事情，它不必按照你期望的方式工作，它根本不需要工作。

# view - 在 OpenERP 视图中显示 many2one 字段

> ID：12015007
> 
> 赞同：1
> 
> 时间：2012-08-18T01:13:32.543
> 
> 标签：view, openerp

'purchase.requisition' 类中有一个 line_ids 字段：

```
 'line_ids' : fields.one2many('purchase.requisition.line','requisition_id',
               'Products to Purchase',states={'done': [('readonly', True)]}), 
```

我在 'purchase.order.line' 中添加了一个 many2one 字段：

```
 'requisition_line_id': fields.many2one('purchase.requisition.line' ,
                 u'Requisition Line',readonly = True ,  ondelete = 'restrict' ), 
```

现在，如何在“purchase.order.line”视图中显示“purchase.requisition”的名称字段？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T09:58:10.463

你可以你fields.related。

例子 ：

```
class hr_employee(osv.osv):
    _name = "hr.employee"

    _columns = {
        'address_id': fields.many2one('res.partner.address', 'Working Address'),
        'city': fields.related('address_id', 'city', type='char', string='City'),
    } 
```

然后在适当的地方添加 moduel_view.xml 之后。

```
<field name="city" /> 
```

在这里，您可以看到 fields.related 的示例。

现在类似尝试解决您的问题。

我希望这对你有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T03:56:51.063

Goto [View Inheritance](http://doc.openerp.com/v6.0/developer/2_6_views_events/views/view_inheritence.html)对你有很大帮助。

# c++ - 动态手势的隐马尔可夫模型训练？

> ID：12015009
> 
> 赞同：3
> 
> 时间：2012-08-18T01:14:17.150
> 
> 标签：c++, opencv, gesture-recognition, hidden-markov-models

我知道有很多与隐藏马尔可夫模型相关的材料，并且我还阅读了与该主题相关的所有问题和答案。我了解它的工作原理以及如何对其进行训练，但是我无法解决在尝试对其进行简单动态手势训练时遇到的以下问题。

我正在[为 OpenCV 使用 HMM 实现，](http://sourceforge.net/projects/cvhmm/) 我已经查看了以前提出的问题并[在此处](https://stackoverflow.com/questions/9733090/issue-in-training-hidden-markov-model-and-usage-for-classification)回答。这确实帮助我理解和使用马尔可夫模型。

我总共有两个动态手势，它们都是对称的（向左滑动和向右滑动）总共有 5 个观察结果，其中 4 个是手势的不同阶段，第 5 个是没有这些阶段发生时的观察。

向左滑动手势由以下观察组成：1->2->3->4（应该触发向左滑动状态） 同样向右滑动手势由以下观察组成：4->3->2->1

我有 25 个序列。我对每个序列进行 20 次观察，用于使用 Baum-Welch 算法训练隐马尔可夫模型。

以下是输入序列：

```
1 0 1 1 0 2 2 2 2 0 0 2 3 3 3 0 0 4 4 4 
4 4 4 4 4 0 3 3 3 3 3 0 0 1 0 0 1 1 0 1 
4 4 4 4 4 4 0 3 3 3 3 3 0 0 1 0 0 1 1 0 
4 4 4 4 4 4 4 0 3 3 3 3 3 0 0 1 0 0 1 1 
1 1 1 1 0 2 2 2 0 1 0 3 3 0 0 0 4 4 4 4 
1 1 1 1 1 0 2 2 2 0 1 0 3 3 0 0 0 4 4 4 
0 1 1 1 1 1 0 2 2 2 0 1 0 3 3 0 0 0 4 4 
0 0 1 1 1 1 1 0 2 2 2 0 1 0 3 3 0 0 0 4 
4 4 0 0 3 0 3 3 3 3 0 0 0 0 0 1 1 1 1 1 
4 4 4 0 0 3 0 3 3 3 3 0 0 0 0 0 1 1 1 1 
4 4 4 4 0 0 3 0 3 3 3 3 0 0 0 0 0 1 1 1 
1 1 1 1 0 0 2 2 0 3 2 3 3 3 0 0 4 4 4 4 
1 1 1 1 1 0 0 2 2 0 3 2 3 3 3 0 0 4 4 4 
1 1 1 1 1 1 0 0 2 2 0 3 2 3 3 3 0 0 4 4 
1 3 4 4 4 0 3 0 0 0 0 0 3 2 0 0 1 1 1 1 
```

在此序列中，您可以看到向左滑动和向右滑动手势的模式。

为了训练隐藏马尔可夫模型，我使用以下值对其进行初始化，然后调用 train 函数以获取输出：

```
TRANS:
0.7 0.15 0.15
0.3 0.4 0.3
0.3 0.4 0.3

EMIS:
0.3 0.1 0.1 0.1 0.1
0.2 0.1 0.2 0.2 0.3
0.2 0.3 0.2 0.2 0.1

INIT:
0.6 0.2 0.2 
```

训练后的输出是：

```
TRANS:
0.81611 0.0847926 0.0990979
0.398458 0.346433 0.255109
0.371391 0.35587 0.272739

EMIS:
0.534127 0.125568 0.0824495 0.200169 0.0576869
0.294653 0.0250053 0.0500311 0.200616 0.429694
0.238808 0.075001 0.0500019 0.130455 0.505733

INIT:
0.443984 0.391323 0.164693 
```

在我的识别程序中使用这个模型，我没有得到结果。我希望系统保持在 NULL 状态，除非检测到其中一个手势。在转换和发射矩阵中，我给出了这两个手势的猜测值。

你觉得我可能做错了什么？任何指示或帮助？

最后这里是我用来做这个的代码（如果有人想看看）

```
double TRGUESSdata[] = {0.7, 0.15, 0.15,
                            0.3, 0.4, 0.3,
                            0.3, 0.4, 0.3};
    cv::Mat TRGUESS = cv::Mat(3,3,CV_64F,TRGUESSdata).clone();
    double EMITGUESSdata[] = {0.3, 0.1, 0.1, 0.1, 0.1,
                              0.2, 0.1, 0.2, 0.2, 0.3,
                              0.2, 0.3, 0.2, 0.2, 0.1};
    cv::Mat EMITGUESS = cv::Mat(3,5,CV_64F,EMITGUESSdata).clone();
    double INITGUESSdata[] = {0.6 , 0.2 , 0.2};
    cv::Mat INITGUESS = cv::Mat(1,3,CV_64F,INITGUESSdata).clone();
    std::cout << seq.rows << " "  << seq.cols << std::endl;
    int a = 0;
    std::ifstream fin;
    fin.open("observations.txt");

    for(int y =0; y < seq.rows; y++)
    {
        for(int x = 0; x<seq.cols ; x++)
        {

            fin >> a;
            seq.at<signed int>(y,x) = (signed int)a;
            std::cout << a;
        }
        std::cout << std::endl;
    }

     hmm.printModel(TRGUESS,EMITGUESS,INITGUESS);
    hmm.train(seq,1000,TRGUESS,EMITGUESS,INITGUESS);
    hmm.printModel(TRGUESS,EMITGUESS,INITGUESS); 
```

这里 fin 用于读取我从其他代码中获得的观察结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T12:36:54.707

你的模型中的 0 是什么意思？在我看来，在您的数据中，两种状态都没有直接转换，它总是回到状态 0。在您的数据中尝试类似以下的状态转换序列。

*   1 1 1 1 2 2 2 2 3 3 3 3 4 4 4 4 4
*   1 2 3 4 0 0 0 0 0 0 0 0 0 0 0 0 0
*   0 0 0 0 1 1 2 2 3 3 4 4 0 0 0 0 0
*   4 4 3 3 2 2 1 1 0 0 0 0 0 0 0 0 0
*   4 4 4 3 3 3 2 2 2 2 2 1 1 1 1 1 1

作为基本规则：

我建议您仅在 Matlab/octave 中获得概念证明**后才使用 openCV。**这有两个原因。首先，您确切地知道自己想做什么以及它是如何工作的，并且不要浪费时间用“低级”语言（与 matlab 相比）实施和调试您的理论。在 openCV 中调试算法非常耗时。

其次，在你知道你的东西按预期工作之后，如果你实现它并遇到一个错误（openCV 或 C++、python），你就会知道这不是你的理论，不是你的实现，而是框架。我已经发生过两次雇佣计算机科学家直接从一篇论文中实现（在被告知不要这样做之后），花费 80% 的剩余时间来调试算法而没有任何成功，结果却发现：他们没有真正得到理论或openCV的某些子模块有一个轻微的错误，这会降低他们的结果。

您提到的链接使用 matlab 中的 HMM 工具箱。尝试在那里实施和理解您的问题，这真的值得花时间。您不仅可以验证每个步骤的正确性，还可以在您拥有工作模型后将迭代矩阵与您的 openCV 代码一起使用。

# perl - Perl 读/写文件句柄 - 无法覆盖

> ID：12015012
> 
> 赞同：1
> 
> 时间：2012-08-18T01:14:50.630
> 
> 标签：perl

我有一个执行特定操作并根据结果更新文件的 Perl 脚本。

基本概述是：

1.  从文件句柄 FILE 中读取一个值
2.  执行一些操作，然后将结果与存储在 INPUT 文件中的值进行比较。
3.  如果有变化，则更新文件句柄对应的文件。

当我说更新时，我的意思是用新的值覆盖 INPUT 文件中的现有值。

脚本概述：

```
#! /usr/bin/perl

use warnings;
use diagnostics;

$input=$ARGV[0];
open(FILE,"+<",$input) || die("Couldn't open the file, $input with error: $!\n");

# perform some operation and set $new_value here.

while(<FILE>)
{
chomp $_;
$old_value=$_;
if($new_value!=$old_value)
{
 print FILE $new_value,"\n";
}
}

close FILE; 
```

但是，这会将 $new_value 附加到文件而不是覆盖它。

我已经在几个地方阅读了有关这种 FILE Handle 模式的文档，并且在它所说的所有地方，读/写模式都没有附加。

我不确定，为什么它无法覆盖。我能想到的一个原因是，由于我正在读取 while 循环中的句柄并尝试同时覆盖它，因此它可能无法正常工作。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T01:25:09.940

你的猜测是正确的。您首先读取文件，因此文件指针实际上位于旧值末尾的位置。我自己没有尝试过，但您可能可以在打印出来之前寻找指向 0 的文件指针。

```
seek(FILE, 0, 0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T13:23:06.030

您应该`truncate`与`seek`.

```
if( $new_value != $old_value )
{
    seek( FILE, 0, 0 );
    truncate FILE, 0;
    print FILE $new_value,"\n";
} 
```

由于文件是为读写而打开的，写一个较短的文件`$new_value`会在文件中留下一些`$old_value`。`truncate`将删除它。

有关详细信息，请参见`perldoc -f seek`和`perldoc -f truncate`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T01:20:46.723

您必须关闭文件句柄并打开另一个设置为输出文件的（或相同的）。像这样。

```
close FILE;
open FILE, ">$input" or die $!;

...

close FILE; 
```

这应该够了吧

# ruby - RVM 未绑定变量

> ID：12015039
> 
> 赞同：1
> 
> 时间：2012-08-18T01:21:14.490
> 
> 标签：ruby, rvm

我正在尝试使用 RVM 安装 Ruby 1.9.2，但运行此命令时出现以下错误`rvm install 1.9.2`：

```
**-bash**: rvm_env_string: unbound variable

Could not detect ruby version/name for installation, please be more specific. 
```

很确定 RVM 正是基于该参数运行的，知道为什么 rvm_env_string 未绑定吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T18:17:10.777

看起来你有：

```
set -o nounset 
```

找到它并关闭它。

RVM1 与它不兼容，我将在 RVM2 上工作以在任何地方工作，并且始终保持相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T01:52:43.057

也许你没有最新的 rvm？尝试：

1.  `rvm get latest`
2.  或作为最后的手段`rvm implode`，然后重新安装 rvm

# vb.net - MVC 扩展方法被加载两次

> ID：12015048
> 
> 赞同：2
> 
> 时间：2012-08-18T01:22:30.643
> 
> 标签：vb.net, model-view-controller, extension-methods

这是我的扩展方法：

`Public Module HtmlExtensions System.Runtime.CompilerServices.Extension Public Function ReverseMapPath(ByVal html As HtmlHelper, ByVal path As String) As String Dim appPath = HttpContext.Current.Server.MapPath("~") Dim res As String = String.Format("{0}", path.Replace(appPath, "/").Replace("\", "/")) Return res End Function End Module` 我的 web.config 有我的命名空间的条目

一切正常。我开始向项目添加更多代码，现在我收到一个错误，看起来好像我正在加载扩展方法两次，但我不知道为什么。错误是： `path.page.vbhtml(9): error BC30521: Overload resolution failed because no accessible 'FunctionName' is most specific for these arguments: Extension method 'Public Function FunctionName(path As String) As String' defined in 'namespace.Extensions.HtmlExtensions': Not most specific. Extension method 'Public Function FunctionName((path As String) As String' defined in 'namespace.Extensions.HtmlExtensions': Not most specific.`

我不明白为什么这只是悄悄地出现了。显然我改变了一些东西，但撤销一切并没有帮助。该错误似乎更多地落后于 .net 框架。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-19T18:59:56.287

我刚遇到这个问题。如果您阅读 CrazyTim 评论的链接，则问题来自 VS 在项目中添加对其自身的引用。

如果您遇到此问题，VS 可能已在您的项目中添加了对其自身的引用。删除参考，你会像雨一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T02:22:01.957

看来这是一个命名空间问题。我的扩展类有 Global.ProjectName 作为命名空间。一旦我改变了一切正常。由于命名空间，它一定已经加载了两次。

# solr - Solr 3.6 中的 ExternalFileField

> ID：12015049
> 
> 赞同：1
> 
> 时间：2012-08-18T01:22:34.217
> 
> 标签：solr

我正在尝试使用 Solr 3.6.1 `ExternalFileField`。这是我的字段类型定义：

```
<fieldtype name="file" keyField="id" defVal="0" stored="true" indexed="true" class="solr.ExternalFileField" valType="float"/> 
```

这是字段定义：

```
<field name="fviews" type="file"/> 
```

`fviews`我能够通过排序来测试它

```
http://localhost:8983/solr/select?q=tag_id:1&sort={!func}fviews desc 
```

它工作正常。

但是我遇到了两个问题：

我需要这个字段回到我的搜索结果中。即使我已经标记了该字段，因为`stored="true"`我没有取回它。我什至尝试添加`&fl=*`查询参数，但它不起作用。

如果我对外部文件进行更改，它们不会立即反映在搜索结果中（这正是我想使用外部文件字段的原因）。[https://lucene.apache.org/solr/api-4_0_0-BETA/org/apache/solr/schema/ExternalFileField.html](https://lucene.apache.org/solr/api-4_0_0-BETA/org/apache/solr/schema/ExternalFileField.html)上的 solr 4.0 文档显示*“如果外部文件已加载，并且已更改，在提交完成之前，这些更改将不可见。”* . 我尝试使用提交`http://localhost:8983/solr/update?commit=true`，希望 Solr 可以根据修改后的时间戳读取编辑后的文件，但它不起作用。但是，如果我进行完全导入，那么结果是正确的。

**更新（答案）**：下面的@Persimmonium 已经回答了第二个问题。第一个问题（如何检索值）的答案是使用我写的这篇[博](http://www.openjems.com/solr-external-file-fields/)`fl=*,field(EXTERNAL_FILE_FIELD_NAME)`文中提到的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T12:34:16.633

关于未返回的外部字段，我不知道，但这可能是此类字段的限制，因为它们也无法搜索。

关于重新加载，我必须这样做才能重新加载它们：

在`solrconfig.xml`添加以下处理程序：

```
<requestHandler name="/reloadCache" class="org.apache.solr.search.function.FileFloatSource$ReloadCacheRequestHandler" /> 
```

现在修改一些会改变排序的文件值。这是最重要的事情，点击以下网址，否则 Solr 将不会使用新值。

[http://your.host:8983/solr/core0/reloadCache](http://your.host:8983/solr/core0/reloadCache)

# macos - mac 用户特定的编译/安装路径

> ID：12015056
> 
> 赞同：0
> 
> 时间：2012-08-18T01:23:26.130
> 
> 标签：macos, compilation, directory

我想将 MySQL 编译到我的 Mac 上的用户特定目录中。我知道如何编译它和一切，它只是我正在寻找的目录选择。问题开始于：

/usr/local 用户是特定的吗？如果我在活跃用户 Bob 上将它安装到那里，Joe 是否能够看到和访问它，或者只有 Bob？

我怀疑情况并非如此。如果是这样，那就太好了！如果不是，那么哪里是编译和安装东西的最佳位置，以便我可以控制哪些用户可以查看和访问它？

请记住，这些是针对更复杂的东西，比如编译 MySQL，所以我不希望它们在一些通用应用程序文件夹中（这就是为什么 /usr/local 如果它具有这种用户特定性会很棒）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T01:32:01.233

`/usr/local`是系统特定的......所以是的 Bob 可以使用它。你通常在我的用户家中保留一个目录结构，所以：

```
/Users/username/
  lib/
  bin/
  etc/ 
```

你可以在那里安装它。也就是说，您可以只修改用户和组设置，以获得只有您和系统所属的组的执行权限。我实际上认为这将是更好的方式，因为将它放在您的主目录中可能会带来更多障碍，因为您可能希望将 mysql 服务器作为守护进程运行。

# ios - 无法从我的应用程序中删除 testflight sdk

> ID：12015057
> 
> 赞同：1
> 
> 时间：2012-08-18T01:23:47.243
> 
> 标签：ios, xcode, caching, testflight

我在我的应用程序中包含了 testflight sdk，但后来决定将其删除。我已经删除了该库，并在我的 Xcode 项目中对它的所有引用。现在，当我从 xcode 在我的 iPad 上运行该应用程序时，安装在我的 iPad 上的应用程序是免费的 testflight。但是，当我创建 ipa 并将其传输到我的 iPad 时，它包含 testflight sdk，并且控制台日志显示每次启动时都会启动 testflight 会话。

我已经删除了各种缓存，并且已经这样做了几十次，但无法从我的 SDK 中删除 Testflight。任何人都知道哪些缓存可能对此负责？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-27T07:30:16.153

尝试“移动到垃圾箱”整个库文件。

# javascript - Webgl加载json模型问题

> ID：12015058
> 
> 赞同：0
> 
> 时间：2012-08-18T01:24:51.643
> 
> 标签：javascript, json, webgl

好的...我有一个模型，当我直接在 javascript 中编写顶点和索引时，一切正常；但是，如果我尝试从 json 调用中加载相同的模型，该模型会说它已加载但从未出现。

有任何想法吗？？？

这是代码：[http ://www.guioui.c​​om/justforfun/webgl/index.htm](http://www.guioui.com/justforfun/webgl/index.htm)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T10:45:59.933

我认为您犯了一个小的复制粘贴错误：

你的线 192

```
gl.bufferData(gl.ELEMENTS_ARRAY_BUFFER, new Uint16Array(model.normals), gl.STATIC_DRAW); 
```

应该

```
gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(model.normals), gl.STATIC_DRAW); 
```

因为它是浮点数组缓冲区 - 而不是元素数组缓冲区。

# mysql - 从mysql数据生成直方图

> ID：12015060
> 
> 赞同：1
> 
> 时间：2012-08-18T01:25:08.543
> 
> 标签：mysql, sql, histogram

我想知道是否有人对我的直方图生成查询有一些建议。我有一个我喜欢的查询（因为它有效），但它非常慢。这是背景：

我有一个元数据表，一个数据值表，其中 meta_data 中的一行是 data_values 中许多（可能是几千）行的键行，还有一个直方图 bin 信息表：

```
create table meta_data (
    id int not null primary key, 
    name varchar(100), 
    other_data char(10)
);
create table data_values (
    id int not null primary key, 
    meta_data_id int not null, 
    data_value real
);
create table histogram_bins (
    id int not null primary key,
    bin_min real,
    bin_max real,
    bin_center real,
    bin_size real
); 
```

以及创建直方图的查询：

```
SELECT md.name AS `Name`, 
       md.other_data AS `OtherData`, 
       hist.bin_center AS `Bin`, 
       SUM(data.data_value BETWEEN hist.bin_min AND hist.bin_max) AS `Frequency`
FROM   histogram_bins hist 
       LEFT JOIN data_values data ON 1 = 1 
       LEFT JOIN meta_data md ON md.id = data.meta_data_id

GROUP BY md.id, `Bin`; 
```

在此查询的早期版本中，BETWEEN ... AND 逻辑语句在 JOIN 中已关闭（替换 1 = 1），但我只会收到频率非零的直方图行。出于分析目的，我需要所有箱（甚至是零频率箱）的行。

它非常缓慢，大约10-15分钟左右。data_values 表有大约 790 万行，而 meta_data 有 15,900 行——所以可能需要很长时间！

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T02:42:20.763

我认为这可能会有所帮助

```
SELECT h.bin_center AS `Bin`, 
   ISNULL(F.Frequency,0) AS `Frequency`
FROM  histogram_bins h
LEFT JOIN 
   (SELECT hist.bin_center AS `Bin`, 
           COUNT(data_values) AS `Frequency`
    FROM data_values  data
    LEFT JOIN histogram_bins hist ON data.data_value BETWEEN hist.bin_min AND hist.bin_max        
    GROUP BY md.name, md.other_data, hist.bin_center) F ON F.bin_center = h.bin_center 
```

我更改了表格的顺序，因为我认为最好为数据中的每条记录找到相应的 bin，然后只计算按 bin 分组的数量

# css - 多个 HTML 5 画布

> ID：12015062
> 
> 赞同：0
> 
> 时间：2012-08-18T01:25:19.153
> 
> 标签：css, html

我是 HTML 5 的新手，我最近创建了一个有问题的页面。我将导航链接与标签组合在一起，效果很好。问题是页面上的其他链接根本不起作用。这可能是一个明显的解决方法，但我已经挣扎了几个小时。我可以提供代码，但它有 400 行，我认为有人可能有一个想法。

感谢你的帮助

-汤姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T06:56:23.353

对于初学者，请确保您的标记是有效的。一个好的开始方法是使用[W3C Validator](http://validator.w3.org/)。如果这是有效的，则使用[JS Hint](http://www.jshint.com/)或[JS Lint](http://www.jslint.com/)对 JavaScript 执行相同的操作。并且不要忘记检查 Chrome 或 FireFox 中的开发者控制台，因为它也可能显示错误。

# mongodb - MongoDB、MapReduce 和排序

> ID：12015064
> 
> 赞同：11
> 
> 时间：2012-08-18T01:25:30.127
> 
> 标签：mongodb, mongodb-php, mongodb-query

我可能对此有点不知所措，因为我仍在学习 MongoDB 的来龙去脉，但这里有。

现在我正在开发一种工具来搜索/过滤数据集，按任意数据点（例如流行度）对其进行排序，然后按 id 对其进行分组。我认为我能做到这一点的唯一方法是通过 Mongo 的 MapReduce 功能。

我不能使用 .group() 因为我正在使用超过 10,000 个键，而且我还需要能够对数据集进行排序。

我的 MapReduce 代码运行良好，除了一件事：排序。排序根本不想工作。

```
db.runCommand({
  'mapreduce': 'products',
  'map': function() {
    emit({
      product_id: this.product_id,
      popularity: this.popularity
    }, 1);
  },
  'reduce': function(key, values) {
    var sum = 0;
    values.forEach(function(v) {
      sum += v;
    });

    return sum;  
  },
  'query': {category_id: 20},
  'out': {inline: 1},
  'sort': {popularity: -1}
}); 
```

我已经在流行数据点上有一个降序索引，所以它肯定因为缺少它而不起作用：

```
{ 
  "v" : 1, 
  "key" : { "popularity" : -1 }, 
  "ns" : "app.products", 
  "name" : "popularity_-1" 
} 
```

我只是无法弄清楚为什么它不想排序。

由于此功能的工作方式，我无法将结果集内联，而是将其输出到另一个集合，然后对其运行 .find().sort({popularity: -1}) 。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-18T06:16:46.573

首先，Mongo map/reduce 不是为用作查询工具而设计的（就像在 CouchDB 中一样），它是为您运行后台任务而设计的。我在工作中使用它来分析交通数据。

但是，您做错的是您将 sort() 应用于您的输入，但它没有用，因为当`map()`阶段完成时，中间文档按 each 排序`keys`。因为您的密钥是一个文档，所以它是按 , 排序`product_id`的`popularity`。

这就是我生成数据集的方式

```
function generate_dummy_data() {
    for (i=2; i < 1000000; i++) { 
        db.foobar.save({
          _id: i, 
         category_id: parseInt(Math.random() * 30), 
         popularity:    parseInt(Math.random() * 50)
        }) 
    }
} 
```

这是我的地图/减少任务：

```
var data = db.runCommand({
  'mapreduce': 'foobar',
  'map': function() {
    emit({
      sorting: this.popularity * -1,
      product_id: this._id,
      popularity: this.popularity,
    }, 1);
  },
  'reduce': function(key, values) {
    var sum = 0;
    values.forEach(function(v) {
      sum += v;
    });

    return sum;  
  },
  'query': {category_id: 20},
  'out': {inline: 1},
}); 
```

这是最终的结果（很长的粘贴在这里）：

[http://cesarodas.com/results.txt](http://cesarodas.com/results.txt)

这是有效的，因为现在我们按`sorting, product_id, popularity`. 你可以随心所欲地进行排序，只要记住最终排序是由`key`你输入的排序方式决定的。

无论如何，正如我之前所说，您应该避免使用 Map/Reduce 进行查询，它是为后台处理而设计的。如果我是你，我会设计我的数据，以便我可以通过简单的查询访问它，在这种情况下，总是需要权衡复杂的插入/更新来进行简单的查询（这就是我对 MongoDB 的看法）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-18T06:02:24.633

如对原始问题的讨论所述：

*   具有内联输出的 Map/Reduce 当前无法使用显式`sort`键（请参阅[SERVER-3973](https://jira.mongodb.org/browse/SERVER-3973)）。可能的解决方法包括依赖发出的密钥顺序（请参阅@crodas 的答案）；输出到集合并按排序顺序查询该集合；[或使用类似usort()](http://php.net/manual/en/function.usort.php)的方法对应用程序中的结果进行排序。

*   OP 的偏好是内联结果，而不是创建/删除临时集合。

*   MongoDB 2.2 中的[聚合框架](http://docs.mongodb.org/manual/applications/aggregation/)（目前是生产候选版本）将提供合适的解决方案。

这是一个与原始 Map/Reduce 类似的查询示例，但使用的是聚合框架：

```
db.products.aggregate(
  { $match: { category_id: 20 }},
  { $group : {
     _id : "$product_id",
     'popularity' : { $sum : "$popularity" },
  }},
  { $sort: { 'popularity': -1 }}
) 
```

..和样本输出：

```
{
    "result" : [
        {
            "_id" : 50,
            "popularity" : 139
        },
        {
            "_id" : 150,
            "popularity" : 99
        },
        {
            "_id" : 123,
            "popularity" : 55
        }
    ],
    "ok" : 1
} 
```

# c# - WCF：FaultContract 已设置但未导致 FaultException 陷入 REST 服务

> ID：12015067
> 
> 赞同：2
> 
> 时间：2012-08-18T01:25:38.050
> 
> 标签：c#, xml, json, wcf, rest

我刚开始使用 WCF，并试图验证支持 JSON 和 XML 的 WCF 休息服务中的故障处理。[我的测试服务](https://gist.github.com/3383673#file_server_program.cs)产生了一个故障，但无论我尝试什么，我都无法让[我的客户](https://gist.github.com/3383673#file_client_program.cs)获取故障的详细信息（并且行为因请求格式和 http 状态代码而异）：

我的测试服务产生的故障如下：

```
public Data GetResponse()
{
    throw new WebFaultException<ErrorDetails>(
        new ErrorDetails {ErrorMessage = "Server Config Value not set"},
        HttpStatusCode.OK
        );
} 
```

这相当合理地通过网络发送：

```
{"ErrorMessage":"Server Config Value not set"} 
```

和：

```
<ErrorDetails xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
    <ErrorMessage>Server Config Value not set</ErrorMessage>
</ErrorDetails> 
```

我的客户定义为`FaultContract`：

```
[OperationContract]
[WebInvoke(
    UriTemplate="/response",
    Method="GET",
    RequestFormat = WebMessageFormat.Xml, // or .Json
    ResponseFormat = WebMessageFormat.Xml // or .Json
    )]
[FaultContract(typeof(ErrorDetails), Namespace="")]
Data GetResponse(); 
```

这是（格式/状态代码）的完整错误消息：

XML/冲突：

> 请求响应 CommunicationException：远程服务器返回意外响应：(409) Conflict., System.Collections.ListDictionary Internal, System.ServiceModel.ProtocolException Press a key to exit...

和 XML/OK：

> 请求响应异常：无法使用 DataContractSerializer 反序列化具有根名称“ErrorDetails”和根命名空间“”的 XML 主体（用于操作“GetResponse”和合同（“IClient”，“”））。确保将XML对应的类型添加到服务的know n types集合中。，System.Collections.ListDictionaryInternal Press a key to exit...

和 JSON/冲突：

> 请求响应 CommunicationException：远程服务器返回意外响应：(409) Conflict., System.Collections.ListDictionary Internal, System.ServiceModel.ProtocolException Press a key to exit...

和 JSON/OK：

> 请求响应 响应：请求完成 按某个键退出...

客户端代码以正确的顺序捕获异常：

```
try
{
    Console.WriteLine("Requesting response");
    Console.WriteLine("Response: " + client.GetResponse().Message);
    Console.WriteLine("Request complete");
}
// sanity check, just in case...
catch (WebFaultException<ErrorDetails> ex)
{
    Console.WriteLine("WebFaultException<ErrorDetails>: " + ex.Detail.ErrorMessage + ", " + ex.Reason);
}
catch (FaultException<ErrorDetails> ex)
{
    Console.WriteLine("FaultException<ErrorDetails>: " + ex.Detail.ErrorMessage + ", " + ex.Reason);
}
catch (FaultException ex)
{
    Console.WriteLine("FaultException: " + ex.Message + ", " + ex.Reason);
}
catch (CommunicationException ex)
{
    Console.WriteLine("CommunicationException: " + ex.Message + ", " + ex.Data + ", " + ex.GetType().FullName);
}
catch (Exception ex)
{
    Console.WriteLine("Exception: " + ex.Message + ", " + ex.Data);
} 
```

我必须做什么才能`FaultException<ErrorDetails>`被抛出并且我可以访问`ErrorDetails`?

注意：[要点](https://gist.github.com/3383673)应该是完全可编译和可运行的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T22:20:39.573

在 WCF REST 客户端（从 WCF 4.0 版开始）服务中，不能使用 Faults/FaultContract 作为错误处理机制：

WCF 列表中的每个[线程：](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/bc73f10f-68ea-45c8-a057-2b79f7c1ae69)

> 在 WCF Rest 服务中没有 SOAP 消息，因此您无法向客户端返回 FaultException。实际上，适当的状态码作为 HTTP 标头返回给请求者，允许请求者确定调用的结果。

并来自[StackOverflow 帖子](https://stackoverflow.com/a/8830759/103842)：

> 故障是 SOAP 协议的一部分，在 REST 场景中不可用

**考虑的选项**

[FaultContract](http://msdn.microsoft.com/en-us/library/system.servicemodel.faultcontractattribute.aspx) -`FaultContractAttribute`适用于 SOAP 信封，但不适用于 WCF REST 服务。如果您通过格式化为 SOAP 信封的格式发送 XML，您可以让它工作，但是您没有使用合理的自定义错误消息。

[IErrorHandler](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.ierrorhandler.aspx) - 快速阅读文档表明这是针对服务的，并认为这是一个新手错误：“允许实现者控制返回给调用者的错误消息，并可选择执行自定义错误处理，例如日志记录。”

[消息检查器](http://msdn.microsoft.com/en-us/library/aa717047.aspx)-`AfterReceiveRequest`不执行，因为`CommunicationException`首先抛出 。

**解决方法**

经过一番挖掘后，我[发现一位博主](http://kenneththorman.blogspot.com/2011/02/wcf-rest-exception-handling.html)建议创建一个帮助类来从嵌入在异常对象中的响应流中提取信息。这是他的实现，原样：

```
public static void HandleRestServiceError(Exception exception, Action<TServiceResult> serviceResultHandler, Action<TServiceFault> serviceFaultHandler = null, Action<Exception> exceptionHandler = null)
{
  var serviceResultOrServiceFaultHandled = false;

  if (exception == null) throw new ArgumentNullException("exception");
  if (serviceResultHandler == null) throw new ArgumentNullException("serviceResultHandler");

  // REST uses the HTTP procol status codes to communicate errors that happens on the service side.
  // This means if we have a teller service and you need to supply username and password to login
  // and you do not supply the password, a possible scenario is that you get a 400 - Bad request.
  // However it is still possible that the expected type is returned so it would have been possible 
  // to process the response - instead it will manifest as a ProtocolException on the client side.
  var protocolException = exception as ProtocolException;
  if (protocolException != null)
  {
    var webException = protocolException.InnerException as WebException;
    if (webException != null)
    {
      var responseStream = webException.Response.GetResponseStream();
      if (responseStream != null)
      {
        try
        {
          // Debugging code to be able to see the reponse in clear text
          //SeeResponseAsClearText(responseStream);

          // Try to deserialize the returned XML to the expected result type (TServiceResult)
          var response = (TServiceResult) GetSerializer(typeof(TServiceResult)).ReadObject(responseStream);
          serviceResultHandler(response);
          serviceResultOrServiceFaultHandled = true;
        }
        catch (SerializationException serializationException)
        {
          // This happens if we try to deserialize the responseStream to type TServiceResult
          // when an error occured on the service side. An service side error serialized object 
          // is not deserializable into a TServiceResult

          // Reset responseStream to beginning and deserialize to a TServiceError instead
          responseStream.Seek(0, SeekOrigin.Begin);

          var serviceFault = (TServiceFault) GetSerializer(typeof(TServiceFault)).ReadObject(responseStream);

          if (serviceFaultHandler != null && serviceFault != null)
          {
            serviceFaultHandler(serviceFault);
            serviceResultOrServiceFaultHandled = true;
          }
          else if (serviceFaultHandler == null && serviceFault != null)
          {
            throw new WcfServiceException<TServiceFault>() { ServiceFault = serviceFault };
          }
        }
      }
    }
  }

  // If we have not handled the serviceResult or the serviceFault then we have to pass it on to the exceptionHandler delegate
  if (!serviceResultOrServiceFaultHandled && exceptionHandler != null)
  {
    exceptionHandler(exception);
  }
  else if (!serviceResultOrServiceFaultHandled && exceptionHandler == null)
  {
    // Unable to handle and no exceptionHandler passed in throw exception to be handled at a higher level
    throw exception;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-13T10:50:53.003

我用过这个：

```
 try
            {
              //wcf service call
            }
            catch (FaultException ex)
            {
               throw new Exception( (ex as WebFaultException<MyContractApplicationFault>).Detail.MyContractErrorMessage );                
            } 
```

# php - 从 .post() 获取对 PHP 文件的响应，但仅在 MVC 内

> ID：12015072
> 
> 赞同：0
> 
> 时间：2012-08-18T01:27:32.600
> 
> 标签：php, javascript, jquery, validation

我的 JavaScript 文件包含以下代码：

```
$.post('./admin/test.php', {
        todoID:todoID
    }, function(data){
        $("."+todoID).html(data);           
    }); 
```

我应该从中获得响应的 PHP 文件包含以下内容：

```
 if (!defined(__ACCESS)) {
     die("Access Denied!");
  }  

  echo '<span><input type="button" value="Edit" /></span>
  <span><input type="button" value="View" /></span>
  <span><input type="button" value="Delete" /></span>'; 
```

当然，我得到的响应是“拒绝访问！”。

因为`__ACCESS`是在 index.php 中定义的，那是因为我不希望有人能够在未经验证的情况下运行任何 PHP 脚本（如果用户正常，如果他尝试单独调用脚本，他会首先被拒绝访问）。

那么有没有办法验证该调用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T03:26:14.657

好久没碰 PHP 代码了，不过这种事情的一般机制是：

1.  用户登录到您的 Web 应用程序。服务器生成会话，并将会话 ID 作为 cookie 返回给客户端。

2.  Ajax 调用会保留所有 cookie，因此当您执行 POST 时，您的会话 ID 会再次发送。

3.  如果请求具有有效（未过期）的源会话 ID，则认为已通过身份验证。

看看另一个问题：[how to implement php login or authentication session](https://stackoverflow.com/questions/1590103/how-to-implement-php-login-or-authentication-session)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T02:04:54.287

简单的解决方法是：

```
include 'index.php';
if (!defined(__ACCESS)) {
    die("Access Denied!");
} 
```

更好的解决方法是使用适当的身份验证框架。甚至是一般的框架。

# r - 如何指定使用哪个库的函数？

> ID：12015073
> 
> 赞同：3
> 
> 时间：2012-08-18T01:27:38.317
> 
> 标签：r

> **可能重复：**
> [R：屏蔽函数](https://stackoverflow.com/questions/4879377/r-masked-functions)

我正在使用包`moments`和`fUnitRoots`. 它们都有一个名为“kurtosis”的函数（更准确地说，包`fUnitRoots`调用`timeDate`也具有函数“kurtosis”的包）。它们给出了非常不同的结果，因为它们的公式略有不同。我想使用 library 中的函数 skewness `moments`，但是如果加载了两个库，则使用的函数是来自`fUnitRoots`.

如何在*不卸载其中一个库的情况下*指定要从哪个库中使用给定函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T01:31:31.187

使用`::`运算符。语法是`package::name`. 所以它会`moments::kurtosis`。

# javascript - 将 @font-face 样式表规则添加到 chrome 扩展

> ID：12015074
> 
> 赞同：11
> 
> 时间：2012-08-18T01:27:49.377
> 
> 标签：javascript, css, google-chrome-extension, font-face, content-script

通过 chrome 扩展添加 @font-face 样式表规则的推荐方法是什么？问题是字体嵌入的 url 位于扩展内，所以我必须在 javascript 中执行才能使用`chrome.extension.getURL`.

我已经尝试`document.styleSheets[0].addRule`过一个内容脚本，但这没有用。为了澄清，我还在 web_accessible_resources 下列出了字体。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-18T02:29:03.627

`<style>`在您的内容脚本中注入一个节点。像这样：

```
var styleNode           = document.createElement ("style");
styleNode.type          = "text/css";
styleNode.textContent   = "@font-face { font-family: YOUR_FONT; src: url('"
                        + chrome.extension.getURL ("YOUR_FONT.otf")
                        + "'); }"
                        ;
document.head.appendChild (styleNode); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-07-20T17:44:47.173

您还可以在 manifest.json`web_accesible_resources`部分中指定您的扩展使用的任何其他内容。文档在[这里](https://developer.chrome.com/extensions/manifest/web_accessible_resources)。

将此添加到您的 manifest.json 文件中：

```
 "web_accessible_resources": [
    "fonts/*.*",
    "templates/*.html"
 ] 
```

并且在你的 css 中更正 url：

```
@font-face {
  font-family: 'MyFont';
  src: url('chrome-extension://__MSG_@@extension_id__/fonts/font.eot') /* ... */;
} 
```

# php - zend_dom_query 未定义的方法

> ID：12015077
> 
> 赞同：0
> 
> 时间：2012-08-18T01:28:22.497
> 
> 标签：php, zend-framework

我只是在构建一个脚本来检查页面中的某些内容，并且我遇到了 Zend 方法的问题。这是有问题的功能：

```
function parse_html($html) {

    $dom = new Zend_Dom_Query($html);
    $table_rows = $dom->query('tr');

    foreach ($table_rows as $table_row) {
         $table_row->query('td.startTimeDateColumnHeader')->nodeValue;
    }

} 
```

但是我收到此错误：

`Call to undefined method DOMElement::query()`

关于这条线：

```
$table_row->query('.startTimeDateColumnHeader')->nodeValue; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T09:29:58.820

该错误告诉您 php 类[DOMElement](http://php.net/manual/en/class.domelement.php)没有可调用的名为 query 的方法。

解释一下：您使用[Zend_Dom_Query](http://framework.zend.com/manual/en/zend.dom.query.html)对 DOM 文档执行了查询，返回的结果是[DOMElements](http://php.net/manual/en/class.domelement.php)和[DOMNodes](http://www.php.net/manual/en/class.domnode.php)的形式，因此 query() 不再可用。

您可能需要执行以下操作：

```
$table_row->getAttribute('.startTimeDateColumnHeader'); 
```

我可能选择了错误的方法，但我希望你能明白。

# php - 是否有任何理由不允许我的 php 程序中的用户名使用所有字符？

> ID：12015078
> 
> 赞同：0
> 
> 时间：2012-08-18T01:28:45.713
> 
> 标签：php

对于我的第一个 php 网站，我目前允许在用户名中使用所有字符。当它们插入数据库时​​，我使用addslashes()，当从数据库中检索它们时，我使用stripslashes()，然后我使用htmlentities() 使它们在页面上正确显示。到目前为止我还没有遇到任何问题，但是出于任何原因，我是否应该在用户名中禁止使用任何字符？HTML、CSS 和 PHP 是我唯一能流利使用的语言，而且我担心将来我会遇到 PHP 或 Java 或其他语言中难以解析某些字符的函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T01:32:29.337

许多字符可能会导致问题：

显然html和SQL中有特殊含义的字符，你已经处理过了。

其他可能性是：

*   对于搜索用户，正则表达式字符/通配符，例如。*, ?

*   如果您想给用户一个电子邮件地址，电子邮件仅支持字母数字字符、下划线和不相邻的点，并且许多系统假定电子邮件不区分大小写（尽管不是规范的一部分）

*   如果您想为用户提供一个 url 包含其用户名的个人资料页面，则需要对许多字符进行正确编码。

*   非 ascii 字符可能会导致问题，具体取决于用户名的存储方式（如果它们存储在支持 UTF-8 的字段中，则支持任何字符）

# java - 使用 Jackson 解析器获取整个 JSON 对象

> ID：12015080
> 
> 赞同：1
> 
> 时间：2012-08-18T01:29:03.693
> 
> 标签：java, json, parsing, jackson, gson

使用 GSON，我可以写这个

```
JsonStreamParser parser = new JsonStreamParser(reader);
System.out.println(parser.next()); 
```

如果流由 JSON 对象组成，它会将整个对象打印为字符串。

有没有一种简单的方法可以用杰克逊做到这一点，还是我需要使用我在示例中看到的 while 循环模式？

所以如果第一个对象是： { "id": 1, "name": "Foo", "price": 123, "tags": [ "Bar", "Eek" ], "stock": { "warehouse" ：300，“零售”：20 } }

打印的第一行是：

{"id": 1,"name": "Foo","price": 123,"tags": [ "Bar", "Eek" ],"stock": {"warehouse": 300,"retail": 20}}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T02:27:11.277

在流模式下，每个 JSON “字符串”都被视为单个令牌，并且每个令牌都将被增量处理，这就是我们称之为“增量模式”的原因。例如，

> ```
> {
>    "name":"mkyong"
> }
> Token 1 = “{“
> Token 2 = “name”
> Token 3 = “mkyong”
> Token 4 = “}” 
> ```

您可以编写以下代码来解析上述json文本

```
import java.io.File;
import java.io.IOException;
import org.codehaus.jackson.JsonFactory;
import org.codehaus.jackson.JsonGenerationException;
import org.codehaus.jackson.JsonParser;
import org.codehaus.jackson.JsonToken;
import org.codehaus.jackson.map.JsonMappingException;

public class JacksonStreamExample {
   public static void main(String[] args) {

     try {

    JsonFactory jfactory = new JsonFactory();

    /*** read from file ***/
    JsonParser jParser = jfactory.createJsonParser(new File("c:\\user.json"));

    // loop until token equal to "}"
    while (jParser.nextToken() != JsonToken.END_OBJECT) {

        String fieldname = jParser.getCurrentName();
        if ("name".equals(fieldname)) {

          // current token is "name",
                  // move to next, which is "name"'s value
          jParser.nextToken();
          System.out.println(jParser.getText()); // display mkyong

        }

        if ("age".equals(fieldname)) {

          // current token is "age", 
                  // move to next, which is "name"'s value
          jParser.nextToken();
          System.out.println(jParser.getIntValue()); // display 29

        }

        if ("messages".equals(fieldname)) {

          jParser.nextToken(); // current token is "[", move next

          // messages is array, loop until token equal to "]"
          while (jParser.nextToken() != JsonToken.END_ARRAY) {

                     // display msg1, msg2, msg3
             System.out.println(jParser.getText()); 

          }

        }

      }
      jParser.close();

     } catch (JsonGenerationException e) {

      e.printStackTrace();

     } catch (JsonMappingException e) {

      e.printStackTrace();

     } catch (IOException e) {

      e.printStackTrace();

     }

  }

} 
```

> 输出
> 
> mkyong 29
> 
> 味精 1
> 
> 味精 2
> 
> 味精 3

# c# - 在方法上使用修饰属性调用基类方法

> ID：12015082
> 
> 赞同：0
> 
> 时间：2012-08-18T01:29:08.557
> 
> 标签：c#, .net, custom-attributes

是否可以创建一个自定义属性 (MyAttribute)，以便在运行时获取 Derived.MyProperty 实际上调用 Base.GetProperty("MyProperty") 并且 Derived.MyProperty 的集合调用 Base.SetProperty("MyProperty", value ）。

```
class Derived : Base
{
  [MyAttribute]
  string MyProperty { get; set;}
}

class Base
{
  XmlDoc _xmldoc;
  void SetProperty(string key, string value)
  {
    set key, value into _xmldoc;
  }
  string GetProperty(string key);
  {
    get key value from _xmldoc;
  }
} 
```

这是从以下评论中得出的解决方案。感谢所有评论者。

```
public class WatchAttribute : HandlerAttribute
{
  public override ICallHandler CreateHandler(IUnityContainer container)
  {
    return new WatchHandler();
  }
}

public class WatchHandler : ICallHandler
{
  public int Order { get; set; }
  public IMethodReturn Invoke(IMethodInvocation input, GetNextHandlerDelegate getNext)
  {
    Console.WriteLine(string.Format("Method '{0}' on object '{1}' was invoked.", 
    return getNext()(input, getNext);
  }
}

public class SomeAction : MarshalByRefObject
{
  [Watch]
  public string MyProperty1 { get; set; }

  public string MyProperty { get; set; }
}

class Program
{
  static void Main(string[] args)
  {
    SomeAction c = new SomeAction();
    IUnityContainer container = new UnityContainer()
      .AddNewExtension<Interception>();
    container.Configure<Interception>()
      .SetInterceptorFor<SomeAction>(new TransparentProxyInterceptor())
      .AddPolicy("WatchAttribute Policy")
      .AddMatchingRule(new PropertyMatchingRule("*", PropertyMatchingOption.GetOrSet));
    container.RegisterInstance<SomeAction>(c);
    c = container.Resolve<SomeAction>();

    c.MyProperty1 = "Hello";
    c.MyProperty = "Hello";
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T02:06:54.653

使用统一拦截会更好，因为它允许您拥有一个代理来包装您想要的方法并指定规则来过滤方法这里解释： [http ://www.lm-tech.it/Blog/post/2011/10 /18/How-to-use-the-Unity-Interception-Extension.aspx](http://www.lm-tech.it/Blog/post/2011/10/18/How-to-use-the-Unity-Interception-Extension.aspx) 它允许您在不设置任何属性的情况下进行流程，并且您的开发人员只需遵循规则名称（例如，所有与您的 xmldoc 一起使用的属性）以 Xml_ 为前缀...

# mysql - MySQL 使用派生查询进行连接时的慢速左连接查询

> ID：12015091
> 
> 赞同：1
> 
> 时间：2012-08-18T01:30:16.950
> 
> 标签：mysql, sql

以下查询对两个表进行操作：`dev_Profile`和`dev_User`。

```
SELECT
  dev_Profile.ID AS pid,
  Name AS username,
  st1.online
FROM
  dev_Profile
  LEFT JOIN (
    SELECT 
      dev_User.ID, 
      lastActivityTime /* DATETIME */
    FROM
      dev_User)
    AS st1 ON st1.ID = dev_Profile.UserID; 
```

每个表中大约有 11K 行，此查询需要近 6 秒才能完成。我还没有很多数据库方面的经验。我认为创建一个索引`dev_Profile.UserID`就可以了，因为`dev_Profile.ID`已经有一个索引（它是 PK）并且`dev_Profile.UserID`没有索引，但这根本没有帮助。

编辑：此查询的 EXPLAIN 输出：

```
+----+-------------+-------------+------+---------------+------+---------+------+-------+-------+
| id | select_type | table       | type | possible_keys | key  | key_len | ref  | rows  | Extra |
+----+-------------+-------------+------+---------------+------+---------+------+-------+-------+
|  1 | PRIMARY     | dev_Profile | ALL  | NULL          | NULL | NULL    | NULL | 11521 |       |
|  1 | PRIMARY     | <derived2>  | ALL  | NULL          | NULL | NULL    | NULL | 11191 |       |
|  2 | DERIVED     | dev_User    | ALL  | NULL          | NULL | NULL    | NULL | 11440 |       |
+----+-------------+-------------+------+---------------+------+---------+------+-------+-------+ 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-18T01:34:06.430

为什么是嵌套选择？这可能会使优化器感到困惑。尝试消除它：

```
SELECT
  dev_Profile.ID AS pid,
  Name AS username,
  st1.online
FROM
  dev_Profile
  LEFT JOIN dev_User st1 ON st1.ID = dev_Profile.UserID; 
```

# odbc - ODBC 连接问题

> ID：12015097
> 
> 赞同：0
> 
> 时间：2012-08-18T01:32:50.350
> 
> 标签：odbc

我有驻留在远程机器上的 MS Access 2007 数据库。我在本地机器上为远程机器创建了网络驱动器，并为数据库创建了 ODBC 连接。但是当我使用 ODBC 连接从数据库中提取数据时，它会抛出错误，指出指定的路径不正确。请在我错的地方帮助我。

提前感谢迪内什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-11T04:18:49.680

尝试在管理员模式下通过 cmd 创建映射驱动器。

# wordpress - 如何使wordpress标题换行到第二行

> ID：12015098
> 
> 赞同：0
> 
> 时间：2012-08-18T01:32:54.203
> 
> 标签：wordpress, title

我正在使用自定义主题，我需要找到一种方法将标题换行到第二行。主题有一个轮播，标题显示在下方。目前，如果标题太长，则后面有“...”。我怎样才能阻止它并让它换行到第二行？

这是来自主题的代码

```
<div class="home-carousel">
  <ul>
    <?php
    $carimgheight = 120;
    if ( get_option('storefront_carousel_img_height' )) {$carimgheight = get_option('storefront_carousel_img_height' ); }
    $carimgwidth = 200;
    if ( get_option('storefront_carousel_img_number' ) == 2 ) {$carimgwidth = 428;}
    if ( get_option('storefront_carousel_img_number' ) == 3 ) {$carimgwidth = 276;}
    if ( get_option('storefront_carousel_img_number' ) == 5 ) {$carimgwidth = 154;}
    if ( get_option('storefront_carousel_img_number' ) == 6 ) {$carimgwidth = 124;} 
    //BEGIN Slider LOOP
    $loopcarousel = new WP_Query( array( 'post_type' => 'carousel' ) );
    while ( $loopcarousel->have_posts() ) : $loopcarousel->the_post();
    $buttonlink = get_post_meta($post->ID, "link", true);
    if(has_post_thumbnail()) {
    $carthumb = get_post_thumbnail_id(); 
    $carimage = vt_resize( $carthumb, '', $carimgwidth, $carimgheight, true );
    }
    ?>
        <li>
            <a href="<?php echo $buttonlink; ?>" title="<?php the_title(); ?>"><img alt="<?php the_title(); ?>" title="<?php the_title(); ?>" src="<?php echo $carimage['url']; ?>" width="<?php echo $carimage['width']; ?>" height="<?php echo $carimage['height']; ?>" /><?php if ( get_option('storefront_carousel_image_only') == "false" ) { ?><p><span class="carousel-title"><?php echo the_title(); ?></span></p><?php } ?></a>
        </li>
    <?php endwhile; //END SLIDER LOOP ?>

  </ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T02:13:28.413

省略号 (...) 可以添加到客户端或服务器端。很有可能它是使用 CSS 添加的`text-overflow: ellipsis;`。查看页面的 HTML 源代码（输出，而不是模板），如果存在完整的标题文本，您可以假设省略号是在客户端添加的。如果您看到省略号，则需要在 WordPress 中找到添加它的自定义过滤器。

假设`.carousel-title`是应用样式的选择器，您可以注释掉或`text-overflow: ellipsis;`完全删除规则。可能还有其他供应商前缀属性也需要删除，例如。`-o-text-overflow: ellipsis`. 可能还有一个`-moz-binding:`属性用于为 Firefox 4 之前的版本添加省略号支持，您也可以将其删除。

# javascript - 为什么 CoffeeScript 将类定义包装在闭包中？

> ID：12015102
> 
> 赞同：8
> 
> 时间：2012-08-18T01:34:18.523
> 
> 标签：javascript, coffeescript, minify

在 CoffeeScript 中，[这个](http://coffeescript.org/#try:thing1%20%3D%203%0A%0Aclass%20Foo%0A%20%20%40CONST%20%3D%2078%0A%20%20thing1%20%3D%2098%0A%20%20thing2%20%3D%2099%0A%0A%20%20constructor%20(a%2C%20b%2C%20c)%20-%3E%0A%20%20%20%20%40a%20%3D%20a%0A%20%20%20%20%40b%20%3D%20b%0A%20%20%20%20variable%20%3D%20c%0A%0A%20%20%40static_method%3A%20(x)%20-%3E%0A%20%20%20%20x%20*%202%0A%0A%20%20%40method%3A%20(x)%20-%3E%0A%20%20%20%20x%2B1%0A%0A)：

```
class Foo
  method: (x) ->
    x+1 
```

编译为：

```
// Generated By CoffeeScript
Foo = (function() {
  function Foo() {}
  Foo.prototype.method = function(x) {
    return x+1;
  }
  return Foo;
})() 
```

这似乎有点过分。以下应在*功能上相同*：

```
// Generated by Dave
function Foo() {}
Foo.prototype.method = function(x) {
    return x+1;
} 
```

**额外的“闭包”包装器的动机是什么？**

这不仅仅是样式问题。它对整体代码大小有影响。

Coffee 版本缩小为 84 个字节：

```
Foo=function(){function e(){}return e.prototype.method=function(e){return e+1},e}(); 
```

我的版本缩小到只有 61 个字节：

```
function Foo(){}Foo.prototype.method=function(e){return e+1}; 
```

~~23 字节是愚蠢的无关紧要，但在一个有许多类的项目中，开销开始增加。~~

好的，我在下面写了一个反驳字节大小理论的答案......对于任何合理的类，Coffee 方法都会更小。

应该还有其他原因。帮我想想他们。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-18T02:15:46.173

用闭包包装类定义的另一个原因是为该代码提供一个新的词法范围，用于声明仅在类内部可见的变量和内容：

```
class AwesomeThing
  # You might have private "methods" here.
  doSomethingAwesome = (what) ->
    console.log "I'm doing #{what} like a pro!"
  # Or run any arbitrary code.
  for i in [1..10]
    @prototype["uselessMethod#{i}"] = -> 'nothing'

  beAwesome: ->
    doSomethingAwesome @uselessMethod5() # The 5'th useless method is the best. 
```

在该代码中，变量`doSomethingAwesome`和`i`是类定义的本地变量，因此使它们对外部用户“私有”。

如果 IMO 不需要局部变量，CoffeeScript 编译器可以删除额外的包装。但是从实现的角度来看，总是包装类定义可能更简单:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-18T01:48:18.763

我真的不知道 CS 是如何工作的，除了它只是转换成 JS，但在我看来，[模块模式很容易支持私有成员](https://stackoverflow.com/a/8334365/575527)，而原型模式没有（或者通常很难做到） . 我相信这是使用模块模式的主要原因。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-18T01:34:18.523

好的，我想我只是回答了我自己的问题。

***对于大多数合理的类，CoffeeScript 生成的闭包会生成更小的缩小输出。***

闭包包装器减少了 25 个字节的开销，但它***使您免于重复 classname***，节省`k * N`字节（k=letters-in-name，N=num-of-refs）。例如，如果一个类似的类`BoilerPlateThingyFactory`有 2 个以上的方法，则闭包包装器会生成更小的压缩代码。

* * *

*更详细...*

Coffee 使用闭包生成的代码缩小为：

```
// Uglify '1.js' = 138 bytes (197 w/ whitespace):

var Animal=function(){function e(e){this.name=e}return e.prototype.speak=function(e){return"My name is "+this.name+" and I like "+e},e}();

// with whitespace ("uglifyjs -b"):

var Animal = function() {
    function e(e) {
        this.name = e;
    }
    return e.prototype.speak = function(e) {
        return "My name is " + this.name + " and I like " + e;
    }, e;
}(); 
```

替代实现缩小到这一点：

```
// Uglify '2.js' = 119 bytes (150 w/ whitespace):

var Animal=function(t){this.name=t};Animal.prototype.speak=function(e){return"My name is "+this.name+" and I like "+e};

// with whitespace ("uglifyjs -b"):

var Animal = function(t) {
    this.name = t;
};

Animal.prototype.speak = function(e) {
    return "My name is " + this.name + " and I like " + e;
}; 
```

请注意名称“Animal”名称如何在 Coffee 形式中精确存在一次，而在替代实现中 N=2 次。现在“Animal”只有 6 个字母，而且只有 1 个方法，所以这里的 Coffee 应该会丢失 25-6 = 19 个字节。咨询我的缩小代码，它是 138 字节到 119 字节，增量为 ... 19 字节。再增加4个方法，优势会切换到Coffee。这不仅仅是方法；类常量和其他 ref 类型也很重要。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-18T18:20:25.733

[Jeremy 在一个相关问题中回答了这个问题](https://stackoverflow.com/a/4672117/422263)——看起来主要目的是避免触发 IE 错误。

# javascript - Chrome jquery .animate() 留下“运动”行

> ID：12015106
> 
> 赞同：9
> 
> 时间：2012-08-18T01:35:06.993
> 
> 标签：javascript, jquery, html, google-chrome

我有一个 div，所以当我单击时，它会切换为展开或缩回。它在所有浏览器上都运行良好，尽管有一点让我很感兴趣。在谷歌浏览器上，当它缩回时，它会在运动中留下小线条。 [www.rezoluz.com/login.php - 页面](http://rezoluz.com/login.php)

要查看它，请使用 Google Chrome 打开该页面。并点击注册按钮两次，第二次它会留下线条，正常，但在其他浏览器上不会。我正在使用带有 jquery 的标准 .animate。非常感谢所有帮助。

截屏：

![请参阅下面的行](../Images/f7d29b82e7d1c494150bc21ab01b9b9d.png)

此外，这是一个显示结果的 jsfiddle：http: [//jsfiddle.net/rwQPu/2/](http://jsfiddle.net/rwQPu/2/)。Chrome 21.0.1180.81 beta-m Win7 中的错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-19T15:14:56.347

这是铬的一个错误。在此处查看先前提出的问题：

[**使用 jQuery 为宽度设置动画时出现奇怪的“抖动”效果（仅在 Chrome 中！）**](https://stackoverflow.com/questions/11761476/odd-shaking-effect-when-animating-width-with-jquery-only-in-chrome)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T04:32:09.417

这不是编码问题，实际上是某些版本的 Google Chrome 中的错误，听起来不太可能。据我所知，没有解决办法，我们只需要等待谷歌解决他们的问题，知道谷歌从他们发现它的那一刻起就会完成。

# newline - 将返回/输入捕获为按键以退出程序

> ID：12015109
> 
> 赞同：0
> 
> 时间：2012-08-18T01:35:28.597
> 
> 标签：newline, scanf, getchar, getc

该程序读入一个文件，然后要求用户输入要显示的行数。显示行数后，将再次提示用户打印更多行或按回车键退出。

我很难通过捕获换行符和/或回车来退出。如果按下返回按钮，我的程序不会退出，但如果我输入 ascii 值（10 是换行的十进制），我的程序不会退出

我希望程序在按下 enter 时退出。

```
#include <stdio.h>
#include <stdlib.h>

int main (int argc, char *argv[])
{
    FILE *file = fopen(argv[1], "r");
    int newLineCounter, currentChar, numOfLines;

    printf("enter a number of lines of lines to be displayed\n");
    scanf("%d", &numOfLines);

    while ((currentChar = fgetc(file)) != EOF)
    {
        printf("%c", currentChar);    //print character

        if (currentChar == '\n')      //check for newLine character
            newLineCounter++;  

        if (numOfLines == newLineCounter)
        {
            printf("\nenter a number of lines to be displayed or just return to quit\n"); 
            scanf("%d", &numOfLines);

            newLineCounter = 0; 

            //supposed to exit if return is pressed
            if (numOfLines == '\n')  //????why does this only execute when the decimal value of newline is entered
                return 0;
        }
    }

    //printf("%d lines in the text file\n", newLineCounter);

    fclose(file);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-18T01:38:46.727

您可以使用以下命令，而不是使用 scanf：

*   cin.getline (C++ istream) - [http://www.cplusplus.com/reference/string/getline/](http://www.cplusplus.com/reference/string/getline/)
*   来自 stdio.h 的 getline - [http://crasseux.com/books/ctutorial/getline.html](http://crasseux.com/books/ctutorial/getline.html)

这样你就可以检测到空行。

要从非空行解析整数，您可以使用：

*   sscanf - [http://www.cplusplus.com/reference/clibrary/cstdio/sscanf/](http://www.cplusplus.com/reference/clibrary/cstdio/sscanf/)

所以你的程序应该是这样的：

```
#include <stdio.h>
#include <stdlib.h>

int main (int argc, char *argv[])
{
    FILE *file = fopen(argv[1], "r");
    int newLineCounter, currentChar, numOfLines;

    while (true) {
        printf("enter a number of lines of lines to be displayed\n");
        int bytes_read;
        int nbytes = 100;
        char *my_string;

        my_string = (char *) malloc (nbytes + 1);
        bytes_read = getline (&my_string, &nbytes, stdin);
        if (bytes_read == 1) break; // exits if nothing entered on line
        // I believe it reads the newline character at minimum (but check this)
        sscanf(my_string, "%d", &numOfLines);

        // now do stuff with the numOfLines variable
    }

    fclose(file);

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-18T02:04:14.633

您似乎对 scanf 的格式字符串有错误的理解。%d 明确表示“我正在寻找一个整数”。这就是为什么您只能获得换行符的 ASCII 数字表示。

如果你想捕获一个新行作为一个字符，你的 scanf 需要是 %c。然后，您可以编写一个简单的函数，将整数的字符表示形式转换为实际的整数。但是 %c 也只会读取单个字符，因此您真正想要使用的是 %s 来读取一系列字符（也称为字符串），如果您知道这些字符将被放置在字符指针变量或字符数组中您愿意接受的最大位数。字符数组和字符串之间几乎没有区别。具体来说，String 是一个以空字符结尾的字符数组（字符串的最后一个元素是空字符 \0）。

长答案简短，使用字符指针并将您的 scanf 格式字符串更改为 %s。然后检查第一个字符是否为\n。如果不是，则将字符串转换为整数并使用该值来读取您的行。

以下是您的代码稍作修改以反映此解决方案。

```
#include <stdio.h>
#include <stdlib.h>

int main (int argc, char *argv[])
{
    FILE *file = fopen(argv[1], "r");
    int newLineCounter, currentChar, numOfLines;

    printf("enter a number of lines of lines to be displayed\n");
    scanf("%d", &numOfLines);

    while ((currentChar = fgetc(file)) != EOF)
    {
        printf("%c", currentChar);    //print character

        if (currentChar == '\n')      //check for newLine character
            newLineCounter++;  

        if (numOfLines == newLineCounter)
        {
            char* input;
            printf("\nenter a number of lines to be displayed or just return to quit\n"); 
            scanf("%s", &input);

            if( input[0] == '\n' || input[0] == '\0' ){
                return 0;
            } else {
                numOfLines = atoi( input );
            }
            newLineCounter = 0; 

            //supposed to exit if return is pressed
//            if (numOfLines == '\n')  //????why does this only execute when the decimal value of newline is entered
//                return 0;
//        }
    }

    //printf("%d lines in the text file\n", newLineCounter);

    fclose(file);

    return 0;
} 
```

# sql - 在 ORACLE 中插入触发器

> ID：12015111
> 
> 赞同：1
> 
> 时间：2012-08-18T01:35:48.910
> 
> 标签：sql, oracle, triggers, plsql, oracle10g

我是 Oracle 触发器的新手。我使用以下语法创建了一个 EVENT 表：

```
CREATE TABLE Event
(event_id NUMBER (3) NOT NULL,
 event_date DATE NOT NULL,
 venue_id NUMBER (2) NOT NULL,
 concert_id NUMBER (3) NOT NULL
); 
```

我想创建一个触发器以确保音乐会不能在 8 月份运行。我尝试了以下代码来创建触发器。触发器已成功创建，但在插入带有 8 月份的日期后，它已被插入。这不应该是。

```
CREATE OR REPLACE TRIGGER check_date
  BEFORE INSERT ON event
DECLARE 
  event_date date;
BEGIN
  IF (to_char(event_date, 'mm') = 8) THEN
    raise_application_error(-20000, 'Concerts cannot be run during August');
  END IF;
END; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-18T01:59:43.473

首先，触发器需要是行级触发器而不是语句级触发器。您希望为插入的每一行触发触发器，而不仅仅是为每条语句插入一次。将触发器声明为行级触发器允许您查看正在插入的每一行的数据。

其次，您不想声明局部变量`event_date`。您想查看正在插入的行是`:new.event_date`哪个。`event_date`

如果我把这两个放在一起

```
CREATE OR REPLACE TRIGGER check_date
  BEFORE INSERT ON event
  FOR EACH ROW
BEGIN
  IF (to_char(:new.event_date, 'mm') = 8) THEN
    raise_application_error(-20000, 'Concerts cannot be run during August');
  END IF;
END; 
```

然后你会得到你想要的行为

```
SQL> insert into event values( 1, date '2012-08-01', 1, 1 );
insert into event values( 1, date '2012-08-01', 1, 1 )
            *
ERROR at line 1:
ORA-20000: Concerts cannot be run during August
ORA-06512: at "SCOTT.CHECK_DATE", line 3
ORA-04088: error during execution of trigger 'SCOTT.CHECK_DATE' 
```

作为清洁的一般问题，您还希望将字符串与字符串和数字与数字进行比较。所以你会想要

```
to_number( to_char(:new.event_date, 'mm') ) = 8 
```

或者

```
to_char(:new.event_date, 'fmmm') = '8' 
```

或者

```
to_char(:new.event_date, 'mm') = '08' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T01:41:47.663

改变：

```
IF (to_char(event_date, 'mm') = 8) THEN 
```

至：

```
IF (to_char(event_date, 'mm') = '08') THEN 
```

您正在比较字符串和数字。

# protocols - 校验和/CRC 计算

> ID：12015112
> 
> 赞同：0
> 
> 时间：2012-08-18T01:35:53.783
> 
> 标签：protocols, decode, checksum, crc

我正在解码无线室外气象站发送的消息。我已经弄清楚了大多数协议的含义，除了无法确定如何计算校验和。这是我到目前为止发现的：

```
 0100 0111 0110 0000 0111 0100 0011 0010 1110 0110
|----|---------|--------------|---------|---------|
 start   id         temp        humidity  checksum? 
```

所以在上面的例子中，温度是 11.6 度，湿度是 50%。当我更换室外发射器中的电池时，“id”字段变为“随机”值。最后 8 位仅在 id/temp/湿度发生变化时发生变化，所以我相当确定这些是校验和/crc 位。

这里有一堆不同的传输：

```
0100 1110 0101 0000 1001 0010 0011 0011 1010 0001
0100 1110 0101 0000 1001 0010 0011 0100 0011 0110
0100 0111 0110 0000 1001 0010 0011 0100 0110 1100
0100 0111 0110 0000 1001 0010 0011 0101 0101 1101
0100 0111 0110 0000 1001 0100 0011 0101 0000 0111
0100 0111 0110 0000 1001 0101 0011 0110 1010 0000
0100 0111 0110 0000 1001 1000 0011 0111 1101 0001
0100 0111 0110 0000 1010 1000 0011 0111 0110 0011
0100 0111 0110 0000 1010 1001 0011 0111 1001 0111
0100 0111 0110 0000 1010 1010 0011 0111 1011 1010
0100 0111 0110 0000 0111 0100 0011 0010 1110 0110
0100 0111 0110 0000 0111 0101 0011 0010 0001 0010
0100 0111 0110 0000 0111 0110 0011 0010 0011 1111 
```

我不熟悉校验和/CRC技术，任何人都可以看到这里可能会使用什么或指出我如何确定这一点的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T01:41:12.180

说真的，您最好的选择可能是去气象站查看制造商和型号，然后将其插入 Google 或向制造商发送电子邮件询问校验和是如何计算的。

如果他们不愿发布信息，请告诉他们您正在评估解决方案，您可能会根据为其编写软件的难易程度决定购买 10 到 100 台设备（信息请求未在誓言和社会工程学通常仍然是获取您通常不会看到的信息的最简单方法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T03:28:33.160

破解OK。这是从前 4 个字节中生成第 5 个字节的 C# 代码。

```
/// <summary>A variant of CRC-8</summary>
/// <param name="data">Pass here the first 4 bytes of data, e.g. { 0x4E 0x50 0x92 0x33 }</param>
/// <returns>The computed SRC value, e.g. 0xA1 for the data specified above.</returns>
static byte src8( byte[] data )
{
    byte res = 0;
    foreach( byte b in data )
    {
        byte val = b;
        for( int i = 0; i < 8; i++ )
        {
            byte tmp = (byte)( ( res ^ val ) & 0x80 );
            res <<= 1;
            if( 0 != tmp )
                res ^= 0x31;
            val <<= 1;
        }
    }
    return res;
} 
```

# php - 如果没有空格和广告标点符号，则修剪的功能

> ID：12015115
> 
> 赞同：1
> 
> 时间：2012-08-18T01:37:43.297
> 
> 标签：php

我正在尝试制作一个函数，该函数可以删除字符串中的空格，如果没有，则广告标点符号。

这是我的测试字符串：

```
$test = 'Hey there I am traa la la           '; 
```

我希望它变成这样：

```
$test = 'Hey there I am traa la la.'; 
```

这是我尝试过的功能：

```
function test($mytrim){
        for($i = 0; $i <= 5; $i++){
            if(substr($mytrim, 0, -1) == ''){
                $mytrim = substr($mytrim, 0, -1);
            }
        }
        $punct = array(".",",","?","!");
        if(!in_array($mytrim, $punct)){ $mytrim .= '.'; } 
        return $mytrim;
    } 
```

它返回这个：

```
$mytrim = 'Hey there I am traa la la. .'; 
```

任何想法为什么它不起作用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-18T01:41:44.720

PHP 有一个内置[`trim`](http://php.net/manual/en/function.trim.php)函数。至于标点符号，您的代码应该可以正常工作（附加）。

代码示例：

```
<?php

    $testString = "   hello world      ";
    $trimmedString = trim($testString); // will contain "hello world"
    $lastChar = substr($trimmedString, strlen($trimmedString)-1); // will be "d"
    $punct = array(".",",","?","!");
    if(!in_array($lastChar, $punct))
        echo $trimmedString.'.'; //will output "hello world." 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T01:45:44.813

```
function adspunctuation($str)
{
   $str = trim($str) . (substr($str, -1)!='.' ? '.' : '');
   return $str;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-18T01:41:23.427

```
function test ($string)
{
    $string = trim($string);
    if ((substr($string, -1)) != ".")
    {
         $string .= ".";
    }
} 
```

# mysql - 数据库设计 - 用于建模层次结构的表设计

> ID：12015118
> 
> 赞同：1
> 
> 时间：2012-08-18T01:38:22.983
> 
> 标签：mysql, sql, database, database-design, erd

我正在设计一个实验室信息系统 (LIS)，并且对如何为不同的实验室测试设计表格感到困惑。我应该如何处理具有多个值的属性的表，并且该属性的多个值中的每一个也可以具有多个值？

这是我的 LIS 设计中的一些数据...

```
 HEMATOLOGY  <-------- Lab group
    **************************************************************
     CBC        <-------- Sub group 1
       RBC      <-------- Component
       WBC
       Hemoglobin
       Hematocrit
       MCV
       MCH
       MCHC
       Platelet count
     Hemoglobin
     Hematocrit
     WBC differential
       Neutrophils
       Lymphocytes
       Monocytes
       Eosinophils
       Basophils
     Platelet count
     Reticulocyte count
     ESR
     Bleeding time
     Clotting time
     Pro-time
     Peripheral smear
     Malarial smear
     ABO
     RH typing

    CLINICAL MICROSCOPY       <-------- Lab Group
    **************************************************************
     Routine urinalysis       <-------- Sub group 1
       Visual Examination     <-------- Sub group 2
         Color                <-------- Component
         Turbidity
         Specific Gravity       
       Chemical Examination
         pH
         protein
         glucose
         ketones
         RBC
         Hbg
         bilirubin
         specific gravitiy
         nitrite for bacteria
         urobilinogen
         leukocyte esterase 
       Microscopic Examination
         Red Blood Cells (RBCs)
         White Blood Cells (WBCs)
         Epithelial Cells 
         Microorganisms (bacteria, trichomonads, yeast) 
         Trichomonads 
         Casts 
         Crystals
     Occult Blood
     Pregnancy Test 
```

...这种数据层次结构也在我设计的其他实验室分组中重复出现（例如血液化学、血清学等）...

另一个问题是，我将如何处理可以成为一个或多个实验室组成员的组件（例如，RBC）？

我已经通过制作单独的表格来解决我的问题，1 个用于实验室组，1 个用于子组 1，1 个用于子组 2，1 个用于组件。然后通过在该表中放置每个表的外键来创建另一个表以合并所有表...唯一的权衡是该表中的某些行可能具有空值。我对我的设计不满意，所以我希望有人能给我建议如何让它正确；任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T08:18:02.543

这里有几个选项：

如果只是在建模上面的层次结构，并且没有涉及其他数据，那么您可以在两个表中进行：

![两表模型](../Images/2d175c6085b640421b875f9f038f8522.png)

这样做的一个问题是您没有强制要求，例如，a`sub_group`必须是 a 的子级`lab_group`，或者 a`component`必须是 a`sub_group_1`或 a 的子级`sub_group_2`，但是您可以在应用程序层中强制执行这些要求。

这种方法的优点是模式很好而且简单。即使实体有更多与之关联的数据，仍然值得像这样对层次结构进行建模，并为实体本身提供一些单独的表。

如果您想在数据级别强制执行正确的关系，那么您将不得不将其拆分为单独的表。也许是这样的：

![多表](../Images/0f0c1ff1cfa9ead97da82ad961be3c0f.png)

这假设 each`sub_group_1`仅与单个`lab_group`. 如果不是这种情况，则在`lab_group`和之间添加一个链接表`sub_group_1`。对于`sub_group_1`->`sub_group_2`关系也是如此。

`component`和`sub_group_1`和之间有一个链接表`sub_group_2`。这允许单个`component`与多个实体相关`sub_group_1`联。`sub_group_2`它是一个表的事实意味着很多`sub_group_1_id`和`sub_group_2_id`记录将是`null`（就像您在问题中提到的那样）。您可以防止空值有两个单独的链接表：

*   `sub_group_1_component`有一个外键到`sub_group_1`和一个外键到`component`
*   `sub_group_2_component`有一个外键到`sub_group_2`和一个外键到`component`

我没有把它放在图表中的原因是，对我来说，必须查询两个表而不是一个来获取所有`component`->`sub_group`关系太痛苦了。为了进行一些非规范化（允许一些`nulls`），查询单个表要容易得多。如果您发现自己允许很多`null`s （例如此处所有实体之间关系的单个链接表），那么这可能是非规范化太多了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T02:19:56.037

就个人而言，我会使用值的关系创建 3 个表。它使您能够创建无限的值数组。试着确保你给出了很好的列名，否则你的头会旋转好几天。:)

此外，空值不是问题查看所有不同类型的连接

# sql-server - 将 postgres 转换为 SQL Server

> ID：12015120
> 
> 赞同：0
> 
> 时间：2012-08-18T01:38:36.863
> 
> 标签：sql-server, postgresql

我有一个从 Postgres 数据库生成的 SQL 文件，我想在 SQL Server 2008 上运行。该 SQL 文件创建、删除数据并将其插入到表中。SQL Server 在语法中返回许多错误。

有没有办法使文件兼容？

如果没有，将数据从 Postgres 导出到 SQL Server 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T01:49:07.043

最好的方法通常是将转储恢复到 PostgreSQL 服务器，然后使用以下命令将数据从实时服务器中复制出来：

*   `pg_dump --data-only --inserts`您手动转换的仅模式转储，如果幸运的话，随后可能会按原样加载转储，否则可以使用文本处理工具进行机器转换；或者

*   如果您能找到一个用于 Pg -> MS SQL 的专用转换工具。也许链接帖子中提到的[MS SQL ODBC 转储/导出工具](https://serverfault.com/questions/65407/best-tool-to-migrate-a-postgresql-database-to-ms-sql-2005)是 ETL 工具的特例。

*   通常更好的是，使用 Talend 或 Pentaho 等 ETL 工具来帮助进行转换。

# php - 使用我自己的标题加载功能制作自定义 WordPress 主题的冲突

> ID：12015122
> 
> 赞同：0
> 
> 时间：2012-08-18T01:38:51.497
> 
> 标签：php, function, wordpress-theming

我有一个问题，我已经研究了一段时间，我无法解决它。我阅读了制作 WordPress 主题的文档，它说您可以自定义主题的页眉和页脚文件，这正是我想要做的。

我有我想在目录中其他地方的 php 函数中使用的标题。你可以只拥有一个包含以下内容的 php 文件：

```
<?php define('IN_MAIN_SITE', true);

$bhw_root_path = '../../../../';

$phpEx = substr(strrchr(__FILE__, '.'), 1);

include($bhw_root_path . 'include/common.php');

page_header('', false, $page_title, $page_title, true); ?> 
```

这将显示将所有 css 样式应用于文档的标题。我的逻辑是，如果我可以将它加载到头文件中，那么这将适用于所有 WordPress 页面并解决我的问题。问题是当我打开模板时模板是空的。我的功能和 WordPress 功能之间是否存在冲突？我知道我很好地引用了我的函数，因为我试图将我的函数加载到同一目录中的另一个 php 文件中而没有任何问题。我应该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:07:56.427

我修好了它。它完全有错误的方法。我虽然必须修改头文件，但这仅适用于您想要调整 WordPress 的头文件。要使用您自己的标题生成函数，您必须在每个模板文件（index.php、single.php 等）中调用它。

# django - Django中的层次树导航

> ID：12015125
> 
> 赞同：3
> 
> 时间：2012-08-18T01:39:24.990
> 
> 标签：django, navigation

我正在寻找在我的 Django 应用程序中实现树形导航系统的最佳方法。我有一个页面层次结构，我需要一种方法来将链接设置为在层次结构的各个级别上处于活动状态。我遇到的唯一解决方案以类似 CMS 的方式使用数据库，但这不是我想要的。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-05T21:01:59.223

django-mptt 是一个相当不错的父/子关系实现，速度非常快。

[https://github.com/django-mptt/django-mptt](https://github.com/django-mptt/django-mptt)

# android - Android 在活动中调用异步任务

> ID：12015130
> 
> 赞同：10
> 
> 时间：2012-08-18T01:41:26.990
> 
> 标签：android, class, android-activity, android-asynctask

我有一个从网格视图中选择图像的活动，它允许您保存图像。我正在为我的所有代码使用异步任务。我将我的 AsyncTask 与几个类分开。我如何从我的活动中调用它们？如何将字符串传递回我的 AsyncTask。

SingleImageView.class

```
@Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
            case R.id.save_image:
                new SaveImageTask().execute(image_url,context); //<-- The method execute(String...) in the type AsyncTask<String,String,String> is not applicable for the arguments (String, Context)

                  return true;
            default:
                return false;
        } 
```

SaveImageTask.class

```
 public class SaveImageTask extends AsyncTask<String, String, String>
    {
        private Context context;
        private ProgressDialog pDialog;
        String image_url;
        URL myFileUrl = null;
        Bitmap bmImg = null;
        @Override
        protected void onPreExecute() {
            // TODO Auto-generated method stub

            super.onPreExecute();

            pDialog = new ProgressDialog(context);  //<<-- Couldnt Recognise
            pDialog.setMessage("Downloading Image ...");
            pDialog.setIndeterminate(false);
            pDialog.setCancelable(false);
            pDialog.show();

        }

        @Override
        protected String doInBackground(String... args) {
            // TODO Auto-generated method stub

            try {  
                myFileUrl = new URL(image_url);
                HttpURLConnection conn = (HttpURLConnection) myFileUrl.openConnection();   
                conn.setDoInput(true);   
                conn.connect();     
                InputStream is = conn.getInputStream();
                bmImg = BitmapFactory.decodeStream(is); 
            }
            catch (IOException e)
            {       
                e.printStackTrace();  
            }
            try {       

                String path = myFileUrl.getPath();
                String idStr = path.substring(path.lastIndexOf('/') + 1);
            File filepath = Environment.getExternalStorageDirectory();
            File dir = new File (filepath.getAbsolutePath() + "/Wallpaper/");
                dir.mkdirs();
                String fileName = idStr;
                File file = new File(dir, fileName);
                FileOutputStream fos = new FileOutputStream(file);
                bmImg.compress(CompressFormat.JPEG, 75, fos);   
                fos.flush();    
                fos.close();       
            }
            catch (Exception e)
                    {
                        e.printStackTrace();  
                    }
            return null;   
        }
        @Override
        protected void onPostExecute(String args) {
            // TODO Auto-generated method stub

            pDialog.dismiss();

        }
    } 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-18T01:43:52.330

您创建一个新实例，`SaveImageTask`然后调用它的`execute`方法，将字符串参数传递给它（`execute`接受一个可变参数）。

```
new SaveImageTask().execute("foo", "bar"); 
```

**编辑**

由于您`AsyncTask`使用 a `Context`，因此您需要通过构造函数将其传入。

```
public class SaveImageTask extends AsyncTask<String, String, String>
{
    private Context context;
    private ProgressDialog pDialog;
    String image_url;
    URL myFileUrl = null;
    Bitmap bmImg = null;

    public SaveImageTask(Context context) {
        this.context = context;
    }

    ...

} 
```

然后像这样打电话`AsyncTask`给你`Activity`：

```
new SaveImageTask(this).execute("foo", "bar"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-07T09:29:12.650

```
private PopupWindow popupWindow;
// this function will be on MainActivity class

 findViewById(R.id.main_page_layout).post(new Runnable() {
               public void run() {

                   new SendJsonValue ().execute();
                   }
                });

public class SendJsonValue extends AsyncTask<String, Void, String>{

        @Override

        protected void onPreExecute(){
            /*code for pop window initialization begins here*/      
                LayoutInflater layoutInflater =(LayoutInflater) getBaseContext().getSystemService(LAYOUT_INFLATER_SERVICE);
                  final View popupView = layoutInflater.inflate(R.layout.popup_window, null);
                  popupWindow = new PopupWindow(
                         popupView, 
                         LayoutParams.FILL_PARENT,  
                               LayoutParams.FILL_PARENT);  //creating popup
                  popupWindow.showAtLocation(popupView, Gravity.CENTER, 0, 0);
        }

        protected String doInBackground(String... params) {
            // TODO Auto-generated method stub
            //loadingMore = true;//parameter to take control on load more
            HttpClient httpclient = new DefaultHttpClient();
            final HttpParams httpParams = httpclient.getParams();
            HttpConnectionParams.setConnectionTimeout(httpParams, 30000);//set time out for receiving response
            HttpConnectionParams.setSoTimeout(httpParams, 30000);
            HttpPost httppost = new HttpPost("http://10.0.2.2/upload_test/InsertData.php");  

            try{

                BasicNameValuePair idValuePair = new BasicNameValuePair("dev_id", device_id);
                BasicNameValuePair emailValuePair = new BasicNameValuePair("dev_email", device_email);
                BasicNameValuePair jsonStringValuePair = new BasicNameValuePair("json", jObjectMain.toString());

                List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
                nameValuePairs.add(idValuePair);
                nameValuePairs.add(emailValuePair);
                nameValuePairs.add(jsonStringValuePair);

                httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

                HttpResponse response = httpclient.execute(httppost);  //response class to handle responses
                jsonResult = inputStreamToString(response.getEntity().getContent()).toString();

                JSONObject object = new JSONObject(jsonResult);

        }catch(ConnectTimeoutException e){

        }catch (ClientProtocolException e) {  
            // TODO Auto-generated catch block
            e.printStackTrace();
        }catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace(); 
        }catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }catch(Exception e){

        }

            return jsonResult;

    }
    protected void onPostExecute(String Result){

         System.out.println(Result);

        }
        private StringBuilder inputStreamToString(InputStream is) {
            String rLine = "";
            StringBuilder answer = new StringBuilder();
            BufferedReader rd = new BufferedReader(new InputStreamReader(is));

            try {
             while ((rLine = rd.readLine()) != null) {
              answer.append(rLine);
               }
            }

            catch (IOException e) {
                e.printStackTrace();
             }
            return answer;
           }  
    } 
```

# linux - Zeitgeist 命令行查询客户端

> ID：12015132
> 
> 赞同：6
> 
> 时间：2012-08-18T01:41:38.923
> 
> 标签：linux, zeitgeist

[Zeitgeist for Linux](http://zeitgeist-project.com)是一个智能操作系统活动日志，将各种信息存储在数据库中，如最近打开的文件、最近启动的程序等。

我很想知道是否存在用于查询数据库的命令行客户端？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-07T21:22:14.080

不知道有没有命令行客户端。但是您可以通过两种方式实现这一目标：

1.  数据库文件`~/.local/share/zeitgeist/activity.sqlite`。

2.  有一个 Python API。看看[这个教程](http://bloc.eurion.net/archives/2012/zeitgeist-python-api-tutorial/)。

# python - Python 包导入错误——Python 无法识别包

> ID：12015135
> 
> 赞同：4
> 
> 时间：2012-08-18T01:41:51.267
> 
> 标签：python, python-2.7

最近，在尝试导入我编写的模块时，我遇到了表面上不应该发生的错误。这是我的想法，我在我的`main.py`文件中写入，我的层次结构如下所示：

```
starsearch/
  main.py
  parser/
    __init__.py
    parse.py 
```

parser/ 中的`__ init __.py`文件是空的，但是当我在我的程序中尝试：

```
import parser 
```

它返回一个`AttributeError`. 当我在`parse.py`, 中调用函数时会发生这种情况`getstar()`。或者

```
from parser import parse 
```

它返回一个`ImportError`.

所以我的 Python 不承认它的`parse.py`存在？我做了一些研究，并且有一个`__ init __.py`空的文件应该可以解决问题，但我很难过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T10:45:03.047

parser 是 python 中内置模块的名称。当你写

```
import parser 
```

您导入内置模块。由于该模块不包含 getstar() 函数或解析模块，您会得到 AttributeError 或 ImportError

尝试将“解析器”目录的名称更改为其他任何名称，它应该可以工作。不需要空的**init .py 文件**

# php - rewriteurl - 重定向到新路径

> ID：12015136
> 
> 赞同：2
> 
> 时间：2012-08-18T01:42:04.410
> 
> 标签：php, .htaccess

当人们键入时，我想重定向到 new/index.php

```
site.com
site.com/index.php
site.com/index.html
site.com/index.htm 
```

所以下面的代码可能对吗？

```
Options +FollowSymLinks
RewriteEngine on
RewriteRule ^index\.(html|php|htm)$ new/index.php 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T03:49:00.987

改用这个：

```
RewriteEngine on
RewriteRule ^(index\.(html?|php))?$ /new/index.php [L,NC,QSA,R=301] 
```

如果您不希望人们看到那里的地址栏更改为 /new，请删除该`R=301`标志。

您可以在[此处获得有关 mod_rewrite的更多信息](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T03:30:39.070

几乎，你没有与 匹配`site.com`，所以在你所拥有的之上，添加：

```
RewriteRule ^$ new/index.php [L] 
```

# angularjs - cookie/oauth 问题

> ID：12015139
> 
> 赞同：2
> 
> 时间：2012-08-18T01:43:16.417
> 
> 标签：angularjs, trigger.io

我遇到了一些 cookie/oauth 问题。我想要实现的是打开一个新选项卡，让用户通过 google 的 oauth 流程，返回应用程序后，他们应该能够使用收到的 cookie 向我们的 api 发出请求，但是..我不知道如何保存该 cookie。如果我进入 chrome 的检查工具，我可以在资源选项卡中看到 cookie，但是使用 forge 或 angularjs（我正在使用的 js 框架）所做的任何事情都不包含 cookie，并且由于浏览器安全性我无法设置它手动。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T23:48:53.900

为什么必须将其保存为 cookie？你有 localStorage （或[forge.prefs](http://docs.trigger.io/en/v1.4/modules/prefs.html?highlight=prefs#prefs.set)，但不确定它们是如何工作的）。

您在移动应用程序中，因此无需担心 localStorage 的安全性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-28T19:09:11.610

我使用角度存储。它非常适合存储令牌。 [https://github.com/auth0/angular-storage](https://github.com/auth0/angular-storage)

登录后保存令牌：

```
 store.set('jwt', data.token);
      store.set('user', jwtHelper.decodeToken(store.get('jwt'))); 
```

然后检查您的令牌是否有效：

```
 .run(function($rootScope, $state, store, jwtHelper) {
    $rootScope.$on('$stateChangeStart', function(event, toState, toParams) {
      if (toState.data && toState.data.requiresLogin) {

        store.set('redirect', {state: toState.name, stateParams: toParams});

        //TODO This is never passing but still redirecting?
        if (!store.get('jwt') || jwtHelper.isTokenExpired(store.get('jwt'))) {
          event.preventDefault();
          $state.go('login');
        }
      }
    });
  }) 
```

# c - 使用 ptrace() 取消系统调用

> ID：12015141
> 
> 赞同：10
> 
> 时间：2012-08-18T01:43:27.353
> 
> 标签：c, linux, ptrace

出于某种安全目的，我使用 ptrace 来获取系统调用号，如果它是一个危险的调用（比如 10 表示取消链接），我想取消这个系统调用。

这是测试程序的源代码`del.c`。用 编译`gcc -o del del.c`。

```
#include <stdio.h>
#include <stdlib.h>
int main()
{
    remove("/root/abc.out");
    return 0;
} 
```

这是安全管理器源代码`test.c`。用 编译`gcc -o test test.c`。

```
#include <signal.h>
#include <syscall.h>
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <unistd.h>
#include <errno.h>
#include <sys/user.h>
#include <sys/reg.h>
#include <sys/syscall.h>

int main()
{
    int i;
    pid_t child;
    int status;
    long orig_eax;
    child = fork();
    if(child == 0) {
        ptrace(PTRACE_TRACEME, 0, NULL, NULL);
        execl("/root/del", "del",  NULL);
    }
    else {
        i = 0;
        while(1){
            wait(&status);
            if (WIFEXITED(status) || WIFSIGNALED(status) )break;

            orig_eax = ptrace(PTRACE_PEEKUSER,
                          child, 4 * ORIG_EAX,
                          NULL);
            if (orig_eax == 10){
                fprintf(stderr, "Got it\n");
                kill(child, SIGKILL);
            }
            printf("%d time,"
               "system call %ld\n", i++, orig_eax);
            ptrace(PTRACE_SYSCALL, child, NULL, NULL);
        }
    }
    return 0;
} 
```

创建`abc.out`文件，然后运行测试程序：

```
cd /root
touch abc.out
./test 
```

该文件`/root/abc.out`应该仍然存在。

我如何实现这个要求？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-18T05:55:35.933

好吧，有时`PTRACE_KILL`似乎效果不佳，您可以`kill`改用：

```
if (orig_eax == 10)
{
    kill(pid, SIGKILL);
} 
```

**编辑**：我用这个程序在我的机器（Ubuntu 内核 3.4）上测试，一切正常：

```
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <unistd.h>
#include <sys/reg.h>
#include <stdio.h>

int main(int argc, char **argv)
{   
    pid_t child;
    long orig_eax;
    int status;

    child = fork();
    if(child == 0) 
    {
        ptrace(PTRACE_TRACEME, 0, NULL, NULL);
        execl("/bin/ls", "ls", NULL);
    }
    else 
    {
        /* Both wait and waitpid works */
        //wait(NULL);
        waitpid(child, &status, 0);
        orig_eax = ptrace(PTRACE_PEEKUSER, child, 4 * ORIG_EAX, NULL);
        /* Tracking execve syscall */
        if (orig_eax == 11)
        {
            /* Both PTRACE_KILL and kill() works on my 3.4.4 Kernel */
            fprintf(stdout, "GOT IT\n");
            //ptrace(PTRACE_KILL, child, NULL, NULL);
            kill(child, SIGKILL);
        }
    }

    return 0;
} 
```

**更新**：问题是您`10`用于跟踪系统调用而不是`11`（因为您正在执行`execve`命令），此代码将与您的`rm`命令一起使用：

```
if (orig_eax == 11)
{
    /* Both PTRACE_KILL and kill() works on my 3.4.4 Kernel */
    fprintf(stdout, "INSIDE THE TRAP, FILE WILL NOT BE REMOVED\n");
    ptrace(PTRACE_KILL, child, NULL, NULL);
    //kill(child, SIGKILL);
} 
```

**编辑**：我尝试了这段代码，一切正常（`abc.out`执行后文件仍然存在`CALL_REMOVE`）

```
/*
 * REMOVE.c
 * gcc -Wall REMOVE.c -o REMOVE
 */

#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int main(int argc, char **argv)
{
        /* Both calls work */
        //remove("/root/abc.out");
        unlink("/root/abc.out");

        return 0;
}

/*
 * CALL_REMOVE.c
 * gcc -Wall CALL_REMOVE.c -o CALL_REMOVE
 */

#include <signal.h>
#include <syscall.h>
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <unistd.h>
#include <errno.h>
#include <sys/user.h>
#include <sys/reg.h>
#include <sys/syscall.h>
#include <stdio.h>
#include <string.h>

int main(int argc, char **argv)
{
        int i;
        pid_t child;
        int status;
        long orig_eax;
        int kill_ret = 0;

        child = fork();

        if(child == 0)
        {
                ptrace(PTRACE_TRACEME, 0, NULL, NULL);
                execl("/root/REMOVE", "REMOVE",  NULL);
        }
        else
        {
                i = 0;
                while(1)
                {
                        wait(&status);
                        if (WIFEXITED(status) || WIFSIGNALED(status) )
                                break;

                        orig_eax = ptrace(PTRACE_PEEKUSER, child, 4 * ORIG_EAX, NULL);
                        if (orig_eax == 10)
                        {
                                fprintf(stderr, "Got it\n");
                                kill_ret = kill(child, SIGKILL);
                                if (kill_ret == -1)
                                {
                                    fprintf(stderr, "Failed to kill ---> %s\n", strerror(errno));
                                }
                        }
                        printf("%d time, system call %ld\n", i++, orig_eax);
                        ptrace(PTRACE_SYSCALL, child, NULL, NULL);
                }
        }

        return 0;
} 
```

我们得到了这个输出：

```
root@UnixServer:/root# ll
total 28K
-rw-r--r-- 1 root root    6 2012-08-18 19:37 abc.out
-rw-r--r-- 1 root root 1023 2012-08-18 19:39 CALL_REMOVE.c
-rw-r--r-- 1 root root  213 2012-08-18 19:39 REMOVE.c
-rwxr-xr-x 1 root root 7,3K 2012-08-18 19:39 CALL_REMOVE
-rwxr-xr-x 1 root root 7,0K 2012-08-18 19:39 REMOVE
root@UnixServer:/root# ./CALL_REMOVE 
0 time, system call 11
1 time, system call 45
2 time, system call 45
3 time, system call 33
4 time, system call 33
5 time, system call 192
6 time, system call 192
7 time, system call 33
8 time, system call 33
9 time, system call 5
10 time, system call 5
11 time, system call 197
12 time, system call 197
13 time, system call 192
14 time, system call 192
15 time, system call 6
16 time, system call 6
17 time, system call 33
18 time, system call 33
19 time, system call 5
20 time, system call 5
21 time, system call 3
22 time, system call 3
23 time, system call 197
24 time, system call 197
25 time, system call 192
26 time, system call 192
27 time, system call 192
28 time, system call 192
29 time, system call 192
30 time, system call 192
31 time, system call 6
32 time, system call 6
33 time, system call 192
34 time, system call 192
35 time, system call 243
36 time, system call 243
37 time, system call 125
38 time, system call 125
39 time, system call 125
40 time, system call 125
41 time, system call 125
42 time, system call 125
43 time, system call 91
44 time, system call 91
Got it
45 time, system call 10
root@UnixServer:/root# ll
total 28K
-rw-r--r-- 1 root root    6 2012-08-18 19:37 abc.out
-rw-r--r-- 1 root root 1023 2012-08-18 19:39 CALL_REMOVE.c
-rw-r--r-- 1 root root  213 2012-08-18 19:39 REMOVE.c
-rwxr-xr-x 1 root root 7,3K 2012-08-18 19:39 CALL_REMOVE
-rwxr-xr-x 1 root root 7,0K 2012-08-18 19:39 REMOVE
root@UnixServer:/root# 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-19T17:50:00.997

有很多低级/聪明（且容易出错）的方法来解决这个问题，但是现代 Linux 内核（3.x，您的发行版可能需要一个向后移植的补丁）支持称为 seccomp 的东西，它允许您限制系统调用一个过程可以做出来。沙盒使用此功能，包括 Chromium。

[您可以在此处](https://stackoverflow.com/questions/10001727/how-to-prohibit-system-calls-gnu-linux/10002019#10002019)的 StackOverflow 上查看有关此问题的讨论，或者仅在 Google 上查看文档和示例实现。那里有相当多的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-08T17:04:51.480

释义[https://nullprogram.com/blog/2018/06/23/](https://nullprogram.com/blog/2018/06/23/)

系统调用一旦启动就无法取消。但是，您可以修改系统调用的参数，或其返回值。因此，您可以执行以下操作：

1) 等待被跟踪进程调用系统调用。

2）用无效的东西替换系统调用号。为此，请读取被跟踪进程的寄存器，修改它们，然后将它们写回进程。

3) 继续该过程；系统调用将被执行，并且内核将返回一个错误，因为该进程调用了一个未实现的系统调用。

4) 当 ptrace 跟踪系统调用的返回时，您可以选择将内核的错误代码替换为其他内容（例如，将内核的“未实现的系统调用”替换为“无权限错误”）。

# performance - 高效的 JPA @oneToMany 关系

> ID：12015143
> 
> 赞同：0
> 
> 时间：2012-08-18T01:44:17.967
> 
> 标签：performance, jpa, one-to-many

我有一个项目，数据库架构在我们的控制之下。我们在 MySQL 数据库上使用 JPA2（目前是 Eclipselink，但将转移到 Hibernate，以便我们可以使用 Audit envers 框架）。

我遇到的问题是，我们正在编写的应用程序依赖于通过 3 个 @OneToMany 关系关联的 3 个实体之间经常重复的查询。跨这 3 个实体（和 2 个联接表）的结果联接遇到死锁问题，我正在尝试解决这些问题（我认为跨 5 个表联接的效率低下是原因）。

任何人都可以建议 @OneToMany 关系的重组是否合适，以便没有连接表可以提高 JPA 设置中连接查询的性能？我相信在 JPA2 中，您可以将父对象上的 mappedBy 参数设置为指向子对象上的一个字段，该字段模仿表达一对多关系的标准方式，其中子对象有一个 FK 指向父对象。

但是，我发现从 JPA 的角度来看，对这种方法的引用并不是最好的。

有没有人有这种情况的经验可以分享？

# boost-asio - Boost::asio async_resolve 阻塞

> ID：12015146
> 
> 赞同：0
> 
> 时间：2012-08-18T01:45:06.410
> 
> 标签：boost-asio

因此，我按照 boost 的教程进行了位于此处的异步 http 请求：http: [//www.boost.org/doc/libs/1_50_0/doc/html/boost_asio/example/http/client/async_client.cpp](http://www.boost.org/doc/libs/1_50_0/doc/html/boost_asio/example/http/client/async_client.cpp)

我的代码是重命名和拆分为 ah/cpp 文件之外的直接副本。

当我尝试时，使用的每种方法都是异步的：

```
 resolver_.async_resolve(query,
        boost::bind(&client::handle_resolve, this,
          boost::asio::placeholders::error,
          boost::asio::placeholders::iterator)); 
```

在返回“找不到主机”之前它会阻塞大约 5 秒钟。

为什么异步方法阻塞？

# sql - SQL：我如何（或我可以）选择多个列并与另一列相关

> ID：12015147
> 
> 赞同：0
> 
> 时间：2012-08-18T01:45:26.727
> 
> 标签：sql

我仍然是 SQL 的初学者，我找不到完成以下任务的方法。

在表 AI 中有以下内容。

```
ID, Name
1, somethingGeeky
2, reallyGeeky
3, TotallyGeeky 
```

在表 BI 中，使用 uniqueID 来关联先决条件。

```
Id, prerequisiteID
3, 2
2, 1 
```

我正在尝试编写一个查询表 B 的语句，但将唯一 ID 替换为表 A 中的名称。

所以，它会显示像..

```
Name, Prerequisite
TotallyGeeky, reallyGeeky
reallyGeekly, somethingGeeky 
```

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T01:52:46.403

您需要将 table`A`两次加入 table `B`。第一列第一次，第二列第二次：

```
select a1.name, a2.name
   from b
      inner join a a1
         b.id = a1.id
      inner join a a2
         b.prerequisiteID = a2.id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T01:53:08.687

```
SELECT x.Name AS Name, y.Name AS Prerequisite FROM B
INNER JOIN A x ON B.ID = x.ID
INNER JOIN A y ON B.prerequisiteID = y.ID 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-18T01:54:14.737

您只需将关系表与属性表连接两次。下面的例子：

```
SELECT
  A1.Name
  ,A2.Name as PrerequisiteName
FROM
  RelationsTable R
  JOIN
  Attributes A1 ON
    (A1.Id = R.Id)
  JOIN
  Attributes A2 ON
    (A2.Id = R.PrerequisiteId) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-18T02:18:11.170

这应该有效：

```
SELECT  a.Product_ID, b.brand_name
FROM    `product` a 
            INNER JOIN  `brand` b
                ON a.brand_id = b.brand_ID 
```

# c# - 我如何判断线程的状态？

> ID：12015148
> 
> 赞同：0
> 
> 时间：2012-08-18T01:45:27.410
> 
> 标签：c#

我需要知道这个线程什么时候完成它正在做的事情。在后台也有一个活跃的计时器。

注意：“扫描仪”是一个递归函数

```
// button click

//timer
timer.Enabled = true;

//thread
System.Threading.ThreadStart start = delegate { scanner(@"c:\", "*.txt;*.html;"); };
System.Threading.Thread thread = new System.Threading.Thread(start);
thread.Start();

-------------

private static long Counter = 0;
private static string scanstatus = string.Empty;
private static void scanner(string folder, string patterns)
{
    // Get the patterns.
    string[] pattern_array = patterns.Split(';');
    foreach (string pattern in pattern_array)
    {
        try
        {
            foreach (string fileName in System.IO.Directory.GetFiles(folder, pattern))
            {
                //trim path
                scanstatus = (fileName.Length > 50) ? "../" + fileName.Substring(fileName.Length - 49, 49) : fileName;
                // delay
                //System.Threading.Thread.Sleep(5);
                Counter++;
            }
        }
        catch (System.Exception E)
        {
            Console.WriteLine(E.Message);
        }
    }

    try
    {
        foreach (string directory in System.IO.Directory.GetDirectories(folder))
            scanner(directory, patterns);
    }
    catch (System.Exception E)
    {
        Console.WriteLine(E.Message);
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T01:48:33.557

看看 MSDN 上关于线程同步的文章：

[线程同步 (C#)](http://msdn.microsoft.com/en-us/library/ms173179%28v=vs.80%29.aspx)

密切关注“同步事件和等待句柄”部分

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T02:23:08.093

您好，使用 backgroundworker 它允许您跟踪工作状态（进度事件）、已完成事件，您可以取消它

```
 using System;
    using System.Threading;
    using System.ComponentModel;

    class Program
    {
      static BackgroundWorker _bw;

      static void Main()
      {
        _bw = new BackgroundWorker
        {
          WorkerReportsProgress = true,
          WorkerSupportsCancellation = true
        };
        _bw.DoWork += bw_DoWork;
        _bw.ProgressChanged += bw_ProgressChanged;
        _bw.RunWorkerCompleted += bw_RunWorkerCompleted;

        _bw.RunWorkerAsync ("Hello to worker");

        Console.WriteLine ("Press Enter in the next 5 seconds to cancel");
        Console.ReadLine();
        if (_bw.IsBusy) _bw.CancelAsync();
        Console.ReadLine();
      }

      static void bw_DoWork (object sender, DoWorkEventArgs e)
      {
        for (int i = 0; i <= 100; i += 20)
        {
          if (_bw.CancellationPending) { e.Cancel = true; return; }
          _bw.ReportProgress (i);
          Thread.Sleep (1000);      // Just for the demo... don't go sleeping
        }                           // for real in pooled threads!

        e.Result = 123;    // This gets passed to RunWorkerCompleted
      }

//here set your scanner work
      static void bw_RunWorkerCompleted (object sender,
                                         RunWorkerCompletedEventArgs e)
      {
        if (e.Cancelled)
          Console.WriteLine ("You canceled!");
        else if (e.Error != null)
          Console.WriteLine ("Worker exception: " + e.Error.ToString());
        else
          Console.WriteLine ("Complete: " + e.Result);      // from DoWork
      }

      static void bw_ProgressChanged (object sender,
                                      ProgressChangedEventArgs e)
      {
        Console.WriteLine ("Reached " + e.ProgressPercentage + "%");
      }
    } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-18T02:00:59.377

如果您想知道线程何时结束，您可以简单地执行以下操作：

```
DateTime _startTime=DateTime.Now;
TimeSpan _elapsedTime;

.....

thread.Start();
while(thread.IsAlive)
{
 Thread.Sleep(100);
}

private static void scanner(string folder, string patterns)
{

// do your work here

_elapsedTime=DateTime.Now.Subtract(_startTime);

} 
```

但是您需要更具体地了解`with whatever is it doing`

# c++ - static_pointer_cast 导致指向不同位置的 shared_ptr

> ID：12015153
> 
> 赞同：2
> 
> 时间：2012-08-18T01:45:52.413
> 
> 标签：c++, shared-ptr

我创建了一个`World`类来存储派生列表`Object`。我最终得到了以下结果：

```
class World {
    typedef std::shared_ptr<Object> object_ptr;

public:
    template<class T> void registerObject(T& object) {
        auto sp = std::shared_ptr<T>(&object, [](T*){});
        object_ptr op = std::static_pointer_cast<Object>(sp);
        objects_.push_back(op);
    }

private:
    std::list<object_ptr> objects_;
}; 
```

我偶然发现了一些让我感到困惑的东西。这`static_pointer_cast`会产生一个指针，该指针指向`sp`每个其他`T`实现的类的原始指针 ( ) 之后的 4 个字节。（我希望这是有道理的）

例如：我将此行添加到`registerObject`

```
std::cout << "sp:\t\t" << sp.get() << "\nop:\t\t" << op.get() << std::endl; 
```

然后我创建了以下类：

```
class Object {
protected:
    int o; //the base classes can't be empty, the amount inside them doesn't effect anything as long as they're not empty.
};

class Bar {
protected:
    int b;
};

class Foo {
protected:
    int f;
};

class Derive1 : public Object {
};

class Derive2 : public Bar, public Object {
};

class Derive3 : public Foo, public Bar, public Object {
}; 
```

以此作为我的主要功能：

```
int main() {
    World w;
    Derive1 d1;
    Derive2 d2;
    Derive3 d3;

    std::cout << "d1:\t\t" << &d1 << std::endl;
    w.registerObject(d1);

    std::cout << "d2:\t\t" << &d2 << std::endl;
    w.registerObject(d2);

    std::cout << "d3:\t\t" << &d3 << std::endl;
    w.registerObject(d3);

    return 0;
} 
```

并得到这个输出：

```
Deriving 0 other classes:
d1: 0xbf91f41c
sp: 0xbf91f41c
op: 0xbf91f41c
Deriving 1 other class:
d2: 0xbf91f414
sp: 0xbf91f414
op: 0xbf91f418
Deriving 2 other classes:
d3: 0xbf91f408
sp: 0xbf91f408
op: 0xbf91f410 
```

我设法指向与其他基类为空的`op`地址相同的唯一方法。`sp`

那么为什么会这样呢？它仍然指向对象，只是地址不同。

对不起，如果这是一个愚蠢的问题。我已经尝试自己解决这个问题，并且我有一个“理论”，但我刚刚完成了我在 Uni 的第一年 CS，这让我有点不知所措。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T02:03:05.243

它不是特定于`static_pointer_cast`，因为正常`static_cast`会表现出相同的行为。这通常是实现处理多重继承的方式。对象指针将指向不同的位置，具体取决于它真正指向的类型。

# php - mysql_query 返回一行，但 mysql_fetch_array 不做任何事情

> ID：12015154
> 
> 赞同：1
> 
> 时间：2012-08-18T01:46:07.143
> 
> 标签：php, mysql, echo

这次我有一个奇怪的问题。我有一个屏蔽数据库设置，它接受一个 url 并给它一个字符串掩码，这样我就可以通过给他们一个指向我网站重定向引擎的链接来将用户重定向到另一个网站（直接下载）。

我的 mysql_fetch_array 命令无法运行的管理员方面（我在其中输入网址）遇到问题。我知道查询至少返回一行，因为当我运行以下代码时：

```
$query = "SELECT * FROM `urls` WHERE `in`='$lks[$i]' ORDER BY `id` DESC LIMIT 1";

$r = mysql_query($query);

if(mysql_num_rows($r) < 1)
echo "Less than 1";
else
echo "At least 1"; 
```

它返回“至少 1”，但是当它到达 mysql_fetch_array while 语句时，什么也没有发生。就好像它完全无视它一样。

代码：

```
$query = "SELECT * FROM `urls` WHERE `in`='$lks[$i]' ORDER BY `id` DESC LIMIT 1";

$r = mysql_query($query);

while($me = mysql_fetch_array($r))
{
    echo "Blah";
} 
```

这段代码没有回应任何内容。怎么了？

顺便说一句，我知道我已连接到数据库和所有内容，因为我在此之前运行了与此非常相似的其他命令，并且它们都可以毫无问题地执行。

此外，此命令位于**for 循环**中（我不知道为什么会出现问题，因为我之前已经这样做了很多次并且从未遇到任何问题）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T01:51:47.877

尝试回显 mysql_error(); 我在想可能是您将列名和表名放在引号中。

```
$query = "SELECT * FROM urls WHERE in='$lks[$i]' ORDER BY id DESC LIMIT 1";
$r = mysql_query($query);
if($r)
{
$rowCount = mysql_num_rows($r);
if($rowCount == 1)
{
echo "1 row";
}
}
else
{
echo mysql_error(); 
} 
```

如果这不起作用，则您的阵列一定有问题。：/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T01:57:54.877

这是错误的：

`$query = "SELECT * FROM `urls` WHERE `in`='$lks[$i]' ORDER BY `id` DESC LIMIT 1";`

应该：

`$query = "SELECT * FROM `urls` WHERE `in`='{$lks[$i]}' ORDER BY `id` DESC LIMIT 1";`

但如前所述，使用 PDO。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T02:02:25.610

> 您正在检查少于一行，请回显 mysql_num_rows($r) 并检查返回了多少行。
> 
> 或者使用 die(mysql_error()) 和 mysql_query 来检查错误。

# c++ - “检查自我分配”有什么问题，它是什么意思？

> ID：12015156
> 
> 赞同：38
> 
> 时间：2012-08-18T01:47:50.637
> 
> 标签：c++, exception-handling, assignment-operator, exception-safety

在 Herb Sutter 的著作*Exceptional C++ (1999)*中，他在第 10 项的解决方案中有一句话：

> “异常不安全”和“糟糕的设计”齐头并进。如果一段代码不是异常安全的，那通常没关系，可以简单地修复。但是，如果一段代码由于其底层设计而不能成为异常安全的，那几乎总是表明其设计不佳。
> 
> 示例 1：具有两种不同职责的函数很难使异常安全。
> 
> **示例 2：以必须检查自赋值**的方式编写的复制赋值运算符可能也不是强异常安全的

他所说的“检查自我分配”是什么意思？

[询问]

Dave 和 AndreyT 准确地向我们展示了“检查自我分配”的含义。那挺好的。但问题还没有结束。为什么“检查自我分配”会损害“异常安全”（根据 Hurb Sutter 的说法）？如果调用者尝试进行自分配，则该“检查”就像没有发生分配一样工作。真的很痛吗？

[备忘录 1] 在 Herb 书中后面的第 38 项*Object Identity*中，他解释了自我分配。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-08-18T02:00:36.873

### 在这种情况下，一个更重要的问题是：

* * *

*   ##### *“这是什么意思，当你以某种方式编写函数时，需要你检查自赋值？？？”*

* * *

回答我的反问：这意味着设计良好的赋值运算符不需要检查自赋值。将一个对象分配给它自己应该可以正常工作（即具有“什么都不做”的最终效果），而不需要对自分配进行显式检查。

例如，如果我想按照以下方式实现一个简单的数组类

```
class array {
    // code...

    int *data;
    size_t n;
}; 
```

...并提出了赋值运算符的以下实现...

```
 array &array::operator =(const array &rhs) 
{
    delete[] data;

    n = rhs.n;
    data = new int[n];

    std::copy_n(rhs.data, n, data);

    return *this;
} 
```

##### 该实现将被认为是“糟糕的”，因为它在自我分配的情况下显然会失败。

* * *

为了“解决”这个问题，开发人员有两个选择；

1.  他或她可以添加明确的自我分配检查

```
array &array::operator =(const array &rhs) {
    if (&rhs != this) {
        delete[] data;

        n = rhs.n;
        data = new int[n];

        std::copy_n(rhs.data, n, data);
    }
    return *this;
} 
```

2.  或者您可以遵循“无检查”方法：

```
array &array::operator =(const array &rhs) {
      size_t new_n = rhs.n;
      int *new_data = new int[new_n];

      std::copy_n(rhs.data, new_n, new_data);

      delete[] data;

      n = new_n;
      data = new_data;

      return *this;
} 
```

* * *

后一种方法在某种意义上更好，因为它可以在自我分配情况下正常工作，而无需进行*明确*的检查。*从“安全角度”来看*，这个实现远非完美，这里是为了说明处理自分配的“检查”和“无检查”方法之间的区别。后面的无检查实现可以通过众所周知的复制和交换习语来更优雅地编写。

这并不意味着您应该避免对自分配进行显式检查。*从性能*的角度来看，这样的检查确实是有意义的：执行一长串操作只是为了最终“什么都不做”是没有意义的。*但在设计良好的赋值运算符中，从正确性*的角度来看，这样的检查是不必要的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-05-04T16:33:37.730

来自 c++ 核心指南

```
Foo& Foo::operator=(const Foo& a)   // OK, but there is a cost
{
    if (this == &a) return *this;
    s = a.s;
    i = a.i;
    return *this;
} 
```

这显然是安全且明显有效的。但是，**如果我们每百万个作业做一个自我作业**呢？这大约是一百万次冗余测试（但由于答案基本上总是相同的，因此计算机的分支预测器基本上每次都会猜对）。考虑：

```
Foo& Foo::operator=(const Foo& a)   // simpler, and probably much better
{
    s = a.s;
    i = a.i;
    return *this;
} 
```

注意：上面的代码只适用于没有指针的类，因为有指针的类指向动态内存。请参考蚂蚁的回答。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-18T01:51:10.723

```
MyClass& MyClass::operator=(const MyClass& other)  // copy assignment operator
{
    if(this != &other) // <-- self assignment check
    {
        // copy some stuff
    }

    return *this;
} 
```

将对象分配给自身是一个错误，但它不应该在逻辑上导致您的类实例发生更改。如果您设法设计一个分配给自身的类会改变它，那么它的设计就很糟糕。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-18T03:04:33.247

检查自分配的一般原因是因为您在复制新数据之前破坏了自己的数据。这种赋值运算符结构也不是强异常安全的。

作为附录，已确定自分配根本不会提高性能，因为每次都必须运行比较，但自分配极为罕见，如果确实发生，这是您的程序中的逻辑错误（真的） . 这意味着在整个程序过程中，这只是对周期的浪费。

# android - PhoneFactory.getDefaultPhone 必须从 Looper 线程调用

> ID：12015157
> 
> 赞同：1
> 
> 时间：2012-08-18T01:48:07.283
> 
> 标签：android, voicemail

我调用了TwelveKeyDialer.java`PhoneFactory.getDefaultPhone()`中的函数，然后我得到了标题描述的这条日志消息，并且十二键拨号器应用程序崩溃了，这是怎么发生的？`callVoicemail()`我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T06:38:10.580

您正在从主线程以外的线程调用 PhoneFactory.getDefaultPhone()。你需要从一个调用 Looper.prepare() 的线程中调用它。

最简单的方法是从 UI 线程调用它。使用[RunonUithread](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-06T08:09:39.270

你`PhoneFactory.makeDefaultPhone(getApplicationContext())`之前打过电话`PhoneFactory.getDefaultPhone()`吗？

根据我的经验，您可以在 Activity 创建方法中调用它。

如果您需要对手机进行更改，您将需要添加`MODIFY_PHONE_STATE`权限并使用系统密钥签署应用程序。您需要使用 android:sharedUserId="android.uid.system" 清单标签。

什洛莫库特

# python - 为什么 print("string", object) 给出的结果与 print(object) 不同？

> ID：12015163
> 
> 赞同：5
> 
> 时间：2012-08-18T01:49:53.163
> 
> 标签：python

我已经定义了这个类：

```
class Point():
    def __init__(self,x,y):
        self.x = x
        self.y = y
    def __str__(self):
        return "Point x: {0}, Point y: {1}".format(self.x, self.y) 
```

`print("Point",p1)`这两种情况和有什么区别`print(p1)`：

```
p1 = Point(1,2)
print("Point",p1)
print(p1)

>>('Point', <__main__.Point instance at 0x00D96F80>)
>>Point x: 1, Point y: 2 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-18T01:52:03.993

前者正在打印一个包含`"Point"`and的元组`p1`；在这种情况下`__repr__()`，将用于生成用于输出的字符串，而不是`__str__()`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-18T01:51:58.947

如果您使用的是 python2.x，那么您认为您正在像调用函数一样调用 print，那么您实际上是在使用 print 关键字打印一个元组......

```
print(1,2,3)
print (1,2,3) 
```

在 python3 中，您必须像函数调用一样进行操作`print(1,2,3)`。

因此，在您的情况下，在 python2.x 中，您要打印的是一组值。Tuple 元组对象将被转换为字符串，并且元组中的每个值都将打印其表示形式。当您像这样打印它们时：`print "Point",p1`，然后每个项目都将转换为字符串并打印。

```
print str(p1)
# Point x: 1, Point y: 2

print repr(p1)
# <__main__.Point instance at 0x00D96F80> 
```

您实际上可能想要使用`__repr__`而不是`__str__`：

```
class Point():
    def __init__(self,x,y):
        self.x = x
        self.y = y
    def __repr__(self):
        return "Point x: {0}, Point y: {1}".format(self.x, self.y) 
```

# javascript - Javascript条件语法，压缩多个条件

> ID：12015168
> 
> 赞同：0
> 
> 时间：2012-08-18T01:50:13.580
> 
> 标签：javascript, syntax, conditional-statements

我有以下代码。我觉得我是多余的，但不知道如何将这些陈述浓缩成一个。

编写这样的多个条件语句的正确语法/最有效+可读方式是什么？

```
 if(coorx < 440 && n < 4) {
            continue;
        }

        if(coorx < 280 && n < 5) {
            continue;
        }           

        if(coorx < 180 && n < 6) {
            continue;
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T01:53:12.940

由于无论执行哪条`if`语句都会执行相同的代码，因此您可以`if`使用 Javascript OR 运算符 ( `||`) 将所有这些条件压缩为一个条件：

```
if ((coorx < 440 && n < 4)  || (coorx < 280 && n < 5) || (coorx < 280 && n < 5))
    continue; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T01:54:50.977

只需使用 OR 拆分条件。AND 具有更高的优先级，因此以下工作：

```
if(coorx < 440 && n < 4 || coorx < 280 && n < 5 || coorx < 180 && n < 6) 
    continue; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T01:57:19.380

就像@jeff 说的那样，但是智能地使用空格，这样行长就不会失控（并且为了最简单的可读性）：

```
if (

  ( coorx < 440 && n < 4 ) ||

  ( coorx < 280 && n < 5 ) ||

  ( coorx < 180 && n < 6 )

) {

  continue;

} 
```

# python - 如何自动获取本地时区的时区偏移量？

> ID：12015170
> 
> 赞同：13
> 
> 时间：2012-08-18T01:51:17.123
> 
> 标签：python, datetime, time, timezone

我正在尝试自动获取本地时区偏移量，但遇到了麻烦。我试过了：

```
print time.timezone/3600 
```

这会得到（当前错误的）偏移量，因为它不会自动调整夏令时和非 DST。

我也试过：

```
now_utc = pytz.utc.localize(datetime.datetime.now())
now_mst = now_utc.astimezone(pytz.timezone('US/Mountain')) 
```

这得到了正确的偏移值，但我想自动设置“美国/山地”部分，所以我不必手动输入任何东西来获得偏移。

有没有办法获得使用 DST 和非 DST 自动调整的正确偏移量？

我将在不同地区的多台服务器上运行这个脚本，如果可以的话，我想自动获取 tz 偏移量。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-18T02:05:22.950

您可以为此使用[dateutil](http://labix.org/python-dateutil/)模块。要立即获取本地时区：

```
>>> import dateutil.tz
>>> import datetime
>>> localtz = dateutil.tz.tzlocal()
>>> localtz.tzname(datetime.datetime.now(localtz))
'EDT' 
```

我目前在东部夏令时间。在夏令时切换回来后，您可以看到它在未来变回 EST：

```
>>> localtz.tzname(datetime.datetime.now(localtz) +
                   datetime.timedelta(weeks=20))
'EST' 
```

如果您想要与 UTC 的偏移量，可以使用 utcoffset 函数。它返回一个时间增量：

```
>>> localtz.utcoffset(datetime.datetime.now(localtz))
datetime.timedelta(-1, 72000) 
```

在这种情况下，由于我是 UTC-4，它返回 -1 天 + 20 小时。如果这是您需要的，您可以将其转换为小时：

```
>>> localoffset = localtz.utcoffset(datetime.datetime.now(localtz))
>>> localoffset.total_seconds() / 3600
-4.0 
```

# java - Java Regex 删除新行，但保留空格。

> ID：12015172
> 
> 赞同：7
> 
> 时间：2012-08-18T01:51:35.997
> 
> 标签：java, regex

对于字符串`" \n a b c \n 1 2 3 \n x y z "`，我需要它变成`"a b c 1 2 3 x y z"`.

使用这个正则表达式 str.replaceAll("(\s|\n)", ""); 我可以得到“abc123xyz”，但我怎样才能在两者之间获得空格。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-18T01:56:27.603

您不必使用正则表达式；你可以使用`trim()`and`replaceAll()`代替。

```
 String str = " \n a b c \n 1 2 3 \n x y z ";
 str = str.trim().replaceAll("\n ", ""); 
```

这将为您提供您正在寻找的字符串。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-05-30T14:11:59.133

这将删除所有空格和换行符

```
String oldName ="2547 789 453 ";
String newName = oldName.replaceAll("\\s", ""); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-18T02:06:20.437

这将起作用：

```
str = str.replaceAll("^ | $|\\n ", "") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-18T01:56:19.247

如果你真的想用正则表达式来做这个，这可能会为你解决问题

```
String str = " \n a b c \n 1 2 3 \n x y z ";

str = str.replaceAll("^\\s|\n\\s|\\s$", ""); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-24T16:57:12.260

这是一个非常简单明了的示例，说明我将如何做

```
String string = " \n a   b c \n 1  2   3 \n x y  z "; //Input
string = string                     // You can mutate this string
    .replaceAll("(\s|\n)", "")      // This is from your code
    .replaceAll(".(?=.)", "$0 ");   // This last step will add a space
                                    // between all letters in the 
                                    // string... 
```

您可以使用此示例来验证最后一个正则表达式是否有效：

```
class Foo {
    public static void main (String[] args) {
        String str = "FooBar";
        System.out.println(str.replaceAll(".(?=.)", "$0 "));
    }
} 
```

输出：“Foo B a r”

更多关于正则表达式环视的信息：[http ://www.regular-expressions.info/lookaround.html](http://www.regular-expressions.info/lookaround.html)

这种方法使它适用于任何字符串输入，并且它只是添加到您的原始工作的一个步骤，以便准确地回答您的问题。快乐编码:)

# python - Web 和本机移动应用程序使用的 RESTFUL Web 服务，使用 django 框架在 python 中进行身份验证

> ID：12015182
> 
> 赞同：7
> 
> 时间：2012-08-18T01:52:30.537
> 
> 标签：python, django, rest, tastypie, django-piston

我必须使用 django 框架在 python 中编写带有身份验证的 RESTFUL Web 服务，该框架将由基于 Web 的客户端和移动本机应用程序（Android 和 IOS）使用。

简单的例子是用户将使用电子邮件和密码登录，他获取 api 密钥并将其存储在移动设备上，然后使用此 api 密钥来消费更多的 api，而不是一次又一次地提供用户凭据。

我正在考虑使用 TASTYPIE 或 Django 活塞来编写 RESTFUL 服务，但如果您知道任何更好的解决方案，请另外提出建议。

但我主要关注的是身份验证部分。我应该使用 OAuth 来实现身份验证还是通过 ssl 使用 api-key 进行简单的基本身份验证就足够了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T02:12:13.117

您可以使用 python 标准库编写**RESTful** Web 服务，第三方库不是绝对必要的。

您应该阅读更多关于*定义***RESTful**服务的内容，并开始自己实现它。

对于它的价值，我在一些项目中使用[**cherrypy**](http://www.cherrypy.org/)作为轻量级框架。它简单易用。该网站甚至有一个关于如何在您的应用程序中实现**REST**的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-23T11:06:51.863

我使用了 OAUTH2，它比 OAUTH 更易于实现，但需要 SSL 才能真正使其安全。

由于我使用了[DJANGO REST Framework](http://www.django-rest-framework.org/)，您可以在[此处](http://www.django-rest-framework.org/api-guide/authentication/#oauth2authentication)找到设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T00:53:55.180

正如您所说并使用了 SSL，我已经通过 api 密钥交换完成了它。工作得很好。有一些注意事项可以使 https 请求在 Android 上正常工作。

```
private static HttpClient newHttpClient() {
    KeyStore trustStore = KeyStore.getInstance(KeyStore.getDefaultType());
    trustStore.load(null, null);

    SSLSocketFactory sf = new EasySSLSocketFactory(trustStore);
    sf.setHostnameVerifier(SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);

    HttpParams params = new BasicHttpParams();
    HttpProtocolParams.setVersion(params, HttpVersion.HTTP_1_1);
    HttpProtocolParams.setContentCharset(params, HTTP.UTF_8);

    SchemeRegistry registry = new SchemeRegistry();
    registry.register(new Scheme("http", PlainSocketFactory.getSocketFactory(), 80));
    registry.register(new Scheme("https", sf, 443));

    ClientConnectionManager ccm = new ThreadSafeClientConnManager(params, registry);
    return new DefaultHttpClient(ccm, params);
} 
```

# django - django-registration 模板不显示用户登录

> ID：12015187
> 
> 赞同：1
> 
> 时间：2012-08-18T01:53:39.457
> 
> 标签：django, registration, django-registration

我正在使用当前版本的 django 并使用[django-registration](https://bitbucket.org/ubernostrum/django-registration/)

[在这个博客](http://devdoodles.wordpress.com/2009/02/16/user-authentication-with-django-registration/)的帮助下，我在服务器上完成了所有工作，并完成了模板。

有时页面显示的是用户登录，其他时候相同的 base.html 说用户未登录。我想我必须将用户传递给模板但我不知道要查找什么，此站点上的文档设置好之后。我怎样才能让这个 Base.html 工作，它说我没有登录。然后我转到登录页面，然后在那个页面上说我已经登录。

它似乎是特定于网址的。它会说我已登录，移动到不同的页面，它让我可以登录。为什么我不能在网站范围内拥有它，我错过了什么

django-registration 是一个包所以我不知道我能做什么，改变视图功能？以下是我的 base.html

```
 {% load i18n %}
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <link rel="stylesheet" href="/style.css" />
    <title>{% block title %}User test{% endblock %}</title>

</head>

<body>
    <div id="header">
        {% block header %}
    {% if user.is_authenticated %}
    {% trans "Logged in" %}: {{ user.username }} 
    (<a href="{% url auth_logout %}">{% trans "Log out" %}</a> | 
    <a href="{% url auth_password_change %}">{% trans "Change password" %}</a>)
    {% else %}
    <a href="{% url auth_login %}">{% trans "Log in" %}</a>
    {% endif %}
    <hr />
        {% endblock %}
    </div>

    <div id="content">
        {% block content %}{% endblock %}
    </div>

    <div id="footer">
        {% block footer %}
        <hr />
        {% endblock %}
    </div>
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T07:12:35.487

您没有发布视图代码，但我怀疑您的问题与您没有在所有视图函数上传递 RequestContext 的事实有关。

模板中的用户变量由上下文处理器添加。

做就是了 ：

```
ctx = RequestContext(request) 
```

在您的视图函数中并通过以下方式将其传递给模板处理器：

```
context_instance=ctx 
```

# c# - 将对象转换为 DataColumn 的类型

> ID：12015188
> 
> 赞同：2
> 
> 时间：2012-08-18T01:53:55.353
> 
> 标签：c#, casting, datatable

我正在广泛使用字典来解耦一些（高度耦合的）代码。以下是我的问题的相关内容：

```
//Output table
System.Data.DataTable dtOutput = new System.Data.DataTable();
dtOutput.Columns.Add("Ticket", typeof(string));
dtOutput.Columns.Add("Transit", typeof(string));
dtOutput.Columns.Add("City", typeof(string));
dtOutput.Columns.Add("Province", typeof(string));
dtOutput.Columns.Add("Outage Start Time", typeof(DateTime));
dtOutput.Columns.Add("Outage End Time", typeof(DateTime));
dtOutput.Columns.Add("Priority", typeof(string));
dtOutput.Columns.Add("Business Impact", typeof(TimeSpan));
dtOutput.Columns.Add("Time To Repair (mins)", typeof(Double));
dtOutput.Columns.Add("Summary", typeof(string));

Dictionary<string, int> outputColumnsLegend = new Dictionary<string, int>();
foreach (DataColumn col in dtOutput.Columns)
{
    outputColumnsLegend.Add(col.ColumnName, dtOutput.Columns.IndexOf(col) + 1);
}

Dictionary<string, Variable> outputVariable = new Dictionary<string, Variable>()
{
    {"Ticket", new Variable()},
    {"Transit", new Variable()},
    {"City", new Variable()},
    {"Province", new Variable()},
    {"Outage Start Time", new Variable()},
    {"Outage End Time", new Variable()},
    {"Priority", new Variable()},
    {"Business Impact", new Variable()},
    {"Time To Repair (mins)", new Variable()},
    {"Summary", new Variable()}
}; 
```

其中变量很简单：

```
public class Variable
{
    public object Value { get; set; }
} 
```

现在，要创建我要使用的输出表：

```
DataRow dataRow = dtOutput.NewRow();
foreach (DataColumn col in dtOutput.Columns)
{
    dataRow[outputColumnsLegend[col.ColumnName]] = (col.DataType)outputVariable[col.ColumnName].Value;
} 
```

但是，**col.DataType**中对 col 的引用会导致此错误：

```
The type or namespace 'col' could not be found (are you missing a using directive or an assembly reference?) 
```

我不确定为什么我会抛出这个错误或如何修复它。另外，我不确定**col.DataType**是否应该是**col.GetType**（假设这可以工作）。

任何建议表示赞赏。

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T02:04:05.747

此代码没有最终结果。因为 DataTable 将数据存储为对象（这就是为什么在从中获取数据时必须进行转换），并且由于您的 Variable() 类包含一个对象，所以实际上再多的转换也不会做任何有用的工作。

基本上，您是在拆箱，然后立即在同一行上重新装箱数据，即使演员表已经生效。

如果您想在运行时保留类型以避免这种情况（这似乎是您可能正在尝试做的事情），那么您需要使您的变量类成为一个泛型类，如下所示：

```
public class Variable<T>
{
   public T Value {get; set;}
} 
```

然后，您将实例化特定类型的变量，例如：

```
Variable<int> someInt;
Variable<string> someString;
etc. 
```

然而，即使你这样做了，当你把它放到 DataTable 中时，你仍然会作为一个对象装箱，所以这是徒劳的练习。

# c++ - 带有字符串操作的奇怪 C++ 循环错误

> ID：12015189
> 
> 赞同：0
> 
> 时间：2012-08-18T01:53:58.920
> 
> 标签：c++, string, for-loop

我正在搜索`std::string`某些字母，所以我正在使用：

```
for (int i = 0; i < word.length; i++)
... 
```

但是我得到了错误：

> > 错误 2 错误 C3867: 'std::basic_string<_Elem,_Traits,_Alloc>::length': 函数调用缺少参数列表；使用 '&std::basic_string<_Elem,_Traits,_Alloc>::length' 创建指向成员的指针

所以我放了：

```
for (int i = 0; i < &word.length; i++)
... 
```

然后得到错误：

> > 错误 2 错误 C2276: '&' : 对绑定成员函数表达式的非法操作

我该如何解决这个问题并搜索字符串？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T01:57:59.963

你只是错过了`()`after `length`。

[`std::string::length()`](http://en.cppreference.com/w/cpp/string/basic_string/length)是一个没有参数的函数。

# ios - ios - 将图像添加到捆绑包的正确方法是什么？

> ID：12015192
> 
> 赞同：0
> 
> 时间：2012-08-18T01:54:31.840
> 
> 标签：ios, xcode, ios5

我正在尝试添加这些图像：

```
1) Images for the UITabBar
2) The application icon
3) The launch icon 
```

我只是想确保我做对了。我用谷歌搜索“将图像添加到 ios 包”，但我似乎得到了一些过时的结果。我在 xCode 4.3.3 上，我只是想知道将图像添加到包中的正确步骤是什么。有没有办法在文件系统上组织它们，或者我只是在其中添加它们的那种扁平结构？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T02:52:39.480

您将图像添加到项目中。然后选择右侧的 Xcode 窗格，然后单击左上角以获取文件视图，在左侧窗格中选择了新图像。向下滚动，您会看到类似“目标会员”的内容。确保为图像选中复选框。现在它将包含在您的捆绑包中。您现在可以使用 "[UIImage imageNamed:@"Foo.png"]" 等来处理它。

编辑： ![在此处输入图像描述](../Images/23947c5e213061a702aef3bce4f89e4a.png)

# c++ - 仅当对象碰巧拥有成员函数时，如何调用它？

> ID：12015195
> 
> 赞同：9
> 
> 时间：2012-08-18T01:55:43.477
> 
> 标签：c++, templates, sfinae

> **可能重复：**
> [是否可以编写 C++ 模板来检查函数是否存在？](https://stackoverflow.com/questions/257288/is-it-possible-to-write-a-c-template-to-check-for-a-functions-existence)

我有一个`f`接收`val`类型值`T`（模板化）的函数。`val` **只有当**类型具有这样的成员函数时，有没有办法调用成员函数？

例子：

```
struct Bar {
  void foo() const {}
};

template<class T>
void f(T const& val) {
  // Is there any way to call *only* if foo() is available on type T?                                                           
  // SFINAE technique?                                                                                                          
  val.foo();
}

int main() {
  Bar bar;
  f(bar);
  f(3.14);
} 
```

对我来说听起来像是 SFINAE 技术，可能使用 boost::enable_if，但我不知道如何让它在这里工作。请注意，我不能轻易更改`Bar`示例中的类型。我知道如果`Bar`包含一些特定的 typedef 等，这会很容易，这表明该功能是可用的。

不用说，我不知道将被调用的类型`T`集`f`。有些有`foo`成员函数，有些没有。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T09:10:31.200

您可以按照下面的测试程序（使用 GCC 4.7.0 或 clang 3.1 构建）进行说明。

如果该方法存在并且是公共的，`has_void_foo_no_args_const<T>::eval(T const & t)` 则将调用静态模板函数。如果没有这样的方法，它什么也做不了。（如果方法是私有的，当然会导致编译错误。）`t.foo()``void T::foo() const`

[这个解决方案是从我在这里](https://stackoverflow.com/a/10707822/1362568)贡献的方法内省模板改编和扩展的。您可以阅读该答案以了解 SNIFAE 逻辑的工作原理，并了解如何推广该技术以参数化您正在探测的函数签名的属性。

```
#include <iostream>

/*! The template `has_void_foo_no_args_const<T>` exports a
    boolean constant `value` that is true iff `T` provides
    `void foo() const`

    It also provides `static void eval(T const & t)`, which
    invokes void `T::foo() const` upon `t` if such a public member
    function exists and is a no-op if there is no such member.
*/ 
template< typename T>
struct has_void_foo_no_args_const
{
    /* SFINAE foo-has-correct-sig :) */
    template<typename A>
    static std::true_type test(void (A::*)() const) {
        return std::true_type();
    }

    /* SFINAE foo-exists :) */
    template <typename A> 
    static decltype(test(&A::foo)) 
    test(decltype(&A::foo),void *) {
        /* foo exists. What about sig? */
        typedef decltype(test(&A::foo)) return_type; 
        return return_type();
    }

    /* SFINAE game over :( */
    template<typename A>
    static std::false_type test(...) {
        return std::false_type(); 
    }

    /* This will be either `std::true_type` or `std::false_type` */
    typedef decltype(test<T>(0,0)) type;

    static const bool value = type::value; /* Which is it? */

    /*  `eval(T const &,std::true_type)` 
        delegates to `T::foo()` when `type` == `std::true_type`
    */
    static void eval(T const & t, std::true_type) {
        t.foo();
    }
    /* `eval(...)` is a no-op for otherwise unmatched arguments */ 
    static void eval(...){
        // This output for demo purposes. Delete
        std::cout << "T::foo() not called" << std::endl;        
    }

    /* `eval(T const & t)` delegates to :-
        - `eval(t,type()` when `type` == `std::true_type`
        - `eval(...)` otherwise
    */  
    static void eval(T const & t) {
        eval(t,type());
    }
};

// For testing
struct AA {
    void foo() const {
        std::cout << "AA::foo() called" << std::endl;
    }
};

// For testing
struct BB {
    void foo() {
        std::cout << "BB::foo() called" << std::endl;
    }
};

// For testing
struct CC {
    int foo() const {
        std::cout << "CC::foo() called" << std::endl;
        return 0;
    }
};

// This is the desired implementation of `void f(T const& val)` 
template<class T>
void f(T const& val) {
    has_void_foo_no_args_const<T>::eval(val);
}

int main() {
    AA aa;
    std::cout << (has_void_foo_no_args_const<AA>::value ? 
        "AA has void foo() const" : "AA does not have void foo() const")
        << std::endl; 
    f(aa);
    BB bb;  
    std::cout << (has_void_foo_no_args_const<BB>::value ? 
        "BB has void foo() const" : "BB does not have void foo() const")
        << std::endl;
    f(bb);
    CC cc;  
    std::cout << (has_void_foo_no_args_const<CC>::value ? 
        "CC has void foo() const" : "CC does not have void foo() const")
        << std::endl;
    f(cc);  
    std::cout << (has_void_foo_no_args_const<double>::value ? 
        "Double has void foo() const" : "Double does not have void foo() const")
        << std::endl;
    f(3.14);
    return 0;
} 
```

该程序输出：

```
AA has void foo() const
AA::foo() called
BB does not have void foo() const
T::foo() not called
CC does not have void foo() const
T::foo() not called
Double does not have void foo() const
T::foo() not called 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T02:26:57.750

如果你有一个`typedef bool has_f`, 或一个 static （在编译时可用的东西），我想你可以分支（使用 boost 元编程函数），或者提供 2 个模板，一个将实例化如果`has_f`被定义，另一个如果不是。如果没有关于`T`恕我直言的元数据，直接感觉是不可行的。

# winapi - ClipCursor 成功，但实际上什么也没做

> ID：12015200
> 
> 赞同：5
> 
> 时间：2012-08-18T01:56:40.687
> 
> 标签：winapi

我正在编写一个非常简单的程序来将鼠标剪辑到指定的窗口。它从系统托盘运行，没有可见窗口。因为同一个窗口会有多个实例，所以它`EnumWindows()`会遍历每个顶级窗口并将它们的 hwnd 与`GetForegroundWindow()`. 如果为真，它将运行标准`ClipCursor()`代码。 `ClipCursor()`返回`TRUE`，并且，我断言`RECT`set by与传递给`GetClipCursor()`完全相同。然而，光标可以在屏幕上的任意位置自由移动。`RECT``ClipCursor()`

我检查`RECT`了窗口中的值是否是窗口的确切值，我已经在发布模式下编译了程序并以管理员权限运行它，仍然没有。下面的代码正是在我们找到 之后运行`HWND`的`GetForegroundWindow()`：

```
// Get the window client area.
GetClientRect(hwnd, &rc);

// Convert the client area to screen coordinates.
POINT pt = { rc.left, rc.top };
POINT pt2 = { rc.right, rc.bottom };
ClientToScreen(hwnd, &pt);
ClientToScreen(hwnd, &pt2);
SetRect(&rc, pt.x, pt.y, pt2.x, pt2.y);

clipped = true;
ClipCursor(&rc);

RECT rect;
GetClipCursor(&rect);

assert(rect.bottom == rc.bottom);
assert(rect.left == rc.left);
assert(rect.right == rc.right);
assert(rect.top == rc.top); 
```

我已经删除了很多检查，因为它们变得很烦人（我使用的是`MessageBox()`'s），但是这段代码肯定会在它应该运行的时候运行。光标只是没有被剪裁，我无法理解为什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T15:28:31.477

由于光标是共享资源，因此您尝试剪辑它会被调用取消剪辑`ClipCursor`光标的任何其他人覆盖。并且很多操作会自动松开光标（例如任何焦点变化）。背景窗口更改光标剪辑被认为是不良形式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-19T14:26:37.943

好吧，我只花了几天时间就发现，尽管光标资源具有共享性质，但如果一个进程在我还不完全了解的某些情况下剪切光标（也许该进程必须是前台应用程序？或类似的东西......我不太确定。）然后操作系统会自动将光标释放回完全剪辑模式（或任何你称之为的）。

无论如何，解决方法是做一个低级鼠标钩子并从那里调用clipcursor。这是一些概念代码的快速证明（经过测试并且有效，尽管我删除了不相关的东西，例如创建窗口或设置系统托盘等）：

```
// Some variables we'll use
bool clipped = false;   // Do we need to clip the mouse?
RECT rc;                // The clip rect
HHOOK hMouseHook;       // Low level mouse hook

// Low level mouse hook callback function
__declspec(dllexport) LRESULT CALLBACK MouseEvent(int nCode, WPARAM wParam, LPARAM lParam)
{
    // This part should be rewritten to make it not be a CPU-hog
    // But works as a proof of concept
    if ( clipped )
        ClipCursor(&rc);

    return CallNextHookEx(hMouseHook, nCode, wParam, lParam);
}

int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
{
    // .... Blah blah blah ....

    // Low level mouse hook
    hMouseHook = SetWindowsHookEx(WH_MOUSE_LL, (HOOKPROC)MouseEvent, hInstance, 0);

    // Only included to show that you set the hook before this,
    // And unhook after this.
    while(GetMessage(&msg, NULL, 0, 0) > 0)
    {
        TranslateMessage(&msg);
        DispatchMessage(&msg);
    }

    // Unhook the mouse
    UnhookWindowsHookEx(hMouseHook);

    return msg.wParam;
} 
```

# jquery - 为什么不 $(window).height(); 返回一个值，但 $(document).height(); 做？

> ID：12015201
> 
> 赞同：4
> 
> 时间：2012-08-18T01:57:04.533
> 
> 标签：jquery

我正在尝试使用 jQuery 获取当前窗口高度。我打算用这个值设置一个变量，并在调整大小时更新这个值。出于某种原因， $(window).height(); 总是返回零，但 $(document).height(); 返回一个值。为什么会这样？

（为简洁起见，代码被截断）

```
$(document).ready(function () {

function drawGrid() {

    var context = document.getElementById("gridCanvas").getContext("2d");

    var height = $(window).height();
    var width = height/2/8;
    alert(height);

    $(window).resize(function () {
        // do some stuff
    });

        // do some cool drawing stuff

    }

    drawGrid();

}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-18T02:03:23.823

你能试一下吗

```
$(window).load(function () { 
```

代替

```
$(document).ready(function () { 
```

看看它是否有效。我认为如果你想获得窗口的大小，你必须等待窗口完成加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-14T09:55:24.510

在兼容模式下，$(window).height() 和 $(window).width() 在 IE 中返回 0。尝试改用 $(document).height() 或 $(document).width() 。

# model-view-controller - 使用外部数据源实现域模型和数据映射器模式

> ID：12015202
> 
> 赞同：1
> 
> 时间：2012-08-18T01:57:16.787
> 
> 标签：model-view-controller, design-patterns, frameworks, datamapper, domain-model

**更新：**

好的一些更新，最后我们决定了框架（Yii）并有了一些初始结构。我将粘贴一些相关代码来说明我们当前的状态：（这里只有读取操作）

**控制器**

```
class SponsorController extends RestController
{
    public function actionRestView($id)
    {
        $sponsorMapper = new SponsorMapper(
            new Db1Adapter(), // Gateway to the external SOAP Webservice
            new Db2Adapter()  // Gateway to the external REST Webservice
        );

        $data = $sponsorMapper->read($id);

        $this->renderJson(
            array(
                'success' => true,
                'message' => 'Record Retrieved Successfully',
                'data' => $data
            )
        );
    }
} 
```

**领域模型**

```
class Sponsor extends CModel
{
    public $id;
    public $db1Result;
    public $db2Result;

    public function attributeNames()
    {
        return array(
            'id',
            'db1Result',
            'db2Result',
        );
    }
} 
```

**数据映射器**

```
class SponsorMapper extends Mapper
{
    public function __construct(SoapAdapter $db1Adapter,
                                RestAdapter $db2Adapter)
    {
        $this->adapters['soap'] = $db1Adapter;
        $this->adapters['rest'] = $db2Adapter;
    }

    public function read($id)
    {
        $db1Result = $this->adapters['soap']->demoRequest();
        $db2Result = $this->adapters['rest']->demoRequest();

        return $this->createEntity($db1Result, $db2Result);
    }

    protected function createEntity($db1Result, $db2Result)
    {
        $sponsor = new Sponsor();
        $sponsor->db1Result = $db1Result;
        $sponsor->db2Result = $db2Result;

        return $sponsor;
    }
} 
```

现在我有两个问题：

1.  现在 Sponsor 对象的属性只是 db1Result 和 db2Result，我会将其更改为实际属性（例如 firstName、lastName、email），因此 SponsorMapper::createEntity 将是这样的：

    ```
    protected function createEntity($db1Result, $db2Result)
    {
        $sponsor = new Sponsor();
        $sponsor->firstName = $db1Result->result->first_name;
        $sponsor->lastName = $db1Result->result->last_name;
        $sponsor->email = $db2Result->QueryResult->ItemObject->email;

        return $sponsor;
    } 
    ```

在我看来，这些东西应该发生在域对象而不是映射器中；我知道我可以将 db1Result 和 db2Result 视为它们自己的域对象并创建它们与 Sponsor 域对象的关系，但我不确定这是否是正确的方向。我应该在映射器中做吗？

1.  我需要引入一个缓存层，因为从外部数据库检索数据并不快。引入缓存层的最佳地点/实践在哪里？一种方法是在控制器中，因此将缓存层代码作为另一个映射器，如果这个缓存映射器不返回数据，我们可以走很长的路从外部检索东西。但是这个解决方案意味着我需要将所有这些逻辑放在控制器动作中，也许有更好的方法来放置缓存层？

**最初的问题：**

我们正在 PHP MVC 框架之上设计/创建一个 RESTFul API 项目。该项目的目标是充当其他两个“外部”API（一个 SOAP，另一个 REST）之间的适配器。

我认为这个项目中的模型应该大致像这样工作：

*   假设我们在各自的 API 后面的两个“外部”数据库上都有一组用户数据，并且我们在本地创建了一个模型“用户”
*   假设我们在“User”模型中有一个“GetById”方法，它需要：通过 id 从两个外部 API 中获取用户数据，组合并返回结果。
*   我可能会在“用户”模型中使用构建器模式来实例化 2 个其他模型（针对每个外部 API），并要求这 2 个模型获取数据。有了这个结构，我可以让另外两个模型继承它们与 API 通信所需的东西。
*   所以我们有这些模型：

    1.  用户
    2.  SOAP 生成器
    3.  REST 构建器
    4.  用户SOAP
    5.  用户REST

现在我不喜欢这个设计的是，结构有点复杂，我不知道根据它们的“类型”（用户模型本身，构建器模型）将这些模型文件放置到不同位置的好方法， ETC）。

我是否过度设计了这个？我应该考虑更好的模式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T04:25:37.527

MVC 中没有“多个模型”。模型是构成 MVC 设计模式的两层之一（与表示层一起）。人们通常所说的“模型”实际上是[领域对象](http://c2.com/cgi/wiki?DomainObject)。您可能会发现[这](https://stackoverflow.com/a/5864000/727208)很相关。

就是说，您正在以错误的方式看待这一切。您目前拥有的是[活动记录](http://martinfowler.com/eaaCatalog/activeRecord.html)模式的变化。只是，在这种情况下，存储介质不是数据库，而是 REST API 和/或 SOAP 接口，而不是经典的 SQL 存储。

在这种情况下，最好的选择是将域对象（例如`User`：）与存储相关逻辑的不同元素分开。我个人更喜欢为此实现[数据映射器](http://martinfowler.com/eaaCatalog/dataMapper.html)。本质上，如果你有一个域对象，你将它传递给映射器的方法，然后从所述对象中检索信息并将其发送到存储或从存储中检索数据并将其应用于该域对象。

该`User`实例不关心它是否被保存。它对域逻辑没有影响。

# facebook - 如何在codeigniter中添加像facebook这样的人的名字

> ID：12015216
> 
> 赞同：0
> 
> 时间：2012-08-18T02:01:11.013
> 
> 标签：facebook, codeigniter, url

就像在 facebook 中一样：www.facebook.com/[name_of_user]。

例如：www.facebook.com/david.paul

我们如何在 codeigniter 中做到这一点？如果 url (name_of_user) 的第一段是 codeigniter 中的控制器名称？如果 name_of_user 是同一个控制器，它将执行控制器而不是 name_of_user？

如果 name_of_user 在数据库中不可用，我们如何重定向到找不到页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T09:48:51.440

首先，您需要使用 .htacces 来摆脱 index.php。之后，您需要创建一个新路由：

```
$route['(:any)'] = 'user/checkName'; 
```

这条路线应该是第一条。但是有了这个，你应该知道，如果你有一个类似 :`www.example.com/chandra`或的 url `www.example.com/contact`，它们都将转到用户控制器 - checkName 方法。

在方法中，当你有了 url 段后，比如 chandra，你可以在数据库中搜索它，如果你没有找到，你可以创建一个不同的视图文件，或者你可以使用内置函数：

```
show_404('page'); 
```

这将使用`application/errors/error_404.php`模板。您可以在此处找到有关 404 页面的更多信息：

[http://codeigniter.com/user_guide/general/errors.html](http://codeigniter.com/user_guide/general/errors.html)

# visual-c++ - OpenCV 构建对 Windows 8 ARM 的支持

> ID：12015217
> 
> 赞同：1
> 
> 时间：2012-08-18T02:01:14.097
> 
> 标签：visual-c++, opencv

有没有人成功地在 Windows 8 上为 ARM 构建 OpenCV？

我对在平板电脑的 Windows 8 应用程序中使用 OpenCV 特别感兴趣。

这家伙展示了一些使用 OpenCV for Windows 8 的面部检测。但我认为它在 x86 上： [http ://channel9.msdn.com/Events/TechEd/NorthAmerica/2012/DEV322](http://channel9.msdn.com/Events/TechEd/NorthAmerica/2012/DEV322)

# entity-framework - EF >= 4.1。并发处理，逻辑行级检查

> ID：12015220
> 
> 赞同：1
> 
> 时间：2012-08-18T02:01:35.937
> 
> 标签：entity-framework, concurrency

我希望获得一些关于最佳方式/好方法的反馈，以处理 EF4.1 或更高版本中表行更改的逻辑行级乐观锁定。

我不喜欢标准的 concurrency=fixed on fields，因为只要更改了不同的字段，这似乎就允许并发更改。如果记录的完整性要求将所有字段视为一个集合，那么人们会怎么做？在所有字段上设置并发模式并“更新设置它们”。这个问题会出现什么模式？

我真正想做的是有一个用于并发的字段，例如 Int32。如果它同时增加，则更新失败。即一个负责并发的字段并不多。我以前是手动做的。每次更新都会在更改其设置的数据时检查 conc=conc，并且还有 conc=conc+1。

使用 EF 我只是将其设为并发字段并将其标记为 FIXED 并始终将其更新为 x=x+1，其余的由 EF 完成。

EF GURU 采用什么方法来解决行级概念。

一些帖子已经关闭但没有安静地解决这个问题。

或者深入了解有关防御的令人震惊的细节。用视图/ sps等做每一件事。

我曾希望 EF 中有一个简单的模式来解决行级方法。

我看了看...... [模型优先方法中带有时间戳属性的 EF 并发处理](https://stackoverflow.com/questions/10682591/ef-concurrency-handling-with-timestamp-attribute-in-model-first-approach)

[实体框架的行级安全性](https://stackoverflow.com/questions/170689/row-level-security-with-entity-framework) [http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/handling-concurrency-with-the-entity-framework-in-an-asp-模型优先方法中具有时间戳属性的net-mvc-application](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/handling-concurrency-with-the-entity-framework-in-an-asp-net-mvc-application) [EF 并发处理](https://stackoverflow.com/questions/10682591/ef-concurrency-handling-with-timestamp-attribute-in-model-first-approach)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T07:56:32.360

您只需使用`timestamp`or`rowversion`数据类型在表中创建一个特殊列（这些名称用于 SQL Server，在其他数据库中可能不同）。这种类型确实很神奇。如果行被更新，列的值会改变。您只需用 标记此列`ConcurrencyMode.Fixed`。

# php - DOMDocument 的 PHP getElementById() 的替代方案？

> ID：12015222
> 
> 赞同：1
> 
> 时间：2012-08-18T02:02:28.283
> 
> 标签：php, dom, domdocument, libxml2

**编辑**：与[PHP HTML DomDocument getElementById 问题相关](https://stackoverflow.com/questions/3391942/php-html-domdocument-getelementbyid-problems)

无法`getElementById()`上班。文档有效，根据使用 W3C 验证器。另外，即使有一点无效的 HTML，我的代码也应该可以工作。

这个简单的代码查找一个图像`id="banner"`并将其`src`属性替换为另一个图像。适用于我的开发机器（Windows），不适用于服务器（Ubuntu）。

知道如何在没有 的情况下执行此操作`getElementById()`吗？

```
 libxml_use_internal_errors(true);

    // Create the DOMDocument and get the HTML content
    $document = new \DOMDocument();

    // Load HTML string and if it fails just return the content itself
    if(false === $document->loadHTML($content)) return $content;

    // Get DOMElement of the image with id="banner"
    $img = $document->getElementById('banner');

    // Return the content if it can't find the image
    if(null === $img) return $content;

    // Get image parent and remove the banner from DOM
    $parent = $img->parentNode;
    $parent->removeChild($img);

    // Set the new src attribute
    $img->setAttribute('src', 'http://mysite.come/img/myimage.png');

    // Append the modified node to banner parent
    $parent->appendChild($img);

    return $document->saveHTML(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T02:32:29.977

明白了，不知道它是如何证明无效的：

```
$xpath = new \DOMXpath($document);
$nodes = $xpath->query('//img[@id="banner"]');

// Return content if we don't have exactly one image with id="banner"
if(1 !== $nodes->length) return $content;

// DOMNode of the banner
$banner = $nodes->item(0);

// Set the new src attribute and save the content
$banner->setAttribute('src', 'http://mysite.come/img/myimage.png');
$banner->ownerDocument->saveXML($banner);

return $document->saveXML(); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-18T03:08:55.780

从[`DOMDocument::getElementById()`](http://www.php.net/manual/en/domdocument.getelementbyid.php)文档中：

> 要使此函数起作用，您将需要使用 DOMElement::setIdAttribute 或将属性定义为 ID 类型的 DTD 设置一些 ID 属性。在后一种情况下，您需要在使用此函数之前使用 DOMDocument::validate 或 DOMDocument::$validateOnParse 验证您的文档。

# xcode - 运行配置命令时的问题（检查 C 编译器是否工作......否）

> ID：12015226
> 
> 赞同：3
> 
> 时间：2012-08-18T02:02:53.097
> 
> 标签：xcode, macos, unix, gcc, osx-lion

我正在尝试运行配置命令，但它会生成以下错误：我正在运行 Mountain Lion OS X 10.8

```
checking for grep that handles long lines and -e... /usr/bin/grep
checking for egrep... /usr/bin/grep -E
checking for a sed that does not truncate output... /usr/bin/sed
checking build system type... i386-apple-darwin12.0.0
checking host system type... i386-apple-darwin12.0.0
checking target system type... i386-apple-darwin12.0.0
checking whether the C compiler works... no
configure: error: in `/Users/aditya15417/php-5.4.6':
configure: error: C compiler cannot create executables
See `config.log' for more details. 
```

知道为什么会出现这个错误吗？我已经安装了 Xcode 命令行工具，并且正在从终端运行配置命令。

我有 XCode 4.4，我很确定 gcc 已经安装，因为它给了我：

```
686-apple-darwin11-llvm-gcc-4.2 (GCC) 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.11.00)
Copyright (C) 2007 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. 
```

我试过做：

```
sudo xcode-select -switch /Applications/Xcode.app/Contents/Developer 
```

但它也不起作用。如果需要，这是我的[config.log的链接。](https://gist.github.com/3383927)似乎从日志中找不到gcc4.2

```
configure:3524: checking for C compiler version
configure:3533: gcc-4.2 --version >&5
./configure: line 3535: gcc-4.2: command not found
configure:3544: $? = 127
configure:3533: gcc-4.2 -v >&5
./configure: line 3535: gcc-4.2: command not found
configure:3544: $? = 127
configure:3533: gcc-4.2 -V >&5
./configure: line 3535: gcc-4.2: command not found
configure:3544: $? = 127
configure:3533: gcc-4.2 -qversion >&5
./configure: line 3535: gcc-4.2: command not found
configure:3544: $? = 127
configure:3564: checking whether the C compiler works
configure:3586: gcc-4.2    conftest.c  >&5
./configure: line 3588: gcc-4.2: command not found
configure:3590: $? = 127
configure:3628: result: no 
```

这怎么可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T20:09:35.827

我刚刚编辑了 .bash_profile，并注释掉了 CC= 行，因为我似乎认为它是从以前的 MacPorts 安装中遗留下来的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T16:50:54.927

我在我的 .profile 文件中有一行： export CFLAGS="-arch ppc -arch x86_64 -g -O2 -m64" 。删除 -arch ppc 后，我可以成功运行 ./configure。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T02:48:48.697

从您的 config.log 文件中，它尝试使用`gcc-4.2`不存在的编译器。您需要告诉它使用确实存在的编译器，这通常通过设置环境变量来完成`CC`

# jquery - JQuery：将事件绑定到动态创建的元素？

> ID：12015230
> 
> 赞同：1
> 
> 时间：2012-08-18T02:03:31.063
> 
> 标签：jquery

```
$(function(){

    $("div").click(function(){
        $(this).clone().insertAfter( $(this) ); 
    });

}); 
```

这是一个愚蠢的小页面，每次单击 DIV 时，它都会生成它的副本并将其放置在它之后。

这似乎工作正常，但仅适用于已硬编码的 DIV。当 DIV 被克隆然后单击时，没有任何反应，因为事件尚未绑定到它。

什么是使这项工作的正确方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T02:06:43.837

使用[jQuery`.on()`函数](http://api.jquery.com/on/)。

```
$("body").on("click", "div", function() {
  //...
}); 
```

该[`.live()`](http://api.jquery.com/live/)函数曾经用于此目的，但在 jQuery 1.7 中已弃用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T02:05:04.473

有一个特殊的 jQuery 函数，`.live()`

```
$(function(){

    $("div").live("click",function(){
        $(this).clone().insertAfter( $(this) ); 
    });

}); 
```

# tomcat7 - 如何以非 root 用户身份启动 Tomcat7

> ID：12015231
> 
> 赞同：3
> 
> 时间：2012-08-18T02:03:42.637
> 
> 标签：tomcat7, root

我不想以 root 身份运行 tomcat7。

```
vagrant@dev$ /etc/init.d/tomcat7 stop
You need root privileges to run this script 
```

请告诉我如何以我当前的用户 vagrant 运行 tomcat7。

注意 - 如果有很多丑陋的配置来实现这一点，我会`sudo apt-get remove tomcat7`在 Ubuntu 中打开，然后将 tomcat7 从 .tar.gz 文件重新安装到非根目录。

谢谢，凯文

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T15:46:50.150

Ubuntu[在 Apache Tomcat 上的文档](https://help.ubuntu.com/11.04/serverguide/tomcat.html)有一个关于[为用户创建私有实例](https://help.ubuntu.com/11.04/serverguide/tomcat.html#tomcat-user)的部分。这是针对 Ubuntu 11.04 的，我更新了以下摘录以使用*tomcat7*：

> ### 安装私有实例支持
> 
> 您可以通过在终端提示符中输入以下命令来安装运行私有实例所需的一切：
> 
> `sudo apt-get install tomcat7-user`
> 
> ### 创建私有实例
> 
> 您可以通过在终端提示符中输入以下命令来创建私有实例目录：
> 
> `tomcat7-instance-create my-instance`
> 
> 这将创建一个新的 my-instance 目录，其中包含所有必要的子目录和脚本。例如，您可以在 lib/ 子目录中安装您的公共库，并将您的 webapps 部署在 webapps/ 子目录中。默认情况下不部署任何 web 应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T16:32:18.650

您无需成为 root 即可运行 Tomcat。只需[下载 Tomcat](http://tomcat.apache.org/download-70.cgi)包，解压缩或解压缩到您的首选目录，然后从 bin 目录启动 Tomcat：

```
<tomcatdir>/bin/catalina.sh start (or run) 
```

当然，您确实需要安装 java 的副本并可供您的用户访问。您可以在 /bin/setenv.sh 文件中指定任何自定义绑定/路径（例如 JAVA_HOME、JAVA_OPTS、CATALINA_OPTS）等。

# django - 找不到 Django 网址

> ID：12015236
> 
> 赞同：0
> 
> 时间：2012-08-18T02:04:17.203
> 
> 标签：django, url

我刚刚创建了一个新的 Django 视图。我`urls.py`在其他工作 url 中添加了路径：

```
url(r'^events/new/$', 'crewcal.views.new_event', name='new_event'),
url(r'^commit/$', 'crewcal.views.commit'),
url(r'^user/(?P<user_id>\d+)/$', profile, name='profile'), 
```

其他工作正常。我已重新启动服务器并尝试发出请求，但出现此错误。任何人都可以帮忙吗？

```
Page not found (404)
Request Method: GET
Request URL:    http://localhost:8000/commit
Using the URLconf defined in ssc.urls, Django tried these URL patterns, in this order:
^$ [name='home']
^events/(?P<event_id>\d+)/$
^events/new/$ [name='new_event']
^user/(?P<user_id>\d+)/$ [name='profile']
^register/$ [name='join']
^login/$
^logout/$ [name='logout']
^log_in/$ [name='log_in']
^admin/
The current URL, commit, didn't match any of these. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T02:29:27.337

尝试删除您的 .pyc 文件并重新启动服务器。

```
find /path/to/project/ -name "*.pyc" -delete 
```

# node.js - bson@0.1.1 安装：`node install.js`

> ID：12015238
> 
> 赞同：0
> 
> 时间：2012-08-18T02:04:32.040
> 
> 标签：node.js, mongodb

我正在尝试安装 mongodb。我使用了命令 >npm install mongodb<，但它给出了以下响应：

```
npm ERR! bson@0.1.1 install: `node install.js`
npm ERR! `cmd "/c" "node install.js"` failed with 1
npm ERR!
npm ERR! Failed at the bson@0.1.1 install script.
npm ERR! This is most likely a problem with the bson package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node install.js
npm ERR! You can get their info via:
npm ERR!     npm owner ls bson
npm ERR! There is likely additional logging output above.
npm ERR! System Windows_NT 6.1.7601
npm ERR! command "C:\\Program Files\\nodejs\\\\node.exe" "C:\\Program Files\\nod
ejs\\node_modules\\npm\\bin\\npm-cli.js" "install" "mongodb"
npm ERR! cwd D:\GitHub
npm ERR! node -v v0.8.2
npm ERR! npm -v 1.1.36
npm ERR! code ELIFECYCLE
npm ERR! message bson@0.1.1 install: `node install.js`
npm ERR! message `cmd "/c" "node install.js"` failed with 1
npm ERR!
npm ERR! Additional logging details can be found in:
npm ERR!     D:\GitHub\npm-debug.log
npm ERR! not ok code 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T07:59:25.713

我相信该节点不在您的路径中，并且我相信 npm 会退出，因此如果它不在 PATH 中，它将无法找到它。因此，在您的情况下，添加`C:\Program Files\nodejs`到您的 Windows“PATH”环境变量。

# ruby-on-rails - 使用 bootstrap-sass 扩展 bootstrap typeahead

> ID：12015243
> 
> 赞同：0
> 
> 时间：2012-08-18T02:05:16.860
> 
> 标签：ruby-on-rails, twitter-bootstrap, typeahead

我正在使用[bootstrap-sass gem](https://github.com/thomas-mcdonald/bootstrap-sass/)创建一个 Rails 站点，它工作正常。我还成功地在我的 js.erb 上初始化了预输入：

```
$container.find('.typeahead').typeahead({source: [<%= @cities %>], items:20}); 
```

但现在我想使用预先输入的扩展版本，它使用 kvp 对象数组而不是字符串。[来自 tcrosen 的这个](https://github.com/tcrosen/twitter-bootstrap-typeahead)似乎还不错。

我将他们的[bootstrap-typeahead.js](https://github.com/tcrosen/twitter-bootstrap-typeahead/blob/master/lib/bootstrap-typeahead.js)添加到 app/assets/javascripts 文件夹中。更改了 application.js 以包含该文件：

```
...
//= require jquery
//= require jquery_ujs
//= require bootstrap
//= require bootstrap-typeahead
//= require_tree . 
```

但似乎他使用的是 bootstrap.min.js 上定义的 typeahead 函数，而不是新的。

我怎样才能让他使用正确的文件？

ps：我正在使用其他引导 javascripts 插件，所以我不能只删除 bootstrap.min.js

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T21:20:58.473

而不是指定全局文件

```
//= require bootstrap 
```

您可以单独要求它们：

```
//= require bootstrap-affix
//= require bootstrap-alert
//= require bootstrap-button
//= require bootstrap-carousel
//= require bootstrap-collapse
//= require bootstrap-dropdown
//= require bootstrap-modal
//= require bootstrap-scrollspy
//= require bootstrap-tab
//= require bootstrap-tooltip
//= require bootstrap-transition 
```

所以不要包括最后一个`//= require bootstrap-typeahead`。有了它，您可以从 tcrosen 请求 bootstrap-typeahead javascript 文件（放入您的资产 javascript 目录并请求它，但不要忘记也重命名它，否则将使用旧的 bo​​otstrap typeahead）。使用 bootstrap-sass 和 tcrosen/twitter-bootstrap-typeahead 进行测试。

# java - Java：我的发行版不同于 IDE 调试

> ID：12015248
> 
> 赞同：1
> 
> 时间：2012-08-18T02:05:29.273
> 
> 标签：java, utf-8, localization, ide

当我通过 NetBeans IDE 从文本文件 (UTF-8) 中读取时，它可以正确读取英文和俄文字母，但是当我构建 distrib，运行它并读取相同的文件时，它无法识别俄文字母（我猜它会发生在英语以外的任何语言）。

我错过了什么？

![](../Images/9715f87ea71d5e63c79bdd40e5f75539.png)[[到https://img607.imageshack.us/img607/1558/javabug.jpg](https://img607.imageshack.us/img607/1558/javabug.jpg)的死链接]

更新：我如何阅读文本文件（我排除了案例代码的所有冗余）：

```
bReader = new BufferedReader(new FileReader(fileName));
String tempString;
tempString = bReader.readLine();
if ((tempString.length() >= 1) && (tempString.substring(0, 1).equals(""))) {
    tempString = tempString.substring(1);
}
//^^^ Former excludes UTF-8 Character at the beginning of a file
//it is actually placed in "", but it can't be seen here
while (tempString != null) {
    tempString = bReader.readLine();
} 
```

所以这里没什么特别的

qrtt1 先生在下面的评论中建议的实际上是有效的，即

> 尝试将编码配置添加到 vm: java -Dfile.encoding=utf-8 your_main_class

现在我想知道如何在不显式添加此参数的情况下更改程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T13:09:52.403

尝试向 vm 添加编码配置：

```
java -Dfile.encoding=utf-8 your_main_class 
```

Usually java programs have tiny scripts that start them (`.bat` on windows, or shell scripts on *n?x), so that would be a great place to put options to java.

# php - @[提及]的PHP正则表达式

> ID：12015249
> 
> 赞同：0
> 
> 时间：2012-08-18T02:05:32.237
> 
> 标签：php, regex

有人能帮我吗：

```
$pattern = "/^(?:[a-zA-Z0-9?. ]?)+@([a-zA-Z0-9]+)(.+)?$/";
$str = "Hey @[14256] hey how are you?";
preg_match($pattern, $title, $matches);
print_r($matches); 
```

如果我删除@提及的括号（@ [14256]），打印结果可以正常工作，但是我无法弄清楚如何使用正则表达式来处理括号。所以我会在我的数组中得到结果 14256 。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-18T02:09:01.387

您需要在正则表达式中包含括号：

```
"/^(?:[a-zA-Z0-9?. ]?)+@(\\[?[a-zA-Z0-9]+\\]?)(.+)?$/" 
```

注意我添加`\\[?`的；`\\]?`这些将匹配`[]`字符，如果没有`[]`.

请记住，以上将匹配`@[14256`和`@14256]`。如果你只想匹配一个或另一个，你需要做一些不同的事情。

```
"/^(?:[a-zA-Z0-9?. ]?)+@([a-zA-Z0-9]+|\\[[a-zA-Z0-9]+\\])(.+)?$/" 
```

这将匹配 EITHER`@aA1` *或* `@[aA1]`，但不是我上面展示的坏例子。

最后要包括的一件事：此正则表达式将仅匹配`@[mention]`. 如果您想匹配它的所有实例（例如“*嘿@123，这些天@456 怎么样？* ”），请使用以下内容`preg_match_all()`：

```
"/@([a-zA-Z0-9]+|\\[[a-zA-Z0-9]+\\])/" 
```

然后`$matches[1]`将同时包含`123`和`456`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T02:10:00.830

您需要转义正则表达式中的括号，以免它们被解释为新的字符类。试试这个（它只会捕获数字，而不是括号。将转义的括号放在括号中以将它们捕获为反向引用的一部分）：

```
$pattern = "/^(?:[a-zA-Z0-9?. ]?)+@\[([a-zA-Z0-9]+)\](.+)?$/"; 
```

# objective-c - 如果失败，请使用 NSURLConnection 调用 NSOperation

> ID：12015250
> 
> 赞同：1
> 
> 时间：2012-08-18T02:05:35.460
> 
> 标签：objective-c, nsurlconnection, nsoperation, nsoperationqueue

我有一个`NSURLConnection`在`NSOperation`. 这`NSOperation`是在`NSOperationQueue`. 所以，我想知道，如何用干净的代码召回`NSOperation`if`NSURLConnection`失败。（我想说的是，`NSURLConnection`例如在下载过程中失败的情况下）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T14:17:43.120

有一个现有的开源库可以为你做很多事情。这是[AFNetworking](https://github.com/AFNetworking)。

更重要的是，你经常使用`AFURLConnectionOperation`的类本身就是`NSOperation`.

您使用块来设置`AFURLConnectionOperation`将执行的代码：

```
- (void)setUploadProgressBlock:(void (^)(NSUInteger bytesWritten, long long totalBytesWritten, long long totalBytesExpectedToWrite))block;
- (void)setDownloadProgressBlock:(void (^)(NSUInteger bytesRead, long long totalBytesRead, long long totalBytesExpectedToRead))block;
- (void)setAuthenticationAgainstProtectionSpaceBlock:(BOOL (^)(NSURLConnection *connection, NSURLProtectionSpace *protectionSpace))block;
- (void)setAuthenticationChallengeBlock:(void (^)(NSURLConnection *connection, NSURLAuthenticationChallenge *challenge))block;
- (void)setRedirectResponseBlock:(NSURLRequest * (^)(NSURLConnection *connection, NSURLRequest *request, NSURLResponse *redirectResponse))block;
- (void)setCacheResponseBlock:(NSCachedURLResponse * (^)(NSURLConnection *connection, NSCachedURLResponse *cachedResponse))block; 
```

只需像往常一样添加`AFURLConnectionOperation`到您的。`NSOperationQueue`

`AFHTTPRequestOperation`也非常有用。它是用`AFHTTPClient`and创建的`NSMutableURLRequest`：

```
AFHTTPClient *client = [AFHTTPClient clientWithBaseURL:[NSURL URLWithString:@"http://www.google.com"]];
NSMutableURLRequest *request = [client requestWithMethod:@"GET" path:nil parameters:nil];
AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc]initWithRequest:request]; 
```

成功或失败很容易，它是用新的时尚块而不是老派的代表回调来处理的：

```
[operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation * request, id response)
 {
        // ... my success block
 }
 failure:^(AFHTTPRequestOperation *request, NSError *error)
 {
    // ... my failure block
 }]; 
```

# java - 如何绘制字符串，使其不覆盖旧字符串

> ID：12015252
> 
> 赞同：-1
> 
> 时间：2012-08-18T02:06:00.453
> 
> 标签：java, swing, jpanel, drawstring

![在此处输入图像描述](../Images/0233f8cad4f8477798d81877eed35ce6.png)我在我的 JPanel 中绘制了一些标志（hh：mm -> time），但是当我更新它并调用 repaint 时，它会覆盖旧字母（它们不会消失）。如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T02:09:06.800

删除前几行电话后，

```
revalidate(); 
```

然后

```
repaint(); 
```

**非常快速的代码**

```
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class TestComponent extends JPanel {

    private String drawThis;

    public TestComponent() {
        this.drawThis = "Hello";
        JButton button = new JButton("Change");
        button.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent e)
            {
                //Execute when button is pressed
                setDrawThis("World");
                repaint();
            }
        }); 
        this.add(button);
    }
    private void drawString(Graphics g, String text, int x, int y) {
        for (String line : text.split("\n"))
            g.drawString(line, x, y += g.getFontMetrics().getHeight());
    }

    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        drawString(g, drawThis, 20, 20);
    }

    public void setDrawThis(String s) {
        this.drawThis = s;
    }

    public static void main(String s[]) {
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        TestComponent tc = new TestComponent();

        f.add(tc);
        f.setSize(220, 220);
        f.setVisible(true);
    }
} 
```

# vb.net - 紧急逃生 [VB.NET]

> ID：12015253
> 
> 赞同：1
> 
> 时间：2012-08-18T02:06:04.303
> 
> 标签：vb.net, escaping

我正在编写一个控制台应用程序，它根据一组定义的规则列出一系列数字。它已被编程为在找到静态值后自行停止（下一个数字=此数字）。

但是，有一些例外情况不包含序列，控制台窗口只是继续运行数字。在这种情况下，我发现没有办法退出序列，只能手动关闭应用程序。

是否可以实现紧急逃生功能，例如，随时按下 Esc 键会触发应用程序放弃当前任务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T02:50:22.910

`Ctrl+C`应该终止应用程序。指定另一个键序列会稍微复杂一些，如果您只想立即退出而仅此而已，则可能不值得付出努力。

# regex - 使用正则表达式重写 IIS7 URL

> ID：12015254
> 
> 赞同：0
> 
> 时间：2012-08-18T02:06:18.240
> 
> 标签：regex, iis-7, url-rewriting

当用户访问我网站的某个 URL 时，我正在尝试进行 URL 重写：

```
Accessed URL: https://client1.domain.com

Rewritten URL: https://new-client1.otherdomain.com 
```

我的站点有许多指向它的 URL，因此简单的 HTTP 重定向模块将不是解决此问题的有效解决方案。正则表达式是什么，我想为重写规则中的每个部分填写什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T02:34:03.527

尝试这个：

```
s/client1.domain/new-client1.otherdomain/g 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T02:38:55.813

您可以使用此正则表达式模式进行搜索`client1.domain`以替换它：

```
(?<=//)([^.]+)\.domain 
```

将其替换为`client1`对新域的反向引用，如下所示：

```
$1\.otherdomain 
```

# c++ - 使用嵌套的 boost::binds

> ID：12015256
> 
> 赞同：4
> 
> 时间：2012-08-18T02:06:40.810
> 
> 标签：c++, boost-bind

```
编译器：g++ 4.4.3
提升...：1.49.0
操作系统……：Ubuntu

```

注意：自从我认真使用 C++ 已经 15 年了，所以我在重新学习和学习新事物，同时我也在尝试学习 Boost。

给定以下代码：

```
1\.      class Beta {
2\.      public:
3\.          std::string name();
4\.      }
5\.      
6\.      class Alpha {
7\.      public:
8\.          Beta m_beta;
9\.      }
10\.     
11\.     Alpha one; 
```

由于各种原因，我想使用 boost:bind 来实现与调用“one.m_beta.name()”相同的结果。我认为以下会做到这一点：

```
12\.     boost::function<std::string(Alpha)>
13\.         b = boost::bind(
14\.             &Beta::name,
15\.             boost::bind(&Alpha::m_beta, _1)
16\.         );
17\.     cout << "NAME = " << b(one) << "\n"; 
```

但是当我编译（Ubuntu 上的 g++ 4.4.3）时，出现以下错误：

> 错误：从 'const Beta*' 到 'Beta*' 的无效转换</blockquote>
> 
> 在查看了从第 13-16 行得到的实际类型定义之后，看起来第 15 行正在变成“const Beta*”，但它的绑定包装需要“Beta*”。
> 
> 但是，这确实有效：
> 
> ```
> 30\.     boost::function<std::string(Beta)>
> 31\.         p1 = boost::bind(&Beta::name,_1);
> 32\.     boost::function<Beta(Alpha)>
> 33\.         p2 = boost::bind(&Alpha::m_beta,_1);
> 34\.     std::cout << "NAME = " << p1(p2(one)) << "\n"; 
> ```
> 
> 但是我真的不想携带很多中间变量。它确实让我认为必须有某种方法让第一个版本也能正常工作。我已经尝试过以下作为第 15 行的替代品，但它们在编译时也会给出一个或另一个错误。
> 
> ```
> 50\. (boost::function<Beta&(Alpha)>)(boost::bind(&Alpha::m_beta,_1))
> 51\. (boost::function<Beta(Alpha)>)(boost::bind(&Alpha::m_beta,_1))
> 52\. (boost::function<Beta*(Alpha)>)(boost::bind(&Alpha::m_beta,_1))
> 53\. boost::protect(boost::bind(&Alpha::m_beta,_1))
> 54\. boost::ref(boost::bind(&Alpha::m_beta,_1))
> 55\. const_cast<Beta*>(boost::bind(&Alpha::m_beta,_1))
> 56\. const_cast<boost::function<Beta(Alpha) > >(boost::bind(&Alpha::m_beta,_1))
> 57\. const_cast<boost::function<Beta*(Alpha) > >(boost::bind(&Alpha::m_beta,_1)) 
> ```
> 
> 我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-18T03:19:54.560

显式指定`Beta&`嵌套的返回类型`boost::bind`：

```
boost::function< std::string( Alpha ) > b =
  boost::bind(
    &Beta::name,
    boost::bind< Beta& >( &Alpha::m_beta, _1 ) ); 
```

`const Beta*`发生和`Beta*`转换错误的原因是[`boost::bind`](http://www.boost.org/doc/libs/1_50_0/libs/bind/bind.html#with_member_pointers)具有与 相同的行为[`boost::mem_fn`](http://www.boost.org/doc/libs/1_50_0/libs/bind/mem_fn.html#Purpose)，其中指出：

> `mem_fn`还支持指向数据成员的指针，将它们视为不带参数的函数并返回对成员的（const）引用。`

因此，nested-bind 将返回 a `const Beta&`，这是一个无效的实例，无法调用`name()`on 的非常量成员函数`Beta`。

# html - 如何移动从页面边缘降低的div

> ID：12015260
> 
> 赞同：0
> 
> 时间：2012-08-18T02:07:15.747
> 
> 标签：html, css

这是我现在拥有的 jsfiddle [http://jsfiddle.net/Jw6kU/2/ 。](http://jsfiddle.net/Jw6kU/2/)我需要做的就是将白框和该 div 标签中的文本（“左”）放下，使其位于顶部绿色条的中心（67px 高）。我怎样才能轻松做到这一点？对不起，这是马虎，工作做得很快。

这是第二个帖子。第一个我通过粘贴错误的链接搞砸了。对不起。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T03:11:58.800

使用 margin-top css 属性会给页面顶部的 div 空间。您必须找到合适数量的像素并对其进行全面测试，但我认为这会有所帮助。

我将此添加到您的小提琴的 css 中，并在其下方的绿色 div 中心的顶部获得了白色 div。

```
#left {
    margin-top: 9px;
    padding-top: 12px;     
} 
```

# javascript - 选择文本时的处理程序

> ID：12015261
> 
> 赞同：3
> 
> 时间：2012-08-18T02:07:16.410
> 
> 标签：javascript, jquery

> **可能重复：**
> [Javascript](https://stackoverflow.com/questions/3545018/selected-text-event-trigger-in-javascript)
> [jquery中的选定文本事件触发器：选择文本事件](https://stackoverflow.com/questions/4367353/jquery-select-text-event)

javascript中是否有一个处理程序/侦听器确定何时在某个元素中选择文本？原始的 Javascript 很好，虽然 jQuery 会更受欢迎。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T02:15:12.743

Rangy 附带了与操作文本选择相关的各种好东西：[http ://code.google.com/p/rangy/](http://code.google.com/p/rangy/)

将它与 jQuery 一起使用非常简单。例如：

```
$( 'body' ).on( 'mouseup', function(){
  var sel = rangy.getSelection();
  if( sel.length > 0 ){
    console.log( sel );
  }
}); 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T02:13:18.927

没有可供选择的事件，但您可以使用它`document.getSelection`来访问当前可能选择的文本。您可以将处理程序绑定到`onmouseup`or`onkeyup`等​​。

# opengl - 当相机在OpenGL中旋转时，如何保持对墙壁之间角度的感知？

> ID：12015264
> 
> 赞同：-1
> 
> 时间：2012-08-18T02:08:09.827
> 
> 标签：opengl, camera

我正在建造许多不同形状的房间：平行四边形、矩形、菱形、正方形等。观众应该从不同的角落看房间，左右转动他的头，然后猜测房间的形状。所以这里“对墙之间角度的感知”非常重要。我的问题是这些：

1）从远处看，大多数锐角似乎是90度，

2）当观众向左或向右转头时，墙壁之间的角度以及墙壁的长度似乎会发生变化。

正如我到目前为止所读到的，这是使用透视投影的结果；然而，使用正交投影，我在屏幕上没有深度（没有深度感知），而且由于我在房间内，所以房间的大小应该大于裁剪区域，这会产生非常垃圾的图像。

我只是想知道有什么方法可以避免或至少最小化这种变形效果？我应该建立自己的投影（介于 glortho 和 glprospective 之间）吗？

还值得一提的是，我使用“glutlookatfunction”来定位相机和观察点。眼睛 位置 始终 是 房间 的 一个 角落 , 初始 观察 点 是 观察者 的 对 角 . 通过 按 左右 箭头 键 , 观察 点 在 环绕 房间 的 假想 圆 上 移动 , 就像 OpenGL 的 大部分到目前为止我看过的程序。你认为如果我移动墙上的观察点会更好吗？或者旋转房间而不是改变看点？

我添加了一些图片以更好地说明我的问题：

这是我的平行四边形房间：

[平行四边形.png](http://s16.postimage.org/nzswv5g4l/parallelogram.png)

正如你在这里看到的，锐角，应该是 60 度，似乎至少是 90 度。这是我的长方形房间，它根本不会给你在长方形房间里的感觉：

[矩形.png](http://s8.postimage.org/vmlej8l45/Rectangle.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T21:38:52.687

我会说，在没有看到实际问题的情况下，您的相机 FOV 太大。

根据您的评论，您的相机具有 112.5° 的水平 FOV，我认为这会在屏幕边缘引入“不自然的失真”：简单的 OpenGL 透视投影是线性的，并且 FOV 太宽。

您可能想看看[这篇](http://www.cambridgeincolour.com/tutorials/cameras-vs-human-eye.htm)将相机与人眼进行比较的文章，因为您想判断用户的感知。

您应该尝试减少相机的水平 FOV，可能在 80-90° 范围内，看看是否有帮助。

作为最后的手段，您可以切换到[非线性投影](http://paulbourke.net/miscellaneous/lenscorrection/)，但在切换到此之前，您应该做出明智的选择，应该有可能对您有所帮助的心理物理学研究（例如[这个）。](http://wwwpsy.uni-muenster.de/imperia/md/content/psychologie_institut_2/ae_lappe/freie_dokumente/steinicke_tvcg2010.pdf)

# c# - c#在texbox中取多行并将它们分开

> ID：12015269
> 
> 赞同：0
> 
> 时间：2012-08-18T02:09:18.983
> 
> 标签：c#

您好，我正在尝试编写一个需要 3 个用户输入的程序：文件路径、用户名和计算机名称，然后为列表中的每个计算机名称创建一个批处理文件。我还没有编写创建批处理文件部分，但是我无法从计算机文本框中取出多台计算机并从中创建单独的代码行。

因此，如果计算机文本框中有 3 个计算机名称，我希望当用户点击按钮时，将每个计算机名称输出到不同的行。

如果计算机名称文本框包含以下计算机名称：M22-LIBRL74258S、M22-LIBRL74257S 和 M22-LIBRL74256S

输出将是：

XCOPY "C:\Documents and Settings\Administrator\Desktop\file.exe" "\M22-LIBRL74258S\c$\Users\username\desktop"

XCOPY "C:\Documents and Settings\Administrator\Desktop\file.exe" "\M22-LIBRL74257S\c$\Users\username\desktop"

XCOPY "C:\Documents and Settings\Administrator\Desktop\file.exe" "\M22-LIBRL74256S\c$\Users\username\desktop"

谢谢！

```
WindowsFormsApplication1
{
       public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void browsebtn_Click(object sender, EventArgs e)
    {
        {

            OpenFileDialog openFileDialog1 = new OpenFileDialog();

            openFileDialog1.Title = "Select a File to Send";

            // Show the Dialog.
            // If the user clicked OK in the dialog and

            if (openFileDialog1.ShowDialog(this) == DialogResult.OK)
            {
                string strfilename = openFileDialog1.InitialDirectory + openFileDialog1.FileName;
                pathtxt.Text = strfilename.ToString();
            }

        }
    }

    private void Form1_Load(object sender, EventArgs e)
    {

    }

    private void createbtn_Click(object sender, EventArgs e)
    {

        string filepath = pathtxt.Text.ToString();

        string username = usertxtbox.Text.ToString();

        string computer = computerstxtbox.Text;
        string[] split = computer.Split(new char[] { '\n' });

        foreach (string l in split)
        {

            var strIP = "XCOPY \"" + pathtxt.Text + '"' + ' ' + '"' + "\\" + "\\" + l + "\\" + "c$" + "\\" + "Users" + "\\" + username + "\\" + "desktop" + '"';
            //This is to see it

            MessageBox.Show(strIP);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T02:22:44.387

尝试更换线路

```
string[] split = computer.Split(new char[] { '\n' }); 
```

用这个代替

```
string[] split = computer.Split(new String[] {"\r\n"}, StringSplitOptions.None); 
```

此外，如果您的计算机名称由逗号分隔，您还必须在拆分中指定它们。例如 new String[] {"\r\n", ","}

# python - Django：执行 ajax 调用时出现错误 500（内部服务器错误）

> ID：12015270
> 
> 赞同：5
> 
> 时间：2012-08-18T02:09:23.740
> 
> 标签：python, ajax, django, jquery

嗨，当我进行 ajax 调用时，我在控制台中得到了这个：

```
POST http://127.0.0.1:8000/registration/check/username/ 500 (INTERNAL SERVER ERROR) 
```

此外，当我单击此链接时，我得到以下信息：

```
DoesNotExist at /registration/check/username/
User matching query does not exist.
Request Method: POST
Request URL:    http://127.0.0.1:8000/registration/check/username/
Django Version: 1.3
Exception Type: DoesNotExist 
```

查询：

```
function check_username() {
    $("#id_username").change(function() {
        var user = $("#id_username").val();
        var status = $("#id_username").nextAll(".status").first().empty();
        var checking = '<img src="/site_media/images/loader.gif" align="absmiddle"> Checking availability...';
        var success = '<img src="/site_media/images/tick.gif" align="absmiddle">';
        var e_length = '<p>User name have to be longer</p>';
        if (user.length >= 3) {
            status.append(checking);
            $.ajax({
                url: "/registration/check/username/",
                type: "POST",
                data: { username : $("#id_username").val() },
                dataType: "text",
                success: function(msg) {
                    if (msg == '1') {
                        status.append(success);
                    }
                    else {
                        status.append("This username is already in use");
                    }
                }
            });
        }
        else if (user.length <= 3 && user.length != 0) {
            status.append(e_length);
        }
        else {
            status;
        }
    });
} 
```

html:

```
{% block main-menu %} 
    <div class="contentarea">
            <form method="post" action="">{% csrf_token %}
                <ul id="reg-form">
                    <li>
                        <label for="id_username">Username:</label>
                        <input id="id_username" type="text" name="username" maxlength="30" />
                        <div class="status"></div>
                    </li> 
```

网址.py：

```
...
(r'^registration/check/([\w|\W]+)/$', register_check),
... 
```

视图.py：

```
@csrf_exempt
def register_check(request, variable):
    if request.is_ajax():
        if variable == 'username':
            user = User.objects.get(username__exact = request.POST['username']);
            if user:
                msg = "1"
            else:
                msg = '0'
        return HttpResponse(msg)
    else:
        return HttpResponse("0") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T02:25:29.687

一般使用字符串作为`urls.py`. 而不是使用

```
(r'^registration/check/([\w|\W]+)/$', register_check), 
```

利用

```
(r'^registration/check/([\w|\W]+)/$', "register_check"), 
```

第一个应该是您的视图文件的路径。

**更新**

根据 Django 的 1.4 website [here](https://docs.djangoproject.com/en/1.4/ref/contrib/csrf/#ajax)，您需要将 csrf 令牌添加到 headers 中的请求中。不过，我没有阅读整个代码块。

# jquery - 悬停 jQuery 未激活

> ID：12015271
> 
> 赞同：0
> 
> 时间：2012-08-18T02:09:25.830
> 
> 标签：jquery

当我将鼠标悬停在输入字段上时，什么也没有发生。Chrome 控制台返回没有错误或错误。JQuery 脚本放在我的代码中。这是下面的代码。

```
<script src="http://code.jquery.com/jquery-latest.js"></script>

<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js">    

</script>

<style type="text/css">
    #button1 {display: none;}
</style>

<script type="text/javascript" >

    $('#form1').hover(function(){$('#button1').css("display", 

    "block");$(this).fadeIn(100);});

</script>

    <input type="text" id="form1"/>

    <input type="button" id="button1" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T02:14:18.473

将您的 jQuery 放入文档就绪调用中：

```
$(document).ready(function() {
    $('#form1').hover(function(){
        $('#button1').css("display", "block");
        $(this).fadeIn(100);
    });
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/TBY8B/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T02:14:07.427

改变它从

```
$('#button1').css("display", "visible"); 
```

至

```
$('#button1').css("display", "block"); 
```

此外，您需要`$(document).ready()`像这样将整个东西包裹在里面：

```
<script type="text/javascript" >

    $(document).ready(function(){
        $('#form1').hover(function(){
            $('#button1').css("display", "block");
            $(this).fadeIn(100);
            }
        );
    });

</script> 
```

# gcc - 如何在 gcc 中指定汇编程序风格

> ID：12015274
> 
> 赞同：1
> 
> 时间：2012-08-18T02:09:58.327
> 
> 标签：gcc, assembly, arm

我正在为嵌入式 ARM 设备编译程序，并希望从一个引导加载程序切换到另一个引导加载程序。两个引导加载程序都是用汇编程序编写的（用于相同类型的设备），但问题是它们是不同的方言/风格（也许是英特尔与 AT&T？）。现有的汇编代码在 gcc 中可以愉快地编译，但我想使用的却没有。

例如，现有（工作）代码如下所示......

```
 /* Comments are c-style */
    .syntax unified
    .arch armv7-m
    .section .stack
    .align 3
#ifdef __STACK_SIZE
    .equ    Stack_Size, __STACK_SIZE
#else
    .equ    Stack_Size, 0xc00
#endif
    .globl    __StackTop
    .globl    __StackLimit
__StackLimit:
    .space    Stack_Size
    .size __StackLimit, . - __StackLimit
__StackTop:
    .size __StackTop, . - __StackTop 
```

...我想使用的代码看起来像这样...

```
; comments are lisp-style
Stack_Size      EQU     0x00000400
                AREA    STACK, NOINIT, READWRITE, ALIGN=3
Stack_Mem       SPACE   Stack_Size
__initial_sp
; <h> Heap Configuration
;   <o>  Heap Size (in Bytes) <0x0-0xFFFFFFFF:8>
; </h>  
Heap_Size       EQU     0x00000200
                AREA    HEAP, NOINIT, READWRITE, ALIGN=3
__heap_base
Heap_Mem        SPACE   Heap_Size
__heap_limit
                PRESERVE8
                THUMB 
```

注意操作数的顺序，注释风格不同。第二个块是什么类型的汇编程序？可以告诉 gcc 期待这种格式并解析它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T18:19:17.837

第一个是 GNU gas 语法，第二个是 ARM 的商业工具链语法。

格式（指令和标签定义）不兼容，尽管指令语法本身是兼容的。将一个与另一个组装是不可能的，但生成的目标文件可以链接在一起。

但是，您的代码示例不包含任何指令，仅包含为堆栈和堆分配空间的各种汇编程序指令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T14:34:19.133

第一个在我看来像 AT&T，第二个像英特尔。我不认为 GCC 可以选择改变它使用的风格（因为它通过`GAS`使用 AT&T 的（GNU 汇编器）运行所有的汇编）。但是，如果您花一点时间学习 C 调用约定，您可以使用 NASM（Netwide Assembler，它使用 Intel 语法但不能内联）。只需在您的 C 标头之一中创建类似这样的定义：

```
extern void assembly_boot(); 
```

然后在你的程序集中，实现它（是的，前缀下划线是正确的）：

```
global _assembly_boot
_assembly_boot:
  ;Blah blah blah 
```

注意：该示例未实现 C 调用约定。如果您希望您的程序集可以从 C 调用，则需要使用 C 调用约定。谷歌他们。

# android - “这只能与不在后台堆栈中的片段一起使用”是什么意思？

> ID：12015277
> 
> 赞同：4
> 
> 时间：2012-08-18T02:10:18.407
> 
> 标签：android

我在 Android 文档上看到：

> 公共无效 setRetainInstance（布尔保留）
> 
> 自：API 级别 11 控制是否在 Activity 重新创建期间保留片段实例（例如来自 >configuration 更改）。**这只能与不在后台堆栈中的片段一起使用**。如果设置，>重新创建活动时，片段生命周期将略有不同：

谁能向我解释更多关于“这只能用于不在后堆栈中的片段”。我构建了一个简单的示例进行测试。我把片段放回堆栈。但是 setRetainInstance 方法仍然有效。我像这样把片段放到后台：

```
 FragmentTransaction transaction2 = getSupportFragmentManager().beginTransaction();

    MyFragment myFragment = new MyFragment();
    myFragment.setHasOptionsMenu(true);
    transaction2.replace(R.id.fragment_container, myFragment);
    transaction2.addToBackStack(null);
    transaction2.commit(); 
```

在我的片段 oncreate 方法中：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setRetainInstance(true);

    Log.v("MyFragment", "onCreate");
} 
```

我是片段的新手。请帮我解决这个问题。注意：我用过：SherlockFragment

# android - 是否可以从 Android 中的 .sql 文件导入数据库？

> ID：12015278
> 
> 赞同：2
> 
> 时间：2012-08-18T02:10:54.220
> 
> 标签：android, sqlite

我正在创建的应用程序将有一个包含问题和答案的数据库。我的问题是我需要进行数百次插入才能使数据库完整。使数百个插入语句成为可能的最佳方法是什么。我也在考虑通过 SQlite 管理器创建数据库，并从中导出一个 .sql 文件并使用它为我的应用程序创建一个数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T08:55:40.630

如果您的数据库中有静态数据，最好从 SQLite Manager 创建数据库并将其保存在 assets 文件夹中，然后在应用程序启动时将其从 assets 文件夹复制到您的数据库目录中。还要检查数据库文件是否存在，否则每次启动应用程序时它都会覆盖以前的文件。

# c# - 使用挂起的异步读取处理 XmlReader

> ID：12015279
> 
> 赞同：1
> 
> 时间：2012-08-18T02:11:56.410
> 
> 标签：c#, .net, xml, xmpp, .net-4.5

我正在编写一个 .NET XMPP 库是为了好玩，正如[其他地方](https://stackoverflow.com/questions/2263852/asynchronous-xmlreader-in-net)所讨论的那样，.NET 4.5 之前的版本中的`XmlReader`实现不适合从 a 解析 XML，`NetworkStream`因为它在填充内部 4KB 缓冲区或达到 EOF 之前不会开始解析.

其他图书馆根本不使用来解决这个问题`XmlReader`。正如前面链接的问题中提到的，jabber-net 使用 Java XML 解析器的一个端口。我在搜索时发现的一个实现 Babel IM 使用它自己的[简单 XML 解析器](http://babelim.codeplex.com/SourceControl/changeset/view/58017#201015)。我不确定 agsXMPP 是做什么的。

但是，随着 .NET 4.5 的发布，新的异步功能`XmlReader`显然得到了升级，现在可以进行真正的[异步解析](http://social.msdn.microsoft.com/Forums/en-US/xmlandnetfx/thread/9e73cdb3-c5d2-4426-a66b-ace363c4a80a/)。因此，我使用它来构建一个相当简单的 XMPP 客户端，该客户端可以连接到服务器并发送和接收消息。

然而，症结实际上似乎在于与服务器*断开连接*。在断开连接时，我通常只想`Dispose()`使用我的`XmlReader`实例和底层流。但是，`Dispose()`实际上会抛出一个`InvalidOperationException`带有消息“异步操作已经在进行中”的消息。如果您在异步时调用它...以及消息中的内容。然而，由于 XMPP 的性质，我`XmlReader`基本上一直在执行异步操作，因为它等待来自服务器的 XML 节从管道中下来。

似乎没有任何[方法](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader%28v=vs.110%29.aspx)可以用来告诉它取消任何挂起的`XmlReader`异步操作，以便我可以`Dispose()`干净地处理它。**有没有比简单地不尝试处理这种情况更好的方法来处理这种情况`XmlReader`？**XMPP[规范](http://xmpp.org/rfcs/rfc6120.html#streams-close)声明服务器应该`</stream:stream>`在断开连接时发送结束标记。我*可以*将其用作不尝试执行另一次异步读取的信号，因为管道中不应有任何其他内容，但不能保证这一点。

这是一些示例代码。`LongLivedTextStream`基本上模拟一个打开`NetworkStream`，因为它永远不会到达 EOF，并且会阻塞直到可以读取至少 1 个字节。您可以将 XML 文本“注入”到其中，它`XmlReader`会很乐意解析，但尝试处置阅读器将触发上述异常。

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading;
using System.Threading.Tasks;
using System.Xml;

namespace Example
{
    class LongLivedTextStream : Stream
    {
        ManualResetEvent moarDatas = new ManualResetEvent(false);

        List<byte> data = new List<byte>();
        int pos = 0;

        public void Inject(string text)
        {
            data.AddRange(new UTF8Encoding(false).GetBytes(text));

            moarDatas.Set();
        }

        public override int Read(byte[] buffer, int offset, int count)
        {
            var bytes = GetBytes(count).ToArray();

            for (int i = 0; offset + i < buffer.Length && i < bytes.Length; i++)
            {
                buffer[offset + i] = bytes[i];
            }

            return bytes.Length;
        }

        private IEnumerable<byte> GetBytes(int count)
        {
            int returned = 0;

            while (returned == 0)
            {
                if (pos < data.Count)
                {
                    while (pos < data.Count && returned < count)
                    {
                        yield return data[pos];

                        pos += 1; returned += 1;
                    }
                }
                else
                {
                    moarDatas.Reset();
                    moarDatas.WaitOne();
                }
            }
        }

        #region Other Stream Members

        public override bool CanRead
        {
            get { return true; }
        }

        public override bool CanSeek
        {
            get { return false; }
        }

        public override bool CanWrite
        {
            get { return false; }
        }

        public override void Flush() { }

        public override long Length
        {
            get { throw new NotSupportedException(); }
        }

        public override long Position
        {
            get { throw new NotSupportedException(); }
            set { throw new NotSupportedException(); }
        }

        public override long Seek(long offset, SeekOrigin origin)
        {
            throw new NotSupportedException();
        }

        public override void SetLength(long value)
        {
            throw new NotSupportedException();
        }

        public override void Write(byte[] buffer, int offset, int count)
        {
            throw new NotSupportedException();
        }

        #endregion
    }

    public class Program
    {
        public static void Main(string[] args)
        {
            Test();
            Console.ReadLine();
        }

        public static async void Test()
        {
            var stream = new LongLivedTextStream();
            var reader = XmlReader.Create(stream, new XmlReaderSettings() { Async = true });

            var t = Task.Run(() =>
                {
                    stream.Inject("<root>");
                    Thread.Sleep(2000);
                    stream.Inject("value");
                    Thread.Sleep(2000);
                    stream.Inject("</root>");
                    Thread.Sleep(2000);

                    reader.Dispose(); // InvalidOperationException: "An asynchronous operation is already in progress."

                    Console.WriteLine("Disposed");
                });

            while (await reader.ReadAsync())
            {
                bool kill = false;

                switch (reader.NodeType)
                {
                    case XmlNodeType.Element:
                        Console.WriteLine("Start: " + reader.LocalName);
                        break;

                    case XmlNodeType.EndElement:
                        Console.WriteLine("End:   " + reader.LocalName);
                        //kill = true; // I could use a particular EndElement as a signal to not try another read
                        break;

                    case XmlNodeType.Text:
                        Console.WriteLine("Text:  " + await reader.GetValueAsync());
                        break;
                }

                if (kill) { break; }
            }
        }
    }
} 
```

**编辑**

此示例使用实际`NetworkStream`并显示如果 I`Close()`或`Dispose()`基础流的`ReadAsync()`调用`XmlReader`不会像希望的那样返回 false，而是继续阻塞。

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Net;
using System.Net.Sockets;
using System.Text;
using System.Threading;
using System.Threading.Tasks;
using System.Xml;

namespace Example
{
    public class Program
    {
        public static void Main(string[] args)
        {
            NetworkStream stream = null;

            var endpoint = new IPEndPoint(IPAddress.Parse("127.0.0.1"), 50000);                                   

            var serverIsUp = new ManualResetEvent(false);
            var doneWriting = new ManualResetEvent(false);

            var t1 = Task.Run(() =>
            {
                var server = new TcpListener(endpoint);
                server.Start();

                serverIsUp.Set();

                var client = server.AcceptTcpClient();

                var writer = new StreamWriter(client.GetStream());

                writer.Write("<root>"); writer.Flush();
                Thread.Sleep(2000);
                writer.Write("value"); writer.Flush();
                Thread.Sleep(2000);
                writer.Write("</root>"); writer.Flush();
                Thread.Sleep(2000);

                doneWriting.Set();
            });

            var t2 = Task.Run(() =>
                {
                    doneWriting.WaitOne();

                    stream.Dispose();

                    Console.WriteLine("Disposed of Stream");
                });

            var t3 = Task.Run(async () =>
            {
                serverIsUp.WaitOne();                

                var socket = new Socket(SocketType.Stream, ProtocolType.Tcp);
                socket.Connect(endpoint);

                stream = new NetworkStream(socket, true);

                var reader = XmlReader.Create(stream, new XmlReaderSettings() { Async = true });

                bool val;
                while (val = await reader.ReadAsync())
                {
                    bool kill = false;

                    switch (reader.NodeType)
                    {
                        case XmlNodeType.Element:
                            Console.WriteLine("Start: " + reader.LocalName);
                            break;

                        case XmlNodeType.EndElement:
                            Console.WriteLine("End:   " + reader.LocalName);
                            //kill = true; // I could use a particular EndElement as a signal to not try another read
                            break;

                        case XmlNodeType.Text:
                            Console.WriteLine("Text:  " + await reader.GetValueAsync());
                            break;
                    }

                    if (kill) { break; }
                }

                // Ideally once the underlying stream is closed, ReadAsync() would return false
                // we would get here and could safely dispose the reader, but that's not the case
                // ReadAsync() continues to block
                reader.Dispose();
                Console.WriteLine("Disposed of Reader");
            });

            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T15:54:17.617

尝试将手册`</stream:stream>`注入解析器。为此，您可能需要 NetworkStream 和解析器之间的适配器类，它将所有传入数据传递给解析器，但添加另一个方法来注入`</stream:stream>`. 当您调用该方法时，您需要注意不要在另一个节的中间，也许通过在解析器的输出端保持状态。

# .htaccess - htaccess https 一页或 url 包括图像/css

> ID：12015281
> 
> 赞同：1
> 
> 时间：2012-08-18T02:12:07.210
> 
> 标签：.htaccess, codeigniter, mod-rewrite

我正在使用它来强制我的付款页面使用 HTTPS

```
RewriteCond %{HTTPS} off
RewriteCond %{REQUEST_URI} (signup/|payment) 
RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L] 
```

但是图像和 CSS 位于使用 Codeigniter 上设置的基本 URL 的完整 URL 上。

我如何仅在我的付款页面上强制这些 URL 使用 HTTPS？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T16:12:00.550

在 config.php 中更改您的 base_url

```
$config['base_url'] = (isset($_SERVER['HTTPS']) ? "https://" : "http://") . $_SERVER['HTTP_HOST'] . '/'; 
```

这应该可以解决您的问题。

# vb.net - VB.Net LINQ - 两个数据表之间的左外连接 - 限制为一行

> ID：12015284
> 
> 赞同：4
> 
> 时间：2012-08-18T02:13:06.677
> 
> 标签：vb.net, linq, datatable, left-join

我对 vb.net 中的 LINQ 有疑问。基本上我想在两个数据表之间创建 LEFT JOIN。

这是两个数据表的信息：

```
Dim vDT1 As New DataTable
vDT1.Columns.Add("Key")
vDT1.Columns.Add("Data1")
vDT1.Columns.Add("Data2")

vDT1.Rows.Add({"01", "DATA1_AAAA", "DATA2_AAAA"})
vDT1.Rows.Add({"02", "DATA1_BBBB", "DATA2_BBBB"})

Dim vDT2 As New DataTable
vDT2.Columns.Add("Key")
vDT2.Columns.Add("Data3")
vDT2.Columns.Add("Data4")

vDT2.Rows.Add({"01", "DATA3_AAAA", "DATA4_AAAA"})
vDT2.Rows.Add({"01", "DATA3_BBBB", "DATA4_BBBB"})
vDT2.Rows.Add({"01", "DATA3_CCCC", "DATA4_CCCC"})
vDT2.Rows.Add({"01", "DATA3_DDDD", "DATA4_DDDD"})

Dim vDRnull As DataRow = vDTsec.Rows.Add 
```

为了实现 LINQ JOIN 我尝试使用下一句话：

```
From a In vDT1.AsEnumerable
Group Join bTemp In vDT2.AsEnumerable
On a.Field(Of String)("Key") Equals bTemp.Field(Of String)("Key")
Into Group From b In Group.DefaultIfEmpty(vDRnull)
Select a, b 
```

这是结果（但我想删除红色行），我只想在第二个表中获得第一次出现：

![第一期](../Images/b2939017639c628a80bf23323186323a.png)

任何帮助将不胜感激！

* * *

我用正确的方法编辑问题。感谢杰夫梅尔卡多：

```
Dim vDT1 As New DataTable
vDT1.Columns.Add("Key")
vDT1.Columns.Add("Data1")
vDT1.Columns.Add("Data2")

vDT1.Rows.Add({"01", "DATA1_AAAA", "DATA2_AAAA"})
vDT1.Rows.Add({"02", "DATA1_BBBB", "DATA2_BBBB"})

Dim vDT2 As New DataTable
vDT2.Columns.Add("Key")
vDT2.Columns.Add("Data3")
vDT2.Columns.Add("Data4")

vDT2.Rows.Add({"01", "DATA3_AAAA", "DATA4_AAAA"})
vDT2.Rows.Add({"01", "DATA3_BBBB", "DATA4_BBBB"})
vDT2.Rows.Add({"01", "DATA3_CCCC", "DATA4_CCCC"})
vDT2.Rows.Add({"01", "DATA3_DDDD", "DATA4_DDDD"})

Dim vDRnull As DataRow = vDT2.Rows.Add

Dim vLINQ = From a In vDT1.AsEnumerable
    Group Join bTemp In vDT2.AsEnumerable
    On a.Field(Of Object)("Key") Equals bTemp.Field(Of Object)("Key")
    Into Group Let b = If(Group.FirstOrDefault Is Nothing, vDRnull, Group.FirstOrDefault)
    Select a, b 
```

![在此处输入图像描述](../Images/f52642175d2e865f518abd2e8df621ce.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-18T04:36:54.890

关键是召集`FirstOrDefault()`群。然后，您要么拥有组中的第一行，要么拥有`Nothing`.

```
Dim query =
    From a In vDT1.AsEnumerable
    Group Join b In vDT2.AsEnumerable
        On a.Field(Of String)("Key") Equals b.Field(Of String)("Key")
        Into Group
    Let b = Group.FirstOrDefault
    Select Key = a.Field(Of String)("Key"),
           Data1 = a.Field(Of String)("Data1"),
           Data2 = a.Field(Of String)("Data2"),
           Data3 = If(b Is Nothing, Nothing, b.Field(Of String)("Data3")),
           Data4 = If(b Is Nothing, Nothing, b.Field(Of String)("Data4"))

    ' Or Simply
    'Select a, b 
```

# java - Android 列表选择器半透明

> ID：12015289
> 
> 赞同：0
> 
> 时间：2012-08-18T02:14:35.050
> 
> 标签：java, android, listview

如果这已经被问到，请原谅我。但我想知道是否有一种简单的方法来调整`ListView`选择的透明度。我知道如何改变颜色，但有没有允许调整透明度的属性？或者您是否必须上传一些自定义背景？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T02:54:22.573

如果透明是指透明，而 ListView 选择是指 ListView 的单个项目，则称为[alpha](http://developer.android.com/reference/android/view/View.html#attr_android%3aalpha)。该链接应向您显示 XML 的信息，但您也可以使用 设置它`setAlpha()`，任何视图都可以访问它。

# java - 未收到数据

> ID：12015292
> 
> 赞同：2
> 
> 时间：2012-08-18T02:14:52.450
> 
> 标签：java, android, android-intent, toast

我编写了 android 代码来发送从一个活动的文本框中获取的数据，以显示在同一项目中另一个活动的 Toast 消息中

这是代码

主要活动的代码是

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Button btn = (Button) findViewById(R.id.button1);
    EditText txt = (EditText) findViewById(R.id.editText1);

    btn.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            String str = txt.getText().toString();
            Intent i = new Intent(MainActivity.this,Target.class);
            i.putExtra("Name", str);
            startActivity(i);
        }
    });

} 
```

目标活动的代码是

```
public void onCreat(Bundle savedInstanceState )
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_target);

    Bundle b = getIntent().getExtras();
    String s = b.getString("Name");
    Toast.makeText(Target.this, s, Toast.LENGTH_SHORT).show();
} 
```

当我运行项目并在文本框中写一些东西并按下按钮时，另一个活动被打开并且什么也没发生。

你能帮我告诉我为什么会出现这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T03:08:36.667

我有问题，小错字

```
public void onCreat(Bundle savedInstanceState) 
```

应该

```
public void onCreate(Bundle savedInstanceState) 
```

失踪`e`:)

它不会覆盖超类`onCreate`，尽管它是一个有效的函数。但永远不会被调用。

# mysql - 无法将存储引擎更改为 myisam，未知存储引擎“InnoDB”

> ID：12015293
> 
> 赞同：0
> 
> 时间：2012-08-18T02:14:57.733
> 
> 标签：mysql, innodb, myisam

我正在尝试使用`mysqldump`转储数据库，但出现错误：

> mysqldump：无法执行“显示创建表`wp_commentmeta`”：未知存储引擎“InnoDB”（1286）

不用担心; 我将进入 MySQL 并更改表的存储引擎：

```
mysql> show create table wp_commentmeta;
ERROR 1286 (42000): Unknown storage engine 'InnoDB'
mysql> Alter table wp_commentmeta ENGINE = myisam;
ERROR 1286 (42000): Unknown storage engine 'InnoDB' 
```

做错了什么？（和/或）我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T08:00:42.677

**有很多方法可以恢复 InnnoDB 表。**

如果你达到了这些目标，试试这个页面。

> 1.  你得到了 ibdata1、ib_logfile0 和 ib_logfile1 的备份
> 2.  您还使用 .frm 文件备份了数据库文件夹
> 3.  您想将此备份恢复到已经投入生产的 MySQL 服务器。

[http://egil.biz/how-to-recover-mysql-data-from-innodb/](http://egil.biz/how-to-recover-mysql-data-from-innodb/)

如果这不能解决您的问题，请尝试其他 InnoDB 恢复演练： [http ://www.mysqlperformanceblog.com/2008/07/04/recovering-innodb-table-corruption/](http://www.mysqlperformanceblog.com/2008/07/04/recovering-innodb-table-corruption/)

# javascript - JavaScript 跨域脚本

> ID：12015296
> 
> 赞同：2
> 
> 时间：2012-08-18T02:15:28.973
> 
> 标签：javascript, html, ajax

我有 2 个子域

```
passwordservices.example.com
computers.example.com 
```

所有计算机都连接到computers.example.com

域上名为 PC123456 的工作站的完全限定名称是

```
PC123456.computers.example.com 
```

网页托管在密码服务上。

如何编写托管在 PC123456 上的 javascript 并访问密码服务上的 DOM 元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T03:59:53.767

基本上，JS 认为即使是诸如 img.yourdomain.com 这样的子域也是与 www.yourdomain.com 不同的域。因此，来自这两个子域的页面之间的 AJAX 将不起作用。此外，如果您有一个从一个到另一个的 iframe，您将无法来回引用 JS 变量或函数。

解决此问题的一种方法是在一个域上设置 iframe html，然后从另一个子域上的页面调用该 iframe。您必须在父页面及其 iframe 上将 document.domain 设置为相同的内容，以便它们相互通信。

`document.domain = "yourdomain.com"`

[资料来源](http://www.tomhoppe.com/index.php/2008/03/cross-sub-domain-javascript-ajax-iframe-etc/)：tomhoppe.com

您可能还想研究[跨域资源共享](http://www.w3.org/TR/cors/)

祝你好运！！

# javascript - 从 $('img).width()/height() 获取标签宽度和高度不正确

> ID：12015297
> 
> 赞同：0
> 
> 时间：2012-08-18T02:15:38.923
> 
> 标签：javascript, jquery, coffeescript

我目前正在尝试获取纹理图像的 RGB 数据，同时向用户显示纹理的预览。

用户将图像文件放入表单中，它应该显示图像的预览，同时将图像绘制到画布以获取每个像素的 RGB 值：

```
handleTextureImageDrop = (e) ->
  e.stopPropagation()
  e.preventDefault()
  if e.dataTransfer.files.length >= 1
    file = e.dataTransfer.files[0]
  if file
    reader = new FileReader()
    reader.onload = (loadEvent) ->
      img = $ '<img/>'
      img.attr
        src: loadEvent.target.result
      $(e.target).html img
    reader.onloadend = (loadendEvent) ->
      img = $(e.target).children 'img'
      width = img.width()
      height = img.height()
      canvas = $ '<canvas/>', 
        width: width
        height: height
      $('#wrapper').append canvas
      context = $('canvas').get(0).getContext '2d'
      context.drawImage img.get(0), 0, 0
      rgb = (for x in [0...width]
               for y in [0...height]
                 context.getImageData(x, y, 1, 1).data)
      canvas.remove()
      TEXTURE_FILES.push 
        image: file.name
        rgb: rgb
    reader.readAsDataURL file 
```

就目前而言，它大约有 50% 的时间工作，但其余时间`width`并`height`设置为`0`，因此像素数据的迭代永远不会发生。

`<img/>`这将向我表明，在图像尚未加载到标签中的情况下发生了某种竞争情况。

这就是正在发生的事情吗？还是我错过了一些愚蠢而明显的东西？

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T02:57:22.400

只有在加载图像后，您才能获得正确的宽度和高度。通常`$(img).load`用于此。

```
$(img).load(function(e){
     var w = $(img).width();
     var h = $(img).height();
});
$(img).attr("src", "http://...."); 
```

我不熟悉coffeescript，所以我无法理解您是否在当前代码中执行此操作。如果没有，请尝试一下。

# java - jsoup 获取无序列表中的数据

> ID：12015299
> 
> 赞同：0
> 
> 时间：2012-08-18T02:16:01.013
> 
> 标签：java, jsoup

我正在使用 JSOUP 来提取数据。我有一个 html 文件：

```
=
<ul>
<li>
<i>
<a class="Class1" title="title1" href=""www.title1.com">title1</a>
</i>
(one)
</li>
<li>
<i>
<a title=title2" href="www.title2.com">title2</a>
</i>
(two)
</li>
<li>
<i>
<a title="title3" href=""www.title2.com">title3</a>
</i>
(three)
</li>
</ul> 
```

如何使用 JSOUP 打印 title1,title2 和 title3, 2) 如何打印 href？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T02:30:06.027

相当容易：

```
Document doc = Jsoup.parse(html);
Element link = doc.select("a").first();
String title1 = link.attr("title");

//etc. 
```

你看过[这里](http://jsoup.org/cookbook/extracting-data/attributes-text-html)吗？

还要确保 HTML 格式[正确](http://www.cogsci.ed.ac.uk/~richard/xml-check.html)。例如匹配引号

上面的 HTML 输出格式不正确，例如：

```
<a class="Class1" title="title1" href=""www.title1.com">title1</a>
                                       ^ extra quote

<a title=title2" href="www.title2.com">title2</a>
         ^ missing quote 
```

JSoup**需要**有效的 HTML。

# java - 检测跨不同 Java 实现或操作系统使用“危险”功能的技术？

> ID：12015300
> 
> 赞同：4
> 
> 时间：2012-08-18T02:16:08.627
> 
> 标签：java, jvm, integration-testing

我负责一些 Java 应用程序服务器，它们托管来自不同团队的不同开发人员的应用程序。

一个常见的问题是发送的某些应用程序无法按预期运行，结果证明该应用程序是在其他平台上开发的，即 winXp 或 7 上的 openJDK，然后部署到运行 Oracle JDK 的 Linux 上，反之亦然。

能够预先执行某些事情会很好，但这实际上是不可能的。

因此，是否有任何技术可以***在部署***时检测问题，我的意思是，在没有源代码的情况下，通过扫描类文件？

如果这不可能，我可以使用什么工具发送给开发人员，以便他们从源代码中识别出他们所依赖的不兼容之处？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T02:21:04.420

不可能以完全自动化的方式检测所有此类问题。例如，很难检测*硬编码的路径名*，这可能是跨平台部署的最大问题。

我的建议是在部署时通过更多的自动化测试来弥补这一点。

例如，在一个类似的环境中，我曾经坚持**部署测试套件**：通常实现为一个安全的网页，我可以作为管理员导航到它，它将在已部署的应用程序上运行一套测试并显示所有结果。

如果有任何失败，那就是立即回滚。

有些测试与开发中使用的测试相同，但有些不同（例如，检查正在部署的环境的预期配置）

显然，这意味着您必须将至少一些测试代码捆绑到您的生产应用程序中，但我认为这是非常值得的。作为管理员，如果您刚刚在暂存环境中看到一个充满绿色标记的大屏幕，那么您将更有信心将版本推送到生产环境。

# ruby - 在 Watir Webdriver 中使用默认 Firefox 配置文件但关闭 JavaScript

> ID：12015301
> 
> 赞同：0
> 
> 时间：2012-08-18T02:17:06.563
> 
> 标签：ruby, firefox, selenium, webdriver, watir

当 watir-webdriver 启动 friefox 浏览器时，我想在 Firefox 中使用我的默认配置文件，但是我想以这种方式关闭该浏览器中的 javascript：

```
browser = Watir::Browser.new :ff, :profile => "default"
browser.profile['javascript.enabled']=false 
```

第二个引用不起作用，因为“配置文件”不是浏览器对象的成员。我怎样才能访问它？或者在默认配置文件或正在运行的 Firefox 窗口中关闭 javascript 的任何其他方法？我想以编程方式执行此操作，因为在我的 Ruby 脚本结束时，我想再次打开它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T23:59:23.543

我想你会这样做：

```
profile = Selenium::WebDriver::Firefox::Profile.new  
profile['javascript.enabled'] = false  
browser = Watir::Browser.new :ff, :profile => profile 
```

# android - 应该使用什么用户身份来整理来自 Google Play 的应用内购买？

> ID：12015303
> 
> 赞同：5
> 
> 时间：2012-08-18T02:17:49.003
> 
> 标签：android, in-app-purchase, in-app-billing, google-play

通过 Google Play 使用应用内结算时，您会收到一个 PURCHASE_STATE_CHANGED 广播意图，其中包含有关购买的信息。那个时候你

1.  验证购买（可能在您自己的服务器上）
2.  记录购买（如果它是非托管项目，几乎可以肯定在您自己的服务器上）
3.  更新您的应用以反映购买情况

我的问题是：在您自己的服务器上记录购买时，应该使用哪个用户身份来整理非托管项目的多次购买（和使用）？您如何在 Android 上获得此身份？

注意，身份不能是特定于设备的，因为用户可能拥有多个设备。它需要与用于购买的 Google Play 帐户相关联。从 Google Play 返回的意图中的数据似乎不包含任何用户身份（无论是否经过混淆）。

我正在寻找在哪里/如何在 Android 上找到 Google Play 身份以及如何将其发送到 AppEngine 立场。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T21:24:36.243

几个月前，当 Google Play 服务尚未发布时，我看到了您[在 Google Groups 上的讨论。](https://groups.google.com/d/topic/android-developers/dfOpWRIiZ2o/discussion)

您现在可以使用[Google Play 服务](https://developer.android.com/google/play-services/index.html)作为执行此操作的标准方式。请参阅[AccountPicker](https://developer.android.com/reference/com/google/android/gms/common/AccountPicker.html)。

# objective-c - 属性与实例变量

> ID：12015307
> 
> 赞同：5
> 
> 时间：2012-08-18T02:19:25.777
> 
> 标签：objective-c, object, properties, ivar

我对为什么有些类声明属性但不声明 ivar 感到困惑，反之亦然。

在声明实例变量时也将其声明为属性是否是标准做法？

例子：

```
@interface AppDelegate : NSObject <UIApplicationDelegate>
{
    UIWindow *window;
    UINavigationController *navigationController;
}

@property (nonatomic, retain) IBOutlet UIWindow *window;
@property (nonatomic, retain) IBOutlet UINavigationController *navigationController; 
```

在声明一个类的 ivar 以使其成为属性时，这只是标准做法吗？

我知道@property 创建了自己的细长设置器（和@synethesize 的getter），但为什么它也需要是一个ivar？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-18T02:31:32.210

它没有。

在过去，ivars 需要在`@interface`. 这实际上仍然适用于 PPC 和 i386（即 32 位英特尔）目标。这是因为[脆弱的基类问题](http://en.wikipedia.org/wiki/Fragile_base_class)，它要求所有子类都知道其超类的确切大小。因此，ivars 需要在`@interface`或没有人可以子类化该类。

随着转向 x86_64 和 ARM，与 obj-c 2.0 一起修复了脆弱的基类问题。有了这个修复，类大小不再需要在编译时知道，而是可以推迟到运行时。因此，ivars可以在其他地方声明。值得注意的是，现在可以从 a `@property`（更具体地说是`@synthesize`实现中的行）合成 ivar。在 Clang 中，它们也可以在类扩展块（看起来像`@interface ClassName ()`）中声明，或者直接在`@implementation`.

今天，您发现在块中声明的 ivars 有 3 个原因`@interface`：

1.  尚未更新以利用隐藏 ivar 声明的能力的旧代码（或具有旧习惯的程序员）。
2.  需要在 PPC 或 i386 上运行的代码。
3.  无论出于何种原因，都希望他们的 ivars 公开的代码。绝不应该是这种情况。

当今天编写不需要针对旧运行时的代码时，您应该从您的属性（首选）合成您的 ivars，或者如果您需要不与属性绑定的 ivars，您应该在类扩展中声明它们或你的`@implementation`. 这样做的主要原因是因为头文件记录了您的类的公共 API，并且不应包含任何不公开的内容。Ivar 不是公开的，因此不应该在头文件中。

# sql-server - 从多个列聚合数据（类似于 PIVOT 表）

> ID：12015314
> 
> 赞同：3
> 
> 时间：2012-08-18T02:20:10.037
> 
> 标签：sql-server, pivot-table

我有一个包含以下数据的表（在此示例中缩短）：

```
 C1    C2    C3    C4
=========================
1   0     1     1     0
2   1     1     0     1
3   1     0     1     1
4   1     1     1     1
5   0     0     1     1
6   0     0     0     1 
```

我想创建一个创建查询，它给我以下结果：

```
 C3    C4
=============
C1   2     3 
C2   2     2 
```

也就是说，这四列的组合在以下情况下：

```
C1 = 1 & C3 = 1
C1 = 1 & C4 = 1
C2 = 1 & C3 = 1
C2 = 1 & C4 = 1 
```

我已经能够取得一些进展，但最终不是我想要的。我已经做到了这一点：[http ://sqlfiddle.com/#!3/7d3d4/2/0](http://sqlfiddle.com/#!3/7d3d4/2/0)

但我无法弄清楚如何让我的查询格式化为我想要的上面的输出。我打算尝试使用`PIVOT`表格，但很快就放弃了这个想法，因为一旦我需要添加第二条语句，它似乎变得非常复杂`PIVOT`（我最终不得不添加更多，因为我上面的示例是一个非常基本的示例我需要执行此操作的列数）。

我错过了什么？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T06:31:33.547

尝试这个：

```
SELECT 'C1',SUM(CASE WHEN C1=1 AND C3=1 THEN 1 END)AS C3,
            SUM(CASE WHEN C1=1 AND C4=1 THEN 1 END)AS C4
FROM T1
UNION ALL
SELECT 'C2',SUM(CASE WHEN C2=1 AND C3=1 THEN 1 END)AS C3,
            SUM(CASE WHEN C2=1 AND C4=1 THEN 1 END)AS C4
FROM T1 
```

# [SQL 小提琴演示](http://sqlfiddle.com/#!3/1a0ab/2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T03:43:22.387

我认为这会给你所要求的结果集

```
SELECT COL1, C3, C4
FROM (
     SELECT SUBSTRING(col,1,2) col1, SUBSTRING(col,3,2) col2, value
     FROM (
           SELECT SUM(c1*c3) as c1c3, SUM(c1*c4) as c1c4, 
                  SUM(c2*c3) as c2c3, SUM(c2*c4) as c2c4
           FROM t1
          ) t 
     UNPIVOT (value FOR col IN (c1c3, c1c4, c2c3, c2c4)) AS u
    ) data
PIVOT (SUM(value) FOR col2 IN ([c3], [c4])) pvt 
```

我开始编写一个给出总数的查询，结果集如下所示

```
c1c3     c1c4     c2c3    c2c4
 2        3        2       2 
```

此时您可能只使用此查询并会得到想要的结果

```
SELECT 'c1' AS col, c1c3 AS C3, c1c4 AS C4
UNION ALL
SELECT 'c2' AS col, c2c3 AS C3, c2c4 AS C4 
```

第一个解决方案只是一个示例，说明如何 UNPIVOT 然后再次 PIVOT 以您想要的方式对列进行排序

# php - 如何在 MySQL/PHP 中处理用户数据，对于大量用户和数据条目

> ID：12015317
> 
> 赞同：3
> 
> 时间：2012-08-18T02:20:26.853
> 
> 标签：php, mysql, database-design

让我们在这里和我一起假装：

PHP/MySQL 网络应用程序。假设一个服务器和一个 MySQL DB。

我有1000个老板。每个老板手下有10个工人。`work orders`这 10 个工作人员（乘以 1k，总计 10,000 个工作人员）每个工作日在 WebApplication中至少有 5 个数据库条目（为此目的调用它们）。在此工作订单表中，**每天有 50k 个条目**。

除了服务器问题，我在这里看到了两种处理数据库基本逻辑的主要方法：

1.  每个Boss都有一个ID。有一个名为的表`workorders`，它有一个名为`BossID`将每个工单与老板相关联的列。这样一来，您每个月在一个表中就有大约 100 万个条目，对我来说，这似乎加起来很快。

2.  每个 Boss 都有自己的**表**，该表是在该 Boss 注册时创建的，即`work_bossID`where `bossID = the boss' unique ID`。这会给您留下 1,000 个表，但这些表更易于管理。

* * *

*   我忽略了第三种选择吗？

*   哪种方法会是效果更好的方法？

*   对于表中的条目数来说有多大（假设列数很少：小于 10）？（这可能包括：是时候获得第二台服务器了……）

*   数据库中的表数量有多大？（这可能包括：是时候获得第二台服务器了……）

我知道在某些时候我们必须讨论多台服务器和链接在一起的数据库......但是，让我们再次关注具有单个 MySQL DB 的单个服务器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T02:25:38.483

如果您使用单个服务器，我认为表的大小没有问题。它不仅是表中的记录数，还包括访问频率。

要管理大型数据集，您可以使用多个服务器。在这种情况下：

*   您可以将所有工作订单保存在一个表中，并将它们镜像到不同的服务器（以便您拥有从属服务器）

*   您可以按老板对工单表进行分片（在这种情况下，您根据工单所属的位置访问服务器）- 搜索数据库分片以获取更多信息

您选择哪个选项取决于您将如何使用数据库。

* * *

## 镜子（主/从）

将所有工单保存在一个表中有助于在您不知道工单属于哪个老板时进行查询，例如。如果您按产品类型搜索，但任何老板都可以在任何产品类型中下订单。

但是，您必须在每个镜像上存储所有内容的副本。此外，只有一台服务器（主服务器）可以处理更新（或添加工单）SQL 请求。如果您的大多数 SQL 查询都是 SELECT 查询，这很好。

* * *

## 分片

分片的优点是您不必在每个镜像服务器上都存储记录的副本。

但是，如果您正在通过某个属性搜索任何老板的工单，则必须查询每个服务器以检查每个分片。

* * *

## 如何选择

总之，如果您可以进行各种查询，包括按属性浏览工单（除了它属于哪个老板），请使用单个表，并且您可能有更多的 SELECT（读取）查询而不是写入查询。

如果您可以将写入查询的数量级与读取查询的数量级相同，并且/或者您想节省内存，并且通过其他属性（不是老板）搜索的查询很少见，请使用分片。

* * *

## 保持快速查询

大型数据库如果不被查询淹没的话并不是什么大问题，因为它们可以将大部分数据库保存在硬盘上，并且只将最近访问的内容保存在缓存中（在内存上）。

防止任何单个查询运行缓慢的另一件重要事情是确保为可能执行的每个查询添加正确的索引以避免线性搜索。这是为了允许数据库对所需的记录进行二分搜索。

如果您需要维护记录计数，无论是整个表还是按属性（类别或老板），然后保持计数器缓存。

## 何时获得新服务器

由于变量太多，您实际上无法分配一个数字来确定何时需要新服务器。可以通过查看查询的执行速度以及服务器的 CPU/内存使用情况来做出此决定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T04:20:22.593

扩展通常是一个实验案例，因为从一开始并不总是清楚瓶颈在哪里。由于您似乎对系统将承受的负载类型有一个很好的了解，因此首先要做的事情之一就是在电子表格中记录这一点，以便您可以制定一些假设。这使您可以做很多快速的“假设”场景，并为您在第一次构建时必须扩展多远提出一个合理的上限。

为了收集大量记录，有一些简单的规则：

*   使用最有效的数据类型来表示您所描述的内容。不要担心使用较小的整数类型来减少几个字节，或者缩小 varchars。这里重要的是使用整数表示数字，使用日期字段表示日期，等等。不要将 varchar 用于已经具有正确类型的数据。
*   不要过度索引您的表，只添加绝对必要的内容。您拥有的索引数量越多，随着表的增长，插入的速度就越慢。
*   清除不再需要的数据。哪里实用删除它。在需要长时间保留的地方，制作可以将其转储到的备用表。例如，您可以每季度或每财年轮换一次主订单表，以保持其快速运行。如果需要报告，您可以随时调整查询以针对其他表运行。使您的工作数据集尽可能小。
*   通过基准测试、修补、研究和试验来调整您的 MySQL 服务器。这里没有灵丹妙药。有许多变量可能对某些人有用，但可能会减慢您的应用程序。它们还高度依赖于操作系统、硬件以及数据的结构和大小。通过为数据库引擎（例如 InnoDB 或 MyISAM）分配更多内存，您可以轻松地将性能提高一倍或四倍。
*   如果您认为它们可能有很大帮助，请尝试使用其他 MySQL 分支。有一些提供了比常规 MySQL 更高的性能，特别是[Percona](http://www.percona.com/)。
*   如果您经常且积极地查询大型表，则对某些数据进行反规范化以减少必须完成的昂贵连接的数量可能是有意义的。例如，在留言板上，您可能会在每条消息中包含用户名，尽管这看起来很浪费数据，但它可以非常非常快地显示大量消息列表。

考虑到所有这些，最好的办法是设计您的模式，构建您的表，然后使用它们。模拟加载 6-12 个月的数据，看看它在真正加载后的表现如何。`EXPLAIN`如果您使用较慢的查询，您会发现各种问题。最好在比生产数据库服务器慢的开发系统上执行此操作，这样在部署时不会有任何意外。

扩展的黄金法则是**只优化实际存在的问题**，并避免仅仅因为它看起来是个好主意而对其进行调整。过度设计一个解决方案非常容易，该解决方案稍后会与您的意图相反或被证明极难撤销。

如果您在推出之前仔细试验并证明它在一定容量下工作，MySQL 可以处理数百万甚至数十亿行而不会有太多麻烦。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-18T03:13:40.660

我的一个网络也有数据库大小问题，它太大了，当我对该表运行查询时，它会降低服务器速度。

在我看来，将您的数据库划分为日期决定什么表大小对您来说太大了 - 比如说 100 万个条目，然后计算您需要多长时间才能达到这个数量。然后每隔一段时间都有一个脚本来创建一个带有日期的新表并将所有当前数据移到上面，或者只是备份该表并将其清空。

就像把过时的材料放在档案馆里一样。

如果您选择第一个选项，您将能够通过参考该表轻松访问该日期。

希望这个想法有帮助

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-08-18T02:24:38.860

只需为两者创建一个工人表、老板表、关系表，然后创建所有其他表。有了这样的关系结构，它是非常动态的。因为，如果它变得足够大，您可以在工作订单与老板或工人之间创建另一个关系表。

您可能想研究 bigints，但我怀疑您是否需要它。我知道关系表会变得很大，但那是很好的数据库设计。

当然 bigint 是针对 mySQL 的，它可以正常上到 -9223372036854775808 到 9223372036854775807。0 到 18446744073709551615 未签名*

# javascript - Javascript - 文本字段提交到弹出窗口

> ID：12015324
> 
> 赞同：1
> 
> 时间：2012-08-18T02:21:14.333
> 
> 标签：javascript, jquery, wordpress, popup

我需要有这个逻辑

（文本字段）（提交按钮）

人员输入一串数字/字母 - 如果正确；出现一个弹出窗口，显示 pdf。如果发生错误验证并显示错误消息

我已经让它作为一个 DROP DOWN >> to >> PDF POPUP 工作。但这行不通。

任何人都可以帮我解决这个问题 - 花费数小时让下降到流行工作并且需要改变方向。

注意：需要在wordpress页面+模板中工作。

```
<form style="float:right;">
<table width="369" border="0" align="center" cellpadding="10" cellspacing="0">
 <tr>
 <td><select name="URL" style="font-size:20px;background:yellow;padding:9px 15px;-webkit-      border-radius: 5px;-moz-border-radius: 5px; background: -webkit-gradient(linear, left top, left 25, from(#FFFFFF), color-stop(4%, #000000), to(#FFFFFF)); background: -moz-linear-gradient(top, #FFFFFF, #000000 1px, #FFFFFF 25px);">
 <option value="">Select your number</option>
 <option value="123.pdf">123</option>
 <option value="456.pdf">456</option>
 </select></td>
 <td><p><input type="button" style="padding:9px 15px; background: #617798; border: 0; font-size: 14px; color: #FFFFFF;-webkit-border-radius: 5px;-moz-border-radius: 5px;!important;"   value="Check Number #" onclick="if (this.form.URL.value) window.open(this.form.URL.value, '_blank','toolbar=0','width=30','height=20');" /><br /></td>
 </tr>
 </table>
 </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T02:33:50.063

HTML：

```
<form onsubmit="return false;">
    <input type="text"/>
    <input type="submit"/>
</form>
​ 
```

Javascript：

```
$('form').submit(function() {
    if ($('input[type=text]').val() == "some_pdf.pdf") {
        window.open("http://link_to_some_pdf.com/some_pdf.pdf");
    } else if ($('input[type=text]').val() == "some_other_pdf.pdf") {
        window.open("http://link_to_some_other_pdf.com/some_other_pdf.pdf");
    }  else {
        alert("Not a valid PDF! Try again!");
    }
}); 
```

​</p>

jsfiddle：http: [//jsfiddle.net/vu26C/](http://jsfiddle.net/vu26C/)

# css - 布局与液体固定液体设计......似乎无法正确

> ID：12015329
> 
> 赞同：0
> 
> 时间：2012-08-18T02:22:16.490
> 
> 标签：css, liquid-layout

我知道我应该知道如何做到这一点，但是对于我在 SO 和互联网上的所有搜索，它都在逃避我。一位朋友想要一个具有固定宽度居中包装器的页面，宽度为 990 像素。左右将没有内容，但他希望页眉和页脚像流动布局一样延伸到页面的末端。我从来没有建立这样的网站，所以我被困住了，我只做固定宽度的居中包装器。

我想用 CSS over 表格来完成这个，这是他的偏好。

标题不是纯黑色，它是一个薄的 .png，作为 BG 图像重复。

页脚是纯 BG 颜色。

页面当前设置了包含在中心包装中的正确页眉和页脚，但没有任何东西向左和向右延伸。

页面链接：[http ://www.jalvisualmedia.com/testsite/mystique/private_label.php](http://www.jalvisualmedia.com/testsite/mystique/private_label.php)

如果我省略了任何有用的东西，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T02:29:01.097

您可以尝试将 #wrapperTop 和 #footer id 放在固定宽度的中心包装之外，并将它们的宽度设置为 100%。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T02:55:42.700

试试这个

```
#wrapperTop{
    width: 100%;
    height: 162px;
    margin: 0;
}

#navbar {
    height: 40px;
    width: 990px;
    margin: auto;
    background-image: url(../graphics/bg_top.png);
}

#header {
    height: 120px;
    width: 990px;
    margin: auto;
}

#imageSlice {
    width: 990px;
    height: 95px;
    background-color: white;
    margin: auto;
}​

#footer {
    width: 100%;
    height: 145px;
    margin: 0;
    background-image: url(../graphics/bg_bottom.png);
}

#navBox {
    width: 600px;
    height: 75px;
    margin: auto;
} 
```

​</p>

# javascript - “this”在 aspect.around 的验证函数中失去其价值的奇怪问题。或者，aspect.around 没有按预期工作

> ID：12015331
> 
> 赞同：0
> 
> 时间：2012-08-18T02:22:37.820
> 
> 标签：javascript, dojo

**注意：请记住，这不是关于`this`在 javascript 上使用的通用问题。这是关于 aspect.around 故障（它是为了设置调用的范围，但它没有）。问题是：为什么 aspect.around 出现故障？这个问题需要您仔细阅读如何使用提供的小提琴进行复制和复制！**

为了解决这个问题，我不得不将我的应用程序撕成碎片。所以这里是：

[http://jsfiddle.net/mercmobily/THtsv/1/](http://jsfiddle.net/mercmobily/THtsv/1/)

这是一个简单的表单，带有验证：

*   在文本框中输入一些内容：将调用小部件的验证方法。
*   然后按下提交按钮：验证将失败，并且将调用 aspect.around 来包装验证方法。
*   此时*，*尝试再次在文本框中输入任何内容：它将返回错误，因为验证器将失败，因为“this”被设置为“window”而不是小部件。

因此，一旦添加了方面，验证器就会*停止*工作。基本上，“this”的价值会丢失。现在：

*   aspect.around() 旨在在正确的范围内（显然）运行新的验证器，但它*没有*这样做

*   我可以通过将验证器的调用更改为此来“解决”这个问题：`return originalValidator.call(this, value);`但是，它没有回答“为什么'这个'丢失？”这个问题。

*   如果你回溯代码，你会看到 aspect.around() 正在做它通常做的事情......但它一定做错*了*什么

那么，问题是：为什么 dojo.around() 出现故障，而不是设置`this`为传递对象的范围？

默克。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T05:29:26.423

遵循您的确切要求并不容易。从您的 jsFiddle 中，我看到了此评论，因此我将尝试回答您在此处提出的问题：

```
 // QUESTION: FIND OUT WHY WE NEED THIS "call"
  return originalValidator(value);
  // return originalValidator.call(this, value); 
```

为什么你需要`.call`here 以保留 的值的答案正如我在下面关于进行函数调用时的工作原理`this`的一般描述中所描述的那样。`this`

当您像以下语句一样进行普通函数调用时：

```
 return originalValidator(value); 
```

的值`this`重新设置为`window`。这就是javascript的工作原理。如果要保留该函数中的当前值，则必须使用or或调用`this`指定要设置的特定值。普通函数调用中的值不绑定到函数。它由调用者设置，可以是调用者想要的任何东西。如果您不指定它，则 javascript 设置为，这正是您的代码中发生的情况。`this``.call()``.apply()``obj.method()``this``this``window`

* * *

这是如何设置值的通用描述，`this`并且此通用描述适用于您的特定情况。

简单的规则是`this`javascript 中的每个函数调用都会重置 的值。如果它只是一个普通的函数调用，则`this`设置为全局对象（`window`在浏览器环境中）。所以任何简单的函数调用都将始终设置`this`为`window`.

如果你做一个方法调用之类的`obj.method()`，那么`this`会被设置为指向`obj`while中的`method()`。

如果您使用`func.apply(a, b)`or ，`func.call(a, b)`那么您可以通过or`this`的第一个参数的值显式控制设置的内容。[请在此处](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call)或[此处](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)查看此 MDN 文档以获取有关和的更多信息。`.apply()``.call()``.call()``.apply()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T02:39:27.427

`this`是当前上下文。默认情况下，它是全局对象（或`null`在严格模式下），当在对象 ( ) 上调用函数时，`foo.bar()`它被设置为该对象。当使用`.call()`或`.apply()`调用函数时，它被设置为传递给该函数的任何第一个参数。

这意味着当你进入另一个函数时，你不能假设它`this`仍然是相同的——即使你在`this`你想要的上下文中定义了那个函数。

最常见的方法是在内部函数中添加`var self = this;`然后使用`self`而不是- 因为它是一个普通变量，它将位于函数的闭包中，并且不受绑定到函数中的其他内容的影响。`this``self``this`

# c - 无法针对 gobject-2.0 进行编译

> ID：12015334
> 
> 赞同：1
> 
> 时间：2012-08-18T02:22:46.307
> 
> 标签：c, glib, gobject

我正在尝试学习 gobject 系统，因此我阅读了 gnome 站点上的一些文档，并制作了一个简单的 gobject，它是 GObject 的父级。我不想每次要编译时都继续运行`gcc`作业，同时我也想学习构建系统。我尝试了 autotools，我开始使用它来`pkg-config`搜索 gobject-2.0。

为了从命令行编译我的项目，我这样做：（ `gcc *.c $(pkg-config --cflags --libs gobject-2.0)`我必须去掉额外的刻度以进行格式化）。无论如何<---这个命令有效。

但是：`gcc $(pkg-config --cflags --libs gobject-2.0) *.c`，应该是相同的命令，返回这个：

```
main.c: In function 'main':
main.c:10:10: warning: initialization from incompatible pointer type [enabled by default]
/tmp/ccxO7wkX.o: In function `main':
main.c:(.text+0x1a): undefined reference to `g_type_init'
main.c:(.text+0x27): undefined reference to `g_type_create_instance'
/tmp/ccPu2beU.o: In function `a_get_type':
myobject.c:(.text+0x57): undefined reference to `g_type_register_static'
collect2: ld returned 1 exit status 
```

是的，这是与另一个订单完全相同的命令。我不知道出了什么问题。以下是 autotools/automake 的构建方式：

```
gcc -I/usr/include/glib-2.0 -I/usr/lib/x86_64-linux-gnu/glib-2.0/include   -g -O2 -lgobject-2.0 -lglib-2.0    -o GObjectTest main.o myobject.o  
main.o: In function `main':
/home/aj/Desktop/GObjectTest/src/main.c:9: undefined reference to `g_type_init'
/home/aj/Desktop/GObjectTest/src/main.c:10: undefined reference to `g_type_create_instance'
myobject.o: In function `a_get_type':
/home/aj/Desktop/GObjectTest/src/myobject.c:19: undefined reference to `g_type_register_static'
collect2: ld returned 1 exit status
make: *** [GObjectTest] Error 1 
```

这是一些古怪的 gcc 编译吗？我用clang试过也无济于事，这让我觉得这是一个链接器问题？我真的不知道，并希望那里有人会。这很令人沮丧。

这是“违规代码”：

```
GType a_get_type (void)
{
  if (type == 0) {
    GTypeInfo info = {
      sizeof(AClass),
      NULL,
      NULL,
      (GClassInitFunc) a_class_init,
      NULL,
      NULL,
      sizeof(A),
      0,
      (GInstanceInitFunc) NULL
    };
    type = g_type_register_static (G_TYPE_OBJECT,
                   "AType",
                   &info, 0);
  }

  return type;
} 
```

编辑：这是我的 autotools 构建的输出，无论如何都是 make 部分：

```
$ make
make  all-recursive
make[1]: Entering directory `/home/aj/Desktop/GObjectTest'
Making all in src
make[2]: Entering directory `/home/aj/Desktop/GObjectTest/src'
gcc -DHAVE_CONFIG_H -I. -I..    -I/usr/include/glib-2.0 -I/usr/lib/x86_64-linux-gnu/glib-2.0/include   -g -O2 -MT main.o -MD -MP -MF .deps/main.Tpo -c -o main.o main.c
main.c: In function 'main':
main.c:10:10: warning: initialization from incompatible pointer type [enabled by default]
mv -f .deps/main.Tpo .deps/main.Po
gcc -DHAVE_CONFIG_H -I. -I..    -I/usr/include/glib-2.0 -I/usr/lib/x86_64-linux-gnu/glib-2.0/include   -g -O2 -MT myobject.o -MD -MP -MF .deps/myobject.Tpo -c -o myobject.o myobject.c
mv -f .deps/myobject.Tpo .deps/myobject.Po
gcc -I/usr/include/glib-2.0 -I/usr/lib/x86_64-linux-gnu/glib-2.0/include   -g -O2 -lgobject-2.0 -lglib-2.0    -o GObjectTest main.o myobject.o  
main.o: In function `main':
/home/aj/Desktop/GObjectTest/src/main.c:9: undefined reference to `g_type_init'
/home/aj/Desktop/GObjectTest/src/main.c:10: undefined reference to `g_type_create_instance'
myobject.o: In function `a_get_type':
/home/aj/Desktop/GObjectTest/src/myobject.c:19: undefined reference to `g_type_register_static'
collect2: ld returned 1 exit status
make[2]: *** [GObjectTest] Error 1
make[2]: Leaving directory `/home/aj/Desktop/GObjectTest/src'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/home/aj/Desktop/GObjectTest'
make: *** [all] Error 2 
```

这是有趣的部分：替换`gcc -I/usr/include/glib-2.0 -I/usr/lib/x86_64-linux-gnu/glib-2.0/include -g -O2 -lgobject-2.0 -lglib-2.0 -o GObjectTest main.o myobject.o`为`gcc -o GObjectTest main.o myobject.o -I/usr/include/glib-2.0 -I/usr/lib/x86_64-linux-gnu/glib-2.0/include -g -O2 -lgobject-2.0 -lglib-2.0`它可以工作。

# jquery - 在 jqGrid 列中加载图像

> ID：12015336
> 
> 赞同：0
> 
> 时间：2012-08-18T02:23:33.683
> 
> 标签：jquery, jquery-plugins, jqgrid

我有一种情况，我将按钮作为 jqGrid 中的列之一。当用户单击按钮时，它会在数据库中进行一些处理。一旦该过程完成，网格将使用数据库中的最新数据进行更新。网格是完全只读的。谁能建议我，如何在进程运行时在单击的按钮完全相同的位置显示 ajax 加载图像？

提前致谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T04:27:52.527

所以，当这个 Loading... 弹出时生成的 html 是

```
<div id="load_list" class="loading ui-state-default ui-state-active">Loading...</div> 
```

其中 id "load_list" 将由前缀 "load_" 和 table 元素的 id 构成。

//检查其他html，如果它生成了，你也可以隐藏它。我猜这个 div 被加载到一个类名=jqgrid-overlay 的框架中，检查 ui.jqgrid.css 中的加载部分，你会知道当加载文本出现时会生成什么，隐藏所有内容。

现在单击按钮，您可以隐藏此 div 并执行类似的操作。

$("buttonId").bind('click', function () { var spinner = $("").insertAfter(this);//有一张ajax加载图片。

```
jQuery.ajax({
    success: function (response) {
        // handle response

        spinner.remove();
    });
    });
}); 
```

# objective-c - 如何使用 AVFoundation 进行双轨编辑？

> ID：12015337
> 
> 赞同：1
> 
> 时间：2012-08-18T02:23:36.170
> 
> 标签：objective-c, ios, avfoundation, avasset

我正在尝试构建一个视频混搭应用程序，我需要用户能够设置一个带有恒定视频轨道的轨道，并有第二个轨道作为 b-roll 轨道，它将从主音轨不时展示一些相关内容。我有第一条轨道，所以时间线上的剪辑使用 AVMutableCompositionInstructions 在合成中排列在一起，但我无法理解如何在独立控制的 b-roll 轨道中工作？这几天我一直在为此苦苦挣扎！这是构建第一条轨道内容的代码，我现在将其设置为在剪辑之间变黑。有任何 AVFoundation 大师可以给我一个提示吗？

```
CMTime nextClipStartTime = kCMTimeZero;
    NSInteger i;
    CMTime transitionDuration = CMTimeMakeWithSeconds(1,30);
    AVMutableCompositionTrack *compositionVideoTrack[2];
    AVMutableCompositionTrack *compositionAudioTrack[2];
    compositionVideoTrack[0] = [composition addMutableTrackWithMediaType:AVMediaTypeVideo preferredTrackID:kCMPersistentTrackID_Invalid];
    compositionAudioTrack[0] = [composition addMutableTrackWithMediaType:AVMediaTypeAudio preferredTrackID:kCMPersistentTrackID_Invalid];
    compositionAudioTrack[1] = [composition addMutableTrackWithMediaType:AVMediaTypeAudio preferredTrackID:kCMPersistentTrackID_Invalid];
    compositionVideoTrack[1] = [composition addMutableTrackWithMediaType:AVMediaTypeVideo preferredTrackID:kCMPersistentTrackID_Invalid];
    AVMutableCompositionTrack *bedMusicTrack = [composition addMutableTrackWithMediaType:AVMediaTypeAudio preferredTrackID:kCMPersistentTrackID_Invalid];
    i = 0;
    NSMutableArray *allAudioParams = [NSMutableArray array];
    AVMutableAudioMixInputParameters *audioInputParams[2];
    audioInputParams[0] = [AVMutableAudioMixInputParameters audioMixInputParameters];
    audioInputParams[1] = [AVMutableAudioMixInputParameters audioMixInputParameters];
    [audioInputParams[0] setTrackID: compositionAudioTrack[0].trackID];
    [audioInputParams[1] setTrackID: compositionAudioTrack[1].trackID];
    float lastVol = 0;
    NSMutableArray *instructions = [NSMutableArray array];
    for(ClipInfo *info in videoLine.items){
        AVAsset *asset = [AVAsset assetWithURL:info.url];
        CMTimeRange timeRangeInAsset = CMTimeRangeMake(info.inTime, info.duration);
        AVAssetTrack *clipVideoTrack = [[asset tracksWithMediaType:AVMediaTypeVideo] objectAtIndex:0];

        [compositionVideoTrack[0] insertTimeRange:timeRangeInAsset ofTrack:clipVideoTrack atTime:nextClipStartTime error:nil];
        AVAssetTrack *clipAudioTrack = [[asset tracksWithMediaType:AVMediaTypeAudio] objectAtIndex:0];
        [compositionAudioTrack[0] insertTimeRange:timeRangeInAsset ofTrack:clipAudioTrack atTime:nextClipStartTime error:nil];
        if(i != 0){
            [audioInputParams[0] setVolume:lastVol atTime: CMTimeSubtract(nextClipStartTime,CMTimeMakeWithSeconds(1,30))];;
        }
        [audioInputParams[0] setVolume:info.volume atTime:nextClipStartTime];
        lastVol = info.volume;

        CMTime clipStartTime = (i == 0) ? nextClipStartTime : CMTimeAdd(nextClipStartTime,transitionDuration);
        CMTime clipDuration = (i == 0 || i == (videoLine.items.count - 1)) ? CMTimeSubtract(timeRangeInAsset.duration, transitionDuration) : CMTimeSubtract(timeRangeInAsset.duration, CMTimeMultiply(transitionDuration, 2));
        if([videoLine.items count] == 1){
            clipDuration = timeRangeInAsset.duration;
        }
        if(i != 0){
            //trans in
            AVMutableVideoCompositionInstruction *inInstruction = [AVMutableVideoCompositionInstruction videoCompositionInstruction];
            inInstruction.timeRange = CMTimeRangeMake(nextClipStartTime, transitionDuration);
            AVMutableVideoCompositionLayerInstruction *fadeIn = [AVMutableVideoCompositionLayerInstruction videoCompositionLayerInstructionWithAssetTrack:compositionVideoTrack[0]];
            [fadeIn setOpacityRampFromStartOpacity:0 toEndOpacity:1 timeRange:CMTimeRangeMake(nextClipStartTime, transitionDuration)];
            inInstruction.layerInstructions = [NSArray arrayWithObject:fadeIn];
            [instructions addObject:inInstruction];
        }

        AVMutableVideoCompositionInstruction *passThroughInstruction = [AVMutableVideoCompositionInstruction videoCompositionInstruction];
        passThroughInstruction.timeRange = CMTimeRangeMake(clipStartTime,clipDuration);
        AVMutableVideoCompositionLayerInstruction *passThroughLayer = [AVMutableVideoCompositionLayerInstruction videoCompositionLayerInstructionWithAssetTrack:compositionVideoTrack[0]];
        passThroughInstruction.layerInstructions = [NSArray arrayWithObject:passThroughLayer];
        [instructions addObject:passThroughInstruction];

        if(i < (videoLine.items.count - 1)){
            //fade out
            AVMutableVideoCompositionInstruction *outInstruction = [AVMutableVideoCompositionInstruction videoCompositionInstruction];
            outInstruction.timeRange = CMTimeRangeMake(CMTimeAdd(clipStartTime,clipDuration), transitionDuration);
            AVMutableVideoCompositionLayerInstruction *fadeOut = [AVMutableVideoCompositionLayerInstruction videoCompositionLayerInstructionWithAssetTrack:compositionVideoTrack[0]];
            [fadeOut setOpacityRampFromStartOpacity:1.0 toEndOpacity:0 timeRange:CMTimeRangeMake(CMTimeAdd(clipStartTime,clipDuration), transitionDuration)];
            outInstruction.layerInstructions = [NSArray arrayWithObject:fadeOut];
            [instructions addObject:outInstruction];
        }
        nextClipStartTime = CMTimeAdd(nextClipStartTime,timeRangeInAsset.duration);
        if(i == ([videoLine.items count] - 1)){
            [audioInputParams[0] setVolume:info.volume atTime:nextClipStartTime];
        }
        i++;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T17:43:30.777

您需要在视频/音频合成轨道“A”和“B”之间来回切换，或者在您的代码 compositionVideoTrack[0] 和 compositionVideoTrack[1] 中来回切换。通过循环的每次迭代都会切换出您正在合成的轨道。

# windows-phone-7 - 在 Bing Map 控件上调用 SetView(LocationRect) 后缩放地图

> ID：12015339
> 
> 赞同：1
> 
> 时间：2012-08-18T02:24:07.207
> 
> 标签：windows-phone-7, bing-maps

我正在开发一个 Windows Phone 7.5 应用程序，我在其中映射了许多标记。

我的代码在 OnNavigatedTo 中运行，类似于以下内容：

```
if (points != null && points.Any())
{
    var markers = new List<GeoCoordinate>();
    foreach (var point in points)
    {
        TextBlock textBlock = new TextBlock();
        textBlock.Text = "...";
        textBlock.TextWrapping = TextWrapping.Wrap;
        stackPanel1.Children.Add(textBlock);

        Pushpin pin = new Pushpin();
        pin.Location = new GeoCoordinate(point.Latitude, point.Longitude);
        markers.Add(pin.Location);
        pin.Content = point.Sequence.ToString();
        mapItems.Items.Add(pin);
    }

    //map1.ZoomLevel = 15; // Tried this as well

    map1.SetView(LocationRect.CreateLocationRect(markers));
    markers.Clear();

    points = null;
} 
```

不幸的是，尽管在实际控件上设置了 15 的初始缩放级别，但 SetView 缩小了超出必要的范围以适应地图中的所有图钉。但是，如果手机关闭，或者我手动将其关闭，然后重新打开，则在恢复地图后将其放大到完美的程度。

在调用 SetView 后，我是否缺少正确刷新地图缩放级别的步骤？

[我已经尝试用这个答案](https://stackoverflow.com/a/10534374/11912)中的代码替换我的 SetView [WP7 Bing Maps Zoom level based on Push Pin collection locations](https://stackoverflow.com/q/10515367/11912)，但它也没有像我预期的那样工作。

控制（Lat 和 Long 设置为实际值，这是将添加到区域标记的中心）：

```
<my:Map Height="311" HorizontalAlignment="Left" Margin="10,10,0,0" Name="map1" VerticalAlignment="Top" Width="440" CredentialsProvider="..." ZoomLevel="15">
    <my:Map.Center>
        <my1:GeoCoordinate Altitude="NaN" Course="NaN" HorizontalAccuracy="NaN" Latitude="0" Longitude="0" Speed="NaN" VerticalAccuracy="NaN" />
    </my:Map.Center>
    <my:MapItemsControl Name="mapItems" />
</my:Map> 
```

谢谢！

# webbrowser-control - 如何清除 WebBrowser 控件的历史记录 c#/.net

> ID：12015340
> 
> 赞同：0
> 
> 时间：2012-08-18T02:24:06.693
> 
> 标签：webbrowser-control, browser-history, clear-cache

如何在 c# Windows 窗体中清除 WebBrowser 控件历史记录

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T02:40:20.613

这个项目将展示如何清除历史浏览器 [http://www.codeproject.com/Articles/7500/The-Tiny-Wrapper-Class-for-URL-History-Interface-i](http://www.codeproject.com/Articles/7500/The-Tiny-Wrapper-Class-for-URL-History-Interface-i)

# mysql - 如何在 MySQL 中存储单位数量和类型？

> ID：12015342
> 
> 赞同：1
> 
> 时间：2012-08-18T02:25:03.063
> 
> 标签：mysql, sql

我不确定如何表达这个问题。因此，如果这已经得到解答，请指出我正确的方向。

基本上我想存储单位类型，以便稍后根据用户选择进行一些比较。例如，用户可以选择“日”、“周”、“月”、“年”作为单位类型。然后他们需要选择一个与该单位类型相关的数字。拥有这个数字和单位类型将允许我的程序根据用户选择进行一些计算。

另一个例子是选择其他单位类型，如公制和英制，即毫米、厘米、米、公里或英寸、英尺、英里等......

我是否只是将它们存储为 varchar，然后在我的程序中进行字符串比较？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T02:28:13.630

Varchar 始终是最后的选择。尝试为它创建一个编号系统，就像使用 ids 一样。因此，您可以有另一个关系表，其中包含与编号系统匹配的文本值，如“日”、“月”等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T02:34:20.633

我认为您需要以一致的格式（例如 mm）存储测量值，然后当用户选择单位类型时，您将有一个从单位类型到您存储的类型的转换表（即英寸到毫米) 这是 sql 查询可以执行所需的数学运算。

或者，如果您想要更复杂一点，您可以使用 2 列来存储数据 - 单位类型和值 - 然后您可以使用转换表进行转换。

# path - msys 路径转换（或 msys 的 cygpath？）

> ID：12015348
> 
> 赞同：41
> 
> 时间：2012-08-18T02:25:41.107
> 
> 标签：path, portability, mingw32, msys, cygpath

我需要将 /DEF:c:\filepath\myLib.def" 命令行选项从 bash 脚本传递给 MS 编译器/链接器。路径是由 bash 脚本作为构建过程的一部分生成的。基本上，我的脚本的参数通行证是：

```
-DEF:/c/filepath/myLib.def 
```

[MSYS 路径转换](http://www.mingw.org/wiki/Posix_path_conversion)无法正确处理它，因为它不理解`/DEF:`部分。如果我这样做，它会起作用

```
-DEF=/c/filepath/myLib.def 
```

但是后来ms工具不理解这个参数。简而言之，在 MSYS bash 中编写该参数以便将其转换为正确参数的正确方法是什么？

在 cygwin 上我可以使用 cygpath，但没有等效的，因为来自 msys 的人认为不需要它（即使有使用 cygpath 的 cygwin 脚本）。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-08-21T21:57:23.423

**更新（2016 年 8 月）：**

这个问题不再相关，因为[msys2](https://msys2.github.io/)`cygpath`现在在其安装中附带。

...

我将在这里总结我的研究。

MSYS 中的**cygpath**等效项是使用以下命令：

```
{ cd /c/some/path && pwd -W; } | sed 's|/|\\|g' 
```

这种方法的问题在于它需要现有路径，例如`c:\some\path`必须是现有目录；然而，真正的**cygpath**支持不存在的路径。

因此，如果您需要获取不存在的目录的路径，则可以回退到路径的 sed 转换：

```
{ cd 2>/dev/null /c/some/path && pwd -W ||
  echo /c/some/path | sed 's|^/\([a-z,A-Z]\)/|\1:/|'; } | sed 's|/|\\|g' 
```

满口的斜线是为了满足`sed`. 因此，如果`c:\some\path`您的 PC 上不存在，它将尝试将正斜杠转换为反斜杠并替换`/c/`为`c:\`（或任何其他驱动器号）。唯一的缺点是它不能正常工作包含已安装组件的不存在路径，例如`/bin/does-not-exist`or `/usr/bin/does-not-exist`。

另一种方法是在 MSYS 中使用来自 cygwin 的**cygpath 。**似乎cygwin设置了全局环境变量CYGPATH，也就是说，你可以从常规的cmd.exe中使用它：

```
%CYGPATH% -w /c/some/path
C:\some\path 
```

或来自 MSYS：

```
$CYGPATH -w /c/some/path
C:\some\path 
```

只要你在cygwin中设置指向`/c`即可。`/cygdrive/c`但是这种方法会将您打印`/usr`在 cygwin 安装中，而不是在 MSYS 中。

简而言之，我认为 msys 真的应该在默认工具集中包含真正的 cygpath，仅适用于 msys 命令行参数转换逻辑无法自动处理的某些情况

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-08-28T12:36:08.820

利用`pwd -W`

或从这里下载 msys 的 cygpath [http://mingw.5.n7.nabble.com/enhanced-version-of-cygpath-td28556.html](http://mingw.5.n7.nabble.com/enhanced-version-of-cygpath-td28556.html)

并使用`cygpath -wa`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-10-01T04:36:26.570

与上面的 dmitri-rubinstein@ 类似，我稍微清理了代码并添加了反向转换。

```
winpath() {
    if [ ${#} -eq 0 ]; then
        : skip
    elif [ -f "$1" ]; then
        local dirname=$(dirname "$1")
        local basename=$(basename "$1")
        echo "$(cd "$dirname" && pwd -W)/$basename" \
        | sed \
          -e 's|/|\\|g';
    elif [ -d "$1" ]; then
        echo "$(cd "$1" && pwd -W)" \
        | sed \
          -e 's|/|\\|g';
    else
        echo "$1" \
        | sed \
          -e 's|^/\(.\)/|\1:\\|g' \
          -e 's|/|\\|g'
    fi
}

unixpath() {
    echo "$1" \
    | sed -r \
      -e 's/\\/\//g' \
      -e 's/^([^:]+):/\/\1/'
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-03-15T14:10:54.330

我将它与 msysgit 一起使用：

```
winpath() {
    if [ -z "$1" ]; then
        echo "$@"
    else
        if [ -f "$1" ]; then
            local dir=$(dirname "$1")
            local fn=$(basename "$1")
            echo "$(cd "$dir"; echo "$(pwd -W)/$fn")" | sed 's|/|\\|g';
        else
            if [ -d "$1" ]; then
                echo "$(cd "$1"; pwd -W)" | sed 's|/|\\|g';
            else
                echo "$1" | sed 's|^/\(.\)/|\1:\\|g; s|/|\\|g';
            fi
        fi
    fi
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-07-13T19:28:59.823

## MSYS`cygpath`

### 程序

该程序将 DOS 路径转换为 ​​UNIX 路径，反之亦然

```
#!/bin/env perl
# DOS to UNIX path conversion
# © John S. Peterson. License GNU GPL 3.
use strict;
use Getopt::Std;

# usage
if ($#ARGV == -1) {
    print 'Usage: cygpath (-w) NAME...

Convert Unix and Windows format paths

Output type options:

  -w, --windows         print Windows form of NAMEs (C:\WINNT)
';
    exit 0;
}

# option
my %opt;
getopts('w', \%opt);

# convert path
my @r;
foreach my $e (@ARGV) {
    if ($opt{w}) {
        # add drive letter suffix
        $e =~ s,^\/([A-Za-z])\/,\1:\/,;
        $e =~ s,\/,\\,g;

    } else {
        $e =~ s,\\,\/,g;
        # add leading slash
        $e = "/$e";
        # remove drive letter suffix
        $e =~ s,:,,;
    }

    push @r, $e;
}

print join("\n", @r); 
```

### 与 Cygwin 相比`cygpath`

该程序的输出优于`cygpath`MSYS 中 Cygwin 的输出，因为

*   Cygwin`cygpath`从转换后的路径中删除 Cygwin 主页，fe

```
cygpath "$CYGWIN/usr/local/bin"
/usr/local/bin 
```

这是一个问题，因为

*   为了将文件从 Cygwin 复制到 MSYS，有时将 DOS Cygwin 路径转换为 ​​UNIX 路径很有用

该程序不会删除 Cygwin 主页

```
cygpath "$CYGWIN/usr/local/bin"
/c/file/program/cygwin/usr/local/bin 
```

### 与自动 MSYS 路径转换相比

手动路径转换在 MSYS 中很有用，因为

*   自动路径转换不足

为铁

*   [开发套件专业版`make`](https://github.com/mirror/dolphin-emu/pull/31)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-08-21T19:22:09.520

我的 bash foo 很弱，我无法让正则表达式在 bash 3.1 中工作，所以我为它破解了一个 perl 脚本：

```
#!/bin/env perl
use strict;

my @r;
foreach my $e (@ARGV) {
 $e=~s/\//\\/g;
 $e=~s/^\\([A-Za-z])\\/\1:\\/;
 push @r, $e;
}

print join(" ", @r); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-11-19T13:49:09.310

这个怎么样 ？ `cmd //c echo <your path>`

它可能并不总是有效，但它是我发现的最短的

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-30T08:11:23.173

这对我有用

```
df "$1" | tac >k
read b <k
rm k
set "$1" $b
echo ${1/$7/$2/} 
```

[**参考**](http://github.com/svnpenn/a/blob/master/wrapper/notepad2)

# jquery - 不听我的if语句？

> ID：12015351
> 
> 赞同：2
> 
> 时间：2012-08-18T02:26:36.153
> 
> 标签：jquery

[http://jsfiddle.net/C9bQZ/4/](http://jsfiddle.net/C9bQZ/4/)

正如您在 JSFiddle 的代码中看到的那样，由于某种原因它没有在听我的 if 语句？

如果值长度大于零，则应该将该值附加为列表项。

另外，我将如何使这些更改成为现实？我是否会将它们发送到 JSON 格式的文件或其他文件中，然后每次我希望显示我的实际页面时调用它？可能我必须为此制作一个带有主干的整个应用程序，对吧？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T02:29:21.643

尝试

```
 if(myListItem.length > 0){ 
```

代替

```
 if($(myListItem).length > 0){ 
```

因为 myListItem 是一个字符串，而不是一个 DOM 元素。

为了使更改持续存在，您需要使用 $.post 或类似的方式将列表值发送到您的应用程序。然后，您将通过适当的方式保存它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T02:30:35.810

改变这个：

```
if($(myListItem).length > 0){ 
```

至：

```
if (myListItem.length > 0) { 
```

您正在尝试从字符串创建一个 jQuery 对象。

[http://jsfiddle.net/C9bQZ/6/](http://jsfiddle.net/C9bQZ/6/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-18T02:31:16.883

问题解决[了 http://jsfiddle.net/C9bQZ/9/](http://jsfiddle.net/C9bQZ/9/)

```
if(myListItem.length > 0){ 
```

代替

```
if($(myListItem).length > 0){ 
```

它是一个字符串而不是 jQuery 对象。

**编辑**

添加列表项时删除文本“列表中没有列表”。

# python - 在 Python 中禁用 SSL 证书验证

> ID：12015354
> 
> 赞同：6
> 
> 时间：2012-08-18T02:28:02.537
> 
> 标签：python, ssl

我正在编写一个脚本，通过 HTTPS 连接到一堆 URL，下载他们的 SSL 证书并提取 CN。一切正常，除非我偶然发现一个带有无效 SSL 证书的网站。我绝对不在乎证书是否有效。我只想要 CN，但如果证书未经过验证，Python 会顽固地拒绝提取证书信息。有什么办法可以解决这种极其愚蠢的行为吗？哦，我只使用内置的套接字和 ssl 库。我不想使用像 M2Crypto 或 pyOpenSSL 这样的第三方库，因为我试图让脚本尽可能地便携。

以下是相关代码：

```
 file = open("list.txt", "r")
    for x in file:
    server = socket.getaddrinfo(x.rstrip(), "443")[0][4][0]
    sslsocket = socket.socket()
    sslsocket.connect((server, 443))
    sslsocket = ssl.wrap_socket(sslsocket, cert_reqs=ssl.CERT_REQUIRED, ca_certs="cacerts.txt")
    certificate = sslsocket.getpeercert()` 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-18T03:19:36.087

ssl.get_server_certificate 可以做到这一点：

```
import ssl
ssl.get_server_certificate(("www.sefaz.ce.gov.br",443)) 
```

我认为函数文档字符串比 python 文档站点更清晰：

```
"""Retrieve the certificate from the server at the specified address,
   and return it as a PEM-encoded string.
   If 'ca_certs' is specified, validate the server cert against it.
   If 'ssl_version' is specified, use it in the connection attempt.""" 
```

因此，您可以从二进制 DER 证书中提取通用名称，搜索通用名称对象标识符：

```
def get_commonname(host,port=443):
    oid='\x06\x03U\x04\x03' # Object Identifier 2.5.4.3 (COMMON NAME)
    pem=ssl.get_server_certificate((host,port))
    der=ssl.PEM_cert_to_DER_cert(pem)
    i=der.find(oid) # find first common name (certificate authority)
    if i!=-1:
        i=der.find(oid,i+1) # skip and find second common name
        if i!=-1:
            begin=i+len(oid)+2
            end=begin+ord(der[begin-1])
            return der[begin:end]
    return None 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T21:17:31.367

好的。我清理了 Olivecoder 的代码以解决它假设证书链中始终存在三个 CN（根、中间、服务器）的问题，我对其进行了压缩。这是我将使用的最终代码。

```
cert = ssl.get_server_certificate(("www.google.com", 443)) #Retrieve SSL server certificate
cert = ssl.PEM_cert_to_DER_cert(cert) #Convert certificate to DER format
begin = cert.rfind('\x06\x03\x55\x04\x03') + 7 #Find the last occurence of this byte string indicating the CN, add 7 bytes to startpoint to account for length of byte string and padding
end = begin + ord(cert[begin - 1]) #Set endpoint to startpoint + the length of the CN
print cert[begin:end] #Retrieve the CN from the DER encoded certificate 
```

# node.js - Nodejs express 翡翠链接无法正确呈现

> ID：12015363
> 
> 赞同：0
> 
> 时间：2012-08-18T02:29:50.303
> 
> 标签：node.js, express, pug

我有以下包含在块中的玉文件：

```
.list_fl(style='position:fixed; z-index:100; width:200px;')
.ul.line_h30t
    .li
        .menu
            a(href='systemSummary')
                span(style='font-size:20px;') System summary
.ul.line_h20t
    .li
        .menu
            span(style='font-size:20px;') Game lobbies
            a(href='gamesInProgress/0')
                span(style='margin-left:5px;') - Games in progress
            a(href='scheduledGames/0')
                span(style='margin-left:5px;') - Scheduled games
            a(href='completedGamesLog/0')
                span(style='margin-left:5px;') - Completed games log
.ul.line_h20t
    .li
        .menu
            span(style='font-size:20px;') Mall status
            a(href='mallsAwaitingConfirmation/0')
                span(style='margin-left:5px;') - Malls awaiting confirmation
            a(href='mallList/0')
                span(style='margin-left:5px;') - Mall list
            a(href='blackListMalls/0')
                span(style='margin-left:5px;') - Black list malls
.ul.line_h20t
    .li
        .menu
            span(style='font-size:20px;') Users status
            a(href='userList/0')
                span(style='margin-left:5px;') - User List
            a(href='monitoredUsers/0')
                span(style='margin-left:5px;') - Monitored Users
            a(href='userBlackList/0')
                span(style='margin-left:5px;') - Black List
.ul.line_h20t
    .li
        .menu
            span(style='font-size:20px;') Commercial
            a(href='eventRegistration')
                span(style='margin-left:5px;') - Event registration
.ul.line_h20t
    .li
        .menu
            span(style='font-size:20px;') Setting
            a(href='gamesSchedule')
                span(style='margin-left:5px;') - Games schedule
            a(href='gamesLimit')
                span(style='margin-left:5px;') - Games limit 
```

然后将其作为一个块添加到主“布局”玉文件中（我在这里使用布局是因为没有更好的术语，我知道玉在这方面最近的变化）。这是“布局”文件：

```
doctype 5 
```

html 头标题=标题链接（rel='stylesheet'，href='/stylesheets/style.css'）链接（rel='stylesheet'，href='/stylesheets/sliding-flexible-menu.css'）链接（rel ='stylesheet', href='/stylesheets/pictogram-button.css') 链接(rel='stylesheet', href='/stylesheets/zebra_datepicker.css') 链接(rel='stylesheet', href='/stylesheets /ccSchedule.css')

```
 script(type='text/javascript', src='/javascripts/jquery-1.7.2.js')
    script(type='text/javascript', src='/javascripts/jquery.sliding-flexible-menu.js')
    script(type='text/javascript', src='/javascripts/ccAdmin.js')
    script(type='text/javascript', src='/javascripts/ccSchedule.js')
    script(type='text/javascript', src='/javascripts/navMenu.js')
    script(type='text/javascript', src='/javascripts/zebra_datepicker.js')
    script(type='text/javascript', src='/javascripts/divPopup.js')
    script(type='text/javascript', src='/javascripts/highcharts.js')
    script(type='text/javascript', src='/javascripts/modules/exporting.js')

body
    header(style='padding-bottom:50px;')
        include partials/header
    #container
        nav
            include partials/navMenu
        section#contents
            block content
    footer.footer
        include partials/footer
    script
        var currentPage = !{JSON.stringify(pageName)};
        var data = !{JSON.stringify(data)};
        $(document).ready(function(){
            $.navMenu.Init();
            $.ccAdmin.Init();
        }); 
```

我遇到的问题是，当呈现一页时，链接会正确显示，例如：

[http://www.mysite.com/gamesInProgress/0](http://www.mysite.com/gamesInProgress/0)

但是，如果我点击此链接，则链接将显示为：

[http://www.mysite.com/gamesInProgress/gamesInProgess/0](http://www.mysite.com/gamesInProgress/gamesInProgess/0)

如果有人能对此有所了解，我将不胜感激。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T02:35:00.503

您需要使用绝对路径而不是相对路径，如何更改为

```
a(href='/gamesInProgress/0') 
```

# c++ - 如何以编程方式在 C/C++ 中创建二进制 Apple Double 文件？

> ID：12015367
> 
> 赞同：1
> 
> 时间：2012-08-18T02:30:29.913
> 
> 标签：c++, c, osx-snow-leopard, file-format

如何在 C/C++ 中以编程方式创建/编写二进制[苹果双文件？](http://www.nulib.com/library/FTN.e000023.htm)

理想情况下，如果有示例代码可以将您想要输入的内容输入到双文件中，然后对文件进行编码并为您写出来，那就太好了。

如果任何了解创建/修改苹果双文件的人能回复我的帖子，我将不胜感激。

# ruby - 在 Rails 中，如何在模型和与它有 belongs_to 关系的其他模型上混合模块？

> ID：12015369
> 
> 赞同：0
> 
> 时间：2012-08-18T02:31:06.310
> 
> 标签：ruby, ruby-on-rails-3.2

我有以下模块：

```
module PriceItem
  def price_item(mdl, code, opts = {})
     gs_collector.do_something()
  end
end 
```

这混入了我的 Rails 3.2 应用程序中的一些具有`belongs_to :gs_collector`关系的模型中。它工作正常。

我还想将此模块混合到 GsCollector 模型中。但这就是我遇到麻烦的地方，因为如果我在上面的示例中更改`gs_collector`为`self`，它将不再适用于我混合的其他模型。

我怎样才能在两者中使用它`GsCollector`，以及具有 的模型`belongs_to :gs_collector`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T03:08:40.237

不确定这是最好的，但应该考虑

```
module PriceItem
  def price_item(mdl, code, opts = {})
     if (gs_collector)
        gs_collector.do_something()
     else
        self.do_something()
     end
  end
end 
```

# iphone - CALayer 不工作

> ID：12015375
> 
> 赞同：0
> 
> 时间：2012-08-18T02:31:55.220
> 
> 标签：iphone, ios, colors, calayer, rounded-corners

我在这行代码中不断收到错误：

```
[round setCornerRadius:10.0f]; 
```

这是我正在做的事情。

```
CALayer *round = [_logInBtn layer];
[round setMasksToBounds:YES];
[round setCornerRadius:10.0f];// here is where the error is at
[round setBorderWidth:1.0];
[round setBorderColor:[[UIColor grayColor] CGColor]]; 
```

`_loginBtn`只是一个`UIButton`；

它是这样说的：`EXC_BAD_ACCESS(code=2, address=0x4a59)`

这是在日志中：`<Error>: CGGradientCreateWithColors: invalid color space.`

奇怪的是，它只会在我尝试构建时给我这个错误。我能做些什么来修复这个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T18:53:52.347

尝试这个：

```
CALayer *imageBaseMaskLayer = [CALayer layer];
imageBaseMaskLayer  setMaskimageBasedMaskLayer]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T14:54:10.983

该层需要 RGB 空间而不是 BW 空间中的颜色。所以使用不同的技术：

```
[UIColor colorWithRed:0.5 green:0.5 blue:0.5] CGColor] 
```

也就是说，创建具有相似值的 RGB 颜色以近似灰色。

# ruby-on-rails - Rails / Heroku 中的生产环境如何工作？

> ID：12015381
> 
> 赞同：1
> 
> 时间：2012-08-18T02:32:47.180
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, heroku, rubygems

我正在尝试通过为自己创建一个博客并将其部署在 Heroku 上来学习 Rails，但我在自定义 gem 上遇到了 NoMethodError。一切都在开发中本地工作，但在移动到生产时我一直遇到错误。

```
Processing by HomeController#index as HTML
2012-08-18T02:17:11+00:00 app[web.1]:   Rendered home/index.html.erb within layouts/application (4.1ms)
2012-08-18T02:17:11+00:00 app[web.1]: Completed 500 Internal Server Error in 19ms
2012-08-18T02:17:11+00:00 app[web.1]: 
2012-08-18T02:17:11+00:00 app[web.1]: ActionView::Template::Error (undefined method `bbcode_to_html' for #<String:0x000000032ee278>):
2012-08-18T02:17:11+00:00 app[web.1]:     3:    <p class="article_body"><%= raw Post.last.body.bbcode_to_html %></p>
2012-08-18T02:17:11+00:00 app[web.1]:     1: <div id="homepage_headline">
2012-08-18T02:17:11+00:00 app[web.1]:     4: </div>
2012-08-18T02:17:11+00:00 app[web.1]: 
2012-08-18T02:17:11+00:00 app[web.1]:     2:    <h1 class="article_title_headlines"><%= link_to "#{Post.last.title}", post_path(Post.last) %></h1>
2012-08-18T02:17:11+00:00 app[web.1]: 
2012-08-18T02:17:11+00:00 app[web.1]:   app/views/home/index.html.erb:3:in `_app_views_home_index_html_erb__3063155323426577095_38919220' 
```

我在我的 Gemfile 中包含了 bb-ruby，如下所示：

```
group :production do
    gem 'thin'
    gem 'pg'
    gem 'bb-ruby', '0.9.6', :path => 'vendor/bb-ruby'
end
...
gem 'bb-ruby', '0.9.6', :path => 'vendor/bb-ruby' 
```

我试过在视图中要求 bb-ruby，但是 Heroku 给了我一个找不到文件的错误。

我想我的主要问题是：Heroku 上的生产和我的机器上的开发有什么区别？除了我从 evironments 的配置文件中可以看出的内容之外。到目前为止，我所知道的是 Heroku 需要预编译 javascript 和 css 等资产。但是宝石呢？我还没有找到关于如何在 Heroku 中使用自定义 gem 的很好的解释。我很感激任何帮助。

更新：通过使用 bb-ruby 0.9.5 版，我已经能够让应用程序正常工作。0.9.6 版是我自己创建的版本（正在开发中），但在 Heroku 中引起了问题，我认为是因为我自己打包并指定了路径。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T02:44:00.383

不要指定路径，Heroku 会覆盖它，默认值很好，除非你知道得更好。您还需要没有特定组的 pg 和 bb-ruby，因为您到处都需要它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T14:39:02.043

为了使用您自己的自定义版本，请在 github 中 fork gem，进行自己的更改，然后使用 gemfile 中的 :git 选项指向它。

# php - 数据库连接中的 OOP php 错误

> ID：12015388
> 
> 赞同：1
> 
> 时间：2012-08-18T02:35:03.057
> 
> 标签：php, mysql, database, oop

我是 OOP 的新手，所以我正在学习教程。所以它使用以下代码连接到数据库，但在我的情况下它没有连接

数据库文件

```
<?php
require_once("config.php");

class MySQLDatabase {

    private $connection;

  function __construct() {
    $this->open_connection();
  }

    public function open_connection() {
        $this->connection = mysql_connect(DB_SERVER, DB_USER, DB_PASS);
        if (!$this->connection) {
            die("Database connection failed: " . mysql_error());
        } else {
            $db_select = mysql_select_db(DB_NAME, $this->connection);
            if (!$db_select) {
                die("Database selection failed: " . mysql_error());
            }
        }
    }

    public function close_connection() {
        if(isset($this->connection)) {
            mysql_close($this->connection);
            unset($this->connection);
        }
    }

    public function query($sql) {
        $result = mysql_query($sql, $this->connection);
        $this->confirm_query($result);
        return $result;
    }

    public function mysql_prep( $value ) {
        $magic_quotes_active = get_magic_quotes_gpc();
        $new_enough_php = function_exists( "mysql_real_escape_string" ); // i.e. PHP >= v4.3.0
        if( $new_enough_php ) { // PHP v4.3.0 or higher
            // undo any magic quote effects so mysql_real_escape_string can do the work
            if( $magic_quotes_active ) { $value = stripslashes( $value ); }
            $value = mysql_real_escape_string( $value );
        } else { // before PHP v4.3.0
            // if magic quotes aren't already on then add slashes manually
            if( !$magic_quotes_active ) { $value = addslashes( $value ); }
            // if magic quotes are active, then the slashes already exist
        }
        return $value;
    }

    private function confirm_query($result) {
        if (!$result) {
            die("Database query failed: " . mysql_error());
        }
    }

}

$database =& new MySQLDatabase();
$db =& $database;

?> 
```

配置文件

```
<?php

// Database Constants                             
defined('DB_SERVER') ? null : define("DB_SERVER", "localhost");
defined('DB_USER')   ? null : define("DB_USER", "oop_project");
defined('DB_PASS')   ? null : define("DB_PASS", "");
defined('DB_NAME')   ? null : define("DB_NAME", "oop_project");

?> 
```

函数.php

```
<?php

function strip_zeros_from_date( $marked_string="" ) {
  // first remove the marked zeros
  $no_zeros = str_replace('*0', '', $marked_string);
  // then remove any remaining marks
  $cleaned_string = str_replace('*', '', $no_zeros);
  return $cleaned_string;
}

function redirect_to( $location = NULL ) {
  if ($location != NULL) {
    header("Location: {$location}");
    exit;
  }
}

function output_message($message="") {
  if (!empty($message)) { 
    return "<p class=\"message\">{$message}</p>";
  } else {
    return "";
  }
}

?> 
```

当我要测试连接时，我得到了这些错误。

```
Deprecated: Assigning the return value of new by reference is deprecated in J:\xampp\htdocs\oop_project\includes\database.php on line 60

Deprecated: Assigning the return value of new by reference is deprecated in J:\xampp\php\PEAR\Config.php on line 80

Deprecated: Assigning the return value of new by reference is deprecated in J:\xampp\php\PEAR\Config.php on line 166

Notice: Use of undefined constant DB_SERVER - assumed 'DB_SERVER' in J:\xampp\htdocs\oop_project\includes\database.php on line 13

Notice: Use of undefined constant DB_USER - assumed 'DB_USER' in J:\xampp\htdocs\oop_project\includes\database.php on line 13

Notice: Use of undefined constant DB_PASS - assumed 'DB_PASS' in J:\xampp\htdocs\oop_project\includes\database.php on line 13

Warning: mysql_connect() [function.mysql-connect]: php_network_getaddresses: getaddrinfo failed: No such host is known. in J:\xampp\htdocs\oop_project\includes\database.php on line 13

Warning: mysql_connect() [function.mysql-connect]: [2002] php_network_getaddresses: getaddrinfo failed: No such host is known. (trying to connect via tcp://DB_SERVER:3306) in J:\xampp\htdocs\oop_project\includes\database.php on line 13

Warning: mysql_connect() [function.mysql-connect]: php_network_getaddresses: getaddrinfo failed: No such host is known. in J:\xampp\htdocs\oop_project\includes\database.php on line 13
Database connection failed: php_network_getaddresses: getaddrinfo failed: No such host is known. 
```

我该如何纠正这个...？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T02:44:05.297

“弃用”警告是因为您正在使用

```
$database =& new MySQLDatabase(); 
```

用。。。来代替

```
$database = new MySQLDatabase(); 
```

这些通知是因为在您尝试实例化类（新的 MySQLDatabase）之前似乎没有定义常量（DB_SERVER，...）。确保 config.php 之前已加载。其他警告与这些相同的问题有关。config.php 的包含实际上包括 J:\xampp\php\PEAR\Config.php 而不是您的本地配置文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T02:44:10.393

您的 DB_SERVER、DB_USER、DB_PASS 变量似乎有问题，或者您的服务器有问题？您绝对应该花时间尝试没有不推荐使用的 oop 类的示例。

但是，首先尝试更改您的 $database =& new MySQLDatabase(); 到更干净的 $database = new MySQLDatabase();

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-18T03:32:19.060

如果您想转移到 PDO，那么这里有一个我认为您试图实现的快速示例。一个[CreateReadUpdateDelete](http://en.wikipedia.org/wiki/Create,_read,_update_and_delete) (CRUD) 类。

```
<?php 
class MySQLDatabase{
    public $db;
    function __construct($dsn, $user=null, $pass=null){
        $this->dsn = $dsn;
        $this->user = $user;
        $this->pass = $pass;
        //Connect
        $this->connect();
    }

    function connect(){
        try{
            $this->db = new PDO($this->dsn, $this->user, $this->pass);
            $this->db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
            $this->db->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
            $this->db->setAttribute(PDO::ATTR_DEFAULT_FETCH_MODE,PDO::FETCH_ASSOC);
        }catch (Exception $e){
            die('Cannot connect to databse. Details:'.$e->getMessage());
        }
    }

    function Select($table, $fieldname=null, $fieldvalue=null){
        $sql = "SELECT * FROM $table"; 
        $sql .=($fieldname != null && $fieldvalue != null)?" WHERE $fieldname=:id":null;
        $statement = $this->db->prepare($sql);
        if($fieldname != null && $fieldvalue != null){$statement->bindParam(':id', $fieldvalue);}
        $statement->execute();
        return $statement->fetchAll(PDO::FETCH_ASSOC);
    }

    function Insert($table, $values){
        $fieldnames = array_keys($values[0]);

        $sql = "INSERT INTO $table";
        $fields = '( ' . implode(' ,', $fieldnames) . ' )';
        $bound = '(:' . implode(', :', $fieldnames) . ' )';
        $sql .= $fields.' VALUES '.$bound;

        $statement = $this->db->prepare($sql);
        foreach($values as $vals){
            $statement->execute($vals);
        }
    }

    function Update($table, $fieldname, $value, $where_key, $id){
        $sql = "UPDATE `$table` SET `$fieldname`= :value WHERE `$where_key` = :id";
        $statement = $this->db->prepare($sql);
        $statement->bindParam(':id', $id);
        $statement->bindParam(':value', $value);
        $statement->execute();
    }

    function Delete($table, $fieldname=null, $id=null){
        $sql = "DELETE FROM `$table`";
        $sql .=($fieldname != null && $id != null)?" WHERE $fieldname=:id":null;
        $statement = $this->db->prepare($sql);
        if($fieldname != null && $id != null){$statement->bindParam(':id', $id);}
        $statement->execute();
    }

}

//Sample Usage
$db = new MySQLDatabase('mysql:host=localhost;dbname=test','root','password');

//Multi insert:
$insert = array(array('some_col'=>'This was inserted by the $db->Insert() method'),
                array('some_col'=>'Test insert 2'),
                array('some_col'=>'Test insert 3'),
                );
$db->Insert('pdo_test', $insert);

//Select All
$result = $db->Select('pdo_test');
/*
Array
(
    [0] => Array
        (
            [id] => 2
            [some_col] => This was inserted by the $db->Insert() method
        )

    [1] => Array
        (
            [id] => 3
            [some_col] => Test insert 2
        )

    [2] => Array
        (
            [id] => 4
            [some_col] => Test insert 3
        )
)
*/

//Single select
$result = $db->Select('pdo_test','id','2');
/*
Array
(
    [0] => Array
        (
            [id] => 2
            [some_col] => This was inserted by the $db->Insert() method
        )

)
*/

/* Delete Single record*/
$db->Delete('pdo_test', 'id', '2');

/*Delete All*/
$db->Delete('pdo_test');

//Array ( ) 
$result = $db->Select('pdo_test');
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-15T04:36:41.287

**最好的解决方案是转到 php.ini allow_url_include = On 并保存**

或者

采用

```
inlcude 'J:\xampp\htdocs\oop_project\includes\database.php';
require_once 'J:\xampp\htdocs\oop_project\includes\database.php'; 
```

根据需要，这将解决

```
php_network_getaddresses: getaddrinfo failed: No such host is known. 
```

# drupal - 无法将作者的图片打印到 Drupal 7 中的节点上

> ID：12015389
> 
> 赞同：0
> 
> 时间：2012-08-18T02:35:21.857
> 
> 标签：drupal, variables, drupal-7, image

阅读文档后，似乎正确的做法是这样的：

```
<?php print $user_picture; ?> 
```

Wich 不起作用（它根本不打印任何东西）。

在四处询问后，我得到了这个答案，遗憾的是这也不起作用：

```
<?php global $user;
$image = theme('user_picture', $user);
print $image;?> 
```

该代码被建议为“最后一个资源”，但当我尝试使用它时，我收到以下错误消息：

> 致命错误：无法在第 1054 行的 /includes/theme.inc 中使用 stdClass 类型的对象作为数组

寻找那条特定的行： if `(isset($variables['#theme']) || isset($variables['#theme_wrappers'])) {`，并且在上下文中：

```
 if (isset($variables['#theme']) || isset($variables['#theme_wrappers'])) {
    $element = $variables;
    $variables = array();
    if (isset($info['variables'])) {
      foreach (array_keys($info['variables']) as $name) {
        if (isset($element["#$name"])) {
          $variables[$name] = $element["#$name"];
        }
      }
    } 
```

很[明显](http://drupal.org/node/254940#user-picture)它应该工作，但它没有。

使用 contemplate 模块，我得到这个输出作为替代：

```
<?php print $node->picture ?> 
```

这也行不通。

我已经尝试过使用 Devel 模块（使用节点的 /devel 选项卡）：

我明白了：

```
picture (String, 4 characters ) 2876
$...->picture 
```

这是行不通的，因为输出只是“2876”，但却是那里唯一的“图片”。

那么我能做什么呢？我该如何追踪这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T06:27:18.463

注意

```
theme('user_picture', $vars); 
```

是一个 tpl.php 文件。您可以 dpm($vars) 对此主题功能的预处理功能，看看您可以使用什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T13:00:49.657

根据Drupal 文档中的[node.tpl.php 主题](http://api.drupal.org/api/drupal/modules!node!node.tpl.php/7)，$user_picture 是 node.tpl.php 文件中的一个有效变量（及其变体，如 node--book.tpl.php）

这段代码是错误的：

```
<?php global $user;
$image = theme('user_picture', $user);
print $image;?> 
```

它是关于显示当前用户的图片，而不是 Drupal 7 AFAIK。如果 $user_picture 仍然不适合您，请尝试 node.tpl.php 中的 dsm($content) 或 dsm($node) 以找到正确的变量。

# html - CSS Z-Index 堆叠上下文拼图

> ID：12015390
> 
> 赞同：1
> 
> 时间：2012-08-18T02:35:31.550
> 
> 标签：html, css, z-index

我有以下标记：http: [//jsfiddle.net/dy4TG/3/](http://jsfiddle.net/dy4TG/3/)

```
<div class="slide-wrap">
    <div class="slide">
        <div class="text">Text here</div>
        <img src="image.jpg" />
    </div>
</div>

<div class="overlay"></div> 
```

`.slide`div 必须绝对定位，并且有`.slide-wrap`position: relative。

div是否`.overlay`可以在图像和`.text`div 之间？我需要堆叠上下文是这样的（从最高到最低）：

-文本

-覆盖

-图片

谢谢！

现场示例：http: [//movable.pagodabox.com](http://movable.pagodabox.com)（检查幻灯片...在此示例的特定上下文中，“覆盖”具有类“动力学js-content”，并且`.slide`div 在`#slides`父 div 内部。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T02:48:58.450

关键是要确保所有东西都是绝对定位的，这样你就可以随心所欲地浮动所有东西，使用任何 z-index。

CSS：

```
.overlay {
    width: 20px;
    height: 20px;
    background: #fff;
    z-index: 50;
    position:absolute;
    top:0;
    left:50px;
}
img{
    z-index: 20;
    position:absolute;
    top:0;
    left: 5px;
    width:100px;
    height: 100px;
    background: #000;
}
.text {
    z-index: 999;
    color: #888;
    position:absolute;
    top:0;
    left: 5px;
}
.slide-wrap{
    position:relative;   
}
.slide{
    position:absolute;
    top:0;
    left:0;
    width:100px;
}​ 
```

jsfiddle 链接：http: [//jsfiddle.net/a7Apz/3](http://jsfiddle.net/a7Apz/3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T03:02:37.443

你**必须**给一个`z-index`to `.text`，如果你想让它在一切之上，它必须是最高的。而且你**不能**给一个`z-index`to `.slide`or `.slide-wrap`，因为这会创建一个新的堆叠上下文，其中嵌套了文本和图像。您需要文本、图像和覆盖在同一个[堆叠上下文中](https://developer.mozilla.org/en-US/docs/CSS/Understanding_z-index/The_stacking_context)。

这是一个 jsfiddle 来[演示](http://jsfiddle.net/g2aV5/)。这是[适用于您的 jsfiddle 的相同想法](http://jsfiddle.net/dy4TG/1/)。

# ftp - 无法复制 .ftpquota

> ID：12015391
> 
> 赞同：0
> 
> 时间：2012-08-18T02:35:37.040
> 
> 标签：ftp, file-access, filezilla

尝试使用 FileZilla 进行备份。复制了所有文件，但`.ftpquota`出现此错误，

```
Command:    RETR .ftpquota
Response:   550 Can't open .ftpquota: Permission denied
Error:  Critical file transfer error 
```

我已经更改了访问权限，`777`但问题仍然存在。有什么解决办法吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T02:40:06.323

除非您拥有自己的公司并且正在备份您的客户服务器之一，否则您不需要在备份中复制 .ftpquota。

编辑：虽然要回答您的问题，但我相信这是因为它在服务器上的程序中打开。可能是 FTP 服务器，尝试关闭服务器上的 FTP 配额（如果可能），看看是否有影响。

# android - 如何在android中获取backstack片段条目列表？

> ID：12015393
> 
> 赞同：52
> 
> 时间：2012-08-18T02:36:22.380
> 
> 标签：android, tabs, android-fragments, back-stack

我正在开发一个应用程序，其中使用`FragmentActivity`. 由于整个应用程序都需要选项卡，因此片段被广泛用于使应用程序在所有版本的 android 上兼容。

因此，我在可视化后台堆栈上存在哪些片段时遇到了问题。我确信有一种**方法可以检索 backstack 上存在的片段列表**。谢谢。

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2012-08-18T04:24:13.453

[FragmentManager](http://developer.android.com/reference/android/app/FragmentManager.html)有方法：

**getBackStackEntryCount()**

**getBackStackEntryAt（整数索引）**

```
FragmentManager fm = getFragmentManager();

for(int entry = 0; entry<fm.getBackStackEntryCount(); entry++){
   Log.i(TAG, "Found fragment: " + fm.getBackStackEntryAt(entry).getId());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-13T10:42:31.970

如果要检查哪个片段是可见的，并且如果您知道放置片段的视图 id，首先您必须在 onCreate() 中添加以下内容

```
 getSupportFragmentManager().addOnBackStackChangedListener(new OnBackStackChangedListener() {

  @Override
  public void onBackStackChanged() {
    Fragment f = getSupportFragmentManager().findFragmentById(R.id.content_frame);
    if (f != null){
      updateActionBarTitle(f);
    }

  }
});

private void updateActionBarTitle(Fragment fragment) {
        String fragClassName = fragment.getClass().getName();

        if (fragClassName.equals(FirstFragment.class.getName())) {
            setTitle("Home");
        } else if (fragClassName.equals(SecondFragment.class.getName())) {
            setTitle("Second");
        }
    } 
```

这将在返回堆栈更改侦听器上更新您的操作栏标题。

# python - python：使用一个类来跟踪另一个类使用的数据

> ID：12015394
> 
> 赞同：3
> 
> 时间：2012-08-18T02:37:10.530
> 
> 标签：python, class

我正在通过书籍和互联网学习 Python。我正在尝试在单独的课程中保持游戏得分。为了测试我的想法，我构建了一个简单的例子。由于某种原因，它看起来太复杂了。有没有更简单/更好/更 Pythonic 的方式来做到这一点？

我的代码如下：

```
import os

class FOO():
    def __init__(self):
        pass

    def account(self, begin, change):
        end = float(begin) + float(change)
        return (change, end)        

class GAME():
    def __init_(self):
        pass

    def play(self, end, game_start):
        os.system("clear")
        self.foo = FOO()

        print "What is the delta?"
        change = raw_input('> ')

        if game_start == 0:
            print "What is the start?"
            begin = raw_input('> ')
        else:
            begin = end

        change, end = self.foo.account(begin, change)
        print "change = %r" % change
        print "end = %r" % end

        print "Hit enter to continue."
        raw_input('> ')

        self.play_again(end, game_start)    

    def play_again(self, end, game_start):

        print "Would you like to play again?"
        a = raw_input('> ')
        if a == 'yes':
            game_start = 1
            self.play(end, game_start)
        else: 
            print "no"
            exit(0)

game = GAME()
game.play(0, 0) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T02:50:30.327

这是我将如何格式化您的代码：

```
import os

class Game(object):
    def play(self, end, game_start=None):
        os.system("clear")

        change = input('What is the delta? ')

        # Shorthand for begin = game_start if game_start else end
        begin = game_start or end
        end = float(begin + change)  

        print "change = {}".format(change)
        print "end = {}".format(end)

        self.play_again(end, game_start)    

    def play_again(self, end, game_start):
        raw_input('Hit enter to continue.')

        if raw_input('Would you like to play again? ').lower() in ['yes', 'y']:
            self.play(end, game_start)
        else:
            exit(0)

if __name__ == '__main__':
    game = Game()
    game.play(0, 0) 
```

还有一些提示：

*   我不会创建一个只包含执行一项特定任务的代码的新类。如果该类不接受参数或不简化您的代码，请不要创建它。但是，您的`Game`类是一个例外，因为您可能会向它添加更多代码。
*   在 Python 中，类是用`CamelCase`. 全局常量通常用`UPPERCASE`.
*   `raw_input()`返回一个字符串。`input()`返回评估为 Python 对象的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:15:27.170

我以更好的方式问了这个问题，并在这里得到了我想要的东西：

[python：如何在不更改参数的情况下调用函数？](https://stackoverflow.com/q/12037908/1472743)

# ios - Xcode 4.4.1 中 non_lazy_ptr 的 iOS SDK 5.1 链接器错误

> ID：12015396
> 
> 赞同：14
> 
> 时间：2012-08-18T02:38:04.873
> 
> 标签：ios, xcode, linker, vlc

（我将这个问题发布到 VideoLAN 论坛，但还没有接受者。我知道 SO 社区不会让我失望。）

我正在尝试为 iOS 构建 MobileVLC 项目。我已经完成了构建项目的命令行过程，并且经过了一些调整，如[http://forum.videolan.org/viewtopic.php?f=12&t=103331](http://forum.videolan.org/viewtopic.php?f=12&t=103331)和[http://forum.videolan 中所述。 org/viewtopic.php?f=12&t=103271](http://forum.videolan.org/viewtopic.php?f=12&t=103271)，构建脚本运行几乎完成。当它试图让 Xcode 构建最终项目时，它会出错。所以我将它加载到 Xcode 中并尝试构建，我可以看到错误，这是我使用 -v 链接器标志时得到的：

```
Ld /Users/bp/Library/Developer/Xcode/DerivedData/MobileVLC-ctcjnpeqzuhulxcmjlhrjnyzpzil/Build/Products/Debug-iphoneos/VLC.app/VLC normal armv7
    cd /Users/bp/Desktop/vlc/MobileVLC
    setenv IPHONEOS_DEPLOYMENT_TARGET 5.1
    setenv PATH "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin:/Applications/Xcode.app/Contents/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang -arch armv7 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk -L/Users/bp/Library/Developer/Xcode/DerivedData/MobileVLC-ctcjnpeqzuhulxcmjlhrjnyzpzil/Build/Products/Debug-iphoneos -L/Users/bp/Desktop/vlc/MobileVLC/External/MobileVLCKit -L/Users/bp/Desktop/vlc/MobileVLC/External/MediaLibraryKit -F/Users/bp/Library/Developer/Xcode/DerivedData/MobileVLC-ctcjnpeqzuhulxcmjlhrjnyzpzil/Build/Products/Debug-iphoneos -filelist /Users/bp/Library/Developer/Xcode/DerivedData/MobileVLC-ctcjnpeqzuhulxcmjlhrjnyzpzil/Build/Intermediates/MobileVLC.build/Debug-iphoneos/MobileVLC.build/Objects-normal/armv7/VLC.LinkFileList -dead_strip -Wl,-no_pie,-v -fobjc-link-runtime -miphoneos-version-min=5.1 -framework Foundation -framework UIKit -framework CoreGraphics -framework OpenGLES -framework AudioToolbox -framework QuartzCore -liconv -lz /Users/bp/Library/Developer/Xcode/DerivedData/MobileVLC-ctcjnpeqzuhulxcmjlhrjnyzpzil/Build/Products/Debug-iphoneos/libMobileMediaLibraryKit.a -lsqlite3 -lstdc++.6 -lbz2 -lxml2 -framework CoreData -framework CoreText -framework MediaPlayer /Users/bp/Library/Developer/Xcode/DerivedData/MobileVLC-ctcjnpeqzuhulxcmjlhrjnyzpzil/Build/Products/Debug-iphoneos/libMobileVLCKit.a -o /Users/bp/Library/Developer/Xcode/DerivedData/MobileVLC-ctcjnpeqzuhulxcmjlhrjnyzpzil/Build/Products/Debug-iphoneos/VLC.app/VLC

@(#)PROGRAM:ld  PROJECT:ld64-133.3
configured to support archs: armv6 armv7 i386 x86_64
Library search paths:
   /Users/bp/Library/Developer/Xcode/DerivedData/MobileVLC-ctcjnpeqzuhulxcmjlhrjnyzpzil/Build/Products/Debug-iphoneos
   /Users/bp/Desktop/vlc/MobileVLC/External/MobileVLCKit
   /Users/bp/Desktop/vlc/MobileVLC/External/MediaLibraryKit
   /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk/usr/lib
Framework search paths:
   /Users/bp/Library/Developer/Xcode/DerivedData/MobileVLC-ctcjnpeqzuhulxcmjlhrjnyzpzil/Build/Products/Debug-iphoneos
   /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk/System/Library/Frameworks/
LLVM version 3.1svn, from Apple Clang 4.0 (build 421.0.60)
ld: 'non_lazy_ptr' in /Users/bp/Library/Developer/Xcode/DerivedData/MobileVLC-ctcjnpeqzuhulxcmjlhrjnyzpzil/Build/Products/Debug-iphoneos/libMobileVLCKit.a(libdeinterlace_plugin_la-deinterlace.o) contains undefined reference for architecture armv7
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

据我所知，libMobileVLCKit.a 文件已链接到 MobileVLC 项目，因此我不确定接下来要查找什么，因为我在任何代码的任何地方都找不到对 non_lazy_ptr 的任何引用，并且框架引用看起来都不错。即使您不知道解决方案，任何关于在哪里寻找问题的想法都将不胜感激。谢谢。

编辑：这是一个屏幕截图，显示了 MobileVLC 项目的 Build Phases 选项卡中的所有内容。

![MobileVLC 构建阶段](../Images/0f5781ca9578fdf57b6b3a7530eda76f.png)

编辑 2：我在 VideoLAN 论坛上的帖子得到了一些“我也是”的回复，以及一个与另一个用户的错误非常相似的错误。这是错误消息的最后一行：

```
ld: '_AmplifyFloat' in /Users/**/MobileVLC/ImportedSources/VLCKit/build/Release-iphoneos/libMobileVLCKit.a(libvolume_neon_plugin_la-volume.o) contains undefined reference for architecture armv7 
```

这是 VideoLAN 论坛上的帖子：http: [//forum.videolan.org/viewtopic.php? f=12&t=103433](http://forum.videolan.org/viewtopic.php?f=12&t=103433)

编辑 3：我从 VideoLAN 的 git 存储库中获取了源代码的新副本，并查看了 user1071136 在下面提供的答案，最终得到了与他们得到的完全相同的错误。

我在 Stack Overflow 上发现了一个类似的错误，表明解决方案是检查以确保构建设置中的`Generate Position-Dependent Code`选项`Apple LLVC compiler 4.0 - Code Generation`设置为否。但是像往常一样尝试在 iOS 上运行 VLC，这也是一个死胡同为此，构建设置已设置为否。

这是该问题和答案的链接：[(null): In section __TEXT,__text reloc 3: section For Address(0x7C6C) address not in any section for architecture armv7](https://stackoverflow.com/questions/11846078/null-in-section-text-text-reloc-3-section-for-address0x7c6c-address-no)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-03T15:08:03.340

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T11:48:11.993

看你需要目标依赖 libMobileVLCKit

# java - 不同的布局取决于复选框

> ID：12015397
> 
> 赞同：1
> 
> 时间：2012-08-18T02:38:30.093
> 
> 标签：java, android, eclipse

有`4 checkboxes`和`button`并且默认所有复选框都是`checked`。单击按钮后，我需要测试是否有任何复选框被取消，如果是，则下一个活动（按钮启动）需要隐藏文本输入框。现在我有它检查像：

```
if (!picCheck.isChecked()) {
    intent.putExtra(PIC_CHECK, 1);
} else {
    intent.putExtra(PIC_CHECK, 2);
} 
```

这基本上会向下一个活动发送一条值为 1 或 2 的消息，

1.  被**淘汰**

    2被**选中**。

然后在下一个活动中，如果该消息 == 1，我将隐藏文本框。

在不相关的注释上，这看起来正确吗？

```
 EditText editText = (EditText) findViewById(R.id.eventNameBox);
    String nameMessage = editText.getText().toString();
    editText = (EditText) findViewById(R.id.eventLocationBox);
    String locMessage = editText.getText().toString();
    editText = (EditText) findViewById(R.id.aboutEvent); 
```

这会将 eventNameBox、eventLocationBox 和 aboutEvent 中的任何内容转换为字符串吗？之后的下一个代码是：

```
 intent.putExtra(NAME_MESSAGE, nameMessage);
    intent.putExtra(LOCATION_MESSAGE, locMessage);
    intent.putExtra(ABOUT_MESSAGE, aboutMessage); 
```

这行得通吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T02:43:11.570

如果您只是想隐藏`TextView`为什么不使用

```
 textView.setVisibility(View.GONE); 
```

这将隐藏`TextView`

# javascript - Jquery post 函数不适用于两种表单和两个 post 请求

> ID：12015402
> 
> 赞同：0
> 
> 时间：2012-08-18T02:39:32.200
> 
> 标签：javascript, jquery, ajax, forms, jquery-post

我试图向我编写的 javascript/jquery 脚本添加第二个表单，但是，当我实现并开始测试它时，当我尝试通过 jquery post 请求发送固定表单时，它会发送一个 get 请求. 我知道这与第二种形式有关，因为为第二种形式注释掉脚本会使站点再次工作。希望一双新鲜的眼睛可以提供帮助！（加载页面功能也可以）

注册功能似乎是问题所在：

```
 //when the user first goes to the page
  $(document).ready(function(){ 
        var user = $("#username");
        var pass = $("#password");
        var submit = $("#submit");

            //both of these methods work, I'm not sure if one is better than the other
    //$("#submitbutton").click(function(event){
    $("#loginform").on('submit', function(event){
    event.preventDefault();
    $('.loginerror').remove();
    $.post("login.php", {username:user.val(), password:pass.val()}, function(data){

        if(!data)
        {
            $("#login").append("<h3 class='loginerror'>Incorrect Username or Password</h3>");

        }

        else
        {
        loadpage();
        }

    }, "json");

});

//if the user clicks the username prompt him with the login div
$("#registerbutton").click(function(event){
    register();
});

});

function register()
{
$("#login").hide("slow");
$("#registerdiv").css("display", "block");

//initiate some variables
var regusername = $("#regusername");
var reg1password = $("#reg1password");
var reg2password = $("#reg2password");
var regemail = $("#regemail");
var regfirstname = $("#regfirstname");
var reglastname = $("#reglastname");

//TODO: check to make sure form is filled out properly
$("#registerform").on('submit', function(event){

    event.preventDefault();
    //send post request
    $.post("register.php", {regusername:regusername.val(), password1:reg1password.val(), password2:reg2password.val(), email:regemail.val(), firstname:regfirstname.val(), lastname:reglastname.val()}, function(data){
        if(!data)
            $("#registerdiv").append("<h3> class='loginerror'>Server error, retry</h3>");
        else
            $("#registerdiv").hide("slow");
            $("#loginiv").slidedown("slow");
    }, "json");

} 
```

这是具有两种形式的 HTML：

```
<body>

<Div id="welcome"> Welcome </div>
<Div id="login">
    <br><br><h2>Welcome to QuotesLib</h2>
    <br><br><br><form id="loginform"> Username:
    <input type = "text" name = "username" id ="username"> <br> Password:
    <input type = "password" name = "password" id = "password"> <br>
    <input type = "submit" name="submitbutton" id="submitbutton" class = "bluebutton"> 
    </form>
    <form><br><br><br>Don't have an account yet?<br><button id="registerbutton" name="registerbutton" href="register.html">Register Now</button>    

</Div>
<Div id="registerdiv">
    <br><br><h2>Sign Up For QuotesLib</h2>
    <br><form id="registerform"> Username:
    <input type ="text" id="regusername"> <br> Password:
    <input type ="password" id="reg1password"> <br> Repeat Password:
    <input type ="password" id="reg2password"> <br> First Name:
    <input type ="text" id="regfirstname"> <br> Last Name:
    <input type ="text" id="reglastname"> <br> email:
    <input type ="text" id="regEmail"> <br>
    <input type ="submit" id ="registersubmitbutton">
    <br> </form>
</Div> 
```

如果有人能给我这个问题的答案，那将是非常有帮助的！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T02:52:03.457

```
$("#registerdiv").append("<h3> class='loginerror'>Server error, retry</h3>"); 
```

应该

```
$("#registerdiv").append("<h3 class='loginerror'>Server error, retry</h3>"); 
```

看到区别： `<h3>...`和`<h3 ...`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T05:06:50.257

代码有一些错误，

**第一的，**

```
<form><br><br><br>Don't have an account yet?<br><button id="registerbutton" name="registerbutton" href="register.html">Register Now</button> 
```

您有一个`form`打开标签但没有一个关闭标签，这个按钮甚至不需要表单标签，这是问题的主要原因

**二、** JS代码结束，

```
}, "json");

} 
```

应该

```
}, "json");
    });
}​ 
```

我不确定你是否在复制时错过了，

**第三，**

append 方法中的`<h3>`标签，尽管这与您遇到的问题无关。

最好使用一些文本编辑器来高亮打开代码、结束标签、大括号。

[这里是工作代码](http://jsfiddle.net/thujeevan/GUu4Y/)

# python - 在 Python 脚本中运行 bash 命令

> ID：12015403
> 
> 赞同：2
> 
> 时间：2012-08-18T02:39:41.590
> 
> 标签：python, bash, interpreter

我想使用 Python 创建一个简单的“虚拟 bash”脚本，它接收命令并返回 stdio 输出。像这样的东西：

```
>>> output = bash('ls')
>>> print output
file1 file2 file3
>>> print bash('cat file4')
cat: file4: No such file or directory 
```

有谁知道允许这种情况发生的模块/功能？我找不到一个。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-18T02:41:30.613

该[`subprocess`](http://docs.python.org/library/subprocess.html)模块包含所有问题的答案。特别是，[`check_output`](http://docs.python.org/library/subprocess.html#subprocess.check_output)似乎完全按照您的意愿行事。页面示例：

```
>>> subprocess.check_output(["echo", "Hello World!"])
'Hello World!\n'

>>> subprocess.check_output("exit 1", shell=True)
Traceback (most recent call last):
   ...
subprocess.CalledProcessError: Command 'exit 1' returned non-zero exit status 1 
```

> 如果 shell 为 True，指定的命令将通过 shell 执行。如果您将 Python 主要用于它在大多数系统 shell 上提供的增强控制流，并且仍然希望访问其他 shell 功能，例如文件名通配符、shell 管道和环境变量扩展，这将很有用。

# c - 进程死亡后的内存泄漏和其他资源

> ID：12015409
> 
> 赞同：5
> 
> 时间：2012-08-18T02:40:39.850
> 
> 标签：c, linux

假设一个程序有内存泄漏。

1）当一个进程死亡（通常或分段错误）时，那些泄漏的内存是否被释放？

2）进程拥有的**其他资源呢？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-18T02:43:46.120

对于大多数现代操作系统（Linux、NT 3.5 左右的 Windows），是的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T04:04:42.053

1）是的，内存已释放。

2) 不同的流程模型？我不知道你的意思是什么，但是一旦一个程序死掉，它`malloc`'d或`new`'d的所有内存都会返回给操作系统，稍后将重新分配给另一个程序。

3）一旦程序退出，所有分配的内存都会返回给操作系统，但是直到该进程被`wait()`另一个进程ed，还有少量数据，例如退出状态等待有人收集。我相信在 linux 上，来自 bash/init 的正常进程将被等待并自动清理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-18T06:40:38.377

我认为，在所有现代系统上，堆栈和堆内存被释放，文件描述符被关闭。

在 POSIX 系统上，有许多资源在进程退出时未被释放、共享信号量、消息队列和内存段。这些意味着在进程之间是持久的，所以它们根本不能。释放它们是应用程序的责任。

它可以使用处理程序来做到这一点`on_exit`，但通常有一种更简单的方法。对于内存段，您通常会`shm_unlink`在所有进程都打开这样的段之后使用。当最后一个进程（及其对该段的文件描述符）关闭时，该段将不复存在。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-18T03:00:27.423

您可以放心地假设现代 linux 系统将释放内存......但是......它不是保证，当然也不是最佳实践。

# android - 怎么用poi看ppt？

> ID：12015424
> 
> 赞同：0
> 
> 时间：2012-08-18T02:45:07.610
> 
> 标签：android, powerpoint, apache-poi

我发现它在Java中支持得很好，我可以把它转换成jpg；但是当我在 Android 中使用它时，bufferimage，graphics，imageio 不支持，因为 android 删除了 java.awt 所以如果我想在 android 中使用 poi，我怎么能告诉我一些有用的东西，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T18:38:06.867

swamy 给了你相当有用的链接。

从 bufferedImage 开始，您可以像我一样采用它并编写自己的适配器：

```
BufferedImage image = ImageIO.read(url);
ByteArrayOutputStream baos = new ByteArrayOutputStream();
ImageIO.write( image, "jpeg", baos );
baos.flush();
byte[] imageInByte = baos.toByteArray();
baos.close();

int idx = ppt.addPicture(imageInByte, XSLFPictureData.PICTURE_TYPE_JPEG);
XSLFPictureShape pic = xslfSlide.createPicture(idx); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T22:44:27.317

我在 Android 上运行了 docx4j（可以处理 pptx）；请参阅[jaxb-can-be-made-to-run-on-android](http://www.docx4java.org/blog/2012/05/jaxb-can-be-made-to-run-on-android/)

我提到这一点的原因是我必须克服 java.awt 问题，这可能会对您有所帮助。我重新打包为[https://github.com/plutext/ae-awt](https://github.com/plutext/ae-awt)

如果您想将它与 POI 一起使用，则必须更改 POI 中的引用。

如果您只是使用 pptx，您可能会发现使用 docx4j 更容易（因为使用 POI，您可能还需要让 XML Beans 在 Android 上运行）。

# python - 高效存储和读取大型数据文件

> ID：12015425
> 
> 赞同：5
> 
> 时间：2012-08-18T02:45:16.710
> 
> 标签：python, large-data

我正在做一个项目，我有来自 pdes 数值解的大型输入文件。数据格式如下。

```
x \t y \t f(x,y) 
```

对于每个 y 值，我们有几个 x 值，以及在每个点评估的函数值。我正在处理的数据的大小大约是每个维度`[-3, 5]x[-3, 5]`的步长`0.01`，因此原始数据文件非常大（关于`640,000`条目）。将其读入内存也非常耗时，因为我正在使用的工具必须同时读取多个这种类型的原始数据文件。

我正在使用 Python。

有没有办法在 Python 中有效地存储和读取这样的数据？这个想法是包含一个工具，将这些原始数据文件按摩成可以更有效地读取的东西。我目前正在对数据进行插值并存储一些系数（本质上是通过计算时间来替换内存），但我确信必须有一种更简单的方法来帮助内存和时间。

感谢 SOCommunity！

PS：我在Java中看到了相关的问题。我在这里完全使用 Python。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T03:10:51.933

如果你正在使用 numpy（你可能应该使用），[`numpy.save`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.save.html)/[`numpy.savez`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html)并且[`numpy.load`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.load.html)应该能够很容易地处理这个问题。

例如：

```
import numpy as np
xs = np.linspace(-3, 5, 800)
ys = np.linspace(-3, 5, 800)
f_vals = np.random.normal(size=(xs.size, ys.size))
np.savez('the_file.npz', xs=xs, ys=ys, f=f_vals) 
```

速度非常快，生成的文件小于 5mb。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-22T06:35:48.057

> 有没有办法在 Python 中有效地存储和读取这样的数据？

If you don't need to keep it in memory all the time, I would suggest migrating the data to an [Sqlite](https://docs.python.org/3/library/sqlite3.html) database. This would also allow you making SQL queries on the data.

# python - 更新使用 imshow()、contour() 和 quiver() 制作的图形

> ID：12015427
> 
> 赞同：10
> 
> 时间：2012-08-18T02:45:22.640
> 
> 标签：python, matplotlib

我想知道是否可以更新用 完成的轮廓、用 完成`contour()`的矢量场`quiver()`和用 完成的图像`imshow()`，而实际上不必再次调用这些函数或创建新的图形、轴等。换句话说，是可能（并且通常人们会这样做）更新图形的这些元素而无需重新调用例程。

我已经尝试过基于但我无法使其适用于矢量场和等高线图的`set_array()`解决方案。`pyplot.draw()`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T20:52:05.500

好吧，你可以`imshow`通过调用`.set_data()`图像来做到这一点，然后`fig.canvas.draw()`在图上。与仅调用相比，我没有看到任何真正的性能优势- 在下面的基准测试中（用作后端）`draw()`，两者都给了我大约 25FPS 。`WXAgg`

```
import numpy as np
import matplotlib.pyplot as pp
import time

def animate_data(data):

    fig,ax = pp.subplots(1,1)

    # I'm not convinced that animated=True does anything either...
    image = ax.imshow(data[0,:,:],animated=True)

    # pp.draw()
    fig.canvas.draw()

    start = time.time()
    tic = start
    for ii in xrange(1,data.shape[0]):
        if not(ii % 10):
            toc = time.time()
            print "FPS =\t%.6G" %(10./(toc-tic))
            tic = time.time()
        image.set_data(data[ii,:,:])

        # pp.draw()
        fig.canvas.draw()

    print "Average FPS =\t%.6G" %(data.shape[0]/(time.time()-start))

fakedata = np.random.randn(200,512,512)
animate_data(fakedata) 
```

在 的情况下`quiver`，您可以使用`.set_UVC()`更新绘图：

```
fig,ax = subplots(1,1)

u1 = np.random.rand(10,10)
v1 = np.random.rand(10,10)
c1 = np.random.rand(10,10)

q = ax.quiver(u1,v1,c1)
fig.canvas.draw()

u2 = np.random.rand(10,10)
v2 = np.random.rand(10,10)
c2 = np.random.rand(10,10)

q.set_UVC(u2,v2,c2)
fig.canvas.draw() 
```

据我所知，您不能`contour`以相同的方式更新绘图。我不确定无论如何都会获得这么多，因为任何解决方案仍然需要重新计算给定数组输入的轮廓线应该去哪里。如果我是你，我只会打电话`ax.contour()`和`fig.canvas.draw()`。

# android - Android 在 AsyncTask 之间传递对象

> ID：12015428
> 
> 赞同：1
> 
> 时间：2012-08-18T02:45:23.107
> 
> 标签：android, object, android-asynctask

以下是我的代码。我正在尝试将 String image_url 从 SingleMenuItemActivity.class 传递给 SaveImageTask.class 。我还不能完成它。也许我的代码有问题。有人可以检查我的代码。我同时使用 AsyncTask。

SingleMenuItemActivity.class

```
public class SingleMenuItemActivity  extends Activity {

    // XML node keys
static final String KEY_TITLE = "title";
static final String KEY_ARTIST = "artist";  
static final String KEY_THUMB_URL = "thumb_url";
private ProgressDialog pDialog;
String title;
String artist;
String image_url;
ImageView view;
Intent intent;
Context context;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.single_list_item);
        new loadSingleView().execute(); 

        view = (ImageView) findViewById(R.id.single_image);

    }

public class loadSingleView extends AsyncTask<String, String, String> {

        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            pDialog = new ProgressDialog(
                    SingleMenuItemActivity.this);
            pDialog.setMessage("Connecting to Server ...");
            pDialog.setIndeterminate(false);
            pDialog.setCancelable(false);
            pDialog.show();
        }
        @Override
        protected String doInBackground(String... args) {
            // updating UI from Background Thread

            Intent in = getIntent();

            image_url = in.getStringExtra(KEY_THUMB_URL);
                        title = in.getStringExtra(KEY_TITLE);
            artist = in.getStringExtra(KEY_ARTIST);

            return null;

                    }
        @Override       
        protected void onPostExecute(String args) {
            // dismiss the dialog after getting all products

            ImageLoader imgLoader = new ImageLoader(getApplicationContext());

            imgLoader.DisplayImage(image_url, view);

            TextView lblName = (TextView) findViewById(R.id.name_title);
            TextView lblCost = (TextView) findViewById(R.id.name_artist);

            lblName.setText(title);
            lblCost.setText(artist);
            pDialog.dismiss();

        }

}   
 @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.main_menu, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {

        switch (item.getItemId()) {
            case R.id.save_image:

            new SaveImageTask(this).execute(image_url);

                  return true;

            default:
                return false;
        } 
```

SaveImageTask.class

```
public class SaveImageTask extends AsyncTask<String , String , String>
{
    private Context context;
    private ProgressDialog pDialog;
    String image_url;
    URL myFileUrl = null;
    Bitmap bmImg = null;

    public SaveImageTask(Context context) {
        this.context = context;
    }

    @Override
    protected void onPreExecute() {
        // TODO Auto-generated method stub

        super.onPreExecute();

        pDialog = new ProgressDialog(context);
        pDialog.setMessage("Downloading Image ...");
        pDialog.setIndeterminate(false);
        pDialog.setCancelable(false);
        pDialog.show();

    }

    @Override
    protected String doInBackground(String... args) {
        // TODO Auto-generated method stub

        try {  

            myFileUrl = new URL(image_url);
            HttpURLConnection conn = (HttpURLConnection) myFileUrl.openConnection();   
            conn.setDoInput(true);   
            conn.connect();     
            InputStream is = conn.getInputStream();
            bmImg = BitmapFactory.decodeStream(is); 
        }
        catch (IOException e)
        {       
            e.printStackTrace();  
        }
        try {       

            String path = myFileUrl.getPath();
            String idStr = path.substring(path.lastIndexOf('/') + 1);
        File filepath = Environment.getExternalStorageDirectory();
        File dir = new File (filepath.getAbsolutePath() + "/Wallpaper/");
            dir.mkdirs();
            String fileName = idStr;
            File file = new File(dir, fileName);
            FileOutputStream fos = new FileOutputStream(file);
            bmImg.compress(CompressFormat.JPEG, 75, fos);   
            fos.flush();    
            fos.close();       
        }
        catch (Exception e)
                {
                    e.printStackTrace();  
                }
        return null;   
    }

    @Override
    protected void onPostExecute(String args) {
        // TODO Auto-generated method stub

        pDialog.dismiss();

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T03:21:12.000

代替

```
 myFileUrl = new URL(image_url); 
```

尝试使用 `arg[0] array`

# mongodb - 元组（数组）作为 mongoose.js 中的属性

> ID：12015429
> 
> 赞同：2
> 
> 时间：2012-08-18T02:46:09.373
> 
> 标签：mongodb, mongoose

MongoDB，特别是 mongoose.js，允许元组作为属性。例如，[MongoDB 文档有这个例子](http://mongoosejs.com/docs/guide.html)，其中属性`comments`本身是一个具有属性的对象数组`[{body: String, date: Date}]`。耶！

```
var blogSchema = new Schema({
  title:  String,
  author: String,
  body:   String,
  comments: [{ body: String, date: Date }],
  date: { type: Date, default: Date.now },
  hidden: Boolean,
  meta: {
    votes: Number,
    favs:  Number
  }
}) 
```

现在，当我将其持久化到 MongoDB 时，不仅每个实例`blogSchema`都会获得自己的 _id 值（例如`502efea0db22660000000002`），而且每个单独的值`comment`都会获得自己的`_id`字段。

大多数情况下我不在乎，但在我的应用程序中，模拟`comments`可能有数千个值。每一个都有自己的巨大价值`_id`。

我可以防止吗？我永远不需要单独提及它们。还是我应该学会停止担心并喜欢唯一标识符？我从小就对 Vic20 和 TRS80 进行编程，因此可能对浪费内存/存储过于偏执。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T05:03:04.510

`_id`可以通过将架构`noId`选项设置为 来禁用`true`。要传递选项，您需要传递模式实例而不是使用对象文字：

```
// instead of this...
comments: [{ body: String, date: Date }]

// do this...
var commentSchema = new Schema({ body: String, date: Date }, { noId: true });
var blogSchema = new Schema({
  ..
  comments: [commentSchema]
}) 
```

# php - 提交前修改 $_POST 变量

> ID：12015432
> 
> 赞同：0
> 
> 时间：2012-08-18T02:47:24.927
> 
> 标签：php, html

我正在制作一个测验生成器，并且我有一个带有单选按钮的 HTML 表单，用于选择答案。现在，当我提交表单时，$_POST 变量的内容在我提交时如下所示：

```
Array ( [a1] => Bob [a2] => Bobby ) 
```

（Bob 和 Bobby 是我选择的单选按钮）

我正在使用 PHP 函数生成此表单，该函数除了回显 HTML 表单外，还返回一组答案。有没有办法修改 $_POST 变量以具有“答案”字段（用于检查我的答案），如下所示：

```
 Array( [a1] => Bob [a2] => Bobby [answers] => Array( [0] => Bob [1] => Bilbo )) 
```

以上是我想到用 $_POST 数组检查答案数组的一种方法。

编辑：关于我到目前为止的更多信息：

*   我有一个响应 HTML 表单的 PHP 函数 getTest()，并返回一个包含正确答案的数组。
*   getTest() 随机生成每个问题，因此正确答案是随机的。
*   主要问题是我有两个单独的 PHP 文件，questions.php 和 verify.php。
    *   questions.php 使用 getTest() 回显表单，并具有答案数组。
    *   verify.php 只有 $_POST 的内容，**但没有**正确答案的数组。

一般有没有更好的方法来检查表单提交的结果？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T04:03:04.587

我认为您需要做的是查看会话。

*   这样，在 questions.php 上，您可以将答案保存到会话变量中，
*   然后在 verify.php 上，您可以从会话变量中读取答案并将它们与 $_POST 变量提供的答案进行比较

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T04:23:32.350

如果您真的想要，您可能只使用表单中的隐藏字段来提交答案数组。但是，任何人都可以更改您的来源并修改正确答案。

最好的方法是在您的处理脚本中使用相同的键（a1，a2），但具有正确的答案。

您的处理脚本如下所示：

```
$answers = array('a1'=>'Robert', 'a2'=>'Hobo');

foreach($_POST as $key => $value)
{
   if (!array_key_exists($key, $answers))
   {
       continue;
   }

   if (trim($value) == $answers[$key])
   {
        // correct
   }
   else
   {
        // incorrect
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-18T03:52:27.733

如果您想在提交表单时传输答案，您可以使用页面上不可见的隐藏类型（如 ）输入。然而，它只需要用户检查页面的源 HTML 来查看这些答案，因此它可能不适合您的使用。希望这可以帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-18T02:51:32.200

进行测验的最佳方法是拥有一个答案数组和一个用户输入数组。循环遍历一个并使用相同的增量与另一个进行比较。

您可以获取所有帖子变量并创建一个数组 print_r($_POST); 然后，循环这个。

```
$inputArray = //the post data into an array
$answerArray = array('a','b','a');
$numCorrect = 0;
for($a = 0; $a < count($inputArray); $a++)
{
if($inputArray[$a] == $answerArray[$a])
{
$numCorrect++;
}
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-18T05:14:54.787

不确定，但看起来您正在寻求解决方案 Y，而您的问题是 X **（[XY 问题](http://www.perlmonks.org/index.pl?node_id=542341)）**

> XY问题是当你需要做X，并且你认为你可以用Y做X，所以你问如何做Y，而你真正应该做的是陈述你的X问题是什么。可能存在比 Y 更好的 Z 解决方案，但如果从未提及 X，则没有人可以建议它。

通常不建议修改 $_POST 数组，也不建议将带有问题的 Answers 传送到客户端。相反，该方法应该是因为`questions.php`不需要答案，但`verify.php`确实需要，因此只能`verify.php`获得答案。

例如，在考试时，答题单永远不会与试卷一起运送到考场。

我冒昧地修改了您的代码结构。如果您仍然想使用自己的代码，请发布它，然后您可以获得您想要的答案。

尝试使用这个：

**`question.php:`**

```
<form action="verify.php" method="POST">
<fieldset class="Question1"> Complete this: ___<b>bar</b>
  <input type="radio" name="answers[]" value="foo">Foo<br>
  <input type="radio" name="answers[]" value="too">Too<br>
  <input type="radio" name="answers[]" value="cho">Cho<br>
</fieldset>

<fieldset class="Question2"> Complete this: ___<b>overflow</b> 
  <input type="radio" name="answers[]" value="stack">Stack<br>
  <input type="radio" name="answers[]" value="stock">Stock<br>
  <input type="radio" name="answers[]" value="stick">Stick<br>
</fieldset>
</form> 
```

**`answers.php:`**

```
//correct answers
$answers = array("foo", "stock"); 
```

**`verify.php:`**

```
include("answers.php");
$user_answers = $_POST["answers"];
$user_answers_count = count($user_answers);

$error = "";
for($i=0;$i<$user_answers_count;$i++)
    if($user_answers[$i] !== $answers[$i]) //verify
        $error[] = "Answer for Question ".($i+1)." is wrong!";

if(empty($error))
    //Notify that user has passed the Quiz
else
    //Notify that user has NOT passed the Quiz
    //print the $error array 
```

**几点注意事项：**

*   我用`answers.php`的是不同的文件，但如果没有特殊要求，可以考虑合并`answers.php`& `verify.php`（把`answers.php`代码放在上面`verify.php`），更好的是，你也可以将这三个文件合并为一个。
*   我假设 $_POST 已经过消毒。
*   `answers`问题和数组的顺序是相同的。即`answers[foo]`是正确的答案`$_POST["answers"][foo]`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-18T02:59:24.093

如果您希望 $_POST 包含一个数组，您可以简单地在表单的名称字段上使用括号数组表示法。

例如：

```
<fieldset class="Question1"> 
  <input type="radio" name="answers[]" value="Question1Answer1">Question1Answer1<br>
  <input type="radio" name="answers[]" value="Question1Answer2">Question1Answer2<br>
  <input type="radio" name="answers[]" value="Question1Answer3">Question1Answer3<br>
</fieldset>

<fieldset class="Question2"> 
  <input type="radio" name="answers[]" value="Question2Answer1">Question2Answer1<br>
  <input type="radio" name="answers[]" value="Question2Answer2">Question2Answer2<br>
  <input type="radio" name="answers[]" value="Question2Answer3">Question2Answer3<br>
</fieldset>

<fieldset class="Question3"> 
  <input type="radio" name="answers[]" value="Question3Answer1">Question1Answer1<br>
  <input type="radio" name="answers[]" value="Question3Answer2">Question1Answer2<br>
  <input type="radio" name="answers[]" value="Question3Answer3">Question1Answer3<br>
</fieldset> 
```

（请注意，字段集标签是可选的，我只是将其包含在一起以将事物组合在一起）

post 中的输出将是一个数组 $_POST['answers'] ，每个问题都有一个元素。因此，如果您为问题 1 选择答案 1，为问题 2 选择答案 2，为问题 3 选择答案 2，您将拥有：

```
$_POST['answers'] = [ 'Question1Answer1', 'Question2Answer2', 'Question3Answer2' ] 
```

# java - 将 JSF 2.1 与 JSP 2.0 一起使用时出错：无法从 JAR 文件中读取 TLD

> ID：12015433
> 
> 赞同：2
> 
> 时间：2012-08-18T02:48:37.317
> 
> 标签：java, jsp, maven, jsf-2, taglib

我尝试在 JSP 2.0 中使用 JSF 2.1。

当我添加这个`<%@taglib uri="http://java.sun.com/jsf/html" prefix="h" %>`

我收到以下错误：

```
Unable to read TLD "META-INF/html_basic.tld" from JAR file
    "file:/home/fadhel/.m2/repository/javax/javaee-web-api/6.0/javaee-web-api-6.0.jar":
org.apache.jasper.JasperException: PWC6169:
    Failed to load or instantiate TagLibraryValidator class: com.sun.faces.taglib.html_basic.HtmlBasicValidator. 
```

有人能告诉我如何将 JSF 2.1 和 JSP 2.0 与 Java 6 一起使用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T16:28:34.210

我相信特定的 Maven 库仅用于 Java 编译。您不能在运行时使用它（即使用于单元测试）。如果您要在服务器上运行它，请确保将依赖项标记为`provided`.

如果你想加载这个库，你将不得不依赖一个真正的 API。由于几乎每个 Java EE API 都有不止一种实现，因此您必须自己研究和选择这些实现。

寻找[这样](http://www.adam-bien.com/roller/abien/entry/trouble_with_crippled_java_ee)的博客文章来解决您的特定问题。

# android - 没有 Maven 的 Android 上的 Spring

> ID：12015434
> 
> 赞同：3
> 
> 时间：2012-08-18T02:48:41.583
> 
> 标签：android, spring, rest

我可以在不使用 Maven 的情况下在 Android 上使用 Spring REST 客户端。有人可以告诉我或指向参考。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T02:51:00.660

下载包含 jar 包的[发行版。](http://www.springsource.org/download/community?project=Spring%20for%20Android)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T11:37:28.570

[从此处](http://mvnrepository.com/artifact/org.springframework.android/spring-android-rest-template/1.0.1.RELEASE)和[此处](http://mvnrepository.com/artifact/org.springframework.android/spring-android-core/1.0.1.RELEASE)下载以下 jar 文件，然后将它们添加到 libs 文件夹中。

*   spring-android-core-1.0.0.RELEASE.jar
*   spring-android-rest-template-1.0.0.RELEASE.jar

如果您想在代码中使用 MappingJacksonHttpMessageConverter 消息转换器，以便使用[Jackson](http://jackson.codehaus.org/) JSON 处理器的 ObjectMapper 读取和写入 JSON，请添加它的库。

# android - SQLite没有打开构造函数错误

> ID：12015435
> 
> 赞同：0
> 
> 时间：2012-08-18T02:48:44.353
> 
> 标签：android, sqlite, constructor, compiler-errors, logcat

当试图将数据插入我的 sqlite 数据库时，我收到一个 logcat 错误“没有空的构造函数”。错误消息听起来很简单，但我可以理解一个 empy 构造函数将如何帮助我将数据插入到我的数据库中。

错误：

```
 E/AndroidRuntime(531): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.LoginScr.Example/com.LoginScr.Example.LoginDB}: java.lang.InstantiationException: can't instantiate class com.LoginScr.Example.LoginDB; no empty constructor 
```

数据库：

```
 public class LoginDB extends SQLiteOpenHelper {

//Table attributes
public static final String DATABASE_NAME = "logindata.db";
public static final int DATABASE_VERSION = 1;
public static final String TABLE_NAME_INFOTABLE = "credentials";

// Data attributes
public static final String COLUMN_NAME_USERNAME = "username";
public static final String COLUMN_NAME_PASSWORD = "password";

private SQLiteOpenHelper DBHelper;
private SQLiteDatabase db;

public LoginDB(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
        // TODO Auto-generated constructor stub
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        // TODO Auto-generated method stub      

        String sqlDataStore = "create table if not exists " +
        DATABASE_NAME + " ("+ BaseColumns._ID + " integer primary key autoincrement,"

                    + COLUMN_NAME_USERNAME + " text not null,"
                    + COLUMN_NAME_PASSWORD + " text not null);";

        db.execSQL(sqlDataStore);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // TODO Auto-generated method stub
        if(oldVersion == 1 && newVersion == 2){
            //Upgrade the database
    }   

}

    public boolean Login(String username, String password) throws SQLException
    {
        Cursor mCursor = db.rawQuery("SELECT * FROM " + DATABASE_NAME + " WHERE username=? AND password=?",
                new String[]{username,password});
        if(mCursor !=null) {
            if(mCursor.getCount()>0)
            {
            return true;
            }
        }
            return false;
        }

    public void open() {
        // TODO Auto-generated method stub
        db = DBHelper.getWritableDatabase();
    }
    public void close() {
        DBHelper.close();
    }
     } 
```

活动：

```
 public class CredentialsActivity extends Activity implements OnClickListener{

   private Button lReg;
   private EditText lUname;
   private EditText lPword;

   private LoginDB loginDb = new LoginDB(CredentialsActivity.this);

   @Override
   protected void onCreate (Bundle savedInstanceState) {
   // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
   setContentView(R.layout.register);

   lReg = (Button)findViewById(R.id.reg_button);
   lReg.setOnClickListener(this);
   }

  public void onClick(View v) {

switch(v.getId()) {

case R.id.reg_button:
    lUname = (EditText)findViewById(R.id.reg_uname);
    lPword = (EditText)findViewById(R.id.reg_pswd);

    String uname = lUname.getText().toString();
    String pass = lPword.getText().toString();
    boolean invalid = false;

    if(uname.equals("")){
        invalid = true;
        Toast.makeText(getApplicationContext(), "Username Missing", Toast.LENGTH_SHORT).show();
    }else if(pass.equals("")){
        invalid = true;
        Toast.makeText(getApplicationContext(), "Password Missing", Toast.LENGTH_SHORT).show();
    }
    if(invalid == false){
        addEntry(uname, pass);
        Intent i_register = new Intent(CredentialsActivity.this, LoginDB.class);
        startActivity(i_register);
        finish();
}}
}
    public void onDestroy() {
        super.onDestroy();
        loginDb.close();
    }

     public void addEntry(String uname, String pass){

     SQLiteDatabase db = loginDb.getWritableDatabase();
     ContentValues values = new ContentValues();
     values.put("username", uname);
     values.put("password", pass);

     try{
         db.insert(LoginDB.DATABASE_NAME, null, values);
         Toast.makeText(getApplicationContext(), "Saved! Please login now",            Toast.LENGTH_SHORT).show();
         }catch(Exception err){
      err.printStackTrace();
     }
    }
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T20:50:19.553

我最终不得不重写我的 DB 类以使其工作，问题是允许 SQLOpenHelper 与其他类的方法进行交互。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T13:28:42.917

消除

```
private LoginDB loginDb = new LoginDB(CredentialsActivity.this); 
```

而是从您`Activity`的 's调用相同的`onCreate`：

```
private LoginDB loginDb;
void onCreate(Bundle savedInstanceState)
{
  super.onCreate(savedInstanceState);
  loginDb = new LoginDB(CredentialsActivity.this);
...
} 
```

# android - Android /proc/binder 甚至不在设备的 full_crespo-eng 4.0.4 (Nexus S) 构建上？

> ID：12015443
> 
> 赞同：0
> 
> 时间：2012-08-18T02:50:38.063
> 
> 标签：android, android-emulator, nexus-s

这对 SO 来说可能是个坏问题，但我不知道还能去哪里找。

我有一个应用程序可以解析`/proc/binder/stats`与活页夹相关的统计信息。该文件存在于我的模拟器上，但不存在于刷有 full_crespo-eng 版本的根深蒂固的 Nexus S 手机上。

我觉得这是一个不充分的问题，但我提供的信息涵盖了我所尝试的所有内容。我在其他地方找不到太多关于在设备上阅读此文件时遇到问题的人的信息。我也没有在设备上的开发者选项中看到任何启用此功能的选项。我还能在哪里查看和了解更多信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T16:06:45.287

我使用的模拟器（具有相同的版本）使用的是内核版本 2.6.29，而我的手机使用的是 3.0.31。在正常的 ( `full_crespo-user`) 构建中，我曾经`adb shell ls -R / | grep binder`查找与 binder 相关的文件和目录，并找到了包含我想要`/sys/kernel/debug/binder/`的文件的目录。`stats`

# c# - 使用 linq 从站点地图文件中提取标题

> ID：12015447
> 
> 赞同：1
> 
> 时间：2012-08-18T02:52:00.503
> 
> 标签：c#, linq, linq-to-xml

有没有办法使用[XDocument](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument%28v=vs.90%29.aspx)和 LINQ 来提取[web.sitemap](http://msdn.microsoft.com/en-us/library/yy2ykkab.aspx)文件中所有元素的所有`title`属性，而不管深度如何？任何有关如何执行此操作的示例将不胜感激！`siteMapNode`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T03:01:15.963

你可以试试这样的

```
XElement xelement = XElement.Load(Server.MapPath("~/web.sitemap"));
    var urlList = xelement.Descendants().Attributes()
       .Where(x => x.Name == "title")
       .Select(x => x.Value);

    foreach (string s in urlList)
    {

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T03:01:05.080

```
string sitemapfile = File.ReadAllText("path of web.sitemap");

XDocument doc = XDocument.Parse(sitemapfile);

var elements = doc.Root.Elements("siteMapNode");
foreach (var elem in elements) {
    if (elem.Attribute("title") != null)
         {
        //do your work
         } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T03:02:04.073

有时，使用普通的旧 XPath 会容易得多。

```
var doc = XDocument.Parse(contentsOfFile);
doc.XPathEvaluate("//@title");
foreach (var element in ((IEnumerable)result).Cast<XAttribute>())
{
    Console.WriteLine("{0} has value {1}", element.Name, element.Value);
} 
```

# python - 两个路由字符串在python中相互附加

> ID：12015449
> 
> 赞同：1
> 
> 时间：2012-08-18T02:52:14.237
> 
> 标签：python, google-app-engine

在下面的代码`location_id = "Roger"`中`court_id = "court1"`

```
return webapp2.redirect("/schedule/%s/%s" % (location_id, court_id)) 
```

其中get定义如下

```
class Schedule(BaseHandler):
    def get(self, location_id, court_id):
        self.render_template('schedule.html', {'location':location_id,'court':court_id}) 
```

但是当我使用以下路由到达 schedule.html 模板时，

```
app = webapp2.WSGIApplication([
        ('/', MainPage), 
        ('/create/([\w]+)', CreateCourt), 
        ('/createlocation/([\w]+)', CreateLocation), 
        ('/schedule/([\w]+/([\w]+))', Schedule) 
        ],
        debug=True) 
```

的值`location`已经增长到包括 a`/`和 的值`court`：“Roger/court1”。

如何将“位置/法院”的两个部分分开？我怀疑答案与 /schedule 的路由正则表达式有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T03:10:37.570

我认为您是对的-在您的`schedule`处理程序中，您似乎缺少右括号（以前从未输入过该单数-奇怪:)）。尝试这个：

```
app = webapp2.WSGIApplication([
        ('/', MainPage), 
        ('/create/([\w]+)', CreateCourt), 
        ('/createlocation/([\w]+)', CreateLocation), 
        ('/schedule/([\w]+)/([\w]+)', Schedule) 
        ],
        debug=True) 
```

# shopify - 我想向 Shopify 订单通知添加自定义电子邮件变量

> ID：12015450
> 
> 赞同：2
> 
> 时间：2012-08-18T02:52:29.687
> 
> 标签：shopify

谁能告诉我如何将自定义电子邮件变量添加到 shopify 订单通知？

例如，默认情况下，订单通知已经包含以下内容：

```
 Shipping address
    {{ shipping_address.name }}
    {{ shipping_address.street }}
    {{ shipping_address.city }}, {{ shipping_address.province }}  {{ shipping_address.zip }}
    {{ shipping_address.country }}{% endif %} 
```

然后，这些变量会特别转化为客户的实际送货地址。现在我想在此订单通知中添加来自第三方来源的一行信息，我该怎么做？我需要在 Shopify 订单通知电子邮件中放入许可证密钥，但此许可证密钥来自 Shopify 之外的服务，有什么方法可以使这种情况发生吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T19:59:14.123

如果您将应用程序连接到您的商店，这很容易。然后，您可以使用该应用通过 Shopify Webhook 收听订单。当您接受订单后，您可以触发代码生成或获取许可证密钥，然后只需向客户发送一封电子邮件，其中包含许可证密钥和您需要提供的任何其他信息。这是一个简单的创建模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T12:08:02.263

Shopify 无法在将电子邮件放在一起发送给买家时从您的外部服务中获取数据，但您可以使用[订单/付费 webhook](http://api.shopify.com/webhook.html)将许可证密钥与您自己的服务器分开发送。

爱德华，Shopify 开发者倡导者

# svn - 如何获取 SVN 中分支的原始版本？

> ID：12015453
> 
> 赞同：3
> 
> 时间：2012-08-18T02:53:03.087
> 
> 标签：svn, branch

根据[this blog post](http://grep.codeconsult.ch/2008/11/26/what-svn-revision-was-this-branch-created-in/)这个命令应该告诉我`release-2.0.2rc1`protobuf标签的创建时间：

> svn log -v -r0:HEAD -l1 --stop-on-copy [http://protobuf.googlecode.com/svn/tags/release-2.0.2rc1/](http://protobuf.googlecode.com/svn/tags/release-2.0.2rc1/)

但是它不会：

```
svn log -v -r0:HEAD -l1 --stop-on-copy http://protobuf.googlecode.com/svn/tags/release-2.0.2rc1/
------------------------------------------------------------------------
r54 | kenton@google.com | 2008-09-29 20:26:43 -0400 (Mon, 29 Sep 2008) | 3 lines
Changed paths:
   M /tags/release-2.0.2rc1/configure.ac
   M /tags/release-2.0.2rc1/java/pom.xml
   M /tags/release-2.0.2rc1/python/setup.py

Update version number in 2.0.2rc1 release branch. 
```

如果我查看修订版 53，我会得到实际副本：

```
svn log -v -r53 -l1 --stop-on-copy http://protobuf.googlecode.com/svn/
------------------------------------------------------------------------
r53 | kenton@google.com | 2008-09-29 20:23:29 -0400 (Mon, 29 Sep 2008) | 3 lines
Changed paths:
   A /tags/release-2.0.2rc1 (from /trunk:52)

Tagged release candidate 2.0.2rc1. 
```

因此，该命令似乎让我在复制后进行了修订。如何获得为我提供分支修订版的命令？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T12:25:27.180

这有时需要两个命令。我没有为问题编写脚本，因为我的目标是从[SharpSvn](http://sharpsvn.open.collab.net/)而不是从 SVN 命令行获取这些信息。但是，从命令行执行此操作的过程如下：

```
svn log -v -r0:HEAD -l1 --stop-on-copy http://protobuf.googlecode.com/svn/tags/release-2.0.2rc1/
REM inspect the output and see that there is no mention of /tags/release-2.0.2rc1/ being created or copied.
svn log -v -r53:0 -l1 --stop-on-copy http://protobuf.googlecode.com/svn/tags/release-2.0.2rc1/ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-19T12:41:20.900

您在那里所做的是将存储库的整个空间过滤到您想要的分支，并询问“该分支的第一个修订版是什么”。现在很明显，以前的修订版（创建它的那个）不是其中的一部分，因为分支在创建之前并不存在。

因此，第一个命令的作用是告诉您使用该分支的初始修订版 - 第一次提交或复制。它不会为您提供对先前版本的修改（添加分支时），因为那不是对您的分支的修改，而是对父分支的修改。（认为​​它就像 svn 中的每个目录都不是您在资源管理器中看到的目录，其中添加子目录是添加一个新子目录，而是将每个目录视为一个包含子目录列表的文本文件）

出于实际目的，它可以正常工作，除非您想对父目录（标签目录）采取行动，否则您不需要找到分支的修订版，您只需要对分支进行第一次修改，然后停止复制给你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-18T03:20:32.553

`-l`限制要显示的日志条目的数量，因此如果您有多个提交，您只会获得最近的提交。如果您省略，您将`-l1`获得完整列表，其中最后一个条目是创建分支的条目。

当然，如果您“正确”地使用标签，那么您的第一个命令就可以正常工作，即。你在一个标签上只有一个提交，那就是你创建它的副本。之后你永远不应该修改标签。将它们视为书签:-)

# android - 响铃时通过蓝牙耳机播放的声音？- 安卓

> ID：12015455
> 
> 赞同：1
> 
> 时间：2012-08-18T02:53:27.987
> 
> 标签：android, bluetooth

我正在尝试在手机响铃时通过蓝牙耳机播放声音（即代表人名的小 wav 文件 - 不是自动生成的）。本质上它将替换蓝牙设备的默认铃声并将其替换为呼叫者的姓名！......好吧，无论如何......它不起作用。

我已经能够在活动中直接在耳机上播放 wav 文件，但是当移动到广播接收器的 onReceive 功能时，它无法在手机响铃时通过耳机播放相同的声音......

我觉得我一定是错过了什么。我可以做些什么来修改此代码吗？

提前致谢

```
public void onReceive(Context context, Intent intent) {

    mContext = context;
    String state = intent.getStringExtra(TelephonyManager.EXTRA_STATE);

    if(state.equalsIgnoreCase(TelephonyManager.EXTRA_STATE_RINGING))
    {
        System.out.println("Its Ringing");

        AudioManager am = (AudioManager) mContext.getSystemService(mContext.AUDIO_SERVICE); 
        am.setBluetoothScoOn(true); 
        am.startBluetoothSco();
        am.setMode(AudioManager.MODE_NORMAL); 

        try{
            AssetFileDescriptor afd = mContext.getAssets().openFd("my.wav");
            MediaPlayer player = new MediaPlayer();
            player.setAudioStreamType(AudioManager.STREAM_VOICE_CALL);

            player.setDataSource(afd.getFileDescriptor(),afd.getStartOffset(),afd.getLength());

            player.setOnPreparedListener(new OnPreparedListener(){
                public void onPrepared(MediaPlayer mp) {
                    mp.start();
                }
            });

            player.setAudioStreamType(AudioManager.STREAM_VOICE_CALL);
            player.prepareAsync();

        }catch(IOException ioe){
            System.err.println(ioe.getLocalizedMessage());
        }}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-26T16:40:04.930

您应该在接到电话之前准备/设置您的媒体播放器，因为这可能需要一些时间。此外，删除 am.setMode(AudioManager.MODE_NORMAL);，您可以将其替换为 am.setMode(AudioManager.STREAM_VOICE_CALL); 但这可能没有必要，因为如果您的 BT 设备已配对/设置，您应该已经处于该模式。

# c# - 使用泛型变量作为参数调用重载函数

> ID：12015459
> 
> 赞同：3
> 
> 时间：2012-08-18T02:56:16.303
> 
> 标签：c#, generics, extension-methods, type-constraints

我想扩展 BinaryWriter 类以便能够将列表写入流。我想用多种类型的列表来做到这一点。我将此通用功能设置为扩展

```
public static void Write<T>(this BinaryWriter source, IEnumerable<T>items)
{
     foreach (T item in items)
          source.Write(item)//This doesn't work
} 
```

这是可能吗？我知道 write 可以处理所有内置类型。我知道有能力将 T 限制为某些类型，但我无法为 int 和 double 做到这一点。

我只需要它来处理整数、双精度和字节。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-18T03:03:01.107

> 我知道有能力将 T 限制为某些类型

不幸的是，编译器不知道这`T`是其中一种类型，所以它不得不抱怨。

> 我只需要它来处理整数、双精度和字节。

然后可以进行三个重载：

```
public static void Write(this BinaryWriter source, IEnumerable<int>items) {
    foreach (var item in items)
        source.Write(item);
}
public static void Write(this BinaryWriter source, IEnumerable<double>items) {
    foreach (var item in items)
        source.Write(item);
}
public static void Write(this BinaryWriter source, IEnumerable<byte>items) {
    foreach (var item in items)
        source.Write(item);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T03:06:22.260

dasblinkenlight 的解决方案可能是要走的路，但这里有一个替代方案：

```
public static void Write(this BinaryWriter source, IEnumerable items)
{
     foreach (dynamic item in items)
          source.Write(item); //runtime overload resolution! It works!
} 
```

有关更多信息`dynamic`，请参阅[文档](http://msdn.microsoft.com/en-us/library/dd264741.aspx)。

# jsf - 验证器方法在 JSF 自定义复合组件中不起作用

> ID：12015462
> 
> 赞同：1
> 
> 时间：2012-08-18T02:56:50.490
> 
> 标签：jsf, methods, validation, composite-component

JSF 自定义复合组件 input.xhtml

```
<cc:interface>
    <cc:attribute name="validator"/>
</cc:interface>

<cc:implementation>
    <h:inputText validator="#{cc.attrs.validator}"/>
</cc:implementation> 
```

*.xhtml

```
<l:input value = ... validator="#{testValidator.validator}"/> 
```

爪哇代码

@ManagedBean

公共类 TestValidator {

```
 public void validator(FacesContext context, UIComponent component, Object value) throws ValidatorException {
         System.out.println("Call validator");
    }
} 
```

属性未发现异常：

```
validator="#{testValidator.validator}": The class 'TestValidator' does not have the property 'validator'. 
```

如何解决这个问题呢？我最后的方式：

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T11:49:24.230

这确实行不通。为了将验证器附加到复合指定的输入组件，您需要首先将输入组件注册为 a [`<cc:editableValueHolder>`](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/composite/editableValueHolder.html)。`<cc:interface>`

```
<cc:interface>
    <cc:editableValueHolder name="yourInputName" targets="yourInputId" />
</cc:interface>
<cc:implementation>
    <h:inputText id="yourInputId" ... />
</cc:implementation> 
```

这样，`<f:validator for="yourInputName">`复合组件声明中的任何嵌套都将应用于所需的输入组件。

```
<l:input>
    <f:validator validatorId="myValidator" for="yourInputName" />
</l:input> 
```

您只需要用真正的独立`Validator`实现替换紧耦合验证器方法。

```
@FacesValidator("myValidator")
public class MyValidator implements Validator {
    // ...
} 
```

注意：标准的 JSF 验证器，如`<f:validateLength>`,`<f:validateRequired>`等也都有一个`for`用于此目的的属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-08T09:25:50.883

您需要定义一个 cc:attribute "validator"`targets`属性：

```
<cc:interface>
    <cc:attribute name="validator" targets="inputId"/>
</cc:interface>

<cc:implementation>
    <h:inputText id="inputId"/>
</cc:implementation> 
```

（请注意，我没有在 h:inputText 中定义验证器属性）

只要您不为复合组件实现组件类，这很容易。好吧......即使那样它也很容易，但如果你的组件类扩展它就行不通了`UIInput`。如果它扩展`UINamingComponent`类，它就可以工作（我不确定这是否是最好的解决方案，或者你是否可以让它与 UIInput 一起工作但它可以工作）。

所以如果你想拥有自己的组件类，试试这个：

```
<cc:interface componentType="myComponent>
    <cc:attribute name="validator" targets="inputId"/>
</cc:interface>

<cc:implementation>
    <h:inputText id="inputId"/>
</cc:implementation> 
```

```
@FacesComponent("myComponent")
public class MyComponent extends UINamingContainer {

    @Override
    public String getFamily() {
        return UINamingContainer.COMPONENT_FAMILY;
    }

    //your code here

} 
```

# apache - 创建虚拟主机后无法访问本地主机网站

> ID：12015469
> 
> 赞同：6
> 
> 时间：2012-08-18T03:00:12.477
> 
> 标签：apache

我为我的一个本地主机网站创建了一个虚拟主机：

```
<VirtualHost *:80>
  ServerName mysite 
  DocumentRoot /var/www/html/mysite/public
  <Directory /var/www/html/mysite/public>
    Options Indexes FollowSymLinks
    AllowOverride All 
    allow from all 
  </Directory>
</VirtualHost> 
```

现在，我不能再访问其他本地网站了。例如，当我去时，`localhost/anotherwwebite`我会被重定向到 mysite。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-28T18:54:25.927

要使其正常工作，请按照以下步骤操作：

1.  ***从httpd.conf*** *¹*启用虚拟主机配置文件

    在条目下方取消评论（`#`从开头删除）

    #包括conf/extra/httpd-vhosts.conf`

2.  配置***httpd-vhost.conf*** *²*

    在这里，您必须编写**两个**配置集，一个用于 localhost，一个用于虚拟主机。

    放下面

> ```
> <VirtualHost *:80>
> ServerAdmin localhost.admin
> DocumentRoot "C:\wamp\www"  >> For UBUNTU /opt/lampp/htdocs/
> ServerName localhost
> </VirtualHost> 
> ```

（在虚拟主机之前）

> ```
> <VirtualHost *:80>
> ServerAdmin pimcore.test
> DocumentRoot "C:\wamp\www\pimcore-latest"
> ServerName pimcore.test
> ErrorLog "logs/pimcore.test.log"
> CustomLog "logs/pimcore.test.log" common
> </VirtualHost> 
> ```

3.  以及系统**主机** *^(3中的以下条目)*

    127.0.0.1 本地主机

    127.0.0.1 pimcore.test

当然，这些会因您的虚拟服务器名称而异。

* * *

1 : *C:\wamp\bin\apache\Apache2.2.11\conf\ **httpd.conf***或*/opt/lampp/etc/ **httpd.conf***

2 : *C:\wamp\bin\apache\Apache2.2.11\conf\ **extra\httpd-*** ***vhosts.conf***或 */opt/lampp/etc/extra/httpd-vhosts.conf*

 **3 : *C:\WINDOWS\system32\drivers\etc\hosts:*或*/etc/hosts*

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T03:52:55.207

我认为您需要在其中添加一些行

C:\Windows\System32\drivers\etc\host

添加这一行

127.0.0.1 你的站点名称

例如让你的站点名称是 stack.overflow

127.0.0.1 stack.overflow

在您的浏览器中，您可以使用 stack.overflow 而不是 localhost

这样您现在就可以使用 yoursitename 而不是 localhost

希望这有帮助....**

# php - fputcsv 强制所有值都带有引号或根本不带有引号

> ID：12015470
> 
> 赞同：0
> 
> 时间：2012-08-18T03:00:13.727
> 
> 标签：php

我正在使用`fputcsv`它，它只是将输入文本类型值放入引号中。有没有办法覆盖它并强制所有引号或将它们全部删除？我试过`fputcsv($fp, $data, ',', '"');`了，但没用

```
$data = array_values($_POST);
if( $fp = fopen('data.csv', 'a+') ){
    fputcsv($fp, $data);
}
fclose($fp); 
```

**csv 数据示例："user","city",yes,no,10001**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T06:34:53.993

您可以通过附加一个空格来强制引用每个条目，然后在将其写入 .csv 之前使用流过滤器删除该空格

```
/* Function to append a space to each element in the array */
function addSpace(&$var, $key){ $var .= ' '; }

/* Filter class to remove the space previously appended */
class space_filter extends php_user_filter {
  function filter($in, $out, &$consumed, $closing)
  {
    while ($bucket = stream_bucket_make_writeable($in)) {
      $bucket->data = str_replace(' "', '"', $bucket->data);
      $consumed += $bucket->datalen;
      stream_bucket_append($out, $bucket);
    }
    return PSFS_PASS_ON;
  }
}

/* Register filter */
stream_filter_register("filterspace", "space_filter");

$arr = array("user","city","yes","no","10001"); // your array

/* use addSpace on each element in the array */
array_walk($arr, "addSpace");

if( $fp = fopen('data.csv', 'a+') ){
    stream_filter_append($fp, "filterspace"); // Remove space 
    fputcsv($fp, $arr);
}
fclose($fp); 
```

结果：“用户”、“城市”、“是”、“否”、“10001”

我只是出于好奇而写了这个，你可能不应该将它用于任何重要的事情。

# matlab - （matlab）在任何地方实现“评估或打开您选择的代码”？

> ID：12015472
> 
> 赞同：3
> 
> 时间：2012-08-18T03:00:29.223
> 
> 标签：matlab

> **可能重复：**
> [如何在 MATLAB 中检索选定的文本？](https://stackoverflow.com/questions/3533074/how-do-you-retrieve-the-selected-text-in-matlab)

我想实现并向“评估选择”功能添加一些功能，您可以在其中突出显示代码，然后通过右键单击鼠标（或 F9）“评估选择”。

在编辑器环境中，它是这样完成的：

```
editorObject = matlab.desktop.editor.getActive;
eval([editorObject.SelectedText ';']); 
```

如何从命令行窗口或帮助窗口实现此功能？

**编辑**：

也许我没有清楚地表达我的问题。

假设我们已经有了这个名为**eva_select()**的函数，我可以这样使用函数：

1.  我将该功能包装为快捷方式按钮。
2.  使用鼠标在命令行窗口中**选择一个变量，也许我之前输入过，比如****var_a**
3.  然后我点击那个快捷方式按钮，我之前选择的文本将被执行。**这与按F9**键或选择鼠标右键菜单——“评估选择”完全相同。

**但**如果我们真的有这个功能，我们可以做得更多！**我们可以将eva_select** () 修改为 eva_select_size ()，这样我们就可以在命令行窗口或者帮助窗口中选择一个变量，比如说**var_a** ，点击 eva_select_size() 快捷键，然后在命令中得到**size(var_a)**线窗口！

**编辑**：

谢谢，我可以在命令窗口中检索文本，但我不能在**帮助窗口**中做同样的事情，可以这样做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T16:08:57.257

命令窗口与 MATLAB 桌面中的其他 GUI 组件一样，都是基于 Java 的。因此它可以通过编程方式访问，但它完全[没有文档记录](http://undocumentedmatlab.com/)，并且它的使用不受官方支持。

环顾四周，这是一个似乎在 R2012a 和 R2012b 中都适用的解决方案。它涉及获取`JTextArea`命令窗口底层的句柄，该句柄用于获取所选文本（以评估所选变量名称的大小）

使用以下代码创建快捷方式：

```
x = com.mathworks.mde.cmdwin.XCmdWndView.getInstance();
s = char(x.getSelectedText());
if isvarname(s) && exist(s,'var')
    eval( sprintf('size(%s)',s) );
end 
```

接下来在命令窗口中突出显示一个变量名并执行快捷方式。尺寸将立即打印，如下面的屏幕截图所示：

![截屏](../Images/2db51df41b3873c8236ade294e1267be.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T10:14:41.810

它不是很好，因为它是一个外部解决方案，但这就是它的工作方式：

假设您在命令窗口中并希望通过选择它来评估 size(var_a)，您可以使用键盘宏来执行此操作。定义 var_a 的相应函数

```
f(x) = eval('size(' x ')' 
```

%这可以在宏中完成，但最好在这里进行以便于编辑。

然后确保您的宏执行此操作：

```
Copy 'var_a'
Turn it into 'f(var_a)'
Paste the result
Hit enter 
```

就像我说的，它不漂亮，但它应该可以解决问题。

# asp.net-web-api - Web API ODataResult 总是序列化为 Atom

> ID：12015473
> 
> 赞同：4
> 
> 时间：2012-08-18T03:00:55.890
> 
> 标签：asp.net-web-api, odata

我正在从新的[Web API OData 包](http://blogs.msdn.com/b/alexj/archive/2012/08/15/odata-support-in-asp-net-web-api.aspx)返回 ODataResult，如下所示：

```
public ODataResult<Product> Get(ODataQueryOptions options)
{
  var results = (options.ApplyTo(_db.Products) as IQueryable<Product>);
  var count  = results.Count;
  var limitedResults = results.Take(100).ToArray();
  return new ODataResult<Product>(results,null,count);
} 
```

上面的效果很好，但无论查询类型如何，它总是返回一个 Atom 响应。如何返回 JSON？

我可以看到 Atom 是 ODataMediaTypeFormatter 集合中第一个受支持的媒体类型。我很高兴完全删除 Atom 支持，因为我不需要它。更好的是正确协商内容类型。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T07:48:52.940

您是否尝试过设置接受标头，如下所示：

接受=应用程序/json；odata=详细。

那应该返回 JSON。OData 协议已经支持 JSON 有一段时间了，但在协议的 V3 中，application/json 被映射到称为 JSON light 的东西（尚未实现）。因此，在支持 JSON light 以获取 JSON 之前，您必须更加具体一些，并请求自 V1 以来一直在 OData 中的更详细的 JSON 版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T13:46:04.257

我目前还在使用您链接的 Beta 包试验 OData 支持。我们应该记住，它是一个测试包，在发布之前情况可能会发生变化。我遇到了同样的问题。目前，微软似乎正计划在 Web Api 中提供 OData v3 支持，查看 ODataMediaTypeFormatter 即可发现这一点。

在 OData v3 中，将有三种格式：

*   原子 ( `application/atom+xml`)
*   JSON 详细 ( `application/json;odata=verbose`)
*   JSON 灯 ( `application/json;odata=light`)

Atom 是 OData 的唯一默认 XML 格式。OData v3 中的默认 JSON 格式是 JSON light。旧的 OData v2 JSON 格式是 OData v3 中的 JSON Verbose。

[规范](http://download.microsoft.com/download/9/5/E/95EF66AF-9026-4BB0-A41D-A4F81802D92C/%5BMS-ODATA%5D.pdf)（v20120705）第 2.2.5.1 节支持这一点，其中列出了接受和相应的响应标头：

> 应用程序/json;odata=verbose -> ￼应用程序/json;odata=verbose
> 
> 应用程序/json;odata=light ￼ -> 应用程序/json;odata=light
> 
> application/json -> 对于 1.0 版和 2.0 版响应：application/json;odata=verbose。对于 3.0 版响应：application/json;odata=light

不幸的是，他们还没有指定 JSON 灯（第 2.2.5.1.3 节，强调我的）：

> JSON light 格式是一种新格式，仅在 OData 3.0 协议中定义，通过在表示中不包含元数据信息来优化小尺寸。详细格式表示现有的基于 JSON 的格式，由 OData 1.0、2.0 和 3.0 协议定义，其中包括元数据信息以及实例的表示。**此版本的 document 未定义 JSON 轻量级内容类型的格式**。

但是，我确实希望 JSON Light 格式将是 JSON Verbose 格式的正确子集。ODataMediaTypeFormatter 的当前实现将仅响应标`application/json;odata=verbose`头`application/atom+xml`或回退到 ATOM。有趣的是，似乎指定`$format=json`返回[406](http://httpstatusdogs.com/406-not-acceptable)。

如果您想要一个临时解决方案，假设轻格式将是详细格式的适当子集，您可以指示 MediaTypeFormatter 响应`application/json`请求，从而更容易使用 jQuery 中的 OData，因为我们可以省略指定接受标头：

```
ODataMediaTypeFormatter odataFormatter = new ODataMediaTypeFormatter(model);    
odataFormatter.SupportedMediaTypes.Add(MediaTypeHeaderValue.Parse("application/json")); 
```

# jquery - 在折叠/展开菜单上设置 jQuery Cookie（复杂）

> ID：12015477
> 
> 赞同：0
> 
> 时间：2012-08-18T03:01:32.007
> 
> 标签：jquery, menu, toggle, expand, collapse

我正在尝试将 jquery .cookies 添加到我现有的折叠/展开菜单中，但是对于我的生活，我看不到我在哪里失败了。

谁能帮我解决这个问题？我已经看代码不到 9 个小时了，这是我今天应该写的最后一篇。我担心我的大脑已经达到了它的极限，但我无法忍受让工作未完成。这可能很容易，我只是看不到它。

我已将 cookie 设置为 visible_state 并且应该发生的事情是，每次用户单击展开/折叠/切换菜单区域时，它将 cookie 存储为一个类。

**编辑**：我忘了提... cexpand = 用于扩展的 cookie 类...

ccollapse - 折叠的 cookie 类

我原来的 .js（工作菜单）

```
$(document).ready(function() {
setTimeout(function() {
  // Grow/Shrink
  $('#menu3 > li > a.expanded + ul').show('blind');
  $('#menu3 > li > a.collapsed + ul').hide('blind');
  $('#menu3 > li > a').click(function() {
  $(this).toggleClass('expanded').toggleClass('collapsed').parent().find('> ul').toggle('blind');
});
$('.expand_all').click(function() {
$('#menu3 > li > a.collapsed').addClass('expanded').removeClass('collapsed').parent().find('> ul').show('blind');
});
$('.collapse_all').click(function() {
$('#menu3 > li > a.expanded').addClass('collapsed').removeClass('expanded').parent().find('> ul').hide('blind');
});
}, 0);
}); 
```

我的新 .js

```
$(document).ready(function() {
var visible_state = $.cookie("visible_state");
setTimeout(function() {
if ($('.expanded').attr('class')=='cexpand'){
  $(this).removeClass('cexpand');
  $(this).addClass('ccollapse');
  $.cookie('visible_state', 'ccollapse', { path: '/', expires: 100});
  $(this).hide('blind');
} else if ($('.collapsed').attr('class')=='ccollapse'){
  $(this).removeClass('ccollapse');
  $(this).addClass('cexpand');
  $.cookie('visible_state', 'cexpand', { path: '/', expires: 100 });
  $(this).show('blind');        
}   
  $('#menu3 > li > a.expanded + ul').show('blind');
  $('#menu3 > li > a.collapsed + ul').hide('blind');    
  $('#menu3 > li > a').click(function() {
  $(this).toggleClass('expanded', 'cexpand').toggleClass('collapsed', 'ccollapse').parent().find('> ul').toggle('blind');
});

$('.expand_all').click(function() {
  $('#menu3 > li > a.collapsed').addClass('expanded', 'cexpand').removeClass('collapsed', 'ccollapse').parent().find('> ul').show('blind');
});
$('.collapse_all').click(function() {
  $('#menu3 > li > a.expanded').addClass('collapsed', 'ccollapse').removeClass('expanded', 'cexpand').parent().find('> ul').hide('blind');
});
}, 0);
}); 
```

* ***编辑*** *close.js* ***

```
 $(document).ready(function() {

var visible_state = $.cookie('visible_state');

 if (visible_state == null){
$('#menu3 > li > a').addClass('collapsed');
$('#menu3 > li > a + ul.1').addClass('expanded');

 };

 if (visible_state == 'collapsed'){
$('#menu3 > li > a').removeClass('expanded');
$('#menu3 > li > a').addClass('collapsed');

$.cookie('visible_state', 'collapsed', { path: '/', expires: 100 });
 };
  if (visible_state == 'expanded'){
$('#menu3 > li > a').addClass('expanded');
$.cookie('visible_state', 'expanded', { path: '/', expires: 100 });
 };

 $('#menu3 > li > a').click(function() {
 if ($('#menu3 > li > a').attr('class')=='expanded'){
$(this).removeClass('expanded');
$(this).addClass('collapsed');
$.cookie('visible_state', 'collapsed', { path: '/', expires: 100 });

} else{
$(this).removeClass('collapsed');
$(this).addClass('expanded');
$.cookie('visible_state', 'expanded', { path: '/', expires: 100 });

}
});

$('#menu3 > li > a.expanded + ul.1').show('blind');
$('#menu3 > li > a.expanded + ul.2').show('blind');
$('#menu3 > li > a.expanded + ul.3').show('blind');
$('#menu3 > li > a.expanded + ul.4').show('blind');
$('#menu3 > li > a.expanded + ul.5').show('blind');
$('#menu3 > li > a.collapsed + ul.1').hide('blind');
$('#menu3 > li > a.collapsed + ul.2').hide('blind');
$('#menu3 > li > a.collapsed + ul.3').hide('blind');
$('#menu3 > li > a.collapsed + ul.4').hide('blind');
$('#menu3 > li > a.collapsed + ul.5').hide('blind');

$('.expand_all').click(function() {
  $('#menu3 > li >           a.collapsed').addClass('expanded').removeClass('collapsed').parent().find('>   ul').show('blind');
  $.removeCookie('visible_state');
  $.cookie('visible_state', 'expanded', { path: '/', expires: 100 });
});
$('.collapse_all').click(function() {
  $('#menu3 > li >   a.expanded').addClass('collapsed').removeClass('expanded').parent().find('> ul').hide('blind');
  $.removeCookie('visible_state');
  $.cookie('visible_state', 'collapsed', { path: '/', expires: 100 });
});
}); 
```

我的.html

```
<div id="leftnav" style="clear:left;">
<div id="wrapper">
  <ul id="menu3" class="leftnavmenu">
    <li class="leftnavitem1"><a href="#" class="expanded">Category 1 <span>1</span>   </a>
      <ul>
    <li class="subitem1"><a href="#">Link 1 <span>1</span></a></li>
    <li class="subitem2"><a href="#">Link 2 <span>1</span></a></li>
    <li class="subitem3"><a href="#">Link 3 <span>1</span></a></li>
      </ul
    </li>
    <li class="leftnavitem2"><a href="#" class="expanded">Category 2 <span>1</span></a>
      <ul>
    <li class="subitem1"><a href="#">Link 1 <span>1</span></a></li>
    <li class="subitem2"><a href="#">Link 2 <span>1</span></a></li>
    <li class="subitem3"><a href="#">Link 3 <span>1</span></a></li>
      </ul>
    </li>
        <li class="leftnavitem3"><a href="#" class="collapsed">Category 3 <span>1</span></a>
      <ul>
    <li class="subitem1"><a href="#">Link 1 <span>1</span></a></li>
    <li class="subitem2"><a href="#">Link 2 <span>1</span></a></li>
    <li class="subitem3"><a href="#">Link 3 <span>1</span></a></li>
      </ul>
    </li>
    <li class="leftnavitem4"><a href="#" class="collapsed">Category 4  <span>1</span></a>
      <ul>
        <li class="subitem1"><a href="#">Link 1 <span>1</span></a></li>
    <li class="subitem2"><a href="#">Link 2 <span>1</span></a></li>
    <li class="subitem3"><a href="#">Link 3 <span>1</span></a></li>
      </ul>
    </li>
    <li class="leftnavitem5"><a href="#" class="collapsed">Category 5 <span>1</span></a>
      <ul>
            <li class="subitem1"><a href="#">Link 1 <span>1</span></a></li>
    <li class="subitem2"><a href="#">Link 2 <span>1</span></a></li>
        <li class="subitem3"><a href="#">Link 3 <span>1</span></a></li>
          </ul>
    </li>
  </ul>
 </div> 
```

我会在精神上买一杯咖啡吗？对于任何结束我的痛苦的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T12:11:28.197

`$.cookie`不存在。你用的是哪个插件？

否则我会建议使用[Amplify JS Store](http://amplifyjs.com/api/store/)。在 Html 5 时代，Cookie 并不是最好的存储方式。

# r - R将列分配给具有变量名称的数据框

> ID：12015481
> 
> 赞同：3
> 
> 时间：2012-08-18T03:02:45.210
> 
> 标签：r, syntax

分配给具有变量名称的数据框列。

```
getModified <- function(dframe, destination_string, foo, bar) {
    # complex calculations on foo and bar getting mynewcol here
    # ...

    # I want to add mynewcolumn with name in destination_string
    # if "blah" was the destination_string, the result would be as:
    #dframe$blah <- mynewcol
    #return(dframe)

    # what is the syntax for using the variable?
    # no luck here:
    dframe[, destination_string] <- mynewcolumn
    return(dframe)
  } 
```

这样我就可以打电话

```
dframe <- getModified(dframe, "nameofmynewcolum", foo, bar)
dframe$nameofmynewcolumn 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-18T03:08:49.483

语法是

```
dframe[[destination_string]] <- mynewcolumn 
```

例如，

```
getModified <- function(dframe, destination_string, foo) {
  dframe[[destination_string]] <- foo
  dframe
}
>     getModified(data.frame(A=1:10), "newColName", 11:20)
    A newColName
1   1         11
2   2         12
3   3         13
4   4         14
5   5         15
6   6         16
7   7         17
8   8         18
9   9         19
10 10         20 
```

# matlab - (matlab) qtdecomp 适用于 uint8 矩阵？

> ID：12015485
> 
> 赞同：1
> 
> 时间：2012-08-18T03:03:09.687
> 
> 标签：matlab

我还没有完全理解如何`qtdecomp`工作......

```
I = [1    1    1    1    2    3    6    6
     1    1    2    1    4    5    6    8
     1    1    1    1   10   15    7    7
     1    1    1    1   20   25    7    7
    20   22   20   22    1    2    3    4
    20   22   22   20    5    6    7    8
    20   22   20   20    9   10   11   12
    22   22   20   20   13   14   15   16];

S = qtdecomp(I,2);
disp(full(S)); 
```

结果是：

```
 4     0     0     0     1     1     2     0
   0     0     0     0     1     1     0     0
   0     0     0     0     1     1     2     0
   0     0     0     0     1     1     0     0
   4     0     0     0     1     1     1     1
   0     0     0     0     1     1     1     1
   0     0     0     0     1     1     1     1
   0     0     0     0     1     1     1     1 
```

在左下角的4*4矩阵中，块元素的最大值（22）减去最小值（20）是2，所以在分解这部分时，它会保持原样。

当我在`uint8`矩阵上执行此操作时：

```
I = uint8([...
     1    1    1    1    2    3    6    6
     1    1    2    1    4    5    6    8
     1    1    1    1   10   15    7    7
     1    1    1    1   20   25    7    7
    20   22   20   22    1    2    3    4
    20   22   22   20    5    6    7    8
    20   22   20   20    9   10   11   12
    22   22   20   20   13   14   15   16]);

S = qtdecomp(I,2/255);
disp(full(S)); 
```

答案和以前一样。但是当我改变`S`这个：

```
S = qtdecomp(I,1.9/255); 
```

答案是

```
 4     0     0     0     1     1     2     0
 0     0     0     0     1     1     0     0
 0     0     0     0     1     1     2     0
 0     0     0     0     1     1     0     0
 4     0     0     0     1     1     1     1
 0     0     0     0     1     1     1     1
 0     0     0     0     1     1     1     1
 0     0     0     0     1     1     1     1 
```

我想左下角的 4*4 矩阵应该分解，但为什么不分解呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T14:36:42.723

matlab 在这里所做的`I`是 uint8 何时将阈值乘以 255 并将其四舍五入，因此 1.9/255 被评估为 2。

您可以通过打开源代码`qtdecomp`（按 ctrl+D）或[此处查看](http://www4.hcmut.edu.vn/~huynhqlinh/TinhocDC/WebLQNguyen/matlab/tai%20lieu/MATLAB6_COURSE/WORK/IMAGES/IMAGES/QTDECOMP.M)。文件末尾附近有一个 if/elseif ( `params{1} = round(255 * params{1});`)。

您应该能够使用`S = qtdecomp(I,1/255);`来获得您正在寻找的结果。

# c# - C#：form.Close 方法、FormClosing 事件和 CloseReason 事件参数。设置自定义 CloseReason？

> ID：12015486
> 
> 赞同：2
> 
> 时间：2012-08-18T03:03:40.093
> 
> 标签：c#, winforms, events

我正在开发一个使用 FormClosing 事件的基于 C# 的实用程序，并且该事件应该根据表单是否通过 form.Close() 以编程方式关闭而做不同的事情；方法，或任何其他方式（用户单击 X、程序退出等）

FormClosing 事件中的 FormClosingEventArgs 有一个名为 CloseReason 的属性（枚举类型 CloseReason）。

CloseReason 可能是：无、WindowShutDown、MdiFormClosing、UserClosing、TaskManagerClosing、FormOwnerClosing、ApplicationExitCall。

理想情况下，有一种方法可以区分用户何时单击红色 X，以及何时单击 Close(); 方法被调用（通过在执行其他操作后单击继续按钮）。但是，FormClosingEventArgs 中的 CloseReason 属性在这两种情况下都设置为 UserClosing，因此无法区分用户何时有意关闭表单，以及何时以编程方式关闭表单。这与我的预期相反，即如果 Close() 方法被任意调用，CloseReason 将等于 None。

```
 //GuideSlideReturning is an cancelable event that gets fired whenever the current "slide"-form does something to finish, be it the user clicking the Continue button or the user clicking the red X to close the window. GuideSlideReturningEventArgs contains a Result field of type GuideSlideResult, that indicates what finalizing action was performed (e.g. continue, window-close)

    private void continueButton_Click(object sender, EventArgs e)
    { //handles click of Continue button
        GuideSlideReturningEventArgs eventArgs = new GuideSlideReturningEventArgs(GuideSlideResult.Continue);
        GuideSlideReturning(this, eventArgs);
        if (!eventArgs.Cancel)
            this.Close();
    }

    private void SingleFileSelectForm_FormClosing(object sender, FormClosingEventArgs e)
    { //handles FormClosing event
        if (e.CloseReason == CloseReason.None)
            return;
        GuideSlideReturningEventArgs eventArgs = new GuideSlideReturningEventArgs(GuideSlideResult.Cancel);
        GuideSlideReturning(this, eventArgs);
        e.Cancel = eventArgs.Cancel;
    } 
```

问题是当 Close(); 在事件 GuideSlideReturning 完成后调用方法而没有被取消，FormClosing 事件处理程序无法判断表单是通过该方法关闭而不是被用户关闭。

理想的情况是，如果我可以定义 FormClosing 事件的 FormClosingEventArgs CloseReason 将是什么，如下所示：

```
 this.Close(CloseReason.None); 
```

有没有办法做到这一点？form.Close(); 方法没有任何接受任何参数的重载，所以有我可以设置的变量或我可以调用的替代方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T03:14:19.320

在以编程方式调用 close 之前设置一个标志。这可以包含在一个私有方法中：

```
private bool _programmaticClose;

// Call this instead of calling Close()
private void ShutDown()
{
    _programmaticClose = true;
    Close();
}  

protected override void OnFormClosing(FormClosingEventArgs e)
{
    base.OnFormClosing();
    _programmaticClose = false;
} 
```

# c# - 将字符串作为文本文件上传到 SkyDrive？

> ID：12015487
> 
> 赞同：1
> 
> 时间：2012-08-18T03:03:41.843
> 
> 标签：c#, onedrive

我正在尝试将 C# 与 Live Connect API 一起使用，将空白（或显示“测试”的）文本文件上传到 SkyDrive。我到目前为止的代码：

```
LiveConnectClient client = await LiveSignin();
string folderID = await getFolder(client);
client.BackgroundUploadAsync(folderID, "pins.txt", "", OverwriteOption.Rename); 
```

其中 LiveSignin() 是一个处理登录代码并返回 LiveConnectClient 的函数，而 getFolder(LiveConnectClient client) 是一个获取我要上传到的文件夹 ID 的函数。

该代码抛出一个关于空白字符串（最后一行的第三个参数）必须是“Windows.Storage.Streams.IInputStream”的错误，但我似乎找不到任何关于如何将字符串转换为 IInputStream 的文档，或者，就此而言，我可以找到关于“IInputStream”的大部分文档。

对于早期版本的 Windows 运行时/实时连接（在另一个项目中），我使用过：

```
byte[] byteArray = System.Text.Encoding.Unicode.GetBytes(Doc);
MemoryStream stream = new MemoryStream(byteArray);
App.client.UploadCompleted += client_UploadCompleted;
App.client.UploadAsync(roamingSettings.Values["folderID"].ToString(), docTitle.Text + ".txt", stream); 
```

但是现在会引发很多错误（其中大部分是因为 UploadAsync 已被 BackgroundUploadAsync 取代）。

那么，有没有办法将字符串转换为 IInputStream，或者我什至不需要使用 IInputStream？如果我的方法不起作用，如何从 C# Metro 应用程序将空白文本文件上传到 SkyDrive？（在 Visual Studio 2012 Express 中对 Windows 8 Enterprise 的评估进行开发，如果这有很大的不同的话）

编辑：我终于找到了“Stream.AsInputStream”，但现在我遇到了与[此相同的错误](http://social.msdn.microsoft.com/Forums/en-US/messengerconnect/thread/2292cd84-d0cc-4f03-b0f8-a3622db154d0)

> Windows.Foundation.winmd 中发生了“System.AccessViolationException”类型的未处理异常
> 
> 附加信息：试图读取或写入受保护的内存。这通常表明其他内存已损坏

现在的代码：

```
LiveConnectClient client = await LiveSignin();
string folderID = await getFolder(client);
Stream OrigStream = new System.IO.MemoryStream(System.Text.UTF8Encoding.UTF8.GetBytes("test"));
LiveOperationResult result = await client.BackgroundUploadAsync(folderID, "pins.txt", OrigStream.AsInputStream(), OverwriteOption.Rename); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T14:16:11.737

你好

今天遇到了同样的问题，据我所知，解决这个问题的唯一方法是先将您的文本写入本地文件，然后再上传。

我的解决方案如下所示：

```
var tmpFile= await ApplicationData.Current.
                       LocalFolder.CreateFileAsync
                         ("tmp.txt", CreationCollisionOption.ReplaceExisting);

using (var writer = new StreamWriter(await tmpFile.OpenStreamForWriteAsync()))
{
    await writer.WriteAsync("File content");
}
var operationResult = 
      await client.BackgroundUploadAsync(folderId, tmpFile.Name, tmpFile,
                                          OverwriteOption.Overwrite); 
```

# iphone - 对于 iOS，如何使“任何 iOS SDK”与 Distribution 的代码签名身份一起工作？

> ID：12015491
> 
> 赞同：0
> 
> 时间：2012-08-18T03:05:35.360
> 
> 标签：iphone, ios, code-signing

几个小时以来，我试图使代码与分发代码签名一起工作，以便将其上传`.app`到 App Store（作为`.zip`）。

似乎在“构建设置”选项卡中，如果“任何 iOS SDK”设置为开发人员，那么它可以在物理 iPhone 4S 设备上运行，只是给出警告

```
warning: Application failed codesign verification.  The signature was invalid, 
  contains disallowed entitlements, or it was not signed with an 
  iPhone Distribution Certificate. (-19011) 
```

但至少它可以在真正的 iPhone 4S 上运行。如果“任何 iOS SDK”设置为分发，那么它现在会转到 Organizer 并显示：

```
A valid provisioning profile for this executable was not found 
```

但是我已经去Apple Developer网站，为App Store创建了分发证书，并添加到钥匙串，并添加到Organizer，并且在Organizer中右键单击iPhone 4S并选择“将设备添加到Provisioning Portal”。

我什至试过重启Xcode，然后重启整台机器，还是一样的。

有没有办法解决这个问题？似乎问题在于代码签名“任何iOS SDK”，而不是我的代码。（Xcode 4.3 正在 Lion 上使用）。

也许如果只有一个按钮可以为您下载证书，添加它，并告诉您在 Build Settings 选项卡中将什么设置设置为 Distribution ，然后制作`.app`，压缩并上传它，那么开发人员将不会花费几个小时甚至 2、3 天只是为了让它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:20:49.067

看到这个帖子。我将编辑 Xcode 项目并删除“任何 iOS SDK”设置。根据我的经验，这是错误的。

[https://stackoverflow.com/a/13627750/276626](https://stackoverflow.com/a/13627750/276626)

# rest - 使用 XML Schema 指定资源模型

> ID：12015493
> 
> 赞同：0
> 
> 时间：2012-08-18T03:05:59.637
> 
> 标签：rest, xsd, hateoas

我需要为 RESTful Web 服务正式指定一个资源模型，并且我正在考虑将 XML Schema 作为一种规范语言。理想情况下，这种资源模型将促进 HATEOAS 风格的客户端开发。一些问题：

1) XML Schema 是正式指定 Web 资源的最佳选择吗？2) 是否应将每个资源标识为自定义媒体类型？3) 是否可以将资源的链接关系集定义为其模式规范的一部分？

谢谢，卡梅伦。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T20:26:49.100

我们正在使用这个

[http://stateless.co/hal_specification.html](http://stateless.co/hal_specification.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-18T03:16:44.150

是的，您可以使用 XML Schema 进行定义，但您无需重新发明轮子。[WADL](http://www.w3.org/Submission/wadl/)是您正在寻找的。来自[维基百科](http://en.wikipedia.org/wiki/Web_Application_Description_Language)

> Web 应用程序描述语言 (WADL) 是基于 HTTP 的 Web 应用程序（通常是 REST Web 服务）的机器可读 XML 描述。[1](http://www.w3.org/Submission/wadl/) WADL 对服务提供的资源以及它们之间的关系进行建模。[1](http://www.w3.org/Submission/wadl/) WADL 旨在简化基于 Web 现有 HTTP 架构的 Web 服务的重用。[1](http://en.wikipedia.org/wiki/Web_Application_Description_Language)它独立于平台和语言，旨在促进应用程序在 Web 浏览器中基本使用之外的重用。

[你需要WADL吗？](http://bitworking.org/news/193/Do-we-need-WADL)

# php - 如何快速（呃）“获得最近”的位置？

> ID：12015495
> 
> 赞同：-1
> 
> 时间：2012-08-18T03:06:16.707
> 
> 标签：php, mysql, maps

目前我有一个网络应用程序，它使用谷歌地图 API 来获取一个位置（商店）和其他位置列表（技术）之间的距离，因为它全部缓存在数据库中，它只需要运行一次。但是第一次速度很慢......

我现在需要做的是为客户做一个前端，在那里他们可以输入他们的地址并找到最近的商店。由于存在商店的基调，尝试获取每家商店的地址并使用 Google Maps API 将其与客户地址进行比较将需要很长时间。

那么有什么技术可以让这个速度更快呢？是否可以过滤掉大部分经纬度差异的地址？或者他们是一种 API 方法，我可以给谷歌地图提供一长串地址并让它返回最近的地址？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T03:18:19.477

您应该做的是将商店添加到数据库时还包括它们的纬度/经度。这样，当用户输入他们的地址时，您只需要对他们的地址进行地理编码（获取纬度/经度），并使用 hasrsine 公式（这只是数学，因此运行速度很快）来获取最近的位置。

[https://developers.google.com/maps/articles/phpsqlsearch_v3](https://developers.google.com/maps/articles/phpsqlsearch_v3)

您可以使用[google geocoding api](https://developers.google.com/maps/documentation/geocoding/)来获取/插入数据库中已有商店的纬度/经度。

我目前有一个定位器，它可以搜索数万家商店，并使用这种方法在一秒钟内执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T03:11:46.053

不幸的是，谷歌地图 API 中没有这样的功能，您必须自己实现它。一个好的开始是存储位置地理位置和空间索引的 mysql 点数据类型。空间索引降低了维度复杂性并使最近邻查找变得简单。空间索引是 r 树和空间填充曲线，例如希尔伯特曲线。这是一篇关于希尔伯特曲线的好文章：http: [//blog.notdot.net/2009/11/Damn-Cool-Algorithms-Spatial-indexing-with-Quadtrees-and-Hilbert-Curves](http://blog.notdot.net/2009/11/Damn-Cool-Algorithms-Spatial-indexing-with-Quadtrees-and-Hilbert-Curves)。这是使用 mysql 的空间索引的示例：[使用 mysql 表上的空间索引选择最近的地理坐标不起作用](https://stackoverflow.com/questions/10445429/selecting-nearest-geo-coordinates-using-spatial-index-on-mysql-table-not-working)。这是一个mysql距离函数的例子[使用 MySql 中的空间函数查找两个坐标之间距离的正确方法](https://stackoverflow.com/questions/5324908/correct-way-of-finding-distance-between-two-coordinates-using-spatial-function-i)。这是 MySql 5.1 [http://www.elevatedcode.com/articles/2009/03/06/speeding-up-location-based-searches/](http://www.elevatedcode.com/articles/2009/03/06/speeding-up-location-based-searches/)的示例。

# javascript - JS文件乱序

> ID：12015498
> 
> 赞同：1
> 
> 时间：2012-08-18T03:07:32.927
> 
> 标签：javascript, file, namespaces

我的 javascript 文件有一个非常令人沮丧的问题。我有一个包含 page_data、实用程序、模块等命名空间的全局命名空间。

我的目录如下所示： /utilities/single_utility.js /modules/module.js 等 tec

无论如何，我在模块之前加载实用程序（使用实用程序）但不断遇到问题。

我的加载程序脚本看起来像这样（它包含在 SEAF 中）：

```
 for (var index in file_list) {

    var url = file_list[index];
    var new_script = document.createElement('script');

    new_script.setAttribute("type", "text/javascript");
    new_script.setAttribute("src", url);

    element.appendChild(new_script);
} 
```

Project 是我的全局命名空间，它包含所有这些其他命名空间。但是，当我尝试使用 Project.utilities.session.exist() 等在我的一个模块中引用实用程序时，有时会引发无法找到 Project 的错误？

我该如何解决这个问题以确保我的文件正确加载或者我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T03:21:40.410

使用`async = false`应该保护您的加载顺序。

这是我用来加载和维护秩序的快速片段。

```
var loadScript = function( url ) {
    if (url) {
        var doc = document,
        t = doc.createElement("script"),
        s = doc.getElementsByTagName("script")[0];
        t.type = "text/javascript";
        // Keep script order!
        t.async = false;
        t.src = url;
        s.parentNode.insertBefore(t, s);
    }
}; 
```

[来自MDN](https://developer.mozilla.org/en-US/docs/HTML/Element/Script)和[Microsoft](http://ie.microsoft.com/testdrive/Performance/AsyncScripts/Default.html)的一些支持此逻辑（以及关于浏览器支持）的参考资料

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T03:13:25.980

当您将脚本标签添加到页面时，浏览器必须出去下载这些脚本。无法保证它们会按照您创建它们的顺序下载和执行。

您将需要在加载`new_script`时添加一个事件侦听器，或者`onload`或`onreadystatechange`，具体取决于浏览器。但我确实建议使用脚本加载库（例如[RequireJS](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CGYQFjAA&url=http://requirejs.org/&ei=XwgvUOb3MMWbyAGOu4DACQ&usg=AFQjCNERfzgXOtsmWRCgzEpE24d0O5Somg&sig2=qmuQt1cF1WlDoyCV6qWiMQ)）来为您处理所有令人讨厌的细节。

顺便说一句，为什么不直接将所有脚本标签添加到您的页面？在这种情况下，它们会按顺序加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T03:50:24.037

最好使用脚本加载器解决此问题。

正如马特所说，如果您还想处理脚本依赖项，[RequireJS是一个不错的选择。](http://requirejs.org/)

仅用于脚本加载，您可以查看[LAB.js](http://labjs.com/)，它非常小且简单：

```
for (var index in file_list) {
    $LAB.script(file_list[index]);
} 
```

如果脚本具有依赖关系并且必须按顺序加载，您可以使用`.wait()`, 来保留脚本返回的链对象。您可以重新编写循环以保留链：

```
var chain;
for (var index in file_list) {
    if (!chain) { 
         chain = $LAB.script(file_list[index]).wait(); 
    } else {
         chain.script(file_list[index]).wait();
    }
} 
```

或者干脆忘记`file_list`数组并直接使用 $LAB ：

```
$LAB.script('file1.js').wait()
    .script('file2.js').wait()
    /* ... */ 
```

# c++ - OpenGL alpha 混合有时会创建黑色四边形

> ID：12015508
> 
> 赞同：0
> 
> 时间：2012-08-18T03:09:13.183
> 
> 标签：c++, opengl, alphablending

我试图通过在场景上放置半透明的黑色四边形来为 2D OpenGL 场景制作简单的阴影，但在某些地方，它不会使场景变暗，而是完全将其涂黑。我正在使用`glBlendFunc(GL_DST_COLOR, GL_SRC_ALPHA)`着色器四边形以及`glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA)`下面的所有其他绘图。

这通常有效，使半透明四边形下方的区域变暗，但在某些情况下，它的行为很奇怪。当半透明四边形下方的区域仅在其后面绘制了一个四边形时，它的行为正常。当在后四边形的顶部绘制另一个四边形（或多个四边形）时，它有时会正常运行，有时会完全涂黑四边形，或者有时会涂黑最后绘制的四边形下方的所有内容（例如，如果我有一个带有上面的蓝点，下面的红色会变黑，但蓝点会保持不变）。

我认为这看起来像是以错误的顺序绘制四边形，但我已`GL_DEPTH_TEST`禁用，所以我不确定这是否是混合、错误顺序或完全其他原因的奇怪行为。关于可能导致这种情况的任何想法？

# bouncycastle - 创建 BKS 密钥库时出现 keytool 错误：providerpath is not a legal command

> ID：12015512
> 
> 赞同：1
> 
> 时间：2012-08-18T03:09:57.557
> 
> 标签：bouncycastle, keystore, keytool

我正在尝试使用 keytool（在 Mac OS X 上使用终端应用程序）创建一个“bks”密钥库。我按照以下说明进行操作：
[keytool error: java.security.KeyStoreException: BKS not found](https://stackoverflow.com/questions/6866447/keytool-error-java-security-keystoreexception-bks-not-found)

这是我的用法：

```
keytool -genkeypair -v -alias androiddebugkey -keyalg RSA -keysize 2048 -validity 10000 -keypass android -keystore /Users/djames/dropbox/bc146keystore/debug.keystore -storepass android -storetype BKS -providerclass org.bouncycastle.jce.provider.BouncyCastleProvider –providerpath /Users/djames/dropbox/bc146keystore/bcprov-jdk16-146.jar -dname "CN=Android Debug, OU=Android, O=Android, L=Whitefish, S=MT, C=US" 
```

我收到以下错误：

```
keytool error: java.lang.RuntimeException: Usage error, ?providerpath is not a legal command
java.lang.RuntimeException: Usage error, ?providerpath is not a legal command
    at sun.security.tools.KeyTool.parseArgs(KeyTool.java:375) 
```

我`-provider path` 在无数网络帖子（包括上面的帖子）中看到了推荐的选项，当我运行它时，`keytool -help`它确认语法是合法的：

```
keytool usage:  ...   
-genkeypair  [-v] [-protected]
         [-alias <alias>]
         [-keyalg <keyalg>] [-keysize <keysize>]
         [-sigalg <sigalg>] [-dname <dname>]
         [-validity <valDays>] [-keypass <keypass>]
         [-keystore <keystore>] [-storepass <storepass>]
         [-storetype <storetype>] [-providername <name>]
         [-providerclass <provider_class_name> [-providerarg <arg>]] ...
         [-providerpath <pathlist>] 
```

我还尝试了以下替代方法（根据[http://docs.oracle.com/javase/6/docs/technotes/guides/security/crypto/CryptoSpec.html](http://docs.oracle.com/javase/6/docs/technotes/guides/security/crypto/CryptoSpec.html)）：

1.  删除命令的`-providerpath`选项，`keytool`
2.  把`bcprov-jdk16-146.jar`里面的`{$JAVA_HOME/lib/ext}`文件夹
3.  添加`security.provider.3=org.bouncycastle.jce.provider.BouncyCastleProvider`到 java.security 文件。

但它仍然失败了。

关于我可以做些什么来成功创建 BKS 密钥库的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-06-25T10:25:15.467

从那以后已经很多年了，但我也在尝试这个。

答案是您的参数顺序错误。-providerpath 需要位于 -providerclass 参数**之前。**

我希望这对将来寻找解决方案的人有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T02:15:45.787

我从来没有能够成功使用 Keytool。这就是我为解决问题所做的：我复制了由 Eclipse（Indigo，SR2）第一次在 Eclipse 中运行 Android 程序时自动创建的默认 debug.keytool（一个 JKS 类型密钥库），并且使用 Portecle (http://portecle.sourceforge.net/) 将其转换为 BKS 类型的密钥库。现在这是棘手的部分：如果我现在使用 debug.keytool 的 BKS 版本代替原来的版本，每当我尝试运行安卓程序。但是，如果我将 debug.keytool 的原始 JKS 版本留在 Eclipse 创建它的默认目录中，那么我可以在 Android 程序中使用 debug.keytool 的 BKS 版本 s /resources/raw 子文件夹并让 Android 打开它并识别它。吉姆

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-09T10:30:36.047

一个简单的替代方法是使用[Portecle](http://sourceforge.net/projects/portecle/)生成 BKS：

1.  下载所需的[Boucycastle Provider](http://mvnrepository.com/artifact/org.bouncycastle/bcprov-jdk15on/1.46)
2.  替换 Portecle 安装目录中的 bcprov.jar（例如：）`C:\Program Files (x86)\Portecle\bcprov.jar`。需要相同的命名。
3.  重新启动 Portecle 并生成您的 BKS 信任库。

更多解释[在这里](https://joinup.ec.europa.eu/svn/spocs/eSafe/trunk/WP_Supplemental/Cert_Inspect_Portecle-1.7/README.txt)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-24T11:52:17.093

我正在尝试使用证书进行 SSL 连接，因此为了支持 Android，我需要使用 jks / bks 文件作为信任库。

> 因此生成的 jks 文件在 android SSLSocket 连接中尝试，但抛出 jks 无法读取的异常。所以我必须将 Boncycastle 提供程序添加到 JVM 并使用 jks 文件创建 bks

下载 Bouncycastle 提供程序 jar 文件并放在以下路径下：

```
C:\Program Files\Java\jre1.8.0_191\lib\ext 
```

通过为以下文件添加提供程序来更新 java.security 文件

```
C:\Program Files\Java\jre1.8.0_191\lib\security\java.security 
```

添加提供者

```
security.provider.12=org.bouncycastle.jce.provider.BouncyCastleProvider 
```

关闭命令提示符并打开执行命令以获取 bks 文件，如下所示：

```
keytool -importkeystore -srckeystore <input>.jks -destkeystore <required_bks_file_name>.bks -srcstoretype JKS -deststoretype BKS -srcstorepass <jsk file password> -deststorepass <jsk file password> -provider org.bouncycastle.jce.provider.BouncyCastleProvider 
```

现在您可以在您的文件夹中创建 bks 文件。

谢谢

# asp.net - ASP.NET 取消下载

> ID：12015520
> 
> 赞同：0
> 
> 时间：2012-08-18T03:12:51.343
> 
> 标签：asp.net

我的页面中有一个下载按钮，如果单击该按钮，Firefox 或 Internet Explorer 中会弹出一个对话框，提示“您要打开还是保存文件？” .. 弹出窗口来自浏览器本身。

场景是，如果用户在站点上单击注销，如果他单击保存或打开文件，是否有可能下载失败。对我来说似乎无法阻止..

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T03:28:10.150

不，对文件的请求在单击时已通过身份验证，并且在注销后仍然有效。

# python - Python 3 与 Python 2 映射行为

> ID：12015521
> 
> 赞同：20
> 
> 时间：2012-08-18T03:13:10.357
> 
> 标签：python, python-3.x, map-function

在 Python 2 中，一个常见的（旧的、遗留的）习惯用法是`map`使用如下形式连接长度不均匀的迭代器`map(None,iter,iter,...)`：

```
>>> map(None,xrange(5),xrange(10,12))
[(0, 10), (1, 11), (2, None), (3, None), (4, None)] 
```

在 Python 2 中，它被扩展，使得*最长*的迭代器是返回列表的长度，如果一个比另一个短，它用`None`.

在 Python 3 中，这是不同的。首先，您不能`None`用作位置 1 的可调用对象的参数：

```
>>> list(map(None, range(5),range(10,12)))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'NoneType' object is not callable 
```

好的——我可以这样解决：

```
>>> def f(*x): return x    
... 
>>> list(map(f, *(range(5),range(10,12))))
[(0, 10), (1, 11)] 
```

但是现在，我有一个不同的问题：`map`返回*最短*迭代器的长度——不再用`None`.

当我将 Python 2 代码移植到 Python 3 时，这并不是一个可怕的罕见习语，而且我还没有找到一个简单的解决方案。

不幸的是，2to3 工具[没有](http://blog.bitsrc.org/2009/10/of-python3s-map.html)选择这一点——无益地建议：

```
-map(None,xrange(5),xrange(10,18))
+list(map(None,list(range(5)),list(range(10,18)))) 
```

建议？

* * *

*编辑*

有一些关于这个成语有多普遍的讨论。[请参阅此 SO 帖子](https://stackoverflow.com/questions/1277278/python-zip-like-function-that-pads-to-longest-length)。

我正在更新*我还在上高中时编写的遗留代码。*查看 Raymond Hettinger 正在[编写和讨论](http://mail.python.org/pipermail/python-dev/2003-August/037636.html)的 2003 Python 教程，其中指出了 map 的这种特定行为......

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-18T03:17:58.270

[`itertools.zip_longest`](http://docs.python.org/py3k/library/itertools.html#itertools.zip_longest)做你想做的事，用一个更容易理解的名字。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T07:01:54.920

这次我会回答我自己的问题。

使用 Python 3x，您可以像这样使用[itertools.zip_longest](http://docs.python.org/release/3.1.5/library/itertools.html#itertools.zip_longest)：

```
>>> list(map(lambda *a: a,*zip(*itertools.zip_longest(range(5),range(10,17)))))
[(0, 10), (1, 11), (2, 12), (3, 13), (4, 14), (None, 15), (None, 16)] 
```

我想你也可以自己动手：

```
>>> def oldMapNone(*ells):
...     '''replace for map(None, ....), invalid in 3.0 :-( '''
...     lgst = max([len(e) for e in ells])
...     return list(zip(* [list(e) + [None] * (lgst - len(e)) for e in ells]))
... 
>>> oldMapNone(range(5),range(10,12),range(30,38))
[(0, 10, 30), (1, 11, 31), (2, None, 32), (3, None, 33), (4, None, 34), (None, None, 35), (None, None, 36), (None, None, 37)] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-05-12T20:30:51.603

如果您需要 Python 2 中的一些过时功能，则一种方法是另一种方法 - 自己编写。当然，它不是内置功能，但至少它是一些东西。

下面的代码片段需要 27 行

```
#!/usr/bin/env python3

def fetch(sequence, index):
  return None if len(sequence) <= index else sequence[index]

def mymap(f, *args):
  max_len = 0
  for i in range(len(args)): 
      max_len = max(max_len, len(args[i]))
  out = []
  for i in range(max_len):
      t = []
      for j in range(len(args)): 
          t.append(fetch(args[j],i))      

      if f != None:
          # Use * for unpack arguments from Arbitarily argument list
          # Use ** for unpack arguments from Keyword argument list
          out.append(f(*t))
      else:
          out.append(tuple(t))
  return out 

if __name__ == '__main__':
    print(mymap(None, [1,2,3,4,5],[2,1,3,4],[3,4]))
    print(mymap(None,range(5),range(10,12))) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-11-28T07:33:27.317

你可以像这样解决问题： `list(map(lambda x, y: (x, y),[1, 2, 3 ,4, 5], [6, 7, 8, 9, 10]))`

# mysql - MySQL为其他列中的每个不同值显示具有最新日期的行？

> ID：12015529
> 
> 赞同：0
> 
> 时间：2012-08-18T03:15:03.603
> 
> 标签：mysql, sql, greatest-n-per-group

我正在使用一个 mysql 查询，该查询应该选择用户寻址或发送的所有消息。我需要对具有相同 UID 的所有消息进行分组，以便为​​每个不同的用户显示一个线程（这意味着它应该消除除最后一个具有相同 UID 的消息之外的所有消息）。我的问题是我开始使用 GROUP BY 来执行此操作，但有时剩余的行实际上是旧消息而不是最新消息。

这就是我正在尝试的：

```
SELECT `UID`, `Name`, `Text`, `A`.`Date`
FROM `Users`
INNER JOIN (
    (
    SELECT *, To_UID AS UID FROM `Messages` WHERE `From_UID` = '$userID' AND `To_UID` != '$userID'
    )
    UNION ALL
    (
    SELECT *, From_UID AS UID FROM `Messages` WHERE `To_UID` = '$userID' AND `From_UID` != '$userID'
    )
) AS A
ON A.UID = Users.ID
    GROUP BY UID // This doesn't work 
```

如何仅显示每个 UID 重新发送日期最多的行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T03:22:57.787

use`DISTINCT`和 only use`ORDER BY date`
`GROUP BY`实际上有时会显示随机行，这并不总是经常讨论的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T04:09:13.667

你可以尝试这样的事情：

```
select UID, Name, Text, c.date 
from User
inner join (
    select if(b.From_UID = '$userID', b.To_UID, b.From_UID) as UID, 
           * 
           from Messages as b 
           inner join(
               select if(c.From_UID = '$userID', c.To_UID, c.From_UID) as UID, 
                     max(c.date) as date 
                     from Messages as c
                     where c.From_UID = '$userID' or c.To_UID = '$userID' 
                     group by UID
            ) as d on d.date = b.date and d.UID = b.UID
     ) as e on e.UID = Users.id
) 
```

或创建一个临时表/存储过程，让生活更轻松

温度表

```
create temp table t 
    select if(From_UID = '$userID', To_UID, From_UID) as UID, * from Messages

select UID, Name, Text, date
from User
inner join (
    select * 
        from t as t1
        inner join( 
            select 
                t2.UID, 
                max(t2.date) as date
                from t as t2
                group by t2.UID
         ) as t3 on t3.date =  t1.date and t3.UID = t1.UID
    ) as e on e.UID = Users.id 
```

# c# - C#中的格式化字符串

> ID：12015530
> 
> 赞同：0
> 
> 时间：2012-08-18T03:15:20.333
> 
> 标签：c#, string

如何将此字符串列表转换为用引号括起来的逗号分隔值，而无需任何转义字符？

```
{"apple", "berry", "cherry"} => well, ""apple", "berry", "cherry"" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T03:18:52.300

如果我理解正确的话，

```
"\"" + String.Join("\", \"", new string[]{"apple","berry","cherry"}) + "\""; 
```

或者，或者，

```
String.Format("\"{0}\"", String.Join("\", \"", new string[] {"apple","berry","cherry"})); 
```

阅读更多关于[System.String.Join(...)](http://msdn.microsoft.com/en-us/library/0h8wc12c)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T03:19:58.837

希望这能完成工作

```
var ar = new []{ "apple", "berry", "cherry" };
var separator = "\",\"";
var enclosingTag = "\"";
Console.WriteLine ( enclosingTag + String.Join(separator, ar) + enclosingTag ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T05:16:05.103

如果您使用 C#：

```
using System;
string[] arr = new string[] { "apple", "berry", "cherry" };
string sep = "\",\"";
string enclosure = "\"";
string result = enclosure + String.Join(sep, arr) + enclosure; 
```

# ios4 - 接收者没有标识符的segue

> ID：12015531
> 
> 赞同：3
> 
> 时间：2012-08-18T03:15:52.050
> 
> 标签：ios4

我有一个问题，我整天都坐着。在这个超级视图中，我有一个包含 UIPageControl 和 UIScrollView 的超级视图。我创建了一个包含三个图像、三个标签和三个按钮的子视图。每个按钮都有一个修饰事件。当按钮事件被触发时，超级视图将被一个新视图提升。为此，我创建了一个与超级视图和新视图相连的 segue。这是超级视图中的连接代码。

```
`                    
<connections>
    <outlet property="pageControl" destination="ivy-0Q-UQo" id="rGm-sh-mdE"/>
    <outlet property="scrollView" destination="4Yu-Qb-kbF" id="aqY-ou-cv4"/>
    <segue destination="zZo-CH-P2Y" kind="push" id="xBU-ZO-u7s"/>
</connections> 
```

`

这段代码将保证超级视图和新视图之间的连接没问题，这里是修饰事件代码。

```
WelcomeFrameViewController *welcomeFrameVC = [WelcomeFrameViewController alloc];  //super view instance
NSLog(@"=======================");
[welcomeFrameVC performSegueWithIdentifier: @"ForwardToLogin" sender: self]; 
```

当我运行程序时，编译器抱怨

```
2012-08-20 10:17:02.325 TTRen[2440:f803] ============44=========== 
```

2012-08-20 10:17:02.352 TTren [2440:f803] ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“接收方 WelcomeFrameViewController：0x688e960 没有标识符为“ForwardToLogin”的segue

我是iOS新手，任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-06T11:32:02.313

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T04:39:03.140

> 'Receiver WelcomeFrameViewController: 0x688e960 没有带有标识符'ForwardToLogin'的segue'

在你的故事板中，检查你是否真的有一个名为“ForwardToLogin”的segue

# vbscript - 如何在 VBScript 中为 GetFolder 提供变量路径？

> ID：12015536
> 
> 赞同：0
> 
> 时间：2012-08-18T03:16:32.780
> 
> 标签：vbscript

该脚本基本上会转到一个文件夹并列出该文件夹中的所有文件并将其输出为 txt 文件。现在，我不想定义文件夹路径，而是希望它使用其中包含一堆文件夹路径的 txt 文件，并且我想循环该 txt 文件。我怎样才能做到这一点？

```
Dim fso
Dim ObjFolder
Dim ObjOutFile
Dim ObjFiles
Dim ObjFile

'Creating File System Object
Set fso = CreateObject("Scripting.FileSystemObject")

'Getting the Folder Object
Set ObjFolder = fso.GetFolder("C:\Users\Susan\Desktop\Anime\ova")

'Creating an Output File to write the File Names
Set ObjOutFile = fso.CreateTextFile("C:\Users\Susan\Documents\iMacros\Macros\WindowsFiles.txt")

'Getting the list of Files
Set ObjFiles = ObjFolder.Files

'Writing Name and Path of each File to Output File
For Each ObjFile In ObjFiles
    ObjOutFile.WriteLine(ObjFile.Path)
Next

ObjOutFile.Close 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T12:00:06.370

Ruriko，这应该是一个工作版本，我会添加一个检查输入文件是否存在，我相信你可以自己做。

```
Dim fso, ObjFolder, ObjOutFile, ObjFiles, ObjFile, outputFile, inputFileList
Const ForReading = 1, ForWriting = 2, ForAppending = 8, CreateIfNeeded = true

inputFileList = "list.txt"
outputFile = "C:\Users\Susan\Documents\iMacros\Macros\WindowsFiles.txt"
Set fso = CreateObject("Scripting.FileSystemObject")
Set objTextFile = fso.OpenTextFile(inputFileList, ForReading)

Do Until objTextFile.AtEndOfStream
 sFolderName = objTextFile.Readline
 wscript.Echo "writing contents of " & sFolderName
 writefilenames(sFolderName)
Loop

function writefilenames(sFolderName)
  Set ObjFolder = fso.GetFolder(sFolderName)

  If fso.FileExists(outputFile) Then
    Set ObjOutFile = fso.OpenTextFile(outputFile, ForAppending)
  Else
    Set ObjOutFile = fso.OpenTextFile(outputFile, ForWriting, CreateIfNeeded)
  End If

  Set ObjFiles = ObjFolder.Files

  For Each ObjFile In ObjFiles
    ObjOutFile.WriteLine(ObjFile.Path)
  Next

  ObjOutFile.Close
end function 
```

# javascript - console.log() 在 Safari 6.0 Web Inspector 中不起作用

> ID：12015540
> 
> 赞同：23
> 
> 时间：2012-08-18T03:16:43.683
> 
> 标签：javascript, safari6

```
console.log('hi');

undefined 
```

6.0有类似的实现吗？还是我做错了什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2016-05-24T02:45:02.247

确保在控制台窗口顶部选择“全部”。有时它会自动切换为仅显示错误、警告或日志。如果您选择“全部”，那么您应该会看到所有的`console.log()`s！

[![在此处输入图像描述](../Images/68906e19b4bbd7a5db014a1280620863.png)](https://i.stack.imgur.com/Nxfoq.jpg)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-08-19T08:44:21.443

我发现了问题！日志不会出现在交互式控制台（位于底部）中，而是出现在当前日志窗口中！您可以通过`Develop > Show Error Console`或 Web Inspector 中最右侧的源图标访问它。

这么奇怪！在控制台中获得简单的输出有那么难吗，比如`puts`在`print`Ruby 中？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-04-18T18:29:15.267

不是首选，但它有效。

`console.error(message);`

注意：我正在跑步`gulp serve -d -w`，其中包括手表。即使这样，在我重新启动 gulp 之前我也看不到这些消息。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-18T04:22:28.460

我必须开发“for Safari”作为我的主要目标，但由于 Chrome 和 Safari 都使用 WebKit 作为它们的引擎，它们在执行上几乎相同（一个区别是 Safari 将日期字符串解析为更差的日期）。

因此，只要您在签入代码之前在 Safari 中进行最后的健全性检查，在 Chrome 中进行调试和开发通常就足够了。

话虽如此，我编写了一个控制台包装器，它使我能够`console.log`在任何浏览器中调用......如果它支持 console.log，那么它就可以工作......否则它将消息记录在一个可以检查的数组中。

```
//======================================================//
// multi browser compatibility - not all support console
//======================================================//
var dummyConsole = [];
var console = console || {};
if (!console.log) {
    console.log = function (message) {
        dummyConsole.push(message);
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-23T17:05:13.530

如果您使用的是 JQuery，我所做的就是向页面动态添加一个输出字段，以便我可以看到 JavaScript 值。z-index 是为了让它保持在顶部。随心所欲地设计它。我通常添加彩色边框或明亮的背景颜色，以便在屏幕上轻松找到。

```
var output= 'hello';
$('body').append("<div style='width:50px;z-index:1000'>" + output + "</div>"); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-12-11T17:50:24.673

我最近遇到了这篇文章，因为我在 Safari 14 上遇到了类似的问题。我为 Safari 使用了 Grammarly，它创建了另一个发送请求的框架。这也可能发生在其他扩展上。

默认情况下，Safari 应该选择正确的帧，但如果没有，那么您将看不到控制台日志。如果发生这种情况，控制台窗口的右下角会出现一个下拉菜单。如果您选择网站框架，日志将开始出现。

[下拉菜单的图片](https://i.stack.imgur.com/OqehW.png)

# php - 如何将评论添加到以前没有可用的 Socialengine 页面？

> ID：12015542
> 
> 赞同：1
> 
> 时间：2012-08-18T03:17:12.800
> 
> 标签：php, zend-framework, module, socialengine

我对为 Socialengine 平台提供的宠物插件做了一些实质性的修改（与显示相关），需要在讨论区的帖子中添加评论。我一直在努力做到这一点，到目前为止有这个项目：

```
 <a name="comments"></a>
<?php echo $this->action("list", "comment", "core", array("type"=>$object->getType(),"id"=>$object->getIdentity())) ?> 
```

它甚至不会在页面上运行（破坏显示并且不输出数据）。我希望这会显示一个框，该框将从项目中获取所需的数据，并使用 petid、topicid 和 userid 创建存储在 engine4_core_comments 中的评论。只需要在页面上添加某种评论功能，如果您有使用此类功能的经验，任何事情都可以做到。

这是完整的 view.tpl 页面：

```
<?php
/**    

* Radcodes - SocialEngine Module
 *
 * @category   Application_Extensions
 * @package    Pet
 * @copyright  Copyright (c) 2009-2010 Radcodes LLC (http://www.radcodes.com)
 * @license    http://www.radcodes.com/license/
 * @version    $Id$
 * @author     Vincent Van <vincent@radcodes.com>
 */
?>

<h2>
  <?php echo $this->translate("%s &#187; Discussions", $this->pet->__toString())?>
</h2>

<h3>
  <?php echo $this->topic->getTitle() ?>
</h3>

<?php $this->placeholder('pettopicnavi')->captureStart(); ?>
<div class="pet_discussions_thread_options">
  <?php echo $this->htmlLink(array('route' => 'pet_extended', 'controller' => 'topic', 'action' => 'index', 'pet_id' => $this->pet->getIdentity()), $this->translate('Back to Topics'), array(
    'class' => 'buttonlink icon_back'
  )) ?>
  <?php if( $this->form ): ?>
    <?php echo $this->htmlLink($this->url(array()) . '#reply', $this->translate('Post Reply'), array(
      'class' => 'buttonlink icon_pet_post_reply'
    )) ?>
  <?php endif; ?>
  <?php if( $this->can_edit): ?>
    <?php if( !$this->topic->sticky ): ?>
      <?php echo $this->htmlLink(array('action' => 'sticky', 'sticky' => '1', 'reset' => false), $this->translate('Make Sticky'), array(
        'class' => 'buttonlink icon_pet_post_stick'
      )) ?>
    <?php else: ?>
      <?php echo $this->htmlLink(array('action' => 'sticky', 'sticky' => '0', 'reset' => false), $this->translate('Remove Sticky'), array(
        'class' => 'buttonlink icon_pet_post_unstick'
      )) ?>
    <?php endif; ?>
    <?php if( !$this->topic->closed ): ?>
      <?php echo $this->htmlLink(array('action' => 'close', 'close' => '1', 'reset' => false), $this->translate('Close'), array(
        'class' => 'buttonlink icon_pet_post_close'
      )) ?>
    <?php else: ?>
      <?php echo $this->htmlLink(array('action' => 'close', 'close' => '0', 'reset' => false), $this->translate('Open'), array(
        'class' => 'buttonlink icon_pet_post_open'
      )) ?>
    <?php endif; ?>
    <?php echo $this->htmlLink(array('action' => 'rename', 'reset' => false), $this->translate('Rename'), array(
      'class' => 'buttonlink smoothbox icon_pet_post_rename'
    )) ?>
    <?php echo $this->htmlLink(array('action' => 'delete', 'reset' => false), $this->translate('Delete'), array(
      'class' => 'buttonlink smoothbox icon_pet_post_delete'
    )) ?>
  <?php elseif( !$this->can_edit): ?>
    <?php if( $this->topic->closed ): ?>
      <div class="pet_discussions_thread_options_closed">
        <?php echo $this->translate('This topic has been closed.')?>
      </div>
    <?php endif; ?>
  <?php endif; ?>
</div>
<?php $this->placeholder('pettopicnavi')->captureEnd(); ?>

<?php echo $this->placeholder('pettopicnavi') ?>
<?php echo $this->paginationControl(null, null, null, array(
  'params' => array(
    'post_id' => null // Remove post id
  )
)) ?>

<script type="text/javascript">
  var quotePost = function(user, href, body)
  {
    $("body").value = '[blockquote]' + '[b][url=' + href + ']' + user + '[/url] said:[/b]\n' + body + '[/blockquote]\n\n';
    $("body").focus();
    $("body").scrollTo(0, $("body").getScrollSize().y);
  }
</script>

<ul class='pet_discussions_thread'>
  <?php foreach( $this->paginator as $post ): ?>
  <li>
    <div class="pet_discussions_thread_photo">
      <?php
        $user = $this->item('user', $post->user_id);
        echo $this->htmlLink($user->getHref(), $user->getTitle());
        echo $this->htmlLink($user->getHref(), $this->itemPhoto($user, 'thumb.icon'));
      ?>
    </div>
    <div class="pet_discussions_thread_info">
      <div class="pet_discussions_thread_details">
        <div class="pet_discussions_thread_details_options">
          <?php if( $this->form ): ?>
            <?php echo $this->htmlLink('javascript:void(0);', $this->translate('Quote'), array(
              'class' => 'buttonlink icon_pet_post_quote',
              'onclick' => 'quotePost("'.$this->escape($user->getTitle()).'", "'.$this->escape($user->getHref()).'", "'.$this->string()->escapeJavascript($post->body).'");'
            )) ?>
          <?php endif; ?>
          <?php if( $post->user_id == $this->viewer()->getIdentity() || $this->pet->getOwner()->getIdentity() == $this->viewer()->getIdentity() ): ?>
            <?php echo $this->htmlLink(array('route' => 'pet_extended', 'controller' => 'post', 'action' => 'edit', 'post_id' => $post->getIdentity(), 'format' => 'smoothbox'), $this->translate('Edit'), array(
              'class' => 'buttonlink smoothbox icon_pet_post_edit'
            )) ?>
            <?php echo $this->htmlLink(array('route' => 'pet_extended', 'controller' => 'post', 'action' => 'delete', 'post_id' => $post->getIdentity(), 'format' => 'smoothbox'), $this->translate('Delete'), array(
              'class' => 'buttonlink smoothbox icon_pet_post_delete'
            )) ?>
          <?php endif; ?>
        </div>
        <div class="pet_discussions_thread_details_date">
          <?php echo $this->timestamp(strtotime($post->creation_date)) ?>
        </div>
      </div>
      <div class="pet_discussions_thread_body">
        <?php echo nl2br($this->BBCode($post->body)) ?>
      </div>
    </div>
  </li>
  <?php endforeach; ?>

<?php if($this->paginator->getCurrentItemCount() > 4): ?>

  <?php echo $this->paginationControl(null, null, null, array(
    'params' => array(
      'post_id' => null // Remove post id
    )
  )) ?>
  <br />
  <?php echo $this->placeholder('pettopicnavi') ?>

<?php endif; ?>
<br />

<?php if( $this->form ): ?>
  <a name="reply" />
  <?php echo $this->form->setAttrib('id', 'pet_topic_reply')->render($this) ?>
<?php endif; ?> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T19:59:59.990

在最新版本的 SocialEngine`Comment`中，布局管理器中有一个可用的小部件。你可以尝试使用它。

# iphone - 如何在 iOS 中为黑色和透明的图像填充颜色？

> ID：12015547
> 
> 赞同：11
> 
> 时间：2012-08-18T03:18:00.700
> 
> 标签：iphone, objective-c, ios, colors, sprite

例如，在iOS工具栏中，你拖入你自己的.png，它是不透明的黑色和透明的，它会自动添加iOS蓝色光泽。

但是，我想知道自己如何做到这一点，但只有纯色就可以了。

例如，如果您有此图像： ![例子](../Images/586b81db201ac197357d3defbeb9b677.png)

你会怎么做才能使整个固体，粉红色，蓝色或灰色？我想通过使用代码对它们进行着色来减少我在应用程序中保存的 .png 版本的数量。

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-18T15:09:20.613

这应该为你做：

```
- (UIImage *)colorImage:(UIImage *)origImage withColor:(UIColor *)color
{
    UIGraphicsBeginImageContextWithOptions(origImage.size, YES, 0);
    CGContextRef context = UIGraphicsGetCurrentContext();

    CGContextSetFillColorWithColor(context, [color CGColor]);
    CGContextFillRect(context, (CGRect){ {0,0}, origImage.size} );

    CGAffineTransform flipVertical = CGAffineTransformMake(1, 0, 0, -1, 0, origImage.size.height);
    CGContextConcatCTM(context, flipVertical);
    CGContextDrawImage(context, (CGRect){ pt, origImage.size }, [origImage CGImage]);

    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return image;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-08T11:25:38.790

从 iOS 7 开始，您现在可以像这样用单一颜色为**黑色（灰度）/透明图像着色**

```
UIImage *image = [UIImage imageNamed:@"myImage.png"];
UIImageView *imageView = [[UIImageView alloc]initWithImage:[image imageWithRenderingMode:UIImageRenderingModeAlwaysTemplate]];
imageView.tintColor = [UIColor redColor]; 
```

# android - 用户操作正在等待后台工作完成

> ID：12015552
> 
> 赞同：28
> 
> 时间：2012-08-18T03:18:55.783
> 
> 标签：android, eclipse

我在 IDE 中使用 eclipse junno 来开发 android 程序。

我的问题就是这样： [用户操作正在等待“构建工作区”](https://stackoverflow.com/questions/11514987/user-operation-is-waiting-for-building-workspace)

为什么会发生这种情况，我该如何解决？关于这个案子，我已经等了很多时间。

现在它看起来像这样。

![在此处输入图像描述](../Images/86a859f462abf3908b68fe30a37e2669.png)

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-18T03:22:14.540

Eclipse 有时会无缘无故地挂起（通常是因为内存）。只需尝试重新启动它，看看问题是否仍然存在。我以前遇到过这种情况，重新启动 Eclipse 或 PC 通常可以解决它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-07-18T11:20:12.570

我有完全相同的问题。对我来说，帮助在 eclipse.ini 文件的第一行添加“-clean”选项并重新启动 IDE。添加此选项后，eclipse 每次启动时都会清理工作区中的所有缓存数据（这也意味着它会启动得更慢）。

[您可以在此处找到有关它的更多信息：如何在 Eclipse http://www.eclipsezone.com/eclipse/forums/t61566.html](http://www.eclipsezone.com/eclipse/forums/t61566.html)中修复挂起的“用户操作正在等待“构建工作区””

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-03-21T18:23:00.053

就我而言，我在 eclipse.ini 文件中分别增加了`-Xms`和`-Xmx`args 的值。您可以根据您或根据您的系统内存增加它。**然后重启eclipse。**`512``2048`

 *** * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-15T09:56:34.180

转到**项目**菜单**取消选中**自动**构建**并重新**启动****Eclipse** /STS IDE。

[![在此处输入图像描述](../Images/2bfc8dc61b78084eb9704ed8f4d1eda9.png)](https://i.stack.imgur.com/MsKEo.jpg)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-28T23:08:41.907

如果重新启动机器后问题仍然存在，那么您的模块中有一个依赖循环。即你的模块之间存在依赖死锁，例如。在module1的PUM文件中，需要module2，在module2的PUM文件中，需要module1。
要解决此问题，请验证相关模块或子项目中的 PUM 文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-06T19:42:36.567

对我来说，问题在于 Maven 项目的构建路径。尝试配置构建路径并仅包含我所学到的实际需要的内容。我的父 maven 项目有 10 多个子模块。我的 Eclipse 需要 3-4 分钟等待每个文件保存的后台进程。我从构建路径中删除了 [父模块]/src 并重新启动了 eclipse 并修复了问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-28T08:53:22.480

尝试创建一个新的工作区，它对我有用。**

# asp.net-mvc - 使用 Nuget 更新 FluentValidation 后 NinjectValidatorFactory 出错

> ID：12015553
> 
> 赞同：9
> 
> 时间：2012-08-18T03:19:21.140
> 
> 标签：asp.net-mvc, asp.net-mvc-3, ninject, fluentvalidation

我的 NinjectModule 中有以下代码行：

```
Bind<IValidatorFactory>().To<NinjectValidatorFactory>().InSingletonScope(); 
```

这曾经工作正常，但在使用 Nuget 进行大量更新后，我收到以下错误：

> 错误 3 类型“Ninject.Web.Mvc.FluentValidation.NinjectValidatorFactory”不能用作泛型类型或方法“Ninject.Syntax.IBindingToSyntax.To()”中的类型参数“TImplementation”。没有从“Ninject.Web.Mvc.FluentValidation.NinjectValidatorFactory”到“FluentValidation.IValidatorFactory”的隐式引用转换。D:\Projects\Current...\Configuration\MainModule.cs 19 13
> 
> 错误 4 类型“FluentValidation.ValidatorFactoryBase”在未引用的程序集中定义。您必须添加对程序集“FluentValidation，Version=2.0.0.0，Culture=neutral，PublicKeyToken=a82054b837897c66”的引用。D:\Projects\Current...\Configuration\MainModule.cs 19 13

确实，我没有引用 FluentValidation Version=2.0.0.0，但我确实引用了 FluentValidation Version=3.4.0.0。

根据元数据...

*   `IValidatorFactory`并`ValidatorFactoryBase`在 Assembly FluentValidation.dll 中定义。
*   `NinjectValidatorFactory`在 Assembly Ninject.Web.Mvc.FluentValidation.dll 中定义。

在我的 References 文件夹中，我有 FluentValidation v3.4.0.0 和 Ninject.Web.Mvc.FluentValidation v3.0.0.0。

我不明白为什么编译器认为我需要 FluentValidation Version=2.0.0.0。

我做错了什么，还是 Nuget 包的问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-18T08:40:30.193

看起来问题在于 FluentValidation 曾经是一个签名程序集，但现在是一个未签名程序集。然而，Ninject.Web.Mvc.FluentValidation 仍然认为 FluentValidation 已签名。

如果您在 ILSpy 中查看这两个程序集，您会注意到以下内容：

*   Ninject.Web.Mvc.FluentValidation 使用以下属性引用 FluentValidation：FluentValidation，Version=2.0.0.0，Culture=neutral，PublicKeyToken=a82054b837897c66
*   然而，最新版本的 FluentValidation 具有不同的属性：FluentValidation、Version=3.4.0.0、Culture=neutral、PublicKeyToken=null

请注意，PublicKeyToken 已更改为 null（无符号）。

希望很快会有解决方案。同时，选项是回滚到以前的 FluentValidation 或通过新的分叉修复引用。

**更新**

刚刚向 Ninject.Web.Mvc.FluentValidation发布了一个[错误报告。](https://github.com/ninject/ninject.web.mvc.fluentvalidation/issues/3)希望这将确保问题得到快速解决。

**更新 2**

以防万一有人错过，下面@dismissile 的评论包含一个很好的解决方案。我试了一下，效果很好。这是一个更详细的细微变化：

1.  删除所有包含“FluentValidation”的 Nuget 包。
2.  使用 Nuget 安装 FluentValidation-Signed。
3.  使用 Nuget 安装 FluentValidation.MVC3-Signed（或 MVC4-Signed）
4.  使用包管理器控制台，输入以下内容：

    ```
    Install-Package Ninject.Web.Mvc.FluentValidation -IgnoreDependencies 
    ```

注意：我不需要手动将绑定重定向添加到我的 Web.config（尽管 Nuget 包自动添加了一个）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-19T14:49:40.427

DanM 正确识别了该问题。[这](http://fluentvalidation.codeplex.com/workitem/7107)是项目协调员的评论

> “未来，主要的 nuget 包将不再被强烈命名。
> 
> 如果您绝对需要强命名，可以使用单独的包 FluentValidation-signed，但建议您使用未签名的版本。” Jeremy Skinner

# iphone - 计算器（卡在 2x2x2 操作中）

> ID：12015556
> 
> 赞同：0
> 
> 时间：2012-08-18T03:19:28.650
> 
> 标签：iphone, objective-c, calculator

我正在做我的计算器课业。我已经快完成了。

现在，我的计算器可以做例如 2+3+5x6-3/2x6x7-8x9 和 6*9+7

但它不能做到 2*4*8.......

任何人都可以告诉我代码有什么问题吗？这是我在下面的代码：

@实现计算器大脑

```
- (void)setOperand:(double)aDouble
{
    operand = aDouble;
}

- (double)performOperation:(NSString *)operation
{
    if ([operation isEqual:@"sqrt"]){
        operand = sqrt(operand);
    }
    else if ([@"+/-" isEqual:operation]) {
        operand = - operand;
    }    
    else if ([@"%" isEqual:operation]) {
        operand = operand/ 100;
    }
    else if ([@"1/x" isEqual:operation]) {
        operand = 1/operand;
    }
    else if ([@"C" isEqual:operation]){
        operand = 0;
    }
    else if ([@"AC" isEqual:operation])  {
        operand = 0;
        alwaysFirstDigit = 0;
        digi1 = 0;
        digi2 = 0;

    }else {

        //Assign the first digit to alwaysFirstDigit, and decide the second digit to digi1 or digi2
        if (start == 0){

            alwaysFirstDigit = operand;
            NSLog(@"alwaysFirstDigit = %f", alwaysFirstDigit);

            operationFirst = operation;
            NSLog(@"operationFirst = %@", operationFirst);

            start = 1;

        }else  if (signFlag == 1){
            digi2 = operand;
            NSLog(@"digi2 = %f", digi2);

        }else {
            digi1 = operand;
            NSLog(@"digi1 = %f", digi1);
            }

        // This is an accumulator if first operation is equal to * or /
        if (signFlag == 1) {
        NSLog(@"RUN01 ");

            if ([@"+" isEqual:operationSecond]) 
            {
                digi1 = digi1 + digi2; 
            }
            else if ([@"*" isEqual:operationSecond]) 
            {
                digi1 = digi1 * digi2;
            }
            else if ([@"-" isEqual:operationSecond])
            {
                digi1 = digi1 - digi2;
            }
            else if ([@"/" isEqual:operationSecond]) 
            {
                digi1 = digi1 / digi2;
            }
            digi2 = 0;
            signFlag = 0;
            NSLog(@"This is digi1 in / = %f, %f", digi1, digi2);

        }

        // if operationFirst is = to + or -
        if (([operationFirst isEqual:@"+"]) || ([operationFirst isEqual:@"-"])){  
            NSLog(@"RUN02 ");

        // if operationFirst is = to + or -
            if (([operation isEqual:@"+"]) || ([operation isEqual:@"-"])){

                if ([@"+" isEqual:operationFirst]) 
                {
                    alwaysFirstDigit = alwaysFirstDigit + digi1; 
                }
                else if ([@"-" isEqual:operationFirst]) 
                {
                alwaysFirstDigit = alwaysFirstDigit - digi1;
                }

                operationFirst = operation;  //
                operand = alwaysFirstDigit;  //
            }

            if (([operation isEqual:@"*"]) || ([operation isEqual:@"/"])){
                NSLog(@"RUN03 ");

                signFlag = 1;  //
                operationSecond = operation;  //
                NSLog(@"operationSecond = %@", operationSecond);
            }
        }         

        // it's work
        if (([operationFirst isEqual:@"*"]) || ([operationFirst isEqual:@"/"])){  
            NSLog(@"This is digi1 in *** = %f", alwaysFirstDigit);
            NSLog(@"RUN04 ");

            if (([operation isEqual:@"+"]) || ([operation isEqual:@"-"])){
                NSLog(@"RUN05 ");

                if ([@"*" isEqual:operationFirst]) 
                {
                    alwaysFirstDigit = alwaysFirstDigit * digi1; 
                }
                else if ([@"/" isEqual:operationFirst]) 
                {
                    alwaysFirstDigit = alwaysFirstDigit / digi1;
                }
                operationFirst = operation;  //
                operand = alwaysFirstDigit;  //
            } 

            **// maybe here is the problem !!!!!**
            if (([operation isEqual:@"*"]) || ([operation isEqual:@"/"])){
                NSLog(@"RUN06 ");

                temp1 = digi1;

                operationFirst = operation;  //
                operand = alwaysFirstDigit;  //
            }
        }         

        if([operation isEqual:@"="]){
            NSLog(@"This is temp1 in ***** = %f", temp1);

            if ([@"+" isEqual:operationFirst]) 
            {
                alwaysFirstDigit = alwaysFirstDigit + digi1; 
            }
            else if ([@"*" isEqual:operationFirst]) 
            {
                alwaysFirstDigit = alwaysFirstDigit * digi1;
            }
            else if ([@"-" isEqual:operationFirst])
            {
                alwaysFirstDigit = alwaysFirstDigit - digi1;
            }
            else if ([@"/" isEqual:operationFirst]) 
            {
                alwaysFirstDigit = alwaysFirstDigit / digi1;
            }

                digi1 = 0;
                operand = alwaysFirstDigit;
                operation = @"";
                start = 0;
        }
    }
return operand;
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T20:01:32.743

在您评论的部分下：

```
 // if operationFirst is = to + or - 
```

if 子句中有一些代码开始：

```
 if (([operation isEqual:@"*"]) || ([operation isEqual:@"/"])){ 
```

这段代码永远不会运行，因为它包含在一个 if 块中，上面写着：

```
 if (([operationFirst isEqual:@"+"]) || ([operationFirst isEqual:@"-"])){  
        NSLog(@"RUN02 "); 
```

我不知道这是否是你的问题。您可能还想考虑为您尝试实现的计算器语言使用解析器和语法。Alfred Aho 和其他人的《编译器、原理、技术和工具》一书被称为“龙之书”，因为几十年来它的封面上有一条龙，是制作和理解诸如台式计算器之类的语法解析器的传统来源（这是它使用的示例之一），这确实是您要编写的代码。除了为您提供完美的台式计算器语法外，它还将使您对编译器的了解增加很多倍。

# visual-studio - Visual Studio 转换的项目用户控件设计器文件不正确

> ID：12015566
> 
> 赞同：0
> 
> 时间：2012-08-18T03:22:14.773
> 
> 标签：visual-studio, visual-studio-2012

我有一个 ASP.Net 项目，我使用 InstantC# 从 VB 转换为 C#。转换似乎进行得很好。只有少数项目必须手动修复。在将项目从 VS2010 转换为 VS2012 后，我这样做了。一旦我修复了推断的方法和对象引用，我就可以构建一次。

查看该页面后，我收到一个关于事件处理程序分配的对象空引用异常。

我又建了。这一次，我从引用页面上其他用户控件的代码的方法和属性中收到了各种错误。在查看设计器文件时，它没有正确确定并将类型分配给控件。

我曾尝试手动更改对象类型，但 Visual Studio 将它们更改回来。

我还尝试删除设计器文件并选择转换为 Web 应用程序。

在同一个项目中还有其他用户控件可以正常工作。没有问题。关于如何解决这个问题的任何其他想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T21:29:22.693

我最终通过创建一个全新的用户控件，然后从原始用户控件粘贴 UI 来解决此问题。一旦我确认设计器文件已正确生成，我就从原始用户控件中导入了代码。

为了确保一切按计划进行，我重命名并从项目中排除了原始用户控件并测试了新的。当我确认一切正常时，我删除了原件。

# php - 致命错误：内存不足，但我确实有足够的内存（PHP）

> ID：12015569
> 
> 赞同：70
> 
> 时间：2012-08-18T03:23:04.120
> 
> 标签：php, memory

由于我的问题越来越长，我决定重新编写整个问题以使其更好更短。

我在具有 8GB 内存的专用服务器上运行我的网站。我完全知道我需要提高 php.ini 设置的内存限制。我已将其从 128M 设置为 256M 和 -1。问题仍然是持久性。

> 致命错误：第 81 行 D:\www\football\views\main.php 中的内存不足（已分配 786432）（试图分配 24576 字节）

内存不足没有意义，因为它说只分配了 786432 字节，而且还需要 24576 字节。

786432 字节只有 768 KB，而且相当小。

## 提示

*   错误发生在非常随机的行上。它并不总是在第 81 行出错。
*   在高峰期，Apache 只占用大约 500mb 的内存。我还有 6GB 可用空间。
*   没有无限循环。
*   该脚本占用 1,042,424 个字节。从中获取此号码`echo memory_get_peak_usage();`
*   MySQL 的结果集很小（最多 12 行，纯文本，没有 blob 数据）
*   （**重要**）如果我每两天重新启动一次 Apache，错误就消失了。它通常发生在 Apache 运行超过 2 天时。
*   我已经包含了分析脚本，你可以在[这里](http://pastebin.com/1WRWCZRs)得到它。
*   这个专用服务器纯粹是用来运行一个网站的。该网站是一个高流量网站，平均每分钟有 1,000 名访问者。在高峰期，将有 1,700 至 2,000 名访客同时访问。

## 服务器规格

> 操作系统：Windows 2008 R2 64 位
> CPU：Intel Core i5 - 4 核
> RAM：8 GB
> Apache 2.2
> PHP 5.3.1
> 存储：2 x 1 TB 硬盘
> 带宽：每月 10 TB

## 解决方案

我终于调整并解决了这个问题，我想在这里分享我为改进所做的工作：

1.  `favicon.ico`丢失了这弄乱了我的路线引擎。虽然我的路由引擎非常小，但通过包含`favicon.ico`，它有助于通过不运行我的路由引擎来减少内存使用。我网站的大部分都有它，我忘了把它放在这个新部分。
2.  限制有`MaxRequestPerChild`帮助。在我的另一台专用服务器上，我有我的`MaxRequestPerChild`限制。对于这个服务器，我设置为0。我一直以为每个脚本都是隔离的。假设我的脚本需要 800kb 才能运行。完成后，Apache 或 PHP 应该释放 800kb 内存。似乎它不以这种方式工作。Limited`MaxRequestPerChild`确实有助于通过在受限之后创建新进程来防止内存泄漏，`MaxRequestPerChild`并且旧进程正在死亡。这是我的新设置。

    ```
    ThreadsPerChild      1500
    MaxRequestsPerChild  10000 
    ```

3.  `ob_flush();`确实减少了更多的内存。它没有多大帮助，但每一点优化都有帮助。

4.  `xdebug`正如试图回答这个问题的人所建议的那样，我使用了我以前从未使用过的。我不得不说它是一个很棒的工具，我已经优化了一些东西，让它运行得更快一些。
5.  我禁用了一些不必要的 Apache 模块。我正在尝试一一禁用它，并对其进行几天的测试，以确保它在禁用另一个之前完美运行。我现在确实禁用了所有不必要的 PHP 扩展。
6.  我在这个服务器中的大部分脚本都使用传统方式（无模板、无数据库层、纯 PHP、HTML 和遗留 mysql_* 函数）。老实说，它运行速度非常快，而且使用的内存非常小。但是，由于网站越来越长，维护脚本并不容易。我试图将网站的某些部分转换为适当的框架（我自己的小框架）。我使用自己的框架的原因是它很小（整个框架只有 3kb，只包含我需要的东西）。
7.  **切换到 IIS7.5 彻底解决了这个问题**。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-29T12:42:31.577

我在尝试使用交换时遇到了与服务器死机相同的问题。这是因为**mod_php 永远不会释放内存**。因此，Apache 进程不断增长，要么达到 apache 或 PHP 的内存限制，要么，如果没有限制，则使服务器崩溃。

重新启动 apache 会生成新的苗条进程，但随着时间的推移它们会运行 PHP 脚本，它们会不断增长，直到出现问题。

解决方案是让 apache 在提供一定数量的查询后终止进程，以便创建新的（有[一些与此相关的问题](https://stackoverflow.com/questions/501205/how-can-i-prevent-tons-of-apache-processes-spawning-when-i-start-apache-and-proc)）将[MaxRequestsPerChild](http://httpd.apache.org/docs/2.2/mod/mpm_common.html#maxrequestsperchild)配置选项减少到，比如说 100（默认为 1000）。

当然，这可能会降低服务器性能，因为它需要资源来杀死和产生新进程，但至少它使站点保持工作。您可能很想提高正在运行的进程数以保持高性能，请确保 PHP（或 apache）内存限制 x 最大进程数不会超过服务器的物理内存。

以上是我的经验，希望对你有帮助。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-28T16:17:29.483

对于初学者来说，`memory_get_peak_usage()`这里不会有帮助。它只会返回分配的内存量，这与导致错误的数字相同。

`memory_get_usage`将返回调用时正在分配的活动内存量。

`ini_set('memory_limit', '256M');`将设置 PHP 在系统内存上占用的最大允许值。如果您在 768K 时获得 OOM，则提高它不会解决问题。

没有迹象表明您使用的是什么版本的 PHP，但我建议立即升级。Zend 的内存管理器有几个错误无法释放内存，这将导致您完全相同的问题。

您的本地服务器和生产服务器是否都运行相同版本的操作系统、相同的长位和相同版本的 PHP？答案是否定的。

如果它与 Windows 问题无关`malloc()`，因为它是子域并且可能在 VirtualHost 内，并且仅分配 768k，这听起来几乎是操作系统问题。

`tasklist`访问脚本时从命令提示符运行。您是否看到额外的 Apache 线程，或跨进程的内存使用量激增？

最后一个想法是，在表格行/列的每个循环之后运行`flush()`和/或。`ob_flush();`如果出现问题，这应该会清除缓冲区并为您节省一些内存。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-27T08:55:59.530

我将从将 PHP 升级到 5.4+ 开始，因为对于某些应用程序，它的速度提高了 50%。他们修复了大量的内存泄漏。请参阅 becnhamrks：[http ://news.php.net/php.internals/57760](http://news.php.net/php.internals/57760)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-08-29T09:34:38.793

请注意，错误是`Out of memory`和不是`Allowed memory size [..] exhausted`。

所以内存泄漏在系统的其他地方。在这个繁重的查询之后，mysql 服务器可能会使用大量系统内存，从而使 apache/php 没有物理和交换。

这应该总是在同一行（和/或在同一脚本中）解释错误。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-08-27T09:10:35.697

安装 xdebug 并启用分析器触发器。生成一个分析器文件，然后如果您仍然无法确定问题的根源，请发布 cachegrind 文件。

编辑：当然发生内存泄漏的页面的分析器文件！

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-08-29T19:32:01.283

我猜你要么没有编辑正确的，`php.ini`要么你没有重新启动 PHP 和/或网络服务器。

`phpinfo.php`在您的 docroot 中创建一个包含内容的页面，`<?php phpinfo();`以确保您更改的是正确的`php.ini`. 除了`php.ini`网络服务器正在使用的文件的位置之外，它还将说明允许的最大脚本内存。

接下来，我将向您的页面添加一些堆栈跟踪，以便您可以看到导致此的事件链。以下函数将捕获致命错误并提供有关所发生情况的更多信息。

```
register_shutdown_function(function()
{
    if($error = error_get_last())
    {
        // Should actually log this instead of printing out...
        var_dump($error);
        var_dump(debug_backtrace());
    }
}); 
```

就个人而言，Nginx + PHP-FPM 是我离开慢速 Apache 以来多年来一直使用的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-10-24T10:33:33.773

**致命错误：内存不足（已分配解决**
我有类似的问题，几个月没有解决方案。最后我检查了一个 apache 文件夹，即（\apache\conf\extra）我遇到了这个控制 apache 内存分配的文件. 文件名是**httpd-mpm**在该文件中，您要将 MaxMemFree 设置为 2048 更高的值，我将第一个 MaxMemFree (IfModule !mpm_netware_module) 设置为 10000，然后将第二个 MaxMemFree 设置为 5000 IfModule mpm_netware_module。

这些解决了我的问题。希望能帮助到你

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-09-01T06:07:40.257

嘿，我的服务器上也遇到了同样的问题。我只是更改了以下内容：

更改`php.ini`为...

```
memory_limit = 128M 
```

并添加到`httpd.conf`

```
RLimitMEM 1073741824 2147483648 
```

并重新启动 apache & 我删除了错误：

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-08-29T14:07:14.517

可能是 MySQL 和打开连接数的问题，因此为什么每隔几天重新启动时它会自行解决。他们是否在脚本关闭时自动关闭？

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-08-31T12:57:31.923

回顾一下（我添加的这个答案与原始问题相距甚远）：

*   PHP 无法分配看似少量的内存
*   错误发生时的当前内存使用量 + 请求的数量小于当前有效的内存限制
*   发生这种情况时，系统有 6Gb 可供 PHP 使用
*   因为问题是通过重新启动 apache 来解决的 - 它是 apache 阻止了内存对 PHP 可用

如果这些都是有效的，那么唯一可能的解释是 6Gb*非常*分散——我认为这不太可能。您没有说如何从 Apache 调用 PHP - mod_php？每分钟？Fcgi?

我将从检查上述每个谓词开始——尤其是空闲内存谓词。你怎么知道*发生错误时*有 6Gb 可用？更可能的原因是发生了您没有发现的内存泄漏。

您没有提供有关如何配置 apache 的任何详细信息；我还想看看减少 MaxRequestsPerChild 和 MaxMemFree。（我对每个线程都适用的 worker apache 不是很熟悉——实际上你需要对每个进程进行限制）。如果您从 apache 配置中提供了核心设置，那么也许我们可以提出进一步的建议。

除非您广泛使用 Ajax，否则请确保您的 keepalive 时间为 2 或更少。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-09-01T11:02:54.827

大多数时候你会遇到这样的错误，问题出在代码中。我并不是要说您编写的代码很糟糕，而是要说您需要仔细观察使用这么多内存的内容。

永远记住“ **PHP 中的垃圾收集非常糟糕**”，它不像 Java，任何其他这样的语言。有一种方法可以通过**gc_collect_cycle**强制垃圾收集，但是，在我个人看来，这不会解决你的问题。一旦请求-响应周期完成，PHP 会释放用于执行页面的所有内存，因此如果您的脚本长时间运行，例如后台脚本（Gearman 等），您可能会遇到内存问题，因为直到内存才会被释放脚本正在运行。

如果您的 scr,pt 不是上述情况，并且正如您所说，没有需要如此大量内存的代码，那么问题肯定出在代码本身，升级到任何版本的 PHP 都无法解决问题。我曾经遇到过我的一个 Gearman 脚本，我的一个循环出现了问题，我将一个变量附加到我的数组之一，变量本身非常重（大约 110KB 的数据）。所以我建议，仔细检查你的代码。

狂欢

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-09-01T13:56:28.820

我对 PHP 有类似的问题：

1）检查您的错误日志。在继续之前消除所有错误。2) 考虑修改您的 apache 配置以消除未使用的模块 - 这将减少 PHP 所需的占用空间 - 这是一个很好的链接 - 它特定于 Wordpress，但仍然应该非常有用[http://thethemefoundry.com/blog/optimize- apache-wordpress/](http://thethemefoundry.com/blog/optimize-apache-wordpress/)

为了让您了解我发现的那种错误，我有一些代码试图将内容发布到 Facebook，然后 Facebook 修改了他们的 API，所以这坏了，我还使用了一个“内容过期器”，这基本上意味着它一直在重试将此内容发布到 Facebook 并将大量对象留在内存中。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-08-30T07:34:46.153

几天前发生在我身上。我做了一个全新的安装，它仍然发生。据每个人都看到并基于您的服务器规格。很可能它是一个无限循环。它可能不在 PHP 代码本身上，而是在向 Apache 发出的请求上。

假设您访问此网址**http://localhost/mysite/page_with_multiple_requests**

如果收到多个请求，请检查 Apache 的访问日志。跟踪该请求并检查可能导致系统“瓶颈”的代码（使用 sendmail 时我的 exec()）。我所说的瓶颈不需要是“无限循环”。它可能是一个需要一些时间才能完成的功能。或者也许是一些 php 的“[程序执行功能](http://php.net/manual/en/function.exec.php)”

您可能还需要检查 ajax 请求（在页面加载时执行的请求）。如果该 ajax 请求重定向到相同的 url

例如 httpx://localhost/mysite/page_with_multiple_requests

它会重新“重做”请求

如果您在脚本结束的地方发布随机行或代码本身，可能会有所帮助，那里可能有一个“循环”代码。恕我直言 php 不会只调用随机行。

[http://blog.piratelufi.com/2012/08/browser-sending-multiple-requests-at-once/](http://blog.piratelufi.com/2012/08/browser-sending-multiple-requests-at-once/)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-09-26T08:51:41.760

这是适用于 Windows 的 PHP v 5.2 中的一个已知错误，它至少存在于版本 5.2.3：[https ://bugs.php.net/bug.php?id=41615](https://bugs.php.net/bug.php?id=41615)

建议的修复对我们都没有帮助，我们将不得不更新 PHP。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-03-19T10:23:12.253

尝试通过 fcgid 运行 php，这可能会有所帮助：

> 这些是您在将 PHP 作为 Apache 模块运行时会看到的经典错误。我们与这些错误斗争了几个月。通过 mod_fcgid 切换到使用 PHP（正如 James 建议的那样）将解决所有这些问题。确保您安装了最新的 Visual C++ Redistributable 软件包：
> 
> [http://support.microsoft.com/kb/2019667](http://support.microsoft.com/kb/2019667)
> 
> 另外，我建议切换到 64 位版本的 MySQL。没有真正的理由再运行 32 位版本。

来源：[Apache 2.4.6.0 由于 php5ts.dll 5.5.1.0 中的问题而崩溃](http://www.apachelounge.com/viewtopic.php?t=5489)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2012-09-01T14:09:28.313

从探查器输出文件中，我注意到一些我不太喜欢/不太信任的事情，并会研究这些：

除了不知道检测异常的输出数字的含义或 PHP 脚本如何工作之外......，这不是问题吗？对同一个 main.ph 文件有一个包含，这看起来像一个递归的东西？

```
2121 fl=D:\www\football\views\main.php
2122 fn=include::D:\www\football\views\main.php 
```

注意到该文件`D:\www\football\views\main.php`多次使用了一些字符串函数，我猜它是在查询返回的数据上调用这些函数：

```
strlen
substr
strtotime 
```

如果像在 C 语言中一样，这些函数需要`null`终止字符串或字符串终止符的其他结尾以避免内存问题，我会查看您的查询返回的字符串。

你可以发布你的网站的网址吗？

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2012-08-27T09:17:37.287

以下两个事实肯定指向内存泄漏：

1.  错误出现在代码的不同行，
2.  该错误报告相对较小的内存分配。

我会首先选择 PDO，禁用所有其他扩展，然后使用 Siege / Apache Bench (ab) 之类的东西让它在一夜之间运行。您也可以尝试使用`cli`界面运行它（只需确保保持相同的内存限制）。

您可以[`memory_get_peak_usage()`](http://php.net/manual/en/function.memory-get-peak-usage.php)在脚本末尾使用该函数来查看 PHP 认为它已经使用了多少内存。

从您的评论来看，这是 800 kB，没关系；绝对不是会导致内存不足的大量内存；-)

最后，虽然我现在不建议升级到 5.4，但升级到最新的 5.3.x 可能是值得的，因为自 5.3.1 以来已经解决了多个漏洞和泄漏

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-08-27T21:54:25.143

我会说服务器的物理/交换内存用完了，所以 PHP 无法分配足够的内存。

你能粘贴这里的输出`free`吗？

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-09-23T00:45:58.477

我知道这是一个旧线程，但这是我解决它的经验。

我的服务器是运行 Apache 的托管服务。

我的脚本在 6Mb 内存不足时崩溃了，而我的限制是 256Mb - 疯了，是吗？

它通过 http 回调同步调用，从我的客户端上运行的 javascript 调用，并在大约 550 次调用后崩溃。在与无能的“升级支持”人员浪费了很多时间之后，我的脚本现在神奇地运行了。

他们说他们所做的只是重置 php.ini，但我检查了差异： [![在此处输入图像描述](../Images/754289d288600c3278fd47019b6f7e11.png)](https://i.stack.imgur.com/GPmlZ.png)

我看不到可能与内存不足错误有关的任何更改。

我怀疑我的“升级支持”人员以重置 php.ini 为幌子隐藏了 Web 服务器中的内存泄漏。而且，真的，我不是阴谋论者。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-10-24T10:15:27.487

就我而言，这个错误是由于一个巨大的选择查询（数十万个返回结果）而触发的。

它是在我的数据库中添加数百万条记录以测试 WordPress 的可扩展性后立即出现的，所以这对我来说是唯一可能的原因。

# c++ - 如何在 C++ 中打印 Unicode 字符？

> ID：12015571
> 
> 赞同：75
> 
> 时间：2012-08-18T03:23:28.793
> 
> 标签：c++, unicode, iostream, cout, wchar-t

我正在尝试打印一个俄语“ф”（[U+0444 西里尔](http://www.unicode.org/charts/PDF/U0400.pdf)小写字母 EF）字符，该字符的代码为十进制[1092](http://en.wikipedia.org/wiki/%D0%A4)。使用 C++，我怎样才能打印出这个字符？我原以为以下内容会起作用，但是...

```
int main (){
   wchar_t f = '1060';
   cout << f << endl;
} 
```

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-08-18T04:42:52.577

要表示字符，您可以使用通用字符名称 (UCN)。字符 'ф' 的 Unicode 值是 U+0444，所以在 C++ 中你可以写成 '\u0444' 或 '\U00000444'。此外，如果源代码编码支持此字符，那么您可以直接在源代码中编写它。

```
// both of these assume that the character can be represented with
// a single char in the execution encoding
char b = '\u0444';
char a = 'ф'; // this line additionally assumes that the source character encoding supports this character 
```

打印这些字符取决于您要打印的内容。如果您要打印到 Unix 终端仿真器，终端仿真器正在使用支持此字符的编码，并且该编码与编译器的执行编码相匹配，那么您可以执行以下操作：

```
#include <iostream>

int main() {
    std::cout << "Hello, ф or \u0444!\n";
} 
```

该程序*不*要求 'ф' 可以用单个字符表示。在 OS X 和大多数现代 Linux 安装上，这都可以正常工作，因为源代码、执行和控制台编码都是 UTF-8（支持所有 Unicode 字符）。

Windows 的情况更加困难，并且有不同的权衡取舍有不同的可能性。

如果您不需要可移植代码（您将使用 wchar_t，在所有其他平台上确实应该避免使用），最好的方法可能是将输出文件句柄的模式设置为仅采用 UTF-16 数据。

```
#include <iostream>
#include <io.h>
#include <fcntl.h>

int main() {
    _setmode(_fileno(stdout), _O_U16TEXT);
    std::wcout << L"Hello, \u0444!\n";
} 
```

可移植代码更加困难。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-08-18T16:19:28.787

编译时`-std=c++11`，可以简单地

```
 const char *s  = u8"\u0444";
  cout << s << endl; 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-08-18T03:26:49.620

最终，这完全取决于平台。不幸的是，标准 C++ 对 Unicode 的支持很差。对于 GCC，您必须将其设为窄字符串，因为它们使用 UTF-8，而 Windows 需要宽字符串，您必须输出到`wcout`.

```
// GCC
std::cout << "ф";
// Windoze
wcout << L"ф"; 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-09-28T18:07:25.887

如果您使用 Windows（注意，我们使用的是 printf()，而不是 cout）：

```
//Save As UTF8 without signature
#include <stdio.h>
#include<windows.h>
int main (){
    SetConsoleOutputCP(65001); 
    printf("ф\n");
} 
```

不是 Unicode，但可以工作 - 1251 而不是 UTF8：

```
//Save As Windows 1251
#include <iostream>
#include<windows.h>
using namespace std;
int main (){
    SetConsoleOutputCP(1251); 
    cout << "ф" << endl;
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-06-25T19:44:02.080

此代码适用于 Linux（C++11、geany、g++ 7.4.0）：

```
#include <iostream>

using namespace std;

int utf8_to_unicode(string utf8_code);
string unicode_to_utf8(int unicode);

int main()
{
    cout << unicode_to_utf8(36) << '\t';
    cout << unicode_to_utf8(162) << '\t';
    cout << unicode_to_utf8(8364) << '\t';
    cout << unicode_to_utf8(128578) << endl;

    cout << unicode_to_utf8(0x24) << '\t';
    cout << unicode_to_utf8(0xa2) << '\t';
    cout << unicode_to_utf8(0x20ac) << '\t';
    cout << unicode_to_utf8(0x1f642) << endl;

    cout << utf8_to_unicode("$") << '\t';
    cout << utf8_to_unicode("¢") << '\t';
    cout << utf8_to_unicode("€") << '\t';
    cout << utf8_to_unicode("") << endl;

    cout << utf8_to_unicode("\x24") << '\t';
    cout << utf8_to_unicode("\xc2\xa2") << '\t';
    cout << utf8_to_unicode("\xe2\x82\xac") << '\t';
    cout << utf8_to_unicode("\xf0\x9f\x99\x82") << endl;

    return 0;
}

int utf8_to_unicode(string utf8_code)
{
    unsigned utf8_size = utf8_code.length();
    int unicode = 0;

    for (unsigned p=0; p<utf8_size; ++p)
    {
        int bit_count = (p? 6: 8 - utf8_size - (utf8_size == 1? 0: 1)),
            shift = (p < utf8_size - 1? (6*(utf8_size - p - 1)): 0);

        for (int k=0; k<bit_count; ++k)
            unicode += ((utf8_code[p] & (1 << k)) << shift);
    }

    return unicode;
}

string unicode_to_utf8(int unicode)
{
    string s;

    if (unicode>=0 and unicode <= 0x7f)  // 7F(16) = 127(10)
    {
        s = static_cast<char>(unicode);

        return s;
    }
    else if (unicode <= 0x7ff)  // 7FF(16) = 2047(10)
    {
        unsigned char c1 = 192, c2 = 128;

        for (int k=0; k<11; ++k)
        {
            if (k < 6)  c2 |= (unicode % 64) & (1 << k);
            else c1 |= (unicode >> 6) & (1 << (k - 6));
        }

        s = c1;    s += c2;

        return s;
    }
    else if (unicode <= 0xffff)  // FFFF(16) = 65535(10)
    {
        unsigned char c1 = 224, c2 = 128, c3 = 128;

        for (int k=0; k<16; ++k)
        {
            if (k < 6)  c3 |= (unicode % 64) & (1 << k);
            else if (k < 12) c2 |= (unicode >> 6) & (1 << (k - 6));
            else c1 |= (unicode >> 12) & (1 << (k - 12));
        }

        s = c1;    s += c2;    s += c3;

        return s;
    }
    else if (unicode <= 0x1fffff)  // 1FFFFF(16) = 2097151(10)
    {
        unsigned char c1 = 240, c2 = 128, c3 = 128, c4 = 128;

        for (int k=0; k<21; ++k)
        {
            if (k < 6)  c4 |= (unicode % 64) & (1 << k);
            else if (k < 12) c3 |= (unicode >> 6) & (1 << (k - 6));
            else if (k < 18) c2 |= (unicode >> 12) & (1 << (k - 12));
            else c1 |= (unicode >> 18) & (1 << (k - 18));
        }

        s = c1;    s += c2;    s += c3;    s += c4;

        return s;
    }
    else if (unicode <= 0x3ffffff)  // 3FFFFFF(16) = 67108863(10)
    {
        ;  // actually, there are no 5-bytes unicodes
    }
    else if (unicode <= 0x7fffffff)  // 7FFFFFFF(16) = 2147483647(10)
    {
        ;  // actually, there are no 6-bytes unicodes
    }
    else  ;  // incorrect unicode (< 0 or > 2147483647)

    return "";
} 
```

更多的：

*   [https://sites.google.com/view/technik-informatyk-nysa/porady/porady-c-cpp#h.p_lz0skneGFILy](https://sites.google.com/view/technik-informatyk-nysa/porady/porady-c-cpp#h.p_lz0skneGFILy)
*   [https://en.wikipedia.org/wiki/UTF-8](https://en.wikipedia.org/wiki/UTF-8)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-08-18T03:28:15.963

`'1060'`是四个字符，不会在标准下编译。如果您的宽字符与 Unicode 1:1 匹配（检查您的语言环境设置），您应该将字符视为数字。

```
int main (){
    wchar_t f = 1060;
    wcout << f << endl;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-01-29T13:57:34.533

我需要在 UI 中显示字符串并将其保存到 xml 配置文件中。上面指定的格式适用于 c++ 中的字符串，我想补充一下，我们可以通过将“\u”替换为“&#x”并添加一个“;”来获得特殊字符的 xml 兼容字符串 在末尾。

例如：C++：“\u0444”--> XML：`"&#x0444;"`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-01-09T10:59:26.737

在 Linux 中，我可以这样做：

```
std::cout << "ф"; 
```

[我只是从这里](https://unicode-table.com/en/)复制粘贴的字符，至少我尝试过的随机样本没有失败。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-12-06T11:54:06.243

Linux中的另一种解决方案：

```
string a = "Ф";
cout << "Ф = \xd0\xa4 = " << hex
     << int(static_cast<unsigned char>(a[0]))
     << int(static_cast<unsigned char>(a[1])) << " (" << a.length() << "B)" << endl;

string b = "√";
cout << "√ = \xe2\x88\x9a = " << hex
     << int(static_cast<unsigned char>(b[0]))
     << int(static_cast<unsigned char>(b[1]))
     << int(static_cast<unsigned char>(b[2])) << " (" << b.length() << "B)" << endl; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-09-14T06:44:13.563

特别感谢[这里](https://stackoverflow.com/a/1799310/1599699)或多或少相同问题的答案。

对我来说，我需要的只是**`setlocale(LC_ALL, "en_US.UTF-8");`**

然后，我什至可以使用原始`wchar_t`字符。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-05-23T09:34:46.613

在 Linux 上，Unicode 字符（UTF-16 / UTF-32）可以转换为 UTF-8 并打印到 std::cout。我使用了这些[功能](https://github.com/cflaviu/to_uft8/tree/main/inc/to_utf8)。

# pypy - 无法启动 PyPy Windows：找不到库路径

> ID：12015572
> 
> 赞同：1
> 
> 时间：2012-08-18T03:24:32.760
> 
> 标签：pypy

我在 64 位 Windows 8 上安装了 PyPy v1.9。我将包含 pypy.exe 二进制文件的文件夹添加到我的路径 (C:\Users\me\Documents\pypy-1.9)，但是当我尝试运行 PyPy 时，我收到以下错误消息：

> 调试：警告：未找到库路径，使用已编译的 sys.path
> 
> 调试：警告：不会设置“sys.prefix”。
> 
> 调试：警告：确保 pypy 二进制文件保存在其文件树中。
> 
> 调试：警告：可以从其他地方创建指向它的符号链接。
> 
> “导入站点”失败
> 
> Python 2.7.2（341e1e3821ff，2012 年 6 月 7 日，15:43:00）
> 
> [PyPy 1.9.0 与 MSC v.1500 32 位] 在 win32 上
> 
> 输入“帮助”、“版权”、“信用”或“许可”以获取信息。
> 
> 调试：操作错误：调试：
> 
> 操作错误类型：ImportError
> 
> 调试：操作错误值：没有名为 _pypy_interact 的模块

这只发生在尝试在其所在目录之外运行 PyPy 时。如果我直接运行 exe，命令提示符将打开并正确运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T22:04:04.610

我仍然不确定为什么会发生这种情况，但我确实找到了某种解决方案。我花了一点时间在通常保存 pypy.exe 的文件夹中创建了一个与 pypy 可执行文件（pypy.bat）同名的非常简单的批处理文件，并将 pypy.exe 重命名为 pypy_binary.exe（或其他任何东西，它其实没关系）。最重要的是，我提出了一个稍微笨拙的解决方法来将目录设置为我正在运行的文件所在的位置：将其作为参数传递给脚本。然后我检查一个参数，并切换到提供的目录 (os.chdir(sys.argv[1]))。

这是可能遇到此问题的任何其他人的批处理文件：

```
@echo off
set LAST=%CD%
pushd %~dp0
echo %LAST% > last.tmp
if "%1" == "" goto noargs

start /B /WAIT pypy_binary.exe "%LAST%\%1" "%LAST%"
goto finish

:noargs
start /B /WAIT pypy_binary.exe

:finish
popd 
```

附带说明：如果您使用 pypy 运行使用 pyglet 的程序，则需要编辑 'pyglet/libs/win32/ **__ *init* __****.py' 第 192 到 196 行（大约）。在 pypy 下，元组没有*****__itemsize___**属性，因此您需要输入 try/except，或者直接设置 '_user32.SetClassLongPtrW = _user32.SetClassLongW' 而无需 if/else。***

# html - css下拉菜单定位

> ID：12015574
> 
> 赞同：0
> 
> 时间：2012-08-18T03:24:39.400
> 
> 标签：html, css

有人可以看看我的下拉菜单，我遇到了一些子元素的问题。问题在于 .sublevel 类别。这是双重的，首先是我必须绝对定位它，这可能是一个问题，因为每次我需要它移动到不同的元素时我都必须更新它。

第二个显然是它显示不正确的事实，我不确定为什么。

这是 JSfiddle 链接：

[http://jsfiddle.net/ynwtN/3/](http://jsfiddle.net/ynwtN/3/)

过渡代码也不起作用：

```
#cssmenu .sublevel:hover > ul{
      padding: 18px 26px;
      left:170px;
      top: 200px;
      display: block;
      color: white;
      font-size: 13px;
      text-decoration: none;
      text-transform: uppercase;
      width: 150px;
      border-left: 4px solid transparent;
      -webkit-transition: all .35s ease-in-out;
      -moz-transition: all .35s ease-in-out;
      -ms-transition: all .35s ease-in-out;
      transition: all .35s ease-in-out;
      text-shadow: 0 -1px 0 #c28130;
      text-shadow: 0 -1px 0 rgba(151, 99, 33, .43);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T03:37:29.090

我编辑了你的代码....

尝试这个....

```
 #cssmenu .sublevel:hover > ul{
    padding: 18px 26px;
    left:155px;
     top: 150px;
    display: block;
    color: white;
    font-size: 13px;
    text-decoration: none;
    text-transform: uppercase;
    width: 150px;
    border-left: 4px solid transparent;
    -webkit-transition: all .35s ease-in-out;
    -moz-transition: all .35s ease-in-out;
    -ms-transition: all .35s ease-in-out;
    transition: all .35s ease-in-out;
    text-shadow: 0 -1px 0 #c28130;
    text-shadow: 0 -1px 0 rgba(151, 99, 33, .43);

} 
```

# c# - 将 ObservableCollection 绑定到 DataGridView

> ID：12015576
> 
> 赞同：8
> 
> 时间：2012-08-18T03:25:04.253
> 
> 标签：c#, winforms, datagridview

我将一个可观察的集合（FoodList）绑定到我的 WinForm 中的 BindingSource。此 BindingSource 由表单上的数据网格使用。我曾假设当我向集合中添加一个新项目时，它会引发一个事件，并且我的网格中会出现一个新行。这不会发生。

```
namespace Foods
{
    public class FoodList : ObservableCollection<Food>
    {

    }
}

private void frmFoods_Load(object sender, EventArgs e)
{
    try
    {
        foodSource = new Source("Foods.xml");
        foodBindingSource.DataSource = foodSource.Foods;
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message);
    }
}

private void AddFood()
{
    using (frmFood frm = new frmFood())
    {
        frm.ShowDialog(this);
        if (!frm.Canceled)
        {
            foodSource.Foods.Add(frm.Food);     // <-- No new row.
            //foodBindingSource.ResetBindings(false);
            foodDataGridView.ClearSelection();
            foodDataGridView.CurrentCell = foodDataGridView[0, foodDataGridView.Rows.Count - 1];
            foodDataGridView.Focus();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2017-04-27T16:25:12.780

`ObservableCollection<T>`不适用于 WinForms 控件。

但是[`BindingList<T>`](https://msdn.microsoft.com/en-us/library/ms132679(v=vs.110).aspx)会按您期望的方式工作。

# javascript - JavaScript - 将对象文字作为第二个参数传递给 Object.create()

> ID：12015579
> 
> 赞同：4
> 
> 时间：2012-08-18T03:25:26.763
> 
> 标签：javascript, object-literal

参考下面的 JavaScript 代码片段，问题：

1.  为什么对象字面量 {item: {value: "foobar"}} 在分配给变量时（如第 1 行）与作为参数传递给 Object.create() 时的行为不同（如第 5 行）？

2.  第 5 行和第 8 行有什么区别 - 即为什么第 5 行是将第二个参数传递给 Object.create() 而不是第 8 行（覆盖委托中的 item 属性）的正确方法？

代码片段：

```
 1 var obj = {item: {value: "foobar"}};
 2 console.log(obj.item);            // [object Object]
 3 console.log(obj.item.value);      // foobar

 4 var delegate = {item: "xxx"};
 5 var obj1 = Object.create(delegate, {item: {value: "foobar"}});
 6 console.log(obj1.item);          // foobar
 7 console.log(obj1.item.value);    // undefined

 8 var obj2 = Object.create(delegate, {item: "bar"});
 9 console.log(obj2.item);          // <nothing> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T03:34:04.187

发生这种情况是因为根据此参考：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create)

`Object.create`接收带有“属性描述符”作为第二个参数的对象，而不是普通`key:value`对。

有关属性描述符的描述，请参阅此博客文章：[http ://ejohn.org/blog/ecmascript-5-objects-and-properties/。](http://ejohn.org/blog/ecmascript-5-objects-and-properties/)

属性描述符是*描述*每个属性的对象，而不仅仅是属性值。从您的代码段：

```
2 obj.item // [object Object] since item is the object {value:"foobar¨}

6 obj1.item // foobar, the descriptor says that the value 
            // of item is "foobar"

7 obj1.item.value // undefined since item="foobar", value is part of
                  // the object that describes "item" not item itself

9 obj2.item  // nothing because the descriptor that you passed 
             // for item is incomplete 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T04:13:00.683

1.  在第 1 行中，您的对象字面量按字面意思解释并按您通常期望的方式实例化。

    而在第 5 行中，您的对象字面量是按字面意思解释的，但被传递到 Object.create 函数中，其中实例化的对象被视为“包含属性描述符的属性对象”。

2.  因为 Object.create 函数希望它的第二个参数遵循“属性对象”约定，所以您的第二个参数（第 8 行）无效（导致 Chrome 中的类型错误）。

以下片段可能有助于说明：

```
var PrototypeObj = { item: 'xxx' };

var PropertiesObj = {
  propertyDescriptor1: {
    value: "prop1value",
    writable: true,
    enumerable: true,
    configurable: true
  },
  propertyDescriptor2: {
    value: "prop2value",
    writable: true,
    enumerable: true,
    configurable: true
  }
};

var Obj = Object.create(PrototypeObj, PropertiesObj); 
```

这些文章更详细： [Object.create](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create)， [Object.defineProperty](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperty)。

# authorization - ABAP中授权对象和对象类的区别？

> ID：12015581
> 
> 赞同：4
> 
> 时间：2012-08-18T03:26:03.640
> 
> 标签：authorization, abap, sap-basis

我是一名 Java 开发人员，对 ABAP 了解有限。

在尝试理解 SAP 授权概念时，我遇到了授权对象和对象类这两个术语。

现在根据我对面向对象概念的理解，对象是类的运行时实例。

所以我对 ABAP 对象和对象类这个术语有点困惑。

有人可以回答我的以下问题：

1.  ABAP 中的“对象类”一词是什么意思？

2.  授权对象是什么意思？既然对象是在运行时创建的，那么我们如何在设计时创建对象呢？

任何回复都会有很大帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T06:16:14.910

好吧，我发现[这个很好的链接很好](http://sapstory.tistory.com/attachment/ik0.pdf)地解释了这些概念。

主要思想是：在 SAP 中，您会听到大量使用术语“类”和“对象”。它们的含义与 OO 中的概念不同。授权类只是对“您可以做什么”的一般描述，而授权对象是对此的更具体描述。

授权对象可用于以编程方式检查用户是否有权“x”...作为开发人员，您可能会忘记检查它们，这可能会导致安全问题:)。

# css - 仅当孩子悬停时如何更改父母的CSS？

> ID：12015585
> 
> 赞同：0
> 
> 时间：2012-08-18T03:27:21.777
> 
> 标签：css

正如标题所说..我有一个 PARENT 元素，它有一个 CHILD 元素（这里有两个 div！）

我想在（并且仅当）子元素悬停时更改父元素的背景颜色..

因此，如果父元素具有填充并且当光标悬停在填充上时，背景颜色 [css] 不会改变..它只会在子元素悬停时改变..

我可以用 css 来做，还是需要一些 javascript？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T03:31:15.153

你确实需要javascript。在[这里](https://stackoverflow.com/questions/1014861/is-there-a-css-parent-selector)查看一些关于它的好信息。

# ruby-on-rails - Rails-更改成员路由名称而不附加父名称

> ID：12015587
> 
> 赞同：1
> 
> 时间：2012-08-18T03:27:29.453
> 
> 标签：ruby-on-rails, routes

我定义了以下路线：

```
 resources :scenes do
    member do
      match 'files' => 'scenes#files', via: :get, as: 'scene_files'
    end
  end 
```

我希望能够将嵌套路由称为`scene_files_path`，但 Rails 坚持`scene`要在路径中添加一个额外的，所以我最终得到的是`scene_files_scene_path`. 如何获得我正在寻找的命名路线？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T04:12:30.017

我开始简化您的成员块

```
resources :scenes do
  get :files, :as => :scene_files, :on => :member
end 
```

然后我偶然发现

```
resources :scenes do
  get :files
end 
```

产生：

```
> rake routes
  scene_files GET       /scenes/:scene_id/files(.:format)     scenes#files
       scenes GET       /scenes(.:format)                     scenes#index
             POST       /scenes(.:format)                     scenes#create
    new_scene GET       /scenes/new(.:format)                 scenes#new
   edit_scene GET       /scenes/:id/edit(.:format)            scenes#edit
        scene GET       /scenes/:id(.:format)                 scenes#show
              PUT       /scenes/:id(.:format)                 scenes#update
           DELETE       /scenes/:id(.:format)                 scenes#destroy 
```

只有一个问题，参数键是`:scene_id`：`id`

# c++ - C++ char 单引号与双引号和内存内部工作原理

> ID：12015590
> 
> 赞同：4
> 
> 时间：2012-08-18T03:27:47.403
> 
> 标签：c++, iostream, cout, memory-address

我想知道程序在运行时在内存方面做了什么，因为它遇到了以下情况：

```
char chr = 'a';
char chrS[] = "a";
cout << "Address: " << &chr << endl;
cout << "Address: " << &chrS << endl; 
```

这会产生以下结果：

```
Address: a�c�3�
Address: 0x7fff33936280 
```

为什么我不能得到“chr”的内存地址？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-18T03:33:03.617

因为`&chr`产生一个`char*`（`const`这里的隐式添加）并`cout`假设它是一个字符串，因此以 null 结尾，但事实并非如此。

但是，`&chrS`产生 a `char(*)[]`，它不会衰减到 a `const char*`，因此将通过`operator<<(std::ostream&, const void*)`打印地址的重载输出。

如果您想要这种行为，`const char*`则必须执行显式强制转换。C 字符串和指向单个字符的指针之间没有区别这一事实是 C 字符串的主要缺陷之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T03:35:46.487

尝试

```
cout << "Address: " << hex << (long)(&chr) << endl; 
```

否则，当它获得指向 char 的指针时，它认为您正在给它一个字符串并尝试将其打印为一个字符串。

# javascript - 更改标题样式 jquery - css

> ID：12015591
> 
> 赞同：2
> 
> 时间：2012-08-18T03:27:54.990
> 
> 标签：javascript, jquery, css, title

我试图更改所有链接的标题样式，但是我刚刚发现如何为`<a>`链接而不是表单`<td>`和图像标题进行更改。任何人都可以帮助我使用 jquery 获得它。这是我拥有的代码：

```
 <!DOCTYPE html>
<html>
    <head>
        <title>Anchor Title Demo</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script src="http://code.jquery.com/jquery-1.6.1.min.js"></script>
        <script>

            $(document).ready(function() {

                $('body').append('<div id="anchorTitle" class="anchorTitle"></div>');

                $('a[title!=""]').each(function() {

                    var a = $(this);

                    a.hover(
                        function() {
                            showAnchorTitle(a, a.data('title')); 
                        }, 
                        function() { 
                            hideAnchorTitle();
                        }
                    )
                    .data('title', a.attr('title'))
                    .removeAttr('title');

                });

            });

            function showAnchorTitle(element, text) {

                var offset = element.offset();

                $('#anchorTitle')
                .css({ 
                    'top'  : (offset.top + element.outerHeight() + 4) + 'px',
                    'left' : offset.left + 'px'
                })
                .html(text)
                .show();

            }

            function hideAnchorTitle() {
                $('#anchorTitle').hide();
            }

        </script>

        <style>
            body {
                background-color: white;
                font-family: Helvetica, Arial, sans-serif;
                font-size: 14px;
            }
            /* title style
             */
            .anchorTitle {
                /* border radius */
                -moz-border-radius: 8px;
                -webkit-border-radius: 8px;
                border-radius: 8px;
                /* box shadow */
                -moz-box-shadow: 2px 2px 3px #e6e6e6;
                -webkit-box-shadow: 2px 2px 3px #e6e6e6;
                box-shadow: 2px 2px 3px #e6e6e6;
                /* other settings */
                background-color: #fff;
                border: solid 3px #d6d6d6;
                color: #333;
                display: none;
                font-family: Helvetica, Arial, sans-serif;
                font-size: 11px;
                line-height: 1.3;
                max-width: 200px;
                padding: 5px 7px;
                position: absolute;
            }
            * html #anchorTitle {
                /* IE6 does not support max-width, so set a specific width instead */
                width: 200px;
            }
        </style>
    </head>
    <body>

        <p>
            <a href="#" title="The title will appear in an box when the mouse is over the link">Hover over me</a>
        </p>
        <div>
            <input type="text"  title="The title will appear in an box when the mouse is over the link" name="styleSwitcher" placeholder="Hover over me" /><p></p><p></p>
             <dt title="The title will appear in an box when the mouse is over the link">Hover over me </dt>
        </div>

    </body>
</html> 
```

**演示：http:** [//jsfiddle.net/NVENA/2/](http://jsfiddle.net/NVENA/2/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T03:50:51.703

要使代码对具有非空`title`属性的所有元素进行更改，请`a`从

```
 $('a[title!=""]').each(function() { 
```

进行中

```
 $('[title!=""]').each(function() { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T03:48:33.997

您可以像这样添加额外的元素：

```
...

$('a[title!=""], input[title!=""], image[title!=""], td[title!=""], dt[title!=""]').each(function() {

... 
```

[http://jsfiddle.net/J3S9e/](http://jsfiddle.net/J3S9e/)

# java - 如何在长的特定位置设置/取消设置？

> ID：12015598
> 
> 赞同：29
> 
> 时间：2012-08-18T03:29:14.670
> 
> 标签：java, bit-manipulation, bitwise-operators

如何在 Java 中 long 的特定位置设置/取消设置？

例如，

```
long l = 0b001100L ; // bit representation 
```

我想在位置 2 设置位并在位置 3 取消设置位，因此对应的 long 将是，

```
long l = 0b001010L ; // bit representation 
```

有人可以帮我怎么做吗？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-08-18T03:35:10.213

要设置一点，请使用：

```
x |= 0b1; // set LSB bit
x |= 0b10; // set 2nd bit from LSB 
```

擦除一点使用：

```
x &= ~0b1; // unset LSB bit (if set)
x &= ~0b10; // unset 2nd bit from LSB 
```

切换一点使用：

```
x ^= 0b1; 
```

注意我使用 0b?。您还可以使用任何整数，例如：

```
x |= 4; // sets 3rd bit
x |= 0x4; // sets 3rd bit
x |= 0x10; // sets 9th bit 
```

但是，这使得更难知道哪个位正在被更改。

使用二进制可以让您查看将设置/擦除/切换的确切位。

要动态设置位，请使用：

```
x |= (1 << y); // set the yth bit from the LSB 
```

`(1 << y)`将 ...001 y 位向左移动，因此您可以将设置的位移动 y 位。

您还可以一次设置多个位：

```
x |= (1 << y) | (1 << z); // set the yth and zth bit from the LSB 
```

或取消设置：

```
x &= ~((1 << y) | (1 << z)); // unset yth and zth bit 
```

或切换：

```
x ^= (1 << y) | (1 << z); // toggle yth and zth bit 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-18T03:45:21.963

最低有效位 (lsb) 通常称为位 0，因此您的“位置 2”实际上是“位 1”。

```
long x = 0b001100;  // x now = 0b001100
x |= (1<<1);        // x now = 0b001110 (bit 1 set)
x &= ~(1<<2);       // x now = 0b001010 (bit 2 cleared) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-18T04:09:36.163

我会为此选择[BigInteger](http://docs.oracle.com/javase/1.4.2/docs/api/java/math/BigInteger.html) ...

```
class Test {
    public static void main(String[] args) throws Exception {
        Long value = 12L;
        BigInteger b = new BigInteger(String.valueOf(value));
        System.out.println(b.toString(2) + " " + value);
        b = b.setBit(1);
        b = b.clearBit(2);
        value = Long.valueOf(b.toString());
        System.out.println(b.toString(2) + " " + value);
    }
} 
```

这是输出：

```
1100 12
1010 10 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-18T03:52:29.410

*   将 long 转换为 bitset
*   设置您需要的位
*   将 bitset 转换回 long

有关将 long 转换为 bitset 的方法，请参阅这篇文章[BitSet 与 integer/long](https://stackoverflow.com/questions/2473597/bitset-to-and-from-integer-long)之间的转换，反之亦然

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-05-22T08:50:41.453

请参阅为您完成这项工作的 java.util.BitSet 类。

设置：`myByte.set(bit);` 重置：`myByte.clear(bit);` 填充布尔值：`myByte.set(bit, b);` 获取布尔值：`b = myByte.get(bit);`

# directx - DirectX的效果文件中的光状态如何工作

> ID：12015602
> 
> 赞同：1
> 
> 时间：2012-08-18T03:30:46.323
> 
> 标签：directx

我正在学习 DirectX 效果，我知道所有固定的管道渲染状态都可以在 .fx 文件中设置，当我想在 .fx 文件中设置点光源时，如何计算最终的像素颜色？光[0] 是从哪里来的？下面是 .fx 文件的代码，我不知道如何编写像素着色器部分（BasicPS）来计算最终颜色。

```
 // World, View and Projection Matrix 
    uniform extern float4x4 gWVP;  

    // Output Vertex structure 
    struct OutputVS 
    { 
          float4 posH : POSITION0; 
    }; 

    OutputVS BasicVS(float4 posL : POSITION0) 
    { 

          // Zero out our output. 
          OutputVS outVS = (OutputVS)0; 

          // Transform to homogeneous clip space. 
          outVS.posH = mul(posL, gWVP); 

          // Done--return the output. 
          return outVS; 
    } 

    float4 BasicPS() : COLOR 
    { 
        //What to write here? 
    } 

    technique Tech1 
    { 
        pass p0 
        { 
            vertexShader = compile vs_2_0 BasicVS(); 
            pixelShader  = compile ps_2_0 BasicPS(); 

            Lighting = True; 
            LightEnable[0] = True; 
            LightType[0] = POINT; 

            // Light color is white 
            LightAmbient[0] = {0.6f, 0.6f, 0.6f, 0.0f}; 
            LightDiffuse[0] = {1.0f, 1.0f, 1.0f, 0.0f}; 
            LightSpecular[0] = {0.6f, 0.6f, 0.6f, 0.0f}; 

            // Light position 
            LightPosition[0] = {10.0f, 10.0f, -5.0f}; 

            // Light range 
            LightRange[0] = 1000.0f; 

            // Light falloff 
            LightFalloff[0] = 1.0f; 

            // Attenuations 
            LightAttenuation0[0] = 1.0f; 
            LightAttenuation1[0] = 0.0f; 
            LightAttenuation2[0] = 0.0f; 
        } 
    } 

the cpp file of this program as below

    #include <d3dx9.h>
    #include <MMSystem.h>

    LPDIRECT3D9             g_pD3D              = NULL ; // Used to create the D3DDevice
    LPDIRECT3DDEVICE9       g_pd3dDevice        = NULL ; // Our rendering device
    ID3DXMesh*              g_pTeapotMesh       = NULL ; // Hold the teapot
    ID3DXEffect*            g_pEffect           = NULL ; // Effect interface
    bool                    g_bActive           = true ; // Is window active?

    // Handles for effects
    D3DXHANDLE g_hWVP;      // world, view and projection matrix handle.
    D3DXHANDLE g_hTech;     // Technique handle

    #define SAFE_RELEASE(P) if(P){ P->Release(); P = NULL;}

    HRESULT BuildEffect()
    {
        char* effectFile = "./PointLight.fx";

        ID3DXBuffer* errors = 0;

        // Create Effect from file
        HRESULT hr = D3DXCreateEffectFromFile(
            g_pd3dDevice,
            effectFile, 
            NULL,
            NULL,
            D3DXSHADER_DEBUG,
            NULL,
            &g_pEffect,
            &errors);
        if( errors )
            MessageBox(0, (char*)errors->GetBufferPointer(), 0, 0);

        g_hWVP  = g_pEffect->GetParameterByName(0, "gWVP");
        g_hTech = g_pEffect->GetTechniqueByName("Tech1");

        return D3D_OK;
    }

    HRESULT SetupPointLight()
    {
        D3DLIGHT9 pointLight;
        ZeroMemory(&pointLight, sizeof(pointLight));

        // Set light
        g_pd3dDevice->SetLight(0, &pointLight);

        return D3D_OK;
    }

    HRESULT SetupMaterial()
    {
    D3DMATERIAL9 material;
    ZeroMemory(&material, sizeof(material));

    D3DXCOLOR red = D3DCOLOR_XRGB(255, 0, 0);
    material.Ambient = red;
    material.Diffuse = red;
    material.Specular = red;
    material.Emissive = D3DXCOLOR(0, 0, 0, 0);
    material.Power = 2.0f; // only affect specular color

    g_pd3dDevice->SetMaterial(&material);

    return D3D_OK;
    }

    HRESULT InitD3D( HWND hWnd )
    {
        // Create the D3D object, which is needed to create the D3DDevice.
        if( NULL == ( g_pD3D = Direct3DCreate9( D3D_SDK_VERSION ) ) )
        {
            MessageBoxA(NULL, "Create D3D9 object failed!", "Error", 0) ;
            return E_FAIL;
        }

        D3DPRESENT_PARAMETERS d3dpp; 
        ZeroMemory( &d3dpp, sizeof(d3dpp) );

        d3dpp.Windowed = TRUE; // use window mode, not full screen
        d3dpp.SwapEffect = D3DSWAPEFFECT_DISCARD;
        d3dpp.BackBufferFormat = D3DFMT_UNKNOWN;

        // Create device
        if( FAILED( g_pD3D->CreateDevice( D3DADAPTER_DEFAULT, D3DDEVTYPE_HAL, hWnd,
            D3DCREATE_SOFTWARE_VERTEXPROCESSING,
            &d3dpp, &g_pd3dDevice ) ) )
        {
            MessageBoxA(NULL, "Create D3D9 device failed!", "Error", 0) ;
            return E_FAIL;
        }

        // Create teapot
        D3DXCreateTeapot(g_pd3dDevice, &g_pTeapotMesh, NULL) ;

        // Build effect
        BuildEffect();

        return S_OK;
    }

    void DrawTeapot()
    {
        // translate model to origin
        D3DXMATRIX world ;
        D3DXMatrixTranslation(&world, 0.0f, 0.0f, 0.0f) ;
        g_pd3dDevice->SetTransform(D3DTS_WORLD, &world) ;

        // set view
        D3DXVECTOR3 eyePt(0.0f, 0.0f, -10.0f) ;
        D3DXVECTOR3 upVec(0.0f, 1.0f, 0.0f) ;
        D3DXVECTOR3 lookCenter(0.0f, 0.0f, 0.0f) ;

        D3DXMATRIX view ;
        D3DXMatrixLookAtLH(&view, &eyePt, &lookCenter, &upVec) ;
        g_pd3dDevice->SetTransform(D3DTS_VIEW, &view) ;

        // set projection
        D3DXMATRIX proj ;
        D3DXMatrixPerspectiveFovLH(&proj, D3DX_PI / 4, 1.0f, 1.0f, 1000.0f) ;
        g_pd3dDevice->SetTransform(D3DTS_PROJECTION, &proj) ;

        D3DXMATRIX worldviewproj = world * view * proj;

        // Set matrix
        g_pEffect->SetMatrix(g_hWVP, &worldviewproj);

        // Set technique
        g_pEffect->SetTechnique(g_hTech);

        // Render pass
        UINT numPass = 0;
        g_pEffect->Begin(&numPass, 0);
        g_pEffect->BeginPass(0);
        g_pTeapotMesh->DrawSubset(0);
        g_pEffect->EndPass();
        g_pEffect->End();
    }

    VOID Cleanup()
    {
        SAFE_RELEASE(g_pTeapotMesh) ;
        SAFE_RELEASE(g_pd3dDevice) ;
        SAFE_RELEASE(g_pD3D) ;
    }

    void Render(float timeDelta)
    {
        if (!g_bActive)
        {
            Sleep(50) ;
        }

        SetupMaterial();

        SetupPointLight();

        // Clear the back-buffer to a RED color
        g_pd3dDevice->Clear( 0, NULL, D3DCLEAR_TARGET, D3DCOLOR_XRGB(0,0,0), 1.0f, 0 );

        // Begin the scene
        if( SUCCEEDED( g_pd3dDevice->BeginScene() ) )
        {
            // Draw teapot 
            DrawTeapot();

            // End the scene
            g_pd3dDevice->EndScene();
        }

        // Present the back-buffer contents to the display
        g_pd3dDevice->Present( NULL, NULL, NULL, NULL );
    }

    LRESULT WINAPI MsgProc( HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam )
    {
        switch( msg )
        {
        case WM_KEYDOWN:
            {
                switch( wParam )
                {
                case VK_ESCAPE:
                    SendMessage( hWnd, WM_CLOSE, 0, 0 );
                    break ;
                default:
                    break ;
                }
            }
            return 0 ;

        case WM_SIZE:
            if(wParam == SIZE_MAXHIDE || wParam == SIZE_MINIMIZED)
                g_bActive = false;
            else
                g_bActive = true;
            return 0;

        case WM_ACTIVATEAPP:
            if(wParam == TRUE)
                g_bActive = true ;
            else
                g_bActive = false ;
            return 0 ;

        case WM_DESTROY:
            Cleanup();
            PostQuitMessage( 0 );
            return 0;
        }

        return DefWindowProc( hWnd, msg, wParam, lParam );
    }

    INT WINAPI wWinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPWSTR szCmdLine, int iCmdShow)
    {
        WNDCLASSEX winClass ;

        winClass.lpszClassName = "Teapot";
        winClass.cbSize        = sizeof(WNDCLASSEX);
        winClass.style         = CS_HREDRAW | CS_VREDRAW;
        winClass.lpfnWndProc   = MsgProc;
        winClass.hInstance     = hInstance;
        winClass.hIcon         = NULL ;
        winClass.hIconSm       = NULL ;
        winClass.hCursor       = LoadCursor(NULL, IDC_ARROW) ;
        winClass.hbrBackground = NULL ;
        winClass.lpszMenuName  = NULL ;
        winClass.cbClsExtra    = 0;
        winClass.cbWndExtra    = 0;

        RegisterClassEx (&winClass) ;  

        HWND hWnd = CreateWindowEx(NULL,  
            winClass.lpszClassName,     // window class name
            "Teapot",                   // window caption
            WS_OVERLAPPEDWINDOW,        // window style
            32,                         // initial x position
            32,                         // initial y position
            600,                        // initial window width
            600,                        // initial window height
            NULL,                       // parent window handle
            NULL,                       // window menu handle
            hInstance,                  // program instance handle
            NULL) ;                     // creation parameters

        // Create window failed
        if(hWnd == NULL)
        {
            MessageBoxA(hWnd, "Create Window failed!", "Error", 0) ;
            return -1 ;
        }

        // Initialize Direct3D
        if( SUCCEEDED(InitD3D(hWnd)))
        { 
            // Show the window
            ShowWindow( hWnd, SW_SHOWDEFAULT );
            UpdateWindow( hWnd );

            MSG msg ; 
            ZeroMemory( &msg, sizeof(msg) );
            PeekMessage( &msg, NULL, 0U, 0U, PM_NOREMOVE );

            // Get last time
            static DWORD lastTime = timeGetTime();

            while (msg.message != WM_QUIT)  
            {
                if(PeekMessage( &msg, NULL, 0U, 0U, PM_REMOVE ) != 0)
                {
                    TranslateMessage (&msg) ;
                    DispatchMessage (&msg) ;
                }
                else // Render the game if there is no message to process
                {
                    // Get current time
                    DWORD currTime  = timeGetTime();

                    // Calculate time elapsed
                    float timeDelta = (currTime - lastTime) * 0.001f;

                    // Render
                    Render(timeDelta) ;

                    // Update last time to current time for next loop
                    lastTime = currTime;
                }
            }
        }

        UnregisterClass(winClass.lpszClassName, hInstance) ;
        return 0;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T15:06:10.820

最后我自己想通了，vertex shader和pixel shader不能省略，如果不想用shader计算光照，可以指定为null

```
pixelShader = null;
pixelShader = null; 
```

# regex - 将接受一组字符串的正则表达式 A 转换为接受 A 匹配的字符串的所有前缀的正则表达式

> ID：12015612
> 
> 赞同：2
> 
> 时间：2012-08-18T03:33:22.570
> 
> 标签：regex

给定任何正则表达式 A，有没有办法将其转换为另一个正则表达式 B，它接受 A 接受的所有字符串和字符串的前缀。

例如，如果 /apple/ 是给定的正则表达式，是否有通用方法将其转换为 /a|ap|app|appl|apple/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T06:35:21.913

如果您正在谈论[正式的正则表达式](http://en.wikipedia.org/wiki/Regular_expression#Formal_definition)（即描述[正则语言](http://en.wikipedia.org/wiki/Regular_language)的正则表达式），那么这里有一个将正则表达式转换为接受前缀的正则表达式的过程。

任何正则表达式都有一个[DFA](http://en.wikipedia.org/wiki/Deterministic_finite_automaton)；这是 DFA `/apple/`（省略了到故障状态的转换）：

![/apple/ 的 DFA](../Images/08f47d38439ac39b7b0a6ca13703e652.png)

要生成匹配此 DFA 接受的字符串前缀的 DFA，如果它们位于导致原始 DFA 中接受状态的路径上，则将状态转换为[接受状态：](http://en.wikipedia.org/wiki/Finite_state_machine#Accept_.28or_final.29_states)

![/apple/ 前缀的 DFA](../Images/95d7f342e8508f6751ce5b947e71dcc9.png)

有[几种方法](http://neumannhaus.com/christoph/papers/2005-03-16.DFA_to_RegEx.pdf)可以从 DFA 中读取正则表达式。如果我们使用状态移除技术，我们会得到以下 DFA：

![/apple/ 前缀的 DFA，在状态消除后](../Images/948ad800d588ff99da63cd374369e810.png)

这对应于正则表达式`/a|ap|app|appl|apple|/`，加上空字符串（因为空字符串是任何正则表达式的前缀）。

这个`apple`例子很简单，但同样的技术可以用于更复杂的正则表达式。例如，考虑`/(00)*1(00|1)*/`：

![/(00)*1(00|1)*/ 的 DFA](../Images/6f06d687a3c8d459ee4fa80f8d119103.png)

此 DFA 接受字符串`00100`但不接受`0010101`. 在将适当的状态转换为最终状态并组合两个相同的状态后，我们有

![/(00)*1(00|1)*/ 前缀的 DFA 略微最小化](../Images/d668412ad4bb4d87fb5507aa44d7a41e.png)

这相当于

![在此处输入图像描述](../Images/43dcdd762042b28c106feb689b73670a.png)

我们可以从中读取正则表达式`/(00)*(0?|1(1|00)*0?)/`，其中包括空字符串。

此正则表达式拒绝`00101`，因为它会导致原始 DFA 转换为失败状态，但接受“0”和“00”，因为这些字符串不会导致原始 DFA 进入失败状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-17T13:35:50.650

显然可以通过转换为有限状态机，将所有状态更改为接受状态并转换回来来完成，如@JoshRosen 的回答所示。

这是一个更直接的算法。[为简单起见，我将在这里](https://en.wikipedia.org/wiki/Regular_expression#Formal_definition)假设正则表达式的正式定义。因此，表达式是从空字符串、文字字符和运算符连接、交替 ('|') 和 Kleene 星号 ('*') 递归构建的。我还将包括运算符“？”，这`A?`是 . 的缩写`(|A)`。

我们想要定义一个转换 P，它接受任何正则表达式 A 并输出一个正则表达式 B=P(A)，它完全接受 A 接受的前缀。以下 P 的简单递归定义将做到这一点：

```
P(empty string) = empty string
P(c) = c?   if c is a literal character
P(A?) = P(A)
P(A*) = (A* P(A))
P(A B) = (P(A) | (A P(B)))
P(A|B) = (P(A) | P(B)) 
```

当然，正确性的证明是通过对正则表达式结构的归纳：观察它对于空字符串和文字字符是正确的，并且如果它对于`A`and是正确的`B`，那么它对于`A B`, `A|B`, `A*`, and也是正确的`A?`。

我们还可以添加以下规则，这不是绝对必要的，但在文字字符串的常见情况下（即几个文字字符的连接）会导致更有效的输出表达式：

```
P(a B) = (a P(B))?  when a is a literal character 
```

## 例子

考虑正则表达式`/abc/`。通常我们不指定或关心连接运算符是左结合还是右结合，因为结果接受的语言是相同的。但是，让我们以两种方式解决它。

如果我们将连接视为从左到右的关联：

```
P(/abc/) = P((a b) c)
         = P(a b) | ((a b) P(c))
         = P(a b) | ((a b) c?)
         = (a P(b))? | ((a b) c?)
         = (a b?)? | ((a b) c?)
         = /(ab?)?|abc?/ 
```

或者，如果我们将连接视为从右到左的关联，我们通过简单地重复应用规则获得更有效的（线性大小，[不重复自身](https://en.wikipedia.org/wiki/Don%27t_repeat_yourself)）输出：`P(a B) = (a P(B))?`

```
P(/abc/) = P(a (b c))
         = (a P(b c))?
         = (a (b P(c))?)?
         = (a (b c?)?)?
         = /(a(bc?)?)?/ 
```

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-08-18T03:42:19.580

取决于您所说的*广义方式*是什么意思。

```
\b(a(p?(p?(l?(e?)))))\b 
```

**编辑：**加法背后的积极看法将代表一个更好的解决方案，但这完全取决于正则表达式机器的实现。

# objective-c - 循环遍历表视图单元格

> ID：12015613
> 
> 赞同：0
> 
> 时间：2012-08-18T03:33:30.917
> 
> 标签：objective-c, ios

```
for(NSUInteger j = 0 ; j < [sports count] ; j++){

    NSIndexPath *loopPath = [NSIndexPath indexPathWithIndex:j]; 

    if([pickerTable cellForRowAtIndexPath:loopPath].accessoryType == UITableViewCellAccessoryCheckmark){

        [chosenSports addObject:[pickerTable cellForRowAtIndexPath:loopPath].textLabel.text];                          

    }

} 
```

此代码会产生 sigabrt 错误。确切的错误是“与 UITableView 一起使用的索引路径无效。传递给表视图的索引路径必须恰好包含两个指定部分和行的索引。如果可能，请使用 UITableView.h 中 NSIndexPath 上的类别。” 提前致谢;

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T03:40:26.773

错误是正确的。 [NSIndexPaths](http://developer.apple.com/library/ios/#documentation/uikit/reference/NSIndexPath_UIKitAdditions/Reference/Reference.html)由一行和一个节号组成，考虑到它们实际上对您的实现是多么盲目（考虑到它们依赖于数据源和委托），对于表视图尤其如此。你有一个简单的初始化错误，试试这个：

```
for(NSUInteger j = 0 ; j < [sports count] ; j++){

    NSIndexPath *loopPath = [NSIndexPath indexPathForRow:j inSection:0]; 

    if([pickerTable cellForRowAtIndexPath:loopPath].accessoryType == UITableViewCellAccessoryCheckmark){

        [chosenSports addObject:[pickerTable cellForRowAtIndexPath:loopPath].textLabel.text];                          

    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T07:29:35.880

除了@CodaFi 的回答，您应该知道`cellForRowAtIndexPath`返回`nil`当前不可见的行。

因此，您的循环仅添加当前可见单元格中的对象，这可能不是您想要的。

# c# - 在 C# 中的文本框模糊上运行函数

> ID：12015614
> 
> 赞同：2
> 
> 时间：2012-08-18T03:33:36.097
> 
> 标签：c#, .net

在 C# 中，当文本框失去焦点时，您会将事件附加到什么事件？我的功能将是这样的：

```
private void txtModifier1_Blur(object sender, EventArgs e)
{
    // code...
} 
```

...我会这样分配它：

```
this.txtModifier1.Blur += new System.EventHandler(this.txtModifier1_Blur); 
```

...但没有`Blur`. 有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T03:39:48.480

假设这是 Windows 窗体，您正在寻找该`Leave`事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T03:40:24.257

如果您使用的是[Windows 窗体 TextBox](http://msdn.microsoft.com/en-us/library/48deaakc)控件。它有一个[LostFocus](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.lostfocus)事件，继承自`Control`. 还有[离开](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.leave)事件。在大多数情况下，您应该使用 Leave 事件。请参阅我链接的两个 MSDN 页面上的注释。

像这样的东西：

```
this.txtModifier1.Leave += new System.EventHandler(this.txtModifier1_Leave); 
```

如果您使用的是[WPF TextBox](http://msdn.microsoft.com/en-us/library/system.windows.controls.textbox.aspx)，那么再次，它有一个[LostFocus 事件](http://msdn.microsoft.com/en-us/library/system.windows.uielement.lostfocus)继承自`UIElement`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-18T03:40:30.730

[asp.net 文本框失去焦点？](https://stackoverflow.com/questions/3863927/lost-focus-method-for-asp-net-textbox)

[WPF 失去焦点](https://stackoverflow.com/questions/103575/wpf-validation-not-firing-on-first-lostfocus-of-the-textbox)

[WinForms 失去焦点](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.lostfocus.aspx)

# exception - c# Windows Fors ListBox1.SelectedIndex ArguementOutofRange 错误

> ID：12015620
> 
> 赞同：-1
> 
> 时间：2012-08-18T03:35:33.520
> 
> 标签：exception, listbox, outofrangeexception, listbox-control

请一些人帮助我的代码，我一次又一次地得到 ArguementOutofRange 异常。请告诉我我做错了什么。我为此尝试了每个循环，但它总是给出 ArgueOutofrange 错误。

例外是：-

“InvelidArguement = '3' 的值对 'SelectedIndex' 无效。参数名称：SelectedIndex”

&

警告是：

“异常的结果总是'true'，因为'int'类型的值永远不会等于'int'类型的'null'？'”

这是我的代码：

```
public partial class Form1 : Form
    {
        public Form1()
        {
        InitializeComponent();
        listBox1.Items.Add("www.google.com");
        listBox1.Items.Add("www.facebook.com");
        listBox1.Items.Add("www.yahoo.com");
        listBox1.SelectedIndex = 0;
        listBox1.DataSource = listBox1.Items;

        }

    private void button1_Click(object sender, EventArgs e)
    {
        var num = listBox1.Items.Count;
        string str = Convert.ToString(num);
        textBox1.Text = str;
        for (int i = 0; i < num; )
        {
            webBrowser1.Navigate(listBox1.SelectedItem.ToString());
            while (webBrowser1.ReadyState != WebBrowserReadyState.Complete)
            {
                Application.DoEvents();
                if (webBrowser1.ReadyState == WebBrowserReadyState.Complete)
                {
                    listBox1.SelectedIndex = listBox1.SelectedIndex + 1;
                }
            }
        }
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        var num = listBox1.Items.Count;
        string str = Convert.ToString(num);
        textBox1.Text = str;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T03:52:54.543

首先，帮自己一个忙，看看`BackgroundWorker`而不是`DoEvents`。`DoEvents 是错误的。

除了在一个问题中倾倒几十行代码并要求人们找出问题所在并修复它之外，您真的没有给我们太多的帮助。 **如果您希望人们帮助您，则发生****异常**的地方是常见的礼貌。

 **问题可能*出*`SelectedIndex`在in分配的行上`button1_Click`。如果浏览器中的所有项目都成功，您将选择的索引设置为 3，最高有效索引为 2。**

# java - 所有值类型都不可变的任何 Java XML 树库

> ID：12015622
> 
> 赞同：4
> 
> 时间：2012-08-18T03:36:49.770
> 
> 标签：java, xml

我只是想知道那里有没有好的完整的。我所说的不可变是指始终不可变的。如果库包含 freeze() 或等效方法以使某些值实例不可变，那么请在您的回复中记下这一点。我最感兴趣的是在对所述节点进行更改时返回新副本的库。

首先，我将列出一些不是不可变的常见库。

[http://xerces.apache.org/xerces-j/apiDocs/org/w3c/dom/Element.html](http://xerces.apache.org/xerces-j/apiDocs/org/w3c/dom/Element.html)

> removeAttributeNS(java.lang.String namespaceURI, java.lang.String localName) 通过本地名称和命名空间 URI 删除属性。void setAttribute(java.lang.String name, java.lang.String value) 添加一个新属性。

[http://www.jdom.org/docs/apidocs/org/jdom2/Comment.html](http://www.jdom.org/docs/apidocs/org/jdom2/Comment.html)

> Comment setText(java.lang.String text) 这将设置 Comment 的值。

*请注意*，所有重要的类都包括 setter。

[http://www.xom.nu/apidocs/index.html?nu/xom/Attribute.html](http://www.xom.nu/apidocs/index.html?nu/xom/Attribute.html)

> setType(Attribute.Type 类型)
> 
> ```
>  Sets the type of this attribute to one of the ten DTD types or Type.UNDECLARED.  void  setValue(String value) 
> 
>        Sets the attribute's value to the specified string, replacing any previous value. 
> ```

如果您对不可变性杀死性能有任何意见，那么可以自由发表意见，但要提供一些真正美味的信息，而不是无聊的意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T06:48:02.570

也许您只是使用了错误的语言——Scala 和 Clojure 都有带有不可变节点的 XML 库。我认为不可变数据结构的概念在 Java 社区中还不够流行，以至于有人基于它来开发整个生产就绪的 XML 库。

如果您愿意引入整个 Scala 库 jar，那么也许您可以围绕[Anti-XML](http://anti-xml.org/)库编写一些不错的 Java 包装器并使用它。可以从 Java*代码*调用 Scala 库，但根据我的经验，这有点痛苦。

***更新：***

由于您似乎没有得到任何其他点击，这可能是您最可行的选择。我之前正在研究它，用 Java 为 Anti-XML 编写一个包装器将是一个*可怕的痛苦*——但在 Scala 中编写一个 Java 友好的接口然后从 Java 访问该接口并不是那么糟糕。Anti-XML 的[Zippers](http://anti-xml.org/zippers.html)似乎正是您通过复制来更新不可变 XML 树所需要的。对深拉链的支持似乎有点不便，但它可能不会破坏交易。

# c++ - gcc选项“-fmessage-length”的含义是什么？

> ID：12015624
> 
> 赞同：30
> 
> 时间：2012-08-18T03:37:24.593
> 
> 标签：c++, c, gcc, compiler-construction

我正在使用 CDT（用于 c 语言的eclipse）。我发现默认的 gcc 编译器选项是`-O0 -g3 -Wall -c -fmessage-length=0`. 是什么意思`-fmessage-length`？那应该是`-fflag`，但是呢`message-length`？我没有在[GCC Command-Line Options](http://tigcc.ticalc.org/doc/comopts.html)中找到它。感谢您的考虑。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-08-18T03:40:45.873

> 我没有在 GCC 命令行选项中找到它。

那是因为您正在查看[“ GCC 手册的命令行选项部分的*修改版本”。*](http://tigcc.ticalc.org/doc/comopts.html)

[这是所有可能的 GCC 命令行选项的*官方*](http://gcc.gnu.org/onlinedocs/gcc/Option-Index.html)列表，它导致本节：[“3.7 控制诊断消息格式的选项”](https://gcc.gnu.org/onlinedocs/gcc/Diagnostic-Message-Formatting-Options.html#Diagnostic-Message-Formatting-Options)。这是该部分必须说的：

> **3.7 控制诊断消息格式的选项**
> 
> 传统上，诊断消息的格式与输出设备的外观无关（例如，它的宽度，...）。您可以使用下面描述的选项来控制诊断消息的格式化算法，例如每行有多少字符，应该多久报告一次源位置信息。请注意，某些语言前端可能不支持这些选项。
> 
> *-f消息长度=n*
> 
> 尝试格式化错误消息，使其适合大约 n 个字符的行。g++ 的默认值为 72 个字符，GCC 支持的其余前端为 0。如果 n 为零，则不进行换行；每条错误消息都出现在一行中。
> 
> ...

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-18T03:41:18.877

gcc 的手册页说

```
-fmessage-length=n
       Try to format error messages so that they fit on lines of about n characters.  The default is 72 characters for g++ and 0 for the rest of the front ends supported by GCC.  If n is
       zero, then no line-wrapping will be done; each error message will appear on a single line. 
```

只是错误消息的格式选项。

# jira - 从 Gerrit 到 Crucible

> ID：12015628
> 
> 赞同：11
> 
> 时间：2012-08-18T03:38:21.067
> 
> 标签：jira, gerrit, atlassian-crucible

我们目前使用 Gerrit，用于一个由大约十几个开发人员组成的团队。

这是我们当前的工作流程：
1\. 开发人员从 master 分支
2\. 开发人员在他们的本地分支上工作
3\. 开发人员推送到 gerrit，它通过在 refs/for/master 中包含推送的提交来保护 master 分支。（如果您不知道，gerrit 也是一个存储库管理器。）
4\. Gerrit 调用 Jenkins，在变更集上运行单元测试（和 Selenium 测试）。如果失败，提交将被踢回开发人员。否则，詹金斯 +1s 提交。
5\. 审阅者查看提交并对其 +1
6\. 高级审阅者查看提交并对其 +2 并且变更集被合并到 refs/head/master（即实际分支）

我们喜欢这个工作流程；这很棒。它为我们的开发带来了美妙且急需的流程和纪律，并从我们之前被忽视和忽视的代码审查瓶颈中列出了待办事项，每个人都为此感到高兴。

x - 中场休息 - x

我们现在希望将我们的任务管理转移到 Jira。在我设置它的同时，我还设置了 Crucible，因为它似乎是让代码审查成为整个 shebang 的一部分的自然集成。我无法做的是在我们喜欢的上面重现我们的工作流程。借助 Jira/Crucible 集成，由于我们不再拥有存储库的一切看门人（而且我们不想为 Atlassian 的 Stash 付费），我们会将代码推送到 Bitbucket。我们不能再直接在 master 上工作，因为坏代码将不再是“门控”，而是在通过任何测试或代码审查之前由开发人员合并到 master 中。将其排除在主分支之外的唯一解决方案似乎是分叉。好吧，这很烦人，但我可以接受。但是我如何从开发人员那里获得提交' s fork 在通过代码审查后合并到主分支？这就是我想从做过任何类似事情的人那里听到的，或者根据我的情况知道如何完成它。

所有这一切的替代方法是尝试使用[https://github.com/hobbs/jirret](https://github.com/hobbs/jirret)强制 Jira 和 Gerrit 之间的集成，但它使用 Jira 仍然支持但不再进行任何开发的 XML RPC。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T17:17:46.990

Vic，要从开发人员的分支中获取更改并将它们带入原始存储库的主代码行，您可以在 Bitbucket 中使用拉取请求。它们是对您正在进行的 Crucible 代码审查的补充。如果分叉很痛苦，您可以尝试在您的存储库中创建一个“集成”分支，并让开发人员经常在那里推送代码（甚至在他们准备好进行同行评审之前）。该分支成为一种汤，集成问题可以浮出水面并得到解决，而不会污染 master。Atlassian 的一些开发团队使用集成分支，并利用 Bamboo 的支持自动将 CI 方案应用到新分支，并在每次构建时自动合并分支。通常，你' d 每次将代码推送到 dev 分支时，让 Bamboo 将您的 dev 分支合并到集成中。非常有助于及早发现冲突。

链接到的博客 Matt 更详细地描述了这种工作流程。无论您使用什么 CI 工具，基本工作流程都可以成功（但 Bamboo 确实对它提供了非常好的支持和出色的 JIRA 集成）。

我希望这有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T09:26:15.237

如果您不介意进行一些编程，您可以使用[Jira 脚本套件](https://marketplace.atlassian.com/16346)来使用 Jira 工作流事务在您的服务器上运行实际代码，并相应地更新问题内容/状态。要显示动态内容（来自本地文件或任何远程服务器），您可以使用[Jira 行为插件](https://studio.plugins.atlassian.com/wiki/display/JBHV/JIRA+Behaviours+Plugin) 并[使用 Javascripts 和 HTML 代码](https://confluence.atlassian.com/display/JIRA/Fields+Allowing+Custom+HTML+or+JavaScript)。

正如我所说，这需要一些编程，但您可以将原始工作流程与 Jira 集成。

一个小提示——虽然*“Jira 仍然支持但不会再做任何开发的 XML RPC”*这个 API 非常强大并且具有一些其他 API 所缺乏的功能，所以即使它不会在未来被开发，你可能会发现它可以满足您的大部分需求。

希望有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T20:22:48.833

我现在在 Bitbucket 的跟踪器上打开了一张票，询问一个非常相似的事情：[https ://bitbucket.org/site/master/issue/5652/allow-for-pull-requests-to-require](https://bitbucket.org/site/master/issue/5652/allow-for-pull-requests-to-require)

不幸的是，我从 Atlassian 得到的答案似乎是“抱歉，我们不会那样做。请购买 Stash。” 我们遇到的问题是 Stash 目前不是托管解决方案，我们没有计划建立自己的基础设施来托管它（事实上，我们以前做过，但在与 Atlassian 交谈后最终迁移到他们的托管解决方案）。考虑到他们已经在 Stash 中完成了这项工作，我不太确定他们为什么不将其作为 Bitbucket 的“企业”功能提供。就目前而言，我认为我能做的就是让人们对那张票发表评论，以表明开发人员对这些类型的工作流非常感兴趣（这一特性将它与 GitHub 区分开来！）。

# android - 无论屏幕尺寸如何，如何将视图定位在背景层上的特定点？

> ID：12015629
> 
> 赞同：0
> 
> 时间：2012-08-18T03:39:31.203
> 
> 标签：android, layout, view, position, overlay

我想在图像背景上的预定义位置放置一组视图。

像这样： ![在此处输入图像描述](../Images/1d7964251697497fd46311392c4f8588.png)

我可以使用顶部/左侧边距或 android:TranslationX/android:TranslationY 在 XML 中设置每个咖啡杯视图的位置。

当应用程序在不同尺寸的屏幕上启动时，我的背景层将拉伸到新布局，但是**如何更改视图的顶部/左侧边距？**

理想情况下，我只需在 XML 中将每个视图的位置标记为距父级左侧 x% 和距父级顶部 y% 的位置。（动画可以像这样工作）。该选项似乎不可用。

我考虑过的一些探索：

*   **使用布局权重。**如果我只对垂直或水平位置感兴趣，这将解决问题，但我看不到如何同时做这两个。

*   **针对特定的参考屏幕尺寸进行设计，使用边距来定位杯子，然后在运行时缩放视图的顶部/左侧边距。**这涉及在运行时读取起始边距并将其重置为参考屏幕的一部分。如果我的参考屏幕是 1000 像素宽并且我在 750 像素宽的屏幕上运行，我可以读取 layoutParams，将左边距乘以 (750/1000)，然后将生成的左边距写回布局。但是 getLayoutParams 并没有给我一个有边距的对象。

*   我最接近这项工作的是**设置 android:translationX 和 android:translationY。**原则上，将这些值设置为在 XML 中的参考屏幕上工作（比如 10.1" 平板电脑）并将这些值缩放到实际使用的设备应该是一件简单的事情。我无法通过这种方式获得合理的结果。通过试用-and-error 我发现在 XML 中为 Galaxy 10.1" 选项卡设置原始值并在 Galaxy nexus（横向）上运行时，我必须*将*900 添加到 getTranslationX/Y() 中的值，因此生成的图标正确出现。但是 900 只是一个任意数字，当然添加它们会破坏 10.1" 选项卡上的位置，所以这不是一个解决方案。

XML 或编程解决方案都可以。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-16T20:37:38.217

使用相对布局，您可以将图标相对放置在您想要的位置。

您可以创建一个透明图像，将它们切片到地图对应的位置，然后使用相对布局将它们放在那里。

这可能是一个愚蠢的解决方案......但它对我有用。

由于我无法放置图像，因此我将尝试用字符来解释它们。（对不起！！！）

- - - - - - - - - - - - - - - - - - - - 一个

```
 I 
```

--------------------我--------------------一个

```
 I            I 
```

-------------我--------我-----a

像这样等等..（忽略'a's）每个框代表透明图像的一部分。你把你的图标放在“我”或任何你想要的地方

（再次抱歉！！！）

# javascript - 内联 Javascript 在 Internet Explorer 中不起作用

> ID：12015630
> 
> 赞同：0
> 
> 时间：2012-08-18T03:39:31.967
> 
> 标签：javascript, internet-explorer, dom-events, dreamweaver, onmouseover

我有一个包含一些按钮（div）的 DIV，每个按钮都设置为`onmouseover`更改所有相应 div 的属性。我使用 Dreamweaver 行为的东西来创建它，因为我对 Javascript 非常陌生。好吧，我的问题是；它在 Chrome、Firefox 和 Safari 中完美运行……但在 Internet Explorer 中没有任何作用。我知道从哪里开始。有问题的网站在[这里](http://www.glamourpawscollars.com)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T04:25:11.567

所以你的问题在于这个函数：

```
function MM_changeProp(objId,x,theProp,theValue) { //v9.0
  var obj = null; with (document){ if (getElementById)
  obj = getElementById(objId); }
  if (obj){
    if (theValue == true || theValue == false)
      eval("obj.style."+theProp+"="+theValue);
    else eval("obj.style."+theProp+"='"+theValue+"'");
  }
} 
```

具体来说，这一行：

```
else eval("obj.style."+theProp+"='"+theValue+"'"); 
```

当您尝试更改属性时，IE8 最终会窒息`backgroundImage`，它会尝试评估：

```
obj.style.backgroundImage=' url(../images/homepointer1.png)' 
```

并抛出

```
SCRIPT87: Invalid argument. 
```

我认为这是因为您在值中有一个额外的空格并且没有在 URL 字符串周围使用引号。基本上你的代码中有这样的东西：

```
' url(../images/homepointer2.png)' 
```

您需要修复它，使其看起来像这样：

```
'url("../images/homepointer2.png")' 
```

我没有简单的方法来验证这一点，因此修复可能不正确，但这绝对是您的问题所在。顺便说一句，它只在 IE7/IE8 中被破坏，它在 IE9 中运行良好。

# c# - C# 多个复选框集合

> ID：12015633
> 
> 赞同：0
> 
> 时间：2012-08-18T03:39:50.640
> 
> 标签：c#, checkbox

好吧，我要直截了当，我有 20 个复选框，如下所示：

![](../Images/90f3b381861e88ef7e7cff33ead9f797.png)

我想要做的是使每列中只有一个复选框（上面编号）可以一次检查，我最初只是要检查每个“已检查”事件并使其成为当其中一个它们被选中它会取消选中列中的其他 3 个，但我意识到这并不实用，而且它非常长，因为我总共有 80 个复选框。

我想知道是否有人可以指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T04:39:48.297

就像 saul672 所说，您可能应该只使用单选按钮，因为这正是它们的设计目的。但是，如果您仍然想使用复选框来实现这一点，因为您喜欢方形而不是什么，我会这样做：

您必须将复选框放在一个容器中，该容器仅包含来自同一列的复选框。然后，将此事件添加到每个复选框。

```
private void CheckedChanged(object sender, EventArgs e)
{
    CheckBox cb = (CheckBox) sender;
    if (cb.Checked)
    {
        foreach (CheckBox control in cb.Parent.Controls)
        {
            if (control != cb)
                control.Checked = false;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T04:30:23.710

用这个：

```
public class ColumnCheckBox:CheckBox
{
    public int ColumnIndex;
}

void columnCheckBox1_CheckedChanged(object sender, EventArgs e)
{
    int columnIndex = ((ColumnCheckBox)sender).ColumnIndex;
} 
```

然后仅选中该列中的复选框。显然，您必须拥有复选框列表，`List<List<CheckBox>> CheckBoxList`以便您可以执行 `foreach (ColumnCheckBox cb in CheckBoxList(columnIndex))`

# php - 如何搁置新发布的记录？

> ID：12015634
> 
> 赞同：0
> 
> 时间：2012-08-18T03:39:56.620
> 
> 标签：php, mysql, html

这是我第一次发布网站，我对以下请求非常陌生。该网站以在线分类广告为特色，由 PHP、MySQL 和 Ajax 编程。

通常，当用户发布新记录时（在完成表单并按下提交按钮后），新记录会立即在线发布。

我想通过暂停该记录直到网站管理员验证内容来避免立即发布新记录。

上述建议的程序应该是什么。

谢谢你的帮助，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T03:49:32.500

添加一个名为已发布的列并将默认设置为 0。然后，创建一个评论工具，将发布的更新为 1。让所有读者只显示已发布的文章 = 1

此外，创建另一个列（如 date_created）也是一个好主意。这样您就可以在您的审阅工具中组织您的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T03:42:34.030

您可以有一个默认标志已发布 = 0，并且显示记录的任何页面都应在已发布 = 1 上查询。只有管理员才能`published`从 0 更改为 1。这是最简单的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-18T03:43:37.530

一种方法是将新记录标记为“not_validated”或其他内容（可能会在您的数据库表中添加一个额外的列，或者将这些未验证的记录放在单独的表中）并为自己创建一个简单的管理员页面（例如受保护.htaccess），管理员可以在其中验证记录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-18T03:56:38.687

在不知道您的数据库架构的情况下，我会假设您有一个名为 Classifieds 的表

1.  向分类广告表添加状态列
2.  提交新广告时，将状态设置为“待处理”
3.  然后管理员可以查看广告并将状态更改为“已批准”或“已拒绝”
    *   创建管理员可以查看和显示待处理项目的页面
        *   `select * from classifieds where status = 'pending`'
    *   允许管理员更改状态
        *   `update classifieds set status='approved' where classified_id=1`
4.  向公众展示广告的页面将仅显示已批准的页面
    *   `select * from classifieds where status = 'approved'`

# css - XHTML 和 CSS - 流体高度 div 没有拉伸到 100%

> ID：12015639
> 
> 赞同：0
> 
> 时间：2012-08-18T03:40:39.663
> 
> 标签：css, html, xhtml

我有 4 个 div 一个包装器和一个页眉、中间和页脚..

我的问题是我成功地让页脚保持在底部，但现在中间（内容）div 没有拉伸到 100%，它只是停留在文本的高度。

XHTML

```
<div class="wrapper">
<div class="header">&nbsp;</div>
<div class="content">&nbsp;</div>
</div>
<div class="footer">&nbsp;</div> 
```

CSS

```
body{
font-family: Century Gothic, sans-serif;
background-color: #f5ecd4;
text-align:center;
background-image: url('../images/header.jpg');
background-repeat: repeat-x;
background-position: center top;
}
body, html{
margin:0;
padding:0;
height:100%;
}
.wrapper{
margin-left:auto; 
margin-right:auto;
width:822px;
height:100%;
margin:0 auto -47px;
}

.header{
height:200px;
text-align:center;
background-image: url('../images/banner.jpg');
background-repeat: no-repeat;
}

.content{
border:1px solid #000;
height:100%;
background-image: url('../images/content.jpg');
background-repeat:repeat-y;
}

.footer{
text-align:center;
width:100%;
height:47px;
background-image: url('../images/footer.jpg');
background-repeat:repeat-x;
color:#FFFFFF;
font-size:12px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T03:48:39.410

100% 只适用于宽度而不是高度来实现这一点你可能需要使用一些像这样的javascript

```
html_height = $(document).height();
content_height = $('.header').height() - $('.footer').height();
$('.content').height(content_height); 
```

希望这能满足你的要求，对不起，这是 jquery

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T03:59:06.693

我想到了！

```
<div class="content">
    <div class="wrapper">
        <div class="header">&nbsp;</div>
        &nbsp;
    </div>
</div>
<div class="footer">&nbsp;</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T03:50:06.860

尝试使用`position:absolute, top:0, bottom:0`

# django - 模型中外键之间的关系

> ID：12015640
> 
> 赞同：0
> 
> 时间：2012-08-18T03:40:41.630
> 
> 标签：django, django-models

如果这是一个简单的问题，我是 Django 的新手，请原谅，但我很难说清楚。我已经找了很久的答案了。

假设我正在构建一个非常简单的成绩簿应用程序。

models.py（省略了代码）

```
class Course(models.Model):
    ...

class Student(models.Model):
    students = models.ManyToManyField(Course)
    ...

class Assignment(models.Model):
    course = models.ForeignKey(Course)
    student = models.ForeignKey(Student)
    ... 
```

有没有办法设置models.py，这样如果我向课程添加作业，它会自动将作业与课程中注册的所有学生相关联？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T04:01:42.113

有多种方法可以实现这一结果。您可以使用[信号框架](https://docs.djangoproject.com/en/dev/ref/signals/#post-save)来连接一个新作业的 post_save 操作，以触发将该作业复制给课程中的每个学生

或者您可以[重新实现模型的 save() 方法](https://docs.djangoproject.com/en/dev/topics/db/models/#overriding-model-methods)，以便在调用 save 时直接执行相同的操作

或者，您可以在模型上创建一个实用程序类型类方法，例如 create_assignment_for_course。因为这也会出现在 Course 实例上，所以一般的方法是把它放在[自定义 manager](https://docs.djangoproject.com/en/dev/topics/db/managers/#custom-managers-and-model-inheritance)上。管理器位于 Model.object 属性中。当然，在为整个课程创建作业时，您必须专门使用这个 classmethod/manager 方法

# java - java Timer TimerTask 多线程

> ID：12015642
> 
> 赞同：9
> 
> 时间：2012-08-18T03:40:48.610
> 
> 标签：java, multithreading, timer, timertask

我正在使用 Timer 和 TimerTask 长轮询聊天应用程序的新消息。我想研究两种“稍微”不同的可能性：

**1：**定时器声明为局部变量

```
public List<MessageBean> getLastMessages(...) {
    [...]
    Timer timer = new Timer(true); //**Timer declared as local variable**
    while (someCondiction) {
        MessagesTimerTask returnMessagesTask = new MessagesTimerTask([...]);
        timer.schedule(returnMessagesTask, 6000);
        synchronized (listMessageBean) {
            listMessageBean.wait();
            //notify is called in the MessagesTimerTask which extends TimerTask
        }
    }
} 
```

***问题：**每次调用该方法时，我都可以看到创建了一个新线程，[Timer-1]、[Timer-2] 等。在 Eclipse 调试窗口中，即使在**getLastMessages之后，它们似乎都在运行(..)**完成运行并向客户端返回一个值。如果计时器实际上使用线程，这可能会导致一个巨大的问题，并且在少数事务之后，服务器最终将消耗所有机器资源。

**2：**定时器声明为本地字段

```
private final Timer timer = new Timer(true); //**Timer declared as local field**

public List<MessageBean> getLastMessages(...) {
    [...]
    while (someCondiction) {
        MessagesTimerTask returnMessagesTask = new MessagesTimerTask([...]);
        timer.schedule(returnMessagesTask, 6000);
        synchronized (listMessageBean) {
            listMessageBean.wait();
            //notify is called in the MessagesTimerTask which extends TimerTask
        }
    }
} 
```

***问题：**每次调用该方法时，都使用同一个线程[Thread-1]，但我不确定我是否连续两次调用，后者将取消/覆盖前者（该类是@Autowired by spring ) ?

有什么建议么 ？谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-18T05:42:20.083

以下是该方法的[源代码](http://www.docjar.com/html/api/java/util/Timer.java.html)`schedule`：

```
190       public void schedule(TimerTask task, long delay) {
191           if (delay < 0)
192               throw new IllegalArgumentException("Negative delay.");
193           sched(task, System.currentTimeMillis()+delay, 0);
194       } 
```

和`sched`方法：

```
386       private void sched(TimerTask task, long time, long period) {
387           if (time < 0)
388               throw new IllegalArgumentException("Illegal execution time.");
389   
390           // Constrain value of period sufficiently to prevent numeric
391           // overflow while still being effectively infinitely large.
392           if (Math.abs(period) > (Long.MAX_VALUE >> 1))
393               period >>= 1;
394   
395           synchronized(queue) {
396               if (!thread.newTasksMayBeScheduled)
397                   throw new IllegalStateException("Timer already cancelled.");
398   
399               synchronized(task.lock) {
400                   if (task.state != TimerTask.VIRGIN)
401                       throw new IllegalStateException(
402                           "Task already scheduled or cancelled");
403                   task.nextExecutionTime = time;
404                   task.period = period;
405                   task.state = TimerTask.SCHEDULED;
406               }
407   
408               queue.add(task);
409               if (queue.getMin() == task)
410                   queue.notify();
411           }
412       } 
```

从这里你可以清楚地看到一个队列被用来在内部存储任务，这意味着后面的任务不会覆盖前面的任务。如果您还检查`mainLoop`文件中的方法，您可以看到它从队列中按计划时间一一排序并执行它们。

所以在同一个`Timer`对象上安排多个任务应该不是问题。

作为旁注，请考虑从 Java 1.5 开始替换`Timer`为可用。`ScheduledThreadPoolExecutor`

# winapi - 如何使用win32调整和移动桌面上的每个窗口，使其不与桌面顶部的菜单栏重叠

> ID：12015646
> 
> 赞同：1
> 
> 时间：2012-08-18T03:42:21.013
> 
> 标签：winapi

这是一个棘手的问题。我想制作一个在桌面顶部绘制条形的程序。然后，我希望打开的每个窗口都不会在此标题栏上绘制，即使给定的桌面窗口已最大化。我记得我看到了与此类似的事情，但我不记得该程序。我猜那些扩展任务栏类型的程序必须执行类似的操作，以使窗口不与第二台显示器上的扩展任务栏重叠。

实现这一点需要 Windows 中的什么框架？主动可访问性以查看何时创建窗口，然后以某种方式获取窗口句柄并调整其大小和位置？

我可以遍历窗口列表并移动它们，但是当它们打开或最大化时呢？

任何想法如何实现这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T05:36:55.647

您正在寻找的称为“工作区”，在 MSDN 上定义为“未被系统任务栏或应用程序桌面工具栏遮挡的屏幕部分”。您可以使用**SPI_SETWORKAREA**操作设置工作区[`SystemParametersInfo`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724947%28v=vs.85%29.aspx)——您希望将其设置为现有工作区减去新栏的面积。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T21:01:26.230

听起来您想创建一个 AppBar：Windows 具有对管理桌面区域的内置支持，包括允许您要求它沿一侧为您的应用程序保留空间。有关详细信息，请参阅[MSDN：使用应用程序桌面工具栏](http://msdn.microsoft.com/en-us/library/windows/desktop/cc144177(v=vs.85).aspx)。

来自 MSDN 的总结：

> 应用程序桌面工具栏（也称为应用程序栏）是类似于 Windows 任务栏的窗口。它固定在屏幕的边缘，通常包含让用户快速访问其他应用程序和窗口的按钮。系统会阻止其他应用程序使用应用栏使用的桌面区域。在任何给定时间，桌面上都可以存在任意数量的应用栏。

# android - 如何仅在退出应用程序时才结束服务？

> ID：12015648
> 
> 赞同：1
> 
> 时间：2012-08-18T03:42:34.893
> 
> 标签：android, android-service, android-lifecycle, ondestroy

我有一项服务，我想在应用程序打开的第二个运行，并且只希望该服务在用户退出应用程序后立即结束。我如何对这两件事进行编程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T04:10:51.267

当用户按下返回按钮时，可以使用[Activity.onUserInteraction ()](http://developer.android.com/reference/android/app/Activity.html#onUserInteraction%28%29)来停止服务：

```
@Override
    public void onUserInteraction()
    {
        super.onUserInteraction();
        //stop your service here
    } 
```

第二个解决方案是您还可以使用 onKeyDown 或 onBackPresed 来停止用户后按的服务：

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
if (keyCode == KeyEvent.KEYCODE_BACK) {
    //stop your service here
    return true;
}
return super.onKeyDown(keyCode, event);
} 
```

手柄背压：

```
@Override
public void onBackPressed() {
//stop your service here
return;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T03:49:05.870

在活动的 onCreate 中使用 StartService 并在 onexit 按钮 onclicklistener 中使用 stopService

# c# - 如何开始构建语音聊天应用程序c#

> ID：12015649
> 
> 赞同：5
> 
> 时间：2012-08-18T03:43:01.527
> 
> 标签：c#, audio, chat

获取语​​音聊天应用程序的第一步是什么？

我认为第一步从输入中获取语音并将其转换为字节并将其以 UDP 连接发送到接收器，然后接收器将字节转换为语音并播放它，反之亦然，依此类推，直到断开连接

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T04:02:01.687

在一个答案中解释它实际上是一项相当困难的任务，因此我将参考一些文章。不过，你有基本的前提。

你看过这篇文章吗？[http://www.codeproject.com/Articles/19485/A-Voice-Chat-Application-in-C](http://www.codeproject.com/Articles/19485/A-Voice-Chat-Application-in-C) 这个有一些问题，但如果你想在纯 DirectShow 中进行，它可以提供一个很好的解决方案。

我看到你还问了一个关于 NAudio 的问题。NAudio 实际上写了一个语音聊天应用程序。它在他们的演示网站上。[http://naudio.codeplex.com/SourceControl/changeset/view/920​​e758340dc](http://naudio.codeplex.com/SourceControl/changeset/view/920e758340dc)

在左侧，选择 NAudioDemo，然后选择 NetworkChatDemo 来探索代码。此外，您可以下载它并使用它来了解更多关于它是如何工作的。

# php - Yii 验证：直接抛出 PHP 错误，没有 Ajax 警告文本

> ID：12015650
> 
> 赞同：0
> 
> 时间：2012-08-18T03:43:09.787
> 
> 标签：php, yii

当尝试提交新的活动记录实例并将其保存到数据库表时，我收到了直接的 PHP 错误消息，没有 AJAX 警告文本，正如我所料。这让我真的很困惑。PHP 错误消息是：

```
mb_strlen() expects parameter 1 to be string, array given 
```

它指向 ...Yii1.8\framework\validators\CStringValidator.php 中的第 72 行，即：

```
 $length=mb_strlen($value, $this->encoding ? $this->encoding : Yii::app()->charset); 
```

然后，在接下来的几行中，PHP 错误继续指向我的 AR 类中的这一行（第 209 行）：

```
205   $AttributesList = $saveArticleHistory->attributes;
206         $article_history->attributes = $AttributesList;
207         $article_history->article_id = $saveArticleHistory->id;
208         $article_history->id = null;         
209         return $article_history->save(); 
```

但我的理解是，如果 AR 实例未能保存到数据库，则会引发 Ajax 警告（如果我们在视图中看到该 Ajax 错误消息）。但是这里直接显示警告信息？你能帮我解决这个困惑吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T21:20:18.017

Yii 不处理 PHP 错误，目前只处理异常。以下是与此问题相关的一些链接：[link1](http://code.google.com/p/yii/issues/detail?id=2857)、[link2](http://code.google.com/p/yii/issues/detail?id=2155)。对于这种特殊情况，我认为`$value`在将其传递给`mb_strlen`.

# python - 在 suds 中向服务中添加 WSDL 中缺少的附加元素

> ID：12015657
> 
> 赞同：3
> 
> 时间：2012-08-18T03:44:54.950
> 
> 标签：python, wsdl, suds

我正在使用 suds 使用 Python 访问 API。我的泡沫正常工作，使用`client.factory.create()`.

我刚刚从其他 API 的开发人员那里发现 WSDL 不完整，并且缺少六个必填字段。

在我创建对象后，有什么方法可以将字段添加到对象中`client.factory.create`？还是我必须废弃 WSDL 并手动完成？

（我知道他们应该修复 WSDL，但我对此没有任何控制权）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T20:23:23.607

向使用 factory.create() 创建的对象添加其他字段应该不是问题

```
obj = client.factory.create('ns1:object')
obj.newField = 'value' 
```

obj 现在应该具有来自 WSDL 的所有字段和 newField。

# asp.net-mvc - 从控制器操作将 pdf 嵌入到视图中

> ID：12015661
> 
> 赞同：0
> 
> 时间：2012-08-18T03:45:34.540
> 
> 标签：asp.net-mvc, pdf

我有一个简单的控制器操作，它返回一个 pdf 作为 FileContentResult。我想将 pdf 嵌入到一个新窗口中，并在视图中添加一些其他 html 元素，如按钮。我尝试静态插入一个对象标记，然后动态设置指向我的控制器操作 url 的数据属性。这根本没有任何作用。我也尝试过使用 PDFObject 基本上做同样的事情，但这也不起作用（尽管奇怪的提琴手说找不到我的操作方法，尽管我之前只是在同一页面上使用过它）。我怀疑由于没有任何东西与对象标签交互，因此它们永远不会触发 url 中的操作。如何在采用动态生成参数的 mvc 操作中指向渲染的 pdf 文件？现在我也没有例外。

```
// My controller 
    [HttpGet] 
    public ActionResult GetReportFile(string pReportType, string pK2ID, DateTime pPeriodRun) 
    { 
        return new FileContentResult(DataModel.KrisReportDataModelProp.GetReportFile(pReportType, pK2ID, DateTime.MinValue), "application/pdf") { FileDownloadName = "test.pdf" }; 
    } 

// My javascript 
var pdfReportResult = new PDFObject({ 
                            url: '../../KrisReport/GetReportFile?pReportType=' + lReportTypeSubmissionQuerySelector.val() + '&pK2ID=' + lK2ID + '&pPeriodRun=' + lPeriodRun 
                        }).embed('reportPlaceHolder'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:42:35.253

就在最近，当我必须提交表单并对其进行验证时，我遇到了一个问题，如果它有效，则向用户提供一个下载 pdf 文件的选项。请注意，下载 pdf 文件是可选的。用户需要单击“下载 Pdf”按钮，在验证初始表单之前该按钮不可用。这听起来与您的问题类似。我通过执行以下操作实现了这一点：

**查看型号：**

```
public class PatientModel
{
    public int id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public byte[] PdfByteArray { get; set; }
} 
```

**控制器上的操作：**

```
// Action to display initial form
[HttpGet]
public ActionResult CreatePatient()
{
    PatientModel model = new PatientModel();
    return View(model);
}

// Action to post patient
[HttpPost]
public ActionResult CreatePatient(PatientModel model)
{
    if(ModelState.IsValid)
    {
        // whatever logic to save new patient
        mPatient.Save(model);

        // whatever logic to generate pdf byte[]. I have a helper for this.
        string html = "[some html based on which a pdf will be generated]"
        byte[] pdf = PDFHelper.GeneratePDFFromContents(html);
        model.PdfByteArray = pdf;
    }

    return View(model);
}

// action to download PDF file given byte[]
[HttpPost]
public ActionResult PdfFromByteArray(byte[] pdfByteArray)
{
    return File(pdfByteArray, "application/pdf", "MyHistory.pdf");
} 
```

**看法：**

```
@model PatientModel
@using (Html.BeginForm())
{
    First Name: @Html.TextBoxFor(x => x.FirstName)
    Last Name: @Html.TextBoxFor(x => x.LastName)
    @html.ValidationSummary()
    <input type="submit" value="Submit" />
}

@if (ViewData.ModelState.IsValid)
{
    using (Html.BeginForm("PdfFromByteArray", "[Controller Name]"))
    {
        @Html.HiddenFor(x => x.PdfByteArray)
        <input type="submit" value="Download File" />
    }
} 
```

在这里，如果初始形式有效，我将 pdf 的字节数组作为隐藏输入嵌入到视图中。如果用户请求下载 pdf（提交带有隐藏输入的第二个表单），它会调用另一个从 byte[] 生成 pdf 并返回它的操作。

# java - 为什么重新粉刷要花这么多时间？

> ID：12015667
> 
> 赞同：0
> 
> 时间：2012-08-18T03:48:14.950
> 
> 标签：java, swing, jpanel, drawstring

我有类似的东西（现在时间显示正确）。我已经添加`KeyListener`到`JFrame`这些 JPanel 所在的位置。当我按 ->（右键）时，我想时间增加一，它确实如此，但它真的很慢（比如等待 3 秒，然后甚至更长）。程序中的算法不是故障（在没有 GUI 的情况下检查，它们很快）。有什么方法可以加快反应->按键->改变时间。图片是png的，所以应该很快。每次我想刷新时，我都会调用 aktualizuj()。

PS：时间在屏幕左侧：14:28

![在此处输入图像描述](../Images/d2b707722f75e678d755093bf6e74f83.png)

```
import java.awt.Color;
    import java.awt.Dimension;
    import java.awt.Font;
    import java.awt.FontMetrics;
import java.awt.Graphics;
import java.awt.Graphics2D;

import javax.swing.BorderFactory;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.border.Border;

public class InfoLiniaPanel extends JPanel {
Linia linia;
Dimension d;
int nrPrzystanku;
    public InfoLiniaPanel(Linia linia) {
        super();
        this.linia = linia;
        nrPrzystanku = 0;
        go();
    }

    public void go(){
    d = new Dimension(java.awt.Toolkit.getDefaultToolkit().getScreenSize().width/4, java.awt.Toolkit.getDefaultToolkit().getScreenSize().height/2);
    setPreferredSize(d);        
        Border b = BorderFactory.createLineBorder(Color.red, 4);
        setBorder(b);       
    }

    public void aktualizuj(int nrPrzystanku){
        this.nrPrzystanku = nrPrzystanku;
        revalidate();
        repaint();
    }

    @Override
    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        int Height = (int) d.getHeight(), Width = (int) d.getWidth();
    //  System.out.println("PAINT W InfoLiniaPanel");
        Font f = new Font(Font.SANS_SERIF,Font.BOLD, (4 *Height/10));
        g.setFont(f);
    //  System.out.println(Height);
        //rysowanie numeru linii
        g.drawString(linia.nr + "", Width/10, Height/3);
        //rysowanie czasu
        Font f1 = new Font(Font.SANS_SERIF,Font.BOLD, 2 * Height/18);
        g.setFont(f1);
        g.drawString(linia.czas +" ", Width/10 +  g.getFontMetrics(f).stringWidth(linia.nr+"") + Width/10, Height/3);
        //kierunek
    //  System.out.println(linia.kurs.get(linia.kurs.size() -1 ).kierunek);
        g.setFont( new Font(Font.SANS_SERIF,Font.BOLD,1 *Height/20));
        g.drawString(linia.kurs.get(linia.kurs.size() -1 ).kierunek + "",
                 Width/10 + g.getFontMetrics(f).stringWidth(linia.nr+"") + Width/10,
                 Height/3 - g.getFontMetrics(f1).getAscent() /*g.getFontMetrics(f1).getHeight()*/ );
    //      System.out.println(g.getFontMetrics(f1).getHeight());
        //nastepny przystanek
    //  System.out.println(linia.kurs.get(nrPrzystanku)); //TRZEBA ZMIENIC NA JAKIS INDEKS ZEBY SZLA SYMULKACJA!!!!!!
        //NAJLEPIEJ DAC POLE OBECNY PRZYSTANEK W KLASIE LINIA
        g.drawString("Następny przystanek:" , Width/10, Height/3 + g.getFontMetrics().getHeight() + Height/10);
        g.setFont(new Font(Font.SANS_SERIF,Font.BOLD,1 *Height/18));
        g.drawString(linia.kurs.get(nrPrzystanku).nazwa+"", Width/10, Height/3 + g.getFontMetrics().getHeight()*12/6 + Height/10);

    }

    public static void main(String[] args) {
        new InfoLiniaPanel(new Linia(4));
        JFrame jf = new JFrame();
        jf.setSize(400,400);
        jf.add(new InfoLiniaPanel(new Linia(4)));
        jf.setVisible(true);
        jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    }

} 
```

编辑：

```
@Override
public void keyPressed(KeyEvent arg0) {
    if (arg0.getKeyCode() == KeyEvent.VK_ESCAPE)
        System.exit(1);
    if (arg0.getKeyCode() == KeyEvent.VK_RIGHT){
        l.czas.addMinuty(1);
        aktualizuj();
    }

}

public void aktualizuj(){
    //System.out.println("Akutalizuj");

try{

    liniaPanel.aktualizuj(nrPrzystankuZKolei);
//  System.out.println(l.kurs.get(nrPrzystankuZKolei + 1).czas.equals(l.czas));
    if (nrPrzystankuZKolei < (l.kurs.size()-1) && l.kurs.get(nrPrzystankuZKolei + 1).czas.compareTo(l.czas) <= 0) {
        /*  System.out.println(l.czas + " "
                    + l.kurs.get(nrPrzystankuZKolei).czas + " "
                    + l.kurs.get(nrPrzystankuZKolei + 1).czas);
            System.out.println("Pora nanastepny przystanek");
            System.out.println(l.kurs.get(nrPrzystankuZKolei + 1));
            System.out.println(l.czas); */
            nrPrzystankuZKolei++;// przejscie do kolejnego przystanku
            liniaPanel.aktualizuj(nrPrzystankuZKolei);
            //mapa
            mapaPanel.sciezka = Linia.trasa[nrPrzystankuZKolei].substring(0,  Linia.trasa[nrPrzystankuZKolei].length() - 2)+".png";
            ((MapaPanel) mapaPanel).aktualizuj();
            //kurs
            ((KursPanel) kursPanel).aktualizuj(nrPrzystankuZKolei);
        }

}catch(Exception e){e.printStackTrace();}
} 
```

# javascript - 变量在我的 json 调用中不起作用。一直试图打开我硬盘上的文件

> ID：12015671
> 
> 赞同：0
> 
> 时间：2012-08-18T03:49:00.270
> 
> 标签：javascript, json, variables, tumblr

> 我已经设法弄清楚如何调用我的 tumblr api 并取回我需要的东西。只要我在 getJSON 调用中硬编码地址和其他变量，它就可以正常工作。当我尝试在调用区域中使用变量时，它会尝试在我的硬盘驱动器上打开一个文件，或者它会在我的 url 开头删除“http:”。
> 
> 我究竟做错了什么？

```
<!DOCTYPE html>
<head>
    <script type="text/javascript" src="http://ajax.microsoft.com/ajax/jquery/jquery-1.6.2.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            $("button").click(function () {
            SkipNbr = 0;
            GetNbr = 50;
            var a = "http://api.tumblr.com/v2/blog/";
            var bname = "[myblogname].tumblr.com";
            var c = "/posts/photo?api_key=";
            var MyAPIkey = "myAPIkey";
            var xx = "&limit="+GetNbr+"&offest="+SkipNbr+"?jsonp=?";

            var callstring = "'"+a+bname+c+MyAPIkey+xx+"'";

            console.log(callstring);
            $.getJSON(callstring, function (data) {
          //         $.getJSON("http://api.tumblr.com/v2/blog/[myblogname].tumblr.com/posts/photo?api_key=[myAPIkey]&limit=GetNbr&offset=SkipNbr&jsonp=?", function (data) {
                    console.log(data.response.posts[0].caption);

                    $.each(data.response.posts, function (i, data) {
                        $("div").append(i+1 + " " + data.tags.toString() + "<br>");
                    });
                });
            });
        });
    </script>

 <script type="text/javascript">
 function myFunction()
 {
 SkipNbr = 0;
  GetNbr = 50;
 $.getJSON("http://api.tumblr.com/v2/blog/[myblogname].tumblr.com/posts/photo?api_key=   [myAPIkey]&limit=GetNbr&offset=SkipNbr&jsonp=?", function (data) {
 console.log(data.response.posts[0].caption);
 alert(data.response.posts[0].caption);
 $.each(data.response.posts, function (i, data) {
 $("div").append(i+1 + " " + data.tags.toString() + "<br>");
 });

 }
</script>

</head>
<body>

<button>Get JSON data</button>
 <script type="text/javascript">
 //call after page loaded
 // window.onload=myfunction();
 </script>
<div></div>
</body>

 </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T04:00:27.673

这：

```
var callstring = "'"+a+bname+c+MyAPIkey+xx+"'"; 
```

应该是这样的：

```
var callstring = a+bname+c+MyAPIkey+xx; 
```

# php - 在服务器上创建图像文件

> ID：12015674
> 
> 赞同：0
> 
> 时间：2012-08-18T03:49:06.520
> 
> 标签：php

我正在尝试使用 facebook api 获取应用程序用户的个人资料图片，然后将其保存在服务器上。我得到的图像很好，但是创建一个新的图像文件并将其保存在正确的文件夹中似乎是一个问题。我尝试使用 fopen 和 file_put_contents 函数，但显然它们需要事先创建一个文件。如何将 fb 用户的图像保存在服务器上？我的代码如下。

```
$facebook = new Facebook(array(
'appId' => '12345',
'secret' => '12345',
'cookie' => true
));

$access_token = $facebook->getAccessToken();

if($access_token != "") 
{
$user = $facebook->getUser();
if($user != 0)
{
            $user_profile = $facebook->api('/me');   

        $fb_id = $user_profile['id'];
        $fb_first_name = $user_profile['first_name'];
        $fb_last_name = $user_profile['last_name'];
        $fb_email = $user_profile['email'];

            $img = file_get_contents('https://graph.facebook.com/'.$fb_id.'/picture?type=large');
    $file = '/img/profile_pics/large/';
    rename($img, "".$file."".$img."");
    } 
```

有什么建议么？

谢谢，

槊

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T03:56:06.367

使用`$img = file_get_contents(...)`img 将包含图像的来源，只需将其保存到文件中，将`rename()`不起作用。

做就是了：

```
error_reporting(E_ALL);//For debugging, in case something else

$img_data = file_get_contents('https://graph.facebook.com/'.$fb_id.'/picture?type=large');

$save_path = '/img/profile_pics/large/';
if(!file_exists($save_path)){
    die('Folder path does not exist');
}else{
    file_put_contents($save_path.$fb_id.'.jpg',$img_data);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T04:00:21.933

首先，确保您尝试创建图像的目录是可写的，否则给它正确的 chmod。

正如 Lawrence 所说，代码中的 $img 变量实际上并不包含文件名，而是包含图像本身。为了将其保存在文件中，您必须将其作为第二个参数传递给 file_put_contents，并将文件名作为第一个参数：

```
file_put_contents('image.ext', $img); 
```

或者在这种情况下：

```
file_put_contents($file.'/image.ext', $img); 
```

要将其保存在与 PHP 脚本相同的目录中，可以使用`__DIR__`常量来获取绝对路径：

```
file_put_contents(__DIR__.'/image.ext', $img); 
```

# php - phpmyadmin 问题和 500 个错误

> ID：12015675
> 
> 赞同：0
> 
> 时间：2012-08-18T03:49:22.937
> 
> 标签：php, phpmyadmin

在 phpmyadmin 上使用我的用户名和密码登录后，我立即收到 500 个错误。我正在尝试提取错误日志的位置。如何找出错误日志的写入位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T03:52:54.307

这并不完全是您想要的，但 phpmyadmin 有它的适合。尝试关闭您的浏览器，有效地终止您的会话并重新进入它。或者，如果您正在运行本地设置，请将其关闭并重新打开。由于与 30 分钟注销搞砸的冲突，我已经多次发生这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T04:00:37.893

找到并分析服务器日志，该日志应提供有关错误的更多信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-09T11:28:51.593

更新 PHP 后，我从 phpMyAdmin 收到 500 个错误，发现问题是以下行`php.ini`已被注释掉：

```
;session.save_path = "/tmp" 
```

取消注释此行（通过删除`;`）并重新启动 Apache 后，phpMyAdmin 再次感到高兴。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-23T00:28:40.333

在许多情况下，甚至大多数情况下，错误 500 永远不会在日志文件中留下任何痕迹。

如果您在子目录中使用 phpmyadmin，则可能会给出文件`.htaccess`位于 phpmyadmin 上方的目录中。尝试停用文件，即通过将其重命名为，`_.htaccess`然后再试一次，如果 phpmyadmin 正在工作。
我只是有一个这样的案例，我在[这个答案](https://stackoverflow.com/a/58054128/1019850)中描述了它。

# python - 从字典中的值列表创建矩阵

> ID：12015679
> 
> 赞同：4
> 
> 时间：2012-08-18T03:49:40.503
> 
> 标签：python, dictionary, matrix, numpy

我希望将以下字典转换为矩阵，其中字典的第一个和第二个值是列值和行值。当矩阵为真时，我希望有一个“1”，当它为假时，我想要一个“0”。

{0: [2, 5.0], 1: [6, 7.0], 2: [6, 8.0], 3: [5, 6.0], 4: [1, 5.0], 5: [3, 4.0], 6 : [4, 5.0]}

所需的输出看起来像这样

```
 1   2   3   4   5   6   7   8

1       0   0   0   0   1   0   0   0
2       0   0   0   0   1   0   0   0
3       0   0   0   1   0   0   0   0
4       0   0   1   0   1   0   0   0
5       1   1   0   1   0   1   0   0
6       0   0   0   0   1   0   1   1
7       0   0   0   0   0   1   0   0
8       0   0   0   0   0   1   0   0 
```

谢谢堆，任何指针都会很棒！

丹妮尔。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T04:25:59.257

这是一个与您想要的输出相匹配的输出，尽管我认为使用@Antimony 的答案作为基础（numpy）可能是要走的路（至少比这个答案更多）

```
N = 8

d = {0: [2, 5.0], 1: [6, 7.0], 2: [6, 8.0], 3: [5, 6.0], 4: [1, 5.0], 5: [3, 4.0], 6: [4, 5.0]}

m = [0] * (N ** 2 + 1)

for x, y in d.values():
    m[x + int(y - 1) * N] = 1
    m[int(y) + (x - 1) * N] = 1

print " ".ljust(9),
print "   ".join(map(str, range(1, N + 1)))
print
for i in range(1, N ** 2 + 1):
    if i % N == 1:
        print "%d  ".ljust(10) % (i / N + 1),
    val = m[i]
    print "%d  " % val,
    if not i % N:
        print 
```

**输出**

```
 1   2   3   4   5   6   7   8

1         0   0   0   0   1   0   0   0  
2         0   0   0   0   1   0   0   0  
3         0   0   0   1   0   0   0   0  
4         0   0   1   0   1   0   0   0  
5         1   1   0   1   0   1   0   0  
6         0   0   0   0   1   0   1   1  
7         0   0   0   0   0   1   0   0  
8         0   0   0   0   0   1   0   0 
```

基于@DSM 对@Antimony 的回答的评论，这里有一个使用 numpy 的：

```
import numpy
N = 8
m = numpy.zeros((N,N))

d = {0: [2, 5.0], 1: [6, 7.0], 2: [6, 8.0], 3: [5, 6.0], 4: [1, 5.0], 5: [3, 4.0], 6: [4, 5.0]}

for i,j in d.itervalues(): 
    m[i-1,j-1] = 1
    m[j-1,i-1] = 1

print " ".ljust(9),
print "   ".join(map(str, range(1, N + 1)))
print
for i, line in enumerate(m.tolist()):
    print "%s %s" % (("%s".ljust(10) % (i+1),"   ".join(map(str, map(int, line))))) 
```

**输出**

```
 1   2   3   4   5   6   7   8

1         0   0   0   0   1   0   0   0
2         0   0   0   0   1   0   0   0
3         0   0   0   1   0   0   0   0
4         0   0   1   0   1   0   0   0
5         1   1   0   1   0   1   0   0
6         0   0   0   0   1   0   1   1
7         0   0   0   0   0   1   0   0
8         0   0   0   0   0   1   0   0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T04:34:52.387

使用数字作为字典键没有任何意义。你应该只使用一个列表。

```
vals = [True, True, False, True] # Assuming this is a list of n*n elements
matrix = [] # This will be a two-dimensional array, or matrix. 
```

这将为任意大小的列表生成一个方阵：

```
from math import sqrt
size = sqrt(len(vals))
for x in range(0, size):
    matrix.append(list(vals[x*size:x*size+size]))

# matrix == [[True, True], [False, True]]
# matrix[0][0] == True
# int(matrix[0][0]) == 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T04:19:18.567

你给定的期望输出没有意义，但这里有一些我猜你真正想要的东西。您可以通过执行修剪第 0 行和第 0 列`m = m[1:,1:]`

```
>>> d = {0: [2, 5.0], 1: [6, 7.0], 2: [6, 8.0], 3: [5, 6.0], 4: [1, 5.0], 5: [3, 4.0], 6: [4, 5.0]}
>>> dims = [1 + int(x) for x in map(max, zip(*d.values()))]
>>> m = numpy.zeros(dims, dtype=int)
>>> for v in map(tuple, d.values()):
    m[v] = 1

>>> m
array([[0, 0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 1, 0, 0, 0],
       [0, 0, 0, 0, 0, 1, 0, 0, 0],
       [0, 0, 0, 0, 1, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 1, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 1, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 1, 1]]) 
```

# ruby - 平衡括号的简单 Ragel 示例？

> ID：12015684
> 
> 赞同：7
> 
> 时间：2012-08-18T03:50:53.823
> 
> 标签：ruby, ragel

这是语法的起点：

```
%%{
  machine xo;

  char = "x" | "o";
  group = "(" char* ")";
  main := group;
}%% 
```

`(xxxx(oo)()xx)`例如，它处理。如何扩展它以允许嵌套组；例如`(xxxx(o(x)o)()xx`？

我知道递归通常不受一台 Ragel 机器的支持。所以这行不通：

```
group = "(" ( char | group )* ")"; 
```

来自[Ragel State Machine Compiler User Guide (PDF)](http://www.complang.org/ragel/ragel-guide-6.7.pdf)：（为强调而添加了粗体文本）：

> “一般来说，Ragel 无法处理递归结构，因为语法被解释为常规语言。但是，根据需要解析的内容，有时**使用手动编码技术**实现递归部分是可行的。这通常适用于递归结构的情况简单且易于识别，例如在括号的平衡中。”
> 
> “解析递归结构的一种方法是使用递增和递减计数器的操作，或者以其他方式识别递归结构的入口和出口，然后使用 fcall 和 fret 跳转到适当的机器定义。或者，可以使用语义条件来测试计数器变量。
> 
> “一种更传统的方法是在输入递归结构时调用单独的解析函数（以宿主语言表示），然后在识别到结尾时返回。”

从[关于嵌套括号的邮件列表讨论中](http://www.colm.net/pipermail/ragel/2007-November/000422.html)，提到了相同的三种方法：

> 1.  使用 prepush 和 postpop 指定一个可增长的堆栈，然后使用 fcall 和 fret。
>     
>     
> 2.  计数，然后在动作或条件中验证。
>     
>     
> 3.  输入递归结构时调用新的解析函数（以宿主语言）。

你能给我举一个例子吗——最好使用我上面的例子——在 Ruby 中？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-11T09:00:24.317

使用 fcall/fret 的一般模式如下：

```
balanced = [^(){}\[\]] |
               '(' @{ fcall balancedTokensParen; } |
               '[' @{ fcall balancedTokensBracket; } |
               '{' @{ fcall balancedTokensBrace; };
balancedTokensParen   := balanced* ')' @{ fret; };
balancedTokensBracket := balanced* ']' @{ fret; };
balancedTokensBrace   := balanced* '}' @{ fret; }; 
```

所以你的案子可以处理为

```
 char = [xo];
  group = '(' @{ fcall group_rest; };
  group_rest := (char|group)* ')' @{ fret; };

  main := group; 
```

词法分析器函数应该包含`stack`数组，您必须手动检查`top`以确保没有未关闭的 '(':

```
stack = []
%% write init;
%% write exec;
if top > 0 
    cs = %%{ write error; }%%
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T12:13:29.953

我也一直在寻找关于那个 Ragel 问题的日子！

对于传递递归 [嵌套括号] 等需求，Ragel 没有得到很好的记录。

我在 Google 搜索 5 天后发现的唯一示例代码是：

[https://bitbucket.org/mitsuhiko/arana-main/src/289ad1a6f083/arana/lexnparse.rl](https://bitbucket.org/mitsuhiko/arana-main/src/289ad1a6f083/arana/lexnparse.rl)

查看 Ragel 堆栈需求和 fgoto() [或 fcall()]、fret() 和其他代码管理所需的 Ragel 代码开销，我（和许多其他人一样）认为 Ragel 是不是满足此类需求的简单工具。否则将有不止一 (1) 个可用的工作示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T19:29:57.257

粗略地说，如果您尝试匹配括号，则解决方案将涉及以下内容：

```
open_paren = '(' @{ @paren_count += 1}
close_paren = (')' when @paren_count > 0) @{ @parent_count -= 1} 
```

查看用户指南末尾的语义条件部分。

顺便说一句：Ragel 是一个非常强大的工具，你必须了解它的基础才能真正使用它。使用 Ragel 的第一步是阅读用户指南并理解它 - 虽然仍有部分您不确定，但 Ragel 使用起来会非常令人沮丧。

# php - 我可以使用它来生成 PHP CRYPT_BLOWFISH 盐吗？

> ID：12015685
> 
> 赞同：1
> 
> 时间：2012-08-18T03:51:08.857
> 
> 标签：php, salt, blowfish

我基本上使用这个：

```
$chars = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ./';
$numChars = strlen($chars);
$salt = '$2a$12$';

for($i = 0; $i < 22; ++$i) {
    $salt .= $chars[mt_rand(0, $numChars - 1)];
}
```

可以用那个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-22T19:06:29.980

对于 PHP 5.3.7 或更高版本，我相信这是最好的：

```
$blowfish_salt = "$2y$10$".bin2hex(openssl_random_pseudo_bytes(22)); 
```

对于 PHP 5.5 或更高版本，只需使用带有自动盐创建的新`password_hash()` [功能。](http://www.php.net/manual/en/function.password-hash.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T03:56:40.157

这很好用。不过，您在随机化盐方面工作得太辛苦了。
你总是可以做一些像这样 $salt = md5(mt_rand()) :)
当你想在下一步保存密码时使用这样的东西。

```
 $encryptedPassword = crypt($userPassword, $salt); 
```

如果您有最新版本的 PHP，这应该默认为河豚

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T04:11:06.303

我不知道它是否可以使用，但由于`mt_rand`它是基于系统时间的，所以它是可以预测的。最好使用高级随机生成算法`openssl_random_pseudo_bytes`或`/dev/random`实用程序（如果可用）。

请参阅：[https ://stackoverflow.com/a/6337021/454533](https://stackoverflow.com/a/6337021/454533)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-18T04:13:19.727

使用 Blowfish，您只需要 21 个字符作为盐，其余的都被遗忘了。

这部分`$2a$12$`不是算法和成本（哈希迭代）的盐。

您的盐可以通过 sha1 简单地制作，然后返回前 21 个字符：

`$salt = substr(sha1($_SERVER['HTTP_HOST'].uniqid().microtime(true)),0,21);`

所以像：

```
$algo = '$2a$12$'; //Keep this safe

//store along side hash as the salt, for future compares
$salt = substr(sha1($_SERVER['HTTP_HOST'].uniqid().microtime(true)),0,21);

$hash = crypt('The string to be hashed', $algo.$salt.'$'); 
```

# jquery - 幕后的 jQuery 效果

> ID：12015687
> 
> 赞同：0
> 
> 时间：2012-08-18T03:51:22.890
> 
> 标签：jquery

我正在学习一些关于 JQuery 的基础知识。当我了解某件事时，我总是试图想象幕后是如何运作的，但我不想象某些效果是如何真正完成的。

例如一些简单的 .hide(slow) 就是一个例子。据我了解，JQuery 修改了 HTML 组件的 HTML 代码。没有动画的“.hide”看起来很“明显”，我猜“visibility:none”可以解决问题。

但我猜动画暗示了一些更有趣的东西。第一个想法是一个改变属性的循环，并期望渲染足够快以制作流畅的动画。但这听起来很“CPU滥用”。

它是如何真正做到的？

编辑：我什至不考虑普通的 JS 程序员，所以阅读原始源代码非常困难。我一直在寻找一些“大局”的解释。也许这个词**真的**不合适。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T04:10:29.803

jQuery 的源代码有点太高级了，不容易理解，所以从头开始编写一个简单的动画可能会更容易：

```
var element = document.getElementById('element');
var maximum = 200;
var interval = 5;
var left = 10;

function animate() {
    if (left < maximum) {
        left += 1 - Math.pow(left / maximum, 5);
        element.style.left = left + 'px';

        setTimeout(animate, interval);
    }
}

animate();​ 
```

还有一个工作演示：http: [//jsfiddle.net/QB8C7/3/](http://jsfiddle.net/QB8C7/3/)。

jQuery 做了类似的事情，但是以更加结构化的方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T03:56:37.240

[http://james.padolsey.com/jquery/#v=1.7.2&fn=jQuery.fn.hide](http://james.padolsey.com/jquery/#v=1.7.2&fn=jQuery.fn.hide)

你去吧。该站点非常适合查看任何 jQuery 函数的引擎盖下的内容。

在您编辑您的问题后编辑我的回复-

想一部电影。假设哈利波特和他们必须让演员[幻影相映](http://en.wiktionary.org/wiki/disapparate "异形")的场景。他们会怎么做？他们需要每单位时间增加演员的透明度，直到透明度达到 100%。在 hide(slow) 的情况下，假设大约是 1000 毫秒（我没有费心查找它）。所以物体的透明度需要在 1 秒内从 0% 到 100%。因此，他们需要每 100 秒将透明度降低 1% 才能达到这种效果。对于您的普通 Pentium 133 来说，这将是相当 cpu 密集型的（我的计算机仍然来自高中——这将是一个很好的测试，看看它如何响应），但不是现代处理器。但是，如果您有一个充满 jQuery 动画的页面，您会开始注意到速度变慢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-18T03:53:45.563

您可以[在 jQueries 站点上找到源代码，](http://code.jquery.com/jquery-1.8.0.js)以*确切*了解它是如何在幕后完成的。

编辑：为了增加可读性，请检查[GitHub repo](http://github.com/jquery/jquery/tree/master/src)。

# python - XCode 没有看到 python 模块

> ID：12015691
> 
> 赞同：3
> 
> 时间：2012-08-18T03:52:50.877
> 
> 标签：python, xcode, pythonpath

首先让我说我对 Xcode、OS X 和安装 python 模块还很陌生。

当我尝试构建我的项目时，XCode 告诉我它找不到 python 模块：

```
 File "/Users/some_user/some_folder/create.py", line 2, in <module> 
    from peak.rules import abstract, when
ImportError: No module named peak.rules
Command /bin/bash failed with exit code 1 
```

我已经安装了一个 python 模块，它说它安装正确。我可以验证它是否存在于我的`python2.7/site-packages/`目录中。我也这样做了`which python`，这给了我`/Library/Frameworks/Python.framework/Versions/2.7/bin/python`并验证了 python 正在使用该路径 python install 来安装站点包，而且看起来它们位于`/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/`. 我已经搜索了我的机器，但没有我知道的另一个 python 安装。我在安装模块后重新启动了 Xcode，但这并没有什么不同。我还设置`PYTHONPATH`了由`which python`.

我对这个问题的最佳猜测是我没有`PYTHONPATH`正确定义我的。这是我的整个`.bash_profile`文件。

```
# Setting PATH for Python 2.7
# The orginal version is saved in .bash_profile.pysave
PATH="/Library/Frameworks/Python.framework/Versions/2.7/bin:${PATH}"
export PATH

PYTHONPATH="$ {PYTHONPATH} : /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages"
export PYTHONPATH 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T04:46:16.610

的值`PYTHONPATH`不指示`python`要运行哪个可执行文件。相反，它是一种增加`python`可执行文件在导入操作期间在哪些目录中查找模块的方法。Apple 在 OS X 上发布了 Python 版本；这些解释器的路径在`/usr/bin`. 从您的回溯 ( `/Library/Frameworks`) 中的路径来看，您似乎已经安装了更新的 Python 2.7，可能是从 python.org 下载的。默认情况下，该 python 可能在`/usr/local/bin`;中安装了指向它的符号链接。它的规范`bin`目录位于框架中，位于`/Library/Frameworks/Python.framework/Versions/2.7/bin`. 虽然你的外壳路径，`$PATH`，可能已设置为在搜索路径的前面包含该 bin 目录，以便在 shell 中找到较新的 python，这可能不适用于 Xcode。换句话说，Xcode 使用的是系统 Python，而不是您安装的较新的 Python。您可能需要更改 Xcode 项目中的一些变量，以便首先在该路径中搜索该 Python（或使用解释器的绝对路径）。您应该删除`PYTHONPATH`指向`site-library`. 默认情况下，每个 Python 都会自动搜索其`site-library`. 更多信息在[这里](http://docs.python.org/using/cmdline.html#environment-variables)。

更新：您在这里可能有一个更基本的问题。我没有经验，`PEAK`但`PEAK-rules`请注意 Python 包索引中列出了两个单独的发行版。如果您只想使用 PEAK 规则，您似乎*只需要安装*[PEAK-rules](http://pypi.python.org/pypi/PEAK-Rules/)发行版，而*不是*PyPI中列出的[PEAK发行版。](http://pypi.python.org/pypi/PEAK/)要与系统 Python 一起使用，请尝试以下操作：

```
umask 022
sudo /usr/bin/easy_install-2.7 -m peak     # "uninstall" peak if installed
sudo /usr/bin/easy_install-2.7 peak-rules  # install peak-rules 
```

如果您想使用较新的非系统 Python，只需安装并使用`easy_install`(google for `PyPI distribute`) 或`pip`for 它的副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-21T00:23:10.547

当我从 OS X 10.9 迁移到 10.10 时，我遇到了类似的问题。经过一番折腾，我发现 Python 有两个版本，我一直在使用旧版本。我在终端中输入了“which python”并将文件夹复制到 Xcode。

有了这个问题奇迹般地消失了。检查一下，这行得通……！

# java - 检查 facebook 用户是否从 java 中的服务器端连接到应用程序

> ID：12015698
> 
> 赞同：2
> 
> 时间：2012-08-18T03:54:01.267
> 
> 标签：java, facebook, restfb

我的应用程序是用 JSF 框架编写的。JavaScript API 中有一种方法可以识别用户是否连接到应用程序

```
FB.init({appId: "#{settings.fbClientId}", status: true, cookie: true});
FB.getLoginStatus(function(response) {
   if (response.status === 'connected') {
      var uid = response.authResponse.userID;
      var accessToken = response.authResponse.accessToken;
   }
} 
```

我正在寻找一个允许我从服务器端执行相同操作的功能。目前我正在使用 restFB 向 Facebook 发出请求。看起来这个实现不支持授权和相关功能。我知道在 PHP SDK 和 Python SDK 中是可能的，但在 Java 中找不到这样的东西。

注意：我可以检查 JS API，然后从服务器端发出所有必要的请求，但这不是我需要的。我正在寻找一种解决方案，允许我从服务器端做所有事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T12:25:02.370

*任何*仅服务器端的技术都无法识别 Facebook 用户在 Facebook 之外重新访问您的应用程序（无论如何经过一定时间之后）。

原因很简单：我登录 Facebook 在我的浏览器中创建了为 facebook.com 域设置的 cookie。*我的*服务器（因此，在我的域下）上没有任何服务器端技术能够获取这些 cookie 的内容。

然而，JS SDK 能够发出跨域请求以检查我是否登录到 Facebook，然后在*我的*域下设置一些 cookie，任何服务器端技术都可以通过这些 cookie 在下一次请求时访问我的当前状态。

# c# - RichTextBox CreateCaret 宽度测量

> ID：12015699
> 
> 赞同：0
> 
> 时间：2012-08-18T03:54:07.063
> 
> 标签：c#, vb.net, winforms, richtextbox

我通过为插入和覆盖模式创建插入符号来扩展富文本框。问题是测量的宽度太宽。这在较大的字体大小上最为明显。

返回的高度`SelectionFont.Height`是正确的。没有类似的 Width 属性吗？

如何`ch`准确测量指定字符的宽度？谁能提供一个例子？

下面是转换为 C# 的代码，下面是 VB.NET 中的代码：

```
using System;

public class RichTextBoxCaret : RichTextBox
{
    [DllImport("user32.dll", CharSet=CharSet.Auto)]
    private extern static void CreateCaret(IntPtr hWnd, IntPtr hBitmap, int nWidth, int nHeight);

    [DllImport("user32.dll", CharSet=CharSet.Auto)]
    private extern static void ShowCaret(IntPtr hWnd);

    private bool mInsertKeyState = true;

    protected override void OnKeyDown(System.Windows.Forms.KeyEventArgs e)
    {
        base.OnKeyDown(e);

        if (e.KeyCode == Keys.Insert)
        {
            mInsertKeyState = !mInsertKeyState;
        }

        this.DrawCaret();
    }

    protected override void OnMouseUp(System.Windows.Forms.MouseEventArgs mevent)
    {
        base.OnMouseUp(mevent);

        this.DrawCaret();
    }

    public void DrawCaret()
    {
        Size sz = new Size(0, 0);

        if (this.SelectionFont != null)
        {
            if (!mInsertKeyState && this.SelectionStart < this.TextLength)
            {
                using (Graphics g = this.CreateGraphics)
                {
                    using (Font f = new Font(this.SelectionFont.FontFamily, this.SelectionFont.Size, this.SelectionFont.Style, GraphicsUnit.Pixel, Convert.ToByte(0), false))
                    {
                        char ch = this.Text[this.SelectionStart];
                        sz.Width = Convert.ToInt32(g.MeasureString(ch, f).Width * this.ZoomFactor);
                    }
                }
            }

            sz.Height = Convert.ToInt32(this.SelectionFont.Height * this.ZoomFactor);
        }

        if (!sz.IsEmpty)
        {
            CreateCaret(this.Handle, IntPtr.Zero, sz.Width, sz.Height);
            ShowCaret(this.Handle);
        }
    }
} 
```

对于 VB.NET：

```
Public Class RichTextBoxCaret
    Inherits RichTextBox

    <DllImport("user32.dll", CharSet:=CharSet.Auto)> _
    Private Shared Sub CreateCaret(ByVal hWnd As IntPtr, ByVal hBitmap As IntPtr, ByVal nWidth As Integer, ByVal nHeight As Integer)
    End Sub

    <DllImport("user32.dll", CharSet:=CharSet.Auto)> _
    Private Shared Sub ShowCaret(ByVal hWnd As IntPtr)
    End Sub

    Private mInsertKeyState As Boolean = True

    Protected Overrides Sub OnKeyDown(ByVal e As System.Windows.Forms.KeyEventArgs)
        MyBase.OnKeyDown(e)

        If e.KeyCode = Keys.Insert Then
            mInsertKeyState = Not mInsertKeyState
        End If

        Me.DrawCaret()
    End Sub

    Protected Overrides Sub OnMouseUp(ByVal mevent As System.Windows.Forms.MouseEventArgs)
        MyBase.OnMouseUp(mevent)

        Me.DrawCaret()
    End Sub

    Public Sub DrawCaret()
        Dim sz As New Size(0, 0)

        If Me.SelectionFont IsNot Nothing Then
            If Not mInsertKeyState AndAlso Me.SelectionStart < Me.TextLength Then
                Using g As Graphics = Me.CreateGraphics
                    Using f As New Font(Me.SelectionFont.FontFamily, Me.SelectionFont.Size, Me.SelectionFont.Style, GraphicsUnit.Pixel, CByte(0), False)
                        Dim ch As Char = Me.Text.Chars(Me.SelectionStart)
                        sz.Width = CInt(g.MeasureString(ch, f).Width * Me.ZoomFactor)
                    End Using
                End Using
            End If

            sz.Height = CInt(Me.SelectionFont.Height * Me.ZoomFactor)
        End If

        If Not sz.IsEmpty Then
            CreateCaret(Me.Handle, IntPtr.Zero, sz.Width, sz.Height)
            ShowCaret(Me.Handle)
        End If
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T20:46:15.803

测量宽度是通过使用解决的`GetPositionFromCharIndex`。

最终实现：

```
<DllImport("user32.dll", CharSet:=CharSet.Auto)> _
Private Shared Sub CreateCaret(ByVal hWnd As IntPtr, ByVal hBitmap As IntPtr, ByVal nWidth As Integer, ByVal nHeight As Integer)
End Sub

<DllImport("user32.dll", CharSet:=CharSet.Auto)> _
Private Shared Sub ShowCaret(ByVal hWnd As IntPtr)
End Sub

Private mInsertKeyState As Boolean = True

Protected Overrides Sub OnKeyDown(ByVal e As System.Windows.Forms.KeyEventArgs)
    MyBase.OnKeyDown(e)

    If e.KeyCode = Keys.Insert Then
        mInsertKeyState = Not mInsertKeyState
    End If

    Me.DrawCaret()
End Sub

Protected Overrides Sub OnMouseUp(ByVal mevent As System.Windows.Forms.MouseEventArgs)
    MyBase.OnMouseUp(mevent)

    Me.DrawCaret()
End Sub

Public Sub DrawCaret()
    Dim nHeight As Integer = 0
    Dim nWidth As Integer = 0

    If Me.SelectionFont IsNot Nothing Then
        nHeight = CInt(Me.SelectionFont.Height * Me.ZoomFactor)
    Else
        nHeight = CInt(Me.Font.Height * Me.ZoomFactor)
    End If

    If Not mInsertKeyState AndAlso Me.SelectionStart < Me.TextLength Then
        Dim p1 As Point = MyBase.GetPositionFromCharIndex(Me.SelectionStart)
        Dim p2 As Point = MyBase.GetPositionFromCharIndex(Me.SelectionStart + 1)

        nWidth = p2.X - p1.X
    End If

    CreateCaret(Me.Handle, IntPtr.Zero, nWidth, nHeight)
    ShowCaret(Me.Handle)
End Sub 
```

# linux - 配置SVN通过TOR代理

> ID：12015700
> 
> 赞同：3
> 
> 时间：2012-08-18T03:54:20.680
> 
> 标签：linux, svn, tor

我可以在 .subversion/server 中找到“http-proxy-*”变量来配置 SVN 以通过 HTTP 代理服务器。如何配置 SVN 以通过 SOCKS 代理服务器（如 TOR）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T11:27:22.040

Subversion 可以通过 HTTP 代理或 SSH 隧道连接，但它不知道 SOCKS，因此您需要通过捕获其所有 TCP 连接并将它们重定向到 SOCKS 代理来“SOCKSify”Subversion。这可以通过使用[ProxyChains](http://proxychains.sourceforge.net/)来完成。
查看这些页面以获取有关如何使用它的示例：

*   [如何使用 ssh 隧道设置颠覆代理？](https://serverfault.com/questions/73475/how-can-i-set-proxy-for-subversion-with-ssh-tunnel)
*   [HowTo：通过 SSH socks 代理进行颠覆](http://sysblog.blogs.ilrt.org/2011/12/05/howto-subversion-over-an-ssh-so-cks-proxy/)

# c# - 在 .NET 中反序列化 JSON 字符串的小数点格式问题

> ID：12015701
> 
> 赞同：0
> 
> 时间：2012-08-18T03:54:37.420
> 
> 标签：c#, .net, serialization, deserialization

如果客户端将 {f: "1,00"} 传递给服务器以使用以下 .NET 对象进行反序列化，则会出现转换错误，框架无法将其识别为有效的**十进制**值。客户端位于“ **id-id** ”语言环境中，因此“1,00”实际上是十进制的“1.00”。

我可以告诉框架使用正确的数字格式化程序来解决我的问题吗？谢谢。

```
using System.Runtime.Serialization;

[DataContract]
public class EntryParameter
{
    [DataMember(Name = "f")]
    public decimal Foo { get; set; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T04:18:10.673

您也可以尝试此解决方案以确保将小数识别为特定格式

```
value = "1,00";
   style = NumberStyles.AllowDecimalPoint;
   culture = CultureInfo.CreateSpecificCulture("fr-FR");
   if (Decimal.TryParse(value, style, culture, out number))
   {
       decimal topaas=number;
   } 
```

# iphone - UIButton 复选框

> ID：12015702
> 
> 赞同：2
> 
> 时间：2012-08-18T03:55:22.730
> 
> 标签：iphone, ios5, uibutton

我有 6 个 UIButtons 已在以下代码中生成：

```
int count = 0;
    for (int i= 0; count<6; i++) {
        for (int j=0; j<1&&count<6; j++) {
            followbutn = [UIButton buttonWithType:UIButtonTypeCustom];
            followbutn.frame = CGRectMake(20, i*44+53, 280, 40);
            [followbutn setTitle:[followuparray objectAtIndex:count] forState:UIControlStateNormal];
            [followbutn addTarget:self action:@selector(followaction:) forControlEvents:UIControlEventTouchUpInside];
            [followbutn setImage:[UIImage imageNamed:@"checkbox_unchecked.png"] forState:UIControlStateNormal];

            followbutn.tag = count;
            [self.view addSubview:followbutn];
        }
        count++; 
    }

-(void)followaction:(id)sender
{
    UIButton *button = (UIButton *)sender;
    NSLog(@"%d",button.tag);

    [followbutn viewWithTag:button.tag];
    [followbutn setImage:[UIImage imageNamed:@"checkbox_checked.png"] forState:UIControlStateNormal];
} 
```

当我单击任何按钮时，必须检查该特定按钮，而不得检查其他按钮。当我单击任何按钮时，只有带有最后一个标签的按钮会签入。

有人可以确定问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T04:10:04.323

所以基本上你想实现一个复选框？您应该创建一个`UIButton`. 然后将这行代码添加到`UIViewController`按钮的或其他容器中。

`[myButton addTarget:self action:@selector(selfTapped) forControlEvents:UIControlEventTouchDown];`

然后将以下方法添加到容器中：

```
-(void)selfTapped{
 //CustomButton is the UIButton Subclass
 for(CustomButton *but in buttonArray){
  if(but.checked){
    but.checked = NO;
    [but setImage:[UIImage imageNamed:@"unchecked.png"] forControlEvents:UIControlEventTouchDown];
  }else{
    but.checked = YES
    [but setImage:[UIImage imageNamed:@"checked.png"] forControlEvents:UIControlEventTouchDown];
  }
 }
} 
```

***请让我知道，如果你有任何问题。***

Checked 是一个`BOOL`，再一次，这个方法在一个 的子类中`UIButton`，并且这段代码中的两个图像是显示一个选中和取消选中复选框的图像，对应于 的值`BOOL`。

编辑：请参阅我上面的编辑以回应您的评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T04:58:20.343

只要我理解您的问题，我认为您希望您的按钮用作单选按钮。为此，为每个按钮提供唯一标签，这与您在此处仅使用一个计数 var 标记的情况不同。使用该标签通过更改其图像来检查您的按钮并删除其他按钮的标签接受您选中的标签。当您想检查其他按钮时，再次初始化标签值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T05:19:34.073

在您的代码中使用它......运行这个循环直到最大标签值......

```
-(void)followaction:(id)sender
{
    for (int i = 0; i < value; i++)
    {
        UIButton *button = (UIButton *)[button viewWithTag:i];
        [button setImage:[UIImage imageNamed:@"checkbox_unchecked.png"] forState:UIControlStateNormal];
    }

    UIButton *button = (UIButton *)sender;

    [button viewWithTag:button.tag];
    [button setImage:[UIImage imageNamed:@"checkbox_checked.png"] forState:UIControlStateNormal];
} 
```

# ios - 如何在 UILabel 中加粗一些文本？

> ID：12015704
> 
> 赞同：1
> 
> 时间：2012-08-18T03:55:35.023
> 
> 标签：ios, uilabel

例如，我想显示如下内容：

`It is my`**大胆的**`text label.`

但是`It is my`的长度是不可预料的，因为，它可能变成

`Oh! It is my` **大胆的** `text label.`

所以，我不能使用 3 个标签来这样做。有什么推荐吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T04:06:00.433

UILabel 不能开箱即用。

我推荐使用[GitHub](https://github.com/AliSoftware/OHAttributedLabel)上提供的[OHAttributedLabel](https://stackoverflow.com/a/3869071/14955)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T04:03:37.687

您仍然可以使用 3 个标签 :)

假设`It is my`标签是`label1`，编写一个包装函数，您总是调用它来更改`label1`的文本；此函数还应重新计算`label1`的大小和重新定位`label2`和`label3`.

```
-(void) setLabel1Text(NSString* newText)
{
    label1.text = newText;
    int label1TextLength = [label1.text sizeWithFont:label1.font];

    label2.x = label1.x + label1TextLength;
    label3.x = label2.x + label2.width;
} 
```

瞧 :)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-18T04:00:49.663

使用“UILabel”，这在严格意义上是不可能的。但是，如果您希望所有文本都是粗体，则可以使用粗体。请参考[此页面](http://ajnaware.wordpress.com/2008/10/24/list-of-fonts-available-on-the-iphone/)以获取字体列表。例如，您可以使用 Helvetica-Bold 代替 Helvetica。然而，对于 plain `UILabel`s，格式化是全部或全部；所有文本都必须是粗体，或者没有一个是粗体。要显示富文本，其中某些部分为粗体，但其他部分不是，请查看`NSMutableAttributedString`. 祝你好运！

# c# - 如何从 Listbox 控件 c# windows 窗体中删除当前 SelectedIndex 项

> ID：12015715
> 
> 赞同：0
> 
> 时间：2012-08-18T03:58:33.763
> 
> 标签：c#, .net, winforms, listbox

请一些人告诉我如何从列表框控件中删除当前的 SelectedIndex 项。

这是我的代码：.................................................. ..................................................... ..................................................... ...

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        listBox1.Items.Add("www.google.com");
        listBox1.Items.Add("www.facebook.com");
        listBox1.Items.Add("www.yahoo.com");
        listBox1.SelectedIndex = 0;
        listBox1.DataSource = listBox1.Items;

    }

    private void button1_Click(object sender, EventArgs e)
    {
        var num = listBox1.Items.Count;
        string str = Convert.ToString(num);
        textBox1.Text = str;
        for (int i = 0; i < num; )
        {
            webBrowser1.Navigate(listBox1.SelectedItem.ToString());
            while (webBrowser1.ReadyState != WebBrowserReadyState.Complete)
            {
                Application.DoEvents();
                if (webBrowser1.ReadyState == WebBrowserReadyState.Complete)
                {
                    //what do i do to remove current SelectedIndex item from Listbox control.
                }
            }
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T04:11:26.383

您可以使用*[RemoveAt](http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.objectcollection.removeat)*直接从*Items*集合中删除它：

```
listBox1.Items.RemoveAt(listBox1.SelectedIndex); 
```

或者，您可以删除*[SelectedItem](http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.selecteditem)*：

```
listBox1.items.Remove(listBox1.SelectedItem); 
```

# php - 使用 pdftk 实用程序的 PHP exec() 的安全性

> ID：12015718
> 
> 赞同：0
> 
> 时间：2012-08-18T03:59:40.800
> 
> 标签：php, security, pdftk

我有兴趣通过从 PHP 脚本调用[pdftk](http://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/)（pdft 工具包）来使用它。我打算为此使用该[`exec()`](http://www.php.net/manual/en/function.exec.php)功能。该命令将遵循以下格式：

`pdftk [form_file] fill_form [data_file] output [output_file] flatten`

此命令采用表单 PDF 文件 ( `form_file`) 并插入 FDF 数据`data_file`并将表单展平并将其另存为`output_file`.

这是我想通过类似的功能来确保执行此命令的方法`exec()`

*   目录和文件名不是用户定义的。目录和文件名是根据经过清理的标识符字符串生成的，并且仅包含字母数字字符、破折号、下划线和句点。标识符字符串将具有有限的实用长度。
*   [`escapeshellarg()`](http://www.php.net/manual/en/function.escapeshellarg.php)参数（文件名）在连接到命令之前会被传递（尽管如果后续步骤没有漏洞，这可能是不必要的）。
*   整个命令通过[`escapeshellcmd()`](http://www.php.net/manual/en/function.escapeshellcmd.php).

在执行此命令时，我是否忽略了任何安全漏洞？（我现在唯一能想到的是 pdftk 本身是否存在漏洞以及它如何处理文件。）有什么改进这个过程的建议吗？谢谢。

# jquery - 如何更新 data-* attrs？

> ID：12015720
> 
> 赞同：0
> 
> 时间：2012-08-18T03:59:56.700
> 
> 标签：jquery

使用 jQuery 1.7.2，如何在更新*数据模型时更新*`data-*`元素中的属性？

 *例如：

```
$('el').attr('data-x', 400);
var data = $('el').data( );
data.x += 100; 
```

更改`$(el).data()`似乎不会将更改推回元素的属性`data-*`。

我为什么要这个？我想使用带有最新数据的内置 jQuery 选择器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T04:03:17.003

你可以这样做：

```
$('el').attr('data-x', 400); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T04:06:53.530

除非您将直接使用属性值（例如在非 jQuery 插件中），否则没有理由将数据推回元素的属性。更改只发生在客户端，因此简单地缓存从`[data-*]`属性中检索到的值会提高性能。

如果您*绝对必须*更新属性值，则应使用该[`.attr()`](http://api.jquery.com/attr)方法。

此外，在检索数据时，重要的是要知道该[`.data()`](http://api.jquery.com/data)方法将尝试找出您的内容是哪种数据类型：

```
<div data-foo="bar" data-baz="0" data-fizz='{"a":"b"}' data-bool="true"></div>

$('div').data('foo');       //returns "bar"
$('div').attr('data-foo');  //returns "bar"

$('div').data('baz');       //returns 0
$('div').attr('data-baz');  //returns "0"

$('div').data('fizz');      //returns {"a":"b"} as an object
$('div').attr('data-fizz'); //returns "{\"a\":\"b\"}"

$('div').data('bool');      //returns true
$('div').attr('data-bool'); //returns "true" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-18T04:08:17.257

要使用`data-*`属性，请使用`attr(name,value)`方法 -- 与任何其他属性值相同：

设置它：

```
$('#myDiv').attr('data-name', 'bob'); 
```

为拿到它，为实现它：

```
var name = $('#myDiv').attr('data-name'); 
```

`data-*` *attributes*和`$(..).data()`function之间的区别在于， *attribute*只能包含字符串值，而 jQuery 的`data()`函数允许您附加（并稍后检索）实际的 javascript 对象。

```
var obj = { 
  name: bob, age: 27,
  foo: function() { ... }
};
$('#myDiv').data('some.identifier', obj);

// then later
var obj2 = $('#myDiv').data('some.identifier');

console.log(obj2 === obj);  // true! 
```*

# asp.net-mvc - 在 MVC 中不能同时打开多个页面

> ID：12015728
> 
> 赞同：0
> 
> 时间：2012-08-18T04:01:49.110
> 
> 标签：asp.net-mvc

我正在将网站从 Web 表单转换为 mvc。该网站有一个使用线程调用其他网络服务的页面。加载该页面需要 5 到 7 秒。在加载该页面时，如果我尝试打开同一网站的任何其他页面，它就不再起作用了。如果我在新选项卡中打开其他页面，它们会一直加载，直到第一页加载完成（5 到 7 秒）。它曾经在 Web 表单中工作。

有没有我可以研究的地方来解决这个问题，或者这只是我的应用程序特定的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T07:04:39.997

通过查看您的问题描述，想到的一件事是 ASP.NET 会话。如果您的站点使用它，则无法将 2 个并行请求发送到从同一会话写入会话的控制器操作。ASP.NET 只是对会话的访问进行序列化，并将阻塞直到第一个请求完成。解决此问题的一种方法是完全禁用会话或不从您正在调用的控制器对其进行写入。这可以通过使用`[SessionState]`属性装饰这个控制器来完成：

```
[SessionState(SessionStateBehavior.ReadOnly)]
public class HomeController : Controller
{
    ... actions in this controller can be invoked 
        in parallel from the same session
} 
```

# c# - 如何平移和缩放表单

> ID：12015730
> 
> 赞同：0
> 
> 时间：2012-08-18T04:02:40.840
> 
> 标签：c#, bitmap, bmp

因此，我一直在使用此代码为我正在处理的应用程序显示图像。

```
e.Graphics.DrawImage(global::Map.Properties.Resources.bigmap, 0, 0, 980, 980); 
```

这反过来又给了我这个。（编辑：新人不能发布图片。对不起。但是你可以在这里查看 -[地图](http://i.stack.imgur.com/dD5Su.jpg)）

这很好，但考虑到分辨率约为 3500X3500，我希望能够缩放和平移它。那么，有没有办法让我做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T14:24:01.197

我这周就遇到了这个问题。

尝试这样[的](http://www.codeproject.com/Articles/12331/ImageBox-Control-with-Zoom-Pan-Capability)事情。它对我来说效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T04:21:29.953

快速而肮脏的方法？将图像保存到外部文件并在 WebBrowser 控件中打开它。提供内置的平移和缩放。否则，您将需要捕获鼠标移动、滚轮处理程序等……所有这些都可以完成，但工作量要大得多。要保存图像，从您的代码中可以看出，只需：

```
Map.Properties.Resources.bigmap.Save(System.Environment.CurrentLocation + "\\temp.bmp");
MapWebBrowser.Navigate(System.Environment.CurrentLocation + "\\temp.bmp"); 
```

如果代码不能开箱即用，我们深表歉意，但这应该是一个很好的起点。我现在没有 C# 的副本。如果您需要更多解释，请告诉我。（需要添加 MapWebBrowser，它只是一个 WebBrowserControl）。

# android - 安卓 SQLite 示例

> ID：12015731
> 
> 赞同：55
> 
> 时间：2012-08-18T04:02:49.540
> 
> 标签：android, database, sqlite, sqliteopenhelper

我是 Android 新手，我必须创建一个需要使用 SQLite 数据库的应用程序。我对 SQLite 的装备不太好。

你能告诉我这个`SQLiteOpenHelper`类的目的和用途，并提供一个简单的数据库创建和插入示例吗？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2012-08-18T04:35:03.150

Sqlite 助手类帮助我们管理数据库创建和版本管理。SQLiteOpenHelper 负责所有数据库管理活动。要使用它，
1.Override`onCreate(), onUpgrade()`的方法`SQLiteOpenHelper`。可选择覆盖 onOpen() 方法。
2.使用这个子类创建一个可读或可写的数据库，并使用 SQLiteDatabase 的四个 API 方法`insert(), execSQL(), update(), delete()`来创建、读取、更新和删除表的行。

创建 MyEmployees 表并选择和插入记录的示例：

```
public class MyDatabaseHelper extends SQLiteOpenHelper {

    private static final String DATABASE_NAME = "DBName";

    private static final int DATABASE_VERSION = 2;

    // Database creation sql statement
    private static final String DATABASE_CREATE = "create table MyEmployees
                                 ( _id integer primary key,name text not null);";

    public MyDatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    // Method is called during creation of the database
    @Override
    public void onCreate(SQLiteDatabase database) {
        database.execSQL(DATABASE_CREATE);
    }

    // Method is called during an upgrade of the database,
    @Override
    public void onUpgrade(SQLiteDatabase database,int oldVersion,int newVersion){
        Log.w(MyDatabaseHelper.class.getName(),
                         "Upgrading database from version " + oldVersion + " to "
                         + newVersion + ", which will destroy all old data");
        database.execSQL("DROP TABLE IF EXISTS MyEmployees");
        onCreate(database);
    }
} 
```

现在你可以使用这个类，如下所示，

```
public class MyDB{  

    private MyDatabaseHelper dbHelper;  

    private SQLiteDatabase database;  

    public final static String EMP_TABLE="MyEmployees"; // name of table 

    public final static String EMP_ID="_id"; // id value for employee
    public final static String EMP_NAME="name";  // name of employee

    /** 
     * 
     * @param context 
     */  
    public MyDB(Context context){  
        dbHelper = new MyDatabaseHelper(context);  
        database = dbHelper.getWritableDatabase();  
    }

    public long createRecords(String id, String name){  
        ContentValues values = new ContentValues();  
        values.put(EMP_ID, id);  
        values.put(EMP_NAME, name);  
        return database.insert(EMP_TABLE, null, values);  
    }    

    public Cursor selectRecords() {
        String[] cols = new String[] {EMP_ID, EMP_NAME};  
        Cursor mCursor = database.query(true, EMP_TABLE,cols,null  
            , null, null, null, null, null);  
        if (mCursor != null) {  
            mCursor.moveToFirst();  
        }  
        return mCursor; // iterate to get each value.
    }
} 
```

现在您可以在活动中使用 MyDB 类来进行所有数据库操作。创建记录将帮助您插入值，类似地您可以拥有自己的更新和删除功能。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-18T04:08:36.470

以下链接我帮助你

[1.Android Sqlite 数据库](http://www.androidhive.info/2011/11/android-sqlite-database-tutorial/)

[2.教程1](http://www.codeproject.com/Articles/119293/Using-SQLite-Database-with-Android)

**数据库助手类：**

管理数据库创建和版本管理的助手类。

您创建一个实现和 可选的子类`onCreate(SQLiteDatabase)`，并且此类负责打开数据库（如果存在），如果不存在则创建它，并根据需要对其进行升级。事务用于确保数据库始终处于合理状态。`onUpgrade(SQLiteDatabase, int, int)``onOpen(SQLiteDatabase)`

此类使`ContentProvider`实现可以轻松地将数据库的打开和升级推迟到第一次使用，以避免因长时间运行的数据库升级而阻塞应用程序启动。

您需要更多参考此链接[Sqlite Helper](http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-18T04:06:51.700

DBHelper 类负责处理 sqlite 数据库的打开和关闭以及 sa 创建和更新，关于它是如何工作的一篇不错的文章在[这里](http://www.vogella.com/articles/AndroidSQLite/article.html)。当我开始使用 android 时，它非常有用（但是我最近一直在使用 Objective-c，并且忘记了它的大部分用途。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-18T04:16:52.937

使用 Helper 类，您可以访问 SQLite 数据库，并可以通过覆盖 onCreate() 和 onUpgrade() 方法对其执行各种操作。

[http://technologyguid.com/android-sqlite-database-app-example/](http://technologyguid.com/android-sqlite-database-app-example/)

# r - 将函数应用于 xts 对象

> ID：12015741
> 
> 赞同：2
> 
> 时间：2012-08-18T04:05:46.350
> 
> 标签：r, xts

我让我们说一个具有以下值的 xts 对象（数据）......

```
 SPY.Adjusted     SMA
2012-08-02       136.64 137.115
2012-08-03       139.35 137.995
2012-08-06       139.62 139.485
2012-08-07       140.32 139.970
2012-08-08       140.49 140.405
2012-08-09       140.61 140.550
2012-08-10       140.84 140.725 
```

如果满足某些条件，我正在尝试使用 apply 函数向其附加信号......在这种情况下，当收盘价 > SMA 时。我的功能：

```
signal<-function(x,y,z)
  {
    z$signals<-ifelse(x>y,1,0)
  } 
```

我试着...

```
apply(data,1,FUN=signal(data$SPY.Adjusted,data$SMA,data)) 
```

返回错误：

```
Error in match.fun(FUN) : 'signal(data$SPY.Adjusted, data$SMA, data)'
  is not a function, character or symbol 
```

可能出了什么问题？我向它传递了一个函数，如果满足某些条件，该函数会到达传递给它的对象数据以创建一个新列。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T04:18:02.063

当您使用 调用 apply 时`MARGIN=1`，就像将每一行传递给`FUN`. 您的函数已经矢量化，因此您不需要使用`apply`. 但是，您的函数不会返回任何内容。尝试这个：

```
library(quantmod)
getSymbols("SPY", src='yahoo', from='2010-01-01', to='2012-01-01')
dat <- cbind(Ad(SPY), SMA=SMA(Ad(SPY)))
signal<-function(x,y,z)
{
     z$signals<-ifelse(x>y,1,0)
     z
}

tail(signal(dat[, 1], dat[, 2], dat))
#           SPY.Adjusted     SMA signals
#2011-12-22       124.08 121.693       1
#2011-12-23       125.19 121.805       1
#2011-12-27       125.29 122.108       1
#2011-12-28       123.64 122.361       1
#2011-12-29       124.92 122.871       1
#2011-12-30       124.31 123.276       1 
```

实际上，我尽量避免`ifelse`在这样的情况下，因为它比这样做慢

```
signal<-function(x,y,z)
{
  z$signals <- 0
  z$signals[x > y] <- 1
  z
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T04:35:15.210

@GSee 的[回答](https://stackoverflow.com/a/12015797/1270695)解决了您的实际问题，但我发现这更直接：

```
dat$signal = (dat[,1] > dat[,2]) + 0 
```

该部分`(dat[,1] > dat[,2])`创建 和 的向量`TRUE`，`FALSE`当您向其中添加“0”时，将其转换为 0`FALSE`和 1 `TRUE`。

（`dat`在本例中，与@GSee 的相同`dat`。）

当然，您也可以使用它来匹配多个条件：

```
set.seed(1)
dat$SAMPLE = sample(as.vector(c(dat$SPY.Adjusted, dat$SMA)), nrow(dat))
dat$signal = (dat$SPY.Adjusted > dat$SMA & dat$SPY.Adjusted > dat$SAMPLE) + 0
tail(dat, 15)
#            SPY.Adjusted     SMA  SAMPLE signal
# 2011-12-09       124.07 122.421 125.990      0
# 2011-12-12       122.26 122.864 124.260      0
# 2011-12-13       121.11 123.159 128.350      0
# 2011-12-14       119.82 122.839 114.966      0
# 2011-12-15       120.26 122.565 128.490      0
# 2011-12-16       120.44 122.320 126.486      0
# 2011-12-19       119.15 121.812 128.598      0
# 2011-12-20       122.75 121.660 127.605      0
# 2011-12-21       122.99 121.485 119.150      1
# 2011-12-22       124.08 121.693 116.030      1
# 2011-12-23       125.19 121.805 104.870      1
# 2011-12-27       125.29 122.108 116.460      1
# 2011-12-28       123.64 122.361 126.127      0
# 2011-12-29       124.92 122.871 119.750      1
# 2011-12-30       124.31 123.276 104.110      1 
```

# java - 始终获取唯一 ID 并将其释放以供重复使用

> ID：12015742
> 
> 赞同：0
> 
> 时间：2012-08-18T04:05:50.160
> 
> 标签：java, multithreading, threadpoolexecutor

```
ExecutorService service = new ThreadPoolExecutor(10, 10, 1000L,
    TimeUnit.MILLISECONDS, new ArrayBlockingQueue<Runnable>(10, true), new 
    ThreadPoolExecutor.CallerRunsPolicy()); 
```

**问题陈述是：-**

每个线程都使用`unique ID`between `1 and 1000`and 程序必须运行 for `60 minutes or more`，在我检查时我`run method`得到了`id as zero`几次`(if(id==0))`，我把断点放在那个循环下，我不知道为什么？由于 availableExistingIds 的值在 1 到 1000 之间，所以我不知道这是从哪里来的`zero is coming in my id`？

```
class IdPool {
    private final LinkedList<Integer> availableExistingIds = new LinkedList<Integer>();

    public IdPool() {
        for (int i = 1; i <= 1000; i++) {
            availableExistingIds.add(i);
        }
    }

    public synchronized Integer getExistingId() {
        return availableExistingIds.removeFirst();
    }

    public synchronized void releaseExistingId(Integer id) {
        availableExistingIds.add(id);
    }
}

class ThreadNewTask implements Runnable {
    private IdPool idPool;
    private int id;

    public ThreadNewTask(IdPool idPool) {
        this.idPool = idPool;
    }

    public void run() {
        try {
        id = idPool.getExistingId();
    //Anything wrong here?  
                if(id==0) {
        System.out.println("Found Zero");
        }
        someMethod(id);
        } catch (Exception e) {
        System.out.println(e);
        } finally {
        idPool.releaseExistingId(id);
        }
    }

// This method needs to be synchronized or not?
    private synchronized void someMethod(Integer id) {
        System.out.println("Task: " +id);
// and do other calcuations whatever you need to do in your program
    }
} 
```

以下是程序开始的主要课程 -

```
public class TestingPool {
    public static void main(String[] args) throws InterruptedException {
        int size = 10;
        int durationOfRun = 60;
        IdPool idPool = new IdPool();   
        // create thread pool with given size
        ExecutorService service = new ThreadPoolExecutor(size, size, 500L, TimeUnit.MILLISECONDS, new ArrayBlockingQueue<Runnable>(size), new ThreadPoolExecutor.CallerRunsPolicy()); 

        // queue some tasks
        long startTime = System.currentTimeMillis();
        long endTime = startTime + (durationOfRun * 60 * 1000L);

        // Running it for 60 minutes
        while(System.currentTimeMillis() <= endTime) {
            service.submit(new ThreadNewTask(idPool));
        }

        // wait for termination        
        service.shutdown();
        service.awaitTermination(Long.MAX_VALUE, TimeUnit.DAYS); 
    }
} 
```

**更新：-**

我想在这里使用 ArrayBlockingQueue ，这样当没有可用的 id 时它不会崩溃，而是等待一个可用。谁能建议我如何在这里使用它？

实施 BlockingQueue 后的代码更改。

```
public void run() {
    System.err.println(command.getDataCriteria());
    if(command.getDataCriteria().equals(PDSLnPConstants.DATA_CRITERIA_PREVIOUS)) {
    try {
        System.out.println(command.getDataCriteria());
        // Getting existing id from the pool
        existId = existPool.take();
        attributeGetSetMethod(existId);
    } catch (Exception e) {
        getLogger().log(LogLevel.ERROR, e.getLocalizedMessage());
    } finally {
        // And releasing that existing ID for re-use
        existPool.offer(existId);       
    }
    } 

else if(command.getDataCriteria().equals(PDSLnPConstants.DATA_CRITERIA_NEW)) {
    try {
        System.out.println(command.getDataCriteria());
        // Getting new id from the pool
        newId = newPool.take();
        attributeGetSetMethod(newId);
    } catch (Exception e) {
        getLogger().log(LogLevel.ERROR, e.getLocalizedMessage());
    } finally {
        // And releasing that new ID for re-use
        newPool.offer(newId);   
    }
    }
} 
```

我刚刚注意到的一件奇怪的事情是-在下面`else if loop`，如果您在下面看到我的上面的代码，`run method`那么`command.getDataCriteria() is Previous`它也被输入到`else if block(which is for New)`其中不应该发生在我正在做的事情`.equals check`？为什么会这样？

```
else if(command.getDataCriteria().equals(PDSLnPConstants.DATA_CRITERIA_NEW)) { 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T04:35:35.420

您可能会获得 id = 0 的一种情况（除了由于您不使用同步而导致的未定义行为的可能性）是 id 池耗尽（空）时。发生这种情况时，该行：

```
id = idPool.getExistingId(); 
```

将失败并出现 NoSuchElementException。在这种情况下，`finally`块将运行：

```
idPool.releaseExistingId(id); 
```

但是自第一行失败以来`id`仍将具有其默认值。`0`因此，您最终“释放”`0`并将其添加回 id 池，即使它从未在池中开始。然后以后的任务可以`0`合法地进行。

但是，如果发生这种情况，这肯定应该在 catch 块中打印您的异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T04:14:07.803

Java 提供（自 Java 5 起）[Semaphore](http://javapapers.com/core-java/semaphores-using-java/)，我相信您正在研究[计数 semaphore](http://www.javacodegeeks.com/2011/09/java-concurrency-tutorial-semaphores.html)。

# java - 获取目录中的所有图像 - 在 jar 文件中

> ID：12015747
> 
> 赞同：1
> 
> 时间：2012-08-18T04:06:21.270
> 
> 标签：java, resources, io, classpath

我的项目中有一个包含 238 张图像的文件夹。我希望能够找到目录中的所有图像。

我目前正在像这样访问所有这些图像：

```
File directory = new File(FileNameGuesser.class.getResource(DIRECTORY).getPath());
for (File file : directory.listFiles()) {
    // filter, process, etc.
} 
```

这在 Eclipse 中运行良好。但是，当我导出到 jar 文件时，`FileNameGuesser.class.getResource(DIRECTORY)`返回`C:\Users\...\file.jar!\org\...`（因为它是压缩的，我假设）并且方法中断。

我怎样才能做到这一点？

**编辑**：如果可能的话，我想找到一个既适用于 Eclipse*又*适用于已部署的 jar 的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T04:22:58.200

这*实际上*不可能以任何漂亮而干净的方式实现。

能够做`.getClass().getResources("/pictures/*.jpg")`（或做某事）会很好，但我们不能。

你能做的最好的就是作弊一点。如果您知道存储图像的 jar 文件的名称，则可以使用`JarFile`或`ZipFile`API 来获取列表：

```
ZipFile zipFile = null;
try {

    zipFile = new ZipFile(new File("...")); // Path to your Jar
    Enumeration<? extends ZipEntry> entries = zipFile.entries();
    while (entries.hasMoreElements()) {

        ZipEntry entry = entries.nextElement();

        // Here, I've basically looked for the "pictures" folder in the Zip
        // You will need to provide the appropriate value
        if (!entry.isDirectory() && entry.getName().startsWith("pictures")) {

            // Basically, from here you should have the full name of the
            // image.  You should be able to then construct a resource path
            // to the image to load it...

            // URL url = getClass().getResource("/" + entry.getName());
            System.out.println(entry.getName());

        }

    }

} catch (Exception exp) {

    exp.printStackTrace();

} finally {

    try {
        zipFile.close();
    } catch (Exception e) {
    }

} 
```

如果您事先不知道它们的名称，更好的解决方案是不要将这些图像嵌入到您的 jar 中。

嵌入式资源确实应该提前知道您的应用程序的名称。

正如 AndrewThompson 所建议的，您可以生成资源列表，将其添加到您的 Jar 文件中。在运行时，您将加载此文件并有权访问所有资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T05:55:26.610

您可以使用`PathMatchingResourcePatternResolver`Spring 提供的。

```
public class SpringResourceLoader {

    public static void main(String[] args) throws IOException {
        PathMatchingResourcePatternResolver resolver = new PathMatchingResourcePatternResolver();

        // Ant-style path matching
        Resource[] resources = resolver.getResources("/pictures/**");

        for (Resource resource : resources) {
            System.out.println("resource = " + resource);
            InputStream is = resource.getInputStream();
            BufferedImage img =  ImageIO.read(is);
            System.out.println("img.getHeight() = " + img.getHeight());
            System.out.println("img.getWidth() = " + img.getWidth());
        }
    }
} 
```

我没有对退回的东西做任何花哨的事情，`Resource`但你明白了。

将此添加到您的 maven 依赖项（如果使用 maven）：

```
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-core</artifactId>
    <version>3.1.2.RELEASE</version>
</dependency> 
```

这将直接在 Eclipse/NetBeans/IntelliJ*和*已部署的 jar 中工作。

从 IntelliJ 中运行会得到以下输出：

```
resource = file [C:\Users\maba\Development\stackoverflow\Q12016222\target\classes\pictures\BMW-R1100S-2004-03.jpg]
img.getHeight() = 768
img.getWidth() = 1024 
```

从带有可执行 jar 的命令行运行给我以下输出：

```
C:\Users\maba\Development\stackoverflow\Q12016222\target>java -jar Q12016222-1.0-SNAPSHOT.jar
resource = class path resource [pictures/BMW-R1100S-2004-03.jpg]
img.getHeight() = 768
img.getWidth() = 1024 
```

# c++ - 二进制比特流与三进制比特流的转换？

> ID：12015752
> 
> 赞同：3
> 
> 时间：2012-08-18T04:07:54.763
> 
> 标签：c++, algorithm, ternary-representation

我需要将任意长度的二进制转换为精确的三进制表示。理想情况下，给定一个位数组`char buffer[n]`，该算法将能够产生一个三元组（位模拟），反之亦然。有这样的算法吗？

我知道将个人转换`int`为三元的方法：

```
int nth_trit(int num, int n)
{
    for(int i = 0; i < n; i++)
        num /= 3;

    return num % 3;
} 
```

唉，即使是比特流也是`long long long int`不够的。我认为使用一个大整数库就足够了，虽然我不确定，并且觉得应该有更好的方法来计算三元表示。

一个视觉示例：

```
// Conversion is simple(short stream)
Binary  - 0 1 0 0 1 0 0 1
Decimal -             7 3
Ternary -         2 2 0 1

// Conversion is hard(long stream)
Binary  - 1 0 1 0 0 0 0 1 ..........
Ternary - ? ? ? 
```

短流很简单，因为它很好地适合 a `int`，所以`nth_trit`可以使用该函数，但长流不能，所以除了使用大整数库之外，我没有想到简单的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T09:34:22.117

可以证明每个三进制数字都依赖于所有二进制数字。所以你不能比读取整个位串然后进行转换更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T05:36:09.193

如果位缓冲区很长，您的算法就不太好，因为每个输出 trit 都会重复较小的值所需的所有除法`n`。因此，将此算法转换为“bignum”算法将不是您想要的。

另一种方法：从左到右扫描位，每个新的都会更新之前的值：

```
val = val * 2 + bit 
```

带有三元组的三`n`进制数`t[i]`具有值

```
sum(i = 0 .. n-1) t[i] * 3^i 
```

因此`val`，新扫描位的更新的三元表示变为，

```
[ 2 * sum(i = 0 .. n-1) t[i] * 3^i ] + bit
    = bit + sum(i = 0 .. n-1) 2 * t[i] * 3^i 
    = 2 * t[0] + b + sum(i = 1 .. n) 2 * t[i] * 3^i 
```

为了使代码简单，让我们计算一个无符号字符数组中的三元组。完成后，您可以以任何您喜欢的方式重新包装它们。

```
#include <stdio.h>

// Compute the trit representation of the bits in the given
// byte buffer.  The highest order byte is bytes[0].  The
// lowest order trit in the output is trits[0].  This is 
// not a very efficient algorithm, but it doesn't use any
// division.  If the output buffer is too small, high order
// trits are lost.
void to_trits(unsigned char *bytes, int n_bytes, 
              unsigned char *trits, int n_trits)
{
  int i_trit, i_byte, mask;

  for (i_trit = 0; i_trit < n_trits; i_trit++)
    trits[i_trit] = 0;

  // Scan bits left to right.
  for (i_byte = 0; i_byte < n_bytes; i_byte++) {

    unsigned char byte = bytes[i_byte];

    for (mask = 0x80; mask; mask >>= 1) {
      // Compute the next bit.
      int bit = (byte & mask) != 0;

      // Update the trit representation
      trits[0] = trits[0] * 2 + bit;
      for (i_trit = 1; i_trit < n_trits; i_trit++) {
        trits[i_trit] *= 2;
        if (trits[i_trit - 1] > 2) {
          trits[i_trit - 1] -= 3;
          trits[i_trit]++;
        }
      }
    }
  }
}

// This test uses 64-bit quantities, but the trit 
// converter will work for buffers of any size.
int main(void)
{
  int i;

  // Make a byte buffer for an easy to recognize value.
  #define N_BYTES 7
  unsigned char bytes [N_BYTES] = 
    { 0xab, 0xcd, 0xef, 0xff, 0xfe, 0xdc, 0xba };

  // Make a trit buffer.  A 64 bit quantity may need up to 42 trits.
  #define N_TRITS 42
  unsigned char trits [N_TRITS];

  to_trits(bytes, N_BYTES, trits, N_TRITS);

  unsigned long long val = 0;
  for (i = N_TRITS - 1; i >= 0; i--) {
    printf("%d", trits[i]);
    val = val * 3 + trits[i];
  }
  // Should prinet value in original byte buffer.
  printf("\n%llx\n", val);

  return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-18T08:55:49.810

在任何基数中乘/除以 2 都很简单，因此将任何基数转换为/从二进制转换的最简单方法是重复乘/除以 2，跟踪进位/奇偶校验。

```
#include <algorithm>
#include <cstdint>
#include <functional>
#include <iostream>
#include <iterator>
#include <vector>

// in: a vector representing a bitstring, with most-significant bit first.
// out: a vector representing a tritstring, with least-significant trit first.
static std::vector<uint8_t> b2t(const std::vector<bool>& in) {
  std::vector<uint8_t> out;
  out.reserve(in.size());  // larger than necessary; will trim later
  // for each digit (starting from the most significant bit)
  for (bool carry : in) {
    // add it to the tritstring (starting from the least significant trit)
    for (uint8_t& trit : out) {
      // double the tritstring, carrying overflow to higher places
      uint8_t new_trit = 2 * trit + carry;
      carry = new_trit / 3;
      trit = new_trit % 3;
    }
    if (carry) {
      // overflow past the end of the tritstring; add a most-significant trit
      out.push_back(1);
    }
  }
  out.reserve(out.size());
  return out;
}

// in: a vector representing a tritstring, with most-significant trit first.
// out: a vector representing a bitstring, with least-significant bit first.
static std::vector<bool> t2b(std::vector<uint8_t> in) {
  std::vector<bool> out;
  out.reserve(2 * in.size());  // larger than necessary; will trim later
  bool nonzero;
  do {
    nonzero = false;
    bool parity = false;
    for (uint8_t& trit : in) {
      // halve the tritstring, starting from the most significant trit
      uint8_t new_trit = trit + 3 * parity;
      parity = new_trit & 1;
      nonzero |= trit = new_trit / 2;
    }
    // the division ended even/odd; add a most-signiticant bit
    out.push_back(parity);
  } while (nonzero);
  out.reserve(out.size());
  return out;
}

int main() {
  bool odd = false;
  std::string s;
  while (std::cin >> s) {
    if ((odd = !odd)) {
      std::vector<bool> in(s.size());
      std::transform(s.begin(), s.end(), in.begin(),
          [](char c) {return c - '0';});
      std::vector<uint8_t> out(b2t(in));
      std::copy(out.rbegin(), out.rend(),
          std::ostream_iterator<int>(std::cout));
      std::cout << std::endl;
    } else {
      std::vector<uint8_t> in(s.size());
      std::transform(s.begin(), s.end(), in.begin(),
          [](char c) {return c - '0';});
      std::vector<bool> out(t2b(in));
      std::copy(out.rbegin(), out.rend(),
          std::ostream_iterator<int>(std::cout));
      std::cout << std::endl;
    }
  }
  return 0;
} 
```

```
$ ./a.out 
1011
102
102
1011
10001100001101010011010010111000011011101000111101011101000110100101101101111110110011010010111100010110100010101011010100101100001101001000000111011110101001000100011010111011000111101110111001111110110011101011101101001001110010111111100011000110011000111110110111011110110110001111011011011000100101010010111010000110101011010100011010110110000010110111000111000110101000000110000001111110101110010000011000110001010000001001100011000000100100100001100101111000101001001010101101101000011100110001111011110001
12010110110220200020211012001000211110222212120220002002120120111221021120100122221020011120010202110111112112110201211201120222000011010100122122121211112101111121002110102112000111200002121211002022100220211220220111010210200222021221020122012102101010100001122200011110210221120122022011202201002002001221211001221112001
12010110110220200020211012001000211110222212120220002002120120111221021120100122221020011120010202110111112112110201211201120222000011010100122122121211112101111121002110102112000111200002121211002022100220211220220111010210200222021221020122012102101010100001122200011110210221120122022011202201002002001221211001221112001
10001100001101010011010010111000011011101000111101011101000110100101101101111110110011010010111100010110100010101011010100101100001101001000000111011110101001000100011010111011000111101110111001111110110011101011101101001001110010111111100011000110011000111110110111011110110110001111011011011000100101010010111010000110101011010100011010110110000010110111000111000110101000000110000001111110101110010000011000110001010000001001100011000000100100100001100101111000101001001010101101101000011100110001111011110001
^D

```

（1011 [2] = 8 + 2 + 1 = 11 = 9 + 2 = 102 [3]）
（10001100001101010011010010111000011011101000111101011101000110100101101101111110110011010010111100010110100010101011010100101100001101001000000111011110101001000100011010111011000111101110111001111110110011101011101101001001110010111111100011000110011000111110110111011110110110001111011011011000100101010010111010000110101011010100011010110110000010110111000111000110101000000110000001111110101110010000011000110001010000001001100011000000100100100001100101111000101001001010101101101000011100110001111011110001 [2]= 7343280200542654154029818354420920722408633707396360612751407162736942742985658428558632312175242897575484682660836397639769592568209070221085927986634481 = 12010110110220200020211012001000211110222212120220002002120120111221021120100122221020011120010202110111112112110201211201120222000011010100122122121211112101111121002110102112000111200002121211002022100220211220220111010210200222021221020122012102101010100001122200011110210221120122022011202201002002001221211001221112001 [9]）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-03T20:34:04.927

平衡的三元/三元更好。{-1, 0, 1} 以这种方式输出。

# android - 我可以使用 phonegap 创建不需要互联网连接即可工作的丰富的 android 应用程序吗？

> ID：12015759
> 
> 赞同：0
> 
> 时间：2012-08-18T04:09:14.690
> 
> 标签：android, cordova, media-player

我正计划为 android 构建一些丰富的应用程序，例如媒体播放器。
这里所说的丰富应用程序是指看起来和工作起来几乎（如果不完全一样的话）原生应用程序的应用程序。
但我不希望我的用户必须有互联网连接，才能收听存储在他们设备中的歌曲。
可以使用PhoneGap创建吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T05:34:20.630

对于你的问题，我的回答是肯定的，你可以。

但是，当你在跨平台环境和原生环境中制作这样的应用程序时，会有很大的不同。

[有关更多详细信息，请参阅此答案](https://stackoverflow.com/a/11829801/1441326)

# uiwebview - 在 UIWebView 中处理点击链接

> ID：12015764
> 
> 赞同：0
> 
> 时间：2012-08-18T04:10:04.930
> 
> 标签：uiwebview

我知道在 UIWebview 中处理点击链接的方法。在我当前的应用程序中，我需要处理点击 UIWeview 然后打开另一个 UIViewController。但是，当我弹回 UIWebView 时，我无法再次单击该链接。请给我一些想法。谢谢

# perl - Perl：子网示例片段？

> ID：12015765
> 
> 赞同：-3
> 
> 时间：2012-08-18T04:10:06.093
> 
> 标签：perl, network-programming

我正在寻找用于获取网络子网的示例 perl 代码 例如

10.0.0.0/8 可以分解为 2 /9 == 10.0.0.0/9 , 10.128.0.0/9

或 8 /20s 从 /17 = 10.1.1.1 /17 到 /20 10.1.0.0/20, 10.1.16.0/20, 10.1.32.0/20, 10.1.48.0/20, 10.1.64.0/20,10.1.80.0 /20、10.1.96.0/20、10.1.112.0/20。

关于如何在 perl 中执行此操作的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T20:17:36.507

Have a look at [Net::CIDR::Lite](https://metacpan.org/pod/Net%3a%3aCIDR%3a%3aLite) and/or [Net::CIDR](https://metacpan.org/pod/Net%3a%3aCIDR).

# python - 忽略 CalledProcessError

> ID：12015766
> 
> 赞同：18
> 
> 时间：2012-08-18T04:10:09.097
> 
> 标签：python, shell, subprocess

我正在使用该`subprocess`模块并`check_output()`在我的 Python 脚本中创建一个虚拟 shell，它适用于返回零退出状态的命令，但是对于那些不返回异常而不打印将显示在普通外壳上的输出。

例如，我希望某些东西可以像这样工作：

```
>>> shell('cat non-existing-file')
cat: non-existing-file: No such file or directory 
```

但相反，会发生这种情况：

```
>>> shell('cat non-existing-file')
CalledProcessError: Command 'cat non-existing-file' returned non-zero exit status 1 (file "/usr/lib/python2.7/subprocess.py", line 544, in check_output) 
```

即使我可以使用`try`and删除 Python 异常消息`except`，我仍然希望`cat: non-existing-file: No such file or directory`向用户显示。

我该怎么做呢？

`shell()`：

```
def shell(command):
    output   = subprocess.check_output(command, shell=True)
    finished = output.split('\n')

    for line in finished:
      print line
    return 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-18T04:32:52.207

大概是这样的？

```
def shell(command):
    try:
        output = subprocess.check_output(command, shell=True, stderr=subprocess.STDOUT)
    except Exception, e:
        output = str(e.output)
    finished = output.split('\n')
    for line in finished:
        print line
    return 
```

# iphone - 使用 Facebook SDK 进行 iOS 身份验证

> ID：12015767
> 
> 赞同：0
> 
> 时间：2012-08-18T04:10:14.003
> 
> 标签：iphone, ios, facebook

我有一个使用 facebook 连接的网站。

我有一个关于我正在为其构建的 iPhone 应用程序的安全相关问题。

对于网站，我在数据库中保留了一个 USERS 表。

除其他外，USERS 表具有以下字段：

```
ID   (int) an internal auto-generated id
FBID (int) the facebook user id
GUID (varchar 40) a random long guid for API uses 
```

当用户登录我的网站时，在通过 facebook 批准我的网站后，他会被重定向到 login.php 页面，我在该页面中获取他的 FBID 并通过创建新用户或查找现有用户轻松登录。我将 GUID 保留在会话中。

为了为我的网站构建 iphone 应用程序，我下载了 iOS facebook SDK。

显然，与网站场景相同，在批准过程结束时，我得到了用户的 FBID。问题是在我看来，将 FBID 发送到我的网站是不安全的。如果我打开一个获取 FBID 并让用户登录的 API - 任何人都可以发送他/她朋友的 FBID 并以他们的名义登录我的网站。这个对吗？如果是这样 - 我该怎么办？

干杯，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T04:32:00.290

您可以将访问令牌与 Fbid 一起发送到您的服务器，然后向 facebook 发出请求。

```
https://graph.facebook.com/me?access_token=XYZ 
```

这将与 Fbid 一起返回您的列表，然后您可以检查两个 FBId 是否相同，因此执行身份验证.. 希望这会有所帮助。

# java - JavaFX 从网页中分离

> ID：12015771
> 
> 赞同：3
> 
> 时间：2012-08-18T04:11:03.617
> 
> 标签：java, applet, javafx, javafx-2

作为一个个人项目，我正在制作一个嵌入网页的媒体播放器。我一直在玩 JavaFX 2.2，我喜欢我目前看到的（mp3 支持！）；另外，我过去制作过 java 小程序。

我知道小程序有一个简洁的功能，您可以（在 Windows 中）左键单击并拖动，小程序将与页面分离并可以在屏幕上浮动。您甚至可以离开页面，小程序将保持打开状态。我真的很喜欢这个功能——它让我看起来像是为这个功能付出了额外的努力，这并没有什么坏处。嵌入在网页中的 JavaFX 应用程序是否具有此功能？到目前为止的搜索没有给我任何结果，而且我尝试过的键/点击组合不起作用。

JavaFX 似乎正在崭露头角（也许），而小程序在大多数情况下似乎已经过时，所以我想在这个项目中使用 JavaFX。这也让我可以制作自己的预加载器。

有什么方法可以让我的媒体播放器具有分离功能？我知道我可以将 JavaFX 嵌入到小程序中，但这似乎是一种倒退，我认为我将失去预加载器选项。我也可以做一个 web start/jnlp 启动，但我希望它能够成为网页的一部分。这里最好的课程是什么？直接使用 JavaFX 并等待未来的更新？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:37:19.727

我不知道这是否仍然是您正在做的事情，但正如您在两天前评论的那样，也许这些提示对您仍然有用。

你有没有发现 JavaFX 的 JNLP 东西？简单地说，使用 Java WebStart 可以让您的 Applet/应用程序“脱离浏览器”。JavaFX 提供了这种能力，它是给你的礼物，你不需要做任何特别的/没有额外的依赖。

如您所知，可以在[此处](http://docs.oracle.com/javafx/)找到有关 FX 的文档。

特别是如果您想尝试 JNLP，也许您想看看您现在拥有的[部署选择。](http://docs.oracle.com/javafx/2/deployment/jfxpub-deployment.htm)

根据您用于开发的 IDE，您不需要做任何特别的事情（而且链接看起来比这一切都复杂）。

我有以下设置，它就像一个魅力：

*   库本图 12.04
*   JDK 7u6（包括 FX 2.2）
*   Eclipse EE 4.2 Juno（EE 版本很重要）
*   Eclipse e(fx)clipse 插件（可通过 Eclipse 市场获得）

取决于您是否计划共享您的应用程序，也许这对您也有用：在[此处](http://www.oracle.com/technetwork/java/javafx/downloads/supportedconfigurations-1506746.html)查看 FX 版本 2.2的支持平台列表

# git - 通过两个 github 存储库共享文件？

> ID：12015773
> 
> 赞同：0
> 
> 时间：2012-08-18T04:11:14.953
> 
> 标签：git, github

假设我在 github 上有两个项目：

*   项目一：a.cpp 和 ch
*   项目 2：b.cpp 和 ch

现在，我可以设置两个存储库，都具有 ch 但是，这很糟糕：如果我更改项目 1 的 ch，我需要将硬盘上的 ch 复制到项目 2 中，然后将两者都推送。

其他解决方案：制作 3 个项目：每个文件一个。但是，下载项目 1（使用 a.cpp）的人必须手动将项目 3（使用 ch）下载到项目 1 的目录中。

有什么方法可以在 github 上轻松分享 ch 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T04:23:10.797

[http://git-scm.com/book/en/Git-Tools-Submodules](http://git-scm.com/book/en/Git-Tools-Submodules)

Git 支持听起来像您需要的称为子模块的东西。在您的示例中，您将 ch 位于其自己的存储库中，并且两个项目都将包含该存储库作为子模块。我当然假设该子模块中的内容远不止一个文件。

陷阱：包含子模块的项目通常指向该子模块中的特定提交，直到并且除非您再次获取子模块并告诉您的应用程序使用最新的提交（因此是文件的最新版本）。

# asp.net-mvc-3 - ASP.NET MVC 中默认控制器上的路由操作

> ID：12015775
> 
> 赞同：0
> 
> 时间：2012-08-18T04:11:32.787
> 
> 标签：asp.net-mvc-3, asp.net-routing

我有一个默认路由，所以如果我去 www.domain.com/app/ 它是例如 HomeController。我对控件有另一个操作，例如 helloworld，但如果我转到 www.domain.com/app/helloworld，它会失败并显示 404（毫无疑问，期待 helloworld 控制器）。

如何在默认控制器上执行非默认操作，或者如何将 url /app/helloworld 映射到 helloworld 操作。我的路由如下所示：

```
routes.MapRoute(
"Default", // Route name
"{controller}/{action}/{id}", // URL with parameters
new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
);

routes.MapRoute( //this fails with same 404 like it does when it's ommitted
"Hello", // Route name
"app/helloworld", // URL with parameters
new { controller = "Home", action = "HellowWorld", id = UrlParameter.Optional } // Parameter defaults
); 
```

基本上我需要：

/app/ => 控制器 = 主页，操作 = 索引

/app/helloworld => Controller = Home，Action = HelloWorld，而不是 Controller = HelloWorld，Action - Index

/app/other => 控制器 = 其他，操作 = 索引

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T04:47:01.823

`routes`将全局文件中的 2 替换为：

```
routes.MapRoute(
    "Default", // Route name
    "App/{controller}/{action}/{id}", // URL with parameters
    new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
    ); 
```

然后验证您的`HomeController`包含：

```
public ActionResult Index()
{
    return View();
}

public ActionResult HelloWorld()
{
    return View();
} 
```

这样做的目的是`yoursite.com/app/ANYCONTROLLER/ANYACTION`将路由到控制器和操作（只要它们存在），默认`new { controller = "Home", action = "Index"`意味着如果有人去`yoursite.com/app/`它将自动路由到`yoursite.com/app/Home/Index`.

如果这不起作用，请尝试删除`app/`它，它看起来像：

```
routes.MapRoute(
    "Default", // Route name
    "{controller}/{action}/{id}", // URL with parameters
    new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
); 
```

你所拥有的看起来你正在尝试路由`yoursite.com/Home/Index`，而第二条路由的措辞是错误的，我不确定它会做什么，但`"app/helloworld`它应该看起来像`"app/HelloWorld/{action}/{id}"`then`new { controller = "Home", action = "HellowWorld"`会起作用。这样如果有人去`yoursite.com/app`它就会自动显示`yoursite.com/app/Home/HelloWorld`。希望这有助于澄清一些事情。

**这就是你想要的答案**

出于某种原因，您不想为 hello world 部分创建新控制器，文件`RegisterRoutes`中的`Global`内容应如下所示：

```
 public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            "Hello World", // Route name
            "App/HellowWorld/{id}", // URL with parameters
            new { controller = "Home", action = "HelloWorld", id = UrlParameter.Optional }
            );

        routes.MapRoute(
            "Default", // Route name
            "App/{controller}/{action}/{id}", // URL with parameters
            new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
            );
    } 
```

虽然我不建议这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T04:19:32.890

你应该只需要一条路线。与其对操作进行硬编码，不如将其设为变量，但包含默认值：

```
routes.MapRoute( //this fails with same 404 like it does when it's ommitted
    "Hello", // Route name
    "app/{action}", // URL with parameters
    new { controller = "Home", action = "HelloWorld", id = UrlParameter.Optional } 
); 
```

这样，当您访问**www.domain.com/app/**时，它将获得默认操作（HelloWorld）。但是您仍然可以将路由中的操作指定为**www.domain.com/app/someotheraction**。

另外，请记住选择了第一个匹配的路由......所以您应该考虑将默认路由移到最后，或者完全不使用它。在示例**www.domain.com/app/helloworld**中，它匹配默认路由，其中*​​ app*作为控制器，*helloworld*作为操作（这当然是无效的，因此是 404）。

# c# - DataRowView 是 GridView 中 DataTable 的对象吗？

> ID：12015779
> 
> 赞同：0
> 
> 时间：2012-08-18T04:12:44.673
> 
> 标签：c#, asp.net, gridview, datatable, datarow

我像这样将 DataTable 'dt' 绑定到 GridView。

```
 GridView1.DataSource = dt;
 GridView1.DataBind(); 
```

数据绑定成功。

在 GridView Row DataBound 我这样写：

```
DataRowView rowView = (DataRowView)e.Row.DataItem; 
```

所以我的问题是**'这个 DataRowView 是 DataTable(dt) 行的对象吗'**？因为如果是这样的话，我可以编辑 rowView 以在 DataTable(dt) 中插入数据，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T04:29:52.527

datarowview 不是 datatable 的对象，但 dataview 的对象 datarowview 是 datarow 的视图，状态为 Default、Original、Current 和 Proposed。所以 dataview wrap datatable 和 dataview wrap datarow 你可以通过 datarowview 的 Row 属性访问 datarow

# ios - CGAffineTransformInvert：奇异矩阵

> ID：12015785
> 
> 赞同：7
> 
> 时间：2012-08-18T04:13:55.623
> 
> 标签：ios, uiwebview

我偶尔会看到错误消息：

```
CGAffineTransformInvert: singular matrix 
```

在 Xcode 的日志记录区域。当我在 UIWebView 中调整网站大小时，这似乎会发生（很少发生，幸运的是）。[商业网站，不是我自己的。] 由于我在我的应用程序中没有进行仿射变换，我想知道这是否可能是 UIWebView 的错误/功能。如果是这样，我可以忽略它吗，因为它似乎没有干扰任何东西？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-12T14:39:16.103

通过查看其他帖子，如果您尝试将缩放比例设置为零，您似乎会收到此消息。当您捏合并查看它是否为零（并且与仿射变换错误同时发生）时，对 NSLog 缩放值很有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-13T13:31:11.563

然后尝试使用接近零的实数：

```
#define kNearZeroValue 0.001f 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-07-21T12:18:11.923

这是在代码中某处变换矩阵时[仿射变换的问题。](https://en.wikipedia.org/wiki/Affine_transformation)

所以基本上代码是试图转换一个无效的[奇异矩阵](https://en.wikipedia.org/wiki/Invertible_matrix)（行列式为 0）。因此，您应该避免使用以下矩阵：

```
0 0 0
0 0 0
0 0 1 
```

并且通过根据其[行列式](http://mathworld.wolfram.com/Determinant.html)检查它是否是奇异的 3x3 矩阵来进行类似的操作。对行列式为零的矩阵执行运算（类似于除以零）被认为是违反数学的。

如果您使用的是[uiscrollview](/questions/tagged/uiscrollview "显示标记为“uiscrollview”的问题")类，请确保您没有使用`setZoomScale:animated:`方法或`zoomScale`属性将实例缩放到 0，因此请检查您的滚动视图（将您的`zoomScale`,`minimumZoomScale`和`maximumZoomScale`设置为至少 0.1）。

资料来源：[CGAffineTransformInvert - 奇异矩阵误差](http://sokol8.blogspot.co.uk/2011/05/cgaffinetransforminvert-singular-matrix.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-13T12:16:48.830

对于每个 webView 做：

```
webView.scrollView.minimumZoomScale = 0.1; 
```

或任何其他大于零的数字。

# iphone - iPhone 方向问题

> ID：12015787
> 
> 赞同：0
> 
> 时间：2012-08-18T04:14:38.010
> 
> 标签：iphone, xcode, orientation, landscape, landscape-portrait

我刚刚完成的应用程序有最后一个问题。在主菜单屏幕上我只支持 1 个方向，然后在所有屏幕上我支持通常的 3 个方向。

问题是，假设我在第二个屏幕中，并且在我处于横向模式时回击，主菜单屏幕也以横向模式结束，尽管我在该方法上返回 NO。一旦菜单屏幕处于横向模式，我就不能让它变回原来的方向。按钮看起来乱七八糟，显然很乱。唯一的解决方案是回到第二个屏幕，改变那里的方向，然后回击。当我返回菜单屏幕时，是否有任何代码可以确保方向恢复到默认值？顺便说一句，测试时问题出在模拟器和实际设备上。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T18:09:03.793

好吧，伙计们，我解决了这个问题，显然完全忽略了该方法。该方法是：

```
-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation 
```

如果我：

```
return NO 
```

即使我认为返回 NO 意味着它只支持纵向模式，它也不起作用，但我错了

感谢所有评论的人

# jquery - 带有 jQ uery hashchange 事件和动画 scrollTop 的后退按钮错误

> ID：12015790
> 
> 赞同：0
> 
> 时间：2012-08-18T04:16:42.690
> 
> 标签：jquery, back-button, scrolltop, hashtag

我不确定这是一个错误还是编写它的方式，但任何帮助都很棒！

我正在使用 Ben Alman 的 jQuery hashchange 事件，我在其他项目中使用过

hashevents 使用淡入淡出动画并且没有问题。有了这个文件，我有一页

网站并使用 scrollTop 功能。后退按钮有效，但仅有效一次，并且

前进按钮根本不起作用，然后它来回跳跃但没有动画。下边是

我目前拥有的。

CSS：

```
 <nav id="primary">
            <ul>
                <li>
                 <a href="#home">home</a>
                </li>
                <li>
                <a href="#about">about</a>
                </li>
                <li>
                <a href="#services">services</a>
                </li>
                <li>
                <a href="#contact">contact</a>
                </li>
            </ul>
       </nav>

        <div id="content">
            <article id="home">home</article>
            <article id="about">about</article>
            <article id="services">services</article>
            <article id="contact">contact</article>
        </div> 
```

查询：

```
 var href         = '';
    var easeDuration = 1000;
    var easeType     = "easeOutExpo";

    //Thumbanil click states/////
$('#primary ul').delegate('li', 'click', function (e) {
    e.preventDefault();
            var index = $(this).prevAll().length;
    href =  $('#primary ul li a:eq(' + index + ')').attr('href');
            $('html, body').animate({scrollTop: $(href).offset().top},{easing: easeType,duration: easeDuration,complete: function() { 
            window.location.hash = href;
            return false;
            }});
        });

    $(window).bind('hashchange', function(e){
                e.preventDefault();
                var newHash = window.location.hash.substring(1);
              $('html, body').animate({scrollTop: $("#"+newHash).offset().top}, {easing: easeType,duration: easeDuration,complete: function() { 
                return false;}});
  });
$(window).trigger('hashchange'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T06:59:47.173

```
$(document).ready(function(){
var href         = '';
var easeDuration = 1000;
var easeType     = "easeOutExpo";
$(window).hashchange(function(){
//your code
});
}); 
```

# c# - 如何在局部视图中使用模型验证

> ID：12015792
> 
> 赞同：1
> 
> 时间：2012-08-18T04:17:03.687
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, partial-views

我有一个这样的控制器：

```
public FooController : Controller
{
    public ActionResult Index()
    {
        return View();
    }
} 
```

使用索引视图：

```
@{ Html.RenderPartial("~/Views/Bar/Add", new Models.Bar()); } 
```

Bar 控制器是这样的：

```
public BarController : Controller
{
    public ActionResult Add()
    {
        var bar = new Bar();
        return View(bar);
    }

    [HttpPost]
    public ActionResult Add(Bar bar)
    {
        if(ModelState.IsValid)
        {
            _repository.AddBar(bar);
            return RedirectToAction("Index", "Foo");
        }

        // This will return only the partial view (No Layout, no outer view)
        return View("Add", bar);

        // This will not show validation errors
        // return RedirectToAction("Index", "Foo");
    }
} 
```

添加视图如下所示：

```
@model Models.Bar

@using(Html.BeginForm("Add", "Bar", FormMethod.Post))
{
    Name: @Html.TextBoxFor(x => x.Name)

    <input type="submit" value="Add Bar" />

    @Html.ValidationSummary()
} 
```

我的问题是，如果我返回，`View("Add", bar)`我会得到部分视图，而没有其他内容（不是我想要的）。但是，如果我改为返回`RedirectToAction("Index", "Foo")`它是否通过验证，我当然会丢失验证摘要的任何验证错误。

有没有办法在这样的局部视图中使用验证？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T05:00:42.090

你可以：

1.  `return View("~/Views/Home/Index.cshtml")`如果验证失败。
2.  将 ModelState 保存在 TempData 上并在 Home.Index 操作上恢复它。
3.  发出 AJAX 请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T14:33:33.220

您应该使用@Ajax.Begin 而不是使用@Html.BeginForm，后者将使用ajax 提交您的请求。

@model 模型吧

```
<div id="targetId">
</div>

        @using(Ajax.BeginForm("Add", "Bar",new AjaxOptions{  HttpMethod ="POST",UpdateTargetId="targetId"}))
        {

            Name: @Html.TextBoxFor(x => x.Name)

            <input type="submit" value="Add Bar" />

            @Html.ValidationSummary()
        } 
```

它使 ajax 调用“添加”并在您的控制器中。

```
[HttpPost]
public ActionResult Add(Bar bar)
{
    if(ModelState.IsValid)
    {
        _repository.AddBar(bar);
        return RedirectToAction("Index", "Foo");
    }

    return RenderPartialViewToString("Add",bar);
}

protected string RenderPartialViewToString(string viewName, object model)
    {
        if (string.IsNullOrEmpty(viewName))
            viewName = ControllerContext.RouteData.GetRequiredString("action");

        ViewData.Model = model;

        using (StringWriter sw = new StringWriter())
        {
            ViewEngineResult viewResult = ViewEngines.Engines.FindPartialView(ControllerContext, viewName);
            ViewContext viewContext = new ViewContext(ControllerContext, viewResult.View, ViewData, TempData, sw);
            viewResult.View.Render(viewContext, sw);
            return sw.GetStringBuilder().ToString();
        }
    } 
```

然后添加“RenderPartialViewToString”方法，该方法将返回“ **HtmlRenderString** ”，您需要将 View 和模型作为参数传递给该方法。您还必须在 AjxOption 中指定“ **UpdateTargetId** ”，您的结果将在其中附加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T05:06:49.517

替换`@{ Html.RenderPartial("~/Views/Bar/Add", new Models.Bar()); }`为`@{ Html.RenderPartial("~/Views/Bar/Add"); }`，您拥有它的方式，它试图向`Bar`the发布新内容`[Post] Add`或获取视图。

另外，我通常在控制器中使用`PartialViewResult`和`return PartialView`作为部分视图。不知道它是否有所作为。

**更新**

我刚刚启动了一个项目，其中有一个部分表单，我使用它访问它`@Html.Action()`，一切似乎都可以正常工作并验证。试一试`@Html.RenderAction`。这是一篇描述差异的好帖子。[http://www.arrangeactassert.com/when-to-use-html-renderpartial-and-html-renderaction-in-asp-net-mvc-razor-views/](http://www.arrangeactassert.com/when-to-use-html-renderpartial-and-html-renderaction-in-asp-net-mvc-razor-views/)

# php - yii - 更改输入名称格式并更新

> ID：12015793
> 
> 赞同：0
> 
> 时间：2012-08-18T04:17:22.620
> 
> 标签：php, yii

嗨，我是 yii 的新手，当我申请练习（RPG 的字符生成器）时，遇到了更新表单问题的问题。我需要更新具有复合 PK 的表。到目前为止，我可以使用我的表单在两个表上创建。但我无法加载更新代码。我的代码如下：

```
public function actionUpdate($id) {
    $model = $this->loadModel($id);
    $magicDiffModel = array();
    $m = Difficulty::getDifficultyListByType(Difficulty::magicDifficulty);
    // Uncomment the following line if AJAX validation is needed
    // $this->performAjaxValidation($model);
    if(!isset($_POST['MagicDifficulty']) && $id != ''){
        foreach ($m as $diff => $v) {
            $magicDiffModel[$diff] = MagicDifficulty::model()->findAllByPk(array('magic_id' => $id,'difficulty'=>$diff));
        }
    }else{

    }
    if (isset($_POST['Magic'])) {
        $model->attributes = $_POST['Magic'];
        if ($model->save())
            $this->redirect(array('view', 'id' => $model->id));
    }

    $this->render('update', array(
        'model' => $model,
        'magicDiffModel' => $magicDiffModel,
        'm' => $m,
    ));
} 
```

* * *

```
<tr>
    <td>Zeon</td>
    <?php foreach ($m as $id => $name) { ?>
    <td><?php echo CHtml::activeTextField($magicDiffModel, '['.$id.']zeon'); ?></td>
    <?php } ?>
</tr>
<tr>
    <td>Int B.</td>
    <?php foreach ($m as $id => $name) { ?>
    <td><?php echo CHtml::activeTextField($magicDiffModel, '['.$id.']base_int'); ?></td>
    <?php } ?>
</tr>
<tr>
    <td>Mantenimiento</td>
    <?php foreach ($m as $id => $name) { ?>
    <td><?php echo CHtml::activeTextField($magicDiffModel, '['.$id.']manteinance'); ?></td>
    <?php } ?>
</tr>
<tr>
    <td>Descripción</td>
    <?php foreach ($m as $id => $name) { ?>
    <td><?php echo CHtml::activeTextField($magicDiffModel, '['.$id.']description'); ?></td>
    <?php } ?>
</tr> 
```

这是第一个堆栈项的例外

```
get_class() expects parameter 1 to be object, array given

/srv/http/animaGen/framework/web/helpers/CHtml.php(2117): get_class(array(1 => array(MagicDifficulty), 2 => array(MagicDifficulty), 3 => array(MagicDifficulty), 4 => array(MagicDifficulty)))              
return get_class($model).$sub.'['.$attribute.']'; 
```

这是否可能。注意：我理解错误，但想不出解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T11:25:56.257

`activeTextField`接受作为第一个参数`CModel`实例，您在其中传递集合（*数组*）。所以正确的代码应该是：

```
<tr>
    <td>Zeon</td>
    <?php foreach ($m as $id => $name) { ?>
    <td><?php echo CHtml::activeTextField($magicDiffModel[$id], 'zeon'); ?></td>
    <?php } ?>
</tr>
<tr>
    <td>Int B.</td>
    <?php foreach ($m as $id => $name) { ?>
    <td><?php echo CHtml::activeTextField($magicDiffModel[$id], 'base_int'); ?></td>
    <?php } ?>
</tr>
<tr>
    <td>Mantenimiento</td>
    <?php foreach ($m as $id => $name) { ?>
    <td><?php echo CHtml::activeTextField($magicDiffModel[$id], 'manteinance'); ?></td>
    <?php } ?>
</tr>
<tr>
    <td>Descripción</td>
    <?php foreach ($m as $id => $name) { ?>
    <td><?php echo CHtml::activeTextField($magicDiffModel[$id], 'description'); ?></td>
    <?php } ?>
</tr> 
```

# json - Wordpress Json API 缓存

> ID：12015796
> 
> 赞同：4
> 
> 时间：2012-08-18T04:17:55.767
> 
> 标签：json, wordpress, api, caching

通过使用 json api 插件将数据从站点提供给应用程序，我使用 Wordpress 作为 iPhone 应用程序的提要。然而它很慢，所以我试图找到一种方法来缓存请求。我还没有找到一个真正有效/解释如何做到这一点的解决方案，任何人都可以提供任何指导哦，如何/是否可以做到这一点？

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-31T17:55:05.087

我建议使用[wordpress 瞬态 API](http://codex.wordpress.org/Transients_API)。例如。

```
 $transient_name = 'some_api_req_param1';
 $transient_value = get_transient($transient_name); 
 if( false !== $transient_value){
  echo $transient_value;
 }else{
  //$result = ...
  //fetch your data here
  //in the end save the data in the transient
  $expiration_time = 60*60*24*7;//in second 
  set_transient($transient_name,$result,$expiration_time);
} 
```

# html - 嵌套 嵌套时不起作用 将要？

> ID：12015804
> 
> 赞同：49
> 
> 时间：2012-08-18T04:19:41.363
> 
> 标签：html, nested, paragraph

我通常不会这样嵌套`<p>`：

```
<p>The following:
    <p>one</p>
    <p>two</p>
</p> 
```

我会这样嵌套使用`<div>`。但是今天我使用`<p>`了，但似乎 Emacs 和 Google Chrome 都会在`<p>`看到新`<p>`的启动时立即考虑外部关闭。（这`DOCTYPE`是 HTML 4.01 Strict）。

我认为`<p>`只不过是一个，但只是带有一些预定义的边距和填充，但是不能嵌套`<div>`是真的吗？`<p>`如果是这样，什么规则说它不能？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-08-18T04:21:46.930

因为段落就是段落……这就是 HTML 的定义方式（而 HTML*不是*XML）。

任何`<p>`（或*其他*块级元素）将*隐式关闭*任何 open `<p>`。

根据[9.3.1 段落：](http://www.w3.org/TR/html401/struct/text.html#h-9.3.1) HTML 4.01 规范的 P 元素：

> P 元素代表一个段落。它*不能*包含块级元素（包括 P 本身）。

* * *

请注意，这就是*HTML 的解析方式*，甚至 a`<div>`也会隐式关闭该段落！

但是，a不会关闭 a，`<span>`因为*a 不是*块*级*元素。`display:block;`*`<p>``<span>`*

 **也就是说，在 HTML 处理的这个阶段，CSS 是*无关紧要*的，在确定元素是否为块级元素时，CSS 与 DOM/解析器*无关。*考虑动态应用 CSS 或通过尚未加载的样式表应用 CSS 的情况：应用的 CSS 不会改变 DOM。

* * *

虽然 HTML5（工作草案）规范不包括 HTML4 规范中的上述语言，但它确实继续将段落定义为[分阶段内容的](http://dev.w3.org/html5/spec/single-page.html#phrasing-content)*容器*，并且进一步有一个[关于段落](http://www.w3.org/TR/html5/content-models.html#paragraphs)的部分。

[可以嵌套在 P 元素中的 HTML5 元素列表](https://stackoverflow.com/questions/9852312/list-of-html5-elements-that-can-be-nested-inside-p-element)的公认答案？说`<p>`元素不能嵌套在 HTML5 中。文档中的关键短语是：“短语内容 [不包括`<p>`元素] 形成段落”。此外，HTML5 试图在许多方面向后兼容，其理由是[“对内容模型和属性值的限制”](http://dev.w3.org/html5/spec/introduction.html#restrictions-on-content-models-and-on-attribute-values)：

> *某些元素的解析方式有些古怪（通常是出于历史原因）*，它们的内容模型限制旨在避免将作者暴露于这些问题。

此行为引用自[HTML5 WG wiki entry on flow content](http://www.w3.org/html/wg/wiki/FlowContentInObject#For_block_content_as_children_of_object_as_children_of__p)：

> HTML5 对 p 元素的嵌套以及 p 元素可能包含的内容的限制是由于引用：“解析器的特性”*导致 p 自动关闭*..

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-18T04:22:47.817

来自[HTML 4.01 规范第 9.3.1 节](http://www.w3.org/TR/html401/struct/text.html#h-9.3.1)

> P 元素代表一个段落。它不能包含块级元素（包括 P 本身）。**

# performance - 如何在 Firefox、Linux 中使用 Watir-Webdriver 管理缓慢的 textarea 速度？

> ID：12015805
> 
> 赞同：1
> 
> 时间：2012-08-18T04:20:02.760
> 
> 标签：performance, firefox, selenium, webdriver, watir

我正在使用 Ruby 1.8.7、Watir-Webdriver 0.6.1、Arch Linux、Firefox 14

我在这个主题中阅读了很多答案和示例，但没有一个对我有用。当我想将一大段数据（只有大约 15 行文本）粘贴到 textarea 中时，速度非常慢。因为我不想输入仿真，所以我想要最大可用速度，所以我尝试设置变量“browser.speed = :zippy”，但它似乎在 Watir-Webdriver 中不起作用，只出现一条错误消息： “未定义的方法 `speed=' for #”

然后我尝试将native_events设置为false，再次出现错误消息：“undefined method `native_events' for #”所以我有点困惑。

这是我的整个代码片段

```
require 'rubygems'
require 'watir-webdriver'
require 'xmlsimple'
default_profile = Selenium::WebDriver::Firefox::Profile.from_name "default"
default_profile.native_events = false
default_profile['javascript.enabled']=false
browser = Watir::Browser.new :ff, :profile => default_profile
browser.speed = :zippy 
```

第 5 行、第 6 行和第 8 行都抛出错误消息。

最后我尝试编辑 text_field.rb ，因为它在这个答案（http://stackoverflow.com/questions/5000164/firewatir-textfield-set-very-slow）中提到，但它在一个 .gem 文件和一个tar.gz. 我解压缩但找不到相关行：

```
# encoding: utf-8
module Watir
  class TextField < Input
    include UserEditable

    attributes Watir::TextArea.typed_attributes
    remove_method :type # we want Input#type here, which was overriden by TextArea's attributes

    private

    def locator_class
      TextFieldLocator
    end

    def selector_string
      selector = @selector.dup
      selector[:type] = '(any text type)'
      selector[:tag_name] = "input or textarea"
      selector.inspect
    end
  end

  module Container
    def text_field(*args)
      TextField.new(self, extract_selector(args).merge(:tag_name => "input"))
    end

    def text_fields(*args)
      TextFieldCollection.new(self, extract_selector(args).merge(:tag_name => "input"))
    end
  end # Container

  class TextFieldCollection < InputCollection
    private

    def locator_class
      TextFieldLocator
    end

    def element_class
      TextField
    end
  end # TextFieldCollection
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T11:18:36.780

对于大字符串，我建议将文本放入系统剪贴板，然后粘贴到文本字段中。

在 OS X 上，`pbcopy`命令行实用程序可用于：

```
 IO.popen("pbcopy", "w") { |io| io << long_string }
  browser.text_field.send_keys([:command, 'v']) 
```

我敢肯定，有一些 Linux 等价物也能很好地工作（你需要`[:control, 'v']`改用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T12:18:50.277

我在尝试使用 watir-webdriver 运行 IE 时遇到了同样的问题。我设法通过编辑 \Ruby193\lib\ruby\gems\1.9.1\gems\watir-webdriver-0.6.2\lib\watir-webdriver\browser.rb 文件并在之前添加它来让它运行得更快一点def 初始化（浏览器 = :firefox，*args）：

```
# Run fast
$FAST_SPEED = ARGV.delete('-f')

 @@speed = $FAST_SPEED ? :fast : :slow
    def self.speed
      return :fast if $FAST_SPEED
      @@speed
    end
    def self.speed= x
      $FAST_SPEED = nil
      @@speed = x
    end

    def initialize_options

      self.speed = browser.speed

      @ole_object = nil
      @page_container = self
      @error_checkers = []

      @url_list = []
    end

     def speed= how_fast
      case how_fast
      when :zippy then
        @typingspeed = 0
        @pause_after_wait = 0.01
        @type_keys = false
        @speed = :fast
      when :fast then
        @typingspeed = 0
        @pause_after_wait = 0.01
        @type_keys = true
        @speed = :fast
      when :slow then
        @typingspeed = 0.08
        @pause_after_wait = 0.1
        @type_keys = true
        @speed = :slow
      else
        raise ArgumentError, "Invalid speed: #{how_fast}"
      end
    end

    def speed
      return @speed if @speed == :slow
      return @type_keys ? :fast : :zippy
    end

    # deprecated: use speed = :fast instead
    def set_fast_speed
      self.speed = :fast
    end

    # deprecated: use speed = :slow instead    
    def set_slow_speed
      self.speed = :slow
    end 
```

之后我修改了 def goto(uri) ：

```
def goto(uri)
  uri = "http://#{uri}" unless uri =~ URI.regexp

  @driver.navigate.to uri
  run_checkers
  initialize_options

  url
end 
```

它工作得更快一些，我不知道它是否是最好的解决方案，因为我刚开始使用 watir。

希望能帮助到你。

# c# - 如何对字符串进行排序，以便首先以搜索词开头的字符串？

> ID：12015812
> 
> 赞同：2
> 
> 时间：2012-08-18T04:22:16.437
> 
> 标签：c#, search, sorting

我有一个很大的字符串列表。我目前正在通过执行搜索来处理

```
.Where(x => x.Contains(search)).ToArray() 
```

这得到了我想要的所有结果，但是顺序很差。例如，搜索“ch”可能会出现：

```
Potato Starch
Chicken 
```

因为它们都包含 ch，所以我希望它们都出现，但我希望 Chicken 在数组中排在第一位，因为它以 ch 开头。

有哪些方法可以重新排序我的结果，以便以搜索字符串开头的字符串位于数组的开头？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-18T04:28:11.577

您可以按索引排序，因此字符串以搜索开头：

```
.Where(x => x.Contains(search)).OrderBy(x => x.IndexOf(search)).ToArray() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T04:32:06.863

尝试：

```
 List<string> lis=new List<string>(){"Potato Starch","Chicken","gcha","vgfchi","njjh"};
        string search = "ch";
        List<string> temp = new List<string>();

        temp = lis.Where(x => x.Contains(search)).OrderBy(x => x.IndexOf(search)).ToList(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-18T04:27:35.107

您可以添加一个简单的*OrderBy*字段，将相关结果放在顶部：

```
.Where(x => x.Contains(search))
.OrderBy(x => x.StartsWith(search) ? 0 : 1)
.ThenBy(x => x)
.ToArray() 
```

请注意，如果这是一个数据库查询（Linq to SQL/entities），您需要先枚举结果，因为引擎不知道如何将其转换为 SQL：

```
.Where(x => x.Contains(search))
.AsEnumerable()
.OrderBy(x => x.StartsWith(search) ? 0 : 1)
.ThenBy(x => x)
.ToArray() 
```

# javascript - jQuery .is(':checked') 总是返回 false

> ID：12015813
> 
> 赞同：3
> 
> 时间：2012-08-18T04:22:18.593
> 
> 标签：javascript, jquery

无论单选按钮是否被选中， .is(':checked') 都会返回 false。这是我在调试时在 Chrome 控制台中玩的一些东西：

```
> $('#blah')
[<input type=​"radio" id=​"blah" name=​"blah_type" value=​"blah" class=​"styled" checked=​"checked">​]
> $('#blah').removeAttr('checked')
[<input type=​"radio" id=​"blah" name=​"blah_type" value=​"blah" class=​"styled">​]
> $('#blah').is(':checked')
false
> $('#blah').prop('checked', true)
[<input type=​"radio" id=​"blah" name=​"blah_type" value=​"blah" class=​"styled">​]
> $('#blah').is(':checked')
false
> $('#blah').prop('checked')
true
> $('#blah').removeProp('checked')
[<input type=​"radio" id=​"blah" name=​"blah_type" value=​"blah" class=​"styled">​]
> $('#blah').attr('checked', true)
[<input type=​"radio" id=​"blah" name=​"blah_type" value=​"blah" class=​"styled" checked=​"checked">​]
> $('#blah').attr('checked')
"checked"
> $('#blah').prop('checked')
undefined
> $('#blah').is(':checked')
false 
```

这里可能出了什么问题？我正在使用 jQuery 1.6.4。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T14:17:08.010

使用`.prop('checked')`.

我也面临同样的问题。`.is()`无法捕获复选框元素的选中状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T04:52:30.100

根据 jQuery API 文档，不要使用`.removeProp()`删除`checked`或其他本机属性。我也会假设相同`.removeAttr()`。

[http://api.jquery.com/removeProp/](http://api.jquery.com/removeProp/)

# php - Recaptcha 无法在 https 上运行

> ID：12015814
> 
> 赞同：7
> 
> 时间：2012-08-18T04:22:25.527
> 
> 标签：php, codeigniter, recaptcha

我在 codeigniter 中有一个站点，并且该站点运行良好`http`。

我的客户将网站移至`https`.

然后现在当用户注册不起作用时，因为其中使用了一个recaptcha。

现在它显示`Could not open socket`错误。

这是我的控制器中的recaptcha调用：

```
$privatekey = "my-key";
        $resp = recaptcha_check_answer ($privatekey,
        $_SERVER["REMOTE_ADDR"],
        $_POST["recaptcha_challenge_field"],
        $_POST["recaptcha_response_field"]);

        if (!$resp->is_valid) {
        // What happens when the CAPTCHA was entered incorrectly
            die ("The reCAPTCHA wasn't entered correctly");
        }else{

            $data=$this->authmodel->addAccount();
            $this->session->set_flashdata('abc', 'User added successfully'); 
            echo "1";
        } 
```

这是 recaptchalib.php 代码：

```
<?php
/*
 * This is a PHP library that handles calling reCAPTCHA.
 *    - Documentation and latest version
 *          http://recaptcha.net/plugins/php/
 *    - Get a reCAPTCHA API Key
 *          https://www.google.com/recaptcha/admin/create
 *    - Discussion group
 *          http://groups.google.com/group/recaptcha
 *
 * Copyright (c) 2007 reCAPTCHA -- http://recaptcha.net
 * AUTHORS:
 *   Mike Crawford
 *   Ben Maurer
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */

/**
 * The reCAPTCHA server URL's
 */
define("RECAPTCHA_API_SERVER", "http://www.google.com/recaptcha/api");
define("RECAPTCHA_API_SECURE_SERVER", "https://www.google.com/recaptcha/api");
define("RECAPTCHA_VERIFY_SERVER", "www.google.com");

/**
 * Encodes the given data into a query string format
 * @param $data - array of string elements to be encoded
 * @return string - encoded request
 */
function _recaptcha_qsencode ($data) {
        $req = "";
        foreach ( $data as $key => $value )
                $req .= $key . '=' . urlencode( stripslashes($value) ) . '&';

        // Cut the last '&'
        $req=substr($req,0,strlen($req)-1);
        return $req;
}

/**
 * Submits an HTTP POST to a reCAPTCHA server
 * @param string $host
 * @param string $path
 * @param array $data
 * @param int port
 * @return array response
 */
function _recaptcha_http_post($host, $path, $data, $port = 80) {

        $req = _recaptcha_qsencode ($data);

        $http_request  = "POST $path HTTP/1.0\r\n";
        $http_request .= "Host: $host\r\n";
        $http_request .= "Content-Type: application/x-www-form-urlencoded;\r\n";
        $http_request .= "Content-Length: " . strlen($req) . "\r\n";
        $http_request .= "User-Agent: reCAPTCHA/PHP\r\n";
        $http_request .= "\r\n";
        $http_request .= $req;

        $response = '';
        if( false == ( $fs = @fsockopen($host, $port, $errno, $errstr, 10) ) ) {
                die ('Could not open socket');
        }

        fwrite($fs, $http_request);

        while ( !feof($fs) )
                $response .= fgets($fs, 1160); // One TCP-IP packet
        fclose($fs);
        $response = explode("\r\n\r\n", $response, 2);

        return $response;
}

/**
 * Gets the challenge HTML (javascript and non-javascript version).
 * This is called from the browser, and the resulting reCAPTCHA HTML widget
 * is embedded within the HTML form it was called from.
 * @param string $pubkey A public key for reCAPTCHA
 * @param string $error The error given by reCAPTCHA (optional, default is null)
 * @param boolean $use_ssl Should the request be made over ssl? (optional, default is false)

 * @return string - The HTML to be embedded in the user's form.
 */
function recaptcha_get_html ($pubkey, $error = null, $use_ssl = false)
{
    if ($pubkey == null || $pubkey == '') {
        die ("To use reCAPTCHA you must get an API key from <a href='https://www.google.com/recaptcha/admin/create'>https://www.google.com/recaptcha/admin/create</a>");
    }

    if ($use_ssl) {
                $server = RECAPTCHA_API_SECURE_SERVER;
        } else {
                $server = RECAPTCHA_API_SERVER;
        }

        $errorpart = "";
        if ($error) {
           $errorpart = "&amp;error=" . $error;
        }
        return '<script type="text/javascript" src="'. $server . '/challenge?k=' . $pubkey . $errorpart . '"></script>

    <noscript>
        <iframe src="'. $server . '/noscript?k=' . $pubkey . $errorpart . '" height="300" width="500" frameborder="0"></iframe><br/>
        <textarea name="recaptcha_challenge_field" rows="3" cols="40"></textarea>
        <input type="hidden" name="recaptcha_response_field" value="manual_challenge"/>
    </noscript>';
}

/**
 * A ReCaptchaResponse is returned from recaptcha_check_answer()
 */
class ReCaptchaResponse {
        var $is_valid;
        var $error;
}

/**
  * Calls an HTTP POST function to verify if the user's guess was correct
  * @param string $privkey
  * @param string $remoteip
  * @param string $challenge
  * @param string $response
  * @param array $extra_params an array of extra variables to post to the server
  * @return ReCaptchaResponse
  */
function recaptcha_check_answer ($privkey, $remoteip, $challenge, $response, $extra_params = array())
{
    if ($privkey == null || $privkey == '') {
        die ("To use reCAPTCHA you must get an API key from <a href='https://www.google.com/recaptcha/admin/create'>https://www.google.com/recaptcha/admin/create</a>");
    }

    if ($remoteip == null || $remoteip == '') {
        die ("For security reasons, you must pass the remote ip to reCAPTCHA");
    }

        //discard spam submissions
        if ($challenge == null || strlen($challenge) == 0 || $response == null || strlen($response) == 0) {
                $recaptcha_response = new ReCaptchaResponse();
                $recaptcha_response->is_valid = false;
                $recaptcha_response->error = 'incorrect-captcha-sol';
                return $recaptcha_response;
        }

        $response = _recaptcha_http_post (RECAPTCHA_VERIFY_SERVER, "/recaptcha/api/verify",
                                          array (
                                                 'privatekey' => $privkey,
                                                 'remoteip' => $remoteip,
                                                 'challenge' => $challenge,
                                                 'response' => $response
                                                 ) + $extra_params
                                          );

        $answers = explode ("\n", $response [1]);
        $recaptcha_response = new ReCaptchaResponse();

        if (trim ($answers [0]) == 'true') {
                $recaptcha_response->is_valid = true;
        }
        else {
                $recaptcha_response->is_valid = false;
                $recaptcha_response->error = $answers [1];
        }
        return $recaptcha_response;

}

/**
 * gets a URL where the user can sign up for reCAPTCHA. If your application
 * has a configuration page where you enter a key, you should provide a link
 * using this function.
 * @param string $domain The domain where the page is hosted
 * @param string $appname The name of your application
 */
function recaptcha_get_signup_url ($domain = null, $appname = null) {
    return "https://www.google.com/recaptcha/admin/create?" .  _recaptcha_qsencode (array ('domains' => $domain, 'app' => $appname));
}

function _recaptcha_aes_pad($val) {
    $block_size = 16;
    $numpad = $block_size - (strlen ($val) % $block_size);
    return str_pad($val, strlen ($val) + $numpad, chr($numpad));
}

/* Mailhide related code */

function _recaptcha_aes_encrypt($val,$ky) {
    if (! function_exists ("mcrypt_encrypt")) {
        die ("To use reCAPTCHA Mailhide, you need to have the mcrypt php module installed.");
    }
    $mode=MCRYPT_MODE_CBC;   
    $enc=MCRYPT_RIJNDAEL_128;
    $val=_recaptcha_aes_pad($val);
    return mcrypt_encrypt($enc, $ky, $val, $mode, "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0");
}

function _recaptcha_mailhide_urlbase64 ($x) {
    return strtr(base64_encode ($x), '+/', '-_');
}

/* gets the reCAPTCHA Mailhide url for a given email, public key and private key */
function recaptcha_mailhide_url($pubkey, $privkey, $email) {
    if ($pubkey == '' || $pubkey == null || $privkey == "" || $privkey == null) {
        die ("To use reCAPTCHA Mailhide, you have to sign up for a public and private key, " .
             "you can do so at <a href='http://www.google.com/recaptcha/mailhide/apikey'>http://www.google.com/recaptcha/mailhide/apikey</a>");
    }

    $ky = pack('H*', $privkey);
    $cryptmail = _recaptcha_aes_encrypt ($email, $ky);

    return "http://www.google.com/recaptcha/mailhide/d?k=" . $pubkey . "&c=" . _recaptcha_mailhide_urlbase64 ($cryptmail);
}

/**
 * gets the parts of the email to expose to the user.
 * eg, given johndoe@example,com return ["john", "example.com"].
 * the email is then displayed as john...@example.com
 */
function _recaptcha_mailhide_email_parts ($email) {
    $arr = preg_split("/@/", $email );

    if (strlen ($arr[0]) <= 4) {
        $arr[0] = substr ($arr[0], 0, 1);
    } else if (strlen ($arr[0]) <= 6) {
        $arr[0] = substr ($arr[0], 0, 3);
    } else {
        $arr[0] = substr ($arr[0], 0, 4);
    }
    return $arr;
}

/**
 * Gets html to display an email address given a public an private key.
 * to get a key, go to:
 *
 * http://www.google.com/recaptcha/mailhide/apikey
 */
function recaptcha_mailhide_html($pubkey, $privkey, $email) {
    $emailparts = _recaptcha_mailhide_email_parts ($email);
    $url = recaptcha_mailhide_url ($pubkey, $privkey, $email);

    return htmlentities($emailparts[0]) . "<a href='" . htmlentities ($url) .
        "' onclick=\"window.open('" . htmlentities ($url) . "', '', 'toolbar=0,scrollbars=0,location=0,statusbar=0,menubar=0,resizable=0,width=500,height=300'); return false;\" title=\"Reveal this e-mail address\">...</a>@" . htmlentities ($emailparts [1]);

}

?> 
```

那么我该如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-06T11:41:55.740

我得到了同样的错误并尝试了一些建议，但没有任何效果。

所以我记录了我的网络流量并进行了分析。它显示的是服务器从 ipv4 更改为 ipv6 的中间连接，我记得在某处读到 recaptcha 在 ipv6 上工作时出现问题。

所以我换`@fsockopen($host, [...]`了`@fsockopen(gethostbyname($host), [...]`，recaptcha 又开始工作了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-01-07T05:13:51.353

对于 SSL (https) 使用：

```
echo recaptcha_get_html($publickey,true); 
```

而不是：

```
echo recaptcha_get_html($publickey); 
```

这是因为 recaptchalib.php（获取扭曲的文本图像）中的 recaptcha_get_html() 默认为 http，除非您另有说明。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-07-20T18:25:15.417

像这样编辑 recaptchalib.php：

找到这一行 - function recaptcha_get_html ($pubkey, $error = null, $use_ssl = false)

将其更改为 - function recaptcha_get_html ($pubkey, $error = null, $use_ssl = true)

参数 $use_ssl 从 false 更改为 true ...其余将由脚本处理。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-04-10T18:00:03.457

您需要告诉函数“recaptcha_get_html()”您要使用 https。将 recaptcha_get_html($publickey) 替换为

```
echo recaptcha_get_html($publickey,null,1); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-31T07:31:14.290

我遇到了同样的错误，尝试了所有建议，但对我没有任何作用。

然后我确实分析了这个问题，然后我得到了 SSL 证书问题

> **此证书仅对以下名称有效：www.google.com（错误代码：ssl_error_bad_cert_domain）**

所以我改变了

```
echo recaptcha_get_html($publickey,,true);

@fsockopen($host, [...] to @fsockopen(gethostbyname($host), [...] 
```

随着

> 定义（“RECAPTCHA_API_SECURE_SERVER”，“ [https://api-secure.recaptcha.net](https://api-secure.recaptcha.net) ”）；

至

> 定义（“RECAPTCHA_API_SECURE_SERVER”，“ [https://www.google.com/recaptcha/api](https://www.google.com/recaptcha/api) ”）；

在`recaptchalib.php`和recaptcha再次工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-05T10:52:43.857

您需要在“recaptchalib.php”文件中将所有 http:// url 更改为 https://，之后这将起作用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-11-26T10:17:31.967

从脚本源 URL 中删除“http:”。

更改：

从：

```
<script type="text/javascript" src="http://www.google.com/recaptcha/api.js?render=*YourPublicKey*"></script> 
```

至：

```
<script type="text/javascript" src="//www.google.com/recaptcha/api.js?render=*YourPublicKey*"></script> 
```

# java - 如何在字符串中插入特殊字符？

> ID：12015818
> 
> 赞同：1
> 
> 时间：2012-08-18T04:22:57.007
> 
> 标签：java, regex, string

我有一个名为'string1'的字符串，

```
string1 = "Mr. Jorge Alexa Narvaez is a former Canadian cricketer and a politician."; 
```

我还有另一个名为“string2”的字符串，它**只有**`<NOUN> and </NOUN>`用空格分隔的“”标签包围的字符串。

```
string2 = "<NOUN>Jorge Alexa Narvaez</NOUN> <NOUN>Canadian</NOUN>"; 
```

请注意，第二个字符串可以有任何名词标记词（基于 'string1'，例如：如果 string1 有 3 个名词，则 string2 将有相同的 3 个名词被名词标签包围）
我想将标签添加到 'string1' 和使 string1 如下，

```
string1 = "Mr. <NOUN>Jorge Alexa Narvaez</NOUN> is a former <NOUN>Canadian</NOUN> cricketer and a politician."; 
```

**只是我只想替换 'Jorge Alexa Narvaez' 和 'Canadian'`<NOUN>Jorge Alexa Narvaez</NOUN> and <NOUN>Canadian</NOUN>`**

谁能告诉我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T04:43:54.330

可以按如下方式完成，

```
 Pattern p = Pattern.compile("<NOUN>(.*?)</NOUN>");
    Matcher m = p.matcher(string2);
    while(m.find()) {
        string1= string1.replaceAll(m.group(1),m.group(0));
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T04:37:14.163

几个问题：

1.  string2 是由您无法处理的某个库生成的吗？
2.  string2 将仅包含“<NOUN>”标签或任何其他标签吗？

如果它只包含标签，那么一种粗略的方法是

1.  在 (<NOUN>|</NOUN>) 上拆分 string2。结果是一个包含来自 string1 的名词（和空格）的数组。
2.  遍历数组，忽略空字符串并将 string1 中的非空字符串替换为嵌入“”和“”之间的名词。

执行此操作的示例代码：

```
{
    String string1 = "Mr. Jorge Alexa Narvaez is a former Canadian cricketer and a politician.";
    String string2 = "<NOUN>Jorge Alexa Narvaez</NOUN> <NOUN>Canadian</NOUN>";
    String[] list = string2.split("(<NOUN>|</NOUN>)");
    for (String str : list)
    {
        if (str.trim().isEmpty())
        {
            continue;
        }
        string1 = string1.replace(str, "<NOUN>" + str + "</NOUN>");
    }
    System.out.println(string1);
} 
```

如果您有更多关于如何生成 string2 的详细信息，那么有更好的、有组织的方法来做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T04:42:27.873

它在 c# 中...希望您将其正确转换为 java

```
string s="<NOUN>Jorge Alexa Narvaez</NOUN> <NOUN>Canadian</NOUN>";
string s1="Mr. Jorge Alexa Narvaez is a former Canadian cricketer and a politician.";

foreach(Match m in Regex.Matches(s,@"(?<=<NOUN>).*?(?=</NOUN>)"))
s1=Regex.Replace(s1,m.Value,"<NOUN>$0<NOUN>"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-18T04:53:46.177

我尝试了以下代码，它工作得很好。您可以使用 Stringbuffer 而不是 String 类对其进行优化。

```
import java.util.StringTokenizer;

public class StringManipulation {

    String temp = "<NOUN>Nitin<NOUN> <NOUN>test<NOUN>";
    String finalString ="HeI am Nitin and I want to test seomthing";

    public void doIt(){

        StringTokenizer x = new StringTokenizer(temp, " ");
        while (x.hasMoreTokens()){

            String token = x.nextToken();

            String findword = token.replaceAll("<NOUN>", "");
            String findword1 = findword.replaceAll("</NOUN>", "");

            String modifiedString = finalString.replaceFirst(findword1, "<NOUN>"+findword1+"</NOUN>");
            this.finalString = modifiedString;

    }
        System.out.println(finalString);
    }
    /**
     * @param args
     */
    public static void main(String[] args) {

        new StringManipulation().doIt();

    }

} 
```

# windows - 带有 BYOD 的企业环境中的 Windows 8 Metro 应用程序

> ID：12015825
> 
> 赞同：2
> 
> 时间：2012-08-18T04:24:39.170
> 
> 标签：windows, windows-8

好的，所以我在寻找这个问题的答案时遇到了问题。到目前为止，我已经在谷歌上花了一个小时的大部分时间，并与两位 MS 代表（一位在我刚刚参加的会议上，以及我为 MS 工作的朋友）进行了交谈，但他们似乎都不知道；我想看看你们中是否有人知道，所以这里是：

Metro 应用程序目前被推送为只能通过 Windows 应用程序商店获得，这对消费者应用程序来说非常好，因为它保证了质量。但是，在企业环境中，您可能不想向公众提供 LOB 应用程序，解决方案是在您的域上设置您自己的企业中心并运行您自己的内部应用程序商店。但是，这需要将客户端计算机加入域才能从该商店获取应用程序，这显然是 BYOD 不会发生的事情......

我在某处读到，如果您有一个特殊的“侧载产品激活密钥”，则可以侧载应用程序（此外，这个侧载应用程序密钥是什么？它与 VL 密钥是否不同的 Windows 密钥，它是否高于正常值？ Windows 激活密钥？）没有任何地方解释这是什么，并且我与之交谈过的任何 MS 代表都对此没有任何想法，因为他们似乎只了解了 Metro 开发和部署的消费者方面的情况。然而，这两个选项都涉及使用预安装的应用程序构建自定义 Windows 图像，因此真的无助于回答问题......

如何在员工的个人 BYOD 机器上安装内部 Metro 风格的应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T15:43:57.097

你要找的就[在这里](http://blogs.msdn.com/b/windowsstore/archive/2012/04/25/deploying-metro-style-apps-to-businesses.aspx)。

> 准备其他电脑
> 
> 一些商业用户可能不使用支持企业侧载的 PC。造成这种情况的常见原因是其企业使用的 Windows 版本不支持此功能，或者 IT 管理员不管理 PC。随着用于工作的个人设备的增长趋势，这种情况变得越来越普遍。
> 
> 要将 Metro 风格应用程序旁加载到 PC 上：
> 
> 为“允许安装所有受信任的应用程序”设置组策略。如果您无法使用组策略，则可以通过以下设置进行设置：HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Appx\AllowAllTrustedApps = 1
> 
> 验证应用程序是否由目标计算机上受信任的 CA 签名 使用目标计算机上的脚本激活特殊产品密钥以启用旁加载。我们将在即将发布的博文中详细介绍 IT 管理员将如何获取产品密钥。产品密钥只需在 PC 上安装和激活一次。

不幸的是，他们还没有详细说明所需的特殊密钥。

# jquery - 如何在 jQuery 中使用变量

> ID：12015828
> 
> 赞同：1
> 
> 时间：2012-08-18T04:25:33.137
> 
> 标签：jquery

例如，在这种情况下，我还没有掌握如何使用变量的概念。

尝试两次，但没有任何效果

第一的

```
var aWidth = { width: "610px" }, 1000

$('#Top1, #Bot1').show().animate(aWidth()) 
```

第二

```
var aWidth = animate({ width: "610px" }, 1000 )

$('#Top1, #Bot1').show().aWidth; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T04:36:05.750

一种方法是为动画属性设置一个变量，为速度设置另一个变量：

```
var props = { width: "610px" };
var speed = 1000;
$('#Top1, #Bot1').show().animate(props, speed); 
```

如果您真的想要所有动画参数的单个变量，您可以使用 Javascript[应用](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)程序（只需调用一个函数，其参数由您传递的数组定义，在本例中为*animationParams*）：

```
var animationParams = [ { width: "610px" }, 1000 ];
$('#Top1, #Bot1').show().animate.apply(animationParams); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T04:38:16.037

这是我能做的最好的正确重写它：

**第一的：**

```
var animation = {
  properties: {width: 610},
  speed: 1000
};

$('#Top1, #Bot1').show().animate(animation.properties, animation.speed); 
```

**第二**

```
$.fn.animate_width = function() {
  return this.animate({ width: "610px" }, 1000);
};

$('#Top1, #Bot1').show().animate_width(); 
```

我会先学习普通的 JavaScript，然后再学习 jQuery。如果没有基本的 JavaScript 概念，你很快就会被 jQuery 的语法弄糊涂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T04:31:46.753

试试这样

```
var aWidth=610;
var aSpeed=1000;

$('#Top1, #Bot1').animate({width:aWidth+"px"},aSpeed); 
```

# javascript - jQuery/JS 模拟 Facebook 的标题在不在页面上时在新消息上闪烁

> ID：12015832
> 
> 赞同：-1
> 
> 时间：2012-08-18T04:26:11.980
> 
> 标签：javascript, jquery, facebook, messaging, title

我看过其他关于如何像 Facebook 那样模仿标题闪烁的帖子，但这很容易我可以做到（你知道，当它在正常页面标题和“来自 Bob 的新消息”之间交替出现在顶部时），但是我想知道如何使它以与仅在您不查看当前页面时显示的方式相同的方式工作。所以基本上我只想在你不查看页面时调用我的即时消息功能时调用这个标题闪烁功能，然后在你回到页面时停止交替，将页面标题设置回默认值。任何人都知道如何进行这种设置？提前感谢任何可以提供帮助的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T05:08:40.860

让我们调用等待事件（比如接收新消息）的函数，并根据该事件动态更改页面的标题`foo`。`foo`只有当用户离开页面时，您才必须附加到事件，对吗？所以使用类似的东西：

```
$(window).blur(function() {
   foo();
}); 
```

`unbind`当窗口被标记为：

```
$(window).focus(function() {
   boo();  // to unbind the event
}); 
```

# iphone - 线程中的 CADisplayLink

> ID：12015833
> 
> 赞同：4
> 
> 时间：2012-08-18T04:26:15.077
> 
> 标签：iphone, objective-c, multithreading

我正在制作游戏，我想在不同的线程上运行游戏逻辑代码和渲染代码，以期提高性能。但是对于我的生活，我无法弄清楚如何`CADisplayLink`在生成的线程中运行 a 。现在我正在使用`NSThread`多线程。我读过关于`NSOperationQue`，但我并不是很了解它。有人能指出我正确的方向吗？这是我现在正在使用的代码，`-logicLoop`并且`-animationLoop`都在单独的线程上运行，所以我认为它们会获得单独的运行循环，并且 CADisplayLinks 将在不同的线程上。

```
-(void)logicLoop {
    NSLog(@"adding");
    logicTimer = [CADisplayLink displayLinkWithTarget:self selector:@selector(updateModel)];
    logicTimer.frameInterval = kFrameInterval;
    [logicTimer addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
}

-(void)animationLoop {
    NSLog(@"animation");
    animationTimer = [CADisplayLink displayLinkWithTarget:self selector:@selector(renderScene)];
    animationTimer.frameInterval = kFrameInterval;
    [animationTimer addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
} 
```

有任何想法吗？

我应该`NSOperationQue`为此使用吗？如果是这样，我会怎么做？我真正需要的是一种在单独的线程上运行游戏循环和动画循环的有效方法，这样它们就不会相互减慢，并且游戏会显得更加流畅。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-18T05:54:41.270

为了让你的显示链接运行，你需要一个运行循环来运行。`NSThread`所做的只是产生一个线程，调用您的选择器并在您的选择器完成后退出。下面是这个选择器应该做的事情：

```
- (void)threadSelector
{
    // initialize CADisplayLink
    logicTimer = [CADisplayLink displayLinkWithTarget:self selector:@selector(updateModel)];
    logicTimer.frameInterval = kFrameInterval;
    [logicTimer addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
    // run the loop - this never returns
    [[NSRunLoop currentRunLoop] run];
} 
```

# sql-server-2008-r2 - 使用 SQL Server 2008 R2 中的 SQL Server 2005 数据生成架构时出错

> ID：12015834
> 
> 赞同：1
> 
> 时间：2012-08-18T04:26:18.100
> 
> 标签：sql-server-2008-r2

当我尝试为 SQL Server 2005 版生成架构和数据时，在我的 SQL 2008 R2 中保存或发布脚本向导出现以下错误。

错误信息：

Microsoft.SqlServer.Management.Smo.SmoException：对象 ExamAttempt 中的列 RemainingTime 包含类型 Time，在目标服务器版本 SQL Server 2005 中不受支持。在 Microsoft.SqlServer.Management.SqlScriptPublish.GeneratePublishPage.worker_DoWork(Object sender, DoWorkEventArgs e) 在 System.ComponentModel.BackgroundWorker.OnDoWork(DoWorkEventArgs e) 在 System.ComponentModel.BackgroundWorker.WorkerThreadStart(Object argument)

SQL 2005 中的 Time 类型是否有任何替代方法？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T18:19:35.453

我只会使用日期时间来存储每个单元。这样做可确保您将来能够使用所有本机日期时间函数来搜索或操作此数据。如果您选择升级 2005 db，将来您还可以轻松转换为离散数据类型。

在下面的示例中，了解如何使用检查约束来提供某些数据类型的完整性。

```
declare @time time = '10:30',
        @date date = '01/01/2001';

select  [theTime] = cast(@time as datetime),
        [theDate] = cast(@date as datetime),
        [theDateTime] = cast(@time as datetime) + cast(@date as datetime);

declare @t table (theDate datetime check(dateAdd(dd,datediff(dd,0,theDate),0) = theDate), theTime datetime check(datediff(dd,0,theTime) = 0))

-- succeeds, since you didnt supply date in the time only column
insert into @t  
    values(cast('01/01/2001' as datetime), cast('10:30' as datetime));

-- fails, since you passed date with the expected time only value
insert into @t
    values(cast('01/01/2001' as datetime), cast('01/01/2001 10:30' as datetime));

-- fails, since you passed time with expected date only value
insert into @t
    values(cast('01/01/2001 10:30' as datetime), cast('10:30' as datetime)); 
```

# java - 有没有更简单的方法来编写这个 Java GUI 窗口代码？

> ID：12015835
> 
> 赞同：1
> 
> 时间：2012-08-18T04:26:36.553
> 
> 标签：java, swing, io

我正在研究仅显示全屏颜色并循环显示其他颜色的代码。有一条线我一直盯着

```
getRootPane().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW).put(KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0, false), "ESCAPE"); 
```

这允许您按“Esc”并退出它（我认为 getRootPane() 与 JButton 相关联？）。但是有没有更有效的方法来编码呢？可以拆分成多行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T04:32:10.263

你的意思是这样的：

```
InputMap inputMap = getRootPane().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);
KeyStroke escapeStroke = KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0, false);
inputMap.put(escapeStroke, "Escape"); 
```

虽然这看起来更具可读性，但我认为这不会为当前实现增加任何效率。

# c# - 如何确定两次鼠标点击之间的树视图

> ID：12015838
> 
> 赞同：0
> 
> 时间：2012-08-18T04:27:34.317
> 
> 标签：c#, events, treeview

我有两个树视图和一个带有添加节点功能的 contexmenucontainer cmnuAddNode 是我的 contexmenuestrip 的添加选项卡我是一个处理事件的新手

如果单击，我想将节点添加到树视图 1，如果单击，则将节点添加到树视图 2 我只想知道我应该在 if 条件中写什么，我的代码如下：

```
 private void cmnuAddNode_Click(object sender, EventArgs e)
    {

        NewNode n = new NewNode();
        n.ShowDialog();
        TreeNode nod = new TreeNode();
        nod.Name = n.NewNodeName.ToString();
        nod.Text = n.NewNodeText.ToString();

        n.Close();
      if (treeView1.SelectedNode!=null)
        {
            treeView1.SelectedNode.Nodes.Add(nod);
            treeView1.SelectedNode.ExpandAll();
        }
        if (treeView2.SelectedNode!= null)
        {
            treeView2.SelectedNode.Nodes.Add(nod);
            treeView2.SelectedNode.ExpandAll();
        }
          } 
```

当我单击 treeview2 时，此代码有异常

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T05:24:27.987

```
private void cmnuAddNode_Click(object sender, EventArgs e,TreeViewEventArgs e1)
{

    NewNode n = new NewNode();
    n.ShowDialog();
    TreeNode nod = new TreeNode();
    nod.Name = n.NewNodeName.ToString();
    nod.Text = n.NewNodeText.ToString();

    n.Close();
    if(e1.Node.TreeView == treeView1)
   {
    treeView1.SelectedNode.Nodes.Add(nod);
    treeView1.SelectedNode.ExpandAll();
    }
     if(e1.Node.TreeView == treeView2)
   {
    treeView2.SelectedNode.Nodes.Add(nod);
    treeView2.SelectedNode.ExpandAll();
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T09:16:02.890

简单我得到了我的树视图的索引，当它进入treeview1时，在它的鼠标点击事件中我将它设置为1，当进入2时我将它设置为2，所以在我的函数中我写了条件，这很简单，快速和容易

```
private void cmnuAddNode_Click(object sender, EventArgs e)
    {

        NewNode n = new NewNode();
        n.ShowDialog();
        TreeNode nod = new TreeNode();
        nod.Name = n.NewNodeName.ToString();
        nod.Text = n.NewNodeText.ToString();

        n.Close();

        if (treeviewindex== 1)
        {
            treeView1.SelectedNode.Nodes.Add(nod);
            treeView1.SelectedNode.ExpandAll();

        }
        if (treeviewindex==2)
        {
            treeView2.SelectedNode.Nodes.Add(nod);
            treeView2.SelectedNode.ExpandAll();
        }
        if (treeviewindex == 3)
        {
            treeView3.SelectedNode.Nodes.Add(nod);
            treeView3.SelectedNode.ExpandAll();
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T04:38:17.343

首先为每个 TreeView 添加鼠标单击事件，其次使用 MouseEventArgs 选择正确的节点。对于treeview1（对treeview2做同样的事情）

```
 void treeView1MouseUp(object sender, MouseEventArgs e)
    {
        if(e.Button == MouseButtons.Right)
        {
            // Select the clicked node
            treeView1.SelectedNode = treeView1.GetNodeAt(e.X, e.Y);

            if(treeView1.SelectedNode != null)
            {
             cmnuAddNode.Show(treeView1, e.Location);
            }
        }
    }

//it will work for the two treeview getting Parent control of cmnuAddNode
private void cmnuAddNode_Click(object sender, EventArgs e,TreeViewEventArgs e1)
    {
        TreeView yourtreeView = (TreeView)cmnuAddNode.Parent;
        NewNode n = new NewNode();
        n.ShowDialog();
        TreeNode nod = new TreeNode();
        nod.Name = n.NewNodeName.ToString();
        nod.Text = n.NewNodeText.ToString();

        n.Close();

        yourtreeView.SelectedNode.Nodes.Add(nod);
        yourtreeView.SelectedNode.ExpandAll();

    } 
```

# c# - c# 注册表的附加参数

> ID：12015841
> 
> 赞同：0
> 
> 时间：2012-08-18T04:28:04.650
> 
> 标签：c#

这是我当前的代码：

```
RegistryKey registryKey = Registry.CurrentUser.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);
                registryKey.SetValue("Programname", Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData)); 
```

这没有错误或任何东西，但它并不指向我的程序。相反 Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) 指向我的 AppData 文件夹（如预期的那样）。但是，我该如何将其指向该文件夹中的可执行文件？

我正在使用 C# 2.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T04:56:54.913

你需要使用

```
System.Diagnostics.Process.GetCurrentProcess().MainModule.FileName 
```

或者

```
System.Reflection.Assembly.GetExecutingAssembly().GetName().CodeBase 
```

获得路径..

所以它会是：

```
RegistryKey registryKey = Registry.CurrentUser.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);
                registryKey.SetValue("Programname", System.Diagnostics.Process.GetCurrentProcess().MainModule.FileName); 
```

# html - 我如何使图像完全适合 div？

> ID：12015843
> 
> 赞同：0
> 
> 时间：2012-08-18T04:28:24.927
> 
> 标签：html, css

[http://cssdesk.com/PgtbW](http://cssdesk.com/PgtbW)

我想尽可能多地使用 HTML 和 CSS，尽可能少地使用 JavaScript。中的图像`spotlight`应该完全适合正方形，从左到右显示所有像素。基本上，我希望它根据屏幕大小调整大小。

我浏览了整个网络，但似乎没有任何效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T04:37:52.513

尝试添加`background-size:cover`到这个例子中的聚光灯类：http: [//cssdesk.com/4vQvQ](http://cssdesk.com/4vQvQ)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T04:40:32.523

您可以通过 JavaScript 根据图像的大小将您的大小调整为六倍。

例如

```
document.getElementById("Your Div Id").width="Width of the image in px";
document.getElementById("Your Div Id").Height="Height of the image in px"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T04:54:42.320

使用在 div 中插入图像

并应用以下CSS

```
div img
{
width:100%;
height:100%;
} 
```

请记住，它不会将图像作为 div 的背景...

# apache-flex - 更新 Spark 组件时是否需要覆盖 commitProperties？

> ID：12015844
> 
> 赞同：2
> 
> 时间：2012-08-18T04:28:38.120
> 
> 标签：apache-flex, adobe, flex-spark

我了解在创建自定义组件时，通常最好的做法是通过使用 setter/getter、设置“脏”标志、调用 invalidateProperties()，然后让 commitProperties() 处理实际更改来推迟对其进行任何属性更改。

但是在属性只影响 Spark 组件的情况下，这不是多余的吗，因为 Spark 组件已经推迟了它们的属性更改？

例如，假设我有一个包含 Spark Button 的自定义 UIComponent，并且我想为其公开一个 buttonLabel 属性来更改按钮的标签：

```
private var _buttonLabel:String;
private var myBtn:Button;
private var _buttonLabelChanged:Boolean = false;
function set buttonLabel(lbl:String){
   _buttonLabel = lbl;
   _buttonLabelChanged = true;
   invalidateProperties();
} 
```

因此，设置 buttonLabel 属性最终将触发：

```
override protected function commitProperties(){
    if(_buttonLabelChanged){
          myBtn.label = _buttonLabel;
         _buttonLabelChanged = false;
    }
} 
```

但是 Spark Button 类中“标签”的设置器已经使用了一个失效过程，这使得上面的代码毫无意义，是吗？还是我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T14:06:31.670

> 但是在属性只影响 Spark 组件的情况下，这不是多余的吗，因为 Spark 组件已经推迟了它们的属性更改？

我不相信这是一个真实的陈述。Spark 组件延迟其属性更改的方式与 MX 组件没有任何不同。

> 但是 Spark Button 类中“标签”的设置器已经使用了一个失效过程，这使得上面的代码毫无意义，是吗？还是我错过了什么？

是的，您错过了每个火花组件都有自己的失效周期这一事实。这与一个 MX 组件包含另一个组件的 MX 组件没有什么不同。

我不清楚，但您似乎正在查看两个相同的东西（MX 无效和 Spark 无效）并说它们是不同的。

# php - 为巨大的 if elseif 块寻找更优雅的解决方案

> ID：12015855
> 
> 赞同：0
> 
> 时间：2012-08-18T04:32:34.493
> 
> 标签：php, if-statement

以下 php 根据范围检查问题编号，并根据匹配条件分配一章文本。我不禁想到有更好、更快的方法来实现这一点。

```
$qnum = $questionArray[$key][questionNum];

if ($qnum <= 10){
    $chapterText = str_replace("full", "chapter1", $refTextBook);
}
elseif ($qnum > 10 && $qnum <= 20) {
    $chapterText = str_replace("full", "chapter2", $refTextBook);
}
elseif ($qnum > 20 && $qnum <= 30) {
    $chapterText = str_replace("full", "chapter3", $refTextBook);
}
elseif ($qnum > 30 && $qnum <= 40) {
    $chapterText = str_replace("full", "chapter4", $refTextBook);
}
elseif ($qnum > 40 && $qnum <= 50) {
    $chapterText = str_replace("full", "chapter5", $refTextBook);
}
elseif ($qnum > 50 && $qnum <= 60) {
    $chapterText = str_replace("full", "chapter6", $refTextBook);
}
elseif ($qnum > 60 && $qnum <= 70) {
    $chapterText = str_replace("full", "chapter7", $refTextBook);
}
elseif ($qnum > 70 && $qnum <= 80) {
    $chapterText = str_replace("full", "chapter8", $refTextBook);
}
elseif ($qnum > 80 && $qnum <= 90) {
    $chapterText = str_replace("full", "chapter9", $refTextBook);
}
elseif ($qnum > 90 && $qnum <= 100) {
    $chapterText = str_replace("full", "chapter10", $refTextBook);
}
elseif ($qnum > 100 && $qnum <= 110) {
    $chapterText = str_replace("full", "chapter11", $refTextBook);
}
elseif ($qnum > 110 && $qnum <= 120) {
    $chapterText = str_replace("full", "chapter12", $refTextBook);
}
elseif ($qnum > 120 && $qnum <= 130) {
    $chapterText = str_replace("full", "chapter13", $refTextBook);
}
elseif ($qnum > 130 && $qnum <= 140) {
    $chapterText = str_replace("full", "chapter14", $refTextBook);
}
elseif ($qnum > 140 && $qnum <= 150) {
    $chapterText = str_replace("full", "chapter15", $refTextBook);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-18T04:38:02.867

```
function getChapterName($qnum) {
    return "chapter".ceil($qnum / 10);
}; 
```

# php - 在 OS X 上的 php 上安装 apc

> ID：12015858
> 
> 赞同：2
> 
> 时间：2012-08-18T04:32:52.277
> 
> 标签：php, macos, apc, pecl

我最近刚刚将我的 PHP 版本升级到 5.4.6，在我安装 APC 并且工作正常之前。但现在 APC 已不复存在。我已将 php.ini 添加`extension="apc.so"`到 php.ini 文件并重新启动 Web 服务器，但我仍然看不到它。做 pecl install apc 给了我：

```
pecl install apc
pecl/apc is already installed and is the same as the  released version 3.1.9 
```

说已经安装好了。任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T20:27:58.687

您是如何将 PHP 升级到 5.4.6 的？你试过[http://php-osx.liip.ch/](http://php-osx.liip.ch/)吗？配备最新的 APC

或者试试

```
pecl install --force apc 
```

# html - Position Absolute 无论以何种屏幕分辨率查看，如何使其居中？

> ID：12015862
> 
> 赞同：0
> 
> 时间：2012-08-18T04:33:56.670
> 
> 标签：html, css, positioning

我在这里遇到了问题，我在一个`<div>`存在中有很多我的元素`position:absolute`。这一切似乎都很好，直到我改变了它的分辨率，我意识到元素没有定位在中心。

这是其中一个元素的示例代码。

```
p img {
    position: absolute;
}
#contentback p img {
    top: 300px;
    left: 250px;
    z-index: 2;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T04:36:27.190

利用

```
 margin:auto; 
```

如果你还想调整，

```
margin-left:x%;
margin-right:x%; 
```

你可以改变`x`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T05:16:04.667

我所知道的将绝对定位的元素居中的最佳技术：

```
.element {
width:500px;
position:absolute;
left:50%;
margin-left:-250px;
} 
```

此方法要求对象具有固定宽度。但它对我来说效果很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T04:39:11.070

指定`width: xxpx`并使用`margin:auto;`

**更新**

删除`left: xxpx`以使其`center`对齐。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-18T05:01:36.203

首先，定位是不可能的`absolute`。这样的定位只是让元素脱离了body的正常流动，并不能自动居中。为此，您必须使用`relative`定位。元素必须有一个固定的宽度，否则浏览器永远不会知道应该留下多少边距作为边距。然后，申请`margin: auto`。表定位也可以实现这一点，但它非常复杂。请注意，您不能通过这种方法将元素定位在垂直方向的中心！

# android - Android 编辑框焦点

> ID：12015865
> 
> 赞同：0
> 
> 时间：2012-08-18T04:34:27.253
> 
> 标签：android, focus, editbox

NewBie Androider 在这里。

我正在编写一个代码，其中用户在一个编辑框中只输入一个字母，然后焦点移动到另一个。如果不是字母，则光标将保留在编辑框 1 如果用户删除字符，则光标将保留在同一编辑框。

此外，如果用户单击其中包含某些字符的编辑框，则单击时应将其删除。

下面是我的尝试

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
          setContentView(R.layout.activity_play);
          final EditText et1 = (EditText)findViewById(R.id.box1);
          final  EditText et2 = (EditText)findViewById(R.id.box2);

        et1.addTextChangedListener(new TextWatcher()
        {
            public void afterTextChanged(Editable s){
            }
            public void beforeTextChanged(CharSequence s,
            int start, int count, int after){

            }
            public void onTextChanged(CharSequence s,
            int start, int before, int count)
            {
                if(isAlphabet(et1.getText().toString())){
                    et2.requestFocus();
                }else{
                    et1.setText("");
                    et1.requestFocus();
                }
            }
        });
    } 
```

另外我有四个编辑框，我想专注于下一个空框......实现这个逻辑的任何建议。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T04:56:57.633

首先，因为您希望您的用户只输入字符而不是数字，然后给`android:inputtype="text"`，以便 edittext 只能接受文本而不是数字，然后给`android:maxLength="1"`，以便只能输入一个字符。

当单击编辑文本以删除/刷新编辑文本中的内容时，您必须实现编辑文本的`onCLick()`方法并执行：`edittext.setText("")`。您还应该通过 .requestFocus() 关注您希望焦点所在的编辑文本

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T05:17:22.303

在 layout.XML 中的每个edittext中，只需使用

> 安卓：输入类型=“文本”

```
android:digits="abcdefghijklmnopqrstuvwxyz." 
```

# java - 新页面显示在先前记录中输入的值

> ID：12015867
> 
> 赞同：0
> 
> 时间：2012-08-18T04:34:56.753
> 
> 标签：java, jsp

我有一个包含用户详细信息的页面。一旦我为一个用户保存它们并尝试创建另一个用户，新页面的两个字段显示为前一个用户输入的值，我可以编辑它们。我想要的是，当我选择新页面时，它应该带有空白字段或我提到的一些默认值。此问题发生在同一会话中。当我尝试对不同的会话做同样的事情时，它工作正常。我的观察是，那些先前输入的值来自表单对象（前端）。我该如何解决这个问题？jsp/handler 的变化可能在哪里？

# php - 如何按百分比运行代码

> ID：12015879
> 
> 赞同：2
> 
> 时间：2012-08-18T04:36:43.580
> 
> 标签：php

在我的脚本中，我想在一定百分比的时间内运行某些代码，我查看了 StackOverflow 并找到了下面的代码。它运行代码 33% 的时间，我需要修改什么才能让它运行 55% 和 70% 的时间？

```
$max = 27;

for($i = 1; $i < $max; $i++){
if($i % 3 == 0){
        call_function_here();
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-18T06:04:39.790

最简单的方法是使用随机数生成器并测试其结果是否小于（或大于，无关紧要）您的目标数量。

```
function percentChance($chance){
  // Notice we go from 0-99 - therefore a 100% $chance is always larger
  $randPercent = mt_rand(0,99);
  return $chance > $randPercent;
}

...

if(percentChance(30)){
  // 30% of page loads will enter this block
}

if(percentChance(100)){
  // All page loads will enter this block
}

if(percentChance(0)){
  // No chance this block will ever be entered
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-18T05:10:34.917

由于选择的数量必须是恒定的，您可以这样做：

```
$max = 27;
$num_selections = round(27 * (55 / 100));
$keys = array_rand($max, $num_selections);
for ($keys as $key) {
    // Do something with the chosen key
} 
```

# arrays - 如果列值相等，哈希键作为数组获取最小和最大数字

> ID：12015881
> 
> 赞同：0
> 
> 时间：2012-08-18T04:36:55.150
> 
> 标签：arrays, perl, hash, max, minimum-size

我有下一个数据：

```
miRNA17 70      105     dvex699824      12      233
miRNA17 21      60      dvex699824      42      20
miRNA17 55      89      dvex699824      6       40
miRNA18 58      85      dvex701176      119     92
miRNA17 66      105     dvex703815      35      75
miRNA17 31      71      dvex703815      43      83
miRNA17 39      79      dvex703815      43      83
miRNA2  28      56      dvex731981      313     286
miRNA17 10      70      dvex735428      142     203
miRNA17 29      91      dvex735428      213     152
miRNA17 66      105     dvex735668      163     125 
```

问题是：如果我有这6列，我需要按照这个规则进行分组和打印：

相同的 miRNA## \t 不管 \t 不管 \t 相同的 dvex#### \t 取较低的 \t 取最高的

例如，这是可能的输出：

```
miRNA17 21     105   dvex699824   6    233
miRNA18 58     85    dvex701176   119  92
miRNA17 31     105   dvex703815   35   83
miRNA2  28     56    dvex731981   313  286
miRNA17 10     105   dvex735428   142  203 
```

通过哈希键作为数组解决此问题的可能方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T08:28:08.243

顺序处理文件效率更高，而无需先将所有内容加载到大数组中，只要有可能。以下是这样的解决方案的样子：

```
my @output_line = split / /, <IN_FILE>;
while (<IN_FILE>)
{
    my @current_line = split / /, $_;

    if ($current_line[0] ne $output_line[0])
    {
         printf OUT_FILE "%-8s  %5d  %5d  %-10s  %3d %3d\n", @output_line;
         @output_line = @current_line;
    }
    else
    {
         $output_line[1] = $current_line[1] if ($current_line[1] < $output_line[1]);
         $output_line[2] = $current_line[2] if ($current_line[2] > $output_line[2]);
         $output_line[4] = $current_line[4] if ($current_line[4] < $output_line[4]);
         $output_line[5] = $current_line[5] if ($current_line[5] > $output_line[5]);
    }
}

printf OUT_FILE "%-8s  %5d  %5d  %-10s  %3d %3d\n", @output_line; 
```

警告：您的问题表明输出行应该具有“相同的 dvex####”。但是，您的示例输出没有显示这一点。因此我忽略了这个要求。但是，您只需在`if`语句中添加另一个条件即可轻松引入该要求。

第二个警告：这种方法还需要将被分组为彼此相邻的行，就像它们在您的示例数据中一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T16:48:18.463

这是一个简单的脚本，它将产生您想要的输出，尽管它比您的要求状态更多，因为它还检查第 2 列和第 3 列的最小/最大值。

我正在使用[List::Util](http://search.cpan.org/perldoc?List%3a%3aUtil)来获取最小/最大值，这纯粹是为了方便。该模块是自 v5.7.3 以来的核心，因此它不应该出现问题。使用[Text::CSV](http://search.cpan.org/perldoc?Text%3a%3aCSV)是谨慎的做法，但可能不是必需的，具体取决于您的数据。假设您的列中没有非制表符空格，则可以使用 using `split`，这将删除模块依赖性。

```
use strict;
use warnings;
use Text::CSV;
use List::Util qw(min max);

my $csv = Text::CSV->new({
    sep_char => "\t",   
    eol => $/,      # required for $csv->print
    binary  => 1,});

my %data;
my @order;

# *DATA and *STDOUT represent file handles, and can be replaced with
# any other file handle as you require. DATA is used here for simplicity.
#
while (my $row = $csv->getline(*DATA)) {
    my ($mir, $dv) = @{$row}[0,3];

    my $field = "$mir/$dv";
    unless (defined $data{$field}) { # new fields are stored as-is
        push @order, $field;         # preserving original order of input
        $data{$field} = $row;
        next;
    }
    $data{$field}[1] = min($data{$field}[1], $row->[1]);
    $data{$field}[2] = max($data{$field}[2], $row->[2]);
    $data{$field}[4] = min($data{$field}[4], $row->[4]);
    $data{$field}[5] = max($data{$field}[5], $row->[5]);
}

for my $field (@order) {
    $csv->print(*STDOUT, $data{$field});
}

__DATA__
miRNA17 70  105 dvex699824  12  233
miRNA17 21  60  dvex699824  42  20
miRNA17 55  89  dvex699824  6   40
miRNA18 58  85  dvex701176  119 92
miRNA17 66  105 dvex703815  35  75
miRNA17 31  71  dvex703815  43  83
miRNA17 39  79  dvex703815  43  83
miRNA2  28  56  dvex731981  313 286
miRNA17 10  70  dvex735428  142 203
miRNA17 29  91  dvex735428  213 152
miRNA17 66  105 dvex735668  163 125 
```

**输出：**

```
miRNA17 21      105     dvex699824      6       233
miRNA18 58      85      dvex701176      119     92
miRNA17 31      105     dvex703815      35      83
miRNA2  28      56      dvex731981      313     286
miRNA17 10      91      dvex735428      142     203
miRNA17 66      105     dvex735668      163     125 
```

**请注意**，输出与您的不匹配，因为您未能区分样本输入最后一行的 dvex 数字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-18T05:23:17.073

Perl 脚本：

```
use strict;

# Not shown... Parse the data file, stuff into an array of arrays.

my @data = (
    [ 'miRNA17', 70, 105, 'dvex699824',  12, 233 ],
    [ 'miRNA17', 21,  60, 'dvex699824',  42,  20 ],
    [ 'miRNA17', 55,  89, 'dvex699824',   6,  40 ],
    [ 'miRNA18', 58,  85, 'dvex701176', 119,  92 ],
    [ 'miRNA17', 66, 105, 'dvex703815',  35,  75 ],
    [ 'miRNA17', 31,  71, 'dvex703815',  43,  83 ],
    [ 'miRNA17', 39,  79, 'dvex703815',  43,  83 ],
    [ 'miRNA2',  28,  56, 'dvex731981', 313, 286 ],
    [ 'miRNA17', 10,  70, 'dvex735428', 142, 203 ],
    [ 'miRNA17', 29,  91, 'dvex735428', 213, 152 ],
    [ 'miRNA17', 66, 105, 'dvex735668', 163, 125 ]
);

my %results;

foreach my $record (@data) {
    my ($mirna, $col2, $col3, $dvex, $col5, $col6) = @$record;
    $results{$mirna}{$dvex}{col2} = $col2; # don't care.
    $results{$mirna}{$dvex}{col3} = $col3; # don't care.
    $results{$mirna}{$dvex}{col5} = $col5
        if not $results{$mirna}{$dvex}{col5} or $results{$mirna}{$dvex}{col5} > $col5;
    $results{$mirna}{$dvex}{col6} = $col6
        if not $results{$mirna}{$dvex}{col6} or $results{$mirna}{$dvex}{col6} < $col6;      
}

foreach my $mirna (keys %results) {
    foreach my $dvex (sort keys %{$results{$mirna}}) {
        printf "%-8s  %5d  %5d  %-10s  %3d %3d\n",
            $mirna, $results{$mirna}{$dvex}{col2}, $results{$mirna}{$dvex}{col3},
            $dvex, $results{$mirna}{$dvex}{col5}, $results{$mirna}{$dvex}{col6};
    }
}

1; 
```

输出：

```
miRNA2       28     56  dvex731981  313 286
miRNA17      55     89  dvex699824    6 233
miRNA17      39     79  dvex703815   35  83
miRNA17      29     91  dvex735428  142 203
miRNA17      66    105  dvex735668  163 125
miRNA18      58     85  dvex701176  119  92 
```

# asp.net - 溢出异常错误

> ID：12015883
> 
> 赞同：1
> 
> 时间：2012-08-18T04:37:42.840
> 
> 标签：asp.net, vb.net

这是在一个 asp.net 应用程序中

我有这个例外 `System.OverflowException: Arithmetic operation resulted in an overflow`。但奇怪的是，当调用函数并返回结果时，此错误似乎浮出水面，但如果我直接编写函数代码而不是通过函数，只需将其写在代码下方，它不会产生此错误，请帮助这里是编码

```
Dim MyItem As New Item    
If MyItem.GetQtyInBin(bran_code.Text, itcode.Text, binloc.Text) <= 0 Then

    ...............

    Exit Sub 
```

* * *

这是方法的代码

```
'this method gets the qty of a certain item in a certainn location and returns it
 Public Function GetQtyInBin(ByVal Branch As String, ByVal Item As Integer, ByVal Bin As String) As Integer

    cn = New OleDb.OleDbConnection("provider=msdaora; Data Source=llmw; User Id=xxxx;Password=xxxx")
    cmd = New OleDb.OleDbCommand("select Qty from Binprmast where Bin_No='" & Bin & "' and item_Code='" & Item & "' and Bran_Code='" & Branch & "'", cn)
    cn.Open()
    Dim qty As Double
    qty = cmd.ExecuteScalar
    Return qty

End Function 
```

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T04:59:51.547

在您的问题中，`GetQtyInBin`定义为返回 an`Integer`但返回值`qty`定义为 a `Double`。

Double 大于 Integer，因此溢出。

像这样正确

```
Public Function GetQtyInBin(ByVal Branch As String, ByVal Item As Integer, ByVal Bin As String) As Double
        cn = New OleDb.OleDbConnection("provider=msdaora; Data Source=llmw; User Id=boss;Password=boss")
        cmd = New OleDb.OleDbCommand("select Qty from Binprmast where Bin_No='" & Bin & "' and item_Code='" & Item & "' and Bran_Code='" & Branch & "'", cn)
        cn.Open()
        Dim qty As Double
        qty = cmd.ExecuteScalar
        Return qty
    End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T05:02:56.590

您的函数返回一个整数，但您将返回值设置为 Double。您需要更改其中一个以匹配。

注意：如果您[切换 Option Strict On](http://msdn.microsoft.com/en-us/library/zcd4xwzs%28v=vs.80%29.aspx)这将不会按原样编译，因此会提醒您注意此错误。

# lisp - 将列表传播到父性

> ID：12015885
> 
> 赞同：4
> 
> 时间：2012-08-18T04:37:52.617
> 
> 标签：lisp, scheme, common-lisp

是否有任何 lisp 中的表格可以“传播”父 sexp 中的列表？像：

```
(+ (spread '(1 2 3))) -> (+ 1 2 3) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-18T05:06:27.480

有两种方法可以做到这一点。哪个更好取决于你最终想要什么。

通常，您可以使用`,@`inside ```（反引号）。下面的形式`,@`被评估以产生一个列表，然后将其拼接到模板中：

```
* `(+ ,@'(1 2 3))
(+ 1 2 3)

* (eval `(+ ,@'(1 2 3)))
6 
```

或者，如果您只想调用一个函数，其参数打包在一个列表中，使用该`apply`函数会更方便：

```
* (apply #'+ '(1 2 3))
6 
```

# opengl - OpenGL中三角形缠绕方向的事实标准是什么？

> ID：12015886
> 
> 赞同：25
> 
> 时间：2012-08-18T04:37:54.023
> 
> 标签：opengl, standards, gl-triangle-strip

我们在三角形缠绕方向上有两种选择，

1.  顺时针
2.  逆时针

无论如何，它们之间的转换可能需要一些成本。我想尽可能地避免转换，而要做到这一点，我需要知道事实上的缠绕方向标准。我认为有一个，因为许多大公司都在使用 OpenGL，而且我认为如果他们中的大多数人都使用一个方向，那就是事实上的标准。

如果没有这样的事情，请告诉我。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-08-18T04:45:33.820

OpenGL 编程指南说“按照惯例，顶点在屏幕上以逆时针顺序出现的多边形称为正面。”

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-08-18T04:42:23.927

上的文档`glFrontFace`说默认是`GL_CCW`.

# html - 重构 CSS 以消除“幻数”

> ID：12015888
> 
> 赞同：6
> 
> 时间：2012-08-18T04:38:05.553
> 
> 标签：html, css, refactoring, magic-numbers

我知道幻数很糟糕，但我仍然会遇到它们似乎不可避免的时候。我创建了一个示例，希望有人向我展示如何重构和消除幻数。

希望这将帮助我以不同的方式思考未来消除它们。

我在 CodePen 上的示例：http: [//codepen.io/kevinsperrine/pen/LiGlb](http://codepen.io/kevinsperrine/pen/LiGlb)

编辑：css 文件的第 51 行包含“幻数”。

```
top: -42px; 
```

编辑 2：为了澄清我的要求：[WordPress 的样式指南](http://make.wordpress.org/core/handbook/coding-standards/css/#best-practices)将 CSS 幻数定义为一次性用于“修复”（阅读：创可贴）问题的数字。我正在询问更多关于如何将 HTML 和 CSS 更改为甚至不需要使用 -42px 的信息。根据我的经验，这些类型的问题似乎在 Web 开发中经常出现，所以我以这个案例为例，希望比我更有经验的人可以重构代码，这样就不需要“幻数”了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T01:15:57.887

看看LESS：它确实做到了这一点，而且还有更多。非常好的 CSS 预处理器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T14:55:19.333

我已将代码重构为下面的这些部分。本质上，我删除了两个不同的 img 标签，并将它们作为背景图像包含在类中。这让我可以将搜索图标的高度设置为在搜索模式中相同。单击时，将添加一个活动类，该类会更改背景图像和 z-index 位置，以便两个图像始终位于同一位置。无需 -42px hack 将“活动”图像移回它所属的位置。完整的代码可以在我[原来](http://codepen.io/kevinsperrine/pen/LiGlb)的codepen的一个[分支中找到。](http://codepen.io/kevinsperrine/pen/lpoJg)

```
<! --- HTML -- >
<div class="search-modal-container">
    <a id="search" class="search" href="#search" data-target=".search-modal"><i class="icon icon-20 icon-search"></i></a>
    <div class="search-modal is-hidden">
      <div class="search-modal-input">
        <form action="" method="post">
          <input type="text" value="" placeholder="Search">
          <input type="submit" value="GO" class="btn btn-primary btn-full">
        </form>
      </div>
    </div>
</div> 
```

CSS (Less) 现在看起来像这样：

```
/* CSS */
.search-modal-container {
  float: right;
  position: relative;

  &:after {
    content: "";
    display: table;
    clear: both;
  }
}

.search-modal {
    background-color: @menu-background-color;
    height: 100px;
    min-width: 325px;
    position: absolute;
    right: 0;
    z-index: @zindexModal;
    box-shadow: 1px 5px 4px @background-color;
    border-radius: 2px;
}

.is-hidden {
    display: none; 
}

.search {
  float: right;
}

.icon-search {
  width: 20px;
  height: 100px;
  display: block;
  background: url("http://c3.goconstrukt.com/img/search.png") no-repeat center center;
}

.icon-search.is-active {
  position: relative;
  z-index: @zindexModal + 1;
    background: @background-color url("http://c3.goconstrukt.com/img/search-active.png") no-repeat center center;

      &:after {
        content: '';
            width: 0;
            height: 0;
            border-width: 50px 15px 50px 0;
            border-style: solid;
            border-color: transparent @background-color;
        position: absolute;
        right: 100%;
    }
}

.search-modal-input {
    padding: 0.75em;
    float: left;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-04T10:08:46.257

Chris Coyier 在这篇文章[http://css-tricks.com/magic-numbers-in-css/](http://css-tricks.com/magic-numbers-in-css/)中解释了 CSS 中的幻数：

“它们通常总是以某种方式与字体相关”

然后

“CSS 中的幻数指的是在某些情况下“有效”但在这些情况发生变化时脆弱且容易中断的值”

在您的示例中，-42 可能不像想象的那么邪恶。问题是，当页面缩放或字体类型发生变化时，它会中断吗？我改变了变焦，没有发生任何不好的事情。

@Kevin Perrine 版本可能更适合 imgs 布局，但看起来模态容器高于原始版本。如果您想将它放在较低的位置，那么您可以将某个容器的 top 属性设置为适合您需要的任何数字，甚至是 42 等不四舍五入的数字。

但是当然，如​​果有办法防止使用随机数，那就是要走的路

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-19T01:07:01.287

您可以使用像 php 这样的编程语言来摆脱`magic numbers`：

----------------- **mystyle.php**

```
<?php const magic=-42; ?>
      .search-modal{
        top: <?php echo magic; ?>
      } 
```

---------------- **index.php**

```
<head>
 <style>
   <?php include 'mystyle.php'; ?>
 </style>
</head>
<body></body> 
```

或者你可以使用[twig](http://twig.sensiolabs.org/)。---------------- **mystyle.twig.hrml**

```
{% set magic=-42 %}
   .search-model{
       top: {{ magic }};
   } 
```

# android - 完成交易后完成所有活动

> ID：12015889
> 
> 赞同：0
> 
> 时间：2012-08-18T04:38:15.310
> 
> 标签：android

我有一组相互协调以完成某些交易
的活动。交易完成后，我再次被重定向到第一个活动以进行新交易……
我想要的是在交易完成后。 .当我被重定向到第一个活动时，当我按下 时，应用程序应该关闭`back key`，即，我不想看到以前的事务，它应该看起来像应用程序刚刚启动.. 应该怎么做？ ?

另外，我不想`finish()`在交易进行时进行活动......在交易完成后，只有先前交易中的所有活动都应该被杀死......
而且也`startActivityForResult()`不会解决我的问题。

请提出你的答案..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T05:11:36.480

一种简单的方法：

在第一个活动中使用公共静态变量。

并从其他活动中更改它们 mainActivity.VariableName = "whatever" 当您返回主要活动时，您将拥有所需的所有数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T04:41:35.970

你为什么不覆盖`back-button`按下的方法，然后做任何你想让应用程序表现得像你想要的那样的事情。覆盖该`onBackPressed()`方法，如果您希望应用程序重新启动，则创建一个启动您的第一个活动的意图，或者`finish()`如果您想关闭应用程序（但您也不想这样做）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T06:27:47.650

使用以下步骤：

1.  在 FirstActivity 中获取一个静态布尔变量

    **公共静态布尔killApplication = false；**

2.  在您的 FirstActivity 中覆盖 onBackPressed 方法，例如

    ```
    public void onBackPressed()
    {
        super.onBackPressed();

        FirstActivity.killApplication = true;

    } 
    ```

3.  在所有活动中覆盖 onResume 方法，例如

    ```
     protected void onResume()
     {      
         if (FirstActivity.killApplication) 
         {
             finish();
         }
     } 
    ```

4.  在您的 FirstActivity onCreate() 方法中设置**killApplication = false 。**

# c++ - 为什么包含 std::stringstream 的类的移动语义会导致编译器错误？

> ID：12015899
> 
> 赞同：24
> 
> 时间：2012-08-18T04:39:48.743
> 
> 标签：c++, c++11, g++, stringstream, move-semantics

我怎样才能使这个简单的类可移动？我认为是正确的只会产生一堵错误的墙......

```
#include <iostream>
#include <sstream>
#include <utility>

class message
{
    public:
        message() = default;

        // Move constructor
        message( message &&other ) :
            stream_( std::move( other.stream_ ) ) // Nope
        {}

        // Move assignment
        message &operator=( message &&other )
        {
            if ( this != &other )
            {
                stream_ = std::move( other.stream_ ); // Nope #2
            }
            return *this;
        }

    private:
        message( const message & ) = delete;
        message &operator=( const message & ) = delete;

        std::stringstream stream_;
        // Other member variables omitted
};

int main()
{
    message m;

    return 0;
} 
```

编译：

```
$ g++ --version
g++ (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3
$ g++ -Wall -Wextra -std=c++0x move.cpp -o move 
```

...并获得有关为字符串流的各种基类调用的复制分配的错误墙。

```
move.cpp: In constructor ‘message::message(message&&)’:
move.cpp:12:40: error: use of deleted function ‘std::basic_stringstream<char>::basic_stringstream(const std::basic_stringstream<char>&)’
In file included from move.cpp:2:0:
/usr/include/c++/4.6/sstream:483:11: error: ‘std::basic_stringstream<char>::basic_stringstream(const std::basic_stringstream<char>&)’ is implicitly deleted because the default definition would be ill-formed:
/usr/include/c++/4.6/sstream:483:11: error: use of deleted function ‘std::basic_iostream<char>::basic_iostream(const std::basic_iostream<char>&)’
In file included from /usr/include/c++/4.6/iostream:41:0,
                 from move.cpp:1:
/usr/include/c++/4.6/istream:774:11: error: ‘std::basic_iostream<char>::basic_iostream(const std::basic_iostream<char>&)’ is implicitly deleted because the default definition would be ill-formed:
/usr/include/c++/4.6/istream:774:11: error: use of deleted function ‘std::basic_istream<char>::basic_istream(const std::basic_istream<char>&)’
/usr/include/c++/4.6/istream:57:11: error: ‘std::basic_istream<char>::basic_istream(const std::basic_istream<char>&)’ is implicitly deleted because the default definition would be ill-formed:
/usr/include/c++/4.6/istream:57:11: error: use of deleted function ‘std::basic_ios<char>::basic_ios(const std::basic_ios<char>&)’
[SNIP] 
```

...这持续了好几页。

我的代码有什么问题？

**更新 1**：Clang 3.0 失败，结果相似。
**更新 2**：g++ 4.7 也失败了。
**更新 3**：使用答案作为指导，我发现：[c++11 status in libstdc++](http://gcc.gnu.org/onlinedocs/libstdc++/manual/status.html#status.iso.2011) - “27.5 Iostreams base classes: Missing move and swap operations on basic_ios。” 诅咒！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-18T11:58:06.410

## 更新

它需要按照 C++11/14 标准工作。GCC 5.0 做对了，下面提到的错误已解决。感谢 GCC 团队！

## 原始答案

到目前为止，它是 gcc 中缺少的功能（或 Xeo 指出的 libstdc++）。

[http://gcc.gnu.org/bugzilla/show_bug.cgi?id=54316](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=54316)

根据标准，

```
typedef basic_stringstream<char> stringstream; 
```

从 27.8.5 开始，有一个公共移动构造函数

```
basic_stringstream(basic_stringstream&& rhs); 
```

我可以用`gcc 4.7 -std=c++11`ubuntu 12.04 确认问题。

```
std::stringstream a;
std::stringstream b=std::move(a); 
```

阅读包含文件`include/std/sstream`我发现没有移动构造函数或任何提及 C++0x 或 C++11。（比较`std::string`哪个确实有效。）

添加（模拟）移动构造函数：

```
basic_stringstream(basic_stringstream&& rhs){} 
```

将错误减少到只有树线，但是

```
use of deleted function ‘std::basic_stringstream<char>::basic_stringstream(
   const std::basic_stringstream<char>&)’ 
```

遗迹。

## 解决方法

改用 a `std::unique_ptr<std::stringstream>`。最好是`make_unique`用 c++14 来初始化它，或者以我的博客[cpp11style-no-new-delete](http://scrupulousabstractions.tumblr.com/post/37576903218/cpp11style-no-new-delete)为例（这是一个早期版本，但它可以正常工作）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-18T09:35:08.903

Clang 3.0 是 C++98，Clang 3.1 编译得很好（使用 libc++）：

```
~/blargh $ cat t.cpp
#include <sstream>

诠释主要（）{
  auto get_s = []{ return std::stringstream("hi"); };
  汽车 s ​​= get_s();
}
~/blargh $ 铿锵声 -v
clang 3.1 版（主干 152621）
目标：x86_64-unknown-linux-gnu
线程模型：posix
~/blargh $ clang++ -std=c++0x -stdlib=libc++ -Wall -pedantic t.cpp
〜/大声$

```

您的示例也可以很好地完成，所以我猜是 libstdc++ 在这方面被破坏了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-18T04:41:44.673

您可能使用了错误版本的库。您的代码没有理由无效。

顺便说一句，自赋值检查赋值运算符很糟糕。

编辑：奇怪的是，Visual Studio 似乎也相信`basic_stringstream`没有移动构造函数。所有流在 C++11 中*都应该是可移动的。*也许这是一个标准缺陷，或者实现移动构造函数需要 C++11 功能，但尚不支持。从概念上讲，它没有理由失败，但我实际上找不到任何支持它的东西。

# c# - 如何使用 sqlcmd 验证查询是否成功执行？

> ID：12015900
> 
> 赞同：2
> 
> 时间：2012-08-18T04:40:00.877
> 
> 标签：c#, sql-server, sqlcmd

我正在使用**sqlcmd**实用程序在脚本文件中运行一系列 sql 查询。下面给出了一个简单的查询。我用来运行 sqlcmd 实用程序的命令是：

```
sqlcmd.exe -m-1 -r 1 -S . -E -d test -i "D:\Recycle\Sp_tempTable1.sql". 
```

我正在从 C# 代码运行**sqlcmd实用程序。**这很好——执行查询并成功创建表。

我想要的是返回一些东西的实用程序，它告诉我输入文件中的所有查询都成功运行。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T16:38:11.527

使用 -o 标志可以指定输出文件。该文件将包含受影响的行数和/或命令遇到的任何错误。[但是，使用System.Data.SqlClient](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.aspx)命名空间从托管代码运行查询会容易得多，因此您可以实现标准的 try -> Exception -> catch 错误处理。

# android - LiveWallpaper Andengine 示例错误

> ID：12015906
> 
> 赞同：5
> 
> 时间：2012-08-18T04:41:45.300
> 
> 标签：android, andengine

我下载了[andengine 动态壁纸示例](http://code.google.com/p/andenginelivewallpaperextensionexample/source/browse/#hg/src/org/anddev/wallpaper/live/cigarette)，但它有一个问题。它显示这些错误：

```
08-18 04:38:52.606: E/AndroidRuntime(3063): FATAL EXCEPTION: main
08-18 04:38:52.606: E/AndroidRuntime(3063): java.lang.RuntimeException: Unable to instantiate service org.anddev.wallpaper.live.cigarette.LiveWallpaperService: java.lang.ClassNotFoundException: org.anddev.wallpaper.live.cigarette.LiveWallpaperService in loader dalvik.system.PathClassLoader[/data/app/org.anddev.wallpaper.live.cigarette-1.apk]
08-18 04:38:52.606: E/AndroidRuntime(3063):     at android.app.ActivityThread.handleCreateService(ActivityThread.java:1950)
08-18 04:38:52.606: E/AndroidRuntime(3063):     at android.app.ActivityThread.access$2500(ActivityThread.java:121)
08-18 04:38:52.606: E/AndroidRuntime(3063):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:997)
08-18 04:38:52.606: E/AndroidRuntime(3063):     at android.os.Handler.dispatchMessage(Handler.java:99)
08-18 04:38:52.606: E/AndroidRuntime(3063):     at android.os.Looper.loop(Looper.java:130)
08-18 04:38:52.606: E/AndroidRuntime(3063):     at android.app.ActivityThread.main(ActivityThread.java:3701)
08-18 04:38:52.606: E/AndroidRuntime(3063):     at java.lang.reflect.Method.invokeNative(Native Method)
08-18 04:38:52.606: E/AndroidRuntime(3063):     at java.lang.reflect.Method.invoke(Method.java:507)
08-18 04:38:52.606: E/AndroidRuntime(3063):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:866)
08-18 04:38:52.606: E/AndroidRuntime(3063):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:624)
08-18 04:38:52.606: E/AndroidRuntime(3063):     at dalvik.system.NativeStart.main(Native Method)
08-18 04:38:52.606: E/AndroidRuntime(3063): Caused by: java.lang.ClassNotFoundException: org.anddev.wallpaper.live.cigarette.LiveWallpaperService in loader dalvik.system.PathClassLoader[/data/app/org.anddev.wallpaper.live.cigarette-1.apk]
08-18 04:38:52.606: E/AndroidRuntime(3063):     at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
08-18 04:38:52.606: E/AndroidRuntime(3063):     at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
08-18 04:38:52.606: E/AndroidRuntime(3063):     at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
08-18 04:38:52.606: E/AndroidRuntime(3063):     at android.app.ActivityThread.handleCreateService(ActivityThread.java:1947)
08-18 04:38:52.606: E/AndroidRuntime(3063):     ... 10 more 
```

这是我的清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="org.anddev.wallpaper.live.cigarette"
      android:versionCode="4"
      android:versionName="1.0.3">

    <uses-sdk android:minSdkVersion="7" />

    <uses-feature android:name="android.software.live_wallpaper" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />

    <application android:icon="@drawable/icon" android:label="@string/app_name">
        <service 
            android:name="LiveWallpaperService"
            android:enabled="true"
            android:icon="@drawable/icon"
            android:label="@string/service_name"
            android:permission="android.permission.BIND_WALLPAPER">
            <intent-filter android:priority="1" >
                <action android:name="android.service.wallpaper.WallpaperService" />
            </intent-filter>
            <meta-data 
                android:name="android.service.wallpaper" 
                android:resource="@xml/wallpaper" />
        </service>
    </application>

</manifest> 
```

我不知道这个错误是什么意思。我希望有人可以在这里帮助我运行这个东西..谢谢你..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-18T05:40:59.360

你的错误是`ClassNotFoundException`关于你的动态壁纸（`org.anddev.wallpaper.live.cigarette`）。所以我猜你的动态壁纸声明`manifest`不正确（例如它可能不在应用程序标签中，...）
你可以在关于声明一个这些页面清单中的服务：
developer.android.com/guide/components/services.html
developer.android.com/reference/android/app/Service.html

**编辑**：
我看到了你的清单。似乎你的项目没有`Main/Launcher Activity`。如果你的项目没有 Main/Launcher Activity，你的服务无法注册，所以当你尝试使用它们时，你会得到`ClassNotFoundException`。
还要确保服务的完全限定类名是`android.service.wallpaper.WallpaperService`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T11:30:04.113

就我而言，我只需要在构建路径中按顺序/导出检查 andengine.jar 和 andenginelivewallpapersupport.jar。（我也使用完全合格的）

# java - Appengine如何删除命名空间中的所有实体 - Java

> ID：12015907
> 
> 赞同：5
> 
> 时间：2012-08-18T04:41:55.987
> 
> 标签：java, google-app-engine

我使用命名空间来管理多租户。我需要知道是否有一种简单的方法可以删除所有实体。

我知道我可以使用 mapreduce，但是我看到的所有示例都从 servlet 配置调用映射器，但是当用户选择关闭帐户时，我需要动态传递命名空间字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T06:24:20.190

经研究，在实体搜索中不能使用namespace调用mapreduce。这可能是最好的路线。

唯一的办法是

*   创建任务队列以删除整个命名空间
*   获取命名空间中的所有类型。使用延迟任务删除每种类型
*   对于每种类型，获取实体（仅限键）。您可以进行批量删除。如果您有很多实体，这可能会超时。但是由于您只获取密钥并进行批量删除 - 我认为这不是问题。否则，您可以使用后端并指向此任务，使其不会超时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T12:32:40.663

我认为这个特性只适用于 Python 端，不幸的是，对于 Java 运行时，特性请求[仍然是 Open](http://code.google.com/p/appengine-mapreduce/issues/detail?id=53)。

# php - 打开失败需要'MYSQL'

> ID：12015908
> 
> 赞同：0
> 
> 时间：2012-08-18T04:42:02.633
> 
> 标签：php, mysql, require

当我尝试运行我的 php 脚本时，我不断收到错误 500。我查看了日志，它读到了这个。2012 年 8 月 17 日 22:35:59] PHP 致命错误：require() [function.require]：无法打开所需的“MYSQL”（include_path='.:/usr/lib64/php:/usr/lib/php: /usr/share/pear') 在第 3 行的 /home5/virtua15/public_html/gatewayaviation/aircraft_list.php 下面是我脚本的第 1 行到第 5 行

```
<?php
require('http://gatewayaviation.virtual-aviation.org/includes/config.inc.php');
require (MYSQL);
$q = "SELECT CONCAT(aircraft_name, tail_number) AS aircraft, aircraft_type AS at, location AS loc, FROM aircraft GROUP BY location ORDER BY tail_number ASC";
$r = mysqli_query($dbc, $q); 
```

这背后的原因是什么。我一直在为我正在处理的项目中的许多其他页面使用相同的编码，并且没有任何问题。你能对此有所了解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T05:11:57.163

提供远程文件`require`是一种安全威胁，因为远程网站可以更改该文件中的 PHP 代码，从而损害您的服务器。此外，包含远程 PHP 文件不会包含它包含的 PHP 代码，只会包含生成的 HTML。正如您通过访问浏览器中的链接所看到的那样，它会产生一个空输出。

如果该文件本地托管在您的服务器中，请提供该文件的路径，而不是 URL，例如：`require '/var/www/website/includes/config.inc.php'`

至于 require(MYSQL)，我假设您正在尝试包含一个名为 MYSQL 的文件？如果是这种情况，请将其放在引号中并确保指定正确的路径，如下所示：`require 'MYSQL';`否则解释器会将 MYSQL 视为未定义的常量。我不知道该文件可能包含什么，但如果它是 PHP 代码，最好给它一个 .php 扩展名，否则人们可能能够下载它并查看其中的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T22:55:03.440

我实际上发现了这段代码的问题。我在 SQL 查询中的 loc 后面放了一个逗号，这破坏了脚本。现在一切都解决了。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-18T04:50:21.923

首先，我会推荐 OOP 的世界。接下来，它没有出现在您的第三行中定义 MYSQL，而且我从未见过这样做过。如果连接到您的数据库是问题，这里是您的参考。[http://www.php-mysql-tutorial.com/wikis/mysql-tutorials/connect-to-mysql-database.aspx](http://www.php-mysql-tutorial.com/wikis/mysql-tutorials/connect-to-mysql-database.aspx)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-18T04:53:23.113

这

```
require('http://gatewayaviation.virtual-aviation.org/includes/config.inc.php'); 
```

不建议在 php 中，你也不能只是

```
require (MYSQL); 
```

而是你必须连接到数据库做这样的事情

```
$mysqli = new mysqli('localhost', 'my_user', 'my_password', 'my_db');

$q = "SELECT CONCAT(aircraft_name, tail_number) AS aircraft, aircraft_type AS at, location AS loc, FROM aircraft GROUP BY location ORDER BY tail_number ASC";
$r = mysqli_query($mysqli, $q); 
```

我认为您需要为傻瓜获取教程或 php 并阅读

# desire2learn - Desire2Learn - UI 中的最终成绩值与从 JSON 响应中获得的值不同

> ID：12015909
> 
> 赞同：0
> 
> 时间：2012-08-18T04:42:12.183
> 
> 标签：desire2learn

UI 显示学生 A 的以下最终成绩：

```
17.15/42                  **Scheme: F** 
```

但是 JSON 响应 (https:// ****** /d2l/api/le/1.0/courseID/grades/final/values/studentIdentifier?x_a= ***** &x_b= ******* &x_c= ******* *8&x_d= ***** *** &x_t= ***** *** )我得到如下：{

PointsNumerator：17.15，PointsDenominator：42，WeightedNumerator：17.15，WeightedDenominator：42，GradeObjectIdentifier：“ ******* ”，GradeObjectName：“最终计算成绩”，GradeObjectType：7，GradeObjectTypeName：null， **DisplayedGrade：“B”** }

DisplayedGrade 在 D2L 系统中为 F，但 JSON 响应显示 DisplayedGrade 为 B。这发生在课程中的所有学生身上。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T14:59:46.697

您的 LMS 可能存在一个已知问题：如果使用“无序”条目创建成绩架构，则通过 API 获取的成绩与成绩值相关的架构符号可能与您通过主 Web UI 找到的方式不同。要解决此问题，请一次性创建等级模式，从分数 0 开始的项目会上升到最大值。

# ruby-on-rails - Ruby 中的功能测试失败？

> ID：12015910
> 
> 赞同：0
> 
> 时间：2012-08-18T04:42:18.777
> 
> 标签：ruby-on-rails, unit-testing

我正在 Ruby 中运行功能测试，但它们失败了。

我得到这个是跑步的结果`rake test:functionals`

```
 1) Failure:
test_should_create_user(UsersControllerTest) [test/functional/users_controller_t
est.rb:20]:
"User.count" didn't change by 1.
<3> expected but was
<2>.

14 tests, 19 assertions, 1 failures, 0 errors
Errors running test:functionals! #<#<Class:0x472b82e5>: Command failed with stat
us (1): [c:/jruby-1.6.7.2/bin/jruby.exe -I"lib;test...]> 
```

我已经检查了日志文件以查找 SQL 错误，但一切似乎都正常。

知道为什么会失败吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T06:04:31.680

我假设您没有更改测试文件，它是自动生成的。

在这种情况下，因为没有 SQL 错误，所以测试和/或控制器一定有问题。

假设控制器没有问题，可能的问题是：

*   您的测试发送到控制器的属性值无效（由于模型中的验证）

*   测试无权创建对象（如果您使用的是设计，则需要在测试中登录）

否则，控制器可能有错误。

# android - Android中的本地主机

> ID：12015911
> 
> 赞同：1
> 
> 时间：2012-08-18T04:42:22.360
> 
> 标签：android, android-layout, android-ndk

我想从**http://127.0.0.1/html/andhel/index.html在 webview 中加载 index.html 文件**

现在我想在 android 平板电脑中创建**html**和**andhel目录？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T05:07:54.830

而不是 127.0.0.1/html/andhel/index.html

使用**http://10.0.2.2/html/andhel/index.html**

而已！！但是从模拟器测试它......从设备测试它需要做更多的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T05:29:21.113

Android Emulator 不像您机器上的普通应用程序那样安装。它是一个具有唯一 IP 地址和物理地址的虚拟机实例。因此，在您的机器上提供的任何东西都不能作为模拟器上的本地主机访问。您应该使用完整的 IP 地址访问它，就像它在网络上的其他机器上一样，而不是 localhost。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T06:23:40.390

您应该使用**10.0.2.2**而不是**127.0.0.1**，因为

> 10.0.2.2 是主机环回接口的特殊别名（即开发机器上的 127.0.0.1）

有关[模拟器网络的更多信息](http://developer.android.com/tools/devices/emulator.html#emulatornetworking)

主要原因是，模拟器不会查看位于本地机器上的主机文件，也不会使用它。

有一些解决方法可以使用您自己的虚拟主机，请查看以下链接

[http://www.bradcurtis.com/2011/02/13/hosts-file-google-android-emulator/](http://www.bradcurtis.com/2011/02/13/hosts-file-google-android-emulator/)

[http://dillieodigital.wordpress.com/2012/03/19/soup-to-nuts-getting-your-android-emulator-to-read-virtual-hosts-on-your-development-machine/](http://dillieodigital.wordpress.com/2012/03/19/soup-to-nuts-getting-your-android-emulator-to-read-virtual-hosts-on-your-development-machine/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-18T04:49:21.480

如果您的 index.html 在您的计算机中，则您的 AVD 已安装在使用中 10.0.2.2

# java - 在android可扩展列表视图中动态添加子项

> ID：12015914
> 
> 赞同：-1
> 
> 时间：2012-08-18T04:42:29.650
> 
> 标签：java, android, xml-parsing, expandablelistview, expandablelistadapter

我必须使用下面的代码...我必须为第一组获取子值...但是在这里我必须单击第二组意味着它没有展开并且同时应用程序被强制关闭。所以请帮助我..怎么样为不同的父母设置不同的孩子价值......请给我这个示例代码......

```
private List createGroupList() {

    Log.d(TAG, "Adding groups values");
    List<HashMap<String, String>> list = new ArrayList<HashMap<String, String>>();
    HashMap<String, String> statusMap = new HashMap<String, String>();
    statusMap.put(GroupID, "OrderInfo");
    list.add(statusMap);
    HashMap<String, String> usersMap = new HashMap<String, String>();
    usersMap.put(GroupID, "CustomerInfo");
    list.add(usersMap);
    Log.d(TAG, "Adding groups values successfull");
    return list;
}

 private List createChildList() {

    ArrayList result = new ArrayList();
    for( int i = 0 ; i < 1 ; ++i ) { // this -15 is the number of groups(Here it's fifteen)
      /* each group need each HashMap-Here for each group we have 3 subgroups */
      ArrayList secList = new ArrayList();
      for( int n = 0 ; n < 1 ; n++ ) {
        HashMap child = new HashMap();

       String s= getIntent().getStringExtra("payment_method");
       String s1= getIntent().getStringExtra("total");
       String s2= getIntent().getStringExtra("firstname");
       String s3= getIntent().getStringExtra("lastname");

     child.put( "KEY_ARTIST", s);
     child.put( "KEY_DURATION", s1);
     child.put( "KEY_FNAME", s2);
     child.put( "KEY_LNAME", s3);

        secList.add( child);
      }
     result.add( secList );
    }
    return result;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T04:18:31.663

使用此代码：

```
final LayoutInflater layoutInflater = (LayoutInflater) this.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    final ArrayList<HashMap<String, String>> headerData = new ArrayList<HashMap<String, String>>();

    final HashMap<String, String> group1 = new HashMap<String, String>();
    group1.put(NAME, "OrderInfo");
    headerData.add( group1 );

    final HashMap<String, String> group2 = new HashMap<String, String>();
    group2.put(NAME, "CustomerInfo");
    headerData.add( group2);

    final ArrayList<ArrayList<HashMap<String, Object>>> childData = new ArrayList<ArrayList<HashMap<String, Object>>>();

    final ArrayList<HashMap<String, Object>> group1data = new ArrayList<HashMap<String, Object>>();
    childData.add(group1data);

    final ArrayList<HashMap<String, Object>> group2data = new ArrayList<HashMap<String, Object>>();
    childData.add(group2data); 
```

上面的代码对我有用....所以试试上面的代码。

# javascript - SVG上的下拉菜单？

> ID：12015917
> 
> 赞同：7
> 
> 时间：2012-08-18T04:42:40.573
> 
> 标签：javascript, html, svg, d3.js

我有一个 svg 画布，里面充满了使用 d3 进行的有趣数据可视化，我希望在 svg:rect 元素上方显示一个传统的 html 下拉菜单。这可能吗？我意识到我可以使用 foreignObject，但这与 IE 不兼容。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T16:32:32.617

只要您正确排列元素，它就可以正常工作。[在此处](http://jsfiddle.net/hkwD3/)的示例中，我在 SVG 元素顶部使用了绝对定位的 DIV（在输出窗口周围移动鼠标以查看 DIV 的移动）。（代码使用[Raphael](http://raphaeljs.com/)而不是 D3，但结果是一样的）。

# c++ - 使用四元数问题的 C++ OpenGL 相机旋转

> ID：12015920
> 
> 赞同：0
> 
> 时间：2012-08-18T04:43:29.127
> 
> 标签：c++, opengl, camera, orientation, quaternions

我在为我的相机实现四元数时遇到问题。我在 OpenGL 中创建了一个 3D 空间射击游戏，我需要避免万向节锁定。如果我只在一个轴上旋转它很好，但是一旦我同时应用俯仰和偏航，它们就会有一种奇怪的行为。我的旋转角度是使用鼠标的输入。

在这里，我计算了我的 ViewMatrix 并更新了每一帧

```
Matrix4x4 camera::GetViewMat()
{
    m_rotation.AddX((oInput.MousePosition.GetY() - oInput.PrevMousePosition.GetY()) * m_sensitivity * dt);
    m_rotation.AddY((oInput.MousePosition.GetX() - oInput.PrevMousePosition.GetX()) * -m_sensitivity * dt);

    Matrix4x4 oTranslateOrigin, oRotate, oView;
    oView.SetIdentity();

    //constructor creates a quaternion from an AxisAngle, the constructor will be shown below
    Quaternions pitch = Quaternions(m_rotation.GetX() * Utility::DegToRad(), Vector3(1, 0, 0));
    Quaternions yaw = Quaternions(m_rotation.GetY() * Utility::DegToRad(), Vector3(0, 1, 0));

    //update orientation with the new quaternion times its current orientation
    ori = ori * yaw * pitch;

    //convert quaternion to matrix, also shown below
    oRotate = ori.ToMatrix();
    oTranslateOrigin.BuildTranslate(-m_camPosition.GetX(), -m_camPosition.GetY(), -m_camPosition.GetZ());

    oView = oRotate * oTranslateOrigin;

    return oView;
} 
```

初始化投影矩阵

```
Matrix4x4 camera::GetProjMat(float fFieldOfViewY, float fAspectRatio, float fNearZ, float fFarZ)
{
    // Transposed version of D3DXMatrixPerspectiveFovRH
    float fYScale = 1 / tanf( fFieldOfViewY / 2.0f );
    float fXScale = fYScale / fAspectRatio;
    memset( &m_projMat, 0, sizeof( Matrix4x4 ) );
    m_projMat.Set(0, 0, fXScale);
    m_projMat.Set(1, 1, fYScale);
    m_projMat.Set(2, 2, fFarZ / ( fNearZ - fFarZ ));
    m_projMat.Set(2, 3, ( fNearZ * fFarZ ) / ( fNearZ - fFarZ ));
    m_projMat.Set(3, 2, -1.0f);
    return m_projMat;
   } 
```

这是为 AxisAngle 创建四元数的构造函数之一

```
Quaternions::Quaternions(float angle, Vector3& axis)
{
    FromAxisAngle(angle, axis);
}

void Quaternions::FromAxisAngle(float angle, Vector3& axis)
{
    float halfAngle = angle * ((float)PI/360.0f);
    float sin = sinf(halfAngle);

    this->w = cosf(halfAngle);
    this->x = axis.GetX() * sin;
    this->y = axis.GetY() * sin;
    this->z = axis.GetZ() * sin;
}

Matrix4x4 Quaternions::ToMatrix()
{
    Normalize();
    Matrix4x4 mat;
    mat.SetIdentity();

    mat.Set(0, 0, 1.0f - 2*(this->y * this->y) - 2*(this->z * this->z));
    mat.Set(0, 1, 2*(this->x*this->y) - 2*(this->w*this->z));
    mat.Set(0, 2, 2*(this->x * this->z) + 2*(this->w * this->y));

    mat.Set(1, 0, 2*(this->x * this->y) + 2*(this->w * this->z));
    mat.Set(1, 1, 1.0f - 2*(this->x * this->x) - 2*(this->z * this->z));
    mat.Set(1, 2, 2*(this->y * this->z) - 2*(this->w * this->x));

    mat.Set(2, 0, 2*(this->x * this->z) - 2*(this->w * this->y));
    mat.Set(2, 1, 2*(this->y * this->z) + 2*(this->w * this->x));
    mat.Set(2, 2, 1.0f - 2*(this->x * this->x) - 2*(this->y * this->y));

    return mat;
} 
```

这就是我正在做的事情。

你们能引导我走向正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T11:02:02.990

好的，这就是您要避免使用四元数的万向节锁定。另外，我还包含了一些 Opengl 特定的代码，希望能引导您朝着正确的方向前进。好的，首先我要将键映射到旋转。

```
W - Pitch up(x rot)
S - Pitch down(x rot)
A - Yaw left(y rot)
D - Yaw Right(y rot)
Q - Roll left(z rot)
E - Roll right(z rot) 
```

所有你想要的是当这些被按下时调用正确的旋转。因此，例如用户按下 W 我们需要做的就是创建一个四元数 for 并围绕 x 旋转 1 度。使用你的四元数类做到这一点：

```
a = EulerToQuat(angle,0,0);
cameraOri = cameraOri * a; 
```

显然对其他控件做同样的事情！好的，您需要做的最后一步是使用 Opengl 中的旋转命令正确旋转世界。我们这样做的方式既好又易于阅读，我们将四元数转换为角度和轴。（希望您的四元数类可以这样做！）然后继续使用它进行 glRotate！

```
m_frustumCamera->getQuat().GetAxisAngle(axis,angle);
angle = (float)(angle * radToDeg);  
glRotatef(angle,axis.x,axis.y,axis.z);  
glTranslatef(-1*m_frustumCamera->getPos().x,-1*m_frustumCamera->getPos().y,-1*m_frustumCamera->getPos().z); 
```

如果您没有工作的四元数类，我建议： [http](http://www.wolframalpha.com/) ://www.wolframalpha.com/ 以确保您的所有函数都给出正确的响应！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T04:45:34.553

是不是因为这一行：

```
ori = ori * yaw * pitch; 
```

是不是顺序不对？

您始终可以使用 openGL 函数旋转相机矩阵。只要确保堆栈上有相机矩阵即可。

```
glRotate(angle, 1, 0, 0);
glRotate(angle, 0, 1, 0); 
```

你可以用这个函数看一个点：

```
void gluLookAt( GLdouble eyeX , GLdouble eyeY , GLdouble eyeZ , 
                GLdouble centerX , GLdouble centerY , GLdouble centerZ , 
                GLdouble upX , GLdouble upY , GLdouble upZ ); 
```

您需要眼睛位置、目标（中心）位置和相机的向上矢量的位置。

# java - 如何加快keyEvent和callin repaint之间的时间

> ID：12015929
> 
> 赞同：0
> 
> 时间：2012-08-18T04:46:07.023
> 
> 标签：java, performance, freeze, repaint

![在此处输入图像描述](../Images/5e4ca88836f9c49338a42e13b23f6408.png)我有一个 JFrame(jf)，在那个窗口中我得到了三个 JPanel。我在 JPanel 中有图形。当我按下键盘上的右箭头时，我想重新绘制这个图形。我在 JFrame 中添加了一个 keyListener。addKeyListener(this) -> JFrame 实现 KeyListener。

```
 if (arg0.getKeyCode() == KeyEvent.VK_RIGHT){
        start = System.currentTimeMillis();
        l.czas.addMinuty(1);
        aktualizuj();
    } 
```

在每个面板中，我都调用 repaint，但是将调用此 repaint 和按下右箭头之间的时间很长。当我同时按多次右键时，程序将冻结，然后跳过一些步骤（和之间的图形）。我测量了 HITTING AN ARROW 和 Calling 之间的时间，例如代表时间的字符串。时间为0的地方是我多次按键的时刻。请帮我。

```
Paint component called  1   times
Before superPaintComponent      1734
After superPaintComponent       1734
Before drawing Time     1781
Paint component called  2   times
Before superPaintComponent      2953
After superPaintComponent       2953
Before drawing Time     2953
Paint component called  3   times
Before superPaintComponent      0
After superPaintComponent       0
Before drawing Time     0
Paint component called  4   times
Before superPaintComponent      0
After superPaintComponent       0
Before drawing Time     0
Paint component called  5   times
Before superPaintComponent      0
After superPaintComponent       0
Before drawing Time     16
rakowiecka.PNG
Paint component called  6   times
Before superPaintComponent      0
After superPaintComponent       0
Before drawing Time     0
Paint component called  7   times
Before superPaintComponent      0
After superPaintComponent       0
Before drawing Time     0
Paint component called  8   times
Before superPaintComponent      0
After superPaintComponent       0
Before drawing Time     16
placuniilubelskiej.PNG
Paint component called  9   times
Before superPaintComponent      15
After superPaintComponent       15
Before drawing Time     15
Paint component called  10  times
Before superPaintComponent      0
After superPaintComponent       0
Before drawing Time     0
Paint component called  11  times
Before superPaintComponent      0
After superPaintComponent       0
Before drawing Time     0
placzbawiciela.PNG
Paint component called  12  times
Before superPaintComponent      0
After superPaintComponent       0
Before drawing Time     0
**IT GOES ON...................** 
```

* * *

```
public void aktualizuj(int nrPrzystanku){
        this.nrPrzystanku = nrPrzystanku;   
        repaint();
    }

    @Override
    public void paintComponent(Graphics g) {
        NR++;
        System.out.println("Paint component called\t" + NR + "\ttimes");
        System.out.println("Before superPaintComponent\t\t" + (System.currentTimeMillis() - GlowneOkno.start));
        super.paintComponent(g);
        System.out.println("After superPaintComponent\t\t" + (System.currentTimeMillis() - GlowneOkno.start));
        int Height = (int) d.getHeight(), Width = (int) d.getWidth();
    //  System.out.println("PAINT W InfoLiniaPanel");
        Font f = new Font(Font.SANS_SERIF,Font.BOLD, (4 *Height/10));
        g.setFont(f);
    //  System.out.println(Height);
        //rysowanie numeru linii
        g.drawString(linia.nr + "", Width/10, Height/3);
        //rysowanie czasu
        Font f1 = new Font(Font.SANS_SERIF,Font.BOLD, 2 * Height/18);
        g.setFont(f1);
        System.out.println("Before drawing Time\t\t" + (System.currentTimeMillis() - GlowneOkno.start));
        g.drawString(linia.czas +" ", Width/10 +  g.getFontMetrics(f).stringWidth(linia.nr+"") + Width/10, Height/3);
        //kierunek
    //  System.out.println(linia.kurs.get(linia.kurs.size() -1 ).kierunek);
        g.setFont( new Font(Font.SANS_SERIF,Font.BOLD,1 *Height/20));
        g.drawString(linia.kurs.get(linia.kurs.size() -1 ).kierunek + "",
                 Width/10 + g.getFontMetrics(f).stringWidth(linia.nr+"") + Width/10,
                 Height/3 - g.getFontMetrics(f1).getAscent() /*g.getFontMetrics(f1).getHeight()*/ );
    //      System.out.println(g.getFontMetrics(f1).getHeight());
        //nastepny przystanek
    //  System.out.println(linia.kurs.get(nrPrzystanku)); //TRZEBA ZMIENIC NA JAKIS INDEKS ZEBY SZLA SYMULKACJA!!!!!!
        //NAJLEPIEJ DAC POLE OBECNY PRZYSTANEK W KLASIE LINIA
        g.drawString("Następny przystanek:" , Width/10, Height/3 + g.getFontMetrics().getHeight() + Height/10);
        g.setFont(new Font(Font.SANS_SERIF,Font.BOLD,1 *Height/18));

        if( nrPrzystanku +1 < Linia.trasa.length)
            g.drawString(linia.kurs.get(nrPrzystanku + 1).nazwa+"", Width/10, Height/3 + g.getFontMetrics().getHeight()*12/6 + Height/10);
        else
            g.drawString("Ostatni postój", Width/10, Height/3 + g.getFontMetrics().getHeight()*12/6 + Height/10);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T05:36:13.863

我写了一个非常快速的测试。它绘制一个大图像（650x975）并绘制一些文本（时间）。

我试着想一些我可以在短时间内做的最耗时的动作，所以绘制图像和绘制透明组件是我能想到的最好的两个......

它产生以下输出

![示例图像](../Images/dcc0b0eceaa3019d91e1cba0582700de.png)

（不按比例）。

我基本上在图像窗格中添加了一个“右键”操作，并在按下键时发送了一个重绘请求。

哪个输出这个...

```
Update
[ImagePane] Time since paint request: 0:0:0.49
[TimePane] Time since paint request: 0:0:0.58
Update
[ImagePane] Time since paint request: 0:0:0.0
[TimePane] Time since paint request: 0:0:0.1
Update
.
.
. 
```

基本上：

*   `Update`从击键的动作事件中打印出来。
*   `ImagePane``paintComponent`在方法结束时被转储`ImagePane`
*   `TimePane``paintComponent`在方法结束时被转储`TimePane`

持续时间是从动作事件发生的时间开始计算的，即在其他任何事情之前

从我的时间来看，我看不出有什么大问题，实际上我可以在时间更新之间按几次右键

这是测试代码...

框架：

```
public class TestFrame extends JFrame {

    public TestFrame() {

        setLayout(new BorderLayout());
        ImagePane imagePane = new ImagePane();
        imagePane.setLayout(new BorderLayout());
        imagePane.add(new TimePane());
        imagePane.setFocusable(true);

        add(imagePane);

        pack();
        setLocationRelativeTo(null);
        setVisible(true);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        InputMap im = imagePane.getInputMap(JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT);
        ActionMap am = imagePane.getActionMap();
        im.put(KeyStroke.getKeyStroke(KeyEvent.VK_RIGHT, 0), "Right");
        am.put("Right", new AbstractAction() {

            @Override
            public void actionPerformed(ActionEvent e) {

                System.out.println("Update");

                Test.isTesting = true;
                Test.startTime = new DateTime();

                invalidate();
                repaint();

            }

        });

        imagePane.requestFocusInWindow();

    }

    public static void main(String[] args) {
        TestFrame jf = new TestFrame();

    }
} 
```

图像窗格...

```
public class ImagePane extends JPanel {

    private BufferedImage background;

    public ImagePane() {

        try {
            background = ImageIO.read(getClass().getResource("/1246.jpg"));
        } catch (IOException ex) {

            ex.printStackTrace();

        }

    }

    @Override
    public Dimension getPreferredSize() {

        return new Dimension(background.getWidth(), background.getHeight());

    }

    @Override
    protected void paintComponent(Graphics g) {

        super.paintComponent(g);

        Graphics2D g2d = (Graphics2D) g;

        int width = getWidth() - 1;
        int height = getHeight() - 1;

        int x = (width - background.getWidth()) / 2;
        int y = (height - background.getHeight()) / 2;

        g2d.drawImage(background, x, y, this);

        if (Test.isTesting) {

            DateTime endTime = new DateTime();
            Duration duration = new Duration(Test.startTime, endTime);

            System.out.println("[ImagePane] Time since paint request: " + Test.toString(duration));

        }

    }

} 
```

时间窗格...

```
public class TimePane extends JPanel {

    public TimePane() {

        setOpaque(false);

    }

    @Override
    public Dimension getPreferredSize() {

        FontMetrics fm = getFontMetrics(getFont());
        String text = DateFormat.getTimeInstance().format(new Date());

        return new Dimension(fm.stringWidth(text), fm.getHeight());
    }

    @Override
    protected void paintComponent(Graphics g) {

        super.paintComponent(g);

        Graphics2D g2d = (Graphics2D) g;

        FontMetrics fm = g2d.getFontMetrics();

        String text = DateFormat.getTimeInstance().format(new Date());

        int width = getWidth() - 1;
        int height = getHeight() - 1;

        int x = (width - fm.stringWidth(text)) / 2;
        int y = ((height - fm.getHeight()) / 2) + fm.getAscent();

        g2d.setColor(Color.WHITE);
        g2d.drawString(text, x, y);

        if (Test.isTesting) {

            DateTime endTime = new DateTime();
            Duration duration = new Duration(Test.startTime, endTime);

            System.out.println("[TimePane] Time since paint request: " + Test.toString(duration));

        }

    }
} 
```

和测试实用程序类

```
public class Test {

    public static final PeriodFormatter PERIOD_FORMATER = new PeriodFormatterBuilder().printZeroAlways().
                    appendHours().appendSeparator(":").
                    appendMinutes().appendSeparator(":").
                    appendSeconds().appendSeparator(".").
                    appendMillis().toFormatter();

    public static DateTime startTime;
    public static boolean isTesting = false;

    static String toString(Duration duration) {

        return duration == null ? "[invalid duration]" : duration.toPeriod().toString(PERIOD_FORMATER);

    }
} 
```

现在，我使用[Joda Time](http://joda-time.sourceforge.net/)来计算持续时间（对不起，我已经为它准备好了代码）

显然，您需要获得自己的图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T05:40:42.483

首先
尝试**注释**`System.out.println`执行任何打印的每个不必要 或任何不必要的语句，`console`因为此类语句也会**减慢**应用程序的速度，我遇到过打印语句**会增加**应用程序响应时间的情况。

其次
尝试[工作线程和摆动工人](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)

# ruby-on-rails - Rails 模型类包含时，Rails 模块未“包含”（生产中）

> ID：12015930
> 
> 赞同：2
> 
> 时间：2012-08-18T04:46:10.143
> 
> 标签：ruby-on-rails, module, include, require, production

这是我的示例 rails 模型类（在 app/models/user.rb 中）：

```
class User < ActiveRecord::Base
  puts "loading user model"
  include Auth::User # module is in the Auth engine
end 
```

这是一个名为 auth 的引擎中的模块（文件位于 vendor/engines/app/models/auth/user.rb 中）

```
module Auth
  module User
    puts "loading module"
    self.included(base)
      puts "module is included"
    end
  end
end 
```

当 rails (3.1.1 ruby​​ 1.92) 启动时（在非开发中），我看到“加载用户模型”和“加载模块”，但没有看到“包含模块”。

如果我将模块的名称和文件名从 models/auth/user.rb 更改为 user_auth.rb，如果模块在 rails init 进程中“足够早”包含，我可能会看到“包含”（见下文）。我想将模块的名称和文件名保留为用户。我认为没有理由必须改变这一点。当我加载 User 模型（以及当 User 模型包含 auth/user 模块时）时，这无关紧要。

注意：当我在上面说“MAY”时，这是我观察到的：如果 rails “碰巧”需要加载 UsersController，那么它将恰好加载 User 对象，并且仅当我重命名用户时才会包含 User 模块模块到 UserAuth（或与模型名称不同的名称）。由于路由，我“碰巧”加载了 UsersController。我知道这一点是因为我打印了一个堆栈跟踪。所以我可以通过 1) 重命名模块和 2) 强制它使用控制器加载来包含模块。

注意：继续...仅当包含它的类在 Rails 启动过程中的某个时间早期加载/需要时才加载该模块。这就是为什么通过强制rails“看到”UsersController（因为加载路由）来强制User模型“提前”加载的原因也将包括auth/user模块。

注意：如果我运行控制台（同样，在非开发模式下）然后执行 require 'user'，则不包含该模块。因此，如果我“等待”直到 rails 完全加载后，当我需要用户时，auth/user 模块不包括在内。我认为这有点不准确，我看到在 rails init 过程中加载了用户模型，我看到正在加载 auth/user 模块，但当时没有看到 auth/user 模块。如果用户模型在 rails init 进程中“早期”加载，我只会看到包含的模块。或者它可能“在 rails init 进程中的某个神奇时间加载）。

任何人都可以解释一下吗？我尝试了许多不同的方法来包含模块，例如打开 User 类并重新包含模块。这似乎有时有效，但并非始终如一。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T10:29:16.643

您可以在类定义之前的第一行将其添加到您的模型中吗？（只是在这里调试，如果这不起作用，请不要对我投反对票）

```
 load "#{Rails.root}/vendor/engines/app/models/auth/user.rb" 
```

# asp.net - ASP.NET MVC 如何对模型的表单进行验证

> ID：12015931
> 
> 赞同：1
> 
> 时间：2012-08-18T04:46:13.257
> 
> 标签：asp.net, asp.net-mvc

我有一个注册表格和一个用户登录表格。我显然想在注册表单上进行验证，但我不想在登录表上进行验证。我注意到它在登录表单上使用 JS 验证内容。IE 它甚至不会尝试提交表单，直到用户输入长度超过 5 的密码（即我在验证中设置的密码）。如何禁用此功能？

登录表单：

```
@using (Html.BeginForm("Login", "Users", FormMethod.Post, new { @class = "well"})) {

        <legend>Login</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.Email)
        </div>
        <div class="editor-field">
            @Html.TextBoxFor(model => model.Email, new { @placeholder = "Email" })
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Password)
        </div>
        <div class="editor-field">
            @Html.TextBoxFor(model => model.Password, new { @placeholder = "Password" })
        </div>

        <label class="checkbox">
            @Html.CheckBoxFor(model => model.HasRememberMeOn) Remember me
        </label>

        if (ViewData["ErrorMessage"] != null)
        {
                <p>@ViewData["ErrorMessage"]</p>
        }
        <p>
            <input type="submit" value="Login" />
        </p>

} 
```

模型：

```
[Required]
        [StringLength(20, MinimumLength=5)]
        [Username(ErrorMessage="Username must: Contain at least one letter, no spaces, no special characters")]
        public string Username { get; set; }

        [NotMapped]
        [StringLength(25, MinimumLength = 5)]
        public string Password { get; set; }

        [Required(ErrorMessage="Password is required")]
        public string HashedPassword { get; set; }

        [Required]
        [StringLength(50, MinimumLength = 3)]
        public string Email { get; set; }

        [NotMapped]
        [Compare("Email", ErrorMessage = "Your emails don't match")]
        [DisplayName("Confirm email")]
        public string Email2 { get; set; }

        public Boolean IsActivated { get; set; }

        [DisplayName("Date joined")]
        public DateTime DateCreated { get; set; }

        [Required]
        [StringLength(50, MinimumLength = 2)]
        [DisplayName("Real name")]
        public string Name { get; set; } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T05:11:52.887

正确的解决方案是在没有必需属性等的情况下为登录表单使用另一个模型。并且您只需要用户名和密码即可登录，因此无论如何使用注册模型都不是一个好主意。

# spring-mvc - 如何从 Spring RequestMapping 注释中获取方法

> ID：12015933
> 
> 赞同：0
> 
> 时间：2012-08-18T04:46:44.397
> 
> 标签：spring-mvc

我写我的控制器和请求映射为

代码：

```
@Controller
public class MyController1
{

    @RequestMapping("abc.do")
    @RequestBody
    public String doAbc()
    {
     ....
    }
} 
```

我想编写一个方法，以便将请求映射字符串作为输入并返回要调用的方法。我怎样才能做到这一点？谢谢。

你们中的一些人可能会认为这一切都是无稽之谈，我同意。只是我们已将所有 Web 代码移至“ajax”，并且仍有用于非 ajax 移动界面的代码。所以我需要某种临时的胶水代码来让所有这些工作直到我们'ajaxify'移动界面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T08:55:13.967

你的问题不是很清楚。如果您想在方法中接受 URI 的一部分作为参数，请参见以下代码。

```
@Controller
public class MyController{
    @RequestMapping("/abc/{id}")
    @ResponseBody
    public String doAbc(@PathVariable("id") String abcId){
        ...
    }
} 
```

# sql-server - 独立安装 SSRS 上的 SQL 代理

> ID：12015936
> 
> 赞同：0
> 
> 时间：2012-08-18T04:47:07.517
> 
> 标签：sql-server, reporting-services, installation

我有三台服务器：

服务器 1 - SQL 2012 - 高可用性集群的主服务器

服务器 2 - SQL 2012 - 高可用性集群的辅助服务器

服务器 3 - 独立 SSRS

服务器 3 正在访问服务器 2 以生成报告。

现在我想在 SSRS 服务器上创建报表订阅，但 SQL 代理服务未安装在服务器 3 上。我找不到任何有关我需要安装哪些功能才能安装该服务的信息。我不想在服务器 3 上安装完整的 SQL 2012，因为它主要充当 Web 服务器。

有谁知道要安装哪些功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T18:07:04.100

您需要安装数据库引擎来安装 SQL Server Agent 和 Management Studio 来管理它。

# c++ - GCC 和 clang (SFINAE) 之间的重载解析行为差异

> ID：12015938
> 
> 赞同：21
> 
> 时间：2012-08-18T04:47:45.467
> 
> 标签：c++, templates, gcc, clang, overload-resolution

GCC 接受以下代码：

```
template <typename T>
struct meta
{
    typedef typename T::type type;
};

struct S {};

template <typename T>
typename meta<T>::type foo(T, S);

int foo(int, int);      

int main()
{
    foo(0, 0);
} 
```

但是 clang 拒绝它并出现以下错误：

```
test.cpp:4:22: error: type 'int' cannot be used prior to '::' because it has no members
    typedef typename T::type type;
                     ^
test.cpp:10:10: note: in instantiation of template class 'meta<int>' requested here
typename meta<T>::type foo(T, S);
         ^
test.cpp:10:24: note: while substituting deduced template arguments into function template 'foo' [with T = int]
typename meta<T>::type foo(T, S);
                       ^ 
```

这似乎表明 GCC 和 clang 在重载解析期间执行某些操作的顺序有所不同。`S`由于第二个参数 ( vs. `int`)中的类型不匹配，GCC 似乎*在*尝试实例化候选模板的返回类型之前丢弃了候选模板，而 clang 似乎以相反的方式进行。

谁是对的？

我相信这个问题对模板库的作者有重要意义。具体来说，如果 clang 是正确的，那么模板的作者`foo`将不得不做额外的工作来将错误转化为替换失败。

**编辑**：请注意，GCC和clang都拒绝了以下稍微简单的示例，并出现类似的错误：

```
template <typename T>
struct meta
{
    typedef typename T::type type;
};

template <typename T>
typename meta<T>::type foo(T);

int foo(int);      

int main()
{
    foo(0);
} 
```

暗示 GCC 知道“只有在函数类型及其模板参数类型的直接上下文中的无效类型和表达式才会导致推导失败”。此示例与原始示例之间的区别在于原始示例中存在第二个函数参数，基于此，GCC 在尝试对返回类型执行替换之前就抛出了候选模板。我认为问题是，GCC 按该顺序执行操作是否正确，或者它是否应该在考虑参数类型匹配之前尝试对返回类型执行替换。

**更新**： Luc Danton 的回答让我相信 clang 拒绝代码是正确的。我相应地[提交了一个 GCC 错误](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=54310)。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-07-07T06:00:16.267

Clang 和 g++ 在这里都是正确的。

根据 Luc Danton 的回答，允许编译器为`T = int`函数`foo`模板进行推断。然后，在将该值替换为 的声明期间`foo`，需要隐式实例化`meta<int>`，这会导致替换的直接上下文之外的错误（因此 SFINAE 不适用）。所以 Clang 拒绝这个代码是正确的。

但是，*[temp.inst]p7*说：

> 如果重载决策过程可以在不实例化类模板定义的情况下确定要调用的正确函数，则未指定该实例化是否实际发生。

因为非模板`foo`与调用中的参数完全匹配，所以编译器可以确定函数模板特化永远不会是最佳可行函数，因此不需要执行参数推导和替换。因此 g++ 不拒绝此代码是正确的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-18T05:17:10.727

C++03 使用此措辞作为通常称为 SFINAE 的规范的一部分（14.8.2 模板参数推导 [temp.deduct]，第 2 段）：

> [...]如果模板参数或函数模板的函数类型中的替换导致类型无效，则类型推导失败。[...]

相比之下，C++11 使用这种措辞（14.8.2 模板参数推导 [temp.deduct]，第 8 段）：

> 如果替换导致无效的类型或表达式，则类型推导失败。[...] 只有在函数类型及其模板参数类型**的直接上下文**中的无效类型和表达式才会导致推导失败。[...]

重点是我的。据我了解，C++11 中的措辞得到了改进，以明确概述应该导致 SFINAE（所谓的软错误）和不应该导致什么（硬错误）的内容。[这篇 2008 年的论文](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2634.html)是当时正在进行的讨论的一个例子，并导致了当前的规则。

考虑到这一点，根据 C++03 的实现可能正确地接受您的代码（甚至可能应该）。但是，我怀疑 C++11 实现应该拒绝它：错误 ( `int::type`) 在 的上下文中`meta<int>`，而不是在`foo<int>`.

# asp.net-mvc - 如何使用 dataSource 或 json 动态加载 kendoMenu

> ID：12015939
> 
> 赞同：0
> 
> 时间：2012-08-18T04:48:14.780
> 
> 标签：asp.net-mvc, visual-studio-2010, kendo-ui

我想使用 kendoMenu。我想动态加载带有父字段和子字段的菜单。谁能告诉我如何使用 json/datasource 动态加载 kendoMenu？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T06:05:07.113

Kendo 菜单当前不支持分层数据源。您可以使用 JSON 对象动态初始化它，如下所示：
[http ://docs.kendoui.c​​om/getting-started/web/menu/overview#initialize-the-menu-using-json-data-object](http://docs.kendoui.com/getting-started/web/menu/overview#initialize-the-menu-using-json-data-object)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-09T21:24:56.130

这对于 Bundyo 的回答可能是多余的，但谁不喜欢例子呢？:) 这对我有用：

```
$.get("remoteMenu.php", function(data) {
    $("#menu").kendoMenu({
        dataSource: data
    });
}); 
```

其中，“remoteMenu.php”返回一个 JSON 对象，如：

```
[{"text":"Baseball","url":"requests","imageUrl":"http:\/\/demos.kendoui.com\/content\/shared\/icons\/sports\/baseball.png"},{"text":"Golf","url":"agencies","imageUrl":"http:\/\/demos.kendoui.com\/content\/shared\/icons\/sports\/golf.png"}] 
```

# postgresql - 从 hstore 的所有行中检索唯一键列表的最有效方法？

> ID：12015942
> 
> 赞同：19
> 
> 时间：2012-08-18T04:48:30.427
> 
> 标签：postgresql, postgresql-9.1, hstore

为简单起见，假设我有一个表，其中有一列只是一个 hstore。从 hstore 的所有行中获取所有键的唯一列表的最有效方法是什么？

例如。

```
my_hstore
------------
a=>1,b=>2
b=>2,c=>3
x=>10,y=>11
y=>11,z=12 
```

检索包含 (a,b,c,x,y,z) 的列表/数组/集合的最有效方法是什么？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-18T05:00:59.730

总是有直接的[`skeys`](http://www.postgresql.org/docs/current/static/hstore.html#HSTORE-FUNC-TABLE)方法：

```
select distinct k
from (
    select skeys(my_hstore) as k
    from your_table
) as dt 
```

如果你需要一个数组，那么添加一个[`array_agg`](http://www.postgresql.org/docs/current/static/functions-aggregate.html#FUNCTIONS-AGGREGATE-TABLE)：

```
select array_agg(distinct k)
from (
    select skeys(my_hstore) as k
    from your_table
) as dt 
```

# ios - 相同的 iOS 应用程序功能，不同的名称

> ID：12015948
> 
> 赞同：3
> 
> 时间：2012-08-18T04:50:29.653
> 
> 标签：ios, app-store, white-labelling

我有一个使用 WebService 并做一些工作的应用程序，我的问题是，我可以上传相同的应用程序（更改 WS 链接后）但名称不同吗？

我宁愿从一些用户那里得到关于垃圾邮件或其他东西的答案，但事实并非如此，这个想法是商业方面的，每个客户（这里的客户不是 iOS 用户，它是一家独立的公司）都想购买我的App，给我他的WS URL，我就改个WS URL，把公司的图标和名字，给他的公司做一个包，，，

希望能得到这方面的帮助。

谢谢，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-18T05:07:47.913

只要您介意提交率，您就应该能够做到这一点。在垃圾邮件说明中，如果您不小心，您将被拒绝。

为了避免这种情况，您需要尽可能多地更改应用程序。至少颜色/图形方案（应用范围）。

> 2.20：开发者在 App Store 上“发送垃圾邮件”包含多个版本的类似应用程序将从 iOS 开发者计划中移除

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T00:51:59.403

经过几次测试（包括从 App Store 安装原始应用程序，然后尝试使用不同名称测试新应用程序），它总是安装在相同的旧应用程序上，因此您不能在相同的配置文件上执行此操作，只需更改构建设置上的名称...

您必须使用新的 Bundle ID 创建一个不同的新配置文件并在构建中使用它，因此每个构建都将被视为一个新的和唯一的构建......

不过谢谢你的帮助..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T05:07:10.443

我认为如果您更改 URL 和图标就可以了。如果您可以添加自定义启动屏幕和/或如果您也可以修改应用程序的配色方案，那就太好了。

# html - IE 中丢失的样式

> ID：12015949
> 
> 赞同：0
> 
> 时间：2012-08-18T04:50:47.773
> 
> 标签：html, css, internet-explorer, cross-browser

最近我一直在做一个体面的项目（至少对我来说），我刚刚被委派了浏览器测试的任务，除了 IE 一切都很好。只是缺少一些样式，例如它选择并选择它想要的样式，但是通过不加载这些特定样式，它破坏了很多 jquery。是否存在已知问题？有哪些修复？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T04:50:47.773

所以事实证明，在这个网站上，我们有 35 个样式表，在 IE 中满足以下条件。

如果标签超过 31 个`<style>`，则只会编译前 31 个。除此之外的任何内容都将被忽略，Web 控制台不会发出警告。

只会计算前 4095 条样式规则，之后的任何内容都将被忽略。

`@import`使用嵌套深度超过 3 的样式表将被忽略。

一个简单的解决方法是在页面加载服务器端脚本之前将您的样式表减少为一个样式表。

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T11:25:38.993

此外，IE 可以缓存您的样式表。今天我被一个 CSS 问题逼疯了，我的新类没有被控件占用。IE 缓存了主 CSS 文件的旧版本。我发现在 IE 中使用 F12 开发人员工具，它有一个 CSS 选项卡，可以显示所有已加载的样式 - 我在内存中有旧样式，没有新样式。IE，你这件艺术品……

# yesod - 可以在 yesod 中的 Warp 用于托管 CGI 应用程序吗？

> ID：12015951
> 
> 赞同：0
> 
> 时间：2012-08-18T04:50:56.850
> 
> 标签：yesod, warp

一个旧的 python CGI 应用程序现在在带有 cgimod 扩展的 ocsigen 下运行。warp 是否仅通过一些配置支持 CGI 应用程序？

任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T21:49:33.850

现在我正在使用可以很好地运行 CGI 的 maytpd2。

问候！

# hibernate - 休眠会话工厂范围

> ID：12015952
> 
> 赞同：0
> 
> 时间：2012-08-18T04:51:01.250
> 
> 标签：hibernate

Web 应用程序中 Hibernate 会话工厂的范围应该是什么？我猜 HTTP 会话范围，对吗？

上下文：我有一个使用 Hibernate 的 Spring Web 应用程序。我继承了多年的代码，而老开发人员很久以前就离开了。该代码似乎正在为应用程序使用全局休眠会话工厂。这对我来说似乎不对，因为这一次只允许一个用户与数据库交谈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T07:15:54.890

应该是应用范围。Sessionfactory 就像一个连接池，它为你生成 Hibernate 会话。它是一个昂贵的创建对象，您不应在应用程序生命周期内多次创建它。每个请求都从会话工厂获取会话，并通过会话而不是通过会话工厂执行每个数据库操作。

# sql-server-2008 - 为什么以毫秒为单位的 GETDATE() 和 SYSDATETIME() 之间的 Datediff 总是不同的？

> ID：12015953
> 
> 赞同：0
> 
> 时间：2012-08-18T04:51:08.437
> 
> 标签：sql-server-2008, datediff, getdate, sysdatetime

我试图以毫秒为单位`Datediff`。`GETDATE()``SYSDATETIME()`

```
SELECT DATEDIFF(ms, GETDATE() , SYSDATETIME()); 
```

我得到的结果是`0`or `1`or `2`or `3`。造成这种差异的原因是什么？

[看到这个小提琴](http://www.sqlfiddle.com/#!3/cfab1/12)。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-18T09:31:16.143

它们是两个不同的函数调用，可以返回两个不同的时间。

另外`GETDATE`返回一个`datetime`只有 3-4 毫秒精度的数据类型，而`SYSDATETIME()`返回一个`datetime2(7)`数据类型。

即使两个调用在完全相同的时间返回，您也可以看到由于四舍五入而遇到的问题。

```
DECLARE @D1 DATETIME2 = '2012-08-18 10:08:40.0650000'
DECLARE @D2 DATETIME = @D1 /*Rounded to 2012-08-18 10:08:40.067*/
SELECT DATEDIFF(ms, @D1 , @D2) /*Returns 2*/ 
```

另一个答案是不正确的，如果你在`GETDATE()`函数中替换只调用一次，如下所示。

```
WHILE DATEDIFF(ms, GETDATE() , GETDATE()) = 0 
PRINT 'This will not run in an infinite loop' 
```

在我的 Windows XP 桌面上运行循环时`GETDATE()`，`SYSDATETIME`我还可以看到结果表明可能还会发生其他事情。也许调用不同的 API。

```
CREATE TABLE #DT2
  (
     [D1] [DATETIME2](7),
     [D2] [DATETIME2](7)
  )

GO

INSERT INTO #DT2
VALUES(Getdate(), Sysdatetime())

GO 100

SELECT DISTINCT [D1],
                [D2],
                Datediff(MS, [D1], [D2]) AS MS
FROM   #DT2

DROP TABLE #DT2 
```

下面的示例结果

```
+-----------------------------+-----------------------------+-----+
|             D1              |             D2              | MS  |
+-----------------------------+-----------------------------+-----+
| 2012-08-18 10:16:03.2500000 | 2012-08-18 10:16:03.2501680 |   0 |
| 2012-08-18 10:16:03.2530000 | 2012-08-18 10:16:03.2501680 |  -3 |
| 2012-08-18 10:16:03.2570000 | 2012-08-18 10:16:03.2501680 |  -7 |
| 2012-08-18 10:16:03.2600000 | 2012-08-18 10:16:03.2501680 | -10 |
| 2012-08-18 10:16:03.2630000 | 2012-08-18 10:16:03.2501680 | -13 |
| 2012-08-18 10:16:03.2630000 | 2012-08-18 10:16:03.2657914 |   2 |
| 2012-08-18 10:16:03.2670000 | 2012-08-18 10:16:03.2657914 |  -2 |
| 2012-08-18 10:16:03.2700000 | 2012-08-18 10:16:03.2657914 |  -5 |
| 2012-08-18 10:16:03.2730000 | 2012-08-18 10:16:03.2657914 |  -8 |
| 2012-08-18 10:16:03.2770000 | 2012-08-18 10:16:03.2657914 | -12 |
| 2012-08-18 10:16:03.2800000 | 2012-08-18 10:16:03.2814148 |   1 |
+-----------------------------+-----------------------------+-----+ 
```

感兴趣的行是

```
| 2012-08-18 10:16:03.2600000 | 2012-08-18 10:16:03.2501680 | -10 |
| 2012-08-18 10:16:03.2630000 | 2012-08-18 10:16:03.2501680 | -13 | 
```

这种差异太大而不能成为一个舍入问题，并且不能只是一个时间问题，因为该问题存在于多个报告的行上，而报告的两个函数`GETDATE`之间`10:16:03.26X`存在`SYSDATETIME`延迟`10:16:03.250`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T05:26:18.180

它们不同是因为这两个函数不能同时（同时）调用。运行的其他进程可能会影响时间。它们可能因数量不同而不同的原因有很多。

如果你用两次调用来做同样的事情`GetDate()`，它们不会产生任何差异，因为数据库引擎足够聪明，可以确定它们是相同的事情并重用结果。但是，使用`GetDate()`and`SysDateTime()`是不同的，因为它们不是相同的代码路径（它们做不同的事情）。

可以这样想：如果你看到`1 + 2`and `1 + 2`，很容易看出第一个表达式和第二个表达式是一样的，所以你只需要计算一次。如果将其更改为`1 + Rand()`and `1 + Rand()`，您将无法知道这两个不同的调用`Rand()`将返回什么，因此您必须分别进行计算。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-02-06T19:26:15.227

这种差异是 PRECISION 和 RESOLUTION 之间差异的一个很好的例子（让我们暂时将 ACCURACY 放在一边）。GETDATE() 返回一个带有（显然）精确到毫秒的 DATETIME，但是，如果你把它放在一个紧密的循环中，你会发现返回的下一个不同的值是几毫秒后；它每秒只能返回大约 300 个不同的值，因为它的分辨率只有大约 3 或 4 毫秒。[在此处阅读有关此内容](https://msdn.microsoft.com/en-us/library/ms187819.aspx#Anchor_2)的更多信息这是 DATETIME 数据类型的设计功能/妥协。

# android - 从 SOAP WSDL 获取名称空间、方法名称？

> ID：12015956
> 
> 赞同：0
> 
> 时间：2012-08-18T04:52:05.560
> 
> 标签：android, web-services, wsdl

我想找出女巫一是目标名称空间，女巫一是给定`WSDL`文件中的方法名称。
我的`WSDL`文件如下：

```
 <wsdl:definitions xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:wsoap12="http://schemas.xmlsoap.org/wsdl/soap12/" xmlns:http="http://schemas.xmlsoap.org/wsdl/http/" xmlns:mime="http://schemas.xmlsoap.org/wsdl/mime/" xmlns:tns="urn:sap-com:document:sap:soap:functions:mc-style" xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:n1="urn:sap-com:document:sap:rfc:functions" targetNamespace="urn:sap-com:document:sap:soap:functions:mc-style">
    <wsdl:documentation>
    <sidl:sidl xmlns:sidl="http://www.sap.com/2007/03/sidl"/>
    </wsdl:documentation>
    <wsp:UsingPolicy wsdl:required="true"/>
    <wsp:Policy wsu:Id="BN_BN_Z_CUSTOMER_LOOKUP1_BIND">
    <saptrnbnd:OptimizedXMLTransfer xmlns:saptrnbnd="http://www.sap.com/webas/710/soap/features/transportbinding/" uri="http://xml.sap.com/2006/11/esi/esp/binxml" wsp:Optional="true"/>
    <saptrnbnd:OptimizedMimeSerialization xmlns:saptrnbnd="http://schemas.xmlsoap.org/ws/2004/09/policy/optimizedmimeserialization" wsp:Optional="true"/>
    <wsp:ExactlyOne xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy">
    <wsp:All>
    <sp:TransportBinding xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:sapsp="http://www.sap.com/webas/630/soap/features/security/policy" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:wst="http://docs.oasis-open.org/ws-sx/ws-trust/200512" xmlns:wsu="http://schemas.xmlsoap.org/ws/2002/07/utility" xmlns:wsx="http://schemas.xmlsoap.org/ws/2004/09/mex">
    <wsp:Policy>
    <sp:TransportToken>
    <wsp:Policy>
    <sp:HttpsToken>
    <wsp:Policy>
    <sp:HttpBasicAuthentication/>
    </wsp:Policy>
    </sp:HttpsToken>
    </wsp:Policy>
    </sp:TransportToken>
    <sp:AlgorithmSuite>
    <wsp:Policy>
    <sp:Basic128Rsa15/>
    </wsp:Policy>
    </sp:AlgorithmSuite>
    <sp:Layout>
    <wsp:Policy>
    <sp:Strict/>
    </wsp:Policy>
    </sp:Layout>
    </wsp:Policy>
    </sp:TransportBinding>
    </wsp:All>
    </wsp:ExactlyOne>
    <wsaw:UsingAddressing xmlns:wsaw="http://www.w3.org/2006/05/addressing/wsdl" wsp:Optional="true"/>
    </wsp:Policy>
    <wsp:Policy wsu:Id="BN_BN_Z_CUSTOMER_LOOKUP1_BIND_SOAP12">
    <saptrnbnd:OptimizedXMLTransfer xmlns:saptrnbnd="http://www.sap.com/webas/710/soap/features/transportbinding/" uri="http://xml.sap.com/2006/11/esi/esp/binxml" wsp:Optional="true"/>
    <saptrnbnd:OptimizedMimeSerialization xmlns:saptrnbnd="http://schemas.xmlsoap.org/ws/2004/09/policy/optimizedmimeserialization" wsp:Optional="true"/>
    <wsp:ExactlyOne xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy">
    <wsp:All>
    <sp:TransportBinding xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:sapsp="http://www.sap.com/webas/630/soap/features/security/policy" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:wst="http://docs.oasis-open.org/ws-sx/ws-trust/200512" xmlns:wsu="http://schemas.xmlsoap.org/ws/2002/07/utility" xmlns:wsx="http://schemas.xmlsoap.org/ws/2004/09/mex">
    <wsp:Policy>
    <sp:TransportToken>
    <wsp:Policy>
    <sp:HttpsToken>
    <wsp:Policy>
    <sp:HttpBasicAuthentication/>
    </wsp:Policy>
    </sp:HttpsToken>
    </wsp:Policy>
    </sp:TransportToken>
    <sp:AlgorithmSuite>
    <wsp:Policy>
    <sp:Basic128Rsa15/>
    </wsp:Policy>
    </sp:AlgorithmSuite>
    <sp:Layout>
    <wsp:Policy>
    <sp:Strict/>
    </wsp:Policy>
    </sp:Layout>
    </wsp:Policy>
    </sp:TransportBinding>
    </wsp:All>
    </wsp:ExactlyOne>
    <wsaw:UsingAddressing xmlns:wsaw="http://www.w3.org/2006/05/addressing/wsdl" wsp:Optional="true"/>
    </wsp:Policy>
    <wsp:Policy wsu:Id="IF_IF_Z_CUSTOMER_LOOKUP1">
    <sapsession:Session xmlns:sapsession="http://www.sap.com/webas/630/soap/features/session/">
    <sapsession:enableSession>false</sapsession:enableSession>
    </sapsession:Session>
    <sapcentraladmin:CentralAdministration xmlns:sapcentraladmin="http://www.sap.com/webas/700/soap/features/CentralAdministration/" wsp:Optional="true">
    <sapcentraladmin:BusinessApplicationID>0018FE7972821DEFB0CD97950B095362</sapcentraladmin:BusinessApplicationID>
    </sapcentraladmin:CentralAdministration>
    </wsp:Policy>
    <wsp:Policy wsu:Id="OP_IF_OP_Z_GET_CUST_GEN">
    <sapcomhnd:enableCommit xmlns:sapcomhnd="http://www.sap.com/NW05/soap/features/commit/">false</sapcomhnd:enableCommit>
    <sapblock:enableBlocking xmlns:sapblock="http://www.sap.com/NW05/soap/features/blocking/">true</sapblock:enableBlocking>
    <saptrhnw05:required xmlns:saptrhnw05="http://www.sap.com/NW05/soap/features/transaction/">no</saptrhnw05:required>
    <saprmnw05:enableWSRM xmlns:saprmnw05="http://www.sap.com/NW05/soap/features/wsrm/">false</saprmnw05:enableWSRM>
    </wsp:Policy>
    <wsdl:types>
    <xsd:schema attributeFormDefault="qualified" targetNamespace="urn:sap-com:document:sap:rfc:functions">
    <xsd:simpleType name="char10">
    <xsd:restriction base="xsd:string">
    <xsd:maxLength value="10"/>
    </xsd:restriction>
    </xsd:simpleType>
    <xsd:simpleType name="char3">
    <xsd:restriction base="xsd:string">
    <xsd:maxLength value="3"/>
    </xsd:restriction>
    </xsd:simpleType>
    <xsd:simpleType name="char35">
    <xsd:restriction base="xsd:string">
    <xsd:maxLength value="35"/>
    </xsd:restriction>
    </xsd:simpleType>
    <xsd:simpleType name="char40">
    <xsd:restriction base="xsd:string">
    <xsd:maxLength value="40"/>
    </xsd:restriction>
    </xsd:simpleType>
    <xsd:simpleType name="lang">
    <xsd:restriction base="xsd:string">
    <xsd:maxLength value="1"/>
    </xsd:restriction>
    </xsd:simpleType>
    </xsd:schema>
    <xsd:schema xmlns:n0="urn:sap-com:document:sap:rfc:functions" attributeFormDefault="qualified" targetNamespace="urn:sap-com:document:sap:soap:functions:mc-style">
    <xsd:import namespace="urn:sap-com:document:sap:rfc:functions"/>
    <xsd:complexType name="ZcustomerSt">
    <xsd:sequence>
    <xsd:element name="Kunnr" type="n0:char10"/>
    <xsd:element name="Name1" type="n0:char35"/>
    <xsd:element name="City" type="n0:char35"/>
    <xsd:element name="Land" type="n0:char3"/>
    <xsd:element name="Pstlz" type="n0:char10"/>
    </xsd:sequence>
    </xsd:complexType>
    <xsd:complexType name="ZcustomerTt">
    <xsd:sequence>
    <xsd:element name="item" type="tns:ZcustomerSt" minOccurs="0" maxOccurs="unbounded"/>
    </xsd:sequence>
    </xsd:complexType>
    <xsd:element name="Z_GET_CUST_GEN">
    <xsd:complexType>
    <xsd:sequence>
    <xsd:element name="Input" type="n0:char40" minOccurs="0"/>
    <xsd:element name="Langu" type="n0:lang" minOccurs="0"/>
    <xsd:element name="Max" type="xsd:int" minOccurs="0"/>
    </xsd:sequence>
    </xsd:complexType>
    </xsd:element>
    <xsd:element name="Z_GET_CUST_GENResponse">
    <xsd:complexType>
    <xsd:sequence>
    <xsd:element name="ZCustGen" type="tns:ZcustomerTt"/>
    </xsd:sequence>
    </xsd:complexType>
    </xsd:element>
    </xsd:schema>
    </wsdl:types>
    <wsdl:message name="Z_GET_CUST_GEN">
    <wsdl:part name="parameters" element="tns:Z_GET_CUST_GEN"/>
    </wsdl:message>
    <wsdl:message name="Z_GET_CUST_GENResponse">
    <wsdl:part name="parameter" element="tns:Z_GET_CUST_GENResponse"/>
    </wsdl:message>
    <wsdl:portType name="Z_CUSTOMER_LOOKUP1">
    <wsdl:documentation>
    <sapdoc:sapdoc xmlns:sapdoc="urn:sap:esi:documentation">
    <sapdoc:docitem docURL="http://NW73-BI-PC.ecc.corp:8000/sap/bc/esdt/docu/sd_text?sap-client=800&sd_name=Z_CUSTOMER_LOOKUP1"/>
    </sapdoc:sapdoc>
    </wsdl:documentation>
    <wsp:Policy>
    <wsp:PolicyReference URI="#IF_IF_Z_CUSTOMER_LOOKUP1"/>
    </wsp:Policy>
    <wsdl:operation name="Z_GET_CUST_GEN">
    <wsp:Policy>
    <wsp:PolicyReference URI="#OP_IF_OP_Z_GET_CUST_GEN"/>
    </wsp:Policy>
    <wsdl:input message="tns:Z_GET_CUST_GEN"/>
    <wsdl:output message="tns:Z_GET_CUST_GENResponse"/>
    </wsdl:operation>
    </wsdl:portType>
    <wsdl:binding name="Z_CUSTOMER_LOOKUP1_BIND" type="tns:Z_CUSTOMER_LOOKUP1">
    <wsp:Policy>
    <wsp:PolicyReference URI="#BN_BN_Z_CUSTOMER_LOOKUP1_BIND"/>
    </wsp:Policy>
    <soap:binding transport="http://schemas.xmlsoap.org/soap/http" style="document"/>
    <wsdl:operation name="Z_GET_CUST_GEN">
    <soap:operation style="document"/>
    <wsdl:input>
    <soap:body use="literal"/>
    </wsdl:input>
    <wsdl:output>
    <soap:body use="literal"/>
    </wsdl:output>
    </wsdl:operation>
    </wsdl:binding>
    <wsdl:binding name="Z_CUSTOMER_LOOKUP1_BIND_SOAP12" type="tns:Z_CUSTOMER_LOOKUP1">
    <wsp:Policy>
    <wsp:PolicyReference URI="#BN_BN_Z_CUSTOMER_LOOKUP1_BIND_SOAP12"/>
    </wsp:Policy>
    <wsoap12:binding transport="http://schemas.xmlsoap.org/soap/http" style="document"/>
    <wsdl:operation name="Z_GET_CUST_GEN">
    <wsoap12:operation style="document"/>
    <wsdl:input>
    <wsoap12:body use="literal"/>
    </wsdl:input>
    <wsdl:output>
    <wsoap12:body use="literal"/>
    </wsdl:output>
    </wsdl:operation>
    </wsdl:binding>
    <wsdl:service name="Z_CUSTOMER_LOOKUP1">
    <wsdl:port name="Z_CUSTOMER_LOOKUP1_BIND" binding="tns:Z_CUSTOMER_LOOKUP1_BIND">
    <soap:address location="http://NW73-BI-http://**********:******/sap/bc/srt/rfc/sap/z_customer_lookup1/800/z_customer_lookup1/z_customer_lookup1_bind"/>
    </wsdl:port>
    <wsdl:port name="Z_CUSTOMER_LOOKUP1_BIND_SOAP12" binding="tns:Z_CUSTOMER_LOOKUP1_BIND_SOAP12">
    <wsoap12:address location="http://**********:******/sap/bc/srt/rfc/sap/z_customer_lookup1/800/z_customer_lookup1/z_customer_lookup1_bind"/>
    </wsdl:port>
    </wsdl:service>
    </wsdl:definitions> 
```

通过使用上面`WSDL`的代码，我编写了以下代码来调用 Android 中的 SOAP WebService：

```
package com.venkattt.pack;

import java.net.SocketException;

import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapPrimitive;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;

import android.app.Activity;
import android.os.Bundle;

public class SoapWebservicesExampleActivity extends Activity {
    /** Called when the activity is first created. */
      final String NAMESPACE = "urn:sap-com:document:sap:rfc:functions";
     final String URL = "http://**********:******/sap/bc/srt/wsdl/srvc_14DAE9C8D79F1EE196F1FC6C6518A345/wsdl11/allinone/ws_policy/document?sap-client=800&sap-user=********&sap-password=********";
      final String METHOD_NAME = "Z_GET_CUST_GEN";
     final String SOAP_ACTION = "urn:sap-com:document:sap:rfc:functions/Z_GET_CUST_GEN";
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

            SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);// set up
            request.addProperty("Langu", "d");
            SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER12); // put all required data into a soap
            envelope.dotNet = false;
            envelope.setOutputSoapObject(request);
            HttpTransportSE httpTransport = new HttpTransportSE(URL);
            httpTransport.debug = true; 
            try {
                             httpTransport.call(SOAP_ACTION, envelope);
                 //Object result = (Object) envelope.getResponse();

                 SoapObject result=(SoapObject) envelope.bodyIn;

                 for(int i=0; i<result.getPropertyCount(); i++)
                 {
                    SoapObject obj3 =(SoapObject) result.getProperty(0);
                    System.out.println("theeeeeeeeee"+obj3);

                 }
                                 }
            catch(SocketException ex){
                    ex.printStackTrace();
                } catch (Exception e) {
                   e.printStackTrace();
                }
        }
    } 
```

当我运行这个示例时，我的应用程序进入调试模式

```
SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME); 
```

我如何通过在 Android 中调用此服务。
提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T05:08:36.193

您的目标**命名空间**是：

```
targetNamespace="urn:sap-com:document:sap:rfc:functions" 
```

**方法**是 _

```
"Z_GET_CUST_GEN" 
```

# perl - Perl Tk 活动窗口

> ID：12015957
> 
> 赞同：1
> 
> 时间：2012-08-18T04:52:09.483
> 
> 标签：perl, tk

我在 Windows 7 上创建了一个计划任务，它以指定的时间间隔运行批处理文件。

该批处理文件依次调用 Perl 脚本。在 Perl 脚本中，根据结果，我使用 Perl Tk 显示一个弹出消息，该消息给出一个警报。

现在，当我在我的机器上执行一些其他任务时，例如浏览 Internet，浏览器窗口将成为活动窗口。在这之间，计划任务运行并且不显示弹出窗口，而是将其最小化并显示在任务栏上。

请注意，我正在使用来自 ntwind 的 htstart.exe，以避免在计划任务运行时显示控制台窗口（否则，每次计划任务运行时都会显示 taskeng.exe）。

为了使我的 Perl Tk 窗口成为活动窗口，我正在创建如下所示的窗口：

```
$mw = MainWindow->new(-background => 'blue');
$mw->focus(-force);
$mw->geometry("200x200");
$mw->title("Message"); 
```

我已设置焦点选项，以便此窗口变为活动状态。

现在，当计划任务运行时，我在设置焦点选项后观察到的唯一区别是，Tk 窗口出现在任务栏中并且一直闪烁（可能是因为它现在被设置为活动窗口）。

我如何确保它在显示时出现在前台并且不会最小化到任务栏？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T06:46:11.193

您不能在 Windows 上始终如一地执行此操作。问题在于，在所有情况下，[对操作系统的底层调用](http://msdn.microsoft.com/en-us/library/ms633539%28VS.85%29.aspx)都不会强制将焦点放在特定窗口上。从该页面：

> 系统限制哪些进程可以设置前台窗口。只有当下列条件之一为真时，进程才能设置前台窗口：
> 
> *   该进程是前台进程。
> *   该进程由前台进程启动。
> *   进程收到最后一个输入事件。
> *   没有前台进程。
> *   正在调试前台进程。
> *   前景未锁定（请参阅`LockSetForegroundWindow`）。
> *   前台锁定超时已过期（参见 参考资料`SPI_GETFOREGROUNDLOCKTIMEOUT`）`SystemParametersInfo`。
> *   没有菜单处于活动状态。
> 
> 当用户正在使用另一个窗口时，应用程序不能将一个窗口强制到前台。相反，Windows 会闪烁窗口的任务栏按钮以通知用户。

从用户的角度来看，这很有意义。让弹出窗口窃取您的焦点*非常*烦人，因为它可能导致错误的击键。但这确实意味着您想要做的事情不会起作用（*也不应该起作用*），因此您将不得不忍受它。

# php - 在 PHP 中，为什么我们使用 crypt() 而不是 hash() 来进行密码散列？

> ID：12015958
> 
> 赞同：1
> 
> 时间：2012-08-18T04:52:26.830
> 
> 标签：php, hash, naming, crypt

> **可能重复：**
> [hash() 与 crypt() 函数比较](https://stackoverflow.com/questions/10281373/hash-vs-crypt-function-comparison)

最近我研究了如何在 PHP 中正确地进行密码散列。更好的选择之一是使用`crypt()`. 但是我们为什么不使用`hash()`呢？

我问这个的主要原因是因为我做了一个密码散列函数，`crypt()`我想知道给我的函数起什么名字。现在它被命名为`getHash()`. 但我觉得用这个名字很有趣，因为我在包装`crypt()`。如果我使用`getCrypt()`它听起来也不是很好，因为它是一个哈希函数。我应该将我的散列函数命名为什么`crypt()`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T04:58:49.030

所使用的散列`hash`是为了验证数据（如文件），通常作为校验和之类的东西。它*很快*，这就是我们不将它用于安全数据的原因。

Crypt（正确使用时）使用慢散列算法。慢速散列算法之所以重要，是因为它使某人难以暴力破解散列。如果慢散列算法比快速散列算法花费的时间甚至多 0.1 毫秒，那么尝试 10000 个密码将需要一秒钟，当然，暴力破解需要数百万次尝试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T04:57:47.497

我认为我们最终在这里得到的是，一些 crypts 被设计为较慢，而 hash() 相比之下相对较快。算法越慢，黑客就越能暴力破解您的密码。可悲的是，越慢越好……在某种程度上:)

# android - Android Opengl 图形故障

> ID：12015963
> 
> 赞同：2
> 
> 时间：2012-08-18T04:54:13.427
> 
> 标签：android, opengl-es, 2d

在 android 上使用 Opengl 2.0 我正在尝试创建一个类来帮助我从纹理图集中绘制方形精灵。我遇到了一些奇怪的图形故障（有时线条/正方形缺少表单纹理），尤其是当设备从睡眠中恢复时。

以下是它的外观：

[![](../Images/4052163fcd340f7285dd7d5e8e9d5590.png "由 imgur.com 主办")](https://imgur.com/sVLqD)

以下是从睡眠中唤醒手机后出现问题的示例：

[![](../Images/0dcbe00bda8832a6cf745411a6943b36.png "由 imgur.com 主办")](https://imgur.com/KiDLl)

和我的渲染器代码。

```
package com.krazy.androidopengl;

import java.nio.ByteBuffer;
import java.nio.ByteOrder;
import java.nio.FloatBuffer;
import javax.microedition.khronos.egl.EGLConfig;
import javax.microedition.khronos.opengles.GL10;

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.opengl.GLES20;
import android.opengl.GLSurfaceView;
import android.opengl.GLUtils;
import android.opengl.Matrix;
import android.os.SystemClock;

public class GameRenderer implements GLSurfaceView.Renderer 
{   
private int spriteWidth, spriteHeight;
private int spriteRows,spriteColumns;

private Bitmap atlas;

private float mScale;

private float[] spritePositionData = new float[12];
private float[] cubeTextureCoordinateData = new float[12];

/** Used for debug logs. */
private static final String TAG = "LessonFourRenderer";

private final Context mActivityContext;

/**
 * Store the model matrix. This matrix is used to move models from object space (where each model can be thought
 * of being located at the center of the universe) to world space.
 */
private float[] mModelMatrix = new float[16];

/**
 * Store the view matrix. This can be thought of as our camera. This matrix transforms world space to eye space;
 * it positions things relative to our eye.
 */
private float[] mViewMatrix = new float[16];

/** Store the projection matrix. This is used to project the scene onto a 2D viewport. */
private float[] mProjectionMatrix = new float[16];

/** Allocate storage for the final combined matrix. This will be passed into the shader program. */
private float[] mMVPMatrix = new float[16];

/** Store our model data in a float buffer. */
private FloatBuffer mCubePositions;
private FloatBuffer mCubeTextureCoordinates;

/** This will be used to pass in the transformation matrix. */
private int mMVPMatrixHandle;

/** This will be used to pass in the modelview matrix. */
private int mMVMatrixHandle;

/** This will be used to pass in the texture. */
private int mTextureUniformHandle;

/** This will be used to pass in model position information. */
private int mPositionHandle;

/** This will be used to pass in model texture coordinate information. */
private int mTextureCoordinateHandle;

/** How many bytes per float. */
private final int mBytesPerFloat = 4;   

/** Size of the position data in elements. */
private final int mPositionDataSize = 3;    

/** Size of the texture coordinate data in elements. */
private final int mTextureCoordinateDataSize = 2;

/** This is a handle to our cube shading program. */
private int mProgramHandle;

/** This is a handle to our texture data. */
private int mTextureDataHandle;

/**
 * Initialize the model data.
 */

private Drawer drawer;

public GameRenderer(final Context activityContext, Drawer d)
{   

    mActivityContext = activityContext;

    drawer = d;

}

@Override
public void onSurfaceCreated(GL10
        glUnused, EGLConfig config) 
{
    // Set the background clear color to black.
    GLES20.glClearColor(0.0f, 0.0f, 0.0f, 0.0f);

    // Use culling to remove back faces.
    GLES20.glEnable(GLES20.GL_CULL_FACE);

    // Enable depth testing
    GLES20.glEnable(GLES20.GL_DEPTH_TEST);

    // Enable texture mapping
    GLES20.glEnable(GLES20.GL_TEXTURE_2D);

    // Position the eye in front of the origin.
    final float eyeX = 0.0f;
    final float eyeY = 0.0f;
    final float eyeZ = -0.5f;

    // Facing negative because of anti clockwise triangles are only visible in that direction
    // We are looking toward the distance
    final float lookX = 0.0f;
    final float lookY = 0.0f;
    final float lookZ = -1.0f;

    // Set our up vector. This is where our head would be pointing were we holding the camera.
    final float upX = 0.0f;
    final float upY = 1.0f;
    final float upZ = 0.0f;

    // Set the view matrix. This matrix can be said to represent the camera position.
    // NOTE: In OpenGL 1, a ModelView matrix is used, which is a combination of a model and
    // view matrix. In OpenGL 2, we can keep track of these matrices separately if we choose.
    Matrix.setLookAtM(mViewMatrix, 0, eyeX, eyeY, eyeZ, lookX, lookY, lookZ, upX, upY, upZ);        

    final String vertexShader = getVertexShader();          
    final String fragmentShader = getFragmentShader();          

    final int vertexShaderHandle = ShaderHelper.compileShader(GLES20.GL_VERTEX_SHADER, vertexShader);       
    final int fragmentShaderHandle = ShaderHelper.compileShader(GLES20.GL_FRAGMENT_SHADER, fragmentShader);     

    mProgramHandle = ShaderHelper.createAndLinkProgram(vertexShaderHandle, fragmentShaderHandle, 
            new String[] {"a_Position",  "a_Color", "a_Normal", "a_TexCoordinate"});

    // Load the texture
    mTextureDataHandle = loadTexture(atlas);

}   

@Override
public void onSurfaceChanged(GL10 glUnused, int width, int height) 
{
    // Set the OpenGL viewport to the same size as the surface.
    GLES20.glViewport(0, 0, width, height);

    // Create a new perspective projection matrix. The height will stay the same
    // while the width will vary as per aspect ratio.
    final float left = 0f;
    final float right = width;
    final float bottom = 0f;
    final float top = height;
    final float near = 0f;
    final float far = 10.0f;
    Matrix.orthoM(mProjectionMatrix, 0, left, right, bottom, top, near, far);

}   

public void setAtlas(int w, int h, Bitmap bitmap, float scale)
{
    spriteWidth = w;
    spriteHeight = h;
    spriteRows = bitmap.getHeight()/spriteHeight;
    spriteColumns = bitmap.getWidth()/spriteWidth;
    atlas = bitmap; 
    mScale = scale;

    spritePositionData = spriteCoords(spriteWidth * scale,spriteHeight * scale);

    // Initialize the buffer.
    mCubePositions = ByteBuffer.allocateDirect(spritePositionData.length * mBytesPerFloat)
            .order(ByteOrder.nativeOrder()).asFloatBuffer();                            
    mCubePositions.put(spritePositionData).position(0); 

    // Initialize the texture buffer.
    mCubeTextureCoordinates = ByteBuffer.allocateDirect(12 * mBytesPerFloat)
            .order(ByteOrder.nativeOrder()).asFloatBuffer();
}

@Override
public void onDrawFrame(GL10 glUnused) 
{
    GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT | GLES20.GL_DEPTH_BUFFER_BIT);                    

    // Set our per-vertex lighting program.
    GLES20.glUseProgram(mProgramHandle);

    // Set program handles for drawing.
    mMVPMatrixHandle = GLES20.glGetUniformLocation(mProgramHandle, "u_MVPMatrix");
    mMVMatrixHandle = GLES20.glGetUniformLocation(mProgramHandle, "u_MVMatrix"); 
    mTextureUniformHandle = GLES20.glGetUniformLocation(mProgramHandle, "u_Texture");
    mPositionHandle = GLES20.glGetAttribLocation(mProgramHandle, "a_Position");
    mTextureCoordinateHandle = GLES20.glGetAttribLocation(mProgramHandle, "a_TexCoordinate");

    // Set the active texture unit to texture unit 0.
    GLES20.glActiveTexture(GLES20.GL_TEXTURE0);

    // Bind the texture to this unit.
    GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, mTextureDataHandle);

    // Tell the texture uniform sampler to use this texture in the shader by binding to texture unit 0.
    GLES20.glUniform1i(mTextureUniformHandle, 0);                            

    // Pass on drawing to Drawer
    drawer.onDrawFrame(this);
}               

/**
 * Draws a cube.
 */         
public void drawSprite(float x, float y, int t, float scale)
{   
    if(Math.abs(scale-1f) > 0.00001)
    {
        spritePositionData = spriteCoords(spriteWidth * scale,spriteHeight * scale);
        mCubePositions.put(spritePositionData).position(0);
    }
    else
    {
        spritePositionData = spriteCoords(spriteWidth * mScale,spriteHeight * mScale);
        mCubePositions.put(spritePositionData).position(0);
    }
    int row = t/spriteColumns -1;
    int column = (t-1)%spriteColumns;

    float rowHeight = 1f/spriteRows;
    float columnWidth = 1f/spriteColumns;

    cubeTextureCoordinateData[0] = column*columnWidth;
    cubeTextureCoordinateData[1] = row*rowHeight;
    cubeTextureCoordinateData[2] = column*columnWidth;
    cubeTextureCoordinateData[3] =(row+1)*rowHeight;
    cubeTextureCoordinateData[4] =(column+1)*columnWidth;
    cubeTextureCoordinateData[5] = row*rowHeight;
    cubeTextureCoordinateData[6] =column*columnWidth;
    cubeTextureCoordinateData[7] = (row+1)*rowHeight;
    cubeTextureCoordinateData[8] = (column+1)*columnWidth;
    cubeTextureCoordinateData[9] = (row+1)*rowHeight;
    cubeTextureCoordinateData[10] =(column+1)*columnWidth;
    cubeTextureCoordinateData[11] = row*rowHeight;

    mCubeTextureCoordinates.put(cubeTextureCoordinateData).position(0);

    // Translate/ Rotate      
    Matrix.setIdentityM(mModelMatrix, 0);
    Matrix.translateM(mModelMatrix, 0, x, y, -1f);

    // Pass in the position information
    mCubePositions.position(0);     
    GLES20.glVertexAttribPointer(mPositionHandle, mPositionDataSize, GLES20.GL_FLOAT, false,
            0, mCubePositions);        

    GLES20.glEnableVertexAttribArray(mPositionHandle);        

    // Pass in the texture coordinate information
    mCubeTextureCoordinates.position(0);
    GLES20.glVertexAttribPointer(mTextureCoordinateHandle, mTextureCoordinateDataSize, GLES20.GL_FLOAT, false, 
            0, mCubeTextureCoordinates);

    GLES20.glEnableVertexAttribArray(mTextureCoordinateHandle);

    // This multiplies the view matrix by the model matrix, and stores the result in the MVP matrix
    // (which currently contains model * view).
    Matrix.multiplyMM(mMVPMatrix, 0, mViewMatrix, 0, mModelMatrix, 0);   

    // Pass in the modelview matrix.
    GLES20.glUniformMatrix4fv(mMVMatrixHandle, 1, false, mMVPMatrix, 0);                

    // This multiplies the modelview matrix by the projection matrix, and stores the result in the MVP matrix
    // (which now contains model * view * projection).
    Matrix.multiplyMM(mMVPMatrix, 0, mProjectionMatrix, 0, mMVPMatrix, 0);

    // Pass in the combined matrix.
    GLES20.glUniformMatrix4fv(mMVPMatrixHandle, 1, false, mMVPMatrix, 0);

    // Draw the cube.
    GLES20.glDrawArrays(GLES20.GL_TRIANGLES, 0, 36); 
}   

public static int loadTexture(Bitmap bitmap)
{
    final int[] textureHandle = new int[1];

    GLES20.glGenTextures(1, textureHandle, 0);

    if (textureHandle[0] != 0)
    {

        // Bind to the texture in OpenGL
        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textureHandle[0]);

        // Set filtering
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST);
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_NEAREST);

        // Load the bitmap into the bound texture.
        GLUtils.texImage2D(GLES20.GL_TEXTURE_2D, 0, bitmap, 0);

        // Recycle the bitmap, since its data has been loaded into OpenGL.
        bitmap.recycle();                       
    }

    if (textureHandle[0] == 0)
    {
        throw new RuntimeException("Error loading texture.");
    }

    return textureHandle[0];
}

private float[] spriteCoords(float x, float y)
{
    x /= 2;
    y /= 2;
    final float[] spritePositionData =
        {
            // In OpenGL counter-clockwise winding is default. This means that when we look at a triangle, 
            // if the points are counter-clockwise we are looking at the "front". If not we are looking at
            // the back. OpenGL has an optimization where all back-facing triangles are culled, since they
            // usually represent the backside of an object and aren't visible anyways.

            -x, y, 0f,              
            -x, -y, 0f,
            x, y, 0f, 
            -x, -y, 0f,                 
            x, -y, 0f,
            x, y,0f,
        };

    return spritePositionData;
}

protected String getVertexShader()
{
    return RawResourceReader.readTextFileFromRawResource(mActivityContext, R.raw.per_pixel_vertex_shader);
}

protected String getFragmentShader()
{
    return RawResourceReader.readTextFileFromRawResource(mActivityContext, R.raw.per_pixel_fragment_shader);
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T16:46:43.040

听起来您正在丢失您在评论中推测的设备上下文。您加载的任何内容现在都可能是垃圾。

[从 GLSurfaceView.Renderer 文档](https://developer.android.com/reference/android/opengl/GLSurfaceView.Renderer.html)：

> 当 EGL 上下文丢失时，与该上下文关联的所有 OpenGL 资源（例如纹理）将被自动删除。

一些有用的链接：

*   [Android：OpenGL上下文何时销毁？](https://stackoverflow.com/questions/11067881/android-when-is-opengl-context-destroyed)
*   [Android暂停时丢失OpenGL上下文的解决方法？](https://gamedev.stackexchange.com/questions/12629/workaround-to-losing-the-opengl-context-when-android-pauses)
*   [防止 Android GL 上下文丢失](https://stackoverflow.com/questions/10723894/preventing-android-gl-context-loss)
*   [恢复后在 Android 中丢失 OpenGL 纹理](https://stackoverflow.com/questions/5965899/losing-opengl-textures-in-android-after-a-resume)
*   [从活动返回时没有当前的openGL上下文？](https://stackoverflow.com/questions/3579775/no-current-opengl-context-when-returning-from-activity)
*   [防止 onPause 破坏 OpenGL 上下文](https://stackoverflow.com/questions/2112768/prevent-onpause-from-trashing-opengl-context)

# android - android admob 集成问题 - 不允许使用字符串类型

> ID：12015972
> 
> 赞同：2
> 
> 时间：2012-08-18T04:56:21.173
> 
> 标签：android, admob

我第一次尝试集成admob。我遵循了[这里](https://developers.google.com/mobile-ads-sdk/docs/)的文档规则，并且我已经看过[几个](https://stackoverflow.com/questions/7901018/admob-sdk-4-3-1-i-cant-display-banner) [相关的](https://stackoverflow.com/questions/7899767/admob-error-in-eclipse-for-androidconfigchanges) [页面](https://stackoverflow.com/questions/7947165/admob-implementation-error)，但我似乎仍然做错了什么。
我正在使用 GoogleAdMobAdsSdk-6.1.0.jar 以及 android sdk 版本 13 (Android 3.2)。

我包括了几件我发现需要从各种来源获得的东西。

```
<uses-sdk
    android:minSdkVersion="7"
    android:targetSdkVersion="13" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<activity android:name="com.google.ads.AdActivity"
          android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScre‌​enSize"  /> 
```

在我的 AndroidManifest.xml 中。

包括我

```
target=android-13 
```

在我的 project.properties 中。

上述配置无法编译。我在 eclipse（版本：4.2.0）中收到错误，说明如下：

```
error: Error: String types not allowed (at 'configChanges' with value 'keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScre‌​enSize' 
```

如果我将其更改为旧样式

```
android:configChanges="keyboard|keyboardHidden|orientation" 
```

该项目编译得很好，但是当我开始我的活动时，我遇到了以下问题：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@color/Aqua"
    android:orientation="vertical" >

    <LinearLayout
        android:id="@+id/adLayout"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >
    </LinearLayout>

</LinearLayout> 
```

我活动中的代码如下所示：

```
public class TutorialActivity extends Activity {

    private static final String PUBLISHER_ID = "blah"; //omitted
    private AdView adView;

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.tutorial_layout);
        AdRequest request = new AdRequest();
        request.addTestDevice("what i believe is my device id");

        adView = new AdView(this, AdSize.BANNER, PUBLISHER_ID);

        LinearLayout layout = (LinearLayout) findViewById(R.id.adLayout);
        layout.addView(adView);
        adView.loadAd(request);
    }

    @Override
    public void onDestroy() {
        if (adView != null) {
            adView.destroy();
        }
        super.onDestroy();
    }

} 
```

当我运行此代码并导航到我的活动时，我看到屏幕顶部看起来像我所期望的广告框，其中包含以下文本：您必须在 AndroidManifest.xml 中使用 configChanges 声明 AdActivity .

我是一个困惑的人。在将其发布到谷歌应用商店之前，这是我最不想包含在我的应用中的东西，非常感谢任何建议或帮助。如果我遗漏了什么，我深表歉意。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-18T05:02:13.037

我有同样的问题。我会告诉你我做了什么。

右键单击eclipse中的项目文件夹

*   -特性
*   - 选择安卓
*   -选择固件 3.2 或更高版本

然后在清单中使用它

```
android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize" 
```

就这样

# php - CakePHP 无法在 afterCreate() 上的模型中创建多个“hasMany”项

> ID：12015976
> 
> 赞同：0
> 
> 时间：2012-08-18T04:57:22.097
> 
> 标签：php, cakephp, cakephp-model

在 CakePHP 项目中，我有一个 User 类和一个 Category 类。一个用户有许多“类别”和类别属于“用户”。当我创建一个用户时，我想默认为新用户创建一个 coupla 类别。但由于某种原因，只创建了一个新类别。我可能做错了什么？这是我在用户的 afterSave() 函数中使用的代码：

```
 function afterSave($created)
    {
        if($created):
            //create 2 categories 'Personal' and 'Work'
            $data1 = array(
                'Category' => array(
                    'user_id' => $this->id,
                    'name' => 'Personal',
                    'order' => 1
                )              
            );
            $d1 = $this->Category->save($data1);

            $data2 = array(
                'Category' => array(
                    'user_id' => $this->id,
                    'name' => 'Work',
                    'order' => 2
                )              
            );
            $d2 = $this->Category->save($data2); 
        endif;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T07:29:47.957

我认为当您想多次使用保存功能时，您必须使用 $this->Category->create(); 在第二个保存功能之前。

```
 function afterSave($created)
        {
            if($created):
                //create 2 categories 'Personal' and 'Work'
                $data1 = array(
                    'Category' => array(
                        'user_id' => $this->id,
                        'name' => 'Personal',
                        'order' => 1
                    )              
                );
                $d1 = $this->Category->save($data1);

                $data2 = array(
                    'Category' => array(
                        'user_id' => $this->id,
                        'name' => 'Work',
                        'order' => 2
                    )              
                );
                $this->Category->create();
                $d2 = $this->Category->save($data2); 
            endif;
        } 
```

# html - div 横向移动和 deminions

> ID：12015977
> 
> 赞同：0
> 
> 时间：2012-08-18T04:57:45.130
> 
> 标签：html, css-position

我有一个位置：固定的div菜单；在我的 html 编辑器中进行设置时，它看起来不错，然后在您最大化或最小化浏览器大小时通过浏览器进行本地测试，它会停留在该位置并且在某些时候会覆盖元素。我是这个 div 保持在我的身体线区域内，从不在页眉区域或页脚区域。所以基本上我希望它在向下滚动并且页脚出现时停止它应该停止在它上面。还需要知道如何在调整浏览器大小时阻止它跳屏。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T05:15:45.003

如果您希望它在用户屏幕处于特定滚动量的情况下以特定方式运行，则需要使用 Javascript（例如在碰到页脚时停止固定位置）

使用 jQuery：

```
$(window).scroll(function() {  // Called whenever a user scrolls on your page
    if ($(window).scrollTop() < 200) { // User is close enough to header, leave element absolute (or however you want it)
        $('#fixed-element-id').css('position', 'absolute');
        // Other logic
    } else if ($(window).scrollTop() > 800) { // user is close enough to footer, leave element absolute (or however you want it)
        $('#fixed-element-id').css('position', 'absolute');
        // Other logic
    } else { // User is somewhere that the element needs to follow their scrolling
        $('#fixed-element-id').css('position', 'fixed');
        // Other logic
    }
}); 
```

# java - Arrays.asList() 混淆源代码

> ID：12015980
> 
> 赞同：12
> 
> 时间：2012-08-18T04:58:22.060
> 
> 标签：java, arrays, variadic-functions

根据该类的[源代码](http://javasourcecode.org/html/open-source/jdk/jdk-6u23/java/util/Arrays.java.html)，`Arrays`该方法`asList`将一个数组传递给 new 的构造函数`ArrayList`。但是没有这样的构造函数。可变参数不生成数组，这怎么可能？

这是`asList`来源：

```
public static <T> List<T> asList(T... a) {
    return new ArrayList<T>(a);
} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-18T05:03:31.323

[`java.util.Arrays.ArrayList`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/java/util/Arrays.java#Arrays.ArrayList)是与 不同的类[`java.util.ArrayList`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/java/util/ArrayList.java#ArrayList)。

# c# - C#：什么是正确的数据结构？（锯齿状对象“数组”）

> ID：12015983
> 
> 赞同：0
> 
> 时间：2012-08-18T04:59:06.240
> 
> 标签：c#, data-structures, jagged-arrays

我有`List` 一个`IWord`名为`taggedInput`. 我需要将每个元素与它自己`List`的`IWord`对象相关联。为此，我需要使用不同的数据类型。

在此数据类型中，父列表和子列表都必须是动态的，并且必须在运行时填充。

父列表必须允许重复值（因此它不能是`Dictionary`对象）。

我打算遍历父列表，并操作（添加、删除、重组）子列表中的元素。父列表和子列表中的每个元素都必须可以通过其在列表中的位置来访问。

这是我制作的图像，以更好地说明我的需求：

![在此处输入图像描述](../Images/689207ffac4d133f22731f4c6fa6fc2d.png)

为此使用的最佳数据类型是什么？我需要类似的东西`List<IWord,List<IWord>>` （但那不会是一个列表）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T06:15:54.173

我假设您无法更改`IWord`界面？在那种情况下，我会使用另一种类型来让您形成所需的关系......

```
public class WordWithRelatives
{
   public IWord Word {get;set;}
   public List<IWord> Relatives {get;set;}
} 
```

然后你只需要上面的列表

```
var taggedInput = List<WordWithRelatives>(); 
```

您还可以`WordWithRelatives`通过将接口方法`IWord`转发到它包含的实例来实现。`IWord``Word`

# wcf - 计算使用 WCF 服务操作发送的总字节数

> ID：12015985
> 
> 赞同：0
> 
> 时间：2012-08-18T04:59:27.693
> 
> 标签：wcf, azure, bandwidth

我正在测试一个 Azure 辅助角色，该角色提供 10-12 种不同的服务操作，这些操作可用于 WPF 桌面客户端。我正在通过 Azure 计费门户关注总传出带宽。似乎这些操作产生的传出带宽比我预期的要多。

有没有办法从 WPF 客户端的角度“测量”每个服务操作的总下载大小？我知道 C# 没有等效的 sizeof 运算符，所以我想我不能只做

```
sizeof(List<MyObjects>) 
```

查看为任何特定调用传输的总字节数。

我考虑过可能使用wireshark，并以某种方式计算每个服务操作调用的数据包大小，并以这种方式查找带宽占用。

有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T05:22:41.300

如果你的 WCF 服务在 IIS 下运行，你可以使用 IIS 的内置性能计数器，例如：

*   \Web 服务（默认网站）\接收的总字节数
*   \Web 服务（默认网站）\发送的总字节数

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T07:52:47.307

性能计数器可以很好地计算发送/接收的总字节数。但是如果你想知道每个操作调用的数量，你需要在服务端编写一个消息检查器。

这将允许您拦截每个传入和传出消息，并且您将可以访问原始 Message 对象，从而允许您测量请求和响应的总大小。