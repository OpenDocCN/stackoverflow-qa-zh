# StackOverflow 问答 10585000-10585999

# ruby - ZSH 抱怨 RVM __rvm_cleanse_variables: function definition file not found

> ID：10585002
> 
> 赞同：171
> 
> 时间：2012-05-14T14:09:33.683
> 
> 标签：ruby, macos, rvm, zsh

在 Mac OS X 10.7.4 上使用最新的 ZSH 和 RVM 时，ZSH 抱怨：

`__rvm_cleanse_variables: function definition file not found`

* * *

## 回答 #1

> 赞同：495
> 
> 时间：2012-05-14T14:10:04.477

运行以下解决了问题：

`rm ~/.zcompdump*`

注意：* 表示存在多个 .zcompdump 文件。

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2013-09-23T14:35:54.473

有时还有`~/.zcompdump-<COMPUTER NAME>-<VERSION>`文件，所以使用：

```
rm -f ~/.zcompdump *

```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-10-11T08:10:47.710

要禁用`.zcompdump*`文件，您可以在您的`.zshrc`（或`/etc/zsh/* files`）中查找`compinit`并添加`-D`标志。

这可能比在每次登录时创建文件并删除它们要好。

（来源：[http](http://www.csse.uwa.edu.au/programming/linux/zsh-doc/zsh_23.html) ://www.csse.uwa.edu.au/programming/linux/zsh-doc/zsh_23.html ）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-09-14T06:14:29.307

即使在`compinit -D`and之后我的问题仍然存在`rm -f ~/.zcompdump*`。我发现[了这个 github 问题](http://github.com/robbyrussell/oh-my-zsh/issues/4787)并检查了我的 .zplug 目录，果然发现了一些非隐藏的 zcompdump 文件（前面没有'.'）。删除了那些，我很高兴。如果您使用 zsh 插件管理器，例如 zgen 或 zplug，请检查它们的目录。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-10T11:47:20.397

将 rm -f ~/.zcompdump{,.zwc} 添加到 .zlogin 以使其自动化

# hadoop - 测试与 HDFS 的连接

> ID：10585011
> 
> 赞同：1
> 
> 时间：2012-05-14T14:09:56.377
> 
> 标签：hadoop, hdfs

为了测试从 java 程序到 HDFS 的连接，依赖 FileSystem.get(configuration) 是否足够或应该进行额外的完整性检查？（例如：一些基于文件的操作，如列表、复制、删除）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:56:55.293

FileSystem.get(Configuration) 创建一个 DistrubutedFileSystem 对象，该对象又依赖于 DFSClient 与 NameNode 对话。在源代码的深处（1.0.2 是我正在查看的版本），是为 NameNode 创建一个 RPC 的调用，它反过来为 ClientProtocol 接口创建一个代理。

当这个代理被创建时，`org.apache.hadoop.ipc.RPC.getProxy(Class<? extends VersionedProtocol>, long, InetSocketAddress, UserGroupInformation, Configuration, SocketFactory, int)`（

```
VersionedProtocol proxy =
    (VersionedProtocol) Proxy.newProxyInstance(
        protocol.getClassLoader(), new Class[] { protocol },
        new Invoker(protocol, addr, ticket, conf, factory, rpcTimeout));
long serverVersion = proxy.getProtocolVersion(protocol.getName(), 
                                              clientVersion);
if (serverVersion == clientVersion) {
  return proxy;
} else {
  throw new VersionMismatch(protocol.getName(), clientVersion, 
                            serverVersion);
} 
```

当然，此版本匹配检查不会报告 NameNode 是否有足够的数据节点运行来执行某些操作（例如创建/打开文件）。

# jquery - jQuery - 在选择列表中获取选项的像素宽度？

> ID：10585014
> 
> 赞同：1
> 
> 时间：2012-05-14T14:09:58.323
> 
> 标签：jquery

通过以下内容，我可以获得选择输入的宽度（以像素为单位）。是否可以在选择列表中获取选项的宽度？谢谢

```
$('#mySelect').width(); 
```

更新 - 这是我想要这个的原因。我需要在选择列表中居中文本。我无法使用 css text-align: center; 跨设备和浏览器执行此操作 我唯一的选择是使用文本缩进。由于我的站点具有流动宽度并且选项具有不同的长度，因此我需要动态计算此值。

所以，如果我能得到选择选项文本的宽度，也能得到容器的宽度（容易得多），那么我就可以计算出文本缩进应该是什么。谢谢

NimChimpsky 的方法似乎效果很好。代码在这里：[jQuery - 在 div 点击时触发函数运行良好，但在页面加载时不运行](https://stackoverflow.com/questions/10586611/jquery-function-runs-fine-when-fired-on-div-click-but-not-on-page-load)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-18T12:28:16.220

我是这样设计的：

1.  做一个新`<span>`对象
2.  将文本设置为相关选项之一
3.  从所选选项中获取与文本宽度相关的计算样式值
4.  将这些测量值设置为跨度
5.  将跨度附加到正文
6.  测量该跨度的宽度
7.  删除跨度

请记住：
无法测量选择的向下箭头（三角形）。它是浏览器 chrome 的一部分。大约 30 像素的魔法值是合理的。

```
var getOptionWidth = function(opt) {
    var styleProps = [
        'font-family',
        'font-kerning',
        'font-size',
        'font-stretch',
        'font-style',
        'font-variant',
        'font-variant-ligatures',
        'font-weight',
        'text-transform',
        'letter-spacing',
        'word-spacing',
        'padding-left',
        'padding-right'
    ];
    var o = $('<span>')
        .text($(opt).text());
    for (var i=0; i < styleProps.length; i++) {
        o.css(styleProps[i], $(opt).css(styleProps[i]));
    }
    o.appendTo('body');
    var w = o.width();
    o.remove();
    return w;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:12:01.180

您可以像这样获得所选选项的字符串长度：

```
 ("#mySelect option:selected").text().length 
```

对于特定的索引元素（此处为 2），请执行以下操作：

```
$("#mySelect option[value='2']").text().length 
```

或者，您可以获取选定的文本，将其放入不可见的 div 中，然后获取该 div 的宽度 - 使用普通的 jquery 宽度方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:12:53.123

```
$('#mySelect > option').width(); 
```

这将真正返回第一个选项的宽度。使用更具选择性的 jQuery 选择器字符串来选择适当的选项标签。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-08T06:46:14.863

以下是如何拥有一个可变宽度的 html 选择器标签，该标签仅扩展和收缩到所选项目所需的宽度。我没有测试浏览器的兼容性，因为它只需要在 iOS8 上的 Safari 中工作，但我确信这是可能的。

选择器的 HTML

```
<select id="hack1">
    <option>short option</option>
    <option>loooong looking loooong option</option>
    <option>Longer option but more like the longest</option>
    <option>Medium length selector</option>
</select> 
```

底部的 HTML

```
<select id="hackselect">
    <option></option>
</select> 
```

CSS

```
#hackselect {
    visibility: hidden;
} 
```

jQuery

```
$('#hack1').change(function(event) {
    $("#hackselect option:first").text($("#hack1 option:selected").text());
    $('#hack1').css('width', $('#hackselect').width() + 6);
}); 
```

最后一行代码中的 + 6 在那里，因为我在 select 元素上有自定义样式，每边有 3 个填充。在测量宽度时，它没有考虑到这一点，因此需要对其进行硬编码。

# asp.net - 在电子邮件模板中呈现超链接

> ID：10585022
> 
> 赞同：-1
> 
> 时间：2012-05-14T14:10:25.343
> 
> 标签：asp.net, .net, vb.net

我正在尝试在电子邮件模板中呈现一个超链接，该超链接将发送给用户，如果用户单击该链接，它将指向一个唯一的 url。我在下面给出了编码，

```
email.AddMailmerge("RequestUrl", "<a href=" & ConfigurationManager.AppSettings("DomainName") & "/Requests/Requests.aspx?Company_ID=" & objCompany.IDHashed & ">Feedback Requests</a>") 
```

我的问题是链接没有正确解析并带我到正确的网址。我究竟做错了什么？

它解析为：

C:\Users\Test\Desktop\localhost/Requests/Requests.aspx?Company_ID=KirprZ17bg5u5Qf1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:04:20.960

确保您的 Appsetting 包含 http:// 所以而不仅仅是

```
localhost 
```

它需要是

```
http://localhost 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:11:47.017

一定要格式化你`href`的引号。与其依赖于 app.config 的值（即返回`C:\`值），不如使用 .NET 方法获取当前域/URL。

```
Dim target As String = _
     String.Format("<a href='{0}/Requests/Requests.aspx?Company_ID={1}'>Feedback Requests</a>",_
                    Request.Url.GetLeftPart(UriPartial.Authority),_
                    objCompany.IDHashed) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T10:07:47.857

```
Dim strRequestLink As String = System.Configuration.ConfigurationManager.AppSettings("DomainName") & "/Requests/Requests.aspx?Company_ID=" & Me.ID & "&key=" & Me.IDHashed
Dim strRequestUrl As String = "<a href=""http://" & strRequestLink & """>http://" & strRequestLink & "</a>" 
```

我使用了上面的格式。

# android - 移动应用程序的图像大小最佳实践

> ID：10585025
> 
> 赞同：60
> 
> 时间：2012-05-14T14:10:40.113
> 
> 标签：android, ios, image, mobile-website

我正在构建一个针对 iPhone/iPad 和 Android 手机的移动应用程序。该应用程序将涉及用户拍照并上传到我的服务器，稍后用户将能够在他们的移动设备上查看这些照片（尽管不一定是他们自己的照片，因此 Android 用户可能正在查看使用 iPhone 拍摄的照片）。

我应该保存哪些尺寸的照片才能涵盖大多数用例？iPad 为 1.333 W/H，大多数手机为 1.5 或 1.333 W/H，少数为 1.666 W/H。具体来说：

iPad：1024x768，iPad3：2048x1536，iPhone和其他一些手机：960x640、480x320、800x480。

为了使其易于管理，我需要确定一些特定的图像尺寸并以这些尺寸保存照片。我并不是真的在技术方面寻求帮助。我可以在服务器端进行图像缩放等。我正在寻找有关图像大小的建议/最佳实践/经验教训，然后再深入构建它。

*   我应该以哪种尺寸保存照片以涵盖大多数用例？
*   您是否建议在上传到服务器之前进行任何客户端缩放以节省传输时间（例如缩小 2048x1536 iPad 照片），还是我应该始终传输原件？
*   我应该如何处理不兼容的图像尺寸（例如在 Android 设备上显示使用 iPad 拍摄的照片）？我应该在发送到客户端之前在我的服务器上预先剪切这些图像，还是应该让客户端电话处理图像大小调整？
*   还有UI的问题。除了照片之外，页面上还有其他内容，可能是一两个按钮用于导航。我应该在保存图片时保持相同纵横比的同时选择小于全屏尺寸的东西吗？

我知道其中一些问题没有一个答案，而且答案是相对的，但我想得到一些意见。谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-14T15:18:18.207

对于 Android，我认为最好的起点是这里，它包含很多信息，包括标准屏幕尺寸以及如何在保持最佳质量的同时显示图像。

[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

我还建议在您的服务器上进行尽可能多的图像处理。由于内存限制和碎片，图像在 Android 上使用起来很痛苦。两部手机可能会存储以不同方向以相同方式拍摄的照片，并且没有简单的方法来处理旋转，但可以做到（谢天谢地，我还没有遇到过错误记录 Exif 数据的手机，但我不会如果它们存在会感到惊讶......）。您对手机的依赖越多，由于制造商在周围放置包装器或自定义其处理媒体的方式，您出错的机会就越大。

至于如何显示，理想情况下，如果您的后端已经在进行一系列不同的调整大小，您可以在请求图像时包括您的屏幕密度，并根据开发指南发送最佳尺寸。如果您想将差异保持在最低限度，至少支持手机的中密度或高密度，以及平板电脑的超高密度。

只是我的两分钱，我相信你会有很多意见。祝你好运。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-14T15:16:04.567

我没有完整的答案给你，但我确实有一些想法......

1）我建议在上传之前减小图像大小。如果我正在使用您的应用程序并且我必须上传一张 4 兆的照片，那么每次我想使用您的应用程序时，我可能都会通过。随着我们向前迈进，我们在照相手机方面取得了更好的技术；诺基亚发布了一款 41 兆像素的相机，我猜它会产生相当大的图像。必须下载 4-6 MB 图像的用户也不是一个好主意。只是从用户的角度的一些想法。

2）我不会剪切图像。您不一定知道图像的哪些部分不重要，那么您怎么知道在哪里裁剪呢？让手机相应地调整图片大小，并依靠放大图片的能力来查看更大尺寸的东西。

3）您可以尝试制作一个隐藏按钮的 UI。如果您有一些非常简单的事情（例如前进或后退），您可以依靠手势控制（滑动）在您的应用程序中移动。您可以实现滑动抽屉和菜单，在使用时暂时占用空间，但在您想查看主要内容（图片，在您的情况下）时给您空间。我通常发现隐藏按钮效果不佳，人们似乎想要/搜索让他们导航的按钮，但 Android 库仅适用于菜单 + 滑动，所以谁真正知道。

# xml - XPath 匹配叶节点

> ID：10585027
> 
> 赞同：1
> 
> 时间：2012-05-14T14:10:48.987
> 
> 标签：xml, xpath

我想编写一个 XPath 表达式，如果它是叶节点则返回 true ..

我怎样才能做到这一点..

```
//a[not(node()] 
```

像这样的东西？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:10:16.093

当且仅当上下文节点没有子节点时返回 true 的表达式是：

```
not(child::node()) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T14:16:33.860

文本等也是节点，因此您可能想要这个：

```
not(*) 
```

# ruby-on-rails - Rails：设计产生错误的路线

> ID：10585028
> 
> 赞同：1
> 
> 时间：2012-05-14T14:10:57.630
> 
> 标签：ruby-on-rails, devise, routes

我在我的应用程序中使用设计。

形成 routes.rb：

```
 devise_for :users

  authenticated :user do
    root :to => 'pages#home'
  end

  root :to => 'pages#home'

  match '/about', to: "pages#about"
  match '/request_invite', to: "users#sign_up" 
```

从我的 _headers.html.erb

```
<li><%= link_to HOME_TITLE,    root_path  %></li>
<li><%= link_to REQUEST_INVITE_TITLE,    request_invite_path  %></li>
<li><%= link_to ABOUT_TITLE,    about_path %></li> 
```

当我检查我的路线（耙路线）时，我有以下内容：

```
request_invite        /request_invite(.:format)      users#sign_up 
```

当我做：

```
http://localhost:3000/users/sign_up 
```

我确实看到了邀请表格。

如果我单击标题中的请求邀请链接，我会收到以下错误：

> 未初始化的常量 UsersController

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:18:45.783

在路由文件中更正此问题

```
 match '/request_invite', to: "users/registration#new" 
```

希望对你有用

# javascript - 用 JS 解析 HTML 字符串

> ID：10585029
> 
> 赞同：353
> 
> 时间：2012-05-14T14:11:11.937
> 
> 标签：javascript, html, dom, html-parsing

我想解析一个包含 HTML 文本的字符串。我想用 JavaScript 来做。

我尝试了[Pure JavaScript HTML Parser library](https://johnresig.com/blog/pure-javascript-html-parser/)，但它似乎解析了我当前页面的 HTML，而不是来自字符串。因为当我尝试下面的代码时，它会改变我页面的标题：

```
var parser = new HTMLtoDOM("<html><head><title>titleTest</title></head><body><a href='test0'>test01</a><a href='test1'>test02</a><a href='test2'>test03</a></body></html>", document); 
```

我的目标是从 HTML 外部页面中提取链接，我像字符串一样阅读。

你知道一个API来做到这一点吗？

* * *

## 回答 #1

> 赞同：463
> 
> 时间：2012-05-14T14:14:36.350

创建一个虚拟 DOM 元素并将字符串添加到其中。然后，您可以像操作任何 DOM 元素一样操作它。

```
var el = document.createElement( 'html' );
el.innerHTML = "<html><head><title>titleTest</title></head><body><a href='test0'>test01</a><a href='test1'>test02</a><a href='test2'>test03</a></body></html>";

el.getElementsByTagName( 'a' ); // Live NodeList of your anchor elements 
```

编辑：添加一个 jQuery 答案来取悦粉丝！

```
var el = $( '<div></div>' );
el.html("<html><head><title>titleTest</title></head><body><a href='test0'>test01</a><a href='test1'>test02</a><a href='test2'>test03</a></body></html>");

$('a', el) // All the anchor elements 
```

* * *

## 回答 #2

> 赞同：328
> 
> 时间：2014-02-19T03:28:46.183

这很简单：

```
var parser = new DOMParser();
var htmlDoc = parser.parseFromString(txt, 'text/html');
// do whatever you want with htmlDoc.getElementsByTagName('a'); 
```

[根据 MDN](https://developer.mozilla.org/en-US/docs/Web/API/DOMParser#Browser_compatibility)，要在 chrome 中执行此操作，您需要像这样解析为 XML：

```
var parser = new DOMParser();
var htmlDoc = parser.parseFromString(txt, 'text/xml');
// do whatever you want with htmlDoc.getElementsByTagName('a'); 
```

~~webkit 目前不支持它，您必须遵循 Florian 的回答，并且在大多数情况下在移动浏览器上工作是未知的。~~

编辑：现在广泛支持

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2015-10-24T17:52:11.917

编辑：下面的解决方案仅适用于 HTML“片段”，因为 html、head 和 body 已被删除。我想这个问题的解决方案是 DOMParser 的 parseFromString() 方法：

```
const parser = new DOMParser();
const document = parser.parseFromString(html, "text/html"); 
```

* * *

对于 HTML 片段，此处列出的解决方案适用于大多数 HTML，但在某些情况下它不起作用。

例如尝试解析`<td>Test</td>`。这个不适用于 div.innerHTML 解决方案、DOMParser.prototype.parseFromString 和 range.createContextualFragment 解决方案。td 标签丢失，只剩下文本。

只有 jQuery 能很好地处理这种情况。

所以未来的解决方案（MS Edge 13+）是使用模板标签：

```
function parseHTML(html) {
    var t = document.createElement('template');
    t.innerHTML = html;
    return t.content;
}

var documentFragment = parseHTML('<td>Test</td>'); 
```

对于较旧的浏览器，我已将 jQuery 的 parseHTML() 方法提取到一个独立的要点中 - [https://gist.github.com/Munawwar/6e6362dbdf77c7865a99](https://gist.github.com/Munawwar/6e6362dbdf77c7865a99)

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2012-05-14T14:18:00.727

```
var doc = new DOMParser().parseFromString(html, "text/html");
var links = doc.querySelectorAll("a"); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-12-09T03:38:55.680

以下函数`parseHTML`将返回：

*   a[**`Document`**](https://developer.mozilla.org/en-US/docs/Web/API/Document)当您的文件以 doctype 开头时。

*   a[**`DocumentFragment`**](https://developer.mozilla.org/en-US/docs/Web/API/DocumentFragment)当您的文件不以 doctype 开头时。

* * *

### 编码 ：

```
function parseHTML(markup) {
    if (markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
        var doc = document.implementation.createHTMLDocument("");
        doc.documentElement.innerHTML = markup;
        return doc;
    } else if ('content' in document.createElement('template')) {
       // Template tag exists!
       var el = document.createElement('template');
       el.innerHTML = markup;
       return el.content;
    } else {
       // Template tag doesn't exist!
       var docfrag = document.createDocumentFragment();
       var el = document.createElement('body');
       el.innerHTML = markup;
       for (i = 0; 0 < el.childNodes.length;) {
           docfrag.appendChild(el.childNodes[i]);
       }
       return docfrag;
    }
} 
```

* * *

### 如何使用 ：

```
var links = parseHTML('<!doctype html><html><head></head><body><a>Link 1</a><a>Link 2</a></body></html>').getElementsByTagName('a'); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-02-08T04:41:29.693

在 Chrome 和 Firefox 中解析 HTML 的最快方法是 Range#createContextualFragment：

```
var range = document.createRange();
range.selectNode(document.body); // required in Safari
var fragment = range.createContextualFragment('<h1>html...</h1>');
var firstNode = fragment.firstChild; 
```

我建议创建一个辅助函数，如果可用，它使用 createContextualFragment，否则回退到 innerHTML。

基准测试：http: [//jsperf.com/domparser-vs-createelement-innerhtml/3](http://jsperf.com/domparser-vs-createelement-innerhtml/3)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-03-07T14:22:46.083

```
const parse = Range.prototype.createContextualFragment.bind(document.createRange());

document.body.appendChild( parse('<p><strong>Today is:</strong></p>') ),
document.body.appendChild( parse(`<p style="background: #eee">${new Date()}</p>`) ); 
```

* * *

只有`Node`父级中的有效子`Node`级（ 的开头`Range`）才会被解析。否则，可能会出现意想不到的结果：

```
// <body> is "parent" Node, start of Range
const parseRange = document.createRange();
const parse = Range.prototype.createContextualFragment.bind(parseRange);

// Returns Text "1 2" because td, tr, tbody are not valid children of <body>
parse('<td>1</td> <td>2</td>');
parse('<tr><td>1</td> <td>2</td></tr>');
parse('<tbody><tr><td>1</td> <td>2</td></tr></tbody>');

// Returns <table>, which is a valid child of <body>
parse('<table> <td>1</td> <td>2</td> </table>');
parse('<table> <tr> <td>1</td> <td>2</td> </tr> </table>');
parse('<table> <tbody> <td>1</td> <td>2</td> </tbody> </table>');

// <tr> is parent Node, start of Range
parseRange.setStart(document.createElement('tr'), 0);

// Returns [<td>, <td>] element array
parse('<td>1</td> <td>2</td>');
parse('<tr> <td>1</td> <td>2</td> </tr>');
parse('<tbody> <td>1</td> <td>2</td> </tbody>');
parse('<table> <td>1</td> <td>2</td> </table>'); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-05-14T14:17:13.583

如果您愿意使用 jQuery，它有一些很好的工具可以从 HTML 字符串中创建分离的 DOM 元素。然后可以通过通常的方式查询这些，例如：

```
var html = "<html><head><title>titleTest</title></head><body><a href='test0'>test01</a><a href='test1'>test02</a><a href='test2'>test03</a></body></html>";
var anchors = $('<div/>').append(html).find('a').get(); 
```

* * *

编辑 - 刚刚看到@Florian 的答案是正确的。这基本上正是他所说的，但使用 jQuery。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2020-11-29T05:06:20.777

**1 种方式**

利用`document.cloneNode()`

表现是：

调用`document.cloneNode()`耗时约 0.22499999977299012 毫秒。

也许会更多。

```
var t0, t1, html;

t0 = performance.now();
   html = document.cloneNode(true);
t1 = performance.now();

console.log("Call to doSomething took " + (t1 - t0) + " milliseconds.")

html.documentElement.innerHTML = '<!DOCTYPE html><html><head><title>Test</title></head><body><div id="test1">test1</div></body></html>';

console.log(html.getElementById("test1"));
```

**2种方法**

利用`document.implementation.createHTMLDocument()`

表现是：

调用`document.implementation.createHTMLDocument()`耗时约 0.14000000010128133 毫秒。

```
var t0, t1, html;

t0 = performance.now();
html = document.implementation.createHTMLDocument("test");
t1 = performance.now();

console.log("Call to doSomething took " + (t1 - t0) + " milliseconds.")

html.documentElement.innerHTML = '<!DOCTYPE html><html><head><title>Test</title></head><body><div id="test1">test1</div></body></html>';

console.log(html.getElementById("test1"));
```

**3路**

利用`document.implementation.createDocument()`

表现是：

调用`document.implementation.createHTMLDocument()`耗时约 0.14000000010128133 毫秒。

```
var t0 = performance.now();
  html = document.implementation.createDocument('', 'html', 
             document.implementation.createDocumentType('html', '', '')
         );
var t1 = performance.now();

console.log("Call to doSomething took " + (t1 - t0) + " milliseconds.")

html.documentElement.innerHTML = '<html><head><title>Test</title></head><body><div id="test1">test</div></body></html>';

console.log(html.getElementById("test1")); 
```

**4路**

利用`new Document()`

表现是：

调用`document.implementation.createHTMLDocument()`时间约为 0.13499999840860255 毫秒。

*   笔记

`ParentNode.append`是2020年的实验技术。

```
var t0, t1, html;

t0 = performance.now();
//---------------
html = new Document();

html.append(
  html.implementation.createDocumentType('html', '', '')
);

html.append(
  html.createElement('html')
);
//---------------
t1 = performance.now();

console.log("Call to doSomething took " + (t1 - t0) + " milliseconds.")

html.documentElement.innerHTML = '<html><head><title>Test</title></head><body><div id="test1">test1</div></body></html>';

console.log(html.getElementById("test1")); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2021-09-16T04:45:27.327

要在 node.js 中执行此操作，您可以使用像[node-html-parser](https://www.npmjs.com/package/node-html-parser)这样的 HTML 解析器。语法如下所示：

```
import { parse } from 'node-html-parser';

const root = parse('<ul id="list"><li>Hello World</li></ul>');

console.log(root.firstChild.structure);
// ul#list
//   li
//     #text

console.log(root.querySelector('#list'));
// { tagName: 'ul',
//   rawAttrs: 'id="list"',
//   childNodes:
//    [ { tagName: 'li',
//        rawAttrs: '',
//        childNodes: [Object],
//        classNames: [] } ],
//   id: 'list',
//   classNames: [] }
console.log(root.toString());
// <ul id="list"><li>Hello World</li></ul>
root.set_content('<li>Hello World</li>');
root.toString();    // <li>Hello World</li> 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-12-09T19:50:27.177

我认为最好的方法是像这样使用[这个](https://developer.mozilla.org/en-US/docs/Web/API/DOMParser/parseFromString)API：

```
//Table string in HTML format
const htmlString = '<table><tbody><tr><td>Cell 1</td><td>Cell 2</td></tr></tbody></table>';

//Parse using DOMParser native way
const parser = new DOMParser();
const $newTable = parser.parseFromString(htmlString, 'text/html');

//Here you can select parts of your parsed html and work with it
const $row = $newTable.querySelector('table > tbody > tr');

//Here i'm printing the number of columns (2)
const $containerHtml = document.getElementById('containerHtml');
$containerHtml.innerHTML = ['Your parsed table have ', $row.cells.length, 'columns.'].join(' ');
```

```
<div id="containerHtml"></div>
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-05-28T16:34:26.480

我必须使用在 Angular NGX Bootstrap 弹出框的弹出框中解析的元素的 innerHTML。这是对我有用的解决方案。

`public htmlContainer = document.createElement( 'html' );`

在构造函数中

`this.htmlContainer.innerHTML = ''; setTimeout(() => { this.convertToArray(); });`

```
 convertToArray() {
    const shapesHC = document.getElementsByClassName('weekPopUpDummy');
    const shapesArrHCSpread = [...(shapesHC as any)];
    this.htmlContainer = shapesArrHCSpread[0];
    this.htmlContainer.innerHTML = shapesArrHCSpread[0].textContent;
  } 
```

在 HTML 中

```
<div class="weekPopUpDummy" [popover]="htmlContainer.innerHTML" [adaptivePosition]="false" placement="top" [outsideClick]="true" #popOverHide="bs-popover" [delay]="150" (onHidden)="onHidden(weekEvent)" (onShown)="onShown()"> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-12-29T13:12:11.333

```
function parseElement(raw){
    let el = document.createElement('div');
    el.innerHTML = raw;
    let res = el.querySelector('*');
    res.remove();
    return res;
} 
```

> 注意：原始字符串不应超过 1 个元素

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2020-10-07T10:53:39.420

```
let content = "<center><h1>404 Not Found</h1></center>"
let result = $("<div/>").html(content).text() 
```

内容：`<center><h1>404 Not Found</h1></center>`，
结果：`"404 Not Found"`

# java - 比较布尔值

> ID：10585032
> 
> 赞同：-1
> 
> 时间：2012-05-14T14:11:19.747
> 
> 标签：java, boolean, boolean-logic

我在比较布尔值时遇到了一个问题，我希望循环进入块内部，但它没有进入块。

```
else if (!(keyCompare.contains(compareKey)) || (save == true)) {
 //do something
} 
```

这里`!(keyCompare.contains(compareKey)`将返回 false。我正在查看向量 keyCompare 是否没有 compareKey 或者如果 save 为 true 然后进入 if 循环，但它没有。

我在哪里做错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T22:19:38.450

有三种可能：

1.  上面的 if 或 else if 块正在执行。
2.  contains 抛出异常。
3.  你错了，这两个条件都是错误的。

调试器会准确地告诉您哪种可能性是正确的。这里实际上没有任何讨论的必要——这实际上是仅有的三种可能性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-12T01:48:30.540

假设你有一个类如下：

```
static class Contents {
  private String contents;
  public Contents(String contents) {
    this.contents = contents;
  }
} 
```

编写以下代码：

```
Vector<Contents> v = new Vector<>();
v.add(new Contents("a"));
System.out.println("Contains a: "+v.contains(new Contents("a"))); 
```

将产生以下输出：

```
Contains a: false 
```

但是将`equals`方法添加到`Contents`类中，如下所示：

```
public boolean equals(Object obj) {
  return Objects.equals(this.contents, ((Contents)obj).contents);
} 
```

突然产生以下结果：

```
Contains a: true 
```

更好的实现可能如下所示：

```
@Override
public boolean equals(Object obj) {
  if (this == obj) return true;
  if (obj == null) return false;
  if (getClass() != obj.getClass())return false;
  final Contents other = (Contents) obj;
  if (!Objects.equals(this.contents, other.contents))return false;
  return true;
} 
```

# ruby-on-rails - 路由表单更新操作？

> ID：10585038
> 
> 赞同：0
> 
> 时间：2012-05-14T14:11:54.400
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个自定义的“trackupload”视图（这实际上只是我的编辑视图的一个变体）。我正在使用以下控制器操作来渲染它：

```
 def trackupload
    @release = Release.find(params[:release_id]) #Note: I had to use :release_id instead of :id, not sure why?
      respond_to do |format|
      format.html # show.html.erb
      format.json { render :json => @release }
      format.pdf { render :layout => false }
    end
  end 
```

我的更新操作：

```
 def update
    @release = Release.find(params[:id])

    respond_to do |format|
      if @release.update_attributes(params[:release])
        format.html { redirect_to @release, :notice => 'Release was successfully updated.' }
        format.json { head :ok }
      else
        format.html { render :action => "edit" }
        format.json { render :json => @release.errors, :status => :unprocessable_entity }
      end
    end
  end 
```

表格本身如下：

```
<%= form_for(@release, :action => "update", :html => { :multipart => true }) do |f| %>
<h3>Upload Tracks for <%= @release.title %></h3>
  <%= f.fields_for :tracks do |builder| %>
  <%= render 'upload_track_fields', :f => builder %>
   <% end %>
<%= f.submit "Upload Tracks", :class => "submit" %>
<% end %> 
```

我想做的就是让它在提交时使用发布控制器的更新操作。我认为这是将 action => "update" 添加到我的 form_for 标记的简单案例，但它似乎不起作用。我没有错误，但没有任何反应。

知道缺少什么或我哪里出错了吗？

发布的 Rake 路由输出：

```
 autocomplete_artist_name_releases GET    /releases/autocomplete_artist_name(.:format)                                       {:action=>"autocomplete_artist_name", :controller=>"releases"}
                         release_artists GET    /releases/:release_id/artists(.:format)                                            {:action=>"index", :controller=>"artists"}
                                         POST   /releases/:release_id/artists(.:format)                                            {:action=>"create", :controller=>"artists"}
                      new_release_artist GET    /releases/:release_id/artists/new(.:format)                                        {:action=>"new", :controller=>"artists"}
                     edit_release_artist GET    /releases/:release_id/artists/:id/edit(.:format)                                   {:action=>"edit", :controller=>"artists"}
                          release_artist GET    /releases/:release_id/artists/:id(.:format)                                        {:action=>"show", :controller=>"artists"}
                                         PUT    /releases/:release_id/artists/:id(.:format)                                        {:action=>"update", :controller=>"artists"}
                                         DELETE /releases/:release_id/artists/:id(.:format)                                        {:action=>"destroy", :controller=>"artists"}
                          release_tracks GET    /releases/:release_id/tracks(.:format)                                             {:action=>"index", :controller=>"tracks"}
                                         POST   /releases/:release_id/tracks(.:format)                                             {:action=>"create", :controller=>"tracks"}
                       new_release_track GET    /releases/:release_id/tracks/new(.:format)                                         {:action=>"new", :controller=>"tracks"}
                      edit_release_track GET    /releases/:release_id/tracks/:id/edit(.:format)                                    {:action=>"edit", :controller=>"tracks"}
                           release_track GET    /releases/:release_id/tracks/:id(.:format)                                         {:action=>"show", :controller=>"tracks"}
                                         PUT    /releases/:release_id/tracks/:id(.:format)                                         {:action=>"update", :controller=>"tracks"}
                                         DELETE /releases/:release_id/tracks/:id(.:format)                                         {:action=>"destroy", :controller=>"tracks"}
                     release_trackupload GET    /releases/:release_id/trackupload(.:format)                                        {:action=>"trackupload", :controller=>"releases"}
                 release_releases_tracks GET    /releases/:release_id/releases_tracks(.:format)                                    {:action=>"index", :controller=>"releases_tracks"}
                                         POST   /releases/:release_id/releases_tracks(.:format)                                    {:action=>"create", :controller=>"releases_tracks"}
              new_release_releases_track GET    /releases/:release_id/releases_tracks/new(.:format)                                {:action=>"new", :controller=>"releases_tracks"}
             edit_release_releases_track GET    /releases/:release_id/releases_tracks/:id/edit(.:format)                           {:action=>"edit", :controller=>"releases_tracks"}
                  release_releases_track GET    /releases/:release_id/releases_tracks/:id(.:format)                                {:action=>"show", :controller=>"releases_tracks"}
                                         PUT    /releases/:release_id/releases_tracks/:id(.:format)                                {:action=>"update", :controller=>"releases_tracks"}
                                         DELETE /releases/:release_id/releases_tracks/:id(.:format)                                {:action=>"destroy", :controller=>"releases_tracks"}
                  release_product_tracks GET    /releases/:release_id/products/:product_id/tracks(.:format)                        {:action=>"index", :controller=>"tracks"}
                                         POST   /releases/:release_id/products/:product_id/tracks(.:format)                        {:action=>"create", :controller=>"tracks"}
               new_release_product_track GET    /releases/:release_id/products/:product_id/tracks/new(.:format)                    {:action=>"new", :controller=>"tracks"}
              edit_release_product_track GET    /releases/:release_id/products/:product_id/tracks/:id/edit(.:format)               {:action=>"edit", :controller=>"tracks"}
                   release_product_track GET    /releases/:release_id/products/:product_id/tracks/:id(.:format)                    {:action=>"show", :controller=>"tracks"}
                                         PUT    /releases/:release_id/products/:product_id/tracks/:id(.:format)                    {:action=>"update", :controller=>"tracks"}
                                         DELETE /releases/:release_id/products/:product_id/tracks/:id(.:format)                    {:action=>"destroy", :controller=>"tracks"}
    release_product_producttracklistings GET    /releases/:release_id/products/:product_id/producttracklistings(.:format)          {:action=>"index", :controller=>"producttracklistings"}
                                         POST   /releases/:release_id/products/:product_id/producttracklistings(.:format)          {:action=>"create", :controller=>"producttracklistings"}
 new_release_product_producttracklisting GET    /releases/:release_id/products/:product_id/producttracklistings/new(.:format)      {:action=>"new", :controller=>"producttracklistings"}
edit_release_product_producttracklisting GET    /releases/:release_id/products/:product_id/producttracklistings/:id/edit(.:format) {:action=>"edit", :controller=>"producttracklistings"}
     release_product_producttracklisting GET    /releases/:release_id/products/:product_id/producttracklistings/:id(.:format)      {:action=>"show", :controller=>"producttracklistings"}
                                         PUT    /releases/:release_id/products/:product_id/producttracklistings/:id(.:format)      {:action=>"update", :controller=>"producttracklistings"}
                                         DELETE /releases/:release_id/products/:product_id/producttracklistings/:id(.:format)      {:action=>"destroy", :controller=>"producttracklistings"}
             release_product_itunes_data GET    /releases/:release_id/products/:product_id/itunes_data(.:format)                   {:action=>"index", :controller=>"itunes_data"}
                                         POST   /releases/:release_id/products/:product_id/itunes_data(.:format)                   {:action=>"create", :controller=>"itunes_data"}
        new_release_product_itunes_datum GET    /releases/:release_id/products/:product_id/itunes_data/new(.:format)               {:action=>"new", :controller=>"itunes_data"}
       edit_release_product_itunes_datum GET    /releases/:release_id/products/:product_id/itunes_data/:id/edit(.:format)          {:action=>"edit", :controller=>"itunes_data"}
            release_product_itunes_datum GET    /releases/:release_id/products/:product_id/itunes_data/:id(.:format)               {:action=>"show", :controller=>"itunes_data"}
                                         PUT    /releases/:release_id/products/:product_id/itunes_data/:id(.:format)               {:action=>"update", :controller=>"itunes_data"}
                                         DELETE /releases/:release_id/products/:product_id/itunes_data/:id(.:format)               {:action=>"destroy", :controller=>"itunes_data"}
                        release_products GET    /releases/:release_id/products(.:format)                                           {:action=>"index", :controller=>"products"}
                                         POST   /releases/:release_id/products(.:format)                                           {:action=>"create", :controller=>"products"}
                     new_release_product GET    /releases/:release_id/products/new(.:format)                                       {:action=>"new", :controller=>"products"}
                    edit_release_product GET    /releases/:release_id/products/:id/edit(.:format)                                  {:action=>"edit", :controller=>"products"}
                         release_product GET    /releases/:release_id/products/:id(.:format)                                       {:action=>"show", :controller=>"products"}
                                         PUT    /releases/:release_id/products/:id(.:format)                                       {:action=>"update", :controller=>"products"}
                                         DELETE /releases/:release_id/products/:id(.:format)                                       {:action=>"destroy", :controller=>"products"}
                                releases GET    /releases(.:format)                                                                {:action=>"index", :controller=>"releases"}
                                         POST   /releases(.:format)                                                                {:action=>"create", :controller=>"releases"}
                             new_release GET    /releases/new(.:format)                                                            {:action=>"new", :controller=>"releases"}
                            edit_release GET    /releases/:id/edit(.:format)                                                       {:action=>"edit", :controller=>"releases"}
                                 release GET    /releases/:id(.:format)                                                            {:action=>"show", :controller=>"releases"}
                                         PUT    /releases/:id(.:format)                                                            {:action=>"update", :controller=>"releases"}
                                         DELETE /releases/:id(.:format)                                                            {:action=>"destroy", :controller=>"releases"} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:51:19.543

您可以删除`:action => 'update'`.

默认情况下，持久化记录指向此操作

```
form_for(@release, :html => { :multipart => true }) do |f| 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:22:38.593

尝试将您更改`action => "update"`为“：url”属性内：

```
:url => { :action => "update" } 
```

# wpf - 在 WPF DataGrid 中，如何在数据网格行外部右键单击时强制失去焦点（并因此提交）

> ID：10585040
> 
> 赞同：4
> 
> 时间：2012-05-14T14:12:01.477
> 
> 标签：wpf, wpfdatagrid

我有一个可以编辑单元格的 DataGrid。当行失去焦点时，属性更改事件会触发，我通过将更改提交到实体对象并最终提交到数据库来处理它。用户可以在数据网格外右键单击并从上下文菜单中选择。一些上下文菜单项依赖于数据网格中的数据（准确地说，它们依赖于提交的数据）。但是，问题在于 DataGrid 外部的右键单击不会从 DataGrid 中移除焦点。这意味着不会提交对当前行的更改。这意味着用户会感到惊讶，因为菜单项命令处理的数据与屏幕上显示的数据不同。我意识到这就是 DataGrid 的工作方式。但是，我也意识到用户永远无法理解这一点。

那么我该如何解决呢？右键单击时可以强制失去焦点吗？或者我可以使用 DataGrid 上的一些特殊属性吗？

（我发现了这一点：[WPF DataGrid CellEditEnding - DataSet Not Updating Till Row Lost Focus](https://stackoverflow.com/questions/6246452/wpf-datagrid-celleditending-dataset-not-updating-till-row-lost-focus)这使得 DataGrid 以每个单元格而不是每行为基础提交，但它不能解决我的问题，因为用户仍然可能会丢失一些数据（虽然只有一个单元格而不是一整行））

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T07:14:41.570

我使用了 LPL 的建议，并创建了一个事件处理程序：

```
 private void ViewUserControl_PreviewMouseRightButtonDown(object sender, MouseButtonEventArgs e)
        {            
            // The purpose of this is to make sure that before the context menu on the outer datagrid is run, the row in the inner datagrid is committed (otherwise we might create orders with different quantities than what the user sees on the screen)
            Keyboard.ClearFocus();
        } 
```

这解决了问题。

# java - “公共”类和未修改类之间的区别？

> ID：10585043
> 
> 赞同：1
> 
> 时间：2012-05-14T14:12:18.643
> 
> 标签：java, class, access-modifiers

> **可能重复：**
> [包可见性](https://stackoverflow.com/questions/5471824/package-visibility)
> [Java - 类“ClassName”和公共类“ClassName”之间的区别](https://stackoverflow.com/questions/7641876/java-the-difference-between-class-classname-and-public-class-classname)

基本上这两个类的修饰符有什么区别吗？没有 public 修饰符有什么区别吗？

```
public class MyClass {}

class MyClass {} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:15:34.063

一个`public`类对任何其他类都是可见的，而一个`class`（没有修饰符）将具有包可见性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:18:25.553

从[Java 规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-6.html#jls-6.6.1)：

*如果一个类或接口类型被声明为 public，那么它可以被任何代码访问，只要声明它的编译单元（第 7.3 节）是可观察的。*

*如果顶级类或接口类型未声明为公共的，则只能从声明它的包内访问它。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:18:28.623

1.Public 类可从其 **包**外部访问，而类则不能。**2.一个源文件**
中只能有一个公共类，并且源文件的名称必须相同。

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T14:15:50.297

默认是包私有[http://docs.oracle.com/javase/tutorial/java/javaOO/accesscontrol.html](http://docs.oracle.com/javase/tutorial/java/javaOO/accesscontrol.html)**

# magento - 从类别 ID 显示特定的 Magento 类别

> ID：10585044
> 
> 赞同：0
> 
> 时间：2012-05-14T14:12:19.623
> 
> 标签：magento, magento-1.6

到目前为止，我还没有设法在网上找到任何已经满足我想要实现的目标的东西。我只是想将特定类别调用到列表中，但我希望能够通过 ID 定义哪些类别，例如，我希望能够像下面这样调用它们：-

```
{{block type="catalog/navigation" name="catalog.category" template="developer/extension/script.phtml" ids="3,6,17,143,57"}} 
```

我已经根据父类别 ID 在各个地方显示子类别列表，但是在有数百个子类别的情况下，显示所有子类别并不总是可行的，所以我想知道现有的脚本是否可以调整为仅包含上述特定类别？

```
<?php
//gets all sub categories of parent category 'cat-id-4'
   $cats = Mage::getModel('catalog/category')->load(4)->getChildren();
   $catIds = explode(',',$cats);

   $categories = array();
foreach($catIds as $catId) {
    $category = Mage::getModel('catalog/category')->load($catId); 
    $categories[$category->getName()] = array(
        'url' => $category->getUrl(),
        'img' => $category->getImageUrl()
    );
}

ksort($categories, SORT_STRING);
?>
<ul>
    <?php if($category->getIsActive()): ?>
    <?php foreach($categories as $name => $data): ?>
        <li>
            <a href="<?php echo $data['url']; ?>" title="<?php echo     $name; ?>" alt="<?php echo $name; ?>"><?php echo $name; ?></a>
        </li>   
    <?php endforeach; ?>
    <?php endif; ?>
</ul> 
```

如果有人可以建议我如何实现这一目标，那将是非常棒的 - 在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:50:35.110

这应该适用于您给定的 CMS 块代码：

```
<?php
$catIds = explode(',', $this->getIds()); //<-- ONLY CHANGE MADE

$categories = array();
foreach($catIds as $catId) {
    $category = Mage::getModel('catalog/category')->load($catId); 
    $categories[$category->getName()] = array(
        'url' => $category->getUrl(),
        'img' => $category->getImageUrl()
    );
}

ksort($categories, SORT_STRING);
?>
<ul>
    <?php if($category->getIsActive()): ?>
    <?php foreach($categories as $name => $data): ?>
        <li>
            <a href="<?php echo $data['url']; ?>" title="<?php echo $name; ?>" alt="<?php echo $name; ?>"><?php echo $name; ?></a>
        </li>   
    <?php endforeach; ?>
    <?php endif; ?>
</ul> 
```

# animation - UIImageView startAnimating 阻塞主线程即使在 NSOperation

> ID：10585051
> 
> 赞同：0
> 
> 时间：2012-05-14T14:12:50.883
> 
> 标签：animation, uiimageview, png

我正在为大约 250 帧的一系列 PNG 序列制作动画。我这样做而不是作为 H264 运行它，因为我需要背景透明度。

出于某种原因，即使我加载了我的 NSArray 并在 NSInvocationOperation 中加载了 startAnimating 调用，在调用 startAnimating 后 UI 似乎冻结了。我可以看到，当图像被加载到数组中时，应用程序仍然响应。我不确定如何阻止 startAnimating 阻塞主线程。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T01:00:29.793

在主线程上完成对 startAnimating 的调用很重要 - 所有 UIKit 活动都必须发生在主威胁上。您可以通过将方法调用更改为以下内容来做到这一点：

```
[imageView performSelectorOnMainThread:@selector(startAnimating) withObject:nil waitUntilDone:NO]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T18:24:03.070

最终切换到CoreMedia

# php - PHP：addslashes() 对回显的 HTML/JS 字符串也有效吗？

> ID：10585061
> 
> 赞同：0
> 
> 时间：2012-05-14T14:13:27.623
> 
> 标签：php, escaping

我不是 PHP 专家，但我必须涵盖以下情况：

```
<?php

  ...

  if ($some_condition_is_met) {
    echo ' ...a lot of HTML/JS statements I ...';
  } else {
    echo ' ...a lot of HTML/JS statements II...';
  }

?> 
```

我的问题是 HTML/JS 语句包含单引号和双引号。我可以使用[addslashed()](http://www.php.net/manual/en/function.addslashes.php)方法正确地转义那些回显语句（它用于数据库语句）吗？还是有其他有效的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:15:24.883

我相信您正在寻找[mysql_real_escape_string](http://php.net/manual/en/function.mysql-real-escape-string.php)函数。

# c++ - C++ 的标准映射插入语义的基本原理？

> ID：10585064
> 
> 赞同：25
> 
> 时间：2012-05-14T14:13:34.100
> 
> 标签：c++, map, standard-library

`std::map::insert`我对's 的语义有点困惑。我的意思是，我没有抱怨 - 标准就是标准，API 就是它的样子。仍然，

[`insert`](http://www.cplusplus.com/reference/stl/map/insert/)将要

> 插入操作检查每个插入的元素是否在容器中已经存在具有相同键值的另一个元素，如果存在，则不插入该元素并且其映射值不会以任何方式更改。

而且 - 只有在其单参数版本中，`pair<iterator,bool> insert ( const value_type& x );`它才会告诉您它是否甚至将（新的，可能不同的）值插入到键中。据我了解，如果密钥已经存在，迭代器版本将默默地忽略插入。

对我来说，这简直是违反直觉的，*我本来希望值部分被覆盖，旧值部分*在插入时被丢弃。显然，STL 的设计者有不同的想法——**任何人都知道（历史）基本原理，或者可以对现有语义如何（更多）有意义给出彻底的解释？**

**举例：**

有几种基本方法可以在单键映射中实现插入，例如`std::map`：

*   插入，如果已经存在则替换
*   插入，如果已经存在则忽略（*这是 std::map 的行为*）
*   插入，如果已经存在则抛出错误
*   插入，UB 如果已经存在

我现在试图理解为什么比（或）`insert_or_ignore`更有意义！`insert_or_replace``insert_or_error`

* * *

[我查看了我的TC++PL](http://www.stroustrup.com/3rd.html)副本（不幸的是，我只有德语版），有趣的是，Stroustrup 在第 17.4.1.7 章（*map*的列表操作）中写道：（抱歉，德语粗略翻译）

> (...) 通常，人们不在乎键（原文如此！）是新插入的还是在调用`insert()`(...)之前已经存在

在我看来，这仅适用于*set*，而不适用于*map*，因为对于地图，如果插入提供的值或旧的值保留在地图中，它确实会产生很大的不同。（这显然与密钥无关，因为它是等效的。）

* * *

注意：我知道`operator[]`并且我知道[有效 STL](http://my.safaribooksonline.com/book/programming/cplusplus/9780321545183/associative-containers/ch03lev1sec6)的第 24 项以及那里提出的`efficientAddOrUpdate`功能。我只是对`insert`'s 语义的基本原理感到好奇，因为我个人发现它们违反直觉。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T14:33:53.813

插入方法不是您正在寻找的，听起来像......插入方法是为了做顾名思义......插入值。我同意在某些情况下创建一个不存在的值并替换存在的值的能力很重要，但在其他情况下，你真的宁愿不处理异常、返回值等，如果你只是仅当值不存在时才想做插入。

听起来您正在寻找的方法（如上面的 BoBTFish 所示）可能是`[]`运算符。像这样使用它：

```
myMap["key"] = "value"; 
```

这将遍历您的地图并找到键“key”，并将相应的值替换为“value”。如果密钥不存在，它将创建它。这两种方法在不同的情况下都非常有用，我发现自己使用这两种方法只是取决于我需要什么。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-14T15:20:40.623

我不知道官方的理由，但我会注意到与`operator[]`.

很明显，人们会喜欢两种类型的插入：

*   纯加法
*   添加剂/破坏性

如果我们将 a`map`视为数组的稀疏表示，那么存在是`operator[]`有意义的。我不知道预先存在的字典是否存在并规定了这种语法（也许，为什么不）。

此外，*所有*STL 容器都有多个`insert`.

因此，我们至少有两个 API 竞争者：`operator[]`和`insert`.

现在，在 C++ 中，如果您阅读：

```
array[4] = 5; 
```

很自然，索引处的单元格内容`4`已被破坏性更新。因此，很自然`map::operator[]`应该返回一个引用以允许这种破坏性更新。

在这一点上，我们现在也需要一个纯粹的加法版本，并且我们有这个`insert`方法。为什么不 ？

**当然，**可以给出`insert`相同的语义`operator[]`，然后继续*在 top 上*`insert_or_ignore`实现一个方法。不过，这将是更多的工作。

 *因此，虽然我同意这可能令人惊讶，但我认为我的推理并没有太大的缺陷，并且可能是对导致我们来到这里的情况的一个可能的解释:)

* * *

关于您提出的替代方案：

> *   插入，UB 如果已经存在

幸运的是，它不是！

> *   插入，如果已经存在则抛出错误

只有 Java（和衍生产品）是异常疯狂的。C++ 是在异常情况下使用异常的时代构思的。

> *   插入，如果已经存在则替换
> *   插入，如果已经存在则忽略（这是 std::map 的行为）

我们同意选择是其中之一。请注意，即使`map`选择了第二个选项，它也不会完全*忽略*该项目已经存在的事实，至少在单个项目版本中是这样，因为它会警告您该项目未插入。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-19T16:37:18.767

我不声称知道这个决定的最初理由，但编造一个并不难。我认为 ;-）

“插入或忽略”的当前行为使得实现其他两个非常容易——至少对于我们这些不高于创建和使用非成员函数来补充标准库功能的人来说（“这不是 OOP-够了！”）。

示例（当场编写，因此可能存在错误）：

```
template<typename Map>
void insert_or_update(Map& map, typename Map::value_type const& x)
{
  std::pair<typename Map::iterator, bool> result = map.insert(x);
  if (!result.second)
    result.first->second = x.second; // or throw an exception (consider using
                                     // a different function name, though)
} 
```

请注意，按原样，上面的函数并没有太大的不同`operator[]`——是的，它避免了默认初始化，但同时（因为我很懒）它没有利用你最多的移动语义—— date STL 可能已经支持`operator[]`.

Anyhow, any other insert behaviour for `map` would've made it more tedious to implement the others, as `map::find` only returns an end sentinel if the key isn't already in the map. With the help of `<algorithm>` (and especially `lower_bound`) it would, of course, still be possible to write performant accessory functions without drowning them implementation details and ugly generic constructs such as loops ;-).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T14:25:39.793

从`insert()`您不希望触及容器中的现有对象。这就是为什么它简单不触及它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T14:33:15.857

`pair<iterator,bool>`<- bool 部分不告诉插入是否成功？

如果 bool 部分为 false，您可以只更新返回的迭代器的 value 部分，以使用相同的键更新现有项目。*

# database - 如何在 ADS 中创建具有管理员权限的新用户？

> ID：10585066
> 
> 赞同：0
> 
> 时间：2012-05-14T14:13:44.947
> 
> 标签：database, command, advantage-database-server

在 Advantage 数据库服务器中创建具有管理员权限的新用户的命令是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T17:59:21.520

使用 SQL，您可以执行以下操作

```
--Create User
EXECUTE PROCEDURE sp_CreateUser('username', 'password', 'comment');

--Add the user to the DB:Admin group
EXECUTE PROCEDURE sp_AddUserToGroup('username','DB:Admin'); 
```

# visual-c++ - X264vfw avc 编解码器与 GDCL Mpeg4 多路复用器的 directshow 过滤器连接失败

> ID：10585067
> 
> 赞同：0
> 
> 时间：2012-05-14T14:13:47.670
> 
> 标签：visual-c++, directshow, video-capture, mp4

我需要制作一个 directshow 应用程序来从源捕获 mp4 视频，我正在使用下图来执行此操作，

```
Input Stream --> MJPEG Decompressor --> x264vfw H.264/MPEG-4 AVC Codec --> GDCL Mpeg-4 Multiplexor --> File Writer 
```

但是当连接过滤器 x264vfw H.264/MPEG-4 AVC Codec 和 GDCL Mpeg-4 Multiplexor 时，我得到了错误。HRESULT = -2147220969

任何人都可以对此有任何想法，如何使其工作。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:50:33.247

> 错误。HRESULT = -2147220969

这是您的错误：：`0x80040217`找不到中间过滤器的组合来建立连接。即，`VFW_E_CANNOT_CONNECT`。您正在尝试连接无法连接。

# image - 扑克牌翻转动画

> ID：10585068
> 
> 赞同：5
> 
> 时间：2012-05-14T14:13:54.220
> 
> 标签：image, delphi, animation, flip

您知道任何可以实现 3D 翻转效果的免费组件/库吗？

在这里演示：[snorkl.tv](http://www.snorkl.tv/2010/12/easy-breezy-3d-card-flip-effect-with-flash-as3-and-our-good-buddy-timelinemax/)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T04:10:14.997

这是使用的尝试`SetWorldTransform`：

```
type
  TForm1 = class(TForm)
    PaintBox1: TPaintBox;
    Button1: TButton;
    Timer1: TTimer;
    procedure FormCreate(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
    procedure PaintBox1Paint(Sender: TObject);
    procedure Timer1Timer(Sender: TObject);
    procedure Button1Click(Sender: TObject);
  private
    FFrontBmp, FBackBmp: TBitmap;
    FBmps: array [Boolean] of TBitmap;
    FXForm: TXForm;
    FStep: Integer;
  end;

var
  Form1: TForm1;

implementation

uses
  Math;

{$R *.dfm}

procedure TForm1.FormCreate(Sender: TObject);
begin
  FFrontBmp := TBitmap.Create;
  FFrontBmp.LoadFromFile(ExtractFilePath(Application.ExeName) + '53.bmp');
  FBackBmp := TBitmap.Create;
  FBackBmp.LoadFromFile(ExtractFilePath(Application.ExeName) + 'b1fv.bmp');
  FBmps[True] := FFrontBmp;
  FBmps[False] := FBackBmp;

  FXForm.eM11 := 1;
  FXForm.eM12 := 0;
  FXForm.eM21 := 0;
  FXForm.eM22 := 1;
  FXForm.eDx := 0;
  FXForm.eDy := 0;

  Timer1.Enabled := False;
  Timer1.Interval := 30;
end;

procedure TForm1.FormDestroy(Sender: TObject);
begin
  FFrontBmp.Free;
  FBackBmp.Free;
end;

procedure TForm1.PaintBox1Paint(Sender: TObject);
begin
  SetGraphicsMode(PaintBox1.Canvas.Handle, GM_ADVANCED);
  SetWorldTransform(PaintBox1.Canvas.Handle, FXForm);
  PaintBox1.Canvas.Draw(0, 0, FBmps[FStep < 20]);
end;

procedure TForm1.Timer1Timer(Sender: TObject);
var
  Bmp: TBitmap;
  Sign: Integer;
begin
  Inc(FStep);

  Sign := math.Sign(FStep - 20);
  FXForm.eM11 := FXForm.eM11 + 0.05 * Sign;
  FXForm.eM21 := FXForm.eM21 - 0.005 * Sign;
  FXForm.eDx := FXForm.eDx - 1 * Sign;
  if FStep = 39 then begin
    Timer1.Enabled := False;
    PaintBox1.Refresh;
  end else
    PaintBox1.Invalidate;

  if not Timer1.Enabled then begin
    Bmp := FBmps[True];
    FBmps[True] := FBmps[False];
    FBmps[False] := Bmp;
  end;
end;

procedure TForm1.Button1Click(Sender: TObject);
begin
  Timer1.Enabled := True;
  FStep := 0;
end; 
```

如果我有一些数学能力，我不确定这是否有机会变成漂亮的东西，但目前它的外观如下：

![在此处输入图像描述](../Images/d58fa80449c39f22e555c4109db0ba8d.png)

使用的图像：  ![在此处输入图像描述](../Images/a243df2f7392ea1f03b1cd018b7f5573.png)  ![在此处输入图像描述](../Images/918b4be428c6ae67f7459c4687652e7e.png)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-14T16:07:29.753

像这样的东西可能会产生类似的效果（只是另一个尝试展示如何做到这一点，也不是那么精确，但这只是为了好玩，因为你已经要求一个库或组件）。该原理基于一个矩形，该矩形正在调整大小并在使用该函数渲染卡片的油漆框中*居中：*`StretchDraw`

***单元1.pas***

```
unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, ExtCtrls, PNGImage;

type
  TCardSide = (csBack, csFront);
  TForm1 = class(TForm)
    Timer1: TTimer;
    Timer2: TTimer;
    PaintBox1: TPaintBox;
    procedure FormCreate(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
    procedure Timer1Timer(Sender: TObject);
    procedure Timer2Timer(Sender: TObject);
    procedure PaintBox1Click(Sender: TObject);
    procedure PaintBox1Paint(Sender: TObject);
  private
    FCardRect: TRect;
    FCardSide: TCardSide;
    FCardBack: TPNGImage;
    FCardFront: TPNGImage;
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.FormCreate(Sender: TObject);
begin
  FCardSide := csBack;
  FCardRect := PaintBox1.ClientRect;
  FCardBack := TPNGImage.Create;
  FCardBack.LoadFromFile('tps2N.png');
  FCardFront := TPNGImage.Create;
  FCardFront.LoadFromFile('Ey3cv.png');
end;

procedure TForm1.FormDestroy(Sender: TObject);
begin
  FCardBack.Free;
  FCardFront.Free;
end;

procedure TForm1.Timer1Timer(Sender: TObject);
begin
  if FCardRect.Right - FCardRect.Left > 0 then
  begin
    FCardRect.Left := FCardRect.Left + 3;
    FCardRect.Right := FCardRect.Right - 3;
    PaintBox1.Invalidate;
  end
  else
  begin
    Timer1.Enabled := False;
    case FCardSide of
      csBack: FCardSide := csFront;
      csFront: FCardSide := csBack;
    end;
    Timer2.Enabled := True;
  end;
end;

procedure TForm1.Timer2Timer(Sender: TObject);
begin
  if FCardRect.Right - FCardRect.Left < PaintBox1.ClientWidth then
  begin
    FCardRect.Left := FCardRect.Left - 3;
    FCardRect.Right := FCardRect.Right + 3;
    PaintBox1.Invalidate;
  end
  else
    Timer2.Enabled := False;
end;

procedure TForm1.PaintBox1Click(Sender: TObject);
begin
  Timer1.Enabled := False;
  Timer2.Enabled := False;
  FCardRect := PaintBox1.ClientRect;
  Timer1.Enabled := True;
  PaintBox1.Invalidate;
end;

procedure TForm1.PaintBox1Paint(Sender: TObject);
begin
  case FCardSide of
    csBack: PaintBox1.Canvas.StretchDraw(FCardRect, FCardBack);
    csFront: PaintBox1.Canvas.StretchDraw(FCardRect, FCardFront);
  end;
end;

end. 
```

***单元1.dfm***

```
object Form1: TForm1
  Left = 0
  Top = 0
  Caption = 'Form1'
  ClientHeight = 203
  ClientWidth = 173
  Color = clBtnFace
  DoubleBuffered = True
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'Tahoma'
  Font.Style = []
  OldCreateOrder = False
  Position = poScreenCenter
  OnCreate = FormCreate
  OnDestroy = FormDestroy
  PixelsPerInch = 96
  TextHeight = 13
  object PaintBox1: TPaintBox
    Left = 48
    Top = 40
    Width = 77
    Height = 121
    OnClick = PaintBox1Click
    OnPaint = PaintBox1Paint
  end
  object Timer1: TTimer
    Enabled = False
    Interval = 10
    OnTimer = Timer1Timer
    Left = 32
    Top = 88
  end
  object Timer2: TTimer
    Enabled = False
    Interval = 10
    OnTimer = Timer2Timer
    Left = 88
    Top = 88
  end
end 
```

***牌***

![在此处输入图像描述](../Images/3d8684807882523fed33e72396408258.png) ![在此处输入图像描述](../Images/be0126091eaf3de591c22526de5616c7.png)

# c# - 如何在 OnRender 中重绘或刷新？

> ID：10585069
> 
> 赞同：6
> 
> 时间：2012-05-14T14:14:04.050
> 
> 标签：c#, wpf, drawing, onrender

我想动态地绘制一些东西。以下代码显示了我的 OnRender。我在我的程序中需要它的某个地方设置了 DrawItem。但是当我打电话时`DrawItem =5;`，我必须调用什么，以便调用 OnRender？

```
protected override void OnRender(DrawingContext drawingContext)
{
    switch (DrawItem)
    {
        case 1:
            //Draw Item 
            break;
        case 2:
            //Draw Item 
            break;
        case 3:
            //Draw Item 
            break;
        case 4:
            //Draw Item 
            break;
        case 5:
            //Draw Item 
            break;
    }
    base.OnRender(drawingContext)
}

public int DrawItem { get; set; } 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2017-06-08T04:43:23.433

如果控件的大小发生变化，您可以使用`InvalidateVisual()`，但请记住，这会导致您的 UI 重新布局相当昂贵。如果控件的大小保持不变，则不应调用`InvalidateVisual()`.

更新 UI 的更有效方法是创建`DrawingGroup`“后备存储”并将其添加到`DrawingContext`during `OnRender()`. 然后，您可以随时使用 更新它`DrawingGroup.Open()`，WPF 将更新您的 UI。

如果这听起来令人困惑，请记住 WPF 是一个*保留*的绘图系统。这意味着`OnRender()`最好称为`AccumulateDrawingObjects()`. 它实际上是在累积一个实时绘图对象树，其中一些（如 DrawingGroup、RenderTargetBitmap 和 WriteableBitmap）可以稍后更新。

这是它的样子：

```
DrawingGroup backingStore = new DrawingGroup();

protected override void OnRender(DrawingContext drawingContext) {      
    base.OnRender(drawingContext);            

    Render(); // put content into our backingStore
    drawingContext.DrawDrawing(backingStore);
}

// I can call this anytime, and it'll update my visual drawing
// without ever triggering layout or OnRender()
private void Render() {            
    var drawingContext = backingStore.Open();
    Render(drawingContext);
    drawingContext.Close();            
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-14T14:17:39.173

您的问题尚不清楚，但据我所知，您似乎在要求一种在更新绘图变量后刷新视觉效果的方法。更新绘图变量后，您可以使用以下内容：

```
this.InvalidateVisual(); 
```

并具有以下属性：

```
private int drawItem;
pulic int DrawItem
{
 get {return drawItem;}
 set 
 {
    drawItem=value;
    this.InvalidateVisual();
 }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-03-08T18:37:16.643

我遇到了类似的问题，并找到了一个更优雅的解决方案。像这样定义一个 DependencyProperty：

```
public static readonly DependencyProperty PropertyNameProperty = DependencyProperty.Register("PropertyName", typeof(PropertyType), typeof(PropertyElementType), new FrameworkPropertyMetadata(DefaultPropertyValue, FrameworkPropertyMetadataOptions.AffectsRender)); 
```

这里的关键是：

```
FrameworkPropertyMetadataOptions.AffectsRender 
```

所以现在可以在 XAML 中设置属性，并在更改时自动更新视觉对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T14:19:56.827

[http://msdn.microsoft.com/de-de/library/ms598919(v=vs.100).aspx](http://msdn.microsoft.com/de-de/library/ms598919(v=vs.100).aspx)

您必须为要更新的控件调用 InvalidateVisual。但是正如您所读到的，对 InvalidateVisual 的调用会导致一个完整的布局周期，因此出于性能原因，请确保您的画布或您想要绘制的任何内容不包含或仅包含几个子元素。

# php - 如果表中的相应记录不存在（php/mysql），则需要从网络服务器中删除文件（图像）

> ID：10585071
> 
> 赞同：-1
> 
> 时间：2012-05-14T14:14:13.120
> 
> 标签：php, mysql

我每天上传几千张图片到我的网络服务器。

图像文件名采用以下格式： photoXXXXXXX-Y.jpeg 其中 XXXXXXX 是记录 ID，Y 是图像数量。（示例 - photo1357936-2.jpeg）

在 MySQL 表中，有一列包含记录 id (sysid) 和一列 Y (num_of_photos)。最多有 12 张图片与一个 id 关联。

该表每天更新，并添加或删除包含 id 的记录。

我需要以某种方式遍历 id 并与图像文件名的记录 id 部分进行比较，然后删除不再与给定 id 关联的图像。

或者将图像文件名的记录 id 部分与 id 进行比较，然后删除孤立的图像。哪个逻辑更合理。

我可以使用 CRON 自动执行此任务，并且知道如何取消设置以删除文件，但不知道从哪里开始其余的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:20:25.787

> 有任何想法吗？

您实际上在自己的问题中回答了。

> 我需要以某种方式遍历 id 并与图像文件名的记录 id 部分进行比较，然后删除不再与给定 id 关联的图像。

不过，给你一些面包屑：

1) [`opendir`](http://www.php.net/opendir)&[`readdir`](http://www.php.net/readdir)迭代文件/文件夹以获取文件名（可能是递归的）

2)[`preg_match`](http://www.php.net/preg_match)获取文件名的 X 和 Y 部分

3）[`mysql_query`](http://www.php.net/mysql_query)（`mysql_connect`当然之前有等）获取X和Y的记录。

4）[`mysql_num_rows`](http://www.php.net/mysql_num_rows)查看DB中是否有条目

5）如果不是：[`unlink`](http://www.php.net/unlink)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-24T09:03:25.707

```
ini_set('display_errors', 1);
ini_set('display_startup_errors', 1);
error_reporting(E_ALL);

// path to the images
$path_img='./media/images/inside/gallery';
// where images are listed in database
$table_name='gallery';
$field_name='file';
// unnecessary parts of filenames
$odd_tokens = array("_small", ".jpg", ".");

// limit number of image files to check, set to 10 for testing
$limit=10;
echo "begin\r\n";

//connection constants 
include './application/config/config.php';

try{
$pdo = new PDO( 'mysql:host='.config::$db_server.';dbname='.config::$db_name, config::$db_user, config::$db_pass );
}
catch (Exception $e){
    echo $e->getMessage();
    exit();
}

$pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$r=$pdo->query('select count(1) cnt from '.$table_name)->fetch();
echo 'count images in database: '.$r['cnt']."\r\n";

// reset some counters
$cnt_files=0;
$cnt_checked=0;
$cnt_not_found=0;
$cnt_found=0;
$path=$path_img;
if ($handle = opendir($path)) {
while ($cnt_files != $limit && false !== ($entry = readdir($handle))) {
    if ($entry != "." && $entry != "..") {
            $cnt_files++;
            if($entry > "") {
                    $cnt_checked++;
                    $img_name = str_replace ($odd_tokens,'',$path . '/' . $entry);

                    if(!checkExistsDb($pdo, $img_name, $table_name, $field_name)) {
                            $cnt_not_found++;
                            echo 'rm ' . $path . '/' . $entry . "\r\n";
//this will delete files                                unlink($path.'/'.$entry);
                    } else {
                            $cnt_found++;
                    }
            }
    }
}
closedir($handle);
}
else echo 'not found: '.$path."\r\n";
unset($pdo); 
echo 'files: '.$cnt_files.' checked: '.$cnt_checked.' not_found: '.$cnt_not_found.' found: '.$cnt_found;

function checkExistsDb($pdo, $img_name, $table_name, $field_name) {

    try{
    $st = $pdo->prepare('SELECT ' . $field_name . ' FROM ' . $table_name . ' WHERE '. $field_name . '=:filename');
    $st->execute(array(':filename'=>$img_name));
    $result = $st->fetchAll();
    }
    catch (PDOException $e) {
    echo $e->getMessage();
    }
    return $result?true:false;
} 
```

感谢 [https://www.prestashop.com/forums/topic/290936-cleanup-imgp-folder-and-image-folder-questions/](https://www.prestashop.com/forums/topic/290936-cleanup-imgp-folder-and-image-folder-questions/)

# iphone - 在后台加载 MKMapView 并从中创建 UIImage (iPhone & iPad)

> ID：10585073
> 
> 赞同：4
> 
> 时间：2012-05-14T14:14:22.693
> 
> 标签：iphone, ipad, uiimage, mkmapview

我有一种情况，我需要一种加载具有多个叠加层的 MKMapView 的方法。此地图视图不应显示在屏幕上，我要求加载它的唯一原因是为了从地图创建图像以在其他地方使用。

我在网上浏览了一下，但我没有找到解决问题的方法。请问有人可以帮我吗？

这是我迄今为止尝试过的（没有成功）

```
// Load the map view
Logs_Map_ViewController *mapViewController = [[Map_ViewController alloc] initWithNibName:@"Map_ViewController" bundle:nil];
mapViewController.GPSCoordinatesToPlot = [someDictionary objectForKey:kGPSCoords];

// Take a picture of the map
UIImage *mapImage = [mapViewController convertMapToImage];
NSData *imageData = [NSData dataWithData:UIImagePNGRepresentation(mapImage)];
NSString *base64String = [imageData base64EncodedString]; 
```

**注意：**应用程序等待地图完全加载（以便正确创建图像）非常重要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T20:53:52.930

这可能有帮助，也可能没有帮助，但这是我在我的情况下所做的。

我有一个包含 7 个表格单元的场所/企业的表格视图。其中一个表格单元包含一个带有 pindrop 的地图。当用户第一次查看设施时，我运行一个快速条件来查看地图视图是否已被缓存（或者更确切地说，保存为图像）。如果图像不存在，我将一个新的地图视图加载到单元格中并添加一个 pindrop 注释。在地图视图都加载并且注释已删除后，我将视图图层保存到图像，然后从单元格中删除地图视图（并释放它，因为我们需要保持代理活动）并替换为新的新图像。我建议生成一个后台线程以将图像/插入保存到单元格中。这样表格视图就不会阻塞。

最后，下次用户返回同一个场所/企业时，地图视图图像存在，我加载图像。

我知道完全加载地图很重要，否则您的图像会在地图未加载的地方以灰色保存。如果您要放置图钉放置，则需要确保在地图完成加载 (mapViewDidFinishLoadingMap:) 和注释已删除 (mapView:didAddAnnotationViews:) 后触发图像保存方法。只有在两者都完成后，您才能触发保存图像的方法。我建议使用延迟选择器。我将其延迟 1 秒。

同样的概念肯定可以应用于其他情况。底线是，正如 strings42 所述，您将不得不在视图中添加可见的地图视图才能捕获图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T17:16:15.740

我想你应该能够`mapViewDidFinishLoadingMap`在`MKMapViewDelegate`协议中实现并将你的图像存储在那里。那应该解决需要等到地图加载才能存储图像的问题。

如果您还看到其他问题，请提供更多详细信息，因为您的问题不清楚您要询问的具体问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-24T14:53:43.017

下面的方法将始终作为 mapView 的委托调用，

```
mapViewDidFinishRenderingMap:fullyRendered: 
```

所以，你可以在这里从 mapView 获取地图图像

```
- (UIImage *)renderToImage:(MKMapView *)mapView
{
  UIGraphicsBeginImageContext(mapView.bounds.size);
  [mapView.layer renderInContext:UIGraphicsGetCurrentContext()];
  UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
  UIGraphicsEndImageContext();
  return image;
} 
```

# css - 客户端 LESS 没有使用我写的样式

> ID：10585078
> 
> 赞同：0
> 
> 时间：2012-05-14T14:14:35.663
> 
> 标签：css, less

这是页面的 HTML 内容：

```
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
    <script src="js/less-1.3.0.min.js" type="text/javascript"></script>
    <link rel="stylesheet/less" type="text/css" href="style.less" >    
</head> 
```

如果我在 Google Chrome 中打开源代码并在新选项卡中打开以查看更少的 javascript 文件和我编写的更少样式表，我可以看到内容，这意味着它们已正确链接。

为什么没有应用我的 LESS 样式？

编辑：即使从 WAMP 运行它以避免整个“file:///”问题，也不会应用样式。

编辑：

.less 文件的内容：

```
html, body {
    margin:0;
    padding:0;
}

#headbg {
    height:497px;
    background-color:red;
}

#header-wrapper {
    width:980px;
    margin-left:auto;
    margin-right:auto;
    overflow:hidden;
}

#header-wrapper #left-container {
    float:left;
    position:relative;
    outline:1px solid cyan;    
}

#logo {
    margin-left:10px;
    display:block;
}

#logo-hue {
    position:absolute;
    top:20px;
}

#social {
    float:left;
    color:#fff;
}

#social .message {
    text-align:center;
}

#social .contact {
    text-align:center;
}

#header-wrapper #carusel-container {
    float:left;
    outline:1px solid cyan;
}

#bodybg {
    background-color:#fff;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:32:46.947

将样式表引用放在任何其他引用之上。

```
<head>
    <link rel="stylesheet/less" type="text/css" href="style.less" >    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
    <script src="js/less-1.3.0.min.js" type="text/javascript"></script>
</head> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:43:53.057

Ryan's answer is right : however with Js and Css theory says Js will start working soon as loaded depends on which function is called. but when js script is running - the css is not yet loaded. so alwasy load css first so that js ( if they working straight e.g. document.ready() ) - they have all properties, styles available which they require.

And for the same reason you should include jquery file first ( if you are using it ) before trying any of their plugins.

Hope it helps

# java - 如何在 JSF 中创建有效的“全选”复选框

> ID：10585080
> 
> 赞同：3
> 
> 时间：2012-05-14T14:14:38.503
> 
> 标签：java, javascript, jsf, jsf-2

我想在 JSF 中实现全选复选框`h:datatable`。这是代码，如果`h:datatable`：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"    
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">
    <h:head>
        <ui:insert name="header">           
            <ui:include src="header.xhtml"/>         
        </ui:insert>
    </h:head>
    <h:body>

        <h1><img src="resources/css/images/icon.png" alt="DX-57" /> History Center</h1>
        <!-- layer for black background of the buttons -->
        <div id="toolbar" style="margin: 0 auto; width:1180px; height:30px; position:relative;  background-color:black">
            <!-- Include page Navigation -->
            <ui:insert name="Navigation">           
                <ui:include src="Navigation.xhtml"/>         
            </ui:insert>

        </div>  

        <div id="logodiv" style="position:relative; top:35px; left:0px;"> 
            <h:graphicImage alt="Dashboard"  style="position:relative; top:-20px; left:9px;"  value="resources/images/logo_sessions.png" />
        </div>
        <div id="main" style="margin: 0 auto; width:1190px; height:700px; position:absolute;  background-color:transparent; top:105px">

            <div id="mainpage" style="margin: 0 auto; width:1190px; height:500px; position:absolute;  background-color:transparent; top:80px">

                <div id="settingsHashMap" style="width:750px; height:400px; position:absolute;  background-color:r; top:20px; left:1px">

                    <h:form id="form">

                        <ui:debug />

                        <!-- The sortable data table -->
                        <h:dataTable id="dataTable" value="#{SessionsController.dataList}" binding="#{table}" var="item">
                            <!-- Check box -->
                            <h:column>
                                <f:facet name="header">
                                    <h:outputText value="Select" />
                                </f:facet>
                                <h:selectBooleanCheckbox onclick="highlight(this)" value="#{SessionsController.selectedIds[item.aSessionID]}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">
                                    <h:commandLink value="№" actionListener="#{SessionsController.sort}">
                                        <f:attribute name="№" value="№" />
                                    </h:commandLink>
                                </f:facet>
                                <h:outputText value="#{table.rowIndex + SessionsController.firstRow + 1}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">
                                    <h:commandLink value="Account Session ID" actionListener="#{SessionsController.sort}">
                                        <f:attribute name="sortField" value="Account Session ID" />
                                    </h:commandLink>
                                </f:facet>
                                <h:outputText value="#{item.aSessionID}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">
                                    <h:commandLink value="User ID" actionListener="#{SessionsController.sort}">
                                        <f:attribute name="sortField" value="User ID" />
                                    </h:commandLink>
                                </f:facet>
                                <h:outputText value="#{item.userID}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">
                                    <h:commandLink value="Activity Start Time" actionListener="#{SessionsController.sort}">
                                        <f:attribute name="sortField" value="Activity Start Time" />
                                    </h:commandLink>
                                </f:facet>
                                <h:outputText value="#{item.activityStart}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">
                                    <h:commandLink value="Activity End Time" actionListener="#{SessionsController.sort}">
                                        <f:attribute name="sortField" value="Activity End Time" />
                                    </h:commandLink>
                                </f:facet>
                                <h:outputText value="#{item.activityEnd}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">
                                    <h:commandLink value="Activity" actionListener="#{SessionsController.sort}">
                                        <f:attribute name="sortField" value="Activity" />
                                    </h:commandLink>
                                </f:facet>
                                <h:outputText value="#{item.activity}" />
                            </h:column>
                        </h:dataTable>

                        <!-- The paging buttons -->
                        <h:commandButton value="first" action="#{SessionsController.pageFirst}"
                                         disabled="#{SessionsController.firstRow == 0}" >
                            <f:ajax render="@form" execute="@form"></f:ajax>
                        </h:commandButton>

                        <h:commandButton value="prev" action="#{SessionsController.pagePrevious}"
                                         disabled="#{SessionsController.firstRow == 0}" >
                            <f:ajax render="@form" execute="@form"></f:ajax>
                        </h:commandButton>

                        <h:commandButton value="next" action="#{SessionsController.pageNext}"
                                         disabled="#{SessionsController.firstRow + SessionsController.rowsPerPage >= SessionsController.totalRows}" >
                            <f:ajax render="@form" execute="@form"></f:ajax>
                        </h:commandButton>    

                        <h:commandButton value="last" action="#{SessionsController.pageLast}"
                                         disabled="#{SessionsController.firstRow + SessionsController.rowsPerPage >= SessionsController.totalRows}" >
                            <f:ajax render="@form" execute="@form"></f:ajax>
                        </h:commandButton>

                        <h:outputText value="Page #{SessionsController.currentPage} / #{SessionsController.totalPages}" />
                        <br />

                        <!-- The paging links -->
                        <ui:repeat value="#{SessionsController.pages}" var="page">
                            <h:commandLink value="#{page}" actionListener="#{SessionsController.page}"
                                           rendered="#{page != SessionsController.currentPage}" >
                                <f:ajax render="@form" execute="@form"></f:ajax>   
                            </h:commandLink>
                            <h:outputText value="#{page}" escape="false"
                                          rendered="#{page == SessionsController.currentPage}" />
                        </ui:repeat>
                        <br />

                        <!-- Set rows per page -->
                        <h:outputLabel for="rowsPerPage" value="Rows per page" />
                        <h:inputText id="rowsPerPage" value="#{SessionsController.rowsPerPage}" size="3" maxlength="3" />
                        <h:commandButton value="Set" action="#{SessionsController.pageFirst}" >
                            <f:ajax render="@form" execute="@form"></f:ajax>
                        </h:commandButton>
                        <h:message for="rowsPerPage" errorStyle="color: red;" />

                        <h:commandButton value="Delete" action="#{SessionsController.deleteSelectedIDs}" >

                        </h:commandButton>

                    </h:form>                  

                </div>   

                <div id="settingsdivb" style="width:350px; height:400px; position:absolute;  background-color:transparent; top:20px; left:800px">

                </div>   
            </div>  
        </div>
    </h:body>
</html> 
```

这是托管 bean：

```
package com.DX_57.HM_57;
/*
 * include default packages for Beans
 */

import java.io.Serializable;
import javax.enterprise.context.SessionScoped;
// or import javax.faces.bean.SessionScoped;
import javax.inject.Named;
/*
 * include SQL Packages
 */
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.*;
import javax.annotation.PostConstruct;
import javax.sql.DataSource;
import javax.annotation.Resource;
import javax.faces.bean.ViewScoped;
import javax.faces.component.UICommand;
import javax.faces.context.FacesContext;
import javax.inject.Inject;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpSession;
// or import javax.faces.bean.ManagedBean; 
import javax.faces.event.ActionEvent;

import org.glassfish.osgicdi.OSGiService;

@Named("SessionsController")
@ViewScoped
public class Sessions implements Serializable {

    /*
     * Call the Oracle JDBC Connection driver
     */
    @Resource(name = "jdbc/Oracle")
    private DataSource ds;
    // Data.
    private List<ActiveSessionObj> dataList;
    // Rows
    private int totalRows;
    // Paging.
    private int firstRow;
    private int rowsPerPage;
    private int totalPages;
    private int pageRange;
    private Integer[] pages;
    private int currentPage;
    // Sorting.
    private String sortField;
    private boolean sortAscending;

    /*
     * Constructor
     */
    public Sessions() {
        /*
         * Set default properties
         */
        rowsPerPage = 10; // Default rows per page (max amount of rows to be displayed at once).
        pageRange = 10; // Default page range (max amount of page links to be displayed at once).
        sortField = "ASESSIONID"; // Default sort field.
        sortAscending = true; // Default sort direction.
    }

    public class ActiveSessionObj {

        /*
         * Oracle table structure CREATE TABLE ACTIVESESSIONSLOG( ASESSIONID
         * VARCHAR2(30 ) NOT NULL, USERID VARCHAR2(30 ), ACTIVITYSTART
         * TIMESTAMP(6), ACTIVITYEND TIMESTAMP(6), ACTIVITY CLOB )
         */
        private String aSessionID;
        private String userID;
        private Date activityStart;
        private Date activityEnd;
        private String activity;
        //private boolean selected;

        public ActiveSessionObj(String aSessionID, String userID, Date activityStart, Date activityEnd, String activity) {
            this.aSessionID = aSessionID;
            this.userID = userID;
            this.activityStart = activityStart;
            this.activityEnd = activityEnd;
            this.activity = activity;
        }

        public int getFirstRow() {
            return firstRow;
        }

        public String getaSessionID() {
            return aSessionID;
        }

        public void setaSessionID(String aSessionID) {
            this.aSessionID = aSessionID;
        }

        public String getactivity() {
            return activity;
        }

        public void setactivity(String activity) {
            this.activity = activity;
        }

        public Date getactivityEnd() {
            return activityEnd;
        }

        public void setactivityEnd(Date activityEnd) {
            this.activityEnd = activityEnd;
        }

        public Date getactivityStart() {
            return activityStart;
        }

        public void setactivityStart(Date activityStart) {
            this.activityStart = activityStart;
        }

        public String getuserID() {
            return userID;
        }

        public void setuserID(String userID) {
            this.userID = userID;
        }

        private ActiveSessionObj() {
            throw new UnsupportedOperationException("Not yet implemented");
        }
    }

    // Paging actions -----------------------------------------------------------------------------
    public void pageFirst() {
        page(0);
    }

    public void pageNext() {
        page(firstRow + rowsPerPage);
    }

    public void pagePrevious() {
        page(firstRow - rowsPerPage);
    }

    public void pageLast() {
        page(totalRows - ((totalRows % rowsPerPage != 0) ? totalRows % rowsPerPage : rowsPerPage));
    }

    public void page(ActionEvent event) {
        page(((Integer) ((UICommand) event.getComponent()).getValue() - 1) * rowsPerPage);
    }

    private void page(int firstRow) {
        this.firstRow = firstRow;
        loadDataList(); // Load requested page.
    }

    // Sorting actions ----------------------------------------------------------------------------
    public void sort(ActionEvent event) {
        String sortFieldAttribute = (String) event.getComponent().getAttributes().get("sortField");

        // If the same field is sorted, then reverse order, else sort the new field ascending.
        if (sortField.equals(sortFieldAttribute)) {
            sortAscending = !sortAscending;
        } else {
            sortField = sortFieldAttribute;
            sortAscending = true;
        }

        pageFirst(); // Go to first page and load requested page.
    }

    // Loaders ------------------------------------------------------------------------------------
    private void loadDataList() {

        // Load list and totalCount.
        try {
            dataList = list(firstRow, rowsPerPage, sortField, sortAscending);
            totalRows = countDBRowNum(); //count the tablerows
        } catch (Exception e) {
            throw new RuntimeException(e);
        }

        // Set currentPage, totalPages and pages.
        currentPage = (totalRows / rowsPerPage) - ((totalRows - firstRow) / rowsPerPage) + 1;
        totalPages = (totalRows / rowsPerPage) + ((totalRows % rowsPerPage != 0) ? 1 : 0);
        int pagesLength = Math.min(pageRange, totalPages);
        pages = new Integer[pagesLength];

        // firstPage must be greater than 0 and lesser than totalPages-pageLength.
        int firstPage = Math.min(Math.max(0, currentPage - (pageRange / 2)), totalPages - pagesLength);

        // Create pages (page numbers for page links).
        for (int i = 0; i < pagesLength; i++) {
            pages[i] = ++firstPage;
        }
    }

    // Getters ------------------------------------------------------------------------------------
    public List<ActiveSessionObj> getdataList() {
        if (dataList == null) {
            loadDataList(); // Preload page for the 1st view.
        }
        return dataList;
    }

    public int getTotalRows() {
        return totalRows;
    }

    public int getFirstRow() {
        return firstRow;
    }

    public int getRowsPerPage() {
        return rowsPerPage;
    }

    public Integer[] getPages() {
        return pages;
    }

    public int getCurrentPage() {
        return currentPage;
    }

    public int getTotalPages() {
        return totalPages;
    }

    // Setters ------------------------------------------------------------------------------------
    public void setRowsPerPage(int rowsPerPage) {
        this.rowsPerPage = rowsPerPage;
    }

    // Actions ------------------------------------------------------------------------------------
    /**
     * Returns list of ActiveSessionObj items starting at the given first index
     * with the given row count, sorted by the given sort field and sort order.
     *
     * @param firstRow First index of rows to be returned.
     * @param rowCount Amount of rows to be returned.
     * @param sortField Field to sort the data on.
     * @param sortAscending Whether to sort data ascending or not.
     * @return list of ActiveSessionObj items starting at the given first index
     * with the given row count, sorted by the given sort field and sort order.
     * @throws DAOException If something fails at DAO level.
     */
    public List<ActiveSessionObj> list(int firstRow, int rowCount, String sortField, boolean sortAscending) throws SQLException {

        String SqlStatementSmall = null;
        String SQLStatementLarge = null;

        if (ds == null) {
            throw new SQLException();
        }

        Connection conn = ds.getConnection();
        if (conn == null) {
            throw new SQLException();
        }

        int countrow = firstRow + rowCount;
        String sortDirection = sortAscending ? "ASC" : "DESC";

        /*
         * For small tables
         */
        SqlStatementSmall = "SELECT c.*"
                + " FROM (SELECT b.*, rownum rn"
                + " FROM (SELECT a.*"
                + " FROM activeSessionsLog a"
                + " ORDER BY %s %s) b"
                + " WHERE rownum <= ?) c"
                + " WHERE rn > ?";

        /*
         * For huge datatables optimized for perfomance
         */
        SQLStatementLarge = "select * from"
                + " (select asl.*, row_number() over (order by userid asc) r "
                + " from activesessionslog asl)"
                + " where r > 980750 and r <= 980800;";

        String sql = String.format(SqlStatementSmall, sortField, sortDirection);

        PreparedStatement ps = null;
        ResultSet resultSet = null;
        List<ActiveSessionObj> dataList = new ArrayList<ActiveSessionObj>();

        try {
            conn.setAutoCommit(false);
            boolean committed = false;

            ps = conn.prepareStatement(sql);
            ps.setInt(1, countrow);
            ps.setInt(2, firstRow);

            resultSet = ps.executeQuery();
            /*
             * take the result from the SQL query and insert it into Array List
             * collection
             */
            dataList = ActiveSessionsArrayList(resultSet);

            conn.commit();
            committed = true;

        } finally {
            ps.close();
            conn.close();
        }

        return dataList;
    }

    /**
     * Returns total amount of rows in table.
     *
     * @return Total amount of rows in table.
     * @throws DAOException If something fails at DAO level.
     */
    public int countDBRowNum() throws Exception {

        String SqlStatement = null;

        if (ds == null) {
            throw new SQLException();
        }

        Connection conn = ds.getConnection();
        if (conn == null) {
            throw new SQLException();
        }

        SqlStatement = "SELECT count(*) FROM ACTIVESESSIONSLOG";

        PreparedStatement ps = null;
        ResultSet resultSet = null;
        int count = 0;

        try {
            conn.setAutoCommit(false);
            boolean committed = false;
            try {
                SqlStatement = "SELECT count(*) FROM ACTIVESESSIONSLOG";

                ps = conn.prepareStatement(SqlStatement);
                resultSet = ps.executeQuery();

                if (resultSet.next()) {
                    count = resultSet.getInt(1);
                }

                conn.commit();
                committed = true;
            } finally {
                if (!committed) {
                    conn.rollback();
                }
            }
        } finally {
            ps.close();
            conn.close();
        }

        return count;
    }

    /**
     * Map the current row of the given ResultSet to ActiveSessionObj.
     *
     * @param resultSet The ResultSet of which the current row is to be mapped
     * to ActiveSessionObj.
     * @return The mapped ActiveSessionObj from the current row of the given
     * ResultSet.
     * @throws SQLException If something fails at database level.
     */
    private ArrayList<ActiveSessionObj> ActiveSessionsArrayList(ResultSet rs) throws SQLException {
        ArrayList<ActiveSessionObj> list = new ArrayList<>();

        try {
            while (rs.next()) {
                list.add(new ActiveSessionObj(
                        rs.getString("ASESSIONID"),
                        rs.getString("USERID"),
                        timestampToDate(rs.getTimestamp("ACTIVITYSTART")),
                        timestampToDate(rs.getTimestamp("ACTIVITYEND")),
                        rs.getString("ACTIVITY")));
            }
        } catch (Exception x) {
            x.printStackTrace();
        }

        return list;   
    }

    //get the selected rows
    private HashMap<String, Boolean> selectedIds = new HashMap<>();

    // get the list from the JSF page
    public Map<String, Boolean> getSelectedIds() {
        return selectedIds;
    }

    //delete all selected checkboxes
    public void deleteSelectedIDs() throws SQLException {
        boolean success = false;

        if (ds == null) {
            throw new SQLException();
        }

        Connection conn = ds.getConnection();
        if (conn == null) {
            throw new SQLException();
        }

        PreparedStatement ps = null;
        ResultSet resultSet = null;

        try {
            conn.setAutoCommit(false);
            boolean committed = false;
            try {

                String sqlDeleteQuery = "DELETE FROM ACTIVESESSIONSLOG WHERE ASESSIONID = ?";

                Set<String> keySet = selectedIds.keySet();
                String[] keys = new String[]{};
                keys = selectedIds.keySet().toArray(keys);
                ps = conn.prepareStatement(sqlDeleteQuery);

                for (int i = 0; i < keys.length; i++) {
                    ps.setString(1, keys[i]);
                    ps.executeUpdate();
                    ps.clearParameters();
                    selectedIds.put(keys[i], false); //get(keys[i]) = false;
                }

                conn.commit();
                committed = true;

                //selectedIds.clear();
            } finally {
                if (!committed) {
                    conn.rollback();
                }
            }
        } finally {
            ps.close();
            conn.close();
        }

        /*
         * // Get selected items. boolean success = false; try { String
         * sqlDeleteQuery = "";
         *
         * Set<String> keySet = selectedIds.keySet(); Iterator keyIterator =
         * keySet.iterator(); while(keyIterator.hasNext()) { keyIterator.next();
         * }
         *
         * }
         * catch(Exception x) { success = false; } // Do your thing with the
         * MyData items in List selectedDataList.
         */
        //return success; // Navigation case.
    }

    private static Date timestampToDate(java.sql.Timestamp ts) {
        Date d = null;
        try {
            d = new Date(ts.getTime());
        } catch (Exception e) {
            e.printStackTrace();
        }

        return d;
    }
} 
```

我的问题是如何实现可选`select all`按钮。创建获取数据库表的所有键并创建存储所有键的哈希图的一种方法。像这样的东西：

```
private HashMap<String, Boolean> selectedIds = new HashMap<>(); 
```

当我尝试实现选择行复选框时，此代码运行良好。问题是当我有一百万行或更多行进入数据库表时会发生什么？在这种情况下，所有的键都将被插入到一个非常大的 hashmap 中，也许我会因为内存消耗太大而出错。有没有更优化的解决方案？

最良好的祝愿彼得

**更新**

我已经实现了用于选择行并将它们传递给删除 java 方法的简单复选框，该方法使用键将行删除到数据库表中。但是我如何`select all`在 JavaScript 客户端中实现并调用从数据库表中删除所有记录的 java 方法呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T19:09:21.780

你可以做这样的事情

```
<h:column id="selection_column">
    <f:facet name="header">
         <h:selectBooleanCheckbox class="checkall"/>
    </f:facet>
    <h:selectBooleanCheckbox value="#{SessionsController.selectedIds[item.aSessionID]}" />
</h:column> 
```

在你的 js 中输入这段代码

```
 $(window).load(function () {
        $(document).delegate(".checkall", "click", function(event) {
              $(this).closest("table").find(':checkbox').attr('checked', this.checked);
        });
    }); 
```

顺便说一句，您可以像这样将属性添加到您的迭代中，而不是存储在地图中`item`：而不是`value="#{SessionsController.selectedIds[item.aSessionID]}"`像这样`value="#{item.selected}"`

稍后您可以在服务器端遍历它们并添加到列表中，该列表将发送给您的删除方法...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T14:25:04.897

选择是客户端操作。因此，您可以使用 JavaScript 来实现。一个想法是为您要选择的所有复选框添加一个特定的 CSS 类（然后将它们全部选中会更容易）：

```
<h:column>
    <f:facet name="header">
        <h:outputText value="Select" />
    </f:facet>
    <h:selectBooleanCheckbox styleClass="selectable-checkbox" onclick="highlight(this)" value="#{SessionsController.selectedIds[item.aSessionID]}" />
</h:column> 
```

然后，您可以简单地使用以下 jQuery 代码来检查具有此特定 CSS 类的所有元素：`jQuery(".selectable-checkbox").attr("checked", true);`.

如果您不使用 jQuery，您可以做同样的事情，稍微调整此处显示的代码：[如何在 JavaScript 中按类获取元素？](https://stackoverflow.com/questions/3808808/how-to-get-element-by-class-in-javascript)

* * *

*关于您的编辑：*

您想要一个**删除**表中所有项目的按钮`Select all`吗？

 **如果您需要实现这一点，请将此按钮重命名为`Delete all items`将简单地调用 Java 方法（即经典`<h:commandButton>`或`<h:commandLink>`），而无需选择复选框。选择项目有什么好处，因为您将在此之后删除它们？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-12T07:33:31.310

我已使用此代码选择所有复选框：

$（窗口）.load（函数（）{

```
 $(document).delegate(".checkall", "click", function(event) {
          $(this).closest("table").find(':checkbox').attr('checked', this.checked);
    });
}); 
```

当我在标题中选择/取消选择复选框然后选择/取消选择该列下的所有复选框时，它工作正常。但是，如果我再次选择相同的选项，则不会选择其他复选框。.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-30T13:27:44.367

对于 JSF 2，对于在 selectionMode 中选择数据表中的所有行，使用 paginator=true：In Page

```
<p:dataTable widgetVar="tableArea" yourtags...>
   <p:ajax  event="toggleSelect" oncomplete="teste()" /> /// toggleSelect is dispared on click to checkbox header
<p:column id="columnId" selectionMode="multiple"/>
```

在js中：

```
function teste(){    		
	var checked = $(document).find(":checkbox")["0"].checked; ///Find checkbox header and verify if checkbox is checked
	if(checked == true){
		PF('tableArea').selectAllRows(); // if true, selectAllRows from datatable
	} else {
		PF('tableArea').unselectAllRows(); //
	}		
}
```**

# delphi - 使用 TIdUDPServer 读取数据

> ID：10585088
> 
> 赞同：0
> 
> 时间：2012-05-14T14:15:04.330
> 
> 标签：delphi, udp, delphi-7, indy

我想从通过 UDP 向我的 PC 发送数据的电子设备读取数据。我在 Delphi 中编写了一个 UDP 服务器。类 EIdSocketError 中发生异常（失败 #10049）。这是我的代码：

```
procedure TForm1.Button1Click(Sender: TObject);
begin
   IdUDPServer1.Bindings.add.IP := '192.168.1.1';  //Electronic device ip
   IdUDPServer1.Bindings.add.Port:= 49152;         //Electronic device port   
   IdUDPServer1.OnUDPRead:= UDPRead;
   IdUDPServer1.Active:=True;

end;

procedure TForm1.UDPRead (Sender: TObject; AData: TStream; ABinding: TIdSocketHandle);
var
   bytes_received: integer;
begin
   bytes_received:=AData.size;
end; 
```

我究竟做错了什么？

提前致谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T20:05:10.473

正如基思米勒所说，您正在滥用该`Bindings`财产。您正在向服务器添加**2 个**绑定 - 一个用于`192.168.1.1`on port `0`，另一个用于`0.0.0.0`on port `49152`。您只需为`Bindings.Add()`要绑定的每个 IP/端口对调用一次，例如：

```
var
  Binding: TIdSocketHandle

Binding := IdUDPServer1.Bindings.Add;
Binding.IP := ...;
Binding.Port := ...; 
```

或者：

```
with IdUDPServer1.Bindings.Add do
begin
  IP := ...;
  Port := ...;
end; 
```

如果您`DefaultPort`提前设置了属性，那么您可以将上面的内容简化为：

```
IdUDPServer1.DefaultPort := ...;
IdUDPServer1.Bindings.Add.IP := ...; 
```

话虽如此，套接字错误 10049 是`WSAEADDRNOTAVAIL`，这意味着您首先使用了错误的 IP 地址。您需要指定一个属于`TIdUDPServer`正在运行的 PC 的 IP - 设备将向其发送 UDP 数据包的 IP。您可以绑定到单个通配符 IP `0.0.0.0`（或只是一个空白字符串 ''），它告诉`TIdUDPServer`绑定到所有可用的本地 IP：

```
IdUDPServer1.DefaultPort := ...;
IdUDPServer1.Bindings.Add.IP := ''; // or: '0.0.0.0' 
```

或者您可以使用 Indy 的`GStack.LocalAddresses`属性来确定本地可用的 IP，并`Bindings`根据需要单独为它们创建单独的 IP。

```
IdUDPServer1.Bindings.Clear;
IdUDPServer1.DefaultPort := ...;

with GStack.LocalAddresses do
begin
  for I := 0 to Count-1 do
    IdUDPServer1.Bindings.Add.IP := Strings[I];
end; 
```

**更新：**`TIdSocketHandle.Port`如果您将服务器绑定到端口 0 以让操作系统选择一个端口，您可以在服务器激活后通过查看属性来发现选择了哪个端口：

```
var
  Binding: TIdSocketHandle
  ListeningPort: TIdPort;

IdUDPServer1.Bindings.Clear;

Binding := IdUDPServer1.Bindings.Add;
Binding.IP := ...;
Binding.Port := 0;
{
or: 
IdUDPServer1.DefaultPort := 0;
Binding := IdUDPServer1.Bindings.Add;
Binding.IP := ...;
}

IdUDPServer1.Active := True;

ListeningPort := Binding.Port; 
```

# soap - 在一个“syncFolderItems”操作中监控多个文件夹？

> ID：10585090
> 
> 赞同：3
> 
> 时间：2012-05-14T14:15:12.427
> 
> 标签：soap, exchange-server, exchangewebservices, exchange-server-2007

是否可以在一次“syncFolderItems”操作中监控多个文件夹？我试过了，但它似乎不起作用。例如，这个：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"
  xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">
  <soap:Body>
    <SyncFolderItems xmlns="http://schemas.microsoft.com/exchange/services/2006/messages">
      <ItemShape>
        <t:BaseShape>Default</t:BaseShape>
      </ItemShape>
      <SyncFolderId>           
 <t:DistinguishedFolderId Id="drafts"/>
 <t:DistinguishedFolderId Id="inbox"/>

 </SyncFolderId>

      <MaxChangesReturned>500</MaxChangesReturned>
    </SyncFolderItems>
  </soap:Body>
</soap:Envelope> 
```

不工作:(

可能吗？谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-17T15:01:34.217

我知道这是一个非常古老的问题，但是对于其他用户来说仍然很重要，所以我正在回答。
**不，不可能**
SyncFolderId 可以有一个子标签 FolderID 或 DistinguishedFolderID

```
<SyncFolderId>
   <FolderId/>
</SyncFolderId> 
```

* * *

```
<SyncFolderId>
   <DistinguishedFolderId/>
</SyncFolderId> 
```

参考链接[http://msdn.microsoft.com/en-us/library/exchange/aa580296%28v=exchg.80%29.aspx](http://msdn.microsoft.com/en-us/library/exchange/aa580296%28v=exchg.80%29.aspx)

# ubuntu - 解决 Ubuntu 上 java 和 javac 之间的版本冲突

> ID：10585091
> 
> 赞同：21
> 
> 时间：2012-05-14T14:15:12.803
> 
> 标签：ubuntu, java, javac, openjdk, unsupported-class-version

我在 Ubuntu 上编译的 Java 应用程序有问题。它抛出`UnsupportedClassVersionError`。我正在使用比在我的 PATH 中配置来运行 Java 的版本更高的 JDK 版本进行编译：

```
$ javac -version
javac 1.7.0_147

$ java -version
java version "1.6.0_23"
OpenJDK Runtime Environment (IcedTea6 1.11pre) (6b23~pre11-0ubuntu1.11.10.2)
OpenJDK Client VM (build 20.0-b11, mixed mode, sharing) 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-05-28T07:58:44.123

在终端中输入以下命令：

```
 sudo update-alternatives --config java 
```

它会要求您：

> 替代 java 有 2 种选择（提供 /usr/bin/java）。

```
 Selection      Path                                            Priority   Status

    0           /usr/lib/jvm/java-6-openjdk-amd64/jre/bin/java   1061      auto mode

    1           /usr/lib/jvm/java-6-openjdk-amd64/jre/bin/java   1061      manual mode

    2            /usr/lib/jvm/java-7-openjdk-amd64/jre/bin/java  1051      manual mode

  Press enter to keep the current choice[*], or type selection number: 
```

我输入 2 因为我想使用 java 1.7.0_21

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2015-06-17T06:58:08.947

您还需要执行以下操作：

```
sudo update-alternatives --config javac 
```

从提供的列表中选择所需的 java 编译器。例如在 Centos 5

```
There are 2 programs which provide 'javac'.
Selection    Command
-----------------------------------------------
1           /usr/lib/jvm/java-1.6.0-openjdk/bin/javac
*+ 2        /usr/lib/jvm/java-1.7.0-openjdk/bin/javac 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-14T14:36:55.903

运行以下任一命令以找到该位置的位置

```
javac 1.7.0_147 
```

使用如下：

```
whereis javac 
```

或者

```
 locate javac 
```

或者

```
find javac 
```

然后，一旦您找到该目录，将 bin 内容象征性地强制链接到 /usr/bin：

```
sudo ln -f -s [put location here]/bin/* /usr/bin 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-14T14:27:48.370

这就是你想要的[Java 和 Ubuntu](https://help.ubuntu.com/community/Java)。我基本上有相同的配置，但我在 Glassfish 和 Java7 之间来回切换。看看并尝试以类似的方式设置您的 Java 环境

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-11-25T10:38:37.183

我已经添加并安装了 Java 和 Javac 的替代品，以下步骤对我有用：

**步骤 1**：**添加 Java 和 Javac 替代方案** ：

添加 Javac 的命令：

```
sudo update-alternatives --install "/usr/bin/java" "java" "/opt/amazon-jdk-11/bin/java" 1 
```

**即：“/opt/amazon-jdk-11/bin/javac”这是java的新路径**

```
sudo update-alternatives --install "/usr/bin/javac" "javac" "/opt/amazon-jdk-11/bin/javac" 1 
```

即：/opt/amazon-jdk-11/bin/javac 是 javac 的新路径

**第 2 步**：**安装 Java 和 Javac 替代品** ：

```
sudo update-alternatives --config javac
sudo update-alternatives --config javac 
```

输入上述命令后，您将能够看到如下所示的屏幕，您可以选择要配置 java 的号码。

[![在此处输入图像描述](../Images/7c49c4dc75e599fd6d959d493efba628.png)](https://i.stack.imgur.com/d0PZF.png)

我在列表中选择了“ **1** ”，因为我想安装“/opt/amazon-jdk-11/bin/java”作为我的 javac。

使用以下命令验证您的**Java 替代安装是否成功**：

`which javac`您`which java` 将能够看到如下屏幕：

[![在此处输入图像描述](../Images/8497fe167e50630a5281ef171a6b97c4.png)](https://i.stack.imgur.com/qfdui.png)

# wcf - MaxConcurrentCalls 的 WCF 队列行为

> ID：10585094
> 
> 赞同：2
> 
> 时间：2012-05-14T14:15:25.267
> 
> 标签：wcf, webhttpbinding

我有一个具有以下设置的 WCF 服务：

*   绑定 = WebHttpBinding
*   InstanceContextMode = 单
*   并发模式 = 多个
*   MaxConcurrentSessions = 高值

文档说明了 MaxConcurrentCalls：MaxConcurrentCalls 属性指定了通过 ServiceHost 对象主动处理的最大消息数。每个通道可以有一个未决消息，在开始处理它之前不计入 MaxConcurrentCalls 的值。

几个问题：

*   “每个通道可以有一个未决消息，在开始处理它之前不计入 MaxConcurrentCalls 的值”这句话到底是什么意思？
*   如果达到 MaxConcurrentCalls 阈值，是否有新的 TCP 连接排队？
*   如果达到 MaxConcurrentCalls 阈值，现有 TCP 连接上的新请求是否排队（在流水线期间）？
*   如何指定这些队列的长度？

谢谢！

雷内

# javascript - 是否可以阻止 requireJS 自动添加 .js 文件扩展名？

> ID：10585099
> 
> 赞同：53
> 
> 时间：2012-05-14T14:15:37.797
> 
> 标签：javascript, requirejs

我正在使用 requireJS 加载脚本。它[在文档中有这个细节](http://requirejs.org/docs/api.html#config)：

> 用于模块名称的路径不应包含 .js 扩展名，因为路径映射可能用于目录。

在我的应用程序中，我将所有脚本文件映射到配置路径中，因为它们是在运行时动态生成的（我的脚本开始时就像这样`order.js`，但变成了这样`order.min.b25a571965d02d9c54871b7636ca1c5e.js`（这是文件内容的哈希，用于缓存清除目的） .

在某些情况下，require 会在这些路径的末尾添加第二个 .js 扩展名。虽然我在服务器端生成动态路径然后填充配置路径，但我必须编写一些额外的 javascript 代码来`.js`从有问题的文件中删除扩展名。

阅读 requireJS 文档，我真的不明白您为什么希望将路径映射用于目录。这是否意味着可以在一次调用中以某种方式加载整个目录的文件？我不明白。

有谁知道是否可以强制要求停止将 .js 添加到文件路径，这样我就不必绕过它了？

谢谢。

更新：根据要求添加了一些代码示例。

这是在我的 HTML 文件中（它是一个 Scala 项目，所以我们不能将这些变量直接写入`.js`文件）：

```
foo.js.modules = {
    order               : '@Static("javascripts/order.min.js")',
    reqwest             : 'http://5.foo.appspot.com/js/libs/reqwest',
    bean                : 'http://4.foo.appspot.com/js/libs/bean.min',
    detect              : 'order!http://4.foo.appspot.com/js/detect/detect.js',
    images              : 'order!http://4.foo.appspot.com/js/detect/images.js',
    basicTemplate       : '@Static("javascripts/libs/basicTemplate.min.js")',
    trailExpander       : '@Static("javascripts/libs/trailExpander.min.js")',
    fetchDiscussion     : '@Static("javascripts/libs/fetchDiscussion.min.js")'
    mostPopular         : '@Static("javascripts/libs/mostPopular.min.js")'
}; 
```

然后在我的里面`main.js`：

```
requirejs.config({
    paths: foo.js.modules
});

require([foo.js.modules.detect, foo.js.modules.images, "bean"], 
    function(detect, images, bean) {
        // do stuff
}); 
```

在上面的示例中，我必须使用字符串“bean”（它指的是 require 路径）而不是我的直接对象（就像其他人使用的那样`foo.js.modules.bar`），否则我会得到额外的`.js`附加值。

希望这是有道理的。

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2013-03-13T17:55:20.023

如果您不想添加对 noext 的依赖项，您也可以在路径中附加一个虚拟查询字符串，以防止附加 .js 扩展名，如下所示：

```
require.config({
    paths: {
        'signalr-hubs': '/signalr/hubs?noext'
    }
}); 
```

这就是 noext 插件的作用。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-06-28T19:46:10.883

requirejs 的[noext 插件](https://github.com/millermedeiros/requirejs-plugins)：

> 加载脚本而不附加“.js”扩展名，对动态脚本很有用......
> 
> ### 文档
> 
> 检查`examples`文件夹。您可能需要的所有信息都在注释内或示例代码本身。
> 
> ### 基本用法
> 
> 将插件放在`baseUrl`文件夹中（通常与 main.js 文件相同的文件夹）或创建插件位置的别名：
> 
> ```
> require.config({
>     paths : {
>         //create alias to plugins (not needed if plugins are on the baseUrl)
>         async: 'lib/require/async',
>         font: 'lib/require/font',
>         goog: 'lib/require/goog',
>         image: 'lib/require/image',
>         json: 'lib/require/json',
>         noext: 'lib/require/noext',
>         mdown: 'lib/require/mdown',
>         propertyParser : 'lib/require/propertyParser',
>         markdownConverter : 'lib/Markdown.Converter'
>     }
> });
> 
> //use plugins as if they were at baseUrl
> define([
>         'image!awsum.jpg',
>         'json!data/foo.json',
>         'noext!js/bar.php',
>         'mdown!data/lorem_ipsum.md',
>         'async!http://maps.google.com/maps/api/js?sensor=false',
>         'goog!visualization,1,packages:[corechart,geochart]',
>         'goog!search,1',
>         'font!google,families:[Tangerine,Cantarell]'
>     ], function(awsum, foo, bar, loremIpsum){
>         //all dependencies are loaded (including gmaps and other google apis)
>     }
> ); 
> ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-29T14:50:29.180

我在 node.js 中使用 requirejs 服务器端。noext 插件对我不起作用。我怀疑这是因为它试图将 ?noext 添加到 url 并且我们有文件名而不是 urls 服务器端。

我需要将我的文件命名为 .njs 或 .model 以将它们与静态 .js 文件分开。希望作者将更新 requirejs 以不强制用户使用自动 .js 文件扩展名约定。

同时这里有一个快速补丁来禁用此行为。

要应用此补丁（针对 node_modules/requirejs/bin/r.js 的 2.1.15 版）：

1.  保存在名为 disableAutoExt.diff 或其他文件中并打开终端
2.  cd 路径/到/node_modules/
3.  补丁 -p1 < path/to/disableAutoExt.diff
4.  添加 disableAutoExt: true, 到你的 requirejs.config: requirejs.config({disableAutoExt: true,});

现在我们可以做 require(["test/index.njs", ...] ... 并重新开始工作。

将此补丁保存在 disableAutoExt.diff 中：

```
--- mod/node_modules/requirejs/bin/r.js 2014-09-07 20:54:07.000000000 -0400
+++ node_modules/requirejs/bin/r.js 2014-12-11 09:33:21.000000000 -0500
@@ -1884,6 +1884,10 @@
         //Delegates to req.load. Broken out as a separate function to
         //allow overriding in the optimizer.
         load: function (id, url) {
+            if (config.disableAutoExt && url.match(/\..*\.js$/)) {
+                url = url.replace(/\.js$/, '');
+            }
+
             req.load(context, id, url);
         }, 
```

该补丁只是在 node_modules/requirejs/bin/r.js 的第 1887 行附近添加以下内容：

```
if (config.disableAutoExt && url.match(/\..*\.js$/)) {
    url = url.replace(/\.js$/, '');
} 
```

更新：通过在代码中更深地移动 url 更改来改进补丁，因此在模块上调用 undef 后它不再导致挂起。需要undef，因为：

要在使用 node.js 开发时禁用模块缓存，请将其添加到您的主应用程序文件中：

```
requirejs.onResourceLoad = function(context, map)
{
    requirejs.undef(map.name);
}; 
```

# ruby - 我应该在 IRB 中使用 load 还是 require ？

> ID：10585100
> 
> 赞同：0
> 
> 时间：2012-05-14T14:15:37.830
> 
> 标签：ruby, irb

我的印象是我应该使用它`require 'some_path'`来获取我想要使用的文件或库，但我无法让它工作，并且`load 'some_path'`工作。

我应该在什么时候使用这些不同的时间？

另外，是否可以使用`load`or命令导入目录`require`？我正在尝试使用整个目录，但到目前为止，我一次只能使用`load`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:37:41.827

您可以使用 Dir 列出所有以 .rb 结尾的文件并要求/加载它们

```
 Dir["/path/to/dir/*.rb"].each { |file| load_your_file_here(file) } 
```

我建议要求文件，然后包括文件加载的模块......如果您没有在文件中使用模块或类，那么您可能应该重新考虑您的结构。

load 可能会产生一些意想不到的后果，并且性能不佳。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:20:04.550

一旦你对一个文件调用 require ，再调用 require 将不再需要它（即没有效果），而 load 会在你每次调用它时重新加载它。据我所知，没有办法加载整个目录。

# iphone - iPhone iOS如何在按钮的文本或图像下向UIButton添加线性渐变？

> ID：10585103
> 
> 赞同：13
> 
> 时间：2012-05-14T14:15:44.300
> 
> 标签：iphone, objective-c, ios, uibutton, gradient

我正在通过向按钮添加线性渐变来创建精美的 UI 按钮。但是我不确定我需要在哪个索引处添加渐变。我目前拥有的代码将渐变放在图像/文本上。

**如何将子层插入到文本/图像子层下的 UIButton？**保持按钮的文本和图像可见对我来说很重要！

```
+(void)addLinearGradientToView:(UIView*)view TopColor:(UIColor*)topColor BottomColor:(UIColor*)bottomColor
{
    for(CALayer* layer in view.layer.sublayers)
    {
        if ([layer isKindOfClass:[CAGradientLayer class]])
        {
            [layer removeFromSuperlayer];
        }
    }
    CAGradientLayer* gradientLayer = [CAGradientLayer layer];

    gradientLayer.startPoint = CGPointMake(0.5, 0);
    gradientLayer.endPoint = CGPointMake(0.5,1);
    gradientLayer.frame = view.bounds;
    gradientLayer.colors = [NSArray arrayWithObjects:(id)[topColor CGColor], (id)[bottomColor CGColor], nil];
    //    [view.layer addSublayer:gradientLayer];
    if(view.layer.sublayers.count>0)
    {
        [view.layer insertSublayer:gradientLayer atIndex:view.layer.sublayers.count-2];
    }else {
        [view.layer addSublayer:gradientLayer];
    }
} 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-05-14T16:59:16.177

将其添加到自定义按钮的图层：

```
CAGradientLayer *gradientLayer = [CAGradientLayer layer];
gradientLayer.frame = customButton.layer.bounds;

gradientLayer.colors = [NSArray arrayWithObjects:
                        (id)[UIColor colorWithWhite:1.0f alpha:0.1f].CGColor,
                        (id)[UIColor colorWithWhite:0.4f alpha:0.5f].CGColor,
                        nil];

gradientLayer.locations = [NSArray arrayWithObjects:
                           [NSNumber numberWithFloat:0.0f],
                           [NSNumber numberWithFloat:1.0f],
                           nil];

gradientLayer.cornerRadius = customButton.layer.cornerRadius;
[customButton.layer addSublayer:gradientLayer]; 
```

`customButton`你的习惯在哪里`UIButton`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-14T16:46:36.313

对于您要实现的目标，请始终在索引 0 处插入。

我最近写[了一篇](http://blog.hawkimedia.com/2011/11/ui-polish-in-an-instant/)关于这类事情的文章，你可能会觉得有趣。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-17T05:05:44.913

**斯威夫特 4**

```
@IBOutlet weak var gButton: UIButton!

override func viewDidLoad() {

    super.viewDidLoad()

    let topGradientColor = UIColor.red
    let bottomGradientColor = UIColor.yellow

    let gradientLayer = CAGradientLayer()

    gradientLayer.frame = gButton.bounds

    gradientLayer.colors = [topGradientColor.cgColor, bottomGradientColor.cgColor]

    //Vertical
    //gradientLayer.startPoint = CGPoint(x: 0.0, y: 0.0)
    //gradientLayer.endPoint = CGPoint(x: 0.0, y: 1.0)

    //Horizontal
    gradientLayer.startPoint = CGPoint(x: 0.0, y: 0.0)
    gradientLayer.endPoint = CGPoint(x: 1.0, y: 0.0)

    gButton.layer.insertSublayer(gradientLayer, at: 0)
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-08T08:47:54.050

这是实现此目的的代码

```
CAGradientLayer *gradient = [CAGradientLayer layer];
gradient.frame = <#View Variable Name#>.bounds;
gradient.colors = [NSArray arrayWithObjects:(id)([UIColor colorWithRed:0.337 green:0.596 blue:1.000 alpha:1.000].CGColor),(id)([UIColor colorWithRed:0.757 green:0.459 blue:1.000 alpha:1.000].CGColor),(id)([UIColor colorWithRed:0.310 green:0.835 blue:1.000 alpha:1.000].CGColor),nil];
gradient.startPoint = CGPointMake(0.5,0.0);
gradient.endPoint = CGPointMake(0.5,1.0);
[<#View Variable name#>.layer insertSublayer:gradient atIndex:0]; 
```

我得到了这个工具，可以轻松选择颜色并自动输出渐变代码。非常方便我每天都使用它 [itunes.apple.com/gb/app/gradient-creator/id1031070259?mt=12](https://itunes.apple.com/gb/app/gradient-creator/id1031070259?mt=12)

# java - Hibernate和图形设计，该走哪条路？

> ID：10585104
> 
> 赞同：0
> 
> 时间：2012-05-14T14:15:46.567
> 
> 标签：java, hibernate, jpa, jdbc, graph

我想在我的程序中有一些对象的图形结构，我将使用 JPA（休眠）“因为它比原始 JDBC 更好”。

我对在 hibernate 中定义所有内容以及让 hibernate 为我创建数据模式持怀疑态度，因此我定义了两个自己的表。一个持有对象，一个持有这些对象之间的关系（连接） - 典型的 3NF。

hibernate 能够有效地处理这种结构吗？或者更重要的是，这种方法是否愚蠢？我要把所有的鸡蛋都放在冬眠篮子里吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:47:42.377

对于这种情况下的性能，使用 JDBC 或 Hibernate 并不重要。您可以对它们使用几乎相同的选择语句。

Hibernate 有一些优势（例如不同数据库之间的可移植性；额外的抽象层）。Hibernate 的缺点是（在您的情况下），您必须先学习它，但对于您的简历来说，这是一个优势。

顺便说一句，我不使用 Hibernate 创建数据模式的可能性。在我看来，这是错误的方向。应该首先创建瓶颈所在的数据库。我总是手动创建我的数据库模式。

# java - 如何知道用户定义的默认构造函数和用户定义的参数化构造函数java的用法

> ID：10585112
> 
> 赞同：-4
> 
> 时间：2012-05-14T14:16:04.783
> 
> 标签：java, constructor

我无法掌握这些构造函数的用法。

我理解一个如下：

```
public book(){
private string author;
private string title;
private int reference;
} 
```

一个参数化的构造函数如下：

```
public book( string author, string title, int reference){ 
} 
```

但是，这将如何在主要方法中使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:23:12.243

您可以通过三种方式拥有构造函数：

1）你声明一个无参数的

.

```
public class book
{
  string author;
  string title;
  int reference;
  public book() {
    // initialize member variables with default values
    // etc.
  }
} 
```

2) 你用参数声明一个

.

```
public class book
{
  string author;
  string title;
  int reference
  public book(string author, string title, int reference) {
    // initialize member variables based on parameters
    // etc.
  }
} 
```

3）你让编译器为你声明一个——这要求你不要声明你自己的一个。在这种情况下，成员变量将根据它们的类型提供一个默认值（本质上是调用它们的无参数构造函数）

您可以混合使用选项 1) 和 2)，但 3) 是独立的（不能与其他两个中的任何一个混合使用）。您还可以拥有多个带参数的构造函数（参数类型/编号必须不同）

使用示例：

```
public static void main(String[] args) {
  String author = ...;
  String title = ...;
  int ref = ...;
  book book1 = new book(); // create book object calling no-parameter version
  book book2 = new book(author, title, ref); // create book object calling one-parameter
                                // (of type String) version
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:21:25.807

从语法上讲，如何使用它们...

```
书 b1 = 新书（）；
book b2 = new book("我的书名", "我的作者", 0);

```

你调用第一个来创建一本空书。可能还有 setTitle(String title)、setAuthor(String author) 和 setReference(int ref) 方法。这看起来像......

```
书 b1 = 新书（）；
// 做一些事情来获取标题作者和参考
b1.setTitle(标题);
b1.setAuthor(作者);
b1.setReference（参考）；

```

如果您在构建图书实例时没有可用的标题、作者和参考资料，则可以调用它。

# .htaccess - 基于 query_string 的特定 .htaccess 重定向

> ID：10585113
> 
> 赞同：1
> 
> 时间：2012-05-14T14:16:10.170
> 
> 标签：.htaccess

我需要这个逻辑来工作：

我想重写这个字符串供用户查看

[http://mysite.com/index.php?cl=mykeystring](http://mysite.com/index.php?cl=mykeystring) 到 [http://mysite.com/otherkey/](http://mysite.com/otherkey/)

[http://mysite.com/index.php?myvar=test&cl=mykeystring&mysecondvar=morevalue](http://mysite.com/index.php?myvar=test&cl=mykeystring&mysecondvar=morevalue) 到 [http://mysite.com/otherkey/myvar=test&mysecondvar=morevalue](http://mysite.com/otherkey/myvar=test&mysecondvar=morevalue)

但是当[http://mysite.com/otherkey/](http://mysite.com/otherkey/)被写入时，所以加载 [http://mysite.com/index.php?cl=mykeystring](http://mysite.com/index.php?cl=mykeystring)，但不会进行重定向。

可能吗？无法更改代码中的任何内容，而只能更改 .htaccess

这段代码几乎实现了这个逻辑：

```
RewriteCond %{QUERY_STRING} ^(.*?)cl=mykeystring(.*?)$ [NC]
RewriteRule ^index.php$ /otherkey/%1%2? [R,L]

RewriteRule ^otherkey/(.*?)$ /index.php?cl=mykeystring&$1 
```

但**我在第一次重写规则时得到了一些不需要的 amp 符号。任何解决方案？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:23:09.153

我认为你可以这样做：

```
RewriteCond %{QUERY_STRING} cl=mykeystring [NC]
RewriteRule ^index.php /otherkey/ [QSA] 
```

这里的文档：[http ://httpd.apache.org/docs/2.0/misc/rewriteguide.html](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html)

# javascript - 使用字符串 Jquery 这个选择器

> ID：10585115
> 
> 赞同：-5
> 
> 时间：2012-05-14T14:16:21.150
> 
> 标签：javascript, jquery, jquery-selectors

通过使用字符串表达式是否有任何等效于 $(this) 的方法？我已经尝试过 $('this') 但我无法成功。

编辑：

我想减少我的 dom 元素的代码量。我不想重复我的代码，而是想编写一个自定义属性并将响应放入 data-response-target-sel 选择器。但是有时我需要通过使用“this”的上下文来表达这个选择器。我想为这种情况找到一个好的解决方案。我可以为上下文添加另一个自定义属性，但在进一步讨论之前，我想分享我的问题。

`<a class="btn btn-primary" href="#" data-response-target-sel=".modal" >`

```
ajaxSubmit({
    url: $this.attr("href"),
    type: "GET",
    data: {}
},$this.attr("data-response-target-sel"));

function ajaxSubmit(data,resSel) {
  $.ajax({
     url:data.url,
     type:data.type,
     data:data.data,
     cache:false,
     success:function (html, textStatus, jqXHR) {
        var $html = $(html);
        if(jqXHR.status == 200 || jqXHR.status == 201){
            $(resSel).html(html)
        }
     }
  }); 
```

}

如何使用它为上下文设置“data-response-target-sel”？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:17:49.077

> 通过使用字符串表达式是否有任何等效于 $(this) 的方法？

不，除非你使用 evil 之类的东西`eval`。

为什么你需要一个等价于 的字符串`this`？
如果我能找到类似的东西：`$('kdjfk55ndns')`你会使用它吗？

如果您真的想要上述答案，请阅读 [https: //stackoverflow.com/q/10375329/601179...](https://stackoverflow.com/q/10375329/601179)

* * *

请注意，`$('this')`查询 DOM 以查找带有`this` **tagName**的元素：

```
<this>
    <this> </this>
</this> 
```

HTML中有很多...

* * *

**更新：**

```
function ajaxSubmit(data,resSel) {
  $.ajax({
     url:data.url,
     type:data.type,
     data:data.data,
     cache:false,
     context : $(resSel),
     success:function (html, textStatus, jqXHR) {
        var $html = $(html);
        if(jqXHR.status == 200 || jqXHR.status == 201){
            this.html(html)
        }
     }
  });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:18:32.863

尝试定义`$(this)`为变量并使用然后使用它。

```
var obj = $(this); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:35:50.967

如果你要传递你的元素，你可以这样做：

```
$('selector', $this); 
```

或在您的示例中：

```
$(resSel, $this).html(html) 
```

并且不要使用

```
$this.attr("data-response-target-sel") 
```

但

```
$this.data("response-target-sel") 
```

# java - 我正在尝试在 mac osx 上通过 JDBC 连接 mysql

> ID：10585116
> 
> 赞同：1
> 
> 时间：2012-05-14T14:16:25.443
> 
> 标签：java, mysql, eclipse, macos, jdbc

我的 IDE 是 Eclipse Indigo。当我尝试连接时，我得到了这个：

```
java.lang.ClassNotFoundException: com.mysql.jdbc.Driver 
```

这是我的代码。

```
public class TPCH
{
    public static void main(String[] args)
    {
        String userName = "tpch";
        String password = "tpch";
        Connection conn = null;
        Properties connectionProps = new Properties();
        connectionProps.put("user", userName);
        connectionProps.put("password", password);

        try
        {
            Class.forName("com.mysql.jdbc.Driver");
        }
        catch (Exception e)
        {
            e.printStackTrace();
        }
        try {
            conn = DriverManager.getConnection(
                           "jdbc:mysql://localhost:3306/",
                           connectionProps);
        } catch (SQLException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
            System.out.println("Error connecting to db");
        }
    }
} 
```

我认为没有导入 JDBC。我试图通过

```
preference -> java -> build path -> user library -> add jars 
```

但我仍然有这个例外。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T14:19:29.260

这不是在 Eclipse 中将 JAR 添加到类路径的方式。

您必须右键单击您的项目，选择`Java Build Path > Libraries`并添加一个 JAR 文件。对于 MySQL，您需要[MySQL 连接器 J](http://dev.mysql.com/downloads/connector/j/)。

![在此处输入图像描述](../Images/c930d24c369e491e6a135e7ae608bd8c.png)

# perl - perl 在 windows 中合并输出和 stderr 和过滤行

> ID：10585120
> 
> 赞同：2
> 
> 时间：2012-05-14T14:16:49.080
> 
> 标签：perl

我想在 perl 中运行一个外部命令并过滤一些行。我不知道如何过滤去 stderr 的行。我现在有以下代码：

```
#!/usr/bin/env perl

use File::Spec;
#open STDERR, '>', File::Spec->devnull() or die "could not open STDERR: $!\n";

open(FILEHANDLE, '-|', 'Mycmd') or die "Cannot fork: $!\n";
open(STDERR, ">&FILEHANDLE");

while(defined(my $line = <FILEHANDLE>)) {
  chomp($line);
  if( $line =~ m/text1/ or
    $line =~ m/text2/ or
    $line =~ m/text3/
  ) {
    # do nothing
  }
  else {
    print "$line\n";
  }
}
close FILEHANDLE or die "child error: $!\n"; 
```

线

```
open(STDERR, ">&FILEHANDLE"); 
```

是我尝试重定向 stderr 以便能够使用 stdout 处理它但它不起作用的地方。

该解决方案必须在 Windows 中工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:24:07.723

参数中的 shell 重定向`open`可以在这里提供帮助：

```
open(FILEHANDLE, 'Mycmd 2>&1 |') or die "Cannot fork: $!\n"; 
```

现在`FILEHANDLE`将看到标准输出和标准错误的每一行`Mycmd`。

要使用多参数`open` *和*重定向输出，您必须更加慎重。说`Mycmd`是

```
#! /usr/bin/env perl
print "standard output\n";
warn  "standard error\n"; 
```

打开`"-|"`只给我们标准输出，所以如果我们运行

```
#! /usr/bin/env perl

use strict;
use warnings;

use 5.10.0;

my $pid = open my $fh, "-|", "Mycmd" // die "$0: fork: $!";

while (defined(my $line = <$fh>)) {
  chomp $line;
  print "got [$line]\n";
} 
```

输出是

```
标准误
得到[标准输出]
```

请注意，标准输出`Mycmd`通过了驱动程序，而*不是*其标准错误。要同时获得两者，您必须模仿 shell 的重定向。

```
#! /usr/bin/env perl

use strict;
use warnings;

use 5.10.0;

my $pid = open my $fh, "-|" // die "$0: fork: $!";

if ($pid == 0) {
  open STDERR, ">&STDOUT" or die "$0: dup: $!";
  exec "Mycmd"            or die "$0: exec: $!";
}

while (defined(my $line = <$fh>)) {
  chomp $line;
  print "got [$line]\n";
} 
```

现在输出是

```
得到[标准错误]
得到[标准输出]
```

# iphone - iphone：如何为 MapKit 上的每个针点显示不同的图像？

> ID：10585124
> 
> 赞同：2
> 
> 时间：2012-05-14T14:17:15.393
> 
> 标签：iphone, objective-c, ios, ipad, mapkit

我想将带有叠加层的开始和结束图像放在 iPhone/iPad 应用程序中。我有起点和终点纬度和经度值，想在起点和终点之间绘制叠加层，并将起点图像放在起点上，将终点图像放在终点上。

我用谷歌搜索，但我发现 MapKit 获取一张图像并将其设置在起点和终点，找不到第二张图像的任何帮助。

像

```
annotationView.image=[UIImage imageNamed:@"parkingIcon.png"]; 
```

它只为起点和终点设置一个图像。但我想为这两点放置不同的图像。

请帮忙。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-17T11:20:09.963

我明白了......感谢所有试图帮助我的人。完整的解决方案是

创建一个类

```
 @interface MyAnnotationClass : NSObject <MKAnnotation> {
        NSString *_name;
        NSString *_description;
        CLLocationCoordinate2D _coordinate;

    }
    @property (nonatomic, retain) NSString *name;
    @property (nonatomic, retain) NSString *description;
    @property (nonatomic, readonly) CLLocationCoordinate2D coordinate;

    -(id) initWithCoordinate:(CLLocationCoordinate2D) coordinate; 
```

ViewDidLoad 方法代码：

```
mapView.delegate = self;
    //Initialize annotation
    MyAnnotationClass *commuterLotAnnotation=[[MyAnnotationClass alloc] initWithCoordinate:CLLocationCoordinate2DMake( 39.047752, -76.850388)];
    commuterLotAnnotation.name = @"1";
    MyAnnotationClass *overflowLotAnnotation=[[MyAnnotationClass alloc] initWithCoordinate:CLLocationCoordinate2DMake(  39.047958, -76.852520)];
    overflowLotAnnotation.name = @"2";

    //Add them to array
    self.myAnnotations=[NSArray arrayWithObjects:commuterLotAnnotation, overflowLotAnnotation, nil];

    //Release the annotations now that they've been added to the array
    [commuterLotAnnotation release];
    [overflowLotAnnotation release];

    //add array of annotations to map
    [mapView addAnnotations:_myAnnotations]; 
```

viewFor注解代码：

```
-(MKAnnotationView *)mapView:(MKMapView *)MapView viewForAnnotation:(id<MKAnnotation>)annotation{
    static NSString *parkingAnnotationIdentifier=@"ParkingAnnotationIdentifier";

    if([annotation isKindOfClass:[MyAnnotationClass class]]){

        //Try to get an unused annotation, similar to uitableviewcells
        MKAnnotationView *annotationView=[MapView dequeueReusableAnnotationViewWithIdentifier:parkingAnnotationIdentifier];
        //If one isn't available, create a new one
        if(!annotationView){
            annotationView=[[MKAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:parkingAnnotationIdentifier];
            if([((MyAnnotationClass *)annotation).name isEqualToString: @"1"]){
                annotationView.image=[UIImage imageNamed:@"passenger.png"];
            }
            else if([((MyAnnotationClass *)annotation).name isEqualToString: @"2"]){
                annotationView.image=[UIImage imageNamed:@"place.png"];
            }                                   
        }
        return annotationView;
    }
    return nil;
} 
```

这就是您可以为 MapKit 上的每个点添加单独图像的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:32:34.440

您必须使用`-(MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id<MKAnnotation>)annotation;`MKAnnotation 委托方法

它允许您在地图上设置给定的注释。

每个注释都会返回此方法，您只需找到结束和开始注释并将图像设置为它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:57:10.883

首先，您必须实现 MKMapViewDelegate 协议并将委托类设置为您的地图。

在 MKMapView 委托中，声明方法：

```
- (MKAnnotationView *)mapView:(id)mapView viewForAnnotation:(id <MKAnnotation>)annotation {
    if (annotation == [mapView userLocation]) // The user's blue point : no customisation.
        return nil;

    MKAnnotationView * annView = [mapView dequeueReusableAnnotationViewWithIdentifier:/* your specific identifier */];
    if (annView == nil) {
        annView = [[[MKAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:/* your specific identifier */] autorelease];
    }
    annView.image = /* your image */;
    return annView
} 
```

但是您必须检测注释是开始注释还是结束注释。您可以设置特定标题以轻松检索它（如@“start”）或通过添加区分属性来子类化您的 MKAnnotations。

# sql - 运行的查询无法保存为视图

> ID：10585125
> 
> 赞同：0
> 
> 时间：2012-05-14T14:17:22.230
> 
> 标签：sql

SQL Server 2008

我有一个包含几个局部变量的查询，这些变量在结果集中进行了一些简单的数学运算。当我复制并粘贴查询以尝试将其保存为视图时，它无法告诉我语法不正确。（在这种情况下，它靠近变量的声明语句。）如果需要，我会发布查询，只是想知道是否有理由让它以一种方式而不是另一种方式工作。

```
declare @totalpop float,
@totalMales float,
@totalFemales float,
@percentMales float,
@percentFemales float;
select @totalmales=sum(case when sex='m' then 1 else 0 end),
@totalfemales = sum(case when sex='f' then 1 else 0 end),
@totalpop=count(*)

from tblVisits
select @percentmales = round(100 * @totalmales/@totalpop,2),
@percentFemales = round(100*@totalfemales/@totalpop,2)

select @totalmales,@percentmales,@totalfemales, @percentfemales, @totalpop 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T14:25:10.307

您不需要任何声明的变量，您可以使用嵌套选择在普通旧 sql 中执行此操作：

```
SELECT totalmales, round(1e2*totalmales/totalpop, 2) percentmales,
       totalfemales, round(1e2*totalfemales/totalpop, 2) percentfemales,
       totalpop
FROM (SELECT sum(case when sex='m' then 1 else 0 end) totalmales,
             sum(case when sex='f' then 1 else 0 end) totalfemales,
             count(*) totalpop
      FROM tblVisits) innerquery 
```

这应该可以在大多数支持视图和子选择的数据库上使用（基本上就是所有这些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:26:10.527

您不能在视图中使用变量。但是，您可以将其转换为 SP（存储过程）或基于表的函数。

编辑：或者做 TokenMacGuy 告诉你的：P。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:47:06.460

您使用的是 SQL Server 2008，因此另一种方法是使用 PIVOT：

```
 create view V as 
  select
    m as totalmales,
    round(1e2*m/(m+f),2) as pctmales,
    f as totalfemales,
    round(1e2*f/(m+f),2) as pctfemales,
    m+f as totalpop
  from tblVisits as T
  pivot (count(sex) for sex in ([m],[f])) as P; 
```

如果这样做，请确保在 round() 表达式中保留 1e2 或使用 100.0 而不是 100。否则，除法 m/(m+f) 和 f/(m+f) 将是整数除法，并且都产生零。

# java - 如何从 Java 调用 Scala 的 HashMap.toArray()？

> ID：10585126
> 
> 赞同：4
> 
> 时间：2012-05-14T14:17:26.717
> 
> 标签：java, scala

我使用`scala.collection.immutable.HashMap<A,B>`了一些 Java 代码，并希望使用 Scala-native 方法`toArray()`将映射的内容（或值）转换为数组。

我目前使用`JavaConversions.asMap()`etc，然后使用传统但丑陋的 Java`toArray(T[])`方法，但我更愿意直接调用 Scala 内置方法。

这必须从 Java 完成。用 Scala 重写代码不是一种选择。

我正在使用 Scala 2.9.1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:51:42.077

您需要`ClassManifest`为数组类型提供`T`. 这可从`ClassManifest`. 所以：

```
itr.toArray(ClassManifest$.MODULE$.fromClass(T.class)); 
```

在这个例子中，`T`是一个真正的类型（不是一个类型参数）。因此，例如，如果`itr`是 a `Seq[String]`，您将使用它；

```
itr.toArray(ClassManifest$.MODULE$.fromClass(String.class)); 
```

因为 scala`Map`实际上是一堆元组，所以你会使用这个：

```
map.toArray(ClassManifest$.MODULE$.fromClass(Tuple2.class)); 
```

当然，这为您提供了 a `Tuple2[]`，而不是 a分别`Tuple2<K,V>[]`用于键和值类型`K`和`V`。正如您在 Java 领域一样，您可以转换原始类型

* * *

**注意**：*从 Java 访问伴随对象*。

`M`通过访问静态字段可以获得类型的伴随对象`M$.MODULE$`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:03:46.787

这应该足够了：

```
map.toArray(scala.reflect.ClassManifest$.MODULE$.Object); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:49:29.047

在这种情况下，从 java 调用 scala 特定方法有时会非常难看。我不知道是否有更好的解决方案，但这应该可行：

```
import scala.collection.immutable.HashMap;

import scala.Tuple2;
import scala.reflect.ClassManifest$;
import scala.reflect.ClassManifest;

public class Foo {
  public static void main(String[] args) {
    HashMap<String,String> map = new HashMap();
    Object ar = map.<Tuple2<String,String>>toArray((ClassManifest<Tuple2<String,String>>)ClassManifest$.MODULE$.fromClass(new Tuple2<String,String>("","").getClass()));
    System.out.println(ar.toString());
  }
} 
```

我不知道在 Java 中`Class<Tuple2<String,String>>`没有先实例化它的方法。在 scala 中我会使用`classOf[...]`java 中是否有等价物？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:11:00.210

`Manifest`从 API 文档来看，您似乎需要`ArrayTag`向`toArray`.

# xslt - 使用 xslt 将混合内容修剪到最大字符数

> ID：10585133
> 
> 赞同：1
> 
> 时间：2012-05-14T14:17:48.890
> 
> 标签：xslt, xslt-1.0, xslt-2.0

我有以下xml：

`<p>Lorem ipsum dolor sit amet, <b>consectetur adipisicing</b> elit, <i>sed do<sup>2</sup></i> eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>`

而且我只想显示前 200 个字符，但它可能不会在单词中间被截断，并且我想保留格式元素。所以上面的片段改造后就变成了：

`<p>Lorem ipsum dolor sit amet, <b>consectetur adipisicing</b> elit, <i>sed do<sup>2</sup></i> eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ...</p>`

有谁知道这是否可能？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T04:33:09.430

**这个 XSLT 2.0 转换**：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema">
 <xsl:output omit-xml-declaration="yes" indent="no"/>
 <xsl:strip-space elements="*"/>

 <xsl:param name="pmaxChars" as="xs:integer" select="200"/>

 <xsl:variable name="vPass1">
   <xsl:apply-templates select="/*"/>
 </xsl:variable>

 <xsl:template match="node()|@*" mode="#default pass2">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*" mode="#current"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="/">
  <xsl:apply-templates select="$vPass1" mode="pass2"/>
 </xsl:template>

 <xsl:template match=
 "text()[sum(preceding::text()/string-length()) ge $pmaxChars]"/>

 <xsl:template match="text()[not(following::text())]" mode="pass2">
   <xsl:variable name="vPrecedingLength"
     select="sum(preceding::text()/string-length())"/>

   <xsl:variable name="vRemaininingLength"
     select="$pmaxChars -$vPrecedingLength"/>

  <xsl:sequence select=
   "replace(.,
            concat('(^.{0,', $vRemaininingLength, '})\W.*'),
            '$1'
            )
   "/>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<p>Lorem ipsum dolor sit amet, <b>consectetur adipisicing</b> elit, <i>sed do<sup>2</sup></i> eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p> 
```

**产生所需的正确结果**（一个 XML 文档，其中所有文本节点的总长度不超过 200，截断是在单词边界上执行的，这是剩余最大可能总字符串长度的截断）：

```
<p>Lorem ipsum dolor sit amet, <b>consectetur adipisicing</b> elit, <i>sed do<sup>2</sup></i> eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut</p> 
```

**说明**：

1.  这是一个通用解决方案，它接受最大数量的文本字符作为全局/外部参数`$pmaxChars`。

2.  这是一个两遍解决方案。在 pass1 中，**[标识规则](http://dpawson.co.uk/xsl/sect2/identity.html)**被删除所有文本节点的模板覆盖，其起始字符的索引（在所有文本节点的总连接中）大于允许的最大字符数。因此， pass1 的结果是一个 XML 文档，其中最大允许长度的“中断”出现在最后一个文本节点中。

3.  在 pass 2 中，我们使用与最后一个文本节点匹配的模板覆盖身份规则。我们使用**[`replace()`](http://www.w3.org/TR/2010/REC-xpath-functions-20101214/#func-replace)**函数：

……

```
replace(.,
            concat('(^.{0,', $vRemaininingLength, '})\W.*'),
            '$1'
            ) 
```

这会导致完整的字符串被匹配并被括号之间的子表达式替换。此子表达式是动态构造的，它匹配从字符串开头开始并包含从 0 到`$vRemaininingLength`（允许的最大长度减去所有前面的文本节点的总长度）字符的最长子字符串，并且紧跟在单词边界字符之后.

**更新**：

要摆脱由于修剪而没有文本节点后代（“空”）的结果元素，只需添加这个额外的模板：

```
 <xsl:template match=
 "*[(.//text())[1][sum(preceding::text()/string-length()) ge $pmaxChars]]"/> 
```

# java - Eclipse 报告“加载 JNI 共享库失败”

> ID：10585135
> 
> 赞同：133
> 
> 时间：2012-05-14T14:17:49.337
> 
> 标签：java, eclipse, java-native-interface

我无法打开 Eclipse，因为我收到一条警告说

> 无法加载 JNI 共享库 C:\Program Files (x86)\eclipse\jre\bin\client\jvm.dll

我在 YouTube 上找到了一种解决方案，*[Eclipse Failed to load JNI library fix](http://www.youtube.com/watch?v=DPiOD5V74nk)*。

他说你只需要下载一个[JRE](http://en.wikipedia.org/wiki/Java_Virtual_Machine#Execution_environment) 7 文件夹。然后我只需要替换 `C:\Program Files (x86)\Java\jre7\bin\server\jvm.dll`为`C:\Program Files (x86)\eclipse\jre\bin\client\jvm.dll`.

但是 JRE 7 链接在哪里？

* * *

## 回答 #1

> 赞同：196
> 
> 时间：2012-05-14T14:38:46.667

首先，确保您的 Eclipse 和 JDK 版本匹配，无论是 64 位还是 32 位（不能混合匹配 32 位和 64 位）。

其次， -vm 参数`eclipse.ini`应该指向 java 可执行文件。有关示例，请参见 [http://wiki.eclipse.org/Eclipse.ini](http://wiki.eclipse.org/Eclipse.ini)。

如果您不确定您安装了哪个版本的 Eclipse（64 位或 32 位），您可以通过几种不同的方式来确定。请参阅[如何确定安装的 Eclipse 是 32 位还是 64 位版本？](https://stackoverflow.com/questions/5103366/how-to-find-out-if-an-installed-eclipse-is-32-or-64-bit-version)

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2012-06-13T08:08:19.857

安装 64 位版本的 Java 将解决该问题。转到页面*[适用于所有操作系统的 Java 下载](http://www.java.com/en/download/manual.jsp)*

这是一个问题，因为如果您使用的是 64 位系统，Java 版本和 Eclipse 版本都应该是 64 位。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-07-11T07:53:36.420

是的，在 Windows 7 64 位中，您拥有`C:\Program Files`和`C:\Program Files (x86)`. 您可以在这两个文件夹中找到 Java 文件夹，但您必须添加`C:\Program Files\Java\jre7\bin`到环境变量 PATH。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-07-07T13:11:31.620

[JRE](http://en.wikipedia.org/wiki/Java_Virtual_Machine#Execution_environment) 7 可能安装在`Program Files\Java`而不是`Program Files(x86)\Java`.

# cuda - CUDA 中指向共享内存的本地指针

> ID：10585139
> 
> 赞同：1
> 
> 时间：2012-05-14T14:18:12.270
> 
> 标签：cuda

如何使线程块中的每个线程都有自己的指向共享内存的指针？我找到了一些声明此类指针的示例：

```
int __shared__ *p;
__shared__ int array[256];

p = &array[threadId]; 
```

这是正确的还是有其他方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T14:27:29.993

不，这不是正确的方法。在该示例代码中，`p`是共享的，因此这意味着块中的每个线程都将尝试访问同一块内存。`threadId`如果块的唯一线程索引是这样的，你可以这样做：

```
int *p;
__shared__ int array[256];

p = &array[threadId]; 
```

在这种情况下，编译器将使用寄存器或线程本地内存来存储`array`块中每个线程的静态共享内存分配中元素的唯一地址。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-14T14:29:00.163

你说的对。更好的方法是动态分配共享内存。一个例子是：

```
void __global__ test(){
extern __shared__ int s[];
int *p = &s[xx];

}

...
test<<<x,y, shared memory length>>>();
... 
```

# java - 拒绝访问 MySQL 的 GAE CloudSQL

> ID：10585140
> 
> 赞同：3
> 
> 时间：2012-05-14T14:18:14.020
> 
> 标签：java, google-app-engine, jpa, eclipselink, google-cloud-sql

我有一个在以下环境下运行良好的 Web 应用程序

*   GWT 2.4.0
*   RestEasy 2.3.2.Final JAX-RS & JAXB
*   Hibernate JPA 2.0 (hibernate-entitymanager + hibernate-validator) 4.2.0.Final
*   本地主机上的 MySQL 5.5.22 (Ubuntu 12.04)
*   VMware 2.6 tomcat 服务器

该应用程序使用 JAX-RS、JAXB、Jackson JSON 提供程序、Hibernate JPA 注释全部混合到同一个 DTO 中成功运行。

我正在尝试将其移植到 GAE CloudSQL。我遇到 MySQL 访问错误。我不得不将 ORM 从 Hibernate 更改为 EclipseLink 2.3.2。

**提醒**：

*   我恭敬地要求回答者不要假设我的代码中存在错误的可能性，而不是解决手头的问题 - 如何将我的基于 Hibernate 的 JPA 移植到 EclipseLink。除非您认为我的适合 Hibernate 的设置或代码需要更改才能与 GAE CloudSQL 一起使用。原因是，该应用程序在 Hibernate 下运行良好。

*   请不要提供有关如何使 Hibernate 与 GAE CloudSQL 一起工作的说明，除非它涉及 Hibernate JPA 2.0。我意识到互联网上有一个关于如何在 CloudSQL 但没有 JPA 的情况下使用 Hibernate 的示例。

*   如果您有关于如何使 DataNucleus JPA 2.0 与 GAE CloudSQL 一起使用的信息，那将非常有帮助。我无法让它工作，这就是我使用 EclipseLink 的原因。

*   此外，MySQL 数据源用户和密码能够通过 Eclipse 数据源资源管理器或 SQL Explorer 或 SQL Squirrel 客户端访问数据库。因此，用户/密码没有问题。除非您认为我需要对 MqSQL 用户或主机设置进行修改。

*   我已经在 mysql.db 表中添加了一行以包含主机 localhost.localdomain。

*   我已经将启动/调试配置修改为 -Drdbms.url=jdbc:mysql://localhost:3306/Site?user=site&password=random&useInformationSchema=true&useUnicode=true&characterEncoding=UTF8&useServerPrepStmts=true，按照“使用本地 MySQL 实例”的说明在[http://developers.google.com/cloud-sql/docs/developers_guide_java](http://developers.google.com/cloud-sql/docs/developers_guide_java)中的“开发期间” 。

*   您的解决建议必须涉及 JPA 2.0 而不是 1.0。

*   我没有访问我的 CloudSQL 帐户，而是在 Ubuntu 12.04 上运行的 localhost MySQL 数据库。我还没有尝试使用这个应用程序访问我的 CloudSQL 数据库（还）。

可能是，我的persistence.xml 中需要更多行？可能是我的 EMF 设置需要修改吗？可能是，GAE 需要与 Hibernate 不同的 EMF 获取顺序？也许，我需要禁用 DataNucleus？

请帮助和建议。非常感谢。

* * *

错误堆栈指示 java.security.AccessControlException: access denied ("java.net.SocketPermission" "localhost" "resolve"):

```
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: Could not create connection to database server.
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    at com.google.appengine.tools.development.agent.runtime.Runtime.newInstance_(Runtime.java:126)
    at com.google.appengine.tools.development.agent.runtime.Runtime.newInstance(Runtime.java:134)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.Util.getInstance(Util.java:386)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1013)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:987)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:982)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:927)
    at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2411)
    at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2153)
    at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:792)
    at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:47)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    at com.google.appengine.tools.development.agent.runtime.Runtime.newInstance_(Runtime.java:126)
    at com.google.appengine.tools.development.agent.runtime.Runtime.newInstance(Runtime.java:134)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:381)
    at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:305)
    at java.sql.DriverManager.getConnection(DriverManager.java:579)
    at java.sql.DriverManager.getConnection(DriverManager.java:190)
    at org.eclipse.persistence.sessions.DefaultConnector.connect(DefaultConnector.java:98)
    ... 55 more
Caused by: java.security.AccessControlException: access denied ("java.net.SocketPermission" "localhost" "resolve")
    at java.security.AccessControlContext.checkPermission(AccessControlContext.java:366)
    at java.security.AccessController.checkPermission(AccessController.java:555)
    at java.lang.SecurityManager.checkPermission(SecurityManager.java:549)
    at com.google.appengine.tools.development.DevAppServerFactory$CustomSecurityManager.checkPermission(DevAppServerFactory.java:252)
    at java.lang.SecurityManager.checkConnect(SecurityManager.java:1048)
    at java.net.InetAddress.getAllByName0(InetAddress.java:1203)
    at java.net.InetAddress.getAllByName(InetAddress.java:1127)
    at java.net.InetAddress.getAllByName(InetAddress.java:1063)
    at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:247)
    at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:294)
    at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2332)
    at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2369) 
```

持久性.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
  version="1.0">
  <persistence-unit name="Site" transaction-type="RESOURCE_LOCAL">
    <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
    <class>org.blessedgeek.site.jaxrs.dto.Node</class>
    <properties>
      <property name="javax.persistence.jdbc.user" value="site" />
      <property name="javax.persistence.jdbc.password" value="random" />
      <property name="javax.persistence.jdbc.url" value="jdbc:mysql://localhost:3306/Site" />
      <property name="javax.persistence.jdbc.driver" value="com.mysql.jdbc.Driver"></property>
    </properties>
  </persistence-unit>
</persistence> 
```

maven依赖

```
<properties>
  <resteasy.version>2.3.2.Final</resteasy.version>
</properties>
<dependencies>
  <dependency>
    <groupId>junit</groupId>
    <artifactId>junit</artifactId>
    <version>4.10</version>
    <scope>test</scope>
  </dependency>
  <dependency>
    <groupId>com.google.gwt</groupId>
    <artifactId>gwt-user</artifactId>
    <version>2.4.0</version>
  </dependency>
  <dependency>
    <groupId>javax.validation</groupId>
    <artifactId>validation-api</artifactId>
    <version>1.0.0.GA</version>
  </dependency>

  <dependency>
    <groupId>com.smartgwt</groupId>
    <artifactId>smartgwt</artifactId>
    <version>3.0</version>
  </dependency>
  <dependency>
    <groupId>com.smartgwt</groupId>
    <artifactId>smartgwt-skins</artifactId>
    <version>3.0</version>
  </dependency>
  <dependency>
    <groupId>com.googlecode.mvp4g</groupId>
    <artifactId>mvp4g</artifactId>
    <version>1.4.0</version>
  </dependency>

  <dependency>
    <groupId>mysql</groupId>
    <artifactId>mysql-connector-java</artifactId>
    <version>5.1.18</version>
  </dependency>

  <dependency>
    <groupId>org.jboss.resteasy</groupId>
    <artifactId>resteasy-jaxrs</artifactId>
    <version>${resteasy.version}</version>
    <type>jar</type>
  </dependency>
  <dependency>
    <groupId>org.jboss.resteasy</groupId>
    <artifactId>resteasy-jaxb-provider</artifactId>
    <version>${resteasy.version}</version>
  </dependency>
  <dependency>
      <groupId>org.jboss.resteasy</groupId>
      <artifactId>resteasy-jackson-provider</artifactId>
      <version>${resteasy.version}</version>
  </dependency>
</dependencies> 
```

appengine-web.xml

```
<?xml version="1.0" encoding="utf-8"?>
<appengine-web-app xmlns="http://appengine.google.com/ns/1.0">
  <application></application>
  <version>1</version>

  <threadsafe>true</threadsafe>

  <!-- Configure serving/caching of GWT files -->
  <static-files>
    <include path="**" />

    <include path="**.nocache.*" expiration="0s" />

    <include path="**.cache.*" expiration="365d" />
    <exclude path="**.gwt.rpc" />
  </static-files>

  <system-properties>
    <property name="java.util.logging.config.file" value="WEB-INF/logging.properties"/>
  </system-properties>

  <sessions-enabled>true</sessions-enabled>
  <async-session-persistence enabled="true" />

</appengine-web-app> 
```

web.xml

```
<!DOCTYPE web-app PUBLIC
 "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
 "http://java.sun.com/dtd/web-app_2_3.dtd" >

<web-app>
  <display-name>Blessed Geek Site</display-name>
  <!-- Auto scan REST service -->
  <context-param>
    <param-name>resteasy.scan</param-name>
    <param-value>true</param-value>
  </context-param>

  <!-- this need same with resteasy servlet url-pattern -->
  <context-param>
    <param-name>resteasy.servlet.mapping.prefix</param-name>
    <param-value>/site</param-value>
  </context-param>

  <listener>
    <listener-class>
      org.jboss.resteasy.plugins.server.servlet.ResteasyBootstrap
    </listener-class>
  </listener>

  <servlet>
    <servlet-name>resteasy-servlet</servlet-name>
    <description>JAX-RS Tools Generated - Do not modify</description>
    <servlet-class>org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>

  <servlet-mapping>
    <servlet-name>resteasy-servlet</servlet-name>
    <url-pattern>/site/*</url-pattern>
  </servlet-mapping>
</web-app> 
```

示例 DTO 类

```
@Entity
@XmlAccessorType(XmlAccessType.FIELD)
@XmlRootElement (name="node")
@XmlType(propOrder = { "id", "name", "description", "iconURL", "parentID", "active", "type"})
public class Node
implements Serializable{

  public enum Type{
    VIEW, ROOTNode, FOLDER, LEAF
  }

  @XmlAttribute
    @Id
    @GeneratedValue
    private Long id;
  @XmlAttribute
  private String name;
  @XmlAttribute
  private String description;
  @XmlAttribute
  private String iconURL;
  @XmlAttribute
  private long parentID;
  @XmlAttribute
  private boolean active;
  @XmlAttribute
    @Enumerated(EnumType.STRING)
  private Type type;

  public Node() {
    super();
  }

  public Node(String name, String description) {
    super();
    this.name = name;
    this.description = description;
  }

  public Long getId() {
    return id;
  }

  public void setId(Long id) {
    this.id = id;
  }

  public String getName() {
    return name;
  }

  public void setName(String name) {
    this.name = name;
  }

  public String getDescription() {
    return description;
  }

  public void setDescription(String description) {
    this.description = description;
  }

  public String getIconURL() {
    return iconURL;
  }

  public void setIconURL(String iconURL) {
    this.iconURL = iconURL;
  }

  public long getParentID() {
    return parentID;
  }

  public void setParentID(long parentID) {
    this.parentID = parentID;
  }

  public boolean isActive() {
    return active;
  }

  public void setActive(boolean active) {
    this.active = active;
  }

  public Type getType() {
    return type;
  }

  public void setType(Type type) {
    this.type = type;
  }

} 
```

**2012/05/16 更新**：

我还在 persistence.xml 中将 jdbc 驱动程序替换为 com.google.appengine.api.rdbms.AppEngineDriver。仍然遇到相同的访问控制异常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T16:19:14.633

在 persistence.xml 中，尝试使用：

```
javax.persistence.jdbc.url = jdbc:google:rdbms://localhost/Site
javax.persistence.jdbc.driver = com.google.appengine.api.rdbms.AppEngineDriver 
```

并将mysql jar（从[http://dev.mysql.com/downloads/connector/j/](http://dev.mysql.com/downloads/connector/j/)下载）放入appengine-java-sdk-1.6.x/lib/impl

使用本地 MySQL 和 JDO 为我工作。

# java - SQL 响应类型

> ID：10585144
> 
> 赞同：1
> 
> 时间：2012-05-14T14:18:27.820
> 
> 标签：java, sql, jdbc

在我的应用程序中，我从用户那里得到一个 SQL 查询，然后我发送到一个数据库。我可以在不解析查询的情况下获取有关 SQL 查询的结果类型的信息吗？我使用纯 JDBC 来执行这些操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:27:46.730

`connection.prepareStatement()`在您的查询中使用，将`preparedStatement`返回 a。用它的[`.getMetaData()`方法](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#getMetaData%28%29)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:31:04.670

是的。您可以使用 a`PreparedStatement`并调用其`getMetadata`方法，以获得有关`ResultSet`它将返回的 s 列的信息。

[http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#getMetaData](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#getMetaData) ()

```
Connection conn = ...
PreparedStatement ps = conn.prepareStatement(yourStatement);
ResultSetMetadata metadata = ps.getMetadata(); // this is what you need
...
// now you can execute the query
ResultSet rs = ps.executeQuery(); 
```

# sharepoint - IIS 7.5 IP 地址限制不起作用

> ID：10585147
> 
> 赞同：1
> 
> 时间：2012-05-14T14:18:35.097
> 
> 标签：sharepoint, iis-7, web-hosting

我正在尝试通过 IIS 7 IP 地址和域限制选项锁定对 Sharepoint 3 站点的访问。我们目前在许多通过 IIS 6 运行的 Sharepoint 2 站点上都有此设置。

问题是在编辑站点限制后，它们似乎没有生效。

我已编辑功能设置以拒绝未指定客户端的访问，然后添加了特定的允许 IP 条目。到目前为止，这似乎一切都很好。

然后我尝试从未指定的 IP 连接，我仍然可以连接？！然后，我尝试明确拒绝来自 IP 的访问，但我仍然可以在该 IP 上连接。我真的不确定为什么会发生这种情况，因为在检查 applicationhost.config 文件时我可以看到 IPSecurity 设置已修改如下

```
</authentication>
                <ipSecurity allowUnlisted="false">
                    <add ipAddress="IP Address*" allowed="true" />
                </ipSecurity> 
```

应用程序池已被回收，停止查看是否有帮助，我什至停止/启动了网站本身。我不明白为什么这在 IIS 6 下不起作用我从来没有遇到过这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T10:31:40.850

为了回答我自己的问题，我从我的网络团队中找到了原因。

这似乎是由于我们的 Stingray 负载平衡器的设置。他们被设置为通过自己的 IP 代理公共 IP，因此在使用默认网关时绕过了 IIS 中的 IP 限制设置。

有点烦人，但至少我知道为什么。

# css - 如何在 CSS3 中使用背景尺寸：封面和背景位置？

> ID：10585148
> 
> 赞同：0
> 
> 时间：2012-05-14T14:18:42.400
> 
> 标签：css, background, background-image

是一种在课堂上同时使用`background-size: cover`和使用的方法吗？`background-position`

例子 ：

```
.image { 
    background-size: cover;
    background-position: -200px 0;
    background-image: url('...');
} 
```

该属性`background-position`不起作用。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:04:21.553

**解决方案**：添加`margin-top: -200px;`

# php - 运算符 -> 在 PHP 中是什么意思？

> ID：10585149
> 
> 赞同：0
> 
> 时间：2012-05-14T14:18:42.727
> 
> 标签：php

> **可能的重复：**
> [PHP 语法 $var1->$var2 是什么意思？](https://stackoverflow.com/questions/2316370)
> [参考 - 这个符号在 PHP 中是什么意思？](https://stackoverflow.com/questions/3737139)

我正在查看 PHP 框架的代码，然后不时出现符号“->”...例如：

```
$controller->permissionCheck($ret); 
```

“->”代表什么，用来做什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T14:19:41.153

在您的示例中，`$controller`是在某处创建的 PHP 对象，permissionCheck 是在该对象中定义的函数，该函数被调用并`$ret`传递给它的变量。检查这个：*[参考 - 这个符号在 PHP 中是什么意思？](https://stackoverflow.com/questions/3737139/reference-what-does-this-symbol-mean-in-php)*.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:19:54.313

它用于处理类的函数或属性。在这种情况下，似乎调用了控制器类的函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T14:20:18.743

运算符`->`用于访问对象的非静态成员`$controller`。在您的情况下，成员是 function `permissionCheck`。

# gdb - 如何从核心转储中读取帧（没有 GDB）？

> ID：10585150
> 
> 赞同：6
> 
> 时间：2012-05-14T14:18:44.617
> 
> 标签：gdb, stack, frames, coredump

我想访问存储在没有调试符号的程序的核心转储中的帧（我想在 C 中执行此操作）。当我在 GDB 中打开程序和核心转储时，我会得到一个堆栈跟踪，包括函数的名称。例如：

```
(gdb) bt
#0  0x08048443 in layer3 ()
#1  0x08048489 in layer2 ()
#2  0x080484c9 in layer1 ()
#3  0x0804854e in main () 
```

所有函数的名称都存储在 .strtab 部分的可执行文件中。如何使用不同的帧建立堆栈跟踪？**不能**以批处理模式运行 GDB 。而且仅仅“从 gdb 复制需要的部分”也是一个坏主意，因为代码不是独立编写的。

所以为了更准确地提出我的问题：我在哪里可以找到核心转储中可以开始读取堆栈信息的点？是否有某种图书馆可以访问这些信息？我可以使用的结构？或者更好的是，文档是如何在核心转储中构建这些信息的？

（我已经看到了问题“[如何从 C 中的核心转储文件生成堆栈跟踪，而不调用 gdb 等外部工具](https://stackoverflow.com/questions/7944768/how-to-generate-a-stack-trace-from-a-core-dump-file-in-c-without-invoking-an-ex)”，但由于没有有效的答案，我想我会再问一次）

**[编辑]**我在 Linux x86 下做这个

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T12:55:51.703

Coredump 也包含堆栈信息。如果您可以将此堆栈信息与 coredump 文件中的 EBP 和 EIP 寄存器值一起使用，则可以打印堆栈跟踪。我写了一个程序来做到这一点。您可以在以下链接中找到该程序。

```
 http://www.emntech.com/programs/corestrace.c 
```

用法：编译上述程序，执行时给出corefile。

```
 $corestrace core 
```

如果您还想打印符号，您可以这样做：假设生成核心的程序是“测试”。

```
 $ nm -n test > symbols
       $ corestrace core symbols 
```

示例输出如下所示：

```
 $ ./coretrace core symbols 

        0x80483cd foo+0x9
        0x8048401 func+0x1f
        0x8048430 main+0x2d 
```

# batch-file - dos批处理文件根据时间跨度压缩文件夹

> ID：10585153
> 
> 赞同：0
> 
> 时间：2012-05-14T14:18:51.883
> 
> 标签：batch-file, zip, dos

我正在寻找一种根据上次修改日期的时间跨度压缩文件夹并在之后删除它们的方法

结构如下

```
Folder_1 01.01.2012 12:00
- sub1
- sub2
  - file1
  - file2
Folder_2 01.01.2012 12:02
...
Folder_20202 05.05.2012 03:00 
```

我现在要：

1.  选择比本月早 3 个月的所有文件夹（例如 lastmodified 是 2 月，而 current 是 5 月）。重要的一点是我想使用第一个月到最后一个月而不是-90天
2.  然后将所选文件夹及其所有子文件夹和文件压缩到一个 february2012.zip
3.  删除（现在）压缩文件的原件

到目前为止，我最好的想法是使用 forfiles.exe（只需要一个日期），使用生成的日期（3 个月前的第一天并使用更早的修饰符）并创建一个 resultextfile。然后使用结果文件作为 7zip.exe 的导入并以某种方式循环文件并随后删除文件夹（对于第 2 部分和第 3 部分，我还没有工作代码）

- 更新 -

目前我正在尝试：

```
FORFILES /P H:\Temp\2zip /M O* /D -31.4.2012 /C "cmd /c C:\Program Files (x86)\7-Zip\7z.exe a -t7z H:\temp\x2.zip @path 
```

这似乎工作 - 但只是非常缓慢（我猜原因是映射驱动器 - > 150MB 3h）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T12:34:23.820

处理文件夹的最后修改日期时要小心。在 FAT 文件系统上，时间戳不会随着文件夹内容的改变而改变。

在 NTFS 文件系统上，只要在文件夹中创建或删除文件或文件夹，就会更新上次修改日期。但如果文件被修改，或者在子文件夹中创建或删除文件/文件夹，则不会更新。

如果你仍然想推进你的计划，那么你的基本策略是相当可靠的。Windows 批处理对处理日期的支持很弱，因此没有太大的改进空间。

无论语言环境如何，解析当前日期（和时间，如果需要的话）的最佳方法是使用 WMIC：

```
for /f "skip=1" %%A in ('wmic os get localdatetime') do (
  set currentDateTime=%%A
  goto :exitLoop
)
:exitLoop
set year=%currentDateTime:~0,4%
set month=%currentDateTime:~4,2% 
```

您应该能够使用 7zip 的移动选项，这样您之后就不需要删除该文件夹。

您应该能够通过使用 FOR /F 处理 FORFILES 的结果来消除对临时文件的需要。或者更好的是，您可以使用 FORFILES /C 选项指定适当的 7zip 命令。

# c# - 使用 MadBee android bridge 获取连接设备列表

> ID：10585173
> 
> 赞同：3
> 
> 时间：2012-05-14T14:19:57.623
> 
> 标签：c#, android, adb

我正在开发一个小型应用程序，并将该项目用作通过套接字访问 adb 设备的框架：

[http://madb.codeplex.com](http://madb.codeplex.com)

我在主窗体构造函数中的代码：

```
if (useMadBee())
        {
            BridgeContainer.manager.adb.
                DeviceChanged += new EventHandler<DeviceEventArgs>(beeDeviceChanged);
            BridgeContainer.manager.adb.
                DeviceConnected += new EventHandler<DeviceEventArgs>(beeDeviceConnected);
            BridgeContainer.manager.adb.
                DeviceDisconnected += new EventHandler<DeviceEventArgs>(
                    beeDeviceDisconnected);
        } 
```

其中 adb 是 AndroidDebugBruidge（来自 MadBee 的类）

这是我的事件处理程序之一：

```
public void beeDeviceConnected(object sender, DeviceEventArgs e)
    {
        if (((string)dev_con_synclock).Equals("y"))
        {
            dev_con_synclock = "n";
            lock (dev_con_synclock)
            {
                List<Device> lista = BridgeContainer.manager.adb.Devices;
                connectedDevices.Clear();
                this.toolStripComboDevices.Items.Clear();

                foreach (Device d in lista)
                {
                    AndroidDevice newDevice = new AndroidDevice();
                    newDevice.modelName = d.Properties["ro.build.product"].ToString();
                    newDevice.deviceSerialNumber = d.SerialNumber;
                    this.toolStripComboDevices.Items.Add(
                    newDevice.modelName + "(" + newDevice.deviceSerialNumber + ")");
                    connectedDevices.Add(newDevice);
                }

                if (connectedDevices.Count > 0)
                {
                    toolStripComboDevices.Text = toolStripComboDevices.Items[0].ToString();
                }
                else
                {
                    toolStripComboDevices.Text = "";
                }
            }
            dev_con_synclock = "y";
        }
    } 
```

并且绕线

```
List<Device> lista = BridgeContainer.manager.adb.Devices; 
```

方法停止执行，程序继续存在。当我在这条线上调试时，我可以看到在这条线方法中一切正常（我正在收集设备），突然程序转到 MadB 类 DeviceMonitor 中的 DeviceMonitorLoop 并完成几个循环。

我的程序中的块**foreach（列表中的设备 d）**永远不会执行，由于某种奇怪的原因，该方法不会继续执行

我做错了什么？

我可以在程序启动时轻松获取设备列表，但是当事件执行时（即设备断开连接）（顺便说一句。我不知道为什么它执行了 3 次），我的方法将不起作用

方法 beeDeviceConnected(object sender, DeviceEventArgs e) 是否有可能被其他线程取消？

# javascript - Django 和 Ajax 推送引擎 (APE)：不安全的 JavaScript 尝试使用 URL 访问框架

> ID：10585174
> 
> 赞同：0
> 
> 时间：2012-05-14T14:19:59.713
> 
> 标签：javascript, python, django, ape

我正在尝试为我的 Django 项目设置 APE 服务器。

## 设置

1.  我按照 APE wiki 中的设置说明进行操作：[Simple APE Con​​figuration](http://www.ape-project.org/wiki/index.php/Simple_APE_configuration)

    我不得不改变端口。我的虚拟主机配置如下：

    ```
    NameVirtualHost 127.0.0.1:8100
    Listen 127.0.0.1:8100
    <VirtualHost 127.0.0.1:8100>
        ServerName local.ape-project.org
        ServerAlias ape.local.ape-project.org
        ServerAlias *.ape.local.ape-project.org

        DocumentRoot "/path/to/my/project/ape-jsf/"
    </VirtualHost> 
    ```

    运行[http://local.ape-project.org:8100/Tools/Check/](http://local.ape-project.org:8100/Tools/Check/)成功运行所有测试并返回消息：`All test done. Now you can play with your APE \o/`

2.  Django 在 8000 端口上运行：

    `python manage.py runserver_plus 0.0.0.0:8000`

3.  我按照第一个教程的说明进行操作：[教程：换色器](http://www.ape-project.org/wiki/index.php/Tutorial%3aColor_changer)

    我将 JavaScript 代码放入我的 django 项目中（包含`Clients/JavaScript.js`）。

## 问题

当我打开页面时，我收到此错误：

```
Unsafe JavaScript attempt to access frame with URL http://2.ape.local.ape-project.org:6969/?[{%22cmd%22:%22script%22,%22params%22:{%22domain%22:%22127.0.0.1%22,%22scripts%22:[%22http://local.ape-project.org:8100/static/ape-jsf/Source/mootools-core.js%22,%22http://local.ape-project.org:8100/static/ape-jsf/Source/Core/APE.js%22,%22http://local.ape-project.org:8100/static/ape-jsf/Source/Core/Events.js%22,%22http://local.ape-project.org:8100/static/ape-jsf/Source/Core/Core.js%22,%22http://local.ape-project.org:8100/static/ape-jsf/Source/Pipe/Pipe.js%22,%22http://local.ape-project.org:8100/static/ape-jsf/Source/Pipe/PipeProxy.js%22,%22http://local.ape-project.org:8100/static/ape-jsf/Source/Pipe/PipeMulti.js%22,%22http://local.ape-project.org:8100/static/ape-jsf/Source/Pipe/PipeSingle.js%22,%22http://local.ape-project.org:8100/static/ape-jsf/Source/Request/Request.js%22,%22http://local.ape-project.org:8100/static/ape-jsf/Source/Request/Request.Stack.js%22,%22http://local.ape-project.org:8100/static/ape-jsf/Source/Request/Request.CycledStack.js%22,%22http://local.ape-project.org:8100/static/ape-jsf/Source/Transport/Transport.longPolling.js%22,%22http://local.ape-project.org:8100/static/ape-jsf/Source/Transport/Transport.SSE.js%22,%22http://local.ape-project.org:8100/static/ape-jsf/Source/Transport/Transport.XHRStreaming.js%22,%22http://local.ape-project.org:8100/static/ape-jsf/Source/Transport/Transport.JSONP.js%22,%22http://local.ape-project.org:8100/static/ape-jsf/Source/Core/Utility.js%22,%22http://local.ape-project.org:8100/static/ape-jsf/Source/Core/JSON.js%22]}}]
from frame with URL http://127.0.0.1:8000/mydjangoapp/somepage/. Domains, protocols and ports must match. 
```

我了解不同域和端口存在安全问题。

**但这应该如何工作？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T17:00:07.507

事实证明，很难配置一个同时运行`Ape`和的环境`runserver`。解决此问题的方法是使用另一个 Web 服务器。

我选择了 Apache 和 mod_wsgi 模块：

*   mod_wsgi 教程：[与 Django 集成](http://code.google.com/p/modwsgi/wiki/IntegrationWithDjango)
*   小心静态文件：[How to use Django with Apache and mod_wsgi](https://docs.djangoproject.com/en/1.2/howto/deployment/modwsgi/)

# c# - 具有嵌套选择查询的 OrmLite

> ID：10585176
> 
> 赞同：2
> 
> 时间：2012-05-14T14:19:59.950
> 
> 标签：c#, crud, servicestack, ormlite-servicestack

我已经概括了我的问题，以迎合最多的有类似问题的人。

```
public class Table1 {
    [AutoIncrement]
    public Int32 Id { get; set; }
    [Index(Unique = true)]
    public string FieldA { get; set; }
    public string FieldB { get; set; }
    public string FieldC { get; set; }
}

public Table2 {
    [AutoIncrement]
    public Int32 Id { get; set; }
    [Index(Unique = true)]
    public Table1 FieldA { get; set; }
    public DateTime FieldB { get; set; }
    public int FieldC { get; set; }
}

public Table3 {
    [AutoIncrement]
    public Int32 Id { get; set; }
    [Index(Unique = true)]
    public List<Table2> FieldA { get; set; }
    public List<Table1> FieldB { get; set; }
}

public Table4 {
    [AutoIncrement]
    public Int32 Id { get; set; }
    [Index(Unique = true)]
    public int FieldA { get; set; }
    [References(typeof(Table3))]
    public int Table3_id { get; set; }
    [References(typeof(Table2))]
    public int Table2_id { get; set; }
} 
```

**如何填充`List`包含 Table4 完整信息的表格？**即：包括其引用表的每个字段的值 - 以及那些引用的表

我还对如何从 JSON 序列化创建单个 CRUD 表单感兴趣，它可以创建一个全新的 Table4 条目，嵌套 Table3、Table2 和 Table1 的 CRUD 表单。

感谢所有帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T02:49:13.127

要在 1 个查询中读取多个表，您需要使用映射到与返回的结果集匹配的合并 Poco 的 SQL JOIN，请参阅此答案中的 Shipper 示例以获取示例：

[https://stackoverflow.com/a/8617860/85785](https://stackoverflow.com/a/8617860/85785)

# java - Android 找出当前存在的视图

> ID：10585178
> 
> 赞同：0
> 
> 时间：2012-05-14T14:20:04.083
> 
> 标签：java, android

我有一个活动，它在创建时包含一个 EditText，但如果您单击一个按钮，它会被一个名为 MinPick 的自定义视图替换。我需要另一个类来通过 findViewById() 获取视图。但当然我需要定义获取 id 的变量应该是什么。EditText 或 MinPick。如果它不是 EditText 它必须是 MinPick，我该如何做某种条件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:28:13.673

您可以使用以下命令检查返回的对象的类`instanceof`：

```
final View v = findViewById(R.id.floating_component);
if (v instanceof EditText)
    // do stuff with the EditText instance;
else if (v instanceof MinPick)
    // do stuff with the MinPick instance; 
```

另一方面，`@Sergey Glotov`是的，处理状态并基于它们显示适当的视图是一种更好的技术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:25:10.413

您可以使用“instanceof”：

```
final View tempView = findViewById(R.id.XXXxxxxXXX);

if (tempView instanceof EditText)
{
// TODO Do some stuff
}
else
{
// TODO Do some other stuff
} 
```

# python - 画布上元素的跟踪列表（tkinter）

> ID：10585184
> 
> 赞同：0
> 
> 时间：2012-05-14T14:20:19.153
> 
> 标签：python, canvas, tkinter

有没有办法在 Tkinter 画布中跟踪元素属性？

具体来说，我想知道在某个坐标集中我是否已经创建了一个元素。

我相信我可以通过跟踪字典中的元素集来做到这一点，但我希望有更优雅的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:50:09.983

画布有许多查找对象的方法。例如，您可以调用`find_closest`以查找最接近您要检查的坐标的元素。然后，对于它找到的元素，您可以使用该`coords`方法找出元素的所有坐标是否相同。

# actionscript-3 - turn folder into a zip file

> ID：10585197
> 
> 赞同：1
> 
> 时间：2012-05-14T14:20:56.317
> 
> 标签：actionscript-3

I have a folder on my desktop and i want to convert it into a .zip file. It shouldnt ask me were to save it but just save it straight to my desktop or any folder i specified.

I tried ASZip, fZip etc. but i can't get it to work. There isn't any of them that seem to let me just add a folder and zip it. I was only able to create a byteArray wit ASZip but when i saved it, it left me with a file that was not able to be opened.

Would it be possible to achieve what i want without the use of an external library? Any help would be appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T01:37:14.300

You **can't** actually zip a folder but you can zip all the contents inside the folder. You would have to use FileReferenceList to load in flash all the files inside the folder.

FileReferenceList allows you to have multiple selection in the browse window.

Then you would have to pass all these files to the zip managing library and get a ByteArray from it.

This byte array you would localy dump inside a "yourFileName.zip" by using FileReference.save().

The application cannot save the file to a predetermined location. The user has to pick the location using the "save to" prompt.

# node.js - 带有 NodeJS 的路由器（代理）？

> ID：10585198
> 
> 赞同：1
> 
> 时间：2012-05-14T14:21:00.743
> 
> 标签：node.js, networking, router, lan, wifi

我想建立一个路由器来控制我的互联网访问（通过服务器的 wlan）。

只有少数网站（通过白/黑名单）应该在特定时间可用。

是否有任何用于路由/代理网络（http/s、ftp）和电子邮件（pop/imap/smtp）流量的好包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T13:57:27.340

你真正需要的是一个好的防火墙。任何体面的防火墙都应该能够按星期几和每天的时间过滤流量。甚至许多更好的 SOHO 路由器也可以做到这一点。如果您的路由器无法做到这一点，您应该使用备用 PC 或服务器作为网关，在其上运行 Linux 或 BSD 并相应地配置防火墙。大多数 Linux 版本都有 IPTABLES，这是一个简单但有效的防火墙，可以满足您的需求。

为方便起见，将 PC 设置为网络的 DHCP 服务器并对其进行配置，以便当其他 PC 获得 IP 地址时，将网关 IP 设置为相同的框（您可能可以获得普通路由器否则请关闭路由器上的 DHCP）。

理想情况下，如果使用网关 PC，请将路由器设置为仅接受来自该网关的流量 - 更好的是，关闭路由器上的 NAT，让网关也这样做。

[这是一个相当全面的“操作方法”](http://www.freesoftwaremagazine.com/articles/home_internet_gateway)。

如果所有这些看起来太多，您应该考虑将您的路由器升级到为您完成所有这些的路由器。我个人使用可能合适的Billion 7800N。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T20:06:46.273

如果您需要 HTTP 代理，请查看[node-http-proxy](http://www.github.com/nodejitsu/node-http-proxy)。不过，我对 FTP 和邮件代理了解不多。

# javascript - 使用 toDataURL 时，如何获取使用 drawImage 绘制的图像？

> ID：10585201
> 
> 赞同：0
> 
> 时间：2012-05-14T14:21:24.070
> 
> 标签：javascript, html, web, html5-canvas

我正在处理一个您可以在画布上绘制图像的页面。您有 6 个图像选项，完成后我希望人们能够保存他们的创作。

我`drawImage`用来在画布上绘制图像，但是当我使用以下代码时：

```
var canvas = document.getElementById("canvas");  
window.open(canvas.toDataURL("image/png")); 
```

它不会在图像上显示绘制的`DataUrl`图像。

如何确保在画布上绘制的图像在由给出的图像中也可见`toDataURL`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:12:07.473

您的页面和您正在绘制的图像的 URL 是什么？

如果您的图像与页面的来源不同，您将无法使用`toDataURL`或任何其他方法来读取画布的内容；这是一个有意的安全功能。检查您的 JavaScript 错误控制台，您可能会看到类似“DOM ERROR”或“SECURITY EXCEPTION”的内容。

**我是什么**意思？我的意思是，如果您的页面位于某个 URL（例如 , , ）`test.com`并且您正在绘制的图像位于具有不同来源的URL （与总是来自不同的来源），那么一旦您将图像绘制到它，浏览器就会将您的画布标记为不可读。`localhost:8080``file:///home/foo/``google.com``test.com``localhost:3000``localhost:8080``file:///`

**为什么**会这样？页面可以显示来自其他来源的图像，但许多其他形式的跨域访问被拒绝，除非明确授予`XMLHttpRequest`——例如。

`file`URL 也被区别对待，因为它们可能更容易被滥用。如果您为页面和图像使用本地文件，请改为使用简单的 Web 服务器来提供它们。

[本节中的第一个项目符号](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#security-with-canvas-elements)适用。

# c++ - Curlpp，请求中的数据不完整

> ID：10585205
> 
> 赞同：2
> 
> 时间：2012-05-14T14:21:30.353
> 
> 标签：c++, curl, curlpp

我正在使用 Curlpp 向各种 Web 服务发送请求以发送和接收数据。到目前为止，这工作得很好，因为我只用它来发送/接收 JSON 数据。

现在我遇到了一个 web 服务以二进制形式返回一个 zip 文件的情况。这是我遇到接收到的数据不完整的问题的地方。

我首先使用选项 WriteStream 将 Curl 设置为将任何数据写入 ostringstream，但事实证明这不是正确的方法，因为数据包含空字符，因此数据在第一个空字符处停止。

之后，我没有使用 WriteStream，而是使用带有回调函数的 WriteFunction。这种情况下的问题是这个函数总是被调用 2 或 3 次，而不管数据量如何。这导致总是有一些似乎不是文件第一部分的数据块，尽管数据总是包含 PK 作为前 2 个字符，表示一个 zip 文件。

我使用了几个工具来验证数据是否完全发送到我的应用程序，所以这不是 web 服务的问题。

这里是代码。请注意，主机名、端口、标头和后置字段等选项是在其他地方设置的。

```
string requestData;

size_t WriteStringCallback(char* ptr, size_t size, size_t nmemb)
{
    requestData += ptr;
    int totalSize= size*nmemb;
    return totalSize;
}

const string CurlRequest::Perform()
{
    curlpp::options::WriteFunction wf(WriteStringCallback);
    this->request.setOpt( wf );
    this->request.perform();

    return requestData;
} 
```

我希望任何人都可以帮助我解决这个问题，因为我已经没有关于如何解决这个问题的任何线索，也因为 curlpp 的文档记录很差（而且自从 curlpp 网站消失后更糟）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T23:39:09.687

代码的问题在于数据被放入 std::string，尽管数据是二进制 (ZIP) 格式。我建议将数据放入流（或二进制数组）中。您还可以注册一个回调来检索响应标头并根据`"Content-type"`.

`curlpp::options::HeaderFunction`注册回调以检索响应标头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-25T07:04:27.927

`std::string`不是问题，但串联是：

```
requestData += ptr; 
```

C 字符串 (ptr) 以零结尾，如果输入包含任何零字节，则输入将被截断。您应该将其包装成一个知道其数据长度的字符串：

```
requestData += std::string(ptr, size*nmemb); 
```

# highcharts - 双 x 轴与 Highcharts 在同一条线上。可能的？

> ID：10585206
> 
> 赞同：3
> 
> 时间：2012-05-14T14:21:31.790
> 
> 标签：highcharts

我们可以使用 Highcharts创建多个[这样的 x 轴图表吗？](https://www.adr.com/DRDetails/CorporateActions?cusip=055622104)如果是，有人可以提供一些指示吗？

显示三年数据。即2010、2011、2012

[https://www.adr.com/DRDetails/CorporateActions?cusip=055622104](https://www.adr.com/DRDetails/CorporateActions?cusip=055622104)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-10T16:12:24.853

使用 highstocks（highcharts 鲜为人知的兄弟），您可以执行您正在寻找的事情。看看这个[小提琴](http://jsfiddle.net/twaitsfan/edKRp/)

```
$(function() {
$.getJSON('http://www.highcharts.com/samples/data/jsonp.php?filename=aapl-ohlcv.json&callback=?', function(data) {

    // split the data set into ohlc and volume
    var ohlc = [],
        volume = [],
        dataLength = data.length;

    for (i = 0; i < dataLength; i++) {
        ohlc.push([
            data[i][0], // the date
            data[i][1], // open
            data[i][2], // high
            data[i][3], // low
            data[i][4] // close
        ]);

        volume.push([
            data[i][0], // the date
            data[i][5] // the volume
        ])
    }

    // set the allowed units for data grouping
    var groupingUnits = [[
        'week',                         // unit name
        [1]                             // allowed multiples
    ], [
        'month',
        [1, 2, 3, 4, 6]
    ]];

    // create the chart
    $('#container').highcharts('StockChart', {

        rangeSelector: {
            selected: 1
        },

        title: {
            text: 'AAPL Historical'
        },

        yAxis: [{
            title: {
                text: 'OHLC'
            },
            height: 200,
            lineWidth: 2
        }, {
            title: {
                text: 'Volume'
            },
            top: 300,
            height: 100,
            offset: 0,
            lineWidth: 2
        }],

        series: [{
            type: 'area',
            name: 'AAPL',
            data: ohlc,
            dataGrouping: {
                units: groupingUnits
            }
        }, {
            type: 'area',
            name: 'Volume',
            data: volume,
            yAxis: 1,
            dataGrouping: {
                units: groupingUnits
            }
        }]
    });
}); 
```

});

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-03T09:01:05.263

较旧的答案在 JSFiddle 中不适合我。这是一个工作示例，如果它对任何人有帮助：

[http://jsfiddle.net/kPqKW/](http://jsfiddle.net/kPqKW/)

```
$(function () {
    $('#container').highcharts({

        chart: {
            renderTo: 'container'
        },
        xAxis: [{
            type: 'datetime'
        }, {
            type: 'datetime',
            opposite: true
        }],

        series: [{
            data: [29.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4],
            pointStart: Date.UTC(2010, 0, 1),
            pointInterval: 24 * 3600 * 1000 // one day
        }, {
            data: [176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4, 29.9, 71.5, 106.4, 129.2, 144.0],
            pointStart: Date.UTC(2010, 0, 10),
            pointInterval: 24 * 3600 * 1000, // one day
            xAxis: 1
        }]

    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T04:13:18.370

这似乎是可能的，但观点不同。一根轴在顶部，另一根轴在底部。正如我们对 y 轴所做的那样，您已将其设置为**true 。**[在Highcharts 论坛](http://highslide.com/forum/viewtopic.php?f=9&t=10921)中查看这个问题

```
<div id="container" style="height: 400px; width: 500px"></div>

<script type="text/javascript">

var chart = new Highcharts.Chart({
    chart: {
        renderTo: 'container'
    },
    xAxis: [{
        type: 'datetime',
    },{
        type: 'datetime',
        opposite: true
    }],

    series: [{
        data: [29.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4],
        pointStart: Date.UTC(2010, 0, 1),
        pointInterval: 24 * 3600 * 1000 // one day
    },{
        data: [176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4, 29.9, 71.5, 106.4, 129.2, 144.0],
        pointStart: Date.UTC(2010, 0, 10),
        pointInterval: 24 * 3600 * 1000, // one day
        xAxis: 1
    }]
});

</script> 
```

对于工作示例，请查看此 [jsfilddle](http://jsfiddle.net/jalbertbowdenii/kSkYN/8029/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-11T09:33:11.393

您可以简单地使用 Highcharts 分组类别插件，看看：[https ://github.com/blacklabel/grouped_categories](https://github.com/blacklabel/grouped_categories)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-10T18:02:15.413

Complete code for making horizontal and vertical line in column,piechart highcharts

```
 <!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
 <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

</head>
<body>
<div id="container" class="col-md-4" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
<div class="col-md-8">
<div id="container2" class="col-md-6" style="min-width: 310px; height: 400px; margin: 0 auto" class="col-md-6"></div><div id="container3" class="col-md-6" style="min-width: 310px; height: 400px; margin: 0 auto" class="col-md-6" class="col-md-6">dddd</div>
</div>
<script>
Highcharts.chart('container', {
    chart: {
        type: 'column',

    },
    title: {
        text: 'sample charts for both horizontal and vertical line'
    },
    subtitle: {
        text: 'Source: WorldClimate.com'
    },
    xAxis: {
    gridLineWidth: 1,
        minPadding: 2,
        maxPadding: 2,
        maxZoom: 6 ,
        categories: ['Jan', 'Feb', 'Apr', 'May', 'Jun',
             'Dec']
    },
    yAxis: {

        title: {
            text: 'Temperature'
        },

        labels: {
            formatter: function () {
                return  '$'+this.value;
            }
        },

    },
    tooltip: {
        crosshairs: true,
        shared: true
    },
    plotOptions: {
        spline: {
            marker: {
                radius: 4,
                lineColor: '#666666',
                lineWidth: 1
            }
        }
    },
    series: [{
       // name: '',

        data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5]

    }]
});

Highcharts.chart('container2', {
    chart: {
        plotBackgroundColor: null,
        plotBorderWidth: null,
        plotShadow: false,
        type: 'pie'
    },
    title: {
        text: 'Browser market shares in January, 2018'
    },
    tooltip: {
        pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
    },
    plotOptions: {
        pie: {
            allowPointSelect: true,
            cursor: 'pointer',
            dataLabels: {
                enabled: true,
                format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                style: {
                    color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                }
            }
        }
    },
    series: [{
        name: 'Brands',
        colorByPoint: true,
        data: [{
            name: 'Chrome',
            y: 61.41,
            sliced: true,
            selected: true
        }, {
            name: 'Internet Explorer',
            y: 11.84
        }, {
            name: 'Firefox',
            y: 10.85
        }, {
            name: 'Edge',
            y: 4.67
        }, {
            name: 'Safari',
            y: 4.18
        }, {
            name: 'Sogou Explorer',
            y: 1.64
        }, {
            name: 'Opera',
            y: 1.6
        }, {
            name: 'QQ',
            y: 1.2
        }, {
            name: 'Other',
            y: 2.61
        }]
    }]
});

Highcharts.chart('container3', {
    chart: {
        plotBackgroundColor: null,
        plotBorderWidth: null,
        plotShadow: false,
        type: 'pie'
    },
    title: {
        text: 'Browser market shares in January, 2018'
    },
    tooltip: {
        pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
    },
    plotOptions: {
        pie: {
            allowPointSelect: true,
            cursor: 'pointer',
            dataLabels: {
                enabled: true,
                format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                style: {
                    color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                }
            }
        }
    },
    series: [{
        name: 'Brands',
        colorByPoint: true,
        data: [{
            name: 'Chrome',
            y: 61.41,
            sliced: true,
            selected: true
        }, {
            name: 'Internet Explorer',
            y: 11.84
        }, {
            name: 'Firefox',
            y: 10.85
        }, {
            name: 'Edge',
            y: 4.67
        }, {
            name: 'Safari',
            y: 4.18
        }, {
            name: 'Sogou Explorer',
            y: 1.64
        }, {
            name: 'Opera',
            y: 1.6
        }, {
            name: 'QQ',
            y: 1.2
        }, {
            name: 'Other',
            y: 2.61
        }]
    }]
});
</script>
</body>
</html> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-13T10:53:02.847

你可以通过这个小提琴[https://jsfiddle.net/ajaytripathi10/z8mrwhxz/](https://jsfiddle.net/ajaytripathi10/z8mrwhxz/)。希望这会有所帮助。

```
$(function () {
$('#container').highcharts({
    title: {
        text: 'Shared tooltip chart'
    },
    xAxis: [{
        type: 'datetime',
        id: 'x1'
    }, {
        type: 'datetime',
        id: 'x2',
        opposite: true
    }],
    yAxis: {
        min: 0
    },
    tooltip: {
        shared: true,
        useHTML: true,
        formatter: function () {
            var tooltip = '';
            var i, len;
            tooltip += '<small>Apple</small>';
            tooltip += '<table>';
            for (i = 0, len = 4; i < len; i++) {
                    if(this.points[i] != undefined){
            if(this.points[i].series.name.indexOf('Apple') >= 0){
                tooltip += '<tr>';
                tooltip += '<td style="color: ' + this.points[i].series.color + '">\u25CF</td>';
                tooltip += '<td>' + Highcharts.dateFormat('%Y-%m-%d', this.points[i].x) + ':</td>';
                tooltip += '<td style="text-align: right"><b>' + this.points[i].y + '</b></td>';
                tooltip += '</tr>';
                }
                }
            }
            tooltip += '</table>';
            tooltip += '<small>Mango</small>';
            tooltip += '<table>';
            for (i = 0, len = 4; i < len; i++) {
                    if(this.points[i] != undefined){
            if(this.points[i].series.name.indexOf('Mango') >= 0){
                tooltip += '<tr>';
                tooltip += '<td style="color: ' + this.points[i].series.color + '">\u25CF</td>';
                tooltip += '<td>' + Highcharts.dateFormat('%Y-%m-%d', this.points[i].x) + ':</td>';
                tooltip += '<td style="text-align: right"><b>' + this.points[i].y + '</b></td>';
                tooltip += '</tr>';
                }
                }
            }
            tooltip += '</table>';
            return tooltip;
        }
    },
    series: [{
        name: 'Apple',
        id: 'series1',
        xAxis: 'x1',
        color: 'rgba(255, 0, 0, 1.0)',
        data: [5, 3, 4, 7, 6, 1, 0],
        pointInterval: 1000 * 60 * 60 * 24,
        pointStart: Date.UTC(2015, 2, 10)
    }, {
        name: 'Apple New',
        id: 'series2',
        //linkedTo: 'series1',
        xAxis: 'x2',
        color: 'rgba(255, 180, 180, 1.0)',
        data: [4, 5, 5, 6, 1, 3, 4],
        pointInterval: 1000 * 60 * 60 * 24,
        pointStart: Date.UTC(2015, 2, 17)
    },{
        name: 'Mango',
        id: 'series3',
        xAxis: 'x1',
        color: 'rgba(255, 0, 0, 1.0)',
        data: [15, 13, 14, 17, 16, 11, 10],
        pointInterval: 1000 * 60 * 60 * 24,
        pointStart: Date.UTC(2015, 2, 10)
    }, {
        name: 'Mango New',
        id: 'series4',
        //linkedTo: 'series1',
        xAxis: 'x2',
        color: 'rgba(255, 180, 180, 1.0)',
        data: [14, 15, 15, 16, 11, 13, 14],
        pointInterval: 1000 * 60 * 60 * 24,
        pointStart: Date.UTC(2015, 2, 17)
    }]
}); 
```

});

# gcc - 具有硬件浮点支持的 GNU ARM 工具链

> ID：10585208
> 
> 赞同：2
> 
> 时间：2012-05-14T14:21:33.273
> 
> 标签：gcc, arm, gnu, toolchain, fpu

我已经开始研究 STM32F4 Discovery 板，并使用包含 GCC 4.6.2 的最新 Yagarto 工具链编译并运行了一些基本程序。最近，虽然在几个论坛上，我读到包括最新的 Yagarto 在内的许多工具链在使用板载硬件 FPU 时都存在问题。我还读到最新的 CodeSourcery 工具链确实支持硬件浮点，但在精简版中不支持！！

在深入研究该主题时，我发现了这个专门用于 ARM Cortex M/R 控制器的工具链，并声称在硬件 FPU 方面没有问题。

[https://launchpad.net/gcc-arm-embedded](https://launchpad.net/gcc-arm-embedded)

我想从用户的经验中知道，Yagarto是否真的存在硬件FPU问题？我对使用 Yagarto 很感兴趣，因为我也在 ARM7 上工作，并且 yagarto 也支持它。因此，与其为不同的架构使用不同的工具链，不如为 ARM7 和 Cortex M/R 提供一个工具链。

如果确实存在 FPU 问题，那么任何人都可以建议我为 ARM7 和 Cortex M/R 提供一个经过验证的良好工具链吗？

PS：我为 BeagleBoard (Cortex A-8) 使用 CodeSourcery 最新的 GNU Linux 工具链，还没有遇到任何问题。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-15T07:29:36.833

我刚刚写了一篇关于在 Linux/Ubuntu 上使用 ARM 的免费 G​​CC 工具链（用于 ARM 嵌入式处理器的 GNU 工具）和 STLINK 为 STM32F4 探索板（F4 是 Cortex M4）编写/编程/调试代码的文章——这可能会对您有所帮助，编译器确实有硬件浮点支持，我在我的例子中使用它......

[http://www.wolinlabs.com/blog/linux.stm32.discovery.gcc.html](http://www.wolinlabs.com/blog/linux.stm32.discovery.gcc.html)

# wsdl - 用于在语法上比较 WSDL 元素的 Java 库

> ID：10585209
> 
> 赞同：2
> 
> 时间：2012-05-14T14:21:34.970
> 
> 标签：wsdl, java

我有 WSDL 文件，并且想在语法上比较和匹配这些文件中的 WSDL 元素。对于可用于查找 Web 中两个术语之间的语法相似性的 Java 库（对我来说，wsdl 元素），您有什么建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-29T07:38:57.667

还有基于最新版本的[Membrane SOA Model构建的](https://github.com/membrane/soa-model)[WSDL Analyzer](http://wsdl-analyzer.com/)。它是一个 Web 应用程序，它不仅允许您根据最佳实践验证和检查 WSDL，还允许您比较不同版本的 WSDL。

免责声明：我是它的开发人员之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:57:42.343

好吧，您可以使用 SOAPUI 来加载 wsdl 定义并进行比较。

包括与您的问题相关的一些文档的链接。希望能有所帮助。

[http://www.soapui.org/SOAP-and-WSDL/working-with-wsdls.html](http://www.soapui.org/SOAP-and-WSDL/working-with-wsdls.html)

编辑：另外，请查看[http://www.membrane-soa.org](http://www.membrane-soa.org)，它是一些用于比较 wsdl 文件的库。一些具体的例子在这里：[http ://www.membrane-soa.org/compare-wsdl-java-api.htm](http://www.membrane-soa.org/compare-wsdl-java-api.htm)

# node.js - 为什么每个人都使用 Node.js 和 NPM 来编译 JavaScript 库？

> ID：10585211
> 
> 赞同：8
> 
> 时间：2012-05-14T14:21:37.767
> 
> 标签：node.js, javascript, npm

我真的对 JS 社区中使用 Node.js 和 NPM 以及他们的 JS 库的每个人感到困惑。为什么我们必须采取如此极端的措施？这为我们解决了哪些问题？

[编辑] 我认为我的问题不是重点。

1.  Ember.js、Batman.js 和最近的 Yahoo 的 Mojito 等框架要求我使用 node.js——为什么要依赖 Node.js 和 NPM？
2.  为什么我们要让事情变得复杂？“如果你还没有，你需要安装 node.js...” 你读到这样的消息然后你就被关闭了。

为什么？JS 中已经存在一个问题 - 有太多活动的 JS 库/框架可供选择 - 根据 JS 库的记录，大多数将很快变得不活动。有太多东西要寻找，这通常会导致应用程序中出现多个框架 - 依赖管理、路由器、MVC、模板等。除此之外，我们正在使用 Node.js 来使用这些库/框架......如何这会将这些库的使用推给新的 JS 开发人员吗？JS 本来就是为了简单！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-14T14:23:28.667

> “如果你还没有，你需要安装 node.js...” 你读到这样的消息然后你就被关闭了。为什么？

NodeJS 是 Google 的 V8“独立运行”。它是一个带有附加低级 API（网络、I/O 等）的 JS 引擎。NodeJS 为仅限于在浏览器上工作的 JS 开发人员提供了“缺失的平台”。

> 为什么要依赖 Node.js 和 NPM？

Node.js 除了将其用作应用程序（服务器、代理、机器人等）外，它还可以用作构建工具和辅助开发。以 Grunt 为例，它是一个类似于 Make 的可编写脚本的自动化工具。只用普通的 JS 编写脚本，你不需要学习另一种工具或语言来进行自动化。另一个工具是 Bower，它是一个前端包管理工具。您需要做的就是一个`bower install jquery`，它使用该单个命令安装 jquery。无需手动下载、复制和粘贴。

另一方面，NPM 是 Node.js 的包管理器。它是一个管理您在 NodeJS 上使用的模块的程序。无需手动列出您的模块，也无需在其他地方开发时记住它们。只要你有 NPM 为你制作的包列表，重新安装只是`npm install`.

> 为什么我们要让事情变得复杂？

不是。事实上，我们正在为开发人员简化它们。无需担心工作流程、管理库或手动操作，您可以将这些任务卸载到 NPM 上的某些模块上。然后你就可以专注于你实际在做的事情。

> 最重要的是，我们使用 Node.js 来使用这些库/框架......这将如何将这些库的使用推给新的 JS 开发人员？JS 本来就是为了简单！

如上所述，NodeJS 是一个多功能平台。它可以用作服务器（Connect、Express）、自动化工具（Grunt）、包管理系统（使用 NPM、Bower 等）、测试平台（QUnit、Mocha）、代理、游戏服务器、聊天机器人.

而且它是有益的，尤其是对 JS 开发人员，因为这些在 JS 中是不可能的。

> JS 中已经存在一个问题 - 有太多活动的 JS 库/框架可供选择 - 根据 JS 库的记录，大多数将很快变得不活动。有太多东西需要寻找，这通常会导致应用程序中出现多个框架——依赖管理、路由器、MVC、模板等。

好吧，拥有丰富的框架集是件好事。在学习了其中一些之后，您的工作将减少一半。实现的多样性也很好，可以解决不同的编码风格和不同的实现方法。一些库源于不同的方法，而另一些则源于其他库的不兼容和/或不完整。

开发人员正在努力通过规范化 JS 怪癖来让其他开发人员的生活更轻松（因为浏览器供应商似乎无法做正确的事情来遵循标准）并且大多数都是自愿完成的，就像免费啤酒一样 - 你应该为此感到高兴。此外，没有人会强迫你使用一个。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T16:27:19.353

CommonJS 标准（在我看来，最好由 Node.js 和 NPM 实现）将*模块*的概念引入Javascript。多年来，Perl 和 Python 社区已经证明了为什么模块很棒：

*   **Unix 风格的“做一件事并做好”库**，这些库很小并且针对错误进行了大量测试，可以轻松组合（没有命名空间问题）以解决您的特定任务。
*   **开源模块**（CPAN、NPM 等）的中央存储库，您可以轻松从中提取模块（NPM 通过保持所有版本可用将其提升了一级，因此您可以指定您的代码使用最后一个已知的“好”版本，而不是希望重新部署 la CPAN 时没有任何问题）。
*   **对代码进行更多的同行评审**（因为它们更容易组合，它们用于更多不同的情况，所以这有助于减少错误，也有助于改进模块以使其更通用）。
*   **解决了更多种类的任务。**由于库很短，几乎任何人都可以编写一个。这确实意味着有更多的垃圾需要过滤（有关广泛使用的库的文章对此有所帮助），但这也意味着可能还存在一个解决一些非常具体的问题（例如[本地化字符串和日期](https://github.com/AGROSICA/node-localize)）的库。

然后一个名为[browserify](https://github.com/substack/node-browserify)的 Node 模块使您的客户端代码的实际构建过程变得异常简单，您几乎可以使用在 NPM 上找到的任何代码。

这打破了像 jQuery 这样的库的“厨房水槽”心态（他们开发了自己的自定义构建系统，因此他们也可以开始模块化他们的代码）认为他们需要解决用户可能遇到的每一个问题，而不仅仅是生成其他库可以使用的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T14:24:45.780

很多时候，您需要不同版本的 javascript。通常它分布在不同的文件中，有时它在咖啡脚本中。您经常需要一个构建 AMD 兼容构建，以及 CommonJS 一个，以及常规的最小化和非最小化构建。

还有可能解决依赖关系。

我什至见过一个为 jQuery 和原型构建的库......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T14:24:54.600

编辑：注意到我正在按照问题正文中的措辞回答问题，但错过了标题中的编译问题。

您认为这是“极端措施”的标准是什么？这已经做了很多年了，为了编写干净、易于读/写的代码，但预编译为在线传输进行优化（也许还有其他优化）。Node.js 对此提供了一个很好的解决方案，仅仅是因为它也使用 JavaScript，因此使用它来编译 JavaScript 代码的人们很熟悉。以前，这通常是用 Python 之类的东西完成的，虽然它可以工作，但对我来说似乎比坚持使用通用语言更不明智。

# google-maps - 如何在谷歌地图信息框中生成弹出窗口？

> ID：10585212
> 
> 赞同：0
> 
> 时间：2012-05-14T14:21:41.387
> 
> 标签：google-maps, popup

我的网络应用程序中有我的谷歌地图的这个信息框，我想在点击信息框上的链接时生成一个弹出框。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:37:28.910

信息窗口可以包含 HTML。只需在您的信息窗口内容中编写链接，但您通常会使用 HTML 和/或 javascript 弹出一个窗口。

```
<a href="page2.html" onclick="window.open('page2.html'); return false;" target="_blank">open popup</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T07:31:10.053

通常弹出框用于 HTML/JavaScript。请参阅弹出框和测试浏览器兼容的完整代码。

```
<style>
.poppup_overlay{
    display: none;
    position:fixed;
    top: 0%;
    left: 0%;
    width: 100%;
    height: 100%;
    background-color: #000;
    z-index:10001;
    -moz-opacity: 0.7;
    opacity:.70;
    filter: alpha(opacity=70);
}

.poppup_content {
    display: none;
    position: absolute;
    padding:5px;
    border: 0px solid orange;
    background-color: white;
    z-index:10002;
    overflow: auto;
    width:300px;
    left:44%;
    margin-top: -250px;
    margin-left: -250px;
    top: 40%;
}

.poppup-image {
    display: none;
    position: absolute;
    padding:5px;
    border: 0px solid orange;
    background-color: white;
    z-index:10002;
    overflow: auto;
    width:300px;
    left:50%;
    margin-top: -250px;
    margin-left: -180px;
    top: 40%;
}

</style>

<body>

<!------popup google map---------> 
<a class="" href = "javascript:void(0)" onclick = "document.getElementById('light').style.display='block';document.getElementById('fade').style.display='block';document.getElementById('mapframe').src='embed URL here';">TEXT</a>
<div id="light" class="poppup_content"> <a href = "javascript:void(0)" onclick = "document.getElementById('light').style.display='none';document.getElementById('fade').style.display='none'"><img src="images/close.gif" border="0" align="right" /> </a><br />
  <br />
  <iframe id="mapframe" width="300" height="300" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" ></iframe>
  <br />
  <small><a href="embed URL here" style="color:#0000FF;text-align:left">TEXT</a></small></div>
<div id="fade" class="poppup_overlay">&nbsp;</div>

<!------popup image---------> 
<a class="" href = "javascript:void(0)" onclick = "document.getElementById('light1').style.display='block';document.getElementById('fade').style.display='block';document.getElementById('layout').src='images here';">Site Layout</a>
<div id="light1" class="poppup-image"> <a href = "javascript:void(0)" onclick = "document.getElementById('light1').style.display='none';document.getElementById('fade').style.display='none'"><img src="images/close.gif" border="0" align="right" /> </a><br />
  <br />
  <img src="images here" align="right" /> </div>
<div id="fade" class="poppup_overlay">&nbsp;</div>

</body> 
```

# c# - 将日期时间 2 数据类型转换为日期时间数据类型错误首先使用 EF 代码？

> ID：10585214
> 
> 赞同：16
> 
> 时间：2012-05-14T14:21:46.227
> 
> 标签：c#, sql-server-2008, entity-framework, ef-code-first, entity-framework-4.3

我首先在我的 asp.net mvc 应用程序中使用 EF 代码。这是我的代码：

```
Request.RequestDate = DateTime.Now; 
```

RequestDate 的类型是我数据库中的日期时间。这是我使用上述代码时发生的错误！：

> 将 datetime2 数据类型转换为 datetime 数据类型导致值超出范围。

请帮我。谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-14T14:24:37.870

编辑：

[如何使用 DbContext 和 SetInitializer 修复 datetime2 超出范围的转换错误？](https://stackoverflow.com/questions/6050906/how-to-fix-the-datetime2-out-of-range-conversion-error-using-dbcontext-and-setin)

问题是您正在尝试保存一个不适合 SQL 日期时间列的值。这里给出的答案将阻止转换失败。

或在您的数据库中将列更改为 datetime2 类型。我不完全知道为什么他们首先编写代码是生成 datetime 列而不是 datetime2

这是一个在 SQL 中将 Datetime 列显式映射到 datetime2 的示例

[在 Code-First Entity Framework 和 SQL Server 中使用 DateTime 属性](https://stackoverflow.com/questions/8043816/using-datetime-properties-in-code-first-entity-framework-and-sql-server/8044310#8044310)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-04-01T08:51:32.160

在我这边，这是因为日期时间不可为空，并且在某些情况下，该字段未在构造函数中初始化。我通过将我的字段设置为可为空来解决这个问题

```
public DateTime? MyDate { get; set; } 
```

另一种解决方案是无论如何初始化构造函数中的字段。

# java - 如何将带有 JSTL 标签的 javascript 放在单独的文件中？

> ID：10585215
> 
> 赞同：1
> 
> 时间：2012-05-14T14:21:46.673
> 
> 标签：java, javascript, jstl

我在它的标题中有带有 javascript 的 JSP。脚本需要国际化，所以我使用`<fmt:message>`标签。我需要将脚本放在一个单独的文件中，因为它看起来很糟糕。这里是：

```
 <script type="text/javascript">
        function check(obj) {
            if (confirm("<fmt:message key="body.onsubmit.delete"/>")) {
                for( i=0; i<obj.elements.length; i++)
                    if(obj.elements[i].type=="checkbox"&&obj.elements[i].checked){
                    return true;
                }
            alert("<fmt:message key="body.alert.delete"/>");
            return false;
            }
        return false;
        }
    </script> 
```

顺便说一句，它正在检查复选框并根据它的执行提供两种类型的消息，并且效果很好。但正如我所说，主要问题是将它放在单独的文件中。那么，我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:26:39.590

我强烈建议您不要这样做。使用 JSP 将字符串和其他数据放到页面上，然后让您的纯 JavaScript 提取并使用它。

为此，您可以在元素（如`<body>`元素）上使用“data-”属性，或`<script>`使用非 JavaScript “type”属性的块，或其他任何东西。

# qt - QT：UIC 命令行工具和 -tr 参数

> ID：10585217
> 
> 赞同：0
> 
> 时间：2012-05-14T14:22:14.957
> 
> 标签：qt

保存 *.ui 文件时，它们会生成一个 *.h 文件，该文件定义并实现了一个翻译方法“retranslateui()”，该方法使用 QApplication::translate 调用，其中翻译的上下文等于 UI 类名。

我需要能够覆盖它并输入我自己的自定义上下文名称。

如果您必须知道，原因是我们有一个非 QT 遗留翻译表，有 14 种语言。我构建了一个将这些字符串转换为 *.TS 文件的工具。问题是，没有上下文，它只是一个简单的字符串列表，所以我的工具为我的整个应用程序强制一个上下文。在上下文 = UI 类名的情况下，自动生成翻译方法调用使我的 ui 翻译失败。

我发现 UIC 命令行实用程序，从 *.ui 文件创建这个 *.h 文件有一个参数来定义不同的翻译方法。我可以使用它来路由到我自己的翻译方法，该方法将添加到单个上下文中。我的问题是我不知道如何从 qmake 更改 UIC 调用以包含此参数和自定义值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T09:56:05.783

您可以在 .pro 文件中修改 QMAKE_UIC 属性

```
QMAKE_UIC += -params to add 
```

# php - MySQL 提交和事务

> ID：10585218
> 
> 赞同：10
> 
> 时间：2012-05-14T14:22:22.123
> 
> 标签：php, mysql, transactions, commit

我有一个关于 MySQL 提交和事务的问题。我有几个执行 MySQL 查询的 PHP 语句。我只是说以下吗？

```
mysql_query("START TRANSACTION");
//more queries here
mysql_query("COMMIT"); 
```

这究竟会做什么？它有什么帮助？对于更新、删除和插入，我还发现这会阻止其他查询读取：

```
mysql_query("LOCK TABLES t1 WRITE, t2 WRITE");
//more queries here
mysql_query("UNLOCK TABLES t1, t2"); 
```

这会阻止其他任何性质的查询还是仅写入/选择？

另一个问题：假设一个查询正在运行并阻止其他查询。另一个查询尝试访问被阻止的数据 - 它发现它被阻止了。它是如何进行的？是否等到数据再次解除阻塞并重新执行查询？它只是失败并需要重复吗？如果是这样，我该如何检查？

非常感谢！

丹尼斯

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-14T17:50:59.323

在 InnoDB 中，如果您没有更改 autocommit 的默认设置（即“on”），则无需显式启动或结束单个查询的事务。如果启用自动提交，InnoDB 会自动将每个 SQL 查询包含在事务中，这相当于`START TRANSACTION; query; COMMIT;`.

如果你`START TRANSACTION`在 InnoDB 中显式使用 autocommit ，那么在`START TRANSACTION`语句之后执行的任何查询要么全部执行，要么全部失败。这在银行环境中很有用，例如：如果我将 500 美元转入您的银行账户，那么只有从我的银行余额中减去该金额并添加到您的银行账户中，该操作才会成功。所以在这种情况下，你会运行类似

```
START TRANSACTION;
UPDATE customers SET balance = balance - 500 WHERE customer = 'Daan';
UPDATE customers SET balance = balance + 500 WHERE customer = 'Dennis';
COMMIT; 
```

这确保了两个查询都将成功运行，或者没有一个，但不仅仅是一个。 [这篇文章](http://www.sitepoint.com/mysql-transactions-php-emulation/)有更多关于何时应该使用事务的信息。

在 InnoDB 中，您很少需要锁定整个表；与 MyISAM 不同，InnoDB 支持行级锁定。这意味着客户端不必锁定整个表，从而迫使其他客户端等待。客户端应该只锁定他们实际需要的行，允许其他客户端继续访问他们需要的行。

[您可以在此处](http://dev.mysql.com/doc/refman/5.0/en/innodb-transaction-model.html)阅读有关 InnoDB 事务的更多信息。您关于死锁的问题在文档的第[14.2.8.8](http://dev.mysql.com/doc/refman/5.0/en/innodb-deadlock-detection.html)和[14.2.8.9](http://dev.mysql.com/doc/refman/5.0/en/innodb-deadlocks.html)节中得到解答。如果查询失败，您的 MySQL 驱动程序将返回一条错误消息，指出原因；如果需要，您的应用应重新发出查询。

最后，在您的示例代码中，您使用了`mysql_query`. 如果您正在编写新代码，请停止使用旧的、缓慢且已弃用`mysql_`的 PHP 库，而改用`mysqli_`或 PDO :)

# ios - 在 xcode 中分析分配的新手

> ID：10585219
> 
> 赞同：0
> 
> 时间：2012-05-14T14:22:29.293
> 
> 标签：ios, xcode, memory-management, profiling, instruments

我正在对我的项目中的分配进行截图。我在 50 秒时模拟了一个内存警告，但分配永远不会减少。也许我没有正确理解这一点？

![个人资料截图](../Images/61178f04c0f95df0812b4760d1a6d5d2.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:28:47.950

我认为该图显示的是整体字节数，即应用程序在运行期间消耗的所有内存

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T02:53:37.480

事实证明，我的大对象（UIViews / Controllers）都没有被释放。潜入水中后，我看到了一些像我应该的那样上下波动。

# linux - 关于GCC链接器搜索顺序的一些问题

> ID：10585225
> 
> 赞同：5
> 
> 时间：2012-05-14T14:22:41.807
> 
> 标签：linux, gcc, linker, shared-libraries, static-libraries

我对 gcc 链接顺序有一些疑问。GCC man 说链接器从左到右搜索符号，默认情况下不重复搜索。这是我的测试：

主程序

```
#include <stdio.h>
#include <stdlib.h>

int main()
{
        printf("HELLO WROLD\n");
        return 0;
} 
```

打印文件

```
#include <stdio.h>
#include <stdlib.h>

int printf(const char *fmt, ...)
{
        write(1, "AAA\n", 4);
}

[root@lenovo testcode]# gcc -c -fno-builtin-printf *.c
[root@lenovo testcode]# gcc -o test main.o printf.o
[root@lenovo testcode]# ./test 
AAA
[root@lenovo testcode]# gcc -o test printf.o main.o
[root@lenovo testcode]# ./test
AAA

[root@lenovo testcode]# ar rcs libprintf.a printf.o
[root@lenovo testcode]# gcc -o test libprintf.a main.o
[root@lenovo testcode]# ./test 
HELLO WROLD
[root@lenovo testcode]# gcc -o test main.o libprintf.a 
[root@lenovo testcode]# ./test 
AAA

[root@lenovo testcode]# gcc -shared -o libprintf.so printf.o 
[root@lenovo testcode]# gcc -o test libprintf.so  main.o 
[root@lenovo testcode]# export LD_LIBRARY_PATH=.
[root@lenovo testcode]# ./test 
AAA
[root@lenovo testcode]# gcc -o test main.o libprintf.so 
[root@lenovo testcode]# ./test 
AAA 
```

从结果可以看出.o和.o的顺序，.o和.so没有区别，只有.o和.a的顺序有效果。但这与 gcc 手册页不一致。所以为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T16:27:11.797

gcc 确实从左到右处理目标文件。当你有

```
gcc -o test libprintf.a main.o 
```

gcc 看到的第一个目标文件是`libprintf.a`. 此时输出对象没有未解析的符号，因此不`libprintf.a`使用/不需要任何内容​​。接下来，`main.o`被处理，链接器记下未解析的事实，`printf`然后继续处理能够解析`printf`未解析符号的隐式库`in main.o`。

同样，当您有：

```
gcc -o test main.o libprintf.a 
```

第一个要处理的目标文件是`main.o`，其中未解析的符号`printf`被注明，下一个要处理的目标文件是`libprintf.a`链接器能够从中解析的`printf`。当`libc`最终被处理时，`printf`已经被解析，因此不使用`printf`in的实例。`libc`

与 .o 文件链接时：

```
gcc -o test main.o printf.o 
```

该`libc`库再次被视为在命令行末尾指定，因此该`printf`符号是从定义它的第一个（从左到右）目标文件中解析的。

对于这两种`libprintf.so`情况，`libc`库再次被视为在命令行末尾指定。与静态库情况不同的是，库的从左到右的顺序`*.so`决定了运行时动态符号搜索的顺序。由于这个命令`libprintf.so`在隐式之前有，所以使用了in`libc.so`的版本。`printf``libprintf.so`

```
gcc -o test libprintf.so  main.o
gcc -o test main.o libprintf.so 
```

作为附加实验，您可以尝试：

```
gcc -o test main.o -lc libprintf.so 
```

这应该显示使用的版本，`printf`而`libc.so`不是`libprintf.so`因为从左到右的顺序`-lc`出现在前面。`libprintf.so`

# visual-studio-2010 - 如何在 Visual Basic 2010 中使用 sqllite db？

> ID：10585227
> 
> 赞同：1
> 
> 时间：2012-05-14T14:22:46.637
> 
> 标签：visual-studio-2010, sqlite, database-connection, visual-studio-express

我在网上找到[了这个](http://www.tsjensen.com/blog/post/2011/06/04/SQLite+On+Visual+Studio+2010+Setup+Instructions.aspx)tut：

我遵循了这些步骤，但是当我尝试在 Visual Basic 中添加数据库时，我得到了这个：

![在此处输入图像描述](../Images/0d83676a6c4457aa88fe717ec85e0f8d.png)

当我点击确定时，我得到了这个：

![在此处输入图像描述](../Images/5b1cfe3636f75d8960bd7c53f88a6854.png)

谁能告诉我我做错了什么？我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:50:02.683

**如果您使用的是 VS express 版本：**

[http://system.data.sqlite.org/index.html/doc/trunk/www/faq.wiki](http://system.data.sqlite.org/index.html/doc/trunk/www/faq.wiki)

> 由于许可限制，Express 版本不再支持设计时组件。

检查这个论坛主题：[使用 SQLite 和 Visual Basic 2010 Express](http://sqlite.phxsoftware.com/forums/p/2709/10231.aspx)

**除此以外：**

您需要安装[ADO.NET 2.0 Provider for SQLite](http://sourceforge.net/projects/sqlite-dotnet2/?source=directory)并在安装 System.Data.SQLite 时选中“安装设计器组件选项”

![SQL 精简版](../Images/ac566b81007c8a4a21a448fa521c2b4e.png)

您在上面安装的那些，当您添加数据源时选择“System.Data.SQLite 数据库文件（SQLite 的 .NET Framework 数据提供程序）”

![添加连接](../Images/5444372c4eaa8e42095e80c078254366.png)

单击新按钮和您完成的按钮。使用“测试连接”按钮检查连接。

# codeigniter - Codeigniter 组织控制器结构

> ID：10585230
> 
> 赞同：-1
> 
> 时间：2012-05-14T14:22:56.547
> 
> 标签：codeigniter, codeigniter-routing

让我们以一个小型社交网站为例。模块之一也是测验。测验模块具有以下部分：

```
-Create quize
-Edit quize
-Quize view
-Browse quizes
-Send quize to friend 
```

我想知道在这种情况下最好的方法是什么。一种选择是为每个模块部分创建另一个控制器。

```
controllers/create_quize.php
controllers/edit_quize.php
controllers/quize_view.php
controllers/browse_quizes.php
controllers/send_quize.php 
```

另一种方法是为具有许多功能的整个模块创建单个控制器。没有一个选项是好的。在第一种方式中，这可能意味着我的控制器文件夹中有 30 多个控制器（请记住，测验只是众多模块中的一个）。第二个选项不行，因为单个文件将具有许多功能，并且不容易扫描给开发人员。

我也在考虑创建许多控制器，但将它们组织到子文件夹中。无论如何，condeigniter 没有修改就没有这个选项。

天呐！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T18:38:02.997

您的测验只需要一个控制器。您的`quiz`控制器可能如下所示：

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Quiz extends CI_Controller {

    function __construct()
    {
        parent::__construct();
    }

    function index()
    {
        // Index page. List all quizzes here, perhaps as an replacement to /browse
        // /quiz/
    }

    function create()
    {
        // Create a new quiz
        // /quiz/create
    }

    function edit($quiz_id)
    {
        // Edit quiz with $quiz_id
        // /quiz/edit/1
    }

    function browse()
    {
        // Index page. List all quizzes here, perhaps
        // /quiz/browse
    }

    function send($quiz_id)
    {
        // Send/share page
        // /quiz/send/1
    }

} 
```

CodeIgniter 是一个模型-视图-控制器框架。您可能想查看它的结构：[http ://codeigniter.com/user_guide/](http://codeigniter.com/user_guide/)

# php - 如何计算从该日期时间戳开始经过的时间，并在适当的情况下以分钟、小时或天数返回

> ID：10585237
> 
> 赞同：0
> 
> 时间：2012-05-14T14:23:17.530
> 
> 标签：php

我正在处理一个返回日期时间戳的api，如下所示：

```
Mon, 14 May 2012 14:14:11 +0000 
```

我想处理这个，所以 php 计算出几分钟前，如果分钟数小于 60 分钟，否则如果小时数小于 24 小时，则为多少小时前，否则天数。

日期永远不会超过几周。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:32:39.430

你想使用这个`DateTime`类。它可以解析那个日期。

```
$now = new DateTime('now');
$dt = new DateTime('Mon, 14 May 2012 14:14:11 +0000');
$interval = $now->diff($dt);

$minutes = $interval->format('%i'); 
```

请注意，“现在”将位于您当前的时区，因此您可能还想传递`DateTimeZone`参数。更多信息在这里： http: [//php.net/DateTime](http://php.net/DateTime)

该类应该已经内置到您的 PHP 中。你不需要包括它。

# asp.net - 此页面的状态信息无效并且可能已损坏（仅限 IE）

> ID：10585242
> 
> 赞同：1
> 
> 时间：2012-05-14T14:23:59.713
> 
> 标签：asp.net, internet-explorer, c#-4.0, jquery, viewstate

我已经看到所有其他页面都有这个问题，但没有多少研究解决了我的问题。我收到“此页面的状态信息无效并且可能已损坏”错误。我的页面第一次加载很好。该页面包含一个 div，该 div 具有更改页面信息的选项卡，并且这些选项卡是动态加载的并链接到不同的页面。制表使用 jquery。在不更改页面上的任何内容的情况下，当我尝试通过单击到达此页面的链接甚至单击菜单栏中的任何链接到其他页面来重新加载此页面时，我会出现此错误。同样，这只发生在 IE 中，我已经在我的代码中放置了断点，它永远不会回到服务器。

```
<%@ Page Language="C#" MasterPageFile="~/Templates/Main.Master" AutoEventWireup="true" 
    CodeBehind="Reporting.aspx.cs" Inherits="Pegged.Reporting" Title="Workforce Planning Report" %>

<%@ Register Src="Controls/ucWebPageNavigation.ascx" TagName="ucWebPageNavigation"
    TagPrefix="uc1" %>
<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
<script type="text/javascript">
    $(function () {
        $("#tabs").tabs({
            ajaxOptions: {
                error: function (xhr, status, index, anchor) {
                    $(anchor.hash).html(
                        "Couldn't load this tab. We'll try to fix this as soon as possible.");
                }
            }
        });
    });
    </script>
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
    <div id="IconLinks" class="TopLinks">
        <uc1:ucWebPageNavigation ID="ucWebPageNavigation1" runat="server" />
    </div>
    <div id="divContainerReport" class="container_12">
        <!--Facility Tabs-->
        <div id="tabs">
        <ul id="FacilityTabs" runat="server" ></ul></div>
        </div>

</asp:Content> 
```

这是在页面加载时加载选项卡的代码：

```
ServicesDLL.Services ps = new ServicesDLL.Services();
string encryptString = "";
string encryptString2 = "";

encryptString = ps.EncryptQueryString("Test");
encryptString2 = ps.EncryptQueryString("Testing");
string innerhtml = "<li><a id=\"id1\" href=\"ReportFacility.aspx?facility=" + encryptString + "\">Test</a></li><li><a id=\"id2\" href=\"ReportFacility.aspx?facility=" + encryptString2 + "\">Testing</a></li>";
FacilityTabs.InnerHtml = innerhtml; 
```

这是标签加载的页面：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Templates/Popup.Master" AutoEventWireup="true" CodeBehind="ReportFacility.aspx.cs" Inherits="Pegged.ReportFacility" %>

<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">

</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
    <div id="divReportView" class="grid_8 BlueBorder">
<p id="testText" runat="server"></p>
</div>
</asp:Content> 
```

# python - 名称“订单”未定义

> ID：10585248
> 
> 赞同：-1
> 
> 时间：2012-05-14T14:24:09.330
> 
> 标签：python, django, scope, satchmo

我有这个错误

```
Name 'Order' is not defined 
```

在以下条款中：

```
 try:
                order = Order.objects.from_request(request)
                cart = OrderCart(order)
            except Order.DoesNotExist:
                pass 
```

`Order`在同一个文件中完全定义并且是`model.Model`

更具体地说，这是我正在使用的文件： [https](https://bitbucket.org/chris1610/satchmo/src/a04c87a539f3/satchmo/apps/satchmo_store/shop/models.py) : //bitbucket.org/chris1610/satchmo/src/a04c87a539f3/satchmo/apps/satchmo_store/shop/models.py，第242行出现异常

为什么会这样？

更新：

这是回溯：

```
Traceback:
File "/home/evgeniuz/.virtualenvs/port/lib/python2.7/site-packages/django/core/handlers/base.py" in get_response
  100\.                     response = callback(request, *callback_args, **callback_kwargs)
File "/home/evgeniuz/src/chillifish-pg/lib/payment/views/balance.py" in balance_remaining_order
  30\.         template='shop/checkout/balance_remaining.html')
File "/home/evgeniuz/src/chillifish-pg/pg/pgstore/utils.py" in _view
  38\.             return view_func(request, *args, **kwargs)
File "/home/evgeniuz/src/chillifish-pg/lib/payment/views/balance.py" in balance_remaining
  66\.         'paymentmethod_ct': len(config_value('PAYMENT', 'MODULES'))
File "/home/evgeniuz/.virtualenvs/port/lib/python2.7/site-packages/django/template/context.py" in __init__
  149\.             self.update(processor(request))
File "/home/evgeniuz/src/chillifish-pg/lib/satchmo_store/shop/context_processors.py" in settings
  21\.     cart = Cart.objects.from_request(request)
File "/home/evgeniuz/src/chillifish-pg/lib/satchmo_store/shop/models.py" in from_request
  237\.                 except Order.DoesNotExist:

Exception Type: NameError at /shop/checkout/balance/1/
Exception Value: global name 'Order' is not defined 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:22:29.373

也许我只是遗漏了一些东西，但您指的是 CartManager 在定义之前的 Order 类。直到第 642 行才定义订单。我不太了解 Django 的内部工作原理，但我会尝试将 Order 类移到 CartManager 上方，看看它是否能让你克服这个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-07T17:14:37.197

备查。

我想你忘了导入订单类

# c++ - 当路径中有空格时，从与 Qt 应用程序相同的目录启动可执行文件

> ID：10585253
> 
> 赞同：2
> 
> 时间：2012-05-14T14:24:26.393
> 
> 标签：c++, qt, executable, qprocess

我想在我的 Qt 应用程序中按下按钮时启动一个可执行文件。它`.exe`始终与 Qt 应用程序本身位于同一目录中。

有时此目录的路径中有空格。这似乎阻止了`.exe`启动。

这是我的代码（似乎不起作用）：

```
QString path = QCoreApplication::applicationDirPath ();
path.append("/executable.exe");

QProcess process;
process.execute(path); 
```

我不知道是否可以在`.exe`不先显示命令提示符的情况下启动。当`.exe`运行时，我必须关闭 Qt 应用程序，同时`.exe`继续运行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T16:18:21.640

`execute(QString)`对可执行路径和参数使用单个字符串。如果没有正确引用，`C:\A path with spaces\foo.exe`将被解释`c:\A`为可执行文件和`path`,`with` `spaces\foo.exe`作为参数。

为避免这种情况，请使用将`execute(QString, QStringList)`参数作为单独字符串列表的重载，即使您根本不想传递参数：

```
QProcess::execute(path, QStringList()); 
```

这是正确的事情，不需要您的任何引用。

# asp.net-mvc - MVC DDD EF 复杂子对象遍历

> ID：10585261
> 
> 赞同：0
> 
> 时间：2012-05-14T14:24:44.860
> 
> 标签：asp.net-mvc, entity-framework, repository, domain-driven-design

我正在就聚合根和使用导航属性遍历子对象进行辩论。

场景一：

*   客户是聚合根
*   地址是一个实体
*   联系人是一个实体

一个客户可以有多个地址，一个地址可以有多个联系人。我使用客户 ID 查询下面的客户存储库并返回一个客户对象。

```
Dim customer as Customer = _customerRepository.GetById(request.Id) 
```

如果我们需要访问客户地址，我们将遍历客户对象中的地址，如下所示。

```
Dim address as Address = customer.RetrieveAddress(request.AddressId) 
```

然后将针对 x 个子对象执行此方法。我展示的示例是一个简单的示例，但就包含数百万条记录的数据库表而言，一旦查询并返回聚合根对象，当遍历多个子对象时，其他人如何管理性能问题？

场景二：

与上面的示例相同，但我们不是查询客户存储库并返回客户对象，而是返回一个子对象。

```
Dim address as Address = _customerRepository.GetAddressById(request.AddressId) 
```

现在因为我们已经查询了地址对象，这意味着我不必遍历客户对象来获取它。即使我已经使用客户存储库直接查询地址表并返回地址对象，在遵循 DDD 时是否允许这样做？或者我应该使用场景 1 来查询客户存储库并返回作为聚合根的客户对象并遍历子对象？

我问的原因是因为在我们的数据库图中，我们有几个表要从我们的聚合根遍历，并且随着时间的推移它可能包含数百万条记录，这会降低性能。

只是想知道其他人如何在不降低性能的情况下彻底应用 DDD，因为当您使用带有导航属性的 EF 时，一旦您使用它们，它就会为每个子对象发送一个查询，如果它处于 for 循环中，则可能发送 100 多个查询.

麦克风

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:04:36.013

您将无法使用 ER 图来确定聚合：)

所有权并不一定意味着聚合。您只是指关系遍历。聚合根是一项棘手的业务。[我在我的网站http://www.ebenroux.co.za](http://www.ebenroux.co.za)上写了一些关于这个的博客，你可能特别想看看这个：

[天然与合成骨料](http://www.ebenroux.co.za/post.aspx?id=e1d91f76-9fd3-49e3-984e-fdc777fc041b)

聚合具有不同的边界，需要特定的领域知识来确定边界在哪里。之后就是简单地成为所有权或弱引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T08:48:10.810

聚合是一项棘手的业务，决定聚合边界需要大量思考。阅读您的问题，我不太确定您是根据行为而不是数据库实体关系设计聚合。正如 Eben 所说，后一种方法不会走得太远，而且您的聚合最终可能会非常大（就子实体的数量而言）。

我读过的关于这个主题的最有见地的东西之一是[Vaughn Vernon 的 Effective Aggregate Design](http://dddcommunity.org/library/vernon_2011)。我肯定会推荐给它一个阅读。他谈到的一件重要的事情是试图使你的聚合尽可能小。这自然会对性能有所帮助。

对于**子实体**，我不会做你在场景 2 中所做的事情，因为你不应该通过聚合根来改变实体的状态；这保持了不变量。话虽如此，您的示例使用了一个可能是**值对象**的地址对象，因此出于性能原因有一个单独的地址存储就可以了。

When starting with DDD, I think its important to be reminded that you still need to be pragmatic with your design choices; DDD doesn't solve all your problems for you. In most cases the design choices are a trade-off for things like performance.

# c# - 读取文本文件时忽略页眉和页脚行

> ID：10585264
> 
> 赞同：0
> 
> 时间：2012-05-14T14:24:46.330
> 
> 标签：c#

到目前为止，这是我的代码：

```
string _nextLine;
string[] _columns;
char[] delimiters;

delimiters = "|".ToCharArray();

using (StreamReader _reader = ...)
{
    _nextLine = _reader.ReadLine();

    while (_nextLine != null)
    {
        _columns = _nextLine.Split(delimiters);
        JazzORBuffer.AddRow();
        JazzORBuffer.Server = _columns[0];
        JazzORBuffer.Country = _columns[1];
        JazzORBuffer.QuoteNumber = _columns[2];
        _nextLine = _reader.ReadLine();
    }
} 
```

我的文件的前 5 行如下所示：

```
在 x 和 y 之间创建的产品

第 1 列标题 | 栏目 2 标题 | 第 3 列标题 | 第 4 栏标题 |

温迪Z| 戴夫 | 约翰 | 史蒂夫 |

```

最后 3 行如下所示：

```
温迪Z| 戴夫 | 约翰 | 史蒂夫 |

产品总数| 49545

```

我需要在我的代码中进行哪些更改，以便忽略文件中的前 3 行和最后一行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T14:39:57.800

我不是 100% 确定我理解这个问题，但请尝试：

```
string[] lines = File.ReadAllLines("FilePath");
string[] _columns;

//Start at index 2 - and keep looping until index Length - 2
for (int i = 2; i < lines.Length - 2; i++)
{
    _columns = lines[i].Split('|');
    JazzORBuffer.AddRow();
    JazzORBuffer.Server = _columns[0];
    JazzORBuffer.Country = _columns[1];
    JazzORBuffer.QuoteNumber = _columns[2];
} 
```

注意 - 这将通过一次将整个文件读入内存来改变你正在做的事情的性能。如果它是一个非常大的文件，这可能不是高性能的。如果是的话，说出来:)

# windows-mobile - Windows CE 5 上的 Windows mobile 外观

> ID：10585265
> 
> 赞同：1
> 
> 时间：2012-05-14T14:24:47.327
> 
> 标签：windows-mobile, compact-framework, windows-ce

自 2004 年以来，我一直在使用 Compact Framework（当前版本为 3.5）开发 Windows Pocket PC 应用程序。该程序已用于 HP iPaq 214 和相对昂贵的 Psion Walkabout Pro 硬件等设备上。

我们希望支持更多具有 RFID 读取能力的设备，目前正在研究使用 Windows CE 5 的设备，即*没有*Mobile 6“覆盖”的设备。我能够在 CE 设备上安装程序及其要求。我也能够运行和使用该程序。

但是，CE 使用除 Mobile 之外的其他 UI 标准。我的简短测试表明

*   菜单位于顶部 - 而不是底部。
*   有标准的窗户装饰。
*   开始按钮、系统托盘等是可见的。

我的问题是：当程序在 Windows CE 中运行时，是否可以设置一些参数来获得 Windows Mobile 的“外观”？

最好它应该跨平台工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:53:55.350

如果您询问是否可以在操作系统级别修改某些参数以使其看起来像 WM，答案是“否”。如果您希望在两个平台上保持一致的外观，则必须创建一个全屏应用程序并自己在应用程序中提供 UI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T07:22:39.970

我的不完美解决方案最终如下。

在初始化期间，我检测它是 Windows Mobile 系统还是 vanilla Windows CE。如果它是 Windows CE 系统，我在主窗体的设置过程中使用以下内容

```
Bounds = new Rectangle(-5, -25, 250, 330) 
```

这会将窗口装饰移出视野，并留下一个与 Windows Mobile 上可用的客户区相似的客户区（我没有计算像素，所以我不能说它们是否相等）。

但是，到目前为止，我还没有找到将菜单移至底部的方法。

# php - MySQL PHP 查询无效 - 找不到列

> ID：10585270
> 
> 赞同：1
> 
> 时间：2012-05-14T14:24:58.013
> 
> 标签：php, mysql, sql, variables

**更新： '' 的建议围绕 $username 工作。谢谢！但是现在，该表实际上并没有从 $lastLoginTime 更新。**

我的查询有一些问题，我似乎无法在我的生活中弄清楚，我停了下来。

让我们看一下代码。

```
function checkTOS($preusergrab){
include("includes/opendb.php");

$query = "SELECT * FROM users WHERE username='".$preusergrab."'";
$result = mysql_query($query) or die(mysql_error());

while($row = mysql_fetch_assoc($result)){
    $resultset[] = $row;
    $TOS = $row['acceptTOS'];
    }

mysql_free_result($result);

 if($TOS == 1){
 // return to processor

    $lastLoginTime = time();

    $query = mysql_query("UPDATE users 
                    SET lastLoginTime = '$lastLoginTime' 
                        WHERE username = $username");

                        if (!$query) {

             die('<br>Invalid query: ' . mysql_error());
            }

 }elseif($TOS == 0 || $TOS = ''){
    header("Location: http://partner.domain.com/terms.php?action=show");
    die();
}else{
echo 'Internal Application Error:';
echo 'Value unrecognizable.';
echo '<br>Please alert someone at user@domain.com';
die();
}
 } 
```

现在，问题出现在此部分：

```
 $lastLoginTime = time();

    $query = mysql_query("UPDATE users 
                    SET lastLoginTime = '$lastLoginTime' 
                        WHERE username = $username");

                        if (!$query) {

             die('<br>Invalid query: ' . mysql_error());
            } 
```

它说：

```
 Invalid query: Unknown column 'theuser' in 'where clause' 
```

在这种情况下，'theuser' 是 $preusergrab 所代表的用户。

在我的表中，用户名是主键，第 0 行。

如果我知道该行在那里并且其他一切正常，那么什么可能是无效的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:27:30.683

尝试

```
$query = mysql_query("UPDATE users 
                SET lastLoginTime = '$lastLoginTime' 
                    WHERE username = '$username'"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:27:37.170

它应该是：

```
WHERE username = '$username'"); 
```

请注意我在 $username' 变量周围添加的撇号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:34:22.860

我相信你忘了引用 $username，像这样引用 '$username'

```
$query = mysql_query("UPDATE users 
SET lastLoginTime = '$lastLoginTime' 
WHERE username = '$username'");

if (!$query) {
die('<br>Invalid query: ' . mysql_error());
} 
```

# php - 使用 PHPStorm 的 phpcs 自定义规则集

> ID：10585274
> 
> 赞同：11
> 
> 时间：2012-05-14T14:25:07.123
> 
> 标签：php, phpstorm, codesniffer

我试图以某种方式说服 phpcs 使用 Zend 编码指南，但 - 允许我使用带下划线的变量（如`$blub->foo_bar`）。

谁能告诉我如何从 PHPStorm 中更改 phpcs 使用的规则集，好吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-15T01:23:02.750

如果要覆盖内置标准，则需要创建自定义编码标准。这只是创建一个包含标准定义的 XML 文件的问题。

在您的情况下，您想要整个 Zend 编码标准，但您不想要关于变量名的特定命名约定规则。因此，您将创建一个名为`mystandard.xml`（将其命名为您想要的任何名称并将其放在您想要的任何位置）并放入以下内容的文件：

```
<?xml version="1.0"?>
<ruleset name="MyStandard">
 <description>My custom Zend coding standard.</description>
 <rule ref="Zend">
  <exclude name="Zend.NamingConventions.ValidVariableName"/>
 </rule>
</ruleset> 
```

您可以做更多的事情来自定义您的标准，包括从其他标准引入支票、覆盖消息或将其中一些消息静音。您可以在这里查看文档：http: [//pear.php.net/manual/en/package.php.php-codesniffer.annotated-ruleset.php](http://pear.php.net/manual/en/package.php.php-codesniffer.annotated-ruleset.php)

最后我检查了一下，无论出于何种原因，PHPStorm 都不允许您使用自定义编码标准。通常，您只需输入标准名称作为`mystandard.xml`文件的完整路径。如果 PHPStorm 仍然不允许您这样做，那么欺骗它的唯一方法是实际安装您的自定义标准。

请注意，这不是您通常需要做的事情，而且有点复杂。但是，如果您想尝试一下，这就是您的操作方式：

1.  查找 PHPCS 在您的系统上的安装位置。如果您不知道那在哪里，请尝试`pear config-show | grep php_dir`. PHP_CodeSniffer 将在该目录下。对我来说，PEAR 安装在 中`/usr/local/PEAR`，所以 PHP_CodeSniffer 位于`/usr/local/PEAR/PHP/CodeSniffer`
2.  创建一个名为的新`MyStandard`目录`/usr/local/PEAR/PHP/CodeSniffer/Standards`
3.  将您的`mystandard.xml`文件直接放在那里，但将其重命名为`ruleset.xml`

要确认您的标准已安装，请运行`phpcs -i`. 你应该看到

```
The installed coding standards are MySource, MyStandard, PEAR, PHPCS, Squiz and Zend 
```

现在，PHPStorm 将（希望）显示`MyStandard`为下拉列表中的一个选项。如果它没有显示出来，那么他们可能已经对列表进行了硬编码，如果不直接破坏 Zend 编码标准，就没有任何方法可以让它工作。

我希望这些信息可以帮助您找到解决方案。如果没有，您始终可以使用自定义标准直接在命令行上运行 PHPCS：

```
phpcs --standard=/path/to/mystandard.xml /path/to/code 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-06T11:54:29.593

可以在 phpstorm 上添加您自己的自定义规则集，这可以在项目设置 => 检查 =>“PHP 代码嗅探器验证”中完成，使用编码标准“自定义”并设置自定义规则集的根目录。xml

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T17:33:03.557

标准列表不是硬编码的，它是从 phpcs 获得的。如上所述安装您自己的标准将完成这项工作。

# android - 使用 Android Contact API 时出现问题

> ID：10585280
> 
> 赞同：0
> 
> 时间：2012-05-14T14:25:17.843
> 
> 标签：android, android-intent, android-contacts

使用 Android Contact API 时出现问题

Button 放置在 EditText 旁边。当用户单击 Button 时，使用以下代码调用 Contact API：

```
Intent intent = new Intent(Intent.ACTION_PICK, ContactsContract.Contacts.CONTENT_URI);
startActivityForResult(intent, Constants.PICK_CONTACT); 
```

上面的代码将调用以下方法：

```
@Override
    public void onActivityResult(int reqCode, int resultCode, Intent data) {
        super.onActivityResult(reqCode, resultCode, data);
            if (reqCode == Constants.PICK_CONTACT) {
                if (resultCode == Activity.RESULT_OK) {
                    String contactStr = getContactInfo(data);
                    mEditTxtTo.setText(contactStr);
                }
             }
}

protected String getContactInfo(Intent intent) {
        String contactEmail = "";
        Cursor cursor = managedQuery(intent.getData(), null, null, null, null);

        while (cursor.moveToNext()) {
            String contactId = cursor.getString(cursor.getColumnIndex(ContactsContract.Contacts._ID));
            // Find Email Addresses
            Cursor emails = getContentResolver().query(ContactsContract.CommonDataKinds.Email.CONTENT_URI, null,
                    ContactsContract.CommonDataKinds.Email.CONTACT_ID + " = " + contactId, null, null);

            while (emails.moveToNext()) {
                if (contactEmail.trim().length() > 0) {
                    contactEmail = new StringBuilder(contactEmail).append(IShipdocsMobileConstants.SEMICOLON_DELIMITER)
                            .append(emails.getString(emails.getColumnIndex(ContactsContract.CommonDataKinds.Email.DATA))).toString();
                } else {
                    contactEmail = emails.getString(emails.getColumnIndex(ContactsContract.CommonDataKinds.Email.DATA));
                }
            emails.close();
        }
        cursor.close();
        return contactEmail;
    } 
```

我添加了 if - else 条件来处理以下问题：

假设在名为 A 的联系人中，有 3 个电子邮件 Id。因此，在将第一封电子邮件添加到 contactEmail 之后，将在第一封电子邮件之后附加下一封电子邮件，并用分号分隔，并且循环一直持续到最后一个元素。

```
if (contactEmail.trim().length() > 0) {
                        contactEmail = new StringBuilder(contactEmail).append(";")
                                .append(emails.getString(emails.getColumnIndex(ContactsContract.CommonDataKinds.Email.DATA))).toString();
                    } else {
                        contactEmail = emails.getString(emails.getColumnIndex(ContactsContract.CommonDataKinds.Email.DATA));

                } 
```

当多个电子邮件用于单个联系人时当前面临的问题。

假设有 3 个联系人，A , B & C

现在，联系人姓名：A 有以下电子邮件：

a@a.com b@b.com c@c.com

联系人姓名：B 有以下电子邮件：

b@b.com c@c.com

如果仅添加联系人 A，则 b@b.com 将在 contactEmail 上添加两次。在我看来，上面的代码似乎在所有联系人上搜索 b@b.com。

因此，最终返回的电子邮件是：a@a.com、b@b.com、c@c.com、b@b.com

在上述代码中查找错误的任何建议/提示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:07:20.083

检查外循环的次数：

```
while (cursor.moveToNext()) { 
```

正在为联系人 A 执行。对于该循环的每次迭代，打印出 contactId 和 contactEmail，如下所示：

```
Log.d("debug for stack overflow", contactEmail + " : " + contactId); 
```

这将有助于确定正在发生的事情。

如果在此之后您仍然需要更多帮助，请发布我刚才建议的结果。

# sharepoint - SharePoint 2010 通过功能部署可视化 Web 部件

> ID：10585282
> 
> 赞同：0
> 
> 时间：2012-05-14T14:25:27.797
> 
> 标签：sharepoint, powershell, sharepoint-2010

我制作了一个 VS 2010 项目并创建了 1 个 wspbuilder 解决方案。

我有 3 个功能，一个用于部署列，一个用于 CT，一个用于 Web 部件。

列与内容类型一样完美部署！

当我去寻找用于部署我的 Web 部件的功能（在 GUI 中）时。我找不到！

我在谷歌上看过无济于事。

上面的代码是我的功能。据我所见，日志中没有错误。

我已尝试使用 powershell 启用该功能，但得到该功能不是农场级别的功能，并且在 URL 定义的站点级别中找不到。

```
<Feature  Id="8440ac56-e102-40a4-ac91-1c5249b62fe1"
          Title="******.PMO.TopLevelRollup"
          Description="The description"
          Version="1.0.0.0"
          Hidden="FALSE"
          Scope="Web"
          DefaultResourceFile="core"
          ReceiverAssembly="*******.PMO, Version=1.0.0.0, Culture=neutral,    PublicKeyToken=6d3195b961dfcdc1"
          ReceiverClass="********.PMO.EventHandlers.Features.TopLevelRollupReceiver"
          xmlns="http://schemas.microsoft.com/sharepoint/">
  <ElementManifests>
    <ElementManifest Location="elements.xml"/>
    <ElementFile Location="********.PMO.TopLevelRollup.webpart" />
  </ElementManifests>
</Feature> 
```

也许我部署不正确？我用

```
Add-SPSolution
Install-SPSolution -Identity mywspfile.wsp 
```

任何帮助将不胜感激。

干杯特鲁兹

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T11:33:27.263

Web 部件只能在网站集级别部署，因为对 Web 部件库的访问仅通过网站集根网站存在。您可能需要将功能范围从网站更改为网站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:21:34.677

尝试将功能定义中的 Scope="Web" 更改为 Scope="Site"。这应该确保至少该功能将在站点级别可用。希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T08:21:50.143

我找到了解决方案！在 VS2010 中，Target 框架似乎将自己设置为空白。这会在通过 wsp builder 构建 wsp 时出现错误。

我将框架设置为我想要的框架，这似乎现在可以工作了！

感谢您的回复：）

# php - APNS沙箱连接失败，php文件中出现错误'0'？

> ID：10585283
> 
> 赞同：1
> 
> 时间：2012-05-14T14:25:33.353
> 
> 标签：php, iphone, ios, apple-push-notifications, apns-php

我正在尝试将 Apple 推送通知发送到我的应用程序。我正在关注 APNS 流程的本教程。网址：[http](http://www.raywenderlich.com/3525/apple-push-notification-services-tutorial-part-2) ://www.raywenderlich.com/3525/apple-push-notification-services-tutorial-part-2 。

我在 MAMP、PHP 中几乎完成了工作，并且我在 pus_config.php 文件中提到了我的 .pem 文件以进行 APNS 连接。我已经用 simplepush.php 文件测试了我的 .pem 文件，并向我的设备发送了通知。现在正在尝试使用从上述教程中获取的 push.php 文件。

这是我的 push_config.php 文件，

```
<?php

// Configuration file for push.php

$config = array(
    // These are the settings for development mode
    'development' => array(

        // The APNS server that we will use
        'server' => 'gateway.sandbox.push.apple.com:2195',

        // The SSL certificate that allows us to connect to the APNS servers
        'certificate' => 'GopiAPNSCert.pem',
        'passphrase' => 'gopi',

        // Configuration of the MySQL database 
        'db' => array(
            'host'     => 'localhost',
            'dbname'   => 'gopipush',
            'username' => 'gopipush',
            'password' => 'uH4q9xQGNAuFW',
            ), 

        // Name and path of our log file
        'logfile' => '/Users/gopi/Desktop/PushChatServer/log/push_development.log',
        ),

    // These are the settings for production mode
    'production' => array(

        // The APNS server that we will use
        'server' => 'gateway.push.apple.com:2195',

        // The SSL certificate that allows us to connect to the APNS servers
        'certificate' => 'ck.pem',
        'passphrase' => 'secret',

        // Configuration of the MySQL database
        'db' => array(
            'host'     => 'localhost',
            'dbname'   => 'pushchat',
            'username' => 'pushchat',
            'password' => '1233}jfdoie',
            ),

        // Name and path of our log file
        'logfile' => '/Users/gopi/Desktop/PushChatServer/log/push_development.log',
        ),
    ); 
```

上述证书名称和密码已通过 simplepush.php 文件进行验证和正确测试。

这是我的 push.php 文件，

```
<?php

try
{
    require_once('push_config.php');

    ini_set('display_errors', 'off');

    if ($argc != 2 || ($argv[1] != 'development' && $argv[1] != 'production'))
        exit("Usage: php push.php development|production". PHP_EOL);

    $mode = $argv[1];
    $config = $config[$mode];

    writeToLog("Push script started ($mode mode)");

    $obj = new APNS_Push($config);
    $obj->start();
}
catch (Exception $e)
{
    fatalError($e);
}

////////////////////////////////////////////////////////////////////////////////

function writeToLog($message)
{
    global $config;
    if ($fp = fopen($config['logfile'], 'at'))
    {
        fwrite($fp, date('c') . ' ' . $message . PHP_EOL);
        fclose($fp);
    }
}

function fatalError($message)
{
    writeToLog('Exiting with fatal error: ' . $message);
    exit;
}

////////////////////////////////////////////////////////////////////////////////

class APNS_Push
{
    private $fp = NULL;
    private $server;
    private $certificate;
    private $passphrase;

    function __construct($config)
    {
        $this->server = $config['server'];
        $this->certificate = $config['certificate'];
        $this->passphrase = $config['passphrase'];

        // Create a connection to the database.
        $this->pdo = new PDO(
            'mysql:host=' . $config['db']['host'] . ';dbname=' . $config['db']['dbname'], 
            $config['db']['username'], 
            $config['db']['password'],
            array());

        // If there is an error executing database queries, we want PDO to
        // throw an exception.
        $this->pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

        // We want the database to handle all strings as UTF-8.
        $this->pdo->query('SET NAMES utf8');
    }

    // This is the main loop for this script. It polls the database for new
    // messages, sends them to APNS, sleeps for a few seconds, and repeats this
    // forever (or until a fatal error occurs and the script exits).
    function start()
    {
        writeToLog('Connecting to ' . $this->server);

        if (!$this->connectToAPNS())
        {
           exit;
        }

        while (true)
        {           
            writeToLog('Getting PushQueue');

            $stmt = $this->pdo->prepare('SELECT * FROM push_queue WHERE time_sent IS NULL LIMIT 20');
            $stmt->execute();
            $messages = $stmt->fetchAll(PDO::FETCH_OBJ);

            foreach ($messages as $message)
            {
                if ($this->sendNotification($message->message_id, $message->device_token, $message->payload))
                {
                    $stmt = $this->pdo->prepare('UPDATE push_queue SET time_sent = NOW() WHERE message_id = ?');
                    $stmt->execute(array($message->message_id));
                }
                else  // failed to deliver
                {
                    $this->reconnectToAPNS();
                }
            }

            unset($messages);           
            sleep(5);
        }
    }

    // Opens an SSL/TLS connection to Apple's Push Notification Service (APNS).
    // Returns TRUE on success, FALSE on failure.
    function connectToAPNS()
    {
        $ctx = stream_context_create();
        stream_context_set_option($ctx, 'ssl', 'local_cert', $this->certificate);
        stream_context_set_option($ctx, 'ssl', 'passphrase', $this->passphrase);

        $this->fp = stream_socket_client(
            'ssl://' . $this->server, $err, $errstr, 60,
            STREAM_CLIENT_CONNECT|STREAM_CLIENT_PERSISTENT, $ctx);

        if (!$this->fp)
        {
            writeToLog('Failed APNS Connection');
            writeToLog("Failed to connect: $err $errstr");
            return FALSE;
        }

        writeToLog('Connection OK');
        return TRUE;
    }

    // Drops the connection to the APNS server.
    function disconnectFromAPNS()
    {
        fclose($this->fp);
        $this->fp = NULL;
    }

    // Attempts to reconnect to Apple's Push Notification Service. Exits with
    // an error if the connection cannot be re-established after 3 attempts.
    function reconnectToAPNS()
    {
        writeToLog('ReconnectToAPNS');
        $this->disconnectFromAPNS();

        $attempt = 1;

        while (true)
        {
            writeToLog('Reconnecting to ' . $this->server . ", attempt $attempt");

            if ($this->connectToAPNS())
                return;

            if ($attempt++ > 3)
                fatalError('Could not reconnect after 3 attempts');

            sleep(60);
        }
    }

    // Sends a notification to the APNS server. Returns FALSE if the connection
    // appears to be broken, TRUE otherwise.
    function sendNotification($messageId, $deviceToken, $payload)
    {
        if (strlen($deviceToken) != 64)
        {
            writeToLog("Message $messageId has invalid device token");
            return TRUE;
        }

        if (strlen($payload) < 10)
        {
            writeToLog("Message $messageId has invalid payload");
            return TRUE;
        }

        writeToLog("Sending message $messageId to '$deviceToken', payload: '$payload'");

        if (!$this->fp)
        {
            writeToLog('No connection to APNS');
            return FALSE;
        }

        // The simple format
        $msg = chr(0)                       // command (1 byte)
             . pack('n', 32)                // token length (2 bytes)
             . pack('H*', $deviceToken)     // device token (32 bytes)
             . pack('n', strlen($payload))  // payload length (2 bytes)
             . $payload;                    // the JSON payload

        /*
        // The enhanced notification format
        $msg = chr(1)                       // command (1 byte)
             . pack('N', $messageId)        // identifier (4 bytes)
             . pack('N', time() + 86400)    // expire after 1 day (4 bytes)
             . pack('n', 32)                // token length (2 bytes)
             . pack('H*', $deviceToken)     // device token (32 bytes) 
             . pack('n', strlen($payload))  // payload length (2 bytes)
             . $payload;                    // the JSON payload
        */

        $result = @fwrite($this->fp, $msg, strlen($msg));

        if (!$result)
        {
            writeToLog('Message not delivered');
            return FALSE;
        }

        writeToLog('Message successfully delivered');
        return TRUE;
    }
} 
```

我的 push_development.log 文件中出现此错误。

```
2012-05-14T18:04:28+05:30 Push script started (development mode)
2012-05-14T18:04:28+05:30 Connecting to gateway.sandbox.push.apple.com:2195
2012-05-14T18:04:29+05:30 Failed to connect: 0 
```

我找不到我做错了什么？我应该在我的 push.php 文件中更改什么。我已经测试了我的网络连接和 .pem 文件。你能帮我解决这个错误并在我的设备中获取通知吗？提前致谢。

**编辑**

```
unknownc42c032e8297:~ name$ cd /Users/name/Desktop/PushChatServer
unknownc42c032e8297: PushChatServer name$ telnet gateway.sandbox.push.apple.com 2195
Trying 17.149.34.66...
Connected to gateway.sandbox.push-apple.com.akadns.net.
Escape character is '^]'.
^C
Connection closed by foreign host.
unknownc42c032e8297: PushChatServer name$ openssl s_client -connect gateway.sandbox.push.apple.com:2195 -cert NameAPNCert.pem -key GopiAPNSCert
.pem
Enter pass phrase for NameAPNKey.pem:
CONNECTED(00000003)
depth=1 /C=US/O=Entrust, Inc./OU=www.entrust.net/rpa is incorporated by reference/OU=(c) 2009 Entrust, Inc./CN=Entrust Certification Authority - L1C
verify error:num=20:unable to get local issuer certificate
verify return:0
---
Certificate chain
 0 s:/C=US/ST=California/L=Cupertino/O=Apple Inc/OU=Internet Services/CN=gateway.sandbox.push.apple.com
   i:/C=US/O=Entrust, Inc./OU=www.entrust.net/rpa is incorporated by reference/OU=(c) 2009 Entrust, Inc./CN=Entrust Certification Authority - L1C
 1 s:/C=US/O=Entrust, Inc./OU=www.entrust.net/rpa is incorporated by reference/OU=(c) 2009 Entrust, Inc./CN=Entrust Certification Authority - L1C
   i:/O=Entrust.net/OU=www.entrust.net/CPS_2048 incorp. by ref. (limits liab.)/OU=(c) 1999 Entrust.net Limited/CN=Entrust.net Certification Authority (2048)
---
Server certificate
-----BEGIN CERTIFICATE-----
MIIEZTCCA02gAwIBAgIESyDhfjANBgkqhkiG9w0BAQUFADCBsTELMAkGA1UEBhMC
VVMxFjAUBgNVBAoTDUVudHJ1c3QsIEluYy4xOTA3BgNVBAsTMHd3dy5lbnRydXN0
Lm5ldC9ycGEgaXMgaW5jb3Jwb3JhdGVkIGJ5IHJlZmVyZW5jZTEfMB0GA1UECxMW
KGMpIDIwMDkgRW50cnVzdCwgSW5jLjEuMCwGA1UEAxMlRW50cnVzdCBDZXJ0aWZp
Y2F0aW9uIEF1dGhvcml0eSAtIEwxQzAeFw0xMDA0MTMyMzM0MzNaFw0xMjA1MzEw
MDA0MjdaMIGPMQswCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTESMBAG
A1UEBxMJQ3VwZXJ0aW5vMRIwEAYDVQQKEwlBcHBsZSBJbmMxGjAYBgNVBAsTEUlu
dGVybmV0IFNlcnZpY2VzMScwJQYDVQQDEx5nYXRld2F5LnNhbmRib3gucHVzaC5h
cHBsZS5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAM5NngiDMFpGBMmb
8tG2MRhLEdsx553Xjq+5C/c0mtildwhnC1X0LWKUexWdQsMchniac+WnHFSs3YMJ
JJ55kQSB6wqK/WNcxsUn8pMkMsvk3YZFM7TsaKQvFOeieiXCSJVlR3grm3+dilv1
Br+SUqv8JrgU3ijmoQO63vkb8B/hAgMBAAGjggEnMIIBIzALBgNVHQ8EBAMCBaAw
HQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMDMGA1UdHwQsMCowKKAmoCSG
Imh0dHA6Ly9jcmwuZW50cnVzdC5uZXQvbGV2ZWwxYy5jcmwwMwYIKwYBBQUHAQEE
JzAlMCMGCCsGAQUFBzABhhdodHRwOi8vb2NzcC5lbnRydXN0Lm5ldDBABgNVHSAE
OTA3MDUGCSqGSIb2fQdLAjAoMCYGCCsGAQUFBwIBFhpodHRwOi8vd3d3LmVudHJ1
c3QubmV0L3JwYTAfBgNVHSMEGDAWgBQe8auJBvhJDwEzd+4Ueu4ZfJMoTTAdBgNV
HQ4EFgQUNyg/64Sjw/+b4YOwC8E/c+jemRgwCQYDVR0TBAIwADANBgkqhkiG9w0B
AQUFAAOCAQEAk9Ij+NCp+323+4vBqbA0fT9ZCROptPqNIshY5uEvaWUaW5hsoLUm
fsMJMueqzDaoj4yPD8iCCZq1Mp8tM8WB2mG1zIxTLshlhRgDDUF11IbUUBHv/ZhU
RzXewQD6pazQmsBPuR0vP3mmWbKqmZOiv2yWSGlQmWGW4m6RQwjYYj8UqqFEdinV
g1+qY6/muTpaCiygDjJZBlv9P6bwwP9FB8OJf5tGECvvxXad3PK/oiI77aLTYSVr
SA0oisXCiqcgTKQq5BV5M3fQQ4ZS73aBKLI0wPYc0AASD5WdtPTGTvmEbhO4KeaU
0SL85Prf8uSsDOLvn3656awLz/H/yzrf/g==
-----END CERTIFICATE-----
subject=/C=US/ST=California/L=Cupertino/O=Apple Inc/OU=Internet Services/CN=gateway.sandbox.push.apple.com
issuer=/C=US/O=Entrust, Inc./OU=www.entrust.net/rpa is incorporated by reference/OU=(c) 2009 Entrust, Inc./CN=Entrust Certification Authority - L1C
---
No client certificate CA names sent
---
SSL handshake has read 2549 bytes and written 2017 bytes
---
New, TLSv1/SSLv3, Cipher is AES256-SHA
Server public key is 1024 bit
Secure Renegotiation IS supported
Compression: NONE
Expansion: NONE
SSL-Session:
    Protocol  : TLSv1
    Cipher    : AES256-SHA
    Session-ID: 
    Session-ID-ctx: 
    Master-Key: 729CC0899B36143DAC78D40B2C31ECB71C81A3BD8DC5CFD6D71AC7885DD2E63DCD47096E97A1B3AF032A8D7D48BF73DA
    Key-Arg   : None
    Start Time: 1336636910
    Timeout   : 300 (sec)
    Verify return code: 0 (ok)
---
name
closed

unknownc42c032e8297: PushChatServer name$ php simplepush.php
Connected to APNS
Message successfully delivered 
```

在这里，我可以连接 apns 并发送通知。所以认为 .pem 文件没有问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:03:54.110

**[编辑]** 您可以尝试在配置中设置证书文件的绝对路径吗？

您可以检查此项以解决对等验证问题。

安装证书 [http://code.google.com/p/apns-php/wiki/CertificateCreation#Verify_peer_using_Entrust_Root_Certification_Authority](http://code.google.com/p/apns-php/wiki/CertificateCreation#Verify_peer_using_Entrust_Root_Certification_Authority)

在这里使用

```
stream_context_set_option($ctx, 'ssl', 'cafile', 'entrust_2048_ca.cer'); 
```

注意：禁用验证也有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-21T11:53:14.737

对我有用的是更新 ck.pem 文件的权限，以便 PHP 脚本可以正确读取它。完成后，我可以毫无问题地连接到 APNS。

# java - ClientProtocolException - Android - php

> ID：10585288
> 
> 赞同：1
> 
> 时间：2012-05-14T14:25:59.417
> 
> 标签：java, php, client

我习惯于自己解决问题，但这次我真的被困住了。如果有人能给我一个线索，那就太好了。

问题：我的android应用程序调用一个php脚本（比如script1.php），它使用“header”php函数来重定向另一个脚本（比如script2.php）。

如果我在浏览器中运行[http://xxxxxx.com/script1.php?param1=y¶m2=y2¶m3=y3](http://xxxxxx.com/script1.php?param1=y&param2=y2&param3=y3)它可以正常工作，但如果应用程序运行以下代码它会崩溃。

```
 nameValuePairs.add(new BasicNameValuePair("param1",param1));
    nameValuePairs.add(new BasicNameValuePair("param2",param2));
    nameValuePairs.add(new BasicNameValuePair("param3",param3));;

    try{
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost("http://xxxxxx.com/script1.php");
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
        HttpResponse response = httpclient.execute(httppost);
        Log.v("println", "response: "+response);
    }catch(Exception e1){
        Log.e("log_tag","Error in http connection"+e1.toString());
    } 
```

我已经检查了一切。Script1.php 从 android 应用程序获取正确的参数，但是那个会抛出 org.apache.http.client.ClientProtocolException

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T06:28:24.440

问题可能出在 PHP 脚本上。请确保您的脚本以 post 或 request 方法接受您的请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-07T19:49:20.947

这应该工作

```
nameValuePairs.add(new BasicNameValuePair("param1",param1));
nameValuePairs.add(new BasicNameValuePair("param2",param2));
nameValuePairs.add(new BasicNameValuePair("param3",param3));;

try{
    HttpParams httpParams=new BasicHttpParams();
    HttpClient httpclient = new DefaultHttpClient(httpParams);
    HttpPost httppost = new HttpPost("http://xxxxxx.com/script1.php");
    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
    HttpResponse response = httpclient.execute(httppost);
    Log.v("println", "response: "+response);
}catch(Exception e1){
    Log.e("log_tag","Error in http connection"+e1.toString());
} 
```

# date - 将 csv 中的列转换为日期 powershell

> ID：10585289
> 
> 赞同：5
> 
> 时间：2012-05-14T14:26:02.190
> 
> 标签：date, powershell, csv, casting

我有一个与此类似的 csv

```
"fundName","MMFcusip","ticker","AsOfDate","SumHoldingPercent"
"BlackRock OH Muni MMP/Instit","'091927236'","COIXX","2/29/2012 12:00:00 AM","100.00000000200"
"Western Asset Inst US Treas Res","'52470G841'","CIIXX","2/29/2012 12:00:00 AM","100.00000000200" 
```

使用 powershell，如何在使用 import-csv cmdlet 时将“asOfDate”转换为日期/时间？

编辑：这是我目前正在使用的代码行

```
$measuredDate = $today.AddDays(-21)
$staleDates = Import-Csv d:\path\file.csv | Foreach-Object {$_.AsOfDate = Get-Date $_.AsOfDate} | Where-Object {asOfDate -lt $measuredDate} | Measure-Object 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T14:47:48.800

```
Import-Csv file.csv |
Where-Object { ![string]::IsNullOrWhiteSpace($_.AsOfDate) } | 
Foreach-Object {
   $_.AsOfDate = $_.AsOfDate -as [datetime]
   $_
} 
```

# php - kohana 不会显示错误，给出空白页

> ID：10585293
> 
> 赞同：2
> 
> 时间：2012-05-14T14:26:10.883
> 
> 标签：php, kohana, kohana-3.2

我正在尝试的新类/函数显然做错了，因为页面根本不会呈现。如果我调用这个新的错误类/函数，我收到的只是一个空白页。

为了调试它，看看它在哪里爆发，我试图启用所有显示错误的东西，但我似乎做得不对。

我读到我应该使用`ini_set('display_errors', TRUE);`，但我不确定在哪里放置此代码？

请问如何解决白页问题？我非常希望看到导致行/代码的错误。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T14:29:53.700

没有任何代码，就不可能告诉你哪里出了问题，但是如果你的问题是如何显示错误，你可以在脚本的顶部添加以下内容：

```
ini_set('display_errors',1);
error_reporting(E_ALL | E_STRICT); 
```

第一行告诉 php 在屏幕上显示错误，第二行指定要显示的错误（在本例中为全部）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T17:07:17.050

有几种情况 PHP 不会发回错误，例如内存相关或最大执行时间。您是否尝试过检查 Web 服务器错误日志？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T14:30:29.400

如果您将控制器的开头放在被调用的方法中（假设它做到了那么远）

```
ini_set('display_errors', TRUE);
error_reporting(E_ALL); 
```

你会看到所有的错误。这有利于故障排除，但您应该学习使用您拥有的 kohana 版本的设置来进行日志记录和错误显示

# asp.net - Asp.net 角色无法正常工作

> ID：10585299
> 
> 赞同：1
> 
> 时间：2012-05-14T14:26:33.300
> 
> 标签：asp.net, web-config

我设置了角色管理，以便只有具有“员工”角色的用户才能查看页面。但是，它允许登录的任何人查看该页面，我该如何更改它，以便只有那些登录并具有“员工”角色的用户才能查看我的页面？

```
 <location path="About.aspx">
        <system.web>
          <authorization>
            <deny users="?"/>
            <allow roles="Employee"/>
          </authorization>
        </system.web>
      </location> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:33:03.077

根据[MSDN](http://msdn.microsoft.com/en-us/library/8d82143t.aspx)：

> 在运行时，授权模块迭代允许和拒绝元素，从最本地的配置文件开始，直到授权模块找到适合特定用户帐户的第一个访问规则。然后，授权模块根据找到的第一个访问规则是允许规则还是拒绝规则来授予或拒绝对 URL 资源的访问权限

根据该解释，您应该允许员工（因为这将首先匹配），然后拒绝其他所有人。

```
 <location path="About.aspx">
    <system.web>
      <authorization>
        <allow roles="Employee"/>
        <deny users="*"/>
      </authorization>
    </system.web>
  </location> 
```

# java - 无法让装饰器模式工作

> ID：10585300
> 
> 赞同：1
> 
> 时间：2012-05-14T14:26:33.890
> 
> 标签：java, design-patterns

请看下面的代码。我看不出哪里出错了。我也很迷茫！非常感谢任何帮助！

```
package code;

public class Client {

 public static void main(String[] args){

     proxyPlane plane = new proxyPlane(new Pilot(18));
        plane.flyPlane();

        plane = new proxyPlane(new Pilot(25));
        plane.flyPlane();

        DecoratedPilot decPilot = new Pilot(35);

        System.out.println("Experienced Pilot of age " + Pilot.Age() + " " + decPilot.getDecotation());   
    }

}

package code;

public interface DecoratedPilot {

public String getDecotation();
}

package code;

public class Decoration extends PilotDecorator {

public Decoration(Pilot pilot) {
    super(pilot);
    // TODO Auto-generated constructor stub
}

@Override
public String getDecotation() {
    return "Pilot has earned his Commercial Wings";
}
}

package code;

public abstract class PilotDecorator implements DecoratedPilot {

public PilotDecorator(Pilot pilot)
{
    apilot = pilot;
}
}

package code;

public class Pilot implements DecoratedPilot {

private static int age;

public static int Age() {

    return age;  
}

public Pilot(int age){

    Pilot.age = age;
}

public String getDecotation() {
    // TODO Auto-generated method stub
    return null;
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:37:49.267

这里 ：

* * *

```
 package code;

        public class Client {

            public static void main(String[] args) {
                // -- A standard pilot
                Pilot standardPilot = new StandardPilot(35);
                System.out.println("Pilot : " + standardPilot.getAge() + " - " + standardPilot.getDescription());
                // -- A decorated pilot
                Pilot decoratedPilot = new DecoratedPilot(standardPilot);
                System.out.println("Pilot : " + decoratedPilot.getAge() + " - " + decoratedPilot.getDescription());
            }
        } 
```

* * *

```
 package code;

        public interface Pilot {
            int getAge();
            String getDescription();
        } 
```

* * *

```
 package code;

    public class StandardPilot implements Pilot {

        private int age;

        public StandardPilot(int age) {
            this.age = age;
        }

        @Override
        public int getAge() {
            return age;
        }

        @Override
        public String getDescription() {
            return "Standard Pilot";
        } 
```

}

* * *

```
package code;

public class DecoratedPilot implements Pilot {

    private Pilot pilot;

    public DecoratedPilot(Pilot pilot) {
        // todo : check not null
        this.pilot = pilot;
    }

    @Override
    public int getAge() {
        return pilot.getAge();
    }

    @Override
    public String getDescription() {
        return "Decorated Pilot";
    }
} 
```

如果您需要多个装饰器，您可以`DecoratedPilot`抽象并从中继承每个特定的装饰器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:46:09.653

问题是你实际上并没有装饰任何东西。也就是说，您不是用装饰器“包装”组件。

[这是装饰器模式](http://en.wikipedia.org/wiki/Decorator_pattern)的示例。

这种模式的一个很好的例子在书中：[Head First Design Patterns](https://rads.stackoverflow.com/amzn/click/com/0596007124)。我真的很喜欢这本书，如果你还没有，我强烈推荐它。

# javascript - 需要在 Javascript 数组中查找和计算给定变量

> ID：10585304
> 
> 赞同：-5
> 
> 时间：2012-05-14T14:26:47.830
> 
> 标签：javascript

您好，如果有人可以为我遇到的以下问题提供解决方案，我将不胜感激：
我需要查找给定变量是否存在于数组中；

```
var arr = new Array(4, 1, 4, 1, 4)  
var number = 4;  
var number_two = 1; 
```

**有没有办法计算“arr”中存在多少次“var number”以及这个数字在Array中的索引是什么？**
谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:37:08.940

它应该可以解决您的问题。

```
var myArray = [ 10, 10, 20, 20, 30, 30, 40, 40, 40, 40, 50, 50, 50, 50, 60 ] ;

function Counter( myArray ) {
   var myBlocks = new Object ;

   for( var i = 0; i < myArray.length; i++ ) {
      var aBlock = myArray[i] ;
      if(myBlocks.hasOwnProperty(aBlock)) {
         myBlocks[aBlock]++ ;
      } else {
         myBlocks[aBlock] = 1 ;
      }
   }

   var str = "";
   for(var j in myBlocks ) {
      str += "\t Element " + j+ " : apears "+ myBlocks[j] + " time(s)\n" ;
   }
   alert( str ) ;
}

Counter(myArray); 
```

[**演示**](http://jsfiddle.net/d3APY/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:36:12.220

只是为了解决另一个答案，我会自己回答：

```
function counter(arr, what) {
    var indexes = [];
    for (var i = 0; i < arr.length; i++) {
        if (arr[i] === what)
            indexes.push(i);
    }
    alert(indexes.length); // how many
    alert(indexes);        // indexes
}

counter([4, 1, 4, 1, 4], 4); 
```

[**演示**](http://jsfiddle.net/gdoron/9swBw/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T14:29:09.773

对于计数器，请使用以下解决方案。为了将结果转换为索引，您可以阅读有关 JavaScript 数组的更多信息（例如）。

```
function counter(arr, what) {
    var how_many = 0;
    for (var i = 0; i < arr.length; i++) {
        if (arr[i] == what) how_many++;
    }
    return how_many;
}

console.log(counter([4, 1, 4, 1, 4], 4)); 
```

# ios - Apple 的 iOS AVCAM 示例应用程序将输出文件放在哪里？

> ID：10585305
> 
> 赞同：0
> 
> 时间：2012-05-14T14:26:54.083
> 
> 标签：ios, video-streaming, video-capture, avcam

我下载了 AVCAM，运行它，录制了视频并制作了静止图像。它是否存储了视频并且仍然在某个文件中？或者示例只是创建 av 资产的示例，我必须处理资产？

最终，我想通过 HTTP LIVE STREAMING 将捕获的视频和音频压缩并传输到远程服务器。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:59:33.260

查看示例的源代码，它用于`-writeImageToSavedPhotosAlbum:orientation:completionBlock:`将静止图像写入设备的照片库。

视频首先记录到`output.mov`应用程序的临时文件目录中，然后写入应用程序的文档目录（如果仅记录音频）或使用`-writeVideoAtPathToSavedPhotosAlbum:outputFileURL:completionBlock:`.

# android - 使用后该应用程序仍在内存中，并且每次播放该应用程序时占用更多空间？

> ID：10585310
> 
> 赞同：1
> 
> 时间：2012-05-14T14:27:14.397
> 
> 标签：android, timer, xml-parsing, background-process

在我退出我的应用程序后，我已经处理了我在 RAM 中显示的应用程序。每次播放应用程序时，RAM 中的大小也会增加。我不知道为什么会这样。请给我一些建议。

此外，我在我的应用程序中使用计时器 15 秒，并在完成时间后显示 I Dialog 你的时间结束了。但有时该对话框会在一次完成时出现 3-4 次。这对我的应用程序来说非常尴尬。这件事是由于应用程序在后台还是我的计时器有问题。定时器代码如下。全球宣布

```
MyCount counter = new MyCount(time, 1000); 
```

计时器代码是：

```
 public class MyCount extends CountDownTimer {

            public MyCount(long millisInFuture, long countDownInterval) {
                super(millisInFuture, countDownInterval);
            }

        //call when time is finish 
        public void onFinish() {
            // TODO Auto-generated method stub
            AlertDialog.Builder alertbox = new AlertDialog.Builder(game.this);
            alertbox.setMessage("Oops, your time is over");
            alertbox.setNeutralButton("Ok",
                    new DialogInterface.OnClickListener() {

                        // Click listener on the neutral button of alert box
                        public void onClick(DialogInterface arg0, int arg1) {
                            quesCount++;
                            for(int i=0;i<4;i++){
                                 btn[i].setVisibility(View.VISIBLE);
                             }

                            rndom_no=randomno();
                            showDataOverControls(rndom_no);
                            counter.start();
    }
            });
            alertbox.show();
        }

        @Override
        public void onTick(long millisUntilFinished) {
            time1 = (TextView) findViewById

(R.id.time);

        time1.setText(""+millisUntilFinished / 1000);
    }
} 
```

应用程序中的 for 循环改变了按钮的可见性，rndom_no=randomno(); 该函数生成随机数，showDataOverControls(rndom_no)；它通过 xml 解析从 xml 文件中获取数据。如果我做错了什么，请提出建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:31:37.907

只要 android 需要，您的应用程序就会一直保留在内存中。您无法控制它。

尝试通过配置`launchMode`属性以阻止其增加来重用活动。

另外，使用一些标志来检查对话框显示，如果已经显示则不显示

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T06:51:16.840

您的应用程序保留在手机内存中，以允许用户在没有太多加载时间的情况下返回应用程序。Android 内存系统的工作方式是，只要不需要内存，最后使用的应用程序就会保留在 RAM 中。别担心。如果另一个应用程序需要此内存并且您的应用程序没有诸如活动之类的前台组件，那么您的整个应用程序将逐步关闭，直到手机再次有足够的内存为止。阻塞内存的唯一方法是创建一个设计非常糟糕的服务。如果前台服务需要内存，甚至服务也会关闭。

# mysql - mysql中的多重连接和设置

> ID：10585315
> 
> 赞同：2
> 
> 时间：2012-05-14T14:27:33.180
> 
> 标签：mysql

我有 13 个具有相同结构的表：

```
id  switch_name area 
```

每个表包含特定区域的不同 switch_name。例如，

```
table1:
id    switch_name area
56    xxxx        A
77    yyyy        A
table2:
id    switch_name area
89    zzzz        B
78    uuuu        B 
```

我需要使用这些表来更新另一个表“结果”，其中包含 id 并等待填充区域值。

所以我会做这个命令：

```
UPDATE results JOIN table1 ON results.switch_id = table1.id SET results.area = table1.area 
```

这适用于一张桌子，但我想加入所有这 13 张桌子。我们以其中两个为例，我可以这样写查询：

```
 UPDATE results JOIN table1 ON results.switch_id = table1.id JOIN table2 ON results.switch_id = table2.id SET results.area = table1.area, results.area = table2.area 
```

或者

```
UPDATE results JOIN table1 ON results.switch_id = table1.id SET results.area = table1.area JOIN table2 ON results.switch_id = table2.id SET results.area = table2.area 
```

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:31:48.787

如果所有`tableN`表具有相同的结构但不同的内容，`UNION ALL`则它们都在一个子查询中并与之连接。

```
UPDATE 
  results
  JOIN (
    SELECT id, switch_name, area FROM table1
    UNION ALL 
    SELECT id, switch_name, area FROM table2
    UNION ALL
    ..
    ..
    SELECT id, switch_name, area FROM table13
  ) alltogether ON results.switch_id = alltogether.id
SET results.area = alltogether.area
WHERE <conditions for update> 
```

从长远来看，如果这些表都相似但包含同一数据集的不同子集，则它们可能应该合并到*一个*表中，该表具有区分其来源的列。

使用以下内容将它们合并到一个表中：

```
INSERT INTO new_combined_table 
  (id, switch_name, area, source)
  SELECT id, switch_name, area, 't1' AS source FROM table1
  UNION ALL
  SELECT id, switch_name, area, 't2' AS source FROM table2
  UNION ALL
  SELECT id, switch_name, area, 't3' AS source FROM table3
  ..
  ..
  UNION ALL 
  SELECT id, switch_name, area, 't13' AS source FROM table13 
```

# django - django，如何使用 auth_login 根据用户角色重定向到特定页面

> ID：10585316
> 
> 赞同：0
> 
> 时间：2012-05-14T14:27:33.693
> 
> 标签：django, authentication

我们如何使用 auth_login 将用户重定向到基于用户角色的特定页面！

例如：

1.  应将具有“CRM”角色的用户重定向到仪表板
2.  应将具有“管理员”角色的用户重定向到活动

这可以使用 auth_login 在 Django 中完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:45:20.093

If by "role" you're referring to a permission, you can use has_perm() to test for the presence of a specific permission.

[https://docs.djangoproject.com/en/1.4/topics/auth/#django.contrib.auth.models.User.has_perm](https://docs.djangoproject.com/en/1.4/topics/auth/#django.contrib.auth.models.User.has_perm)

# snmp - snmp 中的系统运行时间

> ID：10585321
> 
> 赞同：7
> 
> 时间：2012-05-14T14:27:44.500
> 
> 标签：snmp

我正在尝试通过 SNMP 发送陷阱消息。

网上的例子提到了'sysUpTime'值的设置，但缺乏解释。sysUpTime 在这种情况下的作用是什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T01:55:03.140

sysUpTime 是：

> 自系统的网络管理部分上次重新初始化以来的时间（以百分之一秒为单位）。

有关详细信息，请参阅此 RFC：[https ://www.rfc-editor.org/rfc/rfc1907#section-2.1](https://www.rfc-editor.org/rfc/rfc1907#section-2.1)

# c# - 格式化复选框？

> ID：10585324
> 
> 赞同：2
> 
> 时间：2012-05-14T14:27:59.647
> 
> 标签：c#, asp.net, .net, css, checkbox

我正在使用.net 构建的网站上工作，我试图输出我的标记......

```
<span class="check-input">
     <!-- Terms -->
     <input type="checkbox" id="terms" class="terms checkbox">
     <label for="terms">I agree to the terms and conditions</label>
     <input type="checkbox" id="age" class="age checkbox">
     <label for="age">I am over 18 years old</label>
     </span> 
```

只有我的开发人员放置的代码是......

```
<!-- Terms -->
       <asp:CheckBox ID="CB_Agree" 
       Text="I agree to the terms and conditions" runat="server" TabIndex="4" />

       <asp:CheckBox ID="CB_Age" 
       Text="I am over 18 years old" runat="server" TabIndex="5" /> 
```

这将我的数据输出为...

```
<span class="check-input">
<!-- Terms -->
<span class="terms checkbox">
    <input type="checkbox" tabindex="4" name="ctl00$ContentPlaceHolder1$CB_Agree" id="ctl00_ContentPlaceHolder1_CB_Agree">
    <label for="ctl00_ContentPlaceHolder1_CB_Agree">I agree to the terms and conditions</label>
</span>
<span class="age checkbox">
    <input type="checkbox" tabindex="5" name="ctl00$ContentPlaceHolder1$CB_Age" id="ctl00_ContentPlaceHolder1_CB_Age">
    <label for="ctl00_ContentPlaceHolder1_CB_Age">I am over 18 years old</label>
</span>
</span> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T14:32:16.927

然后您（或您的开发人员）需要将该[`CssClass`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webcontrol.cssclass.aspx)属性添加到复选框。

例如：

```
<asp:CheckBox ID="CB_Agree" 
       CssClass="terms checkbox"
       Text="I agree to the terms and conditions" runat="server" TabIndex="4" /> 
```

它还有一个[`InputAttributes`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.checkbox.inputattributes.aspx)控制复选框的布局和一个[`LabelAttributes`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.checkbox.labelattributes.aspx)跨度的属性。

因此，您可以通过以下方式在代码隐藏中应用不同的背景颜色：

```
CB_Agree.InputAttributes.CssStyle.Add("background-color", "Red");
CB_Agree.LabelAttributes.CssStyle.Add("background-color", "Green"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:31:50.377

您将无法控制名称的输出方式，但您绝对可以控制 Id 的输出方式。执行此操作的一种方法是添加`ClientIDMode ="Static"`到标记中的控件，如下所示：

```
<asp:CheckBox ID="CB_Agree"  ClientIDMode ="Static"
   Text="I agree to the terms and conditions" runat="server" TabIndex="4" /> 
```

蒂姆只是让我意识到你的风格也有问题。为此，您需要这样添加`CssClass="your_class your_other_class"`：

```
<asp:CheckBox ID="CB_Agree"  ClientIDMode ="Static" CssClass="terms checkbox"
   Text="I agree to the terms and conditions" runat="server" TabIndex="4" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:37:43.607

> > [使用 ASP.NET 4 Web 表单的更清晰的 HTML 标记 - 客户端 ID（VS 2010 和 .NET 4.0 系列）](http://weblogs.asp.net/scottgu/archive/2010/03/30/cleaner-html-markup-with-asp-net-4-web-forms-client-ids-vs-2010-and-net-4-0-series.aspx)

如果您使用，`ASP.NET 4.0`那么您可以在控件上使用值为 的[ClientIDMode](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientidmode.aspx)`static`，并且 ID 不会更改。

否则，您可以使用文字来输出元素本身或仅输出其值。在您的页面上，您将拥有：

```
<input type="hidden" id="ppID" value='<asp:Literal ID="ppIDValue" runat="server" />' /> 
```

要将 css 类应用于您的控件，请使用服务器端控件的[CssClass属性：](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webcontrol.cssclass.aspx)

```
 <asp:CheckBox ID="CB_Agree" 
       Text="I agree to the terms and conditions" runat="server" TabIndex="4"
       CssClass="terms checkbox"   /> 
```

参考：[ASP.NET HtmlInputHidden 控件 - 停止更改名称？](https://stackoverflow.com/questions/3604350/asp-net-htmlinputhidden-control-stop-name-from-changing)

# java - Java 执行 'catch' 块没有错误，并且不知何故仍然运行 'try' 块

> ID：10585325
> 
> 赞同：3
> 
> 时间：2012-05-14T14:28:06.377
> 
> 标签：java, android

我对以下代码有疑问。首先，我是 Java 的新手，有其他几种语言的经验。

当我在 Android 上运行以下命令时，它在“in.close();”处出错，跳转到 catch 块并运行 Return“”；问题是，该函数不会返回一个空字符串，它成功地返回了正确的 json 数据，即使调试器说它没有运行 return json，但它正在运行 return "";

```
public void fetch() {

    // Get the JSON of the image gallery
    String json = getJSON();

    // json somehow has the actual correct json data and not an empty string!

};

private String getJSON() {

    try {
        // Create a URL for the desired page
        URL url = new URL("http://imgur.com/gallery.json");

        // Read all the text returned by the server
        BufferedReader in = new BufferedReader(new InputStreamReader(url.openStream(), "UTF-8"));
        String json = in.readLine();
        in.close();
        return json; // <-- debugger doesn't break here!
    }
    catch(Exception e) {
        Log.e("getJSON", e.getMessage());
        return ""; // <-- debugger breaks here! Cat Log shows nothing!
    }
} 
```

我将完全相同的代码复制到 Java 控制台中，以便我可以输出错误消息并在带有断点的调试器中观察它，并且代码执行时不会出错。

```
 try {
        // Create a URL for the desired page
        URL url = new URL("http://imgur.com/gallery.json");

        // Read all the text returned by the server
        BufferedReader in = new BufferedReader(new InputStreamReader(url.openStream()));
        String json = in.readLine();
        in.close();
        System.out.println(json);
}
catch(Exception e) {
    System.out.println(e.getMessage());
} 
```

到底发生了什么？为什么我的代码在 Java 控制台中运行时在 Android 上运行会出错？为什么当它出错时它不返回错误应该返回的内容；和空字符串？如何在 Android 中查看错误消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:36:47.727

你应该确保包括

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

在您的`androidManifext.xml`.

您正在尝试从远程位置检索数据。在 Java 控制台上，您可以在没有此类权限的情况下执行此操作，但在 Android 中则不行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:33:33.483

忘记 Android 中的“System.out.println”。您可以在 Eclipse 中使用“Logcat”视图。这用于显示您想要从设备中获取的每个日志。此外，您可以将“ `System.out.println(json);`”替换为“ `Log.e("MyApp", "Here is my Json: '"+json+"'");`”，您将在 logcat 中看到您的 json...；）

关于您的异常，您在框架中有一个方法可以自动将异常记录在 logcat 中：“ `myException.printStackTrace();`”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:35:55.353

您的代码似乎是正确的。如果您确实看到返回了 JSON，那么您没有`IOException`从`close`.

**编辑**：

您更新的源代码清楚地表明这里没有返回`finally`或重试逻辑。好的。

在您的环境中访问以下设置：窗口/首选项/运行/调试/启动/“当工作区包含断点时以调试模式启动”

将此设置为*Always*或*Prompt*。（如果之前是*Never*，您可能一直在运行模式下运行，因此采用了您不想要的优化。两个返回语句可能已被优化器合并为一个。）更改此设置后，您应该永远不会看到断点在与设置它的行不同的行处命中。请使用新设置仔细检查您的发现。

如果出于某种原因您不想在调试模式下运行，还有另一种中断异常的方法（Suspend On Caught Exceptions）不受这种优化的影响。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T14:34:12.877

Reader 读取文本，InputStream 二进制数据。桥 InputStreamReader 需要字符编码，并在您的情况下采用默认的操作系统编码。

所以最好明确地使用编码：

```
BufferedReader in = new BufferedReader(new InputStreamReader(url.openStream(), "UTF-8")); 
```

由于 JSON 最好使用 UTF-8，我已经给出了这一点。但是 Android 上的默认编码是 UTF-8，你可能是 Cp1252。所以也可能有其他问题。

# ruby-on-rails - 将应用程序与论坛分开？

> ID：10585327
> 
> 赞同：0
> 
> 时间：2012-05-14T14:28:13.513
> 
> 标签：ruby-on-rails, database, database-design, relational-database, database-schema

目前，我正在构建一个基于 Web 的应用程序，预计每天会收到大量点击（10,000+）。我有一个数据库结构，它有几个表，其中一个是用户表。我想在应用程序之外建立一个论坛；但是，我希望这个论坛对订阅主应用程序的人关闭（因此用户表中的用户必须在论坛中使用）。我想知道在实现这个主要应用程序/论坛应用程序时最好的做法是什么。我的选择如下：

1.  使用两个独立的数据库创建两个独立的应用程序。第一个应用程序将包含应用程序的主要功能，而辅助应用程序将是论坛。辅助应用程序将使用第一个数据库中的用户信息，然后将论坛帖子和类别保存在辅助数据库中。

2.  根本不要拆分应用程序。将主应用程序的功能保留在主数据库中。将辅助应用程序的功能添加到主应用程序。

3.  拆分应用程序（主要和次要），但只使用一个数据库。

此应用程序当前是使用 Ruby on Rails 构建的。

让我知道你的意见是什么，哪些会更好。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:38:03.227

您有更多选择：

1.  使用多个数据库
2.  创建自定义身份验证提供程序[omniauth](https://github.com/intridea/omniauth)

我更喜欢第二种方法，但它更复杂。最简单的系统是共享数据库，但如果您采用这种方式，请确保您可以扩展它。

# javascript - Ajax 按钮禁用

> ID：10585333
> 
> 赞同：0
> 
> 时间：2012-05-14T14:28:43.347
> 
> 标签：javascript, jquery

我想在用户使用 Ajax 对某个帖子进行评分后禁用一个按钮。目标是避免不必要地增加该职位的投票。这是代码，帮帮我

```
<script type='text/javascript'>
$(function(){
    $("a.vote_up").click(function(){
    //get the id
    the_id = $(this).attr('id');

    // show the spinner
    $(this).parent().html("<img src='images/spinner.gif'/>");

    //fadeout the vote-count 
    $("span#votes_count"+the_id).fadeOut("fast");

    //the main ajax request
        $.ajax({
            type: "POST",
            data: "action=vote_up&id="+$(this).attr("id"),
            url: "votes.php",
            success: function(msg)
            {
                $("span#votes_count"+the_id).html(msg);
                //fadein the vote count
                $("span#votes_count"+the_id).fadeIn();
                //remove the spinner
                $("span#vote_buttons"+the_id).remove();

            }
        });
    });

}); 
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:42:09.673

我会在使用 hide 方法发布**锚标签后简单地隐藏它。**您必须做的另一件事是使用该`preventDefault`方法来防止链接的默认行为。

```
 $(function(){
    $("a.vote_up").click(function(e){
    e.preventDefault();
    var item=$(this);
    the_id = item.attr('id');
    $(this).parent().html("<img src='images/spinner.gif'/>");
    $("span#votes_count"+the_id).fadeOut("fast");

        $.ajax({
            type: "POST",
            data: "action=vote_up&id="+the_id,
            url: "votes.php",
            success: function(msg)
            {
                $("span#votes_count"+the_id).html(msg);                 
                $("span#votes_count"+the_id).fadeIn();                   
                $("span#vote_buttons"+the_id).remove();
                item.hide();  // hide the link

            }
        });
    });    

}); 
```

如果你想保持链接原样而不隐藏它，你可以这样做。当您从 ajax 调用获得成功响应时，将链接的一个属性值设置为“完成”或某个值。每当单击链接时，首先检查该值是否已设置。如是。不要再做ajax了。像这样的东西。

```
 $(function(){
    $("a.vote_up").click(function(e){
      e.preventDefault();
      var item=$(this);
      if(item.attr("status")!="voted")
      {
         the_id = item.attr('id');
         $(this).parent().html("<img src='images/spinner.gif'/>");
         $("span#votes_count"+the_id).fadeOut("fast");

          $.ajax({
             type: "POST",
             data: "action=vote_up&id="+the_id,
             url: "votes.php",
             success: function(msg)
             {
                $("span#votes_count"+the_id).html(msg);                 
                $("span#votes_count"+the_id).fadeIn();                   
                $("span#vote_buttons"+the_id).remove();
                item.attr("status","voted");
                item.addClass("disabledLook"); //apply a css class to make the link look like disabled    
             }
           });
       }
    });        
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:45:48.097

查看[此小提琴](http://jsfiddle.net/gopi1410/8ekRD/)以通过 javascript 禁用按钮。

如果您希望它在刷新页面后仍保持禁用状态，则必须将用户通过使用 html5 存储、cookie 或会话变量投票的位置存储起来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:46:55.660

您可以使用 Jquery [.one()](http://api.jquery.com/one/)将单击绑定到您的`a`标签：

请参阅此[小提琴示例！](http://jsfiddle.net/zuul/VcfSh/)

```
$(function(){
    //click only once
    $("a.vote_up").one("click", function(e) {
        e.preventDefault();
        $('p').append('clicked ');
    });
}); 
```

**笔记：**

添加`e.preventDefault();`以禁止浏览器遵循 href 属性。（[在这里阅读](http://api.jquery.com/event.preventDefault/)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:07:36.770

`a`使用一行代码发送请求后的简单解除绑定操作：

```
$("a.vote_up").click(function(){
    // you ajax request here
    $(this).unbind('click');
}); 
```

# java - 如何在Java中以排序方式异步填充数组？

> ID：10585343
> 
> 赞同：1
> 
> 时间：2012-05-14T14:29:27.610
> 
> 标签：java, android, sorting, quicksort

我正在开发一个应用程序，我需要在其中获取文件列表，从中读取一些数据，并在 ListView 中显示所有这些文件，并根据该数据进行排序。

问题是它们可能很多，因此将它们全部加载需要时间。我可以选择异步加载它们（在一个线程中），或者显示一个加载框。我对第一个有问题：`ArrayAdapter`正在填充，然后最后排序，所以当所有项目都在那里时，列表没有排序。我想到的解决方案是：

1.  每次插入项目时，我都想对列表进行排序，但这会使过程变得更慢……但是，还是有[这个](https://stackoverflow.com/questions/1390832/how-to-sort-nearly-sorted-array-in-the-fastest-time-possible-java)，但我不确定我是否理解如何使用这种排序算法。

2.  使用某种排序数组，如此[处](https://stackoverflow.com/questions/4031572/sorted-array-list-in-java)所述。我不确定如何/是否可以使用`ArrayAdapter`.

3.  忘记使用线程来填充`ListView`. 只需添加“正在加载”消息或根本不添加任何内容。

4.  将文件中的数据存储在数据库中，使用存储文件的路径，并从数据库中读取所有条目。但我不确定这会使这个过程更快......

```
la = new ArrayAdapter(this, R.layout.list_item);
设置列表适配器（拉）；

处理程序处理程序=新处理程序（）{
    公共无效句柄消息（消息消息）{
        开关（消息。什么）{
        案例 TrackBrowser.DID_SUCCEED: {
            // 当线程完成查找项目列表时调用
            // mComparator 是我自己的 Comparator
            la.sort(mComparator);
            休息;
        }
        案例TrackBrowser.ADD：{
            // 每次解析一个项目时都会调用它
            TrackBrowser.TrackView tv = (TrackBrowser.TrackView) message.obj;
            la.add(tv);
            // 我应该每次都在这里排序吗？
            //la.sort(mComparator);
            休息;
        }
        }
    }
};

// 这个类只是遍历 listFiles 返回的文件并发送消息。
TrackBrowser tb = new TrackBrowser(handler);
线程线程 = 新线程（tb）；
线程.start();

```

我需要您对我应该使用哪种解决方案以及如何使用前两个（如果我应该使用它们）提供反馈？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:07:13.297

您可以使用二进制搜索来找到插入新元素的适当位置。因此，列表始终是排序的。

例如：

```
public static void add(List<Integer> list, Integer value) {
    int index = Collections.binarySearch(list, value);
    list.add((index < 0) ? (-index - 1) : index, value);
}

public static void main(String[] args) {
    List<Integer> list = new ArrayList<Integer>();

    add(list, 1);
    add(list, -5);
    add(list, -7);
    add(list, 100);
    add(list, 0);
    add(list, 90);
    add(list, -10);
    add(list, 0);
    add(list, 1);

    System.out.print(list);
} 
```

然后你会得到这样的输出：

`[-10, -7, -5, 0, 0, 1, 1, 90, 100]`

它工作正常。最坏的情况是二分查找`O(log(N))`和插入`O(N)`（因为当您插入一个新元素时，可能会在列表中发生重定位元素）。结果，这需要`O(N + log(N))`时间。它比`O(N*log(N))`每次都对列表​​进行排序要好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:37:29.580

也许您可以使用 TreeMap 或 TreeSet。当一个项目被添加到树中时，它被添加到正确的位置，以便列表保持排序。

# c# - 非常相似的错误列表，关于缺少程序集引用

> ID：10585345
> 
> 赞同：0
> 
> 时间：2012-05-14T14:29:30.023
> 
> 标签：c#, wpf

我有以下错误。我怀疑它们是相关的。任何人都知道什么是错的？

1.  未定义的 CLR 命名空间。“clr-namespace” URI 指的是程序集中未包含的命名空间“GoogleMapProject.ViewModel”。
2.  未定义的 CLR 命名空间。“clr-namespace” URI 指的是程序集中未包含的命名空间“GoogleMapProject.Behaviors”。
3.  找不到类型“vm:MainViewModel”。确认您没有丢失程序集引用并且所有引用的程序集都已构建。
4.  找不到类型“ei:FluidMoveBehavior”。确认您没有丢失程序集引用并且所有引用的程序集都已构建。
5.  找不到类型“行为：ZoomBehavior”。确认您没有丢失程序集引用并且所有引用的程序集都已构建。
6.  找不到类型“行为：PanBehavior”。确认您没有丢失程序集引用并且所有引用的程序集都已构建。
7.  找不到类型“行为：DisplayVideoBehavior”。确认您没有丢失程序集引用并且所有引用的程序集都已构建。
8.  在“FluidMoveBehavior”类型中找不到可附加属性“EaseY”。
9.  在“FluidMoveBehavior”类型中找不到可附加属性“EaseX”。

1 警告： 1\. XML 命名空间“http://schemas.microsoft.com/expression/2010/interactions”中不存在标记“FluidMoveBehavior”。第 23 行位置 14。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:31:30.467

您要么没有正确引用的包含这些内容的库 (GoogleMapProject)，要么版本错误，要么未使用`xmlns:`语法将这些内容正确导入 XAML。

这可能是由于打开了已“清理”的现有项目，没有附带依赖项，并且无法从其原始引用位置访问依赖项以进行复制。

# iphone - iphone搜索表单参数请求和响应？

> ID：10585346
> 
> 赞同：0
> 
> 时间：2012-05-14T14:29:34.200
> 
> 标签：iphone, parameters, restkit

我目前正在创建一个搜索表单，它将向服务器发送一个请求，其中包含用户从搜索表单中选择的多个参数。

我需要知道将数据发送到服务器然后接收 JSON 响应的最佳方式是什么。我看到 RestKit 可以发送带有多个参数的表单数据，但这不违反 RESTful 原则，因为您应该只在创建/添加新记录时执行 POST 吗？

这样做的正确方法是什么，以便我可以将参数发送到服务器，然后从服务器接收带有结果的 JSON？是否已经有一个 API 可以做到这一点，或者 RestKit 是否适合这个目的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:57:19.230

RestKit 很好。不再支持 ASI。

# python - Python如何用re.sub（）替换反斜杠

> ID：10585349
> 
> 赞同：17
> 
> 时间：2012-05-14T14:29:48.373
> 
> 标签：python, python-2.7

我有以下字符串

```
mystr1 = 'mydirname'
myfile = 'mydirname\myfilename' 
```

我正在尝试这样做

```
newstr = re.sub(mystr1 + "\","",myfile) 
```

如何逃避我试图连接到 mystr1 的反斜杠？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-05-14T14:32:46.590

你需要一个四倍的反斜杠：

```
newstr = re.sub(mystr1 + "\\\\", "", myfile) 
```

原因：

*   正则表达式匹配单个反斜杠：`\\`
*   描述此正则表达式的字符串：`"\\\\"`.

或者您可以使用原始字符串，因此您只需要一个双反斜杠：`r"\\"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:33:35.573

在正则表达式中，您可以像任何其他字符一样转义反斜杠，方法是在其前面放置一个反斜杠。这意味着“\\”是一个反斜杠。

# javascript - 在 javascript 中获取 CurrentMethodName

> ID：10585352
> 
> 赞同：0
> 
> 时间：2012-05-14T14:29:56.410
> 
> 标签：javascript

> **可能重复：**
> [我可以在 javascript 中获取当前正在运行的函数的名称吗？](https://stackoverflow.com/questions/1013239/can-i-get-the-name-of-the-currently-running-function-in-javascript)

在 Javascript 中有没有一种方法可以获取在其中执行 javascript 的方法/函数的名称。我想

> alert('在方法内部运行时出现此消息' + GetCurrentMethodName());

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:32:10.250

像这样使用`arguments.callee.name`：

```
alert('This message is coming while running inside the method ' + arguments.callee.name); 
```

# c# - 获取系统进程模块文件名

> ID：10585353
> 
> 赞同：0
> 
> 时间：2012-05-14T14:29:59.843
> 
> 标签：c#, windows, winapi, visual-c++

我想获取系统进程加载的模块的文件名。

因此，我首先执行

System.Diagnostics.Process.EnterDebugMode();

进入调试模式并获得 SEDebugPrivilege。

但是 Module32First 函数总是失败......

我究竟做错了什么 ？

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Runtime.InteropServices;

{
    public static class Toolhelp32
    {
        public const uint TH32CS_SNAPHEAPLIST = 0x00000001;
        public const uint TH32CS_SNAPPROCESS = 0x00000002;
        public const uint TH32CS_SNAPTHREAD = 0x00000004;
        public const uint TH32CS_SNAPMODULE = 0x00000008;
        public const uint TH32CS_SNAPMODULE32 = 0x00000010;
        public const uint TH32CS_SNAPALL = (TH32CS_SNAPHEAPLIST |
                                                 TH32CS_SNAPPROCESS |
                                                 TH32CS_SNAPTHREAD |
                                                 TH32CS_SNAPMODULE);
        public const uint TH32CS_INHERIT = 0x80000000;

        public const uint HF32_DEFAULT = 1;
        public const uint HF32_SHARED = 2;

        public const uint LF32_FIXED = 0x00000001;
        public const uint LF32_FREE = 0x00000002;
        public const uint LF32_MOVEABLE = 0x00000004;

        public struct HEAPLIST32
        {
            public uint dwSize;
            public uint th32ProcessID;
            public uint th32HeapID;
            public uint dwFlags;
        }

        public struct HEAPENTRY32
        {
            public uint dwSize;
            public IntPtr hHandle;
            public uint dwAddress;
            public uint dwBlockSize;
            public uint dwFlags;
            public uint dwLockCount;
            public uint dwResvd;
            public uint th32ProcessID;
            public uint th32HeapID;
        }

        public struct PROCESSENTRY32W
        {
            public uint dwSize;
            public uint cntUsage;
            public uint th32ProcessID;
            public UIntPtr th32DefaultHeapID;
            public uint th32ModuleID;
            public uint cntThreads;
            public uint th32ParentProcessID;
            public int pcPriClassBase;
            public uint dwFlags;
            public string szExeFile;
        }

        public struct PROCESSENTRY32
        {
            public uint dwSize;
            public uint cntUsage;
            public uint th32ProcessID;
            public uint th32DefaultHeapID;
            public uint th32ModuleID;
            public uint cntThreads;
            public uint th32ParentProcessID;
            public int pcPriClassBase;
            public uint dwFlags;
            public string szExeFile;
        }

        public struct THREADENTRY32
        {
            public uint dwSize;
            public uint cntUsage;
            public uint th32ThreadID;
            public uint th32OwnerProcessID;
            public int tpBasePri;
            public int tpDeltaPri;
            public uint dwFlags;
        }

        public struct MODULEENTRY32W
        {
            public uint dwSize;
            public uint th32ModuleID;
            public uint th32ProcessID;
            public uint GlblcntUsage;
            public uint ProccntUsage;
            public IntPtr modBaseAddr;
            public uint modBaseSize;
            public IntPtr hModule;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 256)] 
            public string szModule;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 260)] 
            public string szExePath;
        }

        public struct MODULEENTRY32
        {
            public uint dwSize;
            public uint th32ModuleID;
            public uint th32ProcessID;
            public uint GlblcntUsage;
            public uint ProccntUsage;
            public IntPtr modBaseAddr;
            public uint modBaseSize;
            public IntPtr hModule;
            public string szModule;
            public string szExePath;
        }

        [DllImport("kernel32.dll")]
        public static extern IntPtr CreateToolhelp32Snapshot(uint dwFlags, uint th32ProcessID);

        [DllImport("kernel32.dll", SetLastError = true)]
        [return: MarshalAs(UnmanagedType.Bool)]
        internal static extern bool CloseHandle(IntPtr hSnapshot);

        [DllImport("kernel32.dll")]
        public static extern bool Heap32ListFirst(IntPtr hSnapshot, ref HEAPLIST32 lphl);

        [DllImport("kernel32.dll")]
        public static extern bool Heap32ListNext(IntPtr hSnapshot, ref HEAPLIST32 lphl);

        [DllImport("kernel32.dll")]
        public static extern bool Heap32First(IntPtr hSnapshot, ref HEAPENTRY32 lphe,
            uint th32ProcessID, uint th32HeapID);

        [DllImport("kernel32.dll")]
        public static extern bool Heap32Next(IntPtr hSnapshot, ref HEAPENTRY32 lphe);

        [DllImport("kernel32.dll")]
        public static extern bool Toolhelp32ReadProcessMemory(uint th32ProcessID,
            IntPtr lpBaseAddress, IntPtr lpBuffer, uint cbRead, IntPtr lpNumberOfBytesRead);

        [DllImport("kernel32.dll")]
        public static extern bool Process32FirstW(IntPtr hSnapshot, ref PROCESSENTRY32W lppe);

        [DllImport("kernel32.dll")]
        public static extern bool Process32NextW(IntPtr hSnapshot, ref PROCESSENTRY32W lppe);

        [DllImport("kernel32.dll")]
        public static extern bool Process32First(IntPtr hSnapshot, ref PROCESSENTRY32 lppe);

        [DllImport("kernel32.dll")]
        public static extern bool Process32Next(IntPtr hSnapshot, ref PROCESSENTRY32 lppe);

        [DllImport("kernel32.dll")]
        public static extern bool Thread32First(IntPtr hSnapshot, ref THREADENTRY32 lpte);

        [DllImport("kernel32.dll")]
        public static extern bool Thread32Next(IntPtr hSnapshot, ref THREADENTRY32 lpte);

        [DllImport("kernel32.dll")]
        public static extern bool Module32FirstW(IntPtr hSnapshot, ref MODULEENTRY32W lpme);

        [DllImport("kernel32.dll")]
        public static extern bool Module32NextW(IntPtr hSnapshot, ref MODULEENTRY32W lpme);

        [DllImport("kernel32.dll")]
        public static extern bool Module32First(IntPtr hSnapshot, ref MODULEENTRY32W lpme);

        [DllImport("kernel32.dll")]
        public static extern bool Module32Next(IntPtr hSnapshot, ref MODULEENTRY32W lpme);
    }
}

class GetProcessModuleFilenamesHelper
    {
        const int INVALID_HANDLE_VALUE = -1;
        const int ERROR_BAD_LENGTH = 0x18;
        [DllImport("kernel32.dll", CharSet = CharSet.Auto)]
        public static extern int GetModuleFileName(HandleRef hModule, StringBuilder buffer, int length);

        public static List<Toolhelp32.MODULEENTRY32W> GetProcessModuleFilenames(int ProcId)
        {
            List<Toolhelp32.MODULEENTRY32W> lst = new List<Toolhelp32.MODULEENTRY32W>();

            IntPtr hModuleSnapshot = new IntPtr(ERROR_BAD_LENGTH);
            while (hModuleSnapshot == new IntPtr(ERROR_BAD_LENGTH))
            {
                hModuleSnapshot = Toolhelp32.CreateToolhelp32Snapshot(Toolhelp32.TH32CS_SNAPMODULE32|Toolhelp32.TH32CS_SNAPMODULE, (uint)ProcId);
                System.Windows.Forms.Application.DoEvents();
            }

            if (hModuleSnapshot != new IntPtr(INVALID_HANDLE_VALUE))
            {
                Toolhelp32.MODULEENTRY32W ModuleList = new Toolhelp32.MODULEENTRY32W();

                ModuleList.dwSize = (uint)Marshal.SizeOf(ModuleList);

                if (Toolhelp32.Module32First(hModuleSnapshot, ref ModuleList))
                {
                    do
                    {

                        Toolhelp32.MODULEENTRY32W ModuleEntry = new Toolhelp32.MODULEENTRY32W();
                        ModuleEntry.dwSize = (uint)Marshal.SizeOf(ModuleEntry);                                                                       

                        /*
                        if (Toolhelp32.Heap32First(hHeapSnapshot, ref HeapEntry, HeapList.th32ProcessID, HeapList.th32HeapID))
                        {
                            do
                            {
                                MemUsage += HeapEntry.dwBlockSize;
                            } while (Toolhelp32.Heap32Next(hHeapSnapshot, ref HeapEntry));
                        }
                       */

                        /*
                        StringBuilder buffer = new StringBuilder(260);
                        GetModuleFileName(ModuleEntry.hModule, buffer, buffer.Capacity);
                        string str = Path.GetFullPath(buffer.ToString());
                        str=str.Substring(0, str.LastIndexOf('\\'));
                        */
                        lst.Add(ModuleEntry);

                    } while (Toolhelp32.Module32Next(hModuleSnapshot, ref ModuleList));

                }

                int lasterr = Marshal.GetLastWin32Error();
                //System.Windows.Forms.MessageBox.Show(Marshal.GetLastWin32Error().ToString());

                Toolhelp32.CloseHandle(hModuleSnapshot);
            }

            return lst;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T23:08:33.360

我得到了错误。我应该将 ModuleList 添加到列表中

# javascript - 从浏览器发送 websocket ping/pong 帧

> ID：10585355
> 
> 赞同：151
> 
> 时间：2012-05-14T14:30:02.283
> 
> 标签：javascript, websocket, mongrel2

我一直在阅读有关 websockets 中的 ping/pong 消息以保持连接活跃，但我不确定它们是什么。它是一种独特的框架类型吗？（我在 chrome 中的 javascript WebSocket 对象上看不到任何与乒乓球相关的方法）。或者它只是一种设计模式（例如，我真的向服务器发送“ping”或任何其他字符串并让它响应）。乒乓球是否与连续帧有关？

我问的原因是我使用的是在 Mongrel2 后面运行的 python 框架，所以我想知道是否有办法向 Mongrel2 发送特定的 ping/pong 消息，告诉它在我的 python 应用程序不需要的情况下保持连接活动担心它。我猜这类似于为它提供一个单独的 HTTP 方法。而且我认为专用的 ping/pong 消息帧可能比字符串“ping”更简单（服务器和网络上的负载更少），尽管这可能无关紧要。

编辑：我刚刚查看了[RFC 6455](https://www.rfc-editor.org/rfc/rfc6455#section-5.5.2)，看起来 Ping 和 Pong 绝对是具有自己操作码的控制帧类型。那么如何在 Chrome 中从 javascript 发送 Ping 帧？

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2012-05-14T15:41:30.463

没有用于发送 ping 帧或接收 pong 帧的 Javascript API。您的浏览器要么支持，要么不支持。也没有 API 可以启用、配置或检测浏览器是否支持和正在使用 ping/pong 帧。有[关于为此创建 Javascript ping/pong API](https://www.w3.org/Bugs/Public/show_bug.cgi?id=13104)的讨论。将来 ping 可能是可配置/可检测的，但 Javascript 不太可能直接发送和接收 ping/pong 帧。

但是，如果您同时控制客户端和服务器代码，那么您可以轻松地在更高级别添加 ping/pong 支持。如果您还没有，您的消息中将需要某种消息类型的标头/元数据，但这很简单。除非您计划每秒发送数百次 ping 或同时有数千个客户端，否则自己做的开销将非常小。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-15T09:40:47.447

Ping 仅从服务器发送到客户端，浏览器应尽快使用 Pong OpCode 自动回复。因此，您不必担心更高级别的问题。

尽管并非所有浏览器都像他们想象的那样支持标准，但它们在实现这种机制方面可能存在一些差异，甚至可能意味着没有 Pong 响应功能。但就我个人而言，我使用的是 Ping / Pong，并且从未见过不实现这种类型的 OpCode 和在低级客户端实现上自动响应的客户端。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-11-03T07:51:00.260

# js中可能的解决方案

> 如果 WebSocket 服务器主动`ws`在几分钟后断开链接，则服务器和客户端之间不会发送任何消息。

1.  客户端主动发送自定义`ping`消息，使用该`keepAlive`功能保持活动状态

2.  服务器端将忽略自定义`ping`消息并响应自定义`pong`消息

```
let timerId = 0; 

function keepAlive(timeout = 20000) { 
    if (webSocket.readyState == webSocket.OPEN) {  
        webSocket.send('');  
    }  
    timerId = setTimeout(keepAlive, timeout);  
}

function cancelKeepAlive() {  
    if (timerId) {  
        clearTimeout(timerId);  
    }  
} 
```

# ios - iOS - 应用商店版本的行为与本地安装的版本不同

> ID：10585356
> 
> 赞同：1
> 
> 时间：2012-05-14T14:30:03.410
> 
> 标签：ios, rest, app-store, installation, asihttprequest

> **可能重复：**
> [ASIHTTPRequest 开始但从未结束](https://stackoverflow.com/questions/9934231/asihttprequest-begins-but-never-ends)

我刚刚在应用商店中批准了我的第一个 iOS 应用程序，对此我感到非常高兴，但很失望地发现从应用程序商店安装时它没有按预期工作。该应用程序使用 ASIHTTPRequest 通过 HTTP/HTTPS 调用 REST Web 服务并通过 JSON 返回数据。在模拟器/iPhone/iPod Touch/iPad 上测试应用程序时，我从来没有遇到过任何问题 - 数据返回正常，如果存在网络问题，则请求会正常超时。然而，在从应用商店下载的版本中，用户可以登录并执行一些基本请求，但一旦他们请求进一步请求或尝试下载文件，它就会一直等待并且永远不会超时。就好像请求甚至没有发送，因为我的服务器没有显示 HTTP 请求的记录（使用 WireShark）。

是否有人在应用商店中的应用与从本地安装的版本运行应用时遇到过类似的差异/问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T08:32:16.963

我意识到我没有在“发布”模式下测试我的应用程序，只有“调试”模式。在“发布”模式下运行后，我在应用商店版本中重现了问题。然后我发现问题是发布版本中的 ASIHTTPRequest 存在问题 - 请参阅以下链接：

[ASIHTTPRequest 在生产构建中失败](https://stackoverflow.com/questions/9123975/asihttprequest-fails-in-production-builds)

[ASIHTTPRequest 开始但永不结束](https://stackoverflow.com/questions/9934231/asihttprequest-begins-but-never-ends)

一旦我在 2 个文件上设置了编译器标志，一切正常。

乔纳森

# google-maps-api-3 - Google Maps API v3 以打开街道地图

> ID：10585358
> 
> 赞同：1
> 
> 时间：2012-05-14T14:30:19.410
> 
> 标签：google-maps-api-3, openstreetmap

您知道是否有任何简单的方法可以用开放街道地图 api 替换 google maps api v3 (javascript)？

它们的代码结构相似吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T16:49:23.980

肯定有。只需转到下面的 openlayers.org 示例站点，然后向下滚动到以“G”开头的示例，尤其是有关“Google Maps v3 api”的示例。

[http://dev.openlayers.org/releases/OpenLayers-2.10/examples/](http://dev.openlayers.org/releases/OpenLayers-2.10/examples/)

# ios - IOS 的 Opencv 库收到错误

> ID：10585360
> 
> 赞同：0
> 
> 时间：2012-05-14T14:30:25.563
> 
> 标签：ios, opencv

尝试对多个 .jpg 文件进行图像处理，并使用 iOS 应用程序的 opencv 库写入一个 .jpg 文件。但我无法写入/保存到最终文件（我已经从 Resources 文件夹保存到 Documents 文件夹”。

得到错误：

```
OpenCV Error: Unspecified error (could not find a writer for the specified extension) in imwrite_, file /Users/Aziz/Documents/Projects/opencv_sources/trunk/modules/highgui/src/loadsave.cpp, line 276 
```

我找不到任何解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T00:31:16.147

您当前的 OpenCV 二进制文件很有可能不是为支持 JPEG 图像而构建的。

重新编译 OpenCV 并确保它受支持。

# asp.net - Elmah.axd - 在 IIS Express 和 IIS 上都出现错误 404

> ID：10585361
> 
> 赞同：1
> 
> 时间：2012-05-14T14:30:27.300
> 
> 标签：asp.net, asp.net-mvc, elmah

任何人都可以建议为什么 elmah 错误页面没有显示并且我收到错误 404。我正在使用 IISExpress。我确定我有这个工作并且不记得对 web.config 进行任何更改以阻止它工作。

我的配置文件：

```
<configuration>
  <configSections>
    <sectionGroup name="elmah">
      <section name="security" requirePermission="false" type="Elmah.SecuritySectionHandler, Elmah" />
      <section name="errorLog" requirePermission="false" type="Elmah.ErrorLogSectionHandler, Elmah" />
      <section name="errorMail" requirePermission="false" type="Elmah.ErrorMailSectionHandler, Elmah" />
      <section name="errorFilter" requirePermission="false" type="Elmah.ErrorFilterSectionHandler, Elmah" />
    </sectionGroup>
  </configSections>
  <httpHandlers>
      <add verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" />
  </httpHandlers>
  <httpModules>
      <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah" />
      <add name="ErrorMail" type="Elmah.ErrorMailModule, Elmah" />
      <add name="ErrorFilter" type="Elmah.ErrorFilterModule, Elmah" />
  </httpModules>
<system.webServer>
 <modules runAllManagedModulesForAllRequests="true">
      <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah" preCondition="managedHandler" />
 </modules>
</system.webServer>
<elmah>
   <errorLog type="Elmah.XmlFileErrorLog, Elmah" logPath="~/App_Data" />
</elmah>
</configuration> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T18:23:29.370

从它的外观，我相信你的配置是错误的。您正在定义`<httpModules />`和`<httpHandlers />`超出`<system.web />`. 此外，您还需要`<system.webServer />`为 IIS 7+ 支持定义处理程序。试试这个：

```
<configuration>
    <configSections>
        <sectionGroup name="elmah">
            <section name="security" requirePermission="false" type="Elmah.SecuritySectionHandler, Elmah" />
            <section name="errorLog" requirePermission="false" type="Elmah.ErrorLogSectionHandler, Elmah" />
            <section name="errorMail" requirePermission="false" type="Elmah.ErrorMailSectionHandler, Elmah" />
            <section name="errorFilter" requirePermission="false" type="Elmah.ErrorFilterSectionHandler, Elmah" />
        </sectionGroup>
    </configSections>
    <system.web>      
        <httpHandlers>
            <add verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" />
        </httpHandlers>
        <httpModules>
            <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah" />
            <add name="ErrorMail" type="Elmah.ErrorMailModule, Elmah" />
            <add name="ErrorFilter" type="Elmah.ErrorFilterModule, Elmah" />
        </httpModules>
    </system.web>
    <system.webServer>
        <handlers>
            <add name="Elmah" verb="POST,GET,HEAD" path="elmah.axd" preCondition="integratedMode" type="Elmah.ErrorLogPageFactory, Elmah" />
        </handlers>
        <modules runAllManagedModulesForAllRequests="true">
            <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah" />
            <add name="ErrorMail" type="Elmah.ErrorMailModule, Elmah" />
            <add name="ErrorFilter" type="Elmah.ErrorFilterModule, Elmah" />
        </modules>
    </system.webServer>
    <elmah>
        <errorLog type="Elmah.XmlFileErrorLog, Elmah" logPath="~/App_Data" />
    </elmah>
</configuration> 
```

检查[此链接](http://code.google.com/p/elmah/downloads/detail?name=ELMAH-1.2-sp2-sample-web.config)以获取 ELMAH 1.2 的有效 Web.config 示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T18:21:14.717

你还在忽略路由中的 Elmad.axd 吗？这可能是使用 MVC 时的问题。

```
routes.IgnoreRoute("elmah.axd"); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-14T18:19:17.047

不确定这是否有帮助，但您是否在 web.config 中设置和配置了错误页面？

这是我们配置的：

```
<customErrors mode="RemoteOnly" defaultRedirect="ErrorPage.htm"></customErrors> 
```

在我们的应用程序的主目录中有一个随附的 errorpage.htm 文件。

# jquery - best_in_place 不是 Rails 3.2.1 中的函数错误

> ID：10585363
> 
> 赞同：3
> 
> 时间：2012-05-14T14:30:35.547
> 
> 标签：jquery, ruby-on-rails-3, rubygems, inplace-editing, best-in-place

我正在为我的 Rails 3.2.1 应用程序使用 best_in_place gem。我的开发没有错误。当我尝试在生产环境中运行应用程序时，我收到一个脚本错误

```
$(".best_in_place").best_in_place is not a function in my browser. 
```

在我的视图页面中，我有以下代码

```
<%= stylesheet_link_tag "best_inplace", "jquery-ui-1.8.20.custom" %>
<%= javascript_include_tag "application", "jquery.dataTables.min" %>

<%= best_in_place @user, :description, :type => :textarea %>

<script>
  jQuery(".best_in_place").best_in_place();
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T18:45:00.967

几分钟前我也遇到了这个问题，通过移动`require best_in_place`到最后解决了，其他地方不起作用。很奇怪，但无论如何都可以。

这是`application.js`清单

```
//= require jquery
//= require jquery_ujs
//= require jquery.purr
//= require_tree .
//= require i18n
//= require i18n/translations
//= require best_in_place

$(document).ready(function() {
  $('.best_in_place').best_in_place();
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:47:25.373

问题是该函数`best_in_place()?`是在内部声明的，在执行调用中`best_in_pace.js`的代码时可能仍需要加载该函数。正确的解决方案是通过[资产管道](http://guides.rubyonrails.org/asset_pipeline.html)启用 js 文件的串联。这可以通过包括`application.js``best_in_place()`

```
config.assets.debug = false 
```

和/或删除

```
config.assets.debug = true 
```

`config/environments/development.rb`分别_ `config/environments/production.rb`. 然后，包含的位置`best_in_pace.js`无关紧要（只要它出现在`jquery.js`代码调用之前和之前`best_in_place()`）。

# function - Cakephp 短代码动态调用函数和元素

> ID：10585364
> 
> 赞同：0
> 
> 时间：2012-05-14T14:30:36.607
> 
> 标签：function, cakephp, view

我的帖子有正文，在这些文本中我输入了 [gallery=2] 之类的短代码，现在我可以在我的文本中找到 2 个参数（gallery 和 2）我想在我看来动态调用一个函数（gallery），它是像这样调用一个元素（图库 id = 2）：

应用程序/视图/帖子/index.ctp

```
findshortcode($posts[Post][Body]); // this function find short code and call his name like gallery(2) 

//my problem is :

function gallery($id = null){
    $this->element('gallery', array('galleryid' => $id), array('plugin' => 'gallerys'));  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T21:08:52.520

你在那里拥有的东西没有多大意义，而且你描述的做事方式不是 Cakish 或 MVC 做事的方式。但我想我明白了你的问题，并将向你解释你想要的方式。

你需要做的是......从控制器内部执行所有逻辑......然后将所有完成的变量发送到视图以进行显示......

```
class PostsController extends AppController {

var $shortCodeTypes = array('gallery');

function view($id){
    $post = $this->Post->find(null, $id);
    $post = $this->_insertShortCodes($post);
    $this->set(compact('post'));
}

function _insertShortCodes($post){

    foreach($this->shortCodeTypes as $shortCodeType){
        // Do logic to find shortcodes and insert data into post body
    }
    return $post
} 
```

# java - AES加密输出长度

> ID：10585366
> 
> 赞同：1
> 
> 时间：2012-05-14T14:30:43.770
> 
> 标签：java, encryption, aes

我正在运行这个用于 AES 加密的 Java 代码：

```
byte[] iv = new byte[16];

SecretKey aesKey = new SecretKeySpec("hex key here", "AES");

Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
cipher.init(Cipher.ENCRYPT_MODE, aesKey, new IvParameterSpec(iv));

return cipher.doFinal("32 characters here ...".getBytes()); 
```

我总是得到一个 48 字节的输出，但我有一个期望输入 32 字节的旧系统。如何控制输出长度？

注意：我必须使用 AES CBC

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T14:46:13.133

由于您使用的填充，您将获得 32+16 个字节。

通常填充仅填充剩余字节，直到下一个密码块已满。但是在您的情况下，明文已经使用了 2 个块（2 * 16 字节）。在这种情况下，没有空间可以对“无需填充”的信息进行编码。因此，必须添加一个仅包含填充数据的附加密码块。

可能是遗留系统不使用填充。试试**“AES/CBC/NoPadding”**。

# python - 将来自多个小部件的相同信号连接到 PyQt 中的相同功能？

> ID：10585367
> 
> 赞同：1
> 
> 时间：2012-05-14T14:30:48.923
> 
> 标签：python, pyqt

好吧，我有这个应用程序，上面有很多 o lineEdit 小部件（实际上超过 20 个）。最后，我有另一个 lineEdit 应该显示其他小部件上的值的总和。但是，我想在每次更改某个值时使用“textEdited()”信号更新该总和。我知道我可以将所有这些小部件的信号连接到求和的函数，但我想必须有另一种方法来完成这项工作，这样就不需要这么多的重复代码。我对吗？有谁知道如何做到这一点？

谢谢指教。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:22:26.930

您自己已经给出了答案：您必须将 sum 函数连接到 each`QLineEdit`的`textEdited()`信号。当您将所有这些小部件存储在 Python 列表中时，您只需很少的代码即可完成此操作：

```
# ...append all line edits to this list:
line_edits = []

for le in line_edits:
  le.textChanged.connect(self.mySumFunction) 
```

这还有一个好处是，如果您需要同时编辑/启用/禁用/清除/...所有行编辑，您可以重复使用该列表。

# html - 窗口大小调整时水平滚动

> ID：10585369
> 
> 赞同：0
> 
> 时间：2012-05-14T14:30:53.147
> 
> 标签：html, css

```
#wrapper {
width: 896px;
margin: 0 auto;
padding-top: 760px;
padding-left: 48px;
padding-right: 48px;
color: rgb(60,60,60);
-webkit-text-size-adjust: 100%; /* Stops Mobile Safari from auto-adjusting font-sizes */
overflow:hidden;
} 
```

我正在使用工作正常的 Less Framework 4。唯一的问题是当我重新调整窗口大小时，水平滚动条会弹出中等大小然后消失。我已将其缩小到我的#wrapper DIV，因为一旦删除，一切都很好。它似乎是宽度，但我需要一个宽度设置，因为身体（显然）是 100%。帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:36:01.810

尝试使用最大宽度。这将使其缩小到低于该值，但不会高于该值。

希望有帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:44:23.853

您是否尝试将宽度设置为 100%？你用什么浏览器？请注意，Firefox 会为元素的宽度添加填充。您也可以尝试将overflow-x:hidden 设置为#wrapper 的父级。

# windows-phone-7 - Windows Phone 7 室内定位系统

> ID：10585374
> 
> 赞同：3
> 
> 时间：2012-05-14T14:31:10.047
> 
> 标签：windows-phone-7, windows-phone, indoor-positioning-system, redpin

我正在寻找在 Windows Phone 7 应用程序中实施室内定位系统的选项。这个应用程序将用于在商场内引导用户，因此高达几米的位置精度非常重要。我用谷歌搜索了一下，发现 Redpin - [http://redpin.org](http://redpin.org)看起来不错，但他们还没有适用于 Windows Phone 7 的现成客户端。Redpin 目前仅支持 iOS 和 Android。

这里有人可以帮忙吗？这里有人在 Windows Phone 7 应用程序上实现了室内定位系统吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:04:03.960

Windows Phone 7 没有提供足够的信息，无法在没有非常特定的 WiFi 基础架构的情况下生成这样的系统。

要实施这样的解决方案，您需要能够访问有关已连接（或可用）WiFi 网络或接入点的信息以及每个接入点的信号强度。根据这些，您可以对大致位置进行三角测量。

但是，
由于 WP7 SDK 不提供有关接入点名称或信号强度的信息，这变得非常困难。

解决此问题的唯一方法是通过网络名称识别位置，假设每个接入点使用不同的名称，以提供更高的准确性。
或者您在接入点上有一个代理，可以向请求添加额外的位置信息，从而提供更高级别的准确性，而无需创建许多唯一命名的网络。
无论哪种方式都是一种黑客行为，并且不太可能产生满足您要求的准确性水平。除非您知道您有足够数量的用户使用适当的设备来证明在 WP7 上创建这样的系统是合理的，否则我现在建议不要这样做，并希望在该平台的未来版本中提供额外的、必需的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T04:31:03.780

以下是室内定位 API 提供商列表。大多数选项都适用于 Android，但这是一个开始查看最近是否有任何可用于 WP7 的好地方：[https ://bitly.com/indoornavigation](https://bitly.com/indoornavigation)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T03:05:05.920

其中许多系统使用“指纹”技术……这意味着人们需要记录室内空间无线电环境。然后将该记录覆盖在地图上以获得空间唯一的无线电指纹。从理论上讲，它会很好用（确实如此），但问题是信号会发生变化。任何信号流和负载上的用户越多，将改变信号电平或完整性。

如果信号变化超过 20%（在大多数情况下），则需要重做记录。取决于空间的大小，这可能是一个非常耗时的过程。

另一个问题是大约 6 个月前，苹果取消了读取手机上看到的 rssi 值的能力……如果没有读取指纹技术，苹果设备将无法工作。这就是为什么这些 API 中的大多数都只是 android...RedPin 我认为没有更新他们的网站来反映这一点..

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-05-14T16:14:02.637

您可以在 windows phone 上简单地使用 RFID 之类的[NFC ：](http://de.wikipedia.org/wiki/Near_Field_Communication)

[http://rfidroundup.blogspot.com/2011/04/microsoft-to-bring-nfc-to-windows-phone.html](http://rfidroundup.blogspot.com/2011/04/microsoft-to-bring-nfc-to-windows-phone.html) ![NFC](../Images/a55e39771ecdc70003a3733d85b905a9.png)

或者

如果你等不及这个操作系统版本，你可以使用内置麦克风的声音频率指示器。窥视发送器和噪声检测的傅立叶分析。 [http://msdn.microsoft.com/en-us/library/ff431744%28v=vs.92%29.aspx](http://msdn.microsoft.com/en-us/library/ff431744%28v=vs.92%29.aspx)

![麦克风 WP7](../Images/30113987d59519d3a66fe3c1afcfcd04.png)

有关更多概念细节，您需要与我分享一些细节。

# iphone - 如何在 iOS5 中关闭 presentModalViewController 控制器

> ID：10585375
> 
> 赞同：0
> 
> 时间：2012-05-14T14:31:11.827
> 
> 标签：iphone

我是 iphone 开发的新手。我在 Xcode4.2 和 iOS5 中工作。我已经用于将一个视图导航到另一个视图：这工作正常..

```
-(IBAction)viewFullProfile:(id)sender
{
    OperatorFullProfile *operatorFullProfile = [[OperatorFullProfile alloc] initWithNibName:@"OperatorFullProfile" bundle:nil];    
    [self presentModalViewController:operatorFullProfile animated:YES];

} 
```

但是当我解雇 OperatorFullProfile 时，它​​并没有被解雇。对于解雇代码：

```
-(IBAction)Cancel:(id)sender
{
  [self.parentViewController dismissModalViewControllerAnimated: YES];
 // [self.parentViewController.parentViewController dismissModalViewControllerAnimated:YES];
 // [self dismissViewControllerAnimated:YES completion:nil ];
} 
```

我正在努力解决这个问题，请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:34:40.363

只需调用：

```
[self dismissModalViewControllerAnimated: YES]; 
```

应该可以解决问题，无需获取父视图控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:38:40.080

在您的取消按钮方法的 OperatorFullProfile.m 文件中...

```
-(IBAction)Cancel:(id)sender
{
  [self dismissModalViewControllerAnimated: YES];

} 
```

而你目前的这种观点将驳回...... :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T06:57:43.920

您必须`dismissModalViewControllerAnimated:`从`UIViewController`提供模态视图控制器的地方调用。

一种典型的（并且设计良好的）方法是使用委托。假设模态控制器有一个`Done`按钮。您在模态视图控制器中声明 a `@protocol`，假设其方法是 ，`didTapDoneButton`并且具有作为`@property`该协议的实例的 a ，我们称之为`delegate`。

在`IBAction`, 调用

```
-(IBAction)Cancel:(id)sender
{
    [self.delegate didTapDoneButton];
} 
```

在呈现模态的视图控制器中实现协议，并在创建模态控制器时将其委托属性设置为`self`.

```
-(IBAction)viewFullProfile:(id)sender
{
    OperatorFullProfile *operatorFullProfile = [[OperatorFullProfile alloc] initWithNibName:@"OperatorFullProfile" bundle:nil];    
    operatorFullProfile.delegate = self;
    [self presentModalViewController:operatorFullProfile animated:YES];

} 
```

在该类中，实现协议的方法，该方法将在按下按钮时调用：

```
-(void)didTapDoneButton
{
    [self dismissModalViewControllerAnimated: YES];
} 
```

这样，负责呈现模态控制器的控制器也负责解除它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T07:52:18.457

写吧：

[自我dismissModalViewControllerAnimated：是]；

干杯。

# asp.net-mvc - 会话变为空

> ID：10585377
> 
> 赞同：1
> 
> 时间：2012-05-14T14:31:19.353
> 
> 标签：asp.net-mvc, session

我的会话变为空。这是我在登录时在 MVC 项目中分配它的方式：

```
Session["connectionString"] = someString;
Session.Timeout = 70; 
```

在一个类库中我使用它：

```
HttpContext.Current.Session["connectionString"].ToString(). 
```

但是，过了一段时间我得到空引用异常。

在 web.config 我有：

```
<sessionState timeout="70"/> 
```

为什么我得到空引用异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:24:35.847

如果每次重新编译应用程序时都将会话存储在内存中（这是默认模式），Web 服务器会重新启动应用程序域，并且您存储在会话中的所有内容都会丢失。

# android - Android:Horizo ntalScrollView 包裹它的孩子？

> ID：10585381
> 
> 赞同：0
> 
> 时间：2012-05-14T14:31:29.010
> 
> 标签：android

我小时候有带 RelativeLayout 的 Horizo​​ntalScrollView。这是我的 xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<HorizontalScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#ff00ff"
    android:scrollbars="none">

<RelativeLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#ffffff" >
</RelativeLayout>

 </HorizontalScrollView> 
```

输出是粉红色...但我需要白色...为什么相对布局没有填充其父级？

截屏： ![在此处输入图像描述](../Images/695b1995b6e9ae596356c930a0aac8e3.png)

带有按钮的屏幕截图：![在此处输入图像描述](../Images/319c7e894c7b1b3598a781f4a4cac1a2.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:54:04.490

正如您所看到的，当您将按钮放入时，您与滚动视图不匹配。尝试使用 a`LinearLayout`作为您的父级，然后将滚动视图作为子级，`match_parent`然后将其他布局添加为滚动视图的子`match_parent`级

# regex - Coldfusion正则表达式将所有内容都放在括号内

> ID：10585391
> 
> 赞同：0
> 
> 时间：2012-05-14T14:31:51.687
> 
> 标签：regex, coldfusion

我的任务是使用冷融合找到大括号内的所有内容。

例如，如果字符串是这样的 - “来自 {user_first_name} {user_last_name} of {user_company} 的批准请求”

那么我应该能够取回 {user_first_name}、{user_last_name} 和 {user_company}。

我尝试使用 reMatch 和我在网上找到的一些正则表达式来做到这一点，但它们不起作用。

有人有什么想法吗？

PS：我尝试了这里给出的正则表达式 - 正则表达式[在大括号之间获取字符串“{我想要大括号之间的内容}”](https://stackoverflow.com/questions/413071/regex-to-get-string-between-curly-braces-i-want-whats-between-the-curly-brace)但是返回了一个空字符串。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:33:07.467

这似乎对我有用：

```
<cfscript>
input="Approval request from {user_first_name} {user_last_name} of {user_company} {}";
pattern="{[^}]*}"; //allowing for empty brackets
pattern="{[^}]+}"; //not allowing empty brackets

matches=rematch(pattern,input);
for (i=1;i<=arraylen(matches);i++){
    WriteOutput(matches[i]);
    WriteOutput("<br />");
}
</cfscript> 
```

没有代码示例，我看不出出了什么问题，但这适用于 CF 9.0.1，希望对您有所帮助

# c++ - cin.ignore 和 cin.sync 的区别

> ID：10585392
> 
> 赞同：12
> 
> 时间：2012-05-14T14:31:52.447
> 
> 标签：c++, iostream

`cin.ignore`和 和有什么不一样`cin.sync`？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-14T14:34:28.130

`cin.ignore`丢弃字符，直到指定的数量，或者直到达到分隔符（如果包括）。如果不带参数调用它，它会从输入缓冲区中丢弃一个字符。

例如，`cin.ignore (80, '\n')`将忽略 80 个字符，或者它找到的字符数，直到它遇到换行符。

`cin.sync`丢弃输入缓冲区中的所有未读字符。但是，不能保证在每个实现中都这样做。因此，`ignore`如果您想要一致性，这是一个更好的选择。

`cin.sync()`只会清除剩下的东西。我能想到的唯一`sync()`无法完成的用途`ignore`是替换`system ("PAUSE");`：

```
cin.sync(); //discard unread characters (0 if none)
cin.get(); //wait for input 
```

使用`cin.ignore()`and `cin.get()`，这可能有点混合：

```
cin.ignore (std::numeric_limits<std::streamsize>::max(),'\n'); //wait for newline
//cin.get() 
```

如果剩下一个换行符，只是 put`ignore`似乎会跳过它。但是，如果没有换行符，两者都将等待两个输入。丢弃任何未读取的内容可以解决该问题，但同样不一致。

# unit-testing - 以时间间隔顺序运行 TestNG 测试

> ID：10585398
> 
> 赞同：2
> 
> 时间：2012-05-14T14:32:28.540
> 
> 标签：unit-testing, junit, dao, testng

我有几个 DAO 单元测试类，我想使用 TestNG 一起运行，但是 TestNG 尝试并行运行它们，这会导致一些回滚失败。虽然我想按顺序运行我的单元测试类，但我还希望能够指定TestNG 在运行下一个测试之前必须等待的*最短时间。*这是可以实现的吗？

PS我知道可以告诉TestNG在SingleThread的测试类中运行所有测试，无论如何我都可以使用组指定方法调用的顺序，所以这可能不是问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:49:13.190

两个测试之间的[硬依赖](http://testng.org/doc/documentation-main.html#dependent-methods)又如何呢？如果你这样写：

```
@Test
public void test1() { ... }

@Test(dependsOnMethods = "test1", alwaysRun = true)
public void test2() { ... } 
```

then`test2`将始终在**之后** `test1`运行。

不要忘记`alwaysRun = true`，否则如果`test1`失败，`test2`将被跳过！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T06:06:48.540

1.  如果您不想并行运行类，则需要将套件的并行属性指定为 false。默认情况下，它是错误的。所以我认为它应该默认按顺序运行，除非你在调用测试的方式上有一些变化。

2.  为了在你的类之间添加一点延迟，你可以在一个用 @AfterClass 注释的方法中添加你的延迟逻辑。AFAIK testng 没有办法在 testng xml 或命令行中指定它。有一个 timeout 属性，但更多的是用于超时测试，可能不是您想要的。

要在测试之间添加延迟，即 xml 中的测试标签，那么您可以尝试实现 ITestListener - onFinish 方法，您可以在其中添加延迟代码。它在每个`<test>`. 如果在每个测试用例之后都需要延迟，则在 IInvokedMethodListener - AfterInvocation() 中实现延迟代码，该代码在每个测试方法运行后运行。然后，您需要在调用套件时指定侦听器。

希望能帮助到你..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-17T19:09:07.087

以下是我在一些测试中使用的。

**首先**，定义这样的实用方法：

```
// make thread sleep a while, so that reduce effect to subsequence operation if any shared resource,
private void delay(long milliseconds) throws InterruptedException {
    Thread.sleep(milliseconds);
}

private void delay() throws InterruptedException {
    delay(500);
} 
```

**然后**，在测试方法的末尾或开头调用该方法。

例如

```
@Test
public void testCopyViaTransfer() throws IOException, InterruptedException {
    copyViaTransfer(new File(sourcePath), new File(targetPath));
    delay();
} 
```

# jdbc - Weblogic 多池配置

> ID：10585402
> 
> 赞同：1
> 
> 时间：2012-05-14T14:32:38.633
> 
> 标签：jdbc, weblogic11g

我的应用程序在集群中托管 3 台托管服务器的 2 台物理服务器上运行。我们有 2 个未集群的数据库。我想以这样一种方式配置连接池，即物理机 A 中的所有托管服务器都将转到 DB1，并且在故障转移时转到 DB2。同样，机器 B 总是转到 DB2，在故障转移时移到 DB1。我如何配置连接池来实现这种期望的行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T10:54:27.327

我还没有尝试过，但[MultiDatasource](http://docs.oracle.com/cd/E17904_01/web.1111/e13737/config.htm)似乎是您正在寻找的。

请注意，这不是 MultiPool，因为它将从基于负载平衡或高可用性的任何池中提取。

定义 2 个数据源，一个用于 DB1，一个用于 DB2。

MultiDataSource 允许您从基于故障转移或负载平衡算法的数据源中获取

[http://albinoraclesoa.blogspot.in/2012/02/jdbc-multi-data-sources-in-weblogic.html](http://albinoraclesoa.blogspot.in/2012/02/jdbc-multi-data-sources-in-weblogic.html)

# jquery - Ajax 响应问题

> ID：10585405
> 
> 赞同：0
> 
> 时间：2012-05-14T14:32:43.063
> 
> 标签：jquery

我有一个通过 ajax POST 提交数据的脚本。它是从 2 个不同的页面调用的。在一个页面上，调用完美无缺，并返回 200 OK 和预期的响应，在另一页面上，它返回 302 状态并且不返回任何响应。

这两个页面使用相同的代码用于登录的 jQuery SmartModal 窗口和包含 ajax 调用的相同脚本，以及调用相同的 URL 来发布数据。

关于可能导致此问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T18:05:20.200

我的 ajax 调用是从 HTTP 页面转到 HTTPS 页面。它也应该来自 HTTPS

# .net - 关于.net框架中编译和执行阶段的详细工作的困惑

> ID：10585409
> 
> 赞同：0
> 
> 时间：2012-05-14T14:32:54.323
> 
> 标签：.net, assembly, compilation, manifest, execution

我正在学习 .net 框架理论概念（使用 wiki 和 google）。正如我从[wiki 上的这张图片中](http://en.wikipedia.org/wiki/File:CLR_diag.svg)了解到的那样，.net 框架中编译和执行过程的主要（也是最基本的）视图表明 c#、j#、vb.net 等中的各种源代码被编译成一个平台中立的字节码称为 CLI 代码（通用中间语言代码），然后将其编译（或者它是否被解释？）成一个依赖于平台的代码，称为本机代码。此代码的创建方式可在特定平台上提供无问题且易于执行的方式。但是我对[这里](http://www.scriptol.com/programming/cil.php)给出的源代码到字节码编译阶段的详细描述感到困惑。我的问题是：

1.  为什么 CIL 代码存储在这个程序集、PE 格式和清单中？
2.  这些是什么？
3.  为什么不直接将其转换为本机可执行代码。此外，还提到 CIL 代码被编译为 1) 字节码（被解释为可执行代码）。或 2) 二进制可执行代码。
4.  您能否举例说明 .net 分别应用这两种技术的一些平台？请用简单的术语解释一下。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:28:34.063

PE 格式是 exe 和 dll 的结构。它最初是为本地代码中的东西而设计的。重用它意味着他们不必重写窗口，而是在文件中放置一个“.net标志”，如果设置了它，操作系统会告诉.net运行时间从前端“运行它”（如你双击桌面上的图标，更改是透明的。

您详细说明了 IL 的使命陈述原因，您自己，如果您想了解它的真正含义，请查看 mono 项目。

IL 没有被解释，只有两个编译阶段，一个是 IL（如果你愿意，你可以编写原始 IL）。然后从 IL 到本地。优点很多，但很容易看出有多少 .net 语言。它们都被编译为 .IL，然后每个目标架构（例如 32 / 64 位）都有一个本地 IL。因此，如果您说六种 .net 语言和四种操作系统/体系结构，那就是十个要编写和维护的程序，如果没有 IL，它实际上是 24...

.net 运行时执行所谓的 JIT 编译。您提到的第一个术语是您的汽车装配中的 Car 类，它将 Car 编译为本机代码，然后从那时起使用它。如果您运行该应用程序并且只查看自行车，则不会编译汽车。这很好，但编译可能需要时间，在某些情况下太多了，所以有一个名为 NGEN 的工具可以编译很多。作为安装的一部分，您可以这样做，不再需要 JIT 成本。

在我看来，您提供的关于被解释为 JIT 的链接有点误导。你当然没有理由不能拥有 IL 解释器，但这不是框架所做的。JustInTime 编译，是通常发生的事情。但是，您可以做的是使用一个名为 NGEN 的工具，该工具对 exe / dll 进行完整编译，将 JIT 排除在外。JIT 中固有的延迟不常见但可能会成为一个问题。NGEN 基本上会提前手动编译所有内容，因此您的应用程序不必因编译而延迟。

# python - 杀死 python ffmpeg 子进程会破坏 cli 输出

> ID：10585410
> 
> 赞同：1
> 
> 时间：2012-05-14T14:32:55.453
> 
> 标签：python, ffmpeg, subprocess

我正在尝试使用子进程执行系统命令并读取输出。

但是如果命令需要超过 10 秒，我想杀死子进程。

我已经尝试以多种方式做到这一点。

我最后一次尝试的灵感来自这篇文章：[https ://stackoverflow.com/a/3326559/969208](https://stackoverflow.com/a/3326559/969208)

例子：

```
import os
import signal
from subprocess import Popen, PIPE

class Alarm(Exception):
    pass

def alarm_handler(signum, frame):
    raise Alarm

def pexec(args):

    p = Popen(args, stdout=PIPE, stderr=PIPE)

    signal.signal(signal.SIGALRM, alarm_handler)
    signal.alarm(10)

    stdout = stderr = ''
    try:
        stdout, stderr = p.communicate()
        signal.alarm(0)
    except Alarm:
        try:
            os.kill(p.pid, signal.SIGKILL)
        except:
            pass

    return (stdout, stderr) 
```

问题是：程序退出后，cli 中不会显示任何字符，直到我点击返回。并且点击返回不会给我一个新的线路。

我想这与 stdout 和 stderr 管道有关。

我已经尝试从管道中冲洗和读取（p.stdout.flush()）

我也尝试过不同的 Popen 参数，但可能错过了一些东西。只是想我会在这里保持简单。

我在 Debian 服务器上运行它。

我在这里错过了什么吗？

编辑：

似乎只有在终止正在进行的 ffmpeg 进程时才会出现这种情况。如果 ffmpeg 进程在 10 秒前正常退出，则完全没有问题。

我尝试执行几个不同的命令，这些命令需要超过 10 秒，一个打印输出，一个不打印输出，还有一个 ffmpeg 命令来检查文件的完整性。

```
args = ['sleep', '12s'] # Works fine
args = ['ls', '-R', '/var'] # Works fine, prints lots for a long time
args = ['ffmpeg', '-v', '1', '-i', 'large_file.mov','-f', 'null', '-'] # Breaks cli output 
```

我相信 ffmpeg 使用 \r 打印并在 strerr 管道上打印所有内容。这可能是原因吗？任何想法如何解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:33:57.397

出色地。您的代码在我的 Ubuntu 服务器上肯定可以正常工作。

（我想这是 Debian 的近亲或兄弟）

我添加了几行，以便我可以测试您的代码。

```
import os
import signal
from subprocess import Popen, PIPE

class Alarm(Exception):
    pass

def alarm_handler(signum, frame):
    raise Alarm
def pexec(args):
    p = Popen(args, stdout=PIPE, stderr=PIPE)

    signal.signal(signal.SIGALRM, alarm_handler)
    signal.alarm(1)

    stderr = ''
    try:
        stdout, stderr = p.communicate()
        signal.alarm(0)
    except Alarm:
    print "Done!"
        try:
            os.kill(p.pid, signal.SIGKILL)
        except:
            pass

    return (stdout, stderr)

args = ('find', '/', '-name','*')
stdout = pexec(args)
print "----------------------result--------------------------"
print stdout
print "----------------------result--------------------------" 
```

奇迹般有效。

如果此代码在您的服务器上有效，我想问题实际上在于

您尝试检索数据的命令行应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-17T21:55:28.880

我也有同样的问题。我无法让正在运行的 FFmpeg 从 python 子进程正常终止，所以我正在使用`<process>.kill()`. 但是我认为这意味着 FFmpeg 无法正确恢复 tty 的模式（如此处所述：[https](https://askubuntu.com/a/172747) ://askubuntu.com/a/172747 ）

您可以通过`reset`在 bash 提示符下运行来恢复您的 shell，但这会清除屏幕，因此您在继续工作时看不到脚本的输出。

更好的是运行`stty echo`它会为您的 shell 会话重新打开回显。

你甚至可以在你 nuked FFmpeg 之后在你的脚本中运行它。我在做：

```
ffmpeg_popen.kill()
ffmpeg_popen.wait()
subprocess.call(["stty", "echo"]) 
```

这适用于我在 Ubuntu 上使用 bash 作为我的 shell。YMMV，但我希望它有所帮助。它闻起来很老套，但这是我找到的最好的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-27T00:44:45.123

我遇到了与 ffmpeg 类似的问题。似乎如果使用 Popen.kill() 杀死 ffmpeg，它不会正确关闭并且不会在您的终端上恢复回显。

我们可以使用到标准输入的管道来解决这个问题，并像在 cli 会话中那样编写 q 来关闭 ffmpeg：

```
p = Popen(args, stdin=PIPE stdout=PIPE, stderr=PIPE)
p.stdin.write(b"q") 
```

最好使用 Popen.communicate 以避免死锁。以下也将起作用：

```
p = Popen(args, stdin=PIPE stdout=PIPE, stderr=PIPE)
p.communicate(b'q') 
```

但似乎甚至以下工作：

```
p = Popen(args, stdin=PIPE stdout=PIPE, stderr=PIPE)
p.kill() 
```

如果它有输入管道，我不确定是什么导致这个 ffmpeg 干净地关闭。也许它首先与导致此错误的原因有关？

# php - 如何使用 DOM 显示消息和检索文件名？

> ID：10585412
> 
> 赞同：0
> 
> 时间：2012-05-14T14:33:06.370
> 
> 标签：php, javascript, jquery, ajax, dom

我在下面有一个名为 cancelimage.php 的 php 脚本，它将在其中显示一条取消消息：

```
<?php

$image_file_name = $_GET["imagefilename"];

    echo "$image_file_name Upload was Canceled";

?> 
```

问题是当我单击“取消”按钮时，它不会显示此消息。相反，它显示消息“文件上传期间出错”。我相信这条消息出现的原因是因为我说的是“return stopImageUpload”。

所以我的问题是，我怎样才能像现在一样返回到 stopImageUpload，而是能够显示取消消息而不是现在显示的消息？

以下是我目前尝试解决此问题但失败的尝试。下面显示了取消按钮功能和 stopImageUpload 功能：

```
var cancelimagecounter = 0;
function startImageUpload(imageuploadform, imagefilename) {
    cancelimagecounter++;
    var _cancelimagecounter = cancelimagecounter;
    $('.imageCancel').on("click", function (event) {
        $('.upload_target').get(0).contentwindow
        $("iframe[name='upload_target']").attr("src", "javascript:'<html></html>'");
        jQuery.ajax("cancelimage.php?imagefilename=" + image_file_name).done(function (data) {
            $(".imageemsg" + _cancelimagecounter).html(data);
        });
        return stopImageUpload();
    });
    return true;
}
var imagecounter = 0;
function stopImageUpload(success, imagefilename) {
    var result = '';
    if (success == 1) {
        result = '<span class="imagemsg' + imagecounter + '">The file was uploaded successfully!</span><br/><br/>';
        $('.listImage').eq(window.lastUploadImageIndex).append('<div>' + htmlEncode(imagefilename) + '<button type="button" class="deletefileimage" image_file_name="' + imagefilename + '">Remove</button><br/><hr/></div>');
    } else {
        result = '<span class="imageemsg">There was an error during file upload!</span><br/><br/>';
    }
    return true;
} 
```

下面是取消按钮，假设从 DOM 中检索文件名：

```
<input type='button' name='imageCancel' class='imageCancel' image_file_name='" + imagefilename + "' value='Cancel' /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:37:33.703

问题似乎是这样的：

```
 if (success == 1) { 
```

还有这个：

```
return stopImageUpload(); 
```

stopImageUpdate 有 2 个参数 - 如果您没有成功调用，则第一个成功将是未定义的（不是 1）。修复可能如下所示：

```
return stopImageUpload(0, image_file_name); 
```

并在您的 stopImageUpload 中将 else 更改为：

```
result = '<span class="imageemsg">' + image_file_name + ' Upload Was Cancelled!</span><br/><br/>'; 
```

高温高压

# php - 故意使 PHP 脚本超时

> ID：10585413
> 
> 赞同：5
> 
> 时间：2012-05-14T14:33:06.693
> 
> 标签：php, apache, .htaccess, timeout

这可能看起来很奇怪，但我实际上需要一个会超时的 PHP 脚本，即：花很长时间执行 Apache 会超时脚本并触发 408 错误。

这样做的目的是演示使用自定义 408 错误页面捕获 408 以向数据库报告超时。

您可能会建议有更好的方法来做到这一点？

如果我没记错的话，我认为无限循环不会像 Apache 500 那样工作。

编辑 - - - -

已经指出 408 是客户端错误，那么此外，如果脚本超时，Apache 会触发什么错误？

我想要一个实际的例子而不是一个综合的例子，`header()`因为这是向客户推销的，理想情况下他们会喜欢一个真实的例子。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T14:36:55.070

从 php 脚本发送 408 状态码怎么样？

```
<?php
  header("HTTP/1.0 408 Request Timeout");
?> 
```

也许

```
<?php 
  sleep(99999);
?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-28T09:01:55.333

```
<?php
    while(true){
        //to infinity and beyond...
    }
?> 
```

这会做到的。。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T14:38:53.920

408 是[客户端错误](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)：

> 408 请求超时
> 
> 在服务器准备等待的时间内，客户端没有产生请求。

所以你必须`telnet <yourhost> 80`坐下来等待。当然，[`fsockopen()`](http://php.net/manual/en/function.fsockopen.php)如果您想以编程方式执行此操作，您可以模拟此操作。

从代码中抛出标题也可能有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T14:37:32.450

您不需要页面实际超时。如果你只是在测试，你可以告诉 PHP 在 header 中输出一个 408 代码：

```
<?php
header("HTTP/1.0 408 Request Timeout");
exit; 
```

# jvm - JVM中的“本机缓冲区”是什么意思？

> ID：10585416
> 
> 赞同：1
> 
> 时间：2012-05-14T14:33:18.583
> 
> 标签：jvm, websphere

我从 WebSphere Application Server 的 SystemOut.log 文件中得到以下错误：

```
[5/11/12 8:13:46:291 GMT+08:00] 000063c0 WebApp        E   [Servlet Error]-[ICMResourceManager]: java.lang.OutOfMemoryError: unable to allocate 79683 bytes for native buffer
at java.io.FileOutputStream.writeBytes(Native Method)
at java.io.FileOutputStream.write(FileOutputStream.java:290)
at com.ibm.mm.icmrm.storage.RMOutputStream.write(RMOutputStream.java:65)
at com.ibm.mm.icmrm.storage.RMDataTransfer.copyData(RMDataTransfer.java:150)
at com.ibm.mm.icmrm.storage.filesystem.FileSystem.store(FileSystem.java:104) 
```

似乎是本机OOM问题。我这里有个问题，这里的“**本机缓冲区**”和“**直接字节缓冲区**”一样吗？我可以尝试通过重置属性**XX:MaxDirectMemorySize**来扩大“本机缓冲区”的大小吗？顺便说一句，它的默认值是什么？或者我可以设置这个属性**-Dcom.ibm.nio.DirectByteBuffer.AggressiveMemoryManagement=true**以使本机内存空间动态？

WAS平台信息：

```
WebSphere Platform 6.1 [ND 6.1.0.27 cf270937.16]  running with process name cmrmCell01\cmrmNode01\icmrm1 and process id 1802306
Detailed IFix information: Please use the versionInfo command to view this information
Host Operating System is AIX, version 5.3
Java version = 1.5.0, Java Compiler = j9jit23, Java VM name = IBM J9 VM 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:45:05.657

我知道这不是一个很好的答案，但是看看这篇文章，[了解 JVM 如何在 AIX 上使用本机内存](https://www.ibm.com/developerworks/java/library/j-nativememory-aix/)，是否有任何用处。

# sql-server-2008 - 如何强制插入语句运行而不在值子句中插入任何记录

> ID：10585419
> 
> 赞同：0
> 
> 时间：2012-05-14T14:33:23.080
> 
> 标签：sql-server-2008, sql-server-2005, sql-server-2008-r2

我有一种情况，我有一张下表。

```
 create table Bulk_Data
    (
    id int identity(1,1),
    UserName varchar(100) not null default 'default value ',
    iPartitionID int null
    ) 
```

我在 Bulk_Data 上也有一个插入触发器。

```
create trigger dbo.Bulk_Data_IU on Bulk_Data 
AFTER INSERT  
AS Begin

    Merge Bulk_Data p1 
    using Bulk_Data p2 on p1.id = p2.id
    when matched then 
        update set p1.iPartitionID = right(p2.id,1);

end 
```

上表中的条件就像我有 3 列不依赖于任何值。1] id 是身份自动递增列 2] UserName 设置为默认值 3] iPartitionID 基于触发器中的插入。

所以我的问题是我应该如何插入记录说假设我不需要在#2 中插入任何值，即在第 2 列中，那么我应该如何在表上触发插入命令。

因为插入命令对我很重要，因为我创建了插入触发器。

当我跑步时

```
insert Bulk_Data(UserName) values('Suraj Sheikh') 
```

它工作正常，但如果我不想插入任何用户名怎么办。

这可能吗 ？

请帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:37:02.963

您可以使用计算列而不是更新每个插入的所有行的触发器。

```
create table Bulk_Data
    (
    id int identity(1,1),
    UserName varchar(100) not null default 'default value ',
    iPartitionID as id % 10 persisted
    ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:39:40.520

使用“Instead OF”触发器而不是使用“AFTER INSERT”触发器。

INSTEAD-OF 触发器是 SQL Server 中非常强大的对象。它们允许开发人员转移数据库引擎来执行与用户尝试执行的操作不同的操作。

这样，当对该表触发插入查询时，将不会发生插入，并且触发器中写入的任何语句都将实际应用于 db。

限制 - INSTEAD OF DELETE/UPDATE 触发器不能在具有外键且定义了 DELETE/UPDATE 操作的级联但可以定义插入触发器的表上定义。

# c++ - 使用 extern 声明全局变量

> ID：10585421
> 
> 赞同：3
> 
> 时间：2012-05-14T14:33:32.300
> 
> 标签：c++, visual-studio, linker, extern, unresolved-external

我的问题是在以下情况下：

文件1.h

```
#include "graphwnd.h"
#include "file2.h"

class XXX: 
{
....various things....
protected:
CGraphWnd graph_wnd_sensor1D;
} 
```

文件1.cpp

```
#include "file1.h"
(... various stuff ...)

void main(){
OnInitGraph(&graph_wnd_1_sensor2D, rect_1_sensor2D);
graph_wnd_sensor1D.ShowWindow(SW_HIDE);
myYYY.Init();
}
(... various stuff ...) 
```

**这里 graph_wnd_sensor1D 有一个值并且 ShowWindow 工作**

文件 2.h

```
extern CGraphWnd graph_wnd_sensor1D;
class YYY: 
{
void YYY::Init(){
graph_wnd_sensor1D.ShowWindow(SW_SHOW);
}
....various things....
} 
```

**在这里，在 init 中，应用程序崩溃了，因为 graph_wnd_sensor1D 的信息与前一个不同。**

在文件 2.cpp 中，我想使用 graph_wnd_sensor1D。但视觉产量

```
CMyTabCtrl.obj : error LNK2001: external symbol unresolved "class CGraphWnd graph_wnd_sensor1D" 
```

*   所以想法是让 graph_wnd_sensor1D 成为一个在 file1 中声明的全局变量！我怎么能解决这个问题？*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T14:35:01.130

您只声明了变量，但没有定义变量。在单个实现文件中添加定义。

**文件 2.h**

```
extern CGraphWnd graph_wnd_sensor1D; // declarations 
```

**文件 2.cpp**

```
CGraphWnd graph_wnd_sensor1D; // definition 
```

# python - Django：收集用户、对象活动流

> ID：10585427
> 
> 赞同：3
> 
> 时间：2012-05-14T14:33:55.087
> 
> 标签：python, django, android-activity

我使用 django-activity-stream 模块来收集用户活动。但是当一个用户（user1）跟随另一个（user2）时。

我需要获取以下用户（user2）的活动流并结合按日期和时间排序的所有活动（参见下面的代码）。

而且随着活动列表的增长，我认为我将面临性能和优化问题。我相信有人已经解决了类似的问题。

关于如何使活动生成更有效的任何想法和建议？

```
def build_activity(raw_activity):
    activity = []
    for item in raw_activity:
        action_object = get_action_object(item)
        activity.append({
            'user': User.objects.get(pk=int(item.actor_object_id)),
            'verb': item.verb,
            'action_object': action_object[1],
            'type': action_object[0],
            'timestamp': timesince(item.timestamp),
            'datetime': item.timestamp,
        })
    return activity

def activity_stream(user):
    from actstream.models import actor_stream
    raw_activity = actor_stream(user)
    activity = build_activity(raw_activity)
    for following in Follow.objects.filter(user=user):
        stream = actor_stream(following.target_user)
        activity += build_activity(stream)
    return sorted(activity, key=lambda item:item['datetime'], reverse=True) 
```

谢谢，

苏丹

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-30T12:46:02.427

在 Fashiolista，我们已经开源了我们构建饲料系统的方法。 [https://github.com/tschellenbach/Feedly](https://github.com/tschellenbach/Feedly) 是目前最大的旨在解决这个问题的开源库。认为它还可以解决您的开发时间与过早优化的问题。:)

首先，我将 Redis 作为数据存储。稍后当您的网站变得更大时，迁移到 Cassandra 通常是有意义的。

构建 Feedly 的同一团队还提供了一个托管 API，可以为您处理复杂性。看看[getstream.io](https://getstream.io)目前我们有 Python、Ruby、Node 和 PHP 的客户端 API。此外，由于它基于高度优化的 Cassandra 设置，我们可以将其定价远低于基于 Redis 的自托管解决方案的成本。

另外看看这篇高可扩展性帖子，我们解释了一些涉及的设计决策：http: [//highscalability.com/blog/2013/10/28/design-decisions-for-scaling-your-high-traffic-提要.html](http://highscalability.com/blog/2013/10/28/design-decisions-for-scaling-your-high-traffic-feeds.html)

[本教程](http://www.mellowmorning.com/2013/10/18/scalable-pinterest-tutorial-feedly-redis/)将帮助您使用 Redis 设置像 Pinterest 的提要这样的系统。这很容易上手。

要了解有关提要设计的更多信息，我强烈建议阅读我们基于提要的一些文章：

*   [雅虎研究论文](http://research.yahoo.com/files/sigmod278-silberstein.pdf)
*   [Twitter 2013 基于 Redis](http://highscalability.com/blog/2013/7/8/the-architecture-twitter-uses-to-deal-with-150m-active-users.html)，带有回退
*   [Instagram 上的卡桑德拉](http://planetcassandra.org/blog/post/instagram-making-the-switch-to-cassandra-from-redis-75-instasavings)
*   [Etsy 饲料缩放](http://www.slideshare.net/danmckinley/etsy-activity-feeds-architecture/)
*   [脸书历史](http://www.infoq.com/presentations/Facebook-Software-Stack)
*   [Django 项目](http://justquick.github.com/django-activity-stream/)，具有良好的命名约定。（但仅限数据库）
*   [http://activitystrea.ms/specs/atom/1.0/](http://activitystrea.ms/specs/atom/1.0/)（演员、动词、宾语、目标）
*   [Quora 上关于最佳实践的帖子](http://www.quora.com/What-are-best-practices-for-building-something-like-a-News-Feed?q=news%20feeds)
*   [Quora 扩展社交网络提要](http://www.quora.com/What-are-the-scaling-issues-to-keep-in-mind-while-developing-a-social-network-feed)
*   [Redis 红宝石示例](http://web.archive.org/web/20130525202810/http://blog.waxman.me/how-to-build-a-fast-news-feed-in-redis)
*   [FriendFeed 方法](http://backchannel.org/blog/friendfeed-schemaless-mysql)
*   [Thoonk 设置](http://blog.thoonk.com/)
*   [Twitter的方法](http://www.slideshare.net/nkallen/q-con-3770885)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T14:52:43.040

除非我有一个可验证的性能问题，否则我个人不喜欢过早的优化，因为它经常成为我无休止的疯狂螺旋。您可能会发现这里也是如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-30T15:01:14.847

> 过早的优化是万恶之源。

但是如果我要优化它，我可能会生成另一个流，并且动作的时间戳由 action_object 时间戳设置...... :)

# jquery - JQuery滑块单选按钮不出现

> ID：10585433
> 
> 赞同：0
> 
> 时间：2012-05-14T14:34:07.027
> 
> 标签：jquery, jquery-ui

我一直在尝试遵循此处的示例：[使用 JQuery UI 将单选按钮转换为滑块元素](https://stackoverflow.com/questions/3530652/using-jquery-ui-to-convert-radio-buttons-into-slider-elements)

我试图重新创建示例，但它似乎对我不起作用。我看到的只是单选按钮。

这是我的代码：

```
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title> Test </title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript">

$(".question").each(function() {
    var radios = $(this).find(":radio").hide();
    $("<div></div>").slider({
      min: parseInt(radios.first().val(), 10),
      max: parseInt(radios.last().val(), 10),
      slide: function(event, ui) {
        radios.filter("[value=" + ui.value + "]").click();
      }
    }).appendTo(this);
});
    </script>

</head>
<body>

<div id="question">
  <h2>How long is your hair?</h2>
  <label><input type="radio" name="71" value="98">Short</label>
  <label><input type="radio" name="71" value="99">Medium</label>
  <label><input type="radio" name="71" value="100">Long</label>
</div>

</body>
</html> 
```

谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:12:46.063

你有几个问题：

## 错误的选择器

您的选择器应该是`$('#question')`因为`question`是 的 ID，而`div`不是类。`$('.question')`用于选择`question`类中的元素。您要么更改选择器，要么将元素更改为`<div class="question">`.

## 没有参考 jQuery UI

该`.slider`方法在 'vanilla' jQuery 中不可用，您必须参考 jQuery UI

## JS 代码的“位置”错误

JS 代码在元素重新渲染之前执行。您应该将现有代码嵌入到`$(document).ready`调用中。这里更多[这里](http://api.jquery.com/ready/)。

完成所有更改后，您的代码应如下所示：

```
<html>
<head>
  <script type='text/javascript' src='http://code.jquery.com/jquery-1.7.2.js'></script>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.js"></script>
  <link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/themes/ui-lightness/jquery-ui.css"/>

  <style type='text/css'>
    label { display: block; float: left; text-align: center; width: 33%; }
    .question > div { clear: left; }

  </style>

<script type='text/javascript'>
$(function(){
$(".question").each(function() {
    var radios = $(this).find(":radio").hide();
    $("<div></div>").slider({
      min: parseInt(radios.first().val(), 10),
      max: parseInt(radios.last().val(), 10),
      slide: function(event, ui) {
        radios.filter("[value=" + ui.value + "]").click();
      }
    }).appendTo(this);
});

$("button").click(function() {
    alert($(":radio[name=71]:checked").val());
});

});

</script>

</head>
<body>
  <div class="question">
    <h2>How long is your hair?</h2>
    <label><input type="radio" name="71" value="98">Short</label>
    <label><input type="radio" name="71" value="99">Medium</label>
    <label><input type="radio" name="71" value="100">Long</label>
</div>

</body>

</html>

​ 
```

# tridion - SDL Tridion TOM.NET 文档

> ID：10585437
> 
> 赞同：6
> 
> 时间：2012-05-14T14:34:17.433
> 
> 标签：tridion

我相信，SDL Tridion 的 TOM.NET API 从 R5.3 版本开始替换了已弃用的 TOM（Tridion 对象模型）。

除了询问 Stack Overflow (Exchange) 问题外，在使用和学习 TOM.NET API 时我们应该参考哪些文档？

到目前为止，我发现（需要登录）：

*   [SDL 实时内容](http://sdllivecontent.sdl.com/LiveContent/web/ui.xql?c=t&action=html&resource=publist_home.html#url=http://sdllivecontent.sdl.com:80/LiveContent/web/search.xql?c=t&lang=&action=search&query=tom.net&sid=lcSearch.runSearch1337004624749&eventType=lcContent.loadDocconcept_81E280714DF648C192CA8BB58AF27002&pubid=SDL_Tridion_2011&publang=en-US&resource=82a02077-75a2-4d5d-acaf-63a59829473a.xml&docid=concept_81E280714DF648C192CA8BB58AF27002&filename=AccessingContentItemsTheTOM.xml&query=tom.net&scope=&tid=111cb8fb-cb37-477b-8db3-a3a15b4b4165&inner_id=&addHistory=true)
*   [TridionWorld 下载](https://www.sdltridionworld.com/downloads/documentation/index.aspx)（选择[最新版本，目前](https://www.sdltridionworld.com/downloads/documentation/SDLTridion2011SP1/index.aspx)为 2011 SP1 下载“SDL Tridion 2011 SP1 TOM.NET API”chm）

我看到了这些（加上论坛上的问题），但不知道哪个*更好*。**使用 TOM.NET 时您最常使用什么？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T15:45:32.637

好问题，可能大多数 Tridion 新开发人员可能想知道什么时候使用哪个。我会说这两个文件有不同的目的并且并排。API 文档确实提供了有关方法和用法的信息，SDL Live Content 文档提供的信息更多的是了解您的场景使用什么。当我们加入任何新开发人员时，我们确实会遇到这类问题“哪个文档为我提供了最多的信息”。

我参考这些简单的示例来解释何时使用哪些文档的差异。

1.  包中有哪些变量（vs）从包中读取变量时使用什么 API 方法？

第一个引用[Live Docs](http://sdllivecontent.sdl.com/LiveContent/web/pub.xql?action=home&pub=SDL_Tridion_2011_SPONE&lang=en-US#addHistory=true&filename=PackageVariables.xml&docid=concept_915DDB8970C14E2A91AC0DC1B00BEA79&inner_id=&tid=&query=&scope=&resource=&eventType=lcContent.loadDocconcept_915DDB8970C14E2A91AC0DC1B00BEA79)，第二个引用 API 文档

2.  如何遍历嵌入字段（vs）我使用什么方法遍历嵌入值字段？

第一个参考[Live Docs](http://sdllivecontent.sdl.com/LiveContent/web/pub.xql?action=home&pub=SDL_Tridion_2011_SPONE&lang=en-US#addHistory=true&filename=HandlingEmbeddedFieldsInAComp.xml&docid=concept_E698A4E45364484B8B1EA41E262507B7&inner_id=&tid=&query=&scope=&resource=&eventType=lcContent.loadDocconcept_E698A4E45364484B8B1EA41E262507B7)，第二个参考 API 文档。我看到这个问题几乎每个月都会出现不同的变化。

我知道我使用了简单的用例，但有时保持简单会更好。希望这些信息有所帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-16T06:59:14.370

此外，根据文档中的[此页面](http://sdllivecontent.sdl.com/LiveContent/content/en-US/SDL_Tridion_2011_SPONE/concept_7A5535AA5D124768937506D674FFC102)，TOM.NET API 应仅用于模板和事件处理程序。对于第三方应用程序，您应该使用核心服务 API。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-14T14:51:40.367

我使用 API 文档，当我真的想了解更多时使用 Reflector。但这并不是真正可取的（？）。

# ruby-on-rails - rake db:migrate YAML 解析器错误

> ID：10585449
> 
> 赞同：0
> 
> 时间：2012-05-14T14:35:38.240
> 
> 标签：ruby-on-rails, rake, yaml

我在 Ubuntu 上使用 ruby​​ 1.9.2 和 rake 0.9.2.2。

当我想

```
rake db:migrate 
```

我收到以下错误消息

```
rake aborted!
couldn't parse YAML at line 89 column 16
/usr/local/rvm/rubies/ruby-1.9.2-p318/lib/ruby/1.9.1/psych.rb:148:in `parse'
/usr/local/rvm/rubies/ruby-1.9.2-p318/lib/ruby/1.9.1/psych.rb:148:in `parse_stream'
/usr/local/rvm/rubies/ruby-1.9.2-p318/lib/ruby/1.9.1/psych.rb:119:in `parse'
/usr/local/rvm/rubies/ruby-1.9.2-p318/lib/ruby/1.9.1/psych.rb:106:in `load'
/usr/local/rvm/rubies/ruby-1.9.2-p318/lib/ruby/1.9.1/psych.rb:205:in `load_file'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/i18n-0.6.0/lib/i18n/backend/base.rb:171:in `load_yml'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/i18n-0.6.0/lib/i18n/backend/base.rb:157:in `load_file'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/i18n-0.6.0/lib/i18n/backend/base.rb:15:in `block in load_translations'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/i18n-0.6.0/lib/i18n/backend/base.rb:15:in `each'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/i18n-0.6.0/lib/i18n/backend/base.rb:15:in `load_translations'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/i18n-0.6.0/lib/i18n/backend/simple.rb:57:in `init_translations'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/i18n-0.6.0/lib/i18n/backend/simple.rb:71:in `lookup'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/i18n-0.6.0/lib/i18n/backend/base.rb:26:in `translate'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/i18n-0.6.0/lib/i18n.rb:156:in `block in translate'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/i18n-0.6.0/lib/i18n.rb:152:in `catch'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/i18n-0.6.0/lib/i18n.rb:152:in `translate'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/activerecord-3.1.3/lib/active_record/railtie.rb:102:in `block in <class:Railtie>'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/activesupport-3.1.3/lib/active_support/lazy_load_hooks.rb:34:in `call'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/activesupport-3.1.3/lib/active_support/lazy_load_hooks.rb:34:in `execute_hook'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/activesupport-3.1.3/lib/active_support/lazy_load_hooks.rb:43:in `block in run_load_hooks'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/activesupport-3.1.3/lib/active_support/lazy_load_hooks.rb:42:in `each'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/activesupport-3.1.3/lib/active_support/lazy_load_hooks.rb:42:in `run_load_hooks'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/railties-3.1.3/lib/rails/application/finisher.rb:56:in `block in <module:Finisher>'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/railties-3.1.3/lib/rails/initializable.rb:30:in `instance_exec'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/railties-3.1.3/lib/rails/initializable.rb:30:in `run'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/railties-3.1.3/lib/rails/initializable.rb:55:in `block in run_initializers'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/railties-3.1.3/lib/rails/initializable.rb:54:in `each'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/railties-3.1.3/lib/rails/initializable.rb:54:in `run_initializers'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/railties-3.1.3/lib/rails/application.rb:96:in `initialize!'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/railties-3.1.3/lib/rails/railtie/configurable.rb:30:in `method_missing'
/home/ralv/devapp/config/environment.rb:5:in `<top (required)>'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:240:in `require'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:240:in `block in require'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:223:in `block in load_dependency'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:640:in `new_constants_in'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:223:in `load_dependency'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:240:in `require'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/railties-3.1.3/lib/rails/application.rb:83:in `require_environment!'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/railties-3.1.3/lib/rails/application.rb:193:in `block (2 levels) in initialize_tasks'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'
/usr/local/rvm/rubies/ruby-1.9.2-p318/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/task.rb:176:in `block in invoke_prerequisites'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/task.rb:174:in `each'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/task.rb:174:in `invoke_prerequisites'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/task.rb:157:in `block in invoke_with_call_chain'
/usr/local/rvm/rubies/ruby-1.9.2-p318/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
/usr/local/rvm/gems/ruby-1.9.2-p318/gems/rake-0.9.2.2/bin/rake:33:in `<top (required)>'
/usr/local/rvm/gems/ruby-1.9.2-p318/bin/rake:19:in `load'
/usr/local/rvm/gems/ruby-1.9.2-p318/bin/rake:19:in `<main>'
Tasks: TOP => db:migrate => environment 
```

我可以通过注释掉我的语言环境文件的第 89 行来解决这个问题：

```
open_tasks: %{total} (%{count} offen) 
```

但是每次我想迁移数据库时都这样做很烦人......

问题似乎是第一个百分号前面的空白字符。如果我将线路更改为

```
open_tasks: (%{total} (%{count} offen) 
```

我可以在不堕胎的情况下迁移。

如何避免此解析器错误？

谢谢克里斯蒂安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:42:05.897

您可以将引号用于复杂值

```
open_tasks: "%{total} (%{count} offen)" 
```

# c++ - 如何检查模板参数是否为 2 的幂？

> ID：10585450
> 
> 赞同：17
> 
> 时间：2012-05-14T14:35:39.287
> 
> 标签：c++, templates, c++11, constexpr, static-assert

我想创建一个静态分配**2^N 字节**数组的结构，但我不希望此结构的用户将此大小指定为指数。例子：

```
my_stupid_array<char, 32> a1; // I want this!
my_stupid_array<char, 5> a2; // And not this... 
```

我如何检查此模板参数是否为 2 的幂，**并**通过有关此的好消息警告用户？

我已经能够使用一个简单的模板来检查这一点：

```
template<int N>
struct is_power_of_two {
    enum {val = (N >= 1) & !(N & (N - 1))};
}; 
```

但是，我无法用理智的消息警告用户。有任何想法吗？

**编辑**

修正了模棱两可的例子。

**编辑**

1 确实是 2 的幂。解决了这个问题！:)

**编辑**

使用 BOOST_STATIC_ASSERT，我在 GCC 中收到此代码的编译错误：

```
template<int N>
struct is_power_of_two {
    enum {val = (N >= 1) & !(N & (N - 1))};
    BOOST_STATIC_ASSERT(val);
}; 
```

错误

```
..\main.cpp:29:1: error: invalid application of 'sizeof' to incomplete type 'boost::STATIC_ASSERTION_FAILURE<false>' 
```

[http://ideone.com/cMfEf](http://ideone.com/kyMJ8 "爱迪生")

**编辑**

哦，我明白了。这是断言失败时我应该得到的消息。但这并没有给用户一些理智的信息。:(

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-10-16T09:16:37.310

这些天来，你可以`constexpr`使用[一些小技巧](http://graphics.stanford.edu/~seander/bithacks.html#DetermineIfPowerOf2)

```
constexpr bool is_powerof2(int v) {
    return v && ((v & (v - 1)) == 0);
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-05-14T14:40:52.623

static_assert 救援（仅限 C++11，取消注释 C++03 的 BOOST_STATIC_ASSERT）：

```
#include<iostream>
// #include <boost/static_assert.hpp>

template<int N>
struct is_power_of_two {
    enum {val = N && !(N & (N - 1))};
    static_assert(val, "should use a power of 2 as template parameter");
    // BOOST_STATIC_ASSERT(val); // without C++11 support, won't take a string message
};

int main()
{
        std::cout << is_power_of_two<2>::val << "\n";
        std::cout << is_power_of_two<3>::val << "\n";
} 
```

[C++11 的 Ideone 输出](http://ideone.com/M8K7a)

[C++03 的 Ideone 输出](http://ideone.com/sONFF)

**UPDATE1**：其他想法（我知道你不想要这个，但对于大指数来说要容易得多）：

```
template<int N>
make_power_of_two
{
    enum { val = 1 << N };
};

my_stupid_array<char, make_power_of_two<5>::val > a1; // size 2^5 = 32 
```

**更新2 ：根据@sehe 在聊天中的评论，您也可以为函数执行**此**`constexpr`操作**

 **```
constexpr bool is_power_of_two(int x)
{
    return x && ((x & (x-1)) == 0);
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-05-14T14:41:24.917

您可以使用`static_assert`来提供错误消息：

```
template<int N>
struct is_power_of_two {
    static_assert((N > 1) & !(N & (N - 1)), "Template parameter must be a power of two.");
}; 
```**

# java - 使用 JAXB 编组空值

> ID：10585452
> 
> 赞同：3
> 
> 时间：2012-05-14T14:35:42.340
> 
> 标签：java, tags, null, jaxb, marshalling

我有一个想要编组的 rootObject 类型的 Java 对象。

这个对象看起来像：

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD);
public class rootObject extends Object implements Serializable {

    private static final long serialVersionUID = 1L;

    private typeObject1 Object1;
    private typeObject2 Object2;
    private typeObject3 Object3;
    private typeObject4 Object4;
    private typeObject5 Object5;
    private typeObject6 Object6;

} 
```

那些私有对象也有具有对象的对象，该对象具有具有原始类型的对象等......（biiiiiiiiig层次结构）例如：

```
public class typeObject1 implements Serializable {

    private static final long serialVersionUID = 1L;

    private typeObject1_1 Object1_1;

} 
```

* * *

```
public class typeObject1_1 implements Serializable {

    private static final long serialVersionUID = 1L;

    private int foo;
    private String bar;

} 
```

我想要的只是通过创建所有标签来编组 rootObject 的实例，即使字符串为空/空、对象为空等。应该创建所有标签。

我唯一不想做的就是`@xmlElement(nillable=true)`在每个字段之前的代码中到处放东西（因为我有很多字段......）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:45:15.853

这可以使用[Jboss JAXBIntroductions](https://community.jboss.org/wiki/JAXBIntroductions)来实现。我将引导您完成一个使用[Maven](http://maven.apache.org/)构建的示例。[我已经在 Github 上以 git repo](https://github.com/sahilm/jaxb-intros-example)的形式提供了这个示例的源代码。

## 项目布局

```
.
|-- pom.xml
`-- src
    |-- main
    |   |-- java
    |   |   `-- com
    |   |       `-- sahilm
    |   |           |-- ChildObject.java
    |   |           |-- Main.java
    |   |           `-- RootObject.java
    |   `-- resources
    |       `-- jaxb-intros.xml
    `-- test
        |-- java
        `-- resources 
```

## pom.xml

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.sahilm</groupId>
  <artifactId>jaxb-intros-example</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <name>jaxb-intros-example</name>
  <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <java-version>1.6</java-version>
  </properties>
  <dependencies>
    <dependency>
      <groupId>jboss.jaxbintros</groupId>
      <artifactId>jboss-jaxb-intros</artifactId>
      <version>1.0.2.GA</version>
    </dependency>
  </dependencies>
  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>2.3.2</version>
        <configuration>
          <source>${java-version}</source>
          <target>${java-version}</target>
          <encoding>UTF-8</encoding>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-resources-plugin</artifactId>
        <version>2.5</version>
        <configuration>
          <encoding>UTF-8</encoding>
        </configuration>
      </plugin>
    </plugins>
  </build>
  <repositories>
    <repository>
      <id>jboss-public-repository-group</id>
      <name>JBoss Public Maven Repository Group</name>
      <url>https://repository.jboss.org/nexus/content/groups/public-jboss/</url>
      <layout>default</layout>
      <releases>
        <enabled>true</enabled>
        <updatePolicy>never</updatePolicy>
      </releases>
      <snapshots>
        <enabled>true</enabled>
        <updatePolicy>never</updatePolicy>
      </snapshots>
    </repository>
  </repositories>
</project> 
```

请注意我是如何添加 Jboss Maven 存储库的，因为 jaxb-intros 在 maven Central 中尚不可用。

## jaxb-intros.xml

这是您添加元数据的地方。我们利用正则表达式的力量一次性注释所有字段。

```
<jaxb-intros xmlns="http://www.jboss.org/xsd/jaxb/intros">
  <Class name="com.sahilm.*">
    <XmlAccessorType value="FIELD" />
    <Field name=".+">
      <XmlElement nillable="true" />
    </Field>
  </Class>
</jaxb-intros> 
```

包中所有类中的所有字段`com.sahilm.*`都已标记`nillable`。

## 映射对象

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class RootObject {
    private ChildObject obj1;
    private String obj2;
    private Date obj3;

    // No-arg ctor needed by jaxb
    public RootObject() {
    }

    public RootObject(final ChildObject obj1, final String obj2, final Date obj3) {
        this.obj1 = obj1;
        this.obj2 = obj2;
        this.obj3 = obj3;
    }

} 
```

```
public class ChildObject {
    private String childObj1;
    private BigDecimal childObj2;

    // No-arg ctor needed by jaxb
    public ChildObject() {
    }

    public ChildObject(final String childObj1, final BigDecimal childObj2) {
        this.childObj1 = childObj1;
        this.childObj2 = childObj2;
    }

} 
```

请注意所有字段中都缺少注释。我们已经将它们映射到`jaxb-intros.xml`.

## 主.java

```
final JaxbIntros config = IntroductionsConfigParser.parseConfig(Main.class.getResourceAsStream("/jaxb-intros.xml"));
final IntroductionsAnnotationReader reader = new IntroductionsAnnotationReader(config);
final Map<String, Object> jaxbConfig = new HashMap<String, Object>();
jaxbConfig.put(JAXBRIContext.ANNOTATION_READER, reader);
final JAXBContext jc = JAXBContext.newInstance(new Class[] { RootObject.class, ChildObject.class }, jaxbConfig);
final Marshaller marshaller = jc.createMarshaller();
final RootObject rootObject = new RootObject(new ChildObject("Foobar", null), null, null);
marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
marshaller.marshal(rootObject, System.out); 
```

## 输出

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<rootObject>
    <obj1>
        <childObj1>Foobar</childObj1>
        <childObj2 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
    </obj1>
    <obj2 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
    <obj3 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
</rootObject> 
```

一切顺利！

# python - 绘制行星边界层高

> ID：10585458
> 
> 赞同：0
> 
> 时间：2012-05-14T14:35:59.220
> 
> 标签：python, fortran

我想知道是否有人有一个简单的程序可以在 fortran 90 或 python（或 NCL）的地图（纬度/经度中的二维）上绘制行星边界层高度。我在 F.90 中使用了一个程序，但它不起作用，所以我想与第二个程序进行比较。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:05:38.003

这是一个带有 matplotlib 和 netCDF4 模块的 Python 示例：

```
import matplotlib.pyplot as plt
from netCDF4 import Dataset

nc = Dataset('mydatafile.nc','r')
lon = nc.variables['lon'][:] 
lat = nc.variables['lat'][:] 
pblh = nc.variables['pblh'][:]
nc.close() 

plt.contourf(lon,lat,pblh)
plt.colorbar()
plt.savefig('pblh.png')
ptl.clf() 
```

您可能需要编辑此示例以匹配您的数据，例如文件名、变量名等。

# javascript - 尝试捕获 javascript 意外标识符

> ID：10585462
> 
> 赞同：0
> 
> 时间：2012-05-14T14:36:13.203
> 
> 标签：javascript

我正在尝试识别我在网页中的 javascrip 函数中遇到的错误，所以我添加了

```
function guardarMisDatos() throws Exception {
try{
...
} catch (Exception e){
alert("error: ", e);
} 
```

但是当我打开页面时，chrome web 控制台给了我错误

```
function guardarMisDatos() throws Exception { 
```

并且错误类型是“未捕获的语法错误：意外标识符”错误在哪里？检查第一次单击时未触发该功能的方式是否正确？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T14:37:12.560

它是 JavaScript 而不是 Java。输了`throws Exception`！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T14:50:31.037

您的代码看起来很像 Java，而不是 javaScript。javaScript 中 try/catch 的语法如下：

```
try {
    // do stuff
} catch (e) {
    // something bad happened
} 
```

注意没有`throws`和没有类型`e`（因为 javascript 是松散类型的）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:37:49.597

`throws Exception`从你的函数定义中删除。在 JavaScript 中不需要这个。除此之外，为什么你的函数会抛出异常——你已经捕获了它！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T14:57:06.470

删除“抛出异常”和对“异常”的捕获引用。要知道它是什么类型的异常，请查看 e.name 属性，它将是以下六件事之一：

*   EvalError - eval() 函数中发生错误。
*   RangeError - 发生范围数值的 ut。
*   ReferenceError - 发生了非法引用。
*   SyntaxError - eval() 函数内的代码中出现语法错误。所有其他语法错误都不会被 try/catch/finally 捕获，并且会触发与错误相关的默认浏览器错误消息。要捕获实际的语法错误，您可以使用 onerror 事件。
*   TypeError - 预期变量类型发生错误。
*   URIError - 编码或解码 URI 时发生错误（即：调用 encodeURI() 时）。

这些不是常量，它们是实际的字符串，如`if (e.name.toString()=="TypeError")`错误对象上还有很多其他好东西，请在[http://www.javascriptkit.com/javatutors/trycatch2.shtml阅读更多内容](http://www.javascriptkit.com/javatutors/trycatch2.shtml)

# r - ggplot2 释放边距约束其余部分

> ID：10585463
> 
> 赞同：5
> 
> 时间：2012-05-14T14:36:16.023
> 
> 标签：r, ggplot2

我`facet_grid`非常喜欢，并且经常发现自己将它与`geom_histogram`. 我也喜欢这个`margins=foo`论点，因为您可以看到与聚合组相比的所有分布。问题是当您包含一个边距参数时，它会扩展所有组以满足通常更广泛的边距 y 比例尺，因为您现在拥有所有数据。这意味着所有聚合组的规模要大得多，并且更难发现组之间的差异。所以我对自己说，：self 你可以用 scales 参数解决这个问题，并允许 y 变化“。这个解决方案的问题是现在很难比较聚合组，因为它们都有不同的尺度。我想要的是让边距是免费的，但其他一切都受到限制，就好像天平不是免费的一样。

我在这里展示代码和图片来说明我的意思。如果这不清楚，请询问。

```
#create some data
set.seed(10)
dat <- data.frame(var1=rpois(1000, 20), 
   var2=as.factor(sample(LETTERS[1:4], 1000, replace=T)),
   var3=as.factor(sample(month.abb[1:5], 1000, replace=T)))

ggplot(dat, aes(var1)) + 
geom_histogram() + 
facet_grid(var2~var3) 
```

**这是情节。我喜欢它，因为我可以很容易地比较所有的总分，因为它们的 y 尺度是相同的。但是，如果有边距或非聚合直方图也可以进行比较，那不是很好吗？**

![在此处输入图像描述](../Images/703b6a1638be20b9975c4651de4943b8.png)

```
ggplot(dat, aes(var1)) + 
geom_histogram() + 
facet_grid(var2~var3, margins='var2') 
```

**好的，所以我们将`margins`参数放入，现在我们可以进行比较，但是所有聚合的组直方图都被拉伸到 20，这使得比较它们变得困难（见下图）。好吧，让我们`scales`自由吧。** *这个例子并不可怕，因为数据在我使用的采样方法中分布非常均匀，但在现实生活中，一些单元格只有几个计数，而其他单元格有很多，比较更糟糕*

![在此处输入图像描述](../Images/2b2ec312b23c0812be9fa5615ec99f59.png)

```
ggplot(dat, aes(var1)) + 
geom_histogram() + 
facet_grid(var2~var3, margins='var2', scales="free_y") 
```

**所以这是没有尺度的情节。问题是它们确实对于总分也是免费的，并且比较它们是有问题的（一个是 14ish，一个是 8ish，一个是 7ish）。**

![在此处输入图像描述](../Images/3655a6993439a28814ce3c4945283fa7.png)

那么有没有办法让只是`margins`自由？基本上我想要的是获取创建的第一个图形并从第二个图形拼接边距。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T01:52:34.713

在此期间，这种解决方法会起作用吗？您有重复的标题，但可以删除 x 比例和标签。

```
require(ggplot2)
require(gridExtra)
set.seed(10)
dat <- data.frame(var1=rpois(1000, 20), 
                  var2=as.factor(sample(LETTERS[1:4], 1000, replace=T)),
                  var3=as.factor(sample(month.abb[1:5], 1000, replace=T)))
dat$var4 <- "All"

windows(width=8, height=8)

p1 <- ggplot(dat, aes(var1)) + 
  geom_histogram() + 
  facet_grid(var2~var3) +

p2 <- ggplot(dat, aes(var1)) + 
  geom_histogram() + 
  facet_grid(~var3)

grid.arrange(p1, p2, nrow=2, heights=c(4,1.5)) 
```

![在此处输入图像描述](../Images/f77c720e942752de1c0367ea2a6a8402.png)

您可能已经知道如何从第一个图中删除 x 比例和标签`scale_x_continuous('', breaks = NA)`。

# mysql - 对多个 LEFT JOIN 查询使用 ORDER BY

> ID：10585467
> 
> 赞同：0
> 
> 时间：2012-05-14T14:36:37.773
> 
> 标签：mysql, group-by, sql-order-by, left-join

我有这个很长的查询，我终于开始工作了，但我不能`ORDER BY date_time_added`，这是一个在所有表中除了`user_accounts`和`relationships`表之外的字段。我如何使它正常工作？

```
$sql = "select distinct pb.user_id, pb.Full_name,
tv.why_onsite3, tv.onsite3_id, tv.other_date as onsite3_date, 
tv.user_allowed as tv_user_allowed, np.onsite4_name ,  
np.onsite4_id, np.other_date as onsite4_date, np.user_allowed 
as np_user_allowed, pml.med_name , pml.med_id, pml.other_date 
as pml_date, pml.user_allowed as pml_user_allowed, pl.onsite5_name,
pl.onsite5_test_id, pl.other_date as some_stats_date, pl.user_allowed as   
pl_user_allowed, chlp.problem_name_is , chlp.current_problem_id, 
chlp.other_date as chlp_date, chlp.user_allowed as chlp_user_allowed,
pphl.onsite10_health_prob_id , pphl.onsite10_problem_name_is, 
pphl.other_date as pphl_date, pphl.user_allowed as pphl_user_allowed,
al.onsite_id , al.onsite_name, al.other_date as onsite_date, 
al.user_allowed as al_user_allowed, sl.onsite2_id , sl.onsite2_name, 
sl.other_date as onsite2_date, sl.user_allowed as sl_user_allowed,
hal.onsite6_id , hal.reason_for_admit, hal.other_date as hal_date, 
hal.user_allowed as hal_user_allowed, il.onsite9_id , il.onsite9_name, 
il.other_date as il_date , il.user_allowed as il_user_allowed
from user_accounts pb left join some_stuff tv on pb.user_id = tv.user_id
left join some_onsite4s np on pb.user_id = np.user_id
left join some_med pml on pb.user_id = pml.user_id
left join list_hal hal on pb.user_id = hal.user_id
left join list_for_things il on pb.user_id = il.user_id
left join list_on  sl on pb.user_id = sl.user_id
left join some_all al on pb.user_id = al.user_id
left join some_list  pphl on pb.user_id = pphl.user_id
left join some_stats pl on pb.user_id = pl.user_id
left join some_probs chlp on pb.user_id = chlp.user_id

where (pb.user_id in (select fb.friend_id from relationships fb 
where fb.user_id = '$uid')
or pb.user_id in (select fb1.user_id from relationships fb1 
where fb1.friend_id = '$uid')
)

group by pb.user_id ORDER BY date_time_added DESC LIMIT $startrow, 20"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:48:00.020

在 ORDER BY 子句中，您必须指定您订购的确切列。这意味着您必须为用于排序的列添加前缀，因为您有多个在多个表中称为相同的列。

其他选项是完全重组查询并将 UNION 运算符与多个 SELECT 语句一起使用。每个 SELECT 语句将从一个表中提取一组数据，并从该表中按列对该组进行排序。

解决方案取决于您要输出的数据——数据的上下文。

# java - Android 平板电脑上的 JSONArray 和编码图像

> ID：10585468
> 
> 赞同：0
> 
> 时间：2012-05-14T14:36:37.487
> 
> 标签：java, android, exception, arrays

我的第一个 Android 应用程序有问题。我想使用 cardid 向 PHP 服务器询问名称和图像。这很好用，但是当我尝试拆分我得到的长字符串时，JSONArray 会引发异常。这是我在 Android 设备上使用的方法：

```
public static Object[] getIdCardOwner(String card)
{
    JSONArray jArray;
    String result = null;
    InputStream is = null;
    StringBuilder sb=null;

    ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();

    nameValuePairs.add(new BasicNameValuePair("cardid",card));
    Object returnValue[] = new Object[2];

    try{
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost(SERVER_URL);
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
        HttpResponse response = httpclient.execute(httppost);
        HttpEntity entity = response.getEntity();
        is = entity.getContent();
        }catch(Exception e){
            Log.e("log_tag", "Error in http connection"+e.toString());
       }
   //convert response to string
   try{
         BufferedReader reader = new BufferedReader(new InputStreamReader(is,"utf-8"), 16);
          sb = new StringBuilder();
          sb.append(reader.readLine() + "\n");

          String line="0";
          while ((line = reader.readLine()) != null) {
                         sb.append(line + "\n");
           }
           is.close();
           result=sb.toString();
           }catch(Exception e){
                 Log.e("log_tag", "Error converting result "+e.toString());
           }
   //paring data

   try{
         jArray = new JSONArray(result);
         JSONObject json_data=null;
         for(int i=0;i<jArray.length();i++){
                json_data = jArray.getJSONObject(i);
                returnValue[0] = json_data.getString("name");
                returnValue[1] = json_data.getString("image");
            }
         }
         catch(JSONException e1){
             Log.e("log_tag", "Error converting result "+e1.toString());
         } catch (ParseException e1) {
            e1.printStackTrace();
    }
   return returnValue;
} 
```

这是我在异常发生之前得到的字符串结果：

```
{"0":"4016612622","card":"4016612622","1":"Peter Poulsen","name":"Peter Poulsen","2":"\/9j\/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP\/sABFEdWNreQABAAQAAAAeAAD\/4QMpaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI\/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MCA2MS4xMzQ3NzcsIDIwMTAvMDIvMTItMTc6MzI6MDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUgV2luZG93cyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpGQ0E3OUQyRDlDQkYxMUUxODMyQThCQTQ0RjhFMDFBRiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpGQ0E3OUQyRTlDQkYxMUUxODMyQThCQTQ0RjhFMDFBRiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDQTc5RDJCOUNCRjExRTE4MzJBOEJBNDRGOEUwMUFGIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkZDQTc5RDJDOUNCRjExRTE4MzJBOEJBNDRGOEUwMUFGIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+\/+4ADkFkb2JlAGTAAAAAAf\/bAIQAEAsLCwwLEAwMEBcPDQ8XGxQQEBQbHxcXFxcXHx4XGhoaGhceHiMlJyUjHi8vMzMvL0BAQEBAQEBAQEBAQEBAQAERDw8RExEVEhIVFBEUERQaFBYWFBomGhocGhomMCMeHh4eIzArLicnJy4rNTUwMDU1QEA\/QEBAQEBAQEBAQEBA\/8AAEQgAlgBkAwEiAAIRAQMRAf\/EAHwAAAIDAQEAAAAAAAAAAAAAAAADAgQFAQYBAAMBAQAAAAAAAAAAAAAAAAABAgMEEAABBAEDAwMCBQQDAAAAAAABABECAyExEgRBUSJhEwVxMoGRobEV0UJScjMUJBEAAgICAgMBAQAAAAAAAAAAAAERAiExUQNBEhNxIv\/aAAwDAQACEQMRAD8Are5PONNV02zAf0f80obuwyie4QOBouY6R2+z9WOnVG+xz5DAfUJUpbA85RiPVZ9\/zEIPGsbj3ZgmlOgcI1hKZI8hn1XPckI7jL8HWBL5flzDBo+oSv5DlGJiZu6fqyfZHoeQXhIO4D\/sq1Q8R9Fmcb5Ocd0LySJdexZlpceyFkAYl8IiBzI5kMususkBFkMpMuMgDjIXUIAo\/H86cyKrsy6S\/qrXL5EKaiZddFU4nx9ldgstkABnaMlR5ELudyvYjiNZyegTcSCmCjfybeVY8n9IjQIHEIHk69Hw\/jePTEARc9ZHUq2eDQS5iCl78Gi6eTyUeFyLMVwO1T\/jOXEOYEhevjTCIaIAC4ax2S+jK+KPFWVSjicTEjuuVX28ee+st6L1vI4lNoInEFYXP+KlU86vKHbqFVbp4Znbqayi1xOfVyIf4zH3RVj3Y9l5gTnVMSjghb1N0rqo2Bsj1TaghOSx7o7LnvYcR7fqlefouREtoyPyUjHe6f8AH0QlbT3H5IQB3kcmMKt0fInAHqVZ4FArg8vvnmZ9Vm1Vmd1cZaDyP4LYqwym3Bt1ryXI7QEwMyRBymgsFBskSdkDaoguukeiQ4FzAVW2DgqzPslTGE5E0ea+T4grPuwHjL7gOhUPirjGw0k4kHi\/cLa5NUZwlAjBC88AaOVEtiMltVyoOXsrFkzcXI\/aFIaKMftCkQeiF1CAOxA9\/A0AV2vRUazOVshHXQlTnPlVhxFx6JNZNqOEacJsR2TwayH6rGr50jibBWqr9+I5UtGqcmgJ1R6uuGyJPZUZ2yhmWFSt5Mplokv6JQNuDWnZEpM7IOzqjx6pyL2W7R2fKtTjREARk57oZMyJvLOO4WHy4R9wyGvVa18mPiXHVZPP+8SHUZV02Y9ujR45MqYE9lKP2D6KPH\/4If6hSj9o+iZB3CEIQAm680TJGkmSp\/I3jEQRE9Yh\/wBFYNPvHoW6FSjC+J8YxHqjHBolZrDgpyjypxE5jEvTP6LR+MhZVb5l3Gi7GuZ87ZO3QYTqo6zf6JWcmtKOchzSbJ7AWB6qjyODdXF4Fye2D+qvHJ3apkR7lewgSCiYKdZwY44fI2CVZHuuXiTj8Zarho5sIvIuR26fitQ8OkHSUT6FSjwqwX8pf7F03cj5OZyU6K7DAmwGRIWbz4nDheisiIxYYWLzoGdkYjV0Utknsp\/I3jgezAHURD\/VTIgwYdB+2UuuHtREX9fzUoywFZk1Djg6wQh8oQIdRgP3T2AVamwM3ZMncwRB1UhJfgXXRDAnCs02UGDF86ELJ5UDMMfuOfoqsZciobdxICPXAO8PRtSnUJECTqPuiEgYyySsaNVnJJeUm7OrfG4c6pBy4GWSdQV23o2YW7i0spwlEDH5LO8onfDUajoUwXghwoaNFaR10u+Fk2l+VBu6uW3rPNn\/AKBM9E6oz7Gsfo60jcyhE+IXJ2b5mQwCoxPiFa0c1nNnAx0KLoQI4ZGM8aHKeAS0joq8t2pZgrXHMZw2lNmtHiBdvIppPn0UYc3juHq3btHGrpvL4lV9bSi\/ZdonITqxFqRtiCEeC17eIZwc3j1uK6c6kNkLn8nQSN0ZDrp0Wh7pG6W2smQYqnYDcW2xZtrAYZIr+uEiMOdXadtJEz27KcYyMt2gIyPVN4vEpoidkREy1ICldIRgT1Kh7wLK2U7BkqlZieFbnJoklUTLdMlVVGfY8DBL0UoywlBTicKjEZu+qFF0IAmo1XGmzadDp9EOoWx3RxqMhVA04NOMvciWS27jI0SOByBgS10KvTEd2OqmDerlCYCcjonASPizBMrgAexTPGI3dkmV+sVOWyDKpffuLdl3k3OS5wMhULLskpKpFrByLX6qvHAD66oc2S9FOUC4bQaqtGdpZ0FSicJbEKUThMiGtjHQoOhIQ1+6hKYbGUbUbU5N11c5IRJrPuDT+7+qv1coSiM5VOsBzE9UqyudR3Vlh2TE5q8Gr\/2TE6u6VdzW1KzPft6lLJlI+RdECd2yxZyDMnslSJkWXACdFYppc6IJSbO01EJhiz\/RWBXtiyRYWwOqhs0qtIUYuubU0DCGUyauqe0KYoTNvVCfszP41BBbCEJmpCWuNU3WPmGQhNGdytMVPgqIFb6oQqMx0BU+T+6uUivoUISY0StMm8Q\/qqmTLywhClmtSeFxCFJYIQhIR\/\/Z","image":"\/9j\/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP\/sABFEdWNreQABAAQAAAAeAAD\/4QMpaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI\/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MCA2MS4xMzQ3NzcsIDIwMTAvMDIvMTItMTc6MzI6MDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUgV2luZG93cyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpGQ0E3OUQyRDlDQkYxMUUxODMyQThCQTQ0RjhFMDFBRiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpGQ0E3OUQyRTlDQkYxMUUxODMyQThCQTQ0RjhFMDFBRiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDQTc5RDJCOUNCRjExRTE4MzJBOEJBNDRGOEUwMUFGIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkZDQTc5RDJDOUNCRjExRTE4MzJBOEJBNDRGOEUwMUFGIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+\/+4ADkFkb2JlAGTAAAAAAf\/bAIQAEAsLCwwLEAwMEBcPDQ8XGxQQEBQbHxcXFxcXHx4XGhoaGhceHiMlJyUjHi8vMzMvL0BAQEBAQEBAQEBAQEBAQAERDw8RExEVEhIVFBEUERQaFBYWFBomGhocGhomMCMeHh4eIzArLicnJy4rNTUwMDU1QEA\/QEBAQEBAQEBAQEBA\/8AAEQgAlgBkAwEiAAIRAQMRAf\/EAHwAAAIDAQEAAAAAAAAAAAAAAAADAgQFAQYBAAMBAQAAAAAAAAAAAAAAAAABAgMEEAABBAEDAwMCBQQDAAAAAAABABECAyExEgRBUSJhEwVxMoGRobEV0UJScjMUJBEAAgICAgMBAQAAAAAAAAAAAAERAiExUQNBEhNxIv\/aAAwDAQACEQMRAD8Are5PONNV02zAf0f80obuwyie4QOBouY6R2+z9WOnVG+xz5DAfUJUpbA85RiPVZ9\/zEIPGsbj3ZgmlOgcI1hKZI8hn1XPckI7jL8HWBL5flzDBo+oSv5DlGJiZu6fqyfZHoeQXhIO4D\/sq1Q8R9Fmcb5Ocd0LySJdexZlpceyFkAYl8IiBzI5kMususkBFkMpMuMgDjIXUIAo\/H86cyKrsy6S\/qrXL5EKaiZddFU4nx9ldgstkABnaMlR5ELudyvYjiNZyegTcSCmCjfybeVY8n9IjQIHEIHk69Hw\/jePTEARc9ZHUq2eDQS5iCl78Gi6eTyUeFyLMVwO1T\/jOXEOYEhevjTCIaIAC4ax2S+jK+KPFWVSjicTEjuuVX28ee+st6L1vI4lNoInEFYXP+KlU86vKHbqFVbp4Znbqayi1xOfVyIf4zH3RVj3Y9l5gTnVMSjghb1N0rqo2Bsj1TaghOSx7o7LnvYcR7fqlefouREtoyPyUjHe6f8AH0QlbT3H5IQB3kcmMKt0fInAHqVZ4FArg8vvnmZ9Vm1Vmd1cZaDyP4LYqwym3Bt1ryXI7QEwMyRBymgsFBskSdkDaoguukeiQ4FzAVW2DgqzPslTGE5E0ea+T4grPuwHjL7gOhUPirjGw0k4kHi\/cLa5NUZwlAjBC88AaOVEtiMltVyoOXsrFkzcXI\/aFIaKMftCkQeiF1CAOxA9\/A0AV2vRUazOVshHXQlTnPlVhxFx6JNZNqOEacJsR2TwayH6rGr50jibBWqr9+I5UtGqcmgJ1R6uuGyJPZUZ2yhmWFSt5Mplokv6JQNuDWnZEpM7IOzqjx6pyL2W7R2fKtTjREARk57oZMyJvLOO4WHy4R9wyGvVa18mPiXHVZPP+8SHUZV02Y9ujR45MqYE9lKP2D6KPH\/4If6hSj9o+iZB3CEIQAm680TJGkmSp\/I3jEQRE9Yh\/wBFYNPvHoW6FSjC+J8YxHqjHBolZrDgpyjypxE5jEvTP6LR+MhZVb5l3Gi7GuZ87ZO3QYTqo6zf6JWcmtKOchzSbJ7AWB6qjyODdXF4Fye2D+qvHJ3apkR7lewgSCiYKdZwY44fI2CVZHuuXiTj8Zarho5sIvIuR26fitQ8OkHSUT6FSjwqwX8pf7F03cj5OZyU6K7DAmwGRIWbz4nDheisiIxYYWLzoGdkYjV0Utknsp\/I3jgezAHURD\/VTIgwYdB+2UuuHtREX9fzUoywFZk1Djg6wQh8oQIdRgP3T2AVamwM3ZMncwRB1UhJfgXXRDAnCs02UGDF86ELJ5UDMMfuOfoqsZciobdxICPXAO8PRtSnUJECTqPuiEgYyySsaNVnJJeUm7OrfG4c6pBy4GWSdQV23o2YW7i0spwlEDH5LO8onfDUajoUwXghwoaNFaR10u+Fk2l+VBu6uW3rPNn\/AKBM9E6oz7Gsfo60jcyhE+IXJ2b5mQwCoxPiFa0c1nNnAx0KLoQI4ZGM8aHKeAS0joq8t2pZgrXHMZw2lNmtHiBdvIppPn0UYc3juHq3btHGrpvL4lV9bSi\/ZdonITqxFqRtiCEeC17eIZwc3j1uK6c6kNkLn8nQSN0ZDrp0Wh7pG6W2smQYqnYDcW2xZtrAYZIr+uEiMOdXadtJEz27KcYyMt2gIyPVN4vEpoidkREy1ICldIRgT1Kh7wLK2U7BkqlZieFbnJoklUTLdMlVVGfY8DBL0UoywlBTicKjEZu+qFF0IAmo1XGmzadDp9EOoWx3RxqMhVA04NOMvciWS27jI0SOByBgS10KvTEd2OqmDerlCYCcjonASPizBMrgAexTPGI3dkmV+sVOWyDKpffuLdl3k3OS5wMhULLskpKpFrByLX6qvHAD66oc2S9FOUC4bQaqtGdpZ0FSicJbEKUThMiGtjHQoOhIQ1+6hKYbGUbUbU5N11c5IRJrPuDT+7+qv1coSiM5VOsBzE9UqyudR3Vlh2TE5q8Gr\/2TE6u6VdzW1KzPft6lLJlI+RdECd2yxZyDMnslSJkWXACdFYppc6IJSbO01EJhiz\/RWBXtiyRYWwOqhs0qtIUYuubU0DCGUyauqe0KYoTNvVCfszP41BBbCEJmpCWuNU3WPmGQhNGdytMVPgqIFb6oQqMx0BU+T+6uUivoUISY0StMm8Q\/qqmTLywhClmtSeFxCFJYIQhIR\/\/Z"} 
```

这是我得到的错误：

```
05-14 14:13:00.723: E/log_tag(359): Error converting result org.json.JSONException: Value {"image":"\/9j\/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP\/sABFEdWNreQABAAQAAAAeAAD\/4QMpaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI\/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MCA2MS4xMzQ3NzcsIDIwMTAvMDIvMTItMTc6MzI6MDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUgV2luZG93cyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpGQ0E3OUQyRDlDQkYxMUUxODMyQThCQTQ0RjhFMDFBRiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpGQ0E3OUQyRTlDQkYxMUUxODMyQThCQTQ0RjhFMDFBRiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDQTc5RDJCOUNCRjExRTE4MzJBOEJBNDRGOEUwMUFGIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkZDQTc5RDJDOUNCRjExRTE4MzJBOEJBNDRGOEUwMUFGIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+\/+4ADkFkb2JlAGTAAAAAAf\/bAIQAEAsLCwwLEAwMEBcPDQ8XGxQQEBQbHxcXFxcXHx4XGhoaGhceHiMlJyUjHi8vMzMvL0BAQEBAQEBAQEBAQEBAQAERDw8RExEVEhIVFBEUERQaFBYWFBomGhocGhomMCMeHh4eIzArLicnJy4rNTUwMDU1QEA\/QEBAQEBAQEBAQEBA\/8AAEQgAlgBkAwEiAAIRAQMRAf\/EAHwAAAIDAQEAAAAAAAAAAAAAAAADAgQFAQYBAAMBAQAAAAAAAAAAAAAAAAABAgMEEAABBAEDAwMCBQQDAAAAAAABABECAyExEgRBUSJhEwVxMoGRobEV0UJScjMUJBEAAgICAgMBAQAAAAAAAAAAAAERAiExUQNBEhNxIv\/aAAwDAQACEQMRAD8Are5PONNV02zAf0f80obuwyie4QOBouY6R2+z9WOnVG+xz5DAfUJUpbA85RiPVZ9\/zEIPGsbj3ZgmlOgcI1hKZI8hn1XPckI7jL8HWBL5flzDBo+oSv5DlGJiZu6fqyfZHoeQXhIO4D\/sq1Q8R9Fmcb5Ocd0LySJdexZlpceyFkAYl8IiBzI5kMususkBFkMpMuMgDjIXUIAo\/H86cyKrsy6S\/qrXL5EKaiZddFU4nx9ldgstkABnaMlR5ELudyvYjiNZyegTcSCmCjfybeVY8n9IjQIHEIHk69Hw\/jePTEARc9ZHUq2eDQS5iCl78Gi6eTyUeFyLMVwO1T\/jOXEOYEhevjTCIaIAC4ax2S+jK+KPFWVSjicTEjuuVX28ee+st6L1vI4lNoInEFYXP+KlU86vKHbqFVbp4Znbqayi1xOfVyIf4zH3RVj3Y9l5gTnVMSjghb1N0rqo2Bsj1TaghOSx7o7LnvYcR7fqlefouREtoyPyUjHe6f8AH0QlbT3H5IQB3kcmMKt0fInAHqVZ4FArg8vvnmZ9Vm1Vmd1cZaDyP4LYqwym3Bt1ryXI7QEwMyRBymgsFBskSdkDaoguukeiQ4FzAVW2DgqzPslTGE5E0ea+T4grPuwHjL7gOhUPirjGw0k4kHi\/cLa5NUZwlAjBC88AaOVEtiMltVyoOXsrFkzcXI\/aFIaKMftCkQeiF1CAOxA9\/A0AV2vRUazOVshHXQlTnPlVhxFx6JNZNqOEacJsR2TwayH6rGr50jibBWqr9+I5UtGqcmgJ1R6uuGyJPZUZ2yhmWFSt5Mplokv6JQNuDWnZEpM7IOzqjx6pyL2W7R2fKtTjREARk57oZMyJvLOO4WHy4R9wyGvVa18mPiXHVZPP+8SHUZV02Y9ujR45MqYE9lKP2D6KPH\/4If6hSj9o+iZB3CEIQAm680TJGkmSp\/I3jEQRE9Yh\/wBFYNPvHoW6FSjC+J8YxHqjHBolZrDgpyjypxE5jEvTP6LR+MhZVb5l3Gi7GuZ87ZO3QYTqo6zf6JWcmtKOchzSbJ7AWB6qjyODdXF4Fye2D+qvHJ3apkR7lewgSCiYKdZwY44fI2CVZHuuXiTj8Zarho5sIvIuR26fitQ8OkHSUT6FSjwqwX8pf7F03cj5OZyU6K7DAmwGRIWbz4nDheisiIxYYWLzoGdkYjV0Utknsp\/I3jgezAHURD\/VTIgwYdB+2UuuHtREX9fzUoywFZk1Djg6wQh8oQIdRgP3T2AVamwM3ZMncwRB1UhJfgXXRDAnCs02UGDF86ELJ5UDMMfuOfoqsZciobdxICPXAO8PRtSnUJECTqPuiEgYyySsaNVnJJeUm7OrfG4c6pBy4GWSdQV23o2YW7i0spwlEDH5LO8onfDUajoUwXghwoaNFaR10u+Fk2l+VBu6uW3rPNn\/AKBM9E6oz7Gsfo60jcyhE+IXJ2b5mQwCoxPiFa0c1nNnAx0KLoQI4ZGM8aHKeAS0joq8t2pZgrXHMZw2lNmtHiBdvIppPn0UYc3juHq3btHGrpvL4lV9bSi\/ZdonITqxFqRtiCEeC17eIZwc3j1uK6c6kNkLn8nQSN0ZDrp0Wh7pG6W2smQYqnYDcW2xZtrAYZIr+uEiMOdXadtJEz27KcYyMt2gIyPVN4vEpoidkREy1ICldIRgT1Kh7wLK2U7BkqlZieFbnJoklUTLdMlVVGfY8DBL0UoywlBTicKjEZu+qFF0IAmo1XGmzadDp9EOoWx3RxqMhVA04NOMvciWS27jI0SOByBgS10KvTEd2OqmDerlCYCcjonASPizBMrgAexTPGI3dkmV+sVOWyDKpffuLdl3k3OS5wMhULLskpKpFrByLX6qvHAD66oc2S9FOUC4bQaqtGdpZ0FSicJbEKUThMiGtjHQoOhIQ1+6hKYbGUbUbU5N11c5IRJrPuDT+7+qv1coSiM5VOsBzE9UqyudR3Vlh2TE5q8Gr\/2TE6u6VdzW1KzPft6lLJlI+RdECd2yxZyDMnslSJkWXACdFYppc6IJSbO01EJhiz\/RWBXtiyRYWwOqhs0qtIUYuubU0DCGUyauqe0KYoTNvVCfszP41BBbCEJmpCWuNU3WPmGQhNGdytMVPgqIFb6oQqMx0BU+T+6uUivoUISY0StMm8Q\/qqmTLywhClmtSeFxCFJYIQhIR\/\/Z","2":"\/9j\/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP\/sABFEdWNreQABAAQAAAAeAAD\/4QMpaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI\/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm 
```

谁能告诉我，我做错了什么以及如何解决？

在此先感谢彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:20:21.857

他们为 json_data.getString("image") 提供的数据不是字符串。这是一个图像。

手动检查 JSON。它正在输出图像数据，然后您需要让它们更改 JSON。例如，它应该如下所示：

```
 "src": "Images/theImage.png", 
```

# facebook - 创建 Facebook 应用

> ID：10585476
> 
> 赞同：1
> 
> 时间：2012-05-14T14:36:56.683
> 
> 标签：facebook

我正在为客户建立一个网站。他的业务有一个 Facebook 页面。在他的网站主页上，他想要一个能够从他的企业 Facebook 页面中提取所有更新的提要。

现在，我觉得这很容易实现（也许是这样），但我已经搜索了 Facebook API 以寻找任何简单的方法来做到这一点。我很难理解我应该以哪种方式做到这一点。我已经决定使用 JS 来访问它，但不知道从那里去哪里。

我需要创建一个应用程序吗？如果是这样，我应该选择哪些选项才能访问客户的 Facebook 页面？

如何让我创建的应用程序显示出来，以便用户对其进行授权？我有很多问题，而 Facebook 不太擅长给我答案。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:45:32.757

我建议您只使用 facebook 页面的 RSS 提要。

**例子**

取他的页面 URL 例如

[https://www.facebook.com/pages/Lazery-Attack/6001014870](https://www.facebook.com/pages/Lazery-Attack/6001014870)

去掉 url 末尾的数字，并将其插入 facebook feed URL，例如

[https://www.facebook.com/feeds/page.php?format=rss20&id=6001014870](https://www.facebook.com/feeds/page.php?format=rss20&id=6001014870)

瞧，您现在有了一个 RSS 提要，您可以将其集成到您正在构建的网站中。

**网址细分**

URL按以下方式分解：

[https://www.facebook.com/feeds/page.php?format=](https://www.facebook.com/feeds/page.php?format=) {feedFormat}&id={PageID}

可用的 Feed 格式有：

1.  RSS-RSS20
2.  原子 - atom10
3.  JSON - json

**其他例子**

*原子*

[https://www.facebook.com/feeds/page.php?format=atom10&id=6001014870](https://www.facebook.com/feeds/page.php?format=atom10&id=6001014870)

*JSON*

[https://www.facebook.com/feeds/page.php?format=json&id=6001014870](https://www.facebook.com/feeds/page.php?format=json&id=6001014870)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:41:59.017

看看 facebook API，就在这里：http: [//developers.facebook.com/docs/reference/api/page/](http://developers.facebook.com/docs/reference/api/page/)

你可以在这里试一试：http: [//developers.facebook.com/tools/explorer/ ?method=GET&path=19292868552%2Fposts](http://developers.facebook.com/tools/explorer/?method=GET&path=19292868552%2Fposts)

点赞框： http: [//developers.facebook.com/docs/reference/plugins/like-box/](http://developers.facebook.com/docs/reference/plugins/like-box/)也有可用的最新帖子

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:42:10.670

最简单的方法是在页面上添加一个赞按钮并确保选中“显示流”，因为这将显示所有最近的帖子。您还可以自定义外观（例如宽度、高度等）。

无需应用程序或凌乱的 API 调用！

在这里尝试一下，只需将生成的代码粘贴到您的网页中：http: [//developers.facebook.com/docs/reference/plugins/like-box/](http://developers.facebook.com/docs/reference/plugins/like-box/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T14:44:34.823

不是应用程序，而是 Facebook[页面上的 Facebook 社交插件](https://developers.facebook.com/docs/reference/plugins/like-box/)

# c# - 每个 Web 请求一个 DbContext... 为什么？

> ID：10585478
> 
> 赞同：428
> 
> 时间：2012-05-14T14:37:07.463
> 
> 标签：c#, asp.net, entity-framework, dependency-injection, dbcontext

我一直在阅读很多文章，解释如何设置实体框架`DbContext`，以便使用各种 DI 框架为每个 HTTP Web 请求创建和使用一个。

为什么这是一个好主意？通过使用这种方法，您获得了哪些优势？在某些情况下这是一个好主意吗？`DbContext`在实例化每个存储库方法调用时无法使用这种技术做的事情有哪些？

* * *

## 回答 #1

> 赞同：606
> 
> 时间：2012-05-14T17:59:04.947

> ***注意：这个答案是关于实体框架的`DbContext`，但它适用于任何类型的工作单元实现，例如 LINQ to SQL`DataContext`和 NHibernate 的`ISession`。***

让我们从回应 Ian 开始：`DbContext`为整个应用程序使用单个是一个坏主意。唯一有意义的情况是当您有一个单线程应用程序和一个仅由该单个应用程序实例使用的数据库时。它`DbContext`不是线程安全的，并且由于`DbContext`缓存数据，它很快就会过时。当多个用户/应用程序同时在该数据库上工作时（这当然很常见），这会给您带来各种麻烦。但我希望您已经知道这一点，并且只想知道为什么不将一个新的实例（即短暂的生活方式）`DbContext`注入到任何需要它的人身上。（有关为什么单个`DbContext`- 甚至每个线程的上下文 - 不好的更多信息，请阅读[此答案](https://stackoverflow.com/a/3266481/264697)）。

首先让我说将 a 注册`DbContext`为瞬态可以工作，但通常您希望在某个范围内拥有这样一个工作单元的单个实例。在 Web 应用程序中，在 Web 请求的边界上定义这样的范围是可行的；因此，每个 Web 请求的生活方式。这允许您让一整套对象在同一上下文中运行。换句话说，它们在同一个业务交易中运作。

如果您没有让一组操作在同一上下文中运行的目标，那么在这种情况下，短暂的生活方式是可以的，但有几点需要注意：

*   由于每个对象都有自己的实例，因此每个更改系统状态的类都需要调用`_context.SaveChanges()`（否则更改会丢失）。这会使您的代码复杂化，并为代码添加第二个职责（控制上下文的职责），并且违反了[单一职责原则](https://en.wikipedia.org/wiki/Single_responsibility_principle)。
*   您需要确保实体 [由 a 加载和保存`DbContext`] 永远不会离开此类的范围，因为它们不能在另一个类的上下文实例中使用。这会使您的代码变得非常复杂，因为当您需要这些实体时，您需要通过 id 再次加载它们，这也可能导致性能问题。
*   由于`DbContext`implements `IDisposable`，您可能仍希望 Dispose 所有创建的实例。如果你想这样做，你基本上有两个选择。您需要在调用 后立即在相同的方法中处理它们`context.SaveChanges()`，但在这种情况下，业务逻辑会获得它从外部传递的对象的所有权。第二个选项是在 Http 请求的边界上处理所有创建的实例，但在这种情况下，您仍然需要某种范围来让容器知道何时需要处理这些实例。

另一种选择是*根本不*注入 a `DbContext`。相反，您注入一个`DbContextFactory`能够创建新实例的实例（我过​​去曾经使用过这种方法）。这样，业务逻辑显式地控制上下文。如果可能看起来像这样：

```
public void SomeOperation()
{
    using (var context = this.contextFactory.CreateNew())
    {
        var entities = this.otherDependency.Operate(
            context, "some value");

        context.Entities.InsertOnSubmit(entities);

        context.SaveChanges();
    }
} 
```

这样做的好处是您可以`DbContext`明确地管理生命周期，并且很容易设置它。它还允许您在一定范围内使用单个上下文，这具有明显的优势，例如在单个业务事务中运行代码，并且能够传递实体，因为它们来自同一个`DbContext`.

缺点是您必须在`DbContext`方法之间传递方法（称为方法注入）。请注意，从某种意义上说，此解决方案与“作用域”方法相同，但现在作用域由应用程序代码本身控制（并且可能重复多次）。它是负责创建和部署工作单元的应用程序。由于`DbContext`是在构建依赖图之后创建的，因此无法使用构造函数注入，当您需要将上下文从一个类传递到另一个类时，您需要遵循方法注入。

方法注入并没有那么糟糕，但是当业务逻辑变得更复杂，并且涉及到更多类时，您将不得不将它从方法传递到方法，从类传递到类，这会使代码变得非常复杂（我见过这是过去的）。对于一个简单的应用程序，这种方法就可以了。

由于缺点，这种工厂方法适用于更大的系统，另一种方法可能很有用，那就是让容器或基础设施代码/[组合根](http://blog.ploeh.dk/2011/07/28/CompositionRoot.aspx)管理工作单元的方法。这就是您的问题所涉及的风格。

通过让容器和/或基础设施处理此问题，您的应用程序代码不会因必须创建、（可选）提交和处置 UoW 实例而受到污染，这使业务逻辑保持简单和干净（只是单一职责）。这种方法存在一些困难。例如，您是否 Commit 和 Dispose 实例？

处理一个工作单元可以在 Web 请求结束时完成。然而，许多人*错误地*认为这也是提交工作单元的地方。但是，在应用程序的那个时候，您根本无法确定工作单​​元是否应该实际提交。例如，如果业务层代码抛出了一个在调用堆栈更高层捕获的异常，那么您肯定**不想**提交。

真正的解决方案是再次显式管理某种范围，但这次是在 Composition Root 中进行。[抽象命令/处理程序模式](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=91)背后的所有业务逻辑，您将能够编写一个装饰器，该装饰器可以包装在允许执行此操作的每个命令处理程序周围。例子：

```
class TransactionalCommandHandlerDecorator<TCommand>
    : ICommandHandler<TCommand>
{
    readonly DbContext context;
    readonly ICommandHandler<TCommand> decorated;

    public TransactionCommandHandlerDecorator(
        DbContext context,
        ICommandHandler<TCommand> decorated)
    {
        this.context = context;
        this.decorated = decorated;
    }

    public void Handle(TCommand command)
    {
        this.decorated.Handle(command);

        context.SaveChanges();
    } 
} 
```

这可确保您只需要编写此基础架构代码一次。任何实体 DI 容器都允许您将这样的装饰器配置为以一致的方式包裹所有`ICommandHandler<T>`实现。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2016-12-13T15:10:00.320

微软有两个**相互矛盾**的建议，许多人以完全不同的方式使用 DbContexts。

1.  一个建议是**“尽快处理 DbContexts”** ，因为让 DbContext Alive 占用宝贵的资源，如数据库连接等......
2.  另一个声明**强烈推荐每个请求一个 DbContext**

这些相互矛盾，因为如果您的 Request 做了很多与 Db 无关的事情，那么您的 DbContext 将无缘无故地保留。因此，当您的请求只是在等待随机的事情完成时，让您的 DbContext 保持活动状态是浪费......

如此多的遵循**规则 1的人在他们的****“存储库模式”**中拥有他们的 DbContext，并**为每个数据库查询**创建一个新实例，因此每个请求**X*DbContext**

他们只是获取数据并尽快处理上下文。**许多**人认为这是可以接受的做法。虽然这具有占用数据库资源最短时间的好处，但它显然牺牲了所有**UnitOfWork**和**Caching** candy EF 必须提供的。

让 DbContext的单个**多用途**实例保持活动状态可以最大限度地利用**缓存**的好处，但是由于 DbContext**不是线程安全**的，并且每个 Web 请求都在其自己的线程上运行，因此每个请求的 DbContext 是您可以保留的**最长的时间。**

因此，EF 团队建议每个请求使用 1 个 Db 上下文，这显然是基于这样一个事实，即在 Web 应用程序中，UnitOfWork 很可能在一个请求中，并且该请求有一个线程。因此，每个请求一个 DbContext 就像 UnitOfWork 和缓存的理想优势。

**但**在许多情况下，这是不正确的。我考虑**记录**一个单独的 UnitOfWork，因此在**异步线程**中为 Post-Request Logging 提供一个新的 DbContext是完全可以接受的

所以最后它拒绝了 DbContext 的生命周期仅限于这两个参数。**工作单元**和**线程**

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2015-12-15T23:34:49.117

这里没有一个答案实际上回答了这个问题。OP 没有询问单例/每个应用程序 DbContext 设计，他询问了每个（Web）请求设计以及可能存在的潜在好处。

我将参考[http://mehdi.me/ambient-dbcontext-in-ef6/](http://mehdi.me/ambient-dbcontext-in-ef6/)因为 Mehdi 是一个很棒的资源：

> **可能的性能提升。**
> 
> 每个 DbContext 实例维护其从数据库加载的所有实体的一级缓存。每当您通过其主键查询实体时，DbContext 将首先尝试从其一级缓存中检索它，然后默认从数据库中查询它。根据您的数据查询模式，由于 DbContext 一级缓存，在多个顺序业务事务中重复使用相同的 DbContext 可能会导致进行的数据库查询更少。
> 
> **它启用延迟加载。**
> 
> 如果您的服务返回持久实体（而不是返回视图模型或其他类型的 DTO）并且您希望利用这些实体的延迟加载，则从中检索这些实体的 DbContext 实例的生命周期必须延长商业交易的范围。如果服务方法在返回之前处理了它使用的 DbContext 实例，那么任何对返回的实体进行延迟加载属性的尝试都会失败（是否使用延迟加载是一个好主意是完全不同的争论，我们不会讨论这里）。在我们的 Web 应用程序示例中，延迟加载通常用于由单独的服务层返回的实体的控制器操作方法中。在这种情况下，

请记住，也有缺点。该链接包含有关该主题的许多其他资源。

只是发布这个以防其他人偶然发现这个问题并且没有专注于实际上并没有解决这个问题的答案。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2012-05-14T15:03:57.183

我很确定这是因为 DbContext 根本不是线程安全的。所以分享东西从来都不是一个好主意。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2016-02-25T01:14:45.983

问题或讨论中没有真正解决的一件事是 DbContext 无法取消更改。您可以提交更改，但不能清除更改树，因此如果您使用每个请求上下文，如果您出于任何原因需要丢弃更改，那么您就不走运了。

我个人在需要时创建 DbContext 实例——通常附加到能够在需要时重新创建上下文的业务组件。这样我就可以控制这个过程，而不是把一个实例强加给我。我也不必在每次控制器启动时创建 DbContext，无论它是否实际被使用。然后，如果我仍然想要每个请求实例，我可以在 CTOR 中创建它们（通过 DI 或手动），或者根据需要在每个控制器方法中创建它们。就我个人而言，我通常采用后一种方法来避免在实际不需要时创建 DbContext 实例。

这也取决于你从哪个角度看它。对我来说，每个请求实例从来没有意义。DbContext 真的属于 Http Request 吗？就行为而言，这是错误的地方。您的业​​务组件应该创建您的上下文，而不是 Http 请求。然后，您可以根据需要创建或丢弃您的业务组件，而不必担心上下文的生命周期。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2013-04-08T13:36:22.780

我同意之前的观点。可以说，如果您要在单线程应用程序中共享 DbContext，您将需要更多内存。例如，我在 Azure 上的 Web 应用程序（一个额外的小实例）需要另外 150 MB 的内存，而我每小时大约有 30 个用户。 ![应用程序在 HTTP 请求中共享 DBContext](../Images/47bb7a00edf9b6d527fb6f6b0fc7ea97.png)

这是真实的示例图像：应用程序已在中午 12 点部署

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-05-14T14:58:59.767

我喜欢它的地方在于它将工作单元（如用户所见 - 即页面提交）与 ORM 意义上的工作单元对齐。

因此，您可以使整个页面提交成为事务性的，如果您公开 CRUD 方法并创建一个新的上下文，您就无法做到这一点。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-08-06T18:52:23.850

即使在单线程单用户应用程序中也不使用单例 DbContext 的另一个低调的原因是它使用的标识映射模式。这意味着每次使用查询或通过 id 检索数据时，都会将检索到的实体实例保存在缓存中。下次您检索同一实体时，它将为您提供该实体的缓存实例（如果可用）以及您在同一会话中所做的任何修改。这是必要的，因此 SaveChanges 方法不会以同一数据库记录的多个不同实体实例结束；否则，上下文必须以某种方式合并来自所有这些实体实例的数据。

出现问题的原因是单例 DbContext 可能会成为定时炸弹，最终可能会缓存整个数据库 + 内存中 .NET 对象的开销。

通过仅使用带有`.NoTracking()`扩展方法的 Linq 查询可以解决此问题。这些天PC也有很多RAM。但通常这不是所需的行为。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-03-23T17:04:16.490

另一个需要特别注意 Entity Framework 的问题是当使用创建新实体、延迟加载和使用这些新实体（来自相同上下文）的组合时。如果您不使用 IDbSet.Create（而不是新的），则在从创建它的上下文中检索到该实体时，该实体上的延迟加载将不起作用。示例：

```
 public class Foo {
     public string Id {get; set; }
     public string BarId {get; set; }
     // lazy loaded relationship to bar
     public virtual Bar Bar { get; set;}
 }
 var foo = new Foo {
     Id = "foo id"
     BarId = "some existing bar id"
 };
 dbContext.Set<Foo>().Add(foo);
 dbContext.SaveChanges();

 // some other code, using the same context
 var foo = dbContext.Set<Foo>().Find("foo id");
 var barProp = foo.Bar.SomeBarProp; // fails with null reference even though we have BarId set. 
```

# hibernate - 如果无法修改父类，如何在hibernate中定义继承类型

> ID：10585482
> 
> 赞同：0
> 
> 时间：2012-05-14T14:37:23.680
> 
> 标签：hibernate, inheritance, jpa

问题是这样的，我正在扩展一个通用框架并将其应用于特定的项目，该框架适用于 Spring 和 Hibernate，这里我有两个类，**GenericClient**和**SpecificClient**，它们都是实体，并且**SpecificClient**继承自**GenericClient**。

**GenericClient**是框架的一部分，我不能修改它，因为这个类没有声明`@Inheritance(strategy = InheritanceType.JOINED)`唯一可以使用的继承类型，`InheritanceType.SINGLE_TABLE`因为这是注解的默认值。

目前我的代码正在使用**SpecificClient**`@Inheritance(strategy = InheritanceType.SINGLE_TABLE)`声明，即使它不是继承树的根。

 **由于版本问题我必须找到使用方法`InheritanceType.JOINED`，好在**SpecificClient**永远是继承树的最后一个类，但在不同的项目中可能会有所不同。

*   有什么办法可以`InheritanceType.JOINED`在父类中注入注释吗？
*   有没有什么方法可以声明父类，以便根据特定项目的需要，您可以使用另一种继承？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:42:00.627

您可以使用 XML 来定义此继承树的映射。这是[文档的相关部分](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#inheritance-tablepersubclass)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:43:17.597

如果您无法修改希望 Hiberante 用作实体的类，则可以使用 .hbm.xml 配置文件来执行此操作。这些可以与注释混合，因为所有功能都应该在两者中可用。**

# android - Android注解和单元测试

> ID：10585490
> 
> 赞同：3
> 
> 时间：2012-05-14T14:37:45.433
> 
> 标签：android, unit-testing, code-generation, android-annotations

我在我目前正在处理的示例项目中使用 AndroidAnnotations(2.5)。

由于您可以使用例如`@EActivity`,来注释您的类`@ViewById`，`@Click`这都会导致生成的编译时代码，我想知道如何为任何 Android Annotations 支持的应用程序创建单元测试/功能测试。

我很想听听关于这个问题的一些意见。

干杯，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T15:09:20.450

[我在这里](https://stackoverflow.com/a/10587137/654187)回复了一个类似的帖子。

有几个选项可供您使用。当然，您可以在我声称的更多单元测试风格中测试您的代码预生成。这应该单独测试 Java 代码，最好不涉及生成的代码。

您还可以在生成后测试代码。AA 生成的 MyActivity_ 类可以在编译后直接实例化并进行相应的测试。我声称这正在朝着集成测试风格发展。

虽然，我认为测试总比不测试好，但我认为对于集成测试，您应该在类似于生产的情况下在硬件上进行测试。这使您可以全面了解您的应用程序在现实世界中的行为方式。因此，对于集成测试，我更喜欢高级别的“是否一切都很好”测试。

[Robolectric](http://pivotal.github.com/robolectric/)和[Robotium](http://code.google.com/p/robotium/)可以极大地帮助这两项工作。Robolectric 允许您在单元测试中实例化您的活动，而 Robotium 允许您直接在设备上测试 selenium 样式。

回顾一下，我更喜欢在不生成代码的情况下对我的代码进行大量单元测试，然后进行一些轻量级的集成测试，以确保一切正常工作。

# mysql - MySQL索引创建策略和内部逻辑

> ID：10585494
> 
> 赞同：1
> 
> 时间：2012-05-14T14:38:03.403
> 
> 标签：mysql

这个问题期望对 MySQL 数据库上创建索引的广泛问题有一个通用的答案。

让我们以这个表格为例：

```
CREATE TABLE IF NOT EXISTS `article` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `published` tinyint(1) NOT NULL DEFAULT '0',
  `author_id` int(11) unsigned NOT NULL,
  `modificator_id` int(11) unsigned DEFAULT NULL,
  `category_id` int(11) unsigned DEFAULT NULL,
  `title` varchar(200) COLLATE utf8_unicode_ci NOT NULL,
  `headline` text COLLATE utf8_unicode_ci NOT NULL,
  `content` text COLLATE utf8_unicode_ci NOT NULL,
  `url_alias` varchar(50) COLLATE utf8_unicode_ci NOT NULL,
  `priority` mediumint(11) unsigned NOT NULL DEFAULT '50',
  `publication_date` datetime NOT NULL,
  `creation_date` datetime NOT NULL,
  `modification_date` datetime NOT NULL,
  PRIMARY KEY (`id`)
); 
```

在这样的示例中，可以根据不同的标准执行广泛的查询：

*   类别ID
*   发表
*   发布日期

例如：

```
SELECT id FROM article WHERE NOT published AND category_id = '2' ORDER BY publication_date; 
```

在许多表格中，您可以看到范围广泛的状态字段（如在这里发布）、日期字段或参考字段（如 author_id 或 category_id）。应该选择什么策略来制作索引？

可以根据以下几点进行开发：

*   对可以在查询中使用的每个字段（作为 where 参数或 order by）创建索引，即使这会导致每个表有很多索引？
*   还要在只有一小组值（如布尔值或枚举）的字段上创建索引，这只会将扫描的范围大小减少一个因子（假设 n 是输入的数量并且每个值都是均匀使用的）？
*   我读过 MySQL 5.0 之前的每个请求只使用一个索引，系统如何选择它？（通过选择更严格的一个？）
*   如何处理 OR 语句？
*   这会减慢插入多少？
*   InnoDB/MyISAM 对这个问题有什么改变吗？

我知道 EXPLAIN 语句可用于了解请求是否已优化，但一些具体的理论内容确实比纯粹的经验方法更具建设性！

# java - spring httpinvokerserviceexporter 客户端必须在同一个框架上吗？

> ID：10585496
> 
> 赞同：3
> 
> 时间：2012-05-14T14:38:14.493
> 
> 标签：java, spring, spring-remoting

抱歉，我是 spring 新手，对 httpinvokerserviceexporter 有疑问。我按照教程进行了基本设置：

```
<bean id="urlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="mappings">
            <props>
                <prop key="index.htm">indexController</prop>
                <prop key="hello.htm">test_service</prop>
            </props>
        </property>
    </bean>

    <bean name="test_service" class="org.springframework.remoting.httpinvoker.HttpInvokerServiceExporter">
        <property name="serviceInterface" value="hellohttp.HelloServiceInterface" />
        <property name="service">
            <ref bean="helloService"></ref>
        </property>
    </bean> 
```

只是为了测试我是否工作：我运行 url`http://localhost:8080/hello_spring/hello.htm`并从 glassfish 服务器获得以下堆栈跟踪：

```
WARNING: StandardWrapperValve[hello_spring]: PWC1406: Servlet.service() for servlet hello_spring threw exception
java.io.EOFException
    at java.io.ObjectInputStream$PeekInputStream.readFully(ObjectInputStream.java:2298)
    at java.io.ObjectInputStream$BlockDataInputStream.readShort(ObjectInputStream.java:2767)
    at java.io.ObjectInputStream.readStreamHeader(ObjectInputStream.java:798)
    at java.io.ObjectInputStream.<init>(ObjectInputStream.java:298)
    at org.springframework.core.ConfigurableObjectInputStream.<init>(ConfigurableObjectInputStream.java:64)
    at org.springframework.remoting.rmi.CodebaseAwareObjectInputStream.<init>(CodebaseAwareObjectInputStream.java:97)
    at org.springframework.remoting.rmi.RemoteInvocationSerializingExporter.createObjectInputStream(RemoteInvocationSerializingExporter.java:122)
    at org.springframework.remoting.httpinvoker.HttpInvokerServiceExporter.readRemoteInvocation(HttpInvokerServiceExporter.java:114)
    at org.springframework.remoting.httpinvoker.HttpInvokerServiceExporter.readRemoteInvocation(HttpInvokerServiceExporter.java:95)
    at org.springframework.remoting.httpinvoker.HttpInvokerServiceExporter.handleRequest(HttpInvokerServiceExporter.java:72)
    at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:49)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:790)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:669)
    at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:574)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1542)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722) 
```

那么，这个错误是由我使用浏览器而不是启用 spring 和 java 应用程序引起的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:40:37.897

`HttpInvokerServiceExporter`使用标准的 Java 二进制序列化通过网络从 Java 对象中移动数据。此数据只能由另一端的 Java 客户端（在本例中为 Spring Java 客户端）使用。它旨在成为客户端-服务器设置的服务器端。

您不能只将浏览器指向它，浏览器只会将其视为乱码。

# git - 列出修订 A 和 B 之间的关键 git 提交

> ID：10585498
> 
> 赞同：1
> 
> 时间：2012-05-14T14:38:26.177
> 
> 标签：git, git-log

我试图了解在 git 时空中相距一定距离的两个 git 提交之间的关系。他们都接触了同一段代码，但是其中一个的代码被移到了不同​​的文件中。

我想我想做的是：查看`git log`显示“关键”提交的简化版。最初，这将是修订版 A、修订版 B 以及它们的共同祖先。但是，当我确定其他相关提交时，我也希望能够以类似`git log --graph`格式的方式查看这些提交。

到目前为止的问题：

1.  `git log --all A...B`从 B 开始，显示了许多提交，我不确定它显示的最终提交的意义是什么。（不是A）
2.  我想不出任何方法来过滤掉大量的提交。`--simplify-by-decoration`在其他情况下有帮助，但在这里没有帮助（例如，它不显示我指定的实际提交）。

对不起，如果这不清楚。在你看到之前，要解释那种有用的信息并不容易。

编辑

好的，我会尝试拼写出来。调用目标提交 a123 和 b234，c345 是我确定的另一个“关键提交”，d456 是共同祖先：

```
git log <something>  a123 b234 c345

d456
| |
| c345 <description, diff of key file>
| |
| b234 <...>
|
a123 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:15:31.163

听起来您正在寻找镐（`git log -S"code to search"`）或责备（`git blame -C file`）。

另见：http: [//jfire.io/blog/2012/03/07/code-archaeology-with-git/](http://jfire.io/blog/2012/03/07/code-archaeology-with-git/)

# javascript - 如何访问 javascript 对象的多个属性？

> ID：10585499
> 
> 赞同：-1
> 
> 时间：2012-05-14T14:38:30.567
> 
> 标签：javascript

如果我有数组：

```
my_array = [{a:3,b:4,c:7},{a:5,b:8,c:6}]
property_names = ["a","c"] 
```

如何针对 my_array 使用 property_names 数组来获得以下输出？：

```
subset_array = [[3,7],[5,6]] 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-14T14:39:45.757

```
var my_array = [{a:3,b:4,c:7}, {a:5,b:8,c:6}];
var keys = ['a', 'c'];

my_array.map(function(d){
    return keys.map(function(k) {
        return d[k];
    });
}); 
```

这会给你`[[3, 7], [5, 6]]`，似乎正是你想要的。

* * *

*[过时的初始答案；在OP更新他的问题之前]*

使用`o.a`和`o.c`- 不涉及魔法，也没有小猫受伤！

您也可以使用`[]`语法:`o['a']`和`o['c']`- 但通常只有在您想访问动态属性名称时才使用它（即变量而不是引号内的引号字符串`[]`）

* * *

如果你想要一个包含两个值的数组：

```
var a_and_c = [o.a, o.c]; 
```

现在您可以使用`a_and_c[0]`and`[1]`访问这两个值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T14:40:04.247

您可以通过两种表示法访问属性：

要么`o.a`和`o.c`要么`o['a']`和`o['c']`。

* * *

**编辑**

如果您想创建一个包含这两个值的新数组，那么只需使用 @Reid 建议的代码即可：

```
[o.a, o.c] 
```

* * *

**第二次编辑**

因此，只需在函数内部构建数组，`map`如下所示：

变种过滤器= [“a”，“c”，“f”，“zzz”]；// 应该

子集数组 = my_array.map( 函数 (v){ var newArr = [];

```
for( var i=0; i<filter.length; ++i ) {
  if ( typeof v[ filter[i] ] !== 'undefined' ) {
    newArr.push( v[ filter[i] ] );
  }
}

return newArr; 
```

});

但是，需要注意的一点是，只要您使用原始类型（例如示例中的 int 值），上述代码就会克隆属性。这意味着，如果您`my_array`在某个时间点更改值，`subset_array`则*不会*隐式更改，但您也必须在那里重新创建`subset_array`或调整值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T14:53:14.453

这不是一个完整的答案，但我相信它会有用：

```
var values = []
var obj = {a: 1, b: 2, c: 3}
for (var prop in obj) {
  if (obj.hasOwnValue(prop)) { // skip props in [[prototype]], no effect here
    values.push(obj[prop])
  }
}
values // -> [2, 1, 3] (in SOME UNDEFINED ORDER) 
```

关键点：

1.  迭代对象的 [all] 对象属性名称（但不是 [[prototype]] 链）
2.  从属性名称动态访问值
3.  属性*没有排序*；`values`例如，如果需要，排序

例如，这可以扩展以添加不同的“排除”规则。它也可以适应不同的高阶函数。

快乐编码。

# c# - 使用 JSON.NET 反序列化字典

> ID：10585500
> 
> 赞同：2
> 
> 时间：2012-05-14T14:38:31.607
> 
> 标签：c#, .net, json, json.net, asp.net-web-api

我正在使用带有 4.0.8 版本的 Newtonsoft.Json 并尝试将它与 Web API 一起使用。所以我想反序列化 JSON

```
JsonConvert.DeserializeObject<AClass>(jsonString); 
```

这一直有效，直到我将 Dictionary 作为属性添加到此类并想要反序列化它。

json字符串的形式为

```
{ 
   "Date":null,
   "AString":"message",
   "Attributes":[
                   {"Key":"key1","Value":"value1"},      
                   {"Key":"key2","Value":"value2"}
                ],
    "Id":0,
    "Description":"...
} 
```

当反序列化类型异常时`JsonSerializationException`出现消息：“***无法将 JSON 数组反序列化为类型 'System.Collections.Generic.Dictionary`2[System.String,System.String]'。*** ”

我在这里做错了什么？

**UPDATE1：** 当使用 JSON.NET 进行序列化时，我得到以下字典：

```
Attributes":{"key1":"value1","key2":"value2"} 
```

似乎 WebApi 以不同于 Json.Net 的方式反序列化对象。服务器端我使用以下行进行隐式反序列化：

```
return new HttpResponseMessage<AClass>(object); 
```

**UPDATE2：** 作为一种解决方法，我现在来到以下线路服务器端。

```
return new HttpResponseMessage<string>(JsonConvert.SerializeObject(license).Base64Encode()); 
```

我将其与 Json.Net 服务器端进行转换并将其作为 base64 编码字符串传输。所以 Json.Net 可以反序列化自己的格式。

但它仍然不是我想要的，所以他们有什么进一步的建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:57:54.500

如果您声明`Attributes`为 `List<KeyValuePair<string, string>>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:13:23.013

从[这个帖子](https://stackoverflow.com/questions/5124889/serialize-net-dictionarystring-string-into-json-key-value-pair-object)，打电话

```
JsonConvert.SerializeObject(yourObject, new KeyValuePairConverter()); 
```

以 Web API 为您创建的格式获取 JSON。

因此，人们可能会认为调用

```
JsonConvert.DeserializeObject<AClass>(jsonString, new KeyValuePairConverter()); 
```

将执行相反的操作并正确处理 Web API 的样式。

不过，我不知道这种重载是否存在；试一试，看看会发生什么...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-01T20:21:19.643

```
Dictionary<string, object> result = JsonConvert.DeserializeObject<Dictionary<string, object>>(strJsonResult); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T17:35:13.980

如果是 .NET 4，您可以使用[DataContract](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractattribute.aspx)属性和[DataContractJsonSerializer 类](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.datacontractjsonserializer.aspx)来强制执行消息格式：

```
 [DataContract]
    public class Message
    {
        [DataMember]
        public DateTime? Date { get; set; }
        [DataMember]
        public string AString { get; set; }
        [DataMember]
        public Dictionary<string, string> Attributes { get; set; }
        [DataMember]
        public int Id { get; set; }
        [DataMember]
        public string Description { get; set; }
    }

        DataContractJsonSerializer jsonSerializer = new DataContractJsonSerializer(typeof(Message));

        Message message = null;
        using (MemoryStream jsonStream = new MemoryStream(Encoding.UTF8.GetBytes(jsonString)))
        {
            // Deserialize
            message = (Message)jsonSerializer.ReadObject(jsonStream);

            // Go to the beginning and discard the current stream contents.
            jsonStream.Seek(0, SeekOrigin.Begin);
            jsonStream.SetLength(0);

            // Serialize
            jsonSerializer.WriteObject(jsonStream, message);
            jsonString = Encoding.UTF8.GetString(jsonStream.ToArray());
        } 
```

将其序列化生成以下 JSON：

```
{"AString":"message","Attributes":[{"Key":"key1","Value":"value1"},{"Key":"key2","Value":"value2"}],"Date":null,"Description":"...","Id":0} 
```

# facebook - facebook fanpage - 页面中的导航菜单

> ID：10585501
> 
> 赞同：0
> 
> 时间：2012-05-14T14:38:33.453
> 
> 标签：facebook, facebook-apps, facebook-page

我制作了一个 facebook 粉丝专页，带有一些内部页面 (http://on.fb.me/JP1HGi)

我想在这些内部页面中添加一个导航菜单，这样用户就可以像“迷你网站”一样浏览它们而无需退出 iframe，但是在单击这些菜单按钮（特别是使用 Internet Explorer）后，它会在另一个页面中打开页面窗户; 使用其他浏览器，我们可以浏览“迷你网站”，但在视频页面中，如果我单击菜单按钮，新页面会在另一个窗口中打开

您知道是否可以使用此导航菜单使所有页面都可以查看，而无需退出 iframe？

非常感谢

此致

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:45:22.510

Try this one on the links in the menu:

```
<a href="YOUR_PAGE" target="_self">Videos</a> 
```

# php - AJAX 结果是否会不同步并导致轮询结果出现差异？

> ID：10585502
> 
> 赞同：-1
> 
> 时间：2012-05-14T14:38:38.583
> 
> 标签：php, ajax, settimeout

我正在使用 jQuery、AJAX、PHP 和 mySQL 开发类似于拍卖的功能。

Ajax 每秒访问服务器以获取最新的出价，在此调用期间，我们还从服务器获取剩余时间以使所有参与者保持同步。

我有两个问题：

1) 有时剩余时间会在几分之一秒内闪烁回上一次的值。这可能与异步结果不同步有关吗？

相关代码片段：

```
function dotimer() {
    updateScreen();
    setTimeout('dotimer()',1000);
}

function updateScreen(){
    $.ajax({
        type : 'POST',
        url : 'getinfo.php',
        dataType : 'json',
        data: { /* various params are passed to php */ },
        success : function(data){
            /* other info processed here...*/
            $("#countdowntimer").html(data.secondsremaining);           
        },
        error : function(XMLHttpRequest, textStatus, errorThrown) {}
    });
} 
```

获取信息.php：

```
$return['secondsremaining'] = strtotime($end_time)-strtotime("now");
/* get other infor from database... */
echo json_encode($return); 
```

（setTimeout 和 setInterval 都有相同的结果。）

2）每秒访问数据库是否过多？我看不到确保信息是最新的替代方法。有一个更好的方法吗？拍卖时间相对较短（30 分钟），我们预计参加者不会超过 10 人。

欢迎任何意见/建议，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:23:05.843

我认为这正是你的问题。由于请求是异步的，因此您无法控制它们的执行顺序。您必须同步您的请求并避免多个请求，即，如果没有待处理的请求，您只能执行新请求，否则您无法控制每个请求的回调何时触发。

# android - ANDROID：是否可以通过应用程序（.apk）替换 Android 操作系统的库文件？

> ID：10585504
> 
> 赞同：3
> 
> 时间：2012-05-14T14:38:43.233
> 
> 标签：android, android-ndk, apk, patch, android-source

我们对 Android OS (Froyo) 的“skia”库进行了一些更改，它在模拟器中运行良好。当我们将相应的 .so 文件推送（替换）到设备中时，它也可以工作。

现在我们想向最终用户提供这项服务。是否可以制作人们安装的应用程序（apk）来执行此任务？

如果不可能，那么我们可以向他人提供服务的最佳方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T17:08:43.137

如果您创建了一个对一系列用户有用的有用功能，您可以将补丁提交给 Google 代码审查（您可以在此处阅读如何执行此[操作](http://source.android.com/source/submit-patches.html)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:11:13.527

不幸的是，你不能，除非

*   您是设备制造商（或 Google）

*   您正在开发替换系统映像，或仅针对有根设备

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T15:08:22.710

我相信这只有在应用程序具有 root 访问权限或您自己向用户分发 ROM 时才有可能。

# oracle - 如何复制多行（Oracle）

> ID：10585509
> 
> 赞同：3
> 
> 时间：2012-05-14T14:38:50.957
> 
> 标签：oracle, plsql, cursor

我正在尝试创建一个过程，该过程将复制表的多行（或仅单行）并为每一行插入增加 ID。

我的问题是，在我的过程中，我使用游标选择要复制的行，当我选择该游标中没有 WHERE 条件的所有行时，一切正常。但是当我设置 WHERE 条件以仅选择一行时……什么也没有发生

这是我的程序

```
CREATE OR REPLACE PROCEDURE DuplicateEmployee (p_EmployeeID IN Employee.id%TYPE)
 AS
  p_New_EmployeeID Employee.id%TYPE;
  CURSOR c_DuplicateEmployee IS
    SELECT *
        FROM Employee
        WHERE Employee.id = p_EmployeeID; -- if this line is deleted all content is duplicated
  row_Employee c_DuplicateEmployee%ROWTYPE;
    BEGIN
      FOR myEmployee IN c_DuplicateEmployee LOOP
          p_New_EmployeeID := employee_seq.NEXTVAL;
          INSERT INTO Employee(id, first_name, last_name, start_date, end_date, salary, city, description)
            VALUES(p_New_EmployeeID, myEmployee.first_name, myEmployee.last_name, myEmployee.start_date, myEmployee.end_date, myEmployee.salary, myEmployee.city, myEmployee.description);
      END LOOP;
    COMMIT;
   END DuplicateEmployee; 
```

我知道在这个例子中，选择要复制的主键的过程是没有意义的，但在我的生产基地中，它将用于选择外键。

下面是创建测试表所需的代码和我用于此过程的 SEQUENCE

```
CREATE TABLE Employee
  (
    ID         VARCHAR2(4 BYTE) NOT NULL,
    First_Name VARCHAR2(10 BYTE),
    Last_Name  VARCHAR2(10 BYTE),
    Start_Date DATE,
    End_Date DATE,
    Salary      NUMBER(8,2),
    City        VARCHAR2(10 BYTE),
    Description VARCHAR2(15 BYTE)
  );
INSERT
INTO Employee
    (ID, First_Name, Last_Name, Start_Date, End_Date, Salary, City, Description)
  VALUES
    ('01', 'Jason', 'Martin', to_date('19960725','YYYYMMDD'), to_date('20060725','YYYYMMDD'), 1234.56, 'Toronto', 'Programmer');
INSERT
INTO Employee
    (ID, First_Name, Last_Name, Start_Date, End_Date, Salary, City, Description)
  VALUES
    ('02', 'Alison', 'Mathews', to_date('19760321','YYYYMMDD'), to_date('19860221','YYYYMMDD'), 6661.78, 'Vancouver', 'Tester');
INSERT
INTO Employee
    (ID, First_Name, Last_Name, Start_Date, End_Date, Salary, City, Description)
  VALUES
    ('03', 'James', 'Smith', to_date('19781212','YYYYMMDD'), to_date('19900315','YYYYMMDD'), 6544.78, 'Vancouver', 'Tester');
INSERT
INTO Employee
    (ID, First_Name, Last_Name, Start_Date, End_Date, Salary, City, Description)
  VALUES
    ('04', 'Celia', 'Rice', to_date('19821024','YYYYMMDD'), to_date('19990421','YYYYMMDD'), 2344.78, 'Vancouver', 'Manager');
INSERT
INTO Employee
    (ID, First_Name, Last_Name, Start_Date, End_Date, Salary, City, Description)
  VALUES
    ('05', 'Robert', 'Black', to_date('19840115','YYYYMMDD'), to_date('19980808','YYYYMMDD'), 2334.78, 'Vancouver', 'Tester');
 INSERT
INTO Employee
    (ID, First_Name, Last_Name, Start_Date, End_Date, Salary, City, Description)
  VALUES
    ('06', 'Linda', 'Green', to_date('19870730','YYYYMMDD'), to_date('19960104','YYYYMMDD'), 4322.78, 'New York', 'Tester');
INSERT
INTO Employee
    (ID, First_Name, Last_Name, Start_Date, End_Date, Salary, City, Description)
VALUES
    ('07', 'David', 'Larry', to_date('19901231','YYYYMMDD'), to_date('19980212','YYYYMMDD'), 7897.78, 'New York', 'Manager');
INSERT
INTO Employee
    (ID, First_Name, Last_Name, Start_Date, End_Date, Salary, City, Description)
VALUES
    ('08', 'James', 'Cat', to_date('19960917','YYYYMMDD'), to_date('20020415','YYYYMMDD'), 1232.78, 'Vancouver', 'Tester'); 
```

这里是管理主键（ID）的序列

```
CREATE SEQUENCE "TEST"."EMPLOYEE_SEQ" MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE ORDER NOCYCLE ; 
```

这里是执行程序的代码

```
BEGIN
  employeepackage.duplicateemployee(5);
END; 
```

我真的不明白为什么它在复制所有行时不能正常工作？对少于 2 行的游标有限制吗？

任何帮助将非常感激 ;）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T14:43:00.533

Why do you need a cursor? You can do this with SQL directly:

```
INSERT INTO Employee(id, first_name, last_name, 
                     start_date, end_date, 
                     salary, city, description)
SELECT employee_seq.NEXTVAL, e.first_name, e.last_name,
       e.start_date, e.end_date, 
       e.salary, e.city, e.description
FROM Employee e
WHERE e.id = p_EmployeeID; 
```

Anyway, the actual problem is that your `ID` is a `VARCHAR2(4)`, whereas you think it is a `NUMBER`. You actually do not have an employee with `ID = 5`, but you do have one with `ID = '05'`. So without changing anything, your procedure already works:

```
BEGIN
  employeepackage.duplicateemployee('05');
END; 
```

Of course, it would make sense to change the data type of `ID`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T12:06:25.550

卢卡斯的解决方案如果我的第一个和最后一个表都很好，不需要调用其他程序来复制多个孩子，但对于我使用的中间表：

```
PROCEDURE Duplicate_Company (p_IdCity IN City.IdCity%TYPE) AS
p_New_IdCompany Company.IdCompany%TYPE;
CURSOR c_DuplicateCompany IS
SELECT *
    FROM Company c
    WHERE c.IdCity = p_IdCity; 
row_Company c_DuplicateCompany%ROWTYPE;
BEGIN
  FOR c1 IN c_DuplicateCompany LOOP
      p_New_IdCompany := company_seq.NEXTVAL;
      INSERT INTO Company(IdCompany, IdCity, Name, CreationDate)
        VALUES(p_New_IdCompany, c1.IdCity, c1.Name, c1.CreationDate);
      -- Call the procedure to duplicate current employee
      Duplicate_Employee(c1.IdCompany);
  END LOOP;
END Duplicate_Company; 
```

这是一个好方法吗？

# ruby-on-rails-3 - 如何从其他控制器文件访问控制器方法

> ID：10585512
> 
> 赞同：0
> 
> 时间：2012-05-14T14:38:55.447
> 
> 标签：ruby-on-rails-3, rspec

当我尝试在控制器文件夹外的其他规范文件中访问控制器中定义的`index`, `new`,方法/操作时，它会抛出此错误`edit`

> Rails::RSpec::CoreExampleGroup-NoMethodError

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T10:33:19.210

现在你可以通过添加这个来访问任何规范文件中的控制器方法

`include RSpec::Rails::ControllerExampleGroup`

在规范文件的顶部。

# asp.net - 为什么在我的 ASP.NET Web 服务上会经常调用 Application_Start 方法？

> ID：10585513
> 
> 赞同：2
> 
> 时间：2012-05-14T14:39:02.233
> 
> 标签：asp.net, .net, web-services, application-lifecycle

我有一个在我们的生产环境中运行的 ASP.NET Web 服务（SOAP 样式）。

我们的服务器人员进行了设置，以便通过电子邮件将启动和停止 Windows 服务等内容发送给相关方。

最近我的老板收到了关于我的 ASP.NET Web 服务的电子邮件：

```
The (My Web Service's Name) Application_Start method was called 
```

现在我想这里发生的事情是该服务自从上次调用以来已经过了很长时间，服务器已经从内存中卸载了它，现在它又被重新加载了（使用这个 Web 服务的产品已经不受欢迎了，所以这个不是太牵强的理论）。

然而，我的老板告诉我，他每天“几十次”收到这封电子邮件。

我想我的上述理论仍有可能是准确的，尤其是考虑到它是如何分布在我们 Web 层中的 3-4 台服务器上的，但是对于为什么这种情况可能如此频繁地发生还有其他解释吗？

目前，我不知道`Application_End`电话是否通过类似的电子邮件发送，或者比例是多少。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:07:48.667

当超出[<processModel>](http://msdn.microsoft.com/en-us/library/7w2sway1.aspx)中的某些设置时，可以下载应用程序。***idleTimeout***可能是您的情况，但也可能是***requestLimit***和***memoryLimit***。

另外，这是基于一个真实的故事，如果您启动任何线程，在单独的线程池线程中运行任何东西，或者使用 TPL，请确保您捕获任何可能引发的异常。这些线程中未捕获的异常将杀死工作进程。检查 Windows 事件日志中的应用程序日志。如果是这种情况，您应该会在电子邮件发出的同时看到红色图标应用程序错误标志。

# html - sencha touch 2 html5 canvas drawimage blu 图像分辨率

> ID：10585517
> 
> 赞同：0
> 
> 时间：2012-05-14T14:39:28.113
> 
> 标签：html, canvas, sencha-touch-2

当我使用`drawImage`函数在 html5 画布内绘制图像时遇到问题；与代码一起使用 Sencha Touch 2 图像看起来很蓝，并且它们没有高度质量，这是代码：

```
 //We've added a third and final item to our tab panel - scroll down to see it
var index=0;
Ext.application({
    name: 'Sencha',
    launch: function() {
        var panel = Ext.create("Ext.Panel", {
            fullscreen: true,

            items: [
                {
                    title: 'Home',
                    iconCls: 'home',
                    cls: 'home',                            

                    width: '533px',
                    listeners: {
                    painted: function() {

                    var a={Source:'images/2.tiff',Titre:'T1',Description:'D1'};
                    var b={Source:'images/Im2.jpg',Titre:'T1',Description:'D1'};
                    var c={Source:'images/Im3.jpg',Titre:'T1',Description:'D1'};
                    var d={Source:'images/Im4.jpg',Titre:'T1',Description:'D1'};
                    var e={Source:'images/Im5.jpg',Titre:'T1',Description:'D1'};
                    var f={Source:'images/Im6.jpg',Titre:'T1',Description:'D1'};

                    var img = new Image();
                    var img1 = new Image();
                    var img2 = new Image();

                    img.src = "images/Im1.jpg";
                    img1.src = "images/Im2.jpg";
                    img2.src = "images/Im3.jpg";
                    var ImageP = new Image();  
                    //********************
                    var x,y,Dim_Image,espacement;
                    Dim_Image=50;
                    espacement=30;

                    var Presentation=new Array();
                        Presentation[0]=a;
                        Presentation[1]=b;
                        Presentation[2]=c;
                        Presentation[3]=d;
                        Presentation[4]=e;
                        Presentation[5]=f;
                    //********************

                    //°°°°°°°°°°°°°°°°°°°°°°
                    /* Ici on teste le tableau*/
                    var testImage = new Array();
                    //cw-(i*espacement),i*espacement,Dim_Image,Dim_Image);
                    var j=0;
                    for(i=index;i<index+3;i++)
                    {

                        testImage[i]= new Image();
                        testImage[i].src=Presentation[i].Source;        
                        testImage[i].onload  = function()
                        {
                        context.drawImage(testImage[j],cw-80-(j*espacement),20+j*espacement,Dim_Image,Dim_Image);
                        j++;
                        }

                    }index = index +1;

                    var img = new Image();
                    var canvas = document.getElementById('mycanvas'); 
                        var context = canvas.getContext("2d");
                        var cw = canvas.width;
                        var ch = canvas.height;
                        //Event================================================================
                        canvas.addEventListener("mousedown" ,function(event){

                        testImage = new Array();
                        context.clearRect(0,0,300,300); // clear canvas  
                        var j=0;var inf =index;var ss;
                        for(i=index;i<index+3;i++)
                        {

                            testImage[i-index]= new Image();

                            testImage[i-index].src=Presentation[i].Source;  
                            if( i == index+2)
                            {alert("index +3");
                            testImage[i-index].onload  = function()
                            {context.globalAlpha=1; 
                            context.drawImage(testImage[j],cw-80-(j*espacement),20+j*espacement,Dim_Image,Dim_Image);

                            j++;
                            }
                           }
                           else{
                            testImage[i-index].onload  = function()
                            {context.globalAlpha=0.5; 
                            context.drawImage(testImage[j],cw-80-(j*espacement),20+j*espacement,Dim_Image,Dim_Image);

                            j++;
                            }
                           }

                        }
                        index=index+1;
                        context.stroke();
                        },false);

                        context.strokeStyle = 'black';
                        context.stroke();
                    //};
                    },
                    scope: this
                    },
                    html: [
                      ' <canvas id="mycanvas" style="background-color:grey; width:100%; height:100%;">no canvas support</canvas>'
                    ]
                }            //this is the new item
            ]
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T09:51:25.833

你到底想达到什么目的？

也许问题与您使用的 drawImage 方法类型有关

看看这个链接如何使用，以及你添加的参数到底意味着什么。

问题可能是您这边的宽高比、宽度、高度计算。 [http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage)

# assetic - Assetic：编写器不会在调试模式下生成所有文件

> ID：10585518
> 
> 赞同：1
> 
> 时间：2012-05-14T14:39:32.277
> 
> 标签：assetic

我正在尝试将资产与 Twig（在 Zend 上）连接起来。debug=false 似乎可以正常工作，但我无法理解它对开发的作用。

基本上，当调用这个时：

```
{% javascripts 'static/js/*.js' %}
    <p>{{asset_url}}</p>
{% endjavascripts %} 
```

它输出生成的 javascript 文件名列表（这很好）：

```
js/d19cc07_part_1_jquery-1.7.2.min_6.js
js/d19cc07_part_1_jquery.cookie_7.js
js/d19cc07_part_1_jquery.jeditable.mini_8.js 
```

但这些文件不是由 Writer 生成的（它只生成 js/d19cc07.js）。对于 debug=false 它只输出一个文件名并正确呈现它。

那么我在这里错过了什么？

这是我初始化它的方式：

```
 //Assetic
    $factory = new \Assetic\Factory\AssetFactory(APP_BASE_PATH . '/public/');
    $factory->setDebug(true);
    $am = new \Assetic\Factory\LazyAssetManager($factory);

    //enable loading assets from twig templates
    $loader = new \Twig_Loader_Filesystem(array());
    $loader->addPath(APP_BASE_PATH.'/application/templates/default');

    //Init twig
    $twig = new \Twig_Environment($loader);
    $twig->addExtension(new \Assetic\Extension\Twig\AsseticExtension($factory));

    $am->setLoader('twig', new \Assetic\Extension\Twig\TwigFormulaLoader($twig));

    $templates = array('/index/index.html'); //An array containing full paths to my templates

    foreach ($templates as $template) {
        $resource = new \Assetic\Extension\Twig\TwigResource($loader, $template);

        $am->addResource($resource, 'twig');
    }

    //Writer
    $writer = new \Assetic\AssetWriter(APP_BASE_PATH . '/public/static/assetic');
    $writer->writeManagerAssets($am);

    echo $twig->render('index/index.html'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T20:28:50.760

我最终将 Symfony 控制台连接到我的 Zend 项目，并稍微采用了资产的 DumpCommand 来完成这项工作（通过传递我的 DI 容器版本和分配的 AsseticManager）。

# wpf - 当 Stretch 设置为 None 时，WPF 中的图像控件会拉伸图像

> ID：10585522
> 
> 赞同：4
> 
> 时间：2012-05-14T14:39:46.537
> 
> 标签：wpf, image, stretch

我在显示 16x16 图标的网格中有一个图像控件。但由于某种原因，即使我设置了属性，它仍然是 16x16，它看起来被拉伸了。

![在此处输入图像描述](../Images/a8ff5620833b154376c4f373a5da20c2.png)

代码 ：

```
<UserControl x:Class="ChatControls.UserListItem"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" d:DesignHeight="28" d:DesignWidth="132">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="24" MinWidth="24" MaxWidth="24" />
            <ColumnDefinition Width="171*" />
        </Grid.ColumnDefinitions>
        <Image Name="imgIcon" Source="/ChatControls;component/Images/NormalUser.png" VerticalAlignment="Center" HorizontalAlignment="Center" Stretch="None" />
        <Label Content="Muhammad[A]" Grid.Column="1" Name="lblNick" VerticalContentAlignment="Center" Padding="8,5,5,5" />
    </Grid>
</UserControl> 
```

这有什么原因吗？

更新 1：

是的，在运行时也是:(

![在此处输入图像描述](../Images/ed94d7175b3942dd1dbe0c44fe9b77fc.png)

提前谢谢了。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-14T18:48:15.987

实际上，我经常使用 PNG 图像看到这种情况。似乎PNG的默认分辨率为72dpi，而WPF中的默认屏幕分辨率为96dpi。WPF 尝试通过渲染缩放到其像素大小的 133% 的 png 位图来考虑这一点，这在技术上是正确的，但通常不是用户想要的。您可以使用 gif 或 jpg 代替，也可以将图像与 LayoutTransform 组合，将其缩放到其大小的 0.75，或者只坚持显式设置图像控件的大小。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T15:29:58.470

我发现我经常必须明确指定控件的and`Width`才能让它们正确显示：`Height``Image`

```
<Image 
  Name="imgIcon" 
  Source="/ChatControls;component/Images/NormalUser.png" 
  VerticalAlignment="Center" 
  HorizontalAlignment="Center" 
  Width="16" 
  Height="16" 
/> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-14T16:05:52.543

首先，您对 171* 的 XAML 定义有点奇怪。你最好的方法是这样做：

```
<Grid.ColumnDefinitions>
  <ColumnDefinition Width="24" />
  <ColumnDefinition Width="*" />
</Grid.ColumnDefinitions> 
```

您需要查看[XAML 布局传递](http://msdn.microsoft.com/en-us/library/ms745058.aspx)以了解它在做什么。

其次，因为您使用的是动态图像源（作为 URI 加载），它将被流式传输，因此第一次布局传递期间的宽度将为 24，但在图像流式传输后，控件将动态调整大小。如果要强制调整大小，最好的办法是使用图像周围的边框作为 0 宽度容器。像这样

```
 <Border Grid.Column="0" Grid.Row="0" BorderThickness="0" BorderBrush="Black">
    <!-- UniformToFill: Scale to completely fill output area.
         Aspect ratio is preserved. Cropping may occur.-->
    <Image  
      Source="sampleImages/gecko.jpg" 
    Stretch="UniformToFill" />
  </Border> 
```

在图像周围强制设置宽度和高度是一种简写方式。您可能想要做的另一件事是显式定义源图像的加载方式，如下所示：

```
<Image Width="200">
 <Image.Source>
  <BitmapImage DecodePixelWidth="200"  
   UriSource="C:\Documents and Settings\All Users\Documents\My Pictures\Sample Pictures\Water Lilies.jpg" />
  </Image.Source>
 </Image> 
```

它不会加载完整的图像，但会在加载之前调整大小，而不是动态调整。如需进一步参考，请查看[http://msdn.microsoft.com/en-us/library/ms748873.aspx](http://msdn.microsoft.com/en-us/library/ms748873.aspx)

我同意接受的答案，但我不认为它解释了原因，它只是解释了它的工作原理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-07T06:22:36.123

这是因为图像像素取决于屏幕分辨率，它应该是独立于设备的，以便在任何屏幕分辨率上保持相同所以使用它来这样做。

```
<Image Width = "24" Height = "24" RenderOptions.BitmapScalingMode="NearestNeighbor" RenderOptions.EdgeMode="Aliased" Stretch = "None"/> 
```

用图像的原始大小替换 Width 和 Height 这将对您有所帮助

# linux - 使用 sed、awk 和 xargs 切片 3TB 日志文件？

> ID：10585523
> 
> 赞同：0
> 
> 时间：2012-05-14T14:39:49.770
> 
> 标签：linux, sed, awk, xargs

我需要对几 TB 的日志数据进行切片，并且更喜欢命令行的速度。我会在处理之前将文件分成块，但需要删除一些部分。

**以下是格式示例：**

```
uuJ oPz eeOO    109 66  8
uuJ oPz eeOO    48  0   221
uuJ oPz eeOO    9   674 3
kf iiiTti oP    88  909 19
mxmx lo uUui    2   9   771
mxmx lo uUui    577 765 27878456 
```

*前 3 个字母数字字符串之间*的间隔是空格。之后的一切都是标签。行用 分隔 `\n`。

**我只想保留每组中的最后一行。**

如果组中只有 1 行，则应保留。

**这是预期的输出：**

```
uuJ oPz eeOO    9   674 3
kf iiiTti oP    88  909 19
mxmx lo uUui    577 765 27878456 
```

我如何使用 sed、awk、xargs 和朋友来做到这一点，或者我应该只使用更高级别的东西，比如 Python？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:50:06.020

```
awk -F '\t' '
  NR==1 {key=$1} 
  $1!=key {print line; key=$1} 
  {line=$0}
  END {print line}
' file_in > file_out 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T14:59:32.317

尝试这个：

```
awk 'BEGIN{FS="\t"}
    {if($1!=prevKey) {if (NR > 1) {print lastLine}; prevKey=$1} lastLine=$0}
    END{print lastLine}' 
```

它保存最后一行并仅在它注意到密钥已更改时打印它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T22:59:09.013

这可能对您有用：

```
 sed ':a;$!N;/^\(\S*\s\S*\s\S*\)[^\n]*\n\1/s//\1/;ta;P;D' file 
```

# ruby-on-rails - 未初始化的常量 Spree::User::DestroyWithOrdersError

> ID：10585524
> 
> 赞同：0
> 
> 时间：2012-05-14T14:39:50.403
> 
> 标签：ruby-on-rails, spree

我是与 Spree 合作的新手，基本上做了以下工作：

git 克隆了 git hub 存储库并创建了一个新项目。然后我查看了核心文件夹并获取了我需要的所有文件。我这样做的原因纯粹是因为我希望自定义 Spree 并进行一些更改。我进行了捆绑安装并尝试执行捆绑执行 rake db:reset 并遇到了我一直试图解决的错误。我查看了以下文件

--> /`home/dj/.rvm/gems/ruby-1.9.2-p290/gems/spree_auth 1.1.0/app/controllers/spree/admin/admin_users_controller_decorator.rb`如下所示：[Pastie](http://pastie.org/3910163)。我还发现了Ryan Biggs 评论过的以下 github issue [github issue 。](https://github.com/spree/spree/issues/1155)我试过这个，但没有运气。

我在这里做错了什么。

> 未初始化常量 Spree::User::DestroyWithOrdersError /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/spree_auth-1.1.0/app/controllers/spree/admin/admin_users_controller_decorator.rb:3:in
> 
> `block in <top (required)>' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/spree_auth-1.1.0/app/controllers/spree/admin/admin_users_controller_decorator.rb:2:in` class_eval' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/spree_auth-1.1.0/app/controllers/spree/admin/admin_users_controller_decorator.rb:2:in `<top (required)>' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/spree_auth-1.1.0/lib/spree/auth/engine.rb:13:in` block in activate' /home/ dj/.rvm/gems/ruby-1.9.2-p290/gems/spree_auth-1.1.0/lib/spree/auth/engine.rb:12:in `glob' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/spree_auth-1.1.0/lib/spree/auth/engine.rb:12:in` activate' /home/dj/.rvm/gems/ruby- 1.9.2-p290/gems/activesupport-3.2.3/lib/active_support/callbacks.rb:451:in `_run__1016855746__prepare__693579178__callbacks' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.3/lib/active_support/callbacks.rb:405:in` __run_callback' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2 .3/lib/active_support/callbacks.rb:385:in `_run_prepare_callbacks' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.3/lib/active_support/callbacks.rb:81:in` run_callbacks'/home/dj/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.3/lib/action_dispatch/middleware/reloader。 rb:74: `prepare!' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.3/lib/action_dispatch/middleware/reloader.rb:48:in` 准备中！/home/dj/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.3/lib/rails/application/finisher.rb:47:in`block in <module:Finisher>' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.3/lib/rails/initializable.rb:30:in` instance_exec' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.3/lib/rails/initializable.rb:30:in `run' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.3/lib/rails/initializable.rb:55:in` block in run_initializers' /home/dj/.rvm /gems/ruby-1.9.2-p290/gems/railties-3.2.3/lib/rails/initializable.rb:54:in `each' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.3/lib/rails/initializable.rb:54:in` run_initializers' /home/dj/.rvm/gems/ruby-1.9.2-p290/ gems/railties-3.2.3/lib/rails/application.rb:136:in `initialize!' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.3/lib/rails/railtie/configurable.rb:30:in`method_missing' /home/dj/Desktop/my_store/config/environment.rb:5:in `<top (required)>' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.3/lib/rails/application.rb:103:in` require_environment！' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.3/lib/rails/application.rb:292:in `block (2 levels) in initialize_tasks' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:205:in` call' /home/dj/.rvm/gems/ruby -1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:200:in` each' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/rake- 0.9.2.2/lib/rake/task.rb:200:in `execute' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:158:in` 阻止invoke_with_call_chain' /home/dj/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:151:in` invoke_with_call_chain' /home/dj/.rvm/gems/ruby -1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:176:in `block in invoke_prerequisites' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:174:in` each' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/rake- 0.9.2.2/lib/rake/task.rb:174：invoke_with_call_chain'/home/dj/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/monitor.rb:201 `invoke_prerequisites' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:157:in` 中的块:in `mon_synchronize' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:151:in` invoke_with_call_chain' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:116:in` invoke_task' /home/dj/.rvm /gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:94:in` each' /home/dj/.rvm/gems/ruby-1.9.2-p290/ gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:133:in` standard_exception_handling' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:66:in` block in run' /home/dj/.rvm /gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling' /home/dj/.rvm/gems/ruby-1.9.2-p290/gems/rake-0.9.2.2/lib/rake/application.rb:63:in` run' /home/dj/.rvm/gems/ruby-1.9.2-p290/ gems/rake-0.9.2.2/bin/rake:33:in `<top (required)>' /home/dj/.rvm/gems/ruby-1.9.2-p290/bin/rake:19:in` load' /home/dj/.rvm/gems/ruby-1.9.2-p290/bin/rake:19:in `' 任务：TOP => db :reset => 环境

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T23:19:47.640

DJ,

安装 Spree 的推荐方法是：

```
$ gem install rails -v 3.2.3
$ gem install spree
$ rails new my_store
$ spree install my_store 
```

您不想将文件直接复制到您的应用程序中。[http://guides.spreecommerce.com/customization.html](http://guides.spreecommerce.com/customization.html)有一些很好的资源来定制您的网站。

[http://speakerdeck.com/u/jsqu99/p/spreeconf-2012-introducing-spree-10](http://speakerdeck.com/u/jsqu99/p/spreeconf-2012-introducing-spree-10)很好地解释了 Spree 应用程序的结构。

# python - Python 3.X 玩转互联网

> ID：10585525
> 
> 赞同：1
> 
> 时间：2012-05-14T14:39:51.653
> 
> 标签：python, authentication, browser, python-3.2

我正在做一个小项目来帮助我的工作更快地进行。我目前有一个用 Python 3.2 编写的程序，它为我完成了几乎所有的体力劳动，但有一个例外。我需要登录公司网站（用户名和密码），然后选择月份和年份，然后单击下载。我想写一个小程序来帮我做，这样整个过程完全由程序来完成。

我已经研究过了，我只能找到 2.X 的工具。我研究了 urllib，我知道一些 2.X 模块现在在 urllib.request 中。

我什至找到了一些代码来启动它，但是我对如何将它付诸实践感到困惑。

这是我发现的：

```
import urllib2

theurl = 'http://www.someserver.com/toplevelurl/somepage.htm'

username = 'johnny'
password = 'XXXXXX'
# a great password

passman = urllib2.HTTPPasswordMgrWithDefaultRealm()
# this creates a password manager
passman.add_password(None, theurl, username, password)
# because we have put None at the start it will always
# use this username/password combination for  urls
# for which `theurl` is a super-url

authhandler = urllib2.HTTPBasicAuthHandler(passman)
# create the AuthHandler

opener = urllib2.build_opener(authhandler)

urllib2.install_opener(opener)
# All calls to urllib2.urlopen will now use our handler
# Make sure not to include the protocol in with the URL, or
# HTTPPasswordMgrWithDefaultRealm will be very confused.
# You must (of course) use it when fetching the page though.

pagehandle = urllib2.urlopen(theurl)
# authentication is now handled automatically for us 
```

全部归功于 Michael Foord 和他的页面：[基本身份验证](http://www.voidspace.org.uk/python/articles/authentication.shtml)

所以我稍微改变了代码，用 'urllib.request' 替换了所有的 'urllib2'

然后我学会了如何打开网页，确定程序应该打开网页，使用登录名和密码数据打开页面，然后我将学习如何从中下载文件。

```
ie = webbrowser.get('c:\\program files\\internet explorer\\iexplore.exe')
ie.open(theurl) 
```

（我知道资源管理器是垃圾，只是用它来测试然后我将使用 crome ；））

但这不会打开输入登录数据的页面，它只是打开页面，就像您输入了 url 一样。

如何使用密码句柄打开页面？我有点理解迈克尔是如何制作它们的，但我不确定使用哪个来实际打开网站。

还有一个事后的想法，我可能需要研究 cookie 吗？

谢谢你的时间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:19:26.380

你在这里搞糊涂了。 `webbrowser`是您实际网络浏览器的包装器，并且`urllib`是 http 和 url 相关内容的库。他们彼此不认识，并且服务于非常不同的目的。

在以前的 IE 版本中，您可以像这样在 URL 中编码 HTTP Basic Auth 用户名和密码： `http(s)://Username:Password@Server/Ressource.ext`- 我相信 Firefox 和 Chrome 仍然支持，IE 杀死了它：http: [//support.microsoft.com/kb/834489/EN-我们](http://support.microsoft.com/kb/834489/EN-US)

如果您想*模拟*浏览器，而不仅仅是*打开*一个*真实*的浏览器，请查看`mechanize`：[http ://wwwsearch.sourceforge.net/mechanize/](http://wwwsearch.sourceforge.net/mechanize/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:05:30.867

您的浏览器对您在 python 中完成的身份验证一无所知（这与您的浏览器是否垃圾无关）。该`webbrowser`模块只是提供了启动浏览器并将其指向网络浏览器的便捷方法。您不能将您的凭据“传输”到浏览器。

至于从 python2 迁移到 python3：该`2to3`工具可以自动转换像您这样的简单脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:06:58.450

它们不在同一个环境中运行。

当您单击下载按钮时，您需要弄清楚到底发生了什么。使用浏览器的开发工具获取网站使用的 POST 格式。然后在 python 中构建一个请求来获取文件。

[Requests](http://docs.python-requests.org/en/latest/index.html)是一个很好的库，可以更轻松地完成这类事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-14T12:17:35.267

我会使用 selenium，这是来自一个小脚本的一些代码，我已经破解了一些代码给你一个想法：

```
def get_name():
user = 'johnny'
passwd = 'XXXXXX'
try : 

    driver = webdriver.Remote(desired_capabilities=webdriver.DesiredCapabilities.HTMLUNIT)
    driver.get('http://www.someserver.com/toplevelurl/somepage.htm')
    assert 'Page Title' in driver.title
    username = driver.find_element_by_name('name_of_userid_box')
    username.send_keys(user)
    password = driver.find_element_by_name('name_of_password_box')
    password.send_keys(passwd)
    submit = driver.find_element_by_name('name_of_login_button')
    submit.click()
    driver.get('http://www.someserver.com/toplevelurl/page_with_download_button.htm')
    assert 'page_with_download_button title' in driver.title
    download = driver.find_element_by_name('download_button')
    download.click()
except :

    print('process failed') 
```

我是 python 新手，所以这可能不是每个编写的最好的代码，但它应该给你一个大致的想法。

希望能帮助到你

# visual-studio-2008 - Team Explorer 2008 不会安装在 VS2008 的 Win 7 64 位上

> ID：10585530
> 
> 赞同：0
> 
> 时间：2012-05-14T14:40:07.567
> 
> 标签：visual-studio-2008, team-explorer

我正在尝试在 Windows 7 64 位上安装 Team Explorer。每次我运行安装程序时，它都会出错，我在日志中找到以下内容：

```
 Microsoft Visual Studio 2008 Shell (integrated mode): ***ERRORLOG EVENT*** : Component Microsoft Visual Studio 2008 Shell (integrated mode) returned an unexpected value. 
```

不确定它是如何返回错误的

我尝试修补VS，但没有好处。可能是因为我没有进行默认安装吗？（我喜欢删除我知道我不会使用的非 c# 语言和其他选项）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T19:09:20.880

发现了问题，显然即使我对我的机器有管理员访问权限，2008 年的 Team Explorer 也不这么认为（VS 2005、2008、SQL 2008 和 VS TE 2005 都安装了没有抱怨）。我刚刚结束右键单击并选择“以管理员身份运行”

# objective-c - plist 中的 nsarray 无法返回键值

> ID：10585531
> 
> 赞同：0
> 
> 时间：2012-05-14T14:40:08.707
> 
> 标签：objective-c, nsarray, plist

我正在使用以下代码遍历 plist 以找到一个字符串，然后我想使用键的值 - 不幸的是，分数和数字有些东西不起作用，我无法弄清楚

任何帮助将不胜感激

```
 NSString *theNumber = @"0.0075";

    BOOL found = NO;
    NSUInteger f;
    for (f = 0; f < [selectorKeysFractions count]; f++) {
        NSString * stringFromArray = [selectorKeysFractions objectAtIndex:f];
        if ([theNumber isEqualToString:stringFromArray]) {
            found = YES;
            break;
        }
    }
    if ( found ) {

        // do found
        //this line fails with unrecognised selector message          
        NSLog(@"%@",[[selectorKeysFractions objectAtIndex:f]objectForKey:@"fraction"]);

    } else {
        // do not found

    } 
```

我的 plist 数据看起来像这样

```
<plist version="1.0">
<dict>
<key>fraction</key>
<string>1/128</string>
<key>number</key>
<string>23.78</string>
</dict>
<dict>
<key>fraction</key>
<string>1/234</string>
<key>number</key>
<string>25</string>
</dict>
</plist> 
```

我正在像这样设置数组

```
 NSString *path2 = [[NSBundle mainBundle] pathForResource:@"Fractions" ofType:@"plist"];
 pickerData2 =[[NSDictionary alloc]initWithContentsOfFile:path2];
 selectorKeysFractions = [[NSArray alloc] initWithArray:[pickerData2 allKeys]]; 
```

我做错了什么，但无法弄清楚请帮忙

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:48:27.077

您将消息“objectForKey”发送到 NSString 的对象。您必须请求您的 NSDictionary 才能获得正确的条目。

检查这个：

```
NSLog(@"%@",[pickerData2 objectForKey:[selectorKeysFractions objectAtIndex:f]]); 
```

这应该返回您的字符串。

# bash - sql*loader上传数据后通过存储过程处理数据

> ID：10585532
> 
> 赞同：0
> 
> 时间：2012-05-14T14:40:17.117
> 
> 标签：bash, unix, stored-procedures, commit, sql-loader

我写了一个 .sh 脚本，它应该通过 sql*loader 从文件上传数据，然后运行应该继续上传数据的存储过程。

```
#!/bin/bash
ORACLE_HOME=/opt/app/oracle/product/10.2.0/db_1
export ORACLE_HOME
PATH=$PATH:$ORACLE_HOME/bin
export PATH
export ORACLE_SID=RSK

sqlldr userid=MY_SCHEME/PASS@MY_SID control=!_control_file.ctl LOG=upload.log errors=100

# SQl procedures start  
sqlplus -s MY_SCHEME@RSK/PASS<<end
# Procedure which transport data from stage tables to table_procedure_1
execute MY_SCHEME.procedure_1();
commit;
execute MY_SCHEME.procedure_2(); 
commit;
end

#exit from .sh script
exit; 
```

结果我上传了数据，但 MY_SCHEME.procedure_1() 没有继续上传数据。上传后似乎没有数据提交。请帮我coorect我的scipt。谢谢你。

ps当我使用sql * plus（不是来自.sh scirpt）运行程序时，它工作正常。

它可以正常工作：

```
sqlplus scheme/pass@database<<end
SET SERVEROUTPUT ON                       
begin                                     
  dbms_output.put_line ('Running procedure 1');
  proc1();
  COMMIT; 
  dbms_output.put_line('procedure completed');
end;
/ 
exit
end 
```

谢谢大家！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T06:36:02.430

您的问题可能与 sqlplus 命令行有关。你`sqlplus -s user@schema/password`在需要的时候使用`sqlplus user/password@schema `。
当然`-s`，使 sqlplus 完全静音的开关并没有真正的帮助。

此外，您应该`EXIT`在 SQLplus 脚本中包含一个命令（在 eof 行之前）。

# android - 我需要帮助才能使用 android cam 并了解 logcat

> ID：10585533
> 
> 赞同：1
> 
> 时间：2012-05-14T14:40:17.257
> 
> 标签：android, camera, logcat

我在理解崩溃的应用程序的 logcat 时遇到问题。（我是一个初学者，我的应用程序只是拍了一张照片，然后将其保存在一个特定的文件夹中，但是当我点击应该允许我拍照的按钮时，它崩溃了，我收到了著名的消息（ MY_APP_Name 没有响应）

这是 MySurfaceView.java 中的代码

```
package android.cam_bouton_save;

private SurfaceHolder holder;
private Camera camera;

public MySurfaceView(Context context, Camera camera)
{
    super(context);
    this.camera = camera;
    holder = getHolder();
    holder.addCallback(this);
    holder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
}

public void surfaceChanged(SurfaceHolder holder, 
        int format, int weight, int height)
{
    if (holder.getSurface() == null)
        return;
    try
    {
        camera.stopPreview();
        camera.setPreviewDisplay(holder);
        camera.startPreview();
    }
    catch (Exception e){}
}

public void surfaceCreated(SurfaceHolder holder)
{
    try
    {
        camera.setPreviewDisplay(holder);
        camera.startPreview();
    }
    catch (IOException e){}
}

public void surfaceDestroyed(SurfaceHolder holder){} 
```

}

这是日志猫：

```
05-14 17:15:04.216: E/AndroidRuntime(1123): FATAL EXCEPTION: main
05-14 17:15:04.216: E/AndroidRuntime(1123): java.lang.NullPointerException
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.cam_bouton_save.MySurfaceView.surfaceCreated(MySurfaceView.java:42)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.SurfaceView.updateWindow(SurfaceView.java:532)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.SurfaceView.dispatchDraw(SurfaceView.java:339)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.ViewGroup.drawChild(ViewGroup.java:1638)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1367)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.ViewGroup.drawChild(ViewGroup.java:1638)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1367)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.ViewGroup.drawChild(ViewGroup.java:1638)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1367)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.View.draw(View.java:6743)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.widget.FrameLayout.draw(FrameLayout.java:352)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.ViewGroup.drawChild(ViewGroup.java:1640)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1367)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.ViewGroup.drawChild(ViewGroup.java:1638)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1367)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.View.draw(View.java:6743)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.widget.FrameLayout.draw(FrameLayout.java:352)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at com.android.internal.policy.impl.PhoneWindow$DecorView.draw(PhoneWindow.java:1842)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.ViewRoot.draw(ViewRoot.java:1407)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.ViewRoot.performTraversals(ViewRoot.java:1163)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1727)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.os.Handler.dispatchMessage(Handler.java:99)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.os.Looper.loop(Looper.java:123)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at android.app.ActivityThread.main(ActivityThread.java:4627)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at java.lang.reflect.Method.invokeNative(Native Method)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at java.lang.reflect.Method.invoke(Method.java:521)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
05-14 17:15:04.216: E/AndroidRuntime(1123):     at dalvik.system.NativeStart.main(Native Method) 
```

你能帮我吗？

```
 package android.cam_bouton_save;
      public void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        setContentView(R.layout.main);

        Button bouton = (Button) findViewById(R.id.btn_photo);
    //  camera = Camera.open();
        mySurfaceView = new MySurfaceView(this, camera);
        final FrameLayout myPreview = (FrameLayout) findViewById(R.id.preview);
        myPreview.addView(mySurfaceView);

        bouton.setOnClickListener(new View.OnClickListener()  {
      //  @Override
         public void onClick(View actuelView)   {
            /* //camera.open();
            // camera.getParameters();*/

            camera = Camera.open();

        /*   camera = Camera.open();
             Parameters parameters = camera.getParameters();
             parameters.setPictureFormat(PixelFormat.JPEG);
             camera.setParameters(parameters);
            // camera.setPreviewDisplay(surfaceHolder);
             camera.startPreview();*/
            camera.takePicture(shutterCallback, rawCallback, myPictureCallback_JPG);
         } 
      });

    }

      // Called when shutter is opened
      ShutterCallback shutterCallback = new ShutterCallback() {
          public void onShutter() {
             //Log.d(TAG, "onShutter'd");
      }
    };

        PictureCallback rawCallback = new PictureCallback() {
            public void onPictureTaken(byte[] data, Camera camera) {
      } 
    };

        PictureCallback myPictureCallback_JPG = new PictureCallback(){
            public void onPictureTaken(byte[] arg0, Camera arg1) {

                int imageNum = 0;
                Intent imageIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);

                //Gets the Android external storage directory
                File imagesFolder = new File(Environment.getExternalStorageDirectory(), "Punch");
                imagesFolder.mkdirs(); // <----
                String fileName = "image_" + String.valueOf(imageNum) + ".jpg";
                File output = new File(imagesFolder, fileName);
                while (output.exists()){
                    imageNum++;
                    fileName = "image_" + String.valueOf(imageNum) + ".jpg";
                    output = new File(imagesFolder, fileName);
                }
                Uri uriSavedImage = Uri.fromFile(output);
                imageIntent.putExtra(MediaStore.EXTRA_OUTPUT, uriSavedImage);

                OutputStream imageFileOS;
                try {
                    imageFileOS = getContentResolver().openOutputStream(uriSavedImage);
                    imageFileOS.write(arg0);
                    imageFileOS.flush();
                    imageFileOS.close();

                    Toast.makeText(Cam_bouton_save_picActivity.this, 
                            "Image saved: ", 
                            Toast.LENGTH_LONG).show();
                    camera.release() ;
                } catch (FileNotFoundException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

         //       camera.startPreview();
            }};
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:44:56.177

Your LogCat says you are getting a `NullPointerException` in line 36 of your activity class, inside the `onClick` method: m `Cam_bouton_save_picActivity.java:36`.

Just a guess, but perhaps your `Camera` instance is null. This occurs most often because of a missing permission in the `androidManifest.xml`, so please make sure you've included it:

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

Also note, that if you want to save the photos taken to the SD card, you'll need an other permission as well:

```
<uses-permission android:name="android.permission.CAMERA" /> 
```

**Edit 1**: Thans for the code!

Now it is obvious, that you need to initialize your `camera` member! Without initializing it that's the weak point that ends up in a `NullPointerException`.

In your `onCreate` method you should have this line:

```
camera = Camera.open(); 
```

If performed correctly, you won't get the NPE anymore.

**Edit 2**: For a camera preview: -removed-

**Edit 3**: Please -in future- ask new questions if you are facing a new problem and need help, instead of modifying your existing question. This answer already has nothing to do with your original question.

Keep in mind, that StackOverflow is about answers to specific problems, not about solving all the problems of particular people.

Here is a small and very focused sample application that shows how you can take consecutive camera shots and save them on the sd card:

```
public class AndroidCamera extends Activity implements 
    SurfaceHolder.Callback, View.OnClickListener
{
    private static final String TAG = "CS";
    private Camera camera;
    private SurfaceView surface;
    private SurfaceHolder holder;
    private boolean isPreview = false;

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
        surface = (SurfaceView) findViewById(R.id.preview);
        holder = surface.getHolder();
        holder.addCallback(this);
        holder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);

        final Button shotButton = (Button) findViewById(R.id.btn_shot);
        shotButton.setOnClickListener(this);
    }

    @Override
    public void onClick(View v)
    {
        camera.takePicture(shutterCallback, rawCallback, jpgCallback);
    }

    ShutterCallback shutterCallback = new ShutterCallback()
    {
        @Override
        public void onShutter()
        {}
    };

    PictureCallback rawCallback = new PictureCallback()
    {
        @Override
        public void onPictureTaken(byte[] arg0, Camera arg1)
        {}
    };

    PictureCallback jpgCallback = new PictureCallback()
    {
        @Override
        public void onPictureTaken(byte[] arg0, Camera arg1)
        {
            if (Environment.MEDIA_MOUNTED.equals(Environment.getExternalStorageState()))
            {
                final String imageDir =
                        Environment.getExternalStorageDirectory() + 
                        File.separator + "Punch" + File.separator;
                int counter = 0;
                String imageName = "image_" + counter + ".jpg";
                File outputFile = new File(imageDir, imageName);
                if (!outputFile.getParentFile().exists())
                    outputFile.getParentFile().mkdirs();
                while (outputFile.exists())
                {
                    counter++;
                    imageName = "image_" + counter + ".jpg";
                    outputFile = new File(imageDir, imageName);
                }
                Uri uriSavedImage = Uri.fromFile(outputFile);
                OutputStream imageFileOS;
                try
                {
                    imageFileOS = getContentResolver().openOutputStream(uriSavedImage);
                    imageFileOS.write(arg0);
                    imageFileOS.flush();
                    imageFileOS.close();

                    Log.w(TAG, "Image saved: " + uriSavedImage.toString());
                    camera.startPreview();
                }
                catch (FileNotFoundException e)
                {
                    Log.e(TAG, "onPictureTaken", e);
                }
                catch (IOException e)
                {
                    Log.e(TAG, "onPictureTaken", e);
                }
            }
        }
    };

    @Override
    public void surfaceChanged(SurfaceHolder sHolder, int format, int width, int height)
    {
        if (isPreview)
        {
            try
            {
                camera.stopPreview();
                isPreview = false;
            }
            catch (Exception e)
            {
                Log.e(TAG, "surfaceChanged", e);
            }
        }

        if (camera != null)
        {
            try
            {
                camera.setPreviewDisplay(holder);
                camera.startPreview();
                isPreview = true;
            }
            catch (IOException e)
            {
                Log.e(TAG, "surfaceChanged", e);
                releaseCamera();
            }
        }
    }

    @Override
    public void surfaceCreated(SurfaceHolder holder)
    {
        try
        {
            camera = Camera.open();
        }
        catch (Exception e)
        {
            Log.e(TAG, "surfaceCreated Camera.open()", e);
            releaseCamera();
        }
    }

    @Override
    public void surfaceDestroyed(SurfaceHolder holder)
    {
        releaseCamera();
    }

    private void releaseCamera()
    {
        try
        {
            camera.stopPreview();
            camera.release();
            camera = null;
            isPreview = false;
        }
        catch (Exception e)
        {
            Log.e(TAG, "releaseCamera", e);
        }
    }
} 
```

For this you only need a very simple layout (**`main.xml`**):

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical" android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <SurfaceView android:id="@+id/preview"
        android:layout_width="fill_parent" android:layout_height="wrap_content"/>
    <Button android:id="@+id/btn_shot" android:text="Shot!"
        android:layout_width="wrap_content" android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentBottom="true" />
</RelativeLayout> 
```

I hope it's clear enough :)

# joomla - 小部件套件不适用于 joomla 1\. 7

> ID：10585535
> 
> 赞同：0
> 
> 时间：2012-05-14T14:40:24.883
> 
> 标签：joomla

我有一个 joomla 1\. 7 网站，并且我安装了一个小部件工具包，用于显示带有按钮的滑块。它在后端工作正常，但它不会显示在网站上。

小部件套件与 Joomla 1\. 7 不兼容是否有原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:48:43.010

完全没有任何细节，我建议您选择的 joomla 模板和 javascript 库（如 jquery 或 mootools）可能存在冲突。

试试你的 joomla 安装附带的简单模板之一，看看前端的问题是否仍然存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:17:17.910

Widget Kit 与 Joomla 1.7 兼容，但正如 Grag P 所说，它可能与使用 Jquery 的另一个扩展发生冲突。

1.  使用 Firebug 并查看在`<head>`标签中加载的脚本，看看是否有 2 个 Jquery 库正在加载。
2.  如果是这样，那么第二个很可能来自您的模板，在这种情况下，请转到您的模板管理器并查看是否有关闭 Jquery 的选项，否则如果它来自另一个扩展，请尝试禁用它并查看是否可以解决问题。

还要确保您拥有最新版本的小部件工具包，因为 Yootheme 在过去 2 个月中推出了很多更新。

# google-apps-script - “您的触发器配额已超出”

> ID：10585536
> 
> 赞同：1
> 
> 时间：2012-05-14T14:40:25.650
> 
> 标签：google-apps-script, google-sheets, triggers

**任务：** 对于我们的每个客户，我们需要构建八个电子表格，每个电子表格至少有两个触发器：1) 打开和 2) 基于时间从更大的电子表格中刷新特定数据。（这是 IMPORTRANGE 函数失败的解决方法。）

我们目前有 100 家客户，不久将扩大到 200 家。因此，我们目前需要大约 800 个电子表格和 1,600 个触发器；预计很快将分别达到 1,600 和 3,200。

**问题** 创建前 300 个电子表格（大约 600 个触发器）后，我们收到以下错误：

> 您的触发器配额已超出。要创建更多，您必须删除一些现有触发器。

**期望的解决方案：** 我们在一个私人谷歌网站上为每个客户收集八个电子表格。理想情况下，我们可以从站点调用每个电子表格脚本，并消除基于时间的触发器。尝试创建一个按钮来执行脚本，但在网站上，它不是交互式的。

**问题：** 在 Windows 7 上运行，Chrome 中出现错误，也尝试了 Firefox，并且得到了同样的错误。

1)a 有谁知道触发器的限制，它是否在某处发布？

1)b 有没有办法增加这些限制？

2）关于另一种解决方法或解决方案的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:54:20.863

Eric 已经回答了您的问题 (1)。（没有，也没有）

现在到问题 (2)，一种可能的解决方法是反转脚本的场景，而不是每个脚本都在“更大的电子表格”上获取其数据，您的主控上的单个脚本可以将数据分布在所有其他电子表格上。您可以对每个电子表格进行某种“注册”，可能将它们放在同一个文件夹中，或者以任何其他适合您的方式。

通过更改此方法，您肯定会遇到另一个限制，即脚本总运行时间：6 分钟。但是，您可以通过将任务分成小块来轻松解决这个问题，您可以在每分钟触发时工作和恢复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:25:19.777

一个用户可以拥有的触发器数量是有限制的，但它们不会发布，也不能更改。

# python - 蟒蛇板球比赛

> ID：10585537
> 
> 赞同：-2
> 
> 时间：2012-05-14T14:40:29.377
> 
> 标签：python

我真的很感激python程序的一些帮助。这是一个板球程序；询问用户要玩的轮数，然后跟踪跑动、检票口和轮盘。那部分没问题，但我不知道如何跟踪每个击球手和跑动。一次只有一名击球手可以出去，他们在每次结束后交换前锋端，显然是为了奇怪的跑动。如果可以的话请帮忙。到目前为止，这是程序的一部分，我只需要添加击球手。

```
for overs in range(1, numOvers + 1): 

  if endGame: #.........set to true from inner loop when breaking
            break

    print()
    print("---------------------------")
    print("Enter runs for over ", overs)
    print("---------------------------")

    #inner loop for number of balls in the over 
    for _runs in range(1, BALLS_IN_OVER + 1): 

      #calculate the number of overs and remainding balls
      totalBallsFaced += 1 
      totalOversFaced = (totalBallsFaced // BALLS_IN_OVER)    
      partOverFaced = (totalBallsFaced % BALLS_IN_OVER) 

      #print()
      runs = int(input("> ")) #...........prompt user for runs

      if runs < 0:#.......................if negative number, add to 1 to wicket
        wicket += 1
        print("Batter out...")

        if wicket >= 10:#...............if batter out and if all batters out then team out
          print("Batters all out")
          endGame = 1 #..............set to true
          break #.......................break to outer loop
      else: 
        total += runs #..................if input >= 0 , add to total 
```

* * *

感谢快速反馈的家伙，我考虑了这两个想法并最终完成了。只有指数 1 得分和击球手指数 2 的击球手是另一个击球手，他们只是交换奇数跑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:58:34.280

我不知道如何打板球，但我也许能帮上忙。

> “我不知道如何跟踪每个击球手和跑动。一次只有一名击球手可以出去，他们在每次结束后交换前锋端，显然是为了奇怪的跑动。”

如果您想跟踪所有击球手，为什么不使用元组数组呢？所以数组中的每个条目都会有 (batter,runs,out,striker)

保持击球手的号码（可以删除，只需`batter`将数组位置 0 用于第一个击球手，将 1 用于第二个击球手等。取决于您是否要为每个击球手存储名称或其他内容），

`runs`拿着他们跑了多少次，

`out``True`如果他们出局，`False`如果他们还在，则为布尔值，

和`striker`另一个布尔值（我不知道板球，但听起来你说他们轮流所以他们中的一个需要成为前锋，而其他人则不是。）

然后，您只能在板球规则有效或无论如何有效的情况`out`下继续计数。`False`

```
arr=[]
for i in range (num_of_batters):
     batter=input("Batter's name: ").strip()
     arr.append((batter,0,False,False)) 
```

希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:50:47.283

看起来您需要一个列表 - 列表中的每个条目都是给定击球手的跑步次数。所以你的代码可能看起来像：

```
runsPerBatter = [0] * 11 # this makes a list with 11 zero entries 
```

您可以使用`wicket`变量来指示哪个击球手（列表索引从 0 开始，所以当`wicket`为 0 时，我们有第一个击球手，我们会将他们的运行放入`runsPerBatter[0]`）：

```
...
else:
  total += runs
  runsPerBatter[wicket] += runs 
```

然后在程序结束时，您可以打印每个击球手的跑数：

```
for i in range(11):
    print 'batsman', i + 1, 'made', runsPerBatter[i], 'runs' 
```

# android - 尝试执行进程时出现Android IO异常

> ID：10585545
> 
> 赞同：2
> 
> 时间：2012-05-14T14:40:55.947
> 
> 标签：android, process, ioexception

我有以下代码，用于从其 PID 获取应用程序名称。
shell命令是（只是为了显示它在shell提示符下工作，我修剪了很多行，它们看起来都很相似）

```
C:\android-sdk-windows\platform-tools>adb shell ps
USER     PID   PPID  VSIZE  RSS     WCHAN    PC         NAME
root      1     0     312    220   c009b74c 0000ca4c S /init
root      2     0     0      0     c004e72c 00000000 S kthreadd
root      3     2     0      0     c003fdc8 00000000 S ksoftirqd/0
root      4     2     0      0     c004b2c4 00000000 S events/0
root      27    1     740    316   c0158eb0 afd0d8ac S /system/bin/sh
system    28    1     812    292   c01a94a4 afd0db4c S /system/bin/servicemanager
root      29    1     3736   568   ffffffff afd0e1bc S /system/bin/vold
system    68    33    191096 38680 ffffffff afd0db4c S system_server
radio     131   33    147680 22868 ffffffff afd0eb08 S com.android.phone
app_25    134   33    148784 25740 ffffffff afd0eb08 S com.android.launcher
app_0     160   33    135560 20956 ffffffff afd0eb08 S android.process.acore
root      316   40    740    332   c003da38 afd0e7bc S /system/bin/sh
root      317   316   888    336   00000000 afd0d8ac R ps 
```

我的Java代码是：

```
private static Pattern pidPattern = Pattern.compile("(\\d+).+?\\s+[DNRSTZ]\\s+(.+)$");

private final Map<Integer, String> pidNames = new HashMap<Integer, String>();

private void getAppNames() {
    // Bad command: String commandLine = "adb shell ps";
    String line;
    try {
        Process process = Runtime.getRuntime().exec("ps");
        BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        Matcher matcher;

        pidNames.clear();
        while((line = bufferedReader.readLine()) != null) {
            matcher = pidPattern.matcher(line);
            if(matcher.find()) {
                int pid = Integer.valueOf(matcher.group(1));
                String name = matcher.group(2);
                pidNames.put(pid, name);
                Log.i(TAG, "Pid=" + pid + " Name=" + name);
            }
        }
        bufferedReader.close();
        process.destroy();
    }
    catch (IOException e) {
        Log.e(TAG, "getAppNames failed", e);
    }
} 
```

我收到以下消息：

```
05-14 17:09:00.220: E/BackTask(698): getAppNames failed
05-14 17:09:00.220: E/BackTask(698): java.io.IOException: Error running exec(). Command: [adb shell ps, android.com] Working Directory: null Environment: [ANDROID_SOCKET_zygote=10, ANDROID_BOOTLOGO=1, EXTERNAL_STORAGE=/mnt/sdcard, ANDROID_ASSETS=/system/app, ASEC_MOUNTPOINT=/mnt/asec, PATH=/sbin:/system/sbin:/system/bin:/system/xbin, ANDROID_DATA=/data, BOOTCLASSPATH=/system/framework/core.jar:/system/framework/ext.jar:/system/framework/framework.jar:/system/framework/android.policy.jar:/system/framework/services.jar, ANDROID_PROPERTY_WORKSPACE=9,32768, ANDROID_ROOT=/system, LD_LIBRARY_PATH=/system/lib]
05-14 17:09:00.220: E/BackTask(698):    at java.lang.ProcessManager.exec(ProcessManager.java:226)
05-14 17:09:00.220: E/BackTask(698):    at java.lang.ProcessBuilder.start(ProcessBuilder.java:201)
05-14 17:09:00.220: E/BackTask(698):    at com.delta.app.BackTask.getAppNames(BackTask.java:180)
05-14 17:09:00.220: E/BackTask(698):    at com.delta.app.BackTask.doInBackground(BackTask.java:65)
05-14 17:09:00.220: E/BackTask(698):    at com.delta.app.BackTask.doInBackground(BackTask.java:1)
05-14 17:09:00.220: E/BackTask(698):    at android.os.AsyncTask$2.call(AsyncTask.java:185)
05-14 17:09:00.220: E/BackTask(698):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
05-14 17:09:00.220: E/BackTask(698):    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
05-14 17:09:00.220: E/BackTask(698):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
05-14 17:09:00.220: E/BackTask(698):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
05-14 17:09:00.220: E/BackTask(698):    at java.lang.Thread.run(Thread.java:1096)
05-14 17:09:00.220: E/BackTask(698): Caused by: java.io.IOException: Permission denied
05-14 17:09:00.220: E/BackTask(698):    at java.lang.ProcessManager.exec(Native Method)
05-14 17:09:00.220: E/BackTask(698):    at java.lang.ProcessManager.exec(ProcessManager.java:224)
05-14 17:09:00.220: E/BackTask(698):    ... 10 more 
```

问题是：怎么了？没有权限？进程调用自己？

编辑：尝试了这条线：

```
Process process = Runtime.getRuntime().exec(commandLine); 
```

具有相同的 IOException 结果

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:45:33.900

在 Android 操作系统中运行命令行时，不应执行“adb shell ps”；你应该只执行“ps”！

设备端没有“adb”可执行文件。

此外，产生进程的更好方法如下：

`process = Runtime.getRuntime().exec("ps");`

# mysql - 从另一个表更新表数据

> ID：10585546
> 
> 赞同：0
> 
> 时间：2012-05-14T14:41:01.827
> 
> 标签：mysql

我有这两个具有相同结构但数据数量不同的表。

Table First id INT 类型 INT

表秒 id INT 类型 INT

我需要用表“SECOND”的值类型更新表“FIRST”的类型，然后我尝试执行这个语句

```
update First set 
       type = (
select Second.type
 from First,
      Second
where First.id=Second.id
              ) 
```

但它不运行。我错在哪里了？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:43:57.710

Your syntax is incorrect. Try instead:

```
UPDATE First, Second
SET    First.type = Second.type
WHERE  First.id   = Second.id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:44:28.723

```
update First f, Second s 
set f.type = s.type
where f.id=s.id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:45:40.313

尝试

```
UPDATE `FIRST` AS f 
INNER JOIN `SECOND` AS s ON f.id=s.id
SET f.type=s.type 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T14:46:02.810

```
UPDATE First,Second SET First.type=Second.type
WHERE First.id=Second.id; 
```

# objective-c - ARC 不是消除了 Objective-C 中对属性的需求吗？

> ID：10585548
> 
> 赞同：3
> 
> 时间：2012-05-14T14:41:09.673
> 
> 标签：objective-c, properties, automatic-ref-counting, ivar

> **可能重复：**
> [使用 ARC 为什么要再使用@properties？](https://stackoverflow.com/questions/9876460/with-arc-why-use-properties-anymore)

**注意：我实际上不认为我们可以取消属性，但我试图理解为什么不这样做的原因。:)**

回到[这个问题](https://stackoverflow.com/questions/4172810/what-is-the-difference-between-ivars-and-properties-in-objective-c)，我们使用属性的主要原因似乎是避免内存管理问题。换句话说，通过创建一个属性，我们摆脱了写出所有这些保留和释放方法的需要：

```
- (void) setOtherObj:(MyOtherObject *)anOtherObject {

    if (otherObject == anOtherObject) {
    return;  
    }

    MyOtherObject *oldOtherObject = otherObject; // keep a reference to the old value for a second
    otherObject = [anOtherObject retain]; // put the new value in  
    [oldOtherObject release]; // let go of the old object
} 
```

既然 ARC 现在处理这个问题，我们是否可以不一起取消属性并通过执行类似的操作来设置 ivars `otherObject = anotherObject`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T14:55:48.367

内存管理是使用属性的原因*之一*，但不是唯一的原因。您只能在自己的类中使用普通的实例变量，但不能从外部使用。为此，您仍然需要一个属性。

属性甚至不必由实例变量支持。例如，您可能`backgroundColor`在视图中有一个属性，该属性实际上返回并设置了`backgroundColor`某些私有子视图的属性。或者，假设您有一个`name`实际上不对应于实例变量的只读属性，而只是将 和 连接`firstName`起来`lastName`。

使用属性而不是普通的实例变量访问还可以让您更轻松地实现延迟初始化，而无需在很多地方更改代码。

如果您只使用属性为您处理内存管理，那么现在在很多情况下都可以不使用它，但是当您以后决定不应该简单地映射到实例变量时，使用属性仍然可以为您提供更大的灵活性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T14:55:41.667

避免内存问题是属性的一个非常有用的副产品。它们的主要目的仍然是访问控制（`readonly`vs. `readwrite`）和信息隐藏（即获取和设置属性背后的逻辑可以随时更改，而您的类的用户不需要更改）。此外，如果您需要`copy`语义，ARC 仍然可以使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:02:01.630

ARC 是为您管理与内存相关的问题。属性是一种方便地获取/设置值的方法。所以ARC的到来并不意味着房产的终结。

# git - 如何从 git repo 中完全删除文件？

> ID：10585549
> 
> 赞同：5
> 
> 时间：2012-05-14T14:41:18.800
> 
> 标签：git, delete-file, permanent

我不小心将我无权访问的文件推送到可公开访问的存储库。

我该怎么做才能有选择地从回购中完全删除该单个文件，以使其数据完全消失？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T14:46:29.017

在这种情况下，Git Filter-Branch 是你的朋友，可爱的 Github 有[很好的记录](http://help.github.com/remove-sensitive-data/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T14:43:45.897

假设您添加文件的提交是最新的：

```
git reset --hard HEAD^
git push --force 
```

如果存储库中有更多提交，则可以使用*交互式变基*来消除该提交。`git rebase -i xxx`在`xxx`你想要核对的那个之前使用作为一个提交。然后在编辑器中，删除包含“错误”提交的行。保存并退出编辑器后，该提交将永远消失。如果您无法删除整个提交，您可以在文件中替换`pick`为`edit`并修改提交（例如从暂存区删除文件）然后运行`git rebase --continue`

但是，从您的仓库中提取的每个人都需要**手动**执行相同的变基。但是无论如何，该文件已经是公开的，您不应该重写历史记录来撤消您的错误。

除了所有变基，您还可以使用[GitHub 帮助中](http://help.github.com/remove-sensitive-data/)`git-filter-branch`的描述来删除文件：

```
git filter-branch --index-filter 'git rm --cached --ignore-unmatch NAME_OF_THE_FILE' --prune-empty -- --all 
```

当然，您也需要`git push --force`在此操作之后进行操作，因为它还会重写历史记录（如果有人从该存储库中提取并开始处理它，请注意所有警告）。如果您的仓库在 github 上，也不要忘记联系他们以清除您的仓库的缓存。

# php - 如何向 api url 发出 JSON Curl 请求，获取 null

> ID：10585554
> 
> 赞同：1
> 
> 时间：2012-05-14T14:41:50.607
> 
> 标签：php, json, curl

我认为这应该很简单，但我无法理解。

我需要向以下格式的 url 发出请求：

[http://ratings.api.co.uk/business/](http://ratings.api.co.uk/business/) {lang}/{fhrsid}/{format} 其中 lang 将设置为 en-GB，fhrsid 是标识符，格式是 json。

我尝试了以下方法，但我只是得到 null 作为回报：

```
$data = array("lang" => "en-GB", "fhrsid" => "80928");                                                                    
$data_string = json_encode($data);            

$ch = curl_init('http://ratings.api.co.uk/business/json');                                                                      
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "POST");                                                                     
curl_setopt($ch, CURLOPT_POSTFIELDS, $data_string);                                                                  
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);                                                                      
curl_setopt($ch, CURLOPT_HTTPHEADER, array(                                                                          
'Content-Type: application/json',
'Content-Length: ' . strlen($data_string))                                                 );                                                                                                                   

$Jsonresult = curl_exec($ch);
curl_close($ch);

var_dump(json_decode($Jsonresult)); 
```

感激地收到任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:46:17.893

您当前正在将数据发布到 URL，同时您说要将数据放入 URL 本身。

即现在您提交`{"lang:"en-GB","fhrsid":80928}`到 URL `http://ratings.api.co.uk/business/json`，但您想要检索 URL `http://ratings.api.co.uk/business/en-GB/80928/json`。

不要`POST`用作请求类型，不要指定 postfields，不要指定 content-length，并将数据放在你的 URL 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T14:46:59.113

将数据作为参数发送与在 URL 中发送数据不同。

如果您需要 url 格式`http://ratings.api.co.uk/{lang}/{fhrsid}/{format}`，那么您必须使您的`curl_init`字符串与该格式匹配。

# ldap - How to synthetize custom uid in Plone / LDAP

> ID：10585556
> 
> 赞同：0
> 
> 时间：2012-05-14T14:42:00.347
> 
> 标签：ldap, plone

I'd like to use LDAP authentication (precisely Active Directory) in Plone (v4), however, the `uid` would not be simply one of LDAP user attributes, but i have to generate it myself (construct it from various LDAP user attributes, normalize the case, ..)

What Plone component (file) do you recommend me to modify? Or, is it even possible to solve it implanting a custom function in ZMI somewhere?

(I'm using PloneLDAP / plone.app.ldap)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T09:13:01.633

我会认真重新考虑您的用例。Plone 中的 uid 并没有真正显示在面向用户的页面中，所以如果它不漂亮也不是问题。如果您使用 ActiveDirectory，坚持使用 sAMAccountName 将为您在以后的升级中省去无穷无尽的麻烦。

然后，您可以进行各种修改以获得漂亮的用户名或其他任何内容，但您的基本身份验证将是面向未来的。

构建自己的 uid 是灾难的根源，会有***一个***你没有预见到的极端情况，你最终会遇到非唯一的 uid、字符集的奇怪问题或其他可预防的问题。

# tfs - Using TFS Power Tool to send email to Any person who get assigned a new Work Item

> ID：10585558
> 
> 赞同：2
> 
> 时间：2012-05-14T14:42:04.133
> 
> 标签：tfs, tfs-power-tools

I can use TFS Power Tools to send emails to a specific user every-time a new work item created but instead i want to send the person who is assigned the new work item!

any one has any idea how to do that ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:52:39.677

使用 AlertsExplorer 应该很容易实现这一点：这样做
![在此处输入图像描述](../Images/c87ae0975b96f2aba886cdc7741c8258.png)
的坏处是，您需要为启用此功能的每个不同用户设置一个规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:33:18.933

如果您希望人们在创建/更改分配给他们的工作项时收到通知，您必须要求他们从 Visual Studio 注册“我的工作项已被其他人更改”警报（无需使用 Power Tools）。

您不能注册将向电子邮件地址发送警报的通用警报，该电子邮件地址取决于获得分配工作项的用户。（如果这是你的问题，但我不确定）。

![在此处输入图像描述](../Images/f067a457e7fbf59a4427fed9c54ed7ff.png)

![在此处输入图像描述](../Images/a10e1f433cc75252865b41aa359e078d.png)

# java - 在 Hadoop Mapper 中获取总输入路径计数

> ID：10585560
> 
> 赞同：0
> 
> 时间：2012-05-14T14:42:09.097
> 
> 标签：java, hadoop, mapreduce

我们试图获取 MapReduce 程序在映射器中迭代的输入路径总数。我们将使用它和一个计数器来根据索引格式化我们的值。有没有一种简单的方法可以从映射器中提取总输入路径数？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:13:20.793

您可以查看源代码`FileInputFormat.getSplits()`- 这会拉回配置属性`mapred.input.dir`，然后将此 CSV 解析为路径数组。

这些路径仍然可以表示文件夹和正则表达式，因此 getSplits() 所做的下一件事是将数组传递给受保护的方法`org.apache.hadoop.mapreduce.lib.input.FileInputFormat.listStatus(JobContext)`。这实际上会通过 dirs / regex 列出并列出目录 / regex 匹配文件（`PathFilter`如果已配置，也会调用 a ）。

因此，在此方法受到保护的情况下，您可以创建一个具有 listStatus 方法的 FileInputFormat 的简单“虚拟”扩展，接受 Mapper.Context 作为它的参数，然后包装对 FileInputFormat.listStatus 方法的调用：

```
public class DummyFileInputFormat extends FileInputFormat {
    public List<FileStatus> listStatus(Context mapContext) throws IOException {
        return super.listStatus(mapContext);
    }

    @Override
    public RecordReader createRecordReader(InputSplit split,
            TaskAttemptContext context) throws IOException,
            InterruptedException {
        // dummy input format, so this will never be called
        return null;
    }
} 
```

**编辑**：事实上它看起来`FileInputFormat`已经为你做了这个，`mapreduce.input.num.files`在 getSplits() 方法的末尾配置一个作业属性（至少在 1.0.2 中，可能在 0.20.203 中引入）

[这是 JIRA 票](https://issues.apache.org/jira/browse/MAPREDUCE-1466)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:20:10.017

您可以使用输入路径的数量在作业中设置配置。就像

```
jobConf.setInt("numberOfPaths",paths.length); 
```

只需将代码放在您配置工作的地方。`Mapper.setup(Mapper.Context context)`之后，通过从上下文中获取它，将其从您的配置中读取出来。

# c# - WPF WebBrowser 控件中未触发 LoadCompleted

> ID：10585565
> 
> 赞同：2
> 
> 时间：2012-05-14T14:42:24.947
> 
> 标签：c#, wpf, webbrowser-control

我有一个简单的 WPF webBrowser 控件，用于自动化网站。我试图加载的页面是一个 ASP.NET 页面。当我尝试正常导航到它时，永远不会触发 LoadCompleted。如果我尝试导航到它，并在 Navigated 事件中使用 IHTMLElementCollection 读取元素，则 LoadCompleted 事件会触发。这对我来说没有意义。无论如何，LoadCompleted 事件都应该触发，因为我在这两种情况下都在加载页面。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T15:07:48.793

事实证明，这些事件要正常工作，控件必须是可见的。在处理完所有内容后，我一直试图在最后显示控件，但这不起作用。

# php - How to implement a permissions system that varies according to the values a user is attempting to save?

> ID：10585566
> 
> 赞同：3
> 
> 时间：2012-05-14T14:42:33.230
> 
> 标签：php, oop, zend-framework, user-permissions

The context is a educational administration system built on the Zend Framework. We are implementing a RESTful MVC to handle pretty much all data interactions with clients. Relationships between resources are mapped in the database with foreign keys etc.

Example case: a teacher creating a report on a specific student.

We currently have a role-based permissions system that can be tailored to the level of the individual role (using, eg, `teacher_5` as the role name). Therefore we can easily restrict access to an already existing report (by generating permissions in the report model that allows edit/put permissions on the report only to the tutor role who created it, say). The problem comes on creation. In order to add a report a user can post to /reports, say, the following data:

```
{ achievement: "4", performance: "5", student_id: "10" } 
```

The problem is that tutors are only allowed to create new reports on a certain subset of `student_ids` - those students that they are teaching.

One approach would be to treat this as a validation issue on that field. The issue with this is that we want to protect ourselves from making mistakes, and that is not easy to do with validation (the code would have to know in advance that special validation is expected on certain fields).

The other would be to somehow extend our permissions system to a completely granular one (i.e., there would be a permission for every field in every model), and then extend our current permissions system to responding to paramaterised permissions checks. So if we wanted to know if the current user has permissions to add student_id 10 to a report on creation, we would end up with something like

```
if ($acl->isAllowed($resource, $role, $action, $field, $value)) 
```

where $resource would be a report model, $role would be the teacher `teacher_5`, `$action` would be "post", $field would be `student_id`, and $value would be 10\. The acl class would essentially handle a call to the `$resource` itself.

We are not sure which direction to take, but presumably this is a fairly common issue, so we are wondering what approach other people have taken.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-26T08:25:58.510

如果有另一个包含每个老师辅导的 student_id 的表呢？然后您可以轻松检查是否允许教师进行插入。该解决方案的另一个好处是能够提取有关整个班级的统计数据，例如平均成绩、出勤率等

# jquery - ASP.NET 上的 JQuery HTTPGet 和页面刷新

> ID：10585570
> 
> 赞同：0
> 
> 时间：2012-05-14T14:42:53.230
> 
> 标签：jquery, .net, ajax

我正在使用 FileTree JQuery 组件将目录选择传递给页面。我正在使用 HTTPGet 传递选定的文件并在 Page_Load 上捕获它（到目前为止，太好了！）。

在此之后，我想对页面和“刷新”控件进行一些更改。

做到这一点的最佳方法是什么？

谢谢！

**jQuery函数：**

```
function LoadImages(file) {
    var param = {
        "Action": "LoadImages",
        "file": escape(file)
    };

    $.getJSON("SomePage.aspx", param);
} 
```

**代码隐藏 (aspx.cs)**

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        if (QueryString.Current.Get(Constants.HTTPGet.Action) == Constants.HTTPGet.LoadImages)
        {
            DoSomethingWithFile(Request["file"]);
            divAnything.Visible= true;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:32:34.127

当页面不是回发时，您的代码正在运行。

尝试将代码段放在检查之外，看看这是否是您的问题。（理想情况下，如果您的代码正在被访问，您可以使用断点进行检查）。

IE

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        //keep this block for future use
    }

    if (QueryString.Current.Get(Constants.HTTPGet.Action) == Constants.HTTPGet.LoadImages)
    {
        divAnything.Visible= true;
    }
} 
```

永远记住，如果您的页面中有一个动作，并且您需要 ASP.NET 引擎来处理它，那么您需要将页面发回。在 javascript 中，您可以强制回发调用表单的提交方法，或者使用具有回发事件的控件。

即在 JavaScript 中。

```
document.forms["myform"].submit(); 
```

即在jQuery中。

```
$('#myForm').submit(); 
```

# java - 访问在方法中创建的摆动组件

> ID：10585573
> 
> 赞同：1
> 
> 时间：2012-05-14T14:43:13.810
> 
> 标签：java, swing

我有一个构建我的 gui 的类。gui 的一部分是一个 jtabbed 窗格，它的面板是在一个方法中创建的，它们都是相同的，并且有一个 jtextarea 和一些 jbuttons。

如何从其他方法/类访问每个选项卡中的组件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:47:04.897

您可以将此组件放入类字段中。例如，如果您需要访问按钮制作字段

`private Button myButton;`

在 method 中创建它，`createUI()`然后在 method 中使用它`doSomething()`。

另一种方法是仅存储容器（例如面板），然后使用`panel.getComponents()`. 仅当您确实有非常相似的组件并且不必区分它们时才使用此方法。例如，您想更改所有组件的颜色等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T14:48:49.740

您可以使用`getTabCount()`、`getTitleAt()`、`indexOfTab()`和的组合`getComponent()`。[在此处](http://edelstein.pebbles.cs.cmu.edu/jadeite/main.php?api=java6&state=class&package=javax.swing&class=JTabbedPane)查看更多信息

# iphone - 如何防止IOS并发NSOperation在主线程上运行

> ID：10585575
> 
> 赞同：4
> 
> 时间：2012-05-14T14:43:19.440
> 
> 标签：iphone, ios, cocoa-touch

我正在编写一个应用程序，它使用 ASI HTTP 定期从 Web 服务器获取数据，然后处理该数据以在 UI 上显示与用户相关的内容。从单个服务器上的不同请求中检索数据。数据本身需要按特定顺序处理。其中一个数据块比其他数据块大得多。

为了在处理数据时不锁定 UI，我尝试使用`NSOperationQueue`来在不同线程上运行数据处理。这在大约 90% 的情况下都可以正常工作。然而，在剩下的 10% 的时间里，最大的数据块正在主线程上处理，这会导致 UI 阻塞 1-2 秒。该应用程序在不同的选项卡中包含两个 MKMapView。当两个 MKMapViews 选项卡都加载时，在主线程上处理最大数据块的时间百分比增加了 50% 以上（这似乎表明当有更多并发活动时会发生这种情况）。

有没有办法防止`NSOperationQueue`在主线程上运行代码？

我尝试使用`NSOperationQueue` `–setMaxConcurrentOperationCount:`, 增加和减少它，但在这个问题上没有真正的变化。

这是启动定期刷新的代码：

```
- (void)refreshAll{    

    // Create Operations
    ServerRefreshOperation * smallDataProcessor1Op = [[ServerRefreshOperation alloc] initWithDelegate:_smallDataProcessor1];
    ServerRefreshOperation * smallDataProcessor2Op = [[ServerRefreshOperation alloc] initWithDelegate:_smallDataProcessor2];
    ServerRefreshOperation * smallDataProcessor3Op = [[ServerRefreshOperation alloc] initWithDelegate:_smallDataProcessor3];
    ServerRefreshOperation * smallDataProcessor4Op = [[ServerRefreshOperation alloc] initWithDelegate:_smallDataProcessor4];
    ServerRefreshOperation * smallDataProcessor5Op = [[ServerRefreshOperation alloc] initWithDelegate:_smallDataProcessor5];
    ServerRefreshOperation * hugeDataProcessorOp = [[ServerRefreshOperation alloc] initWithDelegate:_hugeDataProcessor];

    // Create dependency graph (for response processing)
    [HugeDataProcessorOp addDependency:smallDataProcessor4Op.operation];
    [smallDataProcessor5Op addDependency:smallDataProcessor4Op.operation];
    [smallDataProcessor4Op addDependency:smallDataProcessor3Op.operation];
    [smallDataProcessor4Op addDependency:smallDataProcessor2Op.operation];
    [smallDataProcessor4Op addDependency:smallDataProcessor1Op.operation];

    // Start be sending all requests to server (startAsynchronous directly calls the ASIHTTPRequest startAsynchronous method)
    [smallDataProcessor1Op startAsynchronous];
    [smallDataProcessor2Op startAsynchronous];
    [smallDataProcessor3Op startAsynchronous];
    [smallDataProcessor4Op startAsynchronous];
    [smallDataProcessor5Op startAsynchronous];
    [hugeDataProcessorOp startAsynchronous];
} 
```

这是设置启动数据处理的 ASI HTTP 完成块的代码：

```
[_request setCompletionBlock:^{
    [self.delegate setResponseString:_request.responseString];
    [[MyModel queue] addOperation:operation]; // operation is a NSInvocationOperation that calls the delegate parse method
}]; 
```

我在入口点的所有 NSInvocationOperation Invoked 方法中添加了这段代码：

```
if([NSThread isMainThread]){
    NSLog(@"****************************Running <operation x> on Main thread");
} 
```

每次 UI 冻结时都会打印该行。这表明整个操作是在主线程上运行的。实际上总是`hugeDataProcessorOp`在主线程上运行。我认为这是因为它总是最后从服务器接收到它的答案的操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T15:08:42.373

在对我自己的代码进行大量调查之后，我可以确认这是一个编码错误。

剩下的旧调用没有通过 NSInvocationOperation 而是调用 NSInvocationOperation 应该直接调用的选择器（因此不使用 concurrent `NSOperationQueue`.

这意味着`NSOperationQueue`不使用主线程（除非它是由 检索的`+mainQueue`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:44:15.363

覆盖[`isConcurrent`](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/NSOperation_class/Reference/Reference.html#//apple_ref/occ/instm/NSOperation/isConcurrent)您的 NSOperation 并返回`YES`。根据文档，这将导致您的 NSOperation 异步运行。

# ajax - Changing the cache time in jquery

> ID：10585578
> 
> 赞同：8
> 
> 时间：2012-05-14T14:43:34.387
> 
> 标签：ajax, json, caching, jquery

if we pass `true` for `cache` in `$.ajax()` the jquery will cache the loaded data, I want to know is there any way to change the cache time for `$.ajax()` ? for example if ajax requested in 10 minutes the jquery load previous data but if requested after 10 minutes load fresh data.

UPDATE :

We need cache the JSON data, so I should use Ajax in JSON datatype

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T14:50:47.117

jQuery 实际上并不为您缓存请求 - 当您设置`cache`为时`false`，它只是设置一些标头并传递一个“缓存破坏器”查询字符串变量（例如，`?_=487262189472`）以防止浏览器或任何代理返回缓存的响应。

如果你想要 10 分钟的缓存，你可以很容易地实现你自己的缓存。例如，

```
var cacheBuster = new Date().getTime();
setInterval(function() {
    cacheBuster = new Date().getTime();
}, 1000 * 60 * 10) 
```

然后只需将其添加到您的请求中的查询字符串变量中（例如，`?_noCache=<cacheBuster>`）。

* * *

编辑：为了使它成为一个更完整的解决方案，这里有一个示例，说明如何`cacheBuster`在所有 jQuery Ajax 请求上对实际的 Ajax 调用透明地使用：

```
$.ajaxPrefilter(function (options, originalOptions, jqXHR) {
    var startChar = options.url.indexOf('?') === -1 ? '?' : '&';
    options.url += startChar + '_noCache=' + cacheBuster;
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T15:06:39.253

这听起来像是利用 jQuery 的 Deferred 对象的理想场所。

Addy Osmani 和 Julian Aubourg 在 MSDN 上有一篇很棒的文章：http: [//msdn.microsoft.com/en-us/magazine/gg723713.aspx](http://msdn.microsoft.com/en-us/magazine/gg723713.aspx)

简而言之，他们有一个例子来解释他们如何缓存请求，特别是这个请求将被永久缓存。

```
var cachedPromises = {};

$.getCachedURL = function( url, callback ) {
    if ( !cachedPromises[ url ] ) {
        cachedPromises[ url ] = $.Deferred(function( defer ) {
            $.get( url ).then( defer.resolve, defer.reject );
        }).promise();
    }
    return cachedPromises[ url ].done( callback );
}; 
```

然后像这样解决 Deferred

```
$.getCachedURL( url ).then( successCallback, errorCallback ); 
```

因此，如果您希望仅将某些 url 缓存一段时间，我们可以修改现有代码并按照以下方式执行某些操作（请注意，这不是我的想法）

```
var cachedPromises = {};
var cachedTimeouts = {};

$.getCachedURL = function( url, callback, cacheTime) {
    if ( !cachedPromises[ url ] ) {
        cachedPromises[ url ] = $.Deferred(function( defer ) {
            $.get( url ).then( defer.resolve, defer.reject );
        }).promise();
        cachedTimeouts[ url ] = setTimeout(function () {
            clearTimeout(cachedTimeouts[ url ]);
            delete cachedPromises[ url ];
        }, cacheTime);
    }
    return cachedPromises[ url ].done( callback );
}; 
```

并使用回调：

```
var callback = function () {
    console.log('callback', arguments)
}

var cacheTime = 3600;

$.getCachedURL('/dynamic/config', callback, cacheTime).then(function ()
{
    console.log('success', arguments)
}, function ()
{
    console.log('error', arguments)
}); 
```

其中回调将返回传统的 jQuery ajax 成功/错误参数`data`，`textStatus`并且`jqXHR`

如果你想使用 JSON`$.getJSON`而不是`$.get`

```
$.get( url ).then( defer.resolve, defer.reject );
$.getJSON( url ).then( defer.resolve, defer.reject ); 
```

请注意，您仍然可以使用`$.ajax`

```
$.ajax({
    url: url,
    dataType: 'json',
}).then( defer.resolve, defer.reject ); 
```

# jsf-2 - resetValue in custom UIInput Composite Component not working

> ID：10585579
> 
> 赞同：2
> 
> 时间：2012-05-14T14:43:40.673
> 
> 标签：jsf-2, primefaces, composite-component

I have a custom UIInput wrapped in a composite component like this:

```
<cc:interface componentType="SingleUpload">
    <cc:attribute name="value" required="true" />
    ...
</cc:interface>

<cc:implementation>
    ...
    <p:fileUpload id="fileUpload" update="@form" auto="true" 
     fileUploadListener="#{cc.fileUploaded}" rendered="#{cc.attrs.value == null}"/>
    ...
    <h:commandButton rendered="#{cc.attrs.value != null}" action="#{cc.removeFile}">
        <p:ajax execute="@this" update="@form" />
    </h:commandButton>
    ...
</cc:implementation> 
```

The backing component looks like this:

```
@FacesComponent(value = "SingleUpload")
public class SingleUpload extends UIInput implements NamingContainer, Serializable {

    /** */
    private static final long serialVersionUID = 2656683544308862007L;

    @Override
    public String getFamily() {
        return "javax.faces.NamingContainer";
    }

    public void fileUploaded(FileUploadEvent event) throws IOException {
        FileData file = new FileData();
        file.setContentMimeType(MimeTypeUtils.getContentType(event.getFile().getContentType(), event.getFile().getFileName()));
        file.setInputStream(event.getFile().getInputstream());
        file.setName(FilenameUtils.getName(event.getFile().getFileName()));
        setValue(file);
    }

    public void removeFile() {
        resetValue();
        // value should be null now, but it is not, why??
        FileData value=(FileData) getValue();

    }
} 
```

It is used this way:

```
<ki:singleUpload value="#{fileModel.file}" title="File Upload" /> 
```

So when the action `removeFile` is called, i want to set the value to null. This works, when I follow these steps:

1.  load a page containing a singleUpload component with no initial value (`fileModel.file == null`)
2.  upload a file, so `value` in SingleUpload is not null anymore
3.  remove the file

But when I do the following

1.  load a page containing a singleUpload component with an initial value (`fileModel.file != null`)
2.  remove the intial value (click on button, `removeFile` is called)

=> removing the value from the component does not seem to be possible. Why??

# file - 将文件名作为命令行参数传递给 GNU Octave 脚本

> ID：10585581
> 
> 赞同：9
> 
> 时间：2012-05-14T14:43:44.430
> 
> 标签：file, matlab, octave

在可执行的 Octave 脚本中，我想传递包含矩阵的文件的名称，并使 gnu octave 将该文件信息加载为矩阵。我怎么做？

这是脚本的外观

```
#! /usr/bin/octave -qf

arg_list = argv()

filename = argv{1} % Name of the file containing the matrix you want to load

load -ascii filename % Load the information 
```

传递的文件将是一个矩阵，其中包含一个任意大小的矩阵，比如 2x3

```
1 2 3
5 7 8 
```

在命令行，脚本应该作为包含矩阵的`./myscript mymatrixfile` 地方运行。`mymatrixfile`

这就是我尝试使用 octave 执行上面刚刚编写的脚本时得到的结果

```
[Desktop/SCVT]$ ./octavetinker.m generators.xyz                                                                             (05-14 10:41)
arg_list =

{
  [1,1] = generators.xyz
}

filename = generators.xyz
error: load: unable to find file filename
error: called from:
error:   ./octavetinker.m at line 7, column 1

[Desktop/SCVT]$ 
```

`generators.xyz`包含我需要的矩阵的文件在哪里

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-18T01:12:27.343

这应该有效：

```
#!/usr/bin/octave -qf

arg_list = argv ();
filename = arg_list{1};
load("-ascii",filename); 
```

当您编写`load filename`指示加载函数的行以加载文件名“filename”时。也就是说，你做了相当于`load('filename');`.

在 MATLAB 和 Octave 中，函数“foo”后跟一个空格，然后单词“bar”表示 bar 将作为字符串提交给 foo。即使 bar 是工作区中定义的变量也是如此。

# android - Android ViewPager - 如何向页面添加按钮？

> ID：10585586
> 
> 赞同：4
> 
> 时间：2012-05-14T14:43:51.530
> 
> 标签：android, android-viewpager

我正在按照这个链接做一个 ViewPager [http://blog.stylingandroid.com/archives/537](http://blog.stylingandroid.com/archives/537) 我设法得到了各个页面。但是如何使用按钮填充或填充这些页面？

> 实例化项目（）
> 
> 这将为给定位置创建视图。对于真正的应用程序，我们会在这里使用 Fragment 或扩展布局，但为了保持示例简单，我们创建一个 TextView，将文本设置为我们的标题数组中的正确值，并将其添加到 ViewPager

我想在不同的页面上有不同的按钮功能。我该怎么做呢？通过使用不同的布局？我如何将布局放在页面中（这就是你所说的膨胀）？

编辑：我有由 ViewPager 组成的 main.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:weightSum="1">

    <com.viewpagerindicator.TitlePageIndicator
        android:id="@+id/indicator"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" />
    <android.support.v4.view.ViewPager
        android:id="@+id/viewpager"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1" />        
</LinearLayout> 
```

我还有其他几个 xml，其中包含我想将其膨胀到 ViewPage 的不同页面中的按钮。xml 示例。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <Button android:layout_width="match_parent" android:text="Button 1" android:onClick="onClick" android:id="@+id/button1" android:layout_height="100dp"></Button>
    <Button android:text="Button 2" android:onClick="onClick" android:id="@+id/button2" android:layout_width="match_parent" android:layout_height="100dp"></Button>
    <Button android:text="Button 3" android:onClick="onClick" android:id="@+id/button3" android:layout_width="match_parent" android:layout_height="100dp"></Button>
    <Button android:text="Button 4" android:onClick="onClick" android:id="@+id/button4" android:layout_width="match_parent" android:layout_height="100dp"></Button>
    <Button android:text="Button 5" android:onClick="onClick" android:id="@+id/button5" android:layout_height="match_parent" android:layout_width="match_parent"></Button>

</LinearLayout> 
```

在 ViewPagerAdapter.java 中，我设法将各种 XML 膨胀到页面中。

```
@Override
public Object instantiateItem( View pager, int position )
{
    //Inflate the correct layout
    LayoutInflater layoutInflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    //layouts[] is an int[] that points to resources such as R.layout.start_page
    View inflatedView = layoutInflater.inflate(layouts[position], null);

    ((ViewPager)pager).addView(inflatedView,0);

    return inflatedView;

} 
```

这需要更改以防止错误。

```
@Override
public void destroyItem( View pager, int position, Object view )
{
    ((ViewPager)pager).removeView( (View)view );
} 
```

现在，我在不同的页面上有多个按钮。如何对不同页面上不同按钮的 ONCLICK 功能进行编程？这能行吗？

```
public void onClick(View v) {
        switch (v.getId()) {
        case R.id.button1:
            // do something
            break;
        case R.id.button2:
            // do something
            break;
        case R.id.button3:
            // do something
            break;
        case R.id.button4:
            // do something
            break;
        case R.id.button5:
            // do something
            break;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:57:12.900

这是一个使用按钮膨胀/以编程方式添加视图的示例：

```
@Override
//Instantiate items based on corresponding layout IDs that were passed in
public Object instantiateItem(View container, int position)
{
    //Inflate the correct layout
    LayoutInflater layoutInflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    //layouts[] is an int[] that points to resources such as R.layout.start_page
    View inflatedView = layoutInflater.inflate(layouts[position], null);

    ((ViewPager)container).addView(inflatedView,0);

    //If you can't/don't want to have the above inflated layout include everything up front, you can add them now...
    LinearLayout ll = (LinearLayout)inflatedView.findViewById(R.id.linearLayout1);
    Button newButton = new Button(context);
    newButton.setText(R.string.button_text);
    ll.addView(newButton);

    return inflatedView;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T01:44:37.760

[我最近建立了一个带有 ViewPage](http://davidjkelley.net/?p=34) r 的系统。我使用操作栏选项卡（带有兼容性库）、TabAdapter 和 ViewPager。每个选项卡都是它自己的片段，并通过主要活动添加到栏中。下面是一些关键代码：

```
public class Polling extends FragmentActivity {
private ViewPager mViewPager;
private TabsAdapter mTabsAdapter;
private final static String TAG = "21st Polling:";

public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);

mViewPager = new ViewPager(this);
mViewPager.setId(R.id.pager);
setContentView(mViewPager);
final ActionBar bar = getActionBar();
bar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
bar.setDisplayShowTitleEnabled(false);
bar.setDisplayShowHomeEnabled(false);

mTabsAdapter = new TabsAdapter(this, mViewPager);
mTabsAdapter.addTab(bar.newTab().setText(R.string.login),
LoginFragment.class, null);
mTabsAdapter.addTab(bar.newTab().setText(R.string.economics),
EconFragment.class, null);
mTabsAdapter.addTab(bar.newTab().setText(R.string.elections),
ElectionsFragment.class, null);
mTabsAdapter.addTab(bar.newTab().setText(R.string.politics),
PoliticsFragment.class, null);
mTabsAdapter.addTab(bar.newTab().setText(R.string.science),
ScienceFragment.class, null);
mTabsAdapter.addTab(bar.newTab().setText(R.string.finance),
FinanceFragment.class, null);
mTabsAdapter.addTab(bar.newTab().setText(R.string.religion),
ReligionFragment.class, null);
mTabsAdapter.addTab(bar.newTab().setText(R.string.military),
MilitaryFragment.class, null);
mTabsAdapter.addTab(bar.newTab().setText(R.string.international),
InternationalFragment.class, null);
} 
```

和适配器：

```
public static class TabsAdapter extends FragmentPagerAdapter
    implements ActionBar.TabListener, ViewPager.OnPageChangeListener {
        private final Context mContext;
        private final ActionBar mActionBar;
        private final ViewPager mViewPager;
        private final ArrayList<TabInfo> mTabs = new ArrayList<TabInfo>();

        static final class TabInfo {
            private final Class<?> clss;
            private final Bundle args;

            TabInfo(Class<?> _class, Bundle _args) {
                clss = _class;
                args = _args;
            }
        }

        public TabsAdapter(FragmentActivity activity, ViewPager pager) {
            super(activity.getSupportFragmentManager());
            mContext = activity;
            mActionBar = activity.getActionBar();
            mViewPager = pager;
            mViewPager.setAdapter(this);
            mViewPager.setOnPageChangeListener(this);
        }

        public void addTab(ActionBar.Tab tab, Class<?> clss, Bundle args) {
            TabInfo info = new TabInfo(clss, args);
            tab.setTag(info);
            tab.setTabListener(this);
            mTabs.add(info);
            mActionBar.addTab(tab);
            notifyDataSetChanged();
        }

        public int getCount() {
            return mTabs.size();
        }

        public Fragment getItem(int position) {
            TabInfo info = mTabs.get(position);
            return Fragment.instantiate(mContext, info.clss.getName(), info.args);
        }

        public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {
        }

        public void onPageSelected(int position) {
            mActionBar.setSelectedNavigationItem(position);
        }

        public void onPageScrollStateChanged(int state) {
        }

        public void onTabSelected(Tab tab, FragmentTransaction ft) {
            mViewPager.setCurrentItem(tab.getPosition());
            Log.v(TAG, "clicked");
            Object tag = tab.getTag();
            for (int i=0; i<mTabs.size(); i++) {
                if (mTabs.get(i) == tag) {
                    mViewPager.setCurrentItem(i);
                }
            }
        }

        public void onTabUnselected(Tab tab, FragmentTransaction ft) {}

        public void onTabReselected(Tab tab, FragmentTransaction ft) {}

        public void onTabReselected(Tab tab, android.app.FragmentTransaction ft) {}

        @Override
        public void onTabSelected(Tab tab, android.app.FragmentTransaction ft) {    
            Object tag = tab.getTag();
            for (int i=0; i<mTabs.size(); i++) {
                if (mTabs.get(i) == tag) {
                    mViewPager.setCurrentItem(i);
                }
            }
        }

        public void onTabUnselected(Tab tab, android.app.FragmentTransaction ft) {}
    } 
```

这是一个在每个选项卡上制作按钮和小部件的类：

```
public class EconFragment extends SherlockFragment {

Polling activity;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    activity = (Polling)getActivity();

    View v = inflater.inflate(R.layout.categoryfragment, container, false);
    this.mainLayout = v;
    return v;
} 
```

只要您编辑在上述代码中扩展的 XML 文件（categoryfragment.xml），每个选项卡都会加载您想要放在页面上的任何内容（TextView、Button 等）。

# r - 转换为data.frame时矩阵列的数值被修改

> ID：10585589
> 
> 赞同：3
> 
> 时间：2012-05-14T14:43:56.800
> 
> 标签：r

在 R 2.13 上运行，我想有一个多列的 data.frame，第一个是数字类型，其他是字符类型。当我创建我的对象时，第一列的值正在以我不期望或不理解的方式进行转换。请看下面的代码。

> tmp <- cbind(1:10,rep("aa",10))
> 
> 时间

```
 [,1] [,2]
[1,] "1"  "aa"
[2,] "2"  "aa"
[3,] "3"  "aa"
[4,] "4"  "aa"
[5,] "5"  "aa"
[6,] "6"  "aa"
[7,] "7"  "aa"
[8,] "8"  "aa"
[9,] "9"  "aa"
[10,] "10" "aa" 
```

> tmp <- data.frame(tmp)
> 
> 时间

```
 X1 X2
1   1 aa
2   2 aa
3   3 aa
4   4 aa
5   5 aa
6   6 aa
7   7 aa
8   8 aa
9   9 aa
10 10 aa 
```

> tmp[,1] <- as.numeric(tmp[,1])
> 
> 时间

```
 X1 X2
1   1 aa
2   3 aa
3   4 aa
4   5 aa
5   6 aa
6   7 aa
7   8 aa
8   9 aa
9  10 aa
10  2 aa 
```

出于某种原因，第一列的值正在发生变化。我必须在这里做一些明显错误的事情，有人可以指出我的解决方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T14:46:04.133

```
> tmp <- data.frame(cbind(1:10,rep("aa",10)))
> str(tmp)
'data.frame':   10 obs. of  2 variables:
 $ X1: Factor w/ 10 levels "1","10","2","3",..: 1 3 4 5 6 7 8 9 10 2
 $ X2: Factor w/ 1 level "aa": 1 1 1 1 1 1 1 1 1 1 
```

正如您在上面看到的，`tmp$X1`已转换为一个因素，这就是导致您所看到的行为的原因。

尝试：

```
tmp[,1] <- as.numeric(as.character(tmp[,1])) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T14:49:42.527

@aix 的答案是正确的诊断。但是，您可能想要做的是直接创建一个数据框：

```
data.frame(1:10,rep("aa",10)) 
```

而不是`cbind`先 ing （生成矩阵）然后转换为数据框。

`data.frame`您可能希望为变量提供合理的名称，而不是通过上面的命令（`X1.10`和）最终得到的奇怪名称`rep..aa...10.`：

```
data.frame(var1=1:10,var2=rep("aa",10)) 
```

由于`data.frame`复制了它的参数，您可以进一步缩短它：

```
data.frame(var1=1:10,var2="aa") 
```

如果你真的想要一个字符向量而不是第二列的一个因子，你可以使用`stringsAsFactors=FALSE`或换`var2`行`I()`(ie `var2=I("aa")`)

# c# - 如何使用隐式运算符方法获取“查找用法”？

> ID：10585594
> 
> 赞同：8
> 
> 时间：2012-05-14T14:44:25.617
> 
> 标签：c#, .net, operators, implicit

我从不喜欢隐式运算符（更喜欢扩展方法），因为在代码中发生转换/转换时很难直观地看到。

想象一下，如果您有如下示例：

```
public static implicit operator Deal(string dealAsXml)
{
    //convert the xml into Deal object
} 
```

上面的隐式运算符可帮助您将 Xml 格式的交易转换/转换为交易对象。

通常当你右键单击一个方法时，你可以在它上面使用“查找用法”（或 Alt+F7），这非常有用，隐式运算符有什么类似的吗？

我认为这是尽可能使用扩展方法的另一个原因。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-14T14:48:17.347

也许像 Resharper 这样的东西可以做到，但我不确定。当我需要查找用法时，我会按照穷人的方式进行操作并删除隐式运算符，重新编译并查找错误。

我想理论上编译器可能会错过一个案例，如果它可以使用不同的隐式运算符（或切换到方法的“对象”类型重载），但它往往适用于我的用法。我确信有更好的解决方案，但到目前为止它对我有用。

编辑：只是有一个想法并进行了测试。将隐式运算符标记为`[Obsolete]`实际上会在您使用它的任何地方导致编译器警告！我想这将捕获那些有其他有效重载的极端情况，你会错过完全删除隐式运算符。

# rabbitmq - RabbitMQ 消息传递 - 初始化消费者

> ID：10585598
> 
> 赞同：4
> 
> 时间：2012-05-14T14:44:39.217
> 
> 标签：rabbitmq

我想使用 RabbitMQ 将对象的状态连续广播给可能正在收听的任何消费者。我想设置它，这样当消费者订阅时，它将获取最后一个可用状态......这可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T15:36:59.733

使用自定义的最后一个值缓存交换：例如 [https://github.com/squaremo/rabbitmq-lvc-plugin](https://github.com/squaremo/rabbitmq-lvc-plugin)

**最后值缓存交换**：

这是使用 RabbitMQ 的可插入交换类型功能的最后一个值缓存的非常简单的实现。

最后一个值缓存旨在解决以下问题：假设我正在使用消息传递向客户端发送一些更改值的通知；现在，当一个新客户端连接时，它不会知道该值，直到它发生变化。

最后一个值交换就像一个直接交换（绑定键与路由键比较是否相等）；但是，它还会跟踪与每个路由键一起发布的最后一个值，并且当绑定队列时，它会自动将绑定键的最后一个值排入队列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:10:21.353

[最近历史自定义交换](https://github.com/videlalvaro/rabbitmq-recent-history-exchange)是可能的。它说它将把最后 20 条消息放入队列中，所以如果它是可配置的，您可以将其更改为最后 1 条消息，然后就完成了。

如果这不起作用，即数量固定为 20，那么您可能必须处理队列中的前 19 条消息并从第 20 条获取状态。这有点烦人，但正如您所知，参数始终为 20，这应该没问题。

最后，如果这不适合您，您可能会将您的消费者设置为等到收到第一个状态，假设该状态被合理频繁地广播。一旦收到第一个状态，然后启动应用程序的其余部分。我在这里假设您在做其他事情之前需要状态。

# oauth-2.0 - 使用包含 access_token 的 Uri 从 Google Docs 下载

> ID：10585600
> 
> 赞同：2
> 
> 时间：2012-05-14T14:44:44.650
> 
> 标签：oauth-2.0, google-docs-api, google-drive-api

我正在为 Windows Phone 7 创建一个查看器应用程序。该应用程序已经处理了 OAuth2 内容并成功浏览了 Google Doc 的文件夹结构。

我使用[Google Documents List API 3](https://developers.google.com/google-apps/documents-list)。BTW 浏览在不使用请求标头的情况下完美运行，而是将 access_token 附加到请求 Uri。

现在应用程序需要向用户显示文件，如果可能，无需先下载它们。这意味着我想将 UI 的 Image.Source 设置为图像的 Uri，将 UI 的 MediaElement.Source 设置为视频的 Uri，将 BackgroundAudioPlayer.Track.Source 设置为音频文件的 Uri。显然我不能在这种情况下使用请求标头。

但是，似乎仅将 access_token 附加到下载 Uri 是行不通的。UI 元素失败并显示一般错误消息，如果我手动尝试使用网络浏览器（未登录到 Google），它会显示一个空白屏幕、401 错误或重定向到 Google 的登录页面。

是否可以仅通过定义 Uri 来下载/流式传输 Google 数据条目？如果是，那么 Uri 需要是什么样的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:11:43.063

出于安全原因，故意不允许使用 access_token URL 参数进行授权。基本上，如果用户要在浏览器上打开恶意文件（例如，包含一些 Javascript 的 html 就足够了），文件上的恶意代码可能会窃取 URL 中的访问令牌并将其发送给第三方坏人。

要访问该文件，您需要使用“授权”HTTP 标头进行授权。只需在请求中添加一个 HTTP 标头，如下所示：

```
Authorization: Bearer access_token_here 
```

# ssis - How can I deploy a single package from SQL Server Data Tools in SSIS 2012?

> ID：10585605
> 
> 赞同：6
> 
> 时间：2012-05-14T14:44:59.357
> 
> 标签：ssis, sql-server-2012

I've got a number of SSIS packages spread across multiple projects in SQL Server Data Tools (formerly BIDS), which I want to deploy to the SSIS Catalog DB on my server.

When I want to deploy an entire project, I can just right-click the project and hit Deploy, to start the SSIS deployment wizard. However, there doesn't seem to be an option to do this for a single package only, without redeploying the rest of the packages in the same project.

Does anyone know if it's possible to deploy just a single package using the deployment wizard, independently from the others in the project?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T17:37:44.303

这似乎无法通过部署向导或 SSDT 实现。[这个线程](http://social.msdn.microsoft.com/Forums/en-CA/sqlintegrationservices/thread/da414fc4-5f17-4378-b408-450d4d18038e)中的类似讨论......原始海报提出了一个（非常手动的）解决方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T18:23:10.010

您可能还想从 Codeplex（免费工具）获得[BIDSHelper 。](http://bidshelper.codeplex.com/wikipage?title=Deploy%20SSIS%20Packages)它包含一个实用程序，允许您从 BIDS 部署 SSIS 包。我还没有使用 SSDT 测试 BIDS Helper。此外，您可能还想从 Codeplex获取[SSIS 包管理器。](http://pacman.codeplex.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-19T18:04:04.287

您可以使用 SQL Server Management Studio 导入单个包：

1.  在 SSMS 中，连接到您的集成服务实例。
2.  右键单击相应的节点（文件系统或 MSDB）并选择**Import Package**。
3.  将包位置设置为**文件系统**。
4.  单击包路径旁边的三个点。浏览到您的 SSDT 项目并选择要导入的 .dtsx 文件。
5.  单击确定。如果提示覆盖现有包，请单击是。

# netty - Netty Proxy delayed response

> ID：10585607
> 
> 赞同：0
> 
> 时间：2012-05-14T14:45:12.010
> 
> 标签：netty

I am creating a proxy with Netty framework but I am noticing that the last messages that is received tends to delay before passing to the next node.

Design:

Client|<---------->| Proxy |<------------>| Server

Basically, the issue comes when the server initiates a message their is a delay before passing it to the client or if the server sends a subsequent message right after the first message then first message goes through and the second message delays for some seconds. Why is this the case? Is there some configuration parameter that I am missing?

## Startup.java

```
 Executor executor = Executors.newCachedThreadPool();
        ServerBootstrap sb = new ServerBootstrap(
                new NioServerSocketChannelFactory(executor, executor));

        // Set up the event pipeline factory.
        ClientSocketChannelFactory cf =
                new NioClientSocketChannelFactory(executor, executor);

        sb.setPipelineFactory(
                new ProxyPipelineFactory(cf, remoteHost, remotePort));

        sb.setOption("child.tcpNoDelay", true);
        sb.setOption("child.keepAlive", true);

        // Start up the server.
        sb.bind(new InetSocketAddress(localPort)); 
```

## ProxyPipelineFactory.java

```
@Override
public ChannelPipeline getPipeline() throws Exception {
    ChannelPipeline p = pipeline(); 
    p.addLast("handler", new ClientHandler(cf, remoteHost, remotePort));
    return p;
} 
```

## ClientHandler.java

```
@Override
public void channelOpen(ChannelHandlerContext ctx, ChannelStateEvent e)
        throws Exception {
    // Suspend incoming traffic until connected to the remote host.
    final Channel inboundChannel = e.getChannel();
    inboundChannel.setReadable(false);

    // Start the connection attempt.
    ClientBootstrap cb = new ClientBootstrap(cf);

        cb.setOption("child.tcpNoDelay", true);
        cb.setOption("child.keepAlive", true);
    ChannelPipeline p = cb.getPipeline();
    p.addLast("famer", new DelimiterBasedFrameDecoder(8192, false, new ChannelBuffer[]{ChannelBuffers.wrappedBuffer("</cmd>".getBytes())}));
p.addLast("handler", new ServerHandler(e.getChannel(), trafficLock));
    ChannelFuture f = cb.connect(new InetSocketAddress(remoteHost, remotePort));

    outboundChannel = f.getChannel();
    f.addListener(new ChannelFutureListener() {

        @Override
        public void operationComplete(ChannelFuture future) throws Exception {
            if (future.isSuccess()) {
                // Connection attempt succeeded:
                // Begin to accept incoming traffic.
                inboundChannel.setReadable(true);
            } else {
                // Close the connection if the connection attempt has failed.
                inboundChannel.close();
            }
        }
    });
}

@Override
public void messageReceived(ChannelHandlerContext ctx, final MessageEvent e)
        throws Exception {

    BigEndianHeapChannelBuffer msg = (BigEndianHeapChannelBuffer) e.getMessage();

    if (log.isDebugEnabled()) {
        byte[] bytes = new byte[msg.capacity()];
        msg.readBytes(bytes);
        msg.setIndex(0, bytes.length);
        StringBuilder out = new StringBuilder("\nPROXY[ ").append(e.getChannel().getRemoteAddress()).append(" ---> Server ]");
        out.append("\nMESSAGE length=").append(bytes.length).append("\n").append(new String(bytes));
        log.debug(out.toString());
    }

    synchronized (trafficLock) {
        outboundChannel.write(msg);
        // If outboundChannel is saturated, do not read until notified in
        // OutboundHandler.channelInterestChanged().
        if (!outboundChannel.isWritable()) {
            e.getChannel().setReadable(false);
        }
    }
} 
```

## ServerHandler.java

```
@Override
public void messageReceived(ChannelHandlerContext ctx, final MessageEvent e)
        throws Exception {
    BigEndianHeapChannelBuffer msg = (BigEndianHeapChannelBuffer) e.getMessage();
    proxy(e.getChannel(), msg);
}
private void proxy(Channel connection, ChannelBuffer raw) {
    synchronized (trafficLock) {
        inboundChannel.write(raw);
        // If inboundChannel is saturated, do not read until notified in
        // ClientHandler.channelInterestChanged().
        if (!inboundChannel.isWritable()) {
            connection.setReadable(false);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T08:58:38.850

您禁用了连接的可读性，您在哪里再次打开它以读取更多字节？您可以在 netty.io 上阅读[Prxoy Server](http://static.netty.io/3.5/xref/org/jboss/netty/example/proxy/package-summary.html)示例，它的功能完全相同。

```
private void proxy(Channel connection, ChannelBuffer raw) {
    synchronized (trafficLock) {
        inboundChannel.write(raw);
        // If inboundChannel is saturated, do not read until notified in
        // ClientHandler.channelInterestChanged().
        if (!inboundChannel.isWritable()) {
            connection.setReadable(false);
        }
    }
} 
```

# jsp - Implementing JSTL 1.2.1 in a Servlet 3.0 container on Tomcat 7

> ID：10585608
> 
> 赞同：1
> 
> 时间：2012-05-14T14:45:16.087
> 
> 标签：jsp, jstl, tomcat7

I am just learning JSP and am testing using JSTL on Tomcat 7\. I am able to successfully define and use custom tags. But when I attempt to implement JSTL the container throws two exceptions. How can I fix this so the jsp will translate properly?

> java.lang.ClassNotFoundException: javax.servlet.jsp.tagext.TagLibraryValidator java.lang.NoClassDefFoundError: javax/servlet/jsp/tagext/TagLibraryValidator

I'm using the following jar files.

> javax.servlet.jsp.jstl-1.2.1.jar javax.servlet.jsp.jstl-api-1.2.1.jar

I have placed the two JSTL 1.2.1 jars in WEB-INF/lib of the test web app and the CLASSPATH for my JRE. I have also marked the two jars for export in the build path options in Eclipse.

**index.jsp**

```
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Insert title here</title>
    </head>
    <body>
        <c:out value="JSTL works."></c:out>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T14:59:35.737

> *java.lang.NoClassDefFoundError: javax/servlet/jsp/tagext/TagLibraryValidator*

这个类是 JSP 2.0 的一部分。Tomcat 是一个 Servlet 3.0 / JSP 2.2 容器。确保您`web.xml`的声明符合 Servlet 3.0。

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app 
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
    version="3.0">

    <!-- Config here. -->

</web-app> 
```

此外，您`jsp-api.jar`的`/WEB-INF/lib`. 否则只会发生冲突。另请参阅[如何在我的 Eclipse 项目中导入 javax.servlet API？](https://stackoverflow.com/questions/4076601/how-do-i-import-the-javax-servlet-api-in-my-eclipse-project/4076706#4076706)

* * *

> *我已将两个 JSTL 1.2.1 jar 放在测试 Web 应用程序的 WEB-INF/lib 中*

这应该足够了。如果清理`web.xml`和类路径仍然不能解决问题，那么您可能根本没有正确的 JAR。在我们的[JSTL wiki 页面](https://stackoverflow.com/tags/jstl/info)中，您可以找到指向单个[jstl-1.2.jar](http://download.java.net/maven/1/jstl/jars/jstl-1.2.jar)文件的下载链接。将其放入`/WEB-INF/lib`并删除其他 JAR。

* * *

> *和我的 JRE 的 CLASSPATH。*

请不要那样做。只需将 JSTL JAR 放入`/WEB-INF/lib`就足够了。还要确保不要在您的`JRE/lib`或`JRE/lib/ext`. 只是不要触摸这些文件夹。Webapp 特定的库应该放在`/WEB-INF/lib`. 如果您使用的是 IDE，它将自动执行所有必要的魔法。您甚至不需要修改 buildpath 属性。`CLASSPATH`环境变量**仅**`java`在您在命令控制台中运行命令时使用，即使在没有`-cp`,`-classpath`和`-jar`参数的情况下运行它也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-23T17:44:09.187

对于在 apache tomcat 7 上运行，将这些添加到您的 POM 中可能是合适的。这些 jar 不像 glassfish 那样引用 javax.servlet jar，因此不需要排除。

```
<dependency>
    <groupId>org.apache.taglibs</groupId>
    <artifactId>taglibs-standard-spec</artifactId>
    <version>1.2.1</version>
</dependency>
<dependency>
    <groupId>org.apache.taglibs</groupId>
    <artifactId>taglibs-standard-impl</artifactId>
    <version>1.2.1</version>
</dependency> 
```

# ruby-on-rails - Rails 3 测试框架混乱

> ID：10585619
> 
> 赞同：6
> 
> 时间：2012-05-14T14:45:59.783
> 
> 标签：ruby-on-rails, ruby-on-rails-3, unit-testing, tdd, bdd

多年来，我一直在观看 Ryan Bates 的 RailsCasts，而且我也是该网站付费部分的客户。我过去是通过观看 Cucumber 剧集来学习 BDD 的。

现在我已经了解了 TestUnit、RSpec、Capybara 和 MiniTest。我开始对什么是什么感到困惑。

这4个项目有什么区别？我知道显然 Cucumber 执行纯文本功能，我想这可以被认为是集成测试。

但现在我也看到最新版本的 Cucumber 需要 MiniTest？Cucumber 只是一个位于测试框架之上的 DSL 吗？

我也知道 RSpec 有自己的用于断言的语法糖，即“描述”块。MiniTest 似乎也支持这种语法。

我知道 Capybara 用于查看生成的网页内容，我想。

这是我的问题：

如果我正在创建一个新的 Rails 3.2 应用程序，我应该使用这些测试程序的哪种组合？额外有用的是一个列表，该列表解释了这些 gem 及其相关流程如何在适用的情况下相互补充，例如：

```
Cucumber is a DSL for driving BDD
Cucumber is for integration tests and is based on creating user stories that are customer-readable
It implements its tests behind the scenes via MiniTest
MiniTest is a new testing framework that comes with Ruby 1.9 and is very fast.
MiniTest is also used for unit testing, such as testing controllers and models
It does not yet have as many features as RSpec
Cucumber also uses Capybara to access DOM elements from a javascript-enabled browser simulator such as Selenium
When you test in Rails, you have the ability to do the following kinds of tests: controllers, views, models, and integration (MVC together)
Some people just do integration and model testing, because they feel that integration testing handles enough of the controller and view testing itself, and anything too complex can simply be moved up to the model 
```

非常感谢您为我清除这些想法提供的任何帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T15:16:54.417

好的，让我根据自己的经验尝试解释一下

Cucumber 是一种 ATDD（或 BDD）工具，可让您使用面向业务的领域语言编写测试。它的主要用途是作为与您的产品所有者的对话工具。您无需编写详细的需求，而是将这些需求表达为被测系统的示例。实际上，每个黄瓜测试都成为必须满足的业务需求。

Cucumber 工具本身将这些纯文本语句转换为一个小模块，供您在其中执行 ruby​​ 代码。您在步骤定义中使用的 Ruby 库完全取决于您正在处理的项目。

描述 Cucumber 最安全的方式是它是一个测试框架，强调 IT 和业务合作伙伴之间的通信，这就是它变得如此流行的原因。

Rspec 和 Minitest 是其他具有其他优势的框架，但缺乏这种业务可读性因素，因为它们主要是代码，对于非技术人员来说几乎没有可读性。这不一定是件坏事，尤其是如果您的产品负责人更加放任自流的话。

这与 Capybara 之类的东西有什么关系？Capybara 是一个集成测试自动化库，它在 Rack::Test 框架上驱动无头浏览器以进行非常快速的测试，并具有高度可读的 DSL。唯一的缺点是 Rack::Test 不支持 javascript，因此如果您正在运行 javascript 测试，它提供了一种故障转移到 Selenium 的方法。Rspec 和 Cucumber 都有触发此故障转移的机制。

还有很多其他的 Ruby 自动化库。例如，如果您正在针对非 Rails Web 应用程序进行测试，您的黄瓜场景可能会使用 Watir-Webdriver 定义，它将像 Capybara 在 Javascript 模式下那样驱动完整的 Web 浏览器。主要区别在于 WW 比 Capybara 拥有更强大的选择器集，因此编写起来会更容易一些，尤其是在您的代码不是超级干净的情况下（Capybara 仅支持按 ID、Value 和 Text 进行选择，而 WW 支持选择几乎任何东西）

因此，如果您有兴趣的产品所有者或需要用于测试场景的通用语言，您可能会想要使用 RSpec 或 Minitest 进行单元测试（或默认的 Test::Unit），并使用 Cucumber 进行集成测试。如果不这样做，您可以将集成测试编写为 Rspec 示例或 minitest 等价物，而不会损失太多。

# php - nginx echo 像 apache

> ID：10585625
> 
> 赞同：0
> 
> 时间：2012-05-14T14:46:09.500
> 
> 标签：php, apache, nginx

我在 php+mysql 中有脚本，它只是打印出数据库。问题是它非常大，所以我需要以 1000 个项目循环回显它。我曾经在 apache 上运行它，它只是回显 1000 行，然后等待处理 mysql 查询，然后回显另一个 1000 等等，直到它打印出所有内容。

现在我切换到 nginx，服务器现在等待整个页面加载，这意味着从数据库中打印出 100 000 个项目，这可能需要很多时间，而且通常只是超时。有什么方法可以解决这个问题并让它像在 apache 上一样工作吗？

谢谢

# ruby-on-rails - Ruby on Rails jquery ajax 验证

> ID：10585626
> 
> 赞同：1
> 
> 时间：2012-05-14T14:46:14.463
> 
> 标签：ruby-on-rails, jquery

我正在研究 ruby​​ on rails，我是一个绝对的初学者。
我的问题是：
我有一个用户注册表单，我想验证用户名是否已经存在并以 json 格式返回状态。我想通过使用 jquery ajax 来实现这一点，我该怎么做。

```
def check_user
 @user=User.find_by_username(params[:username'])
 respond_to do |format|
   format.html
   format.json { render json: !@user }
  end
end 
```

我的application.js：

```
$("#user_name").change(function(){
  //How do i call my check_user action and get a response
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:50:11.303

JSON格式是什么意思，如果你喜欢使用某种验证。我推荐使用[Railscast](http://railscasts.com/episodes/263-client-side-validations)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:50:21.123

[查看API 文档中的](http://api.rubyonrails.org/classes/ActiveRecord/Validations/ClassMethods.html)validates_uniqueness_of

# architecture - 程序计数器更改

> ID：10585631
> 
> 赞同：0
> 
> 时间：2012-05-14T14:46:30.233
> 
> 标签：architecture, language-agnostic, hardware, program-counter

在 PC（程序计数器）寄存器更改的所有可能性中，我发现了这些：

```
1) PC increases its value with loading new instruction
2) with jumps and branches
3) with calling subroutine
4) with return from subroutine 
```

这些是全部还是我错过了什么？

我来自[这篇文章](http://en.wikipedia.org/wiki/Program_counter)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T15:17:34.447

还有一些：

*   硬件中断改变PC执行中断服务程序，然后返回被中断的程序。
*   异常情况（如除以 0 或页面错误等异常）以类似的方式改变 PC。
*   调试中断也这样做。
*   系统调用（它们的调用和返回）也会改变 PC。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:09:49.190

我相信这就是全部，假设非本地跳转作为 2 的一部分（例如 setjmp、longjmp）。

# matlab - 在Matlab中使用向量作为for循环中的范围

> ID：10585632
> 
> 赞同：7
> 
> 时间：2012-05-14T14:46:31.717
> 
> 标签：matlab

我想知道在 Matlab 的 for 循环中使用向量作为范围的规则是什么？

例如，

```
range = [0.1:0.01:2]'; % wrong
range = [0.1:0.01:2]; % correct

for i = range
i
end 
```

1.  为什么如果`range`是列向量，它不起作用，而如果`range`是行向量，它会？
2.  将`i = range`被解释为`i`取 的每个值`range`，还是`i`用向量分配`range`？

谢谢~

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-14T15:13:03.640

更一般地说，`range`可以是一个矩阵，并且循环变量在其列上循环。

```
range = rand(3,3);
for col = range
col
end

col =
      0.86341
      0.11625
      0.20319
col =
      0.59721
     0.098357
       0.8356
col =
      0.89578
      0.46217
      0.93585 
```

所以如果`range`是一个行向量，它将遍历它的值。但是如果`range`是一个列向量，它将遍历该单列作为其值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T14:52:00.367

来自[http://www.mathworks.co.uk/help/techdoc/ref/for.html](http://www.mathworks.co.uk/help/techdoc/ref/for.html)：

> ```
> for index = values
>    program statements
>           :
> end 
> ```
> 
> ...`values`具有以下形式之一：
> 
> `valArray`
> 
> `valArray`在每次迭代时从数组的后续列创建列向量索引 。例如，在第一次迭代中， `index = valArray(:,1)`...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:52:39.647

1.  就是这样，因为就是那样。我认为对此没有任何深刻的解释。
2.  如果您进行了实验，您会发现，一旦您进行了赋值，`range = [0.1:0.01:2]`那么调用的变量`range`就是一个包含范围内值的行向量。您的循环将正常工作。就像它开始一样

    `for i = [0.1 0.11 0.12 ...]`

# java - SomeClass.class 的 Java 语法

> ID：10585643
> 
> 赞同：1
> 
> 时间：2012-05-14T14:47:49.940
> 
> 标签：java, android, syntax

最近我在Android中遇到了以下语法：

```
Intent i = new Intent(getApplicationContext(), SomeActivityClass.class); 
```

有人可以解释一下`SomeActivityClass.class`被调用时会发生什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T14:50:19.857

`class`是每个类的静态类字段，其类型`Class<?>`表示该特定类的类型。它通常用于通过[反射](http://docs.oracle.com/javase/tutorial/reflect/index.html)来实例化一个类（如在意图情况下）。

即 - 之后：

```
Class<?> clazz = SomeActivityClass.class; 
```

`clazz`将引用`Class<?>`代表`SomeActivityClass`该类的类型的对象。

链接：

*   [类文档](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html)
*   [使用反射](http://java.sun.com/developer/technicalArticles/ALT/Reflection/)（包括类实例化）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:50:39.677

调用时`Intent`，它的启动`SomeActivityClass` `Activity`方式与任何其他 相同`Activity`。即调用`onCreate()`，然后`onStart()`等。

请参阅此处文档中的流程图`Activity`... ![http://developer.android.com/images/activity_lifecycle.png](../Images/b0a44f6c0c4cc85c7609ad8d0b66e1b1.png)

或者在这里查看活动文档... [http://developer.android.com/reference/android/app/Activity.html](http://developer.android.com/reference/android/app/Activity.html)

# php - 如何为网址缩短器制作即时缩短链接

> ID：10585645
> 
> 赞同：-2
> 
> 时间：2012-05-14T14:47:55.260
> 
> 标签：php, javascript, url

我最近做了一个[网址缩短](http://n1x.co.uk)器，我想在我的网站上制作一个“即时缩短”书签链接，就像[YOURLS](http://yourls.org/#About)一样，所以你可以为链接添加书签，然后转到任何网页，然后点击书签，它会自动缩短地址，将其添加到数据库并在弹出窗口中告诉您缩短的 url。

我不知道该怎么做，请帮助我！

**编辑：**这是您当前使用书签链接缩短的代码：

`javascript:(function()%7Bvar%20d=document,s=d.createElement('script');window.yourls_callback=function(r)%7Bif(r.short_url)%7Bprompt(r.message,r.short_url);%7Delse%7Balert('An%20error%20occured:%20'+r.message);%7D%7D;s.src='http://nix-pix.co.uk/public/admin/index.php?u='+encodeURIComponent(d.location.href)+'&jsonp=yourls';void(d.body.appendChild(s));%7D)();`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:59:41.763

通常使用这样的书签：

```
javascript:u=encodeURIComponent(location.href);s='http://urlshortener.com/shorten.php?url='+u;window.open(s,'shortened','location=no,width=400,height=300'); 
```

这将获取当前页面的 URL 并打开一个指向 urlshortener.com/shorten.php?url=[要缩短的 url] 的新窗口。YOURLS 使用的代码更复杂，但可能做的事情大致相同。您只需在上面的代码中更改新窗口打开的 URL。

# orm - CF ORM 中的错误继承？

> ID：10585646
> 
> 赞同：0
> 
> 时间：2012-05-14T14:47:55.993
> 
> 标签：orm, coldfusion, coldfusion-9

我有 2 个实体

AlienImage.cfc MonsterImage.cfc

这两个实体都继承自包含图像名称的 Image.cfc。

我的问题是，当我使用以下内容时....

World.cfc 属性名称="图像" 奇异名称="图像" 类型="数组" 字段类型="一对多" cfc="AlienImage" fkcolumn="worldID" cascade="all" remotingFetch="true";

当我在这种关系上加载 world.cfc remotingFetch 时，也应该带回图像名称，因为 AlienImage 扩展了 image.cfc，但现在图像是空白的，为什么？

这是 CF ORM 中的错误吗？？？？

```
"DATA": [
        {
            "worldname": "some world",
            "images": [
                {}
            ],

        }
    ], 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:33:12.350

我的建议是仔细检查数据库表，并确保您的 worldID 连接或子选择（PK 表示“某个世界”）实际上与图像相关联。数据似乎没有正确保存。

# qt - Qt translation file (qm) info

> ID：10585652
> 
> 赞同：4
> 
> 时间：2012-05-14T14:48:17.757
> 
> 标签：qt, translation

I have some number of qm files for my app. (pr_en.qm, pr_ru.qm). I can load they by

```
translator.load(fileName, '.');
qApp->installTranslator(translator); 
```

I want build dynamic menu (English, Russian) to select language. But, how can I extract such constants (English, Russian) from qm file instead of it's names (pr_en.qm, pr_ru.qm). Thanks.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T15:20:55.270

I would suggest two ways of doing it:

First would be declaring special translator field like:

`tr("__LANGNAME__")` that would be in every translation file filled with proper language name (even native). Then you could list all available translations, load them one by one and use `QTranslator::translate(const char * context, const char * sourceText, const char * disambiguation = 0)` method.

Example:

```
QStringList availableLanguages;
QDirIterator qmIt(pathToQm, QStringList() << "*.qm", QDir::Files);
while(qmIt.hasNext())
{
    qmIt.next();
    QFileInfo finfo = qmIt.fileInfo();
    QTranslator translator;
    translator.load(finfo.baseName(), pathToQm);
    availableLanguages << translator.translate("__LANGNAME__");
}

qDebug() << availableLanguages; 
```

My second aproach would be with QLocale and QLocale::Language. I would create QLocale object for each base name of file in qm dir, and then use QLocale::Language enum to get language name with `QLocale::languageToString` method.

# android - 这个对话框会泄漏内存吗？

> ID：10585653
> 
> 赞同：1
> 
> 时间：2012-05-14T14:48:22.013
> 
> 标签：android, memory-leaks, dialog

这不是我的代码。我刚到这个网站，正在做代码审查。

他们有一个类是 Dialog 的扩展。它被定义为单例。

在第一次调用时，上下文被传递给 getInstance 方法。它实例化将接收到的上下文传递给构造函数中的“超级”的类。然后它保存它 - 与任何单例相同。

然后显示对话框。用户交互后，它会启动一个新活动并通过“closeDialog”关闭对话框。

但是，它仍然存在，因为实例的静态持有者仍然存在。这是否会保留创建它的活动（并在创建实例时通过“getInstance”调用传递到“super()”）？

它们使实例保持活动状态，因为它们随后将其用于来自其他地方的调用，并且具有需要传递的值。

我知道这段代码很臭，但我想确保它确实泄漏内存（第一个活动），然后我让他们重新编写它（或自己重新编写它——这更有可能）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:02:19.417

是的，它可以。如果代码启动其他活动，那么是的。如果只使用过一项活动，那么很可能不会。原因是，必须使用活动上下文来实例化对话框（它会与应用程序上下文一起崩溃）。如果该活动被设置为销毁，垃圾收集将不会清理它，直到所有对它的引用都被销毁。如果这个单例对话框存在于活动之外（应该是这种情况），那么它将继续引用活动并阻止 GC 清理它。您可以在此处阅读有关泄漏上下文的更多信息：[避免内存泄漏](http://android-developers.blogspot.com/2009/01/avoiding-memory-leaks.html)

正如您所说，代码很糟糕，并且使用这样的单例对话框是完全错误的（无论它是否泄漏）。有更好的方法来维护状态之间的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-19T07:40:09.000

与其在类中创建和保存，不如`Dialog`在`Singleton`该类中构建对话框，`Singleton`但将`Dialog`实例返回给调用者类。所以调用`Activity`将负责解雇`Dialog`，我相信不会有内存泄漏。

# php - 仅在否定词之后否定带有 POS 标记的句子

> ID：10585654
> 
> 赞同：0
> 
> 时间：2012-05-14T14:48:26.157
> 
> 标签：php, regex

考虑以下字符串：

```
I am mad and will not ever set foot in that store again 
```

我正在使用 POS 标记器来标记这样的字符串：

```
I/NN am/VBP mad/JJ and/CC will/MD not/RB ever/RB set/VBN foot/NN in/IN that/IN 
store/NN again/RB 
```

现在，我使用正则表达式将“不”连接到、ao、动词，同时忽略否定词（从不，也不是等）

```
preg_replace(
  "/(\s)(?:(?!never|neither|dont|wont|not|no)(\w*))\/(JJ|MD|RB|VB|VBG|VBN)\b/", 
  "$1not$2",
  $sentence
); 
```

这导致：

```
I am notmad and notwill notever notset foot in that store notagain 
```

但是，我想要的只是将“不”连接到出现在（第一个）否定词**之后的动词。**注意`mad`and`will`而不是`notmad`and `notwill`：

```
I am mad and will notever notset foot in that store notagain 
```

所以我认为首先我应该在句子中寻找任何否定词 (never|neither|dont|wont|not|no)，然后只从那里执行正则表达式。但是我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T18:20:40.403

执行此操作的最简单方法似乎是`preg_split`在您的标记句子上使用将其分成两部分：第一个否定词之前的部分和该否定词之后的部分。保留分隔符 (PREG_SPLIT_DELIM_CAPTURE)，然后运行您在第二部分编写的正则表达式，之后您可以简单地将这两个字符串再次连接在一起。最后，您可以使用正则表达式删除 PoS 标签以获得`I am mad and will notever notset foot in that store notagain`，即没有 PoS 标签。

# java - java.lang.ClassNotFoundException：org.apache.log4j.Level

> ID：10585656
> 
> 赞同：23
> 
> 时间：2012-05-14T14:48:29.887
> 
> 标签：java, hibernate, exception, log4j, slf4j

我正在尝试在摇摆应用程序中使用休眠 3.5.1 final，这是我正在使用的罐子：

*   **hibernate-core-3.5.1-Final**
*   **hibernate-entitymanager-3.5.1-Final**
*   **hibernate-jpa-2.0-api-1.0.0.Final**
*   **hibernate-annotations-3.5.1-Final**
*   **hibernate-commons-annotations-3.2.0.Final**
*   **dom4j-1.6.1**
*   **slf4j-api-1.6.4**
*   **slf4j-log4j12-1.6.4**

当我尝试运行应用程序时，我收到以下错误：

```
Failed to instantiate SLF4J LoggerFactory
Reported exception:
java.lang.NoClassDefFoundError: org/apache/log4j/Level
    at org.slf4j.LoggerFactory.bind(LoggerFactory.java:128)
    at org.slf4j.LoggerFactory.performInitialization(LoggerFactory.java:108)
    at org.slf4j.LoggerFactory.getILoggerFactory(LoggerFactory.java:279)
    at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:252)
    at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:265)
    at org.hibernate.cfg.Configuration.<clinit>(Configuration.java:165)
    at org.hibernate.ejb.Ejb3Configuration.<clinit>(Ejb3Configuration.java:127)
    at org.hibernate.ejb.HibernatePersistence.createEntityManagerFactory(HibernatePersistence.java:54)
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:48)
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:32)
    at com.xeno.xecamp.desktopManagement.Main.main(Main.java:16)
Caused by: java.lang.ClassNotFoundException: org.apache.log4j.Level
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:248)
    ... 11 more
Exception in thread "main" java.lang.NoClassDefFoundError: org/apache/log4j/Level
    at org.slf4j.LoggerFactory.bind(LoggerFactory.java:128)
    at org.slf4j.LoggerFactory.performInitialization(LoggerFactory.java:108)
    at org.slf4j.LoggerFactory.getILoggerFactory(LoggerFactory.java:279)
    at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:252)
    at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:265)
    at org.hibernate.cfg.Configuration.<clinit>(Configuration.java:165)
    at org.hibernate.ejb.Ejb3Configuration.<clinit>(Ejb3Configuration.java:127)
    at org.hibernate.ejb.HibernatePersistence.createEntityManagerFactory(HibernatePersistence.java:54)
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:48)
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:32)
    at com.xeno.xecamp.desktopManagement.Main.main(Main.java:16)
Caused by: java.lang.ClassNotFoundException: org.apache.log4j.Level
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:248) 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-14T14:52:41.400

您还需要在类路径中包含 Log4J JAR 文件。

请注意，这`slf4j-log4j12-1.6.4.jar`只是一个适配器，可以通过 SLF4J API 使用 Log4J。它不包含 Log4J 的实际实现。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T14:52:38.917

您需要下载[log4j](http://logging.apache.org/log4j/1.2/index.html)并添加到您的类路径中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-21T03:36:27.830

在我的环境中，我只是将这两个文件添加到类路径中。并且工作正常。

```
slf4j-jdk14-1.7.25.jar
slf4j-api-1.7.25.jar 
```

# data-access-layer - 生成嵌套的 CRUD 表单

> ID：10585663
> 
> 赞同：0
> 
> 时间：2012-05-14T14:48:49.590
> 
> 标签：data-access-layer, crud, nested-forms, web2py, abstraction

从逻辑的角度来看，有时它是没有意义的，例如，在添加客户之前添加地址。

```
db.define_table('address',
   Field('line1','string', required=True),
   Field('line2','string'),
   Field('suburb','string', required=True),
   Field('post_code','integer'),
   Field('email','string')
)

db.address.post_code.requires = IS_INT_IN_RANGE(0000, 9999)
db.address.email.requires     = IS_EMAIL()

db.define_table('customer',
   Field('name', 'string', required=True, unique=True),
   Field('locations', 'list:reference db.address', required=True),
   Field('comment', 'string')
) # quick aside: how would I ensure there isn't another customer with same name+location?

db.address.requires = IS_IN_DB(db, db.address, '%(line1)s' + ', ' + '%(suburb)s', multiple=True) 
```

因此，如果我可以生成一种允许您创建客户的表格，并附上地址，那么管理将变得更加合乎逻辑。

但是，能够从数据库中已经存在的记录中进行选择仍然很有用，但是只有一个“添加”按钮——使用 javascript 向下滚动——如果字段为空，它将默认打开（并且 .requires 不是） .

**我将如何生成这个嵌套的 CRUD？**

感谢所有建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:34:04.457

我相信官方书中的这个主题在某种程度上涵盖了它：

[http://web2py.com/books/default/chapter/29/7#One-form-for-multiple-tables](http://web2py.com/books/default/chapter/29/7#One-form-for-multiple-tables)

基本上，您必须使用 sqlform.factory。您的控制器将首先调用地址上的插入，然后获取地址的 ID，然后使用该 ID 调用客户上的插入。

不幸的是，这可以处理您的添加，但不能处理下拉列表。就这一点而言，您需要编写自己的 html。没有自动 CRUD。

# android - 如何使用注释处理器检查整个源代码树？

> ID：10585665
> 
> 赞同：12
> 
> 时间：2012-05-14T14:48:53.097
> 
> 标签：android, dalvik, annotation-processing

我有很多处理特定消息类型的处理程序类。要注册所有这些处理程序，我需要知道存在哪些处理程序。目前，它们都使用特定的注释进行注释，我使用 Java 6 注释处理器来获取所有这些注释，并创建一个 Register 类来保存每个注释类型的实例。

如果同时构建整个树，这非常有用，但如果只构建一个带注释的类（例如，当我在 Eclipse 中保存文件时），处理器只会看到该类型，并构建一个不完整的寄存器。在这种情况下如何检查其他类型？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T21:20:11.410

我现在已经很好地解决了这个问题。我所做的有点骇人听闻，但基本上对于我看到的每个带注释的类，我都会将其名称添加到 HashSet。然后我使用 Filer.getResource() 打开一个文件，其中记录了所有以前看到的带注释的类，并将它们也添加到 HashSet 中。然后我生成寄存器类，并使用 Filer.createResource() 将整个 HashSet 写入同一资源。如果我删除带注释的类型，这将导致问题，因为它仍会记录在该文件中，但我可以清理项目或删除该文件来解决它。

编辑：另外，我相信将适当的“原始元素”传递给 Filer.createSource() 应该允许 Eclipse 正确跟踪这些依赖项，但事实并非如此。也许那是一个 Eclipse 错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T01:49:17.377

不出所料，编译时注释处理器只处理正在编译的文件。Eclipse 使用增量编译来节省时间，所以简短的回答是您不能期望您的注释处理器一次看到所有类型。

一种解决方案是更改您的体系结构以支持增量编译。例如，对于每个 annotated `HandlerClass`，生成一个`RegisterHandlerClass`注册该处理程序类的类。

也就是说，听起来你正在做的事情最好在运行时完成，也许在[Reflections](http://code.google.com/p/reflections/)这样的工具的帮助下。

# jquery - 在随机列表项上添加类

> ID：10585668
> 
> 赞同：3
> 
> 时间：2012-05-14T14:48:57.657
> 
> 标签：jquery, random

我有一个带有列表项的无序列表。我有一个名为“活动”的类，我希望将其随机添加到列表项中。我现在有这个：

```
// I want this class added on a random list item
$("#gallery li:first-child").addClass("on"); 
```

数学随机？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T14:53:37.437

```
var random = Math.floor(Math.random() * 1000);

var $li = $("#gallery li");
$li.eq(random % $li.length).addClass("on"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T14:51:31.307

试试下面的东西，

```
var $li = $('#gallery li');
$li.eq(Math.floor(Math.random()*$li.length)).addClass("on"); 
```

**编辑：**更新以避免重新查询 DOM`li`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T14:54:07.187

```
var licount = $("#gallery li").length;
var randomnumber=Math.floor(Math.random()*(licount+1));

$("#gallery li:nth-child("+randomnumer+")").addClass("on"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T14:52:45.730

[`Math.random`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/random)是你如何获得随机数，所以你需要做的就是获得一个介于s`0`和 s 之间的数字`<li>`（减 1），然后将类添加到其中。

```
var $lis = $("#gallery li");
$lis.eq( Math.floor( Math.random() * $lis.length ) ).addClass("on"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T14:54:55.247

如果你知道里数（这里是 10 里）

```
rand=Math.floor(Math.random() * 10); // 0 to 9
$("#gallery li").get(rand).addClass("on"); 
```

别的

```
var $li=$("#gallery li");
rand=Math.floor(Math.random() * $li.length()); // 
$li.eq(rand).addClass("on"); 
```

# c# - C# - 组件参考 - Dispacher.CheckAccess()

> ID：10585669
> 
> 赞同：2
> 
> 时间：2012-05-14T14:48:58.387
> 
> 标签：c#, wpf, reference, dispatcher, ref

我有个问题。我需要使用传递一个参数的函数（对控件的引用）：

```
public void recalculateFontSize(ref TextBlock component)
{
...
} 
```

我想用它，但不知道如何用“ref”关键字连接 Dispatcher：S

```
 private void textResizer(ref TextBlock component)
    {
        if (component.Dispatcher.CheckAccess())
        {
            textUtils.recalculateFontSize(ref component);
        }
        else
        {
            component.Dispatcher.Invoke(new Action<TextBlock>(textResizer), component);
        }
    } 
```

如何修改component.Dispatcher.Invoke ???

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:01:00.477

我会说，传递 UI 控件总是几乎是个坏主意。

为什么不稍微调整一下逻辑，以便您可以在视图中使用绑定（我认为您使用的是 WPF，因为涉及到 Dispatcher）

这样您的 ViewModel 将公开 RecalculateFontSize 命令，然后您的 View 绑定到一个 Font Size 属性，ViewModel 可以根据每个请求更改该属性。

这样，在您的命令中，您可以通过 Dispatcher.CheckAccess 检查访问并在 UI 线程中调用 FontSize 的重新计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:03:06.793

您不能在匿名方法主体中使用 ref 或 out 参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T12:33:09.230

好的，谢谢。但是还有另一个想法可以做到这一点。可以简单地使用这样的东西：

```
<Viewbox>
   <TextBlock Text="Bla bla bla" TextWrapping="Wrap" />
</Viewbox> 
```

效果很好。

另一种方法是创建 ObjectDataProvider 资源并将我们的 TextBlock 绑定到它。这里有更多信息：http: [//msdn.microsoft.com/en-us/library/aa348824.aspx](http://msdn.microsoft.com/en-us/library/aa348824.aspx)

# javascript - 带有 javascript 的东西可能与语言环境有关

> ID：10585672
> 
> 赞同：0
> 
> 时间：2012-05-14T14:49:06.260
> 
> 标签：javascript, forms, jstl

我通过单击页面上的按钮显示了确认窗口。对于俄语语言环境，它可以完美运行，但是当我将其切换为英语时，它什么也没显示。这是按钮的代码：

```
<form method="POST" 
action="Link.do?method=newsList"
onsubmit="return confirm('<fmt:message key="body.onsubmit.cancel" />')">
<input type="submit" 
    value="CANCEL">
</form> 
```

还想说该`body.onsubmit.cancel`属性存在于所有属性文件中，我可以成功连接到它。真不知道怎么了。将不胜感激您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:54:56.083

the way to debug this is to see the source of the page that was sent to the client when you switch to the locale that does not work and see if the code is correct. for example if your message contains quotes then the syntax will be invalid in the resulting script if the quotes are not escaped.

# iphone - 将 UIImage 设置为 UIBarButton 项

> ID：10585678
> 
> 赞同：0
> 
> 时间：2012-05-14T14:49:22.020
> 
> 标签：iphone, objective-c, ios, uibarbuttonitem

我似乎无法将图像添加到此 UIBarButtonItem 而不会在触摸时崩溃：

```
 UIBarButtonItem *backButton = [[UIBarButtonItem alloc] initWithTitle:@"Back"
                                                                       style:UIBarButtonItemStylePlain target:nil action:nil];
        self.navigationItem.backBarButtonItem = backButton;
        [backButton release]; 
```

此代码添加了一个图像，但由于从 UIButton 分配给 UIBarButtonItem * 的指针类型不兼容，因此在触摸时它会崩溃：

```
 //Setup Custom Button

    UIButton *button = [[UIButton alloc] init];

    button.frame = CGRectMake(0,0,44,44);

//    [button addTarget:self action:@selector(showInfo) forControlEvents:UIControlEventTouchUpInside];

    self.navigationItem.backBarButtonItem = button;

    [button setBackgroundImage:imgIcon forState:UIControlStateNormal];

    self.navigationItem.leftBarButtonItem = [[[UIBarButtonItem alloc] initWithCustomView:button] autorelease];

    [button release]; 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:52:10.577

您必须将 buttonStyle 设置为`custom`not`UIBarButtonItemStylePlain`

进而`[barbuttonitem setCustomView:anImageView];`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:01:19.117

打电话

```
self.navigationItem.leftBarButtonItem = [CustomBarButton createNavBackBarButtonItemWithTitle:NSLocalizedString(@"Back", @"") target:self action:@selector(actionBack:)]; 
```

CustomBarButton 具有 createNavBackBarButtonItemWithTitle 类功能

```
+(UIBarButtonItem *)createNavBackBarButtonItemWithTitle:(NSString *)t target:(id)tgt action:(SEL)a
{
UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
// Since the buttons can be any width we use a thin image with a stretchable center point
UIImage *buttonImage = [[UIImage imageNamed:@"back_button_up.png"] stretchableImageWithLeftCapWidth:5 topCapHeight:0];
UIImage *buttonPressedImage = [[UIImage imageNamed:@"back_button_over.png"] stretchableImageWithLeftCapWidth:5 topCapHeight:0];

[[button titleLabel] setFont:[UIFont boldSystemFontOfSize:12.0]];
[button setTitleColor:[UIColor blackColor] forState:UIControlStateNormal];
[button setTitleColor:[UIColor blackColor] forState:UIControlStateHighlighted];
//[[button titleLabel] setShadowOffset:CGSizeMake(0.0, 1.0)];

CGRect buttonFrame = [button frame];
buttonFrame.size.width = [t sizeWithFont:[UIFont boldSystemFontOfSize:12.0]].width + 24.0;
buttonFrame.size.height = buttonImage.size.height;
[button setFrame:buttonFrame];

[button setBackgroundImage:buttonImage forState:UIControlStateNormal];
[button setBackgroundImage:buttonPressedImage forState:UIControlStateHighlighted];

[button setTitle:[NSString stringWithFormat:@"  %@",t] forState:UIControlStateNormal];

[button addTarget:tgt action:a forControlEvents:UIControlEventTouchUpInside];

UIBarButtonItem *buttonItem = [[UIBarButtonItem alloc] initWithCustomView:button];

return [buttonItem autorelease];
} 
```

# apache-flex - Flex 移动项目的问题 - 错误？

> ID：10585679
> 
> 赞同：1
> 
> 时间：2012-05-14T14:49:23.230
> 
> 标签：apache-flex, flex4, flex4.5, blazeds, flex-mobile

我的 Flash 有问题，因此 Flash Builder 在我的项目上显示了一个错误图标（我无法运行我的项目），但我确定没有错误 -> 我正在处理这个项目并且其中没有任何错误AND flash builder 不会在任何文件上显示任何错误。有什么帮助吗？我该如何解决这个问题？

注意：我使用的是 Flex SDK 4.6 和 BlazeDS...

![在此处输入图像描述](../Images/8cedcfeafa31ef049462659cd2fc3387.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T15:49:51.350

有时当发生这种奇怪的事情时，您可以通过清理项目或工作区来修复它们。

您可以通过从 Flash Builder 的项目菜单中选择“清理”来清理项目。

要清理工作空间，首先要关闭 Flash Builder。然后使用“-clean”命令行参数重新启动 Flash Builder。

根据对原始问题的评论，您的解决方案是后者。

# python - 性能问题：大 numpy 数组和系统调用

> ID：10585680
> 
> 赞同：3
> 
> 时间：2012-05-14T14:49:23.890
> 
> 标签：python, performance, memory, numpy

在预分配大量内存（例如 numpy 数组）后使用系统调用时会出现性能问题。这个问题随着内存量的增加而增加。

测试.py：

```
import os
import sys
import time
import numpy

start = time.clock()
test = int(sys.argv[1])
a = numpy.zeros((test,500,500))
for i in range(test) :
    os.system("echo true > /dev/null")
elapsed = (time.clock() - start)
print(elapsed) 
```

每次迭代时间显着增加：

```
edouard@thorin:~/now3/code$ python test.py 100
0.64
edouard@thorin:~/now3/code$ python test.py 200
2.09
edouard@thorin:~/now3/code$ python test.py 400
14.26 
```

这不应该与虚拟内存有关。这是一个已知问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T16:02:27.913

`os.system()`在分配了一个大型 NumPy 数组后，您似乎已将问题缩小到需要更长时间。

在幕后，`system()`使用[`fork()`](http://en.wikipedia.org/wiki/Fork_%28operating_system%29). 尽管`fork()`应该非常便宜（由于它使用了[写时复制](http://en.wikipedia.org/wiki/Copy-on-write)），但事实证明事情并不那么简单。

特别是，已知的问题是 Linux`fork()`需要更长的时间来处理更大的进程。参见，例如：

*   [在 Linux 上更快地分叉大型进程？](https://stackoverflow.com/questions/2731531/faster-forking-of-large-processes-on-linux)
*   [Linux Fork Performance Redux：大页面](http://kirkwylie.blogspot.co.uk/2008/11/linux-fork-performance-redux-large.html)。

这两份文件都相当旧，所以我不确定最先进的技术是什么。但是，证据表明您遇到了此类问题。

如果您无法摆脱这些`system()`电话，我会建议两种研究途径：

*   研究启用大页面。
*   考虑在启动时产生一个辅助进程的可能性，它的工作是调用必要的`system()`命令。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T14:54:54.777

如果您不使用`os.system`通话会发生什么？

为了我：

```
python test.py 10   # 0.14
python test.py 100  # 1.18
python test.py 1000 # 11.77 
```

在没有 的情况下，它每次大约增长一个数量级`os.system`。所以，我想说你的问题出在系统调用上，而不是 numpy 的性能上（这通过进行相同的测试得到证实，除了这次注释掉代码的 numpy 部分）。此时，问题变成了“为什么重复系统调用很慢（呃）？” ......不幸的是，我没有答案。

有趣的是，如果我在 bash 中执行此操作，则没有问题（它几乎立即返回）...

```
time for i in `seq 1 1000`; do echo true > /dev/null; done 
```

似乎问题不只是`os.system`——`subprocess.Popen`遭受同样的恶意......（虽然，`subprocess`可能只是`os.system`在幕后打电话，我实际上不知道......）

**编辑**

这越来越好。在我之前的测试中，我离开了 numpy 数组的分配......如果你也删除了 numpy 数组的分配，测试进行得相对较快。但是，数组 (1000,800,800) 的分配只需要大约 1 秒。因此，分配不会占用所有（甚至大部分时间），并且将数据分配给数组也不会花费太多时间，但是数组的分配状态确实会影响系统调用所需的时间执行。很奇怪。

# node.js - 如何在终端中编辑现有文本（并移动光标）？

> ID：10585683
> 
> 赞同：30
> 
> 时间：2012-05-14T14:49:55.937
> 
> 标签：node.js, terminal, stdout

我曾经看过这个演示，它打印出一段文本（就像你在输入时得到的那样`some-command --help`），然后它跳回到文本中的几个关键字并更改文本颜色，*之后它已经在终端中打印出来*.

这对我来说似乎很疯狂。他们是怎么做到的？

开始考虑它，我猜它`stdout`在`stdin`技术上是一个“IO 流”，所以也许这是一个跟踪光标位置的持久变量？我记得在构建语言解析器时做过类似的事情。

目标是这样的：假设您在控制台中输入以下内容，它会输出一个空白数组，因为在 Node.js 中，它都是异步的，我们不想每次都在控制台中编写异步函数：

```
$ node app.js
> App.User.all()
=> [] 
```

然后当异步回调执行时，您返回并编辑`=> []`以包含结果：

```
$ node app.js
> App.User.all()
=> [#<User id:1>, #<User id:2>...] 
```

即使有很多其他问题需要解决（与这个问题无关。我知道你可以定义一个全局回调并做类似的事情`App.User.all(_c)`），至少知道如何实现这将是很棒的。

打印完后如何编辑终端输出？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-05-31T08:44:09.087

终于找到了“demo”：

*   [https://github.com/asyncly/cdir/blob/223fe0039fade4fad2bb08c2f7affac3bdcf2f89/cdir.js#L24](https://github.com/asyncly/cdir/blob/223fe0039fade4fad2bb08c2f7affac3bdcf2f89/cdir.js#L24)
*   [http://tldp.org/HOWTO/Bash-Prompt-HOWTO/x361.html](http://tldp.org/HOWTO/Bash-Prompt-HOWTO/x361.html)
*   [http://ascii-table.com/ansi-escape-sequences-vt-100.php](http://ascii-table.com/ansi-escape-sequences-vt-100.php)

*   定位光标：`\033[<L>;<C>H`或`\033[<L>;<C>f`（将光标放在 L 行和 C 列）

*   将光标向上移动 N 行：`\033[<N>A`
*   将光标向下移动 N 行：`\033[<N>B`
*   将光标向前移动 N 列：`\033[<N>C`
*   将光标向后移动 N 列：`\033[<N>D`
*   清屏，移动到 (0,0)：`\033[2J`
*   擦除到行尾：`\033[K`
*   保存光标位置：`\033[s`
*   恢复光标位置：`\033[u`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T02:06:01.220

如果您在 Mac OS X 中工作，我相信 Eddie 程序会执行类似“在打印完后编辑终端输出”之类的操作。（参见“维基百科的 Eddie（文本编辑器）”）。

在文件菜单下，选择“新建”，然后在“设置/文档设置...”下选择“Shell Window”。之后尝试几个 unix 命令：date、ls、cal 等。然后放置光标并编辑这些命令。

我会尝试使用 Node，但我无法在 Mac OS X 10.5.8 下安装它（Node）。

# twitter-bootstrap - 在 twitter 引导模式中更改背景颜色？

> ID：10585689
> 
> 赞同：56
> 
> 时间：2012-05-14T14:50:06.847
> 
> 标签：twitter-bootstrap

在 twitter bootstrap 中创建模态框时，有没有办法改变背景颜色？完全去除阴影？

注意：对于去除阴影，这*不起作用*，因为它也会改变点击行为。（我仍然希望能够在模式之外单击以将其关闭。）

```
$("#myModal").modal({
  backdrop: false
}); 
```

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2012-05-14T15:16:08.737

要通过以下方式更改颜色：

## CSS

在引导样式之后将这些样式放在样式表中：

```
.modal-backdrop {
   background-color: red;
} 
```

## 较少的

将引导变量更改为：

```
@modal-backdrop-bg:           red; 
```

[来源](https://github.com/twbs/bootstrap/blob/master/less/variables.less#L595)

## 萨斯

将引导变量更改为：

```
$modal-backdrop-bg:           red; 
```

[来源](https://github.com/twbs/bootstrap-sass/blob/master/assets/stylesheets/bootstrap/_variables.scss#L603)

## 引导定制器

更改`@modal-backdrop-bg`为您想要的颜色：

[getbootstrap.com/customize/](http://getbootstrap.com/customize/#modals)

* * *

您还可以通过 Javascript 或将颜色设置为 删除背景`transparent`。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-10-08T02:32:06.737

如果要更改特定模式的背景的背景颜色，可以通过以下方式访问背景元素：

```
$('#myModal').data('bs.modal').$backdrop 
```

然后您可以通过 .css jquery 函数更改任何 css 属性。特别是，有背景：

```
$('#myModal').data('bs.modal').$backdrop.css('background-color','orange') 
```

注意 $('#myModal') 必须被初始化，否则 $backdrop 将是空的。同样适用于 bs.modal 数据元素。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-11-06T22:10:40.817

**CSS**

如果这不起作用：

```
.modal-backdrop {
   background-color: red;
} 
```

试试这个：

```
.modal { 
   background-color: red !important; 
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-12-11T10:22:57.720

删除引导模式背景试试这个

```
.modal-backdrop {
   background: none;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-06-23T01:23:33.167

如果您想将背景添加到特定模式，它会变得有点复杂。解决这个问题的一种方法是添加和调用类似这个函数的东西，而不是直接显示模态：

```
function showModal(selector) {
    $(selector).modal('show');
    $('.modal-backdrop').addClass('background-backdrop');
} 
```

然后可以将任何 css 应用于`background-backdrop`该类。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-07-08T22:48:57.870

对于Bootstrap 4，您可能必须`.modal-backdrop.show`在和.`!important``background-color``opacity`

例如

```
.modal-backdrop.show {
   background-color: #f00;
   opacity: 0.75;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-08-20T21:47:34.647

添加以下CSS；

```
.modal .modal-dialog .modal-content{  background-color: #d4c484; }

<div class="modal fade">
<div class="modal-dialog" role="document">
<div class="modal-content">
...
... 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-10-09T12:21:07.560

如果您只需要为一种模式窗口移除阴影，您可以简单地将 ID 添加到您的模式窗口

```
<div class="modal fade" id="myModal">...</div> 
```

并在您的 css 文件中添加以下内容

```
#myModal .modal-backdrop {background-color: transparent;} 
```

如果您需要删除所有模态窗口的阴影，只需跳过分配 ID 的步骤。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-08T09:58:51.073

我用了几个小时试图弄清楚如何从启动的模式中删除背景，到目前为止尝试过

```
.modal-backdrop {    background: none; } 
```

即使我尝试使用 javascript 也无法正常工作

```
 <script type="text/javascript">   
 $('#modal-id').on('shown.bs.modal',  function () {
       $(".modal-backdrop.in").hide();     })
</script> 
```

也没有工作。我刚刚添加

```
data-backdrop="false" 
```

到

```
<div class="modal fade" id="myModal" data-backdrop="false">......</div> 
```

并应用 css 类

```
.modal {     background-color: transparent !important;  } 
```

现在它像魅力一样工作这与 Bootstrap 3 一起使用

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-02-28T18:39:15.870

对于 Angular(7+) 项目：

```
::ng-deep .modal-backdrop.show {
    opacity: 0.7 !important;
} 
```

否则，您可以使用：

```
.modal-backdrop.show {
    opacity: 0.7 !important;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-09-10T08:24:10.543

当modal出现时，它会在出现之前触发事件`show.bs.modal`。我试过`Safari 13.1.2`了`MacOS 10.15.6`。当`show.bs.modal`事件触发时，`.modal-backgrop`尚未插入`body`。

所以，我放弃了,`addClass`和动态。`removeClass``.modal-backdrop`

在网上查看了很多文章后，我找到[了一个代码片段](https://www.codeply.com/p/5kNp3hxsVW)。它`addClass`和`removeClass`，`body`它是`.modal-backdrop`，when`show.bs.modal`和`hide.bs.modal` 事件触发的父级。

ps：我使用的[是 Bootstrap 4.5](https://getbootstrap.com/docs/4.5/getting-started/introduction/)。

## CSS

```
// In order to addClass/removeClass on the `body`. The parent of `.modal-backdrop`
.no-modal-bg .modal-backdrop {
    background: none;
} 
```

## Javascript

```
$('#myModalId').on('show.bs.modal', function(e) {
     $('body').addClass('no-modal-bg');
}).on('hidden.bs.modal', function(e) {
     // 'hide.bs.modal' or 'hidden.bs.modal', depends on your needs.
     $('body').removeClass('no-modal-bg');
}); 
```

### 参考

1.  [google之后的代码片段](https://www.codeply.com/p/5kNp3hxsVW)
2.  [Bootstrap 4.5，模态，#events](https://getbootstrap.com/docs/4.5/components/modal/#events)
3.  [引导程序 4.5 文档](https://getbootstrap.com/docs/4.5/getting-started/introduction/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-03-04T17:57:33.833

```
$(".modal").on('shown.bs.modal', function() {
    $('.modal-backdrop').css('background', '#00000073');
});
```

# c - 在opencv中使用c的边界框

> ID：10585695
> 
> 赞同：-3
> 
> 时间：2012-05-14T14:50:16.560
> 
> 标签：c, opencv, visual-c++-2010

我正在尝试在图像中的每个字符周围创建一个边界框。我已将图像转换为二进制并对其进行阈值处理，但尽管阅读了手册，但我不明白如何创建边界框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T00:47:54.940

边界框技术有几个选项，但我认为结合这两者你会得到一个很好的结果：

*   [首先](https://stackoverflow.com/questions/10206526/how-to-detect-text-area-from-image/10232763#10232763)，使用[此处演示](https://stackoverflow.com/a/10317919/176769)的技术检测大部分文本并在其周围放置一个边界矩形，以便将图像裁剪到该区域；

*   其次，对[OpenCV 最近提出的技术进行实验，](http://opencv.itseez.com/doc/tutorials/imgproc/shapedescriptors/bounding_rects_circles/bounding_rects_circles.html)[这里](https://stackoverflow.com/a/10239600/176769)也进行了演示。它可用于在第一步的结果图像上定位/提取单个字符。

我想您正在尝试自己实现 OCR 机制，而不是依赖于诸如 Tesseract 之类的出色 API。

如果您正在寻找有关如何进行数字/文本识别的更多信息，[请查看此答案](https://stackoverflow.com/a/10107970/176769)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:42:26.653

正如之前所说的“粗鲁”，我鼓励你重写你的问题，更详细地说明你已经做了什么。我们不明白你想做什么。如果字符识别是你想要的，看看[这个](http://www.mathworks.com/matlabcentral/fileexchange/18169-optical-character-recognition-ocr)。

# android - Android：静态链接到 Activity 是否总是导致内存泄漏？

> ID：10585698
> 
> 赞同：0
> 
> 时间：2012-05-14T14:50:22.570
> 
> 标签：android, memory, static, memory-leaks

```
public class TestActivity extends Activity {

    public static TestActivity mTestActivity;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        mTestActivity = this;
    }

    @Override
    protected void onDestroy() {
        mTestActivity = null;
        super.onDestroy();
    }

} 
```

我可以问一个非常菜鸟的问题吗？
活动的静态链接总是会导致内存泄漏吗？即使我在销毁时将其“无效”？

**编辑：** 如果即使您在销毁时将其“null”也存在内存泄漏，您能解释一下原因吗？
我有几年的 Java 经验，但我不明白为什么销毁时的“null”不会释放内存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:54:23.257

如果您在销毁时将其设为空，则保持其静态是没有意义的。至于泄漏，是的，我想你会的（如果你改变活动）。只保留对应用程序的（非静态）引用会更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-25T01:17:38.583

[`onDestroy`](http://developer.android.com/reference/android/app/Activity.html#onDestroy%28%29)运行一次 - 如果有的话。直到那时你有你的泄漏。在 中注销`onPause()`。请注意，pre-Honeycomb`onPause()`可能是最后一个运行的方法 - 并不是说​​它对您的情况有影响，因为被杀死的进程会使用它的类（以及它们的泄漏）。或者我认为。我不知道是否可以在不调用 onDestroy 的情况下杀死一个活动（不是在整个过程失败的情况下——那么这是完全有可能的，但正如我所说的那样也没有区别）——我不这么认为.

简而言之，只要您的活动还活着（实例化），您的泄漏就存在

# javascript - 点击按钮改变按钮上的ID值，点击新的ID用Jquery变回原来的ID

> ID：10585706
> 
> 赞同：0
> 
> 时间：2012-05-14T14:50:55.777
> 
> 标签：javascript, jquery, button

我正在尝试使用按钮作为开关。如果我单击按钮`value`并`id`更改。如果我再次单击该按钮，它会回到原来的状态`value`并且`id`.

原始值可能如下所示：

```
value="Show all" id="showall" 
```

更改为此值

```
value="Standard" id="default" 
```

```
<script>
    $(function () {
        $("#showall").click(function () {
            $("#showall") //  change the Value text to Standard on the button
            $("#showall") // Change ID value to default on the button
        });
        $("#default").click(function () {
            $("#default") // change value back to the original which is "Show all"
            $("#default") // change ID back to original which is "Showall"
        });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:55:23.160

假设这个按钮`<div class="container"></div>`在我们可以处理它的事件的某种类型的范围内（你可以从正文或文档中处理它，尽管不建议这样做）：

```
$(".container").on("click", "#showall, #default", function(){
  var props = this.id === "showall" 
      ? { value:'Standard', id:'default' } 
      : { value:'Show All', id:'showall' };
  $(this).attr( props );
}); 
```

演示：http: [//jsbin.com/eravoq/2/edit](http://jsbin.com/eravoq/2/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:59:05.250

```
 $("#showall").on('click', function () {
        $(this).attr({ 'value': 'Standard', 'id': 'default' });
    });

    $("#default").on('click', function () {
        $(this).attr({ 'value': 'Show all', 'id': 'showall' });
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:01:08.090

为什么要更改按钮的 ID？你可以做这样的事情：

```
 $(function () {
       $("#switchButton").click(function(){
           if($(this).value == "default"){
                $(this).value = "Show all";
                // do other stuff
           }else if($(this).value == "Show all"){
                $(this).value = "default";
                // do other stuff
           }
       });
    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:03:20.487

```
$("#showall").on('click', function() {
    this.id = this.id=='showall' ? 'default' : 'showall';
    this.value = this.value=='Standard' ? 'Show All' : 'Standard';
}); 
```

[小提琴](http://jsfiddle.net/adeneo/Ej8xk/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T15:04:14.520

我知道这不完全是您要问的，但是如果我们退后一步回答您的问题，我认为您真正想要的是在两个按钮之间*切换*，因此我认为这是非常可维护，易于理解，直观的，还有很多更多的事情要做有两个结构良好的按钮，然后显示/隐藏：

```
<style>
  button#default{
    display: none;
  }
</style>
 ​
<button id="showall" value="Show all">Show all</button>
<button id="default" value="Standard">Standard</button>

<script>
  function toggleButtons(){
    $("button#showall, button#default").toggle();
  }

  $("button#showall, button#default").click( toggleButtons );
</script> 
```

[检查 jsFiddle](http://jsfiddle.net/fguillen/pKgbJ/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-14T15:10:06.473

您应该使用类切换而不是更改 ID。

[http://jsfiddle.net/JzMnM/](http://jsfiddle.net/JzMnM/)

```
if (that.hasClass('foo')) {
    that.removeClass('foo').addClass('bar').val('bar');
} else {
    that.removeClass('bar').addClass('foo').val('foo');
} 
```

# eclipse - 无法更新存储库 Windows Azure

> ID：10585708
> 
> 赞同：-1
> 
> 时间：2012-05-14T14:51:01.480
> 
> 标签：eclipse, azure, cloud

我现在正在尝试 Windows Azure。我一直在遵循 [https://www.windowsazure.com/en-us/develop/java/java-home/download-the-windows-azure-sdk-for-java/的指示](https://www.windowsazure.com/en-us/develop/java/java-home/download-the-windows-azure-sdk-for-java/)

我在 eclipse helios 上运行，但是当我尝试安装新软件并输入 url 存储库时：http://dl.windowsazure.com/eclipse

Eclipse 总是超时，

消息框上的消息如下：

```
Unable to connect to repository http://dl.windowsazure.com/eclipse/content.xml
Unable to connect to repository http://dl.windowsazure.com/eclipse/content.xml
Connection timed out: connect 
```

如何解决这个问题，我非常需要它来在 Windows Azure 平台上部署我的第一个应用程序

请帮我解决这个问题

* * *

现在我尝试在 Cloud Azure 上运行 azure 项目，但是为什么当我尝试上传 cspkg 文件和 cscfg 文件时，该过程总是超时，而当我查看 ping -t 时连接正常运行

这是我尝试在 azure 托管服务上上传时的消息：

上传所选包失败，请验证您的网络连接，然后重试。

如何解决这个问题？这是非常奇怪的错误。>-<

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T15:40:27.877

当然我以前没有遇到过这种情况，但只是为了您的补充信息..

您是否按照此步骤安装 azure @eclipse？像 .net 版本必须 >= 3.5

这里有一些源链接可以帮助您[http://www.windowsazure4e.org/download/](http://www.windowsazure4e.org/download/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T06:30:15.453

是的，我很愚蠢，我忘记关闭我的计算机上的代理服务器。禁用它后，一切都会好起来的：D

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T17:46:39.560

我认为您的网络连接存在一些问题，因为我刚刚测试了相同的下载位置，它确实可以正常工作，如下所示：

正如您在下面看到的，我使用[http://dl.windowsazure.com/eclipse](http://dl.windowsazure.com/eclipse) URL 来下载 Java 特定的 Azure 组件：

![在此处输入图像描述](../Images/fd62109358941cf6a80e4fb5c0edd58e.png)

之后，一旦我选择“下一步”，将列出以下两个要安装在我的机器中的组件：

1.  Microsoft JDBC Drive 3.0 for SQL Server（适用于 SQL Azure）
2.  带有 Java 的 Eclipse 的 Windows Azure 插件

![在此处输入图像描述](../Images/0383e5cd23f96bd189a631a4a09b6b2f.png)

我确信问题是特定于您的网络连接的，因此请更正它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T09:10:12.693

我没有使用过 Windows Azure Java SDK。但错误消息是抱怨文件 C:\Users\workspace\AzureFirst\emulatorTools\ResetEmulator.cmd 找不到。如果您可以检查文件是否存在会更好。此外，调用堆栈指出您正在使用 Windows Azure SDK 1.4。请尝试将其升级到 1.6 以查看它是否可以正常工作。[您可以在http://www.microsoft.com/en-us/download/details.aspx?id=28045](http://www.microsoft.com/en-us/download/details.aspx?id=28045)上找到 SDK 1.6 。请安装 WindowsAzureEmulator 和 WindowsAzureSDK。如果您不想使用 .NET，则不需要 WindowsAzureLibsForNet。

此致，

明旭。

# java - 无法在 Cygwin 下运行 Mahout 20newsgroups 示例

> ID：10585709
> 
> 赞同：2
> 
> 时间：2012-05-14T14:51:03.103
> 
> 标签：java, apache, mahout

我能够验证新闻组数据是否存在输入目录（在 /tmp 下）。不知道为什么我得到一个文件未找到异常。

$ sh分类-20newsgroups.sh 请选择一个数字来选择相应的任务来运行 1\. naivebayes 2\. sgd 3\. clean -- 清理/tmp/mahout-work-rsrinivasan中的工作区输入你的选择：1 ok。您选择了 1，我们将使用 naivebayes 在 /tmp/mahout-work-rsrinivasan 创建工作目录 准备训练数据 MAHOUT_LOCAL 未设置；将 HADOOP_CONF_DIR 添加到类路径。未设置 HADOOP_HOME，在本地运行 SLF4J：类路径包含多个 SLF4J 绑定。SLF4J：在 [jar:file:/C:/cygwin/usr/local/mahout/examples/target/mahout-examples-0.6-job.jar!/org/slf4j/impl/StaticLoggerBinder.class] 中找到绑定 SLF4J：找到在 [jar:file:/C:/cygwin/usr/local/mahout/examples/target/dependency/slf4j-jcl-1.6.1.jar!/org/slf4j/impl/StaticLoggerBinder.class] SLF4J 中绑定：找到绑定在 [jar:file:/C:[http://www.slf4j.org/codes.html#multiple_bindings](http://www.slf4j.org/codes.html#multiple_bindings)进行解释。12/05/14 09:13:44 WARN driver.MahoutDriver：**在 classpath 上找不到 org.apache.mahout.classifier.bayes.PrepareTwentyNewsgroups.props**，将仅使用命令行参数 线程“main”java.io 中的异常。 FileNotFoundException：**找不到输入目录 \tmp\mahout-work-rsrinivasan\20news-bydate\20news-bydate-train** 在 org.apache.mahout.classifier.bayes.PrepareTwentyNewsgroups.main(PrepareTwentyNewsgroups.java:92) 在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) 在 sun .reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:597) at org.apache.hadoop.util.ProgramDriver$ProgramDescription.invoke(ProgramDriver.java:68 ) 在 org.apache.hadoop.util.ProgramDriver.driver(ProgramDriver.java:139) 在 org.apache.mahout.driver.MahoutDriver.main(MahoutDriver.java:188)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-02T17:38:52.280

最好在 unix 环境下运行该示例。当我尝试 oscon2011 reuters 示例时，我遇到了类似的问题；虽然我使用 git bash 控制台来完成这项工作。看来分类和聚类示例 hdfs local 可以正常运行。

我设法使用 vagrant 启动并运行了一个虚拟机，这个过程相对简单。是的，它确实增加了学习周期，但经过一些初始投资后，我能够在几个小时内完成路透社的示例。

谢谢阿南德

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:42:05.480

您可能必须在该脚本在 Windows 上运行之前对其进行编辑。我想 Cygwin/Windows 的路径是错误的。

# objective-c - 将 NSArray 添加到 NSMutableArray

> ID：10585711
> 
> 赞同：-1
> 
> 时间：2012-05-14T14:51:05.950
> 
> 标签：objective-c, nsmutablearray, nsarray

我想在我的 NSMutable 中添加一个 NSArray（在 appdelegate 中初始化）

这是我的代码，每次按下按钮（男性，女性，情侣）时都会调用该方法，因此必须将 NSArray 添加到 MutableArray 但我不知道我尝试了一些东西但没有用。：

```
 - (void) sexChoosen:(NSString *) sexe
{
    NSError *err;
    NSFetchRequest *request = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Boxes" inManagedObjectContext:context];
    [request setEntity:entity];

    NSArray *arrayForPredicate = [context executeFetchRequest:request error:&err];
    NSPredicate *sex;

    sex = [NSPredicate predicateWithFormat:@"sexe = %@", sexe];

    NSArray  *BoxWithSex = [arrayForPredicate filteredArrayUsingPredicate:sex];
    //NSMutableArray* tmp = [self createMutableArray:BoxWithSex];

    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    NSLog(@"FIRST  %@", appDelegate.myArray);

// HERE IS THE CODE TO ADD THE ARRAY TO MY NSMUTABLE ARRAY = AppDelegate *appDelegate

    NSLog(@"SECOND %@", appDelegate.myArray);

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T14:55:17.387

从 NSMutableArray[文档](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html#//apple_ref/doc/uid/20000138-BABDAJBD)：

> “addObjectsFromArray：将另一个给定数组中包含的对象添加到接收数组内容的末尾。”

# c - 奇怪的 C fprintf 格式表示法

> ID：10585712
> 
> 赞同：2
> 
> 时间：2012-05-14T14:51:13.190
> 
> 标签：c, printf, format-specifiers

当我注意到这段代码时，试图找出函数中的堆栈损坏错误：

```
fprintf( fp, "\n%s %3c %12s %2c %12s %2c %12s %2c %12s %2c"
             "%12s %2c %12s", 
             xys_field[3],      x,
             xyzFunc(val1, 0),  x, 
             xyzFunc(val2, 0),  x, 
             xyzFunc(val3, 0),  x,
             xyzFunc(val4, 0),  x, 
             xyzFunc(val5, 0),  x, 
             xyzFunc(val6,0) ); 
```

我要问的是关于这条线`"\n%s %3c %12s %2c %12s %2c %12s %2c %12s %2c" "%12s %2c %12s"`，我什至不明白它是如何编译的，因为我从未见过两种格式像这样相互跟随。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T14:53:12.377

这不是两种格式——注意没有逗号，或者除了空格之外没有任何分隔它们的东西。这是用于延续长字符串的 C 语法。在 C 中，这些是等价的：

```
"abc" "def"
"abcdef" 
```

请注意，这仅适用于字符串文字；你不能连接字符串变量。这是一个语法错误：

```
string1 string2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T14:53:26.380

在 C 中，并列的字符串文字（中间只有空格）表示单个字符串：

```
int main()
{
    puts("Hello, " "world!");
    return 0;
} 
```

打印`Hello, world!`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T14:53:37.000

这与格式说明符无关，而与 C 语言有关，允许您将[字符串文字拆分为多个部分](http://www.cs.utah.edu/dept/old/texinfo/glibc-manual-0.02/library_toc.html#SEC58)（例如，为了清晰起见跨行）并将其连接起来。

# android - 在android中使用内部存储写入文件时出错

> ID：10585719
> 
> 赞同：0
> 
> 时间：2012-05-14T14:51:34.977
> 
> 标签：android, file-io, android-file

我正在使用以下代码在内部存储上编写文件：

```
String FILENAME= filename;

FileOutputStream f= openFileOutput(FILENAME, Context.MODE_PRIVATE); 
```

但它显示该方法`openFileOutput`未为我的文件定义的错误。我不知道为什么会这样。我正在使用 android 开发者论坛中提供的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:32:25.557

此方法`openFileOutput()`可从`Activity`或`Context`类中获得。在任何一种情况下，您都必须有一个类的实例才能访问该方法。

你在哪里运行这段代码？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-09T07:53:02.467

导入 **导入 java.io.FileOutputStream**。它会工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:16:30.807

您的代码似乎缺少`import java.io.FileOutputStream`. 如果您使用 Eclipse 编辑代码，组合键 `Ctrl`++`Shift`会将`O`缺少的导入添加到当前文件。

# java - 将 Java 项目从 Eclipse 导出为带有附加引用 jar 的 JAR

> ID：10585720
> 
> 赞同：1
> 
> 时间：2012-05-14T14:51:36.987
> 
> 标签：java, eclipse, plugins, jar, export

我使用 Eclipse Helios 3.2.2。我有一个需要从批处理文件运行的独立 Java 应用程序。所以我需要将其导出为 JAR。该程序使用其他一些 JAR 文件，例如 log4j.jar、javamail.jar 和另外 2 个。当我在 Eclipse 中运行该应用程序时，没有任何问题。但是当我将它导出为 JAR 并尝试运行时，我收到“NoclassDeffound 错误”。在这个版本的 Eclipse 中，外部 JAR 不会被导出。在其他地方，我读到可以使用 FatJar 或 WinRun4J 插件。当我尝试安装这些插件时，我收到一个错误，即找不到该站点。这些插件是否有其他来源，或者在此版本的 Eclipse 中是否有其他导出方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T14:59:09.377

如果您使用的是 Eclipse 3.4 或更高版本，请使用*Runnable JAR 文件*导出选项。

> 将运行应用程序所需的所有资源导出到本地文件系统上的 JAR 文件中。

如果您使用的是 Eclipse 3.3 或更低版本，请使用外部插件，例如[FatJar](http://sourceforge.net/projects/fjep/)。只需按照[安装说明](http://fjep.sourceforge.net/#inst)和有关如何使用它的[简单教程进行操作即可。](http://fjep.sourceforge.net/fjeptutorial.html)

# python - distutils - 如何在同一个模块中获取扩展模块和 python 模块？

> ID：10585723
> 
> 赞同：4
> 
> 时间：2012-05-14T14:51:51.260
> 
> 标签：python, distutils

我有一个名为*foo.c*的扩展模块和一个实用程序 python 文件*utils.py*，它扩展了我的扩展模块的一些基本功能。现在我想使用 utils 作为 foo (foo.utils) 的子包。如下所示：

```
from foo import bar
from foo.utils import test
... 
```

我尝试了各种 distutils 配置，但最终都没有成功。通常我的 py_modules 会覆盖我的 ext_modules。这是示例 distutils 设置：

```
from distutils.core import setup, Extension
setup(name='foo',
  version='1.0',
  py_modules = [foo.utils]
  ext_modules=[Extension('foo', ['foo.c'])],
  ) 
```

我的目录如下所示

```
|_ foo/__init__.py
|_ foo/utils.py
|_ foo.c
|_ setup.py 
```

当我尝试只使用我的 ext_module 或 py_module 时，两者都可以正常工作。有没有人有提示或者distutils不可能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T15:01:42.500

您将无法拥有名为 foo 的 C 扩展以及名为 foo.utils 的模块。将您的扩展重命名为 _foo.c，然后`foo/__init__.py`从 _foo 创建哪些导入。

顺便说一句，这不是 distutils 问题，它与 foo 所需的结构有关，以使 foo.utils 正常工作。“foo”可以是模块或包，但不能同时是两者。

# c - 指向运算符的优先级

> ID：10585724
> 
> 赞同：0
> 
> 时间：2012-05-14T14:51:56.790
> 
> 标签：c, structure

运算符 wrt 对算术、按位和其他指针引用`pointing to ->`运算符（例如`&`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T14:55:55.980

“高的”。请参阅[运算符优先级表](http://en.wikipedia.org/wiki/Operators_in_C_and_C++#Operator_precedence)。请注意，链接到的表也包含 C++，因此您需要仔细阅读。

[这是另一个 table](http://www.lix.polytechnique.fr/~liberti/public/computing/prog/c/C/CONCEPT/precedence.html)，它只是 C 语言。您可以看到唯一共享优先级的运算符`->`是`()`（函数调用）、`[]`（数组索引）和`.`（元素选择）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:56:51.383

它在“C”中具有最高（est）优先级。-> 的优先级高于 &。

[您可以在此处](http://isthe.com/chongo/tech/comp/c/c-precedence.html)（C 表）和[此处](http://en.wikipedia.org/wiki/Operators_in_C_and_C++#Operator_precedence)（Wiki - 包括 C++）参考优先级表

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T16:14:46.453

作为后缀运算符，`->`具有最高级别的优先级（与`.`成员选择运算符、后缀`++`和`--`、`[]`和函数调用一起`()`）。所以表达式 like`&foo->bar`被解释为`&(foo->bar)`。

如果您有多个具有相同优先级的运算符，它们会从左到右进行计算。例如，`[]`and`()`也是后缀运算符，因此`a[i]->b`被解释为`(a[i])->b`，`f()->m`被解释为`(f())->m`，`p++->q`被解释为`(p++)->q`，等等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:03:58.743

-> 在 C 中具有最高优先级。查看[优先级图表](http://www.swansontec.com/sopc.html)以获取更多信息。

# c++ - 在 Linux 上使用 CMake 将 boost 链接到共享库

> ID：10585726
> 
> 赞同：6
> 
> 时间：2012-05-14T14:51:57.737
> 
> 标签：c++, linux, boost, cmake, ld

我的项目中有一个可执行文件和一个共享库。共享库使用 boost 库。可执行文件使用 olny 共享库。

```
tilenet/             <-- Project
   ttest/            <-- Test (executable)
      CMakeLists.txt
   tilenet/          <-- The shared library
      CMakeLists.txt
   CMakeLists.txt    <-- Root CMake-file 
```

根 Cmake 文件：

```
cmake_minimum_required(VERSION 2.6) 

project(tilenet)

set(Boost_USE_STATIC_LIBS        OFF)  # I've already tried ON
set(Boost_USE_MULTITHREADED      ON)
set(Boost_USE_STATIC_RUNTIME    OFF)

find_package(Boost 1.49 COMPONENTS system filesystem REQUIRED)

include_directories(${Boost_INCLUDE_DIRS})

add_subdirectory(test)
add_subdirectory(tilenet) 
```

测试/CMakeLists.txt

```
add_executable(ttest test.cpp)
target_link_libraries(ttest tilenet ${BOOST_LIBRARIES}) 
```

tilenet/CMakeLists.txt

```
include_directories("include")
set(tilenet_src "src/tilenet.cpp" ...)

add_library(tilenet SHARED ${tilenet_src})
target_link_libraries(tilenet 
            ${SFML_LIBRARIES}
            ${BOOST_LIBRARIES}
            ) 
```

（我剪掉了一些不重要的东西）

在 Windows 上它工作正常（但我在没有 CMake 的情况下使用 VisuelStudio），但在 linux 上我得到以下链接错误：

```
../../lib/libtilenet.so: undefined reference to `boost::filesystem3::path_traits::convert(wchar_t const*, wchar_t const*, std::string&, std::codecvt<wchar_t, char, __mbstate_t> const&)'
../../lib/libtilenet.so: undefined reference to `boost::filesystem3::path::operator/=(boost::filesystem3::path const&)'
../../lib/libtilenet.so: undefined reference to `boost::system::system_category()'
../../lib/libtilenet.so: undefined reference to `boost::filesystem3::path::wchar_t_codecvt_facet()'
../../lib/libtilenet.so: undefined reference to `boost::system::generic_category()'
../../lib/libtilenet.so: undefined reference to `boost::filesystem3::path_traits::convert(char const*, char const*, std::basic_string<wchar_t, std::char_traits<wchar_t>, std::allocator<wchar_t> >&, std::codecvt<wchar_t, char, __mbstate_t> const&)'
collect2: error: ld returned 1 exit status
make[2]: *** [../bin/ttest] Error 1
make[1]: *** [test/CMakeFiles/ttest.dir/all] Error 2
make: *** [all] Error 2 
```

我已经尝试了很多与给定选项的组合，但我无法链接它。你知道我哪里出错了吗？这是我第一次认真使用 CMake :)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T16:11:48.687

CMake 变量区分大小写，FindBoost 模块将 boost 库设置为名为 的变量`Boost_LIBRARIES`，而不是`BOOST_LIBRARIES`.

如果您在两次通话中替换为，它应该可以正常工作`${BOOST_LIBRARIES}`。`${Boost_LIBRARIES}``target_link_libraries`

有关 FindBoost 模块的完整信息，请运行：

```
cmake --help-module FindBoost 
```

# c# - 如何存储非常大的字符串/字符数组？

> ID：10585728
> 
> 赞同：0
> 
> 时间：2012-05-14T14:52:08.277
> 
> 标签：c#, arrays, string, .net-3.5

我正在尝试存储一个非常大的字符串，我最终会将其转换为字符数组以对单个字符执行操作。字符串最长可达 100 万个字符。到目前为止，我使用普通字符串来执行我的工作，但它不适用于如此大的字符串。我可以使用什么内置类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:00:24.907

我不知道你为什么认为你不能有这么大的字符串。无论如何，您可能希望在将数据转换为字符数组之前将该数据存储在字符串中，因为您想修改它。

如果您只想将数据附加到它，您可以使用 a`StringBuilder`来有效地构建您的字符串，然后将其转换为字符数组。

# opencart - 访问会话数据

> ID：10585729
> 
> 赞同：0
> 
> 时间：2012-05-14T14:52:10.323
> 
> 标签：opencart

我正在`catalog/controller/checkout/cart.php`控制器中设置自定义会话。它所做的就是检查是否设置了一个值。

```
if (isset($this->request->post['no_tax']) && $this->request->post['no_tax'] == '1') 
{
   $this->session->data['no_tax'] = true;
} 
elseif (isset($this->request->post['no_tax']) && $this->request->post['no_tax'] === '0') 
{
   unset($this->session->data['no_tax']);
} 
```

然后我可以在`catalog/model/shipping/totalbased.php`模型文件中访问它，

```
isset($this->session->data['no_tax']) 
```

问题是，我需要按顺序向管理员发送附加信息，这是在`catalog/model/checkout/order.php`

我在那里做了检查：

```
if(isset($this->session->data['no_tax']) )
{
   //do something
}
$mail->send(); 
```

做某事，只需添加一个PDF。问题是，PDF 没有附加。

在 error.txt 中，我得到：`2012-05-14 14:42:11 - PHP Notice: Undefined index: no_tax in /var/www/vhosts/site.com/httpdocs/catalog/order.php`

我可以通过这种方式访问​​会话吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:29:12.550

从我所见，代码看起来不错，是的，您可以像显示的那样访问数据。您遇到的错误看起来像是您尝试在某个时候直接访问会话数据而不检查它的设置，从而导致通知

# vb.net - WinForms TableLayoutPanel ComboBox 未正确调整大小

> ID：10585732
> 
> 赞同：2
> 
> 时间：2012-05-14T14:52:16.400
> 
> 标签：vb.net, winforms

我正在尝试使用 TableLayoutPanel 将表单上的一些控件对齐到其标签旁边，如下所示：

```
Label1      [combobox       ]
LongerLabel [longer combobox] 
```

但是当我运行项目并抓住表单的右侧并缩小表单时，组合框不会调整大小，它会被切断......现在，我不使用 TableLayoutPanel，而只是将组合框锚定到表单的边缘，它将正确调整大小。我在 TableLayoutPanel 上做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:09:58.683

我在这里找到了答案：

[http://www.tech-archive.net/Archive/DotNet/microsoft.public.dotnet.framework.windowsforms.controls/2006-12/msg00209.html](http://www.tech-archive.net/Archive/DotNet/microsoft.public.dotnet.framework.windowsforms.controls/2006-12/msg00209.html)

因此，我将带有标签的第一列设置为自动调整大小（我将标签填充停靠在单元格中，并将文本对齐设置为左中）。然后停靠在第二列中填充组合框。然后，将第二列的大小类型设置为 100%，而不是自动调整大小。我不知道它为什么有效，但它确实有效。

# html - 相对位置内的绝对位置，元素超出父级的宽度？

> ID：10585735
> 
> 赞同：1
> 
> 时间：2012-05-14T14:52:25.513
> 
> 标签：html, css

请参考小提琴：http: [//jsfiddle.net/ukzKT/8/](http://jsfiddle.net/ukzKT/8/)。

我希望内部 div #this-bottom 保持在底部，但它的宽度应该与其中的任何其他 div 一样。即它应该留在父div #top 的填充区域内。

**CSS**

```
#top{
    width:300px;
    position:relative;
    padding:20px;
    border:1px solid #222;
}
#this-bottom{
    position:absolute;
    bottom:0;
    border:1px solid #333;
    right: 18px;
    left: 20px;
}
#other{
    width:100%;
    border:1px solid #333;
} 
```

**HTML**

```
<div id='top'>
    <div id='other'>
        This is 1 <br />
        THis is 2 <br />
        This is 3 <br />

    </div>
    <div id='this-bottom'>
        This should be bottom
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T14:59:41.193

div 超出父级的原因是有一个`width`of`100%`并且`left`被分配了默认值（'auto'） - 在这种情况下是`20px`由于`padding`. 所以将在父容器之外`div`流动。`20px`

要阻止这种情况发生，您可以设置`left: 20px`和`right: 20px`（与填充相同）并删除`width: 100%`

# python - 我的 Python 脚本/Powershell 使用有问题吗？

> ID：10585736
> 
> 赞同：0
> 
> 时间：2012-05-14T14:52:30.803
> 
> 标签：python, powershell

因此，我尝试以编程方式添加打印机，但出现 0x00000709 错误。

什么可能导致这种情况？我怀疑我的代码中的某些内容可能有点不对劲：

```
import subprocess
def printerSetup(printer):
    subprocess.call(r'Cscript c:/windows/System32/Printing_Admin_Scripts/en-US/Prnport.vbs -a -r "' + printer + '.print.mediag.com" -h "' + printer + '.print.mediag.com" -o raw')
    if printer == 'jupiter':
        subprocess.call(r'rundll32 printui.dll, PrintUIEntry /if /b "' + str.title(printer) + '" /u /y /f w:\printers\\toshibae3511\eng\est_c2.inf /r "' + printer + '.print.mediag.com" /m "TOSHIBA e-STUDIO Color PS3"')
    elif printer == 'saturn' or printer == 'neptune':
        subprocess.call(r'rundll32 printui.dll, PrintUIEntry /if /b "' + str.title(printer) + '" /u /f w:\printers\\toshibae3511\eng\est_c2.inf /r "' + printer + '.print.mediag.com" /m "TOSHIBA e-STUDIO Color PS3"')  
    elif printer == 'mercury':
        subprocess.call(r'rundll32 printui.dll, PrintUIEntry /if /b "' + str.title(printer) + '" /u /f w:\printers\dell1720\drivers\print\dell1720\DKABJ740.inf /r "' + printer + '.print.mediag.com" /m "Dell Laser Printer 1720dn"')
    elif printer == 'sonic' or printer == 'pangea':
         subprocess.call(r'rundll32 printui.dll, PrintUIEntry /if /b "' + str.title(printer) + '" /u /f w:\printers\HPUniversalPS_x64\hpcu112v.inf /r "' + printer + '.print.mediag.com" /m "HP Universal Printing PS"')

printerList = ["neptune", "saturn", "mercury", "jupiter", "sonic", "pangea"]

for x in printerList:

    printerSetup(x) 
```

现在，这些打印机中的每一个都肯定已添加到网络中，并且我正在调用 Windows 的打印脚本 - 它可能与我的列表有关吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:22:38.500

你必须传递一个列表：

```
subprocess.call(['Cscript', r'c:/windows/System32/Printing_Admin_Scripts/en-US/Prnport.vbs', '-a', ...]) 
```

还要检查报价...

看看[http://docs.python.org/library/subprocess.html?highlight=subprocess#subprocess.check_call](http://docs.python.org/library/subprocess.html?highlight=subprocess#subprocess.check_call)

# c++ - 放置新行为等效

> ID：10585740
> 
> 赞同：5
> 
> 时间：2012-05-14T14:52:41.003
> 
> 标签：c++, memory-management, new-operator, placement-new

我有一个关于安置的问题`new`我对C++ 中以下两个代码片段在功能上是否等效并且可以互换使用（我并不是暗示应该使用第二个，当第一个适合时）？

**#1**

```
T* myObj = new T();
// Do something with myObj
delete myObj; 
```

**#2**

```
char* mem = new char[sizeof(T)];
T* myObj = new (mem) T();
// Do something with myObj
myObj->~T();
delete[] mem; 
```

当我使用像这样的放置新语法时，有什么我应该特别注意的吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-14T14:59:14.940

它们不是等效的，因为如果`T`抛出的构造函数或析构函数它们具有不同的行为。

`new T()`将释放任何已分配的内存，然后让异常进一步传播。`char* mem = new char[sizeof(T)]; T* myObj = new (mem) T();`不会（除非你明确地做一些事情来确保它被释放，否则你会有泄漏）。同样，`delete myObj`将始终释放内存，无论是否`~T()`抛出。

一个精确的等价物`T* myObj = new T();/*other code*/delete myObj;`是这样的：

```
//When using new/delete, T::operator new/delete
//will be used if it exists.
//I don't know how do emulate this in
//a generic way, so this code just uses
//the global versions of operator new and delete.
void *mem = ::operator new(sizeof(T));
T* myObj;
try {
    myObj = new (mem) T();
}
catch(...) {
    ::operator delete(mem);
    throw;
}
/*other code*/
try {
    myObj->~T();
    ::operator delete(mem);
}
catch(...) {
    //yes there are a lot of duplicate ::operator deletes
    //This is what I get for not using RAII ):
    ::operator delete(mem);
    throw;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-14T14:58:21.087

由于您正在分配原始内存，因此更接近的等价物是：

```
void *mem = operator new(sizeof(T));
T *myobj = new(mem) T();

// ...

myobj->~T();
operator delete(mem); 
```

请注意，如果您`::operator new`为特定类重载，这将使用该类' `operator new`，而您的使用`new char []`将忽略它。

编辑：虽然我应该补充一点，我在这里忽略了例外的可能性。@Mankarse 的回答似乎（对我来说）很好地涵盖了这部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:00:57.777

从根本上讲，您在两种情况下都在做同样的事情：即您在堆上实例化一个新对象并释放内存，但在第二种情况下，您（显然）使用放置 new操作员。

在这种情况下，如果构造函数按照 Mankarse 的解释抛出，则它们都会产生相同的结果，减去差异。

此外，我不会说您可以互换使用它们，因为第二种情况不是如何`placement new`使用的实际示例。在内存池的上下文中使用可能会更有意义`placement new`，如果您正在编写自己的内存管理器，以便您可以`T`在每个分配的内存上放置多个对象（在我的测试中，它往往会节省大约 25% CPU 时间）。如果您有一个更现实的用例，`placement new`那么您应该担心的事情会更多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:01:15.453

好吧，您正在为您的 T 对象预分配内存。它应该没问题。然而，如果您将再次重用分配的区域，那是有道理的。否则会比较慢。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T15:02:12.230

是的。您的示例太简单了，无法演示这一点，但是您预先分配的内存“mem”应该管理存储在“myObj”中的对象。

也许换一种更好的方式，场景**#1**在堆上分配空间，并在该空间中构造一个对象。场景**#2**在堆上分配空间，“mem”，然后在该空间的*某处构造一个对象。*

现在，将第二个对象*放在*“mem”中的其他位置。它变得复杂，对吧？

myObj 的构造和销毁在两种情况下都是相同的（除非您的构造函数抛出异常，正如 Mankarse 指出的那样），但是分配器在场景 #1 中为您处理内存管理，而不是在场景 #2 中。

因此，请注意适当地管理“mem”。一种[常见](http://www2.research.att.com/~bs/bs_faq2.html#placement-delete)的方法如下：

```
template<class T> void destroy(T* p, Arena& a)
{
        if (p) {
                p->~T();        // explicit destructor call
                a.deallocate(p);
        }
} 
```

# javascript - JavaScript For Loop 是如何工作的？

> ID：10585745
> 
> 赞同：2
> 
> 时间：2012-05-14T14:52:53.157
> 
> 标签：javascript, for-loop

我正在使用 JavaScript for 循环，我的代码在这里

```
content = "";           
for (var i = 0; i < 13; i++) {
  var alt=glevel[i].getAttribute("name");
  if(jQuery.inArray(alt, clickArray) > -1) {
    if ($.browser.msie  && parseInt($.browser.version, 10) === 8 || $.browser.msie  && parseInt($.browser.version, 10) === 7) {
      content += "<li id='"+alt+"' style='cursor:pointer;filter:alpha(opacity=50);'>"+alt+"<br><div style='width:auto;'><img src='products/"+alt+".png'><br><font size='1px'>Click Base To Select</font></div><br><p style='text-decoration:none;color:#ffffff;font-size:10px;margin-top:-18px;' id='"+alt+"'>Click Here For Product Info</p></li> \n";
    } else {
      content += "<li id='"+alt+"' style='cursor:pointer;opacity:0.3;'>"+alt+"<br><div style='width:auto;'><img src='products/"+alt+".png'><br><font size='1px'>Click Base To Select</font></div><br><p style='text-decoration:none;color:#ffffff;font-size:10px;margin-top:-18px;' id='"+alt+"'>Click Here For Product Info</p></li> \n";
    }
    //$('#'+clickArray[alt]+"").css("opacity","0.5");
  } else{
    content += "<li id='"+alt+"' style='cursor:pointer'>"+alt+"<br><div style='width:auto;'><img src='products/"+alt+".png'><br><font size='1px'></font></div><br><p style='text-decoration:none;color:#ffffff;font-size:10px;margin-top:-18px;' id='"+alt+"'></p></li> \n";
  }
  $("#step_2").html(content);
} 
```

这段代码的输出是这样的：-

```
image1 image2 image3 image4 
image5 image6 
image7 image8 image9 image10 
image11 image12 image13

update:- it looks like that because of my table width and height 
```

它工作得很好，它显示了我所拥有的真实产品图像。

现在我想显示这样的东西：-

```
image1 image2 image3 image4     
image5 image6 image7     
image8 image9 image10     
image11 image12 image13 
```

表示第一行有 4 张图片，而第 2、3、4 行有 3 张图片

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:57:35.560

```
for (var i = 0; i < 13; i++) {
    content += "...";

    if (i == 3)                       // after the fourth line,
       content += '<br/><br/>';       // add an empty line
    if (i > 3 && (i - 4) % 3 == 2)    // then, after every three lines
       content += '<br/><br/>';       // add an empty line
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:13:15.683

这可以解决问题：

```
var content = "", imgNum = 1, max = 4;

for (var i = 0; i < 4; i++) {
    if (i != 0) {
        max = 3;
    }
    for (var j = 0; j < max; j++) {
        content += "image" + imgNum;
        imgNum++;
    }
    content += "<br />";
}

document.write(content); 
```

[演示](http://jsfiddle.net/xj5S8/)

这是逻辑：

*   将起始图像编号设置为 1
*   将最大值设置为 4（稍后我们将其更改为 3）
*   循环行数（4次）
    *   如果我们在第一个循环，则保留最大值 4，否则将其更改为 3
    *   循环列数（最大次数）
        *   向内容添加内容
        *   将图像编号增加 1
    *   在循环之后添加中断

我更喜欢使用两个循环而不是使用`%`运算符，因为它更具可读性和更快。

编辑：如果您不关心性能，我找到了一种使用以下方法制作可读版本的方法`%`：

```
var content="";

for (var i = 0; i < 13; i++){
    content += "image"+(i+1);
    if(i==0||i==12){
        continue;
    }
    if(i%3==0) {
        content += "<br />";
    }
}

document.write(content); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:57:37.967

把它放在循环的末尾：

```
if (i == 3) { content += '<br/>'; }
if (i > 3 && (i - 4) % 3 == 2) { content += '<br/>'; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T14:59:44.237

那这个呢？

```
for (var i = 0; i < 13; i++){
    content += "<li>...</li>";
    if(i==3 || i==6 || i==9) { content += "<br />"; }
} 
```

# java - LWJGL 碰撞检测缺陷

> ID：10585746
> 
> 赞同：1
> 
> 时间：2012-05-14T14:52:57.603
> 
> 标签：java, collision-detection, lwjgl

我目前在我的 Space Invaders 之类的游戏中使用此代码进行 2D 碰撞检测：

```
for(byte k = 0; k < enemies.length; k++) {
    if(shot.x < enemies[k].getTexture().getImageWidth() && shot.x  > enemies[k].pos.x) {
            if(shot.y - 1.2f * frameCount < enemies[k].pos.y && shot.y - 1.2f * frameCount > Main.enemies[k].pos.y - enemies[k].getTexture().getTextureHeight()) {
                    Main.enemies[k].hit = true;
            }
    }
} 
```

但是，这种类型的碰撞检测存在一个主要缺陷。我只能检测到来自下面的碰撞。为什么是这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:24:54.140

你只从底部得到碰撞的原因是你的边界检查有一些错误。下面我给出了一个固定的稍微清晰一点的版本，我假设shotWidth和shotHeight是可以计算出来的。（我省略了有关 frameCount 的部分，但如果需要，应该可以再次编辑它）。

```
final int shotX = shot.x;
final int shotY = shot.y;
final int shotWidth = ?
final int shotHeight = ?
for(byte k = 0; k < enemies.length; k++) {
    final int enemyX = enemies[k].pos.x;
    final int enemyY = enemies[k].pos.y;
    final int enemyWidth = enemies[k].getTexture().getImageWidth();
    final int enemyHeight = enemies[k].getTexture().getImageHeight();

    if(     shotX < enemyX + enemyWidth &&
            shotX + shotWidth < enemyX &&

            shotY < enemyY + enemyHeight &&
            shotY + shotHeight < enemyY) {

        Main.enemies[k].hit = true;
    }
} 
```

# java - 每个单词在数组中的字符上划分

> ID：10585747
> 
> 赞同：-4
> 
> 时间：2012-05-14T14:53:01.370
> 
> 标签：java, file, java.util.scanner

我在用 Java 读取 txt 文件时遇到问题。我有一个 File.txt （有这样的东西：

```
Lalala
Java
C++ 
```

我想将它“转换”成一个数组（例如 for `tab[0][0]`will be `L`， then `tab[0][1]`will be`a`等）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:56:15.607

如果你有 a `String`，你可以通过调用将其转换为单个字符的数组`String.toCharArray();`

首先，将字符串拆分为单个单词...

```
String myExample = "Lalala Java C++";
String[] lines = myExample.split(" "); 
```

然后将各个行拆分为字符...

```
String myFirstLine = lines[0];
char[] letters = myFirstLine.toCharArray(); 
```

如果你需要它在二维数组中，你可以做这样的事情（这是一个完整的例子）......

```
String myExample = "Lalala Java C++";
String[] lines = myExample.split(" ");

char[][] myArray = new char[lines.length][0];
for (int i=0;i<lines.length;i++){
    myArray[i] = lines[i].toCharArray();
} 
```

这将按照您的要求将第 1 行的字母分配给`myArray[0][0]`,`myArray[0][1]`等，并将第 2 行的字母分配给`myArray[1][0]`,`myArray[1][1]`等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:03:47.583

如果你想要的是一个二维数组，问题是数组的宽度需要是更大单词的长度。我认为这不是一个好习惯。

也许如果你创建一个数组列表，它会更好：

```
List<char[]> arrays = new ArrayList<char[]>();

String[] words = fullText.split(" "); //or split("\\s+") if the text contains many lines  or many spaces between the words

for(String word: words){
   char[] charsOfWord = word.toCharArray();
   arrays.add(charsOfWord);
} 
```

这样，要访问第一个单词中的第一个字符：

```
System.out.println(arrays.get(0)[0]); 
```

# jquery-ui - 与 jqueryui 模态对话框中的 knockoutjs 相关联的 jqueryui 手风琴的问题

> ID：10585748
> 
> 赞同：0
> 
> 时间：2012-05-14T14:53:04.333
> 
> 标签：jquery-ui, knockout.js

我有一个包含手风琴（jqueryui）的模态对话框（jqueryui）。手风琴是使用 knockoutjs 将数据绑定到 observableArray 的。

这是我的代码和正在发生的事情的示例

[http://jsbin.com/ebocew/3/edit#javascript,html,live](http://jsbin.com/ebocew/3/edit#javascript,html,live)

基本上，当您第一次单击 Show Dialog 按钮时，会显示对话框，并且手风琴看起来应该是这样。但是，如果您关闭对话框并单击 Add Item 按钮，则会将一个项目添加到 knockoutjs 列表中。这反过来又添加了另一个手风琴元素，但现在如果您显示对话框，手风琴细节的大小不合适。

我需要做什么才能完成这项工作？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T14:26:41.623

由于没有其他人可以提供任何其他建议，因此我将我的“hack”列为解决方案。基本上，我注意到由于某种原因，我的手风琴内容的 div 一直被分配 0px 的高度。所以，在我的手风琴活页夹中，我添加了：

```
$(element).find("div").height("auto"); 
```

这似乎解决了我的问题。希望这对其他人有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-10T18:51:25.223

从“id”中删除#，如下所示

```
<div data-bind="attr: { id: 'collapsible' + testitem.ID }" class="accordion-body collapse"> 
```

# .net - 是否有任何登录 ReSharper 以找出测试没有结果的原因？

> ID：10585751
> 
> 赞同：12
> 
> 时间：2012-05-14T14:53:17.557
> 
> 标签：.net, visual-studio-2010, nunit, resharper

我们有非常复杂的派生类结构，这些结构构成了我们的系统/集成测试。现在我开始在我的一个测试类中使用参数化 NUnit `TestFixture`，而 ReSharper 6.1.1 真的不喜欢它。

如果我直接从单元测试会话运行测试，则测试夹具总是被标记为不确定。如果我从代码运行测试，我会得到相同的结果，但是如果我在测试夹具上展开 Resharper 的图标并只选择一个特定的测试用例来运行，它很少会运行夹具内的所有测试，但在大多数情况下它将再次将夹具标记为不确定。

我的参数化夹具在 NUnit 测试运行程序中没有任何问题。

我还创建了一些具有单级继承的示例参数化夹具，它可以工作，因此问题出在我们用于系统测试的整个“框架”中的某个地方。

有没有办法调查为什么夹具被标记为不确定并被排除在测试运行之外？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T07:02:02.507

这似乎是 ReSharper 测试运行程序的常见问题。看到[这个错误](http://youtrack.jetbrains.com/issue/RSRP-287998)。尝试使用 NUnit GUI 测试运行程序运行它，以确定问题是来自 ReSharper 还是您的测试框架。

# python - Python - Win32Com - 如何从 Excel 电子表格单元格中提取超链接？

> ID：10585753
> 
> 赞同：1
> 
> 时间：2012-05-14T14:53:20.327
> 
> 标签：python, excel, win32com, win32gui

我正在尝试使用以下代码从 Excel 电子表格中的各个单元格获取超链接：

```
import win32com.client 
import win32ui

app = win32com.client.Dispatch("Excel.Application") 
app.visible = True

workbook = app.Workbooks.Open("test.xlsx")
sheet = workbook.Sheets[0]
test_cell = sheet.Range("A8").value 
```

这将打印以下内容：

```
test_cell
u'Link title' 
```

但是当我尝试提取超链接时，它没有以字符串格式返回链接/url，而是返回一个“未知的 COMObject”：

```
test_cell = sheet.Range("A8").Hyperlinks
test_cell
<COMObject <unknown>> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:05:59.417

```
sheet.Range("A8").Hyperlinks.Item(1).Address 
```

# c# - 自带WinForms控件闪烁，性能不佳

> ID：10585756
> 
> 赞同：6
> 
> 时间：2012-05-14T14:53:26.783
> 
> 标签：c#, winforms, performance, user-controls, flicker

我自己的使用位图的用户控件有两个问题：

1.  如果通过 .NET 的“刷新”方法重绘，它会闪烁。
2.  它的性能很差。

该控件由三个位图组成：

*   静态背景图像。
*   一个旋转的转子。
*   另一个取决于转子角度的图像。

所有使用的位图的分辨率均为 500x500 像素。控件的工作方式如下： [https](https://www.dropbox.com/s/t92gucestwdkx8z/StatorAndRotor.gif) ://www.dropbox.com/s/t92gucestwdkx8z/StatorAndRotor.gif （这是一个 gif 动画）

用户控件应在每次获得新的转子角度时自行绘制。因此，它有一个公共属性“RotorAngle”，如下所示：

```
public double RotorAngle
{
    get { return mRotorAngle; }
    set
    {
        mRotorAngle = value;
        Refresh();
    }
} 
```

`Refresh`引发`Paint`事件。事件`OnPaint`处理程序如下所示：

```
private void StatorAndRotor2_Paint(object sender, PaintEventArgs e)
{
    // Draw the three bitmaps using a rotation matrix to rotate the rotor bitmap.
    Draw((float)mRotorAngle);
} 
```

但是，当我使用此代码（在其他自己的用户控件中运行良好）时，如果控件通过`SetStyle(ControlStyles.OptimizedDoubleBuffer, true)`. 如果我不将此标志设置为 true，则重绘时控件会闪烁。

在控制构造函数中我设置：

```
SetStyle(ControlStyles.AllPaintingInWmPaint, true);
SetStyle(ControlStyles.ContainerControl, false);
// User control is not drawn if "OptimizedDoubleBuffer" is true.
// SetStyle(ControlStyles.OptimizedDoubleBuffer, true);
SetStyle(ControlStyles.ResizeRedraw, true);
SetStyle(ControlStyles.SupportsTransparentBackColor, true); 
```

首先，我认为它会闪烁，因为每次绘制控件时都会清除背景。因此，我设置`SetStyle(ControlStyles.AllPaintingInWmPaint, true)`. 但这没有帮助。

那么，为什么会闪烁呢？其他控件在此设置下工作得很好。以及为什么不绘制如果`SetStyle(ControlStyles.OptimizedDoubleBuffer, true)`。

`Draw`我发现如果在更改属性后直接调用我的方法，控件不会闪烁`RotorAngle`：

```
public float RotorAngle
{
    get { return mRotorAngle; }
    set
    {
        mRotorAngle = value;
        Draw(mRotorAngle);
    }
} 
```

但这会导致性能非常差，尤其是在全屏模式下。不可能每 20 毫秒更新一次控件。你可以自己试试。我将在下面附上完整的 Visual Studio 2008 解决方案。

那么，为什么会出现如此糟糕的表现呢？每 20 毫秒更新一次其他（自己的）控件是没有问题的。真的只是因为位图吗？

我创建了一个简单的 Visual Studio 2008 解决方案来演示这两个问题： [https](https://www.dropbox.com/s/mckmgysjxm0o9e0/WinFormsControlsTest.zip) ://www.dropbox.com/s/mckmgysjxm0o9e0/WinFormsControlsTest.zip (289,3 KB)

目录中有一个可执行文件`bin\Debug`。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:24:04.393

首先，根据 LarsTech 的回答，您应该`Graphics`使用`PaintEventArgs`. `CreateGraphics()`通过在处理程序内部调用`Paint`，您将`OptimizedDoubleBuffer`无法正常工作。

其次，在您的 SetStyle 块中，添加：

```
SetStyle( ControlStyles.Opaque, true ); 
```

...以防止基类 Control 在调用您的 Paint 处理程序之前填充背景颜色。

我在您的示例项目中对此进行了测试，它似乎消除了闪烁。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T15:25:52.307

不要使用`CreateGraphics`，而是使用从绘制事件传递给您的 Graphic 对象：

我像这样更改它并添加了一个清晰的因为调整大小会显示重影图像：

```
private void Draw(float rotorAngle, Graphics graphics)
{
  graphics.Clear(SystemColors.Control);
  graphics.InterpolationMode = InterpolationMode.HighQualityBicubic;

  // yada-yada-yada

  // do not dispose since you did not create it:
  // graphics.Dispose();
} 
```

调用自：

```
private void StatorAndRotor2_Paint(object sender, PaintEventArgs e)
{
  Draw((float)mRotorAngle, e.Graphics);
} 
```

在构造函数中，打开双缓冲，但我认为不需要透明度：

```
SetStyle(ControlStyles.AllPaintingInWmPaint, true);
SetStyle(ControlStyles.ContainerControl, false);
SetStyle(ControlStyles.OptimizedDoubleBuffer, true);
SetStyle(ControlStyles.ResizeRedraw, true);
//SetStyle(ControlStyles.SupportsTransparentBackColor, true); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T15:17:32.483

在 Paint 事件上在屏幕上绘图是一项繁重的操作。在内存缓冲区上进行绘制相对来说非常快。

[双缓冲](http://en.wikipedia.org/wiki/Multiple_buffering#Double_buffering_in_computer_graphics)将提高性能。与其在绘制图形上绘图，不如创建一个新图形，然后在其上进行所有绘制。

位图绘制完成后，将整个位图复制到从 PaintEventArgs 接收的 e.Graphics

[使用 GDI+ 和 C# 进行无闪烁绘图](http://www.codeproject.com/Articles/4646/Flicker-free-drawing-using-GDI-and-C)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T16:05:17.543

对于我的回答，我从[https://stackoverflow.com/a/2608945/455904获得灵感，并从上面的](https://stackoverflow.com/a/2608945/455904)[LarsTechs](https://stackoverflow.com/a/10586330/455904)回答中获得了一些东西。

为避免必须在所有 OnPaint 上重新生成完整图像，您可以使用变量来保存生成的图像。

```
private Bitmap mtexture; 
```

使用 Draw() 生成纹理

```
private void Draw(float rotorAngle)
{
    using (var bufferedGraphics = Graphics.FromImage(mtexture))
    {
        Rectangle imagePosition = new Rectangle(0, 0, Width, Height);
        bufferedGraphics.DrawImage(mStator, imagePosition);
        bufferedGraphics.DrawImage(RotateImage(mRotor, mRotorAngle), imagePosition);

        float normedAngle = mRotorAngle % cDegreePerFullRevolution;

        if (normedAngle < 0)
            normedAngle += cDegreePerFullRevolution;

        if (normedAngle >= 330 || normedAngle <= 30)
            bufferedGraphics.DrawImage(mLED101, imagePosition);
        if (normedAngle > 30 && normedAngle < 90)
            bufferedGraphics.DrawImage(mLED001, imagePosition);
        if (normedAngle >= 90 && normedAngle <= 150)
            bufferedGraphics.DrawImage(mLED011, imagePosition);
        if (normedAngle > 150 && normedAngle < 210)
            bufferedGraphics.DrawImage(mLED010, imagePosition);
        if (normedAngle >= 210 && normedAngle <= 270)
            bufferedGraphics.DrawImage(mLED110, imagePosition);
        if (normedAngle > 270 && normedAngle < 330)
            bufferedGraphics.DrawImage(mLED100, imagePosition);
    }
} 
```

让 OnPaint 的覆盖在您的控件上绘制纹理

```
protected override void OnPaint(PaintEventArgs e)
{
    base.OnPaint(e);
    Rectangle imagePosition = new Rectangle(0, 0, Width, Height);
    e.Graphics.DrawImage(mtexture, imagePosition);
} 
```

需要时覆盖 OnInvalidated() 到 Draw() 纹理

```
protected override void OnInvalidated(InvalidateEventArgs e)
{
    base.OnInvalidated(e);

    if (mtexture != null)
    {
        mtexture.Dispose();
        mtexture = null;
    }

    mtexture = new Bitmap(Width, Height);
    Draw(mRotorAngle);
} 
```

而不是调用 Draw 使图像无效。这将导致它使用 OnInvalidated 和 OnPaint 重新绘制。

```
public float RotorAngle
{
    get { return mRotorAngle; }
    set
    {
        mRotorAngle = value;
        Invalidate();
    }
} 
```

我希望我把所有的东西都放在那里了：）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-15T06:37:23.383

非常感谢您的帮助。

闪退就解决了。:)

现在，我按照[LarsTech 的](https://stackoverflow.com/a/10586330/1393897 "拉尔斯科技的")建议使用`Graphics`来自`PaintEventArgs`.

感谢[lnmx](https://stackoverflow.com/users/797538/lnmx "lnmx")提示`CreateGraphics()`内部`Paint`处理程序阻止`OptimizedDoubleBuffer`. 这解释了即使`OptimizedDoubleBuffer`启用了闪烁问题。我不知道，我也没有在[MSDN Library](http://msdn.microsoft.com/en-us/library/ms123401 "MSDN 库")找到这个。在我之前的控件中，我还使用了`Graphics`来自`PaintEventArgs`.

感[谢萨洛](https://stackoverflow.com/users/455904/sallow "灰黄的")的努力。今天我会测试你的代码，我会给出反馈。我希望这会提高性能，因为仍然存在性能问题——尽管双缓冲正确。

我的原始代码中还有另一个性能问题。

改变了

```
graphics.DrawImage(mStator, imagePosition);
graphics.DrawImage(RotateImage(mRotor, rotorAngle), imagePosition); 
```

到

```
graphics.DrawImage(mStator, imagePosition);
Bitmap rotatedImage = RotateImage(mRotor, rotorAngle);
graphics.DrawImage(rotatedImage, imagePosition);
rotatedImage.Dispose(); // Important, otherwise the RAM will be flushed with bitmaps. 
```

# iphone - 依次dismiss一个modalView和一个pushView

> ID：10585757
> 
> 赞同：2
> 
> 时间：2012-05-14T14:53:28.187
> 
> 标签：iphone, ios, dismiss

我如何在 tableView4 的 tableViewController 中同时关闭 tableView4 和 tableView3？

**rootView(tableView1, tabView的一个tab, 嵌入navigationController)-->pushView1(tableView2)-->pushView2(tableView3)-->ModalView1(tableView4, 嵌入navigationController);**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:49:29.217

在您的模态视图上调用dismissViewControllerAnimated：completion：然后在您想要的视图上调用popViewControllerAnimated：。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T16:49:49.710

```
 UINavigationController *myNavController = [myViewController navigationController];
   [myViewController dismissViewControllerAnimated:YES completion:^{
        [myNavController popToViewController:[myNavController.viewControllers objectAtIndex:1] animated:YES];
    }]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-16T11:18:32.000

尝试这个：

```
UINavigationController *myNavController = [myViewController navigationController];
[myNavController popToViewController:[myNavController.viewControllers objectAtIndex:1];
[myViewController dismissViewControllerAnimated:YES completion:nil]; 
```

# html - 为什么我的 textarea 的占位符没有出现？

> ID：10585759
> 
> 赞同：76
> 
> 时间：2012-05-14T14:53:34.160
> 
> 标签：html

我为我的所有表单元素使用占位符，除了文本区域之外，它都显示在它们中。现在只是在 safari 中查看它，并意识到我的 type="number" 输入也没有显示占位符。

该页面在[这里](http://davidspeightphotography.co.uk/wordpress/workshops/wharfedale-workshop/#)，您需要单击页面顶部的“立即预订”链接。

我的html：

```
<form id="booking" action="single-workshops.php">
    <input type="text" required="required" placeholder="name"/><br />
    <input type="text" required="required" placeholder="your phone number"/><br />
    <input type="email" required="required" placeholder="email"/><br />
    <input type="number" required="required" placeholder="how many in your party" /><br />
    <textarea rows="5" cols="30" placeholder="enter optional message">
    </textarea><br />
    <input type="button" value="submit"/>
</form> 
```

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2012-05-14T14:56:31.020

因为您的文本区域中有文本内容，其中包含换行符。

```
<textarea rows="5" cols="30" placeholder="enter optional message">
        </textarea><br /> 
```

应该：

```
<textarea rows="5" cols="30" placeholder="enter optional message"></textarea><br /> 
```

# wix - 防止 Msi 外部文件被压缩并包含到刻录引导程序中

> ID：10585762
> 
> 赞同：3
> 
> 时间：2012-05-14T14:53:44.990
> 
> 标签：wix, wix3.6, burn

是否可以将 Msi 包包含到引导程序中，但不能包含任何外部文件？

所以我的 msi 安装程序有一个文件：

```
<Component Directory="INSTALLDIR">
    <File Id="DatabaseBackup"
          Name="Database.bak"
          Source="Database.bak"
          Compressed="no" />
  </Component> 
```

输出：

*   安装程序.msi
*   数据库.bak

现在，如果我将刻录链设置为包含 msi 包：

```
<MsiPackage SourceFile="$(var.Installer.TargetPath)" /> 
```

“Database.bak”文件也被压缩到生成的 exe 中。是否可以压缩 msi 而不是 .bak 文件？

如果没有人可以比我更好地回答[这个](https://stackoverflow.com/questions/10573135/wix-installer-how-can-i-get-setup-exes-current-directory)问题，那么我根本不需要这样做！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T02:50:03.767

我为此目的使用了[Payload](http://wix.sourceforge.net/manual-wix3/wix_xsd_payload.htm)`MsiPackage`元素...在您的示例中，我将元素更改为：

```
<MsiPackage SourceFile="$(var.Installer.TargetPath)" >
  <Payload Compressed="no" SourceFile="{path_to_bak_file}\Database.bak"  />
</MsiPackage> 
```

然后 MSI 拾取该文件并按预期使用它。

我还没有找到一种方法来使这个有条件或灵活..在我的情况下，它是一个不重要的配置文件，但如果文件丢失，我的设置现在失败（首先打开一个文件打开对话框查找该文件） - 当然，这取决于我创建的 MSI 的详细信息。

希望这可以帮助

# java - 我无法理解以下错误

> ID：10585773
> 
> 赞同：-1
> 
> 时间：2012-05-14T14:54:18.047
> 
> 标签：java, list, playframework

这是错误：

> 发生 JPA 错误（无法构建 EntityManagerFactory）：无法确定类型：java.util.List，在表：问题，列：[org.hibernate.mapping.Column(Choices)]

我不明白我在其他类中使用过列表的错误，但它们与其他类有关系，它们有其他类的类型，但在这里我不明白他为什么看不到列表的类型

```
package models;

import play.*;
import play.db.jpa.*;

import javax.persistence.*;
import java.lang.reflect.Array;
import java.util.*;

@Entity
public class Question extends Model{
public String theQuestion;
public int marks;
public List<String> Choices;
@ManyToOne 
@JoinTable (name="questionInEexercise")
public Exercise myExercise;

public Question(String question,int marks,long Eid){
    this.theQuestion = question;
    this.marks = marks;
    this.myExercise = Exercise.findById(Eid);
    Choices = new ArrayList<String>();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:58:11.690

JPA 不知道如何正确映射您的字符串列表。您可以使用[ElementCollection](http://docs.oracle.com/javaee/6/api/javax/persistence/ElementCollection.html)映射它，以便 JPA 知道如何处理它。

# ios - iphone——存储数据的最佳方式

> ID：10585775
> 
> 赞同：0
> 
> 时间：2012-05-14T14:54:22.867
> 
> 标签：ios, data-storage

我正在从事一个涉及存储视频、照片、音频和文本数据的项目。这样做的最佳方法是什么？我想在开始之前找到最有效的方法。数据也必须是可编辑的。当用户选择一个表格视图单元格时，将显示一个详细视图，其中显示了所有数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:08:22.567

绝对存储在文件系统上。最佳实践表明将照片和视频存储在相册中效果最好，因为用户无需访问您的应用程序也可以访问它们。此外，要为自己创建参考，您可以在 coredata 中存储视频或照片名称等标识符。

# javascript - 在服务器上或隐藏字段中维护状态？

> ID：10585777
> 
> 赞同：0
> 
> 时间：2012-05-14T14:54:36.767
> 
> 标签：javascript, ajax

我在数据库中有 20 个相同类型的项目。每个项目都有一个行 ID、名称、描述和部分（A 或 B）。

我有一个显示此信息并允许用户更改每个项目的部分属性的网页。网页显示对于两个部分（部分 A 和部分 B）中的每一个都有一个窗格，并且每个部分包含一个按钮和该部分中每个项目的隐藏字段。按钮的标签文本是项目的名称。隐藏字段用于捕获相应项目按钮的部分（A 或 B）。

当用户按下 A 部分窗格中的某个项目按钮时，该按钮将移动到 B 部分窗格，并且该按钮的隐藏字段更新为“B”。同样，当用户按下 B 部分窗格中的项目按钮之一时，该按钮将移动到 A 部分窗格，并且该按钮的隐藏字段更新为“A”。

表单底部是一个提交按钮。当按下提交按钮时，所有 20 个包含其关联按钮部分（A 或 B）的隐藏字段都会被发布，并且 php 服务器端脚本会相应地更新每个按钮的数据库。

在这种情况下，最佳实践是使用 AJAX 来维护服务器上项目的状态，还是使用隐藏字段加上纯客户端 javascript 在表单发布之前维护项目的状态？为什么？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:02:08.667

在我看来，使用 AJAX 并更新该部分会带来更好的用户体验。这使用户不必在做出所有选择后单击提交按钮。此外，更简单，因为您不需要将这些先前的状态存储在隐藏字段或会话中。您可以实时进行更新。

# wso2 - WSO2 如何将 VFS 设置为计划任务

> ID：10585778
> 
> 赞同：1
> 
> 时间：2012-05-14T14:54:43.160
> 
> 标签：wso2, vfs

在 wso2 中，VFS 运行默认 5 分钟。我认为这对性能不利。我希望 VFS 在服务器不忙时运行。例如，可能在 02:00 没有正文请求，则 VFS 可以工作。我尝试添加计划任务，但它没有用。谁能告诉我该怎么做？非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:09:11.173

你的建议会导致饥饿。如果 ESB 服务器不断收到请求，VFS 任务将永远不会运行。如[ESB 文档](http://docs.wso2.org/display/ESB/VFS+Transport)中所述，您可以通过指定 transport.PollInterval 参数来调整轮询间隔。将轮询间隔增加到 30 分钟的示例在 ESB 配置中如下所示：

```
 <parameter name="transport.PollInterval">1800000</parameter> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T05:38:06.413

我认为您的问题与[WSO2 如何设置计划任务有关？](https://stackoverflow.com/questions/10526580/wso2-how-to-set-scheduled-task)和[https://stackoverflow.com/questions/10537190/how-to-vfs-service-exposed-as-a-web-service](https://stackoverflow.com/questions/10537190/how-to-vfs-service-exposed-as-a-web-service)问题。似乎您想在一天中的特定时间（计划到非高峰时间）或通过 Web 服务进行 VFS 轮询。但不幸的是，由于 VFS 传输的实现方式，我认为不可能将 CRON 表达式或服务调用插入 VFS。无论如何，您可以将其作为[WSO2 JIRA的功能请求提出建议](https://wso2.org/jira/browse/ESBJAVA#selectedTab=com.atlassian.jira.plugin.system.project:roadmap-panel)

# java - android - java 表单验证

> ID：10585780
> 
> 赞同：2
> 
> 时间：2012-05-14T14:54:45.393
> 
> 标签：java, android, forms, validation

我希望有人能指出我正确的方向。我正在寻找一种资源，可以向我展示如何在表单（联系表单）中验证用户输入，类似于 JavaScript 验证。我在网上搜索过，似乎找不到任何东西。

谢谢大家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:58:46.840

例如，您可以使用 Regex... [“Regex on Google”检查输入](https://www.google.fr/search?sourceid=chrome&ie=UTF-8&q=android%20regex#hl=fr&sclient=psy-ab&q=regex&oq=regex&aq=f&aqi=g4&aql=&gs_l=serp.3..0l4.5028.5028.0.8862.1.1.0.0.0.0.49.49.1.1.0...0.0.SJId0TjQ0cI&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.,cf.osb&fp=325d88282ff9044d&biw=1920&bih=894)

[Google 上的“正则表达式 Android”](https://www.google.fr/search?sourceid=chrome&ie=UTF-8&q=android%20regex#hl=fr&sclient=psy-ab&q=regex%20android&oq=regex%20android&aq=f&aqi=g1g-K2g-mK1&aql=&gs_l=serp.3..0j0i30l2j0i5i30.53293.54223.1.55310.8.7.0.0.0.0.87.498.7.7.0...0.0.QEDkjfLD2Vc&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.,cf.osb&fp=325d88282ff9044d&biw=1920&bih=894)

[关于在 android 中处理 Regex 的示例的主题](https://stackoverflow.com/questions/1129996/how-do-i-create-a-regular-expression-for-this-in-android)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:01:11.423

使用正则表达式，这里有一个很好的教程：[验证](http://www.zunisoft.com/2009/08/android-input-validation.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T08:01:18.340

如果您正在寻找一些简单的验证，那么将您的 java 文件视为简单的 javascript 函数。

```
step 1 : make a base class with all the validation function like

    public boolean isEmail(String fieldValue) 
        {
            Pattern p = Pattern.compile(".+@.+\\.[a-z]+");
            Matcher m = p.matcher(fieldValue);
            if(!m.matches()) {
                return false;
            } else {
                return true;
            }
        }

step 2 : initialize a variable valid = true ;

step 3 : initialize an object for this validator class in your desired form page

step 4 : call a validation function on click of form submit button

step 5 : use the object to call the validation function on your desired page and according to the result it gives , set valid = false or leave ,

step 6 : finally 

    if(valid) 

        { ... submit the form ...} 
```

# visual-c++ - 错误 LNK：未解析的外部符号，由虚函数引起

> ID：10585789
> 
> 赞同：1
> 
> 时间：2012-05-14T14:55:09.403
> 
> 标签：visual-c++, virtual, unresolved-external

以下是我编译代码时的错误。很抱歉我不能在这里分享我的代码。仅供参考，我不使用任何外部库，所以我真的不确定这些链接器错误。它们似乎来自我在`DeviceManager`课堂上声明的虚函数。它们各自的实现在另外两个类中。

有人可以帮我解决这些错误吗？

```
1>device_manager.obj : error LNK2028: unresolved token (0A000397) "public: virtual void __clrcall DeviceManager::loadConfig(class System::IO::StreamReader ^)" (?DeviceManager@DeviceManager@@$$FUAMXP$AAVStreamReader@IO@System@@@Z) referenced in function "void __clrcall `dynamic initializer for 'const DeviceManager::`vftable'''(void)" (???__E??_7DeviceManager@@6B@@@YMXXZ@?A0xc2524ebc@@$$FYMXXZ)
1>device_manager.obj : error LNK2019: unresolved external symbol "public: virtual void __clrcall DeviceManager::loadConfig(class System::IO::StreamReader ^)" (?loadConfig@DeviceManager@@$$FUAMXP$AAVStreamReader@IO@System@@@Z) referenced in function "void __clrcall `dynamic initializer for 'const DeviceManager::`vftable'''(void)" (???__E??_7DeviceManager@@6B@@@YMXXZ@?A0xc2524ebc@@$$FYMXXZ)
1>device_manager.obj : error LNK2001: unresolved external symbol "public: virtual class Device * __thiscall DeviceManager::createDevice(void)" (?createDevice@DeviceManager@@UAEPAVDevice@@XZ)
1>device_manager.obj : error LNK2001: unresolved external symbol "public: virtual void __thiscall DeviceManager::initializeDevices(void)" (?initializeDevices@DeviceManager@@UAEXXZ)
1>C:\Users\CH\Documents\Visual Studio 2010\Projects\Test Devices\Test Devices\Debug\Test Devices.exe : fatal error LNK1120: 4 unresolved externals
1>
1>Build FAILED.
1>
1>Time Elapsed 00:00:01.50
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

> 更新 1（可能的解决方案）：

问题似乎是因为在`DeviceManager`类中声明的虚函数不是纯虚函数并且在`.cpp`类中没有定义`DeviceManager`。

如果`DeviceManager`该类没有任何非虚函数，则将虚函数设为纯函数将是解决方案。像这样`virtual void testFunction();`的东西并不纯粹，因此将其更改`virtual void testFunction()=0;`为解决方案。为此，在继承`DeviceManager`该类的其他类中实现此虚函数的定义就足够了。在这种情况下，`DeviceManager`类变得抽象，因此无法实例化。

但就我而言，`DeviceManager`该类也有一些非虚拟函数，并且还需要实例化才能调用非虚拟函数。因此，解决方案是在继承该类的其他类中的声明和定义之外，实现该类`.cpp`中虚函数的定义。`DeviceManager``DeviceManager`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:01:21.507

您是否尝试过完全清洁和重建？

你的类是否至少有一个非虚成员函数？
几年前我就看到过这个问题。

除此之外，我建议将函数原型和完整参数列表复制到 word pad 或其他东西中并更改字体（以防止它看起来如此熟悉以至于你的眼睛会扫描它）然后比较每个函数的调用以确保它们匹配（更可能导致编译问题，但值得检查）。

# google-chrome - 谷歌浏览器。从 url 通知窗口向页面发送消息

> ID：10585790
> 
> 赞同：3
> 
> 时间：2012-05-14T14:55:10.320
> 
> 标签：google-chrome, notifications

我需要从通知窗口在页面上发送消息。怎么做我有以下页面

```
 var shownotif=0;         
    Set notification permissions for this page   Show HTML Notification    /*    * Common code    */   document.querySelector('#request_permission').addEventListener('click', function() {
    window.webkitNotifications.requestPermission();   }, false);
    // see the HTML section to see the button   var url = 'index212.html';   document.querySelector('#show_html_notification').addEventListener('click', function() {
    if (window.webkitNotifications.checkPermission() == 0) {
      // you can pass any url as a parameter
      notif=window.webkitNotifications.createHTMLNotification(url);
        notif.addEventListener('display', function() {
        ///alert(111);
      // notif.cancel();
        }
        );
         notif.addEventListener('click', function(g, g2) {
         setTimeout("tkfnm",1000);
        alert(jQuery.cookie("ca2"));
      // notif.cancel();
        }
        );
      notif.show(); // note the show()

    } else {
      alert("This page doesn't have permission to show notifications yet.");
    }   }, false); 
```

我希望当用户点击通知窗口时，在“父母”上发送我的信息和我的信息。

# android - 从单实例活动调用 com.facebook.katana.ProxyAuth 抛出错误

> ID：10585795
> 
> 赞同：4
> 
> 时间：2012-05-14T14:55:32.407
> 
> 标签：android, facebook, single-sign-on, facebook-authentication

启动 com.facebook.katana.ProxyAuth 时出现问题。启动此意图的活动在清单文件中定义为 android:launchMode="singleInstance" 我已通过将启动模式删除为单个实例来解决此问题，此意图已成功启动。

我真的需要这个活动是单实例，所以有人知道如何在不删除 android:launchMode="singleInstance" 的情况下解决这个问题吗？

```
 Intent intent = new Intent();

    intent.setClassName("com.facebook.katana",
            "com.facebook.katana.ProxyAuth");
    intent.putExtra("client_id", applicationId);

    // Verify that the application whose package name is
    // com.facebook.katana.ProxyAuth
    // has the expected FB app signature.
    if (!validateActivityIntent(activity, intent)) {
        return false;
    }

    // activity is defined in manifest as single instance
    activity.startActivityForResult(intent, activityCode); 
```

日志猫：

```
05-14 16:42:13.470: E/AndroidRuntime(28141): FATAL EXCEPTION: main
05-14 16:42:13.470: E/AndroidRuntime(28141): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.facebook.katana/com.facebook.katana.ProxyAuth}: java.lang.NullPointerException
05-14 16:42:13.470: E/AndroidRuntime(28141):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2787)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2803)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at android.app.ActivityThread.access$2300(ActivityThread.java:135)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2136)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at android.os.Handler.dispatchMessage(Handler.java:99)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at android.os.Looper.loop(Looper.java:144)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at android.app.ActivityThread.main(ActivityThread.java:4937)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at java.lang.reflect.Method.invokeNative(Native Method)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at java.lang.reflect.Method.invoke(Method.java:521)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at dalvik.system.NativeStart.main(Native Method)
05-14 16:42:13.470: E/AndroidRuntime(28141): Caused by: java.lang.NullPointerException
05-14 16:42:13.470: E/AndroidRuntime(28141):    at com.facebook.orca.common.util.Base64.c(Base64.java:497)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at com.facebook.orca.common.util.Base64.b(Base64.java:459)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at com.facebook.katana.ProxyAuth.b(ProxyAuth.java:36)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at com.facebook.katana.activity.PlatformDialogActivity.a(PlatformDialogActivity.java:127)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at com.facebook.orca.activity.FbFragmentActivity.onCreate(FbFragmentActivity.java:48)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1069)
05-14 16:42:13.470: E/AndroidRuntime(28141):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2751)
05-14 16:42:13.470: E/AndroidRuntime(28141):    ... 11 more
05-14 16:42:15.520: E/ActivityManager(114): Error running process
05-14 16:42:15.520: E/ActivityManager(114): java.io.IOException: Error running exec(). Command: [/system/xbin/procrank] Working Directory: null Environment: [ANDROID_SOCKET_zygote=11, ANDROID_BOOTLOGO=1, EXTERNAL_STORAGE=/mnt/sdcard, ANDROID_ASSETS=/system/app, ASEC_MOUNTPOINT=/mnt/asec, PATH=/sbin:/system/sbin:/system/bin:/system/xbin, ANDROID_DATA=/data, BOOTCLASSPATH=/system/framework/core.jar:/system/framework/ext.jar:/system/framework/framework.jar:/system/framework/android.policy.jar:/system/framework/services.jar:/system/framework/com.htc.framework.jar:/system/framework/com.htc.android.pimlib.jar:/system/framework/com.htc.android.easopen.jar:/system/framework/com.scalado.util.ScaladoUtil.jar, ANDROID_PROPERTY_WORKSPACE=10,65536, ANDROID_ROOT=/system, LD_LIBRARY_PATH=/system/lib]
05-14 16:42:15.520: E/ActivityManager(114):     at java.lang.ProcessManager.exec(ProcessManager.java:226)
05-14 16:42:15.520: E/ActivityManager(114):     at java.lang.ProcessBuilder.start(ProcessBuilder.java:201)
05-14 16:42:15.520: E/ActivityManager(114):     at com.android.server.am.ActivityManagerService.logProcessResult(ActivityManagerService.java:9437)
05-14 16:42:15.520: E/ActivityManager(114):     at com.android.server.am.ActivityManagerService.access$900(ActivityManagerService.java:155)
05-14 16:42:15.520: E/ActivityManager(114):     at com.android.server.am.ActivityManagerService$9.run(ActivityManagerService.java:9614)
05-14 16:42:15.520: E/ActivityManager(114): Caused by: java.io.IOException: No such file or directory
05-14 16:42:15.520: E/ActivityManager(114):     at java.lang.ProcessManager.exec(Native Method)
05-14 16:42:15.520: E/ActivityManager(114):     at java.lang.ProcessManager.exec(ProcessManager.java:224)
05-14 16:42:15.520: E/ActivityManager(114):     ... 4 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T13:46:38.247

它可能不是您需要的答案，但您可以尝试使用 android:launchMode="singleTask"，它在许多情况下的行为类似于 singleInstance，并且适用于 facebook 身份验证。查看[Android singleTask 或 singleInstance 启动模式？](https://stackoverflow.com/questions/3219726/android-singletask-or-singleinstance-launch-mode)

# c# - 我的电灯开关中的记录拒绝被删除

> ID：10585802
> 
> 赞同：0
> 
> 时间：2012-05-14T14:56:01.633
> 
> 标签：c#, visual-studio-lightswitch

我在 Lightswitch 中的 Phases 表曾经与我的 2 个表相关。我删除了关联，但是有一条记录由于某种原因无法删除，它说它们是引用它的相关记录

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T09:57:10.077

在我看来，您只删除**了**两个关联中的一个（每个相关表一个关联 - 您提到 Phases 表与两个表相关）。

此外，在表设计器中，您可以右键单击连接两个表的行（表示它们之间的关系），选择*Edit Relationship*，并将默认的*On Delete Behavior*从*Restricted*更改为*Cascade Delete*。

默认的*Restricted*将完全按照它所说的那样做，它将限制您删除具有相关记录的记录。*级联删除*将允许您删除具有相关性的记录，也将删除相关记录。

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T13:41:19.493

您是否删除了数据库或 LightSwitch 中的关联？

如果您在 LightSwitch 中删除了关联，那么数据库仍然不允许这样做。

如果您删除了数据库中的关联，您是否刷新了 LightSwitch 中的绑定？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T12:53:06.810

谢谢大家的帮助，我不得不重命名我的表，因为出于某种原因，Lightswitch 似乎缓存了我很久以前所做的更改并保留了它们......很奇怪。但是在我重命名我的表之后，我就可以删除记录了。

# java - 为具有动态属性的对象添加/编辑操作

> ID：10585807
> 
> 赞同：0
> 
> 时间：2012-05-14T14:56:14.923
> 
> 标签：java, jsf, primefaces, crud, managed-bean

我需要帮助来实施 CRUD 操作。我的应用程序包含一个对象表。每个对象都由属性（值）列表描述。一个属性使用自定义 JSF 编辑器进行修改，具体取决于属性类型。

当用户添加新帐户时，编辑者列表由对象类型确定，并使用`custom:include`标签显示在表单中。此自定义标记用于动态包含编辑器`<custom:include src="#{editor.component}">`。组件属性指向 JSF 编辑器的位置。

每个编辑器都有一个托管 bean，它实现了一个`ValueHolder`接口并继承了一个`AbstractEditor`类。AbstractEditor 包含一个*updateEditor*方法。

```
public interface ValueHolder {  
    String EDITOR_VALUES = "editorValues";  
    public Object getValue();  
} 
```

我使用会话映射，编辑器名称作为键，编辑器值作为值。当用户修改属性时，会调用 updateEditor 方法并使用编辑器的新值更新地图。

问题在于编辑器背后的 bean 的范围。如果我使用 @SessionScoped bean，则不会再次调用初始化编辑器的代码，并且我无法处理添加/编辑操作。@SessionScoped 仅适用于添加。我尝试过使用@RequestScoped，但是经常调用这些bean，我不知道这是否真的很好。

我正在使用 JSF2、PrimeFaces 3.0.M4 和 Spring Web Flow 进行导航。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T18:07:49.783

你看过用`@ViewScoped`豆子吗？只要您继续返回同一页面，视图范围的 bean 就会保持在范围内。这看起来像你在做什么。

或者，如果您使用 CDI，`@ConversationScoped`则可以在进行更新时使用将 bean 保持在范围内。这有一个明确的开始和结束。这将允许您确定 bean 何时超出范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:39:27.403

我保留了`@SessionScoped`豆子。bean 的名称存储在会话中，并且与编辑器的文件名相同。这样，编辑器和 bean 之间就有了关联。

接口中添加了一个*初始化*方法。`ValueHolder`添加/修改对象时调用此方法。

# groovy - groovy 脚本类路径

> ID：10585808
> 
> 赞同：7
> 
> 时间：2012-05-14T14:56:15.620
> 
> 标签：groovy, classpath

我正在用 Groovy 编写一个脚本，我希望有人能够简单地通过运行`./myscript.groovy`. `-classpath`但是，此脚本需要第 3 方库（MySQL JDBC），除了通过or参数之外，我不知道有任何方法可以将其提供给脚本`-cp`，例如

```
`./monitor-vouchers.groovy -cp /path/to/mysql-lib.jar` 
```

由于我不会在这里讨论的原因，实际上不可能使用 -classpath/-cp 参数向脚本提供 JAR 位置。有什么方法可以从脚本本身加载 JAR 吗？我尝试使用`@Grab`

```
import groovy.sql.Sql

@Grab(group='mysql', module='mysql-connector-java', version='5.1.19')
def getConnection() {
    def dbUrl = 'jdbc:mysql://database1.c5vveqm7rqgx.eu-west-1.rds.amazonaws.com:3306/vouchers_prod'
    def dbUser = 'pucaroot'
    def dbPassword = 'password'
    def driverClass = "com.mysql.jdbc.Driver"

    return Sql.newInstance(dbUrl, dbUser, dbPassword, driverClass)
}

getConnection().class 
```

但这会导致以下错误：

```
Caught: java.sql.SQLException: No suitable driver
java.sql.SQLException: No suitable driver
        at monitor-vouchers.getConnection(monitor-vouchers.groovy:13)
        at monitor-vouchers.run(monitor-vouchers.groovy:17) 
```

有没有办法我可以只使用`./monitor-vouchers.groovy`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-14T14:59:54.483

你应该能够做到：

```
import groovy.sql.Sql

@GrabConfig(systemClassLoader=true)
@Grab('mysql:mysql-connector-java:5.1.19')
def getConnection() {
    def dbUrl = 'jdbc:mysql://database1.c5vveqm7rqgx.eu-west-1.rds.amazonaws.com:3306/vouchers_prod'
    def dbUser = 'pucaroot'
    def dbPassword = 'bigsecret'
    def driverClass = "com.mysql.jdbc.Driver"

    return Sql.newInstance(dbUrl, dbUser, dbPassword, driverClass)
}

getConnection().class 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-15T17:11:14.400

还有两个选择：

1.  将 jar 放入**${user.home}/.groovy/lib**
2.  如果 jar 位于已知位置，请使用以下代码将其加载到当前类加载器中：

    this.class.classLoader.rootLoader.addURL( 新 URL() )

# c - C程序中调用的Linux重启函数导致程序在磁盘上创建的文件丢失

> ID：10585812
> 
> 赞同：7
> 
> 时间：2012-05-14T14:56:46.117
> 
> 标签：c, linux, reboot

我开发了一个 C 程序（Linux），该程序创建一个新文件并写入，然后重新启动 PC。

重新启动后，我丢失了程序创建的文件。当我停用重启功能时，我的程序创建的文件仍然存在。

在 Linux 上可以看到这种行为： - VirtualBox（文件系统 ext2）上的 OpenWrt（Backfire 10.03） - Linux（Ubuntu）（文件系统 ext4）

您对此行为有解释吗？我该如何解决？

```
#include <stdio.h>
#include <sys/reboot.h>

int main ()
{
    FILE    *pFile;
    char    mybuffer[80];

    pFile = fopen ("/home/user/Desktop/example.txt","w");
    if (pFile == NULL) perror ("Error opening file");
    else
    {
        fputs ("test",pFile);
        fclose (pFile);
    }
    rename("/home/user/Desktop/example.txt","/home/user/Desktop/example123.txt");
    reboot(RB_AUTOBOOT);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T15:10:14.970

[fclose](http://linux.die.net/man/3/fclose)的手册页说：

> 请注意， fclose() 仅刷新 C 库提供的用户空间缓冲区。为确保数据物理存储在磁盘上，内核缓冲区也必须刷新，例如使用 sync(2) 或 fsync(2)。

这意味着您需要在关闭文件描述符之前调用[fsync 。](http://linux.die.net/man/3/fsync)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-08-18T09:56:00.693

直接的问题是，您在重新启动之前没有同步文件。*实际*的问题是，您`reboot`直接调用系统调用，而不考虑系统上发生的其他事情。您所做的与简单地按下硬件重置按钮非常相似；你只是给内核做一点清理的机会，但随后一切都被艰难地杀死了。这是最终破坏文件系统和文件结构的绝对可靠方法。*不要这样做！*.

相反，您应该要求 init 系统执行正常重启。调用`reboot`系统调用需要特权访问。因此，您也可以要求 init 系统重新启动。在大多数系统上，都有一个符号链接`/sbin/reboot`指向程序，如果通过该符号链接调用该程序，该程序将启动正常重启。因此，我建议您将脏替换为（注意execlp 中`reboot(RB_AUTOBOOT)`的双重规范——这很重要）。`"/sbin/reboot"`

```
pid_t reboot_pid;
if( 0 == (reboot_pid = fork()) ) {
    execlp("/sbin/reboot", "/sbin/reboot", NULL);
    exit(1); /* never reached if execlp succeeds. */
}
if( -1 == reboot_pid ) {
    /* fork error... deal with it somehow */
}
int reboot_status;
waitpid(reboot_pid, &reboot_status, 0);
if( !WIFEXITED(reboot_status) ) {
    /* reboot process did not exit sanely... deal with it somehow */
}
if( 0 != WIFEXITSTATUS(reboot_status) ) {
    /* reboot process exited with error;
     * most likely the user lacks the required privileges */
}
else {
    fputs("reboot call sucessfull -- system is about to shutdown.");
    /* The init system is now shutting down the system. It will signals all
     * programs to terminate by sending SIGTERM, followed by SIGKILL to
     * programs that didn't terminate gracefully. */
} 
```

这样做，系统可以正常关闭，终止以干净方式运行的所有程序并在重新启动之前卸载所有文件系统，从而保持文件系统和数据的完整性。

请注意，如果您希望您的程序没有 root 访问权限，那么您将不得不跳一些圈子；在带有 systemd 的系统上，您可以通过 D-Bus 发送重启请求。但除非它失败，如果执行该命令的用户没有重新启动权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T15:20:22.490

我认为这里重要的是重启永远不会返回，所以你的程序永远不会真正正常退出。

在正常情况下（即在调用 fclose 后程序退出甚至崩溃），您的 FILE * 下的文件描述符将被关闭，并且它们的内核缓冲区将被刷新。

但是，在这种情况下，由于重新启动永远不会返回，我怀疑内核缓冲区没有以通常的方式被清理，因此没有将内容写入磁盘。

一个 fsync 调用可能会处理它。如果您想多疑，请执行 fsync，然后使用 fileno() 获取文件描述符并使用 sync() 确保刷新缓冲区。那时，进程地址空间中不应该有任何文件，并且您对重新启动的调用不应该导致任何问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-14T19:01:45.750

另一种解决方案是根据重启手册页调用同步

LINUX_REBOOT_CMD_POWER_OFF（RB_POWER_OFF，0x4321fedc；自 Linux 2.1.30 起）。消息“关机”。打印，系统停止，如果可能的话，系统的所有电源都会被切断。如果前面没有同步（2），数据将丢失。

# drupal - Drupal 6 响应式 Zen 子主题？

> ID：10585814
> 
> 赞同：0
> 
> 时间：2012-05-14T14:56:50.003
> 
> 标签：drupal, drupal-themes, drupal-zen

我在搜索有关版本 6 响应式 zen 子主题的工作或信息时运气为零。而不是重新创建轮子，我想我会在这里询问任何线索。这也是我第一次在堆栈上发帖，如果在其他地方更好地提出这个问题，请提前道歉。

我还想知道 v6 Zen 基础套件是否不是响应式设计的理想选择，因为样式表已经大量使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T18:44:42.060

Zen 基本主题已经（大部分？）做出响应。

要使用 Zen 构建响应式子主题，您需要[Zen Grids](http://zengrids.com/)

编辑：刚刚注意到你在问 D6，所以 YMMV。如果您正在构建一个响应式站点，那么只使用 BTB 并升级到 D7可能是一个更好的*主意。*

# git - 如何根据 blob/tree hash 发现上次相关的提交？

> ID：10585816
> 
> 赞同：5
> 
> 时间：2012-05-14T14:56:54.577
> 
> 标签：git

如果我`ls-tree`某棵树并获得了 blob 和树的列表，我如何才能发现与这些 blob 和树相关的最后一次提交？我正在寻找这样的东西：

```
$ git ls-tree HEAD
...
100644 blob  734713bc047d87bf7eac9674765ae793478c50d3   myfile
...
$ git show --commit 734713bc047d87bf7eac9674765ae793478c50d3
commit 734713bc047d87bf7eac9674765ae793478c50d3
Author: Scott Chacon <schacon@gmail.com>
Date:   Fri Jan 2 18:32:33 2009 -0800

    fixed refs handling, added gc auto, updated tests 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T10:01:57.827

我有点困惑。我不明白你为什么需要这样的东西。但是，我想这就是你想要的——

```
git ls-tree --name-only HEAD | while read file; do git log -n 1 --date=short --pretty="$file, author: %an, commit: %h, date: %ad, msg: '%s'" -- $file; done 
```

# c - 即使是root也可以锁定设备？

> ID：10585824
> 
> 赞同：3
> 
> 时间：2012-05-14T14:57:21.130
> 
> 标签：c, linux, locking, device

在使用 safecopy 恢复一些数据时，我注意到在抢救一些数据时，可能会意外发生系统自动挂载设备，或者用户不小心点击了 nautilus 中的驱动器图标。

我看了一点源代码，只是为了好玩，决定稍微修改一下。我包括 liblockdev 可能会在 safecopy 使用驱动器时锁定驱动器，因此理想情况下无法自动挂载。虽然这可以编译，但到目前为止它没有任何效果。那么问题来了，是否有可能锁定设备以使 root 也无法覆盖它？（或至少不直接）或者我是否正在尝试做一些不可能的事情？如果可能的话，至少我知道我的代码只有其他问题，但原则上它应该可以工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T19:27:13.333

您可以让所有系统都尝试将软链接挂载到指定的设备，这样每当您想使其脱机工作时，您只需删除软链接并在完成后替换它。

# c# - 如何使用 C# 格式化复选框？

> ID：10585829
> 
> 赞同：0
> 
> 时间：2012-05-14T14:57:40.693
> 
> 标签：c#, .net, winforms

我有一个 datagridview，其中显示了一个布尔值的复选框。它看起来像一个普通的复选框。

但我们想要的是删除实际的框，以便只显示复选标记。这可能吗？如果是这样，有没有人偶然知道怎么做？

如果有帮助，我正在使用 C#，这是在 WindowsForms 上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:04:47.290

这是一篇关于消除复选框边框的帖子

[如何删除复选框边框？](https://stackoverflow.com/questions/3544690/how-do-i-remove-checkbox-border)

简而言之，如果没有大量的工作，它实际上是不可能的。我会选择使用自定义图像的 Ryan Amies 解决方案

编辑：错误的链接。

# iphone - UITabBar 识别纵向或横向方向

> ID：10585832
> 
> 赞同：1
> 
> 时间：2012-05-14T14:57:52.907
> 
> 标签：iphone, objective-c, ios, xcode, uiinterfaceorientation

虽然在大多数情况下，我的应用程序的方向都可以正常工作，但我在 iPad 1 上测试时遇到问题。如果我将设备倾斜到相对较低的角度，则有时在浏览选项卡的选项卡时bar 以横向模式出现，但页面调用纵向模式 uiview 然后尝试以横向模式呈现它，搞砸了我的 UI。

我试图弄清楚是否有一种方法可以锁定“如果标签栏以横向模式出现，则始终调用横向 UIViews，如果处于纵向模式，则始终调用纵向 UIView。”

在每个视图控制器上，我设置了以下内容：

```
- (void)viewDidLoad
{
[super viewDidLoad];

// iPad-specific condition here
if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)
{
    if (UIDeviceOrientationIsPortrait([UIDevice currentDevice].orientation)){
        self.view = self.portraitViewiPad;
    }
    else {
        self.view = self.landscapeViewiPad;
    }
}
}

-(void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration {

// iPad-specific condition here
if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)
{
    if (toInterfaceOrientation == UIInterfaceOrientationPortrait || toInterfaceOrientation == UIInterfaceOrientationPortraitUpsideDown) {

        //show portrait XIB here
        self.view = self.portraitViewiPad;

    } else {

        //show landscape XIB here
        self.view = self.landscapeViewiPad;

    }
}
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)
    {
    // iPad-specific interface here
    return YES;
}
else
{
    // For iPhone and iPod touch interface
    return (interfaceOrientation == UIInterfaceOrientationPortrait);

}
} 
```

我还使用以下方法调整了应用程序委托，认为可以解决该问题：

```
- (void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController{
//CALLS RELOAD METHODS HERE AND EACH UIVIEW IS PROPERLY BEING CALLED
} 
```

**更新：**

通过检查状态栏的方向并相应地显示正确的 uiview 更正了此问题。以下是我更新 viewDidLoad 方法的方法：

```
if ([[UIApplication sharedApplication] statusBarOrientation] == UIDeviceOrientationLandscapeLeft){

    NSLog(@"Left landscape detected");

    self.view = self.landscapeViewiPad;

} else if ([[UIApplication sharedApplication] statusBarOrientation] == UIDeviceOrientationLandscapeRight){

    NSLog(@"Right landscape detected");

    self.view = self.landscapeViewiPad;

} else if ([[UIApplication sharedApplication] statusBarOrientation] == UIDeviceOrientationPortrait){

    NSLog(@"Portrait orientation detected");

    self.view = self.portraitViewiPad;

} else if ([[UIApplication sharedApplication] statusBarOrientation] == UIDeviceOrientationPortraitUpsideDown){

    NSLog(@"Upsidedown Portrait detected");

    self.view = self.portraitViewiPad;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:48:08.330

我认为您不想测试 [[UIDevice currentDevice] 方向]。正如文档所述，该值可能与应用程序 UI 的实际方向不同。我认为您需要依赖对 [UIViewController shouldRotateTo...] 和 [UIViewController willRotateTo...] 的调用。

# wordpress - Buddypress - 与群组相关的帖子可见性

> ID：10585835
> 
> 赞同：0
> 
> 时间：2012-05-14T14:58:00.510
> 
> 标签：wordpress, buddypress

我对buddypress很陌生。我正在尝试在 Drupal/Organic 组中做一些非常简单的事情。

*   创建一个 X 组。
*   创建一个带有名为“audience”的附加属性的帖子。这应该将组名作为可能的值，例如 Group X。

我希望属于 X 组的人可以看到标有受众 = X 组的帖子。据我所知，唯一的方法是在多站点安装中创建一个新博客。但对我来说似乎有点矫枉过正。

你能给我一些关于如何实现这一目标的建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T23:56:46.813

好吧，我目前正在处理这个问题，只是在群组中添加一个额外的页面，然后在那里显示与我选择的类别匹配的帖子。

要了解如何将页面/选项卡添加到组，请参阅文档： [http ://codex.buddypress.org/developer-docs/group-extension-api/](http://codex.buddypress.org/developer-docs/group-extension-api/)

但是，如果您没有足够的信心，有一个免费插件可以让群组管理员将博客类别与群组关联：http: [//buddydev.com/buddypress/blog-categories-for-groups-plugin/](http://buddydev.com/buddypress/blog-categories-for-groups-plugin/)

希望我对您有所帮助，即使您的问题是很久以前提出的：P。问候

# php - 在继续之前显示一条 javascript 消息

> ID：10585840
> 
> 赞同：0
> 
> 时间：2012-05-14T14:58:20.273
> 
> 标签：php, javascript, mysql

我有这段代码是在用户按下按钮后获取数据库中的特定项目。如果找到该项目，我想通过 javascript 显示确认消息，但我不知道如何显示它。

从数据库中获取项目后

```
if(null!=mysqli_fetch_array($res)))
{
    echo ""; // how can I call the javascript code here ?
} 
```

和下面的确认框

```
 <script type="text/javascript">
    function onConfirm()
    {
        return confirm("Display this item ?");        
    }
  </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:01:47.093

使用 jquery 和 ajax 从数据库中获取值：

```
<script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
$.get("ajax.php", function(data){

if(data != "0"){
if(confirm("Display this item ?"))
{

//do something

}
}

}); 
```

ajax.php：

```
//other db code here

if(null!=mysqli_fetch_array($res)))
{
echo "1"; 
}
else{
echo "0";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:04:03.253

有很多方法可以解决这个问题。一个好方法是：

*   向页面发送 ajax 请求
*   该页面执行 mysql 的操作并返回^(（在 PHP)的情况下为回显）消息
*   在回调函数上使用简单的方式，例如`alert()`显示消息。

# objective-c - 如何在 Objective-C 中创建文件范围类？

> ID：10585842
> 
> 赞同：2
> 
> 时间：2012-05-14T14:58:28.950
> 
> 标签：objective-c

我留下了原文，所以人们可以理解评论的上下文。希望这个例子能更好地帮助解释我所追求的。

我可以在 Obj-C 中创建一个具有文件范围可见性的类吗？

例如，我在 NSNotificationCenter 上编写了一个method-sqizzling 类别，它会在解除分配时自动删除任何观察者。

我在实现中使用了一个辅助类，为了防止名称冲突，我设计了一个命名方案。类别为 NSNotificationCenter (WJHAutoRemoval)，因此在此代码中使用的私有帮助器类被命名为...

```
WJH_NSNotification_WJHAutoRemoval__Private__BlockObserver 
```

这是一口，目前我只是这样做......

```
#define BlockObserver WJH_NSNotification_WJHAutoRemoval__Private__BlockObserver 
```

只需在代码中使用 BlockObserver。

但是，我不喜欢这种解决方案。

我想告诉编译器，“嘿，这个类被命名为 Bar。我的代码将作为 Bar 访问它，但我真的是唯一需要知道的人。你自己生成一个时髦的名字，或者更好的是，不要甚至导出符号，因为我是唯一应该关心的人。”

对于纯 C，我会是“静态”，而对于 C++，我会是“命名空间 { }”

在 Obj-C 中执行此操作的首选/最佳/唯一方法是什么？

**原始问题**

我想在另一个实现中使用一个辅助类。但是，我不想要外部链接。现在，我只是让帮助类名称非常独特，这样我就不会得到重复的链接器符号。

我可以使用静态 C 函数，但我想编写一个辅助类，链接器仅在编译单元内可见。

例如，我想在多个 .m 文件中包含以下内容，每个“Helper”对该文件都是唯一的，并且没有其他编译单元具有链接器访问权限。如果我在 10 个不同的文件中有这个，我将有 10 个单独的类。

```
@interface Helper : NSObject
...
@end

@implementation Helper : NSObject
...
@end 
```

我什至在任何地方都找不到这方面的提示，而且我在接口/实现前面加上“静态”的微弱尝试都出现了错误。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:07:44.230

由于 Objective-C 运行时，我不相信你能够做你想做的事。您的所有类都加载到运行时中，并且具有相同名称的多个类将相互冲突。

Objective-C 是一种动态语言。与在编译时绑定方法调用的其他语言不同，Objective-C 在调用（每次调用）时进行方法解析。运行时在运行时中查找类，然后在类中查找方法。运行时不支持具有相同名称的不同类，并且 Objective-C 不支持命名空间来分隔您的类。

如果您的`Helper`类在每种情况下都不同，则它们将需要不同的类名（在任何语言中，多个具有相同名称的类对我来说都是个坏主意）。如果它们相同，那么为什么要单独声明它们。

我认为您需要重新考虑您的策略，因为您尝试做的事情听起来不是很 Objective-C 或 Cocoa。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T20:47:00.770

没有办法让课程“隐藏”。正如 mttrb 所指出的，类可以通过运行时按名称访问。这与 C 和 C++ 不同，其中类只是由链接器解析为地址的符号。每个类都被注入到类层次结构中。

但我不清楚你为什么需要这个。如果你有一个私有类`WJHAutoRemovalHelper`或其他什么，它似乎不太可能与其他任何人发生冲突，就像私有 Apple 类或私有 3rdparty 框架类发生冲突一样。没有理由不遗余力地让它变得晦涩难懂。前缀`WJHAutoRemoval`应该足够使它独一无二。您是否正在尝试解决一些更深层次的问题？

顺便说一句：你如何实施其余的？您是否正在对观察者进行 ISA-swizzling 以覆盖其 dealloc？这似乎有很多棘手的代码来使一个非常小的事情稍微方便一些。

* * *

关于“私人”课程的问题，如果您手动完成，您的建议是可能的，但实际上没有理由这样做。您可以生成一个随机的、唯一的类名，调用它，`objc_allocateClassPair()`然后在运行时`objc_registerClassPair`将其分配给一个`Class`变量。（然后调用`class_addMethod`并`class_addIvar`构建它。然后，您可以在需要时始终通过该变量引用它。当然，在运行时调用它仍然可以访问它`objc_getClassList`，但系统中不会有类名的符号。

但这是大量的工作和复杂性，没有任何好处。ObjC 不会像 C++ 那样花太多时间担心保护程序不受自身影响。它使用命名约定和编译器警告来告诉你什么时候做错了，并期望作为一个优秀的程序员你会避免做错事。

# javascript - 扩展现有正则表达式以在 URL 链接后删除标点符号

> ID：10585847
> 
> 赞同：0
> 
> 时间：2012-05-14T14:58:58.120
> 
> 标签：javascript, regex, replace

我有一个与文本字符串中的 http 匹配并从文本创建工作 URL 的现有替换。

**工作示例：**

```
var Text = "Visit Gmail at http://gmail.com"
var linkText = Text.replace(/http:\/\/\S+/gi, '<a href="$&">$&</a>');
document.write(linkText); 
```

**输出：**

*[通过http://gmail.com](http://gmail.com)访问 Gmail*

**问题：**

当链接出现在句子的末尾并且标点符号错误地附加到 URL 的末尾时，就会出现问题。

有人可以建议扩展我的正则表达式（或者在转换后添加第二个替换）来克服这个问题吗？

我认为正确的答案将包括`/\W$/g`在我的原始正则表达式中添加一些内容，但我看不出如何将其应用于整个字符串中的一个单词。

一如既往，非常感谢任何帮助。

谢谢，皮特

**问题链接示例**

*   [http://gmail.com/](http://gmail.com/)。
*   [http://gmail.com](http://gmail.com) ,
*   [http://gmail.com/](http://gmail.com/)？
*   [http://gmail.com](http://gmail.com)！

所有这些都应该解析到**[http://gmail.com的链接](http://gmail.com)**

*请注意，有些可能以斜杠结尾，然后是标点符号，而另一些则以标点符号结尾，紧跟在域名后面。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:23:18.780

尝试

```
/http:\/\/(.(?![.?] |$))*/ 
```

我的逻辑是，如果最后一个字符是点，或者问号后跟空格或字符串结尾，则不需要它。

```
var Text = "Visit Gmail at http://gmail.com"
var linkText = Text.replace(/http:\/\/(.(?![.?](?:\s|$)))*./gi, '<a href="$&">$&</a>');
document.write(linkText); 
```

给

```
"Visit Gmail at <a href=\"http://gmail.com\">http://gmail.com</a>" 
```

编辑：

这可能会更好（它现在不匹配空白）

```
http:\/\/(.(?!(?:[.?](?: |$))))*. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:39:27.433

您可以*考虑*尾随不需要的字符，无论是否剥离它们。

两者的替代品是捕获缓冲区 1：`<a href="$1">$1<\/a>`

这也假设你可以做lookbehind。虽然我不确定客户端 JS 是否可以进行后向断言。

去除不需要的字符

```
/(http:\/\/\S+)(?<![\/.,?!])[\/.,?!]*/ 
```

或者，留下不需要的字符

```
/(http:\/\/\S+)(?<![\/.,?!])/ 
```

**备用，使用前瞻**

跳闸

```
/(http:\/\/\S+?(?=[\/.,?!]+(?:\s|$)|\s|$))[\/.,?!]*/ 
```

离开

```
/(http:\/\/\S+?(?=[\/.,?!]+(?:\s|$)|\s|$))/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:06:32.343

为什么不只使用否定字符类？

/http://\S+[^.,?!]/gi

# java - 如何自动创建丢失的文件夹？

> ID：10585851
> 
> 赞同：12
> 
> 时间：2012-05-14T14:59:08.773
> 
> 标签：java, file-io

在java中，我需要将一个字符串写入一个新文件，比如'c:\test\upload\myfile.txt'，如果'upload'文件夹不存在，它会自动创建它。怎么做 ？Apache Commons IO 有这个 API 吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-14T14:59:53.037

```
File file = new File(...);
file.mkdirs(); //for several levels, without the "s" for one level
FileWriter fileWriter = new FileWriter(file);
fileWriter.write("..."); 
```

> 创建由此抽象路径名命名的目录，包括任何必要但不存在的父目录。请注意，如果此操作失败，它可能已成功创建一些必要的父目录。
> 
> **返回：** 当且仅当创建了目录以及所有必要的父目录时才返回 true；否则为假

请参阅[File.mkdirs()](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#mkdirs%28%29)和 [File.mkdir()](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#mkdir%28%29)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-12T18:43:16.313

除了接受的答案之外，由于该问题还提到了库**Apache** **Common IO**，因此我在下面报告了一个使用这个不错的库的解决方案：

```
File file = new File("...  the directory path ..."); 
FileUtils.forceMkdir(file); 
```

该解决方案使用[`FileUtils`](http://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/FileUtils.html)包`org.apache.commons.io`和方法中的类[`forceMkdir`](http://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/FileUtils.html#forceMkdir%28java.io.File%29)，即“*创建一个目录，包括任何必要但不存在的父目录*”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-14T15:25:36.910

```
new File(fileToSave.getParent()).mkdirs(); 
```

它返回一个布尔值以检查制作是否成功（如果磁盘已满或存在名为“upload”的文件等将失败）

# c - C 将 strtok 添加到 char*

> ID：10585854
> 
> 赞同：1
> 
> 时间：2012-05-14T14:59:14.030
> 
> 标签：c, strtok

我在使用时遇到问题`strtok`，我不知道是问题`strtok`出在哪里还是其他原因。

我有一个 .txt 文件，其中包含如下数据：

```
sometextdada;othertextdata
yetmoredata;andmoredata 
```

读取的数据是以`struct`这种方式定义的存储：

```
typedef struct team{
    char *name;
    char *teamPlace;
}Team; 
```

如果我这样做：

```
char buffer[100];
Team eq;
/*Read first line*/
fgets(buffer, 100, equipas)!= NULL);
eq.name= strtok(buffer,";\n");
eq.teamPlace= strtok (NULL,";\n");

printf("%s %s\n", eq.name,eq.teamPlace); 
```

我可以看到它按`strtok`预期工作并存储`sometextdada`在`eq.name``othertextdata``eq.teamPlace`

现在我想`printf`用一个添加`eq`到以这种方式定义的链表的函数替换它：

```
typedef struct nodeTeam{
    int numberOfTeams;
    Team team;
    struct nodeTeam *next;
    struct nodeTeam *prev;
}NodeTeam; 
```

所以我替换`printf`了`addNodeTeamsSorted(headEquipas,&tailEquipas,eq);`

```
fgets(buffer, 100, equipas)!= NULL);
eq.name= strtok(buffer,";\n");
eq.teamPlace= strtok (NULL,";\n");

addNodeTeamsSorted(headEquipas,&tailEquipas,eq); 
```

现在，如果我打印我的链表，我可以看到我的节点已添加但`name`包含`teamPlace`垃圾字符。但如果我这样做：

```
fgets(buffer, 100, equipas)!= NULL);
eq.name= "test";
eq.teamPlace= "test2";

addNodeTeamsSorted(headEquipas,&tailEquipas,eq); 
```

我可以看到一切都按预期工作，这让我认为问题出`char`在我的`struct`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:04:56.827

`strtok`[对您在第一次调用](http://www.cplusplus.com/reference/clibrary/cstring/strtok/)中指定的缓冲区进行操作。`buffer`您需要复制字符串（`strncpy()`例如

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:05:55.113

您的问题是您的缓冲区是在堆栈上创建的，并且 strtok 的结果指向缓冲区。

当您从此函数返回或从缓冲区读取另一行时，堆栈（以及您的缓冲区）被重用于其他内容，并且您的指针指向的数据已被覆盖。常量字符串不会发生这种情况，因为它们位于静态内存区域而不是堆栈中。

尝试在 strtok() 的输出上使用函数 strdup() 并将它们保存到您的结构中；这会将 strtok() 返回的字符串复制到堆中，不会被意外覆盖。

# python - NER 朴素算法

> ID：10585864
> 
> 赞同：4
> 
> 时间：2012-05-14T14:59:36.547
> 
> 标签：python, nlp

我从来没有真正处理过 NLP，但对 NER 有一个想法，它不应该起作用，并且在某种情况下做得非常好。我不明白它为什么起作用，为什么不起作用或天气可以延长。

这个想法是通过以下方式提取故事中主要人物的名字：

1.  为每个单词构建字典
2.  为每个单词填写一个列表，其中包含文本中出现在它旁边的单词
3.  为每个单词找到一个与列表相关性最大的单词（意味着这些单词在文本中的使用相似）
4.  鉴于故事中一个角色的名字，像它一样使用的词也应该是这样的（假的，那是不应该的，但因为直到今天早上我才开始处理 NLP，所以我开始了天真的一天）

[我在Alice in Wonderland](http://www.umich.edu/~umfandsf/other/ebooks/alice30.txt)上运行了过于简单的代码（附在下面），“Alice”返回：

> 21 ['鼠标'，'纬度'，'威廉'，'兔子'，'渡渡鸟'，'狮鹫'，'螃蟹'，'女王'，'公爵夫人'，'步兵'，'黑豹'，'毛毛虫'， '心'，'国王'，'比尔'，'鸽子'，'猫'，'帽子'，'野兔'，'乌龟'，'睡鼠']

尽管它会过滤大写单词（并接收“Alice”作为要聚集的单词），但最初有大约 500 个大写单词，就[主要角色](http://en.wikipedia.org/wiki/Alice%27s_Adventures_in_Wonderland#Characters)而言，它仍然非常合适。

它不适用于其他角色和其他故事，但会产生有趣的结果。

知道这个想法是否可用、可扩展，或者为什么它在这个故事中对“爱丽丝”起作用？

谢谢！

```
#English Name recognition
import re
import sys
import random
from string import upper

def mimic_dict(filename):
  dict = {}
  f = open(filename)
  text = f.read()
  f.close()
  prev = ""
  words = text.split()
  for word in words:
    m = re.search("\w+",word)
    if m == None:
      continue
    word = m.group()
    if not prev in dict:
      dict[prev] = [word]
    else :
      dict[prev] = dict[prev] + [word] 
    prev = word
  return dict

def main():
  if len(sys.argv) != 2:
    print 'usage: ./main.py file-to-read'
    sys.exit(1)

  dict = mimic_dict(sys.argv[1])
  upper = []
  for e in dict.keys():
    if len(e) > 1 and  e[0].isupper():
      upper.append(e)
  print len(upper),upper

  exclude = ["ME","Yes","English","Which","When","WOULD","ONE","THAT","That","Here","and","And","it","It","me"]
  exclude = [ x  for x in exclude if dict.has_key(x)] 
  for s in exclude :
    del dict[s]

  scores = {}
  for key1 in dict.keys():
    max = 0
    for key2 in dict.keys():
      if key1 == key2 : continue
      a =  dict[key1]
      k =  dict[key2]
      diff = []
      for ia in a:
        if ia in k and ia not in diff:
          diff.append( ia)
      if len(diff) > max:
        max = len(diff)
        scores[key1]=(key2,max)
  dictscores = {}
  names = []
  for e in scores.keys():
    if scores[e][0]=="Alice" and e[0].isupper():
      names.append(e)
  print len(names), names     

if __name__ == '__main__':
  main() 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T15:24:35.083

从您的程序的外观和以前使用 NER 的经验来看，我会说这“有效”，因为您没有进行适当的评估。您在本应找到“三月野兔”的地方找到了“野兔”。

NER 的困难（至少对于英语来说）是找不到名字。它正在检测它们的全部范围（“三月野兔”示例）；即使在所有单词都大写的句子开头也能检测到它们；将它们分类为人/组织/位置/等。

此外，《*爱丽丝梦游仙境*》作为儿童小说，是一个相当容易处理的文本。像“微软首席执行官史蒂夫鲍尔默”这样的新闻专线提出了一个更难的问题。在这里，你想检测

```
[ORG Microsoft] CEO [PER Steve Ballmer] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T17:57:42.377

你正在做的是建立一个[分布式词库](https://github.com/MLCL/Byblo)- 查找与查询（例如 Alice）在分布上相似的词，即出现在相似上下文中的词。这不会自动使它们成为同义词，但意味着它们在某种程度上类似于查询。您的查询是命名实体这一事实本身并不能保证您检索到的相似词将是命名实体。然而，由于`Alice`,`Hare`和`Queen`倾向于出现相似的上下文，因为它们有一些共同的特征（例如，它们都会说话、走路、哭泣等——爱丽丝梦游仙境的细节让我无法理解）它们更有可能被检索到。事实证明，在确定某物是否为命名实体时，单词是否大写是非常有用的信息。如果你不过滤掉非大写的单词，你会看到很多其他没有命名实体的邻居。

查看以下论文，了解人们如何使用分布式语义：

*   [林1998](http://acl.ldc.upenn.edu/P/P98/P98-2127.pdf)
*   [格雷芬斯特 1994](http://books.google.co.uk/books?hl=en&lr=&id=ZAxgQRIgzIcC&oi=fnd&pg=PR9&dq=Explorations%20in%20Automatic%20Thesaurus%20Discovery&ots=TbaZbyoWI5&sig=bgmYT9FFgK5dkeRlcixXhl9fZmg#v=onepage&q=Explorations%20in%20Automatic%20Thesaurus%20Discovery&f=false)
*   [舒策 1998](http://dl.acm.org/citation.cfm?id=972724)

为了将您的想法放在这些论文中使用的术语中，步骤 2 为来自大小为 1 的窗口的单词构建上下文向量。步骤 3 类似于分布语义中的几个众所周知的相似性度量（最著名的是所谓的 Jaccard系数）。

正如所`larsmans`指出的，这似乎很有效，因为您没有进行适当的评估。如果你对一个手工注释的语料库运行这个，你会发现它在识别名称实体的边界方面非常糟糕，它甚至不会尝试猜测它们是人、地方还是组织......不过，这是一个很好的第一个尝试 NLP，继续努力！

# java - 数据存储实体键冲突

> ID：10585873
> 
> 赞同：2
> 
> 时间：2012-05-14T14:59:59.353
> 
> 标签：java, google-app-engine, google-cloud-datastore

在开发中，我有一个空的数据存储。在线我有一个包含数百万实体的数据存储。

在开发数据存储（本地）中，我放置了一个新实体（生成新密钥）。然后我导出实体并将其放入在线数据存储中（使用本地生成的密钥）。本地生成的密钥已经分配给在线数据存储中的实体的风险是什么？

或者通过像这样在本地创建密钥来避免冲突是否更简单：

```
for (int i = 0; i < data.size(); i++) {
    Key k = KeyFactory.createKey(kind, new Date() + i);
    // continue to creating and inserting entities...
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:52:43.633

来自[https://developers.google.com/appengine/docs/java/datastore/entities](https://developers.google.com/appengine/docs/java/datastore/entities)：

> 高级应用程序有时可能希望手动将自己的数字 ID 分配给它们创建的实体，而不是使用键名字符串或自动生成数字 ID。但是请注意，没有什么可以阻止数据存储区将您的一个手动数字 ID 分配给另一个实体。避免此类冲突的唯一方法是让您的应用程序使用 DatastoreService.allocateIds() 或 AsyncDatastoreService.allocateIds() 方法获取一个 ID 块。数据存储区的自动 ID 生成器将跟踪已使用这些方法分配的 ID，并避免将它们重复用于另一个实体，因此您可以安全地使用此类 ID 而不会发生冲突。

您必须手动生成**所有**数字键（并且以它们永远不会发生冲突的方式）或使用`allocateIds()`. 除非您使用该功能，否则无法保证您手动生成的任何内容都不会与现有密钥发生冲突。生成的键 ID 不像关系数据库中的自动递增字段，每次递增一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T21:16:16.607

您应该提供有关您的用例的更多信息，以便任何人提出适当的解决方案。例如，您可以像这样在 dev 数据库上创建密钥：

```
 KeyFactory.createKey(entity, "dev_" + UUID.randomUUID()) 
```

另一种选择是创建一个小型实用程序或应用程序，从本地数据库中检索实体，然后将其发布到开发数据库。获取 POST 的在线服务器将创建一个新实体并从客户端分配除密钥之外的所有属性，从而让 GAE 自动生成一个新密钥。然后可以将新密钥发送回客户端，作为对 POST 操作的响应。

同样，我不知道您以后是否要更新本地数据库以与在线重新同步，但如果是这样，定义您自己的密钥的第一种方法将起作用，因为下一次同步将在线更新实体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T14:47:29.037

当数据存储生成键时，ID 是**整数**。如果您使用**字符串**作为 Id 生成键，那么它们将不会覆盖现有实体。

```
a.key.id() == 1
b.key.id() == '1'
a.key.id() != b.key.id() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T16:38:35.223

这取决于您在实体上拥有的 ID 类型。如果它们是整数，它们很小，很容易发生冲突。

我建议只创建与 Google 默认使用的密钥格式略有不同的密钥格式。只要 KeyFactory 使用时钟的全部精度（即不会停在几秒钟），您上面的函数看起来就应该可以工作。

# git - 你如何找到谁将一个 git commit 合并到一个分支中？

> ID：10585874
> 
> 赞同：11
> 
> 时间：2012-05-14T15:00:00.710
> 
> 标签：git, bug-tracking, blame

我们的 git 存储库中有一个文件在工作中，我想找出谁将这个文件合并到一个分支中。

我有识别引入文件的提交（比如说`552a976f1a25f9bad57efb9455e951f6b7b3367f`）的提交哈希，并且我知道文件在分支上`staging`。

如何找到将上述提交合并到`staging`分支中的提交的哈希？我想找到合并的用户，以及合并的日期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:10:38.673

```
git log -1 --merges <hash> 
```

将显示自提交以来最近的合并提交日志`<hash>`（包括它本身）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T09:54:22.217

![分支机构](../Images/f68cdafdd880622da46ae9fa1555deee.png)

如果我理解正确，您有 C5，并且您正在搜索 C6。如果是这种情况，您可能正在寻找这个：

```
git rev-list --merges HEAD --not <hash> --reverse 
```

它将为您提供哈希提交后发生的合并提交列表。我`HEAD`在此命令中使用，相信您`master`在示例中或`staging`在您的情况下。

在不太复杂的环境中，您可能正在寻找提交后发生的第一次合并......但如果您没有这种机会，您可以尝试：

```
git log --graph --decorate HEAD...<hash>^ 
```

或任何用于探索您的历史的图形工具（例如`gitk`）...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-06-01T11:43:05.343

```
git log <commit-id>..<branch> --ancestry-path --merges --reverse 
```

`<commit-id>`将为您提供自您感兴趣以来发生*的*合并列表以及`<branch>`. 根据您的合并工作流程，您感兴趣的合并可能是列表中的第一个或下一个。

将历史的相关部分可视化将很有帮助

```
git log --oneline --graph --decorate --ancestry-path --boundary <commit-id>..<branch> 
```

在图表底部附近寻找您`<commit-id>`的（它将属于“图表边界” - 标有`o`而不是`*`）。

# java - 高级 Android 动画 - 比例：按视图移动

> ID：10585876
> 
> 赞同：1
> 
> 时间：2012-05-14T15:00:17.027
> 
> 标签：java, android, animation, scale

我能够使用标准动画程序缩放视图。

```
Animation anim = new ScaleAnimation(1.0F, 1.0F, 1.0F, 2.0F);
    anim.setFillAfter(true);
    anim.setDuration(animationLength);
    anim.setInterpolator(this, android.R.anim.linear_interpolator);
    view.setAnimation(anim);
        view.startLayoutAnimation(); 
```

view 是一个 ViewAnimator 但类型并不重要。

整个视图包含在一个 LinearLayout 中。

因此，当我按上述方式放大视图时，我希望图像下方的视图（按钮、文本等）向下移动并显示在放大的图像下方。这不会发生，最终结果是视图是两倍大，但按钮不会移动，并且显示在我的放大视图的顶部（渲染，而不是线性地在顶部）。

现在，我可以着手改变视图的其余部分，但这似乎效率低下，那么有没有更好的方法呢？

谢谢艾登

# scorm - SCORM 1.2 中的元素

> ID：10585877
> 
> 赞同：1
> 
> 时间：2012-05-14T15:00:17.337
> 
> 标签：scorm, scorm2004, scorm1.2

我想将清单文件从 SCORM 1.2 转换为 SCORM 2004 第 3 版。`<adlcp:prerequisites>`SCORM 2004 第 3 版中SCORM 1.2 元素的对应元素是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:22:34.723

查看排序和导航书中的前置条件排序规则。

为了模拟先决条件，您首先要在 SCO 的主要目标上定义一个全局目标，即先决条件。确保它将满意状态写入全局。

然后，在您希望禁用的活动上，创建一个本地目标，该目标从 prereq 活动的全局目标中读取。然后创建一个前置条件排序规则，说明“如果本地目标不满足或具有未知状态，则禁用”。这将禁用当前活动，直到满足先决条件。

有关实现先决条件的示例清单，请参阅[“强制顺序”SCORM 示例课程。](http://scorm.com/scorm-explained/technical-scorm/golf-examples/#forcedsequencial)

# c++ - 没有 TTY 的 Execlp 调用 bash

> ID：10585878
> 
> 赞同：1
> 
> 时间：2012-05-14T15:00:22.380
> 
> 标签：c++, bash, sockets, ssh, tty

我正在使用一些管道和叉子来执行类似的命令

猫文件.tar.gz | myprogram -c "tar -zvt" -i "remoteMachineIp"

但如果我这样做

我的程序 -c “bash” -i “remoteMachineIp”

bash 没问题，但没有 tty。如果没有 tty，如果我调用 vim 命令，它会打开 vi 混乱。

我如何使用 tty 在 execlp 上调用 bash。

代码示例

```
if(cm->pid2==0){ //pipe and fork to send data to my execlp
close(cm->fout[0]);
dup2(cm->fout[1], 1);
execlp("bash", "bash", "-c", command.c_str(), NULL); // command is mycommand so is bash -c "bash"
}
else{
close(cm->fout[1]);
while((size=read(cm->fout[0], buffer, 2000)) > 0){
cm->message->send(buffer, size); //send the data to my program
}
//Close it and send the return code 
```

问题是 execlp 将 bash 返回给我，但没有 tty

我如何用 tty 调用 bash？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:04:37.387

我猜您担心的是您启动的命令继承`stdin`自其父级 ( `myprogram`)，而其父级的命令`stdin`是从`cat file.tar.gz`. 您想运行一个强制从 tty 读取数据的子进程，而不是继承的`stdin`管道。

您可以打开`/dev/tty`以获取对 tty 的引用。如果没有 tty，它将失败。例如：

```
close(0);
open("/dev/tty", O_RDWR);
/* The file descriptor returned by open should be 0 */ 
```

但是，我注意到您将子命令重定向`stdout`到程序的管道。如果您正在执行的命令`exec`是交互式的，则这将不起作用。交互式命令需要将其输入和输出都连接到 tty。`stdin`无论您是否连接到 tty ，启动一个输出连接到管道的交互式命令可能没有任何意义。

顺便说一句：你为​​什么使用`bash -c <command>`而不是`sh -c <command>`在你的`execlp`？这样，您就引入了对`bash`您真正需要的地方的不必要的依赖，即标准 POSIX bourne shell `sh`。`exec`ing through`sh -c`是通过 shell 启动命令的标准方法。例如，这就是由 完成的`system()`。

# iphone - nsfilemanager attributesOfItemAtPath 只返回一个通用文件类型

> ID：10585879
> 
> 赞同：0
> 
> 时间：2012-05-14T15:00:23.820
> 
> 标签：iphone, xcode, nsfilemanager

我需要确定给定路径的文件类型，而不需要文件扩展名。

我认为这`attributesOfItemAtPath`会给我所需的信息，但这只是返回值 NSFileTypeRegular - 哇......

有没有办法在没有文件扩展名的情况下找出文件类型（excel/powerpoint/m4v/pdf）？

谢谢你的帮助！

# php - 保存多个表格

> ID：10585881
> 
> 赞同：0
> 
> 时间：2012-05-14T15:00:27.480
> 
> 标签：php, symfony

例如拥有这个实体：

```
<?php

namespace Gitek\HotelBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * Gitek\HotelBundle\Entity\Product
 *
 * @ORM\Table()
 * @ORM\Entity(repositoryClass="Gitek\HotelBundle\Entity\ProductRepository")
 */
class Product
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @var string $name
     *
     * @ORM\Column(name="name", type="string", length=100)
     */
    private $name; 
```

如何构建一个表格以连续保存 10 个产品？我想要一个带有“+”按钮的表单，并以动态方式添加行并连续提交所有产品。

任何帮助或线索？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:06:48.073

这是最少的代码量，可以查看您的工作过程。

但基本上这样的任务是通过将会话上的所有信息存储**为**一个多维数组并最终将它们**逐个**插入到最后一点来解决的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:09:43.483

当您单击“添加”按钮时，您可以使用 Javascript(jQuery) 将表单元素动态添加到您的页面。像这样的东西：

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title></title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function() {
            $('#btnAdd').click(function() {
                var num     = $('.clonedInput').length;
                var newNum  = new Number(num + 1);

                var newElem = $('#input' + num).clone().attr('id', 'input' + newNum);

                newElem.children(':first').attr('id', 'name' + newNum).attr('name', 'name' + newNum);
                $('#input' + num).after(newElem);
                $('#btnDel').attr('disabled','');

                if (newNum == 5)
                    $('#btnAdd').attr('disabled','disabled');
            });

            $('#btnDel').click(function() {
                var num = $('.clonedInput').length;

                $('#input' + num).remove();
                $('#btnAdd').attr('disabled','');

                if (num-1 == 1)
                    $('#btnDel').attr('disabled','disabled');
            });

            $('#btnDel').attr('disabled','disabled');
        });
    </script>
</head>

<body>

<form id="myForm">
    <div id="input1" style="margin-bottom:4px;" class="clonedInput">
        Name: <input type="text" name="name1" id="name1" />
    </div>

    <div>
        <input type="button" id="btnAdd" value="add another name" />
        <input type="button" id="btnDel" value="remove name" />
    </div>
</form>

</body>
</html> 
```

[参考](http://charlie.griefer.com/blog/2009/09/17/jquery-dynamically-adding-form-elements/)
然后当表单发布时，您可以遍历`$_POST`数组。

# c# - 是否可以在运行时将命名空间动态更改为 ServiceContract？

> ID：10585886
> 
> 赞同：6
> 
> 时间：2012-05-14T15:00:49.743
> 
> 标签：c#, .net, wcf

前任：

```
[ServiceContract(Namespace = "@services.url@/",
        Name = "FedExContract")] 
```

我需要在运行时更改“@services.url@”的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T02:47:44.517

您可以在运行时更改它。但这将是很多工作，而且必须在服务开始之前发生。服务启动后，您将无法修改合同信息。

我个人不喜欢依赖数据库的服务启动。如果出现问题，服务永远不会出现，故障排除对于 IT 来说可能是一个复杂的过程。如果我要走运行时路线，我会将命名空间值存储在我的配置文件中。只是保持简单，并且仍然可以像您在问题中描述的那样启用部署后令牌替换。

从您提到的构建过程的评论中。这就是我们处理它的方式：使命名空间成为一个常量字符串。例如：

```
[DataContract(Namespace=Constants.CURRENT_NAMESPACE]
public class MyClass
{ } 
```

现在在一个单独的文件中声明：

```
// in a separate file define:
public static class Constants
{
    public const string CURRENT_NAMESPACE = "url://Services";
}; 
```

当您想为不同的环境构建时，将常量文件换成新定义：

```
//As a part of your build process switch the Constants file:
public static class Constants
{
    public const string CURRENT_NAMESPACE = "url://Eclipse/Services";
}; 
```

它易于管理，您始终知道正在使用的命名空间......并且服务始终启动。那样有用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:06:07.090

除了使用条件编译符号之外，想不出任何其他方法，即

```
#if Debug 
[ServiceContract(Namespace = "@AA.BBB@/", Name = "FedExContract")]

#endif 
```

命名空间是静态的，因为如果您更改合约的命名空间，您可能需要重新创建客户端代理。

# iphone - CLLocationManager - iPhone 应用程序中的自定义位置管理器

> ID：10585897
> 
> 赞同：0
> 
> 时间：2012-05-14T15:01:22.567
> 
> 标签：iphone, ios, location, cllocationmanager

我对这项技术很陌生，所以请帮助我。

我正在使用 CLLocationManager 来获取当前位置，并且我的应用程序具有自定义设置，显示他是否允许当前位置的状态，即消息提示，当我们编写时默认出现

```
[self.locationManager startUpdatingLocation]; 
```

如果用户在该消息提示上点击不允许并返回到我的应用程序自定义设置并更改关闭按钮以打开位置，我可以获取用户的当前位置。

这个东西怎么实现？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-14T16:52:11.327

一旦用户拒绝您的应用程序的位置服务，它只能在常规设置中重新打开 - 所以告诉用户然后将它们发送到那里。（您可能想先使用 UIAlertView 通知他们。）

```
// If Location Services are disabled, restricted or denied.
if ((![CLLocationManager locationServicesEnabled])
    || ([CLLocationManager authorizationStatus] == kCLAuthorizationStatusRestricted)
    || ([CLLocationManager authorizationStatus] == kCLAuthorizationStatusDenied))
{
    // Send the user to the location settings preferences
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString: @"prefs:root=LOCATION_SERVICES"]];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:15:12.133

您的问题的简短回答是“是”。当用户通过设置为您的应用启用定位服务时，就好像用户在被提示时回答“是”一样。您可以通过检查代码中的授权状态来检查您的应用是否启用了位置服务，因此：

```
if ([CLLocationManager authorizationStatus] == kCLAuthorizationStatusAuthorized) 
{
    //Get user's current location

} 
```

# php - register_shutdown_function() 和 die()

> ID：10585901
> 
> 赞同：5
> 
> 时间：2012-05-14T15:01:45.140
> 
> 标签：php, smarty, die

我可以以某种方式检查我的脚本是否被 in 取消`die()`了[`register_shutdown_function()`](http://php.net/manual/en/function.register-shutdown-function.php)？

像这样的东西：

```
register_shutdown_function('shutdown');

die('Calling die()');

function shutdown()
{
    if (???)
    {
        // Script was canceled by die()
    }
} 
```

**注意**：在我的网站上，我使用 Smarty。所以也许检查一下，如果`$smarty->display()`被调用或类似的东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T15:10:54.477

有点......但你不一定会喜欢它必须如何完成。

由于没有钩子可以让你检查是否`die`被调用，你将不得不以某种方式伪造它。假设您无法触及对 的所有调用`die`，则只剩下一个选项：默认设置一些表示“`die`被调用”的状态，并仅在脚本的最后删除该状态，当您知道您将退出时`die`之前被调用过。

“设置一些状态”听起来有点像全局变量，这应该是最后的手段，所以让我们使用一个常量来表示状态：

```
register_shutdown_function('shutdown');
if (condition) die('Calling die()');

// since we reached this point, die was not called
define('DIE_NOT_CALLED', true);

function shutdown()
{
    if (!defined('DIE_NOT_CALLED'))
    {
        // Script was canceled by die()
    }
} 
```

**[看到它在行动](http://ideone.com/U9qZK)**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:07:03.173

我认为唯一的方法是在脚本末尾设置一个全局可访问的变量。如果已设置此变量，您可以检查关闭功能。如果不是，则脚本过早终止。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T16:40:22.323

`die`首先，`exit`如果你在 FastCGId 上部署，你应该避免。它会杀死进程，从而防止它们被重新用于另一次运行。

如果您只是想检查 Smarty 是否有输出，您可能想尝试以下操作：

```
MySmarty extends Smarty {
  public static $_has_displayed = false;
  public function display(/* params */) {
    $t = parent::display(/* params */);
    self::$_has_displayed = true;
    return $t;
  }
}

register_shutdown_function('foo');
function foo() {
  if (!MySmarty::$_has_displayed) {
    echo "OMG I failed!";
  }
} 
```

# codeigniter - 通过 gmail 在 CodeIgniter 中发送电子邮件

> ID：10585905
> 
> 赞同：4
> 
> 时间：2012-05-14T15:02:09.633
> 
> 标签：codeigniter, mamp

我正在按照教程使用 gmail 发送电子邮件，但是我得到的是一个页面，它只是挂起，甚至没有加载错误。我正在使用 MAMP，所以这可能是它不起作用的原因。

```
class Email extends CI_Controller{

    public function __construct()
   {
        parent::__construct();

   }

    function index(){

        $config = Array(
            'protocol' => 'smtp',
            'smtp_host' => 'ssl://smtp.googlemail.com',
            'smtp_port' => 465,
            'smtp_user' => 'email',
            'smtp_pass' => 'pass'
        );

        $this->load->library('email',$config);

        $this->email->set_newline("/r/n");
        $this->email->from('email', 'George');
        $this->email->to('email');
        $this->email->subject('hey this is an email');
        $this->email->message('this is the content of the email');

        if($this->email->send()){

                echo 'Your message was sent';

        }else{

            show_error($this->email->print_debugger());

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T17:15:57.813

在您的 php.ini 文件中取消注释 extension=php_openssl.dll

```
$config = Array(
            'protocol'  => 'smtp',
            'smtp_host' => 'ssl://smtp.googlemail.com',
            'smtp_port' => '465',
            'smtp_user' => 'someuser@gmail.com',
            'smtp_pass' => 'password',
            'mailtype'  => 'html',
            'starttls'  => true,
            'newline'   => "\r\n"
        );

    $this->load->library('email', config);
    $this->email->from('email@gmail.com', 'George');
    $this->email->to('email@gmail.com');
    $this->email->subject('hey this is an email');
    $this->email->message('this is the content of the email');
    $this->email->send();
    echo $this->email->print_debugger(); 
```

希望这会奏效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:17:12.260

导致问题的行是：

```
$this->email->set_newline("/r/n"); 
```

删除它并尝试发送电子邮件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T19:14:17.990

我自己只是成功地做到了这一点，但是通过发送 config/email.php 中的所有值来代替。那部分应该无关紧要。

好吧，基本上你是想通过@gmail 帐户还是你自己的域发送？如果您尝试通过自己的域，则需要将 DNS 更改为相关的 google 设置：

[创建 MX 记录](http://support.google.com/a/bin/answer.py?hl=en&answer=140034)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-02T11:55:22.480

MAMP 不附带 openssl 扩展，但您可以自己创建它。有关详细信息，请参阅[本](http://jaspan.com/openssl-support-php-under-mamp)教程

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-15T07:35:08.097

首先使用标准 smtp 端口发布，并确保使用以下配置工作：

  函数索引（）{

        $config = Array( 'protocol' => 'smtp', 'smtp_host' => 'smtp.googlemail.com', 'smtp_port' => 25, 'smtp_user' => 'email', 'smtp_pass' => 'pass ');

        $this->load->library('email',$config);

        $this->email->from('email', 'George'); $this->email->to('email'); $this->email->subject('嘿，这是一封电子邮件'); $this->email->message('这是邮件内容');

        $this->email->send(); }

一旦你尝试过并且一切正常，请阅读以下内容：

[http://codeigniter.com/forums/viewthread/84689/](http://codeigniter.com/forums/viewthread/84689/)

# php - 加载器 gif 工具

> ID：10585909
> 
> 赞同：-1
> 
> 时间：2012-05-14T15:02:25.853
> 
> 标签：php, jquery

我在以这种形式实现加载器 gif 时遇到了一些问题，我的表单正在提交到另一个页面，即处理器页面。这是代码：

形式：

```
<form name="myform" id="myform" action="" method="POST">  
<!-- The Name form field -->
<div align='center'>

<form name="myform" id="myform" action="" method="POST">  
<!-- The Name form field -->
<font face='candara' size='3' color='#6382A1'>Ime ili prezime:</font>  
     <input type="text" name="name" id="name"  value=""> 
```

```
<meta http-equiv="Content-Type" content="text/html; charset=windows-1250" />
<script type="text/javascript" src="http://code.jquery.com/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="http://ajax.microsoft.com/ajax/jquery.validate/1.7/jquery.validate.min.js"></script>
 <script type="text/javascript">
$(document).ready(function(){
$("#myform").validate({
debug: false,
rules: {
name: "required",

},
messages: {
name: "Unesite podatke.",

},
submitHandler: function(form) {
// do other stuff for a valid form
$.post('process.php', $("#myform").serialize(), function(data) {
                                $('#results').html(data);
                            });
                        }
                    });
                });
                </script>
                <style>
label.error { width: 250px; display: inline; color: red; font-family:candara;}
                    </style>

                <!-- We will output the results from process.php here -->
                <br><div id="results"></div> 
```

所以我想知道在哪里以及如何实现加载器 gif 在搜索结果之前显示？

这是加载器 gif：

```
<!--LOADER!-->                              

<br><div id="loadingGif" style="display:none; background: url(slike_izgled/transparent_loader.png);" align="center"><img src='ajax-loader.gif'>
<br><font face='candara' size='3'><b>Pretražujem bazu podataka, molim pricekajte...</b></font></div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js"></script>

<script>

$("form").submit(function(e) {
//e.preventDefault();

$("#loadingGif").show();
});

</script>

                <!--LOADER END!--> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:06:48.430

在您的 submitHandler 使用`$.ajax`而不是`$.post`，您将能够使用 beforeSend

```
$.ajax({
    type : 'post',
    url : 'your url',
    data : 'your data',
    beforeSend : function(){
        $('#loadingGif').show();
    },
    success : function(data){
        $('#loadingGif').hide();
        // do your stuff here
    } 
```

});

# javascript - 在多个设备之间同步 JS 时间

> ID：10585910
> 
> 赞同：27
> 
> 时间：2012-05-14T15:02:27.013
> 
> 标签：javascript, time, synchronization

我正在使用美妙的[reveal.js](https://github.com/hakimel/reveal.js)库来创建HTML 幻灯片。我唯一的问题是我需要它在多个设备之间同步。

目前我正在从服务器向时间发出 AJAX 请求，并为页面保留一个内部时钟。

```
function syncTime() {
    // Set up our time object, synced by the HTTP DATE header
    // Fetch the page over JS to get just the headers
    console.log("syncing time")
    var r = new XMLHttpRequest();
    r.open('HEAD', document.location, false);
    r.send(null);
    var timestring = r.getResponseHeader("DATE");

    systemtime = new Date(timestring); // Set the time to the date sent from the server
} 
```

虽然这可以让我在 1 秒左右的准确度内获得准确率，但我需要做得更好。当幻灯片自动前进时，差异非常明显。

代码将在同一平台上运行，因此无需担心跨浏览器兼容性。

[这是我设法整理的内容](http://slide.s3-website-us-east-1.amazonaws.com/)

有任何想法吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-14T15:17:08.890

测量发送请求和返回响应之间经过的时间。然后，将该值除以 2。这为您提供了单向延迟的粗略值。如果将其添加到服务器的时间值中，您将更接近真实的服务器时间。

像这样的东西应该工作：

```
function syncTime() {
    // Set up our time object, synced by the HTTP DATE header
    // Fetch the page over JS to get just the headers
    console.log("syncing time")
    var r = new XMLHttpRequest();
    var start = (new Date).getTime();

    r.open('HEAD', document.location, false);
    r.onreadystatechange = function()
    {
        if (r.readyState != 4)
        {
            return;
        }
        var latency = (new Date).getTime() - start;
        var timestring = r.getResponseHeader("DATE");

        // Set the time to the **slightly old** date sent from the 
        // server, then adjust it to a good estimate of what the
        // server time is **right now**.
        systemtime = new Date(timestring);
        systemtime.setMilliseconds(systemtime.getMilliseconds() + (latency / 2))
    };
    r.send(null);
} 
```

*有趣*的是：John Resig 有一篇关于 Javascript 计时准确性的[好文章](http://ejohn.org/blog/accuracy-of-javascript-time/)。
在这种情况下，它不应该引起问题，因为您只关心您的时间会减少约 1 秒。15 毫秒的差异应该不会有太大影响。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-05-19T04:16:57.790

换一种方法怎么样：谁在乎时间？（你不会用 JavaScript 可靠地同步系统时钟。）

相反，当您的客户推进幻灯片放映时，请使用带有[socket.io的](http://socket.io)[Node](http://nodejs.org)服务器来同步。不是客户决定何时前进，而是服务器告诉他们前进。

这种方法带来了额外的好处，即能够在幻灯片运行时手动调整幻灯片。在下面的示例中，我添加了一个*Next*按钮，该按钮使所有连接的客户端立即前进到下一张幻灯片。

# 应用程序.js

```
var express = require('express')
    , app = express.createServer()
    , io = require('socket.io').listen(app)
    , doT = require('dot')
    , slide = 0
    , slides = [
        'http://placekitten.com/700/400?image=13',
        'http://placekitten.com/700/400?image=14',
        'http://placekitten.com/700/400?image=15',
        'http://placekitten.com/700/400?image=16',
        'http://placekitten.com/700/400?image=1',
        'http://placekitten.com/700/400?image=2',
        'http://placekitten.com/700/400?image=3',
        'http://placekitten.com/700/400?image=4',
        'http://placekitten.com/700/400?image=5',
        'http://placekitten.com/700/400?image=6',
        'http://placekitten.com/700/400?image=7',
        'http://placekitten.com/700/400?image=8',
        'http://placekitten.com/700/400?image=9',
        'http://placekitten.com/700/400?image=10',
        'http://placekitten.com/700/400?image=11',
        'http://placekitten.com/700/400?image=12',
    ];

app.listen(70); // listen on port 70

app.register('.html', doT); // use doT to render templates
app.set('view options', {layout:false}); // keep it simple
doT.templateSettings.strip=false; // don't strip line endings from template file

app.get('/', function(req, res) {
    res.render('index.html', { slide: slide, slides: slides });
});

app.post('/next', function(req, res) {
    next();
    res.send(204); // No Content
});

setInterval(next, 4000); // advance slides every 4 seconds

function next() {
    if (++slide >= slides.length) slide = 0;
    io.sockets.emit('slide', slide);
} 
```

# 意见/index.html

该文件被处理为一个[点](http://olado.github.com/doT/)模板。

```
<!DOCTYPE html>
<html>
<head>
<title>Synchronized Slideshow</title>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
var curslide = {{=it.slide}}; // the slide the server is currently on.

$(function() {
    $('#slide' + curslide).css('left',0);

    $('#next').click(function() {
        $.post('/next');
    });
});

var socket = io.connect('http://localhost:70');
socket.on('slide', function(slide) {
    $('#slide' + curslide).animate({left:-700}, 400);
    $('#slide' + slide).css('left',700).show().animate({left:0}, 400);
    curslide = slide;
});
</script>
<style>
#slideshow, .slide { width:700px; height:400px; overflow:hidden; position:relative; }
.slide { position:absolute; top:0px; left:700px; }
</style>
</head>
<body>
    <div id="slideshow">
        {{~it.slides :url:i}}
            <div id="slide{{=i}}" class="slide"><img src="{{=url}}"></div>
        {{~}}
    </div>
    <button id="next">Next &gt;</button>
</body>
</html> 
```

将这两个文件复制到一个文件夹中，然后运行

```
$ npm install express socket.io dot
$ node app.js 
```

并导航到`http://localhost:70`几个不同的窗口，然后看到魔术。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-08-14T15:57:29.073

很高兴您找到了满意的答案。我有类似的需要将浏览器与服务器的时钟同步，并决心像你一样以优于 1 秒的精度实现它。我已经编写了代码来执行此操作，并在此处发布此答案，以防其他人也需要该解决方案。

该代码称为[ServerDate](https://github.com/BallBearing/ServerDate)，可免费下载。这是自述文件的一部分。请注意，在我的示例中，我达到了 108 毫秒的精度：

您可以`ServerDate`像使用`Date`函数或其实例之一一样使用，例如：

```
> ServerDate()
"Mon Aug 13 2012 20:26:34 GMT-0300 (ART)"

> ServerDate.now()
1344900478753

> ServerDate.getMilliseconds()
22 
```

还有一种新方法可以获取 ServerDate 对服务器时钟的估计精度（以毫秒为单位）：

```
> ServerDate.toLocaleString() + " ± " + ServerDate.getPrecision() + " ms"
"Tue Aug 14 01:01:49 2012 ± 108 ms" 
```

您可以看到服务器时钟和浏览器时钟之间的差异，以毫秒为单位：

```
> ServerDate - new Date()
39 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-19T12:20:38.770

我在这里为我的实时 Web 应用程序广泛使用 COMET 模式。

要在您的情况下使用它，您需要客户端向服务器打开 AJAX 请求并等待答案。客户必须尽快更换幻灯片。

在服务器上，您必须保留所有答案，直到需要更换幻灯片。（您可以更先进，之后每次在客户端上延迟相同的时间，但这很可能没有必要）。我无法在这里向您展示示例代码，因为我不知道您可以使用什么。

因此，您实际上是在创建一个管弦乐队，其中服务器播放指挥，所有客户端都在听他。

然后，时间由服务器在（几乎）同时响应请求的能力加上网络延迟来确定。
通常客户端应该位于网络的同一部分，因此延迟可能非常相似 - 绝对值在这里不会受到伤害，只有变化。

并且可能还有一个额外的技巧可以帮助：不要用硬替换来改变幻灯片，混合它们。这将使变化模糊，使眼睛无法捕捉到您将始终拥有的微小时间差异。

（如果您不能让服务器播放指挥，您可能不得不使用 MikeWyatt 的解决方案 - 可能有几个请求并平均结果，具体取决于网络设置。在 LAN 中，一个请求可能就足够了，去在整个互联网上，平均水平有点过分不会受到伤害......）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T23:14:49.710

您无法真正与服务器同步。测量服务器请求所需的时间（如 MikeWyatt 建议的那样）并不是延迟的一个很好的指标。

只有您的服务器知道他何时响应请求。因此，它应该将该信息连同答案一起发回。`Date.now() - new Date(timestringOfServerResponse)`您可以准确地测量延迟。但是我不确定您为什么需要该值。

要在多个设备之间同步应用程序，服务器应向它们发送何时执行哪个操作。“何时”不应该是“一旦你得到我的回复”，而是一个确切的时间戳。只要设备的系统时钟准确且同步（通常是这样），应用程序将同步运行其方法，因为它知道何时发生（或至少：那时应该发生什么，并且它可以插入什么“现在”发生）。

# java - 从与 jar 文件相同的目录加载文件

> ID：10585911
> 
> 赞同：2
> 
> 时间：2012-05-14T15:02:27.440
> 
> 标签：java

我正在使用 log4j 进行日志记录。为了配置一切，我在 jar 文件之外创建了一个 log4j.xml。它工作得很好，但是当 jar 文件不是从 log4j.xml 所在的同一目录执行时会出现问题。

示例：jar 文件位于 /opt/myapp/test.jar

```
user@host:/opt/myapp$ java -jar test.jar 
```

效果很好，但是当我尝试这个时：

```
user@host:~$ java -jar /opt/myapp/test.jar 
```

我收到一个找不到 log4j.xml 的错误。那是因为它正在我当前的工作目录中寻找它。

我还有一个在我的应用程序中使用的属性文件。该文件位于 jar 文件所在的 config/ 目录中，因此在此示例中为 /opt/myapp/config。尝试加载配置文件时会出现与上述相同的问题。

**如何让 Java 从 jar 文件所在的目录加载文件（无论从哪里执行 jar）？**

可能很容易，但我无法弄清楚:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:08:51.920

您需要使用命令行参数 -Dlog4j.configuration=/path/to/file 传递文件。

如果您需要更多选项，请查看[手册。](http://logging.apache.org/log4j/1.2/manual.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:12:00.917

最可靠的方法是询问 JVM 给定类的字节码来自哪里。

有关此代码段，请参见[http://www.exampledepot.com/egs/java.lang/ClassOrigin.html ：](http://www.exampledepot.com/egs/java.lang/ClassOrigin.html)

```
// Get the location of this class
Class cls = this.getClass();
ProtectionDomain pDomain = cls.getProtectionDomain();
CodeSource cSource = pDomain.getCodeSource();
URL loc = cSource.getLocation();  // file:/c:/almanac14/examples/ 
```

从 JAR 中加载时，您需要进行更多的后期处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:12:49.130

从[类文件中](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getProtectionDomain%28%29)查看[ProtectionDomain](http://docs.oracle.com/javase/6/docs/api/java/security/ProtectionDomain.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:13:54.153

尝试：

```
java cp /opt/myapp/someohter.jar -jar /opt/myapp/test.jar 
```

使用属性来指定你自己，在哪里寻找配置文件，资源等等（正如保罗指出的那样）。

将此类文件放在 jar.file 附近并根据您从哪里开始执行通常是一个坏主意。通常，安装应用程序的目录（jar）对用户是写保护的，但配置文件是可编辑的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T15:16:21.593

1.  使用 log4j 系统属性指定，在命令的“-jar”部分之前添加：-Dlog4j.configuration=/opt/myapp/log4j.xml

2.  将目录添加到类路径中，在命令的“-jar”部分之前添加：

    -cp /opt/myapp/

3.  您可以在代码中手动指定 log4j.xml 文件，然后相对于您的 jar 文件引用它。

    *   执行以下操作来查找文件： [从放置 jar 文件的特定目录中获取文件](https://stackoverflow.com/questions/6247845/fetch-file-from-specific-directory-where-jar-file-is-placed)
    *   并配置 log4j：

    字符串路径 = ... ; PropertyConfigurator.configure(路径);

# sql-server - SQL Server Management Studio“查看依赖项”的替代方案

> ID：10585912
> 
> 赞同：6
> 
> 时间：2012-05-14T15:02:27.477
> 
> 标签：sql-server, ssms

我早就知道 SQL Server Management Studio 中的“查看依赖项”功能几乎没有用处，因为它几乎不会返回所有依赖项，但是，有更好的选择吗？出于显而易见的原因，这是一个非常强大的功能，但是如果您不能依赖结果（就像 Microsoft 的情况一样），您无论如何都必须手动完成所有工作，以确保安全。

看起来这很容易实现，是否有任何工具可以有效地处理这个问题？

作为旁注，有人知道“查看依赖项”有什么问题吗？是否存在难以识别的特定依赖类别？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-28T08:29:35.820

迟到但希望有用，因为推荐的工具是免费的……</p>

我正在使用与大卫推荐的工具类似的工具[——ApexSQL 搜索](http://www.apexsql.com/sql_tools_search.aspx)。他们声称拥有自己的依赖跟踪机制，适用于除动态 SQL 之外的所有内容。

我还没有详细测试它来确认这一点……

免责声明：我不隶属于这家公司，但我确实经常使用他们的工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:03:45.860

Red Gate 有一个名为[SQL Dependency Tracker](http://www.red-gate.com/products/SQL_Dependency_Tracker/index.htm)的工具，效果很好。

您还可以针对 sys.sql_dependencies 视图编写一个查询，该视图将提供一些基本信息。与此类似：

```
SELECT o.name, o.type_desc, p.name, p.type_desc
FROM sys.sql_dependencies d
INNER JOIN sys.objects o
    ON d.object_id = o.object_id
INNER JOIN sys.objects p
    ON d.referenced_major_id = p.object_id 
```

这是一篇关于查找依赖项的文章：

[在 SQL Server 2005 中查找依赖项](http://www.techrepublic.com/blog/datacenter/finding-dependencies-in-sql-server-2005/277)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T15:17:56.867

您可以尝试使用 SQL Search，它对对象名称和文本定义进行文本搜索。优点是它还会拾取动态 SQL 引用，缺点是它可能会拾取误报，因为它不是基于真正的依赖树进行搜索。

[http://www.red-gate.com/products/sql-development/sql-search/](http://www.red-gate.com/products/sql-development/sql-search/)

另一个优点是它目前是免费的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-12T21:01:25.340

这是一个三步过程。仍然不完美，但有助于消除一些差距。假设您正在查找表“WidgetUser”的依赖项：

首先，获取可能引用该表的所有模块的列表。将查询结果输出为文本：

```
select 'EXEC sys.sp_refreshsqlmodule ''dbo.' + OBJECT_NAME(m.object_id) + ''''
from sys.sql_modules m
where m.definition like '%WidgetUser%' 
```

接下来，粘贴该输出文本并运行更新。这将是这样的：

```
EXEC sys.sp_refreshsqlmodule 'dbo.up_WidgetUser_Select'
EXEC sys.sp_refreshsqlmodule 'dbo.up_WidgetUser_Update'
EXEC sys.sp_refreshsqlmodule 'dbo.WidgetUserView'
EXEC sys.sp_refreshsqlmodule 'dbo.ufx_WidgetUser_Fooinize'
... 
```

现在您的依赖项是最新的，运行`sp_depends`：

```
EXEC sp_depends @objname = N'dbo.WidgetUser' 
```

# http - 如何在 Apache Tomcat 的 HTTP 响应标头中获取服务器信息

> ID：10585913
> 
> 赞同：0
> 
> 时间：2012-05-14T15:02:37.603
> 
> 标签：http, tomcat, httpresponse

我们在负载均衡器后面有 n 台服务器。当一个 http 请求进来时，它通过循环方法路由到其中一个服务器。我的问题是，有什么方法可以在 http 响应中发送服务器信息（请求被定向到的服务器）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T22:06:00.833

如果您有所需的信息（IP 地址？服务器的一些友好名称？），您可以使用 response.setHeader("Backend-Machine", "ServerName") 轻松设置标头。

真正的问题是如何获取这些信息。大多数服务器都有多个 NIC，这意味着您不能随机选择一个并返回 IP 地址（您可能会得到 127.0.0.1，这对任何人都没有帮助）。如果这对您很重要，我建议在 JVM 启动时设置一个系统属性，其中包含您认为标识服务器的任何字符串。然后，编写一个过滤器，将该字符串添加到每个响应中。

# c# - 在datalist中的asp.net中重写url

> ID：10585914
> 
> 赞同：1
> 
> 时间：2012-05-14T15:02:39.753
> 
> 标签：c#, asp.net, url-rewriting

所以我有一种情况，我想在 asp.net Web 应用程序中添加 url 重写。场景是我有一个数据列表，其中显示了不同的国家/地区名称，例如印度、巴基斯坦、美国、澳大利亚、中国等。现在，当用户单击这些链接中的任何一个时，我会在查询字符串中发送一个国家/地区 ID。这看起来很难看，也不利于 SEO。所以现在我被困住了。我在 youtube 上试过，但对 asp.net 没有太多帮助。

任何人都可以指导我在 asp.net 中添加 url 重写的一些分步教程。

我会很感激的。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:00:54.160

.net 3.5 sp 1 [http://msdn.microsoft.com/en-us/magazine/dd347546.aspx](http://msdn.microsoft.com/en-us/magazine/dd347546.aspx)

.net 4 [http://weblogs.asp.net/scottgu/archive/2009/10/13/url-routing-with-asp-net-4-web-forms-vs-2010-and-net-4-0 -series.aspx](http://weblogs.asp.net/scottgu/archive/2009/10/13/url-routing-with-asp-net-4-web-forms-vs-2010-and-net-4-0-series.aspx)

# ruby - 为 github PROJECT 页面配置 Jekyll

> ID：10585916
> 
> 赞同：12
> 
> 时间：2012-05-14T15:02:50.367
> 
> 标签：ruby, github, jekyll, github-pages

我在这里束手无策。我一直在尝试查看我能找到的所有其他示例 github 项目页面，甚至是博客，但没有一个显示出我遇到的问题。首先，我正在尝试为我的仓库创建一个项目页面。我通过遵循通常的教程来做到这一点，在我的项目 repo 中创建一个 gh-pages 分支并推送。

我设法做到了这些并模板化了我的文件。我什至设法使用了 HAML 和 SASS（它们仍然都转换为 html/css，这就是我推送到 repo 的内容，所以那里没有问题）。我只是认为我配置我的 jekyll 错误。首先，我在其他人的页面中没有看到任何使用 config.yml 上的 baseurl 或 url 的配置。

我的问题是循环浏览我的帖子时：

```
{% for post in site.posts %}
  <a href="{{ post.url }}">{{ post.title }}</a>
{% endfor %} 
```

它总是将 href 生成为`href="/post-title"`

我的`_config.yml`顺便说一句只有这个：

```
permalink: /exercises/:title 
```

当我单击链接时，这个问题总是指向[http://corroded.github.com/exercises/title-here](http://corroded.github.com/exercises/title-here)，而实际上它应该是[http://corroded.github.com/projectname/exercises/title-这里](http://corroded.github.com/projectname/exercises/title-here)

我实际上已经尝试通过以下方式对路径进行硬编码：

`<a href="http://corroded.github.com{{ post.url }}">`这有效。它转到帖子但它显示为纯文本而不是生成的html。我知道我在这里遗漏了一些非常简单的东西，但我似乎找不到它，整个周末我都在为此苦苦挣扎。

哦，我忘了补充：在我的本地主机中执行此操作，我可以在以下位置访问所有内容：

`http://localhost:4000/`并单击链接将让我进入`http://localhost:4000/exercises/title-here`它的工作原理。所以我有一个很好的猜测，它与配置有关。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-06-05T03:07:00.543

编辑：此答案已添加到[http://jekyllrb.com/docs/github-pages/](http://jekyllrb.com/docs/github-pages/)的 Jekyll 文档中。

* * *

如果您正在寻找具有 GitHub Pages ( `username.github.io/project-name/`) 标准 URL 的解决方案，我终于找到了诀窍。这是做什么：

在`_config.yml`中，将`baseurl`选项设置为`/project-name`-- 注意前导斜杠和**没有**尾随斜杠。

现在，您需要通过以下两种方式更改在模板和帖子中创建链接的方式：

引用 JS 或 CSS 文件时，请这样做：`{{ site.baseurl }}/path/to/css.css`-- 注意紧跟在变量后面的斜杠（就在“路径”之前）。

在做永久链接或内部链接时，请这样做：`{{ site.baseurl }}{{ post.url }}`-- 请注意，两个变量之间**没有斜线。**

最后，如果您想在使用 提交/部署之前预览您的站点`jekyll serve`，请务必将一个**空字符串**传递给该`--baseurl`选项，以便您可以`localhost:4000`正常查看所有内容（无需`/project-name`进入那里将所有内容搞砸）：`jekyll serve --baseurl ''`

通过这种方式，您可以从 localhost 上的站点根目录在本地预览您的站点，但是当 GitHub 从 gh-pages 分支生成您的页面时，所有 URL 都将以正确开头`/project-name`并正确解析。

关于[issue #332](https://github.com/mojombo/jekyll/issues/332)的更多讨论。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-14T19:02:27.027

当您的永久链接前面有一个斜杠时，这意味着所有 URL 都应该是相对于站点根目录的。这就是它要`http://corroded.github.com/exercises/title-here`代替的原因`http://corroded.github.com/projectname/exercises/title-here`。尝试不使用第一个斜线：

```
permalink: exercises/:title 
```

使用 HTML 创建的任何 URL 也是如此。如果你有：

```
<a href="/about"> 
```

它总是会转到域的根目录（例如`http://corroded.github.com/about`）。如果您的项目名为“projectname”，则可以使用 HTML 之类的

```
<a href="/projectname/about"> 
```

直接链接到页面（例如`http://corroded.github.com/projectname/about`）。

当然，您也可以使用[相对 URL](http://www.webreference.com/html/tutorial2/3.html)（即没有前导斜杠的 URL）。您只需要知道您在目录树中的位置。

# ios - 是否有回调/代表告诉设备在离线后重新连接（到运营商服务或 wifi）？

> ID：10585917
> 
> 赞同：0
> 
> 时间：2012-05-14T15:02:51.863
> 
> 标签：ios, iphone, networking, wifi, detect

假设设备离线，没有服务，也没有 WiFi 开始，是否有回调/委托来告诉设备在服务或 WiFi 可用后重新连接？还是我们必须主动拉状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:07:22.983

您可以使用[Rechability](https://developer.apple.com/library/ios/#samplecode/Reachability/index.html)类检查它：

> Reachability 示例应用程序演示了如何使用 SystemConfiguration 框架来监视 iPhone 或 iPod touch 的网络状态。特别是，它演示了如何知道何时可以路由 IP，以及何时通过无线广域网 (WWAN) 接口（如 EDGE 或 3G）路由流量。

这是一个[例子](https://stackoverflow.com/questions/1861656/iphone-reachability-checking)

# ios - Restlets 的 iOS 客户端

> ID：10585925
> 
> 赞同：0
> 
> 时间：2012-05-14T15:03:12.110
> 
> 标签：ios, restlet

我们喜欢 Restlets 的 RESTful Web 服务方法，它的 Android 客户端库运行良好。我们还知道，Ruby on Rails 有极好的 REST 客户端 API，我们期待网上有人提出了一个 REST 客户端，它与 iOS 上的 Rails API 一样好，并且与 Restlets 兼容，就像它的 Android 库一样。有人遇到过吗？

# c++ - VC2010 的静态初始化线程安全吗？

> ID：10585928
> 
> 赞同：10
> 
> 时间：2012-05-14T15:03:21.490
> 
> 标签：c++, multithreading, visual-c++, thread-safety, c++11

我一直在 SO 和 MSDN 上寻找这个问题的答案，但似乎找不到明确和最终的答案......

我知道它在 C++11 标准中并且当前 GCC 版本的行为方式是这样的，但是 VC2010 目前是否保证局部静态变量初始化的线程安全？

即：这对VC2010来说是线程安全的吗？

```
 static S& getInstance()
    {
        static S instance;
        return instance;
    } 
```

...如果不是，那么使用 VC2010 在 C++ 中获得线程安全单例实现的当前最佳实践是什么？

**编辑：正如 Chris Betti 的回答所指出的，VC2010 没有实现局部静态变量 init 的线程安全性。**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-14T15:09:35.327

来自 Visual Studio 2010[关于 Static 的文档](http://msdn.microsoft.com/en-us/library/s1sb61xd.aspx)：

> 在多线程应用程序中为静态局部变量赋值不是线程安全的，我们不建议将其作为编程实践。

您问题的第二部分有[一些很好的现有答案](https://stackoverflow.com/questions/6915/thread-safe-lazy-construction-of-a-singleton-in-c)。

2015 年 11 月 22 日更新：

其他人已经特别验证了静态初始化也不是线程安全的（参见评论和其他答案）。

VS2015 上的用户抱怨：

> 您可能想补充一点，VS2015 终于做到了：[https](https://msdn.microsoft.com/en-au/library/hh567368.aspx#concurrencytable) ://msdn.microsoft.com/en-au/library/hh567368.aspx#concurrencytable ("Magic statics")

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-21T01:32:36.420

以下代码片段显示“本地范围的静态对象初始化”不是线程安全的：

```
#include <windows.h>
#include <stdio.h>
#include <process.h>
struct X {
    ~X() { puts("~X()"); }
    int i_ ;
    void print(void) {
        printf("thread id=%u, i = %d\n", GetCurrentThreadId(), i_);
    }
    X(int i) {
        puts("begin to sleep 10 seconds");
        Sleep(1000 * 10);
        i_ = i;
        printf("X(int) i = %d\n", i_);
        puts("end");
    }
};

X & getX()
{
    static X static_x(1000);
    return static_x;
}

void thread_proc(void *)
{
    X & x = getX();
    x.print();
}

int main(int argc, char *argv[])
{
    HANDLE all_threads[2] = {};
    all_threads[0] = HANDLE( _beginthread(thread_proc, 0, 0) );
    printf("First thread Id: %u\n", GetThreadId(all_threads[0]) );
    Sleep(1000);
    all_threads[1] = HANDLE( _beginthread(thread_proc, 0, 0) );
    printf("Second thread Id: %u\n", GetThreadId(all_threads[1]) );
    WaitForMultipleObjects( _countof(all_threads), all_threads, TRUE, 1000 * 20);
    puts("main exit");
    return 0;
} 
```

输出将是（当然线程 ID 在您的机器上会有所不同）：

```
First thread Id: 20104
begin to sleep 10 seconds
Second thread Id: 20248
thread id=20248, i = 0
X(int) i = 4247392
end
thread id=20104, i = 1000
main exit
~X() 
```

在第一个线程返回之前，这意味着单例的ctor被调用并返回，第二个线程获取未初始化的对象并调用它的成员方法（因为静态对象在BSS段中，加载程序加载后它将被初始化为零可执行文件）并得到错误的值：0。

通过 /FAsc /Fastatic.asm 打开汇编列表将获得函数 getX() 的汇编代码：

```
01:  ?getX@@YAAAUX@@XZ PROC                 ; getX
02:  
03:  ; 20   : {
04:  
05:    00000    55       push    ebp
06:    00001    8b ec        mov     ebp, esp
07:  
08:  ; 21   :   static X static_x(1000);
09:  
10:    00003    a1 00 00 00 00   mov     eax, DWORD PTR ?$S1@?1??getX@@YAAAUX@@XZ@4IA
11:    00008    83 e0 01     and     eax, 1
12:    0000b    75 2b        jne     SHORT $LN1@getX
13:    0000d    8b 0d 00 00 00
14:     00       mov     ecx, DWORD PTR ?$S1@?1??getX@@YAAAUX@@XZ@4IA
15:    00013    83 c9 01     or  ecx, 1
16:    00016    89 0d 00 00 00
17:     00       mov     DWORD PTR ?$S1@?1??getX@@YAAAUX@@XZ@4IA, ecx
18:    0001c    68 e8 03 00 00   push    1000           ; 000003e8H
19:    00021    b9 00 00 00 00   mov     ecx, OFFSET ?static_x@?1??getX@@YAAAUX@@XZ@4U2@A
20:    00026    e8 00 00 00 00   call    ??0X@@QAE@H@Z      ; X::X
21:    0002b    68 00 00 00 00   push    OFFSET ??__Fstatic_x@?1??getX@@YAAAUX@@XZ@YAXXZ ; `getX'::`2'::`dynamic atexit destructor for 'static_x''
22:    00030    e8 00 00 00 00   call    _atexit
23:    00035    83 c4 04     add     esp, 4
24:  $LN1@getX:
25:  
26:  ; 22   :   return static_x;
27:  
28:    00038    b8 00 00 00 00   mov     eax, OFFSET ?static_x@?1??getX@@YAAAUX@@XZ@4U2@A
29:  
30:  ; 23   : } 
```

在第 10 行，神秘符号 [?$S1@?1??getX@@YAAAUX@@XZ@4IA] 是全局指示符（也在 BSS 中），它标记单例是否被连接，它将被标记为 true在第 14-17 行，就在调用 ctor 之前，这就是问题所在，这也解释了为什么第二个线程立即获得未初始化的单例对象并愉快地调用它的成员函数。编译器没有插入与线程安全相关的代码。

# python - SQLAlchemy IntegrityError 和批量数据导入

> ID：10585941
> 
> 赞同：10
> 
> 时间：2012-05-14T15:04:08.477
> 
> 标签：python, sqlalchemy

我将几条 10k 记录插入到具有 REF 完整性规则的数据库中。不幸的是，一些数据行是重复的（因为它们已经存在于数据库中）。在插入数据库之前检查数据库中每一行的存在成本太高了，所以我打算继续处理 SQLAlchemy 抛出的 IntegrityError 异常，记录错误然后继续。

我的代码将如下所示：

```
# establish connection to db etc.

tbl = obtain_binding_to_sqlalchemy_orm()
datarows = load_rows_to_import()

try:
    conn.execute(tbl.insert(), datarows)
except IntegrityError as ie:
    # eat error and keep going
except Exception as e:
    # do something else 
```

我在上面所做的（隐式）假设是 SQLAlchemy 没有将多个插入滚动到一个事务中。如果我的假设是错误的，那么这意味着如果发生 IntegrityError，则插入的其余部分将被中止。任何人都可以确认上面的伪代码“模式”是否会按预期工作 - 或者我是否会由于抛出 IntegrityError 异常而最终丢失数据？

另外，如果有人对此有更好的想法，我会很感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:46:38.063

如果您之前没有启动任何事务，它可能会像这样工作，因为在这种情况下 sqlalchemy 的[自动提交功能](http://docs.sqlalchemy.org/en/rel_0_7/core/connections.html#understanding-autocommit)将启动。但您应该按照链接中的描述显式设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-21T14:44:35.313

我在解析 ASCII 数据文件以将数据导入表时也遇到了这个问题。问题是我本能地和直觉地希望 SQLAlchemy 在允许唯一数据的同时跳过重复的行。或者，由于当前的 SQL 引擎，例如不允许使用 unicode 字符串，可能会引发随机错误。

但是，这种行为超出了 SQL 接口的定义范围。SQL API，因此 SQLAlchemy 只理解事务和提交，而不考虑这种选择性行为。此外，依赖自动提交功能听起来很危险，因为插入会在异常发生后停止，留下其余数据。

我的解决方案（我不确定它是否是最优雅的）是处理循环中的每一行，捕获并记录异常，并在最后提交更改。

假设您以某种方式获取列表列表中的数据，即作为列值列表的行列表。然后你在一个循环中读取每一行：

```
# Python 3.5
from sqlalchemy import Table, create_engine
import logging

# Create the engine
# Create the table
# Parse the data file and save data in `rows`

conn = engine.connect() 
trans = conn.begin() # Disables autocommit

exceptions = {}
totalRows = 0
importedRows = 0

ins = table.insert()

for currentRowIdx, cols in enumerate(rows):
    try:
        conn.execute(ins.values(cols)) # try to insert the column values
        importedRows += 1

    except Exception as e:
        exc_name = type(e).__name__ # save the exception name
        if not exc_name in exceptions:
            exceptions[exc_name] = []
        exceptions[exc_name].append(currentRowIdx)

    totalRows += 1

for key, val in exceptions.items():
    logging.warning("%d out of %d lines were not imported due to %s."%(len(val), totalRows, key))

logging.info("%d rows were imported."%(importedRows))

trans.commit() # Commit at the very end
conn.close() 
```

为了最大限度地提高此操作的速度，您应该禁用自动提交。我将此代码与 SQLite 一起使用，它仍然比我使用 only 的旧版本慢 3-5 倍`sqlite3`，即使禁用了自动提交。（我移植到 SQLAlchemy 的原因是能够将它与 MySQL 一起使用。）

它不是最优雅的解决方案，因为它不如 SQLite 的直接接口快。如果我分析代码并在不久的将来找到瓶颈，我将用解决方案更新这个答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-08T03:09:51.113

几乎没有办法告诉 sql 引擎做一个`bulk insert on duplicate ignore`动作。但是，我们可以尝试在 python 端做一个后备解决方案。如果您的副本没有以非常糟糕的方式分发*，那么这几乎可以同时获得两全其美的好处。

```
try:
    # by very bad, I mean what if each batch of the items contains one duplicate
    session.bulk_insert_mappings(mapper, items)
    session.commit()
except IntegrityError:
    logger.info("bulk inserting rows failed, fallback to one by one")
    for item in items:
        try:
            session.execute(insert(mapper).values(**item))
            session.commit()
        except SQLAlchemyError:
            logger.exception("Error inserting item: %s", item) 
```

# actionscript-3 - 在网站首次加载时延迟加载外部 swf (GAIA)

> ID：10585943
> 
> 赞同：1
> 
> 时间：2012-05-14T15:04:11.820
> 
> 标签：actionscript-3, gaia

我正在使用 Gaia Framework (AS3) 来构建我的第一个 flash 网站。

我有一个已放置在 index.fla 上的动画背景，并且我的页面内容作为 index.fla 顶部的外部 swf 加载。

我的问题是我的初始动画序列持续大约 10 秒，我想延迟主页加载直到动画序列完成（现在它只是加载在动画之上）。动画播放一次，因此页面加载延迟应该仅在站点第一次加载或刷新站点时发生。

请让我如何实现这种延迟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:06:21.080

我不熟悉盖亚，但是，你想要完成的并不难。使用香草 AS3 和[Timer](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/Timer.html)类。

```
var delayTimer:Timer = new Timer(10000, 1); // these are in milliseconds.
delayTimer.addEventListener(TimerEvent.TIMER, foo);
delayTimer.start()

function foo(e:Event):void {
   // Do your stuff to load everything else.
} 
```

总而言之，您创建一个计时器，为倒计时结束添加一个侦听器，`foo`并在等待后启动您想要执行的其余加载。

# c# - DataRepeater 控件共享选定索引上的 ComboBox

> ID：10585944
> 
> 赞同：3
> 
> 时间：2012-05-14T15:04:11.647
> 
> 标签：c#, winforms, data-binding, combobox, datarepeater

我有一个使用组合框的每一行的数据转发器。当您单击 Add 按钮时，它会向 DataRepeater 添加一个新行。

```
 public enum ColorTypes {Red, Green, Yellow}
   class LineItem
   {
       public ColorTypes Color {get;set;} 
   } 
```

当您单击表单上的按钮时，它会创建一个新的 LineItem 并重新绑定。

```
 private void btnAdd_Click(object sender, EventArgs e)
  {
       LineItem CopyItem = new LineItem();
       CurrentList= ((List<LineItem>)dataRepeater.DataSource); 

       CurrentList.Add(CopyItem);
       dataRepeater.DataSource = CurrentList;
  } 
```

这会正确地将新行添加到 DataRepeater，但现在更改组合框的索引会修改这两行。您需要执行一些特殊的绑定吗？

这是我的绑定代码：

```
 this.cbPackage.DataSource = System.Enum.GetValues(typeof(ColorTypes));
 this.cbPackage.DisplayMember = "Color"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:49:20.587

经过大量搜索和整理后，您可以完成此任务！为了在 DataRepeater 中正确使用组合框，您需要添加以下事件。

```
this.dataForm.ItemCloned += new Microsoft.VisualBasic.PowerPacks.DataRepeaterItemEventHandler(dataForm_ItemCloned);
this.dataForm.DrawItem += new Microsoft.VisualBasic.PowerPacks.DataRepeaterItemEventHandler(dataForm_DrawItem);
this.cbPackage.SelectedIndexChanged += new System.EventHandler(cbColor_SelectedIndexChanged); 
```

[MSDN ItemCloned](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.powerpacks.datarepeater.itemcloned%28v=vs.80%29.aspx "物品克隆")

[MSDN 绘图项](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.powerpacks.datarepeater.drawitem.aspx "MSDN 绘图项")

现在，当调用 ItemCloned 事件时，您需要找到组合框控件并手动映射数据源（这可以防止下拉菜单使用相同的源并共享相同的选定索引）

```
 void dataForm_ItemCloned(object sender,                Microsoft.VisualBasic.PowerPacks.DataRepeaterItemEventArgs e)
    {
        var combo = (ComboBox)e.DataRepeaterItem.Controls.Find("cbColor", false)[0];
        //Set the data source
        Combo.DataSource = System.Enum.GetValues(typeof(DataRepeater.ColorTypes));
    } 
```

如果您的数据在添加行上发生更改，或者您需要重新绘制中继器，则组合框索引将设置为空。所以要修复它，在项目模板完成后，您将不得不在绘制时重置选定的索引。

```
 /// <summary>
    /// After Item is cloned, draw item. The index is now available to select the proper data
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    void dataForm_DrawItem(object sender, Microsoft.VisualBasic.PowerPacks.DataRepeaterItemEventArgs e)
    {
        var dataRepeater = (Microsoft.VisualBasic.PowerPacks.DataRepeater)sender;
        var combo = (ComboBox)e.DataRepeaterItem.Controls.Find("cbPackage", false)[0];
        //Set the selected item based of the list item index
        Combo.SelectedItem = ((List<LineItem>)DataRepeater.DataSource)[e.DataRepeaterItem.ItemIndex].PackageType;  
    } 
```

最后，当您更改下拉列表的值时，会出现最后一个问题。数据源不会自动更新。所以现在您需要根据组合框的索引手动更新源。

```
 void cbPackage_SelectedIndexChanged(object sender, System.EventArgs e)
    {
        var combo = (ComboBox)sender;
        var dataRepeaterItem = (Microsoft.VisualBasic.PowerPacks.DataRepeaterItem)combo.Parent;
        var dataRepeater = (Microsoft.VisualBasic.PowerPacks.DataRepeater)combo.Parent.Parent;
        var source = ((List<ColorData>)DataRepeater.DataSource)[DataRepeaterItem.ItemIndex];
        source.PackageType = (DropData)combo.SelectedValue;        
    } 
```

哇... 好了，一切都应该准备好了。

# java - 如何从文件夹结构中获取文件列表

> ID：10585951
> 
> 赞同：0
> 
> 时间：2012-05-14T15:04:30.210
> 
> 标签：java, file, compiler-construction

我正在创建一个将编译 java 文件的程序，目前我让该程序在一个特定文件夹中一次编译多个文件。但我想要它做的是在给定文件夹开始的情况下编译文件夹结构中的所有文件（例如，如果给定以下地址`C:/files_to_be_compiled`，您能否搜索此文件夹中的所有文件夹以获取所有 .class 文件的列表）。我有这段代码`.class`从一个文件夹中获取所有文件，但我需要扩展它以`.class`从给定文件夹中的所有其余文件夹中获取所有文件

```
 String files;
        File folder = new File("C:/files_to_compile");
        File[] listOfFiles = folder.listFiles();
        {

            for (int i = 0; i < listOfFiles.length; i++) {

                if (listOfFiles[i].isFile()) {
                    files = listOfFiles[i].getName();
                    if (files.endsWith(".class") || files.endsWith(".CLASS")) {
                        System.out.println(files);
                    }
                }
            }
        } 
```

我将如何扩展上面的代码从给定文件夹的所有文件夹中获取所有 .class 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:08:45.967

也许有点像

```
void analyze(File folder){
    String files;        
    File[] listOfFiles = folder.listFiles();
    {

        for (int i = 0; i < listOfFiles.length; i++) {

            if (listOfFiles[i].isFile()) {
                files = listOfFiles[i].getName();
                if (files.endsWith(".class") || files.endsWith(".CLASS")) {
                    System.out.println(files);
                }
            } else if (listOfFiles[i].isDirectory()){
                analyze(listOfFiles[i]);
        }
    }
 }

void start(){
    File folder = new File("C:/files_to_compile");
    analyze(folder);
} 
```

这样，您就可以递归地分析您的结构（深度优先搜索）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:24:23.400

```
public static void listFilesForFolder(String path)
{
    File folder = new File(path);
    File[] files = folder.listFiles();
    for(File file : files)
    {
        if (file.isDirectory()){
            listFilesForFolder(file.getAbsolutePath());
        }
        else if (file.isFile())
        {
            // your code goes here
        }
    }
}

// run
listFilesForFolder("C:/files_to_compile"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:07:56.880

[这个答案](https://stackoverflow.com/a/1846349/339852)可能对你有用。

**从链接答案中借用的示例代码：**

```
public void listFilesForFolder(final File folder) {
    for (final File fileEntry : folder.listFiles()) {
        if (fileEntry.isDirectory()) {
            listFilesForFolder(fileEntry);
        } else {
            System.out.println(fileEntry.getName());
        }
    }
}

final File folder = new File("/home/you/Desktop");
listFilesForFolder(folder); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:16:44.790

您可以使用Apache Commons 中的[DirectoryWalker](http://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/DirectoryWalker.html)遍历目录层次结构并应用过滤器 - `FileFilterUtils.suffixFileFilter(".class")`. 例如：

```
public class ClassFileWalker extends DirectoryWalker {
    public ClassFileWalker() {
        super(FileFilterUtils.directoryFileFilter(), 
                FileFilterUtils.suffixFileFilter(".class"), -1);
    }

    protected void handleFile(File file, int depth, Collection results) {
        if(file.isFile())
            results.add(file);
    }

    public List<File> getFiles(String location) {
        List<File> files = Lists.newArrayList();
        try {
            walk(new File(location), files);
        } catch (IOException e) {
            e.printStackTrace();
        }
        return files;
    }
} 
```

然后像这样使用它：

```
ClassFileWalker walker = new ClassFileWalker();
List<File> files = walker.getFiles("C:/files_to_be_compiled"); 
```

# cocoa-touch - 我如何选择 NSThread 而不是 NSTimer？

> ID：10585954
> 
> 赞同：1
> 
> 时间：2012-05-14T15:04:42.827
> 
> 标签：cocoa-touch, nstimer, nsthread

换句话说，如果我有一个持续运行的进程，但用户可以在 GUI 上更改影响进程操作特性的参数，那么将进程放在哪里更好`NSThread`？`NSTimer`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:11:47.353

NSThread 和 NSTimer 不是相互排斥的，也不是相互替代的。NSThread 允许您控制执行线程，而 NSTimer 就是一个计时器。

我假设您的意思是在后台线程而不是在主线程上运行 NSTimer？这通常是一个好主意，这样计时器就不太可能被主线程上发生的事情（例如用户与应用程序的交互）延迟。

您应该阅读[Apple 的线程编程指南](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Multithreading/Introduction/Introduction.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:30:35.040

虽然[`NSThread`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsthread_Class/Reference/Reference.html)和[`NSTimer`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nstimer_Class/Reference/NSTimer.html)是针对不同需求的两个独立事物，但让我们比较这两个功能：

使用`NSThread`：

```
-(void) doSomethingEverySecond {
     __block int cumValue = 0; // cumulative value
     __block void(^execBlock)() = ^{        
        while (1)
        {
            @try 
            {
                // some code here that might either A: call continue to continue the loop, 
                // or B: throw an exception.
                cumValue++;
                NSLog(@"Cumulative Value is: %i", cumValue);

                if (cumValue == 5)
                    return;
            }
            @finally 
            {
                [NSThread sleepForTimeInterval:1];
            }
        }
    };

    [NSThread detachNewThreadSelector:@selector(invoke) toTarget:[execBlock copy] withObject:nil];
} 
```

使用`NSTimer`：

```
-(void) doSomethingEverySecond {
    __block NSTimer *timer = nil;
    __block int cumValue = 0;
    __block void (^execBlock)() = ^{
        cumValue++;
        NSLog(@"Cumulative Value is: %i", cumValue);

        if (cumValue == 5)
            [timer invalidate];
    };

    timer = [NSTimer scheduledTimerWithTimeInterval:1 target:[execBlock copy] selector:@selector(invoke) userInfo:nil repeats:YES];
} 
```

现在，如果我们只想要一次，`NSThread`就是要走的路，如下所示：

```
-(void) doSomethingOnce {    
    __block void (^execBlock)() = ^{
        NSLog(@"Doing something that could take a LONG time!");
    };

    [NSThread detachNewThreadSelector:@selector(invoke) toTarget:[execBlock copy] withObject:nil];
} 
```

现在，对于`NSTimer`变体：

```
-(void) doSomethingOnce {    
    __block void (^execBlock)() = ^{
        NSLog(@"Doing something that could take a LONG time!");
    };

    [NSTimer scheduledTimerWithTimeInterval:0 target:[execBlock copy] selector:@selector(invoke) userInfo:nil repeats:NO];
} 
```

这样做的原因是我们在使用 a 时可以完全控制线程`NSThread`，但如果使用 a `NSTimer`，我们会在 a 内部执行`NSRunLoop`，如果在内部完成任何繁重的工作，可能会冻结 UI。这就是 a`NSThread`比 a的优势`NSTimer`。

您还可以保证`NSThread`被分离的 a 会立即执行`NSTimer`，而基于 NSRunLoop 的 a 不能，因为它可能会也可能不会立即执行。

还有第三种选择（从技术上讲也是第四种，`pthread`s，但我现在暂时忽略它）`GCD`，但我建议你使用 RTFM，因为它的主题太宽泛，无法在这篇文章中涵盖。

# java - JTextPane：如何设置字体大小

> ID：10585956
> 
> 赞同：7
> 
> 时间：2012-05-14T15:04:51.770
> 
> 标签：java, swing, document, jtextpane, font-size

请看下面的代码

```
import java.awt.Color;  
import java.awt.Dimension;  
import java.awt.EventQueue;  
import java.awt.FlowLayout;  
import java.util.ArrayList;  
import java.util.Scanner;  
import javax.swing.*;  
import javax.swing.event.DocumentEvent;  
import javax.swing.event.DocumentListener;  
import javax.swing.text.BadLocationException;  
import javax.swing.text.Style;  
import javax.swing.text.StyleConstants;  
import javax.swing.text.StyledDocument;  

public class Form extends JFrame  
{  
    private JTextPane textPane;  
    private JLabel results;  
    private JPanel center,south;  
    private FlowLayout flow;  
    private ArrayList array;  
    private Color color;  
    private StyledDocument doc;  
    private Style style, fontSize;  

    public Form()  
    {  
        textPane = new JTextPane();  
        textPane.setMinimumSize(new Dimension(100,100));  

        doc = textPane.getStyledDocument();  
        doc.addDocumentListener(new TextActions());  

        results = new JLabel("Number of letters: ");  

        array = new ArrayList();   
        array.add("public");
        array.add("static");
        array.add("void");
        array.add("private");
        array.add("protected");

        color = new Color(185,224,247);  

        //Adding styles  
        style = doc.addStyle("blue", null);    
        StyleConstants.setForeground(style, color);    

         fontSize = doc.addStyle("fontSize", null);
         StyleConstants.setFontSize(fontSize, 25);

         //Setting the font Size
         doc.setCharacterAttributes(0, doc.getLength(), fontSize, false);

        center = new JPanel();  
        flow = new FlowLayout();  

        center.setLayout(flow);  
        center.add(textPane);  

        south = new JPanel();  
        south.setLayout(new FlowLayout());  
        south.add(results);  

        getContentPane().add(textPane,"Center");  
        getContentPane().add(south,"South");  

    }  

    private class TextActions implements DocumentListener   
    {  
        @Override  
        public void insertUpdate(DocumentEvent e)   
        {  
            try {  
                highlighat();  
            } catch (BadLocationException ex) {  
               ex.printStackTrace();  
            } 
        }  

        @Override  
        public void removeUpdate(DocumentEvent e)  
        {  
            try {  
                highlighat();  
            } catch (BadLocationException ex) {  
               ex.printStackTrace();  
            }  
        }  

        @Override  
        public void changedUpdate(DocumentEvent e)  
        {  

        }  

    }  

      private void highlighat()  throws BadLocationException  
     {    

        EventQueue.invokeLater(new Runnable()    
        {    
            public void run()    
            {    
                String text = "";  
                String content = null;  
                try {  
                    content = doc.getText(0, doc.getLength()).toLowerCase();  
                } catch (BadLocationException ex) {  
                    ex.printStackTrace();  
                }  
            int last=0;  

            for(int i=0;i<array.size();i++)  
            {  
               text = array.get(i).toString();  

               if(content.contains(text))  
               {  
                    while((last=content.indexOf(text,last))!=-1)  
                    {                     

                       int end = last+text.length();  

                       doc.setCharacterAttributes(last, end, textPane.getStyle("blue"), true);    

                       last++;  

                     }  

               }  
            }  
            }    
        }  
     );  
    }  

    public static void main(String[]args)  
    {  
        try  
        {  
            UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());  
        }  
        catch(Exception e)  
        {  

        }  
        Form f = new Form();  
        f.setVisible(true);  
        f.setSize(800,600);  

        f.validate();  
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);  
    }  
} 
```

在那里，我还尝试将字体大小设置为 25，但如您所见，它不起作用。“textPane.setFont()”也不起作用。如何正确设置字体大小？请帮忙..

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T16:25:52.860

当然，您可以创建一个字体对象并使用它来设置文本窗格的字体。像这样实例化它：

```
 Font f = new Font(Font.SANS_SERIF, 3, 5); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:11:40.033

也许这段代码会帮助你，关于[Highlighter 和 StyledDocument](https://stackoverflow.com/a/9022901/714968)，其余的在关于[JTextPane / EditorPane的教程中描述](http://docs.oracle.com/javase/tutorial/uiswing/components/editorpane.html)

# extjs - EXTJS4 中的表单重新加载

> ID：10585957
> 
> 赞同：1
> 
> 时间：2012-05-14T15:04:54.517
> 
> 标签：extjs, extjs4

我有一个带有保存、清除和重新加载按钮的表单。清除按钮通过使用重置方法清除表单来工作。但是在单击重新加载按钮时，应将表单与单击清除按钮之前在表单中键入的数据一起加载回。那么，这怎么可能呢？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:46:16.093

检查`loadRecord()`方法：

[http://docs.sencha.com/ext-js/4-0/#!/api/Ext.form.Basic-method-loadRecord](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.form.Basic-method-loadRecord)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T17:11:55.770

查看表单的[getValues()](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.form.Basic-method-getValues)和[setValues()](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.form.Basic-method-setValues)方法。单击清除按钮时，您可以使用`var oldValues = form.getValues()`来存储当前字段值。然后，当单击重新加载按钮时，您可以通过 恢复值`form.setValues(oldValues)`。

# backbone.js - 处理对象的子集

> ID：10585959
> 
> 赞同：1
> 
> 时间：2012-05-14T15:04:59.660
> 
> 标签：backbone.js, backbone-views, marionette

什么是如何处理对象子集的好模式。

假设我有一个储物柜列表，每个储物柜内都有一组物品。UI 与此类似——我们希望 ASCII 艺术能够通过。

```
Locker#1    |    Item #1 in Locker #2
Locker#2 ** |    Item #2 in Locker #2
Locker#3    |    Item #3 in Locker #2
            |    Item #4 in Locker #2
            |    Item #5 in Locker #2
            |    Item #6 in Locker #2
            |    Item #7 in Locker #2
            |    Item #8 in Locker #2
            | 
```

储物柜#2 被选中（激活）。我一直在做的是在储物柜#2 被激活时设置回调，然后执行 ItemCollection.fetch({ data: { lid: LOCKER_ID }}) 来获取准备显示的项目子集。感觉不太像骨干。

有什么更好的方法 -

*   加载模型的子集 - 如果是这样，是否有一个很好的例子来说明如何做到这一点？
*   加载所有内容然后对集合进行主干过滤？
*   也许是一个合适的分页示例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:23:09.450

我认为一切都取决于您的数据量。

但是每次过滤器更改时，我都没有看到获取项目集合的任何问题。我真的觉得这是骨干方式:)。此解决方案适用于两种情况：大量数据和少量数据。

作为优化步骤，您可以*缓存*集合并在每次过滤器更改时创建新集合。因此，如果用户单击返回到已访问的过滤器，您可以重用并已*获取一个。*

但是这个优化步骤仍然增加了你的用户和新数据之间的距离。用户应该重新加载整个应用程序以刷新他*缓存*的集合。或者...添加更多代码以每 X 秒重置一次集合...开始变得困难重重。

所以，在我看来：**每次用户更改过滤器时*****重新获取***集合对我来说听起来不错。

# android - 保护 Lucky Patcher / 游戏许可的方法

> ID：10585961
> 
> 赞同：7
> 
> 时间：2012-05-14T15:05:02.060
> 
> 标签：android

我即将发布一个应用程序，不希望它被盗版......即使你有许可，也有像luckypatcher这样的应用程序可以为你破解应用程序......

任何人都知道如何防止这种情况？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-06-26T22:34:10.400

要阻止您的应用程序以破解形式分发和重新打包，请参阅下面的签名检查。那么，至少只有那些安装了 LuckyPatcher 的人才能让你的应用正常运行。一旦 LuckyPacher 创建了一个修改过的 APK，签名就会改变。

当您运行发布版本时，您需要找出您的签名是什么。在下面的示例中，它是 -343553346 。

```
String sigChk = MySigCheck.MySigCheck(context);
if (sigChk.equalsIgnoreCase("Y")){
    handle signature pass
} 
```

创建一个类

```
public class MySigCheck {
public static String MySigCheck(Context context) {
    String sigChk = "B";

    Signature[] signature = new Signature[0];

    try {
        signature = context.getPackageManager().getPackageInfo(context.getPackageName(), PackageManager.GET_SIGNATURES).signatures;

        Log.d("yourapp", Integer.toString(signature[0].hashCode())); << Prints your signature. Remove once you know this and have changed it below.

    } catch (PackageManager.NameNotFoundException e) {
        e.printStackTrace();
    }

    if (signature[0].hashCode() == -343553346){
        sigChk = "Y";
    }

        return sigChk;
    }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-14T15:37:25.740

简短的回答不是真的。

[您可以观看关于使用许可 API 等Google IO Anti Pirate](http://www.google.com/events/io/2011/sessions/evading-pirates-and-stopping-vampires-using-license-verification-library-in-app-billing-and-app-engine.html)的一些最佳实践的 google IO 聊天

我知道还有另一个关于阻止懒惰海盗的一般模式的讨论，但似乎找不到 URL。

一般来说，如果您的保护依赖于 if/then 逻辑，那么某人所要做的就是修补代码并反转该逻辑或一起绕过它，这在 Java 中非常容易。

您可以通过混淆您在哪里执行此操作、在许多地方执行此操作、随机执行此操作以及添加 pro-guard 混淆等来阻止临时黑客，从而使其变得更加困难。

即使服务器端逻辑也很容易绕过，除非以某种方式使用返回包（例如与用户或电话信息同步以解锁内容的加密令牌，或访问在线社区内容所需的用户 ID 验证方案等） .)

最后，如果有人下定决心并拥有技能，他们就可以解决所有问题，除非您损失了可观的收入，否则在我看来几乎不值得失眠，这是我们所有人都需要解决的问题！

在做了 20 年（商业开发）之后，我的方法是通过使用上述模式使其变得困难，并偶尔更改它。这淘汰了懒惰的海盗。

然后忘掉它，专注于制作一个值得盗版者窃取的应用程序。

我的方法

我的应用程序主要是内容驱动的。

一般来说，如果有人购买内容，它会使用令牌服务器端加密并使用相同的未加密（不存储但使用设备和用户令牌生成每个会话，这只会使诚实欺骗变得有点困难）

然后我可以通过用户/设备配对跟踪访问。黑客的缺点是他们必须支付一次，如果他们的代币突然被使用超出合理限制，它会提醒我注意这一事实，如果我愿意，我可以关闭该帐户（我已经）

我发现社交上的人不太可能让某人使用与他们相关的信息作弊（尽管它已经发生了）并且它会回到他们身上。

我仍然遵循来自 IO/Dev Blog 等的所有建议，如果我检测到篡改，我会通知用户，然后让它离开 N 段时间，以便他们可以联系我或自我纠正。

我也从不杀死应用程序，但我确实告诉用户他们正在使用恶意软件，并询问他们是否真的信任窃取数据的人等。这些弹出窗口的消息有点简单，所以简单的字符串搜索就赢了't work etc. 并吓到人们

我还有一种方法可以向设备发送毒物令牌集，这实际上会锁定他们在设备上积累的任何数据，除非我解锁它，但你最好在你对它们进行核攻击之前真正确定他们是小偷。

也不要忽视分析作为一种检测方式，并在检测到盗版时确定要采取的适当措施。

遵循博文和 IO 提到的指导方针，然后创造性地应用它们，并混合一些独特的解决方案，然后不时更改它以适应海盗。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-12-04T17:08:23.547

基于 LuckyPatcher 使用 odex 替换来进行黑客攻击的事实。我认为打败其当前实现的适度方法是在单独的 dex 中编译您的重要代码，并通过 DexClassLoader 加载它。

参考：[http ://android-developers.blogspot.pt/2011/07/custom-class-loading-in-dalvik.html](http://android-developers.blogspot.pt/2011/07/custom-class-loading-in-dalvik.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-05T19:39:09.213

我这样做的方法是密切关注幸运修补程序的包名称，以防他们更改它。所以在运行时我检查它是否已安装，如果这个应用程序实际安装在手机上，我根本不允许使用我的应用程序，即使他们购买了该应用程序。我警告用户并杀死我的应用程序。所以他将不得不找到另一种方法来破解它。我能得到的更糟糕的是，他必须购买我的应用程序，并且肯定会给出 1 条差评。但老实说，我更喜欢黑客的 1 条差评，而不是每天 1000 份盗版。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-14T15:17:50.610

我听说的唯一方法是进行服务器验证......让您的应用联系服务器并验证他们购买了您的应用。

这是关于通过 Google 进行应用内计费，[为什么远程服务器上的签名验证比设备上更安全？](https://stackoverflow.com/q/8795517/1105376)

开发网站上的一些关于 Google Play 的一般信息和应用内计费的一些很好的[信息](http://developer.android.com/guide/publishing/publishing.html)在[这里](http://developer.android.com/guide/market/billing/billing_best_practices.html)

不幸的是，我没有找到太多其他东西......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-01-26T09:18:00.993

作为一名专业的 IT 工程师和普通的高级用户（Linux、Windows、Android、OS X、iOS），我在命令行界面和图形界面中都感到很舒服，我使用我可以使用的工具来实现我的目标。我无法想象使用没有植根的 Android 设备，而且我通常会加载大量需要它的实用程序。至少，我可以自由地控制我最喜欢的设备通常附带的强制性过时软件，插入我自己的系统应用程序，并为美观、舒适和方便进行合法修改。

我被迫走一些狡猾的途径，只是为了在作者选择削弱根用户的应用程序中实现适当的功能。被（例如）Virgin TV Anywhere 告知我的设备有“未经授权的修改”让我热血沸腾，如果这是我追求预期功能的唯一选择，我会很乐意破坏他们的代码并违反一些许可协议。

在这方面，我同意您邀请很多用户，无论是出于愤慨还是仅仅出于效用，如果您选择上述媒体应用程序这样一条严厉的道路，就会挫败您的努力。当您的代码的“固定”版本作为种子比您的合法销售更普遍时，这甚至可能完全鼓励您的应用程序盗版。

就个人而言，我总是选择付费选项，即使我被迫吞下我的安全感并用我几乎不信任的工具打破它以使其发挥作用。但是，对于许多人来说，他们对您的产品的最初曝光是通过邪恶的渠道进行的，他们几乎不会为合法的和绝望的残缺版本付费。

我理解为什么一些编码人员被迫做出这些选择，并且很高兴看到关于保护知识产权的正确方法的明智问题。

从答案中看到意义就更令人放心了。

只是我的礼物。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-07T09:37:37.227

如果他们有 root 设备，则可以隐藏 su 二进制文件以使用该应用程序，检查 root 是最好的方法，除非您可以使用非 root 版本的自由，然后您需要修复它。检查像游戏杀手这样的黑客工具会阻止懒惰的人，但不能阻止将字符串反编译为另一个的人。

* * *

## 回答 #8

> 赞同：-5
> 
> 时间：2015-01-12T16:14:21.760

Lucky Patcher 在有根设备中工作。我检查手机是否已root。在我的第一个活动中，我检查手机是否为root，我的应用程序被锁定，否则我的应用程序打开。

使用以下方法检查是根：

```
 private static boolean isRooted() {
    return findBinary("su");
}

public static boolean findBinary(String binaryName) {
    boolean found = false;
    if (!found) {
        String[] places = {"/sbin/", "/system/bin/", "/system/xbin/", "/data/local/xbin/",
                "/data/local/bin/", "/system/sd/xbin/", "/system/bin/failsafe/", "/data/local/"};
        for (String where : places) {
            if ( new File( where + binaryName ).exists() ) {
                found = true;
                break;
            }
        }
    }
    return found;
} 
```

# jquery - 在 mvc 中，使用基于表单的模型绑定与 javascript 序列化时如何获得响应？

> ID：10585962
> 
> 赞同：2
> 
> 时间：2012-05-14T15:05:04.703
> 
> 标签：jquery, asp.net-mvc, model-binding

我在 MVC 中创建了一个表单，最初使用 javascript 序列化和 jQuery 到 $.post() 到控制器方法。这工作正常，除了单个字段由于某种原因没有绑定到方法参数，所以我切换到 MVC 内置模型绑定，而不是解决了这个问题。但是，这样做的结果是我的回复消息被切断了。我的验证消息仍然显示得很好，但是像“alert('saved')”这样的东西不起作用，我不知道如何做其他事情，比如有条件地刷新页面等等。

任何帮助表示赞赏。

谢谢。

编辑：

jQuery代码是：

```
 $.post(
        'controllerURL',
        {
            IRN: irn,
            SepId: sepId,
            JvsId: jvsId,
            From: from,
            To: to,
            Notes: notes,
            CTA: cta
        },
        function (data) {
            if(data.Success == null) {
                alert(data.Error);
                return;
            }

            alert(data.Success);
            reloadPage();
        },
        'json'
    ); 
```

控制器方法如下所示：

```
 [HttpPost]
    public ActionResult UpdateJvsEntry(JVSDataEntryModel model) //(string IRN, int SepId, int? JvsId, DateTime From, DateTime? To, string Notes, int CTA)
    {
        if (model.To.HasValue && model.To.Value < model.From)
        {
            ModelState.AddModelError("Error", "To can not be prior to From.");
            //return Json(new { Error = "To can not be prior to From." });
        }

        var entry = new EmisJvs();

        if (model.JvsEntryId > 0)
        {
            entry = _jvsDataService.GetWhere(w => w.JvsId == model.JvsEntryId && w.SEPID == model.SepId).Single();
        }
        else
        {
            if (DoesJvsHaveOpenEntries(model.SepId))
            {
                ModelState.AddModelError("Error", "You must close out the current JVS entry before creating a new one.");
                //return Json(new { Error = "You must close out the current JVS entry before creating a new one." });
            }

            entry.SEPID = model.SepId;
        }

        entry.SchoolIRN = model.SchoolIRN;
        entry.From = model.From;
        entry.To = model.To;
        entry.Notes = model.Notes ?? string.Empty;
        entry.Percentage = model.CTA;
        entry.ChangedOn = DateTime.Now;
        entry.ChangedBy = _userService.CurrentUser().SepId;

        if (model.JvsEntryId == 0)
        {
            _jvsDataService.Insert(entry);
        }

        if (ModelState.IsValid)
        {
            _jvsDataService.SaveChanges(entry);
        }

        return View("JVSDataEntry", model);
    } 
```

另一个编辑：

我最终回到了我之前做的 $.post() 解决方案。通过本机 MVC 表单进行模型绑定路线与我正在使用的当前项目架构不一致，我只是在循环中运行，所以我只是备份并应用了 KISS。导致我调查模型绑定的最初问题与页面上或 jQuery 本身中的一个奇怪问题有关。我可以验证页面上是否存在 ID 为“Notes”的元素，但是当我这样做时，`$('#Notes').val()`即使文本确实在输入框中，我也没有得到任何返回。我最终不得不做长格式的级联样式选择器并`$('div[class=\'jvsDataEntryDiv\'] input[id=\'Notes\']').val()`改为工作。

谢谢，杰西和其他所有人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:57:48.397

当您从帖子中返回视图时，您的客户端消息不起作用。如果您想处理刷新客户端，那么您可能应该返回某种形式的 json 结果：

```
return new JsonResult
{
    JsonRequestBehavior = JsonRequestBehavior.AllowGet,
    Data = new { Success = "Some success message here" }
}; 
```

**编辑**：根据您的评论，我不相信您的 jQuery $.post 函数设置正确。尝试添加以下内容：

```
dataType: 'json',
contentType: 'application/json; charset=utf-8', 
```

# jsf - ui:repeat 里面 ui:repeat

> ID：10585973
> 
> 赞同：2
> 
> 时间：2012-05-14T15:05:51.693
> 
> 标签：jsf, facelets, uirepeat

我有这个：

```
<ui:repeat value="#{orderController.listRequestItem}" var="item">
....
<tbody>
  <tr>
    <td>#{item.product.codigoProduto}</td>
  <td>
    <ui:repeat value="#{item.product.materials}" var="m">
     #{m.description}
    </ui:repeat>
  </td>
... 
```

是`listRequestItem`：

```
public List<RequestItemVO> listRequestItem; 
```

在这里我填充它：

```
listRequestItem = new ArrayList<>(requestVO1.getRequestItem()); 
```

是`item.product.materials`：

```
public Set<MaterialVO> getMaterials()
{
    //compiled code
    throw new RuntimeException("Compiled Code");
} 
```

当我尝试访问`m`我的内部`<ui:repeat>`时，我无法访问它的方法。

`#{item.product.codigoProduto}`正在正确返回产品代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:25:00.623

`<ui:repeat>`不`Set<E>`支持。这种支持将在即将到来的 JSF 2.2（也适用于）中[引入。](http://jdevelopment.nl/jsf-22/#479)`<h:dataTable>`JSF 2.2 将在本季度发布。

同时，您需要将其转换为`List`. 有几种方法：

*   将属性更改为，`List<MaterialVO>`并相应地更改业务代码。

    ```
    private List<MaterialVO> materials; 
    ```

*   或者添加一个包装器属性并使用它。

    ```
    public List<MaterialVO> getMaterialList() {
        return new ArrayList<MaterialVO>(materials);
    } 
    ```

    这只是昂贵的，因为每次迭代都会调用 getter。您可能想要添加另一个包装原始集的属性。

*   或者创建一个自定义 EL 函数来完成这项工作：

    ```
    <ui:repeat value="#{util:setToList(item.product.materials)}" ...> 
    ```

*   或者创建一个自定义的 EL 解析器。可以在这个答案中找到详细信息：[How do I use a java.util.Set with UIData in JSF。特别是 h:datatable?](https://stackoverflow.com/questions/9327479/how-do-i-use-a-java-util-set-with-uidata-in-jsf-specifically-hdatatable/9327572#9327572)

此问题与嵌套无关`<ui:repeat>`。

# web-services - 肥皂：地址和http：地址

> ID：10585975
> 
> 赞同：3
> 
> 时间：2012-05-14T15:05:54.407
> 
> 标签：web-services, soap, wsdl

**我在理解 wsdl 中的soap:address**和**http:address**标记之间的区别时遇到了一些问题。可以互换吗？我可以使用**soap:address**代替**http:address**吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T19:07:31.603

**简短的回答**

不，你不能。它们不可互换。它们属于不同的 WSDL 绑定。

**长答案**

WSDL 格式不绑定到特定协议。相反，它可以扩展为与各种协议结合使用，例如 SOAP、HTTP 和 MIME。这种扩展称为绑定。绑定定义了用于与 Web 服务通信的协议和消息格式。每个 Binding 都有一个命名空间和关联的命名空间前缀添加到标签。命名空间前缀和标签用冒号分隔。所以，**soap:address标记中的****soap**命名空间前缀表明它属于SOAP Binding 和**http:address中的****http**命名空间前缀******tag 表示它属于 HTTP Binding。您不能将它们混合在一个 Binding 中，因为根据 WSDL 规范，一个 Binding 必须准确指定一个协议。但是您可以为一个 portType 设置不同的绑定。******

 ********链接**

1.  [WSDL 1.1 规范](http://www.w3.org/TR/wsdl)
2.  [WSDL 1.2 规范：绑定](http://www.w3.org/TR/2002/WD-wsdl12-bindings-20020709/)******

# linux - 如何使用 Linux 命令获取可用内存百分比？

> ID：10585978
> 
> 赞同：67
> 
> 时间：2012-05-14T15:05:58.933
> 
> 标签：linux, memory

我想使用 Linux 命令行以百分比形式报告可用内存。

我使用了`free`命令，但这只是给我数字，并且没有百分比选项。

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2012-05-14T15:08:09.343

使用`free`命令：

```
% free
             total       used       free     shared    buffers     cached
Mem:       2061712     490924    1570788          0      60984     220236
-/+ buffers/cache:     209704    1852008
Swap:       587768          0     587768 
```

基于此输出，我们`Mem`使用 awk 选择特定字段进行计算。

这将报告正在使用的内存百分比

```
% free | grep Mem | awk '{print $3/$2 * 100.0}'
23.8171 
```

这将报告可用内存的百分比

```
% free | grep Mem | awk '{print $4/$2 * 100.0}'
76.5013 
```

你可以为这个命令创建一个别名或者把它放到一个小的 shell 脚本中。可以使用 print 语句的格式化命令来根据您的需要定制特定的输出：

```
free | grep Mem | awk '{ printf("free: %.4f %\n", $4/$2 * 100.0) }' 
```

# c# - ServiceBus.dll 与 .NET 4 Framework 客户端配置文件

> ID：10585983
> 
> 赞同：0
> 
> 时间：2012-05-14T15:06:06.133
> 
> 标签：c#, .net, azure, servicebus

我尝试使用 netTcpRelayBinding 和 azure 服务总线来使我的服务可扩展。我需要在服务器端和客户端都使用这个绑定。它在 Microsoft.ServiceBus.dll 中实现，因此我应该将此 .dll 部署到客户端。但它要求 .NET 框架 Full Profile。但在客户端只能是 .NET 框架客户端配置文件。而且我绝对确定在客户端安装完整配置文件是一个坏主意。有什么解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:47:40.823

在 Microsoft.ServiceBus.dll 中实现的服务总线客户端依赖于客户端配置文件中不可用的一系列功能，最值得注意的是客户端配置文件中缺少托管服务的能力，这是中继的要求功能。如果您要安装的应用程序仅是客户端，您可以使用常规 NetTcpBinding 与中继端点通信，但有两个注意事项：

a）您需要使用 RelayClientAuthenticationType.None 关闭中继安全性（请参阅[http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.servicebus.relayclientauthenticationtype.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.servicebus.relayclientauthenticationtype.aspx)）或者您需要获取并添加您自己的令牌，这是服务总线程序集为您所做的，如果没有该代码，这有点复杂，我认为我们还没有公开的示例。

b) 您需要在 ChannelFactory 上指定两个地址 - EndpointAddress 需要使用 sb: 前缀，Via Uri 需要使用 net.tcp: 前缀

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:15:56.850

在客户端拥有完整的框架并不是一件坏事。客户端配置文件的大小不会减少以删除“不安全”位，只是不常用的位。其逻辑是为分发应用程序的人提供较小的下载量。这几天有点多余。

虽然没有合适的解决方法，甚至不考虑尝试从完整框架中提取所需的程序集，只需安装完整框架即可。

会感兴趣的是什么让您认为将完整的客户端放在工作站上首先是一个坏主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:27:13.313

首先，我建议阅读以下讨论以了解完整配置文件和客户端配置文件之间的区别： [Microsoft .NET 4.0 完整框架和客户端配置文件之间的差异](https://stackoverflow.com/questions/2759228/difference-between-net-4-client-profile-and-full-framework-download)

基于此，您可以理解大多数 Windows Azure 组件都依赖于使用完整配置文件，主要是因为 Web、WCF 和其他服务是完整配置文件的一部分，您确实需要使用完整配置文件才能使这些库正常工作。

# android - 为什么仿生C中的pthread_cond_wait不是原子的？

> ID：10585985
> 
> 赞同：1
> 
> 时间：2012-05-14T15:06:08.573
> 
> 标签：android, multithreading, posix, libc, bionic

实现中存在竞争条件，可能会丢失信号。问题是 pthread_cond_wait 函数不是原子的？在文件 [https://github.com/android/platform_bionic/blob/master/libc/bionic/pthread.c的评论中讨论了相同的内容](https://github.com/android/platform_bionic/blob/master/libc/bionic/pthread.c)

这个操作不应该是原子的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T18:26:56.623

您**不**应该担心这种“竞争条件”。根据评论，只有当一个线程在一个病态的地方进入睡眠状态，在那里长时间睡眠，而其他线程向条件变量发出病态的次数（不多也不少）时，才会发生这种情况。

这实际上是条件变量的许多完全合理的低级实现所固有的，尤其是在基于[futexes](http://en.wikipedia.org/wiki/Futex)时。基本上，在用户空间代码原子地检查整数变量的值之后，它调用内核执行阻塞操作，但如果整数变量的值在此期间发生变化，它会指示内核中止操作。病态的情况是整数变量在其范围内一直环绕精确整数次（而第一个调用者一直处于阻塞状态！）。

如果您想了解更多关于此类真正微妙细节的信息，请阅读[本文](http://www.akkadia.org/drepper/futex.pdf)。

# c# - 在计时器中放置一个方法以减慢 Emotiv Epoc 的速度

> ID：10585986
> 
> 赞同：0
> 
> 时间：2012-05-14T15:06:08.590
> 
> 标签：c#, timer, pooling

我是 C# 的新手。

**问题**：

我想在计时器中运行一个方法，但是该方法返回/需要的参数不在计时器的参数集中。

**原因**：该方法被定期调用（EPOC Emotiv 耳机），我希望它每秒只调用一次。

它被一个函数调用（我认为）：

EmoEngine.Instance.CognitivEmoStateUpdated += new EmoEngine.CognitivEmoStateUpdatedEventHandler(Instance_CognitivEmoStateUpdated);

*运行*（过于定期）的方法是：

void Instance_CognitivEmoStateUpdated(object sender, EmoStateUpdatedEventArgs e) { EmoState es = e.emoState; EdkDll.EE_CognitivAction_t currentAction = es.CognitivGetCurrentAction(); }

该软件已经带有一个计时器运行以每秒处理事件：

private void timer1_Tick(object sender, EventArgs e) { engine.ProcessEvents(); }

**我希望我可以简单地将方法 aboce (Instance_Cogn...) 放在计时器中，我认为这样可以解决问题**..

请问最好的方法是什么？

很多谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:16:46.680

使用 System.Threading.Timer 而不是 Timer Control。线程的时间类使您可以传递参数并在代码中使用函数的输出。

```
 // Create the delegate that invokes methods for the timer.
   TimerCallback timerDelegate = new TimerCallback(CheckStatus);

   // Create a timer that waits one second, then invokes every second.
   Timer timer = new Timer(timerDelegate, arguments,1000, 1000); 
```

[参考示例代码](http://www1.cs.columbia.edu/~lok/csharp/refdocs/System.Threading/types/Timer.html)

# cuda - 如何测量 NVIDIA CUDA 中的内核时间？

> ID：10585990
> 
> 赞同：24
> 
> 时间：2012-05-14T15:06:28.400
> 
> 标签：cuda, gpu, gpgpu, nvidia

我想测量GPU的时间内核，如何在NVIDIA CUDA中测量它？例如

```
__global__ void kernelSample()
{
  some code here
  get start time 
  some code here 
  get stop time 
  some code here
} 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-05-14T16:27:48.263

你可以这样做：

```
__global__ void kernelSample(int *runtime)
{
  // ....
  clock_t start_time = clock(); 
  //some code here 
  clock_t stop_time = clock();
  // ....

  runtime[tidx] = (int)(stop_time - start_time);
} 
```

这给出了两个调用之间的*时钟周期数。*不过要小心一点，计时器会在几秒钟后溢出，所以你应该确保连续调用之间的代码持续时间很短。您还应该知道编译器和汇编器确实会执行指令重新排序，因此您可能需要检查时钟调用是否最终不会在 SASS 输出中彼此相邻（用于`cudaobjdump`检查）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:17:42.087

试试这个，它以毫秒为单位测量 2 个事件之间的时间。

```
 cudaEvent_t start, stop;
  float elapsedTime;

  cudaEventCreate(&start);
  cudaEventRecord(start,0);

 //Do kernel activity here

 cudaEventCreate(&stop);
 cudaEventRecord(stop,0);
 cudaEventSynchronize(stop);

 cudaEventElapsedTime(&elapsedTime, start,stop);
 printf("Elapsed time : %f ms\n" ,elapsedTime); 
```

# asp.net-mvc - 如何将mvc站点添加到iis7

> ID：10585991
> 
> 赞同：1
> 
> 时间：2012-05-14T15:06:29.447
> 
> 标签：asp.net-mvc, iis, webforms

我对 WebForms 没有任何问题，我所做的一切，它都能正常工作。

现在我创建了新的测试项目 - MVC3 应用程序 - [http://prntscr.com/98ckk](http://prntscr.com/98ckk)

我只是发布它 - Visual Studio - 构建 - 发布 - 到 c:\test [http://prntscr.com/98cq8](http://prntscr.com/98cq8)

然后我将文件传输到 inetpub/wwwroot/test 中的 Windows 服务器

然后我创建了新网站 - 指向这个文件夹。但是，当我测试它“ip/test”时，我得到 403 - 禁止访问：访问被拒绝。

ps 我已经有 IIS->Website 站点 whitch 是 MVC 并且正在工作。但我不记得我做了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:26:50.490

如果您使用表单身份验证（或无身份验证），请确保将 IIS 7 配置为允许匿名访问，并且应用程序池用户有权访问您的站点/文件夹。

如果您使用 Windows 身份验证，则应禁用匿名访问并打开 Windows 身份验证。然后您需要确保您的 Windows 帐户/组具有访问权限。

# date - TYPO3：比较 Fluid-if 中的两个时间戳

> ID：10585994
> 
> 赞同：0
> 
> 时间：2012-05-14T15:06:43.017
> 
> 标签：date, timestamp, conditional-statements, typo3, fluid

我不确定如何正确编写它，但这是我使用的内联符号，从检查来看似乎是正确的，但它总是说它更大。

`{f:if(condition: '{timestamp} > {f:format.date(date:{timestampsinloop}, format:"U")}', then: 'Too late')}`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T12:51:26.107

我回到了半内联半块表示法：

`<f:if condition="{timestamp} > {f:format.date(date: '{timestampsinloop}', format: 'U')}">Too late</f:if>`

# android - 如何保持对话框在android中可见？

> ID：10585996
> 
> 赞同：0
> 
> 时间：2012-05-14T15:06:43.200
> 
> 标签：android, dialog, progressdialog, progress

我不想在单击按钮后隐藏android中的进度对话框，我只想在保持`Dialog`出现的同时执行一些操作，我有以下用于创建对话框的代码：

```
public Dialog onCreateDialog(int id){
        switch(id){
        case 0 :
            // Alert Dialog
            return null;
        case 1:

            progressDialog = new ProgressDialog(this);
            progressDialog.setIcon(R.drawable.ic_launcher);
            progressDialog.setTitle("Play audio file");

            progressDialog.setCancelable(false);
            progressDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);

    /*      progressDialog.setButton(DialogInterface.BUTTON_POSITIVE,"Play",
                    new DialogInterface.OnClickListener() {

                public void onClick(DialogInterface dialog, int which) {

                    Toast.makeText(getBaseContext(),"Hide clicked!",Toast.LENGTH_SHORT).show();
                }
            });*/

            progressDialog.setButton(DialogInterface.BUTTON_NEGATIVE, "Close", new DialogInterface.OnClickListener() {

                public void onClick(DialogInterface dialog, int which) {
                    Toast.makeText(getBaseContext(),"Cancel clicked!",Toast.LENGTH_SHORT).show();

                }
            });
            progressDialog.setButton("Play", new DialogInterface.OnClickListener() {

                public void onClick(DialogInterface dialog, int which) {
                    Toast.makeText(getBaseContext(),"Cancel clicked!",Toast.LENGTH_SHORT).show();

                }
            });
            return progressDialog;
        }
        return null;

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T19:00:59.193

我使用了一个带有自定义布局的 AlertDialog。通过控制自定义布局中的 onClickListeners，我可以决定何时让对话框消失。我对对话框不太了解，但这对我有用，也应该对你有用，虽然我不知道你是否可以专门使用 ProgressDialog

```
 @Override
    public void openDialog(Context context) {

        // declare the dialog object
        AlertDialog.Builder builder;
        AlertDialog alertDialog = null;

        // inflate the layout to use inside it
        View layout = ((Activity)context).getLayoutInflater().inflate(R.layout.list_selector_horizontal,null, false);

        TextView text = (TextView) layout.findViewById(R.id.list_selector_textView1);
        text.setText("Select a product:");

        // set the dialog to use the layout
        builder = new AlertDialog.Builder(context);
        builder.setView(layout);                        
        alertDialog = builder.create(); 

        // *important* Set this to false to stop users dismissing the dialog when they tap outside of it
        alertDialog.setCanceledOnTouchOutside(false);

        // populate the layout with some more views
        LinearLayout scrollContainer = (LinearLayout) layout.findViewById(R.id.list_selector_linearLayout2);                
        for(int i = 0;i<products.size();i++){
            Product product = products.get(i);
            View view = product.getView(context);

            // set the onClickListener for the product view
            view.setOnClickListener(new ProductListOnClickListener(alertDialog, product, this, v));
            view.setPadding(10, 10, 10, 10);
            scrollContainer.addView(view);
        }

        // show the dialog
        alertDialog.show();

    } 
```

然后在 onClickListener 中：

```
class ProductListOnClickListener implements OnClickListener{

        private AlertDialog alertDialog;                    
        private Product p;
        private View view;
        private boolean dismiss = false;

        public ProductListOnClickListener(AlertDialog alertDialog, Product p, View view) {              
            this.alertDialog = alertDialog;
            this.p = p;
            this.view = view;
        }

        @Override
        public void onClick(View v) {
            // do whatever

            if(dismiss){
                // dismiss dialog
                alertDialog.dismiss();
            }
        }

    } 
```

# c# - 使用 Mpdreamz/NEST 将查询作为字符串传递给 elasticsearch

> ID：10585997
> 
> 赞同：0
> 
> 时间：2012-05-14T15:06:46.823
> 
> 标签：c#, elasticsearch

我开始使用 NEST 并让它工作。我看到作为字符串的查询被贬低了。还有另一种方法吗？假设我想在整个索引中搜索“测试”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T20:42:30.520

作为字符串传递确实已被弃用，但不会被删除。

要在所有索引中搜索一个术语，请使用：

```
this.ConnectedClient.Search<MyDTO>(s=>s
    .AllIndices()
    .Query(q=>q.Term(f=>f.Name, ""))
); 
```

请务必查看包含大量示例代码的测试项目和文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-17T20:13:18.137

如果您要查找的只是在所有字段中通过单个单词搜索文档类型，则可以只使用 querystring 查询类型。

```
Client.Search<T>(q=>q.Index("MyIndex").Query(q=>q.QueryString("test"))) 
```