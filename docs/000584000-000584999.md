# StackOverflow 问答 000584000-000584999

# ruby-on-rails - 在下一行继续声明 WITH A COMMENT

> ID：584000
> 
> 赞同：14
> 
> 时间：2009-02-24T22:55:49.373
> 
> 标签：ruby-on-rails, ruby, newline, continuations

如果我在 Ruby 中有一条语句要在下一行继续，通常我会在行尾添加一个反斜杠，如下所示：

```
print x \
+ y 
```

但是，如果我对此有意见，它就不起作用：

```
print x #show x 
+ y # show y 
```

有没有解决的办法？

（编辑：Squeegy 的解决方案是正确的，实际上，我知道你可以这样做，但我特别想知道是否有办法在与反斜杠相同的行上发表评论）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-24T23:02:29.123

您需要在第一行加号。我不认为评论与黑斜线一起使用

```
puts 'abc' + #Start abc
  'def'      #Add def 
```

# c - 为什么这种按位右移似乎不起作用？

> ID：584015
> 
> 赞同：10
> 
> 时间：2009-02-24T22:59:06.700
> 
> 标签：c, bit-manipulation, bit-shift, binary-operators, not-operator

有人可以向我解释为什么面具根本没有向右移动吗？你可以用任何东西代替那个 1 ，结果是一样的。

```
unsigned mask = ~0 >> 1;
printf("%u\n", mask); 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-24T23:04:31.910

这是类型问题。如果您将 0 转换为无符号，那就没问题了：

```
unsigned mask = ~ (unsigned) 0 >> 1;
printf("%u\n", mask); 
```

根据评论编辑：或使用更简洁的无符号文字表示法。:)

```
unsigned mask = ~0u >> 1;
printf("%u\n", mask); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-24T23:02:06.927

[标志扩展](http://en.wikipedia.org/wiki/Sign_extension)

正在发生的`~0`是一个所有位都设置为 ( `-1`) 的 int。现在你右移`1`；因为它是`-1`，所以符号扩展保持最高位设置，因此它保持签名（这不是您所期望的）。然后它会像您期望的那样转换为无符号。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T23:05:05.187

试试这个：

```
unsigned mask = (unsigned) ~0 >> 1;
printf("%08x\n", mask); 
```

除非您强制转换，否则分配的 RHS 将被视为有符号数量，这意味着您在没有强制转换的情况下看到符号扩展。（我还更改了您的打印语句以显示十六进制数字，这对我来说更容易解码。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T23:03:43.537

~0 是一个字符串。>> 运算符将它们移位，并在有符号值中将 1 移位到高位。所以你可以随心所欲地改变，结果不会改变。

# c# - 如何在c#中删除一个数组？

> ID：584017
> 
> 赞同：30
> 
> 时间：2009-02-24T23:00:12.297
> 
> 标签：c#, arrays

如果这是一个明显的问题，我很抱歉，但谷歌或这里的搜索都没有让我得到答案。

有没有办法完全删除数组？

我想要*相反*的`int[] array = new int[5]`

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-02-24T23:07:38.720

假设您致电：

```
 void Foo(){
     int[] a = new int[5];
 } 
```

在 C# 中，无法取消定义变量`a`. 即使您设置为空，这意味着`a`将被定义。但是，结束时会超出范围。这意味着没有代码可以引用它，并且垃圾收集器将在下次运行时为您释放内存，这可能不会很长时间。`Foo``a``Foo` `a`

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-24T23:04:38.993

你只需要让它超出范围，然后等待 GC 找到它；这可能不会立即发生（事实上，几乎可以肯定不会）。如果您在长寿命对象上有一个字段（将保留在范围内），那么您可以设置为 null，这会有所帮助。

您可以影响 GC 更快地收集（不仅仅是您的对象：所有符合条件的对象），但您应该很少**这样**做。我只在测试台上使用它；但：

```
GC.Collect(GC.MaxGeneration, GCCollectionMode.Forced); // DON'T DO THIS!!! 
```

有关更多信息`GC.Collect`：

*   [使用 GC.Collect() 有什么问题？](https://stackoverflow.com/questions/118633/whats-so-wrong-about-using-gc-collect)
*   [什么时候可以调用 GC.Collect？](https://stackoverflow.com/questions/478167/when-is-it-acceptable-to-call-gc-collect)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-24T23:20:40.780

您应该阅读[Chris Brumme 关于该主题的文章](http://blogs.msdn.com/cbrumme/archive/2003/04/19/51365.aspx)；前几段应说明情况。

任何建议“将 null 分配给变量”的人都应该特别注意以下内容：

> 即使您添加“aC = null;” 在你使用它之后，JIT 可以自由地认为这个赋值是死代码并消除它。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-24T23:05:14.017

不需要删除数组，GC会处理。

（非常）简单地说：

当您用完内存时，垃圾收集器将启动，停止您的代码并遍历内存中的所有活动对象。
live 意味着堆栈上的一些引用、寄存器、静态引用和其他一些统称为“GC Roots”的东西。当它遍历它们时，它注意到它们还活着。

如果您的数组不再活动，则任何东西都无法再访问它（这决定了活动性），因此它所占用的内存将可供重用。

*可能*有理由将引用分配给 null 如果它将保持引用的存活时间超过预期，或者它持有您立即需要的大量内存，但这很容易适得其反，实际上使数组的寿命更长。如果包含实例的寿命比它包含的数组长得多，则实例而不是堆栈变量是此优化的更好候选者。

需要明确的是，作为初学者，您不应该考虑这种事情，让 GC 完成它的工作，并且只在您以下情况下尝试帮助它：

1.  知道你需要
2.  知道怎么
3.  知道如何检查你是否做对了

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-24T23:05:54.357

array = null，但我认为如果您阅读一些有关 .NET 内存管理模型的信息以完全理解原因，这将是一个好主意。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-24T23:13:45.760

只是为了澄清一下，以防您不理解其他答案中表达的某些术语，GC 代表垃圾收集器。像 C# 这样具有自动内存管理的语言可以让您专注于做需要做的事情，而不必担心您正在创建什么以及何时删除它。GC 通过定期检查您创建的所有对象并查看它们是否对它们有任何引用来工作。如果没有，这意味着你无法对它们做任何事情，所以它们可能会被删除，而系统就是这样做的。

有关详细信息，请参阅[http://en.wikipedia.org/wiki/Garbage_collection_(computer_science)](http://en.wikipedia.org/wiki/Garbage_collection_(computer_science))

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-11-21T12:51:23.827

array = null 就足够了，不需要 GC.Collect。您可以在引用 null 之前检查内存，您可以使用 Console.WriteLine(GC.GetTotalMemory) 进行检查，然后再次检查。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-24T23:09:48.060

你得到的最接近的只是等待它超出范围或将其设置为空。

它不会立即删除或删除数组，但是在你删除了对数组的所有引用后，垃圾收集器（GC）会及时删除它......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-09-07T13:54:24.113

您可以在 if (true) {} 语句中声明和初始化数组，在 if 语句之外（在它之后）数组变量不可访问，因此它将被删除。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-03-09T07:02:37.430

在 C++ 中，可以使用*delete*关键字。它最初是在此评论和其他评论中提到的。编辑历史显示了这一点。即使其他人不明白为什么，这是一个可行的（尽管是侧面的答案）。我这样说是因为如果他们了解一种以上的语言，他们可以使用它来找到自己的优雅解决方案。

在 .NET/MSIL 中，您有 delete 关键字，但它被称为*变量*名 .Dispose()。我提供这个是因为它删除了对变量的所有引用，并将其推入垃圾收集准备状态。另一种选择是将变量设置为*null*，因为这将使变量保持为类型化对象，但将其保存的内容释放到垃圾收集中，以便以后可以重新分配。

原始评论/答案：

C# 的垃圾收集非常棒，但有时您确实需要从内存中删除变量并创​​建它的新实例，而无需程序的其他部分使其保持活动状态。通过将数组指向一块新的内存，可以潜在地将数组持有的现有内存块置于 GC 状态，例如：

```
aMyArray = new int[]; 
```

但是，我可以通过这种方式看到的主要问题是，您真的不想浪费大量内存，然后在启动 GC 时让一切戛然而止，因为操作系统正在崩溃。我持有这个想法，考虑到 C Sharp 现在是一种主流语言，并且被用于许多不同的应用程序中，包括编写游戏......尊重。

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2012-11-09T14:19:53.893

这可能已经解决，但您可以将数组视为堆栈。循环遍历它并从每次迭代中弹出顶部。

```
while(true)
{
    if(array.Length==0)
    {
        break;
    }
    array.Pop();
} 
```

这样您就可以将更多值推入数组而无需重新实例化它

# asp.net - 使用 ASP.net 图表控件时抛出 NotImplementedException

> ID：584031
> 
> 赞同：0
> 
> 时间：2009-02-24T23:02:00.577
> 
> 标签：asp.net, charts

有没有人在使用控件数据绑定方法时抛出这个异常？

我有这样的数据结构

```
public class ChartData
{
   public int Year {get;set;}
   public decimal Stat {get;set;}
} 
```

它的收藏是

```
List<ChartData> cData; 
```

所以我将此对象绑定为

```
chart1.BindXY(cData,"Year",cData,"Stat"); 
```

使用其他数据绑定方法时我也会遇到同样的异常

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-02-24T23:23:14.533

什么是图表1？
那是一个外部图表组件吗？

使用反射器打开图表组件 dll 或查看文档以了解适当的使用方法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-25T21:41:57.063

当 Visual Studio 创建方法存根以响应调用不存在的类方法时的“生成方法存根”上下文菜单命令时，它会添加 NotImplementedException。

也许您使用的图表控件还没有完全实现，而您尝试调用的方法只是一个存根？

# visual-studio-2008 - Visual Studio 2008 调试器走向南方

> ID：584040
> 
> 赞同：0
> 
> 时间：2009-02-24T23:04:41.880
> 
> 标签：visual-studio-2008, dll, debugging

Dell Dimension 5621 - Win XP SP2 VS Studio 6.0 & 2008。我们支持 ASP 页面。

通常我在使用 Visual Studio 2008 调试器和来自 VStudio 6.0 的 ASP 页面时没有问题。事实上，直到上周，效果都很好。实际上，我在一周前对老板发表评论希望调试器在 10 年前左右推出 VS 6.0 时就已经存在。

然后系统降级了。开始使用 Debugger 崩溃。认为也许可能是赛门铁克 AV。所以我禁用了这些服务。现在，当发生错误时，调试器会加载并询问我是否要附加到 dllhost.exe 进行调试。

您可以附加或拒绝。如果附上，系统会调试；但是，退出时 devenv.exe 会崩溃，并且在大多数情况下会杀死调试器和 VS 6.0，这在您编辑基于脚本的代码时会很烦人。

与此用户在此处报告的此问题类似：

[https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=352867](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=352867)

> 错误：
> 
> AppName：devenv.exe AppVer：9.0.30729.1 AppStamp：488f2b50
> 
> ModName：vsdebug.dll ModVer：9.0.30729.1 ModStamp：488f2c04
> 
> fDebug：0 偏移量：0001f1c2

该系统直到大约一周前才出现这些问题。据我们所知，该系统没有任何变化。也扫描了几个 AV 程序。

附加到调试器时：

> 附加到此进程可能会损害您的计算机。如果以下信息看起来可疑或您不确定，请不要附加到此过程。
> 
> 名称：C:\Windows\system32\dllhost.exe
> 
> 用户：\IWAM_
> 
> 你想附加到这个过程吗？
> 
> 附加不附加。

据我所知，这个系统没有做任何事情。我们已经使用 AV 程序进行了扫描并进行了清理。我认为如果这是一种病毒，调试器甚至永远不会启动和/或 dllhost.exe 会像我读过的有关 dllhost.exe 病毒的信息一样从 wins 目录报告。

任何的意见都将会有帮助。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T07:32:41.807

Check out MS hotfix at [http://code.msdn.microsoft.com/kb967631](http://code.msdn.microsoft.com/kb967631).

There is no KB-article yet, but any update related to the debugger is worth a try in this situation. It cannot get any worse...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T00:11:43.933

标准的**错误**答案通常是卸载然后重新安装 Visual Studio。也很烦人的答案，因为它并不能真正解释发生了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T01:43:14.183

去下载 Windows 调试工具，启动 WinDbg，并将其附加到 VS - 它应该为您提供有关正在发生的事情的更多信息（或者至少是关于进一步查看内容的线索）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T23:59:11.717

当程序开始以前所未有的方式持续崩溃时，我通常从清除 C:\Windows\Temp 开始。我记得在 WinNT 时代，它几乎解决了所有与打印机相关的问题，以及旧的 InstallShield 安装问题 :-)

# c++ - 如何在 Visual C++ 中构建导入库 (.lib) 和 DLL？

> ID：584041
> 
> 赞同：77
> 
> 时间：2009-02-24T23:04:47.417
> 
> 标签：c++, visual-studio, dll, import

我想要一个构建 DLL 文件和导入库 (.lib) 文件的 Visual Studio 项目。（导入库是一个静态链接库，负责将该 DLL 文件加载到使用它的其他项目中）。

于是我去Visual Studio C++ 2008 Express Edition，新建一个类库类型的项目，并将“配置类型”设置为“动态库（.dll）”。

但是当我构建解决方案时，我看到的唯一相关输出文件是 DLL 文件；我没有看到生成任何 LIB 文件。我查看了项目目录和所有子目录（发布和调试）。

我相信可以同时构建 LIB 和 DLL 文件，因为[在 MSDN 上它说“链接器在构建 DLL 时创建导入库”。](http://msdn.microsoft.com/en-us/library/d14wsce5.aspx) 此外，[该网站的另一个用户正在使用 Visual C++ 同时创建 LIB 和 DLL 文件](https://stackoverflow.com/questions/477461/when-building-a-dll-file-does-the-generated-lib-file-contain-the-dll-name)。

那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-02-24T23:12:28.740

您的 DLL 项目是否有任何实际导出？如果没有导出，链接器将不会生成导入库 .lib 文件。

在非 Express 版本的 VS 中，导入库名称在此处的项目设置中指定：

```
Configuration Properties/Linker/Advanced/Import Library 
```

我认为它在 Express 中是相同的（如果它甚至提供配置名称的能力）。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2011-10-24T13:20:06.807

好的，所以我从[http://binglongx.wordpress.com/2009/01/26/visual-c-does-not-generate-lib-file-for-a-dll-project/](http://binglongx.wordpress.com/2009/01/26/visual-c-does-not-generate-lib-file-for-a-dll-project/)找到答案说这个问题是由于未导出任何符号而引起的，并进一步说明了如何导出符号以创建 lib 文件。为此，请将以下代码添加到 DLL 的 .h 文件中。

```
#ifdef BARNABY_EXPORTS
#define BARNABY_API __declspec(dllexport)
#else
#define BARNABY_API __declspec(dllimport)
#endif 
```

其中 BARNABY_EXPORTS 和 BARNABY_API 是您项目的唯一定义。然后，您导出的每个函数只需在前面加上：

```
BARNABY_API int add(){
} 
```

通过单击新项目 DLL 向导上的“导出符号”框或为计算机程序员对脑叶切除术投票是，可以防止此问题。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-02-24T23:13:57.490

通过选择“类库”，您不小心告诉它使用 C++ 的 CLI（托管）扩展创建一个 .Net 库。

相反，创建一个 Win32 项目，然后在下一页的应用程序设置中，选择“DLL”。

如果你想走这条路，你也可以从这些库选择中创建一个 MFC DLL 或 ATL DLL，但听起来你不这样做。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-01-24T17:22:31.393

您还应该在此处的项目设置中指定 def 名称：

配置 > 属性/输入/高级/模块 > 定义文件

# javascript - JavaScript 外部文件不显示变量

> ID：584042
> 
> 赞同：0
> 
> 时间：2009-02-24T23:04:50.693
> 
> 标签：javascript

好吧，我对 javascript 还是很陌生。问题是当我在外部 js 文件中编写变量或数组，并将其嵌入时，VStudio 2008 intellisense 不显示任何变量...是不是因为我无法访问一个脚本标签中的变量其他？如果是这样，我该如何使用 jQuery 之类的东西？..我在js文件中定义了一个数组，嵌入了它，但是智能感知没有显示它......我认为智能感知有问题，是吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T23:09:58.077

这听起来像是一个智能感知问题。对于网页，在 javascript 中全局定义的任何内容都应该可以在页面上的任何脚本标记或任何包含的文件中访问，只要它在正确的变量范围内。

总的来说，我对 VStudio 执行智能感知的能力印象不深，但我还没有真正看到任何 IDE 对 JavaScript 的智能感知做得很好。

# iphone - 如何获取 iPhone 上所有 .png 资源的所有文件名的 NSArray？

> ID：584049
> 
> 赞同：0
> 
> 时间：2009-02-24T23:08:03.870
> 
> 标签：iphone

我已将几个 .png 文件作为资源添加到我的项目中。如何在无需硬编码的情况下获得他们的名字数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T23:11:19.383

你可以试试这个，它适用于 Mac OS X 应用程序。

```
NSArray *files = [[NSBundle mainBundle] pathsForResourcesOfType:@"png" inDirectory:nil] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T23:18:23.767

另请参阅：[如何在 iPhone 应用程序中枚举和加载资源？](https://stackoverflow.com/questions/513480/how-do-i-enumerate-and-load-resources-in-an-iphone-app)

# asp.net - asp.net 授权：位置和 IPrincipal.IsInRole

> ID：584050
> 
> 赞同：3
> 
> 时间：2009-02-24T23:08:20.623
> 
> 标签：asp.net, security, web-config, authorization

## 设想

我正在使用自定义`IPrincipal`并`IIdentity`进行 asp.net 授权。我在`Principal`活动期间使用.`Identity``PostAuthenticateRequest``IHttpModule`

web.config 大致如下所示：

```
<system.web>
  <authorization>
    <allow verbs="GET,POST" roles="domain\group"/>
    <deny verbs="*" users="*"/>
  </authorization>
</system.web>
<location path="~/admin/user_search.aspx">
  <system.web>
    <authorization>
      <allow verbs="GET,POST" roles="admin"/>
      <deny verbs="*" users="*"/>
    </authorization>
  </system.web>
</location> 
```

## 问题

发出请求时，该`IPrincipal.IsInRole`方法会被调用一次以进行检查`domain\group`，但不会再次被调用以检查`admin`角色。这是什么原因造成的？我的`location`语法不正确还是有更深层次的问题？

## 笔记

我最初认为 admin 目录中的 web.config 覆盖了根目录中的 web.config，但我尝试完全删除它并将其用于`location`元素。到目前为止，两者都没有工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T23:44:40.910

Don't use the tilde (~) at the start of paths for <location> elements, as they are not interpreted there. In your example, path="admin/user_search.aspx" should be correct.

# visual-studio - 每天的 Visual Studio 构建

> ID：584060
> 
> 赞同：7
> 
> 时间：2009-02-24T23:10:57.950
> 
> 标签：visual-studio, build-process

有什么方法可以记录在 Visual Studio 开发日期间完成的构建数量，或者我们可以挂钩的任何地方以获取元数据？

我很好奇我平均每天建造多少次*每次建造需要多长时间......

有什么想法吗？

更新：抱歉缺少细节……这个练习纯粹是学术性的

使用具有 14 个不同项目的解决方案（1 个是网站）。我不断构建整个解决方案（Ctrl + Shift + B）。不仅要了解我一天中构建的次数，还要了解等待构建完成花费了多少时间......

最佳解决方案是不需要更改解决方案项目本身的解决方案。（预/后构建事件）我不想在签入之前/之后添加/撤消更改。

（nant/other 解决方案听起来像是答案，我想我可以将其映射到快捷键，而不必离开 VS 进行构建）

还有其他建议吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-24T23:21:39.967

一种选择是使用您最喜欢的脚本语言创建几个脚本，并将它们添加到项目设置*的构建前和构建后事件中。*

现在，每次您运行构建时，脚本都会运行，您可以让脚本跟踪您需要的任何信息。

但很自然，这只会在*项目级别上*起作用，而不是自动在所有项目中起作用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T14:53:26.210

使用您的宏浏览器创建一个新的宏。打开新宏并编辑 EnvironmentEvents 模块（您可以将其他模块留空）。您可以使用数据库而不是文件。

```
Private BuildStopWatch As System.Diagnostics.Stopwatch = New System.Diagnostics.Stopwatch()

Private Sub BuildEvents_OnBuildBegin(ByVal Scope As EnvDTE.vsBuildScope, ByVal Action As EnvDTE.vsBuildAction) Handles BuildEvents.OnBuildBegin
    BuildStopWatch.Reset()
    BuildStopWatch.Start()
End Sub

Private Sub BuildEvents_OnBuildDone(ByVal Scope As EnvDTE.vsBuildScope, ByVal Action As EnvDTE.vsBuildAction) Handles BuildEvents.OnBuildDone
    BuildStopWatch.Stop()
    DTE.ToolWindows.OutputWindow.ActivePane.OutputString("Build succeed in " & BuildStopWatch.Elapsed.TotalSeconds & " seconds.")
    Dim fileName As String = "D:\BuildTimes.txt"
    Try
        Dim streamWriter As StreamWriter
        If File.Exists(fileName) Then
            streamWriter = File.AppendText(fileName)
        Else
            streamWriter = File.CreateText(fileName)
        End If

        streamWriter.WriteLine(DateTime.Now.ToString() & "    " & "Build Time:" & BuildStopWatch.Elapsed.TotalSeconds)
        streamWriter.Close()
        streamWriter.Dispose()
    Catch ex As Exception
        MsgBox(ex.Message)
    End Try
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T23:19:52.577

这可能有点矫枉过正，但您可以编写自己的日志记录实用程序来记录有关每个项目的构建的元数据。通过您的日志记录类跟踪当天的构建计数。

请参阅有关扩展 MSBuild 日志记录的链接和[有关](http://msdn.microsoft.com/en-us/library/ms171471.aspx)使用自定义任务扩展 MSBuild 的[链接。](http://msdn.microsoft.com/en-us/library/t9883dzc.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T23:22:22.383

如果您每次都构建同一个项目，您可以轻松编写一个小脚本在项目属性的“预构建任务”部分执行（单击“编译”选项卡底部的“构建事件”按钮）属性页）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T01:32:39.777

VS 仅允许您挂钩到项目级别的构建事件，因此如果这还不够，您可以使用构建脚本（MSBuild、NAnt 等）来构建解决方案，这将使您完全控制构建之前和/或之后发生的事情.

老实说，您将从本地计算机上的这些统计信息中获得什么好处？我们使用构建服务器 CCNET [http://ccnet.thoughtworks.com/来跟踪构建时间和单元测试时间，并在提交到我们的源代码控制 SVN](http://ccnet.thoughtworks.com/) [http://www.collab.net/downloads/subversion/](http://www.collab.net/downloads/subversion/)后触发我推荐这种方法来收集统计数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T19:54:57.500

确保您的 EnvironmentsEvents 模块导入 System.IO 命名空间，以便能够访问 StreamWriter 和 File 调用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-29T14:54:34.893

[http://www.codeproject.com/KB/macros/Increment_Build_Number.aspx](http://www.codeproject.com/KB/macros/Increment_Build_Number.aspx)

这对我有用，但请务必按​​照 Shawn 的建议在 EnvironmentsEvents 模块中导入 System.IO 命名空间。

# windows - wput 在 Windows 上忽略 --skip-existing

> ID：584061
> 
> 赞同：0
> 
> 时间：2009-02-24T23:11:10.257
> 
> 标签：windows, ftp, cmd

希望熟悉 Windows 上 wget 和 wput 的人知道这一点......

> wput -v --remove-source-files --skip-existing --dont-continue %stfile% [ftp://%ftpuser%:%ftppass%@%ftpserver%/inbound/%stfile%](ftp://%ftpuser%:%ftppass%@%ftpserver%/inbound/%stfile%)

基本上，如果文件已经存在于 ftp 站点上，这不应该*尝试*ftp 文件......但是文件不存在 - 并且它不会*传输*文件

--remove-source-files 就像是搬家一样，去掉还是不行--

如果文件在那里，它可以正常工作-

由于恢复/上传/跳过规则而跳过此文件。-- 跳过文件：%stfile% FINISHED --17:37:30-- 跳过 1 个文件。

这可能是一个错误，但谁知道......

wput 不像 wget 那样积极开发——

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T00:33:22.177

对我来说听起来像是一个错误，但它在 Ubuntu 9.04 上运行良好。奇怪的。

[在SourceForge](http://sourceforge.net/tracker/?group_id=141519&atid=749613)提交错误报告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-20T13:22:49.330

晚了几年，但可能会帮助别人......

尝试使用 -v -d 运行以获取更多信息

```
wput file.ext ftp://User:pass@domain/path -v -d 
```

你可能会发现它失败的原因是因为你使用一个空文件作为测试，在这种情况下你会看到这个

```
==> SIZE bob.txt ... ---->SIZE bob.txt
[550] 'File not found'
failed.
local_fsize: 0
target_fsize: 0
resume_table: 1,0,2
Skipping this file due to resume/upload/skip rules.
-- Skipping file: bob.txt
processing queue:
Connection ended. (14002c0)
Checking whether 332 is writable... 1 (0:No error)
---->QUIT
[221] 'Goodbye'
Closing socket 14002c0
FINISHED --15:17:16--
Skipped 1 file. 
```

这似乎意味着如果没有要清理的文件，它将拒绝复制 0 大小的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-08T12:36:05.387

我遇到了同样的问题，结果我不得不用`/`.

# xml - XSLT - 将逗号分隔的文本拆分和呈现为 HTML 的最佳方式

> ID：584082
> 
> 赞同：4
> 
> 时间：2009-02-24T23:16:03.133
> 
> 标签：xml, xslt

我在 XML 元素中有一些数据，如下所示：

```
<item value="category1,category2">Item Name</item> 
```

我感兴趣的是*value*属性。我能够将此属性中包含的数据获取到如下所示的模板中：

```
<xsl:template name="RenderValues">
    <xsl:param name="ValueList" />
    <xsl:value-of select="$ValueList" /> <!-- outputs category1,category2-->
</xsl:template> 
```

我想要做的是以有效的方式处理逗号分隔的值。从 RenderValues 模板中呈现类似以下内容的最佳方法是什么？

```
<a href="x.asp?item=category1">category1</a>
<a href="x.asp?item=category2">category2</a> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T00:37:47.460

**在[XSLT 2.0](http://www.w3.org/TR/xslt20/) / [XPath 2.0](http://www.w3.org/TR/xpath20/)中使用[标准 XPath 2.0 函数 tokenize()](http://www.w3.org/TR/xpath-functions/#func-tokenize)**。

**在[XSLT 1.0](http://www.w3.org/TR/xslt)**中，需要编写一个递归调用的模板，或者更方便的是，使用[**FXSL 库**](http://fxsl.sf.net)[**`str-split-to-words`**](http://fxsl.cvs.sourceforge.net/viewvc/fxsl/fxsl-xslt2/f/strSplit-to-Words.xsl?revision=1.2&view=markup)的函数/模板。[](http://fxsl.sf.net)

 ****这是后者的一个例子**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common"

>
<!--                                                 -->
   <xsl:import href="strSplit-to-Words.xsl"/>
<!--                                                 -->
   <xsl:output indent="yes" omit-xml-declaration="yes"/>
<!--                                                 -->
    <xsl:template match="/*">
      <xsl:variable name="vwordNodes">
        <xsl:call-template name="str-split-to-words">
          <xsl:with-param name="pStr" select="string(@value)"/>
          <xsl:with-param name="pDelimiters" 
                          select="', &#10;'"/>
        </xsl:call-template>
      </xsl:variable>
<!--                                                 -->
      <xsl:apply-templates select="ext:node-set($vwordNodes)/*"/>
    </xsl:template>
<!--                                                 -->
    <xsl:template match="word" priority="10">
      <a href="x.asp?item={.}"><xsl:value-of select="."/></a>
    </xsl:template>
<!--                                                 -->
</xsl:stylesheet> 
```

**当对提供的 XML 文档应用上述转换时**：

```
<item value="category1,category2">Item Name</item> 
```

**产生了想要的结果**：

```
<a href="x.asp?item=category1" xmlns:ext="http://exslt.org/common">category1</a>
<a href="x.asp?item=category2" xmlns:ext="http://exslt.org/common">category2</a> 
```

此模板的`pDelimiters`参数允许指定多个分隔符。在上面的示例中，任何分隔字符都可以是逗号、空格或换行符。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-24T23:26:22.593

您正在寻找[tokenize 功能](http://www.w3.org/TR/xpath-functions/#func-tokenize)：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:str="http://exslt.org/common">

<xsl:template match="/">
<xsl:variable name="sampleString">XML,XSLT,XPath,SVG,XPointer</xsl:variable>
<xsl:for-each select="str:tokenize($sampleString,',')">
    <a>
        <xsl:attribute name="href">
            <xsl:value-of select="str:concat('x.asp?item=', .)" />
        </xsl:attribute>
    <xsl:value-of select="."/>
    </a>
</xsl:for-each>
</xsl:template>

</xsl:stylesheet> 
```

[http://www.xml.com/pub/a/2003/05/07/tr.html](http://www.xml.com/pub/a/2003/05/07/tr.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T07:28:30.407

这是一个合理的问题，并且提供的答案很好。但是，如果您使用的是 XSLT 1.0，并且您不能使用扩展函数，那根本不可能。XSLT 模板产生结果树片段，而 XSLT 只能在节点集上工作。XSLT 中的标记化需要递归，这意味着调用模板，这意味着生成您无法处理的数据结构。

如果这个限制适用于你——实际上，即使它不适用——如果可能，你应该通过找到生成 XML 的人来解决这个问题，该人的内容必须在 DOM*已经解析后**再次*解析并让他或她的停止。在一个属性中放置多个值是完全错误的。

 *# php - 我需要一个用另一个标签替换一个标签的 php 正则表达式

> ID：584085
> 
> 赞同：1
> 
> 时间：2009-02-24T23:18:22.673
> 
> 标签：php, html, regex, html-manipulation

这是我需要能够做的事情：

我需要匹配以下标签：

```
<SPAN style="TEXT-DECORATION: underline">text sample</SPAN> 
```

我需要用符合 html3 的标签替换跨度，但将文本保留在两者之间。替换后的最终标签应如下所示：

```
<u>text sample</u> 
```

我只是不擅长正则表达式，似乎无法想出答案。

先感谢您。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T23:26:19.037

**正则表达式不是为标签操作而设计的。**

如果你有任何形式的嵌套，它会变得混乱。

但是，鉴于提供的非常简单的示例，您也许可以这样做：

```
$MyString = preg_replace
    ( '/(?si)<SPAN\s+style\s*=\s*"TEXT-DECORATION:\s*underline;?"\s*>(.*?)<\/SPAN>/'
    , '<u>$1</u>'
    , $MyString
    ); 
```

但这在很多方面都存在缺陷，您最好使用专为操作标签而设计的工具。

**查看[DOMDocument->loadHTML()](http://www.phpbuilder.com/manual/en/function.dom-domdocument-loadhtml.php)和[相关函数](http://phpbuilder.com/manual/en/class.domdocument.php)。**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-25T07:07:50.673

不要使用正则表达式来解析 HTML

[**不要使用正则表达式来解析 HTML**](http://wiki.tcl.tk/4164)

*不要使用正则表达式来解析 HTML*

[***不要使用正则表达式来解析 HTML***](http://www.codinghorror.com/blog/archives/001016.html)

[不要使用正则表达式来解析 HTML](http://blog.mikeseth.com/index.php?/archives/1-For-the-2,295,485th-time-DO-NOT-PARSE-HTML-WITH-REGULAR-EXPRESSIONS.html)

[不要使用正则表达式来解析 HTML](http://kore-nordmann.de/blog/do_NOT_parse_using_regexp.html)

您需要更多说明吗？

使用 DomDocument::LoadFromHTML ;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T23:22:41.010

你需要几行这样的：

```
preg_replace('|<SPAN style="TEXT-DECORATION: underline">(.+?)</SPAN>|', '<u>$1</u>', $text);
preg_replace('|<SPAN style="FONT-WEIGHT: bold">(.+?)</SPAN>|', '<b>$1</b>', $text);
preg_replace('|<SPAN style="FONT-STYLE: italic">(.+?)</SPAN>|', '<i>$1</i>', $text); 
```

等等。尽管如果标签有可能与那些正则表达式不*完全*匹配（通常是这种情况，除了非常简单的机器生成的 HTML），使用正则表达式执行此操作会变得非常复杂，而且你会更好关闭使用某种解析器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T23:30:31.413

对于您给出的基本示例。

```
<?php 
$string = '<SPAN style="TEXT-DECORATION: underline">text sample</SPAN>';
$pattern = '/<SPAN style=\"TEXT-DECORATION: underline\">(.+?)<\/SPAN>/';
$replacement = '<u>$1</u>'
echo preg_replace($pattern,$replacement,$string);
?> 
```

会成功的。模式正则表达式非常简单 - 这正是您正在寻找的内容（带有引号和“/”转义），带有 (.+?) 表示包含所有可能的字符，直到 SPAN 标记结束。这假设您的代码格式一致，您可以在 $pattern 的末尾附加一个“i”以使其不区分大小写。

请注意，这并不是真正的正确方法。

# .net - 如何将生成的方法标记为过时？

> ID：584102
> 
> 赞同：4
> 
> 时间：2009-02-24T23:23:23.520
> 
> 标签：.net, ado.net, attributes, warnings

我正在使用**强类型`DataSet`**，手动添加行将容易出错。我正在提供**工厂方法**来正确创建行。我想引导我的类的消费者远离类上生成的`Add*Row`方法`*Table`。

**将[Obsolete 属性](http://dotnettipoftheday.org/tips/ObsoleteAttribute.aspx)添加到生成的方法**中就可以了。遗憾的是，它们将在下次生成代码时被删除。

我不能在非生成代码中使用**[部分方法，因为 VS2008 DataSet 设计器不使用它们。](http://msdn.microsoft.com/en-us/library/bb546176.aspx)**

`MyType.Dataset.Designer.cs`看起来有点像这样：

```
public partial class ThingyDataTable : global::System.Data.DataTable, global::System.Collections.IEnumerable {
    // I'd love an [Obsolete("Please use the factory method.")] here.
    // I can't use a partial method, as this method isn't partial. 
    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
    public ShelfRow NewShelfRow()  
        return ((ShelfRow)(this.NewRow()));
    }
 } 
```

有什么方法可以添加`Obsolete`属性`MyType.cs`吗？尝试 C 风格的原型是行不通的，因为成员已经定义。插入`partial`不起作用，因为生成的成员不是`partial`.

```
// BROKEN EXAMPLE:
public partial class ThingyDataTable {
    // I'd love an [Obsolete("Please use the factory method.")] here.
    // I can't use a partial method, as this method isn't partial. 
    [Obsolete("Please use the factory method.")]
    public ShelfRow NewShelfRow(); // ERROR: member already defined.
} 
```

还有其他方法可以**标记生成的方法`Obsolete`吗？**

我还能如何**警告消费者**远离生成的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T02:48:56.210

用于从 XSD 文件生成设计器文件的自定义工具并没有太多开箱即用的可配置性。

但是您可以：

*   从键入数据集的 xsd 文件的“属性”对话框中将其删除，即将“MSDataSetGenerator”中的“自定义工具”字段设置为空。这样，您可以控制何时生成代码。但这很容易出错，因为您将来可能会忘记这样做......
*   您可以创建自己的自定义工具来调用 xsd.exe 工具，并将所需的属性放置在适当的位置，但这意味着您在所有开发站上安装自定义工具并构建服务器。（请参阅[此帖子](http://www.drewnoakes.com/snippets/WritingACustomCodeGeneratorToolForVisualStudio/)以获取指针）
*   或者，最后，您可以强制代码生成器创建 DataSet 的内部实现，并让这些类实现一组您可以允许客户使用的公共接口。您的数据集类将不能直接在程序集之外的任何地方使用，但您的接口可以。

后者不那么“自动化”，因为您需要在界面中反映 DataSet 模式的变化，但您可以控制一切并且更加“工厂友好”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T21:23:09.083

另一种选择是使用 PostSharp 1.5 和新的 CustomAttributeInjector 方面（参见[在线文档](http://doc.postsharp.org/1.5/ClassRef/html/e17917d2-bc7a-617a-c0a9-7a6aa5865011.htm)）。

基本上，制作一个 CompoundAspect，然后将一个 CustomAttributeInjectorAspect 添加到您想要的任何东西上。这应该有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-09T16:40:12.763

`new`在非生成的部分类中使用关键字：

```
public partial interface ICaseRepository
    : IRepository<Case>
{
    void Delete(int id);

    [Obsolete("Use Delete(int id) instead.")]
    new void Delete(Case entity);
} 
```

这将允许生成方法的所有当前用法生成编译时警告。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T03:44:52.673

它是生成的代码，对。没有什么能阻止您将生成器的输出用作另一个生成器的输入，该生成器会为您添加 [Obsolete] 属性。

# unix - 为什么 NFS 默认使用 UDP？

> ID：584112
> 
> 赞同：28
> 
> 时间：2009-02-24T23:27:15.617
> 
> 标签：unix, networking, rpc, nfs

我敢肯定它有一些古老的遗产原因，但它是什么？这似乎是一种面向可靠数据传输的服务。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-24T23:35:31.790

*   NFS 最初设计用于丢失率非常低的 LAN。
*   UDP速度更快，开销更少
*   NFS 是无状态的，因此客户端重试很简单

请注意，NFS v3+ 可以使用 TCP。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-24T23:35:30.527

UDP 是 NFSv2 的默认设置（现在应该没人真正使用它），但 NFSv3 默认使用 TCP。TCP 挂载更可靠，并且您知道您遇到网络问题的速度比使用 UDP 快得多。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-15T09:52:02.360

UDP 是无状态的，TCP 不是，但 TCP 有许多不适合 NFS 的预定义属性，或者更确切地说，NFS 想要控制细节。特别是，当 TCP 进行数据包传输时，它确实控制超时等。

使用 UDP，您将失去您并不特别想要的开销。当 NFS 文件系统，最初的想法是，系统进行写入，如果它只完成一半，那将是糟糕的......所以 NFS（在硬模式下）将继续重试以永远完成事务，1 分钟， 5、10、小时、一天……当连接恢复时，交易可以继续完成……

现在往往会有更多的人更迅速地修复所有问题。还有每个结束来回传递会话对象而不是在工作之间提交的想法，直到双方同意他们已经完成 - 回到那天 NFS 为你做了很多......

这个类比有点类似于 RS232 的工作方式......电子设备会做它的事情并加载他们的缓冲区，并且会变满并不得不停止（或丢失信息），他们可以传递该信息流（并清空他们的缓冲区和继续）当 CTS（清除发送引脚-如插头上的金属引脚）高或低（无论它应该是什么）时。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-02-19T05:42:32.083

UDP was also used because it could greatly reduce the memory usage. In the 1980s when NFS was originally developed, you'd have a UNIX system with like 4-8MB of RAM, and (at least in academic environment) the "server" may have simply been one of these 4-8MB systems with a few extra disks hooked up to it. RAM use on the server was a big concern, you could have lost several MBs to TCP buffers that my have been better used as disk cache. It also made it easy to handle memory pressure, an overtaxed NFS server could simply drop requests.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T23:32:50.237

当协议将由应用程序本身管理时使用 UDP。该应用程序可能对如何执行此操作有更好的想法，或者它可能更快（在应用程序的特殊条件下）。TCP 非常好，但有很多与之相关的开销。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T23:33:33.277

表现。UDP 的开销比 TCP 低得多。另一方面，NFS 必须自己处理可靠的传输（与 TCP 相比），但由于这是一种用于连接问题和包丢失（或更好：应该）不是问题的 LAN 协议，因此它针对性能进行了优化。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T23:34:06.583

我的猜测是，这可能是由于遗留（历史）原因。最初 NFS 可能用于低延迟网络，其中出错的可能性很小，因此启动 3 次握手以建立 TCP 连接（连同所有消息的双向确认）的开销超过了使用像UDP这样的无连接协议。

当 UDP 用作传输协议时，可能需要 NFS 客户端来管理重传。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T05:15:21.527

无状态 UDP 连接将网络流量降至最低，因为 NFS 服务器在客户端被授权访问共享卷后向客户端发送 cookie。此 cookie 是存储在服务器端的随机值，并与来自客户端的 RPC 请求一起传递。

# vb.net - 自定义向导控件

> ID：584115
> 
> 赞同：1
> 
> 时间：2009-02-24T23:28:02.790
> 
> 标签：vb.net, windows, winforms, user-controls

我必须在 VB.NET 中为 Windows 窗体项目构建自定义向导控件。由于围绕版权的一些模糊逻辑，我“不允许”使用互联网上现有的向导控件。我没有“被允许”在软件中使用用户控件。

有谁知道我应该从哪里开始？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T15:01:53.967

在我的工作中，我们为向导的每个步骤使用面板实现了一个向导。为了方便使用面板，我们将每个面板的大小缩小为一个小正方形，并将它们并排放置在包含控件中，因此当我们想要编辑面板时，我们单击相应的正方形，并将停靠属性设置为填。完成后，我们将停靠属性设置为 none，控件返回到它的小方形尺寸。

以编程方式，您可以执行类似的操作来显示当前步骤的好面板。单击“下一步”按钮时，隐藏并取消停靠前一个面板，然后显示并停靠当前面板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T18:23:45.290

TabControl 是设计器中非常方便的控件。在运行时更改标签页也很容易，只需设置 SelectedIndex 或 SelectedTab 属性。你只需要摆脱标签。幸运的是，这很容易。向您的项目添加一个新类并粘贴如下所示的代码。建造。将新控件从工具箱顶部拖放到表单上。

```
Public Class WizardPages
    Inherits TabControl
    Protected Overrides Sub WndProc(ByRef m As Message)
        '--- Hide tabs by trapping the TCM_ADJUSTRECT message
        If m.Msg = &H1328 AndAlso Not DesignMode Then
            m.Result = CType(1, IntPtr)
        Else
            MyBase.WndProc(m)
        End If
    End Sub
End Class 
```

# c++builder - 如何在 Borland C++ 中禁用主窗体的关闭

> ID：584119
> 
> 赞同：3
> 
> 时间：2009-02-24T23:30:14.470
> 
> 标签：c++builder, vcl

```
在关闭按钮上关闭应用程序时（调用 FormClose 处理程序），
如果用户确定要关闭应用程序，则会出现一个对话框。
如果对话框的结果是 mrCancel，那么我尝试设置 ModalResult
mrNone 的主要形式，就像我对其他形式所做的那样，但即使，
应用程序仍然关闭。

解决办法是什么？

干杯。

```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T23:39:41.233

在表单中`FormCloseQuery`，设置`CanClose`为 false。

# python - tkinter - 设置几何而不显示窗口

> ID：584127
> 
> 赞同：2
> 
> 时间：2009-02-24T23:32:56.803
> 
> 标签：python, tkinter

我正在尝试排列一些标签和画布小部件。为此，我需要知道我的标签框有多宽。如果用户更改系统字体大小，我希望我的小部件能够自动调整，所以我不想硬编码每个字符 12 个像素。如果我测量标签小部件，它总是 1 像素宽。在我调用 .update() 之前，我会得到正确的值。但是 .update() 会在屏幕上放置一个带有我标签的窗口，当我最终打包最终的小部件时，所说的窗口就会消失。但是，当我第一次放置小部件时，这会导致不受欢迎的闪光。

那么，如何在没有 .update() 的情况下测量标签小部件？或者我怎样才能 .update() 一个小部件而不让它显示在屏幕上？如果重要的话，我正在使用 Python。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T12:32:15.947

在调用更新之前撤消窗口。你想要的命令是 wm_withdraw

```
root = Tk()
root.wm_withdraw()
<your code here>
root.wm_deiconify() 
```

但是，如果您真正的问题是排列小部件，您通常不需要知道小部件的大小。使用网格几何管理器。拿出一张方格纸，把你的小部件放在上面。随意为每个小部件跨越尽可能多的正方形。然后，该设计可以轻松转换为一系列网格调用。

# c# - 你应该在 C# 中使用指针（不安全代码）吗？

> ID：584134
> 
> 赞同：46
> 
> 时间：2009-02-24T23:35:40.463
> 
> 标签：c#, .net, pointers, coding-style, unsafe

您应该在 C# 代码中使用指针吗？有什么好处？是 The Man (Microsoft) 推荐的吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-24T23:43:50.897

来自“男人”本人：

在 C# 中很少需要使用指针，但在某些情况下需要它们。例如，以下情况需要使用不安全的上下文来允许指针：

*   处理磁盘上的现有结构
*   涉及带有指针的结构的高级 COM 或平台调用方案
*   性能关键代码

不鼓励在其他情况下使用不安全的上下文。

**具体来说，不应该使用不安全的上下文来尝试在 C# 中编写 C 代码。**

警告：

使用不安全上下文编写的代码无法验证是否安全，因此只有在代码完全受信任时才会执行。换句话说，不安全的代码不能在不受信任的环境中执行。例如，您不能直接从 Internet 运行不安全的代码。

[参考](http://msdn.microsoft.com/en-us/library/aa288474(VS.71).aspx)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-02-24T23:42:10.933

如果你必须。

假设您需要对大型灰度图像（例如 2000x2000 像素）进行伪着色。`GetPixel()`首先使用and编写“安全”版本`SetPixel()`。如果这行得通，那太好了，继续前进。如果这被证明太慢，您可能需要获取构成图像的实际位（为了示例而忘记颜色矩阵）。使用不安全代码并没有什么“坏处”，但它增加了项目的复杂性，因此只应在必要时使用。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-24T23:40:17.677

我不记得曾经这样做过——但我没有做过太多的互操作。我相信这是最常见的应用程序：调用本机代码。很少有使用指针可以优化一些代码的情况，但在我的经验中这种情况很少见。

如果它是任何指南，我认为自己在 C# 方面非常有经验，但如果我不得不做任何不安全的代码，我必须查阅规范/书籍/MSDN 来指导我。当然会有很多人对不安全的代码感到满意，但对（比如说）查询表达式不太熟悉......

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-25T00:07:40.963

我想说的主要问题是：-

*   不安全的代码是不可验证的。这意味着代码*只能*由用户从完全受信任的上下文中运行，因此，如果您需要用户从不完全受信任的任何地方运行代码（例如，未配置为这样的网络共享），您就是搞砸了。
*   缺乏可验证性（嗯，不确定这是否真的是一个词）也意味着您可能*会*弄乱程序中的内存。您*可能*会将整个类的错误带回您的应用程序 - 缓冲区溢出、悬空指针、yada yada yuck yuck 。更不用说可能会破坏内存中的数据结构而没有意识到指针何时变得奇怪。
*   如果您希望不安全的代码访问托管对象，则需要“固定”它们。这意味着 GC 不允许在内存中移动您的对象，因此托管堆可能会变得碎片化。这对性能有影响；因此，确定此问题是否超过了任何潜在的性能增益总是很重要的。
*   对于不习惯非托管方法的程序员来说，您的代码变得更难理解。然后，他们可能更容易因不安全代码给他们的一些“自由”而大发雷霆。
*   您可以编写非类型安全的代码；这实际上消除了一个很好的温暖模糊管理语言的许多优势。现在你可能会遇到可怕的类型安全问题。为什么要退后一步？
*   它使您的代码*更丑陋*。

我敢肯定还有更多可以添加到列表中；一般来说，正如其他人所说 - 避免，除非你必须通过 p/invoke 调用非托管方法，这需要一些特殊的指针 funking。即使那样，编组器也将主要阻止对它的需要。

“男人”也说除非必要，否则基本上避免。

哦，顺便说一句，关于固定[在 MSDN 上](http://msdn.microsoft.com/en-us/magazine/cc163910.aspx)的好文章。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-24T23:41:51.633

[不安全代码](http://msdn.microsoft.com/en-us/library/t2yzs44b(VS.80).aspx)是 .NET CLR 完全支持的功能。好处是性能和与二进制代码的兼容性。运行时是一个沙箱，可以防止您崩溃和烧毁，但这是有代价的。在您对内存中的大块执行极其密集的操作（例如图像处理）的情况下，跳出运行时提供的正常安全性会更快。

话虽如此，我想这里的*大多数*人都会说“不要这样做”。绝大多数.NET 开发人员在他们的正常活动中不会遇到只能通过使用不安全代码来解决的案例。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-24T23:42:44.300

我使用了不安全的代码来使用模拟来允许服务访问网络共享。如果您知道自己在做什么，这不是问题。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-24T23:40:35.583

如果需要，您应该使用它们；这主要是在处理一些棘手的互操作场景时（例如，当我在 .NET 1.0 中为 DPAPI 编写托管包装器时需要它们），但偶尔可能是通过使用`stackalloc`或类似来提高性能（在分析之后！）。

微软尽可能多地推荐它，因为他们是 C# 的设计者，他们决定添加在其中编写`unsafe`代码的功能。您可以从关键字的选择以及使用关键字来描述您编写它的方法/类的要求中看到，它并非旨在成为事实上的实现选择。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-25T00:03:21.723

BitConverter 不提供类似转换的重新解释。
专门将 unint 转换为 int 用于散列函数，您只关心位。

在结构上使用一些有用的、有充分理由的关于 c 或 C++ 惯用函数，您需要将它们视为已知长度的字节*，这对于散列也是最有用的。

内存结构中（非常具体）的极快二进制序列化（通过对它们的数组进行）虽然老实说，这最好通过直接使用 C++/CLI 来完成。

必须说，在许多情况下，需要指针的任务通常可以通过在 C++/CLI 中执行，然后将其作为 dll 导入到您的 c# 项目中来更好地解决。它不会改变代码是否“安全”，但它使一堆有用的函数更容易访问基于指针的结构。如果你真的想的话，它还允许你弄乱泛型类型或枚举。

大多数开发人员需要这样做的可能性确实很小。不过在你需要的时候很有用...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-24T23:41:13.120

当然它不是“推荐的”，这就是为什么它被标记为“不安全”的原因。但不要让那把你吓跑。虽然，它应该让你看两次你的代码。也许有一种管理方法可以做到这一点？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-24T23:44:36.667

使用不安全代码就像忘记了 .Net 框架的好处，我曾经用它们来创建像堆栈和其他东西这样的老式结构，但这只是用于学校，现在我不需要使用它们。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-24T23:59:29.127

如果它使您的代码更短更清晰，请执行此操作。

“按照你的喜好，适当考虑拐角处的警察。” [WSM](http://en.wikiquote.org/wiki/W._Somerset_Maugham)

# silverlight - 在数据网格中动态创建列

> ID：584136
> 
> 赞同：0
> 
> 时间：2009-02-24T23:36:36.017
> 
> 标签：silverlight

我正在尝试创建一个具有可变数量的列和行的数据网格。我可以创建列，但我不知道如何插入内容。

```
_dataGrid.Columns.Add(new DataGridTextColumn { Header = "Column 0",
                                                            Binding = new Binding("0")

                                                            }
                                  ); 
```

我有所有要添加到字符串 [,] 中的数据。我不明白如何准备一个实现 IEnumerable 的数据结构，以便我可以设置

```
_dataGrid.ItemsSource = GenerateData();//I'd expect to return a Dictionary["0"]=List<string>(){"1","2","3"} to bind to but it doesn't work 
```

如果我想包含一个具有“1”、“2”、“3”的列，我需要从 GenerateData 返回什么数据结构？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-10T01:54:02.840

ItemSource 实际上可以是任何东西...我在下面演示了一组匿名类型，但是如果您想要 2 路数据绑定，则必须使用命名类型（匿名类型生成 1 路绑定）

```
grid.Columns.Add(new DataGridTextColumn { 
    Header = "Foo",
    Binding = new Binding("Foo")
});

grid.Columns.Add(new DataGridTextColumn { 
    Header = "Bar",
    Binding = new Binding("Bar")
});

grid.ItemsSource = new [] {
   new { Foo = "asdf", Bar = "asdf" },
   new { Foo = "asdf", Bar = "asdf" },
   new { Foo = "asdf", Bar = "asdf" }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T09:24:10.300

我昨晚打了这个，我想手动将内容添加到不同的行和单元格等。

您可以通过以下方式以编程方式执行此操作：

```
Grid.SetRow(myUserControl, 1);
Grid.SetColumn(myUserControl, 1);

myGrid.Children.Add(myUserControl); 
```

它确实完全绕过了数据绑定模型，但有时这正是您所需要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-10T01:16:32.120

归根结底，ItemsSource 只需要是实现 IEnumerable 的对象即可。构成集合的对象必须具有与您在列上设置的绑定相匹配的属性。DataTable 可能是最自然的开始。

# javascript - jquery的问题：不是选择器

> ID：584137
> 
> 赞同：0
> 
> 时间：2009-02-24T23:37:36.840
> 
> 标签：javascript, jquery

我在尝试不选择具有以下功能的表行时遇到问题：

```
$("tr").click(function(e) {
 var row = jQuery(this)
//rest of code left off 
}); 
```

基本上，它会找到所有表格行并添加单击功能，该功能将打开一个编辑模式，该模式具有一行文本框，其中填充有来自表格单元格的信息。问题是模式中的表格也获得了功能，所以当用户去编辑文本框中的值时，所有的值都会消失......

所以我一直在尝试和失败的是通过使用以下几种方式通过 id 过滤 tr：

```
$("tr").not('trEdit').click(function(e) {
            var row = jQuery(this) 
```

和

```
$("tr not:'trEdit').click(function(e) {
            var row = jQuery(this) 
```

我也尝试过尝试第二个表，然后不选择它的表行，但是这些表不是彼此相邻的&我的例子是......不，我还没有尝试过 table[1] tr(现在想起来了）...

请帮忙...我要疯了，想弄清楚这个..

谢谢！！！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T23:48:53.583

语法是`$("tr:not(.trEdit)")`或`$("tr :not(.trEdit)")`- 取决于 trEdit 类是否适用于 tr 或子元素。

但是，我认为您的问题可能与**事件冒泡**有关 - 您必须搜索有关该问题的详细信息，或者等待其他人扩展答案，因为我现在必须去。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T23:51:55.573

您的问题是您的*非*过滤器中的“trEdit”应该是“.trEdit”或“#trEdit”，具体取决于您要做什么（注意点和哈希）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T23:44:32.847

我从来没有使用过 ':not' 语法，但下面的内容应该可以为您提供此示例所需的内容：

```
$("tr[id!='trEdit']").click(function(e) {
    var row = jQuery(this) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T00:15:01.180

你能这样实现吗？这会让你的意图更加清晰。

```
$("#theClickableTable tr").click(function() {
    ...
}) 
```

# c - read() 和 fread() 有什么区别？

> ID：584142
> 
> 赞同：65
> 
> 时间：2009-02-24T23:40:16.927
> 
> 标签：c, file, file-io

我正在阅读 linux 工具[badblocks](http://e2fsprogs.sourceforge.net/)的源代码。他们在`read()`那里使用该功能。`fread()`与标准 C函数有区别吗？（我没有将论点视为差异。）

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-02-24T23:43:30.930

`read()`是低级别的无缓冲读取。它在 UNIX 上进行直接系统调用。

`fread()`是 C 库的一部分，并提供缓冲读取。它通常通过调用`read()`以填充其缓冲区来实现。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-02-25T11:06:19.650

家庭`read()`-> *`open`, `close`, `read`,`write`*
家庭`fread()`-> *`fopen`, `fclose`, `fread`,`fwrite`*

## 家人朗读：

*   是系统调用
*   未格式化的 IO：我们有一个未格式化的字节流

## 家庭恐惧症

*   是标准 C 库 (libc) 的函数
*   使用内部缓冲区
*   其中一些是格式化的 IO（带有“%..”参数）
*   始终使用 Linux 缓冲区缓存

更多细节[在这里](http://www.velocityreviews.com/forums/t437072-read-vs-fread.html)，虽然请注意这篇文章包含一些不正确的信息。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-24T23:43:43.893

我记得它的`read()`级别 API 不做缓冲 - 所以如果你`read()`一次 1 个字节，与使用`fread()`. `fread()`当你要求它时，它会拉出一个块并分发出去。 `read()`每次调用都会掉入内核。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-24T23:43:15.657

`read`是一个系统调用，而`fread`是 C 标准库中的一个函数。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-03-08T17:12:11.637

如果您将使用一种的代码转换为使用另一种的代码，您应该注意一个区别：

*   `fread`阻塞，直到您请求的字节数已被读取，或文件结束，或发生错误。
*   `read`也会阻塞，但如果你要求说 4kB，它可能会在读取 1kB 后返回，即使文件还没有结束。

这可能会导致细微的错误，因为它取决于文件的存储位置、缓存等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-12-05T12:27:52.643

read() --> 直接使用这个系统调用内核并执行 IO 操作。

fread() --> 是标准库中提供的函数。

调用`fread()`主要用于存储结构数据的二进制文件数据。这两者之间的主要区别在于应用程序中系统调用的数量。

这种`fread()`标准 IO 库函数针对系统调用进行了优化，而不是您的应用程序进行系统调用。

# c# - VLC 服务器与 .NET C# 的通信

> ID：584147
> 
> 赞同：3
> 
> 时间：2009-02-24T23:41:20.637
> 
> 标签：c#, .net, video-streaming, vlc

我正在开发一个允许视频流或视频点播的项目。我一直在寻找软件包，VLC 看起来是满足低成本需求的绝佳选择。

为了真正使用这个应用程序，我需要一个可以与系统通信的 API。在做了一些研究之后，有一些通过 PHP 和 Java 进行的绑定，但没有什么是真正的 .NET。我进一步看了看，发现我可以通过 telnet 进行通信，这对于我需要的工作来说是可行的。

我开始从事该项目，但首先进行了手动工作流测试，因为我创建的 API 稍后将是自动化的。我能够启动 VLC，但很难让它播放流媒体以及激活 telnet 会话。这是在阅读了文档中的示例之后，这些示例似乎不再起作用或以不同的方式工作，因此我认为该资源不可靠。

是否有任何使用当前 0.9.8 版本的 VLC 的示例，这些示例实际上具有有效的通信示例？此外，是否有任何我可以用来与 .NET 与 VLC 通信的绑定，而这些绑定可能只是我在互联网上无法找到的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T21:13:18.410

看起来[vlcremote](http://vlcremote.sourceforge.net/)将是一个很好的起点，它是用 C# 编写的。

# .net - 当控件增长时，如何使表单垂直和水平调整大小？

> ID：584151
> 
> 赞同：4
> 
> 时间：2009-02-24T23:42:29.653
> 
> 标签：.net, winforms, layout, resize

(WinForms .net 2.0)

我正在制作一个表单，它与 standard 非常相似`MessageBox`，上面有一个标签，如果标签上的文本增长，它应该水平和垂直增长。`AutoSize = true`通过在标签和表单上进行设置，水平似乎很容易。但是，我也想让标签垂直增长，即如果它有换行符，但这似乎并不那么简单。我确定是这样，但是需要什么设置才能使标签和表单垂直增长？我的标签设置为`Anchor = top, left, right, bottom`，所以我认为当在标签中设置带有换行符的文本时，标签的高度会增加，因为`Anchor = top & bottom`它会强制表单增加高度。这似乎不会发生。我错过了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-24T23:51:39.707

设置`Autosize=True`并`AutoSizeMode=GrowAndShrink`在表格上。还要确保您的控件将根据其内容自动调整大小，并且不要锚定到所有四个侧面。

# msdn - MSDN 订阅的 Windows 服务器环境限制是多少？

> ID：584162
> 
> 赞同：2
> 
> 时间：2009-02-24T23:47:15.507
> 
> 标签：msdn

我们是内容管理集成商。我们希望为我们所做的每个 .Net 项目设置不同的 VM。我们可能每年需要 20 个，也许 30 个。

MSDN Professional 许可证是否允许这样做？到目前为止，我已经看到*了如此多*相互矛盾的信息，以至于我头晕目眩。（我不敢相信有大量相互矛盾的信息——其中很多都在微软自己的网站上。）

在一个完美的世界里，我们可以在不同的虚拟机上安装无限的 Windows 服务器环境用于开发目的。这些不是生产环境——每个都将单独用于一个客户的 CM 集成项目。

两个问题——

我会在 Windows 开发环境的某个时候达到限制吗？

客户端应用程序是否不同？我有一群人在 Mac 上，他们都需要在他们的 VM 上安装 Windows 才能在 IE6/7 中进行测试。我们可以为此在所有这些虚拟机上安装 Windows 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T23:55:16.080

[http://msdn.microsoft.com/en-us/subscriptions/subscriptionschart.aspx](http://msdn.microsoft.com/en-us/subscriptions/subscriptionschart.aspx)

简短的回答：这取决于您的订阅级别。

基本订阅只为您提供大多数产品的一个许可证密钥，它只允许一次安装。听起来您需要购买[批量许可证](http://msdn.microsoft.com/en-us/subscriptions/aa948867.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T08:22:36.280

Microsoft 许可非常复杂，但在此区分三件事很重要：

1.  安装介质，
2.  产品密钥，以及
3.  许可证。

第三个（许可证）当然是最模糊的，但是我阅读最新的 MSDN 订阅许可条款并没有发现对可以使用多少 VM 的任何限制，只要您将它们用于开发目的，例如您提到。

一个非常重要的补充是 MSDN 订阅仅授权给一位开发人员使用。您需要为使用 MSDN 资源进行开发的每个开发人员单独订阅。

最后，当在 Virtual PC 中安装映像时（可能与 Virtual Server 类似），我发现如果我准备并激活一个映像，然后为我需要的每个单独的 VM 实例复制该激活的基本映像一次，我只有无论我制作了多少份，第一次激活。这样可以更轻松地避免运行超过适用于大多数 MSDN 产品密钥的 10 台计算机激活限制。虽然如果我拨打激活热线并合理解释为什么我的全部用完，我从来没有机会让微软提高我的限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T23:50:51.363

有时很难理解 Microsoft 许可。我建议你打电话给他们——当你登录到 MSDN 订阅者网站时应该有一个联系号码。但是，我个人的理解是，出于开发目的，您可以根据需要安装任意数量的服务器。桌面操作系统（被）限制为 10 种不同的安装。我不知道VM的限制。同样，遵守规定的最佳选择是打电话给他们。

# javascript - 最佳实践 javascript代码

> ID：584165
> 
> 赞同：0
> 
> 时间：2009-02-24T23:47:57.797
> 
> 标签：javascript, jquery, html, open-source, couchdb

我正在开始一个项目，我需要在她的博客上展示我妻子的图画书。我在数据库 - couchdb 上获得了书籍的数据，并且我想编写一个她可以轻松嵌入到她的博客中的*播放器。*我的大部分播放器都是用 Html、JavaScript 和 jQuery 编写的。

接下来，我需要编写 html 和 javascript 代码来封装我的播放器，以便它可以轻松安全地嵌入到任何 html 文档中。当然，这是我第一次这样做。

有小费吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T23:57:42.253

您是否从您的 javascript 向另一个域发出任何 http 请求？如果是这样，您将需要使用 IFrame，因为您无法使用 javascript 进行跨域请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-09T02:13:56.823

如果它是跨域的，那么您需要的是一个可以完成工作的可嵌入脚本标签。

有关可以跨域边界获取数据的一种方式的示例，请参阅 JSONP。

[http://remysharp.com/2007/10/08/what-is-jsonp/](http://remysharp.com/2007/10/08/what-is-jsonp/) [http://bob.pythonmac.org/archives/2005/12/05/remote-json-jsonp/](http://bob.pythonmac.org/archives/2005/12/05/remote-json-jsonp/)

iGoogle 小部件等成功地使用了这种方法。

# asp.net-ajax - ASP.NET：UpdatePanel 外的按钮无法回发

> ID：584170
> 
> 赞同：0
> 
> 时间：2009-02-24T23:49:21.227
> 
> 标签：asp.net-ajax, button, drop-down-menu, updatepanel

I have a donation form that contains an update panel that contains a dropdown for predetermined amounts plus the "Other" option". When "Other" is selected the dropdown has triggered the partial postback and renders the update panel with the additional "Other" textbox金额。在这个更新面板之外，我有一个额外的服务器控制表单字段，例如文本框和一个提交按钮。

我遇到的错误是选择“其他”时，按钮“onclick”事件无法启动完整的回发。

例子：

```
<asp:UpdatePanel ID="updatePanelAmount" runat="server">
    <ContentTemplate>
        <table style="width: 500px;">
        <tbody>
        <tr>
            <th style="width: 200px;"><asp:Label ID="lblAmount" runat="server" CssClass="required" Text="Donation Amount: " /></th>
            <td>
                <asp:DropDownList ID="selAmount" runat="server" />
                <asp:CustomValidator ID="valDonationAmount" runat="server" ControlToValidate="selAmount" ErrorMessage="Donation Amount" Display="None" />
            </td>
        </tr>
        </tbody>
        </table>        
        <asp:Panel ID="panelOther" runat="server" Visible="false">
            <table style="width: 500px;">
            <tbody>
            <tr>
                <th style="width: 200px;"><asp:Label ID="lblOther" runat="server" Text="Other Amount: " /></th>
                <td>
                    $<asp:TextBox ID="txtOther" runat="server" />
                    <asp:RequiredFieldValidator ID="valOther" runat="server" ControlToValidate="txtOther" Display="None" ErrorMessage="Other Amount" Enabled="false" />
                    <asp:RegularExpressionValidator ID="valOtherExpress" runat="server" ControlToValidate="txtOther" Display="None" ErrorMessage="Other Amount: Invalid" ValidationExpression="[1-9][0-9]+(\.[0-9]{2})?" Enabled="false" />
                </td>
            </tr>
            </tbody>
            </table>
        </asp:Panel>                
    </ContentTemplate>           
</asp:UpdatePanel>    
<ctl:CreditCardForm ID="ctlCreditCardForm" runat="server" />
<asp:Button ID="btnSubmit" runat="server" Text="Donate" /> 
```

编辑：发布代码隐藏可能会让每个人都更容易

```
public partial class _Default : System.Web.UI.Page
{
    private ArrayList _donations;

    protected void Page_Init(object sender, EventArgs e)
    {
        valDonationAmount.ServerValidate += new ServerValidateEventHandler(valDonationAmount_ServerValidate);        
        selAmount.AutoPostBack = true;
        selAmount.SelectedIndexChanged += new EventHandler(selAmount_SelectedIndexChanged);
        updatePanelAmount.UpdateMode = UpdatePanelUpdateMode.Conditional;
        updatePanelAmount.ChildrenAsTriggers = true;
        btnSubmit.Click += new EventHandler(btnSubmit_Click);
    }

    void selAmount_SelectedIndexChanged(object sender, EventArgs e)
    {
        if (selAmount.SelectedItem.Text == "Other")
        {
            panelOther.Visible = true;
            valOther.Enabled = true;
            valOtherExpress.Enabled = true;
        }
        else
        {
            panelOther.Visible = false;
            valOther.Enabled = false;
            valOtherExpress.Enabled = false;
        }
    }

    void valDonationAmount_ServerValidate(object source, ServerValidateEventArgs args)
    {
        args.IsValid = true;
        if (args.Value == "0")
        {
            args.IsValid = false;
        }
    }

    void btnSubmit_Click(object sender, EventArgs e)
    {
        Page.Validate();                 
        if (Page.IsValid)
        {

        }
    }

    protected void Page_Load(object sender, EventArgs e)
    {    
        _donations = new ArrayList();
        double[] donations = new double[] { 20.00, 50.00, 100.00, 250.00, 500.00 };
        _donations.AddRange(donations);

        if (!IsPostBack)
        {
            foreach (Double d in _donations)
            {
                selAmount.Items.Add(new ListItem(String.Format("{0:c}", d), String.Format("{0:c}", d)));
            }
            selAmount.Items.Insert(0, new ListItem("Select Donation Amount","0"));
            selAmount.Items.Add(new ListItem("Other", "Other"));
        }        
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T02:32:13.003

这可能是一个验证者阻止你吗？您的按钮是否应该忽略任何验证器？如果是这样，您应该在按钮上设置 CausesValidation="false"，以便即使面板中的验证器无效，它也会触发。

否则，按钮的单击事件将被面板中的验证器停止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T00:20:00.390

AJAX 会在回发、会话等方面引起一些奇怪的行为。

```
<asp:Button ID="btnSubmit" runat="server" Text="Donate" onClick="btnSubmit_Click" /> 
```

编辑：也试试这个：确保你的连线不在“if (!isPostBack)”块中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-14T04:17:20.680

将以下代码放在更新面板之外。

```
<%--dummy validator to make ajax validation possible--%>
        <asp:RequiredFieldValidator runat="server" CssClass="hidden" ControlToValidate="dummyTextBox" ValidationGroup="dummy"></asp:RequiredFieldValidator>
        <asp:TextBox runat="server" ID="dummyTextBox" CssClass="hidden"></asp:TextBox>

        <style>
    .hidden {
      display: none;
    }
    </style> 
```

下面的链接对我有用....

[http://jeffreypaarhuis.com/2011/08/08/validation-not-working-in-updatepanel/](http://jeffreypaarhuis.com/2011/08/08/validation-not-working-in-updatepanel/)

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-02-24T23:52:32.310

检查 Button 控件的 AutoPostBack 属性。将其设置为“真”。

# applet - 如何使用 Applet JLabel 组件中的窗口调整字体大小？

> ID：584171
> 
> 赞同：1
> 
> 时间：2009-02-24T23:49:42.380
> 
> 标签：applet, resize, jlabel

正如问题所说......我可以将布局等设置为随窗口调整大小，但我还没有弄清楚如何调整字体大小。

（实际上可能是 JLabel 组件本身没有调整大小并限制字体......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T00:09:43.020

您可能必须设置某种侦听器来跟踪窗口（或小程序或布局）大小的变化，并调用其中一个`setFont()`或`setAffineTransform()`保持字体大小同步。

字体渲染按原样完成的原因之一是字体可以在不同的屏幕分辨率和布局上具有一致的大小。该系统并不是真的要随布局缩放字体。

# asp.net - 在站点级别使用 deployment=true

> ID：584172
> 
> 赞同：0
> 
> 时间：2009-02-24T23:50:14.407
> 
> 标签：asp.net

我正在使用`<deployment retail="true"/>`我的`machine.config`.

这是根据[ScottGu](http://weblogs.asp.net/scottgu/archive/2006/04/11/don_1920_t-run-production-asp.net-applications-with-debug_3d001d20_true_1d20_-enabled.aspx)（和其他人）的建议：

但是，我在同一个盒子上同时运行开发和生产。对于开发人员，我希望能够在生产站点上阻止它的同时进行跟踪。我最初的研究表明`<deployment>`只能适用于整机，但我想错了。

是否有人`<deployment>`在同一台服务器上成功配置了特定站点，但没有成功配置其他站点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T00:28:31.540

显然，真正的答案不是在同一个盒子上运行开发和生产。实际上，与意外启用跟踪或调试编译相比，这对您的生产站点来说风险更大。在开发站点上想出一个导致它吞噬内存和 CPU 并削弱您的生产站点的错误并不需要太多的想象力。也许您可以将开发站点放在那个盒子上的虚拟机中，以将其与生产环境隔离开来吗？

假设开发和生产必须保持在同一个盒子上，你最好的选择可能只是锁定生产 web.config 文件的权限，以减少有人启用他们不应该设置的机会。我不认为 deployment='retail' 做任何你不能在 web.config 中单独设置的事情。

# javascript - HTML id 的实际最大长度是多少？

> ID：584184
> 
> 赞同：98
> 
> 时间：2009-02-24T23:53:04.337
> 
> 标签：javascript, html, css

HTML[规范](http://www.w3.org/TR/REC-html40/types.html#type-name)说

> ID 和 NAME 标记必须以字母 ([A-Za-z]) 开头，后跟**任意数量的**字母、数字 ([0-9])、连字符 ("-")、下划线 ("_") , 冒号 (":") 和句点 (".")。

即使 HTML 4 的[SGML 声明](http://www.w3.org/TR/REC-html40/sgml/sgmldecl.html#h-20.1)对 NAMELEN 使用值 65536，它也指出“避免固定限制”。

但是浏览器、CSS 实现和 JavaScript 工具包肯定对它们支持的长度有*一些*限制。在 HTML/CSS/JS 应用程序中可以安全使用的最小限制是多少？

* * *

## 回答 #1

> 赞同：233
> 
> 时间：2009-02-25T00:21:58.573

刚刚测试：**100**万个字符适用于所有现代浏览器：Chrome1、FF3、IE7、Konqueror3、Opera9、Safari3。

我怀疑更长的 ID 可能会变得难以记住。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-25T00:10:53.407

对我来说，一个实际的限制是在我使用 HTML/CSS 期间我可以存储在我脑海中的 ID 有多长。

这个限制通常在 8 到 13 个字符之间，这取决于我工作了多长时间以及这些名称在元素的上下文中是否有意义。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T00:36:26.700

有时我会得到很长的 ID，但我会一致地命名它们以匹配它们的确切目的。

例如...

```
<div id="page">
    <div id="primary-content"></div>
    <div id="secondary-content"></div>
    <div id="search-form-and-primary-nav-wrapper">
        <form id="search-form"></form>
        <ul id="primary-nav">
            <li id="primary-nav-about-us"></li>
        </ul>
    </div>
    <a id="logo"><img /></a>
</div><!-- /#page --> 
```

如您所见，选择器有时会很长。但是恕我直言，这比使用 YUI grids.css 之类的东西要容易得多，在这些东西中你最终会得到 #doc、#bd、#yui-main 等 ID。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T00:00:34.680

如果这是一个学术问题，那就很有趣了……但就最佳实践而言，您不需要（或不想）将这些扩展。如果您需要存储有关 HTML 元素的数据，最好将其放入 DOM 对象的属性中。

# c# - 如何使用绑定使 Button 出现在 WPF TabItem 的标题中？

> ID：584191
> 
> 赞同：1
> 
> 时间：2009-02-24T23:55:56.203
> 
> 标签：c#, wpf, xaml

我正在创建一个 UI，其中 a`TabControl`具有一系列标准`TabItem`s，其内容为普通 WPF 控件。标题只是像往常一样显示普通字符串。但是，我希望最后一项的标题包含 a`Button`而不是普通的字符串。

让我强调一下，**我已经知道如何在没有绑定的情况下做到这一点。我想用绑定来做。**具体来说，除了最后一个对象 a 之外，`TabControl`它绑定到一个 s 数组。这就是我想出现在标题中而不是作为最后一个的内容。（坦率地说，我不在乎最后的内容是什么。只有标题。）`UserControl``Button``Button``TabItem``TabItem`

我理解`DataTemplateSelector`s 和`StyleSelector`s。我想不通的是样式和模板的组合会为我做到这一点。**具体来说，我需要知道最后一项的`Style`和`DataTemplate`应该是什么样子，以便我可以适当地选择它们。无需显示其他代码。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T00:19:00.827

我自己想通了。我是 WPF/XAML 的新手，我刚刚得到的见解是，对于像 TabControl 这样的 ItemsControl，DataTemplate 会列出每个项目的*内容*，但对项目本身的整体布局一无所知，这由其 ControlTemplate 管理。现在我意识到我根本不需要 DataTemplateSelector，只需要最后一项的样式，如下所示：

```
            <样式 x:Key="buttonStyle" TargetType="TabItem">
                <Setter 属性="模板">
                    <Setter.Value>
                        <ControlTemplate TargetType="TabItem">
                            <边框>
                                <内容演示者
                                    边距="4,1,0,1"
                                    内容="{绑定}"
                                    内容来源="标题">
                                </ContentPresenter>
                            </边框>
                        </控制模板>
                    </Setter.Value>
                </二传>
            </样式>

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T00:54:35.157

我要尝试的第一件事是设置最后一个*TabItem*的样式。在样式中，如果将*Header*属性绑定到*Content*属性，则应该使按钮出现在 TabItems 标题中。然后，您将需要一个对该项目不可见的 DataTemplate，这样您就不会在选项卡的内容区域中看到它。

如果这不起作用，那么您可能需要为选项卡项创建一个新的 ControlTemplate。默认模板如下所示：

```
<Grid SnapsToDevicePixels="true">
<Border Name="Bd" Padding="{TemplateBinding Padding}" BorderBrush="{TemplateBinding BorderBrush}" Background="{TemplateBinding Background}" BorderThickness="1,1,1,0">
    <ContentPresenter Name="Content" 
            ContentSource="Header" 
            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
            RecognizesAccessKey="true" 
            HorizontalAlignment="{Binding Path=HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" 
                VerticalAlignment="{Binding Path=VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" />
</Border> 
```

您唯一需要更改的是 ContentSource 从*Header*到*Content*。您应该创建一个原始副本来执行此操作，否则您将错过所有相关触发器。您可以使用 Reflector 的 BAML 查看器扩展找到原件。或者，如果你有的话，你可以在 Blend 中获得原件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T17:27:24.087

还有另一种更好的方法可以做到这一点。

```
<TabControl>
    <TabControl.ItemsSource>
        <CompositeCollection>
        <CollectionContainer Collection="{StaticResource items}" />
            <TabItem>
            <TabItem.Template>
                    <ControlTemplate>
                        <Border Name="PART_Header" Margin="4,0,1,1">                                    
                            <Button Click="AddTicket">Add Ticket</Button>
                    </Border>
                </ControlTemplate>
                </TabItem.Template>
            </TabItem>
        </CompositeCollection>
    </TabControl.ItemsSource>
</TabControl> 
```

（请注意，以上内容完全是从内存中完成的。我使用的是 Mac，并且不想仅仅为此启动到我的 VM。它应该是相当准确的。）

# asp.net - Global.asax 的未处理异常

> ID：584199
> 
> 赞同：11
> 
> 时间：2009-02-24T23:58:32.530
> 
> 标签：asp.net, exception, exception-handling, global-asax

我正在从 global.asax 通过电子邮件发送未处理的异常详细信息。如何获取未处理异常的 aspx 文件或程序集文件的路径和/或文件名。

当我开发和测试时，此信息显示在异常的堆栈跟踪中。当我将 global.asax 部署到生产环境时，此信息不再显示在堆栈跟踪中。

当我在 Global.asax 中构建 MailMessage 对象时，有没有办法获取此信息？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-26T00:24:33.163

如果这是标签所暗示的 ASP.NET 应用程序，您应该能够执行类似的操作... ctx.Request.Url.ToString() 将为您提供错误发生位置的文件名。

```
protected void Application_Error(object sender, EventArgs e)
{
    MailMessage msg = new MailMessage();
    HttpContext ctx = HttpContext.Current;

    msg.To.Add(new MailAddress("me@me.com"));
    msg.From = new MailAddress("from@me.com");
    msg.Subject = "My app had an issue...";
    msg.Priority = MailPriority.High;

    StringBuilder sb = new StringBuilder();
    sb.Append(ctx.Request.Url.ToString() + System.Environment.NewLine);
    sb.Append("Source:" + System.Environment.NewLine + ctx.Server.GetLastError().Source.ToString());
    sb.Append("Message:" + System.Environment.NewLine + ctx.Server.GetLastError().Message.ToString());
    sb.Append("Stack Trace:" + System.Environment.NewLine + ctx.Server.GetLastError().StackTrace.ToString());
    msg.Body = sb.ToString();

    //CONFIGURE SMTP OBJECT
    SmtpClient smtp = new SmtpClient("myhost");

    //SEND EMAIL
    smtp.Send(msg);

    //REDIRECT USER TO ERROR PAGE
    Server.Transfer("~/ErrorPage.aspx");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T00:05:15.603

在 Visual Studio 中，您需要设置发布版本以生成调试符号。与调试版本不同，默认情况下未设置。这将为您提供完整的异常堆栈跟踪。

即使这样，JIT 编译器完成的优化（例如内联）也可能意味着您在堆栈跟踪中没有得到正确的行号。如果您想确定行号，还可以将发布版本设置为“无优化”。但这可能意味着您的应用程序的性能和/或吞吐量较低（后者在 Web 应用程序中往往更为重要）。

**编辑**：您可以通过转到解决方案资源管理器窗口、右键单击项目并选择“属性”菜单项来找到“生成调试符号”设置。然后转到配置属性 > 构建 > 生成调试信息并设置为 true 或 false。优化代码设置在同一窗口中。

# c - 未指定模式的 Unix O_CREAT 标志

> ID：584210
> 
> 赞同：7
> 
> 时间：2009-02-25T00:02:03.943
> 
> 标签：c, unix

UNIX *open()*函数与 O_CREAT 标志一起使用时的定义是，它需要名为*mode*的第三个参数来设置文件的权限。

如果没有指定该*模式怎么办？*

```
int file;
static const char filename[] = "test.test";

if ((file = open(filename, O_RDWR | O_CREAT | O_TRUNC)) == 1)
{
    perror("Error opening file.");
    exit(EXIT_FAILURE);
}

close(file); 
```

使用这些标志创建的文件会发生什么情况？在我的系统上，我得到：

```
-r--r-s---  1 hyperboreean hyperboreean     0 2009-02-25 01:40 test.test 
```

一种理论是 open 函数在堆栈上查找并检查模式参数，并最终使用它找到的随机整数。

标准对此有何评论？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T01:55:49.503

POSIX 标准 (IEEE 1003.1:2008) 原型`open()`为：

```
int open(const char *path, int oflag, ...); 
```

描述 的行为的部分`O_CREAT`并没有说明如果省略必要的第三个参数会发生什么，这意味着行为是未定义的 - 一切皆有可能。

在实践中，很可能使用旨在作为堆栈帧或返回地址或类似内容的堆栈部分 - 以合理的近似值，可以将其视为随机整数。

[POSIX 2008](http://www.opengroup.org/onlinepubs/9699919799/toc.htm)标准有一些有趣的新（和有用）标志`open()`，包括：

*   `O_FDCLOEXEC`在打开时指定 close-on-exec。
*   `O_DIRECTORY`指定文件必须是目录。
*   `O_NOFOLLOW`指定不追逐符号链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T01:18:07.300

好问题。该`mode`值将由`umask`进程修改。因此，如果您没有在操作中`mode`显式传递 a ，并且如果这导致随机位用于该模式，则这些随机位将被.`open``O_CREAT``umask`

希望我可以更加明确和精确，但我同意 cdonner 的观点，即使用“随机”值以及`umask`.

编辑：您可以尝试的一件事是使用 dtruss 或 truss 或其他一些工具来跟踪系统调用，并`mode`在运行时查看 的值以查看是否使用了一些合理的东西，或者它是否只是由`umask`,修改的随机位例如。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-07T13:14:05.117

作为记录，在大多数 libc 系统上，您可能会使用[**va_arg**，它在其手册页中指出](http://man7.org/linux/man-pages/man3/stdarg.3.html)：

> ```
>  If there is no next argument, or if type is not compatible with the
>    type of the actual next argument (as promoted according to the
>    default argument promotions), **random errors will occur**. 
> ```

```
int
__libc_open64 (const char *file, int oflag, ...)
{
    int mode = 0;

    if (oflag & O_CREAT)
    {
        va_list arg;
        va_start (arg, oflag);
        mode = va_arg (arg, int);
        va_end (arg);
    }

    if (SINGLE_THREAD_P)
        return INLINE_SYSCALL (open, 3, file, oflag | O_LARGEFILE, mode);

    int oldtype = LIBC_CANCEL_ASYNC ();

    int result = INLINE_SYSCALL (open, 3, file, oflag | O_LARGEFILE, mode);

    LIBC_CANCEL_RESET (oldtype);

    return result;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T00:31:27.927

hyperboreean，你的怀疑可能不是那么离谱。我希望在[Kernighan Ritchie](http://www.docstoc.com/docs/293279/Kerningan-y--Ritchie---The-C-programming-language)中找到答案。不幸的是，我没有。我认为 O_CREAT 标志需要权限参数，如果您不提供它， open() 将从堆栈中提取一个随机值，这在 C 中当然不会被注意到。

编辑：“随机”是指不可预测的。它可能正在获取位于堆栈参数顶部的返回地址的一部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-18T19:02:21.360

我们可以使用 C 宏来解决这个问题。

```
#undef open
#define open(a, b, c) open(a, b, c) 
```

现在你不能在`open`没有三个参数的情况下调用。

这类似于为`struct`初始化程序编写宏，以确保用户不会忽略初始化某些成员：

```
#define foo_initializer(a, b, c) { .x = (a), .y = (b), .z = (c) } 
```

如果稍后我们添加一个新成员，我们可以使用新参数`w`进行扩展。`foo_initializer`当我们重新编译代码库时，编译器会找到所有只给它三个参数的地方。而忽略初始化的“裸”初始化程序`w`将继续干净地编译。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-18T18:56:23.530

```
 int open(const char *pathname, int flags);
   int open(const char *pathname, int flags, mode_t mode); 
```

> ...open()...O_CREAT 标志...
> 如果没有指定该*模式怎么办？*

除了其他人的答案之外，如果您想通过在**需要*****时***忘记指定*模式**标志*（即O_CREAT或**O_TMPFILE**，*根据*d 必须**使用**带有 arg的*GNU 项目 C 和 C++ 编译器*（例如命令）。（或）和优化标志，例如。或通常（因为）。 ******`man 2 open`*****`gcc`**[**`-D_FORTIFY_SOURCE=1`**](https://stackoverflow.com/a/16604146/11509478)`2``-O1`**`-O2`**`_FORTIFY_SOURCE requires compiling with optimization (-O)`*********

 *******例如：

```
#include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>
#include <unistd.h>

int main() {
int file;
static const char filename[] = "test.test";

if ((file = open(filename, O_RDWR | O_CREAT | O_TRUNC)) == 1)
{
    perror("Error opening file.");
    exit(EXIT_FAILURE);
}

close(file);
} 
```

（另存为文件`a.c`：）

```
$ gcc -D_FORTIFY_SOURCE=2 -O1 a.c
In file included from /usr/include/fcntl.h:328,
                 from a.c:3:
In function ‘open’,
    inlined from ‘main’ at a.c:10:13:
/usr/include/bits/fcntl2.h:50:4: error: call to ‘__open_missing_mode’ declared with attribute error: open with O_CREAT or O_TMPFILE in second argument needs 3 arguments
    __open_missing_mode ();
    ^~~~~~~~~~~~~~~~~~~~~~ 
```

所以你得到：`open with O_CREAT or O_TMPFILE in second argument needs 3 arguments`

**学究跟随**：
注意：`-O0`或没有`-O`arg。不起作用（即它不会告诉您您忘记添加`mode`，因为它好像`_FORTIFY_SOURCE`未指定或只是被忽略）：

```
$ gcc -D_FORTIFY_SOURCE=2 -O0 a.c
In file included from /usr/include/bits/libc-header-start.h:33,
                 from /usr/include/stdio.h:27,
                 from a.c:1:
/usr/include/features.h:382:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
 #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
    ^~~~~~~ 
```

[在其他情况下](https://fedoraproject.org/wiki/Security_Features?rd=Security/Features#Compile_Time_Buffer_Checks_.28FORTIFY_SOURCE.29)，使用[`_FORTIFY_SOURCE`](https://stackoverflow.com/a/16604146/11509478)也会像这样保护您，并且还有一种情况：，在文件中显示为：`open()``open can be called either with 2 or 3 arguments, not more``/usr/include/bits/fcntl2.h`

```
__errordecl (__open_too_many_args,
         "open can be called either with 2 or 3 arguments, not more");
__errordecl (__open_missing_mode,
         "open with O_CREAT or O_TMPFILE in second argument needs 3 arguments");

__fortify_function int
open (const char *__path, int __oflag, ...)
{
  if (__va_arg_pack_len () > 1)
    __open_too_many_args ();

  if (__builtin_constant_p (__oflag))
    {
      if (__OPEN_NEEDS_MODE (__oflag) && __va_arg_pack_len () < 1)
    {
      __open_missing_mode ();
      return __open_2 (__path, __oflag);
    }
      return __open_alias (__path, __oflag, __va_arg_pack ());
    }

  if (__va_arg_pack_len () < 1)
    return __open_2 (__path, __oflag);

  return __open_alias (__path, __oflag, __va_arg_pack ());
} 
```

需要GNU C 编译器（例如`gcc`）的原因至少是因为 file 中的以下代码`/usr/include/sys/cdefs.h`：

```
#if __GNUC_PREREQ (4,3)
# define __warndecl(name, msg) \
  extern void name (void) __attribute__((__warning__ (msg)))
# define __warnattr(msg) __attribute__((__warning__ (msg)))
# define __errordecl(name, msg) \                                                                                               
  extern void name (void) __attribute__((__error__ (msg)))
#else
# define __warndecl(name, msg) extern void name (void)
# define __warnattr(msg)
# define __errordecl(name, msg) extern void name (void)
#endif 
```

这表示 gcc 版本 4.3 是此工作所需的最低版本。（仅供参考：我当前的版本是 gcc (GCC) 8.3.0）

因此，如果您尝试`clang` *版本 8.0.0 (tags/RELEASE_800/final) Target: x86_64-pc-linux-gnu*，则不会出现编译错误：

```
$ clang -D_FORTIFY_SOURCE=2 -O1 a.c 
```

（即使使用 - 也没有输出，编译成功：*a.out*创建）因为这个 clang 版本定义`__GNUC__`为 be`4`和`__GNUC_MINOR__`to be`2`因此 4.2 只是低于它工作所需的 4.3；并强迫例如。8.3 不起作用：

```
$ clang -D_FORTIFY_SOURCE=1 -D__GNUC__=8 -D__GNUC_MINOR__=8 -O1 a.c
In file included from <built-in>:355:
<command line>:2:9: warning: '__GNUC__' macro redefined [-Wmacro-redefined]
#define __GNUC__ 8
        ^
<built-in>:9:9: note: previous definition is here
#define __GNUC__ 4
        ^
In file included from <built-in>:355:
<command line>:3:9: warning: '__GNUC_MINOR__' macro redefined [-Wmacro-redefined]
#define __GNUC_MINOR__ 8
        ^
<built-in>:7:9: note: previous definition is here
#define __GNUC_MINOR__ 2
        ^
2 warnings generated. 
```

以上源码来自`glibc`Arch Linux 上的 2.29.9000.r269.g1f50f2ad85-1 包。IE。

```
/usr/include/sys/cdefs.h is owned by glibc 2.29.9000.r269.g1f50f2ad85-1
/usr/include/bits/fcntl2.h is owned by glibc 2.29.9000.r269.g1f50f2ad85-1 
```

PS：没有`_FORTIFY_SOURCE`，你可以在每个程序运行时获得随机模式，就像[我一样](https://gist.github.com/howaboutsynergy/4dc0c41d6244d91a7dfd07159b905fe9#gistcomment-2920146)：

```
$ ./go
-r-x--s--T 1 user user 0 May 17 17:22 /tmp/broken_perms.log
$ ./go
---sr-s--- 1 user user 0 May 17 17:23 /tmp/broken_perms.log
$ ./go
-rws--x--- 1 user user 0 May 17 17:23 /tmp/broken_perms.log
$ ./go
--wsr-x--T 1 user user 0 May 17 17:23 /tmp/broken_perms.log 
```

# nhibernate - NHibenate级联问题

> ID：584214
> 
> 赞同：1
> 
> 时间：2009-02-25T00:04:56.463
> 
> 标签：nhibernate, hibernate, nhibernate-mapping

您好我在以下场景中更新子对象时遇到问题。

映射如下：

家长：日历

```
 <bag name="defaultCategories"  inverse="true" lazy="false" 
    cascade="all-delete-orphan">
  <key column="parentID" />
  <one-to-many class="DefaultCategory"/>
  </bag> 
```

子项：DefaultCategory

```
<class name="DefaultCategory" table="tb_calendar_default_category" lazy="false">

<id name="id" column="id">
  <generator class="hilo"/>
</id>

<many-to-one name="calendar" column="parentID" not-null="true" 
 cascade="all-delete-orphan" /> 
```

用于更新日历的代码：

```
public Calendar Update(Calendar vo)
    {
        session = NHibernateHelper.GetCurrentSession();

        tx = session.BeginTransaction();
        using (tx)
        {

            session.Update(vo);

            tx.Commit();
        }

        return vo;
    } 
```

问题是，当我通过 ui 添加或删除 defaultCategories 并将日历的更新版本发送回后端时，NHibernate 会返回更新的日历，一切看起来都很好。但是，任何应该被删除的 defaultCatergories 都保留在默认的 Categories 表中。因此，当我刷新 ui 并再次调用日历时，我可以看到集合没有改变。

您是否认为我需要按 parentID 删除所有 defaultCatergories 然后重新创建？我的印象是 NHibernate 会为你解决这个问题？非常感谢任何帮助或指示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T03:48:30.903

我想知道 NHibernate 是否没有将日历识别为现有实例。[查看文档的这一部分](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/manipulatingdata.html#manipulatingdata-updating-detached)，看看在映射中添加未保存的值属性是否有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T15:15:04.480

您的默认刷新模式是 OnCommit 吗？如果不是这种情况，那么可能在提交之前刷新会话将解决问题。

你正在做的应该工作。

# arrays - 查找正数数组的最大子序列的算法。Catch ：不允许相邻元素

> ID：584228
> 
> 赞同：16
> 
> 时间：2009-02-25T00:11:30.957
> 
> 标签：arrays, algorithm

例如，给定

```
A = [1,51,3,1,100,199,3], maxSum = 51 + 1 + 199 = 251. 
```

显然`max(oddIndexSum,evenIndexSum)`不起作用。**_**

我遇到的主要问题是我无法为元素提出选择标准。给定选择标准，拒绝标准是微不足道的。

标准的最大子序列算法似乎不适用于这里。我尝试过动态编程方法，但也想不出。我能想出的唯一方法是使用遗传算法的方法。

你会如何处理这个问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-25T00:52:08.690

如果保持两种状态，则可以逐步构建最大子序列：

```
def maxsubseq(seq):
  # maximal sequence including the previous item
  incl = []
  # maximal sequence not including the previous item
  excl = []

  for i in seq:
    # current max excluding i
    if sum(incl) > sum(excl):
      excl_new = incl
    else:
      excl_new = excl

    # current max including i
    incl = excl + [i]

    excl = excl_new

  if sum(incl) > sum(excl):
    return incl
  else:
    return excl

print maxsubseq([1,4,6,3,5,7,32,2,34,34,5]) 
```

如果您还想在列表中包含否定元素，则必须添加一些 if。

### 相同——在较少的行中

```
def maxsubseq2(iterable):
    incl = [] # maximal sequence including the previous item
    excl = [] # maximal sequence not including the previous item

    for x in iterable:
        # current max excluding x
        excl_new = incl if sum(incl) > sum(excl) else excl
        # current max including x
        incl = excl + [x]
        excl = excl_new

    return incl if sum(incl) > sum(excl) else excl 
```

### 相同——消除`sum()`

```
def maxsubseq3(iterable):
    incl = [] # maximal sequence including the previous item
    excl = [] # maximal sequence not including the previous item
    incl_sum, excl_sum = 0, 0
    for x in iterable:
        # current max excluding x
        if incl_sum > excl_sum:
            # swap incl, excl
            incl, excl = excl, incl
            incl_sum, excl_sum = excl_sum, incl_sum
        else:
            # copy excl to incl
            incl_sum = excl_sum #NOTE: assume `x` is immutable
            incl     = excl[:]  #NOTE: O(N) operation
        assert incl is not excl
        # current max including x
        incl.append(x)
        incl_sum += x
    return incl if incl_sum > excl_sum else excl 
```

好吧，让我们优化它...

### 总运行时间 O(n) 的版本：

```
def maxsubseq4(iterable):
    incl = [] # maximal sequence including the previous item
    excl = [] # maximal sequence not including the previous item
    prefix = [] # common prefix of both sequences
    incl_sum, excl_sum = 0, 0
    for x in iterable:
        if incl_sum >= excl_sum:
            # excl <-> incl
            excl, incl = incl, excl
            excl_sum, incl_sum = incl_sum, excl_sum
        else:
            # excl is the best start for both variants
            prefix.extend(excl) # O(n) in total over all iterations
            excl = []
            incl = []
            incl_sum = excl_sum
        incl.append(x)
        incl_sum += x
    best = incl if incl_sum > excl_sum else excl
    return prefix + best # O(n) once 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-25T00:53:34.317

Chris 的答案在列表 [9,10,9] 上失败，产生 10 而不是 9+9 = 18。

乔不太对。旅行推销员要求您访问每个城市，而这里没有类似的东西。

一种可能的解决方案是递归解决方案：

```
function Max_route(A)
    if A's length = 1 
        A[0]
      else
        maximum of
          A[0]+Max_route(A[2...])
          Max_route[1...] 
```

这与一个朴素的斐波那契函数具有相同的大 O，并且如果您除了简单地获得正确答案之外还关心效率，那么应该会产生一些相同的优化（例如记忆化）。

——马库斯

[编辑] - -

因为有些人似乎没有明白这一点，所以我想解释一下我所说的记忆是什么意思以及它为什么重要。

您可以包装上面的函数，以便它只计算每个数组的值一次（第一次调用它），并且在随后的调用中将简单地返回保存的结果。这将占用 O(n) 空间，但会在恒定时间内返回。这意味着整个算法将在 O(n) 时间内返回，比上面不太混乱的版本的指数时间要好。我假设这很好理解。

[第二次编辑]-----------------

如果我们稍微扩展一下上面的内容并将其分开，我们会得到：

```
f []      :- [],0
f [x]     :- [x],x
f [a,b]   :- if a > b then [a],a else [b],b
f [a,b,t] :- 
    ft = f t
    fbt = f [b|t]
    if a + ft.sum > fbt.sum
        [a|ft.path],a+ft.sum
      else
        fbt 
```

我们可以仅使用大小为 n 的整数和布尔数组以及以下操作展开伪基础：1) 数组索引和索引数组赋值，2) 整数数学，包括比较，3) if/then/else 和 4)一个 O(n) 的单循环：

```
dim max_sum_for_initial[n],next_to_get_max_of_initial[n],use_last_of_initial[n]

max_sum_for_initial[0] = 0
next_to_get_max_of_initial[0] = -1
use_last_of_initial[0] = false

max_sum_for_initial[1] = a[0]
next_to_get_max_of_initial[1] = -1
use_last_of_initial[1] = true

if a[0] > a[1]
    max_sum_for_initial[2] = a[0]
    next_to_get_max_of_initial[2] = 0
    use_last_of_initial[2] = false
  else
    max_sum_for_initial[2] = a[1]
    next_to_get_max_of_initial[1] = -1
    use_last_of_initial[2] = true

for i from 3 to n
    if a[i]+max_sum_for_initial[i-2] > max_sum_for_initial[i-1]
        max_sum_for_initial[i] = a[i]+max_sum_for_initial[i-2]
        next_to_get_max_of_initial[i] = i-2
        use_last_of_initial[i] = true
      else
        max_sum_for_initial[i] = max+sum_for_initial[i-1]
        next_to_get_max_of_initial[i] = i-1
        use_last_of_initial[i] = false 
```

最后我们可以提取结果（以相反的顺序）：

```
for i = n; i >= 0; i = next_to_get_max_of_initial[i]
    if use_last_of_initial[i] then print a[i] 
```

请注意，我们刚刚手动完成的是现代语言的优秀编译器应该能够通过尾递归、记忆等来完成的事情。

我希望这足够清楚。

——马库斯

是 O(n)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-01-12T23:59:27.977

```
find_max(int t, int n)
{

     if(t>=n)
       return 0;
     int sum =0, max_sum =0;
     for(int i=t; i<n; ++i)
     {
       sum = sum + A[i];
       for(int j=i+2; j<n; ++j)
          sum = sum + find_max(A[j], n);
       if(sum > max_sum)
          max_sum = sum;
     }
     return max_sum;

} 
```

上面是递归的解决方案，没有编译。看到重复并将其转换为 DP 是相当简单的。很快就会发布。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T00:54:20.820

奇怪的 Prologesque 伪代码中的递归答案：

```
maxSum([]) = 0
maxSum([x]) = x
maxSum(A) = max(A[0] + maxSum(A[2..n]),
                A[1] + maxSum(A[3..n])) 
```

适当处理超出范围的索引。

**编辑：**这减少了 MarcusQ 更好的答案：

```
maxSum([]) = 0
maxSum(A) = max(A[0] + maxSum(A[2..n]), maxSum(A[1..n])) 
```

**编辑：**这是一个返回实际子序列而不仅仅是其总和的版本。它扩展了我特设的伪 Prolog-C Chimera 的限制，所以我现在就停下来。

```
maxSub([]) = []
maxSub(A) = sub1 = [A[0]] + maxSub(A[2..n])
            sub2 = maxSub(A[1..n])
            return sum(sub1) > sum(sub2) ? sub1 : sub2 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T15:14:30.347

@MarkusQ作为 Python oneliner[的回答（修改为评论中建议的@recursive）：](https://stackoverflow.com/questions/584228/algorithm-to-find-the-maximum-subsequence-of-an-array-of-positive-numbers-catch/584346#584346)

```
f = lambda L: L and max([L[0]] + f(L[2:]), f(L[1:]), key=sum) 
```

例子：

```
>>> f([1,51,3,1,100,199,3])
[51, 1, 199] 
```

它效率低下，但它可能用于测试更快的解决方案。

### 相同——在 Emacs Lisp 中

```
(defun maxsubseq (L)
  "Based on MarkusQ's and sth's answers."
  (if (not L) L
    (let ((incl (cons (car L) (maxsubseq (cddr L))))
          (excl (maxsubseq (cdr L))))
      (if (> (sum incl) (sum excl)) incl excl)))) 
```

```
(defun sum (L) (apply '+ L))

```

### 迭代版本（如果尾递归可用，则为 O(N)）

它基于[@sth的回答](https://stackoverflow.com/questions/584228/algorithm-to-find-the-maximum-subsequence-of-an-array-of-positive-numbers-catch/584343#584343)：

```
(defun maxsubseq-iter-impl (L excl incl)
  (let ((next (if (> (car excl) (car incl)) excl incl)) (x (car L)))
    （如果（不是 L）（下一个 cdr）
      (maxsubseq-iter-impl (cdr L) 下一个
                           (缺点 (+ x (汽车除外)) (缺点 x (cdr 除外)))))))

(defun maxsubseq-iter (L) (反向 (maxsubseq-iter-impl L '(0) '(0))))

```

### 例子：

```
（需要'cl）
(for f in '(maxsubseq maxsubseq-iter)
      收集（L in '((1 51 3 1 100 199 3) (9 10 9)) 循环
      收集 (f L)))

```

输出：

```
(((51 1 199) (9 9)) ((51 1 199) (9 9))) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-14T01:41:41.247

这是使用与 MarkusQ 相同的基本概念使用动态编程完成的答案。我只是在计算总和，而不是实际的序列，它可以通过对这个代码示例的简单修改来产生。我很惊讶没有人提到这一点，因为动态编程似乎是一种更好的方法，而不是递归 + 记忆！

```
int maxSeqSum(int *arr, int size) {
  int i, a, b, c;
  b = arr[0];
  a = (arr[1] > arr[0]) ? arr[1]: arr[0];
  for(i=2;i<size;i++) {
    c = (a > (b + arr[i]))? a : (b + arr[i]);
    b = a;
    a = c;
  }
  return a;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T00:22:46.077

> max(oddIndexSum,evenIndexSum) 不起作用

对于您给出的示例，它确实如此 - 但是，如果您有类似的东西：`A = [1, 51, 3, 2, 41, 23, 20]`，您可以拥有`51 + 2 + 23 = 76`，或者您可以拥有 `51 + 41 + 20 = 112`，这显然更大，并且也避免了相邻的元素。这是你要找的吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T00:23:39.617

虽然你用了一堆花哨的词，但这基本上不是一个普通的旅行推销员的老图问题吗？

除了在这种情况下，您正在寻找通过（密集）图表的最昂贵的路线？在这种情况下，顶点只是数字本身，边没有方向且没有权重，并且所有顶点都是连接的，除了在原始列表中与它们相邻的顶点？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T12:31:43.517

为了避免递归，我们可以从反向而不是正向，

即）对于数组 A[1..n]->

```
 maxSum(A,n): for all n

         if n=0, maxSum = 0 else
         if n=1, maxSum=A[1] else
                maxSum = max(A[n] + maxSum(A,n-2), maxSum(A,n-1)) 
```

为了避免计算Max(A,n-2)，在扩展maxSum(A,n-1)的同时，可以存储计算。这就是为什么我要求扭转。即） maxSum(A,n-1) = max(A[n-1]+ maxSum(A,n-3), maxSum(A,n-2) ) 其中 Max(A,n-2) 已经得到，无需重新计算）换句话说，使用上述公式计算从 1 到 n 的所有 n 的 maxSum(A,n) 以避免重新计算。

即) n=2, maxSum = max(A[1]+maxSum(A,0), maxSum(A,1) ) 即) n=3, maxSum = max(A[2]+maxSum(A,2) , maxSum(A,2) ) 等等 .. 并到达最后 n 个。这将是o（n）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-25T21:15:25.643

我们可以使用辅助数组 B[0..n-1]，其中 B[i] 是元素 A[0..i] 和 C[0..n-1] 的最大和，其中 C[i ] 是布尔值，判断 A[i] 是否在最大和子序列中：

```
B[0]=max(A[0],0); C[0]=(A[0]>0)
B[1]=max(B[0],A[1]); C[1]=(A[1]>B[0])
for i in [2..n-1]
  if A[i]+B[i-2] > B[i-1]
      C[i]=True
      B[i]=A[i]+B[i-2]
  else
      C[i]=False
      B[i]=B[i-1]
mssq=[]
i=n-1
while i>=0
  if C[i]
    push(A[i],mssq)
    i=i-2
  else
    i=i-1
return mssq 
```

这显然适用于 O(n) 时间和空间。其实这和 MarcusQ 的方案是一样的，只是逆向优化。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-26T05:21:23.103

编辑：这真的是一个骗局，但直到我发布它之后我才意识到这一点。

假设您不需要跟踪哪些项目对最终总和有贡献，您可以在恒定空间和线性时间中执行此操作。

伪代码：

```
sum_excluded_last_item= 0
sum_included_last_item= 0

for each item in list
    if (item>0)
        last_sum_excluded_last_item= sum_excluded_last_item
        sum_excluded_last_item= max(sum_included_last_item, sum_excluded_last_item + item)
        sum_included_last_item= last_sum_excluded_last_item + item
    else
        sum_excluded_last_item= max(sum_excluded_last_item, sum_included_last_item)
        sum_included_last_item= sum_excluded_last_item

max_sum= max(sum_excluded_last_item, sum_included_last_item) 
```

获取实际列表是留给读者的练习。或者我，如果你添加更多评论。但从算法中应该很明显。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-08-12T23:13:25.013

MarkusQ 的代码似乎完全跳过了 a[2]。我不够聪明，无法弄清楚它应该在哪里计算。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2009-02-25T00:27:38.420

```
while you still have elements
     find the largest element, add it to the sum
     remove the element before and after the current 
```

# tsql - T-SQL - 如何交换行和列

> ID：584232
> 
> 赞同：8
> 
> 时间：2009-02-25T00:14:38.687
> 
> 标签：tsql

我有这样的结果集结构

```
ID       Value      Name
1       Oranges     Reponse
1       42      Count
2       Apples      Reponse
2       65      Count
3       Figs        Reponse
3       74      Count 
```

我想解决这个问题：

```
ID     Response       Count
1       Oranges     42
2       Apples      65
3       Figs        74 
```

使用 SQL。有没有办法做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-25T00:20:57.687

```
SELECT a.ID, a.Value AS [Response], b.Value AS [Count]
FROM your_table AS a
    INNER JOIN your_table AS b
        ON a.ID = b.ID
WHERE a.Name = 'Response'
    AND b.Name = 'Count' 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-25T00:33:08.547

在 sql server 2005 之前，这总是一件苦差事。

现在我使用[PIVOT/UNPIVOT](http://msdn.microsoft.com/en-us/library/ms177410.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-23T05:51:16.710

```
SELECT A.ID, A.VALUE RESPONSE, C.VALUE COUNT 
FROM _table  A 
INNER JOIN (
  SELECT ID, VALUE, NAME 
  FROM _table 
  WHERE _table.Name = 'Count'
) C ON A.ID = C.ID
WHERE A.NAME='Response' and C.NAME='Count' 
```

# php - 将模块从 php 4.x 升级到 5.x？

> ID：584233
> 
> 赞同：1
> 
> 时间：2009-02-25T00:14:46.237
> 
> 标签：php, module

我们（最终）从 4.x 升级到 php 5.x。问题是我们使用的第三方模块之一没有加载。
可见：

PHP 警告：PHP 启动：无法加载动态库 '/somewhere/ext/myapp.so' - /somewhere/ext/myapp.so：未定义符号：compiler_globals

不幸的是，我们没有该应用程序的源代码，因此无法重新编译它。有没有办法让它在 php 5.x 上运行，或者我们永远停留在 4.x 的土地上？

谢谢，dar7yl

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T09:01:13.910

我对此表示怀疑。您唯一能做的就是让 php 5 和 php 4 并行运行。然后，php 5 脚本需要调用 php 4 脚本才能使用该模块中的函数。但这真的是非常丑陋的黑客。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T17:27:44.243

如果您告诉我们模块是什么，我们可能会提供更好的建议。

我唯一能想到的就是要么重写它，要么运行一个 php4 实例来运行这个模块。让 php4 和 php5 在具有不同文件扩展名的同一主机上运行似乎相当容易，但是我不知道从一个到另一个使用模块的效果如何。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T19:35:58.503

您可以在同一台服务器上运行 php5 和 php4。

[同时使用 PHP5 和 PHP4 运行 Apache2](http://www.howtoforge.com/apache2_with_php5_and_php4)

当您弄清楚如何使模块与 php5 一起工作时，这可能是您的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-04T10:19:42.133

不幸的是，如果你不自己侵入 PHP，你将无法在没有源代码的情况下使模块工作。

# java - 线程问题

> ID：584234
> 
> 赞同：2
> 
> 时间：2009-02-25T00:14:48.250
> 
> 标签：java, multithreading, user-interface

*我正在使用Java。

我有这个线程，代理，它探索一个房间以确定它的大小并在它脏时清洁它。然后我有界面，它在探索环境时绘制代理。Agent 是 Thread 的子类，Java 负责管理线程。我所做的就是创建线程并说 object.start()。

这在正常情况下非常有效。但是，菜单在此期间启用，这意味着用户可以在代理探索房间时弄乱房间。那不应该发生。

因此，一旦用户单击告诉代理打扫房间的选项，我想禁用所有菜单。除非这不能正常工作。这是问题所在：

```
...
public void ActionPerformed(ActionEvent e)
{
    //disable the menus with setEnabled(false);
    agent.start();
    //enable the menus with setEnabled(true);
} 
```

问题是在代理线程执行其功能之前启用了菜单。我考虑过使用 Thread.join() - 这将保证启用菜单的代码仅在代理线程结束后执行。但是，如果我使用 Thread.join() 接口不会在代理移动时自行更新，因为它正在等待代理完成！

我考虑过禁用代理的界面，然后在代理完成后启用它，但我不确定这是否可行，这里最大的问题是代理不应该乱搞菜单。

所以，总而言之，我需要一个线程执行来更新界面/绘制移动代理，但该线程不能与启用菜单的线程相同。目前似乎有一个线程在做这两件事。假设这是可能的并且不太复杂。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T00:22:35.390

> 我考虑过禁用代理的界面，然后在代理完成后启用它，但我不确定这是否可行，这里最大的问题是代理不应该乱搞菜单。

完成后，您可以让代理调用 GUI 类中重新启用菜单的方法。当然，该方法会在 EDT 上调用适当的 Swing 方法。

```
class Agent extends Thread
{
    @override
    public void run()
    {
       // run around the room

       // finally done
       gui.agentIsDone();
    }
}

class GUI extends JFrame
{
    ...

    void agentIsDone()
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            @override 
            public void run()
            {
                menus.setEnabled(true);
            }
        });
    } 
} 
```

如果多个代理可以同时运行，您需要在重新启用菜单之前检查它们是否都已完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T00:23:51.067

听起来您需要您的代理向您的界面发出清洁已经开始和完成的通知（还有人使用`Observer`/吗？）。`Observable`您的界面将分别调用`setEnabled(false)`并`setEnabled(true)`在收到这些通知时调用。

编辑：这个想法是将菜单的操作与代理的执行分离。即，如果您引入除菜单项之外的另一种方式来启动清洁会发生什么？在这种情况下，您可能仍希望禁用该菜单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T00:22:28.277

在您的`actionPerformed`方法中，只需禁用菜单然后启动线程就可以了 - 但您不应该在同一功能中再次启用菜单。相反，您需要在线程完成时触发菜单的启用。我建议，在您的代理线程结束时，[`SwingUtilities.invokeLater()`](http://java.sun.com/javase/6/docs/api/javax/swing/SwingUtilities.html#invokeLater(java.lang.Runnable))使用`Runnable`将重新启用菜单的调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T00:23:53.547

在启动线程之前禁用菜单。线程完成后需要调用控制器上的某个方法，然后在该方法中再次启用菜单。代理不会弄乱菜单；它只会在完成后通知控制器。当控制器知道代理完成时，它会启用菜单。

另外，据说子类化 Thread 不是一个好习惯。您应该改为实现 Runnable，然后以您的 Runnable 作为其目标创建一个线程，然后启动该线程。这样，如果您的代理是 Runnable，您可以在自己的线程中运行它，或者在主线程中（通过简单地调用 run()）或在线程池等中运行它。

# delphi - TTreeView 的父级更改后释放的 TTreeView 节点句柄？

> ID：584236
> 
> 赞同：0
> 
> 时间：2009-02-25T00:15:11.367
> 
> 标签：delphi, treeview, delphi-2009

我有一个*非常*有趣的问题。

**背景**

我已经使用 TTreeView 多年，但现在才将它与对接库（来自 AutomatedQA）一起使用。我了解到，当更改 TTreeView 的父级时，会重新创建所有句柄。这是对接库在正常活动期间所做的事情。

我一直在使用 TTreeNode 上的 Data 属性来保存一个对象。我还保留了到对象中 TreeNode 的链接。简而言之，使用 TreeNode，我可以获取对象，也可以从对象中获取 TreeNode。

只要树视图的父级从未更改（自动隐藏和显示窗口），我的应用程序就可以完美运行。

**问题**

我发现一旦父级发生更改，我附加到树节点的 Data 属性的对象现在包含对错误树节点或过时指针的引用。

我尝试了另一种方式“MyTreeViewContainer.Parent:=SomewhereElse”并观察到同样的问题。

用可能数百个对象重新加载树不会很有效。

我不知道我应该如何解决这个问题。长期以来，我一直能够加载树视图并让对象仍然能够轻松找到彼此。这真的可以打破我使用树视图的好“模式”......

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-09T02:11:11.843

从 TTreeView 派生一个新组件并覆盖虚拟 CreateWnd() 和 DestroyWnd() 方法，以便在需要时从临时存储中加载/保存自定义数据。几个 VCL 的本地组件（包括 TTreeView）在内部执行此操作。更改 Parent 属性并不是唯一可以导致重新创建 TreeView 的窗口句柄的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T01:27:40.150

我想我找到了答案。使用 TTreeView 的 OnAddition 事件重新连接节点和对象，如下所示：

过程 TForm1.TreeView1Addition（发送者：TObject；节点：TTreeNode）；开始 TMyObject(Node.Data).TreeNode:=Node; 结尾;

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-29T09:45:29.017

我通过覆盖 CreateHandle 方法解决了类似的问题：

```
TMyForm = class(TForm)
protected
  procedure CreateHandle; override;
end;

procedure TMyForm.CreateHandle;
begin
  inherited;
  Regenerate; // rebuild tree structure here
end; 
```

# javascript - 单击 div 以使用 javascript 切换其中的复选框

> ID：584239
> 
> 赞同：20
> 
> 时间：2009-02-25T00:16:36.950
> 
> 标签：javascript, html

这似乎是一个简单的问题，但我不使用很多 javascript。

我有一个 div，里面有一个复选框，并且希望整个 div 来切换复选框。这是我到目前为止所拥有的：

```
<div style="padding: 2em; border: 1px solid"
     onClick="if (document.getElementById('cb').checked) document.getElementById('cb').checked=false; else document.getElementById('cb').checked=true;">
  <input name="cb" id="cb" type="checkbox">
</div> 
```

唯一的问题是当您单击实际的复选框时，它会切换两次，因此不会改变。

有任何想法吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-25T00:29:27.153

您可以通过使用标签元素包裹您想要单击的区域，以更强大和更易于访问的方式实现这一点。

例如：

```
<label for="cb">
    <div style="padding: 2em; border: 1px solid">
        <input name="cb" id="cb" type="checkbox">
    </div>
</label> 
```

上面的代码我没有测试过，但是我相信所有的浏览器都支持点击标签来检查输入框。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-25T00:18:00.330

```
onclick="if (event.target.tagName != 'INPUT') document.getElementById('cb').checked = !document.getElementById('cb').checked" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-05-18T16:47:53.430

根据之前的一些答案，这对我来说最适合这样的html：

```
<div class="option_item">
  <input type="checkbox" value="1" checked="checked">
</div> 
```

像这样的jQuery：

```
$.fn.toggleCheckbox = function() {
  this.attr('checked', !this.attr('checked'));
}

$(document).ready(function(){
  $(".option_item").click(function (e) {    
    if (e.target.tagName != 'INPUT') {
      $(this).find("input").toggleCheckbox();
      return false;
    }
  });
); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T03:52:23.170

问题的根源在于，当您单击复选框时，单击事件会沿 DOM 向上传播到父元素。

所以复选框通过切换自身来处理点击事件，然后DIV接收到点击事件并再次切换复选框。

最简单的解决方案是通过将其添加到输入元素来停止事件的传播：

```
onClick="event.stopPropagation();" 
```

虽然这是在 W3C DOM Level 2 事件模型中定义的，但可能并非所有浏览器都支持它，因此您可能希望使用 Prototype 或 jQuery 等跨浏览器库来确保兼容性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T00:39:00.157

考虑使用 jQuery 而不是自己对 dom 进行编程。使用像 jQuery 这样的库意味着您的代码更有可能在大多数浏览器上运行

[http://docs.jquery.com/Effects/toggle](http://docs.jquery.com/Effects/toggle)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-09T06:05:35.350

这是我对 div 复选框的实现

链接：[https ://codepen.io/ashwinshenoy/pen/oYXqMV](https://codepen.io/ashwinshenoy/pen/oYXqMV)

```
 <div id="checkboxes">
            <input type="checkbox" name="rGroup" class="check_cat" value="Adventure Sports" id="r1"/>
            <div class="check_overlay">
                <i class="fa fa-check-circle"></i>
            </div>
            <label class="whatever" for="r1">
                <img src="http://i.imgur.com/SfQVTlR.png" class=" img-responsive width100" />
                <div class="row">
                    <div class="col-xs-offset-3 col-xs-3">
                        <div class="check_details">
                            <i class="fa fa-user"><span> 500</span></i>
                        </div><!--check_details end-->
                    </div><!--col-xs-* end-->
                    <div class="col-xs-3">
                        <div class="check_details">
                            <i class="fa fa-bitbucket"><span> 500</span></i>
                        </div><!--check_details end-->
                    </div><!--col-xs-* end-->
                </div><!--inner row end-->
            </label>
            <br>
            <div class="check_name_div">
                Adventure Sports
            </div>
        </div><!--checkboxes end--> 
```

Codepen 中的 CSS 和 JS 更新

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-26T04:43:13.650

尝试，

```
.switch_ {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
}

.switch_ input { 
  opacity: 0;
  width: 0;
  height: 0;
}

.switch_slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ff2626;
  -webkit-transition: .4s;
  transition: .4s;
}

.switch_slider:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  -webkit-transition: .4s;
  transition: .4s;
}

input:checked + .switch_slider {
  background-color: #12e4a0;
}

input:focus + .switch_slider {
  box-shadow: 0 0 1px #2196F3;
}

input:checked + .switch_slider:before {
  -webkit-transform: translateX(26px);
  -ms-transform: translateX(26px);
  transform: translateX(26px);
}

/* Rounded sliders */
.switch_slider.round {
  border-radius: 34px;
}

.switch_slider.round:before {
  border-radius: 50%;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<div align="center"><label class="switch_">
  <input type="checkbox" id="size_act">
  <span class="switch_slider round"></span>
</label> 
</div>
<div align="center" onClick="$('#size_act').click();">Inactive / Active</div>
```

# widget - 使用 Excel（或 Calc）作为 Web 应用程序前端或嵌入式小部件

> ID：584240
> 
> 赞同：3
> 
> 时间：2009-02-25T00:16:51.677
> 
> 标签：widget, spreadsheet

**问题：**在处理需要基于网格输入的网络应用程序（但不是像 Google 那样成熟的电子表格）时，存在一个常见问题。要么 web-GUI 很糟糕，要么它被捆绑在一些高度专业化的 API 后面，这些 API 需要太多的培训和时间才能有效地使用（更不用说这些东西的价格标签往往很高）。

***问题*：**假设所有目标用户都有 Excel 或 OpenOffice（或者可以被告知获取副本），有没有人尝试使用电子表格作为实时 Web 应用程序的输入表单？

**场景：**用户 X 访问您的网站，她进入一个页面，在该页面下载电子表格以在使用您的 web 应用程序的过程中继续处理一些复杂的数字。完成后，她在您专门构建的电子表格上按下一个按钮，电子表格本身通过 POST 将其有效负载提交到您的网站，然后网站对最近处理的数字进行任何处理。

**动机：**这个问题的动机源于对所有用于网页的各种“网格控制”小部件的巨大挫败感。它们要么不够，要么不足以“嵌入”为网页中的控件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T00:40:58.933

这是数据繁重的 Intranet 应用程序的常见做法。过去，您会使用 VB 进行应用程序。今天，Open XML SDK 提供了一种非常优雅的方式来挂钩文档的打开和关闭事件。Excel 将在打开（填充电子表格）和关闭/保存（从电子表格中提取数据并将其写回数据库）时执行您的托管代码。Excel 文档可以从不需要安装 Office 的 Web 服务器提供。

# html - 使用相对链接从 https 链接到 http（反之亦然）的快捷方式

> ID：584251
> 
> 赞同：20
> 
> 时间：2009-02-25T00:19:41.497
> 
> 标签：html, http, https

当我在我正在开发的网站的安全部分（使用 https 进入特定页面或文件夹）时，*正常*页面的相对链接也会自动转换为 https。

有没有办法告诉 <a> 标签始终使用 http 协议而不是 https 协议（或相反）？

我知道使用完整链接（[http://www.mysite.com/index.html](http://www.mysite.com/index.html)或[https://www.mysite.com/index.html](https://www.mysite.com/index.html)）很容易，但我希望它可以与相对链接一起使用（index.html、../index.html 等）。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2010-02-07T12:06:04.887

您可以使用以下语法使所有内部链接独立于协议：

`<a href="//some/file/on/your/domain.php">link text</a>`

代替

`<a href="some/file/on/your/domain.php">link text</a>`

这`//`将使链接尊重页面加载的任何协议。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-25T06:24:13.850

我们使用 Apache mod_rewrite 来控制页面是通过 http 还是 https 提供服务。下面是来自站点根目录 .htaccess 文件的示例片段：

```
# Redirect most reqests for https to http
RewriteRule ^https://www.example.com(.*) http://www.example.com$1 [R=301,NC]

# Allow some URIs to be https if requested
RewriteCond   %{SERVER_PORT}  ^443$
RewriteCond   %{REQUEST_URI}  !^/images/(.*)$
RewriteCond   %{REQUEST_URI}  !^/scripts/(.*)$
RewriteCond   %{REQUEST_URI}  !^/styles/(.*)$
RewriteCond   %{REQUEST_URI}  !^/store(.*)$
RewriteCond   %{REQUEST_URI}  !^/login.htm$
RewriteRule ^(.*) http://www.example.com/$1 [L,R]

# Force some URIs to be https only
RewriteCond   %{SERVER_PORT}  ^80$
RewriteRule ^store(.*) https://www.example.com/store$1 [L,R]

RewriteCond   %{SERVER_PORT}  ^80$
RewriteRule ^FormSanityKey.htm https://www.example.com/login$1 [L,R] 
```

在以下位置阅读所有相关信息：

[http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-25T00:28:00.340

不确定这是否正是您正在寻找的，但如果您使用的是 Apache，您可以使用一个技巧来做到这一点：[http ://httpd.apache.org/docs/2.2/ssl/ssl_faq.html#相对的](http://httpd.apache.org/docs/2.2/ssl/ssl_faq.html#relative)

基本上，您将以下内容放入您的 Apache 配置文件中：

```
RewriteEngine on
RewriteRule ^/(.*):SSL$ https://%{SERVER_NAME}/$1 [R,L]
RewriteRule ^/(.*):NOSSL$ http://%{SERVER_NAME}/$1 [R,L] 
```

然后附加`:SSL`到您要为其强制 HTTPS 的任何链接（在网页中），以及`:NOSSL`您要为其强制常规 HTTP 的任何链接。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-25T00:25:26.973

听起来您想使用[BASE 元素](http://www.w3.org/TR/REC-html40/struct/links.html#h-12.4)。

没有办法“告诉” Anchor 使用或不使用特定协议，至少不使用该页面 HEAD 中的 BASE 元素。

您是否有理由要使用相对链接而不是绝对链接？[本文](http://www.webpronews.com/blogtalk/2008/01/17/absolute-and-relative-urls)讨论了在 HTTPS 中使用相对链接的陷阱——可能让您的网站被双重索引等。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T00:53:53.037

由于您使用的是不同的协议，因此无法使用相对超链接来执行此操作，这与链接到 ftp 位置没有什么不同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-12-16T23:08:28.983

我使用此代码创建当前索引页面的链接以指向`https`服务器，因为我们根据协议提供不同的内容并且我们不知道托管在哪里。

```
 <a>Secure server
    <script>
      let url = new URL(window.location);
      url.protocol = 'https:';
      url.port = '443';
      document.currentScript.parentElement.href = url.toString();
    </script>
  </a> 
```

# java - 如何在 Java/Java EE 环境中实现 Basecamp 风格的 URL？例如 .hostname.com

> ID：584252
> 
> 赞同：0
> 
> 时间：2009-02-25T00:19:44.897
> 
> 标签：java, jakarta-ee, server-side

Basecamp URL，例如 .basecamphq.com，例如 seymores.basecamp.com。

如何在 Tomcat 环境中做同样的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T11:37:42.507

其他近似值是使用[UrlRewriteFilter](http://tuckey.org/urlrewrite/)。例如，使用此过滤器和少量策略，您可以转换如下调用：

[http://username.domain](http://username.domain)（在 url 重写之前）

到

[http://domain/your_servlet?user=username](http://domain/your_servlet?user=username)（url 重写后）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T00:41:47.153

如果您只想拥有一份 Web 应用程序副本，该副本根据所使用的虚拟主机名执行不同的操作，请[检查“Host”标头。](http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/http/HttpServletRequest.html#getHeader(java.lang.String))这可以在[过滤器](http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/Filter.html)或调度程序 servlet 中完成，具体取决于您要对结果执行的操作。

[通过将`Host`元素](http://tomcat.apache.org/tomcat-5.5-doc/virtual-hosting-howto.html)添加到`Engine`服务器配置中的元素，您可以为每个虚拟服务器创建不同的 Web 应用程序副本。这会创建单独的虚拟主机，每个虚拟主机都有自己独立的 Web 应用程序集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T00:29:53.050

简短的回答是从请求 url 解析主机。然后将它与您所做的所有查询一起使用。在默认配置中，Tomcat 将响应映射到它正在侦听的 IP 的所有请求。

# web-services - 有没有人成功使用过新的 WCF REST Starter Kit，你会再次使用它吗？

> ID：584254
> 
> 赞同：5
> 
> 时间：2009-02-25T00:20:30.717
> 
> 标签：web-services, rest, soap

正如标题所暗示的那样，我想看看这是否是人们满意的事情。

我有几个项目，我将花一些时间来试验与 Web 服务相关的不同类型的技术，最好是 SOAP 的替代品，它可以很好地集成在 dotnet 内部/与 dotnet 中。

我想听听是否已经有一些成功案例或人们对入门套件的价值的看法：

该套件是否仍然太新鲜，以至于人们无法很好地接受它以为他们所取得的成就感到自豪？

> 一些背景：
> 
> 我的团队成员对 SOAP 和 REST 都不熟悉，我正在权衡哪一个来激励他们/我自己。

.

> 我个人对 SOAP 并不太热衷，但就像我对 SQL 的厌恶一样，我更多地归咎于我自己在这个主题上缺乏经验，而不是技术本身。

因此，在寻找其他方法来处理与 Web 相关的服务时，我遇到了 REST，到目前为止一切都很好。社区如何接受它？

我很高兴看到人们对初学者工具包替代品的评论和建议。

稍微超出最初的问题，也欢迎对 REST 作为一个整体的评论，以替代 SOAP 的分布式超媒体以及想要捍卫 SOAP 的人。

*抱歉，如果这是一个骗局，我确实环顾四周，并没有找到与我想知道的完全一样的东西。*

谢谢，

里克

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-25T00:28:13.957

我花了大约两周的时间使用 WCF 和 REST 入门工具包对 RESTful 服务进行原型设计，发现它非常难以掌握，非常不直观，并且使很多本应简单的事情变得非常困难。真的感觉就像他们试图在一个旨在抽象出 HTTP 的层之上添加一个 HTTP 仿真层，结果它很混乱。

作为参考，原型包括实现 CRUD 功能、`X-HTTP-Method-Override`标头、将任何错误自定义转换为标准错误块、支持 XML 和 JSON 作为输入和输出格式、调用者的身份验证和授权，以及任何内部的依赖注入服务转化为面向外部的服务。

然后我花了一周左右的时间使用 ASP.NET MVC 对相同的 API 进行原型设计，发现它更容易掌握，扩展直观，并且上面列表中没有什么是困难的（我有一段时间被标题难住了，但[解决方案原来只有 10 行代码左右](https://stackoverflow.com/questions/467535/is-it-possible-to-implement-x-http-method-override-in-asp-net-mvc/490733#490733)）。ASP.NET MVC 非常接近底层 HTTP 协议，因此可以轻松实现包含它的 RESTful API。

因此，我个人的建议（以及我的公司根据我的研究采用的建议）是避免使用 WCF 来提供 RESTful 服务并使用 ASP.NET MVC。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T08:01:48.390

我建议看看 OpenRasta，它比 asp.net MVC 更接近 http 语义。[http://trac.caffeine-it.com/openrasta/](http://trac.caffeine-it.com/openrasta/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T14:38:24.563

我也会仔细阅读[许可](http://social.msdn.microsoft.com/content/en-us/msft/netframework/wcf/rest/license)条款。根据我的阅读（而且我不是律师），您不能将库与您的代码一起分发。这阻止了我们在产品中使用它。它还会阻止您在分发给合作伙伴等的客户端中使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T00:44:24.557

我赞同 Greg 的建议，即支持 ASP.NET MVC 而不是 WCF REST 入门工具包。如果您确实走这条路，请确保查看ASP.NET MVC 中 RESTful 控制器的[此](http://www.douglaspurdy.com/2009/02/06/rest-service-controller-using-aspnet-mvc-rc/)实现。

# visual-studio - 我可以在 Visual Studio 中的一个项目上使用多个源代码控制提供程序吗？

> ID：584255
> 
> 赞同：1
> 
> 时间：2009-02-25T00:20:31.450
> 
> 标签：visual-studio, svn, version-control

在工作中，我们使用 Team Foundation Server 进行源代码控制。不过，我经常在家工作，而且现在或在可预见的将来都无法从外部访问我们的 Team Foundation Server。我完全厌倦了使用电子邮件/USB 源代码控制——几乎和没有源代码控制一样糟糕——所以我正在考虑通过电子邮件或 USB 将项目带回家并将它们提交到颠覆服务器（可能在我自己的一台计算机，尽管[http://xp-dev.com/](http://xp-dev.com/)提供的免费 Subversion 工具可能是一种选择：我可以在工作中提交更改，然后从家中获取）。

安装本地 Team Foundation Server 并编辑适当的文件以指向它是可能的，因为我有 MSDN 许可证，但不知何故我认为这行不通（而且我什至不知道 Team Foundation 的地址在哪里服务器已存储，并且我查看了诸如 ???scc 文件之类的明显位置。）

我以前在我自己的项目中使用过 Subversion，使用 TortoiseSVN 作为界面，但是由于我已经习惯了能够从 Visual Studio 中移动和重命名文件的便利，我希望我会在 Visual Studio 中使用 AnkhSVN，然后使用 TortoiseSVN导出功能以获取项目的干净副本以带回工作以签入。我担心的是由两个源代码控制提供商管理的项目引起的冲突。这在 Visual Studio (2008) 中是否可行？在家里打开项目时，Team Foundation Server 不可用，这已经够麻烦了。有没有人做过类似的事情？我知道我可以尝试一下，看看效果如何，但我想提前知道任何潜在的陷阱。

编辑：由于无法远程访问 Team Foundation Server 的相同原因，我无法通过 VPN 进入工作。我当然愿意..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T01:22:10.613

SVN 使用隐藏的 .svn 或 _svn（取决于您的配置）文件夹来跟踪您的本地文件及其状态。我不确定 TFS 如何跟踪本地文件状态，但可能存在潜在冲突。

我们使用 SVN 进行源代码控制，我在办公室、家里和客户站点都工作。我们的 SVN 服务器只能通过 VPN 使用。TFS 可以通过 VPN 工作 你有 VPN 吗？如果不是，您应该在您的公司中设置它，因为它将使您能够像在公司网络上一样运行，使您能够在需要时访问公司开发、测试或数据库服务器的文件共享或 RDC。作为一名编程人员，我认为如果你在远程工作，拥有这种访问权限是至关重要的。由于您有 TFS 设置，因此您必须在网络上进行域设置，因此将 VPN 功能添加到您的公司网关机器是一项简单的任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T00:31:45.993

我认为是的，是您问题的答案。

就我个人而言，我正在经历同样的 USB SVN 等地狱。

目前我正在使用[Live Mesh](https://www.mesh.com/Welcome/default.aspx) Beta 在我的工作和家庭工作站之间同步一个文件夹。

使用[Git](http://git-scm.com/)进行个人版本控制使其与 TortoiseSVN、基础服务或您能想到的任何其他版本控制完全不冲突（据我所知）。

它为我创造了奇迹，就在昨天我在家做了一个新应用程序，今天早上开始工作，它在这里，因为同步，独立，我可以随时使用 Git，从任何机器提交/回滚/差异，而不是不必担心来自其他机器的服务器/服务。

因为它由 Mesh 自动同步，所以我什至不必提交/推送更改。只需使用版本控制来监控我的“完成”阶段，并跟踪项目的个人进度。

> 抱歉，重新阅读您的问题，我想我可以添加这个**[Edit]**：
> 
> 我使用的 Git 不是直接 *从*Visual Studio 中的插件内部说的，我确实打开了一个命令提示符窗口来执行提交，但我将它与我使用 Visual Studio 开发的项目一起使用。

我只是想把我的成功故事告诉你，因为它可能对你有帮助。

# ruby - edit_line 的对齐方式

> ID：584256
> 
> 赞同：0
> 
> 时间：2009-02-25T00:20:47.640
> 
> 标签：ruby, shoes

我在 Mac OS X 10.4 上使用 Shoes 0.r1134

运行以下代码时，

```
Shoes.app do
    edit_line("Something")
    edit_line("Something Else")
end 
```

第二个 edit_line 控件似乎比第一个控件低 4 个像素，这样它们就不会彼此齐平。为什么是这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-17T06:01:14.750

我无法在我的机器上从源代码构建 Shoes，但以下行看起来很可疑（shoes/shoes/ruby.c 的第 3410 行）：

```
shoes_edit_line_draw(VALUE self, VALUE c, VALUE actual)
{
  SETUP_CONTROL(0, 0, FALSE);

#ifdef SHOES_QUARTZ
  place.x += 4; place.ix += 4;
  place.y += 4; place.iy += 4;
  place.h += 4; place.ih += 4;
  place.w += 4; place.iw += 4;
#endif 
```

对于**list_box**（第 3552 行）和**按钮**（第 3388 行），代码仅显示更改高度。

```
#ifdef SHOES_QUARTZ
  place.h += 8;
  place.ih += 8;
#endif 
```

和

```
#ifdef SHOES_QUARTZ
  place.h += 8;
  place.ih += 8;
#endif 
```

分别。但是，我不知道这是否不正确。

# html - 最好将页面名称放在站点名称之前，反之亦然？

> ID：584268
> 
> 赞同：7
> 
> 时间：2009-02-25T00:25:08.863
> 
> 标签：html, seo, usability

`<title>`标签 的多种用途使问题复杂化……</p>

*   作为浏览器窗口或搜索结果标题，它似乎没什么区别——所有东西都有足够的空间，显示顺序与标题无关。

*   对于选项卡和任务栏/停靠标题，空间更为宝贵。将页面名称放在首位可以更容易区分同一站点上的多个页面，但如果页面名称是通用的（“搜索结果”、“CSS 简介”），则区分站点可能比区分站点更重要页。

*   在书签标题中，首先使用站点名称既可以使它们更容易找到，也可以通过简单的排序将它们分组，但是用户可以根据自己的喜好轻松更改标题（并且经常这样做），使提供的“默认”标题不太重要。

还应考虑哪些其他因素？是否有普遍接受的“最佳实践”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T00:43:46.493

有趣的是，不到一个小时前，我还在思考这个确切的问题。

作为最重要的信息，我通常希望页面名称排在第一位。如果站点使用反向方法，则在同一站点上的页面之间切换会更加麻烦。

坦率地说，即使在书签等位置，我也希望页面名称排在第一位。书签管理器应该根据用户的需要对标签进行排序 - 不一定基于页面标题（例如按**域**排序）。

在我看来，即使是您发布的两个通用示例在标题的开头也是有意义的。快速浏览一下我的标签栏很容易让我找到我之前阅读的*“CSS 简介” 。*标题*“搜索结果”*可以重写为类似于*“'死星'的搜索结果”的*内容，这将是非常有用的信息。

此外，当前实施的 Favicon 在帮助用户区分页面在一组选项卡中属于哪个站点方面做得很好。顺便说一句，我不介意将任务栏中使用的 Favicon 也视为浏览器的应用程序图标（某些浏览器不是已经这样做了吗？）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-25T00:43:44.997

为了更好的 SEO（搜索引擎优化）将页面名称放在站点名称之前

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T00:32:53.323

如果一个网站有一个网站图标，那也是一个因素。它将显示在选项卡上和书签旁边。页面名称应该首先在该应用程序中进行区分。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-25T00:33:45.440

我认为 Stack Overflow 的做法是最常见的方法。如果您在页面上并且向上看，如果网站名称位于末尾而不是开头，则更容易看到页面的内容。还要考虑到搜索引擎通常会使用标题作为结果页面中的锚文本。如果标题包含主题而不是网站名称，您更有可能被点击。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-25T07:49:54.020

绝对要从具体到一般，因为正如您所指出的，有几种情况会缩短文本：选项卡、历史菜单、书签。

不同站点可能有相似标题的情况*远比*同一个站点有不同标题的情况要小得多。

前段时间，Myspace 的每一页都只有“myspace.com”的标题，这真是令人气愤。那是一个您倾向于四处游荡的网站。

如果你想要官方引用，我知道 Jakob Nielsen 说过，我认为 Steve Krug 在“Don't Make Me Think”中也说过。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-25T17:38:33.200

有趣的是，Jakob Nielsen 最近（2008 年 3 月）发布了对他的经典可用性指南的“更新”，列出了一些他现在认为将站点名称放在特定页面名称/页面之前的 <title> 标记上的更好主意内容。

来自[http://www.useit.com/alertbox/microcontent-brand-names.html](http://www.useit.com/alertbox/microcontent-brand-names.html)：

> 当满足以下两个条件时，使用您的公司名称启动搜索引擎链接：
> 
> *   对于通常会产生充满垃圾链接的 SERP（搜索引擎结果页面）的查询，该链接会显示为命中。
>     
>     
> *   您拥有一个广受认可和备受推崇的公司名称。
>     
>     
> 
> ...
> 
> 请注意，此新指南仅适用于出现在外部搜索引擎中的链接，例如 GYM（Google、Yahoo、Microsoft）。

Amazon.com 目前正在这样做。例如，经典的“四人帮”设计模式书的 Amazon.com 页面的标题是“Amazon.com: Design Patterns: Elements of Reusable Object-Oriented Software”：

[http://www.amazon.com/dp/0201633612/](https://rads.stackoverflow.com/amzn/click/com/0201633612)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T00:30:05.637

我怀疑它归结为用例。在我处理的用例中，它是关于在任务栏中发现我的浏览器窗口以及许多其他窗口 - 所以我将应用程序名称放在首位 - 页面名称无济于事。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T00:31:52.467

您可以将其国际化，让订单依赖于本地。还要考虑网站的组织和信息架构以及您所展示的一般内容。

简短的回答：取决于

# linux - 可以为每个 http 请求分配一个新的 IP 地址吗？

> ID：584272
> 
> 赞同：9
> 
> 时间：2009-02-25T00:27:26.517
> 
> 标签：linux, command-line, fedora, wget

每次需要使用 wget 等命令发出 http 请求时，我是否可以更改或分配我的服务器一个新的 IP 地址？

谢谢大家

## 更新

其原因正是 Tor 项目试图实现的目标。我不想留下我的服务器发出的请求的痕迹，我认为不断更改我的 IP 地址可以帮助我和我的用户使用互联网而不会被跟踪。:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T00:31:33.420

如果您有大量可以使用的代理，那么我想您可以在它们之间切换，但否则，您通常不能随时更新您的 IP 地址。

您可能想研究[Tor](http://www.torproject.org/)，这是一个匿名网络，其功能类似于您所要求的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T00:58:18.300

如果认为提出此类不道德问题的人应该解释他们打算如何以合乎道德的方式使用回复中提供的信息。

If you have a large pool of IP addresses at your disposal, you may be able to switch between them. This is the reason, however, why there are bot networks out there - because criminals can't really hide their own IP addresses, so they have to use other people's.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T00:53:32.897

如果您已经为您的机器分配了多个 IP 号码，您可以将参数传递给 wget [，如下所示](http://www.delorie.com/gnu/docs/wget/wget_7.html)：

```
wget --bind-address=364.293.991.800 http://address.you.are.secretly.visiting/ 
```

但是，如果您分配了多个 IP 号码，它们都将来自您的 ISP 提供的同一个 IP 池。我不认为这就是你的意思 - 听起来你想使用来自不同池的随机不同地址，这样你就无法被追踪。您需要为此使用远程代理，因此 Tor 之类的东西是正确的建议。

不过，您可能想稍微澄清一下这个问题：您是否想对您正在访问的网站、您自己的 ISP 或可能监控您网络流量的人隐藏自己？

如果是网站，Tor 或其他代理服务就是答案。如果它是您的 ISP，请不要打扰。如果你不在中国，后者不太可能成为问题，除非你是偏执狂。我知道有些人担心这种事情，但我认为他们疯了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T00:46:01.667

要问的第一个问题是，您将如何更改服务器的 IP 地址*一次*？一般来说，您需要与您的 ISP 合作，即使那样，他们也只能提供有限的 IP 地址池。

在服务器启动时更改服务器的 IP 地址将导致任何现有连接最终失败（因为来自远程服务器的数据包不会找到自己的方式返回到刚刚移动的服务器）。因此，您需要同时在您的服务器上设置多个 IP 地址，这是可能的，但同样需要您的 ISP 的合作。您可以为单台计算机分配多少 IP 地址也有实际限制。

Tor 之类的优势在于请求可能来自世界任何地方。IP 地址按国家/地区划分，然后分配给 ISP，因此您的 ISP 无法在分配给德国的范围内为您提供 IP 地址，例如（假设您一开始不在德国）。

# sql - 如何在单个 SELECT 语句中拥有多个公用表表达式？

> ID：584284
> 
> 赞同：101
> 
> 时间：2009-02-25T00:30:05.857
> 
> 标签：sql, sql-server, sql-server-2008, tsql, common-table-expression

我正在简化一个复杂的选择语句，所以我想我会使用公用表表达式。

声明一个 cte 可以正常工作。

```
WITH cte1 AS (
    SELECT * from cdr.Location
    )

select * from cte1 
```

是否可以在同一个 SELECT 中声明和使用多个 cte？

即这个sql给出了一个错误

```
WITH cte1 as (
    SELECT * from cdr.Location
)

WITH cte2 as (
    SELECT * from cdr.Location
)

select * from cte1    
union     
select * from cte2 
```

错误是

```
Msg 156, Level 15, State 1, Line 7
Incorrect syntax near the keyword 'WITH'.
Msg 319, Level 15, State 1, Line 7
Incorrect syntax near the keyword 'with'. If this statement is a common table expression, an xmlnamespaces clause or a change tracking context clause, the previous statement must be terminated with a semicolon. 
```

注意。我尝试输入分号并收到此错误

```
Msg 102, Level 15, State 1, Line 5
Incorrect syntax near ';'.
Msg 102, Level 15, State 1, Line 9
Incorrect syntax near ';'. 
```

可能不相关，但这是在 SQL 2008 上。

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2009-02-25T00:40:31.820

我认为它应该是这样的：

```
WITH 
    cte1 as (SELECT * from cdr.Location),
    cte2 as (SELECT * from cdr.Location)
select * from cte1 union select * from cte2 
```

基本上，`WITH`这里只是一个子句，和其他包含列表的子句一样，“，”是适当的分隔符。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-03-17T16:27:24.880

上面的答案是对的：

```
WITH 
    cte1 as (SELECT * from cdr.Location),
    cte2 as (SELECT * from cdr.Location)
select * from cte1 union select * from cte2 
```

此外，您还可以从 cte2 中的 cte1 查询：

```
WITH 
    cte1 as (SELECT * from cdr.Location),
    cte2 as (SELECT * from cte1 where val1 = val2)

select * from cte1 union select * from cte2 
```

`val1,val2`只是表达的假设..

希望这个博客也能有所帮助：http: [//iamfixed.blogspot.de/2017/11/common-table-expression-in-sql-with.html](http://iamfixed.blogspot.de/2017/11/common-table-expression-in-sql-with.html)

# jquery - 使用 jQuery.support 检测 IE6

> ID：584285
> 
> 赞同：34
> 
> 时间：2009-02-25T00:30:33.687
> 
> 标签：jquery, browser-detection

任何人对如何使用 jquery.support 测试特定于 IE6（而不是 IE7）的东西有任何想法吗？

我的问题是 IE6 仅支持 :hover psuedo-class 锚元素，而 IE7 支持所有元素（如 FF、Chrome 等）。所以我想做一些特别的事情，以防浏览器不支持：悬停所有元素......因此我需要一种方法来测试这个功能。（不想使用 jQuery.browser）。有任何想法吗？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-02-25T01:28:56.200

虽然检查功能支持而不是用户代理是一种很好的做法，但没有简单的方法来检查诸如使用 JavaScript 对 css 属性的支持之类的东西。我建议您遵循上述海报建议使用条件注释或使用 jQuery.browser。一个简单的实现（未验证性能或错误）可能如下所示：

```
if ($.browser.msie && $.browser.version.substr(0,1)<7) {
  // search for selectors you want to add hover behavior to
  $('.jshover').hover(
    function() {
      $(this).addClass('over');
    },
    function() {
      $(this).removeClass('over');
    }
} 
```

在您的标记中，将 .jshover 类添加到您想要悬停 css 效果的任何元素。在您的 CSS 中，添加如下规则：

```
ul li:hover, ul li.over { rules here } 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-25T01:14:13.597

您可以使用 Microsoft Internet Explorer 特定的[条件注释](http://msdn.microsoft.com/en-us/library/ms537512%28v=VS.85%29.aspx)将特定代码仅应用于 IE6。

```
<!--[if IE 6]>
  Special instructions for IE 6 here... e.g.
  <script>...hook hover event logic here...</script>
<![endif]--> 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-04-17T20:47:47.497

厚箱用途

```
if(typeof document.body.style.maxHeight === "undefined") {
    alert('ie6');
} else {
    alert('other');
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T01:28:00.133

这是我们应该退后一步并询问您为什么这样做的一个示例。

通常是创建一个菜单。如果是这样，我强烈建议您省去一些麻烦，并使用像[superfish](http://users.tpg.com.au/j_birch/plugins/superfish/)这样的插件或众多替代方案之一。

如果不是，我建议您使用[jQuery hover()](http://docs.jquery.com/Events/hover)事件监听器。例如：

```
$("td").hover(function() {
  $(this).addClass("hover");
}, function() {
  $(this).removeClass("hover");
}); 
```

会做你想做的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T21:39:11.483

我会使用任何东西：悬停 - [http://www.xs4all.nl/~peterned/csshover.html](http://www.xs4all.nl/~peterned/csshover.html)

它使用行为并且对我很有效。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-03T19:52:54.660

只是为了好玩（不使用 jQuery.support）：

```
$(document).ready(function(){
    if(/msie|MSIE 6/.test(navigator.userAgent)){
        alert('OMG im using IE6');
    }
}); 
```

你也可以通过 php

```
<?
if(preg_match('/\bmsie 6/i', $ua) && !preg_match('/\bopera/i', $ua)){
    echo 'OMG im using IE6';
}
?> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T01:12:37.330

jQuery.support 没有要检测的属性：悬停支持 [http://docs.jquery.com/Utilities/jQuery.support](http://docs.jquery.com/Utilities/jQuery.support)

但也许你可以简单地使用 hover() 事件 [http://docs.jquery.com/Events/hover](http://docs.jquery.com/Events/hover)

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2011-11-29T12:40:50.950

```
if ($.browser.msie && parseInt($.browser.version, 10) == 6) {
  alert("I'm not dead yet!"); 
} 
```

# function - 寻找齿轮齿的径向坐标描述

> ID：584290
> 
> 赞同：1
> 
> 时间：2009-02-25T00:31:46.710
> 
> 标签：function, geometry, coordinates, radial

我不需要物理上准确的函数，而是暗示渐开线曲线等的东西。我只是在使用`r = 2 + sin^2`，这让这个想法得到了理解，但它看起来像 - 嗯。谷歌搜索，你可以找到大量关于如何起草“正确”装备的信息，但没有任何关于基本近似的信息。

编辑：我追求的“外观”：http: [//www.cartertools.com/involute.html](http://www.cartertools.com/involute.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-17T02:12:24.473

```
from pylab import *

nteeth = 30
inner = 10
outer = 12

# these are in teeth-hundredths, but half the actual measurement
bottom_width = 22
top_width = 15

def involute_r(angle):
    '''angle is given in teeth-hundredths'''
    angle = angle % 100
    if angle > 50:
        # symmetry
        angle = 100 - angle

    if angle < bottom_width:
        return inner
    if angle > (50 - top_width):
        return outer
    halfway = (inner + outer) / 2.0
    transition_width = 50 - top_width - bottom_width
    curve = 1.0 - (angle - (50 - top_width))**2 / (transition_width ** 2)
    return   halfway +  curve * (outer - halfway)

fig = figure()
ax = fig.add_subplot(111, polar=True)
theta = np.arange(0, 2*pi, 0.001)
r = [involute_r(t * nteeth * 100 / (2 * pi)) for t in theta]
ax.plot(theta, r)
ax.set_ylim(inner, outer+1)
show() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T00:36:24.810

怎么样`r = 2 + sin(24*theta)^12`？如果没有更具体的问题，很难知道你想要什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T19:16:31.140

在我看来，关于[渐开线曲线](http://en.wikipedia.org/wiki/Involute)的维基百科文章似乎回答了你的问题。它说：

“在[极坐标](http://en.wikipedia.org/wiki/Polar_coordinates)(r, θ) 中，圆的渐开线具有参数方程：

r = 秒 α

θ = tan α - α

其中a是圆的半径，α是参数。”</p>

如果您需要以 θ 而不是 α 参数化的形式，那么您将需要以数字方式解决它，因为我认为没有符号解决方案。您还需要注意，因为 r 在 θ 方面有无限多的解决方案（因为渐开线围绕圆盘旋的方式）：

![](https://upload.wikimedia.org/wikipedia/commons/8/88/Animated_involute_of_circle.gif)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-23T19:33:01.063

渐开线方程是正确的。您可以相对于螺距半径使用它。我知道您不会精确，但实际上，这不是正确的形状。一本好的齿轮设计书将引导您了解所有古怪的细节，例如基座半径以减轻压力。您可以[使用 Google Books 在线阅读旧版本](http://books.google.com/books?id=VkEYAAAAYAAJ&printsec=frontcover&source=gbs_v2_summary_r&cad=0#v=onepage&q=&f=false)，这并不是真正过时的东西。这真的很吸引人，你可能会在那里找到一些有助于使你的形状看起来真实的细节。

# javascript - 将javascript放在标题之外有多糟糕？

> ID：584294
> 
> 赞同：10
> 
> 时间：2009-02-25T00:32:46.940
> 
> 标签：javascript, design-patterns, coding-style

这个问题几乎已经说明了一切。

我开始为我的[周末项目](http://www.my-clock.net)添加一些功能。对我和几个朋友来说，这是一个小应用程序，因为我们是交换生，对我们来说有点用处。

但事情如下，我在 php 中执行此操作并使用包含构建所有内容，以便我可以将代码分开。其中一些代码片段依赖于 javascripts 片段，那么将 javascript 放在正文中间有多糟糕？或者我应该只做双重包含，以便 javascript 留在标题中？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-25T00:35:11.007

这一点也不坏。

[实际上，将脚本标签尽可能晚地放在页面中被认为是一种很好的做法](http://developer.yahoo.com/performance/rules.html#js_bottom)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T00:36:58.180

将 Javascript 放入正文中是非常好的。甚至还有“内联”Javascript 之类的东西。只是不要过度。如果您可以将您的脚本打包到一个单独的文件中（这并不总是可能的），它将使您的代码更易于维护。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T00:54:10.900

这样做有好有坏的理由。

GOOD) 如果脚本对页面 DOM 的构建不重要，最好按照 Jim Puls 的建议尽可能晚地执行，通常位于页面的最底部根 BODY 节点中。这很好，因为它允许 XHTML 立即呈现，从而产生页面“加载速度更快”的心理效果。实际上，它以相同的速度加载，只是当用户盯着白色的浏览器窗口时，浏览器不会花费 CPU 周期来下载、解释和运行 JS。

BAD）脚本标签通常按照它们被包含的顺序下载和解释。这意味着您需要仔细管理它们包含的顺序。此外，由于它们是串行加载的（一次一个），因此您为引用的每个附加文件付出高昂的代价，因为浏览器必须建立连接、检查缓存、下载等。诸如 IE 的“DEFFER”之类的技巧不是标准的。出于这个原因，我强烈建议您在从开发到生产时将您的 javascript 打包到一个文件中，这样用户就不必进行多个串行连接。还要确保您已打开 gzip 压缩。

好）有一种使用 AJAX 延迟加载脚本的方法——你调用你的服务器请求 JS，并在加载文件时引发一个事件。然后，您可以在其上调用 eval（或一些更安全的变体），将其符号带入范围。这允许并行下载脚本。

好与坏）在 IE 中，您必须避免在 DOM 完全加载之前操作 DOM 树。为此查找 'dom:loaded' 事件。

# c# - 如何使用 System.Data.DataTableExtensions 的 CopyToDataTable 方法？

> ID：584299
> 
> 赞同：5
> 
> 时间：2009-02-25T00:33:33.010
> 
> 标签：c#, datatable, generic-list

我想使用 DataTableExtensions 中可用的 CopyToDataTable 方法创建一个给定列表的数据表。我之前问过这个问题[如何将列表转换为数据集？](https://stackoverflow.com/questions/523153/how-do-i-transform-a-listt-into-a-dataset)并从[CMS得到了一个](https://stackoverflow.com/users/5445/cms)[特殊的答案](https://stackoverflow.com/questions/523153/how-do-i-transform-a-listt-into-a-dataset/523168#523168)，即通过创建扩展来实现我想要的`public static DataTable ToDataTable<T>(this IEnumerable<T> collection)`

我一直在使用他的建议......但最近我[在博客](http://www.danielmoth.com/Blog/2007/07/linq-to-dataset.html)中看到已经存在这样的扩展......`CopyToDataTable<T>(this IEnumerable<T> source) : DataTable`它存在于 System.Data.DataTableExtensions 中。

因此，我认为我应该改用这种内置的扩展方法，而不是使用我必须自己维护的方法。

不幸的是，我在弄清楚如何使用它时遇到了一些麻烦。

我可以使用我的 IList 并说 myListofMyClass.CopyToDataTable() 但我收到一个编译错误，上面写着“'MyClass' 类型必须可转换为 'System.Data.DataRow' 才能将其用作泛型中的参数 'T'方法...”

为了使其可转换为 System.Data.DataRow，我需要做一些特别的事情吗？我需要实现一些接口吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T00:43:42.657

请参阅此链接：

[http://blogs.msdn.com/aconrad/archive/2007/09/07/science-project.aspx](http://blogs.msdn.com/aconrad/archive/2007/09/07/science-project.aspx)

基本上，它确实曾经是 Linq 的一部分，但由于某种原因它被删除了。他的方法确实很有效，所以检查一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T00:40:13.820

唉，对于`CopyToDataTable`，`T`必须是`DataRow`（或从 派生的类型`DataRow`）。

（有关详细信息，请参阅[MSDN 文档](http://msdn.microsoft.com/en-us/library/bb396189.aspx)。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T00:41:20.853

这不是你真正想要的。CopyToDataTable 用于将特定的 DataRows 集合复制到 DataTable 中（这是 DataRows 的集合，加上一堆垃圾；CTDT 处理“垃圾”方面。）

# ruby-on-rails - What do $undefined and $end refer to in Ruby?

> ID：584308
> 
> 赞同：1
> 
> 时间：2009-02-25T00:36:50.253
> 
> 标签：ruby-on-rails, ruby, undefined

I used a backslash to continue a Ruby statement on the next line.

```
print abc \
+ def 
```

I added a space after the backslash, because I like to blow things up, and, sure enough, I got an error:

unexpected $undefined, expecting $end

I assume $undefined is a global variable that means anything the compiler sees that it doesn't recognize - in this case the space after the backslash.

Is $end a global variable that refers to the "end of line" character?

Are these globals just global in my program or are they more global than that? Just how global are they?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T00:42:22.723

Those are not global variables. That is just notation used by the parser. `$undefined` appears to mean a blank space or token of no meaning. `$end` is the end of a line or statement.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T00:38:59.283

I'd bet the $ is just a shorthand that the parser/lexer uses to symbolise a token, and not an actual usable variable.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T06:56:23.150

$undefined is referring to the lexer token created by "\ " -- it isn't syntactically valid ruby.

$end lexer token for the end of the file.

-- MarkusQ

# c# - C# .NET 将 InterfaceImplementingClass 对象的集合传递给采用 Interface 对象集合的例程

> ID：584319
> 
> 赞同：5
> 
> 时间：2009-02-25T00:40:31.090
> 
> 标签：c#, .net, generics, interface, clr

我有例行公事

```
public void SomeRoutine(List<IFormattable> list) { ... } 
```

然后我尝试调用这个例程

```
List<Guid>list = new List<Guid>();
list.Add(Guid.NewGuid());
SomeRoutine(list); 
```

它失败并出现编译时错误。System.Guid 实现 IFormattable，但我得到的错误是

> 无法从“System.Collections.Generic.List”转换为“System.Collections.Generic.List”

注意：如果您只使用一组 Guid，您将得到相同的错误。泛型不是原因....

但！鉴于这种

```
public void SomeRoutine2(IFormattable obj) { ... } 
```

还有这个

```
Guid a = Guid.NewGuid();
SomeRoutine2(a); 
```

它编译！所以问题是为什么？为什么我能够将 Guid 对象（实现 IFormattable）传递到接受 IFormattable 对象的例程中，但是当我尝试将其扩展为集合（通用列表、数组或其他任何东西）时，我得到转换错误？

我花了很长时间找到答案，我认为这将是最好的去处。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T00:46:11.403

这就是每个人都在谈论的整个协方差。它将在 .NET 4.0 中运行。

见这里：http: [//blogs.msdn.com/charlie/archive/2008/10/28/linq-farm-covariance-and-contravariance-in-visual-studio-2010.aspx](http://blogs.msdn.com/charlie/archive/2008/10/28/linq-farm-covariance-and-contravariance-in-visual-studio-2010.aspx)

更多阅读：

[http://www.infoq.com/news/2008/08/GenericVariance;jsessionid=188695B18864997E8D360E0EEED5983E](http://www.infoq.com/news/2008/08/GenericVariance;jsessionid=188695B18864997E8D360E0EEED5983E)

[http://blogs.msdn.com/lucian/archive/2008/10/02/co-and-contra-variance-how-do-i-convert-a-list-of-apple-into-a-list- of-fruit.aspx](http://blogs.msdn.com/lucian/archive/2008/10/02/co-and-contra-variance-how-do-i-convert-a-list-of-apple-into-a-list-of-fruit.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-25T04:39:00.063

这是一个经典的泛型用例；尝试：

```
public static void SomeRoutine<T>(IList<T> list) where T : IFormattable
{ ... } 
```

现在在里面`SomeRoutine`你可以访问所有`IFormattable`成员，但它可以使用：

```
List<Guid>list; ...
SomeRoutine(list); // note no need to specify T 
```

编辑：我还写了一篇关于这种情况下 4.0 协方差和泛型之间差异的[博客。](http://marcgravell.blogspot.com/2009/02/what-c-40-covariance-doesn-do.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T01:26:32.133

问题是 List<IFormattable> 不仅是您可以从中读取一些 IFormattables 的集合，它也是您可以添加 IFormattables 的集合。List<Guid> 满足第一个要求，但不满足第二个要求。如果 SomeRoutine 是

```
public void SomeRoutine(List<IFormattable> list)
{
    list.Add(5);
} 
```

该 Int32 是一个 IFormattable，因此该方法应该能够将其添加到它要求的 List<IFormattable> 中。如果编译器允许您传入 List<Guid>，这将不起作用。

BFree 引用的新 C# 4.0 功能将让您告诉编译器这些东西何时是安全的。你可以说

*   虽然我要求提供 IFormattable 参考，但我只会阅读它。如果它真的是一个 Guid 引用，那么我可以安全地将其视为 IFormattable，并且我不会尝试为其分配 Int32。
*   虽然我要求提供 IFormattable 参考，但我只会写信给它。如果它真的是一个对象引用，那么我可以安全地将我的 IFormattable 分配给它，并且当前值是否不是 IFormattable 并不重要，因为我不会读取它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T00:46:18.343

您是否尝试过声明`list`为`List<IFormattable>`object 而不是 a `List<Guid>`？那应该可以让您克服编译错误。

# dns - 您将如何使用 DNS 自动创建子域？

> ID：584326
> 
> 赞同：4
> 
> 时间：2009-02-25T00:41:49.557
> 
> 标签：dns

我想以编程方式自动更新我的 DNS 更多域。我在 GoDaddy 上运行 BIND 服务器（在 FreeBSD 上）以及主机域和 DNS。我找不到让 GoDaddy 访问和更新他们托管的 DNS 的 Web 服务 API，因此我可能不得不使用我的 BIND 服务器来提供动态解决方案。

基本上我只想查询哪些子域已经存在并添加新的子域。

BIND 是最好的解决方案吗？是否有其他方法可以自动添加新域，而无需我登录 GoDaddy 或手动更新我的 BIND 配置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T01:02:34.700

一种方法是编写一个程序来读取和/或更新 BIND 配置文件（它只是一个具有特定格式的文本文件）并在进行任何更改时重新加载 BIND 守护程序。因此，就好像您手动更新了 BIND 配置一样，除非您已经编写了一个程序来为您执行此操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T01:17:23.263

添加新子域所需的功能是动态更新，如[RFC 2136](http://www.ietf.org/rfc/rfc2136.txt)中所指定，并且受到 BIND 的良好支持。

使用 DNS "UPDATE" 消息从区域文件中添加和删除记录相当容易（例如使用 Perl 的 Net::DNS 模块）。

要实际检索那里的内容，您有两种方法：

1.  将其他一些数据库视为确定的，并将该数据库中的更改转换为 ddns 更新，或者。

2.  允许 DNS“AXFR”消息允许您下载整个区域内容（尽管只下载到您的区域管理系统，而不是整个世界！）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T01:20:56.233

仅供参考：这是一个系统/网络管理问题，而不是编程问题。您可能在其他地方可以更快地得到更好的答案。

也就是说......这相当简单：您只需要一个支持其数据的数据库后端的 DNS 服务器。然后，您只需将条目写入数据库，或查询数据库中的内容，DNS 记录将自动提供。理想情况下，使用支持触发器的数据库，这样您就可以让 DNS 记录的序列号在更改时自动更新。否则，您需要在代码的每次更改中读取/写入序列号，在事务中进行整个更新。

编辑：刚刚看到上面的其他评论。不允许 AXFR。如今，这被认为是一种安全风险。

不过，请务必将域 TTL 设置得较低，以便更新快速传播到其他服务器。

# javascript - 如何将数据差异（可能是 JSON）推送到服务器？

> ID：584338
> 
> 赞同：21
> 
> 时间：2009-02-25T00:47:13.630
> 
> 标签：javascript, json, diff

我将定期将一组基于文本的数据**从网页推送到服务器**，可能是 JSON。

对于每次推送，都可能没有、部分或全部数据发生变化。为了减少我必须通过网络发送的数据量，我只想发送每次推送中更改的差异。

您是否知道任何预制的解决方案/工具/库：

*   **在对其进行更改时动态构建 JSON 的 diff**（以避免存储 oldJson 和 newJson 并在每次推送时执行完整的 diff），用 JavaScript 编写（即用于客户端）
*   **在服务器端使用 JSON diff 修补现有的 JSON 块，**在任何不是 Java 或 .NET 的平台上编写^（需要在 linux 上运行，Java 不是我所在环境的选项，Mono 也不是）。

此外，这甚至是解决这个特定问题的最佳方法吗？**有没有更好的方法来推送大量文本数据？**

**编辑：**一些澄清：

*   可能的数据结构基本上是一个相当平坦的节点集合（从某种意义上说，它是高度连接的，因此任何链接都将是基于 ID 的引用而不是实际的嵌套数据）节点集合。节点包含一组树，这些树的叶子包含实际的“原始”数据，例如数字、字符串和 ID。大多数数据更改将在叶子中。
    *   大多数叶子数据将非常小（原始数据或少于一段文本），但有些会很长（“富”文本页面）。
*   目前我们可以严格地考虑这是一对一的，即只有一个客户端连接（读/写）到任何特定的数据结构。
*   就复杂性而言，将服务器保持在尽可能小会很好——这个想法是尽可能地远离拥有服务器。虽然 HTML5 仍然大部分不受支持，但我仍然需要一个来存储数据......

***^****您对随机共享主机的期望。我说的是你的好朋友 PHP、Python、PERL、Ruby，还有那些fullas。*或者，可以轻松安装在随机共享主机上的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T01:54:21.783

[EtherPad](http://etherpad.com/)解决了这样的问题，将每个源更改转换为可以是可交换、关联等的数学运算。不过，我认为这是一个不平凡的问题，并且 EtherPad 能够围绕该问题的解决方案开展业务。

编辑：有趣的是，这正是像 Git 这样的优秀 DVCS 解决的问题，而不是在浏览器上。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-25T01:07:39.323

这也是我一直在努力解决的问题。如果其他人提供比我更好的答案，我会非常感兴趣，但目前......

首先，有[http://www.xn--schler-dya.net/blog/2008/01/15/diffing_json_objects/](http://www.xn--schler-dya.net/blog/2008/01/15/diffing_json_objects/)

我个人无法让这个库工作，但你的里程可能会有所不同。

另一种选择是不尝试使用 DIFF 算法解决问题。这是非常低效的，并且根据问题，即使您最终会重复自己，也可能仅发送整个数据块即可获得更好的性能指标。这主要适用于非常小的数据块。显然，随着您需要传输的数据变大，将会出现一个转折点，但如果没有某种测量，转折点在哪里并不明显。这里的诀窍是，您的数据越大，您的差异计算也将花费越长的时间。转折点仅由每种方法的增长率形成的两条线的交点确定，这两条线都将是线性的或更糟，具体取决于您的差异的实现方式。在最坏的情况下，

尝试 diff 之前的下一站是将您的数据访问包装在跟踪所做更改的“get”、“set”和“delete”方法中。您通过网络发送的数据本质上是这些方法使用情况的顺序日志，您在每次成功传输时从客户端刷新。在服务器端，您将此日志应用到您的服务器端数据，服务器端类似于您的数据访问方法。这是一个比不需要那么多处理能力的差异更轻的解决方案。

最后，如果你要做差异，我能想到的最有效的方法是你是否可以将数据集分解为离散的“块”，每个块都有一个唯一的 ID。然后，当您运行 diff 时，diff 的过程恰好处于“块”级别。也就是说，您要做的唯一比较是 ID 与 ID。如果你改变一个块，给它一个新的 id。你能负担得起 diff 算法的课程越多，运行所需的时间就越少。

或者，您可以简单地运行 diff 以检查特定对象是否已“更改”，而不是在更改时分配新 ID，一旦检测到更改就停止，并简单地标记该块以在其中重新发送实体，用相同的 ID 更新服务器端的块。如果您有某种用于块的快速散列算法，您可以使用它来快速建立相等性，这可能会变得更加高效。

如果您的块的顺序无关紧要，或者如果您可以将序列存储为块本身的属性，而不是通过块的物理序列建模，那么您甚至可以通过 ID 对块进行键控。然后发现差异只需列出对象 A 的键，然后在对象 B 上查找它们，然后反之亦然。这比“真正的”差异算法实现起来要简单得多，它具有 O(a+b) 性能（我认为）比真正的差异算法的最坏情况要好，如果你有可能会得到'正在尝试自己实现它，或者得到一个糟糕的实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-16T11:43:36.677

我今天发布了一个小型 jQuery 插件，用于在两个 JS 对象之间进行比较。 [http://plugins.jquery.com/project/jquery-diff](http://plugins.jquery.com/project/jquery-diff)

我将它用于应用程序以仅将修改后的数据发送到服务器后端。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T01:45:51.400

为什么首先创建一个差异不是更有效地挂钩更改数据的事件并根据更改生成更改的数据集吗？由于您的代码将嵌入浏览器中，因此您将仅限于 JavaScript，因此生成差异可能会降低您的应用程序的性能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-22T00:55:46.210

它不支持 JSON，但 Google 似乎使用了一种用于 Docs 的方法（他们的上述 Etherpad 问题的版本）。

[http://code.google.com/p/google-diff-match-patch/](http://code.google.com/p/google-diff-match-patch/)

它不支持 JSON，但它允许您在 JavaScript 中生成有效的差异客户端，并让服务器使用适当的实现（Java、JavaScript、C++、C#、Objective C、Lua 或 Python）应用它）。

这个对另一个问题的回答可能很有用，尤其是关于 google-diff-match-patch 的修改版本的部分：[Textually diffing JSON](https://stackoverflow.com/questions/4599456/textually-diffing-json/4599500#4599500)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-04-22T09:08:15.240

该库计算完整的 JSON 差异（包括字符串差异）：[https ://github.com/kbadk/json0-ot-diff](https://github.com/kbadk/json0-ot-diff)

diff 格式基于这个项目[https://github.com/ottypes/json0](https://github.com/ottypes/json0)，它提供了一个库，可以将差异“应用”到对象。

该相关项目处理 OT diff 对持久化数据的应用，并将 diff 广播到多个客户端以进行实时协作：[https ://github.com/share/sharedb](https://github.com/share/sharedb)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T01:46:23.927

这里有一篇毕业论文，要找到一个解决方案，它既是“新事物”的有效传输，又与 Web 架构配合得很好（在服务器上缓存和保存最少量的状态）。

我很好奇外面有什么；我一直在努力解决同样的问题，@Breton 的答案中的“块”想法有点像我要去的地方，但不确定如何去做。

编辑：等等——我把这个倒过来了，我以为你在谈论服务器计算差异以发送给客户端。

也许您可以模糊地描述发送到服务器的客户端上的数据结构。如果可能的话，我不会基于 JSON 文本本身来做这件事；从 Javascript 中做差异。如果它是具有已知结构的项目列表，请跟踪您已发送到服务器的项目并发送其余项目。如果它是一个更复杂的数据集，不知道如何帮助你。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-08-21T11:31:24.743

看看[JSON 补丁](http://jsonpatch.com)：

> JSON Patch 是一种用于描述 JSON 文档更改的格式。**它可用于避免在仅部分更改时发送整个文档**。当与 HTTP PATCH 方法结合使用时，它允许以符合标准的方式对 HTTP API 进行部分更新。
> 
> 补丁文档本身就是 JSON 文档。
> 
> JSON 补丁在 IETF 的 RFC 6902 中指定。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2012-02-24T10:56:44.933

“我现在创建了一种返回两个 JSON 对象之间结构差异的方法。”

[http://www.xn--schler-dya.net/blog/2008/01/15/diffing_json_objects/](http://www.xn--schler-dya.net/blog/2008/01/15/diffing_json_objects/)

# vba - 根据节号表示的位置以编程方式生成书签

> ID：584342
> 
> 赞同：1
> 
> 时间：2009-02-25T00:51:34.480
> 
> 标签：vba, ms-word

我有一个带有链接的 HTML 页面，当单击这些链接时会打开到 word 文档中的特定书签。我正在使用没有预先存在的书签的现有 word 2003 文档。我想使用宏或 VBA 脚本将书签添加到所有节号标题位置。例子

> 3.1.4.2 这里的东西
> 3.1.4.2.1
> 这里又是
> 更多的东西 3.1.4.2.1.1 这里
> 又是
> 更多的东西 3.1.4.2.2
> 这里又是更多的东西

我想用标准的名称格式为所有以 XXX.. 开头的行添加书签。

示例（使用以上作为参考）

3.1.4.2 HERE 行将有一个名为 M_3_1_4_2 的书签
3.1.4.2.1 Here 将再次有一个名为 M_3_1_4_2_1 的书签

等等

我的问题是我需要采用 VBA 脚本或宏的哪种方法来实现这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T03:39:31.703

如果您已经拥有范围对象，则添加书签很容易。

```
ActiveDocument.Bookmarks.Add Name:=rngBookmark.Text, Range:=rngBookmark 
```

获得范围通常是一项艰巨的任务。现在你说这些是节标题。它们是实际的单词部分标题吗？它们是用某种风格划分的吗？它们是在文档正文中还是在页眉中？

您可以像这样循环浏览文档的各个部分，并将范围设置为该部分的开头。

```
Dim sectCurrent As Word.Section
Dim rngCurrent As Word.Range
For Each sectCurrent In ActiveDocument.Content.Sections

   ' get range that refers to the whole section
   Set rngCurrent = sectCurrent.Range.Duplicate

   ' collapse the range to the start of the section
   rngCurrent.Collapse wdCollapseStart

   ' expand the range to hold the first "word"
   ' you can also use other units here like wdLine
   rngCurrent.MoveEnd Unit:=wdWord, Count:=1

   ' now that you have the range you can add the bookmark
   ' you can process the range and create your own name with a custom function GenerateBookmarkName.  To get the string, just use rngCurrent.Text.
   ActiveDocument.Bookmarks.Add Name:=GenerateBookmarkName(rngCurrent), Range:=rngCurrent

Next sectCurrent 
```

现在，如果它们不是实际的部分，您通常会希望使用 Find 对象在文档中查找某些内容并遍历所有此类项目。这里的诀窍是知道要搜索什么。下面是一个示例循环。

```
 ' setup range object for search results
   Set rngFind = ActiveDocument.Content

   ' cycle through search results looking for whatever
   With rngFind.Find

      ' search text
      .Text = "FINDME"
      .Format = False
      .Wrap = wdFindStop

      ' loop while find is successfull
      Do While .Execute

         ' get range you can modify based on found item
         ' each time you call .Execute rngFind is changed to the found text
         Set rngModifyMe = rngFind.Duplicate    

      Loop

   End With 
```

如需更多 word vba 帮助，您可以在此处访问 word MVPs 站点：[http ://word.mvps.org](http://word.mvps.org)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-31T08:47:39.873

```
 Public Sub HeadingsToBookmarks()
        Dim strText As String
        Dim heading As Range
        Dim hpara As Range
        Dim ln As Integer
        Set heading = ActiveDocument.Range(Start:=0, End:=0)
        Do
            Dim current As Long
            current = heading.Start
            Set heading = heading.GoTo(What:=wdGoToHeading, Which:=wdGoToNext)
            If heading.Start = current Then
                Exit Do
            End If
            Set hpara = heading.Paragraphs(1).Range
            strText = Trim(Left(hpara.Text, Len(hpara.Text) - 1))
            ln = Len(strText)
            If ln > 0 Then
                strText = Trim(RegExp_Replace(strText, "[0-9./-]*", ""))
                strText = Trim(RegExp_Replace(strText, " +", "_"))
                ActiveDocument.Bookmarks.Add Name:=strText, Range:=heading.Paragraphs(1).Range
            End If
        Loop
    End Sub
    Function RegExp_Replace(ReplaceIn, sPattern As String, ReplaceWith As String, Optional IgnoreCase As Boolean = False, _
        Optional GlobalMatch As Boolean = False, Optional bMultiLine As Boolean = False)
        Dim RE
        Set RE = CreateObject("vbscript.regexp")
        RE.Pattern = sPattern
        RE.IgnoreCase = True
        RE.Global = True
        RE.MultiLine = True
        RegExp_Replace = RE.Replace(ReplaceIn, ReplaceWith)
    End Function 
```

# c++ - 机器相关的 _write 失败并带有 EINVAL 错误代码

> ID：584347
> 
> 赞同：3
> 
> 时间：2009-02-25T00:53:44.397
> 
> 标签：c++, c, debugging, visual-c++

这在实际问题之前有一些冗长的背景，但是，它有一些解释，希望能消除一些红鲱鱼。

我们的应用程序是用 Microsoft Visual C++ (2005) 开发的，它使用第 3 方库（我们幸运地拥有它的源代码）来导出在另一个第 3 方应用程序中使用的压缩文件。该库负责创建导出的文件、管理数据和压缩，并通常处理所有错误。最近，我们开始收到反馈，在某些机器上，我们的应用程序在写入文件时会崩溃。基于一些初步探索，我们能够确定以下内容：

*   崩溃发生在各种硬件设置和操作系统上（尽管我们的客户仅限于 XP / 2000）
*   崩溃总是发生在同一组数据上；但是它们不会出现在所有数据集上
*   对于导致崩溃的一组数据，崩溃并非在所有机器上都可重现，即使具有相似的特征，即操作系统、RAM 量等。
*   该错误只会在应用程序在安装目录中运行时才会出现 -**从**Visual Studio 构建、在调试模式下运行或什至在用户有权访问的其他目录中运行时不会出现
*   无论文件是在本地驱动器还是映射驱动器上构建，都会出现此问题

在调查问题后，我们发现问题出在以下代码块中（稍作修改以删除一些宏）：

```
 while (size>0) {
    do {
        nbytes = _write(file->fd, buf, size);
    } while (-1==nbytes && EINTR==errno);
    if (-1==nbytes) /* error */
        throw("file write failed")
    assert(nbytes>0);
    assert((size_t)nbytes<=size);
    size -= (size_t)nbytes;
    addr += (haddr_t)nbytes;
    buf = (const char*)buf + nbytes;
} 
```

具体来说，_write 返回错误代码 22 或 EINVAL。根据[MSDN](http://msdn.microsoft.com/en-us/library/1570wh78(VS.80).aspx)， _write 返回 EINVAL 意味着缓冲区（在这种情况下为 buf）是一个空指针。然而，围绕这个函数的一些简单检查验证了对它的任何调用都不是这种情况。

但是，我们确实会使用一些非常大的数据集调用此方法 - 在一次调用中超过 250MB，具体取决于输入数据。当我们对进入此方法的数据量施加人为限制时，我们似乎已经解决了这个问题。但是，这有点像代码修复了与机器相关/权限相关/取决于月相的问题。所以现在的问题：

1.  有谁知道 _write 在一次调用中可以处理的数据量有限制吗？或者 - 禁止 _write - Visual C++ 支持的任何文件 I/O 命令？
2.  由于这不会发生在所有机器上 - 甚至在每个足够大小的调用上（一个 250 MB 的调用都可以工作，另一个调用不会） - 是否有人知道用户、机器、组策略设置或文件夹权限会影响这个吗？

**更新：** 其他几点，从到目前为止的帖子：

*   我们确实处理大缓冲区分配失败的情况。出于性能原因，在读取我们正在创建的文件的第 3 方应用程序中，我们希望将所有数据写在一个大块中（尽管出现此错误，但可能无法实现）
*   我们在上面的例程中检查了 size 的初始值，它与分配的缓冲区的大小相同。此外，当引发 EINVAL 错误代码时，大小等于 0，并且 buf 不是空指针 - 这让我认为这不是问题的原因。

**另一个更新：**

下面是一个失败示例，上面的代码示例中有一些方便的 printfs。

```
 while (size>0) {
    if (NULL == buf)
    {
        printf("Buffer is null\n");
    }
    do {
        nbytes = _write(file->fd, buf, size);
    } while (-1==nbytes && EINTR==errno);
    if (-1==nbytes) /* error */
    {
        if (NULL == buf)
        {
            printf("Buffer is null post write\n");
        }
        printf("Error number: %d\n", errno);
        printf("Buffer address: %d\n", &buf);
        printf("Size: %d\n", size);
        throw("file write failed")
    }
    assert(nbytes>0);
    assert((size_t)nbytes<=size);
    size -= (size_t)nbytes;
    addr += (haddr_t)nbytes;
    buf = (const char*)buf + nbytes;
} 
```

失败时，将打印出：

```
Error number: 22
Buffer address: 1194824
Size: 89702400 
```

请注意，没有成功写入任何字节并且缓冲区具有有效地址（并且没有触发 NULL 指针检查，pre 或 post _write）

**最后更新**

不幸的是，我们被事件所克服，无法最终解决这个问题。我们能够找到一些有趣（甚至可能令人不安）的事实。1\. 错误只发生在硬盘写入时间较慢的机器上。具有完全相同硬件规格但 RAID 配置不同（RAID 0 与 RAID 1）的两台 PC 会产生不同的结果。RAID 0 会正确处理数据；RAID 1 会失败。同样，硬盘速度较慢的旧 PC 也会出现故障；具有更快硬盘驱动器但类似处理器/内存的较新PC可以工作。2\. 写入大小很重要。当我们将传递给 _write 的数据量限制为 64 MB 时，除了一个文件之外的所有文件都成功了。当我们将其限制为 32 MB 时，所有文件都成功了。

不幸的是，我从来没有得到一个很好的答案（我们正要就此打电话给微软，但我们不得不让业务部门签署技术支持电话的费用）关于为什么首先返回 EINVAL。它不是 - 从我们能够找到的 - 记录在 C 库 API 的任何地方。

如果有人确实找到了一个好的答案，请在此处发布，我会将其标记为答案。我很想得到这个传奇的结论，即使它不再直接适用于我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-29T13:01:09.417

我们有一个非常相似的问题，我们设法很容易地重现。我们首先编译了以下程序：

```
#include <stdlib.h>
#include <stdio.h>
#include <io.h>
#include <sys/stat.h>
#include <fcntl.h>

int main(int argc, char *argv[])
{ int len = 70000000;
  int handle= creat(argv[1], S_IWRITE | S_IREAD);
  setmode (handle, _O_BINARY);
  void *buf = malloc(len);
  int byteswritten = write(handle, buf, len);
  if (byteswritten == len)
    printf("Write successful.\n");
  else
    printf("Write failed.\n");
  close(handle);
  return 0;
} 
```

现在，假设您在计算机 mycomputer 上工作，并且 C:\inbox 映射到共享文件夹 \\mycomputer\inbox。然后观察以下效果：

```
C:\>a.exe C:\inbox\x
Write successful.

C:\>a.exe \\mycomputer\inbox\x
Write failed. 
```

注意如果len改成60000000就没有问题了...

基于此网页[support.microsoft.com/kb/899149](http://support.microsoft.com/kb/899149)，我们认为这是“操作系统的限制”（使用 fwrite 观察到了相同的效果）。我们的解决方法是在失败时尝试将写入减少为 63 MB。此问题显然已在 Windows Vista 上得到纠正。

我希望这有帮助！西蒙

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T05:52:31.213

您是否查看了`_write()`与 Visual Studio ( ) 一起安装的 CRT（C 运行时）源代码中的实现`C:\Program Files\Microsoft Visual Studio 8\VC\crt\src\write.c`？

至少有两个条件导致`_write()`设置`errno`为`EINVAL`：

1.  `buffer`是NULL，正如你提到的。
2.  `count`当文件以 UTF-16 格式（或 UTF-8？注释与代码不匹配）以文本模式打开时，参数为奇数。这是文本文件还是二进制文件？如果是文本，是否有字节顺序标记？
3.  也许另一个`_write()`调用的函数也设置`errno`为`EINVAL`？

如果您可以可靠地重现此问题，您应该能够通过在设置错误代码的 CRT 源的部分中放置断点来缩小错误的来源。似乎 CRT 的调试版本能够在错误发生时断言，但它可能需要[调整一些选项](http://msdn.microsoft.com/en-us/library/1y71x448.aspx)（我没有尝试过）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-27T17:05:03.657

根据[http://msdn.microsoft.com/en-us/library/1570wh78(v=VS.90).aspx](http://msdn.microsoft.com/en-us/library/1570wh78(v=VS.90).aspx) errno 可以取值：

```
- EBADF
- ENOSPC
- EINVAL. 
```

Windows 上没有 EINTR。随机系统中断导致此错误并且未被测试捕获`while (-1==nbytes && EINTR==errno);`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T01:11:40.607

有两个想法浮现在脑海中。要么你走过缓冲区的末端，并试图写出该数据，要么缓冲区的分配失败。在调试模式下不会像在发布模式下那样明显的问题。

无论如何分配 250 兆内存可能是个坏主意。您最好分配一个固定大小的缓冲区，并以块的形式进行写入。

您是否寻找过诸如病毒扫描程序之类的东西，它们可能会在您的写入操作之间保留文件，从而导致写入失败？

我知道在一次调用中可以传递写入的数据量没有限制，除非（就像我说的那样），您正在写入不属于您的数据（作为缓冲区的一部分）......

由于这些函数中的大多数都包装了内核调用 WriteFile()，（或 NtWriteFile()），因此可能存在没有足够的内核内存来处理要写入的缓冲区的情况。但是，我不确定，因为我不知道代码何时从 UM 跳转到 KM。

不知道这是否会有所帮助，但希望它会...

如果您可以提供更多详细信息，请提供。有时只是告诉某人这个问题会触发你的大脑去“等一下！”，你会弄明白的。呵呵。。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T01:47:48.400

您可能会因不小心在其他地方误用指针而破坏自己的堆栈 - 如果您能找到一台重现机器，请尝试在应用程序验证程序下运行您的应用程序并打开所有内存检查

# xaml - 用于 XAML 编辑的 VIM

> ID：584359
> 
> 赞同：2
> 
> 时间：2009-02-25T01:00:23.193
> 
> 标签：xaml, vim

VIM 可以用于 XAML 编辑吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-05-02T20:21:57.833

将以下内容添加到您的 filetype.vim（这将在您的 $VIM/vim72 目录中，或者您可以在您自己的个人 .vim 目录中创建一个）。这将告诉 Vim 自动将 xaml 文件的文件类型设置为 xml。

```
" Xaml
au BufNewFile,BufRead *.xaml        setf xml 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-25T01:39:29.963

将此行放在源文件的底部，您应该与 VS2008 兼容：

```
<!-- vim: tw=120 ts=4 sw=4 et syn=xml : 
--> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T01:14:58.603

是的。XAML 实际上只是 XML，因此是纯文本。

这是一个“Hello World”示例。

```
<Canvas xmlns="http://schemas.microsoft.com/client/2007"  
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <TextBlock>Hello World!</TextBlock>
</Canvas> 
```

如果您还没有 XML 插件，您可能想尝试[xmledit](http://www.vim.org/scripts/script.php?script_id=301)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T01:50:28.097

如果你想要完整的智能感知等......可能值得探索的一个选项是[ViEmu](http://www.viemu.com/)，它为 Visual Studio 带来了 vim 键绑定。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T01:02:32.220

当然。为了获得更好的体验，请尝试一些 XML 插件（用于折叠等）并打开语法高亮。

# xml - 在 actionscript 中，检查 xml 节点属性是否存在的最佳方法是什么？

> ID：584361
> 
> 赞同：4
> 
> 时间：2009-02-25T01:01:34.097
> 
> 标签：xml, apache-flex, flash, actionscript-3, properties

如果我有一些像这样的xml：

```
<books>
    <book title="this is great" hasCover="true" />
    <book title="this is not so great" />
</books> 
```

在针对它编写一些代码之前检查 hasCover 属性是否存在的最佳（或可接受的）方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-25T14:23:03.030

只是为了增加一些精度。

如果你想检查属性是否存在，即使它是空的，你绝对应该使用 hasOwnProperty ：

```
var propertyExists:Boolean = node.hasOwnProperty('@hasCover'); 
```

检查内容的长度有点脏，如果属性的值为空，将返回 false。您甚至可能会抛出运行时错误，因为您将尝试访问空对象 (hasCover) 上的属性（长度），以防该属性不存在。

如果您想测试属性是否存在并且值是否已设置，您应该尝试**从 hasOwnProperty 开始，**以便在属性不存在的情况下忽略值测试（最终的运行时错误）：

```
var propertyExistsAndContainsValue:Boolean = (node.hasOwnProperty('@hasCover') && node.@hasCover.length()); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T17:12:08.797

好的 - 我今天遇到了这个问题，a.）它被 Ely Greenfield 使用过，b.）它非常简单，所以我必须将其标记为答案，除非有人能找到不这样做的理由......

```
if("@property" in node){//do something} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-25T01:09:49.037

请参阅[问题 #149206：“确定 Flex 中是否存在 XML 属性的最佳方法”](https://stackoverflow.com/questions/149206/best-way-to-determine-whether-a-xml-attribute-exists-in-flex/149316#149316)。

我建议这样做`event.result.hasOwnProperty("@attrName")`，但Theo[获得最多支持的答案](https://stackoverflow.com/questions/149206/best-way-to-determine-whether-a-xml-attribute-exists-in-flex/149794#149794)（在撰写本文时）表明了这一点：

```
event.result.attribute("attrName").length() > 0 
```

# c# - C#：PageParserFilter 和 ProcessCodeConstruct

> ID：584362
> 
> 赞同：2
> 
> 时间：2009-02-25T01:01:36.047
> 
> 标签：c#

我试图阻止用户控件拥有和 <% ... %> 。我对 PageParserFilter 进行了子类化，以尝试使用 ProcessCodeConstruct() 方法来检测何时解析代码块并导致错误。使用调试器，我能够看到我重写的 PageParserFilter 的其他方法正在按预期调用，但 ProcessCodeConstruct 不是。知道何时调用 ProcessCodeConstruct 吗？如果没有，是否有另一种方法来完成我想要做的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T23:35:30.287

事实证明 ProcessCodeConstruct 仅在第一次编译页面时调用。我们让它按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T01:12:25.473

你为什么要限制用户控件的功能？我发现在脚本块中使用 <%,,,%> 来获取客户端 ID 很方便。只是好奇你的理由是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T01:19:03.040

为什么要调用 ProcessCodeConstruct？
我觉得应该和设置AllowCode的值有关。

# javascript - 如何在 Javascript 循环中重新绘制 HTML 元素？

> ID：584370
> 
> 赞同：4
> 
> 时间：2009-02-25T01:07:41.833
> 
> 标签：javascript, colors

我有一些 Javascript 可以“动画化” HTML 元素的颜色变化，如下所示：

```
var element = document.getElementById("someid");
while (i < 255) {
    element.style.color = 'rgb(' + i + ',' + i + ',' + i + ')';
    i++;
    slowMeDown(); // This function runs for a few ms to slow the process down
} 
```

如您所见，这会将颜色从黑色变为白色，中间经过 255 种灰色阴影。我想让它明显地“淡出”，以便用户可以看到文本逐渐消失。

但是，浏览器（Chrome 和 IE - 尚未在 Firefox 上测试）仅在函数结束时刷新，因此颜色只是从黑色变为白色。有谁知道如何在循环期间使浏览器重新绘制，以便我可以看到文本褪色？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-25T01:12:06.677

```
function changeColor()
{
    changeColorIncremental(0);
}

function changeColorIncremental(i)
{
    var element = document.getElementById("someid");

    element.style.color = 'rgb(' + i + ',' + i + ',' + i + ')';

    if (i < 255) {
        // Note the 50 millisecond wait below.  Decrease this to speed up
        // the transition, and increase it to slow it down.
        setTimeout('changeColorIncremental(' + (i + 1) + ')', 50);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T01:11:37.987

你应该看看 JQuery。它将使用[效果功能](http://docs.jquery.com/Effects)或插件为您完成所有这些工作。

但是在回答这个问题时：

通常，Web 浏览器只使用一个 UI 更新线程，该线程也用于执行 Javascript 代码。因此，浏览器将完全执行您的循环，并且只有在完成后才更新页面（即所有 RGG = 255,255,255）。

尝试使用 window.setTimeout 或 window.setInterval 来调用增加 RGB 值的函数。这允许浏览器 UI 更新线程在每次调用后（在间隔或超时之间）更新显示。

（我相信所有主流浏览器都以这种方式运行，包括 Firefox）。

注意： setInterval 和 setTimeout 在同一个 UI 线程上执行代码。他们只需在窗口消息循环中添加一个计时器回调，它就会在正确的时间被调用和执行。

因此，如果当时正在执行其他 Javascript 代码或 UI 更新，则计时器函数必须等待。所以不能保证函数在指定的时间发生。此外（在 Windows 上）最大分辨率远小于 1 毫秒，通常约为 1/20 秒或约 50 毫秒。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T06:06:14.877

你的 slowMeDown() 函数是在 Javascript 中延迟事情的不好方法。原因是浏览器中的 JS 实现是单线程的。这意味着一次只能执行一项任务。通常，浏览器本身会“冻结”等待 JS 完成。这就是您的情况 - 您的循环永远不会将控制权返回给浏览器以实际更新 DOM 元素。

使用此处其他一些人提出的 setTimeout() 或 setInterval() ，通过将流控制返回给浏览器并请求它在指定的毫秒数内回叫您来解决此问题。

此外，如果您打算让文本褪色，请考虑使用各种方法来设置 CSS 不透明度（不幸的是，鉴于浏览器支持的状态，您必须在样式对象上设置三个不同的值）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T01:10:17.413

我会用`colourChangeTimer = setInterval(function() { //colour change code }, 100);`

然后在达到`255`所有值后，使用`clearTimeout(colourChangeTimer)`.

*原谅我的澳大利亚拼写。*

# listbox - 使用 Firefox XUL，是否可以用样式消除列表框边框？

> ID：584373
> 
> 赞同：2
> 
> 时间：2009-02-25T01:08:17.247
> 
> 标签：listbox, xul

我有以下 XUL 片段，它工作正常，但在整个列表框周围放置了一个 1 像素的边框。我尝试了许多 CSS 样式，但无法消除边框。

有任何想法吗？

```
<listbox>
 <listhead>
  <listheader id="adj_lh_1" label = "one"/>
  <listheader id="adj_lh_2" label = "two"/>
 </listhead>
  <listcols>
   <listcol flex="1" />
   <listcol flex="1" />
  </listcols>
 <listitem>
  <listcell id="adj_li_1"  label="data one" />
  <listcell id="adj_li_1"  label="data two" />
 </listitem>
</listbox> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T21:02:56.197

您可以应用“-moz-appearance: none;” CSS 中的样式规则。

例如。：

> 列表框 {
> 
> -moz 外观：无；
> 
> -moz-border-bottom-colors：无；
> 
> -moz-border-top-colors：无；
> 
> -moz-border-left-colors：无；
> 
> -moz-border-right-colors：无；
> 
> 边框：无；
> 
> }

# php - 正则表达式基础：在两个常量之间抓取文本

> ID：584375
> 
> 赞同：2
> 
> 时间：2009-02-25T01:09:46.620
> 
> 标签：php, regex

在 PHP 中遇到一个（相当简单的）正则表达式问题。

埋在一堆文本中的是这一部分：

```
 &lt;tr&gt;
        &lt;td id=&quot;descriptionArea&quot;&gt;
            Customer request to remove &quot;Intro - 01/13/09&quot; video clip.
            &lt;br/&gt;
        &lt;/td&gt;
    &lt;/tr&gt; 
```

我想要介于两者之间的任何东西：

```
descriptionArea&quot;&gt; 
```

...和...

```
&lt;/td&gt; 
```

有朋友建议：

```
$pattern = '&lt;td=&quot;descriptionArea&quot;&gt;\s*(.*?)\s*&lt;';
$clean = preg_replace("'[\n\r\s\t]'","",$text); // to rid of line breaks
preg_match($pattern, $clean, $matches);
print_r($matches); 
```

但我收到以下错误：

```
Warning: preg_match() [function.preg-match]: Unknown modifier 'q' 
```

我想第二个问题是 preg_match 是否也是正确的 PHP 函数。我应该改用 ereg 吗？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T12:36:51.960

使用`preg_*`函数时，第一个字符或模式被视为分隔符：

> 表达式必须包含在分隔符中，例如正斜杠 ( `/`)。任何字符都可以用作分隔符，只要它不是字母数字或反斜杠 ( `\`)。如果必须在表达式本身中使用分隔符，则需要使用反斜杠对其进行转义。从 PHP 4.0.4 开始，您还可以使用 Perl 风格`()`的 、`{}`、`[]`和`<>`匹配的分隔符。
> —[正则表达式（Perl 兼容）— 简介](http://docs.php.net/manual/en/intro.pcre.php)

所以你不需要`&`像其他人说的那样转义或替换字符。而是使用适当的分隔符并转义表达式中的这些字符：

```
'/&lt;td id=&quot;descriptionArea&quot;&gt;(.*?)&lt;\/td&gt;/' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T01:29:00.660

你会想要避开“&”，就像 wombleton 说的那样，并用正斜杠括起来你的模式，比如 $pattern = "/pattern/";

下面的代码返回一个数组，其中包含一些丑陋的东西，但至少它返回一个匹配项.. :)

```
$description = " &lt;tr&gt;
        &lt;td id=&quot;descriptionArea&quot;&gt;
            Customer request to remove &quot;Intro - 01/13/09&quot; video clip.
            &lt;br/&gt;
        &lt;/td&gt;
    &lt;/tr&gt;";

$pattern = "/&lt;td.*[&]quot;descriptionArea[&]quot;[&]gt;\s*(.*?)\s*.*?lt/";
$clean = preg_replace("'[\n\r\s\t]'","",$description); // to rid of line breaks

preg_match($pattern, $clean, $matches);
var_dump($matches); 
```

**编辑**

这是一个更好的版本。摆脱所有 HTML 编码，以便您可以使用标准的 HTML 解析正则表达式：

```
$pattern = '/<.*?id="descriptionArea">(.*?)<\/td>/';
$clean = preg_replace("'[\n\r\t]'","",htmlspecialchars_decode($description)); 
preg_match($pattern, $clean, $matches); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T01:22:39.723

我怀疑它将与符号解释为某种控制字符。但是，我找不到支持这一点的参考。

`&`尝试用替换所有实例`[&]`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T01:34:49.523

如果你想抓取两个*常量*之间的文本，使用好的 ol'strpos 不是更容易吗？

**编辑**

例如

```
$string = 'text to be >searched< within';
$const1 = '>';
$const2 = '<';
$start = strpos($string, $const1);
$end = strpos($string, $const2, $start + strlen($const1));
$result = substr($string, $start, $end - $start); 
```

我没有运行它，所以它可能是错误的，但你应该明白。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T01:41:55.793

您对 $pattern 使用了以下什么？

```
$pattern = '(?s:descriptionArea&quot;&gt;(.*)&lt;/td&gt;)'; 
```

我不知道 PHP，但是当我测试 RegEx 时，它似乎可以在正则表达式设计器中工作。(?s:) 的选项是“Singleline On”。

标记

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T15:31:27.203

您得到的具体错误来自 preg_* 函数使用模式的第一个字符作为分隔符（在本例中为“&”），以及分隔符第二次出现之后的所有内容作为修饰符（例如“i”表示 case-不敏感。）

在这种情况下，它认为您正在寻找`lt;td=`并且想要修饰符`quot;descriptionArea&quot;&gt;\s*(.*?)\s*&lt;`。第一个修饰符“q”没有意义，它保释了。

# c++ - 用于修改 ZIP 文件的 C++ 库

> ID：584388
> 
> 赞同：5
> 
> 时间：2009-02-25T01:12:57.033
> 
> 标签：c++, zip, archive

我正在寻找一种方法来向/从现有 ZIP 存档或任何其他存档格式添加或删除文件，只要有跨平台 API，而无需重写新的 zip 文件并添加新文件到它，或者没有从中删除的项目。

对于 ZIP 文件，目录位于文件的末尾，因此每次都可能需要重写 zip 文件的某些部分。我只是想避免每次都重写整个事情。我要处理的存档文件会很大，而且速度很重要。

是否有任何 C++ 库可以满足我的需求？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T01:17:49.407

[Zipios++](http://zipios.sourceforge.net/)提供对 ZIP 档案内文件的直接访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-11-13T21:43:51.803

[miniz](https://github.com/richgel999/miniz)库允许您将文件附加到现有存档，而无需通过一个函数调用重写它：

```
mz_zip_error error = MZ_ZIP_NO_ERROR;
mz_bool status = mz_zip_add_mem_to_archive_file_in_place_v2("foo.zip", "bar.txt", "Test", 4, "Comment", 7, MZ_BEST_COMPRESSION, &error); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T01:14:12.443

有几个 zip 库可用，其中两个领先的库是：

[http://www.gzip.org/](http://www.gzip.org/)

[http://www.info-zip.org/](http://www.info-zip.org/)

-亚当

# wcf - wsHttpBinding中的IOutputSessionChannel和IInputSessionChannel，为什么不起作用？

> ID：584394
> 
> 赞同：0
> 
> 时间：2009-02-25T01:16:32.080
> 
> 标签：wcf

有人知道为什么这段代码的输出只是：“Message Sended”吗？输入通道的线程在 channel.Recieve() 上等待。

使用带有 IRequest/ReplyChannel 的 basicHttpBinding 没有这个问题！

```
 static void Main(string[] args)
    {
        WSHttpBinding binding = new WSHttpBinding();
        binding.ReliableSession.Enabled = true;
        binding.ReliableSession.Ordered = true;

        var messsage = System.ServiceModel.Channels.Message.CreateMessage(MessageVersion.Soap11, "hello", "action");
        var senderFacto = binding.BuildChannelFactory<IOutputSessionChannel>();
        var recieveFacto = binding.BuildChannelListener<IInputSessionChannel>(new Uri("http://localhost:9393"));

        senderFacto.Open();
        recieveFacto.Open();

        var sender = senderFacto.CreateChannel(new System.ServiceModel.EndpointAddress("http://localhost:9393"));
        sender.Open();

        sender.BeginSend(messsage, (o) =>
        {
            sender.EndSend(o);
            Console.WriteLine("Message Sended");
            sender.Close();
        },null);

        recieveFacto.BeginAcceptChannel((o) =>
        {
            var channel = recieveFacto.EndAcceptChannel(o);
            channel.Open();
            var message = channel.Receive();
            Console.WriteLine("Message Recieved");
        },null);

        Console.Read();
    } 
```

***解决方案*** 关闭通道上的安全，然后将消息版本更改为 Soap12Adressing10

```
binding.Security.Mode = SecurityMode.None; //Turn off the security
var messsage = System.ServiceModel.Channels.Message.CreateMessage(MessageVersion.Soap12WSAddressing10, "hello", "action"); //Change message version 
```

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T04:58:24.103

这是一个快速的猜测：安全性可能会受到影响。我认为 WSHttpBinding 默认是安全的。尝试关闭安全性。如果这使它起作用，下一步使它与安全性一起使用涉及使用 BindingParameters 来指定“操作”是此通道上消息的合法操作之一。

# iphone - 我可以向 iPhone 输入板上的“完成”按钮添加操作吗？

> ID：584402
> 
> 赞同：1
> 
> 时间：2009-02-25T01:19:24.647
> 
> 标签：iphone, user-input

iphone 的输入板上有一个“完成”按钮，但默认情况下没有任何操作。我可以添加一个动作吗？例如，按下“完成”时隐藏输入板？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T01:23:03.793

在您的键盘委托中，您需要放弃焦点。例如

```
- (BOOL)textFieldShouldReturn:(UITextField *)aTextField 
{
  [aTextField resignFirstResponder];
  return YES;
} 
```

这适用于完成键和返回键。

# c# - 无法在 IIS 中将 ASP.NET 连接到 Outlook，但可以通过 Visual Studio

> ID：584405
> 
> 赞同：1
> 
> 时间：2009-02-25T01:21:58.710
> 
> 标签：c#, iis, permissions, outlook

我正在做一个非常容易开始的家庭项目（这不是总是发生吗？）然后转了一个讨厌的权限。

基本上，我有一个家庭 Intranet，我的 PC 兼作家庭 Web 服务器。我正在运行 Vista，所以我们说的是 IIS 7。

在 Visual Studio 中，这可以完美运行。我有我的主页查询 Outlook (2007) 并显示接下来的几个约会。我这样做，

```
using Microsoft.Office.Interop.Outlook;

//Be kind -- this is a work in progress
public static string nextAppointment()
{
    System.Text.StringBuilder returnString = new System.Text.StringBuilder();

        try
        {
            Application outlookApp = new ApplicationClass();
            NameSpace outlookNamespace = outlookApp.GetNamespace("MAPI");
            MAPIFolder theAppts = outlookNamespace.GetDefaultFolder(OlDefaultFolders.olFolderCalendar);

            List<AppointmentItem> todaysAppointments = new List<AppointmentItem>();
            TimeSpan oneday = new TimeSpan(24, 0, 0);
            DateTime today = DateTime.Today;
            DateTime yesterday = today.Subtract(oneday);
            DateTime tomorrow = today.Add(oneday);

            foreach (AppointmentItem someAppt in theAppts.Items)
            {
                if (someAppt.Start > yesterday && someAppt.Start < tomorrow)
                {
                    todaysAppointments.Add(someAppt);
                }
            }

            foreach (AppointmentItem todayAppts in todaysAppointments)
            {
                returnString.Append(todayAppts.Start.ToShortTimeString() + " -- " + todayAppts.Subject + "<br />");
            }
        }
        catch (System.Exception ex)
        {
            //TO-DO: Add some real handling
            returnString.Append("Cannot access calendar");
        }

        return returnString.ToString();
} 
```

这个代码片段只是一个正在进行的工作，但你明白了。它会查看我在 24 小时内有什么样的日历事件，然后将它们添加到我最终在网页上写出的字符串中。当我在 Visual Studio 中调试它时，它通过 ASP.NET Development Studio 运行良好。充满信心，我采用相同的代码并在 IIS 上运行它以供在家中的所有人享用，但我得到了错误（当我没有捕捉到我的异常时），

> 由于以下错误，检索具有 CLSID {0006F03A-0000-0000-C000-000000000046} 的组件的 COM 类工厂失败：80070005。
> 
> 说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.UnauthorizedAccessException：检索具有 CLSID {0006F03A-0000-0000-C000-000000000046} 的组件的 COM 类工厂失败，原因是以下错误：80070005。
> 
> ASP.NET 无权访问请求的资源。考虑向 ASP.NET 请求标识授予对资源的访问权限。ASP.NET 有一个基本进程标识（通常是 IIS 5 上的 {MACHINE}\ASPNET 或 IIS 6 上的网络服务），如果应用程序不模拟，则使用该标识。如果应用程序通过 模拟，则身份将是匿名用户（通常是 IUSR_MACHINENAME）或经过身份验证的请求用户。
> 
> 要授予 ASP.NET 对文件的访问权限，请在资源管理器中右键单击该文件，选择“属性”并选择“安全”选项卡。单击“添加”以添加相应的用户或组。突出显示 ASP.NET 帐户，然后选中所需访问权限的框。

我尝试通过网站上的资源管理器更改权限，但没有运气。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T01:29:55.400

尝试在具有访问权限的用户（例如域用户）下运行 Web 应用程序的应用程序池。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T02:23:19.797

我发现 IIS 身份验证永远令人困惑。

显然，问题在于您的 Web 应用程序的安全上下文不允许它访问您的 Outlook 日历。不幸的是，有几个地方你可以进行调整，它们都需要一起玩。为了让其他人找出问题所在，您需要提供有关您的应用程序（Web 配置）和 IIS 设置的更多信息。

或者，或者，看看[这篇](http://www.communitycoder.com/archive/2008/02/09/asp.net-security-context.aspx)我觉得非常有用的文章。也许这会帮助你自己弄清楚。

尝试在 web.config 或代码中启用模拟，关闭匿名访问，如果集成不起作用，请尝试为您的应用程序池使用经典管道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T02:32:22.630

最终完全是另外一回事：

2 折步骤 - (1) 在 web.config 或通过 iis 输入身份凭证以模拟，以及 (2) 在 Windows\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files 中为同一用户提供写入权限

事实证明，编辑池设置没有效果。我可以回去将池放在 NetworkService 下，这没关系。

谢谢你的帮助！非常感激！！这绝对让我走上了正确的轨道

# sql-server - SQL Server 2005 数据库镜像错误

> ID：584422
> 
> 赞同：3
> 
> 时间：2009-02-25T01:33:23.067
> 
> 标签：sql-server, sql-server-2005, mirroring, endpoints, server-configuration

尝试在我的服务器上设置 SQL Server 2005 数据库镜像时出现以下错误。我正在运行两台装有 SQL 2005 的 Win2K3 服务器，其中一台与 SQL 2000 版本一起运行。使用端点还原数据库`NORecovery`并配置端点后，当我尝试启动镜像会话时遇到以下错误。

```
TITLE: Database Properties
------------------------------

An error occurred while starting mirroring.

------------------------------
ADDITIONAL INFORMATION:

Alter failed for Database 'TestDB'.  (Microsoft.SqlServer.Smo)

------------------------------

An exception occurred while executing a Transact-SQL statement or 
batch. (Microsoft.SqlServer.ConnectionInfo)

------------------------------

The server network address "TCP://S-01.ssl.local:5022" can not be reached 
or does not exist. Check the network address name 
and that the ports for the local and remote endpoints are operational. 
(Microsoft SQL Server, Error: 1418) 
```

我还要注意，我可以使用两台服务器的全名远程登录到端口。

**更新**

辅助服务器在本地 1434 上作为命名实例运行 SQL Server 2005，并在与所使用的 FQDN 匹配的 IP 地址上作为 1433 在网络上运行。

**[编辑]**

我能够 Telnet 到两台服务器上的 5022 端口。

**[解决方案]**

如果您可以登录并且两个端口都处于活动状态，则可能是 SQL Server 使用的基础帐户不是域帐户。在我们的服务器上，本地系统帐户是服务登录的身份。一旦将其更改为管理员域帐户，问题就解决了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T00:29:52.453

你telnet到每台服务器上的5022端口了吗？那是数据库镜像使用的端口，而不是 SQL 端口 1433 / 1434。

我会检查任何防火墙设置以及 SQL Server 服务是否在域帐户下运行。

您可能还想查看此故障排除文章中有关镜像的其他要点：

[http://blogs.msdn.com/grahamk/archive/2008/12/08/database-mirroring-error-1418-troubleshooter.aspx](http://blogs.msdn.com/grahamk/archive/2008/12/08/database-mirroring-error-1418-troubleshooter.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T08:31:25.223

检查两台机器上的 SQL 日志并确保 SQL Server 正在侦听数据库镜像端点应该使用的端口 5022。

在具有命名实例的服务器上，是否有另一个实例配置为使用相同的 TCP 端口进行镜像或其他？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T22:10:34.163

如果您可以登录并且两个端口都处于活动状态，则可能是 SQL Server 使用的基础帐户不是域帐户。在我们的服务器上，本地系统帐户是服务登录的身份。一旦将其更改为管理员域帐户，问题就解决了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T03:07:43.137

由于看起来您的登录成功并且在实际启用镜像时失败了，您是否尝试过使用 SQL Profiler 来准确查看失败的语句？

不确定您是否熟悉 Profiler，但[这里有一个教程](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-5054787.html)（适用于 SQL 2000，但该工具在 2005 年仅略有不同）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-28T16:00:04.807

我也遇到过这个问题，但是在 Windows 7 中运行的 sql server 2008 中（同一台机器上的所有实例），

在我的情况下，解决方案：

正在这样做：

步骤 1) 您的系统防火墙不应阻止 SQL Server 端口。

步骤 2) 转到计算机管理 >> 服务和应用程序 >> SQL Server 2005 配置 >> 网络配置 启用 TCP/IP 协议。确保 SQL SERVER 端口默认为 1433。

只是为了确保再执行一个可能需要也可能不需要的步骤。

步骤 3) 进入计算机管理 >> 服务和应用程序 >> SQL Server 2005 配置 >> 客户端配置 启用 TCP/IP 协议。

参考：Pinal Dave ( [http://blog.SQLAuthority.com](http://blog.sqlauthority.com/2007/04/22/sql-server-fix-error-1418-microsoft-sql-server-the-server-network-address-can-not-be-reached-or-does-not-exist-check-the-network-address-name-and-reissue-the-command/) )

然后这个：[http](http://www.youtube.com/watch?v=VHAUtCiN1M4) ://www.youtube.com/watch?v= VHAU​​tCiN1M4 女巫基本上是转到 SQL Server 配置管理器，并为每个实例设置您的本地用户和密码。

只是我的两分钱，因为似乎并非每个解决方案都适用于每个人......我花了一天时间试图弄清楚

# winforms - WinForms 接受按钮的烦恼

> ID：584423
> 
> 赞同：1
> 
> 时间：2009-02-25T01:33:58.947
> 
> 标签：winforms, button

我有一个具有（除其他外）三个按钮的基本面板类。我在两个不同的配置对话中使用这个基类的子类。两个对话都有一个确定按钮设置为接受按钮。

在其中一个对话框中，如果我单击基类中的一个按钮，焦点立即返回到 OK 按钮，因此按回车键按预期工作。

在另一个对话框中，焦点保持在基类中被单击的按钮（如果已启用），或者如果单击的按钮不再启用，则移动到下一个按钮。

在任何一个派生类中都没有处理基类按钮单击事件的代码。

任何人的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T02:44:45.127

我不确定您的第一个对话框中发生了什么，因为它似乎没有按照我期望的方式运行。第二个对话框听起来更像标准行为。

在 Windows 窗体中，AcceptButton 属性仅在按下 Enter 时才起作用，否则不会导致任何操作。在您的两个示例中，单击按钮应将焦点移至该按钮，然后按 Enter 将导致再次单击该按钮。

无论如何，我认为通常最好坚持 Windows 用户界面指南，而不是将输入焦点自动更改回 OK 按钮。如果用户单击其他按钮之一，焦点应该保持在那里，直到他们移动它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T02:35:21.140

我不知道您使用的是什么语言，但按钮类应该有一个焦点方法，可以突出显示它以按 Enter 键。在 click 方法中，或者当你打开对话框时，你可以调用这个方法来使你想要的按钮获得表单的焦点

```
c#
myButton.Focus(); 
```

# asp.net - 什么会导致 ASP.NET 验证器不在已部署的站点上触发？

> ID：584428
> 
> 赞同：2
> 
> 时间：2009-02-25T01:39:05.597
> 
> 标签：asp.net, validation, server-side, client-side

在本地它有效，我知道它是“它在我的机器上有效”综合症，但我不明白为什么。

简单的网页、字段、必填字段验证器，例如

```
<asp:textbox id="tbEmail" runat="server" CssClass="field"></asp:textbox>                                            <asp:requiredfieldvalidator id="Requiredfieldvalidator2" runat="server" Display="Dynamic" ControlToValidate="tbEmail" ErrorMessage="Email is required" CssClass="required"></asp:requiredfieldvalidator> 
```

按钮

```
<asp:button id="btnSendRequest" runat="server" Text="Submit" CausesValidation="True"></asp:button> 
```

在本地它触发并且代码不运行，在部署的版本上验证器不触发并且代码运行。

应该很简单，但我盯着它看太久了。

谢谢大家 - 塔里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T01:58:08.860

我在想同样的事情 - asp_regiis 将在您网站的根目录中创建 aspnet_client 文件夹。还要注意报告的 javascript 错误，它们将有助于诊断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T01:54:28.120

我不确定这是否与您的 .NET 版本相关，但您可能必须在服务器上运行 aspnet_regiis -i 才能安装脚本进行验证。在做任何事情之前，请仔细检查这个:)

我希望这会让你朝着正确的方向前进。

[http://msdn.microsoft.com/en-us/library/k6h9cz8h(VS.80).aspx](http://msdn.microsoft.com/en-us/library/k6h9cz8h(VS.80).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T07:38:21.880

在这种情况下，我发现将本地获得的原始 HTML 输出与部署服务器上的输出进行比较会很有帮助。正如 Eric 指出的那样，您可能错过了已部署版本上的验证 javascript……但这肯定会告诉您。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T07:01:33.253

安装 Fiddler：[Fiddler](http://www.fiddlertool.com/fiddler/)并观察流量。加载页面时是否出现任何 404 或 500 HTTP 错误？它可能正在尝试加载必要的客户端验证文件，但遇到了问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T17:41:36.483

不同之处可能在于，在您的本地测试中，您触发了客户端验证器，而在服务器上仅触发了服务器端。确保将 IsValid if 添加到您的方法中，例如：

```
void MyClickHandler(object sender, EventArgs e)
{
   if( IsValid)
   {
      //rest of the code
   }
} 
```

# wpf - 为什么在持久化的 WPF RichTextBox 中有自复制的大括号？

> ID：584440
> 
> 赞同：3
> 
> 时间：2009-02-25T01:48:08.930
> 
> 标签：wpf, persistence, richtextbox

我们的测试人员在我们持久化的 WPF RichTextBoxes 上加上了大括号。在保存并重新打开时，神奇地有更多的大括号。

我已经浓缩了问题/代码。

```
<Window x:Class="WpfApplication1.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Window1" Height="300" Width="300">
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="*"></RowDefinition>
        <RowDefinition Height="Auto"></RowDefinition>
        <RowDefinition Height="*"></RowDefinition>
    </Grid.RowDefinitions>

    <RichTextBox x:Name="rtb1" />
    <Button Grid.Row="1" Click="Button_Click">Draw a fish</Button>
    <RichTextBox x:Name="rtb2" Grid.Row="2"/>
</Grid>
</Window> 
```

两个富文本框。单击按钮时，底部的设置为持久和恢复后第一个的结果。

```
namespace WpfApplication1
{
    /// <summary>
    /// Interaction logic for Window1.xaml
    /// </summary>
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();

            rtb1.Document = new FlowDocument(new Paragraph(new Run("{")));
        }

        public static FlowDocument CreateFlowDocumentFromByteArray(byte[] byteArray)
        {
            return (FlowDocument)XamlReader.Load(new MemoryStream(byteArray));
        }

        public static byte[] CreateByteArrayFromFlowDocument(FlowDocument flowDocument)
        {
            MemoryStream mStream = new MemoryStream();
            XmlWriterSettings settings = new XmlWriterSettings();
            settings.Indent = false;
            settings.OmitXmlDeclaration = true;
            XamlDesignerSerializationManager dsm = new XamlDesignerSerializationManager(XmlWriter.Create(mStream, settings));
            dsm.XamlWriterMode = XamlWriterMode.Value;
            XamlWriter.Save(flowDocument, dsm);
            mStream.Close();
            return mStream.ToArray();
        }

        private void Button_Click(object sender, RoutedEventArgs e)
        {
            rtb2.Document = CreateFlowDocumentFromByteArray(CreateByteArrayFromFlowDocument(rtb1.Document));
        }

    }
} 
```

为什么会这样？我们如何阻止它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T04:04:07.247

今晚我会更彻底地测试代码，但是当大括号不在文本开头时会发生这种情况吗？例如，如果您的运行是“Hello{World}”，它还会这样做吗？

您可能知道，花括号在 WPF 中很重要，因为它们用于标记扩展。以下标记不起作用：

```
<Button Content="{Hello}" /> 
```

要获得正确的输出，您通常会使用以下命令对其进行转义：

```
<Button Content="{}{Hello}" /> 
```

由于您使用的是 XamlReader.Load，因此在 XAML 中使用 {} 可能会有一些混淆，因此它们被转义了。但这只是一个猜测。出于兴趣，写出来的 XAML 是什么样的？

# java - 在 Java 中，有没有办法获取正在处理事件的组件？

> ID：584449
> 
> 赞同：1
> 
> 时间：2009-02-25T01:52:16.517
> 
> 标签：java, user-interface, swing, event-handling

假设我有 4 个与鼠标按下事件相关的蓝色、白色、红色和绿色方块（myComponent）。在某一时刻，鼠标被按下其中之一——比如说，黄色的那个——并且事件被激活。

现在，控制通量在事件处理函数内部。如何从此处获取导致此问题的 MyComponent（黄色方块）？

编辑

我有另一个问题。有没有办法告诉组件的位置？我的问题比我说的要复杂一些。

基本上，我有一个充满正方形的网格。当我点击其中一个方块时，我必须知道它是哪一个，这样我才能更新我的矩阵。问题是，如果我自己计算，它只适用于给定的分辨率。

我有一个 GridBagLayout，里面是 myComponents。我必须知道究竟是哪一个组件——比如，component[2][2]——导致了中断。

我的意思是，我可以知道是哪个组件做到了这一点，但不能知道它在矩阵中的位置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T01:57:54.787

[`MouseEvent.getSource()`](http://java.sun.com/javase/6/docs/api/java/util/EventObject.html#getSource())返回最初发生事件的对象。

> 我有一个`GridBagLayout`，里面是`myComponents`. 我必须知道究竟是哪一个组件——比如`component[2][2]`——导致了中断。

当您将索引添加到矩阵时，您可以将索引存储`(2,2)`在每个索引中。`myComponent`这样，给定组件，您始终可以确定其在矩阵中的位置。

```
class MyComponent extends JButton
{
    final int i; // matrix row
    final int j; // matrix col

    // constructor
    MyComponent(String text, int i, int j)
    {
        super(text);
        this.i = i;
        this.j = j;
    }

    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T02:07:15.810

通过添加 a [`MouseListener`](http://java.sun.com/javase/6/docs/api/java/awt/event/MouseListener.html)（或者[`MouseAdapter`](http://java.sun.com/javase/6/docs/api/java/awt/event/MouseAdapter.html)，如果您不需要覆盖所有`MouseListener' methods) to each of your colored boxes, when an event such as a mouse click occurs, the`MouseListener `will be called with a [`MouseEvent`] [3](http://java.sun.com/javase/6/docs/api/java/awt/event/MouseEvent.html)，则可以使用它来获取被点击的组件。

例如：

```
final MyBoxComponent blueBox =   // ... Initialize blue box
final MyBoxComponent whiteBox =  // ... Initialize white box
final MyBoxComponent redBox =    // ... Initialize red box
final MyBoxComponent greenBox =  // ... Initialize green box

MouseListener myListener = new MouseAdapter() {
    public void mouseClicked(MouseEvent e)
    {
        // Obtain the Object which caused the event.
        Object source = e.getSource();

        if (source == blueBox)
        {
            System.out.println("Blue box clicked");
        }
        else if (source == whiteBox)
        {
            System.out.println("White box clicked");
        }
        // ... and so on.
    }
};

blueBox.addMouseListener(myListener);
whiteBox.addMouseListener(myListener);
redBox.addMouseListener(myListener);
greenBox.addMouseListener(myListener); 
```

# debugging - 如何使用 gcl 在 Common Lisp 中进行跟踪？

> ID：584462
> 
> 赞同：2
> 
> 时间：2009-02-25T01:59:21.320
> 
> 标签：debugging, lisp, common-lisp, gnu-common-lisp

有没有办法打印出你的函数的所有调用来调试递归程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T02:03:48.813

看一下 TRACE 宏。

# opengl - 缩放、平移和旋转如何工作？

> ID：584463
> 
> 赞同：6
> 
> 时间：2009-02-25T01:59:48.260
> 
> 标签：opengl, rotation, zooming, viewport, pan

使用 OpenGL 我正在尝试绘制我校园的原始地图。

谁能向我解释一下平移、缩放和旋转通常是如何实现的？

例如，通过平移和缩放，这仅仅是我调整我的视口吗？所以我绘制并绘制了构成我的地图的所有线条，然后当用户单击并拖动它时，它会调整我的视口吗？

对于平移，它会改变我的视口的 x/y 值吗？对于缩放，它是否会增加/减少我的视口？轮换怎么办？

对于旋转，我是否必须对代表我的校园地图的每条折线进行仿射变换？在一张体面大小的地图上即时执行此操作会不会很昂贵？

或者，视口是否保持不变并且以其他方式完成平移/缩放/旋转？

* * *

例如，如果您转到此[链接](http://www.codeproject.com/KB/GDI-plus/maps_map_net_gis.aspx?display=Print)，您会看到他通过修改视口来准确描述我上面的平移和缩放。

这不正确吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T02:23:47.207

它们是通过在绘制场景之前应用一系列 glTranslate、glRotate 命令（表示相机位置和方向）来实现的。（从技术上讲，您正在旋转整个场景！）

有像 gluLookAt 这样的实用函数，它可以抽象出一些关于这个的细节。

为了简单起见，假设您有两个向量表示您的相机：位置和方向。

gluLookAt 采用位置、目的地和向上向量。

如果你实现一个向量类，`destinaion = position + direction`应该给你一个目的地点。

再次为简单起见，您可以假设上向量始终为 (0,1,0)

然后，在渲染场景中的任何内容之前，加载单位矩阵并调用 gluLookAt

```
glMatrixMode(GL_MODELVIEW);
glLoadIdentity();
gluLookAt( source.x, source.y, source.z, destination.x, destination.y, destination.z, 0, 1, 0 ); 
```

然后开始绘制你的对象

您可以通过稍微向右或向左改变位置来让用户跨越。旋转有点复杂，因为您必须旋转方向矢量。假设您正在旋转的是相机，而不是场景中的某个对象。

一个问题是，如果你只有一个方向向量“向前”，你如何移动它？右边和左边在哪里？

在这种情况下，我的方法是只取“方向”和（0,1,0）的叉积。

现在，您可以使用以下方式将相机向左和向右移动：

```
position = position + right * amount; //amount < 0 moves to the left 
```

您可以使用“方向矢量”向前移动，但 IMO 最好将移动限制在水平面上，因此以与我们获得正确矢量相同的方式获得前向矢量：

```
forward = cross( up, right ) 
```

老实说，这在某种程度上是一种骇人听闻的方法。

正确的做法是使用更“复杂”的数据结构来表示相机的“方向”，而不仅仅是向前的方向。但是，由于您才刚刚开始，因此最好一次采取一步。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T02:13:50.223

所有这些“动作”都可以使用模型视图矩阵转换函数来实现。您应该阅读有关 glTranslatef（平移）、glScalef（缩放）、glRotatef（旋转）的信息。您还应该阅读一些关于 OpenGL 的基本教程，您可能会发现[此链接](http://nehe.gamedev.net/)很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T02:08:37.290

通常，每当您在 opengl 中引用 3d 空间中的任何点时，都会应用三个步骤。

给定一个局部点

*   本地 -> 世界变换
*   世界 -> 相机变换
*   相机 -> 屏幕变换（通常是投影。取决于您使用的是透视还是正交）

这些变换中的每一个都采用您的 3d 点，并乘以一个矩阵。

当您旋转相机时，通常通过将变换矩阵乘以旋转/平移/缩放仿射变换来改变世界 -> 相机变换。由于每帧都会重新渲染所有点，因此新矩阵将应用于您的点，并呈现出旋转的外观。

# java - 使用 3d 变换矩阵

> ID：584481
> 
> 赞同：2
> 
> 时间：2009-02-25T02:12:57.170
> 
> 标签：java, 3d, matrix

在 AI 课程中，我们有一个机器人，它的手臂有 7 个关节。每个关节可以旋转不同的方向。我需要知道最后会在哪里。我一直在尝试进行 3d 矩阵乘法，它适用于一个关节，但是一旦我添加另一个关节，它就不会与我使用 Java3D api 制作的模型对齐。这就是我试图计算第二个关节的位置的方式。

```
double[][] b = {{0, 0, 0, 1}};

// Joint 1
b = HercMatrix.MatMul(b, HercMatrix.getTranslation(0, 0, -110));
b = HercMatrix.MatMul(b, HercMatrix.getRotation(0, arm.getJointAngle(0), 0));

// Joint 2
b = HercMatrix.MatMul(b, HercMatrix.getTranslation(0, 0, -250));
b = HercMatrix.MatMul(b, HercMatrix.getRotation(arm.getJointAngle(1), 0, 0));

System.out.println("Matrix: " + b[0][0] + ", " + b[0][1] + ", " + b[0][2]); 
```

我想这是我应用乘法的方式。我知道事实上这不是我的 matmul 或矩阵生成代码，我已经单独测试了所有这些。

我的第二个平移需要在第一个关节角度的相对 x 轴上。但我不知道这是否是我的做法......

非常感谢任何帮助或想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T03:37:53.690

如果没有看到仿射变换矩阵的结构和角度变量的定义，很难准确回答。[平移矩阵](http://en.wikipedia.org/wiki/Translation_(geometry)#Matrix_representation)的正常定义假设位置向量是从左边相乘的，例如，这似乎与您的使用相反。最后还要检查 b[0][3]==1 。

您的代码似乎等同于以下伪代码：

```
b = origin.translate(Joint1).rotate(Joint1).translate(Joint2).rotate(Joint2); 
```

这不等于

```
b = origin.translate(Joint2).rotate(Joint2).translate(Joint1).rotate(Joint1); 
```

所以检查你需要的转换顺序。

# programming-languages - 命令式语言可以使用哪些函数式语言技术？

> ID：584494
> 
> 赞同：7
> 
> 时间：2009-02-25T02:19:43.160
> 
> 标签：programming-languages, functional-programming, imperative

通常与函数式语言相关的哪些技术或范式也可以有效地用于命令式语言？

例如：

*   递归在没有尾调用优化的语言中可能会出现问题，将其使用限制在少数情况下，因此有用性有限
*   映射和过滤器已经在非函数式语言中找到了它们的方式，即使它们对它们有一种函数式的感觉

我碰巧真的很喜欢不必担心函数式语言的状态。如果我特别固执，我可能会在不修改变量的情况下编写 C 程序，只将我的状态封装在传递给函数的变量和函数返回的值中。

即使函数不是一等值，我也可以用 Java 将一个对象包装在一个对象中，然后将其传递给另一个方法。就像函数式编程一样，只是不那么有趣。

那么，对于函数式编程的老手来说，当您使用命令式语言进行编程时，您成功应用了 FP 的哪些想法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-25T02:43:25.210

几乎所有的人？

如果您了解函数式语言，则可以编写由函数式风格“通知”的命令式程序。这将使您远离副作用，而转向在任何特定点阅读程序文本足以让您真正了解该程序在该点的含义的程序。

回到时间的黎明，我们曾经担心“耦合”和“凝聚力”。学习 FP 将引导您编写具有最佳（最小）耦合和高内聚的系统。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-25T05:04:04.060

以下是妨碍使用非 FP 语言进行 FP 的事情：

*   如果该语言不支持**lambda/closures**，并且没有任何语法糖可以轻松破解它，那么您就死定了。你不会在没有闭包的情况下调用 map/filter 。
*   如果语言是静态类型的并且不支持**泛型**，那么你就死定了。所有好的 FP 东西都使用通用性。
*   如果语言不支持**tail-recursion**，你就会受到阻碍。您可以迭代地编写例如“map”的实现；通常您的数据可能不会太大，递归就可以了。
*   如果该语言不支持**代数数据类型和模式匹配**，您将受到轻微阻碍。一旦你尝过它们，就没有它们是很烦人的。
*   如果语言不能表达**类型类**，好吧，哦，好吧......你会过得去的，但如果这不仅仅是有史以来最棒的功能，而且 Haskell 是唯一一个远程流行的语言，它有很好的支持。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T02:48:16.570

没有一流的函数确实会阻碍编写函数式程序，但有一些事情你可以做而不需要它们。第一个是避免可变状态 - 尝试让大部分或所有类返回代表修改状态的新对象，而不是在内部进行更改。例如，如果您正在编写一个带有`add`操作的链表，您可能希望返回新的链表，`add`而不是修改对象。

虽然这可能会降低您的程序效率（由于创建和销毁的对象数量增加），但您将能够更轻松地调试程序，因为对象的状态和操作变得更加可预测，更不用说能够嵌套函数调用更深入，因为它们有状态输入和输出。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T03:42:41.877

我已经成功地使用了很多高阶函数，尤其是传入的那种而不是返回的那种。返回的那种可能有点乏味但可以模拟。

各种应用数据结构和递归函数在命令式语言中都能很好地工作。

我最怀念的事情：

*   几乎没有命令式语言保证优化每个尾调用。

*   我知道没有命令式语言支持通过模式匹配进行案例分析。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-17T04:12:16.043

我知道这是一个老问题，但可以[在 infoQ 上的这段视频](http://www.infoq.com/presentations/Functional-Thinking)中看到带有示例的答案，该视频深入探讨了这个问题。

# java - Apache Derby - 检查数据库是否已创建？

> ID：584497
> 
> 赞同：8
> 
> 时间：2009-02-25T02:21:48.083
> 
> 标签：java, database, derby

将 Apache Derby 与 Java 结合使用（J2ME，但我认为这没有什么区别）有没有办法检查数据库是否已经存在并包含一个表？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T03:38:49.723

我不知道，除了很少的解决方法，不像 MySQL 那样我们有 IF EXIST 的功能。

你所做的是，尝试连接到数据库，如果不能，它可能不存在。并且在连接成功后，你可以做一个简单的选择，比如 SELECT count(*) FROM TABLE_NAME，来知道表是否存在。您将取决于例外情况。即使在 Sun 的官方示例中，我也看到过类似的工作。

在 Oracle 中，我们有字典表来了解数据库对象。我怀疑我们在德比是否有类似的东西。

**[已编辑]**

好吧，我发现有一种方法可以知道该表是否存在。试试，从 SYSTABLES 中选择表名。它用于检查表的存在，用于检查数据库您可能需要做类似的事情，我在上面解释过。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-25T06:05:01.153

[Adeel](https://stackoverflow.com/questions/584497/apache-derby-check-database-already-created/584617#584617)，您也可以使用[Connection.getMetaData](http://java.sun.com/javase/6/docs/api/java/sql/Connection.html#getMetaData())返回一个[DatabaseMetaData](http://java.sun.com/javase/6/docs/api/java/sql/DatabaseMetaData.html)对象，然后使用[getTables](http://java.sun.com/javase/6/docs/api/java/sql/DatabaseMetaData.html#getTables(java.lang.String,%20java.lang.String,%20java.lang.String,%20java.lang.String%5B%5D))，当然，一旦您连接到数据库。这具有适用于任何具有 JDBC 驱动程序的数据库的优势。

为了检查数据库是否存在，如果您以嵌入式方式使用 Derby，或者服务器在同一台机器上，您可以检查数据库的文件夹是否存在。虽然有点笨拙。我会按照 Adeel 的建议进行操作并尝试连接，如果异常不存在则捕获异常。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T04:03:53.230

我建议获取 DatabaseMetaData 对象，然后从中使用 getTables(null, null, null, new String[]{"TABLE"}) 方法，该方法返回一个 ResultSet。使用返回布尔值的 ResultSet 的 next() 方法来测试是否存在任何表。如果它测试为真，则您有表存在。False，数据库为空。

# c++ - 使用类/结构的不同方法 - C++

> ID：584503
> 
> 赞同：2
> 
> 时间：2009-02-25T02:26:20.927
> 
> 标签：c++, methods

```
struct Foo
{
    void SayHello()
    {
        std::cout << "Hi, I am Foo";
    }
}; 
```

我有上面给出的结构。我在我们的一个代码库中看到过这样的用法。

```
Foo foo;
{
     foo.SayHello();
} 
```

IMO，它也一样

```
Foo foo;
foo.SayHello(); 
```

或者第一种方法有什么优势/区别？

有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T02:31:45.533

在那种特殊情况下，它看起来很奇怪，就像一个审查的候选人。在其他情况下可能有用：

```
Foo foo;
{
    ReturnValue v = foo.SayHello();
    Send(v);
}
... 
```

哪里会限制`v`. 一种常见的用途是使其中的对象更早地销毁。然后可以在大括号内使用在构造函数和析构函数中执行特殊操作的类：

```
Foo foo;
{
    MutexLocker locker(sendMutex);
    ReturnValue v = foo.SayHello();
    Send(v);
}
... 
```

在该示例中，发送队列的锁将在发送时被持有`v`，并在锁在右括号处被销毁时被释放。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T02:36:51.277

这两个例子没有区别。但是，以下将在大括号范围内创建和销毁 foo 对象：

```
{
    Foo foo;
    foo.SayHello();
} 
```

这对于遵循[RAII](http://gethelp.devx.com/techtips/cpp_pro/10min/2001/november/10min1101.asp)习惯用法的对象很有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T02:31:41.913

您是否有任何机会意味着您的第一个选择是

```
{
  Foo foo;
  foo.SayHello();
} 
```

这会更有意义，因为 foo 对象是在包装它的花括号的较小范围内创建、使用和销毁的。这是一种常见的做法，旨在减少瞬态事物的生命周期。通常，这些子块可以重构为单独的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T02:32:20.430

与书面相同（据我所知）。

正如其他人所说，该构造通常用于限制某事的范围，但在您的示例中，没有区别。

# zend-framework - Zend Framework 的 Action 助手不使用 ViewRenderer

> ID：584506
> 
> 赞同：1
> 
> 时间：2009-02-25T02:30:20.293
> 
> 标签：zend-framework, action

我正在尝试使用 Action 帮助程序从视图中执行一个动作，但尽管该动作已执行，但未显示输出。

这是我的 .phtml 文件的一部分：

```
<div id="active-users">
<?php echo $this->action('active', 'Users') ?>
</div> 
```

动作是这样的：

```
class UsersController extends Zend_Controller_Action
{
    function activeAction()
    {
        $model = new UsersModel();
        $this->view->users = $model->getActiveUsers();
    }
} 
```

还有另一个呈现用户列表的 .phtml 文件。当直接从 /users/active 调用时，该操作工作正常，但从另一个 .phtml 文件中调用时不显示任何内容。

我已经跟踪到 ViewRenderer 在使用 action() 助手调用时不可用的问题......或者至少不能像往常一样工作（自动呈现默认的 .phtml 文件）。

如果我在操作中显式渲染视图，则会显示内容，但我需要 ViewRender 行为，因为我不控制我需要使用的某些操作的代码。

无论如何在使用 action() 视图助手时打开 ViewRenderer 吗？如果需要，我愿意替换 action() 视图助手。

我忘记了：我在 Windows Vista 上使用 PHP 5.2.8、Zend Framework 1.7.5、Apache 2.2。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T18:51:11.800

我认为您应该从控制器分配活动用户，或者如果您愿意，您可以在模型上使用单例并直接在视图中使用

```
$this->view = UsersModel::instance()->getActiveUsers(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T03:32:18.350

您是否在操作中使用 _forward() o 重定向？导致 _forward() 或重定向的操作被认为是无效的，并将返回一个空字符串。

更新：我对其进行了测试，它可以工作，尝试在控制器参数中编写“用户”而不是“用户”。

```
<div id="active-users">
    <?php echo $this->action('active', 'users') ?> 
</div> 
```

# language-agnostic - 空的目的是什么？

> ID：584507
> 
> 赞同：41
> 
> 时间：2009-02-25T02:30:35.800
> 
> 标签：language-agnostic, compiler-construction, null, language-design

我在一个编译器类，我们的任务是从头开始创建我们自己的语言。目前我们的困境是是否包含“null”类型。null 提供什么目的？我们团队中的一些人认为这不是绝对必要的，而其他人则支持 null 只是因为它可以提供额外的灵活性。

你有什么想法，特别是支持或反对null？您是否曾经创建过需要 null 的功能？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-02-25T02:31:54.910

[空：十亿美元的错误](http://dow.ngra.de/2009/02/01/correcting-the-billion-dollar-mistake/)。托尼·霍尔：

> 我称之为我的十亿美元错误。它是 1965 年空引用的发明。当时，我正在为面向对象语言 (ALGOL W) 中的引用设计第一个综合类型系统。我的目标是确保所有引用的使用都应该是绝对安全的，并由编译器自动执行检查。**但我无法抗拒放入空引用的诱惑，仅仅是因为它很容易实现。这导致了无数的错误、漏洞和系统崩溃，在过去的四十年中可能造成了十亿美元的痛苦和损失。近年来，微软的一些程序分析器如 PREfix 和 PREfast 已被用于检查引用，并在存在可能为非空的风险时发出警告。** 更新的编程语言如 Spec# 引入了非空引用的声明。这就是我在 1965 年拒绝的解决方案。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-02-25T02:48:31.063

`null`是一个哨兵值，它不是整数，不是字符串，也不是布尔值 - 不是任何东西，除了要保存的东西并且是一个“不存在”的值。不要将其视为或期望它是 0、空字符串或空列表。这些都是有效值，并且在许多情况下都可以是真正有效的值——null 的想法反而意味着那里*没有*价值。

也许它有点像一个抛出异常而不是返回值的函数。除了不是制造并返回一个具有特殊含义的普通值，它返回一个已经具有特殊含义的特殊值。如果一种语言希望您使用`null`，那么您就不能真正忽略它。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-02-25T03:14:15.710

哦不，我觉得哲学专业从我身上出来了......

NULL 的概念来自集合论中的空集的概念。几乎每个人都同意空集不等于零。几十年来，数学家和哲学家一直在争论集合论的价值。

在编程语言中，我认为理解不引用内存中任何内容的对象引用非常有帮助。谷歌一下集合论，你会发现集合论者使用的形式符号系统（符号）和我们在许多计算机语言中使用的符号之间的相似之处。

问候，山姆

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-25T02:43:17.377

你问什么是空的？

好，

没有。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-02-25T02:38:45.580

我通常会在“内存地址 0”的 C/C++ 方面想到“null”。它不是严格需要的，但如果它不存在，那么人们只会使用其他东西（如果 myNumber == -1，或者如果 myString == ""）。

我所知道的是，我想不出我在编码上没有输入“null”这个词的一天，所以我认为这非常重要。

在 .NET 世界中，MS 最近为 int、long 等添加了可空类型，这些类型过去从未可空，所以我猜他们认为它也非常重要。

如果我在设计一种语言，我会保留它。但是，我不会避免使用也没有 null 的语言。它也需要一点时间来适应。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-02-25T02:56:32.103

零的概念不是严格必要的，就像零的概念不是严格必要的一样。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-02-25T06:42:07.367

我认为在整个语言设计的上下文之外谈论 null 并没有什么帮助。混淆的第一点：null 类型是空的，还是包含一个单独的、可区分的值（通常称为“nil”）？完全为空的类型不是很有用——尽管 C 使用空返回类型`void`来标记仅出于副作用而执行的过程，但许多其他语言为此目的使用单例类型（通常是空元组）。

我发现在动态类型语言中使用 nil 值最有效。在 Smalltalk 中，它是当您需要一个值但您没有任何信息时使用的值。在 Lua 中，它的使用更加有效：nil 值是 Lua 表中唯一不能作为键或值的值。在 Lua 中，nil 也被用作缺失参数或结果的值。

总的来说，我会说 nil*值*在动态类型设置中可能很有用，但在静态类型设置中，空*类型*仅用于讨论为副作用而执行的函数（或过程或方法）。

不惜一切代价避免在 C 和 Java 中使用`NULL` *指针。*这些是指针和对象实现中固有的工件，在设计良好的语言中它们不应该被允许。无论如何，为您的用户提供一种使用空值*扩展*现有类型的方法，但要让他们明确地这样做——不要意外地强制每种类型都有一个。（作为显式使用的一个例子，我最近在 Haskell 中实现了 Bentley 和 Sedgewick 的三元搜索树，我需要用一个额外的值来扩展字符类型，意思是“不是字符”。为此，Haskell 提供了该`Maybe`类型。）

最后，如果您正在编写编译器，最好记住语言中最容易编译的部分以及导致最少错误的部分是不存在的部分:-)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-25T02:36:24.133

有一种方法来指示当前未指向任何东西的引用或指针似乎很有用，无论您称其为 null、nil、None 等。如果没有其他原因让人们知道他们何时将要跌倒离开链表的末尾。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-02-25T04:15:24.440

在 C 中，NULL 是 (void*(0))，所以它是一个带值 (?) 的类型。但这不适用于 C++ 模板，因此 C++ 将 NULL 设为 0，它删除了类型并成为纯值。

然而，发现具有特定的 NULL 类型会更好，因此他们（C++ 委员会）决定 NULL 将再次成为一种类型（在 C++0x 中）。

此外，除了 C++ 之外，几乎所有语言都具有 NULL 作为类型，或者与 0 不同的等效唯一值（它可能等于或不等于它，但它的值不同）。

所以现在即使 C++ 也会使用 NULL 作为类型，基本上结束了关于此事的讨论，因为现在每个人（几乎）都会有一个 NULL 类型

**编辑：**考虑一下 Haskell 可能是 NULL 类型的另一种解决方案，但它并不容易掌握或实现。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-02-25T23:30:58.580

null 的一个实际示例是当您提出是/否问题但没有得到回应时。您不想默认为“否”，因为在答案非常重要的情况下，知道问题没有得到回答可能很重要。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-02-25T02:40:18.757

您可以将任何类型视为一个集合以及一组操作。在许多情况下，使用不是“正常”值的值很方便；例如，考虑一个“EOF”值。对于 C 的`getline()`。您可以通过以下几种方式之一来处理它：您可以在集合之外有一个 NULL 值，您可以将特定值区分为 null（在 C 中，`((void *)0)`可以服务于该目的）或者您可以有一种创建新类型的方法，所以对于类型*T*，您创建一个类型*T'* =def *{ T ∪ NULL }*，这就是 Haskell 的做法（“可能”类型）。

哪一个更好对于很多有趣的争论都有好处。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-02-25T02:42:41.340

例如，考虑 C 和 Java 的例子。在 C 中，约定是空指针是数值零。当然，这实际上只是一个约定：该语言没有将这个值视为任何特殊的东西。然而，在 Java 中，这`null`是一个独特的概念，您可以检测并知道，是的，这实际上是一个不好的参考，我不应该尝试打开那扇门来查看另一边的内容。

即便如此，我讨厌空值几乎比其他任何东西都糟糕。

**基于评论的**澄清**`null`：我讨厌零的事实上的空指针值比我讨厌的更糟糕。**

 **每当我看到对 null 的赋值时，我都会想，“哦，太好了，有人刚刚在代码中放了地雷。有一天，我们将沿着相关的执行路径走下去，然后**BOOM**！NullPointerException！”

我更希望有人指定一个有用的默认值或 NullObject，让我知道“此参数尚未设置为任何有用的值”。光秃秃的 null 本身就是等待发生的麻烦。

也就是说，它仍然比一个散漫的原始零要好。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-02-25T02:43:01.263

Null 不是错误。Null 表示“我还不知道”

对于原语，您实际上并不需要 null （我不得不说字符串（在 .NET 中）不应该得到它恕我直言）

但是对于复合实体来说，它肯定是有目的的。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-02-25T02:48:53.637

Null 仅在存在未分配值的变量的情况下有用。如果每个变量都有一个值，那么就不需要空值。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-02-25T03:24:16.327

Null 是一个标记值。这是一个不可能是真实数据的值，而是提供有关正在使用的变量的元数据。

分配给指针的 N​​ull 表示指针未初始化。这使您能够通过检测空值指针的取消引用来检测未初始化指针的滥用。相反，如果您让指针的值等于内存中发生的任何值，那么您将拥有非常不规则的程序行为，这将更加难以调试。

此外，C 风格的可变长度字符串中的空字符用于标记字符串的结尾。

以这些方式使用 null，尤其是指针值，已经变得如此流行，以至于该隐喻已被导入其他系统，即使“null”标记值的实现方式完全不同并且与数字 0 无关。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-02-25T08:34:02.603

Null 不是问题——每个人都以不同的方式对待和解释 null 是问题所在。

我喜欢空。如果没有空值，空值只会被其他方式替换，代码会说“我不知道，伙计！” （有些人会写“我不知道，伙计！”或“我不知道，老豆！”等等，所以我们又会遇到完全相同的问题）。

我概括，我知道。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-02-25T05:35:54.543

该决定取决于编程语言的目标。

你在为谁设计编程语言？您是为熟悉 c 派生语言的人设计的吗？如果是这样，那么您可能应该添加对 null 的支持。

一般来说，我会说你应该避免违背人们的期望，除非它有特定的目的。

以 C# 中的 switch-blocks 为例。C# 中的所有 case 标签必须在每个分支中都有一个显式的控制流表达式。也就是说，它们都必须以“break”语句或显式 goto 结尾。这意味着虽然此代码是合法的：

```
switch(x)
{
    case 1:
    case 2:
        foo;
        break;
} 
```

该代码不合法​​：

```
switch (x)
{
    case 1:
        foo();
    case 2:
        bar();
        break;
} 
```

为了创建从案例 1 到案例 2 的“失败”，有必要插入一个 goto，如下所示：

```
switch (x)
{
    case 1:
        foo();
        goto case 2;
    case 2:
        bar();
        break;
} 
```

这可以说是违背了 C++ 程序员的期望的事情，他们倾向于 C#。但是，添加该限制是有目的的。它消除了整个类常见 C++ 错误的可能性。它稍微增加了语言的学习曲线，但结果对程序员来说是一个净收益。

如果您的目标是设计一种针对 C++ 程序员的语言，那么删除 null 可能会违反他们的期望。这将导致混乱，并使您的语言更难学习。那么关键问题是，“他们得到什么好处”？或者，或者，“这会造成什么损害”。

如果你只是想设计一种可以在一个学期的课程中实现的“超级小语言”，那么情况就不同了。在这种情况下，您的目标不是构建针对特定人群的有用语言。相反，它只是为了学习如何创建编译器。在这种情况下，使用较小的语言是一个很大的好处，因此消除 null 是值得的。

所以，回顾一下，我想说你应该：

1.  确定创建语言的目标。语言是为谁设计的，他们的需求是什么。
2.  根据什么可以帮助目标用户以最佳方式实现目标来做出决定。

通常这将使期望的结果非常清楚。

当然，如果你没有明确表达你的设计目标，或者你不能就它们是什么达成一致，那么你仍然会争论。但是，在这种情况下，无论如何，您几乎注定要失败。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-02-25T08:25:31.580

另一种看待 null 的方式是它是一个性能问题。如果您有一个包含其他复杂对象等的复杂对象，那么允许所有属性最初为空而不是创建某种无用并很快被替换的空对象会更有效。

这只是我以前看不到的一种观点。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-02-25T13:52:43.510

> null 提供什么目的？

我相信这里有两个 null 概念在起作用。

第一个（逻辑指示符为空）是一种传统的程序语言机制，它提供程序逻辑中未初始化内存引用的运行时指示。

第二个（null the value）是一个基本数据值，可以在逻辑表达式中用于检测逻辑空指示符（前面的定义）并在程序代码中做出逻辑决策。

> 你有什么想法，特别是支持或反对null？

虽然 null 多年来一直是许多程序员的祸根，也是许多应用程序故障的根源，但 null 的概念是有效的。如果您和您的团队创建的语言使用的内存引用可能会因为引用未初始化而被滥用，那么您可能需要一种机制来检测这种可能性。创建替代方案始终是一种选择，但 null 是一种广为人知的替代方案。

最重要的是，这完全取决于您的语言目标：

1.  目标编程受众
2.  稳健性
3.  表现
4.  ETC...

如果您的优先级列表中的健壮性和程序正确性很高，并且您允许程序化内存引用，您将需要考虑 null。

BB

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-02-25T02:34:45.823

如果您正在创建一种静态类型的语言，我想 null 可能会给您的编译器增加很多复杂性。

如果您正在创建动态类型语言，NULL 可以派上用场，因为它只是另一种“类型”，没有任何变化。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-02-25T07:03:44.367

Null 是一个占位符，这意味着不能为该变量分配任何值（对于静态类型语言附加“正确类型的”）。

这里存在认知失调。我在别处听说人类无法理解否定，因为他们必须先假设一个值，然后再想象它的不合适性。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-02-27T21:48:20.617

我对你的团队的建议是：提出一些需要用你的语言编写的示例程序，看看如果你遗漏了它们会是什么样`null`子，如果你包含它。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-03-01T19:36:38.267

使用空对象模式！

如果你的语言是面向对象的，让它有一个`UndefinedValue`只存在一个单例实例的类。然后在任何使用的地方使用这个实例`null`。这样做的好处是您`null`将响应诸如`#toString`和之类的消息`#equals`。您永远不会像在 Java 中那样遇到空指针异常。（当然，这要求您的语言是动态类型的）。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-02-25T04:29:49.353

Null 为尚未完全考虑其程序所需的逻辑和域的程序员提供了一个简单的出路，或者使用一个基本上没有明确和一致定义的值的未来维护影响。

乍一看，它必须意味着“没有价值”似乎很明显，但实际上这意味着什么取决于上下文。如果，例如 LastName === null，这是否意味着该人没有姓氏，或者我们不知道他们的姓氏是什么，或者还没有输入系统？null 是否等于自身，或者不是吗？在 SQL 中它没有。在许多语言中它确实如此。但是如果我们不知道 personA.lastName 或 personB.lastName 的值，我们怎么知道 personA.lastName === personB.lastName，嗯？结果应该是假的，还是...... 空值？

这取决于你在做什么，这就是为什么拥有某种系统范围的值是危险和愚蠢的，它可以用于任何看起来像“无”的情况，因为你的程序的其他部分和不能真正依赖外部库或模块来正确解释“null”的含义。

你最好清楚地定义 lastName 的可能值的 DOMAIN，以及每个可能值的实际含义，而不是依赖于一些模糊的系统范围的 null 概念，这可能与你正在做的事情有任何关系，也可能没有任何关系，具体取决于您使用的语言以及您要执行的操作。实际上，当您开始对数据进行操作时，该值的行为方式可能完全错误。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-02-25T04:53:15.927

Null 之于对象就像 0 之于数字。

# c# - 如何防止 Windows 安装对话框在 .NET 中弹出？

> ID：584515
> 
> 赞同：1
> 
> 时间：2009-02-25T02:34:40.813
> 
> 标签：c#, .net, windows

当用户安装我的应用程序时，我如何防止用户帐户控制生成此对话框？不，我不想告诉他们禁用 UAC。

[![](https://i.stack.imgur.com/YBUGe.png)](https://i.stack.imgur.com/YBUGe.png)
[（来源：[netron.com](http://www.netron.com/images/VistaInstall02.png)）]

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T02:58:34.220

您需要设计您的安装，使其不需要管理访问权限来安装，这实质上意味着您需要在用户的主目录中安装，而不是`ProgramFilesDir`仅将注册表项写入`HKEY_CURRENT_USER`. 有关如何使用 .MSI 包执行此操作的更多详细信息，请参阅[本文](http://blogs.msdn.com/rflaming/archive/2006/09/30/778690.aspx)。 [Inno Setup](http://www.jrsoftware.org/isinfo.php)也有[一些关于受限用户安装的细节](http://www.jrsoftware.org/isfaq.php#ntsecur)。

我不认为 Visual Studio 的安装项目生成器能够生成不需要管理员权限即可安装的包。无论如何，Vista 似乎假定任何看起来像 Setup.exe 的东西都需要提升（并导致提示）。

代码签名不会删除提示，它只会显示“来自*开发人员名称的**程序 XYZ*想要访问您的计算机”而不是“未知程序想要访问您的计算机”。

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T02:54:20.657

您需要来自 Comodo 或 VeriSign 等证书颁发机构的代码签名数字证书。不过，它的用处值得商榷，因为它只是用稍微不那么可怕的警告（黄色警报与红色警报）替换了这个看起来很可怕的警告，上面写着“Publisher：”而不是“Unidentified Publisher”，并且仍然告诉用户只如果他们信任你，就运行它。

我有点怀疑普通用户是否真的注意到了这两个警告之间的区别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T02:42:17.100

您的应用程序需要获得微软的认证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T02:43:42.167

用户帐户控制，如对话框底部所述，但您不想这样做。别无退路。要么得到它的签名/认证？:)

# git - 如何将修订历史从 mercurial 或 git 导出到 cvs？

> ID：584522
> 
> 赞同：100
> 
> 时间：2009-02-25T02:37:01.683
> 
> 标签：git, mercurial, export, cvs, git-cvs

我将与其他人一起处理使用 cvs 的项目中的代码。我们想使用分布式 vcs 来完成我们的工作，当我们完成时，或者可能每隔一段时间，我们想将我们的代码和我们所有的修订历史提交到 cvs。我们没有对项目的 cvs repo 的写入权限，因此我们不能非常频繁地提交。我们可以使用什么工具将我们的修订历史导出到 cvs？目前我们正在考虑使用 git 或 mercurial，但如果它可以使导出更容易，我们可以使用另一个分布式 vcs。

* * *

## 回答 #1

> 赞同：237
> 
> 时间：2009-02-25T14:42:02.517

幸运的是，对于我们这些仍然被迫使用 CVS 的人来说，git 提供了非常好的工具来做你想做的事情。我的建议（以及我们在 $work 所做的事情）：

## 创建初始克隆

用于`git cvsimport`将 CVS 修订历史克隆到 git 存储库中。我使用以下调用：

```
% git cvsimport -d $CVSROOT -C dir_to_create -r cvs -k \
  -A /path/to/authors/file cvs_module_to_checkout 
```

该`-A`选项是可选的，但它有助于使您从 CVS 导入的修订历史看起来更像 git（[`man git-cvsimport`](http://www.kernel.org/pub/software/scm/git/docs/git-cvsimport.html)有关如何设置的更多信息，请参阅 ）。

根据 CVS 存储库的大小和历史，第一次导入需要很长时间。如果您想放心某事实际上正在发生，您可以在上述命令中添加 -v。

一旦这个过程完成，您将拥有一个`master`反映 CVS 的 HEAD 的分支（除了`git cvsimport`默认情况下忽略最后 10 分钟的提交以避免捕获半完成的提交）。然后，您可以使用`git log`和朋友来检查存储库的整个历史记录，就像它从一开始就使用 git 一样。

## 配置调整

有一些配置调整将使将来从 CVS（以及导出）的增量导入更容易。这些没有记录在`git cvsimport`手册页上，所以我想他们可以在没有通知的情况下更改，但是，FWIW：

```
% git config cvsimport.module cvs_module_to_checkout
% git config cvsimport.r cvs
% git config cvsimport.d $CVSROOT 
```

所有这些选项都可以在命令行上指定，因此您可以安全地跳过此步骤。

## 增量导入

后续`git cvsimport`应该比第一次调用快得多。但是，它确实`cvs rlog`对每个目录（甚至那些只有文件 in 的目录`Attic`）执行一次操作，因此仍然需要几分钟时间。如果您已经指定了上面建议的配置，您需要做的就是执行：

```
% git cvsimport 
```

如果您尚未设置配置以指定默认值，则需要在命令行中指定它们：

```
% git cvsimport -r cvs -d $CVSROOT cvs_module_to_checkout 
```

无论哪种方式，要记住两点：

1.  确保您位于 git 存储库的根目录中。如果你在其他地方，它会尝试做一个新的`cvsimport`，这将再次需要永远。
2.  确保您在您的`master`分支上，以便可以将更改合并（或重新定位）到您的本地/主题分支中。

## 进行本地更改

`master`在实践中，我建议始终在分支上进行更改，并且仅在您准备好将这些更改导出回 CVS 存储库时才合并。您可以在您的分支上使用您喜欢的任何工作流程（合并、变基、压缩等），但当然标准变基规则适用：如果其他人已经将他们的更改基于您的分支，则不要变基。

## 将更改导出到 CVS

该`git cvsexportcommit`命令允许您将单个提交导出到 CVS 服务器。您可以指定单个提交 ID（或任何描述特定提交的内容，如 中定义[`man git-rev-parse`](http://www.kernel.org/pub/software/scm/git/docs/git-rev-parse.html)）。然后生成一个差异，应用于 CVS 签出，然后（可选）使用实际`cvs`客户端提交给 CVS。您可以在主题分支上导出每个微提交，但通常我喜欢在最新的上创建合并提交`master`并将该单个合并提交导出到 CVS。导出合并提交时，您必须告诉 git 使用哪个提交父级来生成差异。此外，如果您的合并是快进的，这将不起作用（有关[`man git-merge`](http://www.kernel.org/pub/software/scm/git/docs/git-merge.html)快进合并的描述，请参阅“合并工作方式”部分），因此您必须使用`--no-ff`执行合并时的选项。这是一个例子：

```
# on master
% git merge --no-ff --log -m "Optional commit message here" topic/branch/name
% git cvsexportcommit -w /path/to/cvs/checkout -u -p -c ORIG_HEAD HEAD 
```

您可以在[git-cvsexportcommit 的手册页](http://www.kernel.org/pub/software/scm/git/docs/git-cvsexportcommit.html)上查看每个选项的含义。您确实可以`-w`选择在 git config 中设置选项：

```
% git config cvsexportcommit.cvsdir /path/to/cvs/checkout 
```

如果补丁由于某种原因失败，我的经验是（不幸的是）您最好手动复制更改的文件并使用 cvs 客户端提交。但是，如果您在合并主题分支之前确保`master`CVS 是最新的，则不应该发生这种情况。

如果提交由于任何原因（网络/权限问题等）失败，您可以在错误输出的末尾将命令打印到终端并在 CVS 工作目录中执行它。它通常看起来像这样：

```
% cvs commit -F .msg file1 file2 file3 etc 
```

下次您执行`git cvsimport`（至少等待 10 分钟）时，您应该会看到导出的提交的补丁重新导入到本地存储库中。它们将具有不同的提交 ID，因为 CVS 提交将具有不同的时间戳，并且可能具有不同的提交者名称（取决于您是否在`cvsimport`上面的初始设置中设置了作者文件）。

## 克隆你的 CVS 克隆

如果您有不止一个人需要`cvsimport`执行 .git，那么拥有一个执行 cvsimport 的 git 存储库并将所有其他存储库创建为克隆会更有效。这完美地工作，并且克隆的存储库可以执行 cvsexportcommits，就像上面描述的那样。但是，有一个警告。由于 CVS 提交通过不同的提交 ID 返回的方式（如上所述），您不希望克隆的分支跟踪中央 git 存储库。默认情况下，这是`git clone`配置存储库的方式，但这很容易解决：

```
% git clone [CENTRAL_REPO_HERE]
% cd [NEW_GIT_REPO_DIR_HERE]
% git config --unset branch.master.remote
% git config --unset branch.master.merge 
```

删除这些配置后，当您想从中央存储库中提取新提交时，您必须明确说明从何处以及从何处提取：

```
% git pull origin master 
```

* * *

总的来说，我发现这个工作流程非常易于管理，并且在完全迁移到 git 时“下一个最好的事情”是不切实际的。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2010-06-28T15:12:42.337

您不应该盲目相信*cvsimport*并检查导入的树是否与 CVS 存储库中的内容匹配。我通过使用eclipse CVS的插件共享新项目来做到这一点，发现有不一致的地方..

在不到一分钟的时间内使用相同的提交消息完成的两次提交（为了恢复错误删除的文件）被分组为一个大提交，这导致树中的文件丢失。

我能够通过将“fuzz”参数修改为不到一分钟来解决这个问题。

例子：

```
% git cvsimport -d $CVSROOT -C dir_to_create -r cvs -k \
  -A /path/to/authors/file cvs_module_to_checkout -z 15 
```

底线：**导入后检查你的树**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T20:43:34.113

除了 Brian Phillips 的回答：还有[git-cvsserver](http://www.kernel.org/pub/software/scm/git/docs/git-cvsserver.html "git-cvsserver(1) - 用于 git 的 CVS 服务器模拟器")，它的功能类似于 CVS 服务器，但实际上可以访问 git 存储库……但它有一些限制。

# ios - 如何在 iOS 数字键盘上显示“完成”按钮？

> ID：584538
> 
> 赞同：244
> 
> 时间：2009-02-25T02:45:24.783
> 
> 标签：ios, iphone, user-input

`.numberPad`键盘类型上没有“完成”按钮。当用户在文本字段中输入完数字信息后，如何使数字键盘消失？

我可以使用默认键盘获得“完成”按钮，但用户必须切换到数字键才能输入数字。有没有办法在数字键盘上显示“完成”按钮？

* * *

## 回答 #1

> 赞同：339
> 
> 时间：2012-07-08T09:26:09.947

**另一种解决方案。如果屏幕上有其他非数字键盘文本字段，那就完美了。**

![输入附件视图](https://i.stack.imgur.com/BKwHB.png)

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    UIToolbar* numberToolbar = [[UIToolbar alloc]initWithFrame:CGRectMake(0, 0, 320, 50)];
    numberToolbar.barStyle = UIBarStyleBlackTranslucent;
    numberToolbar.items = @[[[UIBarButtonItem alloc]initWithTitle:@"Cancel" style:UIBarButtonItemStyleBordered target:self action:@selector(cancelNumberPad)],
                         [[UIBarButtonItem alloc]initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil],
                         [[UIBarButtonItem alloc]initWithTitle:@"Apply" style:UIBarButtonItemStyleDone target:self action:@selector(doneWithNumberPad)]];
    [numberToolbar sizeToFit];
    numberTextField.inputAccessoryView = numberToolbar;
}

-(void)cancelNumberPad{
    [numberTextField resignFirstResponder];
    numberTextField.text = @"";
}

-(void)doneWithNumberPad{
    NSString *numberFromTheKeyboard = numberTextField.text;
    [numberTextField resignFirstResponder];
} 
```

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2015-02-24T22:24:31.457

这是 Luda 对 Swift 的回答的改编：

在你的 UIViewController 子类的声明中

```
let numberToolbar: UIToolbar = UIToolbar() 
```

在 ViewDidLoad 放：

```
 numberToolbar.barStyle = UIBarStyle.BlackTranslucent
    numberToolbar.items=[
        UIBarButtonItem(title: "Cancel", style: UIBarButtonItemStyle.Bordered, target: self, action: "hoopla"),
        UIBarButtonItem(barButtonSystemItem: UIBarButtonSystemItem.FlexibleSpace, target: self, action: nil),
        UIBarButtonItem(title: "Apply", style: UIBarButtonItemStyle.Bordered, target: self, action: "boopla")
    ]

    numberToolbar.sizeToFit()

    textField.inputAccessoryView = numberToolbar //do it for every relevant textfield if there are more than one 
```

并添加功能 hoopla 和 hoopla （随意选择其他名称，只需相应更改 ViewDidLoad 中的选择器名称

```
func boopla () {
    textField.resignFirstResponder()
}

func hoopla () {
    textField.text=""
    textField.resignFirstResponder()
} 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2017-08-19T11:40:55.703

使用扩展的**Swift 3解决方案。**如果您`UITextField`的应用程序中有多个数字对象，这是理想的选择，因为它可以灵活地为每个对象决定是否在点击*完成*或*取消*`UITextField`时执行自定义操作。

 **[![在此处输入图像描述](https://i.stack.imgur.com/dIzXr.png)](https://i.stack.imgur.com/dIzXr.png)

```
//
//  UITextField+DoneCancelToolbar.swift
//

import UIKit

extension UITextField {
    func addDoneCancelToolbar(onDone: (target: Any, action: Selector)? = nil, onCancel: (target: Any, action: Selector)? = nil) {     
        let onCancel = onCancel ?? (target: self, action: #selector(cancelButtonTapped))
        let onDone = onDone ?? (target: self, action: #selector(doneButtonTapped))

        let toolbar: UIToolbar = UIToolbar()
        toolbar.barStyle = .default
        toolbar.items = [
            UIBarButtonItem(title: "Cancel", style: .plain, target: onCancel.target, action: onCancel.action),
            UIBarButtonItem(barButtonSystemItem: .flexibleSpace, target: self, action: nil),
            UIBarButtonItem(title: "Done", style: .done, target: onDone.target, action: onDone.action)
        ]
        toolbar.sizeToFit()

        self.inputAccessoryView = toolbar
    }

    // Default actions:  
    func doneButtonTapped() { self.resignFirstResponder() }
    func cancelButtonTapped() { self.resignFirstResponder() }
} 
```

使用默认操作的使用示例：

```
//
// MyViewController.swift
//

@IBOutlet weak var myNumericTextField: UITextField! {
    didSet { myNumericTextField?.addDoneCancelToolbar() }
} 
```

使用自定义*完成*操作的使用示例：

```
//
// MyViewController.swift
//

@IBOutlet weak var myNumericTextField: UITextField! {
    didSet { 
        myNumericTextField?.addDoneCancelToolbar(onDone: (target: self, action: #selector(doneButtonTappedForMyNumericTextField))) 
    }
}

func doneButtonTappedForMyNumericTextField() { 
    print("Done"); 
    myNumericTextField.resignFirstResponder() 
} 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-25T04:07:06.007

我见过的技巧是使自定义透明按钮的大小与整个视图一样大，然后在其单击方法中，让文本字段退出第一响应者。因此，用户可以单击字段外的任何位置来关闭键盘。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2015-07-16T10:16:04.630

以下是对 Luda 答案的全面修改，并进行了以下更改：

*   附件视图自动调整为应用程序框架的宽度

*   `UIBarButtonItemStyleBordered`避免了弃用的常量

*   “完成”按钮被实例化为`UIBarButtonSystemItemDone`

目前，“完成”按钮位于附件视图的中心。您可以通过删除相关侧的空间将其定位在左侧或右侧。

我省略了“取消”按钮，因为默认键盘也没有。如果您确实想要一个“取消”按钮，我建议您将其实例化为 a`UIBarButtonSystemItemCancel`并确保您没有丢弃文本字段中的原始值。Luda 的答案中实现的“取消”行为会用空白字符串覆盖值，这可能不是您想要的。

```
- (void)viewDidLoad {
  [super viewDidLoad];
  float appWidth = CGRectGetWidth([UIScreen mainScreen].applicationFrame);
  UIToolbar *accessoryView = [[UIToolbar alloc]
                              initWithFrame:CGRectMake(0, 0, appWidth, 0.1 * appWidth)];
  UIBarButtonItem *space = [[UIBarButtonItem alloc]
                            initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace
                            target:nil
                            action:nil];
  UIBarButtonItem *done = [[UIBarButtonItem alloc]
                           initWithBarButtonSystemItem:UIBarButtonSystemItemDone
                           target:self
                           action:@selector(selectDoneButton)];
  accessoryView.items = @[space, done, space];
  self.valueField.inputAccessoryView = accessoryView;
}

- (void)selectDoneButton {
  [self.valueField resignFirstResponder];
} 
```

有关构建附件视图的更多信息，请参阅有关[数据输入自定义视图](https://developer.apple.com/library/ios/documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/InputViews/InputViews.html)的 Apple 文档。您可能还想查阅有关[UIToolbar](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIToolbar_Class/)和[UIBarButtonItem](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIBarButtonItem_Class/)的参考页面。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2010-08-05T20:16:59.787

[UIKeyboardTypeNumberPad 和缺少返回键](http://www.neoos.ch/news/46-development/54-uikeyboardtypenumberpad-and-the-missing-return-key)的解决方案效果很好，但前提是屏幕上没有其他非数字键盘文本字段。

我采用了该代码并将其转换为 UIViewController，您可以简单地对其进行子类化以使数字键盘工作。您将需要从上面的链接中获取图标。

NumberPadViewController.h：

```
#import <UIKit/UIKit.h>

@interface NumberPadViewController : UIViewController {
    UIImage *numberPadDoneImageNormal;
    UIImage *numberPadDoneImageHighlighted;
    UIButton *numberPadDoneButton;
}

@property (nonatomic, retain) UIImage *numberPadDoneImageNormal;
@property (nonatomic, retain) UIImage *numberPadDoneImageHighlighted;
@property (nonatomic, retain) UIButton *numberPadDoneButton;

- (IBAction)numberPadDoneButton:(id)sender;

@end 
```

和 NumberPadViewController.m：

```
#import "NumberPadViewController.h"

@implementation NumberPadViewController

@synthesize numberPadDoneImageNormal;
@synthesize numberPadDoneImageHighlighted;
@synthesize numberPadDoneButton;

- (id)initWithNibName:(NSString *)nibName bundle:(NSBundle *)nibBundle {
    if ([super initWithNibName:nibName bundle:nibBundle] == nil)
        return nil;
    if ([[[UIDevice currentDevice] systemVersion] floatValue] >= 3.0) {
        self.numberPadDoneImageNormal = [UIImage imageNamed:@"DoneUp3.png"];
        self.numberPadDoneImageHighlighted = [UIImage imageNamed:@"DoneDown3.png"];
    } else {        
        self.numberPadDoneImageNormal = [UIImage imageNamed:@"DoneUp.png"];
        self.numberPadDoneImageHighlighted = [UIImage imageNamed:@"DoneDown.png"];
    }        
    return self;
}

- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];

    // Add listener for keyboard display events
    if ([[[UIDevice currentDevice] systemVersion] floatValue] >= 3.2) {
        [[NSNotificationCenter defaultCenter] addObserver:self 
                                                    selector:@selector(keyboardDidShow:) 
                                                     name:UIKeyboardDidShowNotification 
                                                   object:nil];     
    } else {
        [[NSNotificationCenter defaultCenter] addObserver:self 
                                                 selector:@selector(keyboardWillShow:) 
                                                     name:UIKeyboardWillShowNotification 
                                                   object:nil];
    }

    // Add listener for all text fields starting to be edited
    [[NSNotificationCenter defaultCenter] addObserver:self 
                                             selector:@selector(textFieldDidBeginEditing:)
                                                 name:UITextFieldTextDidBeginEditingNotification 
                                               object:nil];
}

- (void)viewWillDisappear:(BOOL)animated {
    if ([[[UIDevice currentDevice] systemVersion] floatValue] >= 3.2) {
        [[NSNotificationCenter defaultCenter] removeObserver:self 
                                                        name:UIKeyboardDidShowNotification 
                                                      object:nil];      
    } else {
        [[NSNotificationCenter defaultCenter] removeObserver:self 
                                                        name:UIKeyboardWillShowNotification 
                                                      object:nil];
    }
    [[NSNotificationCenter defaultCenter] removeObserver:self 
                                                    name:UITextFieldTextDidBeginEditingNotification 
                                                  object:nil];
    [super viewWillDisappear:animated];
}

- (UIView *)findFirstResponderUnder:(UIView *)root {
    if (root.isFirstResponder)
        return root;    
    for (UIView *subView in root.subviews) {
        UIView *firstResponder = [self findFirstResponderUnder:subView];        
        if (firstResponder != nil)
            return firstResponder;
    }
    return nil;
}

- (UITextField *)findFirstResponderTextField {
    UIResponder *firstResponder = [self findFirstResponderUnder:[self.view window]];
    if (![firstResponder isKindOfClass:[UITextField class]])
        return nil;
    return (UITextField *)firstResponder;
}

- (void)updateKeyboardButtonFor:(UITextField *)textField {

    // Remove any previous button
    [self.numberPadDoneButton removeFromSuperview];
    self.numberPadDoneButton = nil;

    // Does the text field use a number pad?
    if (textField.keyboardType != UIKeyboardTypeNumberPad)
        return;

    // If there's no keyboard yet, don't do anything
    if ([[[UIApplication sharedApplication] windows] count] < 2)
        return;
    UIWindow *keyboardWindow = [[[UIApplication sharedApplication] windows] objectAtIndex:1];

    // Create new custom button
    self.numberPadDoneButton = [UIButton buttonWithType:UIButtonTypeCustom];
    self.numberPadDoneButton.frame = CGRectMake(0, 163, 106, 53);
    self.numberPadDoneButton.adjustsImageWhenHighlighted = FALSE;
    [self.numberPadDoneButton setImage:self.numberPadDoneImageNormal forState:UIControlStateNormal];
    [self.numberPadDoneButton setImage:self.numberPadDoneImageHighlighted forState:UIControlStateHighlighted];
    [self.numberPadDoneButton addTarget:self action:@selector(numberPadDoneButton:) forControlEvents:UIControlEventTouchUpInside];

    // Locate keyboard view and add button
    NSString *keyboardPrefix = [[[UIDevice currentDevice] systemVersion] floatValue] >= 3.2 ? @"<UIPeripheralHost" : @"<UIKeyboard";
    for (UIView *subView in keyboardWindow.subviews) {
        if ([[subView description] hasPrefix:keyboardPrefix]) {
            [subView addSubview:self.numberPadDoneButton];
            [self.numberPadDoneButton addTarget:self action:@selector(numberPadDoneButton:) forControlEvents:UIControlEventTouchUpInside];
            break;
        }
    }
}

- (void)textFieldDidBeginEditing:(NSNotification *)note {
    [self updateKeyboardButtonFor:[note object]];
}

- (void)keyboardWillShow:(NSNotification *)note {
    [self updateKeyboardButtonFor:[self findFirstResponderTextField]];
}

- (void)keyboardDidShow:(NSNotification *)note {
    [self updateKeyboardButtonFor:[self findFirstResponderTextField]];
}

- (IBAction)numberPadDoneButton:(id)sender {
    UITextField *textField = [self findFirstResponderTextField];
    [textField resignFirstResponder];
}

- (void)dealloc {
    [numberPadDoneImageNormal release];
    [numberPadDoneImageHighlighted release];
    [numberPadDoneButton release];
    [super dealloc];
}

@end 
```

享受。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-10-02T13:07:00.893

如果您有多个数字字段，我建议继承 UITextField 以创建一个始终显示带有完成按钮的数字键盘的 NumericTextField。然后，只需将您的数字字段与 Interface Builder 中的此类关联，您就不需要在任何视图控制器中添加任何额外的代码。以下是我在 Xcode 8.0 中使用的 Swift 3.0 类。

```
class NumericTextField: UITextField {
   let numericKbdToolbar = UIToolbar()

    // MARK: Initilization
    required init?(coder aDecoder: NSCoder) {
        super.init(coder: aDecoder)
        self.initialize()
    }

    override init(frame: CGRect) {
        super.init(frame: frame)
        self.initialize()
    }

    // Sets up the input accessory view with a Done button that closes the keyboard
    func initialize()
    {
        self.keyboardType = UIKeyboardType.numberPad

        numericKbdToolbar.barStyle = UIBarStyle.default
        let space = UIBarButtonItem(barButtonSystemItem: UIBarButtonSystemItem.flexibleSpace, target: nil, action: nil)
        let callback = #selector(NumericTextField.finishedEditing)
        let donebutton = UIBarButtonItem(barButtonSystemItem: UIBarButtonSystemItem.done, target: self, action: callback)
        numericKbdToolbar.setItems([space, donebutton], animated: false)
        numericKbdToolbar.sizeToFit()
        self.inputAccessoryView = numericKbdToolbar
    }

    // MARK: On Finished Editing Function
    func finishedEditing()
    {
        self.resignFirstResponder()
    }
} 
```

**斯威夫特 4.2**

```
class NumericTextField: UITextField {
    let numericKbdToolbar = UIToolbar()

    // MARK: Initilization
    required init?(coder aDecoder: NSCoder) {
        super.init(coder: aDecoder)
        self.initialize()
    }

    override init(frame: CGRect) {
        super.init(frame: frame)
        self.initialize()
    }

    // Sets up the input accessory view with a Done button that closes the keyboard
    func initialize()
    {
        self.keyboardType = UIKeyboardType.numberPad

        numericKbdToolbar.barStyle = UIBarStyle.default
        let space = UIBarButtonItem(barButtonSystemItem: UIBarButtonItem.SystemItem.flexibleSpace, target: nil, action: nil)
        let callback = #selector(NumericTextField.finishedEditing)
        let donebutton = UIBarButtonItem(barButtonSystemItem: UIBarButtonItem.SystemItem.done, target: self, action: callback)
        numericKbdToolbar.setItems([space, donebutton], animated: false)
        numericKbdToolbar.sizeToFit()
        self.inputAccessoryView = numericKbdToolbar
    }

    // MARK: On Finished Editing Function
    @objc func finishedEditing()
    {
        self.resignFirstResponder()
    }
} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2010-12-04T20:57:53.530

这是最新的代码。只需在 viewController 中包含 #import "UIViewController+NumPadReturn.h" 即可。

这是.h

```
#import <Foundation/Foundation.h>
#import <UIKit/UIKit.h>

@interface UIViewController (NumPadReturn)

@end 
```

还有他们

```
#import "UIViewController+NumPadReturn.h"

@implementation UIViewController (NumPadReturn)

-(void) viewDidLoad{
    // add observer for the respective notifications (depending on the os version)
    if ([[[UIDevice currentDevice] systemVersion] floatValue] >= 3.2) {
        [[NSNotificationCenter defaultCenter] addObserver:self 
                                                 selector:@selector(keyboardDidShow:) 
                                                     name:UIKeyboardDidShowNotification 
                                                   object:nil];     
    } else {
        [[NSNotificationCenter defaultCenter] addObserver:self 
                                                 selector:@selector(keyboardWillShow:) 
                                                     name:UIKeyboardWillShowNotification 
                                                   object:nil];
    }

}

- (void)keyboardWillShow:(NSNotification *)note {
    // if clause is just an additional precaution, you could also dismiss it
    if ([[[UIDevice currentDevice] systemVersion] floatValue] < 3.2) {
        [self addButtonToKeyboard];
    }
}

- (void)keyboardDidShow:(NSNotification *)note {
    // if clause is just an additional precaution, you could also dismiss it
    if ([[[UIDevice currentDevice] systemVersion] floatValue] >= 3.2) {
        [self addButtonToKeyboard];
    }
}

- (void)addButtonToKeyboard {
    // create custom button
    UIButton *doneButton = [UIButton buttonWithType:UIButtonTypeCustom];
    doneButton.frame = CGRectMake(0, 163, 106, 53);
    doneButton.adjustsImageWhenHighlighted = NO;
    if ([[[UIDevice currentDevice] systemVersion] floatValue] >= 3.0) {
        [doneButton setImage:[UIImage imageNamed:@"DoneUp3.png"] forState:UIControlStateNormal];
        [doneButton setImage:[UIImage imageNamed:@"DoneDown3.png"] forState:UIControlStateHighlighted];
    } else {        
        [doneButton setImage:[UIImage imageNamed:@"DoneUp.png"] forState:UIControlStateNormal];
        [doneButton setImage:[UIImage imageNamed:@"DoneDown.png"] forState:UIControlStateHighlighted];
    }
    [doneButton addTarget:self action:@selector(doneButton:) forControlEvents:UIControlEventTouchUpInside];
    // locate keyboard view
    UIWindow* tempWindow = [[[UIApplication sharedApplication] windows] objectAtIndex:1];
    UIView* keyboard;
    for(int i=0; i<[tempWindow.subviews count]; i++) {
        keyboard = [tempWindow.subviews objectAtIndex:i];
        // keyboard found, add the button
        if ([[[UIDevice currentDevice] systemVersion] floatValue] >= 3.2) {
            if([[keyboard description] hasPrefix:@"<UIPeripheralHost"] == YES)
                [keyboard addSubview:doneButton];
        } else {
            if([[keyboard description] hasPrefix:@"<UIKeyboard"] == YES)
                [keyboard addSubview:doneButton];
        }
    }
}

- (void)doneButton:(id)sender {
    NSLog(@"doneButton");
    [self.view endEditing:TRUE];
}

@end 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2011-08-04T11:01:13.193

一个更简单的解决方案

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
{ 
    [super touchesBegan:touches withEvent:event];

    [textViewInstance1 resignFirstResponder];
    [textViewInstance2 resignFirstResponder];
    [textField resignFirstResponder];
} 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2016-11-04T05:34:27.250

我发现[@user1258240 的答案](https://stackoverflow.com/a/28707555/901156)非常简洁，因为这不像设置`returnKeyType`属性那么简单。

只是想为此贡献我自己的“可重用”方法：

```
func SetDoneToolbar(field:UITextField) {
    let doneToolbar:UIToolbar = UIToolbar()

    doneToolbar.items=[
        UIBarButtonItem(barButtonSystemItem: UIBarButtonItem.SystemItem.flexibleSpace, target: self, action: nil),
        UIBarButtonItem(title: "Done", style: UIBarButtonItem.Style.plain, target: self, action: #selector(ViewController.dismissKeyboard))
    ]

    doneToolbar.sizeToFit()
    field.inputAccessoryView = doneToolbar
}

override func viewDidLoad() {
    super.viewDidLoad()

    SetDoneToolbar(field: UITextField_1)
    SetDoneToolbar(field: UITextField_2)
    SetDoneToolbar(field: UITextField_3)
    SetDoneToolbar(field: UITextField_N)
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-09-11T11:41:21.620

**SWIFT 3.0**一种不同的风格，使用了一些先前答案的一部分。

```
func addToolbarToNumberPad()
{
    let numberPadToolbar: UIToolbar = UIToolbar()

    numberPadToolbar.isTranslucent = true
    numberPadToolbar.items=[
        UIBarButtonItem(barButtonSystemItem: .cancel, target: self, action: #selector(self.cancelAction)),
        UIBarButtonItem(barButtonSystemItem: .flexibleSpace, target: self, action: nil),
        UIBarButtonItem(title: "Custom", style: .done, target: self, action: #selector(self.customAction)),
        UIBarButtonItem(barButtonSystemItem: .done, target: self, action: #selector(self.doneAction)),
    ]

    numberPadToolbar.sizeToFit()

    textField.inputAccessoryView = numberPadToolbar
}

func cancelAction()
{
    textField.resignFirstResponder()
}

func customAction()
{
    textField.resignFirstResponder()
}

func doneAction()
{
    textField.resignFirstResponder()
}

override func viewDidLoad()
{
    super.viewDidLoad()

    self.addToolbarToNumberPad()
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-04-23T21:28:18.797

[我在这里](https://stackoverflow.com/questions/4401436/when-will-this-numberpad-keyboard-issue-is-going-to-be-solved-help/5767029#5767029)描述了一种适用于 iOS 4.2+ 的解决方案，但在键盘出现后关闭按钮会淡入。这并不可怕，但也不理想。

上面链接的问题中描述的解决方案包括一个更优雅的关闭按钮的错觉，我淡化并垂直移动按钮以提供键盘和按钮一起关闭的外观。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-06-26T11:44:12.503

最**简单**的方法是：

创建**自定义透明按钮**并将其放置在左下角，这将`CGSize`与`UIKeyboardTypeNumberPad`. 在 textField 上切换（显示/隐藏）此按钮`becomeFirstResponder`，分别在按钮单击时。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2012-09-12T15:07:32.477

这是我遇到的最简单的解决方案。我从《开始 iOS 5 开发》一书中学到了这一点。

假设 number 字段被调用`numberField`。

1.  在`ViewController`中，添加以下方法：

    ```
    -(IBAction)closeKeyboard:(id)sender; 
    ```

2.  在`ViewController.m`中，添加以下代码：

    ```
    -(IBAction)closeKeyboard:(id)sender
    {

         [numberField resignFirstResponder];

    } 
    ```

3.  返回`nib`文件。

4.  打开`Utilities`平底锅。
5.  打开底锅`Identity inspector`。`Utilities`
6.  单击`View`（在 nib 文件中）一次。确保您没有单击视图中的任何项目。为了清楚起见，您应该在`Class`中看到 UIView `Identity inspector`。
7.  将类从 UIView 更改为 UIControl。
8.  打开`Connection Inspector`.
9.  单击并拖放图标`Touch Down`上的箭头。`File Owner`（仅供参考...文件所有者图标显示在左侧，`View`并显示为带有黄色框的空心立方体。）
10.  选择方法：`closeKeyboard`。
11.  运行程序。

现在，当您单击背景上的任意位置时`View`，您应该能够关闭键盘。

希望这可以帮助您解决问题。:-)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-10-04T07:38:10.620

我修改了 Bryan 的解决方案，使其更加健壮，以便它可以很好地与可能出现在同一视图中的其他类型的键盘配合使用。它在这里描述：

[在 iOS 小键盘 UIKeyboard 上创建一个 DONE 按钮](http://horseshoe7.wordpress.com/2012/08/17/tutorial-creating-a-done-button-on-the-iphone-number-pad-keyboard/)

我会尝试在这里解释它，但其中大部分是要查看的代码，不太适合这里

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2013-05-16T13:50:05.207

如果您事先知道要输入的数字数量（例如 4 位 PIN 码），您可以在 4 次按键后自动关闭，根据我对这个类似问题的回答：

[解雇数字键盘](https://stackoverflow.com/questions/3127104/dismissing-number-pad/16589216#16589216)

在这种情况下不需要额外的完成按钮。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2015-05-06T23:46:43.070

如果我们只是告诉视图控制器的视图结束编辑，我们还可以使***“用户触摸其他地方”的解决方案更加简单：***

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
 { 
      [super touchesBegan:touches withEvent:event];

      [self.view endEditing:YES]; //YES ignores any textfield refusal to resign
 } 
```

...假设“触摸其他地方会关闭键盘”也是视图上任何其他可编辑字段的期望行为。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-05-04T08:23:34.990

对于 Swift 2.2，我使用这个

```
func addDoneButtonOnKeyboard() {
    let doneToolbar: UIToolbar = UIToolbar(frame: CGRectMake(0, 0, self.view.bounds.size.width, 50))

    let flexSpace = UIBarButtonItem(barButtonSystemItem: UIBarButtonSystemItem.FlexibleSpace, target: nil, action: nil)
    let done: UIBarButtonItem = UIBarButtonItem(title: "Done", style: UIBarButtonItemStyle.Done, target: self, action: #selector(DetailViewController.finishDecimalKeypad))

    var items: [UIBarButtonItem]? = [UIBarButtonItem]()
    items?.append(flexSpace)
    items?.append(done)

    doneToolbar.items = items
    doneToolbar.sizeToFit()
    self.productPrice.inputAccessoryView=doneToolbar
}

func finishDecimalKeypad() {
    self.productPrice?.resignFirstResponder()
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-12-07T09:36:33.583

所有关于查找键盘视图并在第三行添加完成按钮的实现（这就是为什么 button.y = 163 b/c 键盘的高度为 216）都是脆弱的，因为 iOS 不断更改视图层次结构。例如，上述代码均不适用于 iOS9。

我认为通过 [[[UIApplication sharedApplication] windows] lastObject] 找到最上面的视图更安全，只需在其左下角添加按钮 doneButton.frame = CGRectMake(0, SCREEN_HEIGHT-53, 106 , 53);// 纵向模式

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-08-23T17:09:15.010

Swift 2.2 / 我使用了 Dx_ 的答案。但是，我希望所有键盘都具有此功能。所以在我的基类中我放了代码：

```
func addDoneButtonForTextFields(views: [UIView]) {
    for view in views {
        if let textField = view as? UITextField {
            let doneToolbar = UIToolbar(frame: CGRectMake(0, 0, self.view.bounds.size.width, 50))

            let flexSpace = UIBarButtonItem(barButtonSystemItem: .FlexibleSpace, target: nil, action: nil)
            let done = UIBarButtonItem(title: "Done", style: .Done, target: self, action: #selector(dismissKeyboard))

            var items = [UIBarButtonItem]()
            items.append(flexSpace)
            items.append(done)

            doneToolbar.items = items
            doneToolbar.sizeToFit()

            textField.inputAccessoryView = doneToolbar
        } else {
            addDoneButtonForTextFields(view.subviews)
        }
    }
}

func dismissKeyboard() {
    dismissKeyboardForTextFields(self.view.subviews)
}

func dismissKeyboardForTextFields(views: [UIView]) {
    for view in views {
        if let textField = view as? UITextField {
            textField.resignFirstResponder()
        } else {
            dismissKeyboardForTextFields(view.subviews)
        }
    }
} 
```

然后只需在 viewDidLoad 中调用 self.view.subviews 上的 addDoneButtonForTextFields （如果使用表格视图，则调用 willDisplayCell ）将完成按钮添加到所有键盘。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2022-01-28T09:41:15.433

```
 let pickerView = UIPickerView()

 var yearpickerToolbar: UIToolbar?

    func createPickerView() {

           pickerView.delegate = self
           textfield.inputView = pickerView }

     func dismissPickerView() {
           let toolBar = UIToolbar()
           toolBar.sizeToFit()

           toolBar.isUserInteractionEnabled = true
           textfield.inputAccessoryView = toolBar
           textfield.delegate = self

   yearpickerToolbar = UIToolbar()
           yearpickerToolbar?.autoresizingMask = .flexibleHeight

           //add buttons
           let cancelButton = UIBarButtonItem(barButtonSystemItem: .cancel, target: self, action:#selector(cancelBtnClicked(_:)))
           cancelButton.tintColor = UIColor.blue
           let flexSpace = UIBarButtonItem(barButtonSystemItem: .flexibleSpace, target: nil, action: nil)

           let doneButton = UIBarButtonItem(title: "Done", style: .plain , target: self, action: #selector(self.doneBtnClicked(_ :) ))
           doneButton.tintColor = UIColor.blue

           doneButton.setTitleTextAttributes([NSAttributedString.Key.foregroundColor:
   UIColor.black], for: .normal)
           cancelButton.setTitleTextAttributes([NSAttributedString.Key.foregroundColor:
   UIColor.black], for: .normal)

           yearpickerToolbar?.items = [cancelButton, flexSpace, doneButton]
           textfield.inputAccessoryView = yearpickerToolbar }

   @objc func cancelBtnClicked(_ button: UIBarButtonItem?) {
           self.view.endEditing(true)

       }

       @objc func doneBtnClicked(_ button: UIBarButtonItem?) {
           self.view.endEditing(true)
       } 
```

# c++ - C++ 中是否有替代多态性的方法？

> ID：584544
> 
> 赞同：10
> 
> 时间：2009-02-25T02:51:29.510
> 
> 标签：c++, virtual-functions

在这个关于动态多态性的问题中建议[使用 CRTP 。](https://stackoverflow.com/questions/262254/c-crtp-to-avoid-dynamic-polymorphism)然而，据称这种模式只对静态多态有用。[正如这里所暗示的，](http://assemblyrequired.crashworks.org/2009/01/19/how-slow-are-virtual-functions-really/)我正在查看的设计似乎受到虚函数调用的快速阻碍。 即使是 2.5 倍的加速也很棒。

有问题的类很简单，可以完全内联编码，但是直到运行时才知道将使用哪些类。此外，他们可能会以任何顺序被束缚，将性能侮辱堆积到伤害上。

欢迎提出任何建议（包括在这种情况下如何使用 CRTP）。

**编辑：**谷歌搜索出现了函数模板的提及。这些看起来很有希望。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-25T05:02:11.693

多态性的字面意思是多种（多）形式（变形）。在静态类型语言（例如 C++）中，存在三种类型的多态性。

1.  即席多态性：这在 C++ 中最好被视为函数和方法重载。**相同的函数名称将根据调用的参数的编译时**类型与函数或方法签名的匹配来绑定到不同的方法。
2.  参数多态性：在 C++ 中，这是模板以及您可以用它做的所有有趣的事情，例如 CRTP、专业化、部分专业化、元编程等。同样的这种多态性，相同的模板名称可以根据模板做不同的事情参数是**编译时**多态性。
3.  子类型多态性：最后，当我们听到 C++ 中的多态性这个词时，我们会想到这一点。这是派生类覆盖虚函数以专门化行为的地方。指向基类的相同类型的指针可以根据它指向的具体派生类型具有不同的行为。这是在 C++ 中获得**运行时**多态性的方法。

如果直到运行时才知道将使用哪些类，则必须使用涉及虚函数调用的子类型多态。

与静态绑定调用相比，虚拟方法调用的性能开销非常小。我敦促您查看此[SO 问题的答案。](https://stackoverflow.com/questions/449827/virtual-functions-and-performance-c)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T13:51:13.450

我同意 m-sharp 的观点，即您不会避免运行时多态性。

如果您重视优化而不是优雅，请尝试替换 say

```
void invoke_trivial_on_all(const std::vector<Base*>& v)
{
  for (int i=0;i<v.size();i++)
    v[i]->trivial_virtual_method();
} 
```

有类似的东西

```
void invoke_trivial_on_all(const std::vector<Base*>& v)
{
  for (int i=0;i<v.size();i++)
  {
    if (v[i]->tag==FooTag)
      static_cast<Foo*>(v[i])->Foo::trivial_virtual_method();
    else if (v[i]->tag==BarTag)
      static_cast<Bar*>(v[i])->Bar::trivial_virtual_method();
    else...
  }
} 
```

它不漂亮，当然不是 OOP（更多的是回归到你可能在好的旧“C”中做的事情），但如果虚拟方法足够简单，你应该得到一个没有调用的函数（取决于足够好的编译器和优化选项）。使用 dynamic_cast 或 typeid 的变体可能更优雅/安全，但要注意这些功能有自己的开销，无论如何可能与虚拟调用相当。

您最有可能从上面看到改进的地方是，如果某些类方法是无操作的，并且它使您免于调用它们，或者如果函数包含常见的循环不变代码并且优化器设法将其从环形。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T05:41:05.717

您可以走 Ole C 路线并使用工会。尽管这也可能很混乱。

# c# - 如何在每个新页面上自动添加命名空间，控件添加到 VS2008 中的网站？

> ID：584546
> 
> 赞同：3
> 
> 时间：2009-02-25T02:51:55.360
> 
> 标签：c#, .net, visual-studio-2008, web, namespaces

如何在每个新页面上自动添加命名空间，控件添加到 VS2008 中的网站？

当我添加一个新页面时，后面的代码如下所示。

```
public partial class MyNewPage : System.Web.UI.Page
{

} 
```

我只想将页面包装到一个命名空间中，如下所示：

```
namespace Project.Web
{

    public partial class MyNewPage : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e){}
    }

} 
```

当您有一个网站项目时，这会自动完成。

也许这是微不足道的，但我还没有找到如何做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T06:44:06.057

将命名空间放在项目属性中的“默认命名空间”下，不需要在代码文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T06:47:41.103

您可以尝试为新页面编辑 Visual Studio 模板文件或添加您自己的自定义模板。您需要编辑的文件是“C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\ItemTemplates\Web\CSharp\1033\WebForm.zip”模板存档中的“CodeBeside.cs”，至少这是它的位置在我的系统上。只需更改类定义以匹配您的需要；就像是：

```
namespace $rootnamespace$
{
    public partial class $classname$ : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }
    }
} 
```

您可能需要将 $rootnamespace$ 替换为您需要的命名空间，因为我不确定在网站项目中将如何处理它。

# c++ - 如何修复我的 while 错误？

> ID：584547
> 
> 赞同：0
> 
> 时间：2009-02-25T02:53:02.940
> 
> 标签：c++, visual-studio-2005

我正在使用 C++ 在 Microsoft Visual Studio 中编写一个程序，该程序将从 .txt 文件中检索信息。在那个文件中有负数，但是当我尝试编写一个while循环来说明如果有负数时该怎么做，我得到了几个错误。

有人可以帮我吗？这是我的代码，我确实意识到存在错误，但我不知道如何编写 While 循环语句来读取这些值，这些值是工作小时数和 .txt 文件中的小时费率

示例文本文件：

```
45.0    10.50
-35.0   7.75
50.0    12.00
45.0   -8.50
30.0    6.50
48.0    -10.25
-50.0   10.00
50.0    8.75
40.0    12.75
56.0    8.50 
```

代码：

```
//*****************************
// This program is to help calculate an employee's weekly gross pay as well as
// the net pay while showing the taxes that were taken off.
// The data that will be shown will be calculated from a .txt file 
// that was created and called employee.txt.

// Input:  Will be the inFile known as employee.txt
// Output: Gross pay, taxable income, federal tax, state tax, and net pay

// Typed by:  
// Date:  
//******************************

#include <iomanip>
#include <fstream>
#include <iostream>

using namespace std;

float computeGross(float, float);
void computeTaxes(float, float&, float&, float&);
float computeNetPay (float&, float&, float&, float&);

const float hours = 40;                 // Regular 40 hour work week
const float ovTime = 1.5;               // Overtime if hours go over 40
const float exemption = 200.0;          // Exemption  if pay goes over 200
const float fedTaxRate = 0.10;          // Federal Tax Rate
const float stTaxRate = 0.03;           // State Tax rate

ifstream inFile;
ofstream outFile;

int main()
{
    inFile.open("employee.txt");
    outFile.open("result.txt");

    float hours, rate, grossPay, taxableIncome, fedTax, stTax, NetPay;
    inFile >> hours >> rate;

    while(inFile)
    {
        if {
            (hours <= 0)&& (rate <= 0);
            outFile << "Invalid Data";
        }
        else{ 
            return 0;
        }
    }

    grossPay = computeGross(hours, rate);
    computeTaxes (grossPay, taxableIncome, fedTax, stTax);
    computeNetPay (grossPay, fedTax, stTax, NetPay);

    outFile << fixed << showpoint << setprecision(2);
    outFile << "Hours worked = " << hours << endl   
            << "Hourly rate = " << rate  << endl        
            << "Employee's gross pay = " << grossPay << endl
            << "Taxable Income = " << taxableIncome << endl
            << "Federal Taxes = " << fedTax << endl
            << "State Taxes = " << stTax << endl
            << "Net Pay = " << NetPay << endl;
    return 0;
}

float computeGross (float h, float r)           //Computes for the Gross Pay
{
    if (h > hours) 
        return hours * r + (h - hours) * r * ovTime;
    else 
        return h * r;
}
void computeTaxes(float g, float& taxable, float& fedTax, float& stTax) //Computes both Taxes
{
    taxable = g - exemption;

    if (taxable > 0.0)
    {
         fedTax = fedTaxRate * taxable;
         stTax = stTaxRate * taxable;
    }
    else
    {
        fedTax = 0.0;
        stTax = 0.0;
    }
}

float computeNetPay (float& grossPay, float& fedTax, float& stTax, float& NetPay)
{
    return NetPay = grossPay - fedTax - stTax;    
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T03:18:33.267

在您的主要功能中，您有：

```
while(inFile)
{
    if ((hours <= 0) && (rate <= 0))
    {
        outFile << "Invalid Data";
    }
    else { 
        return 0;
    }
} 
```

当 else 被触发时，程序结束，主函数返回。你可能想要一个~~continue~~ break 或者什么都没有，return 语句结束 main 函数而不是 While 循环。

要从文件中获取所有数据，您的 read 语句 ( `inFile >> hours >> rate`); 将需要在这个或另一个循环中。在IF测试有效性之后说，它可能在Else中。

```
 while(inFile)
    {
         if ((hours <= 0) && (rate <= 0)) {

             outFile << "Invalid Data";
         }
         else { 
             // call the data functions
             // save the returned values     
         }

        //prime hours and rate for the next loop
        inFile >> hours >> rate;
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T03:40:00.313

好吧..我猜这就是你要找的东西：

请注意：

```
if ((hours <= 0) && (rate <= 0)) 
```

改为：

```
if ((hours <= 0) || (rate <= 0)) 
```

否则它永远不会用您提供的数据命中“无效数据”

```
//*****************************
// This program is to help calculate an employee's weekly gross pay as well as
// the net pay while showing the taxes that were taken off.
// The data that will be shown will be calculated from a .txt file 
// that was created and called employee.txt.

// Input:  Will be the inFile known as employee.txt
// Output: Gross pay, taxable income, federal tax, state tax, and net pay

// Typed by:  
// Date:  
//******************************

#include <iomanip>
#include <fstream>
#include <iostream>

using namespace std;

float computeGross(float, float);
void computeTaxes(float, float&, float&, float&);
float computeNetPay (float&, float&, float&, float&);

const float hours = 40;                 // Regular 40 hour work week
const float ovTime = 1.5;               // Overtime if hours go over 40
const float exemption = 200.0;          // Exemption  if pay goes over 200
const float fedTaxRate = 0.10;          // Federal Tax Rate
const float stTaxRate = 0.03;           // State Tax rate

int main()
{

    ifstream inFile ("employee.txt");
    ofstream outFile ("result.txt");

    float hours, rate, grossPay, taxableIncome, fedTax, stTax, NetPay;

    if (inFile.is_open())
    {
        while (! inFile.eof() )
        {

            inFile >> hours;
            inFile >> rate;

            if ((hours <= 0) || (rate <= 0))
            {
                outFile << "Invalid Data";
            }
            else
            { 
                grossPay = computeGross(hours, rate);
                computeTaxes (grossPay, taxableIncome, fedTax, stTax);
                computeNetPay (grossPay, fedTax, stTax, NetPay);

                outFile << fixed << showpoint << setprecision(2);
                outFile << "Hours worked = " << hours << endl   
                        << "Hourly rate = " << rate  << endl        
                        << "Employee's gross pay = " << grossPay << endl
                        << "Taxable Income = " << taxableIncome << endl
                        << "Federal Taxes = " << fedTax << endl
                        << "State Taxes = " << stTax << endl
                        << "Net Pay = " << NetPay << endl;
            }
        }
    }

    return 0;
} 
```

其余的都是一样的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T03:01:46.553

首先，我认为这是：

```
if {
    (hours <= 0)&& (rate <= 0);
    outFile << "Invalid Data";
    } 
```

应该是这样的：

```
if ((hours <= 0) && (rate <= 0)) {
    outFile << "Invalid Data";
} 
```

请注意，要让代码在 StackOverflow 上正确格式化，您应该只使用空格，而不是制表符。我认为这就是导致您的格式问题的原因。

# c# - 在 .NET 中重写 Dispose(bool disposing) 有什么意义？

> ID：584549
> 
> 赞同：45
> 
> 时间：2009-02-25T02:55:18.423
> 
> 标签：c#, .net, dispose, idisposable

如果我在 C# 中编写一个实现 IDisposable 的类，为什么不足以让我简单地实现

```
public void Dispose(){ ... } 
```

处理释放任何非托管资源？

是

```
protected virtual void Dispose(bool disposing){ ... } 
```

总是必要的，有时是必要的，还是完全不同的东西？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-02-25T06:33:10.647

包括终结器、新虚拟方法的引入和原始 dispose 方法的“密封”在内的完整模式非常通用，涵盖了所有基础。

除非您对非托管资源有*直接*句柄（应该[几乎](http://joeduffyblog.com/2008/02/17/idisposable-finalization-and-concurrency/) [从不](http://joeduffyblog.com/2005/12/27/never-write-a-finalizer-again-well-almost-never/)），否则您不需要终结器。

如果你密封你的类（我对尽可能密封类的看法现在可能众所周知 -[设计继承或禁止它](https://stackoverflow.com/questions/268251/why-seal-a-class/268287#268287)），那么引入虚拟方法是没有意义的。

我不记得我最后一次`IDisposable`以“复杂”的方式实现而不是以最明显的方式实现它，例如

```
public void Dispose()
{
    somethingElse.Dispose();
} 
```

需要注意的一件事是，如果您要编写真正健壮的代码，*则应*确保在处理完之后不要尝试做任何事情，并`ObjectDisposedException`在适当的地方抛出。这对于世界各地的开发人员都将使用的类库是一个很好的建议，但如果这只是在您自己的工作空间中使用的类，那么这将是大量工作而收效甚微。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-02-25T03:06:01.923

这不是绝对必要的。它是推荐的 Disposable 模式的一部分。如果你还没有阅读框架设计指南部分（第一版中的 9.3，没有方便的第二版，抱歉），那么你应该阅读。[试试这个链接](https://msdn.microsoft.com/en-us/library/b1yfkh5e(v=vs.110).aspx)。

它对于区分一次性清理和可终结的垃圾收集是非常有用的。

您不必那样做，但您应该阅读它并理解为什么建议这样做，然后再将其视为不必要的。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-25T04:52:28.207

MSFT 文档中关于一次性模式存在一些偏见。您应该实施 IDisposable 有两个原因：

1.  你有一个实现 IDisposable 类型的字段
2.  你有一个终结者。

案例 1 在大多数代码中很常见。案例 2 在 Microsoft 编写的代码中非常常见，它们是围绕非托管资源编写托管包装器的代码，它们需要最终确定。但是在您的代码中应该非常少见。毕竟，您已经拥有了所有这些不错的 .NET 类来为您完成繁琐的工作。你只需要调用他们的 Dispose() 方法。

只有案例 2 需要一次性模式。微软需要大量使用它。大多数时候你只需要简单的 Dispose() 。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-25T07:05:39.493

除了其他很好的答案之外，您可能还想查看这些文章：

*   [正确实现 IDisposable 和 Dispose 模式](http://www.codeproject.com/KB/cs/idisposable.aspx)
*   [IDisposable：关于资源分配](http://www.codeproject.com/KB/dotnet/IDisposable.aspx)的事情你妈妈从来没有告诉过你（一次性设计原则）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-25T03:03:37.330

带有布尔处理的附加方法来自某处的框架设计指南。它只是一种模式，允许您的类让 dispose 方法能够被多次调用而不会引发异常。它不是绝对需要的。从技术上讲，您可以在 dispose 方法中执行此操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-02-08T01:03:08.773

只是为了扩展其他人所说的话：出于性能原因，这不仅仅是你*不需要*“复杂的处置”，而是你*实际上并不想要它。*

如果你走“复杂的处置”路线，并实现一个终结器，然后忘记显式处置你的对象，你的对象（以及它引用的任何东西）将在它真正被处置之前经历额外的 GC 生成（因为它必须挂在一个CLR 有更多时间调用终结器）。这只会导致您不需要的更多内存压力。此外，在整个对象堆上调用终结器具有不小的成本。

所以避免，除非你（或你的派生类型）有非托管资源。

哦，当我们在这个领域时：你的类上处理来自其他人的事件的方法在你的类被释放后被调用时必须是“安全的”。最简单的方法是，如果该类已被释放，则只执行无操作。请参阅[http://blogs.msdn.com/ericlippert/archive/2009/04/29/events-and-races.aspx](http://blogs.msdn.com/ericlippert/archive/2009/04/29/events-and-races.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-02-08T01:56:59.383

它为您提供的一件事是能够在 Dispose() 中完成与最终确定无关的工作，并且仍然可以清理非托管资源。

在终结器中对除“你自己”之外的托管对象执行*任何*操作都非常......不可预测。这大部分是由于您的终结器将在您的 AppDomain 的第 2 阶段以非确定性方式关闭时被调用 - 因此当您的终结器被调用时，您仍然引用的对象极有可能已经被敲定。

将 Dispose 和 finalizer 调用调度到同一方法允许您共享关闭代码，而布尔参数允许您跳过托管清理（如果有）。

此外，该方法的虚拟性为继承者添加他们自己的清理代码提供了一种简单的方法，从而减少了无意中没有调用您的代码的风险。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-02-14T17:38:47.997

如果一个类实现并且派生类需要添加额外的逻辑，则该类必须公开派生类可以链接到的`IDisposable.Dispose()`某种方法。`Dispose`由于某些类可能在没有公共方法的情况下实现`IDisposable.Dispose()`，`Dispose()`因此拥有一个将`protected`在所有实现中都存在的虚拟方法很有用`IDisposable`，无论它们是否具有公共`Dispose`方法。在大多数情况下，该`bool`参数并没有真正的意义，但应该被认为是一个虚拟参数，以使该参数`protected virtual Dispose(bool)`具有与 may-be-or-maybe-not-public 不同的签名`Dispose()`。

不使用 a 的`protected virtual Dispose(bool)`类将要求派生类以不同于约定的方式处理其清理逻辑。某些语言（如 C++/CLI）只能扩展`IDisposable`遵循该约定的实现，可能无法从非标准实现派生类。

# c# - 使用 DocumentPaginator 打印时如何打印预览？

> ID：584551
> 
> 赞同：17
> 
> 时间：2009-02-25T02:57:16.890
> 
> 标签：c#, .net, wpf, printing

我正在使用从 DocumentPaginator 派生的类（见下文）从 WPF 应用程序打印简单（纯文本）报告。我已经得到它，所以一切都可以正确打印，**但是我如何让它在打印之前进行打印预览？**我觉得我需要使用 DocumentViewer，但我不知道如何使用。

这是我的分页器类：

```
public class RowPaginator : DocumentPaginator
{
    private int rows;
    private Size pageSize;
    private int rowsPerPage;

    public RowPaginator(int rows)
    {
        this.rows = rows;
    }

    public override DocumentPage GetPage(int pageNumber)
    {
        int currentRow = rowsPerPage * pageNumber;
        int rowsToPrint = Math.Min(rowsPerPage, rows - (rowsPerPage * pageNumber - 1));
        var page = new PageElementRenderer(pageNumber + 1, PageCount, currentRow, rowsToPrint)
                       {
                           Width = PageSize.Width,
                           Height = PageSize.Height
                       };
        page.Measure(PageSize);
        page.Arrange(new Rect(new Point(0, 0), PageSize));
        return new DocumentPage(page);
    }

    public override bool IsPageCountValid { get { return true; } }

    public override int PageCount { get { return (int)Math.Ceiling(this.rows / (double)this.rowsPerPage); } }

    public override Size PageSize
    {
        get { return this.pageSize; }
        set
        {
            this.pageSize = value;
            this.rowsPerPage = PageElementRenderer.RowsPerPage(this.pageSize.Height);
            if (rowsPerPage <= 0)
                throw new InvalidOperationException("Page can't fit any rows!");
        }
    }

    public override IDocumentPaginatorSource Source { get { return null; } }
} 
```

PageElementRenderer 只是一个显示数据的简单 UserControl（目前只是一个行列表）。

这是我如何使用我的行分页器

```
PrintDialog dialog = new PrintDialog();
if (dialog.ShowDialog() == true)
{
    var paginator = new RowPaginator(rowsToPrint) { PageSize = new Size(dialog.PrintableAreaWidth, dialog.PrintableAreaHeight) };

    dialog.PrintDocument(paginator, "Rows Document");
} 
```

抱歉代码转储，但我不想错过相关的东西。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-25T21:31:08.710

因此，我在阅读[C# 2008 中的 Pro WPF](https://rads.stackoverflow.com/amzn/click/com/1590599551)（第 726 页）后开始使用它。

基本上 DocumentViewer 类需要一个 XPS 文件来显示它的打印预览。所以我做了以下事情：

```
PrintDialog dialog = new PrintDialog();
var paginator = new RowPaginator(rowsToPrint) { PageSize = new Size(dialog.PrintableAreaWidth, dialog.PrintableAreaHeight) };

string tempFileName = System.IO.Path.GetTempFileName();

//GetTempFileName creates a file, the XpsDocument throws an exception if the file already
//exists, so delete it. Possible race condition if someone else calls GetTempFileName
File.Delete(tempFileName); 
using (XpsDocument xpsDocument = new XpsDocument(tempFileName, FileAccess.ReadWrite))
{
    XpsDocumentWriter writer = XpsDocument.CreateXpsDocumentWriter(xpsDocument);
    writer.Write(paginator);

    PrintPreview previewWindow = new PrintPreview
                                     {
                                         Owner = this,
                                         Document = xpsDocument.GetFixedDocumentSequence()
                                     };
    previewWindow.ShowDialog();
} 
```

我正在创建打印对话框以获取默认页面大小。可能有更好的方法来做到这一点。XpsDocument 位于 ReachFramework.dll（命名空间 System.Windows.Xps.Packaging）中；

这是打印预览窗口。

```
<Window x:Class="WPFPrintTest.PrintPreview"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    x:Name="previewWindow"
    Title="PrintPreview" Height="800" Width="800">
    <Grid>
        <DocumentViewer Name="viewer" 
                        Document="{Binding ElementName=previewWindow, Path=Document}" />
    </Grid>
</Window> 
```

后面的代码只有一个 Document 属性，如下所示：

```
public IDocumentPaginatorSource Document
{
    get { return viewer.Document; }
    set { viewer.Document = value; }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-01-05T07:39:45.983

以下代码使用 MemoryStream 进行打印预览。

```
MemoryStream stream = new MemoryStream();

Package package = Package.Open(stream, FileMode.Create, FileAccess.ReadWrite);

var uri = new Uri(@"memorystream://myXps.xps");
PackageStore.AddPackage(uri, package);
var xpsDoc = new XpsDocument(package);

xpsDoc.Uri = uri;
XpsDocument.CreateXpsDocumentWriter(xpsDoc).Write(paginator);

documentViewer.Document = xpsDoc.GetFixedDocumentSequence(); 
```

请记住在打印预览关闭时使用 close() 并从 PackageStore 中删除包。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T17:41:07.767

WPF 没有任何内置的打印预览功能，如果您想进行打印预览，您将不得不自己构建它。幸运的是，这不应该那么困难。

您已经获得了创建`DocumentPage`对象的分页代码。这些对象包含一个`Visual`，您可以继续并在您的 UI 中显示它。

您最终要做的是对整个文档进行分页，收集所有对象，然后在滚动或类似`DocumentPage`内容中显示它们的视觉效果。`StackPanel`这些是`DocumentPage`您随后可以发送到打印机的相同对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-10-26T16:21:41.890

```
XpsDocument doc = new XpsDocument("filename.xps", FileAccess.Read);
docViewer.Document = doc.GetFixedDocumentSequence();
doc.Close(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T03:35:32.993

打印预览的 WinForm 代码为：

```
PrintPreviewDialog PrintPreviewDialog = new PrintPreviewDialog();
PrintPreviewDialog.Document = PrintDocument;
PrintPreviewDialog.ShowDialog(); 
```

Ps：原发帖人评论说这是WPF应用程序的错误答案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T13:06:12.357

我不认为有这样做的内置方式

这是我如何在 NHaml 中工作的

```
var documentViewHostDialog = new DocumentDialog();
documentViewHostDialog.LoadDocument(load);
documentViewHostDialog.ShowDialog(); 
```

其中“加载”是 FlowDocument 或 IDocumentPaginatorSource，这里是 DocumentDialog [http://code.google.com/p/nhaml/source/browse/trunk/src/NHaml.Xps/DocumentDialog.xaml](http://code.google.com/p/nhaml/source/browse/trunk/src/NHaml.Xps/DocumentDialog.xaml) [http://code。 google.com/p/nhaml/source/browse/trunk/src/NHaml.Xps/DocumentDialog.xaml.cs](http://code.google.com/p/nhaml/source/browse/trunk/src/NHaml.Xps/DocumentDialog.xaml.cs)

希望它适用于您的情况。

# .net - 如何在实体框架中使用数据库中的默认列值？

> ID：584556
> 
> 赞同：41
> 
> 时间：2009-02-25T03:02:59.687
> 
> 标签：.net, entity-framework

我在表中有一个日期列，它具有默认值或绑定为 getutcdate()。我想在实体框架中使用它。在生成 EDM 时，我能够在列级别找到“默认值”属性，但我认为它是硬编码值。

请让我知道如何使用数据库中指定的默认值。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-10-28T22:20:36.803

为实体实现 OnCreated 事件是我找到的解决方案。我有一个我想要填充的 Guid 属性。默认情况下，它被填充全零（00000-0000-00000-等）。通过将以下内容添加到实体的部分类中，我能够处理该问题。

```
partial void OnCreated()
{
    Guid = Guid.NewGuid();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-05-26T22:18:08.417

设置 StoreGeneratedPattern = "Computed" 或 "Identity" 的一个问题是它们不允许客户端提供值。在插入时遇到此问题，但也在更新时遇到此问题。

似乎 StoreGeneratedPattern 需要另一个或两个选项，因此数据库至少可以看到用户提供的值，但如果需要，可以覆盖它。这将允许基于另一字段更新一个字段的任何现有数据库插入或更新触发器工作。例如，更新时的数据库触发器可能仅在未提供时间戳且某些字段已更新时才更新修改的时间戳。

也许 SQL Server 中的列扩展属性功能可用于在提取期间自动设置该字段，因此我们最终不会编辑 XML 文件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-23T19:03:10.537

StoreGeneratedPattern = "Computed" 与默认值不同，因为此属性每次都会使用数据库中的默认值更新。这意味着无法手动更新它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-24T10:33:26.403

您可以将 StoreGeneratedPattern 设置为 Identity，在这种情况下，EF 会在执行 INSERT 语句后读取从数据库返回的值。这种方法的问题是下次生成 XML 映射时，您的更改将丢失。

另一种方法是自己在代码中将值设置为 DateTime.UtcNow。您可以在实体的构造函数中设置它（如果需要，定义一个新的构造函数），或者您可以在您自己的事件处理程序中为您的上下文的 SavingChanges 事件设置它（有关示例，请参见如何[：在保存更改时执行业务逻辑（实体框架）](http://msdn.microsoft.com/en-us/library/cc716714.aspx "如何：保存更改时执行业务逻辑（实体框架）")处理 SavingChanges 事件）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-18T10:16:31.527

这篇文章中提出了另一种解决方案，即在构造函数中使用部分类和方法来设置值。

[如何使用默认实体框架和默认日期值](https://stackoverflow.com/questions/1609304/how-to-use-the-default-entity-framework-and-default-date-values)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-29T10:58:04.500

这是一个可能但不是很好的解决方法 -

在列上设置 Computed 将使其只读，但会使默认值起作用。可以有一个真正的 Computed 列，例如“LastChangedAt_computed”，它显示“LastChangedAt_default”或“LastChangedAt_manual”的值。

现在，计算列显示默认列的值，除非手动列不为空，在这种情况下会显示它。在模型中，默认列的 StoragePattern 需要为“Computed”。

这是一个丑陋的解决方案，但它应该工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-03-08T19:45:49.503

嗯...如果您使用的是 EF6，这实际上比您想象的要容易得多。只需打开您的模型，右键单击要为其设置默认值的列，选择属性，您将看到一个“DefaultValue”字段。只需填写并保存。它将为您设置代码。

其他一些解决方案的问题在于，虽然它们最初可能有效，但一旦您重建模型，它就会丢弃您插入到机器生成的文件中的任何自定义代码。

所以在引擎盖下，UI 通过向 edmx 文件添加一个额外的属性来工作：

```
<EntityType Name="Thingy">
  <Property Name="Iteration" Type="Int32" Nullable="false" **DefaultValue="1"** /> 
```

并通过向构造函数添加必要的代码：

```
public Thingy()
{
  this.Iteration = 1; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-30T21:39:02.847

插入格式：

```
 //class
    [Column("guid")]
    [DatabaseGenerated(DatabaseGeneratedOption.Computed)]
    public string guid_ { get; set; }
    ...
    //end class 
```

**在命令 yourContext.SaveChanges();**

您可以在类模型中看到从数据库返回的默认数据。

好看

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-04-28T19:56:38.700

为实体模型创建部分类非常简单，类似于您为数据注释所做的。然后我覆盖默认构造函数并在构造函数中设置默认属性。奇迹般有效。

```
public partial class CallHistoryLog
{
    public CallHistoryLog() 
    {
        this.NumberFromId = -1L;
        this.NumberFromName = "NO NAME";
        this.NumberToId = -1L;
        this.NumberToName = "NO NAME";
        this.RouteId = -1L;
        this.Viewed = false;
        this.Deleted = false;
        this.DateCreated = DateTime.Now;
    }
} 
```

# visual-studio - VS 2008中的垂直线限制器？

> ID：584559
> 
> 赞同：3
> 
> 时间：2009-02-25T03:04:43.393
> 
> 标签：visual-studio, visual-studio-2008

我确定我可以用谷歌搜索它，它可能已经在 SO 上，但我什至不知道它叫什么。Visual Studio 2008 中是否有一个选项可以激活显示 x 个空格（通常默认为 80）的垂直虚线作为代码行应该多长的指南？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T03:08:51.183

给你：[http ://resharper.blogspot.com/2007/09/visualize-right-margin-in-visual-studio.html](http://resharper.blogspot.com/2007/09/visualize-right-margin-in-visual-studio.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T04:53:32.713

还有“指导方针”

[http://blogs.msdn.com/saraford/archive/2004/11/15/257953.aspx](http://blogs.msdn.com/saraford/archive/2004/11/15/257953.aspx)

# .net - 代码合同，你会用吗？

> ID：584560
> 
> 赞同：9
> 
> 时间：2009-02-25T03:05:03.317
> 
> 标签：.net, design-by-contract

Microsoft 刚刚发布了[Code Contracts](http://msdn.microsoft.com/en-us/devlabs/dd491992.aspx)，这是一个与 Visual Studio 集成的工具，允许您为 .Net 代码定义合同并获得运行时*和*编译时检查。

观看[第 9 频道上的视频](http://channel9.msdn.com/posts/Peli/Getting-started-with-Code-Contracts-in-Visual-Studio-2008/)，了解如何使用它。

现在它是一个附加组件，但它将成为 .Net 4.0 中基类库的一部分

这是你看到自己使用的东西吗？

我想知道这是否意味着[Spec#](http://research.microsoft.com/en-us/projects/specsharp/)的死亡？

**更新**

我所说的 Spec# 的消亡是指我们现在有两个不同的项目来编写合约：
Spec# 是 C# 的演变，它引入了新的关键字和行为；另一方面，微软刚刚发布的是一个可以与任何.Net 语言一起使用的库。
由于后者看起来将成为事实上的标准，我想知道 Spec#

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T03:45:17.167

我认为大多数使用 c# 4.0 的开发人员都会使用它们，包括我自己，尤其是在创建您计划向任何人公开的库时。它可能会使您的代码在某些方面更加冗长，但它的优势应该超过代码行数和花费的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T03:06:40.473

Spec#之死是什么意思？这是 Spec# 的下一个演变。

而且，是的，我打算使用它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T03:50:40.943

老实说，直到我看到你的问题，我才知道它们是什么。我看不到对我的组织的适用性，所以我们可能不会使用它们。

# visual-studio - 附加已作为 JIT 调试器调试的现有 VS.NET 2008 实例

> ID：584565
> 
> 赞同：2
> 
> 时间：2009-02-25T03:08:03.417
> 
> 标签：visual-studio, debugging

是否可以配置 VS.NET 2008“即时”调试器对话框以显示已附加到另一个进程的现有 Visual Studio 实例？

我的场景是运行另一个进程的 NUnit 单元测试。当我调试单元测试时，我想为它运行的子进程自动启动调试器。我将一个特殊参数传递给子进程，然后子进程调用 Debugger.Launch()，这一切都很好，但是当 JIT 调试对话框出现时，它没有列出现有的 VS.NET 实例——我只能打开一个新的例如，这很不方便。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T23:43:11.310

附加到另一个进程的调试器不能附加到辅助进程。我认为可以将调试器附加到多个程序（例如，您可以调试属于同一解决方案的多个网站）。
此外，您不能将多个调试器附加到每个进程。

# language-agnostic - 伪随机数发生器

> ID：584566
> 
> 赞同：14
> 
> 时间：2009-02-25T03:08:27.177
> 
> 标签：language-agnostic, random

创建最佳伪随机数生成器的最佳方法是什么？（任何语言都有效）

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-25T03:12:47.603

创建一个的最好方法是不要。

[伪随机数生成器](http://en.wikipedia.org/wiki/Pseudorandom_number_generator)是一个非常复杂的主题，因此最好使用对该主题有很好理解的人制作的实现。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-25T03:14:02.000

这完全取决于应用程序。例如，创建“最随机”数字的生成器可能不是最快或最节省内存的生成器。

Mersenne [Twister](http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html)算法是一种流行的、相当快的伪随机数生成器，可以产生相当好的结果。它有一个非常大的周期，但也有一个相对庞大的状态（2.5 kB）。然而，它对于加密应用程序来说还不够好。

**更新**：自从编写了这个答案以来，[PCG 系列算法](http://www.pcg-random.org/)的发布似乎在大多数方面（速度、内存、随机性和周期）都优于现有的非加密算法，使其成为除[密码学之外](http://www.pcg-random.org/predictability.html#predictability-of-the-pcg-family)的任何方面的绝佳选择。

如果你在做加密，我的回答仍然是：不要自己动手。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-25T03:42:10.513

德国杂志 C't 在 2/2009 号中测试了许多软件和硬件生成器，并通过各种统计测试运行了结果。

[我在这里](http://cdonner.com/wp-content/images/zufall.jpg)扫描了结果。

我不会费心写我自己的。文章提到，即使是 Donald Knuth 的“超级随机数生成器”也失败了，毕竟它并不是那么随机。获得一个通过所有测试的结果（所有列中的结果 > 0）。他们还使用带有硬件 RNG 的 VIA EPIA M10000 主板测试了设置。对于需要具有高吞吐量的强大随机数服务器的商业或半商业设置，我喜欢此选项。

当然，除非您只是在玩耍，在这种情况下，[这](https://stackoverflow.com/questions/424292/how-to-create-my-own-javascript-random-number-generator-that-i-can-also-set-the-s)可能就足够了。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-25T04:29:53.313

PRNG 算法很复杂，获取正确的熵源以使其正常工作也是如此。这不是你想自己做的事情。每种现代语言都有一个几乎可以肯定适合您使用的 PRNG 库。

![xkcd 随机数](https://imgs.xkcd.com/comics/random_number.png)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-25T03:13:23.233

是的，这会让 VEEEEERY 变得复杂！似乎有许多指标可以衡量随机数生成器的“随机性”，因此很难衡量哪些是“最好的”。我将从[C 中的数字食谱](https://rads.stackoverflow.com/amzn/click/com/0521431085)（或任何你能找到的语言）开始举几个例子。我从那里给出的例子中编写了我的第一个简单的代码。

编辑：首先确定您需要随机数生成器的复杂程度也很重要。我记得几年前我在 C 中的一个粗鲁的觉醒，当时我发现默认随机数生成器的周期约为 32,767，这意味着它在生成那么多数字后往往会周期性地重复自身！如果你需要几个骰子，那很好。但不是当您需要为模拟生成数百万个“随机”值时。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-25T13:14:04.600

查看[随机数生成中的陷阱](http://www.codeproject.com/KB/recipes/pitfalls_random_number.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-10-16T16:24:29.413

有关 TestU01 测试套件，请参阅此链接，其中包括几组测试。

[http://www.iro.umontreal.ca/~simardr/testu01/tu01.html](http://www.iro.umontreal.ca/~simardr/testu01/tu01.html)

在论文中，作者展示了在各种现有 RNG 上的测试结果，但不是 .NET System.Random（据我所知）。尽管他确实测试了 VB6 的生成器。

很少有人能通过所有的测试...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T03:15:40.513

从 knuth 半数字中窃取一个。它质量高且易于实施。它使用一对数组、加法和几个 if。如果我没记错的话，便宜，有效，而且很长一段时间 2^55。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-16T16:31:26.310

如果您打算使用 C++ 工作，那么[Boost](http://www.boost.org/)拥有一组 PRNG，我比标准库中的任何东西都更信任这些 PRNG。该[文档](http://www.boost.org/doc/libs/1_40_0/libs/random/index.html)可能有助于挑选一个。与往常一样，PRNG 的好坏取决于您使用它的目的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-07-10T16:57:31.337

[https://github.com/fsssosei/Pure_PRNG](https://github.com/fsssosei/Pure_PRNG) 用于通过统计测试的 PRNG 算法的 Python 库

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-02-26T01:15:12.263

在生产代码中，利用已建立的库绝对更安全，但从教育的角度来看，了解伪随机数生成器的工作原理并编写自己的库可能很有趣且值得。

有许多不同的技术，但一种直接的方法是基于逻辑图。IE

```
x = r * x * (1 - x) 
```

使用正确的值`r`， 的值`x`表现出混乱和不可预测的行为。有一些陷阱需要注意，您可以在下面的参考资料中了解这些陷阱。

* * *

**参考**

1.  [https://tim.cogan.dev/random-num/](https://tim.cogan.dev/random-num/)
2.  [https://scholar.google.com/scholar?hl=en&as_sdt=0%2C44&q=Logistic+map%3A+A+possible+random-number+generator&btnG=](https://scholar.google.com/scholar?hl=en&as_sdt=0%2C44&q=Logistic+map%3A+A+possible+random-number+generator&btnG=)

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2009-02-25T03:13:22.687

我最喜欢的是[硬件随机数生成器](http://en.wikipedia.org/wiki/Hardware_random_number_generator)

# asp.net - 为什么我的中继器总是在 Eval(NULL) 值上崩溃？

> ID：584570
> 
> 赞同：1
> 
> 时间：2009-02-25T03:11:34.970
> 
> 标签：asp.net, null, repeater

```
<asp:Repeater ID="rptLessons" runat="server">
    <ItemTemplate>
        <tr>

            <td><%#Eval("fullname")%></td>
            <td><%#isCompleted(Eval("totallessons"), Eval("completedlessons"), Eval("totalNumAvail"), Eval("totalNumCorrect"))%></td>
            <td><%#FormatPercent(Eval("totalnumcorrect") / Eval("totalNumAvail"))%> <%-- (<%#Eval("totalnumcorrect")%> / <%#Eval("totalNumAvail")%>) --%></td>
            <td><%#FormatPercent(Eval("completedlessons") / Eval("totallessons"))%> <%-- (<%#Eval("completedlessons")%> / <%#Eval("totallessons")%>) --%></td>
            <td><%#Eval("lastaccessed")%></td>
        </tr>
    </ItemTemplate>
   </asp:Repeater> 
```

我无法弄清楚，但一旦它遇到一些 NULL 数据，它就会拒绝继续绘制下一个元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T04:19:03.653

您需要提供堆栈跟踪以确定。

但我可以看到几个问题：

1.  FormatPercent 中的 DIV#0 错误
2.  空错误。

示例解决方案

（System.Convert.ToInt32 应将 DBNull/NULL 转换为 0）

或更改 isCompleted 以接受 Object 参数并在函数内部进行 NULL / DBNull 检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T04:20:16.457

稍微不同的方法可能会有所帮助，那就是在代码中进行计算，而不是在标记中内联。只是更容易检查空值等。除了标记中的简单 Eval() 之外，我几乎总是沿着这条路走。

```
<td>
    <%#GetCorrectPercent()%>
</td> 

protected string GetCorrectPercent()
{
    if(Eval("totalnumcorrect") == null || Eval("totalNumAvail") == null)
        return "n/a";

    return ((int)Eval("totalnumcorrect") / (int)Eval("totalNumAvail")).ToString();
} 
```

不确定这里的所有格式都是正确的，但这应该会让你朝着不同的方向前进。只要调用者当前正在执行 DataBind()，Eval() 就会在被调用的方法中工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T03:24:14.080

如果我不得不猜测，我会说您的*isCompleted*函数不处理*Nothing*的值。这是一个猜测，因为您的示例中没有列出该函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T09:37:57.897

我更倾向于明确的。*请原谅代码中的任何小错误，我无法对此进行测试。*

如果在您的标记中将这些 eval 换成文字，那么在后面的代码中：

如果你有一个 MyClass 的集合。

在您页面的初始化事件中

```
this.rptLessons.OnItemDataBound += rptLessons_DataBound... 
```

在负载中或您选择的任何地方

```
this.rptLessons.DataSource = CollectionOfMyClass;
this.rptLessons.DataBind(); 
```

然后在那个 itemDataBoundEvent

```
MyClass myClass = (MyClass)ri.DataItem;
Literal litFullname = FindControl(ri, "litFullName");
litFullName.Text = myClass.Fullname; 
```

这样，您可以以比使用 eval 更可控的方式处理空值等问题。

# php - 我可以将两个 MySQL 查询合并为一个吗？

> ID：584571
> 
> 赞同：4
> 
> 时间：2009-02-25T03:12:10.910
> 
> 标签：php, mysql

我有以下代码

```
<?php

$getFriendQuery = "SELECT DISTINCT U.username FROM users as U INNER JOIN test_friends as F on U.Id = F.user_id WHERE F.friend_id = '{$userID}' && F.active=1";

$getFriendResult = mysql_query($getFriendQuery, $conn) or die (mysql_error());

$friendName = "";

while($getFriendFetch = mysql_fetch_assoc($getFriendResult)){
  $friendName .= $getFriendFetch['username'] . ", ";
}

$getFriendQuery  = "SELECT u.username FROM users u INNER JOIN test_friends f ON u.id = f.user_id WHERE (f.friend_id = '{$userID}' AND active=1) OR (f.user_id = '{$userID}' AND active=1)";

$getFriendResult = mysql_query($getFriendQuery, $conn) or die (mysql_error());

while($getFriendFetch = mysql_fetch_assoc($getFriendResult)){
  $friendName .= $getFriendFetch['username'] . ", ";
}

if (!empty($friendName)){
  echo "Your friends: " . $friendName ;
} else {
  echo "You do not have any friends yet";
  } 

?> 
```

我的代码需要 2 个查询才能获得`"friends list"`. 有没有办法执行 1 个查询并可以检索所有朋友列表？

更多信息：

我有2张桌子。`"Users table"`和`"test_friends"`桌子。用户表有：

`id`代表`user id => data type int(11)`

```
username => data type varchar(256) 
```

`Test_friends`表有：

`user_id`代表`user id => data type int(11)`

```
friend_id => data type int(11)

active => tinyint 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T03:51:42.940

您应该能够进行联合以同时执行两个查询。您的 SQL 将如下所示：

```
SELECT U.username
FROM   users AS U
INNER JOIN test_friends AS F
ON     U.Id = F.user_id
WHERE  F.friend_id = '{$userID}'
AND    F.active = 1
UNION
SELECT u.username
FROM   users u
INNER JOIN test_friends f
ON     u.id = f.user_id
WHERE  ( f.friend_id = '{$userID}'
AND      active = 1 )
OR     ( f.user_id = '{$userID}'
AND      active = 1 ) 
```

它还会自动为您删除重复项，就像您在整个批次中包含 DISTINCT 一样。（如果您不想这样做，请执行“UNION ALL”。）

此外，如果您想对结果进行排序，请在末尾添加“ORDER BY 1 ASC”。您只能在带有联合的 ORDER BY 子句中使用结果集列号。

联合查询只有在每个子查询的结果集中返回的列的数量和类型都相同时才有效。

*旁白：您的第一个查询似乎是第二个查询的子集，因此您实际上只需要第二个查询。我将它保留原样作为如何进行联合的演示，但在这种情况下你并不需要这样做。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T03:54:21.823

您可以在两个查询之间执行 UNION。例如：

```
SELECT username FROM users WHERE username like '%billy%'
UNION 
SELECT username FROM users WHERE username like '%bob%' 
```

将返回名称为 billy 或 bob 的所有用户。将上面的整个两个查询与 UNION 结合起来应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T10:55:32.297

所以你想要 $userID 的朋友的名字和有 $userID 作为朋友的用户的名字？怎么样

```
select distinct U.username 
from users U 
inner join test_friends f 
on 
    (f.user_id = U.id AND f.friend_id={userID}) OR 
    (f.friend_id=U.id AND f.user_id={userID})
where active=1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T04:17:49.693

由于您的第一个查询似乎是您的第二个查询的子集，您应该只需要执行第二个查询。

我假设在**Test_Friends**表中，*user_id*字段代表用户的用户 ID，*friend_id*字段代表用户朋友的用户 ID。

如果是这种情况，那么您可以执行查询：

```
SELECT DISTINCT U.username 
   FROM Test\_Friends F 
   INNER JOIN Users U ON F.friend\_id = U.user\_id 
WHERE 
   F.user\_id = '{$userID}' AND 
   F.active = 1 
```

# python - Python 2.5 上选择模块的问题

> ID：584575
> 
> 赞同：3
> 
> 时间：2009-02-25T03:12:49.273
> 
> 标签：python, macos, beanstalkd

我在 Python 2.5 中有一个应用程序，它监听 beanstalk 队列。它在我迄今为止测试过的所有机器上都能正常工作，除了我新买的 MacBook Pro。

在该计算机上，当我尝试运行它时，出现此错误：

```
Traceback (most recent call last):
  File "jobs.py", line 181, in <module>
    Jobs().start()
  File "jobs.py", line 154, in start
    self.jobQueue = Queue()
  File "src/utils/queue.py", line 16, in __init__
    self.connection = serverconn.ServerConn(self.server, self.port)
  File "src/beanstalk/serverconn.py", line 25, in __init__
    self.poller = select.poll()
AttributeError: 'module' object has no attribute 'poll' 
```

serverconn.py 有以下导入：

```
import socket, select 
```

当我尝试从命令行运行它时，它也失败了：

```
Python 2.5.1 (r251:54863, Jul 23 2008, 11:00:16) 
[GCC 4.0.1 (Apple Inc. build 5465)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import select
>>> select.poll()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'module' object has no attribute 'poll' 
```

您对可能发生的事情有任何想法吗？

PS：尽管我很确定这不是源问题，但如果您需要有关失败的源的一些背景信息，可以在 [ [http://pastie.org/399342]（this](http://pastie.org/399342](this) paste）上找到。

*更新：*因为我得到的第一个答案推测 Mac OS 是否支持 select.poll() ，但我也有一个 iMac 并且具有完全相同的 OS 版本并且它工作正常：

```
2009-02-25 00:27:10,067 - Queue - DEBUG - Connecting to BeansTalk daemon @ localhost:11300 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-02-26T02:56:02.293

根据[这张 macports 票](http://trac.macports.org/ticket/18376)，Apple 的 poll() 实现直接被打破了。Apple 通过禁用 Python 中的 poll() 来解决这个问题，而 macports 现在也禁用了 Python 中的 poll。我认为这意味着您需要查看 Python 的 select.kevent() 而不是在 mac 上进行 poll 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T04:07:01.730

我想你的答案就在这里

[http://atomized.org/2008/12/python-on-os-x-leopard-lacks-selectpoll/](http://atomized.org/2008/12/python-on-os-x-leopard-lacks-selectpoll/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T03:16:17.033

[**select.poll()**](http://docs.python.org/library/select.html?highlight=select#select.poll)

（*并非所有操作系统都支持。*）返回一个轮询对象，支持注册和注销文件描述符，然后轮询它们的 I/O 事件；有关轮询对象支持的方法，请参阅下面的轮询对象部分。

我的猜测是 macOS 不支持它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T04:41:29.757

在 MBP 上使用[MacPorts](http://www.macports.org/)版本。`python`

Mac OS X 支持这一点。苹果股票 Leopard`python 2.5.1`没有。

如果您还没有，您将需要下载并安装 MacPorts。仅供参考，我发现[Porticus](http://porticus.alittledrop.com/)是 MacPorts 周围的优秀 GUI。

这是库存 Leopard python 与最新的 MacPorts python2.5 的比较...

* * *

Apple 的 Leopard python (python 2.5.1) -**`select.poll()`坏了**

```
$ /usr/bin/python
Python 2.5.1 (r251:54863, Jan 13 2009, 10:26:13) 
[GCC 4.0.1 (Apple Inc. build 5465)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import socket, select
>>> select.poll()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'module' object has no attribute 'poll'
>>> 
```

Macports (python 2.5.4) -**`select.poll()`有效！**

```
$ /opt/local/bin/python2.5
Python 2.5.4 (r254:67916, Feb  3 2009, 21:40:31) 
[GCC 4.0.1 (Apple Inc. build 5488)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import socket, select
>>> select.poll()
<select.poll object at 0x11128>
>>> 
```

# java - 使用 Wicket 制作网站模板和主题的首选方式是什么？

> ID：584576
> 
> 赞同：6
> 
> 时间：2009-02-25T03:13:07.070
> 
> 标签：java, templates, themes, wicket

我只是在学习 Wicket，而谷歌搜索会产生关于如何使用 Wicket 对网站进行主题/模板化的不同结果。看来常用的方法有：

*   标记继承（[说明](http://jroller.com/pKulak/entry/markup_inheritance_with_wicket)）
*   边框（[说明](http://cwiki.apache.org/WICKET/consistent-page-layout-using-borders.html)）
*   可重复使用的面板（[描述](http://www.javalobby.org/java/forums/t60926.html)）
*   片段（[描述](http://wicket.apache.org/examplefragments.html)）

**在 Wicket 中执行此操作的最佳实践/“正确”方法是什么？**还是这些不同的方法都有特定的用途？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T22:20:49.310

看看检票口定位器。我认为“样式”是您正在寻找的。

因此，如果您只有一个语言环境并且您想为主页创建“样式”，您可以创建：

*   主页.html
*   Home_style1.html
*   Home_styleanother.html

Wicket 样式也适用于字符串和其他资源。

请参阅[应用程序的本地化和蒙皮](http://cwiki.apache.org/WICKET/localization-and-skinning-of-applications.html)。

# java - GWT 中的泛型和集合，空指针

> ID：584596
> 
> 赞同：1
> 
> 时间：2009-02-25T03:26:40.220
> 
> 标签：java, generics, gwt

调用将对象添加到 GWT 中的集合的方法时，出现空指针错误。我不知道为什么我所做的一切都创建了一个非常简单的对象（仅包含一个字符串）。下面是调用函数和函数的代码：

```
public class PlantMenu extends VerticalPanel {

    private Collection<PlantData> plantList;
    private Collection<PlantData> newPlantData;

    public PlantMenu() {
        createPlants();
        /*
        for(Iterator<PlantData> i = plantList.iterator(); i.hasNext();) {
            Window.alert(i.next().getPlantName());
        }*/
    }

    public Collection<PlantData> createPlants() {
        PlantData plant1 = new PlantData("Herbs");
        PlantData plant2 = new PlantData("Flowers");
        PlantData plant3 = new PlantData("Vegetable");

        newPlantData.add(plant1);
        newPlantData.add(plant2);
        newPlantData.add(plant3);
        return newPlantData;
    }

} 
```

尝试添加第一个植物时，它会出错（空指针），这一行：

PlantData plant1 = new PlantData("Herbs");

任何帮助表示赞赏:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T03:29:26.550

你没有初始化你的集合。尽管如此，你已经告诉过它不在那条线上，但我对此表示怀疑。不过，显示完整的异常堆栈会更有帮助。并且异常可能发生在您的 PlantData 构造函数中，但您没有在此处显示。

你可以做这样的事情，

```
private Collection<PlantData> plantList = new ArrayList<PlantData>();
private Collection<PlantData> newPlantData = new ArrayList<PlantData>(); 
```

我用过ArrayList，因为一般我们用ArrayList。根据需要，也可以使用其他实现方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T05:48:53.483

您没有正确初始化变量，这与 GWT 无关，只是基本的 Java。这是一个工作版本：

```
public class PlantMenu extends VerticalPanel {

    private List<PlantData> plantList = new ArrayList<PlantData>();
    private List<PlantData> newPlantData = new ArrayList<PlantData>();

    public PlantMenu() {
        createPlants();
        for(PlantData plant : newPlantData) {
                Window.alert(plant.getPlantName());
        }
    }

    public List<PlantData> createPlants() {
        newPlantData.add(new PlantData("Herbs"));
        newPlantData.add(new PlantData("Flowers"));
        newPlantData.add(new PlantData("Vegetable"));
        return newPlantData;
    }

} 
```

作为旁注，您不应该扩展 VerticalPanel，而是扩展 Composite，然后使用垂直面板作为您的小部件，使用 setWidget(...);

# c++ - 什么时候适合使用 C++ 异常？

> ID：584599
> 
> 赞同：3
> 
> 时间：2009-02-25T03:27:25.743
> 
> 标签：c++, exception, memory, error-handling, raii

我正在尝试设计一个需要动态分配一些内存的类..

我计划在构建过程中分配它需要的内存，但是我该如何处理失败的内存分配呢？我应该抛出异常吗？我在某处读到异常应该只用于“例外”情况，而内存不足对我来说似乎不是例外情况。

我是否应该在单独的初始化例程中分配内存并检查故障，然后优雅地销毁类实例？

或者我应该改用异常？如果这些内存分配失败，该类将没有任何有用的事情可做。

* * *

编辑：共识似乎是内存不足是一个例外情况。

将看到如何去做这件事.. 谢谢.. :)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-25T03:33:46.850

假设您使用 new 来分配内存，并且没有覆盖`new`运算符，如果它无法正确分配内存，它将自动抛出`std::bad_alloc`异常。

> 我在某处读到异常应该只用于“例外”情况，而内存不足对我来说似乎不是例外情况。

内存不足对我来说似乎是一个非常特殊的情况:)

处理这种情况非常困难。您可能希望向应用程序的用户返回一个有意义的错误，但如果这是由于内存不足引起的问题，您甚至可能无法负担分配错误消息的内存。这确实有点像第 22 条规定的情况。

有一种防御性编程技术（有时称为内存降落伞或雨天基金），您可以在应用程序启动时分配一块内存。然后，当您处理`bad_alloc`异常时，释放此内存，并使用可用内存正常关闭应用程序，包括向用户显示有意义的错误。这比崩溃要好得多:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T03:33:31.483

我认为内存不足（尤其是堆内存）是一个例外情况，如果你的类——以及你的应用程序——不能继续，我认为异常抛出/处理是一种非常合适和优雅的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T03:32:24.483

当内存不足时，C++ 中的通常行为是抛出异常。默认情况下，内置`new`运算符会执行此操作。

# math - 与vector*matrix相比，matrix*vector是什么意思

> ID：584604
> 
> 赞同：3
> 
> 时间：2009-02-25T03:30:56.747
> 
> 标签：math, 3d, directx, matrix, xna

如果我这样做`positionVector*worldMatrix`，该位置将转换为世界空间。但是，如果我`worldMatrix*positionVector`在 3d 空间中以相反的方式 ( ) 这样做会发生什么？

我注意到结果与第一个不同。我已经用谷歌搜索了矩阵，他们解释了很多数学但不是这个，至少我找不到它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T04:15:03.770

正如其他人所指出的 - 交换乘法的顺序相当于乘以转置。碰巧的是，旋转矩阵是一种特殊类型的矩阵，称为[正交矩阵](http://en.wikipedia.org/wiki/Orthogonal_matrix)，它为您提供了许多简洁的属性。

最有趣的可能是矩阵的转置是它的逆。对于您的世界变换乘以倒数相当于在世界空间中获取一个位置并将其拉入变换关联的对象的局部坐标中。

例如，考虑一个在世界中任意定向的盒子 - 乘以逆世界变换可以（当然完全取决于应用程序:)）将您置于轴对齐的空间中，并且如果您有兴趣寻找与在盒子的本地空间中进行计算的其他对象会使这更容易。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-25T03:39:50.097

在矩阵*向量中，您的向量将被解释为列向量。在向量*矩阵中，它将被解释为行向量。2x2 示例：

```
/ a b \   / e \   / ae+bf \
|     | * |   | = |       |
\ c d /   \ f /   \ ce+df /

          / a b \
( e f ) * |     | = ( ea+fc eb+fd )
          \ c d / 
```

如您所见，结果是不同的。

顺便说一句，在转置矩阵后做一个与做另一个相同。

在 3D 空间方面，如果您认为这两个选项之一是线性变换，我不知道对另一个选项是否有任何明智的解释。[这个 Wikipedia 部分](http://en.wikipedia.org/wiki/Transpose#Transpose_of_linear_maps)对此进行了说明，但这超出了我对线性代数的理解。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T03:42:06.673

(matrix * vector) 等价于 (vector * transpose(matrix))

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T03:52:46.180

矩阵数学规则：

给定矩阵**A**和**B**，大小为 MxN 和 OxP，

*   仅当 N=O 时才定义 矩阵乘积**A** * **B。**
*   结果将是一个大小为 MxP 的矩阵。

另一个重要规则是矩阵乘法不可交换。 **A** * **B** != **B** * **A**

通常在计算机图形学中，位置向量是一个 4x1 矩阵，而世界视图矩阵是正方形，4x4。因此，您应该期望将世界视图矩阵与位置向量预乘是未定义的。将世界视图矩阵应用于位置向量的正确方法是按另一个顺序，将位置向量与世界视图矩阵预乘。（我说的是数学，这里）

要获得更多矩阵数学的乐趣，请查看本[教程](http://chortle.ccsu.edu/VectorLessons/vectorIndex.html)。

# jquery - 使用 jQuery 附加 HTML w/click 事件

> ID：584605
> 
> 赞同：11
> 
> 时间：2009-02-25T03:31:00.740
> 
> 标签：jquery, html

我想在这个 div 中附加一些 HTML，并且 HTML 也必须有一个点击事件。

```
 <div id="myID">
        <p>hello, world!</p>
    </div> 
```

我想在上面的 div 中插入一个新的 div，并且我想在我插入的新 HTML 上点击一个事件。新 div 内会有一些动态文本，因此必须动态创建。

如何做呢？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-25T03:34:55.880

关于什么 ：

```
$("#myID").click(
  function () {
     var someText = "my dynamic text";
     var newDiv = $("<div>").append(someText).click(function () { alert("click!"); });
     $(this).append(newDiv);
  }
) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-25T03:53:58.970

从 jQuery 1.3 开始，这将起作用：

```
<div class="myClass">
<p>hello, world!</p>
</div>

$(".myClass").live("click", function(){
    $(this).after("<div class='myClass'><p>Another paragraph!</p></div>");
}); 
```

在此页面上查看有关现场活动的更多信息：

[http://docs.jquery.com/Events](http://docs.jquery.com/Events)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T15:30:15.027

**重要的：**

考虑到如果您使用最具体的选择器，性能应该会更好。对于这种情况，如果您只想影响“MyId”div 中的 div，您应该使用：

```
$("#MyId").on("click", "div", function(e) {
    // Whatever you want to do when the divs inside #MyId div are clicked
}); 
```

**很重要：**

考虑到 on 方法的第二个参数，在本例中为“div”，是可选的，但如果您希望事件自动附加到动态创建的项目，则需要提供它。这在 jquery 文档中称为“on”方法的延迟。我希望此信息可以为将来阅读此内容的人节省时间:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-20T11:45:03.380

安德鲁给我解决了这个问题！但是 .live 在最新版本的 jquery 中已被弃用（从 1.7 开始）。在 top.document 上使用 .on 或 .delegate 来绑定这些事件类型。看：

```
$(document).on(".myClass", "click", function(){
    $(this).after("<div class='myClass'>Another paragraph!</div>");
}); 
```

恭喜我的朋友！

# c# - 如何在 ASP.Net 和 C# 网页中将 Reporting Services 报表显示为内联 PDF？

> ID：584609
> 
> 赞同：3
> 
> 时间：2009-02-25T03:33:10.847
> 
> 标签：c#, .net, asp.net, reporting-services

我需要在 ASP.Net 网页中显示报告的预览（使用 C# 服务器端脚本）。预览需要是 PDF 而不是 HTML 并内联显示（可能在 iframe 中？）。

是否可以指定呈现为 PDF 的报告的标题，因此它的“内容处置”是内联的而不是附件？

或者有没有其他方法可以在 ASP.Net 网页中显示呈现为 PDF 内联的报表？

* * *

我正在使用 Reporting Services 2008

在 ASP.Net 站点中，我使用对 ReportService2005.asmx 和 ReportExecution2005.asmx 的 Web 引用

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T03:41:05.320

我正在做一些非常相似的事情。但我使用的是 HttpWebRequest 而不是使用该服务。这就是我的做法。**重要的部分是 Content-Disposition 中文件名之前的内联**。

这还取决于他们的 Adob​​e Reader 版本（我们发现他们需要 7 或更高版本）以及他们在其中设置的设置（以防他们将其设置为不在浏览器中打开 PDF）。

```
HttpResponse currentResponse = HttpContext.Current.Response;
currentResponse.Clear();
currentResponse.ClearHeaders();
currentResponse.ClearContent();

filename = String.Format("{0}.pdf", this.ReportName);
currentResponse.AppendHeader("Content-Disposition", String.Format("inline;filename={0}", filename));
currentResponse.ContentType = "Application/PDF";

//Copy the content of the response to the 
//current response using BinaryWrite
snip....

currentResponse.End(); 
```

# .net - 将 DateTime 转换为 OracleTimeStampTZ

> ID：584631
> 
> 赞同：1
> 
> 时间：2009-02-25T03:45:06.073
> 
> 标签：.net, oracle, datetime

在将 DateTime 保存到数据库之前不久，我将 DateTime 转换为 OracleTimeStampTZ。这会将 DateTime 转换为当前时区中的 OracleTimeStampTZ，这很酷，这就是我想要的。除了时区表示为时间偏移（+13，因为我在新西兰）。

现在我有点担心这会在夏令时方面咬我一口。我宁愿将 OracleTimeStampTZ.TimeZone 表示为命名时区（因此是数据库中的命名时区）。

为了保持一致性，我想使用由 .NET 确定的时区（IE 使用 TimeZoneInfo.Local）。

问题是 TimeZoneInfo 似乎不包含与 oracle 时区名称匹配的时区名称。此外，OracleTimeStampTZ.TimeZone 属性是只读的。

有人知道实现这一目标的好方法吗？

提前致谢

== 编辑解释我对 DST 的担忧 ==

好的，我担心的是以下几点：假设我现在在数据库中保存了一个日期，该日期将在一年半后发生的事件（无论如何在夏令时的另一边）。

假设我保存的日期/时间是 16:00 +13。当我们到达夏令时的另一边时，我所在国家/地区的偏移量可能是 +12，这意味着在我的本地时区中，我之前保存的日期被认为是 15:00，因为我的偏移量已经改变，但存储的偏移量没有。

据我了解，如果存储了命名时区，那么当我们评估夏令时另一侧的日期时，我们可以根据它是否为 DST 来确定要使用的正确偏移量。

我所描述的是否正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T05:24:45.057

我想你可能还好。你能为你担心的问题勾勒出一个用例吗？IIRC，Oracle 知道夏令时，并且（因为正在存储日期）我不确定你怎么会丢失信息——你会知道夏令时是否有效，对吧？

——马库斯

所以我要尝试的第一件事是保存这样一个日期并查看它的偏移量。换句话说，用于时区的数字偏移量可能（正确地）是日期的函数。

我想另一种选择，如果这不起作用，将时区名称保存在枚举列中并根据需要重建时间。不漂亮，但是...

# c - 截断文件

> ID：584639
> 
> 赞同：12
> 
> 时间：2009-02-25T03:47:57.597
> 
> 标签：c, windows, winapi

我正在使用 fopen fseeko64 ftello64 fclose 等对文件进行操作。

如何截断文件？我知道在 C 中没有标准的方法可以做到这一点。我想要的只是在任何 win32 平台上都可以使用的方法。我正在使用 mingw gcc 进行编译。

请注意：我的意思是将文件的大小截断为指定的大小，而不是使其大小为 0。并且使用将部分复制到另一个文件和删除/重命名之类的技巧是不合适的。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-25T03:50:43.080

[SetEndOfFile()](http://msdn.microsoft.com/en-us/library/aa365531(VS.85).aspx)

获取具有写访问权限的文件的句柄，设置文件指针，然后调用 SetEndOfFile()。

-亚当

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-25T03:49:50.510

如果要将文件截断为零大小，可以`fopen`使用以下`"w"`标志：

```
FILE *fh = fopen("file.txt","w");
if (fh != NULL) fclose(fh); 
```

要在标准 C 中截断到特定大小，您可以使用传输/重命名解决方案来执行此操作，例如：

```
FILE *finp = fopen ("inp.txt", "rb");       // should check for NULLs
FILE *fout = fopen ("out.txt", "wb");

size_t sz = 100000;                         // 100,000 bytes
char *buff = malloc (sz);                   // should check for NULL

sz = fread (buff, 1, sz, fin);              // should check for errors
fwrite (buff, 1, sz, fout);

free (buff);

fclose (fin);
fclose (fout);

rename ("out.txt", "inp.txt);               // should check for error 
```

当然，如果您可以访问 Win32 头文件和库（我相信 MinGW 会为您提供），您可以使用`SetEndOfFile()`，因为它就地执行它，而不必创建一个新文件然后重命名它。

这意味着使用基于 Windows 句柄的文件 I/O 而不是基于 C的文件 I/O `FILE*`，但是，如果您仍然将自己限制在 Windows 中，那可能并不重要。另一方面，如果您想要可移植性，则需要基于标准 C 的解决方案，例如上面的传输/重命名解决方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-12-01T17:30:19.627

对于基于 FILE 的文件操作，使用 _fileno() 和 _chsize_s() 来更改文件的大小。

```
int changesize(FILE *fp, __int64 size)
{
    int filedes = _fileno(fp);
    return _chsize_s(filedes, size);
} 
```

可以通过验证提供的大小小于当前文件大小来编写截断版本，因为 _chsize_s() 将截断或扩展文件的大小 - 请参阅[http://msdn.microsoft.com/en-us/library/whx354w1 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/whx354w1(VS.80).aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T03:49:23.910

如果您只是`fopen()`一个带有`"w"`参数的文件，它将被截断。

[http://www.cplusplus.com/reference/clibrary/cstdio/fopen.html](http://www.cplusplus.com/reference/clibrary/cstdio/fopen.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T03:56:33.770

如前所述，您可以将 fopen() 与“w”标志一起使用，例如：

```
FILE *f = fopen("file.txt", "w"); 
```

此外，如果您已经打开了文件，您可以使用函数 freopen()，再次使用“w”标志：

```
FILE *f = fopen("file.txt", "r");  //initial fopen() call
...
f = freopen("file.txt", "w", f);   //reopens "file.txt" and truncates it 
```

[http://www.cplusplus.com/reference/clibrary/cstdio/freopen.html](http://www.cplusplus.com/reference/clibrary/cstdio/freopen.html)

编辑：在看到你编辑了你的 OP 之后，我不会重新发布 Pax 和 Adam Davis 已经发布的内容。另外，我将确认 Pax 所说的，MinGW 确实允许您访问 Win32 标头。

# .net - 测试是否在派生类中声明了属性

> ID：584660
> 
> 赞同：0
> 
> 时间：2009-02-25T03:57:05.140
> 
> 标签：.net, reflection

我有两节课

```
public class A
{
  public int BaseA
{get;set;}
}

public Class B: A
{
 public int BaseB
{get;set;}
} 
```

我可以使用 typeof(B).GetProperties() 获取 B 类的属性。但是，这将包括 BaseA 和 BaseB 属性。但我只想获得 BaseB 属性。

注意：我找到了解决方案，它是

```
 B boy = new B();
            var pList = boy.GetType().GetProperties(BindingFlags.Public |
                  BindingFlags.DeclaredOnly |
                  BindingFlags.Instance);
            Assert.AreEqual(1, pList.Length); 
```

[可以在此处找到](https://stackoverflow.com/questions/245401/how-do-i-get-the-properties-of-an-object-using-reflection)类似的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T04:04:03.283

查看调用 Type.GetProperties() 时使用 BindingFlags.DeclaredOnly。

# ios - 使用 iPhone SDK 以编程方式拨打电话号码并传递 DTMF

> ID：584663
> 
> 赞同：30
> 
> 时间：2009-02-25T03:57:27.543
> 
> 标签：ios, phone-call

您如何通过 iPhone SDK 以编程方式执行以下操作：

1.  通过 iPhone SDK 以编程方式拨打电话号码

2.  绕过 iPhone 调出的**拨号/取消**提示

3.  拨打号码后发送额外的 DTMF，就像您将暂停编程到普通电话中一样。

我知道您可以`tel://`拨打电话，但问题是它会显示拨号/取消提示，然后会阻止发送任何未来的 DTMF。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-25T04:00:20.953

iPhone SDK 不能让您直接访问拨号号码（想象一下，如果您的手机上有一个“坏”程序，并且在静音状态下拨打了按分钟计费的号码，而您没有注意到）。

但是，如果您使用 tel 链接，那么您应该能够发送插入暂停的“，”字符。

所以拨打 555-1212，然后等待 4 秒，然后在按键音上执行 12345#，您将使用 tel:5551212,,12345#

查看 [https://developer.apple.com/library/archive/featuredarticles/iPhoneURLScheme_Reference/PhoneLinks/PhoneLinks.html](https://developer.apple.com/library/archive/featuredarticles/iPhoneURLScheme_Reference/PhoneLinks/PhoneLinks.html)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2011-02-09T09:57:07.013

我不知道为什么每个人都说你不能......你**可以**！

```
NSString *phoneNumber = @"15555551212";
NSString *dtmfAfterPickup = @"1234";
NSString *telString = [NSString stringWithFormat:@"tel:%@,%@", phoneNumber, dtmfAfterPickup];
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:telString]]; 
```

这将绕过拨号/取消提示拨打电话号码... 接听电话 1 秒后，***将***自动拨打 dtmfAfterPickup 字符串***。***

 *[检测设备是否支持电话呼叫](https://stackoverflow.com/questions/5094928/ios-detecting-whether-or-not-device-support-phone-calls/11595365#11595365)是个好主意

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-23T02:48:22.780

根据上面 Adam 的 Apple 开发人员链接，有这个 RFC 链接，它解释了有关 iPhone 支持的电话链接方案的不同选项的更多信息 -

[http://www.ietf.org/rfc/rfc2806.txt](http://www.ietf.org/rfc/rfc2806.txt)

这至少允许您在 URL 中插入带有“p”的暂停，但是根据 RFC 指定了很多选项（但并非全部都是必需的）。还有什么作用？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-03T15:33:58.867

我尝试使用我的 iPhone 使用 CoronaSDK 和 openurl API。它工作得很好！只需执行：system.openURL("tel:[phonenumber],123")。您可以使用附加逗号等待更多。使用 Corona SDK / iOS7 测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-15T21:58:43.003

其实我只是尝试了以下555-555-4822 EXT 8030

即使在按下拨号后，它似乎也会发出一些音调（p 的数量代表延迟的秒数）。然而，音调并没有像预期的那样在远端得到响应，所以还是有问题。

但是，这确实有效，尽管它更容易出现计时问题，电话：555-555-4822, 8030。这只是在连接后暂停一秒钟（，，将是两秒钟），然后播放 8030 音调

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-25T04:00:19.703

你不能这样做。SDK 不允许您在此详细级别控制电话功能。

# c# - 为什么不能用相同的签名声明两个方法，即使它们的返回类型不同？

> ID：584664
> 
> 赞同：5
> 
> 时间：2009-02-25T03:57:58.010
> 
> 标签：c#, method-signature

**重复**：[返回类型的函数重载？](https://stackoverflow.com/questions/442026/function-overloading-by-return-type)

* * *

也许这是一个非常愚蠢的问题，但我不明白为什么当它们具有不同的返回类型时，我不能声明具有相同签名的两个方法。

```
public class MyClass
{
    private double d = 0;

    public double MyMethod()
    {
        return d;
    }

    public string MyMethod()
    {
        return d.ToString();
    }
} 
```

我收到一个编译错误，指出该类已经定义了具有相同参数类型的成员。

（显然我在我的代码中使用它的方式并不像我的示例代码那么简单......但我认为它可以理解这个想法。）

我是否遗漏了一些关于 OO 设计的东西，这使得我正在尝试做一个 OOP 反模式？只要我明确告诉它我想要哪一个，编译器当然应该能够确定我正在尝试使用哪种方法。

鉴于`MyClass myClass = new MyClass();`我希望以下代码能够工作：

```
double d = myClass.MyMethod();
string s = myClass.MyMethod(); 
```

我希望以下代码有问题：

```
var v = myClass.MyMethod(); 
```

但即使在`var`它的情况下也会导致编译错误。

谁能看到我在这里做错了什么？我很高兴得到纠正。:-)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-25T04:01:04.320

这是因为类型强制。

假设您具有以下功能：

```
int x(double);
float x(double);

double y = x(1.0); 
```

现在，你应该调用这两个原型中的哪一个，尤其是当它们做两件完全不同的事情时？

基本上，在语言设计的早期就做出了一个决定，即只使用函数名和参数来决定调用哪个实际函数，在新标准到来之前我们一直坚持这一点。

现在，您已经标记了您的问题`C#`，但我认为设计一种可以执行您建议的语言并没有错。一种可能性是将上述任何模棱两可的命令标记为错误，并强制用户指定应该调用的命令，例如使用强制转换：

```
int x(double);
float x(double);
double y = (float)(x(1.0));    // overload casting
double y = float:x(1.0);       // or use new syntax (looks nicer, IMNSHO) 
```

这可以允许编译器选择正确的版本。这甚至适用于其他答案提出的一些问题。你可以把模棱两可的：

```
System.out.Println(myClass.MyMethod()); 
```

进入具体：

```
System.out.Println(string:myClass.MyMethod()); 
```

`C#`如果它在标准过程中不太远（Microsoft 会倾听） ，那么它可能会被添加，但我不认为你有太多机会将它添加到`C`或`C++`没有大量的努力。也许将其作为扩展`gcc`会更容易。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-25T04:01:03.977

没有什么可以阻止您在不“捕获”返回类型的情况下调用您的方法。没有什么可以阻止你这样做：

```
myClass.MyMethod(); 
```

在这种情况下，编译器如何知道要调用哪一个？

编辑：除此之外，在 C# 3.0 中，当您可以使用**var**时，编译器将如何知道您在执行此操作时调用的方法：

```
var result = myClass.MyMethod(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T04:04:42.003

因为在调用方法时返回类型并不是那么重要。在许多情况下，只有返回类型不同的方法会导致歧义。您可能根本不会将结果存储在变量中，或者执行以下操作：

```
System.out.Println(myClass.MyMethod()); 
```

编译器无法确定您要调用哪些方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T04:00:47.083

方法签名只是名称和输入参数（类型和顺序）。返回类型不是签名的一部分。因此，具有相同名称和输入参数的两个方法相同并且相互冲突。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T04:01:15.990

您分配方法的变量（如果有）无法通知编译器使用哪种方法。想象：

字符串消息 = "结果 = " + myClass.MyMethod();

# boost - Boost 库的 Doxygen 文档？

> ID：584667
> 
> 赞同：11
> 
> 时间：2009-02-25T04:00:19.767
> 
> 标签：boost, documentation, doxygen

网络上某处是否有 Boost 库的 doxygen 文档？

我可以创建自己的，但我认为它应该已经存在于网络上的某个地方？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-11T06:41:15.813

不久前，我从 Boost 生成了一些 Doxygen 输出。它在这里托管：

[http://charette.no-ip.com:81/programming/doxygen/boost/doxygen_notes.html](http://charette.no-ip.com:81/programming/doxygen/boost/doxygen_notes.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-16T02:14:13.620

有几套文档。

当前版本的 boost 的文档可以**在网络**上的以下链接中找到（具体的旧版本链接在右侧）。

[http://www.boost.org/doc/libs/](http://www.boost.org/doc/libs/)

如果您正在寻找**HTML 文档的可下载版本**，那么它也包含在您可以从网站下载的 boost 发行版中。在您喜欢的浏览器中打开目录中的`index.html`文件。`libs`

`hhc.exe`就个人而言，我非常想要一个完整的 CHM 文件，但似乎这些必须使用 Doxygen 和Windows（我不使用）手动生成（增强不提供它们） ，所以不胜感激任何信息关于获取 boost 文档的最新 CHM。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T05:11:41.700

Boost 库有相当多的模板代码和预处理器宏。Doxygen 不太了解模板或宏。我会坚持使用标准的 boost 文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-06-07T08:15:14.757

虽然不是基于 doxygen，但您可能会发现以下站点很有用。Boost Graph library (v1.42) 在线可浏览 LXR 源代码可[在此处](http://acode-browser2.usatlas.bnl.gov/lxr-rel16/source/external/Boost_1.42.0_python2.6/boost-1_42/boost/graph/)获得。您可以从定义跳转到使用，反之亦然。要浏览其他 boost 组件，如 bind、type_traits 等，只需向下导航[主站点](http://acode-browser2.usatlas.bnl.gov/lxr-rel16/source/external/Boost_1.42.0_python2.6/boost-1_42/boost)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T04:23:57.900

最终的 Boost 文档是 boost.org 上提供的文档。对于大多数图书馆来说，它们往往非常好。

文档不足以满足哪些特定的库？

# sql - 如何使此 SQL 语句返回空字符串而不是 NULLS？

> ID：584674
> 
> 赞同：3
> 
> 时间：2009-02-25T04:03:01.350
> 
> 标签：sql, null

```
LastAccessed=(select max(modifydate) from scormtrackings WHERE 
bundleid=@bundleid and userid=u.userid),
CompletedLessons=(select Value from scormtrackings WHERE 
bundleid=@bundleid and userid=u.userid AND param='vegas2.progress'),
TotalLessons=100,
TotalNumAvail=100,
TotalNumCorrect=(SELECT Value FROM scormtrackings WHERE 
bundleid=@bundleid AND userid=u.userid AND param='cmi.score.raw') 
```

这只是我的 ASP.NET 使用的大型选择语句的一部分，`Repeater`当值为 时会不断崩溃`NULL`，我已经尝试过`ISNULL()`，但要么它不起作用，要么我做错了。

```
ISNULL((SELECT max(modifydate) FROM scormtrackings WHERE 
bundleid=@bundleid AND userid=u.userid),'') AS LastAccessed, 
```

*(...)*

？？？

更新：我已经尝试了所有这些方法，返回 '', 0, 1，而不是返回 null 的值，但它仍然不起作用，我想知道问题是否出在`Repeater`?

### 相关问题：

> [为什么我的中继器总是在 Eval(NULL) 值上崩溃？](https://stackoverflow.com/questions/584570/why-does-my-repeater-keep-crashing-on-evalnull-values)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-25T04:15:30.120

您可以使用[COALESCE](http://msdn.microsoft.com/en-us/library/ms190349.aspx)函数来避免出现空值。基本上它返回列表中的第一个非空值。

```
SELECT COALESCE(dateField, '') FROM Some_Table 
```

这是一个 ANSI 标准，尽管我注意到它在 Access SQL 中不可用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T04:13:41.887

您可以使用案例：

```
CASE WHEN MyField IS Null THEN ''
ELSE MyField
End As MyField 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T04:24:24.200

```
select max(isnull(modifydate, "default date") from scormtrackings where... 
```

只要至少有一行满足 where 子句就可以工作，否则你仍然会得到 NULL

```
select IsNull( max(modifydate), "default_date") from scormtrackings where ... 
```

应该在所有情况下都有效

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T04:04:55.387

```
select max(isnull(Date,"default date")) ..... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T05:23:28.070

这也有效......讨厌承认我使用它的频率！

声明@LastAccessed varchar(30)

从 scormtrackings 中选择 @LastAccessed = max(modifydate)

设置@LastAccessed = isnull(@LastAccessed,'')

选择 @LastAccessed 作为 LastAccessed

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-03-23T13:23:46.753

您可以使用`NVL`.

`NVL(<possible null value>,<value to return when arg1 is null>)`

# php - 如何让 PDO 在我每次连接时运行 SET NAMES utf8，在 ZendFramework 中

> ID：584676
> 
> 赞同：40
> 
> 时间：2009-02-25T04:03:31.520
> 
> 标签：php, zend-framework, pdo, zend-db-table

如何让 PDO 适配器在我每次连接时运行 SET NAMES utf8，在 ZendFramework 中。我正在使用 INI 文件来保存适配器配置数据。我应该在那里添加哪些条目？

如果不清楚，我正在我的项目的 config.ini 文件中而不是在 php 代码中寻找正确的语法，因为我认为这部分配置代码。

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2009-02-25T07:00:56.650

害怕我的[google-fu](http://www.google.nl/search?rlz=1C1GGLS_nlNL291NL303&sourceid=chrome&ie=UTF-8&q=php+pdo+mysql+set+names+utf+8+connect)

```
$pdo = new PDO(
    'mysql:host=mysql.example.com;dbname=example_db',
    "username",
    "password",
    array(PDO::MYSQL_ATTR_INIT_COMMAND => "SET NAMES utf8")); 
```

第一击;)

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-03-31T20:11:09.367

伊泰，

一个非常好的问题。幸运的是，答案很简单：

```
database.params.driver_options.1002 = "SET NAMES utf8" 
```

1002 是常量 PDO::MYSQL_ATTR_INIT_COMMAND 的值

您不能在 config.ini 中使用常量

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-09-07T12:19:03.507

只需将其放入您的配置中

```
database.params.charset = "utf8" 
```

`resources.db.params.charset = utf8` 或者在 ZF 1.11 之后这会起作用

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-29T06:41:48.873

zend_db 中的连接是惰性的，这意味着它在第一个查询时连接。如果您有一个没有查询的静态页面，它甚至永远不会连接 - 即使它在您的引导文件中初始化。

如此运行：

> ```
> $db->query("SET NAMES 'utf8'"); 
> ```

不是那么聪明。非常感谢 dcaunt 的解决方案。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-12-03T18:42:37.097

所有这些方法都*应该*有效，除非在某些特殊情况下。例如，如果您在 php < 5.3.1 的 windows 机器上本地运行 web 服务器，则只有一个 'manual' $db->query("SET NAMES 'utf8'"); 在您的实际查询起作用之前。尝试使用 MYSQL_ATTR_INIT_COMMAND 的任何其他方法都将失败。

这是我今天学到的东西，正在努力解决这个问题：

1.  您不能在某些环境中引用 PDO::MYSQL_ATTR_INIT_COMMAND （​​即我的，具体我不知道）。您必须明确使用 1002

2.  使用 Zend Framework 1.11（可能从 1.8 开始，有待确认），您不需要在 config.ini 中设置 database.params.driver_options.1002 = "SET NAMES utf8" ：resources.db.params.charset = "utf8 " 足以让 Zend_Db_Adapter_Pdo_Mysql 为你做这件事。

3.  在 Windows 上，您需要 php >= 5.3.1 才能使 MYSQL_ATTR_INIT_COMMAND 工作。

4.  如果你用 5.3.1 或更高版本替换你的 php 版本（我也测试了 5.3.3），你需要确保在你的 php.ini 中为 pdo_mysql.default_socket 设置了一个值。默认的空值不起作用（有待确认：我读过一些关于此的内容，但在发现第 5 点后没有费心尝试没有它）

5.  您还需要确保您的 windows\system32\drivers\etc\hosts 隐藏系统文件中有“127.0.0.1 localhost”（这对 php 5.3.0 来说不是问题）

考虑到这一切，您应该可以节省一天的谷歌搜索时间并保留一些头发！;)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-04-26T07:50:46.403

您只需在开始查询之前执行此命令，您只需在查询之前执行一次，而不是每次查询。

```
$pdo->query("SET NAMES 'utf8'"); 
```

完整示例

```
$servername = "localhost";
$username = "root";
$password = "test";
$dbname = "yourDB";

try {
    $pdo = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);

    $pdo->query("SET NAMES 'utf8'");

    //set the PDO error mode to exception
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

    $sql = "SELECT name FROM nations";
    foreach ($pdo->query($sql) as $row) {
       echo "<option value='".$row['name']."'>".$row['name']."</option>";
    }

} catch(PDOException $e) {
    echo "Error: " . $e->getMessage();
}
$pdo = null; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-06T18:59:26.660

在您的引导文件中...

```
$db = Zend_Db::factory($adapter, $config);
$db->query("SET NAMES 'utf8'"); 
```

然后将此实例保存在注册表中

```
Zend_Registry::set('db', $db); 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2010-09-21T18:20:30.713

```
$table->getAdapter()->query('SET NAMES UTF8'); 
```

# c - 稳定标准库 qsort？

> ID：584683
> 
> 赞同：20
> 
> 时间：2009-02-25T04:06:30.983
> 
> 标签：c, qsort, stable-sort

我假设 stdlib 中良好的旧 qsort 函数不稳定，因为手册页没有说明它。这是我正在谈论的功能：

```
 #include <stdlib.h>
   void qsort(void *base, size_t nmemb, size_t size,
              int(*compar)(const void *, const void *)); 
```

我假设如果我将比较函数更改为也包括我正在比较的地址，它将是稳定的。那是对的吗？

例如：

```
int compareFoos( const void* pA, const void *pB ) {
    Foo *pFooA = (Foo*) pA;
    Foo *pFooB = (Foo*) pB;

    if( pFooA->id < pFooB->id ) {
        return -1;
    } else if( pFooA->id > pFooB->id ) {
        return 1;
    } else if( pA < pB ) {
        return -1;            
    } else if( pB > pA ) {
       return 1;
    } else {
       return 0;
    }
} 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-25T04:16:31.710

不，不幸的是，你不能依赖它。假设您有数组（每条记录中的两个字段用于检查，但只有第一个字段用于排序）：

```
BBBB,1
BBBB,2
AAAA,3 
```

快速排序可以将 BBBB,1 与 AAAA,3 进行比较并交换它们，给出：

```
AAAA,3
BBBB,2
BBBB,1 
```

如果下一步是将 BBBB,2 与 BBBB,1 进行比较，则密钥将相同，并且由于 BBBB,2 的地址小于 BBBB,1，因此不会发生交换。对于稳定的排序，您应该最终得到：

```
AAAA,3
BBBB,1
BBBB,2 
```

唯一的方法是附加指针的*起始*地址（不是它的*当前*地址）并使用它以及其他键进行排序。这样，原始地址成为排序键的次​​要部分，因此无论两行在排序过程中走到哪里，`BBBB,1`最终都会在之前结束。`BBBB,2``BBBB`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-05-24T04:08:47.907

规范的解决方案是制作（即分配内存并填充）一个指向原始数组元素的指针数组，以及`qsort`这个新数组，使用额外的间接级别并在指针指向的东西时回退到比较指针*值*是平等的。这种方法有一个潜在的好处是您根本不修改原始数组 - 但如果您希望原始数组最终排序，则必须对其进行置换以匹配指针数组中的顺序`qsort`返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-22T01:42:15.563

这不起作用，因为在排序过程中，排序会发生变化，两个元素的输出将不一致。为了使老式的 qsort 稳定，我所做的是在我的结构中添加初始索引并在将其传递给 qsort 之前初始化该值。

```
typedef struct __bundle {
    data_t some_data;
    int sort_score;
    size_t init_idx;
} bundle_t;

/*
 .
 .
 .
 .
*/

int bundle_cmp(void *ptr1, void *ptr2) {
    bundle_t *b1, *b2;
    b1 = (budnel_t *) ptr1;
    b2 = (budnel_t *) ptr2;
    if (b1->sort_score < b2->sort_score) {
        return -1;
    }
    if (b1->sort_score > b2->sort_score) {
        return 1;
    }
    if (b1->init_idx < b2->init_idx) {
        return -1;
    }
    if (b1->init_idx > b2->init_idx) {
        return 1;
    }
    return 0;
}

void sort_bundle_arr(bundle_t *b, size_t sz) {
    size_t i;
    for (i = 0; i < sz; i++) {
        b[i]->init_idx = i;
    }
    qsort(b, sz, sizeof(bundle_t), bundle_cmp);
} 
```

# linq - 用于 Linq 查询的 DSL - 寻找想法

> ID：584694
> 
> 赞同：0
> 
> 时间：2009-02-25T04:14:19.000
> 
> 标签：linq, dsl

我目前正在使用一个 CMS，它使用带有自己定制查询语言的 ORM（即使用 select/where/orderby 之类的语句）。我将这种迷你语言称为 DSL，但我可能用错了术语。

我们正在为此 CMS 编写控件，但我不希望将控件耦合到 CMS，因为我们对是否要长期继续使用此 CMS 有一些疑问。

通过使用我们自己的 DAL/抽象层或其他什么，我们可以很容易地将我们的控件与 CMS 分离。

然后我记得在大多数 CMS 控件上，它们提供了一个属性（设计时可编辑），用户可以在其中键入查询来控制数据源中填充的内容。不错的功能 - 问题是我如何抽象这个功能？

然后我想到可能存在一个 DSL 框架，它可以为我提供一种简单的查询语言，可以在运行时转换为 LINQ 表达式。从而使我与 CMS 的查询 DSL 脱钩。

这样的事情存在吗？我在浪费时间吗？（可能是后者）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T19:55:32.857

这不会完全回答您的问题，但是 LINQ 有一个扩展，允许您将 LINQ 查询的谓词指定为称为[Dynamic LINQ](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)的字符串，因此如果您想以某种基于字符串的格式存储条件，您可以可能在此基础上构建您的语言。您仍然需要找到一种方法来表示不同的子句（where/orderby/etc.），但是对于作为参数传递给这些子句的谓词，您可以使用动态 LINQ。

请注意，动态 LINQ 允许您解析字符串，但 AFAIK 没有任何方法可以将现有的表达式树转换为该字符串......因此需要做一些工作。

（但我不确定我是否完全理解这个问题，所以也许我完全是:-)）

# java - 在树中查找子树的简单方法

> ID：584696
> 
> 赞同：6
> 
> 时间：2009-02-25T04:14:28.920
> 
> 标签：java, algorithm, tree

我正在编写一些使用树的代码（可以有无限数量的节点但没有交叉的常规树，即两个父节点不会指向同一个子节点）。总之，有两点：

1）是否有任何众所周知的算法可以在树中找到子树。

2）是否有任何Java库（或任何库）已经实现了这个算法？即使没有，任何人都可以推荐任何好的通用 Java 树库吗？

我想使用这些树来保存树格式的数据，而不是它们的搜索功能。

扩展一点：我将树用作游戏的一部分，以记录特定事件发生时所发生的情况。例如，一个 A 可以击中一个 B，该 B 可以击中两个 A，而该 B 可以击中另外两个 A，等等。

这看起来像：

```
 A
    |
    B
   /
  A 
 / \  
A   A
   / \
  A   A 
```

当然，不仅仅是 A 和 B。我想要做的是（对于成就系统）能够判断什么时候，比如说一个 A 达到了两个 A：

```
 A
 / \
A   A 
```

我希望能够轻松知道第一棵树是否包含该子树。如果我不需要的话，我不想写所有的代码来这样做:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T10:47:01.990

看起来很简单的算法：在博弈树中找到搜索树的根，并检查搜索树的子节点是否是博弈树中子节点的子集。

根据您的解释，我不确定搜索树是否

```
 A
 / \
A   A 
```

应该匹配这棵树：

```
 A
 /|\
A C A 
```

（即如果不匹配的孩子应该被忽略。）

无论如何，这是我刚刚玩弄的代码。这是一个完全运行的示例，并带有一个 main 方法和一个简单的`Node`类。随意玩它：

```
import java.util.Vector;

public class PartialTreeMatch {
    public static void main(String[] args) {
        Node testTree = createTestTree();
        Node searchTree = createSearchTree();

        System.out.println(testTree);
        System.out.println(searchTree);

        partialMatch(testTree, searchTree);
    }

    private static boolean partialMatch(Node tree, Node searchTree) {
        Node subTree = findSubTreeInTree(tree, searchTree);
        if (subTree != null) {
            System.out.println("Found: " + subTree);
            return true;
        }
        return false;
    }

    private static Node findSubTreeInTree(Node tree, Node node) {
        if (tree.value == node.value) {
            if (matchChildren(tree, node)) {
                return tree;
            }
        }

        Node result = null;
        for (Node child : tree.children) {
            result = findSubTreeInTree(child, node);

            if (result != null) {
                if (matchChildren(tree, result)) {
                    return result;
                }
            }
        }

        return result;
    }

    private static boolean matchChildren(Node tree, Node searchTree) {
        if (tree.value != searchTree.value) {
            return false;
        }

        if (tree.children.size() < searchTree.children.size()) {
            return false;
        }

        boolean result = true;
        int treeChildrenIndex = 0;

        for (int searchChildrenIndex = 0;
                 searchChildrenIndex < searchTree.children.size();
                 searchChildrenIndex++) {

            // Skip non-matching children in the tree.
            while (treeChildrenIndex < tree.children.size()
                  && !(result = matchChildren(tree.children.get(treeChildrenIndex),
                                              searchTree.children.get(searchChildrenIndex)))) {
                treeChildrenIndex++;
            }

            if (!result) {
                return result;
            }
        }

        return result;
    }

    private static Node createTestTree() {
        Node subTree1 = new Node('A');
        subTree1.children.add(new Node('A'));
        subTree1.children.add(new Node('A'));

        Node subTree2 = new Node('A');
        subTree2.children.add(new Node('A'));
        subTree2.children.add(new Node('C'));
        subTree2.children.add(subTree1);

        Node subTree3 = new Node('B');
        subTree3.children.add(subTree2);

        Node root = new Node('A');
        root.children.add(subTree3);

        return root;
    }

    private static Node createSearchTree() {
        Node root = new Node('A');
        root.children.add(new Node('A'));
        root.children.add(new Node('A'));

        return root;
    }
}

class Node {
    char value;
    Vector<Node> children;

    public Node(char val) {
        value = val;
        children = new Vector<Node>();
    }

    public String toString() {
        StringBuilder sb = new StringBuilder();

        sb.append('(');
        sb.append(value);

        for (Node child : children) {
            sb.append(' ');
            sb.append(child.toString());
        }

        sb.append(')');

        return sb.toString();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T04:23:52.237

您是否正在寻找对子树的任何特定约束？如果不是，一个[简单的遍历](http://en.wikipedia.org/wiki/Tree_traversal)应该足以识别子树（基本上将每个节点视为子树的根）。

我相信你会发现你想要的树的 API 会因你的特定应用程序而变化很大——以至于通用实现并不是很有用。也许如果你能告诉我们这棵树将用于什么样的应用程序，我们可以提供细节。

此外，如果您*只是*使用树来存储数据，您可能想问自己为什么需要树。这个答案也应该回答我上一段中的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T05:22:52.533

我想知道 Knuth 算法的扩展是否比简单的遍历更有效......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-11T16:54:50.307

如果有一个大的静态树，并且您将在同一棵大树中搜索许多子树，您可能希望使用其所有子树的哈希集注释每个节点到给定深度，具体取决于您的存储量'愿意花费在那个功能上。然后构建一个从哈希值到节点集的映射，这些节点是具有该哈希值的子树的根节点。然后只需检查每一个，可能比遍历便宜得多，查询树的根的哈希到相同的深度。

# c - 来自 sk_buff 的 IP 地址

> ID：584713
> 
> 赞同：12
> 
> 时间：2009-02-25T04:27:00.530
> 
> 标签：c, linux-kernel, netfilter

我正在编写一个注册 netfilter 钩子的内核模块。我正在尝试通过使用`sk_buff->saddr`成员来获取调用者的 IP 地址。有没有办法以人类可读的 iexxxx 格式获取 IP？

我找到了这个函数`inet_ntop()`，但它似乎在内核头文件中不可用。如何将 \xC0\xA8\x00\x01 转换为 192.168.0.1 ？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-16T11:52:56.117

您应该使用 printk() 提供的 %pI4 扩展格式说明符：

```
printk(KERN_DEBUG "IP addres = %pI4\n", &local_ip); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-02T15:28:27.093

include/linux/kernel.h 中定义了两个宏

NIPQUAD 用于 ipv4 地址， NIP6 用于 ipv6 地址。

```
#define NIPQUAD(addr) \
    ((unsigned char *)&addr)[0], \
    ((unsigned char *)&addr)[1], \
    ((unsigned char *)&addr)[2], \
    ((unsigned char *)&addr)[3]

#define NIP6(addr) \
    ntohs((addr).s6_addr16[0]), \
    ntohs((addr).s6_addr16[1]), \
    ntohs((addr).s6_addr16[2]), \
    ntohs((addr).s6_addr16[3]), \
    ntohs((addr).s6_addr16[4]), \
    ntohs((addr).s6_addr16[5]), \
    ntohs((addr).s6_addr16[6]), \
    ntohs((addr).s6_addr16[7]) 
```

内核源代码中有大量示例利用这些示例以人类可读的格式打印 IP 地址。例如：

```
printk(KERN_DEBUG "Received packet from source address: %d.%d.%d.%d!\n",NIPQUAD(iph->saddr)); 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-06-12T16:23:24.100

printk 可以直接处理这个：

IPv4 地址：

```
%pI4    1.2.3.4
%pi4    001.002.003.004
%p[Ii]4[hnbl]

For printing IPv4 dot-separated decimal addresses. The 'I4' and 'i4'
specifiers result in a printed address with ('i4') or without ('I4')
leading zeros.

The additional 'h', 'n', 'b', and 'l' specifiers are used to specify
host, network, big or little endian order addresses respectively. Where
no specifier is provided the default network/big endian order is used.

Passed by reference. 
```

IPv6 地址：

```
%pI6    0001:0002:0003:0004:0005:0006:0007:0008
%pi6    00010002000300040005000600070008
%pI6c   1:2:3:4:5:6:7:8

For printing IPv6 network-order 16-bit hex addresses. The 'I6' and 'i6'
specifiers result in a printed address with ('I6') or without ('i6')
colon-separators. Leading zeros are always used.

The additional 'c' specifier can be used with the 'I' specifier to
print a compressed IPv6 address as described by
http://tools.ietf.org/html/rfc5952

Passed by reference. 
```

参考：[https ://www.kernel.org/doc/Documentation/printk-formats.txt](https://www.kernel.org/doc/Documentation/printk-formats.txt)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T05:07:48.730

简单的。“xxxx”格式的 IP 地址被称为点分四线是有原因的。每个数字代表一个字节，地址中总共有 4 个字节。

因此，使用 4 字节地址，您只需打印每个字节的十进制值。

快速而肮脏的示例（将 printf 替换为您选择的输出函数）：

```
unsigned char *addr = (unsigned char*)sk_buff->addr;
printf("%d.%d.%d.%d", addr[0], addr[1], addr[2], addr[3]); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T05:06:53.693

您可以使用[strtol](http://www.cplusplus.com/reference/clibrary/cstdlib/strtol.html)将每个部分转换为整数形式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T04:11:22.267

```
/* Convinience union to __be32 to ip address  */
union ip_address {
    u8 a[4];
    __be32 saddr;
}; 
```

IP地址可以得到a[0].a[1].a[2].a[3]

# c - 有 C 的解释器吗？

> ID：584714
> 
> 赞同：111
> 
> 时间：2009-02-25T04:27:08.407
> 
> 标签：c, interpreter, read-eval-print-loop

我想知道是否有类似 C 的解释器。也就是说，在 Linux 终端中，我可以输入“python”，然后在该解释器中编码。（我不确定解释正确的词）。这对于测试不同的东西真的很有帮助，我很好奇 C 是否存在类似的东西。尽管我对此表示怀疑。我唯一能想到的就是C shell ...

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-02-25T04:31:05.590

[有很多](http://www.google.com/search?q=c%20interpreter)- 如果您缩小问题的范围，我们可能会根据您的需求提出一些具体的建议。

一个著名的解释器是Dobbs 博士详细介绍的“ [Ch: AC/C++ Interpreter for Script Computing ”：](http://www.ddj.com/cpp/184402054)

> Ch 是一个完整的 C 解释器，它支持 ISO C90 标准的所有语言特性和标准库，但在 C 中扩展了许多高级特性，例如字符串类型和计算数组作为一流的对象。

[Ch 标准是免费软件](http://www.softintegration.com/products/chstandard/)，但不是开源的。只有 Ch 专业版具有绘图功能和其他人可能想要的功能。

我以前从未看过这个，但是手头有 ac 解释器听起来非常有用，而且我可能会添加到我的工具集中。感谢您的提问！

* * *

编辑：

刚刚发现我最喜欢的编译器之一[TCC](http://bellard.org/tcc/)将执行 C 脚本：

> 它还处理 C 脚本文件（只需将 shebang 行“#!/usr/local/bin/tcc -run”添加到 Linux 上 C 源代码文件的第一行即可直接执行。
> 
> 当使用“-”代替“infile”时，TCC 可以从标准输入读取 C 源代码。例子：
> 
> ```
> echo 'main(){puts("hello");}' | tcc -run - 
> ```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-04-06T14:53:40.870

[picoc](http://code.google.com/p/picoc/) - 一个非常小的 C 解释器

> PicoC 是一个非常小的 C 脚本解释器。它最初是作为无人机机载飞行系统的脚本语言编写的。它也非常适合其他机器人、嵌入式和非嵌入式应用。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-25T05:31:13.557

ROOT 项目提供了一个非常实用的 C 和 C++ 解释器，称为[Cint](http://root.cern.ch/drupal/content/cint)。我非常喜欢它。不过，这需要一点时间来适应解释。

TCC 也是一个很好的选择，但我无法保证它的 REPL

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-25T04:29:57.730

大概。C++ 有几个。请参阅[您是否使用过任何 C++ 解释器（不是编译器）？](https://stackoverflow.com/questions/69539/have-you-used-any-of-the-c-interpreters-not-compilers/72792#72792)举些例子。当然[cint](http://root.cern.ch/root/CintInterpreter.html)几乎可以吃掉任何具有良好结果的 c 代码，而且[tcc](http://bellard.org/tcc/)非常快，您可以像使用解释器一样使用它。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-25T04:32:14.603

看看[Ch Interpreter](http://en.wikipedia.org/wiki/Ch_interpreter)。

> Ch 是一个可嵌入的 C/C++ 解释器，用于跨平台脚本、shell 编程、2D/3D 绘图、数值计算和嵌入式脚本。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-14T18:06:52.380

我知道我们在课堂上使用 CINT。看起来不错，您可能想尝试一下！

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-10-12T12:09:59.813

查看[iGCC](http://www.artificialworlds.net/wiki/IGCC/IGCC)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-25T04:29:35.703

`cinterp`是一个开始。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-09-07T06:48:13.317

**[ccons](https://github.com/asvitkine/ccons)**似乎满足您的约束：

> ccons 项目的目标是为 C 编程语言创建一个交互式控制台，分别类似于 Python 和 Ruby 的“python”和“irb”。该项目建立在 clang 和 llvm 之上。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-01-31T14:22:55.880

您可以使用 CompCert。以下是一些示例：[http ://compcert.inria.fr/man/manual004.html](http://compcert.inria.fr/man/manual004.html)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-07-27T06:56:01.253

最近有 Cling（基于 LLVM/Clang）

[http://root.cern.ch/drupal/content/cling](http://root.cern.ch/drupal/content/cling)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-25T04:32:00.627

它已经完成，尽管绝大多数 C 工作都已编译。一个例子是[CH](http://en.wikipedia.org/wiki/Ch_interpreter)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-05-02T13:51:20.880

CERN 有一个名为 ROOT 的工具包，主要用于科学或数据分析等目的，但它有一个基于 Clang 的 C/C++ 解释器，名为`Cling`.

他们在适应之前使用了一个名为**CINT**`Cling`的 C 解释器。CINT 是轻量级的，似乎仍然可以下载。

我认为您可以通过仔细搜索维基百科列表文章来获得其他信息。

# api - 如何从容地暴露相关父子资源？

> ID：584721
> 
> 赞同：3
> 
> 时间：2009-02-25T04:31:48.753
> 
> 标签：api, rest

我正在设计一个 api，我希望允许用户和组保存搜索，但不确定如何最好地公开这些信息。我想出了一些 URI 来公开它们：

```
# These are for CRUD the search definitions, not running the searches
1\. /users/{username}/searches # lists the searches for a user
2\. /users/{username}/searches/{search-name} # CRUD a specific user search
3\. /groups/{groupname}/searches # lists the searches for a group
4\. /groups/{groupname}/searches/{search-name} # CRUD a specific group search
5\. /searches/{search-id|search-name}
6\. /searches/group/{groupname}/{search-name}
7\. /searches/user/{username}/{search-name} 
```

我不认为公开*所有*这些 URI 是正确的。这意味着有两种方法可以更新或列出对用户和组的搜索：通过 /groups/search 或通过 /search/group。这也意味着更多的支持，我担心会产生细微的差异。

搜索*可以*是数据库中的独立记录，并且不依赖于特定用户或组（例如，默认系统搜索或上下文相关搜索）。

因为搜索可以是独立的，所以将它们公开为`/users/searches`和感觉是错误的`/groups/searches`。同时，如果我在想，“鲍勃的搜索是什么？” 我首先会想到`/users/bob/searches`因为，从逻辑上讲，它是*鲍勃的*搜索。同样，如果我想备份 bob 的帐户，他的所有个人信息都应该在 /users/bob 下。

那么，有没有人建议哪种方式更适合他们，和/或对他们来说效果很好（或很差）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T14:09:07.603

我倾向于坚持

```
5\. /searches/{search-id|search-name}
6\. /searches/group/{groupname}/{search-name}
7\. /searches/user/{username}/{search-name} 
```

备份问题可以通过创建一个包含整个系统中 Bob 信息链接的新资源来解决，例如

```
GET /AccountData/Bob

<div class="AccountData">
   <link rel="searches" href="/Searches/User/Bob"/>
   <link rel="options" href="/Options/User/Bob"/>
   <link rel="usagehistory" href="/History/User/Bob"/>
</div> 
```

我的经验是，如果您尝试创建一个满足您所有使用场景的单一层次结构，您将把自己逼疯。你就是做不到。这就是 Wiki 运行良好的原因，它们使用链接而不是层次结构来提供对信息的访问。

我建议您更多地关注将在表示中返回的链接。

例如

```
GET /Groups/{GroupName}

<div class="group">
  <div class="name">AGroup</div>
  <link rel="searches" href="/Searches/Group/AGroup"/>
</div> 
```

使用这种方法，您不太关心 URL 结构的外观。正如罗伊[在这里所说](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)

> REST API 不得定义固定的资源名称或层次结构（客户端和服务器的明显耦合）

我意识到这似乎是一个极端的立场，考虑到 SO 上的每个人似乎都在关注你的 url 需要什么样的外观才能拥有一个 RESTful API，但你思考得越多，它就越有意义。

PS 请不要纠结于我选择 HTML 作为表示的媒体类型，我只是提请注意您并不总是需要使用自定义 XML 词汇表这一事实。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T05:52:41.853

我倾向于将查询类型划分为查询类型（例如，一种查询类型是“列表搜索”查询。然后我会提出论据。例如 /searchlist?user=john。除非您尝试制作这些东西被机器人和搜索引擎索引，应该可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-04T15:12:37.203

搜索是功能而不是资源，因此您不必在资源中使用它 URI 可能在参数中，例如

```
/users/{username}?q={query string}
/groups/{groupname}?q={query string} 
```

那么对于这个查询字符串，你有 2 个选项

```
 "RQL" (Resource Query Language) 
```

或者

```
"FIQL" (Feed Item Query Language) 
```

# forms - 1\. 我填写表格并点击提交。2\. 我得到结果页面。目标：无需再次填写表格即可获得相同的结果

> ID：584733
> 
> 赞同：0
> 
> 时间：2009-02-25T04:47:21.993
> 
> 标签：forms, webforms, form-submit, capture

这是我第一次发帖——我非常感谢关于这个主题的任何和所有指导。

背景：我正在建立一个房地产网站。我想使用我当地 MLS 委员会提供的免费 IDX 数据。MLS 板不允许我选择显示预定义搜索，并且只为我提供搜索字段的链接。填写搜索字段后，我可以查看结果。

目标：我想绕过这一步，将结果页面框入我正在构建的支持 HTML 的 GoDaddy 网站。

这是搜索页面的链接：http: [//fgcmls.rapmls.com/scripts/mgrqispi.dll?APPNAME=Fortmyers &PRGNAME=MLSLogin&ARGUMENT=vBSJvLQtMcbg7F0O0KnXDiggv%2F12B0S6Ss9wv4510QA%3D&KeyRid=1](http://fgcmls.rapmls.com/scripts/mgrqispi.dll?APPNAME=Fortmyers&PRGNAME=MLSLogin&ARGUMENT=vBSJvLQtMcbg7F0O0KnXDiggv%2F12B0S6Ss9wv4510QA%3D&KeyRid=1)

我试图只显示出现在我附近的列表。选项包括： 1\. 物业类型 - 住宅 2\. GEO 区域 - FM11 3\. 开发项目：Fiddlesticks Country Club

一旦输入了这个标准，我就有了使这个项目工作所需的页面。

感谢大家抽出宝贵时间阅读本文，感谢您花时间帮助我。

此致，

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T04:55:24.423

在不查看页面本身的情况下，它可能正在执行“POST”操作以将表单提供给网站。您应该能够使用 javascript（可能是 jquery 或其他一些 ajax 框架）在框架中为您执行此操作并让它显示结果。

-亚当

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T05:06:42.400

我看了一下页面 HTML，表单帖子是这样定义的：

```
<FORM action="/scripts/mgrqispi.dll" method="POST" name="InputForm" /> 
```

您*可以*创建自己定义的表单，如下所示：

```
<FORM action="http://fgcmls.rapmls.com/scripts/mgrqispi.dll" method="POST" name="InputForm">

</FORM> 
```

您必须通过您提供的页面上的 HTML 来获取您感兴趣的表单元素的适当 ID 和名称。他们的处理页面可能会检查以确保其提交给它的表单，在这种情况下，行不通。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T05:32:11.700

只要这是一个 POST 表单并且他们没有做很多严格的推荐人检查，以下应该可以工作：

在您自己的网站上复制表格。

进行一些小的更改以自动化一些字段，以更好地为您的地理区域/公司服务。

确保所有内容都是完整路径，而不是相对于处理查询的服务器。

您可能最终会将许多文本/选择字段更改为具有预设值的隐藏字段，以使最终用户保持简单。处理请求的服务器不知道它来自哪个字段，只知道值和名称。

# c++ - Gui 工具包，我应该使用哪个？

> ID：584734
> 
> 赞同：20
> 
> 时间：2009-02-25T04:47:32.150
> 
> 标签：c++, user-interface, qt, wxwidgets

我正在编写一个相当大且复杂的数据分析程序，并且我认为是时候为该程序构建一个 GUI。所以我的问题是：

我应该使用哪个 GUI 工具包？

我对编码和构建 GUI 完全陌生，希望能提供任何指导。它不一定是世界上最简单的工具包，我学得很快。但是，它确实需要能够执行以下操作（如果不是全部，对于任何给定的工具包来说，其中一些可能是非常基本的，但我认为最好将所有这些都扔掉以防万一）。

它必须允许我直接在屏幕上绘制，以便我可以放置图表（实际上是光谱）、绘图和类似的东西供用户查看。我需要能够收集他们点击上述光谱的位置信息。我需要能够显示文本并从用户那里获取文本输入。它需要能够生成菜单（您知道文件、编辑等）。如果它有一些用于生成表格的内置小部件会很方便（尽管如果我可以直接在屏幕上绘制，我可以克服它的不足）。它需要能够弹出警告、对话框、保存和打开框等。差不多就是这样，当我把它们写出来时，它们中的大部分看起来都很基本，但我不想让 GUI 部分编码和然后意识到我需要用不同的工具包重写它。

应该注意的是，我已经用 C++ 编写了这个程序，并且我不想用 C 或其他东西编写 GUI 部分，因此工具包需要支持 C++。

此外，跨平台工具包比单一平台工具包更可取。但是，如果它必须是一个单一平台工具包，那么我更喜欢它用于 Linux。

最后，我会非常喜欢开源工具包而不是闭源工具包。

除此之外，我想不出有什么要补充的。提前感谢您的时间和回答。

嗯，基于答案，我将同时查看 Qt 和 wxWidgets，看看哪个更吸引我。我可以接受多个答案，但我不能，因为我正在研究两件事，所以只接受一个答案是不公平的，也许在一两个星期后，我查看了工具包并想通了我想用的。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-25T04:53:56.127

对于 C++，在我看来，Qt 是最不令人沮丧且功能最全的工具包。它也是完全跨平台的。请注意，Qt 将在 2009 年 3 月的某个时间获得 LGPL 许可，届时 4.5 版将可用。目前，它仅提供 GPL 和商业许可版本。

Qt 的 GUI 设计器很好。它有很多实用功能（场景图库、翻译支持、内置 Javascript 引擎、内置 WebKit 库）。通过 MOC（一种特殊的预编译器），它还为 C++ 带来了一些运行时绑定功能和自省功能。

对于您的技术应用，您可能会发现 Qwt ( [http://qwt.sourceforge.net/](http://qwt.sf.net) ) 提供了您所需要的。它建立在 Qt 之上。

如果您想要在没有 GUI 的情况下支持实用程序（例如网络等），Qt 甚至可以“无头”使用。

另一个跨平台的 C++ 选项是 wxWidgets，它可以使用，但与 Qt 并没有真正的可比性。它是一个级别低得多的工具包，并且不那么容易使用或完全圆润。Gtkmm 是另一个选项，本着 GTK+ 的精神。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-25T05:00:05.177

试试 WxWidgets。跨平台（在 Linux、Mac OS X 和 Windows 上编译）并被广泛接受。

[http://www.wxwidgets.org/](http://www.wxwidgets.org/)

也开源！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-25T08:34:01.590

我看到没有人评论[GTKmm](http://gtkmm.org)。它是 GTK+ 的 C++ 化身，使用起来非常愉快。我也使用过 Qt，但我不喜欢凌乱的信号/连接代码、moc_XXX 生成的文件等。GTKmm 有信号等，但没有那个预处理步骤，以及几乎所有 Qt 工具包都可以提供图形领域。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-25T05:04:29.940

我想说这取决于您是否想要针对您的应用程序的操作系统的本机外观。Qt，如前所述，可能是最容易使用的跨平台工具包，但它是它自己的小部件集。除非您碰巧在 KDE 上运行，否则您不会获得原生应用程序的外观和感觉。

我在工作中使用 wxWidgets。有时它可能会令人沮丧，并且在某些地方不是很精致，但它确实为您所针对的平台提供了原生外观和感觉。它实际上包装了原生 UI 控件，以便在 wxWidgets 移植到的所有平台上为它们提供一个通用 API。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-25T10:46:32.363

我有同样的问题，并搜索了好的 GUI 工具包。

最后我发现，一个 GUI 工具包是不够的——我需要一个完整的平台独立解决方案，为我提供构建环境、IDE 集成和网络套接字和文件 I/O 等较低级别的功能。

我的结果？自从我使用 Qt 近 9 年以来（但最初几年只用于 GUI 的东西） - 现在我拥有高度复杂的网络应用程序，具有负载平衡、大规模多线程和图像处理。

您可以将 Qt 用作具有专业支持的商业用户（如我），或者只是在 GPL 和 4.5 与 LGPL（允许商业使用）下开始您自己的项目。

wxWidgets 和 GTK++ 等其他替代方案对于 GUI 编程来说是非常好的选择。

但是，如果您想要一个有据可查且完整的解决方案，那么 Qt 是您的选择。

最好的问候， 3DH

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-25T06:11:28.017

我还推荐[wxWidgets](http://www.wxwidgets.org)和[DialogBlocks](http://www.dialogblocks.com/)，这是一个非常好的可视化 GUI 构建器。

我会说 wxWidgets 有一些粗糙的边缘，但是开发社区非常活跃并且对错误报告/问题/贡献非常敏感。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-25T04:54:04.240

[qt](http://qt.nokia.com/)。您也可以使用基于 Qt 构建的[KDE 。](http://www.kde.org)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-12-09T07:03:19.057

我使用`wxWidgets`（工具包）+ `wxFormBuilder`（gui-designer）+ `eclipse`（ide）。所有工具都是跨平台且免费的。

# javascript - 是否可以仅在顶部元素上使用 jQuery.click 触发器？

> ID：584738
> 
> 赞同：9
> 
> 时间：2009-02-25T04:52:03.590
> 
> 标签：javascript, jquery

我正在尝试创建一个用户可以单击任何元素来编辑它的 CSS 的网站。我使用以下内容将点击功能添加到所有`<li>`,`<div>`和`<ul>`.

```
$('li,div,ul').click(function () {
    alert(this.id);
}); 
```

问题是，如果我单击一个`<li>`元素，那么我会收到该元素及其下方的任何元素的警报。（所有容器）。

单击时是否可以仅触发顶部元素？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-25T04:54:37.547

你想停止事件传播，你可以在 jQuery 中通过调用事件对象的[stopPropagation方法来做到这一点。](http://docs.jquery.com/Events/jQuery.Event#event.stopPropagation.28.29)

```
$('li,div,ul').click(function (e) {  
    e.stopPropagation();
    alert(this.id); 
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T04:55:15.970

我相信你会想使用 stopPropagation(); 在点击功能内。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T04:56:17.493

在我看来，您正在寻找[.stopPropagation()](http://docs.jquery.com/Events/jQuery.Event#event.stopPropagation.28.29)。调用 stopPropagation 将阻止事件“冒泡”到父容器。

# java - 如何在 EclipseLink 中配置查询缓存

> ID：584742
> 
> 赞同：8
> 
> 时间：2009-02-25T04:53:52.337
> 
> 标签：java, jpa, jakarta-ee, ejb-3.0, eclipselink

我有一组状态，我想在应用程序的生命周期内缓存它们，最好是在第一次调用它之后。我使用 EclipseLink 作为我的持久性提供程序。在我的 EJB3 实体中，我有以下代码：

```
@Cache
@NamedQueries({
    @NamedQuery(
        name = "State.findAll",
        query = "SELECT s FROM State s",
        hints = {
                @QueryHint(name=QueryHints.CACHE_USAGE, value=CacheUsage.CheckCacheThenDatabase),
                @QueryHint(name=QueryHints.READ_ONLY, value=HintValues.TRUE)
            }
    )
}) 
```

不过，这似乎没有任何作用，如果我监控到 MySQL 的 SQL 查询，它仍然会在每次我的会话 Bean 使用这个 NamedQuery 时进行选择。

配置此查询的正确方法是什么，以便它只从数据库中读取一次，最好是在所有会话中读取？

编辑：我这样调用查询：

```
Query query = em.createNamedQuery("State.findAll");
List<State> states = query.getResultList(); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-07-26T15:01:05.260

此处发布的解决方案对我不起作用。但我已经使它与：

```
@Cache
@NamedQueries({@NamedQuery(
      name = "State.findAll",
      query = "SELECT s FROM State s", 
      hints = {
          @QueryHint(name = QueryHints.QUERY_RESULTS_CACHE, value = HintValues.TRUE)
      }
    )}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T05:41:38.697

这里只是一个猜测，但你可以试试

```
query.cacheQueryResults(); 
```

在您创建它之后但在您之前`getResultList`。

——马库斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T09:24:40.907

通过添加查询提示，我得到了 EclipseLink 1.0.1 缓存：

```
Query query = em.createNamedQuery("Person.find");
query.setParameter("NAME", name);      
query.setHint("eclipselink.cache-usage", "CheckCacheThenDatabase");
return (Person)query.getSingleResult(); 
```

我根本没有更改实体，也没有尝试使用注释配置缓存。

# asp.net - ASP.NET 中的回发问题

> ID：584747
> 
> 赞同：2
> 
> 时间：2009-02-25T04:54:54.533
> 
> 标签：asp.net, postback

我有一个 asp.net 标签控件，其 Visible 属性设置为 false。在代码隐藏中，我根据用户是否登录将其可见性设置为真/假。一个奇怪的行为是，在回发时，代码隐藏执行并将标签的可见性值设置为任何值，然后标记执行并将标签的可见性设置为 false。在非回发请求上，由代码隐藏设置的状态*不会*被覆盖。原谅我的无知，但我错过了一些重要的事情吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T05:08:41.083

了解页面生命周期，以及运行时触发各种页面事件的时间。

[http://msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

另外，我不认为代码是微不足道的。如果编码正确，您将不会遇到此问题。把它放在这里，让我们看看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T05:01:17.577

没有发布代码，所以你可能已经有了这个。

您是否将所有内容都包装在 Page_Load 方法中

```
if(!Page.IsPostback)
{
    // your code here.
} 
```

?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T05:13:00.340

你的标签有 EnableViewState="false" 属性吗？

[在http://www.w3schools.com/ASPNET/aspnet_viewstate.asp](http://www.w3schools.com/ASPNET/aspnet_viewstate.asp)了解有关此属性的更多信息

# javascript - 将 HTML 插入 div

> ID：584751
> 
> 赞同：133
> 
> 时间：2009-02-25T04:57:12.063
> 
> 标签：javascript

我正在尝试将一大块 HTML 插入到 div 中。我想看看纯 JavaScript 方式是否比使用 jQuery 更快。不幸的是，我忘记了如何以“旧”方式进行操作。:P

```
var test2 = function(){
    var cb = function(html){
        var t1 = document.getElementById("test2");
        var d = document.createElement("div");
        d.id ="oiio";
        d.innerHtml = html;
        t1.appendChild(d);
        console.timeEnd("load data with javascript");
    };
    console.time("load data with javascript");
    $.get("test1.html", cb);
} 
```

我在这里做错了什么？

**编辑**：
有人问哪个更快，jquery 或普通 js，所以我写了一个测试：http:
[//jsperf.com/html-insertion-js-vs-jquery](http://jsperf.com/html-insertion-js-vs-jquery)

普通 js 快 10%

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2009-02-25T05:06:21.247

我认为这就是你想要的：

```
document.getElementById('tag-id').innerHTML = '<ol><li>html data</li></ol>'; 
```

请记住，在使用 IE 时，并非所有类型的标签都可以访问 innerHTML。（例如表格元素）

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2010-12-06T20:01:03.573

使用 JQuery 可以解决浏览器的不一致问题。使用项目中包含的 jquery 库，只需编写：

```
$('#yourDivName').html('yourtHTML'); 
```

您也可以考虑使用：

```
$('#yourDivName').append('yourtHTML'); 
```

这会将您的画廊添加为所选 div 中的最后一项。或者：

```
$('#yourDivName').prepend('yourtHTML'); 
```

这会将其添加为所选 div 中的第一项。

有关这些功能，请参阅 JQuery 文档：

*   [http://api.jquery.com/append/](http://api.jquery.com/append/)
*   [http://api.jquery.com/prepend/](http://api.jquery.com/prepend/)

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2015-10-19T04:04:47.713

我使用“+”（加号）将 div 插入 html ：

`document.getElementById('idParent').innerHTML += '<div id="idChild"> content html </div>';`

希望这有帮助。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2018-07-02T16:25:09.063

作为替代方案，您可以使用[insertAdjacentHTML](https://developer.mozilla.org/en-US/docs/Web/API/Element/insertAdjacentHTML) - 但是我深入研究并进行了一些性能测试 - (2019.09.13 Friday) MacOs High Sierra 10.13.6 on Chrome 76.0.3809 (64-bit), Safari 12.1.2 (13604.5.6), Firefox 69.0.0（64 位））。测试**F**仅供参考 - 它不在问题范围内，因为我们需要动态插入 html - 但在**F**中，我是通过“手动”（以静态方式）进行的 - 理论上（据我所知）这应该是插入新 html 元素的最快方法。

[![在此处输入图像描述](https://i.stack.imgur.com/LRABc.png)](https://i.stack.imgur.com/LRABc.png)

**概括**

*   **A** **（**`innerHTML =`不要与_ `+=`_ **_** _ ！）
***   **B** 在所有浏览器上最`innerHTML +=...`慢（Chrome 95 op/sec，Firefox 88 op/sec，Sfari 84 op/sec）*   **D** jQuery 在所有浏览器上都是第二慢的（Safari 14 op/sec，Firefox 11k op/sec，Chrome 7k op/sec）*   参考解决方案**F**（理论上最快）在 firefox 和 safari 上不是最快的（！！！） - 这令人惊讶*   最快的浏览器是 Safari**

 **关于为什么比[这里](https://stackoverflow.com/a/55970947/860099)`innerHTML =`快得多的更多信息。您可以在您的机器/浏览器上执行测试[这里](https://jsperf.com/insert-html-to-div/1)`innerHTML +=`

```
let html = "<div class='box'>Hello <span class='msg'>World</span> !!!</div>"

function A() {    
  container.innerHTML = `<div id="A_oiio">A: ${html}</div>`;
}

function B() {    
  container.innerHTML += `<div id="B_oiio">B: ${html}</div>`;
}

function C() {    
  container.insertAdjacentHTML('beforeend', `<div id="C_oiio">C: ${html}</div>`);
}

function D() {    
  $('#container').append(`<div id="D_oiio">D: ${html}</div>`);
}

function E() {
  let d = document.createElement("div");
  d.innerHTML = `E: ${html}`;
  d.id = 'E_oiio';
  container.appendChild(d);
}

function F() {    
  let dm = document.createElement("div");
  dm.id = "F_oiio";
  dm.appendChild(document.createTextNode("F: "));

  let d = document.createElement("div");
  d.classList.add('box');
  d.appendChild(document.createTextNode("Hello "));

  let s = document.createElement("span");
  s.classList.add('msg');
  s.appendChild(document.createTextNode("World"));

  d.appendChild(s);
  d.appendChild(document.createTextNode(" !!!"));
  dm.appendChild( d );

  container.appendChild(dm);
}

A();
B();
C();
D();
E();
F();
```

```
.warr { color: red } .msg { color: blue } .box {display: inline}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<div class="warr">This snippet only for show code used in test (in jsperf.com) - it not perform test itself. </div>
<div id="container"></div>
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2016-11-08T12:06:29.807

许多行可能看起来像这样。此处的 html 仅为示例。

```
var div = document.createElement("div");

div.innerHTML =
    '<div class="slideshow-container">\n' +
    '<div class="mySlides fade">\n' +
    '<div class="numbertext">1 / 3</div>\n' +
    '<img src="image1.jpg" style="width:100%">\n' +
    '<div class="text">Caption Text</div>\n' +
    '</div>\n' +

    '<div class="mySlides fade">\n' +
    '<div class="numbertext">2 / 3</div>\n' +
    '<img src="image2.jpg" style="width:100%">\n' +
    '<div class="text">Caption Two</div>\n' +
    '</div>\n' +

    '<div class="mySlides fade">\n' +
    '<div class="numbertext">3 / 3</div>\n' +
    '<img src="image3.jpg" style="width:100%">\n' +
    '<div class="text">Caption Three</div>\n' +
    '</div>\n' +

    '<a class="prev" onclick="plusSlides(-1)">&#10094;</a>\n' +
    '<a class="next" onclick="plusSlides(1)">&#10095;</a>\n' +
    '</div>\n' +
    '<br>\n' +

    '<div style="text-align:center">\n' +
    '<span class="dot" onclick="currentSlide(1)"></span> \n' +
    '<span class="dot" onclick="currentSlide(2)"></span> \n' +
    '<span class="dot" onclick="currentSlide(3)"></span> \n' +
    '</div>\n';

document.body.appendChild(div); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2021-09-12T20:32:04.397

```
document.getElementById('tag-id').insertAdjacentHTML("beforebegin",'<ol><li>html data</li></ol>') 
```

'beforebegin'：在元素本身之前
'afterbegin'：就在元素内部，在其第一个子元素之前
'beforeend'：就在元素内部，在其最后一个子元素之后
'afterend'：在元素本身之后

更多细节：[developer.mozilla.org/en-US/docs/Web/API/Element/insertAdjacentHTML](https://developer.mozilla.org/en-US/docs/Web/API/Element/insertAdjacentHTML)

# iphone - 在运行时向 UIPickerView 动态添加值

> ID：584764
> 
> 赞同：3
> 
> 时间：2009-02-25T05:04:22.530
> 
> 标签：iphone, objective-c, cocoa-touch

如何在运行时向 UIPickerView 动态添加值。

我正在使用以下代码静态填充 UIPickerView。需要在运行时动态添加值，例如三、四等。

```
- (NSString *) pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component{

    NSString *title = nil;
    if(row==0){
        title = @"One"; 
    }
    if(row==1){
        title = @"Two"; 
    } 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-25T05:10:34.560

如果你有一个标题数组，你可以使用类似的东西：

```
- (NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component {
  return [titles objectAtIndex:row];
} 
```

当您调用时标题将被刷新`[pickerView reloadAllComponents]`（或者`reloadComponent:`如果您有多个列并且只想刷新其中之一）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-31T23:57:07.830

嘿，我遇到了 UIPickerView 的问题……当我调用 reloadAllComponents 时，它没有调用 widthForComponent，而是调用了其他委托方法，例如 titleForRow ……我不知道为什么会这样，也许苹果不会想要动态改变宽度？无论如何它在另一个屏幕上，所以我没有动画/无动画问题。我发现通过重置选择器的委托，我可以再次调用 widthForComponent ！

IE

```
picker.delegate = view; 
```

视图在哪里实现 UIPickerViewDelegate ....希望这可以帮助那里的人！

# c# - 如何模拟私有字段？

> ID：584769
> 
> 赞同：20
> 
> 时间：2009-02-25T05:06:21.310
> 
> 标签：c#, unit-testing, mocking

我对模拟真的很陌生，并且正在尝试用模拟对象替换私有字段。目前，私有字段的实例是在构造函数中创建的。我的代码看起来像......

```
public class Cache {
    private ISnapshot _lastest_snapshot;

    public ISnapshot LatestSnapshot {
        get { return this._lastest_snapshot; }
        private set { this._latest_snapshot = value; }
    }

    public Cache() {
        this.LatestSnapshot = new Snapshot();
    }

    public void Freeze(IUpdates Updates) {
        ISnapshot _next = this.LastestSnapshot.CreateNext();
        _next.FreezeFrom(Updates);
        this.LastestSnapshot = _next;
    }

} 
```

我想要做的是创建一个单元测试，断言`ISnapshot.FreezeFrom(IUpdates)`是从内部调用的`Cache.Freeze(IUpdates)`。我猜我应该用`_latest_snapshot`模拟对象替换私有字段（可能是错误的假设？）。`LatestSnapshot`在仍然保留无参数构造函数并且不诉诸于公开 's set 的同时，我将如何做到这一点？

如果我完全打算以错误的方式编写测试，那么也请指出。

其自身的实际实现`ISnapshot.FreezeFrom`调用具有深层对象图的其他方法的层次结构，因此我不太热衷于断言对象图。

提前致谢。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-25T05:19:46.033

我几乎引用了[“有效地使用旧代码”中的](https://rads.stackoverflow.com/amzn/click/com/0131177052)技术：

1.  在单元测试中对您的类进行子类化，并用其中的模拟对象取代您的私有变量（通过添加公共设置器或在构造函数中）。您可能必须使变量受保护。
2.  为这个私有变量创建一个受保护的 getter，并在测试子类中覆盖它以返回一个模拟对象而不是实际的私有变量。
3.  创建一个受保护的工厂方法来创建`ISnapshot`对象，并在测试子类中重写它以返回一个模拟对象的实例而不是真实的。这样，构造函数将从一开始就获得正确的值。
4.  参数化构造函数以获取`ISnapshot`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T05:15:27.060

我不确定你能做到这一点。如果您想测试，`_next`那么您可能必须将它作为参数传递，然后在单元测试中传递一个 Mock 对象，然后您可以使用 Expectation 进行测试。如果我想在 Moq 中做这件事，我就会这样做。

作为我可能尝试使用 Moq 框架的示例：

```
Mock<ISnapshot> snapshotMock = new Mock<ISnapshot>();
snapshotMock.Expect(p => p.FreezeFrom(expectedUpdate)).AtMostOnce();
Cache c = new Cache(snapshotMock.Object);
c.Freeze(expectedUpdate); 
```

注意：我没有尝试编译上面的代码。它只是为了举例说明我将如何解决这个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T05:13:34.427

我认为您不需要模拟私有成员变量。模拟对象的公共接口按预期工作的整个想法不是吗？私有变量是 mock 不关心的实现细节。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T05:20:22.490

这个答案可能很简单，但是看看代码，有什么方法`ISnapshot.FreezeFrom(IUpdates)`不会被调用吗？听起来你想断言一些永远正确的东西。

正如 Jason 所说，模拟适用于您的类依赖于`SomeInterface`完成它的工作的情况，并且您希望与您在运行时实际使用的`YourClass`任何实现隔离进行测试。`SomeInterface`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T19:57:47.040

要问的问题是：如果这有效，外部可见的效果是什么？

所有这些快照会发生什么？一个选项可能是使用外部的第一个快照初始化缓存，例如在构造函数中。另一个可能是模拟缓存之外重要的快照调用的任何内容。这取决于你关心发生的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-14T06:22:14.427

反应可能为时已晚。无论如何。我也有类似的问题。

```
public class Model
{
  public ISomeClass XYZ{
      get;
      private set;
      }
} 
```

我需要在我的测试用例中设置 XYZ 的值。我使用这个语法解决了这个问题。

```
Expect.Call(_model.XYZ).Return(new SomeClass());
_repository.ReplayAll(); 
```

在上述情况下，我们可以这样做

```
Expect.Call(_cache.LatestSnapshot).Return(new Snapshot());
_repository.ReplayAll(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-16T01:50:59.667

您可能必须像这样重构您的类，以便为 ISnapshot 注入不同的依赖项。您的班级将保持不变。

```
public class Cache {
 private ISnapshot _lastest_snapshot;

 public ISnapshot LatestSnapshot {
  get { return this._lastest_snapshot; }
  private set { this._latest_snapshot = value; }
 }

 public Cache() : this (new Snapshot()) {
 }

 public Cache(ISnapshot latestSnapshot) {
  this.LatestSnapshot = latestSnapshot;
 }

 public void Freeze(IUpdates Updates) {
  ISnapshot _next = this.LastestSnapshot.CreateNext();
  _next.FreezeFrom(Updates);
  this.LastestSnapshot = _next;
 }

} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-05-11T22:04:21.150

您可以简单地将“setSnapshot(ISnapshot)”方法添加到带有模拟类实例的缓存中。

您还可以添加一个采用 ISnapshot 的构造函数。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2010-09-24T02:59:22.280

如下图将Cache转成模板。

```
template <typename T=ISnapshot>
public class Cache {
    private T _lastest_snapshot;

    public T LatestSnapshot {
        get { return this._lastest_snapshot; }
        private set { this._latest_snapshot = value; }
    }

    public Cache() {
        this.LatestSnapshot = new Snapshot();
    }

    public void Freeze(IUpdates Updates) {
        T _next = this.LastestSnapshot.CreateNext();
        _next.FreezeFrom(Updates);
        this.LastestSnapshot = _next;
    }

} 
```

在生产代码中执行：

```
Cache<> foo;//OR
Cache<ISnapshot> bar; 
```

在测试代​​码中执行：

```
Cache<MockSnapshot> mockFoo; 
```

# linux - 我如何让 cron 作业每 30 分钟运行一次？

> ID：584770
> 
> 赞同：259
> 
> 时间：2009-02-25T05:06:27.080
> 
> 标签：linux, macos, cron

我希望添加一个`crontab`条目以每 30 分钟、每小时和每小时 30 分钟或接近的时间执行一次脚本。我有以下内容，但它似乎没有在 0 上运行。

```
*/30 * * * * 
```

我需要使用什么字符串？

cron 在 OSX 上运行。

* * *

## 回答 #1

> 赞同：521
> 
> 时间：2009-02-25T05:08:41.567

做：

```
0,30 * * * * your_command 
```

* * *

## 回答 #2

> 赞同：151
> 
> 时间：2016-11-19T16:50:32.983

crontab 不理解“intervals”，它只理解“schedule”

有效时间：0-23 -- 有效分钟：0-59

**示例 #1**

`30 * * * * your_command`

这意味着“在每小时的分钟**为 30**时运行”（将在：1:30、2:30、3:30 等运行）

**示例 #2**

`*/30 * * * * your_command`

这意味着“当每小时的分钟**可以被 30 整除**时运行”（将在：1:30、2:00、2:30、3:00 等运行）

**例子#3**

`0,30 * * * * your_command`

这意味着“在每小时的分钟**为 0 或 30**时运行”（将在：1:30、2:00、2:30、3:00 等运行）

*这是完成与示例 #2 相同结果的另一种方法*

**例子#4**

`19 * * * * your_command`

这意味着“在每小时的分钟**为 19**时运行”（将在以下时间运行：1:19、2:19、3:19 等）

**示例 #5**

`*/19 * * * * your_command`

这意味着“当每小时的分钟**可以被 19 整除**时运行”（运行时间为：1:19、1:38、1:57、2:19、2:38、2:57 等）

*注意：包括作者在内的各种用户对这篇文章进行了一些改进*

* * *

## 回答 #3

> 赞同：78
> 
> 时间：2009-02-25T05:08:50.240

试试这个：

```
0,30 * * * * your command goes here 
```

根据官方 Mac OS X [crontab(5) 手册页](http://developer.apple.com/DOCUMENTATION/Darwin/Reference/ManPages/man5/crontab.5.html)，`/`支持该语法。因此，要弄清楚为什么它不适合您，您需要查看 cron 的日志。在这些日志中，您*应该*会找到明确的失败消息。

注意：Mac OS X 似乎使用 Vixie Cron，与 Linux 和 BSD 相同。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-03-08T00:35:12.583

如果您的 cron 作业仅在 Mac OS X 上运行，您可能需要使用 launchd。

来自[调度定时作业（Apple 官方文档）](http://developer.apple.com/library/mac/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/ScheduledJobs.html)：

> 注意：虽然它仍然受支持，但 cron 不是推荐的解决方案。它已被弃用，取而代之的是 launchd。

您可以通过简单的网络搜索找到其他信息（例如已启动的[Wikipedia 页面）。](http://en.wikipedia.org/wiki/Launchd)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-25T05:26:44.083

你提到你使用的是 OS X——我过去使用[过 cronnix](http://roaringapps.com/app/cronnix)。它不像自己编辑那样令人讨厌，但它帮助我了解了这些列的内容。只是一个想法。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-03-19T06:18:28.487

您可以同时使用 ' **、** '**或**除 ' **/** ' 符号。
但是，' **/** ' 更好。
假设“每 5 分钟”的情况。如果使用 ' **,** '，则必须编写 cron 作业，如下所示：

```
0,5,10,15,20,25,30,35,....    *      *     *   * your_command 
```

这意味着在所有定义的分钟内每小时运行 your_command：0,5,10,...

但是，如果使用“/”，则可以编写以下简单而简短的作业：

```
*/5  *  *  *  *  your_command 
```

这意味着在可被 5 整除的分钟内运行 your_command 或用更简单的词 '0,5,10,...'

所以，可分符号 '/' 始终是最佳选择；

# android - Android - 在横向和纵向模式之间切换使 Intent 失去价值

> ID：584779
> 
> 赞同：20
> 
> 时间：2009-02-25T05:10:28.070
> 
> 标签：android, android-orientation, landscape-portrait

我正在使用 Intents 在我的 Android 应用程序中的活动之间切换。我将数据放入 Intent 以供下一个活动使用。当我在横向和纵向模式之间切换手机时，从意图传递的值丢失并且我得到 NullPointerException。

有人可以告诉我可能出了什么问题。

有很多代码可以完全发布。但是如果有人需要查看代码的特定部分，我可以在这里发布。

**编辑**
我解决了未保存状态的问题。但我面临的另一个问题是屏幕上的按钮在方向改变后都不起作用。按下按钮时，我在 LogCat 中收到此警告

```
02-25 23:07:49.190: WARN/WindowManager(58): No window to dispatch pointer action 0 
```

请帮忙。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-25T05:23:11.080

当您切换方向时，将重新创建活动并调用 onCreate，因此您必须使用捆绑包保存当前状态并在方向更改后恢复。如果您只有一个带有 TextView 的应用程序并且您输入文本并更改方向，您可以看到这一点。如果您为 onCreate 捆绑您的状态，则可以遏制这种情况。这可能也是为什么在方向改变后你有一个 NullPointer 的原因。这很烦人，但我们必须忍受。

一系列定向教程的链接[，尤其是](http://androidguys.com/?s=rotational+forces)[第一个](http://androidguys.com/?p=2084)教程，应该可以帮助您准确了解正在发生的事情以及如何成功地保持当前状态。

更新：还有一篇关于 SO [Activity restart on rotation Android](https://stackoverflow.com/questions/456211/activity-restart-on-rotation-android)的帖子处理几乎相同的事情。

编辑后续问题：

您是否在方向更改后重新附加了单击处理程序？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-10T09:17:21.513

把它写在你的清单文件中……你想要这个在哪个活动中——

```
 android:configChanges="orientation|keyboardHidden" 
```

**已编辑：**将此用于新的 API 版本——

```
android:configChanges="orientation|keyboardHidden|screenSize" 
```

肯定会起作用的。。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-07-13T09:33:21.877

试试这个：

```
@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    outState.putString(SOME_KEY, "blah blah blah");
}

@Override
public void onCreate(Bundle savedInstanceState) {
   ...
   somevalue = savedInstanceState.getString(SOME_KEY);
   ...
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-03-20T14:21:17.597

可以使用“orientation”值声明一个属性 android:configChanges，这将阻止 Activity 重新启动。相反，活动保持运行并调用其 onConfigurationChanged() 方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-22T06:03:03.073

在你的清单中声明`< android:configChanges="orientation|keyboardHidden"/>`。这使您可以自己管理方向/键盘可见性的更改。当然，你不需要重写回调方法来管理它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-10-29T17:24:02.793

您好我也遇到了这个问题。为我解决的问题是：

```
@Override
public void onSaveInstanceState(Bundle savedInstanceState) {
    // Save the user's current game state
    savedInstanceState.putString("Username", mUsername);
    savedInstanceState.putString("Password", mPassword);
    savedInstanceState.putString("UserID", mUserID);

    // Always call the superclass so it can save the view hierarchy state
    super.onSaveInstanceState(savedInstanceState);
} 
```

然后在 onCreate() 中：

```
if (savedInstanceState == null) {
    Bundle extras = getIntent().getExtras();
    if(extras == null) {
        mUsername = "?";
        mPassword = "?";
        mUserID = "?";
    } else {
        mUsername = extras.getString("Username");
        mPassword = extras.getString("Password");
        mUserID = extras.getString("UserID");
    }
} else {
    mUsername = (String) savedInstanceState.getSerializable("Username");
    mPassword = (String) savedInstanceState.getSerializable("Password");
    mUserID = (String) savedInstanceState.getSerializable("UserID");
} 
```

那么你可以确定对象不为空。

# flash - flash AS3 如何删除舞台事件侦听器

> ID：584787
> 
> 赞同：1
> 
> 时间：2009-02-25T05:15:13.563
> 
> 标签：flash, actionscript-3

我在 flash 和 as3 中构建动画，我有一个函数，我在其中添加一个舞台 eventListener，stage.addEventListener(Event.ENTER_FRAME, setScrollPercent, false, 0, true);

由于此事件是在函数的函数内部设置的，“深度两个函数”，如何从函数外部重置所有阶段事件侦听器而不会出现错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T07:03:45.973

AS 事件监听器的最佳实践是：

*   让它变弱（就像你所做的那样，addEventListener的最后一个参数）
*   处理后将事件侦听器设置为空（严格来说，如果您将其设置为弱，则不需要）

Flex 没有给你析构函数。它有自己的垃圾收集器在后台运行以管理内存。一旦没有对它的引用，它就会清理一段内存。好吧，强有力的参考。默认情况下，所有对象都具有强引用。事件处理程序，因为它们往往是性能瓶颈，所以有这种声明自己弱的特殊能力——弱引用。这当然只有在您使用该`addEventHandler()`函数附加事件处理程序时才有可能。GC 不考虑弱引用，因此，当所有强引用都消失时，它们将自动被垃圾收集，从而使您摆脱必须`=null`手动执行的压力。当您不指定参数时，您会这样做。默认情况下，

但是，将它们标记为弱有副作用。他们可以在你不知道的情况下消失在空气中。最终，你会知道，但就一个讨厌的错误而言。这就是造成你问题的原因吗？也许，也许不是。你必须进行实验。此外，如果您可以向我们提供更多详细信息，例如确切的错误代码、某些来源，这将有所帮助。

希望这可以帮助。快乐弯曲:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T05:32:26.097

你看到了什么错误？嵌套级别应该与它无关，因为侦听器只是通过参数注册的，所以只要您使用与添加相同的三个关键参数调用 remove，就可以了。

您真正的问题是如何获取对外部范围的侦听器对象的引用？如果是这样，有几种可能的解决方案，最好的方法取决于代码的结构。

——马库斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T01:06:55.177

你的问题的答案，我意识到你的范围有问题，因为我刚刚回答了你关于范围的一个问题，就是你正在使用舞台。考虑全局舞台，因为它是绘制所有显示对象的画布。

以下将在任何地方工作！！！

```
stage.addEventListener(Event.ENTER_FRAME, setScrollPercent, false, 0, true); 
```

现在，您所说的错误，IM GUESSING，是您只是在准备好时将上述内容设置为 removeEventListener ，这是行不通的。

removeEventListener 函数不像它的兄弟 addEventListener 那样接受五个参数，它只允许三个忽略优先级和弱引用，如下所示。

```
//The following removes YOUR stage Event.ENTER_FRAME listener from any scope.
stage.removeEventListener(Event.ENTER_FRAME, setScrollPercent, false); 
```

希望这会有所帮助，记住 stage 在某种意义上是全局根，并且要小心 root，它实际上是按照现在应该的方式工作的，因为调用 root 现在是相对于你调用它的 swf，而不是 stage ，除非阶段是当前范围的根。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T22:02:54.797

您应该能够只使用旧函数并使用 removeEventListeners 而不是 add。其实很简单。

# iphone - 如何在 iPhone 的第一个视图中隐藏后退按钮？

> ID：584790
> 
> 赞同：0
> 
> 时间：2009-02-25T05:15:33.830
> 
> 标签：iphone, switch-statement

我为一个应用程序添加了 3 个视图，它们需要从 1-2-3 切换。

现在我在 SwitchViewController 的底部添加了一个工具栏和一个按钮“确定”，这样他们就可以共享该按钮以转到下一个视图。

但是如何添加一个“返回”按钮，以便我可以从 2-1 或 3-2 切换并且不应该在第一个视图中看到该按钮？有没有其他方法可以在不共享相同工具栏按钮的情况下切换视图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T05:28:35.233

听起来你想要做的是使用 UINavigationController。如果您使用`initWithRootViewController`初始化程序实例化 UINavigationController，则可以将其传递给您的第一个 UIViewController。然后你只需要将你想要的任何动作绑定到一个调用的方法上，`[myUINavigationController pushViewController:myOtherViewController animated:YES]`让它滑到第二个视图。UINavigationController 将自动设置您正在寻找的 UINavigationBar 和后退按钮。

# sql - 存储调查和答案的 SQL 结构 - 基于用户数据构建表和查询？

> ID：584791
> 
> 赞同：3
> 
> 时间：2009-02-25T05:16:29.130
> 
> 标签：sql, survey, auto-generate

当谈到 SQL 时，我是一个完全的新手。我正在 ASP.NET 中创建一个站点来进行调查。特权管理员用户将能够构建调查。然后很多其他人会回复调查。

一旦我有了新调查的一组问题，自动构建表和 INSERT 查询以存储响应的最佳方法是什么？

更新

感谢您的快速回复！我仍然不清楚在这种情况下如何最好地存储调查响应。每个受访者会得到表格的一排吗？如果是这样，这些列是否会是“针对第 1 列中的条目确定的调查的问题 k 给出的答案”？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T05:21:23.347

您不想为每个调查建立一个新表。

创建一个调查表（SurveyID、UserID、Name 等）

创建问题表（QuestionID、SurveyID、QuestionText、SortOrder 等）

可选地，创建一个选项表，假设您有多项选择类型的问题（OptionID、QuestionID、OptionText 等）

然后当有人创建调查时，您插入到调查表中，引用该人的 UserID 作为外键，然后获取新插入的 SurveyID，

然后对于他们添加的每个问题，将其插入到 Questions 表中，使用上面的 SurveyID 作为外键......等等。

**编辑回答您的编辑：**

抱歉，我也应该继续介绍存储答案。

你会想要另一个名为 SurveyResponses (ResponseID, Name, etc) 的表和另一个表我会调用 ResponseAnswers(ResponseAnswerID, SurveyID, ResponseID, QuestionID, AnswerText/AnswerID) 其中 SurveyID 和 ResponseID 是他们各自表的外键，并且取决于无论用户有多项选择，还是输入答案，您都可以将他们的答案存储为文本（varchar）或作为选项表的另一个外键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T05:20:14.880

您可能不想以编程方式生成模式。

相反，有一个用于调查、问题（属于调查）、响应集（每个用户一个）和问题响应（属于响应集）的表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-16T07:32:23.873

我会想到几个选择：

*   创建一个一对多`Survey`表和`Question`表，其中每个表`Question`都有一个列`DataType`，其中包含我们期望的响应数据类型的代码，以及可选的其他一些列/可用选项的相关表，一个指定此问题的列是多选/单选，必选/可选问题等`Answer`。根据问题数据类型，表格的答案是序列化/去序列化/索引/格式化等
*   考虑使用 NoSql 数据库以类似的方式存储调查数据

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-25T05:24:26.803

您不会自动构建表格。该表将被预定义，并且答案将被添加到其中。我认为这些天开始使用 ASP.NET 的最佳方式是深入研究 MVC 和 Linq [(http://asp.net/learn](http://asp.net/learn) )

# c# - 如何在同一连接下执行多个事务？

> ID：584795
> 
> 赞同：0
> 
> 时间：2009-02-25T05:20:22.897
> 
> 标签：c#

这里我的要求是这样的：

1.  最初，我在一个事务下执行一个存储过程来插入\更新数据库中的记录。
2.  如果由于某些问题 SP 执行失败，我必须能够在不同的事务下再次重新调用 SP。
3.  即使 SP 的重新调用失败，我也应该向调用函数抛出错误。

这是示例代码。这是处理事务和错误的正确方法，还是有更好的方法来做到这一点？

```
public void InsertUser(string code)
{  
   bool bRetry=false;
   SqlTransaction transaction = null;
   Exception RetrunEx = null;
   using (SqlConnection sqlConnection = new SqlConnection(this.connectionString))
   {
      sqlConnection.Open();

      SqlCommand sqlCommand = new SqlCommand("InsertUser", sqlConnection);
      sqlCommand.CommandType = System.Data.CommandType.StoredProcedure;
      SqlParameter param = sqlCommand.Parameters.Add("@UserCode", SqlDbTypes.VarChar);
      param.Value = code;

      //Is this the proper place to begin a transaction?
      SqlTransaction transaction = connection.BeginTransaction();
      sqlCommand.Transaction = transaction;     

      try
      {         
          sqlCommand.ExecuteNonQuery();
          transaction.Commit();

      }      
      catch(SqlException SqlEx)
      {
         transaction.Rollback();
     bRetry = true;
         RetrunEx = SqlEx;
      }
      catch(Exception ex)
      {
          transaction.Rollback();
          RetrunEx = ex;
      }

      //Will this be treated as new transaction?
      //Is there any best way of doing this?
      transaction = connection.BeginTransaction();
      sqlCommand.Transaction = transaction;

      try
      { 
          if (bRetry)        
      {
              sqlCommand.ExecuteNonQuery();
              transaction.Commit();
              ReturnEx = null;
          }

      }      
      catch(Exception Ex)
      {
         transaction.Rollback();
         RetrunEx = Ex;
      }

      //When both the trials fails then throw exception
      if (RetrunEx != null)
      {
          throw RetrunEx;
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T05:30:22.233

使用事务最简单的方法是使用[System.Transaction](http://msdn.microsoft.com/en-us/library/system.transactions.aspx) ，它是一个非常简单但功能强大的 api。

```
...
using (TransactionScope ts = new TransactionScope())
{
   //Do Transactional Work
   ...
   ...

   //Commit your transaction
   ts.Complete();
 } 
```

你不需要 try/catch 来回滚你的事务。如果您退出“使用”时出现异常，或者没有调用“ts.Complete”语句，您的事务将自动回滚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T05:30:31.017

我可能有一个唯一目的是尝试执行这个存储过程的方法。伪代码：

```
public bool ExecuteSP()
{
   try{
   //open connection, begin tran execture sp
   //commit transaction, return true;
   }

   catch(SqlException){

    //rollback transaction
    //return false
    }

} 
```

然后在您的调用代码中，您可以执行以下操作：

```
if(!ExecuteSP() && !ExecuteSP())
{
   //throw Exception
} 
```

# java - 如何使用 Tomcat 6 配置 Struts 2？

> ID：584804
> 
> 赞同：-1
> 
> 时间：2009-02-25T05:25:10.373
> 
> 标签：java, xml, web-applications, tomcat, struts

谁能帮我配置struts 2.0.14（我使用的是tomcat 6.0）。我想知道在 struts 中构建我的第一个应用程序的过程是什么。还告诉我如何使用 xml 来构建一个 struts 应用程序。我已经尝试并厌倦了谷歌，这就是我在这里的原因。请根据您自己的经验为 struts 推荐一些不错的教程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T05:48:26.793

看这里[Struts 2 初学者教程](http://www.roseindia.net/struts/struts2/index.shtml)，应该可以帮助你。他们还解释了 Struts 2 中的 xml。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-31T06:47:28.653

[您可以在http://struts.apache.org/2.2.1/docs/how-to-create-a-struts-2-web-application.html](http://struts.apache.org/2.2.1/docs/how-to-create-a-struts-2-web-application.html)找到有关 Struts 2 教程的更多信息

基本上，这是相同的文档，也可作为任何 Struts 2.x 版本的一部分。还有一些示例 Web 应用程序代码 -zip 也可用，您可以使用 Ant 或 Maven 构建它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T00:03:23.343

[Struts 主页上](http://struts.apache.org/)的材料有什么问题或遗漏了什么？有初学者的信息链接等等。

# 3d - 使用 django 和 postgis 的 3 维 GiS 数据

> ID：584806
> 
> 赞同：1
> 
> 时间：2009-02-25T05:27:21.383
> 
> 标签：3d, postgis, geodjango

我可以在我当前的项目中使用第三维，这强烈涉及 google-maps 和 django。我该如何处理？

```
class Waypoint(models.Model):
    latlng = models.PointField()

>>> p = Point( 5, 10, 20)
<Point object at Ox...>
>>> p.kml
'<Point><coordinates>5.0,10.0,20.0</coordinates></Point>'
>>> w = Waypoint.objects.all()[0]
<Waypoint: Waypoint object>
>>> w.latlng = p
>>> w.latlng.kml
'<Point><coordinates>5.0,10.0,20.0</coordinates></Point>'
>>> w.save()
>>> w = Waypoint.objects.all()[0]
<Waypoint: Waypoint object>
>>> w.latlng.kml
'<Point><coordinates>5.0,10.0,0</coordinates></Point>'
                              ^ 
```

请注意，忽略第三个 diemsnion。GRRR！

# c# - ADO.NET 实体框架设计器的已知限制是什么？

> ID：584816
> 
> 赞同：4
> 
> 时间：2009-02-25T05:32:53.617
> 
> 标签：c#, .net, entity-framework, ado.net

我们刚刚发现了一个问题，例如，当外键关系被破坏时，无法在设计器中重新建立链接。

实体框架设计器的任何其他此类已知限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T18:12:02.427

除其他事项外，

1.  您根本无法映射复杂类型。（**更新**已在 EF v4 中修复。）
2.  您必须映射存储模式中表的每一列。
3.  概括（2），您根本无法控制存储模式。您主要看到的是客户端架构和*到*存储架构的映射。
4.  如果您从图表中删除了一个类型，则很难将其放回原处。

[我在这篇文章](http://blogs.teamb.com/craigstuntz/2008/07/17/37825/ "ADO.NET 实体框架与 NHibernate 和其他 ORM")中写了一些关于实体框架本身和设计者之间哲学方法差异的想法。

我认为，如果您打算在实体框架中做一些重要/非默认的事情，您应该习惯于编辑 EDMX。大多数其他 ORM 确实需要在某些时候编辑 XML，这是值得的。

# powershell - 如何使用 powershell 访问证书扩展属性？

> ID：584819
> 
> 赞同：1
> 
> 时间：2009-02-25T05:34:55.327
> 
> 标签：powershell, certificate, capicom

如果您在 Windows 的证书管理器中打开证书的属性窗口，您将看到友好名称和描述字段。我正在尝试通过 powershell 以编程方式进入描述字段。

通过 powershell 的证书提供程序 cert 访问证书时：您将获得一个仅将 FriendlyName 公开为名称的对象。

据我所知，这完全是 CAPICOM API 的包装。描述或 get_extendedproperties 方法均未公开。

如何通过 powershell 有问题地访问描述字段？请注意，我试图简单地做

```
$store = new-object -com "CAPICOM.Store" 
```

直接使用 CAPICOM api ala [This Link](http://www.derkeiler.com/Newsgroups/microsoft.public.platformsdk.security/2006-04/msg00081.html)，但我的 64 位 Win2K8 机器上出现 80040154 错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T16:38:40.193

打开 x86 Powershell 而不是 x64。这应该让你开始：

```
$store = new-object -com "CAPICOM.Store"
$store.Open(2, "CA", 1)
$store | fl *
$store.Certificates
$store.Certificates | %{ $_.display() }
$store.Certificates | %{ $_.extendedproperties() } 
```

# c# - 如何使用 linq 扩展方法执行左外连接

> ID：584820
> 
> 赞同：323
> 
> 时间：2009-02-25T05:35:04.470
> 
> 标签：c#, linq-to-sql, lambda

假设我有一个左外连接：

```
from f in Foo
join b in Bar on f.Foo_Id equals b.Foo_Id into g
from result in g.DefaultIfEmpty()
select new { Foo = f, Bar = result } 
```

我将如何使用扩展方法来表达相同的任务？例如

```
Foo.GroupJoin(Bar, f => f.Foo_Id, b => b.Foo_Id, (f,b) => ???)
    .Select(???) 
```

* * *

## 回答 #1

> 赞同：512
> 
> 时间：2009-02-25T05:44:17.100

对于一个表的（左外）连接，`Bar`其中一个表`Foo`在`Foo.Foo_Id = Bar.Foo_Id`lambda 表示法中：

```
var qry = Foo.GroupJoin(
          Bar, 
          foo => foo.Foo_Id,
          bar => bar.Foo_Id,
          (x,y) => new { Foo = x, Bars = y })
       .SelectMany(
           x => x.Bars.DefaultIfEmpty(),
           (x,y) => new { Foo=x.Foo, Bar=y}); 
```

* * *

## 回答 #2

> 赞同：139
> 
> 时间：2014-06-17T21:44:11.687

由于这似乎是使用方法（扩展）语法的左外连接事实上的 SO 问题，我想我会为当前选择的答案添加一个替代方案（至少在我的经验中）更常见的是我后

```
// Option 1: Expecting either 0 or 1 matches from the "Right"
// table (Bars in this case):
var qry = Foos.GroupJoin(
          Bars,
          foo => foo.Foo_Id,
          bar => bar.Foo_Id,
          (f,bs) => new { Foo = f, Bar = bs.SingleOrDefault() });

// Option 2: Expecting either 0 or more matches from the "Right" table
// (courtesy of currently selected answer):
var qry = Foos.GroupJoin(
                  Bars, 
                  foo => foo.Foo_Id,
                  bar => bar.Foo_Id,
                  (f,bs) => new { Foo = f, Bars = bs })
              .SelectMany(
                  fooBars => fooBars.Bars.DefaultIfEmpty(),
                  (x,y) => new { Foo = x.Foo, Bar = y }); 
```

使用简单的数据集显示差异（假设我们正在加入值本身）：

```
List<int> tableA = new List<int> { 1, 2, 3 };
List<int?> tableB = new List<int?> { 3, 4, 5 };

// Result using both Option 1 and 2\. Option 1 would be a better choice
// if we didn't expect multiple matches in tableB.
{ A = 1, B = null }
{ A = 2, B = null }
{ A = 3, B = 3    }

List<int> tableA = new List<int> { 1, 2, 3 };
List<int?> tableB = new List<int?> { 3, 3, 4 };

// Result using Option 1 would be that an exception gets thrown on
// SingleOrDefault(), but if we use FirstOrDefault() instead to illustrate:
{ A = 1, B = null }
{ A = 2, B = null }
{ A = 3, B = 3    } // Misleading, we had multiple matches.
                    // Which 3 should get selected (not arbitrarily the first)?.

// Result using Option 2:
{ A = 1, B = null }
{ A = 2, B = null }
{ A = 3, B = 3    }
{ A = 3, B = 3    } 
```

选项 2 适用于典型的左外连接定义，但正如我之前提到的，根据数据集的不同，它通常过于复杂。

* * *

## 回答 #3

> 赞同：65
> 
> 时间：2015-05-07T18:25:01.063

Group Join 方法对于实现两个数据集的连接是不必要的。

内部联接：

```
var qry = Foos.SelectMany
            (
                foo => Bars.Where (bar => foo.Foo_id == bar.Foo_id),
                (foo, bar) => new
                    {
                    Foo = foo,
                    Bar = bar
                    }
            ); 
```

对于左连接，只需添加 DefaultIfEmpty()

```
var qry = Foos.SelectMany
            (
                foo => Bars.Where (bar => foo.Foo_id == bar.Foo_id).DefaultIfEmpty(),
                (foo, bar) => new
                    {
                    Foo = foo,
                    Bar = bar
                    }
            ); 
```

EF 和 LINQ to SQL 正确转换为 SQL。 **对于 LINQ to Objects，最好使用 GroupJoin 加入，因为它在内部使用 Lookup**。但是，如果您正在查询数据库，那么跳过 GroupJoin 是 AFAIK 的表现。

与 GroupJoin().SelectMany() 相比，这种方式对我来说 Personlay 更具可读性

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2013-07-31T08:56:22.263

您可以创建扩展方法，例如：

```
public static IEnumerable<TResult> LeftOuterJoin<TSource, TInner, TKey, TResult>(this IEnumerable<TSource> source, IEnumerable<TInner> other, Func<TSource, TKey> func, Func<TInner, TKey> innerkey, Func<TSource, TInner, TResult> res)
    {
        return from f in source
               join b in other on func.Invoke(f) equals innerkey.Invoke(b) into g
               from result in g.DefaultIfEmpty()
               select res.Invoke(f, result);
    } 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-10-01T18:37:59.353

改进 Ocelot20 的答案，如果你有一个表，你只需要从外部加入 0 或 1 行，但它可能有多个，你需要订购你的加入表：

```
var qry = Foos.GroupJoin(
      Bars.OrderByDescending(b => b.Id),
      foo => foo.Foo_Id,
      bar => bar.Foo_Id,
      (f, bs) => new { Foo = f, Bar = bs.FirstOrDefault() }); 
```

否则，您在联接中获得的哪一行将是随机的（或者更具体地说，无论哪个数据库碰巧先找到）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-05-02T09:26:00.367

虽然接受的答案有效并且对 Linq to Objects 有好处，但它让我感到烦恼的是 SQL 查询不仅仅是一个直接的左外连接。

以下代码依赖于[LinqKit 项目](https://github.com/scottksmith95/LINQKit)，它允许您传递表达式并将它们调用到您的查询中。

```
static IQueryable<TResult> LeftOuterJoin<TSource,TInner, TKey, TResult>(
     this IQueryable<TSource> source, 
     IQueryable<TInner> inner, 
     Expression<Func<TSource,TKey>> sourceKey, 
     Expression<Func<TInner,TKey>> innerKey, 
     Expression<Func<TSource, TInner, TResult>> result
    ) {
    return from a in source.AsExpandable()
            join b in inner on sourceKey.Invoke(a) equals innerKey.Invoke(b) into c
            from d in c.DefaultIfEmpty()
            select result.Invoke(a,d);
} 
```

可以如下使用

```
Table1.LeftOuterJoin(Table2, x => x.Key1, x => x.Key2, (x,y) => new { x,y}); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-03-16T21:08:25.507

将 Marc Gravell 的答案转换为扩展方法，我做了以下操作。

```
internal static IEnumerable<Tuple<TLeft, TRight>> LeftJoin<TLeft, TRight, TKey>(
    this IEnumerable<TLeft> left,
    IEnumerable<TRight> right,
    Func<TLeft, TKey> selectKeyLeft,
    Func<TRight, TKey> selectKeyRight,
    TRight defaultRight = default(TRight),
    IEqualityComparer<TKey> cmp = null)
{
    return left.GroupJoin(
            right,
            selectKeyLeft,
            selectKeyRight,
            (x, y) => new Tuple<TLeft, IEnumerable<TRight>>(x, y),
            cmp ?? EqualityComparer<TKey>.Default)
        .SelectMany(
            x => x.Item2.DefaultIfEmpty(defaultRight),
            (x, y) => new Tuple<TLeft, TRight>(x.Item1, y));
} 
```

# google-analytics - 如何将 Google Analytics 与特定的经过身份验证的用户相关联？

> ID：584823
> 
> 赞同：1
> 
> 时间：2009-02-25T05:36:16.337
> 
> 标签：google-analytics

您将使用什么方法将 Google Analytics 中的跟踪信息与特定的命名用户相关联？

我希望能够进行自定义报告，并最终深入了解用户的使用情况。

**编辑**
我在想也许[EventTracking API](http://code.google.com/apis/analytics/docs/eventTrackerOverview.html)能够以某种方式提供帮助。

另外，请参阅[此文档](http://code.google.com/apis/analytics/docs/eventTrackerGuide.html)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T07:07:43.450

您可以将用户的用户名添加为跟踪/分段）变量...

```
pageTracker._setVar(username); 
```

但是，每页只能使用一个 _setVar...

[http://www.google.com/support/analytics/bin/answer.py?answer=57045](http://www.google.com/support/analytics/bin/answer.py?answer=57045)

[http://groups.google.com/group/analytics-help-basics/browse_thread/thread/07e29dc610050971](http://groups.google.com/group/analytics-help-basics/browse_thread/thread/07e29dc610050971)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T05:47:18.387

由于 Google Analytics 不知道登录到您网站的用户，因此您必须在您网站的软件本身内进行此类跟踪。如果那里还没有某种插件或扩展，您可能必须自己编写一个来跟踪您的用户在登录时所做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T18:26:15.747

I think you want [Google Analytics - Custom Variables](https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingCustomVariables). You can set five variables per page, and there is support for variables you set persisting over session and cookie (aka "visitor") lifetime. Take note of the rules for overwriting previous values based upon slot and scope; the documentation explains this with some examples. You should probably include something in a click-wrapped privacy policy about tracking individual users this way; it's somewhat invasive, depending on the purpose of your website.

```
_gaq.push(['_setCustomVar',
    1,          // Slot number: [1-5], inclusive.  Required.
    'Username', // Custom variable name.  Required.
    username,   // Custom variable value.  Required.
    2           // Scope: 
                // 1 = visitor/cookie-level, 2 = session-level, 3 = page-level.  
                // Optional, default=3.
]); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-03-25T21:58:31.177

[http://www.highlyrelevant.com/2011/03/25/how-to-add-edit-google-analytics-users-to-your-account/](http://www.highlyrelevant.com/2011/03/25/how-to-add-edit-google-analytics-users-to-your-account/)

这篇文章对我和我的团队真的很有帮助。它不仅展示了如何添加用户，还告诉您如何编辑未正确设置的现有用户。

谢谢！菲尔

# c++ - 在 C++ 中保证临时的生命周期？

> ID：584824
> 
> 赞同：105
> 
> 时间：2009-02-25T05:36:59.597
> 
> 标签：c++

C++ 是否为在函数调用中创建但不用作参数的临时变量的生命周期提供保证？这是一个示例类：

```
class StringBuffer
{
public:
    StringBuffer(std::string & str) : m_str(str)
    {
        m_buffer.push_back(0);
    }
    ~StringBuffer()
    {
        m_str = &m_buffer[0];
    }
    char * Size(int maxlength)
    {
        m_buffer.resize(maxlength + 1, 0);
        return &m_buffer[0];
    }
private:
    std::string & m_str;
    std::vector<char> m_buffer;
}; 
```

以下是您将如何使用它：

```
// this is from a crusty old API that can't be changed
void GetString(char * str, int maxlength);

std::string mystring;
GetString(StringBuffer(mystring).Size(MAXLEN), MAXLEN); 
```

什么时候会调用临时 StringBuffer 对象的析构函数？是吗：

*   在调用 GetString 之前？
*   GetString 返回后？
*   编译器依赖？

我知道 C++ 保证本地临时变量只要有对它的引用就有效 - 当有对成员变量的引用时，这是否适用于父对象？

谢谢。

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-02-25T05:42:16.307

The destructor for that sort of temporaries is called at the end of the full-expression. That's the most outer expression which is not part of any other expression. That is in your case after the function returns and the value is evaluated. So, it will work all nice.

It's in fact what makes expression templates work: They can keep hold references to that sort of temporaries in an expression like

```
e = a + b * c / d 
```

Because every temporary will last until the expression

```
x = y 
```

Is evaluated completely. It's quite concisely described in `12.2 Temporary objects` in the Standard.

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-25T06:42:56.100

litb's answer is accurate. The lifetime of the temporary object (also known as an rvalue) is tied to the expression and the destructor for the temporary object is called at the end of the full expression and when the destructor on StringBuffer is called, the destructor on m_buffer will also be called, but not the destructor on m_str since it is a reference.

Note that C++0x changes things just a little bit because it adds rvalue references and move semantics. Essentially by using an rvalue reference parameter (notated with &&) I can 'move' the rvalue into the function (instead of copying it) and the lifetime of the rvalue can be bound to the object it moves into, not the expression. There is a really good [blog post from the MSVC team on that walks through this in great detail](http://blogs.msdn.com/vcblog/archive/2009/02/03/rvalue-references-c-0x-features-in-vc10-part-2.aspx) and I encourage folks to read it.

The pedagogical example for moving rvalue's is temporary strings and I'll show assignment in a constructor. If I have a class MyType that contains a string member variable, it can be initialized with an rvalue in the constructor like so:

```
class MyType{
   const std::string m_name;
public:
   MyType(const std::string&& name):m_name(name){};
} 
```

This is nice because when I declare an instance of this class with a temporary object:

```
void foo(){
    MyType instance("hello");
} 
```

what happens is that we avoid copying and destroying the temporary object and "hello" is placed directly inside the owning class instance's member variable. If the object is heavier weight than a 'string' then the extra copy and destructor call can be significant.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-25T05:43:03.077

After the call to GetString returns.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-25T21:37:10.723

I wrote almost exactly the same class:

```
template <class C>
class _StringBuffer
{
    typename std::basic_string<C> &m_str;
    typename std::vector<C> m_buffer;

public:
    _StringBuffer(std::basic_string<C> &str, size_t nSize)
        : m_str(str), m_buffer(nSize + 1) { get()[nSize] = (C)0; }

    ~_StringBuffer()
        { commit(); }

    C *get()
        { return &(m_buffer[0]); }

    operator C *()
        { return get(); }

    void commit()
    {
        if (m_buffer.size() != 0)
        {
            size_t l = std::char_traits<C>::length(get());
            m_str.assign(get(), l);    
            m_buffer.resize(0);
        }
    }

    void abort()
        { m_buffer.resize(0); }
};

template <class C>
inline _StringBuffer<C> StringBuffer(typename std::basic_string<C> &str, size_t nSize)
    { return _StringBuffer<C>(str, nSize); } 
```

Prior to the standard each compiler did it differently. I believe the old Annotated Reference Manual for C++ specified that temporaries should clean up at the end of the scope, so some compilers did that. As late as 2003, I found that behaviour still existed by default on Sun's Forte C++ compiler, so StringBuffer didn't work. But I'd be astonished if any current compiler was still that broken.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-25T05:45:43.820

StringBuffer is in the scope of GetString. It should get destroyed at the end of GetString's scope (ie when it returns). Also, I don't believe that C++ will guarantees that a variable will exist as long as there is reference.

The following ought to compile:

```
Object* obj = new Object;
Object& ref = &(*obj);
delete obj; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2022-02-15T00:05:46.027

From [cppreference](https://en.cppreference.com/w/cpp/language/lifetime):

> **All temporary objects are destroyed as the last step in evaluating the full-expression that (lexically) contains the point where they were created**, and if multiple temporary objects were created, they are destroyed in the order opposite to the order of creation. This is true even if that evaluation ends in throwing an exception.

# c++ - 在 MacOS 中编译 C++ 代码时的 dSYM 目录

> ID：584825
> 
> 赞同：28
> 
> 时间：2009-02-25T05:37:14.557
> 
> 标签：c++, macos, compiler-construction, debug-symbols

为什么在 Mac 中编译 C++ 总是创建 *.dSYM 目录？有没有办法禁用它？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-02-25T09:21:48.543

这是因为您的 Xcode 项目设置为使用外部 dSYM 文件构建调试符号。这对于发布版本实际上非常方便，因为这意味着您可以从应用程序中删除调试符号，并且当用户向您发送故障转储时，您可以使用原始 dSYM 文件生成适当的堆栈跟踪以进行调试。

无论如何，您*不需要*在项目中禁用调试符号生成。相反，只需将调试符号类型更改为 DWARF（而不是“带有 dSYM 文件的 DWARF”）。您也可以使用 Stabs，但这是旧格式。

**编辑**：啊，我看到你的意思是从命令行，而不是从 Xcode。我没有坐在我的 mac atm 前面，但我从[gcc4 联机帮助页](http://developer.apple.com/DOCUMENTATION/Darwin/Reference/ManPages/man1/g++-4.0.1.html)中看到，您可以指定 -gstabs 来使用 Stabs 格式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T08:16:47.107

我假设您使用 Xcode。转到“项目”/“编辑项目设置”菜单项，单击构建选项卡，在“GCC 4.0 - 代码生成”部分下，取消选中生成调试符号。您可以在搜索字段中输入“sym”来帮助找到它。

# php - 抓取网页内容

> ID：584826
> 
> 赞同：19
> 
> 时间：2009-02-25T05:37:40.890
> 
> 标签：php, curl, web-scraping, httprequest, screen-scraping

我正在开发一个项目，我想在后台抓取网站的内容并从该抓取的网站中获取一些有限的内容。例如，在我的页面中，我有“userid”和“password”字段，通过使用这些字段，我将访问我的邮件并抓取我的收件箱内容并将其显示在我的页面中。

我单独使用javascript完成了上述操作。但是当我单击登录按钮时，我的页面的 URL ( [http://localhost/web/Login.html](http://localhost/web/Login.html) ) 更改为 URL ( [http://mail.in.com/mails/inbox.php?nomail= ...](http://mail.in.com/mails/inbox.php?nomail=...) .) 我被刮了。但是我在不更改网址的情况下取消了详细信息。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-27T11:18:09.137

绝对要使用[PHP Simple HTML DOM Parser](http://simplehtmldom.sourceforge.net/)。它快速、简单且超级灵活。它基本上将整个 HTML 页面粘贴在一个对象中，然后您可以访问该对象中的任何元素。

像官方网站的例子一样，获取谷歌主页上的所有链接：

```
// Create DOM from URL or file
$html = file_get_html('http://www.google.com/');

// Find all images 
foreach($html->find('img') as $element) 
       echo $element->src . '<br>';

// Find all links 
foreach($html->find('a') as $element) 
       echo $element->href . '<br>'; 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2016-02-25T16:46:13.967

# HTTP 请求

首先，您发出 HTTP 请求以获取页面内容。有几种方法可以做到这一点。

### 开放

发送 HTTP 请求的最基本方法是使用`fopen`. 一个主要优点是您可以设置一次读取多少个字符，这在读取非常大的文件时很有用。但是，正确地做这件事并不是最容易的事情，除非您正在阅读非常大的文件并且担心遇到内存问题，否则不建议这样做。

```
$fp = fopen("http://www.4wtech.com/csp/web/Employee/Login.csp", "rb");
if (FALSE === $fp) {
    exit("Failed to open stream to URL");
}

$result = '';

while (!feof($fp)) {
    $result .= fread($fp, 8192);
}
fclose($fp);
echo $result; 
```

### 文件获取内容

最简单的方法，就是使用`file_get_contents`. if 和 fopen 差不多，但是你有更少的选择。这里的一个主要优点是它只需要一行代码。

```
$result = file_get_contents('http://www.4wtech.com/csp/web/Employee/Login.csp');
echo $result; 
```

### 插座

如果您需要对发送到服务器的标头进行更多控制，您可以结合使用套接字和`fopen`.

```
$fp = fsockopen("www.4wtech.com/csp/web/Employee/Login.csp", 80, $errno, $errstr, 30);
if (!$fp) {
    $result = "$errstr ($errno)<br />\n";
} else {
    $result = '';
    $out = "GET / HTTP/1.1\r\n";
    $out .= "Host: www.4wtech.com/csp/web/Employee/Login.csp\r\n";
    $out .= "Connection: Close\r\n\r\n";
    fwrite($fp, $out);
    while (!feof($fp)) {
        $result .= fgets($fp, 128);
    }
    fclose($fp);
}
echo $result; 
```

### 流

或者，您也可以使用流。流类似于套接字，可以与`fopen`和结合使用`file_get_contents`。

```
$opts = array(
  'http'=>array(
    'method'=>"GET",
    'header'=>"Accept-language: en\r\n" .
              "Cookie: foo=bar\r\n"
  )
);

$context = stream_context_create($opts);

$result = file_get_contents('http://www.4wtech.com/csp/web/Employee/Login.csp', false, $context);
echo result; 
```

### 卷曲

如果您的服务器支持 cURL（通常支持），建议使用 cURL。使用 cURL 的一个关键优势是它依赖于其他编程语言中常用的流行 C 库。它还提供了一种创建请求标头和自动解析响应标头的便捷方式，并提供了一个简单的界面以防出错。

```
$defaults = array( 
    CURLOPT_URL, "http://www.4wtech.com/csp/web/Employee/Login.csp"
    CURLOPT_HEADER=> 0
);

$ch = curl_init(); 
curl_setopt_array($ch, ($options + $defaults)); 
if( ! $result = curl_exec($ch)) { 
    trigger_error(curl_error($ch)); 
} 
curl_close($ch); 
echo $result; 
```

### 图书馆

或者，您可以使用[**许多 PHP 库**](https://www.google.be/webhp?sourceid=chrome-instant&ion=1&espv=2&ie=UTF-8#q=php%20http%20request%20libraries)之一。不过，我不建议使用库，因为它可能会矫枉过正。在大多数情况下，最好在底层使用 cURL 编写自己的 HTTP 类。

* * *

# HTML解析

PHP 有一种方便的方法可以将任何 HTML 加载到`DOMDocument`.

```
$pagecontent = file_get_contents('http://www.4wtech.com/csp/web/Employee/Login.csp');
$doc = new DOMDocument();
$doc->loadHTML($pagecontent);
echo $doc->saveHTML(); 
```

不幸的是，PHP 对 HTML5 的支持是有限的。如果您在尝试解析页面内容时遇到错误，请考虑使用第三方库。为此，我可以推荐[**Masterminds/html5-php**](https://github.com/Masterminds/html5-php)。使用此库解析 HTML 文件与使用`DOMDocument`.

```
use Masterminds\HTML5;

$pagecontent = file_get_contents('http://www.4wtech.com/csp/web/Employee/Login.csp');
$html5 = new HTML5();
$dom = $html5->loadHTML($html);
echo $html5->saveHTML($dom); 
```

或者，您可以使用例如。我的图书馆[**PHPPowertools/DOM-Query**](https://github.com/PHPPowertools/DOM-Query)。[**它在后台使用Masterminds/html5-php**](https://github.com/Masterminds/html5-php)的定制版本将 HTML5 字符串解析为 a`DomDocument`和[**symfony/DomCrawler**](https://github.com/symfony/DomCrawler)以将 CSS 选择器转换为 XPath 选择器。`DomDocument`即使将一个对象传递给另一个对象，它也总是使用相同的，以确保良好的性能。

```
namespace PowerTools;

// Get file content
$pagecontent = file_get_contents( 'http://www.4wtech.com/csp/web/Employee/Login.csp' );

// Define your DOMCrawler based on file string
$H = new DOM_Query( $pagecontent );

// Define your DOMCrawler based on an existing DOM_Query instance
$H = new DOM_Query( $H->select('body') );

// Passing a string (CSS selector)
$s = $H->select( 'div.foo' );

// Passing an element object (DOM Element)
$s = $H->select( $documentBody );

// Passing a DOM Query object
$s = $H->select( $H->select('p + p') );

// Select the body tag
$body = $H->select('body');

// Combine different classes as one selector to get all site blocks
$siteblocks = $body->select('.site-header, .masthead, .site-body, .site-footer');

// Nest your methods just like you would with jQuery
$siteblocks->select('button')->add('span')->addClass('icon icon-printer');

// Use a lambda function to set the text of all site blocks
$siteblocks->text(function( $i, $val) {
    return $i . " - " . $val->attr('class');
});

// Append the following HTML to all site blocks
$siteblocks->append('<div class="site-center"></div>');

// Use a descendant selector to select the site's footer
$sitefooter = $body->select('.site-footer > .site-center');

// Set some attributes for the site's footer
$sitefooter->attr(array('id' => 'aweeesome', 'data-val' => 'see'));

// Use a lambda function to set the attributes of all site blocks
$siteblocks->attr('data-val', function( $i, $val) {
    return $i . " - " . $val->attr('class') . " - photo by Kelly Clark";
});

// Select the parent of the site's footer
$sitefooterparent = $sitefooter->parent();

// Remove the class of all i-tags within the site's footer's parent
$sitefooterparent->select('i')->removeAttr('class');

// Wrap the site's footer within two nex selectors
$sitefooter->wrap('<section><div class="footer-wrapper"></div></section>'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T06:11:17.033

您可以使用 PHP 的 cURL 扩展从您的 PHP 页面脚本中向另一个网站发出 HTTP 请求。请参阅[此处的文档。](http://www.php.net/curl)

当然，这里的缺点是您的网站会响应缓慢，因为您必须先抓取外部网站，然后才能将完整的页面/输出呈现给您的用户。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-06T09:38:46.410

你试过 OutWit Hub 吗？这是一个完整的抓取环境。您可以让它尝试猜测结构或开发自己的刮板。我真的建议你看看它。它让我的生活变得简单多了。ZR

# c# - 保护我的代码免受逆向工程

> ID：584828
> 
> 赞同：7
> 
> 时间：2009-02-25T05:38:36.160
> 
> 标签：c#, obfuscation, reverse-engineering

[正如在此处](https://stackoverflow.com/questions/506282/protect-net-code-from-reverse-engineering/506301#506301)和[此处](https://stackoverflow.com/questions/71195/should-you-obfuscate-a-commercial-net-application)的类似问题中所讨论的，我想保护我的代码免受逆向工程的影响。

我的情况就像[Simucal](https://stackoverflow.com/users/2635/simucal)在他的（优秀）回答中所描述的[那样](https://stackoverflow.com/questions/506282/protect-net-code-from-reverse-engineering/506301#506301)：

> 基本上，归根结底，您成为源盗窃目标的唯一机会是，如果您有一些与您的域相关的非常具体、难以设计的算法，可以让您在竞争中占得先机。这几乎是唯一一次尝试对应用程序的一小部分进行逆向工程具有成本效益。

我正好有这种情况。一种难以设计的算法，它对我们的特定领域来说既优雅又有价值。

经过几个月的微调和开发，最终结果非常紧凑（大约 100 行代码）且优雅。我想保护代码的这个特定部分免受逆向工程的影响，或者至少让它变得合理困难。

该场景是一个用 C# 编写的富客户端应用程序，我必须部署这部分代码 - 我无法从 Web 服务执行它。

我认为由于性能原因（和跨界问题），提取代码并将其重写为非托管本机二进制文件不是一种选择。

最初我想做简单的混淆，但考虑到代码的体积很小，我认为这不会提供太多保护。

理想情况下，我想保护我的整个应用程序，但有两个主要问题似乎使普通混淆器和 3rd 方打包器难以使用：

1.  应用程序提供了一个插件接口，因此一些程序集（和接口/类）不应该被混淆和打包

2.  我们仍然希望在收到错误报告时能够获得真正的堆栈跟踪——这可能是通过我将混淆映射到真实代码来完成的。

撇开这些问题不谈（尽管我也希望对此有任何意见），什么是保护我的一小部分代码免受逆向工程的好方法？我不关心任何人更改或破解代码，但希望使其难以理解和逆向工程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T07:02:15.790

这是不可能的。如果你的代码可以运行，那么它就可以被阅读和逆向工程。你所能做的就是让它变得更难一点，相信我，它只会更难*一点*。你可能不喜欢这个事实，但大多数饼干在破解方面比其他任何人都更擅长让事情变得难以破解。保护您的代码所付出的努力通常是不值得的，特别是如果它不利于您的付费客户。见证 DRM 的惊人失败。

我的建议是不要担心。如果您的算法真的很新颖，请寻求专利（尽管 Bilski 的决定会变得有点困难，除非您将其与特定的硬件实现联系起来）。依靠商业秘密也是没有用的，除非您只将您的软件分发给那些签署合同以确保他们不会允许不受限制的访问的人。然后，你必须有办法对此进行监管。一旦您将二进制文件放到互联网上或在没有合同的情况下分发它们，我相信您将被视为失去商业机密状态。

依赖许可也充满危险——您可能认为您可以在您的许可中插入禁止逆向工程的条款，但世界各地的许多司法管辖区都明确禁止这些条款。无论如何，负责大部分破解的俄罗斯暴徒不太可能遵守上述规定。

您为什么不专注于让您的产品做到最好呢？目标是保持领先于人群，而不是完全将他们拒之门外。在竞争激烈的群体中率先交付并始终拥有最好的产品将确保您的繁荣远胜于将大量精力浪费在无用的保护 (IMNSHO) 上。

这只是我的看法。我可能错了。我以前错了，你只需要问我妻子:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T05:43:21.750

除了混淆之外，它几乎毫无价值，甚至微软（[ScottGu](http://weblogs.asp.net/Scottgu/)等）基本上都说具有适当意图和能力的人会对应用程序进行逆向工程，而在 .NET 中，基本防御是许可和 IP，而不是试图通过保护您的代码默默无闻或其他一些防止逆向工程的方法。

这就是为什么他们发布 BCL 源而不是保密的部分原因。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T05:47:12.520

你应该混淆完整的代码，因为它更难到达那个有价值的小部分。代码越小，就越容易理解。大多数混淆器不应该与公共接口混淆，因为那里有许多混淆库。

但是我认为你应该让用户相信那里没有特殊的技巧，而不是试图隐藏它。引用 Kaiser Soze 的话，“魔鬼曾经使用过的最大伎俩就是让世界相信他不存在”。

当然，您可以随时为您的发明申请专利并合法保护自己。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T05:53:55.437

一种选择是使用许可证密钥和/或硬件指纹在运行时解密敏感代码并将其作为 IL 发出；这将使其对静态逆向工程工具（例如反射器）不可见

还检测调试器的存在并拒绝在调试模式下运行，除非在非常有限的情况下（即在您的机器上）

请注意，这将使您的调试变得非常困难，而对其他人来说几乎是不可能的（如果这是一个最终用户应用程序，这不是问题，但如果它是一个库或框架供其他开发人员构建，那就是一个问题）

另请注意，将物理内存复制到磁盘并在内存转储上使用脱机工具将揭示您的解密算法，因此它很容易被击败 - 但比大多数人会烦恼的麻烦要多得多

整个事情是在您的困难与对少数坏苹果的威慑与因盗窃/抄袭造成的潜在损失之间进行权衡

祝你好运，让我们知道你的决定！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T06:32:46.373

如果你的代码那么敏感，就把它放在没人能拿到的地方。

EG 提供客户端或网页供人们访问某些公开您的功能的服务。

该服务可以位于外部防火墙后面，并与运行敏感代码的内部防火墙后面的后端服务器通信。

为了采取额外措施，请混淆该代码。

这将需要在访问您的代码之前损害几层安全性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T06:03:16.100

您可以在 C# 或 CIL 级别对其进行混淆，但真正无法做到的是 IL 编译器**旨在**创建可以实际执行的最有效的机器代码。

因此，要对您的算法进行逆向工程，请获取机器代码并在其上运行标准反汇编工具。通过从标准输入 API 调用到标准输出 API 调用，跟踪系统中的数据。

面对它，如果有人想要它，他们可以拥有它。

你**可以**让它很难随便弄清楚。例如，我想查看某个由 Java 应用程序管理的数据库中的内容。事实证明，Java 反编译真的很混乱，充满了奇怪的函数、类和名称空间，它们都同名，故意试图隐藏真正发生的事情。

我本**可以**修复我正在使用的反编译器，以便将所有内容重命名为 A_namespace 而不仅仅是 A，然后函数流将直接弹出到 Eclipse 调用跟踪图中。

相反，我只是举起双手继续实际工作，而不是重写反编译器。

所以，你当然可以把它隐藏起来，不让那些随便感兴趣的人看到。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T06:48:25.493

大多数混淆器允许您指定要防止混淆的方法/类。[例如， SmartAssembly](http://www.smartassembly.com)允许您使用属性标记方法或类，而其他允许您选择 UI 中的方法以从流程中排除。你应该能够对过程进行非常精细的控制，这样你就可以吃蛋糕了。

但是，如果您使用反射，您会遇到问题。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-02-25T05:52:41.837

我听说过关于[Spices.Net Obfuscator](http://www.9rays.net/Products/Spices.Obfuscator/)的好评。它应该能够大大增加获得算法所需的时间。

# c# - 计算每天更改值的公式的最佳方法是什么？

> ID：584830
> 
> 赞同：1
> 
> 时间：2009-02-25T05:40:32.177
> 
> 标签：c#, sql, vb.net, stored-procedures

我使用存储在名为 tb_player 的 SQL 表中的以下列：

`Date of Birth (Date)`, `Times Played (Integer)`,`Versions (Integer)`

在以下公式中计算“playvalue”（整数）：

```
playvalue = (Today - Date of Birth) * Times Played * Versions 
```

我可以随时在网页上显示多达 100 条这些记录以及相关的播放值。

我的问题是，由于（今天出生日期）的变化，计算这个游戏价值的最有效方法是什么，因为它每天只变化一次？其他值（播放次数和版本）保持不变。

有没有比每次为 100 条记录即时计算更好的方法？如果是这样，在存储过程或 VB.NET/C# 中进行计算是否更有效？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T05:52:01.603

在对象的属性/方法中，在 C#/VB.NET（您的 .NET 代码）中。

与在进程外调用数据库的时间（首先获取行）或网页的传输时间相比，执行这样一个简单属性的时间**微不足道；**如果只是将它用于 UI 显示，您将**永远不会注意到它。**此外，它位于您易于扩展的硬件（应用程序服务器）上，并且不会每天进行大量更新，并且仅针对实际显示的行执行，并且仅在您实际查询此属性/方法时才执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T05:54:28.917

您是否发现这实际上导致了性能问题？我不认为这会很糟糕，因为计算是非常简单的数学。

但是，如果您真的关心它，我的方法是基本上在 tb_player 表中设置一个“playvalue 缓存”列。此列将存储当天为每个玩家计算的“游戏价值”。将 cronjob 或计划任务设置为每天午夜运行，并使用新日期的值更新此列。

那么其他的一切都可以简单地选择这一列而不是进行计算，并且您只需每天进行一次计算。

# svn - TortoiseHG 和 TortoiseSVN 一起玩得好吗？

> ID：584839
> 
> 赞同：14
> 
> 时间：2009-02-25T05:43:52.623
> 
> 标签：svn, mercurial, tortoisesvn, tortoisehg

我先安装了 TSVN 并使用了很长时间。然后我安装了 T-HG，当我右键单击时，我没有看到任何 TortoiseHG。

有没有人有同样的问题？

所有的 T-SVN 覆盖仍然存在。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-04T22:33:19.447

从 0.8 版开始（2009-07-01 发布）TortoiseHg 支持 Windows Vista 64 位资源管理器 shell 集成。感谢新的 C++ shell 扩展（我为此做出了重大贡献）。

检查当前版本 TortoiseHg-0.8.1-hg-1.3.1.exe 可从[http://bitbucket.org/tortoisehg/stable/downloads/](http://bitbucket.org/tortoisehg/stable/downloads/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-11T01:16:33.700

**编辑**此信息已过时。

**编辑：**我认为这与使用 Windows XP **x64**的我有关，请参见[此处](http://bitbucket.org/tortoisehg/stable/wiki/FAQ#does-tortoisehg-work-on-vista)：

TortoiseHg 可以在 Vista 上运行吗？

TortoiseHg => 0.4 确实适用于 32 位 Windows Vista，但在 64 位 Vista 上仍然存在问题。上下文菜单在 64 位 Windows 资源管理器中不起作用。您必须使用 32 位 Windows 资源管理器，如下所述。叠加层和上下文菜单确实适用于第三方 32 位文件管理器，例如 FreeCommander 或 TotalCommander。

另请注意，Vista 上使用的 GTK 主题在 0.7 之前的版本上存在问题。在 0.7 版中，我们将默认主题更改为在 Vista 上正常工作的主题。在 0.7.1 中，我们升级了 GTK，因此即使是旧的 MS-Windows 主题也可以在 Vista 上正常工作。如何让上下文菜单在 64 位 Vista 上运行？

问题是 Windows 资源管理器是 64 位进程，64 位进程无法直接与 32 位库通信。不过，幸运的是 Vista 64 附带了 32 位版本的资源管理器。要启动 32 位版本的资源管理器，请使用以下设置创建快捷方式： 目标：%windir%\syswow64\explorer.exe /separate Start In: %windir%\syswow64\

通过这个 Explorer 实例，您可以访问 TortoiseHg shell 扩展。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-02-17T01:49:17.797

第 1 天，是的。TortoiseHG（0.9.3 通过 Kiln Client 在 FogBugz 下载）和 TortoiseSVN（1.6.7，Build 18415 - 64 Bit，2010/01/22 17:55:06）在 Windows 7 x64 上似乎没有问题。

在资源管理器中右键单击会为您提供两个子菜单，并且覆盖对于两种类型的存储库似乎都可以正常工作。

我没有太努力地在同一个地方创建这两种类型的 pf 存储库，但似乎 Subversion 不会在已经有 Mercurial (Hg) 存储库的地方创建一个。然而，HG 似乎很乐意在与现有 SVN 存储库相同的地方创建一个存储库。我没有测试两个存储库是否正确同步，所以要小心。在你愤怒地使用它之前测试它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T21:16:45.647

我看到和你一样的问题。我安装了 TortoiseSVN，但无法让 TortoiseHG 或 TortoiseGit 工作。只有 TortoiseSVN 显示在上下文菜单中。运行 64 位 Vista。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T13:48:20.567

在一台机器（Windows 2000 机器）上，我也遇到了这个问题。在我的另一台 XP 机器上，我让两人幸福地生活在一起。

当我升级 T-Svn 时，XP 机器最近的覆盖消失了。我通过重新安装两者来解决问题。也许这就是你的答案，修复你的右键菜单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T09:15:26.060

我的vista和XP都有这个，没问题。我什至有一个由其中 2 个控制的文件夹版本，但如果出现覆盖问题，我会编写 2 个脚本以确保其中只有一个处于活动状态：

EnableHg.cmd：

```
FOR /R %%f IN (.svn) DO IF EXIST "%%f" 
     ATTRIB -h "%%f"
     RENAME "%%f" 3.svn
     ATTRIB +h "%%f"
)
move 3.hg .hg 
```

启用S​​VN.cmd：

```
move .hg 3.hg
FOR /R %%f IN (3.svn) DO IF EXIST "%%f" (
     ATTRIB -h "%%f"
     RENAME "%%f" .svn
     ATTRIB +h "%%f"
)
move 3.hg .hg 
```

然后，我更新了我的 svn 和 hg 忽略模式，以确保两个 cmd 文件都被两者忽略，并且 svn 忽略 *.hg 文件夹、.hgignore 文件和 hg 忽略 *.svn 文件夹。

参考：[Re：VS 的 TSvn 命令行更新](http://svn.haxx.se/tsvn/archive-2005-11/0126.shtml)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-23T02:47:03.420

您可以在 Vista 中启动 32 位版本的资源管理器。启动 32 位版本时将显示 T-HG 快捷方式。

要在 64 位 Vista 中启动 32 位版本的资源管理器，请使用目标创建快捷方式：%Systemroot%\SysWOW64\explorer.exe /separate

当您使用快捷方式启动资源管理器时，它应该可以工作。

# linq-to-sql - linq-to-sql 中的公用表表达式（CTE）？

> ID：584841
> 
> 赞同：32
> 
> 时间：2009-02-25T05:44:37.050
> 
> 标签：linq-to-sql, common-table-expression

是否可以在 Linq to SQL 中执行公用表表达式 (CTE)（如下所示）。我对 CTE 和 Linq to SQL 还是很陌生。

我目前是免费的存储过程（但不以任何方式反对它们）所以我不想仅仅为了一个查询就跳到存储过程，除非它是完全必要的。

这是我在 SQL 中所做的一个示例，我想知道我是否可以在 Linq to SQL 中做：

```
WITH TaskHierarchy (TaskID, [Subject], ParentID, HierarchyLevel, HierarchyPath) AS
(
   -- Base case
   SELECT
      TaskID,
      [Subject],
      ParentID,
      1 as HierarchyLevel,
      CONVERT(VARCHAR(MAX),'/') AS HierarchyPath
   FROM Task
   WHERE TaskID = 2

   UNION ALL

   -- Recursive step
   SELECT
      t.TaskID,
      t.Subject,
      t.ParentID,
      th.HierarchyLevel + 1 AS HierarchyLevel,
      CONVERT(varchar(MAX),th.HierarchyPath + CONVERT(VARCHAR(32),t.ParentID) + '/') AS HierarchyPath
   FROM Task t
      INNER JOIN TaskHierarchy th ON
         t.ParentID = th.TaskID
)

SELECT *
FROM TaskHierarchy
ORDER BY HierarchyLevel, [Subject] 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-25T05:55:07.977

AFAIK，对象模型不支持这一点。但是，LINQ 支持执行查询的方法（很奇怪，称为 DataContext.ExecuteQuery）。看起来您可以使用它来调用任意一段 SQL 并将其映射回 LINQ。由于嵌入式 SQL，您不会免费使用 SQL，但您不必使用存储过程。

[如何：直接执行 SQL 查询 (LINQ to SQL)](http://msdn.microsoft.com/en-us/library/bb399403.aspx)

# mysql - 有没有办法确定 MySQL 正在使用什么配置文件？

> ID：584850
> 
> 赞同：0
> 
> 时间：2009-02-25T05:47:43.517
> 
> 标签：mysql

我可以在 MySQL 中运行一个命令来确定 MySQL 使用的位置/哪个配置文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T05:51:16.940

从 5.0 版开始，没有。但是看看[确定正在使用哪个配置文件](https://stackoverflow.com/questions/580331/mysql-how-to-determine-which-config-file-is-being-used)，如何从MySQL*外部查看。*

# .net - Windows - 将键盘键映射到与鼠标左键相同的操作

> ID：584855
> 
> 赞同：3
> 
> 时间：2009-02-25T05:51:06.723
> 
> 标签：.net, windows, keyboard, keyboard-shortcuts, mouse

是一种编程方式（或更简单的方式）将某些键盘键映射到与 Windows XP / Vista 中的鼠标左键相同的操作窗口。如果程序化有没有办法在 .NET 2.0（或更高版本）中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T05:55:34.013

有一种编程方式，在 C# 中可以使用全局挂钩。但是我发现像[AutoHotkey](http://www.autohotkey.com/)这样的工具是为这类事情设计的，启动和运行起来要快得多。脚本也可以编译为可执行文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T06:03:07.520

您还可以通过辅助功能选项打开辅助功能鼠标键

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T10:37:45.850

什么是“辅助功能鼠标键”。

在我的 Windows XP SP2 中，“辅助功能选项”中没有该选项。

我想将键盘按键映射到鼠标左键 DOUBLE-CLICK 并且正在寻找非常简单的工具或控制面板扩展来执行此操作并将按键映射到单击鼠标...（查看 Autohotkey，但可以还没有看到如何双击）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T14:42:08.460

鼠标键是无用的功能。首先，虽然它模拟鼠标移动，但它不允许右键单击，并且拖放而不是简单地单击的功能在我的 XP 副本中根本不起作用。此外，您仅限于使用数字键盘 5 键进行单击（并且据说插入/删除键，除了距离数字 5 足够远而令人头疼之外，是将这些功能分配给的可怕键) 这对于像我这样的右派来说一点也不方便。并且不要让问题更加令人沮丧，即使在所有 Windows 文献中只有一个词“鼠标键”，要在其可悲的索引中找到拖放帮助文章需要搜索“鼠标键”。典型的。我正在使用 Autohotkey，至少在我获得 Linux 之前是这样。

# excel - 使用 ASP 导出到 Excel

> ID：584863
> 
> 赞同：1
> 
> 时间：2009-02-25T05:54:07.370
> 
> 标签：excel, asp-classic

在使用 ASP 导出到 excel 时。将一列转换为文本格式后，在 Excel 文件中可以看到单引号。如何自动隐藏它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T21:26:32.643

将单元格的样式设置为 mso-number-format:"\@" 可能会对您有所帮助，但我必须查看您的代码才能知道确切的问题。

我想您可能会发现[使用 mso-number-format 设置 Excel 单元格样式](http://www.netdominus.co.uk/knowledgebase/mod/resource/view.php?id=182)和[在 ASP Classic 中生成 Excel 文件](http://www.crydust.be/blog/2009/03/02/generate-excel-files-in-asp-classic/)很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-22T00:46:08.600

当您导出到 excel 时，您可以用单元格制作一个表格，并将您的值放入双引号中。Excel 将正确读取它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-23T12:07:05.720

这是我用来将数据导出到 Excel 2007 (.xlsx) 文件的库。

它允许您使用一行代码将任何 DataSet、DataTable 或 List<> 直接导出到 Excel 2007 文件中。

它是完全免费的，您可以在此处下载源代码（并查看如何使用它）：http: [//www.mikesknowledgebase.com/pages/CSharp/ExportToExcel.htm](http://www.mikesknowledgebase.com/pages/CSharp/ExportToExcel.htm)

# python - 通过 FTP 确定列表是否是 Python 中的目录或文件

> ID：584865
> 
> 赞同：6
> 
> 时间：2009-02-25T05:54:36.467
> 
> 标签：python, ftp

Python 有一个标准库模块`ftplib`来运行 FTP 通信。它有两种获取目录内容列表的方法。一个, `FTP.nlst()`, 将返回给定目录名称作为参数的目录内容列表。（如果给定文件名，它将返回文件名。）这是一种列出目录内容的可靠方法，但不提供任何指示列表中的每个项目是文件还是目录。另一种方法是`FTP.dir()`，它给出作为参数给出的目录的目录内容的字符串格式列表（或文件属性，给定文件名）。

根据[Stack Overflow 上的一个问题](https://stackoverflow.com/questions/111954/using-pythons-ftplib-to-get-a-directory-listing-portably)，解析结果`dir()`可能很脆弱（不同的服务器可能返回不同的字符串）。不过，我正在寻找某种方法来仅列出通过 FTP 包含在另一个目录中的目录。据我所知，在字符串的权限部分抓取 a`d`是我想出的唯一解决方案，但我想我不能保证权限会出现在不同服务器之间的同一个位置。是否有更强大的解决方案来识别通过 FTP 的目录？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T09:04:16.667

不幸的是，FTP 没有仅列出文件夹的命令，因此解析从 ftp.dir() 获得的结果将是“最好的”。

一个简单的应用程序，假设来自 ls 的标准结果（不是 windows ftp）

```
from ftplib import FTP

ftp = FTP(host, user, passwd)
for r in ftp.dir():
    if r.upper().startswith('D'):
        print r[58:]  # Starting point 
```

[标准 FTP 命令](http://www.hiteksoftware.com/help/English/FtpCommands.htm#ftp%20commands)

[自定义 FTP 命令](http://www.hiteksoftware.com/help/English/FtpCommands.htm#custom%20commands)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-24T23:19:03.103

如果 FTP 服务器支持该`MLSD`命令，请检查几个有用类（和）[的答案。](https://stackoverflow.com/questions/2867217/how-to-delete-files-with-a-python-script-from-a-ftp-server-which-are-older-than-7/3114477#3114477)`FTPDirectory``FTPTree`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T19:41:06.893

另一种方法是假设所有内容都是一个目录并尝试更改为它。如果成功，它是一个目录，但如果这抛出一个 ftplib.error_perm 它可能是一个文件。您可以先捕获然后捕获异常。当然，这并不是最安全的，但也不是为前导 'd' 解析疯狂的字符串。

例子

```
def processRecursive(ftp,directory):
    ftp.cwd(directory)
    #put whatever you want to do in each directory here
    #when you have called processRecursive with a file, 
    #the command above will fail and you will return

    #get the files and directories contained in the current directory
    filenames = []
    ftp.retrlines('NLST',filenames.append)
    for name in filenames:
        try:
            processRecursive(ftp,name)
        except ftplib.error_perm:
            #put whatever you want to do with files here

    #put whatever you want to do after processing the files 
    #and sub-directories of a directory here 
```

# c - 从 C 重新路由标准输入和标准输出

> ID：584868
> 
> 赞同：74
> 
> 时间：2009-02-25T05:55:45.747
> 
> 标签：c, redirect, stdio

我想重新打开`stdin`and `stdout`（也许`stderr`当我在它的时候）文件句柄，以便将来调用`printf()`or`putchar()`或`puts()`将转到文件，并且将来调用`getc()`and 这样将来自文件。

1) 我不想永久丢失标准输入/输出/错误。我可能想稍后在程序中重用它们。

2）我不想打开新的文件句柄，因为这些文件句柄必须被大量传递或全局传递（不寒而栗）。

3）如果我不能帮助的话，我不想使用任何`open()`或其他系统相关的功能。`fork()`

所以基本上，这样做是否有效：

```
stdin = fopen("newin", "r"); 
```

而且，如果是这样，我怎样才能得到`stdin`back 的原始值？我必须将其存储在 a 中`FILE *`，然后再将其取回吗？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-02-25T15:19:38.683

为什么使用[`freopen()`](http://en.cppreference.com/w/c/io/freopen)？C89 规范在以下部分的尾注之一中有答案`<stdio.h>`：

> 116\. 该**`freopen`**函数的主要用途是更改与标准文本流（、、或）关联的文件**`stderr`**， **`stdin`**因为**`stdout`**这些标识符不需要是可修改的左值，**`fopen`**函数返回的值可以分配给这些左值。

`freopen`经常被误用，例如`stdin = freopen("newin", "r", stdin);`. 这并不比`fclose(stdin); stdin = fopen("newin", "r");`. 两个表达式都尝试分配给`stdin`，但不能保证是可分配的。

正确的使用方式`freopen`是省略赋值：`freopen("newin", "r", stdin);`

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-25T05:58:57.530

我想你正在寻找类似的东西[`freopen()`](http://www.cplusplus.com/reference/clibrary/cstdio/freopen.html)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-06-03T23:21:54.740

这是 Tim Post 方法的修改版本；我使用 /dev/tty 而不是 /dev/stdout。我不知道为什么它不适用于标准输出（这是 /proc/self/fd/1 的链接）：

```
freopen("log.txt","w",stdout);
...
...
freopen("/dev/tty","w",stdout); 
```

通过使用 /dev/tty，输出被重定向到启动应用程序的终端。

希望这些信息有用。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-25T06:22:58.253

**os 函数[dup2()](http://www.mkssoftware.com/docs/man3/dup2.3.asp)应该提供你需要**的东西（如果没有引用你需要的东西）。

更具体地说，您可以 dup2() 将标准输入文件描述符复制到另一个文件描述符，使用标准输入执行其他操作，然后在需要时将其复制回来。

> dup() 函数复制打开的文件描述符。具体来说，它使用 F_DUPFD 常量命令值为 fcntl() 函数提供的服务提供替代接口，其中第三个参数为 0。复制的文件描述符与原始文件描述符共享任何锁。
> 
> 成功时， dup() 返回一个新的文件描述符，它与原始文件描述符具有以下共同点：
> 
> *   相同的打开文件（或管道）
> *   相同的文件指针（两个文件描述符共享一个文件指针）
> *   相同的访问模式（读、写或读/写）

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-02-25T15:31:53.270

```
freopen("/my/newstdin", "r", stdin);
freopen("/my/newstdout", "w", stdout);
freopen("/my/newstderr", "w", stderr);

... do your stuff

freopen("/dev/stdin", "r", stdin);
...
... 
```

这使我的圆钉方孔表上的针达到顶峰，您要完成什么？

**编辑：**

请记住，stdin、stdout 和 stderr 是每个新创建的进程的文件描述符 0、1 和 2。freopen() 应该保持相同的 fd，只需为它们分配新的流。

因此，确保这实际上是在做你想做的事情的一个好方法是：

```
printf("Stdout is descriptor %d\n", fileno(stdout));
freopen("/tmp/newstdout", "w", stdout);
printf("Stdout is now /tmp/newstdout and hopefully still fd %d\n",
   fileno(stdout));
freopen("/dev/stdout", "w", stdout);
printf("Now we put it back, hopefully its still fd %d\n",
   fileno(stdout)); 
```

我相信这是 freopen() 的预期行为，如您所见，您仍然只使用三个文件描述符（和关联的流）。

这将覆盖任何外壳重定向，因为外壳不会重定向。但是，它可能会破坏管道。您可能希望确保为 SIGPIPE 设置一个处理程序，以防您的程序发现自己位于管道（不是 FIFO，管道）的阻塞端。

因此， ./your_program --stdout /tmp/stdout.txt --stderr /tmp/stderr.txt 应该可以使用 freopen() 轻松完成并保持相同的实际文件描述符。我不明白的是，为什么您需要在更改它们后将它们放回去？当然，如果有人通过了任何一个选项，他们会希望它一直持续到程序终止吗？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-25T06:27:12.707

`freopen`解决简单的部分。如果您没有阅读任何内容并且愿意使用诸如`dup`or之类的 POSIX 系统调用，那么保留旧的标准输入并不难`dup2`。如果你开始阅读它，所有的赌注都没有了。

也许您可以告诉我们这个问题发生的背景？

我鼓励你坚持那些你愿意放弃旧的`stdin`并且`stdout`因此可以使用`freopen`.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-07-21T06:39:09.353

同时，有一个 C 源代码库可以为您完成所有这些工作，重定向 stdout 或 stderr。但很酷的部分是它允许您为拦截的流分配任意数量的回调函数，然后您可以非常轻松地将单个消息发送到多个目的地、数据库、文本文件等。

最重要的是，创建外观和行为与 stdout 和 stderr 相同的新流变得很简单，您也可以将这些新流重定向到多个位置。

在 *oogle 上查找 U-Streams C 库。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-28T18:50:58.707

这是最容易获得、最方便和最有用的方法

```
freopen("dir","r",stdin); 
```

# java - 为什么“未选择数据库”SQLException？

> ID：584870
> 
> 赞同：6
> 
> 时间：2009-02-25T05:57:47.237
> 
> 标签：java, jdbc

为什么这个程序在第二次进入 do while 循环时没有执行以及为什么它给出异常“Exception java.sql.SQLException: [MySQL][ODBC 5.1 Driver][mysqld-5.0.51a-community-nt ]未选择数据库”

```
//import java.io.InputStream;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Scanner;
import java.util.Vector;

public class DataBase {

    public void LoadDriver() {

        // Load the JDBC-ODBC bridge driver
        try {
            Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
        } catch (ClassNotFoundException ee) {
            ee.printStackTrace();
        }
    }

    // 2.open a data source name by means of the jdbcodbcdriver.

    static void connect() throws SQLException {

        // Connect to the database
        Connection con = DriverManager.getConnection("jdbc:odbc:MySQL", "root", "admin");
        Statement stmt = con.createStatement();
        // Shut off autocommit
        con.setAutoCommit(false);

        System.out.println("1.Insert 2.Delete 3.Update 4.Select");
        Scanner s = new Scanner(System.in);
        int x;
        x = s.nextInt();

        String query; // SQL select string
        ResultSet rs; // SQL query results
        boolean more; // "more rows found" switch
        String v1, v2; // Temporary storage results

        Vector<Object> results = new Vector<Object>(10);

        if (x == 1) {

            try {
                stmt.executeUpdate("INSERT INTO employee( emp_id,emp_name ) VALUES ( '122','shiva' ) ");
            } catch(Exception e){System.out.println("Exception " +e);e.printStackTrace();}
        }

        if (x == 2) {

            try {
                stmt.executeUpdate("DELETE from employee where emp_id='102' ");
            }catch(Exception e){System.out.println("Exception "+e);e.printStackTrace();} 
        }

        if (x == 3) {

            try {
                stmt
                        .executeUpdate("UPDATE employee SET emp_name = 'madavan' where emp_id='20'; ");
            } catch(Exception e){System.out.println("Exception "+e);e.printStackTrace();} 
        }

        query = "SELECT * FROM employee ";
        try {
            rs = stmt.executeQuery(query);
            // Check to see if any rows were read
            more = rs.next();
            if (!more) {

                System.out.println("No rows found.");
                return;
            }

            // Loop through the rows retrieved from the query
            while (more) {

                v1 = "ID: " + rs.getInt("emp_id");
                v2 = "Name: " + rs.getString("emp_name");

                System.out.println(v1);
                System.out.println(v2);
                System.out.println("");

                results.addElement(v1 + "\n" + v2 + "\n");

                more = rs.next();
            }
            rs.close();

        } catch (SQLException e) {
            System.out.println("" + results.size() + "results where found.");
        } 
        finally{stmt.close();}
    }

    public static void main(String[] args) throws SQLException {
        String str = "y";
        do {
            DataBase s = new DataBase();
            s.LoadDriver();
            DataBase.connect();
        Scanner sc = new Scanner(System.in);
        System.out.println("DO u Want to PROCEED TO QUERY : ");
        str = sc.next();
        } while (str !="n");
    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T06:22:57.473

除非您必须使用 jdbc/odbc 驱动程序，否则我将使用直接的 mysql jdbc 驱动程序。你可以从 mysql 免费下载。

然后

```
public void LoadDriver() {

        // Load the JDBC-ODBC bridge driver
        try {
                Class.forName("com.mysql.jdbc.Driver");
        } catch (ClassNotFoundException ee) {
                ee.printStackTrace();
        }
}

static void connect() throws SQLException {

        // Connect to the database
        Connection con = DriverManager.getConnection("jdbc:mysql:host/databasename", "root", "admin");
        Statement stmt = con.createStatement();
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T06:07:38.197

仅从查看异常.. 我猜您没有指定数据库。如何在不告诉它从哪个模式中选择的情况下对表进行选择？这通常在连接字符串中设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T08:08:32.620

ODBC 源是否实际设置为选择数据库？例如。您可以通过另一个 ODBC 客户端工具访问数据库吗？

如果您需要在 JDBC 字符串中显式选择一个数据库，您可以使用 'database' 参数来完成。

但是在 ODBC 设置中选择数据库会更常见。事实上，正如 Clint 所提到的，使用普通的 MySQL JDBC 驱动程序而不是 ODBC 会更常见。

> 而 (str !="n")

[这不是您在 Java 中比较字符串的方式。](http://www.owasp.org/index.php/Java_gotchas#Equality)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T06:23:48.063

[在 MySQL](http://bugs.mysql.com/bug.php?id=3920)上发现了一个错误列表，它给出了这个错误，但使用了不同的技术。但是，在描述中它表明它与重新授权有关，而不是发送数据库信息，所以也许这也是您在这里遇到的情况。

有些事情对我来说很奇怪（尽管不知道它们是否会对您的错误产生任何影响）

*   您只需要加载一次驱动程序管理器
*   您没有关闭连接，因此请关闭它或重构以使用相同的连接。

也许将这两行移到`do`循环之前

```
DataBase s = new DataBase();
s.LoadDriver(); 
```

# c# - 无需大量转换即可创建和初始化不同的子类型

> ID：584871
> 
> 赞同：3
> 
> 时间：2009-02-25T05:58:13.697
> 
> 标签：c#, .net, generics

我敢肯定，在下面的这段代码中，我会搞砸很多演员表等。似乎应该有一个更顺畅的方式。我基本上是在尝试使用构建器方法（CreateNewPattern）来处理创建传递的子类类型的新对象（通过 CreateNewCircularPattern 和 CreateNewLinePattern 方法）。我目前只有两个继承自 HolePattern 的子类 CircularHolePattern 和 SingleLineHolePattern，但随着我的应用程序的增长，我希望会有更多。

这是使用委托还是 lambda 的地方？它对它们一无所知，因此请尽可能具体地提供代码建议。

```
private CircularHolePattern CreateNewCircularPattern()
{
   var CreatedPattern = CreateNewPattern(typeof(CircularHolePattern));
   return (CircularHolePattern)CreatedPattern;
}

private SingleLineHolePattern CreateNewLinePattern()
{
   var CreatedPattern=CreateNewPattern(typeof(SingleLineHolePattern));
   return (SingleLineHolePattern)CreatedPattern;
}

private HolePattern CreateNewPattern(Type PatternTypeToCreate)
{
    var NewHolePattern = (HolePattern)Activator.CreateInstance(PatternTypeToCreate);
    NewHolePattern.PatternName = "Pattern #" + (HolePatterns.Count + 1).ToString();
    this.AddPattern(NewHolePattern);
    this.SetActivePattern(NewHolePattern);
    return NewHolePattern;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T06:05:28.843

我怀疑你想要泛型：

```
private T CreateNewPattern<T>() where T : HolePattern, new()
{
    var newHolePattern = new T();
    newHolePattern.PatternName = "Pattern #" +
        (HolePatterns.Count + 1).ToString();
    this.AddPattern(newHolePattern);
    this.SetActivePattern(newHolePattern);
    return newHolePattern;          
}

private SingleLineHolePattern CreateNewLinePattern() {
    return CreateNewPattern<SingleLineHolePattern>();
}

private CircularHolePattern CreateNewCircularPattern() {
    return CreateNewPattern<CircularHolePattern>();
} 
```

是`T`泛型类型参数；我们要创建的类型。上面写着“`where`它必须是`HolePattern`或子类型，并且它必须有一个公共的无参数构造函数”——这让我们可以使用`new T()`它来创建它的一个新实例，并针对这些实例访问所有成员`HolePattern`（例如`PatternName`）。这也允许我们调用接受 a`HolePattern`作为参数的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T06:07:15.750

一方面，您可以将 Create...Pattern 方法减少到

```
private CircularHolePattern CreateNewCircularPattern()
{
   return CreateNewPattern(typeof(CircularHolePattern));
} 
```

另一个建议可能是只在抽象中工作。例如，仅从 Create...Pattern 方法返回 HolePattern 类型，而不是它们的具体类型，例如 CircularHolePattern。在任何情况下，您都将它们转换为 HolePattern。

所以， CreateNewCircularPattern 变成

```
private HolePattern CreateNewCircularPattern()
{
   return CreateNewPattern(typeof(CircularHolePattern));
} 
```

# html - 如何制作显示父页面的 iframe

> ID：584873
> 
> 赞同：1
> 
> 时间：2009-02-25T05:59:17.750
> 
> 标签：html, iframe, uri

我想在 .aspx 页面中显示 iframe，并且 iframe 源应该是同一页面。

我需要使用相对 uri。

我应该赋予“src”属性什么值？

我意识到这有点不寻常——页面将根据传入的参数以不同的状态显示，因此 iframe 不会在其自身中显示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T06:10:32.637

如果你这样做，你会得到一个无限循环......进程将“永远不会结束”。也许这就是为什么它是白色的？它真的在处理页面.. - 那是你想要的吗？例如，如果您只想要 2-3 页的深度，您可以使用查询字符串，例如当查询字符串增加到 3 时禁用 iframe。 MyPage.aspx?depth=1 --MyPage.aspx?depth=2 --MyPage .aspx?depth=3 等

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T06:00:43.580

文字相对路径应该有效。即：MyPage.aspx

这是一个 ASP.NET 示例...

似乎对我来说很好用以下......

标记：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="WebApplication2._Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
    <iframe runat="server" id="myFrame" src="Default.aspx?message=Hello%20World"></iframe>
    <div id="myDiv" runat="server"></div>
    </div>
    </form>
</body>
</html> 
```

代码背后：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace WebApplication2
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            string message = Request.QueryString["message"];
            if (null != message)
            {
                myDiv.InnerText = message;
                myFrame.Visible = false;
            }
            else
            {
                myDiv.Visible = false;
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T06:57:51.447

简短的回答是 iframe 标记中的 src="localfilename.aspx" 。宽松应用的网络标准说，任何没有以“/”开头的内容都是相对于当前页面的位置。有时 src="" 甚至可以用于替换当前文件名（在浏览器级别）

# .net - 互操作定义在其原始许可下的涵盖程度如何

> ID：584879
> 
> 赞同：0
> 
> 时间：2009-02-25T06:02:21.220
> 
> 标签：.net, licensing

我有[一个为视频文件创建缩略图的项目](http://github.com/sambo99/Media-Browser/tree/230114f3fdb977c279a079af4ef57ce0d662a629/FrameGrabProvider/DirectShowLib)，它很大程度上基于[directshow.net](http://directshownet.sourceforge.net/index.html)中的互操作定义。

目前媒体浏览器是 GPL，所以一切都是兼容的，我很高兴剪切和粘贴这段代码（因为它的所有属性都正确）。

但是...我正在考虑将此代码包含在衍生的 MIT 许可项目中。这让我有点不知所措。

Directshow.net 在 LGPL 下获得许可，这意味着我可以依赖该 DLL。但是......我不能真正包含限制较少的许可证下的代码。

有问题的文件是互操作定义，可以通过阅读 MSDN 并将内容转换为 C# 轻松/繁琐地定义，如果我手动执行此操作，我很可能会得到相同的代码（或非常相似的代码）。

我站在哪里？如何将此功能纳入我的 MIT 许可项目？

相关： http: [//sourceforge.net/forum/forum.php ?thread_id=3040125&forum_id=460697](http://sourceforge.net/forum/forum.php?thread_id=3040125&forum_id=460697)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T12:29:01.567

把所有的代码做成一个DLL，就可以了。根据 LGPL 的条款，您可以将其作为共享库从您想要的任何项目链接到它；许可要求仅涵盖 LGPL DLL 本身。它必须是 LGPL，但你的项目的其余部分不会。

如果您想将库的代码*静态*链接到可执行文件中，事情会变得有点棘手。LGPL 的重点是最终用户必须拥有自行修改（尤其是升级）库功能的自由。如果它是一个独立的 DLL，那么只需将一个 DLL 换成另一个即可。如果你拿代码并静态链接它，那就没那么简单了。那么你有两个选择：

1.  使用与 LGPL 兼容的许可证开源整个项目。（这个变得丑陋了。）
2.  向您的用户提供目标代码（提供给链接器的中间阶段编译文件），以便他们可以获取库的更新版本并手动链接它。这是一种丑陋的解决方案，但这是允许的。

最好的办法是只使用 DLL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T07:17:24.747

使用 LGPL，您只需共享（并使用 LGPL 或 GPL 覆盖）源代码，该源代码是相关库的直接派生——即您可以对该库进行的*更改。*任何仅*依赖*于该库的代码（例如通过链接但不更改它）都不受 LGPL 许可的约束——因此您可以根据自己的意愿对其进行 MIT 许可！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T05:37:36.123

此外，界面定义、无“创意”表达（如描述性评论）不受版权保护，如果有记忆的话。如果您包含的唯一代码是这样的“样板”，那么您应该没问题。

当然，我不是律师，现在也找不到开创这个先例的案子。也许某个好心的编辑会觉得有帮助？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T20:11:58.027

这是对接口注释的补充：(L)GPL 是在链接时调用的许可证（其所有措辞都是关于链接时刻的），严格来说，当使用 LGPL 标头时，实际上不会链接任何 LGPL 代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T18:49:02.140

最好避免法律问题并重新创建互操作定义。看看 P/Invoke Interop Assistant。只需将 C++ 标头粘贴到工具中，它就会为您提供绑定。这仍然很乏味，但比手动完成要痛苦得多。

# visual-studio - 将现有表单添加到 C++/CLI WinForms 项目

> ID：584881
> 
> 赞同：7
> 
> 时间：2009-02-25T06:03:11.953
> 
> 标签：visual-studio, winforms, visual-studio-2008, c++-cli

我在不同的解决方案中有两个 C++/CLI 项目 A 和 B。我使用 A 进行实验/测试，并在完成测试后将测试代码移至 B。但是，我发现在向项目 B 添加 Windows 窗体类（标题、cpp 和 resx）时，我不再能够使用 IDE 的可视窗体设计器。我该如何启用它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T06:20:21.410

知道了！

1.  并排打开解决方案资源管理器窗格和属性窗格。
2.  在“解决方案资源管理器”窗格中选择表单类的头文件。
3.  在属性窗格中，选择“文件类型”属性下的“C++ 表单”。

头文件现在将在其名称旁边显示一个表单图标，并在双击时在表单编辑器中打开。

# php - 快速加载网页

> ID：584886
> 
> 赞同：11
> 
> 时间：2009-02-25T06:06:01.540
> 
> 标签：php, javascript, mysql, ajax

我们正计划开发一个新网站。我们的目标是快速加载网页。我们需要遵循的所有技术是什么。

谁能给我好的建议，论坛链接或文章。

我们的平台是 PHP、MySQL、Javascript 和 AJAX。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-25T06:07:49.007

加快网站加载时间的最佳指南之一：

[http://developer.yahoo.com/performance/rules.html](http://developer.yahoo.com/performance/rules.html)

* * *

更新：谷歌现在也有一个很好的指南

[http://code.google.com/speed/page-speed/docs/rules_intro.html](http://code.google.com/speed/page-speed/docs/rules_intro.html)

以及更好[的 Firefox 插件](http://code.google.com/speed/page-speed/)。到目前为止，在我的测试中，Google 的 Page Speed 插件远远优于 YSlow。它提供了更详细的分析和更明智的建议（而不是为像 YSlow 这样的小型网站推荐 CDN）

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-25T06:11:48.903

一个有用的工具是[YSlow](http://developer.yahoo.com/yslow/)，它是 Yahoo 的一个工具，可以帮助识别网页性能问题。此外，雅虎[加速网站的最佳实践](http://developer.yahoo.com/performance/rules.html)是一个很好的列表。

但是，请参阅 Jeff 的博客条目[Yahoo 的问题不是您的问题](http://www.codinghorror.com/blog/archives/000932.html)，以了解有关此问题的一些观点。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-25T06:10:47.783

缓存缓存缓存。

[内存缓存](http://www.danga.com/memcached/)

[装甲运兵车](http://php.net/apc)

选择一个，使用它。不必从数据库中获取所有内容会大大加快速度。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-25T17:07:39.360

雅虎：“将样式表放在顶部”，“将脚本放在底部”。

这比其他任何优化都加快了我最近的网站速度。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-25T17:02:10.043

1) mod_gzip / mod_deflate！这是一个如此简单的修复，我很惊讶它默认没有打开。

2) 玩弄你的 URL，这样你就可以告诉浏览器永远缓存你的 JS 和 CSS 文件。换句话说，将 URL 构造成如下所示：

```
http://www.yourdomain.com/js/mad_scriptz-v123.js 
```

然后使用 mod_rewrite 并去掉“-v123”：

```
<IfModule mod_rewrite.c>
    # http://www.thinkvitamin.com/features/webapps/serving-javascript-fast
    RewriteEngine on

    RewriteRule ^/(.*)\-v[0-9.]+\.(css|js|gif|png|jpg|xap)$ /$1.$2  [L]

</IfModule> 
```

现在 apache 会去寻找“/js/mad_scriptz.js”...每次你改变你的静态内容时，只要增加版本号来强制浏览器重新加载内容。我通常有一个模板变量，其中包含一个全局版本号，一切都与之相关。不是最有效的，但适用于我的目的。如果您可以将版本号绑定到您的构建系统或文件的哈希值，那将更加甜蜜。

获取 mod_expires 以便您的所有静态内容在几年后过期：

```
<IfModule mod_expires.c>
    ExpiresActive On
    # all in seconds...  
    ExpiresByType image/x-icon A2592000
    ExpiresByType image/gif A2592000
    ExpiresByType image/jpeg A2592000
    ExpiresByType image/png A2592000
    ExpiresByType application/javascript A2592000
    ExpiresByType application/x-javascript A2592000
    ExpiresByType application/x-shockwave-flash A2592000
    ExpiresByType application/pdf A2592000
    ExpiresByType text/css A2592000
    ExpiresByType application/rdf+xml A1800
</IfModule> 
```

更新：已经注意到并非所有浏览器或搜索引擎都喜欢 gzip 的内容。不要像我上面建议的那样盲目地打开它。确保即使他们接受了古董浏览器 gzip，您也不要提供它（其中一些人会对压缩的 javascript 感到厌烦）。[mod_gzip](http://schroepl.net/projekte/mod_gzip/browser.htm)和[mod_deflate](http://httpd.apache.org/docs/2.2/mod/mod_deflate.html)的文档都有应该可以正常工作的示例（我假设他们可以，或者人们会通过电子邮件向他们发送更改:-)。

我还应该提到，根据我的经验，如果你在你的 mod_gzip 的 Apache 服务器和世界之间有一个反向代理，你需要小心。Squid 2.6 通常会欺骗 Apache，使其在应该压缩的时候不压缩内容，更糟糕的是，它会缓存未压缩的版本并将它们提供给可以处理 gzip 内容的浏览器。不知道 3.0 是否解决了这个问题，我不知道我的配置是否有问题（怀疑）。请注意:-)

那就是说。打开它。严重地 ：-）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-25T06:10:43.073

*   使用 CSS 精灵来减少您的 HTTP 请求计数。
*   确保所有图像的尺寸都合适。
*   确保您有一个非常好的主机，具有良好的上游和下游。
*   确保您的服务器可以及时执行您的脚本，您可以使用 microtime 功能进行检查。
*   确保您的代码已正确优化。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-25T06:14:03.063

根据需要编写尽可能少的代码，但不要太少。

更少的代码，更少的编译，更少的发送，更少的接收，更少的处理，更少的展示。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-04-14T08:17:26.263

## **1.启用保活**

HTTP Keep Alive 是指在客户端计算机和 Web 服务器之间发送的请求下载文件权限的消息。启用 Keep Alive 允许客户端计算机下载多个文件而无需重复请求权限，这有助于节省带宽。

要启用 Keep Alive，只需将以下代码复制并粘贴到您的 .htaccess 文件中。

```
<ifModule mod_headers.c>
    Header set Connection keep-alive
</ifModule> 
```

## **2.禁用图片盗链**

当其他网站的“热链接”到您的图像时，它会窃取带宽，从而减慢您的网站速度。为了防止其他站点占用您的带宽，您可以将此代码片段添加到您的 .htaccess 文件中。请记住更改显示 your_Domain_name.com 的位！

```
RewriteEngine on
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http(s)?://(www\.)?your_Domain_name.com [NC]
RewriteRule \.(jpg|jpeg|png|gif)$ – [NC,F,L] 
```

## **3\. 使用 gzip 压缩您的网站**

Gzip 是一种用于压缩网站文件以节省带宽并加快页面加载时间的简单方法。Gzip 的工作原理是将您的文件压缩成一个 zip 文件，这样用户浏览器的加载速度会更快。然后用户的浏览器解压缩文件并显示内容。这种将内容从服务器传输到浏览器的方法效率更高，并且节省了大量时间。

您只需将以下代码添加到您的 .htaccess 文件中即可启用 Gzip：

```
# compress text, html, javascript, css, xml:
AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript

# Or, compress certain file types by extension:

SetOutputFilter DEFLATE 
```

要检查 Gzip 是否在您的站点上启用或正常工作，您可以使用 Gziptest.com。

## **4.启用过期标头**

Expires 标头告诉浏览器是否应该从服务器请求特定文件，或者是否应该从浏览器的缓存中获取该文件。

Expires Headers 背后的整个想法不仅是为了减少从服务器下载的负载（在未修改的情况下不断下载相同的文件会浪费宝贵的加载时间），而是为了减少服务器的 HTTP 请求数量。

所以在 .htaccess 文件中包含以下内容

```
<IfModule mod_expires.c>
    # Enable expirations
    ExpiresActive On 
    # Default directive
    ExpiresDefault "access plus 1 month"
    # My favicon
    ExpiresByType image/x-icon "access plus 1 year"
    # Images
    ExpiresByType image/gif "access plus 1 month"
    ExpiresByType image/png "access plus 1 month"
    ExpiresByType image/jpg "access plus 1 month"
    ExpiresByType image/jpeg "access plus 1 month"
    # CSS
    ExpiresByType text/css "access plus 1 month"
    # Javascript
    ExpiresByType application/javascript "access plus 1 year"
</IfModule> 
```

## **5\. 尽可能用静态 HTML 替换 PHP**

PHP 非常适合提高您的网站效率并减少多次输入相同信息的需要。但是，通过 PHP 调用信息会占用服务器资源，应该用静态 HTML 替换，这样不会节省任何时间

## **6.在HTTP头中指定一个字符集**

出于与上述相同的原因，在 HTTP 响应标头中指定字符集很有用，这样浏览器就不必花费额外的时间来确定您正在使用的字符集。

您只需在您网站的部分中添加一个 UTF-8 字符集标记即可完成此操作。

## **7.启用输出压缩**

压缩可以通过两种方式完成。

Apache 实际上有两个压缩选项：

*   **mod_deflate**更容易设置并且是标准的。
*   **mod_gzip**似乎更强大：您可以预压缩内容。

文件压缩的​​两个选项是 Deflate 和 GZIP。

*   Deflate 是 Apache 服务器自动提供的一个选项，并且设置简单。
*   另一方面，GZIP 需要安装并且需要更多的工作来安装。但是，GZIP 确实实现了更高的压缩率，因此如果您的网站使用具有大量图像或大文件大小的页面，则可能是更好的选择。

Deflate 快速且有效，所以我使用它；如果它能让你的船漂浮，请使用 mod_gzip。无论哪种情况，Apache 都会检查浏览器是否发送了“Accept-encoding”标头并返回文件的压缩版本或常规版本。但是，一些较旧的浏览器可能会遇到问题（更多内容见下文），您可以添加一些特殊指令来纠正此问题。

> zlib.output_compression 是否透明压缩页面。如果在 php.ini 或 Apache 配置中将此选项设置为“On”，则如果浏览器发送“Accept-Encoding: gzip”或“deflate”标头，则会压缩页面。
> 
> PHP 默认值：禁用

**在 PHP.ini 中**

```
zlib.output_compression = On 
```

如果您无法更改 .htaccess 文件，则可以使用 PHP 返回压缩内容。为您的 HTML 文件添加一个 .php 扩展名并将此代码添加到顶部：

**在 PHP 中：**

```
<?php 
    if (substr_count($_SERVER[‘HTTP_ACCEPT_ENCODING’], ‘gzip’))
    ob_start(“ob_gzhandler”); else ob_start(); 
?> 
```

本节将打开 apache mod_deflate 模块，该模块在发送到浏览器之前会压缩文本、css 和 javascript。这导致更小的下载大小。在 .htaccess 文件中启用它，使其如下所示：

```
<IfModule mod_deflate.c>

############################################
## enable apache served files compression
## http://developer.yahoo.com/performance/rules.html#gzip

    # Insert filter on all content
    SetOutputFilter DEFLATE
    # Insert filter on selected content types only
    AddOutputFilterByType DEFLATE text/html text/plain text/css text/javascript application/javascript application/x-javascript text/xml application/xml application/xhtml+xml image/x-icon image/svg+xml application/rss+xml application/x-font application/x-font-truetype application/x-font-ttf application/x-font-otf application/x-font-opentype application/vnd.ms-fontobject font/ttf font/otf font/opentype 

    # Netscape 4.x has some problems...
    BrowserMatch ^Mozilla/4 gzip-only-text/html

    # Netscape 4.06-4.08 have some more problems
    BrowserMatch ^Mozilla/4\.0[678] no-gzip

    # MSIE masquerades as Netscape, but it is fine
    BrowserMatch \bMSIE !no-gzip !gzip-only-text/html

    # Don't compress images
    SetEnvIfNoCase Request_URI \.(?:gif|jpe?g|png)$ no-gzip dont-vary

    # Make sure proxies don't deliver the wrong content
    Header append Vary User-Agent env=!dont-vary

</IfModule> 
```

**

## 8\. 启用缓存、OPcache 和 eAccelerator（另一个 PHP 缓存工具）

Memcache 对于减少数据库负载特别有用，而 APC 或 OPcache 等字节码缓存引擎非常适合在编译脚本时节省执行时间。

## 9\. 利用原生 PHP 函数

尽可能利用 PHP 的原生函数，而不是编写自己的函数来获得相同的结果。花一点时间学习如何使用 PHP 的原生函数不仅可以帮助您更快地编写代码，而且还可以提高代码的效率。

## 10.减少不必要的计算

多次使用同一变量的值时，请在开始时计算并分配值，而不是每次使用都执行计算。例如，如果您正在遍历一个数组，请预先对其进行 count() 操作，将值存储在一个变量中，然后将其用于您的测试。这样，您可以避免在每次循环迭代时不必要地触发测试函数。

## 11\. 使用最强的 Str 函数

虽然 str_replace 比 preg_replace 快，但 strtr 函数比 str_replace 快四倍。

## 12.坚持使用单引号

如果可能，请使用单引号而不是双引号。双引号检查变量，这可能会降低性能。

## 13\. 尝试三个等号

由于“= = =”只检查封闭范围，因此比使用“= =”进行比较要快。

## 14\. 使用isset()

当与

> count()、strlen() 和 sizeof()，

isset( ) 是一种更快、更简单的方法来确定一个值是否大于 0。

## 15.删除不必要的课程

如果您不打算多次使用类或方法，那么您实际上并不需要它们。如果必须使用类，请务必使用派生类方法，因为它们比基类中的方法更快。

## 16\. 关闭数据库连接

在代码中取消设置变量和关闭数据库连接将节省宝贵的内存。

## 17.限制你的数据库命中

使查询聚合可以减少对数据库的命中次数，这将使事情运行得更快。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-25T06:17:43.120

使用 PHP 分析器确保您的代码以适当的速度执行。如果可以提高性能，请重构（在可能的情况下）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-25T06:24:46.550

一些随机点。

渐进式渲染，而不是在内存中构建并在最后发送，给人一种明显的速度*印象*。

您可以使用一些高级缓存技巧，例如前向缓存（这是 Akamai 大规模使用的）以及分离静态和动态内容。

特别是对于 PHP，要小心复制大量数据。PHP 4 因其“默认复制”而臭名昭著，但在 PHP 5 中处理大量数据仍然有点太容易了。换句话说：不要复制（或创建！）字符串、数组和不必要的对象；与他们一起工作并传递参考。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-25T13:24:28.833

压缩所有文件，包括 css 和 js 文件也压缩你的 php 文件。尽可能少地调用数据库，并如前所述缓存所有返回。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-25T08:52:37.317

除了已经说过的：

*   混淆和压缩你的 CSS
*   混淆和压缩你的 javascript
*   更少的文件 == 更少的 http 请求 == 更快的站点 == 将所有的 css 放在一个文件中，将所有的 javascript 放在一个文件中

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-03T05:16:51.187

这是我一直觉得有用的一个提示：如果您有很多小图像，请将它们全部放在一个平铺图像中。在您的 CSS 声明中，通过操作背景的 x 和 y 坐标来控制 html 元素的视口：

```
.icon {
    background-image:url(static/images/icons.png);
    height:36px;
    width:36px;
}
.food {
    background-position:-52px -8px;
}
.icon_default {
    background-position:-184px -96px;
} 
```

平铺可以在 Python 脚本中完成，或者如果您有一个可管理的集合，则可以手动完成。

Gmail 也这样做。请参阅：http: [//mail.google.com/mail/images/2/5/greensky/icons7.png](http://mail.google.com/mail/images/2/5/greensky/icons7.png)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-05T15:14:51.713

一个有助于解决 Yahoo! 指南 ( [http://developer.yahoo.com/performance/rules.html](http://developer.yahoo.com/performance/rules.html) ) 中的一些要点的项目是[Minify](http://code.google.com/p/minify/)，它在同一空间中采用了缩小、包捆绑和条件 HTTP 服务，与良好的设计实践一起使用可以显着减少页面加载，尤其是用户体验（与实际页面加载时间不同）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-09-05T10:15:20.470

**更快加载网页的最佳方法：**

**[*据雅虎报道*]**

1-样式表应该更快地出现在顶部加载网页上。

2-避免重定向。

3-减少不必要的代码。

4-将 CSS 和 JS 放在外部文件中。

5-删除重复的脚本。

来源： [https ://developer.yahoo.com/performance/rules.html](https://developer.yahoo.com/performance/rules.html)

* * *

**[*根据谷歌*]**

1-消除渲染阻塞资源

2-适当大小的图像

3-推迟离屏图像

4-高效编码图像

5-以现代格式提供图像

6-启用文本压缩

7-预连接到所需的来源

8-减少服务器响应时间（TTFB）

9-避免多页重定向

10-预加载密钥请求

11-使用视频格式制作动画内容

12-减少第三方代码的影响

14-Kill Lazy 使用外观加载第三方资源。

* * *

**注意：**应用提示可以显着减少时间。根据您的需要使用积分。

# iphone - 如何通过 iPhone 上的按钮切换视图？

> ID：584892
> 
> 赞同：1
> 
> 时间：2009-02-25T06:09:32.483
> 
> 标签：iphone, navigation, textfield

我想切换 3 个视图，让它们从 1-2-3 切换。第一个视图是让用户输入名称和密码，第二个视图将显示他的信息让他确认，第三个视图将显示一个选项列表，以便他选择下一步做什么。

问题是如何切换这些视图？如果我使用导航控件切换视图，如何在其中添加文本字段以便用户输入他们的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T13:58:01.920

感谢您的回答，我发现这并不像我之前想的那么复杂。经过几次尝试，我终于成功了。我只是使用 NavigationController 在 UIViews 之间切换。

现在我明白导航控制器不仅可以从 UITableView 切换到 UIView，还可以从 UIView 切换到 UIView。使用 UIView 类，我可以在 IB 中轻松组织所有控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T06:20:48.587

查看 Apple 的示例[TableViewSuite](http://developer.apple.com/iphone/library/samplecode/TableViewSuite/index.html#//apple_ref/doc/uid/DTS40007318)应用程序以获取提示。您可以在 Apple 的 iPhone 开发者网站上找到更多[示例代码。](http://developer.apple.com/iphone/library/navigation/SampleCode.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T07:52:16.933

你讨厌把你的代码写进

-(void)IBA动作

使用连接检查器设置按钮属性，将按钮设置为 touchesDown。在此之后，您想在开始时看到的视图。将其设置为 alpha 值 1，其他视图的 alpha 值应为 0。填写完所有信息后，您将单击按钮。使第一个视图的 alpha 值应为 0，第二个视图的 alpha 应为 1。这样您可以继续

# linux - sed 中的环境变量替换

> ID：584894
> 
> 赞同：268
> 
> 时间：2009-02-25T06:10:31.280
> 
> 标签：linux, unix, shell, sed

如果我从脚本运行这些命令：

```
#my.sh
PWD=bla
sed 's/xxx/'$PWD'/'
...
$ ./my.sh
xxx
bla 
```

没事。

但是，如果我运行：

```
#my.sh
sed 's/xxx/'$PWD'/'
...
$ ./my.sh
$ sed: -e expression #1, char 8: Unknown option to `s' 
```

我在教程中读到，要从 shell 替换环境变量，您需要停止，并“引用”该`$varname`部分，以便它不会被直接替换，这就是我所做的，并且只有在变量之前立即定义时才有效。

如何让 sed 将 a 识别`$var`为环境变量，因为它在 shell 中定义？

* * *

## 回答 #1

> 赞同：398
> 
> 时间：2009-02-25T06:21:34.340

您的两个示例看起来相同，这使得问题难以诊断。潜在问题：

1.  您可能需要双引号，如`sed 's/xxx/'"$PWD"'/'`

2.  `$PWD`可能包含斜杠，在这种情况下，您需要找到*不*包含在其中的字符`$PWD`以用作分隔符。

要同时解决这两个问题，也许

```
sed 's@xxx@'"$PWD"'@' 
```

* * *

## 回答 #2

> 赞同：175
> 
> 时间：2009-04-14T17:24:39.400

除了 Norman Ramsey 的回答之外，我还想补充一点，您可以用双引号括起整个字符串（这可能会使语句更具可读性且不易出错）。

因此，如果要搜索 'foo' 并将其替换为 $BAR 的内容，可以将 sed 命令括在双引号中。

```
sed 's/foo/$BAR/g'
sed "s/foo/$BAR/g" 
```

在第一个中，$BAR 将无法正确扩展，而在第二个中，$BAR 将正确扩展。

* * *

## 回答 #3

> 赞同：77
> 
> 时间：2014-04-17T13:20:36.823

另一个简单的选择：

因为`$PWD`通常会包含一个斜杠`/`，所以使用 sed 语句`|`来代替：`/`

```
sed -e "s|xxx|$PWD|" 
```

* * *

## 回答 #4

> 赞同：67
> 
> 时间：2012-03-08T10:37:13.460

您可以使用“/”以外的其他字符进行替换：

```
sed "s#$1#$2#g" -i FILE 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2017-08-24T08:55:56.833

## 一. 坏方法：更改分隔符

```
sed 's/xxx/'"$PWD"'/'
sed 's:xxx:'"$PWD"':'
sed 's@xxx@'"$PWD"'@' 
```

也许那些不是最终的答案，

你不知道会出现什么字符`$PWD`，`/` `:`或者`@`。

好的方法是替换（转义）中的特殊字符`$PWD`。

## 二. 好方法：转义分隔符

例如：尝试替换`URL`为 $url （`:` `/`内容中有）

```
x.com:80/aa/bb/aa.js 
```

在字符串 $tmp

```
<a href="URL">URL</a> 
```

### A.`/`用作分隔符

在 var 中转义`/`（`\/`在 sed 表达式中使用之前）

```
## step 1: try escape
echo ${url//\//\\/}
x.com:80\/aa\/bb\/aa.js   #escape fine

echo ${url//\//\/}
x.com:80/aa/bb/aa.js      #escape not success

echo "${url//\//\/}"
x.com:80\/aa\/bb\/aa.js   #escape fine, notice `"`

## step 2: do sed
echo $tmp | sed "s/URL/${url//\//\\/}/"
<a href="x.com:80/aa/bb/aa.js">URL</a>

echo $tmp | sed "s/URL/${url//\//\/}/"
<a href="x.com:80/aa/bb/aa.js">URL</a> 
```

或者

### B.`:`用作分隔符（比 更具可读性`/`）

在 var 中转义`:`（`\:`在 sed 表达式中使用之前）

```
## step 1: try escape
echo ${url//:/\:}
x.com:80/aa/bb/aa.js     #escape not success

echo "${url//:/\:}"
x.com\:80/aa/bb/aa.js    #escape fine, notice `"`

## step 2: do sed
echo $tmp | sed "s:URL:${url//:/\:}:g"
<a href="x.com:80/aa/bb/aa.js">x.com:80/aa/bb/aa.js</a> 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-02-25T06:17:36.583

通过您的问题编辑，我看到了您的问题。假设当前目录是`/home/yourname` ... 在这种情况下，您的命令如下：

```
sed 's/xxx/'$PWD'/' 
```

将扩大到

```
sed `s/xxx//home/yourname// 
```

这是无效的。如果要执行此操作，您需要在 $PWD`\`中的每个字符前面放置一个字符。`/`

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-01-27T16:25:30.947

实际上，最简单的事情（至少在 GNU sed 中）是对 sed 替换 ( `s`) 命令使用不同的分隔符。因此，不要`s/pattern/'$mypath'/`扩展为`s/pattern//my/path/`，这当然会混淆`s` 命令，使用`s!pattern!'$mypath'!`，它将扩展为`s!pattern!/my/path!`。我使用了 bang ( `!`) 字符（或使用任何你喜欢的字符），它避免了通常的，但绝不是你唯一选择的正斜杠作为分隔符。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-08-27T19:45:57.483

**在 sed 中处理变量**

```
[root@gislab00207 ldom]# echo domainname: None > /tmp/1.txt

[root@gislab00207 ldom]# cat /tmp/1.txt

domainname: None

[root@gislab00207 ldom]# echo ${DOMAIN_NAME}

dcsw-79-98vm.us.oracle.com

[root@gislab00207 ldom]# cat /tmp/1.txt | sed -e 's/domainname: None/domainname: ${DOMAIN_NAME}/g'

 --- Below is the result -- very funny.

domainname: ${DOMAIN_NAME}

 --- You need to single quote your variable like this ... 

[root@gislab00207 ldom]# cat /tmp/1.txt | sed -e 's/domainname: None/domainname: '${DOMAIN_NAME}'/g'

--- The right result is below 

domainname: dcsw-79-98vm.us.oracle.com 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-04-10T07:35:20.477

```
VAR=8675309
echo "abcde:jhdfj$jhbsfiy/.hghi$jh:12345:dgve::" |\
sed 's/:[0-9]*:/:'$VAR':/1' 
```

where`VAR`包含您要替换该字段的内容

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-03-25T12:58:20.583

我有类似的问题，我有一个列表，我必须基于模板构建一个 SQL 脚本（包含`@INPUT@`作为要替换的元素）：

```
for i in LIST 
do
    awk "sub(/\@INPUT\@/,\"${i}\");" template.sql >> output
done 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-01-30T00:35:00.213

如果您的替换字符串可能包含其他[sed 控制字符](https://unix.stackexchange.com/a/33005)，那么两步替换（首先[转义替换字符串](https://stackoverflow.com/a/2705678)）可能是您想要的：

```
PWD='/a\1&b$_' # these are problematic for sed
PWD_ESC=$(printf '%s\n' "$PWD" | sed -e 's/[\/&]/\\&/g')
echo 'xxx' | sed "s/xxx/$PWD_ESC/" # now this works as expected 
```

# html - 是否可以让 Web 浏览器滚动以显示位于 Web 浏览器视口之外的 CSS 固定位置项？

> ID：584902
> 
> 赞同：0
> 
> 时间：2009-02-25T06:12:27.623
> 
> 标签：html, css, layout, scrollbar

我正在尝试创建一个 CSS 布局，其中页面看起来像是在森林中间​​。有一个带有背景树的左右 div，一些页眉 div 显示页面顶部和各种野生动物，一些页脚 div 显示底部有更多野生动物，与左右 div 背景图像相匹配，所有其中使用 CSS 中的“位置：固定”定位。

然后中间有正常定位且可滚动的内容。这一切都很好。

我遇到的问题是背景森林布局固定为 1204x768，但当然某些 Web 浏览器窗口可能没有那么大。不幸的是，虽然内容会按预期滚动，但如果它们超出浏览器窗口的大小，则永远不会显示固定位置的元素。显然不能接受。

我尝试在样式表中的 .body 和 .html 元素上设置溢出：滚动和高度：768，但没有运气。

请注意，我在 CSS 中使用 top: 和 left: 值定位所有内容。我知道我可以通过使用 bottom: 和 right: 来解决这个问题，但问题是页脚图像不会对齐。

这可能是不可能的，在这种情况下我将不得不重新设计图形设计，但如果可能的话，我很想知道如何！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T08:22:55.360

> 当然，一些网络浏览器窗口可能没有那么大

或者确实那么小！浏览器窗口的大小实际上恰好适合将您的装饰放在边缘的可能性很小；这始终是固定布局的问题。

> 我知道我可以通过使用 bottom: 和 right: 来解决这个问题，但问题是页脚图像不会对齐。

是的，设计可以响应页面大小变化而改变其连接的图像是更多的工作，但它是可行的。您必须将“鸟+树叶”图层和“松鼠+树叶”图层导出为独立的透明图像，然后将它们放在较长的侧面图像的顶部。

为了使对象边缘美观平滑，需要 PNG 的 8 位透明度，这需要 IE6 的 PNG 渲染 hack。虽然不是世界末日。

> 不幸的是，虽然内容会按预期滚动，但永远不会显示固定位置的元素

那是问题吗？它们本质上只是装饰性的。

> 我尝试在 .body 和 .html 元素上设置溢出：滚动和高度：768

对于这种方法，您需要设置 'overflow: auto; 高度：768px；' 在包含您的#sidebar-left 和您的#content 的包装器 <div> 上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T07:11:51.040

您可以有两张图片：1）包含右树和底部页脚图像的右图和 2）包含左树的左图。使底部页脚比需要的宽得多，树木（左和右）比它们需要的高得多。

然后将右图设置为bottom:和right:，并将左图设置为bottom:left:。这将强制图片始终位于页面外部，无论浏览器大小如何。然后将右图的z-index设置在左图的后面。然后它总是看起来像页面将被加边框。或者您可以在父容器上设置一个固定的宽度和高度，它们将始终位于容器的边框上。如果您需要一定的最小尺寸，您还可以设置最小宽度和高度。

至于在某个分辨率下不可见的东西，你真的无法解决这个问题。您可以有两组图片，一组用于正常分辨率，一组用于较小分辨率。`$(window).height()`然后就可以用jquery和jquery获取浏览器的宽高`$(window).width()`，加载相应的图片。

编辑：查看您的网站后，我很确定第二部分（为容器设置固定宽度，然后放置右下角图片和左下角图片）将满足您的需求。这将迫使页面具有一定的宽度，从而使整个边框可见。

# cocoa - 我可以在不中断焦点的情况下结束字段编辑器控件的编辑吗？

> ID：584903
> 
> 赞同：1
> 
> 时间：2009-02-25T06:13:39.790
> 
> 标签：cocoa

有时强制结束当前正在进行的任何编辑是有意义的。例如，如果用户在我的文档的某个字段中键入一个值，然后单击预览窗口，或者从菜单中选择“打印”或“保存”。

问题是，通过强制结束编辑（通过要求 NSWindow 使其自身成为第一响应者，或通过在窗口上调用 endEditingFor:），第一响应者的焦点不再位于相关字段上。在某些情况下，这会对用户造成干扰，其中正在执行的操作是迭代的，并不意味着他们在文档上的工作结束。

我解决这个问题的第一个尝试是注意当前的 firstResponder 是什么，然后在结束编辑后使用 NSWindow 的“makeFirstResponder:”恢复它。这可以正常工作，但它会产生不良影响，例如在 NSTextFields 上将字段编辑器中的选择重置为字符串内容的整个长度。

我可以使用一些技巧来强制调用整个“endEditing”方法系统而不破坏当前的字段编辑器吗？

谢谢，丹尼尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T06:32:38.340

为什么不使用您原来的方法，还要记录选择范围的位置/内容，并在恢复第一响应者后恢复它？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-30T17:21:58.063

我同意这是这样做的方法。在 iPhone 上，特别重要的是不要让键盘在不合时宜的时候上下跳动。我用过：

```
[textView endEditing:YES];
[textView becomeFirstResponder]; 
```

在对 UITextView 的内容执行操作之前成功完成挂起的拼写更正（就像一个空格被击中），但没有任何副作用。

# sql - CTE 遍历备份层次结构？

> ID：584904
> 
> 赞同：14
> 
> 时间：2009-02-25T06:13:48.900
> 
> 标签：sql, linq-to-sql, hierarchy, common-table-expression

我可以在分层数据模型中找到给定记录的所有子项（请参见下面的代码），但我不确定如何使用给定的子 ID 遍历父/子链。谁能指出我正确的方向来弄清楚如何做到这一点？这在 Linq to SQL 中也可能吗？

```
WITH TaskHierarchy (TaskID, [Subject], ParentID, HierarchyLevel, HierarchyPath) AS
(
   -- Base case
   SELECT
      TaskID,
      [Subject],
      ParentID,
      1 as HierarchyLevel,
      CONVERT(VARCHAR(MAX),'/') AS HierarchyPath
   FROM Task
   WHERE TaskID = 2

   UNION ALL

   -- Recursive step
   SELECT
      t.TaskID,
      t.Subject,
      t.ParentID,
      th.HierarchyLevel + 1 AS HierarchyLevel,
      CONVERT(varchar(MAX),th.HierarchyPath + CONVERT(VARCHAR(32),t.ParentID) + '/') AS HierarchyPath
   FROM Task t
      INNER JOIN TaskHierarchy th ON
         t.ParentID = th.TaskID
)

SELECT *
FROM TaskHierarchy
ORDER BY HierarchyLevel, [Subject] 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-25T06:21:10.613

啊，我想通了：

```
WITH Hierarchy(TaskID, [Subject], ParentID, IsProject, HLevel)
AS
(
    SELECT 
        TaskID, 
        [Subject], 
        ParentID ,
        IsProject,
        0 as HLevel
    FROM 
        Task 
    WHERE 
        TaskID = 59

    UNION ALL

    SELECT 
        SubDepartment.TaskID, 
        SubDepartment.[Subject], 
        SubDepartment.ParentID ,
        SubDepartment.IsProject,
        HLevel + 1
    FROM 
        Task SubDepartment
    INNER JOIN 
        Hierarchy ParentDepartment
    ON 
        SubDepartment.TaskID = ParentDepartment.ParentID 
)

SELECT 
    TaskID, 
    [Subject], 
    ParentID,
    IsProject,
    HLevel
FROM  
    Hierarchy
ORDER BY
    HLevel DESC 
```

# linux - Linux线程资源泄漏？

> ID：584906
> 
> 赞同：2
> 
> 时间：2009-02-25T06:14:11.800
> 
> 标签：linux, pthreads

在多线程 Linux 应用程序之一中，应用程序退出而不删除线程。这会导致任何线程资源泄漏。如果在一天中多次启动此应用程序，系统会崩溃吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T06:24:46.987

在大多数情况下，当程序存在时，程序使用的所有资源都会被清除。有一些例外（这里是部分列表，毫无疑问）：

*   创建的文件（呃！）
*   TCP 套接字在程序退出后可能需要几分钟才能完全清理（例如，TIME_WAIT 套接字）
*   SysV 共享内存、信号量和消息队列（使用 ipcs/ipcrm 手动清理）

除此之外，几乎所有东西都被清理干净了。包括线程。

当然，您应该对此进行测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T06:23:23.073

内核通常会在退出时清理进程的资源（打开的文件、线程、分配的内存等），所以我认为您不必担心。尽管在风格上明确删除线程可能会更好，这可能取决于您喜欢的编码风格。

# javascript - Javascript：添加动态方法的更好方法？

> ID：584907
> 
> 赞同：4
> 
> 时间：2009-02-25T06:14:20.520
> 
> 标签：javascript, dynamic, methods

我想知道是否有更好的方法将动态方法添加到现有对象。基本上，我试图动态地组装新方法，然后将它们附加到现有函数中。

此演示代码有效。

```
builder = function(fn, methods){

    //method builder
    for(p in methods){
        method = 'fn.' + p + '=' + methods[p];
        eval(method);
    }

    return fn;
}
test = {}
test = builder(test, {'one':'function(){ alert("one"); }','two':'function(){ alert("two"); }'} );

test.one();
test.two(); 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-25T06:16:46.037

您不需要每次都评估它们。

您可以创建现有的函数对象，然后将它们作为属性分配给您的对象。

```
var methods = {
  'increment': function() { this.value++; },
  'display' : function() { alert(this.value); }
};

function addMethods(object, methods) {
  for (var name in methods) {
    object[name] = methods[name];
  }
};

var obj = { value: 3 };
addMethods(obj, methods);
obj.display();  // "3"
obj.increment();
obj.display();  // "4" 
```

然而，规范的面向对象的方式是使用构造函数和原型，但这并不是真正动态的，因为您构造的每个对象都将具有相同的方法：

```
function MyObj(value) {
  this.value = value;
};
MyObj.prototype.increment = function() {
  this.value++;
};
MyObj.prototype.display = function() {
  alert(this.value);
}
var obj = new MyObj(3);
obj.display();  // "3"
obj.increment();
obj.display();  // "4" 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-04-02T11:54:03.023

嗯 - 我可能有点晚了，但无论如何：

```
new Function(argName1,...,argNameN, body) 
```

例如：

```
x = new Function("y","return y*5");
x(3) 
```

不过，并不比 eval 好*多少。*（很遗憾，但字符串被用作代码描述，而不是像 LISP 中更结构化的东西）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-08-21T05:12:04.423

如果您需要基于特定类型动态的对象......例如：

```
var logTypes = ["fatal", "error", "warning", "info", "trace", "debug", "profile"]; 
```

然后，您可以保留“this”对象输出的引用并在方法中使用它。

```
function CustomLogger () {

   var outter = this;

   // creating the logger methods for all the log types and levels
   _.each(logTypes, function (logType) {
        outter[logType] = function (msg) {
           console.log("[%s] %s", logType, msg);
        };
   });
} 
```

这样，您可以获得新的动态方法...

```
var logger = new CustomLogger();
logger.info("Super cool!"); 
```

这将输出以下内容：

```
"[info] Super cool!" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T06:24:58.077

您的示例可以在没有字符串的情况下完成：

```
builder = function(fn, methods){

        //method builder
        for(p in methods){
                fn[p] = methods[p];
        }

        return fn;
}
test = {}
test = builder(test, {'one': function(){ alert("one"); },'two':function(){ alert("two"); }} );

test.one();
test.two(); 
```

我不确定你是如何组合这些方法的，但如果可以的话，请避免使用字符串。可能有更好的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T06:17:49.390

您是否必须从字符串构建方法？如果没有，有很多方法，包括直接将方法添加到对象原型或对象定义。大多数常见的 javascript 库都具有在现有或创建“命名空间”上定义对象/方法的方法。查看 YUI/Prototype/jQuery 等以了解它们如何实现的示例。

否则，如果您必须从字符串构建，那么评估可能是将方法动态添加到对象定义的最佳方法。

# c# - 如何以编程方式将参数传递给 Windows 服务的 OnStart 方法？

> ID：584913
> 
> 赞同：2
> 
> 时间：2009-02-25T06:17:48.750
> 
> 标签：c#, windows-services, timer

我如何以编程方式将参数传递给服务的 OnStart 方法，我还需要将其传播到服务内 Timer 的 Elapsed 事件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T06:56:59.403

在最简单的层面上：当您调用 时`ServiceBase.Run`，您可以为其提供要执行的服务实例。只需将其声明为您服务的公共属性，并在调用之前分配`Run`：

```
 Service1 myService = new Service1();
        myService.SomeProp = 1;
        ServiceBase.Run(myService); 
```

然后阅读`SomeProp`您的服务：

```
 public int SomeProp { get; set;}
    protected override void OnStart(string[] args)
    {
        int prop = SomeProp;
    } 
```

您也可以使用服务参数，但这是来自外部调用者（服务注册） - 不是以编程方式（根据问题）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T06:53:58.507

您可以考虑让 OnStart 方法从配置文件中读取参数并使用单独的应用程序以编程方式对其进行更新。

# javascript - 如何以有限的高度滚动 div 上的文本？

> ID：584938
> 
> 赞同：2
> 
> 时间：2009-02-25T06:24:56.533
> 
> 标签：javascript

所以我有不适合我的页面的段落块，我的解决方案是使用滚动方法，这样当用户将鼠标悬停在向下箭头上时，它将向下滚动段落并显示更多文本。

[替代文字 http://www.picamatic.com/view/2446369_scroll/](http://www.picamatic.com/view/2446369_scroll/)

所以我附上了我的项目的图像，你可以看到我有向下滚动和向上滚动按钮。

这是我的项目的 HTML 文件：

```
<div id="content1" class="scrolling-content">
                <div>
                    <div id="story" style="overflow:hidden; width:40%;">
                        <h2 style="font-size:30px;">Quirino's Story</h2>
                            <p>Elpidio Quirino was a Filipino politician, and the sixth President           of the Philippines.</p>
                            <p>He was born in Vigan, Ilocos Sur to Mariano Quirino and Gregoria Rivera, Quirino spent his early years in Aringay, La Union. He received secondary education at Vigan High School, then went to Manila where he worked as junior computer in the Bureau of Lands and as property clerk in the Manila police department. He graduated from Manila High School in 1911 and also passed the civil service examination, first-grade.</p>

                            <p>Quirino attended the University of the Philippines. In 1915, he earned his law degree from the university's College of Law, and was admitted to the bar later that year. He was engaged in the private practice of law until he was elected as member of the Philippine House of Representatives from 1919 to 1925, then as Senator from 1925 to 1931\. He then served as Secretary of Finance and Secretary of the Interior in the Commonwealth government.</p>

                            <p>In 1934, Quirino was a member of the Philippine Independence mission to Washington D.C., headed by Manuel L. Quezon that secured the passage in the United States Congress of the Tydings-McDuffie Act. This legislation set the date for Philippine independence by 1945\. Official declaration came on July 4, 1946.</p>

                            <p>During the Battle of Manila in World War II, his wife, Alicia Syquia, and three of his five children were killed as they were fleeing their home.</p>

                            <p>After the war, Quirino continued public service, becoming president pro tempore of the Senate. In 1946, he was elected first vice president of the independent Republic of the Philippines, serving under Manuel Roxas. He also served as secretary of state.</p>

                            <span onmouseover = "start_scroll_up()"; onmouseout="stopscrolling";  id="up"><img src="images/arrow_up.png" /></span>
                    <span id="down" onmouseover="start_scroll_down()"; onmouseout="stopscrolling"; ><img src="images/arrow_down.png" /></span>
                    </div>
                </div>
            </div> 
```

这是Javascript文件：

```
var UpdateInterval = 20;
var PixelPerInterval = 2;
var scrollInterval;

function startScrollUp() {
    scrollInterval = setInterval(scrollUp, UpdateInterval);
}

function startScrollDown() {
    scrollInterval = setInterval(scrollDown, UpdateInterval);

function scrollDown() {
    document.getElementById('story').scrollHeight += PixelPerInterval;
}

function scrollUp() {
    document.getElementById('story').scrollHeight -= PixelPerInterval;
}

function stop_scrolling() {
    clearInterval(scrollInterval);
} 
```

多谢你们！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T06:59:11.193

我已经修改了您的代码并制作了一个工作示例。这是一个完整的html页面。

```
<html><头>
<标题></标题>
</head>
<正文>
<div id="content1" class="scrolling-content" style="height:100px;overflow-y:auto;">

                        <h2 style="font-size:30px;">奎里诺的故事</h2>
                            <p>Elpidio Quirino 是菲律宾政治家，也是菲律宾第六任总统。</p>
                            <p>他出生于南伊罗戈的维甘，出生于 Mariano Quirino 和 Gregoria Rivera，Quirino 早年在

Aringay，拉乌尼翁。他在维甘高中接受中等教育，然后去了马尼拉，在那里他在局里担任初级计算机

土地和马尼拉警察局的财产文员。1911年毕业于马尼拉高中，并通过了公务员

考试，一年级。</p>

                            <p>Quirino 就读于菲律宾大学。1915年，他获得了大学的法律学位。

法学院，并于当年晚些时候被录取。He was engaged in the private practice of law until he was elected as member of

1919 年至 1925 年担任菲律宾众议院议员，1925 年至 1931 年担任参议员。随后他担任财政部长和

联邦政府内政部长。</p>

                            <p>1934 年，基里诺是菲律宾独立代表团的成员，该代表团由 Manuel L.

Quezon 确保美国国会通过 Tydings-McDuffie 法案。这项立法为菲律宾设定了日期

1945 年独立。1946 年 7 月 4 日正式宣布。</p>

                            <p>在第二次世界大战的马尼拉战役中，他的妻子艾丽西亚·西奎亚（Alicia Syquia）和五个孩子中的三个被杀

当他们逃离家园时。</p>

                            <p>战后，基里诺继续从事公共服务，成为参议院临时议长。1946 年，他

在菲律宾独立共和国的第一届副总统，在Manuel Roxas下服务。他还担任过秘书

状态。</p>

            </div>
                            <span onmouseover = "startScrollUp();" onmouseout="stop_scrolling();"; id="up"><img src="images/arrow_up.png"

/></span>
                    <span id="down" onmouseover="startScrollDown();" onmouseout="stop_scrolling();" ><img src="images/arrow_down.png" /></span>

<script type="text/javascript">
var UpdateInterval = 20;
var PixelPerInterval = 2;
变量滚动间隔；

函数 startScrollUp() {
    scrollInterval = setInterval(function(){scrollUp()}, UpdateInterval);
}

函数 startScrollDown() {
    scrollInterval = setInterval(function(){scrollDown()}, UpdateInterval);
}
功能滚动（）{
    document.getElementById('content1').scrollTop += PixelPerInterval;
}

函数滚动（）{
    document.getElementById('content1').scrollTop -= PixelPerInterval;
}

功能停止滚动（）{
    清除间隔（滚动间隔）；
}
</脚本>
</正文>

```

不过你很亲近。

干杯，

安德鲁 ：-）

# css - Visual Studio 2008：关闭 css 类验证

> ID：584947
> 
> 赞同：8
> 
> 时间：2009-02-25T06:29:07.770
> 
> 标签：css, visual-studio-2008, validation

有没有办法阻止 Visual Studio 2008 在编辑页面和用户控件时检查 css 类是否存在？在每个用户控件上放置虚拟样式表似乎很荒谬。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-25T06:42:12.653

是的，有办法。转到工具>选项->文本编辑器-> CSS->特定于CSS

这里有一个名为 Errors 的选项 fgroup，带有 3 个复选框。

*   检测错误

*   检测未知属性

*   检测无效值

希望这可以帮助，

安德鲁 ：-）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-03T18:57:07.643

禁用它的唯一方法是关闭 HTML 验证：

工具 > 选项 > 文本编辑器 > HTML > 验证

取消选中“显示错误”复选框。

# algorithm - 四舍五入到最接近的 100

> ID：584948
> 
> 赞同：27
> 
> 时间：2009-02-25T06:29:18.393
> 
> 标签：algorithm

第一个数字需要四舍五入到最接近的第二个数字。有很多方法可以做到这一点，但是最好和最短的算法是什么？任何人来挑战:-)

1244->1200
1254->1300
123->100
178->200
1576->1600
1449->1400
123456->
123500 654321->654300
23->00
83->100

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-05-10T23:38:24.233

Ruby 的 round 方法会消耗负精度：

`n.round(-2)`

在这种情况下，-2 会让你四舍五入到最接近的百位。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-02-25T06:31:20.713

对于输入`n`：

```
(n + 50) / 100 * 100 
```

使用整数除法。

请注意，许多语言/库已经具有执行此操作的功能。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-25T06:35:47.567

```
100 * round(n/100.0) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-27T01:56:09.547

我知道现在已经很晚了，但是当我处理必须将事情四舍五入到最接近的 nTh 时，我通常会设置以下内容：

```
Number.prototype.roundTo = function(nTo) {
    nTo = nTo || 10;
    return Math.round(this * (1 / nTo) ) * nTo;
}
console.log("roundto ", (925.50).roundTo(100));

Number.prototype.ceilTo = function(nTo) {
    nTo = nTo || 10;
    return Math.ceil(this * (1 / nTo) ) * nTo;
}
console.log("ceilTo ", (925.50).ceilTo(100));

Number.prototype.floorTo = function(nTo) {
    nTo = nTo || 10;
    return Math.floor(this * (1 / nTo) ) * nTo;
}
console.log("floorTo ", (925.50).floorTo(100)); 
```

我发现自己在使用 Number.ceilTo(..) 因为我正在使用 Canvas 并试图走出去确定可以扩展多远。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T06:32:10.680

假设您使用的是整数数学，这将做到这一点：

```
n = (n + 50) / 100 * 100 
```

当然，您没有指定例如 1350 和 1450 的行为，所以我选择了四舍五入。如果你需要四舍五入，那是行不通的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-03-05T17:29:20.927

根据上面 Pawan Pillai 的评论，在 Javascript 中四舍五入到最接近的第 100 位：
`100 * Math.floor((foo + 50) / 100);`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T06:30:58.500

这是作业吗？

通常，mod 100，然后如果 > 50 则添加 else 减去。

# newsgroup - 关于将新闻组参考 ID 关联到 http 位置的 Noob 查询

> ID：584951
> 
> 赞同：0
> 
> 时间：2009-02-25T06:31:02.027
> 
> 标签：newsgroup

我知道这与编程无关，但如果有人能告诉我如何（如果可能）将新闻组引用 id 指向网页，我将不胜感激。

说，如果新闻组消息的参考 id 是

```
<b6c92e67-0bbd-4dd1-be22-4357373fd19a@q35g2000vbi.googlegroups.com> 
```

如何转到包含帖子的 http 页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T06:42:13.997

Message-Ids 与网页或 URL 没有任何关系。它们作为每个帖子的唯一标识符生成。

您可以使用 Google 搜索它们，当然，[Google 的 Groups Search](http://groups.google.com/advanced_search)会给出[结果](http://groups.google.com/groups/search?as_umsgid=b6c92e67-0bbd-4dd1-be22-4357373fd19a%40q35g2000vbi.googlegroups.com)。

# php - 用 PHP 释放内存有什么好处：unset() 或 $var = null

> ID：584960
> 
> 赞同：255
> 
> 时间：2009-02-25T06:33:41.287
> 
> 标签：php

我意识到第二个避免了函数调用的开销（**update**，实际上是一种语言结构），但是知道一个是否比另一个更好会很有趣。我一直在使用`unset()`我的大部分编码，但我最近浏览了一些在网上找到的可敬的类，它们`$var = null`改为使用。

有没有首选的，原因是什么？

* * *

## 回答 #1

> 赞同：245
> 
> 时间：2009-02-25T06:50:31.213

[在 2009 年未设置的手册页中](http://web.archive.org/web/20090217225355/http://us2.php.net/manual/en/function.unset.php)提到了这一点：

> `unset()`就像它的名字所说的那样 - 取消设置一个变量。它不会强制立即释放内存。PHP 的垃圾收集器会在它认为合适的时候执行它 - 有意尽快，因为无论如何都不需要这些 CPU 周期，或者直到脚本耗尽内存之前，无论首先发生什么。
> 
> 如果您正在这样做，`$whatever = null;`那么您正在重写变量的数据。您可能会更快地释放/缩小内存，但它可能会更快地从真正需要它们的代码中窃取 CPU 周期，从而导致更长的整体执行时间。

（自 2013 年以来，该[`unset`手册页](http://us2.php.net/manual/en/function.unset.php)不再包含该部分）

请注意，直到 php5.3，如果您[在循环引用中有两个对象](http://paul-m-jones.com/?p=262)，例如在父子关系中，则在父对象上调用 unset() 不会释放子对象中用于父引用的内存。（当父对象被垃圾回收时，内存也不会被释放。）（[错误 33595](http://bugs.php.net/bug.php?id=33595)）

* * *

问题“ [unset and = null 之间的区别](https://stackoverflow.com/q/13667137/6309)”详细说明了一些区别：

* * *

`unset($a)``$a`也从符号表中删除；例如：

```
$a = str_repeat('hello world ', 100);
unset($a);
var_dump($a); 
```

> 输出：

```
Notice: Undefined variable: a in xxx
NULL 
```

> 但是什么时候`$a = null`使用：

```
$a = str_repeat('hello world ', 100);
$a = null;
var_dump($a); 
```

> 输出：

```
NULL 
```

> 它似乎`$a = null`比它的`unset()`对应物快一点：更新符号表条目似乎比删除它更快。

* * *

*   当您尝试使用不存在的 ( `unset`) 变量时，将触发错误并且变量表达式的值将为空。（因为，PHP 还应该做什么？每个表达式都需要产生一些值。）
*   但是，分配有 null 的变量仍然是一个完全正常的变量。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-02-25T08:55:13.113

`unset`实际上不是函数，而是**语言构造**。它只是一个函数调用，而不是 a`return`或 an `include`。

除了性能问题， using`unset`使您的代码的*意图*更加清晰。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2009-02-25T06:45:20.230

通过对变量执行 unset() ，您实际上已将变量标记为“垃圾收集”（PHP 并没有真正的变量，但为了举例说明），因此内存不会立即可用。该变量不再包含数据，但堆栈仍保持较大的大小。执行 null 方法几乎立即删除数据并缩小堆栈内存。

这既来自个人经验，也来自其他人。[请在此处](http://us2.php.net/unset)查看 unset() 函数的注释。

我个人在循环中的迭代之间使用 unset() ，这样我就不必延迟堆栈的大小。数据消失了，但足迹依然存在。在下一次迭代中，内存已经被 php 占用，因此可以更快地初始化下一个变量。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2012-11-26T04:12:27.517

```
<?php
$start = microtime(true);
for ($i = 0; $i < 10000000; $i++) {
    $a = 'a';
    $a = NULL;
}
$elapsed = microtime(true) - $start;

echo "took $elapsed seconds\r\n";

$start = microtime(true);
for ($i = 0; $i < 10000000; $i++) {
    $a = 'a';
    unset($a);
}
$elapsed = microtime(true) - $start;

echo "took $elapsed seconds\r\n";
?> 
```

每似乎“= null”更快。

PHP 5.4 结果：

*   耗时 0.88389301300049 秒
*   花了 2.1757180690765 秒

PHP 5.3 结果：

*   花了 1.7235369682312 秒
*   花了 2.9490959644318 秒

PHP 5.2 结果：

*   花了 3.0069220066071 秒
*   花了 4.7002630233765 秒

PHP 5.1 结果：

*   花了 2.6272349357605 秒
*   花了 5.0403649806976 秒

PHP 5.0 和 4.4 的情况开始有所不同。

5.0：

*   花了 10.038941144943 秒
*   花了 7.0874409675598 秒

4.4：

*   花了 7.5352551937103 秒
*   花了 6.6245851516724 秒

请记住 microtime(true) 在 PHP 4.4 中不起作用，所以我不得不使用 php.net/microtime / Example #1 中给出的 microtime_float 示例。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2012-08-02T02:32:33.777

对于通过引用复制的变量，它以不同的方式工作：

```
$a = 5;
$b = &$a;
unset($b); // just say $b should not point to any variable
print $a; // 5

$a = 5;
$b = &$a;
$b = null; // rewrites value of $b (and $a)
print $a; // nothing, because $a = null 
```

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2011-03-26T11:03:07.337

它与数组元素有所不同。

考虑这个例子

```
$a = array('test' => 1);
$a['test'] = NULL;
echo "Key test ", array_key_exists('test', $a)? "exists": "does not exist"; 
```

在这里，关键的“测试”仍然存在。然而，在这个例子中

```
$a = array('test' => 1);
unset($a['test']);
echo "Key test ", array_key_exists('test', $a)? "exists": "does not exist"; 
```

密钥不再存在。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2012-11-19T20:23:11.207

关于对象，特别是在延迟加载的情况下，应该考虑垃圾收集器在空闲的 CPU 周期中运行，所以假设你在加载大量对象时遇到麻烦，小时间惩罚将解决内存释放问题。

使用 time_nanosleep 启用 GC 收集内存。将变量设置为 null 是可取的。

在生产服务器上测试，最初该作业消耗了 50MB，然后被暂停。使用 nanosleep 后，14MB 是恒定的内存消耗。

应该说这取决于可能从 PHP 版本到版本的 GC 行为。但它适用于 PHP 5.3 很好。

例如。此示例（代码取自 VirtueMart2 google feed）

```
for($n=0; $n<count($ids); $n++)
{
    //unset($product); //usefull for arrays
    $product = null
    if( $n % 50 == 0 )
    {
        // let GC do the memory job
        //echo "<mem>" . memory_get_usage() . "</mem>";//$ids[$n];
        time_nanosleep(0, 10000000);
    }

    $product = $productModel->getProductSingle((int)$ids[$n],true, true, true);
    ... 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-11-28T02:14:21.183

我仍然对此表示怀疑，但我已经在我的脚本中进行了尝试，并且我正在使用 xdebug 来了解它将如何影响我的应用程序内存使用。脚本在我的函数上设置如下：

```
function gen_table_data($serv, $coorp, $type, $showSql = FALSE, $table = 'ireg_idnts') {
    $sql = "SELECT COUNT(`operator`) `operator` FROM $table WHERE $serv = '$coorp'";
    if($showSql === FALSE) {
        $sql = mysql_query($sql) or die(mysql_error());
        $data = mysql_fetch_array($sql);
        return $data[0];
    } else echo $sql;
} 
```

我在代码之前添加了 unset`return`它给了我：160200 然后我尝试用它来改变它，`$sql = NULL`它给了我：160224 :)

但是当我不使用 unset() 或 NULL 时，这个比较有一些独特之处，xdebug 给我 160144 作为内存使用

因此，我认为使用 unset() 或 NULL 会为您的应用程序添加进程，并且最好保持代码的原始状态并尽可能有效地减少您正在使用的变量。

如果我错了，请纠正我，谢谢

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-07-01T23:59:26.543

为了记录，不包括它所花费的时间：

```
<?php
echo "<hr>First:<br>";
$x = str_repeat('x', 80000);
echo memory_get_usage() . "<br>\n";      
echo memory_get_peak_usage() . "<br>\n"; 
echo "<hr>Unset:<br>";
unset($x);
$x = str_repeat('x', 80000);
echo memory_get_usage() . "<br>\n";      
echo memory_get_peak_usage() . "<br>\n"; 
echo "<hr>Null:<br>";
$x=null;
$x = str_repeat('x', 80000);
echo memory_get_usage() . "<br>\n";      
echo memory_get_peak_usage() . "<br>\n";

echo "<hr>function:<br>";
function test() {
    $x = str_repeat('x', 80000);
}
echo memory_get_usage() . "<br>\n";      
echo memory_get_peak_usage() . "<br>\n"; 

echo "<hr>Reasign:<br>";
$x = str_repeat('x', 80000);
echo memory_get_usage() . "<br>\n";      
echo memory_get_peak_usage() . "<br>\n"; 
```

它返回

```
First:
438296
438352
Unset:
438296
438352
Null:
438296
438352
function:
438296
438352
Reasign:
438296
520216 <-- double usage. 
```

结论，空和未设置的空闲内存都符合预期（不仅在执行结束时）。此外，重新分配一个变量会在某个时间点两次保存该值（520216 与 438352）

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-06-27T05:54:01.687

PHP 7 已经在处理此类内存管理问题，并将其减少到最低限度。

```
<?php
  $start = microtime(true);
  for ($i = 0; $i < 10000000; $i++) {
    $a = 'a';
    $a = NULL;
  }
  $elapsed = microtime(true) - $start;

  echo "took $elapsed seconds\r\n";

  $start = microtime(true);
  for ($i = 0; $i < 10000000; $i++) {
     $a = 'a';
     unset($a);
  }
  $elapsed = microtime(true) - $start;

  echo "took $elapsed seconds\r\n";

?> 
```

PHP 7.1 输出：

耗时 0.16778993606567 秒耗时 0.16630101203918 秒

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-07-12T10:59:50.077

[评论中的](https://stackoverflow.com/questions/584960/whats-better-at-freeing-memory-with-php-unset-or-var-null/13558543#13558543)代码示例

```
echo "PHP Version: " . phpversion() . PHP_EOL . PHP_EOL;

$start = microtime(true);
for ($i = 0; $i < 10000000; $i++) {
    $a = 'a';
    $a = NULL;
}
$elapsed = microtime(true) - $start;

echo "took $elapsed seconds" . PHP_EOL;

$start = microtime(true);
for ($i = 0; $i < 10000000; $i++) {
    $a = 'a';
    unset($a);
}
$elapsed = microtime(true) - $start;

echo "took $elapsed seconds" . PHP_EOL; 
```

从图像和其他人在**docker 容器中**`php:7.4-fpm`运行..

```
PHP Version: 7.4.8
took 0.22569918632507 seconds null
took 0.11705803871155 seconds unset
took 0.20791196823121 seconds null
took 0.11697316169739 seconds unset

PHP Version: 7.3.20
took 0.22086310386658 seconds null
took 0.11882591247559 seconds unset
took 0.21383500099182 seconds null
took 0.11916995048523 seconds unset

PHP Version: 7.2.32
took 0.24728178977966 seconds null
took 0.12719893455505 seconds unset
took 0.23839902877808 seconds null
took 0.12744522094727 seconds unset

PHP Version: 7.1.33
took 0.51380109786987 seconds null
took 0.50135898590088 seconds unset
took 0.50358104705811 seconds null
took 0.50115609169006 seconds unset

PHP Version: 7.0.33
took 0.50918698310852 seconds null
took 0.50490307807922 seconds unset
took 0.50227618217468 seconds null
took 0.50514912605286 seconds unset

PHP Version: 5.6.40
took 1.0063569545746 seconds null
took 1.6303179264069 seconds unset
took 1.0689589977264 seconds null
took 1.6382601261139 seconds unset

PHP Version: 5.4.45
took 1.0791940689087 seconds null
took 1.6308979988098 seconds unset
took 1.0029168128967 seconds null
took 1.6320278644562 seconds unset 
```

但是，与其他示例：

```
<?php
ini_set("memory_limit", "512M");

echo "PHP Version: " . phpversion() . PHP_EOL . PHP_EOL;

$start = microtime(true);
$arr = [];
for ($i = 0; $i < 1000000; $i++) {
    $arr[] = 'a';
}
$arr = null;
$elapsed = microtime(true) - $start;

echo "took $elapsed seconds" . PHP_EOL;

$start = microtime(true);
$arr = [];
for ($i = 0; $i < 1000000; $i++) {
    $arr[] = 'a';
}
unset($arr);
$elapsed = microtime(true) - $start;

echo "took $elapsed seconds" . PHP_EOL; 
```

结果：

```
PHP Version: 7.4.8
took 0.053696155548096 seconds
took 0.053897857666016 seconds

PHP Version: 7.3.20
took 0.054572820663452 seconds
took 0.054342031478882 seconds

PHP Version: 7.2.32
took 0.05678391456604 seconds
took 0.057311058044434 seconds

PHP Version: 7.1.33
took 0.097366094589233 seconds
took 0.073100090026855 seconds

PHP Version: 7.0.33
took 0.076443910598755 seconds
took 0.077098846435547 seconds

PHP Version: 7.0.33
took 0.075634002685547 seconds
took 0.075317859649658 seconds

PHP Version: 5.6.40
took 0.29681086540222 seconds
took 0.28199100494385 seconds

PHP Version: 5.4.45
took 0.30513095855713 seconds
took 0.29265689849854 seconds 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-06-09T17:28:42.017

`unset`我为and创建了一个新的性能测试`=null`，因为正如评论中提到的，这里写的有一个错误（重新创建元素）。我使用了数组，如您所见，现在没关系了。

```
<?php
$arr1 = array();
$arr2 = array();
for ($i = 0; $i < 10000000; $i++) {
    $arr1[$i] = 'a';
    $arr2[$i] = 'a';
}

$start = microtime(true);
for ($i = 0; $i < 10000000; $i++) {
    $arr1[$i] = null;
}
$elapsed = microtime(true) - $start;

echo 'took '. $elapsed .'seconds<br>';

$start = microtime(true);
for ($i = 0; $i < 10000000; $i++) {
    unset($arr2[$i]);
}
$elapsed = microtime(true) - $start;

echo 'took '. $elapsed .'seconds<br>'; 
```

但我只能在 PHP 5.5.9 服务器上对其进行测试，结果如下： - 耗时 4.4571571350098 秒 - 耗时 4.4425978660583 秒

`unset`出于可读性的原因，我更喜欢。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-10-29T19:53:02.630

`unset`如果不释放即时内存的代码仍然非常有用，并且每次我们在退出方法之前传递代码步骤时这样做是一个很好的做法。注意它不是关于释放即时内存。即时内存用于 CPU，辅助内存是 RAM。

这也解决了防止内存泄漏的问题。

请参阅此链接 [http://www.hackingwithphp.com/18/1/11/be-wary-of-garbage-collection-part-2](http://www.hackingwithphp.com/18/1/11/be-wary-of-garbage-collection-part-2)

我已经使用 unset 很长时间了。

更好的做法是在代码中立即取消设置已用作数组的所有变量。

```
$data['tesst']='';
$data['test2']='asdadsa';
....
nth. 
```

并`just unset($data);`释放所有变量的使用。

请参阅相关主题以取消设置

[在 PHP 中取消设置变量有多重要？](https://stackoverflow.com/questions/2617672/how-important-is-it-to-unset-variables-in-php)

[漏洞]

# .net - 在 delphi 中使用 COM DLL - MSVCR80D.dll 错误中的访问冲突

> ID：584965
> 
> 赞同：4
> 
> 时间：2009-02-25T06:38:50.697
> 
> 标签：.net, delphi, com, dll, delphi-2006

我需要使用使用 .NET 框架创建的 DLL。该 DLL 使 COM 可见。

我想在使用 Delphi 2006 创建的应用程序中使用这个 DLL。我遵循了以下步骤：

1.  使用 regscr32 注册 DLL。
2.  使用 Delphi IDE 导入类型库。它创建了 _TLB.pas 文件。在 TLB 文件中创建了以下签名。

    ```
    函数 TValidationRequest.Process(var meterBSN: WideString; var NICSerial: WideString;
                                        var partNumber: WideString; var otherConfig: WideString;
                                        出 returnMessage: WideString): Smallint;
    开始
      结果 := DefaultInterface.Process(meterBSN, NICSerial, partNumber, otherConfig, returnMessage);
    结尾;

    ```

3.  我尝试使用以下代码片段调用该方法。

```
过程 TForm1.buttonClick(Sender: TObject);
变量
  valReq：TValidationRequest；
  s1、s2、s3、s4、s5：宽字符串；
  o：宽弦；
开始
  valReq := TValidationRequest.Create (Self);
  尝试
    valReq.Process (s1, s2, s3, s4, o);
    MessageDlg(o, mtInformation, [mbOK], 0);
  最后
    valReq := 无；
  结尾;
结尾;

```

但是当调用 Process 方法时出现以下错误。 [![替代文字](https://i.stack.imgur.com/AS3AW.png)](https://i.stack.imgur.com/AS3AW.png)

请问您能提出任何解决方案吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T06:46:30.770

尝试初始化`WideStrings`( `s1`, `s2`, `s3`, `s4`, 甚至`o`)。如果我没记错的话，在您设置它们之前，它们在 Delphi 和 nil (000000000) 中是动态的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T20:03:11.793

除了MarkusQ所说的，请注意您对`TValidationRequest`对象的内存管理不是那么好。`Create(nil)`使用然后在`finally`-block write中使用会更干净`FreeAndNil(valReq)`。现在的方式是`TValidationRequest`每次单击按钮时创建一个对象，它们都将保留在内存中，直到您销毁表单。至少您不会因为传递`Self`给构造函数而导致内存泄漏，因此至少表单将负责销毁这些对象。`TForm1.buttonClick`在您的示例中，在方法结束后确实没有必要让对象保持活动状态。

# mysql - 你如何让你的全文布尔搜索来选择术语 C++？

> ID：584976
> 
> 赞同：8
> 
> 时间：2009-02-25T06:45:02.833
> 
> 标签：mysql, search, escaping, full-text-search, boolean

因此，我需要了解如何在 MySQL 数据库上进行全文布尔搜索以返回包含术语“C++”的记录。

我的 SQL 搜索字符串为：

```
SELECT * 
FROM mytable 
WHERE MATCH (field1, field2, field3) 
AGAINST ("C++" IN BOOLEAN MODE) 
```

尽管我的所有字段都包含字符串 C++，但它从未在搜索结果中返回。

我如何修改 MySQL 以适应这种情况？是否可以？

我发现的唯一解决方案是在输入我的数据的过程中转义 + 字符，例如“__plus”，然后修改我的搜索以适应，但这似乎很麻烦，必须有更好的方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T07:38:18.323

> 我如何修改 MySQL 以适应这种情况？

你必须改变 MySQL 关于单词​​是什么的概念。

首先，默认的最小字长为 4。这意味着任何仅包含 <4 个字母的单词的搜索词都不会匹配，无论是“C++”还是“cpp”。您可以使用[ft_min_word_len](http://dev.mysql.com/doc/refman/5.1/en/server-system-variables.html#sysvar_ft_min_word_len)配置选项进行配置，例如。在你的 my.cfg 中：

```
[mysqld]
ft_min_word_len=3 
```

（然后停止/启动 MySQLd 并重建全文索引。）

其次，'+' 不被 MySQL 视为字母。您可以将其设为字母，但这意味着您将无法在字符串 'fish+chips' 中搜索单词 'fish'，因此需要注意。而且这不是微不足道的：它需要重新编译 MySQL 或破解现有的字符集。[请参阅文档第 11.8.6 节](http://dev.mysql.com/doc/refman/5.1/en/fulltext-fine-tuning.html)中以“如果要更改被视为单词字符的字符集...”开头的部分。

> 在将我的数据输入为“__plus”之类的过程中转义 + 字符，然后修改我的搜索以适应

是的，这样的事情是一个常见的解决方案：您可以将您的“真实”数据（没有转义）保存在一个主要的、确定的表中——通常使用 InnoDB 来满足 ACID 合规性。然后可以添加一个辅助 MyISAM 表，其中仅包含用于全文搜索诱饵的损坏词。您还可以使用这种方法进行有限形式的词干提取。

另一种可能性是检测 MySQL 无法执行的搜索，例如只有短词或不寻常字符的搜索，然后回退到仅对这些搜索进行简单但缓慢的 LIKE 或 REGEXP 搜索。在这种情况下，您可能还希望通过将[ft_stopword_file](http://dev.mysql.com/doc/refman/5.1/en/server-system-variables.html#sysvar_ft_stopword_file)设置为空字符串来删除停止列表，因为将其中的所有内容都作为特殊内容也是不切实际的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-14T08:03:02.697

从[http://dev.mysql.com/doc/refman/5.0/en/fulltext-boolean.html](http://dev.mysql.com/doc/refman/5.0/en/fulltext-boolean.html)：

> 包含在双引号 (“"”) 字符中的短语仅匹配按字面意思包含该短语的行，因为它是键入的。

这意味着您可以使用以下查询搜索“C++”：

```
SELECT * 
FROM mytable 
WHERE MATCH (field1, field2, field3) 
AGAINST ('"C++"' IN BOOLEAN MODE) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T06:51:04.100

通常在查询中使用转义字符而不是在数据库数据中。尝试转义查询中的每个“+”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-06T06:45:27.267

解决方案：：

**更改 my.ini 文件**

把这两行

```
ft_min_word_len = "1"
ft_stopword_file ="" 
```

以下

```
[mysqld] 
```

比保存文件并重新启动mysql服务器。

`my.ini`文件将被所有人共享。那么我们可以`my.ini`只为某些会话更改文件吗？

# javascript - 是否有允许将 DWR 远程调用用作 YUI 数据源的插件或扩展？

> ID：584983
> 
> 赞同：0
> 
> 时间：2009-02-25T06:50:53.600
> 
> 标签：javascript, yui, dwr

是否有允许将 DWR 远程调用用作 YUI 数据源的插件或扩展？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T07:21:10.143

没有插件可以做到这一点。DwrYuiDataSource 目前支持远程方法的形式

```
public ReturnType methodName(String query) 
```

但可以很容易地扩展到采用 beforeArgs 和 afterArgs 以便它支持

```
public ReturnType methodName(Object beforeArg1, Object beforeArg2,
    String query, Object afterArg1, Object afterArg2) 
```

**javascript: DwrYuiDataSource**

```
mypackage.DwrYuiDataSource = function(remoteMethod) {
    this.remoteMethod = remoteMethod;
    this._init();
};

mypackage.DwrYuiDataSource.prototype = new YAHOO.widget.DataSource();

mypackage.DwrYuiDataSource.prototype.doQuery = function(oCallbackFn,
sQuery, oParent) {
    var oSelf = this;
    this.remoteMethod(sQuery, function(aResults) {
        var resultObj = {};
        resultObj.query = decodeURIComponent(sQuery);
        resultObj.results = aResults;
        oSelf._addCacheElem(resultObj);      
        oSelf.getResultsEvent.fire(oSelf, oParent, sQuery, aResults);
        oCallbackFn(sQuery, aResults, oParent);
    });
}; 
```

# xml - ajax 请求的 json vs xml 的优缺点是什么？

> ID：584985
> 
> 赞同：17
> 
> 时间：2009-02-25T06:52:34.203
> 
> 标签：xml, ajax, json, xmlhttprequest

ajax 请求的 json vs xml 的优缺点是什么？性能上有区别吗？即浏览器能够比另一种更快地处理一种格式吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-25T07:08:37.443

总之，JSON（可以被认为是 JavaScript 的一个子集）比 XML 更精简。这有几个积极的副作用

*   JSON 小于对应的 XML
*   JSON更快，即更简单的语法`->`更容易解析（faster parsing）

在我对这个问题的最初回答中，我对 JSON 的看法是对 JavaScript 的看法，我认为它是近亲。但是 JSON 是独立的，[JSON.org](http://www.json.org/)在描述 JSON 方面做得很好。它还为 JavaScript 提供了一个兼容性库，增加了对浏览器的支持`JSON.parse`和不支持的情况。`JSON.stringify`

虽然`eval`当时（2009 年中期）用于评估 JavaScript，但它也可以评估 JSON，即解析 JSON，但它被认为是不安全的，因为它允许任意 JavaScript 代替执行。

JSON 恰好非常适合浏览器，并且由于它与 JavaScript 的密切关系，它是一种发展平台的自然方式。

虽然 XML 可能被认为具有更好的严格性，因为您可以键入它，但也正是这些东西使它变得慢了很多（我认为它也有点冗长）。但如果这是您真正想要的东西，您应该使用它，XML 同样无处不在。

我不会讨论动态或静态类型，但我会这么说。在无模式数据之上添加东西真的很容易，并且有很多方法可以进行验证，无论模式或没有模式。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-25T08:01:31.637

到目前为止，我在讨论中还没有看到 XML 的一个优点是 XML 可以具有模式。这对于描述 XML 的结构非常有价值。对于简单的数据结构，JSON 和一些描述你在做什么的文本就可以了。当处理更复杂的数据结构时，或者当数据的创建者和消费者不是同一个团队时，拥有一个 Schema 可以极大地帮助沟通。

此外，拥有架构意味着您可以验证数据，这在尝试调试复杂错误时可以挽救生命......

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-25T07:14:36.773

您在这篇文章“ **[AJAX 响应：XML、HTML 还是 JSON？](http://www.quirksmode.org/blog/archives/2005/12/the_ajax_respon.html)** ”中有关于该主题的完整辩论：

**XML**

*   **优点**
    XML 最重要的优点是它是其他人最容易阅读的格式。
    第二个优点是 XML 已经存在了很长一段时间，而且许多开发人员已经习惯了它。
*   **缺点**
    将数据插入 HTML 页面所需的 JavaScript 非常冗长。

**JSON**

*   **优点**
    最重要的优点是 JSON 绕过 JavaScript 的同源策略，如果您将 JSON 文件作为新`<script>`标签导入。有关血腥细节，请参见[Simon Willison 的示例](http://simon.incutio.com/archive/2005/12/16/json)。
    JavaScript 不允许您访问来自其他服务器的文档（无论是 XML 还是 HTML）。但是，如果您将 JSON 文件作为脚本标签导入，则可以规避此问题，并且可以将任何 JSON 数据导入任何网站。这取决于您的业务目标，这是好事还是坏事，但目前它是唯一允许无限制访问的数据格式。
    第二个优点是 JSON 数据的脚本比 XML 数据的脚本稍微简单一些，并且更符合 JavaScript 语言的其余部分。
*   **缺点**
    JSON 最重要的缺点是格式很难被人类阅读，当然，每个逗号、引号和括号都应该在正确的位置。虽然 XML 也是如此，但 JSON 中看起来很复杂的语法，如数据片段末尾的 }}]} 可能会吓到新手并导致复杂的调试。

从评论来看，JSON 被认为比 XML 处理得更快。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-26T20:47:42.380

尚未提及的 XML 的一个优点是，可以使用 XSLT 使用任意复杂的 XPath 表达式从 XML 文档中提取数据。我看不到在 JSON 中执行此操作的方法。无论对象在结构中出现的位置如何，如何在 JSON 文档中找到包含“货币”字段作为直接后代的所有对象？在带有 XSLT/XPath 的 XML 中，这非常容易。

但是，在浏览器中执行此操作是有代价的。您将遇到特定于浏览器的怪癖，它可能会更慢且更占用内存。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-26T20:00:19.577

虽然我喜欢 Json 并会推荐它，但我认为最佳处理速度之间没有根本区别。库和平台之间的差异更为显着：好的 xml 解析器比坏的 json 解析器更快，反之亦然。所以通常格式本身的性能并不是一个大因素。两者都可以快速发光（Java 有一些很好的解析器，例如，其他语言也可能）。

至于紧凑性，这取决于数据的类型，Json 通常更紧凑，但并非完全如此。除非您有很多数组/列表，其中 json 表示法“{ ... }”比 xml 标记更紧凑（除非您尽可能使用空格，例如“1 2 3 4”）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T06:56:44.973

您可能想阅读[JSON: The Fat-Free Alternative to XML](http://www.json.org/fatfree.html)。使用 JSON，您可以在请求的源和目标之间来回进行回调，并在您现有的 Javascript 代码中真正轻松地使用它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-25T07:09:23.650

该链接直接提供了差异的良好概要（滚动到底部）。重点是：

JSON：更小，可以表示所有 unicode 字符（xml 不能在 UTF8 中，至少，根据它自己的规范）。在 AJAX 应用程序中使用它也很简单（因为 javascript 的 eval() 函数），尤其是更高级的功能，如 jsonp（响应调用回调）。

XML：有很多工具可以轻松查询其结构。由于它更老、更成熟，它通常也有更多的工具支持。

一般来说，它们可以完成相同的事情（您可以通过 xml 执行 jsonp，它只需要手动解析回调）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-02T14:38:53.183

我认为 Json 的另一个优点是它不使用 <> 括号，您可以将 html 代码放入其中而不会造成很多混乱。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-12-19T12:54:06.177

JSON 是**轻量级**的、**AJAX 友好的**（被视为 Javascript 的子集）并且**易于序列化**。 **XML**做这一切，但在喝了一些牛奶之后。

# multithreading - 将 vb6 标准 exe 转换为 activex exe 的最佳实践是什么？

> ID：584987
> 
> 赞同：1
> 
> 时间：2009-02-25T06:52:44.423
> 
> 标签：multithreading, vb6, activex-exe

我有一个带有大量 3rd 方库和控件的旧版大型 vb6 编辑器，最近需要对其进行设置以使其成为多线程，以便我可以独立于主编辑器表单运行其他一些表单。基本上，这些其他表单和主编辑器之间的通信最少，除了通过单击主页上的按钮来运行其他表单。

因此，从大量谷歌搜索中，我找到了一种将当前应用程序转换为多线程应用程序的方法，方法是将其设置为 activex exe 并添加一个设置为 global-multi-use 的类以允许这种情况发生。现在在通过调试模式进行编辑和测试时，我发现当我退出时，有时会发生很多奇怪的崩溃。

```
'main.frm - button click call
'On the button click, create a new object
Set obj = CreateObject("MyApp.clsThread")
Call obj.NewThread

'clsThread
' Create a new form and load it to run on a new thread
Public Sub NewThread()
    Dim frm As Object
    Set frm = New frmDogbert
    Load frmDogbert
    frm.show
    Set frm = Nothing
End Sub 
```

那么当我这样做时，我绝对必须知道什么，即潜在的问题等？因为我担心应用程序似乎变得越来越不稳定。还是有更好的方法来做到这一点？

## 更新：

我没有强行将我的应用程序破解为伪多线程应用程序，而是听取了这里好人的建议，并将组件重构为标准 exe，并将我的应用程序恢复为标准 exe 并通过 shell 调用它们。工作精美:)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T13:18:41.623

Visual Basic 6 本身并不是多线程。ActiveX EXE 和 ActiveX DLL 之间的多任务行为差异只有在从另一个 VB6 EXE 引用时才明显。从 ActiveX EXE 中定义的全局多用途类实例化的对象在它们自己的上下文中运行。从 ActiveX DLL 实例化的对象在调用 EXE 的上下文中运行。

现在多线程可以破解到 VB6 中，但它非常棘手并且有很多不该做的（例如，您不能使用 IDE 中的停止按钮来停止调试会话，否则程序将崩溃）。

ActiveX EXE 的好处是生成一个单独但相关的实例，该实例可以在不停止主程序的情况下单独运行。根据您的简短描述，我会说您最好的办法是将您的 EXE 保持原样，但将表单/模块/类更多地保留为单独的 EXE，并让原始 EXE 引用 ActiveX EXE。

请注意，您不必编译为.EXE，您可以将扩展名更改为.DLL，它仍然是一个activeX EXE。这样做是为了让用户不会错误地自行运行 ActiveX EXE。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T12:20:13.700

你能稍微澄清一下这个问题吗？我不明白为什么它需要多线程？为什么你不能只显示非模态的表单，然后它们都将同时可见和响应。除非您在主窗体中一直在运行一些后台处理，否则从您的问题来看这听起来不太可能，因为它会锁定主窗体以及其他窗体。

* * *

Melaos 说：嗯，主编辑器 frm 是这里的主要内容，我需要允许用户运行其他表单来执行其他一些事情，例如将内容上传到我们的服务器并将视频文件转换为其他格式。而这些表单使用 shell 来调用其他 exe。并且运行时间需要相当长的时间。

* * *

在这种情况下，我建议将其他形式制作成单独的 EXE，而不是使用多线程，这很困难。您说从主窗体到子窗体的通信很少 - 它只是显示它们。因此，您甚至不需要制作 ActiveX EXE 子表单。只需将它们制作为标准 EXE 并将它们从主窗体中剥离即可。******************