# StackOverflow 问答 11197000-11197999

# postgresql - 在postgresql中连接两个int值

> ID：11197000
> 
> 赞同：10
> 
> 时间：2012-06-25T20:38:54.747
> 
> 标签：postgresql, integer, concatenation

我有 7 个整数值（分别为 3、1、3、4、4、5、4 位），我必须将它们连接到一个整数（即 24 位数字）。我试着这样做

```
create or replace function gen_id(int,int,int,int,int,int,int) returns bigint as $$
declare
    id bigint;
begin
    id = $1 * 1000000000000000000000 + $2 * 100000000000000000000 + $3 * 100000000000000000 + $4 * 10000000000000 + $5 * 1000000000 + $6 * 10000 + $7;
    return id;
end;
$$ language plpgsql;

select * from gen_id(100,1,101,1000,1001,10001,1000); 
```

但是当我执行它时，我得到了错误： bigint out of range 。还有其他更好的方法吗？
谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-25T20:45:31.793

关于什么：

```
SELECT CAST(CAST(num1 AS text)||CAST(num2 AS text)||... AS numeric(24,0)) 
```

如果您碰巧在某个表中有您的 ID，那么您可以执行以下操作：

```
SELECT CAST(string_agg(CAST(num AS text), '') AS numeric(24,0)) FROM srctab; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-28T16:03:05.797

因为我可以将字符串连接到整数

```
SELECT REPLACE(STR(ISNULL(MAX(usuarioid) + 1, 1), 6), ' ', '0') FROM usuarios 
```

usuarioid 是字符串 + 1

# jquery - 通过jquery获取动态文本区域的值

> ID：11197003
> 
> 赞同：-4
> 
> 时间：2012-06-25T20:39:01.433
> 
> 标签：jquery, html

[http://jsfiddle.net/3QeSe/44/](http://jsfiddle.net/3QeSe/44/) 我得到未定义的任何帮助表示赞赏...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T20:43:01.370

你的 textarea 没有价值。试试这个：

[http://jsfiddle.net/3QeSe/49/](http://jsfiddle.net/3QeSe/49/)

另外，尝试在您的帖子中插入代码，而不仅仅是在您的 jsfiddle 中。

您还需要定义元素以使其动态化，可能通过向元素添加一个类并在修改了与该类匹配的任何元素时获取 ID：

[http://jsfiddle.net/3QeSe/57/](http://jsfiddle.net/3QeSe/57/)

```
<textarea name="text" class="checkthis" id="publiccontent22">Some text here</textarea> 
```

和 jQuery：

```
$(document).ready(function() {

$('.checkthis').blur(function(){

    var test = $(this).html();

    if (test == '') {
        alert("Please Enter Some Text");
    }
    else {
        alert(test);
    }

});
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T20:46:59.787

您需要使用`val()`not`.html()`来获取`textarea`

**编辑：（** 在OP提供更多信息之后）

[演示](http://jsfiddle.net/72jNj/)

**标记：**

```
<textarea name="text" class="checkthis" id="publiccontent22">Some text here</textarea> 
```

​</p>

**Javascript：**

```
$(document).ready(function() {

$('.checkthis').blur(function(){

    var test = $(this).val();

    if (test == '') {
        alert("Please Enter Some Text");
    }
    else {
        alert(test);
    }

  });
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:30:58.490

这对我来说很好[http://jsfiddle.net/Zg87Z/](http://jsfiddle.net/Zg87Z/)

```
$(document).ready(function() {
    var test = $("#publiccontent22").val();

    alert(test);
    if (test == '') {
        alert("Please Enter Some Text");
    }
    else {
        alert(test);
    }
}); 
```

# introspection - Vala VAPI 和 GObject Introspection 有什么关系？

> ID：11197009
> 
> 赞同：2
> 
> 时间：2012-06-25T20:39:27.567
> 
> 标签：introspection, vala, pygobject, gobject, vapi

首先，一些上下文：我是一名 Python 开发人员，他使用 PyGObject 编写了一个中型应用程序，利用 GObject Introspection 来访问 GSettings 等内容。我的一些 Python 对象实际上是 GObject.GObject 的子类，所以我是相当广泛地使用 GObject。

最近，某个库引起了我的注意，它在 GObject 中包装了一个 C 库（gexiv2，由 Shotwell/Vala 使用），但是它目前不支持自省。我有兴趣为 gexiv2 添加内省支持，以便我可以从 Python 访问它，但我什至不知道从哪里开始讨论这个主题。

当我研究自省和 VAPI 时，我看到很多文档都提到了 VAPI 可以从自省注释自动生成的事实......但是一个已经有 VAPI 但没有自省的项目呢？是否可以在给定 VAPI 的情况下自动生成自省注释？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T22:55:39.437

VAPI 绑定不一定与 GObject 内省相关。例如，有针对 POSIX、Linux、libudev 和其他绝对不是基于 GObject 的东西的 VAPI 绑定。没有将 VAPI 转换为 GObject 绑定的直接方法。

但是，如果您有 C 头文件和一个工作库，那么您通常可以从该库构建一个 GObject 内省文件。对于 gexiv2，下载并构建源代码，然后执行：

```
g-ir-scanner -I gexiv2 gexiv2/gexiv2-{metadata,managed-stream,preview-properties,preview-image,log,startup}.h -n GExiv2 --library libgexiv2.la --pkg gobject-2.0 
```

这将生成一个可以在 Python 中使用的 GIR 绑定 (XML)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T07:37:16.653

好吧，在厌倦了将 VAPI 定义手动复制到自省注释中的乏味之后，我编写了这个（粗略的）脚本来为我做这件事：

```
#!/bin/env python

import sys

from collections import defaultdict

ANNOTATION = """/**
 * %s:
%s *
 * Returns:%s
 */
"""

PARAMETER = """ * @%s:%s
"""

methods = defaultdict(set)

attrs = defaultdict(dict)

with open(sys.argv[1]) as vapi:
    for line in vapi:
        tokens = line.split()
        try:
            names = tuple(tokens[0].split('.'))
        except IndexError:
            continue

        attrs[names] = {}
        for attribute in tokens[1:]:
            key, val = attribute.split('=')
            if val == '"1"': val = True
            if val == '"0"': val = False
            attrs[names][key] = val

        methods[names[0]]
        if len(names) > 1:
            methods[names[0]].add(names[-1])

for method in methods:
    params = ''
    for param in methods[method]:
        param_attributes = ''
        param_attrs = attrs[(method, param)]
        if param_attrs.get('hidden'):
            param_attributes += ' (skip)'
        if param_attrs.get('is_out'):
            param_attributes += ' (out)'
        if param_attrs.get('transfer_ownership'):
            param_attributes += ' (transfer full)'
        elif 'transfer_ownership' in param_attrs:
            param_attributes += ' (transfer none)'
        if param_attrs.get('array_null_terminated'):
            param_attributes += ' (array zero-terminated=1)'
        if param_attrs.get('array_length_pos'):
            param_attributes += ' (array length=FIXME)'
        if param_attributes:
            param_attributes += ':'
        params += PARAMETER % (param, param_attributes)

    attributes = ''
    method_attrs = attrs[(method,)]
    if method_attrs.get('transfer_ownership'):
        attributes += ' (transfer full)'
    elif 'transfer_ownership' in method_attrs:
        attributes += ' (transfer none)'
    if method_attrs.get('nullable'):
        attributes += ' (allow-none)'
    if method_attrs.get('array_null_terminated'):
        attributes += ' (array zero-terminated=1)'
    if attributes:
        attributes += ':'

    print ANNOTATION % (method, params, attributes) 
```

这显然有一些缺点：它不会将注释插入代码中，它只是将它们打印出来，因此您必须进行大量复制和粘贴才能将所有内容放到正确的位置。它也不能很好地处理数组，但它至少可以让您知道何时需要手动修复数组。总而言之，与手动解析相比，运行此脚本然后处理结果的工作量要少得多。我把它贴在这里是希望它被谷歌采纳，并且有一天其他人可能会受益（尽管我非常希望从这里开始的所有基于 GObject 的项目都只是从注释开始，然后使用 vapigen）。

# android - 如果文本太长，则使 TableRow 中的第二个 Textview 可滚动

> ID：11197011
> 
> 赞同：0
> 
> 时间：2012-06-25T20:39:50.893
> 
> 标签：android, scroll, tablerow

我有一个表格布局，比如 hello, tablelayout on android dev -wow 该网站今天关闭了 -.- 。1 个 tableRow 中有 2 个文本视图，第 1 个应该在左侧站点。

第二个应该固定在右侧。但我有 2 个比屏幕长的文本视图。如果我启动应用程序，我只会看到长文本视图的中间/结尾，短文本视图就在屏幕后面。如何使短文本视图固定在屏幕左侧？

我希望你明白我的意思，我的英语很糟糕，但我认为我的问题的内容很清楚。

这只是第一部分^^ xml 文件要长得多这是 xml 文件：

```
 <?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <ScrollView
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:isScrollContainer="true"
            android:overScrollMode="always"
            android:scrollbarAlwaysDrawVerticalTrack="true"
            android:scrollbarStyle="outsideInset"
            android:scrollbars="vertical" >

                    <TableLayout
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content" 
                    android:stretchColumns="1">

                        <TableRow
                                    android:id="@+id/tableRow0"
                                    android:layout_width="wrap_content"
                                    android:layout_height="wrap_content" >

                                    <TextView
                                        android:layout_column="1"
                                        android:padding="3dip"
                                        android:textSize="20dp"
                                        android:text="@string/tab1_text1" 
                                        android:textColor="#ffffff"
                                        android:layout_marginTop="5dp"
                                        />

                             </TableRow>       

                        <View
                            android:layout_height="2dip"
                            android:background="#FF909090" />

                                <TableRow
                                    android:id="@+id/tableRow1"
                                    android:layout_width="wrap_content"
                                    android:layout_height="wrap_content" >

                                    <TextView
                                        android:layout_column="1"
                                        android:padding="3dip"
                                        android:text="@string/TV_1_1" android:textColor="#ffffff"/>

                                    <TextView
                                        android:id="@+id/in1_1"
                                        android:gravity="right"
                                        android:padding="3dip"
                                        android:text="TEXT2" android:textColor="#ffffff"/>

                                </TableRow>

                                <TableRow
                                    android:id="@+id/tableRow2"
                                    android:layout_width="wrap_content"
                                    android:layout_height="wrap_content" >

                                    <TextView
                                        android:layout_column="1"
                                        android:padding="3dip"
                                        android:text="@string/TV_1_2" android:textColor="#ffffff"/>

                                    <TextView
                                        android:id="@+id/in1_2"
                                        android:gravity="right"
                                        android:padding="3dip"
                                        android:text="TEXT2" android:textColor="#ffffff"/>

                                </TableRow>

                                <TableRow
                                    android:id="@+id/tableRow3"
                                    android:layout_width="wrap_content"
                                    android:layout_height="wrap_content" >

                                    <TextView
                                        android:layout_column="1"
                                        android:padding="3dip"
                                        android:text="@string/TV_1_3" android:textColor="#ffffff"/>

                                    <TextView
                                        android:id="@+id/in1_3"
                                        android:gravity="right"
                                        android:padding="3dip"
                                        android:text="TEXT2" 
                                    android:textColor="#ffffff"
                                    android:singleLine="true" 
                                        android:ellipsize="marquee"
                                        android:marqueeRepeatLimit ="marquee_forever"
                                        android:focusable="true"
                                        android:focusableInTouchMode="true" 
                                        android:scrollHorizontally="true"
                                        android:layout_width="wrap_content" 
                                        android:layout_height="wrap_content"
                                    />

                                </TableRow> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T21:18:31.877

你的问题有点难以理解，但看看你在评论中的插图，我认为你需要权衡你的 TextViews。看看下面的例子。

注意：这不会拉伸您的左列，正如您在 TableLayout 示例代码中所指出的那样。

```
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
             android:layout_width="fill_parent"
             android:layout_height="wrap_content">

    <TableRow>
        <TextView
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:singleLine="true"
                android:ellipsize="marquee"
                android:padding="3dp"
                android:text="Hello layout_weight" />

        <TextView
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:singleLine="true"
                android:padding="3dp"
                android:gravity="right"
                android:scrollHorizontally="true"
                android:text="Row 1, Col 1" />
    </TableRow>

    <TableRow>
        <TextView
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:singleLine="true"
            android:ellipsize="marquee"
            android:padding="3dp"
            android:text="Some long text in your left column, taking half the screen width"
        />

        <TextView
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:padding="3dp"
            android:text="This is the long scrolling text in your right column."
            android:singleLine="true"
            android:ellipsize="marquee"
            android:marqueeRepeatLimit="marquee_forever"
            android:focusable="true"
            android:focusableInTouchMode="true"
            android:scrollHorizontally="true"
        />

    </TableRow>
</TableLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T20:34:17.470

由于您忽略了我的评论，这将解决您的问题...

```
<ScrollView>
    <TextView /> <--- The one with really long text
</ScrollView> 
```

正如我在评论中所说，用 ScrollView 对象封装其中包含大量文本的 TextView，并以与放置 Textview 相同的方式定位 ScrollView，您将解决您的问题。

# multithreading - 深度监控类

> ID：11197013
> 
> 赞同：0
> 
> 时间：2012-06-25T20:39:53.643
> 
> 标签：multithreading

全部，

你能解释一下Monitor Class，尤其是更详细的代码吗？

```
if (Monitor.TryEnter(CashDrawers.lockObject))
    {
        try
        {
            // Work here                    
        }
        finally
        {
            Monitor.Exit(lockObject);
        }
    } 
```

谢谢，CK

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:00:25.797

不确定这是否是您正在寻找的，但...

您在问题中发布的代码是

```
lock(CashDrawers.LockObject)
{
     //work here
} 
```

这意味着只有在第一次尝试时能够获得锁，它才会“工作”。如果其他东西已经拥有锁，那么您的代码将不会做任何事情。我假设此代码是在 CashDrawers 类中编写的，否则您可能会遇到转录错误，因为您需要在您输入的同一对象上进行 Moniter.Exit。

您是否在寻找有关一般同步的解释？如果是这样，那超出了我可以在答案中写的范围。请查看[http://www.albahari.com/threading/part2.aspx](http://www.albahari.com/threading/part2.aspx)以了解 .net 中的一些一般同步信息。

# c++ - Mac/IOS 是否使用与 Linux 内核相同的 sys/socket.h？

> ID：11197015
> 
> 赞同：4
> 
> 时间：2012-06-25T20:40:09.720
> 
> 标签：c++, linux, macos, sockets

我打算将 39dll 库移植到 Linux。这个库已经移植到 Mac 和 IOS，我想知道是否需要重写 sys/socket.h 的东西。你可以在[这里](http://www.vetragames.com/Stuff/39dylib/39dylibsource.zip)和[这里找到有问题的库](http://www.host-a.net/dl/0/19773928711358)

有人知道吗？我做了一些谷歌搜索并查看了一些“建议”文章无济于事。一些文章建议它“可能”工作，但我需要一个更明确的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T21:04:02.760

您是在问 Mac OS X 的内容`<sys/socket.h>`是否与 Linux 的版本相同？不，Mac OS X 的标头是基于 BSD 的。

**>** `man socket`

> ```
> SOCKET(2)                   BSD System Calls Manual                  SOCKET(2)
> 
> NAME
>      socket -- create an endpoint for communication
> 
> SYNOPSIS
>      #include <sys/socket.h>
> 
>      int
>      socket(int domain, int type, int protocol);
> 
> DESCRIPTION
>      Socket() creates an endpoint for communication and returns a descriptor.
> 
>      The domain parameter specifies a communications domain within which com- 
> ```

如果您要问两个平台之间是否存在源代码兼容性，那么是的，只要源代码坚持可移植接口。

如果您正在考虑可能需要重写套接字内容的其他原因，我想这取决于您当前的代码在为 OS X 构建时是否满足您的要求。

# javascript - 按名称定位 div 内的图像

> ID：11197017
> 
> 赞同：0
> 
> 时间：2012-06-25T20:40:13.037
> 
> 标签：javascript, jquery, html

我正在尝试创建一个按钮来调整其 div 内的图像大小，

```
function aumenta(){
    var mydiv = $('div[name|="visualizacoes"]');
    var curr_width = parseInt(mydiv.style.width);
    var curr_height = parseInt(mydiv.style.height);

    if (curr_width < 4123) {            
        mydiv.style.width = (curr_width + 412) +"px";
        mydiv.style.height = (curr_height + 466) +"px";
    }
    } 
```

它不起作用，也许这不是获取元素名称的方法？我的问题是我有几个隐藏的 div 显示在菜单单击时，我试图让它们全部调整大小，即使它们被隐藏，这就是为什么我瞄准它的名字，也可能是类！请帮忙！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:01:03.533

创建一个类，然后使所有图像成为该类的成员。

如果你这样做了，你可以使用 jQuery "each()" 方法来遍历每个元素，并在循环中操作它们......

```
$('.<classname>').each(function(e){
    var element = $(this);
    var currWidth = element.width();
    var currHeight = element.height();

    if( currWidth < 4123 ){
        element.width( currWidth + 412 );
        element.height( currHeight + 412 );
    }
}); 
```

在上面我还使用了 jQuery 的 width() 和 height() 方法来获取*和*设置元素的高度和宽度。

# java - Java包装UTF-8文本？

> ID：11197027
> 
> 赞同：1
> 
> 时间：2012-06-25T20:40:50.867
> 
> 标签：java, utf-8, word-wrap

我需要简单地包装长文本以将其显示在几行中。我尝试了默认代码段：

```
String s = "Español texto aquí";
StringBuilder sb = new StringBuilder(s);

int i = 0;
while (i + 20 < sb.length() && (i = sb.lastIndexOf(" ", i + 20)) != -1) {
sb.replace(i, i + 1, "\n");
}

System.out.println(sb.toString()); 
```

但是对于西班牙语文本，我在输出中得到错误的符号。如何换行非英文文本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T20:47:19.277

```
String s = "Español texto aquí texto aquí Español texto aquí";
StringBuilder sb = new StringBuilder(s);

int i = 0;
while (i + 20 < sb.length() && (i = sb.lastIndexOf(" ", i + 20)) != -1) {
  sb.replace(i, i + 1, "\n");
}

System.out.println(sb.toString()); 
```

印刷

```
Español texto aquí
texto aquí Español
texto aquí 
```

现在，我看不出有什么问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T20:52:51.447

Java 拥有我见过的最好的 UTF-8 文本处理方法之一（它在内部使用 UTF-16）。

这里唯一依赖于操作系统或编码的是您正在使用的行分隔符。你可以试试

```
System.lineSeparator()  // Java 7 only 
```

或者

```
System.getProperty("line.separator") 
```

而不是`\n`.

如果这也无济于事，则问题可能出在您正在从中读取结果的控制台/终端中，而不是代码中。确保源 .java 文件保存为 UTF-8，尝试将输出重定向到文件而不是控制台。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-30T18:42:34.103

有一个现成的解决方案。

[https://mvnrepository.com/artifact/org.apache.commons/commons-text](https://mvnrepository.com/artifact/org.apache.commons/commons-text)

```
String s = "Español texto aquí texto aquí Español texto aquí";
WordUtils.wrap(s, 20); 
```

# java - 为什么 JButton 不令人沮丧？

> ID：11197030
> 
> 赞同：1
> 
> 时间：2012-06-25T20:41:05.657
> 
> 标签：java, swing, jbutton

我有一个非常简单的例子。屏幕底部有一个按钮，上面写着“你好”，当它点击它时，它会在控制台上打印“你好”。但是，当我按下按钮时，它不会在视觉上发生变化。它与其他 JSwing 交互器相同，但对于 SSCCE，请执行此操作。

```
import acm.program.*;
import javax.swing.*;
import java.awt.event.*;

public class SimpleGUI extends ConsoleProgram {

public void init() {
    JButton hi = new JButton("Hi");
    add(hi, SOUTH);
    addActionListeners();
}

public void actionPerformed(ActionEvent e) {
    String cmd = e.getActionCommand();
    if (cmd.equals("Hi")) println("Hello there sexy");
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T20:53:25.937

Swing 控件（包括按钮）的外观由外观控制。这包括单击时按钮是否看起来被按下。

这可能会有所帮助：

[http://docs.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html](http://docs.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html)

# r - 将基于记录的列表/对象展平为数据框

> ID：11197032
> 
> 赞同：8
> 
> 时间：2012-06-25T20:41:11.820
> 
> 标签：r

编辑：这个问题已经过时了。jsonlite包会自动变平[。](https://cran.r-project.org/web/packages/jsonlite/index.html)

我正在处理具有基于记录的编码的在线数据流，通常是 JSON。对象的结构（即 JSON 中的名称）在 API 文档中是已知的，但是，值大多是可选的，并不存在于每条记录中。列表可以包含新列表，并且结构有时非常深。这是一些 GPS 数据的非常简单的示例： http://pastebin.com/raw.php?i= [yz6z9t25](http://pastebin.com/raw.php?i=yz6z9t25)。请注意，在较低的行中，`"l"`由于没有 GPS 信号，该对象丢失。

我正在寻找一种优雅的方式将这些对象展平为数据框。我目前正在使用这样的东西：

```
library(RJSONIO)
library(plyr)

obj <- fromJSON("http://pastebin.com/raw.php?i=yz6z9t25", simplifyWithNames=FALSE, simplify=FALSE)
flatdata <- lapply(obj$data, as.data.frame);
mydf <- rbind.fill(flatdata) 
```

这可以完成工作，但是它很慢并且容易出错。这种方法的一个问题是我没有使用我对数据结构（对象名称）的了解；相反，它是从数据中推断出来的。当每个记录中碰巧缺少某个属性时，这会导致问题。在这种情况下，它根本不会出现在数据框中，而是出现在具有 NA 值的列中。这可能会导致下游问题。例如，我需要处理位置时间戳：

```
mydf$l.t <- structure(mydf$l.t/1000, class="POSIXct") 
```

`l$t`但是，如果对象不存在的数据集，这将导致错误。此外，`as.data.frame`和`rbind.fill`都让事情变得很慢。示例数据集是一个相对较小的数据集。有什么更好的实施建议吗？一个健壮的解决方案总是会产生一个具有相同列的相同顺序的数据框，并且只有行数不同。

编辑：在具有更多元数据的数据集下方。它的尺寸更大，嵌套更深：

```
obj <- fromJSON("http://www.stat.ucla.edu/~jeroen/files/output.json", simplifyWithNames=FALSE, simplify=FALSE) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T21:16:24.173

这是一个解决方案，可让您利用您对数据字段名称和类的先验知识。此外，通过避免对's 的重复调用`as.data.frame`和单次调用（都是时间密集型的），它在示例数据上的运行速度提高了大约 60 倍。`plyr``rbind.fill()`

```
cols <- c("id", "ls", "ts", "l.lo","l.tz", "l.t", "l.ac", "l.la", "l.pr", "m")   
numcols <- c("l.lo", "l.t", "l.ac", "l.la")

## Flatten each top-level list element, converting it to a character vector.
x <- lapply(obj$data, unlist)
## Extract fields that might be present in each record (returning NA if absent).
y <- sapply(x, function(X) X[cols])
## Convert to a data.frame with columns of desired classes.
z <- as.data.frame(t(y), stringsAsFactors=FALSE)
z[numcols] <- lapply(numcols, function(X) as.numeric(as.character(z[[X]]))) 
```

**编辑：**为了确认我的方法给出的结果与原始问题中的结果相同，我进行了以下测试。（请注意，在这两种情况下，我都设置`stringsAsFactors=FALSE`了避免因子水平排序的无意义差异。）

```
flatdata <- lapply(obj$data, as.data.frame, stringsAsFactors=FALSE)
mydf <- rbind.fill(flatdata)
identical(z, mydf)
# [1] TRUE 
```

* * *

**进一步编辑：**

仅作记录，这是上面自动添加的替代版本：

1.  查找所有数据字段的名称
2.  确定他们的类/类型
3.  将最终 data.frame 的列强制为正确的类

.

```
dat <- obj$data

## Find the names and classes of all fields
fields <- unlist(lapply(xx, function(X) rapply(X, class, how="unlist")))
fields <- fields[unique(names(fields))]
cols <- names(fields)

## Flatten each top-level list element, converting it to a character vector.
x <- lapply(dat, unlist)
## Extract fields that might be present in each record (returning NA if absent).
y <- sapply(x, function(X) X[cols])
## Convert to a data.frame with columns of desired classes.
z <- as.data.frame(t(y), stringsAsFactors=FALSE)

## Coerce columns of z (all currently character) back to their original type
z[] <- lapply(seq_along(fields), function(i) as(z[[cols[i]]], fields[i])) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T23:20:48.717

这是一个尝试不对数据类型做任何假设的尝试。它比@JoshOBrien 慢一点，但比 OP 的原始解决方案快。

```
Joshua <- function(x) {
  un <- lapply(x, unlist, recursive=FALSE)
  ns <- unique(unlist(lapply(un, names)))
  un <- lapply(un, function(x) {
    y <- as.list(x)[ns]
    names(y) <- ns
    lapply(y, function(z) if(is.null(z)) NA else z)})
  s <- lapply(ns, function(x) sapply(un, "[[", x))
  names(s) <- ns
  data.frame(s, stringsAsFactors=FALSE)
}

Josh <- function(x) {
  cols <- c("id", "ls", "ts", "l.lo","l.tz", "l.t", "l.ac", "l.la", "l.pr", "m")   
  numcols <- c("l.lo", "l.t", "l.ac", "l.la")
  ## Flatten each top-level list element, converting it to a character vector.
  x <- lapply(obj$data, unlist)
  ## Extract fields that might be present in each record (returning NA if absent).
  y <- sapply(x, function(X) X[cols])
  ## Convert to a data.frame with columns of desired classes.
  z <- as.data.frame(t(y))
  z[numcols] <- lapply(numcols, function(X) as.numeric(as.character(z[[X]])))
  z
}

Jeroen <- function(x) {
  flatdata <- lapply(x, as.data.frame)
  rbind.fill(flatdata)
}

library(rbenchmark)
benchmark(Josh=Josh(obj$data), Joshua=Joshua(obj$data),
  Jeroen=Jeroen(obj$data), replications=5, order="relative")
#     test replications elapsed  relative user.self sys.self user.child sys.child
# 1   Josh            5    0.24  1.000000      0.24        0         NA        NA
# 2 Joshua            5    0.31  1.291667      0.32        0         NA        NA
# 3 Jeroen            5   12.97 54.041667     12.87        0         NA        NA 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T22:28:05.560

为了清楚起见，我添加了 Josh 和 Joshua 的解决方案的组合，这是迄今为止我想出的最好的解决方案。

```
flatlist <- function(mylist){
    lapply(rapply(mylist, enquote, how="unlist"), eval)
}

records2df <- function(recordlist, columns) {
    if(length(recordlist)==0 && !missing(columns)){
      return(as.data.frame(matrix(ncol=length(columns), nrow=0, dimnames=list(NULL,columns))))
    }
    un <- lapply(recordlist, flatlist)
    if(!missing(columns)){
        ns <- columns;
    } else {
        ns <- unique(unlist(lapply(un, names)))
    }
    un <- lapply(un, function(x) {
        y <- as.list(x)[ns]
        names(y) <- ns
        lapply(y, function(z) if(is.null(z)) NA else z)})
    s <- lapply(ns, function(x) sapply(un, "[[", x))
    names(s) <- ns
    data.frame(s, stringsAsFactors=FALSE)
} 
```

该功能相当快。我仍然认为它应该能够加快速度：

```
obj <- fromJSON("http://www.stat.ucla.edu/~jeroen/files/output.json", simplifyWithNames=FALSE, simplify=FALSE)
flatdata <- records2df(obj$data) 
```

它还允许您“强制”某些列，尽管它不会导致太多的加速：

```
flatdata <- records2df(obj$data, columns=c("m", "doesnotexist")) 
```

# facebook - 无法向 Facebook 重新提交 Open Graph Action

> ID：11197033
> 
> 赞同：0
> 
> 时间：2012-06-25T20:41:16.410
> 
> 标签：facebook, facebook-graph-api, submission

我为 Open Graph 批准提交了一个监视操作。它被拒绝了，状态显示：

观看 - 电影、电视节目、电视剧集 - 需要更改 · 获取代码

如何重新提交：“需要的更改”不是可点击的链接，所有更改都在“我的”网站上……而且我在任何地方都看不到任何用于此操作的提交按钮。

请在下面进行更改并重新提交以供审核。1.) 如果您的应用为视频发布了内置的观看操作，您必须向用户明确、持续和在上下文中（例如在用户观看视频的页面上）告知他们的观看操作将在 Facebook 上发布. 2.) 如果您打算使用内嵌控件，您的应用需要向用户解释该控件的工作原理，包括启用共享时应用会将手表发布到用户时间轴的事实。3.) 您必须让用户能够删除您发布到 Facebook 的任何视频故事，并在您托管视频内容的同一页面上包含此选项。4.) 只有在用户观看了至少 10 秒的视频内容后，才能发布观看操作。进行适当的更改后，请重新提交。[https://developers.facebook.com/docs/opengraph/actions/builtin/#watch](https://developers.facebook.com/docs/opengraph/actions/builtin/#watch)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T05:10:59.897

您不需要删除您的操作，只需转到您的操作设置并再次单击“保存更改”按钮。然后，您将能够再次重新提交您的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T15:27:08.130

我能够做到这一点的唯一方法是删除动作并从头开始重新创建动作......然后提交它。

# c# - 如何绘制/绘制任意方程

> ID：11197036
> 
> 赞同：0
> 
> 时间：2012-06-25T20:41:26.010
> 
> 标签：c#, plot, equation

假设解析方程不成问题，在给定特定画布尺寸的情况下，如何制作算法来绘制任意方程？如，获取所有像素的坐标以突出显示？

我试过在给定 X 的情况下反复计算 Y，但结果看起来很草率。

这不是一个家庭作业问题。

通过绘图，我的意思是真正的图形，就像图形计算器如何绘制方程一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T20:55:05.610

您可以考虑使用样条曲线，而不是单独绘制每个像素。例如`System.Drawing.Graphics`，有一种`DrawCurve`方法可以通过多个点绘制平滑曲线（样条曲线）。另外设置`SmoothingMode`为`AntiAlias`

```
e.Graphics.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.AntiAlias; 
```

* * *

如果可能，请考虑将函数作为 lambda 表达式传递。这比解析作为字符串给出的表达式更容易。

```
public void DrawCurve(PointF[] points, Func<float,float> f)
{
    ...
    float y = f(x);
    ...
} 
```

例如

```
DrawCurve(points, x => (float)Math.Sin(x)/(x * x + 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T20:49:39.807

考虑使用 .NET Framework 4 中包含的（Windows 窗体）数据可视化图表库。此处的 API 文档[和](http://msdn.microsoft.com/en-us/library/dd456726.aspx)[此处](http://msdn.microsoft.com/en-us/library/system.windows.forms.datavisualization.charting.aspx)的技术参考页面。

# asp.net - 尝试上传 14mb 的文件时，fileupload 控件不执行任何操作

> ID：11197041
> 
> 赞同：2
> 
> 时间：2012-06-25T20:41:44.523
> 
> 标签：asp.net, internet-explorer, firefox, file-upload

我现在遇到了这个奇怪的问题，在网上搜索了几次之后，我找不到任何与之相关的东西，基本上，当我尝试通过 FileUpload ASP.NET 控件发送一个 14mb 的 .TXT 文件时，它什么也没做，当我点击上传按钮时页面回发，但“点击”事件没有触发

奇怪的是，如果我尝试发送一个小文件，比如说，100kb 的上传工作得很好，并且事件被触发的方式应该是

没有例外，根本没有错误，页面只是回发而不触发任何事件，我什至更改了我的 web.config 上的 maxRequestLength 仍然没有运气：

```
<httpRuntime executionTimeout="43200" maxRequestLength="40960"/> 
```

我尝试通过 Internet Explorer 9 和 Firefox 12 上传，两者都有相同的奇怪行为

* * *

我在 ASP.NET 应用程序上使用 .NET v3.5 在 Windows 7 x64 (IIS 7.5) 上对其进行测试

* * *

现在我很确定这是文件大小限制，我将文件“切片”为 1mb 部分，现在我可以上传它，只要它超过 1mb，它就会开始发回而不触发任何事件

* * *

找到了解决办法，答案如下，谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:53:56.533

发现问题，我不得不更改“c:\Windows\System32\inetsrv\config\applicationHost.config”

有一个类似于这个的标签：

```
<location path="YourWebSite">
    <system.webServer>
        <serverRuntime maxRequestEntityAllowed="4294967295" uploadReadAheadSize="2147483647" />
        </system.webServer>
</location> 
```

我将**maxRequestEntityAllowed**和**uploadReadAheadSize**都更改为上面的值，现在正在上传文件

感谢大家！

# android - 如何将 ImageIO.write(input, file, cos) 转换为在 Android 中使用

> ID：11197046
> 
> 赞同：-1
> 
> 时间：2012-06-25T20:42:07.263
> 
> 标签：android

我从一些用 Java 开发的想要在 Android 中使用的代码中得到错误。

```
ImageIO.write(input, file, cos) 
```

这些是我在 android 中的以下代码的错误，该代码在 Java 中有效： BufferedImage 无法解析为类型 ImageIO 无法解析

```
 public void decryptFile(String key, String typeFile) throws InvalidKeyException, 
                                                          NoSuchAlgorithmException, 
                                                       InvalidKeySpecException, 
                                                            NoSuchPaddingException, 
                                                                       IOException
   {

       DESKeySpec dks = new DESKeySpec(key.getBytes());
       SecretKeyFactory skf = SecretKeyFactory.getInstance("DES");
       SecretKey desKey = skf.generateSecret(dks);
       Cipher pbeCipher = Cipher.getInstance("DES"); // DES/ECB/PKCS5Padding for SunJCE

       pbeCipher.init(Cipher.DECRYPT_MODE, desKey);    

        // Decrypt the ciphertext and then print it out.     
        FileInputStream output = null;

        File encryptedFile = new File(Environment.getExternalStorageDirectory() + "/images/Et1.jpg");   
        File decryptedFile = new File(Environment.getExternalStorageDirectory() + "/images/Dt1.jpg");

        try 
        {

        output = new FileInputStream(encryptedFile);
        } 
        catch (FileNotFoundException e) 
        {
        // TODO Auto-generated catch block
        e.printStackTrace();
        }

    CipherInputStream cis = new CipherInputStream(output, pbeCipher);
    BufferedImage input = null;

    try 
    {
        input = ImageIO.read(cis);
    } 
    catch (IOException e) 
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    FileOutputStream out = null;

    try 
    {
        out = new FileOutputStream(decryptedFile);
    } 
    catch (FileNotFoundException e) 
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    try 
    {
        ImageIO.write(input,typeFile, out);
    } 
    catch (IOException e) 
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    try 
    {
        cis.close();
    } 
    catch (IOException e) 
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T20:46:04.363

我有类似的问题

```
import javax.sound.sampled.*; 
```

您需要找到相应的导入（可能是 ImageIO）并为我找到一个替代品

```
import android.media.AudioFormat;
import android.media.AudioRecord;
import android.media.MediaRecorder; 
```

如果不是这样，请发布您的错误。
还要记住，这不仅仅是切换导入的问题，我必须将代码移植到新库。

# javafx-2 - 如何将键盘焦点限制在节点内的控件上？

> ID：11197048
> 
> 赞同：4
> 
> 时间：2012-06-25T20:42:12.943
> 
> 标签：javafx-2

我正在尝试实现一种可重用的方法来将节点显示为轻量级对话框。该节点被添加到 StackPane 的顶部，而背景随后被模糊。有2个问题：

1) 堆栈窗格的后台节点中的控件仍然能够接收焦点。

2）如何将焦点放在顶级节点。我知道 Node 上有一个 requestFocus 方法，但我需要将它交给嵌套在节点内的控件。由于这是一种可重用的方法，因此我不能直接引用控件。

（如果我可以通过找到现有的实现来回避整个问题，那将是最好的，但我还没有找到第 3 方解决方案）

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T09:28:49.350

对于：
1) 3 个替代建议，
**a-**在对话框窗格中添加一个键事件处理程序以捕获`Tab`按键

```
dialogbox.addEventFilter(KeyEvent.KEY_PRESSED, new EventHandler<KeyEvent>() {

    @Override
    public void handle(javafx.scene.input.KeyEvent event) {
        if (event.getCode() == KeyCode.TAB) {
            System.out.println("TAB pressed");
            event.consume(); // do nothing
        }
    }
}); 
```

**b-**暂时禁用`StackPane`除最后添加的对话框子项之外的所有子项。

```
// Assuming dialogbox is at last in the children list
for(int i=0; i<mainPane.getChildren().size()-1; i++){
     // Disabling will propagate to sub children recursively
    mainPane.getChildren().get(i).setDisable(true);
} 
```

**c-**与**b**`node.setFocusTraversable(false)`相同，但通过(spot kick)手动禁用对控件的对焦。当然这不会是你的选择..

2）告诉对话框显示对话框后哪个节点应该获得焦点（通过构造函数或setter方法）。

```
// init dialogbox and show it then
dialogbox.setFocusTo(node_in_dialogbox); 
```

# zend-framework - 围绕/并行 Zend Framework 应用程序构建 Joomla 站点

> ID：11197049
> 
> 赞同：2
> 
> 时间：2012-06-25T20:42:17.953
> 
> 标签：zend-framework, joomla

我的团队有一个相当大的 Web 应用程序，它是使用 Zend 框架构建的，在过去的一年里，它已成为我们组织的关键任务。它是作为现有采埃孚公司网站的一部分构建的，不再满足我们的需求。

ZF 应用程序在数据库中有自己的用户表。它还使用 Zend_Acl 和一些数据库表来控制对模块和单个记录的访问。这些记录主要与系统中的人有关。

由于新的业务需求，我们现在面临在 Joomla 中建立一个新的公共网站。因此，我们需要：(1) 以某种能力继续运行旧系统，以及 (2) 一个闪亮的新 Joomla 站点，(3) 两者之间的集成。

-我们不能将用户的监护权从我们的遗留系统中移开，因为这些用户所代表的人对遗留系统的目的至关重要。

-我们需要用户名和密码相同，并且工作相同（我们有 60 天的重置政策，我们的用户名不是固定值/有点复杂）

- 我查看 Zend_Ldap 希望我可以通过这种方式将我们的用户暴露给 Joomla，但它似乎只是一个 LDAP 客户端，而且我不确定在 Zend 中实现一个使用我们现有表的 Ldap 服务器是否能很好地利用时间。替换 Joomla 身份验证的扩展可能会更明智。

-我们的 ACL 可以控制 Joomla 还是应该让两个 ACL 并行存在。

- 我们是在 Zend 应用程序中编写 SOAP 服务以将数据公开给扩展，还是我们只是将数据库凭据直接提供给 Joomla 扩展。

我知道这是一个相当广泛的问题，但我只是在寻找广泛的答案：你将如何解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:52:49.343

1.  第一步听起来像是在 Joomla 中集成 Auth 系统！从那里您的 ZF 应用程序可以直接链接到已登录用户的 ZF 应用程序页面。我会推荐使用[JFusion](http://jfusion.org/)来集成 Joomla！授权过程并匹配两个系统中的 ACL 组。您必须为 JFusion 编写自己的插件，但这与将整个应用程序移植到 Joomla 相比非常简单！扩大。[JFusion 的 GitHub 存储库在这里。](https://github.com/jfusion)

2.  鉴于提供的数据，您将需要运行 ZF 应用程序作为`master`身份验证并将用户数据同步到 Joomla！通过您的自定义插件。

3.  一旦您的插件进行身份验证，您就可以使用 JFusion 的直接链接模式以登录 Joomla 的用户身份链接到 ZF 应用程序！将自动登录到 ZF 应用程序（反之亦然）。

# ruby-on-rails - Rails 雇主和雇员设计

> ID：11197052
> 
> 赞同：3
> 
> 时间：2012-06-25T20:42:32.333
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.1, devise, sti

我试图弄清楚如何构建这个请帮助：我需要用户能够注册为雇主或雇员。雇主基本上是公司，雇员是从事该工作的人。我想知道如何记录员工何时/是否被雇用和终止工作。协会会`has_many:through`为此工作还是更好，但是否有一个我忽略的宝石可以帮助我解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-10T03:31:04.897

这是分层对象模型的经典案例，因此您必须根据所涉及的*对象*及其*相互关系*来考虑这个问题。想想企业在现实生活中的运作方式：

雇主 -> 雇员不是雇主 -> 经理等 -> 雇员

这种系统模型的一个很好的例子是 GitHub。在 GitHub 上，用户可以*属于*组织。他们还可以创建并管理它们，管理成员等（在您的情况下雇用和解雇）。因此，一个更好的建模这个系统的方法是让它以用户为中心，而不是分成两个不同的用户类别。

> 如前一个答案所述，不应将雇主（或这种意义上的企业）视为系统的用户，因为他们不会对程序的状态采取行动，用户会。因此，我个人认为 STI 对于这个系统模型来说有点矫枉过正。

所以...

**企业中雇用的所有**人员都是员工，但并非所有员工都具有*相同级别*的权限（例如，经理将比初级员工拥有更多权限）。因此，您应该建模 a `Business`，它*有很多* `Employee`s。这些`Employee`s 将根据其职位具有不同级别的权限：

*   可以雇用吗？
*   可以开火吗？
*   等等

您还可以创建一个方法来告诉您何时`Employee`雇用/解雇。如果他们被雇用/解雇或`nil`没有，这些可能会返回日期/时间。`nil`从这个意义上说，显然意味着他们还没有被雇用/解雇。

在管理不同用户的能力时，他们的权限级别由他们可以做什么和不能做什么来定义。您当然可以通过检查上述方法的简单方法将预设角色应用于这种情况。例如：

```
def manager?
  self.can_hire? and self.can_fire?
end 
```

然后，您还可以定义允许创建业务的能力：

```
def can_create_business?
  self.manager?
end 
```

注意：您可以使用范围来优雅地实现这一点。

您还可以为您的角色子类化一个基本用户模型，或者创建一个定义上述方法并作用于给定用户模型的角色类。然后，您可以创建单个角色和角色子集。

可以说，在某些情况下，允许将雇主/企业和雇员创建为可以对项目状态采取行动的独立实体是有用的。如果它`Business`可以执行的不仅仅是简单的管理功能，那么这可能是值得的。在这种情况下，我仍然不会将业务视为用户模型。我需要创建一个特殊的用户帐户以及具有`Business`角色`Business Administrator`或类似角色的用户帐户。

这个模型总体上遵循编程和计算机科学中的一些最基本的原则，所以我希望它能对你的问题有所帮助。当然，有许多可用的 gem 内置了这个功能，即**Devise**和**CanCan/CanTango**，尽管我会亲自构建这个系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T12:45:56.147

我想我会将 STI 与有很多通过关系结合起来。

我将首先创建一个 Employers 和 Employees 的单表继承。

```
class User < ActiveRecord::Base
  ...
end

class Employer < User
end

class Employee < User
end 
```

雇主雇用雇员。一个雇主可以拥有许多雇员，并且随着就业而来的是其他相关属性，例如`date_of_hire`, `designation`, `status`,`manager_id`等`department`。因此我会将其建模为一个单独的对象，因此将此信息存储在一个单独的表中。让我们这样称呼，`Employment`好吗？

```
rails g model employment employer_id:integer, employee_id:integer, date_of_hire:date, designation:string, status:string, manager_id:integer 
```

现在让我们建立关系。

```
class Employment < ActiveRecord::Base
  belongs_to :employer # Foreign key options should not required because of User STI
  belongs_to :employee
  belongs_to :manager,  :foreign_key => :manager_id,  :class_name => "User"
end

class Employee < User
  has_many :employments
  has_many :employers
  has_one  :manager,      :through     => :employments, :foreign_key => :manager_id
end

class Employer < User
  has_many :employments, :foreign_key => :employer_id
  has_many :employees,   :through     => :employments
end 
```

基于业务规则，我们可以实现优雅的范围。

```
class Employee < User
  ...
  scope :fired, :where => {:status => 'fired'}
  scope :recently_joined, :where => {:date_of_hire => 3.months.ago...Date.today}
  scope :developers, :where => {:designation => 'developer'}
  ... 
end 
```

和...

```
Employee.recently_joined
Employee.recently_joined.developers
Employee.fired 
```

请理解，这显然不是经过测试的代码，可能存在一些故障。

## 然而！

我强烈建议您重新考虑将雇主建模为用户的需求。从我个人的经验来看，结果证明是未来的灾难（可能是我当时没有经验，但我不会再走那条路了）。我真的会为 Employer 和 Employee 建立单独的模型，并建立如上所述的关系，但使用 foreign_key 和 class_name 属性。主要原因是 STI 要在您的域中工作，雇主和雇员应该与用户具有“IS A”关系。您可能会认为这是一个“IS A”关系，但也认为它是否与“IS A”关系的“TYPE”相同。在我处理的应用程序中，它没有任何意义，但我们还是选择了 STI。雇主有完全不同的特征，员工在申请中的身份和待遇。尽管两者都有一些相同的数据，但它们的存在目的不同，用途也不同。这足以（单一职责）对它们进行单独建模。STI 是一个可以解决问题的棘手工具。但是错误地使用它，它会产生比它所解决的问题更多的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T07:40:56.783

只需使用 has_many, :through。它会完成工作。假设您需要为一家您可以做的公司招募所有在职员工

```
class Employers   
  has_many  :hired_employees, :through => :employments, 
            :class_name => "Employees", 
            :source => :employee, 
            :conditions => ['employment.status= ?',"hired"] 
end 
```

然后你可以做`Employers.first.hired_employees`。您可以添加更多并使用不同的条件，以便您可以“终止”、“解雇”等。

当然，这假设您有第三个模型，称为就业，它属于雇员和雇主。您的 Employee 和 Employment 类可能如下所示：

```
class Employee
  has_many :employments
end

class Employment
  belongs_to :employee
  belongs_to :employer
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T14:37:32.673

根据您所说，您可能需要以下模型：用户、工作、分配、角色

```
class User
    ... some devise declarations here ...
    ... some role here. rolify gem is my suggestion ...
    scope :employee, :where => {user.has_role? :employee}
    scope :employer, :where => {user.has_role? :employer}
    has_many :jobs, :through => :assignments 
    has_many :assignments 
end

class Job
    belongs_to :user # employer
    has_many :assignments
    has_many :users, :through => :assignments # employee
end

class Assignment
   belongs_to :job
   belongs_to :user # employee
   def fired?
       ... stuff to check if the employee is fired
   end
   def hired?
       ... stuff to check if the employee is hired
   end
end 
```

优点：

*   您可以轻松添加更多角色，例如经理、管理员……。使用 rolify gem 或者您可以为自己创建角色模型
*   作业类将存储您需要存储的任何内容，例如解雇，雇用的员工
*   由于角色是明确预定义的，因此可以使用 cancan 等授权 gem 轻松添加访问控制。

缺点：

*   使用此模型，用户必须在执行任何其他操作之前检查您正在处理的当前用户是雇主还是雇员。但是，这可以使用角色轻松检查

为简单起见，您可以使用 rails_app_composer gem 生成安装了 devise、cancan 和 rolify 的初始应用程序。

注意：此答案基于许多类似的问题，例如： [多态性或 STI](https://stackoverflow.com/questions/7907703/rails-complicated-design-choice-polymorphism-sti)

# php - 如何找出叉子的最佳数量

> ID：11197053
> 
> 赞同：-3
> 
> 时间：2012-06-25T20:42:32.253
> 
> 标签：php, linux, memory, fork

我有一个全面的 PHP 脚本（在 Linux 上），它偶尔需要进行大量的网络对话。为此，它分叉了许多孩子。问题是脚本如何识别它们的最佳数量？如果数字太大，服务器会耗尽物理内存并且孩子开始交换 - 性能损失。那么我怎样才能获得真正的可用物理内存量呢？出于显而易见的原因，“免费”命令不会告诉我真实情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T20:51:41.383

`free`将在第二行为您提供正确的图片（不包括带有标题的行）。这是一个示例输出：

```
 total       used       free     shared    buffers     cached
Mem:       2060420    1754008     306412          0      97264    1013548
-/+ buffers/cache:     643196    1417224
Swap:      1951888          0    1951888 
```

第一行中的空闲列毫无用处，因为磁盘缓存也在其中。您很少需要第一行有任何空闲内存。另一方面，在第二行中，磁盘缓存被减去。这就是机器当前的真实内存使用情况！

这是一个用于读取和解析输出的 PHP 函数`GNU free`：

```
// Get system mem usage in kilobytes
// Returns: array($used, $free), or false on failure
function memory_usage() {
  exec('free -k', $lines, $error);
  if ($error) return false;
  $cols = preg_split('/\s+/', $lines[2]);
  return array((int) $cols[2], (int) $cols[3]);
}

// Usage:
list($used, $free) = memory_usage();
printf("used: %d\nfree: %d\n", $used, $free); 
```

# c# - 返回在特定文件夹中修改的文件列表

> ID：11197056
> 
> 赞同：0
> 
> 时间：2012-06-25T20:42:39.747
> 
> 标签：c#, visual-studio, tfs

如何从 TFS 获取特定文件夹中所有更改的列表？

假设我的应用程序代码布局如下：

```
/myapp/
/myapp/admin/...
/myapp/section1/...
/myapp/section2/... 
```

如何获取文件夹中发生的所有更改的列表`section1`？

我想要一个从该文件夹中更改的文件列表，以及变更集#，并且能够理想地查看文件的比较。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T20:49:42.350

1.  转到源代码管理资源管理器。
2.  导航到您要为其挂起更改的文件夹。
3.  右键单击该文件夹并选择“查看挂起的更改”。

如果您想比较所有更改的文件，请重复上述过程，除了选择“比较”而不是“查看待定更改”。

# java - 测试非默认 App Engine 任务队列

> ID：11197058
> 
> 赞同：4
> 
> 时间：2012-06-25T20:42:44.567
> 
> 标签：java, google-app-engine

App Engine 文档提供了一个单元测试任务队列的[示例](https://developers.google.com/appengine/docs/java/tools/localunittesting#Writing_Task_Queue_Tests)，它适用于“默认”队列，但我需要对非默认队列进行单元测试。

我从以下行中得到一个例外：

```
val qsi = ltq.getQueueStateInfo.get("non-default"); 
```

我假设我需要在我的测试环境中配置非默认队列，其方式与需要配置非默认生产队列（通过 queue.xml）大致相同，但我不确定如何去做。

我的测试环境中的某处是否需要 queue.xml 文件？如果是这样，在哪里。

我在资源目录中使用 queue.xml 文件尝试了以下操作，但它抱怨找不到`org/mortbay/xml/XmlParser`

```
 val ltqtc = new LocalTaskQueueTestConfig
 ltqtc.setQueueXmlPath(this.getClass.getResource("queue.xml").getPath)
 val helper = new LocalServiceTestHelper(ltqtc) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T02:57:20.610

是的，您像其他单元测试工具类一样对其进行配置，并将其传递给您的测试 queue.xml 的路径，我的恰好位于 /src/test/resources 中（maven 项目的常用位置）

这是我的基本junit测试类的一个片段......

```
static {
    dir = System.getProperty("user.dir") + "/src/test/resources/queue.xml";

}
private final LocalServiceTestHelper helper = new LocalServiceTestHelper(
        new LocalDatastoreServiceTestConfig(),
        new LocalTaskQueueTestConfig().setQueueXmlPath(dir)); 
```

然后你可以做类似的事情（如果这与上下文无关，很抱歉，但它应该给你这个想法......而且它很时髦，所以它可能看起来很奇怪）

```
//do something that might trigger a queue to run...
    NotificationService.getInstance().doNotification(interaction)

    LocalTaskQueue taskQueue = LocalTaskQueueTestConfig.getLocalTaskQueue()
    Map allQueues = taskQueue.getQueueStateInfo()
    QueueStateInfo mailQueue = allQueues.get(EmailTaskQueue.MAIL_QUEUE)
    assert mailQueue.getCountTasks() == 1 
```

有关 Rick Mangi 评论的更多详细信息。如果您收到如下错误：

```
 java.lang.NoClassDefFoundError: org/mortbay/xml/XmlParser 
```

将此添加到您的 pom.xml 中：

```
<dependency>
  <groupId>com.google.appengine</groupId>
  <artifactId>appengine-tools-sdk</artifactId>
  <version>${gae.version}</version>
</dependency> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-20T22:08:11.413

使用 gradle 插件时，请确保包括：

```
testCompile 'com.google.appengine:appengine-tools-sdk:1.9.9' 
```

# azure - 为什么 CloudConfigurationManager 使用我的 Cloud.cscfg 而不是 Local.cscfg？

> ID：11197059
> 
> 赞同：4
> 
> 时间：2012-06-25T20:42:48.900
> 
> 标签：azure, azure-configuration

我已将我的应用程序配置为在开发设置中使用服务配置本地。

我有两个 cscfg 文件（默认情况下）云和本地。我为存储添加了连接字符串，告诉它在 Cloud.cscfg 中使用真实帐户，并为 Local.cscfg 使用开发存储。

但是，当我运行我的项目并使用该行时

```
var setting = CloudConfigurationManager.GetSetting("StorageConnectionString"); 
```

它正在使用我的云配置并返回我的实时存储。这绝对是我的 Cloud cscfg，而不是其他设置值，就好像我在 Cloud 中更改它一样，设置返回的更改。

这是设计使然吗？有什么方法可以查看 CloudConfigurationManager 用于选择配置的逻辑吗？

奇怪的是，我确信这很早之前就有效了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T21:25:28.553

删除了项目的所有编译版本。重新启动计算和开发存储服务，问题就消失了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-14T15:33:53.147

尝试删除所有编译版本并多次重新启动模拟器无济于事。

发现我的设置不对。

因此，右键单击您的云服务项目（不是角色，而是项目）和“属性”。

然后转到“开发”选项卡（从左至右），您将在“运行/调试类别”下看到“服务配置”设置。

这需要是本地云服务项目才能使用本地设置。

# openjpa - OpenJPA 中的 DistinctResultList

> ID：11197061
> 
> 赞同：0
> 
> 时间：2012-06-25T20:43:00.403
> 
> 标签：openjpa

我正在尝试获取一个不同的 id 返回列表，这将是很长的……但我正在取回这个 DistinctResultList ……如何处理这个问题，以便他们获得他们期望的结果……这就是我正在做...

```
@NamedQuery(name="getProvidersByResourceIds", query = "SELECT DISTINCT p.resourceId FROM Provider p WHERE p.resourceId `in :resourceIds")` 
```

除此之外，我尝试通过这样做来获取 resourceIds'...

```
List<Long> provIDs = (List<Long>) emf.createNamedQuery("getProvidersByResourceIds").setParameter("resourceIds", values).getResultList(); 
```

但就像我说的，我不断返回 DistinctResultList... 查看调试器，我可以看到返回的值。我怎样才能把它翻译成有用的东西？

```
javax.ejb.EJBException: See nested exception; nested exception is: java.lang.IllegalArgumentException: Parameter "Parameter<long>('resourceIds')" declared in "SELECT p FROM Provider p WHERE p.resourceId = :resourceIds" is set to value of "org.apache.openjpa.kernel.DistinctResultList@35fb35fb" of type "org.apache.openjpa.kernel.DistinctResultList", but this parameter is bound to a field of type "long".
java.lang.IllegalArgumentException: Parameter "Parameter<long>('resourceIds')" declared in "SELECT p FROM Provider p WHERE p.resourceId = :resourceIds" is set to value of "org.apache.openjpa.kernel.DistinctResultList@35fb35fb" of type "org.apache.openjpa.kernel.DistinctResultList", but this parameter is bound to a field of type "long" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T12:35:07.763

将您的查询更改为：

```
@NamedQuery(name="getProvidersByResourceIds", 
    query = "SELECT DISTINCT p.resourceId FROM Provider p WHERE p.resourceId in (:resourceIds)"); 
```

# asp.net - 在 WCF 服务中进行调试时观察 ServiceHost 的最佳方式是什么？

> ID：11197062
> 
> 赞同：0
> 
> 时间：2012-06-25T20:43:01.197
> 
> 标签：asp.net, wcf, debugging

在 WCF 服务中进行调试时观察服务主机的最佳方式是什么？我想知道服务主机的绑定属性和其他信息。

我希望会有类似 ServiceHost.GetCurrent 的东西，但显然这是不对的，谷歌搜索只会产生关于如何配置或调整服务主机的文章。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T22:50:59.810

您可以使用`System.ServiceModel.OperationContext.Current.Host`来访问当前运行的 ServiceHost 对象。 `OperationContext`还包含其他好东西，例如`IncomingMessageHeaders`一个示例。

# php - 在表达式引擎中构建内容

> ID：11197068
> 
> 赞同：0
> 
> 时间：2012-06-25T20:43:17.343
> 
> 标签：php, content-management-system, expressionengine

我需要一些帮助来找出使用 Expression Engine 构建内容的最佳方式。我已将文档涂红，查看了我能找到的所有信息，但我没有找到答案。我希望这里有人可以提供帮助。

我要创建的是一个如下所示的产品目录：

`/bikes`（产品类别，显示产品系列，两轮车，三轮车等）

`/bikes/two-wheelers`（产品家族，展示家族中的产品）

`/bikes/two-wheelers/red-bike`（产品）

`/bikes/two-wheelers/red-bike/wheels`（可选的产品详细信息页面）

我了解 EE URI 是基于模板组/模板的，并且内容位于频道中。我还不确定如何在其中使用类别。本质上，我想在条目之间创建“简单”的父子关系芯片，我找到了一个名为 Structure 的插件，它可以做类似的事情。不幸的是，这个项目需要在没有额外（付费）插件的情况下完成。

是否有可能`product`成为渠道，并`product-family`成为EE`product-category`中的属性？`product`那行得通吗？有没有更好的方法来构建它？

我意识到这不是一个直截了当的问题，但我仍然希望指出正确的方向。谢谢阅读！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T23:11:17.873

您可能想要做的是使用类别将您的产品分成多个系列。您可以像这样嵌套类别：

*   自行车
    *   两轮车
    *   三轮车
    *   高的

然后，您将为您的“Red Bike”频道条目分配“Bikes”和“Two Wheelers”类别。

对于额外的产品详细信息页面，您可能可以使用相关条目。设置一个名为“车轮类型”的频道，然后发布所有不同类型车轮的条目。然后使用“产品”频道中的关系字段类型将特定车轮类型与“红色自行车”条目相关联。然后，您可以使用模板中的相关条目标签链接到该详细信息页面。

Structure 模块确实可以帮助您轻松制作您正在寻找的 URL，但如果您不能使用它，那么[Freebie 扩展](http://devot-ee.com/add-ons/freebie)应该会有所帮助。但是，当然，您花时间弄清楚如何使用 Freebie 来满足您的需求可能远远超过 Structure 许可证的成本。

# android - 地理点地址

> ID：11197070
> 
> 赞同：0
> 
> 时间：2012-06-25T20:43:21.353
> 
> 标签：android, google-maps

我想知道如何将地理点转移到地址示例

```
double src_lat =30.022584 ;
        double src_long = 31.343822;
   srcGeoPoint = new GeoPoint((int) (src_lat * 1E6),(int) (src_long * 1E6)); 
```

我怎样才能得到这个 srcGeoPoint 的地址

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T20:52:44.863

尝试这样的事情

```
 Geocoder geoCoder = new Geocoder(
                getBaseContext(), Locale.getDefault());
            try {
                List<Address> addresses = geoCoder.getFromLocation(
                    srcGeoPoint.getLatitudeE6()  / 1E6, 
                    srcGeoPoint.getLongitudeE6() / 1E6, 1);

                String add = "";
                if (addresses.size() > 0) 
                {
                    for (int i=0; i<addresses.get(0).getMaxAddressLineIndex(); 
                         i++)
                       add += addresses.get(0).getAddressLine(i) + "\n";
                }

                Toast.makeText(getBaseContext(), add, Toast.LENGTH_SHORT).show();
            } catch (IOException e) {                
                e.printStackTrace();
            } 
```

取自： http: [//mobiforge.com/developing/story/using-google-maps-android](http://mobiforge.com/developing/story/using-google-maps-android)

请参阅页面一半左右的地理编码和反向地理编码

您可能还想查看 [https://developers.google.com/maps/documentation/geocoding/](https://developers.google.com/maps/documentation/geocoding/)

# python - 在 Python 中将 *args 传递给 string.format？

> ID：11197072
> 
> 赞同：3
> 
> 时间：2012-06-25T20:43:51.447
> 
> 标签：python, logging, args

是否可以将 *args 传递给 string.format？我有以下功能：

```
@classmethod
def info(cls, component, msg, *args):
    """Log an info message"""
    cls.__log(cls.Level.INFO, component, msg, args)

@classmethod
def __log(cls, level, component, msg, *args):
    """Log a message at the requested level"""
    logging.getLogger("local").log(level, " - ".join([component, msg.format(args)])) 
```

当我尝试使用 LogCapture 对其进行单元测试时，我得到以下信息：

```
def test_logWithArgs(self):
    Logger.level(Logger.Level.INFO)
    with LogCapture(level=Logger.Level.INFO) as lc:
        Logger.info("MyComponent", "{0}", "TestArg")
        lc.check(("local", "INFO", "MyComponent - TestArg"))

AssertionError: Sequence not as expected:

same:
()

first:
(('local', 'INFO', 'MyComponent - TestArg'),)

second:
(('local', 'INFO', "MyComponent - (('TestArg',),)"),) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-25T20:46:11.037

我想你想做的是

```
msg.format(*args) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-25T20:49:02.307

是的。

```
>>> a=(1,2,3,4)
>>> "{0}{1}{2}{3}".format(*a)
'1234' 
```

# javascript - 满足条件时禁用动画jQuery

> ID：11197074
> 
> 赞同：1
> 
> 时间：2012-06-25T20:44:04.410
> 
> 标签：javascript, jquery

这可能是一个简单的问题，也许我在这里遗漏了一些东西。

期望的效果是当用户单击`.left`或`.right`href 标签时，`.tabs`滚动条`105px`每次都会向左或向右滚动。这部分正在工作。

我遇到障碍的地方是如何在`.tabs`div 的 css 位于`0px`或位于 div 末尾时禁用动画效果。这似乎可以很容易地完成，`offset`或者`position`但是这两者都给了我不同的价值。我相信这是因为`.tabs`div 实际上是使用`magin: 0 auto`.

试图检索`css("left")`并编写条件`if == 0`语句也是失败的。

我在这里错过了什么吗？我不应该尝试`left`根据位置禁用按钮吗？有没有更简单的方法来做到这一点？

```
$(".right").click(function () {
    $(".tabs").animate({
        left: '-=105'
    }, 500);
    return false;
});
$(".left").click(function () {
    $(".tabs").animate({
        left: '+=105'
    }, 500);
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:06:55.987

根据他的问题中的评论，

`$(".tabs").css('left')`返回值`px`

所以，比较一下，要么你做

`$(".tabs").css('left') === '0px'`

或者

`parseInt($(".tabs").css('left')) === 0`

# javascript - 理解 Javascript 设计模式中的差异

> ID：11197075
> 
> 赞同：0
> 
> 时间：2012-06-25T20:44:08.607
> 
> 标签：javascript, oop

不久前我拿起[这本书](https://rads.stackoverflow.com/amzn/click/com/159059908X)来帮助理解如何将我对 Java 设计模式的知识应用到 Web 开发中。但是，我在介绍中遇到了一个奇怪的差异。

作者指出，以下代码定义了一个允许用户创建动画对象的类：

```
//Anim class

var Anim = function(){ /*code here*/ };
Anim.prototype.start = function(){ /*start code here*/ };
Anim.prototype.stop = function() { /*stop code here */};

//create a new Anim object and call the start method
var newAnim = new Anim();
newAnim.start(); 
```

我用我的应用程序尝试了类似的东西。

```
//Nucleus class and addLink function
var Nucleus = function(){
  this.location=null;
  this.links = [];
}

//revamp object and add to link array
Nucleus.prototype.addLink = function(marker){  } 
```

上面的类通过实例化为全局变量

```
var curSpot = new Nucleus(); 
```

但是，Firebug 在页面加载时抛出了一个错误，指出`Nucleus is not a constructor`，并且 Javascript 按钮处理功能被禁用。问题已通过将`Nucleus`定义更改为

```
function Nucleus(){ /*instance members here*/ } 
```

现在 OO 功能起作用了。为什么后一个示例有效，但本书的示例却抛出错误？

应 Ryan Lynch 的要求，发布了更多代码。这是唯一使用 1curStop 的代码。作为一个全局变量，

```
//global variables
var curStop = new Nucleus();

function showMarkers(){
//unreleated code here

  var tourList = [];

  //handles a double click event, adds current marker to list and creates one
  //if not null.  Otherwise, create a new Nucleus object and add current location
  (function(marker){
    google.maps.event.addListener(marker, 'dblclick', function(){
      if (curStop != null){
        tourList.push(curStop);
        curStop = null;

      } else {
        curStop = new Nucleus();
        curStop.addLocation(marker);
      }
    }); //end listener
  })(marker);
}

function postTour(){

  //need CurStop to be a global variable, since only new double-click events add the
  //object to the tourList array.  This makes sure that all objects are saved on
  //button click
  tourList.push(curStop);
} 
```

# javascript - 按钮不会使用 jQuery 重新启用它自己

> ID：11197078
> 
> 赞同：1
> 
> 时间：2012-06-25T20:44:19.953
> 
> 标签：javascript, jquery

我无法弄清楚为什么单击另一个按钮时我的按钮不会重新启用。任何帮助将不胜感激

我的代码如下：

```
$(document).ready(function() {
    $('#btnAdd').click(function() { 
        // enable the "remove" button
        $('#btnDele').attr('disabled','');
    }
}); 
```

在这里演示：http: [//jsfiddle.net/ATzBA/2/](http://jsfiddle.net/ATzBA/2/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T20:48:12.817

```
 $('#btnDele').attr('disabled',false); 
```

应该做的伎俩。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-25T20:50:27.187

你也可以试试`$("#btnDele").removeAttr('disabled');`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-25T20:54:46.903

prop 函数是在 JQuery 中执行此操作的***正确方法。***

```
$('#btnDele').prop('disabled', false); //enabled
$('#btnDele').prop('disabled', true); //disabled
$('#btnDele').prop('disabled'); //returns true if disabled, false if enabled. 
```

[请参阅此处](http://api.jquery.com/prop/)的文档。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-25T20:50:19.857

“禁用”属性必须完全删除，而不仅仅是设置为 null/空字符串。你需要使用 jQuery 的`removeAttr()`：

```
$(function(){
     $('#btnAdd').click(function(e){
          $(this).removeAttr('disabled');
      });
 }); 
```

有人在这里谈论它/浏览器兼容性问题：[Toggle input disabled attribute using jQuery](https://stackoverflow.com/questions/4702000/jquery-toggle-input-disabled-attribute)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-25T20:48:57.937

我不使用 .attr 函数，而是使用 Jquery UI 并使用 $('#btnDele').button("enable"); [http://docs.jquery.com/UI/Button#methods](http://docs.jquery.com/UI/Button#methods)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-25T20:55:49.800

$(document).ready(function() { $('#btnAdd').click(function() {

```
 // to enable the "remove" button
        // set 'disabled to false'
        $('#btnDele').attr('disabled','false'); 
```

}); });

# c# - 如何处理以前与现在不再存在的对象的方法关联的委托？

> ID：11197079
> 
> 赞同：0
> 
> 时间：2012-06-25T20:44:24.253
> 
> 标签：c#, .net, wcf, delegates

[我像这个例子](http://msdn.microsoft.com/en-us/library/ms752254.aspx)一样创建了一个双工服务（`NetTcpBinding`）：我使用了发布-订阅模式，并且对于来自新客户端的每个连接请求，它都会创建一个新的服务实例（包含不同的回调）。在此示例中，回调是通过事件和委托调用的。

现在我想改变这个例子：假设我们不想立即响应客户端的请求，即假设我们想在一定的时间间隔后调用回调方法。在这种情况下，我需要维护对回调方法的引用......但是如果同时某些客户端断开连接会发生什么？服务实例被销毁，我们甚至失去了回调......

我写了这个例子：

*   `MySingletonTable`是存储对回调方法的引用的数据结构；
*   `SampleService`不是服务，而是模拟服务的实例；

    ```
    public delegate void ProcessingHandler(string item, double price, double change);

    public class MySingletonTable
    {
        private static volatile MySingletonTable m_Instance;
        private static object syncRoot = new object();

        private static Dictionary<string, ProcessingHandler> pointersToHandlers;

        private MySingletonTable()
        {
            pointersToHandlers = new Dictionary<string, ProcessingHandler>();
        }

        // Return the singleton instance of this class.
        public static MySingletonTable Instance
        {
            get
            {
                if (m_Instance == null)
                {
                    lock (syncRoot)
                    {
                        if (m_Instance == null)
                            m_Instance = new MySingletonTable();
                    }
                }
                return m_Instance;
            }
        }

        /// The number of the entries in the table.
        public int Count
        {
            get
            {
                lock (syncRoot)
                {
                    return pointersToHandlers.Count;
                }
            }
        }

        // Add an handler.
        public void Add(string id, ProcessingHandler handler)
        {
            lock (syncRoot)
            {
                if (!pointersToHandlers.ContainsKey(id))
                    pointersToHandlers.Add(id, handler);
            }
        }

        // Get an handler from the table.
        public ProcessingHandler GetHandler(string id)
        {
            ProcessingHandler handler = null;
            lock (syncRoot)
            {
                if (pointersToHandlers.ContainsKey(id))
                    handler = pointersToHandlers[id];
            }
            return handler;
        }

        // Remove the specified handler.
        public bool Remove(string id)
        {
            lock (syncRoot)
            {
                return pointersToHandlers.Remove(id);
            }
        }
    }

    // This class simulates the service.
    public class SampleService
    {
        private static int counter = 0;
        private int service_i = ++counter;

        MySingletonTable reference = MySingletonTable.Instance;

        public SampleService(string id)
        {
            reference.Add(id, PriceChange);
        }

        private void PriceChange(string item, double price, double change)
        {
            // call the callback
            // ...
            Console.WriteLine("service_i {0}: {1} {2} {3}", service_i, item, price, change);
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            SampleService s1 = new SampleService("abc");
            SampleService s2 = new SampleService("def");

            MySingletonTable table = MySingletonTable.Instance;
            ProcessingHandler handler = null;

            handler = table.GetHandler("abc");
            handler("item one", 10, 20);

            handler = table.GetHandler("def");
            handler("item two", 30, 40);

            Console.ReadLine();
        }
    } 
    ```

显然我不能明确地销毁这个例子中模拟的两个服务实例。但是，如果一个服务的两个实例与两个不同的客户端相关，会发生什么`s1`情况`s2`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:08:23.210

如果您的委托存储在 pointersToHandlers 中，那么它将保留您的对象，因此它永远不会被垃圾收集，或者您称之为“销毁”。实际上，您现在也有内存泄漏。

当客户端断开连接时（或者当您期望对象被销毁时），您将需要从列表中删除委托。不知道你为什么不使用事件，但这是另一个问题。即使您确实使用了事件，一旦完成，您仍然需要断开连接，以免最终出现这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T22:08:17.493

好的，您正在将局部变量 S1 和 S2 设置为空。但是，字典仍然具有该对象的地址。当您执行 s1 = null 时，new 运算符创建的 SampleService 不会被删除，这就是为什么调用 handler after 仍然有效的原因。这与做同样的事情：

```
var s1 = new SampleService("aa");
var handler = s1;
s1 = null; 
```

处理程序仍在引用创建的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-11T01:10:06.957

怎么样...

```
if (kDelegate.Target != null) kDelegate(); 
```

# javascript - 动态设置名称属性

> ID：11197084
> 
> 赞同：-1
> 
> 时间：2012-06-25T20:44:53.043
> 
> 标签：javascript

> **可能重复：**
> [getElementByClass().setAttribute 不起作用](https://stackoverflow.com/questions/2565909/getelementbyclass-setattribute-doesnt-work)

为什么这个：

```
document.getElementsByClassName('cke_source').setAttribute('name', "mymessage") 
```

正在返回：

```
TypeError: Object #<NodeList> has no method 'setAttribute' 
```

`document.getElementsByClassName('cke_source')`正在正确返回对象。

*   请不要使用 jQuery。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T20:47:42.363

`document.getElementsByClassName`将返回元素的节点列表（如数组）。所以，你需要把它当作一个数组来对待。如果你只有一个元素，试试这个：

```
document.getElementsByClassName('cke_source')[0].setAttribute('name', "mymessage") 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-25T20:48:49.917

getElementsByClassName 将返回一个项目集合，而不是单个项目。

```
var pColl = document.getElementsByClassName('cke_source');
for (var ii=0; ii< pColl.length; ii++)
{
    pColl[ii].setAttribute('name', 'foo');
} 
```

# ruby-on-rails-3 - 如何使用 RSpec 初始化模型表，以便外部进程可以看到表的内容？

> ID：11197086
> 
> 赞同：0
> 
> 时间：2012-06-25T20:45:13.677
> 
> 标签：ruby-on-rails-3, postgresql, locking, rspec-rails, external-process

我正在编写一个 Rails 系统，它通过生成多个进程来获取数据并更新单个数据库表来从外部源获取数据。我想编写 RSpec 测试来生成多个进程，这些进程模拟 fetch/write 进程以查找并发问题。

### 简短的问题

如何在 RSpec 测试中初始化表，以便外部进程可以看到表的内容？（至少，我认为这是正确的问题。请继续阅读以了解详细信息......）

### 较长的形式

我的 RSpec 测试的一般结构是：

```
it 'external task should update the correct records' do
  initialize_my_model_table_with_some_records
  spawn_external_tasks_to_update_records
  # wait for spawned processes to complete
  Process.waitall.each {|pid, status| status.exitstatus.should == 0 }
  validate_results
end 
```

但是外部进程总是将模型表视为空的（通过调试打印验证）。随后，尝试更新表失败。

我很确定这是因为 RSpec 将表置于锁定状态，因此它可以在测试完成后进行回滚。

所以（重复这个简短的问题）：如何在 RSpec 测试中初始化表，以便外部进程可以看到表的初始化内容？

### 编辑#2

我注意到在进入后续测试时，该表处于先前（外部）进程离开它的状态。这是有道理的：RSpec 只能将表回滚到它“知道”的状态，因此外部进程所做的更改将持续存在。

这提出了一个解决方案：似乎可以使用 before(:all) 显式初始化表。但这是最干净的方法吗？

### 环境

*   Ruby 版本 1.9.3 (x86_64-darwin10.8.0)
*   皮克（0.13.2）
*   导轨 (3.2.1)
*   rspec (2.9.0)
*   rspec-rails (2.9.0)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T18:04:19.383

当 RSpec 运行测试时，它会将数据库锁定在事务下，以便在测试后可以回滚。因此，任何外部进程都不会看到 RSpec 对数据库所做的更改。相应地，外部进程对数据库所做的任何更改都不会在 RSpec 测试后回滚。

一个例外是内部`before(:all)`和`after(:all)`块：RSpec 所做的任何更改都将对外部进程可见。

所以OP中的例子可以这样工作：

```
describe 'with external tasks' do
  before(:all)
    initialize_my_model_table_with_some_records
  end
  after(:all)
    reinitialize_my_model_table
  end

  it 'should update the correct records' do
    spawn_external_tasks_to_update_records
    # wait for spawned processes to complete
    Process.waitall.each {|pid, status| status.exitstatus.should == 0 }
    validate_results
  end
end 
```

# oracle - 如何在发生错误时退出 SQLPlus 中的脚本并返回 SQLPlus 提示符，而不断开或退出 SQLPlus？

> ID：11197088
> 
> 赞同：9
> 
> 时间：2012-06-25T20:45:16.753
> 
> 标签：oracle, sqlplus

我有一些经常运行的脚本，总是从连接的 SQLPlus 会话中运行。

我需要一种在发生错误时退出脚本的方法，*而无需*断开或退出 SQLPlus 本身。100% 的时间，当发生错误时，连接的 DBA 需要向会话发出一个或多个命令。100% 的时间，当发生错误时，脚本中稍后会有其他 SQLPlus 语句（因此*必须*在a*之外）**不能*执行，否则可能会出现严重问题。`BEGIN..END;`

 *注意：如果您建议`WHENEVER SQLERROR EXIT`，那么您没有阅读上述文字。*除了*脚本之外，这将断开并退出 SQLPlus ，这是不可接受的行为。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-27T23:30:02.930

我在[这里](http://ruepprich.wordpress.com/2010/04/28/conditional-branching-in-sqlplus-scripts/)发现了一个有趣的想法，当与[spencer7593](https://stackoverflow.com/users/107744/spencer7593)的答案结合使用时，我可以选择性地调用子脚本，我可以将 PL/SQL 输出值传递给它。以机智：

```
VAR continue number;
EXEC :continue := 1;
BEGIN
   SELECT some_bool_test() INTO :continue FROM dual;
END;

SET termout OFF
COLUMN script_name NEW_VALUE v_script_name
SELECT decode(:continue, 1, 'run_stuff.sql', 'skip.sql') script_name FROM dual;
SET termout ON

@&v_script_name :some_other_values 
```

`skip.sql`空文本文件 在哪里。

**更新：** 我已将其中的大部分内容移到一个`RUN.SQL`文件中，在其中我将布尔值（0 或 1）作为 传递`&1`，成功调用的脚本名称为`&2`，然后将任何其他预期参数传递给被调用的脚本。因此，它最终看起来像这样：

```
VAR continue number;
EXEC :continue := 1;
BEGIN
   SELECT some_bool_test() INTO :continue FROM dual;
END;

@run.sql :continue 'run_stuff.sql' :some_other_values 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-25T22:10:06.443

这是不可能的。

SQLPlus 不提供对脚本执行的那种级别的控制。

显然，您需要避免使用该`WHENEVER SQLERROR EXIT ...`命令。

由于使用 PL/SQL 引发的异常（错误），可以有条件地控制哪些 SQL 语句执行或不执行。但这并没有解决 SQLPlus 命令（不能从 PL/SQL 块中执行。）

```
DECLARE
  lb_continue BOOLEAN;
BEGIN
  lb_continue := TRUE;
  BEGIN 

    sql statement

  EXCEPTION
    WHEN OTHERS THEN
      lb_continue = FALSE;
  END;
  IF lb_continue THEN
  BEGIN

    sql statements

  EXCEPTION
    WHEN OTHERS THEN
      lb_continue := FALSE;
  END; 
END; 
```

当然，这种方法有其自身的局限性和问题。任何 DDL 语句都需要动态调用；最简单的方法是`EXECUTE IMMEDIATE statement`.

最大的问题（在您的情况下）是不可能从 PL/SQL 块内执行 SQLPlus 命令。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T08:21:23.250

您不能退出脚本并停留在 SQL*Plus 中，但可以停止执行。它并不漂亮，但是假设您可以修改脚本以添加控制流，那么您可以使用绑定变量来执行此操作。

```
set serveroutput on

var flag char;
exec :flag := 'Y';

begin
    if :flag != 'Y' then
        raise program_error;
    end if;
    dbms_output.put_line('Doing some work');
    /* Check for some error condition */
    if 0 != 1 then
        raise program_error;
    end if;
    /* Only reach this if earlier statements didn't fail
     * but could wrap in another flag check if needed */
    dbms_output.put_line('Doing some more work');
    exception
        when program_error then
            dbms_output.put_line(sqlerrm);
            :flag := 'N';
        when others then
            /* Real exception handling, obviously */
            dbms_output.put_line(sqlerrm);    
            :flag := 'N';
end;
/

-- DML only does anything if flag stayed Y
select sysdate from dual
where :flag = 'Y';

-- Optional status message at the end of the script, for DBA info
set feedback off
set head off
select 'Something went wrong' from dual where :flag != 'Y';
set feedback on
set head on 
```

执行时：

```
SQL> @script

PL/SQL procedure successfully completed.

Doing some work
ORA-06501: PL/SQL: program error

PL/SQL procedure successfully completed.

no rows selected

Something went wrong
SQL> 
```

脚本中的任何 PL/SQL 块都可以在开始时检查标志状态，并引发`program_error`（就像一个方便的预定义异常）以跳回。PL/SQL 块中的任何错误都可以直接或在异常处理程序中更新绑定变量标志。并且任何非 PL/SQL DML 都可以有一个附加`where`子句来检查标志状态，因此如果在`N`到达该语句时已将其设置为，则不会进行任何工作。（`insert`我猜这意味着不使用`values`表格）。

这不能做的是处理*来自*普通 SQL 语句的任何错误，但我不确定这是否是一个问题。如果是，那么可能需要将这些更改为 PL/SQL 块内的动态 SQL。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-08-25T10:19:08.210

我知道它很旧，但是 SQL 脚本开头的这两条指令可以完成工作：

当 SQLERROR 退出失败回滚

当 OSERROR 退出失败回滚*

# mysql - 如何摆脱 MySQL 中的重复行

> ID：11197089
> 
> 赞同：1
> 
> 时间：2012-06-25T20:45:23.617
> 
> 标签：mysql

> **可能重复：**
> [MySQL Duplicate rows](https://stackoverflow.com/questions/667035/mysql-duplicate-rows)
> [如何从 mysql 中的表中删除重复的行](https://stackoverflow.com/questions/3271396/how-to-delete-duplicate-rows-from-a-table-in-mysql)

我的数据看起来类似于：

```
22205 | 2179 |  85 
 8306 | 2179 | 178
11164 | 2179 | 178
23873 | 2179 | 178
 8308 | 2179 | 314
22203 | 2179 | 314
22201 | 2178 |  85 
```

我试图找出一个查询，让我删除第三列的重复项。正如我们应该只有一个 178 和一个 314。但请记住，只要第二列不重复，它就可以重复，因此最终结果应该如下所示：

```
22205 | 2179 |  85 
 8306 | 2179 | 178
22203 | 2179 | 314
22201 | 2178 |  85 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T20:53:00.777

只需使用`GROUP BY`（[示例](http://sqlfiddle.com/#!2/33850/3)）：

```
SELECT *
FROM `Table1`
GROUP BY `b`, `c` 
```

假设：

```
CREATE TABLE Table1
    (`a` int, `b` int, `c` int);

INSERT INTO Table1
    (`a`, `b`, `c`)
VALUES
    (22205, 2179, 85),
    (8306, 2179, 178),
    (11164, 2179, 178),
    (23873, 2179, 178),
    (8308, 2179, 314),
    (22203, 2179, 314),
    (22201, 2178, 85); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T20:51:46.433

也许您需要在两列上创建一个复合键。创建一个新的临时表让我们说'tbl_temp'然后使用复制所有行`INSERT iGNORE ...`

# string - 如何在 Arduino 上使用分隔符读取字符串值？

> ID：11197097
> 
> 赞同：14
> 
> 时间：2012-06-25T20:45:53.960
> 
> 标签：string, serial-port, arduino

我必须通过计算机管理伺服系统。

所以我必须将管理消息从计算机发送到 Arduino。我需要管理伺服和角的数量。我正在考虑发送类似这样的内容：“1;130”（第一个伺服和角 130，分隔符“;”）。

有没有更好的方法来实现这一点？

这是我的这段代码：

```
String foo = "";
void setup(){
   Serial.begin(9600);
}

void loop(){
   readSignalFromComp();
}

void readSignalFromComp() {
  if (Serial.available() > 0)
      foo = '';
  while (Serial.available() > 0){
     foo += Serial.read(); 
  }
  if (!foo.equals(""))
    Serial.print(foo);
} 
```

这行不通。有什么问题？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-01-07T00:56:56.467

*   您可以使用 Serial.readString() 和 Serial.readStringUntil() 在 arduino 上解析来自 Serial 的字符串
*   您还可以使用 Serial.parseInt() 从串行读取整数值

代码示例

```
int x;
String str;

void loop() 
{
    if(Serial.available() > 0)
    {
        str = Serial.readStringUntil('\n');
        x = Serial.parseInt();
    }
} 
```

通过串行发送的值是 "my string\n5"，结果是 str = "my string" 和 x = 5

***注意：Serial.available() 继承自 Stream 实用程序类。*** [https://www.arduino.cc/reference/en/language/functions/communication/serial/available/](https://www.arduino.cc/reference/en/language/functions/communication/serial/available/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-25T05:35:44.760

这是我发现的一个很棒的潜艇。这非常有帮助，我希望它也对你有用。

这是调用子的方法。

```
String xval = getValue(myString, ':', 0); 
```

这是子！

```
String getValue(String data, char separator, int index)
{
  int found = 0;
  int strIndex[] = {
    0, -1  };
  int maxIndex = data.length()-1;
  for(int i=0; i<=maxIndex && found<=index; i++){
    if(data.charAt(i)==separator || i==maxIndex){
      found++;
      strIndex[0] = strIndex[1]+1;
      strIndex[1] = (i == maxIndex) ? i+1 : i;
    }
  }
  return found>index ? data.substring(strIndex[0], strIndex[1]) : "";
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-12-29T19:14:31.627

大多数其他答案要么非常冗长，要么非常笼统，所以我想我会举例说明如何使用 Arduino 库通过您的特定示例来完成它：

您可以使用方法[Serial.readStringUntil](https://www.arduino.cc/en/Reference/StreamReadStringUntil)从`Serial`端口读取直到您的分隔符。

然后使用[toInt](https://www.arduino.cc/en/Reference/StringToInt)将字符串转换为整数。

举一个完整的例子：

```
void loop() 
{
    if (Serial.available() > 0)
    {
        // First read the string until the ';' in your example
        // "1;130" this would read the "1" as a String
        String servo_str = Serial.readStringUntil(';');

        // But since we want it as an integer we parse it.
        int servo = servo_str.toInt();

        // We now have "130\n" left in the Serial buffer, so we read that.
        // The end of line character '\n' or '\r\n' is sent over the serial
        // terminal to signify the end of line, so we can read the
        // remaining buffer until we find that.
        String corner_str = Serial.readStringUntil('\n');

        // And again parse that as an int.
        int corner = corner_str.toInt();

        // Do something awesome!
    }
} 
```

当然我们可以稍微简化一下：

```
void loop() 
{
    if (Serial.available() > 0)
    {
        int servo = Serial.readStringUntil(';').toInt();
        int corner = Serial.readStringUntil('\n').toInt();

        // Do something awesome!
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-25T20:59:10.687

您需要构建一个读取缓冲区，并计算您的 2 个字段（伺服 # 和角）的开始和结束位置。然后您可以读入它们，并将字符转换为整数以在其余代码中使用。像这样的东西应该可以工作（未在 Arduino 上测试，但在标准 C 上测试）：

```
void loop()
        {
            int pos = 0; // position in read buffer
            int servoNumber = 0; // your first field of message
            int corner = 0; // second field of message
            int cornerStartPos = 0; // starting offset of corner in string
            char buffer[32];

            // send data only when you receive data:
            while (Serial.available() > 0)
            {
                // read the incoming byte:
                char inByte = Serial.read();

                // add to our read buffer
                buffer[pos++] = inByte;

                // check for delimiter
                if (itoa(inByte) == ';')
                {
                    cornerStartPos = pos;
                    buffer[pos-1] = 0;
                    servoNumber = atoi(buffer);

                    printf("Servo num: %d", servoNumber);
                }
            }
            else 
            {
                buffer[pos++] = 0; // delimit
                corner = atoi((char*)(buffer+cornerStartPos));

                printf("Corner: %d", corner);
            }
        } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-11-22T23:00:50.653

看起来你只需要更正

```
 foo = '';  >>to>>  foo = "";

  foo += Serial.read();  >>to>>  foo += char(Serial.read()); 
```

我也做了类似的东西..：

```
void loop(){
  while (myExp == "") {
    myExp = myReadSerialStr();
    delay(100);
  }
}    

String myReadSerialStr() {
  String str = "";
  while (Serial.available () > 0) {
    str += char(Serial.read ());
  }
  return str;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-25T13:50:37.523

它是通用解析器

```
struct servo
{
    int iServoID;
    int iAngle;
};

std::vector<std::string> split(const std::string& str, const std::string& delim)
{
    std::vector<std::string> tokens;
    size_t prev = 0, pos = 0;
    do
    {
        pos = str.find(delim, prev);
        if (pos == std::string::npos) pos = str.length();
        std::string token = str.substr(prev, pos-prev);
        if (!token.empty()) tokens.push_back(token);
        prev = pos + delim.length();
    }
    while (pos < str.length() && prev < str.length());
    return tokens;
}

std::vector<servo> getServoValues(const std::string& message)
{
    std::vector<servo> servoList;
    servo servoValue;
    std::vector<std::string> servoString;
    std::vector<std::string> values = split(message, ",");
    for (const auto& v : values)
    {
        servoString.clear();
        servoString = split(v, ";");
        servoValue.iServoID = atoi(servoString[0].c_str()); //servoString[0].toInt();
        servoValue.iAngle = atoi(servoString[1].c_str());// servoString[1].toInt();
        servoList.emplace_back(servoValue);
    }
    return servoList;
} 
```

打电话：

```
std::string str = "1;233,2;123";
std::vector<servo> servos = getServoValues(str);
for (const auto & a : servos)
    std::cout<<a.iServoID << " " << a.iAngle << std::endl; 
```

结果

```
1 233
2 123 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-02T17:32:46.233

此代码读取字符串，直到看到`'>'`字符

```
void loop() {
  // put your main code here, to run repeatedly:
  String msg = getMessage();
}

String getMessage() {
  String msg = "";

  while (Serial.available()>0) {
    msg =  Serial.readStringUntil('>');
  }
  return msg;
} 
```

# model - OpenERP 模型跟踪外部资源，连接到父级的 copy() 或 copy_data()

> ID：11197099
> 
> 赞同：0
> 
> 时间：2012-06-25T20:46:04.303
> 
> 标签：model, copy, openerp

我添加了一个新模型（称为 crm_lead_external），它通过 crm_lead 上的新 one2many 链接。

因此，我的模块定义了两个模型：一个更新的 crm_lead（使用 _name=crm_lead）和一个新的 crm_lead_external。

此外部模型跟踪文件，因此具有“文件名”字段。

我还在这个文件名字段上创建了一个唯一的 SQL 索引。

这是我的模块的一部分：

```
def copy(self, cr, uid, id, default=None, context=None):
    if not default:
        default = {}
    default.update({
        'state': 'new',
        'filename': '',
    })
    ret = super(crm_lead_external, self).copy(cr, uid, id, default, context=context)
    #do file copy
    return ret 
```

此处的目的是允许复制外部实体，但重新定位文件路径。

现在，如果我单击 Lead 上的重复项，我会在我的唯一约束上得到一个 IntegrityError。没有调用 copy() 是否有特殊原因？

我应该将此逻辑添加到 copy_data() 吗？Myst 我真的为领先者覆盖了 copy() 吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T05:23:04.587

有两个[`osv`类方法](http://doc.openerp.com/v6.1/developer/03_modules_2.html#orm-methods):`copy`和`copy_data`，所有子类都可以访问它们`osv`，例如您的`crm_lead_external`类。

当您单击复制时，它会调用`osv.copy()`. 如果您的模型包含任何关系字段并且这些字段具有链接的任何记录，那么`osv`将调用`copy_data()`链接的记录。在您的情况下，当您调用`copy`model时`crm.lead`，它会调用`copy_data()`on `crm_lead_external`。您对 UNIQUE 有一个约束`crm_lead_external`，这会导致您的错误消息。

这个问题可以有两个修复。

1.  如果您不想复制`crm_lead_external`记录，则覆盖模型的`copy`方法`crm.lead`并禁用复制`crm_lead_external`oem 字段值。

    ```
    def copy(self, cr, uid, id, default=None, context=None):
        if default is None:
            default = {}
        default['o2m_field'] = []
        return super(<calss_name>, self).copy(cr, uid, id, default, context) 
    ```

    这将停止复制 o2m 字段记录。

2.  我们将覆盖`copy`您模型的方法，`crm_lead_extenal`因此每次`copy_data`调用时，我们都会解决 UNIQUE 约束并传递新值，这样您就不会遇到任何问题。

    ```
    def copy_data(self, cr, uid, id, default=None, context=None):
        if default is None:
            default = {}
        default['name'] = self.browse(cr, uid, id, context=context).name or ''
        if not context.get('copy',False):
            new_name = _("%s (copy)")%default.get('name','')
            default.update({'name':new_name})
        return super(<calss_bame>, self).copy_data(cr, uid, id, default, context) 
    ```

    在此示例中，我在名称末尾附加了复制文本，因此我将始终获得一个新名称，同样您可以避免这样的 UNIQUE 约束，并且您将完美复制所有数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T09:13:39.487

只需更改复制方法中唯一字段的值。就像在原始值之后添加“COPY”一样。

您可以在 addons/product/product.py 第 660 行中有示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-09T13:39:38.293

试试这个代码：

```
def copy(self,cr,uid,id,default = None,context = None):
        print"---------Calling copy function----"
        print default

                return super(demo_courses, self).copy(cr, uid, id, default, context) 
```

# c# - c# 用反斜杠替换字符串？

> ID：11197104
> 
> 赞同：0
> 
> 时间：2012-06-25T20:46:41.930
> 
> 标签：c#

我有以下字符串：

```
 "\\\\AAA.AA.A.AA\\d$\\ivr\\vm\\2012May\\29\\10231_1723221348.vox" 
```

我希望它看起来像：

```
"\\AAA.AA.A.AA\d$\ivr\vm\2012May\29\10231_1723221348.vox" 
```

我努力了

```
fileToConvert.Replace(@"\\",@"\") 
```

这会产生：

```
"\\AAA.AA.A.AA\\d$\\ivr\\vm\\2012May\\29\\10231_1723221348.vox" 
```

为什么？！？

谢谢大家！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T20:51:00.527

我猜你正在调试器中检查结果字符串。这个字符串将被转义，即TAB 是\t，return 是\n。可以通过单击值旁边的放大镜图标来检查“真实”值。

此外，打印到终端（例如`System.Console.WriteLine()`）将显示“正确”的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T20:53:20.160

我猜你查看调试器，这就是你得到这种行为的原因......

每个`\\`实际上都是一个`\`。这就是为什么你被`\\\\`替换为`\\`（两个“\”被一个替换）并且因为`\\`实际上只有一个“\”你仍然在替换后得到“\”（因为它没有找到两个“\”字符串

原因是 \ 字符标记了一个特殊字符，例如，如果您想要制表符 (\t) 字符，您将拥有`"\t"`换行符的字符串`"\r\n"`。因此，当您实际上想要在字符串中包含一个 '\' 字符时，您可以在之前再用一个 '\' 字符标记它 - 比如`"\\"`

这意味着当您在调试器中看到“\\AAA.AA.A.AA\d$\ivr\vm\2012May\29\10231_1723221348.vox”时，实际字符串是“\AAA.AA.A.AA\ d$\ivr\vm\2012May\29\10231_1723221348.vox"

所以`fileToConvert.Replace(@"\\",@"\")`会让它看起来像这样：

`"\AAA.AA.A.AA\d$\ivr\vm\2012May\29\10231_1723221348.vox"`

您将在调试器中看到`"\\AAA.AA.A.AA\\d$\\ivr\\vm\\2012May\\29\\10231_1723221348.vox"`

* * *

**得出一个结论：**

你不需要做任何事情——甚至`fileToConvert.Replace(@"\\",@"\")`因为你的原始字符串（你在 debug as 中看到的`"\\\\AAA.AA.A.AA\\d$\\ivr\\vm\\2012May\\29\\10231_1723221348.vox"`）实际上是`"\\AAA.AA.A.AA\d$\ivr\vm\2012May\29\10231_1723221348.vox"`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T20:53:19.357

```
 string s = @"\\\\AAA.AA.A.AA\\d$\\ivr\\vm\\2012May\\29\\10231_1723221348.vox";
    var output = s.Replace(@"\\",@"\"); 
```

我尝试了上面的代码代码，它工作正常。

# emacs - 如何在 Emacs 中使用 reftex 引用外部 LaTeX 章节？

> ID：11197107
> 
> 赞同：1
> 
> 时间：2012-06-25T20:46:49.900
> 
> 标签：emacs, latex, auctex

我正在编辑一个包含多个章节的较大 LaTeX 项目的一部分的章节，并且我正在尝试使用 Cc ）进行交叉引用，但 reftex 仅在当前缓冲区（章节）中找到标签。根据[reftex 手册](http://www.gnu.org/software/auctex/manual/reftex/reftex_23.html#SEC25)，按下`x`将告诉 reftex 查看外部文档，但这仅在您使用 xr 包时才有效，我的文档不需要它。

建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T02:20:56.430

如果您使用 AuCTeX，您可以使用文件局部变量让章节文件了解主文件并获取所有标签以便能够在所有文档中引用。见[http://www.gnu.org/software/auctex/manual/auctex/Multifile.html](http://www.gnu.org/software/auctex/manual/auctex/Multifile.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T00:21:52.987

我最终把它放在我所有由主文件提供的 *.tex 文件的末尾：

```
%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "relative/path/to/master/tex/file"
%%% End: 
```

这告诉 reftex/auctex 在哪里寻找主文件。

你可能还需要把

```
(add-hook 'LaTeX-mode-hook (function turn-on-reftex))
(setq reftex-plug-into-AUCTeX t) 
```

在你的 ~/.emacs 文件中。我不确定这是必要的，但它显然增加了很好的功能。

# php - RDS 上的 MySQL 触发器

> ID：11197108
> 
> 赞同：0
> 
> 时间：2012-06-25T20:46:53.063
> 
> 标签：php, mysql, triggers, amazon-rds, amazon-sqs

我正在尝试创建一个将调用 php 脚本的 MySQL 触发器。我有一个在 RDS 中运行的 MySQL 服务器实例，并且想使用 php 脚本向我的 SQS 消息传递系统发送消息。

1.  我在哪里保存 php 脚本？
2.  我是否需要在我的 EC2 实例上安装适用于 SQS 的 PHP 开发工具包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-25T20:15:47.377

是的，您可以正常使用触发器。使用以下步骤：

1.  在“参数组”菜单中更改变量：

    ```
    log_bin_trust_function_creators to "ON" or "1". 
    ```

2.  在实例中执行“修改”和“重启”。强制的！

3.  使用 mysql 客户端验证变量是否真的被修改。命令是：`SHOW VARIABLES LIKE 'log_bin_trust%'`

现在，您可以正常创建触发器了。最大的困难是正确检查问题：您的实例应该使用该参数组，并且应该正确设置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T22:51:28.500

忘记触发器，尤其是在 Amazon RDS 上。

使用 cron 每 5 分钟（例如）执行一次 PHP 脚本，查找未发送的消息并使用 SQS 消息传递系统发送它们。

# visual-studio-2010 - 在 Visual Studio 2010 中禁用菜单栏快捷方式

> ID：11197112
> 
> 赞同：2
> 
> 时间：2012-06-25T20:47:09.610
> 
> 标签：visual-studio-2010, ide, keyboard-shortcuts, hotkeys

我正在使用 Visual Studio 2010 的 Emacs 插件，我想释放我的元密钥。

当我按下 时`Alt-foo`，我会激活菜单栏上的下拉菜单，而不是可爱的 Emacs 命令。例如，当我尝试向前移动一个单词时，我打开了分析菜单，因为这两个命令都使用`Alt-N`.

如何禁用菜单栏`Alt-`快捷方式并充分了解我的 Emacs 环境？

# c# - Asp 按钮在 jquery 对话框中不起作用

> ID：11197117
> 
> 赞同：-1
> 
> 时间：2012-06-25T20:47:24.503
> 
> 标签：c#, jquery, asp.net, button, dialog

Asp 按钮在 jquery 对话框中不起作用：

```
<script type="txt/js">$(function () {$('#<%= ButtonEmail.UniqueID %>').button();});</script>

<div id="dialog-modal" title="Cadastro">
<p>Digite seu email para que eviemos o link do cadastro para ele:</p>
<p><asp:TextBox ID="TextBoxEmail" CssClass="ui-corner-all" runat="server"></asp:TextBox>&nbsp;&nbsp;
<asp:Button ID="ButtonEmail" runat="server" Text="Enviar Link" onclick="ButtonEmail_Click" /></p>
<div><asp:Label ID="LabelEmail" runat="server" Text="teste"></asp:Label></div>
</div> 
```

c#代码：

```
protected void ButtonEmail_Click(object sender, EventArgs e)
{
...
} 
```

即使删除这个： $(function () {$('#<%= ButtonEmail.UniqueID %>').button();}); 不工作，按钮保持原来的设计，但不工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T20:51:42.500

可能是这样的

var buttonId = <%= ButtonEmail.UniqueID %>; $(function () {$('#' + buttonId).button();});

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T04:46:17.200

用这个

```
<script type="text/javascript">
     $(function () {
          $('#<%= ButtonEmail.ClientID %>').button();
     });
</script> 
```

请注意替换 UniqueId 的 ClientID。还要确保加载了依赖脚本（应该没有 javascript 错误）。

在阅读了对另一个答案的一些评论后，我开始怀疑是否可能是您的服务器端点击事件不起作用？在这种情况下，您可能必须提供更多信息和代码。

要使 asp.net 服务器端单击在对话框中工作，请确保对话框是表单的一部分（在 jquery 将其制成对话框之后。详细信息在这里。 [带有 ASP.NET 按钮回发的 jQuery UI 对话框](https://stackoverflow.com/questions/757232/jquery-ui-dialog-with-asp-net-button-postback)

# android - 在列表视图中仅显示文件名

> ID：11197125
> 
> 赞同：-1
> 
> 时间：2012-06-25T20:47:52.100
> 
> 标签：android, listview

在我的应用程序中创建一些文件并将它们存储在`cache dir`. 现在只从应用程序我想访问这些文件，所以我`ListView`通过提供路径来获取它们`getExternalCacheDir().getAbsolutePath()`。在这里，我得到了`ListView`文件的整个路径。相反，我只希望文件名显示在列表中。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T20:52:38.547

只需在目录中调用`list()`以返回该目录中的文件名数组：

```
File directory = getExternalCacheDir();
String[] filenames = directory.list(); 
```

或者，如果这对您更有用，您可以打电话`listFiles()`来取回。`File[]`

高温高压

# mysql - 将 zerofill 添加到现有表

> ID：11197129
> 
> 赞同：2
> 
> 时间：2012-06-25T20:48:10.160
> 
> 标签：mysql, zerofill

我正在尝试将 ZEROFILL 添加到 MySQL 数据库中的自动递增主 ID 字段。这是代码（由 MySQL Workbench 自动生成）：

```
ALTER TABLE `database`.`table` CHANGE COLUMN `id` `id` INT(11) ZEROFILL NOT NULL AUTO_INCREMENT 
```

这是我得到的错误：

```
Error Code: 1025\. Error on rename of './database/#sql-2c8_cb' to './database/table' (errno: 150) 
```

似乎已经创建了一个临时表，并且当临时表使用原始表名重命名时发生错误。

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T23:01:43.607

如果使用 InnoDB，请在执行 alter 后立即检查状态监视器 (SHOW ENGINE INNODB STATUS)。它应该告诉您是否是因为 FK 约束。您可能需要删除约束、更改列并再次创建它们。

# php - 在特定查询中计算的值可以在另一个查询中使用吗？

> ID：11197134
> 
> 赞同：-1
> 
> 时间：2012-06-25T20:48:18.913
> 
> 标签：php, mysql, html, sql

我正在以这种方式计算一个参数（X）：

```
<?php
$link=mysql_connect("localhost","root","");
mysql_select_db("hand");

$result = mysql_query("select * from sessions",$link);
$num_calls = mysql_num_rows($result);

echo '<br/>'."\n Total X :\n $num_calls ".'<br/>';
?> 
```

我正在以这种方式计算另一个参数（Y）：

```
<?php
mysql_connect("localhost","root","");
mysql_select_db("hand");

$result = mysql_query("SELECT * FROM cars WHERE start_at > TIMESTAMPADD(WEEK, -4, CURDATE())  AND TIMESTAMPDIFF(MINUTE, start_at, end_at) > 5");

$num_rows = mysql_num_rows($result);

echo '<br/>'."\n Total Y :\n $num_rows ".'<br/>';
?> 
```

在另一个地方，我需要计算口粮 X/Y。我该怎么做，因为它需要在同一个 html 页面的另一个字段中完成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T20:51:01.587

你做：

```
$num_calls = intval($num_calls); // Make sure these are integers
$num_rows = intval($num_rows);

$calculation = $num_calls / $num_rows;
echo $calculation; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T20:54:49.783

好的，我*想*我明白了。

您想要 X:Y，其中 X 是与 Y 的比率：

```
$link=mysql_connect("localhost","root","");
mysql_select_db("hand");

$result = mysql_query("select * from sessions",$link);
$num_calls_x = mysql_num_rows($result);

$result = mysql_query("SELECT * FROM cars WHERE start_at > TIMESTAMPADD(WEEK, -4, CURDATE())  AND TIMESTAMPDIFF(MINUTE, start_at, end_at) > 5");
$num_calls_y = mysql_num_rows($result);

echo '<br/>'."\n Total X :\n $num_calls_x ".'<br/>';
echo '<br/>'."\n Total Y :\n $num_calls_y ".'<br/>';
echo 'Ratio: '.round(($num_calls_x/ $num_calls_y) * 100, 0); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T20:57:10.337

嗯首先，这是一种非常昂贵的计数方式。

```
Select Count(*) from Sessions 
```

和

```
Select Count(*) from Cars... 
```

所以像

```
Select Cast(Select Count(*) From Sessions) as FLOAT) / (Select Count(*) From Cars...) 
```

应该让你接近。

然后你不需要费心坚持它，但如果你坚持，所有通常的机制都适用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-25T21:01:43.613

您可以将查询字符串放入这样的数组中：
`$queryArray = array("select * from sessions", "SELECT * FROM cars WHERE start_at > TIMESTAMPADD(WEEK, -4, CURDATE()) AND TIMESTAMPDIFF(MINUTE, start_at, end_at) > 5");`
只使用一次 foreach：
`foreach($query in $queryArray) { $result = mysql_query($query); $count = mysql_count($result); $countList[] = $count }`
`$number = 0;`
现在您需要使用另一个 foreach 从 count 的项目中得出比率
`foreach($number in $countList) {<br/> $number = $number + $number; }<br/> $ratio = $number / count($countList);`

像这样，您可以将所有未来的查询添加为字符串，一切仍然有效。

PS 我目前无法测试代码，但它应该非常实用。不太确定foreach as。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-25T20:52:01.767

您可以将此值放入 session/cookie 并在另一个地方读取它。

# java - 获取一个类的泛型类型以创建另一个泛型类

> ID：11197135
> 
> 赞同：0
> 
> 时间：2012-06-25T20:48:19.187
> 
> 标签：java, generics

我似乎让自己陷入了一个快乐的转折中。我的情况如下：

```
public class Parameter<T> {
   public Parameter(String value, Verifier<T> verif){
       //stuff, lots of stuff!
   }
}

public interface Verifier<T>{
   //definition
}

public enum StringVerif implements Verifiier<String>{
    INSTANCE;
    //some static functions on my singleton
}

public abstract class ParamFactory{
    private static ArrayDeque<Verifier<?>> verifList...
    ...
    for(Verifier<?> ver : verifList){
        if(ver.isapplicable(someData){
            //now I'm stuck!
        }
    }
} 
```

简而言之，我需要做的是根据通过测试的验证器的类型创建正确的类型化参数。例如，对于验证者，我需要能够创建参数，对于验证者，我需要能够创建参数。然后这些参数将被发送到另一个集合。本质上它是一个带有验证器和处理器模块的可扩展工厂，可以根据需要解析不同的类型参数，非常强大。问题是我不仅要通过反射获得泛型类型，还要从这种类型创建泛型类型。

关于从哪里开始做这件事的任何想法？很久没有深入研究泛型了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T04:27:25.817

原来我一直在错误地接近这个。正确的技术是每个验证器都负责调用构造函数，并且由于每个验证器已经知道它自己的类型，因此只需几行代码。它在某种程度上打破了工厂概念，除非您认为这些验证器真正成为工厂的组成部分

```
public interface Verifier<T>{
   //definition
   public Err buildParaList(String value, Single<Parameter<?>> output);
}

public enum StringVerif implements Verifiier<String>{
    INSTANCE;
    //some static functions on my singleton
    @Override
    public Err buildParaList(String value, Single<Parameter<?>> output){
        output.elem = new Parameter<String>(value, INSTANCE);
        return Err.success();
    }
}
public abstract class ParamFactory{
    private static ArrayDeque<Verifier<?>> verifList...
    ...
    for(Verifier<?> ver : verifList){
        if(ver.isapplicable(someData){
            Single<Parameter<?>> param = new Single<Parameter<?>>();
            Err e = ver.buildParameter(value, param);
            //checks
            paramList.add(param.elem);
        }
    }
} 
```

好的，我的实际用法比示例更复杂，但它仍然有效。我之前真的应该想到这一点，我想我昨晚没那么警觉。感谢您的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T06:15:30.193

扩展我之前关于`HList`s 的评论：（这对于评论来说太大了，因此将其发布为答案。）

我在代码示例中使用了 Scala，因为它对正在讨论的想法有很好的支持。所有代码示例都在控制台输入。

当你有一个 type 的对象`Dog`和另一个 type 的对象时`Tiger`，如果你把它们放在同一个协变列表中，结果列表的类型`List[Animal]`将`Animal`是它们共同的超类型。因为这个列表是同质的，所以原始类型丢失了。请注意以下列表的推断类型：

```
scala> class Animal
defined class Animal

scala> class Dog extends Animal
defined class Dog

scala> class Tiger extends Animal
defined class Tiger

scala> List(new Tiger, new Dog)
res0: List[Animal] = List(Tiger@a32604, Dog@1150b68) 
```

同样`Verifier[Int]`，`Verifier[String]`当放入单个同质列表时，将采用 type `Verifier[Any]`。（在 Scala 中，`Any`类位于对象层次结构的顶部。）请参阅：

```
scala> class Verifier[+T](value: T) {
     |   override def toString = "Verifier(" + value.toString + ")"
     | }
defined class Verifier

scala> List(new Verifier(6), new Verifier("hello"))
res1: List[Verifier[Any]] = List(Verifier(6), Verifier(hello)) 
```

如果要保留静态类型，并将它们用于以后的计算，则应使用异构列表。或`HList`简称。

```
scala> new Verifier(6) :: new Verifier("hello") :: HNil
res2: shapeless.::[Verifier[Int],shapeless.::[Verifier[java.lang.String],shapeless.HNil]] = Verifier(6) :: Verifier(hello) :: HNil 
```

以下是多态映射的工作原理：

```
scala> class Parameter[+T](value: String, verif: Verifier[T]) {
     |   override def toString = "P(" + value + ", " + verif + ")"
     | }
defined class Parameter

scala> object mapper extends (Verifier ~> Parameter) {
     |   def apply[A](v: Verifier[A]): Parameter[A] = new Parameter("k", v)
     | }
defined module mapper

scala> res2 map mapper
res3: mapper.Out = P(k, Verifier(6)) :: P(k, Verifier(hello)) :: HNil 
```

我们保留了类型参数，并使用给定的更高级别的函数作用于列表的每个元素。这让我们返回了 a `HList`of `Parameter`s，其中保留了正确的类型。

请注意，`HList`可以在 Java 中实现的概念，但是您不能在结构上定义许多有用的操作。Java 的类型系统无法做到这一点。如果您有兴趣，[这里有一篇关于该主题的精彩文章。](http://apocalisp.wordpress.com/2008/10/23/heterogeneous-lists-and-the-limits-of-the-java-type-system/)

希望这在某种程度上有所帮助。

# python - Django“set_password（）”函数不起作用

> ID：11197146
> 
> 赞同：4
> 
> 时间：2012-06-25T20:49:16.447
> 
> 标签：python, django, passwords

使用 Django 的“set_password()”函数更改站点上用户的密码后，密码将更改为加密字符串。但是，用户无法使用新密码或旧密码登录站点 - 没有以前输入的密码有效。这是获取密码的代码片段 -

```
if request.POST:
  password = request.POST['password'].encode('ascii','replace')
  confirm_password = request.POST['confirm_password'].encode('ascii','replace')
  if password == confirm_password:
    user.set_password(confirm_password)
    user.save()
    return HttpResponseRedirect('/reset/thanks/')
  else:
    return HttpResponseRedirect('/reset/' + user.get_profile().forgotpasswordcode + "/" + user.email + "/") 
```

即使帐户已将密码更改为与其相同的密码，加密密码也会更改，用户无法登录。

有没有什么办法解决这一问题？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-10-08T05:37:51.390

也许用户没有`is_active`检查标志。这可能会导致尝试登录时出现异常行为，具体取决于实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T00:11:54.670

正确的方法是使用 django 内置密码重置代替：

### 在 urls.py

```
from django.contrib.auth import views as auth_views

urlpatterns = patterns('',
    ### previous urls
    url(r'^password/reset/$',
       auth_views.password_reset,
       {'template_name': 'my_cool_app/registration/password_reset_form.html'},
       name='my_cool_app_password_reset'),
   url(r'^password/reset/confirm/(?P<uidb36>[0-9A-Za-z]+)-(?P<token>.+)/$',
       auth_views.password_reset_confirm,
       {'template_name': 'my_cool_app/registration/password_reset_confirm.html'},
       name='my_cool_app_password_reset_confirm'),
   url(r'^password/reset/complete/$',
       auth_views.password_reset_complete,
       {'template_name': 'my_cool_app/registration/password_reset_complete.html'},
       name='my_cool_app_password_reset_complete'),
   url(r'^password/reset/done/$',
       auth_views.password_reset_done,
       {'template_name': 'my_cool_app/registration/password_reset_done.html'},
       name='my_cool_app_password_reset_done'),
    ### other urls
    ) 
```

您只需创建模板，然后在需要时使用 url 名称来解析它们。

# android - 取消后再次运行异步任务，有没有办法？

> ID：11197155
> 
> 赞同：1
> 
> 时间：2012-06-25T20:49:39.600
> 
> 标签：android, android-asynctask

发生的情况是，我正在从 Web 服务中获取数据。同时运行 6 个异步任务以获取 6 个不同的东西。问题是当第一个异步任务开始执行并且我注销时，当我以不同的用户登录时，第一个异步任务不会再次执行。我是忘记了什么还是只是这样。如何使第一个异步任务再次执行。？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T20:52:07.553

不，你不能重复使用你的`AsyncTask`. 如果您两次调用`execute()`相同`AsyncTask`的代码，则会引发异常。

`AsyncTask`s 通常是特定于 a 的`Activity`，并不适用于长期操作（例如从 Web 服务中持续获取数据）。如果您希望在退出活动后获取数据，则需要使用 a`Service`代替。

# android - 多个 HTTP 连接（分段/群下载）在 Android 中下载相同的文件

> ID：11197158
> 
> 赞同：2
> 
> 时间：2012-06-25T20:50:02.703
> 
> 标签：android, http, download

我目前正在为 Android 创建一个下载管理器。为了优化下载，我需要使用与服务器的多个连接来下载相同的文件。（即，在 Windows 中使用的 Internet 下载管理器中使用的技术相同。）问题是我不知道如何创建多个 HTTP 连接并下载相同的文件。我希望你能帮助我..提前谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:17:13.860

产生一些通过 Header`Content-Range`关键字请求部分文件的线程。请参阅[使用 HTTP 读取文件的第一部分](https://stackoverflow.com/questions/4004675/reading-the-first-part-of-a-file-using-http)

# c# - 使用 .net 从 html 页面解析（提取）内容

> ID：11197160
> 
> 赞同：0
> 
> 时间：2012-06-25T20:50:12.163
> 
> 标签：c#, javascript, .net, html-parsing

我需要从 html 页面解析/提取信息。基本上我正在做的是使用 System.Net.WebClient 将页面加载为字符串，并使用 HTML Agility Pack 来获取 html 标记（表单、标签、输入等）内的内容。

但是，某些内容位于 javascript 脚本标记内，如下所示：

```
<script type="text/javascript">
//<![CDATA[
var itemCol = new Array();

itemCol[0] = {
    pid: "01010101",
    Desc: "Some desc",
    avail: "Available",
    price: "$10.00"
};

itemCol[1] = {
    pid: "01010101",
    Desc: "Some desc",
    avail: "Available",
    price: "$10.00"
};

//]]>
</script> 
```

那么，如何将其解析为 .NET 中的集合？HTML Agility Pack 能帮上忙吗？我真的很感激任何帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T20:53:42.210

HAP 不会为您解析出 javascript - 它会做的最好的事情就是解析出元素的内容。

[javascript.net](https://github.com/JavascriptNet/Javascript.Net)可能符合要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T23:53:59.197

你想要脚本标签内的哪一部分内容？你期待什么样的收藏。您始终可以使用以下选择脚本标签

```
 HtmlDocument document = new HtmlDocument();
  document.Load(downloadedHtml);
  XPathNavigator n = document.CreateNavigator();
  XPathNodeIterator scriptTags = n.Select("//script");

  foreach (XPathNavigator nav in scriptTags)
  {
    string innerXml = nav.InnerXml;

    // Parse inner xml using regex
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T00:21:10.333

使用 javascript.net 库，您可以获得一个集合

```
 using (JavascriptContext context = new JavascriptContext())
  {
    context.SetParameter("data", new MyObject());

     StringBuilder s = new StringBuilder();

    foreach (XPathNavigator nav in scriptTags)
    {
       s.Append(nav.InnerXml);
    }

  s.Append(";data.item = itemCol;");
  context.Run(s.ToString());

  MyObject o = context.GetParameter("data") as MyObject; 
```

然后只有一个像

```
 class MyObject
   {
     public object item { get; set; }
   } 
```

# jquery - IPad 文本输入类型 - 输入中的标签

> ID：11197167
> 
> 赞同：1
> 
> 时间：2012-06-25T20:50:34.067
> 
> 标签：jquery, html, css, jquery-mobile, textinput

如果您查看此[链接](http://www.google.com/imgres?q=ipad%20text%20box&um=1&hl=en&sa=N&biw=995&bih=507&tbm=isch&tbnid=F3QIWenNGlDtsM:&imgrefurl=http://www.uwec.edu/Help/email/Apple-Mobile-Devices.htm&docid=3QJ1DqCNFL0dPM&imgurl=http://www.uwec.edu/Help/General/images/Exchangeinfo_2.PNG&w=503&h=340&ei=68roT-eILOGW2QWZ-9yNCw&zoom=1)，您将看到 ipad 类型的文本框。
注意标签实际上是如何在按钮内部的。
我想知道 JQuery Mobile 中是否有类似的东西，因为我还没有看到如何做到这一点。

![在此处输入图像描述](../Images/56b5fcec7a2241e85c24e3ab0f105d52.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T22:21:10.117

这些是[CSS 占位符](http://davidwalsh.name/html5-placeholder-css)，即`placeholder="Username"`，如[jQuery Mobile 文档](http://jquerymobile.com/demos/1.1.0/docs/forms/docs-forms.html)中所示：

```
<div data-role="fieldcontain" class="ui-hide-label">
    <label for="username">Username:</label>
    <input type="text" name="username" id="username" value="" 
           placeholder="Username"/>
</div> 
```

查看[jsFiddle](http://jsfiddle.net/HeBLk/)演示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T02:54:54.043

使用 jquery 移动列表视图；

检查以下链接

```
http://jquerymobile.com/test/docs/lists/lists-forms-inset.html 
```

# bash - tar 退出时没有消息，不提取存档，退出状态为 0

> ID：11197171
> 
> 赞同：0
> 
> 时间：2012-06-25T20:51:07.750
> 
> 标签：bash, tar

我正在尝试使用以下行来提取目录中的第一个文件：

```
tar xzvf `ls -1 | head -n1 | tail -1` --force-local 
```

出于某种原因， tar 只是退出而不会引发错误，也不会创建存档。如果我手动输入文件名，它工作正常。

我能看到的唯一潜在问题是我的文件名包含冒号。尽管如此，我还是尝试用 mv 做同样的事情并且一切正常：

```
mv `ls -1 | head -n1 | tail -1` newfile 
```

并且文件已正确重命名。

知道可能是什么问题，或者我该如何进一步调试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T14:40:24.123

tar 文件最终不是正确的 tar 文件。我输入的文件名错误。如果您遇到类似问题，请检查以确保文件不是空白或其他内容类型。

# iphone - 从 OS X 访问 iOS 应用程序文档目录

> ID：11197172
> 
> 赞同：1
> 
> 时间：2012-06-25T20:51:08.283
> 
> 标签：iphone, ios, macos, ipad

我正在开发一个 iOS 应用程序，该应用程序创建一些文件并将其保存在其文档目录中。如果我可以创建一个 OS X 应用程序来访问该应用程序的文档目录以及设备上的图片，这对这个应用程序将非常有帮助。我知道这是可能的，因为[这个应用程序](http://www.macroplant.com/iexplorer/)，但我似乎无法找到实现它的方法。iOS 应用程序确实需要获得苹果的批准，但桌面应用程序不需要。有了这些应用程序，我的目标是未越狱的 iOS 5 设备和 OS X Lion。关于我如何做到这一点的任何想法？

我正在考虑的其他一些解决方案：

1.  将apps文档目录上传到iCloud，然后下载到桌面
2.  上传到保管箱进行自动同步
3.  将桌面应用程序制作成服务器并通过网络从应用程序上传到桌面

这些都是备份解决方案，但如果我可以在不必依赖网络的情况下做到这一点，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T03:04:55.637

看看：[libimobiledevice](http://www.libimobiledevice.org/)。这是一个专门为此而设计的库。无论如何，Apple 不支持所有这些，因为没有任何公共 API 可以访问文件系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T03:26:53.657

您可以让您的设备充当 HTTP 服务器。有几个第三方库可以帮助您入门。我个人使用过基于[CocoaHTTPServer的](http://code.google.com/p/cocoahttpserver/downloads/detail?name=iPhoneHTTPServer3.zip&can=1&q=)[iPhonrHTTPServer3](https://github.com/robbiehanson/CocoaHTTPServer)吗？

# c# - 如果没有必要继续，表达式会中断吗？

> ID：11197174
> 
> 赞同：2
> 
> 时间：2012-06-25T20:51:24.970
> 
> 标签：c#

可以说我有

```
if (textbox.Text != null && textbox.Text.Length > someNum)
{
    //some code
} 
```

如果 textbox.Text 为空，它会因为 null.Length 不起作用而崩溃，还是会在第一个表达式之后中断，因为运算符是 && 并且没有继续的意义？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-25T20:52:40.273

这称为“短路评估”，C# 有它。所以是的，如果`textbox.Text`为空，它不会计算表达式的第二部分。

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/2a723cdk(v=VS.71).aspx](http://msdn.microsoft.com/en-us/library/2a723cdk(v=VS.71).aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T20:52:41.923

是的，C# 会进行逻辑短路。[MSDN](http://msdn.microsoft.com/en-us/library/2a723cdk%28v=vs.71%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T20:52:48.903

在发现第一个表达式为假后，它将中断。这称为短路，在许多现代语言（例如 C# 和 Java）中都很常见。

这就是为什么在检查另一个取决于对象首先不是 null 的条件之前检查 null 通常是一个好主意的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T20:53:43.520

是的。但是，我仍然会将该行拆分为检查 Null ：返回或抛出异常。它使代码更清晰。

# ruby-on-rails - Rails Activerecord 查询 has_many :through

> ID：11197175
> 
> 赞同：0
> 
> 时间：2012-06-25T20:51:27.643
> 
> 标签：ruby-on-rails, activerecord

在 has_many :through 关联中需要一些有关 Activerecord 查询的帮助。

模型：

**工作**

```
class Job < ActiveRecord::Base
  has_many :job_metadata, :dependent => :destroy
  has_many :metadata, :through => :job_metadata 
```

**元数据**

```
class Metadatum < ActiveRecord::Base
  attr_accessible :description, :metadata_type_id
  has_one :metadatum_type
  has_many :job_metadata, :dependent => :destroy
  has_many :jobs, :through => :job_metadata 
```

**元数据类型**

```
class MetadatumType < ActiveRecord::Base
  attr_accessible :description
  has_many :metada 
```

**工作元数据**

```
class JobMetadatum < ActiveRecord::Base
  attr_accessible :job_id, :metadatum_id
  belongs_to :job
  belongs_to :metadatum 
```

在控制台中，我可以运行：

```
@job.metadata 
```

返回

```
=> [#<Metadatum id: 2, description: "Part Time", metadatum_type_id: 1, created_at: "2012-06-23 20:42:14", updated_at: "2012-06-23 20:42:14">] 
```

**但是我将如何返回metadatum_type_id** = 1的 @jobs.metadata 上的metadatum_id？

我正在尝试这个：

```
@job.metadata.metadatum_id.where('metadata.metadatum_type_id' => 1) 
```

但得到以下错误：

```
NoMethodError:   Metadatum Load (0.3ms)  SELECT "metadata".* FROM 
"metadata" INNER JOIN "job_metadata" ON "metadata"."id" = 
"job_metadata"."metadatum_id" WHERE "job_metadata"."job_id" = 31
undefined method `metadatum_id' 
for #<ActiveRecord::Relation:0x007f7fb3188de8> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:18:16.653

尝试这个

```
@the_metadatum_record = @job.metadata.where("metadatum_type_id = 1").first 
```

这将搜索属于 @job 的 Metadatum 记录，并查看这些记录以找到 metadatum_type_id 为 1 的记录。

然后可以像这样访问id`@the_metadatum_record.id`

“第一个”被添加到末尾，因为如果您的作业有多个类型 1 的元数据，则查询将返回所有这些元数据。

另外，我同意迈克尔的观点，这些名字对于桌子来说是很糟糕的......

# javascript - 如何反转 JavaScript 变量中 HTML DOM 元素的顺序？

> ID：11197179
> 
> 赞同：1
> 
> 时间：2012-06-25T20:51:43.327
> 
> 标签：javascript, jquery

我需要打印插入我的数据库的收据，最新的收据应该在我的页面顶部。但是当我查询我的数据库时，我将所有数据存储在一个 var 中，它自然会将最早插入的数据放在我的页面顶部，我该如何反转呢？

```
function querySuccess(tx, results){
    if(results.rows.length == 0)
    {
        $("#ReceiptsList").html("<p>You have no receipts captured yet</p>");
    }
        else
    {
        var s = "";
        for(var i = 0; i<results.rows.length; i++)
        s += "<a href='edit.html?id="+results.rows.item(i).id+"'><strong><font size = 3> " + results.rows.item(i).name +"<font></strong>" + "&nbsp;&nbsp;&nbsp;&nbsp;<font size = 1>Date:" +results.rows.item(i).date +  "<font></a> ";
    }
        //I tried s.reverse(); but didn't work, nothing was showed on the page
        $("#ReceiptsList").html(s);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T20:54:23.003

反转循环？从最后开始？

```
for(var i = results.rows.length-1; i>=0; i--) 
```

或者追加字符串的开头，而不是结尾！

或者让服务器首先返回正确的顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T20:58:07.910

```
function querySuccess(tx, results){
if(results.rows.length == 0)
{
    $("#ReceiptsList").html("<p>You have no receipts captured yet</p>");
}
    else
{
    var s = "";
    for(var i = results.rows.length-1; i>=0; i--)
    s += "<a href='edit.html?id="+results.rows.item(i).id+"'><strong><font size = 3> " + results.rows.item(i).name +"<font></strong>" + "&nbsp;&nbsp;&nbsp;&nbsp;<font size = 1>Date:" +results.rows.item(i).date +  "<font></a> ";
}

    $("#ReceiptsList").html(s);
} 
```

# ios - iOS 文件 i/o 最佳实践

> ID：11197181
> 
> 赞同：0
> 
> 时间：2012-06-25T20:51:59.417
> 
> 标签：ios, file, io, plist, nsdictionary

我正在编写一个 iOS 应用程序，其中包含一组 NSDictionary 对象，这些对象可以由用户添加/删除和编辑。该数组存储在 plist 中并在运行时加载。我想知道何时将数据存储到 plist 中的最佳做法是什么，即我应该在每次数组更改时还是仅在应用程序终止或进入后台时才这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T20:56:52.187

获得有关您的应用程序性质的更多信息会有所帮助，但我会节省背景/终止。如果不需要的话，每隔几秒钟保存一次似乎效率低下。

我会尽可能多地保存，以使您的应用程序正常运行，不多也不少。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T20:57:24.500

仅在应用程序终止或进入后台时才这样做会很好。如果您有非常大的数据，您可能希望定期执行此操作，因为当应用程序即将终止时，您只有这么多时间来“整理”。但是对于小数据，在终止或进入后台时写入就可以了。

# python - 如何从嵌套生成器函数中产生结果？

> ID：11197186
> 
> 赞同：66
> 
> 时间：2012-06-25T20:52:26.673
> 
> 标签：python, function, nested, generator, yield

我有一个函数可以在下载结果时产生结果。出于这个问题的目的，假设我每秒产生一次刺痛，但我想要一个方便的函数来包装我的生成器：

```
import time

def GeneratorFunction(max_val):
    for i in range(0,5):
        time.sleep(1)
        yield "String %d"%i

def SmallGenerator():
    yield GeneratorFunction(3)

for s in SmallGenerator():
    print s 
```

...为什么不只打印我期望的 5 个字符串？相反，它似乎返回了生成器函数：

```
<generator object GeneratorFunction at 0x020649B8> 
```

我怎样才能让它像普通的生成器函数一样产生字符串？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2014-09-05T13:18:51.353

您可能必须使用自 Python 3.3 起可用的[新`yield from`](https://docs.python.org/3/whatsnew/3.3.html)的，称为“<a href="https://docs.python.org/3/reference/expressions.html#yieldexpr" rel="noreferrer">委托生成器” .

如果我正确理解了这个问题，我会遇到同样的问题，并在其他地方找到了答案。

我想做这样的事情：

```
def f():

    def g():

        do_something()
        yield x
        …
        yield y

    do_some_other_thing()
    yield a
    …
    g()  # Was not working.
    yield g()  # Was not what was expected neither; yielded None.
    …
    yield b 
```

我现在改用这个：

```
yield from g()  # Now it works, it yields x and Y. 
```

我从这个页面得到了答案：[Python 3: Using "yield from" in Generators - Part 1 (simeonvisser.com)](http://simeonvisser.com/posts/python-3-using-yield-from-in-generators-part-1.html)。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-06-25T20:54:24.177

不敢相信我错过了这个；答案是简单地返回应用了合适参数的生成器函数：

```
import time

def GeneratorFunction(max_val):
    for i in range(0,max_val):
        time.sleep(1)
        yield "String %d"%i

def SmallGenerator():
    return GeneratorFunction(3) # <-- note the use of return instead of yield

for s in SmallGenerator():
    print s 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-07-22T16:09:03.583

来到这里寻找另一种形式的“嵌套收益率”，终于找到了隐藏的答案。可能不是最好的，但它有效。

我想通过注册表树屈服，这是解决方案。

```
 def genKeys(key):
            for value in key.values():
                yield value
            for subkey in key.subkeys():
                print(subkey)
                for x in genKeys(subkey): #this is the trick
                    continue 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-22T21:09:34.153

这是另一个生成从 1 到 10 的乘法表的小例子：

```
class Gen1:

    def __init__(self, gen2):
        self.gen2 = gen2

    def __iter__(self):    
        for a in range(1, 11):    
            for b in self.gen2:
                yield a * b

class Gen2:    

    def __iter__(self):
        for a in range(1, 11):
            yield a

def main():

    gen2 = Gen2()
    gen1 = Gen1(gen2)

    for v in gen1:
        print(v)

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-02-12T13:43:15.647

我来寻找嵌套收益的另一种用途..

```
list_of_lists = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9],
]

def iter_all(foo):
    yield foo

    if isinstance(foo, list):
        for i in foo:
            for x in iter_all(i):
                yield x

print([i for i in iter_all(list_of_lists)]) 
```

输出：

```
[[[1, 2, 3], [4, 5, 6], [7, 8, 9]], [1, 2, 3], 1, 2, 3, [4, 5, 6], 4, 5, 6, [7, 8, 9], 7, 8, 9] 
```

# sql - sql中的减号运算符

> ID：11197193
> 
> 赞同：6
> 
> 时间：2012-06-25T20:52:46.047
> 
> 标签：sql

我正在尝试用减号创建一个 sql 查询。

我有查询 1，它返回 28 行和 2 列 我有查询 2，它返回 22 行 2，查询 2 中有相同的 2 列。

当我创建查询 query1 减去查询 2 时，它应该只显示 28-22=6 行。但它显示了 query1 返回的所有 28 行。

请指教。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-05-08T11:57:11.990

尝试使用 EXCEPT 而不是 MINUS。例如：让我们考虑一种情况，您想找出表中尚未分配给您的任务（因此基本上您正在尝试查找可以执行的任务）。

```
SELECT TaskID, TaskType
FROM Tasks
EXCEPT
SELECT TaskID, TaskType
FROM Tasks
WHERE Username = 'Vidya' 
```

这将返回所有尚未分配给您的任务。希望有帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-25T21:00:33.150

如果 MINUS 对您不起作用，您想要的一般形式是外部选择中的主查询和 not exists 子句中的其他查询的变体。

```
select <insert list of fields here>
from mytable a
join myothertable b 
on b.aId = a.aid
where not exists (select * from tablec c where a.aid = c.aid) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-25T21:03:03.287

这些字段可能并不完全相同。可能其中一个字段是 char(10)，另一个是 char(20)，它们都包含字符串“TEST”。他们可能“看起来”一样。

如果您正在处理的数据库支持“INTERSECT”，请尝试此查询，看看有多少是完全匹配的结果。

```
select field1, field2 from table1
intersect 
select field1, field2 from table2 
```

要获得您期望的结果，此查询应为您提供 22 行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-25T20:57:55.703

像这样的东西：

```
select field1, field2, . field_n
 from tables
 MINUS
 select field1, field2, . field_n
 from tables; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-06T16:01:43.500

它返回上层查询中不包含在第二个查询中的差异记录。

在您的情况下，例如 A={1,2,3,4,5...28} AND B={29,30} 然后 AB={1,2,3....28}

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-03-11T06:53:00.303

MINUS 的工作原理与它在集合操作中的工作原理相同。假设如果你已经设置了 A 和 B，A = {1,2,3,4}; B = {3,5,6} 那么，AB = {1,2,4}

如果 A = {1,3,5} 且 B = {2,4,6}，则 AB = {1,3,5}。这里 MINUS 操作之前和之后的 count(A) 将是相同的，因为它不包含与集合 B 的任何重叠项。

在类似的行上，可能是在查询 2 中获得的结果集可能与查询 1 的结果没有匹配项。因此，您仍然得到 28 行而不是 6 行。

希望这可以帮助。

# html - 如何根据浏览器窗口的大小使我的网页可缩放？

> ID：11197199
> 
> 赞同：0
> 
> 时间：2012-06-25T20:52:59.873
> 
> 标签：html, css

我刚刚创建了我的第一个[网站](http://individual.utoronto.ca/andrewlouis)，我注意到如果浏览器窗口变得太小，这些元素开始看起来很奇怪并且聚集在一起。我想知道如何使元素可扩展

相关HTML：

```
<!DOCTYPE html>
<html>
<head>
    <title>Andrew Louis, University of Toronto</title>
    <link rel="stylesheet" href="fonts/stylesheet.css" type="text/css" />
    <link rel="stylesheet" href="style.css" type="text/css" />
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="javascript/jqueryscript.js"></script>
    <script src="javascript/popup.js"></script>
    <script language="JavaScript">
        var i = 0;

        imageObj = new Image();

        images = new Array();

        images[0] = "images/book-black.png";
        images[1] = "images/male-black.png";
        images[2] = "images/telephone-black.png";

        //Start preloading
        for (i = 0; i<=2; i++)
        {
            imageObj.src=images[i];
        }
    </script>
<body>

        <div id="heading"> 
            <span class="border">Andrew Louis</span>
            <div id = "subheading">
            <p> <br /><b>Andrew</b> is a big fan of grandiose ideas that propel change, imaginative software,<br /> innovative web design, and caffè americanos.</p>
            </div>
        </div>

        <!-- <div id="footer">      -->
            <div class="nav_wrapper">
                <ul class = "Fade" id="list_orientation">               
                    <li id="about"><a href="AboutMe.html"><img src = "images/male.png" height = '50' width = '50' /></a></li>
                    <li id="port"><a href="Portfolio.html"><img src = "images/book.png" height = '50' width = '50' /></a></li>
                    <li id="contact"><a href="Contact.html"><img src = "images/telephone.png" height = '50' width = '50' /></a></li>
                </ul> 

            </div>
        <!-- </div> -->

</body>
</html> 
```

相关CSS：

```
.Chunk{
    font-family:'ChunkFiveRomanRegular';
}

.Museo{
    font-family:'MuseoSlab500Regular';
    font-size:20px;
}

.nav_wrapper {
    position:fixed;
    color:#000;
    left: -100px;
    right: 0px;
    bottom: 0px;
    text-align:center;
    height:225px;
    /*background:white;
    border-style:dotted;*/
}

.global_nav{
    position:fixed;
    float:bottom;
    padding:5px;
    color:#000;
    left: 0px;
    right: 0px;
    bottom: 0px;
    text-align:center;
    height:17px;
    font-size:10px;
    background:white;
}

#portfolio_text{
    text-align:center;
}

#heading{
    font-family:'Lobster1.3Regular';
    color:#D04D21;
    position: absolute;
    font-size:80px;
    top: 10%;
    left: 0px;
    width: 100%;
    height: 1px;
    text-align:center;
    text-shadow: 0 0 2px rgba(0,0,0,0.9);
}

.border{
    border-top: 1px solid #D04D21;/*#000000;*/
    border-bottom:1px solid #D04D21;/*#000000;*/
    padding:20px;
}

.rounded_border{
    border:2px dashed;
    padding:10px 40px; 
    border-radius:25px;
}

body{
background:#FFFFFF;
}

#subheading{
    font-family:'MuseoSlab500Regular';
    text-align:center;
    font-size:25px;
    text-shadow: 0 0 1px rgba(0,0,0,0.1);
}

#list_orientation li a {
    text-decoration:none;
    text-align:center;
    color:black;

}
#list_orientation li{
    display:inline-block;
    padding:50px;
    height:50px;width:50px;
    text-align:center;
    width:20%;
    margin-left:3%;
}

.Fade img{
    border-style:dotted;
    /*  opacity:0.4;
    padding:10px;
    padding-bottom:20px;*/
    background:white;
    border-color:#D04D21;

    padding: 2em 2em 2em 2em;
    -moz-border-radius: 5em;
    -webkit-border-radius: 5em;
    border-radius: 5em;
}

.Fade img:hover{
    background:#D04D21;
    border-color:white;
}

#pup {
  position:absolute;
  z-index:200; /* aaaalways on top*/
  text-align:center;
  font-family:'ChunkFiveRomanRegular';
  padding: 3px;
  margin-left: 10px;
  margin-top: -5px;
  width: 120px;
  border: 1px solid black;
  background-color:white;
  color: #D04D21;
  opacity:0.9;
  font-size: 1em;/*0.95em;*/
}

.Entypo{
    font-family:'EntypoRegular';
    font-size:100px;
}

a{
text-decoration:none;
color:#D04D21;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:01:34.903

根据您要创建的效果，这可能会有很大差异。

最简单的方法是设置主体（或新的顶级 div）的最小高度和最小宽度，并让用户在较小的浏览器窗口中滚动。

您将提出的大多数解决方案可能都涉及处理各种元素的这些最小高度和最小宽度！

但是，“更好”的解决方案是避免位置：绝对或固定。这些不能很好地扩展。尝试在 div 上使用填充和边距来获得所需的效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T21:11:17.730

使用 css zoom 和 firefox 的等价物。(-moz-transform:scale(xx)), 使用 jquery

CSS 缩放适用于 IE 和 Chrome。

加载 DOM 后，

```
var zoomRatio = $(window).width() / 1024; 
//if your site is fixed at 1024 px for example

$(document).ready(function(){

$(html).css("zoom",zoomRatio);

}); 
```

这没有得到很好的支持，但它可以完成工作。这就是我目前正在使用的。

# c# - 将对象中的所有数据放入一个二维数组中

> ID：11197202
> 
> 赞同：0
> 
> 时间：2012-06-25T20:53:09.807
> 
> 标签：c#, winforms

我需要将对象中的所有数据转储到二维数组中

这是声明：

```
GetItemCall oGetItemCall = new GetItemCall(oContext); 
```

然后，我可以使用`oGetItemCall.Item.ConditionID`or`oGetItemCall.Item.ListingDetails.EndTime`等​​。

但是该`oGetItemCall`对象有很多变量，我想将它们添加到一个易于阅读的二维数组中。有什么办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T20:58:22.230

数组是必需的吗？为什么不使用更灵活的结构，比如列表。所以尝试将对象转换为列表。可以通过索引轻松访问列表：在这种情况下，通过对象的属性 名称[。](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)[反思](http://msdn.microsoft.com/en-us/library/system.reflection.aspx)可以解决问题。看看[这里](http://www.switchonthecode.com/tutorials/csharp-tutorial-using-reflection-to-get-object-information)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:02:13.317

目前尚不清楚您为什么要这样做，但是其中任何一个都应该这样做。

```
 string[,] some = new string[100,2]; 
        Hashtable table = new Hashtable(); 

        // array
        some[0,0] = "Key";
        some[0,1] = "value";

        //  hashtable 
        table["key"] = "value"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:57:55.700

因此，您想查看项目及其所有属性和值吗？使用反射。

它并不完美，也不完整——但如果这是你想要的，它会给你一个很好的起点。易于扩展以添加类型名称等。

```
public static List<string> ReflectObject(object o)
{
    var items = new List<string>();

    if (o == null)
    {
        items.Add("NULL"); // remove if you're not interested in NULLs.
        return items;
    }

    Type type = o.GetType();

    if (type.IsPrimitive || o is string)
    {
        items.Add(o.ToString());
        return items;
    }

    items.Add(string.Format("{0}{1}{0}", " ----- ", type.Name));

    if (o is IEnumerable)
    {
        IEnumerable collection = (IEnumerable)o;
        var enumerator = collection.GetEnumerator();

        while (enumerator.MoveNext())
        {
            foreach (var innerItem in ReflectObject(enumerator.Current))
            {
                items.Add(innerItem);
            }
        }
    }
    else
    {
        var properties = type.GetProperties(BindingFlags.Instance | BindingFlags.Public);

        foreach (var property in properties)
        {
            object value = property.GetValue(o, null);

            foreach (var innerItem in ReflectObject(value))
            {
                items.Add(string.Format("{0}: {1}", property.Name, innerItem));
            }
        }
    }

    return items;
} 
```

它可以这样使用：

```
Test t = new Test();
t.MyProperty1 = 123;
t.MyProperty2 = "hello";
t.MyProperty3 = new List<string>() { "one", "two" };
t.MyTestProperty = new Test();
t.MyTestProperty.MyProperty1 = 987;
t.MyTestProperty.MyTestProperty = new Test();
t.MyTestProperty.MyTestProperty.MyProperty2 = "goodbye";

var items = MyReflector.ReflectObject(t);

foreach (var item in items)
{
    Console.WriteLine(item);
} 
```

这将导致：

```
----- Test -----
MyProperty1: 123
MyProperty2: hello
MyProperty3:  ----- List`1 -----
MyProperty3: one
MyProperty3: two
MyTestProperty:  ----- Test -----
MyTestProperty: MyProperty1: 987
MyTestProperty: MyProperty2: NULL
MyTestProperty: MyProperty3: NULL
MyTestProperty: MyTestProperty:  ----- Test -----
MyTestProperty: MyTestProperty: MyProperty1: 0
MyTestProperty: MyTestProperty: MyProperty2: goodbye
MyTestProperty: MyTestProperty: MyProperty3: NULL
MyTestProperty: MyTestProperty: MyTestProperty: NULL 
```

# java - 将默认值设为先前选择的值 (JSTL)

> ID：11197212
> 
> 赞同：0
> 
> 时间：2012-06-25T20:53:54.830
> 
> 标签：java, javascript, jsp, jstl, el

我有一个下拉菜单，里面全是帐单名称：

```
<select id="mailer_filter">
<optgroup label="VIEW BY SUBSCRIPTION">
            <c:forEach var="Mailer" items="${mailerlist.billerNameList}">
            <option value="searchFor=${Mailer.billerName}&searchBy=3&addressTypeF=${requestScope.addressTypeF}&folder=${mailitems.mailboxAttributes.folder}"><c:out value="${Mailer.billerName}"/></option>              
            </c:forEach>
          </optgroup>
        </select>
        <script type="text/javascript">
          $('#mailer_filter').change(function(){
            epost.fn.windowLocation('mailList.a?' + $(this).val());
          });
        </script> 
```

我想做的是用户从下拉列表中选择的项目。当页面再次重新加载数据时，让该项目显示为下拉列表中的默认选定值。我假设有很多方法可以做到这一点，这里涉及的是将所选项目存储在请求范围内或我猜的东西。

变量 = ${Mailer.billerName} 是当用户从下拉列表中选择该名称时，我希望在重新加载时设为默认名称。感谢您的时间、知识和努力。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:42:08.370

确实存储您要预选的值，并添加以下代码：

```
<option value="..." 
    <c:if test="${Mailer.billerName == valueToPreSelect}>
        selected="selected"
    </c:if>><c:out value="${Mailer.billerName}"/></option> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T21:43:55.357

我不确定我的问题是否正确，但您可以将 ${Mailer.billerName} 保存为请求属性，然后执行以下操作：

```
<c:forEach var="Mailer" items="${mailerlist.billerNameList}">
            <option 

<c:if check='${request.billerName eq Mailer.billerName}' >selected</c:if>

value="searchFor=${Mailer.billerName}&searchBy=3&addressTypeF=${requestScope.addressTypeF}&folder=${mailitems.mailboxAttributes.folder}"><c:out value="${Mailer.billerName}"/></option>              
            </c:forEach> 
```

# javascript - JavaScript 移动延迟和多次击键

> ID：11197220
> 
> 赞同：2
> 
> 时间：2012-06-25T20:54:27.250
> 
> 标签：javascript, keycode

这是我的问题：[http ://testepi.kvalitne.cz/test/](http://testepi.kvalitne.cz/test/)

我不希望按键和方块移动之间的延迟。我也想知道如何沿对角线移动（同时按两个键）。

我的代码：

```
$(function(){

document.addEventListener("keydown", move, false);

var x = 0;
var y = 0;

function move(event){
  if(event.keyCode==37){
        x -= 10;
  $("#square").css("left", x);
  }

  if(event.keyCode==39){
        x += 10;
  $("#square").css("left", x);
  }

  if(event.keyCode==38){
        y -= 10;
  $("#square").css("top", y);
  }

  if(event.keyCode==40){
        y += 10;
  $("#square").css("top", y);
  }

}

}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-25T21:04:21.443

首先，为了避免按键/重复延迟，您必须将程序包装在一个循环中，并使键盘的状态在该循环的范围内可用，其次要监视多个按键，您需要跟踪单个 keydown 和 keyup事件：

```
var x = 0;
var y = 0;

// store the current pressed keys in an array
var keys = [];

// if the pressed key is 38 (w) then keys[38] will be true
// keys [38] will remain true untill the key is released (below)
// the same is true for any other key, we can now detect multiple
// keypresses
$(document).keydown(function (e) {
    keys[e.keyCode] = true;
});

$(document).keyup(function (e) {
    delete keys[e.keyCode];
});
// we use this function to call our mainLoop function every 200ms
// so we are not relying on the key events to move our square
setInterval( mainLoop , 200 );

function mainLoop() {
     // here we query the array for each keyCode and execute the required actions
     if(keys[37]){
        x -= 10;
        $("#square").css("left", x);
     }

     if(keys[39]){
        x += 10;
        $("#square").css("left", x);
     }

     if(keys[38]){
        y -= 10;
        $("#square").css("top", y);
     }

     if(keys[40]){
        y += 10;
        $("#square").css("top", y);
     }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T21:08:47.180

如果您正在尝试实现类似游戏的 2d 精灵移动，我建议您有一个 x 和 y 速度的概念，而不是在按键上移动精灵固定量。

所以在按键时，从 x 或 y 速度中添加或减去。

```
var xvel = 0,
    yvel = 0,
    x = 0,
    y = 0;

setInterval(function () {
                 y += yvel;
                 x += xvel;
                 $("#square").css("left", x);
                 $("#square").css("top", y);
            }, 16); //run an update every 16 millis

document.addEventListener("keydown", move, false);

function move(event){
  if(event.keyCode==37){
        xvel -= 10;
  }

  if(event.keyCode==39){
        xvel += 10;
  }

  if(event.keyCode==38){
        yvel -= 10;
  }

  if(event.keyCode==40){
        yvel += 10;
  }

} 
```

但是，您还需要担心 keyup 事件，因为速度会一直保持到您取消它为止。

您可以使用`setInterval`每 x 毫秒更新一次精灵的位置。（游戏滴答）

要沿对角线移动，只需同时加/减 x 和 y 的速度。

这只是一个示例，但还有更多关于精灵移动的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:39:55.230

你看过[这里](https://developer.mozilla.org/en/DOM/KeyboardEvent)吗？您应该能够通过检查多个键是否被按下而不被释放来进行对角线移动。

# python - 在 python 中使用类型类创建类型类

> ID：11197221
> 
> 赞同：3
> 
> 时间：2012-06-25T20:54:34.750
> 
> 标签：python, metaclass

我正在阅读关于元类的这篇有趣的文章[什么是 Python 中的元类？](https://stackoverflow.com/questions/100003/what-is-a-metaclass-in-python). 接受的答案显示了如何使用具有以下签名的类型创建一个类。

> type（类名，父类元组（继承用，可以为空），包含属性名和值的字典）

我尝试使用上面的签名创建“类型”类，令我惊讶的是我一开始就被允许创建一个！感谢您的意见！

`type = type('type',(),{});`

其次，在我使用上述语法创建类型类后，我无法做到

```
myclass = type('myclass',(),{}); 
```

和 `type = type('type',(),{});`

我有一个错误说

> Traceback（最近一次调用最后一次）：文件“”，第 1 行，类型错误：对象。**new** () 不带参数

但是，当我尝试以下操作时，我可以成功。

```
class myclass(object):
    pass 
```

我很困惑，因为根据我的理解，上面的代码片段应该调用 type 来尝试创建类“myclass”。发生什么了！？我错过了一些细节吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-25T20:59:29.763

你已经用 type with 遮蔽了 type with`type = type('type',(),{})`

请注意，分号在 Python 中是多余的。

所以你正在创建一个不能做任何事情的类型。

这就是为什么后来的`type`休息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:20:39.280

定义

```
>>> shadow = type("type",(),{})
>>> shadow
<class '__main__.type'>
>>> isinstance(shadow,type)
True
>>> issubclass(shadow,type)
False
>>> shadow(int)

Traceback (most recent call last):
  File "<pyshell#7>", line 1, in <module>
    shadow(int)
TypeError: object.__new__() takes no parameters 
```

建造

```
>>> class shadow(type):
    pass

>>> shadow
<class '__main__.shadow'>
>>> isinstance(shadow,type)
True
>>> issubclass(shadow,type)
True
>>> shadow(int)
<type 'type'>
>>> shadow(type)
<type 'type'>
>>> shadow(1)
<type 'int'> 
```

[Python（和 Python C API）：__new__ 与 __init__](https://stackoverflow.com/questions/4859129/python-and-python-c-api-new-versus-init)

# javascript - 如何将标签 SRC 加载到 javascript 变量中以在多个图像中重复使用？

> ID：11197222
> 
> 赞同：2
> 
> 时间：2012-06-25T20:54:41.663
> 
> 标签：javascript, jquery, css, image-processing, src

所以这是我的快速网页下载计划......

1.  将所有图像放入单个 png-24 图像精灵中。
2.  将该图像编码为 base64 并将其包含在网页 HTML 代码中。
3.  复制原始图像精灵的 SRC 并将其重新用于徽标、共享按钮、其他图像等。

我能预见的唯一问题是 base64 编码图像源的重复。

我可以轻松地使用 jQuery 提取图像源并将其重新插入到我的所有空白图像（需要创建精灵的图像）中吗？

编辑：有些人提到 base64 图像没有被缓存，但是如果我告诉它，我的整个网页（包含 base64 图像）不会被缓存吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T21:02:21.387

这是 CSS 图标/可重用图像的常用技术。

您可以`src`使用`$(element).attr('src');`.

但是，我看不到将图像二进制文件（我假设您的意思是图像文件本身）编码为 base64 以包含在 HTML 标记中的优势。你可能有点想多了。

我不认为你可以通过将图像数据重新编码为 base 64 来“保存”字节，主要是因为 base 64 是一个比原始数据中使用的编码更窄的字符集（想想 binary `111`= decimal `7`），所以我期望一个实际上更大的输出。（但这只是我的理论，如果我错了，请纠正我。）

但是，例如，如果您确实设法重新编码为最多相同大小的标记，那么您就不会在“更快的下载”方面取得任何进展。您仍在下载相同数量的数据。很可能更多。

如果您确实管理较小的有效负载，那么编码/重新编码的性能损失是否值得？更不用说跨浏览器的兼容性了。

更好的技术是将图像打包成单个图像文件（这是您练习的精神），然后让浏览器正常下载。一旦图像的一个副本被下载，只要它被浏览器缓存，它就不会再下载它了。

### 编辑

要回答您对网页缓存的编辑，是的，您的网页将被缓存。您的 base-64 编码图像也是如此。但是由于您的图像实际上是 HTML 标记的一部分，它们将**与**HTML 页面一起缓存。

例如，如果我下载`foo.html`（其中包括我的编码精灵文件），我肯定会像往常一样获得我的标记。该页面被缓存。

现在，我下载`bar.html`（它也使用我的精灵文件）。我希望您的图像不能从 缓存访问`bar.html`，因为就浏览器而言，该图像是 .html 标记的一部分`foo.html`。它可能甚至不会意识到那里有一个图像。

缓存的工作方式（据我所知）是**URL 匹配**。这就是为什么如果我在一个页面中下载`facepalm.jpg`，然后在另一个页面中再次请求`facepalm.jpg`，浏览器会识别出我已经下载了它，所以它不会。

根据您的编码计划，我不会向 请求`foo.html`（或其中的一部分）`bar.html`，因此我希望您的图像缓存不会像您在问题中所期望的那样工作。

但是，如果我`foo.html` *再次*访问，我将获得缓存该页面的所有好处，因为我已经“之前下载过”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T21:01:47.717

我同意，更好的计划是使用具有许多精灵的单个图像，然后使用

```
background: url(...)
background-position: 0px 0px; 
```

CSS 中的属性。这样，您只需要加载 1 个缓存的图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T20:57:08.247

您可以使用`var imgSrc = $("#yourImage").attr("src");`然后使用`$("img").attr("src", imgSrc);`来完成您的要求。

我不确定将其编码为 base64 是最佳选择，因为 base64 图像不会被缓存，因此每次页面访问都会重新加载它。现在已经被广泛接受的是 base64 编码增加了大约 33% 的文件大小。

阅读更多：[http ://davidbcalhoun.com/2011/when-to-base64-encode-images-and-when-not-to](http://davidbcalhoun.com/2011/when-to-base64-encode-images-and-when-not-to)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-25T21:38:45.893

我认为 base64 是个坏主意。只需正常加载精灵。

不要盲目地不惜一切代价消除所有可能的 HTTP 请求。（即使“这是 Google 所做的。”）实现良好的性能是一种平衡行为，考虑到浏览器之间的差异，它更像是一门艺术而不是科学。

你不想这样做的原因：

*   您的图像精灵不会*跨页面*缓存- 换句话说，您必须在*每个*页面上传输整个图像。假设单独提供的图像具有适当的缓存标头，则后续页面请求将变慢并浪费带宽。
*   Base 64 编码本质上是浪费带宽。base64 编码的文件**将比**原始文件大 33%。这对于几千字节的文件来说并不重要，但是对于大文件来说这将是一个大问题，比如你的图像精灵。
*   正如您已经意识到的那样，您必须在`<img>`页面上的每个标签中复制 base64 编码的 sprite，这非常浪费，而通过脚本修复这个问题会让我们...
*   您的图像变得依赖于 JavaScript，这是一个坏主意。如果脚本没有加载怎么办？JavaScript 已关闭？
*   消除这个图像 HTTP 请求实际上并不能在页面显示多长时间之前完成，因为图像不会阻止 DOM 就绪。重要的是减少对阻塞渲染的内容的 HTTP 请求：脚本和 CSS。（在大多数情况下，每个请求一个。）在脚本和 CSS 完全加载之前，您的页面根本不会呈现。但是，页面会在图像下载之前呈现（尽管有空白空间）。
*   您需要平衡图像类型和 HTTP 请求数量。图标等通常应以 PNG 格式显示，以便在一个 HTTP 请求中下载尽可能多的图像。任何本质上的摄影作品都需要进入*自己的*JPEG 格式。 **请勿将 PNG 用于图片。** 这是错误的压缩算法，会导致文件比同类 JPEG 大 1000%。

# git - 如何更改 Git 中的默认目录？

> ID：11197227
> 
> 赞同：0
> 
> 时间：2012-06-25T20:54:53.237
> 
> 标签：git

我的问题是我的“文档和设置”文件夹位于网络驱动器上，速度非常慢。因为这是 Git（和大多数程序）默认存储所有设置和内容的地方，所以这最终会成为一个问题，因为即使是一个简单的“mkdir”也可能需要 30 秒以上的时间。如何更改 Git 以将所有设置/存储库存储在不同的位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:07:06.570

您可以将 repos 存储在任何地方，因此请将它们放在本地磁盘上。

要将 msys 设置`~`在本地磁盘上，发布到建议副本的答案包含批处理命令来设置您需要的东西。小心在旧家和新家之间复制 git 全局设置。

# android - 脸书获取好友ID

> ID：11197229
> 
> 赞同：0
> 
> 时间：2012-06-25T20:54:59.527
> 
> 标签：android, facebook

> **可能重复：**
> [使用 Graph API 获取所有 Facebook 好友](https://stackoverflow.com/questions/8514664/getting-all-facebook-friends-using-graph-api)

我正在尝试在 Android 上获取我所有朋友的 Facebook ID。这是我使用的代码：

```
public static List<String> getFaceBookFriendsIDs() {

        List<String> friendsList = null;
        try {
            JSONObject result = new JSONObject(ParseFacebookUtils.getFacebook().request("me/friends"));
            JSONArray friendsArray = result.getJSONArray("data");

            friendsList = new ArrayList<String>();
            for (int i = 0; i < friendsArray.length(); i++) {
                friendsList.add(friendsArray.getJSONObject(i).getString("id"));
            }
        } 
        catch (MalformedURLException e) {
            e.printStackTrace();

        } 
        catch (JSONException e) {
            e.printStackTrace();

        } 
        catch (IOException e) {
            e.printStackTrace();

        }

        return friendsList;

    } 
```

然而，列表的大小与我拥有的朋友数量不同。这是正常的，还是我做错了什么？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-25T21:57:22.047

使用 RestFB API！[看到这里](http://restfb.com/#fetching-connections) 使一切变得更容易并产生（也许）一些开销，但仍然可能更容易。

# xcode - 如何为tabbarbutton图像设置动画

> ID：11197233
> 
> 赞同：0
> 
> 时间：2012-06-25T20:55:16.673
> 
> 标签：xcode, core-animation, uitoolbar, uitoolbaritem

我有一个 toolBarItem 调用数据库上的保存操作。我真的很想动态更改物品（橱柜）的图像，以便抽屉打开，标签在“内部”动画，然后关闭。非常像邮件应用动画上的垃圾项。

我知道如何通过在数组中给定的时间（连同 CT 比例数组）上缩放动画来制作 UIView 弹出窗口，所以我猜它可以或多或少地完成同样的方法。

有谁知道谁来做到这一点的例子？回到 xcode 4.1，我能够在标签移动时突出显示按钮，但我不能再这样做了（不知何故，我确实在 toolbarItem 上添加了一个普通按钮，我不能再这样做了）。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T17:06:37.337

好吧，如果有人遇到同样的问题，这里是如何做到的：

```
- (IBAction)barButtonAction:(UIBarButtonItem *)sender {

    NSArray *frameArray=[NSArray arrayWithObjects:[UIImage imageNamed:@"01-refresh.png"], [UIImage imageNamed:@"02-redo.png"], [UIImage imageNamed:@"03-loopback.png"], [UIImage imageNamed:@"03-loopback.png"],[UIImage imageNamed:@"03-loopback.png"],[UIImage imageNamed:@"03-loopback.png"],[UIImage imageNamed:@"03-loopback.png"],[UIImage imageNamed:@"03-loopback.png"], nil];

    self.button.image=[UIImage animatedImageWithImages:frameArray duration:10.0];

} 
```

# cakephp - CakePHP 2.0分页字段中的Haversine公式不起作用

> ID：11197240
> 
> 赞同：0
> 
> 时间：2012-06-25T20:55:52.163
> 
> 标签：cakephp, field, distance, pagination, haversine

这是我在这个网站上的第一篇文章，所以请多多关照。

使用 find() 方法完成这项工作没有任何问题，但是当我尝试使用 paginate 组件运行它时，没有运气。我只是想在字段选项中运行 Haversine 公式来计算距离。在 Cake Book 中，它说“您还可以包含其他 find() 选项，例如字段：”。没有提到任何警告。

所以，这就是我想要运行的：

```
$this->paginate = array(
    'joins' => array(
        array(
            'table' => 'ride_types',
            'alias' => 'RideTypes',
            'type' => 'inner',
            'conditions'=>array('RideTypes.id = Rides.ride_type')
        )
    ),
    'group' => array(
        "Rides.id HAVING distance < $filter_radius AND ride_time >= '$filter_earliest_time' AND ride_time <= '$filter_latest_time' AND ride_date >= '$filter_earliest_date' AND ride_date <= '$filter_latest_date'"
    ),
    'fields' => array(
        "( 3959 * acos( cos( radians($filter_lat) ) * cos( radians( Rides.lat ) ) * cos( radians( Rides.lng ) - radians($filter_lng) ) + sin( radians($filter_lat) ) * sin( radians( Rides.lat ) ) ) ) AS distance"
    ),
    'limit' => 5,
    'page' => $paginate_page,
    'order' => array('Rides.start_time DESC'),
);

$rides = $this->paginate('Rides',$options['conditions']); 
```

我收到此错误：

错误：SQLSTATE [42S22]：未找到列：1054“有子句”中的未知列“距离”

SQL 查询： SELECT COUNT(*) AS `count`FROM `velobuddies`。`rides`作为`Rides`内部 JOIN `velobuddies`。`ride_types`AS `RideTypes`ON ( `RideTypes`. `id`= `Rides`. `ride_type`) WHERE 1 = 1 GROUP BY `Rides`。`id`距离 < 5

同样，如果我将所有这些完全相同的选项应用于 find('all') 方法，它会完美运行，所以我知道逻辑是正确的......或者至少是可行的。

那么这里发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T23:55:59.917

丹尼尔这篇文章可能有答案，虽然它是基于 CakePHP 1.3 的。它涉及基于聚合绑定模型。

[http://cakephp.1045679.n5.nabble.com/Pagination-with-HasMany-and-SQL-Aggregation-td1307450.html](http://cakephp.1045679.n5.nabble.com/Pagination-with-HasMany-and-SQL-Aggregation-td1307450.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-17T01:07:34.730

看起来您的型号名称可能有问题。如果您的应用程序遵循正确的 CakePHP 约定，那么您应该使用 Ride.field 而不是 Rides.Field。在 CakePHP 查询中，您希望引用模型而不是表名。

# data-binding - 如何在 observableArray 发生变化时自动更新 UI？

> ID：11197241
> 
> 赞同：0
> 
> 时间：2012-06-25T20:55:52.930
> 
> 标签：data-binding, view, knockout.js, viewmodel, ko.observablearray

您好，我有以下使用 knockout.js 的代码，

```
var allJobberDetailsArray = [];
getAllJobberDetailsArray();
function getAllJobberDetailsArray() {
    $(function() {
        $.ajax({
            url: 'http://example.com',
            type: 'GET',
            data: {
                request: "yes",
                getAllJobberDetailsArray: "yes"
            },
            success: function(data) {
                allJobberDetailsArray = data;
            }
        });
    })
}

// ViewModel
function JobberCheckBoxListUserControlViewModel() {
    var self = this;
    self.allJobberDetailsArray = ko.observableArray(allJobberDetailsArray);
}
ko.applyBindings(new JobberCheckBoxListUserControlViewModel()); 
```

对 allJobberDetailsArray 的任何更改我想自动更新 UI 说添加更新或删除数组项我希望 UI 反映它。

我如何实现它？

**编辑**

```
var allJobberDetailsArray = ko.observableArray();

getAllJobberDetailsArray();

function getAllJobberDetailsArray() {
    $(function() {
        $.ajax({
            url: 'http://example.com',
            type: 'GET',
            data: {
                request: "yes",
                getAllJobberDetailsArray: "yes"
            },
            success: function(data) {
                allJobberDetailsArray.removeAll();
                allJobberDetailsArray.push(data);
            },
        });
    })
}

// ViewModel
function JobberCheckBoxListUserControlViewModel() {
    var self = this;
    self.allJobberDetailsArray = allJobberDetailsArray;// allJobberDetailsArray is now observable but any change to this doesn't reflect in the UI
}
var viewModel = new JobberCheckBoxListUserControlViewModel();
ko.applyBindings(viewModel); 
```

在上面的代码中，我使数组本身可观察，并尝试在数组有任何更改时自动更新 UI 我如何实现它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:07:30.073

首先，您要更新的数组不是可观察数组。其次，您的成功回调实际上会覆盖数组。最后，您没有保留对 viewModel 的引用，因此您无法正确更新可观察数组。ObservableArray 包装真实数组以使它们可观察。所有添加的删除等都需要通过 observableArray，以便可以通知订阅者。

试试这个。

```
// ViewModel
function JobberCheckBoxListUserControlViewModel(initialArray) {
    var self = this;
    self.allJobberDetailsArray = ko.observableArray(initialArray || []);
}

var viewModel = new JobberCheckBoxListUserControlViewModel();

function getAllJobberDetailsArray() {
    $(function() {
        $.ajax({
            url: 'http://example.com',
            type: 'GET',
            data: {
                request: "yes",
                getAllJobberDetailsArray: "yes"
            },
            success: function(data) {
                viewModel.allJobberDetailsArray(data);
            }
        });
    })
}

ko.applyBindings(viewModel); 
```

我还建议重构将该`getAllJobberDetailsArray`方法放在您的 viewModel 中，这样它就不会污染全局命名空间并保持封装。

希望这可以帮助。

# javascript - JavaScript 等效于 jQuery 的扩展方法

> ID：11197247
> 
> 赞同：101
> 
> 时间：2012-06-25T20:56:24.953
> 
> 标签：javascript, jquery, object, extend

### 背景

我有一个将`config`对象作为参数的函数。在函数中，我也有`default`对象。这些对象中的每一个都包含本质上作为函数中其余代码的设置的属性。为了避免必须指定`config`对象中的所有设置，我使用 jQuery 的`extend`方法来填充一个新对象，如果对象中没有指定它们，则使用对象`settings`中的任何默认值：`default``config`

```
var config = {key1: value1};
var default = {key1: default1, key2: default2, key 3: default 3};

var settings = $.extend(default, config);

//resulting properties of settings:
settings = {key1: value1, key2: default2, key 3: default 3}; 
```

### 问题

这很好用，但我想在不需要 jQuery 的情况下重现此功能。是否有一种同样优雅（或接近）的方法可以用普通的 ol' javascript 做到这一点？

* * *

### 编辑：非重复理由

这个问题不是“[如何动态合并两个 JavaScript 对象的属性？](https://stackoverflow.com/questions/171251/how-can-i-merge-properties-of-two-javascript-objects-dynamically) ”问题的重复。而这个问题只是想创建一个包含来自两个单独对象的所有键和值的对象 - 我特别想解决在两个对象共享一些但不是所有键并且哪个对象将获得优先权的情况下如何做到这一点（默认值）用于在存在重复键的情况下生成的对象。更具体地说，我想解决使用 jQuery 的方法来实现这一点，并找到一种不使用 jQuery 的替代方法。虽然这两个问题的许多答案重叠，但这并不意味着问题本身是相同的。

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2012-06-25T21:03:47.823

要在您的代码中获得结果，您将执行以下操作：

```
function extend(a, b){
    for(var key in b)
        if(b.hasOwnProperty(key))
            a[key] = b[key];
    return a;
} 
```

请记住，您在那里使用扩展的方式将修改默认对象。如果你不想这样，请使用

```
$.extend({}, default, config) 
```

一个模仿 jQuery 功能的更健壮的解决方案如下：

```
function extend(){
    for(var i=1; i<arguments.length; i++)
        for(var key in arguments[i])
            if(arguments[i].hasOwnProperty(key))
                arguments[0][key] = arguments[i][key];
    return arguments[0];
} 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2018-02-06T00:24:30.000

[您可以在对象文字](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator)中使用 ECMA 2018扩展运算符...

```
var config = {key1: value1};
var default = {key1: default1, key2: default2, key 3: default 3};

var settings = {...default, ...config}

//resulting properties of settings:
settings = {key1: value1, key2: default2, key 3: default 3}; 
```

[BabelJS 对旧浏览器的支持](https://babeljs.io/docs/plugins/transform-object-rest-spread/)

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2016-08-28T04:47:23.980

您可以使用 Object.assign。

```
var defaults = {key1: "default1", key2: "default2", key3: "defaults3"};
var config = {key1: "value1"};

var settings = Object.assign({}, defaults, config); // values in config override values in defaults
console.log(settings); // Object {key1: "value1", key2: "default2", key3: "defaults3"} 
```

它将所有可枚举自身属性的值从一个或多个源对象复制到目标对象并返回目标对象。

```
Object.assign(target, ...sources) 
```

它适用于除 IE 之外的所有桌面浏览器（但包括 Edge）。它减轻了移动支持。

在这里亲自查看： [https ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)

## 关于深拷贝

但是，Object.assign 没有 jQuery 的 extend 方法所具有的 deep 选项。

注意：您通常可以使用 JSON 来获得类似的效果

```
var config = {key1: "value1"};
    var defaults = {key1: "default1", key2: "default2", keyDeep: {
        kd1: "default3",
        kd2: "default4"
    }};
    var settings = JSON.parse(JSON.stringify(Object.assign({}, defaults, config))); 
    console.log(settings.keyDeep); // Object {kd1: "default3", kd2: "default4"} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-11-20T14:22:23.950

这是我在尝试消除 jQuery 依赖项时提出的深拷贝方法略有不同。它主要是为小型设计的，因此它可能并不具备人们所期望的所有功能。应该完全兼容 ES5（由于使用了[Object.keys](https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Global_Objects/Object/keys)从 IE9 开始）：

```
function extend(obj1, obj2) {
    var keys = Object.keys(obj2);
    for (var i = 0; i < keys.length; i += 1) {
      var val = obj2[keys[i]];
      obj1[keys[i]] = ['string', 'number', 'array', 'boolean'].indexOf(typeof val) === -1 ? extend(obj1[keys[i]] || {}, val) : val;
    }
    return obj1;
  } 
```

你可能想知道第五行到底做了什么……如果 obj2.key 是一个对象字面量（即，如果它不是普通类型），我们递归地调用它的 extend 。如果 obj1 中不存在具有该名称的属性，我们首先将其初始化为一个空对象。否则，我们只需将 obj1.key 设置为 obj2.key。

以下是我的一些 mocha/chai 测试，它们应该可以证明这里的常见情况：

```
it('should extend a given flat object with another flat object', () => {
  const obj1 = {
    prop1: 'val1',
    prop2: 42,
    prop3: true,
    prop4: 20.16,
  };
  const obj2 = {
    prop4: 77.123,
    propNew1: 'newVal1',
    propNew2: 71,
  };
  assert.deepEqual(utils.extend(obj1, obj2), {
    prop1: 'val1',
    prop2: 42,
    prop3: true,
    prop4: 77.123,
    propNew1: 'newVal1',
    propNew2: 71,
  });
});

it('should deep-extend a given flat object with a nested object', () => {
  const obj1 = {
    prop1: 'val1',
    prop2: 'val2',
  };
  const obj2 = {
    propNew1: 'newVal1',
    propNew2: {
      propNewDeep1: 'newDeepVal1',
      propNewDeep2: 42,
      propNewDeep3: true,
      propNewDeep4: 20.16,
    },
  };
  assert.deepEqual(utils.extend(obj1, obj2), {
    prop1: 'val1',
    prop2: 'val2',
    propNew1: 'newVal1',
    propNew2: {
      propNewDeep1: 'newDeepVal1',
      propNewDeep2: 42,
      propNewDeep3: true,
      propNewDeep4: 20.16,
    },
  });
});

it('should deep-extend a given nested object with another nested object and deep-overwrite members', () => {
  const obj1 = {
    prop1: 'val1',
    prop2: {
      propDeep1: 'deepVal1',
      propDeep2: 42,
      propDeep3: true,
      propDeep4: {
        propDeeper1: 'deeperVal1',
        propDeeper2: 777,
        propDeeper3: 'I will survive',
      },
    },
    prop3: 'lone survivor',
  };
  const obj2 = {
    prop1: 'newVal1',
    prop2: {
      propDeep1: 'newDeepVal1',
      propDeep2: 84,
      propDeep3: false,
      propDeep4: {
        propDeeper1: 'newDeeperVal1',
        propDeeper2: 888,
      },
    },
  };
  assert.deepEqual(utils.extend(obj1, obj2), {
    prop1: 'newVal1',
    prop2: {
      propDeep1: 'newDeepVal1',
      propDeep2: 84,
      propDeep3: false,
      propDeep4: {
        propDeeper1: 'newDeeperVal1',
        propDeeper2: 888,
        propDeeper3: 'I will survive',
      },
    },
    prop3: 'lone survivor',
  });
}); 
```

我很高兴收到有关此实施的反馈或评论。提前致谢！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-25T21:07:26.093

`for`您可以使用语句遍历对象的属性。

```
var settings = extend(default, config);

function extend(a, b){
    var c = {};
    for(var p in a)
        c[p] = (b[p] == null) ? a[p] : b[p];
    return c;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-11-21T16:42:24.640

我更喜欢这段代码，它使用我的通用 forEachIn，并且不会破坏第一个对象：

```
function forEachIn(obj, fn) {
    var index = 0;
    for (var key in obj) {
        if (obj.hasOwnProperty(key)) {
            fn(obj[key], key, index++);
        }
    }
}

function extend() {
    var result = {};
    for (var i = 0; i < arguments.length; i++) {
        forEachIn(arguments[i],
            function(obj, key) {
                result[key] = obj;
            });
    }
    return result;
} 
```

如果你真的想将东西合并到第一个对象中，你可以这样做：

```
obj1 = extend(obj1, obj2); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-24T14:48:07.310

当我使用纯 JavaScript 进行开发时，它对我有很大帮助。

```
function extends(defaults, selfConfig){
     selfConfig = JSON.parse(JSON.stringify(defaults));
     for (var item in config) {
         if (config.hasOwnProperty(item)) {
             selfConfig[item] = config[item];
         }
     }
     return selfConfig;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-04-28T03:30:26.387

[Ivan Kuckir 的](https://stackoverflow.com/a/11197385/1064325)方法也可以用于创建新的对象原型：

```
Object.prototype.extend = function(b){
for(var key in b)
    if(b.hasOwnProperty(key))
        this[key] = b[key];
    return this;
}

var settings = default.extend(config); 
```

# iphone - 在 iOS 上运行一个无限循环的动画

> ID：11197248
> 
> 赞同：2
> 
> 时间：2012-06-25T20:56:25.750
> 
> 标签：iphone, objective-c, ios, cocoa-touch

我有一个简单的 UIView 使用`drawRect:`. 为了使视图动画，该`drawRect`方法需要每隔 0.05 秒调用一次，所以我使用了一个重复计时器：

```
timer = [NSTimer scheduledTimerWithTimeInterval:0.05 target:self 
        selector:@selector(setNeedsDisplay) userInfo:nil repeats:YES]; 
```

我不太了解运行循环、线程以及所有系统的东西，所以我想知道这是否是运行动画的正确方法？这个计时器无休止地重复自己。这是我应该担心的事情吗？这会阻塞主线程吗？我可以做些什么来尽量减少对性能的整体影响？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:09:18.053

这种方法还不错，但还有其他方法可以做到。

计时器的目标方法必须将计时器作为参数，因此不要直接将其设置为 setNeedsDisplay，而应设置如下方法：

```
- (void)animationTimerDidFire:(NSTimer *)timer
{
    [myView setNeedsDisplay];
} 
```

如果您的视图始终可见，那么您可以设置并忘记计时器。另一方面，如果它可能因为您切换到不同的视图而消失，您将需要根据需要使计时器无效并重新创建。

应用程序的主线程使用运行循环并调用各种方法来响应事件，例如用户点击、系统通知（例如内存警告）和 I/O 到达。如果运行循环调用的任何东西需要很长时间才能返回，它会阻止队列中的所有内容。当您设置一个计时器时，它会被添加到一个列表中，并且运行循环每次都会检查它；如果其中一个计时器准备就绪，它会调用您的方法。

最终的结果是计时器并不精确：它们可能不会像你喜欢的那样频繁地触发，可能会被延迟调用等等。同样，如果你的应用程序非常简单，主运行循环不会很忙，所以一个计时器可能会足够好。只要确保你的动画是基于调用之间的实际时间，而不是假设每个调用恰好相隔 0.05 秒。

### 备择方案

如果您的动画仅涉及翻转一些静态图像，则 UIImageView 对此提供了一些支持。

如果创建每一帧动画需要大量时间（并且您不想阻塞主线程），您可以使用后台队列来绘制图像（参见`CGBitmapContextCreate`和`CGBitmapContextCreateImage`），然后在新的时候向主线程发出信号图像已准备好显示。任何触及视图的事情都必须发生在主线程上，但您可以在背景上进行绘图。

您可能还想阅读`CALayer`QuartzCore 框架。这是 UIView 对象实际操作以在屏幕上绘制的内容。您可能会发现，您可以通过操作一些 CALayer 对象并让 Core Animation 完成繁重的工作（例如，您将颜色从红色更改为蓝色，Core Animation 负责从一到另一个）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:06:43.660

好吧，如果您使用重写或自定义方法，则应该使用递归和完成块来调用动画。我发现它比计时器好得多，因为计时器并不总是准确的，如果您将动画定时为循环，可能会导致一些动画问题。

编辑：我不太了解使用 drawRect: 并调用 [self setNeedsDisplay] 来更新它，所以在这方面我无法帮助你。对不起。

# macos - 在 osx 中显示系统文件/显示 git 忽略

> ID：11197249
> 
> 赞同：93
> 
> 时间：2012-06-25T20:56:26.747
> 
> 标签：macos, git

默认情况下，在 osx 中看不到 .gitignore 文件。显示这些文件的命令是什么？

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2012-06-25T20:59:37.327

打开终端并输入

*   在 OS X 10.8 上：

    ```
    defaults write com.apple.Finder AppleShowAllFiles TRUE 
    ```

*   在 OS X 10.9 上：

    ```
    defaults write com.apple.finder AppleShowAllFiles TRUE 
    ```

然后你必须重新启动 finder：

```
killall Finder 
```

OS X 中以“.”为前缀的任何文件名 被认为是“隐藏的”。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2017-07-10T18:29:51.993

`⌘⇧.`将切换`AppleShowAllFiles`设置。

此组合键将在所有应用程序中的打开/保存对话框中起作用，而不仅仅是查找器。使用它，您在使用别人的 Mac 或新 Mac 时永远不会感到困惑，并且您可以避免使用`defaults write`.

由于unix中隐藏的点文件，我使用“使用点显示点文件”的助记词来记住它。

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2018-12-19T15:48:34.140

您可以使用 Finder 中的快捷方式：

`Command`+ `Shift`+`.`

它将显示隐藏文件。要再次隐藏文件，请使用相同的快捷方式。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2012-06-25T21:00:21.730

如果您只想查看它们，您可以随时使用命令行：

`ls -al path/to/dir`

如果您想始终从查找器中查看**所有**文件，您可以执行以下操作：

`defaults write com.apple.Finder AppleShowAllFiles YES`

如果您只想从 finder 中查看 .gitignore，您可以：

`chflags nohidden /path/to/dir/.gitignore`

但是您必须在每个`.gitignore`非全局命令上调用该命令。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2015-03-23T20:10:19.397

（更新，对于 10.10.2:)

上面的命令对我不起作用。我正在使用 OSX Yosemite：10.10.2。这虽然有效：

```
defaults write com.apple.finder AppleShowAllFiles -boolean true;
killall Finder; 
```

来源： [http ://www.idownloadblog.com/2014/08/04/how-to-show-hidden-files-folders-finder-mac/](http://www.idownloadblog.com/2014/08/04/how-to-show-hidden-files-folders-finder-mac/)

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2017-12-12T23:56:32.300

您可以使用此命令在终端中编辑隐藏文件

```
open -a TextEdit .gitignore 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-03-06T12:08:25.480

如果您只想从控制台查看 .gitignore，只需在该目录中键入“nano .gitignore”。此命令“nano”只是在 nano 控制台环境中打开任何文本文件以进行查看或编辑

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-04-06T13:48:17.563

除了[接受的答案](https://stackoverflow.com/a/11197286/6813459)之外，您还可以创建一个别名来轻松显示/隐藏终端中的隐藏文件。这就是我设置它的方式（在 macOS Mojave 10.14.1 上测试/工作）。

在我的用户目录中，我创建了一个新文件`.custom_aliases`并将其写入：

```
# Show/hide files
alias showall='defaults write com.apple.finder AppleShowAllFiles -boolean true; killall Finder'
alias hideall='defaults write com.apple.finder AppleShowAllFiles -boolean false; killall Finder' 
```

接下来我打开`.bash-profile`（也应该在您的用户目录中，如果不只是在那里创建它）并将其添加到文件的顶部：

```
# Load custom aliases
source ~/.custom_aliases 
```

就是这样！现在，每当我需要查看隐藏文件时，我只需`showall`在终端中输入，然后`hideall`完成。您也可以直接在 中定义别名`.bash_profile`，但我还有一些其他的东西，所以我喜欢将所有别名放在一个单独的文件中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-09T10:50:53.727

**在 MacOs Mojave 10.14.4 上显示隐藏文件和文件夹**

> 在终端申请

```
defaults write com.apple.finder AppleShowAllFiles -boolean true;
killall Finder; 
```

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2013-02-13T20:02:28.550

您可能只是没有`.gitignore`文件。如果你没有，你可以像这样创建它：

```
>touch ~/.gitignore 
```

然后根据需要编辑它。Git 会自动检查这个文件，不需要任何额外的配置！

# php - PHP：MySQL查询返回数组

> ID：11197250
> 
> 赞同：1
> 
> 时间：2012-06-25T20:56:29.917
> 
> 标签：php, mysql, pdo

我想知道如何从 PDO 发出查询并返回数组？现在，我有

```
$DBH = new PDO("mysql:host={$host};dbname={$dbname}", $user, $pass); 
```

使用 foreach 循环，就像这样

```
$query = "SELECT DISTINCT City FROM Locations ORDER BY City";
foreach($DBH->query($query)as $row) {
    echo $row['City'];      
} 
```

我可以打印所有的城市。但是，我想将所有城市存储到一个数组中。我试着这样做

```
$array = $DBH->query($query); 
```

但这根本不起作用。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T20:59:30.850

您正在使用 PDO，因此您应该使用[`PDOStatement::fetchAll()`](http://us.php.net/manual/de/pdostatement.fetchall.php).

```
$stmt = $DBH->query($query);
$array = $stmt->fetchAll(PDO::FETCH_COLUMN); 
```

完成 - 你没有使用任何循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T20:58:33.987

```
$query = "SELECT DISTINCT City FROM Locations ORDER BY City";

foreach($DBH->query($query) as $row) {
    $array[] = $row['City'];      
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T20:58:17.203

可能尝试：

```
$array = array();

foreach($DBH->query($query) as $row){
    array_push($array, $row['City']);     
}

print_r($array); 
```

# vba - 宏提取数据块

> ID：11197252
> 
> 赞同：1
> 
> 时间：2012-06-25T20:56:40.183
> 
> 标签：vba, excel

我整天都在解决这个问题，但无法解决。

输入数据由多个具有相同行数和列数的数据块组成。每个数据块在块内的第一行都有它的名称。此外，它们还被空白行进一步分隔。

```
block1
name score value
 a     2     3
 b     3     5
 c     1     6

block2
name score value
 a     4     6
 b     7     8
 c     2     6

block3
name score value
 a     5     4
 b     7     8
 c     2     9 
```

期望的输出是提取每个块的名称和值列，然后在列中并行它们。像这样：

```
value  block1  block2 block3
 a       3     6      4
 b       5     8      8
 c       6     6      9 
```

谢谢你的帮助！

**更新** 感谢您的回答，托尼和其他人！我只是有另一个要求。某些表中的某些行可能丢失。换句话说，正如您之前提到的，行号可能会有所不同。是否可以用NA填写这些表格中的相应单元格？即新的输入是这样的：

```
block1
name score value
a     2     3
c     1     6

block2
name score value
a     4     6
b     7     8
c     2     6

block3
name score value
a     5     4
b     7     8 
```

现在想要的输出是这样的：

```
value  block1  block2 block3
a       3       6      4
b       NA      8      8
c       6       6      NA 
```

**7 月 3 日更新（如果问题太长不合适，我将移动这部分并使其成为一个新问题）**

```
 block1
name score value
 a     2     3
 b     3     5
 c     1     6

block2
name score value
 a     4     6
 b     7     8
 c     2     6

block3
name score value
 a     5     4
 b     7     8
 c     2     9 
```

如何同时提取值及其相应的分数并将它们放入一个单元格中？像这样：代码表明将值放入动态数组中。然后将 .range 分配给该数组。我的第一个想法是构造另一个数组来存储“分数”列的值。然后遍历两个数组中的每个元素，并将它们连接在一起。但是，似乎 VBA 确实允许我遍历数组，因为它的维度没有定义。我尝试了 REDIM，但它没有用。

```
value  block1   block2    block3
 a       3(2)     6(4)      4(5)
 b       5(3)     8(7)      8(7)
 c       6(1)     6(2)      9(2) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T23:42:59.817

**回答新问题**

如果您的最终说明是正确的，则此代码比您需要的要复杂。在您发布之前，我已经创建了一个例程，能够处理比您想象的更多的表格。由于您没有看到“真实”文件，因此我没有删除代码来处理完整的、可能的复杂性。

我创建了一个这样的测试工作表：

![示例测试数据](../Images/4aa4ab716c41bc89753d822e1aaa637c.png)

我建议你复制这个工作表，因为它包含了我能想到的每一个讨厌的问题。使用此工作表试用此代码。尝试了解代码在做什么以及为什么。然后，您应该为真正的桌子扔给您的​​任何事情做好准备。

有些代码很复杂，我必须定义一个用户定义的数据类型。我尝试用谷歌搜索“vba 用户定义的数据类型”，但对我找到的教程感到非常失望，所以我自己去试试。

假设我的宏需要保存一些人的姓名和年龄。我显然需要一些数组：

```
Dim NameFamily() As String
Dim NameGiven() As String
Dim Age() As Long

ReDim NameFamily(1 to 20)
ReDim NameGiven(1 to 3, 1 to 20)
ReDim Age(1 to 20)

NameFamily(5) = "Dallimore"
NameGiven(1, 5) = "Anthony"
NameGiven(2, 5) = "John"
NameGiven(3, 5) = ""
Age(5) = 65 
```

你很容易得到很多难以维护的代码；特别是随着每个人的变量数量增加。

另一种方法是使用大多数语言称为结构而 VBA 称为用户定义的数据类型：

```
Type Person
  NameFamily As String
  NameGiven() As String
  NumGivenNames as Long
  Age As Long
 End Type 
```

*Person*是一种新的数据类型，我可以使用这种类型声明变量：

```
Dim Boss As Person
Dim OtherStaff() As Person

ReDim OtherStaff(1 to 20)

OtherStaff(5).NameFamily = "Dallimore"
OtherStaff(5).NumGivenNames = 2
Redim OtherStaff(5).NameGiven(1 To OtherStaff(5).NumGivenNames) 
OtherStaff(5).NameGiven(1) = "Anthony"
OtherStaff(5).NameGiven(2) = "John"
OtherStaff(5).Age = 65 
```

这可能看起来并不容易。当您想添加有关人员的另一项信息时，好处变得更加明显；也许是孩子的数量。对于常规数组，您首先必须添加一个新数组。然后，您必须在代码中找到调整人员数组大小的每个点，并为新数组添加 ReDim 语句。如果您错过任何 ReDim，您会收到奇怪的错误。使用用户定义的数据类型，您在类型定义中添加一行：

```
Type Person
  NameFamily As String
  NameGiven() As String
  NumGivenNames as Long
  Age As Long
  NumChildren As Long 
 End Type 
```

现在，所有现有代码都针对这个新变量进行了全面更新。

以上是一个非常简短的介绍，但我相信它涵盖了我在代码中使用的用户定义数据类型的所有功能。

我希望我已经包含了足够多的注释，让您能够理解我的代码。慢慢地完成它，并在必要时提出问题。

*下面的代码是第三个版本，已经更新以解决早期版本的问题。*

*变量命名约定*

名称的格式为 AaaaBbbbCccc，其中每个名称部分都缩小了名称的范围。所以“Col”是column的缩写。任何用作列号的变量都以“Col”开头。“Dest”是目标的缩写，“Src”是“源”的缩写。因此，任何以“ColSrc”开头的变量都是源工作表的列号。

如果我有一个数组 AaaaBbbbCccc，那么该数组的任何索引都将以 InxAaaaBbbbCccc 开头，除非结果名称太长，在这种情况下 Aaaa、Bbbb 和 Cccc 被缩写或丢弃。所以“NameDtl()”的所有索引都以“InxName”开头，因为我认为“InxNameDtl”太长了。

“Crnt”是“Current”的缩写，通常表示 for 循环变量或从数组中提取的值，用于 for 循环的一次迭代。

```
Option Explicit
Type typNameDtl
  InxPredCrntMax As Long
  Name As String
  Output As Boolean
  Predecessor() As String
End Type

Sub ExtractValue3()

  Dim ColDestCrnt As Long          ' Current column of destination worksheet
  Dim ColSrcCrnt As Long           ' Current column of source worksheet
  Dim ColSrcSheetLast As Long      ' Last column of worksheet
  Dim InxNISCrnt As Long           ' Current index into NameInSeq array
  Dim InxNISCrntMax As Long        ' Index of last used entry in NameInSeq array
  Dim InxNISFirstThisPass As Long  ' Index of first entry in NameInSeq array
                                   ' used this pass
  Dim InxNameCrnt As Long          ' Current index into NameDtl array
  Dim InxNameCrntMax As Long       ' Index of last used entry in NameDtl array
  Dim InxPredCrnt As Long          ' Current index into NameDtl(N).Predecessor
                                   ' array
  Dim InxPredCrntMaxCrnt As Long   ' Temporary copy of
                                   ' NameDtl(N).InxPredecessorCrntMax
  Dim InxTableCrnt As Long         ' Current index into RowSrcTableTitle and
                                   ' RowSrcTableEnd arrays
  Dim InxTableCrntMax As Long      ' Last used entry in RowSrcTableTitle and
                                   ' RowSrcTableEnd arrays
  Dim Found As Boolean             ' Set to True if a loop finds what is
                                   ' being sought
  Dim NameCrnt As String           ' Current index into NameDtl array
  Dim NameInSeq() As String        ' Array of names in output sequence
  Dim NameLenMax As Long           ' Maximum length of a name.  Only used to
                                   ' align columns in diagnostic output.
  Dim NameDtl() As typNameDtl      ' Array of names found and their predecessors
  Dim PredNameCrnt As String       ' Current predecessor name.  Used when
                                   ' searching NameDtl(N).Predecessor
  Dim RowDestCrnt As Long          ' Current row of destination worksheet
  Dim RowSrcCrnt1 As Long          ' \ Indices into source worksheet allowing
  Dim RowSrcCrnt2 As Long          ' / nested searches
  Dim RowSrcTableEnd() As Long     ' Array holding last row of each table within
                                   ' source worksheet
  Dim RowSrcTableEndCrnt As Long   ' The last row of the current table
  Dim RowSrcSheetLast As Long      ' Last row of source worksheet
  Dim RowSrcTableTitle() As Long   ' Array holding title row of each table within
                                   ' source worksheet
  Dim RowSrcTableTitleCrnt As Long ' Title row of current table
  Dim SheetValue() As Variant      ' Copy of source worksheet.

  ' Column A of source worksheet used to test this code:

  '    Start
  '    row     Values in starting and following rows
  '      2      block1  name  c  d  e  f
  '      9      block2  name  b  c  d  e
  '     16      block3  name  a  c  d
  '     22      block4  name  a  d  e
  '     29      block5  name  a  d  f
  '     36      block6  name  d  e  f

  ' Note that a and b never appear together in a table; it is impossible
  ' to deduce their preferred sequence from this data.

  ' Stage 1: Load entire source worksheet into array.
  ' =================================================
  With Worksheets("Jia Source")
    ' Detrmine dimensions of worksheet
    RowSrcSheetLast = .Cells.Find("*", .Range("A1"), xlFormulas, , _
                                                       xlByRows, xlPrevious).Row
    ColSrcSheetLast = .Cells.Find("*", .Range("A1"), xlFormulas, , _
                                                 xlByColumns, xlPrevious).Column
    SheetValue = .Range(.Cells(1, 1), _
                        .Cells(RowSrcSheetLast, ColSrcSheetLast)).Value
    ' SheetValue is a one-based array with rows as the first dimension and
    ' columns as the second.  An array loaded from a worksheet is always one-based
    ' even if the range does not start at Cells(1,1).  Because this range starts
    ' at Cells(1,1), indices into SheetValue match row and column numbers within
    ' the worksheet.  This match is convenient for diagnostic output but is not
    ' used by the macro which does not reference the worksheet, RowSrcSheetLast or
    ' ColSrcSheet again.
  End With

  ' Stage 2: Locate each table and store number of
  ' title row and last data row in arrays.
  ' ==============================================

  ' 100 entries may be enough.  The arrays are enlarged if necessary.
  ReDim RowSrcTableEnd(1 To 100)
  ReDim RowSrcTableTitle(1 To 100)
  InxTableCrntMax = 0           ' Arrays currently empty

  RowSrcCrnt1 = 1

  ' Loop identifying dimensions of tables
  Do While RowSrcCrnt1 <= RowSrcSheetLast

    ' Search down for the first row of a table
    Found = False
    Do While RowSrcCrnt1 <= RowSrcSheetLast
      If SheetValue(RowSrcCrnt1, 1) <> "" Then
        RowSrcTableTitleCrnt = RowSrcCrnt1
        Found = True
        Exit Do
      End If
      RowSrcCrnt1 = RowSrcCrnt1 + 1
    Loop
    If Not Found Then
      ' All tables located
      Exit Do
    End If

    ' Search down for the last row of a table
    Found = False
    Do While RowSrcCrnt1 <= RowSrcSheetLast
      If SheetValue(RowSrcCrnt1, 1) = "" Then
        RowSrcTableEndCrnt = RowSrcCrnt1 - 1
        Found = True
        Exit Do
      End If
      RowSrcCrnt1 = RowSrcCrnt1 + 1
    Loop
    If Not Found Then
      ' Last table extends down to bottom of worksheet
        RowSrcTableEndCrnt = RowSrcSheetLast
    End If

    ' Store details of this table.
    InxTableCrntMax = InxTableCrntMax + 1

    ' Enlarge arrays if they are full
    If InxTableCrntMax > UBound(RowSrcTableTitle) Then
      ' Redim Preserve requires the interpreter find a block of memory
      ' of the new size, copy values across from the old array and
      ' release the old array for garbage collection.  I always allocate
      ' extra memory in large chunks and use an index like
      ' InxTableCrntMax to record how much of the array has been used.
      ReDim Preserve RowSrcTableTitle(UBound(RowSrcTableTitle) + 100)
      ReDim Preserve RowSrcTableEnd(UBound(RowSrcTableTitle) + 100)
    End If

    RowSrcTableTitle(InxTableCrntMax) = RowSrcTableTitleCrnt
    RowSrcTableEnd(InxTableCrntMax) = RowSrcTableEndCrnt

  Loop

  ' Output the arrays to the Immediate window to demonstrate they are correct.
  ' For my test data, the output is:
  '   Elements:  1  2  3  4  5  6
  '      Title:  2  9 16 22 29 36
  '  Last data:  7 14 20 26 33 40

  Debug.Print "Location of each table"
  Debug.Print " Elements:";
  For InxTableCrnt = 1 To InxTableCrntMax
    Debug.Print Right("   " & InxTableCrnt, 3);
  Next
  Debug.Print
  Debug.Print "    Title:";
  For InxTableCrnt = 1 To InxTableCrntMax
    Debug.Print Right("   " & RowSrcTableTitle(InxTableCrnt), 3);
  Next
  Debug.Print
  Debug.Print "Last data:";
  For InxTableCrnt = 1 To InxTableCrntMax
    Debug.Print Right("   " & RowSrcTableEnd(InxTableCrnt), 3);
  Next
  Debug.Print

  ' Stage 3\.  Build arrays listing predecessors of each name
  ' ========================================================

  ' The names within the tables are all in the same sequence but no table
  ' contains more than a few names so that sequence is not obvious. This
  ' stage accumulates data from the tables so that Stage 4 can deduce the full
  ' sequence.  More correctly, Stage 4 deduces a sequence that does not
  ' contradict the tables because the sequence of a and b and the sequence
  ' of f and g is not defined by these tables.

  ' For Stage 4, I need a list of every name used in the tables and, for each
  ' name, a list of its predecessors.  Consider first the list of names.

  ' NameDtl is initialised to NameDtl(1 to 50) and InxNameCrntMax is initialised
  ' to 0 to record the array is empty.  In table 1, the code below finds c, d,
  ' e and f.  NameDtl and InxNameCrntMax are updated as these names are found:
  '
  '    Initial state: InxNameCrntMax = 0   NameDtl empty
  '    Name c found : InxNameCrntMax = 1   NameDtl(1).Name = "c"
  '    Name d found : InxNameCrntMax = 2   NameDtl(2).Name = "d"
  '    Name e found : InxNameCrntMax = 3   NameDtl(3).Name = "e"
  '    Name f found : InxNameCrntMax = 4   NameDtl(4).Name = "f"

  ' In table 2, the code finds; b, c, d  and e.  b is new but c, d and e are
  ' already recorded and they must not be added again.  For each name found,
  ' the code checks entries 1 to InxNameCrntMax.  Only if the new name is not
  ' found, is it added.

  ' For each name, Stage 4 needs to know its predecessors.  From table 1 it
  ' records that:
  '    d is preceeded by c
  '    e is preceeded by c and d
  '    f is preceeded by c, d and e

  ' The same technique is used for build the list of predecessors.  The
  ' differences are:
  '   1) Names are accumulated in NameDtl().Name while the predecessors of
  '      the fifth name are accumulated in NameDtl(5).Predecessor.
  '   2) InxNameCrntMax is replaced, for the fifth name, by
  '      NameDtl(5).InxPredCrntMax.

  ' Start with space for 50 names.  Enlarge if necessary.
  ReDim NameDtl(1 To 50)
  InxNameCrntMax = 0       ' Array is empty

  ' For each table
  For InxTableCrnt = 1 To InxTableCrntMax

    RowSrcTableTitleCrnt = RowSrcTableTitle(InxTableCrnt)
    RowSrcTableEndCrnt = RowSrcTableEnd(InxTableCrnt)

    ' For each data row in the current table
    For RowSrcCrnt1 = RowSrcTableTitleCrnt + 2 To RowSrcTableEndCrnt

      ' Look in NameDtl for name from current data row
      NameCrnt = SheetValue(RowSrcCrnt1, 1)
      Found = False
      For InxNameCrnt = 1 To InxNameCrntMax
        ' Not this comparison is case sensitive "John" and "john" would not
        ' match.  Use LCase if case insensitive comparison required.
        If NameCrnt = NameDtl(InxNameCrnt).Name Then
          Found = True
          Exit For
        End If
      Next
      If Not Found Then
        ' This is a new name.  Create entry in NameDtl for it.
        InxNameCrntMax = InxNameCrntMax + 1
        If InxNameCrntMax > UBound(NameDtl) Then
          ReDim Preserve NameDtl(UBound(NameDtl) + 50)
        End If
        InxNameCrnt = InxNameCrntMax
        NameDtl(InxNameCrnt).Output = False
        NameDtl(InxNameCrnt).Name = NameCrnt
        ' Allow for up to 20 predecessors
        ReDim NameDtl(InxNameCrnt).Predecessor(1 To 20)
        NameDtl(InxNameCrnt).InxPredCrntMax = 0
      End If
      ' Check that each predecessor for the current name within the
      ' current table is recorded against the current name
      For RowSrcCrnt2 = RowSrcTableTitleCrnt + 2 To RowSrcCrnt1 - 1
        Found = False
        PredNameCrnt = SheetValue(RowSrcCrnt2, 1)
        ' Move current number of predecessors from array to variable
        ' to make code more compact and easier to read
        InxPredCrntMaxCrnt = NameDtl(InxNameCrnt).InxPredCrntMax
        For InxPredCrnt = 1 To InxPredCrntMaxCrnt
          If PredNameCrnt = _
                  NameDtl(InxNameCrnt).Predecessor(InxPredCrnt) Then
            Found = True
            Exit For
          End If
        Next
        If Not Found Then
          ' This predecessor has not been recorded against the current name
          InxPredCrntMaxCrnt = InxPredCrntMaxCrnt + 1
          If InxPredCrntMaxCrnt > _
                         UBound(NameDtl(InxNameCrnt).Predecessor) Then
            ReDim Preserve NameDtl(UBound(NameDtl) + 20)
          End If
          NameDtl(InxNameCrnt).Predecessor(InxPredCrntMaxCrnt) = PredNameCrnt
          ' Place new value for number of predecessors in its permenent store.
          NameDtl(InxNameCrnt).InxPredCrntMax = InxPredCrntMaxCrnt
        End If
      Next
    Next
  Next

  ' Output NameDtl to the Immediate window to demonstrate it is correct.

  ' Find length of longest name so columns can be justified
  NameLenMax = 4         ' Minimum length is that of title
 For InxNameCrnt = 1 To InxNameCrntMax
    If Len(NameDtl(InxNameCrnt).Name) > NameLenMax Then
      NameLenMax = Len(NameDtl(InxNameCrnt).Name)
    End If
  Next
  ' Output headings
  Debug.Print vbLf & "Contents of NameDtl table"
  Debug.Print Space(NameLenMax + 10) & "Max"
  Debug.Print Left("Name" & Space(NameLenMax), NameLenMax + 2) & _
              "Output  inx  Predecessors"
  ' Output table contents
  For InxNameCrnt = 1 To InxNameCrntMax
    Debug.Print Left(NameDtl(InxNameCrnt).Name & Space(NameLenMax), _
                   NameLenMax + 4) & _
                   IIf(NameDtl(InxNameCrnt).Output, " True ", " False") & _
                   "  " & Right("   " & _
                   NameDtl(InxNameCrnt).InxPredCrntMax, 3) & " ";
    For InxPredCrnt = 1 To NameDtl(InxNameCrnt).InxPredCrntMax
      Debug.Print "  " & _
                     NameDtl(InxNameCrnt).Predecessor(InxPredCrnt);
    Next
    Debug.Print
  Next

  ' Stage 4: Sequence names for list.
  ' =================================

  ' The output from the above routine for the test data is:

  '                Max
  '  Name  Output  inx  Predecessors
  '  c     False    2   b  a
  '  d     False    3   c  b  a
  '  e     False    4   c  d  b  a
  '  g     False    3   c  d  e
  '  b     False    0
  '  a     False    0
  '  f     False    3   a  d  e

  ' Note 1: All this information is in the sequence found.
  ' Note 2: We do not know the "true" sequence of b and a or of g and f.

  ' The loop below has three steps:
  '   1) Transfer any names to NamesInSeq() that have not already been
  '      transferred and have a value of 0 for Max inx.
  '   2) If no names are transferred, the loop has completed its task.
  '   3) Remove any names transferred during this pass from the predecessor
  '      lists and mark the name as output.

  ' Before the loop NameInSeq() is empty, InxNISCrntMax = 0 and
  ' InxNISFirstThisPass = InxNISCrntMax+1 = 1.

  ' After step 1 of pass 1:
  '     NameInSeq(1) = "b" and NameInSeq(2) = "a"
  '     InxNISCrntMax = 2
  ' Entries InxNISFirstThisPass (1) to InxNISCrntMax (2) of NamesInSeq have
  ' been transferred during this pass so names a and b are removed from the
  ' lists by copying the last entry in each list over the name to be removed
  ' and reducing Max inx.  For pass 1, only the list for f is changed.

  ' At the end of pass 1, NameDtl is:

  '                Max
  '  Name  Output  inx  Predecessors
  '  c     False    0
  '  d     False    1   c
  '  e     False    2   c  d
  '  g     False    3   c  d  e
  '  b      True    0
  '  a      True    0
  '  f     False    2   e  d

  ' During pass 2, c is moved to NamesInSeq and removed form the lists to give:

  '                Max
  '  Name  Output  inx  Predecessors
  '  c      True    0
  '  d     False    0
  '  e     False    1   d
  '  g     False    2   e  d
  '  b      True    0
  '  a      True    0
  '  f     False    2   e  d

  ' This process continues until all names have been transferred.

  ' Size array for total number of names.
  ReDim NameInSeq(1 To InxNameCrntMax)
  InxNISCrntMax = 0       ' Array empty

  ' Loop until every name has been moved
  ' from ProdecessorDtl to NameInSeq.
  Do While True
    Found = False   ' No name found to move during this pass
    '  Record index of first name, if any, to be added during this pass
    InxNISFirstThisPass = InxNISCrntMax + 1

    ' Transfer names without predecessors to NameInSeq()
    For InxNameCrnt = 1 To InxNameCrntMax
      If Not NameDtl(InxNameCrnt).Output Then
        ' This name has not been output
        If NameDtl(InxNameCrnt).InxPredCrntMax = 0 Then
          ' This name has no predecessors or no predecessors that
          ' have not already been transferred to NameInSeq()
          InxNISCrntMax = InxNISCrntMax + 1
          NameInSeq(InxNISCrntMax) = NameDtl(InxNameCrnt).Name
          NameDtl(InxNameCrnt).Output = True
          Found = True
        End If
      End If
    Next

    If Not Found Then
      ' All names already transferred to NameInSeq
      Exit Do
    End If

    ' Remove references to names transferred to NameinSeq()
    ' during this pass
    For InxNISCrnt = InxNISFirstThisPass To InxNISCrntMax
      NameCrnt = NameInSeq(InxNISCrnt)
      For InxNameCrnt = 1 To InxNameCrntMax
        If Not NameDtl(InxNameCrnt).Output Then
          ' This name has not been output
          For InxPredCrnt = 1 To NameDtl(InxNameCrnt).InxPredCrntMax
            If NameCrnt = _
               NameDtl(InxNameCrnt).Predecessor(InxPredCrnt) Then
              ' Remove this name by overwriting it
              ' with the last name in the list
              NameDtl(InxNameCrnt).Predecessor(InxPredCrnt) = _
                      NameDtl(InxNameCrnt).Predecessor _
                               (NameDtl(InxNameCrnt).InxPredCrntMax)
              NameDtl(InxNameCrnt).InxPredCrntMax = _
                             NameDtl(InxNameCrnt).InxPredCrntMax - 1
              Exit For
            End If
          Next
        End If
      Next
    Next
  Loop

  Debug.Print vbLf & "Name list"
  For InxNISCrnt = 1 To InxNISCrntMax
    Debug.Print NameInSeq(InxNISCrnt)
  Next

  ' Stage 5: Transfer data
  ' ======================

  ' We now have everything we need for the transfer:
  '  * NameInSeq() contains the names in the output sequence
  '  * SheetValue() contains all the data from the source worksheet
  '  * RowSrcTableTitle() and RowSrcTableEnd() identify the
  '    start and end row of each table

  With Worksheets("Jia Destination")

    .Cells.EntireRow.Delete         ' Clear destination sheet

    ColDestCrnt = 1
    .Cells(1, ColDestCrnt).Value = "Name"
    ' Output names
    RowDestCrnt = 2
    For InxNISCrnt = 1 To InxNISCrntMax
      .Cells(RowDestCrnt, ColDestCrnt).Value = NameInSeq(InxNISCrnt)
      RowDestCrnt = RowDestCrnt + 1
    Next

    ' Output values from each table
    For InxTableCrnt = 1 To InxTableCrntMax

      RowSrcTableTitleCrnt = RowSrcTableTitle(InxTableCrnt)
      RowSrcTableEndCrnt = RowSrcTableEnd(InxTableCrnt)

      ' Find value column, if any
      Found = False
      ColSrcCrnt = 2
      Do While SheetValue(RowSrcTableTitleCrnt + 1, ColSrcCrnt) <> ""
        If LCase(SheetValue(RowSrcTableTitleCrnt + 1, ColSrcCrnt)) = _
                                                                    "value" Then
          Found = True
          Exit Do
        End If
        ColSrcCrnt = ColSrcCrnt + 1
      Loop

      If Found Then
        ' Value column found for this table

        ColDestCrnt = ColDestCrnt + 1

        ' Transfer table name
        .Cells(1, ColDestCrnt).Value = SheetValue(RowSrcTableTitleCrnt, 1)

        ' Transfer values
        RowDestCrnt = 2
        RowSrcCrnt1 = RowSrcTableTitleCrnt + 2
        For InxNISCrnt = 1 To InxNISCrntMax
          If NameInSeq(InxNISCrnt) = SheetValue(RowSrcCrnt1, 1) Then
            ' Value for this name in this table
            .Cells(RowDestCrnt, ColDestCrnt).Value = _
                                             SheetValue(RowSrcCrnt1, ColSrcCrnt)
            ' Value transferred from this row.  Step to next if any
            RowSrcCrnt1 = RowSrcCrnt1 + 1
            If RowSrcCrnt1 > RowSrcTableEndCrnt Then
              ' No more rows in this table
              Exit For
            End If
          End If
          RowDestCrnt = RowDestCrnt + 1
        Next
      Else
        Call MsgBox("Table starting at row " & RowSrcTableTitleCrnt & _
                    " does not have a value column", vbOKOnly)
      End If
    Next

  End With

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T12:25:56.140

**第一个答案 - 问题介绍和澄清请求**

这不是一个解决方案——您没有为解决方案提供足够的信息——而是介绍了问题和可能的技术。警告：我已经在记事本中输入了这个；不保证没有语法错误。

你说每张桌子的大小都是一样的，尽管我假设不是 3x3。但是如果它们是 3x3，我可以说表 1 从第 1 行开始，表 2 从第 7 行开始，表 N 从 6(N-1)+1 开始吗？也就是能不能计算出每张桌子的位置还是需要搜索？

如果您需要搜索，以下内容可能会有所帮助：

```
Dim ColSrcLast as Long
Dim RowSrcCrnt As Long

RowSrcCrnt = 1      ' Assumed start of Table 1

With Worksheets("xxxx")
  ColSrcLast = .Cells(RowCrnt,Columns.Count).End(xlToLeft).Column
End With 
```

`ColSrcLast = .Cells(RowCrnt,Columns.Count).End(xlToLeft).Column`相当于将光标放在行 RowCrnt+1 的最后一列然后单击 Control+Left 的 VBA。这可能是查找表 1 中最后使用的列的最简单方法。

Control+ArrowKey 将光标沿指示的方向移动并且：

*   如果当前单元格为空白，则在第一个非空白单元格处停止，
*   如果当前单元格是非空白单元格，下一个也是，则在空白单元格之前的最后一个非空白单元格处停止，
*   如果当前单元格非空白但下一个单元格为空白，则在下一个非空白单元格处停止，
*   如果没有单元格符合上述条件，则在范围末尾停止。

实验一下，上面的内容就会更清楚了。

如果表之间的空白行数可能会有所不同，我认为以下将是定位每个表的最简单方法：

```
Dim Found As Boolean
Dim RowSrcCrnt As Long
Dim RowSrcLast As Long
Dim RowSrcTableTitle As Long
Dim RowSrcTableLast As Long

With Worksheets("xxxx")
  ' Find last used row of worksheet
  RowSrcLast = .Cells(Rows.Count,"A").End(xlUp).Row
End With

RowSrcCrnt = 1

Do While RowSrcCrnt <= RowSrcLast
  With Worksheets("xxxx")
    Found = False
    Do While RowSrcCrnt <= RowSrcLast
      If .Cells(RowSrcCrnt,"A").Value = "" then
        ' Have found start of next (first) table
        RowSrcTableTitle = RowSrcCrnt
        Found = True
        Exit Do
      End If 
      RowSrcCrnt = RowSrcCrnt+1
    Loop
    If Not Found Then
      ' No more tables
      Exit Do
    End If
    RowSrcTableLast = .Cells(RowSrcTableTitle,"A").End(xlDown).Row
  End With

  ' Process table RowSrcTableTitle to RowSrcTableLast

  RowSrcCrnt = RowSrcTableLast+1
Loop 
```

在上述循环中，我们有：将表 RowSrcTableTitle 处理到 RowSrcTableLast。

名称列是否始终为“A”列？值列总是最后一列吗？如果没有，您将不得不在标题行中搜索列名。

每个表的顺序是否相同？如果没有，您将不得不对它们进行排序。每个表都包含每一行吗？如果没有，您用于组合表格的代码将必须允许这样做。

我希望以上内容可以帮助您入门。如果您有具体问题，请回来。

**第二个答案 - 对澄清的回应**

我创建了一个测试工作表*Jia Source*，如下所示：

![示例源工作表](../Images/9e81bc09193bcb21a864c78fa58a05a2.png)

你说桌子都是一样大的。在这种情况下，以下代码将每个表格的维度输出到即时窗口。这段代码的输出是：

```
Table A1:C6
Table A8:C13
Table A15:C20 
```

对于您的表格，您需要更改常量 TableHeight 和 TableWidth 的值。您还必须将“Jia Source”更改为源工作表的名称。

```
Option Explicit
Sub ExtractValue()

  Dim ColSrcLeft As Long
  Dim ColSrcRight As Long
  Dim RowSrcTitle As Long   ' First row or table
  Dim RowSrcHeader As Long  ' Header row of table
  Dim RowSrcEnd As Long     ' Last row of table

  Const TableHeight As Long = 4
  Const TableWidth As Long = 3

  RowSrcTitle = 1
  Do While True
    With Worksheets("Jia Source")
      If .Cells(RowSrcTitle, "A").Value = "" Then
        Exit Do
      End If
      RowSrcHeader = RowSrcTitle + 1
      RowSrcEnd = RowSrcHeader + TableHeight
      ColSrcLeft = 1
      ColSrcRight = ColSrcLeft + TableWidth - 1
      Debug.Print "Table " & colNumToCode(ColSrcLeft) & RowSrcTitle & ":" & _
                  colNumToCode(ColSrcRight) & RowSrcEnd
    End With

    ' Code to handle table goes here.

    RowSrcTitle = RowSrcEnd + 2

  Loop

End Sub
Function colNumToCode(ByVal colNum As Integer) As String

  ' Convert Excel column number to column identifier or code
  ' Last updated 3 Feb 12\.  Adapted to handle three character codes.

  Dim code As String
  Dim partNum As Integer

  If colNum = 0 Then
    colNumToCode = "0"
  Else
    code = ""
    Do While colNum > 0
      partNum = (colNum - 1) Mod 26
      code = Chr(65 + partNum) & code
      colNum = (colNum - partNum - 1) \ 26
    Loop
    colNumToCode = code
  End If

End Function 
```

我留下了显示如何搜索大小不同的表格的代码。如果上面的代码没有为您的工作表产生正确的结果，您可能需要合并这两个例程。

以下假设 RowSrcTitle、RowSrcHeader、RowSrcLast、ColSrcLeft 和 ColSrcRight 是正确的。它是来自 ExtractValue() 的代码加上将数据复制到我命名为“Jia Destination”的目标表的代码。它的输出是：

![示例目标工作表](../Images/25a099d540c777ef816aeb0a782718ec.png)

玩一玩。如有必要，请回来提出问题。

```
Sub ExtractValue2()

  Dim ColDestCrnt As Long
  Dim ColSrcCrnt As Long
  Dim ColSrcLeft As Long
  Dim ColSrcRight As Long
  Dim Found As Boolean
  Dim RowDestBottom As Long
  Dim RowDestTop As Long
  Dim RowSrcTitle As Long   ' First row or table
  Dim RowSrcHeader As Long  ' Header row of table
  Dim RowSrcEnd As Long     ' Last row of table
  Dim TableTitle As String
  Dim CellArray() As Variant

  Const TableHeight As Long = 4
  Const TableWidth As Long = 3

  RowSrcTitle = 1
  ColDestCrnt = 1
  RowDestTop = 1
  RowDestBottom = RowDestTop + TableHeight

  Do While True
    With Worksheets("Jia Source")
      If .Cells(RowSrcTitle, "A").Value = "" Then
        Exit Do
      End If
      RowSrcHeader = RowSrcTitle + 1
      RowSrcEnd = RowSrcHeader + TableHeight
      ColSrcLeft = 1
      ColSrcRight = ColSrcLeft + TableWidth - 1

    End With

    If ColDestCrnt = 1 Then
      ' Column 1, the list of names, has not been output.
      ' This assumes all tables have the same rows in the same
      ' sequence

      With Worksheets("Jia Source")
        ' This statement loads all the values in a range to an array in a
        ' single statements.  Ask if you want more detail on what I am doing.
        ' Load name column for this table
        CellArray = .Range(.Cells(RowSrcHeader, ColSrcLeft), _
                           .Cells(RowSrcEnd, ColSrcLeft)).Value
      End With
      With Worksheets("Jia Destination")
        ' Clear destination sheet
        .Cells.EntireRow.Delete
        ' Write array containing name column to destination sheet
        .Range(.Cells(RowDestTop, 1), _
                 .Cells(RowDestBottom, 1)).Value = CellArray
      End With
      ColDestCrnt = ColDestCrnt + 1
    End If

    With Worksheets("Jia Source")
      ' Find Value column.
      Found = False
      For ColSrcCrnt = ColSrcLeft + 1 To ColSrcRight
        If LCase(.Cells(RowSrcHeader, ColSrcCrnt).Value) = "value" Then
          Found = True
          Exit For
        End If
      Next
    End With
    ' If Found is False, the table has no value column and is ignored
    If Found Then
      With Worksheets("Jia Source")
        ' Extract title of title
        TableTitle = .Cells(RowSrcTitle, ColSrcLeft).Value
        ' Load name column (excluding header) for this table
          CellArray = .Range(.Cells(RowSrcHeader + 1, ColSrcCrnt), _
                             .Cells(RowSrcEnd, ColSrcCrnt)).Value
      End With
      With Worksheets("Jia Destination")
        ' Copy title
        .Cells(1, ColDestCrnt).Value = TableTitle
        ' Write array containing name column to destination sheet
        .Range(.Cells(RowDestTop + 1, ColDestCrnt), _
               .Cells(RowDestBottom, ColDestCrnt)).Value = CellArray
      End With
      ColDestCrnt = ColDestCrnt + 1
    End If

    RowSrcTitle = RowSrcEnd + 2

  Loop

End Sub 
```

# php - 运行长 PDO 插入语句的更快方法？

> ID：11197254
> 
> 赞同：1
> 
> 时间：2012-06-25T20:56:46.483
> 
> 标签：php, mysql, html, pdo

所以我开始将我所有的 mysql/php 工作数据库查询等切换到 PDO。我想知道是否可以以某种方式缩短以下方法。这个特殊的例子是使用一个大的注册表单并将结果插入到数据库中。我觉得这比必要的代码多得多……有没有更短的方法可以将它插入数据库？

```
$query = $affiliates->prepare('INSERT INTO affiliates (afid, afTitle, afbio, afLink, afEmail, afAddress, afCity, afState, afZip, afphone, affacebook, aflinkedin, aftwitter, afPassword, afLon, afType, aftime, afApproved) VALUES (?, ?, ? , ? , ?, ? ,? ,? ,? ,? ,? ,? ,? ,? ,? ,? ,?, ?)');
echo "prepare successfull";

$query-> execute(array('',$afTitle, $afBio, $afLink, $afEmail, $afAddress, $afCity, $afState, $afZip, $afPhone, $afFacebook, $afLinkedIn, $afTwitter, $afPassword, '', $afType, $date, $afApproved))or die(print_r($affiliates->errorInfo(), true));
echo "Insert worked!"; 
```

正如我所说，我为任何糟糕的结构道歉，边学习边学习。这也能防止sql注入吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T23:06:21.247

一种选择可能是将这些列名和值放入数组中。然后，您可以只使用数组，而不是多次列出所有变量/列。例如，您可以将代码更改为如下所示：

```
$inserting = array();
foreach(array('afTitle','afbio','afLink','afEmail','afAddress','afCity','afState','afZip','afphone','affacebook','aflinkedin','aftwitter','afPassword','afType','aftime','afApproved') as $i) $inserting[$i] = ${$i};

$sth = $dbh->prepare('INSERT INTO affiliates ('.implode(',', array_keys($inserting)).') VALUES ('.str_pad('', count($inserting)*2-1, '?,').')');
$sth->execute(array_values($inserting)) or die(print_r($sth->errorInfo(), true)); 
```

如果您喜欢这种方法，您可能会考虑以不同的方式填充数组，并可能放弃创建如此多的单个变量。

# entity-framework - Microsoft Jet DB 是否与实体框架一起使用？

> ID：11197259
> 
> 赞同：13
> 
> 时间：2012-06-25T20:57:41.287
> 
> 标签：entity-framework, ms-access, jet, jet-ef-provider

[在此](http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/9bc427da-ccd2-4683-a5e1-7ecbb68e312a)论坛中，有人提到实体框架不适用于 Access (Jet DB - .mdb)。但是，似乎有一个 Jet DB 提供程序，如此处[所述](http://www.connectionstrings.com/access)

这让我觉得我唯一需要的 Entity Framework 就是在定义模型之前定义以下内容：

```
<connectionStrings>  
    <add name="ProductContext"
         providerName="Microsoft.Jet.OLEDB.4.0"
         connectionString="Source=C:\mydatabase.mdb;Jet OLEDB:Database
                           Password=MyDbPassword;"/>
</connectionStrings> 
```

有谁知道 Entity Framework 是否适用于 Jet DB，我想在开始之前确保它可以正常工作，因为我的设计文档取决于这个事实。

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-25T21:08:04.467

实体框架不支持 OLEDB 连接，因此您的连接字符串将不起作用。让 Entity Framework 与 MS Access 协作几乎是不可能的。您将需要转储设计的 MS Access 部分或实体框架部分。

使用 MS Access 最接近的是使用强类型数据集和 Linq-to-DataSet [http://msdn.microsoft.com/en-us/library/bb386977.aspx](http://msdn.microsoft.com/en-us/library/bb386977.aspx)

或者，考虑改用 SQL Express（它是免费的）[http://www.microsoft.com/sqlserver/en/us/editions/2012-editions/express.aspx](http://www.microsoft.com/sqlserver/en/us/editions/2012-editions/express.aspx)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-12-01T16:04:43.447

这里有一个 MS Access EF 6.1 提供程序
[https://jetentityframeworkprovider.codeplex.com/](https://jetentityframeworkprovider.codeplex.com/)

**编辑**
现在 Access 的 EF 提供程序托管在 GitHub
[https://github.com/bubibubi/JetEntityFrameworkProvider](https://github.com/bubibubi/JetEntityFrameworkProvider)

# ruby - Ruby - 从浅到深获取目录中的所有文件

> ID：11197260
> 
> 赞同：0
> 
> 时间：2012-06-25T20:57:47.287
> 
> 标签：ruby

通过`Dir`我可以获取目录中的所有文件的魔力：

```
Dir['lib/**/*.rb']
=> ["lib/a.rb", "lib/foo/bar/c.rb", "lib/foo/b.rb"] 
```

但我想从浅到深迭代它们。即`a.rb`-> `b.rb`-> `c.rb`。

有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T20:59:50.420

好吧，您可以按斜杠的数量对它们进行排序，这可能不是很有效但很容易：

```
["lib/a.rb", "lib/foo/bar/c.rb", "lib/foo/b.rb"].sort_by { |s| s.count('/') }
#=> ["lib/a.rb", "lib/foo/b.rb", "lib/foo/bar/c.rb"] 
```

或者使用`group_by`并获取每个目录级别的文件数组：

```
["lib/a.rb", "lib/foo/bar/c.rb", "lib/foo/b.rb"].group_by { |s| s.count('/') }
#=> {1=>["lib/a.rb"], 3=>["lib/foo/bar/c.rb"], 2=>["lib/foo/b.rb"]} 
```

# css - 当我的页面引用在 HTTPS 中时，为什么 Facebook 会在 HTTP 中为我的应用程序的 css 插入预加载脚本？

> ID：11197263
> 
> 赞同：4
> 
> 时间：2012-06-25T20:58:06.770
> 
> 标签：css, facebook, caching, ssl

在我们的应用程序 (https://apps.facebook.com/testedenivel) 中，我们在 https 链接中明确引用页面 css，如下所示：

```
<link rel="stylesheet" href="https://d2asm4nez8zghw.cloudfront.net/content/app-teste-de-nivel.css?v=0.96.02" type="text/css" media="screen"> 
```

但奇怪的是，Facebook 将这个 css 文件预加载为 HTTP 链接。在之前的某个时候，我们使用了这个 HTTP url，但后来我们将其更改为 HTTPS，现在 Facebook 似乎正在使用该 url 的以前的缓存版本：

```
<script type="text/javascript">
new Image().src = "http:\/\/www.talkfast.com.br\/content\/app-teste-de-nivel.css";
</script> 
```

问题是当用户通过安全浏览进入我们的应用程序时，HTTP 链接预加载导致浏览器提醒我们的用户一些不安全的内容即将被加载。我们想知道如何告诉 Facebook 删除这个预加载脚本，或者至少使用我们当前的 HTTPS url，如下所示：

```
<script type="text/javascript">
new Image().src = "https://d2asm4nez8zghw.cloudfront.net/content/app-teste-de-nivel.css?v=0.96.02";
</script> 
```

在网络上似乎很少有关于这个问题的参考资料，所以任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T12:12:26.450

我没有在 facebook 应用程序中测试这个解决方案，但是在狂野的网络上你可以使用这个

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.js"></script> 
```

作为证明:) [http://paulirish.com/2010/the-protocol-relative-url/](http://paulirish.com/2010/the-protocol-relative-url/)

由于所有资源都加载了页面协议，因此用户不会在页面上看到有关不安全元素的确认。

* * *

只需使用 Heroku 创建测试应用程序，我的 chromium 不会对框架内的 https 资源感到愤怒，因此问题取决于浏览器。

# android - Android：自定义视图在软键盘出现后返回初始布局

> ID：11197266
> 
> 赞同：0
> 
> 时间：2012-06-25T20:58:09.960
> 
> 标签：android, keyboard, focus, android-softkeyboard

我的自定义视图组有一个奇怪的问题：

它是一个扩展的 FrameLayout，表示一个自定义切换按钮，它的处理程序在左侧和右侧移动。（ala iPhone switch 切换按钮）我通过这行代码移动这个处理程序：

```
 mHandler.layout(0, 0, right, 0); 
```

但是，当我的活动中的另一个视图 EditText 获得焦点时，就会出现软键盘。好吧，这个事件将我的自定义视图组带入初始配置（如果我在“状态开启”配置中切换了自定义视图组，它会打开初始“状态关闭”配置。

就像系统不记得在 Activity.onCreate() 之后布局发生了变化。

有没有人找到解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T15:20:26.367

我修好了。这不是关于 onSaveInstanceState 和 onRestoreInstanceState 的问题，因为活动不会继续 onPause 或其他。我注意到在我的自定义视图失去焦点后，它会调用其 onLayout 方法并使用 flag changed = false。

我最简单的方法是用这个覆盖该方法：

```
@Override
protected void onLayout(boolean changed, int left, int top, int right,
        int bottom) {
    if( changed ){
        super.onLayout(changed, left, top, right, bottom);
    }

} 
```

这解决了这个问题。我的布局视图仅在我需要时更改，而不是在失去焦点时更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:33:26.780

您应该在自定义视图中覆盖[onSaveInstanceState](http://developer.android.com/reference/android/view/View.html#onSaveInstanceState%28%29)和[onRestoreInstanceState](http://developer.android.com/reference/android/view/View.html#onRestoreInstanceState%28android.os.Parcelable%29)并执行任何必要的操作来保存内部状态。

如果您从现有的 View 类派生，那么不要忘记调用父类实现来保存实例状态。

# javascript - Ruby on Rails：JSON、javascript 和 ruby

> ID：11197268
> 
> 赞同：-1
> 
> 时间：2012-06-25T20:58:16.350
> 
> 标签：javascript, ruby-on-rails, ruby, json

> **可能重复：**
> [Ruby on Rails：将 javascript 数据发送到 ruby​​ 控制器](https://stackoverflow.com/questions/11198073/ruby-on-rails-sending-javascript-data-to-ruby-controller)

使用 JSON、javascript 和 RoR 的总菜鸟

在我的 RoR 应用程序中，我在网页上有一些 javascript。我想将我建立的数组之一传递给我的控制器中的 Ruby 函数（这可能吗？）

我读过需要转换为 JSON 的地方。使用这个命令给了我可以使用的东西（totalChanges 是我的数组）

```
JSON.stringify(totalChanges) 
```

但是我如何将它传递给 ruby​​ 函数？如果有什么不明白的地方请纠正我。

谢谢

编辑：

我正在使用 jquery。评论指出我可以使用[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)之类的东西将数据发送到控制器。

我想要做的特定操作是将一些数据（在 javascript 数组中）保存到数据库中，然后重新加载页面以显示新数据。jquery.ajax 似乎有很多选择，我有点迷茫。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T22:48:02.043

您可以像这样使用 jQuery 发出 AJAX 请求：

```
$.ajax({
    type: "POST",
    url: "/route/to/action",
    data: { mydata: JSON.stringify(totalChanges) },
    success: function(response, textStatus, jqXHR) {
        console.log("Yay it worked.", response);
    }
); 
```

在您的操作中，您可以检索传递给您的操作的数据，如下所示：

```
def action
    mydata = params["mydata"]
    # Save it to the database...
end 
```

# android - 如何在 ListView 中添加多个标题视图

> ID：11197274
> 
> 赞同：6
> 
> 时间：2012-06-25T20:58:41.523
> 
> 标签：android, android-listview

我有一个自定义适配器，我`ListView`想将项目名称作为标题添加到我的工作请求中。添加单个标头效果很好，但我不确定如何使用`addHeaderView`. 我不明白到底该放在哪里，`setAdapter`还是应该多次放置？

这是我的单个标头的 Java 代码，它可以工作：

```
mListView = (ListView)findViewById(R.id.dashboardList);
View header1 =  getLayoutInflater().inflate(R.layout.listview_header, null, false);
tv = (TextView) header1.findViewById(R.id.listHeader);
adapter = new MyCustomAdapter(MyDashboardActivity.this, R.layout.mydashboard_row, dashboardBean);
tv.setText("Project 1");
mListView.addHeaderView(header1, null, false);
for (int i=0; i < 7; i++) {
     dashboardBean.add(new DashboardBean(workRequests[i],status[i],actualHours[i]));
}
mListView.setAdapter(adapter); 
```

现在，我尝试了两个标题：

```
mListView = (ListView)findViewById(R.id.dashboardList);
View header1 =  getLayoutInflater().inflate(R.layout.listview_header, null, false);
tv = (TextView) header1.findViewById(R.id.listHeader);
adapter = new MyCustomAdapter(MyDashboardActivity.this, R.layout.mydashboard_row, dashboardBean);
tv.setText("RxOffice");
mListView.addHeaderView(header1, null, false);
for (int i=0; i < 4; i++) {
     dashboardBean.add(new DashboardBean(workRequests[i],status[i],actualHours[i])); 
}

tv.setText(Project 2");

mListView.addHeaderView(header1, null, false);
for (int i=4; i < workRequests.length; i++) {
     dashboardBean.add(new DashboardBean(workRequests[i],status[i],actualHours[i]));
}
mListView.setAdapter(adapter); 
```

但这不起作用！它只给了我 Project 2 标题和它下面的所有 7 个条目。谁能告诉我怎么了？我猜它与`setAdapter`. 谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-26T04:29:55.290

我认为您想做的事情不可能像您尝试做的那样。当你使用`addHeaderView`它时，它会包裹你的`ListAdapter`in `HeaderViewListAdapter`。[我在这里](http://developer.android.com/reference/android/widget/HeaderViewListAdapter.html)查看了它的文档，这似乎暗示您可以有多个标题，但它们都将位于顶部（duh，标题）。

听起来你真正想要的是分隔符......

您可以使用[CommonWare 的 MergeAdapter](https://github.com/commonsguy/cwac-merge)。它将允许您插入适配器和视图（以您希望的任何顺序）并将它们全部作为单个适配器呈现给列表视图。您只需将每个内容部分的标题和适配器交给它，然后将其设置到您的列表中。

伪代码示例：

```
myMergeAdapter = new MergeAdapter(); 
myMergeAdapter.addView(HeaderView1); 
myMergeAdapter.addAdapter(listAdapter1); 
myMergeAdapter.addView(HeaderView2); 
myMergeAdapter.addAdapter(listAdapter2); 
setListAdapter(myMergeAdapter); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T05:36:22.110

`Section Adapter`我使用最初由[CommonsWare](https://github.com/commonsguy/cwac-merge)编码的自定义实现了多个标题场景，您可以在 listivew 中创建部分，如书籍、游戏等。查看下面的代码。

**部分适配器：**

```
package com.medplan.db;

import java.util.ArrayList;
import java.util.List;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Adapter;
import android.widget.BaseAdapter;

abstract public class SectionedAdapter extends BaseAdapter {

    String TAG = "========SectionedAdapter============";

abstract protected View getHeaderView(String caption,
                                      int index,
                                      View convertView,
                                      ViewGroup parent);

private List<Section> sections=new ArrayList<Section>();
private static int TYPE_SECTION_HEADER=0;

public SectionedAdapter() {
  super();
  sections.clear();

}

public void addSection(String caption, Adapter adapter) {

  sections.add(new Section(caption, adapter));
}

public void clear() {

    sections.clear();
    notifyDataSetChanged();
}

public Object getItem(int position) {
  for (Section section : this.sections) {
    if (position==0) {
      return(section);
    }

    int size=section.adapter.getCount()+1;

    if (position<size) {
      return(section.adapter.getItem(position-1));
    }

    position-=size;
  }

  return(null);
}

public int getCount() {
  int total=0;

  for (Section section : this.sections) {
    total+=section.adapter.getCount()+1; // add one for header
  }

  return(total);
}

public int getViewTypeCount() {
  int total=1;  // one for the header, plus those from sections

  for (Section section : this.sections) {
    total+=section.adapter.getViewTypeCount();
  }

  return(total);
}

public int getItemViewType(int position) {
  int typeOffset=TYPE_SECTION_HEADER+1; // start counting from here

  for (Section section : this.sections) {
    if (position==0) {
      return(TYPE_SECTION_HEADER);
    }

    int size=section.adapter.getCount()+1;

    if (position<size) {
      return(typeOffset+section.adapter.getItemViewType(position-1));
    }

    position-=size;
    typeOffset+=section.adapter.getViewTypeCount();
  }

  return(-1);
}

public boolean areAllItemsSelectable() {
  return(false);
}

public boolean isEnabled(int position) {
  return(getItemViewType(position)!=TYPE_SECTION_HEADER);
}

public View getView(int position, View convertView,
                    ViewGroup parent) {
  int sectionIndex=0;

  for (Section section : this.sections) {
    if (position==0) {
      return(getHeaderView(section.caption, sectionIndex,
                            convertView, parent));
    }

    int size=section.adapter.getCount()+1;

    if (position<size) {
      return(section.adapter.getView(position-1,convertView,parent));
    }

    position-=size;
    sectionIndex++;
  }

  return(null);
}

public long getItemId(int position) {
  return(position);
}

class Section {
  String caption = null;
  Adapter adapter = null;

  Section(String caption, Adapter adapter) {
    this.caption=caption;
    this.adapter=adapter;
  }
}
} 
```

**在 Activity make Section 适配器对象中，查看以下代码：**

```
final SectionedAdapter adapter =new SectionedAdapter()
                {

                      protected View getHeaderView(String caption, int index, View convertView,ViewGroup parent) 
                      {

                        result=(TextView)convertView;

                        if (convertView==null) 
                        {
                          result=(TextView)getLayoutInflater().inflate(R.layout.section_header,null);

                        }

                        result.setText(caption);
                       // temp=caption;
                       // ind=index;

                        return(result);
                      }
                    }; 
```

**section_header.xml**

```
<?xml version="1.0" encoding="utf-8"?>

<TextView 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content"  
    android:background="@color/black"
    android:textColor="#FFFFFF"
    android:ellipsize="end"
    android:textSize="11sp"
    style="?android:attr/listSeparatorTextViewStyle" />

<!--    android:background="#515050"--> 
```

**在活动中添加任意数量的部分，如下所示：**

注意：userPic 和 medPic 是数组列表的名称。

```
adapter.addSection("section first", new EfficientAdapter(getApplicationContext(),usersPic)); 

adapter.addSection("section second", new EfficientAdapter(getApplicationContext(),medPic));

listview.setAdapter(adapter); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-14T13:55:08.993

我会用 ExpandableListView 解决这个问题。它不需要任何额外的库。

*   创建您的自定义适配器。
*   提供您的数据并填写您需要覆盖的方法。
*   使用 ExpandableListView 设置适配器后：
    *   覆盖 groupItemClick 以便单击组实际上不会展开视图。
    *   遍历适配器中的每个父级并将它们设置为展开。

# iphone - UIImagePickerController 相机和库

> ID：11197275
> 
> 赞同：2
> 
> 时间：2012-06-25T20:58:47.107
> 
> 标签：iphone, ios5

我会认为 UIImagePickerController 将允许您使用相机或从视图中的库中进行选择？看来我必须选择一个或另一个 cia sourceType？有没有办法在选择库视图中添加一个按钮来切换到相机？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T22:18:16.803

您必须自己实施。您可以制作一个简单的 UISegmentedControl，当值更改时，您可以更改 UIImagePickerController 的源。

# linq-to-sql - LINQ：指定的强制转换无效间歇性发生

> ID：11197278
> 
> 赞同：2
> 
> 时间：2012-06-25T20:58:59.747
> 
> 标签：linq-to-sql, c#-4.0

我有一个应用程序开始偶尔抛出“指定的强制转换无效”异常。我无法始终如一地重现此错误，这让我和我的用户发疯。

违规代码：

```
public Complaint GetComplaintById(int Id)
{
    Complaint complaint = (from c in _context.cts_complaints
                           join ud in _context.cts_user_details on c.CreatedBy equals ud.UserId
                           where c.Id == Id
                           select new Complaint
                           {
                              Id = c.Id,
                              CompanyId = c.CompanyId,
                              ComplaintTypeId = c.ComplaintTypeId,
                              CategoryId = c.CategoryId,
                              ReportCategoryId = c.ReportCategoryId,
                              ParentId = c.ParentId,
                              LanguageId = c.LanguageId,
                              AreaId = c.AreaId,
                              Title = c.Title,
                              Description = c.Description,
                              ResponseDue = c.ResponseDue,
                              DateReceived = c.DateReceived,
                              FPSCNumber = c.FPSCNumber,
                              FPSCRepresentative = c.FPSCRepresentative,
                              ContactMethodId = c.ContactMethodId,
                              ContactedBy = c.ContactedBy,
                              CreatedDate = c.CreatedDate,
                              CreatedBy = c.CreatedBy,
                              CreatedByName = ud.Name,
                              Status = c.Status,
                              AttachmentsArchived = c.AttachmentsArchived,
                              Timestamp = c.Timestamp,
                            }).FirstOrDefault();

    complaint.Users = this.GetUsersByComplaintId(Id);

    return complaint;
} 
```

堆栈跟踪：

```
Specified cast is not valid.
   at System.Data.Linq.SqlClient.SqlProvider.Execute(Expression query, QueryInfo queryInfo, IObjectReaderFactory factory, Object[] parentArgs, Object[] userArgs, ICompiledSubQuery[] subQueries, Object lastResult)
   at System.Data.Linq.SqlClient.SqlProvider.ExecuteAll(Expression query, QueryInfo[] queryInfos, IObjectReaderFactory factory, Object[] userArguments, ICompiledSubQuery[] subQueries)
   at System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Execute(Expression query)
   at System.Data.Linq.DataQuery`1.System.Linq.IQueryProvider.Execute[S](Expression expression)
   at System.Linq.Queryable.FirstOrDefault[TSource](IQueryable`1 source)
   at ComplaintTracking.Business.Data.SqlComplaintRepository.GetComplaintById(Int32 Id) in C:\SourceCode2010\ComplaintTracking\Service Pack\1.0 ComplaintTracking\ComplaintTracking.Business\Data\SqlComplaintRepository.cs:line 20
   at ComplaintTracking.Business.Managers.ComplaintManager.GetComplaintById(Int32 Id) in C:\SourceCode2010\ComplaintTracking\Service Pack\1.0 ComplaintTracking\ComplaintTracking.Business\Managers\ComplaintManager.cs:line 33
   at ComplaintTracking.Web.UserControls.ComplaintViews.ResolveViewPresenter.Init() in C:\SourceCode2010\ComplaintTracking\Service Pack\1.0 ComplaintTracking\ComplaintTracking.Web\UserControls\ComplaintViews\ResolveViewPresenter.cs:line 39
   at ComplaintTracking.Web.Library.BaseUserControl`2.OnLoad(EventArgs e) in C:\SourceCode2010\ComplaintTracking\Service Pack\1.0 ComplaintTracking\ComplaintTracking.Web\Library\BaseUserControl.cs:line 56
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) 
```

**更新：** 我正在尝试使用存储库模式。我有一个名为 cts_complaints 的 LINQ 2 SQL ORM 对象，它是我的 SQL Server 表 dbo.cts_complaints 的 1-1 映射。在我的应用程序中，我有一个名为 Complaint 的模型。我的存储库是从 cts_complaints 映射到 Complaint。

```
[HasSelfValidation]
public class Complaint
{
    public Complaint()
    {
    CreatedBy = System.Threading.Thread.CurrentPrincipal.Identity.Name;
    CreatedDate = DateTime.Now;
    DateReceived = DateTime.Now;
    Users = new List<ComplaintUser>();
    }

    public int Id { get; internal set; }
    public int CompanyId { get; set; }
    public int ComplaintTypeId { get; set; }
    public int CategoryId { get; set; }
    public int ReportCategoryId { get; internal set; }
    public int? ParentId { get; set; }
    public int LanguageId { get; set; }
    public int? AreaId { get; set; }
    public string Title { get; set; }
    public string Description { get; set; }
    public DateTime ResponseDue { get; set; }
    public DateTime DateReceived { get; set; }
    public string FPSCNumber { get; set; }
    public string FPSCRepresentative { get; set; }
    public int ContactMethodId { get; set; }
    public string ContactedBy { get; set; }
    public int Status { get; set; }
    public bool AttachmentsArchived { get; set; }
    public DateTime CreatedDate { get; internal set; }
    public string CreatedBy { get; internal set; }
    public string CreatedByName { get; set; }       
    public byte[] Timestamp { get; internal set; }
    public List<ComplaintUser> Users { get; internal set; }

    [SelfValidation()]
    public void ValidateUsers(ValidationResults results)
    {
    //if id is 0 it's new.  There must be user
    if (Users.Count==0)
            results.AddResult(new ValidationResult("You must assign at least one user.", this, "Users", "", null));

    }
} 
```

cts_complaints：

```
CREATE TABLE [dbo].[cts_complaint](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [CompanyId] [int] NOT NULL,
    [ComplaintTypeId] [int] NOT NULL,
    [CategoryId] [int] NOT NULL,
    [ReportCategoryId] [int] NOT NULL,
    [ParentId] [int] NULL,
    [LanguageId] [int] NOT NULL,
    [AreaId] [int] NULL,
    [Title] [nvarchar](50) NOT NULL,
    [Description] [nvarchar](max) NOT NULL,
    [ResponseDue] [datetime] NOT NULL,
    [DateReceived] [datetime] NOT NULL,
    [FPSCNumber] [nvarchar](50) NOT NULL,
    [FPSCRepresentative] [nvarchar](50) NOT NULL,
    [ContactMethodId] [int] NOT NULL,
    [ContactedBy] [nvarchar](50) NOT NULL,
    [CreatedDate] [datetime] NOT NULL,
    [CreatedBy] [nvarchar](50) NOT NULL,
    [Status] [int] NOT NULL,
    [AttachmentsArchived] [bit] NOT NULL,
    [Timestamp] [timestamp] NOT NULL,
 CONSTRAINT [PK_cts_complaint] PRIMARY KEY CLUSTERED 
(
    [Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

cts_user_details：

```
CREATE TABLE [dbo].[cts_user_detail](
    [UserId] [nvarchar](50) NOT NULL,
    [Name] [nvarchar](50) NOT NULL,
    [Email] [nvarchar](255) NOT NULL,
    [ManagerEmail] [nvarchar](255) NOT NULL,
    [Role] [nvarchar](15) NOT NULL,
    [Timestamp] [timestamp] NOT NULL,
 CONSTRAINT [PK_cts_user_detail_1] PRIMARY KEY CLUSTERED 
(
    [UserId] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T08:30:15.530

我有同样的错误，问题也间歇性地发生。

原因是数据库中的列类型与 .dbml 文件中的字段类型之间的类型不匹配

因此，也许检查自动生成的 linq2sql 类中的类型（即 cts_complaints，而不是我假设您自己编写的模型类 Complaint）与数据库中的类型匹配。

（针对我的具体情况的详细信息：在 linq2sql .dbml 文件中有一个类型为 double 的字段，但在数据库中，该列是 datetime - 不知道这是如何发生的 - 可能最初 DB 列和 .dbml 字段具有相同的类型，然后有人在不重新生成 .dbml 文件的情况下更改了数据库中的类型）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T04:44:38.880

**错误：** Cast 无效（尝试使用 LINQ 从实体将数据加载到数据网格中时）

**原因：**映射实体和 SQL Server 表中的数据类型不同。

**示例：**在我的情况下，我在 Entity 类中使​​用了一个 int，在 DB 中使用了一个 bigint，这就是我收到错误的原因。

# php - 如果未填写字段，则使用弹出框停止 HTML POST 的进度

> ID：11197288
> 
> 赞同：1
> 
> 时间：2012-06-25T20:59:43.333
> 
> 标签：php, javascript, html

我正在创建一个包含多个字段的网页。除非填写所有字段，否则我不希望执行 php 代码，因为这会产生错误。

这是我的html代码：

```
 <html>
 <body bgcolor="AliceBlue">

<form action="WorkingVersionV2.php" method="post">
<p>Which database do you wish to access? <center> <input type="text" name="database"/>     </center></p>
<p>What table would you like to examine? <center><input type="text" name="oldtablename"/></center></p>
<p>What would you like to name the table produced? <center><input type="text" name="newtablename"/></center></p>
<p>Start at row: <center><input type="text" name="startrow"/></center></p>
<p>Number of rows to search through:<center> <input type="text" name="numberrows"/>     </center></p>
<center><input type = "submit" onclick="checkFields()"/></center>
</form>

<script type="text/javascript">
function checkFields()
{
    var x = document.getElementById("database").innerHTML;
    if(x=="")
   {
        alert("You forgot to enter a database name");
       }
}
</script>

</body>
</html> 
```

我认为如果未填写字段，则抛出一个弹出框会阻止用户。但是，当用户单击提交时，弹出框并没有弹出，我不确定一旦关闭它，php代码是否仍然会执行。

HTML/javascript 不是我的强项，如果您有更好或更简单的方法，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:01:41.710

如果您希望 javascript 在离开事件处理程序后停止事件继续（例如表单提交或链接单击），则只需从事件处理程序返回 false。

```
function checkFields() {
    var x = document.getElementById("database").innerHTML;
    if(x=="") {
        alert("You forgot to enter a database name");
        return false;
    }
} 
```

此外，您必须将事件处理程序附加到您的表单，以便在提交后调用它：

```
<form ... onsubmit="return checkFields()" ... 
```

然而，这种在 JavaScript 中附加事件处理程序的方法已经失宠。虽然它会起作用，但还有[更好的方法](http://www.quirksmode.org/js/events_advanced.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T21:36:43.607

如果您对非 JavaScript 浏览器使用输入 type=submit，那么您需要进行一些更改。

您的 javascript 函数需要返回如下值：

```
<script type="text/javascript">
function checkFields()
{
    var x = document.getElementById("database").innerHTML;
    if(x=="")
    {
        alert("You forgot to enter a database name");
        return false;
    }
    return true;
}
</script> 
```

你应该像这样改变你的输入按钮：

```
<input type="submit" onclick="return checkFields();" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:01:18.663

```
function validateForm()
{
var x=document.forms["myForm"]["fname"].value;
if (x==null || x=="")
  {
  alert("First name must be filled out");
  return false;
  }
}

<form name="myForm" action="demo_form.asp" onsubmit="return validateForm()" method="post">
First name: <input type="text" name="fname">
<input type="submit" value="Submit">
</form> 
```

当您提交表单时，您将要告诉它它需要运行该函数，在本例中为验证函数。这是通过 onsubmit="function()" Return false 将结束脚本的执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T13:16:37.093

```
function checkFields()
{
    var x = document.getElementById("database").innerHTML;
    if(x=="")
    {
        alert("You forgot to enter database name");
        return false;
    }
    return true;
}
</script> 
```

输入按钮部分是最重要的。一定要返回函数

```
 <input type="submit" onclick="return checkFields();" /> 
```

# spring-mvc - 更新状态输入单选按钮 jstl 和 spring mvc

> ID：11197293
> 
> 赞同：1
> 
> 时间：2012-06-25T20:59:59.447
> 
> 标签：spring-mvc, jstl

我正在使用弹簧 mvc

当我创建用户时，在我的表单中，活动或非活动单选按钮完美保存在我的数据库中

当我编辑我的用户时，它没有在输入单选按钮中选择实际状态，我需要 jslt 中的建议，下面是我的代码

```
<div class="section">
    <label>Status<small>status</small></label>
    <div>
      <div>
        <input type="radio" name="status" id="radio-1" value="ACTIVE" class="ck" checked='<c:out value="${userIdSearch.state ? 'ACTIVE'}">checked</c:out>'/> 
       <label for="radio-1">Active</label>

       <input type="radio" name="status" id="radio-2" value="DEACTIVE" class="ck" checked='<c:out value="${userIdSearch.state ? 'DEACTIVE'}">checked</c:out>'/> 
       <label for="radio-2">Deactive</label>
      </div>
    </div>
</div> 
```

在此先感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:09:48.350

我不确定。我希望我的回答可以帮助你。试试看。

```
<input checked="<c:if test="${userIdSearch eq 'Active'}">checked</c:if>"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-10T14:06:05.603

一个好方法是将属性放在 EL 表达式中，在三元 if; 如果条件为真，则将属性checked=checked；如果没有，什么也不做

```
 <input type="radio" name="status" id="radio-1" value="ACTIVE" class="ck" ${userIdSearch.state eq 'ACTIVE' ? 'checked=\"checked\"' :''} /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-02T17:20:19.590

导入 java.sun.com/jstl/core_rt（我称它为“c”，但你可以随便叫它）：

```
<%@ taglib uri="http://java.sun.com/jstl/core_rt" prefix="c" %> 
```

然后你可以像这样在单选按钮中使用 c:if：

```
<input type="radio" name="status" id="radio-1" value="ACTIVE" class="ck" <c:if test="${status.value == 'ACTIVE'}">checked="checked"</c:if> />Active 
```

如果这仍然没有绑定到您的对象，您可以尝试使用弹簧绑定，如下所示：

```
<%@ taglib uri="http://www.springframework.org/tags" prefix="spring" %>
...
<spring:bind path="pathToActive.status">
    <input type="radio" name="<c:out value="${status.expression}"/>" id="radio-1" ... etc
</spring:bind> 
```

# iphone - 从详细信息披露按钮 segue 传递对象

> ID：11197295
> 
> 赞同：4
> 
> 时间：2012-06-25T21:00:02.800
> 
> 标签：iphone, objective-c, ios, uitableview, uistoryboardsegue

如何将对象从详细信息公开点击传递到详细信息视图控制器？对此有什么建议或快速修复吗？理想情况下，我想创建一个这样的方法：

```
[self performSegueWithIdentifier:@"showDetail" sender:self passObject:object]; 
```

原因是“准备继续”似乎只有在我在详细信息披露指示器之前按下单元格时才会被调用。我将如何创建像上面这样的方法来创建下面准备的效果？

```
if ([[segue identifier] isEqualToString:@"showDetail"]) {
    NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow];
    id object = [_objects objectAtIndex:indexPath.row];
    [[segue destinationViewController] setDetailItem:object];
} 
```

我已经尝试像这样创建 UIStoryboardSegue 的子类，但遇到了两个问题。

```
@implementation masterToDetail
-(void)performSegueWithIdentifier:(NSString*)identifier sender:(id)sender passObject:(id)object{
    [self.destinationViewController setDetailItem:object];
    [self performSegueWithIdentifier:identifier sender:sender];
}

-(void)performSegueWithIdentifier:(NSString*)identifier sender:(id)sender{
 //What code should go here? Issue one   
}

-(void)perform{
    //Second issue, the compiler will crash and say I need to override perform.
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T21:26:50.340

我通过完全放弃 segue idea 的子类解决了这个问题。我删除了自定义 segue 并将推送 segue（**从 tableviewcontrollre**）到我的详细视图控制器。然后我创建了一个实例变量`NSIndexPath* _ipath;`，我的代码如下：

```
- (void)tableView:(UITableView *)tableView accessoryButtonTappedForRowWithIndexPath:(NSIndexPath *)indexPath{
    _ipth = indexPath;
    [self performSegueWithIdentifier:@"showDetail" sender:self];
}
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
    NSLog(@"prepping");
    if ([[segue identifier] isEqualToString:@"showDetail"]) {
        NSLog(@"in if");
        id object = [_objects objectAtIndex:_ipth.row];
        [[segue destinationViewController] setDetailItem:object];
    }
} 
```

这让我们为 segue 做好准备，为正确的单元格工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T02:49:43.663

1.  打开故事板

2.  选择主视图控制器 - 主

3.  从 UITableViewCell 选择 Segue 到 Detail View Controller - Detail

4.  打开属性检查器

5.  标识符 -> masterToDetail 写入

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-16T19:46:47.237

您可以简单地右键单击表格视图单元格，然后从辅助操作中按住 ctrl-drag。

# ruby-on-rails - 使用 .htaccess 或 Virtualmin 将重定向添加到 Ruby on Rails 网页

> ID：11197296
> 
> 赞同：2
> 
> 时间：2012-06-25T21:00:10.243
> 
> 标签：ruby-on-rails, apache, .htaccess, redirect

提前感谢您在此问题上提供的任何帮助！我管理一个 Ruby on Rails 网站，该网站使用 Apache 并位于 Joyent 的云服务器上。现在我有一个位于[http://example.com/docs/mydoc.pdf](http://example.com/docs/mydoc.pdf)的 pdf 文件。我希望这个 url 301 将访问者重定向到[http://example.com/mydoc](http://example.com/mydoc)，这将是一个具有相同内容的网页（而不是 pdf。）

我尝试了几种方法来进行重定向，但都没有奏效。

1.  我进入了 VirtualMin 并进入了 Apache 服务器。然后，我选择了别名/重定向。最后，我进入永久 URL 重定向并输入： FROM [http://example.com/docs/mydoc.pdf](http://example.com/docs/mydoc.pdf) TO [http://example.com/mydoc](http://example.com/mydoc)并应用更改。
2.  由于这不起作用，我去 /public 文件夹中寻找 .htaccess 文件。不存在。因此，我创建了一个 .htaccess 文件并将其添加到 /public 文件夹中。文件中唯一的代码是

`Redirect 301 /docs/mydoc.pdf http://example.com/mydoc`

问题？当我转到[http://example.com/docs/mydoc.pdf](http://example.com/docs/mydoc.pdf)时，重定向不起作用。

我正在寻找最简单的方法来将此 301 重定向和未来的 301 重定向添加到我的网站。再次感谢您的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:29:52.533

Rails 3 引入了一种从 config/routes.rb 执行 301 重定向的简单方法

```
match "/oldpath", :to => redirect "/newpath" 
```

[这个站点](http://www.camelpunch.com/web-development/tutorials/301-redirect-with-rails/)在 Rails 2 中为 301 重定向提供了一个有点麻烦的解决方案。

但是，如果我是你，我会将所有重定向放在 apache 配置文件中。这保持了有用的模块化程度：您不必将您的路线与您的重定向混合，您不必将旧网站的工件混合到您的新应用程序中。

# php - PHP（客户端）到 Android（服务器）Socket 通信

> ID：11197303
> 
> 赞同：0
> 
> 时间：2012-06-25T21:00:44.223
> 
> 标签：php, android, sockets, serversocket

我在我的 android 设备上制作了一个简单的 ServerSocket 应用程序，我使用 telnet 进行连接，它工作正常（发送的消息显示在我的 logcat 窗口中）。问题；当我尝试从 php 页面建立连接时（我也在使用 PHP 套接字）。Android 套接字接受第一个连接，然后有点奇怪 - 有时他会读取从 PHP 发送的消息并将它们显示在 logcat 中，但通常它只接受第一个请求，然后......什么都没有

安卓端代码：

```
public class TestSocketActivity extends Activity {
private ServerSocket ss;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);        
    setSocket();
}
public void setSocket() {

    try {
        ss = new ServerSocket(7000);

        System.out.println("Started");

    } catch (IOException e) {
        // TODO Auto-generated catch block
        System.out.println("Accept failed: 4444");
        e.printStackTrace();
    }

    Socket clientSocket = null;
    try {
        clientSocket = ss.accept();
        String s = clientSocket.getRemoteSocketAddress().toString();
        System.out.println(s);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        System.out.println("SS error");
        e.printStackTrace();
    }
    try {
        BufferedReader in = 
                new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));
        String inputLine, outputLine;
        while ((inputLine = in.readLine()) != null) {  
            Toast.makeText(getApplicationContext(),"test",1).show();
            System.out.println("in: "+inputLine);
        }
        ss.close();
        setSocket();
        } 

    catch (IOException e) {
        // TODO Auto-generated catch block
        System.out.println("error");
        e.printStackTrace();
    }

}
} 
```

这是一个简单的 PHP 请求：

```
<?php
error_reporting(E_ALL);

$address = '192.168.0.180';
$port = 7000;

$socket = socket_create(AF_INET, SOCK_STREAM, 0);
$result = socket_connect($socket, $address, $port);

$in = mktime();

socket_write($socket, $in, strlen($in));
socket_close($socket);
?> 
```

......这就是全部也许有一些更容易的通信（我需要每次都从PHP连接到Android设备，所以PHP不能等待来自Android的请求）。

感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:29:14.143

您确实意识到您的 Android ServerSocket 应该维护一个“无限”循环来等待传入连接，通过读取请求来处理请求，直到到达流的末尾，然后返回等待另一个传入请求的状态。

改为执行以下操作：

```
public void start() throws IOException {
    serverSocket = new ServerSocket(port);
    running = true;

    while(running) {
        Socket connectionSocket = null;
        InputStream input = null;
        OutputStream output = null;

        try {
            connectionSocket = serverSocket.accept();
            input = connectionSocket.getInputStream();
            output = connectionSocket.getOutputStream();

            // At this point do whatever you need to do with these streams
        } catch(Exception e) {
            throw new RuntimeException(e);
        } finally {
            if(input != null) {
                input.close();
            }

            if(output != null) {
                output.close();
            }

            if(connectionSocket != null) {
                connectionSocket.close();
            }
        }
    }

    serverSocket.close();
    serverSocket = null;
} 
```

让这个方法在单独的线程中运行，这样它就不会阻塞 UI 线程。一旦用户请求或当您的 Activity 停止时，您应该将 running 变量设置为 false，以便您的服务器正常停止。

# jquery - 隐藏一个类的所有 div，只显示具有附加类的那些

> ID：11197305
> 
> 赞同：0
> 
> 时间：2012-06-25T21:00:56.373
> 
> 标签：jquery

我有一个宽度为“chairdiv”类的DIVS（商店页面上的产品）列表。我希望能够过滤具有附加类的 DIVS，这是一个示例：

```
<div class="chairdiv sold"></div>
<div class="chairdiv forsale"></div>
<div class="chairdiv forsale"></div>
<div class="chairdiv forsale"></div>
<div class="chairdiv sold"></div>
<div class="chairdiv forsale"></div> 
```

默认情况下，页面会显示所有这些 div，我可以使用 javascript 隐藏所有“chairdiv” div，除了“sold”或“forsale”作为附加类的那些？

我精通 HTML/CSS，但我对 JavaScript 知之甚少。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T21:02:13.580

我的第一个想法：

```
$('.chairdiv').not('.sold, .forsale').hide(); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/jE5zn/)。

**针对 OP 的问题进行了**编辑：****

 **> 你能告诉我如何用 HTML 激活这个功能吗？例如，只显示`<div class="chairdiv sold"></div>`，我可以在这里放什么：`<a href="(what here)">show sold chairs</a>`

为了这：

```
<a href="#" id="showChairsAndSold">Show chairs and sold</a>

$('#showChairsAndSold').click(
    function(e){
        e.preventDefault(); // prevents any default action
        $('.chairdiv').not('.sold, .forsale').hide();
    }); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/jE5zn/1/)。

参考：

*   [`click()`](http://api.jquery.com/click/).
*   [`event.preventDefault()`](http://api.jquery.com/event.preventDefault/).
*   [`hide()`](http://api.jquery.com/hide/).
*   [`not()`](http://api.jquery.com/not/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:03:22.817

```
$(".chairdiv").filter('.sold, .forsale'); 
```

这需要所有具有“chardiv”类的元素，然后只返回那些具有“sold”或“forsale”类的元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:06:47.967

由于您特别询问了如何隐藏 div（以防您有其他标签可能包含`chairdiv`您不想隐藏的类**）**（我知道这听起来很有趣，因为“div”在类名中，但您确实问过对于div）：

```
$("div.chairdiv").not(".sold, .forsale").hide(); 
```**

# php - 语法错误，意外 $end In for 循环

> ID：11197310
> 
> 赞同：-1
> 
> 时间：2012-06-25T21:01:18.260
> 
> 标签：php, for-loop, syntax-error

我在这里发布的第一个线程。我一直在这里寻找答案，几乎总能得到答案。但这一个略有不同。我有这个 php 代码片段

```
<tr>
  <td>
<?php if (mysql_numrows($sqlstr) != 0) { //if there are records found
while ($row = mysql_fetch_array($sqlstr)) {  //do while there are rows
  if($English==1)
    $Title=$row["sSubCatEng"];
  else
    $Title=$row["sSubCat"];
  echo $Title;
  }
} ?> 
</td>
</tr>
<?php
  $NumOfItems= 9; //Number of items per page.
  $ItemsCount=count($ItemPartID); //number of items in ItemPartID array
  $Page = $_GET["Page"]; //puts the var in a local one
  if(($NumOfItems*$Page) > $ItemsCount) // if it is the last page
  {
    $StopFor = $ItemsCount % $NumOfItems; //stop when you modulo
    $j = ($NumOfItems*($Page - 1));
    $indexFor = $StopFor;
  }
  else
  {
    $StopFor = $NumOfItems * $Page;
    $j =($NumOfItems*($Page - 1));
    $indexFor = $StopFor - $j;
  }
  ?>
<tr>
<?php if($English==0){ ?>
 <td dir="rtl" align="center" colspan="3">
 <?php echo $ItemsCount; ?> <?php echo $Title; ?> <?php echo $NumOfItems; ?>
 <?php }else { ?>
 <td align="center" colspan="3">
 Currently there are <?php echo $ItemsCount." ".$Title; ?> in the catalog.Only <?php echo $NumOfItems; ?> are displayed on each page.
 <? } ?>

<? for($i=0;$i<$var;$i++) {
    echo "<td style='width:30px;height:30px;border-color:black;border-style:solid;border-      width:1px;background-color: lightgray;font-weight: bold;text-align: center;";
    if($Page==($i+1))
        echo "color:red;";
    echo "' onmouseover=\"this.style.cursor = 'pointer';\"      onmousemove=\"this.style.backgroundColor = 'red';this.style.color='white';\"     onmouseout=\"this.style.backgroundColor='lightgray';";
    if($Page==($i+1))
        echo "this.style.color='red';";
    else
        echo "this.style.color='black';";
    echo "\" onClick='window.location=\"Catalog.php?Cat={$Category}&Page=".($i+1)."&SubCat=    {$SubCat}&lang={$Lang}\"' >".($i+1); 
    echo "</td>";
}
?> 
```

有点乱，我只是不知道如何添加代码片段。我进行了一些调试，发现第一行（for 行）是问题所在，但我找不到问题所在。（我用 1 替换了 $var ，但它仍然没有帮助）。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:04:02.297

您似乎忘记了 if/else 语句的花括号 {}。

**编辑：**尝试改变： `<? } ?>`就`<? }`在之前`for($i=0;$i<$var;$i++) {`

`<?`（您错过了 for 循环的 php起始标记。）

# javascript - 在一个页面上隐藏多个表单并使用特定链接打开它们

> ID：11197312
> 
> 赞同：0
> 
> 时间：2012-06-25T21:01:32.010
> 
> 标签：javascript, jquery, colorbox

我正在创建一个页面，并且每个页面上都有多个表单。表格是隐藏的，但每个表格都有一个链接。当用户单击带有关联表单的链接时，该表单会使用 colorbox.js 在灯箱中打开。当页面上只有一个表单时，我让它工作，但我不知道如何创建一个适用于一个页面上的多个表单的脚本。我的脚本是：

```
 <script>
    jQuery(document).ready(function() {
        $(".myForm").hide();

        $(".link_to_form").click(function() {
            $(".myForm").show();
        });

        $(".link_to_form").colorbox({ 
            width: "50%", 
            inline: true,
            opacity: ".5", 
            href: ".myForm", 
            onClosed: function() {
                $(".myForm").hide();
            }

            });
    });
    </script> 
```

用户单击的链接具有“link_to_form”类，实际表单位于“myForm”类的 div 中。每个表单也有一个与之关联的特定 id。因此，当用户单击“注册”表单时，需要弹出与之关联的表单。现在，如果用户点击任何表单的链接，所有表单都会在灯箱中打开。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:09:29.167

本质上，您正在绑定一个单击事件，该事件在 DOM 中找到的所有 .myForm 匹配项上调用 show()。您真正想要做的是将事件绑定到 DOM 中的所有 .link_to_form 匹配项，并让点击事件仅打开与点击相关的事件。

一个很好的方法是这样的：

```
<div class="form_1">
   <a href="#" id="form_open_button">Open Form</a>
   <form class="my_form_class'>
   </form>
</div>

<div class="form_2">
   <a href="#" id="form_open_button">Open Form</a>
   <form class="my_form_class'>
   </form>
</div>

$('.form_open_button').click(
function() {
   $(this).next().toggle();
}); 
```

但是您必须确保在 Anchor 之后立即保留您的表格。如果它们不是即时的，请将 next() 更改为：

```
$(this).next('.my_form_class').toggle() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:34:56.490

```
$(".link_to_form").click(function() {
    $(this).prev(".myForm").show();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:43:12.783

您可以向链接添加 data- 属性，使其看起来像

```
<a href='#' class="formLinks" data-form-id="form1" id="lnk_1">show</a>
<form id="form1"></form> 
```

然后
你的脚本将是

```
$('.formLinks').click(function(){
var formid =$(this).data('form-id');
$('#'+formid).show();
}); 
```

# jquery-ui - 当 JQueryUI 小部件与 Fabric.js 一起使用时，旋转/调整大小控件的行为异常

> ID：11197317
> 
> 赞同：1
> 
> 时间：2012-06-25T21:01:50.710
> 
> 标签：jquery-ui, fabricjs

我刚刚发现了 Fabric.js，虽然文档有点少，但它似乎可以处理我正在构建的基于 HTML 的 Dream Board 工具所需的一切。不过，它似乎不能很好地与 JQueryUI 配合使用。

当我将我的任何对象设置为 JQueryUI 小部件、按钮、对话框等时......控制手柄似乎在我的画布项目的上半部分没有响应，甚至在底部，用于调整大小的命中区域/旋转大大减少，这使得物品难以操作。有没有人遇到过这个？这是一个已知的问题？我检查了 github 并试图搜索 SO 无济于事。

谢谢！

[http://seismicdevelopment.com/test/no-jquery-uis.html](http://seismicdevelopment.com/test/no-jquery-uis.html) - 没有 JQuery UI 小部件...表现出我的预期。

[http://seismicdevelopment.com/test/with-jquery-uis.html](http://seismicdevelopment.com/test/with-jquery-uis.html) - 点击“添加图片”，你会得到一张图片，但与其他页面相比，你会注意到图片的角落是' t 作为交互式...您可以移动图像，但旋转和缩放是非常偶然的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T19:43:53.850

问题一定出在偏移量上。与初始化期间相比，jQueryUI 可能正在修改这些按钮的高度，这会使画布略微向下移动。

[我在这里](https://stackoverflow.com/a/11179754/130652)更详细地解释了这一点——以及它为什么会在 Fabric 中发生。

# performance - Flex 大数据量性能（ADEP/LCDS 数据服务）

> ID：11197319
> 
> 赞同：1
> 
> 时间：2012-06-25T21:02:02.627
> 
> 标签：performance, apache-flex, arraycollection, lcds

正如我们为 Hibernate 找到的解决方案一样，服务器端加载数据的速度非常快：数千条记录甚至更多记录不到一秒。现在问题在于将数据从服务器传输到浏览器。两个问题：

1.数据网格总是等到 ArrayCollection 完全加载。我们通过指定：

```
<destination id="someAssemble">
    <properties>
        <use-transactions>true</use-transactions>
        <source>com.assembler.SomeAssembler</source>
        <scope>application</scope>
        <item-class>vo.SomeVo</item-class>
        <network>
            <paging enabled="true" pageSize="50" />
        </network> 
```

==> 数据网格开始快速显示。问题是服务器停止从第 51 行加载数据。有没有办法强制 Flex 继续在后台加载数据（通过配置或代码）

2.如果我尝试加载一个大的 ArrayCollection（例如超过 20K 条记录），它会锁定整个浏览器。是否可以在幕后顺利加载？

请帮忙！谢谢

# apache-flex - Flex ComboBox 按钮高度

> ID：11197320
> 
> 赞同：0
> 
> 时间：2012-06-25T21:02:04.420
> 
> 标签：apache-flex, combobox

我正在为 Illustrator CS6 创建一个 flex 插件，它需要很紧凑。我有一个比我喜欢的高一点的组合框。如果我设置高度，下拉按钮似乎不会受到影响。事实上，我不能让按钮短于 23 像素，尽管控件的其余部分大小正确。

有没有一个技巧来调整下拉按钮的大小而不是写一个新的控件？

# cufon - 使用 IE8 在 Cufón 上的双文本

> ID：11197323
> 
> 赞同：4
> 
> 时间：2012-06-25T21:02:18.553
> 
> 标签：cufon

我们一直在 IE 中遇到这个非常奇怪的 Cufón 问题，导致我们无法解决。我认为这与隐藏和卷曲的文本有关。

问题是袖口文本和普通文本都显示了（我注意到 Cufón 通常使用的标签被 <:cufon> 替换）。无论如何，这发生在本机 IE8 中（不是 IE9 的“IE8 模式”）。

一个 jsfiddle 值一千多个单词： http: [//jsfiddle.net/Osoascam/vqnh3/1/](http://jsfiddle.net/Osoascam/vqnh3/1/) 要测试，请单击红色圆圈，使文本向左移动 4 次（出于某种奇怪的原因，这只适用于 FF和 IE，但它重现了 IE8 错误，所以我可以忍受）。

任何帮助将不胜感激。这是一个屏幕截图：

![这是它在 IE8 上的外观](../Images/60b1c00f5bd2a1a696940c157be80373.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T11:17:07.783

检查你的js插件，一一禁用，看看是哪一个导致了问题。

我在使用包含 html5shiv 脚本的 cufon 0.9 和modernizr 2.5.3 时发生了同样的事情，而这个破坏了 cufon。

[解决了我用来自github](https://github.com/aFarkas/html5shiv/tree/master/dist)的 html5shiv 的候选发布（RC1）版本替换 modernizr 脚本中的生产版本 html5shiv 的问题。

祝你好运！

# performance - 在没有 for 循环的情况下查找并替换每列中的第一个 NA

> ID：11197328
> 
> 赞同：3
> 
> 时间：2012-06-25T21:02:42.693
> 
> 标签：performance, r, for-loop, apply, na

尝试在没有 For 循环的情况下执行此操作，但无法弄清楚。

我想用默认值 0.0000001 替换列中的第一个 NA。

我正在做最后一次观察结转 (LOCF) 插补，但想给它一个默认值。

如果我有以下data.frame：

```
> Col1        Col2        Col3        Col4
> 1           NA          10          99
> NA          NA          11          99
> 1           NA          12          99
> 1           NA          13          NA 
```

我希望它看起来像这样：

```
> Col1        Col2        Col3        Col4
> 1           0.0000001   10          99
> 0.0000001   NA          11          99
> 1           NA          12          99
> 1           NA          13          0.0000001 
```

这是我的代码，但很慢......

```
#Temporary change for missing first observation
for (u in 1:ncol(data.frame))
{
  for (v in 1:nrow(data.frame)) 
  {
    #Temporary change the first observations in a row to 0.0000001 until it encounters a value that isn't NA
    if(is.na(temp_equity_df_merge2[v,u]))
    {
        temp_equity_df_merge2[v,u]=0.0000001
    }
    else break
  } 
```

我想使用 apply 或一些更快的变体。我正在循环超过 20 列和 100 万行。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T21:18:24.370

您可以对每一列应用一个函数：

```
myfun <- function(x) {
  x[which(is.na(x))[1]] <- 0.1

  return(x)
}

> data.frame(apply(dat, 2, myfun))
   v1  v2 v3   v4
1 1.0 0.1 10 99.0
2 0.1  NA 11 99.0
3 1.0  NA 12 99.0
4 1.0  NA 13  0.1
> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:54:49.647

根据评论，您可以使用`apply`将函数应用于每一列。该函数将用 0.0000001 替换第一个`NA`并返回一个矩阵。然后就可以用`na.locf`来填写剩余`NA`的s了。最后，我把它全部包起来，`data.frame`因为你要求的是 a`data.frame`而不是 a`matrix`

```
data.frame(na.locf(apply(dat, 2, function(x) {
    firstNA <- head(which(is.na(x)), 1) #position of first NA
    x[firstNA] <- 0.0000001
    x
})))
   Col1  Col2 Col3    Col4
1 1e+00 1e-07   10 9.9e+01
2 1e-07 1e-07   11 9.9e+01
3 1e+00 1e-07   12 9.9e+01
4 1e+00 1e-07   13 1.0e-07 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T07:04:33.383

鉴于您拥有如此庞大的数据集，我将使用`data.table`and`set`来避免复制数据。两种`apply`解决方案都至少复制一次数据。

该解决方案涉及一个 for 循环，但是一个有效的循环（执行 length(valid_replace) 事情，每个事情都是瞬时的）

```
library(data.table)

DT< -as.data.table(dat)

replacing <- lapply(DT, function(x)which(is.na(x))[1])

valid_replace <- Filter(Negate(is.na), replacing)

replace_with <- 0.0001

for(i in seq_along(valid_replace)){
  set(DT, i = valid_replace[i], j = names(valid_replace)[i], value = replace_with)
} 
```

# delphi - 仅知道其名称即可获取服务的内存信息

> ID：11197330
> 
> 赞同：1
> 
> 时间：2012-06-25T21:02:52.787
> 
> 标签：delphi, memory-management, service, delphi-2010

有什么方法可以让服务应用程序只知道它的服务名称就使用了多少内存？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T21:25:19.420

[首先，您必须使用QueryServiceStatusEx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684941%28v=vs.85%29.aspx)函数或[Win32_Service](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394418%28v=vs.85%29.aspx) WMI 类将关联进程的 Pid 检索到服务，然后您可以使用[GetProcessMemoryInfo](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683219%28v=vs.85%29.aspx)函数收集进程的内存使用信息。

检查此示例应用程序

```
{$APPTYPE CONSOLE}

uses
  ActiveX,
  ComObj,
  Variants,
  Windows,
  psApi,
  SysUtils;

function  GetPidFromService(const ServiceName : string) : DWORD;
const
  WbemUser            ='';
  WbemPassword        ='';
  WbemComputer        ='localhost';
  wbemFlagForwardOnly = $00000020;
var
  FSWbemLocator : OLEVariant;
  FWMIService   : OLEVariant;
  FWbemObjectSet: OLEVariant;
  FWbemObject   : OLEVariant;
  oEnum         : IEnumvariant;
  iValue        : LongWord;
begin;
  FSWbemLocator := CreateOleObject('WbemScripting.SWbemLocator');
  FWMIService   := FSWbemLocator.ConnectServer(WbemComputer, 'root\CIMV2', WbemUser, WbemPassword);
  FWbemObjectSet:= FWMIService.ExecQuery(Format('SELECT ProcessId FROM Win32_Service Where Name="%s"',[ServiceName]),'WQL',wbemFlagForwardOnly);
  oEnum         := IUnknown(FWbemObjectSet._NewEnum) as IEnumVariant;
  if oEnum.Next(1, FWbemObject, iValue) = 0 then
    Result:=FWbemObject.ProcessId;
end;

procedure MemoryInfoService(const ServiceName : string);
var
  hProcess : THandle;
  ppsmemCounters: PPROCESS_MEMORY_COUNTERS;
  cb: DWORD;
begin
  hProcess := OpenProcess(PROCESS_VM_READ or PROCESS_QUERY_INFORMATION, False, GetPidFromService(ServiceName));
  if hProcess <> 0 then
  try
   cb:=SizeOf(PROCESS_MEMORY_COUNTERS);
   GetMem(ppsmemCounters, cb);
   try
   if  GetProcessMemoryInfo( hProcess, ppsmemCounters, cb) then
   begin
      Writeln( Format('PageFaultCount: %d',[ ppsmemCounters.PageFaultCount]));
      Writeln( Format('PeakWorkingSetSize: %d',[ ppsmemCounters.PeakWorkingSetSize]));
      Writeln( Format('WorkingSetSize: %d',[ ppsmemCounters.WorkingSetSize]));
      Writeln( Format('QuotaPeakPagedPoolUsage: %d',[ ppsmemCounters.QuotaPeakPagedPoolUsage]));
      Writeln( Format('QuotaPagedPoolUsage: %d',[ ppsmemCounters.QuotaPagedPoolUsage]));
      Writeln( Format('QuotaPeakNonPagedPoolUsage: %d',[ ppsmemCounters.QuotaPeakNonPagedPoolUsage]));
      Writeln( Format('PagefileUsage: %d',[ ppsmemCounters.PagefileUsage]));
      Writeln( Format('PeakPagefileUsage: %d',[ ppsmemCounters.PeakPagefileUsage]));
   end;
   finally
     FreeMem(ppsmemCounters);
   end;
  finally
    CloseHandle(hProcess);
  end;
end;

begin
 try
    CoInitialize(nil);
    try
      MemoryInfoService('FirebirdGuardianDefaultInstance');
    finally
      CoUninitialize;
    end;
 except
    on E:EOleException do
        Writeln(Format('EOleException %s %x', [E.Message,E.ErrorCode]));
    on E:Exception do
        Writeln(E.Classname, ':', E.Message);
 end;
 Writeln('Press Enter to exit');
 Readln;
end. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T21:10:40.633

我没有特定于 delphi 的代码来执行此操作，但我可以告诉您执行此操作的 windows api 调用（特别是 toolhelp dll 调用）。为此，您需要知道 exe 的名称（不确定这是否适合您）。

1.  使用**createtoolhelp32snapshot**，然后使用**process32first**和**process32next**来定位进程 ID。
2.  通过将进程 id 传递给**OpenProcess来获取进程的句柄**
3.  将进程句柄传递给**GetProcessMemoryInfo**。这将使用您正在寻找的信息（workingSetSize 结构成员）填充**PROCESS_MEMORY_COUNTERS结构。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:11:33.263

1.  [如何从 Delphi 中的服务名称/句柄中找到进程 ID？](https://stackoverflow.com/questions/469494/how-can-i-find-the-process-id-from-the-service-name-handle-in-delphi)
2.  [`GetProcessMemoryInfo`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683219%28v=vs.85%29.aspx)找出过程指标

# javascript - 使用 jquery/js 禁用 href

> ID：11197332
> 
> 赞同：1
> 
> 时间：2012-06-25T21:03:18.200
> 
> 标签：javascript, jquery

我在通过 jquery 禁用 href 链接时遇到了困难。我正在使用我修改的这种方法。有人可以建议或帮助我解决这个问题吗？谢谢你。

**jQuery/js**

```
<script>
 $('.next-tab').click(function() {
     $('.st_tab_active').attr('disabled','disabled');
     var tab=  $('.st_tab_active').parent().next().children('a');
     tab.removeAttr('disabled');
     tab.trigger('click');
     return false;
      });
</script> 
```

**html**

```
<ul class="st_tabs">
    <li><a href="#st_content_1" class="st_tab" disabled="disabled">Horizontal Tab #1</a></li>
    <li><a href="#st_content_2" class="st_tab" disabled="disabled">Horizontal Tab #2</a></li>
    <li><a href="#st_content_3" class="st_tab" disabled="disabled">Horizontal Tab #3</a></li>
    <li><a href="#st_content_4" class="st_tab" disabled="disabled">Horizontal Tab #4</a></li>
    <li><a href="#st_content_5" class="st_tab" disabled="disabled">Horizontal Tab #5</a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T21:04:51.007

您可以使用`preventDefault();`禁用链接的默认行为（即导航到给定的`href`）。

```
$("a").click(function(e){
    e.preventDefault(); 
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-25T21:20:16.700

所有的答案看起来都是可能的解决方案

这是关于在锚标签上使用禁用属性的讨论

[HTML Anchor 标记是否应该尊重 Disabled 属性？](https://stackoverflow.com/questions/7000927/should-the-html-anchor-tag-honor-the-disabled-attribute)

更好的是，不要使用 disabled 属性，这是非法的；）

现在你有

```
event.preventDefault(); 
```

或者

```
return false; 
```

这是关于两者使用的讨论，

[event.preventDefault() 与返回 false](https://stackoverflow.com/questions/1357118/event-preventdefault-vs-return-false)

对于您的情况，看起来 return false 很好，因为您也不想冒泡。

由于您没有很好地解释该位置，因此无法说出您的确切问题的解决方案，

当单击某些“下一个选项卡”时，您似乎正在尝试使用某些启用/禁用选项卡切换选项卡。如果您也可以解释，我们将很乐意提供帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T21:08:56.103

您可以使用两种方法，阻止默认操作或简单地返回 false。

```
$('a').click(function(event)
{
    event.preventDefault(); 

    // Rest of the code

    return false;
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-25T21:11:31.347

正如 ahren 之前所说，这是要走的路，但是为了不禁用您网站上的每个 href，请使用：
`$('a.st_tab').click(function(e){`
`e.preventDefault();`
`});`

# php - XSLTProcessor xmlSAX2Characters：内存不足

> ID：11197337
> 
> 赞同：4
> 
> 时间：2012-06-25T21:03:34.453
> 
> 标签：php, xml, xslt, xml-parsing

我有一个加载 500 mb xml 文件并使用 xsl 模板解析文件的页面。解析器在我的本地环境中完美运行。我正在使用 WAMP。

在网络服务器上。

警告：DOMDocument::load() [domdocument.load]: (null)xmlSAX2Characters: /home/mydomain/public_html/xslt/largeFile.xml 中的内存不足，行：/home/mydomain/public_html/xslt/parser_large 中的 2031052 .php 在第 6 行

我的代码如下，第 6 行加载 xml 文件

`<?php`
`$xslDoc = new DOMDocument();`
`$xslDoc->load("template.xslt");`

`$xmlDoc = new DOMDocument();`
`$xmlDoc->load("largeFile.xml");`

`$proc = new XSLTProcessor();`
`$proc->importStylesheet($xslDoc);`
`echo $proc->transformToXML($xmlDoc);`
`?>`

我尝试将 php.ini 文件从 wamp 安装复制到上述代码所在的文件夹。但这并没有帮助。这个 php.ini 文件中的内存限制是 memory_limit = 1000M

对此的任何建议/经验将不胜感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T21:28:38.433

这是可悲的事实。有两种使用 XML 的基本方法，基于 DOM，其中整个 XML 文件一次存在于内存中（需要相当大的开销以使其快速遍历），以及基于文件通过内存的位置，但只有一个 SAX它的一小部分在任何给定时间都存在。

然而，对于 DOM，大量的内存消耗是很正常的。

现在 XSLT 语言通常允许在任何时候访问整个文件的任何部分的构造，因此它需要 DOM 样式。一些编程语言的库允许将 SAX 输入提供给 XSLT 处理器，但这必然意味着对 XSLT 语言或内存消耗的限制并不比 DOM 好多少。不过， PHP[没有办法](http://docstore.mik.ua/orelly/webprog/pcook/ch12_05.htm)让 XSLT 读取 SAX 输入。

这给我们留下了 DOM 的替代方案；有一个，称为 SimpleXML。如果您的文档有命名空间， SimpleXML 使用起来会有些[棘手。](https://stackoverflow.com/questions/595946/parse-xml-with-namespace-using-simplexml)[一个古老的基准](http://blog.liip.ch/archive/2004/05/10/processing_large_xml_documents_with_php.html)似乎表明它比大文件上的 DOM 更快，并且在内存消耗方面可能也更少浪费。

最后，我曾经在另一种编程语言中处于你的位置。解决方案是根据简单的规则将文档拆分为小文档。每个小文档都包含一个从整个文档复制的页眉、一个“详细”元素和一个页脚，使其格式对大 XML 文件的模式有效。它是使用 XSLT 处理的（假设对一个细节元素的处理不查看任何其他细节元素）并将输出组合在一起。这就像魅力一样，但它不是在几秒钟内实现的。

所以，这里是你的选择。选一个。

*   [使用 SAX 解析和处理 XML](http://docstore.mik.ua/orelly/webprog/pcook/ch12_05.htm)。
*   使用[SimpleXML](http://www.numyspace.co.uk/~unn_isrd1/new/index.php?pid=2909)并希望它允许在同一内存中使用稍大的文件。
*   执行一个外部 XSLT 处理器，并希望它允许在同一内存中使用稍大的文件。
*   [使用此方法](http://kuttler.eu/post/merging-and-splitting-xml-files-with-simplexml/)拆分和合并 XML，并将 XSLT 仅应用于小块。此方法仅适用于某些模式。

# php - PHP中的动态选择数组

> ID：11197341
> 
> 赞同：5
> 
> 时间：2012-06-25T21:03:42.630
> 
> 标签：php, javascript

我在 PHP 中有一个像这样的标准表单数组。我需要以 15 分钟为增量计算最多 10 小时的劳动，其中每 15 分钟或每小时 40 小时为 10。是否可以使用 PHP 将其自动化为某种数组，而不是对每个值进行硬编码？似乎应该有更好的方法，我不知道如何开始？

```
<select size="1" name="labor" id="labor">
    <option value="80">2 Hours</option>
    <option value="70">1 Hour 45 min.</option>
    <option value="60">1 Hour 30 min.</option>
    <option value="50">1 Hour 15 min.</option>
    <option value="40">1 Hour</option>
    <option value="30">45 Minutes</option>
    <option value="20">30 Minutes</option>
    <option value="10">15 Minutes</option>
</select> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:09:34.417

您需要两个值，10 个单位的增量和用户显示的值。运行从 1 到 40 的`for`循环`$i`（或其他变量）并计算循环内的值：

*   10 增量很容易，只需乘以`$i`10。
*   对于显示的值，乘以 15 以获得总分钟数。然后使用[模运算符](http://php.net/modulo)（为您提供分钟）和标准除法（以获取小时）将其转换为小时和分钟。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T21:22:11.807

可能最容易对解决方案进行硬编码。我认为这是@Wrikken 提到的可以接受的情况之一，因为它使代码非常干净且易于维护（想象一下在一两年内回到这种情况）。另外这种情况用数据库表也可以很好的处理。

首先使用一个数组来存储你的值和描述：

```
$list = array();
$list['10'] = '15 Minutes';
.... 
```

然后遍历整个数组以生成下拉列表：

```
<select size="1" name="labor" id="labor">
<?php
   foreach($list as $value => $desc){
     $option = "<option value=$value>" . $desc . "</option>";
     echo $option;
   }
?>
</select> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T21:24:03.483

这应该这样做。将 $i 的开始数更改为下拉菜单应包含的总分钟数。现在设置为 750 分钟。

```
echo '<select>';
for ($i = 750; $i >= 15; $i -= 15) {

    $hours = $i / 60;
    $min = $i % 60;

    echo '<option>';

    if ($hours >= 1)
        echo floor($hours)." Hours ";

    if ($min > 1) 
        echo $min." Minutes";

    echo '</option>';
}
echo '</select>'; 
```

NOTE: This code is not perfect, the start number needs to be evenly divided with 15 to generate your desired result, (however, it works).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T21:09:12.670

就像是：

```
<select size="1" name="labor" id="labor">
<?php 
for ($x = 1; $x < 11; $x++) {
    echo '<option value="';
    echo $x*10;
    echo '">';
    echo $x*15;
    echo " Minutes</option>";
}
?>
</select> 
```

在那里添加一个 if 语句来分隔它，以便一旦 (x/10*15)>60 它开始持续数小时而不是 75/90/105/120 分钟。

# z3 - z3 为没有量词的断言产生未知数

> ID：11197344
> 
> 赞同：3
> 
> 时间：2012-06-25T21:03:51.517
> 
> 标签：z3

我有一些简单的约束，涉及 z3 中产生的实数乘法`unknown`。问题似乎是它们被包装在数据类型中，因为未包装的版本会产生`sat`.

这是一个简化的案例：

```
(declare-datatypes () ((T (NUM (n Real)))))

(declare-const a T)
(declare-const b T)
(declare-const c T)

(assert (is-NUM a))
(assert (is-NUM b))
(assert (is-NUM c))

(assert (= c (NUM (* (n a) (n b)))))

(check-sat)
;unknown 
```

并且没有数据类型：

```
(declare-const a Real)
(declare-const b Real)
(declare-const c Real)

(assert (= c (* a b)))

(check-sat)
;sat 
```

我使用的是 z3 3.2，但这也可以在 Web 界面中重现。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-25T21:19:29.633

是的，Z3 可以返回`unknown`无量词问题。以下是主要原因：

*   时间或内存不足

*   无量词片段是不可判定的（例如，非线性整数算术）

*   无量词片段太昂贵，和/或在 Z3 中实现的过程不完整。

您的问题存在于可判定的片段中，而未知数是由于 Z3 中使用的非线性算术程序不完整。Z3 4.0 具有完整的非线性实数运算程序，但仍未与其他理论相结合。所以，它对第一个问题没有帮助。

第一个和第二个查询的行为不同是由于每个查询使用的策略不同。Z3 有一个用于定义自定义策略的新框架。您可以`sat`使用命令获取第一个查询

```
(check-sat-using (then simplify solve-eqs smt)) 
```

代替

```
(check-sat) 
```

第一个命令强制 Z3 通过求解等式（即 tactic `solve-eqs`）来消除变量。它将消除平等`(= c (NUM (* (n a) (n b))))`。Z3 3.x 中的第二个问题自动使用了这种策略。请注意，如果我们将等式替换为 ，此策略将无济于事`(>= c (NUM (* (n a) (n b))))`。

此外，第二个问题只包含非线性算术。因此，在 Z3 4.0 中，将自动使用新的（完整的）非线性实数算术求解器。

[您可以在http://rise4fun.com/Z3/tutorial/strategies](http://rise4fun.com/Z3/tutorial/strategies)，[http:](http://rise4fun.com/Z3Py/tutorial/strategies) //rise4fun.com/Z3Py/tutorial/strategies 了解新的策略框架

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T21:19:27.453

你的例子是非线性算术。Z3 4.0 只能解决非线性算术断言的问题，但不能解决未解释的函数和其他理论。这就解释了为什么它`unknown`在第一个示例中产生。这个限制可能会在 Z3 的未来版本中得到解决。

# mysql - MS Access：在 MS Access 中使用 Single form 输入查询参数

> ID：11197348
> 
> 赞同：1
> 
> 时间：2012-06-25T21:04:18.670
> 
> 标签：mysql, forms, ms-access

一天的赞美。根据之前收到的反馈，

在 MS Access 中创建票务销售数据库后。我想使用单个表单来查询特定月份特定票的价格，并将价格显示在文本字段或标签中的表单中。

以下是示例表和使用的查询

**公司表**

```
CompID    CompName
   A        Ann
   B        Bahn
   C        Can
   KK       Seven
   -        -- 
```

**票务表**

```
 TicketCode    TicketDes

 10            Two people
 11            Monthly
 12            Weekend
 14            Daily 
```

**票价表**

```
 ID    TicketCode    Price    ValidFrom

  1    10            $35.50    8/1/2010
  2    10            $38.50    8/1/2011
  3    11            $20.50    8/1/2010
  4    11            $25.00    11/1/2011
  5    12            $50.50    12/1/2010
  6    12            $60.50    1/1/2011
  7    14            $15.50    2/1/2010
  8    14            $19.00    3/1/2011
  9    10            $40.50    4/1/2012 
```

**使用查询：**

```
SELECT TicketPriceTable.Price
 FROM TicketPriceTable
 WHERE (((TicketPriceTable.ValidFrom)=[DATE01]) AND ((TicketPriceTable.TicketCode)=[TCODE01])); 
```

*   在 MS Access 中，运行查询时会弹出一个迷你框以输入参数。如何使用单个表格输入 [DATE01] 和 [TCODE01] 的参数。以及在文本字段中以相同形式显示的价格（用于进一步计算）。

如 'Month' 字段等于 [DATE01] 参数的输入 'Ticket Code' 等于 [TCODE01] 参数的输入 Textfield 等于查询结果的输出（机票价格）

*   如果可能的话，我想只使用这种格式 MM/YYYY 的月份和年份。日期不是必需的。如何在 MS Access 中实现它？

如果有任何问题，请不要犹豫，非常感谢您的时间和预期的反馈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:17:28.657

您可以使用以下表达式引用表单字段中的值：[Forms]![NameOfTheForm]![NameOfTheField]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:22:51.680

在 Access Forms 中，您可以将 设置`RecordSource`为查询，而不仅仅是表。这可以是存储查询的名称或 SQL 语句的名称。这允许您通过此查询将控件绑定到不同的表。

您还可以在主窗体上放置绑定到除主窗体之外的其他表的子窗体。

您还可以`TextBox`通过将 设置为`ControlSource`以等号开头的表达式，从而在 a 中显示表达式的结果

```
=DLookUp("Price", "TicketPriceTable", "TicketCode=" & Me!cboTicketCode.Value) 
```

* * *

您可以将文本框的格式设置为`MM\/yyyy`或使用格式功能

```
s = Format$(Now, "MM\/yyyy") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T14:50:47.477

### 输入多达 300 种不同类型的门票

^([根据 MS Access 中的月份，](https://stackoverflow.com/q/11037918/880990)回答您关于从票证数据库访问数据的评论）)

您可以使用笛卡尔积来创建大量记录。如果您在查询中选择了两个表但不连接它们，则结果是笛卡尔积，这意味着一个表中的每条记录都与另一个表中的每条记录相结合。

让我们添加一个名为的新表`MonthTable`

```
MonthNr    MonthName
    1      January
    2      February
    3      March
  ...      ... 
```

现在，如果您将此包含 12 条记录的表与`TicketTable`包含 4 条记录的表结合起来，您将得到包含 48 条记录的结果

```
SELECT M.MonthNr, M.MonthName, T.TicketCode, T.TicketDes
FROM MonthTable M, TicketTable T
ORDER BY M.MonthNr, T.TicketCode 
```

你得到这样的东西

```
MonthNr    MonthName   TicketCode  TicketDes
    1      January         10      Two people
    1      January         11      Monthly
    1      January         12      Weekend
    1      January         14      Daily
    2      February        10      Two people
    2      February        11      Monthly
    2      February        12      Weekend
    2      February        14      Daily
    3      March           10      Two people
    3      March           11      Monthly
    3      March           12      Weekend
    3      March           14      Daily
  ...      ...            ...      ... 
```

您还可以获得实际有效的票价类型这样的票

```
SELECT TicketCode, Price, ActualPeriod AS ValidFrom
FROM (SELECT TicketCode, MAX(ValidFrom) AS ActualPeriod
      FROM TicketPriceTable
      WHERE ValidFrom <= Date
      GROUP BY TicketCode) X
    INNER JOIN TicketPriceTable T
        ON X.TicketCode = T.TicketCode AND X.ActualPeriod=T.ValidFrom 
```

这`WHERE ValidFrom <= Date`是在您输入未来价格的情况下。

这里子查询选择实际有效期间，即`ValidFrom`适用于每个`TicketCode`. 如果您发现子选择有点混乱，您还可以将它们存储为 Access 中的查询或 MySQL 中的视图，并基于它们进行后续查询。这样做的好处是您可以在查询设计器中创建它们。

考虑不要以物理方式创建所有 300 条记录，而只是从笛卡尔积中动态获取它们。

我让你现在把所有的部分放在一起。

# c# - 将相同的命名空间拆分到不同的程序集有什么好的理由？

> ID：11197352
> 
> 赞同：2
> 
> 时间：2012-06-25T21:04:35.917
> 
> 标签：c#, visual-studio, dll, namespaces, .net-assembly

我倾向于喜欢在同一个编译程序集中的命名空间内收集类型 - 它使事情易于查找和引用易于管理。

但是，我看到过在项目和程序集之间拆分相同命名空间的示例（换句话说，为了访问完整的命名空间，您必须引用多个 dll）。

谁能给我一些很好的理由为什么你可能想以这种方式安排代码？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:15:33.277

当我编写具有某些需要其他程序集的功能的库时，我通常会发现自己这样做。

例如，我刚刚编写了一些转换器来将 .NET 数据类型转换为 SQL 数据类型。其中大部分我保存在我的标准实用程序库中。然而，转换器`System.Drawing.PointF`显然需要`System.Drawing`. 我没有强制引用我的实用程序命名空间的所有项目来引用`System.Drawing`，而是将我的库的那部分拉到同一命名空间下的单独程序集中。现在，如果您需要转换`PointF`，您可以引用附加程序集，并在与所有其他程序集相同的命名空间中找到转换器。

[我实际上在Programmers.SE](https://softwareengineering.stackexchange.com/q/144472/30039)上问过这个问题。

# java - Java：切片字符串

> ID：11197353
> 
> 赞同：4
> 
> 时间：2012-06-25T21:04:37.590
> 
> 标签：java

我的 URL 总是以数字结尾，例如：

```
 String url = "localhost:8080/myproject/reader/add/1/";
  String anotherurl = "localhost:8080/myproject/actor/take/154/"; 
```

我想提取最后两个斜杠（“/”）之间的数字。

有谁知道我该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-25T21:06:15.127

您可以拆分字符串：

```
String[] items = url.split("/");
String number = items[items.length-1]; //last item before the last slash 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T21:21:29.150

使用正则表达式：

```
final Matcher m = Pattern.compile("/([^/]+)/$").matcher(url);
if (m.find()) System.out.println(m.group(1)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T21:14:07.870

使用`lastIndexOf`，像这样：

```
 String url = "localhost:8080/myproject/actor/take/154/";
 int start = url.lastIndexOf('/', url.length()-2);
 if (start != -1) {
     String s = url.substring(start+1, url.length()-1);
     int n = Integer.parseInt(s);
     System.out.println(n);
 } 
```

这是基本的想法。您必须进行一些错误检查（例如，如果在 URL 末尾找不到数字），但它会正常工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-25T21:31:16.083

对于您指定的输入

```
String url = "localhost:8080/myproject/reader/add/1/";
String anotherurl = "localhost:8080/myproject/actor/take/154/"; 
```

添加一些错误处理来处理丢失的“/”，例如

```
String url = "localhost:8080/myproject/reader/add/1"; 
String anotherurl = "localhost:8080/myproject/actor/take/154";

String number = "";
if(url.endsWith("/") {
  String[] urlComps = url.split("/");
  number = urlComps[urlComps.length-1]; //last item before the last slash
} else {
  number = url.substring(url.lastIndexOf("/")+1, url.length());
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-25T21:34:03.783

在一行中：

```
 String num = (num=url.substring(0, url.length() - 1)).substring(num.lastIndexOf('/')+1,num.length()); 
```

# javascript - 地图未使用融合表从 Javascript 显示

> ID：11197356
> 
> 赞同：0
> 
> 时间：2012-06-25T21:05:06.230
> 
> 标签：javascript, google-fusion-tables

我有这个正在处理的 javascript，但 HTML 中的地图没有显示。我有一个与 layer_1 类似的融合表，它显示得很好，但是当我放置 layer-2 而不是 layer_1 并使用相同的代码提取不同的 tableid 时。地图不显示。

```
var tableid_2 = 431xxxx; 
var layer_2;
var queryUrlHead = 'http://www.google.com/fusiontables/api/query?sql=';
var queryUrlTail = '&jsonCallback=?';
var zoom = 7;
var latlng = new google.maps.LatLng(3x.7996, -11x.1668);

function initialize() {

var myOptions = {
    zoom : zoom,
    center : latlng,
    mapTypeId : google.maps.MapTypeId.TERRAIN,
    mapTypeControl: true,
    mapTypeControlOptions: {
    style: google.maps.MapTypeControlStyle.HORIZONTAL_BAR,
    position: google.maps.ControlPosition.TOP_LEFT
},
scaleControl: true,
scaleControlOptions: {
position: google.maps.ControlPosition.BOTTOM_LEFT
},
};

var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

layer_2 = new google.maps.FusionTablesLayer(tableid_2);
var qry = "SELECT 'Location2', 'Name2','URL' FROM " + tableid_2;
layer_2.setMap(map);

layer_2.enableMapTips({
    select: "'Name2'",
    from: tableid_2,
    geometryColumn: 'Location2', 
    suppressMapTips: false, 
    delay: 50,
    tolerance: 5
});
addListeners();

layer_2.setQuery(qry);

var col_list = 'Name2';

if(order_list && order_list !== 'Name2') {
    query += " ORDER BY " + order_list;
}

var queryurl = encodeURI(queryUrlHead + qry + queryUrlTail);

$.ajax({
    type : "GET",
    url : queryurl,
    dataType : "jsonp",
    success : dataHandlerCallback,
    error : function() {
        alert("AJAX ERROR for " + queryurl);
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T22:48:58.067

确保你的融合表是公开的，否则它不会出现。

# git - Git：撤消合并失败后的本地更改

> ID：11197357
> 
> 赞同：4
> 
> 时间：2012-06-25T21:05:09.583
> 
> 标签：git, git-merge, git-rebase

我让自己陷入了一种看起来相当不寻常的情况，并且基本上想将我的工作状态分成两个提交。一个是合并提交，另一个是它自己的实质性提交。

**这是发生了什么：**

1.  我保存了我的工作状态`git stash`
2.  `git rebase master`
3.  查看一些合并冲突，修复它们
4.  `git stash pop`
5.  在有冲突的文件上工作一段时间

请注意，我忘记提交合并冲突的修复程序，因此这些文件仍被标记为冲突。但他们也有我不想要的本地更改。

# 目标

一次提交解决合并冲突，一次提交包含我的本地更改。如何将当前（冲突）状态拆分为这两个提交？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:22:19.027

在我的脑海中，并且没有处于类似状态的回购可以玩，最好的计划可能`git stash`是当前状态（正在进行合并加上新工作），然后`git reset`回到合并之前。然后重做合并，并记住提交。然后`git stash pop`，但是当你这样做时，你可能最终会得到与合并冲突相反的结果。

`git add -i`除非您可以通过et专门挑选出来自合并的块与您的额外工作。al.，或者如果合并或额外的工作微不足道，足以折腾并重新开始......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T21:25:52.113

你可以做一个`git rebase --abort`（因为你正在做一个变基），`git stash`再做一次，然后`git rebase`再试一次，并用 . 解决冲突`git mergetool`。当你完成冲突后，`git rebase --continue`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T18:43:08.720

我找到了自己的解决方案，该解决方案有效，因为我的更改是 diff 中的单独块。这是我所做的：

1.  `git add`所有未合并的文件，使我的工作树进入可用状态
2.  `git reset`取消暂存这些文件
3.  选择要提交的特定块`git add --patch`

这个解决方案的缺点是第一次提交没有任何关于导致它的合并冲突的自动元数据。

# html - 旧版 Firefox 中出现的奇怪角色

> ID：11197358
> 
> 赞同：0
> 
> 时间：2012-06-25T21:05:15.343
> 
> 标签：html, firefox, ascii

出于某种原因，这个 () 字符在我的网站中随机出现在 Firefox 10 中，但不会出现在其他浏览器中。我不确定 Stack Overflow 是否会渲染它，所以我附上了发生这种情况的一个区域的屏幕截图。它看起来像 ASCII 编码......有什么想法吗？ ![在此处输入图像描述](../Images/510fbaff7d41e991a53881b8cf617fa1.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:18:16.970

有问题的符号是`Unicode Character 'END OF TEXT' (U+0003)`, 看起来它是由某个编辑器或其他东西插入到原始文本中的 - 它已成功复制到您的 HTML 文件中。）只要找到并用火替换它们，我说！

# google-maps - 渲染航点

> ID：11197361
> 
> 赞同：-1
> 
> 时间：2012-06-25T21:05:48.717
> 
> 标签：google-maps, google-maps-api-3

我正在编写一个可以在地图中单击的代码，将信息解析为我的谷歌地图路线并将 LatLng 保存在我的数据库中。那部分，没关系，它正在工作。我页面的第二部分将呈现它在我的数据库中的 LatLng。问题来了：当我请求路线（DirectionsResult 对象或 DirectionsRoute）时，如何创建像 google 这样的对象？如果我试图做的事情是错误的，请有人告诉我如何做对。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:23:40.943

您可能想看看 google api 游乐场：[http ://code.google.com/apis/ajax/playground/#polylines_v3](http://code.google.com/apis/ajax/playground/#polylines_v3)

此示例用于打印路线：

```
function initialize() {
  var mapDiv = document.getElementById('theMapCanvas');
  var map = new google.maps.Map(mapDiv, {
    center: new google.maps.LatLng(0, -180),
    zoom: 2,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  });
  var path = [new google.maps.LatLng(37.772323, -122.214897),
    new google.maps.LatLng(21.291982, -157.821856),
    new google.maps.LatLng(-18.142599, 178.431),
    new google.maps.LatLng(-27.46758, 153.027892)];

  var line = new google.maps.Polyline({
    path: path,
    strokeColor: '#ff0000',
    strokeOpacity: 1.0,
    strokeWeight: 2
  });

  line.setMap(map);
} 
```

# c# - C# 倒数累加定时器

> ID：11197366
> 
> 赞同：0
> 
> 时间：2012-06-25T21:06:02.457
> 
> 标签：c#, timer, countdown

我有一个应用程序，我将在其中显示一个计时器。

用户将执行一个事件并应在一定时间内完成它。我目前有一个计时器，可以显示他们的时间滴答作响，但我现在想要的是总累积时间。因此，每次新事件开始时，完成事件的时间都会添加到它们的累积时间中。然后，当他们执行事件时，时间会在累积的时间上打勾。

这就是我所拥有的“当前计时器”

```
u.StartingTime = u.ChangeOverStandard;
u.CurrentChangeOverTime = u.StartingTime - (DateTime.Now - u.ChangeOverStart); 
```

所有这些字段都是时间跨度。这非常适合他们的“当前”计时器

但是我需要一个“总”计时器，它要么显示一个正的时间跨度值……如果他们在他们应该完成之前完成……或者如果他们花费的时间太长，则显示一个负的时间跨度值。

编辑：

所以我想实现这个：

例如：对于“事件 1”，用户有 30 秒。结束。然后用户有一个“TotalTimespan”属性= 30。这个总数随着事件计时器而减少。假设他在 24 秒内完成。这意味着他在 TotalTimespan 中还剩 6 秒。然后“event2”必须在 40 秒内完成。所以在 event2 开始时，TotalTimespan = TotalTimespan(6) + 40\. = 46。如果用户使用 60 秒，那么 TotalTimespan = 46 -60 = -14。

“定时器”不是定时器，不能用作定时器。它在后台工作人员上运行，后台工作人员也在进行其他一些计算。所以我不能一秒一秒地取消时间。

在每个新活动中，我都尝试过

```
u.AccumulatedTime += u.ChangeOverStandard; 
```

接着

```
u.AccumulatedTime -= u.StartingTime - (DateTime.Now - u.ChangeOverStart); 
```

但显然这行不通，因为它通过我的循环从每一轮的累积时间中花费总经过的时间

```
DateTime.Now - u.ChangeOverStart 
```

^^会给我从活动开始到现在经过的时间，所以这是我想要的吗？

```
u.AccumulatedTime -= DateTime.Now - u.ChangeOverStart; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-03-23T17:37:15.380

您只需要一个 TimeSpan 和两个 DateTime 静态（全局）变量来跟踪时间并进行计算。这是使用您描述的数字的示例：

```
 TimeSpan left = new TimeSpan(0, 0, 30);  //30 seconds allowed for task.
        DateTime start = DateTime.UtcNow;
        //User perform action.
        System.Threading.Thread.Sleep(24000); //24 sec wait.
        DateTime stop = DateTime.UtcNow;
        left = left - (stop - start);
        Console.WriteLine(Math.Ceiling((double)left.TotalSeconds));
        //Output was: 6
        left = left + new TimeSpan(0, 0, 40);  //40 seconds allowed for task.
        start = DateTime.UtcNow;
        //User perform action.
        System.Threading.Thread.Sleep(60000); //60 sec wait.
        stop = DateTime.UtcNow;
        left = left - (stop - start);
        Console.WriteLine(Math.Ceiling((double)left.TotalSeconds));
        //Output was: -14
        left = left + new TimeSpan(0, 0, 30);  //30 seconds allowed for task.
        Console.WriteLine(Math.Ceiling((double)left.TotalSeconds));
        //Output was: 16 
```

如您所见，最后的剩余时间是您所期望的 16 秒。

# batch-file - 循环遍历 1 个文件夹中的文件，而不是任何子文件夹批处理

> ID：11197368
> 
> 赞同：2
> 
> 时间：2012-06-25T21:06:05.753
> 
> 标签：batch-file, for-loop, directory

我正在尝试遍历根文件夹中所有 .properties 扩展名的文件：“C:\ExecutionSDKTest_10.2.2\，但不是该根文件夹中的任何子文件夹，我怎样才能达到这个结果？代码如下：

```
 FOR /R "C:\ExecutionSDKTest_10.2.2\" %%G IN (*properties) DO Echo %%G 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-25T21:16:07.853

不要使用 FOR 命令的 /R 选项。

试一试

```
 FOR %%G IN (C:\ExecutionSDKTest_10.2.2\*.properties) DO Echo %%G 
```

# bash - 为什么我在 Bash 条件中使用 NOT 运算符得到“找不到命令”？

> ID：11197369
> 
> 赞同：1
> 
> 时间：2012-06-25T21:06:09.960
> 
> 标签：bash, if-statement

如果我有

```
if [ ! -e $dir ];
then
 mkdir $dir
fi 
```

工作，但不是

```
[[ ! -e $dir ]] || mkdir $dir 
```

为什么 ？

## 编辑 0

`[[ ...`我得到

```
 line 34: [[ !: command not found 
```

## 编辑 1

```
bash --version
GNU bash, version 3.2.25(1)-release (i686-redhat-linux-gnu)
Copyright (C) 2005 Free Software Foundation, Inc. 
```

## 编辑 2

在某些情况下工作，在某些情况下不工作，两个连续的命令

```
[user@host ~]$ [ -e /tmp ] && date
-bash: [: missing `]'
[user@host ~]$ [ -e /tmp ] && date
mar jun 26 10:05:50 CLT 2012 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T21:09:46.200

你应该使用

```
[ ! -e $dir ] && mkdir $dir 
```

单个“[”是调用测试的快捷方式，因此适用测试语法。双“[[”改为使用bash的逻辑语法，这是完全不同的。

既然你想在测试返回真时执行命令，你应该使用“&&”——“||” 仅当测试返回 false 时，语法才会运行您的命令。

编辑：

检查 bash 手册页会发现条件表达式（使用 [[] 得到的）也理解 -e 语法。该部分没有提到“！” 否定结果，尽管在命令行上尝试它时它可以工作。我的猜测是，您的系统可能正在运行与评论者不同的 bash 版本，一个不理解“！”的系统。? test 的手册页清楚地表明“！” 受支持，因此在您的情况下，我将首先尝试使用 [ ] 并查看它是否有效，然后再进一步探索。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T17:59:49.747

尤其是在编辑 2 之后，在我看来，这真的像是“有趣”字符的问题，要么是混入非打印字符，要么是看起来正常但奇怪的字符，如不间断空格。这些可能很难检测到；在编辑器中事情看起来完全正常，即使您查看带有类似内容的脚本`cat -v`也不会总是清楚地显示有趣的字符。如果您`xxd`的系统上有，这是一个非常好的方法来准确查看文件中的内容。这是此类问题的快速演示：

```
$ cat -v nbsptest 
#!/bin/bash -x
[ -e /tmp ] && date
[ -e /tmp ] && date
[ -e /tmp ] && date
$ ./nbsptest 
+ '[ -e' /tmp ']'
./nbsptest: line 2: [ -e: command not found
+ '[' -e '/tmp ]'
./nbsptest: line 3: [: missing `]'
+ '[' -e /tmp ']'
+ date
Sat Jun 30 10:53:56 PDT 2012
$ xxd nbsptest 
0000000: 2321 2f62 696e 2f62 6173 6820 2d78 0a5b  #!/bin/bash -x.[
0000010: c2a0 2d65 202f 746d 7020 5d20 2626 2064  ..-e /tmp ] && d
0000020: 6174 650a 5b20 2d65 202f 746d 70c2 a05d  ate.[ -e /tmp..]
0000030: 2026 2620 6461 7465 0a5b 202d 6520 2f74   && date.[ -e /t
0000040: 6d70 205d 2026 2620 6461 7465 0a         mp ] && date. 
```

该脚本看起来完全正常`cat -v`（和`more`，，`vi`等），但前两个命令失败。 说明原因：第一个命令在和`xxd`之间有一个 UTF-8 不间断空格（这在十六进制列表中显示为 c2a0，在文本列表中），第二个命令在和之间有一个不间断空格（在文本列表中）。`[``-e``[..-e``/tmp``]``/tmp..]`

显示`-x`（我曾经`bash -x`调用它，您也可以`set -x`按照@CodeGnome 的建议使用）也提示了正在发生的事情。对于第一个命令，它将其列为`'[ -e' /tmp ']'`-- 注意 周围的引号`[ -e`，这表明 shell 将所有这些都视为一个“单词”，这意味着它不认为它是中间的空格。类似地，第二个命令显示为`'[' -e '/tmp ]'`带有引号，表明它认为`/tmp ]`都是一个“单词”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:11:30.883

### 语法作品

至少，它对我有用。例如：

```
# Inverted logic. Returns false because directory exists.
$ [[ ! -e /tmp ]]; echo $?
1 
```

你确定你使用的是 Bash 吗？检查您的外壳和版本。

```
$ echo $SHELL $BASH_VERSION
/bin/bash 4.2.10(1)-release 
```

### 更好的方法

您的条件逻辑有点复杂。对于您想要做的事情，这是一种更简洁的语法：

```
dir=/tmp/foo
[[ -e "$dir" ]] || mkdir "$dir" 
```

这在语义上更清晰，并且在没有倒置逻辑的情况下表达了意图。可能存在您需要反向测试的情况，但您的示例不是其中之一。

# asp.net-mvc - ASP .NET MVC 图表助手添加标记

> ID：11197372
> 
> 赞同：1
> 
> 时间：2012-06-25T21:06:29.587
> 
> 标签：asp.net-mvc, helper, asp.net-charts

我有一个柱形图（每个区域的总分）。我想在列的顶部显示实际点。我相信这叫做标记？这是我的代码：

```
var myChart = new Chart(width: 800, height: 500, theme: myTheme)
.AddTitle("Region Report")
.SetXAxis("Region")
.SetYAxis("Total Points")  
.AddSeries("RegionReport", chartType: "Column",
xValue: Model, xField: "Region",
yValues: Model, yFields: "TotalPoints")
.Write(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T22:59:53.413

如果要显示列值（或任何数据值）的标记顶部，则需要先创建一个系列，然后对特定系列使用**IsValueShownAsLabel=true**来显示该值。

您编写上述控制器功能的方式，您将无法显示它，因为 Chart Helper 不支持它。

这是一个示例，说明如果您使用 Series，您可以如何做到这一点。将以下函数添加到您的控制器：

```
 public ActionResult ShowChart()
    {
        Bitmap image = new Bitmap(500, 50);
        Graphics g = Graphics.FromImage(image);
        System.Web.UI.DataVisualization.Charting.Chart myChart = new System.Web.UI.DataVisualization.Charting.Chart();
        myChart.Width = 600;
        myChart.Height = 300;
        myChart.ChartAreas.Add("xSeries").BackColor = System.Drawing.Color.FromArgb(64, System.Drawing.Color.White);
        // create a couple of series  
        myChart.Series.Add("xSeries");
        // add points to xSeries  
        myChart.Series["xSeries"].Points.AddY(83);
        myChart.Series["xSeries"].Points.AddY(49);
        myChart.Series["xSeries"].Points.AddY(94);
        myChart.Series["xSeries"].Points.AddY(65);
        // add points to ySeries  
        myChart.Series["xSeries"].IsValueShownAsLabel = true;
        myChart.BackColor = Color.Transparent;
        MemoryStream imageStream = new MemoryStream();
        myChart.SaveImage(imageStream, ChartImageFormat.Png);
        myChart.TextAntiAliasingQuality = TextAntiAliasingQuality.SystemDefault;
        Response.ContentType = "image/png";
        imageStream.WriteTo(Response.OutputStream);
        g.Dispose();
        image.Dispose();
        return null;
    } 
```

然后在您看来如下调用它：

```
<img src="@Url.Action("ShowChart")" alt="MyChart" /> 
```

# iphone - 客户未发现 bonjour 服务

> ID：11197373
> 
> 赞同：2
> 
> 时间：2012-06-25T21:06:34.763
> 
> 标签：iphone, cocoa-touch, bonjour, nsnetservice, nsnetservicebrowser

我刚刚开始学习设计 iphone 应用程序，并且正在尝试设置客户端服务器环境。作为初学者，我想首先确保我发布的服务对客户端是可见的。我在 Apple 文档的帮助下编写了服务器和客户端代码。但是，我发现虽然我的服务正在发布（调用了 netServiceWillPublish(NSNetService *)sender），但我的客户端并未识别此服务。在客户端调用委托函数 netServiceBrowserWillSearch:(NSNetServiceBrowser *)browser 使我相信客户端正在搜索服务。但是 didFindService 委托函数永远不会被调用。我很困惑为什么这不起作用。我已经从各个地方遵循了客户端的示例代码，并且我的代码与他们的代码相匹配。

我还有以下问题

1.  服务名称（随传输层协议一起提供）可以是任何字符串吗？还是必须在[http://www.dns-sd.org/ServiceTypes.html](http://www.dns-sd.org/ServiceTypes.html)中指定。除了服务发现之外，这还有什么目的。

2.  当我在服务器端打印出 NSNetService 对象的详细信息时（在设置套接字并启动服务之后），主机名被打印为（null）并且没有显示地址。从技术上讲，当服务打开时，这些不应该设置为值吗？如果是的话，有人可以告诉我我的代码哪里出错了吗？

我已经附加了我的项目的客户端和服务器代码块，其中完成了服务的发布和浏览。非常感谢您的帮助，因为我一直在处理这个问题。

这是浏览服务的客户端的代码片段

```
NSNetServiceBrowser *serviceBrowser;
serviceBrowser = [[NSNetServiceBrowser alloc] init];
[serviceBrowser setDelegate:self];
[serviceBrowser searchForServicesOfType:@"_http._tcp." inDomain:@"local."]; 
```

这是发布服务的服务器端的代码片段

```
BOOL                success;
int                 fd;
int                 err;
int                 junk;
struct sockaddr_in  addr;
NSInteger           port;

port = 0;

fd = socket(AF_INET, SOCK_STREAM, 0);
success = (fd != -1);
if(success) {
    memset(&addr, 0, sizeof(addr));
    addr.sin_len = sizeof(addr);
    addr.sin_family = AF_INET;    
    addr.sin_port = 0;
    addr.sin_addr.s_addr = INADDR_ANY;
    err = bind(fd, (const struct sockaddr*) &addr, sizeof(addr));
    success = (err == 0);
}

if (success) {
    err = listen(fd, 5);
    success = (err == 0);
}

if (success) {
    socklen_t addrLen;
    addrLen = sizeof(addr);
    err = getsockname(fd, (struct sockaddr *) &addr, &addrLen);
    success = (err == 0);

    if (success) {
        assert( addrLen = sizeof(addr));
        port = ntohs(addr.sin_port);
    }
}

if (success) {
    CFSocketContext context = { 0, (__bridge void *) self, NULL, NULL, NULL };

    assert(self->_listeningSocket == NULL);
    self->_listeningSocket = CFSocketCreateWithNative(NULL, fd, kCFSocketAcceptCallBack, AcceptCallBack, &context);

    success = (self->_listeningSocket != NULL);

    if (success) {
        CFRunLoopSourceRef rls;
        fd = -1;    //listeningSocket is now responsible for closing the socket
        rls = CFSocketCreateRunLoopSource(NULL, self.listeningSocket, 0);
        assert(rls != NULL);
        CFRunLoopAddSource(CFRunLoopGetCurrent(), rls, kCFRunLoopDefaultMode);
        CFRelease(rls);
    }
}

if (success) {
    self.netService = [[NSNetService alloc] initWithDomain:@"local." type:@"_http._tcp." name:@"test" port:port];
    success = (self.netService != nil);
}
if (success) {
    self.netService.delegate = self;
    [self.netService publishWithOptions:NSNetServiceNoAutoRename];

}

if (success) {
    assert(port != 0);
    [self serverDidStartOnPort:port];
}
else {
    [self stopServer:@"Start Failed"];
    if (fd != -1) {
        junk = close(fd);
        assert(junk == 0);
    }
} 
```

这是告诉服务已发布并打印出我的 NSSocket 对象的详细信息的代码片段

```
- (void)netServiceWillPublish:(NSNetService *)sender {
    NSLog(@"This function is getting called");
    NSLog(@"sender.name %@",sender.name);
    NSLog(@"sender.addresses %@",sender.addresses);
    NSLog(@"sender.domain %@",sender.domain);
    NSLog(@"sender.hostname %@",sender.hostName);
    NSLog(@"sender.type %@",sender.type);
    NSLog(@"sender.port %d",sender.port);
} 
```

谢谢维韦克
_

# fedora - 创建一个还可以操作文件和添加用户的 RPM

> ID：11197374
> 
> 赞同：6
> 
> 时间：2012-06-25T21:06:35.623
> 
> 标签：fedora, rpm, rpmbuild, rpm-spec

我正在尝试在 Fedora 15 中创建一个 RPM 来安装我的软件，但是为了让我的软件在安装后能够正常工作，我还需要编辑系统上的其他（配置）文件、添加用户/组等。只有 root 用户才允许执行其中一些任务。我知道永远不要以 root 用户身份创建 RPM，而且我理解为什么这是个坏主意。但是，如果我将 shell 脚本语句添加到我的规范文件（%post、%prep...任何部分）以编辑必要的文件、添加用户/组等，我的 rpmbuild 命令将失败并显示消息“Permission denied”（不是出奇）。

处理这个问题的最佳方法是什么？我是否必须告诉我的用户先安装我的包，然后以 root 身份运行一个 shell 脚本来配置它？这似乎不是很优雅。我希望允许用户使用一个简单的命令（例如“yum install mysoftware”）来完成所有操作。

我的大部分研究表明，也许这甚至不应该通过 RPM 来完成。[我已经阅读了Maximum RPM](http://www.rpm.org/max-rpm/)的许多部分，以及许多其他好的资源，但还没有找到我要找的东西。我是创建 RPM 的新手，但已经能够为我的软件成功创建一个简单的规范文件......在解压缩包并将其安装到正确位置后，我无法正确配置所有内容。非常感谢任何输入！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-26T01:56:11.543

`useradd`应该运行`%pre`并且不应该在`rpmbuild`. 这是标准的做法。我会推荐[包装指南](http://fedoraproject.org/wiki/Packaging:Guidelines)，特别是关于[用户和组](http://fedoraproject.org/wiki/Packaging:UsersAndGroups)的部分。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-26T20:54:05.033

`%pre`RPM文件的部分`.spec`应检查安装软件所需的所有条件。
您的`%post`RPM`.spec`文件部分应进行软件运行所需的所有修改。
为避免在`%post`您的 RPM`.spec`文件部分中出现文件权限错误，您可以在该部分中设置文件权限和所有权`%files`。这样，安装 RPM 的用户就拥有修改配置文件的适当权限。

```
%install
# Copy files to directories on your installation server

%files
# Set file permissions and ownership on your installation server
%attr(775, myuser, mygroup) /path/to/my/file

%pre
# Check if custom user 'myuser' exists. If not, create it.
# Check if custom group 'mygroup' exists. If not, create it.
# All other checks here

%post
# Perform post-installation steps here, like editing other (configuration) files.
echo "Installation complete." 
```

# ios - 在 CCScrollLayer (cocos2d iOS) 中控制触摸

> ID：11197383
> 
> 赞同：0
> 
> 时间：2012-06-25T21:07:15.917
> 
> 标签：ios, cocos2d-iphone, scroll, ccscrolllayer

我的应用程序中有一个 CCScrollLayer，其中包含可移动的精灵（它们可以拖放）。问题是当精灵拖得太远时，CCScrollLayer 开始滚动。只要我拖动这些精灵，我就会尝试禁用 CCScrollLayer 滚动。通过使用禁用工作

```
[[CCTouchDispatcher sharedDispatcher] removeDelegate:sender]; 
```

我从方法中获取发件人

```
- (void)scrollLayerScrollingStarted:(CCScrollLayer *)sender {
    //...
} 
```

我无法再次启用 CSScrollLayer，尝试了这个但没有结果：

```
[[CCTouchDispatcher sharedDispatcher] addTargetedDelegate:scrollLayer priority:0 swallowsTouches:NO]; 
```

我正在使用 v1.0.1（稳定版）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T22:02:03.690

您可以继承 CCScrollLayer 并添加一个启用的布尔属性。只需覆盖 CCScrollLayer 用来开始滑动的触摸方法。例如

```
-(BOOL)ccTouchBegan:(UITouch *)touch withEvent:(UIEvent *)event
{
     if(self.enabled)
           return [super ccTouchBegan:touch withEvent:event];
     else
           return NO;
} 
```

# jquery - In an Asp.net MVC view, how do I use jQuery to parse the XML just returned from a controller

> ID：11197390
> 
> 赞同：2
> 
> 时间：2012-06-25T21:07:47.247
> 
> 标签：jquery, asp.net

In my MVC view (using VS 2012 RC), I'm attempting to parse the XML freshly returned from my Controller. Here is my view code:

```
@model RzMvc.Models.PortfolioResponse
@{
    ViewBag.Title = "PortfolioList";
}              

<script type="text/javascript">

    $(displayXmlResponse);

    function displayXmlResponse(){
        var resp = $("#xmlResp");
        $("#xmlTest").append(resp.children());

        var xml = $("xmlResp").text;      
            xmlDoc = $.parseXML(xml),
            $xml = $(xmlDoc),
            $title = $xml.find("portfolioSummary");            

        $("#xmlTest").append($title.text());      
    }    

</script>

<h2>PortfolioList</h2>

<div>
    <p id="xmlTest"></p>
    <p id="xmlResp" >@Model.XmlPortfolioResponse</p>    
</div> 
```

The browser output looks like this:

> PortfolioList
> 
> Portfolio Listing
> 
> System.Xml.XmlDocument

Any guidance would be greatly appreciated. Here's part of my Controller code:

```
 public ActionResult PortfolioList()
{
    XmlDocument xmlResponse = new XmlDocument();
    xmlResponse.LoadXml(portfoliosResponse);
    var portf = new PortfolioResponse { XmlPortfolioResponse = xmlResponse };

    return View(portf);
} 
```

Model code is:

```
namespace RzMvc.Models
{

    public class PortfolioResponse
    {
        public XmlDocument XmlPortfolioResponse { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:53:08.873

The problem is that you are returning a `PortfolioResponse` object, but setting the value of its `XmlPortfolioResponse` property to be equal to the `XmlDocument` itself, rather than it's output. This makes the default C# output when you bind to the screen occur - which is to simply call `PortfolioResponse.XmlPortfolioResponse.ToString()` - which will, unless overloaded, return the name of the `Object`'s class. Hense - you are getting `System.Xml.XmlDocument` output to your HTML.

What you need to do, first and foremost, is bind `@Model.XmlPortfolioResponse.OuterXml` to your view page, rather than `@Model.XmlPortfolioResponse`. You will also most likely have to wrap this value in a `@Html.Raw()` call in order to get it to actually render appropriately.

Your new binding in the View page might look something like this:

```
<div class='XmlTest'></div>
<div class='XmlPortfolioResponse'>
 @Html.Raw(Model.XmlPortfolioResponse.OuterXml.ToString())
</div> 
```

For your JQuery, then, to parse it, you would do something like:

```
var $title = $('.XmlPortfolioResponse').find('portfolioSummary').text();
$('.XmlTest').text($title); 
```

However, you might consider a more elegant approach than binding raw XML into your page, then parsing it / reformatting it / re-displaying it - which leads to DOM bloat and a lot of extra work in processing. I would suggest one of 2 approaches:

1) Output XML and style the XML directly. CSS is more than capable of styling the XML you're outputting and making it appear as you wish - **assuming you aren't making major changes to format**. An example might look like:

```
<div class='XmlPortfolioResponse'>
  <portfolioSummary>
    <value>123456.78</value>
    <assets>
      <asset>
        <ticker>XYZ</ticker>
        <quantity>50</quantity>
        <value>456.78</value>
      </asset>
    </assets>
  </portfolioSummary>
</div> 
```

If you have this kind of XML - low on attributes, but well normalized - you could write a stylesheet like:

```
portfolioSummary {
    display: block;
    border: 1px solid #eee;
    background: #fff;
    position: relative;
    margin-top: 25px;
    width: 100%;
    height: 100%;
    /* Whatever other styles you want for layout */
}
portfolioSummary value {
    float: right;
    font-weight: bold;
    position: absolute;
    top: 5px; right: 5px;
}
portfolioSummary asset {
    display: block;
}
/* Etc. */ 
```

In other words - directly style the XML.

2) If, however, you have XML like the following:

```
<div class='XmlPortfolioResponse'>
  <portfolioSummary value='123456.78'>
   <asset value='456.78' ticker='XYZ'>
   </asset>
  </portfolioSummary>
</div> 
```

In other words, heavy on attributes which don't lend themselves to styling... Consider loading the data via AJAX. Your JQuery would then change to something like:

```
$.ajax({
    url: '/Portfolio/Load/12345',
    type: 'POST',
    async: true,
    success: function (data) {
        if (!data) // do validation
            alert('failed!');
        else {
            var $xml = $(data);
            var $title = $xml.find('portfolioSummary').text();
            $('.XmlTest').text($title);
        }
    },
    error: function (error) {
        alert('failed!');
    }
}); 
```

In order to use the `$.ajax()` method at the bottom, you need a controller method which is something like the following:

```
[HttpGet] // Original Method - allows GET
public ActionResult PortfolioList {
    return View(GetPortfolios()); // Or however you load them...
}

[HttpPost] // Allows this method to be accessed via POST calls
[ActionName("PortfolioList")]
public JsonResult PortfolioList_Async {        
    return Json(GetPortfolios()); // You may need to resolve serialization here,
                                  // but usually it works well out of the box.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:26:35.983

You'll need to convert your XmlDocument to a string before you send it to the client. The easiest way to do this is to call `.OuterXml`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:40:40.037

In controller itself convert the xml data into object of your need like list of portfoliosummaries and then pass that object using viewdata or viewbag to view.

```
 XmlNodeList elemList =xmlresponse.DocumentElement.GetElementsByTagName("portfoliosummary");
            List<string> lstportfoliosummarys= new List<string>();
            for (int i = 0; i < elemList.Count; i++)
            {
                if (elemList[i].ChildNodes[1].InnerText == "portfoliosummary")
                    lstEmails.Add(elemList[i].ChildNodes[2].InnerText);
            }
            ViewBag.contacts = new SelectList(lstportfoliosummarys); 
```

Hope this will help you.

# odbc - 您应该使用 ODBC 还是注册表项进行数据连接？

> ID：11197391
> 
> 赞同：0
> 
> 时间：2012-06-25T21:07:56.803
> 
> 标签：odbc

我支持一组开发人员，他们告诉我为他们在 asp.net 中创建的应用程序设置一个注册表项，以连接到我们的 SQL 后端。从 ODBC 连接执行此操作不是更好吗？这是懒惰的编程还是这是常见的做法？

如果他们的所有连接都在注册表项中，我将如何启动 DRP 站点以防我们遇到问题？现在我们复制内容，如果数据库连接在 ODBC 中而不是重做所有这些注册表项，这将容易得多。（有多个应用程序这样做）。

请填写。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:10:38.303

为什么他们不使用 web.config 来存储连接字符串？[http://msdn.microsoft.com/en-us/library/ms178411.aspx](http://msdn.microsoft.com/en-us/library/ms178411.aspx)

# mysql - 为什么 mysql_config 报告错误的套接字文件位置？

> ID：11197396
> 
> 赞同：1
> 
> 时间：2012-06-25T21:08:26.323
> 
> 标签：mysql

mysql_config 程序将套接字文件位置报告为：

```
/var/lib/mysql/mysql.sock 
```

但是在 /etc/my.cnf 中，位置被明确的表述为：

```
/tmp/mysql.sock 
```

当我使用“mysqladmin variables”检查套接字时，它报告正确。为什么 mysql_config 不正确，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T21:29:05.107

[`mysql_config --socket`](http://dev.mysql.com/doc/refman/5.5/en/mysql-config.html#option_mysql_config_socket)显示“*配置 MySQL 时定义的**默认*Unix 套接字文件”（即在编译时）。

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T10:11:05.383

您使用的是什么操作系统？

我使用 OSX，它很少使用默认位置，嗯，任何东西！

'/tmp/mysql.sock' 值是 my.cnf 开箱即用的默认值，据我所知，您应该更改 my.cnf 以反映您在环境中的套接字位置。

在 MAMP（用于 OSX 的 apache、mysql、php 包）中，它位于“Applications/MAMPP/tmp/mysql/mysql.sock”中

```
MAMP my.cnf [default]
# The MySQL server
[mysqld]
#port       = 9999
socket      = /Applications/MAMP/tmp/mysql/mysql.sock 
```*

# ruby-on-rails - Rails - 查看文件 - 如何避免每个控制器操作一个 html 文件和一个 js 文件？

> ID：11197397
> 
> 赞同：0
> 
> 时间：2012-06-25T21:08:30.830
> 
> 标签：ruby-on-rails, views

作为 Rails 的新手并且目前正在构建一个项目，我开始处于我的视图文件夹增长过多的情况

我有例如：
/app/
../views/
..../comments/
....../_comment.html.erb
....../_comments_count.html.erb
...... /_form.html.erb
....../create.js.erb
....../destroy.js.erb
....../edit.html.erb
....../edit .js.erb
....../index.html.erb
....../index.js.erb
....../new.html.erb
....../show.html .erb
....../update.js.erb

我绝对希望有 2 个文件：
comments.html.erb
comments.js.erb

在每个内部（如在控制器中）每个动作都有一个部分。

目前，编辑每个文件似乎太麻烦了，即使它们很瘦。

你如何管理你的视图文件？对于 rails 项目，我的评论视图文件夹是否“正常”？是否有一些像把手这样的模板引擎可以帮助解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:27:06.607

这是一个坏主意。Rails 将操作拆分为不同的视图，因此一切都是模块化的并且更易于维护。没有办法简单地将所有内容组合成一个单一的文件并在每个操作的基础上调用您想要的部分；这就是你的控制器的重点。

如果您很难编辑不同的文件，我不会说这是 Rails 行为的问题，而是您的开发环境的问题。许多 IDE 和编辑器具有帮助处理许多文件的过程的功能或插件。但是，您的情况对于 CRUD 视图来说是相当标准的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:28:11.847

在 Rails 3.1 及更高版本中，JS 文件进入 assets/javascripts 文件夹以在资产管道中使用……如果我在两行之间阅读，您可能会更喜欢。但除此之外，这看起来很正常。

在一个文件中包含太多内容违反了单一责任原则。每个文件应该只有一个更改理由。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:33:13.243

我同意@rpedroso。Rails 设置这些东西是有原因的。您可以选择不同意原因并采取不同的做法；大概您对系统和所涉及的权衡有很深的了解。但是在不知道原因的情况下做不同的事情只是粗心。Rails 如此受欢迎，因为它制定了易于遵循的约定，强烈推荐，因为每个人都知道它们是什么，并且可以和你说同一种语言。无视约定，后果自负。

我推荐 Michael Hartl 的[Rails 教程](http://ruby.railstutorial.org/)作为 Rails 的精彩介绍。

# javascript - 如何使用 javascript 使自定义数据属性值数字化

> ID：11197407
> 
> 赞同：4
> 
> 时间：2012-06-25T21:09:36.593
> 
> 标签：javascript, jquery, escaping, custom-data-attribute

嗨，我正在从存储在 div 中的 html 数据标签中读取两个数字。当我尝试将数字相加时，它们将作为字符串附加。无论如何在数据属性中包含数字并将它们作为数字访问或使用javascript将它们转换回非字符串数字谢谢。

例子

```
<div data-Lon1="1.3" data-Lat1="-1.2"></div>

<script>
   lon1 = $('#zoom1').attr('data-lon1');
   lat1 = $('#zoom1').attr('data-lat1');
   console.log(lat1+lon1);

   //returns '1.3-1.2' (I want .1 in this example)
</script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-25T21:11:37.430

只需使用`parseFloat()`：

```
var lon1 = parseFloat($('#zoom1').attr('data-lon1'));
   lat1 = parseFloat$('#zoom1').attr('data-lat1'));
console.log(lat1+lon1); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/G4zqy/)。

参考：

*   [`number()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Number).
*   [`parseFloat()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/parseFloat).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-25T21:11:48.567

您可以使用[`.data()`](http://api.jquery.com/data/)将值正确解析为基础类型的方法：

```
var lon1 = $('#zoom1').data('lon1');
var lat1 = $('#zoom1').data('lat1');
console.log(lat1 + lon1); 
```

您会注意到，在使用该`.data()`方法时，您不再将完整的属性名称作为参数传递，而是仅传递后缀 - `lon1`and`lat1`而不是`data-lon1`and `data-lat1`。

这是一个现场演示：http: [//jsfiddle.net/E7Av7/](http://jsfiddle.net/E7Av7/)

哦，不要忘记为您的 div 提供正确的 id，以便您的数据选择器返回一些内容，因为您似乎忘记在问题中发布的代码段中执行此操作：

```
<div data-Lon1="1.3" data-Lat1="-1.2" id="zoom1"></div>​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:11:22.157

有一个 JavaScript 函数称为`parseFloat`. 使用`parseFloat($("#zoom1").attr("data-lon1")`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T21:16:38.287

使用`.data()`which 尝试解析值。

```
var lon1 = $('div').data('lon1');
var lat1 = $('div').data('lat1');
console.log(lat1+lon1); 
```

但是，如果您希望结果`0.1`来自于此，则必须执行以下操作：

```
console.log( Math.round( ( lat1+lon1 ) * 100000000000 ) / 100000000000 ); 
```

否则你会得到`0.10000000000000009`而不是`0.1`

请参阅[浮点数学是否损坏？](https://stackoverflow.com/questions/588004/is-javascripts-math-broken)

[http://jsfiddle.net/E7Av7/1/](http://jsfiddle.net/E7Av7/1/)

# wpf - 如何在打开组合框项目列表之前显示警告窗口？

> ID：11197409
> 
> 赞同：2
> 
> 时间：2012-06-25T21:09:47.013
> 
> 标签：wpf, combobox, popup

我的要求是在单击 WPF 组合框时显示一个警告窗口（在某些特定条件下），就在它显示可供选择的可用项目列表之前。窗口询问用户是否继续。

问题是，在显示此警告窗口后，应该出现选择项目的组合框弹出窗口未打开，无论我是否设置属性 IsDropDownOpen 这样做。有关详细信息，请参阅代码。

```
<Window x:Class="ComboBoxTester.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
<StackPanel>
    <ComboBox Height="20" PreviewMouseDown="ComboBox_PreviewMouseDown">
        <ComboBoxItem>Item 1</ComboBoxItem>
        <ComboBoxItem>Item 2</ComboBoxItem>
        <ComboBoxItem>Item 3</ComboBoxItem>
    </ComboBox>
    <CheckBox x:Name="warningConditionCheckBox" >Is warning condition?</CheckBox>
</StackPanel>
</Window> 
```

后面的代码包含：

```
namespace ComboBoxTester {
using System.Windows.Input;

/// <summary>
/// Interaction logic for MainWindow.xaml
/// </summary>
public partial class MainWindow
{
    public MainWindow()
    {
        InitializeComponent();
    }

    private void ComboBox_PreviewMouseDown(object sender, MouseButtonEventArgs e)
    {
        if (warningConditionCheckBox.IsChecked == true)
        {
            // Warn about this situation
            var window = new MyDialog { Owner = GetWindow(this) };

            // Confirm to proceed
            if (window.ShowDialog() != true) {
                e.Handled = true;
            } 
            else {
                comboBox.IsDropDownOpen = true;
            }
        }
    }
}
} 
```

MyDialog 只是一个对话框窗口：

```
<Window x:Class="ComboBoxTester.MyDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="MyDialog" Height="150" Width="300">
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="*"/>
        <RowDefinition Height="40"/>
    </Grid.RowDefinitions>
    <Border Background="Silver">
        <TextBlock Text="Warning! Sure to proceed?" TextAlignment="Center"/>
    </Border>

    <StackPanel Grid.Row="1">
        <Button Width="100" Content="OK" IsDefault="True" Click="ButtonOkClick"/>
        <Button Width="100" Content="Cancel" IsCancel="True"/>
    </StackPanel>
</Grid>
</Window> 
```

* * *

```
namespace ComboBoxTester {
using System.Windows;

/// <summary>
/// Interaction logic for MyDialog.xaml
/// </summary>
public partial class MyDialog
{
    public MyDialog()
    {
        InitializeComponent();
    }

    private void ButtonOkClick(object sender, RoutedEventArgs e)
    {
        DialogResult = true;
    }
}
} 
```

我的想法是使用 WPF 组合框来处理这个要求。如果可能的话，不要创建另一个控件。那么...在显示一个窗口后，如何从该组合框中查看项目列表？任何建议都有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T07:48:52.283

这通常是 WPF 中的一个问题，即当您在事件处理程序中时，您可以设置其他 UI 控件的属性，但它们没有得到正确处理。

但是您可以通过调度程序调用您的更改，调度程序会将您的请求排队在 UI 消息队列中，在您的事件处理程序之后正确处理它：

代替

```
 comboBox.IsDropDownOpen = true; 
```

利用：

```
 Action action = () => comboBox.IsDropDownOpen = true;
  Application.Current.Dispatcher.BeginInvoke(action); 
```

# php - 如何保护 PHP Symfony 表单上的密码

> ID：11197411
> 
> 赞同：0
> 
> 时间：2012-06-25T21:09:56.657
> 
> 标签：php, symfony-1.4

我的 PHP Symfony 项目中有简单的登录表单。但是我发现了这个问题。

我什么时候使用这个命令

```
$("#signin_password").val() 
```

在 Chrome 中，它显示我的密码不安全。

如何以这种方式保护用户密码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:46:01.317

最好的办法是永远不要在页面上显示原始密码。更重要的是，您永远不应该将原始密码存储在数据库或任何其他介质中。

最好的方法是使用单向加密来存储所有密码，为了检查密码，您只需将“加密字符串”与存储在数据库中的内容进行比较。

因为您使用的是 symfony 1.4，所以我建议您查看[sfGuardPlugin](http://www.symfony-project.org/plugins/sfGuardPlugin)以获得现成的解决方案。

# path-finding - 找到最少的转弯路径

> ID：11197415
> 
> 赞同：0
> 
> 时间：2012-06-25T21:10:36.697
> 
> 标签：path-finding

```
Tiles = {  
{0,0,0,0,0,0,0,0,0,0},  
{0,2,2,2,2,2,2,2,2,0},  
{0,3,0,0,2,4,2,2,2,0},  
{0,0,2,0,0,0,2,2,2,0},  
{0,0,2,2,2,0,2,2,2,0},  
{0,0,0,0,2,0,2,2,2,0},  
{0,0,2,2,2,0,2,2,2,0},  
{0,0,0,0,0,0,0,0,0,0}  
} 
```

0 不可点击，其他可点击，否则 0 可步行，其他不可，我点击 Tiles[3][2]（数字 3）然后点击 Tiles[3][6]（数字 4），我想连接那个2 瓦通过可步行瓦，问题是我不需要最短的解决方案，而是我需要具有 2 个或更少拐角（转弯）的解决方案，我花了 3 天时间来想象和谷歌搜索算法，但没有运气，有人可以给我关于那个的线索或文章，我使用 lua，但我仍然欣赏其他语言。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:15:14.687

使用以下规则将您的网格转换为图表：

*   网格中的每个可行走图块对应于图中的一个节点。
*   如果两个节点位于网格中的同一行或列中并且网格中它们之间的每个图块都是可行走的，则它们在图中连接（权重为 1）。

图中的最短路径对应于网格中拐角最少的路径。

# web-scraping - 如何从锅炉管道文章提取器运行和获取文档统计信息？

> ID：11197420
> 
> 赞同：0
> 
> 时间：2012-06-25T21:10:56.407
> 
> 标签：web-scraping, html-content-extraction, boilerpipe

关于锅炉管的 ArticleExtractor 类的使用，我不太了解。虽然，我对 java 也很陌生，所以也许我对这个环境的基本知识有问题。

无论如何，我正在尝试使用锅炉管从我收集的一些原始 html 源中提取主要文章。html 源文本存储在具有网页原始 HTML 内容的 java.lang.String 变量（我们称之为 htmlstr）变量中。

我知道如何运行boilerpipe将提取的文本打印到输出窗口，如下所示：

```
java.lang.String htmlstr = "<!DOCTYPE.... ****html source**** ... </html>";

java.lang.String article = ArticleExtractor.INSTANCE.getText(htmlstr);
System.out.println(article); 
```

但是，我不确定如何通过首先实例化 ArticleExtractor 类的实例，然后使用“TextDocument”输入数据类型调用它来运行 BP。TextDocument 数据类型本身是以某种方式从 BP 的“TextBlock”数据类型构建的，也许我没有正确执行此操作......

从我的 htmlstr 字符串变量构造 TextDocument 类型变量的正确方法是什么？

所以我的问题是除了按照上面的示例调用 ArticleExtractor getText 方法之外，使用 BP 的 Article Extractor 类的处理方法。换句话说，我不确定如何使用

```
ArticleExtractor.process(TextDocument doc); 
```

方法。

据我了解，需要运行此 ArticleExtractor 流程方法，然后才能使用相同的“TextDocument doc”变量来获取文档统计信息，使用 BP 的

```
TextDocumentStatistics(TextDocument doc, boolean contentOnly) 
```

方法？我想使用统计数据来确定估计过滤的效果如何。

有人可以帮助我的任何代码示例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T06:59:03.263

**用 Jython 编写的代码（转换为 java 应该很容易）**

**1) 如何从 HTML 字符串中获取 TextDocument：**

```
import org.xml.sax.InputSource as InputSource
import de.l3s.boilerpipe.sax.HTMLDocument as HTMLDocument
import de.l3s.boilerpipe.document.TextDocument as TextDocument
import de.l3s.boilerpipe.sax.BoilerpipeSAXInput as BoilerpipeSAXInput
import de.l3s.boilerpipe.extractors.ArticleExtractor as ArticleExtractor
import de.l3s.boilerpipe.estimators.SimpleEstimator as SimpleEstimator
import de.l3s.boilerpipe.document.TextDocumentStatistics as TextDocumentStatistics
import de.l3s.boilerpipe.document.TextBlock as TextBlock

htmlDoc = HTMLDocument(rawHtmlString)
inputSource = htmlDoc.toInputSource() 
boilerpipeSaxInput = BoilerpipeSAXInput(inputSource)
textDocument = boilerpipeSaxInput.getTextDocument() 
```

**2）如何使用文章提取器处理文本文档**（接上）

```
content = ArticleExtractor.INSTANCE.getText(textDocument) 
```

**3）如何获取TextDocumentStatistics**（接上）

```
content_list = [] #replace python 'List' Object with ArrayList in java
content_list.append(TextBlock(content)) #replace with arrayList.add(TextBlock(content))
content_td = TextDocument(content_list)
content_stats = TextDocumentStatistics(content_td, True)#True for article content statistics only 
```

注意：boilerpipe 1.2.jar 库附带的 java 文档应该对将来的参考有所帮助

# sql-server-2008 - 使用实体框架切换到 SQL Server 2012

> ID：11197421
> 
> 赞同：4
> 
> 时间：2012-06-25T21:10:56.967
> 
> 标签：sql-server-2008, entity-framework, sql-server-2012

你们中有人有从 SQL Server 2008 切换到带有实体框架的 SQL Server 2012 的经验吗？

我该如何做到这一点？我只需要更改 app.config 中的 ConnectionString 还是会遇到任何困难？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T21:11:54.963

只需更改连接字符串 :) 即可。在工作中没有问题

# javascript - 是否可以使用其他目标运行 javascript？

> ID：11197424
> 
> 赞同：0
> 
> 时间：2012-06-25T21:11:15.890
> 
> 标签：javascript, jquery, facebook

我有一个 facebook 应用程序，我使用通用身份验证进行身份验证。像这样：

```
 // Fixar oAuth
    jso_configure({
        "facebook": {
            client_id: "393963983989013",
            redirect_uri: "http://resihop.herokuapp.com/",
            authorization: "https://www.facebook.com/dialog/oauth",
            presenttoken: "qs"
        }
    });

    // Make sure that you have 
    jso_ensureTokens({
        "facebook": [""]
    });

    // This dumps all cached tokens to console, for easyer debugging.
    //jso_dump();

    jso_ensureTokens({
        "facebook": [""]
    }); 
```

它在 document.ready 上被触发了。

因为它是一个 facebook 应用程序，所以我无法在 iFrame 中运行身份验证。Facebook 使用 X-Frame-Options 否认了这一点。如果您使用链接进行身份验证，解决方案是使用 target="_top"。我如何在javascript中实现相同的效果？在这种情况下，也许我需要编辑其中一个功能（尽管理想情况下不需要，因为它们是库的一部分），请指出正确的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:15:33.020

找到了。更改`window.location`为`top.location`。

# python - Python UTF-16 编码十六进制表示

> ID：11197437
> 
> 赞同：1
> 
> 时间：2012-06-25T21:12:08.950
> 
> 标签：python, string, file, utf-16, utf

我在 Python 2.7.2 中有一个字符串说 u"\u0638"。当我将其写入文件时：

```
f = open("J:\\111.txt", "w+")
f.write(u"\u0638".encode('utf-16'))
f.close() 
```

在十六进制中它看起来像：FF FE 38 06 当我将这样的字符串打印到标准输出时，我会看到：'\xff\xfe8\x06'。

*问题：* **输出到stdout的字符串中的\x38在哪里？**换句话说，为什么输出到标准输出的字符串不是'\xff\xfe\x38\x06'？

如果我将字符串写入文件两次：

```
f = open("J:\\111.txt", "w+")
f.write(u"\u0638".encode('utf-16'))
f.write(u"\u0638".encode('utf-16'))
f.close() 
```

文件中的十六进制表示包含字节顺序标记 (BOM) \xff\xfe*两次*：FF FE 38 06 FF FE 38 06

**我想知道避免在 UTF-16 编码字符串中写入 BOM 的技术是什么？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T21:14:04.370

ASCII 字符`8`具有十六进制表示`0x38`。所以你的字符串：

```
\xff\xfe8\x06 
```

是*四个*字节长。以空格分隔，字节为：

```
\xff \xfe 8 \x06 
```

Python 使用`\x`不代表可打印 ASCII 字符的字节表示法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-25T21:21:02.783

编码为“utf-16le”或“utf-16be”（小端或大端）应跳过编写 BOM。当然，如果没有 BOM，解码器需要知道预期的字节顺序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T21:43:52.470

`\xff\xfe8\x06` *确实*包含`\x38`！`8`== `\x38`。

对于您的第二个问题，为了避免 BOM，如果您明确说明字节顺序（使用`UTF-16BE`或`UTF-16LE`编解码器），则不会打印任何 BOM。

但是，正确的做法是使用为您处理编码和解码的文件包装器，并在您的程序中使用 unicode。在 Python 3.0 中，`open`内置函数可以这样做：

```
fp = open(filename, 'w', encoding='utf-16')
fp.write(u'write one line\n')
fp.write(u'write another line\n')
fp.close() 
```

在 Python 2.x 中，使用编解码器包装器：

```
fp = codecs.open(filename, 'w', 'utf-16')
fp.write(u'write one line\n')
fp.write(u'write another line\n')
fp.close() 
```

# java - ScheduledExecutorService 会根据需要创建新线程吗？

> ID：11197439
> 
> 赞同：16
> 
> 时间：2012-06-25T21:12:42.450
> 
> 标签：java, executorservice

我[`Executors.newScheduledThreadPool()`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Executors.html#newScheduledThreadPool%28int%29)用来创建一个[`ScheduledExecutorService`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ScheduledExecutorService.html)，指定线程数，如下所示：

```
int corePoolSize = 42;
ScheduledExecutorService foo = Executors.newScheduledThreadPool(corePoolSize); 
```

根据 JavaDocs，`corePoolSize`参数集

> 保留在池中的线​​程数，即使它们是空闲的。

这是否意味着此`ExecutorService`实现可能会根据需要创建多个`corePoolSize`线程，类似于[缓存线程池](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Executors.html#newCachedThreadPool%28%29)？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-26T22:17:25.510

不。正确答案是否定的，ScheduledExecutorService 不会产生新线程。

[在这里查看答案](https://stackoverflow.com/questions/11678021/why-doesnt-scheduledexecutorservice-spawn-threads-as-needed)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-25T21:13:52.440

> *这是否意味着这个 ExecutorService 实现可能会根据需要创建多个`corePoolSize`线程？*

是的，这正是它的意思。存在的原因`corePoolSize`是线程创建的开销。如果您希望在您的执行器服务上触发大量短期任务，您可能希望在给定的时间点找到大量*空闲*线程。

与其让这些线程死掉，只是在很短的时间内被新创建的线程替换，`corePoolSize`这将确保始终有许多旋转线程。

# c# - 如何检测是否建立了新的 Wlan/Lan 连接？个人电脑

> ID：11197440
> 
> 赞同：2
> 
> 时间：2012-06-25T21:12:50.390
> 
> 标签：c#, sockets, ip

如何检测我的系统是否收到了新的 IP 地址？

我的程序读取所有本地 IP，`DNS.GetHostAddress`并在每个 IP 上绑定一个套接字。但是，暂停后，我无法连接到我的程序。

当系统收到新的 IP 地址时，是否有事件`System.Net`通知我？我目前的解决方法是一个额外的线程来检查当前接口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:19:25.263

可能是硬件。如果您的计算机通过以太网或 wifi 连接，会发生这种情况吗？问题是双向发生的吗？

我会尝试以太网和wifi，让计算机进入休眠状态，然后检查你是否仍然有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:36:38.750

您可能想要使用 System.Net.NetworkInformation.NetworkChange.NetworkAddressChanged 事件。

看看这里：http: [//msdn.microsoft.com/en-us/library/system.net.networkinformation.networkchange.networkaddresschanged.aspx](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.networkchange.networkaddresschanged.aspx)

看看这是否有效会很有趣。看起来很有希望。

如果不是，您可能希望每 n 秒轮询一次，不是很漂亮，但我怀疑 n 是否是一个合理的水平，它会对性能产生很大影响吗？

# objective-c - 如何在 iOS 5.1 上将回调函数传递给 sqlite3_exec？

> ID：11197451
> 
> 赞同：3
> 
> 时间：2012-06-25T21:13:51.817
> 
> 标签：objective-c, ios, xcode, sqlite

我是 xcode/iOS/Objective-C 和 sqlite 的新手。我正在尝试自学基础知识 - 我想使用 sqlite3 包装器“sqlite3_exec”进行选择查询。出于某种原因，我在任何地方都找不到这样做的人的简单示例。

基本上，该方法有一个回调函数的参数（第三个）：

```
int sqlite3_exec(
  sqlite3*,                                  /* An open database */
  const char *sql,                           /* SQL to be evaluated */
  int (*callback)(void*,int,char**,char**),  /* Callback function */
  void *,                                    /* 1st argument to callback */
  char **errmsg                              /* Error msg written here */
); 
```

没关系。我对回调并不陌生。但是，我似乎无法正确理解语法。我接管了我的 iPad (iOS 5.1) xcode (4.3) 项目中的一个视图控制器，并进行了如下所示的更改：

```
#import "SecondViewController.h"
#import "sqlite3.h"
#import "AppState.h"

@interface SecondViewController ()

@end

@implementation SecondViewController

- (int)myCallback:(void *)a_parm argc:(int)argc argv:(char **)argv column:(char **)column
{

    return 0;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    //grab questionnaire names
    char *sql = "select * from QST2Main order by [Name]";
    char *err = nil;
    sqlite3 *db = [[AppState sharedManager] getgCn]; 

    sqlite3_exec(db, sql, myCallback, nil, &err); 
} 
```

本质上，我想在此视图首次加载时运行查询，以存储一些数据以供以后使用。但是，XCode 不喜欢底部的“myCallback”用法。它说：未声明使用标识符“myCallback”。

该方法在头文件中声明，我什至尝试将其设为静态。似乎没有什么能让这个错误消失。我知道我必须在这里做一些根本错误的事情，但是对于我的生活，我无法弄清楚是什么 - 我什至无法在这个领域找到其他代码示例来帮助我弄清楚我错过了什么。

非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-25T23:31:03.340

回调必须是 C 函数。尝试

```
int myCallback(void *a_parm, int argc, char **argv, char **column)
{
    return 0;
} 
```

# c++ - 以编程方式检查字节顺序

> ID：11197455
> 
> 赞同：0
> 
> 时间：2012-06-25T21:14:23.393
> 
> 标签：c++, memory-management, endianness

我知道以编程方式测试字节顺序的最常用方法是像这样转换为 char*：

```
short temp = 0x1234;
char* tempChar = (char*)&temp; 
```

但是可以通过转换为 short* 来完成，如下所示：

```
unsigned char test[2] = {1,0};  
if ( *(short *)test == 1)
    //Little-Endian
else
    //Big-Endian 
```

我是否正确，“测试”缓冲区将使用 Little-Endian 约定（从右到左：“0”在较低地址，“1”在较高地址）保存在内存中（在 x86 平台上），就像以防万一与“温度”变量？

更一般地说，如果我有一个字符串： char tab[] = "abcdef"; 它将如何存储在内存中？它会像“fedcba”一样反转吗？

谢谢。提前：-）

PS。

有什么方法可以查看程序的数据在系统内存中的样子？我想在“现实生活”中看到 Little-Endian 中的字节交换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:16:32.613

您的代码可能会在实践中工作（您可以尝试一下！）。但是，从技术上讲，它会调用未定义的行为；该标准不允许您通过另一种类型的指针访问 char 数组。

> 更一般地说，如果我有一个字符串： char tab[] = "abcdef"; 它将如何存储在内存中？它会像“fedcba”一样反转吗？

不，否则`tab[0]`会给你`f`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T22:58:04.007

使用联合会更安全，即符合标准。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:38:00.753

您检查字节顺序的替代方法会起作用。

`char tab[] = "abcdef"`将以相同的顺序存储：`abcdef`

当您访问多个字节（short、int 等）时，字节序就会发挥作用。当您尝试`tab[]`使用小型字节序机器作为短数组访问时，您会将其读取为 ba、dc、fe（无论它们的实际字节等价物是什么，这都是字符在 short 中“评估”的顺序）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T22:10:52.890

不保证这两种方式都有效，此外，后者会调用未定义的行为。

如果 . 首先失败`sizeof(char) == sizeof(short)`。

Second 可能由于相同的原因而失败，并且也是不安全的：指针转换的结果可能与 short 对齐错误，并且访问 (short) 值会调用未定义的行为 (3.10.15)。

但是，是的，字符缓冲区按顺序存储到内存中，因此`&test[0] < &test[1]`，更一般地说，正如其他人已经说过的那样，`char tab[] = "abcdef"`无论字节顺序如何，都不会反转或以其他方式排列。

# magento - Magento pagamento 数字错误

> ID：11197457
> 
> 赞同：0
> 
> 时间：2012-06-25T21:14:40.897
> 
> 标签：magento

我正在尝试在我的 Magento 1.6.2.0 中安装 Pagamento Digital 模块，但是有一些错误日志我不知道该怎么做...

到目前为止，我一直在寻找 3 天，如果有人能照亮我的道路，那将是有福的！

模块网址： http: [//www.magentocommerce.com/magento-connect/buscape-pagamento-digital-4971.html](http://www.magentocommerce.com/magento-connect/buscape-pagamento-digital-4971.html)

错误日志：

```
a:5:{i:0;s:87:"Mage registry key "_singleton/pagamentodigital/source_specificcountries" already exists";i:1;s:1647:"

#0 /home/wwwmirom/public_html/app/Mage.php(192): Mage::throwException('Mage registry k...') #1 /home/wwwmirom/public_html/app/Mage.php(446): Mage::register('_singleton/paga...', false) 
#2 /home/wwwmirom/public_html/app/code/core/Mage/Adminhtml/Block/System/Config/Form.php(407): Mage::getSingleton('pagamentodigita...') 
#3 /home/wwwmirom/public_html/app/code/core/Mage/Adminhtml/Block/System/Config/Form.php(210): Mage_Adminhtml_Block_System_Config_Form->initFields(Object(Varien_Data_Form_Element_Fieldset), Object(Mage_Core_Model_Config_Element), Object(Mage_Core_Model_Config_Element)) 
#4 /home/wwwmirom/public_html/app/code/core/Mage/Adminhtml/Block/System/Config/Edit.php(92): Mage_Adminhtml_Block_System_Config_Form->initForm() 
#5 /home/wwwmirom/public_html/app/code/core/Mage/Adminhtml/controllers/System/ConfigController.php(102): Mage_Adminhtml_Block_System_Config_Edit->initForm() 
#6 /home/wwwmirom/public_html/app/code/core/Mage/Core/Controller/Varien/Action.php(420): Mage_Adminhtml_System_ConfigController->editAction() 
#7 /home/wwwmirom/public_html/app/code/core/Mage/Core/Controller/Varien/Router/Standard.php(250): Mage_Core_Controller_Varien_Action->dispatch('edit') 
#8 /home/wwwmirom/public_html/app/code/core/Mage/Core/Controller/Varien/Front.php(176): Mage_Core_Controller_Varien_Router_Standard->match(Object(Mage_Core_Controller_Request_Http)) 
#9 /home/wwwmirom/public_html/app/code/core/Mage/Core/Model/App.php(349): Mage_Core_Controller_Varien_Front->dispatch() 
#10 /home/wwwmirom/public_html/app/Mage.php(640): Mage_Core_Model_App->run(Array) 
#11 /home/wwwmirom/public_html/index.php(80): Mage::run('', 'store') 
#12 {main}";s:3:"url";s:99:"/~wwwmirom/index.php/admin/system_config/edit/section/payment/key/e94bbab2478ea8f5cf8dc57068597e1b/";s:11:"script_name";s:20:"/~wwwmirom/index.php";s:4:"skin";s:5:"admin";} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T23:10:03.353

看起来你正在处理一个被黑/修改过的核心。此扩展正在尝试使用该`getSingleton`方法来实例化一个类。如果您查看未修改的核心

```
public static function getSingleton($modelClass='', array $arguments=array())
{
    $registryKey = '_singleton/'.$modelClass;
    if (!self::registry($registryKey)) {
        self::register($registryKey, self::getModel($modelClass, $arguments));
    }
    return self::registry($registryKey);
} 
```

您可以看到 Magento在设置之前**检查**注册表中是否已经设置了某些内容。注册表是一个简单的键/值存储。

出于某种原因，此“检查是否已设置”代码在您的特定安装中失败/不存在。您需要调试原因。

# java - 为什么-127>>1的二进制表示是11000000？

> ID：11197458
> 
> 赞同：0
> 
> 时间：2012-06-25T21:14:48.283
> 
> 标签：java, algorithm, computer-science

我知道 -127 的二进制表示是 10000001（补码）。

任何人都可以告诉我为什么我将它右移一位，然后我得到 11000000 ？

> (-127) = 10000001
> 
> (-127>>1) = 11000000 ???

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T21:17:43.850

在某些语言中，右移将填充最高有效位中的任何内容（在这种情况下`1`）。这是为了使符号在移动负数时不会改变，如果不适当，它会变成正数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-25T21:19:45.943

如果您的编程语言进行符号扩展右移（如 Java 所做的那样），那么最左边的 1 来自扩展符号。也就是说，由于最高位设置为原始数字，因此每次移位的结果中都保持设置（因此移位超过 1 时，最高位中的所有 1 都对应于完成的移位次数）。

这取决于语言 - IIRC C 和 C++ 符号扩展为有符号值右移，而不是无符号值。Java 有一个特殊的 >>> 运算符可以在不扩展的情况下进行移位（在 Java 中，所有数字原始值都已签名，包括误导性命名的字节）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-25T21:17:47.813

-127 作为 WORD（2 个字节）是`1111111110000001`. 如果您将其右移 1 位，并将其表示为单个字节，则结果`11000000` 可能是您所看到的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-25T21:20:43.163

因为，如果你将 -127（[二进制补码](http://en.wikipedia.org/wiki/Two%27s_complement)编码为`10000001`）除以 2 并向下舍入（朝向 -无穷大，而不是零），你会得到 -64（二进制补码编码为`11000000`）。

就位而言，原因是：当右移有符号值时，您会进行[符号扩展](http://en.wikipedia.org/wiki/Two%27s_complement#Sign_extension)——而不是移入零，而是复制最高有效位。当使用二进制补码有符号数字时，这可以确保正确的结果，如上所述。

汇编语言（以及它们编码的机器语言）通常具有单独的无符号和有符号右移操作指令（也称为“逻辑右移”与“算术右移”）；编译语言通常在分别移动无符号和有符号值时选择适当的指令。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-25T21:20:22.350

它是符号扩展，因此右移的负数仍然是负数。

# javascript - div上的jQuery滚动

> ID：11197459
> 
> 赞同：0
> 
> 时间：2012-06-25T21:14:59.500
> 
> 标签：javascript, jquery, html, scroll

`jQuery`我正在尝试使用/设置一个简单的聊天系统`Ajax`，但是滚动部分的行为很奇怪。当我发布某些内容或收到某些内容时，滚动条会按照请求向上而不是向下。这是代码：

```
 $('form[name="iview-messages-chat"]').submit(function(e) {
        e.preventDefault();

        var data = {};
        data.msg = $('textarea', this).val();
        data.time = $('#iview-messages-pane .iview-messages-item:last').attr('data-time');
        data.uid = $('input[name="uid"]', this).val();

        $.ajax({
            type: 'POST',
            url: 'index.php?page=messages&action=send',
            data: data,
            dataType: 'json',
        }).done(function(data) {
            $.each(data, function(index,value) {
                var nm = '<div class="clearfix iview-messages-item" style="height:auto;min-height:60px;width:730px;margin:0;" data-cid="'+value.id+'" data-time="'+value.time+'">';
                nm += '<img style="margin-top: 5px;" src="'+value.picture+'" />';
                nm += '<div class="iview-messages-item-info" style="width:630px;">';
                nm += '<div class="iview-messages-item-info-row" style="width:inherit;">';
                nm += '<a href="'+value.profile+'">'+value.first_name+' '+value.last_name+'</a>';
                nm += '<span style="float:right;font-size:11px;">'+value.elapsed_time+'</span>';
                nm += '</div>';
                nm += '<div class="iview-messages-item-info-row">';
                nm += '<span>'+value.content+'</span>';
                nm += '</div>';
                nm += '</div>';
                nm += '</div>';
                $('#iview-messages-pane').append(nm);
            });

            $('form[name="iview-messages-chat"] textarea').val('');
            if (!$.isEmptyObject(data))
            {
                $('#iview-messages-pane').animate({scrollTop: $('#iview-messages-pane').height()}, 800);
            }
        }).fail(function() {
            console.log('error');
        });

        return false;
    }); 
```

**标记**

```
div id="iview-messages-pane">
<div id="iview-messages-pane-handler" class="clearfix">
    <div class="clearfix iview-messages-item" style="height:auto;min-height:60px;width:730px;margin:0;" data-cid="36" data-time="1340591805">
        <img style="margin-top: 5px;" src="http://myiview.me/upload/1/4fda8a23cb3c3_200_200.jpg" />
        <div class="iview-messages-item-info" style="width:630px;">
            <div class="iview-messages-item-info-row" style="width:inherit;">
                <a href="http://myiview.me/index.php?page=profile&uid=1">Filipe Matias</a>
                <span style="float:right;font-size:11px;">19 hours ago</span>
            </div>
            <div class="iview-messages-item-info-row">
                <span>Hmmmmmm yeeelloowww!</span>
            </div>
        </div>
    </div>
</div>
</div> 
```

有小费吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:38:07.860

正如@lbstr 指出的那样，高度可能没有达到您期望的高度

```
$('#iview-messages-pane')
    .animate({
        scrollTop: (function(){
            var combinedHeightOfChildren = 0;
            $('#iview-messages-pane').children().each(function(){
                combinedHeightOfChildren += $(this).outerHeight();
            });
            return combinedHeightOfChildren - $('#iview-messages-pane').height();
        })(); // execute the function immediately
    }, 800); 
```

根据@lbstr 建议：垂直滚动位置与在可滚动区域上方的视图中隐藏的像素数相同，因此当完全向下滚动时，消息窗格的高度是可见的，隐藏部分是

```
combinedHeightOfChildren - $('#iview-messages-pane').height(); 
```

所以它应该返回

```
return combinedHeightOfChildren - $('#iview-messages-pane').height(); 
```

由于我们无法进一步滚动，因此不会出现明显的错误，只是将其分开，以便其他用户可以关注发生的事情。

[http://jsfiddle.net/sabithpocker/sgu6p/](http://jsfiddle.net/sabithpocker/sgu6p/)这是一个显示工作的小提琴

[http://jsfiddle.net/sabithpocker/sgu6p/1/](http://jsfiddle.net/sabithpocker/sgu6p/1/)摆弄添加+滚动！！

# clojure - 在 Clojure 中合并数组

> ID：11197461
> 
> 赞同：0
> 
> 时间：2012-06-25T21:15:05.437
> 
> 标签：clojure

我需要根据 id 合并一组数组。

示例数据：

编辑：（更改为匹配 Clojure 数据结构）

```
 [{:id 1, :region :NA, :name :Test1, :OS :W}
  {:id 1, :region :EU, :name :Test2, :OS :W}
  {:id 2, :region :AS, :name :test3, :OS :L}
  {:id 2, :region :AS, :name :test4, :OS :M}] 
```

变成：

编辑：（更改为匹配 Clojure 数据结构）

```
[{:id 1, :region [:NA :EU], :name [:Test1 :Test2] ,:OS [:W]}
 {:id 2, :region [:AS] :name [:test3 :Test4], :OS [:L :M]}] 
```

| 是分隔符（可变） 如果可能的话，也想按字母顺序为好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T12:48:37.427

您可以使用一些函数组合`clojure.set`（如果您将最外层的向量更改为设置）。具体[`clojure.set/index`](http://clojuredocs.org/clojure_core/clojure.set/index)看起来很有希望。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T15:45:13.733

```
(def data
 [{:id 1, :region :NA, :name :Test1, :OS :W}
  {:id 1, :region :EU, :name :Test2, :OS :W}
  {:id 2, :region :AS, :name :test3, :OS :L}
  {:id 2, :region :AS, :name :test4, :OS :M}])

(defn key-join
  "join of map by key , value is distinct."
  [map-list]
  (let [keys (keys (first map-list))]
       (into {} (for [k keys] [k (vec (set (map #(% k) map-list)))]))))

(defn group-reduce [key map-list]
  (let [gdata (group-by key map-list)]
    (into [] (for [[k m] gdata] (let [m (key-join m)](assoc m key ((key m) 0)))))))

user=> (group-reduce :id data)
[{:name [:Test2 :Test1], :OS [:W], :region [:EU :NA], :id 1} {:name [:test3 :test4], :OS [:L :M], :region [:AS], :id 2}] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T00:35:32.013

您可以`merge-with`在示例中使用如下所示的功能。

首先，我们定义一些辅助函数

```
(defn collect [& xs]
  (apply vector (-> xs distinct sort))) 
```

该`collect`函数确保其中的项目`xs`是唯一的且已排序，并最终以向量的形式返回它们。

```
(defn merge-keys [k xs]
  (map #(apply merge-with collect %) (vals (group-by k xs)))) 
```

`merge-keys``xs`首先通过主键（在您的情况下）对哈希映射进行分组，获取每个分组项目列表并使用上面的函数`:id`合并键的值。`collect`

```
(def xs [{:id 1, :region :NA, :name :Test1, :OS :W}
         {:id 1, :region :EU, :name :Test2, :OS :W}
         {:id 2, :region :AS, :name :test3, :OS :L}
         {:id 2, :region :AS, :name :test4, :OS :M}])

(merge-keys :id xs)
=> ({:id [1],
     :region [:EU :NA],
     :name [:Test1 :Test2],
     :OS [:W]}
    {:id [2],
     :region [:AS],
     :name [:test3 :test4],
     :OS [:L :M]}) 
```

**但是请注意**，即使是`:id`键现在也有与之关联的向量。您可以通过引入将单个值与键而不是向量相关联的语句来轻松地*取消向量...*`if``collect`

```
(defn collect [& xs]
  (let [cs (apply vector (-> xs distinct sort))]
    (if (= 1 (count cs)) (first cs) cs))) 
```

...或从那里获取结果`merge-keys`并执行

```
(map #(update-in % [:id] first) result) 
```

这只会*取消矢量*`:id`地图条目

# git - Git 合并工具与差异工具

> ID：11197465
> 
> 赞同：16
> 
> 时间：2012-06-25T21:15:17.830
> 
> 标签：git

我已经阅读了[mergetool](http://www.kernel.org/pub/software/scm/git/docs/git-mergetool.html)和[difftool](http://www.kernel.org/pub/software/scm/git/docs/git-difftool.html)的手册页，但我想我仍然不清楚两者之间的一般差异。他们都调用了某种合并工具，对吧？运行差异的目的是合并，对吗？

*外行对这些指令的描述是什么？*

更新：我想我需要扩展这个问题。是的...一个说差异。另一个说合并。但是运行差异的目的/用途是什么？看到差异后，您能否决定继续合并？差异工具通常与您为合并运行的工具相同吗？如果你运行 mergetool 然后取消合并，你不只是做了 difftool 所做的事情吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-25T22:11:44.920

它们是两种不同的操作，从技术上讲，您可以配置两个不同的程序（至少在 Git 世界中）来执行每个操作。

*   DIFF - 您想查看两个文件（或更多，和/或文件夹结构）之间的差异
*   MERGE - 您想查看两个（或多个）文件之间的差异并尝试将它们合并到一个输出文件中

MERGE 可能会显示 DIFF 作为其工作的一部分，但它们是独立的东西。多年来，许多差异程序模糊了界限，并开始处理合并。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-25T21:16:45.547

调用A`difftool`来*显示*两个或多个文件之间的差异。

调用A`mergetool`来帮助您*合并*两个或多个文件之间的差异。

# ios - 带有多个 html 页面的 iPhone/iPad 离线 Web 应用程序清单

> ID：11197472
> 
> 赞同：1
> 
> 时间：2012-06-25T21:16:14.173
> 
> 标签：ios, html, ios5, mobile-safari, offline

这是我的第一个 iOS 网络应用程序，所以请多多包涵。我对 HTML5/CSS3 部分进行了编码，所以现在我需要在 iPhone/iPad 上提供这个应用程序以供离线查看。我指的是[这个](http://developer.apple.com/library/safari/#documentation/iPhone/Conceptual/SafariJSDatabaseGuide/OfflineApplicationCache/OfflineApplicationCache.html)关于如何编写offline.manifest文件的链接，但我不清楚一些细节：

1.  上面的文档似乎引用了一个离线页面。但显然我的网络应用程序包含不止一个页面。是否可以在一个 Web 应用程序下使所有这些都离线使用？如果是这样，那怎么办？

2.  对于我的网络应用程序，我没有从网络浏览器链接到 html 页面。每个页面都由一个 PHP 脚本提供服务。更多的页面可能有这样的 URL：“http://mysite.com/home”转换为“http://mysite.com/home/index.php” 那么我应该在offline.manifest 中实际使用哪个URL文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:29:14.420

如果您使用 PHP，它不会是离线应用程序。PHP 代码在服务器端执行，因此如果没有 Internet 连接（离线），该应用程序无论如何都无法运行。如果它不需要 php 并且可以用 javascript 重写，那么你可以让它工作。

# wpf - TextBlock 样式触发器

> ID：11197474
> 
> 赞同：6
> 
> 时间：2012-06-25T21:16:30.837
> 
> 标签：wpf, xaml, mvvm, styles, datatrigger

我想组合来自两个不同 ViewModel 的 DisplayName，但前提是第一个不等于 NullObject。

我*可以*在转换器或父视图模型中轻松做到这一点，但我

这根本不显示任何内容：

```
 <TextBlock Grid.Column="2" Grid.Row="0" >
            <TextBlock.Inlines>
                <Run Text="{Binding HonorificVm.DisplayName}"/>
                <Run Text="{Binding PersonNameVm.DisplayName}"/>
            </TextBlock.Inlines>
            <TextBlock.Style>
                <Style TargetType="{x:Type TextBlock}">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding HonorificVm.Honorific}" Value="{x:Static model:Honorific.NullHonorific}">
                            <Setter Property="Text" Value="PersonNameVm.DisplayName"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </TextBlock.Style>
        </TextBlock> 
```

为什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-25T21:22:03.010

我会将它分成两部分`TextBlocks`，并且只使用触发器更改可见性。通过使用`Inlines`并尝试更改`Text`触发器中的 ，您可能会遇到[优先级](https://msdn.microsoft.com/en-us/library/ms743230%28v=vs.100%29.aspx)问题并且`Inlines`无法将 提取到`Setter`.

例如

```
<StackPanel Grid.Column="2" Grid.Row="0" Orientation="Horizontal">
  <TextBlock Text="{Binding HonorificVm.DisplayName}" Margin="0,0,5,0">
    <TextBlock.Style>
      <Style TargetType="TextBlock">
        <Style.Triggers>
          <DataTrigger Binding="{Binding HonorificVm.Honorific}"
                       Value="{x:Static model:Honorific.NullHonorific}">
            <Setter Property="Visibility" Value="Collapsed" />
          </DataTrigger>
        </Style.Triggers>
      </Style>
    </TextBlock.Style>
  </TextBlock>
  <TextBlock Text="{Binding PersonNameVm.DisplayName}" />
</StackPanel> 
```

* * *

另一种选择是 a`MultiBinding`而不是`Inlines`：

```
<TextBlock Grid.Column="2" Grid.Row="0">
  <TextBlock.Style>
    <Style TargetType="{x:Type TextBlock}">
      <Setter Property="Text">
        <Setter.Value>
          <MultiBinding StringFormat="{}{0} {1}">
            <Binding Path="HonorificVm.DisplayName" />
            <Binding Path="PersonNameVm.DisplayName" />
          </MultiBinding>
        </Setter.Value>
      </Setter>
      <Style.Triggers>
        <DataTrigger Binding="{Binding HonorificVm.Honorific}"
                     Value="{x:Static model:Honorific.NullHonorific}">
          <Setter Property="Text" Value="{Binding PersonNameVm.DisplayName}" />
        </DataTrigger>
      </Style.Triggers>
    </Style>
  </TextBlock.Style>
</TextBlock> 
```

# android - 从标准 Java 类完成活动

> ID：11197478
> 
> 赞同：0
> 
> 时间：2012-06-25T21:16:42.037
> 
> 标签：android, android-activity

我目前正在开发一个 android 项目并且我有一个活动，我们称之为 MyActivity，这个活动调用一个名为 MyClass 的标准 Java 类。

我需要 MyClass 来完成 MyActivity 活动，但我不知道如何做到这一点。我想我可能能够将上下文传递给标准 java 类并调用 context.finish() 但这似乎不可用。

我该怎么做，感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T23:35:59.760

最安全的解决方案使用侦听器和处理程序。它很复杂，但确保非直接调用完成活动。

你的听众：

```
interface OnWantToCloseListener{
     public void onWantToClose();
} 
```

应该关闭活动的类。

```
class MyClass {

    private OnWantToCloseListener listener;

    public void setWantToCloseListener(OnWantToCloseListener listener){
        this.listener = listener;
    }

    private void fireOnWantToClose(){
        if(this.listener != null)
            listener.onWantToClose();
    }
} 
```

当你想关闭你的活动时，你必须调用 fireOnWantToClose() 方法。

```
public MyActivity extends Activity{

    public void onCreate(){
        final int CLOSE = 1; //number to identify what happens
        MyClass my_class = new MyClass();
        final Handler handler = new Handler(){
             public void handleMessage(Message msg){
                 if(msg.what == CLOSE)
                      MyActivity.this.finish();
             }
        });
        my_class.setOnWantToCloseListener(new OnWantToCloseListener(){
             public void onWantToClose(){
                  handler.sendEmptyMessage(CLOSE);
             }
        });
    }
} 
```

这是安全的，因为 Activity 不是由 MyClass 对象直接完成的，它是通过一个侦听器完成的，该侦听器命令处理程序完成活动。即使您在第二个线程上运行 MyClass 对象，此代码也可以正常工作。

编辑： CLOSE var 添加了我忘记声明和初始化它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T21:18:22.540

您*可以*传递`Context`，但您需要将其转换为`Activity`（或简单地传递`Activity`自身），尽管这通常看起来是一种不好的做法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T21:18:29.920

将`MyActivity`to`MyClass`作为`Activity`. 从那里你可以打电话`myActivity.finish();`

例如：

```
private Activity myActivity;

public MyClass(Activity myActivity){
    this.myActivity = myActivity;
}

public void stopMyActivity(){
    myActivity.finish();
} 
```

并在`MyActivity`：

```
MyClass myClass = new MyClass(this); 
```

这是有风险的，因为您持有对 an 的引用`Activity`，这可能会导致内存泄漏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T21:19:53.797

如果你的 java 类是一个嵌套的内部类，你可以使用：

```
public class MyActivity extends Activity {

    public static class JavaClass {    

        public void finishActivity() {
            MyActivity.finish();
        }
    }    
} 
```

否则，您将不得不传递 java 类 a `Context`（即传递一个对`this`, since的引用`Activity extends Context`）并将其存储为私有实例变量。

# c++ - PIX DirectX 11 调试像素错误

> ID：11197488
> 
> 赞同：3
> 
> 时间：2012-06-25T21:17:39.760
> 
> 标签：c++, debugging, directx-11, dxgi, pix

我最近更新了我的 DirectX 11 (C++) 应用程序以支持双显示器、双窗口。从那时起，当我尝试在 PIX 调试器中调试任何像素时，我收到以下错误：

```
A call that previously succeeded failed during playback:

EID: 1375 
Call: IDXGIFactory::CreateSwapChain() 
HRESULT: DXGI_ERROR_INVALID_CALL

For more information click 'Help'. 
```

我不再使用 D3D11CreateDeviceAndSwapChain，而是使用 D3D11CreateDevice 然后 CreateSwapChain 为两个窗口中的每一个（每个监视器一个）创建单独的交换链。在进行更改时，我使用了 SDK 示例 MultiMon10 作为参考，但是通过 PIX 运行 MultiMon10 示例项目时，我仍然可以毫无错误地调试像素。所以这不仅仅是“CreateSwapChain”对 PIX 不友好的问题。

任何想法可能导致此错误？过去，调试像素和逐步通过着色器帮助了我很多，我不想失去这种能力。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T01:16:32.197

好像我遇到了同样的问题。Visual Studio 2012 图形调试也会发生这种情况。必须是 DX 调试模式下的 CreateSwapChain。

我一直在使用[英特尔的 GPA 工具](http://software.intel.com/en-us/vcsource/tools/intel-gpa)来解决这个问题。我觉得它非常有用。它可用于在同一台机器上或通过客户端/服务器模型进行调试。

# reshape - 在Stata中没有唯一“j”变量的情况下如何重塑？

> ID：11197490
> 
> 赞同：2
> 
> 时间：2012-06-25T21:17:44.150
> 
> 标签：reshape, stata

所以这是我的麻烦：我想将一个长格式的数据文件改成宽格式。但是，我没有唯一的“j”变量；长格式文件中的每条记录都有几个关键变量。

例如，我想这样做：

```
| caseid | gender | age | relationship to respondent|
|---------------------------------------------------|
| 1234   |   F    | 89  | mother                    |
| 1234   |   F    | 10  | daughter                  |
| 1235   |   M    | 15  | cousin                    |
etc 
```

并将其变成这样：

```
|caseid  | gender1 | age1 | rel1  |  gender2  | age2 | rel2    |
|--------------------------------------------------------------|
| 1234   | F       | 89   | mother| F         | 10   | daughter|
| 1235   | M       | 15   | cousin| .         | .    | .       |
etc 
```

但是，数据缺少 reshape 命令所需的后缀变量。Stata有没有办法自动生成这个后缀？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T07:18:38.033

样本数据：

```
 +----------------------------------+
     | caseid   gender   age   relati~p |
     |----------------------------------|
  1\. |   1234        F    89     mother |
  2\. |   1234        F    10   daughter |
  3\. |   1235        M    15     cousin |
  4\. |   1235        F    14     sister |
  5\. |   1235        F    55     mother |
     |----------------------------------|
  6\. |   1236        M    32    brother |
  7\. |   1236        M    68     father |
     +----------------------------------+ 
```

生成一个新的id：

```
. by caseid: gen newid = _n 
```

给你这个：

```
 +------------------------------------------+
     | caseid   gender   age   relati~p   newid |
     |------------------------------------------|
  1\. |   1234        F    89     mother       1 |
  2\. |   1234        F    10   daughter       2 |
  3\. |   1235        M    15     cousin       1 |
  4\. |   1235        F    14     sister       2 |
  5\. |   1235        F    55     mother       3 |
     |------------------------------------------|
  6\. |   1236        M    32    brother       1 |
  7\. |   1236        M    68     father       2 |
     +------------------------------------------+ 
```

你现在可以用这个重塑：

```
. reshape wide gender age relationship, i(caseid) j(newid) 
```

要得到这个：

```
 +--------------------------------------------------------------------------------------------+
     | caseid   gender1   age1   relati~1   gender2   age2   relati~2   gender3   age3   relati~3 |
     |--------------------------------------------------------------------------------------------|
  1\. |   1234         F     89     mother         F     10   daughter                .            |
  2\. |   1235         M     15     cousin         F     14     sister         F     55     mother |
  3\. |   1236         M     32    brother         M     68     father                .            |
     +--------------------------------------------------------------------------------------------+ 
```

# javascript - 用于将元素从调色板拖动到 HTML5 画布的库

> ID：11197492
> 
> 赞同：0
> 
> 时间：2012-06-25T21:17:49.967
> 
> 标签：javascript, html, css, html5-canvas

想知道是否有人听说过一个 JavaScript 库，它允许将元素（不同形状的简单基础图，可以相互连接）从自定义调色板拖到（HTML5）画布上？

在最佳情况下，可以使用 SVG 矢量图形来填充调色板。

一方面[raphael](http://raphaeljs.com/)似乎太低级（但非常适合绘图），另一方面[Fabric.js](http://fabricjs.com/)过于具体，无法在画布上安排 SVG 对象。

# dynamics-crm - 是否可以在插件之后运行 javascript

> ID：11197495
> 
> 赞同：-3
> 
> 时间：2012-06-25T21:18:02.260
> 
> 标签：dynamics-crm, dynamics-crm-4, jscript

我有一个更新一些自定义字段的插件，我想运行一些 javascript 来验证字段并在需要时向用户显示警报消息....这可能吗（动态 crm 4）

谢谢，蒂姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T09:04:12.527

首先，插件是服务器端代码，而 JScript 是客户端。两者之间不能*直接通信——当然不是按照你建议的方向（导致 JScript 触发的插件）。*如果工作流更新记录并导致插件触发，则没有（交互式）用户发出警报。

正如@MilkyWayJoe 所建议的那样-您没有在问题中提供足够的信息来帮助我们正确回答，但是：

如果您建议在插件触发后，当用户下次打开记录时会提示他们填写缺失的字段，那么您只需将一些 JScript 附加到表单的 onLoad 事件，该事件会检查您指定的字段并引发`alert`. 阅读 SDK 了解更多信息（例如[这里](http://msdn.microsoft.com/en-us/library/cc468411.aspx)和[这里](http://msdn.microsoft.com/en-us/library/cc468408.aspx)）。

否则，（并且不知道您的特定业务需求）我可能会建议将丢失数据的检查封装在您的插件中，如果必要字段为空，则会引发异常。

# sql - 简单的 SQL 查询

> ID：11197496
> 
> 赞同：0
> 
> 时间：2012-06-25T21:18:03.050
> 
> 标签：sql

我有以下数据：

学生姓名; 学生.RollNum; 学生.Email; 学生。课程；学生。生日；课程.ID ; 课程名; 课程.讲师

现在这是我提出的数据库设计：两个表=> 学生，课程 Student.ID 是添加的新字段-> 学生表的主唯一键

现在查询 John Doe（其 Student.ID=1234）所学的所有课程的查询是什么？

我需要课程的名称，而不是 ID。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:20:51.487

我会用 3 个表来设计它：

```
Students - ID; Name; RollNum; Email; Birthday;
Courses - ID; Name; Instructor
Students_Courses - a join table between the students and the courses 
```

然后您可以执行以下操作

```
SELECT c.Name
FROM Students s
INNER JOIN Students_Courses sc
    ON s.id = sc.studentId
INNER JOIN Courses c
    ON sc.course_id = c.courseid
WHERE s.id = 1234 
```

或者，如果您不想要任何学生信息，您可以将查询缩短为：

```
SELECT c.Name
FROM Students_Courses sc
INNER JOIN Courses c
    ON sc.course_id = c.courseid
WHERE sc.studentId = 1234 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:23:21.720

家庭作业？您需要一个新表，比如说 StudentCourses，它代表学生和他参加的课程之间的关系。您需要将 CourseId 添加到 Course 表。因此，StudentCourses 定义为：

```
StudentCourses(StudentId, CourseId) 
```

此时，您将获得参加过的课程并加入：

```
SELECT Courses.*
FROM Courses JOIN StudentsCourses sc ON sc.CourseId = Courses.CourseId
WHERE sc.StudenId = [DesideredStudentId] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:23:37.343

你的桌子设计有缺陷。您将所有课程一起列出在一个列（Student.Courses）中，并且您无法正确使用该列中的单个项目的便携式 sql。您需要将 studentID 与 courseID（可能还有一年/学期）配对的第三个表（Enrollments）。

但是假设你添加了这个表，sql看起来像这样：

```
SELECT c.Name
FROM Enrollments e
INNER JOIN Courses c on c.ID = e.CourseID
WHERE e.StudentID = 1234 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T21:32:22.190

实际上，您需要第三个表来保存每个学生所学的课程，可以像 2 列表（StudentId，CourseId）一样简单，查询将是

```
SELECT c.Name
FROM Students as s
JOIN CoursesTaken as t on t.StudentId = s.Id
JOIN Courses as c on c.id = t.CourseId
WHERE s.Id = 1234 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-25T21:22:25.343

我会添加**第三个表**来加入学生和课程。这将允许许多学生参加许多课程。该表将存储 StudentId 和 CourseId。然后，您可以使用以下查询获得所需的结果：

```
SELECT c.Id, c.CourseName
FROM Courses c
    INNER JOIN StudentCourse sc
     ON c.CourseId = sc.CourseId
WHERE sc.StudentId = 1234 
```

# forms - 验证 knockout.js 表单？

> ID：11197497
> 
> 赞同：27
> 
> 时间：2012-06-25T21:18:04.337
> 
> 标签：forms, validation, knockout.js

我在我的 ASP.NET MVC 项目中使用了 knockout.js。我通过以下链接了解了如何显示表单、序列化 JSON 对象和显示数据： [如何将 knockout.js 与 ASP.NET MVC ViewModels 一起使用？](https://stackoverflow.com/questions/11055336/how-to-use-knockout-js-with-asp-net-mvc-viewmodels)

但我无法弄清楚如何验证表格。验证表单的最佳解决方案是什么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-06-26T15:20:37.913

我使用了他的 Knockout.Validation 插件（[https://github.com/Knockout-Contrib/Knockout-Validation](https://github.com/Knockout-Contrib/Knockout-Validation)），效果很好。它在 Knockout 中使用扩展器，因此您可以扩展模型属性以包含所需、最小、最大或模式匹配等规则。您还可以创建自定义规则。例如，我为 url 创建了一个。它也有一些针对电子邮件等内容的内置规则。所有这些都在文档的 github 页面中。它拥有您入门所需的一切。

另一种选择是使用 jquery 验证，它也很有效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-25T22:15:03.223

试试 Knockout.Validation 插件：

[https://github.com/Knockout-Contrib/Knockout-Validation](https://github.com/Knockout-Contrib/Knockout-Validation)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-07-31T15:44:27.263

虽然答案被接受，但我想分享我的方法。我更喜欢将 jquery 与 knockout.js 结合使用，并应用非常适合不显眼的客户端表单验证的[jQuery Validation 插件。](http://jqueryvalidation.org/)它在表单提交之前工作并接受表单作为输入参数。像这样的东西：

```
 function ViewModel() {
       var self = this;
       self.firstName = ko.observable();
       self.lastName = ko.observable();
       self.email = ko.observable();
       self.validate = function(form) {
           return $(form).validate();
       };
    };
    var viewModel = new ViewModel();
    ko.applyBindings(viewModel); 
```

调用 validate() 函数，如果验证成功，就会提交表单，否则会报错。

# matlab - 如何将矩阵插入到所需的大小？

> ID：11197502
> 
> 赞同：1
> 
> 时间：2012-06-25T21:18:20.340
> 
> 标签：matlab, matrix

我想将 58:2 矩阵插入 57:1 矩阵。

其实我想解决

```
(A(t)-P2i(t))v(t)=dv/dt 
```

我有 p2i 大小作为`57:1.A=[0 1;a0 a1]`位置`a0`并且`a1`也是随时间变化的。在插值 和 的大小之后`a0`，`a1`现在`57:1`A 的大小变成了`58:1`。我正在尝试使用 ode45 解决上述方程，但由于 A 和 p2i 的尺寸不同而无法解决。

谁能帮我这个？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T15:03:37.470

区别：A(t)-P2i(t) 没有定义

您可以尝试采用 A 的子矩阵，或用一些零填充 P2i。

如果要插入此矩阵，可以考虑定义一个新矩阵 M 其中 M(i,:) = (A(i,:) + A(i+1,:)) / 2

# html - 带有倾斜第一层的 CSS 下拉菜单

> ID：11197508
> 
> 赞同：1
> 
> 时间：2012-06-25T21:19:03.493
> 
> 标签：html, css

我试图创建一个带有下拉选项的菜单。诀窍是第一级选项是倾斜的，子元素不应该是 . 我不能在不取消父列表标签的情况下取消链接父列表中的链接。

```
<body>
      <ul id="nav">
        <li class="rhombus"><a class="rhlink"  href="#">1 HTML</a>
             <ul>
               <li><a href="#">3.2 Mootools</a></li>
               <li><a href="#">3.3 Prototype</a></li>
             </ul>
        </li>
        <li class="rhombus"><a class="rhlink" href="#">2 CSS</a></li>
        <li class="rhombus"><a class="rhlink" href="#">3 Javascript</a>
            <ul>
                <li><a href="#">3.1 jQuery</a>
                    <ul>
                        <li><a href="#">3.1.1 Download</a></li>
                        <li><a href="#">3.1.2 Tutorial</a></li>
                    </ul>
                </li>
                <li><a href="#">3.2 Mootools</a></li>
                <li><a href="#">3.3 Prototype</a></li>
            </ul>
        </li>
    </ul>
</body> 
```

CSS：

```
#nav, #nav ul{
     margin:0;
     padding:0;
     list-style-type:none;
     list-style-position:outside;
     position:relative;
     line-height:1.5em;

 }

#nav a:link, #nav a:active, #nav a:visited{
    display:block;
    padding:0px 5px;
    border:1px solid #333;
    color:#fff;
    text-decoration:none;
    background-color:#00ff21;

 }

#nav a:hover{
    background-color:#fff;
    color:#333;
}

#nav li{
    float:left;
    position:relative;

}

li.rhombus{
    float:left;
    position: relative;
    transform: skew(35deg);
    -webkit-transform: skew(35deg);
    -moz-transform: skew(35deg);
    -ms-transform: skew(35deg);
    -o-transform: skew(35deg);
}

#nav ul {
    position:absolute;
    width:12em;
    top:1.5em;
    display:none;
    transform: skew(-35deg);
    -webkit-transform: skew(-35deg);
    -moz-transform: skew(-35deg);
    -ms-transform: skew(-35deg);
    -o-transform: skew(-35deg);
}
#nav li ul a{
    width:12em;
    float:left;

}

#nav ul ul{
    top:auto;
    }

#nav li ul ul {
    left:12em;
    margin:0px 0 0 10px;
    transform: skew(-0deg);
    -webkit-transform: skew(-0deg);
    -moz-transform: skew(-0deg);
    -ms-transform: skew(-0deg);
    -o-transform: skew(-0deg);

    }

#nav li:hover ul ul, #nav li:hover ul ul ul, #nav li:hover ul ul ul ul{
    display:none;
    }
#nav li:hover ul, #nav li li:hover ul, #nav li li li:hover ul, #nav li li li li:hover ul{
    display:block;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:58:22.493

只需添加一个新`<span>`元素并指定[`transform-origin`](https://developer.mozilla.org/en/CSS/transform-origin)（[示例](http://jsfiddle.net/Ljpdd/2/)）。

## 新的 HTML

在每个锚点`<span>`的文本周围添加一个。`.rhlink`

```
<ul id="nav">
    <li class="rhombus"><a class="rhlink"  href="#"><span>1 HTML</span></a>
         <ul>
           <li><a href="#">3.2 Mootools</a></li>
           <li><a href="#">3.3 Prototype</a></li>
         </ul>
    </li>
    <li class="rhombus"><a class="rhlink" href="#"><span>2 CSS</span></a></li>
    <li class="rhombus"><a class="rhlink" href="#"><span>3 Javascript</span></a>
        <ul>
            <li><a href="#">3.1 jQuery</a>
                <ul>
                    <li><a href="#">3.1.1 Download</a></li>
                    <li><a href="#">3.1.2 Tutorial</a></li>
                </ul>
            </li>
            <li><a href="#">3.2 Mootools</a></li>
            <li><a href="#">3.3 Prototype</a></li>
        </ul>
    </li>
</ul> 
```

## 新的 CSS

基本上，您只需要`skew()`新添加`<span>`的并指定`transform-origin`以使子菜单对齐。`skew()`不能在锚本身上使用负数，因为锚包含可见内容 (`border`和`background`)，因此看起来好像没有应用任何倾斜。添加孩子`<span>`可以让您保留`background`/`border`和`:hover`效果。

```
#nav,
#nav ul {
     margin:0;
     padding:0;
     list-style-type:none;
     list-style-position:outside;
     position:relative;
     line-height:1.5em;
}

#nav a:link,
#nav a:active,
#nav a:visited {
    display:block;
    padding:0px 5px;
    border:1px solid #333;
    color:#fff;
    text-decoration:none;
    background-color:#00ff21;
}

#nav a:hover {
    background-color:#fff;
    color:#333;
}

#nav > li {
    float:left;
    position:relative;
}

li.rhombus {
    float:left;
    position: relative;
    -webkit-transform-origin:0 0;
    -moz-transform-origin:0 0;
    -ms-transform-origin:0 0;
    -o-transform-origin:0 0;
    transform-origin:0 0;
    -webkit-transform:skew(35deg);
    -moz-transform:skew(35deg);
    -ms-transform:skew(35deg);
    -o-transform:skew(35deg);
    transform:skew(35deg);
}

li.rhombus > a span {
    -webkit-transform:skew(-35deg);
    -moz-transform:skew(-35deg);
    -ms-transform:skew(-35deg);
    -o-transform:skew(-35deg);
    transform:skew(-35deg);
    display:block;
}

li.rhombus > ul {
    -webkit-transform-origin:0 0;
    -moz-transform-origin:0 0;
    -ms-transform-origin:0 0;
    -o-transform-origin:0 0;
    transform-origin:0 0;
    -webkit-transform:skew(-35deg);
    -moz-transform:translate(0,1px) skew(-35deg);
    -ms-transform:skew(-35deg);
    -o-transform:skew(-35deg);
    transform:skew(-35deg);
}

#nav ul {
    position:absolute;
    top:1.5em;
    left:0;
    width:12em;
    display:none;
}

#nav li ul a {
    width:12em;
    float:left;
}

#nav ul ul {
    top:auto;
}

#nav li ul ul {
    left:12em;
    margin:0px 0 0 10px;
}

#nav li:hover ul ul,
#nav li:hover ul ul ul,
#nav li:hover ul ul ul ul {
    display:none;
}

#nav li:hover ul,
#nav li li:hover ul,
#nav li li li:hover ul,
#nav li li li li:hover ul {
    display:block;
} 
```

# ios - 如何在 iOS 上获取设备品牌和型号？

> ID：11197509
> 
> 赞同：263
> 
> 时间：2012-06-25T21:19:06.500
> 
> 标签：ios, objective-c, iphone, ipad

我想知道是否可以确定当前设备是哪种 iPhone（例如）？我知道可以通过该模型
`NSString *deviceType = [[UIDevice currentDevice] model];`
返回无论我有“iPhone”还是“iPod”，但我想知道是否有可能检测/知道我是否有 iPhone 3GS vs. 和 iPhone 4 vs. iPhone 4S *（实际上，我真正想做的就是确定我是否有 3G，因为我正在做相当图形密集型的东西）*。

所以，是的，请告诉我，谢谢！

* * *

## 回答 #1

> 赞同：586
> 
> 时间：2012-06-25T21:41:05.963

试试这个库： http: [//github.com/erica/uidevice-extension/](http://github.com/erica/uidevice-extension/)（作者 Erica Sadun）。（图书馆已有 7-8 年历史，因此已过时）

（示例代码）：

```
 [[UIDevice currentDevice] platformType]   // ex: UIDevice4GiPhone
    [[UIDevice currentDevice] platformString] // ex: @"iPhone 4G" 
```

或者您可以使用此方法：

您可以使用 uname 从 sys/utsname.h 获取设备型号。例如：

**Objective-C**

```
 #import <sys/utsname.h> // import it in your header or implementation file.

    NSString* deviceName()
    {
        struct utsname systemInfo;
        uname(&systemInfo);

        return [NSString stringWithCString:systemInfo.machine
                                  encoding:NSUTF8StringEncoding];
    } 
```

**斯威夫特 3**

```
 extension UIDevice {
        var modelName: String {
            var systemInfo = utsname()
            uname(&systemInfo)
            let machineMirror = Mirror(reflecting: systemInfo.machine)
            let identifier = machineMirror.children.reduce("") { identifier, element in
                guard let value = element.value as? Int8, value != 0 else { return identifier }
                return identifier + String(UnicodeScalar(UInt8(value)))
            }
            return identifier
        }
    }

    print(UIDevice.current.modelName) 
```

结果应该是：

```
// Output on a simulator
@"i386"      on 32-bit Simulator
@"x86_64"    on 64-bit Simulator

// Output on an iPhone
@"iPhone1,1" on iPhone
@"iPhone1,2" on iPhone 3G
@"iPhone2,1" on iPhone 3GS
@"iPhone3,1" on iPhone 4 (GSM)
@"iPhone3,2" on iPhone 4 (GSM Rev A)
@"iPhone3,3" on iPhone 4 (CDMA/Verizon/Sprint)
@"iPhone4,1" on iPhone 4S
@"iPhone5,1" on iPhone 5 (model A1428, AT&T/Canada)
@"iPhone5,2" on iPhone 5 (model A1429, everything else)
@"iPhone5,3" on iPhone 5c (model A1456, A1532 | GSM)
@"iPhone5,4" on iPhone 5c (model A1507, A1516, A1526 (China), A1529 | Global)
@"iPhone6,1" on iPhone 5s (model A1433, A1533 | GSM)
@"iPhone6,2" on iPhone 5s (model A1457, A1518, A1528 (China), A1530 | Global)
@"iPhone7,1" on iPhone 6 Plus
@"iPhone7,2" on iPhone 6
@"iPhone8,1" on iPhone 6S
@"iPhone8,2" on iPhone 6S Plus
@"iPhone8,4" on iPhone SE
@"iPhone9,1" on iPhone 7 (CDMA)
@"iPhone9,3" on iPhone 7 (GSM)
@"iPhone9,2" on iPhone 7 Plus (CDMA)
@"iPhone9,4" on iPhone 7 Plus (GSM)
@"iPhone10,1" on iPhone 8 (CDMA)
@"iPhone10,4" on iPhone 8 (GSM)
@"iPhone10,2" on iPhone 8 Plus (CDMA)
@"iPhone10,5" on iPhone 8 Plus (GSM)
@"iPhone10,3" on iPhone X (CDMA)
@"iPhone10,6" on iPhone X (GSM)
@"iPhone11,2" on iPhone XS
@"iPhone11,4" on iPhone XS Max
@"iPhone11,6" on iPhone XS Max China
@"iPhone11,8" on iPhone XR
@"iPhone12,1" on iPhone 11
@"iPhone12,3" on iPhone 11 Pro
@"iPhone12,5" on iPhone 11 Pro Max
@"iPhone12,8" on iPhone SE (2nd Gen)
@"iPhone13,1" on iPhone 12 Mini
@"iPhone13,2" on iPhone 12
@"iPhone13,3" on iPhone 12 Pro
@"iPhone13,4" on iPhone 12 Pro Max

//iPad 1
@"iPad1,1" on iPad - Wifi (model A1219)
@"iPad1,2" on iPad - Wifi + Cellular (model A1337)

//iPad 2
@"iPad2,1" - Wifi (model A1395)
@"iPad2,2" - GSM (model A1396)
@"iPad2,3" - 3G (model A1397)
@"iPad2,4" - Wifi (model A1395)

// iPad Mini
@"iPad2,5" - Wifi (model A1432)
@"iPad2,6" - Wifi + Cellular (model  A1454)
@"iPad2,7" - Wifi + Cellular (model  A1455)

//iPad 3
@"iPad3,1" - Wifi (model A1416)
@"iPad3,2" - Wifi + Cellular (model  A1403)
@"iPad3,3" - Wifi + Cellular (model  A1430)

//iPad 4
@"iPad3,4" - Wifi (model A1458)
@"iPad3,5" - Wifi + Cellular (model  A1459)
@"iPad3,6" - Wifi + Cellular (model  A1460)

//iPad AIR
@"iPad4,1" - Wifi (model A1474)
@"iPad4,2" - Wifi + Cellular (model A1475)
@"iPad4,3" - Wifi + Cellular (model A1476)

// iPad Mini 2
@"iPad4,4" - Wifi (model A1489)
@"iPad4,5" - Wifi + Cellular (model A1490)
@"iPad4,6" - Wifi + Cellular (model A1491)

// iPad Mini 3
@"iPad4,7" - Wifi (model A1599)
@"iPad4,8" - Wifi + Cellular (model A1600)
@"iPad4,9" - Wifi + Cellular (model A1601)

// iPad Mini 4
@"iPad5,1" - Wifi (model A1538)
@"iPad5,2" - Wifi + Cellular (model A1550)

//iPad AIR 2
@"iPad5,3" - Wifi (model A1566)
@"iPad5,4" - Wifi + Cellular (model A1567)

// iPad PRO 9.7"
@"iPad6,3" - Wifi (model A1673)
@"iPad6,4" - Wifi + Cellular (model A1674)
@"iPad6,4" - Wifi + Cellular (model A1675)

//iPad PRO 12.9"
@"iPad6,7" - Wifi (model A1584)
@"iPad6,8" - Wifi + Cellular (model A1652)

//iPad (5th generation)
@"iPad6,11" - Wifi (model A1822)
@"iPad6,12" - Wifi + Cellular (model A1823)

//iPad PRO 12.9" (2nd Gen)
@"iPad7,1" - Wifi (model A1670)
@"iPad7,2" - Wifi + Cellular (model A1671)
@"iPad7,2" - Wifi + Cellular (model A1821)

//iPad PRO 10.5"
@"iPad7,3" - Wifi (model A1701)
@"iPad7,4" - Wifi + Cellular (model A1709)

// iPad (6th Gen)
@"iPad7,5" - WiFi
@"iPad7,6" - WiFi + Cellular

// iPad (7th Gen)
@"iPad7,11" - WiFi
@"iPad7,12" - WiFi + Cellular

//iPad PRO 11"
@"iPad8,1" - WiFi
@"iPad8,2" - 1TB, WiFi
@"iPad8,3" - WiFi + Cellular
@"iPad8,4" - 1TB, WiFi + Cellular

//iPad PRO 12.9" (3rd Gen)
@"iPad8,5" - WiFi
@"iPad8,6" - 1TB, WiFi
@"iPad8,7" - WiFi + Cellular
@"iPad8,8" - 1TB, WiFi + Cellular

//iPad PRO 11" (2nd Gen)
@"iPad8,9" - WiFi
@"iPad8,10" - 1TB, WiFi

//iPad PRO 12.9" (4th Gen)
@"iPad8,11" - (WiFi)
@"iPad8,12" - (WiFi+Cellular)

// iPad mini 5th Gen
@"iPad11,1" - WiFi
@"iPad11,2" - Wifi  + Cellular

// iPad Air 3rd Gen
@"iPad11,3" - Wifi 
@"iPad11,4" - Wifi  + Cellular

// iPad (8th Gen)
@"iPad11,6" - iPad 8th Gen (WiFi)
@"iPad11,7" - iPad 8th Gen (WiFi+Cellular)

// iPad Air 4th Gen
@"iPad13,1" - iPad air 4th Gen (WiFi)
@"iPad13,2" - iPad air 4th Gen (WiFi+Cellular)

//iPod Touch
@"iPod1,1"   on iPod Touch
@"iPod2,1"   on iPod Touch Second Generation
@"iPod3,1"   on iPod Touch Third Generation
@"iPod4,1"   on iPod Touch Fourth Generation
@"iPod5,1"   on iPod Touch 5th Generation
@"iPod7,1"   on iPod Touch 6th Generation
@"iPod9,1"   on iPod Touch 7th Generation

// Apple Watch
@"Watch1,1" on Apple Watch 38mm case
@"Watch1,2" on Apple Watch 38mm case
@"Watch2,6" on Apple Watch Series 1 38mm case
@"Watch2,7" on Apple Watch Series 1 42mm case
@"Watch2,3" on Apple Watch Series 2 38mm case
@"Watch2,4" on Apple Watch Series 2 42mm case
@"Watch3,1" on Apple Watch Series 3 38mm case (GPS+Cellular)
@"Watch3,2" on Apple Watch Series 3 42mm case (GPS+Cellular)
@"Watch3,3" on Apple Watch Series 3 38mm case (GPS)
@"Watch3,4" on Apple Watch Series 3 42mm case (GPS)
@"Watch4,1" on Apple Watch Series 4 40mm case (GPS)
@"Watch4,2" on Apple Watch Series 4 44mm case (GPS)
@"Watch4,3" on Apple Watch Series 4 40mm case (GPS+Cellular)
@"Watch4,4" on Apple Watch Series 4 44mm case (GPS+Cellular)
@"Watch5,1" on Apple Watch Series 5 40mm case (GPS)
@"Watch5,2" on Apple Watch Series 5 44mm case (GPS)
@"Watch5,3" on Apple Watch Series 5 40mm case (GPS+Cellular)
@"Watch5,4" on Apple Watch Series 5 44mm case (GPS+Cellular)
@"Watch5,9" on Apple Watch SE 40mm case (GPS)
@"Watch5,10" on Apple Watch SE 44mm case (GPS)
@"Watch5,11" on Apple Watch SE 40mm case (GPS+Cellular)
@"Watch5,12" on Apple Watch SE 44mm case (GPS+Cellular)
@"Watch6,1" on Apple Watch Series 6 40mm case (GPS)
@"Watch6,2" on Apple Watch Series 6 44mm case (GPS)
@"Watch6,3" on Apple Watch Series 6 40mm case (GPS+Cellular)
@"Watch6,4" on Apple Watch Series 6 44mm case (GPS+Cellular) 
```

* * *

## 回答 #2

> 赞同：140
> 
> 时间：2013-11-19T02:44:32.403

扩展 OhhMee 上面的回答，我添加了一些故障保护以支持列表中未（尚未）包含的未来设备：

```
#import <sys/utsname.h>
#import "MyClass.h"

@implementation MyClass
{
    //(your private ivars)
}

- (NSString*) deviceName
{
    struct utsname systemInfo;

    uname(&systemInfo);

    NSString* code = [NSString stringWithCString:systemInfo.machine
                                        encoding:NSUTF8StringEncoding];

    static NSDictionary* deviceNamesByCode = nil;

    if (!deviceNamesByCode) {

        deviceNamesByCode = @{@"i386"      : @"Simulator",
                              @"x86_64"    : @"Simulator",
                              @"iPod1,1"   : @"iPod Touch",        // (Original)
                              @"iPod2,1"   : @"iPod Touch",        // (Second Generation)
                              @"iPod3,1"   : @"iPod Touch",        // (Third Generation)
                              @"iPod4,1"   : @"iPod Touch",        // (Fourth Generation)
                              @"iPod7,1"   : @"iPod Touch",        // (6th Generation)       
                              @"iPhone1,1" : @"iPhone",            // (Original)
                              @"iPhone1,2" : @"iPhone",            // (3G)
                              @"iPhone2,1" : @"iPhone",            // (3GS)
                              @"iPad1,1"   : @"iPad",              // (Original)
                              @"iPad2,1"   : @"iPad 2",            //
                              @"iPad3,1"   : @"iPad",              // (3rd Generation)
                              @"iPhone3,1" : @"iPhone 4",          // (GSM)
                              @"iPhone3,3" : @"iPhone 4",          // (CDMA/Verizon/Sprint)
                              @"iPhone4,1" : @"iPhone 4S",         //
                              @"iPhone5,1" : @"iPhone 5",          // (model A1428, AT&T/Canada)
                              @"iPhone5,2" : @"iPhone 5",          // (model A1429, everything else)
                              @"iPad3,4"   : @"iPad",              // (4th Generation)
                              @"iPad2,5"   : @"iPad Mini",         // (Original)
                              @"iPhone5,3" : @"iPhone 5c",         // (model A1456, A1532 | GSM)
                              @"iPhone5,4" : @"iPhone 5c",         // (model A1507, A1516, A1526 (China), A1529 | Global)
                              @"iPhone6,1" : @"iPhone 5s",         // (model A1433, A1533 | GSM)
                              @"iPhone6,2" : @"iPhone 5s",         // (model A1457, A1518, A1528 (China), A1530 | Global)
                              @"iPhone7,1" : @"iPhone 6 Plus",     //
                              @"iPhone7,2" : @"iPhone 6",          //
                              @"iPhone8,1" : @"iPhone 6S",         //
                              @"iPhone8,2" : @"iPhone 6S Plus",    //
                              @"iPhone8,4" : @"iPhone SE",         //
                              @"iPhone9,1" : @"iPhone 7",          //
                              @"iPhone9,3" : @"iPhone 7",          //
                              @"iPhone9,2" : @"iPhone 7 Plus",     //
                              @"iPhone9,4" : @"iPhone 7 Plus",     //
                              @"iPhone10,1": @"iPhone 8",          // CDMA
                              @"iPhone10,4": @"iPhone 8",          // GSM
                              @"iPhone10,2": @"iPhone 8 Plus",     // CDMA
                              @"iPhone10,5": @"iPhone 8 Plus",     // GSM
                              @"iPhone10,3": @"iPhone X",          // CDMA
                              @"iPhone10,6": @"iPhone X",          // GSM
                              @"iPhone11,2": @"iPhone XS",         //
                              @"iPhone11,4": @"iPhone XS Max",     //
                              @"iPhone11,6": @"iPhone XS Max",     // China
                              @"iPhone11,8": @"iPhone XR",         //
                              @"iPhone12,1": @"iPhone 11",         //
                              @"iPhone12,3": @"iPhone 11 Pro",     //
                              @"iPhone12,5": @"iPhone 11 Pro Max", //

                              @"iPad4,1"   : @"iPad Air",          // 5th Generation iPad (iPad Air) - Wifi
                              @"iPad4,2"   : @"iPad Air",          // 5th Generation iPad (iPad Air) - Cellular
                              @"iPad4,4"   : @"iPad Mini",         // (2nd Generation iPad Mini - Wifi)
                              @"iPad4,5"   : @"iPad Mini",         // (2nd Generation iPad Mini - Cellular)
                              @"iPad4,7"   : @"iPad Mini",         // (3rd Generation iPad Mini - Wifi (model A1599))
                              @"iPad6,7"   : @"iPad Pro (12.9\")", // iPad Pro 12.9 inches - (model A1584) 
                              @"iPad6,8"   : @"iPad Pro (12.9\")", // iPad Pro 12.9 inches - (model A1652) 
                              @"iPad6,3"   : @"iPad Pro (9.7\")",  // iPad Pro 9.7 inches - (model A1673)
                              @"iPad6,4"   : @"iPad Pro (9.7\")"   // iPad Pro 9.7 inches - (models A1674 and A1675)
                              };
    }

    NSString* deviceName = [deviceNamesByCode objectForKey:code];

    if (!deviceName) {
        // Not found on database. At least guess main device type from string contents:

        if ([code rangeOfString:@"iPod"].location != NSNotFound) {
            deviceName = @"iPod Touch";
        }
        else if([code rangeOfString:@"iPad"].location != NSNotFound) {
            deviceName = @"iPad";
        }
        else if([code rangeOfString:@"iPhone"].location != NSNotFound){
            deviceName = @"iPhone";
        }
        else {
            deviceName = @"Unknown";
        }
    }

    return deviceName;
}

// (rest of class implementation omitted)

@end 
```

我还省略了详细信息（例如“型号 A1507、A1516、A1526（中国）、A1529 | 全球”）并将其放在评论中，以防您想将其用作面向用户的字符串而不是吓坏他们。

* * *

**编辑：** [这个答案](https://stackoverflow.com/a/26962452/433373)提供了一个使用 Swift 2 的类似实现。

**编辑 2：**我刚刚添加了 iPad Pro 型号（两种尺寸）。供将来参考，型号/等。可以在[iPhone Wiki](https://www.theiphonewiki.com/wiki/Main_Page)中找到。

**编辑 3：**添加对 iPhone XS、iPhone XS Max 和 iPhone XR 的支持。

**编辑 4：**添加对 iPhone 11、iPhone 11 Pro 和 iPhone 11 Pro Max 的支持。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2013-07-15T13:47:56.710

我制作了 plist 文件来帮助您获取每个设备的完整名称（源代码在我的答案末尾）

根据[OhhMee 的回答](https://stackoverflow.com/a/11197770/2042510)，您可以像这样使用它：

**斯威夫特 4.0**

```
static func deviceName() -> String {

        var systemInfo = utsname()
        uname(&systemInfo)

        guard let iOSDeviceModelsPath = Bundle.main.path(forResource: "iOSDeviceModelMapping", ofType: "plist") else { return "" }
        guard let iOSDevices = NSDictionary(contentsOfFile: iOSDeviceModelsPath) else { return "" }

        let machineMirror = Mirror(reflecting: systemInfo.machine)
        let identifier = machineMirror.children.reduce("") { identifier, element in
            guard let value = element.value as? Int8, value != 0 else { return identifier }
            return identifier + String(UnicodeScalar(UInt8(value)))
        }

        return iOSDevices.value(forKey: identifier) as! String
    } 
```

不要忘记添加`#import <sys/utsname.h>`您的桥接头。

**目标 C**

```
#import <sys/utsname.h>

NSString *machineName()
{
    struct utsname systemInfo;
    uname(&systemInfo);

    NSString *iOSDeviceModelsPath = [[NSBundle mainBundle] pathForResource:@"iOSDeviceModelMapping" ofType:@"plist"];
    NSDictionary *iOSDevices = [NSDictionary dictionaryWithContentsOfFile:iOSDeviceModelsPath];

    NSString* deviceModel = [NSString stringWithCString:systemInfo.machine
                                               encoding:NSUTF8StringEncoding];

    return [iOSDevices valueForKey:deviceModel];
} 
```

**plist 文件：**

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>x86_64</key>
    <string>Simulator</string>
    <key>i386</key>
    <string>Simulator</string>
    <key>iPod1,1</key>
    <string>iPod Touch 1st Gen</string>
    <key>iPod2,1</key>
    <string>iPod Touch 2nd Gen</string>
    <key>iPod3,1</key>
    <string>iPod Touch 3rd Gen</string>
    <key>iPod4,1</key>
    <string>iPod Touch 4th Gen</string>
    <key>iPod5,1</key>
    <string>iPod Touch 5th Gen</string>
    <key>iPod7,1</key>
    <string>iPod Touch 6th Gen</string>
    <key>iPhone1,1</key>
    <string>iPhone</string>
    <key>iPhone1,2</key>
    <string>iPhone 3G</string>
    <key>iPhone2,1</key>
    <string>iPhone 3GS</string>
    <key>iPhone3,1</key>
    <string>iPhone 4</string>
    <key>iPhone3,2</key>
    <string>iPhone 4</string>
    <key>iPhone3,3</key>
    <string>iPhone 4</string>
    <key>iPhone4,1</key>
    <string>iPhone 4S</string>
    <key>iPhone5,1</key>
    <string>iPhone 5 model A1428</string>
    <key>iPhone5,2</key>
    <string>iPhone 5 model A1429</string>
    <key>iPhone5,3</key>
    <string>iPhone 5C</string>
    <key>iPhone5,4</key>
    <string>iPhone 5C</string>
    <key>iPhone6,1</key>
    <string>iPhone 5S</string>
    <key>iPhone6,2</key>
    <string>iPhone 5S</string>
    <key>iPhone7,2</key>
    <string>iPhone 6</string>
    <key>iPhone7,1</key>
    <string>iPhone 6 Plus</string>
    <key>iPhone8,1</key>
    <string>iPhone 6S</string>
    <key>iPhone8,2</key>
    <string>iPhone 6S Plus</string>
    <key>iPhone8,4</key>
    <string>iPhone SE</string>
    <key>iPhone9,1</key>
    <string>iPhone 7</string>
    <key>iPhone9,2</key>
    <string>iPhone 7 Plus</string>
    <key>iPhone9,3</key>
    <string>iPhone 7</string>
    <key>iPhone9,4</key>
    <string>iPhone 7 Plus</string>
    <key>iPhone10,1</key>
    <string>iPhone 8</string>
    <key>iPhone10,4</key>
    <string>iPhone 8</string>
    <key>iPhone10,2</key>
    <string>iPhone 8 Plus</string>
    <key>iPhone10,5</key>
    <string>iPhone 8 Plus</string>
    <key>iPhone10,3</key>
    <string>iPhone X</string>
    <key>iPhone10,6</key>
    <string>iPhone X</string>
    <key>iPhone11,2</key>
    <string>iPhone XS</string>
    <key>iPhone11,4</key>
    <string>iPhone XS Max</string>
    <key>iPhone11,6</key>
    <string>iPhone XS Max</string>
    <key>iPhone11,8</key>
    <string>iPhone XR</string>
    <key>iPad1,1</key>
    <string>iPad</string>
    <key>iPad2,1</key>
    <string>iPad 2</string>
    <key>iPad2,2</key>
    <string>iPad 2</string>
    <key>iPad2,3</key>
    <string>iPad 2</string>
    <key>iPad2,4</key>
    <string>iPad 2</string>
    <key>iPad3,1</key>
    <string>iPad 3rd Gen</string>
    <key>iPad3,2</key>
    <string>iPad 3rd Gen</string>
    <key>iPad3,3</key>
    <string>iPad 3rd Gen</string>
    <key>iPad3,4</key>
    <string>iPad 4th Gen</string>
    <key>iPad3,5</key>
    <string>iPad 4th Gen</string>
    <key>iPad3,6</key>
    <string>iPad 4th Gen</string>
    <key>iPad4,1</key>
    <string>iPad Air</string>
    <key>iPad4,2</key>
    <string>iPad Air</string>
    <key>iPad4,3</key>
    <string>iPad Air</string>
    <key>iPad2,5</key>
    <string>iPad Mini 1st Gen</string>
    <key>iPad2,6</key>
    <string>iPad Mini 1st Gen</string>
    <key>iPad2,7</key>
    <string>iPad Mini 1st Gen</string>
    <key>iPad4,4</key>
    <string>iPad Mini 2nd Gen</string>
    <key>iPad4,5</key>
    <string>iPad Mini 2nd Gen</string>
    <key>iPad4,6</key>
    <string>iPad Mini 2nd Gen</string>
    <key>iPad4,7</key>
    <string>iPad Mini 3rd Gen</string>
    <key>iPad4,8</key>
    <string>iPad Mini 3rd Gen</string>
    <key>iPad4,9</key>
    <string>iPad Mini 3rd Gen</string>
    <key>iPad5,1</key>
    <string>iPad Mini 4</string>
    <key>iPad5,2</key>
    <string>iPad Mini 4</string>
    <key>iPad5,3</key>
    <string>iPad Air 2</string>
    <key>iPad5,4</key>
    <string>iPad Air 2</string>
    <key>iPad6,3</key>
    <string>iPad Pro 9.7 inch</string>
    <key>iPad6,4</key>
    <string>iPad Pro 9.7 inch</string>
    <key>iPad6,7</key>
    <string>iPad Pro 12.9 inch</string>
    <key>iPad6,8</key>
    <string>iPad Pro 12.9 inch</string>
    <key>iPad7,1</key>
    <string>iPad Pro 12.9 inch 2nd Gen</string>
    <key>iPad7,2</key>
    <string>iPad Pro 12.9 inch 2nd Gen</string>
    <key>iPad7,3</key>
    <string>iPad Pro 10.5 inch</string>
    <key>iPad7,4</key>
    <string>iPad Pro 10.5 inch</string>
    <key>iPad8,1</key>
    <string>iPad Pro 11 inch</string>
    <key>iPad8,2</key>
    <string>iPad Pro 11 inch</string>
    <key>iPad8,3</key>
    <string>iPad Pro 11 inch</string>
    <key>iPad8,4</key>
    <string>iPad Pro 11 inch</string>
    <key>iPad8,5</key>
    <string>iPad Pro 12.9 inch 3rd Gen</string>
    <key>iPad8,6</key>
    <string>iPad Pro 12.9 inch 3rd Gen</string>
    <key>iPad8,7</key>
    <string>iPad Pro 12.9 inch 3rd Gen</string>
    <key>iPad8,8</key>
    <string>iPad Pro 12.9 inch 3rd Gen</string>
</dict>
</plist> 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2012-10-03T18:18:27.923

`[[UIDevice currentDevice] model]`只是返回`iPhone`或`iPod`，您不会获得可让您区分不同代设备的型号编号。

编码这个方法：

```
#include <sys/sysctl.h>
...

+ (NSString *)getModel {
    size_t size;
    sysctlbyname("hw.machine", NULL, &size, NULL, 0);
    char *model = malloc(size);
    sysctlbyname("hw.machine", model, &size, NULL, 0);
    NSString *deviceModel = [NSString stringWithCString:model encoding:NSUTF8StringEncoding];
    free(model);
    return deviceModel;
} 
```

并在您需要模型时调用该方法`[self getModel]`，您将得到 ie：“iPhone5,1”，用于超薄和快速的 iPhone 5。

一个好的做法是创建一个名为的类`Utils.h/Utils.m`并放置类似`getModel`那里的方法，这样您就可以通过导入类并调用从应用程序中的任何位置获取此信息`[Utils getModel];`

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2014-06-24T14:35:28.440

我优化了 NicolasMiari 的实现，并`Simulator`在此处添加：

```
+ (NSString*)deviceName {

  static NSDictionary* deviceNamesByCode = nil;
  static NSString* deviceName = nil;

  if (deviceName) {
    return deviceName;
  }

  deviceNamesByCode = @{
    @"i386"      :@"Simulator",
    @"iPod1,1"   :@"iPod Touch",      // (Original)
    @"iPod2,1"   :@"iPod Touch",      // (Second Generation)
    @"iPod3,1"   :@"iPod Touch",      // (Third Generation)
    @"iPod4,1"   :@"iPod Touch",      // (Fourth Generation)
    @"iPhone1,1" :@"iPhone",          // (Original)
    @"iPhone1,2" :@"iPhone",          // (3G)
    @"iPhone2,1" :@"iPhone",          // (3GS)
    @"iPad1,1"   :@"iPad",            // (Original)
    @"iPad2,1"   :@"iPad 2",          //
    @"iPad3,1"   :@"iPad",            // (3rd Generation)
    @"iPhone3,1" :@"iPhone 4",        //
    @"iPhone4,1" :@"iPhone 4S",       //
    @"iPhone5,1" :@"iPhone 5",        // (model A1428, AT&T/Canada)
    @"iPhone5,2" :@"iPhone 5",        // (model A1429, everything else)
    @"iPad3,4"   :@"iPad",            // (4th Generation)
    @"iPad2,5"   :@"iPad Mini",       // (Original)
    @"iPhone5,3" :@"iPhone 5c",       // (model A1456, A1532 | GSM)
    @"iPhone5,4" :@"iPhone 5c",       // (model A1507, A1516, A1526 (China), A1529 | Global)
    @"iPhone6,1" :@"iPhone 5s",       // (model A1433, A1533 | GSM)
    @"iPhone6,2" :@"iPhone 5s",       // (model A1457, A1518, A1528 (China), A1530 | Global)
    @"iPad4,1"   :@"iPad Air",        // 5th Generation iPad (iPad Air) - Wifi
    @"iPad4,2"   :@"iPad Air",        // 5th Generation iPad (iPad Air) - Cellular
    @"iPad4,4"   :@"iPad Mini",       // (2nd Generation iPad Mini - Wifi)
    @"iPad4,5"   :@"iPad Mini"        // (2nd Generation iPad Mini - Cellular)
  };

  struct utsname systemInfo;
  uname(&systemInfo);
  NSString* code = [NSString stringWithCString:systemInfo.machine encoding:NSUTF8StringEncoding];

  deviceName = [deviceNamesByCode objectForKey:code];

  if (!deviceName) {
    // Not found in database. At least guess main device type from string contents:

    if ([code rangeOfString:@"iPod"].location != NSNotFound) {
      deviceName = @"iPod Touch";
    } else if([code rangeOfString:@"iPad"].location != NSNotFound) {
      deviceName = @"iPad";
    } else if([code rangeOfString:@"iPhone"].location != NSNotFound){
      deviceName = @"iPhone";
    } else {
      deviceName = @"Simulator";
    }
  }

  return deviceName;
} 
```

```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2015-04-13T06:33:12.167

下面是代码（*代码可能不包含所有设备的字符串，我和其他人在**GitHub 上**维护相同的代码，所以请从那里获取最新代码*）

**目标-C**：[GitHub/DeviceUtil](https://github.com/InderKumarRathore/DeviceUtil)

**斯威夫特**：[GitHub/DeviceGuru](https://github.com/InderKumarRathore/DeviceGuru)

* * *

```
#include <sys/types.h>
#include <sys/sysctl.h>

- (NSString*)hardwareDescription {
    NSString *hardware = [self hardwareString];
    if ([hardware isEqualToString:@"iPhone1,1"]) return @"iPhone 2G";
    if ([hardware isEqualToString:@"iPhone1,2"]) return @"iPhone 3G";
    if ([hardware isEqualToString:@"iPhone3,1"]) return @"iPhone 4";
    if ([hardware isEqualToString:@"iPhone4,1"]) return @"iPhone 4S";
    if ([hardware isEqualToString:@"iPhone5,1"]) return @"iPhone 5";
    if ([hardware isEqualToString:@"iPod1,1"]) return @"iPodTouch 1G";
    if ([hardware isEqualToString:@"iPod2,1"]) return @"iPodTouch 2G";
    if ([hardware isEqualToString:@"iPad1,1"]) return @"iPad";
    if ([hardware isEqualToString:@"iPad2,6"]) return @"iPad Mini";
    if ([hardware isEqualToString:@"iPad4,1"]) return @"iPad Air WIFI";
    //there are lots of other strings too, checkout the github repo
    //link is given at the top of this answer

    if ([hardware isEqualToString:@"i386"]) return @"Simulator";
    if ([hardware isEqualToString:@"x86_64"]) return @"Simulator";

    return nil;
}

- (NSString*)hardwareString {
    size_t size = 100;
    char *hw_machine = malloc(size);
    int name[] = {CTL_HW,HW_MACHINE};
    sysctl(name, 2, hw_machine, &size, NULL, 0);
    NSString *hardware = [NSString stringWithUTF8String:hw_machine];
    free(hw_machine);
    return hardware;
} 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2015-02-01T10:56:12.413

## 一个远离 NSString 描述的类别

通常，最好避免在整个代码中进行任意字符串比较。最好在一处更新字符串并从您的应用程序中隐藏魔术字符串。`UIDevice`为此，我提供了一个类别。

对于我的特定需求，我需要知道我正在使用哪种设备，而无需了解可以通过其他方式轻松检索的网络功能的细节。`enum`因此，您会发现比不断增长的设备列表更粗粒度。

更新是将设备添加到枚举和查找表的问题。

### UIDevice+NTNUExtensions.h

```
typedef NS_ENUM(NSUInteger, NTNUDeviceType) {
    DeviceAppleUnknown,
    DeviceAppleSimulator,
    DeviceAppleiPhone,
    DeviceAppleiPhone3G,
    DeviceAppleiPhone3GS,
    DeviceAppleiPhone4,
    DeviceAppleiPhone4S,
    DeviceAppleiPhone5,
    DeviceAppleiPhone5C,
    DeviceAppleiPhone5S,
    DeviceAppleiPhone6,
    DeviceAppleiPhone6_Plus,
    DeviceAppleiPhone6S,
    DeviceAppleiPhone6S_Plus,
    DeviceAppleiPhoneSE,
    DeviceAppleiPhone7,
    DeviceAppleiPhone7_Plus,
    DeviceAppleiPodTouch,
    DeviceAppleiPodTouch2G,
    DeviceAppleiPodTouch3G,
    DeviceAppleiPodTouch4G,
    DeviceAppleiPad,
    DeviceAppleiPad2,
    DeviceAppleiPad3G,
    DeviceAppleiPad4G,
    DeviceAppleiPad5G_Air,
    DeviceAppleiPadMini,
    DeviceAppleiPadMini2G,
    DeviceAppleiPadPro12,
    DeviceAppleiPadPro9
};

@interface UIDevice (NTNUExtensions)

- (NSString *)ntnu_deviceDescription;
- (NTNUDeviceType)ntnu_deviceType;

@end 
```

### UIDevice+NTNUExtensions.m

```
#import <sys/utsname.h>
#import "UIDevice+NTNUExtensions.h"

@implementation UIDevice (NTNUExtensions)

- (NSString *)ntnu_deviceDescription
{
    struct utsname systemInfo;
    uname(&systemInfo);

    return [NSString stringWithCString:systemInfo.machine encoding:NSUTF8StringEncoding];
}

- (NTNUDeviceType)ntnu_deviceType
{
    NSNumber *deviceType = [[self ntnu_deviceTypeLookupTable] objectForKey:[self ntnu_deviceDescription]];
    return [deviceType unsignedIntegerValue];
}

- (NSDictionary *)ntnu_deviceTypeLookupTable
{
    return @{
             @"i386": @(DeviceAppleSimulator),
             @"x86_64": @(DeviceAppleSimulator),
             @"iPod1,1": @(DeviceAppleiPodTouch),
             @"iPod2,1": @(DeviceAppleiPodTouch2G),
             @"iPod3,1": @(DeviceAppleiPodTouch3G),
             @"iPod4,1": @(DeviceAppleiPodTouch4G),
             @"iPhone1,1": @(DeviceAppleiPhone),
             @"iPhone1,2": @(DeviceAppleiPhone3G),
             @"iPhone2,1": @(DeviceAppleiPhone3GS),
             @"iPhone3,1": @(DeviceAppleiPhone4),
             @"iPhone3,3": @(DeviceAppleiPhone4),
             @"iPhone4,1": @(DeviceAppleiPhone4S),
             @"iPhone5,1": @(DeviceAppleiPhone5),
             @"iPhone5,2": @(DeviceAppleiPhone5),
             @"iPhone5,3": @(DeviceAppleiPhone5C),
             @"iPhone5,4": @(DeviceAppleiPhone5C),
             @"iPhone6,1": @(DeviceAppleiPhone5S),
             @"iPhone6,2": @(DeviceAppleiPhone5S),
             @"iPhone7,1": @(DeviceAppleiPhone6_Plus),
             @"iPhone7,2": @(DeviceAppleiPhone6),
             @"iPhone8,1" :@(DeviceAppleiPhone6S),
             @"iPhone8,2" :@(DeviceAppleiPhone6S_Plus),
             @"iPhone8,4" :@(DeviceAppleiPhoneSE),
             @"iPhone9,1" :@(DeviceAppleiPhone7),
             @"iPhone9,3" :@(DeviceAppleiPhone7),
             @"iPhone9,2" :@(DeviceAppleiPhone7_Plus),
             @"iPhone9,4" :@(DeviceAppleiPhone7_Plus),
             @"iPad1,1": @(DeviceAppleiPad),
             @"iPad2,1": @(DeviceAppleiPad2),
             @"iPad3,1": @(DeviceAppleiPad3G),
             @"iPad3,4": @(DeviceAppleiPad4G),
             @"iPad2,5": @(DeviceAppleiPadMini),
             @"iPad4,1": @(DeviceAppleiPad5G_Air),
             @"iPad4,2": @(DeviceAppleiPad5G_Air),
             @"iPad4,4": @(DeviceAppleiPadMini2G),
             @"iPad4,5": @(DeviceAppleiPadMini2G),
             @"iPad4,7":@(DeviceAppleiPadMini),
             @"iPad6,7":@(DeviceAppleiPadPro12),
             @"iPad6,8":@(DeviceAppleiPadPro12),
             @"iPad6,3":@(DeviceAppleiPadPro9),
             @"iPad6,4":@(DeviceAppleiPadPro9)
             };
}

@end 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2016-06-29T10:28:59.120

# 设备名称和机器名称，基于 iOS 真实设备硬件

我对这个问题的解决方案基本上看起来与该线程中的**@NicolasMiari**答案有关。单独的实用程序类具有一组预定义的设备和机器名称，然后根据实际机器名称检索设备名称。

**注意：**此答案及其链接的 GitHub 项目已更新，以识别截至 2017 年 10 月当前最新的**iPhone（iPhone 8、8+、X）**。这也适用于**iOS11**。请访问 GitHub 存储库并查看，如果有问题，请给我反馈。

```
/*
 * Retrieves back the device name or if not the machine name.
 */
+ (NSString*)deviceModelName {
    struct utsname systemInfo;
    uname(&systemInfo);
    NSString *machineName = [NSString stringWithCString:systemInfo.machine encoding:NSUTF8StringEncoding];

    //MARK: More official list is at
    //http://theiphonewiki.com/wiki/Models
    //MARK: You may just return machineName. Following is for convenience

    NSDictionary *commonNamesDictionary =
    @{
      @"i386":     @"i386 Simulator",
      @"x86_64":   @"x86_64 Simulator",

      @"iPhone1,1":    @"iPhone",
      @"iPhone1,2":    @"iPhone 3G",
      @"iPhone2,1":    @"iPhone 3GS",
      @"iPhone3,1":    @"iPhone 4",
      @"iPhone3,2":    @"iPhone 4(Rev A)",
      @"iPhone3,3":    @"iPhone 4(CDMA)",
      @"iPhone4,1":    @"iPhone 4S",
      @"iPhone5,1":    @"iPhone 5(GSM)",
      @"iPhone5,2":    @"iPhone 5(GSM+CDMA)",
      @"iPhone5,3":    @"iPhone 5c(GSM)",
      @"iPhone5,4":    @"iPhone 5c(GSM+CDMA)",
      @"iPhone6,1":    @"iPhone 5s(GSM)",
      @"iPhone6,2":    @"iPhone 5s(GSM+CDMA)",

      @"iPhone7,1":    @"iPhone 6+(GSM+CDMA)",
      @"iPhone7,2":    @"iPhone 6(GSM+CDMA)",

      @"iPhone8,1":    @"iPhone 6S(GSM+CDMA)",
      @"iPhone8,2":    @"iPhone 6S+(GSM+CDMA)",
      @"iPhone8,4":    @"iPhone SE(GSM+CDMA)",
      @"iPhone9,1":    @"iPhone 7(GSM+CDMA)",
      @"iPhone9,2":    @"iPhone 7+(GSM+CDMA)",
      @"iPhone9,3":    @"iPhone 7(GSM+CDMA)",
      @"iPhone9,4":    @"iPhone 7+(GSM+CDMA)",

      @"iPad1,1":  @"iPad",
      @"iPad2,1":  @"iPad 2(WiFi)",
      @"iPad2,2":  @"iPad 2(GSM)",
      @"iPad2,3":  @"iPad 2(CDMA)",
      @"iPad2,4":  @"iPad 2(WiFi Rev A)",
      @"iPad2,5":  @"iPad Mini 1G (WiFi)",
      @"iPad2,6":  @"iPad Mini 1G (GSM)",
      @"iPad2,7":  @"iPad Mini 1G (GSM+CDMA)",
      @"iPad3,1":  @"iPad 3(WiFi)",
      @"iPad3,2":  @"iPad 3(GSM+CDMA)",
      @"iPad3,3":  @"iPad 3(GSM)",
      @"iPad3,4":  @"iPad 4(WiFi)",
      @"iPad3,5":  @"iPad 4(GSM)",
      @"iPad3,6":  @"iPad 4(GSM+CDMA)",

      @"iPad4,1":  @"iPad Air(WiFi)",
      @"iPad4,2":  @"iPad Air(GSM)",
      @"iPad4,3":  @"iPad Air(GSM+CDMA)",

      @"iPad5,3":  @"iPad Air 2 (WiFi)",
      @"iPad5,4":  @"iPad Air 2 (GSM+CDMA)",

      @"iPad4,4":  @"iPad Mini 2G (WiFi)",
      @"iPad4,5":  @"iPad Mini 2G (GSM)",
      @"iPad4,6":  @"iPad Mini 2G (GSM+CDMA)",

      @"iPad4,7":  @"iPad Mini 3G (WiFi)",
      @"iPad4,8":  @"iPad Mini 3G (GSM)",
      @"iPad4,9":  @"iPad Mini 3G (GSM+CDMA)",

      @"iPod1,1":  @"iPod 1st Gen",
      @"iPod2,1":  @"iPod 2nd Gen",
      @"iPod3,1":  @"iPod 3rd Gen",
      @"iPod4,1":  @"iPod 4th Gen",
      @"iPod5,1":  @"iPod 5th Gen",
      @"iPod7,1":  @"iPod 6th Gen",
      };

    NSString *deviceName = commonNamesDictionary[machineName];

    if (deviceName == nil) {
        deviceName = machineName;
    }

    return deviceName;
} 
```

我在一个类中添加了这个实现和一些其他方便的实用方法，并将它放在这个[GitHub Repository](https://github.com/randikachan/DeviceType)中。[您还可以在此Wiki 页面](https://www.theiphonewiki.com/wiki/Models)中找到最新的设备信息列表。

请访问它并使用它。

**更新：**

您可能需要导入 sys 框架，

```
#import <sys/utsname.h> 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2019-11-27T13:44:27.137

使用以下代码添加一个新文件并简单地调用`UIDevice.modelName`这包括迄今为止发布的所有型号，包括**iPhone 13**系列和**Swift 5.0**

```
import UIKit
import SystemConfiguration

public extension UIDevice {
    static let modelName: String = {
        var systemInfo = utsname()
        uname(&systemInfo)
        let machineMirror = Mirror(reflecting: systemInfo.machine)
        let identifier = machineMirror.children.reduce("") { identifier, element in
            guard let value = element.value as? Int8, value != 0 else { return identifier }
            return identifier + String(UnicodeScalar(UInt8(value)))
        }

        let deviceMapping = ["i386": "iPhone Simulator",
         "x86_64": "iPhone Simulator",
         "arm64": "iPhone Simulator",
         "iPhone1,1": "iPhone",
         "iPhone1,2": "iPhone 3G",
         "iPhone2,1": "iPhone 3GS",
         "iPhone3,1": "iPhone 4",
         "iPhone3,2": "iPhone 4 GSM Rev A",
         "iPhone3,3": "iPhone 4 CDMA",
         "iPhone4,1": "iPhone 4S",
         "iPhone5,1": "iPhone 5 (GSM)",
         "iPhone5,2": "iPhone 5 (GSM+CDMA)",
         "iPhone5,3": "iPhone 5C (GSM)",
         "iPhone5,4": "iPhone 5C (Global)",
         "iPhone6,1": "iPhone 5S (GSM)",
         "iPhone6,2": "iPhone 5S (Global)",
         "iPhone7,1": "iPhone 6 Plus",
         "iPhone7,2": "iPhone 6",
         "iPhone8,1": "iPhone 6s",
         "iPhone8,2": "iPhone 6s Plus",
         "iPhone8,4": "iPhone SE (GSM)",
         "iPhone9,1": "iPhone 7",
         "iPhone9,2": "iPhone 7 Plus",
         "iPhone9,3": "iPhone 7",
         "iPhone9,4": "iPhone 7 Plus",
         "iPhone10,1": "iPhone 8",
         "iPhone10,2": "iPhone 8 Plus",
         "iPhone10,3": "iPhone X Global",
         "iPhone10,4": "iPhone 8",
         "iPhone10,5": "iPhone 8 Plus",
         "iPhone10,6": "iPhone X GSM",
         "iPhone11,2": "iPhone XS",
         "iPhone11,4": "iPhone XS Max",
         "iPhone11,6": "iPhone XS Max Global",
         "iPhone11,8": "iPhone XR",
         "iPhone12,1": "iPhone 11",
         "iPhone12,3": "iPhone 11 Pro",
         "iPhone12,5": "iPhone 11 Pro Max",
         "iPhone12,8": "iPhone SE 2nd Gen",
         "iPhone13,1": "iPhone 12 Mini",
         "iPhone13,2": "iPhone 12",
         "iPhone13,3": "iPhone 12 Pro",
         "iPhone13,4": "iPhone 12 Pro Max",
         "iPhone14,2": "iPhone 13 Pro",
         "iPhone14,3": "iPhone 13 Pro Max",
         "iPhone14,4": "iPhone 13 Mini",
         "iPhone14,5": "iPhone 13",
         "iPod1,1": "1st Gen iPod",
         "iPod2,1": "2nd Gen iPod",
         "iPod3,1": "3rd Gen iPod",
         "iPod4,1": "4th Gen iPod",
         "iPod5,1": "5th Gen iPod",
         "iPod7,1": "6th Gen iPod",
         "iPod9,1": "7th Gen iPod",
         "iPad1,1": "iPad",
         "iPad1,2": "iPad 3G",
         "iPad2,1": "2nd Gen iPad",
         "iPad2,2": "2nd Gen iPad GSM",
         "iPad2,3": "2nd Gen iPad CDMA",
         "iPad2,4": "2nd Gen iPad New Revision",
         "iPad3,1": "3rd Gen iPad",
         "iPad3,2": "3rd Gen iPad CDMA",
         "iPad3,3": "3rd Gen iPad GSM",
         "iPad2,5": "iPad mini",
         "iPad2,6": "iPad mini GSM+LTE",
         "iPad2,7": "iPad mini CDMA+LTE",
         "iPad3,4": "4th Gen iPad",
         "iPad3,5": "4th Gen iPad GSM+LTE",
         "iPad3,6": "4th Gen iPad CDMA+LTE",
         "iPad4,1": "iPad Air (WiFi)",
         "iPad4,2": "iPad Air (GSM+CDMA)",
         "iPad4,3": "1st Gen iPad Air (China)",
         "iPad4,4": "iPad mini Retina (WiFi)",
         "iPad4,5": "iPad mini Retina (GSM+CDMA)",
         "iPad4,6": "iPad mini Retina (China)",
         "iPad4,7": "iPad mini 3 (WiFi)",
         "iPad4,8": "iPad mini 3 (GSM+CDMA)",
         "iPad4,9": "iPad Mini 3 (China)",
         "iPad5,1": "iPad mini 4 (WiFi)",
         "iPad5,2": "4th Gen iPad mini (WiFi+Cellular)",
         "iPad5,3": "iPad Air 2 (WiFi)",
         "iPad5,4": "iPad Air 2 (Cellular)",
         "iPad6,3": "iPad Pro (9.7 inch, WiFi)",
         "iPad6,4": "iPad Pro (9.7 inch, WiFi+LTE)",
         "iPad6,7": "iPad Pro (12.9 inch, WiFi)",
         "iPad6,8": "iPad Pro (12.9 inch, WiFi+LTE)",
         "iPad6,11": "iPad (2017)",
         "iPad6,12": "iPad (2017)",
         "iPad7,1": "iPad Pro 2nd Gen (WiFi)",
         "iPad7,2": "iPad Pro 2nd Gen (WiFi+Cellular)",
         "iPad7,3": "iPad Pro 10.5-inch",
         "iPad7,4": "iPad Pro 10.5-inch",
         "iPad7,5": "iPad 6th Gen (WiFi)",
         "iPad7,6": "iPad 6th Gen (WiFi+Cellular)",
         "iPad7,11": "iPad 7th Gen 10.2-inch (WiFi)",
         "iPad7,12": "iPad 7th Gen 10.2-inch (WiFi+Cellular)",
         "iPad8,1": "iPad Pro 11 inch 3rd Gen (WiFi)",
         "iPad8,2": "iPad Pro 11 inch 3rd Gen (1TB, WiFi)",
         "iPad8,3": "iPad Pro 11 inch 3rd Gen (WiFi+Cellular)",
         "iPad8,4": "iPad Pro 11 inch 3rd Gen (1TB, WiFi+Cellular)",
         "iPad8,5": "iPad Pro 12.9 inch 3rd Gen (WiFi)",
         "iPad8,6": "iPad Pro 12.9 inch 3rd Gen (1TB, WiFi)",
         "iPad8,7": "iPad Pro 12.9 inch 3rd Gen (WiFi+Cellular)",
         "iPad8,8": "iPad Pro 12.9 inch 3rd Gen (1TB, WiFi+Cellular)",
         "iPad8,9": "iPad Pro 11 inch 4th Gen (WiFi)",
         "iPad8,10": "iPad Pro 11 inch 4th Gen (WiFi+Cellular)",
         "iPad8,11": "iPad Pro 12.9 inch 4th Gen (WiFi)",
         "iPad8,12": "iPad Pro 12.9 inch 4th Gen (WiFi+Cellular)",
         "iPad11,1": "iPad mini 5th Gen (WiFi)",
         "iPad11,2": "iPad mini 5th Gen",
         "iPad11,3": "iPad Air 3rd Gen (WiFi)",
         "iPad11,4": "iPad Air 3rd Gen",
         "iPad11,6": "iPad 8th Gen (WiFi)",
         "iPad11,7": "iPad 8th Gen (WiFi+Cellular)",
         "iPad13,1": "iPad air 4th Gen (WiFi)",
         "iPad13,2": "iPad air 4th Gen (WiFi+Cellular)",
         "iPad13,4": "iPad Pro 11 inch 3rd Gen",
         "iPad13,5": "iPad Pro 11 inch 3rd Gen",
         "iPad13,6": "iPad Pro 11 inch 3rd Gen",
         "iPad13,7": "iPad Pro 11 inch 3rd Gen",
         "iPad13,8": "iPad Pro 12.9 inch 5th Gen",
         "iPad13,9": "iPad Pro 12.9 inch 5th Gen",
         "iPad13,10": "iPad Pro 12.9 inch 5th Gen",
         "iPad13,11": "iPad Pro 12.9 inch 5th Gen"]
        return deviceMapping[identifier] ?? identifier
    }()
} 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2015-10-16T09:46:42.803

**Swift 3 兼容**

```
// MARK: - UIDevice Extension -

private let DeviceList = [
/* iPod 5 */          "iPod5,1": "iPod Touch 5",
/* iPhone 4 */        "iPhone3,1":  "iPhone 4", "iPhone3,2": "iPhone 4", "iPhone3,3": "iPhone 4",
/* iPhone 4S */       "iPhone4,1": "iPhone 4S",
/* iPhone 5 */        "iPhone5,1": "iPhone 5", "iPhone5,2": "iPhone 5",
/* iPhone 5C */       "iPhone5,3": "iPhone 5C", "iPhone5,4": "iPhone 5C",
/* iPhone 5S */       "iPhone6,1": "iPhone 5S", "iPhone6,2": "iPhone 5S",
/* iPhone 6 */        "iPhone7,2": "iPhone 6",
/* iPhone 6 Plus */   "iPhone7,1": "iPhone 6 Plus",
/* iPhone 6S */       "iPhone8,1": "iPhone 6S",
/* iPhone 6S Plus */  "iPhone8,2": "iPhone 6S Plus",
/* iPhone SE */       "iPhone8,4": "iPhone SE",
/* iPhone 7 */        "iPhone9,1": "iPhone 7",
/* iPhone 7 */        "iPhone9,3": "iPhone 7",
/* iPhone 7 Plus */   "iPhone9,2": "iPhone 7 Plus",
/* iPhone 7 Plus */   "iPhone9,4": "iPhone 7 Plus",
/* iPad 2 */          "iPad2,1": "iPad 2", "iPad2,2": "iPad 2", "iPad2,3": "iPad 2", "iPad2,4": "iPad 2",
/* iPad 3 */          "iPad3,1": "iPad 3", "iPad3,2": "iPad 3", "iPad3,3":     "iPad 3",
/* iPad 4 */          "iPad3,4": "iPad 4", "iPad3,5": "iPad 4", "iPad3,6": "iPad 4",
/* iPad Air */        "iPad4,1": "iPad Air", "iPad4,2": "iPad Air", "iPad4,3": "iPad Air",
/* iPad Air 2 */      "iPad5,1": "iPad Air 2", "iPad5,3": "iPad Air 2", "iPad5,4": "iPad Air 2",
/* iPad Mini */       "iPad2,5": "iPad Mini 1", "iPad2,6": "iPad Mini 1", "iPad2,7": "iPad Mini 1",
/* iPad Mini 2 */     "iPad4,4": "iPad Mini 2", "iPad4,5": "iPad Mini 2", "iPad4,6": "iPad Mini 2",
/* iPad Mini 3 */     "iPad4,7": "iPad Mini 3", "iPad4,8": "iPad Mini 3", "iPad4,9": "iPad Mini 3",
/* iPad Pro 12.9 */   "iPad6,7": "iPad Pro 12.9", "iPad6,8": "iPad Pro 12.9",
/* iPad Pro  9.7 */   "iPad6,3": "iPad Pro 9.7", "iPad6,4": "iPad Pro 9.7",
/* Simulator */       "x86_64": "Simulator", "i386": "Simulator"
]

extension UIDevice {

    static var modelName: String {
        var systemInfo = utsname()
        uname(&systemInfo)

        let machine = systemInfo.machine
        let mirror = Mirror(reflecting: machine)

        var identifier = ""

        for child in mirror.children {
            if let value = child.value as? Int8, value != 0 {
                identifier += String(UnicodeScalar(UInt8(value)))
            }
        }
        return DeviceList[identifier] ?? identifier
    }

    static var isIphone4: Bool {
        return modelName == "iPhone 5" || modelName == "iPhone 5C" || modelName == "iPhone 5S" || UIDevice.isSimulatorIPhone4
    }

    static var isIphone5: Bool {
        return modelName == "iPhone 4S" || modelName == "iPhone 4" || UIDevice.isSimulatorIPhone5
    }

    static var isIphone6: Bool {
        return modelName == "iPhone 6" || UIDevice.isSimulatorIPhone6
    }
    static var isIphone6Plus: Bool {
        return modelName == "iPhone 6 Plus" || UIDevice.isSimulatorIPhone6Plus
    }

    static var isIpad: Bool {
        if UIDevice.current.model.contains("iPad") {
            return true
        }
        return false
    }

    static var isIphone: Bool {
        return !self.isIpad
    }

    /// Check if current device is iPhone4S (and earlier) relying on screen heigth
    static var isSimulatorIPhone4: Bool {
        return UIDevice.isSimulatorWithScreenHeigth(480)
    }

    /// Check if current device is iPhone5 relying on screen heigth
    static var isSimulatorIPhone5: Bool {
        return UIDevice.isSimulatorWithScreenHeigth(568)
    }

    /// Check if current device is iPhone6 relying on screen heigth
    static var isSimulatorIPhone6: Bool {
        return UIDevice.isSimulatorWithScreenHeigth(667)
    }

    /// Check if current device is iPhone6 Plus relying on screen heigth
    static var isSimulatorIPhone6Plus: Bool {
        return UIDevice.isSimulatorWithScreenHeigth(736)
    }

    private static func isSimulatorWithScreenHeigth(_ heigth: CGFloat) -> Bool {
        let screenSize: CGRect = UIScreen.main.bounds
        return modelName == "Simulator" && screenSize.height == heigth
    }

} 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2017-12-04T17:58:41.580

此解决方案适用于物理设备和 iOS 模拟器，模拟器返回的模型与物理设备返回的模型相同，例如 iPhone X (GSM) 的“iPhone10,6”而不是“x86_64”。

定义 - 斯威夫特 4：

```
import UIKit

extension UIDevice {
    var modelName: String {
        var systemInfo = utsname()
        uname(&systemInfo)
        let machineMirror = Mirror(reflecting: systemInfo.machine)
        let identifier = machineMirror.children.reduce("") { identifier, element in
            guard let value = element.value as? Int8, value != 0 else { return identifier }
            return identifier + String(UnicodeScalar(UInt8(value)))
        }
        if let value = ProcessInfo.processInfo.environment["SIMULATOR_MODEL_IDENTIFIER"] {
            return value
        } else {
            return identifier
        }
    }
} 
```

用法：

```
print(UIDevice.current.modelName) 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2014-08-28T05:09:55.007

```
#import <sys/utsname.h>

#define HARDWARE @{@"i386": @"Simulator",@"x86_64": @"Simulator",@"iPod1,1": @"iPod Touch",@"iPod2,1": @"iPod Touch 2nd Generation",@"iPod3,1": @"iPod Touch 3rd Generation",@"iPod4,1": @"iPod Touch 4th Generation",@"iPhone1,1": @"iPhone",@"iPhone1,2": @"iPhone 3G",@"iPhone2,1": @"iPhone 3GS",@"iPhone3,1": @"iPhone 4",@"iPhone4,1": @"iPhone 4S",@"iPhone5,1": @"iPhone 5",@"iPhone5,2": @"iPhone 5",@"iPhone5,3": @"iPhone 5c",@"iPhone5,4": @"iPhone 5c",@"iPhone6,1": @"iPhone 5s",@"iPhone6,2": @"iPhone 5s",@"iPad1,1": @"iPad",@"iPad2,1": @"iPad 2",@"iPad3,1": @"iPad 3rd Generation ",@"iPad3,4": @"iPad 4th Generation ",@"iPad2,5": @"iPad Mini",@"iPad4,4": @"iPad Mini 2nd Generation - Wifi",@"iPad4,5": @"iPad Mini 2nd Generation - Cellular",@"iPad4,1": @"iPad Air 5th Generation - Wifi",@"iPad4,2": @"iPad Air 5th Generation - Cellular"}

@interface ViewController ()
@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    struct utsname systemInfo;
    uname(&systemInfo);
    NSLog(@"hardware: %@",[HARDWARE objectForKey:[NSString stringWithCString: systemInfo.machine encoding:NSUTF8StringEncoding]]);
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-05-04T11:06:05.150

**下面的函数在 Swift 中完美地在 iOS7 或更高版本上工作**

```
func DeviceName()-> String {

        var myDeviceName : String = String()

        var systemInfo = [UInt8](count: sizeof(utsname), repeatedValue: 0)

        let model = systemInfo.withUnsafeMutableBufferPointer { (inout body: UnsafeMutableBufferPointer<UInt8>) -> String? in

            if uname(UnsafeMutablePointer(body.baseAddress)) != 0 {
                return nil
            }

            return String.fromCString(UnsafePointer(body.baseAddress.advancedBy(Int(_SYS_NAMELEN * 4))))
        }

        let deviceNamesByCode : [String: String] = ["iPod1,1":"iPod Touch 1",
                                                    "iPod2,1":"iPod Touch 2",
                                                    "iPod3,1":"iPod Touch 3",
                                                    "iPod4,1":"iPod Touch 4",
                                                    "iPod5,1":"iPod Touch 5",
                                                    "iPod7,1":"iPod Touch 6",
                                                    "iPhone1,1":"iPhone",
                                                    "iPhone1,2":"iPhone ",
                                                    "iPhone2,1":"iPhone ",
                                                    "iPhone3,1":"iPhone 4",
                                                    "iPhone3,2":"iPhone 4",
                                                    "iPhone3,3":"iPhone 4",
                                                    "iPhone4,1":"iPhone 4s",
                                                    "iPhone5,1":"iPhone 5",
                                                    "iPhone5,2":"iPhone 5",
                                                    "iPhone5,3":"iPhone 5c",
                                                    "iPhone5,4":"iPhone 5c",
                                                    "iPhone6,1":"iPhone 5s",
                                                    "iPhone6,2":"iPhone 5s",
                                                    "iPhone7,2":"iPhone 6",
                                                    "iPhone7,1":"iPhone 6 Plus",
                                                    "iPhone8,1":"iPhone 6s",
                                                    "iPhone8,2":"iPhone 6s Plus",
                                                    "iPhone8,4":"iPhone SE",
                                                    "iPad2,1":"iPad 2",
                                                    "iPad2,2":"iPad 2",
                                                    "iPad2,3":"iPad 2",
                                                    "iPad2,4":"iPad 2",
                                                    "iPad3,1":"iPad 3",
                                                    "iPad3,2":"iPad 3",
                                                    "iPad3,3":"iPad 3",
                                                    "iPad3,4":"iPad 4",
                                                    "iPad3,5":"iPad 4",
                                                    "iPad3,6":"iPad 4",
                                                    "iPad4,1":"iPad Air",
                                                    "iPad4,2":"iPad Air",
                                                    "iPad4,3":"iPad Air",
                                                    "iPad5,3":"iPad Air 2",
                                                    "iPad5,4":"iPad Air 2",
                                                    "iPad2,5":"iPad Mini",
                                                    "iPad2,6":"iPad Mini",
                                                    "iPad2,7":"iPad Mini",
                                                    "iPad4,4":"iPad Mini 2",
                                                    "iPad4,5":"iPad Mini 2",
                                                    "iPad4,6":"iPad Mini 2",
                                                    "iPad4,7":"iPad Mini 3",
                                                    "iPad4,8":"iPad Mini 3",
                                                    "iPad4,9":"iPad Mini 3",
                                                    "iPad5,1":"iPad Mini 4",
                                                    "iPad5,2":"iPad Mini 4",
                                                    "iPad6,3":"iPad Pro",
                                                    "iPad6,4":"iPad Pro",
                                                    "iPad6,7":"iPad Pro",
                                                    "iPad6,8":"iPad Pro",
                                                    "AppleTV5,3":"Apple TV",
                                                    "i386":"Simulator",
                                                    "x86_64":"Simulator"

        ]

        if model!.characters.count > 0 {
            myDeviceName = deviceNamesByCode[model!]!
        }else{
            myDeviceName = UIDevice.currentDevice().model
        }

        print("myDeviceName==\(myDeviceName)")
        return myDeviceName

    } 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2021-08-26T16:40:36.853

无需使用 Mirror 即可在 Swift 中获取设备名称。Swift 可以在需要的地方自动将事物转换为指针。就这么简单：

```
/// Returns "iPhone1,1", etc.
var deviceName: String {
    var sysinfo = utsname()
    uname(&sysinfo)
    return String(cString: &sysinfo.machine.0)
} 
```

（这个被低估的答案的提示[https://stackoverflow.com/a/43599474/843454](https://stackoverflow.com/a/43599474/843454)）

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2018-05-11T06:42:33.247

```
//
//  UIDevice+Hardware.h
//  gauravds
//

#import <UIKit/UIKit.h>

@interface UIDevice (Hardware)

- (NSString *)modelIdentifier;
- (NSString *)modelName;

@end 
```

为什么不创建一个类别。不要使用 malloc 方法安全泄漏问题。使用安全功能。

```
NSLog(@"%@ %@", [[UIDevice currentDevice] modelName], [[UIDevice currentDevice] modelIdentifier]); 
```

查看实现

```
//
//  UIDevice+Hardware.m
//  gauravds
//

#import "UIDevice+Hardware.h"
#import <sys/utsname.h>

@implementation UIDevice (Hardware)

- (NSString *)modelIdentifier {
    struct utsname systemInfo;
    uname(&systemInfo);
    return [NSString stringWithCString:systemInfo.machine encoding:NSUTF8StringEncoding];
}

- (NSString *)modelName {
    return [self modelNameForModelIdentifier:[self modelIdentifier]];
}

- (NSString *)modelNameForModelIdentifier:(NSString *)modelIdentifier {
    // iPhone http://theiphonewiki.com/wiki/IPhone

    if ([modelIdentifier isEqualToString:@"iPhone1,1"])    return @"iPhone 1G";
    if ([modelIdentifier isEqualToString:@"iPhone1,2"])    return @"iPhone 3G";
    if ([modelIdentifier isEqualToString:@"iPhone2,1"])    return @"iPhone 3GS";
    if ([modelIdentifier isEqualToString:@"iPhone3,1"])    return @"iPhone 4 (GSM)";
    if ([modelIdentifier isEqualToString:@"iPhone3,2"])    return @"iPhone 4 (GSM Rev A)";
    if ([modelIdentifier isEqualToString:@"iPhone3,3"])    return @"iPhone 4 (CDMA)";
    if ([modelIdentifier isEqualToString:@"iPhone4,1"])    return @"iPhone 4S";
    if ([modelIdentifier isEqualToString:@"iPhone5,1"])    return @"iPhone 5 (GSM)";
    if ([modelIdentifier isEqualToString:@"iPhone5,2"])    return @"iPhone 5 (Global)";
    if ([modelIdentifier isEqualToString:@"iPhone5,3"])    return @"iPhone 5c (GSM)";
    if ([modelIdentifier isEqualToString:@"iPhone5,4"])    return @"iPhone 5c (Global)";
    if ([modelIdentifier isEqualToString:@"iPhone6,1"])    return @"iPhone 5s (GSM)";
    if ([modelIdentifier isEqualToString:@"iPhone6,2"])    return @"iPhone 5s (Global)";
    if ([modelIdentifier isEqualToString:@"iPhone7,1"])    return @"iPhone 6 Plus";
    if ([modelIdentifier isEqualToString:@"iPhone7,2"])    return @"iPhone 6";
    if ([modelIdentifier isEqualToString:@"iPhone8,1"])    return @"iPhone 6s";
    if ([modelIdentifier isEqualToString:@"iPhone8,2"])    return @"iPhone 6s Plus";
    if ([modelIdentifier isEqualToString:@"iPhone8,4"])    return @"iPhone SE";
    if ([modelIdentifier isEqualToString:@"iPhone9,1"])    return @"iPhone 7";
    if ([modelIdentifier isEqualToString:@"iPhone9,2"])    return @"iPhone 7 Plus";
    if ([modelIdentifier isEqualToString:@"iPhone9,3"])    return @"iPhone 7";
    if ([modelIdentifier isEqualToString:@"iPhone9,4"])    return @"iPhone 7 Plus";
    if ([modelIdentifier isEqualToString:@"iPhone10,1"])   return @"iPhone 8";          // US (Verizon), China, Japan
    if ([modelIdentifier isEqualToString:@"iPhone10,2"])   return @"iPhone 8 Plus";     // US (Verizon), China, Japan
    if ([modelIdentifier isEqualToString:@"iPhone10,3"])   return @"iPhone X";          // US (Verizon), China, Japan
    if ([modelIdentifier isEqualToString:@"iPhone10,4"])   return @"iPhone 8";          // AT&T, Global
    if ([modelIdentifier isEqualToString:@"iPhone10,5"])   return @"iPhone 8 Plus";     // AT&T, Global
    if ([modelIdentifier isEqualToString:@"iPhone10,6"])   return @"iPhone X";          // AT&T, Global

    // iPad http://theiphonewiki.com/wiki/IPad

    if ([modelIdentifier isEqualToString:@"iPad1,1"])      return @"iPad 1G";
    if ([modelIdentifier isEqualToString:@"iPad2,1"])      return @"iPad 2 (Wi-Fi)";
    if ([modelIdentifier isEqualToString:@"iPad2,2"])      return @"iPad 2 (GSM)";
    if ([modelIdentifier isEqualToString:@"iPad2,3"])      return @"iPad 2 (CDMA)";
    if ([modelIdentifier isEqualToString:@"iPad2,4"])      return @"iPad 2 (Rev A)";
    if ([modelIdentifier isEqualToString:@"iPad3,1"])      return @"iPad 3 (Wi-Fi)";
    if ([modelIdentifier isEqualToString:@"iPad3,2"])      return @"iPad 3 (GSM)";
    if ([modelIdentifier isEqualToString:@"iPad3,3"])      return @"iPad 3 (Global)";
    if ([modelIdentifier isEqualToString:@"iPad3,4"])      return @"iPad 4 (Wi-Fi)";
    if ([modelIdentifier isEqualToString:@"iPad3,5"])      return @"iPad 4 (GSM)";
    if ([modelIdentifier isEqualToString:@"iPad3,6"])      return @"iPad 4 (Global)";
    if ([modelIdentifier isEqualToString:@"iPad6,11"])     return @"iPad (5th gen) (Wi-Fi)";
    if ([modelIdentifier isEqualToString:@"iPad6,12"])     return @"iPad (5th gen) (Cellular)";

    if ([modelIdentifier isEqualToString:@"iPad4,1"])      return @"iPad Air (Wi-Fi)";
    if ([modelIdentifier isEqualToString:@"iPad4,2"])      return @"iPad Air (Cellular)";
    if ([modelIdentifier isEqualToString:@"iPad5,3"])      return @"iPad Air 2 (Wi-Fi)";
    if ([modelIdentifier isEqualToString:@"iPad5,4"])      return @"iPad Air 2 (Cellular)";

    // iPad Mini http://theiphonewiki.com/wiki/IPad_mini

    if ([modelIdentifier isEqualToString:@"iPad2,5"])      return @"iPad mini 1G (Wi-Fi)";
    if ([modelIdentifier isEqualToString:@"iPad2,6"])      return @"iPad mini 1G (GSM)";
    if ([modelIdentifier isEqualToString:@"iPad2,7"])      return @"iPad mini 1G (Global)";
    if ([modelIdentifier isEqualToString:@"iPad4,4"])      return @"iPad mini 2G (Wi-Fi)";
    if ([modelIdentifier isEqualToString:@"iPad4,5"])      return @"iPad mini 2G (Cellular)";
    if ([modelIdentifier isEqualToString:@"iPad4,6"])      return @"iPad mini 2G (Cellular)"; // TD-LTE model see https://support.apple.com/en-us/HT201471#iPad-mini2
    if ([modelIdentifier isEqualToString:@"iPad4,7"])      return @"iPad mini 3G (Wi-Fi)";
    if ([modelIdentifier isEqualToString:@"iPad4,8"])      return @"iPad mini 3G (Cellular)";
    if ([modelIdentifier isEqualToString:@"iPad4,9"])      return @"iPad mini 3G (Cellular)";
    if ([modelIdentifier isEqualToString:@"iPad5,1"])      return @"iPad mini 4G (Wi-Fi)";
    if ([modelIdentifier isEqualToString:@"iPad5,2"])      return @"iPad mini 4G (Cellular)";

    // iPad Pro https://www.theiphonewiki.com/wiki/IPad_Pro

    if ([modelIdentifier isEqualToString:@"iPad6,3"])      return @"iPad Pro (9.7 inch) 1G (Wi-Fi)"; // http://pdadb.net/index.php?m=specs&id=9938&c=apple_ipad_pro_9.7-inch_a1673_wifi_32gb_apple_ipad_6,3
    if ([modelIdentifier isEqualToString:@"iPad6,4"])      return @"iPad Pro (9.7 inch) 1G (Cellular)"; // http://pdadb.net/index.php?m=specs&id=9981&c=apple_ipad_pro_9.7-inch_a1675_td-lte_32gb_apple_ipad_6,4
    if ([modelIdentifier isEqualToString:@"iPad6,7"])      return @"iPad Pro (12.9 inch) 1G (Wi-Fi)"; // http://pdadb.net/index.php?m=specs&id=8960&c=apple_ipad_pro_wifi_a1584_128gb
    if ([modelIdentifier isEqualToString:@"iPad6,8"])      return @"iPad Pro (12.9 inch) 1G (Cellular)"; // http://pdadb.net/index.php?m=specs&id=8965&c=apple_ipad_pro_td-lte_a1652_32gb_apple_ipad_6,8
    if ([modelIdentifier isEqualToString:@"iPad 7,1"])     return @"iPad Pro (12.9 inch) 2G (Wi-Fi)";
    if ([modelIdentifier isEqualToString:@"iPad 7,2"])     return @"iPad Pro (12.9 inch) 2G (Cellular)";
    if ([modelIdentifier isEqualToString:@"iPad 7,3"])     return @"iPad Pro (10.5 inch) 1G (Wi-Fi)";
    if ([modelIdentifier isEqualToString:@"iPad 7,4"])     return @"iPad Pro (10.5 inch) 1G (Cellular)";

    // iPod http://theiphonewiki.com/wiki/IPod

    if ([modelIdentifier isEqualToString:@"iPod1,1"])      return @"iPod touch 1G";
    if ([modelIdentifier isEqualToString:@"iPod2,1"])      return @"iPod touch 2G";
    if ([modelIdentifier isEqualToString:@"iPod3,1"])      return @"iPod touch 3G";
    if ([modelIdentifier isEqualToString:@"iPod4,1"])      return @"iPod touch 4G";
    if ([modelIdentifier isEqualToString:@"iPod5,1"])      return @"iPod touch 5G";
    if ([modelIdentifier isEqualToString:@"iPod7,1"])      return @"iPod touch 6G"; // as 6,1 was never released 7,1 is actually 6th generation

    // Apple TV https://www.theiphonewiki.com/wiki/Apple_TV

    if ([modelIdentifier isEqualToString:@"AppleTV1,1"])      return @"Apple TV 1G";
    if ([modelIdentifier isEqualToString:@"AppleTV2,1"])      return @"Apple TV 2G";
    if ([modelIdentifier isEqualToString:@"AppleTV3,1"])      return @"Apple TV 3G";
    if ([modelIdentifier isEqualToString:@"AppleTV3,2"])      return @"Apple TV 3G"; // small, incremental update over 3,1
    if ([modelIdentifier isEqualToString:@"AppleTV5,3"])      return @"Apple TV 4G"; // as 4,1 was never released, 5,1 is actually 4th generation

    // Simulator
    if ([modelIdentifier hasSuffix:@"86"] || [modelIdentifier isEqual:@"x86_64"])
    {
        BOOL smallerScreen = ([[UIScreen mainScreen] bounds].size.width < 768.0);
        return (smallerScreen ? @"iPhone Simulator" : @"iPad Simulator");
    }

    return modelIdentifier;
}

@end 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2018-08-03T16:34:03.297

为了节省别人的时间。因为被接受了，所以必须投票回答建议使用私有 API 的库，而我的应用程序昨天因为 uidevice-extension 被拒绝了！我正在切换到 GBDeviceInfo 库，它也作为 pod 安装，现在它看起来不错，维护和更新到最新设备。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2018-09-04T23:06:12.093

**斯威夫特 4 或更高版本**

```
extension UIDevice {
    var modelName: String {
        if let modelName = ProcessInfo.processInfo.environment["SIMULATOR_MODEL_IDENTIFIER"] { return modelName }
        var info = utsname()
        uname(&info)
        return String(String.UnicodeScalarView(
                   Mirror(reflecting: info.machine)
                    .children
                    .compactMap {
                        guard let value = $0.value as? Int8 else { return nil }
                        let unicode = UnicodeScalar(UInt8(value))
                        return unicode.isASCII ? unicode : nil
                    }))
    }
} 
```

* * *

```
UIDevice.current.modelName   // "iPad6,4" 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-11-15T14:12:17.650

[如果您有一个设备列表（例如，在https://stackoverflow.com/a/17655825/849616](https://stackoverflow.com/a/17655825/849616)中由上面的@Tib 维护）来处理它（如果您使用 Swift 3）：

```
extension UIDevice {
    /// Fetches the information about the name of the device.
    ///
    /// - Returns: Should return meaningful device name, if not found will return device system code.
    public static func modelName() -> String {
        let physicalName = deviceSystemCode()
        if let deviceTypes = deviceTypes(), let modelName = deviceTypes[physicalName] as? String {
            return modelName
        }
        return physicalName
    }
}

private extension UIDevice {
    /// Fetches from system the code of the device
    static func deviceSystemCode() -> String {
        var systemInfo = utsname()
        uname(&systemInfo)
        let machineMirror = Mirror(reflecting: systemInfo.machine)
        let identifier = machineMirror.children.reduce("") { identifier, element in
            guard let value = element.value as? Int8, value != 0 else { return identifier }
            return identifier + String(UnicodeScalar(UInt8(value)))
        }
        return identifier
    }

    /// Fetches the plist entries from plist maintained in https://stackoverflow.com/a/17655825/849616
    ///
    /// - Returns: A dictionary with pairs of deviceSystemCode <-> meaningfulDeviceName.
    static func deviceTypes() -> NSDictionary? {
        if let fileUrl = Bundle.main.url(forResource: "your plist name", withExtension: "plist"),
            let configurationDictionary = NSDictionary(contentsOf: fileUrl) {
            return configurationDictionary
        }
        return nil
    }
} 
```

稍后您可以使用`UIDevice.modelName()`.

额外的功劳归于@Tib（用于 plist）、@Aniruddh Joshi（用于`deviceSystemCode()`功能）。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-03-06T17:30:28.643

使用[ideviceinfo](https://github.com/libimobiledevice/libimobiledevice)来获取这些值怎么样？应该能够使用`brew install ideviceinfo`

然后运行：

```
PRODUCT_NAME=$(ideviceinfo --udid $DEVICE_UDID --key ProductName)
PRODUCT_TYPE=$(ideviceinfo --udid $DEVICE_UDID --key ProductType)
PRODUCT_VERSION=$(ideviceinfo --udid $DEVICE_UDID --key ProductVersion) 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-06-20T19:36:16.140

[这是基于Aniruddh 的`uname`方法](https://stackoverflow.com/a/11197770/1164143)的现代版本，它不依赖`Mirror`并且应该适用于 Swift 4.2 及更高版本：

```
import UIKit

extension UIDevice {
  var machineName: String {
    var info = utsname()
    return withUnsafeMutablePointer(to: &info) { info in
      // We could alternatively return nil here, or handle
      // errors some other way.
      guard uname(info) == 0 else { return model }
      let offset = MemoryLayout.offset(of: \utsname.machine)!
      let machine = UnsafeRawPointer(info).advanced(by: offset).assumingMemoryBound(to: CChar.self)
      return String(cString: machine)
    }
  }
} 
```

* * *

## 回答 #21

> 赞同：-4
> 
> 时间：2020-08-13T16:01:30.590

**Kotlin 原生：**

```
memScoped {
            val q = alloc<utsname>()
            uname(q.ptr)
            val identifier = NSString.stringWithCString(q.machine, encoding = NSUTF8StringEncoding)
        } 
```

# mysql - 重写 sql 脚本以包含 mysql 命令而不是 SQLPlus 命令

> ID：11197510
> 
> 赞同：0
> 
> 时间：2012-06-25T21:19:15.403
> 
> 标签：mysql

如果您尝试从某个 sql 查询生成报告，用 mysql 命令替换 SQLPlus 命令的最佳方法是什么

```
setpagesize 66

setlinesize 75 
```

替换它的最佳方法是mysql。我已经搜索了整个网络，找不到任何替代品。我也将我的标题设置为

```
ttitle center 'EOMData(U), 2

column year heading "Year" formatt 999
column month heading 'Month' format 99
column day heading "day" format 99

select year,month,day from TB_EOMData order by year,month ,day; 
```

它声称 setpagesize 是一个未定义的变量。我的语法对于从名为 EOMData 的表生成报告是否正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:56:51.587

最好的方法是使用 OTHER 程序而不是 mysql 命令行客户端。mysql 命令行客户端完全不适合以 SQLPlus 的方式生成报告。

# inheritance - DbSet Add 方法不支持继承？

> ID：11197511
> 
> 赞同：0
> 
> 时间：2012-06-25T21:19:19.217
> 
> 标签：inheritance, entity-framework-4.3, dbcontext

我有以下 POCO 课程：

```
Public Class CompetitionSubscription
    Public Property ID As Long
    Public Overridable Property CompetitionID As Long
    Public Overridable Property CompetitionPlayerID As Long
    Public Property CompetitionStrength As Short?
    Public Property StrengthWithinSection As Short?
End Class

<NotMapped()>
Public Class FullCompetitionSubscription
    Inherits CompetitionSubscription

    Public Property Competition As Competition
    Public Property CompetitionPlayer As CompetitionPlayer

End Class 
```

只有一个表的 DbContext 是这样的：

```
Public Class CompetitionSubscriptionsDB
    Inherits DbContext

    Public Property CompetitionSubscriptions As DbSet(Of CompetitionSubscription)

End Class 
```

我写了一个这样的单元测试：

```
<TestMethod()>
Public Sub AddSubscriptionToDatabase()

     Using db = New CompetitionSubscriptionsDB
         Dim subscription = New FullCompetitionSubscription With
                          {.CompetitionID = 1,
                           .CompetitionPlayerID = 1,
                           .CompetitionStrength = 2,
                           .StrengthWithinSection = 12}
         db.CompetitionSubscriptions.Add(DirectCast(subscription, CompetitionSubscription))
         db.SaveChanges()
     End Using

 End Sub 
```

这失败并出现以下错误（从荷兰语翻译，因此可能不是确切的消息）： *No Metadata found for EntityType CompetitionSubscriptionsLib.FullCompetitionSubscription*。

由于`FullCompetitionSubscription`该类装饰有`<NotMapped>`属性，我可以理解错误消息，但重点`DirectCast`是“出售”`FullCompetitionSubscription`作为基础`CompetitionSubscription`的`DbContext`（如果我将类型更改为`subscription`测试`CompetitionSubscription`通过）。

我哪里错了？

# sass - Compass 0.12 中的 Spriting 错误/问题

> ID：11197512
> 
> 赞同：3
> 
> 时间：2012-06-25T21:19:22.113
> 
> 标签：sass, compass-sass

某事导致了本地故障。回滚到旧版本的代码库仍然会返回相同的失败。删除整个 repo、重新克隆、卸载 compass、重新安装等仍然会产生相同的错误。

```
mycomputer:myproject(master) me$ compass watch --trace
>>> Change detected at 14:13:14 to: app/app.sass
remove assets/images/sprites-sf0f45583b2.png
NoMethodError on line ["24"] of /Users/me/.rvm/gems/ruby-1.9.3-p194/gems/chunky_png-1.2.5/lib/chunky_png/chunk.rb: undefined method `unpack' for nil:NilClass
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/chunky_png-1.2.5/lib/chunky_png/datastream.rb:78:in `from_io'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/chunky_png-1.2.5/lib/chunky_png/datastream.rb:66:in `block in from_file'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/chunky_png-1.2.5/lib/chunky_png/datastream.rb:66:in `open'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/chunky_png-1.2.5/lib/chunky_png/datastream.rb:66:in `from_file'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/chunky_png-1.2.5/lib/chunky_png/canvas/png_decoding.rb:53:in `from_file'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/sass_extensions/sprites/engines/chunky_png_engine.rb:15:in `block in construct_sprite'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/sass_extensions/sprites/engines/chunky_png_engine.rb:14:in `each'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/sass_extensions/sprites/engines/chunky_png_engine.rb:14:in `construct_sprite'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/sass_extensions/sprites/sprite_methods.rb:62:in `generate'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/sass_extensions/functions/sprites.rb:122:in `sprite_url'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/sass_extensions/sprites/sprite_map.rb:72:in `method_missing'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/sass_extensions/sprites/sprite_map.rb:63:in `to_s'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/script/list.rb:44:in `block in to_s'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/script/list.rb:44:in `map'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/script/list.rb:44:in `to_s'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:238:in `visit_prop'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:37:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:20:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:53:in `block in visit_children'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:53:in `map'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:53:in `visit_children'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:29:in `block in visit_children'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:41:in `with_environment'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:28:in `visit_children'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:37:in `block in visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:259:in `visit_rule'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:37:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:20:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:53:in `block in visit_children'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:53:in `map'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:53:in `visit_children'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:29:in `block in visit_children'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:41:in `with_environment'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:28:in `visit_children'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:37:in `block in visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:125:in `visit_if'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:37:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:20:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:128:in `visit_if'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:37:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:20:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:146:in `block in visit_import'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:146:in `map'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:146:in `visit_import'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:37:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:20:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:146:in `block in visit_import'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:146:in `map'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:146:in `visit_import'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:37:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:20:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:146:in `block in visit_import'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:146:in `map'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:146:in `visit_import'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:37:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:20:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:53:in `block in visit_children'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:53:in `map'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:53:in `visit_children'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:29:in `block in visit_children'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:41:in `with_environment'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:28:in `visit_children'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:37:in `block in visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:49:in `visit_root'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/base.rb:37:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:20:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/visitors/perform.rb:7:in `visit'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/tree/root_node.rb:20:in `render'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/engine.rb:308:in `_render'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/sass-3.2.0.alpha.237/lib/sass/engine.rb:255:in `render'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/compiler.rb:140:in `block (2 levels) in compile'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/compiler.rb:126:in `timed'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/compiler.rb:139:in `block in compile'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/logger.rb:45:in `red'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/compiler.rb:138:in `compile'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/compiler.rb:118:in `compile_if_required'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/compiler.rb:103:in `block (2 levels) in run'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/compiler.rb:101:in `each'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/compiler.rb:101:in `block in run'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/compiler.rb:126:in `timed'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/compiler.rb:100:in `run'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/commands/watch_project.rb:147:in `recompile'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/commands/watch_project.rb:68:in `perform'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/commands/base.rb:18:in `execute'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/commands/project_base.rb:19:in `execute'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/exec/sub_command_ui.rb:43:in `perform!'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/exec/sub_command_ui.rb:15:in `run!'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/bin/compass:30:in `block in <top (required)>'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/bin/compass:44:in `call'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/bin/compass:44:in `<top (required)>'
/Users/me/.rvm/gems/ruby-1.9.3-p194/bin/compass:19:in `load'
/Users/me/.rvm/gems/ruby-1.9.3-p194/bin/compass:19:in `<main>'
/Users/me/.rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in `eval'
/Users/me/.rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in `<main>'
LoadError on line ["70"] of /Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/commands/watch_project.rb: cannot load such file -- fssm
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/commands/watch_project.rb:70:in `perform'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/commands/base.rb:18:in `execute'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/commands/project_base.rb:19:in `execute'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/exec/sub_command_ui.rb:43:in `perform!'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/lib/compass/exec/sub_command_ui.rb:15:in `run!'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/bin/compass:30:in `block in <top (required)>'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/bin/compass:44:in `call'
/Users/me/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/bin/compass:44:in `<top (required)>'
/Users/me/.rvm/gems/ruby-1.9.3-p194/bin/compass:19:in `load'
/Users/me/.rvm/gems/ruby-1.9.3-p194/bin/compass:19:in `<main>'
/Users/me/.rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in `eval'
/Users/me/.rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in `<main>' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-15T00:15:04.890

我有一个类似的问题。要复制 - 我[从 iconmostr 下载一个图标](http://iconmonstr.com/warning-4-icon/)并将其包含在我的 sprites 文件夹中。我得到了同样的错误。重启后，等同样的错误。

解决此问题的方法是在 Photoshop[CS5.5] 中打开图标并将图标重新保存为 .png，其中 Interlace 为“否”。

图像元读取该软件为“Adobe ImageReady”并且没有配置文件名称（重新导出时为 sRGB IEC61966-2.1）、没有 DPI（重新导出时为 72）或类型（重新导出时为 PNGf）保存。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-23T03:12:06.013

我也遇到过这个问题。它是由图像中的异常数据引起的。
`optipng the_pic`报告错误`(Extraneous data found after IEND)`
`optipng -fix the_pic`解决了它，指南针愉快地编译。

PS我没有PhotoShop，错误图像来自我设计师的PhotoShop（我猜是5.0）......导出时似乎出了点问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-23T08:36:36.087

我懂了。对我来说，这个问题是由没有包含 Compass gem 的 Gemfile 引起的。所以我只是补充说：

```
gem 'compass' 
```

问题消失了。该错误消息对于意识到这是问题所在非常无助。

# c# - 更改 Crystal Reports 查看器连接字符串 ASP.NET

> ID：11197517
> 
> 赞同：2
> 
> 时间：2012-06-25T21:19:39.510
> 
> 标签：c#, asp.net, crystal-reports

在 Visual Studio 2010 中，我根据具有以下设置的 XML 文件动态填充 Crystal Reports 列表：

```
<Report file="C:\reportname.rpt"    text="Report Name"
       imageURL="~/images/reporticon.png" /> 
```

在我的 ASPX 页面中，我有一个 CrystalReportsViewer，如下所示：

```
<CR:CrystalReportViewer ID="CrystalReportViewer" runat="server" AutoDataBind="true"
    Width="800px" Height="600px" CssClass="reportViewer"   HasCrystalLogo="False" /> 
```

当用户单击报表链接（来自 TreeNode 对象）时，水晶报表查看器报表设置如下：

```
 CrystalReportViewer.ReportSource = "C:\reportname.rpt"; 
```

在我实际的 RPT 报告文件中，我保存了连接字符串，因此 Crystal Report Viewer 不会提示用户输入用户名和密码。

我的问题是找出是否可以更改保存在报告文件中的连接字符串？将 RPT 文件加载到 Crystal Reports 查看器中时，如何设置连接字符串信息？

在此先感谢您的帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T05:19:25.580

```
Private Sub RecurseAndRemap(ByVal CR As Engine.ReportDocument)
        For Each DSC As CrystalDecisions.Shared.IConnectionInfo In CR.DataSourceConnections
            DSC.SetLogon("YourUserName", "YourPassword")
            DSC.SetConnection("YouServerName", "YourDatabaseName", False)
        Next

        CR.SetDatabaseLogon("YourUserName", "YourPassword")

        For Each Table As Engine.Table In CR.Database.Tables
            Table.LogOnInfo.ConnectionInfo.UserID = "YourUserName"
            Table.LogOnInfo.ConnectionInfo.Password = "YourPassword"
        Next

        If Not CR.IsSubreport Then
            For Each SR As Engine.ReportDocument In CR.Subreports
                RecurseAndRemap(SR)
            Next
        End If
    End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:53:26.127

我不确定 web 查看器是否与 winforms 查看器相同，但我最终要做的是创建一个新的 ReportDocument，将报告文件加载到 ReportDocument 中，然后更改所有连接信息。

```
ReportDocument currentReport = new ReportDocument();  
currentReport.Load([path to .rept], OpenReportMethod.OpenReportByTempCopy);
ConnectionInfo crConnectionInfo = new ConnectionInfo();

//Set your connection params here  

for (int i = 0; i < currentReport.Database.Tables.Count; i++)
{
    Table crTable = currentReport.Database.Tables[i];
    TableLogOnInfo crTableLogOnInfo = crTable.LogOnInfo;
    crTableLogOnInfo.ConnectionInfo = crConnectionInfo;
    crTable.ApplyLogOnInfo(crTableLogOnInfo);
}

foreach(IConnectionInfo cn in currentReport.DataSourceConnections)
{
    cn.SetConnection(_server, _database, _windowsAuth);        
    cn.SetLogon(_userName, _password);
} 
```

然后只需将您的报表查看器源设置为报表对象：

```
CrystalReportViewer.ReportSource = currentReport; 
```

# java - 从 IDL 生成 java（避免默认包）

> ID：11197518
> 
> 赞同：7
> 
> 时间：2012-06-25T21:19:43.990
> 
> 标签：java, corba, idl

我正在使用具有大量 IDL 文件的大型遗留 C++ 代码库，这些文件具有在任何模块之外声明的所有类型和常量。

对于 C++，这会导致代码生成到全局命名空间——丑陋，但可以接受。

现在我正在尝试添加 Java 客户端以通过 CORBA 进行连接。但是，对于 Java，从 IDL 生成的类型（使用 Sun/Oracle IDL 编译器为 java: **idlj**）在 java*默认包*中，因为它们不在 IDL 模块中。这会导致 Java 编译错误，因为从默认包导入是非法的。

我正在寻找解决问题的最简单方法。

我考虑了以下几点：

1.  **在所有类型周围放置一个模块声明**。我目前正在使用这个解决方案，但它非常痛苦，基于受影响的类型数量以及对大型遗留 C++ 代码库的影响。
2.  **使用 -pkgPrefix 或 -pkgTranslate 选项**。到目前为止，我无法弄清楚如何一般地完成此操作，因为您必须指定一个模块来翻译*或*指定一个类型来添加前缀*到*. -pkgPrefix 可用于特定类型，但我们有数百种类型，我不想专门为每个编译文件列出 -pkgPrefix 选项......
3.  **使用编译指示指令**？我不知道要使用一个，但希望大师能指点一下？
4.  ？？？

如果没有包含所有类型的现有模块，我很难相信没有简单的方法可以强制 IDL 位于 Java 包中。我希望我只是错过了显而易见的事情！

**编辑**：

*   IDL-to-Java 编译器是**idlj**。
*   在下面添加了示例。
*   更新了第 2 项（上图）以阐明对每种类型使用 -pkgPrefix 是不可行的（除非可以合理地编写脚本？）

例子：

* * *

Foo.idl

```
struct Foo
{
  .
  .
  .
} 
```

* * *

Foo.java：（**注意没有指定包，意思是默认包**）：

```
public final class Foo implements org.omg.CORBA.portable.IDLEntity
{
  .
  .
  .
} 
```

* * *

ClassUsesFoo.java：

```
package com.sigh;

import Foo;  // <-- this is an error
public class ClassUsesFoo
{
     private Foo f;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T20:03:25.193

你可以使用选项 pkgPrefix 和 pkgTranslate ，如[法国网站](http://www.developpez.net/forums/d773386/autres-langages/autres-langages/corba/idlj-preciser-package/)所示， 我猜你的那部分是对的，但我会详细说明以防万一。

例子：

```
interface T1
{
};
interface T2
{
}; 
```

您在文件 idl.config 中输出 pkgPrefix 配置

```
PkgPrefix.T1=aaa
PkgPrefix.T2=bbb 
```

跟随命令

```
idlj -td dir T.idl 
```

在（现有）目录 dir 中创建文件：

```
dir/
├── aaa
│   ├── T1Helper.java
│   ├── T1Holder.java
│   ├── T1.java
│   ├── T1Operations.java
│   └── _T1Stub.java
└── bbb
    ├── T2Helper.java
    ├── T2Holder.java
    ├── T2.java
    ├── T2Operations.java
    └── _T2Stub.java 
```

要创建配置文件，可以使用 grep/awk/sed/cut 的组合。

# windows - Delphi自删除程序

> ID：11197542
> 
> 赞同：6
> 
> 时间：2012-06-25T21:21:37.123
> 
> 标签：windows, delphi, assembly

如何自动删除我的 Delphi 程序？我试过这段代码：

```
procedure DeleteSelf;
var
  module : HMODULE;
  buf : array [ 0 .. MAX_PATH - 1 ] of char;
  p : ULONG;
  hKrnl32 : HMODULE;
  pExitProcess, pDeleteFile, pFreeLibrary : pointer;
begin
  module := GetModuleHandle ( nil );
  GetModuleFileName ( module, buf, sizeof ( buf ) );
  CloseHandle ( THandle ( 4 ) );
  p := ULONG ( module ) + 1;
  hKrnl32 := GetModuleHandle ( 'kernel32' );
  pExitProcess := GetProcAddress ( hKrnl32, 'ExitProcess' );
  pDeleteFile := GetProcAddress ( hKrnl32, 'DeleteFileA' );
  pFreeLibrary := GetProcAddress ( hKrnl32, 'FreeLibrary' );
  asm
    lea eax, buf
    push 0
    push 0
    push eax
    push pExitProcess
    push p
    push pDeleteFile
    push pFreeLibrary
    ret
  end;
end; 
```

但它不起作用，不要删除文件。我的程序是控制台。谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-26T02:58:07.087

您的代码**只能**在 Windows NT 和 2000 下工作。因为在这些操作系统中，系统会保留一个用户模式句柄引用，该句柄引用支持磁盘上的可执行映像的内存映射文件。在这些 Windows 版本中，**此句柄的值始终为 0x4 。**

删除自己的exe最有效的方法，就是创建一个挂起状态的子进程，注入代码等待父进程（要删除的exe），然后检测父进程何时退出，删除父进程最后kill子进程。

您可以在这些推荐资源中找到有关此主题的更多信息。

*   [自删除可执行文件（允许可执行文件在运行时自行删除的技术）](http://www.catch22.net/tuts/self-deleting-executables)
*   [`Self deleting executables`](http://blogorama.nerdworks.in/comment.aspx?entryID=21)兰珠。五。

# java - 嵌套 postDelayed / Runnable / Handler Android

> ID：11197543
> 
> 赞同：4
> 
> 时间：2012-06-25T21:21:47.420
> 
> 标签：java, android, runnable, handlers, postdelayed

我正在尝试使用嵌套的 postDelayed 因为我需要在（延迟）5 分钟后做某事，在（延迟）30 秒后停止它，做其他事情，然后从头开始再次重复循环中的两个事件。我似乎无法做到正确。

我到目前为止的代码：

```
private long EnabledAfter  = 300000; // 5 minutes
private long DisabledAfter = 30000;  // 30 seconds

public void start_timers(){
    on_delayed(EnabledAfter);
}//end method

private void on_delayed(long period_off){       
    Delayed = new Runnable() {
        public void run() {                                                     
            something.enable(context);                          
            something.enable_else(context, true);       
            off_delayed(DisabledAfter); // and disable both again delayed

            Handler.postDelayed(Delayed, EnabledAfter);
        }
    };
    Handler.postDelayed(Delayed, EnabledAfter);
}//end method

private void off_delayed(long period_on){       
    Delayed = new Runnable() {
        public void run() {
            something.disable(context);                                 
            something.disable_else(context, false); 
            on_delayed(period_on); // start the proces again from the start...

            //Handler.postDelayed(Delayed, DisabledAfter);              
        }
    };
    Handler.postDelayed(Delayed, period_on);
}//end method 
```

这样做的问题是第一次运行良好，但随后似乎堆叠在彼此之上......并且所有延迟都被破坏了。我需要`Runnable`在 5 分 30 秒内执行这两个 s，然后重复该过程。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-25T22:03:28.327

这段代码运行几次后的最终结果是`Handler`每个`Runnable`. 如上所写：

1.  第一个 on_delayed 帖子 1 可运行
2.  该 runnable 触发，然后发布 2 个 Runnable（一个在 off_delayed 中，另一个在从 run() 返回之前）。
3.  这将继续增加，因为当这两个 Runnable 触发时，将创建 4 个，依此类推。

您也没有利用 a`Runnable`可以多次发布到同一个队列的事实，它不必每次都创建新的。如果您想取消操作，这是必不可少的，因为 remove 方法`Handler`会查找要从队列中删除的所有匹配实例。您可以尝试这样的事情：

```
private long EnabledAfter  = 300000; // 5 minutes
private long DisabledAfter = 30000;  // 30 seconds

private Runnable Enabler = new Runnable() {
    public void run() {                                                     
        something.enable(context);                          
        something.enable_else(context, true);       

        Handler.postDelayed(Disabler, DisabledAfter);
    }
};

private Runnable Disabler = new Runnable() {
    public void run() {
        something.disable(context);                                 
        something.disable_else(context, false); 

        Handler.postDelayed(Enabler, EnabledAfter);              
    }
};

public void start_timers(){
    Handler.postDelayed(Enabler, EnabledAfter);
}//end method

public void stop_timers(){
   Handler.removeCallbacks(Enabler);
   Handler.removeCallbacks(Disabler);
}//end method 
```

我还添加了另一种方法，您可以通过`Runnable`从队列中删除项目的所有实例来取消计时器操作。

高温高压

# heroku - 赫罗库 | 请协助

> ID：11197544
> 
> 赞同：0
> 
> 时间：2012-06-25T21:22:03.203
> 
> 标签：heroku

基本上，这里到底发生了什么（简而言之）

我想做的只是制作一个简单的 FB 页面应用程序，它有一个带有“要下载的喜欢页面”功能的单个图像（发布免费 mp3），我不知道 Heroku 是什么，它有一个定价页面，所以我想要远离它..

在制作应用程序时，您不能只使用一个简单的 HTML 框吗？如果没有（也可能没有），是否有人对如何实现我的目标提出建议？

现在随意侮辱我，只要你帮忙。多谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:49:29.567

Heroku 为小型应用程序提供免费托管。从你描述你的应用程序的方式来看，你应该没有问题。只需阅读一些基础知识。从“塔视图”描述您所要做的就是注册，从 heroku 创建一个应用程序，然后直接从您的 git 存储库推送。试试这个链接[https://devcenter.heroku.com/articles/facebook](https://devcenter.heroku.com/articles/facebook)

# entity-framework - EF Fluent API 多对一关系，未获取导航属性

> ID：11197546
> 
> 赞同：2
> 
> 时间：2012-06-25T21:22:08.523
> 
> 标签：entity-framework, ef-code-first, fluent, entity-framework-5

我现在有一个使用 Entity Framework 5 RC（使用 Fluent API）的数据库，但我似乎无法获得特定的工作关系。在过去的几个晚上，我正在研究它，这让我发疯。

是以下关系：

[链接到数据库图](http://roetje.home.xs4all.nl/static/ExerciseRelation.png)

如您所见，我有一个`Exercise`与`ExerciseType`. 问题是，`Exercise.ExerciseType`导航属性没有加载。我建立的关系如下：

```
EntityTypeConfiguration<Exercise>
...
this.HasRequired(ex => ex.ExerciseType)
    .WithMany(exType => exType.Exercises)
    .HasForeignKey(ex => ex.ExerciseTypeId); 
```

问题是我用谷歌搜索没有错误。实体被提取，但对象的相关`EntityType`属性`Exercise`永远不会被提取。

我正在使用以下查询来强制`ExerciseType`获取 ，但这似乎也无法使其工作。

```
 List<Exercise> exs = db.Exercises.Include(t => t.ExerciseType).ToList(); 
```

我创建的关系有问题吗？还是数据库配置有问题？

实体代码：

```
public class ExerciseType
{
    public int ExerciseTypeId { get; set; }
    public string ExerciseTypeName { get; set; }
    public System.DateTime CreatedOn { get; set; }
    public Nullable<int> CreatedBy { get; set; }
    public Nullable<System.DateTime> ModifiedOn { get; set; }
    public Nullable<int> ModifiedBy { get; set; }
    public virtual ICollection<Exercise> Exercises { get; set; }
}

public class Exercise
{
    public Exercise()
    {
        this.ExerciseTemplateMembers = new List<ExerciseTemplateMember>();
        this.TrainingSchemeMembers = new List<TrainingSchemeMember>();
        this.ExerciseType = new ExerciseType();
    }

    public int ExerciseId { get; set; }
    public int ExerciseTypeId { get; set; }
    public string ExerciseName { get; set; }
    public string DescriptionHowTo { get; set; }
    public string DescriptionResult { get; set; }
    public byte[] ExerciseImage1 { get; set; }
    public byte[] ExerciseImage2 { get; set; }
    public string ExerciseVideoUrl { get; set; }
    public bool Enabled { get; set; }
    public System.DateTime CreatedOn { get; set; }
    public Nullable<int> CreatedBy { get; set; }
    public Nullable<System.DateTime> ModifiedOn { get; set; }
    public Nullable<int> ModifiedBy { get; set; }
    public virtual ICollection<ExerciseTemplateMember> ExerciseTemplateMembers { get; set; }
    public virtual ICollection<TrainingSchemeMember> TrainingSchemeMembers { get; set; }
    public virtual ExerciseType ExerciseType { get; set; }
}

    public ExerciseMap()
    {
        // Primary Key
        this.HasKey(t => t.ExerciseId);

        // Properties
        this.Property(t => t.ExerciseName)
            .HasMaxLength(50);

        this.Property(t => t.DescriptionHowTo)
            .HasMaxLength(250);

        this.Property(t => t.DescriptionResult)
            .HasMaxLength(250);

        this.Property(t => t.ExerciseVideoUrl)
            .HasMaxLength(200);

        // Table & Column Mappings
        this.ToTable("Exercise");
        this.Property(t => t.ExerciseId).HasColumnName("ExerciseId");
        this.Property(t => t.ExerciseTypeId).HasColumnName("ExerciseTypeId");
        this.Property(t => t.ExerciseName).HasColumnName("ExerciseName");
        this.Property(t => t.DescriptionHowTo).HasColumnName("DescriptionHowTo");
        this.Property(t => t.DescriptionResult).HasColumnName("DescriptionResult");
        this.Property(t => t.ExerciseImage1).HasColumnName("ExerciseImage1");
        this.Property(t => t.ExerciseImage2).HasColumnName("ExerciseImage2");
        this.Property(t => t.ExerciseVideoUrl).HasColumnName("ExerciseVideoUrl");
        this.Property(t => t.Enabled).HasColumnName("Enabled");
        this.Property(t => t.CreatedOn).HasColumnName("CreatedOn");
        this.Property(t => t.CreatedBy).HasColumnName("CreatedBy");
        this.Property(t => t.ModifiedOn).HasColumnName("ModifiedOn");
        this.Property(t => t.ModifiedBy).HasColumnName("ModifiedBy");

        // Relationships
        this.HasRequired(ex => ex.ExerciseType)
            .WithMany(exType => exType.Exercises)
            .HasForeignKey(ex => ex.ExerciseTypeId);
    }

    public ExerciseTypeMap()
    {
        // Primary Key
        this.HasKey(t => t.ExerciseTypeId);

        // Properties
        this.Property(t => t.ExerciseTypeName)
            .IsRequired()
            .HasMaxLength(50);

        // Table & Column Mappings
        this.ToTable("ExerciseType");
        this.Property(t => t.ExerciseTypeId).HasColumnName("ExerciseTypeId");
        this.Property(t => t.ExerciseTypeName).HasColumnName("ExerciseTypeName");
        this.Property(t => t.CreatedOn).HasColumnName("CreatedOn");
        this.Property(t => t.CreatedBy).HasColumnName("CreatedBy");
        this.Property(t => t.ModifiedOn).HasColumnName("ModifiedOn");
        this.Property(t => t.ModifiedBy).HasColumnName("ModifiedBy");
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T15:24:46.537

**`Exercise`从构造函数中**删除**这一行：**

 **```
this.ExerciseType = new ExerciseType(); 
```

在默认构造函数中实例化导航引用属性会导致各种奇怪的问题，例如：[什么会导致实体框架在现有数据上保存未加载（但可延迟加载）的引用？](https://stackoverflow.com/questions/6779226/what-would-cause-the-entity-framework-to-save-an-unloaded-but-lazy-loadable-re)或者这个：[EF 4.1 Code First：为什么 EF 没有设置这个导航属性？](https://stackoverflow.com/questions/7060602/ef-4-1-code-first-why-is-ef-not-setting-this-navigation-property)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:21:09.667

你能提供`EntityType`课程代码吗？今天，当我忘记将属性（`ExerciseType`在您的情况下）设为**virtual**时，我遇到了与 EF 4.3.1 相同的问题。如果不是这种情况，请毕竟提供类的代码。

如果您使用延迟加载功能，您的实体必须具有标记为虚拟的导航属性。EF 生成从您的实体继承的代理类，如果该属性不是虚拟的，则派生类不能提供它自己的该属性的实现（应该延迟加载相关对象/集合的实现）。**

# .net - 为什么 .NET 将字符串与字符区分开来？

> ID：11197547
> 
> 赞同：2
> 
> 时间：2012-06-25T21:22:11.683
> 
> 标签：.net, string, character, base-class-library

字符串还不够吗？

**举个**例子，为什么 String 类可以让你
将 char 数组或字符串数​​组传递给它的[Split](http://msdn.microsoft.com/en-us/library/system.string.split.aspx)方法？
虽然只使用字符串版本是完全有效的？

1.  [String.Split 方法 (Char[], StringSplitOptions)](http://msdn.microsoft.com/en-us/library/ms131448.aspx)
2.  [String.Split 方法 (String[], StringSplitOptions)](http://msdn.microsoft.com/en-us/library/tabh47cf.aspx)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T21:32:06.153

字符串是字符数组的抽象。因此，即使对于单字符字符串，它们在技术上也是引用类型（尽管与大多数引用类型不同，它们是不可变的）。另一方面，字符实际上是值类型本身。（[MSDN 1](http://msdn.microsoft.com/en-us/library/362314fe)，[MSDN 2](http://msdn.microsoft.com/en-us/library/x9h8tsay)）

[C# Replace Performance](http://www.dotnetperls.com/replace-performance)显示了这一点的性能影响，其中使用字符数组比使用字符串数组快 4 倍。

# regex - 正则表达式限制字符串大小

> ID：11197549
> 
> 赞同：20
> 
> 时间：2012-06-25T21:22:13.650
> 
> 标签：regex

如何限制此正则表达式的字符串大小？

```
/^[a-z][a-z0-9]*(?:_[a-z0-9]+)*$/ 
```

我只需要添加量词`{3,16}`。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-06-25T21:29:14.700

通过添加一些[积极的前瞻](http://www.regular-expressions.info/lookaround.html)来测试字符串的总长度

```
(?=.{3,16}$) 
```

在正则表达式的开头。最终的正则表达式是：

```
/^(?=.{3,16}$)[a-z][a-z0-9]*(?:_[a-z0-9]+)*$/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:33:02.317

使用正则表达式

`/^[a-z](?:[a-z\d]|_(?!_)){1,14}[a-z\d]$/`

或者

`/^(?=.{3,16}$)[a-z][a-z\d]*(?:_[a-z\d]+)*$/`

# c# - 模拟和单例

> ID：11197551
> 
> 赞同：1
> 
> 时间：2012-06-25T21:22:20.273
> 
> 标签：c#, testing, mocking

我目前正在开发一个更大的 C#-Project。我已经编写了几个连接到数据库层的类，现在必须对它们进行测试。使用的测试框架是 Visual Studio Ultimate 之一。我已经获得了一个 Mock-layer 进行测试，但是我不确定如何使用它。

基本上我的方法是这样工作的：

```
public static void bla()
{
//This is a multithreaded singleton
Connection con = Connection.Instance;

//This raises a lot of Events 
con.SomeConnection.Send(new GetBla()); 
} 
```

MockLayer 基本上是 ConnectionMock 并将其所有方法实现为模拟。有没有办法让 con 成为 Mock 而无需以任何方式改变方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-19T13:27:08.873

实际上，您可以使用反射来模拟单例。看我的回答：

[如何模拟静态单例？](https://stackoverflow.com/questions/2050892/how-to-mock-a-static-singleton/18313980#18313980)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T21:44:09.990

第一步是确定你想做什么......最重要的是确定你的 SUT（被测对象）

> 有没有办法让 con 成为 Mock 而无需以任何方式改变方法？

我不认为你可以做这样的事情，即使你能找到一种技术方法来做到这一点，也不推荐这样做。相反，您应该使用例如存储库来抽象 DAL 层。像这样的东西：

```
interface IMyRepository
{
   void Send(Bla bla);
} 
```

现在您可以在您的类中使用 DI 来注入对该接口的引用。当您想编写**单元测试**时，您应该创建接口的模拟。

为了轻松创建模拟，我可以向您推荐以下工具：

*   [http://autofixture.codeplex.com/](http://autofixture.codeplex.com/)
*   [http://code.google.com/p/moq/](http://code.google.com/p/moq/)

无论如何，在您的情况下，在*不更改*代码的情况下测试代码的唯一方法是将连接字符串更改为虚拟数据库，然后运行**集成测试**

遗憾的是，我不得不告诉您，您的代码**对测试不友好**，您应该重构代码以删除静态成员。

我可以告诉你的最好的提示是：阅读关于编写**干净的测试友好代码的**指南。

看看以下链接：

*   [http://misko.hevery.com/2008/12/15/static-methods-are-death-to-testability/](http://misko.hevery.com/2008/12/15/static-methods-are-death-to-testability/)
*   [http://misko.hevery.com/attachments/Guide-Writing%20Testable%20Code.pdf](http://misko.hevery.com/attachments/Guide-Writing%20Testable%20Code.pdf)
*   [http://misko.hevery.com/presentations/](http://misko.hevery.com/presentations/)

你有兴趣为你的代码编写测试是件好事，但由于你没有参加 TDD，这意味着首先编写测试，你编写代码时没有考虑可测试性，结果很简单：编写测试将一个真正的 PITA 并编写它们将需要重构您的代码。

我了解您不想重构代码，因为您不想破坏现有功能，这是从一开始就编写测试的最大好处之一，您将能够重构代码并运行测试以确保你没有破坏任何东西

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T21:40:53.950

简而言之，不，没有办法。这是使用静态类和单例对象的最大缺点之一。您已经定义了一个规则，即只能存在一个 Connection 对象，并且它始终必须是您指定的确切实例。创建一个模拟并试图让所有代码都使用它将违反该规则。

换句话说，为了模拟一个对象，您必须能够创建另一个实例并将您的实例替换为预期的实例。静态类（和单例）明确地阻止了这种情况的发生。

更好的选择是使用依赖注入，以便您的“预期” Connection 类始终注册在真实环境中，并且您的模拟始终注册用于单元测试。

# r - 如何抖动文本以避免ggplot2散点图中的重叠？

> ID：11197554
> 
> 赞同：36
> 
> 时间：2012-06-25T21:22:31.087
> 
> 标签：r, position, ggplot2, scatter-plot

我想在 ggplot2 中创建一个干净的文本标签散点图版本。目标是直观地表示与大约 25 个项目相关的递增值。我已经在使用“position_jitter”，但我想知道我是否可以做得更好。

这是一些模拟数据：

```
title <- rep("A Really Rather Long Text Label", 25)
value <- runif(25, 1,10)
spacing <- seq(1:25)
df <- data.frame(title, value, spacing, stringsAsFactors = FALSE) 
```

这是生成图表的代码：

```
library(ggplot2)
myplot <- ggplot(data=df, aes(x=spacing, y=value, label = title)) +
geom_text(aes(colour = value),
    size = 2.5, fontface = "bold",
    vjust = 0,
    position = position_jitter(width=5, height=0)) +
theme_bw() +
scale_x_continuous(limits = c(-5, 30))+
scale_colour_gradient(low = "#6BAED6", high = "#08306B") +
theme(axis.title.x = element_blank(),
      axis.ticks = element_blank(),
      axis.text.x = element_blank(),
      legend.position = "none")
myplot 
```

在合理大小的图表中，所有这些文本都有足够的空间——只要文本可以自由移动到它需要的水平方向！我不想垂直抖动，因为重点是显示与每个文本标签关联的 y 值。

每次运行 ggplot 命令时，图表的结果都会略有不同——有时抖动结果比其他时候要好。但是我还没有找到一种方法来系统地防止标签重叠。

对于如何清理文本的水平定位而无需手动移动单个项目的任何建议，我将不胜感激。我也很高兴听到有关如何改进这种类型的视觉表示的其他提示。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-11-18T18:54:24.067

看看`FField`包装

```
install.packages("FField", type = "source")
install.packages("ggplot2")
install.packages("gridExtra")
library(FField)
FFieldPtRepDemo() 
```

（来自这篇文章[https://stats.stackexchange.com/a/62856](https://stats.stackexchange.com/a/62856)）

# zend-framework - 从 Youtube API（zend 框架）检索 URL 和缩略图

> ID：11197558
> 
> 赞同：0
> 
> 时间：2012-06-25T21:22:58.467
> 
> 标签：zend-framework, youtube, thumbnails, gdata, playlist

我试图用zend显示一个视频播放列表，但是在捕捉到播放列表信息之后，我不知道我需要做什么才能找到缩略图或缩略图的url。

这是我的代码：

```
require_once 'Zend/Loader.php'; // the Zend dir must be in your include_path
Zend_Loader::loadClass('Zend_Gdata_YouTube');

 $yt = new Zend_Gdata_YouTube();
 $playlistListFeed = $yt->getPlaylistListFeed('admaltais');

 //step 1: show the playlist name and his URL
 foreach ($playlistListFeed as $playlistEntry) 
 {
    echo $playlistEntry->title->text . "</br></br>";
    echo $playlistEntry->getPlaylistVideoFeedUrl() . "</br></br>";
 }

 //step 2: parse the playlist
 $feedUrl = $playlistEntry->getPlaylistVideoFeedUrl();
 $playlistVideoFeed = $yt->getPlaylistVideoFeed('http://gdata.youtube.com/feeds/api/playlists/B15D7FD35D3814A5');

 foreach ($playlistVideoFeed as $playlistVideoFeedEntry) 
 {
   echo $playlistVideoFeedEntry->title->text . "</br></br>";
   //here i want to retrieve the infos
   //var_dump($playlistVideoFeedEntry);
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T17:44:49.343

至于检索缩略图 URL，请查看[http://markmail.org/message/heekjb62yxf4skut上的](http://markmail.org/message/heekjb62yxf4skut)**getMediaArray()**函数。

根据您的代码，您将执行以下操作：

```
$media = getMediaArray($playlistEntry);
$thumbnail = isset($media['thumbnail']) ? $media['thumbnail'] : false; 
```

这对我有用，我不确定是否有更好的方法，但这是我现在能找到的最好的方法。

# c++ - Qt 和 C++ 代码之间的数据传输

> ID：11197560
> 
> 赞同：0
> 
> 时间：2012-06-25T21:23:04.523
> 
> 标签：c++, qt, ipc, data-transfer

我有一个 C++ 代码，现在我正在考虑用 Qt 准备一个 UI，因为它的语言也是 C++。在尝试这样做之前，我想知道如何在我的代码和 UI 代码之间传输数据。我的意思是，我不想将变量写入文本文件并让 UI 读取它。相反，我希望这在内部完成。我知道这是可能的，但不知道从哪里开始。任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:28:21.380

Qt 具有用于此目的的信号和插槽机制。看看这里的例子[http://qt-project.org/doc/qt-5.0/examples-widgets.html](http://qt-project.org/doc/qt-5.0/examples-widgets.html) 如果 Gui 在单独的线程中运行，这也可以工作，但要小心让线程和信号和插槽正确： http: [//labs.qt.nokia.com/2010/06/17/youre-doing-it-wrong/](http://labs.qt.nokia.com/2010/06/17/youre-doing-it-wrong/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T22:11:48.677

对于 GUI 进程和命令行进程之间的基本通信，我会使用[QProcess](http://doc.qt.nokia.com/latest/qprocess.html)。它提供了使用参数启动可执行文件、读取标准输出和标准错误、写入标准输入以及程序终止通知的工具。它是跨平台的，几乎可以与任何为命令行交互而设计的东西一起工作。

# sql-server - 临时表垃圾收集

> ID：11197561
> 
> 赞同：0
> 
> 时间：2012-06-25T21:23:13.677
> 
> 标签：sql-server, tsql, stored-procedures

我似乎遇到了临时表垃圾收集的问题：

```
CREATE PROCEDURE dbo.SetTestTempTable(@value bit)
AS
SET NOCOUNT ON
IF OBJECT_ID('tempdb..#TestTempTable') IS NOT NULL 
    DROP TABLE #TestTempTable
SELECT @value AS Value INTO #TestTempTable

GO

EXEC dbo.SetTestTempTable 1
SELECT * FROM #TestTempTable 
```

上面的代码产生错误

```
Msg 208, Level 16, State 0, Line 3
Invalid object name '#TestTempTable'. 
```

我认为是因为 #TestTempTable 在 proc 退出时正在收集垃圾。

有没有办法防止这种情况？我不希望每个调用者都需要在调用过程之前显式创建临时表。

更新：我为什么要这样做？

我需要存储一些上下文信息（基本上是一个会话变量）。我为此使用了 CONTEXT_INFO。SQL Azure 不支持 CONTEXT_INFO，所以我正在相应地重构。本质上，我有一个功能：

GetMySessionVariableName()

和一个程序

SetMySessionVariableName(值)

以前，此函数和过程在内部使用 CONTEXT_INFO，并且效果很好。现在，使用临时表，它不会......我愿意接受有关替代方法的建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-25T21:36:48.447

当存储过程超出范围时，#temp 表将被删除（嗯，延迟删除）。因此，它在存储过程范围之外对您不可用。为了在过程完成后查看#temp 的内容，您需要在执行存储过程之前创建它，并将其填充到内部......或在存储过程中执行选择。

对于更新的需求，为什么不直接使用带有 UserID 键的永久表，并更新存储过程以将 UserID 作为参数？如果您已经有一个用户表，您肯定可以将更新的会话信息存储在一两列中。不需要 CONTEXT_INFO 或 #temp 表废话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T13:52:26.290

我为这个问题找到了一个解决方案，但我自己认为它不可靠。这是关于有两个不同的连接字符串：

1.  首先使用主数据库连接字符串设置主数据库的上下文信息
2.  其次是您的正常应用程序的连接字符串。

# c - Linux中的函数插入（写函数）

> ID：11197564
> 
> 赞同：1
> 
> 时间：2012-06-25T21:23:35.910
> 
> 标签：c, linux

请问如何恢复原始写入的缓冲区？

```
size_t write(int fd, const void *buf, size_t count)
{
    static size_t (*write_func)(int, const void *, size_t) = NULL;

    /* get reference to original (libc provided) write */
    if (!write_func)
    {
        write_func = (size_t(*)(int, const void *, size_t))
                     dlsym(RTLD_NEXT, "write");
    }
    return  write_func(fd, buffer, sizeof (buffer));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T01:30:57.513

执行扩充的最有效方法之一是在原始缓冲区中切出要更改的字节，并拼接到增量中。这些被粘贴在一起，您可以`writev`用来写出所有内容。

```
struct iovec v[3];
v[0].iov_base = buf;
v[0].iov_len = position_of_new_data;
v[1].iov_base = new_data;
v[1].iov_len = new_data_len;
v[2].iov_base = (const char *)buf + beginning_of_the_end;
v[2].iov_len = count - beginning_of_the_end;
return writev(fd, v, 3); 
```

这应该适用于阻塞 I/O。对于非阻塞 I/O，您将​​需要做更多的工作来隐藏`write`调用被拦截的事实。或者，您可以将描述符翻转为阻塞，然后在返回之前翻转回非阻塞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:57:25.360

像这样：

```
ssize_t write(int fd, const void *buf, size_t count)
{
    static size_t (*write_func)(int, const void *, size_t) = NULL;
    if (!write_func)
        write_func = (size_t(*)(int, const void *, size_t)) dlsym(RTLD_NEXT, "write");

    // buf is const so, in order to change it, we need to make a copy:
    char tmp[count+1];  // <- it might be safer to use malloc here
    memcpy(tmp,buf,count);

    // modify tmp here
    tmp[count]='a';

    return  write_func(fd, tmp, count+1);
} 
```

请让我知道，如果那是你想做的。

# bash - Bash - 按文件名的第一个字母排序

> ID：11197566
> 
> 赞同：0
> 
> 时间：2012-06-25T21:23:39.323
> 
> 标签：bash, sorting

我正在尝试为 mplayer 编写一个命令，该命令将按顺序播放目录中的所有音乐文件。

```
alias mplay='mplayer -playlist <(find "$PWD" -type f|sort -n)' 
```

如果我已经在播放音乐的目录中，这可以正常工作。事实上，即使我在一个目录中并输入“mplay MusicFileDirectory”，它也可以工作。

但是，当我不在我播放的目录中并且文件编号为 1、2、3 ... 10、11 等（而不是 01、02 ... 11）时，命令会中断 - 10、11 个文件现在在第二个文件之前播放。

这是因为排序被应用于扩展文件路径，即 MusicFileDirectory/1，所以它不会按数字排序。

我如何让排序命令只对文件路径的最后部分进行排序，所以我可以输入“mplay /home/james/Music/MusicFileDirectory”，它只使用目录中文件的名称来排序播放列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:35:43.703

我不是 100% 确定它会起作用，但试试 sort -V。

**编辑：**正如 jordanm 所说，这显然是一个较新的 GNU 扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:51:37.213

排序具有指定字段分隔符（-t）和位置（-k）的选项。类似的东西： `sort -n -t/ -k2`。

也就是说，如果您想要一个通用的解决方案可以从任何目录工作，恐怕单行别名会太难（而且复杂）。您最好使用一个小脚本，您将首先计算路径中“/”的数量（例如`x`），然后执行`sort -n -t/ -k$((x+1))`

# ruby - 为什么我不能将一个fixnum除以另一个fixnum？

> ID：11197567
> 
> 赞同：5
> 
> 时间：2012-06-25T21:23:40.850
> 
> 标签：ruby, math, division, fixnum

我目前正在尝试将`counts["email"]`包含数字 82,000 的哈希除以`total`包含值 130 万的变量。

当我跑步时，`puts counts["email"]/total`我得到 0。

为什么我不能对这些进行除法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-25T22:19:57.600

您正在执行除法，尽管不是您所期望的。在 Ruby 中有许多不同的整数除法方法：

```
# Integer division:
5 / 4     # => 1

# Floating point division:
5.fdiv(4) # => 1.25

# Rational division:
5.quo(4)  # => Rational(5, 4) 
```

您还可以将其中一个整数转换为 a`Float`或 a `Rational`：

```
5.to_f / 4 # => 1.25
5.to_r / 4 # => Rational(5, 4) 
```

请注意，首先`fdiv`直接调用比调用然后使用运算符[要快](http://pastie.org/4152446)。它还清楚地表明您正在使用浮点除法。`to_f``/`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-25T21:30:10.690

因为这就是 Ruby 的工作方式：当你将整数除以整数时，你会得到一个整数。在这种情况下，这将是 0，因为它是结果的整数部分。

要获得浮点结果，只需告诉 Ruby 你确实需要浮点数！有很多方法可以做到这一点，我想最简单的就是将操作数之一转换为浮点数......

```
puts counts["email"]/total.to_f 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:28:18.243

您需要使用浮点数才能获得“完整”结果。

```
counts["email"] / total.to_f 
```

# css - CSS特定id伪类的属性？

> ID：11197569
> 
> 赞同：3
> 
> 时间：2012-06-25T21:23:52.960
> 
> 标签：css, hover, css-selectors, pseudo-class

任何人都知道如何将 css 属性应用于 a 标签，但只有当它位于某个 div 中时？我希望 .router_li div 具有悬停效果，但任何其他链接。我不确定这叫什么。

我认为它被称为伪类，我做的不对。我试过这个：

```
a:router_li:hover{
  background-color:yellow;
  width: 200px;
  height: 60px;
  background-color: #2c5fac;
  border: 1px;
  border-color: #FFFFFF;
  border-top-right-radius: 8px;
  border-top-left-radius: 8px;
  border-bottom-right-radius: 8px;
  border-bottom-left-radius: 8px;
  border-style:solid;
  border-width:1px;
  color: white;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T21:26:13.570

ID、类和伪类是不同的东西，CSS 对这三者都有不同的表示法：

*   [ID选择器](http://www.w3.org/TR/selectors/#id-selectors)
*   [类选择器](http://www.w3.org/TR/selectors/#class-html)
*   [伪类](http://www.w3.org/TR/selectors/#pseudo-classes)

如果您只想在 with 类（如 中）时应用这个特定的（这`:hover`是一个伪类），请使用`a``div``router_li``<div class="router_li">`

```
.router_li a:hover 
```

不过，那是一门课；如果是 ID（如 中`<div id="router_li">`），请使用

```
#router_li a:hover 
```

在这两种情况下，`router_li`它都不是伪类，因为它是在标记中而不是在 CSS 中定义的，因此`:router_li`您的代码中的 是无效的。另请注意，ID/类（无论它是什么）出现在`a:hover`- 这称为上下文选择器（`a`仅当它位于某个时`div`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T21:25:49.763

使用父`id`级作为选择器的一部分：

```
#parentId a {
    /* specific CSS styles */
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/j3aAd/)。

这当然不是 a `pseudo-class`（包括`:hover`, `:checked`, `:focus`）或 a `pseudo-element`（应该是`::before`and `::after`）。这是简单的继承，根据祖先选择元素，并且是 和 之间的空间所暗示`#parentId`的`a`。

相反，如果在和`>`之间没有其他祖先/后代，您可以使用直接子组合子。`div``a`

参考：

*   [CSS 选择器，位于 W3.org](http://www.w3.org/TR/CSS2/selector.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:26:44.600

`.router_li a:hover`只会针对`.router_li`元素内的悬停锚标签

# jquery - 段落文本上的 Chrome 填充问题

> ID：11197574
> 
> 赞同：3
> 
> 时间：2012-06-25T21:24:10.587
> 
> 标签：jquery, firefox, google-chrome, size, padding

我对 Web 开发场景有点陌生，我在 Chrome 上遇到了一个非常持久的问题，我似乎不太明白。

我正在使用[Compact News Previewer](http://tympanus.net/codrops/2010/10/03/compact-news-previewer/)向数据库显示新条目。您会注意到，如果您在 Firefox 中查看演示，一切都非常合适，但在 Chrome 中，左侧栏中的段落会被截断。我在自己的实现中遇到了同样的问题，如下所示（注意：我的实现与演示有点不同）： ![段落文本在 chrome 中被截断](../Images/371a54e4d2cfda88a72187f49cf1d7b7.png)

如果您访问[此网站](http://lists.cogmation.com)，您可以自己查看此问题。

我试过的：

1.  [CSS 重置](http://developer.yahoo.com/yui/reset/)- 不会产生不同的结果。

**编辑**

我正在使用 Chrome V18.0.1025.151，打算在 Ubuntu 上尝试系统更新，所以我明天检查一下，看看这是否能解决问题。

**编辑 2** 显然我使用的是最新版本的谷歌浏览器，这个版本可能有问题。但是，如果没有其他人可以看到这个问题，那么也许这不是问题......

***编辑 3*** 发现我使用的是 Chromium 而不是 Chrome，我没有意识到有区别。我安装了 Chrome 7，但遇到了与 Chromium 相同的问题。也突然这些浏览器都不能显示我的一些 jpg 图像？C̶h̶r̶o̶m̶e̶̶m̶u̶s̶t̶̶b̶e̶̶i̶n̶c̶r̶e̶d̶i̶b̶l̶y̶̶b̶u̶g̶g̶y̶̶o̶n̶̶U̶b̶u̶n̶t̶u̶!̶ <-- 人为错误！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T15:56:33.170

问题似乎是由于 Chrome 的默认设置`line-height`和您在页面上使用的字体。Myriad Pro 和 Trebuchet MS 在与 Chrome 的默认值一起使用时似乎具有非常广泛的领先优势；无衬线字体很好。由于`.cn_list p`具有固定的高度和`overflow:hidden`设置，巨大的`line-height`Chrome 为这些字体提供了将文本推出框外，将其切断。

你有几个选择：

*   在您的规则或父元素的规则中指定一个`line-height`值，例如将其向下级联。（类似或将收紧它，但是 YMMV。）`.cn_list p``body``1``1em`
*   移除固定高度和隐藏的溢出，这可能会破坏您的设计，因为它会破坏网格。

不过，添加 a`line-height`应该可以为您解决问题。

出于这个原因，像 HTML5Boilerplate 这样的项目[总是设置默认值。`line-height`](https://github.com/h5bp/html5-boilerplate/blob/master/css/main.css#L76)

# git - github 使用 Smart HTTP

> ID：11197576
> 
> 赞同：2
> 
> 时间：2012-06-25T21:24:25.657
> 
> 标签：git, authentication, https, ssh, github

我设置了[密码缓存](https://help.github.com/articles/set-up-git)，但奇怪的是我认为我已经这样做了。从一封电子邮件到 github，他们似乎改变了一些东西：

> 你好，
> 
> 您所看到的是所有新创建的存储库现在默认使用 Smart HTTP 而不是 SSH。我们在这里有一篇帮助文章，解释了如何在此处进行更改： [https ://help.github.com/articles/why-is-git-always-asking-for-my-password](https://help.github.com/articles/why-is-git-always-asking-for-my-password)
> 
> 我们在这里也有一篇关于它的博客文章： [https ://github.com/blog/1104-credential-caching-for-wrist-friendly-git-usage](https://github.com/blog/1104-credential-caching-for-wrist-friendly-git-usage)

我看到的奇怪之处在于，我似乎记得前段时间按照这些确切的指示来缓存密码。

另外，是否有更好的方法，也许使用公钥？我不太确定我的密码缓存在哪里，但我知道这不是一个好主意。（我在 Linux 上，所以不能使用电子邮件中建议的 .exe。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T22:33:03.760

您可以使用 SSH 连接到 Github。他们有一个[SSH 密钥](https://help.github.com/articles/generating-ssh-keys)指南，以防您尚未将您的公钥添加到您的 Github 帐户，然后您所要做的就是使用 SSH 存储库 URL 而不是 HTTPS 存储库 URL 来克隆您的存储库。

您可以通过单击列出的 repo URL 旁边的按钮来找到 SSH url。如果您已经克隆了 HTTPS 存储库，您可以添加一个指向 SSH URL的*新远程，并将其用于无密码推送/拉取！*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T21:42:32.110

您必须更具体地说明“更好的方法”的含义，因为根据您的解释方式，您将得到不同的答案。尝试进一步细化您的问题，使它们更具体和具体。

深入了解您在谈论的内容让我发现[git-credential-store](http://www.manpagez.com/man/1/git-credential-store/)，这似乎表明密码以明文形式存储。

据我了解，您将依赖操作系统的安全模型来确保文件不会被未经授权的方访问或更改。这些信息似乎都没有用盐进行散列。简而言之，您帐户的安全性将高度依赖于您存储缓存的机器的安全性。

至于为什么 HTTP 支持是 git 未来的一大重点，这里已经很好地解释[了。](http://git-scm.com/2010/03/04/smart-http.html)

总而言之，HTTP 是标准的并且具有很高的采用率，它支持安全和不安全的交换，再加上无论如何端口 80 在大多数机器和防火墙上都是开放的这一事实，使得使用 HTTP 相对容易。

# java - 如何读取我的 persistence.xml 的标签值 从文件 config.properties 中

> ID：11197577
> 
> 赞同：1
> 
> 时间：2012-06-25T21:24:35.877
> 
> 标签：java, properties, config, persistence.xml

我想做这样的事情：

**配置属性：**

```
dsname=value;
anotherValue=anotherValue; 
```

**持久性.xml**

```
<jta-data-source>${dsname}</jta-data-source> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-26T14:01:55.240

属性文件在我的 Web 项目之外，我正在使用带有 EclipseLink 的 JPA，但我需要**从外部文件值“dsname”初始化参数 jta-data-source**

实际上：

```
<persistence-unit name="Unit-ejbPU" transaction-type="JTA">
  <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
    <jta-data-source>datasource</jta-data-source>
      <class>Clase1</class>
      <class>Clase2</class>
      <class>Clase3</class>
  <properties/>
</persistence-unit> 
```

想法：

```
<persistence-unit name="Unit-ejbPU" transaction-type="JTA">
  <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
    <jta-data-source>${dsname}</jta-data-source>
      <class>Clase1</class>
      <class>Clase2</class>
      <class>Clase3</class>
  <properties/>
</persistence-unit> 
```

# vb.net - 模块中的 VB.NET BindingSource 未更新

> ID：11197580
> 
> 赞同：1
> 
> 时间：2012-06-25T21:25:02.940
> 
> 标签：vb.net, data-binding

我的项目中有一个模块，我将其用作一种打印队列。我有一个错误列表。我希望错误列表是可绑定的，这样当您打开错误控制台时，新错误将自动通过。

我尝试使用 a`List(Of String)`但你不能将 DataGrid 绑定到字符串......太愚蠢了......无论如何，现在我正在使用 a和`DataTable`a 。问题是，当我第一次打开错误表单时，数据在那里，但表单中没有出现新的错误。`DataView``BindingSource`

我做了一个非常简单的测试表格，我在上面放了一个计时器，它会生成随机数并将其添加到 a`DataTable`和 a 中`DataView`，`BindingSource`如果所有这些成员都在表格上，它就可以工作，但只要其中任何一部分在一个模块，它不会自动更新，就像我的项目一样。

为什么不能`BindingSource`从模块自动更新？

**更新**

好的，所以在我的测试项目中，如果我添加 a`Timer`和 a`Label`并在`Timer`'`Tick`事件上将`Label`' 文本设置为`BindingSource`'`Count`属性，则表明该项目正在添加到`BindingSource`，但`DataGrid`没有更新以显示更改. 如果我最小化并恢复窗口，它会刷新但不会继续更新。看起来`BindingSource`'`ListChanged`事件仅在`DataSource`ie 底层`DataTable`实际上与...相同的表单上时才会触发`BindingSource`。当我将它的任何部分放在另一个模块或表单中时，它不会触发事件。`DataTable`但是，如果我将行从表单添加到底层表单`BindingSource`上`DataTable`，则它会触发`ListChanged`事件，通常...

# android - Android Spinner onItemSelected 结果到文本视图？

> ID：11197582
> 
> 赞同：1
> 
> 时间：2012-06-25T21:25:15.003
> 
> 标签：android, spinner

我有一个微调器工作，`onItemSelected`输出 Toast。我希望它改为在文本视图中显示字符串值。那么，您将如何重写以下方法以在名为 denomiTV 的文本视图中显示字符串：

```
 public void onItemSelected(AdapterView<?> parent, 
View view, int pos, long id) { 
Toast.makeText(parent.getContext()), "Your Selection is: " + 
parent.getItemAtPosition(pos).toString(), Toast.LENGTH_LONG).show(); 
} 
```

我试过这个，但 Eclipse 说`.setText`这里不正确：

```
 public void onItemSelected(AdapterView<?> parent, 
View view, int pos, long id) { 
    denomiTV.setText(parent.getContext(), "Your selection is:" +
    parent.getItemAtPosition(pos));
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T21:28:56.490

[`setText()`](http://goo.gl/liYNe)接受一个`CharSequence`参数......你不应该传入一个`Context`.

```
denomiTV.setText("Your selection is:" + parent.getItemAtPosition(pos)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:29:28.050

您不需要`parent.getContext()`作为 TextView 的参数，请查看[TextView.setText(java.lang.CharSequence)](http://developer.android.com/reference/android/widget/TextView.html#setText%28java.lang.CharSequence%29)。

这就是你想要的：

```
denomiTV.setText("Your selection is:" + parent.getItemAtPosition(pos)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T07:37:17.430

试试这个代码..

```
denomiTV.setText("Your Selection is : " + parent.getSelectedItem().toString()); 
```

# sql-server - Windows服务的SQL“用户[用户名]登录失败”错误，但SSMS登录有效

> ID：11197591
> 
> 赞同：7
> 
> 时间：2012-06-25T21:26:04.343
> 
> 标签：sql-server, authentication, windows-services

我正在编写一个需要连接到 SQL 服务器以检索一些信息的 Windows 服务。但是，服务器不允许我连接：`login failed for user [domain/username]`. 奇怪的是，在 SSMS 内部一切正常。我可以登录，查询数据库，一切都很顺利。只有通过 Windows 服务，它才会抛出该错误。

作为参考，这是我正在使用的连接字符串：

> 数据源=sqlserveraddresshere;初始目录=databasenamehere;用户ID=域\用户名;密码=密码`

我怀疑这是相关的，但是当我尝试使用集成安全时，它得到的是我的计算机名而不是我自己的用户名。我 99% 确定这是因为我们的防病毒和监控软件在我的 Windows 会话之上欺骗管理员用户来完成其工作。无论如何，只要输入正确的用户名和密码就可以了，对吧？

我看了一些其他涉及相同错误的问题，但它们都是不相关的。据我所知，每个可以通过 SSMS 进入的人也可以通过代码访问他们的 SQL 服务器。这是我能找到的最相似的问题，虽然没有多大帮助： [无法连接到 SQL Server：“用户登录失败”。](https://stackoverflow.com/questions/7217472/cant-connect-to-sql-server-login-failed-for-user)

另外，在你问之前，我已经检查了错别字。实际上，我什至尝试使用其他用户的帐户来确保我的权限不会发生任何奇怪的事情。如果您需要我发布任何代码，请告诉我。谢谢你的帮助！

更新：

我更改了该服务的帐户并切换回`IntegratedSecurity = true`. 似乎有些事情发生了变化，因为现在我收到了一个稍微不同的错误：

> 无法打开登录请求的数据库“mydatabase”。登录失败。>用户“MYDOMAIN\myUserName”登录失败。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-26T15:22:54.447

它正在工作！最后！

首先，使用 Kevin 的建议（在原始问题下方进行评论），我检查了 SQL Server 日志（在 Management Studio 中，展开服务器、展开`Management`、展开`SQL Server Logs`）。这就是我如何找到更冗长的错误报告来帮助我诊断问题的方式。

原来服务器不允许 Windows 身份验证以外的任何东西，所以这就是我尝试手动输入 UN/PW 失败的原因。

但是，我仍然遇到服务器将我的机器名称作为用户而不是我的用户名传递的问题。[邓肯建议](https://stackoverflow.com/a/11198153/1294236)将运行该服务的用户更改为我的名字（右键单击“服务”->“属性”->“登录选项卡”），从而解决了这个问题。

感谢大家的帮助，非常感谢。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T22:14:49.060

您需要检查运行服务的用户帐户。通过它正在运行的声音，`Local System`它将尝试将机器名称作为登录名传递。

尝试将其更改为最低权限的域用户（或者为了测试，您可以使用自己的帐户），然后授予该用户登录 SQL Server 的权限。这应该够了吧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:57:35.907

您传递给 SQL Server 以登录的用户名是什么？根据连接字符串，您似乎正在使用文字“域\用户名”作为用户。密码应更新为正确的密码，而不是文字“密码”。

当我开始用 C# 编写数据库支持的应用程序时，我遇到了很多这个错误。我的应用程序有一个混合模式环境，我传递了 SQL Server 用户名和密码，而不是我用来登录计算机的用户名和密码。这是我喜欢强制执行的安全策略，以便数据库控制谁可以登录以及他们获得什么权限。这是否适合您正在尝试做的事情？如果是这样，我也许可以提供更好的帮助，以及更具体的代码。

# orchardcms - Orchard CMS 1.4：将 javascript 添加到特定内容，例如页面

> ID：11197592
> 
> 赞同：4
> 
> 时间：2012-06-25T21:26:04.510
> 
> 标签：orchardcms

假设我想使用 lightbox jquery 插件向页面添加图片库。

问题：

如何添加灯箱脚本？当然，我可以将它添加到我的主题的 layout.cshtml 文件中，但是每个页面都需要灯箱脚本，即使它不使用它。

然后我需要在页面中添加以下脚本：

```
<script type="text/javascript">

        $(function () {

            $('#photoGallery a').lightBox({ fixedNavigation: true });

        });

</script> 
```

同样，我可以将其添加到 layout.cshtml 文件中，但最好将其添加到页面中。好的，所以我可以为该页面创建一个图层并将一个 html 小部件添加到页脚区域，但肯定有更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T23:12:17.597

您可以使用模块库中提供的众多图像库模块之一并使用它来完成。但是，如果您想手动进行，那么恐怕您将不得不手动进行，是的；）但是即使使用特殊的图层和小部件似乎也很复杂：如果您要走那条路，为什么不您只是将该脚本放在页面标记中（来自编辑器）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T16:34:23.183

如果您只需要根据一个元素或一组元素的存在来加载脚本，我会这样做：

```
function LazyLoadScripts() {
    if ($('#photogallery').length > 0) {
        $('<script src="path-to-script" type="text/javascript"></script>').appendTo('body');
        window.setTimeout("$('#photoGallery a').lightBox({ fixedNavigation: true });", 1);
    }
    /* load any other scripts here in the same way */
}
$(document).ready(function() { LazyLoadScripts(); }); 
```

现在，您可以将其插入到布局中，或者如果您倾向于编写代码，则可以为 BodyPart 创建一个新驱动程序并插入这个具有新形状的脚本。您还需要将该形状放入头部或尾部区域。

# c++ - 传递指向成员函数的指针

> ID：11197594
> 
> 赞同：1
> 
> 时间：2012-06-25T21:26:19.023
> 
> 标签：c++, callback, asynccallback, member-pointers

那里有很多例子，但我似乎无法找出解决问题的方法。我有

```
class FooSource{
    ...

    void StartGetFoos(void (*callback)(vector<IFoo*>*, IAsyncResult));
    ...
} 
```

当`StartGetFoos()`被调用时，它完成了获取 Foos 的请求，保存回调。当请求完成时（大约需要 30 秒），将调用保存的回调并返回结果。 **我无法更改此方法的签名。**

在别的地方我有课

```
class FooUser {
    ...

    void FooUser::MyCallback(vector<IFoo*>* foos, IAsyncResult result) 
    {
          // marshall to UI thread and update UI
    }

    void init()
    {
         fooUser->StartGetFoos(??????);
         // how do I pass my callback member function here?
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T21:28:25.133

签名上没有地方可以让`void (*callback)(vector<IFoo*>*, IAsyncResult)`您接收`this`指针，因此您不能使用成员函数。相反，您必须使用`static`成员函数：

```
class FooUser {
    static void MyCallback(vector<IFoo*>* foos, IAsyncResult result) 
    {
          // marshall to UI thread and update UI
    }

    void init()
    {
         fooUser->StartGetFoos(&FooUser::MyCallback);
    }
}; 
```

这里的问题是您将无法访问 ; 上的任何实例数据`FooUser`。这可能是也可能不是问题。

根据 API 的设计程度，可能有一种方法可以传递实例指针，例如通过`IAsyncResult result`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T21:55:34.543

如果 IAsyncResult 是一个传入的数据结构，然后再次返回以进行操作，您可以使用自己的信息对其进行扩展。

```
class MyAsyncResult : public IAsyncResult
{
public:
   MyAsyncResult(FoorUser *sender) : sender(sender){}
   FooUser *sender;
}; 
```

然后，正如 ecatmur 所说，您可以为回调指定一个静态成员函数，但您也可以创建一个常规成员函数，以便在后面调用：

静态成员函数无法访问类成员，但可以在通常需要普通 C 函数的情况下指定为回调。

```
class FooUser
{
    // static with no access to class members, but can be specified as a callback.
    static void MyCallback(vector<IFoo*>* foos, IAsyncResult *result) 
    {
          MyAsyncResult *res = (MyAsyncResult*)result;
          res->sender->MyCallback(foos, result);
    }

    void MyCallback(vector<IFoo*>* foos, IAsyncResult *result) 
    {
          // handle the actual callback here
    }

    void init()
    {
         IAsyncResult *res = new MyAsyncResult(this);
         fooUser->StartGetFoos(&foos, res);
    }
} 
```

# listview - 可以在 WinJS/Windows 8 应用程序中以编程方式设置 ListView 的布局吗？

> ID：11197597
> 
> 赞同：1
> 
> 时间：2012-06-25T21:26:33.670
> 
> 标签：listview, windows-8, microsoft-metro, winjs

我有一个在多个地方使用的 ListView 模板，我想动态更改布局类型：

```
<div class="sorteditemslist" arial-label="sorted items" 
   data-win-control="WinJS.UI.ListView"
   data-win-options="{layout: { type: WinJS.UI.ListLayout}}"
   data-win-bind="winControl.itemDataSource: items.dataSource; winControl.iteminvoked: ItemInvoked;"> 
```

默认布局类型是`WinJS.UI.GridLayout`，但在某些情况下，我想将其更改为`ListLayout`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:26:34.653

是的，这是可能的。我能够使用以下代码使其正常工作：

```
var listView = element.querySelector(".sorteditemslist").winControl;
WinJS.ui.setOptions(listView, { layout: { type: WinJS.UI.ListLayout }}); 
```

此外，请确保在模板中提取对布局的引用，或者在代码中处理这两种情况。有关布局的更多信息，请参阅[msdn 页面](http://msdn.microsoft.com/en-us/library/windows/apps/br211833.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-05T09:35:36.607

正如@wloescher 指出的那样，您可以使用：

```
listViewElem.layout = new WinJS.UI.GridLayout({ orientation: 'horizontal', maxRows: 1 }); 
```

# ios - 以编程方式隐藏 Apple iAd ADBannerView

> ID：11197601
> 
> 赞同：1
> 
> 时间：2012-06-25T21:26:37.750
> 
> 标签：ios, ads, adbannerview

我想偶尔隐藏一个`ADBannerView`. 我正在考虑`banner.hidden = YES`和类似的取消隐藏。我担心 Apple 会对此不屑一顾，因为在隐藏横幅时接收和“显示”广告似乎是有问题的。

在`bannerView:didFailToReceiveAdWithError:`我正在为屏幕底部的横幅设置动画。如果它更好，我愿意这样做而不是使用隐藏属性。

也许可以告诉横幅停止请求广告。不幸的是，我在看的时候什么都没有跳出来`ADBannerView.h`。

**以编程方式隐藏的最佳方法是什么`ADBannerView`？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T20:36:07.340

告诉横幅视图停止接收广告的方法是在不需要时将其销毁，如[iAd 编程指南](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/iAd_Guide/WorkingwithBannerViews/WorkingwithBannerViews.html#//apple_ref/doc/uid/TP40009881-CH4-SW3)中所述[我添加了粗体强调]：

> 在设计应用程序时，请牢记以下原则：
> 
> *   仅当您打算向用户显示横幅视图时才创建它。否则，它可能会循环显示广告并耗尽您的应用程序的可用广告列表。
> *   如果用户从带有横幅视图的内容屏幕导航到没有横幅视图的屏幕，并且您希望他们在该屏幕上停留很长时间，**请从视图层次结构中删除横幅视图，设置它的代表为零并**在转换到新的内容屏幕之前释放它。更一般地说，当横幅视图对用户不可见时，应避免将其保留在周围。

# c# - 需要固定长度的正则表达式吗？

> ID：11197608
> 
> 赞同：0
> 
> 时间：2012-06-25T21:26:50.320
> 
> 标签：c#, python, regex, lookbehind

我有这个使用向前和向后预测的正则表达式：

```
import re
re.compile("<!inc\((?=.*?\)!>)|(?<=<!inc\(.*?)\)!>") 
```

我正在尝试将它从 C# 移植到 Python，但不断收到错误消息

```
look-behind requires fixed-width pattern 
```

是否可以在不失去意义的情况下用 Python 重写它？

这个想法是让它匹配类似的东西

```
<!inc(C:\My Documents\file.jpg)!> 
```

**更新**

我正在使用环视来解析我修改过的 HTTP 多部分文本

```
body = r"""------abc
Content-Disposition: form-data; name="upfile"; filename="file.txt"
Content-Type: text/plain

<!inc(C:\Temp\file.txt)!>
------abc
Content-Disposition: form-data; name="upfile2"; filename="pic.png"
Content-Type: image/png

<!inc(C:\Temp\pic.png)!>
------abc
Content-Disposition: form-data; name="note"

this is a note
------abc--
"""

multiparts = re.compile(...).split(body) 
```

我只想在进行拆分时获取文件路径和其他文本，而不必删除开始和结束标签

`<!inc(`代码简洁很重要，但如果它使正则表达式可行，我愿意更改格式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T21:33:02.153

从文档中：

`(?<!...)`

如果字符串中的当前位置之前没有匹配 ...，则匹配。这称为否定后向断言。与肯定的后向断言类似，包含的模式*必须只匹配一些固定长度的字符串*。以否定后向断言开头的模式可能在被搜索的字符串的开头匹配。

`(?<=...)`

如果字符串中的当前位置前面有一个在当前位置结束的 ... 匹配，则匹配。这称为肯定的后向断言。(?<=abc)def 将在 abcdef 中找到匹配项，因为后视将备份 3 个字符并检查包含的模式是否匹配。包含的模式*必须只匹配一些固定长度的字符串*，这意味着 abc 或 a|b 是允许的，但 a* 和 a{3,4} 是不允许的。请注意，以肯定的后向断言开头的模式在被搜索的字符串的开头不会匹配；您很可能希望使用 search() 函数而不是 match() 函数：

强调我的。不，我不认为您可以将其以当前形式移植到 Python。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-25T21:33:15.310

对于同一数组中的路径+“所有内容”，只需在开始和结束标签上拆分：

```
import re
p = re.compile(r'''<!inc\(|\)!>''')
awesome = p.split(body) 
```

您说您对结束标签很灵活，如果`)!>`可以在代码的其他地方出现，您可能需要考虑将结束标签更改为类似的东西`)!/inc>`（或任何东西，只要它是唯一的）。

[**看它运行。**](http://codepad.org/52qAa0Xc)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T21:36:22.067

```
import re

pat = re.compile("\<\!inc\((.*?)\)\!\>")

f = pat.match(r"<!inc(C:\My Documents\file.jpg)!>").group(1) 
```

结果是`f == 'C:\My Documents\file.jpg'`

**回应乔恩克莱门茨：**

```
print re.escape("<!inc(filename)!>") 
```

结果是

```
\<\!inc\(filename\)\!\> 
```

结论：`re.escape`似乎认为他们应该逃脱。

# java - 这个简单的RelativeLayout Android 程序有什么问题？

> ID：11197609
> 
> 赞同：0
> 
> 时间：2012-06-25T21:27:02.440
> 
> 标签：java, android, button, android-relativelayout, android-xml

我创建了这个非常简单`RelativeLayout`的测试，作为我以后可能想做的事情的测试。目前，应该只有 3 个按钮，`second`， ，`alpha`并且`mode`彼此相对排列。

我有两个问题：首先，XML 布局文件有问题，我不知道是什么问题，因为我已经彻底检查过了。这会导致布局的第 10 行和第 11 行出现错误。其次，没有`R`像通常在 android 活动中那样生成的文件。这会导致主代码的第 11 行出现错误，因为它试图从 R 文件中调用某些内容。

我的代码如下：

布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >
    <Button
        android:id="@+id/second"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@id/alpha"
        android:layout_toLeftOf="@id/mode"
        android:text="@string/second"
        android:layout_alignParentLeft="true" />
    <Button
        android:id="@+id/alpha"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/second"
        android:layout_alignParentLeft="true"
        android:text="@string/alpha" />
    <Button
        android:id="@+id/mode"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@id/second"
        android:layout_alignParentLeft="true"
        android:text="@string/mode" />
</RelativeLayout> 
```

主要`Activity`代码：

```
package com.example.TI84;

import android.app.Activity;
import android.os.Bundle;

public class TI84GraphingCalculatorActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }
} 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T21:40:22.990

顾名思义，RelativeLayouts 以相对方式组织元素。因此，您不能从文件上方的小部件引用文件中较低的小部件。此布局将起作用：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <Button
        android:id="@+id/mode"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:text="@string/alpha" />

    <Button
        android:id="@+id/second"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@id/mode"
        android:text="@string/second" />

    <Button
        android:id="@+id/alpha"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@id/mode"
        android:layout_below="@id/mode"
        android:text="@string/alpha" />

</RelativeLayout> 
```

您没有获得 R.java，因为当您的 XML 文件中有错误时不会生成它。

此外，尽管您没有要求这样做，但您的原始 XML 文件具有循环依赖关系。这意味着其中两个小部件以这样一种方式相互引用，从而创建一个无限循环，例如 A 在 B 的左侧，B 在 A 的右侧

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T21:29:16.540

当您的 xml 文件包含错误时，将不会生成 R 类。你的错误是这样的：

```
android:layout_above="@id/alpha" 
```

放：

```
android:layout_above="@+id/alpha" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T21:28:55.453

在第 10 行试试这个

```
android:layout_above="@+id/alpha" 
```

这在 11

```
android:layout_toLeftOf="@+id/mode" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-25T21:31:01.023

出现错误的原因是因为您引用了文件中该点尚未定义的 id。您只能相对于文件中元素上方定义的 id 对其进行布局。

没有`R.java`文件是因为 XML 文件中的错误导致构建失败，并且文件是在构建过程中生成的。

# vb.net - 在 Visual Basic 中使用循环重命名文件组

> ID：11197619
> 
> 赞同：1
> 
> 时间：2012-06-25T21:28:11.827
> 
> 标签：vb.net, visual-studio-2010

我目前有这些要重命名的文件组：

```
C:\Users\tmedina\Documents\testenviroment\Testfolder\file1-1111.doc
C:\Users\tmedina\Documents\testenviroment\Testfolder\file2-1111.doc
C:\Users\tmedina\Documents\testenviroment\Testfolder\file3-1111.doc
...
C:\Users\tmedina\Documents\testenviroment\Testfolder\file20-1111.doc 
```

我的表单上有一个文本框，我将在其中输入一个文本字符串，它将“1111”替换为文本框字段中的任何字符串。

因此，例如，在我的应用程序中，在文本框字段中，我会输入`2222`，然后当我单击 button1 时，它将重命名`file1-1111.doc`为`file1-2222.doc`、`file2-1111.doc`to`file2-2222.doc`等......

这是我目前拥有的 VB 代码：

```
Dim base As String = "C:\Users\tmedina\Documents\testenviroment\"
Dim newDir As String = base + CStr(TextBox1.Text)
Directory.CreateDirectory(newDir)
Directory.SetCurrentDirectory(newDir)
For Each nameChangeFiles As String In My.Computer.FileSystem.GetFiles(newDir, Microsoft.VisualBasic.FileIO.SearchOption.SearchAllSubDirectories, "*1111*")
            My.Computer.FileSystem.RenameFile(nameChangeFiles, "2222") 
```

但这只会创建一个名为 2222 的空白文件（没有扩展名）。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:33:31.973

你可以试试这个。

```
For Each nameChangeFiles As String In My.Computer.FileSystem.GetFiles(newDir, SearchOption.SearchAllSubDirectories, "*1111*") 
    Dim newName As String = nameChangeFiles.Replace("1111", "2222")
    My.Computer.FileSystem.RenameFile(nameChangeFiles, newName) 
Next 
```

但这总是将“1111”部分更改为“2222”。您说过您在文本框中输入了新字符串以替换“1111”，但在您上面的代码中，唯一存在的文本框用于创建子目录。
你能解释一下你从哪里得到替换文本吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:34:25.413

尝试这个：

```
Dim base As String = "C:\Users\tmedina\Documents\testenviroment\"
Dim newDir As String = base + CStr(TextBox1.Text)

Directory.CreateDirectory(newDir)
Directory.SetCurrentDirectory(newDir)

For Each nameChangeFiles As String In My.Computer.FileSystem.GetFiles(newDir, Microsoft.VisualBasic.FileIO.SearchOption.SearchAllSubDirectories, "*1111*")

    Dim fi As FileInfo
    fi = New FileInfo(nameChangeFiles)

    Dim newFilename As String = Path.Combine(newDir, fi.Name.Replace("1111", "2222"))
    My.Computer.FileSystem.RenameFile(nameChangeFiles, newFilename)

Next 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:35:38.143

使用 String.Replace() 函数：

```
Dim base As String = "C:\Users\tmedina\Documents\testenviroment\"
Dim newDir As String = base + CStr(TextBox1.Text)
Directory.CreateDirectory(newDir)
Directory.SetCurrentDirectory(newDir)
String ToReplace = "1111"

For Each nameChangeFiles As String In My.Computer.FileSystem.GetFiles(newDir, Microsoft.VisualBasic.FileIO.SearchOption.SearchAllSubDirectories, "*" & ToReplace & "*")
            My.Computer.FileSystem.RenameFile(nameChangeFiles.Replace(ToReplace, "2222")) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T21:38:27.307

`RenameFile`不知道要重命名文件的哪一部分；它只做整个事情。不管怎样，我是这样写的：

```
Dim newDir As String = Path.Combine(base, TextBox1.Text)

For Each f As FileInfo In New DirectoryInfo(base).GetFiles("*.doc", SearchOption.AllDirectories)
    f.CopyTo(Path.Combine(newDir, Regex.Replace(f.Name, "\d+\.doc$", "2222.doc")))
Next 
```

# iphone - self.navigationController.navigationItem 和 self.navigationItem 的区别

> ID：11197620
> 
> 赞同：5
> 
> 时间：2012-06-25T21:28:17.557
> 
> 标签：iphone, uinavigationcontroller

self.navigationController.navigationItem 和 self.navigationItem 有什么区别？我在整个应用程序中使用 UINavigationController，当我在其中一个 viewController 的 viewDidLoad 方法之一中使用 self.navigationController.navigationItem.rightBarButtonItems 时，数组为空。但是，如果我使用 self.navigationItem.rightBarButtonItems，我会看到我的栏按钮项目。这两个调用有什么区别？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T21:40:22.017

A`UINavigationController`是 的子类`UIViewController`。因此，它有自己的独立`navigationItem`财产，它继承自`UIViewController`. 您应该忽略此属性，因为只有在您将导航控制器嵌入另一个导航控制器时才会使用它（他们的正常思维中没有人会这样做）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-29T23:44:41.907

从 的文档中`UIViewController+UINavigationControllerItem`，见下文，我们应该`navigationItem`直接在视图控制器上使用该属性：

```
// Created on-demand so that a view controller may customize its navigation appearance.
@property(nonatomic,readonly,strong) UINavigationItem *navigationItem; 
```

`UINavigationController`也有一个`navigationItem`属性，因为它继承自`UIViewController`，但设置它不会影响视图控制器的导航属性。

通过快速测试，我们可以看到这些导航项也不相等：

```
(lldb) po self.navigationItem
<UINavigationItem: 0x7f865c99ec50>

(lldb) expr -- @import UIKit
(lldb) po self.navigationController.navigationItem
<UINavigationItem: 0x7f865c811740> 
```

# backbone.js - 我应该在 BackboneJS 中的每个集合更改后调用 render

> ID：11197622
> 
> 赞同：1
> 
> 时间：2012-06-25T21:28:18.523
> 
> 标签：backbone.js, backbone-views

我正在学习 BackboneJS。我有几个问题。更改控制器或模型后重新渲染完整视图是否很常见？我是否需要在渲染功能开始时清除容器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:53:56.573

首先，您不需要在渲染函数开始时清除容器（当然，除非您想清除容器）。

至于您的第一点，这显然取决于您的情况（视图的复杂程度），但是虽然有时仅重新渲染整个视图以覆盖以前的内容可能会有所帮助，但您不需要这样做。[在backbone.js 中，您可以监听特定属性](http://documentcloud.github.com/backbone/#Model-change)的更改，然后由于您可以访问[DOM 元素](http://documentcloud.github.com/backbone/#View-el)，因此只需相应地更新部分视图。

例如

```
initialize : function () {    _.bind("change:name", nameChanged, this); },

nameChanged: function(event) {    this.$el.find('.name').val(this.model.get('name'); } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T00:26:53.770

1) 重新渲染一个完整的视图实际上比更新部分视图更容易，只要视图本身是合理的原子的。

2) 不，您不需要清除容器，它与 Backbone 无关，但与您的 DOM 库（例如 jQuery）和模板引擎（例如 Handlebars）无关。所以你做的是要么

```
this.$el.html(this.template(data)); // template is a compiled Handlebars template 
```

或者

```
this.$el.html($('<div />').text('Whatever'); // using jQuery 
```

在任何情况下，都会`$el.html`将 HTML 重新插入到视图的目标元素中。

# objective-c - Cocoa PDFView 仅在调整大小时显示 PDF

> ID：11197627
> 
> 赞同：5
> 
> 时间：2012-06-25T21:28:37.633
> 
> 标签：objective-c, xcode, cocoa, pdf, pdfkit

如何让 PDFView 显示 PDF 而无需调整窗口大小或滚动以强制重绘。

好像`setNeedsDisplay`需要做一个，但没有效果。

我有我能想到的最简单的应用程序，可以使用 PDFView 显示 PDF。

基本上在 Xcode 中创建一个新应用程序并将代码更改为：

```
// AppDelegate.h
#import <Cocoa/Cocoa.h>
#import <Quartz/Quartz.h>
@interface AppDelegate : NSObject <NSApplicationDelegate>
@property (assign) IBOutlet NSWindow *window;
@property (assign) IBOutlet PDFView *pdfView;
@end 
```

和

```
// AppDelegate.m
#import "AppDelegate.h"
@implementation AppDelegate
@synthesize window = _window;
@synthesize pdfView = _pdfView;

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    NSURL *pdfURL = [[NSBundle mainBundle] URLForResource:@"TestPage" withExtension:@"pdf"];
    PDFDocument *document = [[PDFDocument alloc] initWithURL: pdfURL];     
    self.pdfView.document = document;
}
@end 
```

我在 Apple 代码示例[PDFKitLinker2](http://developer.apple.com/library/mac/#samplecode/PDFKitLinker2/Introduction/Intro.html)中注意到了相同的行为，其中必须滚动 PDF 或调整窗口大小才能显示 PDF。

诚然，我是 Cocoa 开发领域的新手，但我已经搜索并没有找到显示如何显示 PDF 的非常小的示例。我制作的内容似乎是正确的，但我怀疑即使**PDFKitLinker2**似乎也不正确。

我创建了一个[Xcode 项目](https://bitbucket.org/sotapme/pdfview_open)的 Git 存储库，为那些有时间提供帮助和/或评论的人演示了这个问题。

```
git clone git@bitbucket.org:sotapme/pdfview_open.git 
```

使用 Xcode 版本 4.3.3 (4E3002) - 最新的 Lion。

提前感谢您的帮助。

* * *

## 一个有效的解决方案。

* * *

我找到了一个解决方案，如果我创建一个具有空实现的 PDFView 子类，然后将其添加为自定义视图并将其连接到我现有的`IBOutlet`它可以工作。

对我来说完全没有意义:(

```
//DPPDFView.h
#import <Quartz/Quartz.h>
@interface DPPDFView : PDFView
@end 
```

和

```
//DPPDFView.m
#import "DPPDFView.h"
@implementation DPPDFView
@end 
```

苹果的文档确实说：

> PDFView 可能是您向应用程序添加 PDF 功能时唯一需要处理的类。它允许您显示 PDF 数据并允许用户选择内容、浏览文档、设置缩放级别以及将文本内容复制到粘贴板。PDFView 还跟踪页面历史记录。
> 
> 您可以将 PDFView 子类化以创建自定义 PDF 查看器。

*我把这个问题和自己的答案留给那些可能会遇到类似问题的人，希望这对他们来说是一盏昏暗的灯塔；也希望有更多可可智慧的人指出我的想法错误。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T15:49:29.713

我认为这确实是由于延迟加载完成实际加载 PDF 文档*后PDFview 需要 setNeedsDisplay 引起的。*

一个 hack，但是将以下内容添加到您的 - (void)windowDidLoad 方法中至少可以正确显示文档而无需调整大小。

```
dispatch_async(dispatch_get_main_queue(), ^{
    [self.myPDFView setNeedsDisplay:YES];
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T16:05:34.813

这是一个假设，但可能是因为当您`self.pdfView.document = document;`未实例化 NIB 中的 PDFView 时！

`nil`当您向对象传递消息时，Obj-C 不会对您大喊大叫。

为了检验这个假设，你可以`NSLog()`看看`pdfView`它是否是`nil`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T20:25:56.720

我发现在视图中设置“Wants Core Animation”标志会导致一些奇怪的行为。如果您有该设置，请尝试添加：

```
[pdfView setLayerContentsRedrawPolicy: NSViewLayerContentsRedrawOnSetNeedsDisplay];
[pdfView setNeedsDisplay: YES]; 
```

到加载 PDFView 的函数。

# c++ - C++中面向对象的客户端套接字应用程序设计

> ID：11197645
> 
> 赞同：1
> 
> 时间：2012-06-25T21:30:10.033
> 
> 标签：c++, oop, winsock2

几周前我开始了 Windows 套接字编程。

到目前为止，我已经创建了一个 C 风格的客户端应用程序（基于 IOCP），它与 VC++ 2010 中的网络硬件设备进行通信。该应用程序通过 LAN 或串行端口与设备（充当服务器）异步通信：

*   创建套接字/或句柄到串行端口
*   连接到服务器
*   std::vector 类型的构建命令（例如，登录命令）
*   通过套接字或串口发送命令
*   通过套接字或串口接收响应
*   断开与服务器的连接

现在我想让我现有的客户端应用程序更加面向对象，并且我提出了以下类层次结构（省略了参数）：

```
class IClient
{
public:
    virtual bool Connect() = 0;
    virtual bool Disconnect() = 0;
    virtual bool Send() = 0;
    virtual bool Receive() = 0;
    ...
};

class Client : public IClient
{
public:
    Client();
    virtual ~Client();

    virtual bool Connect() = 0;
    virtual bool Disconnect() = 0;
    virtual bool Send() = 0;
    virtual bool Receive() = 0;
    ...

private:
    std::string m_strConnectionSettings; // IP address, port number etc
};

class SerialClient : public Client
{
public:
    bool Connect()
    {
        ...
        m_hPort = CreateFile(_T("COM3"), GENERIC_READ | GENERIC_WRITE, 0, NULL, OPEN_EXISTING, 0, NULL);
        ...
    }

    bool Disconnect()
    {
        ...
        CloseHandle(m_hPort);
        ...
    }

    bool Send()
    {
        ...
        WriteFile(m_hPort, (LPCVOID)(&vecByteData[0]), vecByteData.size(), &dwNumberOfBytesWritten, NULL);
        ...
    }

    bool Receive()
    {
        ...
        ReadFile(m_hPort, (LPVOID)&vecBuffer[0], vecBuffer.size(), &dwNumberOfBytesRead, NULL);
        ...
    }
    ...

private:
    HANDLE m_hPort; // Handle returned by CreateFile().
    DCM m_dcb;
};

class SocketClient : public Client
{
public:
    SocketClient();
    virtual ~SocketClient();

    virtual bool Connect() = 0;
    virtual bool Disconnect() = 0;
    virtual bool Send() = 0;
    virtual bool Receive() = 0;
    ...

private:
    SOCKET m_socket; // Handle returned by WSASocket().
};

class TcpClient : public SocketClient
{
public:
    TcpClient();
    ~TcpClient();

    bool Connect()
    {
        ...
        WSAConnect(m_sock, (LPSOCKADDR)&server, sizeof(server), NULL, NULL, NULL, NULL);
        ...
    }

    bool Disconnect()
    {
        ...
        closesocket(m_sock);
        ...
    }

    bool Send()
    {
        ...
        WSASend(m_sock, ...);
        ...
    }

    bool Receive()
    {
        ...
        WSARecv(m_sock, ...);
        ...
    }
    ...
};

class UdpClient : public SocketClient
{
public:
    UdpClient();
    ~UdpClient();

    bool Connect();
    bool Disconnect();
    bool Send();
    bool Receive();
    ...
}; 
```

然而，我对计算机网络的了解还很初级，所以我发现很难将计算机网络概念转化为 C++ 设计。例如，在上面的设计中，我不知道“Port”是从哪里来的。如果我有“Port”类和“Socket”类，那么“Port”类会包含“Socket”类还是相反或废话？

如果您能就上述设计给我一些反馈，我将不胜感激。

*   我对 Boost.Asio 做了一个非常简短的了解，看看它是如何设计的。
*   抱歉，如果我的问题含糊不清。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:47:44.580

典型的套接字抽象模型

*   套接字，服务器端的东西
*   客户端，在服务器端建模的东西（一个套接字有很多客户端）
*   连接，以客户端为模型

通常，端口号是服务器上 socket.listen 方法的一部分，也是客户端上 connection.connect 方法的一部分

与IP地址相同

# java - 使用 POI hssf WritableWorkbook 在 excel 中导出数据

> ID：11197647
> 
> 赞同：1
> 
> 时间：2012-06-25T21:30:25.463
> 
> 标签：java, jsp, apache-poi

我有这个 DAO..

```
public class AreaDAO {

    private Database database;

    public AreaDAO(Database database) {
        this.database = database;
    }

    public List<Area> list() throws SQLException {
        Connection connection = null;
        PreparedStatement statement = null;
        ResultSet resultSet = null;
        List<Area> areas = new ArrayList<Area>();

        try {
            connection = database.getConnection();
            statement = connection.prepareStatement("select distinct img_hub, country from ifs_db limit 50");
            resultSet = statement.executeQuery();
            while (resultSet.next()) {
                Area area = new Area();
                area.setImg_hub(resultSet.getString("img_hub"));
                area.setCountry(resultSet.getString("country"));
                areas.add(area);
            }
        } finally {
            if (resultSet != null) try { resultSet.close(); } catch (SQLException logOrIgnore) {}
            if (statement != null) try { statement.close(); } catch (SQLException logOrIgnore) {}
            if (connection != null) try { connection.close(); } catch (SQLException logOrIgnore) {}
        }

        return areas;
    }
} 
```

这会产生一个数据列表......

如何让用户只需单击链接即可下载excel中的所有数据..

我研究了我们并发现了这个......（BalusC）

```
 response.setContentType("application/vnd.ms-excel");
    response.setHeader("Content-Disposition", "attachment; filename=name.xls");
    WritableWorkbook workBook  = Workbook.createWorkbook(response.getOutputStream()); 
```

我把它放在我的 servlet 中，我怎么只是得到一个空白的工作表......我怎么能使用它，这样我就可以让用户下载一个

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T21:35:43.597

我知道您指的是我对[这个问题](https://stackoverflow.com/questions/5177725/how-to-let-user-download-the-data-in-database-to-an-excel-sheet-file-from-web-ap)的回答？请注意这一`// ...`行，这就是您应该使用数据库中的数据填充工作簿的地方。该问题的 OP 已经知道这一点，因此为简洁起见将其省略。

您可以在 POI HSSF 自己的网站上找到如何使用 API[的快速指南。](http://poi.apache.org/spreadsheet/quick-guide.html)

这是一个如何创建带有单元格的工作表的启动示例。

```
response.setContentType("application/vnd.ms-excel");
response.setHeader("Content-Disposition", "attachment; filename=name.xls");
WritableWorkbook workbook = Workbook.createWorkbook(response.getOutputStream());
WritableSheet sheet = workbook.createSheet("Sheet1", 0);
sheet.addCell(new Label(0, 0, "Hello World"));
// ...
workbook.write();
workbook.close(); 
```

您可以在遍历`List<Area>`. 例如

```
for (int i = 0; i < list.size(); i++) {
    Area area = list.get(i);
    sheet.addCell(new Label(0, i, area.getImgHub()));
    sheet.addCell(new Label(1, i, area.getCountry()));
} 
```

# git - 评估 git 和合并似乎不像我预期的那样工作

> ID：11197648
> 
> 赞同：1
> 
> 时间：2012-06-25T21:30:44.470
> 
> 标签：git, svn, git-merge

我正在尝试评估从 svn 迁移到 git 是否是一个可行的选择。我听说 git 中的合并比 svn 中的合并效果好得多，但在我的测试中我还没有看到。

这是我所做的：

*   创建了一个名为 main.c 的文件

    ```
    #include <stdio.h>    

    function main() {
      int myNum = 10;

      printf("Hi, my num is %d\n", myNum);

      return 0;
    } 
    ```

*   git init, git add ., git commit -m "Created main.c", 并推送到origin master

*   在 main.c 文件中，我故意不遵守编码标准并且错误地命名了函数。
*   另一个用户出现并更改代码以符合编码标准（花括号移到下一行），提交并推送

    ```
    #include <stdio.h>    

    function main()
    { //This was changed to a specific coding standard
      int myNum = 10;

      printf("Hi, my num is %d\n", myNum);

      return 0;
    } 
    ```

*   我在 main 之前添加了一个函数，提交并尝试推送，它告诉我我的 master 分支不是最新的，所以我做了一个 git pull origin master 来更新它，然后我得到了冲突

    ```
    <<<<<<< HEAD
    function main() {
      int myNum = 10;
    =======
    function main()
    {
      int myNum = 10;
    >>>>>>> f0aceffb16f0a24638493367f4be6f2a09e22a82 
    ```

**问题**：谁能告诉我我是否做错了？我是否遗漏了某些步骤，从而导致自己悲伤？也许我真的不明白合并应该比svn简单吗？

感谢您抽出宝贵时间，
克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:57:41.283

当您对同一行进行两次更改时，Git 无法猜测您想要什么。没有单片机可以做到这一点。人类必须告诉它哪个版本应该“获胜”。

在某些极端情况下，git 的合并比 subversion 更干净。我面前没有它们，但坦率地说，在现代颠覆中，合并不太可能有实质性差异。

您对是否使用 git 的决定不会归结为某种合并黑魔法。这将归结为 git 的整体运作方式。

对我来说，git 与其他 SCM 的区别在于它是如何工作的。因为它使用了一个附加模型（新提交是对图表的添加）并且每个提交都经过哈希处理，所以使用 git 很难丢失任何东西。那个复杂的合并很糟糕，导致一团糟，你不知道你会如何倒带？只是`git reset --hard`在合并之前提交。将您的分支重置回 11 次提交，然后决定它应该是 10 次提交？没问题，只需将分支移回第 10 次提交即可。决定你的最新特性分支应该基于开发而不是主分支？只需几个命令也可以进行更改。

Git 的不可变特性和内容的散列给了我一些我在 SVN 中从未有过的东西。信心。相信如果我把事情搞砸了，我可以想办法回到原来的位置。有信心在与他人分享之前检查我的更改并确保它们是正确的。我没有那种“哦不……我刚刚对每个人做了什么？”的恐慌。

此外，虽然这不是我经常使用的东西，但直接从另一个开发人员那里提取更改，甚至应用通过电子邮件发送给我的补丁文件的能力是很好的灵活性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T22:04:37.823

你们都更改了关闭的行，Git 在合并这样的关闭区域时很谨慎。但是，如果在完全不同的区域中进行了更改，则合并将正常完成。

像 kdiff3 这样的一些合并工具会自动解决这个合并问题，而且大部分时间都是正确的，但我相信 Git 不希望自动解决有风险的合并问题。

# c# - System.Data.SqlClient.SqlTransaction.Dispose 中会发生什么？

> ID：11197650
> 
> 赞同：3
> 
> 时间：2012-06-25T21:31:00.320
> 
> 标签：c#, .net, vb.net

我查看了 System.Data.SqlClient.SqlTransaction 中的 Dispose() 方法（使用反编译器）：

```
 protected override void Dispose(bool disposing)
    {
      if (disposing)
      {
        SNIHandle target = (SNIHandle) null;
        RuntimeHelpers.PrepareConstrainedRegions();
        try
        {
          target = SqlInternalConnection.GetBestEffortCleanupTarget(this._connection);
          if (!this.IsZombied)
          {
            if (!this.IsYukonPartialZombie)
              this._internalTransaction.Dispose();
          }
        }
        catch (OutOfMemoryException ex)
        {
          this._connection.Abort((Exception) ex);
          throw;
        }
        catch (StackOverflowException ex)
        {
          this._connection.Abort((Exception) ex);
          throw;
        }
        catch (ThreadAbortException ex)
        {
          this._connection.Abort((Exception) ex);
          SqlInternalConnection.BestEffortCleanup(target);
          throw;
        }
      }
      base.Dispose(disposing);
    } 
```

为什么大家在论坛里都说dispose是Rolling back？它在哪里回滚？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T22:10:15.853

@BlorgBeard 说“我相信内部事务在其自己的 Dispose 中回滚 - 即在 this._internalTransaction.Dispose(); 中”是正确的。写它作为其他人的答案。（见最后声明）

**System.Data.SqlClient.SqlInternalTransaction.Dispose() 的代码——见最后一行：**

```
private void Dispose(bool disposing)
{
  Bid.PoolerTrace("<sc.SqlInteralTransaction.Dispose|RES|CPOOL> %d#, Disposing\n", this.ObjectID);
  if (!disposing || this._innerConnection == null)
    return;
  this._disposing = true;
  this.Rollback();
} 
```

# android - 使用 Fragments 重新设计平板电脑的手机应用程序

> ID：11197652
> 
> 赞同：0
> 
> 时间：2012-06-25T21:31:03.610
> 
> 标签：android, android-listview, android-fragments

我有一个完善的手机应用程序，但我想添加对平板电脑的支持。主视图由一个 ListView 组成，它使用 SimpleCursorAdapter 从数据库中获取列表。当用户点击一个项目时，会启动一个 Activity（**特定于那个 ID！**）。一些活动共享相同的视图，但具有不同的信息。每个活动都扩展了 FragmentAcivity。在平板电脑中，由于我有更多的屏幕空间，我想在左侧显示 ListView，当用户点击一个项目时，**SPECIFIC** Activity 将显示在左侧。它会模仿页面一半左右[的图像。](http://developer.android.com/guide/practices/tablets-and-handsets.html)我对片段没有很好的了解，但我怎么能做到这一点？如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T21:40:08.933

出于此答案的目的，我将使用“主要活动”来指代带有 的活动，`ListView`而“其他活动”来指代您希望出现在右侧的活动。

这是一个缩略图：

1.  将其他每个活动转换为其 UI 由片段定义的活动。

2.  为平板电脑的主要活动创建布局，除了您的之外，还包含`ListFragment`一个`FrameLayout`容器，用于存放其他活动应该去的地方。将现有布局保留为主要活动。

3.  在`onListItemClick()`您的`ListFragment`中，将事件传递给主要活动（例如，`((MainActivity)getActivity()).heyDoSomething(position)`）

4.  在主要活动中的事件处理方法（例如，`heyDoSomething()`）中，查看是否有`FrameLayout`. 如果这样做，请运行 a`FragmentTransaction`以将 的内容替换为`FrameLayout`来自其他活动的适当片段。如果您不这样做，那么您正在使用手机，在这种情况下，您将启动其他活动之一。

[这是一个示例应用程序](https://github.com/commonsguy/cw-omnibus/tree/master/LargeScreen/EU4You)，演示了其中的一部分（减去几个“其他活动”，因此列表单击只是将新鲜内容加载到右侧的现有片段中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:40:26.030

看看这里的shakespear示例：[http ://android-developers.blogspot.com/2011/02/android-30-fragments-api.html](http://android-developers.blogspot.com/2011/02/android-30-fragments-api.html)

# css - 右下角类在Firefox中不起作用，为什么？

> ID：11197658
> 
> 赞同：1
> 
> 时间：2012-06-25T21:31:35.500
> 
> 标签：css, firefox

我已经尝试调整这个两天了，但无法修复它。请帮帮我。我有这个CSS。它可以在 Chrome、IE 和 Opera 中正常工作，但不能在 firefox 中正常工作。这是链接：http: [//jsfiddle.net/6p5vp/6/](http://jsfiddle.net/6p5vp/6/)

这是我使用的类，它在除 Firefox 之外的其他浏览器中正常工作：

```
.main1 .row td
 {
    border-bottom: 1px dotted silver;
    vertical-align:top;
    padding:10px;
    margin-bottom:20px;
    margin-top:20px;
   position:relative;

 }

 .main1 .row td .tick
 {
    bottom:0;
    right:0;
   text-align:right;
   position:absolute;
 }​ 
```

这是标记：

```
<table class="main1">
<tr class="row">
<td>
  <div>     
  <div>
    All the text comes here  All the text comes here  All the text comes here  All the text comes here 
 All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here 
       All the text comes here  All the text comes here  All the text comes here  All the text comes here 
 All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here 
       All the text comes here  All the text comes here  All the text comes here  All the text comes here 
 All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here  All the text comes here 
  </div>
</div>
</td>
<td>
<div>
  <div>
    All the text comes here  All the text comes here  All the text comes here  All the text comes here 

  </div>
  <div class="tick">
      <input type="checkbox"/>
  </div>
</div>
</td>
</tr>
</table>​ 
```

我想要的是根据第一列的高度在第二列的右下角出现一个复选框。就像是：

文本列 1 文本列 2

文本列 1

textincolumn1
textincolumn1
textincolumn1 复选框

请帮我改正。非常感谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:38:02.330

为什么不使用无表方法？

也许是这样的：http: [//jsfiddle.net/6E7vS/](http://jsfiddle.net/6E7vS/)

HTML：

```
<div class="main">

    <div class="right">
        Lorem ipsum ...
    </div>

    <div class="left">
        Lorem ipsum dolor sit amet, consetetur sadipscing elitr...
    </div>

    <div class="checkbox">
        <input type="checkbox">
    </div>

</div>​ 
```

CSS：

```
.main{
    position:relative;
    width: 550px;
    border: 1px solid magenta;
}

.left{
    width: 300px;
}

.right{
    float: right;
    width: 200px;
}

.checkbox{
    width: 20px;
    height: 20px;
    padding: 20px;
    background: #eee;
    position: absolute;
    bottom: 0;
    right: 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T21:43:32.533

这是您的[jfiddle](http://jsfiddle.net/6p5vp/9/)的修改版本，请记住它希望第一列高于第二列。如果你不能保证这一点，那么从 css 中删除 margin-top:-16px ，你应该没问题。

HTML：

```
<div>
    <div class='column1'>
        All the text comes here  All the text comes here  
        All the text comes here  All the text comes here 
        All the text comes here  All the text comes here  
        All the text comes here  All the text comes here  
        All the text comes here  All the text comes here  
        All the text comes here  All the text comes here
    </div>
    <div class='column2'>
        All the text comes here  All the text comes here  
        All the text comes here  All the text comes here 
    </div>
</div>
<div class="tick">
   this is where the check box goes <input type="checkbox"/>
</div>
<br style='clear:both'/><br/>
<p>Continue with content....</p>​ 
```

CSS：

```
.column1 {
    width : 50%;
    float : left;
    margin-right : 10px;    
}

.column2 {
    overflow : none;
}

.tick {
    clear : both;
    float : right;
    margin-top:-16px;
}​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T23:06:39.017

根据 John 的建议。我能够想出这个似乎最终可行的方法。这是CSS：

```
.container

{
    position:relative;
    padding-left:10px;
    margin-bottom:10px;
    margin-top:10px;
 }
.column1
{
    width : 70%;
    float : left;
    margin-right:10px; 
}

.tick {
    clear : both;
    float : right;
    margin-top:-16px;
} 
```

在表中，这里是标记：

```
<table style="width:100%">
<tr>
 <td>
  <div class="container">
   <div class="column1">
     Text in column1 Text in column1 Text in column1 Text in column1 Text in column1   
     Text in column1 Text in column1 Text in column1 Text in column1 Text in column1 
     Text in column1 Text in column1 Text in column1 Text in column1 Text in column1 
   </div>
  <div>
     <div>
      text in column 2 text in column 2 text in column 2 text in column 2 text in column     
       2 text in column 2 
     </div>
     <div class="tick">
      <input type="checkbox">
     </div>
  </div>

  </div>
  </td>
 <tr>
<table> 
```

希望我不会错过其他任何事情。感谢所有的答复。

# codeigniter - CodeIgniter Active Record：防止插入重复

> ID：11197660
> 
> 赞同：0
> 
> 时间：2012-06-25T21:32:00.830
> 
> 标签：codeigniter, activerecord

我正在使用 SQLLite 中的一个简单用户表尝试 CodeIgniter，该表由 id、name、email 组成。

使用 Active Record 时如何防止插入重复项？

我尝试了以下方法，但它只是不断创建重复项......

```
$data = array(
  'email' => 'd@d.com' ,
  'name' => 'dave' 
);

$this->db->where('users.email != ', 'd@d.com');
$this->db->insert('users', $data); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:52:00.453

如上所述添加唯一索引以确保完全安全。

然后你可以......做这样的事情：

```
$email = 'd@d.com';
$name = 'dave';

$this->db->query("
INSERT INTO users VALUES (email, name)
SELECT email, name
FROM (SELECT ? AS email, ? AS name) AS h
HAVING ! (SELECT COUNT(*) FROM users WHERE email = h.email)
", array($email, $name)); 
```

# php - MongoDB / PHP查询-如果当前时间/日期在计划中

> ID：11197664
> 
> 赞同：0
> 
> 时间：2012-06-25T21:32:28.143
> 
> 标签：php, mongodb, datetime

我有存储事件开始和结束时间的条目。我正在尝试使用 MongoDate 查询以查找当前查询时发生的所有事件。

这里回答了同样的问题，但对于 MongoDB 而不是 MySQL： [PHP / MySQL query - if current time/date is in schedule](https://stackoverflow.com/questions/9801112/php-mysql-query-if-current-time-date-is-in-schedule)

到目前为止，我能找到的只是 MongoDate 的反向查询：

```
$start = new MongoDate(strtotime("2010-01-15 00:00:00"));
$end = new MongoDate(strtotime("2010-01-30 00:00:00"));

// find dates between 1/15/2010 and 1/30/2010
$collection->find(array("ts" => array('$gt' => $start, '$lte' => $end))); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T22:10:15.163

其实很简单：不检查范围，只检查相等：

```
$now = new MongoDate();
$collection->find(array('ts' => $now)); 
```

...因为看起来您没有将事件开始和结束信息存储在不同的属性中。如果您真的愿意，请使用两个属性：“t_start”和“t_end”，仅在事件实际完成时填充后者。应用此方案时，查询变得有点复杂：

```
$collection->find(array(
  't_end'   => array('$exists' => false)
)); 
```

# ruby - Ruby 将类存储在局部变量而不是实例变量中

> ID：11197666
> 
> 赞同：0
> 
> 时间：2012-06-25T21:32:39.143
> 
> 标签：ruby, unit-testing, instance-variables, local-variables

为什么 Ruby 强迫我在局部变量而不是实例变量中实例化/存储这些类？

在我更改代码以使其正常运行之前，我有这个：

```
require 'test/unit'
require 'converter'

class TestConverter < Test::Unit::TestCase

  @cv = Convert.new

  def test_celsius
    assert_equal(100.0, @cv.celsius(212))
    assert_equal(0.0, @cv.@celsius(32))
  end

  def test_fahrenheit
    assert_equal(212.0, @cv.fahrenheit(100))
    assert_equal(32.0, @cv.fahrenheit(0))
  end

end 
```

这引发了这个错误：

```
% ruby -I. converter_test.rb                                                  ✭
Run options: 

# Running tests:

EE

Finished tests in 0.000616s, 3246.7638 tests/s, 0.0000 assertions/s.

  1) Error:
test_celsius(TestConverter):
NoMethodError: undefined method `celsius' for nil:NilClass
    converter_test.rb:9:in `test_celsius'

  2) Error:
test_fahrenheit(TestConverter):
NoMethodError: undefined method `fahrenheit' for nil:NilClass
    converter_test.rb:14:in `test_fahrenheit'

2 tests, 0 assertions, 0 failures, 2 errors, 0 skips 
```

我决定尝试在每个方法中实例化类（Convert）并成功：

```
require 'test/unit'
require 'converter'

class TestConverter < Test::Unit::TestCase

  #@cv = Convert.new
  #instantiated the class in each method instead of here

  def test_celsius
    cv = Convert.new
    assert_equal(100.0, cv.celsius(212))
    assert_equal(0, cv.celsius(32))
  end

  def test_fahrenheit
    cv = Convert.new
    assert_equal(212, cv.fahrenheit(100))
assert_equal(32, cv.fahrenheit(0))
end
end
ddouglas@coders:~/Develop/davincicoders$ ruby -I. converter_test.rb
Run options: 

# Running tests:

..

Finished tests in 0.001894s, 1055.9149 tests/s, 2111.8298 assertions/s.

2 tests, 4 assertions, 0 failures, 0 errors, 0 skips 
```

为什么 Ruby 在第一次尝试时不会将实例变量识别为对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T21:47:45.700

在测试之外声明`@cv`使其成为实例变量`TestConverter`- 而不是`TestConverter`!

可能最简单的解决方法是将其设为类变量：`@@cv`.

如果您仍然感到困惑，请考虑以下示例：

```
class Foo
  @x = 3
  def initialize
    @y = 4
  end
end

puts Foo.instance_variables
puts Foo.new.instance_variables 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T22:11:37.320

这通常会让人们（包括我）感到困惑，因为它的工作方式与您对其他语言的期望不同。我将尝试用一个 Java 示例来说明：

```
class Foo
  @bar = 42
end 
```

不等于**_**

```
 public class Foo {
      private int bar = 42;
 } 
```

但实际上大致相当于

```
 public class Foo {
      private static int bar = 42;
 } 
```

在你的 IRB 中试一试：

```
class Foo
  attr_accessor :bar
  @bar = 42
  class << self
    attr_accessor :bar
  end
end
Foo.bar # => 42
Foo.new.bar # => nil 
```

* * *

**那么这是为什么呢？**在 Ruby 中，一切都是对象！因此，任何类（例如`Foo`）都是该类的一个实例`Class`（我知道这听起来很混乱）。之间的任何内容都在类`class Foo; end`的实例范围内执行。`Foo``Class`

这绝不是一个完整的解释，因此您应该真正阅读详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:42:15.967

```
assert_equal(0.0, @cv.@celsius(32)) 
```

这不应该是

```
assert_equal(0.0, @cv.celsius(32)) 
```

# json - 设计一个 JSON 接口

> ID：11197667
> 
> 赞同：0
> 
> 时间：2012-06-25T21:32:42.340
> 
> 标签：json, web-services, rest, jsonp, json.net

我需要设计一个 JSON 接口，在我端实现时会生成一个 JSON 数据包（JSON 格式的文档）——远程网站可以使用它（他们将使用他们的 web 服务来使用它）。我应该从哪里开始。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:42:10.260

您可以从[教程](http://www.webmonkey.com/2010/02/get_started_with_json/)开始。并继续进行更[现实的实施](https://developers.google.com/blogger/docs/2.0/json/getting_started)。

# ios - iOS WebApp 的 FB.login 中断流程

> ID：11197668
> 
> 赞同：15
> 
> 时间：2012-06-25T21:32:51.240
> 
> 标签：ios, web-applications, facebook-javascript-sdk

我正在制作一个iOS Webapp（即一个以独立模式运行的HTML页面-没有Safari chrome-当页面的书签添加到主屏幕时）。

我有一个 onclick 调用 FB.login() 的按钮。在独立模式下，webapp 重定向到 facebook 登录页面（如预期的那样），但是之后，我卡在白屏上（我没有被要求进行身份验证，因为我已经拥有了，但我想身份验证屏幕会发生在白屏之前）并且不要放回webapp。

Safari 应用程序中的相同流程按预期工作。单击登录会调用 FB.login()，它会打开一个新页面，要求您登录 Facebook，一旦您登录并验证应用程序，该页面将关闭，您将返回原始页面。

似乎在独立模式下，“第二页”出现问题，FB 登录关闭并重定向回应用程序（它没有）。并且流程被打破了。

有什么解决方法吗？

谢谢，
-Esa

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-27T17:15:23.967

您可以尝试以下解决方法。它对我有用。在移动设备中，它重定向到客户端身份验证 url。

```
var isMobile = false;
try {
    isMobile = (window.location.href == top.location.href && window.location.href.indexOf("/mobile/") != -1);
} catch (e) {}
if (!isMobile) {
    FB.login();
} else {
    var permissionUrl = "https://m.facebook.com/dialog/oauth?client_id=" + appId + "&response_type=code&redirect_uri=" + redirectPage + "&scope=" + permissions;
    window.location = permissionUrl;
    return;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-15T20:46:14.977

我使用以下内容来检测我是否处于主屏幕模式并相应地做正确的事情：

```
if ("standalone" in navigator && navigator.standalone) {
  var permissionUrl = "https://m.facebook.com/dialog/oauth?client_id=" + appId + "&response_type=code&redirect_uri=" + window.location + "&scope=" + app_permissions;
  window.location = permissionUrl;
} else {
  FB.login(
    function(response) {
      ...
    },
    {scope: app_permissions}
  );
} 
```

# css - 使用 CSS 自动添加“必填字段”星号以形成输入

> ID：11197671
> 
> 赞同：171
> 
> 时间：2012-06-25T21:33:01.427
> 
> 标签：css, forms, validation, standards

什么是克服此代码无法按预期工作的不幸事实的好方法：

```
<div class="required">
    <label>Name:</label>
    <input type="text">
</div>

<style>
    .required input:after { content:"*"; }
</style> 
```

在一个完美的世界中，所有 required `input`s 都会得到一个小星号，表示该字段是必需的。这个解决方案是不可能的，因为 CSS 是在元素内容之后插入的，而不是在元素本身之后，但类似的东西是理想的。在具有数千个必填字段的站点上，我可以将输入前面的星号移动到一行 ( `:after`to `:before`)，或者我可以将它移动到标签的末尾 ( `.required label:after`) 或标签前面，或者容器上的位置等...

这一点很重要，不仅以防我改变了将星号放置在何处的想法，而且对于表单布局不允许星号位于标准位置的奇怪情况也很重要。它还可以很好地用于检查表单或突出显示未正确完成的控件的验证。

最后，它不会添加额外的标记。

有没有什么好的解决方案具有不可能代码的全部或大部分优点？

* * *

## 回答 #1

> 赞同：310
> 
> 时间：2012-06-25T21:43:27.663

你是这么想的吗？

[http://jsfiddle.net/erqrN/1/](http://jsfiddle.net/erqrN/1/)

```
<label class="required">Name:</label>
<input type="text">

<style>
  .required:after {
    content:" *";
    color: red;
  }
</style> 
```

```
.required:after {
  content:" *";
  color: red;
}
```

```
<label class="required">Name:</label>
<input type="text">
```

请参阅[https://developer.mozilla.org/en-US/docs/Web/CSS/pseudo-elements](https://developer.mozilla.org/en-US/docs/Web/CSS/pseudo-elements)

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2013-07-07T08:39:17.217

```
.required label {
    font-weight: bold;
}
.required label:after {
    color: #e32;
    content: ' *';
    display:inline;
} 
```

摆弄你的确切结构：http: [//jsfiddle.net/bQ859/](http://jsfiddle.net/bQ859/)

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2014-05-30T21:34:46.133

如下图所示，将其完全放入 INTO 输入中：

![在此处输入图像描述](../Images/ef81d287b9506712e9b3f310d44b5061.png)

我找到了以下方法：

```
.asterisk_input::after {
content:" *"; 
color: #e32;
position: absolute; 
margin: 0px 0px 0px -20px; 
font-size: xx-large; 
padding: 0 5px 0 0; } 
```

```
 <form>
    <div>              
        <input type="text" size="15" />                                 
        <span class="asterisk_input">  </span>            
    </div>            
</form> 
```

我工作的网站是使用固定布局编码的，所以对我来说没问题。

我不确定它是否适合液体设计。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2015-10-27T22:53:54.523

```
input[required]{
    background-image: radial-gradient(#F00 15%, transparent 16%), radial-gradient(#F00 15%, transparent 16%);
    background-size: 1em 1em;
    background-position: right top;
    background-repeat: no-repeat;
} 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2017-07-18T06:42:56.490

用 CSS 写

```
.form-group.required .control-label:after {content:"*";color:red;} 
```

和 HTML

```
<div class="form-group required">

    <label class="control-label">Name:</label>

    <input type="text">

</div> 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2014-09-08T04:47:34.537

```
input[required], select[required] {
    background-image: url('/img/star.png');
    background-repeat: no-repeat;
    background-position-x: right;
} 
```

图片右侧有一些 20 像素的空间，不与选择下拉箭头重叠

![在此处输入图像描述](../Images/5bd99544eb5283d8815b149b3e68ddef.png)

它看起来像这样：![在此处输入图像描述](../Images/2e7d89e57776ab5b23bcee1cdbb7294a.png)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2019-03-01T16:19:17.603

现在是 2019 年，以前对这个问题的答案没有使用

1.  CSS 网格
2.  CSS 变量
3.  HTML5 表单元素
4.  CSS 中的 SVG

CSS 网格是 2019 年创建表单的方式，因为您可以将标签放在输入之前，而无需额外的 div、span、带星号的 span 和其他遗物。

这是我们使用最少 CSS 的地方：

[![示例截图](../Images/de87ce189dc5ff4ca575843c82e86ba9.png)](https://i.stack.imgur.com/n1dcR.png)

上面的 HTML：

```
<form action="https://www.example.com/register/" method="post" id="form-validate" enctype="multipart/form-data">
    <p class="form-instructions">Please enter the following information to create your account.</p>
    <label for="firstname">First name</label>
    <input type="text" id="firstname" name="firstname" value="" title="First name" maxlength="255" required="">
    <label for="lastname">Last name</label>
    <input type="text" id="lastname" name="lastname" value="" title="Last name" maxlength="255" required="">
    <label for="email_address">Email address</label>
    <input type="email" autocapitalize="off" autocorrect="off" spellcheck="false" name="email" id="email_address" value="" title="Email address" size="30" required="">
    <label for="password">Password</label>
    <input type="password" name="password" id="password" title="Password" required="">
    <label for="confirmation">Confirm password</label>
    <input type="password" name="confirmation" title="Confirm password" id="confirmation" required="">
    <input type="checkbox" name="is_subscribed" title="Subscribe to our newsletter" value="1" id="is_subscribed" class="checkbox">
    <label for="is_subscribed">Subscribe to the newsletter</label>
    <input type="checkbox" name="persistent_remember_me" id="remember_meGCJiRe0GbJ" checked="checked" title="Remember me">
    <label for="remember_meGCJiRe0GbJ">Remember me</label>
    <p class="required">* Required</p>
    <button type="submit" title="Register">Register</button>
</form> 
```

占位符文本也可以添加，强烈推荐。（我只是在回答这个中间形式）。

现在对于 CSS 变量：

```
--icon-required: url('data:image/svg+xml,\
<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="-10 -6 16 16"> \
  <line id="line" y1="-3" y2="3" stroke="%23df0000" stroke-linecap="butt" transform="rotate(15)"></line> \
  <line id="line" y1="-3" y2="3" stroke="%23df0000" stroke-linecap="butt" transform="rotate(75)"></line> \
  <line id="line" y1="-3" y2="3" stroke="%23df0000" stroke-linecap="butt" transform="rotate(-45)"></line> \
</svg>');

--icon-tick: url('data:image/svg+xml,\
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100" height="100" viewBox="-2 -2 16 16"> \
            <path fill="green" stroke-linejoin="round" d="M2 6L1 7l3 4 7-10h-1L4 8z"/> \
</svg>'); 
```

表单元素的 CSS：

```
input[type=text][required],
input[type=email][required],
input[type=password][required],
input[type=tel][required] {
    background-image: var(--icon-required);
    background-position-x: right;
    background-repeat: no-repeat;
    background-size: contain;
}

input:valid {
    --icon-required: var(--icon-tick);
} 
```

表单本身应该在 CSS 网格中：

```
form {
    align-items: center;
    display: grid;
    grid-gap: var(--form-grid-gap);
    grid-template-columns: var(--form-grid-template-columns);
    margin: auto;
} 
```

列的值可以设置为`1fr auto`或`1fr`使用任何内容，例如`<p>`表单中的标签设置为跨度 1/-1。您可以更改媒体查询中的变量，以便输入框在移动设备上和桌面上的输入框一样全宽。如果您愿意，还可以使用 CSS 变量方法更改移动设备上的网格间隙。

当这些框有效时，您应该得到一个绿色的勾号而不是星号。

CSS 中的 SVG 是一种让浏览器不必往返于服务器以获取星号图像的方法。通过这种方式你可以微调星号，这里的例子是在一个不寻常的角度，你可以把它编辑掉，因为上面的 SVG 图标是完全可读的。也可以修改视图框以将星号放置在中心上方或下方。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-01-27T04:50:26.087

使用 jQuery 和 CSS

```
jQuery(document).ready(function() {
 jQuery("[required]").after("<span class='required'>*</span>");
});
```

```
.required {
    position: absolute;
    margin-left: -10px;
    color: #FB0000;
    font-size: 15px;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<input type="text" value="xxx" required>
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-11-07T07:36:26.623

我认为这是有效的方法，为什么这么头痛

```
 <div class="full-row">
     <label for="email-id">Email Address<span style="color:red">*</span></label>
  <input type="email" id="email-id" name="email-id"  ng-model="user.email" >
    </div> 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2020-09-07T04:26:10.980

这是一个简单的“*仅 CSS* ”技巧，我创建并使用它在***所需***表单元素的标签上动态添加红色星号，而不会丢失浏览器的默认表单验证。

以下代码在所有浏览器和所有主要表单元素上都能完美运行。

```
.form-group {
  display: flex;
  flex-direction: column;
}

label {
  order: 1;
  text-transform: capitalize;
  margin-bottom: 0.3em;
}

input,
select,
textarea {
  padding: 0.5em;
  order: 2;
}

input:required+label::after,
select:required+label::after,
textarea:required+label::after {
  content: " *";
  color: #e32;
}
```

```
<div class="form-group">
  <input class="form-control" name="first_name" id="first_name" type="text" placeholder="First Name" required>
  <label class="small mb-1" for="first_name">First Name</label>
</div>

<br>

<div class="form-group">
  <input class="form-control" name="last_name" id="last_name" type="text" placeholder="Last Name">
  <label class="small mb-1" for="last_name">Last Name</label>
</div>
```

> **重要提示：** 您必须保留元素的顺序，即首先是输入元素，其次是标签元素。CSS 将以传统方式处理和转换它，即首先是标签，然后是输入。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-05-12T16:06:56.343

如果您使用“浮动标签”（如[https://css-tricks.com/float-labels-css/](https://css-tricks.com/float-labels-css/)或[https://dev.to/adrianbdesigns/let-s-create-a-floating-label-input -with-html-and-css-only-4mo8](https://dev.to/adrianbdesigns/let-s-create-a-floating-label-input-with-html-and-css-only-4mo8)）然后你可以使用这个：

```
input[required]+label:after {
    content: '*';
    color: red;
} 
```

简单，没有图像，不会丢失用户的眼睛。从理论上讲，`:after`如果您希望标签和星号之间有一些间距，您也可以填充。如果你愿意，你也可以使用`:before`代替。`:after`

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2021-06-17T09:38:03.830

如果您在带有必需属性的某个标签内有一个带有字段名称的标签，则以角度形式的常见场景会自动将此属性添加到必填字段

```
[required] label::after {
  content: '*';
  font-size: 24px;
  line-height: 0;
  vertical-align: middle;
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-02-26T12:00:37.807

```
.asterisc {
  display: block;
  color: red;
  margin: -19px 185px;
}
```

```
<input style="width:200px">
<span class="asterisc">*</span>
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-10-19T02:36:08.240

此示例在标签前面放置一个星号，以将该特定输入表示为必填字段。我使用 % 和 em 设置 CSS 属性以确保我的网页具有响应性。如果您愿意，可以使用 px 或其他绝对单位。

```
#name {
   display: inline-block;
   margin-left: 40%;
   font-size:25px;

}
.nameinput{
   margin-left: 10px;
   font-size:90%;
   width: 17em;

}

.nameinput::placeholder {
  font-size: 0.7em;
  vertical-align: middle;
}

#name p{
   margin:0;
   border:0;
   padding:0;
   display:inline-block;
   font-size: 40%;
   vertical-align: super;
}
```

```
<label id="name" value="name">
<p>*</p> 
Name:  <input class="nameinput" type="text" placeholder="Enter your name" required>
</label>
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-12-10T00:46:26.253

您需要的是 :required 选择器 - 它将选择所有具有 'required' 属性的字段（因此无需添加任何其他类）。然后 - 根据您的需要设置输入样式。您可以使用 ':after' 选择器并按照其他答案中建议的方式添加星号

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-12-15T00:00:17.970

可能有很多可能性。您可以反转并使用您喜欢`flex-direction`的属性，如下所示：`required``input`

```
fieldset {
    border: none;
    padding: 0;
    display: flex;
    flex-direction: column-reverse;
}
fieldset p {
    margin-bottom: 4px;
}
fieldset input[required] ~ p:after {
    content: '*';
    color: red;
    font-size: 12px;
    margin-left: 4px;
}
```

```
<form>
    <fieldset>
        <input type="text" placeholder="Severus" name="first_name" required />
        <p>First Name</p>
    </fieldset>
    <fieldset>
        <input type="text" placeholder="Snape" name="last_name" />
        <p>Last Name</p>
    </fieldset>
</form>
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2015-12-17T19:57:39.670

您可以通过将 HTML 代码封装在包含“必需”类后跟“表单组”类的 div 标记中来实现所需的结果。*但是这只有在您有 Bootstrap 时才有效。

```
<div class="form-group required">
    <div class="required">
        <label>Name:</label>
        <input type="text">
    </div>
  <div> 
```

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2016-01-07T21:54:34.133

对于那些最终来到这里但拥有 jQuery 的人：

```
// javascript / jQuery
$("label.required").append('<span class="red-star"> *</span>')

// css
.red-star { color: red; } 
```

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2021-03-03T12:20:42.253

简单而简短

```
<label>Name:<span class="required">*</span></label>

.required {
    color: red;
  } 
```

# stored-procedures - 如何从 Java 中的 oracle SP 返回 sys_refcursor？

> ID：11197674
> 
> 赞同：3
> 
> 时间：2012-06-25T21:33:11.450
> 
> 标签：stored-procedures, jdbc, oracle-cursor

我在 oracle 中有一个存储过程（SP）：

```
CREATE OR REPLACE 
PROCEDURE "SP_SEL_LOGIN_INFO" (
p_username IN varchar2,
p_ResultSet OUT sys_refcursor
) AS

begin

OPEN p_ResultSet FOR
SELECT * FROM user_accounts
WHERE p_username = username;

end; 
```

在我的 java 类中，我有以下代码行来调用 SP：

```
currentCon = connectionpackage.ConnectionManager.getConnection(dbSource);
CallableStatement stmt = currentCon.prepareCall("{call SP_SEL_LOGIN_INFO(?, ?)}");
stmt.setString(1, username); 
stmt.registerOutParameter(2, OracleTypes.CURSOR); //REF CURSOR
stmt.execute();
rs = stmt.getCursor(2); 
```

这就是我在网上找到的调用 SP 并返回游标的方法。当我尝试编译时，出现以下两个错误：

`error: cannot find symbol stmt.registerOutParameter(2, OracleTypes.CURSOR);`并且`error: cannot find symbol rs = stmt.getCursor(2);`它说它找不到 OracleTypes 和 getCursor。

我尝试导入`import oracle.jdbc.driver.*;`or`import oracle.jdbc.*;`并分别得到错误`error: package oracle.jdbc does not exist import oracle.jdbc.driver.*;`和`error: package oracle.jdbc does not exist import oracle.jdbc.*;`。

我在正确的文件夹中也有 ojdbc14.jar 文件，并且可以使用查询字符串进行连接。只是在尝试使用 SP 时给我带来了麻烦。

SP 是我们在当前 CF 网站上使用的一个，所以我想按原样重复使用它。有人可以解释一下为什么这可能行不通吗？或者是否有其他代码可用于从 Oracle SP 返回游标？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T07:36:59.557

请试试这个，它可能会解决问题。

替换这个

```
rs = stmt.getCursor(2); 
```

和

```
 rs = ((OracleCallableStatement)stmt).getCursor(2); 
```

此外，对于调用过程，请使用以下语句。

```
CallableStatement stmt = conn.prepareCall("BEGIN SP_SEL_LOGIN_INFO(?, ?); END;"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-02-18T09:18:55.297

你也可以这样尝试：

```
rs = (ResultSet) stmt.getObject(2);
while (rs.next()) {
     String field1 = rs.getString(1);
     System.out.println(field1);
} 
```

它在我这边运行正常

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T13:05:02.413

> 有人可以解释一下为什么这可能行不通吗？或者是否有其他代码可用于从 Oracle SP 返回游标？

如果您只想返回`resultsets`（记录），那么为什么不使用返回`sys_refcursor`而不是存储过程的函数呢？当然，如果您使用 a`procedure`或`function`就性能而言没有任何区别，这`function`将是最佳实践，因为您除了声明`procedure`之外没有做任何事情。`select`

问候

# html - 对齐 HTML 输入

> ID：11197679
> 
> 赞同：-2
> 
> 时间：2012-06-25T21:33:33.307
> 
> 标签：html, css

我试图在一个表单中对齐多个输入并选择框。我尝试了各种 CSS 样式来尝试对齐它们，但一切似乎都失败了（？？）。

我的 html 可以在这里找到。

[http://jsfiddle.net/felix001/kA8cd/3/](http://jsfiddle.net/felix001/kA8cd/3/)

有谁知道对齐这些元素的任何简单方法。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:38:55.427

> 有谁知道对齐这些元素的任何简单方法。

是的，你可以使用 Twitter Bootstrap：http: [//twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/)

它为常见的 HTML 元素（包括表单）提供了出色的、编写良好的样式。以它们为起点并从那里扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:42:38.727

他们过去常说不要使用表格来布置非表格数据，但在这种情况下，如果你想要一个快速而简单的解决方案，它会起作用。（并不是说我在宽恕使用表格进行布局；只是把它放在那里，如果其他所有方法都失败了，这*是一个选项。）*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T22:23:07.180

如果您只想将它​​们的标签对齐在左侧，在右侧输入，您可以尝试以下操作：

> ​标签 { 明确：两者；向左飘浮; 最小高度：35px；} 输入，选择 { 浮动：对；}​</p>

这不是最好的解决方案，但如果您正在寻找简单、快速和简单的东西，它应该可以工作。您可能希望将所有内容包装在一个 div 中并在该包装器上设置一个宽度，以便字段和标签也更靠近在一起。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T22:24:26.367

我喜欢使用列表来排列我的表格。我不能说这种方法是否仍然被广泛采用，但它对我很有帮助。我玩弄了你的[小提琴](http://jsfiddle.net/tracyfu/kA8cd/12/)，给你一个我如何用列表布置表单的例子，但我没有为你的例子完全设计样式:)

另一个列表示例[http://woork.blogspot.com/2008/06/form-elements-design-using-css-and-list.html](http://woork.blogspot.com/2008/06/form-elements-design-using-css-and-list.html)

列表允许我处理好块。就像@Roddy 说的那样，表格可以工作，但是更好的选择可能是将您的 div 布局为具有类似属性的表格`display: table-cell`。

你也可以像这个人一样使用花车[http://www.dailycoding.com/Posts/layout_form_without_tables_with_css_trick.aspx](http://www.dailycoding.com/Posts/layout_form_without_tables_with_css_trick.aspx)

我认为所有这些方法都相当不错。如果您需要更具体的答案，请提供有关您希望如何调整表格的详细信息。

# linux-kernel - 实现 mmap() 的内核驱动程序是否必须创建字符设备？

> ID：11197680
> 
> 赞同：4
> 
> 时间：2012-06-25T21:33:39.273
> 
> 标签：linux-kernel, buffer, driver, mmap, dma

我正在尝试编写一个内核驱动程序来管理一些物理上连续和可 DMA 内存的内存块（我正在使用这些内存块，`kmalloc()`因为这些只是 DMA 流）。要将某些功能拉入用户空间，该内存将`mmap()`使用其自己的`mmap()`. 我一直在使用*Linux 设备驱动程序*和 Google 中出现的不良示例作为我的主要信息来源。

我的`mmap()`（现在叫它`my_mmap()`）需要在内核中注册。使用 似乎是唯一有效的方法`struct file_operations`，但这需要为它创建一个字符设备和一个物理位置。我不想那样做。我只想为用户空间应用程序创建一个虚拟地址来访问内存缓冲区，而不是创建任何文件来映射内存缓冲区。这可能吗？

我确实发现帧缓冲区也有一个等效的结构和一个`mmap()`实现，但这太过分了。这增加了更多的未知数。

据我了解，只要我对失去的灵活性感到满意，`my_mmap()`就可以进行繁重的工作和使用。`remap_pfn_range()`否则我将不得不实现一个本地`nopages()`并使用`struct vm_operations_struct`. 这个对吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T06:01:07.053

该`mmap()`操作是来自用户空间的请求，将某些源映射到其虚拟地址空间。用户空间程序识别它感兴趣的源的方式*是*提供一个文件描述符（它实际上只是内核已知资源的句柄）。

这意味着您必须使您的设备可表示为文件描述符，以便用户空间程序可以告诉内核它对它感兴趣（并且内核知道调用您的`mmap()`实现） - 注册字符设备是执行此操作的典型方法. 请注意，帧缓冲区设备也可以通过字符设备访问。

`read()`如果它对您的`write()`设备没有意义，您不必实现其他字符设备操作。字符设备只是用户空间程序打开设备的内核管理句柄的一种方式。

# jquery - JQuery Each Selector Ajax Call

> ID：11197685
> 
> 赞同：-2
> 
> 时间：2012-06-25T21:33:57.327
> 
> 标签：jquery

I am trying to grab all the id's that are part_number and feed them 1 at a time into my ajax call:

The html for a single item looks like this:

```
<div class="item">
    <p class="image"><a onmousedown="return SearchSpring.Catalog.intellisuggest(this, 'eJyzNCvJT8thcDRwNDG2NDTXNXR1MdI1sTR21bW0NDDQdXa1cDI2cTE0d3RxY2AwBENjAwZzMyOG9KLMFAC61g1R', 'd1f18f7e3b14f73ded97ff0a97db67a2eb19b128322804efbe2f46bd5fcd3c1f')" href="http://208.69.47.49/ProductSearch/ProductDetail.aspx?ID=KEL-AF24-SR"><img onerror="this.onerror=null;this.src='//d1qhbfo7yqnkif.cloudfront.net/ajax_search/img/missing-image-75x75.gif';" src="//208.69.47.49/Contents/Images/PART18_100PX.GIF"></a></p>
    <p class="name"><a onmousedown="return SearchSpring.Catalog.intellisuggest(this, 'eJyzNCvJT8thcDRwNDG2NDTXNXR1MdI1sTR21bW0NDDQdXa1cDI2cTE0d3RxY2AwBENjAwZzMyOG9KLMFAC61g1R', 'd1f18f7e3b14f73ded97ff0a97db67a2eb19b128322804efbe2f46bd5fcd3c1f')" href="http://208.69.47.49/ProductSearch/ProductDetail.aspx?ID=KEL-AF24-SR">VM2327T23A00T</a></p>
    <p class="price">$388.00</p>
         <p id="part_number">VM2327T23A00T</p>
</div> 
```

Here is my Jquery that is breaking on the .each line:

```
var parts = [];
var listPrices = [];
SearchSpring.jQuery('id').each(function () {
    parts.push(SearchSpring.jQuery(this).attr('part_number'));
    //listPrices.push(SearchSpring.jQuery(this).attr('list_price_baan'));
});
//skus = skus.join(',');
SearchSpring.jQuery.ajax({
    type: "POST",
    url: "RealTimePricing.aspx/GetCustomerPrice",
    data: "{partNumber:' " + parts + "', listPrice: ' " + listPrices + "'}",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    async: true,
    cache: false,
    success: function (data) {
        for (var id in data) {
            var prices = data[id]['prices'];
            SearchSpring.jQuery('#' + id).text(prices);
        }
    }
}); 
```

Can someone point me to why this is breaking at the each line? Also am I calling the "parts" correctly 1 at a time in the ajax call?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:38:25.737

If what you mean is given this markup:

```
<p id="part_number">VM2327T23A00T</p> 
```

You want to get the text inside elements with `id="part_number"`, then you should be doing it like this:

```
$('#part_number').each(function () {
    var text_inside = $(this).text();
    // shove that into an AJAX call
}); 
```

Note, however, that it doesn't make sense to call `.each()` on an ID selector, because you're **supposed** to have only one element with any specific ID.

# android - 如何为 Android UI 正确使用“layout_gravity”？

> ID：11197688
> 
> 赞同：0
> 
> 时间：2012-06-25T21:34:04.060
> 
> 标签：android, android-layout

我想编写一个带有 GUI 的小型 Android 应用程序，该应用程序应在（纵向）屏幕顶部显示图像，直接在可能包含一些信息文本（或只是空白/空）的 TextView 下方，并在底部屏幕一个按钮。因此，在（空）Textview（在顶部图像下方）和按钮之间应该是“最大”空白空间，具体取决于设备的屏幕尺寸。

因此，换句话说：图像和 TextView 组应该浮动在屏幕顶部，底部应该浮动在屏幕底部，中间有一个动态的空白空间。

所以我最终得到了这个布局 XML：

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <ImageView
        android:id="@+id/curr_image"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal|top"
        android:layout_margin="6dip" />

    <TextView
        android:id="@+id/image_info_text"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" />

</LinearLayout>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="bottom"
    android:orientation="vertical" >

    <Button
        android:id="@+id/button"
        android:text="@string/rate_button_text"
        android:layout_width="fill_parent"
        android:layout_height="60dip"
        android:layout_gravity="center_horizontal|bottom"
        android:layout_margin="6dip" />

</LinearLayout>

</LinearLayout> 
```

但是，使用这种布局，所有内容都浮动在屏幕顶部，按钮不会呈现到屏幕底部，如上所述。

有什么想法我在这里做错了吗？在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:41:42.580

尝试将底部所需的布局更改为：

```
<LinearLayout 
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:orientation="vertical" > 
```

另请注意，您只需要这个：

```
xmlns:android="http://schemas.android.com/apk/res/android" 
```

在 xml 文件的第一项中。您应该从所有布局中删除它，文件中的第一个布局除外。

# javascript - 改变画布图像的所有画布方法

> ID：11197689
> 
> 赞同：0
> 
> 时间：2012-06-25T21:34:18.930
> 
> 标签：javascript, html, canvas

我想确定能够直接更改 HTML5 画布图像的所有方法的列表。到目前为止，我的列表由`fillRect`,组成`stroke`，`putImageData`但我确信我遗漏了一些。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:39:07.900

我猜其中很多，您可以尝试一下并完成列表：

```
Object.getOwnPropertyNames( CanvasRenderingContext2D.prototype );

["putImageData",
"rect",
"setLineJoin",
"clearShadow",
"isPointInPath",
"strokeRect",
"createRadialGradient",
"drawImage",
"measureText",
"translate",
"setLineCap",
"arc",
"fillRect",
"setTransform",
"stroke",
"drawImageFromRect",
"setFillColor",
"createPattern",
"setAlpha",
"setShadow",
"strokeText",
"createLinearGradient",
"setCompositeOperation",
"fill",
"transform",
"rotate",
"quadraticCurveTo",
"setMiterLimit",
"clip",
"scale",
"arcTo",
"clearRect",
"bezierCurveTo",
"fillText",
"restore"] 
```

# python - pandas MovingOLS 不支持 NA 值？

> ID：11197690
> 
> 赞同：5
> 
> 时间：2012-06-25T21:34:19.990
> 
> 标签：python, pandas

我正在使用`pandas.ols`版本 0.7.3 中的功能。我有兴趣进行移动回归，例如：

```
model = pandas.ols(y = realizedData, x = pastData, intercept = 0, window_type="rolling", window = 80, min_periods = 80) 
```

输入包含大约 600 个日期的数据，其中 15 个是 NA 值。但输出仅包含大约 120 个日期的回归结果。问题是，只要窗口包含一个 NA 值，该窗口就没有输出。如果我将 window_type 更改为`expanding`并且按预期获得大约 500 个输出点，问题就会消失，但我不想进行扩展回归。

你能告诉我如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T18:56:50.063

尝试设置`min_periods`小于窗口大小（比如 70）。这意味着非 NA 周期的最小数量——只要窗口中有 NA，结果就是 NA。

# asp.net-mvc - 使用 EF 为 ASP.MVC 3 显示空行的最佳方法

> ID：11197692
> 
> 赞同：0
> 
> 时间：2012-06-25T21:34:21.200
> 
> 标签：asp.net-mvc, entity-framework, scheduling

我在显示某些全天活动的小时数和出勤率表时遇到问题。此活动允许为一天中的每个小时注册与会者。我想知道显示当天每小时的与会者人数的最佳方法是什么？问题在于没有与会者登录的时间。显示这个“空”行（零值的小时）的最佳方法是什么？我找到了解决方案，我可以在一些存储过程中处理这个问题，这些存储过程将映射到一些仅用于显示的实体，但我不太喜欢这种方式。解决这个问题的最佳方法是什么？我正在使用带有实体框架的 ASP.MVC 3。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T22:07:45.620

Your problem stems from the fact that you treat your database schema as view model.

You should introduce model classes that will correspond to what the view is displaying. You will be than able to create in controller 'empty' instances of those models, with hours set to 0\. Those model will be than translated to EF entities in your controller and persisted.

By effectively binding your database schema to views you've limited your options. MVC is all about decoupling of views and data persistence.

Yes, in simple scenarios you can get away with passing your EF entities to views, but in more complex ones (like the one you've encountered) decoupling is necessary.

# http-post - webrequest Headers的顺序重要吗？

> ID：11197693
> 
> 赞同：1
> 
> 时间：2012-06-25T21:34:22.497
> 
> 标签：http-post, httpwebrequest, http-request, http-error

我正在发出将图片上传到网站的 POST 请求。
在页面中，有一个`FileUpload`和一个`input` `(textBox)`，在提琴手中我发现该页面正在使用 Multipart Post 请求模式发送一些数据`(Content Disposition: multipart-formdata;)`
一切似乎都很好，因为在提琴手中，关于我的应用程序发布的内容和页面的内容，一切都是一样的正在发送...只是与标题顺序无关...

我的问题是，以正确的顺序放置标题真的很重要吗？如果是，我该怎么做？（因为我们只是在请求中设置一些属性，所以没有设置顺序的地方......）

感谢您的任何建议...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-25T22:02:50.533

HTTP 标头的顺序对于具有不同名称的标头无关紧要。但是，如果有多个具有相同名称的标题，则顺序很重要。

参见[RFC 2616](https://www.rfc-editor.org/rfc/rfc2616#section-4.2)

> **接收具有不同字段名称的标头字段的顺序并不重要**。但是，“好习惯”是先发送通用头字段，然后是请求头或响应头字段，最后是实体头字段。

> 当且仅当该标题字段的整个字段值被定义为逗号分隔列表[即，#(values)] 时，具有相同字段名称的多个消息标题字段可能出现在消息中。必须可以将多个头字段组合成一个“字段名称：字段值”对，而不改变消息的语义，方法是将每个后续字段值附加到第一个字段值，每个字段值用逗号分隔。**因此，接收具有相同字段名称的头字段的顺序**对组合字段值的解释很重要，因此代理在转发消息时不得更改这些字段值的顺序。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-05-02T09:20:09.693

如果您的订单有误，Akamai*将阻止您。*

```
$ curl -v -H "$UA" -H "$ACCEPT" -H "$ENCODING" $URL |& grep '< HTTP'
< HTTP/1.1 403 Forbidden
$ curl -v -H "$ACCEPT" -H "$UA" -H "$ENCODING" $URL |& grep '< HTTP'
< HTTP/1.1 301 Moved Permanently 
```

They use the implicit ordering of specific clients to detect malicious user agents. See my blog the topic:

[http://gwillem.gitlab.io/2017/05/02/http-header-order-is-important/](http://gwillem.gitlab.io/2017/05/02/http-header-order-is-important/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T22:01:27.677

我对 Chrome 的 webRequest api 的经验，从来没有保证 http 标头的顺序。因此，在这方面，标题顺序无关紧要。

# r - 如何通过定义范围（例如 -2 到 2）使 gplots heatmap.2 中的颜色饱和？

> ID：11197694
> 
> 赞同：0
> 
> 时间：2012-06-25T21:34:25.090
> 
> 标签：r, colors, range, heatmap

我有一个 gplots heatmap.2 表，其值范围为 -6 到 6。有什么方法可以将颜色饱和度设置为 -2 到 2？例如，将任何 < -2 的数字分别视为 -2，将 > 2 的数字分别视为 2。提前致谢。

```
heatmap.2(eset, col = greenred(100), scale="none", key=TRUE, symkey=FALSE, density.info="none", trace="none", cexRow=0.9, cexCol=0.9) 
```

样本数据：

```
ID  Class   X1373   X1374   X1375   X1376   X1377   X1378   X1379   X1380   X1381   X1382   X1383   X1384   X1385
A1  LC  -1.33   -3.56   -1.61   -0.71   -4.44   -0.76   2.36    0.64    1.2 0.32    0.02    2.97    0.98
A2  LC  -0.71   0.59    -1.13   -0.62   -2.69   0.02    -0.14   0.16    1.04    0.12    0.11    0.02    1
A3  LC  -1.45   -4.07   -1.09   -1.7    -4.61   0.84    1.62    2.81    0.17    4   0.05    1.6 1.18
A4  LC  -0.11   -2.63   -0.26   -1.42   -1.61   4.38    0.03    1.09    0.75    0.39    4.64    6.03    -1.39
A5  LC  -0.78   -1.78   -0.86   -4.58   -5.96   -0.25   -1.31   -0.85   2.39    0.27    0.13    -0.63   2.28
A6  LC  -0.94   1.5 -1.59   -2.95   -3.42   0.06    1.46    1.07    0.76    0.46    0.79    2.03    1.57
A7  LC  -0.08   0.06    -0.39   0.21    -0.65   -0.38   1.12    0.64    1.19    2.86    0.53    -0.29   0.38
A8  LC  -1.55   -1.45   -1.25   -1.53   -2.41   1.86    2.59    2.75    0.77    2.37    2.08    3.3 -0.21
A9  LC  -0.47   -1.21   0.03    0.1 -0.02   -0.16   0.86    1.09    0.56    0   0.12    4.25    0.36
A10 LC  -1.18   0.92    -1.45   -0.83   -1.87   0.94    1.95    2.62    0.87    4.42    2.05    2.14    1.94
A11 LC  -0.6    -0.55   -0.15   0.08    -1.47   -0.42   0.16    -0.17   0.33    0.3 -0.07   0.24    -0.41
A12 LC  0.04    4.27    -0.9    -0.72   -0.23   0.58    -0.53   0.52    0.37    0.76    0   1.41    1.69
A13 LC  -0.13   1.34    0.35    -1.28   -0.23   -0.03   0.06    2.25    0.99    1.72    0.17    0.96    0.33
A14 LC  -1.2    -5.23   -0.29   -0.69   -1.61   1.6 2.74    2.59    1.57    0.19    3.75    4.51    0.63
A15 LC  -0.78   -1.36   -0.72   -2.52   -4.31   -0.25   -0.06   -0.36   1.44    0.27    0   2.31    2.15
A16 NC  -0.45   -1.18   0.24    -0.27   -0.47   0.68    0.86    1.05    0.49    1.55    0.02    -0.16   0.11
A17 NC  -0.07   0.91    0.07    -0.29   -0.08   -0.87   -1.33   0.15    -0.03   0   0.11    0.87    0.04
A18 NC  -0.4    1.16    -0.17   -0.62   -0.22   -0.12   0.62    0.38    0.15    0   -0.07   -0.21   0.66
A19 NC  -1.02   0.14    -0.03   -0.06   -0.86   -0.04   -0.37   0.46    0.09    0.27    0.02    0.5 -0.97
A20 NC  0.24    2.33    -0.19   -0.06   0.44    -0.26   -1.21   0.51    -0.09   -0.08   0   0.04    -0.51
A21 NC  -0.11   2.2 -0.3    0.7 -0.15   0.47    -0.22   1.24    0.53    2.63    0.2 -0.6    -0.18
A22 NC  0.03    -0.55   -0.37   -0.07   -0.04   0.54    -0.8    0.04    -0.19   -0.01   0.1 -0.1    -0.43
A23 NC  -0.25   -0.67   -0.11   0.05    -0.32   -0.3    0.72    0.14    0.49    -0.03   0   -0.11   0.06
A24 NC  -0.67   0.93    -1.6    -1.2    -0.81   -0.03   -1.71   -0.24   -0.12   1.32    -0.01   -0.13   -0.48
A25 NC  0.15    0.07    -0.04   0.04    -0.22   -0.54   -0.05   0.05    -0.52   -0.05   -0.2    -0.46   -0.25
A26 NC  0.69    -0.37   -0.42   -0.35   0.1 -0.03   -0.28   -0.19   0.04    0   -0.27   0.4 0.52
A27 NC  -0.45   1.27    -0.33   -0.04   0.1 1.08    -0.01   0.62    -0.13   0.48    0.39    0.18    0.19
A28 NC  0.07    -0.98   0.07    -0.31   0.04    0.43    -0.14   -0.16   -0.25   -0.01   -0.02   0.18    -0.14 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-02T18:56:45.503

根据文档，您应该能够提供一个`zlim=c(-2, 2)`参数，该参数传递给底层调用`image()`（绘制热图）。不幸的是，我还没有让它真正起作用。

我想出的一个解决方法是创建以下函数：

```
zlim = function(x, lim) { 
  x[which(x < min(lim))] = min(lim)
  x[which(x > max(lim))] = max(lim)
  return(x)
} 
```

然后`heatmap.2()`用它包裹你传递给它的矩阵，例如

```
heatmap.2(zlim(X, c(-2,2)), ... ) 
```

请注意以下警告：以这种方式设置显示限制将影响`heatmap.2()`. `hclust()`您应该预先使用and生成聚类树状图，`as.dendrogram()`并在必要时使用`Rowv=...`and`Colv=...`参数将它们传递给它们。

## 更新

经过一番搜索，我发现了这篇文章：

[R: heatmap.2 改变颜色键](https://stackoverflow.com/questions/8588352/r-heatmap-2-change-color-key)

它使用了`breaks=...`论点。要达到您想要的范围，请添加`breaks=seq(-2,2,length.out=101)`对`heatmap.2()`. 提供给中断的向量需要比颜色向量使用的长一个元素。由于您使用`col=greenred(100)`,`breaks=...`需要是长度为 101 的向量。

# knockout.js - 带有 require.js 的 Knockout.js 映射插件

> ID：11197696
> 
> 赞同：17
> 
> 时间：2012-06-25T21:34:37.520
> 
> 标签：knockout.js, requirejs, knockout-mapping-plugin

在 require.js 中加载映射插件的标准方法是什么？

下面是我的 config.js（require.js 配置文件）

```
require.config({
    // Initialize the application with the main application file.
    deps: ["app"],

    paths:{
        // JavaScript folders.
        libs: "lib",
        plugins: "lib/plugin",
        templates: "../templates",

        // Libraries.
        jquery: "lib/jquery-1.7.2.min",
        underscore: "lib/lodash",
        text: 'text',
        order: 'order',
        knockout: "lib/knockout",
        knockoutmapping: "lib/plugin/knockout-mapping"

    },

    shim:{
        underscore:{
            exports: '_'
        },

        knockout:{
            deps: ["jquery"],
            exports: "knockout"
        }
    }
} 
```

在我的视图模型中

```
define(['knockout', 'knockoutmapping'], function(ko, mapping) {
} 
```

但是，映射并不绑定到 ko.mapping。任何指针/建议将不胜感激。

谢谢，拉维

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-25T22:12:16.120

与 AMD 一起使用时，映射插件会将其功能导出到单独的对象中。因此，该功能将附加到您的`mapping`变量，您可以调用它的方法（如`mapping.fromJS`）。

如果您的代码依赖于您无法更改的代码，您可以选择在代码中设置`ko.mapping`等于。`mapping``ko.mapping`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-08T20:21:37.577

您的配置对象可以指定一组依赖项和一个回调，可以在其中执行进一步的依赖项配置/操作：

```
var require = {
  paths: {
    'knockout': '...',
    'mapping': '...'
  },

  // configuration dependencies

  deps: ['knockout', 'mapping'],

  // configuration callback

  callback: function (ko, mapping) {
    ko.mapping = mapping;
  }
}; 
```

当您在标记中包含脚本时，应在 require 之前加载配置：

```
<script src="/scripts/config.js" />
<script src="/scripts/require.js" /> 
```

`ko.mapping`现在，当在模块定义中使用时，Knockout.js 将根据需要提供一个属性。

```
define(['knockout'], function (ko) {
  // ko.mapping is available
}); 
```

请注意，这是一个简短的配置示例。映射插件需要一些垫片来指定正确的导出，只是不记得它是什么。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-07T21:11:16.720

附带说明一下，因为您使用的是[Lo-Dash](http://lodash.com) ，所以您不需要在 RequireJS“shim”选项中包含“下划线”。Lo-Dash 内置了 AMD 支持。

# c# - 处理自动缩放的正确方法

> ID：11197701
> 
> 赞同：12
> 
> 时间：2012-06-25T21:34:50.740
> 
> 标签：c#, winforms, .net-4.0

我正在与另一位开发人员一起开发 WinForms 应用程序，我们在与自动缩放相关的外观方面遇到了一个大问题。

我的系统（Sony VAIO）在此菜单上默认为 125%：

![显示缩放](../Images/a6b700cd6cb8b23bf402a1a3c05d523b.png)

据我所知，125% 将 DPI 设置为 120，默认字体大小（菜单等）设置为 11pt。在另一个开发者的系统上，他的默认为 100%，即 96 dpi，和 9pt 字体。我不确定，但我认为只有 DPI 才是让我们感到悲伤的原因。

问题表现为文本大小错误，或者覆盖了其他控件，或者间隔太远（取决于最后在设计器中打开它的人）。据我所知，所有`ContainerControl`s 都设置为`AutoScaleMode.Inherit`，而顶级形式是`AutoScaleMode.Dpi`. 这是大多数人使用的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T14:00:46.020

我的一个应用程序遇到了同样的问题。答案是将其移至 WPF。当我仍然使用 WinForms 时，我提出的解决方案是拥有 2 个可执行文件。一种在 96DPI 下开发，另一种在 120DPI 下开发。这是双重努力，但我尝试了任何布局配置都没有成功。如果我的控件在 96DPI 上看起来不错，那么当切换到 120DPI 时，它们就会超出窗口的应用程序。反之亦然。

WPF 是解决这个烦人问题的唯一方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T21:25:18.243

这可能是表单中组件的锚定问题。例如，如果组件未锚定到所有四个角并且 dpi 更改，则格式可能会受到影响。

当我更改计算机上的 dpi 并打开设计器时，我没有看到任何格式问题......也许更多信息可能会有所帮助。哪些组件相互覆盖？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T05:51:10.913

最后，我们的解决方案是通过设置来*禁用*自动缩放`AutoScaleMode = AutoScaleMode.None`。它需要仔细放置一些东西（并留下比预期更大的间隙），但至少 Auto-Scale 并没有出现并把事情搞砸。

这似乎是一个大问题，因为由于我的屏幕设置较高，甚至 VisualStudio 的某些部分都显示出伪影。

# c++ - 使用 BitBlt 捕获程序窗口总是返回相同的图像

> ID：11197705
> 
> 赞同：5
> 
> 时间：2012-06-25T21:35:04.267
> 
> 标签：c++, winapi, bitblt, getdibits

我编写了以下代码（C++ Win32）来捕获游戏窗口屏幕并从图像中获取像素颜色数组。函数 autoB() 完成了这项工作。

然后我将结果数组绘制到我的窗口中，以直观地检查我得到了什么。

问题是这个程序在我启动计算机后只运行一次，在它第一次“缓存”从游戏中截取的第一个屏幕截图之后，我总是得到相同的像素数组。即使我关闭并重新启动程序，我也会得到相同的屏幕截图。

游戏没有使用 DirectX 在屏幕上绘图，我总是可以使用 Alt+PrtSc 截取屏幕截图。

任何有助于理解为什么会以这种方式发生的帮助表示赞赏。

```
int getPixels(HDC *eClientHdcMem, HBITMAP *eClientBmp, unsigned char **lp) {

BITMAP bmpScreen;   
    BITMAPINFOHEADER bi;

GetObject(*eClientBmp, sizeof(BITMAP), &bmpScreen);

LONG bW = bmpScreen.bmWidth, bH = bmpScreen.bmHeight;

bi.biSize = sizeof(BITMAPINFOHEADER);    
bi.biWidth = bW;    
bi.biHeight = -bH;  
bi.biPlanes = 1;    
bi.biBitCount = 32;    
bi.biCompression = BI_RGB;    
bi.biSizeImage = 0;  
bi.biXPelsPerMeter = 0;    
bi.biYPelsPerMeter = 0;    
bi.biClrUsed = 0;    
bi.biClrImportant = 0;

DWORD dw = ((bW * bi.biBitCount + 31) / 32) * 4 * bH;
*lp = new unsigned char[dw];

return GetDIBits(*eClientHdcMem, *eClientBmp, 0, (UINT)bH, *lp, (BITMAPINFO *)&bi, DIB_RGB_COLORS);

}

void autoB() {
HWND hwnd;
HDC hDC0 = NULL, eClientHdcMem = NULL;
HBITMAP eClientBmp = NULL;
BITMAP bmp = {0};
unsigned char *lp = NULL, *sp = NULL;
WINDOWINFO wi;
wi.cbSize = sizeof(WINDOWINFO);
RECT vp;
int vpW, vpH;
long iW, iH;

if (!(hwnd = FindWindow(NULL,TEXT("Client")))) return;
if (!(hDC0 = GetDC(hwnd))) return;

GetWindowInfo(hwnd,&wi);
vp = wi.rcClient;
vpW = vp.right - vp.left;
vpH = vp.bottom - vp.top;

if (!(eClientBmp = CreateCompatibleBitmap(hDC0, vpW, vpH))) return;
if (!(eClientHdcMem = CreateCompatibleDC(hDC0))) return;
SelectObject(eClientHdcMem, eClientBmp);

BitBlt(eClientHdcMem, 0, 0, vpW, vpH, hDC0, 0, 0, SRCCOPY);

int res = getPixels(&eClientHdcMem, &eClientBmp, &lp);

DeleteObject(eClientBmp);
DeleteObject(eClientHdcMem);

    // begin testing
HDC sts = GetDC(hStats);
HBITMAP stsBmp = CreateCompatibleBitmap(sts, vpW, vpH);
HBITMAP stsBmpOld = (HBITMAP)SelectObject(sts, stsBmp);
unsigned char r,g,b;
for(unsigned int i=0;i<vpW;i++) {
    for(unsigned int j=0;j<vpH;j++) {
        r = lp[(vpW*j+i) * 4 + 2];
        g = lp[(vpW*j+i) * 4 + 1];
        b = lp[(vpW*j+i) * 4 + 0];
        SetPixel(sts,i,j,RGB(r,g,b));
    }
}
SelectObject(sts, stsBmpOld);
DeleteObject(stsBmp);
DeleteObject(stsBmpOld);
ReleaseDC(hStats,sts);
    // end testing

DeleteDC(eClientHdcMem);
ReleaseDC(hwnd,hDC0);

delete [] lp;
lp = NULL;
delete [] sp;
sp = NULL;

} 
```

更改屏幕截图的唯一方法是重新启动游戏。然后，第一个屏幕截图被捕获，无论游戏窗口中发生什么，都会一遍又一遍地显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T22:26:17.663

您确定要返回相同的像素，还是只是在调试窗口中的屏幕上看到相同的图像？原始图像复制代码看起来不错，但在您的“调试”代码中，即使您直接调用 SetPixel()，您仍然需要调用`InvalidateRect()`以使 Windows 发送新的 WM_PAINT 消息。如果您不这样做，您可能只是在查看旧图像，即使确实已捕获新位（但未绘制）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-11T16:24:31.690

我遇到了同样的问题，我注意到**HDC**变量（在你的例子中是*hDC0*）曾经调用**CreateCompatibleDC**，而**BitBlt**则有所不同。如果您使用**GetDC(NULL)**，您将获得整个屏幕的图像，在这种情况下，图像每次都会更新，而使用**GetDC(myWindowHwnd)**则会出现您提到的问题，即始终返回相同的图像而无需任何刷新.

我要捕获的窗口是一个全屏的最顶层窗口，它是这样创建的：

```
 hwnd = CreateWindowExA(0, "myWindow", "myWindow", WS_POPUP, x, y, w, h, NULL, NULL, wc.hInstance, NULL);

    SetWindowLong(hwnd, GWL_EXSTYLE, GetWindowLong(hwnd, GWL_EXSTYLE) | WS_EX_LAYERED | WS_EX_TRANSPARENT);
    SetLayeredWindowAttributes(hwnd, 0, 0xFF, LWA_ALPHA);
    ShowWindow(hwnd, SW_SHOW);
    SetWindowPos(hwnd, HWND_TOPMOST, x, y, w, h, SWP_NOACTIVATE); 
```

即使窗口显示并且高于所有其他窗口，**BitBlt**函数也无法捕获窗口的更新帧，而这是由另一个线程更新的。

# coldfusion - 获取 Coldfusion 复杂对象错误但没有复杂对象

> ID：11197710
> 
> 赞同：0
> 
> 时间：2012-06-25T21:35:40.483
> 
> 标签：coldfusion

我收到“无法将复杂对象类型转换为简单值。” locationId 和/或 operatorId 是通过 url 发送的，并且始终是一个简单的数字（'304'）。这是查询的代码：

```
select  *
from  table1, table2
where table1.u_construct_id(+)=table2.u_construct_id  
and table1.LOCATION_ID  = #locationId#
and   table1.OPERATOR_ID = #operatorId# 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-25T21:58:46.637

***完整***的错误详细信息是什么？它是专门指向查询，还是仅仅指向查询附近的一条线，这导致您假设查询有问题。

（到目前为止，您发布的内容中没有任何内容表明这是一个查询问题。）

在任何情况下，您的查询目前都可能受到 SQL 注入，应更改为：

```
select  *
from  table1, table2
where table1.u_construct_id (+)= table2.u_construct_id  
and table1.LOCATION_ID = <cfqueryparam value="#url.locationId#" cfsqltype="cf_sql_integer" />
and table1.OPERATOR_ID = <cfqueryparam value="#url.operatorId#" cfsqltype="cf_sql_integer" /> 
```

请注意，除了 cfqueryparam（通常应用于所有动态变量，尤其是客户端提供的变量）之外，这两个变量已被确定`url`范围，并且很可能正确地确定变量的范围是解决方法（如果 locationId 或 operatorId存在于其他范围内，作为非简单变量）。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-06-26T14:04:19.560

感谢所有的帮助，但答案是必须重命名 operatorId。不知道为什么会这样，但怀疑 CF 将其视为保留条款。

# javascript - 从 Facebook 上获取评论？

> ID：11197714
> 
> 赞同：4
> 
> 时间：2012-06-25T21:35:55.950
> 
> 标签：javascript, facebook, facebook-javascript-sdk

我有一个 Facebook 应用程序，它有自己的消息系统，但我仍然想显示用户在 Facebook 中通过用户分享或点赞所做的评论。

假设一个 URL（例如[http://myapp.com/?myId=100005235](http://myapp.com/?myId=100005235)）在 Facebook 中共享，人们在共享中添加评论。这样的评论（和用户名）是我想要检索的。

我可以用 facebook-js-sdk 来做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T20:02:02.547

是的你可以。最简单的方法是对 Facebook 进行[FQL](https://developers.facebook.com/docs/reference/fql/)调用。您还*应该*能够通过 Graph API 调用来执行此操作，但在我的测试中，我找不到返回所需数据的方法。

在 FQL 中，您需要查询三个不同的表：`link_stat`获取 URL 的 Facebook id、`comments`获取评论信息以及`user`获取已发表评论的注册用户的名称。

多查询紧随其后，为提高可读性而展开。

```
{
  "my_link":
     "SELECT comments_fbid, comment_count, normalized_url FROM link_stat WHERE 
        url ='http://funcook.com/receta.php?id=53' ",
   "comment":
     "SELECT object_id, fromid, time, text, username FROM comment WHERE 
        object_id IN (SELECT comments_fbid FROM #my_link)",
   "com_users":
      "SELECT name, uid FROM user WHERE uid IN (SELECT fromid FROM #comment)"
 } 
```

您将得到一个 JSON 对象。通过我网站上的一些测试网址，我发现 `my_link.comment_count`并不总是等于`count(comment)`. 我发现其中一个显示为零而另一个不显示的情况。

这是一个脚本：

```
<script>
  FB.api(
    '/fql', {q:{"my_link":"SELECT comments_fbid, comment_count, normalized_url FROM link_stat WHERE url='http://funcook.com/receta.php?id=53'",
        "comment":"SELECT object_id, fromid, time, text, username FROM comment WHERE object_id IN (SELECT comments_fbid FROM #my_link)",  
        "com_users": "SELECT name, uid FROM user WHERE uid IN (SELECT fromid FROM #comment)" }},
  function(response){
   console.log(response)
  });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T06:57:48.093

[这是评论](https://developers.facebook.com/docs/reference/api/Comment/)和[帖子](https://developers.facebook.com/docs/reference/api/post/)的 Graph API 参考。后者说每个帖子都有一个`comments`对象。

我以前真的从未使用过 Graph API，而且我不擅长在头脑中编写代码，所以我无法为您提供实际代码，但可能类似于以下内容：

```
FB.api(
    '/19292868552_10150189643478553', // fetch a post by its id
    function(response) {              // callback function
        for (var comment in response["comments"]["data"]) {

            // process comment

        }
    }
); 
```

尽管在服务器端获取评论可能更有意义 - 取决于您的用例中更有意义的内容。

# python - Jython 可以使用用 Python 制作的 Django 项目吗？

> ID：11197715
> 
> 赞同：2
> 
> 时间：2012-06-25T21:36:03.253
> 
> 标签：python, django, jython

我有一个首先用 Python 编写的 Django 项目。然后我们意识到使用 Jython 可能会有优势。

在花了一两天摆弄 Jython 试图让原始项目在 Jython 中运行之后，我意识到问题可能在于我试图运行一个用 Python 生成的 Django 项目。我在想也许 django-jython 项目可能只会影响使用 Jython 生成的所有 Django 代码。

会是这样吗？当我尝试运行*jython manage.py syncdb*时弹出的错误是*django.core.exceptions.ImproperlyConfigured: Error loading MySQLdb module: No module named MySQLdb*除了 django-jython 应该这样如果我的配置说*'ENGINE': 'doj.backends.zxjdbc.mysql'*然后它会运行正常。哦，我的类路径确实包含 mysql-connector-java-5.1.20-bin.jar

有什么帮助吗？提示？批评？

**编辑**：哦，对不起。在 Jython，我有

```
Django : 1.3.1 
Jython : 2.5.2 
django-jython : 1.3 
```

数据库如下所示：

```
DATABASES = {
    'default': {
        'ENGINE': 'doj.backends.zxjdbc.mysql', # Add 'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'.
        'NAME': 'django_abcd',                      # Or path to database file if using sqlite3.
        'USER': 'abcdef',                      # Not used with sqlite3.
        'PASSWORD': 'ghijkl123',                  # Not used with sqlite3.
        'HOST': '',                      # Set to empty string for localhost. Not used with sqlite3.
        'PORT': '',                      # Set to empty string for default. Not used with sqlite3.
    }
} 
```

**编辑2**：所以我想我发现了一些问题。Jython 正确设置了它自己的东西，但是当我将东西添加到 JYTHONPATH 时，会产生冲突（特别是当我将原始 python 站点包包含到 JYTHONPATH 时）。Jython 没有告诉我有模块名称 MySQLdb，而是告诉我它现在缺少 Grappelli。

所以在某种程度上，我认为这个问题已经解决了。

谢谢大家的时间。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T23:16:43.037

如果您只使用纯 Python 应用程序，那么它应该在 CPython 和 Jython 之间工作，前提是您修改了数据库后端。如果您的任何应用程序中有 C 模块，那么您将需要移植相关代码以使用 Python 或 Java 库。

# jquery - 如何使用 Jquery 动态更改 HTML.CheckBoxFor

> ID：11197718
> 
> 赞同：2
> 
> 时间：2012-06-25T21:36:31.323
> 
> 标签：jquery, asp.net-mvc-3

嗨，伙计们，我有一个问题，我有 3 行用户，每行有 5 个复选框（Html.CheckBoxFor）这些复选框用于为这些用户分配权限。我的问题是当未选中第 1 行的 CheckBox 2 时 CheckBox 1 for row 1 也应该取消选中。但这并没有发生，而不是只取消选中第 1 行，而是取消选中复选框 1 的整个列。这是我的 Jquery 函数。

```
function setRights() {
var personalReport = document.getElementById("personalReports");
alert(personalReport.value);
personalReport.addEventListener('change', function () {
    if (personalReport.value) {
        $($("form #viewAllReports").attr('checked', false));
    }
    else {
    }
});
} 
```

“personalReports”和#viewAllReports“是我给我的 Html.CheckboxFor(s) 的 ID。这确实有效，但也不是我想要的方式，我想我在这里要求的是，一种唯一识别所有这些的方法以我可以在 jquery 中指定它的方式行，以获得所需的结果，这将影响我正在忙的行。提前致谢。

这是我的视图代码：

```
 <div class="chkbox">                            
        @Html.CheckBoxFor(m => m.PersonalReports, new { id = "personalReports", onclick   = "setRights();" })
    </div>
    <div class="chkbox">                            
        @Html.CheckBoxFor(m => m.ViewAllReports, new { id = "viewAllReports"})
    </div>
    <div class="chkbox">                            
        @Html.CheckBoxFor(m => m.EditAI)
    </div>
    <div class="chkbox">                            
        @Html.CheckBoxFor(m => m.ReportBranding)
    </div>
    <div class="chkbox">                            
        @Html.CheckBoxFor(m => m.PersonalizeTheme)
    </div>
    <div class="chkbox">
    @Html.CheckBoxFor(m => m.Search)
    </div>
    <div class="chkbox">
    @Html.CheckBoxFor(m => m.RequestOutOfBundleSearch)
    </div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T02:31:25.510

当我们使用`Html.xxxxxxFor(m => m.property)`时，总是有一个问题：jQuery 选择器是如何获取该元素的？

@[gdoron] 说的是部分正确的：使用和等于属性名称`Html.xxxxxxFor(m => m.property)`构建一个 HTML 元素，除非：`id``name`

1.  属性来自嵌套模型，例如：`model.Address.Street`
2.  属性是一个数组或集合，例如：`model.Order[0]`

尽管您的视图很简单并且没有使用上述任何场景，但为了 jQuery Selector，我仍然更喜欢向元素添加 HTML 属性。

以下代码非常适合我：

```
@Html.CheckBoxFor(m => m.BoolValue1, new { value = "check-box-1" }) Check Box 1 (drives check box 2)
<br />
@Html.CheckBoxFor(m => m.BoolValue1, new { value = "check-box-2" }) Check Box 2

<script type="text/javascript">
    $(function () {
        $('input[value="check-box-1"]').bind('change', function () {
            personalReports_changed();
        });
    });

    function personalReports_changed() {
        if ($('input[value="check-box-1"]').attr('checked'))
            $('input[value="check-box-2"]').attr('checked', true);
        else
            $('input[value="check-box-2"]').removeAttr('checked');
    }
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:50:44.487

尽管我已经回答了这个问题，但我想提出一个相对更复杂的场景，并展示我们如何使用 jQuery 管理复选框以相互影响。

**设想**

1.  想象一下，我们有一个书籍列表（来自数据库或任何其他存储库）
2.  用户可以说：“我喜欢这本书。”
3.  用户可以说：“我喜欢这本书。”

规则：

1.  如果用户*喜欢*一本书，这意味着他/她也*喜欢*它。
2.  如果用户不*喜欢*一本书，他/她也不会*喜欢*它。

**代码**

楷模：

```
namespace MvcApplication1.Models
{
    public class Book
    {
        public string Title { get; set; }
        public bool IsLikeIt { get; set; }
        public bool IsLoveit { get; set; }
    }

    public class Person
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }
    }
} 
```

视图模型：

```
namespace MvcApplication1.ViewModels
{
    public class BookViewModel
    {
        public Models.Person User { get; set; }
        public List<Models.Book> Books { get; set; }
        public BookViewModel()
        {
            Books = new List<Models.Book>();
        }
    }
} 
```

控制器：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        BookViewModel viewModel = new BookViewModel();

        viewModel.User = new Models.Person() 
                   { FirstName = "John", LastName = "Smith" };
        viewModel.Books.Add(new Models.Book() 
                   { Title = "Beginning ASP.NET 4: in C# and VB" });
        viewModel.Books.Add(new Models.Book() 
                   { Title = "Professional ASP.NET 4 in C# and VB" });
        viewModel.Books.Add(new Models.Book() 
                   { Title = "Pro ASP.NET MVC 3 Framework" });
        viewModel.Books.Add(new Models.Book() 
                   { Title = "Microsoft ASP.NET CODING STRATEGIES-W/ ASP .NET TEAM" });
        viewModel.Books.Add(new Models.Book() 
                   { Title = "Pro ASP.NET 4 in C# 2010, Fourth Edition" });

        return View(viewModel);
    }

    [HttpPost]
    public ActionResult Index(BookViewModel viewModel)
    {
        //save data.
        return View(viewModel);
    }

} 
```

查看（\Home\Index.cshtml）：

```
@using MvcApplication1.Models
@model MvcApplication1.ViewModels.BookViewModel
<div>
    <p>
        User name: @Html.DisplayFor(u => u.User.FirstName)
        @Html.DisplayFor(u => u.User.LastName)</p>
</div>
<div>
    @using (Html.BeginForm())
    {
        @Html.HiddenFor(u => u.User.FirstName)
        @Html.HiddenFor(u => u.User.LastName)

        <table border="1">
            <thead>
                <tr>
                    <th>
                        I like it
                    </th>
                    <th>
                        I Love it
                    </th>
                    <th>
                        Book title
                    </th>
                </tr>
            </thead>
            <tbody>
                @for (int index = 0; index < Model.Books.Count; index++)
                {
                    <tr>
                        <td>@Html.CheckBoxFor(b => b.Books[index].IsLikeIt, new { id = string.Format("like-it-{0}", index), data_index = index })
                        </td>
                        <td>@Html.CheckBoxFor(b => b.Books[index].IsLoveit, new { id = string.Format("love-it-{0}", index), data_index = index })
                        </td>
                        <td>@Html.DisplayFor(b => b.Books[index].Title)
                            @Html.HiddenFor(b => b.Books[index].Title)
                        </td>
                    </tr>
                }
            </tbody>
        </table>
        <input type="submit" value="Submit" />
    }
</div>
<script type="text/javascript">

    $(function () {
        $('input[id^="like-it-"]').change(function (e) { likeit_clicked(e); });
        $('input[id^="love-it-"]').change(function (e) { loveit_clicked(e); });
    });

    function likeit_clicked(event) {
        if (!event.target.checked) {
            var index = $(event.target).attr('data-index');
            var loveitid = '#love-it-' + index;
            $(loveitid).attr('checked', false);
        }
    }

    function loveit_clicked(event) {
        if (event.target.checked) {
            var index = $(event.target).attr('data-index');
            var likeitid = '#like-it-' + index;
            $(likeitid).attr('checked', true);
        }
    }

</script> 
```

视图可能看起来很糟糕。您可以根据自己的需求开发更好的视图。

顺便说一句，在 MVC 视图引擎生成的渲染 html 中，您可以看到复选框的长名称：

```
name="Books[0].IsLikeIt"
name="Books[1].IsLikeIt"
name="Books[2].IsLikeIt"
.
.
. 
```

但是通过生成我们自己的 id ( `id = string.Format("like-it-{0}", index)`) 和定义`data-index`属性，jQuery 能够以适当的方式选择和更改此复选框。

另请阅读：[HTML5 自定义数据属性 (data-*)](http://html5doctor.com/html5-custom-data-attributes/)

# java - Netbeans：将一个项目一分为三（客户端/服务器/公共）

> ID：11197721
> 
> 赞同：1
> 
> 时间：2012-06-25T21:36:41.823
> 
> 标签：java, netbeans

在我自我要求学习 Netbeans 的过程中，我决定尝试我已经存在的一个项目。

使用[此处](https://stackoverflow.com/questions/4768218/make-netbeansant-generate-multiple-jar-files-for-one-project)提供的解决方案，我尝试制作三个不同的项目来托管我的代码的服务器/客户端/公共部分。我在第二个失败了，消息是：

```
"Package Folder Already Used in Project"
The following folders that you selected are already used in this or another 
project. 
```

等等等等。底线：在一个项目中用作源的文件夹，不能在另一个项目中用作源。

* * *

问题是，该应用程序*确实*使用单一源文件夹......

*   src/com/.../客户端/
*   src/com/.../common/
*   src/com/.../服务器/

...并且我计划向每个项目添加相同的文件夹，使用包含/排除过滤所需的类。

实现我在这里尝试做的事情的犹太洁食方式是什么？（除此之外，*素食*方式也可以）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T04:55:44.317

我有类似的东西并通过使用符号链接来解决它：

为每个项目创建文件夹。在每个项目文件夹中，创建指向所需（公共）源文件夹的符号链接。

这样，我的 IDE 就很满意了，并且我能够在每个项目中使用公共源代码。当然，YMMV。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T09:04:37.357

为每个项目提供自己的源文件夹，并将它们完全分开。然后将 Common 的项目引用添加到客户端和服务器项目，以便他们可以访问已编译的类文件和文档。我们的一个项目有一个非常相似的设置。

# javascript - HTML5 Canvas - 如何在旋转后获取对象的绝对位置？

> ID：11197726
> 
> 赞同：2
> 
> 时间：2012-06-25T21:37:20.320
> 
> 标签：javascript, html, html5-canvas

你有什么想法，如何在旋转后获得物体的绝对位置？在 Canvas 中，当我们使用 context.rotate() 时，我们实际上旋转了包括 x 和 y 轴在内的所有内容。所以实际上每个对象的位置是相同的。不是吗？

我需要知道任何变换后对象左上角的绝对位置。我必须有可能，但我不知道怎么做。对我来说太难了...请给我一些建议或建议如何做到这一点。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T03:03:21.900

你为什么需要它？一个破解方法可能只是加载你的画布并检查它。

否则，您可以创建几个函数来使用旋转来计算它。

我假设您希望有一个内置的方法或函数可以简单地提供给您，但我不知道有一个。

# objective-c - iOS – 检查 MFMessageComposeViewController 当前是否可见

> ID：11197727
> 
> 赞同：1
> 
> 时间：2012-06-25T21:37:20.770
> 
> 标签：objective-c, ios, cocoa-touch, mfmessagecomposeview

我需要检查`MFMessageComposeViewController`当前是否可见。我怎样才能做到这一点？

我现在正在做的是：

```
//Get the current visible view controller
ViewController *visible = ...

if([visible isKindOfClass:[MFMessageComposeViewController class]])
// This doesn't work because the class is actually CKSMSComposeController 
```

而且我无法检查 CKSMSComposeController 然后 Xcode 会抱怨“使用未声明的标识符 'CKSMSComposeController'”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T15:44:30.507

在呈现模态视图控制器后添加布尔值是最简单的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-18T21:16:21.397

如果您检查`visible`控制器的`parentViewController`属性，它的类应该是`MFMessageComposeViewController`类（至少在 iOS 7 中）。

# mysql - 执行非常慢的 MySQL 查询

> ID：11197729
> 
> 赞同：0
> 
> 时间：2012-06-25T21:37:34.350
> 
> 标签：mysql, sql

我的任务是支持一个非常缓慢的客户端的应用程序。我启用了 MySQL slow_query_log 并发现了一些似乎是罪魁祸首的查询。我对这个查询在做什么有点困惑，但任何关于如何重写它的建议都会有所帮助。

```
SELECT
    table_a.id AS table_a_id_1,
    table_a2.id AS table_a_id_2
FROM
    table_a,
    table_b
LEFT JOIN
    table_a AS table_a2
ON
    table_a.value = table_a2.value
WHERE
    table_a.value_id = 112 AND
    table_a2.value_id = 113 AND
    table_a.status != table_a2.status AND
    table_a.id = table_b.id; 
```

对我来说，查询似乎是从一个表中两次选择相同的数据，然后与所选数据进行一些比较，以及与 table_b 执行连接。这是 MySQL 中引用此查询执行的日志。

```
Query_time: 160.854398
Lock_time: 0.000139
Rows_sent: 12
Rows_examined: 10339025 
```

您可以提供的任何建议都会有所帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T21:51:26.880

查询计划可能正在创建交叉连接，如 WHERE 子句中所指定：

```
SELECT table_a.id AS table_a_id_1,
       table_a2.id AS table_a_id_2
FROM table_a join
     table_b
     on table_a.id = table_b.id LEFT JOIN
     table_a AS table_a2
     ON table_a.value = table_a2.value
WHERE table_a.value_id = 112 AND
      table_a2.value_id = 113 AND
      table_a.status != table_a2.status 
```

这也表明 table_a.id 和 table_a.value 和 table_b.id 上的索引可能有很大帮助。

现在，您也许可以大大简化这个查询。例如，它似乎在状态不同的 table_a 中获得了成对的 112、113。我真的不知道在哪里使用 table_b ，除非有一些过滤标准。您可以通过执行以下操作更有效地获取此列表：

```
SELECT table_a.id AS table_a_id_1,
       table_a2.id AS table_a_id_2
FROM (select ta.* from table_a ta where ta.value_id = 112) ta join
     (select ta.* from table_a ta where ta.value_id = 113) ta2
     ON ta.value = ta2.value and
        ta.status != ta2.status 
```

# python - Python 元组搜索

> ID：11197730
> 
> 赞同：0
> 
> 时间：2012-06-25T21:37:36.543
> 
> 标签：python, for-loop, python-2.7, if-statement

我正在尝试编写一个简单的程序，让我输入一个姓名，然后它会搜索employeeList 以查看此人是否是经理。如果员工人数为`500`或更大，则此人将成为经理。

`["David", 501]`例如，如何在条件语句中仅指定数字部分？我已经使用 item 作为名称，但不确定如何指定数字。谢谢！

```
#!/usr/bin/python

input = raw_input("Please enter name to determine if employee is a manager: ")

employeeList = [["Shawn", 500], ["David", 501], ["Ted", 14], ["Jerry", 22]]

for item in employeeList :
    print "Employee Name is: ", item
    if item == input and item >= 500:
        print "This person is a manager."
    else:
        print "This person is not a manager." 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T21:43:45.793

您可以使用数字索引来引用列表中的特定元素。由于您使用的是列表列表，因此我们可以引用`item`循环变量的索引。

这是您的for循环进行了相应调整：

```
for item in employeeList:
  print "Employee name is: %s" % (item[0])
  if item[0] == input and item[1] >= 500:
    print "This person is a manager."
  else:
    print "This person is not a manager." 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T21:42:51.423

`item[0]`将是姓名和`item[1]`他们的员工编号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T22:07:11.237

This really should be something as:

```
lookup = dict( (name, ' is a manager' if num >= 500 else ' is not a manager') for name, num in employeeList)
print '{}{}'.format(some_name_from_somewhere, lookup.get(some_name_from_somewhere, ' is not known')) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-25T22:10:02.577

First of all, note that in your example you are not using a list of tuples but a list of list. tuples are defined with normal brackets

```
("I", "am", "a", "tuple") 
```

### Sequence access

In Python, `list` and `tuple` are [sequences](http://docs.python.org/tutorial/datastructures.html#tuples-and-sequences), so they can be accessed with numeric indices

For lists:

`item = ["Shawn", 501]`, then you can do `item[0]` and `item[1]`.

For tuples, it's exactly the same:

`item = ("Shawn", 501)`, then you can do `item[0]` and `item[1]`.

### Unpacking

When your tuples are small, 'opening' them - `unpacking` being the Python term - is also very handy

```
item = ("Shawn", 501)
name, number = item # We unpack the content of the tuple into some variables 
```

### Named tuples

Python 2.6 has introduced a [namedtuple()](http://docs.python.org/library/collections.html#collections.namedtuple) type which you may find useful. With your example, you could do something like the following:

```
Employee = namedtuple("Employee", ['name', 'number'])
employeeList = [
    Employee("Shawn", 500),
    Employee("David", 501),
    Employee("Ted", 14],
    Employee("Jerry", 22)
]
for item in employeeList:
    if item.name == name and item.number >= 500:
        print "This person is a manager."
    else:
        print "This person is not a manager." 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-25T21:54:52.230

打印出列表中的每个项目有什么意义？

您只需要找到被查询的人并检查他/她是否是经理

```
#!/usr/bin/python

input = raw_input("Please enter name to determine if employee is a manager: ")

employeeList = [["Shawn", 500], ["David", 501], ["Ted", 14], ["Jerry", 22]]
employeeDict = dict(employeeList)

if input in employeeDict:
    if employeeDict[input] > 500:
        print "This person is a manager."
    else:
        print "This person is not a manager."
else:
    print "This person is not an employee." 
```

# android - SQLiteDatabase.rawQuery 中的字符串编码错误

> ID：11197731
> 
> 赞同：1
> 
> 时间：2012-06-25T21:37:38.973
> 
> 标签：android, sqlite, debugging, encoding

我正在构建一个 SQLite 查询作为`String`with`String.format`并将其传递给`SQLiteDatabase.rawQuery`. 我最后传递的整数参数被硬编码为零（我正在寻找任何大于零的值）。这在我的所有测试中都正常工作，但我从现场收到了崩溃报告。我使用的崩溃报告网站没有提供详细的系统/环境信息。这是崩溃的代码：

```
String query = String.format("SELECT * FROM %s WHERE %s > %d",
                            TableName,
                            ColumnName,
                            0);     
Cursor c = db.rawQuery(query, null); 
```

抛出的异常如下：

```
android.database.sqlite.SQLiteException: no such column: Û°: , while
compiling: SELECT * FROM TableName WHERE ColumnName > Û° 
```

崩溃前堆栈跟踪中的最后几行是：

```
SQLiteCompiledSql.java:-2:in android.database.sqlite.SQLiteCompiledSql.native_compile
SQLiteCompiledSql.java:68:in android.database.sqlite.SQLiteCompiledSql.<init>
SQLiteProgram.java:143:in android.database.sqlite.SQLiteProgram.compileSql 
```

这看起来一定是编码错误。但是，我不知道如何判断这是什么原因。我正在使用`SQLiteOpenHelper`高级方法来创建和连接到我的数据库，所以我没有明确设置编码。此外，错误报告很少，但它们只出现在运行 ICS 的设备上，因此这可能是 ICS 中 SQLite 类中使用的默认值中的新内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T04:12:08.530

我同意这`query`不是`rawQuery`一个更好的解决方案，而是`String.Format()`有一个选择语言环境的表格。在一些类似的情况下，不使用它让我很痛苦：

```
String query = String.format(Locale.US,
                             "SELECT * FROM %s WHERE %s > %d",
                             TableName,
                             ColumnName,
                             0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T22:15:42.583

你可以试试，

```
String sql = "SELECT * FROM ? WHERE ? > ?";
String[] selectionArgs = new String[] { TableName, ColumnName, "0"};
Cursor c = db.rawQuery(sql, selectionArgs); 
```

但是，我**强烈**建议您直接使用`SQLiteDatabase`'`query`方法。鉴于它可以防止 SQL 注入，它似乎也可以防止奇怪的编码错误。

```
String[] selectionArgs = new String[] { ColumnName };
Cursor c = db.query(TableName, null, "? > 0", selectionArgs, null); 
```

# ruby-on-rails - ActiveAdmin 仪表板部分未出现？

> ID：11197732
> 
> 赞同：2
> 
> 时间：2012-06-25T21:37:43.187
> 
> 标签：ruby-on-rails, highcharts, partial-views, activeadmin

我正在尝试在 ActiveAdmin 的仪表板中包含一个包含部分内容的部分。该部分出现，但它是空白的 - 如何使部分出现？我想显示一个 Highcharts 图表。

这是我的代码：

仪表板.rb：

```
section "Business Summary", do
    div do
         render 'graph'

       end
  end 
```

_graph.html.erb（位于 app/views/admin/dashboard）：

```
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>

<script type="text/javascript" charset="utf-8">
  $(function() {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                type: 'column'
            },

            xAxis: {
                categories: ['Automotive', 'Agency', 'Contractor', 'Country Club', 'Other']
            },
            yAxis: {
                min: 0,

                title: {
                    text: 'Business Summary'
                },
                stackLabels: {
                    enabled: true,
                    style: {
                        fontWeight: 'bold',
                        color: (Highcharts.theme && Highcharts.theme.textColor) || 'gray'
                    }
                }
            },
            legend: {
                align: 'right',
                x: 100,
                verticalAlign: 'top',
                y: 0,
                floating: true,
                backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColorSolid) || 'white',
                borderColor: '#CCC',
                borderWidth: 1,
                shadow: false
            },
            tooltip: {
                formatter: function() {
                    return '<b>' + this.x + '</b><br/>' + this.series.name + ': ' + this.y + '<br/>' + 'Total: ' + this.point.stackTotal;
                }
            },
            plotOptions: {
                column: {
                    stacking: 'normal',
                    dataLabels: {
                        enabled: true,
                        color: (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'white'
                    }
                }
            },
            series: [{
                name: 'Mobile',
                data: [5, 3, 4, 27, 2]},
            {
                name: 'Foursquare',
                data: [2, 2, 3, 2, 1]},
            {
                name: 'Facebook',
                data: [3, 4, 4, 2, 5]},
            {
                name: 'Yelp',
                data: [3, 4, 4, 2, 5]},
            {
                name: 'Google',
                data: [3, 4, 4, 2, 5]}]
        });
    });

});​​
</script>
<div id="container" style="min-width: 400px; height: 400px; margin: 0 auto"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T23:26:05.670

活动管理员似乎没有加载您在 application.js 中定义的任何资产（或者对我来说似乎没有......）。当我尝试生成一些图表时，这导致了一个问题。

我正在使用 raphael 创建一些图表。我在 javascripts 中有一个名为 raphael 的文件夹，其中包含我需要的所有 js 文件。

所以我的部分看起来像这样：

_user_count.html.erb

```
<%= javascript_include_tag '/assets/raphael/raphael.js' %>
<%= javascript_include_tag '/assets/raphael/g.raphael.js' %>
<%= javascript_include_tag '/assets/raphael/g.pie.js' %>

<script>
  $(function() {
    var r = Raphael("holder"),
        pie = r.piechart(320, 240, 100, [55, 20, 13, 32, 5, 1, 2, 10], {
          legend: ["%%.%% - Enterprise Users", "%%.%% IE Users"], legendpos: "west", href: ["http://raphaeljs.com", "http://g.raphaeljs.com"]});

    r.text(320, 100, "Interactive Pie Chart").attr({ font: "20px sans-serif" });
    pie.hover(function () {
      this.sector.stop();
      this.sector.scale(1.1, 1.1, this.cx, this.cy);

      if (this.label) {
        this.label[0].stop();
        this.label[0].attr({ r: 7.5 });
        this.label[1].attr({ "font-weight": 800 });
      }
    }, function () {
      this.sector.animate({ transform: 's1 1 ' + this.cx + ' ' + this.cy }, 500, "bounce");

      if (this.label) {
        this.label[0].animate({ r: 5 }, 500, "bounce");
        this.label[1].attr({ "font-weight": 400 });
      }
    });
  });
</script>

<div id="holder"></div> 
```

我的活动管理部分：

```
section "User Count", do
    div do
      render 'user_count'
    end
  end 
```

现在您可以在部分中使用您的 JavaScript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-09T17:47:56.190

在 ActiveAdmin.setup 中执行 |config| config.register_javascript 'http://code.highcharts.com/highcharts.js'

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-29T03:42:25.070

我修复了它，我所要做的就是用`javascript_include`标签正确地引用我的 JavaScript。

# iphone - CVOpenGLESTextureCacheCreateTextureFromImage 的 avcomposition 失败

> ID：11197735
> 
> 赞同：2
> 
> 时间：2012-06-25T21:37:55.030
> 
> 标签：iphone, ios, opengl-es, avfoundation, gpuimage

我正在尝试通过使用 AVAssetReaderVideoCompositionOutput 作为帧输入将 GPUImage 库中的 GPUImageMovie 扩展到 AVComposition。但是当到达时：

```
- (void)processMovieFrame:(CMSampleBufferRef)movieSampleBuffer {
..
CVReturn err = CVOpenGLESTextureCacheCreateTextureFromImage(kCFAllocatorDefault,        
coreVideoTextureCache, movieFrame, NULL, GL_TEXTURE_2D, GL_RGBA, bufferWidth,   
bufferHeight,    GL_BGRA, GL_UNSIGNED_BYTE, 0, &texture);
... 
```

我得到：无法创建 IOSurface 图像（纹理）电影 CVOpenGLESTextureCacheCreateTextureFromImage 失败（错误：-6683）

结果是：kCVReturnPixelBufferNotOpenGLCompatible -6683

由于不支持的缓冲区大小、像素格式或属性，像素缓冲区与 OpenGL 不兼容。适用于 iOS 4.0 及更高版本

有任何想法吗？谢谢

# c++ - STL 优先队列：诉诸何时/如何发生？

> ID：11197738
> 
> 赞同：2
> 
> 时间：2012-06-25T21:38:07.150
> 
> 标签：c++, stl, priority-queue

如果我有一个 STL priority_queue 结构，其中优先级基于结构的某些属性，并且我更改了其中一个结构的属性，这样新的顺序就会不同，优先级队列会知道自己求助吗？还是我必须将其从队列中删除并再次推入？我在某处读到，在调用 push() 和 pop() 时排序已完成，但我想确定一下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-29T06:14:03.497

`priority_queue` `push()`和成员函数是根据和库函数`pop()`的行为定义的，其中底层容器的全部内容作为范围传入。`push_heap()``pop_heap()`

这些功能要求范围（除了 a 上容器中的最后一项`push_heap()`，因为这是要添加的项）“应为有效堆”。如果您修改包含的元素以使容器不再是有效堆，那么您将获得未定义的行为。

因此，如果您需要以这种方式修改一个元素，您需要通过删除它、修改它，然后将其添加回来来完成它。或者，您可以将内容弄乱，然后调用`make_heap()`以重建堆。

请参见 C++11 23.6.4.3“priority_queue 成员”、25.4.6.1“push_heap”和 25.4.6.2“pop_heap”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-29T06:04:10.127

没有办法做你描述的事情。

*将项目推*送到优先级队列有三种方法：

1.  `push()`（这意味着移动或复制项目，而不是参考）
2.  在构造队列时传递另一个容器或迭代器范围（这也涉及制作副本或移动，然后在副本上形成堆；不保留对原件的引用）
3.  `emplace()`（这意味着在队列中创建一个新项目，但无法获得对它的引用）

*访问*元素的唯一方法是通过`top()`函数，它返回一个常量引用。

因此，在推送项目时无法保留对项目的引用，或获取对队列中已存在项目的非 const 引用。因此，无法直接修改队列项。

理论上，进行会影响排序顺序的修改的唯一方法是队列中的项目是否包含指向外部对象的指针，并且排序顺序是否取决于这些外部对象的内容。在这种情况下，您显然可以修改这些外部对象，而队列项目仍然指向它们。然后排序顺序将变得无效——优先级队列不会更新它，因为它甚至不知道修改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-29T06:27:15.857

它肯定不会以正确的方式重新排序，至少不能保证。priority_queue 的 push() 和 pop() 只是调用底层堆结构的 std::push_heap() 和 std::pop_heap() 。

的效果

```
push(const value_type& x) 
```

是

```
c.push_back(x);
push_heap(c.begin(), c.end(), comp); 
```

根据 C++03 标准 (23.2.3.2.2)，其中**c**是队列的底层容器，而**comp**是排序函数。

**push_heap**的一项要求是

> 范围 [first, last - 1] 应为有效堆。

根据 C++03 标准的 25.3.6.1。

如果修改priority_queue 的现有结构，这会破坏堆结构，并且必须使用make_heap 重新制作它才能再次成为有效的堆结构。

priority_queue 也无法知道您是否使用外部引用/指针修改了元素，因为调用其方法之一不会通知它。

您应该删除该元素并再次添加它以实现您想要的。您还可以使用完全不同的容器，在其中您可以更灵活地选择要删除和再次添加的元素，例如 std::map。

# mysql - 2个内部连接2个表mysql

> ID：11197747
> 
> 赞同：0
> 
> 时间：2012-06-25T21:38:52.093
> 
> 标签：mysql, inner-join

我有 3 张桌子。

```
users
------------
id   |  Name   |
------------
44   |   user1 |
45   |useradmin|

Sections
------------
id | Name
------------
1  | Test   |

Assigns
------------
id | u_id | section_id | admin_u_id
-----------------------------------
1  | 44   |    1       |    45     | 
```

我正在尝试拉起`Assigns`表格并将 u_id 和 admin_u_id 替换为相应的用户名，并将 section_id 替换为部分名称。

到目前为止我所拥有的：

```
SELECT Assigns.u_id, Assigns.id, users.id,users.id
FROM Assigns
INNER JOIN users
ON Assigns.u_id=users.id
INNER JOIN users
ON Assigns.admin_u_id=users.id
INNER JOIN Sections
ON Assigns.section_id=Sections.id 
```

让我失望的是选择线。我希望它以不同的值显示 users.id 两次。

非常感谢任何帮助或朝着正确的方向推动。

谢谢！！！

编辑：这是实际的表名。

我的 MYSQL 查询中没有任何错误，只是返回了一个空集

```
SELECT mrfv0_codes_assign.u_id, mrfv0_codes_assign.id, u1.id,u2.id 
FROM mrfv0_codes_assign 
INNER JOIN mrfv0_users u1 ON mrfv0_codes_assign.u_id=u1.id 
INNER JOIN mrfv0_users u2 ON mrfv0_codes_assign.admin_u_id=u2.id 
INNER JOIN mrfv0_codes_sections ON mrfv0_codes_assign.section_id=mrfv0_codes_sections.id 
```

**EDIT2：我是个白痴。我没有正确设置我的桌子。你们都答对了！抱歉浪费您的时间！！！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:43:15.930

```
SELECT a.u_id,
       a.id,
       u1.name AS Username,
       u2.name AS AdminUsername,
       s.name AS SectionName
FROM mrfv0_codes_assign a
INNER JOIN mrfv0_users u1 ON a.u_id = u1.id
INNER JOIN mrfv0_users u2 ON a.admin_u_id = u2.id
INNER JOIN mrfv0_codes_sections s ON a.section_id = s.id 
```

[SQL 小提琴示例](http://sqlfiddle.com/#!3/2c517/1)

**输出**

```
| U_ID | ID | USERNAME | ADMINUSERNAME | SECTIONNAME |
------------------------------------------------------
|   44 |  1 |    user1 |     useradmin |        Test | 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T21:43:26.090

```
SELECT Assigns.id AS id,
       users.name AS user_name, 
       admins.name AS admin_name, 
       Sections.name AS section_name
FROM Assigns
INNER JOIN users ON Assigns.u_id = users.id
INNER JOIN users AS admins ON Assigns.admin_u_id = admins.id
INNER JOIN Sections ON Assigns.section_id=Sections.id 
```

只需在您的 INNER JOIN 上添加一个别名，它允许您将用户“用户”表与用户“管理员”表区分开来。

在这里，您的结果将是这种数组：`[id, user_name, admin_name, section_name]`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T21:44:37.100

尝试为您的表分配别名。例子：

```
SELECT Assigns.u_id, Assigns.id, u1.id,u2.id
FROM Assigns
INNER JOIN users u1
ON Assigns.u_id=u1.id
INNER JOIN users u2
ON Assigns.admin_u_id=u2.id
INNER JOIN Sections
ON Assigns.section_id=Sections.id 
```

# iphone - 改变超级视图的不透明度奇怪的效果导致子视图的奇怪不透明度变化

> ID：11197750
> 
> 赞同：5
> 
> 时间：2012-06-25T21:39:24.687
> 
> 标签：iphone, objective-c, ios, ipad

我有一个包含两个重叠子视图（一个粉红色和一个绿色）的超级视图。更改父视图的不透明度时，子视图显示重叠部分（即使它们完全不透明）。我怎样才能使整个视图消失，而不是单个子视图。我也试过改变`CALayer`. 这是一个屏幕：

![两个重叠的视图](../Images/61f717cf2cdb91041ade7c642d42e87b.png)

可以在[此处](http://cl.ly/2r2n1w0p0s1u212Q2n0E)找到完整版本的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T22:16:52.657

你的答案可以在这里找到[iOS 控制 UIView alpha behavior for subviews](https://stackoverflow.com/questions/8581994/ios-controlling-uiview-alpha-behaviour-for-subviews)。

基本上设置了 UIViewGroupOpacity。

# xml - 使用 Linux Bash 脚本从 XML 文件中获取数据

> ID：11197751
> 
> 赞同：0
> 
> 时间：2012-06-25T21:39:50.293
> 
> 标签：xml, linux

我有一个 XML 文件，其中包含我需要使用 Linux Bash 脚本提取的数据。例如，我需要括号中的所有内容并相应地在终端中打印出来（第一个描述旁边的名字）。

做这个的最好方式是什么？我可以使用 XPath 使用 c# 来做到这一点，但我不能简单地使用 Linux Bash 脚本来做到这一点，对吗？我知道我可以使用 awk、sed、grep、cut 等完成大部分工作，但我认为（实际上我知道我没有）做得很好。我曾经将描述数据提取到文件中并将名称提取到文件中，但是几个小时后，我意识到这不是最好/正确的方法。

它应该如何阅读的示例是。

*   名称1 - 描述1
*   名称 2 - 描述 2
*   名称 3 -（空白）
*   名称 4 - 描述 3

谢谢！

如果我可以添加任何细节以使其更清晰，请告诉我！（工作一整天，大脑有点炸了）

示例 XML（将其简化为一个实例）

```
<zabbix_export>
<templates>
    <template>
        <items>
            <item>
                <name>Available memory</name>
                <description>Available memory is defined as free+cached+buffers memory.</description>                  
            </item>
        </items>
    </template>
<templates> 
```

它应该如何读出：

```
<name>Available memory</name> - <description>Available memory is defined as free+cached+buffers memory.</description>
<name>Another Name</name> - <description>Another Description</description>
<name>Another Name</name> - <description>Another Description</description>
<name>Another Name</name> - <description>Another Description</description> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T22:00:52.087

### 命令

```
xmlstarlet sel -t -m '//item/*' -c . -n input.xml |
    sed '2~2s/$/\n/' |
        awk -F'\n' -vRS='' '{print $1" - "$2}' 
```

### 输出

```
<name>Available memory</name> - <description>Available memory is defined as free+cached+buffers memory.</description>
<name>Available memory</name> - <description>Available memory is defined as free+cached+buffers memory.</description>
<name>Available memory</name> - <description>Available memory is defined as free+cached+buffers memory.</description> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T21:49:17.697

您可以`xpath`从 bash 启动命令。它与 Perl XML 一起安装，并允许您非常轻松地对标准输出进行任何 XPath 查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T23:17:41.930

如果`xpath`未安装可执行文件，您可以像这样安装它：

```
cpan XML::XPath 
```

那应该下载必要的 Perl 模块，并安装`xpath`二进制文件。

# git - CodeIgniter 和 Secrets/API 密钥

> ID：11197752
> 
> 赞同：2
> 
> 时间：2012-06-25T21:39:53.100
> 
> 标签：git, codeigniter, github, api-key

所以我正在编写代码并将其推送到 github 并将其推送到 github 等......

问题是当我这样做时，我也在推送 Facebook API 密钥和 config.php 加密密钥之类的东西——有人知道如何在不这样做的情况下推送代码吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T21:46:08.163

只是不要将它们包含在您的代码中并使用环境变量：

```
$my_very_secret_key = getenv("MY_VERY_SECRET_KEY"); 
```

您将在您的网络服务器允许的任何地方定义此密钥。以 nginx 为例：

```
env MY_VERY_SECRET_KEY='OhThatsAVerySecretKey' 
```

Heroku 建议使用此过程来[存储 s3 凭据](https://devcenter.heroku.com/articles/s3)，恕我直言，这是最好的方法。

如果您使用包管理器（例如 composer），您可以安装[Dotenv](https://github.com/vlucas/phpdotenv)包，它允许您使用`.env`项目根目录中的文件。但请确保此文件无法从 Web 读取，否则您的安全密钥将被暴露。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T21:47:57.603

将您的密钥存储在您使用项目级*.gitignore*排除的外部文件配置文件中。如果您已经提交了密钥，则应该使用 git-filter-branch(1) 从存储库中删除它们。

### 也可以看看

*   [https://help.github.com/articles/remove-sensitive-data](https://help.github.com/articles/remove-sensitive-data)
*   [http://git-scm.com/book/en/Git-Tools-Rewriting-History](http://git-scm.com/book/en/Git-Tools-Rewriting-History)
*   [http://git-scm.com/docs/git-filter-branch](http://git-scm.com/docs/git-filter-branch)

# entity-framework - 实体框架：一个数据库，多个 DbContext。这是一个坏主意吗？

> ID：11197754
> 
> 赞同：249
> 
> 时间：2012-06-25T21:39:58.913
> 
> 标签：entity-framework, ef-code-first, entity-framework-4.3, dbcontext

迄今为止，我的印象是 a`DbContext`用于表示您的数据库，因此，如果您的应用程序使用一个数据库，那么您只需要一个`DbContext`.

但是，一些同事希望将功能区域分成单独的`DbContext`类。

我相信这来自一个好地方——保持代码更清洁的愿望——但它似乎不稳定。我的直觉告诉我这是一个坏主意，但不幸的是，我的直觉并不是设计决策的充分条件。

所以我正在寻找：

A）为什么这可能是一个坏主意的具体例子；

B) 保证这一切都会顺利进行。

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2012-06-25T22:35:30.187

单个数据库可以有多个上下文。例如，如果您的数据库包含多个数据库模式并且您希望将它们中的每一个都作为单独的自包含区域来处理，那么它可能很有用。

问题是当您想首先使用代码来创建数据库时 - 只有应用程序中的单个上下文可以做到这一点。这样做的技巧通常是一个包含所有实体的附加上下文，该上下文仅用于创建数据库。仅包含实体子集的真实应用程序上下文必须将数据库初始化程序设置为 null。

在使用多种上下文类型时，您还会看到其他问题 - 例如共享实体类型及其从一个上下文传递到另一个上下文等。通常，它可以使您的设计更加简洁并分离不同的功能区域，但它有额外复杂性的成本。

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2015-01-15T22:02:40.040

我大约四年前写了这个答案，我的观点没有改变。但从那时起，微服务方面有了重大发展。我在最后添加了微服务特定的注释......

我会反对这个想法，用现实世界的经验来支持我的投票。

我被带到一个大型应用程序中，该应用程序有五个用于单个数据库的上下文。最后，我们最终删除了除一个之外的所有上下文 - 恢复为单个上下文。

起初，多个上下文的想法似乎是个好主意。我们可以将我们的数据访问分成多个域并提供几个干净的轻量级上下文。听起来像 DDD，对吧？这将简化我们的数据访问。另一个论点是关于性能的，因为我们只访问我们需要的上下文。

但在实践中，随着我们的应用程序的增长，我们的许多表在不同的上下文中共享关系。例如，在上下文 1 中对表 A 的查询也需要在上下文 2 中连接表 B。

这给我们留下了几个糟糕的选择。我们可以在各种上下文中复制这些表。我们试过这个。这产生了几个映射问题，包括要求每个实体具有唯一名称的 EF 约束。所以我们最终在不同的上下文中得到了名为 Person1 和 Person2 的实体。有人可能会说这对我们来说是糟糕的设计，但尽管我们尽了最大努力，但这就是我们的应用程序在现实世界中实际增长的方式。

我们还尝试查询这两个上下文以获取我们需要的数据。例如，我们的业务逻辑会从上下文 1 中查询它需要的一半，从上下文 2 中查询另一半。这有一些主要问题。我们必须跨不同的上下文执行多个查询，而不是针对单个上下文执行一个查询。这会带来真正的性能损失。

最后，好消息是剥离多个上下文很容易。上下文旨在成为一个轻量级对象。所以我不认为性能是多种情况下的一个很好的论据。在几乎所有情况下，我相信单个上下文更简单、不那么复杂，并且可能会表现得更好，而且您不必实现一堆变通方法来让它工作。

我想到了一种情况，其中多个上下文可能有用。可以使用单独的上下文来解决实际包含多个域的数据库的物理问题。理想情况下，上下文与域是一对一的，与数据库是一对一的。换句话说，如果一组表与给定数据库中的其他表没有任何关系，那么它们可能应该被拉出到一个单独的数据库中。我意识到这并不总是实用的。但是，如果一组表是如此不同，以至于您愿意将它们分成单独的数据库（但您选择不这样做），那么我可以看到使用单独上下文的情况，但这只是因为实际上有两个单独的域。

关于微服务，一个单一的上下文仍然是有意义的。但是，对于微服务，每个服务都有自己的上下文，其中仅包括与该服务相关的数据库表。换句话说，如果服务 x 访问表 1 和 2，并且服务 y 访问表 3 和 4，则每个服务将具有其自己的唯一上下文，其中包括特定于该服务的表。

我对你的想法很感兴趣。

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2015-08-26T13:44:06.880

**通过设置默认模式来区分上下文**

`OnModelCreating`在 EF6 中，您可以有多个上下文，只需在派生类的方法中指定默认数据库架构的名称`DbContext`（Fluent-API 配置所在的位置）。这将在 EF6 中工作：

```
public partial class CustomerModel : DbContext
{   
    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.HasDefaultSchema("Customer");

        // Fluent API configuration
    }   
} 
```

此示例将使用“Customer”作为数据库表的前缀（而不是“dbo”）。更重要的是，它还将为`__MigrationHistory`表添加前缀，例如`Customer.__MigrationHistory`. `__MigrationHistory`因此，您可以在一个数据库中拥有多个表，每个上下文一个表。因此，您为一种上下文所做的更改不会与另一种混淆。

添加迁移时，将配置类的完全限定名称（派生自`DbMigrationsConfiguration`）指定为`add-migration`命令中的参数：

```
add-migration NAME_OF_MIGRATION -ConfigurationTypeName FULLY_QUALIFIED_NAME_OF_CONFIGURATION_CLASS 
```

**上下文键上的简短单词**

根据这篇 MSDN 文章“[章节 - 针对同一数据库的多个模型](https://msdn.microsoft.com/en-us/data/jj591621#multiple)”，即使只有一个`MigrationHistory`表存在，EF 6 也可能会处理这种情况，因为在表中有一个[ContextKey](https://msdn.microsoft.com/query/dev12.query?appId=Dev12IDEF1&l=EN-US&k=k(System.Data.Entity.Migrations.DbMigrationsConfiguration.ContextKey);k(SolutionItemsProject);k(SolutionItemsProject);k(TargetFrameworkMoniker-.NETFramework,Version%3Dv4.5);k(DevLang-csharp)&rd=true)列来区分迁移。

`MigrationHistory`但是，我更喜欢通过指定如上所述的默认模式来拥有多个表。

**使用单独的迁移文件夹**

在这种情况下，您可能还希望在项目中使用不同的“迁移”文件夹。您可以使用以下属性相应地设置`DbMigrationsConfiguration`派生类：`MigrationsDirectory`

```
internal sealed class ConfigurationA : DbMigrationsConfiguration<ModelA>
{
    public ConfigurationA()
    {
        AutomaticMigrationsEnabled = false;
        MigrationsDirectory = @"Migrations\ModelA";
    }
}

internal sealed class ConfigurationB : DbMigrationsConfiguration<ModelB>
{
    public ConfigurationB()
    {
        AutomaticMigrationsEnabled = false;
        MigrationsDirectory = @"Migrations\ModelB";
    }
} 
```

**概括**

总而言之，您可以说一切都清晰地分开：项目中的上下文、迁移文件夹和数据库中的表。

如果有一组实体是更大主题的一部分，但彼此不相关（通过外键），我会选择这样的解决方案。

如果实体组彼此之间没有任何关系，我将为它们中的每一个创建一个单独的数据库，并在不同的项目中访问它们，可能在每个项目中使用一个单一的上下文。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-10-08T01:30:06.927

实现以下的简单示例：

```
 ApplicationDbContext forumDB = new ApplicationDbContext();
    MonitorDbContext monitor = new MonitorDbContext(); 
```

只需在主要上下文中限定属性：（用于创建和维护数据库）注意：只需使用受保护的：（实体未在此处公开）

```
public class ApplicationDbContext : IdentityDbContext<ApplicationUser>
{
    public ApplicationDbContext()
        : base("QAForum", throwIfV1Schema: false)
    {

    }
    protected DbSet<Diagnostic> Diagnostics { get; set; }
    public DbSet<Forum> Forums { get; set; }
    public DbSet<Post> Posts { get; set; }
    public DbSet<Thread> Threads { get; set; }
    public static ApplicationDbContext Create()
    {
        return new ApplicationDbContext();
    }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        base.OnModelCreating(modelBuilder);
    }
} 
```

MonitorContext：在此处公开单独的实体

```
public class MonitorDbContext: DbContext
{
    public MonitorDbContext()
        : base("QAForum")
    {

    }
    public DbSet<Diagnostic> Diagnostics { get; set; }
    // add more here
} 
```

诊断模型：

```
public class Diagnostic
{
    [Key]
    public Guid DiagnosticID { get; set; }
    public string ApplicationName { get; set; }
    public DateTime DiagnosticTime { get; set; }
    public string Data { get; set; }
} 
```

如果您愿意，可以在主 ApplicationDbContext 中将所有实体标记为受保护，然后根据需要为每个模式分离创建额外的上下文。

它们都使用相同的连接字符串，但是它们使用单​​独的连接，因此不要交叉事务并注意锁定问题。通常，您的设计分离，因此无论如何都不应该发生。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-09-10T12:34:31.963

提醒：如果您确实结合了多个上下文，请确保将各种上下文中的所有功能剪切并粘贴`RealContexts.OnModelCreating()`到单个`CombinedContext.OnModelCreating()`.

我只是浪费时间寻找为什么我的级联删除关系没有被保留，只是发现我没有将`modelBuilder.Entity<T>()....WillCascadeOnDelete();`代码从我的真实上下文移植到我的组合上下文中。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-04-22T09:06:15.510

灵感来自 [@JulieLerman 的 DDD MSDN Mag 文章 2013][1]

```
 public class ShippingContext : BaseContext<ShippingContext>
{
  public DbSet<Shipment> Shipments { get; set; }
  public DbSet<Shipper> Shippers { get; set; }
  public DbSet<OrderShippingDetail> Order { get; set; } //Orders table
  public DbSet<ItemToBeShipped> ItemsToBeShipped { get; set; }
  protected override void OnModelCreating(DbModelBuilder modelBuilder)
  {
    modelBuilder.Ignore<LineItem>();
    modelBuilder.Ignore<Order>();
    modelBuilder.Configurations.Add(new ShippingAddressMap());
  }
} 
```

* * *

```
public class BaseContext<TContext>
  DbContext where TContext : DbContext
{
  static BaseContext()
  {
    Database.SetInitializer<TContext>(null);
  }
  protected BaseContext() : base("DPSalesDatabase")
  {}
} 
```

> “如果您正在进行新开发，并且希望 Code First 基于您的类创建或迁移数据库，则需要使用 DbContext 创建一个“超级模型”，其中包含所有需要的类和关系构建代表数据库的完整模型。但是，此上下文不能继承自 BaseContext。杰伦

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-03-13T21:16:10.520

当我遇到这个设计时，我的直觉告诉我同样的事情。

我正在开发一个代码库，其中一个数据库有三个 dbContexts。3 个 dbcontext 中有 2 个依赖于来自 1 个 dbcontext 的信息，因为它提供管理数据。这种设计限制了您如何查询数据。我遇到了无法跨 dbcontexts 加入的问题。相反，您需要做的是查询两个单独的 dbcontexts，然后在内存中进行连接或迭代两者以获得两者的组合作为结果集。这样做的问题是，您现在不是查询特定结果集，而是将所有记录加载到内存中，然后对内存中的两个结果集进行连接。它真的可以减慢速度。

我会问这个问题“**只是因为你可以，你应该吗？**"

请参阅这篇文章了解我遇到的与此设计相关的问题。 [指定的 LINQ 表达式包含对与不同上下文关联的查询的引用](https://stackoverflow.com/questions/7332920/the-specified-linq-expression-contains-references-to-queries-that-are-associated)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-02-10T05:24:52.300

还有一点“智慧”。我有一个面向互联网和内部应用程序的数据库。我对每张脸都有一个上下文。这有助于我保持纪律严明、安全的隔离。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-02-25T14:00:02.487

我想分享一个案例，我认为在同一个数据库中拥有多个 DBContext 的可能性很有意义。

我有两个数据库的解决方案。一种是除用户信息外的域数据。另一个仅供用户参考。该部门主要由欧盟[通用数据保护条例](https://en.wikipedia.org/wiki/General_Data_Protection_Regulation)推动。通过拥有两个数据库，只要用户数据保存在一个安全的地方，我就可以自由地移动域数据（例如从 Azure 到我的开发环境）。

现在对于用户数据库，我已经通过 EF 实现了两个模式。一种是 AspNet Identity 框架提供的默认值。另一个是我们自己实现与用户相关的任何其他内容。与扩展 ApsNet 架构相比，我更喜欢此解决方案，因为我可以轻松处理未来对 AspNet 身份的更改，同时分离使程序员清楚地知道，“我们自己的用户信息”位于我们定义的特定用户架构中.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-12-10T09:27:10.997

在代码优先中，您可以拥有多个 DBContext 和一个数据库。您只需在构造函数中指定连接字符串。

```
public class MovieDBContext : DbContext
{
    public MovieDBContext()
        : base("DefaultConnection")
    {

    }
    public DbSet<Movie> Movies { get; set; }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-05-14T13:08:35.973

嗯，花了很多时间来解决每个数据库模式的单独数据库上下文的问题，希望它可以帮助其他人......

我最近开始从事一个项目，该项目有一个具有 3 个模式的数据库（数据库优先方法），其中一个用于用户管理。每个单独的模式都有一个数据库上下文脚手架。当然，用户也与其他模式相关，例如。schema KB 有一个表 Topic，它有“创建者”、“最后修改者”等。FK 到身份模式、表 appuser。

这些对象是在 C# 中单独加载的，首先，从 1 个上下文加载主题，然后通过来自另一个 db 上下文的用户 ID 加载用户 - 不好，必须解决这个问题！（类似于[使用 EF 6 在同一个数据库中使用多个 dbcontexts](https://stackoverflow.com/questions/42301354/using-multiple-dbcontexts-in-the-same-database-with-ef-6)）

首先，我尝试将缺少的 FK 指令从身份模式添加到 KB 模式，再添加到 KB DB 上下文中的 EF modelBuilder。就好像只有 1 个上下文一样，但我将其分隔为 2 个。

```
modelBuilder.Entity<Topic>(entity =>
{
  entity.HasOne(d => d.Creator)
    .WithMany(p => p.TopicCreator)
    .HasForeignKey(d => d.CreatorId)
    .HasConstraintName("fk_topic_app_users"); 
```

它不起作用，因为 kb db 上下文没有关于用户对象的任何信息，postgres 返回了 error `relation "AppUsers" does not exist`。Select 语句没有关于架构、字段名称等的正确信息。

我几乎放弃了，但后来我注意到运行时有一个开关“-d” `dotnet ef dbcontext scaffold`。它是 -data-annotations 的缩写 - 使用属性来配置模型（如果可能）。如果省略，则仅使用 fluent API。指定此开关后，对象属性不是在 db context 中定义的`OnModelCreating()`，而是在对象本身上定义的，带有属性。

通过这种方式，EF 获得了足够的信息来生成具有正确字段名称和架构的正确 SQL 语句。

TL;DR：单独的 DB 上下文不能很好地处理它们之间的关系 (FK)，每个上下文只有关于其自身实体的信息。当指定“-data-annotations”开关时`dotnet ef dbcontext scaffold`，这些信息不是存储在每个单独的上下文中，而是存储在数据库对象本身上。

# php - PHP 将对象加载到一个文件中以便于访问

> ID：11197756
> 
> 赞同：0
> 
> 时间：2012-06-25T21:40:03.063
> 
> 标签：php, object

网站的新手。有一个快速的问题。

在需要时调用或将对象加载到一个文件中是安全的，例如：

对象.php

```
<?php
require 'autoload.php';

//create global objects
$obj = new Object();
$obj2 = new User();
$obj = new Bus();
?> 
```

头文件.php

```
<?php
require 'objects.php';

echo 'Hello ' . $obj2->getName();
?> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:42:26.870

仅在需要时实例化对象会更聪明。创建对象需要一些时间和一些内存。当您稍后回来更改某些内容时，您还希望能够准确地知道在您来的任何给定执行点正在使用哪些对象。

如果你实例化一堆你不需要的对象，你不可避免地会发现自己想要做出改变，但不得不花时间弄清楚你是否已经使用过 $obj2 或者在第 350 行开始使用它是否安全. 如果你不为你的对象命名更具描述性，你还会发现你会重用变量名，当你的对象没有按照你期望的方式运行时，这会引起混乱。例如，在您的代码中，$obj 是总线，而不是对象。如果你期待一个对象，你会感到困惑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:53:19.060

如果您不需要该对象，则不应加载它。但是，我猜您正在尝试创建一些全球信息存储，并且我假设您需要这种方式。话虽如此，使用静态对象会是一个更好的主意，这样您就不会遇到范围问题。

静态对象通常不会被实例化，只会像这样使用：

```
User::setName('Bob');
echo 'Hello ' . User::getName(); 
```

# database - 将数据库转储文件读入 R

> ID：11197758
> 
> 赞同：0
> 
> 时间：2012-06-25T21:40:16.140
> 
> 标签：database, r

我试图弄清楚如何将数据库转储文件读入*R*中的表中。

这是文件的第一行：

`{ "id" : { "id" : "43" }, "type" : "Account::Private", "full_name" : "Joe Doe" }`

我需要将其解析为具有适当列标题的表。

我只知道格式良好的数据集的`read.table`、、`scan`和基本命令。

谢谢您的帮助。

编辑：

我的 db-dump 看起来像这样：

`{ {"id" : { "id" : "43" }, "type" : "Account::Private", "full_name" : "Joe Doe" }, {"id" : { "id" : "44" }, "type" : "Account::Private", "full_name" : "Jane Doe" }, {"id" : { "id" : "45" }, "type" : "Account::Private", "full_name" : "John Doe" }}`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T22:07:00.840

The database-dump looks like a JSON structure. I'm assuming multiple rows are wrapped as a list, i.e. between "[" and "]".

This snippet

```
install.packages('rjson')
library(rjson)
s <- '[  {"id" : { "id" : "43" }, "type" : "Account::Private", "full_name" : "Joe Doe" },
         {"id" : { "id" : "44" }, "type" : "Account::Private", "full_name" : "Jane Doe" },
         {"id" : { "id" : "45" }, "type" : "Account::Private", "full_name" : "John Doe" }]'
js <- fromJSON(s)
d <- data.frame(t(matrix(unlist(js), ncol=3)))
names(d) <- c('id', 'type', 'full_name')
d 
```

gives

```
 id             type full_name
1 43 Account::Private   Joe Doe
2 44 Account::Private  Jane Doe
3 45 Account::Private  John Doe 
```

If you post a full example of the data, I can perhaps write a more robust snippet (now the number of columns and header names are hard-coded).

# jquery - JQuery 图像不在 IE 中居中

> ID：11197764
> 
> 赞同：0
> 
> 时间：2012-06-25T21:40:49.637
> 
> 标签：jquery, internet-explorer

我有这个页面可以在 Chrome 和 Firefox 中使用，但在 IE 中不适用。该页面有图片，单击时会在页面中心显示较大的图像，并且背景是灰色的。

[http://www.burrardtoastmasters.com/Gallery/2012-Summer.asp](http://www.burrardtoastmasters.com/Gallery/2012-Summer.asp)

最初，我认为只有 IE 8 有问题，但我测试了 IE9，问题也存在。如果重新打开图像，则图像可能居中。IE 中的另一个问题是背景没有完全变灰。浏览器的右侧垂直部分有一些空白。如果您调整浏览器的大小以使其水平变长，则灰色部分不会动态调整大小。

这是缩写的html：

```
<div align="center">
<div id="thumbnail">

<A HREF="/Images/Gallery/2012/Summer_Banquet/01.jpg"><img id="800_600" src="/Images/Gallery/2012/Summer_Banquet/01-s.jpg" /></a>
<A HREF="/Images/Gallery/2012/Summer_Banquet/02.jpg"><img id="800_600" src="/Images/Gallery/2012/Summer_Banquet/02-s.jpg" /></a>    
<A HREF="/Images/Gallery/2012/Summer_Banquet/03.jpg"><img id="800_600" src="/Images/Gallery/2012/Summer_Banquet/03-s.jpg" /></a>       
<A HREF="/Images/Gallery/2012/Summer_Banquet/04.jpg"><img id="800_600" src="/Images/Gallery/2012/Summer_Banquet/04-s.jpg" /></a>       
<A HREF="/Images/Gallery/2012/Summer_Banquet/05.jpg"><img id="800_600" src="/Images/Gallery/2012/Summer_Banquet/05-s.jpg" /></a>

</div>              

<div id="largeimage"></div>
<div id="background"></div>

</div> 
```

**jQuery部分：**

```
// center the large image
jQuery.fn.center = function () {

    //document.write("win height: " +  ($(window).height() - this.height() ) / 2+$(window).scrollTop();

    this.css("position", "absolute");
    this.css("top", ($(window).height() - this.height()) / 2 + $(window).scrollTop() + "px");
    this.css("left", ($(window).width() - this.width()) / 2 + $(window).scrollLeft() + "px");
    return this;
}

$(document).ready(function() {

    // if thumbnail image is clicked, show large image
    $("#thumbnail img").click(function(e){

        // extract the large image's width & height from the image's id attribute
        var strId = this.id;
        var strWidth = strId.substring(0, strId.indexOf("_"));
        var strHeight = strId.substr(strId.indexOf("_") + 1, strId.length - strId.indexOf("_") - 1);

        // set the image's css size attributes
        $("#largeimage").css({"min-width" : strWidth + "px"});
        $("#largeimage").css({"min-height" : strHeight + "px"});

        $("#background").css({"opacity" : "0.7"})
                        .fadeIn("slow");

        $("#largeimage").html("<img src='"+$(this).parent().attr("href")+"' /><br/>")
                   .center()
                   .fadeIn("slow");

        return false;
    });

    // 27 - Escape key
    $(document).keypress(function(e){
        if (e.keyCode == 27){
            $("#background").fadeOut("slow");
            $("#largeimage").fadeOut("slow");
        }
        });

    // if background is clicked, hide large image
    $("#background").click(function(){
        $("#background").fadeOut("slow");
        $("#largeimage").fadeOut("slow");
    });

    // if large image is clicked, hide it
    $("#largeimage").click(function(){
        $("#background").fadeOut("slow");
        $("#largeimage").fadeOut("slow");
    });

}); 
```

**CSS：**

```
img {
    border: none;
}
#thumbnail img {
    cursor: pointer;
}
#largeimage {
    display: none;
    position: absolute;
    background: #FFFFFF;
    padding: 5px;
    z-index: 10;
    /*min-height: 600px;*/
    /*min-width: 800px; */
    color: #336699;
}
#background{
    display: none;
    position: absolute;
    height: 220%;
    width: 100%;
    top: 0;
    left: 0;
    background: #000000;
    z-index: 1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:59:36.507

页面没有 doctype，因此不会验证并以 quirks 模式运行。jQuery 不支持 quirks 模式，IE 经常会出现 css 问题。在您验证页面之前，应该通过[W3C Validator](http://validator.w3.org/check?verbose=1&uri=http%3A%2F%2Fwww.burrardtoastmasters.com%2FGallery%2F2012-Summer.asp)运行它，尝试对 css 或脚本进行故障排除没有多大意义

您应该能够简单地添加一个 html5 文档类型来修复短期验证。然后在 W3C 中再次检查损坏的标签。例如 html5 doctype，请查看此页面的源代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:59:28.583

在 IE 中，它看起来像图像的高度和宽度，直到图像完全加载，

因此，请等到图像加载完毕后再将其居中。

或者在图像的加载事件中强制使用 center()。

一个简单的建议，

```
 var img = $("<img/><br/>");
img.appendTo("#largeimage").load(function(){
   $(this).parent().center();//for ie center agin after image is loaded
   }).attr( 'src' , $(this).parent().attr("href") );
//for non ie center immedietly
$("#largeimage").center().fadeIn("slow"); 
```

粗略的代码，随心所欲

# backbone.js - 将模型添加到主干分页器集合

> ID：11197766
> 
> 赞同：1
> 
> 时间：2012-06-25T21:40:59.943
> 
> 标签：backbone.js, socket.io

我有一个显示使用[Backbone Paginator 的](https://github.com/addyosmani/backbone.paginator)clientPager 构建的集合的视图。页面加载时一切正常。

我还将客户端代码连接到 Socket.IO，它每隔一段时间就会触发模型添加事件。我将模型添加到 Backbone Paginator 集合中，然后在视图中触发“添加”事件：

```
add: function(call){
      var collection = this.collection;

      var $div = this.$(this.div);
        var call_view = CallsView.generateView(call, collection, this.type);
        var html = call_view.render().el;
        $(html).hide().prependTo(this.div).fadeIn('slow');
} 
```

这段代码也很好用。但是，它不会更新分页。是否有使用 Backbone Paginator 执行此操作的标准方法？在这一点上，我有点迷失了。提前致谢！

# c# - 从 windows mobile 6.5 访问网络共享

> ID：11197768
> 
> 赞同：3
> 
> 时间：2012-06-25T21:41:00.940
> 
> 标签：c#, windows-mobile-6.5

这个问题解决了我在[https://stackoverflow.com/questions/11195985](https://stackoverflow.com/questions/11195985)遇到的同样问题。这个问题更侧重于我要解决的具体问题。我没有将原始问题更改为本质上不同的问题，而是开始了这个新问题。

我需要做的是为运行 Windows Mobile 6.5 的设备编写一个程序，它将文件从服务器上的文件共享复制到移动设备。

我一直在寻找一种从移动设备访问网络共享的方法，但我还没有成功。有谁知道从 windows mobile 6.5 访问网络共享的方法，或者任何人都可以确认不支持。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T12:36:58.517

几个月前我尝试过这样做，唯一的方法是实现 SMB 协议，这不是那么简单......但是您可以在您的机器上运行 Web 服务，并通过 HTTP 或下载您想要的文件FTP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T22:01:33.457

这里有一篇关于您需要更改以允许设备连接到 SMB 共享的注册表设置的好帖子。还要确保当您访问共享时，您的网卡设置为“工作”，而不是“Internet”，否则您的 DNS 将无法用于本地 LAN 共享。

[http://www.ghisler.ch/board/viewtopic.php?t=27838](http://www.ghisler.ch/board/viewtopic.php?t=27838)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T14:55:20.910

（这是 Sam 我对 Mangist Answer 的评论的后续行动，因为我缺乏必要的声誉来对答案发表评论。）

要在 Windows Mobile 设备上编辑注册表，我建议尝试[CeRegEditor](http://ceregeditor.mdsoft.pl/)。它在您的 PC 上运行，因此您需要一些连接移动设备的方法。

# spring - 春季验证如何获得验证结果？

> ID：11197772
> 
> 赞同：1
> 
> 时间：2012-06-25T21:41:29.480
> 
> 标签：spring, validation

代码如下：

```
....
@RequestMapping( "/test")
    @ResponseBody
    public ResponseTO test(
            @Valid  @RequestBody RequestTO to, HttpServletResponse resp)
    {
           //how do I get validation results here?
        return new ResponseTO("111");
    }

  @InitBinder
  protected void initBinder(WebDataBinder binder) {
      binder.setValidator(new TestValidator());
  }

class TestValidator implements Validator {

    /**
    * This Validator validates just Person instances
    */
    public boolean supports(Class clazz) {
        return RequestTO.class.equals(clazz);
    }

    public void validate(Object obj, Errors e) {
        ValidationUtils.rejectIfEmpty(e, "name", "name.empty");
        RequestTO tx = (RequestTO) obj;
        if (tx.getName().equals("buy")) {
            e.rejectValue("feature", "NOT BUY");
        } 
    }
} 
```

我无法弄清楚的部分是如何在控制器中获得验证结果？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T08:17:00.290

正如 Sunil 所提到的，您正在混合两种方法

如果要使用 JSR303 Bean 验证，可以定义 bean 字段的约束，例如

```
public class Customer {

    @NotEmpty //make sure name is not empty
    String name;

    @Range(min = 1, max = 150) //age need between 1 and 150
    int age;
 } 
```

`@valid`用于验证 bean 字段，您可以使用`BindingResult`like

```
@RequestMapping(value = "/signup", method = RequestMethod.POST)
    public String addCustomer(@Valid Customer customer, BindingResult result) {

        if (result.hasErrors()) {
            return "SignUpForm";
        } else {
            return "Done";
        }
    } 
```

检查此[链接](http://www.mkyong.com/spring-mvc/spring-3-mvc-and-jsr303-valid-example/)以获取更多详细信息。

或者您可以实现`Validator`和定义`validate`方法（正如您在问题中提到的那样）。
然后您必须调用该`validate`方法，传递`BindingResult`对象并添加错误（如果存在）。然后您可以检查`BindingResult`对象是否有任何错误。
例如。

```
new TestValidator ().validate(requestTO , bindingResult); // invoking validate method 
```

并检查错误

```
if (bindingResult.hasErrors()) {
  // Errors are present do something here
}
else
{
  // All is well!!
} 
```

或者您可以定义`validator`特定的 bean spring 配置文件。检查此[链接](http://www.dzone.com/tutorials/java/spring/spring-form-validation-1.html)以获取详细信息。

# sql - 如何将数据从 dat 插入 sql 表？

> ID：11197780
> 
> 赞同：-5
> 
> 时间：2012-06-25T21:42:01.767
> 
> 标签：sql

我想将 .dat 文件中的数据插入到 sql 表中。但我不想使用批量插入。

dat 文件如下所示：

```
dd  qwe 3
ss  asd 3 
```

我怎样才能做到这一点？

谢谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T22:22:50.440

最简单的方法是将文件的内容复制到 Excel 中，在第一行添加适当的分隔符和逗号，在每个数据列之间使用新列，然后向下拖动到数据行的末尾以重复该操作每一行。将整个填充的网格复制并粘贴到查询窗口中，搜索并用空白替换选项卡，瞧！

![在此处输入图像描述](../Images/3511235f81e2cede6dcde02ccab7f4b2.png)

如果使用 SQL Server 2012，您可以使用更强大的区域编辑功能。例如，您可以将纯文本复制到查询编辑器中，然后使用`Shift`++突出显示多行并同时在所有行上输入文本`Alt`：`Arrow`

![在此处输入图像描述](../Images/965848e5a178ecaef5c89406127833e3.png)

还有其他解决方案，例如 BCP，将 OPENROWSET 与批量提供程序一起使用等，但是您模糊的“不允许”要求使您无​​法猜测是否允许任何这些替代方案。

# java - 计算已经过去了多少时间

> ID：11197781
> 
> 赞同：-1
> 
> 时间：2012-06-25T21:42:07.900
> 
> 标签：java, time

> **可能重复：**
> [如何在 Java 中计算“时间前”？](https://stackoverflow.com/questions/3859288/how-to-calculate-time-ago-in-java)

有没有什么好的例子可以创建关于自事件发生以来已经过去了多少时间的文本（例如 Youtube 有评论（“x 小时前”、“y 个月前”、...））？

我在 Java 中工作。我知道我可以自己实现这一点，但如果有解决方案，它会节省我的一些时间。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:50:28.667

与这里关于时间和 java 的大多数问题一样：

[http://joda-time.sourceforge.net/](http://joda-time.sourceforge.net/)

已经回答过很多次了：

[https://stackoverflow.com/a/2179831/4419](https://stackoverflow.com/a/2179831/4419)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:47:06.760

[我认为相当长的时间](http://ocpsoft.org/prettytime/)会满足您的需求。

# c# - VS2010 在错误的目录中寻找文件

> ID：11197784
> 
> 赞同：0
> 
> 时间：2012-06-25T21:42:15.260
> 
> 标签：c#, visual-studio-2010

Visual Studio 在完全错误的目录中查找 CS 文件。

```
 C:\TRUNK\MAIN\APPRESOURCES\APPINFO.CS 
```

我什至在这个位置找不到中继文件。

正确路径：

```
 C:\Code\Branches\BR5\MAIN\APPRESOURCES\APPINFO.CS 
```

我已经尝试清理解决方案、重建、排除文件并将其添加回我的解决方案。

调用堆栈位置：

```
FormsDevShared.dll!FormsDevShared.AppInfo.Instance() 
```

这是堆栈跟踪：

查找“C:\TRUNK\MAIN\APPRESOURCES\APPINFO.CS”的源。
校验和：MD5 {ed 8a ff 89 84 3d 16 7e 9f 76 af 57 18 9f 62 7a} 判断校验和是否匹配以下位置： 1: C:\Code\Branches\BR5\MAIN\APPRESOURCES\APPINFO.CS Checksum : MD5 {c5 33 96 ef ab 76 b1 3b aa 55 70 76 1b b5 d4 cf} 校验和不匹配。文件“C:\TRUNK\MAIN\APPRESOURCES\APPINFO.CS”不存在。

代码行抛出异常：

```
 FormsDevShared.AppInfo.Instance().User = AppInfo.Instance().DBContext.User; 
```

FormsDevShared 是包含 AppInfo 的命名空间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-21T15:07:15.987

我从 Team Foundation Server 中分支出来的解决方案遇到了这个问题。分支中的解决方案文件指向另一个分支的项目文件夹。我无法让它切换，所以我按照@Ryan O'Neill 的建议做了，并在记事本中打开了 .sln 文件，并将所有错误的文件夹名称替换为正确的文件夹名称。我必须删除解决方案文件上的只读属性才能保存它；但保存后，我的解决方案然后指向正确的项目文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:48:26.153

很可能是项目文件中对文件的引用使用了绝对地址而不是相对地址。

在 VS 项目资源管理器中，首先排除指向错误位置的 Appinfo.cs，然后添加现有文件并包含正确位置的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:50:29.647

在文本编辑器中打开 .csproj（或 .vbproj）。搜索错误的路径并将其替换为正确的路径。

# css - jquery ui选项卡选项卡选择问题

> ID：11197786
> 
> 赞同：1
> 
> 时间：2012-06-25T21:42:19.337
> 
> 标签：css, jquery-ui, tabs

当使用带有数据表的 jquery 选项卡时，我添加了这一行：

```
 var selectedTab = $tabs.tabs('option', 'selected');
    $tabs.find('li').eq(selectedTab).removeClass('ui-tabs-selected').end().tabs('select', selectedTab); 
```

这条线是我发现的唯一会隐藏最初未激活的选项卡，然后当单击新选项卡时，它会隐藏旧的活动选项卡并使单击的选项卡处于活动状态。

但是，当我添加该行时，选项卡和数据表的 css 消失了。

选项卡显示为数据表的锚点的项目符号列表（在单击链接时隐藏和显示的行为正确）

如果有人对如何解决此问题有任何想法，将不胜感激。太感谢了！

# php - 一页加载导致大量 PHP 会话 ID

> ID：11197796
> 
> 赞同：0
> 
> 时间：2012-06-25T21:42:59.117
> 
> 标签：php, session, session-cookies, sessionid

我最近转而使用我们的数据库来为我们的用户管理 PHP 会话。我实现的数据库会话处理程序在很大程度上与[这个](http://www.nateklaiber.com/blog/2006/05/10/custom-php-session-handler "这个")相同。

话虽如此，我遇到了一些奇怪的行为。在单个页面加载时，PHP 会话 ID 会更改几次。例如，下面的输出在我`_write`的`session_set_save_handler()`调用中使用 file_put_contents 在一页加载期间写入文件。

我已经搜索了代码，并且`session_regenerate_id()`从未被调用过，也从未被调用过`session_id(<new_id>)`。此外，我的 php.ini 将 session.auto_start 设置为`Off`. 基本上，鉴于上述事实，我不知道会话 ID 如何在一页加载中发生变化。

我注意到它的原因是因为`REPLACE INTO`链接到网页的 SQL 语句在我的数据库中创建了大约 8 行（每个额外的不同会话 id 一个）。如您所见，其中一个重复了四次左右。这恰好是唯一一个在放入数据库时​​也具有与之关联的数据的会话 ID。

```
f951tbvjkc8c5mv25aakfhoq86
f951tbvjkc8c5mv25aakfhoq86
f951tbvjkc8c5mv25aakfhoq86
f951tbvjkc8c5mv25aakfhoq86
eodjh2vhuo5ni1b7ia5ro6itf7
bada69955ld96fks0g057pp7i2
4n4c00ddlolb9k2t3uh2h66v37
lsqhhmfsund3bp3ocotcrj0l05
qvfe3qp6nupokcncp8jja8tsk0
4qfp9m3knabs88t6n1fkjo8oq6
g52du9v2fcsak27tjo7519q7j0 
```

值得注意的是，我正在加载的页面中有一些对我们自己的服务器的 AJAX 请求。此外，这种行为不会发生在我们网站上的所有页面加载中。到目前为止，我已将范围缩小到发出几个不同 AJAX 请求的这一页。

想法？

更新：我的服务器中有以下虚拟主机作为自定义域的通配符。注释掉的行是我认为是什么原因造成的。当我对此发表评论时，它似乎工作正常。有了它，它似乎会导致奇怪的行为。

```
<VirtualHost *:80>
    DocumentRoot "/opt/local/www/mysite.com"
    ServerName default
    ServerAlias *
    ErrorLog "/opt/local/apache2/logs/mysite.com-error.log"
    CustomLog "/opt/local/apache2/logs/mysite.com-access.log" common
        <Directory "/opt/local/www/mysite.com">
                AllowOverride All
                php_value session.save_path "/opt/local/www/mysite.com/sessions"
                #php_value session.cookie_domain "mysite.local"
                php_value auto_prepend_file "/opt/local/www/mysite.com/core.php"
        </Directory>
</VirtualHost> 
```

# git - 如何在初始提交时使用 git format-patch

> ID：11197812
> 
> 赞同：24
> 
> 时间：2012-06-25T21:44:15.810
> 
> 标签：git, format-patch

我需要为我们的审查过程获取初始提交的补丁文件（不为空），但我很困惑，因为`git format-patch`命令只从初始提交的分支中生成，不包括它。

似乎这一定是一些明显的举动，但我完全想念它。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-25T21:53:50.080

尝试`git format-patch --root $SHA`（`$SHA`第一次提交在哪里）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-24T14:26:55.793

为单个提交制作补丁只需使用

```
git format-patch -1 HEAD # where "1" is a number, not "ell". 
```

其中“HEAD”可以更改为任何其他提交，甚至是哈希码。即使 HEAD 是第一次提交，这也有效。我不确定你是否要求这个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-03-31T10:05:45.283

也许这已经改变了，但是

```
git format-patch --root 
```

刚刚创建了所有补丁文件，包括初始提交和 HEAD。我的 git 版本是`2.26.2.windows.1`.

# sqlite - 如何在 SQLite 中按季度/3 个月（或任何自定义时间段）分组？

> ID：11197814
> 
> 赞同：3
> 
> 时间：2012-06-25T21:44:19.163
> 
> 标签：sqlite, datetime, date

这是我以逗号分隔的表格：

```
date, number
2010-09-02, 2
2010-10-01, 3
2011-01-01, 4
2011-02-01, 5
2011-03-01, 6
2011-05-05, 7 
```

SQLite 的语法中似乎没有“季度”日期时间函数，所以我想知道是否有解决方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T15:30:57.437

```
(cast(strftime('%m', date) as integer) + 2) / 3 as quarter 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-25T22:09:33.823

```
CASE 
  WHEN cast(strftime('%m', date) as integer) BETWEEN 1 AND 3 THEN 1
  WHEN cast(strftime('%m', date) as integer) BETWEEN 4 and 6 THEN 2
  WHEN cast(strftime('%m', date) as integer) BETWEEN 7 and 9 THEN 3
  ELSE 4 END as Quarter 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-11T09:17:28.493

对不起，举个例子。

```
select month, (((3-(month%3))%3)+month)/3 as 'qtr' from months 
```

会给我们：

```
1   1
2   1
3   1
4   2
5   2
6   2
7   3
8   3
9   3
10  4
11  4
12  4 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-05-11T09:15:08.033

如何使用一些模数来解决它。

```
(((3-(month%3))%3)+month)/3 
```

其中月份是 1-12 之间的一列数字

基本上我只是将事情四舍五入到最接近的 3，然后将其潜水 3。

# json - 如何创建具有多个数组的 JSON 对象？

> ID：11197818
> 
> 赞同：89
> 
> 时间：2012-06-25T21:44:48.427
> 
> 标签：json

我以前从未使用过 JSON，所以我不熟悉它的语法。

目前我有多个包含不同数据的数组。

我想创建一个 JSON 对象，其中包含多个数组，每个数组都有几条数据。

例如

一个名为汽车的对象，包含多个数组，每个数组对应不同的汽车品牌。在每个数组中都是汽车模型以及其他一些类型的数据，例如门的数量（并不重要，它只是一个虚构的例子。）

如果有人用示例解释语法，将不胜感激。

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2012-06-25T21:57:17.353

在最外层，JSON 对象以 a 开头，以 a`{`结尾`}`。

样本数据：

```
{
    "cars": {
        "Nissan": [
            {"model":"Sentra", "doors":4},
            {"model":"Maxima", "doors":4},
            {"model":"Skyline", "doors":2}
        ],
        "Ford": [
            {"model":"Taurus", "doors":4},
            {"model":"Escort", "doors":4}
        ]
    }
} 
```

如果 JSON 被分配给一个名为 data 的变量，那么访问它将如下所示：

```
data.cars['Nissan'][0].model   // Sentra
data.cars['Nissan'][1].model   // Maxima
data.cars['Nissan'][2].doors   // 2

for (var make in data.cars) {
    for (var i = 0; i < data.cars[make].length; i++) {
        var model = data.cars[make][i].model;
        var doors = data.cars[make][i].doors;
        alert(make + ', ' + model + ', ' + doors);
    }
} 
```

另一种方法（对汽车模型使用关联数组而不是索引数组）：

```
{
    "cars": {
        "Nissan": {
            "Sentra": {"doors":4, "transmission":"automatic"},
            "Maxima": {"doors":4, "transmission":"automatic"}
        },
        "Ford": {
            "Taurus": {"doors":4, "transmission":"automatic"},
            "Escort": {"doors":4, "transmission":"automatic"}
        }
    }
}

data.cars['Nissan']['Sentra'].doors   // 4
data.cars['Nissan']['Maxima'].doors   // 4
data.cars['Nissan']['Maxima'].transmission   // automatic

for (var make in data.cars) {
    for (var model in data.cars[make]) {
        var doors = data.cars[make][model].doors;
        alert(make + ', ' + model + ', ' + doors);
    }
} 
```

**编辑：**

更正：JSON 对象以 开头`{`和结尾`}`，但具有以 开头和结尾的 JSON 数组（在最外层）也是有效`[`的`]`。

此外，原始 JSON 数据中的重大语法错误已得到纠正：JSON 对象中的所有键名必须用双引号括起来，JSON 对象或 JSON 数组中的所有字符串值也必须用双引号括起来。

**看：**

*   [JSON 规范](http://www.json.org/)
*   [JSONLint - JSON 验证器](http://jsonlint.com/)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-06-25T22:29:58.173

我正在阅读的一本好书：Nicholas C. Zakas 第 3 版为 Web 开发人员提供的专业 JavaScript 包含以下有关 JSON 语法的信息：

> “JSON 语法允许表示三种类型的值”。

关于你感兴趣的，数组它说：

> “数组使用 JavaScript 中的数组文字表示法以 JSON 形式表示。例如，这是 JavaScript 中的数组：

```
var values = [25, "hi", true]; 
```

> 您可以使用类似的语法在 JSON 中表示相同的数组：

```
[25, "hi", true] 
```

> 请注意没有变量或分号。数组和对象可以一起使用来表示更复杂的数据集合，例如：

```
{
    "books":
              [
                {
                    "title": "Professional JavaScript",
                    "authors": [
                        "Nicholas C. Zakas"
                    ],
                    "edition": 3,
                    "year": 2011
                },
                {
                    "title": "Professional JavaScript",
                    "authors": [
                        "Nicholas C.Zakas"
                    ],
                    "edition": 2,
                    "year": 2009
                },
                {
                    "title": "Professional Ajax",
                    "authors": [
                        "Nicholas C. Zakas",
                        "Jeremy McPeak",
                        "Joe Fawcett"
                    ],
                    "edition": 2,
                    "year": 2008
                }
              ]
} 
```

> 这个数组包含许多代表书籍的对象，每个对象都有几个键，其中一个是“作者”，它是另一个数组。对象和数组通常是 JSON 数据结构的顶级部分（尽管这不是必需的），可用于创建大量数据结构。”

要将 JavaScript 对象序列化（转换）为 JSON 字符串，您可以使用 JSON 对象 stringify() 方法。对于马克莱纳斯回答的例子：

```
var cars = [{
    color: 'gray',
    model: '1',
    nOfDoors: 4
    },
    {
    color: 'yellow',
    model: '2',
    nOfDoors: 4
}]; 
```

汽车现在是一个 JavaScript 对象。要将其转换为 JSON 对象，您可以执行以下操作：

```
var jsonCars = JSON.stringify(cars); 
```

产生：

```
"[{"color":"gray","model":"1","nOfDoors":4},{"color":"yellow","model":"2","nOfDoors":4}]" 
```

相反，将 JSON 对象转换为 JavaScript 对象（这称为解析），您将使用 parse() 方法。如果您需要更多信息，请搜索这些术语......或获取这本书，它有很多示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-07-14T00:06:07.620

另一个例子：

```
[  
[  
    {  
        "@id":1,
        "deviceId":1,
        "typeOfDevice":"1",
        "state":"1",
        "assigned":true
    },
    {  
        "@id":2,
        "deviceId":3,
        "typeOfDevice":"3",
        "state":"Excelent",
        "assigned":true
    },
    {  
        "@id":3,
        "deviceId":4,
        "typeOfDevice":"jÃºuna",
        "state":"Excelent",
        "assigned":true
    },
    {  
        "@id":4,
        "deviceId":5,
        "typeOfDevice":"nffjnff",
        "state":"Regular",
        "assigned":true
    },
    {  
        "@id":5,
        "deviceId":6,
        "typeOfDevice":"44",
        "state":"Excelent",
        "assigned":true
    },
    {  
        "@id":6,
        "deviceId":7,
        "typeOfDevice":"rr",
        "state":"Excelent",
        "assigned":true
    },
    {  
        "@id":7,
        "deviceId":8,
        "typeOfDevice":"j",
        "state":"Excelent",
        "assigned":true
    },
    {  
        "@id":8,
        "deviceId":9,
        "typeOfDevice":"55",
        "state":"Excelent",
        "assigned":true
    },
    {  
        "@id":9,
        "deviceId":10,
        "typeOfDevice":"5",
        "state":"Excelent",
        "assigned":true
    },
    {  
        "@id":10,
        "deviceId":11,
        "typeOfDevice":"5",
        "state":"Excelent",
        "assigned":true
    }
],
1
] 
```

## 读取数组的

```
$.each(data[0], function(i, item) {
         data[0][i].deviceId + data[0][i].typeOfDevice  + data[0][i].state +  data[0][i].assigned 
    }); 
```

* * *

使用[http://www.jsoneditoronline.org/](http://www.jsoneditoronline.org/)更好地理解 JSON 代码

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-25T21:47:23.697

```
var cars = [
    manufacturer: [
        {
            color: 'gray',
            model: '1',
            nOfDoors: 4
        },
        {
            color: 'yellow',
            model: '2',
            nOfDoors: 4
        }
    ]
] 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2018-05-04T11:16:31.453

```
Using the below method pass any value which is an array:

Use:
<dependency>
    <groupId>com.jayway.jsonpath</groupId>
    <artifactId>json-path</artifactId>
    <version>2.5.0</version>
</dependency>

Input parameter: URL, like 
Example: "$node.[any int value of array].anyKeyWhichInArray"
Example: "$.cars.Nissan.[0].model"

    public String getAnyValueFromResponseBody(String jsonBody, String url) {
        String value = "";
        try {
          value = JsonPath.read(jsonBody, url).toString();
          System.out.println(value);
        } catch (Exception var6) {
          System.error.println("unable to parse "+url);
        }
        return value;
      } 
```

# r - R - 由于某种原因，无法合并 CSV

> ID：11197820
> 
> 赞同：2
> 
> 时间：2012-06-25T21:45:18.430
> 
> 标签：r, csv, statistics

```
> imqd = read.csv("csv/quest/IMQ.csv")
> demod = read.csv("csv/DEMO.csv")
> mcqd = read.csv("csv/quest/MCQ.csv")
> 
> length(demod)
[1] 145
> length(demod[[1]])
[1] 9965
> length(mcqd)
[1] 168
> length(mcqd[[1]])
[1] 9493
> length(imqd)
[1] 5
> length(imqd[[1]])
[1] 9965
> 
> mydata = merge(imqd, demod)
> length(mydata)
[1] 148
> length(mydata[[1]])
[1] 9965 
```

到现在为止还挺好。但是，如果我尝试`mcqd`与任何东西合并，我会丢失大部分行，即使数据对我来说看起来不错。

```
> intersect(intersect(names(imqd), names(mcqd)), names(demod))
[1] "X"    "seqn"

> finaldata = merge(mydata, mcqd)
> length(finaldata)
[1] 314
> length(finaldata[[1]])
[1] 18 
```

为什么现在只有 18 行？

如果你想在家一起玩，你可以[在这里获取 csv 文件](https://github.com/skyl/NHANES-opensource/tree/master/1999-2000/csv)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:57:13.710

`merge`试图只返回在每个公共列上匹配的行。查看[MCQ.csv](https://raw.github.com/skyl/NHANES-opensource/master/1999-2000/csv/quest/MCQ.csv)，我们看到第 20 行开始：

```
"19",20,2,NA, 
```

`merge`不会使用这一行。两个公共列，第一列和第二列，对于每个文件都不匹配。`pk`要合并的数据是明确的`seqn`。所以，我们可以简单地使用`by`参数来`merge`：

```
> finaldata = merge(mydata, mcqd, by="seqn") 
```

# wordpress - 更改 wp-admin 文件夹

> ID：11197821
> 
> 赞同：3
> 
> 时间：2012-06-25T21:45:21.897
> 
> 标签：wordpress, security, backend

我正在运行一些 Wordpress 网站，我已经用谷歌搜索了好几次，但无法找到我的问题的具体答案。

我的网站使用登录锁定插件保护，如果该 IP 尝试使用错误的凭据重复登录，该插件会锁定 IP 一段时间。

所以我的问题是我不断收到警报和 IP 尝试登录我的后端的警报。我知道我可以关闭这些通知，但我想正确解决这个问题。

因此，我看到了一些不错的 WP 站点，您可以在其中键入 /wp-admin 并且没有显示任何内容，您会收到 404 或者您被重定向到主页。我还在这里阅读了一个名为隐形登录的插件，但插件不再列在 wordpress 网站上。

我还看到了一些使用 IP 并将文件夹限制为特定 IP 的插件，但是在我的 ISP 上，我有一个动态 IP，所以如果我有一个新 IP，我将无法看到 wp-admin 文件夹。

我想知道是否有标准化或好的方法来解决这个问题并将 wp-admin 目录隐藏起来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T22:24:16.367

*   下面的代码将阻止浏览器访问这些目录中除“abcd”之外的任何文件，您应该将其更改为您的静态 IP 地址。

-

```
order deny,allow
allow from a.b.c.d # This is your static IP
deny from all 
```

*   或使用密码限制目录：

-

```
AuthUserFile /etc/httpd/htpasswd
AuthType Basic
AuthName "restricted"
Order Deny,Allow
Deny from all
Require valid-user
Satisfy any 
```

* * *

*   或者您可以使用 .htaccess 文件来保护它 [http://www.askapache.com/wordpress/htaccess-password-protect.html](http://www.askapache.com/wordpress/htaccess-password-protect.html)

*   要通过 mod_rewrite（处理 URL 重写的 apache 模块）作为 apache URL 布局配置来回答您的问题，这可能会有所帮助：

    > 重写规则 ^admin/(.*)$ /wp-admin/$1 [QSA,L]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T00:10:15.213

我在 wp-admin 文件夹中的 .htaccess 文件中使用以下内容：

```
order deny,allow
allow from 12.34.56.78 # My IP
deny from all 
```

它会给不在该 IP 地址上的任何人一个 404 错误。

我也对 wp-login.php 页面使用相同的方法。把它放在你的根 .htaccess 文件中：

```
<Files "wp-login.php">
Order deny,allow
Deny from all
Allow from 12.34.56.78
</Files> 
```

# cordova - 如何使用 PhoneGap 和 Sencha Touch 2 创建联系人

> ID：11197822
> 
> 赞同：1
> 
> 时间：2012-06-25T21:45:32.970
> 
> 标签：cordova, sencha-touch-2

我正在使用 Sencha Touch 2 和 PhoneGap 构建一个示例应用程序。

最初它只是一个显示一些静态文本的 Sencha Touch 2 应用程序，特别是任何随机人的联系信息。现在，我已将 PhoneGap 集成到项目中，因为我希望能够将该联系信息添加到设备（当前是一个 android 模拟器）。我在这里浏览了代码：

[http://docs.phonegap.com/en/1.0.0/phonegap_contacts_contacts.md.html#Contact](http://docs.phonegap.com/en/1.0.0/phonegap_contacts_contacts.md.html#Contact)

但我无法让它工作。

有没有人有一个例子来说明如何做到这一点。

**TL;DR** - 如何从 Sencha Touch 2 javascript 视图中获取静态联系人信息并将其添加到 Android 模拟器上的联系人列表中？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T23:23:08.800

阅读文档时，版本非常重要。

因此，当您使用 PhoneGap 1.8.1 时，我建议您参考 PhoneGap 1.8.1 的[文档，](http://docs.phonegap.com/en/1.8.1/index.html)而不是 1.0.0 版的文档（您粘贴的链接指向 PhoneGap 1.0.0 的文档）。

如果您仍然无法正常工作，请回来

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T18:13:49.853

我忘了回到这个...

我以本指南为例，说明如何在 Eclipse 中为 Android 使用这两种技术。

[使用 PhoneGap for Android 打包 Sencha Touch 2 应用程序](http://andidog.de/blog/2012/06/packaging-a-sencha-touch-2-application-with-phonegap-for-android/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-17T08:32:37.703

您是否在清单文件中授予了权限（如果您使用的是 Android，或检查其他人的权限）。

查看链接并找到解决方案：

[http://docs.phonegap.com/en/2.3.0/cordova_contacts_contacts.md.html](http://docs.phonegap.com/en/2.3.0/cordova_contacts_contacts.md.html)

下面的代码对我有用。

处理程序：

```
var contact = navigator.contacts.create();
var name = new ContactName();
name.givenName = "John";
name.familyName = "AB Hotel";
contact.name = name;
contact.save(onSuccess, onError);
function onSuccess(contact) {
    alert("Save Success");
};
function onError(contactError) {
    alert("Error = " + contactError.code);
}; 
```

Android 清单文件：

```
<uses-permission android:name="android.permission.READ_CONTACTS" />
<uses-permission android:name="android.permission.WRITE_CONTACTS" />   
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />   
<uses-permission android:name="android.permission.GET_ACCOUNTS" />
<uses-permission android:name="android.permission.BROADCAST_STICKY" /> 
```

# java - Java 对象数组在初始化期间崩溃

> ID：11197825
> 
> 赞同：0
> 
> 时间：2012-06-25T21:45:55.993
> 
> 标签：java, arrays

我有一个对象数组 - 所以本质上是一个对象引用数组。在我引用的类中，还有另一个引用。我需要初始化这个数据结构，但在初始化期间，它崩溃了。我试图在被引用的类中初始化引用，但它始终保持为空，所以有一些我还不理解的 Java“东西”。这看起来如此简单，却又如此令人沮丧。这是问题的一个简化示例：

```
public class ref1
{
    public int myInt;
}
public class ref2
{
    public ref1 myRef;
}
public ref2 buffer[];
int i;

// Code to initialize the above data structures:
buffer = new ref2[255];
for (i=0; i<255; i++)
{
    buffer[i] = new ref2();
    buffer[i].myRef = new ref1();   // (1) ALWAYS returns null????
} 
```

最终，上面的代码将在我有 (1) 标记的行出现“ArrayOutOfBoundsException”崩溃。我在调试器中注意到的第二件事是 myRef 始终设置为 null。为什么我无法创建和引用 ref1 对象？？？？？？

如果我注释掉标有（1）的行，则没有异常陷阱，所以问题就在那里。

感谢任何可以向菜鸟解释这一点的人...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-01-29T04:30:08.583

```
salam package cruft;

/**
 * BadRef description here
 * @author Michael
 * @link
 * @since 6/25/12 5:53 PM
 */
public class BadRef {

    public static void main(String[] args) {
        ref2 buffer[] =  new ref2[255];
        for (int i = 0; i < 255; ++i) {
            buffer[i] = new ref2(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T21:58:46.593

如果您在每次迭代时检查 buffer[i].myRef 的值，那么它每次都会为 null。这是正确的，因为在每次迭代中，buffer[i] 都是一个新的 ref2 实例，其 myRef 字段为空。ref2 实例存储在数组的先前位置。

因此，在调试器中，如果您展开 buffer[] 数组值，您将在当前对象下方的位置看到先前构造的对象。

至于 ArrayOutOfBoundsException ... 我假设您实际上指的是 ArrayIndexOutOfBoundsException （如果不是这种情况，请纠正我）。在这种情况下，边界设置正确。您正在创建一个 255 个位置的数组，并且正确地将其从 0 迭代到 254（**i < 255**部分）。所以，这很好用。请仔细检查代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:55:37.050

这对我来说很好。我不知道你在做什么：

```
package cruft;

/**
 * BadRef description here
 * @author Michael
 * @link
 * @since 6/25/12 5:53 PM
 */
public class BadRef {

    public static void main(String[] args) {
        ref2 buffer[] =  new ref2[255];
        for (int i = 0; i < 255; ++i) {
            buffer[i] = new ref2();
            buffer[i].myRef = new ref1();
            buffer[i].myRef.myInt = i;
            System.out.println(buffer[i]);
        }
    }
}

class ref1 {
    public int myInt;

    @Override
    public String toString() {
        final StringBuilder sb = new StringBuilder();
        sb.append("ref1");
        sb.append("{myInt=").append(myInt);
        sb.append('}');
        return sb.toString();
    }
}

class ref2 {
    public ref1 myRef;

    @Override
    public String toString() {
        final StringBuilder sb = new StringBuilder();
        sb.append("ref2");
        sb.append("{myRef=").append(myRef);
        sb.append('}');
        return sb.toString();
    }
} 
```

# c++ - 条件 if 使用 OR 检查所有条件

> ID：11197826
> 
> 赞同：1
> 
> 时间：2012-06-25T21:46:07.463
> 
> 标签：c++, conditional, conditional-statements, shortest-path

如果有这样的 if 块

```
if(foo() || foo2() || foo3())
{
 //do some things
} 
```

我只需要一个 foo 函数来返回 true 来执行该代码。但我必须给他们所有人打电话。当第一个 foo 返回 true 时，问题就开始了。这样就不会调用其余的 foo（foo2 和 foo3）。

我知道我可以这样做：

```
bool foo1 = foo1();
bool foo2 = foo2();
bool foo3 = foo3();

if(foo1 || foo2 || foo3) {} 
```

但我有 18 个 foo 函数，这是我代码的几个部分。有没有什么诀窍可以做到又短又简单？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-25T21:47:20.740

`||`操作员短路。您可以`|`改用：

```
if (foo1() | foo2() | foo3()) {} 
```

但是您还应该考虑创建一个函数指针数组并在循环中调用它们。

> 这是我代码的几个部分

您应该重构您的代码，以便您可以重用它，而不是在许多地方复制和粘贴相同的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T21:52:48.837

> 我只需要一个 foo 函数来返回 true 来执行该代码。但我必须给他们所有人打电话。当第一个 foo 返回 true 时，问题就开始了。这样就不会调用其余的 foo（foo2 和 foo3）。

好吧，如果您需要调用每个函数，那么您应该调用它们。真的，只需调用它们并存储结果。

> 但我有 18 个 foo 函数，这是我代码的几个部分。有没有什么诀窍可以做到又短又简单？

为什么要在一条`if`语句中调用和测试 18 个函数？必须有更好的方法来解决问题。所以每个功能都有副作用，你需要这些副作用发生，很好，但这听起来已经是个问题了。

我不知道您要解决什么问题，也不知道每个功能的作用，但我很难相信您当前的设置接近最佳。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T21:57:18.507

总结一下函数呢？（仅当函数是独立的并且可以返回正整数或指针时才能正常工作；

```
int resultSum = func1() + func2() + func3();

if(resultSum>0){
 //do things
} 
```

# web-services - System.ServiceModel.EndpointNotFoundException：没有端点监听

> ID：11197829
> 
> 赞同：3
> 
> 时间：2012-06-25T21:46:19.260
> 
> 标签：web-services, tomcat, soap, axis2

System.ServiceModel.EndpointNotFoundException：没有端点监听

```
http://prodserver:8080/FxWebservice/services/FxRateFetcher.FxRateFetcherHttpSoap11Endpoint/ 
```

可以接受该消息。这通常是由不正确的地址或 SOAP 操作引起的。有关更多详细信息，请参阅 InnerException（如果存在）。---> System.Net.WebException：远程服务器返回错误：（404）未找到。

-- 我称这个 web 服务托管在使用 tomcat/axis2 托管的服务器上。

现在，当我在浏览器中打开此链接时

```
http://servername:8080/FxWebservice/services/FxRateFetcher?wsdl 
```

它打开正确，但是当我打开任何 SOAP 链接甚至 http 链接时，它都不会打开。

这会导致代码异常。

在服务器上它确实工作并在axis2基于web的管理器上显示一切正常。

同样来自axis2服务，当我尝试打开EPR链接时，它没有打开。

可能有任何配置或 web xmls 错误吗？

有人可以指出托管此网络服务的问题吗？

# python - 在 Python 中使用 Mechanize 打开 SSL URL

> ID：11197841
> 
> 赞同：2
> 
> 时间：2012-06-25T21:47:33.327
> 
> 标签：python, ssl, mechanize, urllib2

如何使用 mechanize 在 Python 中打开 SSL URL？

我正在尝试在 Ubuntu 上使用 Python 2.7.3 进行简单的页面检索，例如：

```
import mechanize
browser = mechanize.Browser()
resp = browser.open('https://mydomain.com') 
```

但它会引发错误：

```
urllib2.URLError: <urlopen error [Errno 1] _ssl.c:504: error:140773E8:SSL routines:SSL23_GET_SERVER_HELLO:reason(1000)> 
```

奇怪的是，当我在 Fedora 上的 Python 2.6.4 下运行相同的代码时，我没有收到此错误...

据推测，这可能不是 mechanize 的直接问题，而是 urllib2 和底层 SSL C 库的问题。谷歌搜索显示很少点击。有解决方法吗？

编辑：我发现了这个[旧的错误报告](http://bugs.python.org/issue11220)，有一个建议的解决方法（基本上 Python 正在尝试将 SSLv23 用于仅 SSLv3 的站点），但该代码反而导致了错误`httplib.BadStatusLine: ''`

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-06-12T03:11:13.057

此问题可能是由于在 Web 服务器上禁用了 SSLv2，但 Python 2.x 默认尝试与 PROTOCOL_SSLv23 建立连接。这发生在[https://github.com/python/cpython/blob/master/Lib/ssl.py#L867](https://github.com/python/cpython/blob/master/Lib/ssl.py#L867)

您可以通过覆盖 ssl_version 关键字参数在 ssl 模块中对 ssl.wrap_socket() 进行猴子补丁，而不是复制和编辑 Python 库模块。以下代码可以按原样使用。在发出任何请求之前，将其放在程序的开头。

```
import ssl
from functools import wraps
def sslwrap(func):
    @wraps(func)
    def bar(*args, **kw):
        kw['ssl_version'] = ssl.PROTOCOL_TLSv1
        return func(*args, **kw)
    return bar

ssl.wrap_socket = sslwrap(ssl.wrap_socket) 
```

# html - 以 HTML 格式呈现 AppStore 页面

> ID：11197846
> 
> 赞同：-1
> 
> 时间：2012-06-25T21:47:51.460
> 
> 标签：html, app-store, itunes, mac-app-store

我正在寻找一种允许我以 HTML 格式而不是实际视图查看 AppStore 页面的方法：

![在此处输入图像描述](../Images/de858b42c8d4430ebc7ec3c5689436b0.png)

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T09:00:45.403

尽管有可能以某种方式实现，但我怀疑苹果会接受这一点。我找到了一个过去可以工作的[示例](http://www.labnol.org/software/browse-itunes-without-installing-software/6657/)，但现在似乎已关闭。我还找到了一个[PHP 解决方案](http://hactheplanet.com/blog/5)，但我自己没有尝试过。

为什么不直接深度链接到 iTunes 商店或 Apple 网站上的应用程序网站？

# regex - 与 '?' 匹配的正则表达式

> ID：11197850
> 
> 赞同：1
> 
> 时间：2012-06-25T21:48:06.503
> 
> 标签：regex

> **可能重复：**
> [正则表达式问号](https://stackoverflow.com/questions/9623879/regex-question-mark)

我试图弄清楚如何解析括号内但语句中单引号之间的文本。例如，如果我有以下语句：

```
(I have a 'cat', 'hat'); 
```

我希望结果是

```
cat
hat 
```

我设法通过尝试维基百科（[http://en.wikipedia.org/wiki/Regular_expression](http://en.wikipedia.org/wiki/Regular_expression)）中定义的不同元字符来解决这个问题，但是我仍然无法理解它为什么起作用。

我试过这个：`\'(.*)\'`

我对这个正则表达式的理解：我想让单引号之间的字符`'`和这些字符匹配任何单个字符`.`零次或多次`*`。

这导致：

```
cat', 'hat 
```

在玩了一堆正则表达式之后，我终于意外地得到了这个：`\'(.*?)\'`

这导致：

```
cat
hat 
```

为什么这行得通？（特别是我不明白“？”是如何工作的。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:52:18.117

默认情况下，正则表达式是贪婪的。通过使用问号，您将匹配更改为“惰性”模式。这意味着它匹配尽可能少的字符数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T22:03:02.190

正则表达式的默认行为是在字符串中进行**最长可能的**匹配。这被称为“贪婪”。

你是对的，`?`通常只是意味着匹配前面的项目（例如，字符）一次或多次，但这`*?`是一种称为“懒惰星”的特殊情况，它将正则表达式评估器切换到“懒惰”模式。在这种模式下，评估者首先尝试跳过前一个项目（并在没有它的情况下完成匹配），然后“返回”它。

最终结果正是您所观察到的：它将匹配满足搜索条件的较短字符串，而不是（默认），它只会找到最长的匹配项。

此处是测试正则表达式的便捷资源，[此处](http://regexpal.com/)对各种选项（包括惰性星号）进行了很好的[描述](http://www.regular-expressions.info/reference.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T21:57:24.817

这是有效的，因为，

**()**是对你的结果进行分组（这是你想要得到的回报）。

**.** 匹配一切。

*****让匹配出现 0 次或多次。

**?** 是可选的，所以，**ab？**将案例**a**或**ab**。

最后，`(.*?)`将匹配除一次（`?`工作）或 0 次或多次（`*`工作）之外的所有内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T21:50:53.960

当 * 后跟 ? 这使得 * 在惰性模式下匹配。默认情况下，它是贪婪的：尽可能多地吸收匹配的字符。在惰性模式下，它会尽可能早地继续使用模式的其余部分。

一开始就搞错了。现在更正了。

# c# - 如何从 C# 中的属性信息中获取参考

> ID：11197852
> 
> 赞同：2
> 
> 时间：2012-06-25T21:48:22.187
> 
> 标签：c#, c#-4.0, reflection, recursion

我需要递归地遍历我的类中的所有属性，如果属性恰好是一个字符串，我需要做一些自定义逻辑。请告知我需要在递归行中添加的内容。

```
void ProcessAllStrings<T>(ref T objToRip)
{
    BindingFlags flags = BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic;
    Type typeParameterType = typeof (T);

    foreach (PropertyInfo p in typeParameterType.GetProperties(flags))
    {
        Type currentNodeType = p.PropertyType;
        if (currentNodeType == typeof (String))
        {
            //here I do my custom string handling. Code deleted
        }
            //if non primitive and non string then recurse. (nested/inner class instances)
            // see http://stackoverflow.com/questions/4444908/detecting-native-objects-with-reflection
        else if (currentNodeType != typeof (object) && Type.GetTypeCode(currentNodeType) == TypeCode.Object)
        {
            //I need to get the reference to this property which happens to be a nested class
            //but propertyInfo only provides GetValue(). No GetReference available..
            ProcessAllStrings(ref "dont know what to put here");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:59:59.473

如果它是引用类型，那么我相信该值*是*引用。要递归，只需将属性值传回函数：

```
 else if (currentNodeType != typeof (object) && Type.GetTypeCode(currentNodeType) == TypeCode.Object)
            {
                object propVal = p.GetValue(objToRip,null);

                if(propVal != null) ProcessAllStrings(ref propVal);
            } 
```

我还建议为索引属性添加一个处理程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T22:00:23.643

基本上是我在评论中所说的以及 Mangist 所说的。这是一个还检查嵌套类型引用上的无限循环的实现：

```
private void ProcessAllStrings(Type objectType, HashSet<Type> typesChecked)
{
    if (typesChecked == null)
        typesChecked = new HashSet<Type>();

    if (typesChecked.Contains(objectType))
        return;

    typesChecked.Add(objectType);

    BindingFlags flags = BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic;

    foreach (PropertyInfo p in objectType.GetProperties(flags))
    {
        Type currentNodeType = p.PropertyType;
        if (currentNodeType == typeof (String))
        {
            //here I do my custom string handling. Code deleted
            Console.WriteLine("Found String Property: " + currentNodeType.FullName + " -> " + p.Name);
        }
            //if non primitive and non string then recurse. (nested/inner class instances)
            // see http://stackoverflow.com/questions/4444908/detecting-native-objects-with-reflection
        else if (currentNodeType != typeof (object) && Type.GetTypeCode(currentNodeType) == TypeCode.Object)
        {
            //I need to get the reference to this property which happens to be a nested class
            //but propertyInfo only provides GetValue(). No GetReference available..
            ProcessAllStrings(currentNodeType, typesChecked);
        }
    }
} 
```

所以，说像这样的类，注意`Foo`有 a`Bar`也指向`Foo`，所以我们可以测试它不会无限循环：

```
public class Foo
{
    public string Prop1 { get; set; }
    public Bar Prop2 { get; set; }
}

public class Bar
{
    public string BarProp { get; set; }
    public Foo NestedFoo { get; set; }
} 
```

你可以这样称呼它：

```
ProcessAllStrings(typeof(Foo), null); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:52:25.303

您的方法需要一个对象引用，因此您需要创建所有这些嵌套类的实例才能使递归工作。您真正想要的是传递类型信息。

`Type typeParameterType`用作参数，而不是 objToRip 。

然后你可以调用`ProcessAllStrings(currentNodeType );`做递归

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T22:12:59.160

您可以使用动态类型而不是泛型类型：

```
public static void ProcessAllStrings(dynamic objToRip)
{
    if (objToRip == null) return;
    BindingFlags flags = BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic;
    Type typeParameterType = objToRip.GetType();

    foreach (PropertyInfo p in typeParameterType.GetProperties(flags))
    {
        Type currentNodeType = p.PropertyType;
        if (currentNodeType == typeof(String))
        {
            //here I do my custom string handling. Code deleted
        }
        else if (currentNodeType != typeof(object) && Type.GetTypeCode(currentNodeType) == TypeCode.Object)
        {
            ProcessAllStrings(p.GetValue(objToRip, null));
        }
    }
} 
```

# iphone - iPhone在UITextField touch上显示日期选择器

> ID：11197855
> 
> 赞同：28
> 
> 时间：2012-06-25T21:48:29.600
> 
> 标签：iphone, datepicker, uitextfield, protocols

我关注了这个线程：[datepicker by click on textfield](https://stackoverflow.com/questions/7308754/datepicker-by-clicking-on-textfield)

我导入了以下两个协议：

```
@interface ViewController : UIViewController<UIActionSheetDelegate, UITextFieldDelegate> { 
```

然后，在实现中，我使用以下内容：

```
- (void)viewDidLoad {

    textField.delegate = self;

[super viewDidLoad] } 
```

最后，我将实际代码用于显示日期选择器（来自线程）。我还在 IB 中将其全部链接起来。

```
 //Date Picker
- (void)textFieldDidBeginEditing:(UITextField *)aTextField{    
    [aTextField resignFirstResponder];  

    pickerViewPopup = [[UIActionSheet alloc] initWithTitle:nil delegate:self cancelButtonTitle:nil destructiveButtonTitle:nil otherButtonTitles:nil];  

    UIDatePicker *pickerView = [[UIDatePicker alloc] initWithFrame:CGRectMake(0, 44, 0, 0)];  
    pickerView.datePickerMode = UIDatePickerModeDate;  
    pickerView.hidden = NO;  
    pickerView.date = [NSDate date];  

    UIToolbar *pickerToolbar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 0, 320, 44)];  
    pickerToolbar.barStyle = UIBarStyleBlackOpaque;  
    [pickerToolbar sizeToFit];  

    NSMutableArray *barItems = [[NSMutableArray alloc] init];  

    UIBarButtonItem *flexSpace = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:self action:nil];  
    [barItems addObject:flexSpace];  

    UIBarButtonItem *doneBtn = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(doneButtonPressed:)];  
    [barItems addObject:doneBtn];  

    UIBarButtonItem *cancelBtn = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemCancel target:self action:@selector(cancelButtonPressed:)];  
    [barItems addObject:cancelBtn];  

    [pickerToolbar setItems:barItems animated:YES];  

    [pickerViewPopup addSubview:pickerToolbar];  
    [pickerViewPopup addSubview:pickerView];  
    [pickerViewPopup showInView:self.view];  
    [pickerViewPopup setBounds:CGRectMake(0,0,320, 464)];    
}  

-(void)doneButtonPressed:(id)sender{  
    //Do something here here with the value selected using [pickerView date] to get that value  
        [pickerViewPopup dismissWithClickedButtonIndex:1 animated:YES];  
}  

-(void)cancelButtonPressed:(id)sender{  
    [pickerViewPopup dismissWithClickedButtonIndex:1 animated:YES];  
} 
```

但是，当我单击 UITextField 时，我得到了这个：

![在此处输入图像描述](../Images/dc15b6ce831c32240b8c8b1050b034ed.png)

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-06-25T22:48:48.140

您可以使用`UITextField`输入视图属性。只需在代码中分配 init 一个常规`UIDatePicker`并将其分配给文本字段的 inputView。执行此操作时，`UIPickerView`将显示 而不是键盘。如果您需要任何代码，请随时询问:)

编辑：代码

你`textField`用 IB把你的拳头勾起来

```
@interface myViewController <UITextFieldDelegate>
@property (nonatomic,weak) IBOutlet UITextField *myTextField;
@end 
```

在实施中

```
UIDatePicker *datePicker = [[UIDatePicker alloc]init];
[datePicker setDate:[NSDate date]];
[datePicker addTarget:self action:@selector(updateTextField:) forControlEvents:UIControlEventValueChanged];
if (@available(iOS 13.4, *)) {
    [datePicker setPreferredDatePickerStyle:UIDatePickerStyleWheels];
}       
[self.myTextField setInputView:datePicker]; 
```

`UIDatePicker`当您点击 时会弹出一个`textField`。请注意我添加到 datePicker 的操作。

```
[datePicker addTarget:self action:@selector(updateTextField:) forControlEvents:UIControlEventValueChanged]; 
```

要在每次用户在选择器中滚动时更新 textField，您只需`updateTextField`在`viewController`

```
-(void)updateTextField:(id)sender
{
  UIDatePicker *picker = (UIDatePicker*)self.myTextField.inputView;
  self.myTextField.text = [NSString stringWithFormat:@"%@",picker.date];
} 
```

使用最后一种方法，每次用户旋转选择器时，文本字段都会更新！

*   您可以使用 a`NSDateFormatter`来改善字符串的输出。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-06-19T15:21:06.660

下面是我如何显示日期选择器。

```
- (void)textFieldDidBeginEditing:(UITextField *)textField
{

    self.activeTextField = textField;

    // Create a date picker for the date field.
    UIDatePicker *datePicker = [[UIDatePicker alloc]init];
    datePicker.datePickerMode = UIDatePickerModeDate;
    datePicker.minimumDate = [NSDate dateWithTimeIntervalSinceNow:-31536000];
    [datePicker setDate:[NSDate date]];
    [datePicker addTarget:self action:@selector(updateDateField:) forControlEvents:UIControlEventValueChanged];

    // If the date field has focus, display a date picker instead of keyboard.
    // Set the text to the date currently displayed by the picker.
    if (textField.tag == 1)
    {
    self.date.inputView = datePicker;
    self.date.text = [self formatDate:datePicker.date];
    }   
}

// Called when the date picker changes.
- (void)updateDateField:(id)sender
{
    UIDatePicker *picker = (UIDatePicker*)self.date.inputView;
    self.date.text = [self formatDate:picker.date];
}

// Formats the date chosen with the date picker.
- (NSString *)formatDate:(NSDate *)date
{
    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
    [dateFormatter setDateStyle:NSDateFormatterShortStyle];
    [dateFormatter setDateFormat:@"MM'/'dd'/'yyyy"];
    NSString *formattedDate = [dateFormatter stringFromDate:date];
    return formattedDate;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-05-13T15:06:40.357

这是我在 Swift 4 中所做的：

```
let datePicker = UIDatePicker()
@IBOutlet weak var myTextField: UITextField!

override func viewDidLoad() {
    super.viewDidLoad()
    setDatePicker()
}

func setDatePicker() {
    //Format Date
    datePicker.datePickerMode = .date

    //ToolBar
    let toolbar = UIToolbar();
    toolbar.sizeToFit()
    let doneButton = UIBarButtonItem(title: "Done", style: .plain, target: self, action: #selector(doneDatePicker));
    let spaceButton = UIBarButtonItem(barButtonSystemItem: UIBarButtonItem.SystemItem.flexibleSpace, target: nil, action: nil)
    let cancelButton = UIBarButtonItem(title: "Cancel", style: .plain, target: self, action: #selector(cancelDatePicker));

    toolbar.setItems([doneButton,spaceButton,cancelButton], animated: false)

    myTextField.inputAccessoryView = toolbar
    myTextField.inputView = datePicker
}

@objc func doneDatePicker(){
    let formatter = DateFormatter()
    formatter.dateFormat = "MM/dd/yyyy"
    myTextField.text = formatter.string(from: datePicker.date)
    self.view.endEditing(true)
}

@objc func cancelDatePicker(){
    self.view.endEditing(true)
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-04-07T04:13:38.717

Swift 4.2
你可以通过使用 UITextField Extension 编写一行代码来实现这一点。
**信用：** [http ://www.swiftdevcenter.com/](http://www.swiftdevcenter.com/)

```
 import UIKit

extension UITextField {

    func setInputViewDatePicker(target: Any, selector: Selector) {
        // Create a UIDatePicker object and assign to inputView
        let screenWidth = UIScreen.main.bounds.width
        let datePicker = UIDatePicker(frame: CGRect(x: 0, y: 0, width: screenWidth, height: 216))//1
        datePicker.datePickerMode = .date //2
        self.inputView = datePicker //3

        // Create a toolbar and assign it to inputAccessoryView
        let toolBar = UIToolbar(frame: CGRect(x: 0.0, y: 0.0, width: screenWidth, height: 44.0)) //4
        let flexible = UIBarButtonItem(barButtonSystemItem: .flexibleSpace, target: nil, action: nil) //5
        let cancel = UIBarButtonItem(title: "Cancel", style: .plain, target: nil, action: #selector(tapCancel)) // 6
        let barButton = UIBarButtonItem(title: "Done", style: .plain, target: target, action: selector) //7
        toolBar.setItems([cancel, flexible, barButton], animated: false) //8
        self.inputAccessoryView = toolBar //9

    }

    @objc func tapCancel() {
        self.resignFirstResponder()
    }

} 
```

在您的 UIViewController 类中编写以下代码。

```
 class ViewController: UIViewController {

    @IBOutlet weak var myTextField: UITextField!

    override func viewDidLoad() {
        super.viewDidLoad()
        // Do any additional setup after loading the view, typically from a nib.
        self.myTextField.setInputViewDatePicker(target: self, selector: #selector(tapDone(sender:datePicker1:))) //1
    }

    //2
    @objc func tapDone(sender: Any, datePicker1: UIDatePicker) {
        print(datePicker1)
        if let datePicker = self.myTextField.inputView as? UIDatePicker { // 2.1
            let dateformatter = DateFormatter() // 2.2
            dateformatter.dateStyle = .medium // 2.3
            self.myTextField.text = dateformatter.string(from: datePicker.date) //2.4
        }
        self.myTextField.resignFirstResponder() // 2.5
    }

} 
```

**有关更多详细信息，请访问：** [http ://www.swiftdevcenter.com/uidatepicker-as-input-view-to-uitextfield-swift/](http://www.swiftdevcenter.com/uidatepicker-as-input-view-to-uitextfield-swift/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-05-29T14:02:31.337

@JRo 解决方案效果很好！

这是我在 Swift 3 中更新的代码：

```
func textFieldDidBeginEditing(_ textField: UITextField) {
    self.activeTextField = textField

    // Create a date picker for the date field.
    let picker = UIDatePicker()
    picker.datePickerMode = .date
    picker.addTarget(self, action: #selector(updateDateField(sender:)), for: .valueChanged)

    // If the date field has focus, display a date picker instead of keyboard.
    // Set the text to the date currently displayed by the picker.
    textField.inputView = picker
    textField.text = formatDateForDisplay(date: picker.date)
}

// Called when the date picker changes.

func updateDateField(sender: UIDatePicker) {
    activeTextField?.text = formatDateForDisplay(date: sender.date)
}

// Formats the date chosen with the date picker.

fileprivate func formatDateForDisplay(date: Date) -> String {
    let formatter = DateFormatter()
    formatter.dateFormat = "dd MMM yyyy"
    return formatter.string(from: date)
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-05T17:49:22.380

一个很好的方法是创建你自己的类（我称之为它`TextFieldFormDate`），它派生自`UITextField`并封装了所有必需的行为。然后，在您的故事板中，您将文本字段的类设置为`TextFieldFormDate`（在我的情况下）。

在您的 ViewController 中使用`didChange`and `didSelect`（即使用`TextFieldFormDate`）来通知更改以及实际选择日期的时间。

```
class TextFieldFormDate: UITextField {

    var date : Date {
        set {
           picker.date = newValue
           text = newValue.localizedDateOnly()
        }

        get {
            return picker.date
        }
    }

    //public handlers
    var didChange : ( (Date)->() )?
    var didSelect : ( (Date)->() )?

    private var picker : UIDatePicker {
        return inputView as! UIDatePicker
    }

    override func awakeFromNib() {
        super.awakeFromNib()
        setup()
    }

    private func setup() {
        font = UIFont.defaultFont()
        //picker for datefield
        inputView = UIDatePicker(frame: CGRect(x: 0, y: 0, width: 0, height: 0))
        picker.datePickerMode = .date
        picker.addTarget(self, action: #selector(pickerChanged), for: .valueChanged)
        let toolBar = UIToolbar()
        toolBar.tintColor = PaintCode.mainBlue
        toolBar.items = [
            UIBarButtonItem(barButtonSystemItem: .flexibleSpace, target: nil, action: nil),
            BarBtnPaintCode(type: "done", target: self, action: #selector(didPressDone))
        ]
        toolBar.sizeToFit()
        inputAccessoryView = toolBar
    }

    @objc private func pickerChanged() {
        text = date.localizedDateOnly()
        didChange?(picker.date)
    }

    @objc private func didPressDone() {
        text = date.localizedDateOnly()
        resignFirstResponder()
        didSelect?(picker.date)
    }

} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-09T10:21:30.933

请在 .h 文件中为 UIDatePicker 创建对象

```
UIDatePicker *datePicker; 
```

在 .m 文件中查看DidloadMethod

```
datePicker = [[UIDatePicker alloc]init];
datePicker.datePickerMode = UIDatePickerModeDate;
datePicker.minimumDate = [NSDate date];
[_dateTxtFld setInputView:datePicker];
UIToolbar *toolBar=[[UIToolbar alloc]initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, 44)];
[toolBar setTintColor:[UIColor grayColor]];
UIBarButtonItem *doneBtn=[[UIBarButtonItem alloc]initWithTitle:@"Done" style:UIBarButtonItemStylePlain target:self action:@selector(showSelectedDate)];
UIBarButtonItem *space=[[UIBarButtonItem alloc]initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];
[toolBar setItems:[NSArray arrayWithObjects:space,doneBtn, nil]];

[_dateTxtFld setInputAccessoryView:toolBar]; 
```

之后，您可以创建 ShowSele

```
-(void)showSelectedDate {
    if ([_dateTxtFld isFirstResponder]) {
        NSDateFormatter *formatter=[[NSDateFormatter alloc]init];
        [formatter setDateFormat:@"YYYY-MM-dd"];
        _dateTxtFld.text=[NSString stringWithFormat:@"%@",[formatter stringFromDate:datePicker.date]];
       [_dateTxtFld resignFirstResponder];
    }
   else if ([_timeTxtFld isFirstResponder]) {
   }
} 
```

它对我有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-02-06T08:14:42.760

**将日期选择器添加到 UITextField 作为输入视图 - Swift 代码。希望对大家有所帮助。:)**

```
func addTimePickerToTimeTextFieldView() {

    timePicker = UIDatePicker()
    timePicker?.datePickerMode = .time
    timeTextField.inputView = timePicker

    timePicker?.backgroundColor = #colorLiteral(red: 1, green: 1, blue: 1, alpha: 1)
    timePicker?.setValue(#colorLiteral(red: 0.03921568627, green: 0.2352941176, blue: 0.3647058824, alpha: 1), forKeyPath: "textColor")

    timePicker?.addTarget(self, action: #selector(timeSelectedByUser(_:)), for: .valueChanged)

    let tapGesture = UITapGestureRecognizer(target: self, action: #selector(viewTapped(_:)))
    view.addGestureRecognizer(tapGesture)

}

@objc func timeSelectedByUser(_ sender: UIDatePicker) {

    let formatter = DateFormatter()
    formatter.timeStyle = .short
    timeTextField.text = formatter.string(from: sender.date)

    //Convert Time for API - 24 hours format
    apiFormatter.dateFormat = "HH:mm"
    timeForApi = apiFormatter.string(from: sender.date)

} 
```

# mysql - 估计 SQL 查询时间

> ID：11197856
> 
> 赞同：-1
> 
> 时间：2012-06-25T21:49:00.830
> 
> 标签：mysql, timing

如果

```
SELECT attr FROM t WHERE attr2>=0 LIMIT 10000; 
```

耗时约 0.26 秒。多少时间（非常粗略）

```
SELECT attr FROM t WHERE attr2>700; 
```

带跑？

```
mysql> EXPLAIN SELECT attr FROM t WHERE attr2>700;
+----+-------------+---------------+------+---------------+------+---------+------+--------+-------------+
| id | select_type | table         | type | possible_keys | key  | key_len | ref  | rows   | Extra       |
+----+-------------+---------------+------+---------------+------+---------+------+--------+-------------+
|  1 | SIMPLE      |      t        | ALL  | NULL          | NULL | NULL    | NULL | 769111 | Using where | 
+----+-------------+---------------+------+---------------+------+---------+------+--------+-------------+ 
```

### 编辑：更多信息，（以防万一）

我最近更新了表中大约 5000 行中的 1 或 2 个属性。

当我跑步`SELECT attr FROM t WHERE attr2>700;`时，它在我中止之前的 20 分钟内没有完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:51:59.913

让我们试试数学；）

10.000 行 => 0.26 秒

769.111 行 => (769.111 * 0.26 / 10.000) =>**大约 20秒**

但这是纯粹的理论估计。

维基百科[交叉乘法](http://en.wikipedia.org/wiki/Cross-multiplication)

# c# - 如何将天重叠成一个“天”

> ID：11197862
> 
> 赞同：0
> 
> 时间：2012-06-25T21:49:31.563
> 
> 标签：c#, mysql, timestamp

可以，然后呢。我有一个包含一列时间戳的数据库。“一天”的开始时间是早上 7 点。因此，假设今天，它将在 2012 年 6 月 25 日的 0700 开始，并在 2012 年 6 月 26 日的 0700 结束。我需要在 24 小时内进行计算。现在，我正在考虑做一个查询，从 0700 + 24 小时开始获取所有信息，但我不是 100% 知道如何表达所述查询。感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T22:01:58.290

警告 - 从我的脑海中完成的代码，没有 Visual Studio，也没有适当的错误处理，但这应该向您展示如何使用参数化查询正确设置必要的参数值。这可能包含语法错误，但同样，它应该足以让您继续前进。我添加了注释来解释相关代码。

```
private System.Data.DataTable ExecuteSql(DateTime BusinessDate)
{

    System.Data.DataTable ReturnValue = new System.Data.DataTable;
    string sql = "Select * From myTable WHERE TimestampColumn >= @StartDate AND TimestampColumn < @EndDate";
    System.Data.OleDb.OleDbCommand cmd = new System.Data.OleDb.OleDb.Command(connectionString, sql);

    // For start date, we can't assume the user has passed in a date with a 
    // midnight time, so first, use DateTime.Date to get JUST the date at midnight, 
    // then add 7 hours to get to the desired start time.
    // For example, if the calling code had passed in 1/1/2001 8:00 AM we would use
    // the .Date property to get it to 1/1/2001 12:00 AM
    // and then add 7 hours.

    cmd.Parameters.Add(@StartDate, BusinessDate.Date.AddHours(7));

    // The end date - same logic, but instead of adding 7 hours, add 31 
    // (24 hours + 7 hours = 31 hours)

    cmd.Parameters.Add(@EndDate, BusinessDate.Date.AddHours(31));  // 24 + 7
    System.Data.OleDb.OleDbDataAdapter ad = new System.Data.OleDb.OleDbDataAdapter(cmd);
    ad.Fill(ReturnValue)    

    return ReturnValue;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T22:03:18.120

```
SELECT * FROM myTable WHERE timestamp >= 'start' AND timestamp < 'end' 
```

请注意，结束被排除在外，否则您将在以下查询中再次查询它作为第二天的开始。

`BETWEEN AND`算子包括左算子和右算子。如果时间戳恰好在`0700`您必须决定是属于上一个时期还是新时期。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-25T21:51:33.010

```
SELECT 
your_needed_columns 
FROM 
your_table 
WHERE 
your_timestamp_column BETWEEN 'start_timestamp' AND 'end_timestamp' 
```

这将是使用 BETWEEN 语句的示例，该语句将服务于完成您正在尝试的内容。

根据 Ollie 的评论，BETWEEN 是包容性的，所以我的语法是基于有意包含在结果中的结束时间。正如其他人所说，如果您希望包含开头但排除结尾，那么您必须使用`>=`and`<`

```
SELECT 
your_needed_columns 
FROM 
your_table 
WHERE 
your_timestamp_column >= 'start_timestamp' AND your_timestamp_column < 'end_timestamp' 
```

# ajax - 在 Django 中使用 celery 和 ajax 动态更新网页

> ID：11197870
> 
> 赞同：2
> 
> 时间：2012-06-25T21:50:27.583
> 
> 标签：ajax, django, celery

我需要向用户显示一些分析；但是，有时这些分析可能需要一段时间才能完成（有时需要 2-5 秒）。而不是等待这些结果，我想我想在网页上以动态的方式更新它们。

我已经以有限的方式实现了 celery，但我想做的是向 celery 发送一些任务，让屏幕渲染，一旦功能完成，将返回值发送到网页到 udpated。

创建任务后，我应该监控它的状态，还是完成后我可以直接将 json 发送到网页？一些代码示例会有所帮助。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T00:13:56.710

django 很难“推送”数据。它本身不受支持，并且解决方案充其量只是hacky。

有更简单的选项，最流行的是 ajax 轮询。

1.  用户可以发起进行分析的请求。

2.  django 将进程排队并将其标记为存储中的处理

3.  用户每隔 x 秒进行一次 ajax 调用，请求请求的状态。

4.  当请求完成时，存储被更新以反映这一点，下一个轮询请求可以检索适当的数据。

HTML5 原生支持基于套接字的通信。但 django 不支持它。

[Django 向用户推送 HTTP 响应](https://stackoverflow.com/questions/5479741/django-push-http-response-to-users)

# java - 快速擦除（不清除）Java 中的 ByteBuffer

> ID：11197875
> 
> 赞同：15
> 
> 时间：2012-06-25T21:51:07.587
> 
> 标签：java, bytebuffer, erase

我正在尝试将 a “清理”`ByteBuffer`为全零字节（全部`0x00`）。我试图遍历缓冲区中的所有位置并将它们设置为`0x00`，但效率很差。有没有更好的方法来快速清除a `ByteBuffer`- 类似于什么`BitSet.clear()`？

请注意，`ByteBuffer.clear()`在这种情况下，这对我来说不是一个合适的解决方案——我必须擦除缓冲区内的所有数据，而不仅仅是将指针重置到开头。

有什么提示吗？

编辑： ByteBuffer 用作哈希表的一部分，它维护哈希表条目的引用。每次需要刷新哈希表时，我都必须重置哈希表条目以供以后插入哈希表。由于哈希表是以随机方式访问的，因此我不能简单地 clear() 字节缓冲区的状态。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-25T21:52:56.363

您是否尝试过使用其中一种`ByteBuffer.put(byte[])`或`ByteBuffer.put(ByteBuffer)`方法一次写入多个零？然后，您可以使用预先填充零的数组或缓冲区，以 100 或 1000 字节的块或其他任何内容对缓冲区进行迭代。

缺点：这是一个可选操作，因此并非 ByteBuffer 的所有实现都需要提供它...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-25T23:19:03.237

对于`ByteBuffer`提供可选`array()`方法（其中`hasArray()`返回`true`）的实现，您可以使用此方法获取对底层数组的引用，然后使用`java.util.Arrays#fill()`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-30T07:02:23.493

如果`ByteBuffer`在刷新哈希表后需要一个新的干净的零填充，最简单的方法是删除现有的`ByteBuffer`并分配一个新的。官方文档没有这么说，但是所有已知的实现都将新缓冲区的内存归零。有关更多信息，请参见[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6535542](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6535542)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-03-12T22:16:08.103

正如 DNA 所提到的，预先填充缓冲液并使用`ByteBuffer.put(ByteBuffer)`可能是最快的便携方式。如果这不切实际，您可以做这样的事情来利用其中一个`Arrays.fill`或`Unsafe.putLong`在适用时：

```
public static void fill(ByteBuffer buf, byte b) {
    if (buf.hasArray()) {
        final int offset = buf.arrayOffset();
        Arrays.fill(buf.array(), offset + buf.position(), offset + buf.limit(), b);
        buf.position(buf.limit());
    } else {
        int remaining = buf.remaining();
        if (UNALIGNED_ACCESS) {
            final int i = (b << 24) | (b << 16) | (b << 8) | b;
            final long l = ((long) i << 32) | i;
            while (remaining >= 8) {
                buf.putLong(l);
                remaining -= 8;
            }
        }
        while (remaining-- > 0) {
            buf.put(b);
        }
    }
} 
```

设置`UNALIGNED_ACCESS`需要对您的 JRE 实现和平台有所了解。下面是我在使用 JNA 时为 Oracle JRE 设置它的方法（它提供`Platform.ARCH`了一种方便、规范的方式来访问`os.arch`系统属性）。

```
/**
 * Indicates whether the ByteBuffer implementation likely supports unaligned
 * access of multi-byte values on the current platform.
 */
private static final boolean UNALIGNED_ACCESS = Platform.ARCH.startsWith("x86"); 
```

# r - 命名向量的属性变量名称

> ID：11197878
> 
> 赞同：6
> 
> 时间：2012-06-25T21:51:27.630
> 
> 标签：r

我有一个字符串和一个数字

```
cID = 'x1'
num = 1 
```

我想创建一个命名向量

```
nvec = c(x1 = num) 
```

但是当我执行以下操作时，R 解释`cID`为`'cID'`而不是`'x1'`.

```
nvec = c(cID = num) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-25T21:56:53.653

对于单线解决方案，请使用`setNames()`：

```
nvec <- setNames(num, cID)
nvec
# x1 
# 1 
```

有关为`setName()`棘手问题提供简洁优雅的解决方案的示例，请参阅@hadley[对此问题](https://stackoverflow.com/questions/8448757/how-to-use-a-character-as-attribute-of-a-function)的回答。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-25T21:57:13.437

尝试使用“[”

```
> nvec <- numeric(0)
> nvec[cID] <- num
> nvec
x1 
 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T22:01:34.287

我不确定这是你要求的，但无论如何

```
assign(cID, num) 
```

意思是

```
5 - x1 
```

给

```
[1] 4 
```

# javascript - 仅在启用 javascript 时如何链接外部样式表

> ID：11197881
> 
> 赞同：2
> 
> 时间：2012-06-25T21:51:46.333
> 
> 标签：javascript, html, css, noscript

我有一个页面，我希望根据是否启用 javascript 来设置不同的样式。

代码：

```
<link rel="stylesheet" href="./css/main.css" type="text/css" />

<noscript>
    <link rel="stylesheet" href="./css/noscript.css" type="text/css" />
</noscript> 
```

我的问题是 noscript.css 只覆盖了一些属性，而不是全部。因此，由于 main.css 中包含更多样式，因此它也适用。只有被覆盖的样式看起来不错。如果我删除指向 main.css 的链接，页面看起来就像我想要的那样。

有没有办法将所有以前的样式“重置”为默认样式，或者在 noscript 上禁用指向 main.css 的链接？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-25T21:56:10.743

你可以这样做：

```
<script>
  document.write('<link rel="stylesheet" href="./css/main.css" type="text/css" />');
</script>
<noscript>
    <link rel="stylesheet" href="./css/noscript.css" type="text/css" />
</noscript> 
```

我通常不是 . 的忠实粉丝`document.write()`，但这是一个例子，说明它是最简单的事情。您当然可以创建`<link>`标签并将其附加到`<head>`或者如果它太令人反感的话。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-04-30T15:11:26.500

如果有人遇到这个老问题，我发现的最好方法（不需要 JS）是：

```
<noscript>
<!--
</noscript>
<link rel="stylesheet" href="./css/main.css" type="text/css" />
<noscript>
-->
</noscript> 
```

所以如果你有 JS，浏览器会看到

```
<link rel="stylesheet" href="./css/main.css" type="text/css" /> 
```

没有JS，浏览器会看到

```
<!--
<link rel="stylesheet" href="./css/main.css" type="text/css" />
--> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T22:19:19.360

```
var css = document.createElement('link');
css.rel = 'stylesheet';
css.type = 'etxt/css';
css.href = './css/main.css';
document.head.appendChild(css); 
```

# c++ - 代码块编译但不运行可执行文件

> ID：11197892
> 
> 赞同：0
> 
> 时间：2012-06-25T21:52:50.980
> 
> 标签：c++, codeblocks

我用 mingw32 编译器安装了一个新的 Codeblocks。使用默认的 hello world 内容创建了新的 c++ 控制台项目，然后按 F9（构建并运行）。编译没有问题，但不运行可执行文件。我在工具下创建了新条目...

[![](../Images/99e62eb7bac9695f3c4e45fd499d7c6e.png)](https://i.stack.imgur.com/EanSX.png)

...当我从工具菜单中执行它时，它会打开 cb_console_runner 并且一切都很好。那么如何配置 Codeblocks 以在构建后运行我的自定义工具条目（当我按下 F9 时）？

有趣的是，我已经设法做到了，但我完全忘记了如何做到这一点，现在我无法找到链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T04:29:51.040

花了一些时间，但我想出了一个解决方法。Codeblocks 在 Compile & run (F9) 后没有执行我的程序的原因是因为我的项目编译器和 IDE 的默认编译器不匹配。我用的是 Mingw32 TDM，默认是 VC2005/2008。将前者设置为默认值时，它开始工作没有问题:)

[![](../Images/2852c8f2e8defed4292b6cca3878d283.png)](https://i.stack.imgur.com/wEBpc.png)

因此，当您有 2 个具有不同编译器的项目并并行开发它们时，它会很快变得乏味。它可能应该为此使用项目设置，而不是 IDE 的默认设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-14T12:36:25.773

在这里为偶尔需要它的 linux 用户提供另一种可能的解决方案：

您的系统上可能未安装默认终端设置。安装 xterm 或更改代码块上的设置以使用您喜欢的任何内容（例如 KDE 上的 Konsole）。

# php - 在 Wordpress 中未检测到 Cookie

> ID：11197893
> 
> 赞同：1
> 
> 时间：2012-06-25T21:52:53.087
> 
> 标签：php, wordpress, mobile, detect

我正在使用[此页面](http://www.squidoo.com/php-mobile-redirect)中的技术设置一个简单的移动/桌面重定向。我还在移动网站上设置了一个 cookie，这样如果用户想要链接回桌面网站，就会读取该 cookie，并且**不会**发生重定向。我正在处理 Wordpress 网站，虽然重定向**确实**有效，但 cookie**无法**正常工作。这是正在发生的事情：

*   移动重定向**确实**有效
*   cookie**设置成功**（用WP外的测试页面确认）
*   当用户点击回到桌面站点时，cookie**不会**被看到，并且用户会再次转储回移动站点。

我使用 2 个外部静态页面测试了我的代码，一切正常 100%。只是当我在 Wordpress 中使用相同的确切代码时不会。这是我在每个站点上的 header.php 文件中的代码：

**桌面网站**

```
<?php
    include('Mobile_Detect.php');
    $detect = new Mobile_Detect();
    if ( $detect->isMobile() && isset($_COOKIE["mobile"]) ) {
         $detect = "false";
    }
    else if ( $detect->isMobile() ) {
         header("Location:http://m.example.com");
    }
?> 
```

**移动网站**

```
<?php setcookie('mobile','m', time()+3600, '/','.example.com'); ?> 
```

PHP 代码是文件中的**第一**部分，在任何 HTML 之前，并且之前或之后没有错误的空格。我已经通过回显一些文本来测试这段代码，并且脚本**在**那里并且做它应该做的事情。这只是没有看到 cookie 并停止重定向到移动站点的问题之一。

几个小时后，我需要一些帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T22:06:28.757

如果您在同一页面上设置 cookie，请将 cookie 值分配给变量。IE：

```
$cookievalue = "m";
setcookie("mobile",$cookievalue); 
```

然后，在页面后面，您可以执行以下操作：

```
if ( $detect->isMobile() && $cookievalue == "m" ) {
      $detect = "false";
}
else if ( $detect->isMobile() ) {
     header("Location:http://m.example.com");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T22:06:38.127

您的代码看起来不错 - 除非您的 Mobile_Detect 有任何问题，但我看不出您是如何考虑设置 cookie 的。

我会冒险猜测您可能正在查看移动浏览器的问题，或者可能是隐私设置。不要仅仅设置一个标准的cookie，而是尝试使用一个会话——无论如何，这几乎可以为你完成所有的cookie工作。

只需使用（在代码的最开始，没有 html 等，就像使用标准 cookie 一样）；

```
Session_start();
if ( isset($_SESSION["mobile"]) ) { 
```

您真的不需要对那段代码运行检测 - 如果 cookie/session 数组还没有被拾取，它就不会持有“移动”索引。

所以代替;

```
<?php setcookie('mobile','m', time()+3600, '/','.example.com'); ?> 
```

利用;

```
<?php
Session_start();
$_SESSION['mobile'] = (bool) true;
$_SESSION['m'] = (bool) true;
$_SESSION['time'] = (int) time()+3600; 
```

等等等等..（请记住 Session_start(); 需要位于将使用此 cookie 的每个页面的开头！）

通过浏览器会话绑定 cookie 通常是一种好习惯，我想这将有助于解决可能出现的任何浏览器安全问题。

试一试，让我知道它是否适合你。

祝你好运，

*   伊根

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:12:26.830

问题解决了！

运行 Drupal 的桌面站点是问题所在。这是一个缓存问题之类的，因为如果我运行 cron，整个检测方案就可以完美运行。第二次，它没有。它只在运行 cron 后立即工作一次。我将不得不让我们的常驻 Drupal 专业人士来解决这个问题。

不过，感谢所有帮助！

# image-resizing - 上传照片的标准尺寸是多少？

> ID：11197905
> 
> 赞同：0
> 
> 时间：2012-06-25T21:53:43.593
> 
> 标签：image-resizing

我正在构建一个小型图像托管站点，我想知道是否有关于图像大小调整的最佳实践？

最长边1024px？960像素？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T22:00:29.447

我想这就是你要找的：

[http://www.webdevelopersnotes.com/design/web-screen-resolution-usage-statistics.php](http://www.webdevelopersnotes.com/design/web-screen-resolution-usage-statistics.php)

> 然而，多年来，随着高分辨率显示器使用的增加，使用 800x600 屏幕分辨率的人数逐渐下降

我会使用这些信息来决定大多数用户可以使用哪个显示器，然后还要考虑服务器上此类图像的文件大小等因素。或者，您可以走另一条路线，只询问用户他们的偏好在调整大小时，由您决定。

它还有一个很好的图表：

![在此处输入图像描述](../Images/45681951548c2591a35bef8fa74000f2.png)

# go - 如何用 Go 编程语言处理并行 HTTP 请求？

> ID：11197906
> 
> 赞同：9
> 
> 时间：2012-06-25T21:53:43.537
> 
> 标签：go

我在玩 go HTTP 包。我想像在 java 中那样并行处理请求。但我做不到。

我创建了一个简单的 Web 服务器，中间放了一个 sleep 并意识到 go 每次处理一个请求，所以如果我在浏览器上刷新，第一个请求的过程必须完成，直到第二个请求开始处理，这里是代码：

```
func main(){

    //Process the http commands
    fmt.Printf("Starting http Server ... ")
    http.Handle("/", http.HandlerFunc(sayHello))
    err := http.ListenAndServe("0.0.0.0:8080", nil)
    if err != nil {
        fmt.Printf("ListenAndServe Error",err)
    }
}

func sayHello(c http.ResponseWriter, req *http.Request) {
    fmt.Printf("New Request\n")
    processRequest(c, req)
}

func processRequest(w http.ResponseWriter, req *http.Request){
    time.Sleep(time.Second*3)
    w.Write([]byte("Go Say’s Hello(Via http)"))
    fmt.Println("End")
} 
```

由于我想并行处理这两个请求，我在“sayHello”函数中的“processRequest(c, req)”之前添加了“go”命令，以便在不同的 gorutine 中处理每个请求。但是......它不起作用......我不知道为什么。我知道这两个请求都得到了处理，因为我在控制台上看到了打印行，但浏览器一直在等待信息......并且不显示我的响应。

所以...我的问题，

每个请求是否都会创建一个新的 http.ResponseWriter？或者它的用途相同？你知道如何指示 Web 服务器使用不同的线程处理每个请求吗？

欢迎任何帮助....

福斯卡

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-25T23:47:57.820

所有连接都会自动同时处理。每个 TCP 连接（不是请求）都有自己的 goroutine。

在一个使用 http 管道和重用连接的浏览器的世界中，这可能并不总是很好。您的浏览器很可能正在重用一个连接，该连接会使其停止，直到 goroutine 正在处理的当前请求完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-29T18:04:27.907

要允许运行时支持使用多个操作系统线程，您可能需要通过以下方式设置该数字：

```
 runtime.GOMAXPROCS(n) 
```

或设置 GOMAXPROCS 环境变量。

要获取可用内核的数量，请使用

```
 runtime.NumCPU() 
```

所以你经常以

```
 runtime.GOMAXPROCS(runtime.NumCPU()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-06T11:12:49.447

我认为您的浏览器正在等待，因为您没有向它发送响应您的浏览器向 sayHello 发出请求，sayHello 也向 processRequest 发出请求，从您的代码 processRequest 向 sayHello 发送了响应，但 sayHello 没有发送回响应到浏览器。

您可以使用 http.Get 或 http.Post 来调用 processRequest

# foursquare - Foursquare API 返回无效的头像 url？

> ID：11197911
> 
> 赞同：0
> 
> 时间：2012-06-25T21:54:03.180
> 
> 标签：foursquare

> **可能重复：**
> [场地用户图像错误的 Foursquare API](https://stackoverflow.com/questions/10977100/foursquare-api-for-venue-user-image-error)

几周前我第一次注意到头像的这个问题。我认为这将是一个临时问题，但我今天注意到它仍然无法正常工作。

从 API 请求返回的数据包含这样的 url，用于头像 -> [https://irs1.4sqi.net/img/user/YEM5TK441NXU2QTJ.jpg](https://irs1.4sqi.net/img/user/YEM5TK441NXU2QTJ.jpg)

但是，当您尝试实际打开图像时，它会显示“图像”<a href="https://irs1.4sqi.net/img/user/YEM5TK441NXU2QTJ.jpg" rel="nofollow noreferrer">https://irs1\. 4sqi.net/img/user/YEM5TK441NXU2QTJ.jpg”无法显示，因为它包含错误。” ?

为什么 Foursquare API 会返回无效的 url？还有其他人有这个问题吗？我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:46:46.467

是的，如果您通过浏览器打开链接，您会看到“内部错误”。

这与此处描述的问题相同：[Foursquare API for place user image error](https://stackoverflow.com/questions/10977100/foursquare-api-for-venue-user-image-error)

这是由本月早些时候对 API 所做的更改引起的。

你应该注册到这个谷歌组：[https ://groups.google.com/forum/#!topic/foursquare-api/MpNpdO5zARU](https://groups.google.com/forum/#!topic/foursquare-api/MpNpdO5zARU)

# android - 如何使用 NDK 为 Android 编译现有的 C 程序？

> ID：11197912
> 
> 赞同：5
> 
> 时间：2012-06-25T21:54:09.110
> 
> 标签：android, c, compilation, android-ndk

我正在编写一个 Android 应用程序来测试网络性能，我想在应用程序中使用 iPerf。我可以找到已经为 Android 编译的二进制 iPerf 文件（然后我可以在手机上运行 iPerf 并收集它的输出），但我有兴趣自己编译这些文件。

在这里，有人提出了可以用来编译程序的脚本：http: [//sourceforge.net/tracker/index.php ?func=detail&aid=3533374&group_id=128336&atid=711373](http://sourceforge.net/tracker/index.php?func=detail&aid=3533374&group_id=128336&atid=711373)

我知道它需要 NDK，但我不知道从哪里开始。是否有任何好的资源或建议可以帮助指导我自己编译它（在 Windows 上，但我也有 Cygwin）。我知道 C 以及如何在 linux 上使用 GCC，但我不知道从哪里开始。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T21:57:38.803

这是关于开始使用 NDK 的一个很好的讨论。

[https://stackoverflow.com/questions/5375453/looking-for-a-good-tutorial-on-android-ndk](https://stackoverflow.com/questions/5375453/looking-for-a-good-tutorial-on-android-ndk)

如果您完成本教程，您将构建自己的 NDK “Hello, World” 类型的应用程序。这很简单，但它会帮助您了解 NDK。

这是教程的直接链接：http: [//mobile.tutsplus.com/tutorials/android/ndk-tutorial/](http://mobile.tutsplus.com/tutorials/android/ndk-tutorial/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-07T11:43:00.593

**在 Iperf3 上工作**

```
 #!/bin/sh
wget https://dl.google.com/android/repository/android-ndk-r18-linux-x86_64.zip
sudo apt-get install unzip
unzip android-ndk-r18-linux-x86_64.zip
#--arch arm or arm64 https://developer.android.com/ndk/guides/standalone_toolchain
android-ndk-r18/build/tools/make_standalone_toolchain.py --arch arm --api 26 --install-dir=my-toolchain
# Add the standalone toolchain to the search path.
export PATH=$PATH:`pwd`/my-toolchain/bin

# Tell configure what tools to use. aarch64-linux-android
target_host=arm-linux-androideabi #aarch64-linux-android or arm-linux-androideabi
export AR=$target_host-ar
export AS=$target_host-clang
export CC=$target_host-clang
export CXX=$target_host-clang++
export LD=$target_host-ld
export STRIP=$target_host-strip

# Tell configure what flags Android requires.
export CFLAGS="-fPIE -fPIC"
export LDFLAGS="-pie"
sudo apt-get install build-essential git
git clone https://github.com/esnet/iperf
cd iperf/
echo manual edit src/iperf_api.c change to char template[] = "/data/local/tmp/iperf3.XXXXXX";

#--disable-profiling or edit src/Makefile.in deleting "-pg" from iperf3_profile_CFLAGS and iperf3_profile_LDFLAGS
#./configure --host=arm-linux-androideabi CFLAGS=-static CXXFLAGS=-static --disable-profiling 
#make

##iperf2
#sudo apt-get install autotools-dev
#cp /usr/share/misc/config.{sub,guess} .

#adb push src/iperf3 /data/local/tmp
#adb shell chmod 755 /data/local/tmp/iperf3
#adb shell "/data/local/tmp/iperf3 -v" 
```

# c - 2D 动态数组未初始化 - 函数 C 的参数

> ID：11197914
> 
> 赞同：2
> 
> 时间：2012-06-25T21:54:19.373
> 
> 标签：c, arrays, dynamic, 2d, arguments

我有一个问题问你！

我有一个 C 程序，其中我的主函数中有一个动态二维数组：

```
int **neighbours; 
```

我根据命令行中的 args 进行初始化。问题是我想稍微清理一下代码。为此，我想在头文件中创建一个函数，该函数将未初始化的数组作为参考参数并在那里对其进行初始化。

这就是我调用函数的方式：

```
init(&nodeNum, &neighbours, argv[1], &nodes); 
```

这就是我在头文件中声明函数的方式：

```
int init(int *nodeNum, int ***neighbours, char *arg, struct node **nodes) 
```

这就是尝试分配内存的方式：

```
neighbours=malloc(*nodeNum*sizeof(int *));
        for(i=0;i<*nodeNum;i++){
            neighbours[i] = malloc(*nodeNum*sizeof(int *));
        } 
```

很明显，有些事情不顺利，它崩溃了！关于我可能做错了什么的任何提示？

感谢一些好心人的帮助，malloc 现在可以工作了，但是填充节点失败了！

这是函数的完整代码：

```
int init(int *nodeNum, int ***neighbours, char *arg, struct node **nodes){
FILE *file;
char buffer[4];
int i,y,distance;

if(strcmp(arg,"-l")==0){
        file = fopen("C:\\Users\\trendkiller\\thesis\\matrix.txt","r");
        printf("parsing adjacency matrix from file\n\n");
        //file = fopen ("C:\\Users\\trendkiller\\thesis\\matrix.txt", "r" ) ;
        *nodeNum = atoi(fgets(buffer,4,file));
        *neighbours=malloc(*nodeNum*sizeof(int *));
        for(i=0;i<*nodeNum;i++){
            (*neighbours)[i] = malloc(*nodeNum*sizeof(int *));
        }
        printf("this prints\n");
        printf("number of nodes: %s", buffer);
        for(i=0;i<*nodeNum;i++){
            for(y=0;y<*nodeNum;y++){
                fgets(buffer,4,file);
                (*neighbours)[i][y]=atoi(buffer);
                            }
        }

    }
    else{
        *nodeNum = atoi(arg);

        *neighbours=malloc(*nodeNum*sizeof(int *));
        printf("this prints\n");
        for(i=0;i<*nodeNum;i++){
            (*neighbours)[i] = malloc(*nodeNum*sizeof(int *));
        }

        *nodes=malloc(*nodeNum*sizeof(struct node));

        for(i=0;i<30;i++){
            (*nodes)[i].x=rand()%100;
            (*nodes)[i].y=rand()%100;
        }
        printf("this prints\n");

        printf("creating new adjacency matrix\n\n");
        for(i=0; i<*nodeNum; i++){
            for(y=0; y<*nodeNum; y++){
                distance=sqrt((((*nodes)[y].x-(*nodes)[i].x)*((*nodes)[y].x-(*nodes)[i].x))+(((*nodes)[y].y-(*nodes)[i].y)*((*nodes)[y].y-(*nodes)[i].y)));
                if(i==y){
                    (*neighbours)[i][y]=-1;
                }
                else if(distance<=20){
                    (*neighbours)[i][y]=1;
                }
                else {
                    (*neighbours)[i][y]=0;
                }
            }

        }

        file = fopen("C:\\Users\\trendkiller\\thesis\\matrix.txt","a+");
        fprintf(file,"%d\n",*nodeNum);
        for(i=0;i<*nodeNum;i++){
            for(y=0;y<*nodeNum;y++){
                fprintf(file,"%d\n", (*neighbours)[i][y]);
            }
        }
    } 
```

返回0；

}

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T22:02:35.743

问题是它`neighbours`是按值传递的，所以在函数内部对其进行修改没有效果。您需要通过指针传递它，并间接修改它：

```
int init(int *nodeNum, int ***neighbours_ptr, char *arg, struct node *nodes) {
    *neighbours_ptr = malloc(*nodeNum*sizeof(int *));
    for(i=0;i<*nodeNum;i++){
        (*neighbours_ptr)[i] = malloc(*nodeNum*sizeof(int *));
    }
} 
```

您还需要传递`&neighbours`而不是`neighbours`作为`init`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T22:42:10.893

在示例代码中，您给出了一个错误：

```
neighbours[i] = malloc(*nodeNum*sizeof(int *)); 
```

它应该在哪里

```
neighbours[i] = malloc(*nodeNum*sizeof(int)); 
```

为什么要使用 2D 数组的仿真而不是真实的？这从 C99 开始有效：

```
int (*neighbours)[nodeNum] = malloc(sizeof(int[nodeNum][nodeNum])); 
```

您将不需要`init`像您这样仅分配内存的设备。

为什么要直接传递指向`nodeNum`而不是值的指针？如果您仍然需要一个`init`进行一些初始化而不仅仅是分配的函数。界面看起来像

```
void init(size_t nodeNum, int neighbours[nodeNum][nodeNum]); 
```

# ios - 与 RestKit 一起使用时如何加密 SQLite（种子/其他）数据库

> ID：11197915
> 
> 赞同：0
> 
> 时间：2012-06-25T21:54:19.467
> 
> 标签：ios, sqlite, encryption, restkit, sqlcipher

我正在使用 RestKit 来执行数据库播种，以及执行本地持久性。相关的核心数据和对象映射按预期工作。但是，我现在需要加密本地数据库。我知道以下选项通常用于保护 SQLite 数据库

1.  使用某种带有 Lion Server 的 MDM/Profile Manager 来保护应用程序数据（远程擦除等）
2.  使用 SQLCipher 加密数据库

但是，SQLCipher 不适用于 RestKit。有人遇到过这种情况，还有什么可以加密本地 SQLite 的吗？我想继续使用 RestKit。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T06:43:27.570

我不确定这是否真的有必要。虽然不是一个确切的答案，[但这](https://nickharris.wordpress.com/2010/07/14/core-data-and-enterprise-iphone-applications-protecting-your-data/)可能对您有所帮助。您可以自由编辑 RestKit 源代码以添加 NSFileProtectionComplete 代码，或者您可以在他们的 github 区域请求功能增强。

# php - php重定向错误

> ID：11197919
> 
> 赞同：0
> 
> 时间：2012-06-25T21:54:35.387
> 
> 标签：php, redirect, header

我正在学习一个教程，我的一切都是 100% 正确的。基本上我正在创建一个基本的 CMS。在 CMS 的这一部分中，我将一些数据从表单上传到我的数据库。

目前一切正常，除了页面重定向。因此，当我填写表格时，所有内容都会完美地添加到数据库中。它根本不会重定向到所需的页面。我也没有错误。我还尝试将重定向设置为网站，以确保它不是我的页面路径。

当我提交表单时，它不会重定向，而是停留在处理上传的 .php 页面上。

这是我的代码：

```
<?php require_once("includes/connections.php"); ?>
<?php require_once("includes/functions.php"); ?>

<?php
    $menu_name = $_POST['menu_name'];
    $position = $_POST['position'];
    $visible = $_POST['visible'];
?>

<?php
    $query = "INSERT INTO phpPractice (
        menu_name, position, visible
    ) VALUES (
        '{$menu_name}', {$position}, {$visible}
    )";

    if(mysql_query($query, $connect)) {
        //echo"<p> did send </p>";
        //header('Location: content.php');
        header("Location: content.php");
        exit;       
    } else {
        echo "<p>Subject not created</p>";
        echo "<p>" . mysql_error() . "</p>";
    }
?>

<?php mysql_close($connect); ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T21:56:08.427

您的 PHP 标记之间的空白正在搞砸 header() 调用。删除所有空格 - 它被输出到浏览器。

在 header() 文档的第一个块中有一些关于此的信息：http: [//us.php.net/manual/en/function.header.php](http://us.php.net/manual/en/function.header.php)

在您的代码中，根本没有理由关闭 php 标记。

# php - 使用 PHP 或 JavaScript 从文本中删除所有数字

> ID：11197925
> 
> 赞同：-3
> 
> 时间：2012-06-25T21:55:29.467
> 
> 标签：php, javascript

我有一个 .txt 文件，其中包含名称列表和一些数字。例如，

* * *

亚伦 0.24 350,151 77

阿布杜尔 0.007 10,213 831

安倍 0.006 8,754 854

* * *

然后……

因此，我需要使用 PHP 或 JavaScript 从该列表中删除所有数字，并从列表中返回单词。

PS：我只是在学习这些语言，所以请具体回答——用完整的代码和它的位置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T21:57:10.493

看起来您实际上想要删除不是字母字符的所有内容。为此，请使用以下命令：

```
$text = 'AARON 0.24 350,151 77';
$text = preg_replace( '#[^a-z]#i', '', $text); 
```

这是一个正则表达式，它将用空字符串（无）替换任何不是 AZ 或 az 的字符。

你只需要这样：

```
$lines = file( 'Types.txt');
foreach( $lines as &$line)
    $line = preg_replace( '#[^a-z]#i', '', $line);
echo implode( "\n", $lines); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T22:43:09.347

JavaScript 版本看起来像这样。

```
var strings = ["AARON 0.24 350,151 77", "ABDUL 0.007 10,213 831", "ABE 0.006 8,754 854"],
newStrings = '';

for (var i=0,len=strings.length; i<len; i++){
newStrings = strings[i].match(/[A-z]+/g);
alert(newStrings);
} 
```

# sql - 在 Rails 中有效地建模 2:n 关系

> ID：11197928
> 
> 赞同：1
> 
> 时间：2012-06-25T21:55:41.837
> 
> 标签：sql, ruby-on-rails, activerecord, has-many, belongs-to

这是我所拥有的：

我有一个模型比赛和一个模型团队。一场比赛有 home_team 和 away_team。事实上，这是一个 2:n 的关系。

```
class Team < ActiveRecord::Base
 has_many :home_matches, :class_name => 'Match', :foreign_key => 'home_team_id'
 has_many :away_matches, :class_name => 'Match', :foreign_key => 'away_team_id'

 public
 def matches
   return home_matches + away_matches
 end
end 
```

和

```
class Match < ActiveRecord::Base
 attr_accessible :away_team_id, :home_team_id
 belongs_to :home_team, :class_name => 'Team', :foreign_key => 'home_team_id'
 belongs_to :away_team, :class_name => 'Team', :foreign_key => 'away_team_id' 
```

结尾

实际上，我现在可以调用 Team.find(2).matches 并获得所有客场和主场比赛。但**我不喜欢的是它需要两个 SQL 查询而不是一个**：

```
SELECT `matches`.* FROM `matches` WHERE `matches`.`home_team_id` = 2
SELECT `matches`.* FROM `matches` WHERE `matches`.`away_team_id` = 2 
```

我怎样才能让 Rails 使用这个查询？

```
 SELECT `matches`.* FROM `matches` WHERE `matches`.`home_team_id` = 2 OR `matches`.`away_team_id` = 2 
```

反过来也会引起同样的头痛。如果我定义了一个`team`合并的方法，`home_team`并且`away_team`我在只需要一个查询的情况下查询数据库两次。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T22:05:48.990

```
def matches
    Match.where("home_team_id = ? OR away_team_id = ?", id)
end 
```

此外，您不需要 Match 模型中的那些外键。这些属性包含在 Match 模型本身中，因此不是外来的。

# objective-c - 存储对象数组或在需要时创建？

> ID：11197930
> 
> 赞同：1
> 
> 时间：2012-06-25T21:55:46.557
> 
> 标签：objective-c, ios, performance, memory-management

我是 Objective-c 和 ios 的新手，但我很好。现在我遇到了一种情况，我可以看到两种到达同一目的地的方式。我只是好奇哪种方式更适合程序的效率。如果有更好的方式来表达我还不知道的所有这些，我提前道歉。

（删除所有先前的上下文）..问题的实质是这样的：

我的第一个对象是一个可能应用了旋转变换的矩形 UIView 对象。该对象具有存储四个变换角位置的 CGPoints 的属性。

```
rectangularView.h
<...>

@property (nonatomic) CGPoint topLeft;
@property (nonatomic) CGPoint topRight;
@property (nonatomic) CGPoint bottomLeft;
@property (nonatomic) CGPoint bottomRight; 
```

我创建了一个 Line 对象：

```
line.h
<...>

@property (nonatomic) CGPoint pointA;
@property (nonatomic) CGPoint pointB;
@property (nonatomic) float m;   // slope
@property (nonatomic) float b;   // y-intercept 
```

基本上，Line 对象代表了矩形视图的边。这些行将存储在一个数组中。

在其他地方，有一种方法能够确定两个 Line 对象是否相交，以确定一个 rectangleView 是否与另一个相交。

```
- (BOOL)checkLineIntersection:lineA:lineB 
```

问题：当调用 checkLineIntersection:lineA:lineB 时，显然需要发送两个 Line 对象。会不会更好：

*   (A) 在每个 rectangleView 对象中创建和存储的线对象？
    *   优点：该行已经创建并且只需要传递给方法，从而产生更快的处理
    *   缺点：会使用更多内存
*   (B) 在将它们发送到方法之前创建线对象。

    *   优点： Line 对象不会占用内存
    *   缺点：在为所有 rectangleView 对象创建边的所有循环中，在将它们发送到方法之前的处理时间更长

基本上，如果有一个比较的矩形视图（compView）

```
[OPTION A]

for (RectangularView *rv in rectangularViewArray) {
    BOOL doesIntersect = [self checkLineIntersection:[rv lineA] lineB:[compView lineA]];
    <...> 
```

或者

```
[OPTION B]

for (RectangularView *rv in rectangularViewArray) {
    Line *lineA = [[Line alloc].....
    Line *lineB = [[Line alloc]....
    <...>
    BOOL doesIntersect = [self checkLineIntersection:[rv lineA] lineB:[compView lineA]]; 
```

我倾向于选项 A，以便在事件之间分配处理时间，这意味着在创建 rectangleView 时设计和计算线条，并且只需要在发送它们进行交叉测试时调用它们。

谢谢你..我希望我写得足够好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T23:38:38.690

你应该学会使用乐器。它们是一个非常好的工具套件，您可以查看各种指标、泄漏、堆空间、性能数字。我认为您应该在您的应用程序中运行一些分析，并根据您所看到的做出决定。在这里很难给出明确的 a 或 b 答案。

# c - 结构C中的“：”是什么意思

> ID：11197931
> 
> 赞同：9
> 
> 时间：2012-06-25T21:55:50.143
> 
> 标签：c, struct

> **可能重复：**
> ['unsigned temp:3' 是什么意思](https://stackoverflow.com/questions/2950029/what-does-unsigned-temp3-means)

```
 struct Test
  {
      unsigned a : 5;
      unsigned b : 2;
      unsigned c : 1;
      unsigned d : 5;
  };

  Test B;
  printf("%u %u %u %u", B.a, B.b, B.c, B.d); // output: 0 0 0 0
  static struct   Test A = { 1, 2, 3, 4}; 
```

有人可以解释一下`:`结构的目的是什么，`printf`只是输出`0`，所以我假设这些不是默认值，而是它们是什么？

也有人可以解释一下为什么`A.a, A.b, A.c, A.d`输出`1, 2, 1, 4`而不是`1, 2, 3, 4`

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-25T21:58:10.473

那是一个[位域](http://en.wikipedia.org/wiki/Bit_field)。

它基本上告诉编译器`hey, this variable only needs to be x bits wide, so pack the rest of the fields in accordingly, OK`？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T21:58:10.283

这些是位域，请参阅有关位域的[维基百科部分](https://en.wikipedia.org/wiki/C_syntax#Bit_fields)或有关[位域的参考](http://publications.gbdirect.co.uk/c_book/chapter6/bitfields.html)

后面的数字`:`表示要为左侧的标识符保留多少位。与通常紧密打包数据的情况相比，这允许您分配更少的空间。您只能在`struct`s 或`union`s 中执行此操作。

这是关于位域的简短[教程。](http://www.tutorialspoint.com/cprogramming/c_bit_fields.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:58:52.537

简单的解释：你指定你的变量应该有多少位。（您不能指定比类型的原始大小更多的位。）
**编辑：**您的第三个变量只打印 1 因为它只`1 bit`需要存储其数据。所以值只能是`0`or `1`。十进制值以二进制格式`3`表示。`11`因此，无论哪个位被截断，您最终都会`1`在变量中存储一个。

# loops - Jython 脚本延迟

> ID：11197933
> 
> 赞同：0
> 
> 时间：2012-06-25T21:55:55.137
> 
> 标签：loops, timer, delay, jython, sleep

我的python脚本被告知：

```
import time

def wait_seconds(x):
    print "started"
    time.sleep(x)
    print "stopped" 
```

然后当我告诉它时：

```
>>> wait(.2) 
```

我得到：

```
///it waits .2 seconds and then...
started
stopped 
```

它会在做任何其他事情之前等待，这不是我想要的。如果我在循环中使用睡眠它什么都不做（它只做睡眠）

有没有更好的方法来做短暂的延迟？感谢任何回复的人！:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T22:18:26.273

尝试在延迟之前刷新标准输出。

# python - 发生套接字循环时，Tkinter 无法工作

> ID：11197936
> 
> 赞同：2
> 
> 时间：2012-06-25T21:56:12.397
> 
> 标签：python, sockets, loops, tkinter

拜托，我的代码需要帮助：

```
def start():
   def start_tkinter():
      global main,l
      main.destroy()
      main=Tk()
      l=Listbox(main)
      f1=Frame(main)
      e=Entry(f1)
      b1=Button(main,text="Stop",command=parar)
      l.pack(side=TOP)
      f1.pack(side=BOTTOM)
      e.pack(side=LEFT)
      b1.pack(side=RIGHT)
      main.update()
      start_server()

    def start_server():
     HOST, PORT = "localhost", 9999
     server = SocketServer.UDPServer((HOST, PORT), MyUDPHandler)
     server.serve_forever()
    start_tkinter() 
```

当我开始循环时，Tkinter 冻结并且我无法使用它。拜托，我需要一个解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T23:41:30.837

你是对的。本质上，您需要两个并行运行的无限循环：您需要一个为 GUI 提供服务，另一个为套接字服务器提供服务。您唯一的选择是使用两个线程或两个进程。*

要记住的主要事情是 Tkinter 需要在主线程中运行，并且您不能直接从另一个线程访问 Tkinter 对象，因为 Tkinter 不是线程安全的。如果您希望套接字线程与 Tkinter 交互，则需要引入某种消息传递机制

*这些不是您唯一的选择，但它们是最实用的。当我需要从套接字读取数据时，我通常会编写一些 Tcl 代码在底层 Tcl 解释器中运行，因为 Tcl 的 fileevent 模型非常强大。你失去了线程实现的复杂性，代价是不得不做一些 Tcl 编程。但我离题了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T01:00:53.643

好吧，男孩们我现在只使用Threaring。看：

```
t = Thread(target=start_server)
t.start() 
```

但感谢您的回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-09T00:41:50.377

你确定你原来的问题不是来自使用“阻塞”套接字吗？如果是这种情况，那么答案就像输入“socket.setblocking(0)”一样简单

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T22:06:18.913

您可能想尝试[多处理模块](http://docs.python.org/library/multiprocessing.html)：

```
import multiprocessing
def start():
   def start_tkinter():
      global main,l
      # ...
      main.update()
      proc = multiprocessing.Process(target=start_server)
      proc.start()
   def start_server():
     HOST, PORT = "localhost", 9999
     # ... 
```

但是，由于我们不知道您想做什么，您的代码也不是问题中给出的真正可执行的，我不能只给出这个建议。

# python - 在 Pygame 中更改所有黑色像素的颜色

> ID：11197938
> 
> 赞同：0
> 
> 时间：2012-06-25T21:56:42.920
> 
> 标签：python, colors, pygame, pixels

我正在用 Pygame 制作一个程序，它可以改变插入图片的整体颜色。它工作正常，但现在我想更改图片的特定部分 - 只有黑色。有没有一种方法可以将*所有*黑色像素的颜色更改为另一种颜色？

我已经尝试过使用`surface.set_at()`，`surface.get_at()`以及其他一些。请帮忙？:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T22:01:57.453

* * *

可能你应该试试[PixelArray](http://www.pygame.org/docs/ref/pixelarray.html)

从文档：

**PixelArray.replace**

```
Replaces the passed color in the PixelArray with another one.
PixelArray.replace (color, repcolor, distance=0, weights=(0.299, 0.587, 0.114)): Return None
Replaces the pixels with the passed color in the PixelArray by changing them them to the passed replacement color. 
```

# ruby-on-rails-3 - Rails 3 MongoID 和嵌套表单（嵌入文档） - 如何添加 fields_for 的表单字段

> ID：11197941
> 
> 赞同：1
> 
> 时间：2012-06-25T21:56:58.343
> 
> 标签：ruby-on-rails-3, mongoid, nested-forms

我正在使用 mongoid (3.0) 和 rails 3.2 创建一个存储具有多个地址的模型的表单。如何按需添加表单字段（因为我想让用户决定向模型添加多少地址）？

在“新”控制器中，我使用 @person.addresses.build 创建嵌入式文档，一切都按预期工作，即使我尝试通过 Rails 控制台添加多个地址。但是如何创建一个根据用户请求添加嵌套字段的动态表单？

表格：

```
<%= simple_form_for @person, :html => { :multipart => true } do |f| %>
  <%= f.input_field :title %>
  <%= f.fields_for :addresses do |t| %>
    this is an address input:
    <%= t.input :foo %>
  <% end %>
<% end %> 
```

型号：

```
class Rootobject
  include Mongoid::Document
  field :title
  embeds_many :addresses
  accepts_nested_attributes_for :addresses
end

class Person < Rootobject
  field :firstname
end

class Address
  include Mongoid::Document
  field :foo
  embedded_in :rootobject, :inverse_of => :addresses
end 
```

上面的代码是我想要做的简化。我的地址表格实际上是部分的。使嵌套形式的地址显示另一个迭代（部分）的最简单方法是什么？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T14:21:08.937

你可以使用这个[gem](https://github.com/ryanb/nested_form/)。它创建地址部分的蓝图，您可以在其中添加`Add` **/** `Remove`按钮来添加/删除地址。

# eclipse - 如何在 Eclipse 中停止“弹出式透视图”？

> ID：11197944
> 
> 赞同：0
> 
> 时间：2012-06-25T21:57:12.180
> 
> 标签：eclipse

我在 Eclipse 中执行的操作似乎有一半打开了一个新的视角，从而掩盖了我创建的精美排列的视角。感觉就像我回到了 1998 年，与所有这些“弹出式观点”作斗争。

有没有办法防止新的透视图在 Eclipse 中自动打开？是否有一个通用设置来控制这个（？）还是我必须更改插件特定设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T22:07:37.413

There are two preference settings that might help your issue (but not completely solve it):

1.  Preferences -> General -> Perspectives: *Open the associated perspective when creating a project*
2.  Preferences -> Run/Debug -> Perspectives: *Open the associated perspective when launching* and *Open the associated perspective when the application suspends*

However, if you turn down the perspective switches, then you might have to manually switch to the Debug perspective while debugging. That switch makes sense to me, as during debugging I seldom want to traverse the code by the package structure but by the types of the variables and the stack trace. In other words, some switching makes sense (to me at least).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T02:16:16.267

Team Synchronize 视角切换可以通过**Preferences** > **Team**禁用（选项是“Open the associated perspective when...”

我很确定默认选择是**Prompt**，除非您在提示对话框中的某个位置更改它。

# delphi - windows上的delphi冻结屏幕

> ID：11197958
> 
> 赞同：1
> 
> 时间：2012-06-25T21:57:39.380
> 
> 标签：delphi, modal-dialog

有什么方法可以冻结屏幕并仅显示一个活动表单（只有该表单可以接收来自用户的输入）。

我的描述示例就像 Windows 用户从开始菜单单击关机一样。它显示关闭、重新启动等选项，并且不允许用户进行除该表单之外的输入。或者当使用 Tune Up 注册表优化器时，它会要求您关闭所有其他正在运行的应用程序，然后它会显示一个带有进度条的蓝色窗口，但用户既不能关闭此窗口也不能进行其他输入。

我知道模态形式，但有没有其他方法可以做到这一点。

任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T22:16:09.210

要真正停止对其他应用程序的输入，您可能需要使用 SetWindowsHookEx() 来安装全局消息挂钩（我认为您想使用 WH_CBT 选项）以便将消息发送到其他窗口（当然您需要管理员权限执行此操作）。

*但是*，还有另一种方法：a) 让您的程序截取屏幕截图，b) 对位图进行后处理以将其“变灰”，以及 c) 完全全屏显示您的应用程序（调整应用程序大小的简单方法甚至覆盖任务栏）并将应用程序表单的背景设置为您在步骤 A 中截取的屏幕截图并在步骤 B 中显示为灰色。您最终得到的是一个看起来很像用户桌面的简单图像显示，但是windows当然是不可点击的。

# jquery - 我应该如何修改这个 jQuery UI 可拖动代码？

> ID：11197964
> 
> 赞同：0
> 
> 时间：2012-06-25T21:58:10.100
> 
> 标签：jquery, jquery-ui, draggable, droppable

我已经建立了一个 jsFiddle 来说明[这里的整个情况。](http://jsfiddle.net/watson/Lt9Kb/7/)一切都如我所愿，除了当你把红色的“钉子”拖到右边的一个绿色盒子上，然后在它上面拖另一个红色钉子时，我希望它恢复时会变回红色回到左边的盒子。

HTML：

```
<div id="box">
    <div class="peg">&nbsp;</div>
    <div class="space">&nbsp;</div>
    <div class="peg">&nbsp;</div>
    <div class="space">&nbsp;</div>
    <div class="peg">&nbsp;</div>
    <div class="space">&nbsp;</div>
    <div class="peg">&nbsp;</div>
</div>

<div id="game">
    <ul class="row">
        <li class="hole">&nbsp;</li>
        <li class="hole">&nbsp;</li>
        <li class="hole">&nbsp;</li>
        <li class="hole">&nbsp;</li>
    </ul>
    <ul class="row">
        <li class="hole">&nbsp;</li>
        <li class="hole">&nbsp;</li>
        <li class="hole">&nbsp;</li>
        <li class="hole">&nbsp;</li>
    </ul> </div> 
```

Javascript：

```
$('.peg' ).draggable({
    snap: ".hole",
    snapMode: "inner",
    snapTolerance: 40,
    //scope: "zappa",
    //revert: 'invalid',
    stop: function(){
        $(this).draggable('option','revert','invalid');
    },
    //helper: "clone"
});    

$('.peg').droppable({
    tolerance: 'fit'
});

$('.peg').droppable({
    greedy: true,
    tolerance: 'touch',
    drop: function(event,ui){
        ui.draggable.draggable('option','revert',true);
    }
});

$('.hole').droppable({
     drop: function(e,ui) {
          $(ui.draggable).removeClass('peg').addClass('top');
     },
     //scope: "zappa"
});

$('#box').droppable({
     drop: function(e,ui) {
          $(ui.draggable).removeClass('top').addClass('peg');
     },
     //scope: "zappa"
}); 
```

CSS：

```
#game {
    position: absolute;
    width: 330px;
    height: 400px;
    top: 15px;
    left: 135px;
    background: wheat;
    padding: 15px;
}

.row {
    position: relative;
    margin-left: auto;
    margin-right: auto;
    height: 75px;
    margin-bottom: 15px;
    background-color: olive;
}

.hole {
    width: 75px;
    height: 75px;
    float: left;
    background-color: aqua;
    opacity: 0.3;
    margin-left: 6px;
}

#box {
    position: absolute;
    left: 15px;
    top: 15px;
    width: 90px;
    padding-bottom: 15px;
    background-color: wheat;
    padding-top: 15px;
    padding-left: 15px;
}

.peg {
    width: 75px;
    height: 75px;
    background-color: red;
    z-index: 1;
}
.space {
    height: 15px;
    width: 75px;
}

.top {
    background-color: blue;
    width: 75px;
    height: 75px;
    z-index: 1;
} 
```

# c# - C# 组合框 SelectedIndexChanged 事件

> ID：11197970
> 
> 赞同：0
> 
> 时间：2012-06-25T21:58:19.783
> 
> 标签：c#, .net

好的，我有一个问题，在我从组合框中选择不同的值后，我需要几个文本框来填充数据，我需要一个事件来完成它，但这由于某种原因不起作用：

```
private override void rasaCombo_SelectedIndexChanged(object sender, EventArgs e) 
```

我已经对其进行了测试，它似乎甚至没有将其识别为有效事件，因为它从未进入代码的那部分。我正在使用 Visual C# 2010。帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T22:03:24.317

无需覆盖

```
private void rasaCombo_SelectedIndexChanged(object sender, EventArgs e) 
```

检查您是否在某处订阅事件。

```
rasaCombo_.SelectedIndexChanged += rasaCombo_SelectedIndexChanged; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-25T22:03:53.480

你为什么要覆盖事件处理程序？我不认为你需要它。

# scala - 如何确定Scala中类型参数的子类型？

> ID：11197974
> 
> 赞同：2
> 
> 时间：2012-06-25T21:58:35.860
> 
> 标签：scala, type-parameter

```
class S
class A extends S
class B extends S

class ClassWithTypeParameter[+T]

val a: ClassWithTypeParameter[S] = new ClassWithTypeParameter[A] 
```

如何确定用于值 a 的类型参数的子类的类型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T23:02:56.253

你不能因为**类型擦除**。但是，我认为您这样做的尝试是由于误解造成的。

*   类型系统的意义在于，编译器可以更有力地推断程序的正确性。
*   在静态类型系统中，每个引用都有一个无法更改的*类型*

在你的程序中，有一个引用，`a`这个引用的类型是`ClassWithTypeParameter[S]`. 那。是。全部。编译器可以知道使用此引用可以做什么。这些类型纯粹是为编译器而存在的。事实上，在*运行时*，`a`被分配给一个值`ClassWithTypeParameter[A]`是无关紧要的。

* * *

一种*近似*的方法（受擦除限制）是使用**清单**（在 2.10 中称为其他东西）：

```
class ClassWithTypeParameter[+T: Manifest] { def erasure = manifest[T].erasure } 
```

然后你可以打电话`erasure`给你`java.lang.Class`。正如我所说，这是有限的。类与*类型**不同*，没有办法区分，例如`ClassWithTypeParameter[List[Int]]`，`ClassWithTypeParameter[List[Double]]`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T23:37:56.920

以下是一个坏主意（就像反射的大多数用途一样），但它有效：

```
class ClassWithTypeParameter[+T: Manifest] {
  def paramIs[V: Manifest] = manifest[T] == manifest[V]
} 
```

这给了我们：

```
scala> val a: ClassWithTypeParameter[S] = new ClassWithTypeParameter[A]
a: ClassWithTypeParameter[S] = ClassWithTypeParameter@6493c09c

scala> a.paramIs[A]
res0: Boolean = true

scala> a.paramIs[S]
res1: Boolean = false

scala> a.paramIs[B]
res2: Boolean = false 
```

和：

```
scala> val i = new ClassWithTypeParameter[List[Int]]
i: ClassWithTypeParameter[List[Int]] = ClassWithTypeParameter@260702ee

scala> i.paramIs[List[Int]]
res3: Boolean = true

scala> i.paramIs[List[Double]]
res4: Boolean = false 
```

您可以使用' s`paramSubtypeOf`和.`paramSupertypeOf``Manifest``<:<``>:>`

在 Scala 2.10（里程碑 4 或更高版本）中，有[一种更灵活的方式](http://www.scala-lang.org/archives/downloads/distrib/files/nightly/docs/library/index.html#scala.reflect.runtime.package)来获取类型：

```
class ClassWithTypeParameter[+T: TypeTag] {
  def paramType = reflect.runtime.universe.typeTag[T].tpe
} 
```

现在您可以编写诸如`a.paramType.parents`获取直接超类型之类的东西。

# php - 获取表单字段名称（出现在表单中），而不是 PHP 中的实际名称

> ID：11197976
> 
> 赞同：0
> 
> 时间：2012-06-25T21:58:46.080
> 
> 标签：php, html, forms

如果我有一个简单的表格，例如：

```
 <div class="main_account">
 <form name="create_account" action="create_account.php" method="post">

                <legend>Create Account</legend>
                <p><label for= "user" >Username*: </label><br/><input type="text" name="user" />
                <p/>
                <p><label for= "password" >Password*: </label><br/><input type="password" name="password" />
                <p/>
.......... 
```

有没有办法在 create_account.php 表单中查看名称字段的“用户名 *：”值，换句话说，实际字段中每个表单字段旁边显示的值。我问这个是因为我想创建一个在其旁边显示变量字符串的字段，但我不知道如何将它传递给 php 脚本。我对包含或要求不感兴趣。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:59:57.367

不，该信息不会通过表格传递。如果您以后想使用它，您需要将它存储在其他地方。

# c# - c# - 检查字符串是否包含字符和数字

> ID：11197987
> 
> 赞同：4
> 
> 时间：2012-06-25T21:59:47.157
> 
> 标签：c#, asp.net, .net, regex

如何检查字符串是否包含以下字符“-A”后跟数字？

例如：thisIsaString-A21 = yes，包含“-A”后跟一个数字

例如：thisIsaNotherString-AB21 = 否，不包含“-A”后跟数字

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-25T22:02:19.237

可以用正则表达式来完成：

```
if (Regex.IsMatch(s, @"-A\d")) { ... } 
```

`\d`匹配任何数字。

在线查看它：[ideone](http://ideone.com/w7hCW)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-25T22:04:54.980

```
if(Regex.IsMatch("thisIsaString-A21", "-A\\d+"))
{
  //code to execute
} 
```

如果你真的想提取 -A[num] 位，那么你可以这样做：

```
var m = Regex.Match("thisIsaString-A21", "-A\\d+"));
if(m.Success)
{
  Console.WriteLine(m.Groups[0].Value);
  //prints '-A21'
} 
```

您还可以做其他事情 - 例如，如果您需要单独提取 A[num] 位或仅提取数字：

```
var m = Regex.Match("thisIsaString-A21", "(?<=-A)\\d+");
//now m.Groups[0].Value contains just '21' 
```

或者就像我的第一个建议，如果你想要“A21”：

```
var m = Regex.Match("thisIsaString-A21", "(?<=-)A\\d+");
//now m.Groups[0].Value contains 'A21' 
```

还有其他方法可以实现最后两个 - 我喜欢非捕获组`(?<=)`，因为顾名思义，它保持输出组干净。

# asp.net - MEF 可以加载程序集但不加载任何零件

> ID：11197988
> 
> 赞同：1
> 
> 时间：2012-06-25T21:59:51.133
> 
> 标签：asp.net, asp.net-mvc, plugins, mef, mvccontrib

我正在使用 MvcContrib 的可移植区域和 MEF 构建一个插件框架，以允许将可移植区域添加为插件，而无需重新编译（只需将您的 dll 放在 bin/Modules 文件夹中）或直接引用插件项目。

在开发插件时，我有两个项目的解决方案：MyFramework 和 MyPlugin。一切正常。我有另一个解决方案，其中只有项目 MyFramework，但 MyPlugin.dll 位于 bin/Modules 文件夹中。当我使用实例化目录时

```
string Path = HostingEnvironment.MapPath("~/bin");
string ModulesPath = HostingEnvironment.MapPath("~/bin/Modules");
var catalog = new AggregateCatalog(
    new DirectoryCatalog(Path)
    new DirectoryCatalog(ModulesPath)
); 
```

我可以看到 MyPlugin.dll 的程序集已加载，但未找到任何部件。我尝试使用 MEFx 转储组合状态，如下[所述](http://mef.codeplex.com/wikipage?title=Debugging%20and%20Diagnostics&referringTitle=Guide)：

```
string Path = HostingEnvironment.MapPath("~/bin");
string ModulesPath = HostingEnvironment.MapPath("~/bin/Modules");
var binCatalog = new DirectoryCatalog(Path);
var modulesCatalog = new DirectoryCatalog(ModulesPath);
var catalog = new AggregateCatalog(binCatalog, modulesCatalog);

using (var container = new CompositionContainer(modulesCatalog))
{
    var ci = new CompositionInfo(modulesCatalog, container);
    var stringWriter = new StringWriter();

    CompositionInfoTextFormatter.Write(ci, stringWriter);
    string compositionStateString = stringWriter.ToString();
    Console.WriteLine(s);
} 
```

但是 compositionStateString 只是一个空字符串。

我无法理解问题的出处。由于 MyFramework 没有直接引用 MyPlugin，因此这两个项目是否编译为同一解决方案的一部分并不重要，对吧？

附加信息：我在[探测路径](https://stackoverflow.com/questions/806467/how-can-i-set-privatebinpath-in-mef?rq=1)中有 bin/Modules 。

我通过使用自定义导出属性装饰控制器来导出控制器：

```
[ExportModuleControllerAttribute("NotificationsController")]
public class NotificationsController : BaseController
{
    //...
} 
```

该属性在 MyFramework 中定义如下：

```
[AttributeUsage(AttributeTargets.Class), MetadataAttribute]
public class ExportModuleControllerAttribute : ExportAttribute, INamedMetadata        
{
    public string[] Dependencies { get; set; }
    public string Name { get; set; }

    public ExportModuleControllerAttribute(string name, params string[] dependencies)
        : base(typeof(IController))
    {
        Dependencies = dependencies;
        Name = name;
    }
} 
```

与 INamedMetadata 接口一样：

```
public interface INamedMetadata
{
    #region Properties
    string Name { get; }
    #endregion
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T22:13:16.533

您如何在模块 dll 中导出类（我猜是控制器）等？让我们看看更多的代码。设置一个目录是不够的，你实际上必须告诉 mef 把东西放进去。

还要对 ci.PartDefinitions 进行计数，看看里面是否有任何东西。事实上，检查调试器中的 ci 和容器变量，看看你有什么。

另外，为什么您只检查 modulesCatalog 不应该检查目录，例如

```
 var ci = new CompositionInfo(catalog, container); 
```

无论如何，希望这能为您指明正确的方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T00:56:36.830

@Peter 提出了一些很好的观点。我还建议您尝试 Visual MEFX。您可以在`mefcontrib-tools`项目中找到它。这将让您以交互方式探索您的程序集。您可以一次添加一个，看看是否有任何导出。

这是一篇关于设置它的文章：[Visual MEFX 入门](http://ihadthisideaonce.com/2012/02/22/getting-started-with-visual-mefx/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-21T18:58:45.820

您需要确保已将`*.pdb`文件包含在启动 bin 文件夹中。

`*.dll`不足以满足进口。

# php - 单击特定按钮时更新数据库中的特定行。php

> ID：11197991
> 
> 赞同：-2
> 
> 时间：2012-06-25T22:00:00.830
> 
> 标签：php, mysql, html, forms

好的，例如说我有一个用户可以在其中投票的网站。

假设每个民意调查都在数据库中，并且每个民意调查都有一个唯一的 ID 列，以及一个存储问题的列，一个代表多少票赞成的列，以及一个代表多少反对票的列。

假设我有一个页面，用户可以在其中查看民意调查。因此，我查询数据库中的所有民意调查，然后遍历所有民意调查，将它们打印到屏幕上，并在每个民意调查旁边放置一个单选按钮表单，您可以在其中对问题投是/否，然后提交。

这是我需要帮助的地方。例如，如果我在屏幕上有数百个这样的民意调查，并且用户单击其中一个旁边的提交按钮并进行投票，我如何确定需要更新记录的唯一民意调查？

所以我想我要说的是，我如何将每个投票的 id 关联到它自己的提交按钮，以便当用户单击该特定提交按钮时，我知道要更新哪个投票的记录？

```
Database: A_Database

Table: Polls
ID        Question           Yes    No
1       "Is the sky blue?"    0     0
2       "Is water wet?"       0     0 
```

这是数据库的结构。所以现在我将查询所有问题，并将它们打印到屏幕上以及提交投票的表格。

```
$query = SELECT * FROM `Polls`;
   if ($query_run = mysql_query($query)) {
        $count = 0;
        $array = mysql_fetch_assoc($query_run);
        while ($count < mysql_num_rows($query_run)) {
            echo '<strong>Poll: Yes/No:</strong>'.'<br>';
            echo mysql_result($query_run, $count, 'Question').' ';
            echo mysql_result($query_run, $count, 'yes').'/';
            echo mysql_result($query_run, $count, 'no').' ';
                            echo '<form><input type="radio" name="vote"> yes
                                        <input type="radio" name="vote"> no 
                                        <input type="submit" name="submit" value="vote">
                                  </form>';
            $count = $count + 1;
        }
    } else {
        echo mysql_error();
    } 
```

好的，现在所有的投票都输出到屏幕上，每个投票旁边都有一个提交按钮。我的问题是如何将每个提交按钮与其自己的投票相关联，以便当用户投票并单击特定提交按钮时，我知道要更新记录的投票。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T22:33:37.227

仅使用 php更新数据库中的行是**不可能的。**您将不得不使用 Javascript。

PHP 是*服务器端*语言，Javascript 是*客户端*语言。

这意味着在您的网络浏览器有机会看到它之前，服务器会使用 PHP 为您的浏览器呈现 html 页面以进行打印。数据库不能用 PHP 修改，除非服务器再次加载整个页面，因为*服务器端*语言首先运行。

这就是为什么您必须为此使用 Javascript。由于 Javascript 是一种*客户端*语言，因此它在 Web 浏览器的范围内运行。因此，如果您使用 Javascript，您将能够更新数据库。

这种无需再次加载整个网页即可在页面上发布和更新元素的 Javascript 方法称为 AJAX。

如果您如此热衷于不学习 Javascript，您可以使用[PHPLiveX](http://www.phplivex.com/)库在 PHP 中使用 AJAX。这很好，但是一旦你使用它，你可能会意识到为什么使用 Javascript 更实用。我会使用[JQuery](http://jquery.com)，但那是用 Javascript 编写的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T22:09:10.083

Sounds like foreach poll, use a unique ID. Using jQuery, when the uniqueID submit button is clicked, send an ajax POST request to update the database and then update the poll data on the screen on success.

Unless you show your work, I can't give you any specific information beyond how it sounds like I would be doing it given your description.

# c++ - C++ 中的独立函数/数据

> ID：11197992
> 
> 赞同：4
> 
> 时间：2012-06-25T22:00:07.500
> 
> 标签：c++, oop

我对此不确定，并且搜索了一下并没有发现任何特别有用的东西。所以，假设我有一个头文件，其名称空间包含一些 C1 和 C2 类；

```
namespace my_namesp {

class C1 {
public:
  blah1;
  ...
private:
  blah2;
...
};

class C2 {
public:
  junk1;
  ...
private:
  junk2;
  ...
};

} //-End namespace 
```

现在假设在实现（CPP）中，我定义了 C1、C2 的所有成员函数，然后假设我有一些我希望 C1 和 C2 共享的公共数据，比如一个枚举和一个字符串数组，但我没有不一定希望他们成为任一阶级的一部分。那么执行以下操作是否合法（注意：它可以正常构建和工作）；如果我将此实现导出为客户端应用程序的库，怎么样？这还能用吗？出于某种我应该知道的原因，这种设计是否令人不悦？也许 OOP 的一个特定特性可能更适合这种事情？

```
namespace my_namesp {

enum some_list_num {
   list_member1,
   list_member2,
   ...,
   list_length
}

static const std::string string_list[] = {
   str1,
   str2,
   ...,
   strN 
}

return_type C1::some_func1(...) {
   ...
}

...

return_type C1::some_func1(...) {
   ...
}

} //-End my namespace 
```

再次提前感谢任何想法/更正。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-25T22:05:31.773

如果 C1 和 C2 共享一些应该保留在翻译单元本地的实现细节，那很好。

最好将它们放在 cpp 文件中的匿名命名空间中，这样以后就不会有链接器符号冲突的风险（即，如果库客户端轻率地将某些内容添加到您的命名空间并意外重用您的“私有”名称之一） .

cpp 文件可能如下所示：

```
namespace { // private implementation details

    enum some_list_num {
       list_member1,
       list_member1,
       ...,
       list_length
    }

    static const std::string string_list[] = {
       str1,
       str2,
       ...,
       strN 
    }

}

namespace my_namesp { // define externally-visible functions etc.

    return_type C1::some_func1(...) {
       ...
    }

    return_type C1::some_func1(...) {
       ...
    }
} 
```

# python - 在 ndimage.find_object ... 颜色特征之后如何？

> ID：11197993
> 
> 赞同：6
> 
> 时间：2012-06-25T22:00:07.480
> 
> 标签：python, image-processing, scipy

我有一个大图像，标记后有大约 500 个特征。我知道如何使用 find_object 将它们放入切片中，但我想为它们着色，以便查看结果。对此有什么快速建议吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-25T22:26:47.753

你可以像这样使用 matplotlib：

```
import scipy
from scipy import ndimage
import matplotlib.pyplot as plt

im = scipy.misc.imread('all_blobs.png',flatten=1)
im, number_of_objects = ndimage.label(im)
blobs = ndimage.find_objects(im)

plt.imsave('blobs.png', im)
for i,j in enumerate(blobs):
    plt.imsave('blob'+str(i)+'.png',im[j]) 
```

原图：

![在此处输入图像描述](../Images/ee63b106702001df7ff26e1d7ca76a7a.png)

标记图像：

![在此处输入图像描述](../Images/2d063310840eee47abead0a0f69374c6.png)

包含斑点的切片：

![在此处输入图像描述](../Images/cfcca82239a532fed15d81968a1290c8.png) ![在此处输入图像描述](../Images/9b07d9a3c90b84057c35227482012d35.png) ![在此处输入图像描述](../Images/fa9f806c193c9a17f34607f5dfc75840.png) ![在此处输入图像描述](../Images/c43043849ba902ed21f2701839f743a9.png) ![在此处输入图像描述](../Images/467a78fc767188dbf46845109d8d16ec.png) ![在此处输入图像描述](../Images/5fda0e59d61201fbbd02a9acda1b460c.png) ![在此处输入图像描述](../Images/829e9979377d9e5c0a7e3d189aeb55b4.png) ![在此处输入图像描述](../Images/b1217179adc54fe75de86f9755711ae6.png) ![在此处输入图像描述](../Images/e017e2bd93819cd93ff5347e52746a8e.png) ![在此处输入图像描述](../Images/c15c02a04ee7538353ee0f2046d4371a.png)

# java - Android按钮类返回不正确的值

> ID：11197999
> 
> 赞同：0
> 
> 时间：2012-06-25T22:00:52.130
> 
> 标签：java, android, windows, eclipse, class

我对 Android 开发和 Java 非常陌生。已阅读，但我在这个问题上没有任何进展。

我有一个按钮，单击该按钮应将变量 A 的值设置为“已购买项目”。但是，我只获得在类中首次定义变量时使用的值。

对于那些像我一样学习这方面的人 - 这个主题有望为那些刚开始学习的人提供很好的参考。

代码是：

```
public class shopView extends Activity
{

    String temp = "temp";

    @Override
    protected void onCreate(Bundle savedInstanceState) 
    {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.shopview);

        Button btnRef1 = (Button) findViewById(R.id.btnbtnRef11);
        final TextView ConfirmPurchasetest = (TextView) findViewById(R.id.tvMigName);

        btnRef1.setOnClickListener(new View.OnClickListener()
        {   
            @Override
            public void onClick(View v) {
                temp = "passed value";
                ConfirmPurchasetest.setText("item Purchased");
                buyFromShop();
                Log.v("after button push", "temp");
                };
        });

    }
    public String buyFromShop(){
        Log.v("button push", "after buy from shop");
        Log.v("temp variable",temp);
        return temp;
    }

} 
```

并使用以下方法调用：

```
shopcheckout = shop.buyFromShop();

Log.v("Value in myView",shopcheckout); 
```

预期：shopcheckout = “购买的商品” 实际：shopcheckout = “temp”

再次感谢任何答案。会积极关注这个帖子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T22:28:23.870

这正如预期的那样。你只打电话`buyFromShop`。该函数仅记录两条消息并返回`temp`。没有理由将 的值`temp`从其初始化值（即 ）更改`temp`。

只有在您正确创建活动（使用`startActivity`）并单击该活动和您对 的调用之间的按钮后`buyFromShop`，您才会看到`temp`. 在活动开始之前，按钮根本什么都不做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T22:38:56.287

除非您单击 Button `btnRef1`，否则 buyFromShop() 将始终返回“temp”。

如果您在 onCreate() 中添加此代码：

```
temp = "Changing the string."; 
```

现在 buyFromShop() 将返回“更改字符串。”。

如果您希望 buyFromShop() 返回 的值`ConfirmPurchasedtest`，请将您的代码更改为：

```
public class shopView extends Activity
{
    TextView confirmPurchaseTest;
    String temp = "temp";

    @Override
    protected void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.shopview);

        Button btnRef1 = (Button) findViewById(R.id.btnbtnRef11);
        confirmPurchaseTest = (TextView) findViewById(R.id.tvMigName);

        btnRef1.setOnClickListener(new View.OnClickListener()
        {   
            @Override
            public void onClick(View v) {
                temp = "passed value";
                confirmPurchaseTest.setText("item Purchased");
                buyFromShop();
                Log.v("after button push", "temp");
            }
        });
    }

    public String buyFromShop(){
        Log.v("button push", "after buy from shop");
        Log.v("temp variable", temp);

        // Change this!
        return confirmPurchaseTest.getText().toString();
    }

} 
```

**同样**根据命名约定，类名 like`shopView`应该每个单词的第一个字母大写；所以`ShopView`。像这样的变量`ConfirmPurchasetest`应该以小写开头，然后将每个单词大写（在第一个之后），所以`confirmPurchaseTest`.

希望有帮助！