# StackOverflow 问答 000841000-000841999

# oracle - Oracle，从 SQL-Plus 文件 x.sql 中调用 PL/SQL 问题说 my_function “可能不是函数”

> ID：841003
> 
> 赞同：3
> 
> 时间：2009-05-08T17:45:19.190
> 
> 标签：oracle, function, plsql, sqlplus

如此简单，如果我创建我的函数，因为`CREATE OR REPLACE FUNCTION MD5_ENCODE`它会顺利运行，但如果它以 PL/SQL 的形式匿名地留在 SQL-Plus 块中——>“可能不是函数”错误。

这个 Oracle 的“特性”又是什么？

```
DECLARE

FUNCTION MD5_ENCODE(CLEARTEXT IN VARCHAR2) RETURN VARCHAR2 IS    
    CHK VARCHAR2(16);   
    HEX VARCHAR2(32);  
    I   INTEGER;  
    C   INTEGER;  
    H   INTEGER;  
BEGIN
    IF CLEARTEXT IS NULL THEN
        RETURN '';
    ELSE
        CHK := DBMS_OBFUSCATION_TOOLKIT.MD5(INPUT_STRING
=> CLEARTEXT);
        FOR I IN 1 .. 16 LOOP
            C := ASCII(SUBSTR(CHK, I, 1));
            H := TRUNC(C / 16);
            IF H >= 10 THEN
                HEX := HEX || CHR(H + 55);
            ELSE
                HEX := HEX || CHR(H + 48);
            END IF;
            H := MOD(C, 16);
            IF H >= 10 THEN
                HEX := HEX || CHR(H + 55);
            ELSE
                HEX := HEX || CHR(H + 48);
            END IF;
        END LOOP;  
        RETURN HEX;  
    END IF;  

END;  

BEGIN  
    UPDATE ADDRESSES_T SET STREET = MD5ENCODE(STREET) ;  

-- etc...  
END 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T14:26:01.340

[http://forums.oracle.com/forums/thread.jspa?threadID=245112](http://forums.oracle.com/forums/thread.jspa?threadID=245112)

它可能有很多事情。

我的#1 候选人是，我们只能在公共的 SQL 语句中使用函数，即在包规范中声明。即使是在同一个包体中执行的 SQL 语句也是如此。原因是 SQL 语句由不同的引擎执行，该引擎只能看到公开声明的函数。

* * *

**长话短说**，*必须在包中定义函数，*例如 CREATE OR REPLACE FUNCTION MD5ENCODE(IN_TEXT IN VARCHAR2) RETURN VARCHAR2 IS ...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T18:12:56.360

为了在 SQL 语句中调用函数，它需要作为函数对象存在于数据库中。SQL 语句与您的 PL/SQL 代码分开解析和执行，因此它无法访问本地定义的函数。

如果你真的不想创建函数对象，你可以使用游标来遍历表中的行，在 PL/SQL 语句中执行函数，并随时更新每一行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T22:04:53.310

你的第一个问题是你有一个错字。

> 函数 MD5_ENCODE（VARCHAR2 中的明文）返回 VARCHAR2 是

相对

> UPDATE ADDRESSES_T SET STREET = MD5ENCODE(STREET) ;

您在更新语句的函数调用中缺少下划线。

您将遇到的下一个错误是：

```
PLS-00231: function 'MD5_ENCODE' may not be used in SQL 
```

因此，您可以简单地将函数结果分配给一个变量并在 Update 语句中使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-30T06:51:53.727

正如上面评论中提到的，这可能很有用。

```
DECLARE
  V NUMBER := 0;
  FUNCTION GET_SQ(A NUMBER) RETURN NUMBER AS
  BEGIN
    RETURN A * A;
  END;
BEGIN
  V := GET_SQ(5);
  --DBMS_OUTPUT.PUT_LINE(V);
  UPDATE MYTABLE A SET A.XCOL = V;
END; 
```

# sql - SQL Server 2000（创建给定日期范围的所有日期）

> ID：841005
> 
> 赞同：0
> 
> 时间：2009-05-08T17:45:36.117
> 
> 标签：sql, sql-server-2000

我想知道 SQL Server 2000 中是否有一种方法可以在给定开始和结束日期的情况下创建所有日期。我知道我可以通过 T-SQL 循环来实现这一点。我正在寻找一个非循环的解决方案。同样在 2005 中，您可以使用递归 with 子句。该解决方案还可以使用包含数字的 T 表与表连接。我再次查看 SQL Server 2000 非循环/使用 T 表解决方案。有没有？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T18:09:55.027

```
SELECT
     DATEADD(dy, T.number, @start_date)
FROM
     T
WHERE
     number BETWEEN 0 AND DATEDIFF(dy, @start_date, @end_date) 
```

日历表也可用于此类查询，您可以向其中添加一些特定于日期的信息，例如某一天是否为假日、是否算作“工作日”等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T18:16:26.213

尝试这个：

创建数字表，只需要在您的数据库中执行一次：

```
CREATE TABLE Numbers (Number int NOT NULL)
GO
ALTER TABLE Numbers ADD CONSTRAINT PK_Numbers PRIMARY KEY CLUSTERED (Number)
GO
DECLARE @x int
set @x=0
WHILE @X<8000
BEGIN
    SET @X=@X+1
    INSERT INTO Numbers VALUES (@x)
END 
```

--运行您的查询：

```
DECLARE @StartDate datetime
DECLARE @EndDate   datetime

set @StartDate='05/03/2009'
set @EndDate='05/12/2009'

SELECT
    @StartDate+Number-1
    FROM Numbers
    WHERE Number<=DATEDIFF(day, @StartDate, @EndDate)+1 
```

# spring - Spring JSP表单：输入标签将逗号放入int值

> ID：841006
> 
> 赞同：3
> 
> 时间：2009-05-08T17:45:37.580
> 
> 标签：spring, jsp

使用 Spring 2.5 标签库，

我在使用 <form:input path="budget" htmlEscape="true" /> 在我的页面上呈现的命令表单中有一个整数值

当值 > 999 时，它在页面上将数字呈现为 value="x,xxx"。我的验证不期望逗号并拒绝该值。

是否有渲染修复，或者我需要修复验证和解析？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T21:43:02.943

像往常一样，我只是瞎了眼，发现控制器中的命令表单绑定了一个自定义属性编辑器。它导致输入字段以逗号呈现。

如果没有 JavaScript 验证拒绝该字段中包含逗号，那会很好。

# git - 将 Git 与 Ant 集成的最佳方式？

> ID：841009
> 
> 赞同：48
> 
> 时间：2009-05-08T17:46:30.980
> 
> 标签：git, ant, integration

我正在寻找将 Git 与 Ant 集成的最佳方式。Git 是否有广泛使用的 Ant 任务？有没有人有通过 Ant 使用 Git 的经验（例如专用任务、执行调用等）？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2010-07-26T14:43:12.370

Ant 支持[exec 命令](http://ant.apache.org/manual/Tasks/exec.html)，您可以使用该命令将任何命令（包括 Git）传递到命令行以执行。你总是可以依靠它。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-08T17:58:11.030

看起来 Git 没有一组 Ant 任务。

[该博客](http://tlrobinson.net/blog/2008/11/13/ant-tasks-for-git/)讨论了使用 Git 的一些基本任务。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-07-06T15:19:45.760

这是通过 JGit 的 Git Ant 任务：http: [//aniszczyk.org/2011/05/12/git-ant-tasks-via-jgit/](http://aniszczyk.org/2011/05/12/git-ant-tasks-via-jgit/)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-03-28T11:21:00.927

[看看 JGit-Ant](http://wiki.eclipse.org/JGit/User_Guide#Ant_Tasks)。不幸的是[，jgit-ant](http://wiki.eclipse.org/JGit/User_Guide#Ant_Tasks)任务项目并没有所有主要的 git 操作，您可以[在此处](https://github.com/SergeyBoguckiy/jgit-ant-tasks)找到更多信息。

对于 java 开发人员：您可以使用[jgit](http://wiki.eclipse.org/JGit/User_Guide)轻松编写 git-ant-commands，如[本示例](https://github.com/SergeyBoguckiy/jgit-ant-tasks)中所示。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-06-22T01:25:54.533

看起来在 git 的 Ant 任务上做了一些额外的、非官方的工作：

*   [http://github.com/newtriks/Ant-Funk](http://github.com/newtriks/Ant-Funk)（和博客文章[http://www.newtriks.com/?p=910](http://www.newtriks.com/?p=910)）
*   [http://github.com/FrancisVarga/ant-git-macros](http://github.com/FrancisVarga/ant-git-macros)

我没有这些经验，但它们看起来比 tlrobinson 的更充实。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-04T08:10:43.420

将 JGit 库与一些`<script language="javascript">`代码结合使用（我使用了 Rhino 库，但您同样可以使用 Groovy 等）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-16T21:20:54.840

前段时间我没有成功地寻找集成 Git 和 Ant 的现成可用方法。我需要使用 Git 分支的名称创建构建的可能性。最后我得出了以下解决方案：

`build.xml`真实文件的摘录：

```
<target name="-check-git-branch-name"
    if="using.git"
    >
    <exec executable="bash" logError="true" failonerror="true"
        outputproperty="git-branch-name">
        <arg value="./bin/git-branch-name.sh" />
    </exec>
</target> 
```

文件的全部内容`./bin/git-branch-name.sh`

```
#!/bin/bash

# This script is the part of integration GIT to ANT. Once launched it 
# should return the name of the current branch or the current commit (if 
# GIT is the detached HEAD mode). Further the printed name is appended to 
# the name of the resulting directory. To initialize this feature you need 
# to run ANT with the option "-Dusing.git=". 

exec 2>/dev/null

git rev-parse --abbrev-ref HEAD | grep -v HEAD || git rev-parse HEAD 
```

调用类似于：

```
ant TARGET options -Dusing.git= 
```

声明时`${using.git}`，Ant 调用任务`-check-git-branch-name`来收集分支的名称（或如果 Git 处于分离模式，则为提交的编号）并生成带有 Git 分支的附加名称（或提交的 hnumber）的构建，例如`build/TARGET-${git-branch-name}`.

# windows-vista - 使您的 WinXP 应用程序与 Vista 兼容需要多长时间？

> ID：841010
> 
> 赞同：1
> 
> 时间：2009-05-08T17:46:35.817
> 
> 标签：windows-vista, compatibility

“你问的问题似乎很主观，很可能会被关闭。”
是的，这是一个主观问题。
它没有答案。

我只是想知道如果我是唯一的一个。
所以……痛吗？
我只是想听听一些意见。

捷豹

PS 当然，这一切都取决于应用程序的大小、编写的语言、编程习惯的好坏等等……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T17:50:23.873

非常痛苦，而且花费数天甚至数周的时间......

我们有很多围绕会话和 IPC 的代码。所以我们受到了[session 0 isolation](http://www.microsoft.com/whdc/system/vista/services.mspx)变化的影响。

对于 Vista x64 和 2008 x64，我们还有一些驱动程序组件现在需要使用[验证](http://www.microsoft.com/whdc/system/vista/services.mspx)码进行数字签名。这不是以前的要求。

我们还遇到了一些问题，因为我们的一些应用程序没有清单文件来指定它们需要作为提升的进程运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T17:52:46.690

我不得不将一些注册表项从 HKLM 移动到 HKCU - 仅此而已 - 我对此感到非常高兴。大约一两个小时。从发现它到我们修复它并在源代码树中不到一天的时间。不确定该 C++ 应用程序的行数。

不是很大，但不是微不足道的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T19:29:52.683

Not much. I worked primarily on a large app written in C++ and MFC. We moved to VS 2008 before Vista (waiting for VS 2008 SP1, which saved a lot of trouble), and most things just simply worked. There was one external library I found a slight problem with (compensating for old VC++ problems), but no big deal.

Except for a routine to grab a window and put it into JPEG format, which I narrowed down to a small stretch of standard code that was vetted by competent people both here and on the MSDN forum. Eventually, that problem went away on my computer, so I couldn't pursue it, but it has cropped up on others.

So, I never know when the goblins are going to come and take the JPEGs away, but other than that the transition to Vista was smooth.

# php - 嵌套集、php 数组和转换

> ID：841014
> 
> 赞同：5
> 
> 时间：2009-05-08T17:46:47.767
> 
> 标签：php, arrays, nested-sets

我需要将此空间树的嵌套集结构（mysql）转换为 json 1）[http://blog.thejit.org/wp-content/jit-1.0a/examples/spacetree.html](http://blog.thejit.org/wp-content/jit-1.0a/examples/spacetree.html)

我发现这个函数可以从嵌套集创建一个数组：2）[http://semlabs.co.uk/journal/converting-nested-set-model-data-in-to-multi-dimensional-arrays-in-php](http://semlabs.co.uk/journal/converting-nested-set-model-data-in-to-multi-dimensional-arrays-in-php)

我还可以使用 PHP 函数 json_encode 将 php 数组转换为 json

我的问题：函数nestify（来自第二个链接）给了我不完全是我需要的。我需要这样的东西：http: [//pastebin.com/m68752352](http://pastebin.com/m68752352)

你能帮我改变“嵌套”函数，让它给我正确的数组吗？

再来一次这个函数：

```
function nestify( $arrs, $depth_key = 'depth' )
    {
        $nested = array();
        $depths = array();

        foreach( $arrs as $key => $arr ) {
            if( $arr[$depth_key] == 0 ) {
                $nested[$key] = $arr;
                $depths[$arr[$depth_key] + 1] = $key;
            }
            else {
                $parent =& $nested;
                for( $i = 1; $i <= ( $arr[$depth_key] ); $i++ ) {
                    $parent =& $parent[$depths[$i]];
                }

                $parent[$key] = $arr;
                $depths[$arr[$depth_key] + 1] = $key;
            }
        }

        return $nested;
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-20T09:00:01.163

以下片段应该可以解决问题，改编自我在网上找到的一些 PHP Doctrine 代码：

```
function toHierarchy($collection)
{
        // Trees mapped
        $trees = array();
        $l = 0;

        if (count($collection) > 0) {
                // Node Stack. Used to help building the hierarchy
                $stack = array();

                foreach ($collection as $node) {
                        $item = $node;
                        $item['children'] = array();

                        // Number of stack items
                        $l = count($stack);

                        // Check if we're dealing with different levels
                        while($l > 0 && $stack[$l - 1]['depth'] >= $item['depth']) {
                                array_pop($stack);
                                $l--;
                        }

                        // Stack is empty (we are inspecting the root)
                        if ($l == 0) {
                                // Assigning the root node
                                $i = count($trees);
                                $trees[$i] = $item;
                                $stack[] = & $trees[$i];
                        } else {
                                // Add node to parent
                                $i = count($stack[$l - 1]['children']);
                                $stack[$l - 1]['children'][$i] = $item;
                                $stack[] = & $stack[$l - 1]['children'][$i];
                        }
                }
        }

        return $trees;
} 
```

# visual-studio-2008 - 带有 Visual Studio 2008 的 SharePoint 2007 x64 工作流？

> ID：841015
> 
> 赞同：4
> 
> 时间：2009-05-08T17:47:00.590
> 
> 标签：visual-studio-2008, sharepoint, workflow, 64-bit

我有 64 位 SharePoint 2007 的开发环境。我尝试使用 Visual Studio 2008 创建 SharePoint 工作流，但收到错误消息“未安装 32 位版本的 SharePoint Server。请安装 32 位版本的 SharePoint Server”。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T18:12:09.547

我很快就会遇到类似的情况，自从我在博客文章中听说这个问题以来，我一直在提前研究这个问题。您显然仍然可以在 32 位下开发，然后将其移至 64 位服务器。

看来问题确实出在 Sharepoint Extensions 中......所以如果您不使用它们（即 SharePoint 2007 顺序工作流或 SharePoint 2007 状态机工作流项目），而[只是创建一个工作流项目，它似乎有更好的成功一些](http://sharepointsharpener.wordpress.com/2009/01/12/developing-workflows-not-possible-on-64-bit-sharepoint/)。（查看帖子的评论）

[这是 Microsoft Connect 上跟踪的错误](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=325668)，一些 VS 团队成员提供了一个“解决方法”，这基本上是我第一次提到的。

归根结底，微软认为这是他们的“展示品”，他们正在将人们推向 64 位平台。再过两个星期，我应该会感觉到这一点，如果我想出更多内容，我会回复。祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T18:40:01.430

是的，同意柯蒂斯克。因为我无法使用这些扩展，所以我今天花了很多时间为 SharePoint 开发通用 Windows 工作流。您在部署的便利性方面有所损失，但有很多资源可以帮助您手动执行此操作。这对我有用（至少它的部署部分）： -

[http://blah.winsmarts.com/2008-7-Authoring_SharePoint_2007_Workflows_using_VS2008.aspx](http://blah.winsmarts.com/2008-7-Authoring_SharePoint_2007_Workflows_using_VS2008.aspx)

请注意，在我的例子中，我使用的是 32 位 Windows 2003 VM，但托管在 64 位虚拟服务器上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T18:41:56.853

我刚才也有同样的问题。我发现 STSDEV 具有确切的项目类型作为选项。

所以使用[STSDEV](http://www.codeplex.com/stsdev)来创建这种项目。由于它在带有 VseWSS 2008 的 64 位 Win2k3 中被破坏，因此最好使用 STSDEV。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T18:44:22.743

我们通过在 SharePoint 设计器中设计工作流来解决此问题，然后在使用 VseWSS 通过 Visual Studio 进行部署时将它们捆绑并包含在 WSP 中。

PS：SharePoint Designer 现在是免费产品。

# javascript - 如何预加载整个网页

> ID：841020
> 
> 赞同：4
> 
> 时间：2009-05-08T17:48:30.507
> 
> 标签：javascript, html, preload, yslow

如何使用 JavaScript 预加载整个网页，以便我可以将该页面缓存在用户浏览器中？

**我知道如何用 JS 预加载图像，但我想做的是预加载整个页面。**

用例：在我的网站上，我有一个包含许多其他内容（图像、css、JS）的谷歌地图页面，从非缓存浏览器加载需要很长时间（大约 10 秒）。

这是我主页的子页面，用户通常会访问此页面。所以我想要做的是尽可能多地用所有加载的内容（图像，JS）预加载整个页面，以便将其缓存在用户浏览器中，以便当他们来到该页面时 - 它加载得更快。从缓存的浏览器加载页面将时间从大约 10 秒缩短到 2 秒。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-08T17:50:48.787

`<iframe src="second_page.html">`在主页上创建一个不可见或非常小的。

# cocoa - Cocoa：插入点当前在哪个 NSTextView 中闪烁？

> ID：841024
> 
> 赞同：1
> 
> 时间：2009-05-08T17:49:42.563
> 
> 标签：cocoa, text

给定一个 NSApp 对象（又名 [NSApplication sharedApplication]），如何获取当前活动的 NSTextView，其中插入点现在正在闪烁（如果有的话）？:-)

我可以去 [[NSApp keyWindow] contentView] 并尝试遍历整个视图层次结构，但这似乎太难了。理想的代码是：[NSAppfocusedTextView]。

我为一个应用程序和一个窗口尝试了 firstResponder，还尝试了 fieldEditor:forObject:，但这并没有返回任何有趣的东西（至少对我而言）。

顺便说一句，如果有人知道如何获取系统范围的当前文本视图，那就更酷了（Accessibility API 不起作用：它不会返回 Cocoa NSTextView）。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T19:16:39.047

该`-firstResponder`函数返回字段编辑器。因此，如果您想要真正的视图，您可能需要检查第一响应者的委托才能获得它。另请参阅[字段编辑器](http://developer.apple.com/documentation/Cocoa/Conceptual/TextArchitecture/Concepts/TextFieldsAndViews.html#//apple_ref/doc/uid/20001799-50168)了解详细信息。

可能无法将其作为 NSTextViews 获得系统范围，因为该对象通常位于不同的进程空间中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T20:26:57.507

> 顺便说一句，如果有人知道如何获取系统范围的当前文本视图，那就更酷了（Accessibility API 不起作用：它不会返回 Cocoa NSTextView）。

不可能。NSTextViews 是每个进程的；如果没有其他进程通过 NSConnection 为它提供服务，您将无法从另一个进程获取 NSTextView 的代理。你只需要使用辅助功能。

从好的方面来说，使用 Accessibility 意味着您的应用程序（理论上）也应该与使用 MLTE/HITextView 的 Carbon 应用程序一起使用。

# c# - 具有自动属性的只读列表

> ID：841034
> 
> 赞同：0
> 
> 时间：2009-05-08T17:52:33.353
> 
> 标签：c#, .net, c#-3.0

有没有办法用自动属性做到这一点？

```
private IList<string> List;
    public IList<String> list
    {
        get { return List.ToList().AsReadOnly(); }
        set { List = value; }
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-08T17:55:30.897

不，那里没有。自动属性只是将简单的返回和赋值语句包装在支持字段周围。唯一允许的自定义是可访问性。如果你想做除了最基本的属性之外的任何事情，你需要使用完整的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-01T08:48:40.210

尝试这个

私人 IList 列表；公共 IList 列表 { 获取 { 返回 List.ToList().AsReadOnly(); } 私有集 { 列表 = 值；} }

# c++ - 大型缓冲区与大型静态缓冲区，有优势吗？

> ID：841038
> 
> 赞同：4
> 
> 时间：2009-05-08T17:54:03.020
> 
> 标签：c++, optimization, performance

考虑以下代码。

在 1000 次连续执行中，DoSomething1() 是否比 DoSomething2() 更快？我会假设如果我在哪里调用 DoSomething1() 它 1000 次它会更快然后调用 DoSomething2() 它 1000 次。

将所有大型缓冲区设为静态有什么缺点吗？

```
#define MAX_BUFFER_LENGTH 1024*5 
void DoSomething1()
{
    static char buf[MAX_BUFFER_LENGTH] ; 
    memset( buf, 0, MAX_BUFFER_LENGTH );
}

void DoSomething2()
{
    char buf[MAX_BUFFER_LENGTH] ; 
    memset( buf, 0, MAX_BUFFER_LENGTH );
} 
```

感谢您的时间。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-08T17:56:19.617

**静态缓冲区的缺点：**

*   如果您需要线程安全，那么使用静态缓冲区可能不是一个好主意。
*   直到程序结束才会释放内存，从而使您的内存消耗更高。

**静态缓冲区的优点：**

*   静态缓冲区的分配较少。您不需要每次都在堆栈上分配。
*   使用静态缓冲区，由于分配太高而导致堆栈溢出的可能性较小。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-08T18:05:50.013

如果您在 VC++ 编译器中启用了 /GS，则堆栈分配会稍微昂贵一些，这会启用缓冲区溢出的安全检查（默认情况下 /GS 是打开的）。真的，您应该分析这两个选项，看看哪个更快。静态内存中的缓存位置与堆栈中的缓存位置可能会有所不同。

这是非静态版本，带有 /O2 的 VC++ 编译器。

```
_main   PROC                        ; COMDAT
; Line 5
    mov eax, 5124               ; 00001404H
    call    __chkstk
    mov eax, DWORD PTR ___security_cookie
    xor eax, esp
    mov DWORD PTR __$ArrayPad$[esp+5124], eax
; Line 7
    push    5120                    ; 00001400H
    lea eax, DWORD PTR _buf$[esp+5128]
    push    0
    push    eax
    call    _memset
; Line 9
    mov ecx, DWORD PTR __$ArrayPad$[esp+5136]
    movsx   eax, BYTE PTR _buf$[esp+5139]
    add esp, 12                 ; 0000000cH
    xor ecx, esp
    call    @__security_check_cookie@4
    add esp, 5124               ; 00001404H
    ret 0
_main   ENDP
_TEXT   ENDS 
```

这是静态版本

```
;   COMDAT _main
_TEXT   SEGMENT
_main   PROC                        ; COMDAT
; Line 7
    push    5120                    ; 00001400H
    push    0
    push    OFFSET ?buf@?1??main@@9@4PADA
    call    _memset
; Line 8
    movsx   eax, BYTE PTR ?buf@?1??main@@9@4PADA+3
    add esp, 12                 ; 0000000cH
; Line 9
    ret 0
_main   ENDP
_TEXT   ENDS
END 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-08T17:57:43.357

两者之间几乎没有任何速度差异。在堆栈上分配缓冲区非常快——它只是将堆栈指针递减一个值。但是，如果您在堆栈上分配了一个非常大的缓冲区，那么您可能会溢出堆栈并导致段错误/访问冲突。相反，如果您有很多静态缓冲区，您将大大增加程序的工作集大小，尽管如果您有良好的参考局部性，这会有所缓解。

另一个主要区别是堆栈缓冲区是线程安全的和可重入的，而静态缓冲区既不是线程安全的也不是可重入的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-09T10:26:27.863

我是这里唯一一个从事多线程软件的人吗？在这种情况下，静态缓冲区是绝对不行的，除非您想投入大量的性能削弱锁定和解锁。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-09T07:22:12.407

您还可以考虑将您的代码放入一个类中。例如像

```
const MAX_BUFFER_LENGTH = 1024*5; 
class DoSomethingEngine {
  private:
    char *buffer;
  public:
    DoSomethingEngine() {
      buffer = new buffer[MAX_BUFFER_LENGTH];
    }
    virtual ~DoSomethingEngine() {
       free(buffer);
    }
    void DoItNow() {
       memset(buffer, 0, MAX_BUFFER_LENGTH);
       ...
    }
} 
```

如果每个胎面只分配自己的引擎，这是胎面安全的。它避免了在堆栈上分配大量内存。堆上的分配是一个很小的开销，但如果你多次重用类的实例，这可以忽略不计。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T16:49:57.080

正如其他人所说，堆栈分配非常快，对于更复杂的对象，例如 ArrayList 或 HashTable（现在是通用世界中的 List<> 和 Dictionary<,>），每次不必重新分配的加速可能更大是每次运行的构造代码，如果容量设置不正确，那么每次容器达到容量时都会进行不必要的重新分配，并且必须分配新内存并将内容从旧内存复制到新内存。这我经常有工作的 List<> 对象，我允许它们增长到所需的任何大小，并通过调用 Clear() 重用它们 - 这使分配的内存/容量保持不变。但是，如果您有一个 rouge 调用碰巧分配了很多不经常发生或仅发生一次的内存，那么您应该警惕内存泄漏。

# vs-extensibility - Visual Studio - 我可以通过命令行导出模板吗？

> ID：841039
> 
> 赞同：7
> 
> 时间：2009-05-08T17:54:12.100
> 
> 标签：vs-extensibility, visual-studio-templates

是否可以从任何地方的命令行使用“导出模板”功能？我检查了 MSBuild.exe 和 devenv.exe 的命令行参数，没有看到任何明显的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T18:33:35.437

[如何：使用 Projectgen.exe 命令行工具创建项目模板](http://msdn.microsoft.com/en-us/library/cc175876.aspx)

# iphone - 检测 UITableViewCell 何时离开屏幕

> ID：841042
> 
> 赞同：30
> 
> 时间：2009-05-08T17:54:59.197
> 
> 标签：iphone, uitableview

我正在使用自定义创建的 UITableViewCell 实现一个丰富的 UITableView，我以一种方式在屏幕上显示它们，但是一旦它们离开屏幕我想记下这一点，因为它们第二次出现我希望它们以不同的方式显示。离开屏幕时认为自动“标记为已读”。

我一直在寻找某种方法来检测单元格何时离开屏幕（获取释放或出列或等效），最好在 :UITableViewController 类中快速记下 [indexPath 行]，但在： UITableViewCell 同样好。

我无法以任何标准方式做到这一点......计算它出现的次数似乎是不可能的，因为我在桌子上进行了多次 reloadData 调用。

有人有什么想法吗？这似乎有点棘手:)

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2013-04-12T21:02:35.123

这是一个老问题，但如果有人正在寻找，在 iOS6 中，引入了一个新的 UITableViewDelegate 函数，它就是这样做的：

```
- (void)tableView:(UITableView *)tableView didEndDisplayingCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath 
```

它可以很好地告诉您何时删除单元格，但是，它非常彻底，因此如果您重新加载单元格，即使是被替换的旧单元格也会触发此委托功能。在我的实现中，我只是检查`indexPath`传递的是否仍在数组`tableView.indexPathsForVisibleRows`中。就像是：

```
- (void)tableView:(UITableView *)tableView didEndDisplayingCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if ([tableView.indexPathsForVisibleRows indexOfObject:indexPath] == NSNotFound)
    {
        // This indeed is an indexPath no longer visible
        // Do something to this non-visible cell...
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-11T16:21:33.663

我想你可以使用

```
- (NSArray *)visibleCells 
```

你的 UITableView 的方法。这将返回一个包含所有可见单元格的数组。然后，您可以以您想要的方式标记任何“不可见”（即不在此数组中）的数据，这样当您滚动回它时，它已被更新。

希望有帮助

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-20T04:08:21.453

一旦`UITableViewCell`不可见，它将从`UITableView`. 您可以覆盖方法`-(void)removeFromSuperView`，并在方法中执行某些操作。最后，别忘了打电话`[super removeFromSuperView]`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-15T10:25:05.503

`prepareForReuse`Andrey Tarantsov 提到的 UITableViewCell 上的方法看起来不错。在其中放置几个​​ NSLog 可以让您打印出单元格的任何变量的值。关于如何将其设置回表格视图控制器的任何想法？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-11T21:19:59.450

您确定屏幕外的单元格正是您想要捕捉的吗？如果您想将项目标记为已读，这似乎不是正确的方法。例如，我可能会非常快速地滚动表格，如果您将所有内容都标记为已读，我会感到非常惊讶。

至于技术部分，只需保留屏幕上的单元格列表（cellForRowAtIndexPath 应该将单元格添加到该列表中），并在`scrollViewDidScroll`委托方法中检查它们是否不再可见。

另一个可能的想法：我记得`prepareForReuse`细胞上有方法。不过，不确定它何时被调用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-09-06T18:29:47.697

我知道这是一个非常古老的问题，但如果有人正在寻找**Swift 5**的答案：

```
func tableView(_ tableView: UITableView, didEndDisplaying cell: UITableViewCell, forRowAt indexPath: IndexPath) {
    <#code#>
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T21:22:00.417

我想我会尝试定期检查 UITableView 的 indexPathsForVisibleRows 属性。从最大的索引路径中，您可以推断出所有先前的行都已滚动过去。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-29T05:16:24.877

我需要从单元格中获取一些数据，因为它从屏幕上滚动出来。我使用了[@Mr.T 的答案](https://stackoverflow.com/a/15980777/4833705)，但它没有说明如何获取数据。

例如，我正在使用的单元类的名称是`MyCell`，它有一个名为 MyModel 的数据模型，其属性为 postId。我最初将该信息设置在`cellForItem`：

```
var datasource = [MyModel]()

func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {
    let cell = collectionView.dequeueReusableCell(withReuseIdentifier: cellId, for: indexPath) as! MyCell

    cell.myModel = datasource[indexPath.item] // an individual instance of MyModel from the array

    print("cellForItem - indexPath.item: ", indexPath.item) // if the was the very first cell coming on it would print 0
    print("postId: ", cell.myModel.postId) // maybe the postId is qwerty

    return
} 
```

**要在单元格滚动出**屏幕时从单元格中获取一些数据：

```
func collectionView(_ collectionView: UICollectionView, didEndDisplaying cell: UICollectionViewCell, forItemAt indexPath: IndexPath) {

    guard let myCell = cell as? MyCell else { return } // You must cast the cell from the method param to your cell type which for me is MyCell

    print("didEndDisplayingCell - indexPath.item: ", indexPath.item) // if this was the very first cell scrolling off it should print 0
    print("postId: ", myCell.myModel.postId) // the postId should be qwerty
} 
```

测试这一点的最佳方法是向您的 collectionView 添加少量单元格，例如前 2 个单元格，然后是 3 个单元格，然后是 4 个单元格。然后只需滚动第一个单元格并查看打印的内容。为每个单元格执行此操作。indexPath.item 和 postId 应该都匹配`cellForItem`和`didEndDisplaying`。

# delphi - 如何在 Delphi 2009 重定向控制台（stin，sterr）？

> ID：841047
> 
> 赞同：3
> 
> 时间：2009-05-08T17:57:09.690
> 
> 标签：delphi, delphi-2009

我在互联网上尝试了几个示例，但都没有工作-脚本未执行-（可能是因为用于 Delphi 2009 之前的 unicode？）。

我需要运行一些 python 脚本并将参数传递给它们，例如：

```
python "..\Plugins\RunPlugin.py" -a login -u Test -p test 
```

并将输出捕获到字符串并将错误捕获到其他。

这就是我现在所拥有的：

```
procedure RunDosInMemo(DosApp:String; var OutData: String);
var
  SA: TSecurityAttributes;
  SI: TStartupInfo;
  PI: TProcessInformation;
  StdOutPipeRead, StdOutPipeWrite: THandle;
  WasOK: Boolean;
  Buffer: array[0..255] of Char;
  BytesRead: Cardinal;
  WorkDir: string;
  Handle: Boolean;
begin
  OutData := '';
  with SA do begin
    nLength := SizeOf(SA);
    bInheritHandle := True;
    lpSecurityDescriptor := nil;
  end;
  CreatePipe(StdOutPipeRead, StdOutPipeWrite, @SA, 0);
  try
    with SI do
    begin
      FillChar(SI, SizeOf(SI), 0);
      cb := SizeOf(SI);
      dwFlags := STARTF_USESHOWWINDOW or STARTF_USESTDHANDLES or CREATE_UNICODE_ENVIRONMENT;
      wShowWindow := SW_HIDE;
      hStdInput := GetStdHandle(STD_INPUT_HANDLE); // don't redirect stdin
      hStdOutput := StdOutPipeWrite;
      hStdError := StdOutPipeWrite;
    end;
    WorkDir := 'C:\';
    Handle := CreateProcess(nil, PChar(DosApp),
                            nil, nil, True, 0, nil,
                            PChar(WorkDir), SI, PI);
    CloseHandle(StdOutPipeWrite);
    if Handle then
    begin
      try
        repeat
          WasOK := ReadFile(StdOutPipeRead, Buffer, 255, BytesRead, nil);
          if BytesRead > 0 then
          begin
            Buffer[BytesRead] := #0;
            OutData := OutData + String(Buffer);
          end;
        until not WasOK or (BytesRead = 0);
        WaitForSingleObject(PI.hProcess, INFINITE);
      finally
        CloseHandle(PI.hThread);
        CloseHandle(PI.hProcess);
      end;
    end else begin
      raise Exception.Create('Failed to load python plugin');
    end;
  finally
    CloseHandle(StdOutPipeRead);
  end;
end; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T19:11:09.920

`Create_Unicode_Environment`是一个**进程创建标志**`dwCreationFlags`，用于`CreateFile`. 它不是用于`TStartupInfo`记录的标志。如果你给 API 函数提供他们不理解的标志值，API 函数很可能会失败，如果你给他们提供的标志值与你预期的不同，它们很可能会做奇怪的事情。

您声明一个 256`Char`秒的缓冲区；回想一下，`Char`在 Delphi 2009 中是 2 字节的 Unicode 类型。然后，您调用`ReadFile`并告诉它缓冲区的长度为 255*个字节*，而不是实际值 512。当文档说值是字节数时，将其作为使用该`SizeOf`函数的提示。

由于`ReadFile`读取字节，最好将缓冲区数组声明为字节大小的元素数组，例如`AnsiChar`. 这样，当您设置 时`Buffer[BytesRead]`，您将不会包含实际读取的数据的两倍。

Unicode 版本`CreateProcess`可能会修改其命令行参数。您必须确保传递给该参数的字符串的引用计数为 1。在调用`UniqueString(DosApp)`之前调用`CreateProcess`。

当 API 函数失败时，您当然会想知道原因。不要随便*编一个*理由。使用提供的功能，例如`Win32Check`和`RaiseLastOSError`。至少， call `GetLastError`，就像 MSDN 告诉你的那样。当有更具体的异常类型可用时，不要抛出通用异常类型。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T18:32:06.957

我不确定 WaitForSingleObject 是要走的路...我认为最好使用 GetExitCodeProcess(pi.hProcess,iExitCode) 循环，直到 iExitCode <> STILL_ACTIVE 然后在每次通过循环时检查数据。

所编写的代码也不能在 Delphi 2007 下运行，因此它不是 Delphi 2009 unicode 问题。

将您的内部循环更改为以下工作：

```
if Handle then
begin
  try
    repeat
      WasOK := ReadFile(StdOutPipeRead, Buffer, 255, BytesRead, nil);
      for ix := 0 to BytesRead-1 do
        begin
          OutData := OutData + AnsiChar(Buffer[ix]);
        end;
      GetExitCodeProcess(pi.hProcess,iExit);
    until (iExit <> STILL_ACTIVE);
  finally
    CloseHandle(PI.hThread);
    CloseHandle(PI.hProcess);
  end; 
```

我对局部变量进行了以下更正/添加：

```
Buffer: array[0..255] of byte;
iExit : Cardinal;
IX : integer; 
```

我还在 StdOutPipeRead 关闭之前移动了 CloseHandle(StdOutPipeWrite)。

# ruby-on-rails - Rails、ActiveResource 和分页

> ID：841048
> 
> 赞同：4
> 
> 时间：2009-05-08T17:57:24.120
> 
> 标签：ruby-on-rails, pagination, activeresource

在 REST API 中实现分页以便 ActiveResource 客户端可以轻松导航分页结果的最佳方法是什么？有一些建议，例如[here](http://rubyroyd.com/2009/02/12/activeresource-pagination)和[here](http://bashmynonsense.blogspot.com/2008/05/pagination-with-activeresource.html)，但是对于 ActiveResource 来说是新手，我想知道是否有更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-02-15T21:14:17.070

我用 kaminari 和一些补丁对 activeresource 做到了，这里是 gem 的例子 [https://github.com/Fivell/activeresource-response](https://github.com/Fivell/activeresource-response)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T18:28:26.937

我还没有机会深入研究这个项目，但是[Will_Paginate 的这个分支](http://github.com/larrytheliquid/will_paginate/tree/master)可能对你有用。它增加了`paginate`对 ActiveResource 方法的支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-16T16:43:54.487

我们已经发布了一个由我们构建的 gem，它基于一个非常高流量的 Rails 应用程序中的生产内容。它通过将 current_page、per_page 和 total_entries 作为属性添加到序列化集合 XML 的根节点来透明地启用分页（如果您使用 LibXML 或 Nokogiri，我强烈推荐使用默认的 REXML，并且速度非常快）。

这是[PoxPaginate 的 GitHub 项目的链接](http://github.com/c42/pox_paginate)。

# python - 如何在没有音频库的情况下编辑原始 PCM 音频数据？

> ID：841049
> 
> 赞同：9
> 
> 时间：2009-05-08T17:57:25.243
> 
> 标签：python, audio, binary, wav

我对精确提取 PCM WAV 文件的部分感兴趣，直到样本级别。大多数音频模块似乎都依赖于特定于平台的音频库。我想让这个跨平台和速度不是问题，有没有可以做到这一点的本机 python 音频模块？

如果没有，我将不得不解释 PCM 二进制文件。虽然我确信我可以相当容易地挖掘 PCM 规范，并且原始格式很容易理解，但我以前从未真正处理过 Python 中的二进制数据。有没有很好的资源可以解释如何做到这一点？特别与音频有关的只是结冰。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T19:15:37.147

我阅读了问题和答案，我觉得我一定遗漏了一些完全明显的东西，因为没有人提到以下两个模块：

*   [audioop](https://docs.python.org/library/audioop.html) : 操作原始音频数据
*   [wave](https://docs.python.org/library/wave.html) : 读写WAV文件

也许我来自平行宇宙，Guido 的时间机器实际上是一个时空机器 :)

如果您需要示例代码，请随时询问。

PS 假设 48kHz 采样率，24/1.001==23.976023976... fps 的视频帧是 2002 个音频样本长，而在 25fps 时它是 1920 个音频样本长。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-08T18:28:15.123

我只用 C++ 和 Java 编写了一个 PCM 阅读器，但格式本身相当简单。可以在这里找到一个不错的描述：http: [//ccrma.stanford.edu/courses/422/projects/WaveFormat/](http://ccrma.stanford.edu/courses/422/projects/WaveFormat/)

过去，您应该能够将其读取（二进制文件读取，[http://www.johnny-lin.com/cdat_tips/tips_fileio/bin_array.html](http://www.johnny-lin.com/cdat_tips/tips_fileio/bin_array.html)）并处理生成的数组。您可能需要使用一些位移来获得正确的对齐方式（[https://docs.python.org/reference/expressions.html#shifting-operations](https://docs.python.org/reference/expressions.html#shifting-operations)），但根据您的阅读方式，您可能不需要。

综上所述，我仍然倾向于大卫的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T18:11:09.517

你的解决方案是纯 Python 真的很重要，还是你会接受可以在各种平台上使用原生音频库的东西（所以它实际上是跨平台的）？[在http://wiki.python.org/moin/PythonInMusic](http://wiki.python.org/moin/PythonInMusic)有后者的几个例子

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T18:20:07.873

似乎 open(..., "rb")、[struct module](http://docs.python.org/library/struct.html)和有关[wav/riff 文件格式](http://ccrma.stanford.edu/courses/422/projects/WaveFormat/)的一些细节（可能是更好的参考）的组合可以完成这项工作。

只是好奇，您打算如何处理原始样本数据？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-28T18:46:59.543

我正在查找这个，我发现了这个：[http](http://www.swharden.com/blog/2009-06-19-reading-pcm-audio-with-python/) : //www.swharden.com/blog/2009-06-19-reading-pcm-audio-with-python/ 它需要 Numpy（如果你想绘制它，还需要 matplotlib )

```
import numpy
data = numpy.memmap("test.pcm", dtype='h', mode='r')
print "VALUES:",data 
```

查看原作者的网站了解更多详情。

# asp.net - ASP.NET 身份验证和提供程序

> ID：841052
> 
> 赞同：1
> 
> 时间：2009-05-08T17:57:53.043
> 
> 标签：asp.net, authorization, sqlmembershipprovider

我正在尝试从本地主机上的一个网站导航到本地主机上的第二个网站。

这两个网站都有自己的会员提供商。我正在尝试使用来自站点 #1 的 FormsAuthorizationTicket 将用户 SSO 到站点 #2。

目前我收到此错误： System.Security.Cryptography.CryptographicException: Padding is invalid and cannot be removed

到目前为止，我采取的步骤包括： 将元素设置为特定的密钥值 将验证和加密的 machineKey 属性设置为“3DES” 通过记录验证加密票证在 #2 网站中的值与在排名第一的网站。

* * *

我的代码在这里：

```
 *FormsAuthentication.Initialize();
        FormsAuthenticationTicket newTicket = new 
            FormsAuthenticationTicket(1 // Ticket Version
            , Login1.UserName                       // User Name
            , DateTime.Now                          // Creation Date
            , DateTime.Now.AddDays(1)   // Expiration Date
            , true                                              // Is Persistant
            , Login1.UserName);                 // This should be a list of Roles

        string strEncyptedTicket = FormsAuthentication.Encrypt(newTicket);
        HttpCookie myCookie = new HttpCookie("cryptCookie", strEncyptedTicket);
        myCookie.Values.Add("username", Login1.UserName);
        myCookie.Values.Add("cryptTick", strEncyptedTicket);
        Response.Cookies.Add(myCookie);* 
```

* * *

在网站 #2 中，我创建了一个登录页面来验证票证并重定向到仅限会员的页面。解密期间是我收到上面指定的错误。

这是我在网站 #2 上的着陆页代码：

* * *

```
 *FormsAuthenticationTicket fat2 = FormsAuthentication.Decrypt(Request.Cookies["cryptCookie"].Values["cryptTick"]);

        MembershipUser mu = Membership.GetUser(Request.Cookies["cryptCookie"].Values["username"]);
        if (mu == null)
        {
            lblInfo.Text += "member not found";
            return;
        }

        Response.Redirect(@"~\MemberPages\MemberPage.aspx");* 
```

如果有人有帮助的想法，我会很乐意尝试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T18:13:41.307

两个站点需要共享相同的[机器密钥](http://msdn.microsoft.com/en-us/library/ms998288.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T18:21:01.710

Ian 是正确的，因为您的站点需要有匹配的机器密钥。此外，您需要确保您的会员提供商具有相同的设置，尤其是在密码加密方面。

另外，你为什么要在代码中完全处理这个？您应该能够使用两个站点的 Web.Config 非常轻松地配置此功能。从本质上讲，您正在做大量的返工并在不必要的地方引入潜在的问题区域（除非您有理由在此处未说明）。

# iphone - 相对简单的应用程序使用哪种数据模型策略？

> ID：841056
> 
> 赞同：1
> 
> 时间：2009-05-08T17:58:47.377
> 
> 标签：iphone

对于操作存储日期/时间和其他一些值的对象的相对简单的应用程序？我应该使用属性列表吗？归档？还是sqlite？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T18:33:21.787

Plists 是保存数据的最简单方法。使用集合类中的内置保存方法（NSarray、NSDict 等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T21:01:19.967

您可能想看看[NSUserDefaults](http://developer.apple.com/iphone/library/documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html)。

# sqlite - 如何列出所有表或仅列出给定数据库的表

> ID：841057
> 
> 赞同：0
> 
> 时间：2009-05-08T17:58:49.860
> 
> 标签：sqlite, metadata, database-schema

您可以使用获取数据库列表

```
PRAGMA database_list 
```

或使用“主”数据库中的表列表

```
select name from sqlite_master where type='table' 
```

但正如我刚刚写的那样，它只返回“主”数据库中的表，而且我看不到知道哪些表在其他数据库中的方法。

那么如何列出其他数据库中的表（稍后附上）？

谢谢，--DD

PS：我可以想到一种解决方法，为通过 pragma database_list 列出的每个数据库创建一个单独的 sqlite*，然后他们在这些数据库上执行 N 次“从 sqlite_master 中选择名称”（因为每个都是现在是“主要”），但这听起来应该是可能的，无需求助于解决方法，不是吗？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T18:57:33.167

啊啊，通过查看[How do I open an in-memory database file into sqlite3的答案找到了答案](https://stackoverflow.com/questions/837067/how-do-i-open-an-in-memory-database-file-into-sqlite3)

由于*每个*数据库都有一个 sqlite_master，所以我需要做的就是在 sqlite_master 前面加上“DB_name”。其中 DB_name 对应于 PRAGMA database_list 返回的名称列。

# jquery - 是否可以使用 JQuery 选择页面上的所有浮点数？

> ID：841059
> 
> 赞同：5
> 
> 时间：2009-05-08T17:59:17.487
> 
> 标签：jquery

我正在尝试选择所有具有 CSS 计算样式 float:left 或 float:right 的元素。我在 JQuery 文档中看到了可用的属性选择器，但是我对 CSS 属性而不是属性感兴趣。

这种功能的可能用例是选择页面上的所有 display:none 元素。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T18:48:27.650

创建新的选择器很有趣，所以我这样做了：

**用法：**

> :hasCssAttr(属性，值...)
> 
> `Property`是你想用来比较的 CSS 属性
> 
> `value`是你想要匹配的值（你可以有多个）

```
$(':hasCssAttr(float, left)').css('float', 'right'); 
```

来源卢克：

```
$.expr[':'].hasCssAttr = function(objNode, intStackIndex, arrProperties, arrNodeStack) {
  var arrArguments = arrProperties[3].split(','); 
  var cssPropVal = $(objNode).css(arrArguments[0]); // need for speed
  for (var i = 1 ; i < arrArguments.length ; i++)
    if (cssPropVal == arrArguments[ i ].replace(/^\s+|\s+$/g,""))
        return true;      
  return false;
} 
```

基本上，这会选择任何 ol' css 属性。我想如果你只想要一个值，你可以消除循环，有点不必要。另外，我想知道在 eval 中执行此操作是否更有趣，以便您可以进行数值比较。反正。它在那里。

[对 Ben 帮助我的道具。](http://www.bennadel.com/blog/1457-How-To-Build-A-Custom-jQuery-Selector.htm)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-08T18:21:19.447

这应该可以在没有类黑客的情况下解决问题：

```
$("*").filter( function() {
    return /^(left|right)$/.test( $(this).css("float") )
}) 
```

顺便说一句，jQuery 已经有一个很好的方法来查找所有`display: none`元素：

```
$(":hidden") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T18:07:43.190

一个想法是通过 CSS 应用浮动样式，然后您可以选择类名并根据需要进行显示/隐藏。

```
 <style>
    .right { float: right; }
    .left { float: left; }
 </style>

 <div class='left'>...</div>
 <div class='right'>...</div>

  $('.left,.right').hide(); 
```

# c# - 在使用 UpdateProgress 时如何隐藏 UpdatePanel 的 ContentTemplate？

> ID：841061
> 
> 赞同：1
> 
> 时间：2009-05-08T18:00:43.987
> 
> 标签：c#, asp.net, ajax, asp.net-ajax

调用 UpdateProgress 时隐藏更新面板内容的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T21:39:42.713

这是使用[Ajax Control Toolki执行此操作的一个很好的示例](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/UpdatePanelAnimation/UpdatePanelAnimation.aspx)

```
<ajaxToolkit:UpdatePanelAnimationExtender ID="ae"
  runat="server" TargetControlID="up">
     <Animations>
        <OnUpdating> ... </OnUpdating>
        <OnUpdated> ... </OnUpdated>
    </Animations>
</ajaxToolkit:UpdatePanelAnimationExtender>

*  TargetControlID - ID of the UpdatePanel  whose updates are used to play the animations (this is also the default target of the animations)
* OnUpdating - Generic animation played as when any UpdatePanel begins updating
* OnUpdated - Generic animation played after the UpdatePanel has finished updating (but only if the UpdatePanel was changed) 
```

你也可以[看这个视频](http://www.asp.net/learn/ajax-videos/video-164.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T19:29:41.450

I'm not sure if this will work but you can put script tags inside the progresstemplate and hide a div inside the updatepanel. It most likely won't un-hide when it comes back though. You could catch the postback when it returns with javascript like so:

```
 Sys.WebForms.PageRequestManager.getInstance().add_endRequest(function(){ 
        alert('postback returned'); 
   }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-03T19:32:41.723

这应该有助于 [http://www.asp.net/Ajax/Documentation/Live/tutorials/ProgrammingUpdateProgress.aspx](http://www.asp.net/Ajax/Documentation/Live/tutorials/ProgrammingUpdateProgress.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T21:06:03.527

另一种方法是让你的内容一开始不可见，如下所示：

```
<div id="content" style="display: none;">
</div> 
```

然后通过将其添加到内容模板的末尾来结束每次更新：

```
<script type="text/javascript">
document.getElementById("content").style.display = "block";
</script> 
```

我自己没有尝试过，但我相信它应该有效。

编辑——我刚刚意识到这可能不会像你想要的那样工作。内容在加载时将不可见，完成后将变为可见。但在从服务器接收到第一个字节之前，内容不会消失。这可能是也可能不是您正在寻找的效果，具体取决于您看到的加载时间。

# .net - 获取 ListBox 显示高度

> ID：841062
> 
> 赞同：2
> 
> 时间：2009-05-08T18:01:31.163
> 
> 标签：.net, winforms, listbox

有没有办法确定 Windows 窗体列表框的显示高度？在我正在开发的应用程序中，我有一个带有停靠在其中的 ListBox 的表单。我需要自动调整表单的大小以删除由于 ListBox.IntegralHeight 设置为 true 而 ListBox 未使用的底部的任何额外空间。目前，我正在使用 Form.Height 除以 ListBox.ItemHeight 调整表单大小，然后将该值乘以 ListBox.ItemHeight 以四舍五入多余的不必要高度。

```
 this.Height = (this.Height / this.listBox.ItemHeight) * this.listBox.ItemHeight; 
```

这在 Vista 中效果很好，但是当我将应用程序带到 XP 时，出现了问题，并且表单底部仍然显示了额外的空间。

我不能使用 ListBox.PreferredHeight 因为这只会给我显示所有项目时 ListBox 将占用的空间量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T22:48:41.017

我的问题已经解决了。

我发现 ListBox.Height 返回 ListBox 的显示高度，*即使*它是停靠的。这回答了我的问题，但不是我的问题的解决方案。

进一步的调试揭示了为什么表单在 Vista 上的大小正确，而在 XP 上却不正确。我自己绘制的 ListBox 的 ItemHeight 是 16 像素（因为我为每个项目绘制 16x16 图像），并且 ListBox 是没有标题栏的单边框形式。碰巧 Vista 上的边框高度加起来为 16px（项目的高度），而 XP 上的边框高度加起来为 8px。我的高度计算*是*正确的，但问题是我设置的是 Form.Height （表单的整个高度，包括边框）而不是 Form.ClientSize （只是没有边框的内部区域）。因此，在 Vista 上我丢失了一个项目，而在 XP 上，列表框下方的额外空间是边框没有占用的 8 个剩余像素。我最初发布的问题代码现在变成了：

```
 this.ClientSize = new Size(
    this.ClientSize.Width, 
    (this.ClientSize.Height / this.listBox.ItemHeight) * this.listBox.ItemHeight); 
```

这会将客户区高度四舍五入到最近的项目，并且有利于表单的约束调整大小。

如果我只想缩小表单以适应 ListBox，代码可以简化为：

```
 this.ClientSize = new Size(this.ClientSize.Width, this.listBox.Height); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-08T09:34:19.850

我觉得

```
System.Windows.Forms.SystemInformation.Border3DSize.Height 
```

在这种情况下确实可以帮助您，因为它会告诉您边框高度

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T14:34:51.337

根据您的应用程序，将列表框放置在适当的容器中以进行布局可能会很好。只是一个建议，而不是对您的 Q 的真正回答。

当然，您可以考虑通过上述容器代码进行反映，以了解它们如何获得包含控件的大小。

# c# - 如何以编程方式选择 .NET CF TabControl 上的选项卡？

> ID：841064
> 
> 赞同：8
> 
> 时间：2009-05-08T18:02:02.487
> 
> 标签：c#, .net, compact-framework, tabcontrol

使用 .NET Framework 2.0/3.5 TabControl，我可以使用 SelectedTab 属性以编程方式选择一个选项卡，如下面的代码所示：

```
//toggles between tabPage1 and tabPage2
private void button1_Click(object sender, EventArgs e)
{
    if (tabControl1.SelectedTab == tabPage1)
        tabControl1.SelectedTab = tabPage2;
    else
        tabControl1.SelectedTab = tabPage1;
} 
```

.NET **Compact** Framework TabControl 没有 SelectedTab 属性，就像它的 .NET Framework 对应物一样。那么，如何以编程方式选择选项卡？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-09T19:44:44.180

TabControl.SelectedIndex

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-12T13:35:01.950

我编写了这段代码。当点击 tabPage1 时，程序将关闭：

```
private void tabControl1_MouseClick(object sender, MouseEventArgs e)
    {
        if (tabControl1.SelectedTab == tabPage1)
        {
            MessageBox.Show("Logout!");
            Application.Exit();
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-10T19:53:21.447

在 .Net 4 中可以使用

```
if (tabControl1.Controls[5] == tabControl1.SelectedTab)
                MessageBox.Show("Tab 5 Is Selected"); 
```

或者

```
if ( tabpage5 == tabControl1.SelectedTab)
         MessageBox.Show("Tab 5 Is Selected"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-09T13:42:45.180

我发现选择TabControl时，它不会正确显示。似乎在选择一个 TabControl 之后刷新它很有用。因此，如果 TabControl 被称为 TabForm 并具有多个选项卡，则可能是：

```
 Me.TabForm.SelectedIndex = 0
 Me.TabPg0.Refresh            'Where TabPg0 is the name of the Tab at Index 0 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-07-10T18:44:09.903

WPF代码，试试这个：

```
if (tabControl1.SelectedValue == tabPage1)
    tabControl1.SelectedValue = tabPage2;
else
    tabControl1.SelectedValue = tabPage1; 
```

# c# - 如何解析不是 100% 有效的 XHTML 文件？

> ID：841065
> 
> 赞同：1
> 
> 时间：2009-05-08T18:02:07.650
> 
> 标签：c#, xml, validation, xhtml, dtd

我有 XHTML 文件，其来源不完全有效，它不遵循 XML 文档的 DTD。

就像在某些地方`"`使用`&Idquo;`for 或使用撇号一样`&rsquo;`。这会导致我的 C# 代码出现异常。

那么有什么方法或任何网络链接可以用来摆脱这个吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T18:27:48.090

如果文件格式正确，您可以在自己的 DTD 中定义字符实体。

如果文件格式不正确，CodePlex 的[HTML Agility Pack](http://htmlagilitypack.codeplex.com/)将对其进行解析。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T18:24:27.193

您可以将文档解析[为 HTML](https://stackoverflow.com/questions/100358/looking-for-c-html-parser)，因为它们都以 DOM 结尾，而 HTML 解析器嘲笑这些三色堇引号问题。按照 unknown 的 HTML Tidy 想法，您可以将 DOM 序列化回有效的 XHTML 文件。（这与使用 HTML Tidy 相同，无论如何都可能使用 HTML 解析器，除非您以编程方式从 C# 中执行此操作。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T18:12:36.987

好吧，根据 XML 的性质，它必须是有效的，否则它根本不会呈现。我首先看看它使用 W3C 的验证器[http://validator.w3.org/生成的错误类型](http://validator.w3.org/)

还可以考虑使用 HTML tidy，它也可以配置为修复 XML。

我们使用 hpricot 来修复我们的 XML，但我们又在构建 rails 应用程序。不确定C#

# python - mod_python 发布者和漂亮的 URL

> ID：841068
> 
> 赞同：1
> 
> 时间：2009-05-08T18:03:22.220
> 
> 标签：python, url, mod-python, friendly-url

我是 Python 的新手（我正在退出 PHP，因为它越来越糟糕），并且我正在通过移植我的旧代码进行比赛。一件事：

我有一个文件/foo.py，其中包含函数 index() 和 bar()，因此，与发布者一起，我可以按照文档的建议访问[http://domain/foo/bar](http://domain/foo/bar)和[http://domain/foo 。](http://domain/foo)

我怎样才能拥有它，以便我可以做到：

[http://domain/foo/bar/a1/a2/a3/an/](http://domain/foo/bar/a1/a2/a3/an/) ...

这样发布者启动 bar() 然后我可以访问 URL 以获取 /a1/a2/... 我得到的只是 Forbidden :) （我不想在所有内容上使用 mod_rewrite）

哦，我在 2.5.2 提前谢谢

更新：理想的解决方案是发布者可以在 URL 中启动最右分辨率，并简单地使 a1/a2/a3.. 可通过 apache 模块访问。也许是 apache 指令和发布者的组合？

已解决（ish）：魔术**调用**（）方法等的答案多汁！虽然我认为我会修改发布者或编写自己的发布者以使用最右匹配以类似的方式检查对象，然后允许最右匹配使用 apache 模块访问 URL。谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T18:14:46.483

您必须在模块中`bar.a1.a2.a3.an`定义一个对象。`foo.py`基本上，发布者处理程序将 URL 中的斜杠替换为点，并尝试查找具有该名称的 Python 对象。

您必须在模块中`bar.a1.a2.a3.an`定义一个对象。`foo.py`基本上，发布者处理程序将 URL 中的斜杠替换为点，并尝试查找具有该名称的 Python 对象。

这里有一些你可以尝试的古怪的东西：在`foo.py`：

```
class _barclass(object):
    def __init__(self, parent, name):
        if parent and name:
            self.path = parent.path + '/' + name
            setattr(parent, name, self)
        else:
            self.path = ''
    def __getattr__(self, name):
        return _barclass(self, name)
    def __call__(self):
        # do your processing here
        # url path is contained in self.path

bar = _barclass(None, None) 
```

虽然这有点限制发布者的意图 - 你最好从头开始编写自己的处理程序。（或者使用 Django 之类的东西。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T18:17:27.117

据我所知，我相信这超出了发布算法的能力。（[文档当然没有提到它。](http://www.modpython.org/live/mod_python-3.3.1/doc-html/hand-pub-alg-trav.html)）但是，您可以编写自己的 mod_python 处理程序（[此处](http://www.modpython.org/live/mod_python-3.3.1/doc-html/tut-404-handler.html)为示例）来扩展发布算法。

更好的解决方案是查看[mod_wsgi](http://code.google.com/p/modwsgi/)并将您的 Web 应用程序构建为[WSGI 应用程序](http://www.wsgi.org/wsgi/)。您将从 WSGI 中间件的货架和货架中受益，但特别是您将能够使用像[Routes](http://routes.groovie.org/)这样的路由软件，这些软件专门用于处理对象发布不够强大的这些情况。但我不知道你的截止日期，所以这可能可行，也可能不可行。

# c++ - 最佳 C++ 代码格式化程序/美化程序

> ID：841075
> 
> 赞同：127
> 
> 时间：2009-05-08T18:06:03.227
> 
> 标签：c++, code-formatting

有很多源代码格式化工具。哪些最适合 C++？

我对在签入/签出代码时可以自动运行的命令行工具或其他东西感兴趣，最好不需要启动编辑器或 IDE。

（如果您看到您喜欢的答案已被列为答案，请投票。如果不存在，请添加。）

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2009-05-08T18:07:33.380

可以为 C++ 和 Java（以及其他）非常详细地定制[AStyle](http://astyle.sourceforge.net/)

这是一个源代码格式化工具。

* * *

[clang-format](http://clang.llvm.org/docs/ClangFormat.html)是一个强大的**命令行**工具，它与 clang 编译器捆绑在一起，它甚至可以连贯地处理最晦涩的语言结构。

它可以与 Visual Studio、Emacs、Vim（和其他）集成，并且可以只格式化选定的行（或使用 git/svn 格式化一些差异）。

它可以使用[此处](http://clang.llvm.org/docs/ClangFormatStyleOptions.html)列出的各种选项进行配置。

当使用配置文件（命名`.clang-format`）时，样式可以是每个目录 - 父目录中最接近的此类文件应用于特定文件。

样式可以从预设（比如 LLVM 或 Google）继承，并且可以在以后覆盖不同的选项

它被 Google 和其他人使用，并且已准备好生产。

* * *

另请查看项目[UniversalIndentGUI](http://universalindent.sourceforge.net)。您可以使用它来试验几个压头：AStyle、Uncrustify、GreatCode，...并选择最适合您的。它们中的任何一个都可以稍后从命令行运行。

* * *

[Uncrustify](http://uncrustify.sourceforge.net/)有*很多*可配置的选项。您可能还需要 Universal Indent GUI（在 Konstantin 的回复中）来配置它。

# .net - 表单需要 IntPtr (VB.Net)

> ID：841076
> 
> 赞同：0
> 
> 时间：2009-05-08T18:06:36.767
> 
> 标签：.net, vb.net, winforms, handle, intptr

我需要表格的 intPtr。Control.FromHandle(control) 给了我一个句柄的控制权，但我需要相反的——从一个控件中获取句柄。我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T18:08:56.900

尝试

```
Dim handle As IntPtr = someControl.Handle 
```

注意：这仅在创建控件的句柄后才有效。在创建控件和渲染到某种程度之间有一个时间窗口，这*可能会*返回 IntPtr.Zero

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T18:29:59.970

> 注意：这仅在创建控件的句柄后才有效。在创建控件和渲染到某种程度之间有一个时间窗口，这可能会返回 IntPtr.Zero

我不同意 JaredPar 的观点：如果句柄尚未创建，则 Handle 属性的 get 访问器调用 CreateHandle（您可以使用 Reflector 检查）。意识到这一点很重要，因为在某些情况下它可能会产生意想不到的后果

# validation - BizTalk 生成的 XSD 无法验证其派生自的 XML

> ID：841079
> 
> 赞同：1
> 
> 时间：2009-05-08T18:06:56.437
> 
> 标签：validation, xsd, biztalk

我从另一个系统得到了 XML 响应，但没有 XSD，所以我使用 Create Schema 选项来生成一个。

然后，我将 XSD 添加到我的 BizTalk 2006 R2 项目中，并将其“输入实例文件名”属性设置为原始 XML 消息。

尝试了“验证实例”选项，但它失败了？？？，出现了几个类似这样的错误......
*错误 BEC2004: The xsi:type attribute value ' [http://www.w3.org/2001/XMLSchema:int](http://www.w3.org/2001/XMLSchema:int) '对元素“ [http://www.aniteps.com/xml/schemas/awm/images4:NumberOfErrors](http://www.aniteps.com/xml/schemas/awm/images4:NumberOfErrors) ”无效，因为它不是从模式中的类型有效派生的类型，或者因为它具有 xsi：类型派生受阻。*

用于生成 XSD 的 XML 怎么会失败？

我的 XML 示例是...

```
<?xml version="1.0" encoding="utf-8"?>
<ImportIndexDocumentResponse 
     xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
     xmlns="http://www.aniteps.com/xml/schemas/awm/images4">
  <HasErrors>false</HasErrors>
  <NumberOfErrors xsi:type="xsd:int">0</NumberOfErrors>
  <ErrorDescription xsi:type="xsd:string">No exception ocurred.</ErrorDescription>
  <ErrorNumber xsi:type="xsd:int">0</ErrorNumber>
  <FailedItems>
    <Item>
      <OriginalDataString xsi:type="xsd:string" />
      <ErrorDescription xsi:type="xsd:string" />
    </Item>
  </FailedItems>
  <UniqueDocumentReferences>
    <UniqueDocumentReference>FA40FE</UniqueDocumentReference>
    <UniqueDocumentReference>U55922</UniqueDocumentReference>
  </UniqueDocumentReferences>
</ImportIndexDocumentResponse> 
```

并且 BizTalk/Visual Studio 2005 生成...

```
<?xml version="1.0" encoding="utf-8"?>
<xsd:schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
            xmlns:xs="http://www.w3.org/2001/XMLSchema" 
            xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
            attributeFormDefault="unqualified" 
            elementFormDefault="qualified" 
            targetNamespace="http://www.aniteps.com/xml/schemas/awm/images4">
  <xs:element name="ImportIndexDocumentResponse">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="HasErrors" type="xs:boolean" />
        <xs:element name="NumberOfErrors" type="xs:unsignedByte" />
        <xs:element name="ErrorDescription" type="xs:string" />
        <xs:element name="ErrorNumber" type="xs:unsignedByte" />
        <xs:element name="FailedItems">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="Item">
                <xs:complexType>
                  <xs:sequence>
                    <xs:element name="OriginalDataString" />
                    <xs:element name="ErrorDescription" />
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="UniqueDocumentReferences">
          <xs:complexType>
            <xs:sequence>
              <xs:element maxOccurs="unbounded" name="UniqueDocumentReference" type="xs:string" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xsd:schema> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T01:04:29.400

XSD 生成器相当愚蠢，并且没有注意到示例实例文档包含类型注释（xsi:type 属性）。所以它决定 <ErrorDescription> 应该包含无符号字节而不是有符号整数，正如类型注释所说。

然后发生的事情是验证器变得混乱，因为元素有两种不同的类型定义，那么它应该相信谁呢？您可以尝试更改架构以使类型定义与 xsi:type 覆盖匹配，这可能会有所帮助。

# asp.net-mvc - 从 Ajax 表单帖子中重定向

> ID：841089
> 
> 赞同：7
> 
> 时间：2009-05-08T18:08:55.013
> 
> 标签：asp.net-mvc, ajax, forms, post, redirect

我有一个动作方法，根据某些条件需要通过 ajax 返回部分视图，或重定向到另一个控制器/动作。返回了正确的视图，但它将其放置在 Ajax 表单 UpdateTargetId 中，而不是重定向到一个全新的页面。任何人都知道我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-08T18:22:56.400

我想我会重构它以使用 jQuery 而不是 MVC Ajax。jQuery 将让您更好地控制您可以对返回的结果执行哪些操作。如果这不是一个选项，您可能需要查看 OnComplete 回调并查看传递给它的数据，看看是否有办法获取您希望从中重定向到的 url。

另外，我似乎记得，如果你返回一个 JavaScriptResult，无论 AJAX 是如何被调用的，它都会执行它。您可能想尝试以下方法：

```
return JavaScript( "window.top.location.href ='" + Url.Action( "Action" ) + "';" ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T18:21:45.670

例如，此[链接](http://weblogs.asp.net/infinitiesloop/archive/2007/09/25/response-redirect-into-a-new-window-with-extension-methods.aspx)可能有助于解决您的问题，并插入您的 javascript 以将当前页面更改为其他控制器

```
window.location = 'controller/action'; 
```

# apache - .htaccess 不起作用 - 仅缓存图像而不是 JS 或 CSS

> ID：841091
> 
> 赞同：4
> 
> 时间：2009-05-08T18:09:09.087
> 
> 标签：apache, .htaccess, caching, last-modified, etag

### 复制：

> [为什么我的 javascript & css 没有缓存？](https://stackoverflow.com/questions/841209)

**我注意到我只收到图像的 304 HTTP 代码（缓存内容），而不是 JavaScript 或 CSS。**

我的 .htaccess 文件是：

```
Options -Indexes
Options +FollowSymLinks  

# Enable ETag
FileETag MTime Size

# Set expiration header
ExpiresActive on
ExpiresDefault "access plus 1 week"

# Compress some text file types
AddOutputFilterByType DEFLATE text/html text/plain text/css text/xml application/x-javascript text/javascript application/javascript application/json

# Deactivate compression for buggy browsers
BrowserMatch ^Mozilla/4 gzip-only-text/html
BrowserMatch ^Mozilla/4\.0[678] no-gzip
BrowserMatch \bMSIE !no-gzip !gzip-only-text/html

# Set header information for proxies
Header append Vary User-Agent 
```

**任何人都知道为什么只有图像被缓存而不是我的 JavaScript 或 CSS？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T18:48:29.630

使用像 Fiddler 这样的窥探代理来查看浏览器对服务器的请求以及返回的标头。

您应该会看到返回“200”状态的初始请求。然后您应该会看到来自浏览器的请求以验证其缓存。返回标头应表明浏览器缓存仍然良好，不应包含页面内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T18:49:33.433

使用 Firebug for Firefox，查看网络选项卡。重新加载时您不会看到缓存内容的网络连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T18:52:24.583

我通常使用这个插件：

[https://addons.mozilla.org/en-US/firefox/addon/3829](https://addons.mozilla.org/en-US/firefox/addon/3829)

它使您可以监视 HTTP 请求，如果没有请求该文件，则将其缓存。此外，如果您仍然遇到缓存问题，请确保您没有使用时髦的代理。（我遇到了代理丢失 ETag 所以它永远不会缓存的问题）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T19:55:07.350

I'll use either Firebug or [TamperData](https://addons.mozilla.org/en-US/firefox/addon/966) to monitor HTTP request. The latter is useful in the case where there might be redirects involved, which Firebug won't necessarily tell you.

# qt - QTreeView中选择慢，为什么？

> ID：841096
> 
> 赞同：12
> 
> 时间：2009-05-08T18:10:55.710
> 
> 标签：qt, performance, pyqt, qtreewidget

我最近在一个使用 PyQt 的项目中遇到了困难。我有一个连接到 QAbstractItemModel 的 QTreeView，其中通常有数千个节点。到目前为止，它工作正常，但我今天意识到选择很多节点非常慢。经过一番挖掘，事实证明 QAbstractItemModel.parent() 被调用得太频繁了。我创建了最少的代码来重现问题：

```
#!/usr/bin/env python
import sys
import cProfile
import pstats

from PyQt4.QtCore import Qt, QAbstractItemModel, QVariant, QModelIndex
from PyQt4.QtGui import QApplication, QTreeView

# 200 root nodes with 10 subnodes each

class TreeNode(object):
    def __init__(self, parent, row, text):
        self.parent = parent
        self.row = row
        self.text = text
        if parent is None: # root node, create subnodes
            self.children = [TreeNode(self, i, unicode(i)) for i in range(10)]
        else:
            self.children = []

class TreeModel(QAbstractItemModel):
    def __init__(self):
        QAbstractItemModel.__init__(self)
        self.nodes = [TreeNode(None, i, unicode(i)) for i in range(200)]

    def index(self, row, column, parent):
        if not self.nodes:
            return QModelIndex()
        if not parent.isValid():
            return self.createIndex(row, column, self.nodes[row])
        node = parent.internalPointer()
        return self.createIndex(row, column, node.children[row])

    def parent(self, index):
        if not index.isValid():
            return QModelIndex()
        node = index.internalPointer()
        if node.parent is None:
            return QModelIndex()
        else:
            return self.createIndex(node.parent.row, 0, node.parent)

    def columnCount(self, parent):
        return 1

    def rowCount(self, parent):
        if not parent.isValid():
            return len(self.nodes)
        node = parent.internalPointer()
        return len(node.children)

    def data(self, index, role):
        if not index.isValid():
            return QVariant()
        node = index.internalPointer()
        if role == Qt.DisplayRole:
            return QVariant(node.text)
        return QVariant()

app = QApplication(sys.argv)
treemodel = TreeModel()
treeview = QTreeView()
treeview.setSelectionMode(QTreeView.ExtendedSelection)
treeview.setSelectionBehavior(QTreeView.SelectRows)
treeview.setModel(treemodel)
treeview.expandAll()
treeview.show()
cProfile.run('app.exec_()', 'profdata')
p = pstats.Stats('profdata')
p.sort_stats('time').print_stats() 
```

要重现该问题，只需运行代码（执行分析）并选择树小部件中的所有节点（通过 shift 选择或 Cmd-A）。当您退出应用程序时，分析统计信息将显示如下内容：

```
Fri May  8 20:04:26 2009    profdata

         628377 function calls in 6.210 CPU seconds

   Ordered by: internal time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    4.788    4.788    6.210    6.210 {built-in method exec_}
   136585    0.861    0.000    1.182    0.000 /Users/hsoft/Desktop/slow_selection.py:34(parent)
   142123    0.217    0.000    0.217    0.000 {built-in method createIndex}
    17519    0.148    0.000    0.164    0.000 /Users/hsoft/Desktop/slow_selection.py:52(data)
   162198    0.094    0.000    0.094    0.000 {built-in method isValid}
     8000    0.055    0.000    0.076    0.000 /Users/hsoft/Desktop/slow_selection.py:26(index)
   161357    0.047    0.000    0.047    0.000 {built-in method internalPointer}
       94    0.000    0.000    0.000    0.000 /Users/hsoft/Desktop/slow_selection.py:46(rowCount)
      404    0.000    0.000    0.000    0.000 /Users/hsoft/Desktop/slow_selection.py:43(columnCount)
       94    0.000    0.000    0.000    0.000 {len}
        1    0.000    0.000    6.210    6.210 <string>:1(<module>)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects} 
```

该数据中奇怪的部分是调用 parent() 的频率：2k 节点为 136k 次！任何人都知道为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T13:00:13.437

尝试调用`setUniformRowHeights(true)`您的树视图：

[https://doc.qt.io/qt-4.8/qtreeview.html#uniformRowHeights-prop](https://doc.qt.io/qt-4.8/qtreeview.html#uniformRowHeights-prop)

此外，还有一个来自 qt labs 的名为 modeltest 的 C++ 工具。我不确定是否有python的东西：

[https://wiki.qt.io/Model_Test](https://wiki.qt.io/Model_Test)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-22T15:57:02.433

我将您非常好的示例代码转换为 PyQt5 并在 Qt5.2 下运行，并且可以确认数字仍然相似，即莫名其妙的大量调用。例如，这里是报告的顶部开始，cmd-A 全选，滚动一页，退出：

```
   ncalls tottime percall cumtime percall filename:lineno(function)
        1 14.880 14.880 15.669 15.669 {内置方法exec_}
   196712 0.542 0.000 0.703 0.000 /Users/dcortes1/Desktop/scratch/treeview.py:36（父）
   185296 0.104 0.000 0.104 0.000 {内置方法 createIndex}
    20910 0.050 0.000 0.056 0.000 /Users/dcortes1/Desktop/scratch/treeview.py:54（数据）
   225252 0.036 0.000 0.036 0.000 {内置方法isValid}
   224110 0.034 0.000 0.034 0.000 {内置方法 internalPointer}
     7110 0.020 0.000 0.027 0.000 /Users/dcortes1/Desktop/scratch/treeview.py:28（索引）
```

虽然计数确实过多（我没有解释），但请注意 cumtime 值并没有那么大。还可以重新编码这些功能以更快地运行；例如在 index() 中，“如果不是 self.nodes”是真的吗？类似地，请注意 parent() 和 createIndex() 的计数几乎相同，因此 index.isValid() 通常为真（合理，因为端节点比父节点多得多）。重新编码以首先处理这种情况将进一步减少 parent() cumtime。编辑：再想一想，这种优化是“重新安排泰坦尼克号上的躺椅”。

# javascript - 有人可以帮我理解为什么会这样吗？

> ID：841104
> 
> 赞同：2
> 
> 时间：2009-05-08T18:12:51.230
> 
> 标签：javascript, html

我刚刚遇到了我遇到过的最奇怪的事情。

考虑这个测试页面：

```
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title></title>
    <script language=javascript>
        function test(myParameter) {
            alert(myParameter);
        }
    </script>
</head>
<body>
    <input type="button" value="Strange" onclick="javascript: test(044024);" />
    <input type="button" value="Ok" onclick="javascript: test('044024');" />
</body>
</html> 
```

如果我点击“奇怪”按钮，我会得到**18452**，如果我点击“确定”按钮，我会得到**044024**

有谁知道发生了什么并向我解释？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-08T18:15:40.380

由于前导 0，Javascript 将符号 044024 解释为八进制值。

044024 十月到十二月是 18452

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-08T18:15:53.797

以 0 为前缀的数字被认为是八进制（以 8 为基数）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T18:16:10.003

当你写一个以 0 作为第一个数字的数字时，它是一个八进制数。

# asp.net - 将 MVC 用于 Webforms 项目的新部分

> ID：841105
> 
> 赞同：6
> 
> 时间：2009-05-08T18:12:55.863
> 
> 标签：asp.net, asp.net-mvc, asp-classic

我真的很喜欢 MVC 的“方式”并且真的很喜欢学习 ASP.NET MVC（我从不喜欢 ASP.NET Webforms，但直到现在我才知道为什么）。问题是我即将继承一堆 Webforms 代码，并想知道我是否能够使用 MVC 向代码库添加新东西，而不是使用 Webforms。我想这在很大程度上取决于身份验证的设置方式，以及代码的设置方式是否可以包含一些库或其他东西并只使用这些函数，或者我是否必须重新创建它们或*喘气*在其他地方复制它们. 我应该担心什么？我应该停止使用 MVC 并开始使用 Webforms，还是可以让它一起工作，以便如果我需要修改 Webforms 代码库中的某些内容，我可以在前进时将其重新制作为 MVC 方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T18:22:17.633

我建议尝试仅使用 MVC 添加新内容，并尽可能转换遗留的 webforms 代码。

这是一篇相当不错的帖子，将它们放在同一个项目中：http: [//www.chadmyers.com/Blog/archive/2007/11/30/asp.net-webforms-and-mvc-in-the-相同的项目.aspx](http://www.chadmyers.com/Blog/archive/2007/11/30/asp.net-webforms-and-mvc-in-the-same-project.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T18:20:03.457

Scott Hanselman[在他的博客中发表了一篇关于它的文章。](http://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx)如果你想开始走 MVC 路线，那就去吧。我认为这可能取决于 ASP.NET Webforms 应用程序有多大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T18:19:53.350

嗯，MVC 是建立在 Asp.Net 之上的，所以它们应该能够很好地协同工作。问题是数据的结构是否适合使用 MVC 框架和意识形态。

还要考虑它的可维护性——不仅是为了你自己，也是为了其他人。根据应用程序状态的位置，坚持使用网络表单可能会**更好。**如果您必须开始做更多的工作才能让应用程序正常工作，那可能不值得麻烦。

# iphone - 如何获得 CGPath 曲线或四边形曲线中的所有点

> ID：841111
> 
> 赞同：18
> 
> 时间：2009-05-08T18:14:54.720
> 
> 标签：iphone, cocoa, core-animation, core-graphics, bezier

我使用该方法制作了一条四边形曲线路径`CGPathAddQuadCurveToPoint`。我得到了完美的路径。但是，我想知道参与路径的所有坐标点。

有没有办法检索路径中的所有坐标点？

如果没有，您是否有任何其他解决方案可以在数学上检索曲线中的所有点。

在此先感谢， Vamshi

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-27T03:22:31.353

您可以使用三次贝塞尔曲线的 wykobi C++ 库例程来执行此操作。Wykobi 的库也支持二次贝塞尔曲线。

当然，正如有人指出的那样，您并不想要所有的点（尽管并非不可能，但这只会花费无限的时间:)。Wykobi 可以轻松获得一定数量的点 - 如果您的起点、c1、c2 和终点（其中 c1、c2 是控制点）与提供给 CGContextAddCurveToPoint 的点完全相同，那么这些点将完美地位于在核心图形绘制的线上——这样你就可以在路径上的几个点上画一个图案。

请参阅： http: [//www.codeproject.com/Articles/22568/Computational-Geometry-C-and-Wykobi](http://www.codeproject.com/Articles/22568/Computational-Geometry-C-and-Wykobi)

另外，在我开始使用 wykobi 之后，我听说有一个类似的，甚至可能更好的库，它是 Boost 的一部分，但还没有检查出来。

我创建了一个 C++ 类 WPoint 作为 wykobi 点和 CGPoints 之间的桥梁（C++ 很有趣！）。这是一些代码（没有 WPoint，但您可以想象它与 CGPoint 的布局完全相同，因此如果您进行正确的转换，您可以轻松转换。

```
 NSMutableArray* result = [[NSMutableArray alloc] init];
        wykobi::cubic_bezier<CGFloat,2> bezier;
        bezier[0] = (WPoint)p1;  // start point, in CG we did a CGMoveToPoint
        bezier[1] = (WPoint)b1i; // control 1
        bezier[2] = (WPoint)b2i; // control 2
        bezier[3] = (WPoint)p2;  // end point

        std::vector<WPoint> point_list;
        int numPoints = p2.dist(p3) * pointDensity;
        // *** here's the magic ***
        wykobi::generate_bezier(bezier,std::back_inserter(point_list), numPoints);

        for (int i=0; i<numPoints; i++) {
            CGPoint p = (CGPoint)(point_list[i]);
            [result addObject:[NSValue valueWithCGPoint:p]];
        }

// result has your points! 
```

这是 Boost 几何库的链接：http: [//www.boost.org/doc/libs/1_47_0/libs/geometry/doc/html/geometry/introduction.html](http://www.boost.org/doc/libs/1_47_0/libs/geometry/doc/html/geometry/introduction.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-18T05:21:03.443

使用 CGContextSetLineDash

此函数的目的是创建一条虚线，但您可以使用它来获得更小的线段。每个段的起点都可以视为点。

```
CGSize bbSize = CGPathGetBoundingBox(path).size;
UIGraphicsBeginImageContext(bbSize);
CGContextRef ctx = UIGraphicsGetCurrentContext();
CGContextSetLineWidth(ctx, 1.0);
CGContextAddPath(ctx, path);
CGContextSetLineDash(ctx, phase, lengths, count);
CGContextReplacePathWithStrokedPath(ctx);
result = CGContextCopyPath(ctx);
UIGraphicsEndImageContext(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T19:15:37.957

If you want to work on the moveto, lineto, and curveto elements of the path, use [CGPathApply](http://developer.apple.com/iphone/library/documentation/GraphicsImaging/Reference/CGPath/Reference/reference.html#//apple_ref/c/func/CGPathApply). You pass this a pointer to a function in your program, and it calls that function once per element of the path.

Unfortunately, there's no way to just ask for each element like there is with AppKit's [NSBezierPath](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSBezierPath_Class/). The function is the only way.

If you want to determine every pixel intersected by the path, too bad—that's not practical, and I can't even think of why you'd want that information. Some contexts, such as [PDF contexts](http://developer.apple.com/iphone/library/documentation/GraphicsImaging/Reference/CGPDFContext/), don't even have pixels; in those cases, any question involving pixels is a non sequitur.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-12T07:05:39.447

我猜您正在寻找与 Java2D FlatteningPathIterator 类等效的东西。例如`path.getPathIterator(null, 1.0)`，即使原始路径具有curveTo 和quadTo，Java2D 也会返回仅包含“lineTo”段的迭代器，双参数控制“平坦度”，为您提供一种计算曲线上任何点的简单方法。我在 Cocoa 中寻找同样的东西，但什么也没找到。如果您找到解决方案，请告诉我。周围有曲线实现（例如[http://sourceforge.net/projects/curves/](http://sourceforge.net/projects/curves/)）可以移植，但总是存在风险，如果您不使用与 Cocoa 相同的算法，那么您的插值之间可能会出现错误和描边的 NSBezierPath/CGPath。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T18:19:51.977

二次曲线就是这样——一条曲线。不可能得到上面*所有*点的列表，因为有无限多的点，而且它不是一个简单的线段。

有关可用于查询对象的函数列表，请参阅[获取有关 Quartz 路径的信息。](http://developer.apple.com/DOCUMENTATION/GraphicsImaging/Reference/CGPath/Reference/reference.html#//apple_ref/doc/uid/TP30000959-CH1g-439779)`CGPath`不幸的是，您将获得的最有用的信息似乎是 with [`CGPathContainsPoint()`](http://developer.apple.com/DOCUMENTATION/GraphicsImaging/Reference/CGPath/Reference/reference.html#//apple_ref/c/func/CGPathContainsPoint)，它只会告诉您给定点是否包含在路径区域内。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T19:58:16.310

*If not do u have any other solution for retrieving all the points in a curve mathematically.*

What do you need them for, i.e. what problem are you trying to solve? If it is to intersect two curves, you can do this mathematically. Just set the two curve equations equal to each other and solve for the unknown.

# javascript - 内联 javascript 表单验证

> ID：841119
> 
> 赞同：2
> 
> 时间：2009-05-08T18:17:23.917
> 
> 标签：javascript, validation, forms

我正在处理工作中的表单验证脚本并且遇到了一些困难。该表单旨在确保用户填写姓名、真实电子邮件、类别（从下拉列表中）和问题：

这会命名表单并从表单中收集所有数据：

```
<script>

  function checkForm(form1) {
name = document.getElementById("FieldData0").value;
category = document.getElementById("FieldData3").value;
question = document.getElementById("FieldData1").value;
email = document.getElementById("FieldData2").value; 
```

这将检查以查看“名称”字段中是否存在某些内容。它工作正常并且完全按照应有的方式进行验证，显示错误文本：

```
 if (name == "") {
  hideAllErrors();
document.getElementById("nameError").style.display = "inline";
document.getElementById("FieldData0").select();
document.getElementById("FieldData0").focus();
  return false; 
```

这也可以正常工作。它检查电子邮件字段是否为空，如果为空，则显示错误文本并选择该字段：

```
 } else if (email == "") {
hideAllErrors();
document.getElementById("emailError").style.display = "inline";
document.getElementById("FieldData2").select();
document.getElementById("FieldData2").focus();
  return false;
  } 
```

这也可以正常工作，确保问题字段不为空：

```
else if (question == "") {
hideAllErrors();
document.getElementById("questionError").style.display = "inline";
document.getElementById("FieldData1").select();
document.getElementById("FieldData1").focus();
  return false;
  } 
```

这部分工作 - 如果没有选择下拉菜单，它将显示错误消息，但这不会阻止表单提交，它只是在表单提交时显示错误文本：

```
else if (category == "") {
hideAllErrors();
document.getElementById("categoryError").style.display = "inline";
document.getElementById("FieldData3").select();
document.getElementById("FieldData3").focus();
  return false;
  } 
```

无论我把它放在哪里，这个都不起作用。上周我在同一个脚本上使用了一个变体，效果很好。这应该检查输入的电子邮件是否看起来像一个真实的电子邮件地址：

```
else if (!check_email(document.getElementById("FieldData1").value)) {
hideAllErrors();
document.getElementById("emailError2").style.display = "inline";
document.getElementById("FieldData2").select();
document.getElementById("FieldData2").focus();
  return false;
  } 

Otherwise it lets the form submit:

  return true;
  } 
```

这将检查电子邮件：

```
function check_email(e) {
ok = "1234567890qwertyuiop[]asdfghjklzxcvbnm.@-_QWERTYUIOPASDFGHJKLZXCVBNM";

for(i=0; i < e.length ;i++){
if(ok.indexOf(e.charAt(i))<0){ 
return (false);
}   
} 

if (document.images) {
re = /(@.*@)|(\.\.)|(^\.)|(^@)|(@$)|(\.$)|(@\.)/;
re_two = /^.+\@(\[?)[a-zA-Z0-9\-\.]+\.([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
if (!e.match(re) && e.match(re_two)) {
return (-1);        
} 

}

} 
```

此功能隐藏所有错误，因此用户不会被红色文本轰炸。我尝试输入 "document.getElementById("emailError").style.display = "none"" 但这破坏了整个事情：

```
 function hideAllErrors() {
document.getElementById("nameError").style.display = "none"
document.getElementById("emailError").style.display = "none"
document.getElementById("categoryError").style.display = "none"
document.getElementById("questionError").style.display = "none"

  }

</script> 
```

表格如下所示：

```
<form onSubmit="return checkForm();" method="post" action="http://www.emailmeform.com/fid.php?formid=303341io4u" name="form1">

<p><div class=error id=nameError>Required: Please enter your name<br/></div><p><strong>Name:</strong> <span></span><br><input type="text" name="FieldData0" id="FieldData0" value="" size="22" tabindex="1" />
<label for="name"></label></p>

<p><div class=error id=emailError>Required: Please enter your email address<br/></div>
<div class=error id=nameError2>This doesn't look like a real email address, please check and reenter<br/></div>
<strong><p>Email:</strong> <span>(will not be published)</span><br><input type="text" name="FieldData2" id="FieldData2" value="" size="22" tabindex="2" />
<label for="email"></label>
</p>

<div class=error id=categoryError>Please select a category from the drop-down menu<br></div>
<p><strong>Category:</strong> <span></span><br>
<p><select id="FieldData3" name="FieldData3">
<option value="">Please select a category</option>
<option value="a">a</option>
<option value="b">b</option>
<option value="c">c</option>
<option value="d">d</option>
<option value="e">e</option>
<option value="f">f</option>
<option value="other">Other</option>
</select><label for="category"></label>

<p><div class=error id=questionError>Please type your question in the box below:<br></div><label for="question"><strong><p>Your Question:</strong> <span></span></label><br>

<textarea name="FieldData1" id="FieldData1" cols="50" rows="10"></textarea></p>

<p><input type="submit" class="btn" value="Submit Question" name="Submit"></p>
</div>
</form> 
```

问题是我运行检查的顺序吗？我似乎无法弄清楚这一点。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T21:35:22.490

我冒昧地重新编写了您的 javascript 以使其更具可读性和更易于调试。

正如 Marc Bernier 提到的，下拉元素不支持该`select`功能，因此我`if`在它周围放置了一条语句以防止异常。我还简化了你的`checkEmail`功能，看起来相当复杂。我将其重命名为`isAnInvalidEmail`以使`checkForm`代码更简单。

您还在 HTML 中错误地命名了“emailError2” `div`，这会导致 javascript 中出现另一个异常。您的 HTML 相当混乱，并且在某些情况下是无效的。某些属性值缺少引号并缺少结束标记。您应该考虑使用[W3C 验证器](http://validator.w3.org)来确保您的 HTML 干净且符合标准。

我在 jsbin 上托管了您的代码：http://jsbin.com/iyeco [（](http://jsbin.com/iyeco)可通过[http://jsbin.com/iyeco/edit](http://jsbin.com/iyeco/edit)编辑）

这是清理后的Javascript：

```
function checkForm() {
  hideAllErrors();
  var formIsValid =
    showErrorAndFocusIf('FieldData0', isEmpty, 'nameError')
    && showErrorAndFocusIf('FieldData2', isEmpty, 'emailError')
    && showErrorAndFocusIf('FieldData2', isAnInvalidEmail, 'emailError2')
    && showErrorAndFocusIf('FieldData3', isEmpty, 'categoryError')
    && showErrorAndFocusIf('FieldData1', isEmpty, 'questionError');

  /* For debugging, lets prevent the form from submitting. */
  if (formIsValid) {
    alert("Valid form!");
    return false;
  }

  return formIsValid;
}

function showErrorAndFocusIf(fieldId, predicate, errorId) {
  var field = document.getElementById(fieldId);
  if (predicate(field)) {
    document.getElementById(errorId).style.display = 'inline';
    if (field.select) {
      field.select();
    }
    field.focus();
    return false;
  }

  return true;
}

function isEmpty(field) {
  return field.value == '';
}

function isAnInvalidEmail(field) {
  var email = field.value;

  var ok = "1234567890qwertyuiop[]asdfghjklzxcvbnm.@-_QWERTYUIOPASDFGHJKLZXCVBNM";

  for(i = 0; i < email.length; i++){
    if(ok.indexOf(email.charAt(i)) < 0) {
      return true;
    }
  }

  re = /(@.*@)|(\.\.)|(^\.)|(^@)|(@$)|(\.$)|(@\.)/;
  re_two = /^.+\@(\[?)[a-zA-Z0-9\-\.]+\.([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
  return re.test(email) || !re_two.test(email);
}

function hideAllErrors() {
  document.getElementById("nameError").style.display = "none"
  document.getElementById("emailError").style.display = "none"
  document.getElementById("emailError2").style.display = "none"
  document.getElementById("categoryError").style.display = "none"
  document.getElementById("questionError").style.display = "none"
} 
```

和清理后的 HTML：

```
<form onSubmit="return checkForm();" method="post" action="http://www.emailmeform.com/fid.php?formid=303341io4u" name="form1"> 
  <div> 
    <div class="error" id="nameError"> 
      Required: Please enter your name 
    </div> 
    <label for="FieldData0"><strong>Name:</strong></label> 
    <input type="text" name="FieldData0" id="FieldData0" value="" size="22" tabindex="1" /> 
  </div> 

  <div> 
    <div class="error" id="emailError"> 
      Required: Please enter your email address 
    </div> 
    <div class="error" id="emailError2"> 
      This doesn't look like a real email address, please check and reenter 
    </div> 
    <label for="FieldData2"><strong>Email:</strong>(will not be published)</label> 
    <input type="text" name="FieldData2" id="FieldData2" value="" size="22" tabindex="2" /> 
  </div> 

  <div> 
    <div class="error" id="categoryError"> 
      Please select a category from the drop-down menu 
    </div> 
    <label for="FieldData3"><strong>Category:</strong></label> 
    <select id="FieldData3" name="FieldData3"> 
      <option value="">Please select a category</option> 
      <option value="a">a</option> 
      <option value="b">b</option> 
      <option value="c">c</option> 
      <option value="d">d</option> 
      <option value="e">e</option> 
      <option value="f">f</option> 
      <option value="other">Other</option> 
    </select> 
  </div> 

  <div> 
    <div class="error" id="questionError"> 
      Please type your question in the box below: 
    </div> 
    <label for="FieldData1"><strong>Your Question:</strong></label> 
    <textarea name="FieldData1" id="FieldData1" cols="50" rows="10"></textarea> 
  </div> 

  <input type="submit" class="btn" value="Submit Question" name="Submit"> 
</form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T20:15:17.160

关于下拉的错误，不要调用此行：

document.getElementById("FieldData1").select();

我似乎记得几周前有完全相同的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T18:21:01.240

第一个问题：将该 if 语句的内容移动到一个函数中……然后从那里开始。你有大约 5 段代码在做基本相同的事情。

下一步：由于您一次只允许一条错误消息，因此创建一个通用 div 来保存它并移动它。这样，您就不需要跟踪隐藏某些错误、显示其他错误等。

下一步：仅从您的 check_email 函数返回 true 或 false ...返回 -1 和 false 等是不好的形式，即使 javascript 对此类事情很宽容。

清理完代码后，调试起来会容易得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T19:24:50.323

我建议摆脱整个 if else 链并单独检查每个 this。

```
var error = 0;
if (value == '') {
    error = 1;
    // other stuff;
}

if (value2 == '') {
    error = 1;
    // do stuff;
} 

...

if (error) {
    // show error
} else {
    // submit form
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T19:36:50.293

尝试替换不类型转换的`==`for 。`===`它可能会帮助您解决下拉问题。

您的函数返回 false，它也可能返回 -1。

因为我不知道 JavaScript 对`!-1`你做了什么类型转换，所以也应该这样做：

```
check_email(...)!==false; 
```

而不是这个：

```
!check_email(...) 
```

# html - html代码中的问题

> ID：841124
> 
> 赞同：-7
> 
> 时间：2009-05-08T18:18:28.877
> 
> 标签：html, styles

此表打印不正确

```
<tr height="95%">
  <td width="100%">
    <div id="placeSchedule">
      <table bgcolor="red" width="100%" height="100%" border="1">
         <tr>
            <td>
              xyz
            </td>
         </tr>
      </table>
    </div>
  </td>
</tr>

> because of this <div> tag, my table
> under <dig> tag is not printing
> properly,, i am using AJAx here.. to
> overwrite things under <div> tag.. so
> please temme any alternative to <div>
> tag 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T18:22:53.577

从该示例代码中，您缺少一个包装`<table>`标记。

尝试这个：

```
<table>
    <tr height="95%">
      <td width="100%">
        <div id="placeSchedule">
          <table bgcolor="red" width="100%" height="100%" border="1">
             <tr>
                <td>
                  xyz
                </td>
             </tr>
          </table>
        </div>
      </td>
    </tr>
 </table> 
```

编辑：澄清我的评论：

表格的 100% 高度属性将把高度设置**为父元素**的 100% 。

您可以明确声明表格的高度，也可以通过 CSS 进行设置。如果你去掉百分比符号，那应该将表格的高度设置为静态 100 像素。

# c# - 初始化 C# 哈希表的最简洁方法

> ID：841128
> 
> 赞同：50
> 
> 时间：2009-05-08T18:19:20.463
> 
> 标签：c#, hashtable

C# 是否允许在单行表达式中填充哈希表？我正在考虑类似于以下 Python 的东西：

```
mydict = {"a": 23, "b": 45, "c": 67, "d": 89} 
```

换句话说，是否可以将每个键值对设置为单独的表达式？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-05-08T18:21:33.487

*C# 3 有一个称为集合初始化器*的语言扩展，它允许您在一个语句中初始化集合的值。

这是一个使用 a 的示例`Dictionary<,>`：

```
using System;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        var dict = new Dictionary<string, int>
        {
            {"a", 23}, {"b", 45}, {"c", 67}, {"d", 89}
        };
    }
} 
```

C# 3 编译器和任何实现`IEnumerable`并具有公共`Add`方法的类型都支持此语言扩展。

如果你有兴趣，我建议你阅读[我在 StackOverflow 上问过的这个问题，关于](https://stackoverflow.com/questions/459652/why-do-c-collection-initializers-work-this-way)为什么*C* # 团队以如此奇怪的方式实现了这个语言扩展（一旦你阅读了这个问题的优秀答案，你会发现它会产生很多感觉）。

# javascript - 从脚本调用 .js 文件中的函数

> ID：841129
> 
> 赞同：0
> 
> 时间：2009-05-08T18:19:32.773
> 
> 标签：javascript, scripting

我在 test.html 中有这个：

```
<script>
    function h(){
       g();
    }
<script> 
```

k.js 有：

```
g(); 
```

在 test.html 我成功输入`h()`但没有`g()`。我添加了 k.js 作为脚本标签： `scriptTag.src="k.js"`

它不`g()`只是找到相同的。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-01T01:55:47.910

你说`k.js`有这个：

```
g(); 
```

*这不是一个有效的调用函数*，它只是试图调用`g();`仍未定义的函数。

应该`k.js`是这样的：

```
function g() { alert('you called g()'); } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-01T04:57:00.070

听起来您正在尝试在文档加载或事件触发时添加脚本。如果在将包含该函数的外部文件添加到 dom 后立即尝试调用函数，则会出现错误。外部文件将不会被下载。这个过程有潜伏期。计算机循环浏览客户端脚本的速度比下载 .js 文件的速度要快。设置超时时间，您应该会看到它正常工作。我可能是错的，但这是我的想法......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T18:22:11.067

您是否确保在调用 h() 之前加载了 k.js？

是否成功找到 k.js 并且路径正确解析？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T18:23:22.843

确保您正在调用的函数在 DOM 中高于调用它的行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T18:26:11.650

> 我将 k.js 添加为脚本标签 [ scriptTag.src="k.js" ]

听起来您正在动态编写脚本标签？如果是这样，请确保将其注入到 DOM 中，然后等待浏览器加载它，然后再尝试从中访问任何内容。在您将其注入某处之前，仅创建脚本节点不会做任何事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T20:26:13.903

Does your code look someyhing like this?

```
var scriptTag = document.createElement('script');
scriptTag.src = 'k.js'; 
```

Really, you ought to have this line:

```
scriptTag.type = 'text/javascript'; 
```

And as previously mentioned, the script has to be inserted into the DOM. These two lines should solve the problem:

```
var head = document.getElementsByTagName('head')[0];
head.appendChild(scriptTag); 
```

resulting in:

```
var scriptTag = document.createElement('script');
scriptTag.src = 'k.js';
scriptTag.type = 'text/javascript';

var head = document.getElementsByTagName('head')[0];
head.appendChild(scriptTag); 
```

Now why aren't you using this?

```
<script type="text/javascript" src="k.js" /> 
```

# .net - 带有替换 .config 的 Web 部署项目正在“更改”

> ID：841130
> 
> 赞同：0
> 
> 时间：2009-05-08T18:19:39.480
> 
> 标签：.net, asp.net, encryption, msbuild, cruisecontrol.net

我有 Cruisecontrol.net 构建一个 asp.net Web 部署项目。在我创建多个部署“配置”之前，这很好用。基本上我们有一个开发、测试、阶段和产品。

stage 和 prod 配置有一个 web.config 替换设置，用于将纯文本连接字符串部分更改为我们的生产网络服务器用作加密值的内容。

问题是在构建后生成的 web.config 与我们的源代码控制存储库中的 CipherValue 不同。

msbuild 是否在构建期间重新加密连接字符串？

保罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-11T19:04:17.073

如果您使用的是[这篇 MSDN 文章](http://visualstudiomagazine.com/Articles/2009/06/11/Encrypting-the-Web-Config-File.aspx)中描述的系统，那么如果它是在不同的机器上生成的，那么 CipherValue 会有所不同。但是它们也只能在该构建服务器上使用。

# java - 一个类的大量布尔标志输入

> ID：841134
> 
> 赞同：5
> 
> 时间：2009-05-08T18:20:04.800
> 
> 标签：java, refactoring

我有一个对话框，根据应用程序的状态、当前用户的安全性等显示各种内容。我目前正在传递几个布尔标志，然后根据这些标志启用和/或隐藏 UI 组件。例如：

```
new MyDialog(showOptionsTable, allowFooInput, allowBarInput, isSuperUser) 
```

最初，这开始是几个标志，这很好。但是现在随着需求的变化，它已经演变成五个布尔标志的输入。

处理此类行为的最佳实践方式是什么？这是我应该根据对话框的外观进行子类化的东西吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-08T19:48:36.443

As with many things, "it depends".

1.  Ben Noland suggested a class to hold configuration options. This is doable, but favor immutability, and optionally use the builder pattern. Because booleans are built-in types, writing a small builder will really help people understand the code. If you compare this to MyDialog(true, true, ...) you know what I mean:

    Options.allowThis().allowThat().build()

2.  Chris suggested bit fields, but as some of the commenters point out, bit fields are evil because of many reasons outlined in Josh Bloch's Effective Java. Basically they are hard to debug and error prone (you can pass in any int and it will still compile). So if you go this route, use real enums and EnumSet.

3.  If you can reasonably subclass (or compose), meaning that you usually only use a couple of combinations of all the booleans, then do that.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-08T18:21:51.690

一旦你得到两个或三个以上的标志，我会考虑创建一个类来存储这些设置以保持你的设计干净。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-08T19:10:12.510

创建一个类来保存您的配置选项：

```
public class LayoutConfig
{
    public boolean showOptionsTable = true;
    public boolean allowFooInput = true;
    public boolean allowBarInput = true;
    public boolean isSuperUser = true;
}

...

LayoutConfig config = new LayoutConfig();
config.showOptionsTable = false;

new MyDialog(config); 
```

这种方法可以轻松添加新选项而无需更改界面。它还将使您能够添加非布尔选项，例如日期、数字、颜色、枚举......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-08T18:23:02.827

使用[装饰器模式](http://en.wikipedia.org/wiki/Decorator_pattern)为您的对话框动态添加行为

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-08T19:37:51.837

To build on Ben Noland answer, you could define some options as enum, then have a varargs constructor:

```
class MyDialog {
   enum DialogOptions {
      SHOW_OPTIONS_TABLE, ALLOW_FOO_INPUT, ALLOW_BAR_INPUT, IS_SUPER_USER
   }
   public MyDialog(DialogOptions ...options) { ... }
}

...
new MyDialog(DialogOptions.ALLOW_FOO_INPUT, DialogOptions.IS_SUPER_USER); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-08T20:10:27.297

I have found that this kind of thing becomes MUCH more readable if I use `enum`s for the boolean choices.

```
public enum ShowOptionsTable { YES, NO }
public enum AllowFooInput { YES, NO }
public enum AllowBarInput { YES, NO }
public enum IsSuperUser { YES, NO }

new MyDialog(ShowOptionsTable.YES, AllowFooInput.NO, AllowBarInput.YES,
             IsSuperUser.NO); 
```

With enums like this, usage of code with a lot of boolean parameters becomes easy to understand. Also, since you are using objects rather than booleans as parameters, you have use other patterns to easily refactor things later if you want, to use a decorator or a facade or some other pattern.

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-08T21:37:30.597

根据您的显示将有多么不同，您可能会考虑对您的显示类进行子类化（即`MyDialogSuperUser`或类似的）。您需要考虑对话类的输入的正交性以及如何表达这种正交性。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-08T20:32:11.050

I prefer flagged enums to a settings class if the parameters are all going to be boolean. If you can't guarantee that in the future though it would be better safe than sorry though. Here's another implementation for flags:

```
[Flags]
public enum LayoutParams
{  
    OptionsTable = 1,  
    FooInput = 2,  
    BarInput = 4,  
    SuperUser = 8,
}

public MyDialog(LayoutParams layoutParams)
{
    if (layoutParams & LayoutParams.OptionsTable)
    { /* ... Do Stuff ... */ }
}

public static MyDialog CreateBasic()
{
    return new MyDialog(LayoutParams.OptionsTable | LayoutParams.BarInput);
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-08T22:03:12.970

我有一个最喜欢的方法来处理这个问题，但它并不适用于所有用例。如果布尔值不是完全独立的（比如说有一些无效的布尔值组合，或者通过可识别的场景达到布尔值的组合。）我为状态创建一个枚举，然后定义一个持有标志的构造函数：

```
public enum status {
    PENDING(false,false),
    DRAFT(true,false),
    POSTED(false,true),
    ;
    public boolean isSent;
    public boolean isReceived;
    status(boolean isSent, boolean isReceived) {
        this.isSent = isSent;
        this.isReceived = isReceived;
    }
} 
```

像这样的一段代码的优点是您可以相对简洁地构造枚举常量，但仍然允许代码只关心状态的一个特定方面。例如：

```
//I want to know specifically what the state is
if (article.state == status.PENDING)
// Do something

//I really only care about whether or not it's been sent
if (article.state.isSent)
// Do something

//I want to do something specific for all possible states
switch(article.state)
// A string of case statements 
```

另一个好处是，如果您很好地定义了枚举，则永远不会达到非法状态：

```
if (article.state.isReceived && !article.state.isSent) {
// This block can never execute ever.
} 
```

诚然，布尔值之间并非总是存在逻辑关系，但我确实建议将它们映射出来。如果布尔值的子集具有逻辑关系，则可能值得将它们分解为枚举。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-05-08T18:41:59.897

如果 GUI**取决于**应用程序的状态（一种状态导致另一种状态），您可以查看[状态](http://en.wikipedia.org/wiki/State_pattern)模式。每个新状态将由不同的对象处理，您可以编写标志是否应该去的代码。

IE。

```
abstract class State { 
      public abstract boolean [] getFlags();
      public abstract State next();
 }
 class InitialState extends State  { 
      public boolean [] getFlags() {
          return new boolean [] { true, true, false, false, false };
      }
      public State next() { return new MediumState(); }
 }     
 class MediumState extends State { 
     public boolean [] getFlags() { 
         return new boolean[] { false, false, true, true, false };
     }
     public State next() { return new FinalState(); }
 }
 class Final extends State { 
     public boolean [] getFlags() { 
         return new boolean[]{false, false, false, false, true };
     }
     public State next() { return null;}
  } 
```

并使用此状态显示您的对话框

```
new MyDialog(showOptionsTable, new InitialState() ); 
```

……

当应用程序的状态发生变化时，您会更改 State 对象。

```
public void actionPerfomed( ActionEvent e ) { 
    this.state = state.next();
    repaint();
 } 
```

要绘制对话框的各个部分，请查询状态：

```
 if( state.getFlags()[SECURITY] ) { 
      /// show security stuff
  } if ( state.getFlags()[VIEW_ONLY] ) { 
      // enable/disable stuff 
  } .... 
```

您可以更进一步，让国家定义呈现的内容。

```
abstract class State { 
      public abstract JComponent getComponent();
      public abstract State next();
 } 
```

所以每个状态显示不同的部分：

```
 Dialog.this.setContentPane( state.getComponent() ); 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-05-08T18:26:56.187

将其设置为 MyDialog(false, false, .....) 是预期的默认行为。（即：最常见的情况应该全部为假。您可能需要反转标志的语义。）

现在，定义常量：

```
OPTION1 = 1
OPTION2 = 2
OPTION3 = 4
OPTION4 = 8
... 
```

更改方法以采用 int 选项参数

```
public void MyDialog(int options) ... 
```

现在调用它：

```
MyDialog(OPTION1 | OPTION3)  // enable Opt1, opt2) 
```

方法内部：

```
if (options & OPTION1) // use Option 1 config. 
```

等等

# vb.net - 在 .NET 中解码基本授权的最简单方法

> ID：841144
> 
> 赞同：5
> 
> 时间：2009-05-08T18:21:40.273
> 
> 标签：vb.net, authorization, httplistener

我需要在 VB.NET 中验证发送到我的 HttpListener 的基本授权标头。我像这样抓住标题（请随时指出更好的方法来做到这一点）：

```
EncodedAuth = Context.Request.Headers.GetValues("Authorization")(1) 
```

现在我该如何解码它们？我理解[这个理论](http://en.wikipedia.org/wiki/Basic_access_authentication)，但我似乎找不到正确的代码。

谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-08T18:26:35.610

这个应该做...

```
basicData = System.Text.ASCIIEncoding.ASCII.GetString( System.Convert.FromBase64String( EncodedAuth ) ) 
```

这将为您提供格式为“用户名：密码”的字符串。在“：”上拆分字符串，您将获得凭据。

# php - PHP 中的数据清理

> ID：841152
> 
> 赞同：6
> 
> 时间：2009-05-08T18:22:49.317
> 
> 标签：php, sanitization

有人可以推荐一个最新的 PHP 数据清理库吗？

我正在寻找一个库，它提出了一组数据清理功能。电子邮件验证/清理（删除那些 %0A、\r...）、剥离 htlm（stripslashes(htmlentities)、删除脚本、SQL 注入……与用户提交的数据相关的任何形式的利用。

[CakePHP](http://api.cakephp.org/file/libs/sanitize.php)清理类（不是“框架”）看起来不错.. ?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-08T18:27:04.767

查看[PHP 过滤器](http://www.phpro.org/tutorials/Filtering-Data-with-PHP.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T18:28:17.340

[Zend 过滤器](http://framework.zend.com/manual/en/zend.filter.html)，[Zend 过滤器输入](http://framework.zend.com/manual/en/zend.filter.input.html)和[Zend_Validate](http://framework.zend.com/manual/en/zend.validate.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-27T10:20:05.577

```
$firstName = $_POST['fname'];
$new_string = filter_var($firstName, FILTER_SANITIZE_STRING);
echo $new_string; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T18:27:42.207

CakePHP 是一个框架，而不是一个卫生库。

编写自己的清理函数可能更容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T18:39:07.250

没有数据清理之类的东西。数据本身并不危险——它的使用环境决定了它的安全或不安全。这意味着在输入时尝试验证/清理数据是没有意义的。相反，您应该在输出时正确转义它。另请参阅我的[答案](https://stackoverflow.com/questions/129677/whats-the-best-method-for-sanitizing-user-input-with-php/130323#130323)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T20:03:08.467

用于在需要保留 html 标记时过滤掉 xss 攻击：[htmlpurifier](http://htmlpurifier.org/)

如果不需要保留 html 标记，可以使用[htmlspecialchars](http://php.net/manual/en/function.htmlspecialchars.php)或[htmlentities](http://www.php.net/manual/en/function.htmlentities.php)

# .net - 从 postgres 调用外部 DLL 中的 .NET 函数

> ID：841158
> 
> 赞同：0
> 
> 时间：2009-05-08T18:23:35.383
> 
> 标签：.net, postgresql, dll

可以通过调用 C 函数，[`CREATE FUNCTION`](http://www.postgresql.org/docs/8.3/interactive/sql-createfunction.html)但是如何从 postgres 调用 dll 中的 .NET 函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T18:31:28.500

看起来从 PosgtreSQL 调用 C 函数有一些开销， Postgres 中的[外部函数](http://linuxgazette.net/139/peterson.html)@ Linux Gazette 涵盖了用 C 编写这样的方法。我推测，如果你真的需要，你可以构建一个加载的托管模块一个 CLR 实例，并为您的 C# 方法提供一个入口点，该入口点使用适当的 Postgres 链接逻辑进行映射。这似乎非常昂贵。

另一种可能更好的方法是将 C# 方法（我假设它已经编写）封装在 Web 服务中，并使用包装器（不一定是 C，而是 Postgres 的轻量级扩展开发绑定之一）将调用 Web 服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T18:45:56.797

[您可以使用CREATE FUNCTION](http://www.postgresql.org/docs/8.3/interactive/sql-createfunction.html)定义外部函数。此引用意味着 DLL 必须是使用 C 调用约定的本机 DLL，因此无法处理托管代码。

您可以尝试使用[Mono AOT](http://www.mono-project.com/AOT)或[MS Native Image Generator](http://msdn.microsoft.com/en-us/library/6t9t5wcf(VS.80,loband).aspx)将托管代码编译为本机代码，但我不知道这是否会导致使用 C 调用约定的本机 DLL。你得试试。

如果这不起作用，您可以为您的 DLL 创建一个未管理的包装器。

**更新**

您必须编写一个包装器 - [C 语言函数](http://www.postgresql.org/docs/8.3/interactive/xfunc-c.html)声明 DLL 必须包含一个魔术块，如果您将托管代码编译为本机代码，该块将不可用。

# python - 使用 lex/yacc 标记剩余数据

> ID：841159
> 
> 赞同：3
> 
> 时间：2009-05-08T18:23:39.907
> 
> 标签：python, yacc, lex, ply

原谅我，我对解析和 lex/yacc 完全陌生，我可能有点不知所措，但尽管如此：

我正在用 PLY 编写一个非常基本的计算器，但它的输入可能并不总是一个方程，我需要在解析时确定它是否是。输入的极端情况是可以完美地评估为方程，它可以很好地解析和计算，或者与方程完全不同，它解析失败并且也很好。

灰色区域是具有等式部分的输入，解析器将抓取并计算出这些部分。这不是我想要的——我需要能够判断字符串的某些部分是否没有被拾取和标记，这样我就可以抛出一个错误，但我不知道该怎么做。

有谁知道我如何定义，基本上，一个“抓住任何剩下的东西”令牌？还是有更好的方法可以处理这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T06:31:03.463

定义一个标记（输入结束），并让你的词法分析器在输入结束时输出它。

所以之前，如果你有这些令牌：

```
'1' 'PLUS' '1' 
```

您现在将拥有：

```
'1' 'PLUS' '1' 'END_OF_INPUT' 
```

现在，您可以在解析器中定义您的顶级规则。而不是（例如）：

```
Equation ::= EXPRESSION 
```

你会有

```
Equation ::= EXPRESSION END_OF_INPUT 
```

显然，您必须用 PLY 语法重写这些，但这应该可以帮助您完成大部分工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T23:33:39.680

yacc中有一个内置`error`令牌。您通常会执行以下操作：

 ``line: goodline | badline ;

badline : error '\n' /* Error-handling action, if needed */` 

`goodline : equation '\n' ;`

任何不匹配的行`equation`将由`badline`.

您可能希望`yyerrok`在错误处理操作中使用以确保为下一行重置错误处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T00:06:45.560

我通常使用一个单独的“命令阅读器”来获取一个完整的命令——在你的情况下可能是一行——进入一个主变量字符串，然后安排词法分析器来分析这个字符串，包括告诉我它什么时候没有到达结尾。这很难设置，但会使某些类别的错误报告更容易。我经常使用这种技术的地方之一是多行命令，带有 3 个注释约定、两组引用的字符串，以及一些其他让我难以接受的讨厌的东西（上下文敏感的标记化 - 糟糕！）。

否则，Don 对 Yacc 'error' 令牌的建议是好的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T14:51:13.653

看起来您已经找到了解决方案，但如果您或其他人对替代方法感兴趣，我会添加另一个建议。

您说您正在使用 PLY，但那是因为您希望编译器在 Python 环境中运行吗？如果是这样，您也可以考虑使用其他工具。对于这样的工作，我经常使用具有 Python 代码生成器的ANTLR ( [http://www.antlr.org )。](http://www.antlr.org)ANTLR 有很多技巧可以做一些事情，比如在词法分析器级别吃一堆输入，这样解析器就永远不会看到它（例如注释），能够在更大的语法中调用子规则（例如方程）（一旦规则已匹配，无需处理任何更多输入...听起来有点像您想要做的）和一个非常好的左因子算法。

ANTLR 的解析能力与 StringTemplate ( [http://www.stringtemplate.org](http://www.stringtemplate.org) ) 引擎的使用相结合，形成了一个很好的组合，并且都支持 Python（以及许多其他）。

# c# - 使用 C# 代码加载 ascx 组件

> ID：841161
> 
> 赞同：10
> 
> 时间：2009-05-08T18:25:41.137
> 
> 标签：c#, asp.net, ascx

有什么方法可以使用 C# 加载然后“渲染”一个 ascx 控件？

本质上，我试图用 C# 函数替换内联 ASP，该函数将返回相同的 HTML。然后，这将让我将其设置为 webmethod，以便我可以使用生成原始 html 的相同代码使用 jQuery 更新页面的该部分。

我真的需要某种方式来做到这一点，这似乎是一条合乎逻辑的路线。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-08T19:33:45.137

You need to create a page in which you render the control:

```
public static string RenderUserControl(string path)
{
    Page pageHolder = new Page();
    Control viewControl = pageHolder.LoadControl(path);

    pageHolder.Controls.Add(viewControl);
    using(StringWriter output = new StringWriter())
    {
        HttpContext.Current.Server.Execute(pageHolder, output, false);
        return output.ToString();
    }
} 
```

A user control on its own will not render. ([This article](http://jamesewelch.com/2008/07/11/how-to-render-a-aspnet-user-control-within-a-web-service-and-return-the-generated-html/) has some related information from which I borrowed some code).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-20T14:08:50.507

Keltex 的答案是唯一对我有用的，因为我正在使用嵌套的用户控件。此外，如果您想将参数传递给您的用户控件，您可以通过以下方式进行：

```
_MyNameSpace_MyUserControl viewcontrol = (_MyNameSpace_MyUserControl) pageHolder.LoadControl(path);

viewcontrol.MyParam = "My value"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T18:50:15.787

这个[解释](http://aspalliance.com/565)应该有你正在寻找的答案。基本上，您必须在页面中声明控件，然后在代码隐藏中声明 LoadControl。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T18:41:06.137

我没有尝试过，但是您可以使用 LoadControl 函数加载控件：

```
Control Example = LoadControl("~\\Controls\\MyControl.ascx"); 
```

然后你可以尝试渲染控件：

```
StringWriter sw = new StringWriter();
HtmlTextWriter htw = new HtmlTextWriter(sw);
Example.RenderControl(htw);
Response.Write(sw.ToString());
Response.End(); 
```

但请确保在页面上覆盖 VerifyRenderingInServerForm 并将 EnableEventValidation 切换为 false。

忘记我上面写的。我回去测试了，你不能调用 LoadControl，因为 webmethod 是静态的。由于它是静态的，因此您没有要调用的 Page 对象...这意味着无需动态加载用户控件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-14T20:25:50.833

its very simple to use:

```
yourItem.Controls.Add(LoadControl("~/user control File path")); 
```

# c# - 如何在 C# 中以编程方式关闭 Windows XP Print Spooler 服务

> ID：841162
> 
> 赞同：3
> 
> 时间：2009-05-08T18:25:47.610
> 
> 标签：c#, windows, windows-xp, console-application

我需要编写一个小型控制台应用程序（补丁）来关闭打印后台处理程序服务，做一些事情，然后启动打印后台处理程序服务。我想用 C# 写这个。有人可以指出我正确的方向吗？提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T18:36:12.157

您可能可以使用 ServiceController 类来做到这一点：

```
ServiceController controller = new ServiceController("Spooler");
controller.Stop();
...
controller.Start(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T18:28:25.887

```
net start spooler
net stop spooler 
```

[http://www.tech-recipes.com/rx/864/windows-service-managing-through-command-line/](http://www.tech-recipes.com/rx/864/windows-service-managing-through-command-line/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T18:34:52.330

我怀疑您使用`ServiceController`该类来控制（即停止和启动）名称为`spooler`.

# mysql - 为什么 MySQL 数据连接器比 MySQL 查询浏览器花费这么多时间？

> ID：841169
> 
> 赞同：2
> 
> 时间：2009-05-08T18:26:41.163
> 
> 标签：mysql

我有一个来自单个表的非常简单的查询（三个 where 条件；两个等于，一个介于两者之间），在 MySQL 查询浏览器中，查询运行不到半秒，返回 8300 条记录。如果我使用 MySQL 数据连接器（实际上只是一个 OLEDB 包装器）运行完全相同的查询，则大约需要 35 秒。

正在使用的引擎是 MyISAM（如果重要的话）。我正在使用 Visual Studio 2008（如果重要的话）。编辑：使用 MySQL 数据连接器 5.2.5。编辑，编辑：切换到 MySQL Data Connector 6.0.3（最新版）将其缩短到 29 秒。

查询是：

```
select drh_data.reading_time, drh_data.raw_value, drh_data.float_value, drh_data.data_quality
from drh_data
where drh_data.site_id=202
and drh_data.device_id=7
and reading_time between '2009-04-08 11:15:01' and '2009-05-08 11:15:02'
order by drh_data.reading_time desc; 
```

有任何想法吗？

更新：我终于开始检查 CPU 使用情况（如回答者建议的那样），发现我的应用程序使用了 50% 的 CPU 时间。运行 MySQL（在 CentOS 中）的 VirtualPC 机器在这 20 秒（左右）内只有 0%，所以问题都出在客户端。我还对查询进行了解释，结果如下：

```
id  select_type table   type    possible_keys                               key                             key_len     ref     rows    Extra
1   SIMPLE  drh_data    range   PRIMARY,idx_site_device_reading_receive     idx_site_device_reading_receive 11                  7674    Using where 
```

我在这里被轻拍了。有没有人有任何想法来解决这个问题？我即将诉诸通过 LIMIT 分解选择，但我认为我不应该这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T18:56:50.937

在使用 ADO.NET 与 SQL Server 查询分析器之前，我遇到了这个问题。当我们从 Query Analyzer 运行查询时，查询会在亚秒内执行，而当我们从 Web 应用程序运行它时，它需要 2 分钟以上。无论出于何种原因，将索引应用于表似乎加快了我们的应用程序和数据库之间的数据连接。

我不知道 MySQl 和 SQL Server 之间的操作差异，但在我们的案例中似乎发生的另一件事是执行缓存已填满，这会减慢所有未缓存执行计划的执行速度。我们实施了每周清除该缓存的作业。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T23:29:54.260

我建议检查那几秒钟的工作（CPU 使用率），是 mysql 还是您的代码或其他东西。您也可以考虑使用`EXPLAIN`来查看在一种或另一种情况下发生的情况并进行比较。

# apache-flex - 在弹性组件之间传递数据

> ID：841181
> 
> 赞同：3
> 
> 时间：2009-05-08T18:29:42.530
> 
> 标签：apache-flex, actionscript-3, flex3

我是 flex 新手，如果这是一个愚蠢的问题，请原谅我。

现在我正在使用自定义事件将数据从一个组件传递到另一个组件。我的问题是事件只会冒泡。如何将数据传递给不是调度事件的组件的父组件？

这是基本布局。我正在尝试从组件 1 中获取传递给组件 3 的数据。

```
Application MXML
     Component 1
     Component 2
          Component 3 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-08T19:40:02.893

如果图/树中的所有组件都需要一条数据，最好的办法是在每个组件上公开一个公共的可绑定属性。让子组件调度一个由父组件处理的冒泡事件，父组件可以设置可绑定属性的新值。如果您将属性从父级绑定到子级，这将“级联”到其他组件。

```
<!-- in root application -->
<Component1 myData="{myData}"/> 
```

如果您需要调用其他逻辑，您可以定义一个 get/set 对而不是 public var 并将逻辑添加到 setter：

```
[Bindable] private var _myData;
public function set myData(value:Object):void
{
    _myData = value;
    doSomeLogic();
} 
```

更好的是使用 Flex 的失效框架来优化性能：

```
_myDataChanged : Boolean = false;
[Bindable] private var _myData;
public function set myData(value:Object):void
{
    if (_myData != value) {
        _myData = value;
        _myDataChanged = true;
    }
    invalidateProperties();
}

override protected function commitProperties() : void {
    super.commitProperties();
    if (_myDataChanged) {
        _myDataChanged = false;
        doSomeLogic()
    }
} 
```

这种模式在构成 Flex 框架的所有 UIComponents 中到处使用。您可能还需要覆盖 updateDisplayList(...) 来定位元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T18:35:19.287

最简单的方法就是访问其他组件。

```
<Component1 name="component1/>

<Component2 name="component2" onClick="onClickHandler()"/>

private function onClickHandler(event:MouseEvent):void
{
    component1.property1 = "Random data";
    component1.sendData("Random Data");
} 
```

当你在 component1 中设置一个可绑定的公共属性时，它会引发一个 PropertyChangedEvent，你也可以处理它。

你有很多选择，看看哪一个在你想要做的事情的背景下是最好的。

编辑：进一步阅读我认为您正在尝试做的事情，您正在尝试从组件 2 访问组件 3，但组件 3 对组件 1 不可见？不过，它仍然应该可以通过 component2 访问（组件往往是公共成员）。

```
private function component1OnClickHandler(event:MouseEvent):void
{
     component2.component3.property1 = "Random data";
} 
```

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-24T20:01:40.670

我最近遇到了这个问题！！所以这就是我克服它的方法，以防有人在 5 年后需要它；-)

这个[链接](http://www.flextras.com/blog/index.cfm/2013/2/1/How-does-one-Flex-Component-talk-to-another-Flex-Component)很好地解决了这个问题。

* * *

*   创建一个自定义事件类，其中包含要作为该类成员传递的所需数据（如此处所示[）](http://www.adobe.com/devnet/flex/videotraining/exercises/ex3_03.html)。
*   从 Component1 调度自定义事件

    ```
    dispatchEvent(new CustomEvent("customEvent",myData)); 
    ```

*   在 Component2 中创建一个以**myData**作为参数的方法
*   在父Component中添加EventListener，调用Component2中的方法传递**event.myData**

# version-control - 列出 CVS 中一年内未编辑的所有文件

> ID：841183
> 
> 赞同：3
> 
> 时间：2009-05-08T18:30:13.217
> 
> 标签：version-control, cvs

如何在 CVS 的存储库中获取过去一年未更改的所有文件的列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T14:23:12.867

我们可以使用 ViewVC（或以前称为 ViewCVS）轻松做到这一点。它所做的是构建一个包含所有文件及其提交（带有评论和作者）的 SQL 数据库，您可以通过多种方式轻松查询。

您可以从[http://www.viewvc.org/](http://www.viewvc.org/)下载它。您必须设置 MySQL 服务器来存储数据，并有权访问 CVS 服务器上的物理存储库目录，以通过该`cvsdbadmin`工具导入现有存储库提交：

```
cvsdbadmin rebuild /var/lib/cvs 
```

`/var/lib/cvs`您的存储库位置在哪里。数据库连接信息存储在 ViewVC 配置文件中。

根据存储库的大小，这可能会运行几秒钟到几小时不等。完成后，您可以使用常规 SQL 查询工具来查找有关您的提交的各种信息 - 我们使用它来非常快速地生成更改日志。使用[CVS loginfo 脚本](http://ximbiot.com/cvs/manual/cvs-1.11.21/cvs_18.html "CVS 日志信息")（也包含在 ViewVC 中），每当有人向 CVS 提交文件时，我们都会即时更新数据库。

如果您不小心犯了一些错误，这也会很有帮助（请参阅[此博客文章](http://dschneller.blogspot.com/2007/09/value-of-cvs-commit-database.html "这篇博文")）；由于 CVS 提交不是事务性的，这可能很难弄清楚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T03:37:07.943

我能想到的唯一方法是获取去年更改的每个文件的列表（这里我使用 2008-05-08 作为一年前的日期）：

```
cvs history -c -D2008-05-08 
```

并与存储库中当前每个文件的列表进行比较。那些不在生成的列表中的那些在`cvs history`去年没有被修改过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T14:38:45.613

如果您有权访问存储库，则可以搜索以查找上次修改日期超过一年前的文件。在 CVS 中，每个文件都有一个对应的存储库文件。（这在 Subversion 中不起作用，因为存储库是不透明的格式。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T07:54:38.133

显示相同文件的 CVS diff 选项（--report-identical-files）似乎坏了，至少对我来说。您可以签出旧版本：

```
cvs co -D "1 year old" proj 
```

并使用良好的旧差异来查找相同的文件：

```
diff --recursive --report-identical-files --brief | grep identical 
```

# visual-studio - 从 Visual Studio 6.0 到 Visual Studio 2008

> ID：841184
> 
> 赞同：0
> 
> 时间：2009-05-08T18:31:03.993
> 
> 标签：visual-studio, visual-studio-2008, visual-c++

VC++ 6.0 版本应用程序转换为 VC++ 2008 时，会出现[LINK2001](http://msdn.microsoft.com/en-us/library/f6xx1b1z(vs.71).aspx) / [LNK2019](http://msdn.microsoft.com/en-us/library/799kze2z(VS.80).aspx)联动错误。

但是相同的代码在 VC++ 6.0 中编译和链接并运行没有任何问题

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T18:04:40.770

从 VC6 跳转到 VS2008 意味着处理 VS2003、VS2005 和 VS2008 中的重大更改。[在此处](http://msdn.microsoft.com/en-us/library/ms235427.aspx)和[此处](http://msdn.microsoft.com/en-us/library/ms177253.aspx)阅读更多信息。只是一个猜测 - 需要更多细节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T19:16:50.297

Looks like your project is depending on another external library. In VC6, you set the paths properly from Options/Settings, but you missed that in VC2008\. That's just a wild guess though..

# integration - 设计最终将合并到旧应用程序中的新应用程序的方法

> ID：841185
> 
> 赞同：0
> 
> 时间：2009-05-08T18:31:05.287
> 
> 标签：integration, legacy-code

目前我在一个用 C# 开发新的独立应用程序的团队中。最终目标是将这个独立的应用程序滚动到以前开发的与相同流程相关的更大的应用程序中。

我的问题是：我正在寻找有关方法或流程的信息，以帮助 A) 设计所述较新代码，特别是当旧代码不是最好的最可维护的系统时，以及 B) 集成所述较新应用程序。

显然没有什么特别的，我们的应用程序在设计上是独一无二的，因此将有任何方法无法帮助的细节。但是，我有兴趣获得有关该主题的一些良好的一般知识。

**编辑：** 到目前为止的建议，重构旧代码，将新代码构建为模块的容器，并在单元测试中覆盖新旧代码，总的来说都是很好的实践，也是我尽可能练习的事情。但在我看来，这些将是整体方法论的各个部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-22T04:33:40.223

首先，您需要了解旧应用程序在内部是如何工作的。它如何管理工作流程、会话、用户权限等。

当你设计你的新代码时，你应该特别注意以分层的方式构建小的、可重用的组件。当然，这没什么特别的，优秀的程序员总是会尝试这样做，但在给定的场景中更重要。在某些时候，要使其成为一个独立的应用程序，您将不得不复制旧应用程序中已经存在的一些部分，例如登录屏幕、工作流管理等。确保您要么重用旧系统中的这些部分，要么制作新的部分 API 兼容并与主要业务逻辑分离。通过这样做，将新应用程序集成到旧应用程序中会容易得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T16:55:32.483

我不确定这是否是您正在寻找的答案，因为它与方法无关，而是与应用程序架构有关。

也就是说，如果您将独立设计为托管应用程序组件的轻量级容器，则实际上您允许稍后将组件迁移到更大的上下文中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T17:17:23.157

Fowler 建议重构旧代码。这需要一些时间，但是：

A) 将此代码与您的新代码集成会更容易；

B）您和您的团队将更好地理解旧代码。

在你的情况下，我也会考虑用单元测试覆盖你的代码，也许还有旧代码。

# c# - 关于 Visual Web GUI 的建议

> ID：841186
> 
> 赞同：2
> 
> 时间：2009-05-08T18:31:17.207
> 
> 标签：c#, asp.net, frameworks

有没有人使用过这个 [Visual Web Gui](http://www.visualwebgui.com) ，他们的说法对吗？我一直在他们的网站上阅读，您可以同时制作 Web/Desktop App 似乎很神奇，而且他们说您不必再担心更新面板、AJAX，这一切都在服务器上，而且他们有第 3 方控件的包装器。

我的意思是总而言之，理论上它看起来很棒，但现实呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-02-05T16:42:37.447

我们有一个使用 Visual Web GUI 构建的生产商业软件应用程序。

我们不可能使用像 aspx 这样的传统堆栈来构建这个系统。我们的网站是[http://www.hrtms.com](http://www.hrtms.com)

VWG 最适合业务线应用程序.. 不是 Web 2.0/弹跳球/youtube/视频或社交网络类型的应用程序。

以下是我们所学到的： 1\. 不要试图扩展到 1000 多个用户。每个用户都有一个服务器端 statefull 组件，因此直观地说，与传统应用程序相比，这将限制用户数量，即无国籍。2\. 最适合具有大量复杂业务规则和数据的业务应用程序（绝对是我们的！） 3\. 最适合可以使用 VWG 附带的标准外观和感觉的应用程序.. 所以你真的不能用它来构建 Facebook。大多数 VWG 应用程序看起来像 Outlook。4.当然你必须使用.Net堆栈

积极的一面： 1\. 您可以非常快速地淘汰大量系统...因为该框架基于 Winform 模型。您确实需要以不同的方式处理模态表单，但在大多数情况下，代码看起来和感觉就像 winform 代码。

2.  网络流量很小。一旦客户端下载了 javascript 引擎，网络仅用于发布命令和数据。

3.  在服务器上为 Web 应用程序进行有状态编程要比无状态编程容易得多。您可以加载复杂的对象树并知道当用户与您的系统交互时它们会在那里。

4.  使用 html/javascript/css 不再痛苦。VWG 根据所使用的浏览器对其进行映射。

好的，不利的一面：1.可扩展性..您需要计划在这些应用程序上投入大量硬件..我估计每个盒子大约有 200 -300 个并发用户。好消息：硬件便宜.. 2\. 直到 6.4 出来，我们仍然在处理一些浏览器的讨厌的版本问题......所以现在对 IE 以外的支持不是 100% 3\. Silverlight 插件支持现在暂停.. 他们想在 SL 稳定时支持这一点。

总的来说..它是一个很棒的工具。没有魔法.. 它是一个智能 ajax 应用程序.. 试试看。

顺便说一句..我不是这个工具的雇员或代理人。

米奇

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T19:15:13.490

对于任何声称它会为我完成所有工作的产品，我都有一种与生俱来的不信任。通常，这意味着一两件事：

1.  它会做*它认为我应该做的所有事情，并忽略**除了*主要任务之外我需要做的所有细节
2.  它可以处理所有细节，但安装、配置或使用它需要比我自己做更多的工作

也就是说，我从来没有使用过这个产品，也不能真正给出超出我自己怀疑的意见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-13T18:15:21.450

我认为米奇对这个问题给出了很好的回答。我已经使用这个工具构建了几个应用程序，而 Mitch 是 100% 正确的。此时，他们并没有做任何花哨的事情，所以没有什么可偏执的。Gizmox 并没有声称他们可以为你做任何事情，但他们做得好的是他们框架的 AJAX 部分。我可以轻松创建出色的 UI 并启动并运行数据/业务规则/ORM；为用户带来出色的体验。

然而，话虽如此，主题化很耗时。这并不难，但很乏味。此外，您必须了解应用程序的状态、有多少视图处于活动状态等。正如 Mitch 所说，它在服务器上保存每个用户的信息，因此请注意。

总的来说，这是一个很棒的框架。如果您正在考虑快速构建一些东西（甚至是原型设计），那么您不会出错。还记得使用 VB6 进行原型设计的日子，那在当时简直是天赐之物。此外，如果应用程序适合 Winforms 应用程序（或 SWING，如果需要），那么 VWG 非常适合。这并不是说将 MVC 与 Telerik 或其他一些 RIA 3rd 方工具一起使用不会产生很好的结果，而是需要更长的时间。VWG 就是它所说的那样，这也是米奇和我所说的。

发展没有灵丹妙药，没有万能的框架，这是不可能的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-20T12:59:25.087

我使用 VSGui 已经 3 年了，一旦部署它就非常稳定，它在所有浏览器上都以相同的方式运行，所以你不必担心修复 css，它真的很强大。

不好的一面是，它加载了很多服务器，并且不像公共网站那样可用，它更具体地用于内部工具和私人项目。

我喜欢它的地方在于，您可以在 Windows 窗体中工作，并且可以发布网络。

# jquery - 如何将输入字段的一部分复制到另一个字段？

> ID：841189
> 
> 赞同：0
> 
> 时间：2009-05-08T18:31:30.997
> 
> 标签：jquery, input, copy

我知道如何将输入字段复制到其他内容。没问题。如何将部分（即日期字段的月份）复制到另一个字段。

我想获取一个日期范围的字段（即 7-13-09 到 7-15-09）并将其复制到两个输入字段（即开始日期和结束日期）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T18:45:54.987

```
$("#startDate, #endDate").each( function( i ) {
    $(this).val( $("#dateRange").val().split(" to ")[ i ] )
}) 
```

# variables - 从查询中设置 ColdFusion 动态应用程序变量

> ID：841190
> 
> 赞同：1
> 
> 时间：2009-05-08T18:31:50.840
> 
> 标签：variables, coldfusion, application.cfc

我四处闲逛，并认为将我的应用程序变量移动到可以在ApplicationStart 上加载的表中会很好。

我的意图是允许 ANT 推出应用程序，并更改数据库中的一些设置和众所周知的 presto..

在我的测试代码中，application.cfc 有一个简单的查询来调用所有变量名，然后有一个 cfloop 来将应用程序范围内的每个变量设置为 application.varname。

ApplicationStart 上没有报告错误..但是尝试引用变量会给出未定义的类型错误。

我的蜘蛛感官告诉我这是一件小而明显的事情……有什么想法吗？

谢谢！！

**更新1：似乎我正在查看的是设置动态变量名称，而它们是应用程序变量这一事实似乎没有太大影响。**

[http://www.bennadel.com/blog/152-Dynamic-ColdFusion-Variables-Via-Quoted-Naming.htm](http://www.bennadel.com/blog/152-Dynamic-ColdFusion-Variables-Via-Quoted-Naming.htm)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-08T22:39:07.377

我不知道作者是在提倡这种语法还是仅仅证明它有效，作为一个兴趣点。

就个人而言，我更喜欢数组表示法。我认为这有助于促进良好的范围界定习惯。

```
<!--- array notation --->
<cfset scope["staticName"& dynamicPortion] = "some value"> 

<!--- example 1  --->
<cfset variables["baseName"& x] = "oh brother">
<!--- example 2  --->
<cfset variables["baseName#x#"] = "oh brother"> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T19:37:23.507

The answer to my question was to set dynamic variable names by quoting the names..

```
<!--- Loop over the girls and alter the values. --->
<cfloop index="intGirl" from="1" to="3">

<!--- Randomly pick 1 (true) or 0 (false). --->
<cfif RandRange( 0, 1 )>

<!--- Set the dynamic variable naming used quoted evaluation. --->
<cfset "Girl#intGirl#" = "super sexy" />

</cfif>

</cfloop> 
```

More here...

[http://www.bennadel.com/blog/152-Dynamic-ColdFusion-Variables-Via-Quoted-Naming.htm](http://www.bennadel.com/blog/152-Dynamic-ColdFusion-Variables-Via-Quoted-Naming.htm)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T18:58:55.657

使用 cfloop + cfset 而不是 cfoutput

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T19:11:16.783

如果我正确阅读了您的问题，您是说您在 cfoutput 标记内设置应用程序变量？

您是否使用 cfoutput 之类的

```
<cfoutput query="queryName">
  <!--- Setting code in here --->
</cfoutput> 
```

您应该使用 cfloop 而不是 cfoutput

```
<cfloop query="queryName">
  <cfset application.varName = queryName.varName />
</cfloop> 
```

但是，如果没有一些代码，很难提供帮助。

我的问题是：如果您只是要将应用程序变量转储回应用程序范围，为什么要将它们存储在数据库中？

# macos - 在 Mac OS X 下使用 MonoDevelop 2.1 创建一个新的 web 项目 => 异常

> ID：841192
> 
> 赞同：0
> 
> 时间：2009-05-08T18:32:13.273
> 
> 标签：macos, mono, monodevelop

我全新安装了 MonoDevelop 2.1 和 Mono-Framework 2.7。当我尝试创建一个新项目时，出现以下异常：

```
System.Reflection.TargetInvocationException: Exception has been thrown by the target of   an invocation. ---> System.InvalidOperationException: Add-in    
'MonoDevelop.AssemblyBrowser,2.1.0' could not be loaded. 
at Mono.Addins.ExtensionNode.get_Addin () [0x00081] in /tmp/monobuild/build/BUILD/mono-addins-0.4/Mono.Addins/Mono.Addins/ExtensionNode.cs:102 
at Mono.Addins.TypeExtensionNode.get_Type () [0x00026] in /tmp/monobuild/build/BUILD/mono-addins-0.4/Mono.Addins/Mono.Addins/TypeExtensionNode.cs:62 
```

我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T02:23:12.680

在这个阶段，这两个包可能都“年轻”到足以被创建者很好地理解，他们可能不像他们项目的邮件列表那样仔细监控 StackOverflow。所以我认为最好在[MonoDevelop](http://lists.ximian.com/mailman/listinfo/monodevelop-list)或[Mono](http://lists.ximian.com/mailman/listinfo/mono-devel-list)邮件列表中提出这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T21:00:12.297

我赞同 Piotr 所说的——我是一名 MD 开发人员，而且我很少检查 Stack Overflow。最好的办法是[报告该错误](http://monodevelop.com/Developers#Reporting_Bugs)以确保对其进行跟踪，以便可以在未来的版本中对其进行修复。

此外，在终端中尝试“ `rm -r ~/.config/MonoDevelop/addin*`”，以强制重建插件注册表。

（顺便说一句，我假设您的意思是 Mono 2.4_7，而不是 2.7）

# asp.net - 任何想法为什么我的 GetCompanies() 函数不起作用？

> ID：841193
> 
> 赞同：0
> 
> 时间：2009-05-08T18:32:13.397
> 
> 标签：asp.net

它所做的只是输出'CHECK'，我输入它以确保它实际上是在调用函数......（首先调用Proceed（），然后调用GetCompanies（））。

```
using System;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;
using System.Data.SqlClient;
using Mexico.Data;

public partial class admin_tools_Optimus : System.Web.UI.Page
{
    protected int step = 0;
    protected string[] companies = new string[260];
    protected string[,] courses = new string[260,50];
    protected int total = 0;

    protected void Page_Load(object sender, EventArgs e)
    {

    }

    protected void Proceed(object sender, EventArgs e)
    {
        DataSet getCompanies = SqlHelper.ExecuteDataset(ConfigurationManager.ConnectionStrings["connstr"].ConnectionString, CommandType.StoredProcedure, "Companies_All_Get");

        int counter = 0;

        foreach (DataRow dr in getCompanies.Tables[0].Rows)
        {
            lstData.Items.Add(dr["companyid"].ToString() + ": " + dr["companyname"].ToString());
            companies[counter] = dr["companyid"].ToString();
            counter++;
        }
        lblCurrentData.Text = counter.ToString() + " companies ready, click next to get all company courses.";
        total = counter;
        btnNext.Visible = false;
        btnNext1.Visible = true;
    }

    protected void GetCompanies(object sender, EventArgs e)
    {
        Response.Write("CHECK");
        for (int i = 0; i < total; i++)
        {
            DataSet getBundles = SqlHelper.ExecuteDataset(ConfigurationManager.ConnectionStrings["connstr"].ConnectionString, CommandType.StoredProcedure, "CompanyCourses_ByCompanyID_Get_Sav", new SqlParameter("@companyid", companies[i]));

            int counter = 0;

            foreach (DataRow dr in getBundles.Tables[0].Rows)
            {
                courses[i, counter] = dr["bundleid"].ToString();
                counter++;
            }

            string allID = "";

            allID += courses[i, 0];

            for (int ii = 0; ii < counter; ii++)
            {
                allID += "," + courses[i, ii];
            }
            Response.Write(allID + " <br/>");
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T18:36:57.223

看起来您在不同的回发期间调用了这两种方法。如果是这种情况，那么您的公司数组将是空的，因为您没有保留它（在会话、视图状态等中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T18:41:39.007

您的循环条件在`GetCompanies()`开始时就满足了，并且从不执​​行任何循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T18:38:19.827

该页面在每次回发时重新实例化。您在 Proceed 调用中设置的值仅适用于处理该调用的对象的实例。因此，您再次回发并调用 GetCompanies，它再次获得 total 的初始值——0——并且认为没有任何工作要做。尝试将总数保留在 Session 中，并在调用 GetCompanies 时从那里检索它。确保在使用后让 GetCompanies 将其从会话中删除，以便在未重置的情况下不会重复使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T18:39:04.847

我可能在这里遗漏了一些东西，但是您在设置“total”变量之前调用了 GetCompanies。因此 GetCompanies 中的 for 循环不会循环任何内容，因为“total”仍设置为 0。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T18:46:24.783

在你的编码方式中，你应该改进一些事情，但第一，不需要有 Response.Write 子句，带有断点的调试会告诉你到底是什么问题。

首先，停止保护你的**全局变量**，如果你不想将它们暴露在你的班级之外，请将它们设为私有。

> **protected**关键字是成员访问修饰符。受保护的成员可以从声明它的类中访问，也可以从从声明该成员的类派生的任何类中访问。

你需要继承这个类吗？我不这么认为。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-08T18:36:41.127

使用调试器。`total`在那个循环之前设置了什么？

# django - Django -- ForeignKey() 使用与行 ID 不同的列？

> ID：841195
> 
> 赞同：1
> 
> 时间：2009-05-08T18:32:31.417
> 
> 标签：django, django-models, location, django-urls

我有一个名为 Location 的应用程序。位置有国家、州、城市、Big_City_Nearby、经度、纬度。

我有一个待售物品的申请。项目有标题、链接、描述、价格和位置，这是一个 ForeignKey()。

现在，如果有人想查看在美国出售的所有商品，他们点击一个链接（比如说[http://example.com/United-States/](http://example.com/United-States/)），URL 将作为国家传递给“美国” state、city 和 big_city_nearby 为空。

```
#in view.py
class by_location(request, country, state, city, big_city_nearby)
   location = Location.objects.filter(country=country, state=state, city=city, big_city_nearby=big_city_nearby)
   items = Items.objects.filter(location__in=[location.id for loc in location])
   return render_to_response('item/by_location.html', {"items":itmes, "country":countyr, "cit":city, "nearby":big_city_nearby}) 
```

[如果他们通过（ http://example.com/United_State/California/Oakland](http://example.com/United_State/California/Oakland) ）没有问题，因为我可以继续列出奥克兰的所有项目，而无需显示每个找到的项目的位置。

问题是何时选择[http://example.com/united_states/](http://example.com/United_States/)或[http://example.com/united_states/california/](http://example.com/United_States/California/)。因为我现在必须显示每个项目的位置，因为这些项目可以来自不同的城市。

所以当模板获取项目列表时，它只获取每个项目中的 ForeignKey(Location)。我可以放置另一个循环，在其中检查每个项目并获取 Location 对象并将其与项目对象放在一个元组中。但这将是非常低效的 SQL。因为我必须为找到的每个项目访问数据库才能获取实际的位置对象。

有没有一种方法可以让我说 ForeignKey 将城市而不是 Id 保存到数据库中的位置行。

让问题简单化：有没有更好的方法将位置作为应用程序保留，而无需提供国家、州、城市等。在每个项目行中。

谢谢，

VN44CA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T19:04:49.967

`Item.objects.filter(...).select_related("location")`. 这将针对位置表加入，因此它只是一个查询。

更好的是，`Item.objects.filter(location__country=country, location__state=state).select_related("location")`您可以完全省略`Location`查询。

老实说，我很难确定这是否就是您所需要的，但这可以处理 O(N) 查询问题。

# naming-conventions - 你会给这个 CRUD 类起什么名字？

> ID：841200
> 
> 赞同：9
> 
> 时间：2009-05-08T18:33:38.607
> 
> 标签：naming-conventions, crud

试图避免这里的[SomethingManager](http://www.codinghorror.com/blog/archives/000553.html)陷阱......

假设我要编写一个用户编辑器，它允许管理员在系统中创建用户。非常基本的功能——查看现有用户列表、创建新用户、更新现有用户、删除用户。

假设我决定编写一个“业务”类来处理这些基本的 CRUD 操作。界面大概是这样的：

```
public interface ISomeUsefulName
{
    IList<User> FetchUsers();
    User FetchUser(int userId);
    bool SaveUser(User user);
    bool DeleteUser(int userId);
} 
```

例如，在 SaveUser() 方法中，我将验证数据（使用不同的类），然后将数据实际保存到数据库中（再次使用另一个类）。

我的问题是，我应该给这个类起什么名字？这门课做得太多了，因此我应该把它分成多个类吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-08T19:41:14.370

如果不尊重 SRP，命名很困难 :) 但是成员命名经常被滥用。

在你的情况下，我会做这样的事情：

*   实施的责任是覆盖指定的持久性合同
*   “谁”受到抨击

无声音思考 - 持久性是为用户完成的，相关名称可以是 IUserRepository - 方法不超过 CRUD - 因为 IUserRepository 是针对用户的，所以不需要 UserSave、UserUpdate，因为它会破坏通用用法方式

魔术就在这里......只需这样做：

```
public interface IRepository<TYPE, KEY>{
  IList<TYPE> GetAll(KEY key);
  TYPE GetById(KEY key);
  void Save(TYPE obj);
  void Update(TYPE obj);
  void Delete(Key key);
} 
```

它困难吗 ？定制的怎么办？

```
public interface IUserRepository : IRepository<User, int>
{
   IList<User> GetAllMyFavorites(ICriteria crit);
   IList<Events> GetHistoryByUser(User user);   
} 
```

在使用 IoC 容器的代码中，您可以轻松完成

```
public UserController {
  private _userRepository = null;
  private _eventsRepository = null;

  public UserController(IUserRepository userRepository, 
  IRepository<Events,int> eventsRepository) 
  // if you are doing here just CRUD use the generic signature
  {
    _userRepository = userRepository;
    _eventsRepository = eventsRepository;
  }

  public MarkItAsGoldPartener(int userId){
     var user = userRepository.GetById(userId);
     user.PartnerType = PartnerTypes.Gold;
     userRepository.Save(user); // the user in member name is useless
     eventsRepository.Save(new Event(){Message = "The user" + UserId + "is golden" });
  }
} 
```

祝你好运 ：）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-08T18:42:45.073

我赞同 ChrisW 的呼吁，将其命名为“用户”。

每当您发现自己在几乎每个方法的名称中都放置了相同的字符串时，都应该将其从方法名称中删除并放入类名称中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T18:42:08.973

IUserRepository——就像在[Repository](http://www.martinfowler.com/eaaCatalog/repository.html)模式中一样。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-08T18:46:45.297

IUserRepository 或 IUserServices。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-08T19:01:11.847

您在命名它时遇到困难的事实应该是一个巨大的危险信号，它是错误的。

单一职责原则（和接口隔离原则）适用于此。将其分解为您需要的各种操作。

```
public interface IUserList
{
    IList<User> FetchUsers();
}

public interface IUser
{
   User FetchUser(int userId);
}

public interface IUserStore
{
    bool SaveUser(User user);
    bool DeleteUser(int userId);
} 
```

然后命名它们变得更加简单，因为现在只有一个名称真正适用。相信我，如果你是一名设计师，你的开发者会喜欢你，因为你让事情变得易于理解和使用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-08T18:36:54.807

我的偏好是 IUserStorage 或 IUserStore

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-08T19:08:26.510

它可以成为一个通用接口。

```
ICrud<T> { } 
```

或受 IUserStore 启发。

```
IStore<T> { } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-08T18:38:34.507

称它为“用户”（或“AuthorizedUsers”或“CollectionOfUsers”）怎么样？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-08T18:38:08.703

为什么不只是 IUserCRUD？与“管理”相反，CRUD 有 10 种含义。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-08T21:24:27.073

我会去的`UserActions`。这描述了您想要执行的一组功能；它避免了将其称为集合的陷阱（因为它实际上并没有收集任何东西，只是检索一个集合）。

但我也会重新考虑首先以这种形式开设这门课。看起来您要安装的是持久性管理器；是否还有其他类型的对象要以这种方式持久存在？你能提取任何可以派生到基类的通用功能吗？也许是一个“ `PersistenceManager`”类或类似的东西？然后，如果它是绝对必要的（我不确定它是否会），您可以派生一个“ `UserPersistenceManager`”，它可以单独对 User 对象进行操作。（我认为这可能没有必要，因为您可以仅从 执行所需的一切`PersistenceManager`；不过，只有您的特定实现才能告诉您。）

# iphone - 可可触摸的日历控件

> ID：841206
> 
> 赞同：2
> 
> 时间：2009-05-08T18:36:05.493
> 
> 标签：iphone, cocoa-touch, controls, calendar

我想为我创建一个 CRM 应用程序只是为了好玩并了解更多关于 Cocoa 的信息，因为 CRM 应用程序是基于日历发展的，我想知道我在哪里可以得到 iCal 在 iPhone 中拥有的那个很酷的日历控件。

我在我的库中看不到它，我正在使用 SDK 3.0 beta 5。

顺便说一句，我在哪里可以得到一个免费/付费的控件集合，就像 .NET 世界有这么多的控​​件集合？

![替代文字](https://i.stack.imgur.com/pINrH.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-11-12T01:33:14.043

迟到了，但这个问题在这里得到了回答：

[iPhone 应用程序有现成的日历控件吗？](https://stackoverflow.com/questions/997779/is-there-any-ready-made-calendar-control-for-iphone-apps)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T19:54:26.913

Apple does not make the iPhone-style calendar UI part of the public API. You'll need to build your own calendar or contract it out.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T20:16:08.093

[This thread](http://discussions.apple.com/thread.jspa?threadID=1433889) on the Apple Support forums confirms what [Alex Reynolds](https://stackoverflow.com/questions/841206/calendar-control-for-cocoa-touch/841516#841516) says:

> No, does not exist (except in Apple's private library). I had to build one from scratch (actually I "outsourced" building the custom class to a Colorado iPhone development outfit via eLance) in order to develop my calendar-based app

The only thing I could find was [this](http://nrg.com.bd/blog/archives/36), which is a iPhone calendar control. It doesn't look identical to Apple's one, but it's close (and would probably be a good starting point if you need it to look similar)

# apache - 为什么我的 javascript & css 没有缓存？

> ID：841209
> 
> 赞同：11
> 
> 时间：2009-05-08T18:36:47.473
> 
> 标签：apache, http, .htaccess, caching, etag

似乎只有 javascript 和 css 没有缓存……但图像正在缓存。

我正在使用 Firebug，当我刷新页面时，我注意到 Firebug 中有很多**200 个 js/css 的 HTTP 响应**，但我的所有图像都收到了**304 个 HTTP 代码**（内容未修改）。所以看来我的 JS 和 CSS 没有缓存。

此外，当使用 YSlow 来帮助确定我的 JS/CSS 内容没有缓存的问题时，它会告诉我：

> 有 4 个组件的 ETag 配置错误
> 
> *   [http://www.example.com/css/basic.css](http://www.example.com/css/basic.css)
> *   [http://www.example.com/js/ga.js](http://www.example.com/js/ga.js)
> *   [http://www.example.com/js/dojo/dojo.js](http://www.example.com/js/dojo/dojo.js)

下面列出的是我的 .htaccess 文件

```
Options -Indexes
Options +FollowSymLinks  

# Enable ETag
FileETag MTime Size

# Set expiration header
ExpiresActive on
ExpiresDefault "access plus 1 week"

# Compress some text file types
AddOutputFilterByType DEFLATE text/html text/plain text/css text/xml application/x-javascript text/javascript application/javascript application/json

# Deactivate compression for buggy browsers
BrowserMatch ^Mozilla/4 gzip-only-text/html
BrowserMatch ^Mozilla/4\.0[678] no-gzip
BrowserMatch \bMSIE !no-gzip !gzip-only-text/html

# Set header information for proxies
Header append Vary User-Agent 
```

**知道我的 .htaccess 访问文件有什么问题，阻止它缓存我的 CSS 或 JavaScript？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-12-13T22:39:08.097

请考虑**禁用**ETag！

考虑以下设置：

```
Header unset ETag
FileETag None
Header set Cache-Control "max-age=2678400" 
```

前两条规则完全禁用 ETag，因此浏览器在某种程度上被迫监听 Cache-Control 标头。最后一条规则告诉浏览器缓存文件 2678400 秒，即 1 个月。将设置调整为最适合您的设置。并将此配置应用于包含静态文件的目录（例如，通过在该目录中放置一个 .htaccess 文件）

可选，如果您使用多个服务器来提供静态内容，和/或不确定这些服务器报告的最后修改时间，请考虑使用：

```
Header unset Last-Modified 
```

它告诉 Apache 不提供任何 Last-Modified 标头，因此浏览器只能侦听 Cache-Control max-age 标头。

*我自己在许多高流量网站上使用此设置，禁用 ETag 和 Last-Modified 标头确实有助于将流量降低到以前的五分之一。尤其是 Internet Explorer 对这些设置非常敏感。*

**警告：**禁用 Last-Modified 将阻止浏览器询问 304 Content Not Modified 请求。以我的经验，这是积极的，因为网络服务器处理的请求较少，而浏览器更多地依赖于您提供的缓存控制设置。但它可能适合您，也可能不适合您。如果您为它们提供“Last-Modified”标头，某些浏览器会每隔几分钟尝试验证资产，这就是为什么我建议完全禁用它的原因。

哦，如果你不确定你的缓存；使用[http://www.redbot.org/](http://www.redbot.org/)来测试您的资产，它会快速告诉您标题对浏览器意味着什么，以及如何解释您使用的不同缓存控制设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-09T13:57:08.360

如果 etags 不遵守特定模式，YSlow 会报告错误配置的 etags。由于您正在压缩 css 和 js，因此输出的 etags 如下所示：

```
Etag "1e10-4889909861a80"-gzip 
```

看到最后的 -gzip 了吗？它是由 apache 放在那里的（仅限第 2 版）。这就是导致“错误”的原因。YSlow 期望看到如下内容：

```
Etag "xxxx-xxxxxxxxxxxxx" 
```

基本上，您无法解决此问题，因为它没有损坏。因此，如果您不知道自己在做什么，请不要疯狂地试图获得完美的分数。甚至那个雅虎主页也只有 90 分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-15T19:42:41.857

## 此 YSlow 错误消息极具误导性！

### YSlow*实际上*是在抱怨您根本在使用 ETags *！*

YSlow 在您的浏览器中运行——它无法知道 ETag 是否配置正确。根据经验，您不应该使用 ETag，因为在多服务器环境中，您更有可能将它们配置错误，而不是正确配置。（而 YSlow 的目标用户是拥有大型多服务器网站的用户。）

当然，如果您使用的是单服务器设置，或者如果您使用的是分布式服务器设置但知道自己在做什么，那么 ETags 就可以了。但 YSlow 无法知道这一点。

您应该查看的错误描述页面的评论中有很多关于此的讨论：http: [//developer.yahoo.net/blog/archives/2007/07/high_performanc_11.html](http://developer.yahoo.net/blog/archives/2007/07/high_performanc_11.html)

我还在 ServerFault 上找到了这个答案，重申了这一点：[https ://serverfault.com/questions/55919/yslow-says-etags-are-misconfigured-how-to-configure-etags-properly-on-iis7](https://serverfault.com/questions/55919/yslow-says-etags-are-misconfigured-how-to-configure-etags-properly-on-iis7)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-30T04:08:44.317

我遇到和你一样的问题。删除 etag 将起作用。

在配置文件中添加以下内容： FileETag none

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T19:43:32.773

是的，这是正确且众所周知的行为（可能并不真正需要）。

阅读[http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)关于 ETag。

可能您只想在服务器上禁用 ETag。

编辑：另外，使用 LiveHTTPHeaders 插件来了解您的浏览器的功能。它比 FireBug 更适合这项任务。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-11T04:03:21.880

嗨，我有同样的麻烦。但是只是放入 FileETag none 没有用

我修复它的方式（我不知道这是否正确 - 但它有效）是我把

FileET 无标签

在我的 htaccess 文件的底部。

然后ySlow很高兴。

# compare - 识别代码改进

> ID：841222
> 
> 赞同：0
> 
> 时间：2009-05-08T18:39:58.760
> 
> 标签：compare, roi

我们刚刚完成了一次相当大的系统重写，我被要求查找和识别代码中已改进的区域。作为向客户证明我们付出的努力是值得的一种方式。识别这些区域并不是真正困难的部分，但我正在努力如何最好地呈现这些信息。对此有任何建议，或者如果有人在过去做过类似的事情，我们将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T18:49:52.827

**实际上，这是减少您的[技术债务](http://martinfowler.com/bliki/TechnicalDebt.html)。**您通常会从这种努力中获得的所有好处也适用于此。一些影响将是前瞻性的。例如：

*   由于更好、更清晰的 API 降低了缺陷率。
*   更快的开发时间（和更低的成本），因为接口更容易测试并且集成点更少。
*   更容易维护旧代码，因为它们所依赖的层现在将更干净，更自由。

但是，其中一些将立即生效：

*   构建速度更快，因为杂物更少。
*   识别在生产之前不会发现的错误，因为对这些区域进行单元测试太难了。
*   更好地分离层和关注点。

当然，这些好处的适用程度取决于您的项目及其代码库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T18:49:38.863

这取决于客户：客户是否具有技术意识？它们是内部的还是外部的？他们想要多少细节？您是否被要求重写，如果是，由谁重写，出于什么原因？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T18:52:09.573

由于它适用于非技术人员，我建议使用条形图和饼图。没有什么比彩色大图表更能帮助非技术人员掌握复杂的主题了。

# .net - Case insensitive string compare in LINQ-to-SQL

> ID：841226
> 
> 赞同：142
> 
> 时间：2009-05-08T18:41:00.413
> 
> 标签：.net, vb.net, linq

I've read that it's unwise to use ToUpper and ToLower to perform case-insensitive string comparisons, but I see no alternative when it comes to LINQ-to-SQL. The ignoreCase and CompareOptions arguments of String.Compare are ignored by LINQ-to-SQL (if you're using a case-sensitive database, you get a case-sensitive comparison even if you ask for a case-insensitive comparison). Is ToLower or ToUpper the best option here? Is one better than the other? I thought I read somewhere that ToUpper was better, but I don't know if that applies here. (I'm doing a lot of code reviews and everyone is using ToLower.)

```
Dim s = From row In context.Table Where String.Compare(row.Name, "test", StringComparison.InvariantCultureIgnoreCase) = 0 
```

This translates to an SQL query that simply compares row.Name with "test" and will not return "Test" and "TEST" on a case-sensitive database.

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-05-08T19:09:47.427

As you say, there are some important differences between ToUpper and ToLower, and only one is dependably accurate when you're trying to do case insensitive equality checks.

Ideally, the best way to do a case-insensitive equality check **would be**:

```
String.Equals(row.Name, "test", StringComparison.OrdinalIgnoreCase) 
```

**NOTE, HOWEVER** that this does *not work* in this case! Therefore we are stuck with `ToUpper` or `ToLower`.

Note the **Ordinal**IgnoreCase to make it security-safe. But exactly the type of case (in)sensitive check you use depends on what your purposes is. But in general use Equals for equality checks and Compare when you're sorting, and then pick the right StringComparison for the job.

Michael Kaplan (a recognized authority on culture and character handling such as this) has relevant posts on ToUpper vs. ToLower:

*   [http://www.siao2.com/2007/10/01/5218976.aspx](http://www.siao2.com/2007/10/01/5218976.aspx)
*   [http://www.siao2.com/2005/03/10/391564.aspx](http://www.siao2.com/2005/03/10/391564.aspx)

He says "String.ToUpper – **Use ToUpper rather than ToLower, and specify InvariantCulture in order to pick up OS casing rules**"

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2009-06-26T10:24:08.843

I used `System.Data.Linq.SqlClient.SqlMethods.Like(row.Name, "test")` in my query.

This performs a case-insensitive comparison.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-04-20T21:44:18.730

With .NET core, System.Data.Linq.SqlClient.SqlMethods is not available, use this instead

```
EF.Functions.Like(row.Name, "test") 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-09-23T08:48:31.083

According to the [EF Core documentation](https://docs.microsoft.com/en-us/ef/core/miscellaneous/collations-and-case-sensitivity#translation-of-built-in-net-string-operations), the decision not to provide an out of the box translation of case insensibility comparison is by design, mostly due to performance concerns since the DB index wouldn't be used:

> .NET provides overloads of `string.Equals` accepting a `StringComparison` enum, which allows specifying case-sensitivity and culture for the comparison. By design, EF Core refrains from translating these overloads to SQL, and attempting to use them will result in an exception. For one thing, EF Core does know not which case-sensitive or case-insensitive collation should be used. More importantly, **applying a collation would in most cases prevent index usage, significantly impacting performance for a very basic and commonly-used .NET construct**.

That being said, starting with EF Core 5.0, it's possible to specify a collation per query, which can be used to perform a case insensitive comparison:

```
Dim s = From row In context.Table 
        Where EF.Functions.Collate(row.Name, "SQL_Latin1_General_CP1_CI_AS") == "test" 
```

and in C#

```
var s = context.Table
   .Where(row => EF.Functions.Collate(row.Name, "SQL_Latin1_General_CP1_CI_AS") == "test") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T18:44:32.293

If you pass a string that is case-insensitive into LINQ-to-SQL it will get passed into the SQL unchanged and the comparison will happen in the database. If you want to do case-insensitive string comparisons in the database all you need to to do is create a lambda expression that does the comparison and the LINQ-to-SQL provider will translate that expression into a SQL query with your string intact.

For example this LINQ query:

```
from user in Users
where user.Email == "foo@bar.com"
select user 
```

gets translated to the following SQL by the LINQ-to-SQL provider:

```
SELECT [t0].[Email]
FROM [User] AS [t0]
WHERE [t0].[Email] = @p0
-- note that "@p0" is defined as nvarchar(11)
-- and is passed my value of "foo@bar.com" 
```

As you can see, the string parameter will be compared in SQL which means things ought to work just the way you would expect them to.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-16T15:54:34.520

To perform case sensitive Linq to Sql queries declare ‘string’ fields to be case sensitive by specifying the server data type by using one of the following;

```
varchar(4000) COLLATE SQL_Latin1_General_CP1_CS_AS 
```

or

```
nvarchar(Max) COLLATE SQL_Latin1_General_CP1_CS_AS 
```

Note: The ‘CS’ in the above collation types means ‘Case Sensitive’.

This can be entered in the “Server Data Type” field when viewing a property using Visual Studio DBML Designer.

For more details see [http://yourdotnetdesignteam.blogspot.com/2010/06/case-sensitive-linq-to-sql-queries.html](http://yourdotnetdesignteam.blogspot.com/2010/06/case-sensitive-linq-to-sql-queries.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-11-01T18:44:55.000

I tried this using Lambda expression, and it worked.

`List<MyList>.Any (x => (String.Equals(x.Name, name, StringComparison.OrdinalIgnoreCase)) && (x.Type == qbType) );`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-24T13:46:18.310

The following 2-stage approach works for me (VS2010, ASP.NET MVC3, SQL Server 2008, Linq to SQL):

```
result = entRepos.FindAllEntities()
    .Where(e => e.EntitySearchText.Contains(item));

if (caseSensitive)
{
    result = result
        .Where(e => e.EntitySearchText.IndexOf(item, System.StringComparison.CurrentCulture) >= 0);
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-12-06T16:56:39.653

```
where row.name.StartsWith(q, true, System.Globalization.CultureInfo.CurrentCulture) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-05-23T10:15:38.923

Sometimes value stored in Database could contain spaces so running this could be fail

```
String.Equals(row.Name, "test", StringComparison.OrdinalIgnoreCase) 
```

Solution to this problems is to remove space then convert its case then select like this

```
 return db.UsersTBs.Where(x => x.title.ToString().ToLower().Replace(" ",string.Empty).Equals(customname.ToLower())).FirstOrDefault(); 
```

**Note in this case**

**customname** is value to match with Database value

**UsersTBs** is class

**title** is the Database column

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2013-06-06T11:43:03.987

Remember that there is a difference between whether the query works and whether it works *efficiently*! A LINQ statement gets converted to T-SQL when the target of the statement is SQL Server, so you need to think about the T-SQL that would be produced.

Using String.Equals will most likely (I am guessing) bring back all of the rows from SQL Server and then do the comparison in .NET, because it is a .NET expression that cannot be translated into T-SQL.

In other words using an expression will increase your data access and remove your ability to make use of indexes. It will work on small tables and you won't notice the difference. On a large table it could perform very badly.

That's one of the problems that exists with LINQ; people no longer think about how the statements they write will be fulfilled.

In this case there isn't a way to do what you want without using an expression - not even in T-SQL. Therefore you may not be able to do this more efficiently. Even the T-SQL answer given above (using variables with collation) will most likely result in indexes being ignored, but if it is a big table then it is worth running the statement and looking at the execution plan to see if an index was used.

# php - 寻找一组工具/对象以在 PHP 中启动网站

> ID：841228
> 
> 赞同：-1
> 
> 时间：2009-05-08T18:41:12.783
> 
> 标签：php

寻找一组好的基础对象来用 PHP 启动一个网站。我不是在寻找 CakePHP 的链接，因为我对框架不感兴趣。我正在寻找一组可以方便地开始新项目的对象。

对象如：

*   记录器
*   MySQL 包装对象
*   ETC

基本上是“从这个开始”，我记得在 Digg 上看到了一个很好的对象和代码集合，但我再也找不到它了。有用户对象（用于登录）、内置的 fsck 编辑器等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T18:47:28.353

> MySQL 包装对象

使用[PDO](http://www.php.net/pdo)。

> 我对框架不感兴趣

嗯，你是。您可能不是在寻找一个紧密耦合的全栈框架。

您可能会发现以下一项或多项有用：

*   [梨](http://pear.php.net/)
*   [Zend 框架](http://framework.zend.com/)
*   [ezComponents](http://ez.no/ezcomponents)

它们都是非常松散耦合的框架，您可以根据需要进行选择和匹配。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T18:48:10.817

好吧，这里有一堆与 digg 相关的代码。

[http://github.com/digg/](http://github.com/digg/)

我也不明白为什么你不想使用框架，而是想使用构成框架的所有组件。这对我来说没有多大意义。

我会研究 Zend 框架。在你尖叫我推荐它之前，很多组件都是模块化的，这意味着你可以获取你需要的部分。

[http://framework.zend.com/manual/en/](http://framework.zend.com/manual/en/)

**PS**：虽然 Zend Framework 标题中有“框架”，但很多人将其视为类的集合。所以检查一下:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T18:48:25.357

就其定义而言，框架是一组在开始新项目时派上用场的对象。

PDO 可以为您提供数据库抽象，而无需借助第三方库。模板可以使用替代语法 ( `foreach():`) 和短标签 ( `<?= $var ?>`) 来完成。如果你愿意，你可以自己做这一切，只需保持文档并开始重新定义那个轮子。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T18:53:44.283

为此，我当然可以推荐 Zend Framework。作为粘合框架，您可以使用任意数量的组件，无论是否使用 MVC。

# java - 在非单例 bean 上的 Spring 代理上修复 BeanNotOfRequiredTypeException？

> ID：841231
> 
> 赞同：30
> 
> 时间：2009-05-08T18:41:57.167
> 
> 标签：java, spring, casting, aop, proxy-classes

我在从应用程序上下文中提取 Spring bean 时遇到问题。

当我尝试时；

```
InnerThread instance = (InnerThread) SpringContextFactory.getApplicationContext().getBean("innerThread", InnerThread.class); 
```

我明白了；

```
org.springframework.beans.factory.BeanNotOfRequiredTypeException: Bean named 'innerThread' must be of type [com.generic.InnerThread], but was actually of type [$Proxy26] 
```

如果在 getBean() 调用中没有指定类，我会得到一个 ClassCastException（您可以在下面详细看到）。

InnerThread bean 被初始化为非单例，因为我需要多个实例。InnerThread 类还扩展了 Thread。有趣的是，这个错误出现在 OuterThread 中，它的设置方式与 InnerThread 完全相同。

我试图在下面包含所有相关的代码清单/堆栈跟踪。有更多春季经验的人可以告诉我这里发生了什么吗？

* * *

## 代码/配置列表

*OuterThread.java 片段：*

```
public class OuterThread extends Thread {
    private Queue<InnerThread> createInnerThreads() {
        Queue<InnerThread> threads = new ArrayBlockingQueue();

        ApplicationContext ctx = SpringContextFactory.getApplicationContext();
        int i = 0;
        for (SearchRule search : searches) {
            logger.debug("Number of times looped " + i++);
            //Seprated lines to get a better sense of what is going on
            Object proxy = ctx.getBean("innerThread", InnerThread.class);
            logger.debug(ReflectionToStringBuilder.toString(proxy));
            logger.debug("proxy.getClass(): " + proxy.getClass());
            logger.debug("proxy.getClass().getClassLoader(): " + proxy.getClass().getClassLoader());
            logger.debug("proxy.getClass().getDeclaringClass(): " + proxy.getClass().getDeclaringClass());
            logger.debug("InnerThread.class.getClassLoader(): " + InnerThread.class.getClassLoader());

            //---Exception here---
            InnerThread cst = (InnerThread) proxy;

            threads.add(cst);
        }
        return threads;
    }

    public static void main(String[] args) throws Exception {
        try {
            OuterThread instance = (OuterThread) SpringContextFactory.getApplicationContext().getBean("outerThread", OuterThread.class);
            instance.run();
        } catch (Exception ex) {
            logger.error("Fatal exception.", ex);
            throw ex;
        }
    }
} 
```

*SpringContextFactory.java：*

```
public class SpringContextFactory {
    static final Logger logger = LoggerFactory.getLogger(SpringContextFactory.class);
    private static ApplicationContext ctx;
    private static final String DEFAULT_PATH = "META-INF/app-context.xml";

    public static ApplicationContext getApplicationContext() {
        return getApplicationContext(DEFAULT_PATH);
    }

    public static synchronized ApplicationContext getApplicationContext(String path) {
        if (ctx == null) return createApplicationContext(path);
        else return ctx;
    }

    private static ApplicationContext createApplicationContext(String path) {
        if (logger.isDebugEnabled()) logger.debug("Loading Spring Context...");
        ctx = new ClassPathXmlApplicationContext(path);
        if (logger.isDebugEnabled()) logger.debug("Spring Context Loaded");
        return ctx;
    }
} 
```

*应用上下文.xml：*

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd">

    <!-- persistence context from separate jar -->
    <import resource="persistence-context.xml"/>

    <bean id="outerThread" class="com.generic.OuterThread" scope="prototype"/>
    <bean id="innerThread" class="com.generic.InnerThread" scope="prototype"/>

</beans> 
```

## 堆栈跟踪

```
2009-05-08 14:34:37,341 [main] DEBUG com.generic.OuterThread.init(OuterThread.java:59) - Initializing OuterThread object, com.generic.OuterThread@1c8fb4b[em=org.hibernate.ejb.EntityManagerImpl@e2892b,currentTime=java.util.GregorianCalendar[time=1241634874841,areFieldsSet=true,areAllFieldsSet=true,lenient=true,zone=sun.util.calendar.ZoneInfo[id="America/New_York",offset=-18000000,dstSavings=3600000,useDaylight=true,transitions=235,lastRule=java.util.SimpleTimeZone[id=America/New_York,offset=-18000000,dstSavings=3600000,useDaylight=true,startYear=0,startMode=3,startMonth=2,startDay=8,startDayOfWeek=1,startTime=7200000,startTimeMode=0,endMode=3,endMonth=10,endDay=1,endDayOfWeek=1,endTime=7200000,endTimeMode=0]],firstDayOfWeek=1,minimalDaysInFirstWeek=1,ERA=1,YEAR=2009,MONTH=4,WEEK_OF_YEAR=19,WEEK_OF_MONTH=2,DAY_OF_MONTH=6,DAY_OF_YEAR=126,DAY_OF_WEEK=4,DAY_OF_WEEK_IN_MONTH=1,AM_PM=1,HOUR=2,HOUR_OF_DAY=14,MINUTE=34,SECOND=34,MILLISECOND=841,ZONE_OFFSET=-18000000,DST_OFFSET=3600000],maxConcurrentThreads=5,reconId=3,reportUsername=TEST,useOffset=false,username=removed,uuid=bf61494d-ff96-431c-a41f-1e292d0c9fbe,name={T,h,r,e,a,d,-,1},priority=5,threadQ=<null>,eetop=0,single_step=false,daemon=false,stillborn=false,target=<null>,group=java.lang.ThreadGroup[name=main,maxpri=10],contextClassLoader=sun.misc.Launcher$AppClassLoader@11b86e7,inheritedAccessControlContext=java.security.AccessControlContext@1524d43,threadLocals=<null>,inheritableThreadLocals=java.lang.ThreadLocal$ThreadLocalMap@2cbc86,stackSize=0,nativeParkEventPointer=0,tid=9,threadStatus=0,parkBlocker=<null>,blocker=<null>,blockerLock=java.lang.Object@a68fd8,stopBeforeStart=false,throwableFromStop=<null>,uncaughtExceptionHandler=<null>]
2009-05-08 14:34:37,341 [main] DEBUG org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.doJoinTransaction(ExtendedEntityManagerCreator.java:385) - No local transaction to join
2009-05-08 14:34:37,529 [main] DEBUG com.generic.OuterThread.createInnerThreads(OuterThread.java:139) - Number of times looped 0
2009-05-08 14:34:37,529 [main] DEBUG org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory$1.run(AbstractAutowireCapableBeanFactory.java:458) - Creating instance of bean 'searchThread' with merged definition [Root bean: class [com.generic.InnerThread]; scope=prototype; abstract=false; lazyInit=false; autowireCandidate=true; autowireMode=0; dependencyCheck=0; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null; defined in class path resource [META-INF/app-context.xml]]
2009-05-08 14:34:37,545 [main] DEBUG com.generic.InnerThread.<init>(InnerThread.java:50) - Constructing InnerThread object, com.generic.InnerThread@1080876[em=<null>,coolScheme=<null>,coolUrl=<null>,date=<null>,error=<null>,millisecondsTaken=0,thresholdMet=false,reconId=0,result=-2,searchId=0,username=<null>,uuid=<null>,name={T,h,r,e,a,d,-,2},priority=5,threadQ=<null>,eetop=0,single_step=false,daemon=false,stillborn=false,target=<null>,group=java.lang.ThreadGroup[name=main,maxpri=10],contextClassLoader=sun.misc.Launcher$AppClassLoader@11b86e7,inheritedAccessControlContext=java.security.AccessControlContext@1524d43,threadLocals=<null>,inheritableThreadLocals=java.lang.ThreadLocal$ThreadLocalMap@3aef16,stackSize=0,nativeParkEventPointer=0,tid=10,threadStatus=0,parkBlocker=<null>,blocker=<null>,blockerLock=java.lang.Object@126c6ea,stopBeforeStart=false,throwableFromStop=<null>,uncaughtExceptionHandler=<null>]
2009-05-08 14:34:37,545 [main] DEBUG org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:203) - Returning cached instance of singleton bean 'entityManagerFactory'
2009-05-08 14:34:37,545 [main] DEBUG org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:203) - Returning cached instance of singleton bean 'org.springframework.transaction.config.internalTransactionAdvisor'
2009-05-08 14:34:37,560 [main] DEBUG org.springframework.transaction.interceptor.AbstractFallbackTransactionAttributeSource.getTransactionAttribute(AbstractFallbackTransactionAttributeSource.java:108) - Adding transactional method [report] with attribute [PROPAGATION_REQUIRED,ISOLATION_DEFAULT]
2009-05-08 14:34:37,560 [main] DEBUG org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.buildAdvisors(AbstractAutoProxyCreator.java:494) - Creating implicit proxy for bean 'searchThread' with 0 common interceptors and 1 specific interceptors
2009-05-08 14:34:37,560 [main] DEBUG org.springframework.aop.framework.JdkDynamicAopProxy.getProxy(JdkDynamicAopProxy.java:113) - Creating JDK dynamic proxy: target source is SingletonTargetSource for target object [com.generic.InnerThread@1080876]
2009-05-08 14:34:37,591 [main] DEBUG com.generic.OuterThread.createInnerThreads(OuterThread.java:141) - $Proxy26@1594a88[h=org.springframework.aop.framework.JdkDynamicAopProxy@1f0cf51]
2009-05-08 14:34:37,591 [main] DEBUG com.generic.OuterThread.createInnerThreads(OuterThread.java:142) - proxy.getClass(): class $Proxy26
2009-05-08 14:34:37,591 [main] DEBUG com.generic.OuterThread.createInnerThreads(OuterThread.java:143) - proxy.getClass().getClassLoader(): sun.misc.Launcher$AppClassLoader@11b86e7
2009-05-08 14:34:37,591 [main] DEBUG com.generic.OuterThread.createInnerThreads(OuterThread.java:144) - proxy.getClass().getDeclaringClass(): null
2009-05-08 14:34:37,591 [main] DEBUG com.generic.OuterThread.createInnerThreads(OuterThread.java:145) - InnerThread.class.getClassLoader(): sun.misc.Launcher$AppClassLoader@11b86e7
2009-05-08 14:34:37,591 [main] ERROR com.generic.OuterThread.run(OuterThread.java:101) - Exception in OuterThread, ending reconciliation.
java.lang.ClassCastException: $Proxy26 cannot be cast to com.generic.InnerThread
    at com.generic.OuterThread.createInnerThreads(OuterThread.java:148)
    at com.generic.OuterThread.run(OuterThread.java:65)
    at com.generic.OuterThread.main(OuterThread.java:170) 
```

* * *

## 没有回答我的问题的类似问题

*   [自动转换 Spring Bean](https://stackoverflow.com/questions/812178/auto-cast-spring-beans)
*   [转换为同一类时发生 ClassCastException。](https://stackoverflow.com/questions/826319/classcastexception-when-casting-to-the-same-class)

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-09-09T14:49:07.340

用注释你的`@Configuration`类

```
@EnableAspectJAutoProxy(proxyTargetClass = true) 
```

您还必须添加以下依赖项：

```
<dependency>
<groupId>org.aspectj</groupId>
<artifactId>aspectjweaver</artifactId>
<version>1.7.2</version>
</dependency> 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-05-08T20:00:46.167

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-03-06T11:02:53.517

解决此问题的一种方法是扩展可运行接口并创建自己的：

```
public interface MyInterface extends Runnable {
  // your own method declarations here
  void doSomething();
  ...
} 
```

然后你应该实现你的接口而不是runnable：

```
@Component("myInterface")
@Scope("prototype")
     public class MyInterfaceImpl implements MyInterface {

          // your own method declarations here
          public void doSomething(){
          ...
          }

          // implement run from Runnable Interface
          @Transactional
          public void run(){
                .....
          }

             ...
        } 
```

这将正常工作：

```
...
    MyInterface mynterface = SpringApplicationContext.getBean("myInterface", MyInterface.class);

    myInterface.doSomething();
  ExecutorService executor = Executors.newSingleThreadExecutor();
    executor.submit(myInterface);
... 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T18:53:10.413

这只是一个猜测，但尝试制作一个接口 InnerThreadInterface，然后让 InnerThread 类扩展它。

之后，您应该能够：

InnerThreadInterface 内部 = ctx.getBean("innerThread", InnerThread.class);

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-23T15:10:07.833

即使我引用了 CGLIB 并使用了 proxy-target-class="true" 设置，我也遇到了这个问题。我确定 ehcache:annotation 标签是罪魁祸首...删除以下配置为我解决了这个问题。幸运的是，我能够使用休眠级别 2 缓存，而不必使用 ehcache 声明式缓存。

```
<ehcache:annotations>
    <ehcache:caching id="myCacheModel" cacheName="myCache"/>
    <ehcache:flushing id="myFlushModel" cacheNames="myCache" when="after"/>
</ehcache:annotations> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-05T21:38:36.473

处理这个问题的另一种方法是实现一个接口并从spring请求接口，代理将完全实现该接口，并且强制转换应该没有问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-12-21T11:38:27.120

我有同样的问题：

> 这只是一个猜测，但尝试制作一个接口 InnerThreadInterface，然后让 InnerThread 类扩展它。之后，您应该能够：

我使用这种方式而不是上面发布的内容，并且效果很好。无需将代理目标类设置为 true，这需要更多不在我的类路径中的库。

```
InnerThreadInterface inner = (InnerThreadInterface)ctx.getBean("innerThread"); 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-12-04T21:43:33.187

创建DAO接口并实现SERVICE类的DAO接口，并在applicationContext.xml文件即spring配置文件中提供SERVICE类的配置细节，并使用bean id访问bean并引用so实例化代理的实例反对DAO接口......它会工作得很好......

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2020-11-14T10:14:22.417

在我重新启动 Idea 并重建 Maven 项目之前，一直存在这个问题。

# database - 打开 Office 基本日期时间默认值

> ID：841237
> 
> 赞同：1
> 
> 时间：2009-05-08T18:43:52.153
> 
> 标签：database, database-design, datetime, default

谁能告诉我如何在 Open Office Base 中设置日期字段的默认值，就像 GetDate() 适用于 SQL Server 一样？

干杯 OneSHOT

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T22:13:22.620

试试 CURDATE()。

可在[http://wiki.services.openoffice.org/wiki/Built-in_functions_and_Stored_Procedures找到](http://wiki.services.openoffice.org/wiki/Built-in_functions_and_Stored_Procedures)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-23T18:52:11.697

请参阅错误 69652 - 编辑：无法在表单的日期字段中设置默认日期：

[https://bugs.freedesktop.org/show_bug.cgi?id=69652](https://bugs.freedesktop.org/show_bug.cgi?id=69652)

应该能够在字段的属性中输入所需的默认日期，但是当退出属性对话框时该字段保持空白。

# xslt - 客户端 XSLT

> ID：841238
> 
> 赞同：20
> 
> 时间：2009-05-08T18:44:07.893
> 
> 标签：xslt, client-side

我将整个站点转换为 XML/XSL，我想知道当前执行客户端 XSLT 的所有问题。

以下是我已经知道的（来自第一手经验）：

*   跨域 XSL 文件（这是一个安全问题，而不是跨浏览器）
*   禁用输出转义（这在 FF 中不起作用......他们认为这是一个安全问题）

至于浏览器支持，这就是我所知道的：

*   歌剧 9+
*   法拉盛 1.0+
*   SF 2.0 +（我可能错了）
*   铬合金
*   IE 6.0 +

任何其他人也会有帮助:)

编辑：

至于第二个陷阱，有一个不错的解决方法，可以让您将 xhtml 传递给您的 xsl。它通过实际转换并确保您的 XHTML 是有效的 XML 并将其作为 XML 放入您的 XML 来工作。然后在您的 XSL 中复制 xml ;) 并将其输出为 XHTML。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-08T18:56:41.607

*   **速度：**浏览器需要在呈现 HTML 之前应用 XSLT 转换，因此用户将不得不等待更长的时间才能看到页面。浏览器使用的 XSLT 引擎可能不是一流的。在 Mac OS X 上，浏览器可能会在转换 XML 时冻结并导致“旋转的沙滩球”光标，因此用户可能会敲击屏幕并伤害自己。

*   **可访问性：**不在该集合中的浏览器（例如屏幕阅读器）呢？这些用户对你重要吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-17T08:14:47.470

在性能方面......考虑到现在大多数客户端都有 2 个 CPU 和 2 GB RAM，而大多数服务器没有......每个客户端有两个 CPU + 2 GB。因此，卸载 XSLT 转换应该提高可伸缩性，缓存 CSS + XSLT + JS*应该*减少整体流量当然是合乎逻辑的。

话虽如此，我过去曾尝试使用 XSLT 生成包含 SVG 的 XHTML，但遭遇了史诗般的失败。最大的页面太大了（索引中有 3,000 多个条目），IE 使用 DOM 进行 XSLT 转换，这导致它开始垃圾。在 xerces-j（在服务器上，在同一个开发盒上）中完成的相同转换大约快 1000 倍。

现在是浏览器猴子使用该程序的时候了；-)

一个有趣的讨论。谢谢你提出来。

干杯。基思。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T19:03:42.497

我发现将参数传递给 xsltfiles 很难保持交叉浏览的能力。我现在支持 FF 和 IE，但 Chrome 也因此退出了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T15:01:08.947

我在一个使用 xslt+xml-> html 的项目中工作了大约 1 年（尽管仅限于服务器端）

我遇到的主要缺点：没有适合 Web 开发的 xslt 生成的好工具。没有预览html。没有验证。由此产生的 xslt 完全是一团糟，没人能理解。这不是 xslt 设计者的错，而是 xslt 处理模型的结果。

xslt/xml/urls 之间的分层变得比应有的复杂。您无法进行面向组件的编程。

通常需要多个 xslt 文件，这将导致在客户端进行大量下载。否则会导致整个项目的大量代码重复。

i would see this as a form of early optimisation. you shoud start by using a "normal" web framework like wicket, jsf, tapestry, gwt etc.., later if it turns out your servers preformance is cpu-bound you might ocnsider rewriting the most often used parts of the apllication that way.

otoh, it has real benefits if you need to provide both an xml api + a html interface.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T08:56:40.807

XSLT 文件是另一个需要下载的对象，浏览器只会并行获取 2 或 3 个项目。我的经验是整体性能（下载和生成）明显较慢。

此外，根据数据的复杂性和冗余性，您下载的内容可能比实际需要的多得多 - 即。如果 HTML 已经被渲染。

# vb.net - Linq To Sql vb.net 求助

> ID：841239
> 
> 赞同：1
> 
> 时间：2009-05-08T18:44:13.463
> 
> 标签：vb.net, linq-to-sql

我有一张表，我需要根据 Id 选择记录。我只想返回日期字段中具有 Max(Date) 的记录。我怎么做？

在 SQL Server 中我使用这个

```
SELECT * FROM dch
WHERE EffectiveDate = (SELECT MAX(EffectiveDate) FROM dch
WHERE ID = 99) AND ID = 99 
```

我怎样才能在 Linq 中做到这一点。不幸的是，这个应用程序是用 VB.NET 编码的，因为我们以这种方式继承了它。

我在尝试这些

```
 Dim qry = (From dch In db.dch _
                  Where dch.Dealer.Equals(Dealer) _
                  Select dch.EffectiveDate).Max() 
```

或者

```
 Dim qry = (From dch In db.dch _
                  Where dch.Dealer.Equals(Dealer) _
                  Select ).Max(dch.EffectiveDate) 
```

显然它们不起作用。我什至接近吗？任何想法，将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T18:54:45.513

请原谅我的 VB 语法中的任何错误，我是（主要是）C# 程序员。

```
Dim item = db.dch.Where( Func(d) d.ID == 99 ) _
                 .OrderByDescending( Func(d) d.EffectiveDate )_
                 .Take(1) 
```

它实际上将被实施为

```
select top 1 <...columns...>
from dch
where ID == 99
order by EffectiveDate desc 
```

我认为这相当于您的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T18:59:16.173

我不是专门回答你的问题。这更像是一种教人钓鱼类型的场景……但是在学习 Linq 时，请将此站点添加为书签并经常访问它。 [101个Linq VB示例](http://msdn.microsoft.com/en-us/vbasic/bb688088.aspx)

[您的具体答案在 Max 下大约一半。](http://msdn.microsoft.com/en-us/vbasic/bb737922.aspx)

该站点将解决 80% 的新 LINQ 问题。

作为记录，根据您的描述，我认为这就是您想要的。

`dim results = (from d in db.dch where d.ID == 99 select d.EffectiveDate).Max()`

当然，这将只返回最高的生效日期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T19:01:02.440

在第二个查询中，您必须将 lambda 表达式作为参数传递给 Max 扩展方法：

```
Dim qry = (From dch In db.dch _
          Where dch.Dealer.Equals(Dealer) _
          ).Max(Function (item) item.EffectiveDate) 
```

编辑：再看看你的问题，我意识到我并没有真正回答它，因为你需要进行第二次查询才能获得实际结果。此外，您尝试的第一个查询应该与我的查询完全相同（即获取最大 EffectiveDate 值）。

# linux - 您可以将 Amazon EBS 附加到多个实例吗？

> ID：841240
> 
> 赞同：140
> 
> 时间：2009-05-08T18:44:17.910
> 
> 标签：linux, file, amazon-ec2, amazon-web-services

我们目前使用多个网络服务器访问一个 mysql 服务器和文件服务器。考虑迁移到云端，我是否可以使用相同的设置并将 EBS 附加到多个机器实例，或者其他解决方案是什么？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2010-10-13T00:04:59.637

**更新（2015 年 4 月）**：对于这个用例，您应该开始查看新的[Amazon Elastic File System (EFS)](https://aws.amazon.com/efs/)，它旨在以您想要的方式进行多重附加。EFS 和 EBS 之间的主要区别在于它们提供了不同的抽象：EFS 公开 NFSv4 协议，而 EBS 提供原始块 IO 访问。

您将在下面找到我对为什么无法在多台机器上安全地挂载原始块设备的原始解释。

* * *

**原帖（2011 年）：**

即使您能够将 EBS 卷附加到多个实例，它也将是一个_REALLY_BAD_IDEA_。引用 Kekoa 的话，“这就像同时在两台计算机上使用硬盘一样”

**为什么这是个坏主意？** ...您不能将卷附加到多个实例的原因是 EBS 提供了“块存储”抽象，客户在该抽象上运行 ext2/ext3/等文件系统。大多数这些文件系统（例如，ext2/3、FAT、NTFS 等）都是在假设它们对块设备具有独占访问权限的情况下编写的。访问同一个文件系统的两个实例几乎肯定会以撕裂和数据损坏而告终。

换句话说，只有在您运行旨在在多台机器之间共享块设备的集群文件系统时，双重挂载 EBS 卷才有效。此外，即使这样也不够。EBS 需要针对这种情况进行测试，并确保它提供与其他共享块设备解决方案相同的一致性保证……即，块不会缓存在中间非共享级别，如 Dom0 内核、Xen 层、和 DomU 内核。然后是在多个客户端之间同步块的性能考虑 - 大多数集群文件系统设计用于高速专用 SAN，而不是尽力而为的商品以太网。这听起来很简单，但你要求的是一件非常重要的事情。

或者，查看您的数据共享方案是否可以是 NFS、SMB/CIFS、SimpleDB 或 S3。这些解决方案都使用旨在共享文件而无需共享块设备子系统的更高层协议。很多时候，这样的解决方案实际上更有效。

在您的情况下，您仍然可以拥有一个由多个 Web 前端访问的 MySql 实例/文件服务器。然后，该文件服务器可以将其数据存储在 EBS 卷上，允许您进行夜间快照备份。如果运行文件服务器的实例丢失，您可以分离 EBS 卷并将其重新附加到新的文件服务器实例，并在几分钟内备份并运行。

**“有没有像 S3 这样的文件系统？”** - 是和不是。是的，有像[s3fs](http://code.google.com/p/s3fs/wiki/FuseOverAmazon)这样的 3rd 方解决方案可以“正常”工作，但在幕后，他们仍然必须为每次读取/写入进行相对昂贵的 Web 服务调用。对于共享工具目录，效果很好。对于您在 HPC 世界中看到的那种集群 FS 使用，这不是一个机会。为了做得更好，您需要一个提供二进制面向连接协议的新服务，例如 NFS。提供这样一个具有合理性能和行为的多挂载文件系统将是 EC2 的一个很棒的功能插件。长期以来，我一直倡导亚马逊构建类似的东西。

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2009-05-08T19:13:30.973

## 更新 (2020) 现在可以了！

现在可以使用在同一可用区内的 AWS Nitro 中运行的最新实例类型。有一些注意事项，但这对于某些需要 EBS 速度以及 EFS 不可行的用例非常有用。

[https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-volumes-multi.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-volumes-multi.html)

* * *

### 原帖 (2009)

不，这就像在两台计算机中使用硬盘一样。

如果您想要共享数据，您可以设置所有实例都可以访问的服务器。如果您希望为所有实例提供一个简单的存储区域，您可以使用 Amazon 的 S3 存储服务来存储分布式和可扩展的数据。

迁移到云端，您可以拥有完全相同的设置，但您可以将文件服务器替换为 S3，或者让所有实例都连接到文件服务器。

您有很多选择，但在实例之间共享硬盘可能不是最佳选择。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-26T20:40:54.087

不，根据 EBS 文档：“一个卷一次只能附加到一个实例”。

您目前如何使用共享存储？如果它只是为了从文件服务器提供文件，您是否考虑过设置一个系统，以便您可以将某些请求代理到文件服务器上的进程，而不是让网络服务器提供这些文件？

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-04-12T14:56:22.047

多个 Web 服务器访问 MySQL 服务器和文件服务器在 AWS 中是正常的。上述架构要遵循的一些最佳实践是：

第 1 点）EC2 上的 MySQL 可以在 AWS 中以异步/半同步模式设置为主从。RAID 0 中的 EBS-OPT+PIOPS 推荐用于高性能数据库

第 2 点）或者，您可以使用 Amazon RDS + 多可用区模式。对于读取扩展，可以将多个 RDS 只读副本附加到 MySQL RDS。

第 3 点）EBS 卷不能同时附加到多个 EC2。您可以使用 EBS 在 Amazon EC2 上创建基于 GlusterFS 的文件服务器。多个 Web 服务器可以在 AWS 基础设施上同时与单个 GlusterFS 通信。

Point 4）如果您的应用程序可以与 S3 作为文件存储集成，那么它是首选，因为它为架构带来了稳定性。您还可以使用 S3fuse 等工具从您的应用程序访问 S3。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2020-02-16T05:40:32.083

EBS 刚刚宣布这是可能的：[https ://aws.amazon.com/about-aws/whats-new/2020/02/ebs-multi-attach-available-provisioned-iops-ssd-volumes/](https://aws.amazon.com/about-aws/whats-new/2020/02/ebs-multi-attach-available-provisioned-iops-ssd-volumes/)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-08T18:52:08.450

我很确定您不能，但是您可以克隆 EBS 并将其附加到另一个实例。

这对于固定数据集或测试“真实”数据很有用，但不允许超过 1 个实例在单个块存储上运行

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-02-10T22:33:55.377

IT 界有一些东西被称为集群文件系统、Redhat GFS、Oracle OCFS2、Veritas CFS ......

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-01-03T18:23:54.520

简短的回答是明确的“不”。其他人在上面已经说过了。

那些说“是”的人没有回答这个问题，而是一个不同的问题。如果 EFS 只是一个 NFS 服务，那么它不是最初所说的问题的答案。EFS 是否“在所有区域中推出”都没有关系，因为您可以完全创建自己的 NFS 实例，并让多台服务器挂载 NFS。这并不是什么新鲜事，我们在 1992 年就已经这样做了。SMB 和 sshfs，所有这些都只是将驱动器挂载为远程文件系统的方法。

那些说“你为什么要这样做”或“一切都会以眼泪收场”的人是错误的。几十年来，我们一直在将多个磁盘安装到多个服务器。如果您曾经使用过 SAN（存储区域网络），那么通常通过 FibreChannel SAN 将同一设备连接到多个节点的能力是完全正常的。因此，任何在十年前在虚拟化/云服务器普及之前运行过服务器的人都会对此有所了解。

很快就出现了集群文件系统，其中两个系统可以读取和写入完全相同的卷。我相信这已经从历史上的 VAX 和 Alpha VMS 时代开始了。集群文件系统使用分布式互斥方案能够直接操作块。

将同一个磁盘安装到多个节点的优点是速度和减少单点故障。

现在，集群文件系统并没有在“消费者”托管业务中大受欢迎，这是事实。而且它们很复杂并且有一些陷阱。但是您甚至不需要集群文件系统来使用连接到多个计算节点的磁盘。如果你想要一个只读驱动器怎么办？您甚至不需要集群文件系统！您只需将与只读 (ro) 相同的物理设备放入您的 /etc/fstab 中。然后您安装到 2 或 10 个 EC2 服务器，所有这些服务器都可以直接从该设备读取！

在构建快速扩展的农场时，在云服务器领域有一个明显的用例。您可以准备好您的主系统磁盘，并为每台服务器使用一个非常小的启动和配置磁盘。您甚至可以让它们全部从同一个启动盘启动，并且在以读写模式重新挂载 / 之前，您可以插入一个具有 3 层的 Union-FS：

1.  主只读系统盘，带有引导、内核和用户空间安装
2.  一个配置文件系统，只有少数特定于单个服务器的文件（主要在 /etc 中）。该磁盘可以由另一台服务器写出，以准备启动新实例。这里的示例文件是 /etc/hostname ，只有很少的配置文件需要在每个节点上保持不同。
3.  您可能根本不需要的可写磁盘可能只是 /tmp 作为内存文件系统。

所以，是的，这个问题很有意义，不幸的是，答案（仍然）是“不”。并且没有 NFS 并不能很好地替代该用例，因为它会惩罚系统磁盘中的所有读取活动。但是，从 NFS 系统磁盘进行网络引导是实现上述用例的唯一替代方法。不幸的是，由于设置网络引导代理和 NFS 比访问同一个物理块设备要复杂得多。

PS：我本来想提交一个较短的版本作为评论，但我不能因为愚蠢的 51 学分门槛，所以我必须用同样的基本“否”写一个答案，但要包括我的观点为什么这是一个没有得到应得答案的相关问题。

PPS：我刚刚在 StackExchange 上发现有人提到 iSCSI。iSCSI 有点像 NFS，但在逻辑上像 FibreChannel SAN。您可以访问（和共享）物理块设备。这将使启动磁盘共享更容易，因此您无需设置可能很挑剔的 bootd 网络启动。但是在 AWS 上，也没有可用的网络启动。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-02-15T09:25:11.223

Although EBS has previously only allowed a single EC2 instance to be attached to a given volume, multi-attach is now possible, at least for io1 volumes. For more information, see [this AWS blog post](https://aws.amazon.com/blogs/aws/new-multi-attach-for-provisioned-iops-io1-amazon-ebs-volumes/).

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-10-19T18:34:35.387

为什么不在其他实例中创建一个具有卷和 sshfs 到该卷的实例？

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2014-08-21T01:21:17.620

您完全可以在 AWS 的多台服务器上使用一个驱动器。我使用 sshfs 挂载一个外部驱动器并与 EC2 中的多个服务器共享它。

我需要将单个驱动器连接到多个服务器的原因是在将它们拉到本地之前有一个地方来放置我的所有备份。

# javascript - 缩小基于 jQuery 的 js 文件

> ID：841253
> 
> 赞同：22
> 
> 时间：2009-05-08T18:47:39.523
> 
> 标签：javascript, css, minify

我们在项目中使用 jQuery。我们的 web 应用程序中有许多自定义 javascript 文件，这些文件具有使用 jQuery 功能的 UDF。我们需要减小大小（作为性能改进活动的一部分），我正在为这些文件寻找一个可靠的“缩小器”（如果同一个工具也可以缩小 CSS 文件，那就太好了）

我们尝试了 JSLint 和 JSMin - 但是 JSLint 没有完成，并且一旦遇到 jQuery 代码就会抛出许多异常。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-08T18:51:54.443

[YUI Compressor](http://developer.yahoo.com/yui/compressor/)是我使用的一个工具，它可以很好地压缩 JS 和 CSS，并且它是用 Java 编写的（因此您可以通过 ant 将其用于构建过程）。

甚至有人制作了它的[在线版本](http://www.refresh-sf.com/yui/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-07T01:37:49.493

YUI Compressor还有[一个 .NET 端口，](http://yuicompressor.codeplex.com/)可让您：-

*   将缩小/文件合并到 Visual Studio 构建后事件中
*   集成到 TFS 构建（包括 CI）
*   如果您只想在自己的代码中使用 dll（例如即时缩小）。

因为这是（原始）java 版本 YUI Compressor 的一个端口，上面提到了一些窥视，它应该在 .NET 环境中为您提供相同的结果 - 不需要 java。

HTH。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T18:53:59.633

试试[YUICompress](http://developer.yahoo.com/yui/compressor/)，它通常就像一个魅力。也可以缩小 CSS。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T18:50:38.860

[缩小](http://code.google.com/p/minify/)完成这项工作。还有[YUI Compressor](http://developer.yahoo.com/yui/compressor/)，但我从未尝试过。

从缩小网站：

> Minify 是一个 PHP5 应用程序，它可以组合多个 CSS 或 Javascript 文件，压缩它们的内容（即删除不必要的空白/注释），并使用 HTTP 编码（gzip/deflate）和允许最佳客户端缓存的标头提供结果。这有助于您遵循 Yahoo! 的高性能网站规则。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T21:15:56.120

一个不错的是[Zbugs](http://www.zbugs.com/minify-gzip-compress-css-javascript-online)：“Minify and Gzip compress CSS & Javascript in a single click”。输入您的网址，您可以一键下载结果。它还显示了与原始文件相比 gzip、缩小、连接时的大小信息。

# xml - 在 SQL Server 中传递大量参数的最佳方法是什么

> ID：841260
> 
> 赞同：7
> 
> 时间：2009-05-08T18:48:44.653
> 
> 标签：xml, sql-server-2005, ado.net, parameters

我正在尝试找出将大量参数传递到存储过程的最佳方法。

我正在考虑的一些方法是；

1.  创建相关的数据库对象，包括每个项目的参数对象并调用命令对象

2.  传入一个 XML 文档并让存储过程将其解包。（该应用程序已经将它们采用 XML 格式）

如果有人有更好的想法，我很乐意听取他们的意见

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T18:56:10.813

XML 处理对于处理*大量*参数非常方便。您可以轻松地在 XML 中传递参数，然后进行 xml 处理以获取您的值。如果您的数据已经是 .Net，那就更好了。

例如

```
DECLARE @WidgetsIds xml
SET @WidgetsIds ='<Widgets><id>3</id><id>6</id><id>15</id></Widgets >' 

SELECT
ParamValues.ID.value('.','VARCHAR(20)')
FROM @Widgets.nodes('/widgets/id') as ParamValues(ID) 
```

这应该返回 3 行：3、6、15。很容易打开它以提取您需要的值并对其进行操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T18:57:47.360

如果您可以升级到 SQL Server 2008，则有一个名为 Table-Valued Parameter 的新功能正是为此目的。请参阅有关它的[联机丛书](https://docs.microsoft.com/en-us/sql/relational-databases/tables/use-table-valued-parameters-database-engine)部分。

它基本上允许您创建表值用户定义类型，然后可以将其用作任何存储过程的只读输入参数。

在 .NET 中，您可以简单地使用一个`DataTable`实例并将该数据表中的任意行数传递给它。

马克

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T18:57:42.883

您认为有多少参数是“大数”？另外，为什么存储过程有这么多参数？听起来测试会很有趣。

调用存储过程的代码将如何得出它需要传入参数的数据？如果数据已经在 XML 中可用，那么 XML 可能是传递它们的好方法。如果数据已经在单独的变量中可用，那么参数对象可能会更好。

另请注意，在 SQL Server 2008 中，您可以选择将 DataTable 作为 TABLE 类型的参数值发送。

* * *

**编辑：**设置参数的简单方法

尽管我认为 DataSet 被过度使用和滥用，但以下是一个过程，它将设置存储过程参数对象，并使调用具有许多参数的存储过程变得更加容易：

1.  通过使用“添加新项”并选择 DataSet 创建一个新的 DataSet。将 DataSet 命名为您喜欢的任何名称。
2.  如果您尚未查看服务器资源管理器，请查看它
3.  如果数据库连接不存在，请添加到数据库的连接
4.  展开连接，直到找到您的存储过程
5.  将存储过程拖到设计图面上

这将创建一个带有方法的 TableAdapter 来调用您的存储过程。该方法取决于基础结构已经创建的 SqlParameter 对象。该方法会将传入的SP参数作为方法调用的参数，并会使用调用参数填写SP参数。这一切都是为您完成的，并且以相当有效的方式完成。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T21:31:23.670

好的，这可能会被否决，但是......只是不要传递这么多参数。不要试图找到一种方法来做一些在语言中固有的困难的事情，也许要意识到这是语言告诉你需要重新设计你正在做的事情的方式。就像许多昆虫用颜色来表示“不吃”一样，当你发现自己在做一些需要很多圈子才能完成的基本事情时，也许你需要重新考虑你在做什么。

特别是，我认为您可能应该尝试弄清楚为什么存储过程需要这么多参数；你能把它分解成一组更小、更简单的存储过程吗？也许如果您让他们通过临时表进行通信，您可以获得相同的效果，但更少...... ick。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T11:35:39.737

SQL Server Magazine 2009 年 2 月号有一篇关于使用数组的优秀文章（更多选项用于将数组作为输入处理）。本文介绍了使用 CLR 拆分 UDF。这适用于 SQL 2005，因为它具有 CLR 集成。我在这里发布和解释的代码太多了，但是如果您可以访问该杂志的网站，我建议您下载他们的功能来执行此操作。它快速而优雅。

# xml - 将 XML Schema (XSD) 文档转换为树状结构

> ID：841265
> 
> 赞同：0
> 
> 时间：2009-05-08T18:50:11.733
> 
> 标签：xml, schema, tree

我真的有麻烦了。我想将 XML 模式 (XSD) 文档转换为树状结构。有什么直接的方法吗？

我使用 XMLBeans 解析 XSD 文档并尝试遍历解析后的文档。但是，处理 XSD 的血腥细节并不容易。因此，我离开了它并寻找一种更清洁的方式。

请帮忙。

谢谢，阿蒂什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T10:14:08.580

[从http://code.google.com/p/jlibs/](http://code.google.com/p/jlibs/)尝试 XSDViewer.sh 或 XSDViewer.bat

它显示了摆动树中的 xsd。

# objective-c - 模拟详细信息披露按钮按下

> ID：841270
> 
> 赞同：1
> 
> 时间：2009-05-08T18:51:10.483
> 
> 标签：objective-c, iphone

有谁知道模拟按下详细信息披露按钮的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T19:48:46.193

我使用以下内容来模拟对表格行的点击：

```
[self tableView:self.tableView didSelectRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:0]]; 
```

也许这样的事情会起作用？

```
[self tableView:self.tableView accessoryButtonTappedForRowWithIndexPath:[NSIndexPath indexPathForRow:0 inSection:0]]; 
```

没试过，但假设它应该没问题。

# iphone - iPhone 应用程序数据访问

> ID：841276
> 
> 赞同：1
> 
> 时间：2009-05-08T18:52:57.247
> 
> 标签：iphone, safari, data-access

是否可以访问属于 iPhone 附带的应用程序的数据？我知道我们可以访问联系人信息，但我对能够读取/写入/删除用户制作的 Notes App 文档或从 ​​safari 读取/写入/删除书签感兴趣。哪些应用程序有我们可以访问的数据？我们可以从联系人列表之外的任何其他地方访问数据，还是其他所有内容都被沙箱化了？我对使用这些应用程序存储的数据感兴趣：联系人、文本、照片、地图、股票、便笺、Safari。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T19:40:07.103

只有联系人和与照片应用程序的一些更高级别的交互。您可以将图像保存到照片应用程序，并且可以允许用户从照片应用程序中选择图像以在您自己的应用程序中使用。

新的 3.0 操作系统还允许您将地图嵌入到您的程序中。

就文本而言，您可以启动 SMS 应用程序，但您无法控制消息的内容。

# silverlight - 如何在 Silverlight/CSLA 中创建延迟加载和缓存的集合

> ID：841277
> 
> 赞同：1
> 
> 时间：2009-05-08T18:53:06.950
> 
> 标签：silverlight, caching, asynchronous, csla

我正在为使用 CSLA 编写的现有桌面应用程序创建 Silverlight 前端。我遇到的一件事是转换如下类：

```
public class SomeCollection : Csla.ReadOnlyListBase<SomeCollection, SomeObject>
{
    private static SomeCollection _list = null;
    public static SomeCollection GetSomeCollection()
    {
        if (_list == null)
        {
            _list = DataPortal.FetchChild<SomeCollection>();
        }
        return _list;
    }
} 
```

代码中充满了“SomeCollection.GetSomeCollection()” 这在 silverlight 方面不起作用，因为所有 DataPortal 访问都是异步的，因此您必须从以下内容开始：

```
public static void GetSomeCollection(EventHandler<DataPortalResult<SomeCollection>> callback)
{
    DataPortal<SomeCollection> portal = new DataPortal<SomeCollection>();
    portal.FetchCompleted += callback;
    portal.BeginFetch();
} 
```

当数据准备好时，回调处理程序被调用。我当然可以缓存这个结果，但与此同时，任何 SomeCollection.GetSomeCollection() 调用都会失败。

我已经尝试阻塞直到异步调用完成，但到目前为止我还没有运气。这不是一个很好的解决方案，但我不知道如果在加载数据之前调用 SomeCollection.GetSomeCollection() 还能做什么。我能想到的唯一其他选择是允许 SomeCollection.GetSomeCollection() 返回 null，然后以某种方式将所有调用者转换为处理 null 返回值

有什么想法吗？

（我是 Silverlight 和 Csla 的超级新手，所以我可能会以完全错误的方式解决这个问题）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-12T18:03:25.580

[http://forums.lhotka.net/forums/thread/35585.aspx](http://forums.lhotka.net/forums/thread/35585.aspx)

# api - Facebook：我可以以编程方式添加朋友吗？

> ID：841291
> 
> 赞同：5
> 
> 时间：2009-05-08T18:57:34.477
> 
> 标签：api, facebook

有 Facebook API 来添加朋友吗？我找不到一个，但是我找不到它在任何地方都说没有，这似乎是很多人会问的问题。

（注意：我说的不是 Facebook 应用程序，而是基于 HTTP 的 API。）

**澄清**

我应该提到我正在尝试通过用户授权来执行此操作。他们给了我他们的用户名和密码。不要试图向任何人发送垃圾邮件。

Twitter 有一个非常简单的 API 可以做到这一点；我希望 Facebook 也是如此。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T18:59:07.530

我不认为有办法做到这一点。这是基于用户的选择。最好的办法是让用户推送到有问题的个人资料并让他们完成工作。

**编辑：** 你**永远不**应该要求 Facebook 的用户名和密码。这违反了 facebook 的条款和糟糕的设计选择。您应该使用他们的标准 api 来访问/从 facebook 访问数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-09T22:54:26.630

我花了很多时间寻找，终于找到了一个非常简单的解决方案。

使用 Facebook Javascript API，您可以通过以下方式发送好友请求：

```
<script>
    FB.ui(
     { 
      method: 'friends.add', 
      id: fbid // assuming you set this variable previously...
     }, 
     function(param){

      console.log(param);

            // If they cancel params will show: 
            //    {action:false, ...}
            // and if they send the friend request it'll have:
            //    {action:true, ...}
            // and if they closed the pop-up window then:
            //    param is undefined
     }
    );
</script> 
```

然后，回调脚本可以简单地对您的服务器执行 ajax 调用，您可以在其中保存有关操作的信息（如果需要）。

您可以使用 Facebook 上的 javascript 控制台应用程序对此进行测试：

[http://developers.facebook.com/tools/console](http://developers.facebook.com/tools/console)

粘贴上面的脚本，包括标签，或者单击文本区域底部的“示例”按钮并找到“fb.ui - friends.add”示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T21:18:58.333

查看[SimpleTest 的可编写脚本的浏览器](http://www.lastcraft.com/browser_documentation.php)。它是他们测试框架的一部分，但您可以独立使用浏览器组件。

[史努比](http://sourceforge.net/projects/snoopy/)是另一个不错的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-27T13:52:00.103

是的，我认为我们不应该要求用户通行证和用户名。

但是，如果您需要在应用程序中执行此操作，您可以使用数据库/XML 来执行此操作。但只有您的应用程序会将添加的用户视为朋友而不是 facebook。

在我的应用程序中，我在 DB 中添加了所有朋友，并将我自己添加为我自己的朋友。这样我就可以完成为 myFriends 角色定义的任务（在我的应用程序中）。

ID FBUserId 名称

9705 1215966620 Abul Bashar

9706 1248090545 Tuhin Ahmed
9707 1251036547 Orijit Diponkor Shuvrangshu Tridib
9708 1252800907 Shahin Mahmud 9709 1263680515 Binayan Dey 9710 1275860308 Mitu Kumar Debnath 9711 1279017492 Ahmed Riaj 9712 1280150772 Mahbubur Rub Talha 9713 1287414234 প্রবাসী সারোয়ার 9714 1294159220 Md.Humayun Kabir 9715 1294340379 Shah Muhammad迷宫

# wpf - WPF 数字 UpDown 控件在哪里？

> ID：841293
> 
> 赞同：146
> 
> 时间：2009-05-08T18:57:40.700
> 
> 标签：wpf, controls, numericupdown, updown

进入第一个严肃的 WPF 项目。似乎缺少很多基本控件。具体来说，我正在寻找 Numeric UpDown 控件。有没有我错过的带外版本？真的不想写自己的控件。

我不想使用 WindowsFormHost 并在其上添加一个 WinForm ctl。我希望它完全是 WPF，没有任何遗留垃圾。

谢谢

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2013-02-18T16:01:19.503

只需使用[Extended.Wpf.Toolkit](https://github.com/xceedsoftware/wpftoolkit)`IntegerUpDown`中的控件 就可以这样使用：

1.  将以下命名空间添加到您的 XAML：

    `xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"`

2.  在您希望控件使用的 XAML 中：

    `<xctk:IntegerUpDown Name="myUpDownControl" />`

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2010-05-02T05:32:00.923

我自己做的；

xml

```
<Grid  Height="23" Margin="152,63,11,0" VerticalAlignment="Top">
    <TextBox x:Name="txtNum" x:FieldModifier="private" Text="0" TextChanged="txtNum_TextChanged" Margin="3,2,13,3" />
    <Button x:Name="cmdUp" x:FieldModifier="private" FontSize="10" Padding="0,-4,0,0" Content="▲&quot; Width="10" Click="cmdUp_Click" Margin="33,2,1,13" />
    <Button x:Name="cmdDown" x:FieldModifier="private" FontSize="10" Padding="0,-4,0,0" Content="▼&quot; Width="10" Click="cmdDown_Click" Margin="33,12,1,3" />
</Grid> 
```

和背后的代码

```
private int _numValue = 0;

public int NumValue
{
    get {  return _numValue; }
    set
    {
        _numValue = value;
        txtNum.Text = value.ToString();
    }
}

public NumberUpDown()
{
    InitializeComponent();
    txtNum.Text = _numValue.ToString();
}

private void cmdUp_Click(object sender, RoutedEventArgs e)
{
    NumValue++;
}

private void cmdDown_Click(object sender, RoutedEventArgs e)
{
    NumValue--;
}

private void txtNum_TextChanged(object sender, TextChangedEventArgs e)
{
    if (txtNum == null)
    {
        return;
    }

    if (!int.TryParse(txtNum.Text, out _numValue))
        txtNum.Text = _numValue.ToString();
} 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2011-03-16T05:59:48.193

这是我自己的带有向上和向下键捕获的用户控件的示例。

Xml代码：

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="13" />
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition Height="13" />
        <RowDefinition Height="13" />
    </Grid.RowDefinitions>
    <TextBox Name="NUDTextBox"  Grid.Column="0" Grid.Row="0" Grid.RowSpan="2" TextAlignment="Right" PreviewKeyDown="NUDTextBox_PreviewKeyDown" PreviewKeyUp="NUDTextBox_PreviewKeyUp" TextChanged="NUDTextBox_TextChanged"/>
    <RepeatButton Name="NUDButtonUP"  Grid.Column="1" Grid.Row="0" FontSize="8" FontFamily="Marlett" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="NUDButtonUP_Click">5</RepeatButton>
    <RepeatButton Name="NUDButtonDown"  Grid.Column="1" Grid.Row="1" FontSize="8"  FontFamily="Marlett" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Height="13" VerticalAlignment="Bottom" Click="NUDButtonDown_Click">6</RepeatButton>
</Grid> 
```

和代码：

```
public partial class NumericUpDown : UserControl
{
    int minvalue = 0, 
        maxvalue = 100,
        startvalue = 10;
    public NumericUpDown()
    {
        InitializeComponent();
        NUDTextBox.Text = startvalue.ToString();
    }

    private void NUDButtonUP_Click(object sender, RoutedEventArgs e)
    {
        int number;
        if (NUDTextBox.Text != "") number = Convert.ToInt32(NUDTextBox.Text);
        else number = 0;
        if (number < maxvalue)
            NUDTextBox.Text = Convert.ToString(number + 1); 
    }

    private void NUDButtonDown_Click(object sender, RoutedEventArgs e)
    {
        int number;
        if (NUDTextBox.Text != "") number = Convert.ToInt32(NUDTextBox.Text);
        else number = 0;
        if (number > minvalue)
            NUDTextBox.Text = Convert.ToString(number - 1); 
    }

    private void NUDTextBox_PreviewKeyDown(object sender, KeyEventArgs e)
    {

        if (e.Key == Key.Up)
        {
            NUDButtonUP.RaiseEvent(new RoutedEventArgs(Button.ClickEvent));
            typeof(Button).GetMethod("set_IsPressed", BindingFlags.Instance | BindingFlags.NonPublic).Invoke(NUDButtonUP, new object[] { true }); 
        }

        if (e.Key == Key.Down)
        {
            NUDButtonDown.RaiseEvent(new RoutedEventArgs(Button.ClickEvent));
            typeof(Button).GetMethod("set_IsPressed", BindingFlags.Instance | BindingFlags.NonPublic).Invoke(NUDButtonDown, new object[] { true }); 
        }
    }

    private void NUDTextBox_PreviewKeyUp(object sender, KeyEventArgs e)
    {
        if (e.Key == Key.Up)
            typeof(Button).GetMethod("set_IsPressed", BindingFlags.Instance | BindingFlags.NonPublic).Invoke(NUDButtonUP, new object[] { false });

        if (e.Key == Key.Down)
            typeof(Button).GetMethod("set_IsPressed", BindingFlags.Instance | BindingFlags.NonPublic).Invoke(NUDButtonDown, new object[] { false });
    }

    private void NUDTextBox_TextChanged(object sender, TextChangedEventArgs e)
    {
        int number = 0;
        if (NUDTextBox.Text!="")
            if (!int.TryParse(NUDTextBox.Text, out number)) NUDTextBox.Text = startvalue.ToString();
        if (number > maxvalue)  NUDTextBox.Text = maxvalue.ToString();
        if (number < minvalue) NUDTextBox.Text = minvalue.ToString();
        NUDTextBox.SelectionStart = NUDTextBox.Text.Length;

    }

} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2017-04-29T21:01:38.800

给出的答案是可以的。但是，当鼠标离开控件时，我希望按钮自动隐藏。这是我基于上面[vercin](https://stackoverflow.com/a/12213478/5615980)答案的代码：

**风格**

```
<Style TargetType="{x:Type v:IntegerTextBox}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type v:IntegerTextBox}">
                    <Grid Background="Transparent">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Name="tbmain" Grid.ColumnSpan="2" Grid.RowSpan="2"
                                 Text="{Binding Value, Mode=TwoWay, NotifyOnSourceUpdated=True, 
                            NotifyOnValidationError=True, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type v:IntegerTextBox}}}" 
                                               Style="{StaticResource ValidationStyle}" />
                        <RepeatButton Name="PART_UpButton" BorderThickness="0" Grid.Column="1" Grid.Row="0"
                                      Width="13" Background="Transparent">
                            <Path Fill="Black" Data="M 0 3 L 6 3 L 3 0 Z"/>
                        </RepeatButton>
                        <RepeatButton Name="PART_DownButton" BorderThickness="0" Grid.Column="1" Grid.Row="1"
                                      Width="13" Background="Transparent">
                            <Path Fill="Black" Data="M 0 0 L 3 3 L 6 0 Z"/>
                        </RepeatButton>

                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver"  Value="False">
                            <Setter Property="Visibility" TargetName="PART_UpButton" Value="Collapsed"/>
                            <Setter Property="Visibility" TargetName="PART_DownButton" Value="Collapsed"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

**代码**

```
public partial class IntegerTextBox : UserControl
{
    public IntegerTextBox()
    {
        InitializeComponent();
    }

    public int Maximum
    {
        get { return (int)GetValue(MaximumProperty); }
        set { SetValue(MaximumProperty, value); }
    }
    public readonly static DependencyProperty MaximumProperty = DependencyProperty.Register(
        "Maximum", typeof(int), typeof(IntegerTextBox), new UIPropertyMetadata(int.MaxValue));

    public int Minimum
    {
        get { return (int)GetValue(MinimumProperty); }
        set { SetValue(MinimumProperty, value); }
    }
    public readonly static DependencyProperty MinimumProperty = DependencyProperty.Register(
        "Minimum", typeof(int), typeof(IntegerTextBox), new UIPropertyMetadata(int.MinValue));

    public int Value
    {
        get { return (int)GetValue(ValueProperty); }
        set { SetCurrentValue(ValueProperty, value); }
    }
    public readonly static DependencyProperty ValueProperty = DependencyProperty.Register(
        "Value", typeof(int), typeof(IntegerTextBox), new UIPropertyMetadata(0, (o,e)=>
        {
            IntegerTextBox tb = (IntegerTextBox)o;
            tb.RaiseValueChangedEvent(e);
        }));

    public event EventHandler<DependencyPropertyChangedEventArgs> ValueChanged;
    private void RaiseValueChangedEvent(DependencyPropertyChangedEventArgs e)
    {
        ValueChanged?.Invoke(this, e);
    }

    public int Step
    {
        get { return (int)GetValue(StepProperty); }
        set { SetValue(StepProperty, value); }
    }
    public readonly static DependencyProperty StepProperty = DependencyProperty.Register(
        "Step", typeof(int), typeof(IntegerTextBox), new UIPropertyMetadata(1));

    RepeatButton _UpButton;
    RepeatButton _DownButton;
    public override void OnApplyTemplate()
    {
        base.OnApplyTemplate();
        _UpButton = Template.FindName("PART_UpButton", this) as RepeatButton;
        _DownButton = Template.FindName("PART_DownButton", this) as RepeatButton;
        _UpButton.Click += btup_Click;
        _DownButton.Click += btdown_Click;
    }

    private void btup_Click(object sender, RoutedEventArgs e)
    {
        if (Value < Maximum)
        {
            Value += Step;
            if (Value > Maximum)
                Value = Maximum;
        }
    }

    private void btdown_Click(object sender, RoutedEventArgs e)
    {
        if (Value > Minimum)
        {
            Value -= Step;
            if (Value < Minimum)
                Value = Minimum;
        }
    }

} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2012-08-31T10:27:14.090

```
<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:numericButton2">

    <Style TargetType="{x:Type local:NumericUpDown}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:NumericUpDown}">              
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <RepeatButton Grid.Row="0" Name="Part_UpButton"/>
                            <ContentPresenter Grid.Row="1"></ContentPresenter>
                            <RepeatButton Grid.Row="2" Name="Part_DownButton"/>
                        </Grid>                  
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>

    <Window x:Class="numericButton2.MainWindow"
            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
            xmlns:local="clr-namespace:numericButton2"
            Title="MainWindow" Height="350" Width="525">
        <Grid>
            <local:NumericUpDown Margin="181,94,253,161" x:Name="ufuk" StepValue="4" Minimum="0" Maximum="20">            
            </local:NumericUpDown>
            <TextBlock Margin="211,112,279,0" Text="{Binding ElementName=ufuk, Path=Value}" Height="20" VerticalAlignment="Top"></TextBlock>
        </Grid>
    </Window>
public class NumericUpDown : Control
{
    private RepeatButton _UpButton;
    private RepeatButton _DownButton;
    public readonly static DependencyProperty MaximumProperty;
    public readonly static DependencyProperty MinimumProperty;
    public readonly static DependencyProperty ValueProperty;
    public readonly static DependencyProperty StepProperty;   
    static NumericUpDown()
    {
        DefaultStyleKeyProperty.OverrideMetadata(typeof(NumericUpDown), new FrameworkPropertyMetadata(typeof(NumericUpDown)));
        MaximumProperty = DependencyProperty.Register("Maximum", typeof(int), typeof(NumericUpDown), new UIPropertyMetadata(10));
        MinimumProperty = DependencyProperty.Register("Minimum", typeof(int), typeof(NumericUpDown), new UIPropertyMetadata(0));
        StepProperty = DependencyProperty.Register("StepValue", typeof(int), typeof(NumericUpDown), new FrameworkPropertyMetadata(5));
        ValueProperty = DependencyProperty.Register("Value", typeof(int), typeof(NumericUpDown), new FrameworkPropertyMetadata(0));
    }
    #region DpAccessior
    public int Maximum
    {
        get { return (int)GetValue(MaximumProperty); }
        set { SetValue(MaximumProperty, value); }
    }
    public int Minimum
    {
        get { return (int)GetValue(MinimumProperty); }
        set { SetValue(MinimumProperty, value); }
    }
    public int Value
    {
        get { return (int)GetValue(ValueProperty); }
        set { SetCurrentValue(ValueProperty, value); }
    }
    public int StepValue
    {
        get { return (int)GetValue(StepProperty); }
        set { SetValue(StepProperty, value); }
    }
    #endregion
    public override void OnApplyTemplate()
    {
        base.OnApplyTemplate();
        _UpButton = Template.FindName("Part_UpButton", this) as RepeatButton;
        _DownButton = Template.FindName("Part_DownButton", this) as RepeatButton;
        _UpButton.Click += _UpButton_Click;
        _DownButton.Click += _DownButton_Click;
    }

    void _DownButton_Click(object sender, RoutedEventArgs e)
    {
        if (Value > Minimum)
        {
            Value -= StepValue;
            if (Value < Minimum)
                Value = Minimum;
        }
    }

    void _UpButton_Click(object sender, RoutedEventArgs e)
    {
        if (Value < Maximum)
        {
            Value += StepValue;
            if (Value > Maximum)
                Value = Maximum;
        }
    }

} 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2020-09-04T02:58:00.190

让我们享受一些 hacky 的东西：
这是一个简单易用`Style`的`Slider`as `NumericUpDown`，没有任何隐藏代码或第三方库。

```
<Style TargetType="{x:Type Slider}">
    <Style.Resources>
        <Style x:Key="RepeatButtonStyle" TargetType="{x:Type RepeatButton}">
            <Setter Property="Focusable" Value="false" />
            <Setter Property="IsTabStop" Value="false" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="Width" Value="20" />
        </Style>
    </Style.Resources>
    <Setter Property="Stylus.IsPressAndHoldEnabled" Value="false" />
    <Setter Property="SmallChange" Value="1" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Slider}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <TextBox Grid.RowSpan="2" Height="Auto"
                                Margin="0" Padding="0"
                                VerticalAlignment="Stretch" VerticalContentAlignment="Center"
                                Text="{Binding RelativeSource={RelativeSource Mode=TemplatedParent}, Path=Value}">
                        <TextBox.InputBindings>
                            <KeyBinding Gesture="Up" Command="{x:Static Slider.IncreaseSmall}" />
                            <KeyBinding Gesture="Down" Command="{x:Static Slider.DecreaseSmall}" />
                            <KeyBinding Gesture="PageUp" Command="{x:Static Slider.IncreaseLarge}" />
                            <KeyBinding Gesture="PageDown" Command="{x:Static Slider.DecreaseLarge}" />
                        </TextBox.InputBindings>
                    </TextBox>
                    <RepeatButton Grid.Row="0" Grid.Column="1"
                                    Command="{x:Static Slider.IncreaseSmall}"
                                    Style="{StaticResource RepeatButtonStyle}">
                        <Path Data="M4,0 L0,4 8,4 Z" Fill="Black" />
                    </RepeatButton>
                    <RepeatButton Grid.Row="1" Grid.Column="1"
                                    Command="{x:Static Slider.DecreaseSmall}"
                                    Style="{StaticResource RepeatButtonStyle}">
                        <Path Data="M0,0 L4,4 8,0 Z" Fill="Black" />
                    </RepeatButton>
                    <Border x:Name="TrackBackground" Visibility="Collapsed">
                        <Rectangle x:Name="PART_SelectionRange" Visibility="Collapsed" />
                    </Border>
                    <Thumb x:Name="Thumb" Visibility="Collapsed" />
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

`TextBox`如果您想对确实应用输入限制，请尝试以下操作：

```
public static class InputLimit
{
    public static string GetDecimalValueProxy(TextBox obj) => (string)obj.GetValue(DecimalValueProxyProperty);

    public static void SetDecimalValueProxy(TextBox obj, string value) => obj.SetValue(DecimalValueProxyProperty, value);

    // Using a DependencyProperty as the backing store for DecimalValueProxy.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty DecimalValueProxyProperty =
        DependencyProperty.RegisterAttached("DecimalValueProxy", typeof(string), typeof(InputLimit),
            new FrameworkPropertyMetadata("0", FrameworkPropertyMetadataOptions.BindsTwoWayByDefault, null, CoerceDecimalValueProxy));

    private static object CoerceDecimalValueProxy(DependencyObject d, object baseValue)
    {
        if (decimal.TryParse(baseValue as string, out _)) return baseValue;
        return DependencyProperty.UnsetValue;
    }
} 
```

并将 xaml`TextBox`部分修改为：

```
<TextBox Grid.RowSpan="2" Height="Auto"
            Margin="0" Padding="0"
            VerticalAlignment="Stretch" VerticalContentAlignment="Center"
            local:InputLimit.DecimalValueProxy="{Binding RelativeSource={RelativeSource Mode=TemplatedParent}, Path=Value}"
            Text="{Binding RelativeSource={RelativeSource Self}, Path=(local:InputLimit.DecimalValueProxy), UpdateSourceTrigger=PropertyChanged}"> 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-09-22T19:20:11.047

`VerticalScrollBar`与`TextBlock`WPF 中的控件一起使用。在后面的代码中，添加以下代码：

在构造函数中，为滚动条定义一个事件处理程序：

```
scrollBar1.ValueChanged += new RoutedPropertyChangedEventHandler<double>(scrollBar1_ValueChanged);
scrollBar1.Minimum = 0;
scrollBar1.Maximum = 1;
scrollBar1.SmallChange = 0.1; 
```

然后在事件处理程序中，添加：

```
void scrollBar1_ValueChanged(object sender, RoutedPropertyChangedEventArgs<double> e)
{
    FteHolderText.Text = scrollBar1.Value.ToString();
} 
```

这是我的代码的原始片段...进行必要的更改.. :)

```
public NewProjectPlan()
{
    InitializeComponent();

    this.Loaded += new RoutedEventHandler(NewProjectPlan_Loaded);

    scrollBar1.ValueChanged += new RoutedPropertyChangedEventHandler<double>(scrollBar1_ValueChanged);
    scrollBar1.Minimum = 0;
    scrollBar1.Maximum = 1;
    scrollBar1.SmallChange = 0.1;

    // etc...
}

void scrollBar1_ValueChanged(object sender, RoutedPropertyChangedEventArgs<double> e)
{
    FteHolderText.Text = scrollBar1.Value.ToString();
} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-02-17T22:52:02.260

您可以使用我编写的 WPF 的 NumericUpDown 控件作为[WPFControls](https://github.com/T-Alex/WPFControls)库的一部分。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2019-01-16T05:17:49.343

为继续回答 9 年的问题而道歉。

我已经遵循@Michael 的回答并且它有效。

我将其作为 UserControl 执行，我可以像 Controls 元素一样拖放。我使用 Nuget 的 MaterialDesign 主题来获得雪佛龙图标和按钮波纹效果。

来自 Micheal 的经过修改的运行 NumericUpDown 如下：-

[![在此处输入图像描述](https://i.stack.imgur.com/upAPm.gif)](https://i.stack.imgur.com/upAPm.gif)

用户控制代码：-

TemplateNumericUpDown.xaml

```
<UserControl x:Class="UserControlTemplate.TemplateNumericUpDown"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:UserControlTemplate"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             mc:Ignorable="d" MinHeight="48">
    <Grid Background="{DynamicResource {x:Static SystemColors.WindowFrameBrushKey}}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition/>
            <ColumnDefinition Width="60"/>
        </Grid.ColumnDefinitions>
        <TextBox x:Name="txtNum" x:FieldModifier="private" Text="{Binding Path=NumValue}" TextChanged="TxtNum_TextChanged" FontSize="36" BorderThickness="0" VerticalAlignment="Center" Padding="5,0"/>
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="30*"/>
                <RowDefinition Height="30*"/>
            </Grid.RowDefinitions>
            <Grid Background="#FF673AB7">
                <Viewbox HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Height="Auto" Width="Auto">
                    <materialDesign:PackIcon Kind="ChevronUp" Foreground="White" Height="32.941" Width="32"/>
                </Viewbox>
                <Button x:Name="cmdUp" x:FieldModifier="private" Click="CmdUp_Click" Height="Auto" BorderBrush="{x:Null}" Background="{x:Null}"/>
            </Grid>
            <Grid Grid.Row="1" Background="#FF673AB7">
                <Viewbox HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Height="Auto" Width="Auto">
                    <materialDesign:PackIcon Kind="ChevronDown" Foreground="White" Height="32.942" Width="32"/>
                </Viewbox>
                <Button x:Name="cmdDown" x:FieldModifier="private" Click="CmdDown_Click" Height="Auto" BorderBrush="{x:Null}" Background="{x:Null}"/>
            </Grid>
        </Grid>
    </Grid>
</UserControl> 
```

TemplateNumericUpDown.cs

```
using System.Windows;
using System.Windows.Controls;

namespace UserControlTemplate
{
    /// <summary>
    /// Interaction logic for TemplateNumericUpDown.xaml
    /// </summary>
    public partial class TemplateNumericUpDown : UserControl
    {
        private int _numValue = 0;
        public TemplateNumericUpDown()
        {
            InitializeComponent();
            txtNum.Text = _numValue.ToString();
        }
        public int NumValue
        {
            get { return _numValue; }
            set
            {
                if (value >= 0)
                {
                    _numValue = value;
                    txtNum.Text = value.ToString();
                }
            }
        }

        private void CmdUp_Click(object sender, RoutedEventArgs e)
        {
            NumValue++;
        }

        private void CmdDown_Click(object sender, RoutedEventArgs e)
        {
            NumValue--;
        }

        private void TxtNum_TextChanged(object sender, TextChangedEventArgs e)
        {
            if (txtNum == null)
            {
                return;
            }

            if (!int.TryParse(txtNum.Text, out _numValue))
                txtNum.Text = _numValue.ToString();
        }
    }
} 
```

在 MyPageDesign.xaml 上，拖放创建的用户控件将具有`<UserControlTemplate:TemplateNumericUpDown HorizontalAlignment="Left" Height="100" VerticalAlignment="Top" Width="100"/>`

[![在此处输入图像描述](https://i.stack.imgur.com/aBMe8.gif)](https://i.stack.imgur.com/aBMe8.gif)

为了从模板中获取值，我使用

```
string Value1 = JournalNumStart.NumValue;
string Value2 = JournalNumEnd.NumValue; 
```

我还没有很好的技能来绑定基于 FontSize 元素的控件的高度，所以我在用户控件中手动设置了我的页面字体大小。

** 注意：- 我已在我的程序中将“Archieve”名称更改为 Archive =)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-09-27T04:34:06.940

我有一个天真的解决方案，但很有用。这是代码：

```
<Grid Name="TVGrid" Background="#7F000000">  <ScrollBar Background="Black" Orientation="Vertical" Height="35" HorizontalAlignment="Left" Margin="215,254,0,0" Minimum="0" Maximum="10" LargeChange="10" Value="{Binding ElementName=channeltext2, Path=Text}" x:Name="scroll" VerticalAlignment="Top" Width="12" RenderTransformOrigin="0.5,0.5" ValueChanged="scroll_ValueChanged" >  
        <ScrollBar.RenderTransform>  
            <TransformGroup>  
                <ScaleTransform/>  
                <SkewTransform/>  
                <RotateTransform Angle="-180"/>  
                <TranslateTransform/>  
            </TransformGroup>  
        </ScrollBar.RenderTransform>  
    </ScrollBar>  
    <TextBox Name="channeltext" HorizontalContentAlignment="Center" FontSize="20"  Background="Black" Foreground="White" Height="35" HorizontalAlignment="Left" Margin="147,254,0,0" VerticalAlignment="Top" Width="53" Text="0" />  
    <TextBox Name="channeltext2" Visibility="Hidden" HorizontalContentAlignment="Center" FontSize="20"  Background="Black" Foreground="White" Height="35" HorizontalAlignment="Left" Margin="147,254,0,0" VerticalAlignment="Top" Width="53" Text="0" />  </Grid> 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-02-21T19:39:57.387

这是另一个开源控件，它具有许多不同的输入方法（鼠标拖动、鼠标滚轮、光标键、文本框编辑），支持多种数据类型和用例：

[https://github.com/Dirkster99/NumericUpDownLib](https://github.com/Dirkster99/NumericUpDownLib)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2021-04-30T22:00:06.770

这是对另一个答案的修改，但具有绑定支持

```
<UserControl x:Class="YourNamespace.Controls.NumericUpDown"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:NetReactorLM.Desktop.Controls"
             mc:Ignorable="d"
             d:DesignHeight="300" d:DesignWidth="300">
    <Grid  VerticalAlignment="Top">
        <TextBox x:Name="txtNum" x:FieldModifier="private" Text="0" TextChanged="txtNum_TextChanged" Margin="3,2,13,3" />
        <Button x:Name="cmdUp" x:FieldModifier="private" FontSize="10" Padding="0,-4,0,0" Content="▲&quot; Width="10" Click="cmdUp_Click" Margin="33,2,1,13" />
        <Button x:Name="cmdDown" x:FieldModifier="private" FontSize="10" Padding="0,-4,0,0" Content="▼&quot; Width="10" Click="cmdDown_Click" Margin="33,12,1,3" />
    </Grid>
</UserControl> 
```

```
 using System.Windows;
using System.Windows.Controls;

namespace YourNamespace.Controls
{
    public partial class NumericUpDown : UserControl
    {

        public static readonly DependencyProperty ValueProperty = DependencyProperty.Register(
            "Value", typeof(int), typeof(NumericUpDown), new PropertyMetadata(default(int)));

        public int Value
        {
            get { return (int) GetValue(ValueProperty); }
            set
            {
                SetValue(ValueProperty, value); 
                txtNum.Text = value.ToString();
            }
        }

        public NumericUpDown()
        {
            InitializeComponent();
            txtNum.Text = Value.ToString();
        }

        private void cmdUp_Click(object sender, RoutedEventArgs e)
        {
            Value++;
        }

        private void cmdDown_Click(object sender, RoutedEventArgs e)
        {
            Value--;
        }

        private void txtNum_TextChanged(object sender, TextChangedEventArgs e)
        {
            if (txtNum == null)
            {
                return;
            }

            if (!int.TryParse(txtNum.Text, out var val))
            {
                Value = val;
                txtNum.Text = val.ToString();
            }
        }
    }
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-06-16T22:42:40.157

只是一个务实的样本：

-右键单击您的*项目*（在解决方案下），选择“管理 nuget 包...”

- 在菜单中单击*浏览*选项卡搜索“wpftoolkit”，选择“ `Extended.Wpf.Toolkit`”

**- 安装它！**

-右键单击您的用户控件*工具箱*，选择“添加选项卡..”并将其命名为“WPF Toolkit”

-右键单击新的“WPF Toolkit”选项卡，选择“Choose items...”

- 在菜单中单击“浏览...”按钮，查找 nugets DLL 文件夹，全选“ `...\packages\Extended.Wpf.Toolkit.3.5.0\lib\net40\*.dll`”

忽略有关某些 DLL 可能不包含用户控件的警告！

**准备好 ：）**

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-06-02T11:08:33.667

转到您项目的 NugetPackage 管理器-> 浏览并搜索 mahApps.Metro -> 将包安装到您的项目中。您将看到添加的参考：MahApps.Metro。然后在您的 XAML 代码中添加：

`"xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"`

在你想使用你的对象的地方添加：

```
<mah:NumericUpDown x:Name="NumericUpDown" ... /> 
```

享受对象的完全可扩展性（绑定、触发器等......）。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2022-01-12T14:04:35.890

免费版 Extended.Wpf.Toolkit 不支持 .net core 和 .net

您可以使用`HandyControl`，它有一个 NumericUpDown 控件，并且在 Wpf 和 .net 5 中运行良好。

[https://github.com/HandyOrg/HandyControl](https://github.com/HandyOrg/HandyControl)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2022-02-02T15:53:26.753

您可以使用“NumericUpDown”。

```
<mah:NumericUpDown MinWidth="70" Height="35" Minimum="0" Maximum="10000" Interval="1" /> 
```

这是链接 [https://mahapps.com/docs/controls/numericupdown](https://mahapps.com/docs/controls/numericupdown)

# iphone - iPhone NSNumberFormatter 崩溃

> ID：841297
> 
> 赞同：0
> 
> 时间：2009-05-08T18:58:19.280
> 
> 标签：iphone, crash

我想将 NSDecimalNumber 格式化为美元值（1.50 美元），但我遇到了崩溃。

这是我的方法：

```
+(NSString*) formatPriceForUser:(NSDecimalNumber*)dPrice{

NSNumberFormatter *formatter;

if (!formatter) { 
    formatter = [[NSNumberFormatter alloc] init]; 
    [formatter setNumberStyle:NSNumberFormatterCurrencyStyle];
    [formatter setMaximumIntegerDigits:6];
    [formatter setMaximumFractionDigits:2];
} 
NSString* str = [formatter stringFromNumber:dPrice];
return str; 
} 
```

崩溃发生在 stringFromNumber 调用上。

我究竟做错了什么？

提前致谢。

贡索

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T19:01:53.483

您没有初始化局部变量`formatter`，因此它会使用堆栈上剩余的任何垃圾进行初始化，并且初始`if (!formatter)`测试失败。在 C/C++/Objective-C 中，堆栈变量不会自动初始化为零。解决方法是显式初始化`formatter`为`nil`：

```
static NSNumberFormatter *formatter = nil; 
```

另请注意，通过将其声明为`static`，它将在函数调用中持续存在，因此您可以避免为每次调用重新初始化它。

# svn - tortoiseSVN 是否支持同一用户/机器的多个 iBugTraqProviders？

> ID：841303
> 
> 赞同：1
> 
> 时间：2009-05-08T18:59:56.560
> 
> 标签：svn, tortoisesvn, fogbugz

用例是我将一台开发机器用于不同的源代码树。假设我对所有存储库都使用 SVN/TortoiseSVN，我可能有不同的问题跟踪器（例如 Trac 和 FogBugz）。

如果我想使用 iBugTraqProvider 的插件 - 是否支持？我希望您可以根据路径/文件夹设置插件。但是，我不知道在哪里寻找这个来确认。我假设源代码，但我现在有点懒惰。

我正在考虑为 FogBugz 编写插件，但也需要为 Trac 使用一个。

这是描述界面的页面。

[http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-ibugtraqprovider.html#tsvn-ibugtraqprovider-1](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-ibugtraqprovider.html#tsvn-ibugtraqprovider-1)

当我在船上进行编程 (boat-programming) 时，这一点尤其重要，因为像我在家里、办公室或家庭办公室那样，没有太多空间可以容纳多台机器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T20:38:39.427

是的，插件是按路径配置的。您可以安装任意数量的。但当然，每个工作副本只能使用一个插件。

# mysql - 流畅的 Nhibernate 和 MySql 不能很好地一起玩

> ID：841305
> 
> 赞同：4
> 
> 时间：2009-05-08T19:00:57.853
> 
> 标签：mysql, nhibernate

使用 mysql 进行流畅的 nhibernate 工作需要哪些参考。我已经下载了mysql连接器的最新版本（6.0.3.0），但它仍然抛出与mysql驱动程序相关的异常。

这是一个例外：

{“无法从 NHibernate.Driver.MySqlDataDriver 创建驱动程序，NHibernate，版本=2.0.1.4000，Culture=neutral，PublicKeyToken=aa95f207798dfdb4。”}

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T19:41:40.953

根据我的经验，您需要将 MySQL 引用设置为“Copy Local”为真（即，将 DLL 复制到您的 bin 文件夹）才能让 NHibernate 完全与 MySQL 一起工作。你这样做了吗？

# c# - 执行时 ASP.Net MVC“无法加载类型”

> ID：841311
> 
> 赞同：10
> 
> 时间：2009-05-08T19:01:49.223
> 
> 标签：c#, asp.net, asp.net-mvc

我有一个非常简单的 ASP.Net MVC 应用程序，它是根据在线教程制作的。我已经完全按照它，一步一步地尝试了多次，但是当我执行代码时总是遇到同样的错误。

该程序仅显示一个索引页面，其中列出了使用 linq to sql 的 sql server 数据库中的一系列数据。

这是错误：

无法加载类型“MvcApplication1.Views.Home.Index”。

任何想法可能是什么问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-11T19:47:14.640

可能的答案在这里：

[http://www.jondavis.net/techblog/post/2009/04/29/Set-Up-IIS-For-An-MVC-App-When-All-Else-Fails-Check-View-Config.aspx](http://www.jondavis.net/techblog/post/2009/04/29/Set-Up-IIS-For-An-MVC-App-When-All-Else-Fails-Check-View-Config.aspx)

基本上，将 Views 目录的 web.config 添加到目标 Views 目录。虽然，这听起来不像您在使用强类型视图，或者没有部署您的代码。

另外，我发现如果从 web.config 中删除编译设置，也会出现这个问题。在 Visual Studio 2008 中创建的 ASP.NET MVC 项目中，这些设置包含在 web.config 中，它们应该保留，否则会发生此错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T19:40:04.153

您正在运行当前版本的 MVC 吗？候选版本中有一个重大更新，删除了视图的代码隐藏。

我遇到了同样的问题。卸载 MVC，然后重新安装为我解决了这个问题。这可以在控制面板 --> 添加/删除程序中完成。

希望这会有所帮助，亚当

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-19T22:55:48.460

我在 Global.asax 中遇到了与 ASP.NET MVC 类似的“无法加载类型”问题。修复是确保继承属性的大小写与其引用的类相同——我没有意识到它是区分大小写的！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T19:45:54.843

这对我来说似乎是一个非常模棱两可的错误。你的 Stack Trace 给了你什么提示？什么框架方法抛出异常？

# windows-services - 我有一个需要每分钟运行一次的 EXE。我应该将其作为预定的 EXE 还是 Windows 服务？

> ID：841313
> 
> 赞同：2
> 
> 时间：2009-05-08T19:01:59.597
> 
> 标签：windows-services, executable

我知道这在很大程度上是一种观点，但如果你有一个观点以及你的理由是什么，我很感兴趣。

**重复**：[调度代码重复运行的 Windows 任务调度程序有多可靠？](https://stackoverflow.com/questions/722678/how-reliable-is-windows-task-scheduler-for-scheduling-code-to-run-repeatedly)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T19:03:47.660

我有很多这样的程序，我将所有这些程序作为服务与调度程序一起运行。优点是它可以在没有任何用户登录的情况下运行。另外，我可以远程停止/启动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T19:17:56.173

我有一个类似的场景：

这是一个遗留的 EXE，需要使用明确的用户凭据每分钟运行一次，只需要在特定应用程序运行时运行（在用户登录后），并且需要“昨天”完成。

因此，只需使用内置机制使用计划任务运行就很容易了。不需要编写新代码，除非确实需要，否则它不会运行。

不过，我通常宁愿使用这种`Service`方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T19:22:05.587

您将使用较少的 CPU 将其作为服务运行而不是作为计划服务运行（这可能并不重要）。但是，我会去服务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T19:40:25.963

如果它可以由多个用户独立运行，那么它可能最好由任务调度程序控制。如果您没有源代码，那么编写一个包装器来完成任务调度程序所做的事情就没有多大意义。我只有计划任务失败的唯一一次是在不稳定的网络上运行时（如果它将在笔记本电脑上运行，请确保取消选中“仅使用交流电源”选项）。

但是，如果您可以重新编译它，并且它看起来像一个服务（可靠，需要在失败时恢复，将被广泛部署等），您可能希望将它重新设计为一个。除了提高效率之外，您还可以报告状态、明智地响应启动/停止请求并添加智能计时。

# css - 为 DotNetNuke 菜单蒙皮时遇到问题

> ID：841314
> 
> 赞同：0
> 
> 时间：2009-05-08T19:03:00.797
> 
> 标签：css, dotnetnuke

是否有一个类覆盖主菜单的 .MainMenu_MenuItem 类？我尝试更改主菜单最顶层父级的字体大小和颜色（包括管理员、主机链接），但它们不会改变。

我可以改变背景颜色。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T20:00:59.020

[其他人似乎以前也遇到过这个问题。](http://www.dotnetnuke.com/Community/Forums/tabid/795/forumid/109/threadid/17879/scope/posts/Default.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T00:45:53.733

使用名为 firefly 的 Firefox 插件将有助于确定在给定元素上定义的样式。试试看！

# php - 美国在线开放ID？

> ID：841329
> 
> 赞同：1
> 
> 时间：2009-05-08T19:05:58.357
> 
> 标签：php, openid, aol

我正在尝试在我的网站上实施 OpenID。我有谷歌，雅虎！和 ClaimID 到目前为止工作，但 AOL 告诉我“无效的 devId 或站点未注册。”。那么如何注册我的网站和/或获取 devID 并将其传递？我正在使用 JanRain/PHP OpenID。AOL 的开发博客一团糟。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T19:34:38.927

这可能不相关，但看起来 AOL 的 OpenID 现在可能有问题，我不得不切换到另一个提供商才能登录 SO。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T00:43:38.467

AOL 只是一个 OpenID 1.x 提供者，而您提到的其他提供者是 2.0 提供者（我不确定 ClaimID）。我认为 Janrain 的 PHP 库可以处理与任一版本的互操作，但在您的调查中，请注意那里的潜在差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T23:50:56.657

问题似乎已经解决了。我现在可以使用 AOL 登录，而无需更改我的代码。

# .net - 删除 IIS 7 重定向

> ID：841331
> 
> 赞同：0
> 
> 时间：2009-05-08T19:06:44.703
> 
> 标签：.net, iis-7, redirect, rewrite

我正在尝试调试不断将 *.html 文件重定向到 *.aspx 的 IIS 服务器...

它发送以下 html 以响应 url.html：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <title>website title redirected</title>
    <META http-equiv="refresh" content="0;URL=url.aspx"> 
</head>
<body>
</body>
</html> 
```

我在哪里可以找到规定这一点的规则？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-05-08T19:09:18.363

打开 IIS，查看默认网站的属性并查看文档类型（我认为是选项卡）。应该有一个默认页面列表（即 default.html、default.aspx 等）。如果没有，则每个站点的属性中都有一个重定向选项。检查并确保它没有从那里重定向。

# c# - 防止双击双重触发命令

> ID：841332
> 
> 赞同：17
> 
> 时间：2009-05-08T19:06:49.837
> 
> 标签：c#, .net, wpf, double-click

假设您有一个触发命令的控件：

```
<Button Command="New"/> 
```

如果用户双击命令，有没有办法防止命令被触发两次？

**编辑：**在这种情况下，重要的是我在 WPF 中使用[Commanding模型。](http://msdn.microsoft.com/en-us/library/ms752308.aspx)

似乎每当按下按钮时，都会执行命令。除了禁用或隐藏按钮之外，我没有看到任何防止这种情况的方法。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-05-06T21:22:58.357

任何包含需要大量处理时间的代码的事件处理程序都可能导致相关按钮的禁用延迟；无论在处理程序中调用禁用代码行的位置。

试试下面的证明，你会发现禁用/启用与事件的注册没有关联。按钮单击事件仍被注册并仍在处理中。

**矛盾证明 1**

```
private int _count = 0;

private void btnStart_Click(object sender, EventArgs e)
{
    btnStart.Enabled = false;

    _count++;
    label1.Text = _count.ToString();

    while (_count < 10)
    {            
        btnStart_Click(sender, e);            
    }           

    btnStart.Enabled = true;
} 
```

**矛盾证明 2**

```
private void form1_load(object sender, EventArgs e)
{
    btnTest.Enabled = false;
}

private void btnStart_Click(object sender, EventArgs e)
{
    btnTest.Enabled = false;
    btnTest_click(sender, e);
    btnTest_click(sender, e);
    btnTest_click(sender, e);
    btnTest.Enabled = true;
}

private int _count = 0;

private void btnTest_click(object sender, EventArgs e)
{
    _count++;
    label1.Text = _count.ToString();
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-04-02T14:27:40.283

简单有效地阻止两次、三次和四次点击

```
<Button PreviewMouseDown="Button_PreviewMouseDown"/>

private void Button_PreviewMouseDown(object sender, MouseButtonEventArgs e)
{
    if (e.ClickCount >= 2)
    {
        e.Handled = true;
    }
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-08-25T20:19:31.187

我有同样的问题，这对我有用：

```
<Button>
    <Button.InputBindings>
            <MouseBinding Gesture="LeftClick" Command="New" />
    </Button.InputBindings>
</Button> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-08T20:34:44.040

Assuming that WPF Commanding doesn't give you enough control to mess with the click handler, could you put some code in the command handler that remembers the last time the command was executed and exits if it is requested within a given time period? (code example below)

The idea is that if it's a double-click, you'll receive the event twice within milliseconds, so ignore the second event.

Something like: (inside of the Command)

```
 // warning:  I haven't tried compiling this, but it should be pretty close
DateTime LastInvoked = DateTime.MinDate;
Timespan InvokeDelay = Timespan.FromMilliseconds(100);
{
  if(DateTime.Now - LastInvoked <= InvokeDelay)
     return;

  // do your work
} 

```

(note: if it were just a plain old click handler, I'd say follow this advice: [http://blogs.msdn.com/oldnewthing/archive/2009/04/29/9574643.aspx](http://blogs.msdn.com/oldnewthing/archive/2009/04/29/9574643.aspx) )

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-09-30T19:49:48.573

我们像这样解决了它......使用异步我们找不到任何其他方法来有效阻止调用此点击的按钮上的额外点击：

```
private SemaphoreSlim _lockMoveButton = new SemaphoreSlim(1);
private async void btnMove_Click(object sender, RoutedEventArgs e)
{
    var button = sender as Button;
    if (_lockMoveButton.Wait(0) && button != null)
    {
        try
        {                    
            button.IsEnabled = false;
        }
        finally
        {
            _lockMoveButton.Release();
            button.IsEnabled = true;
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-03-22T13:55:14.500

您可以使用[MVVMLightToolkit](http://mvvmlight.codeplex.com/)`EventToCommand`中的类来防止这种情况。

处理 Click 事件并将其`EventToCommand`从您的视图发送到您的视图模型（您可以使用它`EventTrigger`来执行此操作）。
在您的视图中设置`MustToggleIsEnabled="True"`并在您的视图模型中实现一个`CanExecute()`方法。
设置`CanExecute()`为在命令开始执行时返回 false，并在命令完成时返回 true。

这将在处理命令期间禁用按钮。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-08-25T21:24:55.227

你会认为它就像在命令运行时使用 a`Command`并`CanExecute()`返回 false 一样简单。你会错的。即使您`CanExecuteChanged`明确提出：

```
public class TestCommand : ICommand
{
    public void Execute(object parameter)
    {
        _CanExecute = false;
        OnCanExecuteChanged();
        Thread.Sleep(1000);
        Console.WriteLine("Executed TestCommand.");
        _CanExecute = true;
        OnCanExecuteChanged();
    }

    private bool _CanExecute = true;

    public bool CanExecute(object parameter)
    {
        return _CanExecute;
    }

    private void OnCanExecuteChanged()
    {
        EventHandler h = CanExecuteChanged;
        if (h != null)
        {
            h(this, EventArgs.Empty);
        }
    }

    public event EventHandler CanExecuteChanged;
} 
```

我怀疑如果这个命令引用了窗口的`Dispatcher`，并`Invoke`在它调用时使用`OnCanExecuteChanged`，它会起作用。

我可以想出几种方法来解决这个问题。一个 JMarsch 的方法：只需跟踪何时`Execute`被调用，如果在最后几百毫秒内被调用，则无需执行任何操作即可退出。

一种更健壮的方法可能是让`Execute`方法 start a`BackgroundWorker`进行实际处理，让`CanExecute`return`(!BackgroundWorker.IsBusy)`和 raise`CanExecuteChanged`在任务完成时。该按钮应`CanExecute()`在`Execute()`返回后立即重新查询，它将立即执行。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-08T19:15:42.357

You could set a flag

```
bool boolClicked = false;
button_OnClick
{
    if(!boolClicked)
    {
        boolClicked = true;
        //do something
        boolClicked = false;
    }
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-11-03T12:43:32.273

一个简单而优雅的解决方案是在双击场景中创建第二次单击时的行为禁用反应。这很容易使用：

```
 <Button Command="New">
          <i:Interaction.Behaviors>
            <behaviors:DisableDoubleClickBehavior />
          </i:Interaction.Behaviors>
  </Button> 
```

行为（更多关于行为 - [https://www.jayway.com/2013/03/20/behaviors-in-wpf-introduction/](https://www.jayway.com/2013/03/20/behaviors-in-wpf-introduction/)）

```
using System.Windows.Controls;
using System.Windows.Input;
using System.Windows.Interactivity;

public class DisableDoubleClickBehavior : Behavior<Button>
{
    protected override void OnAttached()
    {
        base.OnAttached();
        AssociatedObject.PreviewMouseDoubleClick += AssociatedObjectOnPreviewMouseDoubleClick;
    }

    private void AssociatedObjectOnPreviewMouseDoubleClick(object sender, MouseButtonEventArgs mouseButtonEventArgs)
    {
        mouseButtonEventArgs.Handled = true;
    }

    protected override void OnDetaching()
    {
        AssociatedObject.PreviewMouseDoubleClick -= AssociatedObjectOnPreviewMouseDoubleClick;
        base.OnDetaching();
    }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-10-30T16:48:37.790

我正在使用 Xamarin 和 MVVMCross，虽然不是 WPF，但我认为以下解决方案适用，我创建了一个特定于视图模型的解决方案（不处理特定于平台的 UI），我认为它非常方便，使用帮助程序或基类为视图模型创建一个跟踪命令的列表，如下所示：

```
private readonly List<string> Commands = new List<string>();

        public bool IsCommandRunning(string command)
        {
            return Commands.Any(c => c == command);
        }

        public void StartCommand(string command)
        {
            if (!Commands.Any(c => c == command)) Commands.Add(command);
        }

        public void FinishCommand(string command)
        {
            if (Commands.Any(c => c == command))  Commands.Remove(command);
        }

        public void RemoveAllCommands()
        {
            Commands.Clear();
        } 
```

像这样在动作中添加命令：

```
public IMvxCommand MyCommand
        {
            get
            {
                return new MvxCommand(async() =>
                {
                    var command = nameof(MyCommand);
                    if (IsCommandRunning(command)) return;

                    try
                    {
                        StartCommand(command);

                        await Task.Delay(3000);
                       //click the button several times while delay
                    }
                    finally
                    {
                        FinishCommand(command);
                    }
                });
            }
        } 
```

try/finally 只是确保命令始终完成。

通过设置异步操作并进行延迟对其进行测试，第一次点击有效，第二次在条件下返回。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-04-20T13:02:33.353

有同样的问题，通过使用附加行为解决了它。

```
namespace VLEva.Core.Controls
{
    /// <summary></summary>
    public static class ButtonBehavior
    {
        /// <summary></summary>
        public static readonly DependencyProperty IgnoreDoubleClickProperty = DependencyProperty.RegisterAttached("IgnoreDoubleClick",
                                                                                                                  typeof(bool),
                                                                                                                  typeof(ButtonBehavior),
                                                                                                                  new UIPropertyMetadata(false, OnIgnoreDoubleClickChanged));

        /// <summary></summary>
        public static bool GetIgnoreDoubleClick(Button p_btnButton)
        {
            return (bool)p_btnButton.GetValue(IgnoreDoubleClickProperty);
        }

        /// <summary></summary>
        public static void SetIgnoreDoubleClick(Button p_btnButton, bool value)
        {
            p_btnButton.SetValue(IgnoreDoubleClickProperty, value);
        }

        static void OnIgnoreDoubleClickChanged(DependencyObject p_doDependencyObject, DependencyPropertyChangedEventArgs e)
        {
            Button btnButton = p_doDependencyObject as Button;
            if (btnButton == null)
                return;

            if (e.NewValue is bool == false)
                return;

            if ((bool)e.NewValue)
                btnButton.PreviewMouseLeftButtonDown += new MouseButtonEventHandler(btnButton_PreviewMouseLeftButtonDown);
            else
                btnButton.PreviewMouseLeftButtonDown -= btnButton_PreviewMouseLeftButtonDown;
        }

        static void btnButton_PreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e)
        {
            if (e.ClickCount >= 2)
                e.Handled = true;
        }

    }
} 
```

然后直接在 XAML 中通过声明样式将属性设置为 TRUE，这样它就可以立即影响所有按钮。（不要忘记 XAML 命名空间声明）

```
<Style x:Key="styleBoutonPuff" TargetType="{x:Type Button}">
    <Setter Property="VLEvaControls:ButtonBehavior.IgnoreDoubleClick" Value="True" />
    <Setter Property="Cursor" Value="Hand" />
</Style> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-08T19:24:47.717

If your control derives from System.Windows.Forms.Control, you can use the [double click event](http://msdn.microsoft.com/en-gb/library/system.windows.controls.control.mousedoubleclick.aspx).

If it doesn't derive from System.Windows.Forms.Control, then [wire up mousedown](http://www.switchonthecode.com/tutorials/wpf-tutorial-getting-the-doubleclick-event) instead and confirm the click count == 2 :

```
private void Button_MouseDown(object sender, MouseButtonEventArgs e)
{
    if (e.ClickCount == 2)
    {
       //Do stuff
    }
 } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-05-14T18:59:35.533

我将按钮绑定到可以触发 Run() 的委托函数：

```
private const int BUTTON_EVENT_DELAY_MS = 1000; //1 second. Setting this time too quick may allow double and triple clicking if the user is quick.
private bool runIsRunning = false;

private void Run()
{
    try
    {
        if (runIsRunning) //Prevent Double and Triple Clicking etc. We just want to Run run once until its done!
        {
            return;
        }
        runIsRunning = true;

        EventAggregator.GetEvent<MyMsgEvent>().Publish("my string");

        Thread.Sleep(BUTTON_EVENT_DELAY_MS);  
        runIsRunning = false;
    }
    catch  //catch all to reset runIsRunning- this should never happen.
    {
        runIsRunning = false;
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-04-07T05:19:48.240

这里唯一真正的解决方案是创建一个使用 ConcurrentQueue 命令的 CommandHandler 单例类。命令处理程序需要它自己的处理循环，该循环在第一次按下按钮后启动并在队列为空时结束，这需要在它自己的线程中运行。

然后每个单击处理程序将命令推送到该队列，然后该队列执行该命令。如果同一命令在队列中出现两次，您可以简单地忽略处理它（或执行其他操作）

我看到的这个问题中的其他所有内容都不起作用，因为他们使用非原子操作来检查按钮是否已连续快速按下两次。这可能会失败，因为您可以在设置布尔值/计时器/信号量之前获得双重入口。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-11-09T16:21:59.930

将代码包装在 try-catch-finally 或 try-finally 块中。无论 try 中是否发生任何错误，都将始终调用 finally 语句。

**例子**

```
 private Cursor _CursorType;
    // Property to set and get the cursor type
    public Cursor CursorType
    {
      get {return _CursorType; }
      set
      {
        _CursorType = value;
        OnPropertyChanged("CursorType");
      }
    }

    private void ExecutedMethodOnButtonPress()
    {
       try
       {
         CursorType = Cursors.Wait;
         // Run all other code here
       }
       finally
       {
         CursorType = Cursors.Arrow;
       }
    } 
```

注意：CursorType 是 UserControl 或 Window 绑定到的属性

```
<Window 
Cursor = {Binding Path=CursorType}> 
```

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2009-12-15T21:12:51.143

这将检查验证是否通过，如果通过则禁用按钮。

```
private void checkButtonDoubleClick(Button button)
    {
        System.Text.StringBuilder sbValid = new System.Text.StringBuilder();
        sbValid.Append("if (typeof(Page_ClientValidate) == 'function') { ");
        sbValid.Append("if (Page_ClientValidate() == false) { return false; }} ");
        sbValid.Append("this.value = 'Please wait...';");
        sbValid.Append("this.disabled = true;");
        sbValid.Append(this.Page.ClientScript.GetPostBackEventReference(button, ""));
        sbValid.Append(";");
        button.Attributes.Add("onclick", sbValid.ToString());
    } 
```

# c - 在 C 中使用函数指针时的警告

> ID：841333
> 
> 赞同：2
> 
> 时间：2009-05-08T19:07:10.177
> 
> 标签：c, function-pointers, compiler-warnings

这实际上是一个非关键问题，但我在大多数情况下使用函数指针时都会收到此警告，但我自己仍然无法弄清楚为什么。考虑以下原型：

```
typedef void * Pointer;
void tree_destroyLineage(Tree greatest_parent, void *dataDestructor(Pointer data)); 
```

到目前为止，我可以编译我的千行代码并获得零警告。所以我假设我正确地编写了声明。但后来我在代码中调用它，将 free 作为我的析构函数传递，因为存储在树节点中的数据是简单的结构：

```
tree_destroyLineage(decision_tree, free); 
```

这让我得到了一个`"warning: passing argument 2 of 'tree_destroyLineage' from incompatible pointer type"`信息。我的第一个假设是编译器在编译时无法弄清楚这是同一件事`Pointer`，`void *`所以我尝试使用完全相同类型的函数指针创建另一个函数，以“重新传递”调用`free()`并更改函数指针声明接受 a`void *`而不是指针。这两种方法在同一个地方给了我同样的警告。

我做错了什么，我该如何解决？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-08T19:12:29.043

我相信像免费这样的功能的正确签名是：

```
void (*freefunc)(void*) 
```

不是

```
void *dataDestructor(Pointer data) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-08T19:14:13.953

我不确定你的图书馆，但我的免费没有返回值（即它是无效的）。它不返回 void 指针。

如果您希望第二个参数是指向返回 void 并将 void 指针作为参数的函数的指针，我相信您想要的是：

无效 (*fn)(无效*)

并不是

无效*fn（无效*）

这就是你所拥有的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-08T19:15:58.533

```
void tree_destroyLineage(Tree greatest_parent, 
                          void *dataDestructor(Pointer data)); 
```

应该：

```
void tree_destroyLineage(Tree greatest_parent, 
                          void (*dataDestructor)(Pointer data)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T19:12:04.253

试试这个：

```
void tree_destroyLineage(Tree greatest_parent, void (*dataDestructor)(void *data)); 
```

将 a`typedef`用于 void 指针简直是愚蠢的。

编辑：问题是，如果没有括号`*dataDestructor`，编译器认为函数返回`void *`，而不是`void`. 括号告诉编译器该函数返回`void`，但它是一个指向函数的指针。

# php - 使用 JQuery 来自具有相同 POST 参数的相同 PHP 文件的不同 AJAX XML 结果

> ID：841337
> 
> 赞同：1
> 
> 时间：2009-05-08T19:08:00.643
> 
> 标签：php, javascript, jquery, xml, ajax

我正在使用 JQuery .ajax 方法来获取 XML 中的简单 PHP 查询的结果（我已经在这个项目中多次完成，没有出现问题）。但是，在 Firebug 的控制台中查看结果时，我从主项目中收到的 XML 结果与我所期望的不同（通过简单地查看 PHP 文件进行测试）。我还通过创建一个新的 PHP 文件再次对此进行了测试，该文件的唯一功能是运行 ajax 调用，结果如预期的那样是正确的。

[更新]：我刚刚再次测试了这个，我从我的项目中收到了正确的结果，但是当我刷新页面时，我又得到了不正确的结果。

为了测试，我通过删除所有 POST 数据和成功回调函数来简化过程，但我仍然得到不同的结果..

以下是代码片段：

JQuery ajax 调用（在测试文件和我的项目中都使用）：

```
 $.ajax({
        url:"./lib/ajax_friends.php",
        type:"POST",
     //   data:{action : "getFriends", userID: userID} ,
        dataType: 'xml',
        sync:false,
        error:function(request){alert("error")},
        success:function(theXML){
        }
   }) 
```

PHP代码是：

```
$userID='11';
    $sql = "SELECT ID, name, pic_square FROM users WHERE ID = $userID";
    $result = mysql_query($sql) or die(mysql_error());

    $xml = "";
    while($array = mysql_fetch_array($result)) {
        $ID = $array['ID'];
        $Name = $array['name'];
        $pic_square = $array['pic_square'];
        $xml .= "<Friend>";
        $xml .= "<ID>$ID</ID>";
        $xml .= "<Name>$Name</Name>";
        $xml .= "<Pic>$pic_square</Pic>";
        $xml .= "</Friend>";
    }

    header('Content-Type: application/xml; charset=ISO-8859-1');
    header("Cache-Control: no-cache, must-revalidate");
    header("Expires: Mon, 26 Jul 1997 05:00:00 GMT");

    echo "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>";
    echo "<Friends>";
    echo $xml;
    echo "</Friends>"; 
```

注意：我尝试更改标题以强制完全刷新，但它仍然没有帮助

**测试文件** 来自 Firebug 的测试 PHP 文件的标头（返回正确结果是）：

```
Response Headers
Date    

Fri, 08 May 2009 18:53:34 GMT

Server  

Apache/2.2.9 (Unix) mod_ssl/2.2.9 OpenSSL/0.9.7l DAV/2 PHP/5.2.6

X-Powered-By    

PHP/5.2.6

Cache-Control   

no-cache, must-revalidate

Expires 

Mon, 26 Jul 1997 05:00:00 GMT

Content-Length  

200

Keep-Alive  

timeout=5, max=98

Connection  

Keep-Alive

Content-Type    

application/xml; charset=ISO-8859-1

Request Headers
Host    

localhost

User-Agent  

Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.0.10) Gecko/2009042315 Firefox/3.0.10

Accept  

application/xml, text/xml, */*

Accept-Language 

en-us,en;q=0.5

Accept-Encoding 

gzip,deflate

Accept-Charset  

ISO-8859-1,utf-8;q=0.7,*;q=0.7

Keep-Alive  

300

Connection  

keep-alive

X-Requested-With    

XMLHttpRequest

Referer 

http://localhost/~Seeff/testajax.php

Cookie  

a7c768c2549daf4a7f69b9916bab5a38=4555bf36cf1b308f19a12f8da6944b80; a7c768c2549daf4a7f69b9916bab5a38_user
=507514167; a7c768c2549daf4a7f69b9916bab5a38_ss=kKgqsUlOrFArzo9Nrv2Zyg__; a7c768c2549daf4a7f69b9916bab5a38_session_key
=3.qPXakpbNIIX_bvndm_5gnA__.86400.1241895600-507514167; a7c768c2549daf4a7f69b9916bab5a38_expires=1241895600
; fbsetting_a7c768c2549daf4a7f69b9916bab5a38=%7B%22connectState%22%3A1%2C%22oneLineStorySetting%22%3A1
%2C%22shortStorySetting%22%3A1%2C%22inFacebook%22%3Afalse%7D 
```

响应是：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Friends><Friend><ID>12</ID><Name>XXX
</Name><Pic>http://something</Pic></Friend></Friends> 
```

**主项目** 我的主项目中来自 ajax 调用的 Firebug 标头是：

```
Response Headers
Date    

Fri, 08 May 2009 18:53:41 GMT

Server  

Apache/2.2.9 (Unix) mod_ssl/2.2.9 OpenSSL/0.9.7l DAV/2 PHP/5.2.6

X-Powered-By    

PHP/5.2.6

Cache-Control   

no-cache, must-revalidate

Expires 

Mon, 26 Jul 1997 05:00:00 GMT

Content-Length  

74

Keep-Alive  

timeout=5, max=98

Connection  

Keep-Alive

Content-Type    

application/xml; charset=ISO-8859-1

Request Headers
Host    

localhost

User-Agent  

Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.0.10) Gecko/2009042315 Firefox/3.0.10

Accept  

application/xml, text/xml, */*

Accept-Language 

en-us,en;q=0.5

Accept-Encoding 

gzip,deflate

Accept-Charset  

ISO-8859-1,utf-8;q=0.7,*;q=0.7

Keep-Alive  

300

Connection  

keep-alive

X-Requested-With    

XMLHttpRequest

Referer 

http://localhost/~Seeff/

Cookie  

a7c768c2549daf4a7f69b9916bab5a38=4555bf36cf1b308f19a12f8da6944b80; a7c768c2549daf4a7f69b9916bab5a38_user
=507514167; a7c768c2549daf4a7f69b9916bab5a38_ss=kKgqsUlOrFArzo9Nrv2Zyg__; a7c768c2549daf4a7f69b9916bab5a38_session_key
=3.qPXakpbNIIX_bvndm_5gnA__.86400.1241895600-507514167; a7c768c2549daf4a7f69b9916bab5a38_expires=124
1895600 
```

回应是：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Friends></Friends> 
```

因此，由于某种原因，当从主项目调用时，结果中省略了内部 XML 节点。

我猜我的主要项目中有一些东西一定会以某种方式干扰，但我就是想不通。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T16:24:31.847

我认为这是一个mysql连接问题；无论如何，选择都没有运行。要进行调试，请将 echo "hello" 添加到 while{} 中，看看它是否完全显示出来:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T10:53:07.237

好像您没有从数据库中获取数据。如果你这样做会发生什么

```
echo "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>";
echo "<Friends>";
echo "<Test>Hello</Test>";
echo "</Friends>"; 
```

反而？如果确实是缓存问题，那么向 URL 添加随机参数应该会强制浏览器更新。即这应该工作：

```
$.ajax({
    url:"./lib/ajax_friends.php?random987398792374",
... 
```

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T19:31:44.690

My guess is you should be using mysql_fetch_assoc instead of mysql_fetch_array. mysql_fetch_array will give you an array structure with numeric indexes. Where mysql_fetch_assoc will give you the $array[column_name] like you are looking for.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T05:27:33.313

在 firebug 中，右键单击 AJAX 调用，然后选择“在新选项卡中打开”。Firefox 应该为您很好地格式化 XML（如果您这样做`header("Content-Type: application/xml")`的话）。查看它发送的请求（在位置框中）。重新加载几次。打印您认为应该设置的 PHP 文件中的数据。

对不起，我帮不上忙，但这听起来像是某个地方的愚蠢错误。

或者，您可以将数据构建为一个数组，然后使用 JSON（我的首选方法）。

更重要的是，你永远不应该对 SQL 进行参数注入。贝瑞非常危险。使用类似 PDO 的东西。

```
$userID='11';
$PDO = new PDO("mysql:dbname=mydb", "uname", "pword");

$stmt = $PDO->prepare("SELECT ID, name, pic_square FROM users WHERE ID = :userID");
$stmt->execute(array("userID" => $userID)) or die (print_r($PDO->errorInfo(), TRUE));

$output = array();
while($row = $stmt->fetch(PDO::FETCH_NUM, PDO::FETCH_ORI_NEXT)) {
    $output = $row;
}

header('Content-Type: application/json; charset=ISO-8859-1');
header("Cache-Control: no-cache, must-revalidate");
header("Expires: Mon, 26 Jul 1997 05:00:00 GMT");

print json_encode($output); 
```

# sql-server - 添加链接的 SQL 服务器时遇到问题

> ID：841339
> 
> 赞同：9
> 
> 时间：2009-05-08T19:08:31.953
> 
> 标签：sql-server, linked-server

我正在尝试从远程 SQL Server 中提取数据。我可以使用 SQL 身份验证访问远程服务器；我没有任何运气使用与 sp_addlinkedserver 相同的凭据。

我正在尝试这样的事情：

```
Exec sp_dropserver 'Remote', 'droplogins'
go

EXEC sp_addlinkedserver   
   @server='Remote', 
   @srvproduct='',
   @provider='SQLNCLI', 
   @datasrc='0.0.0.0'

EXEC sp_addlinkedsrvlogin
    @useself='FALSE',
    @rmtsrvname='Remote',
    @rmtuser='User',
    @rmtpassword='Secret'

Select Top 10 * from Remote.DatabaseName.dbo.TableName 
```

这是我得到的：

```
链接服务器“远程”的 OLE DB 提供程序“SQLNCLI”返回消息
“登录超时已过期”。

链接服务器“远程”的 OLE DB 提供程序“SQLNCLI”返回消息
“建立与服务器的连接时发生错误。
连接到 SQL Server 2005 时，此故障可能是由
事实上，在默认设置下 SQL Server 不允许远程
连接。”。

消息 53，第 16 级，状态 1，第 0 行
命名管道提供程序：无法打开与 SQL Server [53] 的连接。

```

同样，我可以使用这些确切的凭据直接访问服务器（在 SQL Management Studio 中），因此这不是我的网络或凭据的问题。

我在网上看到的大多数示例似乎都涉及 Windows 域帐户，而不是 SQL 安全登录。这不适用于 SQL 身份验证吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-03-18T11:53:15.930

为了解决上述问题，我修改了链接服务器定义以专门指定 TCP：

```
EXEC sp_addlinkedserver   
    @server='TEST_LINK', 
    @srvproduct='',
    @provider='SQLNCLI', 
    @datasrc='tcp:0.0.0.0'

EXEC sp_addlinkedsrvlogin
    @useself='FALSE',
    @rmtsrvname='TEST_LINK',
    @rmtuser='user',
    @rmtpassword='secret' 
```

这对我有用。此方法还允许我为远程服务器指定一个非标准端口：

```
EXEC sp_addlinkedserver   
    @server='TEST_LINK', 
    @srvproduct='',
    @provider='SQLNCLI', 
    @datasrc='tcp:0.0.0.0,1111' 
```

我希望这有帮助

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-08T19:38:12.583

它确实适用于 sql 身份验证。事实上它更容易，因为如果您使用 SQL 身份验证，则不必设置 Kerberos。

您的错误消息令人困惑，您的地址是 IP 地址：123.45.678.90

您的错误消息是关于命名管道的。这可能是一个线索吗？

您不必通过 IP 地址在 TSQL 中引用服务器。如果你[在本地服务器上加一个别名](http://support.microsoft.com/kb/265808)，指向远程服务器，你可以给一个更合理的名字。通过IP地址引用它显然不能令人满意。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T02:18:55.507

想通了，这要归功于 SMS GUI 向导中用于添加链接服务器的一行指令：`"If SQL Server is selected, then the Linked Server name is also the network name of the server."`

我认为链接服务器的名称只是一个任意别名。

这就像一个魅力 - 很遗憾，每次我想使用这个链接服务器时，我都必须输入 IP（在括号中），但是你有它。

```
Exec sp_dropserver '0.0.0.0', 'droplogins'
go

EXEC sp_addlinkedserver   
    @server='0.0.0.0', 
    @srvproduct='',
    @provider='SQLNCLI', 
    @datasrc='0.0.0.0'

EXEC sp_addlinkedsrvlogin
    @useself='FALSE',
    @rmtsrvname='0.0.0.0',
    @rmtuser='user',
    @rmtpassword='secret'
go

Select Top 10 * from [0.0.0.0].DatabaseName.dbo.TableName 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T19:50:24.863

如果在指定 IP 地址时在命名管道上失败，请尝试在 IP 地址前加上“tcp:”，看看是否有助于将其设置在正确的路径上。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-11T04:41:08.807

sp_configure '即席分布式查询',1

下一个

重新配置覆盖

已经检查了 SQL Surface area configuraton-->Databaseengine-->Remoteconnections-->Local and remoteconnections-->应该同时使用 TCP/IP 和命名管道选项（如果没有选择该选项并重新启动）

这必须解决链接服务器“远程”的 OLE DB 提供程序“SQLNCLI”返回消息“建立与服务器的连接时发生错误。连接到 SQL Server 2005 时，此故障可能是由于在默认设置 SQL Server 不允许远程连接。”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-11T15:16:39.320

有时协议已启用，并且外围配置允许远程连接，但 SQL Server Browser 服务在设置配置后尚未重新启动。这意味着配置未激活。

如果您的配置设置似乎都正确，请尝试重新启动 SQL Server Browser 作为故障排除步骤。

麦克风

# c# - 代码中的.net Access Forms身份验证“超时”值

> ID：841347
> 
> 赞同：6
> 
> 时间：2009-05-08T19:12:07.453
> 
> 标签：c#, .net, asp.net

我正在向我的应用程序添加注销到期警报，并希望从我的代码中访问我的 web.config 表单身份验证“超时”值。我有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-25T15:09:51.973

我认为您可以从 FormsAuthentication 静态类方法中读取它，这比直接读取 web.config 更好，因为您可能从更高级别的 web.config 继承身份验证设置。

```
var authTicket = new FormsAuthenticationTicket(user.EmailAddress, true, (int)FormsAuthentication.Timeout.TotalMinutes); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-23T11:34:38.160

您可以在以下位置访问 web.config 的`timeout`值：

`FormsAuthentication.Timeout.TotalMinutes`

我不知道它什么时候可用，我使用的是 .NET 4.5。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-01-21T17:11:55.053

```
 Configuration conn = WebConfigurationManager.OpenWebConfiguration("");

            AuthenticationSection section = (AuthenticationSection)conn.SectionGroups.Get("system.web").Sections.Get("authentication");

            long cookieExpires = System.Convert.ToInt64(section.Forms.Timeout.TotalMinutes); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-29T15:59:14.710

您可以使用以下方法从 Javascript 访问它：

```
var expireTime = <%= FormsAuthentication.Timeout.TotalMinutes %>; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T19:20:41.050

You can [parse it directly from the web.config](http://www.hanselman.com/blog/AccessingTheASPNETFormsAuthenticationTimeoutValue.aspx) file.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-19T12:31:37.877

此代码将`timeout`在几分钟内为`AuthenticationSection`您提供当前项目的 Web.Config 文件中的部分，

```
Configuration conn = WebConfigurationManager.OpenWebConfiguration(Request.ApplicationPath);
AuthenticationSection section = (AuthenticationSection)conn.SectionGroups.Get("system.web").Sections.Get("authentication");
FormsAuthenticationConfiguration currentForms = section.Forms;
int timeout = currentForms.Timeout.Minutes;
txtAppSessionTimeout.Text = timeout.ToString(); 
```

如果您发现此答案正确，请将其标记为正确

# java - 休眠一对零或一映射

> ID：841354
> 
> 赞同：13
> 
> 时间：2009-05-08T19:13:39.163
> 
> 标签：java, hibernate

我正在尝试在 Hibernate 中将一个映射到“零或一”关系。我想我可能已经找到了一种使用多对一的方法。

```
class A {
  private B b;
  // ... getters and setters
}

class B {
  private A a;
} 
```

A 类的映射指定：

```
<many-to-one name="b" class="B" 
insert="false" update="false" 
column="id" unique="true"/> 
```

B 类的映射指定：

```
<one-to-one name="a" class="A" constrained="true"/> 
```

当在数据库中找不到 B 的匹配行时，我希望 b 为空。所以我可以这样做（在 A 类中）：

```
if (b == null) 
```

但是，似乎 b 永远不会为空。

我能做些什么呢？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-17T23:55:57.543

就像博登说的那样，答案是添加`not-found="ignore"`到 A 中的多对一语句。使用注释执行此操作：

在 A 类：

```
@ManyToOne
@Cascade({ CascadeType.ALL })
@JoinColumn(name = "Id")
@NotFound(action=NotFoundAction.IGNORE)
private B b 
```

B类：

```
@Id
@GeneratedValue(generator = "myForeignGenerator")
@org.hibernate.annotations.GenericGenerator(
    name = "myForeignGenerator",
    strategy = "foreign",
    parameters = @Parameter(name = "property", value = "a")
)
private Long subscriberId;

@OneToOne(mappedBy="b")
@PrimaryKeyJoinColumn
@NotFound(action=NotFoundAction.IGNORE)
private A a; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-08T21:35:16.517

答案是在 A 中的多对一语句中添加 not-found="ignore"：

```
<many-to-one name="b" class="B" not-found="ignore" insert="false" update="false" column="id" unique="true"/> 
```

我尝试按照 Rob H 的建议简单地将 lazy="false" 添加到 B，但是每次我加载没有 B 的 A 时都会导致 HibernateObjectRetrievalFailureException。

请参阅本主题以获取更多信息：

[https://forum.hibernate.org/viewtopic.php?p=2269784&sid=5e1cba6e2698ba4a548288bd2fd3ca4e](https://forum.hibernate.org/viewtopic.php?p=2269784&sid=5e1cba6e2698ba4a548288bd2fd3ca4e)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T20:51:08.383

尝试在多对一元素上设置lazy="false"。这应该会强制 Hibernate 在加载第一个对象（“A”）时尝试获取关联（“B”）。“A”中的属性将使用“B”的真实实例初始化或为空。

# c# - 将自定义事件参数传递给 timer_TICK 事件

> ID：841359
> 
> 赞同：0
> 
> 时间：2009-05-08T19:14:38.880
> 
> 标签：c#, events

我有课

```
//Create GroupFieldArgs as an EventArgs
    public class GroupFieldArgs : EventArgs
    {
        private string groupName = string.Empty;
        private int aggregateValue = 0;
        //Get the fieldName
        public string GroupName
        {
            set { groupName = value; }
            get { return groupName; }
        }
        //Get the aggregate value
        public int AggregateValue
        {
            set { aggregateValue = value; }
            get { return aggregateValue; }
        }
    } 
```

我有另一个创建事件处理程序的类

```
public class Groupby
{
 public event EventHandler eh;
} 
```

最后，我的表单上有 Timer，它有 Timer_TICK 事件。我想在 Timer_TICK 事件中传递 GroupFieldArgs。最好的方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-03-08T15:04:48.760

只需将您的 arg(s) 附加到计时器对象的“标记”属性 - 任何其他“可能”都过大：

```
Timer SomeTimer;
void SomeMethod()
{
    SomeTimer = new Timer();
    SomeTimer.Tag = "myArgString"; // or struct, class, list, etc..
    SomeTimer.Tick += new EventHandler(SomeTimer_Tick);
    SomeTimer.Start();
}

void SomeTimer_Tick(object sender, EventArgs e)
{
    string s = ((Timer)sender).Tag; // SomeTimer.Tag
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T21:45:51.717

您可以继承标准计时器类并添加一个属性，您可以在其中注入您的自定义事件参数。您的新类可以在内部处理 Elapsed 事件，并公开一个带有您的 EventArgs 的新事件。

```
namespace Test
{
    class MyTimer : System.Timers.Timer
    {
        public EventArgs MyEventArgs { get; set; }

        public MyTimer()
        {
            this.Elapsed += new System.Timers.ElapsedEventHandler(MyTimer_Elapsed);
        }

        void MyTimer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)
        {
            if (MyEventArgs != null)
                OnMyTimerElapsed(MyEventArgs);
            else
                OnMyTimerElapsed(e);
        }

        protected virtual void OnMyTimerElapsed(EventArgs ea)
        {
            if (MyTimerElapsed != null)
            {
                MyTimerElapsed(this, ea);
            }
        }

        public event EventHandler MyTimerElapsed;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-23T05:00:04.923

正如 Grzenio 指出的那样，它总是会产生相同类型的事件。

也就是说，您可以创建一个对象，将事件“反弹”给其预期的接收者......

```
public class GroupFieldArgSender
{
  public string GroupName  { get; set; }
  public int AggregateValue { get; set; }

  public void RebroadcastEventWithRequiredData(object sender, EventArgs e)
  {
    if (GroupFieldEvent != null)
    {
      GroupFieldEvent(sender, new GroupFieldEvent
        { GroupName = GroupName, AggregateValue = AggregateValue });
    }
  }

  public event EventHandler<GroupFieldEventArgs> GroupFieldEvent;
} 
```

然后将计时器滴答事件连接到 RebroadcastEventWithRequiredData 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T20:14:37.630

I am not sure what you are trying to achieve. The Timer.Tick event always returns plain EventArgs, because it is driven from within the .Net framework. Do you want to return GroupFieldArgs from the event you defined in Groupby class?

# asp.net - 使用正确的文件名将gridview导出到excel

> ID：841360
> 
> 赞同：0
> 
> 时间：2009-05-08T19:14:57.447
> 
> 标签：asp.net

我有一个代码，它将遍历每一行和每一列并将数据导出到 Excel。一切正常。当用户单击“打开”文件时，系统正在打开具有不同文件名的文件。如果我将文件名指定为“test.xls”，它将以“test[1].xls”的形式打开文件。有没有办法用相同的文件名导出？因此，我们无法使用某些 Excel 功能。

谢谢，斯里达尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T12:49:27.330

```
HttpContext.Current.Response.AddHeader ( "content-disposition",
"attachment;filename=" + pageName + "." + fileExtension );

HttpContext.Current.Response.Charset = "";
HttpContext.Current.Response.Cache.SetCacheability ( HttpCacheability.NoCache );
HttpContext.Current.Response.ContentType = "application/vnd." + fileExtension;

System.IO.StringWriter stringWrite = new System.IO.StringWriter ();
System.Web.UI.HtmlTextWriter htmlWrite =
new HtmlTextWriter ( stringWrite );
HttpContext.Current.Response.Write ( str.ToString () );
HttpContext.Current.Response.End (); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T20:04:34.190

Maybe Windows is adding the [1] when you save it because test.xls already exists or existed previously. Because of that I append the current date to my filenames like so:

```
Filename = Filename & "_" & String.Format("{0:MM-dd-yyyy}", Now) 
```

You could even add an incrementing number or add the time to the date just to make sure it's unique.

# linq - 如何使用 LINQ 在对象列表上执行函数

> ID：841361
> 
> 赞同：3
> 
> 时间：2009-05-08T19:15:07.397
> 
> 标签：linq, foreach

我想使用 LINQ 对对象列表中的所有对象执行一个函数。我知道我之前在 SO 上看到过类似的东西，但在几次搜索尝试失败后，我发布了这个问题

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-08T19:19:17.637

如果它实际上是 type ，请尝试以下操作`List<T>`。

C＃

```
var list = GetSomeList();
list.ForEach( x => SomeMethod(x) );
' Alternatively
list.ForEach(SomeMethod); 
```

VB.Net

```
Dim list = GetSomeList();
list.ForEach( Function(x) SomeMethod(x) ); 
```

不幸的是 .ForEach 只被定义，`List<T>`所以它不能用于任何通用`IEnumerable<T>`类型。虽然编写这样一个函数很容易

C＃

```
public static void ForEach<T>(this IEnumerable<T> source, Action<T> del) {
  foreach ( var cur in source ) {
    del(cur);
  }
} 
```

VB.Net

```
<Extension()> _
Public Sub ForEach(Of T)(source As IEnumerable(Of T), ByVal del As Action(Of T)
  For Each cur in source
    del(cur)
  Next
End Sub 
```

有了这个，您可以在任何 .ForEach 上运行，`IEnumerable<T>`这使得它几乎可以从任何 LINQ 查询中使用。

```
var query = from it in whatever where it.SomeProperty > 42;
query.ForEach(x => Log(x)); 
```

**编辑**

注意为 VB.Net 使用 .ForEach。您必须选择一个返回值的函数。这是 VB.Net 9 (VS 2009) 中 lambda 表达式的限制。但是有解决办法。假设你想调用一个 Sub 的 SomeMethod。只需创建一个返回空值的包装器

```
Sub SomeMethod(x As String) 
  ... 
End Sub

Function SomeMethodWrapper(x As String)
  SomeMethod(x)
  Return Nothing
End Function

list.ForEach(Function(x) SomeMethod(x)) ' Won't compile
list.ForEach(function(x) SomeMethodWrapper(x)) ' Works 
```

# c# - DateTime 可空异常作为参数

> ID：841366
> 
> 赞同：0
> 
> 时间：2009-05-08T19:15:49.020
> 
> 标签：c#, vb.net, winforms, parameters, null

我有一个搜索表单，可以按几个不同的字段进行搜索。问题字段是birthDate。在表单上它是一个字符串。在 SQL 2005 db 中，它是一个可以为空的 DateTime。

就在表单上声明变量然后设置它而言，下面的代码是连续的。然后调用 BLL，然后调用 DAL。

在这一行 -->

```
dgvSearchResults.DataSource =ConnectBLL.BLL.Person.Search(_firstName,_middleName,_lastName,_sSN, (DateTime)_birthDate,_applicationID,_applicationPersonID,_fuzzy); 
```

我收到*“可空对象必须具有值”*错误。

我假设是因为我没有提供 Date 参数，然后尝试将其转换为不可为空的 DateTime。正确的？

我能做些什么呢？必须有办法解决它。这完全相同的 BLL 和 DAL 在网络应用程序版本上工作。

## 编辑 1

有几点需要注意。我的印象`DateTime?`是和正确的一样`Nullable<DateTime>`？

另外，我看不到如何为 BirthDate 之类的字段输入任意值。我想我可以在我的业务层中构建一堆过滤器，但这似乎是“Hack”的方式。也许不吧。此外，同样的 BLL 和 DAL 与同一个 DB 允许在该程序的 WebApp 版本的 BirthDate 字段中为空值，这让我感到困扰。有什么想法吗？对于那些没有日期的条目，数据库中有*null 。*

***搜索.cs***

```
public DateTime? _birthDate;
_birthDate = null;
if (datBirthDate.Text != string.Empty)
    _birthDate = Convert.ToDateTime(datBirthDate.Text);
dgvSearchResults.DataSource=ConnectBLL.BLL.Person.Search(_firstName,_middleName,_lastName,_sSN, (DateTime)_birthDate,_applicationID,_applicationPersonID,_fuzzy); 
```

***ConnectBLL --> Person.vb***

```
Public Shared Function Search(ByVal firstName As String, ByVal middleName As String, ByVal lastName As String, ByVal SSN As String, ByVal birthDate As Date, ByVal applicationId As Integer, ByVal applicationPersonId As String, ByVal fuzzy As Boolean) As Data.DataTable
Try
    Dim tbl As Data.DataTable = DAL.Connect.SearchPerson(firstName, middleName, lastName, SSN, birthDate, applicationId, applicationPersonId, fuzzy)

    If tbl.Rows.Count > 0 Then
        tbl.DefaultView.Sort = "Last Name ASC, First Name ASC, Middle Name ASC"
    End If
    Return tbl
Catch
    Throw
End Try 
```

结束功能

***ConnectDAL --> Connect.vb***

```
Public Shared Function SearchPerson(ByVal _FirstName As String, ByVal _MiddleName As String, ByVal _LastName As String, ByVal _SSN As String, ByVal _BirthDate As Date, ByVal _ApplicationID As Integer, ByVal _ApplicationPersonID As String, ByVal _Fuzzy As Boolean) As Data.DataTable
Dim test As New clsSqlResponseTime
Dim dt As New Data.DataTable
Try
    Using cnn As New SqlClient.SqlConnection(ConnectROConnectionString)
        Dim cmd As New SqlClient.SqlCommand()
        cmd.Connection = cnn
        If _Fuzzy Then
            cmd.CommandText = strSearchPersonFuzzyStoredProcedure
        Else
            cmd.CommandText = strSearchPersonStoredProcedure
        End If
        cmd.CommandType = CommandType.StoredProcedure
        If Not IsNothing(_FirstName) Then cmd.Parameters.Add(New SqlClient.SqlParameter("@FirstName", _FirstName))
        If Not IsNothing(_MiddleName) Then cmd.Parameters.Add(New SqlClient.SqlParameter("@MiddleName", _MiddleName))
        If Not IsNothing(_LastName) Then cmd.Parameters.Add(New SqlClient.SqlParameter("@LastName", _LastName))
        If Not IsNothing(_SSN) Then cmd.Parameters.Add(New SqlClient.SqlParameter("@SSN", _SSN))
        If Not (_BirthDate = Date.MinValue) Then cmd.Parameters.Add(New SqlClient.SqlParameter("@BirthDate", _BirthDate))
        If Not IsNothing(_ApplicationPersonID) Then cmd.Parameters.Add(New SqlClient.SqlParameter("@ApplicationID", _ApplicationID))
        If Not IsNothing(_ApplicationPersonID) Then cmd.Parameters.Add(New SqlClient.SqlParameter("@ApplicationPersonID", _ApplicationPersonID))

        Dim da As New SqlClient.SqlDataAdapter(cmd)
        da.Fill(dt)
    End Using
Catch
    Throw
End Try
test.Log("SearchPerson", "Connect")
Return dt 
```

结束功能

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T19:54:46.633

你可以这样做：

```
dgvSearchResults.DataSource=ConnectBLL.BLL.Person.Search(_firstName,_middleName,_lastName,_sSN, _birthDate.HasValue ? _birthDate.Value : new DateTime() ,_applicationID,_applicationPersonID,_fuzzy); 
```

基本上，如果它为空，只需将其默认为 DateTime 的默认值（我相信它是 1/1/0001）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T19:55:37.020

您看起来正试图在此行的 Search.cs 中将可能的 Null 值强制转换为 DateTime。

dgvSearchResults.DataSource=ConnectBLL.BLL.Person.Search(_firstName,_middleName,_lastName,_sSN, (DateTime)_birthDate,_applicationID,_applicationPersonID,_fuzzy);

那会导致这个错误。如果字符串为空，您会将 null 强制转换为 DateTime，这会爆炸。我建议您的 Person.Search 方法将 Nullable<DateTime> 作为参数并在那里处理 null 情况或将其设置为 DateTime.MinValue 并在 Person.Search 中将其视为 null。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T01:28:28.810

在我看来，在第三个函数之前，您根本没有使用birthDate 值，它被添加到Parameters 集合中。在第三个函数中，它在添加之前已经针对 Date.MinValue 进行了测试。只需将第一个函数更改为：

```
public DateTime _birthDate;
if (string.IsNullOrEmpty(datBirthDate.Text))
    _birthDate = DateTime.MinValue;
else
    _birthDate = Convert.ToDateTime(datBirthDate.Text);
dgvSearchResults.DataSource=ConnectBLL.BLL.Person.Search(_firstName,_middleName,_lastName,_sSN,_birthDate,_applicationID,_applicationPersonID,_fuzzy); 
```

这是最简单的出路，但不一定是最正确的。我将更改所有三个函数以使用 Nullable DateTime，如下所示：

功能一

```
public DateTime? _birthDate = null;
if (!string.IsNullOrEmpty(datBirthDate.Text))
    _birthDate = Convert.ToDateTime(datBirthDate.Text);
dgvSearchResults.DataSource=ConnectBLL.BLL.Person.Search(_firstName,_middleName,_lastName,_sSN,_birthDate,_applicationID,_applicationPersonID,_fuzzy); 
```

函数 2 和 3 的定义应如下所示：

```
Public Shared Function Search(ByVal firstName As String, ByVal middleName As String, ByVal lastName As String, ByVal SSN As String, ByVal birthDate As Nullable(Of Date), ByVal applicationId As Integer, ByVal applicationPersonId As String, ByVal fuzzy As Boolean) As Data.DataTable

Public Shared Function SearchPerson(ByVal _FirstName As String, ByVal _MiddleName As String, ByVal _LastName As String, ByVal _SSN As String, ByVal _BirthDate As Nullable(Of Date), ByVal _ApplicationID As Integer, ByVal _ApplicationPersonID As String, ByVal _Fuzzy As Boolean) As Data.DataTable 
```

函数 3 中使用birthDate 的行：

```
If (_BirthDate.HasValue) Then cmd.Parameters.Add(New SqlClient.SqlParameter("@BirthDate", _BirthDate.Value)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T20:05:51.973

与其将 _birthDate 设置为 null，不如将其设置为某个 DateTime 值？这样它就不能为 null 传递给 BLL 调用。DateTime.MinValue 或 DateTime.Now 都可以工作。

# mysql - 如何在紧急情况下创建mysql数据库的镜像以用于切换目的？

> ID：841368
> 
> 赞同：5
> 
> 时间：2009-05-08T19:16:23.730
> 
> 标签：mysql, database, backup

我在一台服务器上有大约 400 GB 的 Live mysql 数据库，我喜欢为这个数据库创建一个镜像。在服务器中，我有从 1 GB 到 100 GB 的数据库。我可以使用哪些最佳实践？我的目的是我应该能够在紧急情况下切换。它应该有所有实时数据。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T19:22:59.907

这取决于紧急情况...

对于实时数据，[复制](http://dev.mysql.com/doc/refman/5.0/en/replication.html)是要走的路，但意外`DROP`将直接复制...

此外，您是否希望在建筑灾难中幸存下来，或者只是服务器/驱动器/硬件崩溃？

# windows - 在哪里可以找到 wscript 钩子？

> ID：841371
> 
> 赞同：0
> 
> 时间：2009-05-08T19:17:14.787
> 
> 标签：windows, scripting, wsh

我需要自动化 IM 客户端每隔几个小时更新一次状态，基本上是登录、更新状态、注销。我正在尝试使用 Windows 脚本来执行此操作，但似乎无法为应用程序找到正确的挂钩名称。我是否可以在某个特定的地方查找有关应用程序的此类信息，或者我只是使用错误的工具来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T19:39:23.267

您要自动化哪个 IM 客户端？

许多流行的 IM 服务现在都有自己的官方 API，您可以使用它们以编程方式与其服务交互，而不必“挂钩”到客户端。第三方库也相当广泛可用（Google 左右）。

我最近使用[AIM API](http://dev.aol.com)编写了几个相当漂亮的实用程序。AOL 为多种流行平台提供 SDK，包括 C、Java 和 C#。

# asp.net - Unable to start debugging on the Web Server. Visual Studio 2008

> ID：841376
> 
> 赞同：0
> 
> 时间：2009-05-08T19:18:15.860
> 
> 标签：asp.net, visual-studio-2008, debugging

I am running visual studio 2008 on vista business 64-bit. I am getting the following exception when I try to debug against IIS.

"Unable to start debugging on the web server. The object identifier does not represent a valid object".

IIS and Visual Studio are on the same box.

I've tried adding Windows Authentication but no luck (my app requires forms authentication, fyi).

Any thoughts? I have a binding on the Web Site. The IIS app is a Web SIte not a virtual directly.

Thanks!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-25T15:58:36.890

您已在 IIS 中打开 Windows 身份验证

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T07:21:32.527

转到 IIS 右键单击​​您的项目转到 Asp.Net 选项卡，将版本更改为您正在使用的当前版本。

当您使用较高版本并决定切换到较低版本时会出现此问题，反之亦然更改为您的版本可能会解决问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T19:26:06.887

Is your pc and the webserver on the same Windows domain? If not, or there is a DMZ between your pc and the web server you could experience problems unless you've explicitly setup trust between the machines.

# javascript - Using a regex to determine domain using JavaScript

> ID：841382
> 
> 赞同：1
> 
> 时间：2009-05-08T19:21:04.140
> 
> 标签：javascript, regex

If, as here at work, we have test, staging and production environments, such as:

[http://test.my-happy-work.com](http://test.my-happy-work.com)

[http://staging.my-happy-work.com](http://staging.my-happy-work.com)

[http://www.my-happy-work.com](http://www.my-happy-work.com)

I am writing some javascript that will redirect the browser to a url such as:

[http://[environment].my-happy-work.com/my-happy-video](http://[environment].my-happy-work.com/my-happy-video)

I need to be able to determine the current environment that we are in.

There is the possibility that I will currently be at a url such as:

[http://[environment].my-happy-work.com/my-happy-path/my-happy-resource](http://[environment].my-happy-work.com/my-happy-path/my-happy-resource)

I want to be able to grab the window.location but strip it of everything but:

[http://[environment].my-happy-work.com](http://[environment].my-happy-work.com)

And then append to that string + "/" + "my-happy-video".

I am not skilled with regex, but I suppose there would be a way to parse the window.location up to the ".com"

Thoughts? Thanks!

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-08T19:23:45.693

Why don't you just use `window.location.hostname`? That only contains the domain.

You can combine that with `window.location.protocol` to generate what you need:

```
var domain = window.location.protocol + "//" + window.location.hostname; 
```

[More on window.location](https://developer.mozilla.org/en/window.location).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T14:50:56.887

这个表达式应该可以解决问题：

```
^https?://([a-z0-9]+)\.([a-z0-9\-]+)\.[a-z]+ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T19:38:03.897

可能另一种选择是在每个环境中部署单独的代码。不是完全独立的代码，但可能在生产时将变量设置为“PRODUCTION”，或者在暂存模式下将变量设置为“STAGING”。

这将您的应用程序应运行的模式与域名分离。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-25T07:57:41.410

我想向您指出： [捕获给定 url 的根域的好的正则表达式是什么？](https://stackoverflow.com/questions/1910235/whats-a-good-regular-expression-to-capture-the-root-domain-of-a-given-url/1910347#1910347)

# sql - 什么是 MySQL 索引表？

> ID：841383
> 
> 赞同：1
> 
> 时间：2009-05-08T19:21:04.263
> 
> 标签：sql, mysql, indexing, query-optimization

我需要加快查询速度。我要找的是索引表吗？如果是这样，我该怎么做？我必须在每次插入时更新它吗？

以下是表模式：

```
--table1--   |   --tableA--   |    --table2--
id           |   id           |    id
attrib1      |   t1id         |    attrib1
attrib2      |   t2id         |    attrib2
             |   attrib1      | 
```

和查询：

```
SELECT 
  table1.attrib1, 
  table1.attrib2,
  tableA.attrib1 
FROM 
  table1,
  tableA
WHERE 
  table1.id = tableA.t1id
  AND (tableA.t2id = x or ... or tableA.t2id = z)
GROUP BY 
  table1.id 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T19:31:51.710

您需要在以下位置创建复合索引`tableA`：

```
CREATE INDEX ix_tablea_t1id_t2id ON table_A (t1id, t2id) 
```

中的索引`MySQL`被认为是表的一部分：它们会自动更新，并在优化器决定使用它们时自动使用。

`MySQL`不使用术语`index table`。

该术语用于`Oracle`指其他数据库所称`CLUSTERED INDEX`的：一种表，其中记录本身根据列（或一组列）的值排列。

在`MySQL`：

*   使用`MyISAM`存储时，索引将创建为具有`.MYI`扩展名的单独文件。

    该文件的内容表示一个`B-Tree`，每个叶子包含索引键和指向`.MYD`包含数据的文件中的偏移量的指针。

    指针的大小由名为 的服务器设置决定`myisam_data_pointer_size`，它可以从`2`到`7`字节变化，默认为`6`since `MySQL 5.0.6`。

    这允许创建`MyISAM`最多`2 ^ (8 * 6) bytes`=`256 TB`

*   在`InnoDB`中，所有的表都是按 固有顺序排列的`PRIMARY KEY`，它不支持堆组织的表。

    因此，每个索引实际上只是一个`InnoDB`由单个记录组成的普通表`PRIMARY KEY`：`N+M`记录`N`是索引值，`M`记录是`PRIMARY KEY`保存索引数据的主表记录的一个。

# windows - VB6 程序在 Windows Me 中不起作用

> ID：841387
> 
> 赞同：1
> 
> 时间：2009-05-08T19:22:52.310
> 
> 标签：windows, vb6

我用VB6编写了一个程序。当我编译它并将它发送给我的朋友时，他说它不起作用。他（和我一样）有 Windows Me。

为什么我的程序在那里不起作用？他应该安装什么东西还是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T19:25:13.427

您的朋友将需要 VB6 运行时文件来运行任何 VB6 程序。您可以在[Microsoft 的网站](http://www.microsoft.com/downloads/details.aspx?FamilyID=bf9a24f9-b5c5-48f4-8edd-cdf2d29a79d5&displaylang=en)上找到它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T19:25:24.533

您应该能够生成安装程序项目。VB6 运行时有许多依赖项 ( [http://www.microsoft.com/downloads/details.aspx?FamilyID=bf9a24f9-b5c5-48f4-8edd-cdf2d29a79d5](http://www.microsoft.com/downloads/details.aspx?FamilyID=bf9a24f9-b5c5-48f4-8edd-cdf2d29a79d5) )

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T19:25:34.067

他应该安装使用 Visual Basic 6.0 创建的所有应用程序运行所需的 Microsoft Visual Basic 运行时文件。

您可以从[Microsoft 的下载中心](http://download.microsoft.com/download/vb60pro/install/6/win98me/en-us/vbrun60.exe)获得它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T19:28:35.417

他可能需要[VB 运行时](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=7b9ba261-7a9c-43e7-9117-f673077ffb3c)。但是您应该考虑为您的项目创建一个合适的 msi 安装程序包。MS 提供了一个免费的，可以与 VB6 一起使用，称为[Visual Studio Installer 1.1](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=5fbbc453-cd04-4562-a66e-5c21436e6f56)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T19:27:27.790

没有太多信息可以继续，如果您有更多信息，那将很有帮助。我只是猜测，但是，您朋友的计算机可能没有安装[VB6 运行时](http://www.microsoft.com/downloads/details.aspx?FamilyID=bf9a24f9-b5c5-48f4-8edd-cdf2d29a79d5&displaylang=en)。如果他愿意，他应该尝试安装它，看看是否能解决问题。

# oracle - How do I determine the maximum and minimum value for an Oracle NUMBER column?

> ID：841388
> 
> 赞同：3
> 
> 时间：2009-05-08T19:22:57.003
> 
> 标签：oracle, numbers, max, minimum

Is there a simple formula for determining the maximum and minimum values for an Oracle NUMBER column with (p, s)?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T19:34:34.917

I'm not sure, it is something like:

from - 10 ** (p - s) to 10 ** (p - s)

p is number of significant decimal digits, and s is number of digits after period. So

NUMBER(6, 2)

can store values from -9999.99 to +9999.99.

# .net - Visual studio debugging shortcut

> ID：841390
> 
> 赞同：1
> 
> 时间：2009-05-08T19:23:08.860
> 
> 标签：.net, visual-studio-2008, debugging

What key do I use to step into a method in VS2008 debug mode?

If I have a method call like this:

```
string s = StepIntoThisMethod(DoNotStepIntoThisOne(i), NotIntoThisEither(j)); 
```

If I use F11, I step into the methods in the argument list. I would like to step into `StepIntoThisMethod` method

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T19:27:14.513

Well, that's a little tricky I think...

in your example I do: F11, shift-F11 (does first arg in 2 keystrokes), F11, shift-F11 (second arg), then F11

not pretty but works.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T19:32:13.753

In my Visual Studio 2008 that shortcut is called StepIntoSpecific and is bound to Shift+Alt+F11.

Pay also attention to the [link1](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=357436) and [link2 (chapter 3)](http://blogesh.wordpress.com/2008/09/09/visual-studio-debugging-tips-and-tricks/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T19:27:28.647

There is no way to do this in the VS.Net debugger. By that I mean there is no key sequence to achieve "step into only this method".

If you want to always avoid DoNetStepIntoThisOne you can add the DebuggerStepThroughAttribute onto the method. Then unless you actually set a break point in the method, VS will not step into the method.

```
[DebuggerStepThrough]
public void DoNotStepIntoThisOne(...) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T19:27:58.380

Hit Shift+F11 to jump back out of the argument methods. You'll have to do it twice to get out of NotIntoThisEither, but the third F11 should get you into StepIntoThisMethod.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T19:28:34.650

Use the [DebuggerStepThroughAttribute](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggerstepthroughattribute.aspx) on both methods.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T19:30:42.320

There's no key combination or command to pull this off.

You can jump in and out until you reach the method, but that's a huge hassle.

I usually just right-click, go to definition, insert a breakpoint on the function declaration, and run.

# javascript - 以 display:none 启动时，Virtual Earth 地图不显示

> ID：841395
> 
> 赞同：0
> 
> 时间：2009-05-08T19:24:18.873
> 
> 标签：javascript, jquery, css, dom, virtual-earth

我有这段代码可以使用 Virtual Earth API 显示地图：

```
<script type="text/javascript">
    function GetMap() {
        var map = map = new VEMap('myMap');
        map.LoadMap(new VELatLong(47.6, -122.33), 10, 'h', false);
    }

    $(document).ready(function () {
        GetMap();
    });
</script>

<a href="#" onclick="$('#myMap').toggle();">Show Map</a>
<div id="myMap" style="position:relative; width:400px; height:400px; display:none;"></div> 
```

这不起作用，并在地图应该去的地方显示一个黑框。如果我删除`display: none;`样式，那么它工作得很好。但我不希望地图在页面加载时可见，我希望用户切换它。有人能看出我的方法有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T20:15:20.450

也许地图需要在初始化时显示出来。如果地图必须测量容器的尺寸才能正确渲染，就会发生这种情况。

要么按照 Diodes 的建议将地图移出可视区域（您也可以将可见性设置为 false），或者在实际必须显示地图时初始化地图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T19:42:03.247

或者，您可以将其移出屏幕，使用`left:-2000px`.

# c# - 在 C#/.NET 中强制 CRLF 的快速方法是什么？

> ID：841396
> 
> 赞同：55
> 
> 时间：2009-05-08T19:24:22.710
> 
> 标签：c#, .net, string, newline

您如何将字符串中的所有换行序列标准化为一种类型？

为了电子邮件（MIME 文档）的目的，我希望将它们全部设为 CRLF。理想情况下，这将被包装在一个静态方法中，执行速度非常快，并且不使用正则表达式（因为换行符、回车符等的差异是有限的）。也许我甚至忽略了一种 BCL 方法？

假设：在考虑了这一点之后，我认为说 CR 要么是独立的，要么是 CRLF 序列的一部分，这是一个安全的假设。也就是说，如果您看到 CRLF，那么您就知道可以删除所有 CR。否则很难判断应该从“\r\n\n\r”之类的内容中产生多少行。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-05-08T19:32:53.173

```
input.Replace("\r\n", "\n").Replace("\r", "\n").Replace("\n", "\r\n") 
```

如果输入仅包含一种类型的换行符 - CR、LF 或 CR+LF，这将起作用。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-05-08T19:38:04.987

这取决于*具体*的要求。特别是，您想如何自己处理“\r”？这应该算作换行符吗？例如，应该如何处理“a\n\rb”？那是一个非常奇怪的换行符，一个“\n”换行符，然后是一个流氓“\r”，还是两个单独的换行符？如果“\r”和“\n”都可以单独作为换行符，为什么“\r\n”不应该被视为两个换行符？

这是一些我怀疑*相当*有效的代码。

```
using System;
using System.Text;

class LineBreaks
{    
    static void Main()
    {
        Test("a\nb");
        Test("a\nb\r\nc");
        Test("a\r\nb\r\nc");
        Test("a\rb\nc");
        Test("a\r");
        Test("a\n");
        Test("a\r\n");
    }

    static void Test(string input)
    {
        string normalized = NormalizeLineBreaks(input);
        string debug = normalized.Replace("\r", "\\r")
                                 .Replace("\n", "\\n");
        Console.WriteLine(debug);
    }

    static string NormalizeLineBreaks(string input)
    {
        // Allow 10% as a rough guess of how much the string may grow.
        // If we're wrong we'll either waste space or have extra copies -
        // it will still work
        StringBuilder builder = new StringBuilder((int) (input.Length * 1.1));

        bool lastWasCR = false;

        foreach (char c in input)
        {
            if (lastWasCR)
            {
                lastWasCR = false;
                if (c == '\n')
                {
                    continue; // Already written \r\n
                }
            }
            switch (c)
            {
                case '\r':
                    builder.Append("\r\n");
                    lastWasCR = true;
                    break;
                case '\n':
                    builder.Append("\r\n");
                    break;
                default:
                    builder.Append(c);
                    break;
            }
        }
        return builder.ToString();
    }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-05-20T15:53:13.800

简单变体：

```
Regex.Replace(input, @"\r\n|\r|\n", "\r\n") 
```

为了获得更好的性能：

```
static Regex newline_pattern = new Regex(@"\r\n|\r|\n", RegexOptions.Compiled);
[...]
    newline_pattern.Replace(input, "\r\n"); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-08T19:28:13.700

```
string nonNormalized = "\r\n\n\r";

string normalized = nonNormalized.Replace("\r", "\n").Replace("\n", "\r\n"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-11-17T11:17:35.560

我的意思是，这是一种快速的方法。

它不使用昂贵的正则表达式函数。它也不使用多个替换函数，每个替换函数都通过多次检查、分配等对数据进行循环。

所以搜索直接在一个`for`循环中完成。对于必须增加结果数组容量的次数，`Array.Copy`函数内也使用了循环。这就是所有的循环。在某些情况下，更大的页面大小可能更有效。

```
public static string NormalizeNewLine(this string val)
{
    if (string.IsNullOrEmpty(val))
        return val;

    const int page = 6;
    int a = page;
    int j = 0;
    int len = val.Length;
    char[] res = new char[len];

    for (int i = 0; i < len; i++)
    {
        char ch = val[i];

        if (ch == '\r')
        {
            int ni = i + 1;
            if (ni < len && val[ni] == '\n')
            {
                res[j++] = '\r';
                res[j++] = '\n';
                i++;
            }
            else
            {
                if (a == page) // Ensure capacity
                {
                    char[] nres = new char[res.Length + page];
                    Array.Copy(res, 0, nres, 0, res.Length);
                    res = nres;
                    a = 0;
                }

                res[j++] = '\r';
                res[j++] = '\n';
                a++;
            }
        }
        else if (ch == '\n')
        {
            int ni = i + 1;
            if (ni < len && val[ni] == '\r')
            {
                res[j++] = '\r';
                res[j++] = '\n';
                i++;
            }
            else
            {
                if (a == page) // Ensure capacity
                {
                    char[] nres = new char[res.Length + page];
                    Array.Copy(res, 0, nres, 0, res.Length);
                    res = nres;
                    a = 0;
                }

                res[j++] = '\r';
                res[j++] = '\n';
                a++;
            }
        }
        else
        {
            res[j++] = ch;
        }
    }

    return new string(res, 0, j);
} 
```

我现在 '\n\r' 实际上并没有在基本平台上使用。但是谁会连续使用两种换行符来表示两个换行符呢？

如果你想知道，那么你需要先看看 \n 和 \r 是否在同一个文档中分别使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-07-10T14:13:57.270

环境.新线；

包含“\r\n”的字符串用于非 Unix 平台，或包含“\n”的字符串用于 Unix 平台。

# jquery - jquery selection of elements with no visible children

> ID：841401
> 
> 赞同：8
> 
> 时间：2009-05-08T19:25:25.907
> 
> 标签：jquery, css-selectors, children, visible

Here's my goal: do something on an element, an `<optgrooup>`, if all of its children are invisible.

My code below outlines the in red if it has *any* invisible children. But I want to do so only if *all* the children are invisible. If the element has any children that are visible, then don't highlight it.

How can I tweak the jQuery selector to do that?

Thanks in advance.

```
<select multiple="multiple" name="availableInstanceId" id="availableInstanceId">
<optgroup label="Option Group 1">
   <option >visible item 1</option>
   <option >visible item 2</option>
</optgroup>
<optgroup label="Option Group 2 - Should be highlighted">
   <option style="display:none;">invisible A</option>
   <option style="display: none">invisible B</option>
</optgroup>

<optgroup label="Option Group 3 - Should not be highlighted">
  <option >visible C</option>
  <option style="display: none">invisible D</option>
</optgroup></select>

<script type="text/javascript">
var filterOptions = function(e) {
  // Goal: highlight the <optgroup>'s that have *only* invisible children
  $( '#availableInstanceId > * > *:hidden').parent().css("border","3px solid red");
} 
$(document).ready(function() {
  filterOptions();
});
</script> 
```

Screenshot of image here: [http://img144.imageshack.us/img144/556/selectexample.gif](http://img144.imageshack.us/img144/556/selectexample.gif)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-08T19:39:51.643

假设您要排除没有子元素的元素：

```
 $(":has(*):not(:has(:visible))") 
```

[工作示例。](http://jsbin.com/alepi)

**更新：**这比我原来的答案有更好的性能：

```
$(":hidden").parent().not( $(":visible").parent() ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T20:07:22.123

This has much better performance than my [original answer](https://stackoverflow.com/questions/841401/jquery-selection-of-elements-with-no-visible-children/841460#841460):

```
$(":hidden").parent().not( $(":visible").parent() ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T19:39:21.380

两条线怎么做？一个为每个元素打开它，一个为每个有可见孩子的元素再次关闭它？

```
$('#availableInstanceId > *').css("border","3px solid red");
$('#availableInstanceId > * > *:visible').parent().css("border","none"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T22:31:22.887

归功于[Jed Schmidt](https://stackoverflow.com/questions/841401/jquery-selection-of-elements-with-no-visible-children/841460#841460)。以下代码适用于 IE8。

请注意，尽管有样式，IE8 实际上并没有隐藏`<option>`元素。`display: none`IE8 似乎也不接受元素的`border`样式`<optgroup>`。

工作示例： http: [//jsbin.com/aquya](http://jsbin.com/aquya)（可通过[http://jsbin.com/aquya/edit](http://jsbin.com/aquya/edit)编辑）

```
$(document).ready(function() {
  // Prevent CSS inherits
  $("option").css('backgroundColor', 'white')

  $("option")
    .filter(function(){
      return this.style.display == 'none';
    })
    .parent()
    .not($('option').filter(function(){
      return this.style.display != 'none';
    }).parent())
    .css('backgroundColor', 'blue')
    .css('border', '1px solid red'); //this doesn't work in IE8
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-21T16:04:50.100

// 根据需要回答更改 css 的问题

```
 if($.browser.msie || $.browser.safari){

        $('optgroup:not(:has(:hidden))').css("border","3px solid red");

    } else {

        $('optgroup:not(:has(:visible))').css("border","3px solid red");

    } 
```

// 删除空的 optgroups 示例

```
 if($.browser.msie || $.browser.safari){

        $('optgroup:not(:has(:hidden))').remove();

    } else {

        $('optgroup:not(:has(:visible))').remove();

    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T19:32:25.890

You'll need to compare an array of all the :visible vs. :hidden

here is some pseudo code

```
if ($("#element:hidden").length == $("#element:visible").length) {
  // Do  stuff
} ... 
```

# asp.net - Use Site Map for Two Levels of Horizontal Navigation

> ID：841417
> 
> 赞同：2
> 
> 时间：2009-05-08T19:30:43.833
> 
> 标签：asp.net, css, menu, sitemap

How do I use the ASP.NET sitemap control to render stacked horizontal css menus with styled UL/LIs? It seems to only want to do trees or flyouts.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T22:53:33.580

设置一个 SiteMapDataSource 并将其指向您配置的 SiteMap Provider。然后将转发器（或其他）绑定到数据源。使用中继器发射您的 UL/LI 结构。

如果您需要 2 个级别（例如嵌套选项卡，其中第二级选项卡是顶部选定选项卡的子级），那么您将需要 2 个 SiteMapDataSource 并将第二个的起始节点设置为第一个的选定节点。

这都是几年前我做这件事的记忆——所以它可能不是 100% 准确的。

如果您在尝试后遇到特定问题，请发布，如果需要，我会制定更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T23:56:32.930

我用谷歌搜索并找到了这个线程：

[http://blogs.sqlxml.org/bryantlikes/archive/2006/02/17/4839.aspx](http://blogs.sqlxml.org/bryantlikes/archive/2006/02/17/4839.aspx)

看来你必须建立自己的控制。我希望它能让你朝着正确的方向前进。

# asp.net-mvc - 是否可以在 MVC 和 webforms 之间共享母版页？

> ID：841418
> 
> 赞同：32
> 
> 时间：2009-05-08T19:31:02.507
> 
> 标签：asp.net-mvc, webforms, master-pages, dry, legacy

我正在将 MVC 添加到具有许多旧版 Web 表单页面的项目中。这工作正常。但是，我目前有一个单独的 MVC 和 web 表单的母版页。两个母版页产生基本相同的输出。我真的很想杀死网络表单，只使用 MVC 母版页和我的所有页面并保持干燥。

当我忘记改变两者时，不干燥已经咬了我几次。

我尝试采用明显的方式，并将 Web 表单内容页面的 MasterPage 属性指向 MVC 母版页。这会引发一个错误，指出 MVC 主控仅适用于 MVC 视图。

这似乎是混合 MVC 和 webform 项目的一个非常常见的问题。我的 MVC 大师没有对 ViewData 做任何事情，所以我看不出 webforms 不能使用它们的任何原因。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-08T19:33:41.143

您绝对可以共享同一个母版页。您的 MVC 母版页必须通过其 MasterPageFile 属性简单地指向 WebForms 母版页。这会将您的 WebForms MasterPage 样式应用于您的 MVC MasterPage。

我在生产中使用这个设置。

我的 MVC 母版页上的声明，指向 Web 表单母版页：

```
<%@ Master Language="C#" MasterPageFile="~/MasterPage/Site.Master"
AutoEventWireup="true" Inherits="System.Web.Mvc.ViewMasterPage" %> 
```

奇迹般有效。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-05-11T21:08:26.117

这篇[博](http://weblogs.asp.net/rajbk/Contents/Item/Display/107)文将引导您完成共享 WebForm 和 MVC 母版页的必要步骤，而很少或没有重复。它还包括一个可以下载的示例项目，我发现它很有帮助。

我遇到的一个问题是我在标题中使用了 LoginStatus 控件。LoginStatus 必须在表单内，因此我无法在我的根母版页中使用它（不想在我的所有 MVC 页面上出现嵌套表单）。但这是一个非常容易控制的控件，可以在我的根母版页中用一个简单的代码块替换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T19:40:56.463

在我的 webforms 应用程序中，我的母版页继承自“HLPUSD.SMART.SMARTMaster”，它只是我们应用程序的命名空间，然后是 webform 类的名称。

在我的 MVC 项目中，母版页继承自“System.Web.Mvc.ViewMasterPage”

我觉得这有关系吗？

# python - wxPython: Drawing inside a ScrolledPanel

> ID：841425
> 
> 赞同：1
> 
> 时间：2009-05-08T19:33:04.750
> 
> 标签：python, wxpython, scroll

I'm using a PaintDC to draw inside a ScrolledPanel. However, when I run the program, the scroll bars have no effect. They're the right size, but the picture doesn't move when you scroll with them.

I figured I may have to convert from logical to device coordinates. I tried `x=dc.LogicalToDeviceX(x)` and `y=dc.LogicalToDeviceY(y)`, but there was no effect.

Any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T19:40:40.333

知道了：

```
(new_x,new_y)=self.CalcScrolledPosition((old_x,old_y)) 
```

滚动面板在哪里`self`。

# java - Copying bulk documents (pdf files) from server to client machine with one click?

> ID：841429
> 
> 赞同：0
> 
> 时间：2009-05-08T19:33:49.240
> 
> 标签：java, jakarta-ee

1.  User selects the number of files (could be in 100s or 100s)
2.  User clicks on the Download link.
3.  User is presented a popup to provide the path on the client machine where the files are to be copied.
4.  After providing the path, user clicks on Save button on the popup.
5.  All the files would be copied from the server to the specified path on the client machine.

What could be the best way to achieve this with a J2EE based framework?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T19:36:32.247

[`java.util.zip`](http://java.sun.com/javase/6/docs/api/java/util/zip/package-summary.html) has classes that can assist you in creating a ZIP archive of the files.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T21:19:37.957

我从来没有真正这样做过，但有时会考虑一下：

**使用 MIME 的多部分内容类型功能。**

一个快速的谷歌[在一个 http 请求中下载多个文件中](http://www.motobit.com/tips/detpg_multiple-files-one-request/)找到了详细说明，尽管它是在 ASP/VBS 中。

# c - GCC __attribute__((aligned(x))) 是否对齐了堆栈变量？

> ID：841433
> 
> 赞同：88
> 
> 时间：2009-05-08T19:34:54.777
> 
> 标签：c, gcc, memory-alignment, callstack

我有以下代码：

```
#include <stdio.h>

int
main(void)
{
        float a[4] __attribute__((aligned(0x1000))) = {1.0, 2.0, 3.0, 4.0};
        printf("%p %p %p %p\n", &a[0], &a[1], &a[2], &a[3]);
} 
```

我有以下输出：

```
0x7fffbfcd2da0 0x7fffbfcd2da4 0x7fffbfcd2da8 0x7fffbfcd2dac 
```

为什么地址`a[0]`不是的倍数`0x1000`？

究竟是`__attribute__((aligned(x)))`做什么的？我误解[了这个](http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Variable-Attributes.html#Variable-Attributes)解释？

我正在使用 gcc 4.1.2。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-05-08T19:41:05.947

我认为问题在于您的数组在堆栈上，并且您的编译器太旧而无法支持过度对齐的堆栈变量。GCC 4.6 及更高版本[修复了该错误](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=16660)。

C11/C++11**`alignas(64) float a[4];`**仅适用于任何 2 的幂对齐。
您使用的 GNU C`__attribute__((aligned(x)))`也是如此。

（在 C11 中，`#include <stdalign.h>`对于`#define alignas _Alignas`: [cppref](https://en.cppreference.com/w/c/language/_Alignas)）。

* * *

但是在您的对齐非常大的情况下，到 4k 页面边界，您可能不希望它在堆栈上。

因为当函数启动时堆栈指针可以是任何东西，所以如果不分配比您需要的更多并对其进行调整，就无法对齐数组。（编译器将`and rsp, -4096`或等效且不使用分配的 0 到 4088 字节中的任何一个；根据该空间是否足够大进行分支是可能的，但由于巨大的对齐比数组或其他局部变量的大小大得多而无法完成不是正常情况。）

如果将数组移出函数并移入全局变量，它应该可以工作。您可以做的另一件事是将其保留为局部变量（这是一件非常好的事情），但将其`static`. 这将防止它被存储在堆栈中。请注意，这两种方式都不是线程安全或递归安全的，因为数组只有一个副本。

使用此代码：

```
#include <stdio.h>

float a[4] __attribute__((aligned(0x1000))) = {1.0, 2.0, 3.0, 4.0};

int
main(void)
{
        printf("%p %p %p %p\n", &a[0], &a[1], &a[2], &a[3]);
} 
```

我明白了：

```
0x804c000 0x804c004 0x804c008 0x804c00c 
```

这是预期的。使用您的原始代码，我只是像您一样获得随机值。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-10-15T22:17:45.073

gcc 中有一个错误导致对齐的**属性**不适用于堆栈变量。它似乎已通过下面链接的补丁修复。下面的链接也包含对该问题的相当多的讨论。

[http://gcc.gnu.org/bugzilla/show_bug.cgi?id=16660](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=16660)

我已经用两个不同版本的 gcc 尝试了上面的代码：来自 RedHat 5.7 盒子的 4.1.2，它与您的问题类似地失败了（本地数组在 0x1000 字节边界上没有对齐）。然后我在 RedHat 6.3 上使用 gcc 4.4.6 尝试了您的代码，它完美地工作（本地数组已对齐）。Myth TV 的人也有类似的问题（上面的 gcc 补丁似乎已修复）：

[http://code.mythtv.org/trac/ticket/6535](http://code.mythtv.org/trac/ticket/6535)

无论如何，看起来您在 gcc 中发现了一个错误，该错误似乎在以后的版本中得到了修复。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-05-04T02:36:16.740

最近的 GCC（用 4.5.2-8ubuntu4 测试）似乎可以按预期工作，阵列正确对齐。

```
#include <stdio.h>

int main(void)
{
    float a[4] = { 1.0, 2.0, 3.0, 4.0 };
    float b[4] __attribute__((aligned(0x1000))) = { 1.0, 2.0, 3.0, 4.0 };
    float c[4] __attribute__((aligned(0x10000))) = { 1.0, 2.0, 3.0, 4.0 };

    printf("%p %p %p %p\n", &a[0], &a[1], &a[2], &a[3]);
    printf("%p %p %p %p\n", &b[0], &b[1], &b[2], &b[3]);
    printf("%p %p %p %p\n", &c[0], &c[1], &c[2], &c[3]);
} 
```

我得到：

```
0x7ffffffefff0 0x7ffffffefff4 0x7ffffffefff8 0x7ffffffefffc
0x7ffffffef000 0x7ffffffef004 0x7ffffffef008 0x7ffffffef00c
0x7ffffffe0000 0x7ffffffe0004 0x7ffffffe0008 0x7ffffffe000c 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-11-12T17:05:38.220

对齐并非对所有类型都有效。您应该考虑使用结构来查看正在运行的属性：

```
#include <stdio.h>

struct my_float {
        float number;
}  __attribute__((aligned(0x1000)));

struct my_float a[4] = { {1.0}, {2.0}, {3.0}, {4.0} };

int
main(void)
{
        printf("%p %p %p %p\n", &a[0], &a[1], &a[2], &a[3]);
} 
```

然后，您将阅读：

```
0x603000 0x604000 0x605000 0x606000 
```

这是你所期待的。

*编辑：* 由@yzap 推动并遵循@Caleb Case 评论，最初的问题是由于 GCC version **only**造成的。我使用请求者的源代码检查了 GCC 3.4.6 与 GCC 4.4.1：

```
$ ./test_orig-3.4.6
0x7fffe217d200 0x7fffe217d204 0x7fffe217d208 0x7fffe217d20c
$ ./test_orig-4.4.1
0x7fff81db9000 0x7fff81db9004 0x7fff81db9008 0x7fff81db900c 
```

现在很明显，较旧的 GCC 版本（4.4.1 之前的某个地方）显示出对齐问题。

注 1：我提出的代码没有回答我理解为“对齐数组的每个字段”的问题。

注意 2：在 main() 中引入非静态 a[] 并使用 GCC 3.4.6 进行编译会破坏结构数组的对齐指令，但结构之间的距离保持 0x1000 ......仍然很糟糕！（有关解决方法，请参阅@zifre 答案）

# c++ - How do you manually insert options into boost.Program_options?

> ID：841434
> 
> 赞同：13
> 
> 时间：2009-05-08T19:35:15.227
> 
> 标签：c++, configuration, boost-program-options

I have an application that uses Boost.Program_options to store and manage its configuration options. We are currently moving away from configuration files and using database loaded configuration instead. I've written an API that reads configuration options from the database by hostname and instance name. (cool!) However, as far as I can see there is no way to manually insert these options into the boost Program_options. Has anyone used this before, any ideas? The docs from boost seem to indicate the only way to get stuff in that map is by the store function, which either reads from the command line or config file (not what I want). Basically looking for a way to manually insert the DB read values in to the map.

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-04-22T11:11:14.577

我的回答来得太晚了，但我花了一些时间尝试做类似的事情并找到了一个令人讨厌的明显解决方案（以防其他人正在寻找这个）......

回想一下`boost::program_options::variables_map`，`std::map<std::string, boost::program_options::variable_value>`您可以进行完全合法的 STL 映射处理，包括插入...

```
命名空间 po = boost::program_options;
po::variables_map 虚拟机；
vm.insert(std::make_pair("MyNewEmptyOption", po::variable_value());
vm.insert(std::make_pair("MyNewIntOption", po::variable_value(32, false));
po::notify(vm);

```

-埃德蒙-

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T13:41:08.530

你看过`extra_parser`或的`allow_unregistered`功能`Boost::Program_Options`吗？根据您的程序的确切运行方式，它们中的一个或两个应该能够支持您想要的。

# c# - Does ADO.NET TableAdapters cache stored procedure names in a super secret location

> ID：841435
> 
> 赞同：0
> 
> 时间：2009-05-08T19:35:53.917
> 
> 标签：c#, sql, visual-studio-2008, ado.net, tableadapter

I'm guessing Visual Studio is bugging out on me. I changed the stored procedure the a TableAdapter query uses and now the users keep getting the following error.

**Procedure or function 'usp_GetEventNotificationSubscribers' expects parameter '@FacilityCode', which was not supplied.**

Nowhere in the application is 'usp_GetEventNotificationSubscribers' written.

I can't reproduce the error on my local machine. When I run it locally or step through it in debug mode everything works fine. It even works for me in production. But I keep getting them auto-emailed to me whenever it happens, which is about 3 a day.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T14:08:55.017

少数用户仍在使用该站点的测试版本。我拒绝访问测试虚拟目录中的每个人，并且错误停止了。

谢谢诺尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T19:44:50.557

proc 是否被数据库中的另一个 proc 引用？如果是这样，您将无法在应用程序源代码中找到该字符串。

尝试这个：

SELECT * FROM SYS.Comments WHERE text LIKE '%GetEventNotificationSubscribers%'

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T08:27:10.193

生产现场的存储过程是否不同（例如使用不同的参数）？可能是在您正在使用不同过程的开发环境中本地更新/更改了 proc。此错误似乎表明生产站点的 sqlserver db 中的 proc 参数比开发数据库中的参数多。

# svn - 查询 svn 修订版突然看起来很慢（可能是因为 svn 1.5？）

> ID：841439
> 
> 赞同：3
> 
> 时间：2009-05-08T19:36:39.437
> 
> 标签：svn, tortoisesvn

在将我们的存储库升级到 Subversion 1.5 后不久，我的团队转而编写了几个月的新应用程序，然后突然返回到我们原来的代码库。我们的开发人员在我们的服务器上使用 TortoiseSVN 1.5.9 和 Subversion Client 1.6（仅用于`svnversion -n`）和 Subversion 1.5。我们的客户通过 svn+ssh 连接。

我们的原始代码库将 SVN 版本号集成到代码中`svnversion -n`，用于查询 WC 的当前版本。然而，突然之间，这个操作已经到了我记得需要短短一两秒到长达 10 秒的时间（而且我在 VM 开发环境中看到更糟糕的情况，等等）。我们也经历过类似的延迟，回去和试验使用 Tortoise 的 SubWCRev 和 Subversion Client 1.5。

这不是一个大问题，但它肯定是一个烦恼，因为这个检查是在每次构建操作之前作为预编译步骤进行的。因此，我希望在我们的反馈循环中消除那几秒钟！

所以，我的问题是：我只是离开我的旧代码库太久了，还是有其他人注意到这个操作有延迟？

如果这种延迟是一种新现象，有没有人解决它。如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T08:49:52.447

我同意约翰·韦尔登的观点。如果您使用的是 Apache (http(s))，则可能会减慢 svn log 命令的速度。这发生在更改/添加了很多文件路径的提交上。一种解决方案是删除基于路径的授权或删除特定的修订。[在此处](http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.serverconfig.httpd.authz.pathauthzoff)查看更多详细信息：

> 所有这些路径检查有时会非常昂贵，尤其是在 svn log 的情况下。在检索修订列表时，服务器会查看每个修订中的每个更改路径并检查其可读性。**[...]不用说，这对于影响大量文件的修订**可能很耗时。这就是安全的代价：即使您根本没有配置诸如 mod_authz_svn 之类的模块，mod_dav_svn 模块仍然要求 Apache httpd 在每个路径上运行授权检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T04:27:17.943

在强烈推荐的[red-bean svn book](http://svnbook.red-bean.com/en/1.4/svn-book.html#svn.reposadmin.basics.backends.tbl-1)中，他们指出大型提交（一次提交中有许多文件）会极大地影响性能。您最近是否签入了大量文件，例如最近 100 次签入？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-11T21:33:09.683

我刚刚在我的服务器上解决了这样的问题。你用什么进行身份验证？签出、提交或日志操作是一系列的几个 HTTP 请求。在日志显示的情况下，它是数百个。如果您在那里有一个身份验证层，它将在每个请求上进行身份验证。如果你反对一个缓慢的后端，这会减慢你的速度。就我而言，我们是针对我们的 IMAP 服务器（自定义 mod_auth_imap）进行身份验证的。一旦我将缓存添加到身份验证层（将哈希用户/密码对保持 60 秒左右），它就大大加快了速度：结帐过去需要 1.5 分钟，现在需要 3 秒。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-19T23:45:10.347

在（正确配置的）zsh 中，您可以在 svn 根文件夹中尝试此操作：

```
sed -ns "4 p" **/.svn/entries | sort | uniq 
```

It will give the revision of your latest update, or the list of revisions if your repository is mixed. It is not as complete as what is doing "svnversion", and it may not be compliant with all svn versions (mine is 1.6.16) but it does the job in some cases and it is incredibly fast (1s vs 3mn in my case!)

# objective-c - What sort function is used in NSArray?

> ID：841445
> 
> 赞同：1
> 
> 时间：2009-05-08T19:37:26.750
> 
> 标签：objective-c, iphone, cocoa-touch, sorting

This is really a three-part question, but I've answered the first question myself:

I'm working on the iPhone, with many objects (up to 200) on the screen. Each object needs to look if it's overlapping other objects, and act accordingly. My original naive implementation was for each object to run through the list of each other object to check their bounding boxes (using `CGRectInsersectsRect`).

So my question (and answer) is what's a better method? My new implementation is to sort the array every frame using an insertion sort (since the data will be mostly sorted already) on the y-position of each object, then check only the nearest object on either side of the one searching, to see if it's in range vertically, then check horizontally.

First question: Is insertion sort the method I want to use for an array of objects that tend to move around randomly but only to a small extent so they mostly stay in order based on the last frame? Also: what sort algorithm does the NSArray use when I call

```
- sortedArrayUsingSelector: 
```

I would sort of assume that it uses a quick sort, since it's the most useful in the general case. Does anybody know if I'm wrong? Does anybody know if I can change the sort method or if I will have to write my own sorting function?

Second question: is there a function for retrieving items from a sorted array using a binary search, rather than the naive approach that I assume is used by

```
- indexOfObject: 
```

or would I have to write my own?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T20:27:45.180

NSArray uses many different data structures internally depending on how many objects are in the array. See a [Peter Ammon blog entry](http://ridiculousfish.com/blog/archives/2005/12/23/array/) for more information. But basically this means you can't expect a certain kind of sort to happen. Sometimes it is worth it to write your own array implementation using C arrays so you can control the sorts yourself.

There are definitely much faster ways to implement collision detection. Look into Bounding Volume Hierarchies like KD Trees or similar.

As far as I know indexOfObject: is the only way, but it's potentially not as dumb as you think. Everything is hashable for NSDictionary so they can use some of those smarts in NSArray.

# java - Managing cookies in Java

> ID：841446
> 
> 赞同：1
> 
> 时间：2009-05-08T19:37:40.010
> 
> 标签：java, cookies

What's the best practice to implement sign in "Remember Me" feature in Java?

Obviously, storing cookies with username and password in user's browser is not secure enough. Create authentication token in cookies and db instead? Any simple examples?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T19:42:07.020

看看[Spring Security 框架](http://static.springsource.org/spring-security/site/index.html)。您可以通过几行配置来实现此场景。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T19:48:14.277

I'll second the suggestion of using Spring Security. It comes with a couple of different implementations for managing the token stored in the cookie on the users's browser.

[http://static.springframework.org/spring-security/site/reference/html/remember-me.html](http://static.springframework.org/spring-security/site/reference/html/remember-me.html)

# sql - Delete Duplicate SQL Records

> ID：841447
> 
> 赞同：3
> 
> 时间：2009-05-08T19:37:50.540
> 
> 标签：sql, duplicates

What is the simplest way to delete records with duplicate name in a table? The answers I came across are very confusing.

### Related:

> [Removing duplicate records from table](https://stackoverflow.com/questions/529098/removing-duplicate-rows-from-table-in-oracle)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T19:40:52.843

我知道了！简单而且效果很好。

```
delete 
   t1 
from 
   tTable t1, tTable t2 
where 
   t1.locationName = t2.locationName and  
   t1.id > t2.id 
```

[http://www.cryer.co.uk/brian/sql/sql_delete_duplicates.htm](http://www.cryer.co.uk/brian/sql/sql_delete_duplicates.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T19:44:43.380

SQL Server 2005：

```
with FirstKey
AS
(
    SELECT MIN(ID), Name, COUNT(*) AS Cnt
      FROM YourTable
     GROUP BY Name
     HAVING COUNT(*) > 1
)
DELETE YourTable
  FROM YourTable YT
  JOIN FirstKey FK ON FK.Name = YT.Name AND FK.ID != YT.ID 
```

# .net - Using ELMAH in a console application

> ID：841451
> 
> 赞同：65
> 
> 时间：2009-05-08T19:38:01.803
> 
> 标签：.net, desktop-application, console-application, elmah

I just started using ELMAH and am a fan. My team supports a large number of web applications and I'm particularly excited that ELMAH lets us save exceptions from each application to the same MS SQL database table.

We also support a few console, DLL and desktop applications. Is it possible to use the ELMAH DLL to log exceptions in these apps to that same location?

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2010-03-18T21:52:50.120

We needed the ability to log from a console app and a windows service in addition to our ASP.NET site. I used the answer (`ErrorLog.GetDefault(null);`) which worked well until I needed to email too.

So, here is my solution. It handles the log, email, tweet and filtering (both in the config file and in code). I have also wrapped the main call as an extension to Exception so it can be called like: `catch(Exception ex) { ex.LogToElmah(); }`

To filter in code, hook the corresponding .Filtering event: `ElmahExtension.ErrorLog.Filtering += new ExceptionFilterEventHandler(ErrorLog_Filtering);`

Code:

```
using System;
using System.Web;
using Elmah;
namespace System
{
    public static class ElmahExtension
    {
        public static void LogToElmah(this Exception ex)
        {
            if (HttpContext.Current != null)
            {
                ErrorSignal.FromCurrentContext().Raise(ex);
            }
            else
            {
                if (httpApplication == null) InitNoContext();
                ErrorSignal.Get(httpApplication).Raise(ex);
            }
        }

            private static HttpApplication httpApplication = null;
            private static ErrorFilterConsole errorFilter = new ErrorFilterConsole();

            public static ErrorMailModule ErrorEmail = new ErrorMailModule();
            public static ErrorLogModule ErrorLog = new ErrorLogModule();
            public static ErrorTweetModule ErrorTweet = new ErrorTweetModule();

            private static void InitNoContext()
            {
                httpApplication = new HttpApplication();
                errorFilter.Init(httpApplication);

                (ErrorEmail as IHttpModule).Init(httpApplication);
                errorFilter.HookFiltering(ErrorEmail);

                (ErrorLog as IHttpModule).Init(httpApplication);
                errorFilter.HookFiltering(ErrorLog);                

                (ErrorTweet as IHttpModule).Init(httpApplication);
                errorFilter.HookFiltering(ErrorTweet);
            }

            private class ErrorFilterConsole : ErrorFilterModule
            {
                public void HookFiltering(IExceptionFiltering module)
                {
                    module.Filtering += new ExceptionFilterEventHandler(base.OnErrorModuleFiltering);
                }
            }
    }
} 
```

In addition, you will need to add a reference to the `System.Web.dll` in your project for this to work.

**EDIT**: As per the comments, this code will send emails only if your config file has `<errorMail async="false"/>`. Refer to [this code snippet](http://pastebin.com/L2xTT71K) should you want to keep `<errorMail async="true"/>` in your config file (to be used when HttpContext.Current is available).

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2009-07-01T10:26:18.823

We have exactly the same situation here. Running ELMAH for all our web applications. A few of them have console based schedulers.

After doing some digging through the source code, the following code seems to work:

```
 ErrorLog errorLog = ErrorLog.GetDefault(null);
            errorLog.ApplicationName = "/LM/W3SVC/1/ROOT/AppName";
            errorLog.Log(new Error(ex)); 
```

The only real problem with the above is that you need to keep the application name somewhere in your config to be able to see the entries on the ELMAH.axd viewer.

So in our generic error handling code we do:

```
 if (HttpContext.Current != null)
            ErrorSignal.FromCurrentContext().Raise(ex);
        else
        {
            ErrorLog errorLog = ErrorLog.GetDefault(null);
            errorLog.ApplicationName = ErrorHandling.Application;
            errorLog.Log(new Error(ex));
        } 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-06-20T05:22:21.173

If you just want to email the log without http you can do like this:

```
 public class MyElmahMail: ErrorMailModule
    {
        public MyElmahMail()
        {
//this basically just gets config from errorMail  (app.config)
            base.OnInit(new HttpApplication());
        }
        public void Log(Error error)
        {
//just send the email pls
            base.ReportError(error);
        }
    }

//to call it
var mail = new MyElmahMail();
mail.Log(new Error(new NullReferenceException()));//whatever exception u want to log 
```

And in terms of app.config

```
//Under configSections
    <sectionGroup name="elmah">
      <section name="security" requirePermission="false" type="Elmah.SecuritySectionHandler, Elmah" />
      <section name="errorLog" requirePermission="false" type="Elmah.ErrorLogSectionHandler, Elmah" />
      <section name="errorMail" requirePermission="false" type="Elmah.ErrorMailSectionHandler, Elmah" />
      <section name="errorFilter" requirePermission="false" type="Elmah.ErrorFilterSectionHandler, Elmah" />
    </sectionGroup> 
```

And

```
 <elmah>
    <errorLog type="Elmah.XmlFileErrorLog, Elmah" logPath="C:\Elmah.Error" applicationName="MyAwesomeApp" />
    <errorMail from="from@email.com" to="to@email.com" />
  </elmah> 
```

And smtp settings of your choice.

All done. :-)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-08T19:47:23.060

**Edit**: This **CAN** be done - See [this](https://stackoverflow.com/a/1068378/33226) answer.

* * *

I'm pretty sure you can't do this. I'll try and dig up the relevant material.

[http://groups.google.com/group/elmah/browse_thread/thread/f214c4f782dc2bf4/d96fe43b60765f0c?lnk=gst&q=app#d96fe43b60765f0c](http://groups.google.com/group/elmah/browse_thread/thread/f214c4f782dc2bf4/d96fe43b60765f0c?lnk=gst&q=app#d96fe43b60765f0c)

So from what I can find searching the Google group is that it's not possible... Since ELMAH works off of HttpHandlers (an asp.net construct) it is ASP.NET only.

With that said, there are ways that you could utilize it on a console application. ELMAH provides a method to raise errors, so you could wrap ELMAH in your exception handling and then signal an error via:

```
ErrorSignal.FromCurrentContext().Raise(new NotSupportedException()); 
```

This would mean wrapping your entire application in an exception handler and signaling. It might take you some tweaking to get it down, but I think it's totally possible.

In case you require it, this is the link to the [ELMAH code repository](http://code.google.com/p/elmah/source/browse/trunk/src/Elmah/).

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-08T15:01:30.627

For those that need Brian Chance's answer ported to VB.NET:

```
Imports System
Imports System.Web
Imports Elmah
Namespace System
    Public NotInheritable Class ElmahExtension
        Private Sub New()
        End Sub
        <System.Runtime.CompilerServices.Extension> _
        Public Shared Sub LogToElmah(ex As Exception)
            If HttpContext.Current IsNot Nothing Then
                ErrorSignal.FromCurrentContext().Raise(ex)
            Else
                If httpApplication Is Nothing Then
                    InitNoContext()
                End If
                ErrorSignal.[Get](httpApplication).Raise(ex)
            End If
        End Sub

        Private Shared httpApplication As HttpApplication = Nothing
        Private Shared errorFilter As New ErrorFilterConsole()

        Public Shared ErrorEmail As New ErrorMailModule()
        Public Shared ErrorLog As New ErrorLogModule()
        Public Shared ErrorTweet As New ErrorTweetModule()

        Private Shared Sub InitNoContext()
            httpApplication = New HttpApplication()
            errorFilter.Init(httpApplication)

            TryCast(ErrorEmail, IHttpModule).Init(httpApplication)
            errorFilter.HookFiltering(ErrorEmail)

            TryCast(ErrorLog, IHttpModule).Init(httpApplication)
            errorFilter.HookFiltering(ErrorLog)

            TryCast(ErrorTweet, IHttpModule).Init(httpApplication)
            errorFilter.HookFiltering(ErrorTweet)
        End Sub

    Private Class ErrorFilterConsole
        Inherits Elmah.ErrorFilterModule

        Public Sub HookFiltering([module] As Elmah.IExceptionFiltering)
            AddHandler [module].Filtering, New Elmah.ExceptionFilterEventHandler(AddressOf MyBase.OnErrorModuleFiltering)
        End Sub

    End Class

    End Class
End Namespace 
```

However, for just logging errors to the database, this will be sufficient:

```
If System.Web.HttpContext.Current Is Nothing Then
    Dim req As System.Web.HttpRequest = New System.Web.HttpRequest(String.Empty, "https://www.domain.tld", Nothing)
    Dim res As System.Web.HttpResponse = New System.Web.HttpResponse(Nothing)
    System.Web.HttpContext.Current = New System.Web.HttpContext(req, res)

    'Dim request As System.Web.Hosting.SimpleWorkerRequest = New System.Web.Hosting.SimpleWorkerRequest("/blah", "c:\inetpub\wwwroot\blah", "blah.html", Nothing, New System.IO.StringWriter())
    'System.Web.HttpContext.Current = New System.Web.HttpContext(request)

    System.Web.HttpContext.Current.ApplicationInstance = New System.Web.HttpApplication()

    Dim ErrorLog As New Elmah.ErrorLogModule()
    TryCast(ErrorLog, System.Web.IHttpModule).Init(System.Web.HttpContext.Current.ApplicationInstance)
End If 
```

As a complete solution:

```
Public parent As Elmah.ServiceProviderQueryHandler = Nothing

' http://stackoverflow.com/questions/5981750/configuring-elmah-with-sql-server-logging-with-encrypted-connection-string
Public Function Elmah_MS_SQL_Callback(objContext As Object) As System.IServiceProvider
    Dim container As New System.ComponentModel.Design.ServiceContainer(parent(objContext))
    Dim strConnectionString As String = COR.SQL.MS_SQL.GetConnectionString()

    Dim log As Elmah.SqlErrorLog = New Elmah.SqlErrorLog(strConnectionString)
    'Dim strApplicationName = System.Web.Compilation.BuildManager.GetGlobalAsaxType().BaseType.Assembly().FullName
    Dim strApplicationName As String = System.Reflection.Assembly.GetExecutingAssembly().FullName
    If Not String.IsNullOrEmpty(strApplicationName) Then
        log.ApplicationName = strApplicationName.Substring(0, strApplicationName.IndexOf(","))
    End If

    container.AddService(GetType(Elmah.ErrorLog), log)
    Return container
End Function ' Elmah_MS_SQL_Callback

Public Function Elmah_PG_SQL_Callback(objContext As Object) As System.IServiceProvider
    Dim container As New System.ComponentModel.Design.ServiceContainer(parent(objContext))
    Dim strConnectionString As String = COR.SQL.MS_SQL.GetConnectionString()

    Dim log As Elmah.PgsqlErrorLog = New Elmah.PgsqlErrorLog(strConnectionString)
    'Dim strApplicationName = System.Web.Compilation.BuildManager.GetGlobalAsaxType().BaseType.Assembly().FullName
    Dim strApplicationName As String = System.Reflection.Assembly.GetExecutingAssembly().FullName
    If Not String.IsNullOrEmpty(strApplicationName) Then
        log.ApplicationName = strApplicationName.Substring(0, strApplicationName.IndexOf(","))
    End If

    container.AddService(GetType(Elmah.ErrorLog), log)
    Return container
End Function ' Elmah_PG_SQL_Callback

' http://weblogs.asp.net/stevewellens/archive/2009/02/01/debugging-a-deployed-site.aspx
Public Sub Initialize()

    If System.Web.HttpContext.Current Is Nothing Then
        Dim req As System.Web.HttpRequest = New System.Web.HttpRequest(String.Empty, "https://www.domain.tld", Nothing)
        Dim res As System.Web.HttpResponse = New System.Web.HttpResponse(Nothing)
        System.Web.HttpContext.Current = New System.Web.HttpContext(req, res)

        'Dim request As System.Web.Hosting.SimpleWorkerRequest = New System.Web.Hosting.SimpleWorkerRequest("/blah", "c:\inetpub\wwwroot\blah", "blah.html", Nothing, New System.IO.StringWriter())
        'System.Web.HttpContext.Current = New System.Web.HttpContext(request)

        System.Web.HttpContext.Current.ApplicationInstance = New System.Web.HttpApplication()

        Dim ErrorLog As New Elmah.ErrorLogModule()
        TryCast(ErrorLog, System.Web.IHttpModule).Init(System.Web.HttpContext.Current.ApplicationInstance)
    End If

    parent = Elmah.ServiceCenter.Current

    If SQL.IsMsSql Then
        Elmah.ServiceCenter.Current = AddressOf Elmah_MS_SQL_Callback
    End If

    If SQL.IsPostGreSql Then
        Elmah.ServiceCenter.Current = AddressOf Elmah_PG_SQL_Callback
    End If
End Sub ' InitializeElmah 
```

And

```
Elmah.ErrorSignal.FromCurrentContext().Raise(New NotImplementedException("Test")) 
```

will work if it is called after Initialize()

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-23T03:19:47.473

Well, since I can't comment I'll post this down here and maybe someone will see it.

After following Brian's method and the commentors I was able to get email working but I still wasn't seeing the SQL messages being logged, even though I had set the applicationName. What I didn't realize is that they were actually being logged I just wasn't seeing them because the applicationName must be the same as your web.config in order to be able to view it.

My web.config didn't have applicationName specified, so it was defaulting to "/LM/W3SVC/2/ROOT", which is basically what "asgeo1" commented, though I didn't realize it had to be the same.

Since I didn't really have any errors I was concerned with, I configured applicationName in my web.config and my app.config to be the same and now everything shows up like a champ.

```
<errorLog type="Elmah.SqlErrorLog, Elmah" connectionStringName="ELMAH" applicationName="MyAppName" /> 
```

* * *

## 回答 #7

> 赞同：-6
> 
> 时间：2009-07-01T13:17:06.890

ELMAH stands for Error Logging Modules and Handlers - referring, of course, to `IHttpModule` and `IHttpHandler`.

Console applications do not use HTTP, so would typically not be able to benefit much from Modules and Handlers built for HTTP.

# php - PDO 无缓冲查询

> ID：841463
> 
> 赞同：14
> 
> 时间：2009-05-08T19:40:15.373
> 
> 标签：php, pdo

我正在尝试了解 PDO 的详细信息。所以我编码了这个：

```
$cn = getConnection();

// get table sequence
$comando = "call p_generate_seq('bitacora')";
$id = getValue($cn, $comando);

//$comando = 'INSERT INTO dsa_bitacora (id, estado, fch_creacion) VALUES (?, ?, ?)';
$comando = 'INSERT INTO dsa_bitacora (id, estado, fch_creacion) VALUES (:id, :estado, :fch_creacion)';
$parametros = array (
    ':id'=> (int)$id,
    ':estado'=>1,
    ':fch_creacion'=>date('Y-m-d H:i:s')
);
execWithParameters($cn, $comando, $parametros); 
```

我的 getValue 函数工作正常，我得到了表的下一个序列。但是当我进入 execWithParameters 时，我得到了这个异常：

> PDOException：SQLSTATE [HY000]：一般错误：2014 在其他无缓冲查询处于活动状态时无法执行查询。考虑使用 PDOStatement::fetchAll()。或者，如果您的代码只针对 mysql 运行，您可以通过设置 PDO::MYSQL_ATTR_USE_BUFFERED_QUERY 属性来启用查询缓冲。在第 77 行的 D:\Servidor\xampp_1_7_1\htdocs\bitacora\func_db.php

我试图修改连接属性，但它不起作用。

这些是我的核心数据库功能：

```
function getConnection() {
    try {
        $cn = new PDO("mysql:host=$host;dbname=$bd", $usuario, $clave, array(
                PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
            ));

        $cn->setAttribute(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY, true);
        return $cn;
    } catch (PDOException $e) {
        print "Error!: " . $e->getMessage() . "<br/>";
        die();
    }
}
function getValue($cn, $comando) {
    $resul = $cn->query($comando);
        if (!$resul) return null;
        while($res = $resul->fetch()) {
            $retorno = $res[0][0];
            break;
        }
        return $retorno;
}
function execWithParameters($cn, $comando, $parametros) {
    $q = $cn->prepare($comando);
    $q->execute($parametros);
    if ($q->errorInfo() != null) {
        $e = $q->errorInfo();
        echo $e[0].':'.$e[1].':'.$e[2];
    }
} 
```

谁能对此有所启发？PD。请不要建议使用自动数字 ID，因为我是从另一个系统移植的。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-08-13T02:54:44.900

问题是 mysql 在给定时间只允许一个未完成的游标。通过使用 fetch() 方法而不使用所有待处理的数据，您将打开一个游标。

推荐的方法是使用 fetchAll() 方法消耗所有数据。另一种方法是使用 closeCursor() 方法。

如果你改变这个功能，我想你会更开心：

```
<?php
function getValue($cn, $comando) {
    $resul = $cn->query($comando);
    if (!$resul) return null;
    foreach ($resul->fetchAll() as $res) {
            $retorno = $res[0];
            break;
    }
    return $retorno;
}
?> 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-05-03T03:25:59.130

如果您不执行返回数据的查询（即 UPDATE、INSERT 等），我认为 PDOStatement::closeCursor() 不会起作用。

更好的解决方案是在调用 PDOStatement::execute() 之后简单地取消设置 () PDOStatement 对象：

```
$stmt = $pdo->prepare('UPDATE users SET active = 1');
$stmt->execute();
unset($stmt); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-08T19:58:19.167

问题似乎是---我对 PDO 不太熟悉---在你的 getValue 调用返回后，查询仍然绑定到连接（你只要求第一个值，但连接返回几个，或期望这样做）。

也许 getValue 可以通过添加来修复

```
$resul->closeCursor(); 
```

在返回之前。

否则，如果对 getValue 的查询将始终返回单个（或足够少的）值，则似乎首选使用 fetchAll。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-06-30T18:00:03.923

我只花了 15 分钟在互联网上搜索，并查看了至少 5 个不同的 Stackoverflow 问题，有些人声称我的错误显然来自错误版本的 PHP、错误版本的 MySQL 库或任何其他神奇的黑盒东西......

我将所有代码更改为使用“fetchAll”，甚至在每次查询后都在查询对象上调用了 closeCursor() 和 unset()。说实话我快绝望了！我也尝试了 MYSQL_ATTR_USE_BUFFERED_QUERY 标志，但它不起作用。

**最后**，我把所有东西都扔到了窗外，查看了 PHP 错误，并跟踪了它发生的代码行。

```
SELECT AVG((original_bytes-new_bytes)/original_bytes) as saving 
    FROM (SELECT original_bytes, new_bytes FROM jobs ORDER BY id DESC LIMIT 100) AS t1 
```

无论如何，问题的发生是因为我的*original_bytes*和*new_bytes*都在 unsigned bigints 的位置，这意味着如果我曾经有一份工作，其中 new_bytes 实际上比 original_bytes 大，那么我会遇到一个令人讨厌的 MySQL“超出范围”错误。这只是在运行我的缩小服务一段时间后随机发生的。

为什么我得到这个奇怪的 MySQL 错误而不是仅仅给我一个简单的错误，这超出了我的理解！当我运行原始查询时，它实际上出现在 SQLBuddy（轻量级 PHPMyAdmin）中。我有 PDO 异常，所以它应该只是给了我 MySQL 错误。

没关系，底线是：

**如果您遇到此错误，请务必检查您的原始 MySQL 是否确实正确并且仍在工作！！！**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T08:11:59.850

我的一个朋友在 xampp 1.7.1 版本中遇到了同样的问题。在用 5.2.9-2 php.net 构建替换 xampp/php/* 并将所有必要的文件复制到 xampp/apache/bin 后，它工作正常。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-25T14:35:29.843

如果您使用的是 XAMPP 1.7.1，则只需升级到 1.7.2。

# c++ - C++ 读取文件

> ID：841464
> 
> 赞同：0
> 
> 时间：2009-05-08T19:40:19.287
> 
> 标签：c++

读取文件并将其内容分配给 c++ 中的字符串所需的最少代码是多少？我确实阅读了很多有用的教程，但它们在某种程度上都不同，所以我想看看为什么，所以如果你能包括一些解释性的评论，那就太好了。

* * *

**相关：** [在 C++ 中将整个文件读入 std::string 的最佳方法是什么？](https://stackoverflow.com/questions/116038/what-is-the-best-way-to-slurp-a-file-into-a-stdstring-in-c)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T19:51:15.283

```
#include <fstream>
#include <string>

int main()
{
    std::ifstream file("myfile.txt");  // open the file
    std::string line, whole_file;

    // Read one line at a time from 'file' and store the result
    // in the string called 'line'.
    while (std::getline(file, line))
    {
        // Append each line together so the entire file will
        // be in one string.
        whole_file += line;
        whole_file += '\n';
    }

    return 0;
    // 'file' is closed automatically when the object goes out of scope.
} 
```

这里有几点需要注意。 `getline()`返回对流对象的引用，如果发生任何不好的事情或到达文件末尾，则该对象测试失败。*此外，字符串中不*包含尾随换行符，因此您必须手动附加它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T20:04:32.957

最短代码：（不高效）

```
#include <iostream>
#include <string>
#include <algorithm>
#include <iterator>
#include <fstream>

int main()
{
    std::ifstream f("plop");

    std::string buffer;
    std::copy(std::istreambuf_iterator<char>(f),
              std::istreambuf_iterator<char>(),
              std::back_inserter(buffer));
} 
```

我可能会怎么做：

```
#include <iostream>
#include <string>    
#include <vector>
#include <algorithm>
#include <iterator>
#include <fstream>

int main()
{
    // Find the size of the file
    std::ifstream       file("Plop");
    file.seekg(0,std::ios_base::end);

    std::streampos      size    = file.tellg();

    // Read the file in one go.
    file.seekg(0);
    std::vector<char>   buffer(size); // pre-szie the vector.
    file.read(&buffer[0],size);

    // or

    // Until the next version of the standard I don't think string gurantees contigious storage.
    // But all the current versions I know do use continious storage so it should workd.
    file.seekg(0);
    std::string         buffer1(size);
    file.read(&buffer1[0],size);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T20:16:36.097

我没有看到那么多：

```
#include <fstream>
#include <sstream>
#include <string>
using namespace std;

int main() {
    ifstream ifs("filename");
    stringstream ss;
    ss << ifs.rdbuf();
    string s = ss.str();
} 
```

……正如我所料。你也需要一些错误检查。

康拉德鲁道夫给出了这个作为上面链接的“相关问题”的答案。我想这不是重复的，因为这要求最短的代码，但答案都是一样的。所以我把它作为wiki重新发布在这里。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T19:44:05.613

我正在从每一行中读取一个单词。

```
 #include<fstream>
    #include<string>
    using namespace std;    
    int main(int argc, char **argv)
    {
    fstream inFile;
    string str;
    while(!inFile.eof())
    {
    inFile.open("file.txt");
    infile>>str;
    }
    inFile.close();
    return 0;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T20:14:38.083

这比短解决方案要长，但可能会稍微高效一些，因为它复制的次数更少——不过我还没有进行任何时序比较：

```
#include <iostream>
#include <fstream>
#include <string>
#include <vector>
using namespace std;;

unsigned int FileRead( istream & is, vector <char> & buff ) {
    is.read( &buff[0], buff.size() );
    return is.gcount();
}

int main() {
    ifstream ifs( "afile.dat", ios::binary );
    const unsigned int BUFSIZE = 64 * 1024; 
    std::vector <char> buffer( BUFSIZE );
    unsigned int n;
    string s;
    while( n = FileRead( ifs, buffer ) ) {
        s.append( &buffer[0], n );
    }

    cout <<  s;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T21:40:51.290

如果您*知道*您的文件包含文本，那么您可以使用[STLSoft](http://www.stlsoft.org/)的`platformstl::memory_mapped_file`：

```
platformstl::memory_mapped_file file("your-file-name");
std::string contents(static_cast<char const*>(file.memory()), file.size()); 
```

或者

```
platformstl::memory_mapped_file file("your-file-name");
std::wstring contents(static_cast<wchar_t const*>(file.memory()), 
          file.size() / sizeof(wchar_t)); 
```

在 WINdows 上，这将使您的字符串包含`\r\n`序列，因此您可以改用以下`winstl::load_text_file()`函数：

```
std::string contents;
winstl::load_text_file("your-file-name", contents); 
```

如果要将其加载到行集合中，请使用`platformstl::read_lines()`：

```
platformstl::basic_file_lines<char> lines("your-file-name");
size_t n = lines.size();
std::string line3 = lines[3]; 
```

# c++ - wxwidgets // g++ 编译器错误：没有匹配函数调用'operator new(..'

> ID：841471
> 
> 赞同：0
> 
> 时间：2009-05-08T19:41:18.973
> 
> 标签：c++, wxwidgets

目前我正在尝试将 Visual C++ 应用程序移植到 Linux。代码在 Visual Studio 中编译没有错误，但在 Linux 下我得到很多编译器错误。这些错误之一是：

```
../src/wktools4.cpp:29: error: no matching function for
call to 'operator new(unsigned int, const char[40], int)' 
```

更多信息：

*   IDE：使用 G++ 的 kdevelop
*   图形接口：

错误出现在以下行：

```
IMPLEMENT_APP(Cwktools4App) 
```

和其他一些行。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T17:00:41.410

我发现了错误：

```
#ifdef __WXDEBUG__
#define new WXDEBUG_NEW
#endif 
```

当我删除这些行时，我不再收到错误。该代码是从 VisualStudio 的 wxwidgets 向导生成的。我不知道它有什么作用...

感谢大家的帮助！现在我必须修复链接器错误；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T21:47:10.777

看起来您的 Visual C++ 应用程序已重载`operator new()`.

通常这样做（使用您看到的其他参数）为每个内存分配添加调试和其他分析信息。

因为你得到的错误很简单，因为**`frame = new Cwktools4Frame;`**我建议寻找将“新”重新定义为其他东西的宏或编译器级定义。首先要看的地方应该是调试特定的构建。

# jsf - 从同一服务器上的单独 Web 应用程序访问托管 bean？

> ID：841474
> 
> 赞同：0
> 
> 时间：2009-05-08T19:42:06.943
> 
> 标签：jsf, servlets, javabeans

我有两个应用程序。第一个调用app1 是一个JSF 1.2 应用程序。第二个称为 app2 是一个基本的 Servlet 应用程序。是否可以从 app2 访问 app1 中的特定托管会话 bean？两者都部署在同一台服务器上。

谢谢汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T14:46:45.843

一个建议是将您的 app1 bean 转换为 EJB3 bean，然后使用“本地”接口从 app2 访问它们（因为 app1 和 app2 在同一台服务器上）

更改很少（一些注释和接口）。当然，您的应用服务器需要符合 EJB3。

# ajax - Ajax HTTP 和 HTTPS 可以并行工作吗？

> ID：841479
> 
> 赞同：2
> 
> 时间：2009-05-08T19:43:43.367
> 
> 标签：ajax, http, https

假设最初通过 HTTP 访问的单页应用程序使用 AJAX 进行所有服务器交互，是否可以使用 HTTP 进行常规数据传输，然后切换到 AJAXian HTTPS 请求以进行安全数据传输？

如果是这样，当发出 HTTPS AJAX 请求时，浏览器将如何处理证书和锁定通知？

如果这是不可能的，那么是否有任何解决方法可以在同一页面中混合 AJAX HTTP 和 AJAX HTTPS，例如为 HTTPS 加载 iFrame？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T03:59:19.620

尝试切换协议将违反[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)。

我不确定使用 iFrame 的解决方法会如何表现，但我认为浏览器可能会阻止对作为 HTTPS 加载的框架的访问，这也是由于相同的源策略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:35:03.883

我知道这是旧帖子，但由于我是通过搜索引擎到达这里的，因此值得分享我所学到的东西。

可以使用一种叫做[CORS](http://en.wikipedia.org/wiki/Cross-Origin_Resource_Sharing)的东西，但像往常一样，旧的 MSIE 在[实现它](http://caniuse.com/#search=cors)时遇到了问题。

发送额外的 HTTP 标头应该很简单：

```
Access-Control-Allow-Origin: http://example.com:8080 http://foo.example.com 
```

# mysql - MySQL 限制

> ID：841481
> 
> 赞同：5
> 
> 时间：2009-05-08T19:43:47.593
> 
> 标签：mysql, database

在使用 Sybase、Infomix、DB2 等其他数据库产品多年后使用 MySQL 5.1 Enterprise 时；我遇到了 MySQL 不做的事情。例如，它只能为 SELECT 查询生成一个 EXPLAIN 查询计划。

我还应该注意哪些其他事项？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T19:49:43.337

You may take a look at long list here: [MySQL Gotchas](http://sql-info.de/mysql/gotchas.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T19:45:59.803

全外连接。但是你仍然可以做一个左外连接联合右外连接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T05:02:31.620

我在项目后期遇到的一件事是 MySQL 日期类型不能存储毫秒。日期时间和时间戳只能解析为秒！我不记得出现这种情况的确切情况，但我最终需要在我的代码中存储一个可以转换为日期（以毫秒为单位）的 int。

MySQL 的 JDBC 驱动程序默认缓存结果，以至于它会导致您的程序耗尽内存（抛出 OutOfMemory 异常）。您可以将其关闭，但您必须在创建它时将一些不寻常的参数传递给语句：

```
Statement sx = c.createStatement(java.sql.ResultSet.TYPE_FORWARD_ONLY,java.sql.ResultSet.CONCUR_READ_ONLY);
sx.setFetchSize(Integer.MIN_VALUE); 
```

如果这样做，JDBC 驱动程序不会在内存中缓存结果，并且您可以执行大量查询**但是**如果您使用的是 ORM 系统怎么办？您不自己创建语句，因此您不能关闭缓存。这基本上意味着如果你的 ORM 系统试图做一些涉及大量记录的事情，那么你就完全搞砸了。

如果他们有某种意义，他们会通过 JDBC URL 进行配置。那好吧。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T20:05:18.493

Allow for Roles or Groups

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T04:39:56.683

不用花大价钱。尝试在 oracle 数据库上的多台机器上构建一个集群网站。哎哟。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-09T04:42:17.893

它仍然不做 CHECK 约束！

# asp.net - 尝试将 XML 从 Sharepoint Web 服务调用加载到 ASP.NET Gridview 时出错

> ID：841491
> 
> 赞同：0
> 
> 时间：2009-05-08T19:46:43.377
> 
> 标签：asp.net, xml, gridview, xpath, sharepoint-api

我收到错误：

> 路径中的非法字符。

当尝试使用 XPath 将 XML 加载到我正在构建的 ASP.NET 页面的代码隐藏中的 PageLoad 函数中的 gridview 数据源中时。有谁知道这个错误是什么意思？

来自 Sharepoint Web 服务调用的 XML 是：

```
<?xml version='1.0' encoding='ISO-8859-1'?>
<listitems xmlns:s="uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882" xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" xmlns:rs="urn:schemas-microsoft-com:rowset" xmlns:z="#RowsetSchema" xmlns="http://schemas.microsoft.com/sharepoint/soap/"> 
<rs:data ItemCount="2"> 
    <z:row ows_Attachments="0" ows_LinkTitle="testTitle" ows_IncidentID="0" .../> 
    <z:row ows_Attachments="0" ows_LinkTitle="test2" ows_IncidentID="1" ... /> 
</rs:data> 
```

而我背后的代码是：

```
newNode = thisL.GetListItems(strID, viewName, query, viewFields, rowLimit, queryOptions, webID)

    mNodeList = newNode.ChildNodes
    Dim ds_me As New Data.DataSet

    xdsIncidents.Data = "<?xml version='1.0' encoding='utf-8'?>" & newNode.OuterXml
    xdsIncidents.XPath = "//z:row"
    GridView1.AutoGenerateColumns = True
    DataDiv.InnerText = xdsIncidents.Data

    ds_me.ReadXml(xdsIncidents.Data)
    Dim dv As New Data.DataView(ds_me.Tables(1))

    GridView1.DataSource = dv
    GridView1.DataBind() 
```

错误消息出现在“ds_me.ReadXML ...”行上

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T21:38:07.680

这是因为 ReadXml 的重载需要一个文件路径来读取一些 xml，而不是其中包含 xml 的字符串。

如果要以这种方式加载 DataSet，则需要从字符串创建 XmlReader 或 TextReader。

# ruby-on-rails - 有没有一个很好的用于 Rails 的缓存记忆插件？

> ID：841493
> 
> 赞同：2
> 
> 时间：2009-05-08T19:47:54.840
> 
> 标签：ruby-on-rails, ruby, memcached, memoization

我有一个模型：

```
class Account < ActiveRecord::Base

  has_many :payments
  has_many :purchases

  def balance
    payments.sum(:dollar_amount) - purchases.map{|p| p.dollar_amount}.sum
  end

end 
```

我想记住 balance 方法并将其存储在 memcached 中。当然，问题是缓存值需要在任何时候创建付款或购买时过期。我可以在付款和购买的 after_save 回调中插入代码，以使他们帐户的缓存余额过期，但在我看来，如果我可以这样说的话，会更容易理解/维护：

```
cached_memoize :balance, :depends_on => [:payments, :purchases] 
```

是否有现有的 gem/插件可以做到这一点？在我开始自己写之前，这是个好主意吗？我看到的缺点是，对于正在修改 Purchase 的 Dollar_amount 方法的人来说，他们需要考虑缓存问题可能不太明显（如果他们无意中引入了对另一个模型的依赖，比如 SubPurchase 或其他东西，它会搞砸的。）但是由于这无论如何都不是很明显，我认为拥有一个简洁的声明性语法是值得的 - 至少在它中断时，很清楚如何修复它。

想法？

编辑：为了响应语义艺术的回答，我将更明确地说明“只需将过期时间放在相关回调中”方法的问题 - 问题是你最终会在整个代码库中过期 - 它从 after_save 回调开始付款，但也许它在购买的单独观察者中，然后你有多态关联、继承树等。我提出的语法迫使开发人员将所有这些案例放在一个整齐的列表中。这样，当您收到诸如“用户余额有时不同步并且他们不太确定如何复制问题”之类的错误报告时，更容易弄清楚发生了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T19:58:49.947

I'd consider another approach: have a balance field on the account. Use callbacks (after_save, etc.) on the Purchase and SubPurchase models to update the balance field on the parent Account. Your balance only changes when the other models are modified and you never have to worry about it being stale.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T19:23:03.203

不确定这是您正在寻找的，但它可能会有所帮助。

[http://railscasts.com/episodes/137-memoization](http://railscasts.com/episodes/137-memoization)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T20:30:24.033

sounds to me like you want to fork cache_fu, and add an option that magically sprinkles the after_saves across the dependent records. I dig having your dependencies in 1 place.

# .net - “常识”或实用 .NET 编码标准

> ID：841499
> 
> 赞同：2
> 
> 时间：2009-05-08T19:49:47.457
> 
> 标签：.net, visual-studio

我即将着手更新我们的编码标准文档，并且我正在考虑以比通常更高的水平编写它们。我们有相当数量的开发人员来来往往，他们通常具有中等技能水平。我想消除低质量的“绒毛”部分......例如，“变量命名约定”等......任何真正有价值的东西，会分散文档中真正有价值的部分（可能会因为过多的低价值内容而被略读或完全跳过）。

我也更感兴趣的是确保人们不做愚蠢的事情，而不是强迫他们以某种方式做事。

我们碰巧是一家 .Net / Oracle 商店，但对于我正在寻找的材料类型，我认为语言并不是特别重要。

我想知道是否有人以前这样做过并且有一些他们不介意分享的材料，或者遇到过类似性质的任何好的在线材料？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T20:00:55.773

根据我的经验，编码标准的实用价值与其自动测量的能力成正比。根据 FxCop 和 StyleCop 的默认规则，我们商店的部分 C# 编码标准（适合一页）说代码必须是干净的。这两种工具都可以由开发人员以及构建过程运行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T20:19:56.167

我绝对更喜欢工具选项 ReSharper，而不是标准文档。我越是专业地开发，我就越意识到编码标准文档是浪费时间，而且它们往往会消耗生产力。

代码应该是可读和可理解的。不幸的是，编码标准也不能强制执行。然而，工具至少可以强制执行命名约定并帮助发现诸如无法检查 null 或“访问修改后的闭包”等问题。

无论如何，编码标准都不应该阻止开发人员编写好的代码。我看过禁止使用三元运算符或运算符重载的文档。我还看到要求对代码进行良好注释的文档（我尽量避免注释以支持可读代码）。在我看来，这些东西都不应该在编码标准中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T19:55:57.580

MSDN 上的[类开发人员指南](http://msdn.microsoft.com/en-us/library/czefa0ke(VS.71).aspx)有很多很好的材料。很多低级的东西，比如你想消除的，它肯定更实用，但值得一看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T20:00:46.507

也许只有一节关于遵循 JP 发布的指导方针，或者该代码应该以最低分数通过 FxCop，这样就可以涵盖这些内容，并且开发人员没有理由不这样做。这将在您的标准中为特定领域的指南留出更多空间。

# php - PHP：异常与错误？

> ID：841500
> 
> 赞同：131
> 
> 时间：2009-05-08T19:50:18.967
> 
> 标签：php, exception, exception-handling, error-handling

也许我在 PHP 手册中的某个地方遗漏了它，但是错误和异常之间到底有什么区别？我能看到的唯一区别是错误和异常的处理方式不同。但是是什么导致了异常，又是什么导致了错误呢？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-05-08T19:58:14.377

[抛出异常](http://us3.php.net/throw)-它们旨在被捕获。错误通常是不可恢复的。例如，您有一段代码可以将一行插入数据库。此调用可能会失败（ID 重复） - 您将希望有一个“错误”，在这种情况下是一个“异常”。当你插入这些行时，你可以做这样的事情

```
try {
  $row->insert();
  $inserted = true;
} catch (Exception $e) {
  echo "There was an error inserting the row - ".$e->getMessage();
  $inserted = false;
}

echo "Some more stuff"; 
```

程序执行将继续 - 因为您“捕获”了异常。除非被捕获，否则异常将被视为错误。它也将允许您在程序失败后继续执行程序。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2009-05-09T07:46:59.697

我通常[`set_error_handler`](//php.net/set_error_handler)使用一个接受错误并抛出异常的函数，这样无论发生什么我都会有异常要处理。不再[`@file_get_contents`](//php.net/file_get_contents)只是漂亮而整洁的尝试/捕捉。

在调试情况下，我还有一个异常处理程序，可以输出类似 asp.net 的页面。我在路上发布这个，但如果需要，我会在稍后发布示例源。

编辑：

正如承诺的那样，我已经将我的一些代码剪切并粘贴在一起以制作示例。

```
<?php

define( 'DEBUG', true );

class ErrorOrWarningException extends Exception
{
    protected $_Context = null;
    public function getContext()
    {
        return $this->_Context;
    }
    public function setContext( $value )
    {
        $this->_Context = $value;
    }

    public function __construct( $code, $message, $file, $line, $context )
    {
        parent::__construct( $message, $code );

        $this->file = $file;
        $this->line = $line;
        $this->setContext( $context );
    }
}

/**
 * Inspire to write perfect code. everything is an exception, even minor warnings.
 **/
function error_to_exception( $code, $message, $file, $line, $context )
{
    throw new ErrorOrWarningException( $code, $message, $file, $line, $context );
}
set_error_handler( 'error_to_exception' );

function global_exception_handler( $ex )
{
    ob_start();
    dump_exception( $ex );
    $dump = ob_get_clean();
    // send email of dump to administrator?...

    // if we are in debug mode we are allowed to dump exceptions to the browser.
    if ( defined( 'DEBUG' ) && DEBUG == true )
    {
        echo $dump;
    }
    else // if we are in production we give our visitor a nice message without all the details.
    {
        echo file_get_contents( 'static/errors/fatalexception.html' );
    }
    exit;
}

function dump_exception( Exception $ex )
{
    $file = $ex->getFile();
    $line = $ex->getLine();

    if ( file_exists( $file ) )
    {
        $lines = file( $file );
    }

?><html>
    <head>
        <title><?= $ex->getMessage(); ?></title>
        <style type="text/css">
            body {
                width : 800px;
                margin : auto;
            }

            ul.code {
                border : inset 1px;
            }
            ul.code li {
                white-space: pre ;
                list-style-type : none;
                font-family : monospace;
            }
            ul.code li.line {
                color : red;
            }

            table.trace {
                width : 100%;
                border-collapse : collapse;
                border : solid 1px black;
            }
            table.thead tr {
                background : rgb(240,240,240);
            }
            table.trace tr.odd {
                background : white;
            }
            table.trace tr.even {
                background : rgb(250,250,250);
            }
            table.trace td {
                padding : 2px 4px 2px 4px;
            }
        </style>
    </head>
    <body>
        <h1>Uncaught <?= get_class( $ex ); ?></h1>
        <h2><?= $ex->getMessage(); ?></h2>
        <p>
            An uncaught <?= get_class( $ex ); ?> was thrown on line <?= $line; ?> of file <?= basename( $file ); ?> that prevented further execution of this request.
        </p>
        <h2>Where it happened:</h2>
        <? if ( isset($lines) ) : ?>
        <code><?= $file; ?></code>
        <ul class="code">
            <? for( $i = $line - 3; $i < $line + 3; $i ++ ) : ?>
                <? if ( $i > 0 && $i < count( $lines ) ) : ?>
                    <? if ( $i == $line-1 ) : ?>
                        <li class="line"><?= str_replace( "\n", "", $lines[$i] ); ?></li>
                    <? else : ?>
                        <li><?= str_replace( "\n", "", $lines[$i] ); ?></li>
                    <? endif; ?>
                <? endif; ?>
            <? endfor; ?>
        </ul>
        <? endif; ?>

        <? if ( is_array( $ex->getTrace() ) ) : ?>
        <h2>Stack trace:</h2>
            <table class="trace">
                <thead>
                    <tr>
                        <td>File</td>
                        <td>Line</td>
                        <td>Class</td>
                        <td>Function</td>
                        <td>Arguments</td>
                    </tr>
                </thead>
                <tbody>
                <? foreach ( $ex->getTrace() as $i => $trace ) : ?>
                    <tr class="<?= $i % 2 == 0 ? 'even' : 'odd'; ?>">
                        <td><?= isset($trace[ 'file' ]) ? basename($trace[ 'file' ]) : ''; ?></td>
                        <td><?= isset($trace[ 'line' ]) ? $trace[ 'line' ] : ''; ?></td>
                        <td><?= isset($trace[ 'class' ]) ? $trace[ 'class' ] : ''; ?></td>
                        <td><?= isset($trace[ 'function' ]) ? $trace[ 'function' ] : ''; ?></td>
                        <td>
                            <? if( isset($trace[ 'args' ]) ) : ?>
                                <? foreach ( $trace[ 'args' ] as $i => $arg ) : ?>
                                    <span title="<?= var_export( $arg, true ); ?>"><?= gettype( $arg ); ?></span>
                                    <?= $i < count( $trace['args'] ) -1 ? ',' : ''; ?> 
                                <? endforeach; ?>
                            <? else : ?>
                            NULL
                            <? endif; ?>
                        </td>
                    </tr>
                <? endforeach;?>
                </tbody>
            </table>
        <? else : ?>
            <pre><?= $ex->getTraceAsString(); ?></pre>
        <? endif; ?>
    </body>
</html><? // back in php
}
set_exception_handler( 'global_exception_handler' );

class X
{
    function __construct()
    {
        trigger_error( 'Whoops!', E_USER_NOTICE );      
    }
}

$x = new X();

throw new Exception( 'Execution will never get here' );

?> 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2014-02-26T22:55:21.947

**答案值得谈论房间里的大象**

错误是在运行时处理错误情况的旧方法。`set_error_handler`通常，代码会在执行某些代码之前调用类似的东西。遵循汇编语言中断的传统。这是一些 BASIC 代码的外观。

```
on error :divide_error

print 1/0
print "this won't print"

:divide_error

if errcode = X
   print "divide by zero error" 
```

很难确保`set_error_handler`以正确的值调用它。更糟糕的是，可以调用一个单独的过程来更改错误处理程序。另外，很多时候调用都穿插着`set_error_handler`调用和处理程序。代码很容易很快失控。异常处理通过将好的代码真正在做什么的语法和语义形式化来拯救。

```
try {
   print 1/0;
   print "this won't print";
} catch (DivideByZeroException $e) {
   print "divide by zero error";
} 
```

没有单独的函数或调用错误错误处理程序的风险。现在保证代码在同一个地方。另外，我们会收到更好的错误消息。

PHP 过去只有错误处理，而许多其他语言已经演变为更可取的异常处理模型。最终，PHP 的制造者实现了异常处理。但很可能支持旧代码，它们保留了错误处理并提供了一种使错误处理看起来像异常处理的方法。除此之外，不能保证某些代码不会重置错误处理程序，而这正是异常处理旨在提供的。

**最终答案**

在实施异常处理之前编码的错误可能仍然是错误。新的错误很可能是例外。但是没有设计或逻辑哪些是错误，哪些是例外。它只是基于编码时可用的内容，以及编码它的程序员的偏好。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-09T00:12:04.563

这里要添加的一件事是关于处理异常和错误。对于应用程序开发人员而言，错误和异常都是您想要记录的“坏事”，以了解您的应用程序存在的问题 - 以便您的客户从长远来看有更好的体验。

因此，编写一个与异常处理相同的错误处理程序是有意义的。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-08-28T13:05:44.400

如其他答案所述，将错误处理程序设置为异常抛出器是处理 PHP 错误的最佳方法。我使用更简单的设置：

```
set_error_handler(function ($errno, $errstr, $errfile, $errline ) {
        if (error_reporting()) {
                throw new \ErrorException($errstr, 0, $errno, $errfile, $errline);
        }
}); 
```

请注意`error_reporting()`检查以保持`@`操作员工作。此外，不需要定义自定义异常，PHP 有一个很好的类。

抛出异常的最大好处是异常有与之关联的堆栈跟踪，因此很容易找到问题所在。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-11-17T11:43:14.617

**回复：“但是错误和异常之间到底有什么区别？”**

关于这里的差异有很多很好的答案。我将添加一些尚未讨论的内容 - 性能。具体来说，这是针对抛出/处理异常和处理返回码（成功或某些错误）之间的区别。通常，在 php 中，这意味着返回`false`或`null`，但它们可以更详细，例如文件上传： http: [//php.net/manual/en/features.file-upload.errors.php](http://php.net/manual/en/features.file-upload.errors.php)你甚至可以返回一个异常对象！

我已经用不同的语言/系统进行了一些性能运行。一般来说，异常处理比检查错误返回码慢大约 10,000 倍。

所以，如果它绝对，肯定需要在它开始之前完成执行——好吧，你不走运，因为时间旅行不存在。如果没有时间旅行，返回码是最快的选择。

**编辑：**

PHP 针对异常处理进行了高度优化。实际测试表明，抛出异常仅比返回值慢 2-10 倍。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-08-14T23:35:52.767

我认为您正在寻找的答案是；

错误是您习惯的标准内容，例如回显一个不存在的 $variable。
异常仅从 PHP 5 开始，并且在处理对象时出现。

为了简单起见：

异常是您在处理对象时遇到的错误。try/catch 语句可以让你对它们做一些事情，并且使用起来很像 if/else 语句。尝试这样做，如果有问题，没关系，就这样做。

如果您没有“捕获”异常，那么它就会变成标准错误。

错误是通常会停止脚本的 php 基本错误。

Try/catch 通常用于建立数据库连接，如 PDO，如果您想重定向脚本或在连接不起作用时执行其他操作，这很好。但是，如果您只想显示错误消息并停止脚本，那么您不需要它，未捕获的异常会变成致命错误。或者，您也可以使用站点范围的错误处理设置。

希望有帮助

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-05-30T07:36:00.243

来自[PHP：例外 - 手册](https://www.php.net/manual/en/language.exceptions.php#:%7E:text=As%20of%20PHP%207.1.0,%20a%20catch%20block)：

> 从 PHP 7.1.0 开始，catch 块可以使用竖线 (|) 字符指定多个异常。当来自不同类层次结构的不同异常被相同处理时，这很有用。

```
try {
  // do something
} catch (Error | Exception $e) {
  echo $e->getMessage();
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-08T19:52:23.347

异常是由代码使用 throw 故意抛出的，错误......不是那么多。

错误是由于通常未处理的某些事情而产生的。（IO 错误、TCP/IP 错误、空引用错误）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-02-17T06:55:22.487

我打算给你一个关于错误控制的最不寻常的讨论。

几年前，我在一种语言中构建了一个非常好的错误处理程序，虽然有些名称已经改变，但今天的错误处理原理是一样的。我有一个定制的多任务操作系统，并且必须能够从所有级别的数据错误中恢复，并且没有内存泄漏、堆栈增长或崩溃。所以接下来是我对错误和异常必须如何操作以及它们之间的区别的理解。我只想说我不了解 try catch 的内部是如何工作的，所以我在某种程度上是在猜测。

在错误处理的幕后发生的第一件事是从一个程序状态跳转到另一个程序状态。这是怎么做的？我会解决的。

从历史上看，错误更老、更简单，而异常更新、更复杂和更强大。错误可以正常工作，直到您需要将它们冒泡，这相当于将一个难题交给您的主管。

错误可以是数字，例如错误号，有时也可以是一个或多个相关字符串。例如，如果发生文件读取错误，您可能能够报告它是什么，并且可能会优雅地失败。（嘿，这比过去的崩溃更上一层楼。）

关于异常不常说的是异常是分层在特殊异常堆栈上的对象。它就像程序流的返回堆栈，但它只为错误尝试和捕获保持返回状态。（我曾经称它们为 ePush 和 ePop，而 ?Abort 是一个有条件的抛出，它将 ePop 并恢复到那个水平，而 Abort 是一个完全死亡或退出。）

堆栈的底部是有关初始调用者的信息，该对象了解外部尝试何时启动时的状态，通常是在您的程序启动时。最重要的是，或者堆栈的下一层，向上是孩子，向下是父母，是下一个内部 try/catch 块的异常对象。

如果你把一个 try 放在一个 try 里面，你就是把内部 try 堆叠在外部 try 之上。当内部 try 发生错误并且内部 catch 无法处理或者错误被抛出到外部 try 时，则将控制权传递给外部 catch 块（对象）以查看它是否可以处理错误，即你的主管。

所以这个错误栈真正做的是能够标记和恢复程序流程和系统状态，换句话说，它允许程序在出错时不会崩溃返回栈并为其他人（数据）搞砸事情。因此它还保存了任何其他资源（如内存分配池）的状态，因此它可以在捕获完成时清理它们。一般来说，这可能是一件非常复杂的事情，这就是异常处理通常很慢的原因。一般来说，相当多的状态需要进入这些异常块。

因此，如果所有其他事情都搞砸了，try/catch 块会设置一个能够返回的状态。这就像一个父母。当我们的生活一团糟时，我们可以重新回到父母的怀抱中，他们会再次好起来的。

希望我没有让你失望。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-04-26T17:47:34.977

一旦定义了 set_error_handler()，错误处理程序就类似于异常处理程序。请参见下面的代码：

```
 <?php
 function handleErrors( $e_code ) {
   echo "error code: " . $e_code . "<br>";
 }

 set_error_handler( "handleErrors" ); 

 trigger_error( "trigger a fatal error", E_USER_ERROR);
 echo "after error."; //it would run if set_error_handler is defined, otherwise, it wouldn't show
?> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-10-24T10:56:31.070

您可以添加此评论

```
function doSomething()
{
   /** @noinspection PhpUnhandledExceptionInspection */
   throw new Exception();
} 
```

# sql-server - 如何授予 SqlServer 2005 系统存储过程的权限（例如 sp_start_job）

> ID：841504
> 
> 赞同：2
> 
> 时间：2009-05-08T19:51:35.033
> 
> 标签：sql-server, sql-server-2005, ssis

我希望能够从 Web 应用程序随意调用 SSIS 包。我发现在本地机器上运行时可以使用 sp_start_job 成功完成此操作。但是，当我发布到我们的测试站点时，我得到：

```
The EXECUTE permission was denied on the object 'sp_start_job', database 'msdb', schema dbo' 
```

所以我尝试了这个

```
USE msdb

CREATE USER [TheUser] FOR LOGIN [TheLogin]
GO

GRANT EXECUTE ON sp_start_job TO [TheUser]
GO 
```

但是，运行此之后，我仍然收到权限被拒绝错误。您是否需要做一些特别的事情来授予系统存储过程的权限？

编辑：不知道它是否有区别，但是 Webserver 在 DMZ 中，所以我使用 sql server 身份验证在 webserver 和 db server 之间进行通信。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T20:07:17.087

来自[MSDN](http://msdn.microsoft.com/en-us/library/ms186757.aspx)：

> 默认情况下，sysadmin 固定服务器角色的成员可以执行此存储过程。其他用户必须在 msdb 数据库中被授予以下 SQL Server 代理固定数据库角色之一：
> 
> ```
> * SQLAgentUserRole
> * SQLAgentReaderRole
> * SQLAgentOperatorRole 
> ```

# iphone - 什么时候发布 NSXMLParser？

> ID：841507
> 
> 赞同：1
> 
> 时间：2009-05-08T19:52:26.187
> 
> 标签：iphone, nsxmlparser

我正在使用这样的 NSXMLParser ：

```
 - (BOOL)parseXMLData:(NSData *)inData
{
 provisioningParser = [[NSXMLParser alloc] initWithData: inData]; // defined if .h

 [provisioningParser setDelegate:self];
 [provisioningParser setShouldProcessNamespaces:NO];
 [provisioningParser setShouldReportNamespacePrefixes:NO];
 [provisioningParser setShouldResolveExternalEntities:NO];

return [provisioningParser parse];
} 
```

我的问题是我应该什么时候发布 NSXMLParser？我相信它会在解析完成时自动释放；这是真的？如果是，仪器表明存在泄漏。

你有想法吗 ？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T19:58:03.550

既然你分配了它，你就需要释放它。调用 parse 后释放它：

```
BOOL rval = [provisioningParser parse];
[provisioningParser release];
return rval; 
```

此外，从您的代码的外观来看，您可能会将其保存在成员变量中。有这样做的理由吗？如果没有，请将其设为局部变量。如果是这样，您可能希望在类的 dealloc() 方法中释放它，而不是在调用 parse() 之后。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T20:20:09.253

正确的做法是在`dealloc`方法中释放它，因为它是一个实例变量。但是您的代码在这种情况下是错误的。想象一下连续调用`parseXMLData:`两次。provisioningParser 将第二次被覆盖，因此无法在您的`dealloc`.

如果您希望它是本地的，请将其声明为本地，并以

```
return [[provisioningParser autorelease] parse]; 
```

您可以使用 NXSMLParser 'parserWithData:' 分配它，而不必执行任何操作（但仍应将其移动到方法的本地）。

# sqlite - 将集合绑定为“where col in？”的右侧 条款

> ID：841508
> 
> 赞同：1
> 
> 时间：2009-05-08T19:52:37.043
> 
> 标签：sqlite

在 Oracle OCI 中，我可以准备如下语句：

```
select * from t where pk in :1 
```

并为 :1 占位符绑定一个 VArray 集合。

除非我使用以下解决方法之一，否则我看不到任何方法可以在 SQLite 中执行等效操作：

*   准备

    从 t 中选择 *，其中 pk=:1

    而是使用我集合中的所有 pk 执行此 N 次，并手动对来自 N 个查询的行进行“联合”

*   将我的 pk 集合放在一个临时表中，并在其上使用 t 进行连接。

*   将 :1 文本替换为集合值，否定准备好的语句的好处。

我错过了什么吗？模拟 OCI 的集合绑定的推荐方法是什么？谢谢，--DD

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T15:33:31.753

唉，`sqlite`只支持绑定到标量，所以你是对的，你不能将参数绑定到集合。如果收集器中的项目数是有界的，您可以使用 ' [[假设最多四个项目]] 准备一个语句，`IN (?, ?, ?, ?)'`然后绑定数组中的实际标量（如果小于 4，则重复绑定最后一个，或绑定您知道作为占位符“不可能”的值）；否则，您所描绘的方法确实或多或少都是想到的。

# asp.net - 如何增加存储过程调用的超时时间（请参阅错误）？

> ID：841509
> 
> 赞同：10
> 
> 时间：2009-05-08T19:53:02.533
> 
> 标签：asp.net, sql-server

```
 Timeout expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.Data.SqlClient.SqlException: Timeout expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.

Source Error:

Line 91: 
Line 92:             DataSet getData;
Line 93:             getData = SqlHelper.ExecuteDataset(ConfigurationManager.ConnectionStrings["connstr"].ConnectionString, CommandType.StoredProcedure, "Course_NewReportGet_Get_Sav", objPara);
Line 94: 
Line 95:             foreach (DataRow dr in getData.Tables[0].Rows)

Source File: c:\Users\Ryan\bancroft archive\santiago\santiago code\trunk\admin\tools\Optimus.aspx.cs    Line: 93

Stack Trace:

[SqlException (0x80131904): Timeout expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.]
   System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection) +1950890
   System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) +4846875
   System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj) +194
   System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) +2392
   System.Data.SqlClient.SqlDataReader.ConsumeMetaData() +33
   System.Data.SqlClient.SqlDataReader.get_MetaData() +83
   System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString) +297
   System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async) +954
   System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result) +162
   System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method) +32
   System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method) +141
   System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior) +12
   System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior) +10
   System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior) +130
   System.Data.Common.DbDataAdapter.Fill(DataSet dataSet, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior) +287
   System.Data.Common.DbDataAdapter.Fill(DataSet dataSet) +94
   Mexico.Data.SqlHelper.ExecuteDataset(SqlConnection connection, CommandType commandType, String commandText, SqlParameter[] commandParameters) +149
   Mexico.Data.SqlHelper.ExecuteDataset(String connectionString, CommandType commandType, String commandText, SqlParameter[] commandParameters) +93
   admin_tools_Optimus.GetUsers() in c:\Users\Ryan\bancroft archive\santiago\santiago code\trunk\admin\tools\Optimus.aspx.cs:93
   admin_tools_Optimus.GetCompanies() in c:\Users\Ryan\bancroft archive\santiago\santiago code\trunk\admin\tools\Optimus.aspx.cs:75
   admin_tools_Optimus.Proceed(Object sender, EventArgs e) in c:\Users\Ryan\bancroft archive\santiago\santiago code\trunk\admin\tools\Optimus.aspx.cs:43
   System.Web.UI.WebControls.Button.OnClick(EventArgs e) +111
   System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +110
   System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +10
   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13
   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +36
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1565 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-08T20:01:38.393

[您可以通过设置SqlCommand.CommandTimeout](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.commandtimeout.aspx)属性来提高命令的超时时间。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-08T20:07:52.093

也许这并不适用，但我认为还是应该提到它。默认 CommandTimeOut 为 30 秒。对于 99.9% 的 Web 应用程序中发生的任何操作，这应该有足够的时间。除非您绝对确定该操作应该花费更长的时间，否则您应该花时间尝试优化 sql 以使其在 <30 秒内返回。适当的索引是一个很好的起点。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-08-19T16:14:54.290

然后将其添加到连接字符串中：

```
server={servername};database={dbname};uid={username};pwd={password};Connect Timeout=600 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T21:00:37.723

对 Al +1，因为 30 秒应该足够了。延长超时时间实际上只是对潜在问题的绷带。

以我的经验，存储过程在 90% 的时间里都太贵了。当我上次查看这些错误时，我有一个一般的经验法则，即没有存储过程的成本超过 1.00。它们越昂贵，我们阻塞和生成这些异常的风险就越大。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-09-15T12:17:19.783

使用的查询未针对数据量进行优化。在我们的例子中，我们已经清除了未使用的数据，但更好的选择应该是优化查询或查看内部管理。采取行动后，我们不再收到错误消息。当然，这取决于您收到此错误的情况以及此解决方案是否可以帮助您。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T20:00:10.923

您可以通过将“Connect Timeout=90”添加到连接字符串来完成此操作。如果您的查询花费的时间超过 30 秒，那么您确实应该考虑以某种方式优化查询。可能需要添加索引或可能需要创建视图等。

**编辑以纠正@Stijn 评论指出的问题。**

# html - 关于标记验证错误的问题

> ID：841510
> 
> 赞同：0
> 
> 时间：2009-05-08T19:53:04.560
> 
> 标签：html, validation, markup

我正在使用 [ [http://validator.w3.org/][1]](http://validator.w3.org/][1])进行标记验证，并且我继续收到对我没有任何意义的错误。例如，对于下面的两个，验证器告诉我在 body 和 html 标记的右括号内检测到错误。对于一页，它会重复这些错误 5 次，这对我来说没有意义。任何建议或帮助都会很棒，谢谢！:)

第 184 行，第 7 列：XML 解析错误：开始和结束标记不匹配：div 第 17 行和正文

```
</body> 
```

错误第 185 行，第 7 列：XML 解析错误：开始和结束标记不匹配：正文第 16 行和 html

```
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T19:54:46.633

正如你所看到的：`ending tag mismatch: div`- 你错过了`</div>`某个地方。它无法确定它丢失的确切位置，但它知道它必须在之前的某个地方`</body>`

# sql - How do I get SQL SELECT @variable = expression assignments to work like a spreadsheet?

> ID：841513
> 
> 赞同：1
> 
> 时间：2009-05-08T19:53:48.367
> 
> 标签：sql, stored-procedures, variables, variable-assignment, sqlanywhere

*Disclaimer: This is an "asked-and-answered question" posted in accordance with the FAQ statement that it's "perfectly fine to ask and answer your own programming question". Its purpose is to encourage members of the SQL Anywhere programming community to use StackOverflow by seeding the "sqlanywhere" tag with some real-world content. Edits are welcome, as are other answers, and it has been marked "community wiki" to facilitate that, as well as to avoid claims of gaming the reputation system.*

I'm writing a stored procedure for SQL Anywhere 9.0.2, here's some code:

```
...
declare
@v_d datetime, @v_d1 datetime, @v_d2 datetime
....
select @v_d1 = @v_d, @v_d2 = dateadd(dd, 1, @v_d1)
... 
```

it turns out that @v_d2 will not be set as expected. if I modify it to:

```
...
declare
@v_d datetime, @v_d1 datetime, @v_d2 datetime
....
select @v_d1 = @v_d
select @v_d2 = dateadd(dd, 1, @v_d1)
... 
```

nothing happens, all the same. finally, I changed it to :

```
...
declare
@v_d datetime, @v_d1 datetime, @v_d2 datetime
....
begin
   select @v_d1 = @v_d
end
begin
   select @v_d2 = dateadd(dd, 1, @v_d1)
end
... 
```

now it works fine, looks kind of stupid though. my question is: is it a known issue? or maybe I could do it more neatly? any comments will be appreciated. thanks!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T19:54:09.130

You are looking for spreadsheet-style automatic recalculation for host variable assignments in a Transact-SQL SELECT list. I am curious about whether Microsoft SQL Server or Sybase ASE do it, but this is SQL Anywhere...

From the behavior of your original code, it looks like references to host variables (the reference to @v_d1 in the call to dateadd) always refer to the values that existed when the statement started (null), not the recalculated value (the value from @v_d):

```
CREATE PROCEDURE p AS
declare
@v_d datetime, @v_d1 datetime, @v_d2 datetime
SELECT @v_d = CURRENT TIMESTAMP
select @v_d1 = @v_d, @v_d2 = dateadd(day, 1, @v_d1)
SELECT @v_d, @v_d1, @v_d2
GO

SELECT * FROM p();

@v_d,@v_d1,@v_d2
'2009-05-08 15:13:43.964','2009-05-08 15:13:43.964',(NULL) 
```

You report that your second version (separate SELECT statements) does not work, but the following works for me:

```
DROP PROCEDURE p;

CREATE PROCEDURE p AS
declare
@v_d datetime, @v_d1 datetime, @v_d2 datetime
SELECT @v_d = CURRENT TIMESTAMP
select @v_d1 = @v_d
select @v_d2 = dateadd(dd, 1, @v_d1)
SELECT @v_d, @v_d1, @v_d2
GO

SELECT * FROM p();

@v_d,@v_d1,@v_d2
'2009-05-08 15:12:54.339','2009-05-08 15:12:54.339','2009-05-09 15:12:54.339' 
```

The spreadsheet-style recalculation you are looking for DOES apply to select list items coded "expression AS identifier" (but that's not exactly what you want)...

```
DROP PROCEDURE p;

CREATE PROCEDURE p AS
declare @v_d datetime
SELECT CURRENT TIMESTAMP INTO @v_d
select @v_d AS v_d, dateadd(day, 1, v_d) AS v_d1, dateadd(day, 1, v_d1) AS v_d2
GO

SELECT * FROM p();

v_d,v_d1,v_d2
'2009-05-08 15:14:27.292','2009-05-09 15:14:27.292','2009-05-10 15:14:27.292' 
```

If you want to spreadsheet-style recalculation AND you want host variable assignments, I suggest you switch to the Watcom-SQL dialect so you can use the INTO list:

```
DROP PROCEDURE p;

CREATE PROCEDURE p() BEGIN
   DECLARE @v_d  datetime;
   DECLARE @v_d1 datetime;
   DECLARE @v_d2 datetime;
SET @v_d = CURRENT TIMESTAMP;
SELECT @v_d AS v_d, 
       dateadd(day, 1, v_d) AS v_d1, 
       dateadd(day, 1, v_d1) AS v_d2
  INTO @v_d,
       @v_d1,
       @v_d2;
SELECT @v_d,
       @v_d1,
       @v_d2;
END;

SELECT * FROM p();

@v_d,@v_d1,@v_d2
'2009-05-08 15:27:09.808','2009-05-09 15:27:09.808','2009-05-10 15:27:09.808' 
```

The behavior is the same in SQL Anywhere versions 9.0.2 and 11.0.1.

Breck

# php - 为什么一个非常好的 PHP 框架 - Qcodo（或 Qcubed - 它的分支） - 如此不受欢迎？

> ID：841525
> 
> 赞同：6
> 
> 时间：2009-05-08T19:57:52.973
> 
> 标签：php, orm, frameworks, event-handling, code-generation

我想知道为什么这个框架（QCodo）几乎被遗忘并且完全不受欢迎。

几年前我就开始使用它，它是**唯一**让我坚持使用 PHP 的东西。是的......它的开发被卡住了（这就是为什么现在有更多活跃的分支[Qcubed](http://qcu.be)）但它仍然是非常好的软件。

其主要优点：

*   事件驱动（类似于 asp.net）**没有意大利面条代码**
*   强大的代码生成
*   好的ORM
*   遵循干燥
*   非常简单的 AJAX 支持
*   写起来很有趣

从那时起，我想成为时尚并检查 Django，但我无法编写正常的基于请求的 Web 应用程序（感觉不太对劲）。

不相信？chess.com 是用它编写的，当然还有很多其他的。

我的两个问题是：

1.  你听说过吗（PHP 人）？
2.  如果您正在使用它，您对此有何看法（向我们展示您的工作示例）

谢谢

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-08T20:02:24.197

我已经使用 PHP 很多年了，但从未听说过。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-08T23:05:47.327

1.  Qcodo 的创建者从未真正推广过该框架，因此并没有产生大量追随者。我相信他们创建它主要是为了自己使用，但也提供给其他人。如果您正在寻找代码生成框架，那就太棒了。它确实有一个学习曲线。所以为了充分利用它，最好花时间研究这些例子。

2.  Qcodo 已经有一年多没有积极的开发了，而且在 Qcodo 上继续开发的可能性似乎也不大。Qcodo 似乎正在慢慢死去。

3.  Qcubed 是 Qcodo 的一个分支，自 2008 年 11 月以来一直在积极开发中。它是由对 Qcodo 缺乏进展感到沮丧的 Qcodo 用户创建的。如果您刚刚开始，请从这里开始，而不是使用 Qcodo。但是使用 Qcodo 论坛搜索您可能遇到的问题/疑问。

Qcodo 和 Qcubed 是很棒的框架。不要仅仅因为您没有听说过它们而打折或低估它们。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-29T04:54:39.760

在 PHP 中模拟 ASP.NET 或 Wicket 并不是一件好事。而且，代码风格对我来说并不好看。

```
$this->btnSavePage = new QButton($this);
$this->btnSavePage->Text = "Save";
$this->btnSavePage->Visible = false;

$this->btnCancelEdit = new QButton($this);
$this->btnCancelEdit->Text = "Cancel";
$this->btnCancelEdit->Visible = false; 
```

匈牙利符号？我的天啊。我需要创建一个大对象来创建一个按钮？对我来说很重。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-09T17:15:58.807

是的，我们确实在 Chess.com 上使用过它，并且总体上对它非常满意。当您每天的网页浏览量超过一百万时，试图弄清楚如何/在哪里存储所有这些 QFormStates 可能会遇到问题。每个页面视图都是它自己的 QFormState！我们通过将它们全部放入 memcache 来解决这个问题！它确实有一点学习曲线，但是一旦你知道了，你就再也不需要文档了。实际上，我已经完全不再使用 QQ，而是在我们的 ORM 文件中使用所有自定义 sql。QQ 只是不够强大，无法进行高度优化的查询，而高度优化的查询比数据库抽象更重要。毕竟，该网站需要运行并快速。这是我们的 User 类中的一个示例 ORM 静态方法，用于从数据库中加载随机用户（我们曾经使用它来显示随机的“用户聚光灯” 在我们的会员页面上）。注意它如何使用从数据库，而不是我们的主数据库（自定义构建函数）。它还使用 memcache，因此随机用户仅每 10 分钟（600 秒）更改一次。

```
公共静态函数 LoadRandom($blnAvatarRequired = true, $blnForce = false) {
  $strCacheKey = MyMemcache::QueryToKey("User->LoadRandom()");
  if($blnForce || false === ($objUser = MyMemcache::G()->GetQuery($strCacheKey))) {
    $objDatabase = QApplication::GetSlaveDbConnection();

    $DaysAgo = new QDateTime(QDateTime::Now);
    $DaysAgo->AddDays(-10); //确保这是一个活跃的成员

    // 设置 SQL 查询
    $strAvatarReq = $blnAvatarRequired ？' 和 u.has_avatar':'';
    $str查询 = "
      选择
        你。*
      从
        用户你
      在哪里
        u.is_enabled=1 和
        u.create_date > '$DaysAgo'
        $strAvatarReq
      订购
        兰德（）
      限制
        1
    ";

    // 执行查询并实例化结果
    $objDbResult = $objDatabase->Query($strQuery);
    $objUser = User::InstantiateDbRow($objDbResult->GetNextRow());
    MyMemcache::G()->SetQuery($strCacheKey, $objUser, null, 600);
  }

  返回 $objUser;
}

```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-09T17:50:58.103

我们在 3 个项目中使用了 Qcubed 和 Qcodo，这些项目是我们曾经拥有的最干净、最容易维护的项目！这是很棒的东西，很容易理解。只需进入您不需要太多手册的代码。

Qcubed 社区目前要强大得多，因此您可能想在 Qcodo 论坛中查看您对基本问题的答案，但请在 Qcubed 论坛上发帖。

我们将继续使用这个出色的产品和社区！

问候，电子产品

[http://www.twitter.com/qcodo](http://www.twitter.com/qcodo)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-08T20:08:11.000

不，我从没听说过。

我听说过的主要有 Zend、CakePHP、Symfony、Code Igniter，还有一两个我一时想不起名字的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-08T20:06:16.790

我已经断断续续地从事 PHP 工作大约 3 年了，但从未听说过。让任何人说出一个 PHP 框架的名字，你会得到通常的嫌疑人：Code Igniter、Cake、Zend 等。

猜猜 QCodo 开发人员需要在他们的营销上做一些工作！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-30T10:09:43.470

我已经使用 QCodo 2 年了，现在我在使用 QCubed。

这是开发和维护 Web 应用程序的好方法，也是部署代码和测试代码的最简单方法。请记住，QCubed 现在的接受度越来越高，这对所有 QCodo 的社区都有好处。

我认为框架可以节省大量开发时间，但在很多情况下，不建议您所有的 Web 开发。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-12T13:39:28.563

我两年前开始使用它。亲：

1.  从数据库生成代码
2.  ORM 面向对象
3.  ajax的简单使用

缺点：

1.  qcubed 社区不太擅长以新的好想法进行项目
2.  新代码不在 Mike Ho 的级别。
3.  qforms 状态中的 bug，qcodo/qcubed 的形式。
4.  不受欢迎。
5.  他们不想继续使用 DDD 和正向工程。
6.  表单仅适用于启用 js 的情况。
7.  是用 PHP 编写的。
8.  新插件系统设计不佳。

目前，Grails 似乎是最好的框架，非常面向 DDD，可以使用任何现有的 Java 代码，良好的模板库，可以使用不同的 js 框架，基于 Hibernate 和 Spring。使用 Grails 可以编写简单的 Web 应用程序或财务应用程序。

我希望以后不要使用 PHP，但是因为我知道 Qcubed/Qcodo，如果有必要我会使用它。对于新手，我推荐 Symfony，更大的社区，mre 插件，功能丰富，未来更安全。

更新：

*   没有数据库迁移，无法跟踪数据库架构更改
*   没有反映生成哪些表的模式
*   它不是为真正的 TDD 设计的，测试模型、控制器和视图并不容易。他们只是在一个不友好的测试 web 框架中添加了一个测试框架
*   当使用多个控件并触发 Ajax 错误并阻塞应用程序时，QForms 仍然存在错误并且可能会丢失状态。
*   从长远来看，ORM 使用起来非常无聊（大量冗长/冗余代码），并且无法使用 Rails 控制台之类的工具进行测试，最终使用纯 SQL 并使用 phpMyAdmin 进行测试所需的时间更少。
*   ORM 中也存在错误，有时当我将字段声明为整数时会得到一个字符串（代码生成的查询）。
*   没有前端控制器和路由系统，框架在公共路径内！插件也安装在公共路径中！
*   与其他 MVC 框架不相似的奇怪目录结构，它们认为 M 仅代表 ORM 而不是模型。
*   不是像 Rails 或 Symfony 那样的 link_to 标签和许多其他标签。
*   过于复杂的元控件只会浪费时间。
*   在 Rails 中专注于脚手架的框架并没有被大量使用，因为大多数开发人员使用以用户为中心的设计，而不是以数据为中心的设计。
*   视图充满了 object->render 和 JS，自定义控件很难自定义，而不是留在模板中，而是在具有逻辑会话的类中......一切。
*   它不适用于 PHP 5.3（未测试但应该解决）和 Quercus。
*   Rails/Grails 有大量的插件可以做任何事情。

我可以继续，但我想你明白了。只需学习 Rails 或 Grails 几个月，然后告诉我你的想法。

我正在将我的 Qcodo 项目转移到 Rails，我有一个很棒的环境，很好的社区，并且网络中的大部分创新都围绕 Ruby 和 Rails。Rails 多次被评为最佳 Web 开发工具，是唯一可以替代 Java 或 .net 的工具

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-08T21:57:25.807

虽然我听说过它（Qcodo ......不是这个叉子），但我从未考虑过使用它。有大量的框架，只有这么多的需求。在这种情况下，公关和思想分享非常重要，而 Qcodo 从来没有真正拥有过。现在我已经确定了几个，我没有时间，也没有兴趣开始学习一个新的框架。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-11T22:47:54.033

我从 beta 2 开始就一直在使用 QCodo，现在是 QCubed 的核心贡献者，所以是的，我听说过。

最初吸引我进入该框架的是代码生成。我来自 asp.net 和 codesmith，很高兴找到一个框架，它为我提供了 asp.net 的事件驱动方法和 codesmith 的代码生成。

我也喜欢它都是纯 OO PHP，这意味着我不必学习一门新语言来开发我的 PHP 应用程序，并且自定义框架的任何不符合我想要的行为的方面都很简单。

所有这一切都使我们能够生产出易于维护且功能强大的学习管理系统，我们已向众多财富 500 强公司出售并托管该系统。

有一些缺点，例如 ORM 方法的运行时开销，但代码的可读性和干净的布局导致能够更轻松地简化应用程序的其他方面，并显着减少开发时间和错误数量产生。

由于 QCubed 是一个社区驱动的项目，任何人都可以提交工单、提出改进建议或讨论更改，项目的发展方向非常明确，并且非常愿意接受建设性的反馈。

为了辩护这里所说的一些负面的事情，我将简单地指出，大多数所谓的“问题”的票根本就没有被创造出来。我会鼓励任何遇到他们的人请创建一张票让我们查看[http://qcu.be](http://qcu.be)。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-12T16:46:23.623

我已经使用 QCodo/QCubed 1.5 年了。从我自己的框架开始，在某些时候看起来很混乱。那是我开始寻找更成熟的框架的时候。幸运的是，我找到了 QCodo。从那以后，我什至从未考虑过寻找其他东西。该框架非常灵活和强大，你可以用它做任何你想做的事情。

我几乎没有事件驱动架构的经验。所以，开始有点困难，因为可用的文档很少。但是社区本身非常活跃，您可能会在 1-2 天内（有时甚至在几个小时内）得到新手问题的答案。但是目前文档级别要好得多，社区也更加活跃:)

没有什么我可以抱怨的。如果我有一些问题/建议，我会尝试与核心开发人员讨论。在没有建设性讨论的情况下抱怨事情是蹩脚的恕我直言。

我现在已经将 QCodo/QCubed 用于 3-4 个成功的项目。我用得越多，我就越喜欢它 :) 而且，每当我有空闲时间时，我都会努力帮助开发更好的框架。我可以说，我已经有 10 多人，我已经说服他们现在开始使用 QC ;) 我希望还会有更多。

QCubed 完全震撼！

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-06-12T19:57:16.567

这个游泳日志使用它[mySwimLog](http://www.myswimlog.com)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-06-10T06:53:22.777

好的，关于这个 Qcodo / Qcubed 的事情，我想告诉你一些事情：

1.  这个棒极了。我只是说它有多棒。你说 CodeIgniter？交响乐？我说 Qcubed。

当我想开始我正在从事的项目时，我查看了所有这些，并通过维基百科的文章，登陆 Qcodo 网站，然后登陆 Qcubed ......我很惊讶。

我最喜欢的功能：

1.  不需要 SQL 查询。当然可以，但大多数事情都已经处理好了！
2.  核心功能的模板操作。
3.  创建自定义控件是一块 CAKE（而不是 CAKEPHP）。
4.  完全均匀驱动。保存状态就像......“这是在哪里发生的？”
5.  没有学习曲线。只需查看 Yii 或 Symfony 示例，然后查看 Qcubed 示例。与其他人相比，它要简单得多。
6.  完整的 AJAX 支持。我喜欢这个。
7.  没有 JavaScript。要求它做一些“javascript”动作，它是由 javascript 完成的。将一个词更改为“QAjaxAction”，它会转到 ajax。再次更改，页面重新加载。你还想要什么？
8.  自动完成、类型转换（自动和手动控制）等等！
9.  几乎任何东西的内联编辑！

是的，说到Yii，冰淇淋上有一些樱桃。但我认为 Qcodo 有更多的内在。

你说身份验证支持？好吧，我创建了一个在 1 天内与 Qcubed 集成。它为其他框架节省了一周的学习头痛。Q立方岩石。

是的，我讨厌它的缓慢发展。但我认为它接近完成！（可能是我知道的东西太少，但我能想象到的任何事情似乎都可以通过 Qcubed 得到解决）。

我希望它更受欢迎......在登陆他们的页面之前，我会节省一周的搜索时间。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-08T20:27:14.027

从来没有听说过。
断断续续地做 PHP 4 年多

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-11T14:52:25.767

[http://www.piranhammethod.com/2009/04/09/qcodoqcubed/](http://www.piranhamethod.com/2009/04/09/qcodoqcubed/)

我听说过它，我喜欢它。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-16T14:13:26.053

我也来自 dotNet / Codesmith 环境。当我选择一个想要将 dotNet 站点转换为 PHP 的项目时，我寻找一个可以最好地模拟原始应用程序逻辑设置方式的框架。我发现要么是臃肿的框架，要么是没有完全满足项目要求的框架。

我在研究使用 MyGeneration 工具生成 PHP 代码时偶然发现了 QCodo。从那以后我再也没有回头。易用性、快速构建复杂应用程序的能力以及 QCodo 现在 QCubed 使用的真正的 OO 方法使其成为适合我目的的最佳框架。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-29T03:17:20.123

我使用 QCodo、ZCodo 和现在的 QCubed 已经有一段时间了。

实际上，我选择它作为 CakePHP 的替代品，在我需要它的时候，它还不够成熟，无法做我想做的事情。

我对它作为一个框架感到非常满意；它对事物进行了足够的抽象，但又不会太多以至于您忽略了编程。

我计划将它用于我未来负责的任何开发项目，我期待 QCubed 成为 PHP5 的最佳社区维护框架。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-06-12T14:19:44.303

原因很简单，流行和成功通常与技术上最好的东西不相符。我相信任何技术人员都能想出很多例子。有很多东西可以促进平庸的解决方案，比如营销、先发优势、在某些领域做得更好、吸引人们的注意力、在一些高调的应用程序中使用，或者只是运气。

另一个原因是，对你来说技术上最好的东西在做不同事情的人看来可能不是这样。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-10-14T14:55:38.423

我认为 QCubed 很棒，主要是因为您可以使用 Ajax 的方式（您`t have to write Jscript and you don`不必使用 jQuery）。

一份非常有用的文件：[http ://www.qcodo.com/demos/QcodoClassLibrary.pdf](http://www.qcodo.com/demos/QcodoClassLibrary.pdf)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-10-23T20:58:21.170

我在 4 年前选择了 QCodo 来开发我们的产品。我从不后悔——现在我们是 3 个开发人员，任何非 OOP 解决方案都行不通。我们已经安装了近 50 个客户 - 在 Apache、IIS、我的 SQL 和 SQLServer 平台、Linux 或 W2003 上。F 设计很棒，代码生成很棒，而且很容易开发、扩展和维护。我现在无法阅读任何其他代码...

是的，市场营销很差，项目过去只依赖于创建者（Mike Ho）。所有这些最近都转移到了 Git，营销应该很快就会好起来。而且，现在 Mike Ho 回来了！！！

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-12-08T21:15:59.307

我在几个涉及 Flash 远程处理的项目中使用过它，但我只在框架中使用 ORM，因为我不太喜欢像 .NET 这样的 EDP 东西。对于无状态 Web，流程似乎根本不合适。如果 ORM 可以作为单独的组件发布，那就太好了。

* * *

## 回答 #23

> 赞同：-2
> 
> 时间：2009-06-12T14:22:54.437

1.  > qcubed 社区不太擅长以新的好想法进行项目

    废话

2.  > 新代码不在 Mike Ho 的级别。

    废话

3.  > qforms 状态中的 bug，qcodo/qcubed 的形式。

    ??

4.  > 不受欢迎。

    所以呢

5.  > 他们不想继续使用 DSL 和正向工程。

    你的观点？每个不想走你的路的框架都是错的？我不想要你提出的建议

6.  > 表单仅适用于启用 js 的情况。

    你一定是在开玩笑吧？如果用户没有启用 JS，那么他们就处于石器时代......

7.  > 是用 PHP 编写的。

    没有意见

8.  > 新插件系统设计不佳。

    你说的依据是什么？我也会对此说废话

显然，这张海报有一些隐藏的议程......我也仔细研究了 Symphony - 我每次都会选择 QCubed 而不是 Symphony。适用于大型应用程序或小型应用程序

* * *

## 回答 #24

> 赞同：-2
> 
> 时间：2009-10-14T14:59:05.837

1.  我从来没有听说过。
2.  我没用过。

# c# - Desktop Development : Remember Target After Losing Focus

> ID：841531
> 
> 赞同：2
> 
> 时间：2009-05-08T19:58:28.853
> 
> 标签：c#, windows, desktop, desktop-application

Is it possible to take focus from another program to respond to an event, but then once the response has been handled, switch back to the previous program and restore the cursor where it was?

This sounds like a weird question, but think of it along the lines of

1.  User is typing in a text box in **Program A**.
2.  A window for **Program B** pops up and user presses a few buttons to confirm something.
3.  **Program B** returns control to **Program A** and restores the selection of the textbox.

If there is a complete C# solution, then great, but this sounds like it might require a little more effort than usual.

Any thoughts?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T20:20:18.957

Personally, doing this could very likely result in the user selecting undesired values in the popup window. For example, someone is typing away in Word. Your application pops up a window, where hitting "Enter" selects a value ... such as the default button. Without wanting to, the user "selected" an incorrect value on your form.

Windows itself tends to do this, and it's very annoying. Quickly double-clicking a desktop shortcut to open an application and then switching back to (for example) an e-mail before the app launches, will tend to remove focus from the focused e-mail window and put focus in the just-opened application, causing your e-mail text or keyboard strokes to go to the just-opened window.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T20:24:20.197

In my experience windows programs work just this way. It often appears that they don't because the user is returning focus with a mouse-click, which itself resets the focus. If it's a winforms app you can probably do something with the lost focus/got focus events at the form level.

# apache-flex - 弹性图表标签不会在数据刷新时更新？（图片）

> ID：841535
> 
> 赞同：0
> 
> 时间：2009-05-08T19:59:14.343
> 
> 标签：apache-flex, charts

[替代文字 http://www.mattdell.com/hostedfiles/flexchartissue.bmp](http://www.mattdell.com/hostedfiles/flexchartissue.bmp)

我遇到了一个问题，即我的 Flex 饼图上的图表标签在刷新数据时不会消失。在上图中，左/前图表是图表默认加载的方式。通过从下拉列表中选择另一个项目，图表将更改为右侧/之后的图表，但“有风险”标签不会消失。对于“工作中”不会消失的另一个选择也是如此。

有没有其他人发生在他们身上？我找不到这方面的任何信息！

## 谢谢！

-马特

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T21:01:05.787

我遇到了这个问题，我花了一段时间才找到解决这个错误的方法。

为了解决这个问题，我在设置了 dataProvider 的基础 Collection 时以及 Collection 更改时设置了 PieChart 系列：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:PieChart xmlns:mx="http://www.adobe.com/2006/mxml"
    dataProvider="{dataForPieChart}">
    <mx:Script>
        <![CDATA[
            import mx.events.CollectionEvent;
            import mx.collections.ArrayCollection;
            import mx.charts.series.PieSeries;

            [Bindable]
            private var _dataForPieChart:ArrayCollection;

            public function set dataForPieChart(value:ArrayCollection):void
            {
                _dataForPieChart = value;

                /* Add a Collection Change Event Listener to the Collection. */
                _dataForPieChart.addEventListener(
                    CollectionEvent.COLLECTION_CHANGE, 
                    dataForPieChart_collectionChangeHandler);

                reloadPieSeries();
            }

            public function get dataForPieChart():ArrayCollection
            {
                return _dataForPieChart;
            }

            private function dataForPieChart_collectionChangeHandler(
                event:CollectionEvent):void
            {
                reloadPieSeries();
            }

            private function reloadPieSeries():void
            {
                series = new PieSeries();

                series.field = "myValue";

                series.labelPosition = "callout";
            }
        ]]>
    </mx:Script>
</mx:PieChart> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T20:37:02.210

在这两种情况下，您的数据是什么样的？我的猜测是您有值为 0 的系列数据，这可能会导致标签呈现而饼图上没有显示任何可见切片。如果字段值为 0，请尝试过滤掉值为 0 的数据或使用自定义标签函数不显示标签。

（注意这只是猜测）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-04T15:35:45.643

Eric Belair 提出的解决方案对我很有用，这是我在更新 infoPA 中的数据的函数中的代码，它是 PCgrafico PieChart 的 dataProvider。如果有人也遇到这种情况，我希望它会有所帮助

```
infoPA=evt.result.data.infoPA.estado;

PCgrafico.series=null;
var vectorSeries:Array=new Array();

var series:PieSeries=new PieSeries();
series.field="totalPA";            
series.nameField="estadoPA";
series.setStyle("labelPosition", "callout");
series.setStyle("showDataEffect", effect);
vectorSeries.push(series);
PCgrafico.series=vectorSeries; 
```

# sql - 如何从 SQL DDL 生成实体关系图？

> ID：841541
> 
> 赞同：5
> 
> 时间：2009-05-08T20:00:30.847
> 
> 标签：sql, database-design, ddl, er-diagrams

例如，DbVisualizer 可用于连接数据库并根据现有表及其关系创建漂亮的图表。但在这种特定情况下，我没有实时数据库，但我有一堆 create table 和 alter 语句。

是否有任何工具可以从 SQL DDL 生成类似的图表？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-05-07T16:49:40.850

我发现 MySQL 工具 MySQL Workbench 做得很好。有一个 Mac OS X 版本。更多信息可以在[http://dev.mysql.com/doc/index-gui.html](http://dev.mysql.com/doc/index-gui.html)找到。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-08-18T20:39:43.957

SQLFairy 将从普通的 SQL DDL 文件生成图形：

[http://sqlfairy.sourceforge.net/](http://sqlfairy.sourceforge.net/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T20:05:42.627

我相信 Embarcadero 的 ERStudio 可以将 SQL 脚本导入图表，但它是一个昂贵的工具，仅用于这样的事情。您总是可以只创建一个空数据库并运行脚本然后指向它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-08T12:39:55.833

[UML 的 Visual Paradigm](http://www.visual-paradigm.com/highlight/reverseddl.jsp)可以做到这一点。

# c - Signal Stack

> ID：841546
> 
> 赞同：6
> 
> 时间：2009-05-08T20:01:27.847
> 
> 标签：c, signals

I did read that signals need to have a separate stack, why and how do you think it is implemented ?

Are they dynamically allocated or statically allocated ? How is memory allocation done ? Is it the same for all signals ?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T20:10:00.200

The reason that signals need a separate stack is that, if the normal stack gets corrupted or overflows, the signal can still execute. I think the signal stack is usually allocated dynamically, but it could implemented be either way. You can set a new signal stack with `sigaltstack`. It is the same for all signals.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-09T06:08:40.920

另一个更深奥的原因是创建用户级线程。请参阅 Ralf Engelschall 的论文“便携式多线程”：[http](http://www.gnu.org/software/pth/rse-pmt.ps) ://www.gnu.org/software/pth/rse-pmt.ps 。它描述了如何使用“信号栈蹦床技巧”来影响用户空间线程。

# asp.net - 如何在 IIS7 中复制网站的设置？

> ID：841547
> 
> 赞同：11
> 
> 时间：2009-05-08T20:01:38.207
> 
> 标签：asp.net, iis, iis-7, mime-types

试图在 IIS7 (Server2008) 上运行 ASP.NET 应用程序，我快疯了。

我在 IIS7 中设置了一个运行良好的网站。我现在正在尝试创建另一个，但我只得到所有 .aspx 文件的 404。处理映射器都与工作站点的不同。有什么方法可以复制工作站点的设置，这样我就不必手动完成 50 个映射。

还是有更好的方法来获得正确的设置？

*删除了无效的 ImageShack 链接*

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-09T00:18:17.950

IIS7 的默认配置保存在 c:\windows\system32\inetsrv\config\applicationHost.config

您对每个站点/应用程序所做的任何更改都存储在该站点/应用程序的 web.config 中。

您应该能够简单地将文件复制到第二台服务器上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T23:58:48.807

如果您只是想重新安装默认的 ASP.NET 映射，最好的方法是使用

```
aspnet_regiis.exe 
```

它位于 %windir%\Microsoft.NET\Framework\v___ 文件夹中（取决于您要设置的版本——看起来像 3.5？）

[使用http://msdn.microsoft.com/en-us/library/k6h9cz8h.aspx](http://msdn.microsoft.com/en-us/library/k6h9cz8h.aspx)上的文档查看是否要使用 -i、-r 或 -s 选项。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-08T20:29:30.917

对于 IIS 5（和 6？），Microsoft 有一个名为 MetaEdit 的免费下载。它仅用于此目的 - 在机器之间备份和恢复 IIS 配置。检查 MS 的网站，看看是否有 IIS 7 的更新版本。

# cocoa - setFrame 创建了一个在两个维度上都比预期小 15 像素的 NSView

> ID：841551
> 
> 赞同：1
> 
> 时间：2009-05-08T20:02:49.780
> 
> 标签：cocoa, macos, nsview

我有一个令人费解的问题。我有一个指向在笔尖中初始化的香草 NSView 的指针。我向 NSView 发送消息：

```
[myNSView setFrame:NSMakeRect(0,0,816,1056)]; 
```

但是当我通过调试器时，`myNSView`有一个`{{0,0}, {801, 1041}}`. 矩形的尺寸比我指定的小 15！这种情况始终如一地发生。如果我`[setFrames]`连续指定两个，一切正常，但这当然不是答案。

为什么会`setFrame`失败？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T22:26:05.677

15px 正好是 NSRegularControlSize 的 NSScroller 的大小。

我的猜测是您将 NSScrollView 配置为自动隐藏滚动条。

尝试在 NIB 中关闭你的 scrollView 的水平和垂直滚动条，如果这样可以解决问题，你就会知道从那里看哪里。它与 scrollView 的 clipView 自动调整 documentView 的大小有关。当滚动条出现时，clipView 本身正在自动调整大小；在您将 documentView 设置为需要滚动条的 frameSize （我猜是 100% 设置）之后直接。

# jquery - Jquery $(this) 子选择器

> ID：841553
> 
> 赞同：72
> 
> 时间：2009-05-08T20:03:22.710
> 
> 标签：jquery, css-selectors, children

我正在使用这个：

```
jQuery('.class1 a').click( function() {
  if ($(".class2").is(":hidden")) {
    $(".class2").slideDown("slow");
  } else {
    $(".class2").slideUp();
  }
}); 
```

页面结构：

```
<div class="class1">
  <a href="...">text</a>
  <div class="class2">text</div>
</div> 
```

它仅在您没有多个 class1/class2 集时才有效，例如：

```
<div class="class1">
  <a href="...">text</a>
  <div class="class2">text</div>
</div>
<div class="class1">
  <a href="...">text</a>
  <div class="class2">text</div>
</div>
<div class="class1">
  <a href="...">text</a>
  <div class="class2">text</div>
</div> 
```

如何更改初始 jquery 代码，使其仅影响单击的 class1 下的 class2？我尝试了[如何获取 $(this) 选择器的子项的建议？](https://stackoverflow.com/questions/306583/jquery-this-selector-and-children)但还没有成功。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-05-08T20:04:52.130

使用 HTML 的最佳方法可能是使用该[`next`](http://docs.jquery.com/Traversing/next#expr)函数，如下所示：

```
var div = $(this).next('.class2'); 
```

由于点击处理程序发生在 上`<a>`，您还可以向上遍历到父 DIV，然后向下搜索第二个 DIV。[`parent`](http://docs.jquery.com/Traversing/parent#expr)您可以使用和的组合来执行此操作[`children`](http://docs.jquery.com/Traversing/children#expr)。如果您放置的 HTML 不完全一样，并且第二个 DIV 可能位于相对于链接的另一个位置，则此方法将是最好的：

```
var div = $(this).parent().children('.class2'); 
```

如果您希望“搜索”不限于直系子级，您可以在上面的示例中使用[`find`](http://docs.jquery.com/Traversing/find#expr)而不是。`children`

此外，如果可能的话，最好在你的类选择器前面加上标签名称。即，如果只有`<div>`标签将具有这些类，则将选择器设为`div.class1`, `div.class2`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-08T20:10:01.620

在点击事件中，“this”是被点击的标签

```
jQuery('.class1 a').click( function() {
   var divToSlide = $(this).parent().find(".class2");
   if (divToSlide.is(":hidden")) {
      divToSlide.slideDown("slow");
   } else {
      divToSlide.slideUp();
   }
}); 
```

尽管您也可以使用 .siblings、.next 等，但有多种方法可以访问 div

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-08T20:17:28.950

使用[.slideToggle()](http://docs.jquery.com/Effects/slideToggle)会简单得多：

```
jQuery('.class1 a').click( function() {
  $(this).next('.class2').slideToggle();
}); 
```

编辑：使它成为 .next 而不是 .siblings

[http://www.mredesign.com/demos/jquery-effects-1/](http://www.mredesign.com/demos/jquery-effects-1/)

您还可以添加 cookie 以记住您所在的位置...

[http://c.hadcoleman.com/2008/09/jquery-slide-toggle-with-cookie/](http://c.hadcoleman.com/2008/09/jquery-slide-toggle-with-cookie/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-08T20:06:22.720

[http://jqapi.com/](http://jqapi.com/) Traversing--> 树遍历--> Children

# python - 这个 python 函数中的 lambda 表达式是怎么回事？

> ID：841555
> 
> 赞同：5
> 
> 时间：2009-05-08T20:03:43.567
> 
> 标签：python, lambda

为什么这种创建柯里化函数列表的尝试不起作用？

```
def p(x, num):
    print x, num

def test():
    a = []
    for i in range(10):
        a.append(lambda x: p (i, x))
    return a

>>> myList = test()
>>> test[0]('test')
9 test
>>> test[5]('test')
9 test
>>> test[9]('test')
9 test 
```

这里发生了什么？

实际执行我期望上述函数执行的功能是：

```
import functools
def test2():
    a = []
    for i in range (10):
        a.append(functools.partial(p, i))
    return a

>>> a[0]('test')
0 test
>>> a[5]('test')
5 test
>>> a[9]('test')
9 test 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-08T20:12:59.460

在 Python 中，在循环和分支中创建的变量没有作用域。您创建的所有函数`lambda`都引用了同一个`i`变量，该变量`9`在循环的最后一次迭代中设置为。

解决方案是创建一个返回函数的函数，从而确定迭代器变量的范围。这就是该`functools.partial()`方法有效的原因。例如：

```
def test():
    def makefunc(i):
        return lambda x: p(i, x)
    a = []
    for i in range(10):
        a.append(makefunc(i))
    return a 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T06:58:26.957

好吧，您还可以将 i 绑定到惰性的外部 lambda。

```
def p(x, num):
    print x, num

def test():
    a = []
    for i in range(10):
        a.append((lambda i :lambda x: p (i, x))(i))
    return a 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T16:34:31.147

我总是对为什么这不起作用感到困惑。感谢您的解释，“[付费书呆子](https://stackoverflow.com/users/102704/a-paid-nerd)”。我个人更喜欢这个解决方案：

```
for i in range(10):
    a.append(lambda num, val_i=i: p (val_i, num)) 
```

注意 的`val_i=i`默认参数，`lambda`它可以捕获`i`循环期间的瞬时值，同时仍然有效地制作`lambda`1 变量的函数。（顺便说一句：将您的更改`x`为`num`match`p`的定义。）我更喜欢它，因为：

1.  它非常接近最初的想法，并且避免了必须定义一个新的命名函数，这正是 lambda 的目的......
2.  避免导入`functools`
3.  并避免重叠 lambdas...

刚刚进行了搜索，并在那里找到了相同问题的更详细解释：[Scope of python lambda functions and their parameters](https://stackoverflow.com/questions/938429/scope-of-python-lambda-functions-and-their-parameters)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T06:51:09.877

我问了一个类似的问题，得到了两个答案。一个与这里接受的答案基本相同，另一个不太清楚但稍微简洁一些。

[在 Tkinter 中动态创建菜单。（lambda 表达式？）](https://stackoverflow.com/questions/728356/dynamically-creating-a-menu-in-tkinter-lambda-expressions)

# c# - Socket Server Disconnect and Reconnect Buffer Error?

> ID：841557
> 
> 赞同：0
> 
> 时间：2009-05-08T20:04:06.423
> 
> 标签：c#, .net, sockets, buffer

I'm using the following TCP Sockets Server/Client example: [http://www.codeguru.com/Csharp/Csharp/cs_network/sockets/article.php/c8781/](http://www.codeguru.com/Csharp/Csharp/cs_network/sockets/article.php/c8781/)

I'm also using the following CryptoStream example: [http://www.obviex.com/samples/Encryption.aspx](http://www.obviex.com/samples/Encryption.aspx)

Problem: Both Server and Clients communicate perfectly until I Stop the Server socket, wait a minute or so, then start the Server socket. Sometimes but not always I recieve a base64 error in the Encryption.aspx on line 'Convert.FromBase64String(cipherText);'...

I know there is incorrect / corrupted data in the buffer probably left-over from stopping the socket. Then the new data comes in and the error occurs.

Q. Will clearing the 'class SocketPacket; solve this issue?

Q. How do I clear the 'class SocketPacketsocketBuffer'?

Other suggestions are greatly appreciated..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T22:39:39.090

您可能会发现正在发生的一件事是其中一个套接字未正确关闭。套接字的问题是您需要确保它们正确关闭，或者您将服务器套接字设置为重用地址。

从 sysinternals 尝试 tcpview 来查看套接字的状态。您还可以使用 netstat 查看套接字的状态。

# web-services - Virtual DOM to Webpage

> ID：841569
> 
> 赞同：0
> 
> 时间：2009-05-08T20:07:30.737
> 
> 标签：web-services, xslt, presentation

I'm working on a system that stores data in XML files. The data in the files can be converted into a generic DOM but not without some processing. I have been tasking with looking into how to do the web access story for this system. (FWIW, the existing code base is in .NET)

The system can be thought of as an XML in XML database for handling generally static but end-user-time defined XML schemes. I'm not sure what the model is exactly as that's another guy's job but the bit I'm working with will be seeing serializable DOM objects of some kind.

The intended model is that the end user will write a web front end that accesses data from our system. The things that jump out at me as options are:

*   Build a SOAP (or equivalent) service that can present the processed XML and let the web server run from that with XSL or whatever.
*   Same as the SOAP solution but with server side XSL for security and rendering so the web server needs only drop in the text.
*   Build an assembly to so a web server can process files in process.
*   ???

We would like the system to be simple and cross platform (something that can be uses from a presentation layer written using LAMP, WAMP, RoR, ASP, etc).

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T20:13:58.193

It sounds to me like you're either not asking the right questions, or you're using the wrong terminology (or both.) But maybe that's just me.

"generic DOM" -- any XML file should be convertable into a DOM; if it can't be, it's not well-formed XML. The DOM is simply an in-memory representation of the XML. (Commonly, it's used to mean the DOM inside of a Web browser; but DOM models can be and are created on the server as well.)

Cross-platform -- I don't know of any way to write presentation code that can be plugged into LAMP, WAMP, RoR, ASP, etc. Maybe this is possible, but it seems unlikely to me.

My best guess about what you need is that it's pretty simple: Associate the XML file with a [CSS Style Sheet](http://www.w3.org/Style/CSS/), and let the Web browser format the XML for display to the user.

If that's not the answer you're looking for, maybe you could start with a sample of the XML that you need to display, and a prototype that shows how you'd like it to be displayed?

# selenium - Getting "Could not start Selenium session: Internal Server Error" error running selenium tests

> ID：841572
> 
> 赞同：0
> 
> 时间：2009-05-08T20:07:53.497
> 
> 标签：selenium, startup, selenium-rc

This is the error I'm getting when I try to run my selenium script through a build.xml on a network server:

@BeforeTest Setup

```
java.lang.RuntimeException: Could not start Selenium session: Internal Server Error   
 at com.thoughtworks.selenium.DefaultSelenium.start(DefaultSelenium.java:89)   
 at com.doubleclick.richmedia.selenium.InpageEndToEnd.createSeleniumClient(InpageEndToEnd.java:34)   
 at com.doubleclick.richmedia.selenium.InpageEndToEnd.setUp(InpageEndToEnd.java:27)   
 at com.intellij.rt.execution.application.AppMain.main(AppMain.java:90)   
Caused by: com.thoughtworks.selenium.SeleniumException: Internal Server Error   
 at com.thoughtworks.selenium.HttpCommandProcessor.throwAssertionFailureExceptionOrError(HttpCommandProcessor.java:97)   
 at com.thoughtworks.selenium.HttpCommandProcessor.getCommandResponseAsString(HttpCommandProcessor.java:168)   
 at com.thoughtworks.selenium.HttpCommandProcessor.executeCommandOnServlet(HttpCommandProcessor.java:104)   
 at com.thoughtworks.selenium.HttpCommandProcessor.doCommand(HttpCommandProcessor.java:86)   
 at com.thoughtworks.selenium.HttpCommandProcessor.getString(HttpCommandProcessor.java:262)   
 at com.thoughtworks.selenium.HttpCommandProcessor.start(HttpCommandProcessor.java:223)   
 at com.thoughtworks.selenium.DefaultSelenium.start(DefaultSelenium.java:81)   
... 26 more   
 ... Removed 23 stack frames 
```

And here's my @BeforeTest script:

@BeforeTest

```
public void setUp() throws Exception {<br>
createSeleniumClient("http://www.google.com");<br>
}

protected DefaultSelenium createSeleniumClient(String url) throws Exception {
    selenium =  new DefaultSelenium("localhost", 4444, "*firefox", url);
    selenium.start();
    selenium.setSpeed("2000");
    selenium.deleteAllVisibleCookies();
    return selenium;
} 
```

Am I doing something wrong here? I was able to run this locally through IntelliJ. Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T23:01:30.520

你确定你有同一个版本的 Selenium 服务器 jar 和 java 客户端 jar 吗？我不小心有服务器版本 0.9.2 和客户端 jar 1 beta 并且收到了这个错误。确保我使用 0.9.2 客户端 jar 进行编译为我解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T20:24:01.430

This may sound like a strange question, but are you really passing "url" literally in

```
createSeleniumClient("url"); 
```

"url" is no valid url and so I'd expect Selenium to complain here.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-26T14:46:26.223

您是否验证了您尝试执行测试的网络服务器正在运行 Selenium 服务器？该错误看起来像 RC 代码无法连接到服务器以开始测试......

我建议首先尝试在构建机器上手动执行测试，以确保一切配置正确。

# c# - 用于 C# 的 XML 注释的类似 Javadoc 的文档

> ID：841577
> 
> 赞同：8
> 
> 时间：2009-05-08T20:08:59.593
> 
> 标签：c#, xslt, documentation, comments, javadoc

我正在寻找将我的 C# XML 注释转换为文档的东西。我不喜欢 CHM 的，也不喜欢 MSDN 的外观和感觉。我喜欢使用 javadocs。它们易于导航，并且一切都可以访问。我正在寻找一种工具，可用于将代码中的注释转换为类似外观的 javadoc。

有什么可以做到这一点吗？我试过 Sandcastle 和它的各种 GUI，但他们没有做我想做的事。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-08T20:13:13.407

也许你可以使用[Doxygen](http://www.doxygen.nl/)？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-29T14:18:37.233

请参阅此问题[https://stackoverflow.com/questions/546053/anyone-using-ndoc-or-a-similar-tool-to-help-with-system-documentation/](https://stackoverflow.com/questions/546053/anyone-using-ndoc-or-a-similar-tool-to-help-with-system-documentation/) 您将在那里找到不同商业的简要概述和开源工具

我投票给[沙堡](http://www.codeplex.com/Sandcastle)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T20:21:32.230

ndoc 与 JavaDoc 非常相似。我会推荐它： http: [//ndoc.sourceforge.net/](http://ndoc.sourceforge.net/)

# python - python：我可以扩展 range() 方法的上限吗？

> ID：841584
> 
> 赞同：3
> 
> 时间：2009-05-08T20:10:49.247
> 
> 标签：python

range() 函数的上限是什么，如何扩展它，或者最好的方法是什么：

```
for i in range(1,600851475143): 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-08T20:13:01.377

`range(1, 600851475143)`想要在内存中生成一个非常大的列表，你会得到一个内存不足的错误。要节省内存，请使用`xrange`而不是`range`. 不幸的是，`xrange`不适用于大数字（这是一个实现限制）示例（引发 OverflowError）：

```
for i in xrange(1, 600851475143):
  print i 
```

`range`如果它们的差异很小，您的区间中可以有较大的最小值或最大值。例子：

```
x = 1 << 200
print list(xrange(x, x + 3)) 
```

输出：

```
[1606938044258990275541962092341162602522202993782792835301376L, 1606938044258990275541962092341162602522202993782792835301377L, 1606938044258990275541962092341162602522202993782792835301378L] 
```

您原来*的 for*循环问题的一个奇特的解决方案：

```
def bigrange(a, b = None):
  if b is None:
    b = a
    a = 0
  while a < b:
    yield a
    a += 1

for i in bigrange(1, 600851475143):
  print i 
```

一个不太花哨的解决方案，即使您`continue`在循环体中也可以使用：

```
i = 1 - 1
while i < 600851475143 - 1:
  i += 1
  print i 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T20:23:17.000

pts 的回答让我在 xrange python 文档中找到了这个：

> 笔记
> 
> xrange() 旨在简单快速。实现可能会施加限制来实现这一点。Python 的 C 实现将所有参数限制为原生 C long（“短”Python 整数），并且还要求元素的数量适合原生 C long。如果需要更大的范围，可以使用 itertools 模块制作替代版本： `islice(count(start, step), (stop-start+step-1)//step)`

看起来这是特别是c python的限制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T00:45:27.557

你有没有考虑过这样做？或者有什么你特别需要的理由`range()`？

```
x = 1
while x < 600851475143:
    // some code
    x += 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T20:25:18.993

这取决于您使用的 Python 版本。我正在使用 2.5.2 并且 xrange 会为大量数字引发 OverflowError 异常。一种解决方案是编写自己的生成器。

```
def g(start, stop):
    i = start
    while i < stop:
        yield i
        i += 1

x = 1<<200
for i in g(x, x+3):
    print i 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T20:47:19.117

这是使用[`itertools`](http://docs.python.org/library/itertools.html). 这有点做作，但它有效：

```
from itertools import repeat, count, izip
for i,_ in izip(count(1), repeat(1, 600851475143)):
    ... 
```

另一个答案是编写自己的生成器：

```
def my_xrange(a, b):
    while a < b:
        yield a
        a += 1

for i in my_xrange(1, 600851475143):
    ... 
```

# ruby-on-rails - 使用 || 在 Rails 中切换

> ID：841585
> 
> 赞同：17
> 
> 时间：2009-05-08T20:11:29.557
> 
> 标签：ruby-on-rails, switch-statement, case

我有一个部分，我只想在某些页面使用该布局时才在布局中显示。我已经为我的所有页面设置了@page_title，并认为我可以使用这样的东西：

```
<% case @page_title when "Log in" || "Forgot Your Password" || "Create a New Password" %><%= render :partial => "common/hello-world" -%><% end -%> 
```

但是，包含仅发生在标题为“登录”的页面上，而不是其他页面上。是|| 在 Case 开关上不允许这样的语句？有没有不同的方法在 case switch 中设置 OR 语句？

谢谢！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-08T20:17:04.097

这就是你想要的：

```
<% case @page_title when "Log in", "Forgot Your Password", "Create a New Password" %><%= render :partial => "common/hello-world" -%><% end -%> 
```

根据[http://docs.huihoo.com/ruby/ruby-man-1.4/syntax.html#case](http://docs.huihoo.com/ruby/ruby-man-1.4/syntax.html#case)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-08T20:17:04.363

使用`,`而不是`||`分隔之后的匹配项`when`。[在http://docs.huihoo.com/ruby/ruby-man-1.4/syntax.html#case](http://docs.huihoo.com/ruby/ruby-man-1.4/syntax.html#case)中查看更多关于 Ruby 语法的信息。

# c++ - Use NMAKE to make all source in a directory?

> ID：841597
> 
> 赞同：4
> 
> 时间：2009-05-08T20:15:27.627
> 
> 标签：c++, makefile, visual-c++, nmake

Using nmake, is it possible to have the makefile build all the .cpp files in the current directory automatically, without having to specify them individually?

So, instead of something like:

```
O = $(OBJ_DIR)/main.obj
{$(SOURCE_DIR)}.cpp{$(OBJ_DIR)}.obj:
    ---COMPILE $< HERE--- 
```

I'd like to avoid having to specify each obj to make. Can this be done?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2020-08-08T13:54:41.437

只是

```
main.exe: *.c resource.RES
    @$(MAKE) $(**:.c=.obj)
    link $(**:.c=.obj) /OUT:$@ 
```

你不需要添加任何东西！每次你`nmake`，`*.c`都会检查它是否被编译。

细节：

*   `$**`对于依赖项
*   `$@`为目标
*   `$(**:.c=.obj)`是字符串替代品，将`.c`后缀替换为`.obj`. 说到`resource.RES`，它不会取代任何东西。

请注意，有一个递归调用，这是最优雅的方法。否则，有必要以`*.c`脚本之类的方式获取所有文件名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T20:41:40.170

您可以使用这样的规则：

```
{src\mystuff}.c{tmp\src\mystuff}.obj::
    $(CC) /nologo $(CFLAGS) /c /Fotmp\src\mystuff\ $< 
```

它将查找并编译所有`.c`文件`src\mystuff`并将目标文件放入`tmp\src\mystuff`. 代替你`.cpp`的`.c`情况。

请注意，第二行的第一个字符应该是制表符，而不是空格。

此外，`$(CC)`由 nmake 预定义为`cl`，您可以根据需要添加任何编译器标志`$(CFLAGS)`，在规则中对其进行硬编码或添加不同的变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T20:46:36.150

```
.cpp.obj:
    $(CC) $(CFLAGS) $*.cpp 
```

是一个默认规则，它将自动从 .cpp 文件中解析 .obj 依赖项...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-06T02:56:40.083

一种可能性是将 make 包装在脚本中。

要么使用 for 循环，在每个 .cpp 文件上调用 make，要么构造一个 cpp 文件列表并将其用作 makefile 的参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-07T15:57:09.390

您可以在 nmakefile 预处理期间运行 shell 命令，然后运行`!include`输出。自然地，输出需要采用 nmake 格式。就像是：

```
!if [bash -c "echo O = *.cpp" >sources.mak]
!error Failed to generate source list
!endif
!include sources.mak

all: $(O:.cpp=.obj)

.cpp.obj:
    ---COMPILE $< HERE--- 
```

我怀疑大多数人不会使用*bash*来创建`sources.mak`，但你明白了。

# linq - How can I Fill a Dataset with data from an IQueryable?

> ID：841598
> 
> 赞同：0
> 
> 时间：2009-05-08T20:16:03.850
> 
> 标签：linq, ado.net

Is there any quick way to create a table in a dataset and fill it with the schema from an IQueryable (Data is not coming from EF or Linq2Sql)? I need this for binding a grid to my data.

Thanks, Roy

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T21:14:00.297

您可以使用 System.Data.Linq.DataContext 类的 Translate 功能“自动”将 Table 映射到 Class。

有一个例子：

```
using System.Data.Linq;
using System.Data.SqlClient;

    string cnnStr = "YourConnectionString";
    DataContext dc = new DataContext(cnnStr);
    SqlConnection sqlCnn = (SqlConnection) dc.Connection;
    sqlCnn.Open();
    SqlCommand sqlCmd = new SqlCommand("select ID, Name, [Date] From test", sqlCnn);
    SqlDataReader sqlDr = sqlCmd.ExecuteReader();
    var result = dc.Translate<clsRow>(sqlDr);
    foreach(clsRow row in result)
    {
       Console.Write(row.ID);
       Console.Write(row.Name);
       Console.Write(row.Date);
    } 
```

在这种情况下，您需要一个名为 Test 的表，其中包含 3 列：ID、Name 和 Test，还需要一个在 .Net 中名为 clsRow 的类，该类具有与表列相同的属性名称。

```
public class clsRow
{
    public int ID { get; set; }
    public string Name { get; set; }
    public DateTime Date { get; set; }
} 
```

# wpf - WPF 内存使用情况

> ID：841602
> 
> 赞同：11
> 
> 时间：2009-05-08T20:16:46.127
> 
> 标签：wpf, performance, memory-management, listbox, datatemplate

## 应用：

*   WPF 应用程序由顶部的文本框和下方的列表框组成
*   用户在TextBox中输入字符串查找员工，搜索结果显示在ListBox中
*   ListBox 使用 DataTemplates 来显示元素（显示员工姓名、部门、​​电话和缩略图。）

## 执行：

*   在应用程序启动时，我查询数据库并检索要显示在 ListBox 中的所有员工和相关信息。这一直保存在内存中。
*   应用程序启动后，所有可搜索的数据都在内存中，搜索几乎是即时的。所有搜索都在内存中的数据上执行。
*   搜索结果使用 DataTemplates 显示在 ListBox 中。缩略图、姓名、电话、部门等显示在每个 ListBox 项中。

## 问题：

*   启动时内存使用量约为 200MB。
*   随着列表框中的数据发生变化，无论是通过新搜索还是简单地向下滚动列表框，内存消耗都会增加。
*   当用户缓慢向下滚动列表框时，内存增加得更快。当您上下滚动时，内存迅速达到 1GB。

没有手动创建控件的代码 - 一切都是通过数据绑定完成的。

为什么我会看到这种行为？我能做些什么来修复它？请帮忙！

更新：我发现问题不是内存泄漏。这里的问题是列表框正在创建对象以显示员工的图像，并且在列表框项离开窗口后没有为垃圾收集器释放。CleanUpVirtualizedItem 事件如我所料发生，但内存仍未释放。有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-08T20:26:03.937

冒着油嘴滑舌的风险，你有内存泄漏。为什么不尝试使用像[ANTS](http://www.red-gate.com/products/ants_profiler/index.htm) * 这样的工具来追踪它。他们有免费试用版，我从未使用过它，但它有很好的声誉。

*其他分析工具可用。

如果您不想使用其他工具，您可以尝试在每次创建类时增加静态成员并在每次处置实例时减少它。这将帮助您追踪未正确销毁的实例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T09:43:25.923

你可以使用

[WPF 性能套件](http://msdn.microsoft.com/en-us/library/aa969767.aspx)

[优化 WPF 应用程序性能](http://msdn.microsoft.com/en-us/library/aa970683.aspx)

一个类似的问题困扰着我.. [（类似）](https://stackoverflow.com/questions/356645/exception-of-type-system-outofmemoryexception-was-thrown-why)

在应用程序启动时，我查询数据库并检索要显示在 ListBox 中的所有员工和相关信息。这一直保存在内存中。

也许您可以修改您的代码以遵循[WPF：数据虚拟化](http://www.codeproject.com/KB/WPF/WpfDataVirtualization.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T16:21:32.590

它似乎真的是内存泄漏。可能，DataTemplate 中的一些 UI 元素保留对其他对象的引用，即使 UI 元素被销毁，这些对象也应该保持活动状态。

图像控件可能存在一些内存泄漏。尝试从模板中删除它并查看结果。另外，您是否订阅了控件加载事件或类似事件中的任何事件？

不过只是一些猜测......正如人们在这里所说的那样，您可能真的想用性能和内存分析器来查看您的应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T18:46:10.020

我注意到在看似无害的情况下，WPF 和 .NET 3.5 SP1 内存问题存在一些问题。

我确实找到了一些资源，但我不确定它们是否会对您有所帮助：

[http://blog.ramondeklein.nl/?p=58](http://blog.ramondeklein.nl/?p=58)

那篇博客文章描述了一种情况，当

> 1.  样式在应用程序的 ResourceDictionary 中定义。
> 2.  该样式使用使用媒体效果（即 DropShadowEffect）的控件模板。
> 3.  应该使用 StaticResource 引用媒体效果

简而言之，我认为您的解决方案是确保任何媒体效果（投影等）都使用静态资源。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T20:59:10.537

对我帮助很大的一件事是使用包装 Stream 类的类。这在[这里](http://code.logos.com/blog/2008/04/memory_leak_with_bitmapimage_and_memorystream.html)详细解释，果然我使用这种方法节省了很多内存。WPF 确实保留了对每张图片的底层 byte[] 和流的引用。

# linux - 如何在 Ubuntu/Linux 上启动和定位多个应用程序？

> ID：841609
> 
> 赞同：0
> 
> 时间：2009-05-08T20:17:43.473
> 
> 标签：linux, scripting, ubuntu

在我的新工作中，我正在做 Rails 开发，我在 Ubuntu（我的选择）上。我想启动 emacs 和 2 或 3 个终端，定位它们，并可能 cd 到目录。

我一直在寻找，但似乎找不到任何可以做到这一点的应用程序。

我在这里问这个，因为如果没有人知道的应用程序，这将是一个编程问题，我如何以 KISS 方式完成此任务（小红宝石脚本或其他东西）。

所以：您是否有任何应用程序可以执行我想要的操作，或者如果失败，您是否知道自己以编程方式执行此操作的简单方法（我不在乎什么语言/框架）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T20:28:42.650

许多命令都接受一个`-geometry`参数（例如，xterm 接受，所以你的终端就在那里）。我不确定 Ubuntu 是如何处理这些东西的，但是在 Slackware 上我只是将我想要运行的命令放在我的`~/.xinitrc`文件中。它只是一个在 X 出现时运行的脚本，所以你可以用它来运行你的窗口管理器，以及你想用 X 提供的任何应用程序。

ED：ISTR 也有许多桌面环境，比如 Gnome/KDE/XFCE，甚至 CDE 都支持某种“注销时保存会话”的东西。您可以简单地按照您想要的方式布置您的窗口和应用程序，然后注销，保存会话，然后不要单击该框以保存您的会话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T20:30:21.930

编写一个启动 emacs 和 gnome-terminal 的 shell 脚本。要在某个目录中启动，可能有一个命令行选项；例如，在 Konsole 中，您可以运行“ `konsole --workdir ~`”来访问您的主目录。

亚当有一个很好的定位建议。再次在 KDE 中，另一种方法是编辑 emacs 和 gnome-terminal 窗口的默认设置以从特定的大小和位置开始（尽管这可能会因多个 gnome-terminals 而崩溃，因为它们都在同一个位置）。

编辑：gnome-terminal 的选项是“ `--working-directory`”。

# sql-server - 在 SQL Server 和强类型数据集中处理空 GUID

> ID：841610
> 
> 赞同：1
> 
> 时间：2009-05-08T20:19:21.627
> 
> 标签：sql-server, guid, strongly-typed-dataset, tableadapter, null-uniqueidentifier

我在 SQL Server 中有一个表：

```
Categories
--------------
CategoryID (uniqueidentifier)
ParentCategoryID (uniqueidentifier) allow nulls 
```

ParentCategoryID 用于在 CategoryID 中保存一个值，以指示哪个类别是父类别。如果它没有父类（即它是顶级类别），则 ParentCategoryID 应该为空。

我正在使用强类型数据集（表适配器），并且对于 ParentCategoryID 的属性，它不允许它为空。我试图更改类型化数据集中字段的属性，但它说试图使 guid “空”或“无”是无效的。唯一的选择是在 null 上引发异常。这会导致错误：

表 'Categories' 中列 'ParentCategoryID' 的值为 DBNull。

是这样吗，还是有办法在使用类型化数据集时处理空 GUID/唯一标识符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T21:19:51.747

如果您使用了 Visual Studio 生成器并且为您的表正确检测到所有内容，则可为空的列将在您的强类型 DataRow 上生成以下内容：

1.  为表列名命名的公共属性（“ParentCategoryID”）
2.  检测空条目的公共方法（“bool IsParentCategoryIDNull()”）
3.  将条目“归零”的公共方法（“void SetParentCategoryIDNull()”）

鉴于您的强类型表名为“My”（生成`MyDataTable`和`MyDataRow`），您`DataSet`的名为`MyDataSetType`，实例名为`myDataSet`：

```
MyDataSetType.MyRow row = myDataSet.My.NewMyRow();
row.ParentCategoryID = Guid.Empty; //OPTION 1: explicitly set GUID
row.SetParentCategoryIDNull(); //OPTION 2: explicitly set Null
myDataSet.My.AddMyRow(row); 
```

您还可以查看实现`SetParentCategoryID`以查看用于执行“归零”的内容。

此外，要检测“空 guid”：

```
if (row.IsParentCategoryIDNull())
{
  //Do something spectacular
} 
```

所以现在你有三种不同类型的值来表示状态：

1.  数据库/数据集中的空条目（无父类别）
2.  数据库中的非空条目（可能是父类别）
3.  `Guid.Empty`数据库中为空 ( ) guid (???)的非空条目

当我第一次遇到这个问题时，我认为`Guid.Empty`应该用它来表示数据库中的空条目，但这需要自定义处理 guid 类型。使用包装函数，强类型数据集可以基于结构样式类型提供对任意数量的可空列的一致处理。

# parsing - Rules based parsing for configuration files

> ID：841611
> 
> 赞同：0
> 
> 时间：2009-05-08T20:19:45.073
> 
> 标签：parsing, rules

What is the best method to implement a system for parsing a configuration file based on a set of rules? I would appreciate any pointers in the direction of best practices or existing implementations.

Edit: I have not decided not choice of any specific language yet but I am comfortable with both Perl and Python. The files are something along Router/Switch configuration files with different functional sections.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T20:43:59.180

假设这不是基于 XML 的配置文件，我可以[推荐](http://www.transitionchoices.com/cgi-bin/article.pl?id=9) [ANTLR](http://www.antlr.org/)吗？

*   根据您提供的 EBNF 样式语法规则文件生成解析器代码。
*   具有规则文件的图形编辑器作为 Eclipse 插件。
*   非常强大和健全的解析器技术
*   灵活地处理解析后的输出
*   运行时环境允许在 C++、C、C#、Java、Python 和 Ruby 应用程序中使用 ANTLR 进行解析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T20:32:44.800

如果您正在考虑 XML 并使用 Java，您可以尝试我的 XML 解析器生成器 ANTXR，它基于 ANTLR 2.7.x

详见[http://javadude.com/tools/antxr/index.html](http://javadude.com/tools/antxr/index.html) _

一个例子：

XML 文件：

```
<?xml version="1.0"?>
<people>
  <person ssn="111-11-1111">
    <firstName>Terence</firstName>
    <lastName>Parr</lastName>
  </person>
  <person ssn="222-22-2222">
    <firstName>Scott</firstName>
    <lastName>Stanchfield</lastName>
  </person>
  <person ssn="333-33-3333">
    <firstName>James</firstName>
    <lastName>Stewart</lastName>
  </person>
</people> 
```

解析器骨架：

```
header {
package com.javadude.antlr.sample.xml;
}

class PeopleParser extends Parser;

document
  : <people> EOF;

<people>
  : (<person>)*
  ;

<person> 
  : ( <firstName>
    | <lastName>
    )*
  ;

<firstName>
  : PCDATA
  ;

<lastName>
  : PCDATA
  ; 
```

一个实际处理数据的解析器：

```
header {
package com.javadude.antlr.sample.xml;

import java.util.List;
import java.util.ArrayList;
}

class PeopleParser extends Parser;

document returns [List results = null]
  : results=<people> EOF
  ;

<people> returns [List results = new ArrayList()]
  { Person p; }
  : ( p=<person>  { results.add(p); }   )*
  ;

<person> returns [Person p = new Person()]
  { String first, last; }
  : ( first=<firstName>  { p.setFirstName(first); }
    | last=<lastName>    { p.setLastName(last);   }
    )*
  ;

<firstName> returns [String value = null]
  : pcdata:PCDATA { value = pcdata.getText(); }
  ;

<lastName> returns [String value = null]
  : pcdata:PCDATA { value = pcdata.getText(); }
  ; 
```

我已经使用它多年了，当我在工作中向人们展示它时，在最初的“习惯语法”学习曲线之后，他们真的很喜欢它。

请注意，您可以使用 SAX 或 XMLPull 前端（如果您愿意，前端可以进行验证）。运行解析器的代码看起来像

```
// Create our scanner (using a simple SAX parser setup)
BasicCrimsonXMLTokenStream stream =
    new BasicCrimsonXMLTokenStream(new FileReader("people.xml"),
                                   PeopleParser.class, false, false);

// Create our ANTLR parser
PeopleParser peopleParser = new PeopleParser(stream);

// parse the document
peopleParser.document(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T14:42:41.310

我经常将 YAML 用于配置文件，它是轻量级的，并且有大量的库以不同的语言支持它。

[http://www.yaml.org/](http://www.yaml.org/)

# wpf - Type of object created by ListCollectionView.AddNew

> ID：841616
> 
> 赞同：5
> 
> 时间：2009-05-08T20:20:38.707
> 
> 标签：wpf, listcollectionview

How does `ListCollectionView.AddNew` determine the type of object it creates, and how could one affect it?

I have a hierarchy of a few types (`Base`, `DerivedA`, and `DerivedB`), and currently my WPF Toolkit `DataGrid` creates `DerivedA` objects (why, I don't know -- probably because almost all the data in the grid is of that type), but I'd like it to create `DerivedB` objects instead.

**Update**: I've tried deriving a new class from `ListCollectionView` and implementing a new `AddNew` method for it, and now I'm almost there: the only remaining problem is that after adding a new item, a new new item placeholder isn't added, so I can only add one item. My current approach looks somewhat like this:

```
public class CustomView : ListCollectionView, IEditableCollectionView
{
    public CustomView(System.Collections.IList list)
        : base(list)
    {
    }

    object IEditableCollectionView.AddNew()
    {
        DerivedB obj = new DerivedB();
        InternalList.Add(obj);
        return obj;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-01-30T00:42:29.507

陈旧的问题值得新的答案:)

派生一个类`ListCollectionView`是我用来控制被添加的对象的路径`AddNew`，但是在浏览了源代码`ListCollectionView`以找出它在内部做什么之后，我发现重新定义的最安全的方法`AddNew`（它在技术上不是一个覆盖）是在创建我的新对象后使用`ListCollectionView.AddNewItem`，因此您的代码如下所示：

```
public class CustomView : ListCollectionView, IEditableCollectionView 
{ 
    public CustomView(System.Collections.IList list) 
        : base(list) 
    { 
    } 

    object IEditableCollectionView.AddNew() 
    { 
        DerivedB obj = new DerivedB(); 
        return base.AddNewItem(obj); 
    } 
} 
```

这很好用，因为除了具有几乎相同的实现之外，`ListCollectionView.AddNew()`两者`ListCollectionView.AddNewItem(object item)`都调用`AddNewCommon(object newItem)`：

```
public object AddNew() 
{ 
    VerifyRefreshNotDeferred();

    if (IsEditingItem)
        CommitEdit();   // implicitly close a previous EditItem

    CommitNew();        // implicitly close a previous AddNew 

    if (!CanAddNew)
        throw new InvalidOperationException(SR.Get(SRID.MemberNotAllowedForView, "AddNew")); 

    return AddNewCommon(_itemConstructor.Invoke(null));
}

public object AddNewItem(object newItem)
{
    VerifyRefreshNotDeferred(); 

    if (IsEditingItem) 
        CommitEdit();   // implicitly close a previous EditItem

    CommitNew();        // implicitly close a previous AddNew

    if (!CanAddNewItem) 
        throw new InvalidOperationException(SR.Get(SRID.MemberNotAllowedForView, "AddNewItem"));

    return AddNewCommon(newItem); 
} 
```

`AddNewCommon`是所有真正的魔法发生的地方；触发事件，在支持的情况下调用新项目，`BeginInit`并`BeginEdit`最终通过数据网格上的回调，建立单元格绑定：

```
object AddNewCommon(object newItem)
{
    _newItemIndex = -2; // this is a signal that the next Add event comes from AddNew
    int index = SourceList.Add(newItem); 

    // if the source doesn't raise collection change events, fake one 
    if (!(SourceList is INotifyCollectionChanged)) 
    {
        // the index returned by IList.Add isn't always reliable 
        if (!Object.Equals(newItem, SourceList[index]))
            index = SourceList.IndexOf(newItem);

        BeginAddNew(newItem, index); 
    } 

    Debug.Assert(_newItemIndex != -2 && Object.Equals(newItem, _newItem), "AddNew did not raise expected events"); 

    MoveCurrentTo(newItem);

    ISupportInitialize isi = newItem as ISupportInitialize; 
    if (isi != null)
        isi.BeginInit(); 

    IEditableObject ieo = newItem as IEditableObject;
    if (ieo != null)
        ieo.BeginEdit(); 

    return newItem; 
} 
```

在这里，我将源代码包含在 my中，当我不知道在设计时需要什么类型时`TypedListCollectionView`，我用它来控制行为：`AddNew`

```
public class TypedListCollectionView : ListCollectionView, IEditableCollectionView
{
    Type AddNewType { get; set; }

    public TypedListCollectionView(System.Collections.IList source, Type addNewType)
        : base(source)
    {
        AddNewType = addNewType;
    }

    object IEditableCollectionView.AddNew()
    {
        object newItem = Activator.CreateInstance(AddNewType);
        return base.AddNewItem(newItem);
    }
} 
```

`AddNew`我喜欢这种方法，因为它为's 类型可能需要在运行时从一个调整到另一个的情况提供了最大的灵活性。它还允许`AddNew`添加集合中的第一项，这在列表源最初为空时很方便，但可以确定其基础类型。

[此链接](http://social.msdn.microsoft.com/Forums/en/wpf/thread/381dfbbd-1e9a-4a79-8a40-87b4d8767264)讨论了强制使用的类型的另一种方法`AddNew()`。它使用反射将私有`_itemConstructor`属性设置`AddNew`为指定类型的无参数构造函数。当您来自不受您影响的组件时，这将特别有用`ListCollectionView`，或者您需要在现有代码中添加功能并且您担心会破坏某些东西（我从来没有这样做，因为我是一个冷酷无情的骑士编码员与收藏）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T13:04:09.797

在 .NET 4 中，现在有一个[`IEditableCollectionViewAddNewItem`](http://msdn.microsoft.com/en-us/library/system.componentmodel.ieditablecollectionviewaddnewitem.aspx)由 实现的新接口`ListCollectionView`，它拥有一个新方法`AddNewItem(object)`。您可以使用它来代替`AddNew()`控制新添加的项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T20:30:44.893

TomiJ,

see if it helps, but isn't the answer ok?

[http://www.cnblogs.com/winkingzhang/archive/2008/05/22/1204581.html](http://www.cnblogs.com/winkingzhang/archive/2008/05/22/1204581.html)

# c++ - C++ constructor problem

> ID：841619
> 
> 赞同：2
> 
> 时间：2009-05-08T20:22:51.260
> 
> 标签：c++

```
#include <iostream>
using namespace std;

// This first class contains a vector and a scalar representing the size of the vector.
typedef class Structure1
{
 int N;
 double* vec;
public: 
 // Constructor and copy constructor:
 Structure1(int Nin);
 Structure1(const Structure1& structurein);
 // Accessor functions:
 int get_N() { return N; }
 double* get_vec() { return vec; }
 // Destructor:
 ~Structure1() { delete []vec; }
} Structure1;

Structure1::Structure1(int Nin)
{
 N = Nin;
 vec = new double [N];
 for (int i = 0; i < N; i++)
  {
   vec[i] = i;
  };
}

Structure1::Structure1(const Structure1& structurein)
{
 vec = new double[structurein.N];
 for(int i = 0; i < structurein.N; i++)
 {
  vec[i] = structurein.vec[i];
 };
}

// This class just contains the first structure.
typedef class Structure2
 {
  Structure1 structure;
 public:  
  // Constructor:
  Structure2(const Structure1& structurein) { structure = structurein; } 
```

The error occurs here:

Line Location main.cpp:47: error: no matching function for call to 'Structure1::Structure1()'

```
 // Accessor Function:
  Structure1 get_structure() { return structure; }
  // Destructor:
  ~Structure2() {}
 } Structure2;

int main (int argc, char * const argv[])
{
 const int N = 100;
 Structure1 structure1(N);
 Structure2 structure2(structure1);

 return 0;
} 
```

If anyone knows what's wrong, your help would be greatly appreciated. Thanks!

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T20:26:23.560

You need to use a member initializer in your Structure2 ctor.

```
Structure2(const Structure1& structurein) : structure(structurein) {} 
```

It's trying to use a default constructor for your Structure1 member, and there isn't one.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T20:34:23.620

By the way, I think you need to fix the copy constructor:

```
Structure1::Structure1(const Structure1& structurein)
{
 ///!!!! Initialize N
 N = structurein.N;

 vec = new double[structurein.N];
 for(int i = 0; i < structurein.N; i++)
 {
  vec[i] = structurein.vec[i];
 };
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T20:28:07.817

Since you have declared a constructor for Structure2, the compiler refuses to create a default constructor for it which is needed in order to access members of the class like you do in this constructor:

```
 Structure2(const Structure1& structurein) { structure = structurein; } 
```

You should probably do:

```
Structure2(const Structure1& structurein) : structure(structurein) {} 
```

# java - Why isn't bitronix (BTM) binding the user transaction into JNDI?

> ID：841622
> 
> 赞同：1
> 
> 时间：2009-05-08T20:24:09.697
> 
> 标签：java, jta, bitronix

Looks like Bitronix, as suggested elsewhere, works very well. However, I'm stumped by a problem with it. I get this exception from Hibernate, when I attempt to save the session *after* I call `TransactionManager.begin()`:

```
14:21:32,350 ERROR [JTATransaction] Could not find UserTransaction in JNDI
javax.naming.NameNotFoundException: Name UserTransaction is not bound in this Context
    at org.apache.naming.NamingContext.lookup(NamingContext.java:769) 
```

I can't see any evidence that Bitronix binds the user transaction to JNDI. How do I make it do that?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T14:01:27.537

这是在这里回答：[https ://github.com/bitronix/btm/blob/master/btm-docs/src/main/asciidoc/Hibernate2x.adoc#txManager](https://github.com/bitronix/btm/blob/master/btm-docs/src/main/asciidoc/Hibernate2x.adoc#txManager)

简而言之，除非您自己更改 Tomcat 配置，否则 BTM 无法自动将自身绑定到 Tomcat 的 JNDI 服务器。这在这里解释：[https ://github.com/bitronix/btm/blob/master/btm-docs/src/main/asciidoc/TomcatWithBtm2x.adoc](https://github.com/bitronix/btm/blob/master/btm-docs/src/main/asciidoc/TomcatWithBtm2x.adoc)

# asp.net - ASP.NET URL Routing with WebForms - Using the SiteMap

> ID：841624
> 
> 赞同：2
> 
> 时间：2009-05-08T20:24:26.297
> 
> 标签：asp.net, url-routing, sitemap

I'm trying to use Url Routing within my existing ASP.NET WebForms site. Thanks to: [this link](http://msdn.microsoft.com/en-us/magazine/2009.01.extremeaspnet.aspx), I got it working. Now I'm trying to use a SiteMap along with my routing.

I have a page MyReport.aspx. It is in the SiteMap and accessing the page directly, works fine. I've added a route for /report/{param1}/{param2}. I was hoping the sitemap would resolve the route path (MyReport.aspx) instead of /report/{param1}/{param2}, but no dice.

I have seen examples of using the [SiteMap with MVC](http://blog.maartenballiauw.be/post/2008/08/29/Building-an-ASPNET-MVC-sitemap-provider-with-security-trimming.aspx), but this makes assumptions about having controllers and such, none of which exist with a standard webform.

The approach I'm trying now is to retrieve the actual page within a custom SiteMapProvider, but I'm not seeing a way to do this. Is there a way to get the actual ASPX page instead of the Url from the HttpContext?

Thanks, -Damien

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T05:03:46.800

Damien - 我最近发布了一个可能有用的示例。谷歌搜索“asp.net 路由站点地图”应该可以让你到达那里（只是刚刚加入所以不能发布链接）。

仅供参考，您可以使用 SiteMap.SiteMapResolve 事件而不是创建自定义 SiteMapProvider（至少对于简单的场景）。

希望能帮助到你！

# .net - Automatically updating a file with Revision from TFS?

> ID：841625
> 
> 赞同：4
> 
> 时间：2009-05-08T20:24:53.953
> 
> 标签：.net, tfs, msbuild

I'm quite new to TFS (actually I only use it because I have some projects on CodePlex and did not want to go through svnbridge), and I'm looking for something equivalent to the $Revision$ parameter in SVN.

Essentially on checkout, I want to update a file to contain the newest Revision number, to be displayed as Version number (just like at the bottom of SO).

Is there anything already built-in in msbuild of .net 3.5 SP1, or any official/standard msbuild task, or even something equivalent of just dropping $Revision$ and having the TFS client do the magic on checkout?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T23:35:44.463

TFS 目前不支持关键字扩展。这常常让人们大吃一惊。以下是有关该主题的几篇博客文章，如果您想为该功能投票，您还可以在那里找到一个链接，将您带到 Microsoft 网站。我知道这是团队不时被要求的东西 - 但他们还没有遇到真正*需要*关键字扩展的任何人，只是很多人有点习惯了。

无论如何 - 读一读，看看你的想法。

*   [Buck Hodges - TFS 中的关键字扩展](http://blogs.msdn.com/buckh/archive/2007/07/07/keyword-expansion-in-tfs.aspx)
*   [我 - 为什么有关键字扩展？](http://www.woodwardweb.com/programming/why_have_keywor.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T04:39:07.670

迈克尔，

在 Team Build 中，您可以使用 $(SourceGetVersion) 变量访问正在构建的变更集编号。您可以覆盖 AfterGet 或 BeforeCompile 可扩展性目标，并将此变量的内容推送到您需要的任何文件中。

问候，

William D. Bartholomew（团队系统 MVP）

# indexing - 我的文件（图像）名称可以太长吗？

> ID：841632
> 
> 赞同：1
> 
> 时间：2009-05-08T20:26:18.443
> 
> 标签：indexing, seo, photoshop, filenames

从 Photoshop 输出超过 31 个字符的图像时，我收到一条兼容性消息？使图像名称（或任何文件名）过长有缺点吗？

我想确保我的网络应用程序在所有主要浏览器（包括移动设备）中正确显示我的图像，并且我的图像名称被 Google 提取用于索引。

例如，如果我有一辆正在销售的福特雷鸟，理想情况下，我希望我的图片名称对可用性和排名都有很好的描述性，即 ford_thunderbird_sports_car_large.jpg .. 文件大小相对于缩略图来说，较大。 ..

但是，这是一个较长的文件名，可能会导致某些浏览器看不到它。

有人有想法吗？2009 年的最佳做法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T20:39:51.673

我很确定任何现代操作系统中的最大文件长度至少为 255 个字符。这是一个维基百科链接：[文件系统的比较](http://en.wikipedia.org/wiki/Comparison_of_file_systems#Limits)

至于网络，我怀疑你会达到[这些限制](http://www.boutell.com/newfaq/misc/urllength.html)。你应该没事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T20:39:41.500

我认为存储这些描述性数据的最佳位置是图像的元数据（这应该可以在 Photoshop 中编辑），这将是一种使文件名更短并仍然保留描述的方法（您仍然可以使用一些标志或缩写但是，在文件名中）。

编辑：这是Photoshop 不发出警告的[解决方法。](http://www.electrictoolbox.com/change-adobe-photoshop-filename-compatibility-options/)似乎这是一些特定于 Mac 的东西。

# iphone - iPhone：什么是跳板？我需要关心吗？

> ID：841640
> 
> 赞同：3
> 
> 时间：2009-05-08T20:27:56.520
> 
> 标签：iphone

在模拟器中创建 iPhone 应用程序时，有时会看到“Springboard 无法启动应用程序”等消息。

什么是跳板？作为开发人员，我应该了解哪些事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T20:29:57.233

[Springboard](https://stackoverflow.com/questions/300793/iphone-simulator-springboard-failed-to-launch-application-with-error-7)只是 iPhone 的主屏幕应用程序。

这个[相关的问题](https://stackoverflow.com/questions/300793/iphone-simulator-springboard-failed-to-launch-application-with-error-7)可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T20:31:06.513

Springboard 是启动器应用程序——即您在主屏幕上看到的带有所有平铺应用程序图标的应用程序。

我不认为你真的需要知道更多关于它的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T20:33:31.390

Springboard 是您的应用程序在其中运行的 iPhone 模拟器。如果 Springboard 只是定期无法启动您的应用程序，则 Springboard 可能有问题，但如果您的应用程序根本无法启动，则您的应用程序可能有问题（如果它部署在真实手机上，则不会在那里启动， 任何一个）。

# asp.net - How can I get a date after 10 days ? in asp.net

> ID：841644
> 
> 赞同：2
> 
> 时间：2009-05-08T20:29:33.867
> 
> 标签：asp.net, date

This code returns today's date:

```
 Dim next10days As Date = Date.Now 
```

But how can I get the date for the 10th day from today?

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-08T20:31:35.560

```
Dim next10days As Date = Date.Now.AddDays(10) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-08T20:57:19.460

**1.如果您要简单地返回值：**

```
//C#
return DateTime.Now.AddDays(10);

//VB
Return Date.Now.AddDays(10) 
```

**2.如果你真的只想要一个变量，你可以使用：**

```
//C#
var MyDate10DaysFromNow = DateTime.Now.AddDays(10);

//VB
Dim MyDate10DaysFromNow as Date = Date.Now.AddDays(10) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T20:44:46.980

[msdn 参考](http://msdn.microsoft.com/en-us/library/system.datetime.adddays.aspx)

```
 ' Calculate what day of the week is 10 days from this instant.
Dim today As System.DateTime
Dim answer As System.DateTime

today = System.DateTime.Now
answer = today.AddDays(10)

System.Console.WriteLine("{0:dddd}", answer) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T21:24:51.627

```
Dim next10days As Date = Date.Now.AddDays(10) 
```

虽然从技术上讲，它应该是`Date.Today`，不是`Date.Now`，因为`Now`它还包括时间，而您只想要一个日期。

# c - #define 是否应该在宏周围添加空格？

> ID：841646
> 
> 赞同：3
> 
> 时间：2009-05-08T20:29:35.627
> 
> 标签：c, gcc, macros, whitespace, c-preprocessor

我正在查看[http://www0.us.ioccc.org/1988/westley.c上的程序，在](http://www0.us.ioccc.org/1988/westley.c)[另一个 SO 答案](https://stackoverflow.com/questions/19/fastest-way-to-get-value-of-pi/39512#39512)中提到- 它应该打印 pi 的值，大约 3.142，但是当我编译它并运行时我明白了`0.250`。看起来当 GCC 预处理器（4.1.2 和 3.4.6 测试）在代码上运行时，它转换

```
#define _ -F<00||--F-OO--;
_-_-_ 
```

到

```
-F<00||--F-OO--;- -F<00||--F-OO--;- -F<00||--F-OO--; 
```

但我认为，要让程序正常运行，它应该是

```
-F<00||--F-OO--;--F<00||--F-OO--;--F<00||--F-OO--; 
```

即 GCC 在“宏”扩展之前插入了一个额外的空间。这`#define`是应该的方式吗？（自 1988 年以来情况发生了变化吗？）

*编辑*：此外，任何有关如何防止这些空间出现的信息都将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-08T21:09:19.543

只有更老的预处理器没有插入额外的空间——请注意，原始条目是在 20 多年前的 1988 年提交的，在 1989 年版本的 C 标准标准化之前。您可以将`-traditional-cpp`标志传递给 GCC 预处理器，使其模仿老式 C 预处理器的行为，而不是 ISO C 预处理器。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-08T20:42:02.180

预处理器对标记进行操作，而不是严格的文本。所以从技术上讲，它不会在两者之间“放置一个空格”，但除非你明确告诉它将两个标记与`##`运算符一起粘贴，否则它不会这样做。在这种情况下，`-`跨宏行的两个 's 被视为两个不同的标记 - 都表示一元减号，而不是减量。

另见：[http ://en.wikipedia.org/wiki/C_preprocessor#Token_concatenation](http://en.wikipedia.org/wiki/C_preprocessor#Token_concatenation)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-08T20:44:42.177

来自 C99 标准：

> 形式的预处理指令
> 
> # 定义标识符替换列表换行
> 
> 定义了一个类似对象的宏，它使宏名称的每个后续实例都被构成指令其余部分的预处理标记的替换列表替换。

因此，宏在令牌上起作用，并且可以预期出现空白。

并且您可以使用令牌粘贴运算符 获得所需的输出`##`，但是您需要使用一些进一步的宏丑来做到这一点：

```
#define PASTE2( x, y) x##y
#define PASTE( x, y) PASTE2(x, y)

#define _ -F<00||--F-OO--;

PASTE(PASTE(PASTE(PASTE(_,-),_),-),_) 
```

所以我不确定这对你来说是不是一个真正的答案。

您可以使用一组不那么难看的宏来获得您想要的表达式 - 仍然会有一些空格，但这些空格不会干扰创建 ' `--`' 运算符：

```
_ PASTE(-,_) PASTE(-,_) 
```

不过，我仍然怀疑这就是你想要的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-08T20:31:49.197

是的，gcc 正在插入额外的空格（通过检查 ( 的标准输出输出来验证`gcc -E westley.c`。据我所知，这种行为符合标准。

# python - Pygame 找不到包含文件“sdl.h”

> ID：841654
> 
> 赞同：4
> 
> 时间：2009-05-08T20:31:04.203
> 
> 标签：python, sdl, pygame

我正在尝试在使用 Pygame 的 Windows 上构建下载的 Python 应用程序。我已经安装了 Python 2.5 和 Pygame 1.7.1。我是 Python 新手，但我只是尝试在 Windows 控制台命令行上键入顶级 .py 文件的名称。（我使用的是 Win XP Pro。）

这是我得到的信息。

**C:\Python25\include\pygame\pygame.h(68)：致命错误 C1083：无法打开包含文件：'SDL.h'：没有这样的文件或目录**

我认为 Pygame 是建立在 SDL 之上的，不需要单独安装 SDL。尽管如此，我还是安装了 SDL 1.2.13 并将 SDL 包含文件夹添加到我的 %INCLUDE% 环境变量中。仍然没有运气。

我注意到**C:\Python25\Lib\site-packages\pygame**包含几个 SDL*.DLL 文件，但是 python 树中的任何地方都没有 sdl.h 头文件。当然，我可以将 sdl 头文件复制到**C:\Python25\include\pygame**文件夹中，但这是一个令人讨厌的想法。

有人知道设置的正确方法吗？

**编辑：** 该应用程序是[“企鹅机器”pygame 应用程序](http://pygame.org/project/139/)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T21:28:59.790

我尝试编译并在我的 linux 机器上得到了同样的错误：

```
$ python setup.py build
DBG> include = ['/usr/include', '/usr/include/python2.6', '/usr/include/SDL']
running build
running build_ext
building 'surfutils' extension
creating build
creating build/temp.linux-i686-2.6
creating build/temp.linux-i686-2.6/src
gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -I/usr/include -I/usr/include/python2.6 -I/usr/include/SDL -I/usr/include/python2.6 -c src/surfutils.c -o build/temp.linux-i686-2.6/src/surfutils.o
In file included from src/surfutils.c:1:
/usr/include/python2.6/pygame/pygame.h:68:17: error: SDL.h: Arquivo ou diretório inexistente
In file included from src/surfutils.c:1:
/usr/include/python2.6/pygame/pygame.h:312: error: expected specifier-qualifier-list before ‘SDL_VideoInfo’
/usr/include/python2.6/pygame/pygame.h:350: error: expected specifier-qualifier-list before ‘SDL_Surface’
src/surfutils.c:5: error: expected ‘)’ before ‘*’ token
src/surfutils.c: In function ‘PyCollisionPoint’:
src/surfutils.c:74: error: ‘SDL_Surface’ undeclared (first use in this function)
src/surfutils.c:74: error: (Each undeclared identifier is reported only once
src/surfutils.c:74: error: for each function it appears in.)
src/surfutils.c:74: error: ‘surf1’ undeclared (first use in this function)
src/surfutils.c:74: error: ‘surf2’ undeclared (first use in this function)
src/surfutils.c:74: warning: left-hand operand of comma expression has no effect
src/surfutils.c:92: error: ‘PySurfaceObject’ has no member named ‘surf’
src/surfutils.c:97: error: ‘SDL_SRCALPHA’ undeclared (first use in this function)
src/surfutils.c:111: error: ‘PySurfaceObject’ has no member named ‘surf’
src/surfutils.c:161: warning: implicit declaration of function ‘collisionPoint’
error: command 'gcc' failed with exit status 1 
```

似乎它试图编译一个名为的扩展**`surfutils`**，它需要 SDL 开发头文件。

所以我`libsdl1.2-dev`使用我的分发包管理器安装了这个包，它工作得很好。您必须安装 SDL 开发头文件才能为您的系统构建它。

所以你的问题真的是：**如何在 Windows 上安装 SDL 开发头文件，以及如何让程序使用它们？**

好吧，我可以回答第二个问题。您必须编辑 setup.py：

```
#!/usr/bin/env python2.3

from distutils.core       import setup, Extension
from distutils.sysconfig  import get_config_vars

includes = []
includes.extend(get_config_vars('INCLUDEDIR'))
includes.extend(get_config_vars('INCLUDEPY'))
includes.append('/usr/include/SDL')

print 'DBG> include =', includes

setup(name='surfutils',
      version='1.0',
      ext_modules=[Extension(
                    'surfutils', 
                    ['src/surfutils.c'], 
                    include_dirs=includes,
                  )],
     ) 
```

更改第 9 行。它说：

```
includes.append('/usr/include/SDL') 
```

将此路径更改为您的 SDL 标头所在的位置，即：

```
includes.append(r'C:\mydevelopmentheaders\SDL') 
```

给游戏开发者留言，说明您遇到了这个问题。它可以提供一种在您的平台上查找 SDL 标头的更好方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T12:41:38.477

当您编译某些东西时，编译器会在多个目录中查找头文件，其中一些是硬编码和内置的，并且通常一些作为编译器的参数给出（例如“gcc -I/usr/local/include ...”）。一种猜测是你错过了这个。如果不检查[您的错误消息的](http://msdn.microsoft.com/en-us/library/et4zwx34(VS.71).aspx)其他可能原因。

您需要安装[SDL](http://www.libsdl.org/)开发库，但既然您说“我可以复制 sdl 标头”，听起来您已经安装了。那么您的问题只是让编译器查看包含这些文件的包含目录。

# c# - Backup SQL Server Database remotely without backup permission

> ID：841659
> 
> 赞同：4
> 
> 时间：2009-05-08T20:31:51.067
> 
> 标签：c#, sql-server-2005, backup

I have a host which runs SQL Server 2005, I have the ability to login to my database and copy/read/write/drop all tables/views/sp's. I tried simply right clicking on my server and selecting backup but I don't seem to have permission to do any backing up.

This cannot be an uncommon occurrence (someone using host/providers db).

Has anyone figured out how to backup the database to a remote computer (without resorting to plain old copy row by row)? I'd Like to have my own backup of my server without relying on my host to preform backups. If so, what library/app allowed you to do this.

Note, I believe that my host does allow for some form of backup using (Database Publishing Wizard) Does anyone know what libraries it uses (so that I may reproduce it in my code)?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T20:42:50.870

为什么不将数据库**导出**到另一个 SQL 服务器？如果你有阅读权限，你可以这样做。它最像一个具有细微差异的备份。

以下是如何导出数据库的教程：

[http://www.databasejournal.com/features/mssql/article.php/3580216/SQL-Server-2005-Import--Export-Wizard.htm](http://www.databasejournal.com/features/mssql/article.php/3580216/SQL-Server-2005-Import--Export-Wizard.htm)

您可以将其导出到您的 Express 版本，但有一些限制，例如最大 1 GB 的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T20:41:02.217

数据库发布向导只是将数据库中的所有对象拉入一个 .sql 文件。我不确定这些库，但我有点不清楚为什么需要复制它。如果您需要以编程方式调用它，它有一个命令行界面。

这是下载链接：[链接](http://www.microsoft.com/downloads/details.aspx?FamilyId=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en)

此外，这里有一个关于如何从命令行使用发布向导的链接：[更多链接](http://weblogs.asp.net/jgalloway/archive/2006/12/29/tip-use-the-database-publishing-wizard-to-script-your-table-data.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-07T05:27:18.197

如果您使用的是 SQL Server，您可以将 MSSQL 服务启动到网络服务，这样您就可以在计算机上的共享文件夹中创建数据库，前提是您对共享文件夹具有写入权限。ñ_ñ

```
USE AdventureWorks;
GO
BACKUP DATABASE AdventureWorks
TO DISK = '\\yourmachine\SQLServerBackups\AdventureWorks.Bak'
   WITH FORMAT,
      NAME = 'Full Backup of AdventureWorks';
GO 
```

请参阅：http: [//msdn.microsoft.com/en-us/library/ms191304.aspx](http://msdn.microsoft.com/en-us/library/ms191304.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T20:36:01.073

> I don't seem to have permission to do any backing up.

What do you mean by "seem"? Is is just that the option isn't there?

If that's the case, I suspect you're using the express edition of SQL Server Management Studio. Certain features in Management Studio — including backup/restore — are only available in a for-pay edition. But the feature still exists in the database itself and the permissions might be fine. If you connect with a full edition of Management Studio you might be able to do the back up.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T20:39:08.320

To the other response: Hosted provider; I highly doubt they are giving out permission to read/write local disks to the user accounts they setup.

*   Personally I would just script the DB using the DB Publishing wizard, which should give you an actual script you can use in the future.

*   You can also right-click on the DB and choose the "script" option (at least in non-express)

*   Alternately, you could contact the host and ask about access to your backups. Don't know if you could get them or not, or what the process of giving them back for restoration would be.

*   There are other tools out there for this, which you can get the source to. Not sure how well they all work, though

    *   [VB.Net backup util](http://www.shabdar.org/sql-server-backup-utility.html) (make a version w/o the interface)
    *   [More info on same util / SQL DMO](http://www.c-sharpcorner.com/UploadFile/shabdarghata/sql-server-backup-utility-sql-dmo02042008134007PM/sql-server-backup-utility-sql-dmo.aspx)
    *   [SQL DMO code to do the backup](http://www.eggheadcafe.com/community/aspnet/14/10039332/reply.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T20:42:08.140

添加到 Joel 的评论中：托管公司可能出于性能原因在其 SQL Server 上限制这些操作（也许他们只希望在晚上或其他情况下进行备份）。或者有时他们只是想为频繁的备份收取额外费用。

所以你必须做一些不同的事情来备份数据。不要忘记保持在主机的 SQL 限制内；）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T20:43:00.027

最好的办法是联系您的托管服务提供商，看看他们是否提供从 Web 控制面板或其他方式访问备份的权限。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-08T20:47:46.597

看看[http://www.codeplex.com/SqlWebAdmin](http://www.codeplex.com/SqlWebAdmin)

我将它与 1and1.com 主机一起使用，只需像任何其他网站一样安装它，然后您“应该”能够执行许多类似于 SSMS 的管理功能。您的托管服务里程可能会有所不同......我知道他们中的很多人出于明显的原因将事情锁定得很紧。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-03-29T11:51:31.520

如果您使用的是 SQL Server，您可以将 MSSQL 服务启动到网络服务，这样您就可以在计算机上的共享文件夹中创建数据库，前提是您对共享文件夹具有写入权限。ñ_ñ

示例代码：

```
USE AdventureWorks;
GO
BACKUP DATABASE AdventureWorks
TO DISK = '\\yourmachine\SQLServerBackups\AdventureWorks.Bak'
   WITH FORMAT,
      NAME = 'Full Backup of AdventureWorks';
GO 
```

# .net - How to Make A Dll 'Plugin' System For Playing AI Bots Against Each Other - In .Net

> ID：841662
> 
> 赞同：1
> 
> 时间：2009-05-08T20:33:29.690
> 
> 标签：.net, plugins, bots

I'm trying to put together a fun 'contest' of sorts. Developers will write a bot that plays some game - maybe BlackJack and the master program will host the game and let the bots play against each other.

I've participated in such things before, but never been involved with the 'host' application. And I'm not sure how to go about doing that.

I'll be doing this in VB.Net

Different people will write their own bots - I'm guessing I'd want to require them to implement a particular interface I'll define. They'll compile it into a DLL and send that to me. I need to have the host call the same methods on each of the different 'bot' DLLs to progress the game play - but I'm having some trouble doing that.

What's the best way to do this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T20:36:45.937

[Load the assembly](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.load(VS.71).aspx) using the reflection API. Then iterate through the types in that assembly until you find one that inherits from some base class you've defined, or interface. Then create an instance of it and start calling the methods :-)

From the sample documentation:

```
Imports System
Imports System.Reflection

Class Class1
    Public Shared Sub Main()
        Dim SampleAssembly As [Assembly]
        ' You must supply a valid fully qualified assembly name here.            
        SampleAssembly = [Assembly].Load("Assembly text name, Version, Culture, PublicKeyToken")
        Dim Types As Type() = SampleAssembly.GetTypes()
        Dim oType As Type
        ' Display all the types contained in the specified assembly.
        For Each oType In Types
            Console.WriteLine(oType.Name.ToString())
        Next oType
    End Sub 'LoadSample
End Class 'Class1 
```

Once you have the type, you can create the instance using [the Activator](http://msdn.microsoft.com/en-us/library/system.activator.createinstance(VS.71).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T21:03:59.040

Take a look at the [Managed Extensibility Framework](http://mef.codeplex.com/). It would let you easily create an interface (or even base classes), and they could just add an Export attribute to their implementation. You'd get all of the discovery and injection for free.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T20:50:47.153

Ah, [that idea brings back some memories](http://www.codeplex.com/terrarium2) from the very early days of .NET. I assume that code contains one or two bits of interest.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T20:53:40.220

Depending on how realistic you want to be, you could always leverage the [MS Robotics Studio](http://en.wikipedia.org/wiki/Microsoft_Robotics_Studio) which ties into Visual Studio 2008 and includes a simulator. There's even [a league](http://www.robochamps.com/rc/Common/home.aspx).

# msbuild - 将值从 TeamBuild 传递到 MSBuild

> ID：841663
> 
> 赞同：0
> 
> 时间：2009-05-08T20:33:30.673
> 
> 标签：msbuild, build, build-automation, tfsbuild

我有一个在 TFS TeamBuild 中运行的构建。我想将一个属性传递给为 TFSBuild.proj 构建的每个项目运行的 MSBuild。

例子：

**TFSBuild.proj**

```
<PropertyGroup>
   <Version>0.0.0.0</Version>
</PropertyGroup>

<Target Name="BuildNumberOverrideTarget" 
        DependsOnTargets="AfterInitializeWorkspace">

  <!--Code that loads the version from a file (removed).-->

  <PropertyGroup>
    <!--Save off the version.-->
    <Version>$(TxCompleteVersion)</Version>
</PropertyGroup> 
```

**MyWIXProjectFile.wixproj**

```
<Target Name="BeforeBuild">
<PropertyGroup>
  <!--If Version is defined then use that.  
   Else just use all zeros to show that this is a developer built version-->
  <CurrentVersion Condition="'$(Version)' == ''" >0.0.0.0</CurrentVersion>
  <CurrentVersion Condition="'$(Version)' != ''" >$(Version)</CurrentVersion>
</PropertyGroup>
<Message Condition="'$(Version)' == ''" 
         Text="Version info is empty (i.e. a developer build).  Version set to $(CurrentVersion)"/>

</Target> 
```

当构建 MyWixProjectFile.wixproj 时，每次都会打印显示 $(Version) 为空白的消息。

有没有办法让我可以让项目文件看到 TFSBuild.proj 属性？

瓦卡诺

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T21:18:00.690

我不是 Wix 专家，但我确实找到了这个，并认为你可以试一试。

[在 MSBuild 中设置 WiX 的属性](http://www.ageektrapped.com/blog/setting-properties-for-wix-in-msbuild/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T18:01:21.303

这是通过 SolutionToBuild 标记中的属性元数据完成的。例如：

```
 <ItemGroup>
    <SolutionToBuild Include="$(BuildProjectFolderPath)\ChangeThisOne.sln">
      <Targets></Targets>
      <Properties>Change=True</Properties>
    </SolutionToBuild>
    <SolutionToBuild Include="$(BuildProjectFolderPath)\ChangeThisToo.sln">
      <Targets></Targets>
      <Properties>Change=True</Properties>
    </SolutionToBuild>
    <SolutionToBuild Include="$(BuildProjectFolderPath)\DontChangeThis.sln">
      <Targets></Targets>
      <Properties>Don'tChange=False</Properties>
    </SolutionToBuild>
  </ItemGroup> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T20:52:13.513

选项1

使用 MSBuild 直接调用 MyWIXProjectFile.wixproj 并将 Version 作为属性传递

选项 2

将 wix 的构建抽象到它自己的 selft 包含的脚本中，然后使用 MSBuild 直接调用并传递所有必要的属性。[我在http://blog.newagesolution.net/2008/06/how-to-use-msbuild-and-wix-to-msi.html](http://blog.newagesolution.net/2008/06/how-to-use-msbuild-and-wix-to-msi.html)有完整实现的博客，您可能会感兴趣。

# .net - Windows系统脚本+编程的建议

> ID：841669
> 
> 赞同：0
> 
> 时间：2009-05-08T20:35:11.637
> 
> 标签：.net, ruby, powershell, scripting, ironpython

我刚刚得到一个项目，我必须在 Windows 操作系统上执行以下操作：

1.  检测有多少驱动器（C：D：E：..etc）连接到当前系统
2.  每个卷的系统标签是什么
3.  每个驱动器有多少存储空间（已用和可用）
4.  每个驱动器是什么格式（NTFS/FAT32）
5.  这些驱动器中的给定目录中有多少文件
6.  每个文件大小有多大
7.  文件处理（每个文件大约 2GB），我必须做很多类似 C 的 fseek()、二进制数据解析以及大端到小端的转换。还要写一些逻辑代码。

我是一位经验丰富的 C\C++ 程序员，但我认为这将是我开始学习脚本的最佳时机。

我想到的候选人是：( Python || Ruby ) && PowerShell。

这些是我可以用 IronPython+Powershell 来完成的事情吗？还是有更好的工具/语言？

PS：PowerShell 是要取代 VBScript 吗？此外，既然存在 C#、WPF 和 Powershell，VB.net 有什么用处？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-08T20:40:05.727

除了列表中的第七项之外，使用 Powershell 和 WMI 应该是相当简单的，因为这可能是Powershell*的*自然领域。由于前六个列表项不需要另一种语言，因此最后一个使用什么并不重要。你可能可以使用 PS（不过我从来没有用它做过 IO）或任何适合你的东西。

至于你的第二个问题：VBScript 可能不会在不久的将来消失，因为在编写用于部署的小脚本时，Windows Script Host 仍然是一个更安全的选择，因为它自 98 以来预装在每个 Windows 上。Powershell 仅包含在Windows 7 及更高版本。话虽如此，Powershell 的目标肯定是为了自动化目的而淘汰 WSH 和 CMD，因为它提供了与上述功能相同的功能以及更多功能（例如简单的 .NET 和 WMI 访问）。

另一方面，VB.NET 是 Microsoft 销售的主要 .NET 语言之一。它与 VBScript 几乎没有关系，也不是 Powershell 或 WPF 的竞争对手（见鬼，它们是完全不同的技术）。您可能会看到与 C# 的一些融合，因为这两种语言似乎仍然很难找到它们的目标市场。尽管如此，当您是 VB 程序员时，VB.NET 是切换到 .NET 的最简单选择，并且有很多 MS 不想仅仅因为他们创建了 .NET 而失去它们。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-09T01:48:48.717

PowerShell可以轻松处理1-6。7 号可能可以在 PowerShell 中完成，但根据细节可能会有更好的选择。

请参阅[您推荐哪些教程来学习 PowerShell？](https://stackoverflow.com/questions/496234/what-tutorial-do-you-recommend-for-learning-powershell/496657#496657)有关学习 PowerShell 的一些有用信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-08T20:44:40.803

您可以在 IronPython|IronRuby 或 Powershell 中执行此操作。我推荐 IronPython，因为它是一种真正的语言（比 C# 甚至 Java 更早），具有大量支持和对您需要的 .NET API（甚至是 COM API）的完全访问权限。

我建议您阅读这篇回答您确切问题的文章：http: [//pythonconquerstheuniverse.blogspot.com/2009/04/ironpython-windows-scripting-language.html](http://pythonconquerstheuniverse.blogspot.com/2009/04/ironpython-windows-scripting-language.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-11T00:34:00.877

我认为 PowerShell*非常适合*这项任务，因为它针对此类系统信息检索进行了优化。与 C# IMO 相比，WMI 在 PowerShell 中非常易于使用（我是一名 C# 开发人员）。哎呀，让我们看看这在 PowerShell 中是多么容易：

```
#1,2, 3 and 4
PS> Get-WmiObject Win32_LogicalDisk | 
>>  Format-Table Name, VolumeName, FileSystem, Size, FreeSpace -auto

Name VolumeName FileSystem         Size    FreeSpace
---- ---------- ----------         ----    ---------
C:              NTFS       160038907904 100353536000
D:
E:
F:   PDC2008    NTFS       160039239680  40155922432
V:   Vista      NTFS       250056704000  33944559616

#5
PS> dir <path> -r | where {!$_.PSIsContainer} | Measure-Object

#6
PS> dir <path> -r | where {!$_.PSIsContainer} | 
>>  Format-Table Fullname, Length -auto 
```

PowerShell 可以通过使用 .NET 框架的能力轻松处理 #7。有关 PowerShell 中 fseek 样式编程的示例，请查看从第 139 行开始的[尾部内容脚本。](http://cid-5a8d2641e0963a97.skydrive.live.com/self.aspx/Public/Powershell%20Scripts/Tail-Content.ps1)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-10T20:06:14.777

Powershell 被设计为 Windows 的自动化平台。当然，Ruby、Python、Perl、VBScript 等都可以完成这项工作，为什么不选择最适合这项工作的工具呢。以下是获取一些基本驱动器信息的方法：

```
$drives = Get-WmiObject -Class  Win32_LogicalDisk | ? {$_.DriveType -eq 3 }
$drives | select DeviceId,VolumeName,FileSystem,FreeSpace, Size 
```

目录中的文件数

```
Get-ChildItem c:\path -Recurse | Measure-Object
Get-ChildItem c:\path | Measure-Object 
```

包含有关文件大小的信息

```
Get-ChildItem c:\path -Recurse |  Measure-Object -Average -Sum 
                                 -Maximum -Property Length 
```

对于文件处理，您可以使用本地 cmdlet，例如 get-content 或调用和实例化 .Net 类型。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-09T02:23:23.857

我会给你一个不受欢迎的答案，因为没有其他人添加它：Perl。

如果您作为 C/C++ 程序员对 Win32 API 感到满意，那么 Perl 可能是更简单的方法。它有用于访问 Win32 API 的模块，Perl 对 C/C++ 程序员来说很容易上手。Perl 过去一直为我完成这项工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-10T08:09:52.500

至于 Perl，Ruby 也可以访问所有 Win32 API 和 WMI 函数。

# linux - 我想将 Bash 脚本的所有命令行参数存储到一个变量中

> ID：841670
> 
> 赞同：14
> 
> 时间：2009-05-08T20:35:43.087
> 
> 标签：linux, bash, shell, unix, command-line-interface

假设我有一个名为**foo.sh**的 Bash 脚本。

我想这样称呼它：

```
foo.sh Here is a bunch of stuff on the command-line 
```

我希望它将所有文本存储到一个变量中并打印出来。

所以我的输出是：

```
Here is a bunch of stuff on the command-line 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-09T00:00:13.530

如果您想避免涉及 $IFS，请使用 $@ （或不要将 $* 括在引号中）

```
$ cat atsplat
IFS="_"
echo "     at: $@"
echo "  splat: $*"
echo "noquote: "$*

$ ./atsplat this is a test
     at: this is a test
  splat: this_is_a_test
noquote: this is a test 
```

IFS 行为也遵循变量赋值。

```
$ cat atsplat2
IFS="_"
atvar=$@
splatvar=$*
echo "     at: $atvar"
echo "  splat: $splatvar"
echo "noquote: "$splatvar

$ ./atsplat2 this is a test
     at: this is a test
  splat: this_is_a_test
noquote: this is a test 
```

请注意，如果对 $IFS 的分配是在分配 $splatvar 之后进行的，那么所有输出都将相同（$IFS 在“atsplat2”示例中无效）。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-05-08T20:37:35.077

```
echo "$*" 
```

会做你想做的事，即打印出整个命令行参数，用空格分隔（或者，从技术上讲，无论是什么值`$IFS`）。如果你想将它存储到一个变量中，你可以这样做

```
thevar="$*" 
```

如果这不能很好地回答你的问题，我不知道还能说什么......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T20:38:48.163

看看`$*`变量。它将所有命令行参数合二为一。

```
echo "$*" 
```

这应该做你想要的。

[更多信息在这里。](http://tldp.org/LDP/abs/html/internalvariables.html#POSPARAMREF)

# assemblies - 将程序集引用更新为目标新版本

> ID：841675
> 
> 赞同：0
> 
> 时间：2009-05-08T20:36:24.177
> 
> 标签：assemblies, versioning

我已经通过一个很长的过程来做到这一点，我发现我相信有更好的方法来做到这一点。我终于厌倦了我的过程，我将尝试找出如何正确地做到这一点。

我有一个引用和过时程序集的解决方案。例如，Castle.Core 1.0.3。我有更新版本的 Castle.Core，版本 1.0.3.5422。我删除了旧的引用，用新的替换了程序集，然后添加了对 Castle.Core 的引用，但这次它（应该是）一个较新的版本。解决方案仍然说当我删除它和所有内容时我引用的是旧的。我最初认为旧程序集隐藏在 obj 或 bin 文件夹中，所以我删除了文件夹中的所有内容。仍然发生。经过一段时间的摆弄，我终于明白了。

这非常烦人，尤其是当我尝试一次更新 5 个程序集时。

帮帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T20:40:53.790

您是否将特定版本设置为 true？

如果不是，它将使用您指向的版本，即使 VS 仍会报告旧版本（灰显）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T00:07:31.237

如果我将特定版本设置为 true，它不会有任何区别，因为参考已经设置为旧版本。我的问题是专门使用文件资源管理器添加引用，找到程序集，看到版本是 1.0.3.5442，当它添加到 VS 时，它是旧版本

# debugging - 如何获取 VBScript 和 ASP 符号文件

> ID：841685
> 
> 赞同：1
> 
> 时间：2009-05-08T20:39:18.490
> 
> 标签：debugging, windbg, symbols

许多 Windows 系统文件可通过下载页面或 http 路径从 Microsoft 获得。我的 WinDbg 找不到 VBScript.dll 和 ASP.dll 的符号文件，而且我似乎无法在 Internet 上找到它们。服务器上的 VBScript.dll 为 5.6.0.8835，ASP.dll 为 6.0.3790.4195。两者的文件日期都比[此处](http://www.microsoft.com/whdc/DevTools/Debugging/symbolpkg.mspx)下载的符号文件更早。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T14:20:55.603

您是否尝试过使用位于[http://msdl.microsoft.com/download/symbols/](http://msdl.microsoft.com/download/symbols/)的 Microsoft 符号服务器？

有关如何在 WinDbg 中使用符号服务器的信息，请参阅[调试工具和符号：入门文档页面。](http://www.microsoft.com/whdc/DevTools/Debugging/debugstart.mspx "调试工具和符号：入门")WinDbg 中符号路径的基本规范可以包括：

```
SRV*c:\websymbols*http://msdl.microsoft.com/download/symbols 
```

将 c:\websymbols 更改为所需的下载存储，或将其删除以不存储本地缓存。

# linux - Windows 命令行工具类似于 UN*X“tail”命令？

> ID：841688
> 
> 赞同：3
> 
> 时间：2009-05-08T20:40:02.840
> 
> 标签：linux, shell, command-line, dos, error-log

> **可能重复：**
> [寻找与 unix tail 命令等效的 Windows](https://stackoverflow.com/questions/187587/looking-for-a-windows-equivalent-of-the-unix-tail-command)

我的 XP 似乎无法识别 DOS 上的 tail 命令。关于在 DOS 上非常大的日志文件上打印最后几行的任何建议。

谢谢阿伦

# functional-programming - 请用最简单、最通俗易懂的英语解释“折叠的普遍属性”？

> ID：841696
> 
> 赞同：15
> 
> 时间：2009-05-08T20:41:56.410
> 
> 标签：functional-programming, fold, haskell

我正在研究“Real World Haskell”，这导致了一个名为[“A tutorial on the universality and expressiveness of fold”](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fwww.cs.nott.ac.uk%2F~gmh%2Ffold.pdf&ei=G5gESt-OPNKLtgfMrIGbBw&rct=j&q=%22A+tutorial+on+the+universality+and+expressiveness+of+fold%22&usg=AFQjCNG81_xijGu4ipQdCGBIxkR8z1Lj6w)的免费 PDF 。它表明“折叠”是“通用的”。我正在与他对“普遍”的定义搏斗，并想听听那些已经花时间消化它的人的意见：**请用最简单、最通俗易懂的英语解释“折叠的普遍属性”？**这个“普遍属性”是什么，为什么它很重要？

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-09T01:46:57.160

（行话模式关闭:-)

通用属性只是证明两个表达式相等的一种方式。（这就是行话“证明原理”的意思。）普遍属性说，如果你能够证明这两个方程

```
g []     = v
g (x:xs) = f x (g xs) 
```

那么你可以得出附加方程

```
g = fold f v 
```

反之亦然，但这只是通过扩展 的定义来证明是微不足道的`fold`。通用属性是一个更深层次的属性（这是一种行话，说为什么它是真的不太明显。）

这样做很有趣的原因是它可以让你避免归纳证明，这几乎总是值得避免的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-08T21:14:04.880

该论文定义了两个属性：

```
g   []     = v
g (x : xs) = f x (g xs) 
```

然后声明它`fold`不仅是满足这些属性*的*函数，而且是*唯一*满足这些属性的函数。它在这方面是独一无二的，这使得它在论文使用的意义上具有“普遍性”。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-10T01:17:54.130

fold 的特性是它是一个列表递归函数，它等效于所有其他列表递归函数，只要你给它正确的参数。

它具有此属性，因为它接受将应用于列表中项目的函数作为参数。

例如，如果我们编写了一个简单的 sum 函数：

```
sum []          = 0
sum (head:tail) = head + (sum tail) 
```

那么我们实际上可以将它写成一个折叠函数，通过传入我们想要用来组合项目的 (+) 运算符：

```
sum list = foldl (+) 0 list 
```

因此，任何简单且递归地作用于列表的函数都可以重写为折叠函数。这种等价性就是它所拥有的属性。我相信他称这个属性是通用的，因为它适用于*所有*这些线性列表递归算法，无一例外。

正如他解释的那样，这个属性之所以如此有用，是因为我们可以证明所有这些其他算法实际上都等价于折叠，通过证明有关折叠的一些东西，我们也可以为所有其他算法证明它。

我个人觉得 fold 函数很难理解，所以有时我使用自己的函数，如下所示：

```
-- forall - A kind of for next loop
-- list is list of things to loop through
-- f is function to perform on each thing
-- c is the function which combines the results of f
-- e is the thing to combine to when the end of the list is reached
forall :: [a] -> (a->b) -> (b->b->b) -> b -> b
forall [] f c e = e
forall (x:xs) f c e = c (f x) (forall xs f c e) 
```

（这实际上比 foldl 稍微强大一些，因为它具有将函数 f 应用于列表中的每个项目的额外功能。）

好吧，没有人证明我的功能。但这没关系，因为我可以证明我的函数实际上是一个折叠函数：

```
forall l f c e = foldl c e (map fn l) 
```

因此，所有关于 fold 的证明，对于我的 forall 函数以及它在整个程序中的所有用途也被证明是正确的。（请注意，我们甚至不需要考虑在对 forall 和 foldl 的每个不同调用中提供了哪种函数 c，这没关系！）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-09-09T05:22:08.023

我刚刚在 Wikipedia 中发现了一个新的（对我而言）条目，“Universal Property”。它为这个问题提供了很多启示。[这是链接：](http://en.wikipedia.org/wiki/Universal_property) 从中，我（暂时）得出以下结论：

1.  尽管您可能会想到 100 种不同的方式来遍历列表、沿途计算并从列表中产生一个最终值，但所有 100 种方式都是*同构*的（意味着最终它们是相同的）。实际上只有一种方法可以将列表减少到一个值，那就是 FOLD。
2.  折叠也是如何将列表减少为单个值的“最有效的解决方案”。或者您可能会说，最“考虑因素”或最“简化”的解决方案。

看来，这两点合在一起就体现了“普遍属性”一词的含义。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-10-01T22:27:32.777

虽然如果不阅读该系列中从分类的角度解释通用属性的前几篇文章可能有点难以理解，但这篇文章对折叠的通用属性以及映射和过滤器进行了详细的分类解释。

[http://jeremykun.com/2013/09/30/the-universal-properties-of-map-fold-and-filter/](http://jeremykun.com/2013/09/30/the-universal-properties-of-map-fold-and-filter/)

虽然我还没有写出来，但后续将把它推广到通用数据结构上的“折叠式”操作（并使其更易于理解，尽管更抽象）。

有关什么是通用属性的更多信息，请参阅这篇文章：http: [//jeremykun.com/2013/05/24/universal-properties/](http://jeremykun.com/2013/05/24/universal-properties/)

这里是该系列所有帖子的链接：http: [//jeremykun.com/main-content/](http://jeremykun.com/main-content/)

事实上，目前公认的答案是理解通用属性关于折叠的最简单方法。上面链接的文章只是通过相关论文中没有的类别理论提供了更详细的技术描述。不过，我不同意公认答案中的说法，即普遍属性比无行话的说法更深层次的属性。fold 的普遍性质正是同一个陈述，只是按照范畴论分析事物的性质，被装进了初始对象和最终对象的语言中。这种分析之所以有价值，正是因为它具有自然的概括性。

# visual-studio-2008 - 如何集成 FxCop 和 VS 2008？

> ID：841704
> 
> 赞同：14
> 
> 时间：2009-05-08T20:43:05.907
> 
> 标签：visual-studio-2008, integration, fxcop

如果这是重复的问题，请指向正确的链接，我将删除此问题。

我知道在 VS Team System 中我可以使用代码分析，但我使用的是 VS Professional。

你能告诉我如何集成 FxCop 和 Visual Studio 吗？我不想将 FxCopCmd.exe 添加到我的构建后事件中以在每次编译时运行 FxCop。当我通过右键单击解决方案资源管理器中的项目进行选择时，我希望能够运行 FxCop。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-08T22:09:39.723

我花了一段时间终于弄明白了。这并不理想，但它有效。

**更新：** 我创建了一个带有[分步说明](http://vkreynin.wordpress.com/2009/05/09/integrate-fxcop-1-36-vs-2008/)的帖子：

感谢[aamit](https://stackoverflow.com/users/83479/aamit)，他提供了使我走上正轨的链接，即使 MSDN 文章中的解决方案不起作用。给他+1；他应得的。

1.) 在 FxCop GUI 中保存您的项目。

**重要**：

*   一种。将项目保存在解决方案所在的同一目录中。
*   湾。将 FxCop 项目名称与您的解决方案名称相同，并包含 .sln 扩展名。

例如：如果您的解决方案名称是`MySolution.sln`，则 FxCop 项目名称将是`MySolution.sln.FxCop`。

2.) 在 Visual Studio 中选择工具 -> 外部工具

3.) 在外部工具对话框中输入以下信息：

*   标题：**FxCop**
*   命令：**C:\Program Files\Microsoft FxCop 1.36\FxCopCmd.exe**
*   参数：**/c /p:"$(SolutionDir)\$(SolutionFileName).fxcop" /cXsl:"C:\Program Files\Microsoft FxCop 1.36\Xml\VSConsoleOutput.xsl"**
*   初始目录：**C:\Program Files\Microsoft FxCop 1.36**

确保选中**“使用输出窗口”**复选框。

就是这样。它对我有用，我希望它对你有用。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-08T21:01:58.780

在 Visual Studio 中将 FxCop 设置为外部工具怎么样？这是链接：

[http://msdn.microsoft.com/en-us/library/bb429389(VS.80).aspx](http://msdn.microsoft.com/en-us/library/bb429389(VS.80).aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-09T13:58:10.130

我运行一个非常类似于 Vadim 的命令作为项目的构建后事件。这样，我一重新编译就会得到 FxCop 错误。但是我们的命令几乎是一样的；很高兴知道世界上至少有两个人得出了相同的结论！

这些错误确实显示在 Visual Studo 的错误列表窗格中。

```
"%ProgramFiles%\Microsoft FxCop 1.36\FxCopCmd.exe"
/文件：“$（目标路径）”
/安慰
/dictionary:"$(SolutionDir)Res\FxCop\CustomDictionary.xml"
/searchgac
/忽略生成的代码

```

（您可以省略 /dictionary 参数；它只指向我的一个自定义字典文件，因为 FxCop 将一些变量名称标记为匈牙利表示法，而实际上它们不是。我还对命令进行了换行以提高可读性。）

它确实使构建时间更长，但很高兴立即看到错误并为每个项目定制命令设置。祝你好运！

# c++ - C ++：尝试将类作为类成员导入另一个类，无法正确复制

> ID：841705
> 
> 赞同：0
> 
> 时间：2009-05-08T20:43:51.787
> 
> 标签：c++

感谢所有回复我之前帖子的人。这个简单的程序仍然存在我想解决的问题。我正在尝试将一个类作为成员对象导入另一个类。不过，这个程序的输出令人困惑。作为对代码的测试，我输出了包含在第一个类对象中的标量。这行得通。然后我输出包含在作为第二类成员的对象中的标量，并且输出为零。我认为有些事情是错误的。有人可以阐明这个问题吗？谢谢！

```
#include <iostream>
using namespace std;

typedef double* doublevec;

// This first class contains a vector and a scalar representing the size of the vector.
typedef class Structure1
{
 int N;
 doublevec vec;
public: 
 // Constructor and copy constructor.
 Structure1(int Nin);
 Structure1(const Structure1& structurein);
 // Accessor functions:
 int get_N() { return N; }
 doublevec get_vec() { return vec; }
 // Destructor:
 ~Structure1() { delete []vec; }
} Structure1;

Structure1::Structure1(int Nin)
{
 N = Nin;
 vec = new double [N];
 for (int i = 0; i < N; i++)
  {
   vec[i] = i;
  };
}

Structure1::Structure1(const Structure1& structurein)
{
 vec = new double[structurein.N];
 for(int i = 0; i < structurein.N; i++)
 {
  vec[i] = structurein.vec[i];
 };
}

// This class just contains the first structure.
typedef class Structure2
 {
  Structure1 structure;
 public:  
  // Constructor:
  Structure2(const Structure1& structurein) : structure(structurein) {}
  // Accessor Function:
  Structure1 get_structure() { return structure; }
  // Destructor:
  ~Structure2() {}
 } Structure2;

int main (int argc, char * const argv[])
{
 const int N = 100;
 Structure1 structure1(N);
 Structure2 structure2(structure1);

 cout << structure1.get_N() << endl;
 cout << structure2.get_structure().get_N();

 return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T20:46:11.407

看起来您没有`N`在`Structure1`的复制构造函数中设置。你需要：

```
Structure1::Structure1(const Structure1& structurein){
 N = structurein.N;
 vec = new double[structurein.N];
 for(int i = 0; i < structurein.N; i++) {
  vec[i] = structurein.vec[i];
 }
} 
```

（另外，for 循环后不需要分号。但那是另一回事。）

**编辑：**这实际上是在[回答](https://stackoverflow.com/questions/841619/c-constructor-problem/841666#841666)您的其他问题时提到的。;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T21:12:34.247

这与问题无关，该问题已被 mmyers 正确回答（并且已被接受），但是由于您似乎正在学习，因此仅提供一些建议：

结构或类不需要 typedef，类型名将自动在命名空间中可用。[*]

使 1 参数构造函数*显式*并且更喜欢初始化列表而不是构造函数块中的代码。显式标记将避免从参数类型到类类型的隐式转换。

常量很重要：将非变异方法标记为常量，以便编译器知道。

喜欢图书馆而不是手工制作的等效解决方案。了解 STL（std::vector 可能与您正在处理的内容非常相似，现在我知道这可能是为了学习）

```
class Structure1 // typedef removed
{
   int N;
   double *vec;
public:
   explicit Structure1( int Nin );        // explicit to disable implicit conversions from int to Structure1
   Structure1( const Structure1 & stin );
   int get_N() const { return N; }        // marked as const: it won't change the object
   double* get_vector() { return vec; }   // not const: user can change the contents of the vector!
                                          // if you don't want the user to change it return a const double*
};

Structure1::Structure1( int Nin ) 
   : N( Nin ), vec( new double[Nin] )
{
   for ( int i = 0; i < N; ++i ) vec[i] = i;
}
Structure1::Structure1( const Structure1 & other )
   : N( other.N ), vec( new double[other.N] )
{
   for ( int i = 0; i < N; ++i ) vec[i] = other.vec[i];
} 
```

[*] 有一个细微的差别，但它不会出现在 99.99% 的代码中，而且大多数 C++ 程序员甚至都不知道。大多数人习惯于不对 C++ 中的类或结构进行类型定义。

# c - 如何使用 C 获取 Linux 中打开的套接字列表？

> ID：841714
> 
> 赞同：8
> 
> 时间：2009-05-08T20:45:43.920
> 
> 标签：c, linux, networking, sockets, kernel

有没有办法在用户空间或内核中使用 C 来获取 Linux 中所有打开的套接字（套接字地址或套接字描述符）的列表？

谢谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-08T20:52:10.580

打开并阅读以下内容：

`/proc/net/tcp`- 打开的 TCP 套接字列表

`/proc/net/udp`- 打开的 UDP 套接字列表

`/proc/net/raw`- 列出所有“原始”套接字

这些就像您使用文件句柄打开和读取的“常规”文件，它们将为您提供您可能需要的有关每个套接字的所有信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T21:25:33.840

该程序可能对您有用，并演示了如何解析 /net/proc/* 文件[sockstat.c](http://www.reznor.com/tools/sockstat.c)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T20:54:47.300

在目录 /proc/self/fd 中有虚假的符号链接，为您提供所有打开的文件描述符 - 套接字提供如下内容：

```
lrwx------ 1 root root 64 2009-05-08 07:45 4 -> socket:[4921]
lrwx------ 1 root root 64 2009-05-08 07:45 5 -> socket:[4918]
lrwx------ 1 root root 64 2009-05-08 07:45 6 -> socket:[5395] 
```

使用 opendir、readdir() 迭代它们，然后使用 readlink() 询问它们

如果您知道 FD 4 是一个套接字，则可以在其上调用 getsockname() 以获取本地地址族、地址等（如果已绑定）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T20:53:14.917

原始数据可以在 /proc/net/tcp、/proc/net/udp 等中找到。有关（简洁）描述，请参阅第一行的标题。

# c++ - 通过 PageText 以编程方式在 wxNotebook 上添加/删除选项卡

> ID：841718
> 
> 赞同：1
> 
> 时间：2009-05-08T20:46:50.907
> 
> 标签：c++, wxwidgets, wxnotebook

我需要能够通过每个选项卡上显示的文本/标签以编程方式添加和删除 wxNotebook 上的选项卡。

在 Windows 中，使用选项卡控件和选项卡页，我可以通过一个键引用每个选项卡。选项卡控件有一个选项卡页映射，键控于每个选项卡的文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T01:54:44.300

看看[wxNoteBook api](http://docs.wxwidgets.org/2.6/wx_wxnotebook.html)

[GetPage](http://docs.wxwidgets.org/2.6/wx_wxnotebook.html#wxnotebookgetpage)之类的函数将返回一个 wxPanel 指针，[SetPageText](http://docs.wxwidgets.org/2.6/wx_wxnotebook.html#wxnotebooksetpagetext)函数将允许您更改标题，[AddPage](http://docs.wxwidgets.org/2.6/wx_wxnotebook.html#wxnotebookaddpage)和[DeletePage](http://docs.wxwidgets.org/2.6/wx_wxnotebook.html#wxnotebookdeletepage)之类的函数将允许您动态更改页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T13:44:08.260

使用以下帮助方法将标签标签/文本转换为 wxNotebookPage 的相应索引。在获得 wxNotebookPage 的索引后，您可以使用所有期望页面索引作为参数的 wxNotebook 方法。

```
int TabTestFrame::GetIndexForPageName( wxString tabText)
{

     int end = Notebook1->GetPageCount();

     wxString selectedtabText = "";

     for ( int i = 0; i < end; i++)
     {

        selectedtabText = Notebook1->GetPageText(i);

        if (tabText == selectedtabText)
            return i;

     }

     return -1;
 } 
```

# iphone - 错误消息“未连接已配置的 iPhone OS 设备”是什么意思。意思是？

> ID：841719
> 
> 赞同：2
> 
> 时间：2009-05-08T20:46:57.693
> 
> 标签：iphone, cocoa-touch, xcode, uikit, provisioning

昨天我在我的设备上测试了很多。当我在 Xcode 中点击 Build & Go 时，突然收到此错误消息。首先，它询问我是否可以用我的密钥签名。我单击是，然后出现该错误消息。我的 iPod 像往常一样连接，iTunes 自动启动，我关闭它以防止中断。

我尝试重新启动 Xcode。没有帮助。我的 Apple Dev Enrollment 是全新的。知道问题可能是什么吗？

**编辑**：在 Window > Organizer 我可以看到这条消息：

> 您的移动设备遇到意外错误 (0xE8000001) 尝试断开设备并关闭设备电源；然后打开设备电源并重新连接。

我在关机的情况下重新启动它，但我仍然收到该消息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T21:18:58.630

因此，该问题的最终解决方案：

*   检查配置文件是否仍在 ~/Library/MobileDevice/Provisioning Profiles
*   如果没有，请从 iPhone 开发者计划网站下载

*   设备电源关闭（真的关闭......你可以通过按住那个大待机按钮几秒钟来做到这一点）

*   退出 Xcode（真的退出：检查 Dock 是否没有运行）

*   激活设备（开机），等到它完全启动

*   插件到你的 Mac

*   等到烦人的 iTunes 自动启动，等到它同步你的 iPhone / iPod touch，然后关闭 iTunes（真的关闭）。

*   启动 Xcode

*   构建并开始

*   祈祷并玩得开心（希望如此）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T20:56:54.313

我以前也发生过这种情况。我也不确定是什么原因造成的，但在大多数情况下，关闭并重新打开手机可以解决问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T23:52:43.317

我要提到开发证书最终会过期，直到我看到你提到“我的 Apple 开发注册是全新的”。

无论如何发布以防万一它对其他人有帮助...如果您的设置突然停止工作，您可能必须下载新的证书。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-17T10:12:38.213

如果 ipod 是全新的，您必须检查管理器中的（用于开发）选项

# jquery - 将文本附加到输入字段

> ID：841722
> 
> 赞同：121
> 
> 时间：2009-05-08T20:48:12.743
> 
> 标签：jquery, text, append

我需要在输入字段中附加一些文本...

* * *

## 回答 #1

> 赞同：220
> 
> 时间：2009-05-08T20:50:22.053

```
 $('#input-field-id').val($('#input-field-id').val() + 'more text');
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<input id="input-field-id" />
```

* * *

## 回答 #2

> 赞同：116
> 
> 时间：2011-07-30T20:39:38.253

有两种选择。Ayman 的方法是最简单的，但我会在其中添加一个额外的注释。你真的应该缓存 jQuery 选择，没有理由调用`$("#input-field-id")`两次：

```
var input = $( "#input-field-id" );
input.val( input.val() + "more text" ); 
```

另一个选项，[`.val()`](http://api.jquery.com/val#val2)也可以将函数作为参数。这具有轻松处理多个输入的优点：

```
$( "input" ).val( function( index, val ) {
    return val + "more text";
}); 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-05-08T21:00:58.737

如果您打算多次使用附加功能，您可能需要编写一个函数：

```
//Append text to input element
function jQ_append(id_of_input, text){
    var input_id = '#'+id_of_input;
    $(input_id).val($(input_id).val() + text);
} 
```

在你可以调用它之后：

```
jQ_append('my_input_id', 'add this text'); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-08-12T14:42:23.283

```
 // Define appendVal by extending JQuery
	$.fn.appendVal = function( TextToAppend ) {
		return $(this).val(
			$(this).val() + TextToAppend
		);
	};
//_____________________________________________

	// And that's how to use it:
	$('#SomeID')
		.appendVal( 'This text was just added' )
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<form>
<textarea 
          id    =  "SomeID"
          value =  "ValueText"
          type  =  "text"
>Current NodeText
</textarea>
  </form>
```

好吧，在创建这个示例时，我不知何故有点困惑。“ **ValueText** ” vs > **Current NodeText** < 不`.val()`应该在**value**属性的数据上运行吗？无论如何，我和你我迟早会解决这个问题。

然而，现在的重点是：

处理**表单数据**时使用**[.val()](http://api.jquery.com/val/)**。

在处理标签之间的大部分**只读数据时，使用****[.text()](http://api.jquery.com/text/)**或**[.append()](http://api.jquery.com/append/)**来附加文本。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-08T20:51:17.790

您可能正在寻找[val()](http://api.jquery.com/val/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-11T09:42:57.160

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <style type="text/css">
        *{
            font-family: arial;
            font-size: 15px;
        }
    </style>
</head>
<body>
    <button id="more">More</button><br/><br/>
    <div>
        User Name : <input type="text" class="users"/><br/><br/>
    </div>
    <button id="btn_data">Send Data</button>
    <script type="text/javascript">
        jQuery(document).ready(function($) {
            $('#more').on('click',function(x){
                var textMore = "User Name : <input type='text' class='users'/><br/><br/>";
                $("div").append(textMore);
            });

            $('#btn_data').on('click',function(x){
                var users=$(".users");
                $(users).each(function(i, e) {
                    console.log($(e).val());
                });
            })
        });
    </script>
</body>
</html> 
```

输出 [![在此处输入图像描述](https://i.stack.imgur.com/0RgQB.png)](https://i.stack.imgur.com/0RgQB.png)

# c# - C# Web 浏览器控制 > 超时？

> ID：841723
> 
> 赞同：1
> 
> 时间：2009-05-08T20:48:18.110
> 
> 标签：c#, timeout, browser

大家好。我想知道如何在 System.Windows.Forms.Webbrowser 控件中实现超时事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T21:20:31.403

您可以使用在 Navigating 事件中启动并在 DocumentCompleted 事件中停止的计时器。

```
private void webBrowser1_Navigating(object sender, WebBrowserNavigatingEventArgs e)
{
    timerTimeOut.Start();
}

private void webBrowser1_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
{
    timerTimeOut.Stop();
}

private void timerTimeOut_Tick(object sender, EventArgs e)
{
    MessageBox.Show("Error : timeout !");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-07T19:29:58.980

## 这是糟糕的编程。试试这个来自微软的代码片段。

```
public partial class WebBrowserEx : WebBrowser
    {
        AxHost.ConnectionPointCookie cookie;
        WebBrowser2EventHelper helper;

        [PermissionSetAttribute(SecurityAction.LinkDemand, Name = "FullTrust")]
        protected override void CreateSink()
        {
            base.CreateSink();

            // Create an instance of the client that will handle the event
            // and associate it with the underlying ActiveX control.
            helper = new WebBrowser2EventHelper(this);
            cookie = new AxHost.ConnectionPointCookie(
                this.ActiveXInstance, helper, typeof(DWebBrowserEvents2));
        }

        [PermissionSetAttribute(SecurityAction.LinkDemand, Name = "FullTrust")]
        protected override void DetachSink()
        {
            // Disconnect the client that handles the event
            // from the underlying ActiveX control.
            if (cookie != null)
            {
                cookie.Disconnect();
                cookie = null;
            }
            base.DetachSink();
        }

        public event WebBrowserNavigateErrorEventHandler NavigateError;

        // Raises the NavigateError event.
        protected virtual void OnNavigateError(
            WebBrowserNavigateErrorEventArgs e)
        {
            if (this.NavigateError != null)
            {
                this.NavigateError(this, e);
            }
        }

        // Handles the NavigateError event from the underlying ActiveX 
        // control by raising the NavigateError event defined in this class.
        private class WebBrowser2EventHelper :
            StandardOleMarshalObject, DWebBrowserEvents2
        {
            private WebBrowserEx parent;

            public WebBrowser2EventHelper(WebBrowserEx parent)
            {
                this.parent = parent;
            }

            public void NavigateError(object pDisp, ref object url,
                ref object frame, ref object statusCode, ref bool cancel)
            {
                // Raise the NavigateError event.
                this.parent.OnNavigateError(
                    new WebBrowserNavigateErrorEventArgs(
                    (String)url, (String)frame, (Int32)statusCode, cancel));
            }
        }
    }

    // Represents the method that will handle the WebBrowser2.NavigateError event.
    public delegate void WebBrowserNavigateErrorEventHandler(object sender,
        WebBrowserNavigateErrorEventArgs e);

    // Provides data for the WebBrowser2.NavigateError event.
    public class WebBrowserNavigateErrorEventArgs : EventArgs
    {
        private String urlValue;
        private String frameValue;
        private WinInetErrors statusCodeValue;
        private Boolean cancelValue;

        public WebBrowserNavigateErrorEventArgs(
            String url, String frame, Int32 statusCode, Boolean cancel)
        {
            urlValue = url;
            frameValue = frame;
            statusCodeValue = (WinInetErrors)statusCode;
            cancelValue = cancel;
        }

        public String Url
        {
            get { return urlValue; }
            set { urlValue = value; }
        }

        public String Frame
        {
            get { return frameValue; }
            set { frameValue = value; }
        }

        public WinInetErrors StatusCode
        {
            get { return statusCodeValue; }
            set { statusCodeValue = value; }
        }

        public Boolean Cancel
        {
            get { return cancelValue; }
            set { cancelValue = value; }
        }
    }

    // Imports the NavigateError method from the OLE DWebBrowserEvents2 
    // interface. 
    [ComImport, Guid("34A715A0-6587-11D0-924A-0020AFC7AC4D"),
    InterfaceType(ComInterfaceType.InterfaceIsIDispatch),
    TypeLibType(TypeLibTypeFlags.FHidden)]
    public interface DWebBrowserEvents2
    {
        [DispId(271)]
        void NavigateError(
            [In, MarshalAs(UnmanagedType.IDispatch)] object pDisp,
            [In] ref object URL, [In] ref object frame,
            [In] ref object statusCode, [In, Out] ref bool cancel);
    }
---------------------------
 public enum WinInetErrors : int
        {
            HTTP_STATUS_CONTINUE = 100, //The request can be continued.
            HTTP_STATUS_SWITCH_PROTOCOLS = 101, //The server has switched protocols in an upgrade header.
            HTTP_STATUS_OK = 200, //The request completed successfully.
            HTTP_STATUS_CREATED = 201, //The request has been fulfilled and resulted in the creation of a new resource.
            HTTP_STATUS_ACCEPTED = 202, //The request has been accepted for processing, but the processing has not been completed.
            HTTP_STATUS_PARTIAL = 203, //The returned meta information in the entity-header is not the definitive set available from the origin server.
            HTTP_STATUS_NO_CONTENT = 204, //The server has fulfilled the request, but there is no new information to send back.
            HTTP_STATUS_RESET_CONTENT = 205, //The request has been completed, and the client program should reset the document view that caused the request to be sent to allow the user to easily initiate another input action.
            HTTP_STATUS_PARTIAL_CONTENT = 206, //The server has fulfilled the partial GET request for the resource.
            HTTP_STATUS_AMBIGUOUS = 300, //The server couldn't decide what to return.
            HTTP_STATUS_MOVED = 301, //The requested resource has been assigned to a new permanent URI (Uniform Resource Identifier), and any future references to this resource should be done using one of the returned URIs.
            HTTP_STATUS_REDIRECT = 302, //The requested resource resides temporarily under a different URI (Uniform Resource Identifier).
            HTTP_STATUS_REDIRECT_METHOD = 303, //The response to the request can be found under a different URI (Uniform Resource Identifier) and should be retrieved using a GET HTTP verb on that resource.
            HTTP_STATUS_NOT_MODIFIED = 304, //The requested resource has not been modified.
            HTTP_STATUS_USE_PROXY = 305, //The requested resource must be accessed through the proxy given by the location field.
            HTTP_STATUS_REDIRECT_KEEP_VERB = 307, //The redirected request keeps the same HTTP verb. HTTP/1.1 behavior.

            HTTP_STATUS_BAD_REQUEST = 400,
            HTTP_STATUS_DENIED = 401,
            HTTP_STATUS_PAYMENT_REQ = 402,
            HTTP_STATUS_FORBIDDEN = 403,
            HTTP_STATUS_NOT_FOUND = 404,
            HTTP_STATUS_BAD_METHOD = 405,
            HTTP_STATUS_NONE_ACCEPTABLE = 406,
            HTTP_STATUS_PROXY_AUTH_REQ = 407,
            HTTP_STATUS_REQUEST_TIMEOUT = 408,
            HTTP_STATUS_CONFLICT = 409,
            HTTP_STATUS_GONE = 410,
            HTTP_STATUS_LENGTH_REQUIRED = 411,
            HTTP_STATUS_PRECOND_FAILED = 412,
            HTTP_STATUS_REQUEST_TOO_LARGE = 413,
            HTTP_STATUS_URI_TOO_LONG = 414,
            HTTP_STATUS_UNSUPPORTED_MEDIA = 415,
            HTTP_STATUS_RETRY_WITH = 449,
            HTTP_STATUS_SERVER_ERROR = 500,
            HTTP_STATUS_NOT_SUPPORTED = 501,
            HTTP_STATUS_BAD_GATEWAY = 502,
            HTTP_STATUS_SERVICE_UNAVAIL = 503,
            HTTP_STATUS_GATEWAY_TIMEOUT = 504,
            HTTP_STATUS_VERSION_NOT_SUP = 505,

            ERROR_INTERNET_ASYNC_THREAD_FAILED = 12047,    //The application could not start an asynchronous thread.
            ERROR_INTERNET_BAD_AUTO_PROXY_SCRIPT = 12166,    //There was an error in the automatic proxy configuration script.
            ERROR_INTERNET_BAD_OPTION_LENGTH = 12010,    //The length of an option supplied to InternetQueryOption or InternetSetOption is incorrect for the type of option specified.
            ERROR_INTERNET_BAD_REGISTRY_PARAMETER = 12022,    //A required registry value was located but is an incorrect type or has an invalid value.
            ERROR_INTERNET_CANNOT_CONNECT = 12029,    //The attempt to connect to the server failed.
            ERROR_INTERNET_CHG_POST_IS_NON_SECURE = 12042,    //The application is posting and attempting to change multiple lines of text on a server that is not secure.
            ERROR_INTERNET_CLIENT_AUTH_CERT_NEEDED = 12044,    //The server is requesting client authentication.
            ERROR_INTERNET_CLIENT_AUTH_NOT_SETUP = 12046,    //Client authorization is not set up on this computer.
            ERROR_INTERNET_CONNECTION_ABORTED = 12030,    //The connection with the server has been terminated.
            ERROR_INTERNET_CONNECTION_RESET = 12031,    //The connection with the server has been reset.
            ERROR_INTERNET_DIALOG_PENDING = 12049,    //Another thread has a password dialog box in progress.
            ERROR_INTERNET_DISCONNECTED = 12163,    //The Internet connection has been lost.
            ERROR_INTERNET_EXTENDED_ERROR = 12003,    //An extended error was returned from the server. This is typically a string or buffer containing a verbose error message. Call InternetGetLastResponseInfo to retrieve the error text.
            ERROR_INTERNET_FAILED_DUETOSECURITYCHECK = 12171,    //The function failed due to a security check.
            ERROR_INTERNET_FORCE_RETRY = 12032,    //The function needs to redo the request.
            ERROR_INTERNET_FORTEZZA_LOGIN_NEEDED = 12054,    //The requested resource requires Fortezza authentication.
            ERROR_INTERNET_HANDLE_EXISTS = 12036,    //The request failed because the handle already exists.
            ERROR_INTERNET_HTTP_TO_HTTPS_ON_REDIR = 12039,    //The application is moving from a non-SSL to an SSL connection because of a redirect.
            ERROR_INTERNET_HTTPS_HTTP_SUBMIT_REDIR = 12052,    //The data being submitted to an SSL connection is being redirected to a non-SSL connection.
            ERROR_INTERNET_HTTPS_TO_HTTP_ON_REDIR = 12040,    //The application is moving from an SSL to an non-SSL connection because of a redirect.
            ERROR_INTERNET_INCORRECT_FORMAT = 12027,    //The format of the request is invalid.
            ERROR_INTERNET_INCORRECT_HANDLE_STATE = 12019,    //The requested operation cannot be carried out because the handle supplied is not in the correct state.
            ERROR_INTERNET_INCORRECT_HANDLE_TYPE = 12018,    //The type of handle supplied is incorrect for this operation.
            ERROR_INTERNET_INCORRECT_PASSWORD = 12014,    //The request to connect and log on to an FTP server could not be completed because the supplied password is incorrect.
            ERROR_INTERNET_INCORRECT_USER_NAME = 12013,    //The request to connect and log on to an FTP server could not be completed because the supplied user name is incorrect.
            ERROR_INTERNET_INSERT_CDROM = 12053,    //The request requires a CD-ROM to be inserted in the CD-ROM drive to locate the resource requested.
            ERROR_INTERNET_INTERNAL_ERROR = 12004,    //An internal error has occurred.
            ERROR_INTERNET_INVALID_CA = 12045,    //The function is unfamiliar with the Certificate Authority that generated the server's certificate.
            ERROR_INTERNET_INVALID_OPERATION = 12016,    //The requested operation is invalid.
            ERROR_INTERNET_INVALID_OPTION = 12009,    //A request to InternetQueryOption or InternetSetOption specified an invalid option value.
            ERROR_INTERNET_INVALID_PROXY_REQUEST = 12033,    //The request to the proxy was invalid.
            ERROR_INTERNET_INVALID_URL = 12005,    //The URL is invalid.
            ERROR_INTERNET_ITEM_NOT_FOUND = 12028,    //The requested item could not be located.
            ERROR_INTERNET_LOGIN_FAILURE = 12015,    //The request to connect and log on to an FTP server failed.
            ERROR_INTERNET_LOGIN_FAILURE_DISPLAY_ENTITY_BODY = 12174,    //The MS-Logoff digest header has been returned from the Web site. This header specifically instructs the digest package to purge credentials for the associated realm. This error will only be returned if INTERNET_ERROR_MASK_LOGIN_FAILURE_DISPLAY_ENTITY_BODY has been set.
            ERROR_INTERNET_MIXED_SECURITY = 12041,    //The content is not entirely secure. Some of the content being viewed may have come from unsecured servers.
            ERROR_INTERNET_NAME_NOT_RESOLVED = 12007,    //The server name could not be resolved.
            ERROR_INTERNET_NEED_MSN_SSPI_PKG = 12173,    //Not currently implemented.
            ERROR_INTERNET_NEED_UI = 12034,    //A user interface or other blocking operation has been requested.
            ERROR_INTERNET_NO_CALLBACK = 12025,    //An asynchronous request could not be made because a callback function has not been set.
            ERROR_INTERNET_NO_CONTEXT = 12024,    //An asynchronous request could not be made because a zero context value was supplied.
            ERROR_INTERNET_NO_DIRECT_ACCESS = 12023,    //Direct network access cannot be made at this time.
            ERROR_INTERNET_NOT_INITIALIZED = 12172,    //Initialization of the WinINet API has not occurred. Indicates that a higher-level function, such as InternetOpen, has not been called yet.
            ERROR_INTERNET_NOT_PROXY_REQUEST = 12020,    //The request cannot be made via a proxy.
            ERROR_INTERNET_OPERATION_CANCELLED = 12017,    //The operation was canceled, usually because the handle on which the request was operating was closed before the operation completed.
            ERROR_INTERNET_OPTION_NOT_SETTABLE = 12011,    //The requested option cannot be set, only queried.
            ERROR_INTERNET_OUT_OF_HANDLES = 12001,    //No more handles could be generated at this time.
            ERROR_INTERNET_POST_IS_NON_SECURE = 12043,    //The application is posting data to a server that is not secure.
            ERROR_INTERNET_PROTOCOL_NOT_FOUND = 12008,    //The requested protocol could not be located.
            ERROR_INTERNET_PROXY_SERVER_UNREACHABLE = 12165,    //The designated proxy server cannot be reached.
            ERROR_INTERNET_REDIRECT_SCHEME_CHANGE = 12048,    //The function could not handle the redirection, because the scheme changed (for example, HTTP to FTP).
            ERROR_INTERNET_REGISTRY_VALUE_NOT_FOUND = 12021,    //A required registry value could not be located.
            ERROR_INTERNET_REQUEST_PENDING = 12026,    //The required operation could not be completed because one or more requests are pending.
            ERROR_INTERNET_RETRY_DIALOG = 12050,    //The dialog box should be retried.
            ERROR_INTERNET_SEC_CERT_CN_INVALID = 12038,    //SSL certificate common name (host name field) is incorrect—for example, if you entered www.server.com and the common name on the certificate says www.different.com.
            ERROR_INTERNET_SEC_CERT_DATE_INVALID = 12037,    //SSL certificate date that was received from the server is bad. The certificate is expired.
            ERROR_INTERNET_SEC_CERT_ERRORS = 12055,    //The SSL certificate contains errors.
            ERROR_INTERNET_SEC_CERT_NO_REV = 12056,
            ERROR_INTERNET_SEC_CERT_REV_FAILED = 12057,
            ERROR_INTERNET_SEC_CERT_REVOKED = 12170,    //SSL certificate was revoked.
            ERROR_INTERNET_SEC_INVALID_CERT = 12169,    //SSL certificate is invalid.
            ERROR_INTERNET_SECURITY_CHANNEL_ERROR = 12157,    //The application experienced an internal error loading the SSL libraries.
            ERROR_INTERNET_SERVER_UNREACHABLE = 12164,    //The Web site or server indicated is unreachable.
            ERROR_INTERNET_SHUTDOWN = 12012,    //WinINet support is being shut down or unloaded.
            ERROR_INTERNET_TCPIP_NOT_INSTALLED = 12159,    //The required protocol stack is not loaded and the application cannot start WinSock.
            ERROR_INTERNET_TIMEOUT = 12002,    //The request has timed out.
            ERROR_INTERNET_UNABLE_TO_CACHE_FILE = 12158,    //The function was unable to cache the file.
            ERROR_INTERNET_UNABLE_TO_DOWNLOAD_SCRIPT = 12167,    //The automatic proxy configuration script could not be downloaded. The INTERNET_FLAG_MUST_CACHE_REQUEST flag was set.

            INET_E_INVALID_URL = unchecked((int)0x800C0002),
            INET_E_NO_SESSION = unchecked((int)0x800C0003),
            INET_E_CANNOT_CONNECT = unchecked((int)0x800C0004),
            INET_E_RESOURCE_NOT_FOUND = unchecked((int)0x800C0005),
            INET_E_OBJECT_NOT_FOUND = unchecked((int)0x800C0006),
            INET_E_DATA_NOT_AVAILABLE = unchecked((int)0x800C0007),
            INET_E_DOWNLOAD_FAILURE = unchecked((int)0x800C0008),
            INET_E_AUTHENTICATION_REQUIRED = unchecked((int)0x800C0009),
            INET_E_NO_VALID_MEDIA = unchecked((int)0x800C000A),
            INET_E_CONNECTION_TIMEOUT = unchecked((int)0x800C000B),
            INET_E_DEFAULT_ACTION = unchecked((int)0x800C0011),
            INET_E_INVALID_REQUEST = unchecked((int)0x800C000C),
            INET_E_UNKNOWN_PROTOCOL = unchecked((int)0x800C000D),
            INET_E_QUERYOPTION_UNKNOWN = unchecked((int)0x800C0013),
            INET_E_SECURITY_PROBLEM = unchecked((int)0x800C000E),
            INET_E_CANNOT_LOAD_DATA = unchecked((int)0x800C000F),
            INET_E_CANNOT_INSTANTIATE_OBJECT = unchecked((int)0x800C0010),
            INET_E_REDIRECT_FAILED = unchecked((int)0x800C0014),
            INET_E_REDIRECT_TO_DIR = unchecked((int)0x800C0015),
            INET_E_CANNOT_LOCK_REQUEST = unchecked((int)0x800C0016),
            INET_E_USE_EXTEND_BINDING = unchecked((int)0x800C0017),
            INET_E_TERMINATED_BIND = unchecked((int)0x800C0018),
            INET_E_ERROR_FIRST = unchecked((int)0x800C0002),
            INET_E_CODE_DOWNLOAD_DECLINED = unchecked((int)0x800C0100),
            INET_E_RESULT_DISPATCHED = unchecked((int)0x800C0200),
            INET_E_CANNOT_REPLACE_SFP_FILE = unchecked((int)0x800C0300),

            HTTP_COOKIE_DECLINED = 12162,    //The HTTP cookie was declined by the server.
            HTTP_COOKIE_NEEDS_CONFIRMATION = 12161,    //The HTTP cookie requires confirmation.
            HTTP_DOWNLEVEL_SERVER = 12151,    //The server did not return any headers.
            HTTP_HEADER_ALREADY_EXISTS = 12155,    //The header could not be added because it already exists.
            HTTP_HEADER_NOT_FOUND = 12150,    //The requested header could not be located.
            HTTP_INVALID_HEADER = 12153,    //The supplied header is invalid.
            HTTP_INVALID_QUERY_REQUEST = 12154,    //The request made to HttpQueryInfo is invalid.
            HTTP_INVALID_SERVER_RESPONSE = 12152,    //The server response could not be parsed.
            HTTP_NOT_REDIRECTED = 12160,    //The HTTP request was not redirected.
            HTTP_REDIRECT_FAILED = 12156,    //The redirection failed because either the scheme changed (for example, HTTP to FTP) or all attempts made to redirect failed (default is five attempts).
            HTTP_REDIRECT_NEEDS_CONFIRMATION = 12168    //The redirection requires user confirmation.
        } 
```

# .net - 在预构建事件上运行 Visual Studio 2008 宏

> ID：841725
> 
> 赞同：4
> 
> 时间：2009-05-08T20:49:03.133
> 
> 标签：.net, visual-studio, visual-studio-2008, macros

我在 Visual Studio 中创建了一些 Visual Studio 宏，它们从宏资源管理器和/或键盘快捷键运行。我想在构建前/构建后事件上自动运行这些，但在项目属性中看不到这样做的选项。谁能告诉我这是否可行，如果可以，怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-08T20:57:28.323

在您的宏中，您可以挂钩 4 个构建事件：

*   OnBuildBegin -- 当从 IDE 触发任何构建操作时将触发。对于完整的解决方案或多项目构建操作，它只会触发一次。

*   OnBuildDone -- 将在构建操作完成时触发。对于完整的解决方案或多项目构建操作，此事件仅触发一次。

*   OnBuildProjConfigBegin -- 将在项目构建开始时触发。此事件用于捕获解决方案或多项目构建操作中的每个项目构建事件。

*   OnBuildProjConfigDone -- 将在项目构建完成时触发。此事件用于捕获解决方案或多项目构建操作中每个项目构建的完成情况。

[公共环境对象模型事件](http://msdn.microsoft.com/en-us/library/aa291100(VS.71).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T20:52:53.433

我不相信这是可能的。也就是说，您可以快速[创建自定义 MSBuild](http://bartdesmet.net/blogs/bart/archive/2008/02/15/the-custom-msbuild-task-cookbook.aspx)任务来完成宏的工作。

# html - 在 HTML 中居中 文本

> ID：841730
> 
> 赞同：5
> 
> 时间：2009-05-08T20:50:34.517
> 
> 标签：html, coding-style

我知道起初这似乎是一个非常愚蠢的问题，但我有充分的理由提出这个问题。尽管我可能只是被误导了。

对于 EVER，我一直在使用`<center>Text</center>`标签使文本水平居中显示。

显然，此标签已贬值，不再使用。所以我尝试过使用，`<p align="center">Text</p>`尽管它似乎有问题，并且我读过它不适用于所有浏览器。

最重要的是，当我在标签`<h#>`中有标题标签时`<p>`，也会出现验证问题。

关键是，我想正确地做到这一点，虽然中心标签是可以容忍的，但这显然不是最好的方法。为什么被贬值了？你的选择是什么？老实说，我不知道从这里去哪里。

PS问这个问题让我很生气。

编辑：：

即使在使用公认的答案时；

```
<p style="text-align:center"></p> 
```

我无法在标签中居中`<h>`标签`<p>`。我已经尝试并阅读了`<h# align="center">`它不适用于所有浏览器，并且我尝试将样式应用于标题标签但无济于事。你怎么看？

* * *

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-08T20:54:26.940

文本对齐需要在 CSS 中声明。您可以在文件顶部的 CSS 部分、单独的文件或元素本身中执行此操作。最简单的方法是后者（请注意，这种方法通常不被认为是一种好的做法）：

```
<p style="text-align: center">Text</p> 
```

如果你想把它放在 html 文件的顶部，它看起来像这样：

```
<head>
<style type="text/css"> 
<!-- 
p.centered
{
  text-align:center;
}

--> 
</style>
</head>
<body>
...
  <p class="centered">Text</p>
</body> 
```

最好的方法是拥有一个包含 CSS 的单独的 CSS 样式表。`<head></head>`然后，在html 部分中添加指向 CSS 的链接：

```
<head>
<link href="path/to/file/name.css" rel="stylesheet" type="text/css" />
</head> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T20:54:23.807

```
<p style="text-align:center;">Some Text Here</p> 
```

这将为您解决问题

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T20:54:40.483

政治上正确的做法是 CSS。

尝试执行以下操作：

```
<p style="text-align:center">Text</p> 
```

或者更好的是，使用 CSS 样式表。

真的，您也不应该使用内联 CSS，它同样草率。您可以为所有`<p>`标签定义样式，或附加一个类并在 CSS 中`<p class="header"`定义该类，例如：`header`

`p.header { text-align: center }`

通过这种方式，您的样式与您的 HTML 分离，生成了一个更清晰的 HTML 文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T20:54:59.047

尝试`<p style="text-align: center;">Text</p>`

或者在您的 html 顶部，您可以声明：

```
<style type="text/css">
.center { text-align: center; }
</style> 
```

然后稍后只需应用该类：

```
<p class="center">Text</p> 
```

请记住 text-align css 属性适用于块元素。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-08T21:11:54.777

为了解决隐含的第二个问题，在 <p> 中有 <h#> 时出现验证问题的原因是因为 HTML 4.0 和 XHTML 中不允许在段落内嵌套标题。

解释一下，标题和段落是语义概念，旨在告知文档的结构，而不是暗示其内容的外观（当然，默认情况下它们确实看起来不同，但这不是它们的使用重点）。因此，标题不应包含在段落中。

如果您的实现需要在段落中嵌套标题，您可能需要重新考虑您要完成的工作的方法。如果目的是在结构上表明“这是一个标题”，请考虑为什么标题会在段落内。如果目的是使段落中的某些文本看起来不同，那么您可能希望使用带有关联 CSS 样式的[内联](http://www.w3.org/TR/CSS2/visuren.html#inline-boxes)元素之一，例如 span 或 em。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-08T21:18:09.020

关于`<h#>`标签中的`<p>`标签，这确实是一个验证问题。

`<h#>`标签用于标记标题。`<p>`标签用于标记段落。

所以，如果我要标记你的问题，我可能会这样开始：

```
<h2>Centering Text in HTML</h2>

<p>I know at first this seems like a very stupid question, but I have a good reason for asking it. Even though I might just be misled.</p> 
```

如果我希望标题居中对齐，我会再次使用 CSS：

```
<h2 style="text-align: center;">Centering Text in HTML</h2>

<p>I know at first this seems like a very stupid question, but I have a good reason for asking it. Even though I might just be misled.</p> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-08T20:57:22.503

如果您想要居中文本，您可以使用“text-align: center”css 声明来实现：

```
<div style="text-align:center;">Centered Text</div> 
```

如果你想使一个元素居中，你可以给它一个宽度并设置“margin：0 auto”，如下所示：

```
<div style="width: 100px; margin: 0 auto;>whole div will be centered</div> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-08T21:15:23.740

除了从内容中分离（...或不）样式的问题之外，值得一提的是，HTML 的“官方”弃用并不意味着它不能像以前那样工作。鉴于浏览器的工作和开发方式，您的中心标签将继续工作一段时间，可能直到使用 HTML 本身的时间结束。:-)

也就是说，如果您认为这是正确的做法，请更改它，但如果您认为它不再有效，则不要更改它。另外：如果它有效并且替代方案不起作用，则将其删除......好吧，我自己不会改变它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-08T21:27:38.857

您应该过渡到 CSS 的样式。HTML / XHTML 旨在纯粹用于内容。

```
<p style="text-align: center;">Paragraph Text</p> 
```

另外，我不认为`<h#>`标签应该嵌套在`<p>`标签中。

有关详细信息，请参阅[w3schools.com](http://w3schools.com/html/html_styles.asp)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-08T21:34:06.613

```
<head>
    <style type="text/css"> 
    <!-- 

    div.content,
    div.content h1,
    div.content h2,
    div.content h3,
    div.content h4,
    div.content h5,
    div.content h6 {
        text-align:center;
    }
    --> 
    </style>
</head>
<body>
  <div class="content"><h2>Text</h2></div>
</body> 
```

如果您希望 h 标签也居中，您可以这样做，而且它们是正确的……不要将 H 标签放在 P 标签中。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-08T20:55:12.447

呵呵，好吧，这并不像看起来那么容易。我通常做的是将所有文本放在 div 中，然后使用“text-align”css 标签。至于中心标签，不知道。

祝你好运 ：-）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-08T20:58:02.173

我知道您在问题中指定了“HTML”，所以这可能不是您要问的……但是您是否考虑过 CSS 样式：

```
样式=“文本对齐：中心；”

```

或者

```
style="margin-left:auto;margin-right:auto;"

```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-08T21:01:03.633

我**强烈**推荐你阅读Andy Budd 的[CSS Mastery](http://cssmastery.com)。这是一本好书，快速阅读，它肯定会改变你对 CSS 的看法。

鉴于您对 CSS 的评论，我认为您会从这本书中得到很多。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-08T21:01:27.937

它已被弃用，因为它是一种无法动态控制的样式。它也不允许您将标记与样式分开。

文本只能在它所在的框元素中居中，因此您想要居中的文本必须在 <p> 或 <div> 或 <td> 等中。例如，您不能将文本居中。

text-align 是被替换的css属性

您的其他问题似乎已得到充分回答。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-08T21:02:59.620

处理此问题的最佳和最通用的方法是让您的 < p> 标签从其父类继承，如下所示：

```
<style>
.paragraph p{
    text-align: center;
}
</style>

<div class="paragraph">
   <p>Text</p>
</div> 
```

这样，当您以后想要以不同的方式设置网站样式时，您可以在一个集中位置更改“段落”类中的所有 < p> 标签，而不必单独更改它们。

# java - JTextArea 字体更改很慢

> ID：841732
> 
> 赞同：1
> 
> 时间：2009-05-08T20:51:05.157
> 
> 标签：java, jtextarea

我对 JTextArea 控件有一个奇怪的问题：

当我提出时，我的`JTextArea`一切都很好，我输入的任何内容都会立即显示。但是，一旦我将 a 发送`FontSizeAction`到我的`EditorKit`（在这种情况下为 RTFEditorKit，但我使用哪个似乎并不重要），就会发生 1 到几秒的延迟。

有趣的是，延迟仅在您输入某些内容后发生，即更改字体，然后什么都不做，然后输入，与立即输入没有区别。延迟是一样的。我可以看到，在 FontSizeAction 之后键入第一个字母后，分配会增加几兆。

我在应用程序上使用了分析器，我自己的应用程序中似乎没有任何问题。

**我的代码：**

```
private void updateFont(MainModelManager model) {
    (new RTFEditorKit.FontSizeAction("font-size-" + model.getFontSize(),
                                     model.getFontSize())).actionPerformed(
        new ActionEvent(this, ActionEvent.ACTION_PERFORMED, null) );

    (new RTFEditorKit.FontFamilyAction("font-family-" + model.getFontFamily(), model.getFontFamily())).actionPerformed(
            new ActionEvent(this, ActionEvent.ACTION_PERFORMED, model.getFontFamily()) );
} 
```

这是主模型容器声明的一部分：

```
public class MainModelManager extends Observable {
    DefaultStyledDocument doc;
    int fontSize = 12;
    String fontType = "Helvetica";
    StyleContext sc; 
    Caret editorCaret;
    boolean editorFrameIsResizable;  
    //...
} 
```

**更新：**

我认为我已将问题缩小到 FontFamilyAction，因为如果我将其注释掉，延迟就会消失，我仍然可以毫无问题地更改字体大小。也许这与加载字体有关？

# jqgrid - jqGrid，如何从查询中填充选择列表

> ID：841739
> 
> 赞同：6
> 
> 时间：2009-05-08T20:53:01.953
> 
> 标签：jqgrid

我在我的coldfusion项目中有一个基本的jqGrid。我在 jqGrid 中的一个字段是组合框。目前，editoption 值是硬编码的，如下所示。

```
colModel :
[
  {
   name:'seqnum',index:'seqnum', width:100,resizable:true,   
   align:"left",sorttype:"text",editable:true,edittype:"select",editoptions:   
   { value:"1:one;2:two"},editrules:{required:true}
  }
] 
```

我正在尝试找出一种从查询/url 填充下拉列表的方法。

任何帮助将不胜感激。

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T12:59:15.913

创建一个使用 json 来查询 url 的函数。此函数应返回格式为“1:one;2:two”的字符串。

例如：

```
 colModel :
    [
      {
       name:'seqnum',index:'seqnum', width:100,resizable:true,   
       align:"left",sorttype:"text",editable:true,edittype:"select",editoptions:
       { value:getSequenceNumbers()},editrules:{required:true}
      }
    ]

    function getSequenceNumbers(){
        $.getJSON("yourUrl", null, function(data) {
            if (data != null) {
                 //construct string.  
                 //(or the server could return a string directly)
            }
        });
    } 
```

我想您也可以将函数内联，但我认为它会更难阅读。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-04-26T16:33:00.040

$.getJSON / getSequenceNumbers() 答案无法正常工作。无法从回调中返回数据作为 getSequenceNumbers() 的返回值，因为回调是异步的。您要么需要使用 Martin 建议的 dataURL 方法，要么在 $.getJSON 回调中设置 jqGrid。

```
$(document).ready(function() {
 $.getJSON("GetURL", function(data) {
  setupGrid(data);
 });
});

function setupGrid(data) {
...
    colModel :
    [
      {
       name:'seqnum',index:'seqnum', width:100,resizable:true,   
       align:"left",sorttype:"text",editable:true,edittype:"select",editoptions:
       { value:data},editrules:{required:true}
      }
    ]

...
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-09-18T21:09:11.063

使用`dataUrl`...（[请参阅此处的 wiki](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:common_rules)）。

目前 dataUrl 生成一个 GET，但是如果从 Github 中提取代码，则 GET 可以更改为 POST，而没有明显的副作用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-07-27T12:36:52.313

值得注意的是，如果您使用服务器端脚本语言，您可以完全回避这个问题。例如，您可以使用 PHP

```
{name:'myselectdata', index:'myselectdata', width:160, formatter:'select', editable:true, edittype:"select", cellsubmit:"clientArray", editoptions:{ <? echo getData() ?>}  }, 
```

然后只需在页面上方设置 PHP 函数 getData() 以返回合适的字符串，例如

```
'value:"1:one;2:two"'; 
```

也许不像在 jQuery 中处理所有东西那样优雅或便携，但我认为在概念上更容易。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-10T19:43:05.163

假设在您的 ColModel 中有这样的列：

```
{name:'id_UDM', index:'id_UDM', width:150, editable:true, edittype:"select", editoptions:{dataUrl:'filename.php'}} 
```

您必须首先声明它是一个选择元素：

```
edittype:"select" 
```

然后，在 editoptions 参数中添加一个 dataUrl，如下所示：

```
editoptions:{dataUrl:'filename.php'} 
```

filename.php 必须返回一个带有选项的“select”元素，这是一个示例：

```
<?php
    include("connectionToMyDatabase.php");
    $query1 = "SELECT * FROM table WHERE 
    $result1 = mysql_query($query1);
    $response ='<select>';
    while($row = mysql_fetch_array($result1)) {
         $response .= '<option value="'.$row['value'].'">'.$row['name'].'</option>';
    }
    $response .= '</select>';

    echo $response;

 mysql_close($db);  
?> 
```

希望这可以帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-28T20:32:30.693

我知道这是一个老问题，但我发现了同样的问题。
我通过结合使用 dataUrl 和 ajaxSelectOptions 来解决这个问题。

```
colModel:[
    //class_id
    $.extend(true,
    {
        name:'class_id'
        ,index:'class_id'
        ,edittype:'select'
        ,formatter:'select'
        ,editoptions: { dataUrl:"db.php?ajaxOp=getClassesOptions" } //to send dynamic parameter, combine with ajaxSelectOptions
    }
    ,{}
    ) 
```

请注意，dataUrl 字符串是静态的，这意味着您不能在每次添加/编辑时发送不同的参数。下面的代码将不起作用！

```
,editoptions: { dataUrl:"db.php?ajaxOp=getClassesOptions" + "&id="+selected_id } 
```

要发送诸如 id 之类的参数，您可以使用 ajaxSelectOptions 。

```
ajaxSelectOptions:      //use this for combination with dataUrl for formatter:select
{       
    data: {
      id: function () {
          return selected_id;
      }
    }
}, 
```

每次添加/编辑发生时都会执行返回 selected_id 的函数。希望这可以帮助 ！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-08T19:34:54.273

我为 searchoptions 而不是 editoptions 修改了代码。但是它会自动选择第一个选项并过滤列表，所以我添加了以下内容来缓解这种情况。

```
 $response ='<select>';
 $response .= '<option value=""></option>';
 while($row = $stmt->fetch(PDO::FETCH_NUM)) {
      $response .= '<option value="'.$row[0].'">'.$row[0].'</option>';
 }
 $response .= '</select>';

 echo $response; 
```

# ruby-on-rails - Rails 不再喜欢这个了？专辑模型的“脚本/生成脚手架专辑”

> ID：841747
> 
> 赞同：0
> 
> 时间：2009-05-08T20:54:40.093
> 
> 标签：ruby-on-rails, scaffolding

```
script/generate scaffold Album 
```

用于为名为 Album 的模型（Rails 2 之前）生成脚手架。

这些天（post-Rails 2）是否正确，您需要指定所有必填字段：

```
script/generate scaffold Album artist:String title:String 
```

我一直在关注 Rails 1.1.6 的教程，并且一直对为什么感到困惑

```
script/generate scaffold Album 
```

不像教程描述的那样工作，但我怀疑命令的新格式要求您明确拼出脚手架中所需的所有字段。

如果 Rails 失去了仅基于模型名称简洁地生成脚手架的能力，那是令人失望的，因为它通过 schema.db “知道”模型的所有字段是什么，而无需您将它们显式声明给脚手架命令。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T23:58:57.420

如果您没有在命令中指定字段，那么 Rails 将不会构建任何预先填充字段信息的脚手架，就像在视图中一样。

```
script/generate scaffold Album 
```

应该仍然有效，但是您必须制作所有表单和显示视图以及定义迁移文件中的所有字段。

# asp.net-mvc - C# ASP.Net MVC 视图问题

> ID：841760
> 
> 赞同：1
> 
> 时间：2009-05-08T20:57:12.597
> 
> 标签：asp.net-mvc, model-view-controller

我有一个接口，其中包含一个名为 ListAll() 的方法

```
using System.Collections.Generic;
namespace MvcApplication1.Models
{
public interface IMovieRepository
{
IList<Movie> ListAll();
}
} 
```

我有一个实现该接口的类：

```
namespace MvcApplication1.Models
{
public class MovieRepository : IMovieRepository
{
private MovieDataContext _dataContext;
public MovieRepository()
{
_dataContext = new MovieDataContext();
}
#region IMovieRepository Members
public IList<Movie> ListAll()
{
var movies = from m in _dataContext.Movies
select m;
return movies.ToList();
}
#endregion
} 
```

以及一个使用此存储库模式从数据库中返回电影列表的控制器：

```
namespace MvcApplication1.Controllers
{
public class MoviesController : Controller
{
private IMovieRepository _repository;
public MoviesController() : this(new MovieRepository())
{
}
public MoviesController(IMovieRepository repository)
{
_repository = repository;
}
public ActionResult Index()
{
return View(_repository.ListAll());
}
}
} 
```

我的问题是，我需要在视图中放置什么代码才能显示这些数据？以及在 ASP.Net MVC 视图中显示数据的选项有哪些？

非常感谢帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T21:08:26.503

右键单击您的控制器，添加视图...

*   保持视图的名称与操作相同。
*   勾选 [X] 创建强类型视图
    *   放入`IEnumerable<Movie>`类型框

您的视图将被创建，您可以通过执行以下操作访问项目：

```
<% foreach(var movie in Model) { %>

....

<% } %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T11:24:13.060

虽然使用 IDE 创建视图是一种快速的开发方式，但我认为您需要了解 ViewModel 的工作原理。

创建您的视图页面，并在页面声明的顶部告诉 ViewPage 期望什么对象。现在您已经对 View 进行了强输入以了解它应该显示的内容

```
<%@ Page Language="C#" MasterPageFile="~/Views/Shared/Site.Master"
Inherits="System.Web.Mvc.ViewPage<MvcApplication1.Models.Movie>" %>

<% foreach (ViewData.Model 中的电影 m) { %>
   <%= m.PropertName %> 等html
<% } %>

```

还要记住将模型的命名空间添加到 web.config。这使您可以编写短片而不是 MvcApplication1.Models.Movie。

```
<页面>
    <命名空间>
        <add namespace="MvcApplication1.Models" />

```

# php - Youtube API 的 PHP 语法错误：解析错误：语法错误，意外的 T_ENCAPSED_AND_WHITESPACE，需要 T_STRING 或 T_VARIABLE 或 T_NUM_STRING

> ID：841766
> 
> 赞同：-1
> 
> 时间：2009-05-08T20:59:19.177
> 
> 标签：php, api, youtube, simplexml

我在第 54 行不断收到此错误，我不知道为什么。我要做的就是处理查询结果的第一个条目：提取它的 URL 以便构造一个可嵌入的视频对象。

```
<?php
    function extractID($youtubeURL)
    {
        //split off the final bit of the URL beginning with ‘=’
        $youtubeID = strchr($youtubeURL,'=');
        //remove that equals sign to get the video ID 
        $youtubeID = substr($youtubeID,1);
        return $youtubeID;
    }
?>
<?php
    // set feed URL
    $lang = $_POST['language'];
    $query = $_POST['query'] . "%20review";
    switch($lang){
        case "English":
            $feedURL = <<<URL
            http://gdata.youtube.com/feeds/api/videos
            ?q=<?php echo $query; ?>
            &v=2
            &format=5
            &lr=en
            URL;
            break;
        case "French":
            $feedURL = <<<URL
            http://gdata.youtube.com/feeds/api/videos
            ?q=<?php echo $query; ?>
            &v=2
            &format=5
            &lr=fr
            URL;
            break;
        case "Spanish":
            $feedURL = <<<URL
            http://gdata.youtube.com/feeds/api/videos
            ?q=<?php echo $query; ?>
            &v=2
            &format=5
            &lr=es
            URL;
            break;                    
    }

    // read feed into SimpleXML object
    $sxml = simplexml_load_file($feedURL);

    // get the first media entry &
   // get nodes in media: namespace for media information
   $media = $sxml->entry[0]->children('http://search.yahoo.com/mrss/');

   // get video player URL
   $attrs = $media->group->player->attributes();
   // **THIS KEEPS CAUSING THE ERROR.**
   $videoURL = $attrs['url'];
   // extract the video's ID from the URL
   $videoID = extractID($videoURL);       
?>

<?php
    echo <<<EOD 
    <objectwidth="425" height="350" data="http://www.youtube.com/v/
    <?php echo $videoID ?> 
    type="application/x-shockwave-flash"><param name="src" 
    value="http:/www.youtube.com/v/<?php echo $videoID ?>" /></object>
    EOD;
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T17:19:17.867

您提供的 PHP 代码中的问题似乎出在构建 YouTube RSS 提要 URL 的部分。它如下所示：

```
<?php
// set feed URL
$lang = $_POST['language'];
$query = $_POST['query'] . "%20review";
switch($lang){
    case "English":
        $feedURL = <<<URL
        http://gdata.youtube.com/feeds/api/videos
        ?q=<?php echo $query; ?>
        &v=2
        &format=5
        &lr=en
        URL;
        break;
    case "French":
        $feedURL = <<<URL
        http://gdata.youtube.com/feeds/api/videos
        ?q=<?php echo $query; ?>
        &v=2
        &format=5
        &lr=fr
        URL;
        break;
    case "Spanish":
        $feedURL = <<<URL
        http://gdata.youtube.com/feeds/api/videos
        ?q=$query;
        &v=2
        &format=5
        &lr=es
        URL;
        break;
} 
```

我可以看到有两件事是错误的：

1.  [heredocs](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)`URL;`末尾的行**不应**缩进。它们应该如下所示：

     **```
     case "English":
            $feedURL = <<<URL
            http://gdata.youtube.com/feeds/api/videos
            ?q=<?php echo $query; ?>
            &v=2
            &format=5
            &lr=en
    URL;
            break; 
    ```** 
***   不要`<?php echo $query; ?>`在 heredocs 中使用。只需单独使用`$query`，如`case "Spanish":`上面的块中所示。** 

 **修复这些 heredocs 后，您会发现代码无法执行您想要的操作。 `$feedURL`将包含很多不需要的空格，这将导致您的调用`simplexml_load_file`失败。但是，如果您仔细查看提要 URL，您会注意到除了末尾的“语言代码”（ `en`, `fr`, ）之外，它们都是相同的。`es`我要做的是使用一个将语言名称转换为语言代码的数组，并使用它将语言代码附加到提要 URL。例如，以下内容应该可以工作：

```
$lang_codes = array(
    "English" => "en",
    "French"  => "fr",
    "Spanish" => "es"
);

$feedURL = "http://gdata.youtube.com/feeds/api/videos?q=$&v=2&format=5&lr=" . $lang_codes[$lang]; 
```

您的其余代码似乎可以工作。一旦我修复了获取 RSS 提要 URL，它就会非常高兴地获取提要，从中提取一个 YouTube URL 并获取视频 ID。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-05-08T22:01:02.537

问题是 $media->group 是空的。它没有孩子。这意味着 $media->group->player 为 NULL。您不能在 NULL 上调用 attributes()，因此会出现语法错误。

# .net - 调整大小后如何使用 Expander 保持 WPF 窗口的大小

> ID：841767
> 
> 赞同：56
> 
> 时间：2009-05-08T21:00:01.950
> 
> 标签：.net, wpf, sizetocontent

我有一个带有`SizeToContent="Height"`. 此窗口包含一个`<Expander />`显示最近活动列表的窗口。我想要的是当扩展器展开时，窗口的大小会成比例地增长。隐藏时，窗口再次按比例调整大小。如果窗口被调整大小，扩展器和它包含的列表视图应该增长以使用新空间。（不要介意那里的颜色可以帮助我解决这个问题）：

**普通视图**

[替代文字 http://www.deploylx.com/so/wpfexpander/Open.png](http://www.deploylx.com/so/wpfexpander/Open.png "普通视图")

**折叠**

[替代文字 http://www.deploylx.com/so/wpfexpander/Closed.png](http://www.deploylx.com/so/wpfexpander/Closed.png "关闭")

**调整到新空间**

[替代文字 http://www.deploylx.com/so/wpfexpander/Expanded.png](http://www.deploylx.com/so/wpfexpander/Expanded.png "扩展以使用新空间")

到目前为止，这很好用。`<Expander />`调整窗口大小后折叠时出现问题。列表视图并没有再次折叠，而是简单地隐藏了：

**调整大小后折叠**

[替代文字 http://www.deploylx.com/so/wpfexpander/Collapsed.png](http://www.deploylx.com/so/wpfexpander/Collapsed.png "调整大小后折叠")

我的直觉告诉我，`Height`当窗口调整大小并因此覆盖`SizeToContent`属性时，正在设置窗口的 。那么，如何让窗口在调整大小后保持其大小以适应内容行为？

当前 XAML：

```
<Window x:Class="DeployLX.Licensing.Nlm.Admin.v3.DashboardWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Dashboard" Width="504" SizeToContent="Height" Height="275">

  <DockPanel>
    <Menu DockPanel.Dock="Top">
      <MenuItem Header="_File">
        <MenuItem Header="E_xit" Command="{Binding Path=CloseCmd}" />
      </MenuItem>
    </Menu>
    <Grid DockPanel.Dock="Top" Margin="8" ShowGridLines="True">
      <Grid.RowDefinitions>
        <RowDefinition />
        <RowDefinition />
      </Grid.RowDefinitions>
      <Grid.ColumnDefinitions>
        <ColumnDefinition />
        <ColumnDefinition />
      </Grid.ColumnDefinitions>

      <Grid Grid.RowSpan="2" Grid.Row="0" Grid.Column="0" Margin="0,0,8,0">
        <Rectangle Fill="Red" />
        <TextBlock>ActiveCount</TextBlock>        
      </Grid>

      <Grid Grid.Row="0" Grid.Column="1" Margin="0,0,0,4">
        <Rectangle Fill="Green" />
        <TextBlock>Authorization</TextBlock>
      </Grid>
      <Grid Grid.Row="1" Grid.Column="1" Margin="0,4,0,0">
        <Rectangle Fill="Blue" />
        <TextBlock>Authorization</TextBlock>
      </Grid>      
    </Grid>
    <Expander Header="Recent Activity" Margin="8" IsExpanded="True">
      <ListView IsSynchronizedWithCurrentItem="True" MinHeight="100">
        <ListView.View>
          <GridView>
            <GridViewColumn Header="Status"/>
          </GridView>
        </ListView.View>
      </ListView>
    </Expander>
  </DockPanel>
</Window> 
```

**更新：**我尝试监听扩展器的 Collapsed 事件并重置 Windows`SizeToContent`属性。这几乎可以工作。它会导致它再次折叠窗口，但当再次展开时，它会回到原来的 100 像素高度。虽然存储和捕获这些信息是可行的，但它闻起来很老套，而且容易出错。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-06-11T22:26:57.383

如果要使用 SizeToContent，则必须使窗口不可调整大小。此外，您不应使用 SizeToContent="Height"，然后设置显式高度。想一想 - WPF 应该相信哪个窗口高度、用户设置或内容？它不能只是在两者之间来回切换。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-07-17T11:30:03.767

最简单的应对方法是通过`ResizeMode="NoResize"`在窗口上设置手动调整大小。 **但是**，如果您有的话，`WindowStyle="None"`我注意到在 Vista Aero 上这会导致窗口完全脱落“镀铬”并且窗口看起来很尴尬。此外，这有点逃避，因为看起来您想为用户提供调整大小的功能。

问题是您有两个相互冲突的目标：1.）您`SizeToContent="Height"`在折叠扩展器控件时总是想要，2.）`SizeToContent="Height"`在展开扩展器控件时您想要，**除非**用户手动调整了窗口大小（SizeToContent="Manual"），其中如果您想返回到用户的手动高度。

哎呀。我认为您无法自己保存扩展的高度。一旦您恢复到`SizeToContent="Height"`折叠的事件处理程序中，WPF 将不会在展开时记住用户的手动高度。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-07-15T09:52:05.110

试试这个，它应该符合您的需求：

```
<Window ...
        SizeToContent="WidthAndHeight"  
        Height="Auto" 
        Width="Auto"> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-11T22:17:24.583

我发现将 Window 的主体放在 View 中，然后将 View 作为唯一的孩子放在窗口中解决了类似的问题......

不是最理想的解决方案，但它似乎有效。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T04:51:43.300

正如我在[问题](https://stackoverflow.com/questions/159470/reset-expander-to-default-collapse-behavior)中发现的那样，将 Height 设置为 Double.NaN 会导致它重置为 SizeToContent 幸福。我不知道它是否会记住你的扩展器的大小。您可以尝试使用 Kent 的 Resizer 控件将大小调整行为移动到扩展器而不是包含窗口。

# gridview - 对网格视图和排序表达式进行排序

> ID：841780
> 
> 赞同：0
> 
> 时间：2009-05-08T21:03:07.683
> 
> 标签：gridview, sorting

我正在使用 gridview 并且必须设置一个排序表达式，我正在使用：

```
<asp:TemplateField HeaderText="Order Name" SortExpression="OrderId">
                <ItemTemplate>
                    <asp:Label ID="Label1" runat="server" Text='<%# OrderName(((DataLayer.Car)Container.DataItem).OrderId) %>' />
                </ItemTemplate>
                <ItemStyle Width="120px" />
            </asp:TemplateField> 
```

但我宁愿按从 OrderId 获得的名称进行排序，而不是按实际的 OrderId 排序 - 但我无法确定这是否可行，以及如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T21:26:15.867

您必须使用网格中数据结果的字段名称。如果结果中有该字段，请使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T23:30:01.263

如果您需要支持分页（并且您没有将整个结果集存储在会话或视图状态或其他内容中），您将无法分页按订单名称排序的结果。

只要您的结果集很小（并且您正在存储它），您就可以创建一个包含 OrderID 和 OrderName 的新对象，用 orderid 和 ordername 填充它，然后绑定到它。

如果可能，最好的办法是让您的订单名称来自您的数据源。

# php - 在 PHP 中从 $_POST[] 读取数据

> ID：841781
> 
> 赞同：2
> 
> 时间：2009-05-08T21:03:34.283
> 
> 标签：php, http, post

我正在尝试在 PHP 脚本中读取 POST 数据。

我的第一直觉把我带到了`$_POST[]`数组，但无论出于什么原因，它从来没有填充过。

我正在使用适用于 OS X 的 HTTP 客户端[http://ditchnet.org/httpclient/](http://ditchnet.org/httpclient/)来发送 POST 请求。我输入脚本的 URL，将方法设置为 POST，将内容类型标头设置为 text/plain，然后`myVar=foobar`作为请求的正文输入。

我点击发送，`$_POST[]`数组中没有任何内容。

在 StackOverflow 上阅读了一些问题后，我尝试了另一条路线，并尝试从 中阅读`$HTTP_RAW_POST_DATA`，但那里也没有骰子。我也尝试从`php://input`流中读取，但什么也没有。

作为提醒，`$_GET[]`如果我向 URL 添加一些参数，我可以从数组中读取，但我不想这样做。

我还需要从不同的应用程序发布数据，所以我不能使用 HTML 发布表单......

任何帮助都会很棒，谢谢大家！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T21:10:08.463

将 Content-Type 标头设置为 application/x-www-form-urlencoded。text/plain[不是](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.4)帖子数据的有效内容类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T21:58:02.327

如果您想阅读原始请求正文，可以使用：

```
file_get_contents('php://input'); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-08T21:09:22.287

检查post是否可以从浏览器中运行...我怀疑您使用的HTTP客户端没有正确发送请求。

GET 请求比多部分 POST 请求简单得多。

# c# - 在 Visual Studio 中以编程方式应用/停用断点

> ID：841782
> 
> 赞同：18
> 
> 时间：2009-05-08T21:03:40.303
> 
> 标签：c#, .net, visual-studio, breakpoints

不管其他可能达到相同结果的选项（即手动添加断点），是否可以以编程方式将断点添加到 Visual Studio 项目的源代码中？

如：

```
try
{
    FunctionThatThrowsErrors(obj InscrutableParameters);
}
catch(Exception ex)
{
    Log.LogTheError(ex);
    AddBreakPointToCallingFunction();
} 
```

这样当你下次在调试中运行时，它会自动在上次运行期间引起问题的所有点设置断点。

我并不是说这是一种特别有用的调试方式。我只是想知道是否有能力。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-08T21:06:52.403

你可以打电话[`System.Diagnostics.Debugger.Break()`](http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.break.aspx)。

您还可以告诉 Visual Studio 中断所有异常，甚至是已处理的异常，方法是转到菜单`Debug->Exceptions...`并检查`Thrown`当前仅选中“用户未处理”的所有位置。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-05-09T11:07:30.103

你启发了我去探索这个——感谢你让我整夜保持清醒。:) 这是您可以做到的一种方法。

Visual Studio 有非常好的断点支持。更酷的功能之一是您可以告诉它在断点被命中时运行 Visual Studio 宏。这些宏可以完全访问开发环境，即它们可以执行您可以在键盘上手动执行的任何操作，包括设置其他断点。

该解决方案是 1) 在程序中放置一个顶级 try/catch 以捕获所有异常，2) 在运行宏的 catch 块中放置一个断点，以及 3) 让宏查看异常以找出在哪里它来自，并在那里放置了一个断点。当您在调试器中运行它并发生异常时，您将在有问题的代码行处有一个新断点。

拿这个示例程序：

```
using System;

namespace ExceptionCallstack
{
    class Program
    {
        static void Main(string[] args)
        {
            try
            {
                func1();
            }
            catch (Exception e)
            {
                Console.WriteLine("Oops");
                Console.ReadKey();
            }
        }

        static void func1()
        {
            func2();
        }

        static void func2()
        {
            func3();
        }

        static void func3()
        {
            throw new Exception("Boom!");
        }
    }
} 
```

目标是`throw`当您在调试器中运行 func3 并得到错误时，以编程方式在 func3 中设置断点。为此，首先创建一个新的 Visual Studio 宏（我调用了我的 SetBreakpointOnException）。将此粘贴到新模块 MyDebuggerMacros 或其他任何内容中：

```
Imports System
Imports EnvDTE
Imports EnvDTE80
Imports EnvDTE90
Imports System.Diagnostics
Imports System.Text.RegularExpressions

Public Module DebuggerMacros

    Sub SetBreakpointOnException()

        Dim output As String = ""

        Dim stackTrace As String = DTE.Debugger.GetExpression("e.StackTrace").Value
        stackTrace = stackTrace.Trim(New Char() {""""c})
        Dim stackFrames As String() = Regex.Split(stackTrace, "\\r\\n")

        Dim r As New Regex("^\s+at .* in (?<file>.+):line (?<line>\d+)$", RegexOptions.Multiline)
        Dim match As Match = r.Match(stackFrames(0))
        Dim file As String = match.Groups("file").Value
        Dim line As Integer = Integer.Parse(match.Groups("line").Value)

        DTE.Debugger.Breakpoints.Add("", file, line)

    End Sub

End Module 
```

一旦这个宏就位，回到`catch`块并用 F9 设置一个断点。然后右键单击红色断点圆圈并选择“When Hit...”。在结果对话框的底部，有一个选项告诉它运行宏 - 下拉列表并选择您的宏。现在，当您的应用程序抛出未处理的异常时，您应该获得新的断点。

关于这一点的注意事项和警告：

*   我**不是**正则表达式大师，我相信其他人可以做出更好的东西。
*   这不处理嵌套异常（InnerException 属性）——如果你愿意，你可以反对它。:) 检查 GetExpression("e.InnerException") 和递归，也许。
*   它对 excpetion 的 StackTrace 字符串进行文本解析，而不是更复杂的对象图分析（深入研究 Exception.TargetSite 并使用反射）。通常的警告适用于这种方法的脆弱性。
*   出于某种原因，它似乎将断点放入了某个“备用空间”。初始调试会话结束后，您将看不到代码中的新断点。但是如果你在调试器中再次运行程序，它就在那里，并且像“禁用所有断点”这样的东西会影响它。如果有人想找到一种方法来清理它，那么了解正在发生的事情会很好。也许在 .suo 文件中挖掘？

希望这可以帮助！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-08T21:12:06.120

它并没有真正响应您的问题，但您可以根据您使用[Debug.Assert](http://msdn.microsoft.com/en-us/library/system.diagnostics.debug.assert.aspx)设置的条件导致调试器中断。因此，与其说“下次我运行导致异常的函数，请中断”，您可以在函数中添加断言以在条件不应该时中断。毕竟，不能保证一个函数仅仅因为上次抛出异常就抛出异常。:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T21:09:09.823

我认为您不能真正“添加断点”，但是您可以通过调用 System.Diagnostics.Debugger.Break() 指示调试器暂停执行，以便检查出了什么问题

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-25T15:56:45.520

此外，Visual Basic 有一个名为 Stop 的关键字，它本质上将充当断点和中断执行。

# database - 我可以从 sql server 存储过程中更新非 sql server 数据库吗？

> ID：841783
> 
> 赞同：1
> 
> 时间：2009-05-08T21:03:53.300
> 
> 标签：database

是否可以使用 SQL Server 存储过程更新不同的 ODBC 数据库。例如，假设我有 Access、MySQL 等。我更新了我的 SQL Server 数据库，并且我希望存储过程更新另一个 ODBC 数据库。有点像穷人的复制品。

有没有更好的方法在不同的数据库系统之间进行复制？

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T21:21:53.333

添加链接服务器应该可以解决您的问题。您可以选择提供程序，包括 ODBC。

[http://msdn.microsoft.com/en-us/library/ms188279.aspx](http://msdn.microsoft.com/en-us/library/ms188279.aspx)

# perl - 如何包含位于不同目录中的 Perl 模块？

> ID：841785
> 
> 赞同：50
> 
> 时间：2009-05-08T21:04:25.560
> 
> 标签：perl, module

如何包含位于不同目录中的 Perl 模块？它必须是包含它的模块的相对路径。

我试过了

```
push ( @INC,"directory_path/more_path"); 
```

还

```
push ( @INC,"directory_path\\more_path"); 
```

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-05-08T21:12:06.680

编辑：首先提出正确的解决方案，最初来自[这个问题](https://stackoverflow.com/questions/185114/how-do-i-use-a-perl-module-in-a-directory-not-in-inc)。它是唯一一个相对于**模块**目录进行搜索的：

```
use FindBin;                 # locate this script
use lib "$FindBin::Bin/..";  # use the parent directory
use yourlib; 
```

还有许多其他方法可以搜索相对于**当前**目录的库。您可以使用 -I 参数调用 perl，并传递另一个模块的目录：

```
perl -I.. yourscript.pl 
```

您可以在 perl 脚本顶部附近添加一行：

```
use lib '..'; 
```

您可以在运行脚本之前修改环境变量 PERL5LIB：

```
export PERL5LIB=$PERL5LIB:.. 
```

push(@INC) 策略也可以工作，但它必须包含在 BEGIN{} 中以确保在模块搜索之前运行推送：

```
BEGIN {push @INC, '..'}
use yourlib; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-08T21:42:28.743

您的推送不起作用的原因很可能是执行顺序。

`use`是一个编译时指令。您`push`在执行时完成：

```
push ( @INC,"directory_path/more_path");
use Foo.pm;  # In directory path/more_path 
```

您可以使用 BEGIN 块来解决此问题：

```
BEGIN {
    push ( @INC,"directory_path/more_path");
}
use Foo.pm;  # In directory path/more_path 
```

IMO，这是最清楚的，因此最好`use lib`：

```
use lib "directory_path/more_path";
use Foo.pm;  # In directory path/more_path 
```

有关 BEGIN 和其他特殊块以及它们何时执行的信息，请参阅[perlmod 。](http://perldoc.perl.org/perlmod.html#BEGIN%2c-UNITCHECK%2c-CHECK%2c-INIT-and-END)

**编辑**

为了加载与您的脚本/库相关的代码，我强烈支持[File::FindLib](https://metacpan.org/pod/File::FindLib)

您可以说`use File::FindLib 'my/test/libs';`在路径中脚本上方的任何位置查找库目录。

假设您的工作结构如下：

```
 /home/me/projects/
    |- shared/
    |   |- bin/
    |   `- lib/
    `- ossum-thing/
       `- scripts 
           |- bin/
           `- lib/ 
```

在脚本中`ossum-thing/scripts/bin`：

```
use File::FindLib 'lib/';
use File::FindLib 'shared/lib/'; 
```

将找到您的库目录并将它们添加到您的`@INC`.

创建一个包含运行工具套件所需的所有环境设置的模块并将其加载到项目中的所有可执行文件中也很有用。

```
use File::FindLib 'lib/MyEnvironment.pm' 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-08T21:10:48.180

'use lib' 也可以采用单个字符串值...

```
#!/usr/bin/perl
use lib '<relative-path>';
use <your lib>; 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-09T20:26:43.300

来自[perlfaq8：](http://faq.perl.org/perlfaq8.html#How_do_I_add_the_dir)

* * *

**如何将我的程序所在的目录添加到模块/库搜索路径中？**

（由布赖恩·d·福伊提供）

如果您已经知道该目录，则可以像添加任何其他目录一样将其添加到 @INC。如果您在编译时知道目录，则可以使用 lib：

```
use lib $directory; 
```

这个任务的诀窍是找到目录。在您的脚本执行任何其他操作（例如 chdir）之前，您可以使用 Perl 附带的 Cwd 模块获取当前工作目录：

```
BEGIN {
    use Cwd;
    our $directory = cwd;
    }

use lib $directory; 
```

您可以使用 $0 的值执行类似的操作，其中包含脚本名称。这可能包含相对路径，但 rel2abs 可以将其转换为绝对路径。一旦你有了

```
BEGIN {
    use File::Spec::Functions qw(rel2abs);
    use File::Basename qw(dirname);

    my $path   = rel2abs( $0 );
    our $directory = dirname( $path );
    }

use lib $directory; 
```

Perl 附带的 FindBin 模块可能会起作用。它找到当前运行脚本的目录并将其放入 $Bin 中，然后您可以使用它来构建正确的库路径：

```
use FindBin qw($Bin); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-08-06T12:54:22.623

我很惊讶以前没有人提到它，但是[FindBin::libs](http://search.cpan.org/perldoc?FindBin%3A%3Alibs)总是会找到你的库，因为它会在相对于脚本位置的所有合理位置进行搜索。

```
#!/usr/bin/perl
use FindBin::libs;
use <your lib>; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-26T06:45:46.410

我会告诉你如何在eclipse中完成。我的开发系统 - Windows 64bit、Eclipse Luna、Eclipse 的 Perlipse 插件、Strawberry Pearl 安装程序。我使用 perl.exe 作为我的解释器。

Eclipse > 创建新的 perl 项目 > 右键单击​​项目 > 构建路径 > 配置构建路径 > 库选项卡 > 添加外部源文件夹 > 转到安装所有 perl 模块的文件夹 > ok > ok。完毕 ！

# math - 函数式程序“在数学上更易于处理”的说法是什么意思？

> ID：841792
> 
> 赞同：3
> 
> 时间：2009-05-08T21:06:57.427
> 
> 标签：math, functional-programming

函数式程序“在数学上更易于处理”的说法是什么意思？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-08T21:14:52.757

这意味着您可以更轻松地证明程序正确（例如，通过数学归纳法）。有状态的程序（就像大多数用面向对象语言编写的程序一样）很难通过方程建模，因此很难通过方程和数学定理来推理它们。

这听起来像是理论上的胡说八道，但有重要的应用。人们赖以生存的软件（空中交通管制、导弹制导系统等）需要被证明是正确的，因为传统的测试根本无法涵盖所有​​可能的情况。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-08T21:12:41.593

[维基百科对函数式编程](http://en.wikipedia.org/wiki/Functional_programming)的定义始于：

> 在计算机科学中，函数式编程是一种编程范式，它将计算视为对数学函数的评估，避免了状态和可变数据。

换句话说，可以用数学方法证明函数式程序（几乎）不可能证明命令式程序的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T21:35:02.367

这意味着您可以更轻松地应用数学技术来理解以函数式语言或风格编写的程序。例如，您可以使用评估的替换模型来计算这个 Erlang 程序的评估结果：

```
% function definitions
accumulate(F, Init, []) -> Init;
accumulate(F, Init, [H | T]) -> F(H, accumulate(F, Init, T).
Add = fun(x, y) -> x + y end.

% expression to evaluate
accumulate(Add, 0, [3, 2, 4]). 
```

使用替换模型，最后一行等效于以下各项：

```
Add(3, accumulate(Add, 0, [2, 4]).
3 + accumulate(Add, 0, [2, 4]).
3 + Add(2, accumulate(Add, 0, [4])).
3 + (2 + accumulate(Add, 0, [4])).
3 + (2 + Add(4, accumulate(Add, 0, [])).
3 + (2 + (4 + accumulate(Add, 0, []))).
3 + (2 + (4 + 0)). 
```

当您使用函数式样式时，用这样的值替换变量是可行的，因为一旦分配了变量，其值将始终相同。这反映了变量在数学中的使用方式：变量的每次出现（在同一范围内）总是代表相同的值。相比之下，执行以下 C 代码时，i 的值在不同时间是不同的：

```
int i;
for (i = 0; i < 10; i++) {
    ;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T21:12:12.920

这意味着您可以更轻松地查看一段代码并跟踪程序的流程。

由于函数式程序不是通过语句的顺序运行，它只是返回其他函数调用的结果，因此您可以更轻松地跟踪一个调用到另一个调用。

此外，使用函数式程序在数学上证明正确性要容易得多。

好的，所以查看代码可能不会更容易，但更容易推断代码的作用。更*容易*可能不是正确的词。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-09T01:31:54.123

很难猜出原作者的意思，但区分纯函数式语言的一件事是，您总是可以用 equals 代替 equals 并应用代数定律。这意味着您可以使用程序进行**计算**，就像使用高中代数中的公式进行计算一样。

这样做有两个很好的理由：

*   您将复杂的代码片段计算为等效但更简单的代码。

*   您编写了一段“显然没有错误”的简单代码，但结果证明它效率低下。因此，您计算出一个等效版本，它运行起来就像地狱中的蝙蝠一样。

第二种技术的过去大师是牛津大学教授[理查德伯德](http://www.comlab.ox.ac.uk/people/Richard.Bird/index.html)。他的一些东西，比如他的数独求解器或他的 Burrows-Wheeler 压缩 ( `bzip2`) 实现绝对令人惊叹。阅读他的论文！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T21:12:23.013

您可以在代码执行的某些点将条件声明为真或假，或者变量具有特定值等。例如，如果你有一个不可变对象，你可以声明它的内容永远不会改变。然后你可以将它传递给一个方法，并且知道在方法返回后你可以继续使用它，并且它的内容将与你调用该方法之前的内容相同。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T21:12:46.490

所有程序最终都是一个大数字（当然以二进制表示）。函数程序比面向对象的程序更容易转换成这个数字（所有其他条件都相同），因此在数学上更容易处理。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-09T04:41:43.730

在数学中，给定`y=f(x)`的值总是相同的。总是，如果有月食，或者土星没有与火星对齐并不重要。`y``x`

在数学中，函数没有副作用。这意味着如果你先解析函数`f(x)`，然后再解析函数`g(x)`，第一个函数对第二个函数根本没有任何影响。如果`g(2)`被定义为它会给你一个`4`，世界上没有什么`g(2)`能让你突然给你一个`8`，这是不可能的。

函数的值仅取决于其参数的值。

但是对于典型的程序，这条规则几乎总是被打破。许多功能都有副作用是很常见的。命令式和面向对象的语言强烈鼓励这种编程。

使用纯函数式语言，这类问题更容易避免。在函数式语言中，函数具有与数学函数相同的属性，称为*“引用透明性”*，这意味着您可以用已知值替换对函数的调用，程序将继续正确计算；如果具有给定参数的函数的值是已知的，则函数没有必要执行它的主体，因为函数不会有副作用。

这对于证明函数的正确性很有用，对优化也很有帮助。

以下维基百科文章可能会引起您的兴趣：

[参考透明度（计算机科学）](http://en.wikipedia.org/wiki/Referential_transparency_(computer_science))

# asp.net - 多台服务器上的 Asp.net Web 应用程序

> ID：841801
> 
> 赞同：1
> 
> 时间：2009-05-08T21:09:26.313
> 
> 标签：asp.net, sql-server, deployment, web-farm

我想知道我需要什么才能将我的 asp.net Web 应用程序安装在多个服务器上，让它们作为一个整体工作。

提前致谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T21:15:41.710

您需要一个负载平衡器，它会自动在托管应用程序的不同服务器之间路由请求。

[http://www.hanselman.com/blog/LoadBalancingAndASPNET.aspx](http://www.hanselman.com/blog/LoadBalancingAndASPNET.aspx)

# c# - 为什么 XPathSelectElement 会给出 NullReferenceException？

> ID：841802
> 
> 赞同：1
> 
> 时间：2009-05-08T21:09:46.437
> 
> 标签：c#, linq, xpath, nullreferenceexception

以下代码给出了 NullReferenceException，因为 XPathSelectElement 无法浏览我给出的 XPath 表达式：

```
String description = (String)node.XPathSelectElement("//car").Attribute("description"); 
```

我已经对此进行了调试并验证了节点是否被正确读取，并且我的 XPath 中的元素的大写方式与它们在我的 XML 文件中的方式相同。我知道有一个“汽车”元素具有一个名为“描述”的属性。这怎么行不通？它是否与需要 XPath 的 LocalName 版本有关？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T21:13:12.387

如果您的 XML 文档使用名称空间，那可能就是问题所在。如果 //car 位于默认名称之外的另一个名称空间中，则 XPathSelectElement 将无法找到该节点。（您必须使用正确的命名空间作为前缀）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T22:04:33.217

即使您修复了可能是命名空间问题，您仍然必须检查以确保在查找属性之前找到了汽车。

# iis - IIS 身份验证挑战，即使打开了 Anony .. 为什么？

> ID：841807
> 
> 赞同：0
> 
> 时间：2009-05-08T21:11:01.473
> 
> 标签：iis, windows-server-2003

我有一个安装了 .net 3.5 sp1 的 Windows 2003 服务器（WEB 版）。

我有六个网站，所有这些网站都在向我挑战用户名和密码。如果我提供域用户名，我会很好...

但是，我将网站设置为允许匿名访问。网站文件/文件夹都具有适当的 IUSR 安全设置，我无法摆脱挑战。我什至已经让每个人都完全控制了......仍然没有骰子。

还有其他地方我可以检查以克服这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T21:18:55.417

如果这些是 .net 网站，您需要确保“网络服务”用户帐户对网站文件夹/文件具有适当的权限。

此外，请确保“网络服务”可以完全控制位于此处的“临时 Aspnet 文件”目录：C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T21:18:36.540

我不认为你可以。仅仅因为启用了匿名访问并不意味着没有具有更多权限的用户，因此它必须检查是否提供了任何凭据。

# wpf - WPF：将布尔值显示为“是”/“否”

> ID：841808
> 
> 赞同：44
> 
> 时间：2009-05-08T21:11:48.757
> 
> 标签：wpf, data-binding, xaml, formatting

我有一个布尔值，需要在 TextBlock 中显示为“是”或“否”。我正在尝试使用 StringFormat 执行此操作，但我的 StringFormat 被忽略并且 TextBlock 显示“True”或“False”。

```
<TextBlock Text="{Binding Path=MyBoolValue, StringFormat='{}{0:Yes;;No}'}" /> 
```

我的语法有问题，还是不支持这种类型的 StringFormat？

我知道我可以使用 ValueConverter 来完成此操作，但 StringFormat 解决方案似乎更优雅（如果有效）。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2011-08-16T16:11:17.553

您也可以使用[这个超值转换器](https://web.archive.org/web/20200627025931/http://geekswithblogs.net/codingbloke/archive/2010/05/28/a-generic-boolean-value-converter.aspx)

然后在 XAML 中声明如下：

```
<local:BoolToStringConverter x:Key="BooleanToStringConverter" FalseValue="No" TrueValue="Yes" /> 
```

你可以像这样使用它：

```
<TextBlock Text="{Binding Path=MyBoolValue, Converter={StaticResource BooleanToStringConverter}}" /> 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-05-08T21:28:18.733

您使用 StringFormat 的解决方案无法正常工作，因为它不是有效的格式字符串。

我写了一个标记扩展，可以做你想做的事。你可以这样使用它：

```
<TextBlock Text="{my:SwitchBinding MyBoolValue, Yes, No}" /> 
```

这里是标记扩展的代码：

```
public class SwitchBindingExtension : Binding
{
    public SwitchBindingExtension()
    {
        Initialize();
    }

    public SwitchBindingExtension(string path)
        : base(path)
    {
        Initialize();
    }

    public SwitchBindingExtension(string path, object valueIfTrue, object valueIfFalse)
        : base(path)
    {
        Initialize();
        this.ValueIfTrue = valueIfTrue;
        this.ValueIfFalse = valueIfFalse;
    }

    private void Initialize()
    {
        this.ValueIfTrue = Binding.DoNothing;
        this.ValueIfFalse = Binding.DoNothing;
        this.Converter = new SwitchConverter(this);
    }

    [ConstructorArgument("valueIfTrue")]
    public object ValueIfTrue { get; set; }

    [ConstructorArgument("valueIfFalse")]
    public object ValueIfFalse { get; set; }

    private class SwitchConverter : IValueConverter
    {
        public SwitchConverter(SwitchBindingExtension switchExtension)
        {
            _switch = switchExtension;
        }

        private SwitchBindingExtension _switch;

        #region IValueConverter Members

        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            try
            {
                bool b = System.Convert.ToBoolean(value);
                return b ? _switch.ValueIfTrue : _switch.ValueIfFalse;
            }
            catch
            {
                return DependencyProperty.UnsetValue;
            }
        }

        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            return Binding.DoNothing;
        }

        #endregion
    }

} 
```

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2013-06-13T14:36:19.577

不带转换器

```
 <TextBlock.Style>
                <Style TargetType="{x:Type TextBlock}">
                    <Setter Property="Text" Value="OFF" />
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding MyBoolValue}" Value="True">
                            <Setter Property="Text" Value="ON" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </TextBlock.Style> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-10-08T17:42:15.157

还有另一个非常棒的选择。检查这个：[Alex141 CalcBinding](https://github.com/Alex141/CalcBinding)。

在我的 DataGrid 中，我只有：

```
<DataGridTextColumn Header="Mobile?" Binding="{conv:Binding (IsMobile?\'Yes\':\'No\')}" /> 
```

要使用它，您只需通过 Nuget 添加 CalcBinding，而不是在 UserControl/Windows 声明中添加

```
<Windows XXXXX xmlns:conv="clr-namespace:CalcBinding;assembly=CalcBinding"/> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-09-30T07:35:55.493

This is a solution using a `Converter` and the `ConverterParameter` which allows you to easily define different `strings` for different `Bindings`:

```
public class BoolToStringConverter : IValueConverter
{
    public char Separator { get; set; } = ';';

    public object Convert(object value, Type targetType, object parameter,
                          CultureInfo culture)
    {
        var strings = ((string)parameter).Split(Separator);
        var trueString = strings[0];
        var falseString = strings[1];

        var boolValue = (bool)value;
        if (boolValue == true)
        {
            return trueString;
        }
        else
        {
            return falseString;
        }
    }

    public object ConvertBack(object value, Type targetType, object parameter,
                              CultureInfo culture)
    {
        var strings = ((string)parameter).Split(Separator);
        var trueString = strings[0];
        var falseString = strings[1];

        var stringValue = (string)value;
        if (stringValue == trueString)
        {
            return true;
        }
        else
        {
            return false;
        }
    }
} 
```

Define the Converter like this:

```
<local:BoolToStringConverter x:Key="BoolToStringConverter" /> 
```

And use it like this:

```
<TextBlock Text="{Binding MyBoolValue, Converter={StaticResource BoolToStringConverter},
                                       ConverterParameter='Yes;No'}" /> 
```

If you need a different separator than `;` (for example `.`), define the Converter like this instead:

```
<local:BoolToStringConverter x:Key="BoolToStringConverter" Separator="." /> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-03-16T12:21:58.933

这是另一种具有“硬编码”是/否值的简化转换器

```
[ValueConversion(typeof (bool), typeof (bool))]
public class YesNoBoolConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        var boolValue = value is bool && (bool) value;

        return boolValue ? "Yes" : "No";
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        return value != null && value.ToString() == "Yes";
    }
} 
```

XAML 用法

```
<DataGridTextColumn Header="Is Listed?" Binding="{Binding Path=IsListed, Mode=TwoWay, Converter={StaticResource YesNoBoolConverter}}" Width="110" IsReadOnly="True" TextElement.FontSize="12" /> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-12-09T07:18:49.817

基于[Cedre 的回答的](https://stackoverflow.com/a/17089837/5485989)更详细的版本：

`User.cs`

```
namespace DataTriggerDemo.Model
{
    public class User : INotifyPropertyChanged
    {
        private bool isConnected = false;
        public bool IsConnected
        {
            get => isConnected;
            set
            {
                isConnected = value;
                OnPropertyChanged(nameof(IsConnected));
            }
            public event PropertyChangedEventHandler PropertyChanged;
            public void OnPropertyChanged(string propertyName)
            {
                if (PropertyChanged != null)
                {
                    PropertyChanged.Invoke(this, new PropertyChangedEventArgs(propertyName));
                }
            }
        }
    }
} 
```

`MainWindow.xaml.cs`

```
public partial class MainWindow : Window
{
    private User user;
}

private void Window_Loaded(object sender, RoutedEventArgs e)
{
    user = FindResource("user") as User;
}

private void ButtonStart_Click(object sender, RoutedEventArgs e)
{
    user.IsConnected = !user.IsConnected;
    return;
} 
```

`MainWindow.xaml`

```
<Window x:Class="DataTriggerDemo.MainWindow"

        xmlns:model="clr-namespace:DataTriggerDemo.Model"
        Title="Data Trigger Demo" Height="100" Width="100" Loaded="Window_Loaded">

    <Window.Resources>
        <model:User x:Key="user"/>
    </Window.Resources>
    <!-- ... -->
    <TextBlock>
        <TextBlock.Style>
            <Style TargetType="{x:Type TextBlock}">
                <Setter Property="Text" Value="Disconnected" />
                <Style.Triggers>
                    <DataTrigger Binding="{Binding Source={StaticResource ResourceKey=user}, Path=IsConnected}" Value="True">
                        <Setter Property="Text" Value="Connected" />
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </TextBlock.Style>
    </TextBlock>
    <!-- ... -->
</Window> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-05-22T17:05:52.510

以下内容在 datagridtextcolumn 中对我有用：我向我的类添加了另一个属性，该属性根据 MyBool 的值返回一个字符串。请注意，在我的情况下，数据网格绑定到 MyClass 对象的 CollectionViewSource。

C＃：

```
public class MyClass        
{     
    public bool MyBool {get; set;}   

    public string BoolString    
    {    
        get { return MyBool == true ? "Yes" : "No"; }    
    }    
} 
```

XAML：

```
<DataGridTextColumn Header="Status" Binding="{Binding BoolString}"> 
```

# php - PHP Netbeans - 来自现有来源的新项目要求索引文件？

> ID：841811
> 
> 赞同：0
> 
> 时间：2009-05-08T21:12:06.167
> 
> 标签：php, netbeans6.5, new-project

我正在尝试从现有来源在 NetBeans PHP 中创建一个新项目。当我尝试创建一个新项目时，它会询问我索引文件的位置。什么是 NetBeans 上下文中的索引文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T21:18:38.177

索引文件是调试会话的起始文件。通常它是应用程序根目录中的 index.php。当您设置它时，它将成为您在 NetBeans 中按调试时的默认起点。

# c# - 您将如何在 Java/Servlet 和 .NET 之间传输会话信息

> ID：841826
> 
> 赞同：1
> 
> 时间：2009-05-08T21:14:58.763
> 
> 标签：c#, java, .net, servlets

我有一个基于 Java Servlet 技术的网络应用程序。我正在考虑切换到一个新框架，可能会切换到带有 C# 和 ASP MVC 的 .NET 堆栈。我不想在开发新应用时关闭当前应用。目标是让旧系统运行并在新架构中开发新模块。

如果我继续使用 Java 堆栈，我认为这只是一个 servlet 映射问题。但是，如果我切换到 .NET 堆栈，我将不得不在两个系统之间传输会话。这是一种简单的方法吗？我必须使用 SOAP 之类的东西吗？

有没有人有做这样的事情的经验？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T21:30:29.803

没有肥皂。这简单：

1) 确保您的 Java Web 应用程序使用基于客户端（浏览器）的机制来跟踪会话。（Cookies、url 编码等）

2) 如果您将复杂的 java 对象放在当前会话中，请进行必要的更改，以便将其简化为（有效地）键/值字典。

3）设置一个外部系统（例如数据库）来存储基于（1）中的会话ID的键/值会话数据

4) 你将不再使用 Servlet 会话机制。相反，您将需要编写基本会话管理器，该管理器返回给定会话 ID 的 Map。

-- 在 .NET / Python / Woof 方面

5) 您仍在使用与 (1) 相同的容器不变机制来识别会话

6) 您需要为您的 .NET 容器复制会话管理器 (4)。您是否为 (3) 选择了 RDBM？那么这只不过是使用相同的会话密钥对同一个数据库进行查询

7）您现在使用 2 个不同的容器为同一个应用程序提供不同的页面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T21:16:26.000

他们使用相同的数据库吗？只需将会话记录信息存储在数据库表记录中，并在两个系统之间传递记录的 id。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T22:28:43.393

我认为最好的方法是在两个系统上实现自定义会话提供程序，以便将会话数据存储在一个公共数据库中。这在 .NET 中是可能的，我认为在 Java 中也是可能的......

您应该看看这个页面，它解释了如何在 .NET 中实现自定义会话状态存储提供程序：http: [//msdn.microsoft.com/en-us/library/ms178587.aspx](http://msdn.microsoft.com/en-us/library/ms178587.aspx) 在 VB 中有一个示例实现.NET（请参阅页面底部的链接）

# latex - 同一文件中多种语言的语法高亮显示：StatWeave/SAS/LaTeX

> ID：841831
> 
> 赞同：3
> 
> 时间：2009-05-08T21:17:01.893
> 
> 标签：latex, editor, syntax-highlighting, sas

我正在使用 StatWeave 从 LaTeX 文件中运行 SAS 代码。我希望能够在文本编辑器中打开一个文件并查看带有 LaTeX 语法突出显示的主要 LaTeX 文档和带有 SAS 语法突出显示的嵌入式 SAS“代码块”。（“代码块”是真实的（工作的）代码，不仅仅是为了显示，所以我认为 LaTeX 列表包不会工作。）我确信必须有一种方法可以用 emacs 做到这一点，但我没有'不知道它是什么......在这一点上，我对任何编辑器的任何解决方案都持开放态度。

2010 年 2 月 5 日更新：我认为最好的方法实际上是停止尝试使用 StatWeave 和 SAS，而是学习使用 Sweave 和 R。我对 Vim 中的 Sweave 突出显示感到满意，但我认识其他人对 ESS 非常满意，所以我会继续接受这个答案，这样我们就可以结束这个问题了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T07:51:22.430

也许 Emacs Wiki 上的[MultipleModes](http://www.emacswiki.org/emacs/MultipleModes)页面上的解决方案之一会有所帮助。此外，[Sweave](http://www.stat.uni-muenchen.de/~leisch/Sweave/)的手册说[Emacs Speaks Statistics](http://ess.r-project.org/)可以处理 Sweave 文件，因此由于 StatWeave 看起来很相似，也许您也可以破解 ESS 来处理这些文件。ESS 似乎已经支持 SAS，因此所需的更改可能不会太大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-19T19:00:29.200

是否可以选择不在代码中直接包含 sas 文件，而是使用 '\input' 代替？我经常对源示例做的一件事是将它们放在子目录 samples/ 中，然后使用“highlight”创建可以包含在主文件中的 LaTeX 文件。这样我就可以在每次更改源文件时执行它们以检查它们是否正常工作。tex 代码的（重新）生成可以通过 shell 脚本或 make 如果它是一个更大的项目来完成。在大多数情况下，一个简单的 generate_tex.sh 脚本对于我在更改任何示例后调用的项目就足够了。它的内容可能类似于

```
#!/bin/bash
highlight -L -f --wrap-simple *.css --outdir ../input/
highlight -L -f --wrap-simple *.html --outdir ../input/
highlight -L -f --wrap-simple *.php --outdir ../input/ 
```

对于一个网络项目。然后在主 tex 文件中包含使用的示例

```
\input{filename.css} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-29T06:05:13.153

UltaEdit 可能有效，但您必须进行大量设置

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-20T00:39:50.357

如果您使用的是 xemacs，则可以使用 mmmmode 来突出显示语法。我将 ESS 与 statweave 一起使用，因此第一人称回答为什么不使用 ESS 来突出显示并使用 statweave 来完成工作。然而，我不使用 SAS，但在同一个文件中使用了 stata 和 R，它们都使用自己的语法突出显示。（需要'mmm-mode）（需要'mmm-vars）（setq mmm-global-mode'也许）（setq mmm-submode-decoration-level 1）

(mmm-add-group 'latex-stats'((r-tag :submode r-mode :face mmm-code-submode-face :delimiter-mode nil :front "begin{Rcode}" :back "end{Rcode} " :back-offset (backward-char -1) :insert ((?R R-tag nil @ "\begin{Rcode}" @ "\n" _ "\n" @ "\end{Rcode}" @) ) ) (sta-tag :submode STA-mode :face mmm-code-submode-face :delimiter-mode nil :front "begin{Statacode}" :back "end{Statacode}" :back-offset (backward-char - 1) :insert ((?S STATA-tag nil @ "\begin{Statacode}" @ "\n" _ "\n" @ "\end{Statacode}" @)) )))

（添加到列表'mmm-mode-ext-classes-alist'（无“-swv.tex”乳胶统计））

您只需要更改为 SAS 模式（我想如果这就是所谓的），我在我的 latex.el 文件（在 init.el 中加载了一个 lambda）中有以下（local-set-key [（控制 f1)]
'(lambda () (interactive) (if (string-match "\.tex" buffer-file-name) (progn (let (file-name file-name1 file-name-wihoutswv) (setq file-name (buffer- file-name)) (setq file-name1 (file-name-nondirectory file-name)) (setq file-name-wihoutswv (replace-regexp-in-string "-swv" "" file-name1)) (setq file -name-wihoutswv (replace-regexp-in-string "\.tex" "" file-name-wihoutswv)) (if (string-match "-swv\.tex" buffer-file-name) (find-file- other-window (concat file-name-wihoutswv ".tex")) (find-file-other-window (concat file-name-wihoutswv "-swv.tex")) ) ) (消息“你在 Latex-模式，这既不是 swv 也不是 TeX 文件。无法打开相应的 tex 或 sweave 文件“））））

和

(global-set-key [f1]
'(lambda () (interactive) (save-buffer) (if (string-match "-swv\.tex" buffer-file-name) (progn (interactive) (latex-mode ) ;;(font-lock-fontify-buffer) (balance-windows) (mylatex-delete-indent) (save-buffer) (save-window-excursion (run-current-statweave-file)) ; (mylatex-clean ) ) (if (string-match "\.tex" buffer-file-name) (progn (interactive) (latex-mode) ;(font-lock-fontify-buffer) (balance-windows) (do-pdf) ; （mylatex-clean））（消息“这既不是 TeX 也不是 SWV 文件，除了将缓冲区保存到文件之外，我不知道该怎么做。所以我做了”））））

)

) (save-window-excursion (setq status (shell-command cmd1-str output-buffer))) ;;(消息状态) ;; (let (status) ((shell-command cmd1-str output-buffer)))))))

 *它看起来很糟糕，而且我不是 lisp 专家，所以我确信它有很多效率低下的地方，但它确实有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-15T16:04:07.267

您可以尝试新的 StatReport LateX 类，它有点像 Sweave，但完全在 LaTeX 中实现。

**工作流程：** 运行一次并获取 SAS 代码，在 SAS 中运行该代码，再次运行 laTeX 并获取包含的输出。

如果我没记错的话，我认为它会为代码着色（使用 SASnRdisplay 类）。

请参阅此处的论文：http: [//support.sas.com/resources/papers/proceedings12/324-2012.pdf](http://support.sas.com/resources/papers/proceedings12/324-2012.pdf) 和 CTAN 以获取软件包文档[http://mirror.switch.ch/ftp/mirror/tex/macros/乳胶/contrib/statrep/statrep.pdf](http://mirror.switch.ch/ftp/mirror/tex/macros/latex/contrib/statrep/statrep.pdf)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-15T16:08:24.017

讨论 jean 的回应：我一直遇到的 ESS 问题是 Windows（我运行 SAS 的地方）支持的功能不足。

因此，Statweave 对我一点用处都没有。

现在有一个 SAS Linux 版本，所以我想它可以更好地工作。

# c# - LINQ2SQL：如何声明 var 类型的成员变量？

> ID：841848
> 
> 赞同：1
> 
> 时间：2009-05-08T21:19:58.533
> 
> 标签：c#, .net, linq-to-sql, var

我有这样的课

```
 public class foo
    {

        private void getThread()
        {
         var AllThreads = from sc in db.ScreenCycles
                          join s in db.Screens on sc.ScreenID equals s.ScreenID
                          select s;
        }
    } 
```

我想让 AllThreads 变量成为类变量而不是方法变量。像这样...

```
public class foo
{
    var AllThreads;
    private void getThread()
    {
       AllThreads = from sc in db.ScreenCycles
                          join s in db.Screens on sc.ScreenID equals s.ScreenID
                          select s;
    }
} 
```

它不会让我声明一个 var 类型的类变量。

我该如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T21:23:23.767

你可以这样做：

```
public class foo {    
  IEnumerable<string> AllThreads;    

  private void getThread() {
     AllThreads = (from sc in db.ScreenCycles
                      join s in db.Screens on sc.ScreenID equals s.ScreenID
                      select s.Screen1 + " " + sc.Thread);
  }
} 
```

根据 Joel 的建议进行了更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T21:24:59.737

var 只能用作本地声明。如果要使用从 LINQ 表达式返回的类型，则必须构建一个对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T21:25:55.477

要保留您的原始代码，请尝试此操作

```
public class foo

    IEnumerable<ScreenCycles> AllThreads;
    private void getThread()
    {
       AllThreads = from sc in db.ScreenCycles
                          join s in db.Screens on sc.ScreenID equals s.ScreenID
                          select s;
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T21:24:17.913

初始 var 定义了一个匿名类。为了做你必须定义的类。

但是......你可能只是这样做：

```
List<string> AllThreads; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T21:26:44.383

您不能`var`在班级级别使用。如果不立即初始化，则需要提供显式类型。

假设“s”的类型名称为“Screen”：

```
public class foo
{
    IEnumerable<Screen> AllThreads;
    private void getThread()
    {
       AllThreads = from sc in db.ScreenCycles
                          join s in db.Screens on sc.ScreenID equals s.ScreenID
                          select s;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T21:33:50.043

正如许多人所说，你不能使用 var。重构您的代码以使用 Linq 类型。

```
public class foo 
{
    ScreenCycle[] allThreads;
    private void getThread() 
    { 
        allThreads = (from sc in db.ScreenCycles join s in db.Screens on sc.ScreenID 
                     equals s.ScreenID select s).ToArray(); 
    } 
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T21:40:08.983

好的，这不是答案，只是 stackoverflow 问题的一个相对新手，这个线程很好地说明了这一点。

这个网站上的代码标记工具是认真的……嗯，独一无二的。在这种特殊情况下，我不明白的是，为什么我们所有的评论代码块都非常长？这是OP做的吗？我厌倦了对前面示例的各种编辑，并且由于某种原因，我的代码所在的文本框比其内容长得多。( 即 8 )

# haskell - 如何组合过滤条件

> ID：841851
> 
> 赞同：26
> 
> 时间：2009-05-08T21:20:39.077
> 
> 标签：haskell, filter

过滤器类函数接受一个条件（a -> Bool）并在过滤时应用它。

当您有多个条件时，使用过滤器的最佳方法是什么？

使用应用函数 liftA2 而不是 liftM2 因为我出于某种原因不明白 liftM2 在纯代码中是如何工作的。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-08T21:38:48.097

liftM2 组合器可以在 Reader monad 中使用，以“更实用”的方式执行此操作：

```
import Control.Monad
import Control.Monad.Reader

-- ....

filter (liftM2 (&&) odd (> 100)) [1..200] 
```

请注意，导入很重要；Control.Monad.Reader 提供了使这一切工作的 Monad (e ->) 实例。

之所以可行，是因为对于某些环境 e，reader monad 只是 (e ->)。因此，布尔谓词是在与其参数相对应的环境中返回布尔值的 0 元一元函数。然后我们可以使用 liftM2 将环境分布在两个这样的谓词上。

或者，更简单地说，当类型成功时，liftM2 的行为会有点像这样：

```
liftM2 f g h a = f (g a) (h a) 
```

如果您希望能够轻松地链接这些组合器，和/或不想弄乱liftM2，您还可以定义一个新的组合器：

```
(.&&.) :: (a -> Bool) -> (a -> Bool) -> (a -> Bool)
(.&&.) f g a = (f a) && (g a)
-- or, in points-free style:
(.&&.) = liftM2 (&&)    

filter (odd .&&. (> 5) .&&. (< 20)) [1..100] 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-08T21:28:02.697

好吧，您可以在 Haskell 中组合您想要的函数（只要类型正确）并使用 lambda，您甚至不必命名您的谓词函数，即

```
filter (\x -> odd x && x > 100) [1..200] 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-08T21:40:14.193

假设您的条件存储在一个名为`conditions`. 此列表的类型为`[a -> Bool]`。

要将所有条件应用于值`x`，您可以使用`map`：

```
map ($ x) conditions 
```

这会将每个条件应用于`x`并返回 Bool 列表。要将此列表简化为单个布尔值，如果所有元素都为 True，则为 True，否则为 False，您可以使用以下`and`函数：

```
and $ map ($ x) conditions 
```

现在你有了一个结合所有条件的函数。让我们给它一个名字：

```
combined_condition x = and $ map ($ x) conditions 
```

这个函数有类型`a -> Bool`，所以我们可以在调用中使用它`filter`：

```
filter combined_condition [1..10] 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-01-31T19:13:03.817

如果你有一个类型的过滤函数列表，`a -> Bool`并且想将它们组合成一个相同类型的简洁过滤函数，我们可以编写函数来做。您使用以下两个功能中的哪一个将取决于您需要的过滤器行为。

```
anyfilt :: [(a -> Bool)] -> (a -> Bool)
anyfilt fns = \el -> any (\fn -> fn el) fns

allfilt :: [(a -> Bool)] -> (a -> Bool)
allfilt fns = \el -> all (\fn -> fn el) fns 
```

`anyfilt`**如果任何过滤器函数返回 true** ，则返回true ；如果所有过滤器函数返回 false，则返回 false。 `allfilt`如果所有过滤器函数都返回 true ，则返回 true ；**如果任何过滤器函数返回 false ，则返回 false**。请注意，您不能对任何一个函数进行 η-reduce，因为`fns`RHS 上的引用位于匿名函数中。

像这样使用它：

```
filterLines :: [String] -> [String]
filterLines = let
  isComment = isPrefixOf "# "
  isBlank = (==) ""
  badLine = anyfilt([isComment, isBlank])
  in filter (not . badLine)

main = mapM_ putStrLn $ filterLines ["# comment", "", "true line"]
--> "true line" 
```

# .net - .Net 3.5 - 与另一个 .Net 进程通信的最佳方式？

> ID：841864
> 
> 赞同：0
> 
> 时间：2009-05-08T21:23:31.223
> 
> 标签：.net, vb.net

我有一个与我们的电话系统交互的库，即嘿电话，为我拨打这个号码。该库用于我们的内部产品之一。我想把它放在服务中，这样我们的任何内部产品都可以向服务发送消息以拨打电话。所以基本上我想从.Net 3.5中内置的程序与在同一台机器上运行的服务进行通信，该机器也内置在3.5框架中。我已经使用 WCF 完成了一些工作，并且正在考虑使用它，但我想我会问其他人已经做了什么或将要做什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T21:25:27.583

有很多方法。WCF 是一个很好的选择。根据具体情况，您可能需要考虑命名管道、[IpcChannel](http://msdn.microsoft.com/en-us/library/system.runtime.remoting.channels.ipc.ipcchannel.aspx)、套接字和其他方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T21:27:09.810

我认为 WCF 非常适合这一点。它允许您将管道与应用程序代码分开，并且配置允许您轻松更改传输（http、tcp、命名管道）、添加安全性、节流等，而无需编写更多代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T21:38:05.650

Doh，不知道为什么我以前没有找到这个链接，或多或少是我想做的。我之前的工作是使用 TCP 连接，这个使用命名管道： [通过命名管道绑定公开 WCF 服务](https://stackoverflow.com/questions/184878/expose-a-wcf-service-through-a-named-pipes-binding)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T22:04:29.877

我发现 WCF 过于复杂。我会直接或通过[Spring.Framework Messaging使用 MSMQ](http://www.springframework.net/doc-latest/reference/html/msmq.html)

# c# - 使用 SlimDX 绘制 2D

> ID：841873
> 
> 赞同：3
> 
> 时间：2009-05-08T21:24:53.233
> 
> 标签：c#, 2d, direct3d, slimdx

您好，我无法使用 SlimDX 正确渲染精灵。它像 .NET 绘图 DrawImageUnscaled 一样绘制了一些缩放。我没有使用任何转换。

在里面：

```
Vector2 position;
Sprite sprite;
Size size;
Texture texture;
sprite = new Sprite(Device);
string filename = /*some bitmap*/;
using (Image b = Bitmap.FromFile(filename))
  size = b.Size;

position = new Vector2(550, 230);
texture = Texture.FromFile(Device, filename); 
```

渲染：

```
Device.Clear(ClearFlags.Target, Color.Black, 1.0f, 0);
Device.BeginScene();
sprite.Begin(SpriteFlags.None);
sprite.Draw(texture, new Vector3(size.Width / 2, size.Height / 2, 0), new Vector3(position, 0), Color.White);
sprite.End();
Device.EndScene(); 
```

编辑：如果您不知道如何想象错误的渲染，这里是我渲染和参考的内容（忽略那个白色，它只是透明的 PNG）。注意第一张图像是如何 [缩放](http://i40.tinypic.com/29pbyu0.png) [的](http://i41.tinypic.com/2dbnd6b.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T10:08:12.260

您的显卡是否有可能在绘制 NPOT 纹理（非二的幂）时出现问题。如果是这样，将纹理大小增加到下一个 POT。这为我解决了许多绘图问题（也使用 SlimDX）。

顺便说一句...我也使用 SlimDX 进行 2D 渲染，但没有使用精灵，而是将所有东西绘制为“基元”并使用顶点缓冲区。也许这也可能是一种选择

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T20:52:47.953

初始化精灵时添加 alpha 混合。

# .net - webform还是winform，如何选择？

> ID：841882
> 
> 赞同：0
> 
> 时间：2009-05-08T21:26:23.197
> 
> 标签：.net, winforms, webforms

决定走哪条路的正常方式是什么？

就我而言，如果

*   用户群少于 10 人
*   您无法控制 CAS，但可以安装框架
*   需要导入/导出比如说excel文件/pdf
*   将是内联网
*   安全真的很重要
*   业务逻辑有点复杂

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T22:07:21.493

这似乎是一个线程的黑羊，但不管怎样，让我们​​去吧。

几乎在小型发行版中，胖客户端（ winForms ）更容易开发。最大的缺陷之一是部署困难。CAS 将更多地成为胖客户端应用程序的一个因素（因为它基本上不是 webform 应用程序的一个因素），但最后，根据您所描述的基础知识，它不应该真正成为一个因素。再说一次，这可能是没有足够信息的产物。

WebForms 蓬勃发展的地方在于易于维护和缺乏部署。此外，如果优先考虑在 Internet 上部署 WebForm 应用程序，它会容易得多。

您所描述的实际任务，可以通过任何一种技术轻松完成，这一切都归结为具体细节。需要高度或易于分发的应用程序？使用 WebForms。需要提供简单的升级？再次，WebForms。需要提供丰富的客户端体验，然后使用 WinForms。

这实际上都归结为您提供的许多细节和您的特定技能，这些也没有提到。您所要求的（据我们所知），可以使用任何一种技术来提供。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T21:33:45.130

Winforms 可能稍微“更丰富”，因为您可以在客户端上做更多事情（因为您正在运行一个完整的应用程序而不是一个浏览器），例如它是一个“富客户端”；另一方面，Webforms 应用程序不需要安装在每台机器上，因为它是“瘦客户端”，所以这是一个好处。

至于业务逻辑，无论如何我都会将其分离到自己的层/层中，可以从 Winforms 或 Webforms 使用 - 我认为这里没有决定因素。

所以真的 - 你觉得更舒服可能没问题。您并没有真正给出很多非常好的理由来选择一个而不是另一个....

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T22:03:40.393

您的“案例”要么不区分 Webforms 和 Winforms，要么太模糊而无法用于做出决定。

典型的 Webforms 应用程序连接到 Internet 上某处的服务器，所有数据和逻辑都远程存储并发送到客户端。典型的 Winforms 应用程序具有在用户机器上执行的所有数据和逻辑。这应该是您使用的基础。

是否会有一群人为您的数据做出贡献，而没有一个用户拥有它？除非所有贡献都可用，否则数据是否无用？这些贡献是不可靠的，还是应该保护个人用户免受可能危险的贡献？网络表单是要走的路。

或者数据是一个人的唯一责任？数据是否需要与该人使用的其他文件、应用程序或硬件进行互操作？每个用户是否会与使用数据的其他所有人分开行动，您是否希望将每个用户的数据与其他用户隔离开来？你应该使用 Winforms。

是的，您可以在一台机器上本地运行 Webforms 应用程序，并且可以创建协作互联网 Winforms 应用程序，但这两种技术是为不同目的而创建的，您最好将每种技术用于其设计目的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-27T20:22:46.780

单击“一旦部署到网站可以处理分发问题”。此外，如果它只是一个 MS 环境，那么在后端使用 Web 服务进行数据库访问的 winForm 运行良好。Web 服务也可以与 webforms 或 asp 一起使用。乔·卡伦

# c# - 正则表达式 C# - 匹配时是否可以提取匹配项？

> ID：841883
> 
> 赞同：27
> 
> 时间：2009-05-08T21:26:24.540
> 
> 标签：c#, regex, extraction

说，我有一个字符串，我需要验证其正确格式；例如`RR1234566-001`（2 个字母，7 个数字，破折号，1 个或多个数字）。我使用类似的东西：

```
 Regex regex = new Regex(patternString);
        if (regex.IsMatch(stringToMatch))
        {
            return true;
        }
        else
        {
            return false;
        } 
```

这可以告诉我是否`stringToMatch`遵循`patternString`. 我需要的是（我稍后会提取这些）是： `123456`和`001`- 即`stringToMatch`.

请注意，这不是关于如何构造正则表达式的问题。我要问的是：“有没有一种方法可以同时匹配和提取值，而不必稍后使用拆分函数？”

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-05-08T21:28:11.417

您可以使用正则表达式组来实现这一点。例如，这个正则表达式：

```
(\d\d\d)-(\d\d\d\d\d\d\d) 
```

让我们用这个正则表达式匹配一个电话号码：

```
var regex = new Regex(@"(\d\d\d)-(\d\d\d\d\d\d\d)");
var match = regex.Match("123-4567890");
if (match.Success)
    .... 
```

如果匹配，您将在以下位置找到前三位数字：

```
match.Groups[1].Value 
```

第二个 7 位数字：

```
match.Groups[2].Value 
```

PS 在 C# 中，您可以使用 @"" 样式字符串来避免转义反斜杠。例如，@"\hi\" 等于 "\\hi\\"。对正则表达式和路径很有用。

PS2。第一个组存储在 Group[1] 中，而不是您期望的 Group[0]。那是因为 Group[0] 包含整个匹配的字符串。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-08T21:37:18.740

改用分组和匹配。

IE：

```
// NOTE: pseudocode.
Regex re = new Regex("(\\d+)-(\\d+)");
Match m = re.Match(stringToMatch))

if (m.Success) {
  String part1 = m.Groups[1].Value;
  String part2 = m.Groups[2].Value;
  return true;
} 
else {
  return false;
} 
```

您还可以命名匹配项，如下所示：

```
Regex re = new Regex("(?<Part1>\\d+)-(?<Part2>\\d+)"); 
```

并像这样访问

```
 String part1 = m.Groups["Part1"].Value;
  String part2 = m.Groups["Part2"].Value; 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-08T21:44:56.197

您可以使用括号来捕获字符组：

```
string test = "RR1234566-001";

// capture 2 letters, then 7 digits, then a hyphen, then 1 or more digits
string rx = @"^([A-Za-z]{2})(\d{7})(\-)(\d+)$";

Match m = Regex.Match(test, rx, RegexOptions.IgnoreCase);

if (m.Success)
{
    Console.WriteLine(m.Groups[1].Value);    // RR
    Console.WriteLine(m.Groups[2].Value);    // 1234566
    Console.WriteLine(m.Groups[3].Value);    // -
    Console.WriteLine(m.Groups[4].Value);    // 001
    return true;
}
else
{
    return false;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-02-27T06:30:40.843

```
string text = "RR1234566-001";
string regex = @"^([A-Z a-z]{2})(\d{7})(\-)(\d+)";
Match mtch = Regex.Matches(text,regex);
if (mtch.Success)
{
    Console.WriteLine(m.Groups[1].Value);    
    Console.WriteLine(m.Groups[2].Value);    
    Console.WriteLine(m.Groups[3].Value);    
    Console.WriteLine(m.Groups[4].Value);    
    return true;
}
else
{
    return false;
} 
```

# javascript - 如何在不更改外部页面的情况下在 iframe 中提交 html 表单？

> ID：841886
> 
> 赞同：17
> 
> 时间：2009-05-08T21:26:41.857
> 
> 标签：javascript, http, iframe

我正在编辑一些现有的 html，其中 javascript 在 iframe 中加载另一个页面。在页面中是一个html表单。当我点击提交时，我希望外部页面保留并且 iframe 更改为结果页面。但是，现在整个页面更改为表单的结果页面。我猜有办法解决这个javascript。有什么建议么？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-08T21:33:10.263

将表单定位到 iframe：

```
<iframe name="foo"></iframe>

<form target="foo"></form> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T21:33:00.670

尝试使用`target`表单标签的属性。您可以指定框架。

# naming-conventions - 选择好的标识符名称

> ID：841888
> 
> 赞同：10
> 
> 时间：2009-05-08T21:27:06.193
> 
> 标签：naming-conventions

好的，所以你可以阅读关于标识符命名的指南，直到你脸色发青......驼峰式，帕斯卡式，让它们具有描述性......但它们不会帮助你为给定的实际选择最佳名称应用领域。

最容易选择（恕我直言）是一两个词名词组：

*   报名表
*   员工
*   小部件集合

但并不是每个类都可以巧妙地融入名词，所以我看到很多人通过在动词末尾添加 -er 来将动词变成名词：

*   客户经理
*   记录计数器
*   ProcessRunner

我看到的最大问题是，很多时候它们是模棱两可的……尤其是经理。它到底在管理什么？

**所以我的问题是你如何为一个班级取一个好名字？**我所说的“好”是指信息丰富且明确无误。

我知道我知道。几乎每个现代 IDE 都内置了重构支持，您可以毫不费力地更改名称，那有什么意义呢？好吧，一个选择不当的名字会混淆和误导任何偶然发现它的人，直到它被重命名，所以它仍然是一个有效的问题。

### 有关的

> [**命名类的最佳方法是什么？**](https://stackoverflow.com/questions/38019/whats-the-best-approach-to-naming-classes)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-12T14:51:30.563

我一直在阅读Robert C. Martin 的*Clean Code*并没有从第 17 章进入本节，但我认为它最接近于回答这个问题。

> **N1：选择描述性名称**
> 
> 不要太快选择一个名字。确保名称具有描述性。请记住，随着软件的发展，含义往往会发生变化，因此经常重新评估您选择的名称的适当性。这不仅仅是一个“感觉良好”的建议。软件中的名称占软件可读性的 90%。您需要花时间明智地选择它们并保持它们的相关性。名字太重要了，不能随便对待。考虑下面的代码。它有什么作用？如果我向您展示具有精心挑选的名称的代码，您会觉得它非常有意义，但就像这样，它只是符号和幻数的大杂烩。
> 
> ```
> public int x() {
>     int q = 0;
>     int z = 0;
>     for (int kk = 0; kk < 10; kk++) {
>         if (l[z] == 10)
>         {
>             q += 10 + (l[z + 1] + l[z + 2]);
>             z += 1;
>         }
>         else if (l[z] + l[z + 1] == 10)
>         {
>             q += 10 + l[z + 2];
>             z += 2;
>         } else {
>             q += l[z] + l[z + 1];
>             z += 2;
>         }
>     }
>     return q;
> } 
> ```
> 
> 这是应该编写的代码。这个片段实际上不如上面的片段完整。然而，您可以立即推断出它正在尝试做什么，并且您很可能会根据推断的含义编写缺失的函数。魔术数字不再是魔术，算法的结构具有令人信服的描述性。
> 
> ```
> public int score() {
>     int score = 0;
>     int frame = 0;
>     for (int frameNumber = 0; frameNumber < 10; frameNumber++) {
>         if (isStrike(frame)) {
>             score += 10 + nextTwoBallsForStrike(frame);
>             frame += 1;
>         } else if (isSpare(frame)) {
>             score += 10 + nextBallForSpare(frame);
>             frame += 2;
>         } else {
>             score += twoBallsInFrame(frame);
>             frame += 2;
>         }
>     }
>     return score;
> } 
> ```
> 
> 精心选择的名称的威力在于它们使代码结构与描述重载。这种重载设置了读者对模块中其他功能的期望。您可以 通过查看上面的代码来推断**isStrike()的实现。**当您阅读**isStrike** 方法时，它会“与您预期的差不多”。</p>
> 
> ```
> private boolean isStrike(int frame) {
>     return rolls[frame] == 10;
> } 
> ```
> 
> **N2：在适当的抽象级别选择名称**
> 
> 不要选择传达实施的名称；选择名称以反映您正在使用的类或函数的抽象级别。这很难做到。同样，人们太擅长混合抽象级别。每次通过代码时，您可能会发现某些变量的命名级别太低。当您找到这些名称时，您应该借此机会更改这些名称。使代码可读需要致力于持续改进。考虑下面的**调制解调器** 接口：
> 
> ```
> public interface Modem {
>     boolean dial(String phoneNumber);
>     boolean disconnect();
>     boolean send(char c);
>     char recv();
>     String getConnectedPhoneNumber();
> } 
> ```
> 
> 起初这看起来不错。这些功能似乎都很合适。事实上，对于许多应用程序来说，它们确实如此。但是现在考虑一个应用程序，其中某些调制解调器没有通过拨号连接。而是通过硬接线将它们永久连接在一起（想想现在为大多数家庭提供互联网访问的电缆调制解调器）。也许有些是通过通过 USB 连接向交换机发送端口号来连接的。显然，电话号码的概念处于错误的抽象级别。这种情况下更好的命名策略可能是：
> 
> ```
> public interface Modem {
>     boolean connect(String connectionLocator);
>     boolean disconnect();
>     boolean send(char c);
>     char recv();
>     String getConnectedLocator();
> } 
> ```
> 
> 现在这些名字对电话号码没有任何承诺。它们仍然可以用于电话号码，或者它们可以用于任何其他类型的连接策略。
> 
> **N3：尽可能使用标准命名法**
> 
> 如果名称基于现有约定或用法，则更易于理解。例如，如果你使用 DECORATOR 模式，你应该在装饰类的名字中使用**Decorator这个词。**例如， **AutoHangupModemDecorator**可能是装饰**调制解调器**的类的名称，该调制解调器 能够在会话结束时自动挂断。模式只是一种标准。例如，在 Java 中，将对象转换为字符串表示的函数通常被命名为 **toString**。遵循这样的约定比自己发明要好。团队通常会为特定项目发明自己的标准名称系统。埃里克埃文斯将此称为*项目的通用语言*。您的代码应广泛使用该语言中的术语。简而言之，您可以使用与您的项目相关的特殊含义重载的名称越多，读者就越容易知道您的代码在说什么。
> 
> **N4：明确的名称**
> 
> 选择使函数或变量的工作方式明确的名称。考虑来自 FitNesse 的这个例子：
> 
> ```
> private String doRename() throws Exception
> {
>     if(refactorReferences)
>         renameReferences();
>     renamePage();
>     pathToRename.removeNameFromEnd();
>     pathToRename.addNameToEnd(newName);
>     return PathParser.render(pathToRename);
> } 
> ```
> 
> 这个函数的名称并没有说明这个函数的作用，除非用广义和模糊的术语。这是因为在名为**doRename**的函数内部有一个名为**renamePage**的函数！这些名称告诉您这两个功能之间的区别是什么？没有。该函数的更好名称是 **renamePageAndOptionallyAllReferences**。这可能看起来很长，但它只是从模块中的一个地方调用的，所以它的解释价值超过了长度。
> 
>  ******N5：为长范围使用长名称**
> 
> 名称的长度应该与作用域的长度相关。对于小范围，您可以使用非常短的变量名，但对于大范围，您应该使用较长的名称。**如果i**和**j**这样的变量名 的作用域是五行长，那么它们就可以了。考虑一下旧标准“保龄球游戏”中的这段代码：
> 
> ```
> private void rollMany(int n, int pins)
> {
>     for (int i=0; i<n; i++)
>         g.roll(pins);
> } 
> ```
> 
> 这是非常清楚的，如果变量**i**被替换为诸如 **rollCount 之**类的烦人的东西，则会被混淆。另一方面，具有短名称的变量和函数在长距离上失去了意义。所以名称的范围越长，名称就应该越长越精确。
> 
> **N6：避免编码**
> 
> 名称不应使用类型或范围信息进行编码。在当今的环境中，诸如**m_**或**f之类的前缀是无用的。**此外，项目和/或子系统编码，如 **vis_**（用于视觉成像系统）是分散注意力和冗余的。同样，今天的环境无需破坏名称即可提供所有这些信息。让您的名字免受匈牙利污染。
> 
> **N7：名称应该描述副作用**
> 
> 名称应该描述函数、变量或类是或所做的一切。不要用名字隐藏副作用。不要使用一个简单的动词来描述一个功能不仅仅是那个简单的动作。例如，考虑来自 TestNG 的这段代码：
> 
> ```
> public ObjectOutputStream getOos() throws IOException {
>     if (m_oos == null) {
>         m_oos = new ObjectOutputStream(m_socket.getOutputStream());
>     }
>     return m_oos;
> } 
> ```
> 
> 这个函数不仅仅是得到一个“oos”；如果尚未创建它，它会创建“oos”。因此，更好的名称可能是 **createOrReturnOos**。****

 ***** * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-08T21:49:26.187

1）不要缩写。仅当它们是行业标准的缩写词（如 HTML）时才使用缩写词。

2）在你的名字上自洽。

3) 使用您的应用程序所在域中的术语。在提出名称时，假装在添加人们不熟悉的新名称时可以使用有限数量的项目符号。

你可能会觉得你的类中有一些微妙的特征将它与“Foo”区分开来，并且因为这种微妙的区别而倾向于为它创造一些新的概念。如果使用它的 80% 的人不会关心这种细微的差异，请坚持使用已知术语。

4) 在大多数 OO 语言中，自动完成很重要。如果可能，第一个词应该是人们在探索命名空间时最有可能输入的词。其他人觉得用英文读得好更重要，所以这是有争议的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T21:46:16.520

为事物选择**简洁**、信息丰富、适当的名称是编程中最困难的部分之一。

它没有公式。这是您通过经验掌握的技能。

注意对**简洁**的强调。Java 中的长名称是该语言的主要障碍之一。它基本上已经到了没有带有自动完成功能的 IDE 就不可能用 Java 编程的地步。

命名时，缩写可以成为您的朋友。例如，“经理”而不是“经理”。当“经理”明白这一点时，我真的需要每天输入“经理”一千次吗？只要确保人们始终如一且明智地使用它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T21:51:18.740

我厌倦了看到如下命名的类：

XxxHandler XxxManager XxxController

Handler 和 Manager 很难描述类是什么。如果我们不能为一个类找到一个好名字，我们可能应该确保我们的类所做的事情是明确的，而不是试图做太多的事情。较小的类通常更容易命名类，因为它们的作用范围通常很窄。

不过，有时我们会用尽有创意的东西来称呼事物，而只是恢复到同样的旧事物。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T22:31:17.177

像[kekoav](https://stackoverflow.com/questions/841888/picking-good-identifier-names/841988#841988)一样，我对命名 FooManager 或 FooController 持谨慎态度。它不仅表明了一个遭受身份危机的对象，而且还引入了歧义。我从事过一个项目，其中有一个“AccountManager”，它是一个域对象，代表管理帐户的人（员工的子类型）。当然，有人做了一个“AccountManagerManager”，其他人搞糊涂了，创建了一个 Account 域对象（这不是我们的应用程序处理的东西），然后将一些东西混合到 AccountManager 中来管理 Account。这有点乱。

Quis custodiet ipsos custodes？**Quoque quis administro ipsos 管理员？**

是的，我的拉丁文生锈了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-29T06:03:33.767

当我发现很难选择一个有意义的名字时，它会提醒我这个类太大或者我并不真正理解我正在编码的任何领域。

当你最终提出一个好的设计来解决*Bob 叔叔*在**Clean Code中提出的关于***适当抽象*、*单一职责原则*等概念的问题时，那么名称就变得更容易选择了。

难以选择名称几乎总是表明逻辑组织仍然需要工作。毕竟，编译器并不关心你的逻辑组织得好坏。组织的存在只是为了帮助管理复杂性和你的开发人员的理智。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T21:34:14.507

如果您处于 .NET 环境中，则可以使用 FxCop 作为指南。至于命名一个类，我通常会用名词/目的。你说得对，Manager 类是做什么的？如果它是一个控制器类，则称它为 ManagerController。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-08T21:36:08.650

有一个你坚持的标准，那么就不会有任何混乱。如果您的页面名为 AccountManager，那么按照我的标准，这将意味着“您管理帐户的页面”。

对类名、事件等执行类似操作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-08T21:47:01.993

一个好点是使用设计模式，你会做的一切:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-10-25T04:55:13.657

Clean Code 是一本好书，但不要遵循关于标识符名称和注释的建议。（见[自我描述代码](http://devmethodologies.blogspot.com.au/2012/06/self-describing-code.html "自描述代码")和[长标识符使代码不可读](http://devmethodologies.blogspot.com.au/2012/04/long-identifiers-make-code-unreadable.html)）

例如，这里是鲍勃叔叔的保龄球示例（请参阅鲍勃叔叔的代码的其他回复）正确完成：

```
// Returns total score for a game of ten-pin bowling. On entry the number of fallen pins
// for each ball is provided in fallen[] and the number of balls bowled is in balls_bowled.
public int score()
{
  int points = 0;                                            // Cumulative count of points for the game
  int ball = 0;                                               // Current shot or "ball" (1 or 2 per frame)
  int frame;                                                  // Current frame of the game

  for (frame = 0; frame < max_frames; ++frame)
  {
    if (fallen[ball] == 10)
    {
        // Strike (all pins knocked over from 1 ball) gives bonus of next two balls
        points += 10 + fallen[ball + 1] + fallen[ball + 2];
        ++ball;                                                 // Move to next frame (no 2nd ball)
    }
    else if (fallen[ball] + fallen[ball + 1] == 10)
    {
        // Spare (all pins knocked over in 2 balls) gives bonus of following ball
        assert(fallen[ball + 1] > 0);
        points += 10 + fallen[ball + 2];
        ball += 2;                                             // Move to first ball of next frame
    }
    else
    {
        // Open frame just gives score of all fallen pins of both frame's balls
        assert(fallen[ball] + fallen[ball + 1] < 10);
        points += fallen[ball] + fallen[ball + 1];
        ball += 2;                                             // Move to first shot of next frame
    }
  }
  assert(frame == max_frames && ball == balls_bowled);
  assert(points <= max_frames*30);                // Maximum possible score
  return points;
} 
```

# syntax - 语法术语

> ID：841898
> 
> 赞同：0
> 
> 时间：2009-05-08T21:30:34.000
> 
> 标签：syntax, terminology

有谁知道这种形式的命令行语法符号的术语？例如，在指定命令行参数时：

```
key[,alignment][:format] 
```

所以那个key是一个必填参数，后面可以跟一个空格和一个对齐参数，后面也可以跟一个冒号和一个格式。

这不是 BNF。有这个名字吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T21:57:19.223

[来自 Wikipedia 的命令行参数](http://en.wikipedia.org/wiki/Command_line_argument)列出了开关、选项或标志语法的几个术语，具体取决于您使用的操作系统和程序。

# objective-c - 将对象添加到 NSArrayController 时与内存相关的崩溃

> ID：841901
> 
> 赞同：0
> 
> 时间：2009-05-08T21:31:33.420
> 
> 标签：objective-c, cocoa, memory-management

我正在编写一个简单的 ObjC2.0/Cocoa 应用程序，但我遇到了崩溃.. 不熟悉 Cocoa 或 ObjC，我不知道为什么..

导致问题的代码是[TableListCon.m](http://github.com/dbr/tvnamergui_osx/blob/1ce3ea175add438a199633e1046bb6006176cfbb/TableListCon.m#L78)

当我将一个文件夹拖到 NSTableView 上时，它会调用`addDirectoryToList`- 它会递归地遍历此目录中包含的所有文件，并调用`addFileToList`每个文件。

当我将单个文件拖到 tableview 上时，它会`addFileToList`直接调用。这可以正常工作，但在调试器控制台中显示以下消息：

```
tvnamergui(2612) malloc: *** error for object 0x144ab0: double free
*** set a breakpoint in malloc_error_break to debug 
```

或者，如果我拖放一个文件夹，则没有此类消息，它会直接拖放到 GDB，并带有以下回溯：

```
(gdb) bt
#0  0x95cee688 in objc_msgSend ()
#1  0x921e2e4f in NSPopAutoreleasePool ()
#2  0x917b4b10 in NSCoreDragReceiveProc ()
#3  0x95f9e1b0 in DoDropMessage ()
#4  0x95f9dc11 in CoreDragMessageHandler ()
#5  0x960f0d21 in __CFMessagePortPerform ()
#6  0x961128e8 in CFRunLoopRunSpecific ()
#7  0x96112cd8 in CFRunLoopRunInMode ()
#8  0x924892c0 in RunCurrentEventLoopInMode ()
#9  0x92489012 in ReceiveNextEventCommon ()
#10 0x92488f4d in BlockUntilNextEventMatchingListInMode ()
#11 0x914e0d7d in _DPSNextEvent ()
#12 0x914e0630 in -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] ()
#13 0x914d966b in -[NSApplication run] ()
#14 0x914a68a4 in NSApplicationMain ()
#15 0x000022a0 in main (argc=1, argv=0xbffff74c) at /Users/dbr/Desktop/tvnamergui/main.m:13 
```

更奇怪的是，如果我先拖动一个文件，我会收到`double free`错误消息，但随后我可以放下文件夹而不会崩溃（并且一切正常）

它在运行时总是死掉`[ArrayCon addObject:cfile];`（评论这一行会停止崩溃，但显然会破坏功能！）

**编辑**：感谢[smorgan 的回答](https://stackoverflow.com/questions/841901/memory-related-crash-with-adding-objects-to-nsarraycontroller/842000#842000)（使用`NSZombieEnabled`），我有一个更有用的错误信息：

```
*** -[CFArray release]: message sent to deallocated instance 0x155a70 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T21:57:09.053

虽然我无法针对您的情况给出具体答案，但调试此类过度释放崩溃的最佳方法是[打开 NSZombieEnabled](http://www.cocoadev.com/index.pl?NSZombieEnabled)，以便您可以轻松查看过度释放的对象。

编辑：环顾您的项目后，我相信您的问题实际上出在 AppCon 初始化程序中。您正在将您的成员变量“theFiles”设置为一个自动释放的数组，并且当您使用保留（嗯，复制）属性时，您没有使用属性语法（self.theFiles = ...）设置它，所以您是绕过可以正确处理内存管理的自动生成的设置器。当稍后尝试更新该属性时，它将尝试释放错误地未保留的旧值。这很可能是您在僵尸日志中看到的数组。

简而言之，改变

```
theFiles = [NSMutableArray arrayWithObjects:...]; 
```

到

```
self.theFiles = [NSMutableArray arrayWithObjects:...]; 
```

并确保在分配给您的属性时始终使用 self.foo （或显式 [self setFoo:] 形式）。

# sql - 使用 LINQ 为每 5 条记录选择 1 条记录

> ID：841907
> 
> 赞同：1
> 
> 时间：2009-05-08T21:33:30.950
> 
> 标签：sql, linq

有没有办法在使用 LINQ 的 SQL Server 中每 5 条记录中选择一条记录？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T21:40:55.487

我认为不可能直接使用 LINQ to SQL 进行服务器端。但是，有一个客户端解决方案：

```
 var result = new DataContext().Table.AsEnumerable()
                     .Select((x, i) => new { Index = i, Item = x })
                     .Where(t => t.Index % 5 == 0).Select(t => t.Item); 
```

# sql-server - 数据库生成的人性化代码

> ID：841908
> 
> 赞同：0
> 
> 时间：2009-05-08T21:33:35.990
> 
> 标签：sql-server, random

我想创建一些人性化的代码来识别我的对象。

我正在考虑使用以下规则：

*   6位随机数
*   第一个字符不为零
*   每个代码与其他每个此类代码的[编辑距离](http://en.wikipedia.org/wiki/Edit_distance)值都为 2 或更大*
*   也可能是校验和

我希望我的 MS SQL 数据库强制我使用的代码不仅每个都是唯一的，而且也符合上述标准。

我将如何编写数据库检查约束来强制执行诸如此类的规则？

如何让数据库使用这些数字作为插入行的默认值？

**因此单个按键输入错误不会检索到与预期不同的记录*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T21:38:10.563

使用存储过程来检查您希望插入数据的任何约束。

如果需要，也可以使用存储过程来生成这些内容。

尽管让数据库为您完成这一切似乎是一件好事，但从长远来看，用代码完成这一切可能更容易维护（除非您有专门的 DBA，他们喜欢维护这种东西）。

我认为你的想法和算法很聪明。如果您要满足要求，我会说校验和是一件很棒的事情。无论编辑距离如何，仅校验和就可以捕获拼写错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T21:49:01.677

创建一个存储过程来计算您的数值；使用该存储过程作为`DEFAULT()`表定义中列定义的值。注意：我还没有尝试过，所以我不知道这是否完全可能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T21:57:16.197

需要多少身份证？

您可以将该列声明为一个标识，并将起始值设置为 100000，并将增量设置为 12。这将产生一个六位数字，编辑距离为 2。

此外，作为奖励，这非常快。但是您可能会用完数字，因为这并不是那么密集。

```
CREATE TABLE [Items]
(
    [id] int IDENTITY(100000,12) NOT NULL primary key,
    [Data] varchar(50) NULL
) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T22:51:54.283

就 UI 而言，您的敌人是代码长度。我建议您添加字母字符（省略零、哦、一和眼睛）。它将大大缩短长度，并减少碰撞的可能性，尤其是对于换位。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T22:06:53.430

编写一个一次性程序，使用整数主键以加扰顺序填充所有（或许多）可能的有效代码的表。

代码表：

```
Id   HumanFriendlyCode

1    100124
2    991302
3    201463
4    157104
...  ... 
```

然后只需将对象表与该代码表中的行相关联，并使用自动递增整数外键和唯一约束。

东西表：

```
Id                                    CodeId  ...

e9d29b14-0ea6-4cfd-a49f-44bcaa7212eb  1       ...
91906bb7-14ed-4acc-bf23-c4bd1631797f  2       ...
41ace075-f9f8-46b7-b114-cb17765c4e76  3       ...
2fba1a58-7a91-4da6-a4a2-7cacef8603db  4       ... 
```

有人做过这样的事情吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T22:47:30.593

此检查约束将在数据库列中强制执行校验和：

```
ALTER TABLE tblCode
ADD CHECK (
    CAST(SUBSTRING(CAST(Code AS VARCHAR), 6, 1) AS INTEGER) =
    (
        CAST(SUBSTRING(CAST(Code AS VARCHAR), 1, 1) AS INTEGER) +
        CAST(SUBSTRING(CAST(Code AS VARCHAR), 2, 1) AS INTEGER) +
        CAST(SUBSTRING(CAST(Code AS VARCHAR), 3, 1) AS INTEGER) +
        CAST(SUBSTRING(CAST(Code AS VARCHAR), 4, 1) AS INTEGER) +
        CAST(SUBSTRING(CAST(Code AS VARCHAR), 5, 1) AS INTEGER)
    ) % 10
) 
```

第六位数字必须是前五位数字之和的模 10。

# msbuild - 修改 MSBuild ItemGroup 元数据

> ID：841913
> 
> 赞同：25
> 
> 时间：2009-05-08T21:34:34.723
> 
> 标签：msbuild

声明后是否可以修改 ItemGroup 的元数据。

例如：

```
 <ItemGroup>
    <SolutionToBuild Include="$(BuildProjectFolderPath)\MySolution.sln">
      <Targets></Targets>
      <Properties></Properties>
    </SolutionToBuild>

  </ItemGroup>

  <Target Name="BuildNumberOverrideTarget">
     <!--Code to get the version number from a file (removed)-->

     <!--Begin Pseudo Code-->
     <CodeToChangeItemGroupMetaData 
           ItemToChange="%(SolutionToBuild.Properties)" 
           Condition ="'%(SolutionToBuild.Identity)' ==
                       '$(BuildProjectFolderPath)\MySolution.sln'"
           NewValue="Version=$(Version)" />
     <!--End Pseudo Code-->         

  </Target> 
```

我希望有一种方法不需要我删除该项目然后重新声明它。

感谢您的任何回答。瓦卡诺

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-05-13T10:28:16.080

是的，您**可以**在定义后修改或添加到`<ItemGroup>`元数据（MSBuild 3.5）

```
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <!-- Define ItemGroup -->
  <ItemGroup>
    <TestItemGroup Include="filename.txt">
      <MyMetaData>Test meta data</MyMetaData>
    </TestItemGroup>
    <TestItemGroup Include="filename2.txt">
      <MyMetaData>Untouched</MyMetaData>
    </TestItemGroup>
  </ItemGroup>

  <Target Name="ModifyTestItemGroup" BeforeTargets="Build">
    <!-- Show me-->
    <Message Text="PRE:  %(TestItemGroup.Identity)  MyMetaData:%(TestItemGroup.MyMetaData)  OtherMetaData:%(TestItemGroup.OtherMetaData)" Importance="high" />

    <!-- Now change it - can only do it inside a target -->
    <ItemGroup>
      <TestItemGroup Condition="'%(TestItemGroup.MyMetaData)'=='Test meta data' AND 'AnotherCondition'=='AnotherCondition'">
        <MyMetaData>Well adjusted</MyMetaData>
        <OtherMetaData>New meta data</OtherMetaData>
      </TestItemGroup>
    </ItemGroup>

    <!-- Show me the changes -->
    <Message Text="POST: %(TestItemGroup.Identity)  MyMetaData:%(TestItemGroup.MyMetaData)  OtherMetaData:%(TestItemGroup.OtherMetaData)" Importance="high" />
  </Target>

  <Target Name="Build" />
</Project> 
```

参考：[MSDN 库：操作项和属性的新方法 (MSBuild)](http://msdn.microsoft.com/en-us/library/bb651786.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-01-13T22:24:25.950

有一个新的使用*更新*属性来修改元数据，例如

```
<ItemGroup>
    <Compile Update="somefile.cs">  // or Update="*.designer.cs"
        <MetadataKey>MetadataValue</MetadataKey>
    </Compile>
</ItemGroup> 
```

[MSBuild 文档](https://docs.microsoft.com/en-us/visualstudio/msbuild/item-element-msbuild)中的更多内容

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-11T18:09:14.393

我必须编写一个自定义任务来执行此操作：

下面是它的工作原理

```
<ItemGroup>
  <ItemsToChange Include="@(SolutionToBuild)">
    <Properties>ChangedValue</Properties>
  </ItemsToChange>
  <MetaDataToChange Include="Properties"/>
</ItemGroup>

<UpdateMetadata SourceList="@(SolutionToBuild)" ItemsToModify="@(ItemsToChange)" MetadataToModify="@(MetaDataToChange)">
  <Output TaskParameter="NewList" ItemName="SolutionToBuildTemp" />
</UpdateMetadata>

<ItemGroup>
  <SolutionToBuild Remove="@(SolutionToBuild)"/>
  <SolutionToBuild Include ="@(SolutionToBuildTemp)"/>
</ItemGroup> 
```

它使用更改后的值填充名为 SolutionToBuildTemp 的新项目。然后我删除 SolutionToBuild 项中的所有内容，并用 SolutionToBuildTemp 项填充它。

如果有人感兴趣，这是任务的代码（我也将它提交到 MSBuildExtenstionPack）。

```
// By Stephen Schaff (Vaccano).  
// Free to use for your code. Need my Permission to Sell it.
using System;
using Microsoft.Build.Framework;
using Microsoft.Build.Utilities;

namespace UpdateMetadata
{
    ///<summary>
    /// Used to update the metadata in a ItemGroup (Note: Requires an MSBuild Call After using this task to complete the update.  See Usage.)
    /// Usage:
    /// &lt;?xml version="1.0" encoding="utf-8"?&gt;
    ///&lt;Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003" DefaultTargets="Testing" ToolsVersion="3.5"&gt;
    /// 
    ///  &lt;!-- Do not edit this --&gt;
    ///  &lt;Import Project="$(MSBuildExtensionsPath)\Microsoft\VisualStudio\TeamBuild\Microsoft.TeamFoundation.Build.targets" /&gt;
    ///  &lt;UsingTask AssemblyFile="C:\Base\Junk\UpdateMetadata\UpdateMetadata\bin\Debug\UpdateMetadata.dll" TaskName="UpdateMetadata"/&gt;
    /// 
    /// 
    ///  &lt;!--Re-setup the solutions to build definition--&gt;
    ///  &lt;ItemGroup&gt;
    ///    &lt;SolutionToBuild Include="$(BuildProjectFolderPath)\ChangeThisOne.sln"&gt;
    ///      &lt;Properties&gt;Change&lt;/Properties&gt;
    ///    &lt;/SolutionToBuild&gt;
    ///    &lt;SolutionToBuild Include="$(BuildProjectFolderPath)\ChangeThisToo.sln"&gt;
    ///      &lt;Properties&gt;Change&lt;/Properties&gt;
    ///    &lt;/SolutionToBuild&gt;
    ///    &lt;SolutionToBuild Include="$(BuildProjectFolderPath)\DontChangeThisOne.sln"&gt;
    ///      &lt;Properties&gt;Don'tChange&lt;/Properties&gt;
    ///    &lt;/SolutionToBuild&gt;
    ///  &lt;/ItemGroup&gt;
    /// 
    ///  &lt;Target Name="Testing"&gt;
    ///    &lt;Message Text="Before = %(SolutionToBuild.Identity) %(SolutionToBuild.Properties)" /&gt;
    /// 
    ///    &lt;ItemGroup&gt;
    ///      &lt;ItemsToChange Include="@(SolutionToBuild)"&gt;
    ///        &lt;Properties&gt;ChangedValue&lt;/Properties&gt;
    ///      &lt;/ItemsToChange&gt;
    ///   
    ///      &lt;ItemsToChange Remove="%(ItemsToChange.rootdir)%(ItemsToChange.directory)DontChangeThisOne%(ItemsToChange.extension)"/&gt;      
    ///    &lt;/ItemGroup&gt;
    /// 
    ///    &lt;ItemGroup&gt;
    ///      &lt;MetaDataToChange Include="Properties"/&gt;
    ///    &lt;/ItemGroup&gt;
    /// 
    ///    &lt;UpdateMetadata SourceList="@(SolutionToBuild)" ItemsToModify="@(ItemsToChange)" MetadataToModify="@(MetaDataToChange)"&gt;
    ///      &lt;Output TaskParameter="NewList" ItemName="SolutionToBuildTemp" /&gt;
    ///    &lt;/UpdateMetadata&gt;
    /// 
    ///    &lt;ItemGroup&gt;
    ///      &lt;SolutionToBuild Remove="@(SolutionToBuild)"/&gt;
    ///      &lt;SolutionToBuild Include ="@(SolutionToBuildTemp)"/&gt;
    ///    &lt;/ItemGroup&gt;
    ///         
    ///    &lt;Message Text="After  = %(SolutionToBuild.Identity) %(SolutionToBuild.Properties)"/&gt;
    ///  &lt;/Target&gt;
    ///&lt;/Project&gt;
    ///</summary>
    public class UpdateMetadata : Task
    {
        ///<summary>
        /// The list to modify.
        ///</summary>
        [Required]
        public ITaskItem[] SourceList { get; set; }

        ///<summary>
        /// Items in <see cref="SourceList"/> to change the Metadata for.  
        /// It should have the valid metadata set.
        ///</summary>
        [Required]
        public ITaskItem[] ItemsToModify { get; set; }

        ///<summary>
        /// List of metadata to modify.  This is an item group, but any metadata in it is ignored.
        ///</summary>
        public ITaskItem[] MetadataToModify { get; set; }

        ///<summary>
        /// If true then info about the update is output
        ///</summary>
        public Boolean OutputMessages { get; set; }

        ///<summary>
        /// Changed List.  If you call the following it can replace the <see cref="SourceList"/>:
        ///</summary>
        [Output]
        public ITaskItem[] NewList { get; set; }

        ///<summary>
        /// Runs the task to output the updated version of the property
        ///</summary>
        ///<returns></returns>
        public override bool Execute()
        {
            // If we got empty params then we are done.
            if ((SourceList == null) || (ItemsToModify == null) || (MetadataToModify == null))
            {
                Log.LogMessage("One of the inputs to ModifyMetadata is Null!!!", null);
                return false;
            }
            if (OutputMessages)
                Log.LogMessage(MessageImportance.Low, "Beginning Metadata Changeover", null);
            int sourceIndex = 0;
            foreach (ITaskItem sourceItem in SourceList)
            {
                // Fill the new list with the source one
                NewList = SourceList;
                foreach (ITaskItem itemToModify in ItemsToModify)
                {
                    // See if this is a match.  If it is then change the metadat in the new list
                    if (sourceItem.ToString() == itemToModify.ToString())
                    {
                        foreach (ITaskItem metadataToModify in MetadataToModify)
                        {
                            try
                            {

                                if (OutputMessages)
                                    Log.LogMessage(MessageImportance.Low, "Changing {0}.{1}",
                                        NewList[sourceIndex].ToString(), metadataToModify.ToString());
                                // Try to change the metadata in the new list.
                                NewList[sourceIndex].SetMetadata(metadataToModify.ToString(),
                                                                 itemToModify.GetMetadata(metadataToModify.ToString()));

                            }
                            catch (System.ArgumentException exception)
                            {
                                // We got some bad metadata (like a ":" or something).
                                Log.LogErrorFromException(exception);
                                return false;
                            }
                        }
                    }
                }
                sourceIndex += 1;
            }

            return true;
        }
    }
} 
```

我希望这对某些人有用，但代码显然是“使用风险自负”。

瓦卡诺

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T22:14:44.050

无法修改现有项目，但您可以创建新列表。

```
<CreateItem Include="@(SolutionToBuild)"  
            AdditionalMetadata="Version=$(Version)" >
      <Output ItemName="SolToBuildMods" TaskParameter="Include" />
</CreateItem>
<Message Text="%(SlnToBuildMods.Identity) %(SlnToBuildMods.Version)" /> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-18T09:44:53.310

作为对 Nomad 的响应，目标似乎在​​调用目标时获得了属性和项目的当前值的副本。在您的示例中，您可以通过在 PreProcess 目标完成后调用 DefaultTarget 来解决问题。一种方法是指定 DefaultTarget 取决于 PreProcess 目标：

`<Target Name="DefaultTarget" DependsOnTargets="PreProcess"> ... </Target>`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-11-01T19:32:12.617

我尝试使用 4.0 扩展包中 MSBuildHelper 任务中的 UpdateMetaData TaskAction，但它没有达到我的预期，所以我使用了删除/替换方法。在此示例中，我尝试更新 FilesForPackagingFromProject 项目组中的 DestinationRelativePath 元数据属性。

```
 <Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="4.0">

    <PropertyGroup>
        <CopyAllFilesToSingleFolderForPackageDependsOn>
            $(CopyAllFilesToSingleFolderForPackageDependsOn);
            SetFilePathsToRoot;
        </CopyAllFilesToSingleFolderForPackageDependsOn>
    </PropertyGroup>

    <Target Name="SetFilePathsToRoot">

        <Message Text="Stripping \bin directory from package file paths" />

        <!-- Tweak the package files' DestinationRelativePath property such that binaries don't go into a \bin directory -->
        <ItemGroup>
            <ModifiedFilesForPackagingFromProject Include="@(FilesForPackagingFromProject)">
                <DestinationRelativePath>%(FileName)%(Extension)</DestinationRelativePath>
            </ModifiedFilesForPackagingFromProject>
        </ItemGroup>

        <ItemGroup>
            <FilesForPackagingFromProject Remove="@(FilesForPackagingFromProject)" />
            <FilesForPackagingFromProject Include="@(ModifiedFilesForPackagingFromProject)" />
        </ItemGroup>

    </Target>

</Project> 
```

# jquery - jquery基本滑块不会显示

> ID：841914
> 
> 赞同：1
> 
> 时间：2009-05-08T21:34:51.680
> 
> 标签：jquery, asp.net-mvc

我把头撞在桌子上，试图让一个基本的滑块工作。我认为这一定与风格有关，但我什至无法展示该死的东西。

我有一个非常基本的 ASP.NET MVC 应用程序，在一个视图中，我有：

```
<% using (Html.BeginForm()) { %>
<fieldset>
...
    <div id='mySlider'></div>
...
</fieldset>

<script type="text/javascript">
    $(document).ready(function() {
    $('#mySlider').slider()
    });
</script> 
```

在我的 Site.Master 中：

```
<link href="../../Content/Site.css" rel="stylesheet" type="text/css" />
<link href="../../Content/theme/ui.all.css" rel="stylesheet" type="text/css" />
<script src="../../Scripts/jquery-1.3.2.js" type="text/javascript"></script>
<script src="../../Scripts/ui.slider.js" type="text/javascript"></script>
<script src="../../Scripts/ui.datepicker.js" type="text/javascript"></script>
<script src="../../Scripts/ui.core.js" type="text/javascript"></script> 
```

我有一个完整的工作字段，它从 jquery datepicker 中获取它的值（我可以选择主题确定），所以我必须有一些正确的东西。但无论我做什么，它甚至都不显示滑块。

我需要做什么？任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T17:55:59.213

尝试更换

```
<link href="../../Content/theme/ui.all.css" rel="stylesheet" type="text/css" /> 
```

和

```
<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" type="text/css" /> 
```

这是 Google 的公共 jQueryUI CDN。如果这样可行，您可能会丢失一些 CSS 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T21:43:01.427

尝试移动外部的其他标签，例如字段集和表单，看看您的其他样式是否搞砸了。

您还应该确保 HTML 源代码中的 css 文件指向正确的文件。你可能有路径问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T22:05:11.577

您是否从视图中很好地引用了您的脚本？

如果你有[MvcContrib](http://www.codeplex.com/MVCContrib)你可以这样做：

```
<%= Html.ScriptInclude("~/Scripts/util.js")%>
<%= Html.Stylesheet("~/Content/Site.css")%> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T00:24:46.033

感谢您的建议。我正确地引用了 CSS，但是您必须选择的样式非常具体。我不得不从 jquery 网站上的示例中复制它并从那里开始。

# css - h1 em 和 h1 > em 的区别

> ID：841918
> 
> 赞同：3
> 
> 时间：2009-05-08T21:35:34.317
> 
> 标签：css, css-selectors

这两个 CSS 语句有什么区别：

```
h1 em { color:#ddd; } 
```

和

```
h1 > em { color:#ddd; } 
```

据我所知，他们做的事情完全相同（尽管根据我在 W3C 上读到的内容，在第一种情况下 em 被认为是“后代”，而在第二种情况下，它被认为是“孩子”，尽管我有不知道这实际上有什么不同）。谁能解释这些有何不同以及为什么您会选择使用一种语法而不是另一种语法。我一直只使用第一种方法，但我时不时地在其他人的代码中遇到第二种风格。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-08T21:38:45.867

这个：

```
h1 em { color:#ddd; } 
```

匹配 中`em`的任何内容`h1`，无论是孩子、孙子、曾孙等。例如：

```
<h1><strong><em>This matches</em></strong></h1> 
```

这个：

```
h1 > em { color:#ddd; } 
```

仅匹配 an`em`的孩子`h1`，而不是孙子、曾孙等。所以：

```
<h1><strong><em>This doesn't match</em></strong></h1>
<h1><em>But this does</em></h1> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T21:39:29.297

可能不是你给出的最好的例子，但我会用它来运行：

```
<h1>Stuff here    
  <em>Something
    <p>More stuff</p>
    <p>Something <em>here</em></p>
  </em>
<h1> 
```

在我的示例中，h1 em 将匹配两个 em。

h1>em 将仅匹配作为 h1 的直接后代的 em，而不是第二个内部 em。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T21:41:57.670

```
h1 em { color:#ddd; } 
```

表示：“h1 内的时间”

```
h1 > em { color:#ddd; } 
```

意思是：“em with parent h1”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T21:45:06.757

后代是在 DOM 树中任何点出现在包含元素下方的任何元素（子、孙子类型关系）。子元素是 DOM 中包含元素的正下方的元素。

使用它的实际含义是 IE6 不支持子选择器和兄弟选择器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T21:46:14.257

仅供参考，使用 > 仍然存在很多浏览器兼容性问题，在这种情况下，我会使用 jQuery，或者至少在部署之前在所有目标浏览器中进行测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T21:47:54.847

> 符号中的子选择器允许您仅选择那些是 h1 标记的直接后代的 em 标记。

示例是解释它的最简单方法：

```
<h1>H1 Tag <em id="first">child selector<em id="second">not a direct child descendant</em></em> </h1> 
```

在这种情况下，第一个 em 标签将应用 h1 > em 样式和 h1 em 样式，但是第二个 em 标签或非直接子标签将不会应用 h1 > em 样式，因为它不是h1。

您可以在此处查看文档树规范：http: [//www.w3.org/TR/CSS2/conform.html#doctree](http://www.w3.org/TR/CSS2/conform.html#doctree "W3C 文档树规范")

# c# - 如何使用反射来获取嵌套属性

> ID：841930
> 
> 赞同：0
> 
> 时间：2009-05-08T21:38:46.023
> 
> 标签：c#, asp.net, reflection, binding

我正在为 ASP.NET 编写一个双向绑定控件。我终于把事情搞定了。我正在使用以下代码重新绑定：

```
private void RebindData()
{
    // return if the DataValue wasn't loaded from ViewState
    if (DataValue == null)
        return;
    // extract the values from the two-way binding template
    IOrderedDictionary values = new OrderedDictionary();
    IBindableTemplate itemTemplate = DataTemplate as IBindableTemplate;
    if (itemTemplate != null)
    {
        foreach (DictionaryEntry entry in itemTemplate.ExtractValues(this))
        {
            values[entry.Key] = entry.Value;
        }
    }

    // use reflection to push the bound fields back to the datavalue
    foreach(var key in values.Keys)
    {
        var type = typeof(T);
        var pi = type.GetProperty(key.ToString());
        if (pi != null)
        {
            pi.SetValue(DataValue, values[key], null);
        }
    }
} 
```

这适用于像这样的简单情况：

```
<%# Bind("Name") %> 
```

当我有这样的嵌套绑定语句时，我使用的反射技术不起作用：

```
<%# Bind("Customer.Name") %> 
```

有没有一种简单的方法可以为这样的嵌套属性使用反射？我应该为此使用递归函数，还是只使用一个循环？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T22:26:08.110

为什么不使用已经支持的 ASP.NET DataBinder？

# c# - 套接字仅接收部分消息 C#

> ID：841941
> 
> 赞同：1
> 
> 时间：2009-05-08T21:41:02.400
> 
> 标签：c#, sockets

我有这段代码正在接收一系列消息：

```
byte[] buffer = new byte[10240];
//...
sock.Receive(buffer);
string response = message(buffer);
Console.WriteLine("Message Recieved");
if (!verifyUser(response, sock))
Console.WriteLine("User Invalid");
//...
static private bool verifyUser(string userString, Socket sock)
{
   string[] userData = userString.Split(' ');
   int i = 0;
   while (true)
    {
        if (userData[0].ToUpper() != "USER")
        {
           byte[] buffer = message("WHO");
           sock.Send(buffer);
           userData = userString.Split(' ');
           i++;
           if (i > 4)
           {
                        return false;
                    }
                    continue;
                }
                else
                    break;
            }
Console.WriteLine("Connection recieved from " + userData[1] + " with hash of "/* + userData[2]*/);
} 
```

我遇到的问题是，如果我提交用户名 unkwntech，所有显示的内容都是 unkwnt，而第二个值似乎永远不会到达那里。发送数据的应用程序如下所示：

```
static void Main(string[] args)
        {
            Socket sock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.IP);
            EndPoint remoteEP = new IPEndPoint(IPAddress.Parse("127.0.0.1"), 200);
            sock.Connect(remoteEP);
            byte[] buffer = Encoding.ASCII.GetBytes("USER unkwntech a3f5h4a35sfg");//Made up hash
            sock.Send(buffer);
            sock.Receive(buffer);
            Console.WriteLine(Encoding.ASCII.GetString(buffer));
            Console.ReadLine();
        } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T21:58:40.813

您*假设*当您发送时，所有数据最终都在一个数据包中，并且您将在另一端一次接收所有数据。TCP/IP 不是这样工作的。这是一个流协议——你永远不应该假设你一次会收到多少数据。

基本上，您需要从流中读取，直到您读取所有数据并且套接字已关闭，或者直到您获得“足够”的数据。如果您控制协议并且它是一个会话协议，那么如果您发送的每条消息都以它的长度为前缀，那么它会使生活变得更加轻松 - 这意味着另一端知道需要多少数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T07:39:05.910

检查 Socket.Receive 调用的返回值。它返回接收到的字节数。您可以将此调用置于循环中并读取，直到获得您期望的字节数。您还应该通过设置最大尝试次数来防止无限循环，或者按照 John 的建议，检查套接字的状态。此外，不要假设返回值为零意味着您已经阅读了整条消息。

如果您的协议的每条消息都以其长度为前缀，那么为了真正防弹，您的协议还应该定义一个标记字节来标记前缀长度标头的结尾。一次读取一个字节，直到看到标记字节。然后计算消息的长度并以更大的块读取，直到你读完所有内容。

Socket.Receive 定义了一个重载，允许您指定要接收的字节数。（但是，你不能保证收到那么多，所以你仍然需要检查返回值。）

# mysql - NetBeans 6.7 Beta - 为什么它认为某些表没有主键？

> ID：841942
> 
> 赞同：1
> 
> 时间：2009-05-08T21:41:07.703
> 
> 标签：mysql, netbeans, jpa, primary-key, entity

我正在使用 NetBeans 6.7 Beta 从 MySQL（版本 '5.0.45-log'）数据库创建实体类。NetBeans 接受大多数表，但始终拒绝某些表（我看不到模式），说它们“没有主键”。所有表都使用 InnoDB 引擎。所有表都有一个或多个列的主键。MySQL 查询浏览器和 NetBeans 的内部数据库导航器都同意所有表实际上都有一个主键。这是怎么回事？

这是生成坏表的脚本片段：

```
-- -----------------------------------------------------
-- Table `beamline`.`rq_requests`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `beamline`.`rq_requests` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `facility_id` INT NOT NULL ,
  `schedule_id` INT NOT NULL ,
  `experiment_id` INT NOT NULL ,
  `person_id` INT NOT NULL ,
  `shift_per_block` INT NOT NULL ,
  `block_count` INT NOT NULL ,
  `other_requirment` VARCHAR(1023) NULL ,
  `submitted` BOOLEAN NOT NULL ,
  `date_modified` DATETIME NOT NULL ,
  `date_created` DATETIME NOT NULL ,
  PRIMARY KEY (`id`) ,
  INDEX `fk_rq_requests_xa_facilities` (`facility_id` ASC) ,
  INDEX `fk_rq_requests_xa_schedules` (`schedule_id` ASC) ,
  INDEX `fk_rq_requests_eec_exp_toc` (`experiment_id` ASC)
# ,INDEX `fk_rq_requests_eec_members` (`person_id` ASC)
 ,CONSTRAINT `fk_rq_requests_xa_facilities`
    FOREIGN KEY (`facility_id` )
    REFERENCES `beamline`.`xa_facilities` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
 ,CONSTRAINT `fk_rq_requests_xa_schedules`
    FOREIGN KEY (`schedule_id` )
    REFERENCES `beamline`.`xa_schedules` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
 ,CONSTRAINT `fk_rq_requests_eec_exp_toc`
    FOREIGN KEY (`experiment_id` )
    REFERENCES `beamline`.`eec_exp_toc` (`exp_id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
# ,CONSTRAINT `fk_rq_requests_eec_members`
#    FOREIGN KEY (`person_id` )
#    REFERENCES `beamline`.`rq_questions` (`admin_uid` )
#    ON DELETE NO ACTION
#   ON UPDATE NO ACTION
)
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `beamline`.`rq_questions_facilities`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `beamline`.`rq_questions_facilities` (
  `facility_id` INT NOT NULL ,
  `question_id` INT NOT NULL ,
  PRIMARY KEY (`facility_id`, `question_id`) ,
  INDEX `fk_req_faciliy_current_question_req_question` (`question_id` ASC) ,
  INDEX `fk_rq_questions_facilities_xa_facilities` (`facility_id` ASC),
  CONSTRAINT `fk_req_faciliy_current_question_req_question`
    FOREIGN KEY (`question_id` )
    REFERENCES `beamline`.`rq_questions` (`id` )
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_rq_questions_facilities_xa_facilities`
    FOREIGN KEY (`facility_id` )
    REFERENCES `beamline`.`xa_facilities` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
 )
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `beamline`.`rq_questions_supressed`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `beamline`.`rq_questions_suppressed` (
  `facility_id` INT NOT NULL ,
  `question_id` INT NOT NULL ,
  PRIMARY KEY (`facility_id`, `question_id`) ,
  INDEX `fk_req_facility_suppressed_question_req_question` (`question_id` ASC) ,
  INDEX `fk_rq_questions_suppressed_xa_facilities` (`facility_id` ASC),
  CONSTRAINT `fk_req_facility_suppressed_question_req_question`
    FOREIGN KEY (`question_id` )
    REFERENCES `beamline`.`rq_questions` (`id` )
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_rq_questions_suppressed_xa_facilities`
    FOREIGN KEY (`facility_id` )
    REFERENCES `beamline`.`xa_facilities` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB; 
```

是什么赋予了？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T10:38:16.857

我已经尝试运行您的查询（NB6.5.1），它们似乎工作正常。我确实必须注释掉所有的外键约束，所以它不是一个精确的复制。

鉴于此，您是否有可能没有创建所有引用的表（xa_facilities、rq_questions 等）？它们的结构是否正确？

对于未来，我建议将关系约束分离到单独的脚本中，以便您始终确定在*所有*表都存在之后创建它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T22:21:02.130

问题解决了; xa_facilities 的外键是 INT(11)，而 xa_facilities 的主键是 INT(4)。呸！

# perl - 为什么我的 Perl bigint 有小数位？

> ID：841946
> 
> 赞同：1
> 
> 时间：2009-05-08T21:42:02.083
> 
> 标签：perl, string, bigint

如果我确实在 substr 中使用了一个大整数：

```
use BigInt;
$acct_hash = substr(('99999999999912345' + $data[1]),0,15); 
```

为什么结果还在`9.9999999999912`？

我期待着`999999999999912`。有没有类似的东西：

```
$data[1] = substr(to_char('999999999999991234'),0,15); 
```

在 Perl 中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T22:50:07.600

要获得 和 和的前 15 位数字`$a`，`$b`请执行以下操作：

```
use bigint;
my $a = "99999999999912345";  # works with or without quotes
my $b = "111";                # works with or without quotes
print substr(0 + $a + $b, 0, 15), "\n"; 
```

您的代码没有按预期工作的原因是 Perl 对`$a + $b`if both `$a`and `$b`are strings 进行了浮点加法，即使`use bigint`是有效的。例子：

```
use bigint;
print     1234567890123456789  +  2 , "\n";  #: 1234567890123456791
print    "1234567890123456789" +  2 , "\n";  #: 1234567890123456791
print     1234567890123456789  + "2", "\n";  #: 1234567890123456791
print    "1234567890123456789" + "2", "\n";  #: 1.23456789012346e+18
print 0 + 1234567890123456789  + "2", "\n";  #: 1234567890123456791 
```

这种行为是 Perl`bigint`模块中的一个怪癖。您可以通过添加 a `0 +`（如上所示）来解决它，从而强制添加 bigint 而不是浮点添加。另一种解决方法可以`Math::BigInt->new($a) + $b`代替`0 + $a + $b`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T22:27:29.540

我认为您遇到的是字符串解释的问题。试试这个代码：

```
use bigint;
print(99999999999912345 + 99999999999912345, "\n"); 
```

并将其与非常相似的内容进行比较：

```
use bigint;
print('99999999999912345' + '99999999999912345', "\n"); 
```

在您的数字周围使用单引号会将它们变成字符串，并且似乎可以绕过`bigint`.

# c - 在 Visual Studio 2005 中使用 WinDDK 测试实用程序

> ID：841947
> 
> 赞同：1
> 
> 时间：2009-05-08T21:42:14.830
> 
> 标签：c, winapi, driver, wdk

我目前正在尝试运行 WinDDK 2003 提供的 NdisProt 驱动程序。我已经成功构建并安装了驱动程序。

它带有一个名为 uiotest 的测试实用程序

当我使用 make 构建实用程序时，它可以正常运行。

当我使用 Visual Studio 2005 创建一个空白的 win32 应用程序解决方案时，它无法在`CreateFile( "\\.\\NdisProt"`[...])` 期间连接到驱动程序。该调用始终返回无效句柄。我怀疑我的项目与使用 make 构建的项目不完全相同。这是make使用的“源”文件的内容

```
TARGETNAME=uiotest
TARGETPATH=obj
TARGETTYPE=PROGRAM

C_DEFINES=$(C_DEFINES) -D_WIN32WIN_

# MSC_WARNING_LEVEL=/W4

UMTYPE=console
USE_MSVCRT=1

TARGETLIBS=\
    $(SDK_LIB_PATH)\user32.lib

INCLUDES=..\sys

SOURCES=\
    uiotest.c 
```

我已经添加了 lib 路径和包含路径到我的项目

这是从 ddk 环境中获得回报的原因

```
cl -nologo -Ii386\ -I. -ID:\WINDDK\3790~1.183\inc\mfc42 -I..\sys -Iobjfre_wxp_x8
6\i386 -ID:\WINDDK\3790~1.183\inc\wxp -ID:\WINDDK\3790~1.183\inc\wxp -ID:\WINDDK
\3790~1.183\inc\crt -D_X86_=1 -Di386=1  -DSTD_CALL -DCONDITION_HANDLING=1   -DNT
_INST=0 -DWIN32=100 -D_NT1X_=100 -DWINNT=1 -D_WIN32_WINNT=0x0501 /DWINVER=0x0501
 -D_WIN32_IE=0x0603    -DWIN32_LEAN_AND_MEAN=1 -DDEVL=1 -D__BUILDMACHINE__=WinDD
K -DFPO=0  -DNDEBUG -D_DLL=1 -D_MT=1  -D_WIN32WIN_     /c /Zl /Zp8 /Gy /Gm-  /W3
 /WX /Gz  /GX-  /GR- /GF /GS /G6 /Ze /Gi- /QIfdiv- /hotpatch -Z7 /Oxs  /Oy-   -F
ID:\WINDDK\3790~1.183\inc\wxp\warning.h   .\uiotest.c
uiotest.c
        link -out:objfre_wxp_x86\i386\uiotest.exe -machine:ix86 @C:\Temp\nm88BE.
tmp
Microsoft (R) Incremental Linker Version 7.10.4035
Copyright (C) Microsoft Corporation.  All rights reserved.

-MERGE:_PAGE=PAGE
-MERGE:_TEXT=.text
-SECTION:INIT,d
-OPT:REF
-OPT:ICF
-IGNORE:4198,4010,4037,4039,4065,4070,4078,4087,4089,4221
-INCREMENTAL:NO
-FULLBUILD
/release
-NODEFAULTLIB
/WX
-debug
-debugtype:cv
-version:5.1
-osversion:5.1
/functionpadmin:5
/safeseh
/opt:nowin98
-merge:.rdata=.text
/pdbcompress
-STACK:0x40000,0x2000
/tsaware
-subsystem:console,4.00
-base:@D:\WINDDK\3790~1.183\bin\coffbase.txt,usermode
-entry:mainCRTStartup
objfre_wxp_x86\i386\uiotest.obj
D:\WINDDK\3790~1.183\lib\wxp\i386\BufferOverflowU.lib
D:\WINDDK\3790~1.183\lib\crt\i386\msvcrt.lib
D:\WINDDK\3790~1.183\lib\wxp\i386\advapi32.lib
D:\WINDDK\3790~1.183\lib\wxp\i386\kernel32.lib
D:\WINDDK\3790~1.183\lib\wxp\i386\user32.lib
D:\WINDDK\3790~1.183\lib\wxp\i386\sehupd.lib 
```

我不太确定要检查什么才能知道发生了什么，所以任何帮助都会很明显。新项目编译并运行，但`CreateFile()`失败并显示 INVALID_HANDLE_VALUE

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T21:55:24.597

这可能不是全部问题，但从引用的代码中跳出来的一件事是 call `CreateFile("\\.\\NdisProt",...)`。内核名称空间中对象的正确路径名以两个反斜杠开头，每个反斜杠都需要在 C 字符串中加倍。过去我在 SO 使用的标记语言被反斜杠混淆时遇到过问题，所以我冒昧地编辑了你的问题，以确保我看到你打算呈现的名称，并修复标记以保留它意图。

因此，用于创建设备对象句柄的名称应如下所示

```
CreateFile("\\\\.\\NdisProt",...) 
```

寻址名为的设备对象

```
\\.\NdisProt 
```

我不知道是否还有其他问题，或者即使那是该驱动程序导出的正确名称。

DDK 示例通常被编写为不依赖于 MFC、ATL、WTL 等。这导致代码中有一种做作的风格，但它的好处是可以使用最初随 DDK 本身附带的工具链构建示例，并且相对独立于所使用的工具链的选择。

请注意，如果您最终尝试真正调试驱动程序，则可能需要通过内核跟踪来自用户模式代码的调用并进入驱动程序的相关位。如果用户模式代码尽可能简单，那么使用内核调试器执行此操作会更容易。这也可以解释示例代码中使用的样式。

**编辑：**如果还有浮动的 Unicode 与 ANSI 问题，那么您应该检查您的代码以查找将窄字符串传递给期望宽字符串的 API 并修复它们的地方。

一种简单的修复方法是为所有 Windows API 切换到 ANSI 编译。当然，现在您遇到了包含当前代码页中没有的国家字符的文件名的问题，因为无法保证 Unicode 文件名可以正确地转换为 ANSI 或从 ANSI 转换。

一种可能“足够好”的修复方法是通过编写字符串常量来使​​它们变宽`L"..."`。但是，现在保证您的代码不能移植回 ANSI 编译器，因此请务必使用编译时断言来验证`UNICODE`已定义，以便您得到一个好的错误消息。

微软的党派路线似乎是从不使用任何一个，`char`或者`wchar_t`改为使用`TCHAR`. 标头[`<tchar.h>`](http://msdn.microsoft.com/en-us/library/c426s321(VS.80).aspx)提供映射宏，通过在编译时选择宽或窄 API，允许在 Windows API 和 C 运行时库中声明和使用字符串。可以说，这是在 Windows 应用程序中正确的做法，因为它已经不能很好地移植到其他平台。

然而，让宏魔法正确处理将`TCHAR`s 转换为已知表示是一件痛苦的事情。

无论您选择哪种技术，我都认为没有任何办法可以对字符串处理和字符表示假设进行仔细和完整的代码审查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T14:03:10.420

解决了一半：

CreateFile 正在引用等待 unicode 字符串的 CreateFileW。当我强制 CreateFileA 它工作。

# php - Doctrine Profiler 不捕获查询

> ID：841950
> 
> 赞同：0
> 
> 时间：2009-05-08T21:42:47.387
> 
> 标签：php, zend-framework, doctrine, profiler

我想我一定在这里遗漏了一些明显的东西。我一起设置了 Doctrine 和 Zend Framework。在 bootstrap.php 文件中，我有以下内容 - 基于使用分析器的 Doctrine 文档：

```
$profiler = new Doctrine_Connection_Profiler();
$conn = Doctrine_Manager::connection();
$conn->setListener($profiler);

(...)

$frontController = Zend_Controller_Front::getInstance();

(...)

$query_count = 0;
$time = 0;
echo "<table width='100%' border='1'>";
foreach ( $profiler as $event ) {
    if ($event->getName() != 'execute') {
        continue;
    }
    $query_count++;
    echo "<tr>";
    $time += $event->getElapsedSecs() ;
    echo "<td>" . $event->getName() . "</td><td>" . sprintf ( "%f" , $event->getElapsedSecs() ) . "</td>";
    echo "<td>" . $event->getQuery() . "</td>" ;
    $params = $event->getParams() ;
    if ( ! empty ( $params ) ) {
          echo "<td>";
          echo join(', ', $params);
          echo "</td>";
    }
    echo "</tr>";
}
echo "</table>";
echo "Total time: " . $time . ", query count: $query_count <br>\n "; 
```

没有错误，最后的探查器输出仅打印：“总时间：0，查询计数：0”。

随着查询的执行，连接肯定是有效的——我有一个 SELECT 使用 Doctrine_Query::create() 获取一堆项目，它是执行方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T13:49:49.627

有更好的方法，但这可能是一个更好的起点。

假设在引导期间设置了连接和分析器，有几个初步尝试来开发 Doctrine 资源插件，请参阅[http://www.nabble.com/RFC%3A-ZendX_Doctrine-to23454552.html](http://www.nabble.com/RFC%3A-ZendX_Doctrine-to23454552.html)和[http://www.nabble。 com/Autoload-models-with-no-namespace-to23387744.html](http://www.nabble.com/Autoload-models-with-no-namespace-to23387744.html)，您可以在控制器/动作中执行以下操作：

[http://pastie.org/475589](http://pastie.org/475589)

然后在布局或视图脚本中是这样的：

[http://pastie.org/475593](http://pastie.org/475593)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T18:06:32.450

在你开始运行之前，$profiler 数组中有什么？

# iphone - 有人可以向我展示视图控制器如何工作的图表吗？

> ID：841952
> 
> 赞同：0
> 
> 时间：2009-05-08T21:43:14.203
> 
> 标签：iphone, objective-c, cocoa, uiviewcontroller, controller

有人可以向我展示视图控制器如何在可可（obj-c）中工作的图表。

我只是想了解，因为他们让我感到困惑

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T22:21:09.243

我不认为 UIViewController 可以用图表来概括。

您遇到的具体困难是什么？从一个控制器到另一个控制器的导航？NavigationController 的堆叠方面？还是 ViewController 中的外观结构？

这个问题是如此开放式，我认为无法在本网站的单个线程中回答。我会为你指出关于 iPhone 编程的斯坦福课程的第 6 讲。讲义和讲义本身（带有示例练习）都可以在以下网址找到：http: [//www.stanford.edu/class/cs193p/cgi-bin/index.php](http://www.stanford.edu/class/cs193p/cgi-bin/index.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T23:33:52.657

斯坦福链接是一个很好的参考。

通常，视图控制器为您的应用程序提供“粘合剂”。它应该从您的模型中获取/处理数据并将其交给视图。几乎所有的应用程序逻辑都将在 View Controller 中。

以下文本来自 Apple 的 Cocoa Fundamentals Guide：

> 控制器对象将模型绑定到视图
> 
> 控制器对象充当应用程序的视图对象及其模型对象之间的中介。控制器通常负责确保视图可以访问它们需要显示的模型对象，并充当视图了解模型更改的管道。控制器对象还可以为应用程序执行设置和协调任务，并管理其他对象的生命周期。
> 
> 在典型的 Cocoa MVC 设计中，当用户通过视图对象输入一个值或指示一个选择时，该值或选择被传达给一个控制器对象。控制器对象可能会以某种特定于应用程序的方式解释用户输入，然后可以告诉模型对象如何处理该输入——例如，“添加新值”或“删除当前记录”；或者它可能让模型对象在其属性之一中反映更改的值。基于同样的用户输入，一些控制器对象也可能告诉视图对象改变其外观或行为的一个方面，例如禁用按钮。相反，当模型对象发生变化时——比如说，访问了一个新的数据源——模型对象通常会将这种变化传达给控制器对象，
> 
> 控制器对象可以是可重用的或不可重用的，这取决于它们的一般类型。“Cocoa 控制器对象的类型”描述了 Cocoa 中不同类型的控制器对象。

一个相关的图表是模型、视图和控制器之间的关系（再次由苹果提供）：

[MVC 图 http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/CocoaFundamentals/Art/cocoa_mvc.gif](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/CocoaFundamentals/Art/cocoa_mvc.gif)

# ios - NSOperation 对象（线程环境）中的非原子属性，何时使用它？

> ID：841954
> 
> 赞同：1
> 
> 时间：2009-05-08T21:43:20.973
> 
> 标签：ios, objective-c, iphone, multithreading, cocoa-touch

我仍然在使用在线程环境中工作的窍门`NSOperation`，并且我有兴趣了解`nonatomic`如果您要子类化，使用该属性是否值得`NSOperation`？

如果您`defaultQueue`设置为 1，那么非原子的额外开销是否值得？如果每个操作队列执行超过 1 个线程，可能需要它吗？

感谢您提供更好地理解线程环境中此属性的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T23:54:46.757

如果您有一个对象（或该对象的属性）可以保证它不会同时从多个线程访问，那么您可以通过使用非原子来避免对该属性进行原子访问的潜在开销。在最简单的情况下，创建一个操作并将其排入 NSOperationQueue，每个 NSOperation 实例要么在调用线程中设置，要么在单个后台线程中运行；所以在任何时候，只有一个线程应该访问它。

非原子何时有用的更普遍的问题部分取决于您是否在启用垃圾收集的情况下运行。根据 Objective-C 发行说明：

> 默认情况下，对属性的访问是原子的。这在 GC 下对于几乎所有东西都是微不足道的，在非 GC 下对于除了对象和结构之外的所有东西也是微不足道的。特别是在非 GC 条件下对保留对象的原子访问可能会很昂贵。因此，非原子属性是可用的。

# perl - 如何使用 Perl 和 Apache 防止跨站点请求伪造？

> ID：841957
> 
> 赞同：3
> 
> 时间：2009-05-08T21:44:17.803
> 
> 标签：perl, apache, csrf

是否有任何我可以使用的透明库或一些简单的库，以便我可以使用Perl 和 Apache防止[跨站点请求伪造 (CSRF) ？](http://en.wikipedia.org/wiki/Cross-site_request_forgery)如何为表单生成令牌并在服务器端验证它们？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-12-01T22:58:49.300

看看[CGI::Application::Plugin::ProtectCSRF](http://search.cpan.org/perldoc?CGI::Application::Plugin::ProtectCSRF)做了什么。该模块适用于 CGI::Application 框架。

为其他框架修改模块应该不会太难。基本上，用户表单获得了一个隐藏的 HTML 字段，其中添加了生成的令牌，会话对象获得了相同的令牌。提交表单时，会将表单提交的令牌与会话对象（位于服务器上）中的令牌进行比较。如果它们不匹配，则可能发生了 CSRF。

还有一个 Catalyst 插件：[Catalyst::Controller::RequestToken](http://search.cpan.org/perldoc?Catalyst::Controller::RequestToken)

这些模块使用属性处理程序，因此您现有的应用程序几乎不需要修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T23:14:28.057

为了防止来自服务器端的“跨站请求伪造”，最好：

1.  使用 HTML 转义。如果您使用模板工具包之类的模板系统，您应该使用它的转义功能。如果你使用 CGI.pm，它有 "escapeHTML" sub 来做这件事。
2.  将会话 cookie 的生命周期限制为相对较短的时间。对于 CGI::Session 可以使用 $session->expire($time) 来完成。
3.  输出易受攻击的页面时检查referer。
4.  不要使用/接受 GET 请求来修改数据。

这样做是特定于框架的，但很简单。

# django - 我应该创建表单对象还是从模型生成它们

> ID：841958
> 
> 赞同：2
> 
> 时间：2009-05-08T21:44:25.200
> 
> 标签：django

我最近发现我可以从模型中生成表单。我已经阅读了文档并且想知道为什么有人会选择不这样做来支持创建自己的表单对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T21:47:50.807

并非所有表单都与模型直接相关。虽然大多数情况下您最终可能会使用 ModelForm，但有时您希望为可以更好地表示为单个表单的内容创建一个表单，然后您可以在视图中将数据修补在一起。根据我的经验，这种情况并不常见，但有时会发生。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T21:56:04.827

根据 Paolo 的回答，如果您正在从用户那里收集数据以存储在您的数据库中，那么您可能已经设置了一个模型，其中包含需要收集的信息的字段。在这种情况下，使用`ModelForm`. 另一方面，有时您会遇到这样的场景，即您不是从用户那里收集数据，而是使用他们的输入对数据库中已有的数据执行一些操作，例如，生成一个视图，该视图是来自多个模型的信息的混搭. 在这种情况下，您将需要使用`Form`. 这`Form`仍然允许您相对轻松地对用户输入执行验证。

# javascript - 动态加载 Javascript 对象的性能问题

> ID：841959
> 
> 赞同：1
> 
> 时间：2009-05-08T21:44:25.510
> 
> 标签：javascript, json, scripting, loading, dynamic

哪个更快，

1.  使用 XMLHTTP Get 请求而不是使用 eval() 作为响应文本

2.  使用 JSONP 技术加载脚本，然后评估脚本的 innerHtml。

3.  将脚本标记动态添加到将 javascript 对象分配给变量的文档的头部？

我的直觉告诉我这应该是选项 3，但我不确定 eval 与使用脚本标签的比较。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T22:00:38.047

它可能因浏览器和其他一些因素而异，所以我认为如果你真的想要最好的性能，你应该做一些测试并分析它们。一方面，eval() 的性能可能会因你 eval()'ing 的不同而有很大差异

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T00:09:54.880

您应该只使用[JSON2 库](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)来解析 json 数据，因为使用`eval`是不安全的（使用`eval`会导致大量潜在的站点漏洞利用），它很慢（尤其是在较新的 jitting JS 引擎中），最后（更重要的是）JSON JSON2 库提供的对象正在成为 ecma 脚本（例如 javascript）标准的一部分，这意味着浏览器现在正在本地实现 json 解析（和字符串化），从而大大提高了性能。

令人高兴的是，如果您使用 JSON2 库，它会检测到 JSON 对象的本机实现的存在并且不会覆盖它，因此只要随意使用它就会为您提供一个安全的实现，随着浏览器支持的改进，它会神奇地变得更快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T17:10:16.987

我同意 JSON2 库可能是 eval()'ing 的方式。但是对于传输，根据 John Resig 所做的一些分析，JSONP 机制似乎比 XMLHTTPRequest 更快。

[http://ejohn.org/blog/native-json-support-is-required/](http://ejohn.org/blog/native-json-support-is-required/)

# asp.net - 无法让 JQuery 在母版页中工作

> ID：841964
> 
> 赞同：2
> 
> 时间：2009-05-08T21:45:43.387
> 
> 标签：asp.net, jquery

我有一个没有母版页的表单中的示例 jquery，它工作正常。我试图在我的母版页中使用相同的功能，但它不起作用，我使用的是 ASP.NET。这是我的代码：

网络表单（这有效）：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="WebForm3.aspx.cs" Inherits="Surfitlocal.WebForm3" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
    <script src="scripts/jquery-1.3.2.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            $('#pHeader').click(function() {
                $('#pBody').slideToggle('slow');
            });
        });
    </script>
    <style type="text/css">
        .cpHeader
        {
            color: white;
            background-color: #719DDB;
            font: bold 11px auto "Trebuchet MS", Verdana;
            font-size: 12px;
            cursor: pointer;
            width:450px;
            height:18px;
            padding: 4px;           
        }
        .cpBody
        {
            background-color: #DCE4F9;
            font: normal 11px auto Verdana, Arial;
            border: 1px gray;               
            width:450px;
            padding: 4px;
            padding-top: 7px;
        }      
    </style>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:Panel ID="pHeader" runat="server" CssClass="cpHeader">
            <asp:Label ID="lblText" runat="server" />
        </asp:Panel>

        <asp:Panel ID="pBody" runat="server" CssClass="cpBody">
            Lorem ipsum dolor sit amet, consectetur adipisicing elit,
            sed do eiusmod tempor incididunt ut labore et dolore magna
            aliqua. Ut enim ad minim veniam, quis nostrud exercitation
            ullamco laboris nisi ut aliquip ex ea commodo consequat.
            Duis aute irure dolor in reprehenderit in voluptate velit
            esse cillum dolore eu fugiat nulla pariatur
        </asp:Panel>
    </div>
    </form>
</body>
</html> 
```

MasterPage（这不起作用）：

```
<%@ Master Language="C#" AutoEventWireup="true" CodeBehind="Biz.Master.cs" Inherits="Surfitlocal.Site1" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
    <script src="scripts/jquery-1.3.2.js" type="text/javascript"></script> 
    <script type="text/javascript">
        $(document).ready(function() {
            $('#pHeader').click(function() {
                $('#pBody').slideToggle('slow');
            });
        });
    </script>     
    <style type="text/css">
        .cpHeader
        {
            color: white;
            background-color: #719DDB;
            font: bold 11px auto "Trebuchet MS", Verdana;
            font-size: 12px;
            cursor: pointer;
            width:450px;
            height:18px;
            padding: 4px;           
        }
        .cpBody
        {
            background-color: #DCE4F9;
            font: normal 11px auto Verdana, Arial;
            border: 1px gray;               
            width:450px;
            padding: 4px;
            padding-top: 7px;
        }      
    </style>
    <asp:ContentPlaceHolder ID="head" runat="server"></asp:ContentPlaceHolder>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:Panel ID="pHeader" runat="server" CssClass="cpHeader">
            <asp:Label ID="lblText" runat="server" />
        </asp:Panel>

        <asp:Panel ID="pBody" runat="server" CssClass="cpBody">
            Lorem ipsum dolor sit amet, consectetur adipisicing elit,
            sed do eiusmod tempor incididunt ut labore et dolore magna
            aliqua. Ut enim ad minim veniam, quis nostrud exercitation
            ullamco laboris nisi ut aliquip ex ea commodo consequat.
            Duis aute irure dolor in reprehenderit in voluptate velit
            esse cillum dolore eu fugiat nulla pariatur
        </asp:Panel>    

        <asp:ContentPlaceHolder ID="ContentPlaceHolder1" runat="server">
</asp:ContentPlaceHolder>

    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T21:50:37.150

问题是，当您添加 MasterPage 时，您会得到 ClientID 修改。

```
$("#pBody")  =>   $(".pBody") 
```

您不能将 ID 与 MasterPage 一起使用，您将无法访问损坏的 clientID。您需要在元素上有一个自定义 css 类。

当然，现在您期望使用该 MasterPage 的每个页面都有一个 pBody。最好将该代码保留在页面中，而不是母版页中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T21:51:09.520

我可以看到您正在使用`CssClass`，但在您的函数中使用“#”表示它的 ID。

所以

```
$('#pBody') 
```

应该

```
$(".pBody') 
```

如果您仍想使用 ID，则应使用：

```
$("#<%= pBody.ClientID %>") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-01T05:48:38.580

试着把这些放在下面。它可能有助于母版页

```
$(document.getElementById("<%=pHeader.ClientID%>")

$(document.getElementById("<%=pBody.ClientID%>") 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-08-17T20:31:23.013

要在 asp.net 中解决此问题，您可以使用脚本管理器：

```
<asp:ScriptManager ID="ScriptManager1" runat="server">
     <Scripts>
     //put your js file in script reference tag: 
     //<asp:ScriptReference Path="~/scripts/jquery-1.3.2.js" />
     //<asp:ScriptReference Path="~/scripts/PWDMenuMaker.js" />
    </Scripts>
</asp:ScriptManager> 
```

//Movafagh 巴希德

# c++ - 如何消除此模板代码的歧义？

> ID：841966
> 
> 赞同：1
> 
> 时间：2009-05-08T21:45:51.733
> 
> 标签：c++, templates

我无法弄清楚如何解决我遇到的编译器错误。我已将其简化为最简单的表示形式：

```
enum EAtomId { EAtomId_Test };

int StringFormat(char* o_dest, size_t i_destSizeChars, const char* i_format, ...);

template <size_t SIZE>
int StringFormat(char (&o_dest)[SIZE], EAtomId i_format, ...);

void func()
{
    char textBuffer[1000];
    StringFormat(textBuffer, EAtomId_Test, "hi there");
} 
```

编译器错误是：

```
repro.cpp(17) : error C2666: 'StringFormat' : 2 overloads have similar conversions
    C:\Users\sbilas\Desktop\repro.cpp(9): could be 'int StringFormat(char *,size_t,const char *,...)'
    while trying to match the argument list '(char [1000], EAtomId, const char [9])' 
```

这是完整的错误顺便说一句。我有点惊讶它没有列出两个可用版本..

我对这个错误有几个问题。首先，我不明白为什么它是模棱两可的。编译器不应该将 char(&)[] 版本视为匹配的明显案例吗？其次，如何防止该枚举在进行查找时转换为 size_t ？似乎我在这里遇到了一些非常具体的 C++ 规则。

对我来说最简单的解决方法是将缓冲区大小的 size_t 放在实际缓冲区的前面。但这将打破我们在代码中放置缓冲区然后大小的所有约定。还有另一种方法可以做到这一点吗？

这是在 VC++ 2005 顺便说一句，但它在我拥有的其他几个编译器上重现（这是在跨平台游戏中）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T21:53:16.190

您有两个声明`StringFormat`：

```
int StringFormat(char* o_dest, size_t i_destSizeChars,
                 const char* i_format, ...);

template <size_t SIZE>
int StringFormat(char (&o_dest)[SIZE], EAtomId i_format, ...); 
```

当函数模板和普通（非模板）函数都可用时，请阅读与参数相关的查找和替换规则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T11:51:57.650

上面代码的问题是由于普通的重载解析规则，而不是特定于模板。以下带有两个普通函数的代码仍然显示出歧义：

```
enum EAtomId { EAtomId_Test };
const int SIZE=1000;

int StringFormat(char * s
  , size_t i_destSizeChars
  , const char* i_format
  , ...);

int StringFormat(char (&a)[SIZE]
  , EAtomId i_format
  , ...);

void func()
{
    char textBuffer[SIZE];
    StringFormat (textBuffer, EAtomId_Test, "hi there");
} 
```

重载解决的适用规则如下（13.3.3）：

*   对于每组参数，计算出发生的一组转换
*   最好的函数是一个函数，它的所有转换都至少与所有其他重载中的转换一样好。

依次考虑其中的每一个，我们有：

**功能一：**

1.  textBuffer->s：指向指针的数组（精确匹配 13.3.3.1.1/3）- 标识
2.  EAtomId_Test->i_destSizeChars：可能的提升和积分转换
3.  string literal->const char*: 指向指针的数组

**功能二：**

1.  textBuffer->a：身份转换
2.  EAtomId_Test->EAtomId：身份转换
3.  字符串文字->省略号：省略号转换

依次比较这些转换中的每一个，您有：

1.  功能 1 与功能 2 相同
2.  功能 2 优于功能 1
3.  功能 1 优于功能 2

因此，函数 1 和函数 2 对**所有**转换都没有那么好，因此调用是模棱两可的。

# python - Python：ODBC 异常处理

> ID：841968
> 
> 赞同：0
> 
> 时间：2009-05-08T21:46:11.763
> 
> 标签：python, odbc

我需要在我的应用程序中识别表是否不存在或没有行来采取适当的行动。我可以分别捕获这两个错误吗？

```
>>>cursor.execute("delete from TABLE")

Traceback (most recent call last):
  File "<interactive input>", line 1, in <module>
dbi.internal-error: [IBM][CLI Driver][DB2] SQL0100W  No row was found for FETCH, UPDATE or DELETE; or the result of a query is an empty table.  SQLSTATE=02000
 in EXEC 
```

或者

```
Traceback (most recent call last):
  File "<interactive input>", line 1, in <module>
dbi.program-error: [IBM][CLI Driver][DB2] SQL0204N  "SK77531.TCS_EXCEPTIONS" is an undefined name.  SQLSTATE=42704
 in EXEC 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T22:04:56.773

从[Python 文档](http://www.python.org/doc/2.5/tut/node10.html)：

> 一条 try 语句可能有多个 except 子句，用于指定不同异常的处理程序。

例如：

```
try:
    do_something_crazy
except AttributeError:
    print 'there was an AttributeError'
except NameError:
    print 'there was a NameError'
except:
print 'something else failed miserably' 
```

最后一个 except 在这里充当一个包罗万象的角色，并且仅在发生不同于 AttributeError 或 NameError 的异常时才执行。在生产代码中，最好避开这种包罗万象的 except 子句，因为通常您希望代码在发生意外错误时失败。

在您的特定情况下，您需要导入可以从 dbi 模块引发的不同异常，因此您可以在不同的 except 子句中检查它们。

所以是这样的：

```
# No idea if this is the right import, but they should be somewhere in that module
import dbi

try:
    cursor.execute("delete from TABLE")
except dbi.internal-error:
    print 'internal-error'
except dbi.program-error:
    print 'program-error' 
```

正如您将在上述文档页面中看到的那样，您可以选择在每个 except 子句中包含附加属性。这样做可以让您访问实际的错误对象，当您需要区分同一类的两个不同异常时，这对您来说可能是必要的。即使您不需要如此精细的区分，最好进行比我上面概述的更多的检查，以确保您实际上正在处理您认为正在处理的错误。

所有关于 try/except 的说和做，我真正建议的是在你用来检查表是否存在的数据库库代码中搜索一个方法，然后再尝试与之交互。当您处理需要检查和清理的外部输入时，结构化的 try/excepts 非常有用，但是围绕数据库表的暂定存在进行防御性编码听起来像是稍后会转身咬你的东西。

# jquery - 找不到合适的 加载 HTML 后使用选择器

> ID：841982
> 
> 赞同：0
> 
> 时间：2009-05-08T21:50:12.673
> 
> 标签：jquery, asynchronous, css-selectors, callback

我希望我能找到解决这个问题的方法。它是这样的：

在我提交表单以向数据库添加消息后，我`<div>`使用 load 方法创建了一个。之后我在回调函数中做了一些事情。

当创建新的函数`<div>`完成后，它返回到调用函数，该函数应该将消息添加到最后插入的`<div>`.

这就是问题开始的地方：

我使用选择器查找`$(someDiv : last)`，但它放错了`<div>`。所以，我知道它与异步过程有关。

我还没有真正想出我能做些什么来解决这个问题，因为现在我不是在使用回调函数。

如果你想看一个[活生生的例子](http://www.woonbel.nl/testpagina2.php)源代码以警报的形式充满了调试代码，但你可以看到它在做什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T22:44:52.340

Ajax 调用是异步的，您应该使用回调函数来选择加载的数据，例如：

```
$('div').load(url, data, function(data, status) {
   $(someDiv:last).dosomething();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T22:07:57.810

可能新的 div 没有插入到您认为的位置。$(someDiv : last) 返回错误的结果，因为新的 div 不在 someDiv 中，或者它不在末尾。这似乎是 Firebug 可以轻松调试的那种东西。

与其使用“最后一个”元类来选择 div，还有一个更好的主意：给新的 div 一个 ID 并直接引用它。或者在创建的时候给它一个类，用这个类来选择它$(".newdiv")，然后在你完成后清除这个类。或者只是将新的 div 返回给调用函数，因此它根本不需要使用选择器。抱歉，我不完全了解您的情况，但我认为这些解决方案中至少有一个可行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T22:37:45.320

您是否注意到第一次将值添加到第一项，然后将其添加到先前的最后一项？这可能是一个线索。哦，我陷入了一个循环，我的消息添加了 10 次。看起来你的代码有时间问题。

编辑：让它回到它的基础看起来像这样： http: [//kruisit.nl/so/841982/](http://kruisit.nl/so/841982/) 希望有帮助。

# javascript - 跨不同域访问 iframe 元素

> ID：841984
> 
> 赞同：2
> 
> 时间：2009-05-08T21:50:38.163
> 
> 标签：javascript, iframe, xss, policy, capability

我了解跨站点脚本 (xss) 不好，并且在大多数浏览器中不受支持。但是，我正在构建一个仅供我公司内大约 3 或 4 人使用的页面。在这个页面上，我有一个来自另一个域的框架，我需要父页面才能访问该框架中的值。

所以我的问题是，有没有办法（更改设置等）在 Firefox 或 IE7 中允许这种情况发生？最好（尽管不一定）任何设置更改都明确针对我的域。

我在网上找到了一些帮助，说在 FF 中你可以添加 capability.policy 来允许这样做。不过我没有运气，也许FF3不支持。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-11-23T00:29:08.233

对于那些寻找的人来说，有一种很好的向后兼容的、仅限 javascript 的跨域通信方式。简短、简单的代码也是如此。完美解决方案？只要您对父母和孩子提出修改请求：

[http://www.onlineaspect.com/2010/01/15/backwards-compatible-postmessage/](http://www.onlineaspect.com/2010/01/15/backwards-compatible-postmessage/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T22:08:43.207

我头顶的几个想法：

*   在 IE 中，您可以更改站点所在安全区域的设置。我建议您将域添加到“受信任的站点”，然后确保为受信任的站点区域启用“跨域访问数据源。” . 你可以在这里找到更多信息[。](http://blogs.msdn.com/ie/archive/2005/01/26/361228.aspx)

*   如果您有一个可以控制的域名，也许您可​​以设置指向不同框架中站点的子域？从而欺骗网络浏览器他们是同一站点的一部分？

*   如果您喜欢编码，您可以创建一个使用 IE 浏览器控件并实现其自己的 IInternetSecurityManager ( [http://msdn.microsoft.com/en-us/library/ms537130(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms537130(VS.85).aspx) ) 的自定义应用程序，它允许跨域脚本访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T22:53:54.843

另一种选择是设置代理页面，使页面看起来源自同一个域。代理页面可能非常容易受到 XSS 的攻击，具体取决于实现。即使您说这不是问题，但重要的是要考虑。

# asp.net - IIS 7、ASP.NET：AccessViolationException

> ID：841992
> 
> 赞同：0
> 
> 时间：2009-05-08T21:52:43.463
> 
> 标签：asp.net, iis-7, access-violation

IIS 7 下的 ASP.NET 应用程序出现以下异常的原因是什么？这是一个未处理的异常，会重新启动整个应用程序。

**异常：** System.AccessViolationException

**消息：**试图读取或写入受保护的内存。这通常表明其他内存已损坏。

**堆栈跟踪：**

```
 in System.Web.Hosting.UnsafeIISMethods.MgdIsLastNotification(IntPtr pRequestContext, RequestNotificationStatus dwStatus)
   in System.Web.HttpRuntime.FinishRequestNotification(IIS7WorkerRequest wr, HttpContext context, RequestNotificationStatus& status)
   in System.Web.HttpRuntime.OnRequestNotificationCompletionHelper(IAsyncResult ar)
   in System.Web.HttpRuntime.OnRequestNotificationCompletion(IAsyncResult ar)
   in System.Web.HttpAsyncResult.Complete(Boolean synchronous, Object result, Exception error, RequestNotificationStatus status)
   in System.Web.HttpApplication.PipelineStepManager.ResumeSteps(Exception error)
   in System.Web.HttpApplication.ResumeStepsWaitCallback(Object error)
   in System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   in System.Threading._ThreadPoolWaitCallback.PerformWaitCallbackInternal(_ThreadPoolWaitCallback tpWaitCallBack)
   in System.Threading._ThreadPoolWaitCallback.PerformWaitCallback(Object state) 
```

**[更新]**

**系统：** Windows Web Server 2008 64 位。

**应用程序详细信息：**不使用页面架构的 ASP.NET 应用程序。它使用自定义 http 同步和异步处理程序处理请求。还有来自 ThreadPool 或由 Thread 类创建的并行线程正在运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-09T13:25:13.830

在这种情况下，硬件错误有时是意外的罪魁祸首。一切都可以完美运行，除了一个不起眼的 DLL 中的一个小方法。

或者这是否也发生在多台机器上？尝试不同的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T21:57:47.070

第三方 ISAPI 筛选器可能会导致此问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-18T23:49:53.733

当我的函数返回时我遇到此问题，`IHttpHandler.ProcessRequest()`而我仍然对or进行`WriteAsync()`或`FlushAsync()`操作（即，当我没有等待从这些函数返回时）。`HttpResponse``HttpResponse.OutputStream``Task`

虽然您的问题是在将 async/await 引入 C# 之前编写的，因此您不会一直使用这些关键字，但听起来您确实在执行很多异步操作（异步处理程序、并行线程等），所以我我敢打赌，这很有可能与您遇到的潜在问题相同。

在某些情况下，它可能只是一个错误，您的请求处理程序无法确保`WriteAsync()`or`FlushAsync()`操作完成，并且代码修复应该只是确保您在从`ProcessRequest()`. 但是，就我而言，我将`WriteAsync()`or包装在一些自定义超时逻辑中，并且在客户端没有及时响应的情况下`FlushAsync()` `Task`故意不等待底层。`Task`

在我的本地计算机（Windows 1809，.NET 4.7.2）上，我似乎可以保留我的自定义超时逻辑，同时通过`HttpContext.Request.Abort()`在我不想等待`WriteAsync()`or`FlushAsync()`操作完成时调用来避免此 AccessViolationException。但是，此修复似乎不适用于我测试过的某些 Windows Server 2016 或 2012 R2 服务器。因此，在最近的 Windows 版本中，这种行为有可能发生了变化，尽管我不能 100% 确定没有其他变量可以解释我测试过的机器之间的行为差​​异。*******`