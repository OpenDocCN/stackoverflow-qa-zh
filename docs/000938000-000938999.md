# StackOverflow 问答 000938000-000938999

# mime - MIME 标头 - 内容处置

> ID：938005
> 
> 赞同：2
> 
> 时间：2009-06-02T05:23:23.663
> 
> 标签：mime

我试图弄清楚当文件作为附件发送时是否需要“Content-Disposition:attachment; filename=file_name”，并且我有兴趣通过存储（驱动器）上的原始名称保留它。看起来这是检索原始文件名的唯一方法，但是 RFC 在它上面很混乱（[链接到 RFC](https://www.rfc-editor.org/rfc/rfc2183)）。它使用诸如“应该”而不是“必须”之类的词。WIKI（[指向 WIKI 的链接](https://www.rfc-editor.org/rfc/rfc2183)）说得更好，但这不是我可以带给客户的 RFC。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T05:45:11.807

当然，标头是可选的，但如果您确实喜欢

*   文件是内联显示还是另存为附件，或者
*   如果将其保存为附件，建议的文件名应该是什么

浏览器或用户代理不受此标头约束，但将其视为建议。浏览器的实际行为可能很复杂，但通常，在没有此标头的情况下，浏览器将主要根据其 Mime 类型决定适当的操作过程，如果它是无法识别的 Mime 类型，它通常会默认保存为一个附件。

使用 Content-Disposition 标头可让您在以下情况下进行控制

*   您发送的内容具有 Mime 类型，收件人的浏览器可以内联显示，但您不希望它这样做，而是将其作为下载提供。
*   您正在发送可能由收件人保存到磁盘的内容，并且您想指定文件名在保存时应默认为什么。如果没有这些信息，浏览器通常会根据 URL 组成一个文件名，这可能不是一个合理的文件名（例如，如果从脚本提供所有内容，您不希望它是脚本的名称）。

# linux - 在 sqlite 数据库之间传输数据

> ID：938010
> 
> 赞同：5
> 
> 时间：2009-06-02T05:27:45.217
> 
> 标签：linux, sqlite

我正在使用 windows 上的 sqlite 在 Django 中开发应用程序。这个数据库可以在 linux 机器上工作吗？如果没有，我如何在 linux 上复制新数据库上的数据（创建脚本是一种方法）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T05:33:33.447

SQLite 与 Windows 和 Linux 平台兼容。

> 数据库文件格式是跨平台的——您可以在 32 位和 64 位系统之间或在大端和小端架构之间自由复制数据库。这些特性使 SQLite 成为应用程序文件格式的流行选择。

来源：[http ://sqlite.org/about.html](http://sqlite.org/about.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-20T22:01:24.660

正如 Robert 所写，SQLite 文件应该可以在任何平台上运行。如果您决定切换到 MySQL 或 PostgreSql，您可以运行以下（标准）命令将数据库保存在 Windows 机器上：

```
manage.py dumpdata <app1> <app1> > mydbdump.json 
```

然后在 Linux 机器上为 MySQL 或 PostgreSql 数据库配置 settings.py 并运行：

```
manage.py syncdb
manage.py loaddata ./mydbdump.json 
```

我已经多次成功地从 MySQL 切换到 SQLite，它运行良好。

仅供参考，您可以省略 dumpdata 命令中的列表以转储所有已安装应用程序的数据，但无法将其重新加载。全包转储将包含一些内部 Django 记录，例如默认内容类型和用户身份验证也是由 syncdb 命令创建的。所以你会得到像这样的错误

> IntegrityError：列 app_label、模型不是唯一的

列出您要转储和加载的特定应用程序，它将起作用。

# linq - 使用 linq 合并父子属性

> ID：938015
> 
> 赞同：0
> 
> 时间：2009-06-02T05:29:09.833
> 
> 标签：linq, parent

有没有一种 LINQ 方法可以做到这一点？任何帮助是极大的赞赏。

```
class Program
{
    static void Main(string[] args)
    {
        Parent parent1 = new Parent();
        parent1.Name = "P1";

        Parent parent2 = new Parent();
        parent2.Name = "P2";

        Child child1 = new Child();
        child1.Name = "C1";

        Child child2 = new Child();
        child2.Name = "C2";

        Child child3 = new Child();
        child3.Name = "C3";

        Child child4 = new Child();
        child4.Name = "C4";

        parent1.Children.Add(child1);
        parent1.Children.Add(child2);

        parent2.Children.Add(child3);
        parent2.Children.Add(child4);

        List<Parent> parentCollection = new List<Parent>();
        parentCollection.Add(parent1);
        parentCollection.Add(parent2);

        List<string> nameCollection = new List<string>();

        foreach( Parent parent in parentCollection){
            nameCollection.Add(parent.Name);
            foreach(Child child in parent.Children)
                nameCollection.Add(child.Name);

        }

    }
}

public class Parent
{
    public string Name = string.Empty;
    public List<Child> Children = new List<Child>();
}
public class Child
{
    public string Name = string.Empty;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T07:39:28.303

您可以使用 SelectMany 来展平子集合：

```
var all = parentCollection.Select(p=>p.Name)
        .Concat(parentCollection
                    .SelectMany(p=>p.Children).Select(c=>c.Name)); 
```

请注意，这仅适用于一种深度的父/子关系。你有真正的递归（几个级别），你必须实现一个迭代器，递归地产生孩子。

编辑：让孩子按正确的顺序排列，一些丑陋的东西：

```
 var all = parentCollection.Select(p=>new {Parent=p.Name, Name = ""})
            .Concat(parentCollection.SelectMany(p=>p.Children
                            .Select(c => new {Parent=p.Name, c.Name})))
            .OrderBy(o => o.Parent).ThenBy(o => o.Name)
            .Select(o=> o.Name != "" ? o.Name : o.Parent); 
```

# php - 从 PHP 中的键列表创建新数组

> ID：938016
> 
> 赞同：5
> 
> 时间：2009-06-02T05:29:35.027
> 
> 标签：php, arrays

我想要一种快速简便的方法来复制数组，但能够指定要复制的数组中的哪些键。

我可以很容易地为此编写一个函数，但我想知道是否已经有一个 PHP 函数可以做到这一点。类似于`array_from_keys()`下面的函数。

```
$sizes = array('small' => '10px', 'medium' => '12px', 'large' => '13px');

$chosen = array_from_keys($sizes, 'small', 'large');

// $chosen = array('small' => '10px', 'large' => '13px'); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T07:19:11.183

PHP 中有一个允许此类操作的本机函数，即 ie   `array_intersect_key`，但是您将不得不稍微修改您的语法。

```
 <?php
      $sizes = array('small' => '10px', 'medium' => '12px', 'large' => '13px');
      $selected = array_fill_keys(array('small', 'large'), null); 
      $result = array_intersect_key($sizes, $selected);
 ?> 
```

$result 将包含：

```
 Array (
        [small] => 10px
        [large] => 13px
    ); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-02T08:18:33.403

据我所知，没有这个功能。我认为最简单的方法是做这样的事情：

```
$chosen = array_intersect_key($sizes, array_flip(array('small', 'large'))); 
```

或者正如您所说，您可以轻松编写一个函数：

```
function array_from_keys() {
    $params = func_get_args();
    $array = array_shift($params);
    return array_intersect_key($array, array_flip($params));
}

$chosen = array_from_keys($sizes, 'small', 'large'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T06:17:27.777

简单的方法：

```
$sizes = array('small' => '10px', 'medium' => '12px', 'large' => '13px');
$chosen = array("small", "large");
$new = array();

foreach ($chosen as $key)
  $new[$key] = $sizes[$key]; 
```

# language-agnostic - 如何测试矩阵是否对角线？

> ID：938021
> 
> 赞同：7
> 
> 时间：2009-06-02T05:33:40.840
> 
> 标签：language-agnostic, matrix, testing, fortran

我需要测试一个方差矩阵是否是对角线。如果没有，我会做 Cholesky LDL 分解。但我想知道哪种最可靠和最快的测试方法是矩阵对角线？我正在使用 Fortran。

我想到的第一件事是对矩阵的所有元素求和，然后从该总和中减去对角线元素。如果答案为 0，则矩阵是对角线。有更好的想法吗？

在 Fortran 我会写

```
!A is my matrix
k=0.0d0
do i in 1:n #n is the number of rows/colums
k = k + A(i,i)
end do

if(abs(sum(A)-k) < epsilon(k)*sum(A)) then
#do cholesky LDL, which I have to write myself, haven't found any subroutines for that  in Lapack or anywhere else
end if 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T05:37:28.340

最好只遍历所有非对角线元素并测试它们是否接近零（比较浮点数的不等式容易出现舍入错误并可能导致错误结果）。

首先，一旦发现任何违规元素，您可以立即停止遍历，如果违规矩阵是典型的，这可能会显着减少时间。

其次，它可能允许编译器更好地展开循环（Fortran 编译器以良好的优化策略而闻名），并且由于较少的指令间依赖关系而实现更快的片上执行。

除此之外，您建议的算法容易发生溢出和错误累积，而“遍历和测试”算法则不会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T09:49:30.733

在矩阵中搜索非零值

```
logical :: not_diag
integer :: i, j

not_diag = .false.

outer: do i = 2, size(A,1)
  do j = i, size(A, 2)
    if (A(i,j) > PRECISION) then
      not_diag = .true.
      exit outer
    end if
  end
end outer

if (not_diag) then
  ! DO LDL' decomposition
end if 
```

要使用双精度 LAPACK 例程，请将第一个 's' 替换为 'd'。所以 spotrf 变成 dpotrf

[http://www.netlib.org/lapack/double/](http://www.netlib.org/lapack/double/)

# sql-server-2005 - 将数据从表导出到excel列名

> ID：938027
> 
> 赞同：0
> 
> 时间：2009-06-02T05:36:13.427
> 
> 标签：sql-server-2005, export-to-excel

如何使用列名将数据从表中导出到 Excel。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T05:47:42.677

在 SQL Server 2005 中，您可以使用 SQL Server Integration Services (SSIS) 将数据导出到 Excel。这是一篇可能会帮助您入门的文章：

[http://searchsqlserver.techtarget.com/generic/0,295582,sid87_gci1306800,00.html](http://searchsqlserver.techtarget.com/generic/0,295582,sid87_gci1306800,00.html)

在 2000 上，您可以使用数据转换服务 (DTS)。使用 DTS 将数据导出到 Excel 比在 SSIS 中更容易，可惜他们在 SSIS 中让它变得更加复杂。

[http://support.microsoft.com/kb/319951](http://support.microsoft.com/kb/319951)

还有一种使用 OPENROWSET 的更简单方法（这可能需要在导出之前创建 Excel 文件）：

[http://www.mssqltips.com/tip.asp?tip=1202](http://www.mssqltips.com/tip.asp?tip=1202)

另一种简单的方法是通过将值转储到逗号分隔的列表中来查询数据库，然后将结果保存为 .csv 文件。

更简单的方法可能需要一些巧妙的编码才能将列名输入到 Excel 电子表格中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-02-17T00:41:40.107

请参阅： [http](http://www.mssqltips.com/tip.asp?tip=1107) ://www.mssqltips.com/tip.asp?tip= 1107 在 SQL Server 2005 Management Studio 中使用网格查询结果复制列标题 打开 SQL Server 2005 Management Studio 并运行您的查询。选择查询 | 查询选项。选择结果/网格设置并选中“复制或保存结果时包括列标题”。现在，当您在结果窗格中复制结果并将它们粘贴到 excel 中时，您将获得列名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T05:50:12.657

你有几个选择。

1.  在 SSMS 中，工具 > 选项 > 查询结果 > SQL Server > 结果到网格 > 在复制或保存结果时包括列标题。然后，您可以手动复制并保存网格结果。
2.  在 Excel 中使用 Microsoft Query。
3.  右键单击数据库，选择任务 > 导出数据。使用导入/导出向导。
4.  使用 SSIS
5.  以编程方式提取值。

可能还有更多，但这是一个很好的选择！

# winforms - 在winforms中跨多个表单共享一个DataTable

> ID：938030
> 
> 赞同：0
> 
> 时间：2009-06-02T05:37:15.313
> 
> 标签：winforms, data-binding, compact-framework, datatable

我正在尝试编写一个简单的 Compact Framework winforms 应用程序。主窗体有一个绑定到 DataTable 的 DataGrid（包含来自 xml 文件的数据）。我想调出另一个显示当前记录详细信息的表单。我有类似下面的代码作为详细表单的构造函数。

```
public DetailsForm(DataTable dtLandlords, int Index) //the constructor
{
  InitializeComponent();
  lLandlordCode.DataBindings.Add("Text", dtLandlords, "LandlordID");
  .......
} 
```

我正在使用以下代码调用构造函数

```
 Form frm = new LandlordDetailsForm(dtLandlords, dataGrid1.CurrentRowIndex);
    frm.Show(); 
```

如何让它显示当前记录（在索引中指定 - 当前未使用），而不仅仅是第一条记录。还是有更好的方法让我这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T07:01:17.507

数据绑定“绑定”到提供的“视图”，目前您正在绑定到 DataTable 而不设置默认视图（因此它将默认为完整的表）。例如。dtLandlords.DefaultView.RowFilter = "LandlordID = TheIdYouWant";

另一种方法是将 DataGrid/GridView 本身添加到 DataBingings 中，这将提供一个包含当前选定项目的默认视图。

编辑：添加了绑定到 DataGridView 的示例

这方面的一个例子是：首先创建一个带有 TextBox 和 DataGridView（默认名称）的表单。然后把这段代码放在表单的构造函数中。

```
DataTable dt = new DataTable();
dt.Columns.Add("Col1");
dt.Columns.Add("Col2");
DataRow dr;
dr = dt.NewRow();
dr[0] = "C1R1";
dr[1] = "C2R1";
dt.Rows.Add(dr);
dr = dt.NewRow();
dr[0] = "C1R2";
dr[1] = "C2R2";
dt.Rows.Add(dr);
dr = dt.NewRow();
dr[0] = "C1R3";
dr[1] = "C2R3";
dt.Rows.Add(dr);

this.dataGridView1.DataSource = dt;
this.textBox1.DataBindings.Add("Text", dataGridView1.DataSource, "Col1"); 
```

然后运行，并选择 GridView 中的项目，TextBox 应该会自动使用所选的详细信息进行更新。注意：我在这里使用了 DataGridView，我认为它也适用于 DataGrids（我认为您正在使用）

# c# - 在 ASP.NET (C#) 中实现安全、唯一的“一次性”激活 URL

> ID：938031
> 
> 赞同：25
> 
> 时间：2009-06-02T05:37:17.170
> 
> 标签：c#, asp.net, tsql, cryptography, security

我有一个场景，我正在构建的网站的用户需要能够将一些基本信息输入网络表单而无需登录。该站点正在使用 ASP.NET/C# 进行开发，并使用 MSSQL 2005 处理其关系数据。

用户将收到来自该站点的电子邮件，为他们提供一个独特的链接以输入他们所需的特定信息。该电子邮件将与我们在注册论坛等网站时收到的电子邮件样式非常相似，其中包含一个随机生成的、唯一的 URL 参数，该参数专门针对单一目的（例如验证论坛的电子邮件地址）。

我的疑问是关于这个问题的安全实施。我正在考虑使用 GUID 作为唯一标识符，但不确定它在安全领域中的含义。

1.  GUID 是否足够长，以至于无法轻易猜出值（或随着时间的推移被暴力破解）？
2.  .NET 的 GUID 实现是否足够随机，因为在“密钥空间”中生成所有可能值的机会均等？

3.  如果使用 GUID 是一种可接受的方法，那么该站点是否应该通过 URL 重写或通过将数据表中的信息与 GUID 关联作为参考来重定向到信息？

4.  使用 URL 重写会隐藏数据的真实来源吗？

5.  我应该考虑使用 TSQL 的 SELECT NEWID() 作为 .NET 实现的 GUID 生成器吗？

6.  我对这个问题的处理方法完全错了吗？

非常感谢，

卡尔

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-02T05:57:57.980

1.  不，GUID 不是完全随机的，大多数位要么是静态的，要么很容易被猜到。
2.  不，它们不是随机的，请参见 1。实际上有非常少量的位实际上是随机的，并且不是加密的强随机。
3.  不是，见1和2。
4.  你可以，但不需要......最后看到我的解决方案。
5.  不，见 1 和 2
6.  是的。

您应该使用的而不是 GUID 是一个加密的强随机数生成器 - 使用[System.Security.Cryptography.RNGCryptoServiceProvider 来生](https://msdn.microsoft.com/en-us/library/system.security.cryptography.rngcryptoserviceprovider(v=vs.110).aspx)成长（比如 32 个字节）的数据字符串，然后对其进行[base64 编码](https://msdn.microsoft.com/en-us/library/dhx0d524(v=vs.110).aspx)。
此外，假设这是对敏感数据的某种注册，您可能希望限制链接的有效期，例如 60 分钟或 24 小时 - 取决于您的站点。
您需要将这些值映射到特定用户。然后，您可以根据需要自动向他展示适当的表格。不需要进行 url 重写，只需将其用作用户的标识符（在此页面上）。
当然，别忘了这个 URL 应该是 HTTPS...

顺便说一句，只是一个注释 - 在电子邮件中放置某种形式的文本是一种很好的做法，解释说用户不应该点击匿名电子邮件中的链接，通常你的网站不会发送，他们不应该在点击 blablabla 后输入密码...... .

哦，差点忘了——你应该考虑的另一个问题是，如果用户想要向他发送几封电子邮件，例如点击注册数次，会发生什么情况。他能一遍又一遍地这样做，并获得许多有效的 URL 吗？只有最后一个有效吗？或者也许相同的值会一遍又一遍地被重新发送？当然，如果一个匿名用户可以请求这封电子邮件，那么 DoS 可能会成为一个问题……更不用说如果他输入自己的电子邮件，他也可以输入任何随机地址，淹没一些可怜的 shmuck's收件箱并可能导致您的邮件服务器被列入黑名单...
没有一个正确答案，但需要在您的应用程序的上下文中考虑。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-02T05:45:05.690

1.  是的，2 ^(128)已经足够长了。
2.  不，GUID 实现旨在生成**唯一的**GUID，而不是随机的。您应该使用[加密安全](http://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator)的随机数生成器（例如[`RNGCryptoServiceProvider`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rngcryptoserviceprovider.aspx)）来生成 16 个随机字节并`Guid`用它初始化一个结构。
3.  是的，总体而言，这是一种可以接受的方法。两者都会起作用。
4.  是的，如果你不提供任何其他线索
5.  不，`goto 2`
6.  不，这还不错。您只需要使用加密安全的随机数生成器来生成 GUID。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T05:50:03.857

我建议只使用一个普通的随机数，例如来自[RNGCryptoServiceProvider.GetBytes](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rngcryptoserviceprovider.getbytes.aspx)的字节。GUID 并不意味着完全随机。它们具有固定位，并且某些版本使用您的 MAC 地址。GetBytes 还为您提供了使用超过 128 位的选项（尽管应该足够了）。

我认为最好不要将用户的数据放在 url 中。虽然 HTTPS 可以在传输过程中保护它，但它可能仍然存在于用户的浏览器历史记录等中。最好使用 POST 并将随机数与数据库的一行相关联。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-02T05:57:01.443

这可能有点矫枉过正，但您可以使用您的 guid（NewGuid 很好）作为[哈希盐，使用](http://en.wikipedia.org/wiki/Salt_(cryptography))[SHA1](http://msdn.microsoft.com/en-us/library/system.security.cryptography.sha1.aspx)对他们的电子邮件地址进行哈希处理，并将其放在 URL 中。然后，当他们到达您的页面时，您可以询问他们的电子邮件地址、检索 guid 并重新计算哈希以进行验证。即使有人知道要尝试哪些电子邮件地址，他们也永远无法在不知道您使用的 guid 的情况下产生哈希冲突（或者这将花费他们很长时间:)。当然，您必须将他们的电子邮件和哈希盐指南保存在数据库中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T05:55:45.033

首先，如果可能的话，您应该通过限制查询的吞吐量来限制暴力破解（例如，限制每秒每个 IP 的尝试次数，以及限制每秒总尝试次数）。

根据 GUID 生成算法，这可能不是一个好主意。虽然最近的实现应该“通常足够好”，但这些值可能有很多可预测性。最近在 .NET 中使用的实现应用了哈希，否则您可以清楚地识别 MAC 地址和启动时间的字段。但是，可能的值是有限的，因此您没有真正的 128 个随机位。

如果安全是重中之重，我会选择一个[加密强的随机数生成器](http://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator)，并构建一串随机字符。这也使得 oyu 独立于一个容易猜测的算法（因为 guid.ToString() 很容易被识别出来），在不久的将来可能会发现攻击。

如果满足这些条件，我认为在查询字符串中有键没有问题。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-03-05T17:28:22.793

在数据库中创建一个带有linkID 和Datesent 列的表，在生成链接时将DateTime.Now 插入表中并返回linkId，将linkID 设置为activationLink 上的查询字符串参数。在加载激活页面时检索linkId并使用它来调用一个存储过程，该存储过程将在将对应的linkId作为参数传递时返回日期，当您获取日期时，您可以添加您希望链接保持活动多长时间使用 .AddDays()/.AddMonths 这是日期时间的 C# 方法。然后将您返回的日期与今天的日期进行比较。如果它已经过了几天或几个月的长度，则给出错误消息，否则继续并显示页面内容。我建议您将页面的内容保留在面板中并将其设置为可见 =“false”，然后仅使面板可见 =“true”

# python - 与 Google App Engine 和 BigTable 的递归关系

> ID：938035
> 
> 赞同：5
> 
> 时间：2009-06-02T05:38:04.190
> 
> 标签：python, database-design, google-app-engine, bigtable

在经典的关系数据库中，我有下表：

```
CREATE TABLE Person(
    Id int IDENTITY(1,1) NOT NULL PRIMARY KEY,
    MotherId int NOT NULL REFERENCES Person(Id),
    FatherId int NOT NULL REFERENCES Person(Id),
    FirstName nvarchar(255)) 
```

我正在尝试将此表转换为 Google App Engine 表。我的问题是字段 MotherId 和 FatherId。我尝试了下面的代码，但没有机会。Python 说它不知道对象类型 Person。

```
class Person(db.Model):
    mother = db.ReferenceProperty(Person)
    father = db.ReferenceProperty(Person)
    firstName = db.StringProperty() 
```

有人知道我们如何在 Google App Engine 表中建模递归关系吗？我该如何解决 App Engine 的限制？

**更新** 我想稍微扩展一下问题......如果我想添加一组孩子怎么办？

```
children = db.SelfReferenceProperty(collection_name='children_set')
dad.children.append(childrenOne) 
```

我试过这个，但它不起作用。知道我做错了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-02T06:12:46.363

我认为你想要 SelfReferenceProperty 这里

```
class Person(db.Model):
    mother = db.SelfReferenceProperty(collection_name='mother_set')
    father = db.SelfReferenceProperty(collection_name='father_set')
    firstName = db.StringProperty() 
```

或者，您可以将母亲和父亲关系放在不同的类中。

# http - 您如何处理可以从 HTTP POST 发送的所有方式？

> ID：938037
> 
> 赞同：5
> 
> 时间：2009-06-02T05:38:10.133
> 
> 标签：http, post

想象一下，一个用户刚刚向您的 Web 应用程序发布了数据，而您想要重新显示当前页面并显示有关他们成功或失败的消息。这变得复杂了。

如果数据有效并且用户期待 html，您希望发出重定向，以便刷新不会导致他们重新发布。您想要重定向到引用者（如果存在）并显示一条消息。如果他们不期望 html，您可以简单地返回 200 OK。

如果数据无效并且用户期待 html，您希望重新渲染他们来自的页面，并显示一个可见的错误，以便他们可以重新发布。为此，您必须运行上一个操作，并使其知道错误消息。要确定哪个是先前的操作，也许您将其作为隐藏参数包含在表单中。如果他们不期望 html，您可以返回适用的 4xx 客户端错误。

我发现自己跳这种愚蠢的舞蹈太多次了。所以问题是：

1）您将如何抽象整个过程，以便任何表单帖子都可以利用它？

2) 在您最喜欢的 Web 框架中实现这一目标的最可维护或最少重复的方式是什么？

3) 有什么你会改变整个过程的东西，让它变得更简单吗？

想法 1：永远不要在帖子上渲染，总是重定向。在请求之间的一瞬间将错误数据填充到会话中，然后将其清除，就像成功消息一样。这样，可以以相同的方式处理有效和无效的帖子。

想法 2：不要做任何正常的 HTTP 帖子。只使用ajax。现在您根本不必担心渲染或重定向。这只有在你已经有一个 ajax-heavy 应用程序时才有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T05:45:29.607

想法 2 就在窗外。这是一个可怕的想法，根本没有必要。AJAX 很好，但不要过度使用。更不用说 - 禁用 Javascript 的那部分用户呢？

我认为您正在考虑（实际上并不知道）是[Post/Redirect/Get](http://en.wikipedia.org/wiki/Post/Redirect/Get)模式。这是最好的做法，你应该遵循它。基本上，正如您所说，您*永远不会*通过重定向以外的任何方式响应 POST。就通知而言，大多数情况下，由于特定操作，您*知道*它们来自哪里。如果你不这样做，HTTP REFERER 是一个不错的选择。是的，它可以被禁用，但如果那样的话，那是你用户的约 1%。至于通知，会话是完美的。只需将代码和消息存储在当前会话中，并让您的模板知道它们。如果消息存在，则打印出消息并删除会话变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T08:34:09.910

进行回发并不丢人，而且您不能真正避免回发，因为它是跨 HTTP 请求持久化数据的最简单方法。该或查询参数仍然是服务器的另一次往返，因此它相当于同一件事，但需要进行一些权衡。不建议使用查看状态或会话。

理想情况下，同一页面将检查请求是否是回发并处理其中的所有逻辑。因此，通常情况下，您的代码背后或带有表单的应用程序页面将有一个部分来处理回发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T01:49:14.607

在不需要 JavaScript 的情况下制作体面的 Web 应用程序是一项繁重的工作。我将在这些情况下使用 AJAX。

# algorithm - 没有除法运算符的处理器上的汇编 mod 算法

> ID：938038
> 
> 赞同：15
> 
> 时间：2009-06-02T05:40:12.453
> 
> 标签：algorithm, assembly, division

我需要实现一个简单的宏，在没有除法运算符的处理器上找到两个数字的模（想想 ARM）。我可以通过重复减法来使用除法，但我不知道这是否是最有效或最容易使用的。

有什么建议么？代码会更有帮助。这个特殊的类让我们使用 SPARC 的一个子集，所以大多数操作看起来像这样：`add r1, r2, rdest`.

这个特定的赋值要求检查`a mod b == 0`除法的余数是否为零。因此，任何有关有效实施的提示或建议都将受到欢迎。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-02T06:57:22.333

不知道你被限制在什么确切的操作，但我认为你会做长除法，像这样，在伪代码中：

```
dividend = abs(dividend)
divisor = abs(divisor)
if divisor == 0,
    barf
remainder = dividend
next_multiple = divisor

do
    multiple = next_multiple
    next_multiple = left_shift(multiple, 1)
while next_multiple <= remainder && next_multiple > multiple

while multiple >= divisor,
    if multiple <= remainder,
        remainder = remainder - multiple
    multiple = right_shift(multiple, 1) 
```

要实际计算商（或至少其绝对值），最后一部分将类似于：

```
quotient = 0
while multiple >= divisor,
    quotient = left_shift(quotient, 1);
    if multiple <= remainder,
        remainder = remainder - multiple
        quotient = quotient + 1
    multiple = right_shift(multiple, 1) 
```

这些都没有经过测试，并且可能充满了错误。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T05:57:53.487

我可以想到两种可能的方法。因为这是家庭作业，所以我将仅提及它们，并让您在可行的情况下工作以及如何实现它们：

1.  A/B = 2^(log2(A)-log2(b))：如果你能得到数值的对数，你就可以很接近除法。

2.  二进制长除法：你在做除法之前就学会了如何做十进制长除法，对吧？所以教你的计算机做二进制长除法（实际上二进制应该更容易）。

（编辑：更正 #1.，对数除法方程）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T06:06:18.947

这并不能直接回答您的问题，但仍然是一个有趣的案例。如果数字是由 2 的幂模取模，则操作可以执行为

```
x % 2^n = x & (2^n - 1) 
```

其中使用单个 AND 操作，**通常**是一个或两个循环操作。

更多信息[在维基百科](http://en.wikipedia.org/wiki/Modulo_operation#Performance_issues)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-02T06:09:33.717

似乎用 b 减去（或如果 a 为负数则添加）直到你达到或交叉 0 将是一个简单的实现，尽管几乎可以肯定不是最有效的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T05:47:39.803

Jweede，我不知道如何解决您的问题，但我在[这里](http://compilers.iecc.com/comparch/article/99-10-056)找到了一个看似相关的帖子。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T01:06:14.100

谢谢你的建议！

我开始使用简单的重复减法除法算法来实现这一点。但正如 ysth 所指出的，有一种更简单的方法。这是第一个算法：

```
 .macro mod a, b, r
        mov a, r
divlp:  sub r, b, r
        cmp r, b
        bge divlp
        .endmacro 
```

这非常类似于：

```
mod(a, b){
   int r = a
   while(r >= b){
      r = r - b
   }
   return r
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T02:43:59.630

A/B=Q，因此 A=B*Q。我们知道 A 和 B，我们想要 Q。

我的想法是：二分搜索 Q。从 Q=0 和 Q=1 开始，也许是基本情况。继续加倍直到 B * Q > A，然后你有两个边界（Q 和 Q/2），所以在这两个边界之间找到正确的 Q。O(log(A/B))，但实现起来有点棘手：

```
#include <stdio.h>
#include <limits.h>
#include <time.h>

// Signs were too much work.
// A helper for signs is easy from this func, too.
unsigned int div(unsigned int n, unsigned int d)
{
    unsigned int q_top, q_bottom, q_mid;
    if(d == 0)
    {
        // Ouch
        return 0;
    }

    q_top = 1;
    while(q_top * d < n && q_top < (1 << ((sizeof(unsigned int) << 3) - 1)))
    {
        q_top <<= 1;
    }
    if(q_top * d < n)
    {
        q_bottom = q_top;
        q_top = INT_MAX;
    }
    else if(q_top * d == n)
    {
        // Lucky.
        return q_top;
    }
    else
    {
        q_bottom = q_top >> 1;
    }

    while(q_top != q_bottom)
    {
        q_mid = q_bottom + ((q_top - q_bottom) >> 1);
        if(q_mid == q_bottom)
            break;

        if(d * q_mid == n)
            return q_mid;
        if(d * q_mid > n)
            q_top = q_mid;
        else
            q_bottom = q_mid;
    }
    return q_bottom;
}

int single_test(int n, int d)
{
    int a = div(n, d);
    printf("Single test: %u / %u = %u\n", n, d, n / d);
    printf(" --> %u\n", a);
    printf(" --> %s\n", a == n / d ? "PASSED" : "\x1b[1;31mFAILED\x1b[0m");
}

int main()
{
    unsigned int checked = 0;
    unsigned int n, d, a;

    single_test(1389797028, 347449257);
    single_test(887858028, 443929014);
    single_test(15, 5);
    single_test(16, 4);
    single_test(17, 4);
    single_test(0xFFFFFFFF, 1);

    srand(time(NULL));

    while(1)
    {
        n = rand();
        d = rand();

        if(d == 0)
            continue;

        a = div(n, d);
        if(n / d == a)
            ++checked;
        else
        {
            printf("\n");
            printf("DIVISION FAILED.\n");
            printf("%u / %u = %u, but we got %u.\n", n, d, n / d, a);
        }

        if((checked & 0xFFFF) == 0)
        {
            printf("\r\x1b[2K%u checked.", checked);
            fflush(stdout);
        }
    }

    return 0;
} 
```

此外，您还可以遍历位，将每个位设置为 1。如果 B * Q <= A 为真，则将该位保持为 1，否则将其置零。继续 MSB->LSB。（但是，您需要能够检测到 B*Q 会溢出。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-02-28T21:25:49.303

mod 可以逐位计算：

```
int r = 0;
int q = 0;
for (int i = sizeof(n) * 8 - 1; i >= 0; --i) {
  r <<= 1;
  r |= (n >> i) & 1;
  if (r > d) {
    r -= d;
    q |= 1 << i;
  }
}
return r; 
```

这给了你余数，q 将是商。如果您有 bsrl 指令，则可以为 i 设置更好的上限，因为您只能从最高有效位开始。

# c# - 在带有分组的列表上创建字典

> ID：938040
> 
> 赞同：111
> 
> 时间：2009-06-02T05:42:43.447
> 
> 标签：c#, .net, linq, .net-3.5

我在列表中有以下对象：

```
public class DemoClass
{
    public int GroupKey { get; set; }
    public string DemoString { get; set; }
    public object SomeOtherProperty { get; set; }
} 
```

现在，我想从中创建以下字典：

```
Dictionary<int, List<DemoClass>> 
```

我想`List<DemoClass>`按属性分组`GroupKey`，但我不明白这是如何完成的以及一些帮助。

经过一番思考，我实现了所需的行为：

```
var groupedDemoClasses = from demoClass in mySepcialVariableWhichIsAListOfDemoClass
                            group demoClass by demoClass.GroupKey
                            into groupedDemoClass
                            select groupedDemoClass;
var neededDictionary = groupedDemoClass.ToDictionary(gdc => gdc.Key, gdc => gdc.ToList()); 
```

但是，有没有办法把它变成一个单一的声明？

* * *

## 回答 #1

> 赞同：209
> 
> 时间：2009-06-02T06:11:34.523

只是为了使[mquander 的建议](https://stackoverflow.com/questions/938040/what-linq-statement-to-create-a-dictionary-on-a-list-with-group/938069#938069)具体：

```
var groupedDemoClasses = mySpecialVariableWhichIsAListOfDemoClass
                             .GroupBy(x => x.GroupKey)
                             .ToDictionary(gdc => gdc.Key, gdc => gdc.ToList()); 
```

如果你也使用更短的变量名，你会让它更短，当然:)

但是，我可以建议[查找](http://msdn.microsoft.com/en-us/library/bb460184.aspx)可能更合适吗？Lookup 基本上是一个从键到一个的字典`IEnumerable<T>`- 除非您真的*需要*将值作为列表，否则使用[ToLookup](http://msdn.microsoft.com/en-us/library/bb549073.aspx)调用可以使代码更短（并且更高效）：

```
var groupedDemoClasses = mySpecialVariableWhichIsAListOfDemoClass
                             .ToLookup(x => x.GroupKey); 
```

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2009-06-02T05:56:29.010

```
var groupedDemoClasses = (from demoClass in mySepcialVariableWhichIsAListOfDemoClass
                          group demoClass by demoClass.GroupKey
                          into groupedDemoClass
                          select groupedDemoClass).ToDictionary(gdc => gdc.Key, gdc => gdc.ToList()); 
```

这个会起作用的！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-02T05:56:00.760

你已经把它变成了单线。只需将 放在`ToDictionary`第一行的末尾即可。如果您希望它更短，请使用功能组合语法而不是查询语法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-07T13:42:48.503

我在这里*稍微*偏离主题，但我进入了这个线程，因为我正在寻找一种在 Linq 中创建字典的方法，这里的对话引导我找到答案......

您*可以*使用 linq 创建多级字典，这对于您有多个要搜索的键或维度的情况很有用。诀窍是创建一个分组，然后将其转换为字典，如下所示：

```
 Dim qry = (From acs In ActualSales _
             Group By acs.ProductID Into Group _
             Select ProductID, Months = Group.ToDictionary(Function(c) c.Period) _
            ).ToDictionary(Function(c) c.ProductID) 
```

生成的查询可以按如下方式使用：

```
 If qry.ContainsKey(_ProductID) Then
      With qry(_ProductID)
          If .Months.ContainsKey(_Period) Then
             ...
          End If
      End With
 End If 
```

希望这对需要此类查询的其他人有所帮助。

# git - 如何欺骗 git-svn 以识别使用 svn 进行的合并？

> ID：938041
> 
> 赞同：5
> 
> 时间：2009-06-02T05:44:38.640
> 
> 标签：git, merge, git-svn

我们有一个具有稳定主干和不稳定开发分支的 SVN 设置。开发工作（大部分）在分支上完成，然后在部署前合并到主干。

我使用 git-svn 作为我的 SVN 客户端。我从不稳定到主干的合并过程如下：

```
git svn fetch
git co -b trunk svn/trunk 
git merge --no-ff svn/unstable
git svn dcommit 
```

`svn/*`是远程 SVN 分支。

这当然要求在我完成之前没有人向主干提交任何内容，但这在实践中不是问题。

这个过程的好处是 git 现在将合并提交的父级记录在我的本地存储库中。这对我的同事没有好处，但它确实允许 git 在*我*进行合并时计算共同祖先。这是非常可取的。

这就是问题所在。当其他人进行合并时，git 不知道。这是一个例子：

```
 o-...-A---o---C--- unstable
 /
X--...--B---o---o--- stable 
```

不稳定分支是在 X 点创建的。在 A 点，我们决定将来自不稳定分支的更改合并到 B 点的稳定分支中。正确的共同祖先是 X。

由于合并未记录在 git 历史记录中，因此 C 处的以下合并再次假设 X 是共同祖先。我希望它是 A，如下图所示：

```
 o-...-A---o---C--- unstable
 /       \
X---...---B---o---o--- stable 
```

并非绝对有必要获得与图片完全相同的图表。任何可以将 A 识别为共同祖先的图表对我来说都很好。

我有一些选择，例如正确使用 git-filter-branch 或从未提交给 SVN 的“假”提交。然而，到目前为止，我的任何尝试都没有奏效。

我很感激你能提出任何想法。该过程不必是自动的。合并非常罕见，我可以忍受“手工”完成的痛苦。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T06:24:37.717

您的问题有点像SVN[从 git](https://stackoverflow.com/questions/714589/can-git-svn-correctly-populate-svnmergeinfo-properties)反向[填充`svnmergeinfo`](https://stackoverflow.com/questions/714589/can-git-svn-correctly-populate-svnmergeinfo-properties)
： 您不希望 SVN 记录来自 Git 的合并，但 Git 记录来自 SVN 的合并；）

由于从 SVN 导入时`git-svn`不关心`svnmergeinfo`属性，因此留下“手动操作”选项。

我不会推荐`git-filter-branch`在 Git 端重写历史的解决方案或任何东西。
如果您知道`A->B`SVN 上的“”合并，您应该在 Git ** 上的“合并”分支中进行该合并，然后将其合并回稳定分支（此时是微不足道的合并），从而添加一个新的致力于您当前的稳定历史。

```
 o-.....-A---o---C--- unstable
   /         \
  /           o-------\__ merge recorder branch
 /           /         \
X---.....---B---o---o---o__ stable 
```

然后从 C 到稳定的合并应该将 A 作为共同祖先。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-19T11:21:36.237

另一种选择是使用 Grafts 文件，它允许您在不实际操作历史记录的情况下覆盖提交的父项。

这意味着在 SVN 存储库中看到合并后，您只需在 .git/info/grafts 中添加一行，其中包含合并提交 (M) 及其父项 (A,B) 的 SHA-1。

```
 o-...-A---o---D--- unstable
     /       
    X-----B---M---o---o--- stable

A = 31423cd8a838f984547a908777308d846043cbda
B = d99cfccb1f859a8f1dbfac95eec75227fe518b23
M = 13319a54d3e3d61b501e7cc6474c46f37784aaa3 
```

为了从 AM 创建链接，您可以将 M 的父母指定为 B 和 A。grafts 文件的格式相当简单：

```
commit newparent1 ... newparentN 
```

这意味着您将以下（相当长的）行添加到您的移植文件中：

```
13319a54d3e3d61b501e7cc6474c46f37784aaa3 d99cfccb1f859a8f1dbfac95eec75227fe518b23 31423cd8a838f984547a908777308d846043cbda 
```

Git 现在会假装这个合并确实发生了。不利的一面是，这不会通过 git push/fetch/clone 传播，但这不应该是个人发展的主要问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-16T12:05:57.900

从 git 1.6.6 开始，这应该会自动发生。

" * "git svn" 学会了阅读 SVN 1.5+ 和 SVK 合并票证。"

在：

[http://www.kernel.org/pub/software/scm/git/docs/RelNotes/1.6.6.txt](http://www.kernel.org/pub/software/scm/git/docs/RelNotes/1.6.6.txt)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-22T18:42:55.450

小心移植文件。

1.  做错了， git gc 将（一段时间后）删除部分历史记录
2.  如果您推送到另一台主机，它不会知道移植物，并且最终可能会破坏历史。

# mysql - 如何让mysql接受外部连接

> ID：938047
> 
> 赞同：3
> 
> 时间：2009-06-02T05:46:23.067
> 
> 标签：mysql, mysql-management

我有一个 VPS，我想让 mysql DB 接受外部连接（例如来自我的 PC）。我在服务器上安装了 Debian Linux。我在网上查了一些教程，他们说要注释掉：

```
bind-address          = 127.0.0.1 
```

但这似乎没有帮助！VPS有什么特别的吗？还是我错过了其他东西？运行mysql的命令是：

```
/usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --user=mysql --pid-file=/var/run/mysqld/mysqld.pid --skip-external-locking --port=3306 --socket=/var/run/mysqld/mysqld.sock 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T06:10:32.200

MySQL 服务器必须配置为接受外部连接（根据需要绑定到正确的网络接口），并且其防火墙必须配置为允许该端口（TCP 端口 3306）上的传入连接。这可能在您安装 MySQL 时已设置，也可能尚未设置（如果您在 *nix 上，请参阅[iptables ）。](http://www.netfilter.org/projects/iptables/index.html)

您还必须在 MySQL 权限中考虑这一点，如下所示。

通常，在设置 MySQL 权限时，您只会为 @'localhost' 设置用户访问权限。您需要确保为您将要连接的适当主机名或 IP 地址设置了用户帐户及其授予的*权限*。例如，您可以创建一个新的授权用户：

```
GRANT ALL PRIVILEGES ON somedatabase.* TO someuser@'somehostname' IDENTIFIED BY 'password';
FLUSH PRIVILEGES; 
```

在远程连接到该服务器之前，您必须完成所有这些操作，使用类似这样的方法（本示例使用 PHP）：

```
mysql_connect('mysqlservername', 'someuser', 'password'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T06:09:20.020

您还必须将绑定地址更改为您的 VPS 机器的外部 ip（ipconfig 会有所帮助）。

并从您的 PC 授予访问权限。使用 root 权限从 localhost 连接到数据库并执行以下操作：

```
grant all privilege on *.* to `username`@`your-pc-id` identified by 'your-password' 
```

有关更多信息，请查看[MySQL 授权文档](http://dev.mysql.com/doc/refman/5.1/en/grant.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T05:59:37.117

您必须将 bind-address 设置为您机器的外部 IP 地址的值，而不是本地主机 IP 地址。之后不要忘记重新启动 MySQL 服务。

查看[这些其他答案](https://stackoverflow.com/questions/39882/mysql-bind-to-more-than-one-ip-address)以获取更多详细信息。

# c# - 检索 url 的隐藏 default.aspx 段

> ID：938049
> 
> 赞同：0
> 
> 时间：2009-06-02T05:47:17.230
> 
> 标签：c#, asp.net, http-status-code-404

我尝试使用 HttpRequest 的各种方法显示 url，我也尝试了 VirtualPathUtility 对象，但我从来没有能够显示默认的隐藏部分“default.aspx”......检索的方法或属性是什么这部分网址？

原因是，我非常接近在应用程序级别创建一个 404，它通过在 URL 的映射路径上使用 File.Exist() 来捕获所有 404，甚至是 html 页面，不幸的是，这在默认页面上不起作用。

我见过很少有文章试图做相反的事情，当它发生时删除 default.aspx，这里不是这种情况。

编辑：这是我正在尝试的：

```
string fullOrigionalpath = context.Request.CurrentExecutionFilePath.ToString();
bool newUrl = System.IO.File.Exists(context.Server.MapPath(fullOrigionalpath));
if (!newUrl) throw new HttpException(404,"page not found"); 
```

现在你看，如果页面是**localhost/lexus/default.aspx**，它可以正常工作，没有错误，但是如果我输入地址**[http://localhost/lexus/](http://localhost/lexus/)**，就会抛出错误，因为如果你尝试输出fullOriginalPath，它没有“default.aspx”部分，所以 Exists 返回 false！你有更好的方法来检查物理文件的有效性吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-02T22:10:10.173

我认为这根本不可能，所以我依靠 IIS7.0 重写功能来强制 default.aspx 始终出现..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T06:14:53.770

我不确定您所说的“隐藏部分”是什么意思，但您是否尝试过...

```
Request.Url.ToString() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T06:23:06.377

你正在寻找对象`AppRelativeCurrentExecutionFilePath`上的属性：http `HttpRequest`: [//msdn.microsoft.com/en-us/library/system.web.httprequest.apprelativecurrentexecutionfilepath.aspx](http://msdn.microsoft.com/en-us/library/system.web.httprequest.apprelativecurrentexecutionfilepath.aspx)

[如果有人向http://yourdomain.com/](http://yourdomain.com/)发出请求，`AppRelativeCurrentExecutionFilePath`则值为`"~/default.aspx"`

# c# - 拖放选项

> ID：938053
> 
> 赞同：0
> 
> 时间：2009-06-02T05:49:47.557
> 
> 标签：c#, drag-and-drop

我正在做一个简单的工具。如果我将 n 个文件拖放到我的表单中，它将自动打开相应的文件和文件夹。现在我想为`.lnk`文件（快捷方式）做这件事，如果我拖动一个`.lnk`文件，它必须打开目标文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T16:21:22.877

Okay this is a simple mock up but you should get the idea...

First add the **COM 'Windows Script Host Object Model'** reference to your project.

Next include the line...

```
using IWshRuntimeLibrary; 
```

For this example I just used a list box control but use what ever you want... If you handle the **DragEnter** event, you can get the file name passed as an argument. You can then create a **WshShell** object to get the links target path.

```
private void listBox1_DragEnter(object sender, DragEventArgs e)
{
    String[] fileName = (String[])e.Data.GetData("FileName");

    WshShell shell = new WshShell();
    IWshShortcut link = (IWshShortcut)shell.CreateShortcut(fileName[0]);

    String targetPath = link.TargetPath;

    listBox1.Items.Add(targetPath);
} 
```

The code doesn't handle non shortcuts etc but it should give you a starter... :)

# c# - C#：在 XML 中存储字节数组

> ID：938058
> 
> 赞同：21
> 
> 时间：2009-06-02T05:52:44.383
> 
> 标签：c#, .net, xml, bytearray

在 XML 中存储 Byte[] 数组的简单方法是什么（使用 C#）？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-06-02T05:54:45.020

用于`Convert.ToBase64String(byte[])`将其转换为 base 64 表示并存储结果字符串。

`byte[]`您可以通过调用`Convert.FromBase64String(string)`方法取回。

# java - Java 内存模型问题

> ID：938060
> 
> 赞同：2
> 
> 时间：2009-06-02T05:53:35.660
> 
> 标签：java, memory, model, io

我知道也许这个问题的答案是显而易见的。但如果有人能给我一个明确的答案，那将很有帮助。

问题是：java NIO 包是否可以提供一些内存一致性保证？

场景是：

```
Thread A                                                    Thread B
[modify Object X]                                        
[Send a request A over TCP by NIO]
                                              [receive response for request A over TCP by NIO]
                                              [read Object X] 
```

如果应用程序在线程 A 和线程 B 之间没有任何同步/安全引用消息，线程 A 所做的修改是否对线程 B 可见。

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T05:58:48.320

我的猜测是 TCP 请求并没有对线程同步做出任何正式的保证。

也就是说，我认为您提出的问题有一个简单的解决方案：假设 TCP 请求至少与获取锁一样昂贵（性能方面）是合理的。因此，您可以将发送/接收包含在同步块中，而不会显着降低性能。这将确保线程 B 在修改后可以看到对象 X。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T06:23:39.730

JMM*断然*不保证这种情况。除非两个线程**在同一个对象上**同步，否则两个线程之间没有“先发生”保证。因此，即使您可以证明 A 中 X 的更改实际上发生在*按时间顺序*读取 B 中的 X 之前，也不能保证 B 会*看到*所做的更改是 A 缺少对同一对象的同步。

CPU缓存在这里发挥作用；B 很可能会在 X 中看到陈旧的值，因为缓存还没有写回主内存。

您的代码可能适用于某些硬件配置，并且偶尔会在其他配置上失败。具有松散内存模型的 SMP 系统特别容易失败（想想 DEC Alpha）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T08:13:13.460

不。

不能保证。

您应该在 X 上同步以确保完整性。请注意，您应该避免在同步块中包含实际的发送和接收。

```
Thread A 
synchronize( X ) {                                               Thread B
    [modify Object X]
    [build request A using data from X]
}                                        
[Send a request A over TCP by NIO]

                                          [receive response for request A over TCP by NIO]
                                              [read Object X] // assuming from a synchronized database or collection.

                                          synchronize( x ) { 
                                              [handle the response]
                                          }
                                          [call methods in other objects] 
```

如果在线程 B 中处理响应，请使用 X 中的状态来确保您可以处理消息。

如果你需要调用系统的其他部分也使用这样的锁并且可以调用 X 中的方法，你必须做一些工作来确保你不会遇到死锁。例如，确保在调用其他对象之前可以释放锁。

# sharepoint - 从搜索中临时隐藏一些用户配置文件

> ID：938063
> 
> 赞同：0
> 
> 时间：2009-06-02T05:54:54.410
> 
> 标签：sharepoint, sharepoint-2007

我正在尝试找到一种方法来从人员搜索结果中临时隐藏 SharePoint 中的用户配置文件。

有哪些可能的解决方案？

我是否可以设置某种爬网规则以根据标志跳过某些用户配置文件？或者我可以锁定用户个人资料吗？

谢谢， Siriwat

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-08T06:32:28.380

Do not know what do you mean saying lock a use profile! I prefer the first one, just add crawl rule. It is not different at all.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-10T18:27:31.910

1.  您可以从导入源（AD、LDAP 等）中删除用户，然后重新抓取。那将删除他（尽管那比任何事情都更持久）
2.  根据您的 XSLT 有多好，[您可以编辑结果](http://msdn.microsoft.com/en-us/library/ms584121.aspx)，并且您应该能够输入一个查看用户名并显示除该用户之外的所有人的语句。
3.  您也可以以编程方式删除用户并重新抓取，但是，我很确定该用户将根据配置文件导入计划再次出现，您可以延迟隐藏该用户的时间。我会把代码放在这里，但 stackoverflows 编辑器绝对糟糕透顶。 [试一试这篇博文。](http://sridharu.blogspot.com/2008/03/delete-user-profile-programatically.html)

我个人推荐选项 2，因为您在那里拥有最多的控制权，不需要编译任何东西，也不需要乱搞 SSP。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-11T09:18:10.017

如果解决方案是临时的，则去编辑 XSL 模板，如果要永久删除用户，则添加爬网规则以排除特定用户。

对于删除单个用户，添加规则并重新抓取 AD 不会扩大对索引器的负担。

# python - 如何用正则表达式匹配一定长度的字符串

> ID：938065
> 
> 赞同：6
> 
> 时间：2009-06-02T05:55:06.220
> 
> 标签：python, regex

对于我的一个项目，我正在尝试实现 BitTorrent 协议的一小部分，可以在[这里](http://www.bittorrent.org/beps/bep_0003.html)找到。具体来说，我想使用它的“Bencoding”部分，这是一种安全编码数据以通过套接字传输的方法。格式如下：

```
8:a string => "a string"
i1234e => 1234
l1:a1:be => ['a', 'b']
d1:a1:b3:one3:twoe => {'a':'b', 'one':two} 
```

编码部分很容易，但解码变得相当麻烦。例如，如果我有一个字符串列表，我无法将它们分成单独的字符串。我尝试了几种不同的解决方案，包括[PyParsing](http://pyparsing.wikispaces.com/)和自定义令牌解析器。我目前正在尝试使用正则表达式，它似乎进展顺利，但我仍然挂断字符串问题。我目前的正则表达式是：

```
(?P<length>\d+):(?P<contents>.{\1}) 
```

但是，我似乎无法使用第一组作为第二组的长度。有什么好的方法可以做到这一点吗？还是我接近这一切都错了，答案就在我面前？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T06:27:52.657

您为此使用的任何解析器都需要是有状态的（即记住东西），而正则表达式大体上不是有状态的。他们是这项工作的错误工具。

如果这些是您唯一需要担心的数据类型，我想我只需为每种数据类型编写自定义解析器，在读取第一个字符后将控制权传递给适当的解析器。

~~我现在实际上会实施一个，但为时已晚。~~

**好吧，我决定写一个实现：**

```
from StringIO import StringIO
import string

inputs = ["10:a stringly",
         "i1234e" ,
         "l1:a1:be",
         "d1:a1:b3:one3:twoe"]

# Constants
DICT_TYPE = 'd'
LIST_TYPE = 'l'
INT_TYPE  = 'i'
TOKEN_EOF = ''
TOKEN_END = 'e'
COLON     = ':'

class BadTypeIndicatorException(Exception):pass

def read_int(stream):

   s = ""

   while True:
      ch = stream.read(1)
      if ch not in [TOKEN_EOF, TOKEN_END, COLON]:
         s += ch
      else:
         break

   return s

def tokenize(stream):

   s = ""

   while True:

      ch = stream.read(1)

      if ch == TOKEN_END or ch == TOKEN_EOF:
         return 

      if ch == COLON:
         length = int(s)
         yield stream.read(length)
         s = ""

      else:
         s += ch

def parse(stream):

   TYPE = stream.read(1)

   if TYPE in string.digits:
      length = int( TYPE + read_int(stream) )
      return stream.read(length)

   elif TYPE is INT_TYPE: 
      return int( read_int(stream) )

   elif TYPE is LIST_TYPE: 
      return list(tokenize(stream))

   elif TYPE is DICT_TYPE:
      tokens = list(tokenize(stream))
      return dict(zip(tokens[0::2], tokens[1::2]))

   else: 
      raise BadTypeIndicatorException

for input in inputs:
   stream = StringIO(input)
   print parse(stream) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T06:52:50.830

您需要分两步执行此操作。对于这样简单的解析问题，正则表达式实际上有点矫枉过正。这是我的做法：

```
def read_string(stream):
    pos = stream.index(':')
    length = int(stream[0:pos])
    string = stream[pos+1:pos+1+length]
    return string, stream[pos+1+length:] 
```

这是一种函数式的解析方式，它返回解析的值和流的其余部分。

对于列表，也许：

```
def read_list(stream):
    stream = stream[1:]
    result = []
    while stream[0] != 'e':
        obj, stream = read_object(stream)
        result.append(obj)
    stream = stream[1:]
    return result 
```

然后您将定义一个 read_object 来检查流的第一个字符并适当地分派。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T06:27:42.097

如果你解析字符串两次，你可以做到这一点。应用第一个正则表达式来获取长度。连接第二个正则表达式中的长度以形成有效的表达式。

不确定如何在 python 中完成，但 C# 中的示例是：

```
string regex = "^[A-Za-z0-9_]{1," + length + "}$" 
```

将 1 匹配到可以是字母数字或 _ 的长度的字符数，其中长度是从仅检索长度的先前正则表达式确定的。

希望这可以帮助 ：）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T12:32:02.377

伪代码，没有语法检查：

```
define read-integer (stream):
    let number 0, sign 1:
        if string-equal ('-', (c <- read-char (stream))):
            sign <- -1
          else:
            number <- parse-integer (c)
        while number? (c <- read-char (stream)):
            number <- (number * 10) + parse-integer (c)
        return sign * number

define bdecode-string (stream):
    let count read-integer (stream):
        return read-n-chars (stream, count)

define bdecode-integer (stream):
    ignore read-char (stream)
    return read-integer (stream)

define bdecode-list (stream):
    ignore read-char (stream)
    let list []:
        while not string-equal ('e', peek-char (stream)):
            append (list, bdecode (stream))
        return list

define bdecode-dictionary (stream):
    let list bdecode-list stream:
        return dictionarify (list)

define bdecode (stream):
    case peek-char (stream):
        number? => bdecode-string (stream)
        'i' => bdecode-integer (stream)
        'l' => bdecode-list (stream)
        'd' => bdecode-dictionary (stream) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T06:51:32.173

您使用了错误的工具来完成这项工作......这需要某种状态保持，一般来说，正则表达式是无状态的。

* * *

我在 PERL 中执行的 bdecoding（和 bencoding）的示例实现可以在[这里](http://perlmonks.com/?node_id=461506)找到。

对该功能如何工作的解释（因为我从来没有评论过它[哎呀]）：

基本上你需要做的是设置一个递归函数。这个函数接受一个字符串引用（因此它可以被修改）并返回“某物”（这意味着它可以是一个数组、一个哈希表、一个 int 或一个字符串）。

该函数本身只是检查字符串中的第一个字符并据此决定要做什么：

*   如果是 an `i`，则解析出**i**和第一个**e**之间的所有文本，并尝试根据允许的规则将其解析为 int 。
*   如果它是一个数字，则读取直到**:**的所有数字，然后从字符串中读取那么多字符。

列表和字典是事情开始变得有趣的地方......如果有**l**或**d**作为第一个字符，那么您需要去掉`l`/ `d`，然后将当前字符串传递回函数，以便它可以开始解析列表或字典中的元素。然后只需将返回的值存储在适当结构中的适当位置，直到您点击**`e`**，并返回您留下的结构。

请记住，我实现它的功能是破坏性的。当函数返回时传入的字符串是空的，因为它是通过引用传递的，或者更准确地说，它将没有任何它解析和返回的内容（这就是它可以递归使用的原因：任何它不处理的东西都会留下未触及）。但是，在大多数初始调用的情况下，除非您一直在做一些奇怪的事情，否则这应该会处理所有事情，因此上述情况成立。

# php - cli或mod_php中的phpinfo函数有什么区别？

> ID：938077
> 
> 赞同：0
> 
> 时间：2009-06-02T05:58:02.550
> 
> 标签：php

我认为一个叫做 phpinfo 的函数是一个显示 PHP 环境的函数，但是我在 Web 服务器上显示它的 phpinfo 的结果是我从命令行执行的 phpinfo 的结果是不同的。为什么这些会有所不同？我想成为同样的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T06:28:52.500

从您的网络服务器调用的 PHP 的配置可能与您的命令行 PHP 非常不同。

这取决于您的网络服务器设置。如果您的网络服务器只是调用您的`/usr/local/bin/php`（或类似的）二进制文件，那么您将获得几乎相同的输出（除了没有任何 CGI 环境变量，例如 HTTP_HOST、REFERRER 等。

另一方面，如果您`mod_php`通过 fast-cgi 与 apache 或 php 一起使用，您的 phpinfo 将返回不同的值，就像`mod_php`为 php 单独编译的模块一样。它不会调用`php`您通过命令行访问的标准命令。

造成差异的另一个可能原因是您的网络服务器使用了不同的`php.ini`文件。该`php.ini`文件告诉php要加载哪些扩展，并且基本上可以设置`phpinfo()`页面上的大部分参数。

很难获得相同的结果，除非您可以将网络服务器配置为不将任何 HTTP 标头发送到您的 PHP 脚本，并确保您的网络服务器的 php 设置匹配（或直接调用）您的命令行 php 构建。您可以确保 php.ini 文件相同——`phpinfo()`包含当前加载的配置文件的名称。

我认为无论如何您都无法使它们相同，而且我不明白您为什么希望输出相同。如果您希望设置相似，您将需要编辑相应的`php.ini`文件以将设置更改为您希望的设置。此外，如果您无权访问该`php.ini`文件，您可以使用 php 函数[`ini_set()`](http://us2.php.net/manual/en/function.ini-set.php)在运行时设置一些配置变量。

# php - 在 Flex 中将代码转换为数组.....

> ID：938078
> 
> 赞同：0
> 
> 时间：2009-06-02T05:58:10.897
> 
> 标签：php, apache-flex

```
$output = "<loginsuccess>";

while( $Row = mysql_fetch_object( $result ) )
{

$output .="<keyword>".$_POST['keyword']."</keyword><name>".$row['url']."</name><occur>".$row['occurrences']."</occur><queryTime>".(substr($end_time-$start_time,0,5))."</queryTime>";
}

$output .= "</loginsuccess>"; 
```

这是我的 PHP 输出，如何在 Flex 中将这段代码转换为数组。这是我通过 event.result.loginsucess 在 flex 中读取的输出，但希望该输出作为数组存在。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T12:02:15.260

您需要将 HTTPService 标记中的 resultFormat 属性设置为“object” - 请参阅：[Converting xml to objects using the flex httpservice mxml tag](http://blog.flexexamples.com/2007/09/19/converting-xml-to-objects-using-the-flex-httpservice-mxml-tag/)

# html - 为什么浏览器会在表格元素中插入 tbody 元素？

> ID：938083
> 
> 赞同：66
> 
> 时间：2009-06-02T06:00:05.587
> 
> 标签：html, xhtml

我正在使用原始 html 和 JQuery 玩一些想法。我做的一件事是创建一个包含一组行的表格元素。

```
<table id="MyTable" >
    <tr>
        <td>Title</td>
    </tr>
    <tr>
        <td>1</td>
    </tr>
    <tr>
        <td>2</td>
    </tr>
    <tr>
        <td>3</td>
    </tr>
    <tr>
        <td>4</td>
    </tr>
</table> 
```

但是当我在 FireFox+Firebug、IE8 开发工具栏或 Google Chrome JavaScript 调试器中查看代码时……所有这些都显示有一个**tbody**元素围绕所有**tr**节点。

我不反对这种情况……但这是标准行为吗？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-06-02T06:24:31.337

[http://htmlhelp.com/reference/html40/tables/tbody.html](http://htmlhelp.com/reference/html40/tables/tbody.html)：

> TBODY 元素定义表中的一组数据行。一个 TABLE 必须有一个或多个 TBODY 元素，这些元素必须跟在可选的 TFOOT 之后。TBODY 结束标签始终是可选的。当表只包含一个 TBODY 而没有 THEAD 或 TFOOT 时，开始标记是可选的。

所以那里总是有一个 tbody （尽管有时开始和结束标签都是可选的和省略的），并且您使用的工具在向您展示它时是正确的。

另一方面，thead 或 tfoot 永远不会出现，除非您明确包含它们，并且如果您这样做，则 tbody(s) 也必须是明确的。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-02T06:02:12.247

是的，tbody 是表示表格主体的标准元素。不需要将其放入标记中，但正如您所见，它将包含在 DOM 中。

# visual-c++ - typedef void(*ptr)(argumentlist) 问题

> ID：938087
> 
> 赞同：0
> 
> 时间：2009-06-02T06:02:11.997
> 
> 标签：visual-c++

如何向/从此函数指针传递或获取参数值：

```
typedef void(*  CreateCursorBitmapProc )(uchar *bitmapBuffer, uint32 *width, uint32 *height, bool16 *hasAlpha) 
```

bitmapBuffer、width、height、hasalpha 是输出参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T06:10:40.017

```
// Grab an instance from somewhere...
CreateCursorBitmapProc instance = ...;

// Declare output variables
// should be initialized to some buffer, probably
uchar *bitmapBuffer = new uchar[size_of_buffer]; 
uint32 width, height;
bool16 hasAlpha;
(*instance)(bitmapBuffer, &width, &height, &hasAlpha); 
```

# string - NSString 中一个字符的出现次数

> ID：938095
> 
> 赞同：39
> 
> 时间：2009-06-02T06:06:25.080
> 
> 标签：string, cocoa, cocoa-touch, nsstring, character

我有一个`NSString`or`NSMutableString`并且想要获取特定字符的出现次数。

我需要为相当多的字符（在这种情况下为大写英文字符）执行此操作，所以它会很快。

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2011-03-10T11:56:20.587

您可以在一行中完成此操作。例如，这会计算空格数：

```
NSUInteger numberOfOccurrences = [[yourString componentsSeparatedByString:@" "] count] - 1; 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-04-11T11:07:56.353

在 NSString 上试试这个类别：

```
@implementation NSString (OccurrenceCount)

- (NSUInteger)occurrenceCountOfCharacter:(UniChar)character
{
    CFStringRef selfAsCFStr = (__bridge CFStringRef)self;

    CFStringInlineBuffer inlineBuffer;
    CFIndex length = CFStringGetLength(selfAsCFStr);
    CFStringInitInlineBuffer(selfAsCFStr, &inlineBuffer, CFRangeMake(0, length));

    NSUInteger counter = 0;

    for (CFIndex i = 0; i < length; i++) {
        UniChar c = CFStringGetCharacterFromInlineBuffer(&inlineBuffer, i);
        if (c == character) counter += 1;
    }

    return counter;
}

@end 
```

这比该`componentsSeparatedByString:`方法快大约 5 倍。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-06-02T07:49:02.730

[`replaceOccurrencesOfString:withString:options:range:`](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSMutableString_Class/index.html#//apple_ref/occ/instm/NSMutableString/replaceOccurrencesOfString:withString:options:range:)将返回在 a 中替换的字符数`NSMutableString`。

```
[string replaceOccurrencesOfString:@"A" 
                        withString:@"B" 
                           options:NSLiteralSearch 
                             range:NSMakeRange(0, [receiver length])]; 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-02T12:59:08.440

每当您在 a 中寻找东西时`NSString`，请先尝试使用`NSScanner`。

```
NSString *yourString = @"ABCCDEDRFFED"; // For example
NSScanner *scanner = [NSScanner scannerWithString:yourString];

NSCharacterSet *charactersToCount = [NSCharacterSet characterSetWithCharactersInString:@"C"]; // For example
NSString *charactersFromString;

if (!([scanner scanCharactersFromSet:charactersToCount 
                          intoString:&charactersFromString])) {
    // No characters found
    NSLog(@"No characters found");
}

// should return 2 for this
NSInteger characterCount = [charactersFromString length]; 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-09-28T18:24:37.653

现在我想到的第一件事就是：[NSCountedSet](https://developer.apple.com/documentation/foundation/nscountedset?language=objc)

```
NSString *string = @"AAATTC";

NSMutableArray *array = [NSMutableArray array];

[string enumerateSubstringsInRange:NSMakeRange(0, [string length]) options:NSStringEnumerationByComposedCharacterSequences usingBlock:^(NSString *substring, NSRange substringRange, NSRange enclosingRange, BOOL *stop) {
    [array addObject:substring];
}] ;
NSCountedSet * set = [[NSCountedSet alloc] initWithArray:array];

for (NSString *nucleobase in @[@"C", @"G", @"A", @"T"]){
    NSUInteger count = [set countForObject:nucleobase];
    NSLog(@"%@: %lu", nucleobase, (unsigned long)count);
} 
```

日志：

```
C: 1
G: 0
A: 3
T: 2 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-09-10T10:54:31.530

不同 Objective-C 解决方案的性能比较。

假设以下所有方法都是 NSString 扩展（内部`@implementation NSString (CountOfOccurrences)`）。

作为示例，我使用了一个随机生成的长度为 100000000 的字符串，其中使用了所有拉丁字符（`CharacterSet(charactersIn: "\u{0020}"..."\u{036F}")`在 Swift 中）。而要数的字符是`@"a"`。

在 Xcode 10.3 上以发布配置在模拟器上执行的测试。

# 快速解决方案（精确的逐个字符等效）

计算一个字符有两种方法：使用[`NSLiteralSearch`](https://developer.apple.com/documentation/foundation/nsstringcompareoptions/nsliteralsearch?language=objc)或不使用。计数会有所不同，性能会受到根本影响。为了获得最快的结果，我们将执行精确的逐个字符等效。以下四种解决方案给出了非常接近的性能结果。

### 1.最快的解决方案：CynicismRising答案的改编。

使用[`replaceOccurrencesOfString:withString:options:range:`](https://developer.apple.com/documentation/foundation/nsmutablestring/1412453-replaceoccurrencesofstring?language=objc). 这是所有场景中最快的解决方案：即使您替换`NSLiteralSearch`为`kNilOptions`，您仍然比 pierrot3887 扫描仪解决方案更快。

```
- (NSUInteger)countOccurrencesOfString:(NSString *)stringToFind
{
    return [[NSMutableString stringWithString:self] replaceOccurrencesOfString:stringToFind
                                                                    withString:stringToFind
                                                                       options:NSLiteralSearch
                                                                         range:NSMakeRange(0, self.length)];
} 
```

### 2.第二快，CynicismRising 答案的另一个改编。

使用[`stringByReplacingOccurrencesOfString:withString:options:range:`](https://developer.apple.com/documentation/foundation/nsstring/1416484-stringbyreplacingoccurrencesofst?language=objc).

```
- (NSUInteger)countOccurrencesOfString:(NSString *)stringToFind
{
    NSString *strippedString = [self stringByReplacingOccurrencesOfString:stringToFind
                                                               withString:@""
                                                                  options:NSLiteralSearch
                                                                    range:NSMakeRange(0, self.length)];
    return (self.length - strippedString.length) / stringToFind.length;
} 
```

### 3\. 第三快，雅克解。

使用[`CFStringGetCharacterFromInlineBuffer`](https://developer.apple.com/documentation/corefoundation/1542834-cfstringgetcharacterfrominlinebu?language=objc). 请参阅[https://stackoverflow.com/a/15947190/1033581](https://stackoverflow.com/a/15947190/1033581)。

### 4\. 第四快，将[我的 Swift 答案](https://stackoverflow.com/a/45073012/1033581)转换为 Objective-C。

使用[`rangeOfString:options:range:`](https://developer.apple.com/documentation/foundation/nsstring/1415073-rangeofstring?language=objc).

```
- (NSUInteger)countOccurrencesOfString:(NSString *)stringToFind
{
    //assert(stringToFind.length);
    NSUInteger count = 0;
    NSRange searchRange = NSMakeRange(0, self.length);
    NSRange foundRange;
    while ((void)(foundRange = [self rangeOfString:stringToFind options:NSLiteralSearch range:searchRange]), foundRange.length) {
        count += 1;
        NSUInteger loc = NSMaxRange(foundRange);
        searchRange = NSMakeRange(loc, self.length - loc);
    }
    return count;
} 
```

# 缓慢的解决方案

以下解决方案不使用`NSLiteralSearch`也不执行精确的逐个字符等效。前两个可能比快速解决方案慢 10 倍，最后一个可能慢 100 倍。

### 5.慢解决：pierrot3887答案的改编

使用[`scanUpToString:intoString:`](https://developer.apple.com/documentation/foundation/nsscanner/1411971-scanuptostring?language=objc). 太糟糕了，`NSScanner`它没有提供精确的逐个字符等效的选项。

```
- (NSUInteger)countOccurrencesOfString:(NSString *)stringToFind
{
    NSScanner *scanner = [NSScanner scannerWithString:self];
    scanner.charactersToBeSkipped = nil;
    scanner.caseSensitive = YES;
    NSUInteger numberOfOccurrences = 0;
    while (!scanner.isAtEnd) {
        [scanner scanUpToString:stringToFind intoString:nil];
        if (!scanner.isAtEnd) {
            numberOfOccurrences++;
            [scanner scanString:stringToFind intoString:nil];
        }
    }
    return numberOfOccurrences;
} 
```

### 6.较慢的解决方案：gbaor解决方案

使用[`componentsSeparatedByString:`](https://developer.apple.com/documentation/foundation/nsstring/1413214-componentsseparatedbystring?language=objc). 关于 doable in one line 的论点，请注意上面给出的最快解决方案也是 one liner。

```
- (NSUInteger)countOccurrencesOfString:(NSString *)stringToFind
{
    return [self componentsSeparatedByString:stringToFind].count - 1;
} 
```

### 7.最慢的解决方案：vikingosegundo answer的改编

使用[`enumerateSubstringsInRange:options:usingBlock:`](https://developer.apple.com/documentation/foundation/nsstring/1416774-enumeratesubstringsinrange?language=objc).

```
- (NSUInteger)countOccurrencesOfCharacter:(NSString *)characterToFind
{
    __block NSUInteger counter = 0;
    [self enumerateSubstringsInRange:NSMakeRange(0, self.length) options:NSStringEnumerationByComposedCharacterSequences usingBlock:^(NSString *substring, NSRange substringRange, NSRange enclosingRange, BOOL *stop) {
        if ([characterToFind isEqualToString:substring]) counter += 1;
    }];
    return counter;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-04-08T15:56:52.737

您的解决方案对我不起作用，我在循环中添加了一个条件，仅当 mainScanner 已到达字符串末尾时才增加 numberOfChar ：

```
NSString *yourString = @"ABCCDEDRFFED"; // For example
NSScanner *mainScanner = [NSScanner scannerWithString:yourString];
NSString *temp;
NSInteger numberOfChar=0;
while(![mainScanner isAtEnd])
{
   [mainScanner scanUpToString:@"C" intoString:&temp];
   if(![mainScanner isAtEnd]) {
      numberOfChar++;
      [mainScanner scanString:@"C" intoString:nil];
   }
} 
```

请注意，这是一个快速修复，我没有时间做出优雅的解决方案......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-02T06:14:25.940

我可能会使用

`NSString rangeOfCharacterFromSet:`

或者

`rangeOfCharacterFromSet:options:range::`

其中 set 是您要搜索的字符集。它返回与集合匹配的第一个字符的位置。保留数组或字典并增加字符计数，然后重复。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-01-15T11:39:37.767

扫描仪的示例在 iPhone 上崩溃。我找到了这个解决方案：

```
NSString *yourString = @"ABCCDEDRFFED"; // For example
NSScanner *mainScanner = [NSScanner scannerWithString:yourString];
NSString *temp;
NSInteger numberOfChar=0;
while(![mainScanner isAtEnd])
{
   [mainScanner scanUpToString:@"C" intoString:&temp];
   numberOfChar++;
   [mainScanner scanString:@"C" intoString:nil];
} 
```

它对我有用，没有崩溃。希望它可以帮助！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-08-30T15:18:29.530

**这是一个用于 NSRange、Range、String 和 NSString 的 Swift 3 工作版本！享受 ：）**

```
/// All ranges using NSString and NSRange
/// Is usually used together with NSAttributedString

extension NSString {
    public func ranges(of searchString: String, options: CompareOptions = .literal, searchRange: NSRange? = nil) -> [NSRange] {
        let searchRange = searchRange ?? NSRange(location: 0, length: self.length)
        let subRange = range(of: searchString, options: options, range: searchRange)
        if subRange.location != NSNotFound {

            let nextRangeStart = subRange.location + subRange.length
            let nextRange = NSRange(location: nextRangeStart, length: searchRange.location + searchRange.length - nextRangeStart)
            return [subRange] + ranges(of: searchString, options: options, searchRange: nextRange)
        } else {
            return []
        }
    }
}

/// All ranges using String and Range<Index>
/// Is usually used together with NSAttributedString

extension String {
    public func ranges(of searchString: String, options: CompareOptions = [], searchRange: Range<Index>? = nil ) -> [Range<Index>] {
        if let range = range(of: searchString, options: options, range: searchRange, locale: nil) {

            let nextRange = range.upperBound..<(searchRange?.upperBound ?? endIndex)
            return [range] + ranges(of: searchString, searchRange: nextRange)
        } else {
            return []
        }
    }
} 
```

# php - 正则表达式中的波浪号运算符

> ID：938100
> 
> 赞同：57
> 
> 时间：2009-06-02T06:10:10.237
> 
> 标签：php, regex, pcre

我想知道正则表达式中波浪号运算符的含义是什么。

我有这样的声明：

```
if (!preg_match('~^\d{10}$~', $_POST['isbn'])) {
    $warnings[] = 'ISBN should be 10 digits';
} 
```

我发现这个文档解释了波浪号的含义：[`~`](http://en.allexperts.com/q/Perl-CGI-1045/2008/9/perl-Regular-Expression-usage.htm)

它说这`=~`是一个 perl 运算符，表示针对这个正则表达式运行这个变量。

但是为什么我的正则表达式包含两个波浪号运算符？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-06-02T06:15:17.047

在这种情况下，它只是用作分隔符。

通常，在 PHP 中，正则表达式的第一个和最后一个字符是“分隔符”，用于标记匹配部分的开始和结束位置（如果您想在末尾添加修饰符，例如 ungreedy 等）

通常，PHP 从字符串中的第一个字符开始计算，这意味着正则表达式，匹配它的第二次出现作为第二个分隔符。这在文本中出现正常分隔符的情况下很有用（例如，文本中出现 of `/`） - 这意味着您不必做尴尬的事情。

匹配“ `//`”，分隔符设置为“ `/`”

> `/\/\//`

`//`用“ ”分隔符匹配“ `#`”

> `#//#`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-02T06:18:05.963

在这种情况下，它没有任何意义。它只是划定模式的开始和结束。在 PCRE（Perl 兼容的正则表达式）中，这是您在 PHP 中与 preg_* 一起使用的，模式与表达式选项一起输入，如下所示：

```
preg_match("/pattern/opt", ...); 
```

但是，在这种情况下使用“/”作为分隔符是任意的——尽管正斜杠很流行，但它可以用任何东西代替。在你的情况下，它是波浪号。

# xml - 如何将每个 XML 行读入指定的字符串？

> ID：938112
> 
> 赞同：0
> 
> 时间：2009-06-02T06:15:13.347
> 
> 标签：xml, vb.net

我正在尝试创建一个 VB.net 应用程序，该应用程序从 XML 文件（或 ini 文件，无关紧要）读取每一行，这决定了字符串的名称应该是什么。

例如

```
"string1 = xml.line1"
"string2 = xml.line2" 
```

ETC

这样做的最佳方法是什么？我已经对 Xml.XmlTextReader 进行了一些尝试，它似乎可以完成这项工作，但是我无法将每一行都分解为自己的字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T06:26:42.470

在 XML 文档中，行很少是有用的概念。例如：

```
<foo>
    <bar first="x"
         second="y" />
</foo> 
```

相当于

```
<foo>
    <bar first="x" second="y" />
</foo> 
```

通常，您会在 XML 文档中查询单个*元素*而不是行。然而，在 .ini 文件中的一行会更合理。

这里的大局是什么？你想达到什么目的？

如果您需要读取文本文件的所有行（但您不需要一次将它们全部存储在内存中），我建议您使用`File.OpenText`which 返回 a `TextReader`，然后调用`ReadLine()`并处理字符串，直到返回的行是`Nothing`(这意味着您已经到达文件的末尾）。不要忘记将读者包装在一个`Using`声明中。

编辑：如果您不需要文件中的任何其他内容，那么我只需每行写一个条目，您基本上就完成了。另一方面，这意味着如果您需要任何其他配置信息，则需要更改所有内容。

使用 ini 文件相当简单，但您必须编写代码来解析它。（诚​​然，可能有 3rd 方库可以为你做这件事。我在以前的公司写过一个，并没有花很长时间。）

使用 XML 文件会在值周围引入更多“绒毛”，但阅读起来会非常简单，尤其是在使用 .NET 3.5 和 LINQ to XML 时。例如，您可以有这样的文件：

```
<Configuration>
    <RegistryEntries>
         <RegistryEntry>First</RegistryEntry>
         <RegistryEntry>Second</RegistryEntry>
         <RegistryEntry>Third</RegistryEntry>
    </RegistryEntries>
</Configuration> 
```

并通过执行以下操作获取条目序列：

```
document.Root.Element("RegistryEntries")
             .Elements("RegistryEntry")
             .Select(e => e.Value); 
```

As yet another alternative, you could use the built-in configuration/settings features of .NET. Have you tried using the "Settings" part of project properties?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T06:17:52.720

如果您正在逐行处理 XML 并希望忽略 XML 语义，则应将其视为纯文本文件并在每一行上运行正则表达式或其他内容：

```
Dim lines = File.GetAllLines("file.xml")
' Check the lines (which is a String array) for the criteria 
```

# multithreading - Spring-AOP 和多线程

> ID：938114
> 
> 赞同：2
> 
> 时间：2009-06-02T06:15:17.357
> 
> 标签：multithreading, spring-aop

我在对我的应用程序进行多线程处理时遇到问题。似乎 AOP 无法跨越多个线程，即我无法在单个事务中执行所有线程。每个线程在处理时更新数据库。我正在使用fixedThreadPool 和ExecutorCompletionService。这是春天的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T14:01:24.677

一种可能的解决方案是使用 JMS，但它可能不是最简单的设置。您可以发送多个并行处理的消息，并且它们可以共享相同的事务上下文。

# sql - SQL 按问题分组

> ID：938115
> 
> 赞同：5
> 
> 时间：2009-06-02T06:15:22.257
> 
> 标签：sql, mysql, group-by

我有一个查询，它执行了许多连接，并且在 WHERE 子句中有一些条件，我最终得到的结果基本上如下所示：

```
| userId |       date |  otherData |
|--------+------------+------------|
|      1 | 2008-01-01 |  different |
|      1 | 2009-01-01 |       info |
|      1 | 2010-01-01 |        for |
|      2 | 2008-01-01 |       each |
|      3 | 2008-01-01 |        row |
|      3 | 2009-01-01 |       here | 
```

因此，本质上对于每个用户来说，过去会有一个或多个日期，未来会有 0 个或多个日期。

我需要以某种方式将数据集减少到每个用户一行，**只选择最近通过的行 date**。也就是说，无论添加什么魔法`GROUP BY`或`HAVING`子句，上面的结果将如下所示：

```
| userId |       date |  otherData |
|--------+------------+------------|
|      1 | 2009-01-01 |       info |
|      2 | 2008-01-01 |       each |
|      3 | 2009-01-01 |       here | 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T06:23:53.023

我认为您不想使用 GROUP BY / HAVING 因为您对每个用户恰好有 1 行感兴趣，并且该行已按原样存在于表中。这需要 WHERE 子句而不是 GROUP BY / HAVING。

我的建议是在 WHERE 子句中添加一个条件，即日期必须等于子查询的结果。该子查询应该：

1.  选择最大值（日期）
2.  有一个 WHERE 子句将日期限制为小于 NOW
3.  有一个用户 ID 等于外部查询的用户 ID 的 WHERE 子句

为了防止某个用户可以有两个条目具有相同的日期，这也是最大“通过”日期，您还应该添加 DISTINCT。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T06:29:49.143

像这样：

```
select a.userId, a.date, b.userId, b.otherData
from table1 as a 
left outer join table2 as b on a.userId = b.userId
where b.Id in (
    select top 1 Id from table2 as c where c.userId = a.userId) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T06:30:51.997

```
选择
  用户 ID、日期、其他数据
从
  你的表 t1
在哪里
  日期 =
    （从 yourTable t2 中选择 max(date)
     其中 t1.userID=t2.userID)

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T06:31:21.637

```
select T.userid, T.date, T.otherdata 
from 
    T, 
    (select userid, max(date) max_date from T group by userid) GT
where 
    T.userid = GT.userid and T.date = GT.max_date 
```

说明：内部选择 - 只为每个用户分离具有最大日期的记录。整个选择 - 将 izolated 记录与原始表连接，以获取 otherdata 字段。

我假设一个用户 ID 只有一个最大日期。请说这是否是正确的假设。

# vb.net - 将 CRLF 热键分配给按钮的推荐方法是什么

> ID：938116
> 
> 赞同：0
> 
> 时间：2009-06-02T06:15:41.070
> 
> 标签：vb.net

将 CRLF 热键分配给按钮的最佳方法是什么？在 delphi 中它可以设置为默认值，但是在 VB 中它是如何完成的呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T06:24:17.077

您将按钮分配给表单的 .AcceptButton 属性。

# java - Java代码中的最长路径

> ID：938121
> 
> 赞同：-1
> 
> 时间：2009-06-02T06:18:06.247
> 
> 标签：java, path, graph

我想在给定的 Java 代码中获得最长的路径。此代码可能以图表的形式出现。是否有任何获取此信息的开源工具/ API？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-07T01:29:24.157

[http://en.wikipedia.org/wiki/Bellman-Ford_algorithm](http://en.wikipedia.org/wiki/Bellman-Ford_algorithm)

只需将权重设为负数；并且不允许任何循环中所有顶点之和为负的循环（这将表示不定式循环）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T06:27:31.800

如，最长的执行路径？

这似乎并不容易实现。您当然可以将 Java 字节码“解码”为“Java 程序集”（它的正确名称是什么？），并根据代码中的分支创建一个图形。

问题是您的图表几乎肯定会有循环，并且您的最长路径将是无限的，除非您开始模拟执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T06:26:24.250

要找到最长的路径，您可以考虑所有可能的路径并采取最长的路径。注意：如果你有一个循环，这将是无限的。

顺便说一句：通常人们试图找到最短的路径。

# asp.net - 如何从 VB.net 进行简单的 SQL 查询（访问数据库）

> ID：938124
> 
> 赞同：0
> 
> 时间：2009-06-02T06:19:07.977
> 
> 标签：asp.net, vb.net

我的项目中已经有一个工作数据集和数据网格，但我想制作自己的快速搜索按钮。以下代码给出了连接字符串 PROVIDER KEYWORD NOT SUPPORTED 的错误

```
connetionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=|DataDirectory|\prod.mdb"

sql = "Select (*) from table1 where prodid=" + searchfield.Text

cnn = New SqlConnection(connetionString)
Try
    cnn.Open()
    cmd = New SqlCommand(sql, cnn)
    Dim ret = (cmd.ExecuteScalar())
    cmd.Dispose()
    cnn.Close()
    Text = ret 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T06:28:19.317

您是想在字段中搜索特定值还是要求一个成熟的查询设计器？

如果是第一个，应该相对容易，您可以直接在数据网格中选择行或触发参数化查询以获得结果。

如果是第二个，事情会稍微复杂一些。您可能必须使用 [第三方组件](http://devtools.korzh.com/eq/dotnet/)。

按照要求 ：-）

您使用了错误的连接。您应该使用 OleDbConnection 类。我讨厌吹毛求疵，但是您正在通过字符串连接动态生成 SQL 语句，这使您容易受到 SQL 注入攻击

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T07:14:15.857

它更好用

dataset.table.select("a=b")

# struts2 - struts2 迭代器标签帮助

> ID：938126
> 
> 赞同：0
> 
> 时间：2009-06-02T06:21:05.257
> 
> 标签：struts2, jstl

我正在使用[Struts 迭代器](http://struts.apache.org/2.0.14/docs/iterator.html)标记并尝试在 1 次迭代中获取列表中的 3 个元素。

这就是我所拥有的。

```
<s:iterator status="stat" value="(secondResultSet.size()/3).{ #this}" >
   <s:property value="#stat.count" /> <!-- Note that "count" is 1-based, "index" is 0-based. -->
   <s:property value="%{secondResultSet.get(#stat.index).altId}"/>
   <s:property value="%{secondResultSet.get(#stat.index+1).altId}"/>
   <s:property value="%{secondResultSet.get(#stat.index+2).altId}"/>
</s:iterator> 
```

我的列表有 18 个元素，在一次迭代中我想打印出 3 个元素。这就是为什么我将列表的长度除以 3。所以循环将运行 6 次......总共打印出 18 个元素。

对于此示例，我的列表包含的不同 altId 为：41 - 58 (18)。但是，我的代码打印出以下内容

```
First Iteration: 41 42 43
Second Iteration: 42 43 44
Third Iteration: 43 44 45 
```

所以看起来计数器没有更新。有人可以帮我弄这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T15:00:49.643

对于尝试这样做的其他人...

最好的方法是在您的班级中创建列表，如下所示：

```
public void generateIteratorList()
{
    iterList = new ArrayList();
    int value = 0;
    for (int i = 0; i < (getSecondResultSet().size()/3); i++)
    {
        iterList.add(value);
        value+=3;
    }
} 
```

然后像这样使用 s:iterator 标签：

```
<s:iterator status="stat" value="iterList" >
   <s:property value="%{secondResultSet.get(top).altId}" />
   <s:property value="%{secondResultSet.get(top+1).altId}" />
   <s:property value="%{secondResultSet.get(top+2).altId}" />
</s:iterator> 
```

# javascript - 不返回任何内容的 Web 服务的推荐返回类型（使用 jquery 调用）

> ID：938129
> 
> 赞同：3
> 
> 时间：2009-06-02T06:21:29.000
> 
> 标签：javascript, jquery, ajax, json

我有一个带有一些方法的 Web 服务，从技术上讲，它们在客户端上并没有做太多事情。我通过 jquery/ajax 调用它

推荐的返回类型是什么，我通常会返回 JSON ......但如果它不返回任何东西......我是否返回布尔值？即真 = 成功 ... 假 = 错误 ??

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T06:27:44.247

HTTP状态码怎么样：

```
200 OK
500 Error 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T08:24:58.540

如果它没有返回任何内容，您应该使用 HTTP 状态代码：

```
204 No Content
The server successfully processed the request, but is not returning any content. 
```

HTTP 状态代码也可用于其他用途，但请注意仅将它们用于 HTTP 状态而不是应用程序状态。

对于应用程序状态，您应该考虑使用标准 JSON 对象（或 SOAP 或 XML 或您使用的任何格式）。这也是 Stack Overflow 的做法，您可以通过在其上运行 HTTP 调试器来验证：

```
{ "response": true, "data" : <data>, "message" : <message> } 
```

理想情况下，该`response`属性应为 true 或 false，以保持客户端上的逻辑简单。该消息通常为空，除非发生错误，在这种情况下它将包含错误消息。

就 HTTP 状态码而言，它们应该仅用于指示 HTTP，而不是应用程序状态码。

## `5xx`服务器错误

```
500 Internal Server Error
501 Not Implemented
502 Bad Gateway
503 Service Unavailable
504 Gateway Timeout
505 HTTP Version Not Supported
506 Variant Also Negotiates (RFC 2295 )
507 Insufficient Storage (WebDAV) (RFC 4918 )
509 Bandwidth Limit Exceeded (Apache bw/limited extension)
510 Not Extended (RFC 2774 ) 
```

## 2xx 成功

```
200 OK
201 Created
202 Accepted
203 Non-Authoritative Information (since HTTP/1.1)
204 No Content
205 Reset Content
206 Partial Content
207 Multi-Status (WebDAV) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T06:26:06.153

您可以走 SOAP 路线并以 XML 形式返回状态。

这几乎可以被任何东西解析。

喜欢：

```
<m:IsYourMethodSuccessful xmlns:m="Some-Namespace-URI”&gt; 
    <return>true</return> 
</m:IsYourMethodSuccessful> 
```

这样做的好处是，如果将来您决定需要添加客户端反馈，您可以返回详细的异常信息。

或者，因为您已经在解析 json：

```
{ success : true }

{ success : false, exception : { ... } } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T06:33:05.520

这有点取决于方法。对于更新和创建，我通常返回实体的服务器 ID，以及创建或更新的时间。这有助于客户在本地管理实体的状态（如果他们正在存储它们）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T06:27:39.350

我只会返回一个布尔值 - 可以工作的最简单的东西。

# vb.net - 检测 NumLock 是否关闭并将其始终重新打开

> ID：938144
> 
> 赞同：1
> 
> 时间：2009-06-02T06:24:32.897
> 
> 标签：vb.net, input, keyboard

有什么方法可以检测 NumLock 是否关闭以及如何在我的 VB APP 运行时自动将其重新打开？

编辑：我的应用程序是专用应用程序，在带有外部数字键盘设备的专用计算机上运行。

另一种选择是接受数字键盘箭头键（等）并将它们即时转换为数字，这可能吗？（例如，忽略 numlock 关闭的情况并表现得像 numlock 开启）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T06:36:53.123

我不确定您是如何在 vb.net 中专门执行此操作的（快速谷歌找到了[http://support.microsoft.com/kb/177674](http://support.microsoft.com/kb/177674)），但一般来说，像这样更改机器范围的设置是不受欢迎的：用户是习惯了他们对 numlock （或 capslock —— 或其他）键状态的个人偏好......而你正在覆盖它。

这**真的**会激怒我。

也就是说，在您的应用程序是唯一运行的情况下（例如，POS 软件、医疗办公室管理软件等），这可能没问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T08:13:53.007

```
 Private Declare Sub keybd_event Lib "user32" (ByVal bVk As Byte, ByVal bScan As Byte, ByVal dwFlags As Long, ByVal dwExtraInfo As Long)
    Private Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)
    Private Const KEYEVENTF_KEYUP = &H2
    Const VK_NUMLOCK = &H90
    Const KEYEVENTF_EXTENDEDKEY = &H1
    Declare Function GetKeyState Lib "user32" Alias "GetKeyState" (ByVal ByValnVirtKey As Integer) As Short

 Private Sub numlockON()
        keybd_event(VK_NUMLOCK, 0, 0, 0) ' Press NUMLOCK key down
        keybd_event(VK_NUMLOCK, 0, KEYEVENTF_KEYUP, 0) ' Release it
    End Sub

If Not GetKeyState(VK_NUMLOCK) Then numlockON() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T07:52:27.607

物理删除 NUMPAD 键？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-23T01:53:54.270

```
Public Const VK_NUMLOCK = &H90
Declare Function GetKeyState Lib "user32" Alias "GetKeyState" _
(ByVal ByValnVirtKey As Integer) As Short

Private Sub me_keyDown(ByVal sender As System.Object, _
ByVal e As System.Windows.Forms.KeyEventArgs) Handles Me.KeyDown
    If e.KeyCode = Keys.NumLock And Not NLKey Then
        If Not GetKeyState(VK_NUMLOCK) Then
            e.Handled = True
            NumlOn.Start()
            Exit Sub
        End If
    End If
End sub

Private Sub NumlOn_Tick(sender As Object, e As EventArgs) Handles NumlOn.Tick
    NLKey = True
    If Not GetKeyState(VK_NUMLOCK) Then numlockON()
    Application.DoEvents()
    NumlOn.Stop()
    NLKey = False
End Sub 
```

# c# - 将 WPF 文本框设置为剪切、复制和粘贴受限

> ID：938145
> 
> 赞同：31
> 
> 时间：2009-06-02T06:24:36.563
> 
> 标签：c#, wpf, wpf-controls

如何限制 WPF 文本框的剪切、复制和粘贴？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-06-02T06:47:29.140

剪切、复制和粘贴是任何应用程序使用的常用命令，

```
<TextBox CommandManager.PreviewExecuted="textBox_PreviewExecuted"
         ContextMenu="{x:Null}" /> 
```

在上面的文本框代码中，我们可以在 CommandManager 类的 PrviewExecuted 事件中限制这些命​​令

并在后面的代码中添加下面的代码，你的工作就完成了

```
private void textBox_PreviewExecuted(object sender, ExecutedRoutedEventArgs e)
{
     if (e.Command == ApplicationCommands.Copy ||
         e.Command == ApplicationCommands.Cut  || 
         e.Command == ApplicationCommands.Paste)
     {
          e.Handled = true;
     }
} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2010-06-22T16:43:21.167

commandName 方法不适用于具有日语操作系统的系统，因为 commandName=="Paste" 比较将失败。我尝试了以下方法，它对我有用。我也不需要手动禁用上下文菜单。

在 XaML 文件中：

```
<PasswordBox.CommandBindings>
    <CommandBinding Command="ApplicationCommands.Paste"
    CanExecute="CommandBinding_CanExecutePaste"></CommandBinding>
</PasswordBox.CommandBindings> 
```

在后面的代码中：

```
private void CommandBinding_CanExecutePaste(object sender, CanExecuteRoutedEventArgs e)
{
    e.CanExecute = false;
    e.Handled = true;
} 
```

# sharepoint - 有人可以解释 MOSS 2007 中的备用访问映射吗？

> ID：938146
> 
> 赞同：2
> 
> 时间：2009-06-02T06:24:37.280
> 
> 标签：sharepoint, sharepoint-2007

我在使用 ISA 2006 服务器后面的 MOSS 2007 服务器时遇到问题。似乎问题可能是如何配置 ISA 或如何设置 AAM，但我似乎无法确定是哪一个。有人可以解释 AAM 应该做什么吗？似乎他们只是应该重写 URL，以便将 http: 编码为 https: 地址。所有或 URL 似乎都是正确的，但我有很多问题，例如无法加载图像和文档库非常错误。我只能检查某些文档，提示只读或编辑的对话框从不显示。我还没有找到文档打开或产生错误的模式。

我不知道从什么方向寻找这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T07:59:34.003

引用[Technet 文章](http://technet.microsoft.com/en-us/library/cc261814.aspx)：

> **关于备用访问映射** 备用访问映射使在五个身份验证区域之一中接收内部 URL 请求的 Web 应用程序能够返回包含指向该区域的公共 URL 的链接的页面。您可以将 Web 应用程序与内部 URL 和公共 URL 之间的映射集合相关联。内部是指 Office SharePoint Server 2007 接收到的 Web 请求的 URL。公共是指可从外部访问的网站的 URL。公共 URL 是 Office SharePoint Server 2007 在其返回的页面中使用的基本 URL。如果内部 URL 已被反向代理设备修改，则它可能与公共 URL 不同。

为此编写了一些很好的指南：

*   鲍勃福克斯有一个[如何截屏](http://bobfox.securespsite.com/FoxBlog/Lists/Posts/Post.aspx?ID=16)
*   SharePoint 团队博客有一个[很好的指南](http://blogs.msdn.com/sharepoint/archive/2007/03/06/what-every-sharepoint-administrator-needs-to-know-about-alternate-access-mappings-part-1.aspx)
*   Technet有一篇比较[透彻的文章](http://technet.microsoft.com/en-us/library/cc261814.aspx)

在调试方面需要检查一些事情：

*   所有 ISA 设置都是正确的
*   AAM 区域在 MOSS 中正确设置
*   尝试在客户端机器上使用[提琴手](http://www.fiddler2.com/)看看发生了什么，过去我注意到 https 和 http 请求的混合通过导致图像等问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-09T08:39:27.370

“当我从文档库请求文件时，会发生什么不同的情况吗？当我通过 ISA 观察流量时，我收到匿名请求并打开 word，但不是我请求的文件”

是的，问题是，Word 首先执行匿名请求。与WebDAV有关，这种行为可以通过策略来改变......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-09T11:30:07.570

可能有帮助的一点：在后台运行的任何东西（例如，OWSTiMER.EXE）都将使用默认的 AAM。

# jquery - 当输入按钮被点击时，执行一个动作

> ID：938149
> 
> 赞同：0
> 
> 时间：2009-06-02T06:25:35.953
> 
> 标签：jquery

这是我的代码：

```
<script>
    $("#btn1").click(function(){
        baseURL='http://domain.com/base1';
        $("input#Race").val("btn2");
        $("input#Race").attr("id","btn2");
    });
    $("#btn2").click(function(){
        baseURL='http://domain.com/base2';
        $("input#pet").val("btn1");
        $("input#pet").attr("id","btn1");
    });
</script>
<td><input class="inputbutton" id="btn1" type=button value="btn1"></td> 
```

应该发生什么，当您单击按钮时，它会在 btn1 和 btn2 之间更改，并且还会更改 baseURL 变量。

但是当我单击按钮时，什么也没有发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T06:36:21.847

更改元素的 id 是一个奇怪的想法。如果它有效，我会感到惊讶。您最好自己交换按钮，而不是交换它们的 ID。

# iphone - 将 iPhone 连接到 XBee 模块

> ID：938155
> 
> 赞同：7
> 
> 时间：2009-06-02T06:27:29.757
> 
> 标签：iphone, external, wireless, xbee

我想使用 iPhone 使用 XBee 调制解调器（或其他低功率无线设备）监控来自远程源的输出。理想情况下，iPhone 可以定期轮询 XBee 以获取此信息，然后使用它来显示生成输出。

我猜这类似于 Nike+iPod 的工作方式，但我想知道是否可以不使用边缘连接器附件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T07:36:32.250

XBee 是 2.4GHz，但它不是 WiFi 或蓝牙。没有用于控制 iPod 收音机的 API。如果您想与 XBee 网络通话，您需要通过某种网关设备进行连接，该设备位于 XBee 网络和连接到 iPhone 的网络之一上。这可以是 Internet、LAN 或通过与坞站连接器的物理连接。

如果您对硬件感到满意，您可以构建一个带有以太网插孔和 XBee 无线电的设备，然后为 iPhone 编写软件来与您的小工具通信，这会将您的消息传递到 XBee 网络。

或者您可以构建您的终端节点设备以直接使用 WiFi，而完全将 XBee 排除在外。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-28T23:57:20.313

Digi 现在有一个 WiFi XBee 模块，它可以直接插入旧 XBee 所在的位置，并且可以直接从 iPhone 应用程序通过 TCP 或 UDP 访问。

不幸的是，XBee-WiFi 只支持 WiFi，而不是 XBee 和 WiFi。但是，将 WiFi 的 DIN 和 DOUT 连接到 XBee DOUT 和 DIN，您就有了一个直接的 WiFi<->XBee 便携式硬件桥接器，无需任何软件。在它们之间放置一个微控制器，你真的可以做一些很酷的事情。XBee WiFi 的价格约为 50 美元。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-03T09:41:16.777

我正在开发一个控制 802.15.4 ZigBee 模块的应用程序；如果您还没有注册 MFi 许可证，则无法访问 /dev/tty.xx ，因此如果您愿意，可以尝试使用越狱的 iPhone 并将您的应用程序放在 /Applications 文件夹中（通过这种方式您可以访问到串行端口并注意这是安装 cydia 应用程序的文件夹，例如 Cydia.app 等。）。此外，您必须拥有正确的硬件和模块的协议规范。我使用 USB 转串口 RS232，这是一条修改后的 iphone 电缆，连接到 ZigBee 模块所在的开发板；通信通过 UART 二进制协议进行。

希望这对我有帮助，其他意见也对我表示赞赏。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-25T02:59:47.683

我知道这现在有点老了，但我最近做了一个项目，它使用了一个带有 WiServer shield 的 arduino，它允许我展示一个可以从我的 iPhone 上查看的 ad-hoc 网络和网页。我正在使用它通过对网页的 GET 请求来管理伺服控制。

查看 Async Labs 了解 WiServer 的内容。他们正在发布 arduino+WiShield 组合产品（Black Widow 或 Yellowjacket，取决于您的尺寸需求）。

异步实验室[http://asynclabs.com](http://asynclabs.com)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T07:56:00.500

并非不诉诸越狱设备。iphone 2.x 和 3.x 设备上的蓝牙纯粹是为了免提。我听说有人在与其他音频设备一起工作，但这就是蓝牙连接的程度。

您想使用像 pachube.com 这样的数据代理通过 http 查看传感器数据。这是一个示例 iphone 应用程序： http: [//apps.pachube.com/iphone/](http://apps.pachube.com/iphone/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T11:35:46.360

使用外部附件框架，

3.0 设备可以查看 3.0 SDK 外部附件框架，它仍处于保密协议下，因此无法共享任何代码，但可以。

> External Accessory 框架提供了一种与连接到基于 iPhone OS 的设备的附件进行通信的方法。使用它与通过 30 针底座连接器或蓝牙连接的配件进行交互。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-19T11:55:48.527

Microchip有一个[官方开发套件](http://www.microchip.com/pagehandler/en-us/technology/smartphoneaccessory/tools/home.html)，因此您可以开发一些硬件以在 iPhone 和 ZigBee 之间建立一座桥梁。

Android 也有一个等效版本。

# javascript - 如何用 JS 悄悄地更新页面标题（在 Rails 中）

> ID：938160
> 
> 赞同：3
> 
> 时间：2009-06-02T06:27:52.453
> 
> 标签：javascript, ruby-on-rails, dry, unobtrusive-javascript

每当我使用 Ajax 将博客文章加载到页面上时，我都会将页面设置`<title>`为“我的博客 - BLOGPOST_TITLE”。

当然，“我的博客 -”也出现在我的应用程序布局中。

问题是，我如何告诉我的 Javascript 关于字符串“My Blog -”而不在我的代码中复制它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T06:32:24.910

在将 Ajax 发送到服务器之前，将 document.title 值（“我的博客”）存储到某个变量。然后当响应到达时将 document.title 设置为 document.title + ' - ' + BLOGPOST_TITLE

所以你有HTML：

... <title>我的博客</title> ...

在 JS 中：

```
var TITLE = 文档.title;

函数 getBlogSpotEntry() {
   Ajax.Request(url, {
     onSuccess：函数（响应）{
       var entryTitle = getTitle(response.responseText);

       document.title = TITLE + " - " + entryTitle;
     }
   })
}

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T06:32:43.240

我会这样（很脏，但效果很好）：

```
document.myTitlePrefix = 'My Blog - ' 
```

然后将标题更新为

```
document.title = document.myTitlePrefix + blogPostTitle 
```

# javascript - onmouseover、onmouseout、onclick 事件上的图像更改

> ID：938165
> 
> 赞同：0
> 
> 时间：2009-06-02T06:28:57.617
> 
> 标签：javascript, onclick, onmouseout, onmousemove

我有两个图像，img1 和 img2。我的代码：

```
function roll(id,img_name,event_name,img_id)
 {
    var state ;
    if(event_name == 'mouseover')
    { state = false;rollover();}
    else if(event_name == 'mouseout')
    {state = false;rollout();}
    else if(event_name == 'onClick')
    {alert(event_name);state = true;showdata(id,img_name,state);}
    else
    {showDIV(id);}

   function rollover()
   {
        if(state == false)
        {
            var imgpath='image_file/'; 
            document[img_name].src =imgpath + img_name + '_over.png';
        }
   }
   function rollout()
   {
        if(state == false)
        {
            var imgpath='image_file/'; 
            document[img_name].src = imgpath + img_name + '.png';
        }
   }
    function showDIV(id)
    {  
        var div = document.getElementById(id);
	    if ( div.style.display != "none" ) 
	    {
		    div.style.display = "none";
		    document[img_name].src='downarrow.png';

	    }
	    else 
	    {
		    div.style.display = "block";
		    document[img_name].src='uparrow.png';
	    }
    }
    function showdata(id,img_name,state,img_id)
    {alert(state);
        if(state == true)
        {
            var imgpath='image_file/'+ img_name;
            var div = document.getElementById(id);
	        if ( div.style.display != "none" ) 
	        { alert('none' +state);
	            document.getElementsByName(img_name).src =imgpath + '.png';
		        div.style.display = "none";
	        }
	        else 
	        {   alert('block :' +state);
	            document.images[img_name].src='image_file/journey_icon_over.png';
		        div.style.display = "block";
	        }
	    }
    }
}
```

```
 <tr>
    <td valign="top" width="100%">
    <img id="img1"  name="journey_icon" src="image_file/journey_icon.png"  alt="Journey  Report" onmouseover="roll('JourneyReport','journey_icon','mouseover')" onmouseout="roll('JourneyReport','journey_icon','mouseout')" onclick="roll('JourneyReport','journey_icon','onClick',this.id)" />
    <div id="JourneyReport" style="display:none;" class="divbackground">
    <uc1:ReportControl ID="JourneyControl" runat="server" />
    </div>
    </td>
    </tr>
```

要求是，我需要在鼠标悬停时使用 img1，在鼠标悬停时需要 img2，这工作正常，但在单击时，我需要打开 div，img2 被冻结，然后再次单击 div 消失，onmouseover 和 onmouseout 状态正常工作。目前的问题是，点击时会出现 div，但也会触发 onmouse over 和 onmouseout 函数。

库什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-16T21:44:29.843

您需要阻止事件冒泡。在你的`onclick`代码末尾，添加这个： `window.events.cancelBubble = true;`看看它是如何为你工作的。我不确定这是否会停止`mouseover`和`mouseout`事件，但试一试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T07:18:38.827

嘿，我在逻辑的帮助下管理了那个事件......我的情况完全不同......

onmouseover 事件 = 编写函数以显示第一张图片

onmouseout 事件 = 编写函数以显示单击后要显示的图像

onclick 事件 = 保存上次单击的图像（在隐藏字段中的某个位置）还调用函数“编写函数以显示单击后要显示的图像。即 snd 函数”，并说返回 false；

仅此而已不要将事件中的 img url`mouseout`作为参数写入，而是为它编写 Js fun 以在“保存最后点击的图像（即 onclick 事件中使用的第一个乐趣”）中获取 img url

我想这会对你有所帮助

# css - 不同的下拉列表组件

> ID：938169
> 
> 赞同：1
> 
> 时间：2009-06-02T06:30:16.553
> 
> 标签：css, html

我想创建一个组件，如下所示：

![替代文字](https://content.screencast.com/users/uzay95/folders/Jing/media/061f1a24-06f0-412f-a322-f9b755a20589/2009-06-02_0922.png)

它将类似于下拉列表。我想在表格行的每个单元格（td）中使用这个组件。所以我的问题是在第一个 div 下方但在表格行上方显示第二个 div（项目列表）。

你能帮我看看它的css吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T07:04:04.863

首先，我会让弹出的 div 飞到上面而不是下面。这样做的原因是它会自动“高于”（在 z-index 术语中）上面的元素，因此它不会被连续的表行覆盖。

其次，你会想要这样的东西：

```
<div class="action">
   <div class="select"><!-- select box here --></div>
   <div class="popout"><!-- stuff here --></div>
</div> 
```

然后像这样使用 CSS 激活它：

```
div.action {
   width:75px;
   height:30px;
   position:relative;
}
div.select {
   position:absolute;
   top:0;
   left:0;
}
div.popout {
   position:absolute;
   left:0;
   bottom:30px;
   width:300px;
   display:none; /* it will be revealed on hover */
}
div.action:hover div.popout {
   display:block;
} 
```

要在旧版本的 IE 中使用此功能，您可以将此 JavaScript 添加到操作 div：

```
<div class="action" onmouseover=""this.className='action hover'" onmouseout="this.className='action'"> 
```

然后使用一个悬停类而不是状态：

```
div.hover div.popout {
   display:block;
} 
```

我希望这就是你的意思！:)

# javascript - 网页本地化

> ID：938171
> 
> 赞同：-1
> 
> 时间：2009-06-02T06:31:08.453
> 
> 标签：javascript, html

我开发了一个网站。因为我需要为本地化定制。我保留了不同的国旗图像。当我单击图片时，网页会更改为相关国家/地区语言。我尝试了谷歌语言翻译工具，但效率不高，请指导我这样做。提前致谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T06:39:03.557

您是否尝试动态生成替代语言版本？如果您希望母语为另一种语言的人能够理解您的网站，更不用说保持适当的视觉布局和设计，您应该聘请翻译。计算机自动翻译是可怕的，根据我的经验，通常会让你的读者感到困惑（或者，如果翻译足够糟糕，只会引起大笑。）翻译内容通常也不仅仅是翻译文本。如今，大多数网站都使用图像中的文本，并且相同的英文文本翻译成德语，比英文版本占用更多空间。如果您希望网站易于理解、完全翻译（包括带有文本的图像）并正确布局以保持您的视觉设计和可用性，那么翻译网站是一项棘手的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T06:38:37.163

我认为任何非人类语言翻译工具都不会为您提供任何重要网站内容的准确翻译。我会尝试找到一个可以为您翻译内容的真实人员。完成翻译后，您可以使用资源文件或数据库以可以检索每种语言的方式存储内容。

# restlet - Restlet 如何处理 HTTP Accept 标头？

> ID：938174
> 
> 赞同：1
> 
> 时间：2009-06-02T06:31:44.927
> 
> 标签：restlet

Restlet 框架应该处理自动内容协商；但是，它似乎没有正确地做到这一点。

当客户端发送带有带有值的 Accept 标头的 HTTP GET 请求时，Restlet 不会自动协商内容。

有谁知道如何处理 Accept 标头？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T12:13:23.550

Restlet API 广泛支持“Accept”标头。信息通过`Request.getClientInfo().getAcceptedMediaTypes()`:`List<Preference<MediaType>>`方法解析并可用。

现在，为了自动为您协商内容，Restlet 引擎需要有关可用变体的信息。这是`org.restlet.resource.Resource class`Restlet 1.1 的目的，也是正在开发的 Restlet 2.0 版本中的新`org.restlet.resource.ServerResource`类。

在 Restlet 1.1 中，创建 Resource 的子类，声明变体如下：

```
 getVariants().add(new Variant(MediaType.TEXT_PLAIN));

   getVariants().add(new Variant(MediaType.APPLICATION_XML)); 
```

然后重写这样的`represent(Variant)`方法：

```
public Representation represent(Variant){

  if(MediaType.TEXT_PLAIN.equals(variant.getMediaType()){

     ...

  else if(...)

     ...
} 
```

最好的问候，杰罗姆

PS：请使用我们的邮件列表解决未来的问题并查看档案： [http ://www.restlet.org/community/lists](http://www.restlet.org/community/lists)

# sql-server - Sql Server 2005 全文搜索中的噪声词

> ID：938175
> 
> 赞同：4
> 
> 时间：2009-06-02T06:31:51.993
> 
> 标签：sql-server, full-text-search

我正在尝试对数据库中的一系列名称进行全文搜索。这是我第一次尝试使用全文搜索。目前我使用输入的搜索字符串并在每个术语之间放置一个 NEAR 条件（即输入的“Kings of Leon”短语变为“Kings NEAR of NEAR Leon”）。

不幸的是，我发现这种策略会导致错误的否定搜索结果，因为 SQL Server 在创建索引时删除了“of”这个词，因为它是一个干扰词。因此，“Kings Leon”将正确匹配，但“Kings of Leon”不会。

我的同事建议将 MSSQL\FTData\noiseENG.txt 中定义的所有干扰词放入 .Net 代码中，以便在执行全文搜索之前去除干扰词。

这是最好的解决方案吗？是否有一些我可以在 SQL Server 中更改的自动魔术设置来为我执行此操作？或者也许只是一个更好的解决方案，感觉不那么老套？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T14:27:29.430

全文将根据您提供的搜索条件起作用。您可以从文件中删除干扰词，但这样做确实有使索引大小膨胀的风险。罗伯特凯恩在他的博客上有很多关于这方面的好信息：

[http://arcanecode.com/2008/05/29/creating-and-customizing-noise-words-in-sql-server-2005-full-text-search/](http://arcanecode.com/2008/05/29/creating-and-customizing-noise-words-in-sql-server-2005-full-text-search/)

为了节省一些时间，您可以查看此方法如何删除它们并复制代码和单词：

```
 public string PrepSearchString(string sOriginalQuery)
    {
        string strNoiseWords = @" 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 0 | $ | ! | @ | # | $ | % | ^ | & | * | ( | ) | - | _ | + | = | [ | ] | { | } | about | after | all | also | an | and | another | any | are | as | at | be | because | been | before | being | between | both | but | by | came | can | come | could | did | do | does | each | else | for | from | get | got | has | had | he | have | her | here | him | himself | his | how | if | in | into | is | it | its | just | like | make | many | me | might | more | most | much | must | my | never | now | of | on | only | or | other | our | out | over | re | said | same | see | should | since | so | some | still | such | take | than | that | the | their | them | then | there | these | they | this | those | through | to | too | under | up | use | very | want | was | way | we | well | were | what | when | where | which | while | who | will | with | would | you | your | a | b | c | d | e | f | g | h | i | j | k | l | m | n | o | p | q | r | s | t | u | v | w | x | y | z ";

        string[] arrNoiseWord = strNoiseWords.Split("|".ToCharArray());

        foreach (string noiseword in arrNoiseWord)
        {
            sOriginalQuery = sOriginalQuery.Replace(noiseword, " ");
        }
        sOriginalQuery = sOriginalQuery.Replace("  ", " ");
        return sOriginalQuery.Trim();
    } 
```

但是，我可能会为此使用 Regex.Replace，它应该比循环快得多。我只是没有一个快速的例子来发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-22T22:10:02.670

这是一个工作函数。该文件`noiseENU.txt`按原样从`\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\FTData`.

```
 Public Function StripNoiseWords(ByVal s As String) As String
        Dim NoiseWords As String = ReadFile("/Standard/Core/Config/noiseENU.txt").Trim
        Dim NoiseWordsRegex As String = Regex.Replace(NoiseWords, "\s+", "|") ' about|after|all|also etc.
        NoiseWordsRegex = String.Format("\s?\b(?:{0})\b\s?", NoiseWordsRegex)
        Dim Result As String = Regex.Replace(s, NoiseWordsRegex, " ", RegexOptions.IgnoreCase) ' replace each noise word with a space
        Result = Regex.Replace(Result, "\s+", " ") ' eliminate any multiple spaces
        Return Result
    End Function 
```

# javascript - 从 IFRAME 获取当前 URL

> ID：938180
> 
> 赞同：110
> 
> 时间：2009-06-02T06:33:48.170
> 
> 标签：javascript, url, iframe

有没有一种简单的方法可以从 iframe 获取当前 URL？

观众会浏览多个网站。我猜我会在javascript中使用一些东西。

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2009-06-02T06:38:58.130

出于安全原因，您只能在 iframe 的内容和引用的 javascript 来自同一域的情况下获取 url。只要这是真的，这样的事情就会起作用：

```
document.getElementById("iframe_id").contentWindow.location.href 
```

如果两个域不匹配，您将遇到跨站点引用脚本安全限制。

另请参阅[类似问题的答案](https://stackoverflow.com/questions/44359/how-do-i-get-the-current-location-of-an-iframe)。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-10-28T11:36:57.153

如果您的 iframe 来自另一个域（跨域），则其他答案对您没有帮助......您只需要使用它：

```
var currentUrl = document.referrer; 
```

和 - 这里你有主网址！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-07-09T01:05:34.747

如果您在 iframe 上下文中，

你可以做

```
const currentIframeHref = new URL(document.location.href);
const urlOrigin = currentIframeHref.origin;
const urlFilePath = decodeURIComponent(currentIframeHref.pathname); 
```

如果您在父窗口/框架中，那么您可以使用[https://stackoverflow.com/a/938195/2305243](https://stackoverflow.com/a/938195/2305243)的答案，即

```
document.getElementById("iframe_id").contentWindow.location.href 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-10-25T09:26:05.957

希望这会对您有所帮助，我遇到了完全相同的问题，只是使用本地存储在父窗口和 iframe 之间共享数据。因此，在父窗口中，您可以：

```
localStorage.setItem("url", myUrl); 
```

而在 iframe 源代码只是从本地存储中获取这些数据：

```
localStorage.getItem('url'); 
```

为我节省了很多时间。据我所知，唯一的条件是访问父页面代码。希望这会对某人有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-05-28T11:34:59.073

我遇到了 blob url hrefs 的问题。因此，通过对 iframe 的引用，我刚刚从 iframe 的 src 属性生成了一个 url：

```
 const iframeReference = document.getElementById("iframe_id");
    const iframeUrl = iframeReference ? new URL(iframeReference.src) : undefined;
    if (iframeUrl) {
        console.log("Voila: " + iframeUrl);
    } else {
        console.warn("iframe with id iframe_id not found");
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-10-06T14:34:19.387

如果您在没有跨域 src 的 iframe 中，或者 src 为空：

然后：

```
function getOriginUrl() {
    var href = document.location.href;
    var referrer = document.referrer;
    // Check if window.frameElement not null
    if(window.frameElement) {
        href = window.frameElement.ownerDocument.location.href;
        // This one will be origin
        if(window.frameElement.ownerDocument.referrer != "") {
            referrer = window.frameElement.ownerDocument.referrer;
        }
    }
    // Compare if href not equal to referrer
    if(href != referrer) {
        // Take referrer as origin
        return referrer;
    } else {
        // Take href
        return href
    }
} 
```

如果您在具有跨域 src 的 iframe 中：

然后：

```
function getOriginUrl() {
    var href = document.location.href;
    var referrer = document.referrer;
    // Detect if you're inside an iframe
    if(window.parent != window) {
        // Take referrer as origin
        return referrer;
    } else {
        // Take href
        return href;
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-03-11T12:10:09.580

我一直在尝试从 shopify 谷歌分析附加脚本 iframe 内部检索完整的 URL。`document.refferer`仅显示没有搜索参数的主机名。但我找到了另一个适合我的房产`document.baseURI`

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2020-08-31T12:03:07.033

对于可能正在为此苦苦挣扎的任何人的一些附加信息：

如果您在加载之前尝试从 iframe 获取 URL，您将获得空值。我通过在 javascript 中创建整个 iframe 并使用 onLoad 函数获取我需要的值来解决这个问题：

```
var iframe = document.createElement('iframe');
iframe.onload = function() {

    //some custom settings
    this.width=screen.width;this.height=screen.height; this.passing=0; this.frameBorder="0";

    var href = iframe.contentWindow.location.href;
    var origin = iframe.contentWindow.location.origin;
    var url = iframe.contentWindow.location.url;
    var path = iframe.contentWindow.location.pathname;

    console.log("href: ", href)
    console.log("origin: ", origin)
    console.log("path: ", path)
    console.log("url: ", url)
};

iframe.src = 'http://localhost/folder/index.html';

document.body.appendChild(iframe); 
```

由于同源策略，我在访问“跨源”帧时遇到了问题——我通过在本地运行网络服务器而不是直接从我的磁盘运行所有文件来解决这个问题。为了使所有这些工作，您需要使用与源相同的协议、主机名和端口来访问 iframe。从我的磁盘运行所有文件时，不确定其中哪些丢失/丢失了。

此外，有关位置对象的更多信息：[https ://www.w3schools.com/JSREF/obj_location.asp](https://www.w3schools.com/JSREF/obj_location.asp)

# mysql - 将 mysql 从 5.0 升级到 5.1，现在 Rails 2.3 坏了（在 Mac 上）

> ID：938181
> 
> 赞同：0
> 
> 时间：2009-06-02T06:34:21.320
> 
> 标签：mysql, ruby-on-rails, macos, rubygems

我将 Mac 上的 mysql 从 5.0.x 升级到 5.1.x（使用直接来自 mysql.com 的 dmg 包），这破坏了 Rails (2.3.2)。以前一切正常。我得到的错误是这样的：

**！！！捆绑的 mysql.rb 驱动程序已从 Rails 2.2 中删除。请安装 mysql gem 并重试：gem install mysql。**

所以我尝试重新安装mysql gem，尝试卸载并重新安装，仍然没有运气。（用于安装的命令：'sudo gem install mysql -- --with-my-sql-config= *PATH TO mysql_config on my* machine'。gem 安装良好，但不能解决问题。

在网上进行了很多挖掘，但找不到听起来正确的解决方案。有一些关于复制旧 mysql dll 的 Windows 建议，所以可能有一些 Mac 模拟，但这对我来说听起来是错误的。

还有其他人遇到这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T06:55:30.763

你不应该用过`sudo gem install mysql`吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T04:58:43.097

我终于解决了导致“捆绑的 mysql.rb 驱动程序已从 Rails 2.2 中删除”错误的问题。[如果您在我的博客 ( http://freevirusesandspyware.com/2009/05/upgrading-ruby-on-mac-os-x-leopard-from.html](http://freevirusesandspyware.com/2009/05/upgrading-ruby-on-mac-os-x-leopard-from.html) )中阅读此条目，您将看到我从 1.8 更新 ruby​​ 的传奇.6 到 1.8.7 以及它对我的宝石造成的问题。好吧，我为我的用户帐户修复了这些，但在我使用 sudo 时没有修复——当我执行“gem environment”/“sudo gem environment”时，它们会给出不同的已安装 gem 列表。运行旧的 gem 工具，并在使用和不使用 sudo 的情况下得到相同的列表。嗯。所以我尝试使用旧的 gem 工具卸载/重新安装 mysql gem，然后 bam！问题解决了。

# python - 在没有命令行访问权限的 Linux 托管服务提供商上安装 CherryPy

> ID：938185
> 
> 赞同：0
> 
> 时间：2009-06-02T06:34:46.687
> 
> 标签：python, linux, cherrypy

我有一个基于 linux 的网络托管服务提供商 (fatcow.com)，它不提供任何命令行访问权限，也不会为我运行 CherryPy (python web 服务器) 的设置脚本。

有什么办法可以绕过这个限制，以便我可以正常安装 CherryPy？

这可能更多或 serverfault.com 问题，但也许这里有人以前处理过这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T06:40:49.263

如果 CherryPy 是纯 Python，那么您可以简单地将`cherrypy`文件夹放在项目所在的同一位置。这将使您能够`import`从 CherryPy 获得必要的东西，而无需将其复制到官方安装目录。我个人从未使用过 CherryPy，所以我不确切知道正在安装什么以及如何使用它，但我已经用 Django 顺利完成了同样的事情。

好的，我刚刚下载了 CherryPy 3.1.2，解压缩，然后复制了`./cherrypy/tutorial`to的内容`.`，运行了[建议](http://www.cherrypy.org/wiki/CherryPyInstall)的tut101_helloworld.py，它似乎可以工作。

至于将其连接到 Apache，这取决于您的主机上可用的内容。我认为最常见的 Python 接口是[`mod_python`](http://www.cherrypy.org/wiki/ModPython). 遵循这些说明时，重要的是设置`sys.path`正确以便`mod_python`能够看到`cherrypy`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-25T09:01:15.997

mod_python 的替代方法是 mod_wsgi - [http://code.google.com/p/modwsgi/wiki/IntegrationWithCherryPy](http://code.google.com/p/modwsgi/wiki/IntegrationWithCherryPy)

但正如凯尔所说，你需要能够编辑你的 apache conf。

# c# - 使用 LinqToXml 插入 XElement 以包围另一个 XElement

> ID：938188
> 
> 赞同：1
> 
> 时间：2009-06-02T06:37:03.407
> 
> 标签：c#, linq-to-xml

假设我有以下 xml，

```
<Where><BeginsWith>...</BeginsWith></Where> 
```

现在我想“插入”一个`<And>`围绕 BeginsWith 子句的子句，所以它看起来像这样，

```
<Where><And><BeginsWith>...</BeginsWith></And></Where> 
```

如何使用 LinqToXml 实现这一点？

我基本上做的 Add 方法 **`where.Add(new XElement("And"))`**只会在 BeginsWith 之后添加“And”，就像这样，

```
<Where><BeginsWith>...</BeginsWith><And /></Where> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T06:47:44.490

*   获取 BeginsWith 元素
*   调用[`XNode.Remove()`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xnode.remove.aspx)它以将其从 Where 中删除
*   添加 And 元素
*   将 BeginsWith 添加到 And 元素（或创建 And 元素，使用它作为开始的内容）

例如：

```
using System;
using System.Xml.Linq;

public class Test
{
    public static void Main()
    {
        XElement where = XElement.Parse
            ("<Where><BeginsWith>...</BeginsWith></Where>");
        XElement beginsWith = where.Element("BeginsWith");
        beginsWith.Remove();
        where.Add(new XElement("And", beginsWith));
        Console.WriteLine(where);
    }        
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T06:47:43.227

我不知道有任何原子操作可以为您执行此操作。您可能必须添加“And”元素，然后在其中移动 BeginsWith 元素。

# jquery - Jquery Ajax 动画？

> ID：938190
> 
> 赞同：2
> 
> 时间：2009-06-02T06:37:44.590
> 
> 标签：jquery, ajax, animation

我有一个 ajax jquery 请愿书......有没有一种标准的方式可以在完成时显示一个漂亮的动画。

有人有任何信息吗？

当服务器出现错误时，请求大约需要 15 秒......所以我想在这种情况下显示动画......

我不一定是在谈论 jquery 动画方法，但可能是某种动画 gif ......或者什么

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T06:42:10.883

你想要这个：[http ://www.ajaxload.info/](http://www.ajaxload.info/)

使用它来生成与页面样式匹配的加载图像。

编辑：css/html 就像（注意：未测试）：

```
.container {
    position: relative;
    height: 20ex;
    width: 20em;
}

.hideCover {
    display:none;
}
.loadCover { 
    display:block;
    position:absolute;
    top:0;
    left:0;
    background-color:white;
    height:100%;
    width:100%;
    opacity:0.5;
    filter:alpha(opacity=50); 
    text-align:center;
} 

.loadCover > img { 
    position:relative;
    top: 10ex;
}

<div class='container'>
    <div id='receiver'>
       ...your area to load into ....
    </div>
    <div class='hideCover'>
         <img src='...path to loading image...' />
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T06:42:33.207

*   在你发帖之前，展示一个微调器（你可以在[www.ajaxload.info](http://www.ajaxload.info/)制作它们）
*   发布到服务器，当用户等待时，微调器正在旋转。
*   帖子完成后，隐藏微调器。

**编辑：** 我[在 StackOverflow 上发现了关于这个主题的另一个问题。](https://stackoverflow.com/questions/68485/how-to-show-loading-spinner-in-jquery)

# database - 如何说服某人规范化数据库？

> ID：938204
> 
> 赞同：16
> 
> 时间：2009-06-02T06:42:43.957
> 
> 标签：database, database-design, normalization

所以我一直在从事这个项目，我正在编写一个与我无法控制的数据库交互的 php 网站。该数据库是由一位在公司工作多年的同事“设计”的；所以最终决定留给他们决定。

当我第一次参与这个项目时，我去找同事并解释说数据库模式似乎有缺陷。我解释了规范化数据库以确保数据完整性问题、节省磁盘空间以及使程序员（我）的工作更轻松的重要性。我什至给出了当前设计中如何发生插入、删除和更新异常的示例。尽管如此，这位同事向我解释说，他们不想让项目的数据库过于复杂，而且它不会改变周期。

因此，现在我已经进入该项目几个月了，每次我必须加入两个表以在彼此具有一对一关系的属性中插入一个值时，我都会把头发拉出来。（所以属性应该只是主关系的一个属性。）数据库看起来很糟糕，而且我担心几年后这会再次出现在我身上，因为我编写了使用数据库的前端。

有人对如何说服“高级”同事正确设计数据库有任何建议吗？或者关于如何避免在我没有任何参与的设计的道路上获得光顾多年的任何建议？我应该拒绝在未来从事这样的项目吗？在我的代码中留下评论说数据库不是我做的？

谢谢。

编辑：回应评论的附加信息......

我知道数据库的非规范化对于提高速度很有用，所以我不会忽视这一点。对于那些没有听说过这种策略的读者，我将举例说明。数据库设计者通常有一个地址关系，列出了用户的街道、城市、州和邮政编码。虽然每个人都知道邮政编码决定了城市和州，因此构成了一个将邮政编码索引到城市和州的表。通常，数据库设计人员会将这两个表组合在一起，并预见到对用户地址的每个查询都需要从地址表到 zip 表的连接，从而对它们进行非规范化。这最终加快了查询过程，并且是对数据库设计部分进行非规范化的合理推理。

在这里填写一些细节，该数据库是为旅游请求系统设计的，因此其中的数据与访客信息、日期等有关。当前数据库使用的模式从头到尾都是不可预测的。从变量命名模式中最简单的不一致（例如：num_of_visitors、arrivalMethod 等）到为单个状态的一对一属性定义单独的关系。示例：statusID 表示游览请求的状态，它只能从一组可能的状态（已批准、拒绝、待定、取消）中选择一个有效状态。由于某种原因，数据库有一个状态表，其中包含：tour_id(Primary旅游关系的关键），状态ID。这允许为每个游览请求定义多个状态。根据设计，旅游请求在任何给定时间都应该只处于一种状态。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-02T06:51:40.817

根据我的经验，不幸的是，这些类型的情况往往最终成为无法取胜的战斗。您可以做一些事情来使自己远离设计：

*   在代码中实现数据访问层，尽可能多地抽象出实际的数据库设计。通过这种方式，您可以以更好的格式构建您的代码，并有效地“远离”自己使用和被指责为糟糕的数据库设计。
*   在数据库中创建视图以更符合逻辑的格式访问数据
*   当你有机会时，对表/代码进行小的重构，如果你能侥幸逃脱的话

我不会在代码中添加贬义的评论，因为它很可能会再次困扰您。在您的数据访问层中，您可以添加客观/非冒犯性的评论，解释您为什么要抽象出特定设计，以及如何以不同的方式设计它。

如果事情真的很糟糕，而且没有其他人会支持你，那么可能是时候寻找另一份工作了。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-02T06:48:05.520

换工作。

编辑：

简短的回答不是因为我在开玩笑或没有认真对待这个问题。我以前也遇到过这样的情况。坏数据库不是问题。问题是盲目或无知的管理。我的意思是，如果他们不知道或不在乎重要的技术决策是由不称职的人做出的，那么情况会更糟。就像走进沼泽一样。

认真考虑寻找新工作。对于开发人员来说，确实有很棒的工作场所。这个不是。你在浪费时间。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T09:59:02.983

您可能无法说服数据库设计人员重新设计数据库，尤其是当已经有大量代码针对现在存在的数据库编写时。

但是，您确实需要扩大词汇量来描述设计良好的数据库和设计不佳的数据库之间的区别。有很多糟糕的数据库设计不能仅仅通过规范化来解决。您给出的一个示例令人费解，因为当一个好的设计将数据放在同一个表中时，您必须连接来自不同表的数据。

分解一个应该保持组合的表通常不是规范化失败。几乎所有规范化失败都会导致组合表应该被分解。从你关于在更新异常方面指导她的评论中，我很确定你已经知道我可以教你关于正常形式的任何内容。

出于不良原因分解表，有时称为“超规范化”，是一种不同的设计缺陷。此缺陷引起的编程问题与归一化不足引起的编程问题非常不同。

有多少其他程序员开发了在同一个数据库上工作的代码？其他程序员对设计有何看法？如果他们真的很开心，那会进一步降低你改变事情的机会。如果它们都弯曲变形，您可以通过在数量上找到力量来说服设计师。我知道，我知道，这就是政治，我敢打赌你讨厌政治。

当我过去教程序员有关数据库编程和设计的时候，学生们经常会问为什么在数据库工作中有这么多政治。我最终想出了一个简单的答案：

当数据库被广泛使用时，就会发生数据共享。这意味着知识共享。知识就是力量。当权力被分享时，政治就会发生。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-02T18:07:18.630

查找由非规范化引起的错误。如果数据库没有合适的约束（我猜在这种情况下不会），**就会**存在这样的错误。我会把钱放在上面。如果您正在使用错误跟踪器，请查看那里。如果没有，请自行解决。无论哪种方式，您都可以展示此类错误可能造成多大的损害，以及清理它们的成本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-02T06:52:40.237

也许您可以指定您需要对这个数据库执行的操作，并建议她将它们实现为数据库中的存储过程？......绝对会把问题放在它所属的地方......与导致它的人。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-02T06:54:49.720

最积极的方式是与同事合作，并尝试发展和教育他们的思维方式。也许讨论你过去犯过的错误会很容易打破僵局，并向他/她展示设计不佳的系统的影响。

如果您过去没有太多糟糕的经历来帮助您，那么我建议您记录完成特定任务/缺陷需要多长时间（时间或金钱）。然后，您可以生成统计数据，所有经理都喜欢图表，该图表有望显示随着时间的推移添加功能或解决缺陷所需的时间长度如何增加。

希望这可以帮助。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-02T07:09:58.300

试图将设计不佳的数据库隐藏在一个层后面只是一种“hack”，而 IMO 应该是 B 计划。对于 A 计划，我会尝试“升级”到更高级别。

正如您所描述的，您无权影响弄乱数据库的人。然后我会去找架构师（假设有），如果没有架构师，我会去找项目经理。

用有据可查的事实来支持你的论点是非常重要的，这些事实证明了糟糕的设计已经对你正在构建的系统产生了影响。其他事实可能是来自专业数据库社区的糟糕设计数据库的众所周知的问题。

我没有关于您的情况的足够信息，但这是我在面对坚持设计糟糕的技术解决方案的客户时通常会尝试做的事情。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-02T07:11:57.360

通常情况下，开发人员需要与请求荒谬事物的客户合作，或者需要维护/使用设计非常糟糕的遗留代码。当然，您应该尝试说服/教育您的同事应该如何设计数据库，但您的主要工作应该是提供最优质的源代码。通常情况下，需要处理这种情况。

我建议按照已经给出的建议在数据库周围创建一个层。用诸如“做这个复杂的事情，因为 db 表 1 和 2 未标准化”之类的注释填充它。不要在评论中提出批评。保持他们严格的技术。偶尔与您的同事/经理讨论数据库设计。买一本相关的书，放在某个地方让大家看。当有人要求时，提出借给它。不过，您的主要努力应该是编写好的代码。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-02T07:15:33.547

带他们去地下室。让他们选择携带一张大沙发或四把小椅子：）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-02T07:16:12.577

当她说她不想使数据库过于复杂时，也许她的意思是她不知道或不具备规范数据库的能力。在这种情况下，一种方法是尝试让她相信规范化的好处，并让她学习数据库规范化。规范化的一个原因是仅仅创建一个数据库并不是数据库的唯一要求。数据库之所以存在，是因为它用作数据存储。什么存储数据？应用软件。因此，数据库创建者应该非常尊重软件开发人员，以使她对数据库进行规范化。否则，这将是一个非常尴尬的情况。为了使事情变得简单，您可以首先展示一些更简单的规范化操作来开始使用它。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-07-09T15:00:16.333

向高级管理人员展示这个问题。这将向他们表明，某种形式的规范化不仅仅是数据库的某种“复杂性”，而是绝大多数有能力的开发人员认为是基本的标准程序。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-02T07:02:32.137

这个问题可以改写为包括任何设计和实现，而不管问题域如何。

当你遇到这样的情况时，这是一个令人沮丧的巨大原因。幸运的是，我没有多次参与这些，并且我能够在很大程度上避免受到影响的 SW 部分。或者构建一个中间层，允许您使用更健全的数据库布局。

如果高级设计师和管理人员不关心/不理解，通常也没什么可做的。任何时候需要对已经存在了一段时间的 sw 进行任何更改都是一样的。由于各种心理原因，首先要让设计系统的人批准更改通常是不可能的，除非您是上级并且可以“强制”解决问题。即使那样，在某些情况下它也可能不可行（您可能最终需要对您的软件进行太多更改）。

但是，一种可能性是，如果您有特定的问题，例如性能。如果您可以证明更好的数据库设计可以解决这些问题，您就可以取得一些进展。

# kernel - Linux 内核中的 set_memory_* 函数 >=2.6.25

> ID：938207
> 
> 赞同：0
> 
> 时间：2009-06-02T06:45:47.617
> 
> 标签：kernel, rootkit

我正在研究 Rootkit，我收到了很多警告，例如`

```
"BUG: unable to handle kernel paging request at [addr]" 
```

例如，当我尝试将自己的功能附加到`sys_call_table[__NR_read]`.

在内核 <=2.6.25 中，函数`change_page_attr()`有助于更改某个地址的页面属性。但是，在 >=2.6.28 的新内核中，此函数已被弃用，并被替换为`set_memory_*`与 PAT 相关的函数。

Linux 内核文档并不清楚 PAT 函数的使用；我已经使用`set_memory_wc()`&`set_memory_uc()`来更改`sys_call_table`权限，但我继续收到相同的 BUG。我猜这些功能正在取代旧的`change_page_attr()`.

我在 i915 模块中看到了一个示例，并且我以相同的方式使用了函数，但 BUG 仍在继续。

有什么帮助吗？我是否以错误的方式处理内核地址？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-01T17:41:07.100

我已经用 2.6.26 和 2.6.30 的 debian 内核进行了测试。

对于 2.6.26`set_memory_wc`并通过`set_memory_wb`工程恢复。

`CONFIG_DEBUG_RODATA`如果有内核黑客（我认为），2.6.30 不起作用。还没有时间实际重新编译，但我已经用没有那个的自定义内核进行了测试。

在 2.6.30 中`set_memory_rw`并且`set_memory_ro`也被导出。

希望这可以帮助。

# django - 根据用户选择更改选项

> ID：938209
> 
> 赞同：0
> 
> 时间：2009-06-02T06:46:47.537
> 
> 标签：django, django-admin, django-views

在我的课堂上，我有大约**12 个字段**。一个是**地位**，另一个是**理由**。当我进入 django admin 中的编辑页面时，如果 status=='rejected'，我只想显示第二个字段（原因字段）。问题很简单：只根据用户输入显示字段。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T07:56:28.457

不幸的是，没有简单的方法可以在纯粹的服务器端做到这一点。但是，使用一些 JavaScript 应该相对容易完成——根据状态切换原因字段的可见性。下面是一个使用 jQuery 的例子：

```
$(document).ready(function() {
    // Toggle visibility on page load
    setReasonVisibility();

    // Toggle visibility on status change
    $('form #id_status').bind('change', setReasonVisibility)

    function setReasonVisibility() {
        var form = $('form');
        var status = $(form).find('#id_status').val();
        if (status == 'rejected') 
            $(form).find('#id_reason').show();
        else
            $(form).find('#id_reason').hide();
    }
}); 
```

要让表单加载 JavaScript 文件，您需要在`Media`类中将其引用到模型的表单中，如下所示：

```
class YourModelForm(forms.ModelForm):
     class Meta:
         model = YourModel
     class Media:
         js = ('path/to/jquery.js', 'path/to/your-js-file.js') 
```

此解决方案应该在 Django 管理员中无缝运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T15:23:43.123

我不清楚您是指更改*列表*还是项目的单个编辑页面。如果是后者，@Guðmundur H 有一个很好的 jQuery 解决方案。如果是前者，您可以通过在模型上提供一个方法**reason_if_rejected**来实现，如果状态为“拒绝”则返回原因，否则返回空字符串。然后，您可以在**list_display**设置中包含此方法的名称。

# android - 如何以编程方式区分 android Activity 和 SubActivity？

> ID：938215
> 
> 赞同：4
> 
> 时间：2009-06-02T06:48:15.660
> 
> 标签：android, android-activity

如何以编程方式区分 android Activity 和 SubActivity？有任何API吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T10:13:03.967

我假设您指的是检测活动是否通过`startActivityForResult()`。

在这种情况下，请尝试`getCallingActivity()`. 引用[文档](http://developer.android.com/reference/android/app/Activity.html#getCallingActivity())，“注意：如果调用活动不期望结果（即它没有使用`startActivityForResult(Intent, int)`包含请求代码的表单），那么调用包将为空。”

# windows - 如何为 Win32 应用程序中的所有窗口设置默认字体？

> ID：938216
> 
> 赞同：14
> 
> 时间：2009-06-02T06:48:15.940
> 
> 标签：windows, winapi, mfc, fonts

我希望我的应用程序中的所有控件（编辑、列表控件等）都具有相同的字体，这不是系统默认的。我该怎么做呢？是否有任何设置应用程序默认字体的 Win32 API？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-06-12T21:13:09.123

实现这个：

```
 bool CALLBACK SetFont(HWND child, LPARAM font){
        SendMessage(child, WM_SETFONT, font, true);
        return true;
    } 
```

在单独的文件中或仅在 main.cpp 中，然后运行：

```
EnumChildWindows(hwnd, (WNDENUMPROC)SetFont, (LPARAM)GetStockObject(DEFAULT_GUI_FONT)); 
```

whenever you want, for example in the `WM_CREATE` message, after you've created all your child windows!

I always have a `SetFont.cpp` and a `SetFont.h` in my win32 GUI application solutions.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-02T13:47:26.330

Windows 不为应用程序范围的字体提供任何机制。每个窗口类可能有自己的行为来选择默认使用的字体。它可能会尝试选择 Windows shell 对话框使用的字体，或者它可能只是使用自动选择到新 DC 中的可怕的位图“系统”字体来绘制其文本。

Windows 常用控件窗口类都响应[`WM_SETFONT`](http://msdn.microsoft.com/en-us/library/ms632642(VS.85).aspx)，这是标准的窗口消息，用于告诉窗口您希望它使用什么字体。当您实现自己的窗口类（尤其是新的子控件窗口类）时，您还应该为以下内容编写处理程序`WM_SETFONT`：

1.  如果您的窗口类有任何子窗口，您的`WM_SETFONT`处理程序应该将消息转发给每个子窗口。
2.  如果您的窗口类执行任何自定义绘图，请确保将您收到的 HFONT 保存在您的`WM_SETFONT`处理程序中，并将其选择到您在绘制窗口时使用的 DC 中。
3.  如果您的窗口类被用作顶级窗口，它需要逻辑来选择自己的字体，因为它没有父窗口来向它发送`WM_SETFONT`消息。

请注意，对话管理器会为您完成其中的一些工作；实例化对话框模板时，新对话框的字体设置为模板中指定的字体，并且对话框发送`WM_SETFONT`其所有子控件。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-04-09T17:01:55.480

是的你可以 ！

```
HFONT defaultFont;
defaultFont = (HFONT)GetStockObject(DEFAULT_GUI_FONT);
SendMessage(handlerControl, WM_SETFONT, WPARAM (defaultFont), TRUE); // Send this to each control 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-06T11:21:56.103

一种在一次调用中为所有子窗口设置字体的便捷方法：

```
SendMessageToDescendants( WM_SETFONT, 
                          (WPARAM)m_fntDialogFont.GetSafeHandle(), 
                          0 ); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T08:11:47.177

你不能，没有办法同时对所有控件执行此操作。您需要按照之前的建议通过资源编辑器进行设置，或者在每个控件上手动调用 SetFont()。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-02T07:14:44.220

您可以通过资源视图为每个对话框设置字体。右键单击对话框（而不是其他控件），选择属性和字体选项。

# c# - c# 报告

> ID：938217
> 
> 赞同：0
> 
> 时间：2009-06-02T06:49:15.517
> 
> 标签：c#, .net

大家好，请告诉我如何在 c# 中使用报告，特别是 rdlc，请解释其架构，如果可能，请发布一些示例代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T07:11:34.460

这是一篇关于这个主题的很好的插图文章：

[使用 ssrs 创建独立 .rdlc 报告的初学者指南](http://www.c-sharpcorner.com/UploadFile/robo60/StandaloneRDLCReports11142007183516PM/StandaloneRDLCReports.aspx)

# oop - 高级编程语言是否倾向于面向对象，而低级语言是面向过程的？

> ID：938223
> 
> 赞同：1
> 
> 时间：2009-06-02T06:51:47.463
> 
> 标签：oop, procedural-programming

我只是对那里的所有语言类型有点困惑。与面向对象/过程的区别相比，高级/低级语言区别有什么区别？许多类比看起来很相似。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T06:59:23.220

高/低级别的区别更多地是关于抽象而不是范式。通常，您越“低”，您就越需要了解正在运行的机器——它的内存、文件系统，甚至处理器指令集。

高级语言在您和机器之间放置了一层抽象。它处理血腥的细节。这既好又坏。抽象消除了一些担忧，但也消除了控制。

高级语言可以是过程式的、面向对象的、函数式的等等……

低级语言可能不提供像面向对象这样的概念，因为面向对象是一种抽象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T07:01:21.780

高级/低级是指语言与汇编程序和机器代码的感知“接近”（汇编程序是低级的，C 被视为低于 C++ 或 Java 等）。

OO 和过程编程是为支持某种程序设计方式（称为编程范式）而提供的语言工具。它们与语言是高级还是低级无关，因为 OO 语言往往不是低级的，因为汇编程序不了解对象和类。还有很多其他的范例，比如函数式编程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-02T09:42:58.323

并不真地。

例如，c++ 是面向对象的，而且级别相当低。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T07:00:42.220

这两个轴（“范式”和“级别”）之间不一定有任何因果关系，但我认为相关性是逻辑和函数语言往往是最高级别的，紧随其后的是面向对象的语言，通常是过程语言低等级。

这不是问题的一部分，但我也认为相关的动态类型语言往往比静态类型语言更高级别。

我认为对于某人来说，在三个轴上绘制编程语言的三维散点图可能是一个有趣的可视化：范式（逻辑/功能/oo/过程）类型（静态/动态）和级别（参见例如“代码完成” ' 用于衡量水平的各种指标）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T07:04:35.207

“高水平”和“低水平”是人们可能不同意的有些模糊的术语。您可以通过您必须编写多少代码来完成特定任务来查看编程语言提供的抽象量，然后将需要较少代码的语言称为更高级别。当然，那么您需要一种测量代码大小的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-30T02:02:35.747

我认为这里可以做一个很好的类比。

面向对象的语言确实往往比纯功能语言的级别更高。看看 c++ 和 c。是的，正如 docesam 所提到的，c++ 仍然相当低级，但是 c++ 仍然比它的纯粹功能性的哥哥 c 更高。

不，它并不总是那么简单，因为面向对象并不是使语言成为高级语言的唯一因素，但它绝对是一个指标，因为面向对象意味着对真正的原始机器指令有更多的抽象。

但是面向对象不足以确定哪种语言是最高级别的。

我会看以下几点：

*   该语言有静态类型还是动态类型？（Javascript 和 Python 与 Java 和 c++）
*   面向对象还是不面向对象？（c 与 c++）
*   纯文本宏或模板？（c 与 c++）
*   动态绑定 vs 静态绑定（同样是 Javascript & Python vs Java & c++）
*   该语言是否支持命名函数，还是必须使用换行符？
*   语言是否允许评论之类的东西？
*   还有很多

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-06-02T07:56:17.333

我喜欢这么说——这一切都归结为机器指令集。因此，无论某些东西表示多么高级，它仍然归结为机器指令。因此，高级语言是思想的抽象，而低级语言则更接近硬件。

类比是相似的，因为它都归结为一件事——机器代码！

# vb.net - 如何读取连接字符串

> ID：938224
> 
> 赞同：1
> 
> 时间：2009-06-02T06:51:54.373
> 
> 标签：vb.net

这不起作用..有什么想法吗？

```
ConfigurationManager.ConnectionStrings("YourConnectionString").ConnectionString 
```

错误

“未声明配置管理器”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T06:53:51.110

你有

```
Imports System.Configuration 
```

在你的代码中？以及对您项目中的程序集的引用`System.Configuration`？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T06:55:19.187

和...

您是否添加了对 System.Configuration 程序集的引用？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T06:55:47.063

此外，您可能需要添加对`System.Configuration`.

# jquery - jQuery / JS 动画搞砸了 (Firefox/IE)

> ID：938227
> 
> 赞同：0
> 
> 时间：2009-06-02T06:53:47.600
> 
> 标签：jquery, browser

编辑：

问题似乎不仅限于 IE，请参阅下面的我的回答帖子以获取测试用例。

您好，我在徽标上的 3 个不同背景图像之间旋转：

```
$(function() {

    function Animate_2() {

        $("div#bg1" ).animate({opacity: 0 }, 2000);
        $("div#bg2").animate({opacity: 100}, 2000);

        setTimeout(Animate_3, 5000);

    }

    function Animate_3() {

        $("div#bg2").animate({opacity: 0  }, 2000);
        $("div#bg3").animate({opacity: 100}, 2000);

        setTimeout(Animate_1, 5000);

    }

    function Animate_1() {

        $("div#bg3").animate({opacity: 0  }, 2000);
        $("div#bg1").animate({opacity: 100}, 2000);

        setTimeout(Animate_2, 5000);

    }

    /* Start it */
    setTimeout(Animate_2, 5000);

}); 
```

bg1 到 bg3 具有以下样式：

```
div#bg1 {
    height:             159px;
    width:              800px;
    margin-left:        auto;
    margin-right:       auto;
    background-image:   url('images/bg_1.jpg');
    background-repeat:  no-repeat;
    background-position:center center;
    position:           relative;
    z-index:            3;
}

div#bg2 {
    height:             159px;
    width:              800px;
    margin-left:        auto;
    margin-right:       auto;
    background-image:   url('images/bg_2.jpg');
    background-repeat:  no-repeat;
    background-position:center center;
    position:           relative;
    z-index:            2;
    margin-top:         -159px;
}

div#bg3 {
    height:             159px;
    width:              800px;
    margin-left:        auto;
    margin-right:       auto;
    background-image:   url('images/bg_3.jpg');
    background-repeat:  no-repeat;
    background-position:center center;
    position:           relative;
    z-index:            1;
    margin-top:         -159px;
} 
```

IE 对第一个动画效果很好，bg1 很好地淡出，而 bg2 淡入...在第一次完美过渡之后，它在 IE（所有版本！）中搞砸了，而它在 Firefox、Chrome、Safari 和 Opera 中运行良好。

在 IE 中，图像确实发生了变化，但它没有正确淡出/淡入...

通过IETester运行它时，我不断得到沙漏光标，就好像它正在动态下载背景图像......

谁能帮我这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T13:20:39.987

你可能想尝试这样的事情：`

```
 $(function()
        {setTimeout(dostuff, 1000);});
         function dostuff(){
  $("div#bg1").animate({opacity: 100}, 1000).animate({opacity: 100}, 1000).animate({opacity: 0}, 1000).animate({opacity: 0}, 1000).animate({opacity: 100}, 1000);
  $("div#bg2").animate({opacity: 0}, 1000).animate({opacity: 0}, 1000).animate({opacity: 100}, 1000).animate({opacity:100}, 1000).animate({opacity: 0}, 1000);dostuff()} 
```

`

关于 jquery 的一件事是你可以链接东西。我认为这样做最简单，也更容易理解和调试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T12:45:43.707

我现在已经设法在 Firefox 上产生了这种行为，代码如下：

```
<html>
    <head>
        <style type="text/css">
            div#bg1 {
                height:             159px;
                width:              800px;
                margin-left:        auto;
                margin-right:       auto;
                background-image:   url('images/bg1.jpg');
                background-repeat:  no-repeat;
                background-position:center center;
                position:           relative;
                z-index:            3;
            }
            div#bg2 {
                height:             159px;
                width:              800px;
                margin-left:        auto;
                margin-right:       auto;
                background-image:   url('images/bg2.jpg');
                background-repeat:  no-repeat;
                background-position:center center;
                position:           relative;
                z-index:            2;
                margin-top:         -159px;
            }
        </style>
        <script type="text/javascript" src="http://jqueryjs.googlecode.com/files/jquery-1.3.2.min.js"></script>
        <script type="text/javascript">
            function Animate_2() 
            {
                $("div#bg1").animate({opacity: 100}, 2000);
                $("div#bg2").animate({opacity: 0  }, 2000);
                setTimeout(Animate_1, 5000);
            }

            function Animate_1() 
            {
                $("div#bg1").animate({opacity: 0  }, 2000);
                $("div#bg2").animate({opacity: 100}, 2000);
                setTimeout(Animate_2, 5000);
            }

            $(function()
            {
                /* Start cycle */
                setTimeout(Animate_1, 5000);
            });
        </script>
    </head>
    <body>
        <div id="bg1"></div>
        <div id="bg2"></div>
    </body>
</html> 
```

起初动画一切都很好而且花花公子，但它只是改变了 animate_2() 的图像（没有动画！）......

# c++ - PCRE中的匹配顺序

> ID：938230
> 
> 赞同：0
> 
> 时间：2009-06-02T06:54:20.517
> 
> 标签：c++, c, regex, pcre

如何设置匹配 PCRE 正则表达式中的内容的顺序？

我有一个用户可以提供的动态正则表达式，用于从字符串中提取两个值并将它们存储在两个字符串中。但是，在某些情况下，这两个值可以以相反的顺序出现在字符串中，因此第一个 (\w+) 或任何需要存储在第二个字符串中的值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T07:06:53.143

您可以使用按名称提取字符串

```
(?<name>\w+) 
```

并获得价值

```
pcre_get_named_substring 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T13:26:05.153

如果您将两个部分与相同的子模式（如`\w+`）匹配，那么您就不走运了。但是如果子模式明显不同，你有几个选择，它们都不是很漂亮。这是一个正则表达式，它使用条件构造以任一顺序匹配 HTML 脚本元素的`src`和属性：`type`

```
\b(?(?=src=)
  src="([^"]*)"\s+type="([^"]*)"|
  type="([^"]*)"\s+src="([^"]*)"
) 
```

（免责声明：这个正则表达式做了许多不切实际的假设，其中主要是两个属性都将存在并且它们将彼此相邻。我只是用它来说明该技术。）

如果`src`属性首先出现，则`src`和`type`值将分别在第一组和第二组中捕获。否则，它们将分别出现在第四组和第三组。命名组可以更容易地跟踪事物，特别是如果可以像在 .NET 正则表达式中那样在多个地方使用相同的名称。不幸的是，PCRE 要求每个命名组都有一个唯一的名称，这太糟糕了；这是一个非常好的功能。

# sql - 子集上的 SQL 透视

> ID：938232
> 
> 赞同：1
> 
> 时间：2009-06-02T06:54:34.073
> 
> 标签：sql, tsql, pivot

我有以下结果集：

> 类型 | 方法 | 数量
> 
> Type1 现金金额
> Type1 支票金额
> Type2 现金金额
> Type2 支票金额
> Type3 现金金额
> Type3 支票金额

我想让它看起来像这样：

> 类型 | 现金 | 查看
> 
> 类型1金额 金额 类型2 金额
> 金额类型
> 3 金额 金额

如何在 T-SQL 中实现这一点（2005 语法正常）？我需要按类型旋转 (1, 2, 3...)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T07:12:00.433

这是 PIVOT 的尝试：

```
select *
from YourTable
PIVOT (sum(amount) FOR Method in (Cash,Check)) as Y 
```

鉴于它只有两列，可以尝试连接：

```
select
    type
,   cash = a.amount
,   check = b.amount
from yourtable a
full join yourtable b on a.type = b.type
where a.method = 'cash' or b.method = 'Check' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T05:48:55.010

或者更好：

```
select
  Type
, Cash  = sum(case when Method = 'Cash'  then Amount end)
, Check = sum(case when Method = 'Check' then Amount end) 
from yourtable
group by 
  Type 
```

如果合适，将 ELSE 0 添加到 CASE 语句中。

这种形式比 PIVOT 运算符更灵活，不需要 FULL JOIN。只是直接聚合。

# excel - 将数据集导出到 Excel ASP.Net

> ID：938238
> 
> 赞同：1
> 
> 时间：2009-06-02T06:56:02.587
> 
> 标签：excel, dataset

我需要将数据集导出到 Excel，导出它不是主要问题，当我使用以下连接字符串 CS = "provider=Microsoft.Jet.OLEDB.4.0;" & _ "data source=" 使用相同的导出 Excel 文件时+ FilePath + ";扩展属性=Excel 8.0;"

它给了我一条错误消息，说外部表格式不正确

需要帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T07:04:23.100

您可以通过更改 Response.ContentType“application/vnd.ms-excel”以更好的方式执行此操作，尤其是因为您使用的是 ASP.NET 而不是 winforms。

查看这篇文章，了解有关[将数据集转换为 excel的完整详细信息](http://www.dotnetjohn.com/PrintFriend.aspx?articleid=36)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T18:38:34.960

当您执行 Response.ContentType “application/vnd.ms-excel”时。
您可以只生成一个 html 表。
Excel 会选择它并打开它并自动将 HTML 转换为 excel。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-05T22:26:35.250

这是我写的一篇博文，说明了将数据从 SQL 获取到 Excel 的一些不同选项： [http ://www.officewriter.com/blog/2011/09/23/exporting-sql-server-database-data-excel](http://www.officewriter.com/blog/2011/09/23/exporting-sql-server-database-data-excel)

如果您使用的是 ASP.NET，则您的选择会受到更多限制，因为您需要既可编程又可扩展/适合服务器使用的东西，例如 OfficeWriter。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T12:18:51.227

[嗨，我在这里](http://msmvps.com/blogs/deborahk/archive/2009/07/23/writing-data-from-a-datatable-to-excel.aspx)找到了一个完美的解决方案

只需在代码中将 'missing.value' 替换为 System.Type.Missing 即可。同时删除

```
oWB.Close(System.Type.Missing, System.Type.Missing, System.Type.Missing); 
```

和

```
oXL.Quit(); 
```

从代码。否则，您的 Excel 一打开就会自动关闭。

# c++ - C++ Qt：按位运算

> ID：938239
> 
> 赞同：4
> 
> 时间：2009-06-02T06:56:50.870
> 
> 标签：c++, qt, bit-manipulation

我正在为大学做一个小项目，我需要对网络传输进行建模，并实现和可视化不同类型的纠错算法。我的即兴数据包由一个quint8组成：我需要将它转换为一个位数组，如QBitArray，附加一个校验位，通过UDP传输，用校验位检查传输是否成功，然后从中构造quint8 . 再一次，这不是一项实用但有教育意义的任务，所以不要建议我使用像 CRC 这样的真正算法......

所以我的问题是：**如何将任何数据类型（在本例中为 quint8）转换为 QBitArray？**我的意思是计算机中的任何数据都是一个位数组，但我如何访问它是个问题。

谢谢，德米特里。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T08:05:11.310

让我们看看我们能不能把它弄对

```
template < class T >
static QBitArray toQBit ( const T &obj ) {
    int const bitsInByte= 8;
    int const bytsInObject= sizeof(T);

    const quint8 *data = static_cast<const quint8*>(&obj) ;
    QBitArray result(bytsInObject*bitsInByte);
    for ( int byte=0; byte<bytsInObject ; ++byte ) {
        for ( int bit=0; bit<bitsInByte; ++bit ) {
            result.setBit ( byte*bitsInByte + bit, data[byte] & (1<<bit) ) ;
        }
    }
    return result;
}

void Foo () {
    Bar b ;
    QBitArray qb = toQBit ( b ) ;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T07:28:52.990

qint8 实际上是带符号的字符。因此，您可以将 objs 视为 char 数组。

```
template < class T >
QBitArray toQBit ( T &obj ) {
    int len = sizeof(obj) * 8 ;
    qint8 *data = (qint8*)(&obj) ;
    QBitArray result ;
    for ( int i=0; i< sizeof(data); ++i ) {
        for ( int j=0; j<8; ++j ) {
            result.setBit ( i*8 + j, data[i] & (1<<j) ) ;
        }
    }
    return result;
}

void Foo () {
    Bar b ;
    QBitArray qb = toQBit ( b ) ;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T08:50:13.230

我认为声明模板函数然后将其参数转换为 uint8 没有任何意义。可提升为 unsigned long 类型的解决方案

```
#include <bitset>
template <typename T>
QBitArray toQBit(T val) {
    std::bitset<sizeof(T) * 8> bs(val);
    QBitArray result(bs.size());
    for (int ii = 0; ii < bs.size(); ++ii) {
        result.setBit(ii, bs.test(ii));
    }
    return result;
} 
```

没有办法将任何数据类型一般地转换为位数组。特别是如果您的数据类型包含指针，您可能想要传输指针而不是指针。所以任何复杂的类型都应该分开处理。并注意不同架构中的不同字节序（小字节序和大字节序）。根据这个问题，我认为 std::bitset 是安全的，但是例如将指向 struct 的指针转换为 char 数组并存储其位可能不安全。

# c - 如何从内存使用中随机种子？

> ID：938241
> 
> 赞同：0
> 
> 时间：2009-06-02T06:59:05.687
> 
> 标签：c, windows, random

在 Windows 中，我想用种子生成随机数：时间 + 内存使用情况。我想从 taskmgr 中出现的物理内存系统缓存中获取内存使用情况。
那么，如何在 c（windows 而不是 .net）中获取物理内存系统缓存？随机种子最终可能是这样的：

`srand((unsigned int)(time(0)+ memSystemCache) );`

这可能是从 compile-time 获取内存使用情况，这对我来说没问题。可能吗？
提前Tnx。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T07:15:01.690

由于您使用 Win32，我会推荐[CryptGenRandom](http://en.wikipedia.org/wiki/CryptGenRandom)而不是 srand/rand。

# c# - 如何对创建新流程的代码进行单元测试？

> ID：938249
> 
> 赞同：5
> 
> 时间：2009-06-02T07:02:29.970
> 
> 标签：c#, unit-testing, tdd

如何测试以下方法？

它是接口的具体类实现的方法。

我`Process`用一个只公开我需要的方法和属性的接口包装了这个类。该类`ProcessWrapper`是该接口的具体实现。

```
 public void Initiate(IEnumerable<Cow> cows)
    {
        foreach (Cow c in cows)
        {
            c.Process = new ProcessWrapper(c);
            c.Process.Start();
            count++;
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T07:11:31.213

有两种方法可以解决这个问题。首先是使用依赖注入。您可以注入一个工厂并让 Initiate 调用 create 方法来获得测试所需的 ProcessWrapper 类型。

另一种解决方案是使用诸如 TypeMock 之类的模拟框架，它可以让您解决这个问题。TypeMock 基本上允许您模拟任何东西，因此您可以使用它来提供模拟对象而不是实际的 ProcessWrapper 实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T07:13:44.830

我不熟悉 C#（我更喜欢没有哈希的 C#），但您需要某种进程接口（IPC 或任何最方便的方法），以便您可以向它发送测试请求并返回结果。在最简单的级别上，您只需向进程发送消息并接收结果。或者你可以有更多的粒度并从你的测试工具中发送更具体的命令。这取决于您如何设置单元测试环境，更准确地说，您如何发送测试命令、如何接收它们以及如何报告结果。

我个人会在进程中有一个测试对象，它只是接收、运行和报告单元测试结果，并在该对象中包含测试代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T07:12:29.870

你的流程是做什么的？有什么方法可以检查它是否正在做它应该做的事情？例如，它可能会写入文件或数据库表。或者它可能会公开一个 API（IPC、Web 服务等），您可以尝试使用测试数据调用该 API。

从 TDD 的角度来看，插入一个“模拟/测试过程”来执行一些您可以轻松检查的操作可能是有意义的。（这可能需要更改代码以允许您的测试代码注入一些东西。）这样，您只测试您的调用代码，而不是测试实际的业务流程。然后，您可以进行不同的单元测试来测试您的业务流程。

# apache - 解析来自 Apache 的 HTTP_COOKIES 字符串以在 #if 子句中使用

> ID：938251
> 
> 赞同：1
> 
> 时间：2009-06-02T07:03:13.587
> 
> 标签：apache, http, cookies, ssi

我希望能够从 Apache 的 HTTP_COOKIE 字符串中读取 cookie，然后根据该字符串的内容添加包含。

我已经做到了这一点：

```
<!--#set var="cookies" value="HTTP_COOKIE" -->
<p>COOKIES:  <!--#echo var="$cookies"--></p> 
```

这给了我一个包含所有 cookie 的字符串。

现在我希望能够将字符串解析为`Name=Bob`.

我以为我可以做到这一点：

```
<!--#if expr="$cookies = /Name=([a-zA-Z]+)/"-->
<p>Your name is <!--#echo var="$1"--></p>
<!--#endif--> 
```

但这似乎不起作用。我应该怎么做——或者这不可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T06:05:03.097

这绝对是可能的——见`get_include_var`.`mod_include.c`

也许您的正则表达式需要一些调整。

# windows - 我可以在多处理器机器上禁用一个或多个处理器吗？

> ID：938252
> 
> 赞同：2
> 
> 时间：2009-06-02T07:03:42.603
> 
> 标签：windows, testing

我有两个四核处理器的服务器，安装了 windows 2003 标准版。我想在具有单个四核处理器的机器上测试应用程序，并且我想使用这台机器，那么如何禁用两个处理器之一？

我更喜欢软件解决方案，但如果唯一的解决方案是硬件也没问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T07:06:12.160

快速而肮脏：使用任务管理器，选择进程，然后使用关联位禁用该进程所需的任何核心。

对调试也非常有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T07:10:23.447

或者，您可以从应用程序本身（如果合适）使用`Process.ProcessorAffinity`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T07:07:52.627

您可以将正在运行的进程/应用程序的“亲和力”设置为仅在一个核心上执行：

转到任务管理器，选择有问题的进程，右键单击并选择“设置亲和力”，然后只选择一个核心。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T07:08:15.790

该解决方案通常用于测试需要依赖这些要求的应用程序是 VMware（或等效的虚拟机软件，例如 Vitrual Box 等）

这是测试依赖于硬件环境的应用程序的正确解决方案，因为您可以分配 CPU 和内存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T08:34:11.000

编辑 boot.ini，添加 /NUMCPU=1，然后重新启动。这将指示 Windows 忽略除一个内核/CPU 之外的所有内核/CPU。

# sql-server - 如何仅在 sqlserver 中显示用户数据库？

> ID：938259
> 
> 赞同：2
> 
> 时间：2009-06-02T07:06:42.753
> 
> 标签：sql-server, sql-server-2005

如何在sqlserver中显示用户数据库

我查询为 select sys.databases 它显示所有，包括 msdb temp 和所有。

我只需要用户创建的数据库。

有没有类似的查询： select * from sys.databases where type='u' ??

帮我。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T07:15:38.803

是否有理由需要比这更先进？

```
SELECT * FROM sysdatabases WHERE name NOT IN('master', 'tempdb', 'model', 'msdb') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-07-28T09:16:23.107

你应该用他们的`owner name`. 为此，您应该`sys.databases`加入`sys.server_principals`.

最近的版本可以具有 ReportServer 数据库以及包含`$`登录名。

```
select
  d.name
  ,d.database_id
from
  sys.databases d
join
  sys.server_principals p
  on p.sid = d.owner_sid
where
  p.name <> 'sa' and d.name not like '%$%'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T07:26:39.047

或根据此[线程](http://social.msdn.microsoft.com/Forums/en-US/transactsql/thread/4f394da7-3596-4b59-9caa-ecc8443fc9e8)：

```
select * from sys.sysdatabases where dbid>4 and [name] not like '$' 
```

# matlab - 在 Matlab 中比较两个矩阵

> ID：938260
> 
> 赞同：14
> 
> 时间：2009-06-02T07:06:51.380
> 
> 标签：matlab, comparison, floating-point, matrix

我有两个矩阵 x 和 y，它们都是来自不同算法/例程的结果，它们应该计算相同的结果。虽然我知道 isequal() 会检查 x 和 y 是否是同一个矩阵，但这些矩阵中的条目不会完全相同（即，在最坏的情况下，某些条目可能会享受 5% 的折扣）。在这种情况下，比较它们以查看它们是否足够接近以被视为相同结果的最佳方法是什么？提前感谢您的建议。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-02T07:15:29.660

试试这个：

```
tf = abs((A-B)./B)<0.05 
```

这将返回一个逻辑矩阵，如果 A 和 B 相对于 B 的相对差异小于 5%，则该逻辑矩阵对于每个元素都是正确的。

如果要问这些是否都为真（都满足上述条件）：

```
all(tf(:)) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T19:48:46.567

修改[Edric 的](https://stackoverflow.com/questions/938260/comparing-two-matrices-in-matlab/938474#938474)解决方案：

```
absTol = 1e-3;   % You choose this value to be what you want!
relTol = 0.05;   % This one too!
absError = x(:)-y(:);
relError = absError./x(:);
relError(~isfinite(relError)) = 0;   % Sets Inf and NaN to 0
same = all( (abs(absError) < absTol) & (abs(relError) < relTol) ); 
```

*如果任何*元素的绝对误差*或*相对误差大于您选择的任何容差，则变量**same**将为假。此外，如果**x**的任何元素恰好为 0，则**relError**的某些元素最终可能是无限的或非数字，因此我使用[ISFINITE](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/isfinite.html)函数通过将它们设置为 0 来忽略这些值。

 ******我不建议使用[IMAGESC](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/imagesc.html)来比较绘图，因为 1) 数据在显示时被缩放，2) 显示器的颜色图具有离散数量的颜色值（我认为默认情况下为 256，因此有很多舍入) 和 3) 从两个图的视觉比较中，颜色的细微变化可能并不那么明显。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T08:21:13.227

我会考虑用绝对公差和相对公差做这样的事情：

```
function same = tol( x, y )
absTol = 1e-3;
relTol = 0.05;
errVec = abs( x(:) - y(:) );
same = all( (errVec < absTol) | (errVec./x(:) < relTol) ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-09T18:13:43.237

当 x 和 y 中有非常小的值对时，结果将返回 0，尽管这些值本身是可忽略的。因此，除了接受的解决方案

```
relError(x < absTol) = 0;
```

可用于丢弃非常小的错误。因此，这些值不考虑相对误差。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-11T08:26:58.287

对于包含浮点值的矩阵 x 和 y，您可以检查数组元素是否在彼此的给定容差范围内。示例代码：

```
tol = 0.05;

result = abs(x - y) <= tol; 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-02-21T11:54:17.753

使用 'isequal(a,b) 其中 a 和 b 是两个矩阵，如果为 1 则为真

# http-referer - 当他使用后退按钮时，是否可以知道用户来自哪里？

> ID：938290
> 
> 赞同：4
> 
> 时间：2009-06-02T07:16:15.527
> 
> 标签：http-referer

例如，

如果用户访问 google -> example.com -> newwebsite.com

如果他返回 example.com，则 http-referrer 页面仍将是 google.com

我怎样才能检测到他去了 newwebsite.com

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T07:24:05.213

我相信后退按钮将发送第一次发送到该站点的 HTTP 标头，因为这并不是*真正*的新访问。

如果用户的 http-referrer 是 newwebsite.com，假设您显示了一个错误页面。他们第一次访问时，他们会得到你的网站。如果他们访问 newwebsite.com，然后回击（这意味着他们想通过浏览器历史回到过去，而不是再次加载带有新标题的页面），那么他们会得到一个错误页面，并且后退按钮将被击败。我不知道这是否会激发这种行为，这对我来说很有意义。

也许这是可能的，但它完全依赖于浏览器。无论如何，你为什么需要这个功能？Newwebsite 根本没有将用户引向您的网站，两者之间根本没有联系——它恰好是用户访问的最后一页。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T07:59:53.083

如果访问者使用后退按钮，页面可能会从浏览器缓存中加载。在这种情况下，不会发送推荐人。使用谷歌分析，你可以看到有多少访问者来自给定的网站。这可能会给你一些信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T07:44:11.197

我不相信这通常是可能的。您可以在您的网站上使用 javascript 进行技巧，以便可以检测和记录从那里导航的所有链接，但是一旦用户离开您的网站，您就无法控制。

如果您提供了浏览器，即。自己开发一个，然后您可以选择通过 api 公开浏览器历史记录。

[http://jeremiahgrossman.blogspot.com/2006/08/i-know-where-youve-been.html](http://jeremiahgrossman.blogspot.com/2006/08/i-know-where-youve-been.html)

描述了一种利用浏览器协议修改链接以指示它们已被遍历（例如更改链接的颜色）以便可以检测到访问的站点的技术，但这仅适用于预先声明的一组链接，它是不是普遍适用的方法。

我的感觉是，试图隐藏浏览器的本质——用户可以到处乱跑——往往会导致令人不满意的 79% 的解决方案让用户感到困惑。

你真正想解决什么问题？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-02T08:21:18.500

您可以使用会话来跟踪页面的路径。它真的很有效。试试吧。

# c# - 将CSV文件导入C#

> ID：938291
> 
> 赞同：2
> 
> 时间：2009-06-02T07:16:54.620
> 
> 标签：c#, asp.net, csv

我正在建立一个网站，其中一项要求是用户从他们的电子邮件客户端导出他们的联系人以将它们导入到网站中。

因为每个电子邮件客户端都以稍微不同的格式导出他们的联系人，所以我不得不以最佳方式处理它。因为我不知道字段是什么，或者分隔符是什么。

我只希望针对主要的电子邮件客户端/地址簿（outlook、apple mail、entourage、thunderbird）。所有这些都有完全不同的格式。Entourage 使用制表符作为分隔符，其余使用逗号等。我只需要提取电子邮件地址和（如果有）名称。由于某些客户的名字/姓氏有单独的字段，因此名称变得更加棘手。

使用[FileHelpers](http://www.filehelpers.com)将是理想的，但似乎我需要知道 csv 的结构才能连接解决方​​案。如果可能的话，我宁愿不去编写自己的 csv 解析器。

以下是我对集体蜂巢思维的看法：

### A计划

*   读取 csv 文件的第一行（所有格式的第一行都有一个标题）并计算制表符与逗号的数量。由此确定分隔符。
*   使用某种类型的 csv 阅读器，例如[Lumenworks](http://www.codeproject.com/KB/database/CsvReader.aspx)，为我提供文件其余部分的基本 csv 阅读功能。
*   对每个字段执行正则表达式匹配以确定电子邮件列。
*   不知道如何弄清楚用户的名字......

### B计划

*   提示用户输入电子邮件客户端的类型，并为每个不同的客户端单独编码 <- 看起来真的很笨重。

### C计划

....使用/购买已经这样做的现有组件？！（我肯定找不到！！）

想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T07:26:18.970

我会选择 B 计划（我不同意它很笨重）。

恕我直言，最好的方法是询问用户他/她需要从哪种电子邮件客户端导出。因此，您可以识别分隔符。您自己已经发现，尽管不同的客户端使用不同的分隔符，但单个客户端将始终使用相同的分隔符（除非他们决定推出非向后兼容的版本）因此，创建一个面向对象的类应该不难接受分隔符作为参数并相应地解析输入（逻辑应保持几乎相同，与分隔符无关）。

即使解析每种类型的导出文件的逻辑显着不同，您似乎也可以创建一个抽象基类来保存所有常见功能和简单地覆盖客户端特定功能的派生类。

即使您使用自定义库（例如 FileHelpers），您也应该能够通过传递分隔符的类型来完成它。

我觉得你不应该依赖可能的分隔符的相对数量来确定实际的分隔符是什么（如计划 A 中所示）。

**编辑：**刚刚想到的另一个选项是提供一种类似于 MS Excel 的选项界面。您可以选择分隔符，并实时预览如何根据选择解析数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T07:29:03.707

我会先看看竞争对手是如何做到的。

**Google：** *“我们支持以 CSV 文件格式（逗号分隔值）导入联系人。为获得最佳效果，请使用 Outlook、Outlook Express、Yahoo! 或 Hotmail 生成的 CSV 文件。对于 Apple 通讯簿，有一个有用的实用程序称为“A到G”。”*
所以我猜他们会选择你的计划 A，并检查上述 CSV 文件。

**Live mail/hotmail：**他们选择 B，并支持：*Microsoft Outlook（使用 CSV）、Outlook Express（使用 CSV）、Windows 联系人、Windows Live Hotmail、Yahoo！邮件（使用 Outlook CSV 格式和逗号分隔）、Gmail（使用 Outlook CSV 格式）*

**Facebook：**他们让您输入您的电子邮件地址，如果他们知道（雅虎、gmail、hotmail 等），他们会询问您的密码，并自动检索您的联系人。（选项 D）如果他们不支持您的电子邮件提供商，您仍然可以从 Outlook 或其他格式（您的选项 B 的种类）上传 CSV 文件。

我想facebook版本真的很酷。但是，如果这太多了，您可以选择选项 A 以获取支持的 CSV 格式（您必须检查不同的 CSV 文件），否则，如果您无法识别它，请提示用户您识别的不同列的含义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-04T08:38:26.543

如果您需要更改将要导入的 CSV 文件的分隔符，请使用以下代码：

```
GenericConnection connection = new GenericConnection();
OleDbConnection con = new OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\"" +

file.DirectoryName + "\"; Extended Properties='text;HDR=Yes;FMT=" + strDelimiter + "(,)';");
connection.DBConn = con;
connection.Filename = strFilePath;

FileInfo file = new FileInfo(conn.Filename);

DataTable dt = new DataTable();

string selectFields = "Name, email";

using (OleDbCommand cmd = new OleDbCommand(string.Format("SELECT {0} FROM [{1}]", selectFields, file.Name), (OleDbConnection)conn.DBConn))
{
    conn.DBConn.Open();
    using (OleDbDataAdapter adp = new OleDbDataAdapter(cmd))
    {
       adp.Fill(dt);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T07:29:47.527

创建一个像“IContactImporter”这样的接口可能是有意义的，它有一个方法“Import(File/whatever ...)”。然后对于每种类型的联系人文件，创建实现导入方法的类来处理每种格式。

如果有某种方法可以告诉用户正在上传哪种类型的文件，您可能不需要询问用户。

对于实际的实现，我会找到一个现有的 CSV 库，并为每种格式进行相应的配置。我工作中有人使用[LINQtoCSV](http://www.codeproject.com/KB/linq/LINQtoCSV.aspx)，但我不确定是否有更好的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T07:33:02.217

计划 B 是最好的，另一种方法是查看整个文件并计算一个字符的出现次数，这可以使用 streamreader 类逐行完成，然后您可以将结果字符串拆分为一个数组。

您需要将字符限制为非字母数字 Az 0-9" 并查看字符

然后您可以确定分隔符。另请注意，如果字段为空，则某些程序不会导出“单元格”，例如 ms office 2007

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T08:09:41.270

A计划似乎是明智的。我认为不会有太多带有逗号或制表符的字段名称（如果有的话）。所以统计数据在 90% 的时间里都是准确的。如果统计数据足够“接近”（例如 15 个逗号和 12 个制表符），您可以做的是：

```
int i = line.IndexOf("email", StringCompareOptions.CultureInvariantIgnoreCase);
if(i == -1) i = line.IndexOf("e-mail", StringCompareOptions.CultureInvariantIgnoreCase);
else i += 5; // Length of "email"
if(i == -1) throw new Exception("You should select the email field when exporting.");
else i += 6; // Length of "e-mail"

// Find the next delimeter.
string delim = null;
for(int k = i; k < line.Count; k++)
{
    char c = line[k];
    if(c == '\t' || c == ',')
    {
       delim = c.ToString();
       break;
    }
}

if(delim == null)
   throw new Exception("Unrecognised file format."); 
```

最重要的是，您说名字和姓氏字段以及电子邮件和电子邮件之类的字段都会有问题。你需要一个很好的设计模式。为了规范化数据的真正利益，我将存储名字和姓氏（并将它们组合在 UI 中）。因此：

```
interface IField
{
    string[] Accepts { get; } // Gets the fields that this can accept.
    string[] Gives { get; } // Gets the field that this would give.

    IEnumerable<KeyValuePair<string, string>> Handle(IEnumerable<KeyValuePair<string, string>> fields);
}

class NameField
{
    string[] Accepts { get return new string[] { "FirstName", "LastName", "Name", "First Name", etc. }; }
    string[] Gives { get return new string[] { "FirstName", "LastName" }; }

    IEnumerable<KeyValuePair<string, string>> Handle(IEnumerable<KeyValuePair<string, string>> fields)
    {
       string firstName = null, lastName = null;
       foreach(KeyValuePair<string, string> field in fields)
       {
           switch(field.Key)
           {
                  case "FirstName":
                  case "First Name":
                  firstName = field.Value;
                  break;
                  // ...
                  case "FullName":
                  case "Full Name":
                  // Split into fn and ln.
                  break;
                  // ...
           }
       }
       yield return new KeyValuePair<string, string>("FirstName", firstName);
       yield return new KeyValuePair<string, string>("LastName", lastName);
    }
} 
```

无论如何，我相信你明白了。一堆将字段转换为可识别字段的转换。

# nhibernate - 在 nhibernate 中查询未映射的属性

> ID：938292
> 
> 赞同：5
> 
> 时间：2009-06-02T07:17:25.680
> 
> 标签：nhibernate, nhibernate-mapping, linq-to-nhibernate

我正在使用 Linq-To-NHibernate。我需要使用一些未映射到列的属性。

例如

```
Repository<Person>
   .Find()
   .Select(p => new PersonModel() { Id = p.Id, FullName= p.FullName,Position = p.Position }); 
```

位置不是映射属性，它包含一些逻辑。我得到未映射的属性错误。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T10:03:53.473

不可能，也不太可能在短期内得到支持。

# python - 在 Python Routes 中预处理路由参数

> ID：938293
> 
> 赞同：1
> 
> 时间：2009-06-02T07:17:33.497
> 
> 标签：python, parameters, routes

我正在使用 Routes 来完成所有 URL 映射工作。这是我的应用程序中的典型路线：

```
map.routes('route', '/show/{title:[^/]+}', controller='generator', filter_=postprocess_title) 
```

我经常需要从 {title} 参数中删除一些字符（如空格和下划线）。目前，控制器中的每个方法调用一个执行此转换的函数。这不是很方便，我希望 Routes 来完成这项工作。可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T10:40:10.263

我不熟悉 Routes，因此我不知道您所追求的是否可以通过 Routes 实现。

但是也许你可以用一个装饰器来装饰你的控制器方法，根据需要从参数中去除字符？

不确定这是否会更方便。但对我来说，使用装饰器与在控制器方法中内联做同样的事情有不同的“感觉”。

例如：

```
 @remove_spaces_from('title')
def my_controller(...):
    ... 
```

如果您不熟悉装饰器，可以在 Google 上搜索“python 装饰器”来帮助您入门。要记住的关键点：当装饰器需要参数时，您需要在装饰器中进行两层包装。

# asp.net - 如何让 BindingNavigatorAddNewItem 在对话框中询问主键？

> ID：938300
> 
> 赞同：0
> 
> 时间：2009-06-02T07:20:51.303
> 
> 标签：asp.net, vb.net

单击按钮后创建新行时，如何使 BindingNavigatorAddNewItem 在对话框中询问主键？

目前它在 DATAGRIDVIEW 末尾添加空白行，这对最终用户来说是一个很大的困惑，如果用户忘记输入主键异常发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T17:27:11.020

在大多数情况下，用户不应该知道主键。不必输入主键，而是让数据库通过将键设置为标识列来为您自动生成主键。

您标记了这个 asp.net，但问题是一个胜利形式的问题。

# java - 如何从 MP3 中获取音频数据？

> ID：938304
> 
> 赞同：20
> 
> 时间：2009-06-02T07:21:46.060
> 
> 标签：java, audio, mp3, extraction

我正在开发一个必须处理音频文件的应用程序。使用 mp3 文件时，我不确定如何处理数据（我感兴趣的数据是音频字节，即代表我们听到的内容）。

如果我使用的是 wav 文件，我知道我有一个 44 字节的标头，然后是数据。说到mp3，我读到它们是由帧组成的，每一帧都包含一个标题和音频数据。是否可以从 mp3 文件中获取所有音频数据？

我正在使用 java（我添加了 MP3SPI、Jlayer 和 Tritonus）并且我能够从文件中获取字节，但我不确定这些字节代表什么或如何处理。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-06-02T07:27:25.550

从[MP3SPI 的文档中](http://www.javazoom.net/mp3spi/documents.html)：

```
File file = new File(filename);
AudioInputStream in= AudioSystem.getAudioInputStream(file);
AudioInputStream din = null;
AudioFormat baseFormat = in.getFormat();
AudioFormat decodedFormat = new AudioFormat(AudioFormat.Encoding.PCM_SIGNED, 
                                            baseFormat.getSampleRate(),
                                            16,
                                            baseFormat.getChannels(),
                                            baseFormat.getChannels() * 2,
                                            baseFormat.getSampleRate(),
                                            false);
din = AudioSystem.getAudioInputStream(decodedFormat, in); 
```

然后，您只需从中读取数据`din`- 这将是按照`decodedFormat`. （有关更多信息，请参阅[文档`AudioFormat`](http://java.sun.com/javase/6/docs/api/javax/sound/sampled/AudioFormat.html)。）

（请注意，此示例代码不会关闭流或类似的东西 - 正常使用适当的 try/finally 块。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T07:53:55.137

您想要的数据是实际样本，而 MP3 以不同的方式表示数据。因此，就像其他人所说的那样 - 您需要一个库来将 MP3 数据解码为实际样本以满足您的目的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T08:12:10.873

如其他答案中所述，您需要一个解码器将 MP3 解码为常规音频样本。

一种流行的选择是[JavaLayer](http://www.javazoom.net/javalayer/sources.html) (LGPL)。

# asp.net - 为什么子控件中的某些事件在 ASP.Net 页面循环中以相反的顺序触发？

> ID：938305
> 
> 赞同：2
> 
> 时间：2009-06-02T07:23:39.927
> 
> 标签：asp.net, events, page-lifecycle

来自[MSDN 上的 ASP.Net 页面生命周期文章](http://msdn.microsoft.com/en-us/library/ms178472.aspx)：

> 尽管 Init 和 Load 都在每个控件上递归发生，但它们以相反的顺序发生。每个子控件的 Init 事件（以及 Unload 事件）发生在为其容器引发相应事件之前（自下而上）。但是，容器的 Load 事件发生在其子控件的 Load 事件之前（自上而下）。

这对事件很有意义`unload`，但为什么`init`呢？其他事件呢？

亲切的问候，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-08T08:05:39.750

这是由于这些页面是如何创建的——用户控件是页面类的属性。它们在类初始化时创建（并因此被初始化），这确保它们的实例在构造函数和页面的 init 事件期间可用。

然后，当加载、预渲染和渲染事件发生时，页面的事件首先触发并级联其中所有内容的事件。

当卸载和处置到来时，属性对象首先被再次处理。

WebForm 页面事件模型有点太复杂了，恕我直言。

# c++ - 实现信号量、锁和条件变量

> ID：938309
> 
> 赞同：9
> 
> 时间：2009-06-02T07:24:31.920
> 
> 标签：c++, c, operating-system

我想知道如何在 C/C++ 中实现信号量、锁和条件变量。我正在学习操作系统概念，但想绕过在 C 中实现这些概念。

有教程吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T08:04:31.483

信号量、锁、条件变量等是操作系统概念，通常必须根据操作系统内核的特性来实现。因此，通常不可能孤立地研究它们——您还需要考虑内核代码。可能最好的方法是查看 Linux 内核，并借助《[了解 Linux 内核](http://oreilly.com/catalog/9780596000028/)》等书。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T07:30:43.640

最简单的信号量只是一个计数器，您可以通过单个原子操作对其进行加减运算。维基百科有一个易于理解的解释，几乎涵盖了您关于它们的问题：

[http://en.wikipedia.org/wiki/Semaphore_（编程）](http://en.wikipedia.org/wiki/Semaphore_(programming))

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T07:56:02.450

学习操作系统概念的一个很好的起点可能是 Andrew Tanenbaum 的“现代操作系统”。他还有另一本关于他自己的操作系统 (Minix) 的书，名为“操作系统：设计与实现”，其中更详细地介绍了编码。您应该能够在当地图书馆找到这些书。

您可能需要查找相关主题以了解如何以及为什么使用信号量：竞争条件、同步、多线程、消费者-生产者-问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T07:52:00.757

在底层，如果你想实现那种东西，你将需要使用汇编语言。C 和 C++ 根本不公开编写并发代码所需的那种特性——除非使用库，它们在实现中使用汇编程序。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-02T11:47:17.460

minix的东西很不错。一个更简单的例子是 MicroC/OS 的东西。它带有一本详细的教科书，所有来源都在那里。它有基本的元素，代码足够小，你可以在相对较短的时间内理解它。

[http://www.micrium.com/products/rtos/kernel/rtos.html](http://www.micrium.com/products/rtos/kernel/rtos.html)

[http://en.wikipedia.org/wiki/MicroC/OS-II](http://en.wikipedia.org/wiki/MicroC/OS-II)

您可以做的另一件事是在 linux 上的应用程序中制作伪造的操作系统。我通过使用 itimer 设置基本刻度来做到这一点，然后使用函数调用 swapcontext (man 2 swapcontext) 交换线程，这将把 regs 保存在堆栈上。这样就可以摆脱丑陋的东西，而您可以实现信号量/互斥体/计时器等等。这很有趣。

尽管有些帖子说了什么，但不需要汇编程序。了解它总是有帮助的。当您编写甚至是高级应用程序时，了解内部/编译器/等的工作原理永远不会有什么坏处。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-02T07:51:08.280

对于基本的了解，您可以参考 *Avi Silberschatz、Peter Baer Galvin、Greg Gagne所著的《*[操作系统概念](http://codex.cs.yale.edu/avi/os-book/os7/)》一书， 非常好。

 *您还可以访问[Dave Marshall 的](http://www.cs.cf.ac.uk/Dave/C/)网站以获得一些支持。请参阅那里的信号量部分。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-10T19:27:14.910

有趣的是，史蒂文斯的书是描述同步原语的使用及其用途的经典著作之一。他当然似乎认为它们可以用来控制进程间通信。我倾向于同意他的观点。网络，不，IPC 是。肯定是的。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-06-02T07:39:33.343

你可以赶上很多 IPC（进程间通信）书籍，可以解释你需要什么的来龙去脉。有一本经典的书。Richard Stevens 的 Unix 网络编程进程间通信。你会得到你需要的一切。:)

# url - 如何在没有文件扩展名的情况下显示短 URL？

> ID：938317
> 
> 赞同：0
> 
> 时间：2009-06-02T07:27:30.450
> 
> 标签：url, friendly-url, truncate

我环顾四周，但找不到我要找的东西。我正在寻找一种方法来自动创建在浏览器中显示的短 URL，而不是使用 URL 缩短器。基本上我想重新创建这样的东西：

```
idzr.org/1ptb 
```

我定期使用“GrabUp”将屏幕截图上传到我的服务器，但它会创建相当长的 URL，例如：

```
/2523e3c90d60f08e952215424e7c5d99.png 
```

每次都缩短它们有点烦人。我最近在几乎所有文件中都看到过这种方法，包括 html 文件。如果这已经讨论过了，我很抱歉我再次发布它。我似乎被困住了。提前感谢您的任何帮助和建议！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-06-02T07:54:18.773

我不知道，你用什么网络服务器。

1.  您为重写编写规则——Apache 的 htaccess 或 IIS 的等价物

2.  您通过代码将内容推送给用户，因为浏览器不知道从 Web 服务器获得什么内容——使用 http 标头——MIME 类型

# sql - How to design a star schema

> ID：938318
> 
> 赞同：11
> 
> 时间：2009-06-02T07:27:39.077
> 
> 标签：sql, database-design, star-schema

I am confused where should I start to design a star schema.

for example I have tables in database as follows:

```
Branch(branchNo, bStreetAddress, bCity)
LoanManager(empNo, empName, phone, branchNo)
Customer(custNo, custName, profession, streetAddress, city, state)
Account(accNo, accType, balance, accDate, custNo)
LoanContract(contractNo, loanType, amount, loanDate, empNo, custNo) 
```

I want to design a data-warehouse to analysis the loads such as :

1.  The total amount of loans in 2008.
2.  For the type of loans with more than 10 loan contracts, the type of loan and the number of contracts

when creating a star schema, what where should I start?

For what I understanding, all the star schemas must have a center, and the center fact table, contains "Measures" and "Relations to other fact tables".

So, is it that, when designing the star schema, we always start from the center, confirm what are the measure first? and then choose proper relation to another fact table?

But I still have another question, what should we choose to be Measures? When choosing measures, what question should I ask myself?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T07:38:25.840

The design of a star schema is always driven by the **client's business needs**. What are the questions asked? How fine-grained should the answers be?

In you example, interesting questions might be "Number of Contracts by Branch or LoanManager" or "Managed sum of Loans by Branch or LoanManager". In this case, `Branch` and `LoanManager` would become your **dimensions** while `Count(LoanContract)` and `Sum(LoanContract.amount)` would be your **measures**. A common additional dimension is time, usually `week` or `quarter`.

The schema for answering those questions could look like this:

```
DimBranch ( branchNo )
DimLoanManager ( empNo )
DimQuarter ( year, qNo )  -- qNo in (1,2,3,4)
DimWeek ( year, weekNo )  -- weekNo in (0..53), depending on business rules

Measures ( branchNo, empNo, year, qNo, weekNo, numContracts, sumLoans ) 
```

For the business questions you already posed in your question, the dimensions and measures would be such:

1.  dimension: `year`, measure: `Sum(LoanContract.amount)`
2.  dimension: `loanType`, measure: `Count(LoanContract)`

Putting those two into the same star schema doesn't make much sense, since they neither share dimensions or measures.

# linux - 在 Linux 中记录内存占用

> ID：938319
> 
> 赞同：6
> 
> 时间：2009-06-02T07:27:46.737
> 
> 标签：linux, unix, memory-footprint

有没有办法记录内存占用？在过程完成后，我们仍然可以访问它。

我检查内存占用的典型方法是：

```
$ cat /proc/PID/status 
```

但在过程完成后它绝不存在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T07:41:04.057

您可以执行以下操作：

```
watch 'grep VmSize /proc/PID/status >> log' 
```

当程序结束时，您将在`log`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T15:22:14.563

[Valgrind](http://valgrind.org/)有一个名为[Massif](http://valgrind.org/info/tools.html#massif)的内存分析器，它提供有关程序内存使用情况的详细信息：

> Massif 是一个堆分析器。它通过定期拍摄程序堆的快照来执行详细的堆分析。它会生成一个图表，显示随时间的堆使用情况，包括有关程序的哪些部分负责最多内存分配的信息。该图由文本或 HTML 文件补充，其中包含用于确定分配最多内存的位置的更多信息。Massif 运行程序的速度比正常速度慢 20 倍。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T07:59:44.860

您可以使用[munin](http://munin.projects.linpro.no/) + 自定义插件记录它。

这将允许您监控和保存所需的过程信息，并轻松绘制图表。

[这是我在 serverfault.com 上给出的相关答案](https://serverfault.com/questions/11550/peak-memory-usage-of-a-process/11562#11562)

# .net - 使用合并复制到 SQL Compact 3.5 时出错

> ID：938325
> 
> 赞同：1
> 
> 时间：2009-06-02T07:30:35.247
> 
> 标签：.net, sql-server, sql-server-ce

与 sql server (2005 SP3) 同步时出现以下错误：

初始化 SQL Server Reconciler 失败。再试一次。; 合并过程无法从订阅服务器“{F238C7BC-E13B-40E4-99F2-F11A203BD65A}:W:\http_content\Secure\SECURE_PROD\data_merge\30.18F5D9B4BCC7_B1415013-9FB7-424A-AB45-643A0D4A6320.IN”连接到消息文件。检查以确保服务器正在运行。无法验证对出版物“COREPublication”的订阅。确保正确指定所有合并代理命令行参数并且正确配置订阅。如果发布者不再拥有有关此订阅的信息，请删除并重新创建订阅。

据我所知，sql server 端一切正常。我已经完成了错误消息中提到的所有检查。

谁能告诉我这个错误信息的真正含义？是否无法从服务器读取 shapshot 文件？（这是我目前的猜测）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T10:59:05.553

这是在您安装了 SQL Compact 3.5 SP1 并与 SP1 之前的服务器通信时引起的。服务包中的某些更改导致其停止工作。

卸载服务包是可行的，所以这是我们当前的解决方法，直到服务包被批准并安装在生产环境（即服务器）中。

我目前无法进行测试，但我假设 SP1 与 SP1 服务器通信可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-28T01:32:53.077

我同时使用 3.5 SP1 客户端和 3.5 SP1 服务器，两者都运行良好。这两个组件的版本都是 3.5.5692.0。引用的客户端程序集在 .NET 客户端解决方案（在 CE 上运行）中应为 3.5.1.0。

我得到了同样的错误（它没有任何意义），但只需重新启动服务器（在我的情况下是 Windows 2003 Server），错误就消失了。它可能与安装后仍在运行的某些以前版本的组件有关。

您可以通过访问其 URL 来验证您是否正在运行 3.5 SP1，例如 [http://xxxx/dir_of_dll/sqlcesa35.dll?diag](http://x.x.x.x/dir_of_dll/sqlcesa35.dll?diag)

在“SQL Server Compact Modules Test”下，应该显示“sqlcesa35.dll”版本 3.5.5692.0，并且所有测试都应该以 SUCCESS 状态通过。

# asp.net - modalpopup 上的 AJAX 日历扩展器返回 null

> ID：938328
> 
> 赞同：0
> 
> 时间：2009-06-02T07:32:23.077
> 
> 标签：asp.net, asp.net-ajax

我在我拥有的模态弹出窗口上从 calextender 获取日期时间时遇到了一些麻烦。

```
<asp:TextBox ID="txtPopEndDate" runat="server" Enabled="false"></asp:TextBox>
<img id="calButton" alt="" title="Show Calendar" src="~/App_Themes/Main/img/calendar.png"
                        runat="server" height="20" style="cursor: hand;" />
<ajax:CalendarExtender Animated="true" TargetControlID="txtPopEndDate"
                        runat="server" PopupButtonID="calButton"
                        Enabled="true" ID="calExtender" Format="dd/MM/yyyy"/> 
```

是我必须选择日期的控件，现在当我按下确定按钮时，我会处理包括日期在内的数据。但是，如果我尝试使用 calExtender.selectedDate 属性获取日期，我什么也得不到。手动从文本框中获取字符串并对其进行解析也是如此。

我不得不提一下，该弹出窗口上的文本框和下拉菜单中的其他数据可以正常工作。这里的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T13:02:34.687

您的文本框已启用 = false。我认为这会在 html 中吐出一个设置为 true 的禁用属性，因此表单的帖子不会发送该值。为什么不希望启用文本框？

我还假设您在回发后试图获取价值？真的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T07:23:25.240

是的，

与此同时，我找到了解决问题的方法。正如你所说，文本框显然需要启用。这意味着错误日期的选项。我从文本框中获取了值，并使用 DateTime.TryParse 以这种方式解析它以确保正确的日期。

如果有人有更好的选择，请告诉我

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-19T13:18:41.963

我们通过我们的应用程序在链接到 CalendarExtender 的 TextBox 上使用了 Enabled="false"，没有任何问题。然后我在拒绝合作的页面上添加了一个日期选择器。TextBox 值在 PostBack 上永远不可用。

我在这里找到了解决方案： [http ://www.west-wind.com/weblog/posts/2005/Dec/20/ASPNET-20-ReadOnly-behavior-change-when-EnableViewState-is-false](http://www.west-wind.com/weblog/posts/2005/Dec/20/ASPNET-20-ReadOnly-behavior-change-when-EnableViewState-is-false)

我发现的是：

1.  我可以设置`ReadOnly = true`，然后从 PostBack 上的请求中检索值`TextBox1.text = Request[TextBox1.UniqueID]`。

2.  我可以使用`TextBox1.Attribute.Add("readonly", "readonly")`，然后按预期设置 Text 属性。

3.  我无法使用`Enabled = false;`or检索值`TextBox1.Attribute.Add("disabled", "disabled")`

我们没有在这个页面上禁用 ViewState，我们也没有在其他页面上得到这个行为，所以我猜这个行为也可以被其他东西触发。

# vb.net - 如何仅将文本框输入过滤为数字？

> ID：938329
> 
> 赞同：2
> 
> 时间：2009-06-02T07:32:54.183
> 
> 标签：vb.net

如何抑制除数字以外的所有数据？

这不起作用`KeyDown()`：

```
If e.KeyData < Keys.D0 Or e.KeyData > Keys.D9 Then
    e.Handled = True
End If 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T08:12:25.303

有很多方法可以做到这一点。我已经快速尝试了一下，然后就可以了。我已将 KeyPress 子用于文本框，并将每个按键传递给 IsNumber 函数。

注意：我允许使用退格键，以防您输入错误并想要删除。

如果您不需要退格，请取出**If e.KeyChar <> ChrW(Keys.Back) Then / End If**部分。

```
 Private Sub TextBox1_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles TextBox1.KeyPress
    If e.KeyChar <> ChrW(Keys.Back) Then
        If Char.IsNumber(e.KeyChar) Then
        Else
            e.Handled = True
        End If
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T07:42:49.217

您可以检查 Char.IsDigit(e.KeyChar)，但在这种情况下最好的做法是创建 TextBox 的子类并覆盖 IsInputChar()。这样你就有了一个可重用的 TextBox 控件，你可以将它放在任何地方，这样你就不必重新实现逻辑。

（我的VB有点生疏了……）

```
Public Class NumericTextBox : Inherits TextBox

    Protected Overrides Function IsInputChar(Byval charCode As Char) As Boolean
        If (Char.IsControl(charCode) Or Char.IsDigit(charCode)) Then
            Return MyBase.IsInputChar(charCode)
        Else
            Return False
        End If
    End Function

End Class 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-22T22:29:38.610

会帮助你...

```
 Public Function IsNumericTextbox(ByVal sender As TextBox, ByVal KeyChar As Char) As Boolean
    'set TRUE: cause a exception when the keychar is not Allowed into vars: allowedChars, allowedOneChar, allowedExceptionChar
    Dim UseThrowDebuggy As Boolean = False

    Dim allowedChars As String = "0123456789"
    Dim allowedOnceChar As Char() = {"."}
    Dim allowedExceptionChar As Keys() = {Keys.Back}

    Dim idxAllowedNotFound As Integer
    Dim idxCountOne As Integer = 0

    idxAllowedNotFound = allowedChars.IndexOf(KeyChar)
    If idxAllowedNotFound = True Then
        'AllowedOnce
        For Each _c As Char In allowedOnceChar
            If _c = KeyChar Then
                'Count Check
                For Each _cc As Char In sender.Text
                    If _c = _cc Then idxCountOne += 1
                Next
                If idxCountOne = 0 Then
                    Return False
                Else
                    Return True
                End If
            End If
        Next
        'Exceptions
        For i As Integer = 0 To allowedExceptionChar.Count - 1
            If Asc(KeyChar) = Convert.ToUInt32(allowedExceptionChar(i)) Then Return False
        Next
        'Not Throw
        If UseThrowDebuggy = False Then
            If Char.IsNumber(KeyChar) Then
                Return False
            Else
                Return True
            End If
        End If
        'Outside to end for throw
    Else
        'AllowedChars
        Return False
    End If

    Dim _kc As String = ControlChars.NewLine & "Char: " & KeyChar & ControlChars.NewLine & "Asc: " & Asc(KeyChar) & ControlChars.NewLine
    Throw New Exception("UseThrowDebuggy found a unknow KeyChar: " & _kc)
End Function 
```

为了使用我的函数，将此代码添加到 textbox_keypress 中：

> e.Handled = IsNumericTextbox(sender, e.KeyChar)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T03:23:20.097

此代码将帮助您限制多个**TEXTBOX**只接受**NUMERIC VALUE**和 BACKSPACE 键。但是，当您不想接受退格键时，可以从代码中删除*If e.KeyChar <> ChrW(Keys.Back) Then*和*End If值。*此线程中*kevchadders*解决方案的增强版本。

```
Private Sub TextBox_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles TextBox1.KeyPress, TextBox2.KeyPress, TextBox3.KeyPress
    If e.KeyChar <> ChrW(Keys.Back) Then
        If Char.IsNumber(e.KeyChar) Then
        Else
            e.Handled = True
        End If
    End If
End Sub 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-23T14:46:00.720

```
 Public Class NumericTextBox : Inherits System.Windows.Forms.TextBox

 Protected Overrides Sub OnKeyPress(e As Windows.Forms.KeyPressEventArgs)
      If Char.IsDigit(e.KeyChar) Or
          Char.IsControl(e.KeyChar) Or
          e.KeyChar = lobalization.CultureInfo.CurrentCulture.NumberFormat.CurrencyDecimalSeparator Then
      MyBase.OnKeyPress(e)
    Else
        e.Handled = True
    End If
 End Sub

 End Class 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-28T10:48:44.980

这将允许数字输入、Backspace 来更正您的输入以及小数点。

```
 If (e.KeyChar < "0" OrElse e.KeyChar > "9") AndAlso e.KeyChar <> ControlChars.Back AndAlso e.KeyChar <> ControlChars.Cr AndAlso e.KeyChar <> "." Then
        Beep()
        e.Handled = True
    End If 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T07:49:16.287

我建议你使用正则表达式。你可以搜索谷歌，比如“正则表达式文本框只有数字”，我想你会想出很多例子。

例如，如果你在 ASP.NET 中，你可以这样做：

```
<asp:TextBox 
    ID="txtPhoneNumber" 
    runat="server" 
    Text='<%#Bind("phoneNumber") %>' 
    MaxLength="15">
</asp:TextBox>

<asp:RegularExpressionValidator 
    ID="rfvUSerPhoneNumberValidate" 
    runat="server"
    ControlToValidate="txtPhoneNumber" 
    Display="Dynamic" 
    ValidationExpression="^[0-9]{1,15}$"
    ErrorMessage="Please enter only numeric value for Phone Number" 
    EnableViewState="true">
</asp:RegularExpressionValidator> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-06-22T11:50:39.750

这是将数字输入限制为 textbox 的另一种方法。使用 KEYPRESS 事件

If Asc(e.KeyChar) <> 13 AndAlso Asc(e.KeyChar) <> 8 AndAlso Not IsNumeric(e.KeyChar) Then MessageBox.Show("Only Numbers") e.Handled = True End If End Sub 希望有帮助！谢谢..

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-06-16T16:08:14.680

您的功能的目的可以帮助提供额外的解决方案。检查每个 KeyPress 上的数值可能是多余的。然后你必须通过考虑退格、删除、复制、粘贴等来过度杀戮它。

例如，如果您要存储电话号码，则应在验证和更新步骤中使用“IsNumeric”功能。或者，如果您选择项目的数量，“NumericUpDown”控件将比 TextBox 更合适。

# javascript - clean url onClick 问题

> ID：938334
> 
> 赞同：1
> 
> 时间：2009-06-02T07:35:22.103
> 
> 标签：javascript, .htaccess, mod-rewrite

我的网站中有一个 RewriteRule，它工作正常，但我的 javascript 的一部分不起作用。

```
<a href="#" onClick="check('1')">Click</a>

<div id="1" style="padding: 5px; display: none;">
    MyText
</div> 
```

正常情况下我有 www.mysite.com?page=home 当我点击它时就像 www.mysite.com?page=home# 但使用 RewriteRule 我得到 www.mysite.com/home/ 但我的 onClick 不起作用了。

我怎样才能解决这个问题

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T07:41:23.277

返回假...

```
<a href="#" onclick="check('1'); return false;">Click</a> 
```

# ant - 蚂蚁javac问题

> ID：938335
> 
> 赞同：0
> 
> 时间：2009-06-02T07:36:08.700
> 
> 标签：ant

用 javac ant 任务编译给我不存在的错误.. [javac] D:\mySrc\xx.java:1: 非法字符: \65279 [javac] ï»¿package com.xy;

xx.java 类没有问题

这是我的编译目标：

```
<javac srcdir="${src}/src" destdir="${bin}" encoding = "utf-8" classpathref="classpath" debug="true" debuglevel="lines,vars,source" deprecation="off" />
     <copy todir="${bin}" overwrite="no">
    <fileset dir="${src}/src" excludes="**/*.java"/>                                    
    </copy> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T07:41:18.550

问题可能与字节顺序标记（看起来像：“ï»¿”）有关。文件开头的这三个特殊字符表示该文件是 UTF-8 编码的。我见过一些 Java 工具不能很好地处理这个问题的案例。看看你是否可以从你的文件中删除它，或者设置你的编辑器不在文件中插入这个 BOM。

这是一个关于这个主题的好帖子：

[http://groups.google.com/group/comp.lang.java.programmer/browse_frm/thread/adb0500c61451317?pli=1](http://groups.google.com/group/comp.lang.java.programmer/browse_frm/thread/adb0500c61451317?pli=1)

尝试在谷歌搜索“javac 非法字符\65279”。这应该会给你一些额外的资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T07:38:39.070

仔细检查你的文件，可能有一个额外的字符

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T09:31:59.263

我不得不重新创建类并逐行复制代码......

这真的是一个问题......

# c++ - 你知道的最快的 Dijkstra 实现是什么（在 C++ 中）？

> ID：938338
> 
> 赞同：12
> 
> 时间：2009-06-02T07:37:44.267
> 
> 标签：c++, performance, algorithm

我最近确实将第三版 Dijkstra 算法用于单一来源的最短路径添加到我的项目中。

我意识到有许多不同的实现，它们的性能差异很大，并且在大图的结果质量上也存在差异。使用我的数据集（> 100.000 个顶点），运行时间从 20 分钟到几秒不等。最短路径也有 1-2% 的差异。

你知道哪个是最好的实现？

**编辑：** 我的数据是一个水力网络，每个节点有 1 到 5 个顶点。它可以与街道地图相媲美。我对已经加速的算法进行了一些修改（对所有剩余节点使用排序列表），现在可以在很短的时间内找到相同的结果。我已经搜索了很长时间。我想知道这样的实现是否已经存在。

我无法解释结果的细微差别。我知道 Dijkstra 不是启发式的，但所有的实现似乎都是正确的。更快的解决方案具有更短路径的结果。我专门使用双精度数学。

**编辑2：** 我发现找到的路径中的差异确实是我的错。我为某些顶点插入了特殊处理（仅在一个方向上有效）并在另一个实现中忘记了这一点。

**但是**我仍然对 Dijkstra 可以通过以下更改显着加速感到非常惊讶：通常，Dijkstra 算法包含如下循环：

```
MyListType toDoList; // List sorted by smallest distance 
InsertAllNodes(toDoList);
while(! toDoList.empty())
{
    MyNodeType *node = *toDoList.first();
    toDoList.erase(toDoList.first());
    ...
} 
```

如果你稍微改变一下，它的工作原理是一样的，但性能更好：

```
MyListType toDoList; // List sorted by smallest distance 
toDoList.insert(startNode);
while(! toDoList.empty())
{
    MyNodeType *node = *toDoList.first();
    toDoList.erase(toDoList.first());
    for(MyNeigborType *x = node.Neigbors; x != NULL; x++)
    {
        ...
        toDoList.insert(x->Node);
    }
} 
```

看来，这种修改将运行时间减少了一个数量级，而是一个指数数量级。它将我的运行时间从 30 秒减少到不到 2 秒。我在任何文献中都找不到这种修改。也很清楚，原因在于排序列表。对于 100.000 个元素，插入/擦除的性能要差得多。

**回答：**

经过大量谷歌搜索后，我自己找到了它。答案很明确： **[boost graph lib](http://www.boost.org/doc/libs/1_39_0/libs/graph/doc/dijkstra_shortest_paths.html)**。太棒了——我已经有一段时间没有找到这个了。如果您认为 Dijkstra 实现之间没有性能差异，请参阅[wikipedia](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm#Running_time)。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-02T10:43:37.947

以道路网络（>100 万个节点）而闻名的最佳实现具有以**微秒**表示的查询时间。有关详细信息，请参阅第 9 届 DIMACS 实施挑战赛（2006 年）。请注意，当然，这些不仅仅是 Dijkstra，因为重点是更快地获得结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T08:18:18.910

可能我没有回答你的问题。我的观点是，当您的问题有更有效的算法时，为什么要使用 Dijkstra。如果您的图满足三角形属性（它是欧几里得图）

|ab| +|公元前| > |交流|

（节点 a 到节点 b 的距离加上节点 b 到节点 c 的距离大于节点 a 到节点 c 的距离）那么您可以应用 A* 算法。这个算法非常有效。否则考虑使用启发式。实施不是主要问题。要使用的算法确实很重要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-04-21T18:22:08.677

我想说两点：1) Dijkstra 与 A* Dijkstra 的算法是动态规划算法，而不是启发式算法。A* 是启发式的，因为它还使用启发式函数（比如说 h(x) ）来“估计”点 x 距离终点有多近。在随后决定接下来要探索哪些节点时会利用此信息。

对于欧几里得图这样的情况，A* 效果很好，因为启发式函数很容易定义（例如，可以简单地使用欧几里得距离）。然而，对于非欧几里得图，可能更难定义启发式函数，错误的定义可能导致非最优路径。

因此，dijkstra 优于 A* 的优势在于它适用于任何一般图（除了在某些情况下 A* 更快）。很可能某些实现可以互换使用这些算法，从而导致不同的结果。

2) dijkstra 算法（以及其他算法，如 A*）使用优先级队列来获取下一个要探索的节点。一个好的实现可能使用堆而不是队列，甚至更好的实现可能使用斐波那契堆。这可以解释不同的运行时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T07:59:28.373

我上次检查时，Dijkstra 算法返回了一个最优解。Dijkstra 的所有“真实”实现每次都应该返回相同的结果。

同样，渐近分析向我们表明，随着输入大小的增加，对特定实现的细微优化不会显着影响性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T07:49:59.967

这将取决于很多事情。您对输入数据了解多少？它是密集的还是稀疏的？这将改变算法的哪些版本是最快的。

如果它很密集，只需使用矩阵。如果它稀疏，您可能希望查看更有效的数据结构来查找下一个最近的顶点。如果你有更多关于你的数据集的信息而不仅仅是图的连接性，那么看看其他算法是否会像 A* 这样更好地工作。

问题是，没有“一个最快”的算法版本。

# .net - 如何将 MSpec 与 MS Build 集成？

> ID：938347
> 
> 赞同：10
> 
> 时间：2009-06-02T07:40:10.593
> 
> 标签：.net, msbuild, continuous-integration, bdd, mspec

几天前，我观看了Rob [Conery的](http://blog.wekeroad.com/)[BDD 截屏视频](http://blog.wekeroad.com/mvc-storefront/kona-3/)。在视频中，他展示了如何使用[MSpec](http://codebetter.com/blogs/aaron.jensen/archive/2008/09/02/mspec-v0-2.aspx)，所以我下载了它并使用了这些位。我现在想要将[MSpec](http://codebetter.com/blogs/aaron.jensen/archive/2008/09/02/mspec-v0-2.aspx)与 MS Build 集成，但我不知道如何......我使用 TFS 团队构建作为我的 CI 服务器 - 你能帮我将[MSpec](http://codebetter.com/blogs/aaron.jensen/archive/2008/09/02/mspec-v0-2.aspx)与 MSBuild 集成吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T15:25:24.197

目前最简单的方法是执行它。

```
 <Target Name="RunSpecs">
    <PropertyGroup>
      <MSpecCommand>
        lib\machine\specifications\Machine.Specifications.ConsoleRunner.exe $(AdditionalSettings) path\to\your\project\bin\Debug\Your.Project.Specs.dll path\to\your\other\project\bin\Debug\Your.Other.Project.dll 
      </MSpecCommand>
    </PropertyGroup>
    <Message Importance="high" Text="Running Specs with this command: $(MSpecCommand)"/>
    <Exec Command="$(MSpecCommand)" />
  </Target> 
```

编辑：注意附加设置，您可以像这样调用目标：

```
 <MSBuild Projects="yourmsbuild.msbuild" Targets="RunSpecs" Properties="AdditionalSettings=-s -t -i &quot;web&quot; --html Specs\Specs.html"/> 
```

如果您将 --teamcity 作为参数传递，它会输出特定于 teamcity 的日志数据，以便 TeamCity 跟踪您的测试。

```
Machine.Specifications
Copyright (C) 2007, 2008

Usage: mspec-runner.exe [options] <assemblies>
Options:
  -i, --include     Executes all specifications in contexts with these comma delimited tags. Ex. -i "foo,bar,foo_bar"
  -x, --exclude     Exclude specifications in contexts with these comma delimited tags. Ex. -x "foo,bar,foo_bar"
  -t, --timeinfo    Shows time-related information in HTML output
  -s, --silent      Suppress console output
  --teamcity        Reporting for TeamCity CI integration.
  --html <PATH>     Outputs an HTML file(s) to path, one-per-assembly w/ index.html (if directory, otherwise all are in
one file)
  -h, --help        Shows this help message 
```

# c# - 在 C# 中，整数文字是什么类型？

> ID：938351
> 
> 赞同：1
> 
> 时间：2009-06-02T07:41:45.367
> 
> 标签：c#, integer

我只是注意到，如果我在函数参数中传递一个值，例如 1，如果它除了 int、long 并且我假设其他参数之外，它将起作用。但是，如果我执行 int i = value，则不会。我想知道，它是什么类型的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T07:49:03.713

```
(1).GetType().ToString() //is System.Int32 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T07:50:50.277

您可以为文字整数添加后缀以使类型显式，否则该值将被隐式解释为好像它是目标类型（假设它不会溢出目标）。

```
var myLong = 123L;
var myInt = 123;
var myByte = (byte)123; // i'm not aware of a suffix for this one

// unsigned variants
var myULong = 123UL;
var myUInt = 123U; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T07:51:16.703

看一下[整数文字规范](http://msdn.microsoft.com/en-us/library/aa664674(VS.71).aspx)：

> 整数文字的类型确定如下：
> 
> *   如果字面量没有后缀，则它具有可以表示其值的第一种类型：int、uint、long、ulong。
> *   如果文字以 U 或 u 为后缀，则它具有可以表示其值的第一种类型：uint、ulong。
> *   如果文字以 L 或 l 为后缀，则它具有可以表示其值的第一种类型：long、ulong。
> *   如果文字以 UL、Ul、uL、ul、LU、Lu、lU 或 lu 为后缀，则为 ulong 类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T07:46:40.160

据我了解，编译器将在编译时使用类型提示来确定文字的类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T07:47:43.480

类型是确定的。

如果你有这个功能：

```
public void SomeFunc( long i ); 
```

你这样称呼它：

```
SomeFunc (1); 
```

然后 C# 将把这个 '1' 看作是一个长的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T07:54:12.547

`int`默认情况下是整数文字，但由于存在从`int`to的隐式转换`long`，您仍然可以调用采用 a`long`和a 的方法`int`。

# sql - 使用 TSQL，我可以将 CHAR(1) 列加一并在没有 CASE 语句的 LEFT OUTER JOIN 中使用它吗？

> ID：938357
> 
> 赞同：6
> 
> 时间：2009-06-02T07:44:44.360
> 
> 标签：sql, sql-server, database, algorithm, tsql

[这个问题和我上一个问题](https://stackoverflow.com/questions/899502/can-i-use-sql-to-find-missing-numbers-in-the-example-table-i-give-below)类似。除了这次我使用字母而不是 6 位整数。我想找出乱序的“字母”。

假设我有以下数据：

```
id | Date | Letter
-----------------------------
01 | 5/1/2009 | X
02 | 5/1/2009 | Y
03 | 5/1/2009 | Z
04 | 5/1/2009 | A
05 | 5/1/2009 | B
06 | 5/1/2009 | D 
```

我希望能够提出一个查询，告诉我在第 05 行和第 06 行之间应该有一行带有“C”的行。

在我的最后一个问题（使用 INT）中，我得到了类似于以下解决方案的内容，并且效果很好。

```
SELECT * from TABLE1 t1 
LEFT OUTER JOIN TABLE2 t2 ON t2.INTCol - 1 = t2.INTCol AND t1.date = t2.date
WHERE t2.id IS NULL 
```

好吧，用字母（据我所知）我不能说（G - 1）。那么，还有其他方法可以做到这一点吗？

我正在使用的数据库是 SQL Server 2005。我相信在 PL/SQL 中有一个使用 TRANSLATE 的简单解决方案，但我不能像使用 TSQL 那样做任何事情。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T07:49:37.470

您可以使用将 char(1) 转换为其 ascii 数字

```
ASCII(Letter) 
```

然后，您可以将其加一并使用 CHAR（如有必要）将其返回为一个字母，因此您的代码将是：

```
SELECT * from TABLE1 t1 
LEFT OUTER JOIN TABLE2 t2 
      ON ASCII(t1.INTCol) - 1 = ASCII(t2.INTCol) 
      AND t1.date = t2.date
WHERE t2.id IS NULL 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T07:48:31.357

您可以使用 ASCII() 函数将字符转换为其 ASCII 值：

**ASCII（字母）**

# asp.net - 使用 ASP.NET 请求用户获取 Log4net 日志条目

> ID：938361
> 
> 赞同：3
> 
> 时间：2009-06-02T07:46:11.393
> 
> 标签：asp.net, log4net

我的 ASP.NET 站点正在使用集成身份验证并关闭了模拟。我在 web.config 中的“conversionPattern”中添加了一个“%username”，以将用户名添加到每个日志记录条目。但是，这将使用应用程序池身份的用户名，而不是当前访问用户的名称。

关于如何最好地做到这一点的任何想法？我必须编写自定义附加程序吗？我不介意任何轻微的性能损失，因为这是一个小型 Intranet 站点。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T05:59:18.010

在最新版本的 log4net 中有内置的 ASP.NET 模式转换器：

```
%aspnet-request{REMOTE_ADDR} and %aspnet-request{AUTH_USER} 
```

[https://stackoverflow.com/a/7788792/74585](https://stackoverflow.com/a/7788792/74585)

您还可以访问以下内容

*   aspnet 缓存
*   aspnet 上下文
*   aspnet 会话

[https://logging.apache.org/log4net/log4net-1.2.13/release/sdk/log4net.Layout.PatternLayout.html](https://logging.apache.org/log4net/log4net-1.2.13/release/sdk/log4net.Layout.PatternLayout.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T08:49:16.913

您可能想要查看的另一种（更简单的）解决方案是使用[`ThreadContext`](http://logging.apache.org/log4net/release/sdk/log4net.ThreadContext.html)类（以前实现为[`MDC`](http://logging.apache.org/log4net/release/sdk/log4net.MDC.html)and[`NDC`](http://logging.apache.org/log4net/release/sdk/log4net.NDC.html)类）。在您记录第一条消息之前，您可以在`HttpModule`（在请求到达您的页面之前）或其他任何地方有这样的东西：

```
ThreadContext.Properties["user"] = username; 
```

然后在您的转换模式中包含以下内容：

```
%property{user} 
```

# iphone - 尝试连接到 iPhone 时出现意外错误

> ID：938364
> 
> 赞同：0
> 
> 时间：2009-06-02T07:47:30.360
> 
> 标签：iphone, xcode

```
Your mobile device has encountered an unexpected error(0xE800002E)
Try disconnecting and powering off the device;then power the device on and reconnect it. 
```

我多次收到这些信息。我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T08:48:54.870

虽然在 XCode 中连接时可以看到此错误，但它实际上并不是 Xcode 缺陷。

在 Apple 的讨论板上查看[此线程。](http://discussions.apple.com/thread.jspa?threadID=1632644&tstart=0)你基本上需要重置你的手机。我不确定，但我认为看到此错误与使用手机进行开发之间可能存在联系，但我没有具体证据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T15:40:43.290

我发现如果我插入我的设备并将其设置为自动运行 iPhoto - 那么你必须让 iPhoto 加载并让它在你退出之前尝试同步照片。然后您应该能够使用 XCode 将应用程序加载到您的手机上。

如果您确实收到错误 - 拔下设备，将其关闭然后重新打开，这通常可以解决问题

# bash - bash：如何分隔字符串以查找文件

> ID：938380
> 
> 赞同：0
> 
> 时间：2009-06-02T07:51:16.063
> 
> 标签：bash, find

我应该在 bash 脚本中使用什么语法来根据 3 个动态值列出文件： - 早于 X 天 - 在指定目录中 - 其名称包含指定字符串？

```
FILEAGE=7
FILEDIR='"/home/ecom/tmp"'
FILESTRING='"search-results-*"'
FILES_FOR_REMOVAL=$("/usr/bin/find "${FILEDIR}" -maxdepth 1 -type f -mtime +${FILEAGE} -name "${FILESTRING}" -exec ls -lth {} \;")
echo ${FILES_FOR_REMOVAL} 
```

如果我尝试上述方法，我会得到：

```
-bash: /usr/bin/find "/home/ecom/tmp" -maxdepth 1 -type f -mtime +7 -name "search-results-*" -exec ls -lth {} \;: No such file or directory 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T08:05:46.660

删除多余的引号：

```
FILEAGE=7
FILEDIR='/home/ecom/tmp'
FILESTRING='search-results-*'
FILES_FOR_REMOVAL=$(/usr/bin/find "${FILEDIR}" -maxdepth 1 -type f -mtime +${FILEAGE} -name "${FILESTRING}" -exec ls -lth {} \;) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T12:28:53.243

*（我不能添加评论，但是...）*

为了可靠地处理**带有空格**的文件名，您可能需要考虑将文件列表存储在临时文本文件中而不是变量中，并使用 while 构造（而不是 for）循环遍历它

例如：

```
FILEAGE=7
FILEDIR='/home/ecom/tmp'
FILESTRING='search-results-*'

TEMPFILE=".temp${RANDOM}"
CMD="find \"${FILEDIR}\" -maxdepth 1 -type f -mtime +${FILEAGE} -name \"${FILESTRING}\" -exec /bin/ls -lth '{}' \;"

$CMD > $TEMPFILE # write output to file
while read thefile; do
    do_somthing_to $thefile
done < $TEMPFILE

rm $TEMPFILE # clean up after 
```

或者，如果您只打算使用该列表一次，则将输出直接通过管道传输到 while 构造：

```
$CMD | while read thefile; do
    do_something_to $thefile
done 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T08:07:07.140

您的“查找”语法看起来不错。尝试删除命令字符串周围的引号，即

```
FILES_FOR_REMOVAL=$(/usr/bin/find "${FILEDIR}" -maxdepth 1 -type f -mtime +${FILEAGE} -name "${FILESTRING}" -exec ls -lth {} \;) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T08:07:34.627

```
FILEAGE=7
FILEDIR='/home/ecom/tmp'
FILESTRING='search-results-*'
/usr/bin/find "${FILEDIR}" -maxdepth 1 -type f -mtime +${FILEAGE} -name "${FILESTRING}" -exec /bin/ls -lth '{}' \; 
```

有一些额外的引号引起了错误。还要指定 /bin/ls 的完整路径以避免 ls(1) 的潜在别名问题。为了在单独的行上获取文件名，我删除了 $FILES_FOR_REMOVAL 变量。你也可以使用

```
/usr/bin/find "${FILEDIR}" -maxdepth 1 -type f -mtime +${FILEAGE} -name "${FILESTRING}" -ls 
```

# asp.net - asp.net 列表框问题

> ID：938383
> 
> 赞同：0
> 
> 时间：2009-06-02T07:52:10.057
> 
> 标签：asp.net, listbox, selectedindexchanged

foreach (o.list 中的书 b) { ListBox_Items.Items.Add(b.Title); }

完成此操作后，标题现在显示在列表框中。

当我进行选择（单一模式）时，ListBox_Items（屏幕）突出显示所选行，但未`SelectedIndexChanged`触发事件。

```
protected void ListBox_Items_SelectedIndexChanged(object sender, EventArgs e)
{
  int i = ListBox_Items.SelectedIndex;
}

ID="ListBox_Items" runat="server" EnableViewState="False" Width="400px" Rows="25" onselectedindexchanged="ListBox_Items_SelectedIndexChanged" 
```

有任何想法吗 ？

迈克尔

编辑1：感谢大家的帮助。现在可以开始工作了。无论如何，我也必须将 EnableViewState 设置为 True。因为我有一个“删除”按钮来从列表框控件中删除项目，所以如果 EnableViewState 为 False，每当我单击“删除”按钮时，列表框就会再次变为空。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T08:00:52.987

添加`AutoPostBack="True"`你的 aspx 标签

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T08:03:36.117

你有什么可以让页面回传到服务器吗？

您可能需要一个提交按钮，或者您可以将属性 AutoPostBack="true" 添加到您的 ListBox 控件。

有关详细信息，请参阅此 MSDN 文章。

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listcontrol.autopostback.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listcontrol.autopostback.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T08:12:17.363

试试下面的代码。

```
<asp:ListBox ID="ListBox_Items" 
             runat="server" 
             EnableViewState="False" 
             Width="400px" 
             Rows="25" 
             OnSelectedIndexChanged="ListBox_Items_SelectedIndexChanged"
             AutoPostBack="true"></asp:ListBox> 
```

# sed - 在 sed/awk 中对行范围执行操作

> ID：938392
> 
> 赞同：2
> 
> 时间：2009-06-02T07:54:27.523
> 
> 标签：sed, awk

如何从 sed/awk 中特定范围的行中提取某些变量？

示例：我想从第 105 行开始的这一部分中提取 .tnsnames.ora 中的主机和端口。

```
DB_CONNECTION=
   (description=
     (address=
         (protocol=tcp)
         (host=127.0.0.1)
         (port=1234)
      )
      (connect_data=
         (sid=ABCD)
         (sdu=4321)
  ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T13:25:30.507

gawk 可以在字段分隔符（FS）中使用正则表达式。

'$0=$2' 总是正确的，所以这个脚本会自动打印 $2。

```
$ gawk -F'[()]' 'NR>105&&NR<115&&(/host/||/port/)&&$0=$2' .tnsnames.ora 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T08:11:19.033

采用：

sed '105,$< 你想要的任何 sed 代码 >'

如果您特别想要主机和端口，您可以执行以下操作：

```
sed .tnsnames.ora  '105,115p'|grep -e 'host=' -e 'port=' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T09:47:51.600

您可以使用地址范围来指定应用正则表达式的部分。如果您留下结束行地址（保留逗号），它将与文件末尾匹配。您还可以通过多次使用“-e”来“链接”多个表达式。以下表达式只会将端口和主机值打印到标准输出。它使用反向引用 (\1) 来打印匹配的部分。

```
sed -n -e '105,115s/(port=\([0-9].*\))/\1/p' -e '105,115s/(host=\([0-9\.].*\))/\1/p' tnsnames.ora 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T18:02:18.640

@lk，解决您发布的答案：

您可以像 C 一样编写 awk 代码，但它更简洁地表示为“模式 {action}”对。

如果您有[gawk](http://www.gnu.org/software/gawk/manual/gawk.html)或[nawk](http://docs.sun.com/app/docs/doc/816-5165/nawk-1?a=view)，则字段分隔符是[ERE](http://docs.sun.com/app/docs/doc/816-5175/regex-5?a=view#EXTENDED%20REGULAR%20EXPRESSIONS)，正如 Hirofumi Saito 所说

```
gawk -F'[()=]' '
    NR < 105 {next}
    NR > 115 {exit}
    $2 == "host" || $2 == "port" {
        # do stuff with $2 and $3
        print $2 "=" $3
    } 
' 
```

# templates - 如何在 joomla 模板上添加新的模数位置？

> ID：938400
> 
> 赞同：0
> 
> 时间：2009-06-02T07:56:33.917
> 
> 标签：templates, joomla, module, add-in, position

我正在使用一个名为“decayed”的 joomla 模板，它没有正确的位置，只有左边的位置，仅此而已。

我想在该模板上添加一个权利和一个按钮位置。我该怎么做？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T08:12:01.217

假设您使用的是 joomla 1.5，请进入模板目录 (/templates/someTemplateName/)。我对这个主题一无所知，但如果它遵循 joomla 模板的标准方案，则修改这两个文件：

1) 索引.php

```
 <jdoc:include type="modules" name="myModulePosition" /> 
```

将它添加到您希望模块出现在模板中的任何位置（并将“myModulePosition”替换为您希望模块位置命名的任何位置）。

2) 模板详情.xml

找到 xml 标签，应该看起来像这样：

```
 <positions>
        <position>left</position>
    </positions> 
```

并为您的新职位添加一个新标签，例如：

```
 <positions>
        <position>left</position>
        <position>myModulePosition</position>
    </positions> 
```

这样，当您添加/修改模块时，您的模块位置将显示在可用位置列表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-23T10:15:46.960

斯科特解决方案可能根本不起作用。

我只是通过在**#__modules**表中的数据库查找模块并在**“位置”**字段中添加所需位置的名称来做到这一点，这很难，但它工作得很好

# c# - .NET 调试日志

> ID：938401
> 
> 赞同：1
> 
> 时间：2009-06-02T07:58:05.147
> 
> 标签：c#, logging

我有一个使用 .NET 库的 ASP.NET 应用程序。我想启用日志记录到某处以便稍后检查错误消息。

我会将 ASP.NET 应用程序和 .NET 库记录到同一个地方或不同的地方。我不知道该怎么做。

我更喜欢使用 System.Diagnostics。来自 .NET Framework 而不是 3rd 方框架，但我不知道这是否是更好的解决方案。

我想记录错误消息，有时还想记录自定义消息。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T08:50:34.133

.NET 有很多日志记录框架，如果你想在应用程序中拥有强大而灵活的日志记录，那么你应该使用[3rd 方框架之一](https://stackoverflow.com/questions/126540/what-is-your-net-logging-framework-of-choice)，我更喜欢 log4net。仅使用 .Net Framework 的类也有几种方法可以做到这一点。

例如，您可以使用以下方法：

1.  最简单的方法是创建您个人的记录器实现，例如，您可以在您想要将某些内容记录到某处的地方使用 File.AppendAllText。如果您想使用 SQL 数据库作为日志条目的存储，您可以使用填充适当插入查询的 SqlCommand 类，或者您可以定义另一种日志记录方式。但是不推荐这种方式，因为支持您的代码的其他人有很多机会知道众所周知的框架和实践的使用，并且他们没有任何机会知道您的实现，因此他们可能需要阅读更多内容代码量。

2.  您可以使用 EventLog 类。我们使用它来记录我们的服务和 ASP.NET 应用程序中发生的严重错误（如未处理的异常）。它将允许您无条件地将日志记录到系统范围的存储中。该存储将可从 Microsoft 管理控制台 (mmc) 访问，并且该存储将是可配置的。

3.  您还可以使用 Debug.WriteLine 或 Trace.WriteLine 之类的东西进行日志记录。在这种情况下，您将能够通过编辑 web.config 文件来配置日志侦听器。您将能够启用或禁用日志记录、更改日志记录方式（日志到文件、事件日志或其他内容）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T08:12:41.963

我已经使用[ELMAH](http://code.google.com/p/elmah/)大约一年了，它是一个很棒的工具。ELMAH 在您的 .NET 应用程序中捕获任何未处理的异常，并且可以记录到 db、xml 或向您发送包含堆栈跟踪信息的电子邮件。

这篇[dotnetslackers](http://dotnetslackers.com/articles/aspnet/ErrorLoggingModulesAndHandlers.aspx) [文章](http://dotnetslackers.com/articles/aspnet/ErrorLoggingModulesAndHandlers.aspx)是让我启动并运行的一个很好的开始。在过去的一年中，我在大约 6 个项目中使用了 ELMAH，并取得了很好的效果。配置很简单。这一切都是通过在您的 Web 项目中引用 .dll，然后在 web.config 文件中设置值来完成的。捕获的调试信息非常详细。您将获得完整的堆栈跟踪以及当时请求的所有服务器变量的捕获。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T08:03:33.340

[ELMAH](http://code.google.com/p/elmah/)似乎是目前 ASP.NET 中使用的流行框架

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T08:05:35.100

我使用[nlog](http://www.nlog-project.org/)取得了巨大的成功。它很旧但可靠。您可以配置不同的目的地和不同的消息。

# flash - 键盘焦点被 Flash 窃取

> ID：938403
> 
> 赞同：33
> 
> 时间：2009-06-02T07:58:39.450
> 
> 标签：flash, keyboard, focus

执行搜索时，我注意到几个专门针对如何窃取/捕获访问者键盘焦点的问题。考虑到这个网站致力于编程，这并不令人惊讶。我想知道是否有人可以建议我如何防止这种行为。失去键盘焦点闪烁基本上会删除我的浏览器的功能，直到我使用鼠标单击其他地方（我使用 Mozilla Firefox）。有人知道某种插件或greasemonkey脚本可以防止我的键盘焦点被盗吗？由于必须使用鼠标将键盘焦点返回给浏览器，普通浏览器“快捷方式”变得无用。

编辑：回复下面的帖子，我确实有 flashblock / noscript 和其他一些东西。我的问题是我想看到/与窃取我的注意力进行交互的闪光。基本上是在寻找我可以切换的东西，以防止 Flash 获得键盘焦点或强制我的 Firefox 键盘命令到浏览器的方法

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-05-24T01:18:28.390

不幸的是，它是近十年前[众所周知的 FF 错误](https://bugzilla.mozilla.org/show_bug.cgi?id=78414)（现在也在 Chrome 中），它在 IE 中不存在。所有`Ctrl`+ `T`、`Ctrl`+ `Tab`、`Ctrl`+`W`等键都在焦点位于 Flash 对象上时停止工作。

更糟糕的是，似乎还没有人知道它的修复方法（参见上面的线程）。一些 IBM 人员[对 Linux 进行了 hack 修复](http://www.ibm.com/developerworks/opensource/library/os-78414-firefox-flash/index.html)，但没有针对 Windows。这真的很烦人。

[2013 年 3 月更新：在 google chrome 版本“24.0.1312.52 m”中，我假设更高版本， `Ctrl`+`Tab`键不会失去焦点以闪烁]

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-07-20T17:13:19.617

似乎没有`CTRL`或`ALT`组合可以释放焦点。唯一有效的是操作系统的。它不能帮助您转到另一个窗口，焦点仍然存在，不，您不能更改选项卡，关闭它或做任何您通常使用键盘所做的事情。

我在没有鼠标的情况下使用我的电脑有一段时间了，这是我遇到的第一个实际问题（除了缺少某些网站的拖放功能和面临无法访问的按钮（如图标）之外）。所以那些面临同样困境并且不想完全关闭Firefox的人，你仍然可以使用`ALT`专注于应用程序的工具栏（至少在Windows中）。但是，没有关闭选项卡的选项，但您可以从历史记录中选择任何其他站点（例如，您的主页首先带有 h 字母），然后最后关闭选项卡。

所以（至少在 Windows 中使用`FF5`）例如在英文版的 Firefox 中，您可以输入： ++`ALT`然后 返回使用`S``H``ALT``←</kbd> (or close the tab with `CTRL`+`W` or `CTRL`+`F4`).`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-26T15:12:54.823

类似问题： [Flash 窃取浏览器焦点](https://stackoverflow.com/questions/254111/flash-steals-browser-focus)

（不被接受但看起来很有希望）的答案：

```
 document.body.focus(); 
```

可能对你有用。这很容易被戏弄。大概。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-01T16:18:36.680

在使用 Firefox 4 的 Mac OSX 10.6 上，如果插件（flash）具有焦点并且您的选项卡无法使用`Cmd`+`1`或`Cmd`+`T`用于新选项卡等。

首先使用`Cmd`+`L`给浏览器地址栏焦点，然后使用`Cmd`+`1`等...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-07T00:10:55.727

**Alt-Tabbing**到您当前的应用程序将返回焦点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-18T18:47:00.530

首先，检查以确保您使用的是高于 6.0 版的 Flash 播放器。此外，另一位响应者是正确的。FireFox 不应该自动关注内联 Flash 内容……它不是这样设计的。

其次，这不仅仅是一个烦恼，这是一个可访问性问题。那些只能使用键盘或屏幕阅读器等辅助设备导航的用户将无法逃脱……因为他们不/不能使用鼠标。

要避免在键盘导航中出现 Flash，或从 Web 浏览器和屏幕阅读器中隐藏不重要的 Flash 内容，请将值为 opaque 的 wmode 选项添加到包含 Flash 影片或 swf 的网页的 object 和 embed 标记。

代码示例：

```
<object ...>
<param name="wmode" value="opaque">
<embed wmode="opaque" ...>
</embed>
</object> 
```

这将有效地从屏幕阅读器/辅助设备和键盘隐藏 Flash 电影。它仍然会在页面中可见，但在页面中导航时，键盘将绕过 Flash 内容，屏幕阅读器将表现得好像它甚至不存在一样。

然而！！！！如果电影/swf 确实包含重要信息，请在页面中单独显示 Flash 电影，或包含下载最新版本 Flash 播放器的链接并告知用户他们需要使用此版本。-- 当然，你应该让你的 Flash 键盘可以导航。

FLASH 的衰落：本机键盘可导航 Flash 仅 — 我重复仅在 Internet Explorer 中可用...因为 Adob​​e/Macromedia 设计了“可访问 Flash”以使用 MSAA（Microsoft Active Accessibility）技术，并且唯一支持 MSAA 技术的浏览器是IE浏览器。

# cocoa - NSString stringWithCString:length: 是否保留我传入的字节数组？

> ID：938408
> 
> 赞同：2
> 
> 时间：2009-06-02T07:59:48.900
> 
> 标签：cocoa, memory-management, nsstring

我正在使用 AsyncSocket ，其中 AsyncSocket 对象在从远程端接收数据时调用下面的委托方法：

```
- (void)onSocket:(AsyncSocket*)socket didReadData:(NSData*)data withTag:(long)tag; 
```

现在，在这个方法中，我将 NSData 对象传递给以下命令，以获取接收到的数据的 NSString 表示：

```
NSString *body = [NSString stringWithCString:[data bytes] length:[data length]; 
```

NSString stringWithCString:length: 是否保留我传入的字节数组？我需要保留 NSData *数据吗？我需要在最后释放 NSString *body 吗？

谢谢。我想根据委托方法正确管理内存......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T20:54:47.353

> NSString stringWithCString:length: 是否保留我传入的字节数组？

不可能保留字节数组。只能保留对象。

> 我需要保留 NSData *数据吗？

不，因为字符串无法保留数据（它不知道）或其内容，所以字符串将复制字节。（想想如果你实现这个方法你会做什么：就是这样。）

让我们换个例子，看看如果你传入的是数据对象而不是字节，你会怎么做。

如果字符串确实保留了数据，那么您不必担心数据会从字符串中消失，因为字符串会保留它。如果它不保留它，则该字符串要么制作了自己的副本，要么根本不保存您的数据。

所以其他对象的保留无关紧要。不要担心他们。只关心谁拥有什么，并相应地保留或不保留。

> 我需要在最后释放 NSString *body 吗？

好吧，您没有保留它，没有分配它，也没有复制它。因此，您不拥有它。所以不行。

如果您确实想获得该对象的所有权，您可以保留它或制作（然后拥有）您自己的副本。然后你会释放它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-27T15:57:22.420

简单的答案与证据。NSString stringWithCString:encoding: 复制字节缓冲区来生成字符串。缓冲区由您来维护。

证明：

代码：

```
 const char* hardString = "Hello, World";
    char *buffer = nil;

    buffer = calloc(13, 1);
    bzero(buffer, 13);

    memcpy(buffer, hardString, 12);

    NSString *aString = [NSString stringWithCString:buffer encoding:NSUTF8StringEncoding];        
    NSLog(@"aString: %@  \t filled buffer:(%p) [%s]", aString, (void*)buffer, buffer);

    bzero(buffer, 13); 
    NSLog(@"aString: %@  \t zeroed buffer:(%p) [%s]", aString, (void*)buffer, buffer);

    free(buffer);
    NSLog(@"aString: %@  \t free'd buffer:(%p)", aString, (void*)buffer);

    buffer = nil;        
    NSLog(@"aString: %@  \t nulled buffer:(%p)", aString, (void*)buffer); 
```

结果：

```
aString: Hello, World    filled buffer:(0x10010a790) [Hello, World]
aString: Hello, World    zeroed buffer:(0x10010a790) []
aString: Hello, World    free'd buffer:(0x10010a790)
aString: Hello, World    nulled buffer:(0x0) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T12:23:58.167

您不必保留 NSData 数组，因为它的内容将被转换/复制到新的 NSString 对象中。

返回的 NSString 对象的保留计数为 1，但它已被添加到自动释放池中。
这意味着一旦自动释放池被销毁，它将自动释放。如果您使用 AppKit 创建的默认自动释放池，这将在当前事件循环处理结束时发生。所以如果你只在那个方法“onsocket:...”中使用这个字符串对象，你就可以了。

如果你想在离开方法后保留 NSString 对象，你应该保留它或通过像这样分配和初始化它来实例化它：
[[NSString alloc] initWithBytes:[...] length:[...] encoding:[. ..]]
这个 NSString 对象的保留计数也将是 1，但是当您不再需要它时，您必须显式释放它。

顺便提一句。[NSString stringWithCString:length:] 自 OSX 10.4 起已弃用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T12:37:04.503

福尔克是正确的；你应该`stringWithCString:encoding:`改用。

仅对象需要保留/释放；当您传入一个 C 字符串（它不是一个对象，与 NSString 不同）时，没有什么可以保留或释放。

当您使用*便利构造函数*时，NSString 的保留计数为 1，但已添加到自动释放池中，因此在您离开代码块后的某个时间，它将被释放。您不需要显式使用 alloc 和 init 方法来保留它。我的意思是，它是用 1 的保留计数创建的（但会自动释放）为 1。

如果你不对一个对象调用 init、retain、copy 或 mutableCopy，你可以假设它是自动释放的，你不需要显式释放任何东西。但是如果你想在代码块之外保留一个对象，你需要调用retain，然后在一段时间后释放它（通常在创建对象的类的dealloc方法中）。

# c# - C#：如何查看 Linq2SQL 实体是否在数据库中

> ID：938410
> 
> 赞同：5
> 
> 时间：2009-06-02T08:00:50.193
> 
> 标签：c#, linq-to-sql, datacontext

我想检查一个实体是否已经添加到数据库中。`a`那么，我怎样才能看到和之间的这种区别`b`？

```
var a = dataContext.Things.First(x => x.Name == something);
var b = new Thing { Name = something }; 
```

为了更清楚，如果我有这个：

```
var thing = dataContext.Things.FirstOrDefault(x => x.Name == something) 
            ?? new Thing { Name = something }; 
```

如何查看是否`thing`需要插入？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T08:19:23.543

如果您使用`FirstOrDefault`而不是，如果没有匹配项`First`，它将返回。`null`

至于知道是否需要插入 - 只需记住它是否为 null 开始：

```
var a = dataContext.Things.FirstOrDefault(x => x.Name == something);
bool needsInsertion = (a == null);
a = a ?? new Thing { Name = something }; 
```

或者，如果有一个 ID 字段`Thing`由数据库自动填充，您可以使用它来检测它是否已经在数据库中。

# sockets - EIO 错误代码是什么意思？

> ID：938412
> 
> 赞同：4
> 
> 时间：2009-06-02T08:01:42.597
> 
> 标签：sockets

我正在维护用户可以在其上部署 Web 应用程序的 Web 服务器软件。Web 应用程序作为单独的进程运行：Web 服务器启动一个 Web 应用程序进程，将 HTTP 请求转发给 Web 应用程序，并将 Web 应用程序的响应转发回 HTTP 客户端。Web 服务器和 Web 应用程序之间的通信是通过套接字进行的。

一些用户（= Web 应用程序开发人员）报告说，当他们写入将 Web 应用程序连接到 Web 服务器的套接字时，他们偶尔会遇到神秘的 EIO 错误（至少，他们认为是写入导致错误的套接字）。其他一些人报告说，他们在向 STDERR（重定向到日志文件）写入内容时也会收到此错误。重新启动 Web 服务器和 Web 应用程序可以在短时间内“修复”此问题。

EIO 是什么意思？我知道手册上写着“输入/输出错误”，但这个描述是尽可能模糊的。什么情况下会出现，和ECONNREFUSED/EPIPE/ENOTCONN/etc有什么区别？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-04T21:12:45.347

好吧，显然 EIO 可能在尝试写入断开连接的控制台设备时发生。

# ruby-on-rails - 如何使用 ActiveRecord 映射非标准表还是应该使用其他 ORM？

> ID：938413
> 
> 赞同：6
> 
> 时间：2009-06-02T08:01:47.243
> 
> 标签：ruby-on-rails, activerecord

我正在使用一个工具（UltraSms），它需要三个名为（smsin、smsout 和 smsparts）的表

我需要在具有其他表的同一个 Rails 应用程序中使用这些表。使用 ActiveRecrod，我知道按照惯例，表名必须是活动记录类名称的复数。有没有办法轻松地将它们映射到 ActiveRecrod 类，或者我应该找到手动方法来为它做 ORM？

谢谢，

谭

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-07T06:58:22.250

似乎在 Rails3.1 中，方法名称更改为`table_name=`，例如

```
class Mouse < ActiveRecord::Base
  self.table_name = "mice"
end 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-02T08:07:37.653

你可以这样做：

```
class MyClass < ActiveRecord::Base
  set_table_name "smsin"
end 
```

# .net - 交易.NET

> ID：938420
> 
> 赞同：0
> 
> 时间：2009-06-02T08:04:39.547
> 
> 标签：.net, transactions

我刚刚开始在 .NET 中使用 Transactions，但遇到了问题。在一个函数中（在我的 DAL 中），我使用事务范围。在函数结束时，我触发 Complete() 函数。

现在我对这个函数进行了测试，它也使用了事务范围。在这个测试函数结束时，我不会触发 complete() 函数，因此我的测试不会用测试数据填充数据库。这似乎工作正常。

我现在的问题是，如果我在我的测试函数中触发了 complete()，事务似乎完成了两次。这似乎是合乎逻辑的，因为我触发 Complete() 两次......但是有没有办法避免这种情况？有没有办法在不执行两次作用域的情况下触发 Complete() 函数两次...当然必须有嵌套事务的方法...？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T08:13:19.093

您需要了解[嵌套事务范围](http://www.pluralsight.com/community/blogs/jimjohn/archive/2005/06/18/11451.aspx)和[TransactionScopeOption](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscopeoption.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T08:10:06.417

我的理解是，如果你 Dispose 而不调用 Complete 事务将被滚动， TransactionScope 也[支持嵌套事务](https://stackoverflow.com/questions/1845517/nested-transactions-with-transactionscope)。混合搭配，你应该能够回滚测试所做的所有工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T08:10:53.077

尝试使用 RequiresNew 选项创建您的内部 TransactionScope：

```
new TransactionScope(TransactionScopeOption.RequiresNew) 
```

# c# - 从 WPF 应用程序获取应用程序的目录

> ID：938421
> 
> 赞同：180
> 
> 时间：2009-06-02T08:04:57.300
> 
> 标签：c#, .net, wpf

我找到了带有 AppDomain 的 Windows 窗体的解决方案，但是 WPF`Application`对象的等价物是什么？

* * *

## 回答 #1

> 赞同：353
> 
> 时间：2009-06-02T08:33:39.770

一种方法：

```
System.AppDomain.CurrentDomain.BaseDirectory 
```

另一种方法是：

```
System.IO.Path.GetDirectoryName(System.Diagnostics.Process.GetCurrentProcess().MainModule.FileName) 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-06-04T03:23:27.390

这是另一个：

```
System.Reflection.Assembly.GetExecutingAssembly().Location 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-09-02T20:39:35.430

您还可以使用命令行参数的第一个参数：

`String exePath = System.Environment.GetCommandLineArgs()[0]`

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-12-12T08:26:41.093

我简单地使用`string baseDir = Environment.CurrentDirectory;`它，它对我有用。

祝你好运

编辑：

我曾经删除过这种类型的错误，但我更喜欢编辑它，因为我认为这个答案的减号有助于人们了解错误的方式。:) 我知道上述解决方案没有用，我将其更改为`string appBaseDir = System.AppDomain.CurrentDomain.BaseDirectory;` 其他获取方法是：

```
1\. string baseDir =   
    System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location);
 2\. String exePath = System.Environment.GetCommandLineArgs()[0];
 3\. string appBaseDir =    System.IO.Path.GetDirectoryName
    (System.Diagnostics.Process.GetCurrentProcess().MainModule.FileName); 
```

祝你好运

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-02T08:25:33.263

```
String exePath = System.Reflection.Assembly.GetExecutingAssembly().GetModules()[0].FullyQualifiedName;
 string dir = Path.GetDirectoryName(exePath); 
```

试试这个！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-04-15T18:42:03.770

试试这个。别忘了`using System.Reflection`。

```
string baseDir = System.IO.Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-05-30T03:09:34.723

我试过这个：

```
 label1.Content = Directory.GetCurrentDirectory(); 
```

并获取目录。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-14T03:45:42.240

您也可以从 System.Windows.Forms 中自由使用 Application.StartupPath，但您必须添加对 System.Windows.Forms 程序集的引用！

# python - 在可能失败的构造函数中运行代码的坏习惯？

> ID：938426
> 
> 赞同：16
> 
> 时间：2009-06-02T08:05:55.130
> 
> 标签：python, oop, exception-handling, constructor

我的问题是一个设计问题。在 Python 中，如果“构造函数”中的代码失败，则对象最终没有被定义。因此：

```
someInstance = MyClass("test123") #lets say that constructor throws an exception
someInstance.doSomething() # will fail, name someInstance not defined. 
```

不过，我确实有一种情况，如果我从构造函数中删除容易出错的代码，就会发生大量代码复制。基本上，我的构造函数填充了一些属性（通过 IO，可能会出错），这些属性可以通过各种 getter 访问。如果我从构造函数中删除代码，我将有 10 个带有复制粘贴代码的吸气剂，例如：

1.  属性真的设置了吗？
2.  做一些 IO 动作来填充属性
3.  返回相关变量的内容

我不喜欢这样，因为我所有的 getter 都会包含很多代码。相反，我在一个中央位置执行我的 IO 操作，即构造函数，并填充我的所有属性。

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-06-02T09:35:25.980

`__init__`C++ 中的构造函数和Python 中的方法是有区别的。在 C++ 中，构造函数的任务是构造一个对象。如果失败，则不调用析构函数。因此，如果在抛出异常之前获取了任何资源，则应在退出构造函数之前完成清理。因此，有些人更喜欢两阶段施工，大部分施工在构造函数之外完成（呃）。

Python 有一个更简洁的两阶段构造（构造，然后初始化）。`__init__`但是，许多人将方法（初始化程序）与构造函数混淆了。Python 中的实际构造函数称为`__new__`. 与 C++ 不同，它不接受实例，而是返回一个。的任务`__init__`是初始化创建的实例。如果在 中引发异常`__init__`，则将按预期调用析构函数`__del__`（如果有），因为在调用时对象已经创建（即使它没有正确初始化）`__init__`。

回答你的问题：

> 在 Python 中，如果“构造函数”中的代码失败，则对象最终没有被定义。

这并不完全正确。如果`__init__`引发异常，则创建对象但未正确初始化（例如，未分配某些属性）。但是在它被提出的时候，你可能没有对这个对象的任何引用，所以属性没有被分配的事实并不重要。只有析构函数（如果有）需要检查属性是否实际存在。

> 这样做的正确方法是什么？

在 Python 中，初始化对象，`__init__`不用担心异常。在 C++ 中，使用[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)。

* * *

**更新**【关于资源管理】：

在垃圾回收语言中，如果您正在处理资源，尤其是数据库连接等有限资源，最好不要在析构函数中释放它们。这是因为对象以非确定性的方式被销毁，并且如果您碰巧有一个引用循环（这并不总是很容易分辨），并且循环中的至少一个对象定义了析构函数，它们将永远不会被摧毁。垃圾收集语言有其他处理资源的方法。在 Python 中，它是一个[with 语句](http://www.python.org/dev/peps/pep-0343/)。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-06-02T08:13:14.007

至少在 C++ 中，将容易出错的代码放入构造函数中没有任何问题——如果发生错误，您只需抛出异常。如果需要代码来正确构造对象，则真的没有其他选择（尽管您可以将代码抽象为子函数，或者更好地抽象为子对象的构造函数）。最坏的做法是半构造对象，然后期望用户调用其他函数以某种方式完成构造。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T09:27:38.583

这本身并不是坏习惯。

但我想你可能在这里追求不同的东西。在您的示例中，当 MyClass 构造函数失败时，不会调用 doSomething() 方法。试试下面的代码：

```
class MyClass:
def __init__(self, s):
    print s
    raise Exception("Exception")

def doSomething(self):
    print "doSomething"

try:
    someInstance = MyClass("test123")
    someInstance.doSomething()
except:
    print "except" 
```

它应该打印：

```
test123
except 
```

对于您的软件设计，您可以提出以下问题：

*   someInstance 变量的范围应该是什么？它的用户是谁？他们的要求是什么？

*   如果您的 10 个值之一不可用，应该在哪里以及如何处理错误？

*   应该在构建时缓存所有 10 个值，还是在第一次需要时一个一个地缓存？

*   是否可以将 I/O 代码重构为辅助方法，以便执行 10 次类似的操作不会导致代码重复？

*   ...

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-02T08:08:39.010

我不是 Python 开发人员，但总的来说，最好避免在构造函数中进行复杂/容易出错的操作。解决此问题的一种方法是在您的类中放置一个“LoadFromFile”或“Init”方法，以从外部源填充对象。这个 load/init 方法必须在构造对象之后单独调用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-02T08:12:52.837

一种常见的模式是两阶段构建，Andy White 也提出了这一建议。

第一阶段：常规构造函数。

第二阶段：可能失败的操作。

两者的整合：添加一个工厂方法来完成这两个阶段，并使构造函数受保护/私有，以防止在工厂方法之外实例化。

哦，我也不是 Python 开发人员。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T08:30:39.493

如果初始化各种值的代码确实足够广泛以至于不希望复制它（听起来就像是你的情况），我个人会选择将所需的初始化放入私有方法中，添加一个标志来指示是否初始化已经发生，如果尚未初始化，则让所有访问者调用初始化方法。

在线程场景中，您可能必须添加额外的保护，以防初始化只允许发生一次以获得有效语义（由于您正在处理文件，因此可能会或可能不会发生这种情况）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T08:45:05.033

同样，我对 Python 的经验很少，但是在 C# 中，最好尝试避免使用引发异常的构造函数。一个例子说明为什么你想把你的构造函数放在一个不可能用 try {} catch {} 块包围它的地方，例如在一个类中初始化一个字段：

```
class MyClass
{
    MySecondClass = new MySecondClass();
    // Rest of class
} 
```

如果 MySecondClass 的构造函数抛出一个你希望在 MyClass 中处理的异常，那么你需要重构上面的内容——它当然不是世界末日，而是一个不错的选择。

在这种情况下，我的方法可能是将容易失败的初始化逻辑移动到初始化方法中，并让 getter 在返回任何值之前调用该初始化方法。

作为一种优化，您应该让 getter（或初始化方法）将某种“IsInitialised”布尔值设置为 true，以表明不需要再次进行（可能成本高昂的）初始化。

在伪代码中（C#，因为我只会弄乱 Python 的语法）：

```
class MyClass
{
    private bool IsInitialised = false;

    private string myString;

    public void Init()
    {
        // Put initialisation code here
        this.IsInitialised = true;
    }

    public string MyString
    {
        get
        {
            if (!this.IsInitialised)
            {
                this.Init();
            }

            return myString;
        }
    }
} 
```

这当然不是线程安全的，但我不认为在 python 中经常使用多线程，所以这对你来说可能不是问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-02T09:46:49.497

尼尔似乎有一个好点：我的朋友刚刚向我指出了这一点：

[http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)

这基本上是尼尔所说的......

# python - 使用 auth.views 的 django 身份验证

> ID：938427
> 
> 赞同：2
> 
> 时间：2009-06-02T08:06:53.893
> 
> 标签：python, django, authentication, django-authentication

用户应在注册后和注销后重定向到登录页面。在这两种情况下，都必须显示一条指示相关消息的消息。

使用`django.contrib.auth.views.login`我如何发送这些 {{ info }} 消息。

一个可能的选择是将复制`auth.views`到新的注册模块并包含所有必要的东西。但这似乎还不够干。

什么是最好的方法。

### 更新：问题阐述：

对于正常情况，当您想向某些用户指示您可以使用的操作的响应时

```
request.user.message_set.create() 
```

这将创建一条消息，该消息显示在其中一个模板中并自动删除。

但是，此消息系统仅适用于继续具有相同会话 ID 的登录用户。在注册的情况下，用户没有经过身份验证，并且在由于会话更改而退出的情况下，无法使用该系统。

除此之外，内置函数`login`和`logout`函数`django.contrib.auth.views`返回一个“HttpResponseRedirect”，这使得无法向模板添加另一个变量。

我尝试在请求对象本身上进行设置

```
request.info='Registered' 
```

并在**不同的视图中检查**

```
try:
   info = request.info:
   del request.info
except:
   info = ''

#later
render_to_response('app/file',{'info':info}) 
```

即使这样也没有用。

显然，我可以定义一个已注册的.html 并在其中添加此静态消息，但我懒得编写另一个模板并尝试 DRY 实现它。

我意识到“注册”消息和“注销”消息的情况不同。我使用的 DRY 方法，我将写为答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T08:22:24.143

如果消息是静态的，您可以为这些视图使用自己的模板：

```
(r'^accounts/login/$', 'django.contrib.auth.views.login', {'template_name': 'myapp/login.html'} 
```

从[文档](http://docs.djangoproject.com/en/dev/topics/auth/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T19:46:44.363

我认为这个问题的最佳解决方案是使用“flash”类型的基于会话的消息传递系统。有几个浮动：[django-flash](http://djangoflash.destaquenet.com/)看起来非常好，我使用非常简单[的 django-session-messages 。](http://code.google.com/p/django-session-messages/)希望当我们到达 Django 1.2 时，这将被纳入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T10:13:34.357

您有请求上下文处理器将此类信息添加到要呈现的每个模板的上下文中。

这是做这种事情的“零影响”方式。您不更新任何视图函数，因此它符合 DRY 的一些定义。

请参阅[http://docs.djangoproject.com/en/dev/ref/templates/api/#id1](http://docs.djangoproject.com/en/dev/ref/templates/api/#id1)

首先，编写自己的 login.html 模板。

其次，编写您自己的上下文函数以提供必须插入到模板中的任何附加信息。

第三，更新设置以将您的上下文处理器添加到`TEMPLATE_CONTEXT_PROCESSORS`设置中。

# python - lambda函数及其参数的范围？

> ID：938429
> 
> 赞同：105
> 
> 时间：2009-06-02T08:07:04.237
> 
> 标签：python, lexical-closures

我需要一个与一系列 gui 事件几乎完全相同的回调函数。根据调用它的事件，该函数的行为会略有不同。对我来说似乎是一个简单的案例，但我无法弄清楚 lambda 函数的这种奇怪行为。

所以我在下面有以下简化代码：

```
def callback(msg):
    print msg

#creating a list of function handles with an iterator
funcList=[]
for m in ('do', 're', 'mi'):
    funcList.append(lambda: callback(m))
for f in funcList:
    f()

#create one at a time
funcList=[]
funcList.append(lambda: callback('do'))
funcList.append(lambda: callback('re'))
funcList.append(lambda: callback('mi'))
for f in funcList:
    f() 
```

这段代码的输出是：

```
mi
mi
mi
do
re
mi 
```

我期望：

```
do
re
mi
do
re
mi 
```

为什么使用迭代器会把事情搞砸？

我试过使用深拷贝：

```
import copy
funcList=[]
for m in ('do', 're', 'mi'):
    funcList.append(lambda: callback(copy.deepcopy(m)))
for f in funcList:
    f() 
```

但这也有同样的问题。

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2009-06-02T08:27:06.053

创建 lambda 时，它不会复制它使用的封闭范围内的变量。它维护对环境的引用，以便以后可以查找变量的值。只有一个`m`。每次循环都会分配给它。在循环之后，变量`m`具有 value `'mi'`。因此，当您实际运行稍后创建的函数时，它会在创建它的环境中查找 的值，届时该值`m`将具有 value `'mi'`。

此问题的一个常见且惯用的解决方案是`m`通过将 lambda 用作可选参数的默认参数来捕获创建 lambda 时的值。您通常使用同名的参数，因此您不必更改代码主体：

```
for m in ('do', 're', 'mi'):
    funcList.append(lambda m=m: callback(m)) 
```

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2009-06-02T08:14:33.270

这里的问题是`m`从周围范围中获取的变量（引用）。只有参数保存在 lambda 范围内。

要解决这个问题，您必须为 lambda 创建另一个范围：

```
def callback(msg):
    print msg

def callback_factory(m):
    return lambda: callback(m)

funcList=[]
for m in ('do', 're', 'mi'):
    funcList.append(callback_factory(m))
for f in funcList:
    f() 
```

在上面的示例中，lambda 还使用周围的范围来查找`m`，但这次`callback_factory`是每次`callback_factory` 调用创建一次的范围。

或使用[functools.partial](http://docs.python.org/library/functools.html#functools.partial)：

```
from functools import partial

def callback(msg):
    print msg

funcList=[partial(callback, m) for m in ('do', 're', 'mi')]
for f in funcList:
    f() 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-02T08:27:52.760

Python 当然确实使用了引用，但在这种情况下并不重要。

当您定义 lambda（或函数，因为这是完全相同的行为）时，它不会在运行时之前评估 lambda 表达式：

```
# defining that function is perfectly fine
def broken():
    print undefined_var

broken() # but calling it will raise a NameError 
```

比您的 lambda 示例更令人惊讶：

```
i = 'bar'
def foo():
    print i

foo() # bar

i = 'banana'

foo() # you would expect 'bar' here? well it prints 'banana' 
```

简而言之，考虑动态：在解释之前没有评估任何内容，这就是您的代码使用最新值 m 的原因。

当它在 lambda 执行中查找 m 时， m 取自最顶层范围，这意味着，正如其他人指出的那样；您可以通过添加另一个范围来规避该问题：

```
def factory(x):
    return lambda: callback(x)

for m in ('do', 're', 'mi'):
    funcList.append(factory(m)) 
```

在这里，当调用 lambda 时，它会在 lambda 的定义范围内查找 x。这个 x 是在工厂主体中定义的局部变量。因此，在 lambda 执行中使用的值将是在调用 factory 期间作为参数传递的值。还有多雷米！

作为说明，我可以将工厂定义为工厂（m）[用 m 替换 x]，行为是相同的。为了清楚起见，我使用了不同的名称:)

您可能会发现[Andrej Bauer](http://math.andrej.com/2009/04/09/pythons-lambda-is-broken/)遇到了类似的 lambda 问题。该博客上有趣的是评论，您将在其中了解有关 python 闭包的更多信息 :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T08:25:41.987

是的，这是范围的问题，它绑定到外部 m，无论您使用的是 lambda 还是本地函数。相反，使用仿函数：

```
class Func1(object):
    def __init__(self, callback, message):
        self.callback = callback
        self.message = message
    def __call__(self):
        return self.callback(self.message)
funcList.append(Func1(callback, m)) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-07-13T23:42:33.123

lambda 的解决方案是更多的 lambda

```
In [0]: funcs = [(lambda j: (lambda: j))(i) for i in ('do', 're', 'mi')]

In [1]: funcs
Out[1]: 
[<function __main__.<lambda>>,
 <function __main__.<lambda>>,
 <function __main__.<lambda>>]

In [2]: [f() for f in funcs]
Out[2]: ['do', 're', 'mi'] 
```

外部`lambda`用于绑定 to 的`i`当前`j` 值

每次`lambda`调用外部时，它都会创建一个内部实例，`lambda`并`j`绑定到`i`as的当前`i`值

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T08:20:56.863

首先，您所看到的不是问题，与按引用或按值调用无关。

您定义的 lambda 语法没有参数，因此，您使用参数看到的范围`m`在 lambda 函数之外。这就是您看到这些结果的原因。

Lambda 语法，在您的示例中不是必需的，您宁愿使用简单的函数调用：

```
for m in ('do', 're', 'mi'):
    callback(m) 
```

同样，您应该非常准确地了解您使用的 lambda 参数以及它们的范围开始和结束的确切位置。

作为旁注，关于参数传递。python中的参数总是对对象的引用。引用 Alex Martelli 的话：

> 术语问题可能是由于在 python 中，名称的值是对对象的引用。因此，您始终传递值（没有隐式复制），并且该值始终是引用。[...] 现在，如果您想为此命名，例如“按对象引用”、“按未复制的值”或其他任何名称，请成为我的客人。恕我直言，试图重用更普遍适用于“变量是框”的语言到“变量是便利贴标签”的语言的术语更容易混淆而不是帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T08:22:27.827

该变量`m`正在被捕获，因此您的 lambda 表达式始终会看到其“当前”值。

如果你需要有效地捕捉某一时刻的值，写一个函数，将你想要的值作为参数，并返回一个 lambda 表达式。此时，lambda 将捕获*参数的*值，当您多次调用该函数时，该值不会改变：

```
def callback(msg):
    print msg

def createCallback(msg):
    return lambda: callback(msg)

#creating a list of function handles with an iterator
funcList=[]
for m in ('do', 're', 'mi'):
    funcList.append(createCallback(m))
for f in funcList:
    f() 
```

输出：

```
do
re
mi 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-02T08:37:56.733

在 Python 中实际上没有经典意义上的变量，只有通过对适用对象的引用绑定的名称。甚至函数也是 Python 中的某种对象，而 lambdas 也不例外 :)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-07T09:26:57.183

作为旁注，`map`尽管被一些著名的 Python 人物所鄙视，但它强制构建了一种防止这种陷阱的结构。

```
fs = map (lambda i: lambda: callback (i), ['do', 're', 'mi']) 
```

注意：第一个`lambda i`在其他答案中就像工厂一样。

# events - Scala Swing 事件框架 - 我在哪里添加我的反应器？

> ID：938437
> 
> 赞同：6
> 
> 时间：2009-06-02T08:10:30.893
> 
> 标签：events, scala, scala-swing

我什至试图在 a 上捕捉鼠标点击`Table`（这应该会导致显示弹出窗口）。该表在 a 内`ScrollPane`，而（又）在 a 内`Panel`。我已经为所有课程添加了反应，但我似乎永远无法真正捕获点击事件！

```
class MyPanel extends GridBagPanel {
  val gbc = new GridBagContraints( ... )

  add(new ScrollPane {
    reactions += {
      case MouseClicked(src, point, mod, clicks, pops) =>
        println("Scroll pops: " + pops)
    } 

    viewportView = new Table {
      reactions += {
        case MouseClicked(src, point, mod, clicks, pops) =>
          println("Table pops: " + pops)
      } 

      ...
    }

  }, gbc)

  reactions += {
    case MouseClicked(src, point, mod, clicks, pops) =>
      println("Panel pops: " + pops)
  } 
} 
```

无论我在哪里单击，都不会打印任何内容。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T09:30:12.557

好的 - 你必须**听**正确的事情：

```
class MyPanel extends GridBagPanel {
  val gbc = new GridBagContraints( ... )

  val table = new Table { ... }

  add(new ScrollPane {

    viewportView = table
  }

  }, gbc)

  listenTo(table.Mouse.clicks) //THIS LINE IS IMPORTANT :-)

  reactions += {
    case MouseClicked(`table`, point, mod, clicks, pops) =>
      println("Panel pops: " + pops)
    } 
  }
} 
```

# eclipse - 通过插件以编程方式修改 Eclipse 工作区和 CDT 选项

> ID：938439
> 
> 赞同：2
> 
> 时间：2009-06-02T08:11:00.517
> 
> 标签：eclipse, eclipse-cdt

我想从插件中以编程方式修改 Eclipse 工作区（添加现有项目是我的主要要求）。我还想从该插件中修改 CDT 选项（环境、索引器选项）。

有谁知道如何最好地做到这一点，或者可以指出我关于该主题的良好文档？

**编辑：** 实际上我不想修改 CDT 项目设置，而是修改一些全局 CDT 设置（实际上我想禁用索引器）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T08:29:41.837

这取决于您要进行的修改类型。

例如，[这个线程](http://dev.eclipse.org/newslists/news.eclipse.tools.jdt/msg18827.html)最好地说明了添加一个项目。

```
String theProjName = "Test";
String theLocation = "/some/test/project";

try {
    IWorkspaceRoot theRoot = ResourcesPlugin.getWorkspace().getRoot();
    IProject theProject = theRoot.getProject(theProjName);
    IProjectDescription theDesc =       theProject.getWorkspace().newProjectDescription(theProjName);
        theDesc.setLocation(new Path(theLocation));
    theProject.create(theDesc, new NullProgressMonitor());
    if (theProject.exists()) {
        theProject.open(new NullProgressMonitor());
    }
} catch (CoreException err) {
    err.printStackTrace();
} 
```

您可能还想[打开一个编辑器](http://dev.eclipse.org/newslists/news.eclipse.platform/msg22481.html)：

```
IWorkbenchWindow dw = PlatformUI.getWorkbench().getActiveWorkbenchWindow();
try {
   if (dw != null) {
   IWorkbenchPage page = dw.getActivePage();
   if (page != null) {
    IDE.openEditor(page, file, true);                   
   }
}
} catch (PartInitException e) {

} 
```

更一般地说，[eclipse.dev.org](http://www.google.fr/search?hl=fr&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=igP&q=Programmatically+%22Eclipse+workspace%22+site%3Adev.eclipse.org&btnG=Rechercher&meta=)可以成为有关该主题的指针的良好来源。

* * *

自 2004 年以来，[CDT 提供了](http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.cdt-build/org.eclipse.cdt.managedbuilder.ui/ChangeLog?root=Tools_Project&view=co)您可以通过[Preference Setting Store](http://dev.eclipse.org/mhonarc/lists/cdt-dev/msg13563.html) ( `ICSettingsStorage`) 修改的选项。可能会有所帮助。

* * *

关于索引器，请注意[Discovery Preferences](http://dev.eclipse.org/newslists/news.eclipse.tools.cdt/msg12192.html)。
我[不确定是否有 Indexer API](http://dev.eclipse.org/newslists/news.eclipse.tools.cdt/msg17721.html)，但您可以[查看来源](http://dev.eclipse.org/newslists/news.eclipse.tools.cdt/msg11153.html)以获取更多线索。

# asp.net - Asp.net 管理工具的问题

> ID：938461
> 
> 赞同：0
> 
> 时间：2009-06-02T08:16:02.690
> 
> 标签：asp.net, vb.net

我已经在 asp.net 中创建了一个项目。现在我想在我的项目中实现 asp.net 管理工具以进行用户管理。该工具在网站中工作正常，但在项目中它不起作用。

实际上我已经使用以下链接来执行此操作：- [http://msdn.microsoft.com/en-us/library/bb515342.aspx](http://msdn.microsoft.com/en-us/library/bb515342.aspx)

当我在项目中实现此演练时，Profile.aspx.vb 显示错误。意味着在此演练中指定 profilecommon 将动态形成。在网站中它的工作。但在项目中它显示'ProfileCommon 未定义。我可能是什么原因？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-27T10:23:06.607

听起来您想实现自己的[ASP.NET 网站管理工具 (WSAT)](http://msdn.microsoft.com/en-us/library/yy40ytx0.aspx)版本，以便在您自己的网站“内部”使用。

您链接到的演练是可以的，但是，它不会创建任何特别通用的内容，并且可以简单地“放入”现有网站。

我建议看看这个教程：

[滚动您自己的网站管理工具](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

作为一种专门为用户/角色/会员管理创建自己的页面集的方式。如果您不想自己重新输入，您甚至可以下载文章的代码。不幸的是，此工具和本文中的代码是用 C# 编写的，但是，代码并不是特别复杂，应该能够使用许多可用的代码转换器工具之一轻松转换为 VB.NET。

还有本教程：
[制作网站上的用户和角色](http://www.asp.net/Learn/hosting/tutorial-16-vb.aspx)
，它是 VB 特定的，应该有助于构建您自己的 WSAT 类工具。

前段时间，在 CodePlex 网站上，有一个 ASP.NET WSAT Starter Kit 项目也用于相同的目的（并且可以说对“默认”WSAT 进行了相当大的改进），但是不幸的是，该项目不再存在。然而，经过一番搜索，该工具的代码似乎仍然可用，因此您也许也可以查看该工具（代码在 VB 中）。

您可以在此处找到：
[ASP.Net WSAT（网站管理）入门工具包。发生了什么？](http://forums.asp.net/p/1390061/3415574.aspx)
（检查页面底部的最后一篇文章）。

# iphone - 我可以阻止移动 Safari 自动旋转 ipod touch 或 iphone 上的屏幕吗？

> ID：938462
> 
> 赞同：0
> 
> 时间：2009-06-02T08:16:08.197
> 
> 标签：iphone, safari, ipod-touch

我们有一个正在开发的网络应用程序。它将用于内置于桌面的 ipod touch。由于它基本上是水平的，ipod 不断改变它的想法，并不断切换浏览器的方向。

有没有办法要求它停止这样做？如果没有，是否有其他浏览器可以让我防止任何人都可以推荐的屏幕旋转？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T08:55:01.410

如果您有 API 密钥，那么制作这样的应用程序将非常简单。只需将 a`UIWebView`插入笔尖并为地址栏连接一个文本字段。

如果您无法访问开发工具，请查看几乎每个应用程序中的内置浏览器。很少支持轮换。

我想有一个 3rd 方应用程序除了可能提供您需要的 Web 浏览器之外还具有一些替代功能。除此之外，超出了stackoverflow的范围……。

# c# - 为 windows mobile 模拟器相机设置图像

> ID：938463
> 
> 赞同：1
> 
> 时间：2009-06-02T08:16:14.780
> 
> 标签：c#, windows-mobile, windows-mobile-6

我正忙于开发一个针对 WM6 的 windows mobile 应用程序，我需要使用的功能之一是相机。在模拟器中，我可以很好地测试相机，但图像始终是黑色的（在黑白之间渐变）。我需要一种方法来为模拟器提供我已经拍摄的图像。目前要进行测试，我必须将应用程序部署到我的物理设备上，这大大减慢了这个过程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T08:23:55.233

在测试期间（在模拟器上）使用图像选择器而不是相机。

# c# - WPF中特定时间的弹出窗口？

> ID：938464
> 
> 赞同：2
> 
> 时间：2009-06-02T08:17:11.067
> 
> 标签：c#, wpf-controls

如何在 WPF 中的特定时间创建和显示弹出窗口？我的意思是如何在系统托盘的侧面显示窗口。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T09:01:45.237

如果您试图在一定数量的小时/秒/分钟内弹出事物（或计算出在您的特定时间到来之前还剩下多少小时/秒/分钟），您可以使用计时器。

```
private System.Windows.Threading.DispatcherTimer popupTimer;

// Whatever is going to start the timer - I've used a click event
private void OnClick(object sender, RoutedEventArgs e)
{
    popupTimer = new System.Windows.Threading.DispatcherTimer();

    // Work out interval as time you want to popup - current time
    popupTimer.Interval = specificTime - DateTime.Now;
    popupTimer.IsEnabled = true;
    popupTimer.Tick += new EventHandler(popupTimer_Tick);
}

void popupTimer_Tick(object sender, EventArgs e)
{
    popupTimer.IsEnabled = false;
    // Show popup
    // ......
} 
```

* * *

好的，所以您还想知道如何做一个通知弹出类型的事情，也许[CodeProject](http://www.codeproject.com/KB/WPF/WPF_TaskbarNotifier.aspx?display=Print)中的这篇文章可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T08:58:03.137

查看[此问题](https://stackoverflow.com/questions/725917/good-way-of-firing-an-event-at-a-particular-time-of-day)以在设定的时间触发事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T09:02:34.547

您可能想检查一下[`DispatcherTimer`](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer.aspx)。

# javascript - jquery动态添加表单字段问题

> ID：938465
> 
> 赞同：0
> 
> 时间：2009-06-02T08:17:45.747
> 
> 标签：javascript, jquery, forms, dynamic

我正在使用以下代码插入额外的表单字段。

```
function addFormField() {
$("#divTxt").append("<div id='education" + id + "'><input name='name' id='name' type='text' size='20'><a href='#' onClick='removeFormField(\"#education" + id + "\"); return false;'><img src='images/minus.gif' width='10px' border=0></img></a></div>");
} 
```

发生模糊事件时，我将字段值动态发送到 mysql。但是，当插入此字段时，它无法识别，并且当在新字段上输入任何值时，模糊事件也不会发生。这是因为原始模糊事件处理程序已在文档准备就绪时设置吗？

在文档就绪初始化完成后，如何让 mysql update jquery 代码识别额外的表单字段何时可见？我已经尝试了基于 div id 的各种事件，但无济于事.....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T08:27:12.980

您的代码不适用于动态添加的输入的原因是因为当您执行以下操作时：

```
$(selector).blur(myFunction); 
```

jQuery 遍历`selector` *在该点*匹配的每个元素，并添加一个事件处理程序，该事件处理程序在元素上发生事件被触发时`myFunction`运行。`blur`这意味着在这行代码运行*之后*`selector`添加的任何匹配元素都不会被绑定。

 *为了解决这个问题，jQuery 在 1.3 中引入了 live 函数。如文档所述：

> 将处理程序绑定到所有当前和未来匹配元素的事件（如单击）。也可以绑定自定义事件。

Unfortunately, as of right now jQuery does not support the `blur` event with the `live` function.

Your options then are:

A) Run the binding code everytime you add new inputs.
B) Use the [livequery](http://plugins.jquery.com/project/livequery) plugin, which is that `live` is based off of and does support blur.

Personally, I would go with A.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T08:22:02.617

你应该使用 live() 方法绑定你的事件：

例如：

```
$("input").live("blur", function() { ... }); 
```

这样，在运行时添加的任何字段都将绑定到事件处理程序。

编辑：正如评论中所指出的，“模糊”不受支持，但有一个插件支持此事件： http: [//plugins.jquery.com/project/livequery](http://plugins.jquery.com/project/livequery)

# asp.net-mvc - 如何创建“返回”链接？

> ID：938471
> 
> 赞同：4
> 
> 时间：2009-06-02T08:20:14.977
> 
> 标签：asp.net-mvc

我有一个从各个地方调用的详细信息页面，并且有一个很好的可读网址，例如

“www.mypage.com/product/best-product-ever”。

调用页面（产品列表）具有更复杂的 url，例如：

“www.mypage.com/offers/category/electronic/page/1/filter/manufacturer/sony/sort/price”和

“www.mypage.com/bestseller/this-week”。

如何从详细信息页面创建反向链接到调用产品列表？

*   我不能使用 javascript
*   我不想在 URL 中有调用页面，因为它会很长
*   我真的想要页面之间的链接，没有 http-post
*   我不能使用会话状态

编辑： Sessionstate 被排除，因为如果有 2 个 Windows 打开，那么它们将共享相同的“返回”页面信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T09:12:14.293

就像李说的，使用推荐人价值：

```
<a href="<%= Html.Encode(Request.UrlReferrer.ToString()) %>">Back</a> 
```

如果您不希望链接中的 URL 因为它太长，请尝试在 URL 上运行某种简单的压缩算法，将压缩数据显示为 unicode 文本，然后将压缩的 URL 作为参数附加到重定向页面，例如：

```
<a href="Redirect.aspx?u=compressed_url_goes_here">Back</a> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T09:06:06.553

使用referer 标头值怎么样？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T11:34:05.193

这是一个疯狂的想法，需要公平但工作，并且可能不利于性能（取决于您的用户）..但我们开始：

创建一个用于缓存“ `ListResults`”的存储库（并将其连接到您喜欢的数据库中。或者只是将其保留在服务器的内存中）。简而言之，这个 Repo 可以做的是存储 a `ListResult`，它将包括所有内容，以保持任何给定用户正在查看的列表的当前视图的状态。这可能包括路由和其他值。但本质上是重定向回过滤和排序列表的特定页面所需的所有内容。

当`ListResult`项目被添加到 repo 时，会生成一个小的唯一哈希/密钥，这将是 url 友好的 - 类似于“k29shjk4” - 它与日期时间戳一起添加到项目中。

`ListResult`s 仅从列表离开默认视图的那一刻起保留（即没有过滤、排序和第 1 页） - 这将对性能有所帮助。

一个`ListResult`项目可能永远不会真正被使用，但特定列表视图上的所有详细操作链接都将`ListResult.Key`哈希值添加到路由中。所以是的，它最终可能会成为一个查询字符串，但它会很短（对 url 友好），如果你想更多地弄乱路线，你可以进一步整理它。

对于“返回”到列表的导航，您可能需要一个新的小型控制器，它只接受`ListResult.Key`哈希值并从 repo 中的查找重定向/重新创建列表视图的状态（包括分页、过滤和排序）。

所以到目前为止我们已经满足了要求：在 url 中没有调用页面（从某种意义上说，它不是整个页面 - 只是它的哈希查找）；没有发布，没有会话，没有 js。

为了阻止`ListResult`repo 变大（并且很危险：如果将其持久化到数据库），您可以使用[ASP.NET 后台服务](https://blog.stackoverflow.com/2008/07/easy-background-tasks-in-aspnet/)通过时间戳定期修剪“旧”路由。并“扩展”`ListResult`当通过新控制器请求项目时，通过向项目的标记添加时间来持续使用的路线的生命周期。无需无限期地保留一条路线，因为如果用户想要一个指向列表视图的永久链接，他们可以为长列表路线本身添加书签。

希望这会有所帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T08:30:31.443

你有饼干吗？

如果是这样，你可以把它放在那里，或者用它来创建你自己的会话状态。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T08:33:22.860

我认为这更像是一个“返回结果”，然后是一个通用的“<< 返回”链接，因为您希望通用返回链接返回到基因列表，而不是您描述的经过严格过滤的列表，对吗？

我不知道这是否属于您的“无帖子”条件，但我能看到的唯一选项是让`Detail`操作仅限 POST ( `[AcceptVerbs(HttpVerbs.Post)]`) 并包含另一个参数，例如`string fullRoute`在详细信息页面上转换为“链接”对于“返回结果”。重载`Detail`缺少`fullRoute`参数的操作，并将重载的操作设为 GET 操作，这样就不需要 POST fullRoute 值（当用户可以使用“通用”“返回”链接时）。这应该同时为详细信息页面的“通用”GET 请求和 POST 请求提供服务，该请求将包括过滤列表的特定“返回结果”链接。

# debugging - AIX 中可用的运行时调试器有哪些？对于 C 语言？

> ID：938473
> 
> 赞同：-3
> 
> 时间：2009-06-02T08:21:02.197
> 
> 标签：debugging

AIX 中可用的运行时调试器有哪些？对于 C 语言？我知道我们有 dbx - 废话

* * *

gdb - 好但不起作用。

任何其他？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T08:42:57.847

对于 xlC，有 dbx 和 GUI 前端 xdbx。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-21T14:53:19.340

全视图。AIX 上最好的调试器。界面是旧帽子图案，但功能非常好。顺便说一句，擅长线程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-11T09:18:39.573

IBM 调试器 - /usr/idebug/idebug

GNU 调试器也应该可以工作 - /opt/freeware/bin/gdb

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-02T08:31:52.300

您是在询问 AIX 的本机 C 编译器吗？如果是这样，请咨询您的 IBM 销售员。您当然可以在 AIX 上运行[GCC](http://gcc.gnu.org/)，并使用 gdb 调试器。这有许多前端，其中最好的可能是[DDD](http://www.gnu.org/software/ddd/)。

# sql-server - 数据库设计征求意见

> ID：938476
> 
> 赞同：0
> 
> 时间：2009-06-02T08:21:29.683
> 
> 标签：sql-server, database-design, optimization

我需要存储模式的条目，例如（ID：int，description：varchar，updatetime：DateTime）。ID 是唯一的主键。使用场景是，我会经常插入新条目，经常按 ID 查询条目，不经常删除过期条目（通过 updatetime 字段，使用每天运行的另一个 SQL 作业以避免数据库不断增加）。每个条目的大小为 0.5k。

我的问题是如何在我的场景中优化数据库架构设计（例如添加索引、事务/锁定级别或其他选项的技巧）以提高性能？目前我计划将所有信息存储在一个表中，不确定它是否是最佳选择。

顺便说一句：我使用的是 SQL Server 2005/2008。

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T08:23:58.447

除了您的主键，只需在更新时间添加索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T10:13:26.057

需要审查您将所有内容存储在单个表中的决定。很少有主题可以真正由一张表很好地建模。

仅使用一个表所产生的问题通常不如没有创建正确的索引和类似的事情所产生的问题那么明显。

我对“描述”列（字段）感兴趣。是否所有描述都描述了同一种事物？您是否曾经检索过一组描述，而不是一次只检索一个描述？你如何将描述分组？

您如何知道要检索的描述的 ID？您是否将 ID 的副本存储在某个地方，以便参考您想要的那些？

你知道什么是“外键”吗？您是否故意选择不在此表中包含任何外键？

在您知道单表设计是否真的适合您的情况之前，这些是需要回答的一些问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T08:29:32.930

你的 ID 是你的主键，它自动有一个索引。您可以将到期日期放在另一个索引上。索引将帮助您进行搜索，但在插入、删除和更新时会降低性能。无论如何，一个索引不是问题。

这对我来说听起来有点奇怪——我并不是说这是一个错误——你在一个表中拥有所有信息。重新思考这一点。看看你是否可以重构一些东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T08:30:39.463

这听起来很简单，除了可能按照 OMax 的建议（我推荐）在 updatetime 上添加一个索引。

如果您还想按描述获取项目，您还应该考虑该列上的文本索引或全文索引。

除此之外 - 你准备好了:)

# javascript - javascript中有类似 (1==0 ? "no" : "yes") 的东西吗？

> ID：938482
> 
> 赞同：1
> 
> 时间：2009-06-02T08:23:19.167
> 
> 标签：javascript

javascript中有类似 (1==0 ? "no" : "yes") 的东西吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-02T08:24:35.187

是的，就像你写的那样：）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-02T08:27:34.120

JavaScript 有条件运算符，所以这样做是完全合法的：

```
var response = (1 == 0 ? "no" : "yes"); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-02T08:25:45.730

是的 - 它是[条件运算符](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Operators/Special_Operators/Conditional_Operator)，语法与您编写的完全一样。

# scala - 将@Autowired of spring 与 scala 一起使用

> ID：938485
> 
> 赞同：4
> 
> 时间：2009-06-02T08:24:24.827
> 
> 标签：scala, spring-mvc, spring, autowired

我正在使用来自 scala 的 spring，并且在尝试注入具有特征/超类的服务时遇到了问题。

这是我的代码：

```
trait MyServiceHolder{
  var myService:MyService = null

  @Autowired
  def setMyService(ms:MyService) = myService = ms
}

@RunWith(classOf[SpringJUnit4ClassRunner])
@ContextConfiguration(Array("file:src/main/webapp/WEB-INF/application-context.xml"))
class MyConcreteClass extends MyServiceHolder{

  def hello() = myService.hello()  

} 
```

这有效：

```
@RunWith(classOf[SpringJUnit4ClassRunner])
@ContextConfiguration(Array("file:src/main/webapp/WEB-INF/application-context.xml"))
class MyConcreteClass{

  var myService:MyService = null

  @Autowired
  def setMyService(ms:MyService) = myService = ms

  def hello() = myService.hello()  

} 
```

问题是 myService 在我的测试用例中为空。查看字节码级别（类文件）时，所有注释都存在。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T11:11:00.467

You need to use a form of the [Spring TestContext Framework](http://static.springframework.org/spring/docs/2.5.x/reference/testing.html#testcontext-framework) to have your beans configured by Spring when running tests.

# watin - Watin：处理安全警报弹出窗口

> ID：938507
> 
> 赞同：2
> 
> 时间：2009-06-02T08:32:32.097
> 
> 标签：watin

你好 ，

我正在自动化一个网站，当试图登录时，它会弹出一个安全警报。想单击该弹出窗口的“是”，任何人都可以为此提供解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-10T20:22:24.280

每次服务器获得新代码时，我都会收到安全警告和证书警告。这对我有用：

```
browser.AddDialogHandler(new DialogHandlerHelper());
browser.AddDialogHandler(new SecurityAlertDialogHandler());
Assert.IsTrue(browser.Link(Find.ByText("Login")).Exists);
browser.Link(Find.ByText("Login")).Click();
if (browser.Element("expertContentHeading").Exists)
{
    browser.Element("expertContentHeading").Click();
    browser.Button("exceptionDialogButton").Click();
    int Handle = browser.hWnd.ToInt32();
    object BT = true;
    WshShell WSH = new WshShell();
    WSH.SendKeys("{TAB}", ref BT);
    WSH.SendKeys("{TAB}", ref BT);
    WSH.SendKeys("{TAB}", ref BT);
    WSH.SendKeys("{TAB}", ref BT);
    WSH.SendKeys("{ENTER}", ref BT);
}

if (browser.Links.Exists("overridelink"))
{
    browser.Link("overridelink").Click();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-09T03:42:43.837

有两种方法可以处理这个问题，在测试开始时添加一个对话框处理程序，或者在需要时显式添加一个。这是在开始时添加一个运行的单独线程的方法。

```
IE ie = new IE();
ie.AddDialogHandler( new SecurityDialoghandLer() .. or the appropriate dialog handler ...);

The rest of your test ... 
```

# c# - 在领域驱动设计中，当实体克隆自己时，谁将其添加到其容器中？

> ID：938509
> 
> 赞同：5
> 
> 时间：2009-06-02T08:32:44.093
> 
> 标签：c#, java, domain-driven-design

例如，我们有两个域对象：Cell 和 Body（就像在人类细胞和身体中一样）。

Body 类只是 Cell 的集合，例如

```
class Body
{
    IList<Cell> cells;
    public void AddCell(Cell c) { ... }
    public void RemoveCell(Cell c) { ... }
} 
```

Cell 有一个 Split 方法，它在内部创建一个自身的克隆，例如

```
Class Cell
{
    public Cell Split()
    {
        Cell newCell = new Cell();
        // Copy this cell's properties into the new cell.
        return Cell;
    }
} 
```

现在，在 DDD 中，当单元格拆分时应该：

1.  单元格将新创建的单元格添加到 Body（这意味着每个 Cell 对象都持有对其包含主体的引用）？
2.  或者接收到初始用户请求的服务层是否应该调用Split，收集返回的Cell并将其添加到Body中？（感觉像是一个使用控制器而不是域对象的更贫血的设计）
3.  或者 Body 是否应该包含一个 SplitCell 方法？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T09:38:53.600

我认为 Body 会简单地调用 Cell 上的 splitCell() 。然后身体可以用新的细胞做它想做的事——添加到自己，消耗它，扔掉它，无论如何。无论如何，Body 都包含 Cell。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T09:44:45.930

好的 - 另一种方法是向 Body 发送一个事件，说“我正在分裂”或其他什么。然后 Body 可以拾取新的 Cell - 也许作为该事件的有效负载。

如果您的外部参与者不知道身体，Split 方法是否需要返回一个新的 Cell 克隆？外部参与者会以某种方式使用它吗？或者，Split 方法是否可以不返回任何内容（Void）而只是向它所在的 Body 发送消息？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T09:10:45.047

在 DDD 中，它通常取决于域。在这里，这个例子——以及域——看起来有点奇怪，但我想我会 `SplitCell`在`Body`.

虽然我不太清楚细胞分裂​​是什么意思，什么应该触发这个动作，我猜身体负责分裂它的细胞。我会更喜欢一种`Regenerate`方法，或者类似的方法，通过在每个单元格上`Body`调用该方法来拆分内部单元格。`Split`

好吧，这个例子绝对是奇怪的......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T11:59:19.917

在类上使用事件`Cell`似乎是一种自然的解决方案，但在 C# 中实现起来比较棘手。

当`Cells`进入作用域时，您需要连接事件，并且当它们超出作用域时，您还需要解除它们的钩子 - 否则会导致内存泄漏。

您还需要在单元格与 a 重新关联时连接事件`Body`，即从持久性存储中检索单元格时。使用容器来管理关系（可能是 ORM 拦截器）可以使这更容易。

更简单的替代方法是持有对父级的引用`Body`（单元格只属于一个`Body`，对吗？），并让新的`Cell`将自己添加到它的`Body`.

*   优点：易于编码、调试和理解。
*   缺点： Cell 和 Body 变得紧密耦合，使得它们在其他环境中重用变得更加棘手（这可能无关紧要）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-05T11:59:10.623

在阅读领域驱动设计 (Evans) 之后，似乎最好使用[服务](http://www.lostechies.com/blogs/jimmy_bogard/archive/2008/08/21/services-in-domain-driven-design.aspx)来处理这种情况。

# c# - 创建自定义标签

> ID：938515
> 
> 赞同：1
> 
> 时间：2009-06-02T08:34:42.793
> 
> 标签：c#, .net, asp.net-mvc

在我看来，我经常不得不写

```
<%=Model.T9n.TranslateById("someId");%> 
```

有没有办法让这个更紧凑/可读。也许是自定义标签？

```
<asp:T9n>someId</asp:T9n> 
```

或更好

```
<t9n: someId /> 
```

**注意**
有几个（商业）原因导致我无法在 Visual Studio 中使用默认的 T9n 工具，这就是我推出自己的工具的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T08:55:09.913

是的，您可以创建一个自定义控件并获得类似的东西`<prefix:t9n translationID="someID" runat="server"/>`

只需谷歌搜索`web custom control`，您就会获得大量点击。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T09:23:43.960

我对在 MVC 中创建自定义标签一无所知...

您可以创建自己的自定义 HtmlHelper 扩展方法。例如

```
<%=Html.T9n("someId");%> 
```

HTH，查尔斯

# tags - 标签搜索库 (ASP).NET

> ID：938516
> 
> 赞同：0
> 
> 时间：2009-06-02T08:34:50.953
> 
> 标签：tags, search-engine

我看到一些可怕的论坛搜索可怕。能够在我的数据库/应用程序中找到东西非常重要。我正在考虑自己写，但在我做之前你们认为什么是好的标签搜索库？C# .NET 或可能的 ASP.NET

注意：我不想要文本搜索，只想要标签。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T08:38:53.410

使用 Lucene.NET 我相信它可以满足您的所有需求：http: [//incubator.apache.org/lucene.net/](http://incubator.apache.org/lucene.net/)

# c++ - 如何将 goto 标签存储在数组中，然后跳转到它们？

> ID：938518
> 
> 赞同：22
> 
> 时间：2009-06-02T08:35:09.830
> 
> 标签：c++, c, goto, jump-table

我想声明一个“跳转标签”数组。

然后我想跳转到这个数组中的一个“跳转标签”。

但我不知道如何做到这一点。

它应该类似于以下代码：

```
function()
{
    "gotolabel" s[3];
    s[0] = s0;
    s[1] = s1;
    s[2] = s2;

    s0:
    ....
    goto s[v];

    s1:
    ....
    goto s[v];

    s2:
    ....
    goto s[v];
} 
```

有谁知道如何执行此操作？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-06-02T08:49:58.817

GCC 功能称为“[标签即值](http://gcc.gnu.org/onlinedocs/gcc/Labels-as-Values.html)”是可能的。

```
void *s[3] = {&&s0, &&s1, &&s2};

if (n >= 0 && n <=2)
    goto *s[n];

s0:
...
s1:
...
s2:
... 
```

**它仅适用于 GCC！**

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-06-02T08:41:23.827

`goto`需要一个编译时标签。

从这个例子看来，您正在实现某种状态机。最常见的是，它们被实现为 switch-case 构造：

```
while (!finished) switch (state) {
  case s0:
  /* ... */
  state = newstate;
  break;

  /* ... */
} 
```

如果您需要它更加动态，请使用函数指针数组。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-06-02T08:40:26.107

在 C 中没有直接的方法来存储要跳转到的代码地址。使用 switch 怎么样。

```
#define jump(x)  do{ label=x; goto jump_target; }while(0)
int label=START;
jump_target:
switch(label)
{
    case START:
        /* ... */
    case LABEL_A:
        /* ... */
} 
```

您可以找到每个无堆栈解析器/状态机生成器生成的类似代码。这样的代码不容易理解，所以除非它是生成的代码或者你的问题最容易被状态机描述，否则我建议不要这样做。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-06-02T08:40:51.643

你可以使用函数指针而不是 goto 吗？

这样，您可以创建一组函数来调用并调用适当的函数。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-06-02T08:41:01.487

据我所知，在普通的标准 C 中，这是不可能的。然而，GCC 编译器中有一个扩展，[记录在这里](http://gcc.gnu.org/onlinedocs/gcc-3.1.1/gcc/Labels-as-Values.html)，这使得这成为可能。

该扩展引入了新的操作符`&&`，用于获取标签的地址，然后可以将其与`goto`语句一起使用。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-02T08:42:09.907

这就是`switch`声明的用途。

```
switch (var)
{
case 0:
    /* ... */
    break;
case 1:
    /* ... */
    break;
default:
    /* ... */
    break;  /* not necessary here */
} 
```

请注意，编译器不一定会将其转换为跳转表。

如果您真的想自己构建跳转表，可以使用函数指针数组。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-02T11:36:56.123

您可能想查看 setjmp/longjmp。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-02T08:42:20.453

你不能用 goto 来做——标签必须是标识符，而不是变量或常量。我不明白你为什么不想在这里使用开关——如果这与你有关的话，它可能同样有效。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-02T08:47:22.190

对于一个简单的答案，与其强迫编译器做真正愚蠢的事情，不如学习良好的编程实践。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-07T10:00:04.037

分词器？这看起来像是 gperf 的用途。不，真的，看看它。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-04-16T18:25:18.427

如果满足以下条件，优化编译器（包括 GCC）会将 switch 语句编译到跳转表中（使 switch 语句与您尝试构建的东西一样快）：

您的开关案例（状态编号）从零开始。

您的开关盒正在严格增加。

您不会在 switch 案例中跳过任何整数。

有足够多的情况表明跳转表实际上更快（在处理 switch 语句的检查每个案例方法中的几十个比较和转到实际上比跳转表更快。）

这样做的好处是允许您用标准 C 编写代码，而不是依赖编译器扩展。它在 GCC 中的运行速度也一样快。它在大多数优化编译器中的运行速度也一样快（我知道英特尔编译器可以做到这一点；不确定微软的东西）。它可以在任何编译器上工作，尽管速度较慢。

# iphone - iPhone：Bonjour NSNetService IP 地址和端口

> ID：938521
> 
> 赞同：17
> 
> 时间：2009-06-02T08:37:35.440
> 
> 标签：iphone, bonjour

请原谅我的 iPhone/Objective-C 新手身份！

我使用 NSNetServiceBrowser 找到了我的 HTTP 服务器，但现在我只想找到服务的 IP 地址和端口。

我的委托方法中有以下内容：

```
NSNetService* server = [serverBrowser.servers objectAtIndex:0];

NSString            *name = nil;
NSData              *address = nil;
struct sockaddr_in  *socketAddress = nil;
NSString            *ipString = nil;
int                 port;
uint                 i;
for (i = 0; i < [[server addresses] count]; i++)
{
    name = [server name];
    address = [[server addresses] objectAtIndex:i];
    socketAddress = (struct sockaddr_in *)
    [address bytes];
    ipString = [NSString stringWithFormat: @"%s",
                inet_ntoa (socketAddress->sin_addr)];
    port = socketAddress->sin_port;
    NSLog(@"Server found is %s %d",ipString,port);
} 
```

但是即使调用了委托，也永远不会进入 for 循环。有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2011-02-12T07:01:26.457

我意识到这是一个旧线程，但我也遇到过这个问题。上面的代码有几个问题：

1.  它不是精通 IPv6 的。至少，如果您的应用程序的其余部分只能处理 v4 地址，它应该检测并丢弃 IPv6 地址，但理想情况下，您应该准备好将两个地址系列都传递给上游。

2.  端口分配将为 Intel 处理器生成不正确的值。你需要用它`htons` 来解决这个问题。

3.  正如 Andrew 上面提到的，迭代应该使用增强的 for 循环。

4.  （编辑：添加了这个）正如另一个相关线程所指出的，`inet_ntoa`不鼓励使用`inet_ntop`.

把所有这些放在一起，你会得到：

```
char addressBuffer[INET6_ADDRSTRLEN];

for (NSData *data in self.addresses)
{
    memset(addressBuffer, 0, INET6_ADDRSTRLEN);

    typedef union {
        struct sockaddr sa;
        struct sockaddr_in ipv4;
        struct sockaddr_in6 ipv6;
    } ip_socket_address;

    ip_socket_address *socketAddress = (ip_socket_address *)[data bytes];

    if (socketAddress && (socketAddress->sa.sa_family == AF_INET || socketAddress->sa.sa_family == AF_INET6))
    {
        const char *addressStr = inet_ntop(
                socketAddress->sa.sa_family,
                (socketAddress->sa.sa_family == AF_INET ? (void *)&(socketAddress->ipv4.sin_addr) : (void *)&(socketAddress->ipv6.sin6_addr)),
                addressBuffer,
                sizeof(addressBuffer));

        int port = ntohs(socketAddress->sa.sa_family == AF_INET ? socketAddress->ipv4.sin_port : socketAddress->ipv6.sin6_port);

        if (addressStr && port)
        {
            NSLog(@"Found service at %s:%d", addressStr, port);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-06-02T08:48:23.093

您在回调中返回的 NSNetService 尚未准备好使用。您必须调用以下方法来获取它的地址：

```
- (void)resolveWithTimeout:(NSTimeInterval)timeout; 
```

实现 NSNetService 委托方法以找出它何时解析：

```
- (void)netServiceDidResolveAddress:(NSNetService *)sender; 
```

此时，服务中应该至少有一个地址。

另外，请注意仔细阅读文档和头文件！这里的问题有些复杂，我已经掩饰了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-09-19T16:02:52.420

在一个类别中重新混合接受的答案：

## NSNetService+Util.h

```
#import <Foundation/Foundation.h>

@interface NSNetService (Util)

- (NSArray*) addressesAndPorts;

@end

@interface AddressAndPort : NSObject 

@property (nonatomic, assign) int port;
@property (nonatomic, strong)  NSString *address;

@end 
```

## NSNetService+Util.m

```
#import "NSNetService+Util.h"
#include <arpa/inet.h>

@implementation NSNetService (Util)

- (NSArray*) addressesAndPorts {

    // this came from http://stackoverflow.com/a/4976808/8047
    NSMutableArray *retVal = [NSMutableArray array];
    char addressBuffer[INET6_ADDRSTRLEN];

    for (NSData *data in self.addresses)
    {
        memset(addressBuffer, 0, INET6_ADDRSTRLEN);

        typedef union {
            struct sockaddr sa;
            struct sockaddr_in ipv4;
            struct sockaddr_in6 ipv6;
        } ip_socket_address;

        ip_socket_address *socketAddress = (ip_socket_address *)[data bytes];

        if (socketAddress && (socketAddress->sa.sa_family == AF_INET || socketAddress->sa.sa_family == AF_INET6))
        {
            const char *addressStr = inet_ntop(
                                               socketAddress->sa.sa_family,
                                               (socketAddress->sa.sa_family == AF_INET ? (void *)&(socketAddress->ipv4.sin_addr) : (void *)&(socketAddress->ipv6.sin6_addr)),
                                               addressBuffer,
                                               sizeof(addressBuffer));

            int port = ntohs(socketAddress->sa.sa_family == AF_INET ? socketAddress->ipv4.sin_port : socketAddress->ipv6.sin6_port);

            if (addressStr && port)
            {
                AddressAndPort *aAndP = [[AddressAndPort alloc] init];
                aAndP.address = [NSString stringWithCString:addressStr encoding:kCFStringEncodingUTF8];
                aAndP.port = port;
                [retVal addObject:aAndP];
            }
        }
    }
    return retVal;

}

@end

@implementation AddressAndPort
@end 
```

[是的，我不怕创建很多`NSObject`实例……]

# linq - ORM (Linq, Hibernate...) 真的那么有用吗？

> ID：938524
> 
> 赞同：12
> 
> 时间：2009-06-02T08:37:59.840
> 
> 标签：linq, hibernate, orm

我一直在玩一些 LINQ ORM（LINQ 直接到 SQL），我不得不承认我喜欢它的表达能力。对于类似实用程序的小型应用程序，它的运行速度也非常快：将 SQL 服务器放在某个表面上，您就可以开始 linq 了。

然而，对于较大的应用程序，[DAL](http://en.wikipedia.org/wiki/Data_access_layer)对我来说从来不是设置和维护的大问题，而且通常情况下，一旦设置好，所有的编程都不会在那里发生......

老实说 - 我是 ORM 新手 - 问题：ORM 与手动编写像样的 DAL 相比有什么优势？

（好像是双重的，虽然找不到）

更新：好的，它是双重的:-)我最终自己找到了它：

[ORM 与手工编码的数据访问层](https://stackoverflow.com/questions/563775/orm-vs-handcoded-data-access-layer)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-02T08:53:44.970

*   强类型
*   无需自己编写 DAL => 节省时间
*   无需自己编写 SQL 代码 => 不易出错

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-02T08:53:57.483

我过去曾使用 Hibernate 来动态创建相当复杂的查询。与构建适当的`Criteria`. 此外，Hibernate 知道如何使用各种不同的数据库，因此我不需要将任何逻辑放入我们的代码中。当然，我们必须针对不同的数据库进行*测试*，并且我需要编写一个扩展来适当地处理“like”查询，但随后它针对 SQL Server、Oracle 和 HSqldb（用于测试）运行没有任何问题。

还有一个事实是，您不必编写更多代码，这总是一件好事:) 我不能说我在任何大的事情上都使用过 LINQ to SQL，但我已经将它用于“又快又脏”的网站（非常小，很少更新，从全层抽象中受益不大）它很可爱。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T09:06:56.490

好吧，对我来说，每次我需要实现一个新的领域模型时，我都不必重新发明/重新创建轮子。例如，使用 nHibernate（我选择的 ORM）来创建、使用和维护数据访问层的效率要高得多。

您没有具体说明如何构建 DAL，但对我来说，我曾经花费相当多的时间一遍又一遍地做同样的事情。我过去常常从数据库模型开始，然后从那里开始工作，创建存储过程等。即使我有时使用小工具来生成部分设置，也需要大量重复编码。

现在我从域开始。我在 UML 中对其进行建模，并且在大多数情况下，我能够从该模型生成所有内容，包括数据库模式。它需要在这里和那里进行一些调整，但是根据我当前的设置，我可以立即完成 95% 的工作，并完成数据访问。我节省的时间可以用来微调需要调整的部分。我很少需要编写任何 SQL 语句。

那是我的两分钱。:-)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-06-30T14:57:44.650

我在一个项目中使用了 JPA，一开始我印象非常深刻。天哪，它为我节省了编写 SQL 的所有时间！然而，渐渐地，我变得有点失望了。

1.  难以定义没有代理键的表。有时我们需要没有代理键的表。有时我们想要一个多列主键。TopLink 在这方面遇到了困难。
2.  强制数据结构关系。JPA 使用注释来描述字段与容器或引用类之间的关系。虽然这在第一个站点可能看起来很棒，但是当您在应用程序中以不同方式引用对象时您会怎么做？例如，您只需要基于某些特定标准引用特定记录的特定对象（并且它需要是高性能的，没有不必要的对象分配或记录检索）。修改实体类的工作量几乎总是超过如果您一开始从未使用过 JPA 的工作量（假设您完全成功地让 JPA 做您想做的事）。
3.  缓存。JPA 为您的对象定义了缓存的概念。必须记住，数据库有自己的缓存，通常围绕最小化磁盘读取进行优化。现在您将数据缓存两次（忽略未收集的 GC 堆）。这如何成为优势超出了我的范围。
4.  数据！= 对象。对于高性能应用程序，必须非常高效地从数据库中检索数据。强制创建对象并不总是一件好事。例如，有时您可能需要原语数组。对于使用直接 JDBC 的有经验的程序员来说，这大约需要 30 分钟的工作时间。
5.  性能，调试。在（次优的、自动生成的）缓存子系统中发生复杂事情时，要衡量应用程序的性能要困难得多，这会进一步占用项目资源和预算。

大多数开发人员并不真正理解将对象映射到表时一直存在的阻抗不匹配问题。这一事实确保了 JPA 和朋友在可预见的未来可能会获得相当大的（咳嗽）成功。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-02T09:00:28.983

不同数据库供应商之间的可移植性。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-02T09:03:08.493

> 老实说 - 我是 ORM 新手 - 问题：ORM 与手工编写像样的 DAL 相比有何重大进步？

并非所有程序员都愿意甚至有能力编写“一个像样的 DAL”。那些不能或仅仅因为想到它而感到害怕的人，发现 LINQ 或任何其他 ORM 是一种祝福。

我个人使用 LINQ 来操作代码中的集合，因为它的表现力。它提供了一种非常紧凑和透明的方式来直接在代码中对集合执行一些常见任务。

当您想要手动创建非常具体和优化的查询时，LINQ 将不再对您有用。然后，您可能会得到混合的 LINQ 查询与连接到其中的自定义存储过程。由于这个考虑，我决定在我当前的项目中不使用 LINQ to SQL（因为我有一个不错的（恕我直言）DAL 层）。但我确信 LINW 可以很好地用于简单的网站，比如你的博客（或者类似的网站）。

使用 LINQ/ORM 时，可能还需要考虑高流量站点的滞后（因为每个传入的查询都必须重新编译）。虽然我不得不承认我没有看到任何关于 SO 的性能问题。

您也可以考虑等待 Entity Framework v2。它应该比 LINQ 更强大（希望不会像 v1 那样糟糕（根据某些人的说法））。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-02T09:05:13.310

透明的持久性 - 无需调用即可保存（和级联）更改`Save()`。乍一看，这似乎是一场噩梦，但是一旦您习惯了使用它而不是反对它，您的域代码几乎可以完全摆脱持久性问题。我不知道除 Hibernate / NHibernate 之外的任何 ORM 可以做到这一点，尽管可能有一些......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-26T05:06:21.973

回答这个问题的最好方法是准确了解像 Hibernate 这样的库实际上代表您完成了哪些工作。大多数情况下，抽象的存在是有原因的，通常是为了使某些问题不那么复杂，或者在这种情况下，Hibernate 几乎是一种 DSL，用于以简单简洁的方式表达某些持久性概念。

*   可以通过更改注释而不是编写大量代码来轻松更改集合的获取策略。

*   Hibernate 和 Linq 已被许多人证明和测试，如果不做大量工作，您几乎不可能达到这种质量。

*   Hibernate 解决了许多需要数月和数年才能编写代码的特性。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-07-01T14:07:49.670

此外，虽然 JPA 文档说支持复合键，但它很快就会变得非常（非常）棘手。您可以轻松地花费数小时（数天？）尝试让一些非常简单的工作。如果 JPA 真的让事情变得更简单，那么开发人员应该不必过多考虑这些细节。它没有，我们不得不理解两个抽象级别，ORM (JPA) 和 JDBC。对于我当前的项目，我正在使用一个非常简单的实现，它使用一个包保护的静态获取“构造函数”，它接受一个 ResultSet 并返回一个对象。这是每个类大约 4 行代码，加上每个字段一行代码。它简单、高性能且非常有效，而且我保留了完全的控制权。如果我需要以不同的方式访问对象，我可以添加另一个读取不同字段的方法（例如，让其他字段为空）。我不需要规范告诉我“必须如何（！）完成 ORM”。如果我需要对该类进行缓存，我可以根据需要精确地实现它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-02T09:49:18.010

我使用过Linq，我发现它非常有用。我节省了您编写数据访问代码的大量时间。但是对于大型应用程序，您需要的不仅仅是 DAL，对于它们，您可以轻松地扩展由它创建的类。相信我，它确实可以提高您的工作效率。

# c - 夹板的示例 rc 文件

> ID：938526
> 
> 赞同：2
> 
> 时间：2009-06-02T08:39:04.423
> 
> 标签：c, embedded, splint

我正在使用夹板进行代码检查，它会抛出大量警告。其中一些，我想可以忽略不计。我正在通过反复试验创建 .splintrc 。

我的问题，

是否有一些可以使用的示例 .splintrc 文件？

我正在为 C 代码使用夹板，为多任务嵌入式系统编写。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T08:13:41.553

这可能不是最大的帮助，但我认为您需要提供更多关于您收到的错误消息类型和您正在使用的目标处理器/编译器的信息。嵌入式目标处理器的不同编译器都有自己的语法来提供它们的特定功能（中断处理、转移到监督模式和硬件接口就是例子）

我曾尝试在 IAR 下的 MSP430 上使用夹板，但由于它在尝试处理编译器提供的硬件接口定义文件时抛出的警告和错误的数量而放弃了。我硬着头皮购买了 Gimpel LINT，它附带了一些配置文件，我可以对其进行修改以支持我正在使用的编译器和处理器的精确风格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-06T01:42:40.547

我从未使用过 Splint，但使用过 PC-Lint，这也是我的经验。如果没有编译器配置文件，lint 工具会抛出大量错误。

您将需要为您的编译器找到或创建编译器特定的配置文件，通知 linting 工具它使用的特殊（非标准）C 构造和宏，linting 工具应该忽略这些，否则您将继续抛出大量的错误。

然而，这是值得的。Linting 代码将帮助您立即发现错误，而不是在测试期间发现错误，因为它们更难找到且修复成本更高。

# javascript - 将 document.write 用于固定的 html

> ID：938528
> 
> 赞同：0
> 
> 时间：2009-06-02T08:39:31.113
> 
> 标签：javascript, dom, dynamic-data

我正在创建一个包含 100 个左右值的组合的网络表单。值是相同的。

表单可能有多个记录。因此，如果有 100 条记录，则有 10,000 行，从“下载”的角度来看，这似乎是非常错误的。

问题是：我想保持该组合动态以保持数据库中的 id。

所以我想出了以下几点：

```
 .....
 <script>
      stupidCombo = "<option>a"+
                    "<option>b"+
                    ...
                    "<option>99zzz"+
                    "</select>";
 </script>
 ..... form here
 .... for each item in huge list do paint <table><tr> etc. etc 

 <td>
 <select name="comb-<%=id%>">
      <option selected><%=obj.val%>
      <script>document.write(stupidCombo);</script>
 </td>
... close form, table, html etc. 
```

我已经渲染它并且“看起来”很好。该页面已从 50k 行减少到 5k 行，并且选择是由客户端的 javascript 创建的。

我的问题是......

这个可以吗？

是否有任何风险？

在了解了大多数 javascript 框架的工作原理后，我借用了这个想法，但它们中的大多数工作在**<div>**元素上，而不仅仅是针对它本身的文档。

我的目标是 IE6，这是一个快速修复，明天早上必须投入生产（所以我不想花太多时间在这上面），但我不想为每个请求写 50,000 行，如果我可以帮助它。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T09:01:09.527

HTTP 压缩（mod_gzip 等）可以很好地压缩所有内容。

如果你坚持`document.write`，你也必须使用 JavaScript 来编写`<select>`元素，因为在 HTML 中你不能在`<script>`里面放`<select>`.

另一种方法是将控件的一个副本发送到浏览器，然后在`selectElement.cloneNode(true)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T08:46:53.207

好吧，如果禁用了javascript，它显然将无法工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T08:47:51.783

document.write 生成的 HTML 的工作方式与普通 HTML 相同，因此您的解决方案不存在任何技术问题。（当然，这种解决方案只有在启用 javascript 时才有效）

顺便说一句，对于选项数量较多的列表，您可以查看[“建议框”组件](http://plugins.jquery.com/project/suggest)，它可以替代原生选择框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T08:47:10.117

谷歌一直在做（“document.write”）（Analytics/Adsense/...），所以我不明白为什么会有什么问题。

您的解决方案看起来确实有点奇怪，因为`<script>`标签位于`<select>`标签内，因此您最好在多个浏览器中进行检查。毕竟，你永远不知道 IE 会做什么 :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-09T17:08:22.450

更新。

我已经按照我的要求做了，而且效果很好。ie里面的js没有问题。

但...

呈现表格后，用户尝试做的下一件事（总是用户做一些意想不到的事情）是..

> *“好的，报告看起来不错。我要把它复制/粘贴到 MS-Excel 中，谢谢。”*

这是我并不关心的事情。由用户决定，但结果是：excel电子表格死掉（或冻结几乎相同）！！！！因为 excel 中的 javascript 引擎不如 IE 中的那么好，所以组合需要很长时间才能复制，实际上它使 excel 应用程序无法使用。

我不知道从 IE 到 Excel 的复制/粘贴非常好，以至于它实际上复制了所有生成的 html，而 Excel 也试图运行 javascript，但结果很糟糕。

我将通过保留原始 html 再试一次，看看是否效果更好。

:(

# ant - 具有适当依赖关系处理的 Java 构建器

> ID：938531
> 
> 赞同：1
> 
> 时间：2009-06-02T08:40:49.210
> 
> 标签：ant, build-process, dependencies, compilation, scons

在最近与我们的 ant 脚本杂耍之后，我开始怀疑是否有更好的东西是可能的。

我需要一个知道为我重新编译所有必需的 .java 文件的构建器。

例如。对于这个结构

```
public class A { ]
public class B extends A {}
public class C {
    B b;
} 
```

1.  For: Compile('C') 会知道编译 A、B、C。
2.  对于： B 更改，Compile('C') 将只知道重新编译 B。

我知道几种替代方案，[Ivy](http://ant.apache.org/ivy/)似乎是 ant 的扩展，它是我们当前的 Java 构建器。[我们目前用于构建 C++ 代码的 Scons， scons](http://www.scons.org/doc/0.96.1/HTML/scons-user/x2618.html)在为 C 代码执行上述行为方面非常出色。然后有[Maven](http://maven.apache.org/)几乎[但不完全存在](http://javathings.blogspot.com/2006/04/ivy-build-dependencies-management.html)的报告。

你有什么建议？您使用什么工具来构建系统？

谢谢你，马克西姆。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-13T00:47:49.650

如前所述，ivy、scons 或 maven 都不会帮助您解决问题。

1.  “for Compile('C')”是什么意思？我认为这不是您的 ant 文件中的内容。
2.  对于这种情况，Ant 应该按需要工作：您已经描述了它的默认行为。在同一个 javac 元素中，Ant 只会重新编译更改的类。请参阅 javac 任务的[Ant 手册](http://ant.apache.org/manual/Tasks/javac.html)条目，尤其是“includeDestClasses”属性。

您可能应该发布一个您发现不足的示例 ant 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-13T07:47:25.133

1.  Ant，[“依赖”任务](http://ant.apache.org/manual/Tasks/depend.html)和“关闭”选项打开
2.  'make'，来自 IDEA ide

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T08:43:26.113

maven，适用于我的个人和商业产品

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T08:51:33.040

在您的问题中，您描述了类间依赖关系。大多数构建系统，尤其是 Maven，更多地针对项目间的依赖关系。我相信大多数系统只是重新编译项目中的所有类，这些构建系统的大部分好处在于构建尽可能少的项目。

Maven 和 Ivy 都允许您轻松指定项目的外部和内部依赖项，包括您依赖的项目版本。如果它们尚未在本地缓存，它们还将自动将外部库（例如 apache commons）下载到本地计算机作为构建过程的一部分，从而节省大量手动下载和组织第三方 jar 文件的工作。

常春藤是蚂蚁的延伸，就像你提到的那样。我推荐马文。这是一个面向约定的构建系统，我已经成功使用并且感觉非常成熟。Maven 开始使用所需的前期工作量要少得多，而且可扩展性强。

# visual-studio - 为什么 /clr 与 Visual Studio 中的 /mt 和 /mtd 不兼容？

> ID：938539
> 
> 赞同：27
> 
> 时间：2009-06-02T08:42:29.877
> 
> 标签：visual-studio, visual-c++, visual-studio-2005, c++-cli, conditional-compilation

谁能为我解释一下 /clr 如何以及为什么与 /mtd 不兼容？有什么替代方案？如果我使用 /md 或 /mdd 在内部会发生什么？

据我所知，我们不会同时使用 /clr 和 /mtd。有人可以解释是否有办法做到这一点？请解释一下 /clr 如何以及为什么与 Visual Studio 中的 /mt 和 /mtd 不兼容？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-02T09:52:11.997

我希望[这里](http://msdn.microsoft.com/en-us/library/abx4dbyh(VS.80).aspx)给出线索：

> 如果您使用 /clr 编译器开关，您的代码将与导入库 msvcmrt.lib 链接。导入库引用了一个新库 msvcm80.dll，它提供了托管代码和本机 CRT 之间的代理。您不能将静态链接的 CRT（/MT 或 /MTd 选项）与 /clr 一起使用。请改用动态链接库（/MD 或 /MDd）。

/clr 标志使您的代码引用新的 dll msvcm80.dll - 它充当托管代码和 CRT 之间的代理。很难准确地说出这个代理的作用，但我猜它充当了托管堆上分配、垃圾收集、托管线程等的接口。如果您链接 CRT 的静态版本，则代理将无法拦截您对运行时库的调用。

# drupal - Drupal 6 CCK 内容类型的反馈表

> ID：938542
> 
> 赞同：1
> 
> 时间：2009-06-02T08:44:11.090
> 
> 标签：drupal, cck

这是我之前的问题以[编程方式/通过 API 创建 Drupal CCK 内容](https://stackoverflow.com/questions/772880/creating-drupal-cck-content-programatically-via-api)的后续，现在已经非常完整。

我在 Drupal 6 中有一个系统，它非常广泛地使用 CCK，并根据用户的喜好为用户生成锻炼计划。这些程序是主要由其他内容类型（练习、设备）组成的内容类型，并广泛使用分类法。我想做的是为用户提供对程序提供反馈的选项，然后可以在生成任何后续程序时将其考虑在内。理想情况下，用户将能够访问一个页面，该页面列出了一个程序中的练习，每个练习都有一个评分，以及几个反馈框。

我即将开始使用 Forms API 将其开发为自定义模块，但在此之前想知道是否有更好/更简单的方法可以通过 CCK 和其他模块实现？自定义模块方法是解决此问题的最佳方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T05:39:16.647

你看过五星级模块吗？假设练习是节点，您可以使用它来允许用户对练习进行投票。我认为，至少，votingapi 应该用作任何与投票相关的反馈的基础。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T00:44:37.227

您是否考虑过简单地使用核心评论模块来获取反馈？

# sql - 如何将 SQL 模式导入 Rails

> ID：938545
> 
> 赞同：-1
> 
> 时间：2009-06-02T08:44:57.093
> 
> 标签：sql, ruby-on-rails, database

例如，我有一个准备就绪的 SQL 模式。我如何将它导入到我的 Rails 应用程序中，以便我使用准备好的数据库而不是所有那些有趣的迁移。

编辑：到目前为止，你们都误解了我的问题。我在问我在 PostgresQL 中是否有一个工作数据库应用程序。我将如何使用它作为我的 Rails 应用程序的基础？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T09:49:33.533

没有要求您使用迁移，“有趣”或其他。只需开始从您的表中创建模型。Rails 作者足够聪明，能够认识到支持“遗留模式”的必要性。

请注意，如果您的主键没有被调用`id`，那么您需要定义主键（参见“Agile Web Development With Rails 3rd edition”的 p316）：

```
class LegacyBook < ActiveRecord::Base
  self.primary_key = "isbn"
end 
```

同样，如果您的外键名称不遵循 AR 常规默认样式，则需要在关系定义中明确定义它们。

开箱即用，ActiveRecord 还不支持复合主键：它有点像第 5 范式（PK 只是一种在业务领域中没有意义的任意数字）。至少有一个 gem，适当地命名为 composite_primary_keys（gem 以通常的方式安装），但它可能还不支持 AR 2.3（当我看到 v2.2.2 时`gem list --remote composite`）。[Google Groups](http://groups.google.com/group/compositekeys/topics)上有一些讨论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T09:14:23.883

我会将当前数据库转储到 rails 模式，然后使用它来生成迁移文件。通过这种方式，您可以以 Rails 方式更好地控制您的数据库。为此，您应该：

1.  设置你的数据库配置文件 (config/database.yml)

2.  运行`rake db:schema:dump`这将创建架构文件`db/schema.rb`

3.  使用您的内容创建您的迁移文件/文件`schema.rb`

-

```
 #db/migrate/001_create_database.rb
 class CreateDatabase < ActiveRecord::Migration
   def self.up
     # the content of schema.rb
   end

   def self.down
     # drop all the tables
   end
 end 
```

这样，您可以在以后开发应用程序时利用迁移。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T09:25:14.440

这应该这样做

```
 def self.up
    execute <<EOF
begin;
  SQL HERE
commit;
EOF
  end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-06T00:20:03.847

像这样编辑您的 config/database.yml 文件：

```
development:
  database: [your legacy database name]
  host: localhost
  adapter: postgres 
```

您可能还必须包含用户名和密码密钥，我通常不需要 postgres。您还需要在 postgres 中设置一个测试数据库。

以这种方式配置开发数据库后，您将能够：

```
> rake db:schema:dump 
```

并使用创建您的测试数据库

```
> rake db:schema:load RAILS_ENV=test 
```

与生成的文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T08:56:30.190

如果您的数据库表遵循 Rails 的 ActiveRecord[命名约定](http://api.rubyonrails.org/files/vendor/rails/activerecord/README.html)，那么您应该可以开始使用了。运行 SQL 以创建数据库对象。然后，您可以以正常方式生成 Rails 模型，但跳过创建迁移文件。

例如：

```
script/generate --skip-migration User name:string, age:integer 
```

# cruisecontrol.net - webdashboard中的修改历史看不见？

> ID：938574
> 
> 赞同：0
> 
> 时间：2009-06-02T08:59:21.590
> 
> 标签：cruisecontrol.net

我正在使用我的 ccnet，它配置了清晰的案例，一切都按预期正常工作，但我无法在“ViewProjectModificationHistory”中看到任何内容。每当我单击此选项卡时，我都会看到一条消息：“没有历史记录找到数据，确保您使用该项目的修改历史发布者“。事实上我已经在标签下添加了。令我惊讶的是，当我在其他人的系统中打开这个相同的链接时，它打开得很好，可以看到所有的修改历史记载。

那么谁能告诉我这个问题可能是什么以及如何解决？

感谢和问候麦迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-13T03:15:30.163

你应该检查你的构建历史文件。这将包含提供这些报告的 XML 数据。特别是，检查修改/修改节点以查看它们是否已填充。

我的猜测是修改不存在 - 所以可能没有什么可显示的。

我发现自己正在做的另一个问题是实际上并没有检查自上次构建项目以来是否确实存在更改。

# jquery - 来自给定记录 ID 的 jQuery 分页

> ID：938576
> 
> 赞同：0
> 
> 时间：2009-06-02T09:00:57.797
> 
> 标签：jquery, pagination

我发现了很多 jQuery 插件的分页编码。一切正常。但我的需要是，我在表中有 20 条记录。我想一次只显示一条记录，使用**First - Previous - Next - Last**。当我输入特定的记录 ID，如“15”时，它应该显示 15 的详细信息，如果我单击下一步，它会显示下一个记录 ID..etc。

例如，

录音编号：15

名字：格纳尼亚尔

姓名：祖拜尔

> 第一个 上一个 下一个 最后一个

如果我给记录 ID 10，它应该显示第 10 个记录 ID 的详细信息......等等......

在 jQuery 中怎么做？

*   格纳尼亚尔祖拜尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T09:58:14.483

使用[遍历函数](http://docs.jquery.com/Traversing)访问当前选择的邻居并搜索您用来显示记录的元素。您可以使用[效果函数](http://docs.jquery.com/Effects)来动画元素进出。您应该将事件绑定到链接（后退、前进等）

# sharepoint - 显示另一个站点中列表的列表视图 Web 部件

> ID：938580
> 
> 赞同：1
> 
> 时间：2009-06-02T09:02:33.440
> 
> 标签：sharepoint, listview

我无法使用位于我的根 Web 应用程序上的 Web 部件中包含的列表视图来显示文档库的内容。

这是网站结构：

```
主站点
    子站点1
        共享文档
    子站点2
        共享文档

```

我的 webpart 位于`main_site`.

在这个 webpart 中，我有一个 Sharepoint ListViewWebPart，例如我想在其中显示共享文档`subsite1`，但它似乎不起作用。我收到以下错误：

> 列表不存在
> 
> 您选择的页面包含一个不存在的列表。它可能已被其他用户删除。

奇怪的是，当我调试时，我可以看到 SPList 已正确初始化并包含我的列表元素。但是，在线`Controls.Add(mylistview)`, 是发生错误的地方。

这是我用来将列表绑定到我的 ListView 的代码：

```
SPList list = SPContext.Current.Site.AllWebs["subsite1"].Lists["Shared Documents"];

ListView lv = new ListView();
lv.ListId = list.ID.ToString();
lv.ViewId = list.DefaultView.ID.ToString();
lv.DataBind();

this.Controls.Add(lv); 
```

有人对此问题有合乎逻辑的解释和解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T13:29:35.570

问题是该列表在另一个站点中。

可以使用 ListViewWebPart 引用同一网站集中另一个网站的列表。您需要使用[WebId](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.webpartpages.listviewwebpart.webid.aspx)属性来执行此操作。这是[一个代码示例](http://stsadm.blogspot.com/2008/08/adding-list-view-web-part-to-page.html)。

另一种选择是使用 SharePoint Designer 创建数据视图 Web 部件。这将允许您使用来自另一个站点或 SharePoint Web 服务的列表来提取数据。结果看起来类似于列表视图 Web 部件，并且您可以使用一些强大的功能。这是[我发现的第一篇展示这一点的博](http://dougortiz.blogspot.com/2009/06/displaying-and-filtering-lists-in.html)文，应该还有其他几篇。

最后，您可以使用内容查询 Web 部件。您可能已经知道这一点，它实际上更多地用于显示而不是操作数据。

*编辑删除不正确的信息。*

# c# - 打开其他程序的配置文件

> ID：938585
> 
> 赞同：10
> 
> 时间：2009-06-02T09:05:42.670
> 
> 标签：c#, .net, app-config, configurationmanager

我有一个程序**A**，它还有一个 app.config 文件，我在其中添加了一些密钥，例如服务器地址、用户名和密码以连接到服务器。它是一个控制台应用程序。现在我想制作一个我已经完成的用户界面。在那个 UI 中，我想修改程序**A**的 app.config 的内容。我怎么做？

这是我尝试过的，我将 UI（基本上是一个 .exe）复制到程序**A 的**目录中，app.config 也位于该目录中。然后在 UI 中，我使用*ConfigurationManager*类的*OpenExeConfiguration*方法，并将程序**A 的**文件名作为参数传递。但它会抛出*System.Configuration.ConfigurationErrorsException*类型的异常。

所以我认为我的方法是不正确的。我该怎么做？

**编辑：**哦，我忘了告诉我正在使用 C#、.NET 3.5 和 VS 2008（如果有帮助的话：D）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-02T09:11:41.893

我不确定您的方法存在问题（尝试将堆栈跟踪添加到您的帖子中），但这就是我的做法：

```
var configMap = 
    new ExeConfigurationFileMap
    {
        ExeConfigFilename = externalConfigurationFile
    };
System.Configuration.Configuration externalConfiguration =
    ConfigurationManager.OpenMappedExeConfiguration(
        configMap,
        ConfigurationUserLevel.None);

foreach (var setting in externalConfiguration.AppSettings.Settings)
{
    ...
}

externalConfiguration.Save(ConfigurationSaveMode.Full); 
```

# objective-c - 如何在 Objective C 中解析字符串

> ID：938586
> 
> 赞同：7
> 
> 时间：2009-06-02T09:06:05.383
> 
> 标签：objective-c, parsing

有人可以帮我从Objective C中的这个字符串“/Date(1242597600000)/”中提取int时间戳值吗

我想得到 1242597600000。

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-02T09:14:11.997

一种简单的方法：

```
NSString *timestampString = @"\/Date(1242597600000)\/";
NSArray *components = [timestampString componentsSeparatedByString:@"("];
NSString *afterOpenBracket = [components objectAtIndex:1];
components = [afterOpenBracket componentsSeparatedByString:@")"];
NSString *numberString = [components objectAtIndex:0];
long timeStamp = [numberString longValue]; 
```

或者，如果您知道字符串将始终具有相同的长度和格式，您可以使用：

```
NSString *numberString = [timestampString substringWithRange:NSMakeRange(7,13)]; 
```

还有另一种方法：

```
NSRange openBracket = [timestampString rangeOfString:@"("];
NSRange closeBracket = [timestampString rangeOfString:@")"];
NSRange numberRange = NSMakeRange(openBracket.location + 1, closeBracket.location - openBracket.location - 1);
NSString *numberString = [timestampString substringWithRange:numberRange]; 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-02T11:40:15.493

有不止一种方法可以做到这一点。这是使用 NSScanner 的建议；

```
NSString *dateString = @"\/Date(1242597600000)\/";
NSScanner *dateScanner = [NSScanner scannerWithString:dateString];
NSInteger timestamp;

if (!([dateScanner scanInteger:&timestamp])) {
    // scanInteger returns NO if the extraction is unsuccessful
    NSLog(@"Unable to extract string");
}

// If no error, then timestamp now contains the extracted numbers. 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T13:04:27.133

```
NSCharacterSet* nonDigits = [[NSCharacterSet decimalDigitCharacterSet] invertedSet];
NSString* digitString = [timestampString stringByTrimmingCharactersInSet:nonDigits];
return [digitString longValue]; 
```

# c++ - 在 C++ 中调整动态堆栈分配的大小

> ID：938590
> 
> 赞同：0
> 
> 时间：2009-06-02T09:06:40.280
> 
> 标签：c++, stack, dynamic-memory-allocation, alloca

我正在编写一个使用包围体层次结构来加速光线追踪的小型光线追踪器。长话短说，我有一棵二叉树，我可能需要访问多个叶子。

当前我有一个左右两个孩子的节点，然后在 travel() 期间，如果某些条件，在此示例 intersect() 中，访问孩子：

```
class BoundingBoxNode{
    BoundingBoxNode* left, *right;
    void travel(param &p);
    inline bool intersect(param &p){...};
};

void BoundingBoxNode::travel(param &p){
    if(this->intersect(p)){
        if(left)
            left->travel(p);
        if(right)
            right->travel(p);
    }
} 
```

这种方法使用递归方法调用，但是，我需要尽可能优化这段代码......并且根据 IA-32 的优化参考手册，超过 16 的函数调用可能非常昂贵，所以我想这样做使用 while 循环而不是递归调用。但我不希望进行动态堆分配，因为这些很昂贵。所以我在想，也许我可以利用这样一个事实，即每次 while 循环从堆栈开始时都会处于相同的位置。在以下非常丑陋的黑客攻击中，我依靠 alloca() 始终分配相同的地址：

```
class BoundingBoxNode{
    BoundingBoxNode* left, right;
    inline void travel(param &p){
        int stack_size = 0;
        BoundingBoxNode* current = this;
        while(stack_size >= 0){
            BoundingBoxNode* stack = alloca(stack_size * 4 + 2*4);
            if(current->intersect(p)){
                if(current->left){
                    stack[stack_size] = current->left;
                    stack_size++;
                }
                if(current->right){
                    stack[stack_size] = current->right;
                    stack_size++;
                }
            }
            stack_size--;
            current = stack[stack_size];
        }
    };
    inline bool intersect(param &p){...};
}; 
```

然而令人惊讶的是，这种方法似乎确实失败了:)但只要堆栈小于 4 或 5，它就可以工作......我也非常有信心这种方法是可能的，我只是真的认为我需要一些帮助来实现它正确。

那么如何从 C++ 手动操作堆栈，是否可以使用一些编译器扩展......或者我必须这样做是汇编程序，如果是这样，我如何编写汇编程序而不是可以用 GCC 和 ICC 编译.

我希望有人可以帮助我......我不需要一个完美的解决方案，只是一个黑客，如果它有效，它就足以达到这个目的:)

问候乔纳斯·芬尼曼·詹森

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T09:39:06.063

因此，您有一个想要转换为循环的递归函数。您正确地计算出您的函数不是尾调用，因此您必须使用堆栈来实现它。

现在，您为什么担心分配“暂存空间”堆栈的次数？这不是每次遍历一次吗？-- 如果没有，则将暂存区传递给遍历函数本身，以便可以分配一次，然后在每次遍历时重新使用它。

如果堆栈足够小以适合缓存，它将保持热状态，并且它不在真正的 C++ 堆栈上的事实并不重要。

一旦你完成了所有这些配置文件，它会以两种方式完成，看看它是否有任何不同——保留更快的版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T09:29:28.067

堆栈分配无法调整大小。

在您的示例中，除了调用堆栈本身之外，您需要分配哪些数据并不是很明显。您基本上可以将当前路径保存在预先分配给最大深度的向量中。循环变得丑陋，但这就是生活......

如果您需要许多可以作为一个整体释放的小分配（在算法完成后），请为您的分配使用连续池。

如果您知道所需内存的上限，则分配只是一个指针增量：

```
class CPool
{
    std::vector<char> m_data;
    size_t m_head;
  public:
    CPool(size_t size) : m_data(size()), m_head(0) {}
    void * Alloc(size_t size)
    {
      if (m_data.size() - head < size)
        throw bad_alloc();
      void * result = &(m_data[m_head]);
      m_head += size;      
      return result;
    }
    void Free(void * p) {} // free is free ;)
}; 
```

如果您没有总大小的上限，请使用“绳索上的池” - 即当大块内存用完时，获取一个新的，并将这些块放入列表中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T10:01:20.653

你不需要堆栈*，*你只需要*一个*堆栈。`std::stack<BoundingBoxNode* >`如果我查看您的代码，您可能可以使用 a 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T12:55:19.693

使用 C++ 数据结构。毕竟，您使用的是 C++。std::vector<> 可以分块预先分配，摊销成本几乎为零。而且它也是安全的（因为您已经注意到使用普通堆栈不是。尤其是当您使用线程时）

不，它并不昂贵。它与堆栈分配一样快。

std::list<> 是的，那会很贵。但那是因为你不能预先分配它。std::vector<> 默认是块分配的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T09:34:01.083

由于 alloca 分配是累积的，我建议您执行第一个 alloca 来存储“this”指针，从而成为堆栈的“基础”，跟踪堆栈可以容纳多少元素并仅分配所需的大小：

```
inline void travel(param &p){

    BoundingBoxNode* stack = alloca(sizeof(BoundingBoxNode*)*3);
    int stack_size = 3, stack_idx = 0;
    stack[stk_idx] = this;

    do {
            BoundingBoxNode* current = stack[stk_idx];
            if( current->intersect(p)){
                    int need = current->left ? ( current->right ? 2 : 1 ) : 0;
                    if ( stack-size - stk_idx < need ) {
                         // Let us simplify and always allocate enough for two
                         alloca(sizeof(BoundingBoxNode*)*2);
                         stack_size += 2;
                    }
                    if(current->left){
                            stack[stack_idx++] = current->left;
                    }
                    if(current->right){
                            stack[stack_idx++] = current->right;
                    }
            }
            stack_idx--;
    } while(stack_idx > 0)
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T09:35:54.450

它适用于小堆栈大小的事实可能是巧合。您必须维护多个堆栈并在它们之间进行复制。您永远无法保证对 alloca 的连续调用将返回相同的地址。

最好的方法可能是堆栈的固定大小，并带有一个断言来捕获溢出。或者，您可以在构造时从树深度确定最大堆栈大小，并动态分配将用于每次遍历的堆栈......至少假设您没有在多个线程上遍历。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T09:11:37.463

C++ 标准没有提供操作堆栈的方法——它甚至不要求有堆栈。您是否使用动态分配实际测量过代码的性能？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-02T10:23:29.407

从你的问题看来，还有很多东西需要学习。

要学习的最重要的事情是：在没有首先测量您的运行时执行并分析结果以确定性能瓶颈的确切位置之前，不要假设任何关于性能的事情。

函数“alloca”从堆栈中分配一块内存，堆栈大小增加（通过移动堆栈指针）。每次调用'alloca'都会创建一个新的内存块，直到你用完堆栈空间，它不会重新使用以前分配的内存，当你分配另一块内存时，'stack'指向的数据会丢失，并且将其分配给“堆栈”。这是内存泄漏。在这种情况下，当函数退出时，内存会自动释放，所以这不是严重的泄漏，但是，你已经丢失了数据。

我会单独留下“IA-32 的优化参考手册”。它假定您确切知道 CPU 的工作原理。让编译器担心优化它会为你正在做的事情做得足够好 - 编译器编写者希望从里到外知道这个引用。对于现代 PC，性能的常见瓶颈通常是内存带宽。

我相信“16 深度”函数调用成本高昂与 CPU 如何管理其堆栈有关，并且只是一个指导方针。CPU 将堆栈顶部保留在板载缓存中，当缓存已满时，堆栈底部将被分页到 RAM，这是性能开始下降的地方。有很多参数的函数不会像没有参数的函数那样嵌套那么深。而且它不仅仅是函数调用，它也是局部变量和使用 alloca 分配的内存。事实上，使用 alloca 可能会影响性能，因为 CPU 将被设计为针对常见用例优化其堆栈 - 一些参数和一些局部变量。偏离常见情况，性能下降。

尝试使用上面 MSalters 建议的 std::stack 。让它工作。

# c# - 什么会导致页面在浏览器返回时丢失其视图状态？

> ID：938595
> 
> 赞同：1
> 
> 时间：2009-06-02T09:09:47.480
> 
> 标签：c#, asp.net, caching, viewstate

我有一个页面，当用户想要创建新文档或编辑现有文档时会显示该页面。页面上有两个 UserControl。一个简单的 DatePicker 和一个更复杂的网格。填写或编辑数据后，他可以按继续，这会将他带到审查页面，在那里他可以决定真正创建或更新文档或返回并更改某些内容。返回是在javascript中使用 history.back() 完成的

现在，当用户处于“新”模式并决定从评论页面返回时，网格部分失去了它的视图状态，而 DatePicker 完全失去了它。

另一方面，当用户处于“编辑”模式并从评论页面返回时，两个控件都保持其视图状态。

我知道浏览器只显示“新建/编辑”页面的缓存版本。但是为什么控件的状态会有所不同，我该怎么做才能使其在两种情况下都起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T09:40:44.157

Viewstate 本质上是表单中的一个隐藏字段，其中填充了已发送回服务器的控件值。

如果用户在表单的控件中输入或选择某些值，执行回发，然后按下浏览器的后退按钮或执行 javascript history.back()，则您正在查看回发之前的页面。因此，用户在回发之前所做的选择不会出现在页面上。

“新建”和“编辑”之间的区别在于，在“编辑”时，您从数据库中检索信息以填充控件。

而不是执行 javascript history.back()，您应该考虑使用**[Wizard control](http://msdn.microsoft.com/en-us/magazine/cc163894.aspx)**。向导控件就是为此目的而设计的。如果用户在多个步骤中输入信息，进入评论页面并需要返回一个步骤或一直返回到第一步，所有内容都保留在 Viewstate 中。

# wpf - WPF：可以将 DoubleAnimation 应用于任何双精度，还是仅应用于依赖属性？

> ID：938603
> 
> 赞同：1
> 
> 时间：2009-06-02T09:12:49.270
> 
> 标签：wpf, data-binding

可以将 DoubleAnimations 应用于任何双精度数吗？还是只是一些？

在 WPF 中，我知道你可以创建一个 DoubleAnimation 对象：

```
var ani = new DoubleAnimation(); 
```

..并且该对象可以在 UIElements 的 BeginAnimation 方法中使用。

但是，就我而言，我只想将动画应用于 UIElement 绑定到的对象。我有一个 ListBox，其 ItemsPanel 已设置为 Canvas，ListBoxItems 使用转换器根据属性设置 Canvas.Left 和 .Top 属性（调用它

```
public Point Location {get; set; } // this is a lie for brevity; I'm actually raising OnPropertyChanged 
```

)

所以我想对 Location.X 和 Location.Y 应用一个动画对象。可以将 DoubleAnimations 应用于任何双精度数吗？还是只是一些？

学习永无止境...

编辑#1：我被告知只有依赖属性。正如我所怀疑的那样。这就引出了一个问题，我提到的 Location 属性如何成为依赖属性，以便我可以在画布上为 ListBoxItems 设置动画？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T09:18:22.393

只有`DependencyProperty`s。根据[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.dependencyproperty.aspx)：

> 依赖属性为值表达式、属性失效和依赖值强制、默认值、继承、数据绑定、**动画**、属性更改通知和样式提供支持。

编辑：如果你想为 a 设置动画`Point`，请使用[`PointAnimation`](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.pointanimation.aspx).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T09:18:33.097

它只能应用于依赖属性

# sql-server - sqlserver2000如何知道有多少用户连接到一个特定的数据库

> ID：938607
> 
> 赞同：1
> 
> 时间：2009-06-02T09:15:31.323
> 
> 标签：sql-server, sql-server-2000

如何知道有多少用户连接到特定数据库

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T09:23:40.353

您可以使用存储过程`sp_who2`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T12:24:59.460

```
SELECT COUNT(DISTINCT spid)
FROM master.dbo.sysprocesses
WHERE spid >= 50
AND dbid = DB_ID('MyDBName') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T09:28:27.630

对于简单的查询，您可以在 SQL 2000 到 SQL 2008 上使用它（[在 SQL 2005 中没有 sysprocesses 的 1:1 替换](https://stackoverflow.com/questions/765206/grouping-sys-dmexecconnections-by-database-its-not-quite-like-sys-sysprocesse)）

```
SELECT
    COUNT(*)
FROM
    MASTER..sysprocesses
WHERE
    dbid = DB_ID('MyDBName') 
```

# jquery - 为什么此页面的内容会向左/向右移动几个像素？

> ID：938608
> 
> 赞同：4
> 
> 时间：2009-06-02T09:15:45.660
> 
> 标签：jquery, html, css

我正在使用“居中的页眉/页脚/2 列 CSS”布局。

在 test1.htm 中，如果它们是最小的页面内容并且页面页脚在浏览器窗口中完全可见，那么当您单击 test2.htm 时，页面内容会向左移动。

如果 test1.htm 有足够的内容将页脚推离浏览器窗口的底部，那么当您单击 test2.htm 时，页面内容将保持静态。

任何人都可以帮助解决这个 css 问题吗？

测试1.htm

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title></title>

<style type="text/css">

body, html 
{
    margin:0;
    padding:0;
    font-size: 1em;
  font-family:  Verdana, Arial, Helvetica, sans-serif;  
}   

#wrap 
{
    width:912px;
    margin:0 auto;
    background:Green;
}

#header 
{
    background-color:Gray;
    height: 120px;
}

#leftColumn 
{
    float:left;
    width:230px;
    padding: 0 10px 10px 10px;
    background:Red;
}

#rightColumn 
{
    float:right;
    width:642px;
    padding:10px;
    background:#fff;
    font-size: 0.7em;
    color: #828589;
}

#footer 
{
    clear:both;
    padding:5px 10px;
    background-color:Gray;
}

</style>    

</head>

<body>
  <div id="wrap">
    <div id="header">
      <div id="nav">
       <a href="test1.htm">test1</a> <a href="test2.htm">test2</a> 
      </div>
    </div>
    <div id="leftColumn">
      <p>
      left column
      </p>   
      <br /><br /><br /><br /><br /><br />
    </div>
        <div id="rightColumn">
          <div id="PageContent">

      <!-- START PAGE CONTENT -->

        <h1>Page Title </h1>
        <h4>"test 1 "</h4>

        <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
        some words...
        <!-- 
        <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
        <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
        <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
        -->

      <!-- END PAGE CONTENT -->
      </div>

    </div>
    <div id="footer">

      the footer

    </div>
  </div>
</body>
</html> 
```

测试2.htm

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title></title>

<style type="text/css">

body, html 
{
    margin:0;
    padding:0;
    font-size: 1em;
  font-family:  Verdana, Arial, Helvetica, sans-serif;  
}   

#wrap 
{
    width:912px;
    margin:0 auto;
    background:Green;
}

#header 
{
    background-color:Gray;
    height: 120px;
}

#leftColumn 
{
    float:left;
    width:230px;
    padding: 0 10px 10px 10px;
    background:Red;
}

#rightColumn 
{
    float:right;
    width:642px;
    padding:10px;
    background:#fff;
    font-size: 0.7em;
    color: #828589;
}

#footer 
{
    clear:both;
    padding:5px 10px;
    background-color:Gray;
}

* html #footer {
    height:1px;
}  

</style>    

</head>

<body>
  <div id="wrap">
    <div id="header">
      <div id="nav">
       <a href="test1.htm">test1</a> <a href="test2.htm">test2</a>  
      </div>
    </div>
    <div id="leftColumn">
      <p>
      left column
      </p>   
      <br /><br /><br /><br /><br /><br />
    </div>
        <div id="rightColumn">
          <div id="PageContent">

      <!-- START PAGE CONTENT -->

        <h1>Page Title </h1>
        <h4>"test 2 "</h4>

        <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
        some words...

        <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
        some words...
        <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
        <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
        <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />

      <!-- END PAGE CONTENT -->
      </div>

    </div>
    <div id="footer">

      the footer

    </div>
  </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T09:35:43.513

听起来第一页足够短，可以在没有滚动条的情况下显示，而第二页则不然。

滚动条占用空间，因此画布更窄，因此画布的中心离滚动条更远。

解决方案是始终使用溢出来显示滚动条（我不建议这样做，它在无法滚动时提供滚动）或使用左对齐设计（如大多数 WWW）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T09:33:56.793

发生这种情况是因为 test2.htm 在右侧有滚动条 -> 这使得 test2.htm 的宽度小于 test1.htm 的宽度 -> 居中的内容位置由采用不同宽度值的浏览器计算 => 这就是左侧位置不同的原因在每种情况下...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T09:34:31.673

#wrap div 左右两侧的自动边距导致整个内容以正文的可用宽度为中心。在 test2 中，可用宽度因滚动条的出现而减小，因此内容似乎向左移动了滚动条宽度的一半。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-02T11:42:03.570

所以看起来有更多内容的页面会迫使浏览器窗口有一个滚动条，这反过来又将居中的 div 推到左边，因为可用区域已经被滚动条的出现减少了。

所以可能的解决方案是没有一个居中的 div，即将包装 id css 更改为

```
#wrap 
{
    width:912px;
    margin:0 0 0 0;
    background:Green;
} 
```

这与我正在使用的东西看起来不太好。

另一个解决方案是溢出，即添加这个

```
 html
  {
    overflow:scroll;    
  } 
```

这实际上看起来不错，所以可能会继续使用它。

我确实找到了基于[此使用 JQuery 的另一个解决方案](https://stackoverflow.com/questions/210717/what-is-the-best-way-to-center-a-div-on-the-screen-using-jquery)

将#wrap 更新为

```
#wrap 
{
    width:912px;
    margin:0 0 0 0;
    background:#fff;
        visibility: hidden;
} 
```

然后在每个页面中使用以下内容

```
 <script type="text/javascript">
    jQuery.fn.center = function() {
      this.css("position", "absolute");

      // Use This line On 'Short Page Content'
      this.css("left", ($(window).width() - (this.width()+18)) / 2 + $(window).scrollLeft() + "px");

      // Use This line On 'Long Page Content'
      this.css("left", ($(window).width() - (this.width())) / 2 + $(window).scrollLeft() + "px");

      return this;
    }

    $(document).ready(function() {
      $('#wrap').center();
      $('#wrap').css("visibility", "visible");
    });

  </script> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-03-21T18:35:28.027

当您只需要保持滚动条始终可见时，为什么还要这样做！

```
html{
   height:101%;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-02T12:00:17.247

最好的办法是不要担心滚动条。您正在修复一个不存在的“问题”。每个居中的网站都有同样的问题。

这是“预期行为”，您的用户都不会注意到您的页面向左移动了几个像素——尤其是在页面刷新时。

想想看——你有没有在其他网站上注意到这一点？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-29T13:46:23.650

```
height: 100%;
overflow-y:scroll; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-02-01T19:38:41.283

对于我的网站，Safari 中的页面之间没有“摆动”——我只在 Firefox 中注意到了这一点，而 Paul Rowland 的使用建议`overflow: scroll`非常有效，因为该网站在 Safari 中不受影响，但在 Firefox 中得到了纠正。非常有帮助，谢谢！

我不敢相信，在这个网站上，诸如“别担心”之类的建议不会被否决。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-18T04:37:17.117

Many thanks, guys. I was having the same text-shifting issue tonight and was fortunate to find this site and your above suggestions.

My two pages were behaving the same way--one created a scrollbar and the other did not. The text-shifting issue was resolved by adding the following code to the style.css file:

`html { overflow:scroll; }`

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2014-02-27T19:10:53.750

If you are loading javascript to display a facebook like button or from another source like that, the page will load the facebook div that is placed there then get rid of it again causing a shift. Try using css for the fix to give that facebook/whatever div a set height.

# web - 需要自动网站文件夹备份系统吗？有什么建议吗？

> ID：938610
> 
> 赞同：0
> 
> 时间：2009-06-02T09:17:14.610
> 
> 标签：web, download, backup-strategies

大家好，有没有可以定期备份在线网站文件夹并将它们离线存储在本地系统上的备份软件。需要一些健壮的东西，如果有免费的东西可以完成这项工作，那就太好了:)

* * *

感谢您的链接 - 我有 ftp 访问权限及其我的网站及其与用户上传的文件共享网站，我想定期在网站上维护不时上传的文件的备份。只想自动化这个过程。我的本地系统是基于 Windows 的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T09:31:01.777

如果您可以访问网络服务器，则可以通过电子邮件或 ftps 输出存档的 cronjob 来完成这项工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T09:26:58.117

如果您指的是您将通过浏览器访问的网站（而不是作为网站管理员），您应该查看[WGet](http://www.gnu.org/software/wget/)。而且，如果您需要从 Windows 系统使用 WGet，请查看[Cygwin](http://www.cygwin.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T09:28:38.067

如果您在站点上没有 shell 访问权限，则可以使用 wget：

```
#!/bin/bash
export BCKDIR=`date -u +"%Y%m%dT%H%M%SZ"`
wget -m -np -P $BCKDIR http://www.example.com/path/to/dir 
```

wget 选项：

*   -m - 镜像一切，跟随链接
*   -np - 不访问父目录（避免下载整个站点）
*   -P - 将文件存储在 $BCKDIR 以下

如果您有 shell 访问权限，则可以使用 rsync。一种方法是让这个循环在 screen(1) 会话中运行，并使用 ssh-agent 自动登录：

```
#!/bin/bash
while :; do
    export BCKDIR=`date -u +"%Y%m%dT%H%M%SZ"`
    rsync -az user@hostname:/path/to/dir $BCKDIR
    sleep 86400 # Sleep 24 hours
done 
```

不确定您使用的是什么操作系统，但这应该在 *NIX 下运行良好。对于 MS Windows，还有 Cygwin。

# cocoa - CoreData - 如何创建 NSManagedObject 子类的子类（Generation Gap 模式）

> ID：938617
> 
> 赞同：7
> 
> 时间：2009-06-02T09:20:03.060
> 
> 标签：cocoa, cocoa-touch, core-data

我敢肯定这一定是一个愚蠢的问题，但我已经搜索了网络，但找不到答案。很多人都在谈论使用 Generation Gap 模式，其中您有一个从模型生成的 NSManagedObject 子类，然后将其子类化以添加瞬态属性和行为。这样做的好处是，如果您更改了持久化模型，您可以再次生成基本文件，而不会覆盖您自己的代码。

我有一个从 NSManagedObject 派生的基本 CardMO 对象。然后我将其子类化以制作我自己的 Card 对象。

我的问题是，如何创建一个托管的 Card 对象？

我试过：

```
 Card* card = [NSEntityDescription insertNewObjectForEntityForName:@"CardMO" inManagedObjectContext:moc]; 
```

但是这个对象并不是真正的卡片，当然当我继续在这个对象上调用卡片方法时也会有一个例外。

我尝试使用 alloc / init 创建一个 Card（其中 init 只调用 [super init]），然后将其添加到 managedObjectContext 中，如下所示：

```
[moc insertObject:(CardMO*)card]; 
```

这给了我一个神秘的错误“无法在 NSManagedObject 类 'Card' 上调用指定的初始化程序”

我尝试通过调用 [NSEntityDescription insertNewObjectForEntityForName:@"CardMO" inManagedObjectContext:[AIStoreManager sharedAIStoreManager].managedObjectContext] 而不是 [super init] 来修改它。在这种情况下，我返回的对象又是一个 CardMO，我不能在它上面调用 Card 方法。

我应该做什么？

而且（对于奖励积分:-) - 在我通过了这个障碍之后，我需要从 XML 创建我的其他 Card 对象，然后将它们转换为 NSManagedObjects。我正在使用基于 Apple 的 XMLReaderSAX 的代码——我将此代码交给了一大块 XML，它给了我一个包含许多 Card 对象的数组。我可以稍后将这些对象添加到我的托管对象上下文中，还是必须进入 XMLReaderSAX 并更改它创建这些对象的方式？

我正在 3.0 上编写一个 iPhone 应用程序，但我认为这对于 10.5 的 Core Data 是相同的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T09:56:44.563

猜对了！

在数据模型中，实体的类名必须是最派生类的类名——在我的例子中是 Card。麻烦的是，您必须记住在生成任何新文件之前将名称更改为 CardMO。

这一定是人们使用[mogenerator](http://rentzsch.com/code/mogenerator)的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-20T18:51:16.007

Why not use NSCoding? Then you could support XML or JSON or any other means of describing the object outside your application.

# multithreading - 静态类的析构函数需要互斥锁吗？

> ID：938618
> 
> 赞同：3
> 
> 时间：2009-06-02T09:20:14.683
> 
> 标签：multithreading, singleton, mutex

我们有一个静态（单例）类，它将在多线程环境中使用。我们在其构造函数和其他 mrmber 函数中使用互斥锁。但是，析构函数没有互斥锁。析构函数执行一些任务，例如清理其他一些成员对象等。我们是否还需要在析构函数中使用互斥锁？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T09:38:00.327

在访问析构函数正在破坏的对象方面，不，它不应该使用互斥锁。调用代码负责确保析构函数被调用一次，并且只调用一次；那不是析构函数的责任。

在访问任何其他数据或资源方面，从析构函数访问它们并没有什么特别之处。无论是从这个析构函数还是任何普通函数调用它们，它们都需要或不需要使用互斥锁进行保护。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T10:00:26.957

Dave 为析构函数提供的相同[原理也适用于构造函数。](https://stackoverflow.com/questions/938618/destructor-of-static-class-need-a-mutex/938697#938697)虽然对象仍在构建中，但不应被任何其他线程访问。构造函数保证只能由一个线程运行（您不能构造两次），但您必须保证在对象完全构造之前没有线程访问该对象。

内部锁不应该是构造函数或析构函数对数据访问的责任。它们可用于线程同步的析构函数：如果对象已经*在*对象内部（线程正在运行您的对象方法之一），以保证您不会在操作中间删除该对象。

这是在语言意义上使用*构造函数*和*析构函数*的所有类型的类的通用方法。现在，对于单例来说，场景更加具体。通常，当您谈论单例的*构造函数*时，您实际上是在谈论创建对象的静态方法，而不是真正的*构造函数*。该静态方法通常具有可以包含静态互斥锁的同步机制。

在深入讨论什么是单例的*破坏*之前，您应该说明您的预期用途。单例是否会在应用程序生命周期内多次销毁和重新创建？它会被创造一次并永远存在吗？你是如何实现单例的？这些问题是决定是否、何时以及何地需要同步原语的起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T09:54:13.147

如果你有多个线程试图删除一个对象，那么你的设计是*严重*错误的。

您必须仅在为您提供唯一实例的成员函数中使用同步，因为让多个对象请求一个实例是有意义的，但应该只有一个点您决定删除该对象并且不再使用它.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T10:00:43.493

如果析构函数修改了一些全局数据（比如全局计数器等），或者一些共享资源，那么你需要互斥锁。否则，像这样保护析构函数意味着它的设计问题。当对象被其他线程使用时，任何时候线程都不应尝试删除该对象。

# c# - 如何在 wpf 中取消选中图像的 ICC 配置文件以消除图像中的偏红色

> ID：938619
> 
> 赞同：1
> 
> 时间：2009-06-02T09:20:29.660
> 
> 标签：c#, wpf, color-profile, color-management

我已经开发了一个 WPF 应用程序，用于使用 Canvas 保存图像。保存图像后，我在这些保存的图像上得到了一些淡红色。我搜索了解决方案，但我没有得到任何解决方案。很长一段时间后，我才知道在 Adob​​e Photoshop 中有一些 IccProfiler。如果我们取消选中，我们也可以在保存后检索原始图像。任何人都可以帮助我了解如何让 ICCProfiler 将图像保存在 c# 和/或 WPF 中。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T11:31:19.770

您是否在机器上设置了默认颜色配置文件？查看显示属性->设置选项卡->高级->颜色管理选项卡。该选项卡中是否选择了颜色配置文件？

我不知道如何更改 WPF 对颜色配置文件所做的操作，但您可以尝试删除机器上任何主动选择的颜色配置文件（通过在颜色管理选项卡中执行）以查看它是否会改变行为。我想不出为什么你最终会在图像上得到一个配置文件，除非机器有一个设置，但即使那样我也不指望它。

# visual-c++ - 如何检查弹出菜单项？

> ID：938620
> 
> 赞同：2
> 
> 时间：2009-06-02T09:20:37.333
> 
> 标签：visual-c++, mfc, menu

如何检查弹出菜单项？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T09:33:14.890

如果是上下文菜单，请在使用 AppendMenu() 函数将项目添加到菜单时使用 MF_CHECKED 样式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T09:27:03.593

使用[CMenu::CheckMenuItem](http://msdn.microsoft.com/en-us/library/sbd652b3(VS.80).aspx)

[请参阅MSDN](http://msdn.microsoft.com/en-us/library/5z8dxz39(VS.80).aspx)中的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-23T10:26:34.187

创建弹出菜单项时没有命令编号，只能使用**MF_BYPOSITION**参数。

例如，如果您创建了菜单

```
HMenu = CreateMenu(); 
```

还有一个菜单条目“版本”，您可以在其中“选择...”，有 3 个选项：

```
HPopSubMenuSelect = CreatePopupMenu();
AppendMenu(HPopSubMenuSelect, MF_STRING, 20, "All");
AppendMenu(HPopSubMenuSelect, MF_STRING, 21, "Word");
AppendMenu(HPopSubMenuSelect, MF_STRING, 22, "Nothing");
HPopMenuEdition = CreatePopupMenu();
AppendMenu(HPopMenuEdition, MF_STRING | MF_POPUP , HPopSubMenuSelect,"Select...");
AppendMenu(HMenu, MF_STRING | MF_POPUP , HPopMenuEdition, "Edition"); 
```

然后要检查这个你必须打电话

```
CheckMenuItem(HPopMenuEdition, 1, MF_BYPOSITION | MF_CHECKED);
// Or for uncheck
// CheckMenuItem(HPopMenuEdition, 1, MF_BYPOSITION | MF_UNCHECKED); 
```

问候。

# c# - 使用工厂时的反射成本

> ID：938631
> 
> 赞同：2
> 
> 时间：2009-06-02T09:25:25.470
> 
> 标签：c#, performance, reflection, factory

stackoverflow的好人，

与往常一样，我正在编写一个工厂以动态实例化对象。

为了模式化，我有四种类型：

```
class CatDescriptor : PetDescriptor
class DogDescriptor : PetDescriptor

class Cat : Pet
class Dog : Pet 
```

我从工厂实例化了最后两种类型。困境来了：我是否应该只用隐藏反射的“is”运算符测试描述符类型，然后花费一些东西。

```
static Pet.Factory(PetDescriptor descriptor)
{
    if (descriptor is CatDescriptor)
    {
        return new Cat();
    }
    else if (...)
    {
        ...
    }
} 
```

我应该使用枚举“类型”作为嵌入在 PetDescriptor 中的属性吗？

```
class PetDescriptor
{
    public Type PetType;

    public enum Type
    {
        Cat,
        Dog
    }
}

static Pet.Factory(PetDescriptor descriptor)
{
    switch (descriptor.PetType)
    {
        case PetDescriptor.Type.Cat:
            return new Cat();
        ....
    }
} 
```

或者使用虚拟方法：

```
class PetDescriptor
{
    public virtual bool IsCat()
    {
        return false;
    }

    ...
}

class CatDescriptor : PetDescriptor
{
    public override bool IsCat()
    {
        return true;
    }
}

static Pet.Factory(PetDescriptor descriptor)
{
    if (descriptor.IsCat())
    {
        return new Cat();
    }
    else if (...)
    {
        ...
    }
} 
```

投票已开启！

编辑：问题是关于反射性能，而不是工厂设计。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T09:29:59.063

在您的工厂进行测试会破坏目的（您必须为要创建的每个新的具体实例更新您的类）。

您可以：

*   使用[抽象工厂模式](http://en.wikipedia.org/wiki/Abstract_factory_pattern)

*   （更好）使用 IoC 框架为您实例化您的对象（我建议[Castle Windsor](http://www.castleproject.org/container/index.html)，[NInject](http://ninject.org/)或者如果您只在 MS 商店，[Unity](http://www.codeplex.com/unity)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T10:02:37.327

由于您`PetDescriptor`确定了`Pet`我会使用**重载**：

```
static class PetFactory
{
    public static Dog CreatePet(DogDescriptor descriptor)
    {
        return new Dog(descriptor);
    }

    public static Cat CreatePet(CatDescriptor descriptor)
    {
        return new Cat(descriptor);
    }
} 
```

**（编辑）**

当然，这只有在你有一个具体的`PetDescritor`:`CatDescriptor`或`DogDescriptor`.

如果您在创建时没有*摘要* `PetDescriptor`，我会选择第一个解决方案。

或者，您可以`Enum`在**Factory 类**中声明一个指定`Pet`您喜欢创建的具体内容的类。维基[百科](http://en.wikipedia.org/wiki/Factory_method_pattern)有一个简单的[Pizza](http://en.wikipedia.org/wiki/Factory_method_pattern)示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T09:30:55.240

您的第三个解决方案（使用虚拟方法）肯定已经过时了： PetDescriptor 类不应该知道它的所有派生类（每次创建 XXXDescriptor 类时都必须添加一个新方法 IsXXX）。

我认为您的第一个解决方案是最好的。枚举没有添加任何有用的东西，它只是迫使您在描述符类中添加更多代码

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T09:37:07.583

你不想有一个工厂类，你想为每个宠物类型都有工厂类。

它们都应该实现一个 Pet 工厂接口。

每次添加新宠物时，您都必须编辑宠物工厂，而不仅仅是创建一个新的宠物工厂类并使用它。

或者，每个宠物类都可以负责创建自己的实例（或链接到宠物的宠物描述符。看看工厂方法模式：

[http://en.wikipedia.org/wiki/Factory_method_pattern](http://en.wikipedia.org/wiki/Factory_method_pattern)

[http://www.dofactory.com/Patterns/PatternFactory.aspx](http://www.dofactory.com/Patterns/PatternFactory.aspx)

至少这是我的理解。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-17T17:21:47.267

我的英语很糟糕，所以我希望我能正确理解你的问题。

你有多少种宠物？

如果你有 2 只宠物，并且你确信它的数量在未来不会增加 - 不要使用任何工厂（不要狂热）

如果有大约 10 只宠物 - 我想你需要一个抽象工厂之类的东西。在这种情况下 - 每个描述符都可以创建自己的宠物，所以如果你有任何描述符，你可以在**没有**任何附加信息的情况下创建一些宠物：

```
 //of course u can use your own base class instead of interface. 
interface IPetDescriptor
{
   //here u can place some additional type information, if u need. Tags or genetic code, or maybe some story about this type
    Pet CreatePet();//Maybe u need some aditional createInformation?

}

class DogDescriptor:IPetDescriptor
{
   public Pet CreatePet(){ return new Dog();}
}
class CatDescriptor:IPetDescriptor
{
   public Pet CreatePet(){ return new Cat();}
}

 class Pet
 {
    public Pet static Pet.Factory(IPetDescriptor descriptor)
    {
       //Place for additional initialization, if u need...

       //we don't care about pet type. Thats good.
       return descriptor.CreatePet(); 
     }
     .... 
 } 
```

如果有 100 种宠物类型，更好的解决方案是使用 IoC 框架，或者自己编写（例如，你可以创建类型自动搜索器）：

[C# 自动扫描工厂](https://stackoverflow.com/questions/17148506/c-sharp-auto-scaning-factory)

# c# - 中点舍入

> ID：938635
> 
> 赞同：0
> 
> 时间：2009-06-02T09:25:56.183
> 
> 标签：c#

我正在尝试四舍五入以下值，但我不知道出了什么问题。

```
NewValue -=(System.Math.Round(Global.WorkData.ValueOld - System.Math.Round (Global.WorkData.ValueOld * 20, 0) / 20, 2 )); 
```

这就是我所做的：

```
NewValue -=(System.Math.Round(Global.WorkData.ValueOld, 2, MidpointRounding.AwayFromZero - System.Math.Round(Global.WorkData.ValueOld * 20, 2,MidpointRounding.AwayFromZero) / 20, 2 )); 
```

你能告诉我我的代码有什么问题吗？为什么我不能编译它？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T09:33:09.727

你错过了一个括号：

```
NewValue -=(System.Math.Round(Global.WorkData.ValueOld, 2, MidpointRounding.AwayFromZero - System.Math.Round(Global.WorkData.ValueOld * 20, 2,MidpointRounding.AwayFromZero) / 20, 2 ));

NewValue -=(System.Math.Round(Global.WorkData.ValueOld, 2, MidpointRounding.AwayFromZero**)** - System.Math.Round(Global.WorkData.ValueOld * 20, 2,MidpointRounding.AwayFromZero) / 20, 2 ); 
```

希望这可以帮助你。

我认为您的目标是：（但我不是 100%）

```
decimal OldValue = Global.WorkData.ValueOld;
decimal OldValueMaths = (OldValue - (OldValue * 20)) / 20;

NewValue -= Math.Round(OldValueMaths, 2, MidpointRounding.AwayFromZero); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T09:37:35.583

你至少有一个括号错误，所以它试图从 a 中减去一个十进制值`MidpointRounding`。

但是，我仍然无法弄清楚你真正想要做什么。

我*强烈*建议您拆分此语句 - 拆分对 的调用`Round`，然后使用值拆分。例如：

```
decimal oldValue = Global.WorkData.ValueOld; // For convenience
decimal roundTo2 = Math.Round(oldValue, 2, MidpointRounding.AwayFromZero);
decimal roundTo20 = Math.Round(oldValue * 20, 2, MidpointRounding.AwayFromZero);
newValue -= roundTo2 - (roundTo20/20); 
```

我仍然无法准确计算出您想对结果做什么 - 语句末尾的 2 是什么意思？您问题中的第一个陈述是什么意思？也许你想要：

```
decimal oldValue = Global.WorkData.ValueOld; // For convenience
decimal roundedBy20ths = Math.Round(oldValue * 20, 2,
                                    MidpointRounding.AwayFromZero) / 20;
decimal remainder = Math.Round(oldValue - roundedBy20ths, 2,
                               MidpointRounding.AwayFromZero);
newValue -= remainder; 
```

? 可能是这样，但我真的不知道...

*更短的语句使代码更清晰，让你更*容易发现这种错误。

# cocoa - 如何在 xcode 3.0 中新建一个 nib 文件？

> ID：938636
> 
> 赞同：0
> 
> 时间：2009-06-02T09:25:58.400
> 
> 标签：cocoa

我想在xcode 3.0中新建一个nib文件，但是发现只能新建xib文件，为什么？

* * *

好的，我找到了将 xib 文件转换为 nib 的方法。因为项目的向后兼容性问题，所以我必须这样做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T09:35:51.687

在 Interface Builder Save As... 对话框中，您可以选择另存为 Xib 或 Nib。但是，xib 文件可以做任何 nib 可以做的事情，甚至更多。事实上，在构建应用程序时，xibs 会编译为 nibs。因此，除非它是项目的向后兼容性问题，否则您可能需要考虑 xib。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T09:36:22.217

默认情况下，Xcode 将创建一个新格式的 xml nib 文件（又名 .xib 文件）。
如果您想要一个 .nib 文件，则在创建文档后，使用 Interface Builder 中的“另存为”并选择“Interface Builder Cocoa Document (NIB 3.x)”或“Interface Builder Cocoa Document (NIB 2.x)”从文件类型下拉菜单中

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T10:47:10.607

.xib 文件比 .nib 文件有另一个优势——它们以基于文本的 xml 格式存储。这使得使用版本控制系统更容易。

尽管您不应该尝试直接编写/编辑 .xib 文件；如果存在合并冲突，您有时可以通过查看 diff 文件找出冲突的更改。

# objective-c - Mac OS X 视图交换

> ID：938637
> 
> 赞同：7
> 
> 时间：2009-06-02T09:26:43.157
> 
> 标签：objective-c, cocoa, macos

我正在开发一个应用程序，它有一个图像和一些按钮，它们的位置在整个流程中保持不变。所以我继承了 NSViewController。这是我的应用程序的主视图，带有固定按钮和图像。我添加了一个 NSBox 项目，其中将显示各种子视图并换入/换出。如何在此框中显示按钮单击事件的自定义视图？我尝试了以下代码：

```
 intro = [[Introduction alloc] initWithNibName:@"Introduction" bundle:nil];
    [intro setNextResponder:[self nextResponder]];
    [self setNextResponder:intro];            
    [box setContentView:[intro view]]; 
```

但我收到以下错误：-[NSViewController loadView] 加载了“介绍”笔尖，但未设置视图。

文件的所有者设置为简介类。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T11:23:37.943

I get this error when I change the class of my File's Owner in IB.

When I get this error, I can generally fix it by remaking the connection between File's Owner and the view. Control-drag from the File's owner to your View (in IB) and select view from the pop-up menu.

# php - CMS 有多个功能相同的模块，如管理评论和类别。我应该怎么做才能避免重复代码？

> ID：938647
> 
> 赞同：1
> 
> 时间：2009-06-02T09:28:58.050
> 
> 标签：php, zend-framework, content-management-system

我正在开发一个基于 Zend 框架的 CMS，它有许多模块，例如新闻和画廊。每个模块都有一些与管理类别和评论功能相同的部分（新闻、照片、相册的类别和评论——来自新闻和图库模块——是分开的）。有人可以给我建议以避免重复代码吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T09:46:51.867

编写类以将逻辑抽象到中央源文件。基本上，使用封装。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T09:49:16.870

分离应重用的应用程序部分。从复制粘贴开始是一个很好的策略，并且只有在您至少有两个具体的抽象用途时才将其重构为共享组件。

# traffic - 我们可以编写一个程序来测量任何网站的流量，比如 Alexa 吗？

> ID：938650
> 
> 赞同：1
> 
> 时间：2009-06-02T09:29:36.130
> 
> 标签：traffic, web-traffic, traffic-measurement

我们可以编写一个程序来测量任何网站（如 Alexa 或 ComScore）的流量吗？我们是否需要位于互联网骨干网的中间或有权访问此类流量数据？我们可以编写任何程序来仅使用消费者级别的互联网连接来测量它吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T10:11:38.340

如果您想衡量流量，您需要一种方法来计算最终用户使用特定网站的次数。

基本上有5个地方可以进行测量：

1.  修改网站以检索“额外的东西”并对其进行计数（即omniture 等工作的方式）。
2.  更改浏览器中的某些内容（例如 Alexa 使用的插件）。
3.  窃听网络（在 ISP 级别）
4.  窃听网络（在应用程序托管提供商级别）
5.  更改服务器应用程序并让它自己记录使用情况。

除了最后两个选项之外，您根本没有测量。你正在测量一些你**假设**与实际发生的事情有某种关系的东西。所以在现实中，你报告的更多是关于你的假设而不是你的测量结果。

*   Omniture 假设它计算所有访问者...除了那些有“addblock plus”的人，或者浏览器对于 javascript 来说有点太旧，或者是谷歌机器人，或者故意试图超载网站......等等.
*   Alexa 假设其插件的用户代表“整个”互联网。当然 ....

进行网站统计的唯一可靠方法是在托管这些网站的实际位置进行技术更改。而且我确信 Alexa 不会让你这样做。

那么“你能写”这样的程序吗？你当然可以。“唯一”的问题是将其部署在可以获得有用数字的地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T09:35:49.363

你不能那样做，不。Alexa 通过赠送人们安装到浏览器中的工具栏来做到这一点，该工具栏向 Alexa 报告他们访问了哪些网站。

即使是“在互联网骨干网的中间”也无济于事，因为人们会从各种不同的路线访问该网站。您需要控制提供网站的服务器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T09:54:30.370

**从技术上讲**，GoogleAnalytics 使用的方式可能是最容易做到的：在每个站点上都有一个脚本，该脚本将向您报告页面访问情况。

这样做的缺点：您需要网站的参与 - 网站本身必须嵌入您的跟踪代码（即 urchin.js 脚本等）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T09:45:47.283

采用了多种方法，有些方法比其他方法更好。如前所述，Alexa 有一个工具栏，供互联网用户社区的一部分使用。这具有与之相关的内在偏见 - 了解 alexa 并使用工具栏的人。

其他公司，如 Quantcast，查看用户 cookie，并与网站建立协作计划，为网站提供基本评级#s。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-14T07:51:39.897

如果你有一个优秀的程序员团队，你可能可以编写一个程序，因为 Alexa 和 ComScore 做到了。

您无法计算您喜欢的任何站点的流量，而不是坐在主干网中间，也不是来自家里。您需要坐在您喜欢计算的每个站点的前面，或者该站点的每个访问者前面。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-11T13:59:08.513

我想，您的问题是：**如何根据 alexa 数据估计网络流量**？如果这是正确的，您会发现此服务很有用：

[http://www.alexarank2traffic.com/](http://www.alexarank2traffic.com/)

# jquery - 用动画从位置 A 缓慢移动到位置 B

> ID：938655
> 
> 赞同：32
> 
> 时间：2009-06-02T09:30:48.360
> 
> 标签：jquery, jquery-ui

我使用了一个简单的 jQuery 动画`fadein`，它可以工作，但一旦淡入...我希望使用 TOP 属性向上移动 30 像素，但速度很慢。

这是我到目前为止所拥有的：

```
$('#Friends').fadeIn("slow"); 
```

我同时加载了 jQuery 和 jQuery UI...

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-06-02T09:34:13.377

使用 jquery [animate](http://docs.jquery.com/Effects/animate)并给它一个很长的持续时间，比如 2000

```
$("#Friends").animate({ 
        top: "-=30px",
      }, duration ); 
```

-= 表示动画将相对于当前顶部位置。

请注意，该`Friends`元素必须在 css 中将位置设置为相对：

```
#Friends{position:relative;} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-02T09:53:24.040

您可以在fadeIn 完成后使用回调对其进行动画处理，如下所示：

```
$("#Friends").fadeIn('slow',function(){
  $(this).animate({'top': '-=30px'},'slow');
}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-11-02T18:12:07.617

我不明白为什么其他答案是关于相对坐标变化的，而不是像标题中问的那样绝对。

```
$("#Friends").animate( {top:
  "-=" + (parseInt($("#Friends").css("top")) - 100) + "px"
} ); 
```

# vb.net - 处理自定义函数中的异常

> ID：938666
> 
> 赞同：2
> 
> 时间：2009-06-02T09:33:11.223
> 
> 标签：vb.net, try-catch

我们所有人都使用 try catch 块。但是在自定义函数中处理错误的最佳方法是什么？

抛出异常时向用户显示一个消息框（如果可能在函数内），或者返回一个值指示在函数内发现错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T10:23:09.830

这实际上取决于功能，但总的来说，我建议不要让它向用户显示 MessageBox；这是 UI 的任务。如果函数（出于任何正当理由）*确实*显示了 MessageBox，请提供保证“静默”的重载，以便函数的调用者可以阻止 MessageBox。但是，正如我所说，我认为最好让调用者决定如何处理异常。毕竟，该函数可能是从没有 UI 的 Windows 服务调用的。

我通常使用以下方法之一：

*   根本没有捕捉到异常，而是让它向上冒泡。这是通过简单地不在函数中实现 try-catch 块来完成的。
*   捕获异常，对其进行处理（例如记录它），然后重新抛出它。
*   捕获异常，将其（作为 InnerException）包装在抛出的新异常中，可能会完成一些日志记录。

这适用于函数本身无法处理异常的情况。在某些情况下，该函数可能会处理异常状态并仍然执行其工作。在这些情况下，函数当然不会抛出异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T09:50:36.917

我让我所有的错误冒泡到顶层，在那里我使用应用程序错误处理程序来处理它们。

如果我知道某个特定错误可能发生在 aa 函数中并且该函数可以处理它，那么我会这样做。

超时、未设置的对象引用等会上升到顶级处理程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T10:57:58.557

不要捕获您无法处理的异常。到处都是 try/catch 块的代码很难阅读，这意味着您的异常处理代码没有包含在一个地方以便于维护。

如果您只是记录异常或提醒用户，这应该在堆栈顶部（或在您的应用程序层边界）完成。使用 Application.ThreadException 事件和 AppDomain.CurrentDomain.UnhandledException 事件并将它们连接到您的 Sub Main 方法中的事件处理程序。

# linq - 如何在一行中从字符串数组中删除空元素？

> ID：938671
> 
> 赞同：1
> 
> 时间：2009-06-02T09:34:05.560
> 
> 标签：linq, arrays, split

```
string[] ssss = "1,2,,3".Split(new[] {','})
                  .Where(a=>!string.IsNullOrEmpty(a))
                  .Select(); 
```

这是如何工作的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T09:37:19.627

你也可以使用

```
"1,2,,3".Split(",".ToCharArray(), StringSplitOptions.RemoveEmptyEntries); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T09:37:09.860

```
string[] ssss = "1,2,,3".Split(new [] {','}, StringSplitOptions.RemoveEmptyEntries); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T09:37:24.587

```
string[] ssss = "1,2,,3".Split(new[] {','}).Where(a=>!string.IsNullOrEmpty(a)).ToArray(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T09:37:23.277

```
var ssss = "1,2,,3".Split(new[] {','}).Where(a=>!string.IsNullOrEmpty(a));
foreach (string s in ssss)
{
    Console.WriteLine(s);
} 
```

# jquery - 如何使用带有 jquery 的 Master Page 制作菜单？

> ID：938676
> 
> 赞同：0
> 
> 时间：2009-06-02T09:35:23.140
> 
> 标签：jquery, asp.net-mvc

现在我正在制作一个 mvc 项目并且我使用母版页

```
 $('#tabMenu > li').click(function() {  //clik

          if (!$(this).hasClass('active')) {      //if

              $('#tabMenu > li').removeClass('active');

              /  
              $(this).addClass('active');

          }  //endif

      } //click 
```

); } //文档 ）; 和 html 菜单/* /*ul id="tabMenu"> <%= Html.ActionLink("Home", "Index", "Home")%> <%= Html.ActionLink("About", "About", “家”)%>

```
</ul>*/ 
```

它正在工作，但只有 1 秒，因为母版页加载了它的菜单，所以我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T10:29:35.743

你的问题不是很清楚...

以下代码有效......也许这有帮助？

```
<html>
<head>
<script type="text/javascript" src="http://jqueryjs.googlecode.com/files/jquery-1.3.2.min.js"></script>
<style type="text/css">
    #tabMenu li        {display:block;float:left;background-color:green;}
    #tabMenu li a      {color:white;}
    #tabMenu li.active {background-color:blue;}
</style>
<script type="text/javascript">
    $(document).ready(function() {
        $('#tabMenu > li').click(function() {
            if (!$(this).hasClass('active')) {
                $('#tabMenu > li').removeClass('active');
                $(this).addClass('active');
            }
        });    
    });
</script>
</head>
<body>
    <div id="menu">
        <ul id="tabMenu">
            <li><a href="#">MenuItem</a></li>
            <li><a href="#">MenuItem</a></li>
            <li><a href="#">MenuItem</a></li>
        </ul>
    </div>
</body>
</html> 
```

# tdd - 使用 Rhino Mocks 将 TDD 与 Model View Presenter 结合使用的良好示例/参考

> ID：938678
> 
> 赞同：3
> 
> 时间：2009-06-02T09:35:39.130
> 
> 标签：tdd, rhino-mocks, mvp

感谢任何好的示例或网站参考，其中包含使用 Rhino Mocks 将 TDD 与 Model-View-Presenter 模式结合使用的有用信息。

我正在寻找的是关于以下几点

*   模拟什么（查看和演示者）
*   新的 AAA 语法
*   如何模拟 UI 行为？例如，如果在视图中输入“firstName”和“lastName”启用“提交”按钮，否则禁用它。这只是一个简单的例子。
*   最佳实践

非常感谢这个方向的任何输入。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T20:02:31.727

既然你还没有得到答案，我会尽我所能，用我目前所学的；

第一个问题；模拟什么 - 通常你会模拟你没有测试的所有东西。因此，如果您正在测试 ViewModel，您将模拟更改 ViewModel 的视图代码，以及填充/保留 ViewModel 的模拟模型代码。

第二个问题；AAA 语法 - AAA 语法最容易通过在您的测试方法中添加以下类型的注释来保持；

```
[Test]
public void whenUserFillsInFirstAndLastName_ThenUserCanSubmit()
{
    // Arrange - code used to set-up what you are testing.
    this.loadViewModelWithInitalContext(viewModel); // This is a helper that loads the viewmodel

    // Act - code to fullfil the 'when' part in the test.
    this.viewModel.FirstName = "test";
    this.viewModel.LastName = "me";

    // Assert - code to check state of object being tested. (here I am testing a property that I bind to the enabled state of a submit type button)
    Assert.IsTrue(this.viewModel.UserCanSubmit);
} 
```

第三个问题，模拟 UI 行为——通常你把它放在测试的 Act 部分（用于测试 ViewModel）。

最后一个问题，最佳实践，我的经验表明；

*   一次只断言一件事，那么您的测试将因一次失败而失败，并且您将在找出问题所在时为自己节省大量时间。您甚至可以为每个断言设置一个测试方法，但要问一个关于如何做到这一点的新问题，因为它需要 AAA 语法的不同实现才能使事情变得易于管理。
*   使用依赖注入，因为它使代码更容易模拟。
*   让你的测试尽可能的轻量——不要去数据库或磁盘，你希望你的测试快速，所以开发人员尽可能频繁地执行它们。如果我需要 5 分钟来完成测试，我会厌倦等待。如果我需要 10 秒，我愿意更频繁地这样做。
*   最后——但也是最重要的——确保在团队中任何人的每一次签到时都执行所有单元测试。这将使您的测试保持最新，并使您的代码库更加稳定。尽可能频繁地使用 CruiseControl.net 等集成平台在单独的服务器上构建。线索是，如果有人/事物破坏了构建，您想尽快知道。

我推荐的参考资料；使用“你最喜欢的搜索引擎”来搜索你想做的事情，或者在这里发布你的测试示例并获得评论——这将帮助你改进你正在做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-23T21:21:32.143

Phil Haack 对此有一篇非常好的[博客文章](http://haacked.com/archive/2006/08/09/ASP.NETSupervisingControllerModelViewPresenterFromSchematicToUnitTestsToCode.aspx)。下载源代码并查看测试，它们的评论非常好。

# java - Java 性能提示

> ID：938683
> 
> 赞同：19
> 
> 时间：2009-06-02T09:35:57.023
> 
> 标签：java, profiling, performance

我有一个从 C 移植到 Java 的程序。这两个应用程序都使用快速排序来排序一些分区数据（基因组坐标）。

Java 版本运行速度很快，但我想让它更接近 C 版本。我正在使用 Sun JDK v6u14。

显然，我无法与 C 应用程序相提并论，但我想了解我可以做些什么来尽可能地提高性能（在环境限制内）。

我可以做哪些事情来测试应用程序不同部分的性能、内存使用情况等？具体我该怎么办？

此外，我可以（通常）实施哪些技巧来更改类和变量的属性和组织，减少内存使用并提高速度？

**编辑**：我正在使用 Eclipse，显然更喜欢任何第三方工具的免费选项。谢谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-06-02T09:40:10.570

不要试图智取 jvm。

尤其：

*   不要为了性能而避免创建对象

*   在适用的情况下使用不可变对象。

*   正确使用对象的范围，以便 GC 可以完成其工作。

*   在您的意思是基元的地方使用基元（例如，与可空整数相比，不可为空的 int）

*   使用内置算法和数据结构

*   处理并发时使用 java.util.concurrent 包。

*   正确性高于性能。首先把它做对，然后测量，然后用探查器测量，然后优化。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-02T09:39:14.583

显然，profile profile profile。对于 Eclipse，有 TPTP。这是一篇关于[Eclipse 的 TPTP 插件](http://www.eclipse.org/articles/Article-TPTP-Profiling-Tool/tptpProfilingArticle.html)的文章。Netbeans 有自己的[分析器](http://www.netbeans.org/features/java/profiler.html)。[jvisualvm](https://visualvm.dev.java.net/)作为一个独立的工具很不错。（整个 dev.java.net 服务器目前似乎已关闭，但它是一个非常活跃的项目。）

首先要做的是使用库排序例程[Collections.sort](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#sort(java.util.List))；这将要求您的数据对象是[Comparable](http://java.sun.com/javase/6/docs/api/java/lang/Comparable.html)。这可能足够快，并且肯定会提供良好的基线。

一般提示：

*   避免你不需要的锁（你的 JVM 可能已经优化了这些）
*   使用[`StringBuilder`](http://java.sun.com/javase/6/docs/api/java/lang/StringBuilder.html)（不是[`StringBuffer`](http://java.sun.com/javase/6/docs/api/java/lang/StringBuffer.html)因为我刚才提到的那个锁）而不是连接`String`对象
*   做任何你能做的事`final`；如果可能的话，让你的类完全不可变
*   如果您没有在循环中更改变量的值，请尝试将其吊出并查看它是否有所不同（JVM 可能已经为您完成了此操作）
*   尝试在一个[`ArrayList`](http://java.sun.com/javase/6/docs/api/java/util/class-use/ArrayList.html)（甚至是一个数组）上工作，以便您访问的内存是连续的，而不是像使用[`LinkedList`](http://java.sun.com/javase/6/docs/api/java/util/class-use/LinkedList.html)
*   快速排序可以并行化；考虑这样做（请参阅[快速排序并行化](http://en.wikipedia.org/wiki/Quicksort#Parallelizations)）
*   尽可能减少数据的可见性和生存时间（但不要扭曲你的算法来做到这一点，除非分析表明这是一个巨大的胜利）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-02T09:39:49.027

使用分析器：

*   [visualvm](https://visualvm.dev.java.net/)（免费，有限）
*   [jprofiler](http://www.ej-technologies.com/products/jprofiler/overview.html)（商业）
*   [yourkit java profiler](http://www.yourkit.com/) ( 商业 )
*   [hprof](http://java.sun.com/developer/technicalArticles/Programming/HPROF.html)（免费，有限，仅限控制台）

使用您的提供商提供的最新版本的 JVM。顺便说一句，Sun 的 Java 6 更新 14 确实带来了[性能改进](http://java.sun.com/javase/6/webnotes/6u14.html)。

测量您的 GC 吞吐量并[为您的工作负载选择最佳的垃圾收集器](http://java.sun.com/javase/technologies/hotspot/gc/gc_tuning_6.html)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-02T11:34:31.230

不要过早优化。

衡量性能，然后优化。

尽可能使用最终变量。它不仅可以让 JVM 进行更多优化，还可以让你的代码更易于阅读和维护。

如果您使您的对象不可变，则不必克隆它们。

首先通过更改算法进行优化，然后通过更改实现来进行优化。

有时您需要求助于旧式技术，例如循环展开或缓存预先计算的值。记住它们，即使它们看起来不好看，它们也很有用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-02T09:52:24.837

jvisualvm 现在附带 JDK 6 - 这就是上面引用的链接不起作用的原因。只需键入“jvisualvm <pid>”，其中 <pid> 是您要跟踪的进程的 ID。你会看到堆是如何被使用的，但你不会看到它被什么填满了。

如果是长时间运行的进程，可以在运行时开启 -server 选项。有很多调整选项可供您使用；那只是一个。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-02T10:27:27.137

还可以尝试调整 VM 的运行时参数 - 例如，最新版本的 VM 包括以下标志，可以在某些情况下提高性能。

```
-XX:+DoEscapeAnalysis 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-08-17T02:43:45.850

首先需要注意的是 -在开始任何优化工作之前，请确保您已经完成了适当的**分析或基准测试。**结果通常会启发您，并且几乎总能节省您在优化无关紧要的事情上的大量精力。

假设您确实需要它，那么您可以获得与 Java 中的 C 相当的性能，但这需要一些努力。您需要知道 JVM 在哪里做“额外工作”并避免这些。

尤其：

*   **避免不必要的对象创建**。虽然 JVM 堆和 GC 非常快速和高效（可能是世界上最好的，而且几乎可以肯定比任何你可以在 C 中自己滚动的东西都要好），但它仍然是堆分配，并且会通过在第一次避免堆的情况下被击败放置（堆栈或寄存器分配）
*   **避免盒装原语**。您想使用`double`而不是`Double`.
*   **对任何大块数据**使用原始数组。**Java 原始数组基本上与 C/C++ 数组一样快（它们确实有一个额外的边界检查，但这通常是微不足道的）**
***   **避免任何同步**- Java 线程相当不错，但它仍然是您可能不需要的开销。给每个线程它自己的数据来处理。*   **Exploit concurrency** - Java 的并发支持非常好。您不妨使用所有核心！这是一个很大的话题，但有很多好书/教程可用。*   **如果您有一些非常具体的要求，例如支持一些专门的排序/搜索算法，请为某些类型的数据**使用专门的集合类。**您可能需要自己动手，但也有一些具有高性能集合类的优秀库可以满足您的需求 - 参见例如[Javoltion](http://javolution.org/)*****   **避免大类继承**——这是性能代码中的一种设计味道。每一层抽象都在消耗你的开销。非常快的 Java 代码通常最终看起来很像 C....*   **使用静态方法**——JIT 可以非常好地优化这些方法。它通常会内联它们。*   **使用最终的具体类**——同样，JIT 可以通过避免虚函数调用来很好地优化这些。*   **生成您自己的字节码**- 如果所有其他方法都失败了，如果您希望 JVM 的绝对最大性能，这可能是一个可行的选择。如果您需要编译自己的 DSL，则特别有用。使用类似[ASM](http://asm.ow2.org/)的东西。****

 ***** * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-02T09:45:15.927

如果您的算法占用大量 CPU，您可能需要考虑利用并行化。您可能能够在多个线程中排序并稍后将结果合并回来。

然而，这不是一个轻率的决定，因为编写并发代码很困难。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-02T09:50:16.947

不能使用 Java 库中包含的排序函数吗？

您至少可以查看两个排序功能之间的速度差异。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-02T09:42:10.007

从方法上讲，您必须对应用程序进行概要分析，然后了解程序的哪些组件是时间和内存密集型的：然后仔细查看这些组件，以提高它们的性能（请参阅[阿姆达尔定律](http://en.wikipedia.org/wiki/Amdahl%27s_law)）。

从纯粹的技术 POV 来看，您可以使用一些 java 到本机代码的编译器，例如 Excelsior 的 jet，但我必须注意最近的 JVM 非常快，因此 VM 不应该以显着的方式产生影响。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-02T11:10:23.650

您的排序代码是只执行一次，例如在一个只排序的命令行实用程序中，还是执行多次，例如一个响应某些用户输入进行排序的 web 应用程序？

代码执行几次后，性能可能会显着提高，因为如果 HotSpot VM 确定您的代码是热点，它可能会积极优化。

与 C/C++ 相比，这是一个很大的优势。

VM 在运行时会优化经常使用的代码，并且做得很好。因此，性能实际上可以超越 C/C++。真的。;)

不过，您的自定义 Comparator 可能是优化的地方。

尝试先检查便宜的东西（例如 int 比较），然后再检查更昂贵的东西（例如 String 比较）。我不确定这些提示是否适用，因为我不知道您的比较器。

使用 Collections.sort(list,comparator) 或 Arrays.sort(array,comparator)。数组变体会更快一些，请参阅相应的文档。

正如 Andreas 之前所说：不要试图智取 VM。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-02T13:53:23.587

除了代码的微优化之外，也许还有其他途径可以提高性能。用不同的算法来实现你想让你的程序做的事情怎么样？可能是不同的数据结构？

或者用一些磁盘/内存空间换取速度，或者如果您可以在加载程序期间预先放弃一些时间，您可以预先计算查找表而不是进行计算 - 这样，处理速度很快。即，对可用的其他资源进行一些权衡。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-02T17:05:40.437

[这就是我会做的，用任何语言。](https://stackoverflow.com/questions/926266/performance-optimization-strategies-of-last-resort/927773#927773)如果样本显示您的排序比较例程在大部分时间都处于活动状态，您可能会找到一种简化它的方法。但也许时间正在别处。先诊断，看看有什么问题，然后再修复任何东西。很有可能，如果你修复了最大的问题，那么其他的东西就会成为最大的问题，依此类推，直到你真正获得了相当不错的加速。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-12-06T00:09:53.973

分析和调整您的 java 程序和主机。大多数代码遵循 80/20 规则。那是 20% 的代码 80% 的时间，所以找到 20% 并尽可能快地完成它。例如，文章 Tuning Java Servers ( [http://www.infoq.com/articles/Tuning-Java-Servers](http://www.infoq.com/articles/Tuning-Java-Servers) ) 提供了从命令行向下钻取的描述，然后使用 Java Flight recorder、Eclipse Memory 等工具隔离问题分析器和 JProfiler。

# javascript - jQuery 跨域 ajax 调用和 Internet Explorer

> ID：938690
> 
> 赞同：1
> 
> 时间：2009-06-02T09:37:19.267
> 
> 标签：javascript, jquery, ajax, internet-explorer

以下代码在 Firefox 中运行良好，但在 IE 中，链接永远不会被调用，异常是用一个相当通用的 [Object Error] 调用的

```
var GoalID = "e13e68a8-ae18-49f1-9d2f-e052a63fac51";
try
{
    $.ajax({
      type: "GET",
      url: "http://www.externallink.co.uk/GoalAccessed.aspx?id=" + GoalID,
      dataType: "script"
    });
}
catch(err){alert(err);} 
```

有没有办法克服这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T09:47:00.293

不允许跨域 Ajax 调用

解决方案（不是最好的）

```
Prepare a local file (e.g. localfile.asp) 
which initiates RPC to a remote server 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T14:40:57.720

你可以试试 load(url, [data], [func])。

我试图使用 $.post 加载 HTML 页面，当我偶然发现加载时它不起作用。我尝试进行跨域引用 (XSS)，但它有一个警告 - 用户收到安全警告“此页面正在尝试访问不受其控制的信息。这会带来安全风险。你想继续吗？” . 如果用户说是，它将允许加载内容。

要通过一些示例代码更详细地了解，您可以尝试以下网址：

[http://sites.google.com/site/spyderhoodcommunity/tech-stuff/jqueryloadurldatafunc](http://sites.google.com/site/spyderhoodcommunity/tech-stuff/jqueryloadurldatafunc)

# html - CSS 可以用来定位 HTML 标签中的用户定义属性吗？

> ID：938696
> 
> 赞同：2
> 
> 时间：2009-06-02T09:37:51.777
> 
> 标签：html, css

我有很多具有属性和值的 div。

我的问题是我可以使用 CSS 来定位这些 div 以进行样式设置吗？

这样我就可以为样式创建 CSS 类，并使用 javascript 在页面上添加功能。否则我需要单独创建 CSS 类和属性。

另外一点 - 我这样做是为了让网站优雅地降级。因此，当 javascript 不可用时，样式不受影响。同时，如果存在 javascript，则可以提供更丰富的体验。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T09:40:43.503

是的，一点没错。

```
div[attr~=value] 
```

[阅读有关 CSS 选择器](http://www.w3.org/TR/CSS2/selector.html)的更多信息。不必在 IE 中工作；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T09:58:38.520

正如 Maciej 指出的那样，理论上答案是肯定的。

在现实世界的实践中，答案是“视情况而定”。

更高版本的 CSS 包括通过任意属性选择元素的方法（顺便说一句，当您使用“类”这个词时，您的意思是“选择器”，对吗？），甚至最近一些浏览器已经开始实现 CSS 的这一部分。

因此，如果您的受众主要由使用支持此功能的浏览器的人组成，并且您可以对您的网站进行编码，以便为那些不支持此功能的人优雅地降级，那么答案仍然是肯定的。由于 IE7/6（我不知道 8）不支持这一点，我们正在谈论可以说服/强制不使用 IE 的非公开受众。一项艰巨的任务。

类属性的标准使用不适合你有什么原因吗？

由于这个问题涉及到 javascript 的使用，因此 JQuery（在大多数浏览器中可以使用任意属性进行选择）可能是您的解决方案。

# c# - 将 LiNQ 嵌套到 XML

> ID：938698
> 
> 赞同：0
> 
> 时间：2009-06-02T09:38:06.440
> 
> 标签：c#, .net, xml, linq

我正在寻找一种保存/加载以下内容的好方法。我想保存为 XML 并希望使用 LiNQ（即帮助我学习 LINQ）

我不知道如何进行嵌套 linq 写入。任何人都可以帮忙吗？

```
 /// <summary>
/// 
/// </summary>
public class ErrorType
{
    List<ErrorType> _childErrors;

    public String Name { get; set; }
    public bool Ignore { get; set; }

    public List<ErrorType> ChildErrors { get; protected set; }
}

/// <summary>
/// 
/// </summary>
public class ErrorList
{
    public List<ErrorType> ChildErrors { get; protected set; }

    public void Save()
    {
    }

    public void Load()
    {
    }
} 
```

本质上，ErrorList 包含顶级错误列表，每个错误都可以有子级。XML 输出应类似于：

```
<ErrorList>
<ErrorName1 Ignore="false">
<ChildErrorName1 Ignore="true">
<ChildErrorName2 Ignore="false" />
</ChildErrorName1>
</ErrorName1>
<ErrorList> 
```

如果有人可以提供帮助，那就太好了。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T09:50:14.640

好吧，我想我明白你现在在追求什么了。试试这个：

```
// Need to declare in advance to call within the lambda.
Func<ErrorType, XElement> recursiveGenerator = null;
recursiveGenerator = error => new XElement
    (error.Name,
     new XAttribute("Ignore", error.Ignore),
     error.ChildErrors.Select(recursiveGenerator));

var errorList = new XElement
    ("ErrorList", errors.ChildErrors.Select(recursiveGenerator)); 
```

这是一个完整的例子：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Xml.Linq;

public class ErrorType
{
    public String Name { get; set; }
    public bool Ignore { get; set; }

    public List<ErrorType> ChildErrors { get; protected set; }
    public ErrorType()
    {
        ChildErrors = new List<ErrorType>();
    }
}

public class ErrorList
{
    public List<ErrorType> ChildErrors { get; protected set; }
    public ErrorList()
    {
        ChildErrors = new List<ErrorType>();
    }
}

public class Test
{
    public static void Main()
    {
        var childError2 = new ErrorType { 
            Name = "ChildErrorName2", Ignore=false };
        var childError1 = new ErrorType {
            Name = "ChildErrorName1", Ignore=true,
            ChildErrors = { childError2 }
        };
        var mainError = new ErrorType {
            Name = "ErrorName1", Ignore=true,
            ChildErrors = { childError1 }
        };
        var errorList = new ErrorList { ChildErrors = { mainError } };

        // Need to declare in advance to call within the lambda.
        Func<ErrorType, XElement> recursiveGenerator = null;
        recursiveGenerator = error => new XElement
            (error.Name,
             new XAttribute("Ignore", error.Ignore),
             error.ChildErrors.Select(recursiveGenerator));

        var element = new XElement
             ("ErrorList", 
              errorList.ChildErrors.Select(recursiveGenerator);

        Console.WriteLine(element);
    }        
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T09:44:11.267

看看[这个](https://stackoverflow.com/questions/456231/xmlserialization-of-mutiple-object-types-in-the-one-list)。它应该是你正在寻找的东西。没有 LINQ 的想法，而是输出 XML 的好方法。

底线是使用[XmlSerializer](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)。

# c# - 如何显示 varBinary 字段数据

> ID：938705
> 
> 赞同：2
> 
> 时间：2009-06-02T09:40:13.503
> 
> 标签：c#, asp.net, sql, sql-server

我有一个数据类型为 varBinary 的数据库字段。现在在 gridView 中我想显示该数据。但我得到输出：

```
System.Byte[] 
```

不是价值

```
0x2C6D1A 
```

这是在数据库中。

请帮助如何解决这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T09:44:06.867

您可以使用[`BitConverter`](http://msdn.microsoft.com/en-us/library/system.bitconverter.aspx)该类来格式化字节数组以用于显示目的：

```
string forDisplay =
    "0x" + BitConverter.ToString(yourByteArray).Replace("-", string.Empty); 
```

如果您不想直接转换为 a `string`，那么[`BitConverter`有很多方法](http://msdn.microsoft.com/en-us/library/system.bitconverter_members.aspx)可以将字节数组转换为各种其他类型。

**编辑...**

如果您将一些查询结果直接绑定到`GridView`控件，那么将您的`VARBINARY`列转换`VARCHAR`为查询本身中的 a 可能会更容易：

```
SELECT CONVERT(VARCHAR(MAX), your_varbinary_column, 1) AS for_display
FROM your_table 
```

*（注意：这种类型的转换 - 从格式`VARBINARY`到格式 - 仅在 SQL Server 2008 中正常工作。SQL Server 的早期版本只是将二进制数据直接转换为字符数据。`VARCHAR`）`'0x1234AB'`*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T10:03:23.410

如果没有任何明显可用的东西，也许只是循环：

```
 public static string ToHexString(byte[] raw)
    { // could also be an extension method
        StringBuilder sb = new StringBuilder("0x", 2 + (raw.Length * 2));
        for (int i = 0; i < raw.Length; i++)
        {
            sb.Append(raw[i].ToString("X2"));
        }
        return sb.ToString();
    } 
```

如果这是一个类属性，那么创建一个`TypeConverter`执行此操作（用于显示目的）并用 标记该属性将是微不足道的`[TypeConverter(typeof(HexConverter))]`：

```
 class HexConverter : TypeConverter // untested
    {
        public override object ConvertTo(ITypeDescriptorContext context,
            System.Globalization.CultureInfo culture,
            object value, Type destinationType)
        {
            if (destinationType == typeof(string))
            {
                return ToHexString((byte[])value);
            }
            return base.ConvertTo(context, culture, value, destinationType);
        }
    } 
```

# asp.net - 如何实现 ASP.NET 购物车？

> ID：938714
> 
> 赞同：7
> 
> 时间：2009-06-02T09:44:56.693
> 
> 标签：asp.net, shopping-cart

我试图找到类似的问题，但没有运气。任何人都可以给我一个想法，如何以最佳实践方式在 ASP.NET 中构建购物车？

我知道一种使用 Session 的方法，但我认为跨页面维护 Session 会很痛苦。我也听说要使用 Profile。

那么我必须选择哪一个？哪一个是最好和最推荐的解决方案？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-02T20:07:15.483

我使用以下方法构建了许多：

*   创建一个名为 ShoppingCart 的数据库表
*   将您的 ASP.NET 会话存储为外键
*   为每行添加一个 ProductID 或为每行存储一个 ProductID 列表。这通常取决于您是否需要存储有关每种产品的元数据，例如数量或尺寸。如果每行存储一个产品，元数据越多，管理起来就越容易。

一本涵盖电子商务的好书是 APress 书籍“ [Beginning ASP.NET 2.0 E-Commerce](https://rads.stackoverflow.com/amzn/click/com/1590594681) ”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T09:53:32.743

似乎有点模糊的问题，我想你问如何构建整个应用程序，这很难简单回答

谷歌搜索了一篇很棒的文章：

[http://net.tutsplus.com/tutorials/other/build-a-shopping-cart-in-aspnet/](http://net.tutsplus.com/tutorials/other/build-a-shopping-cart-in-aspnet/)

也看看这个：

[http://codebetter.com/blogs/david.hayden/archive/2005/03/22/60166.aspx](http://codebetter.com/blogs/david.hayden/archive/2005/03/22/60166.aspx)

关于会话状态，根据我的经验，会话状态在单个服务器设置上很有用，但是如果您提前考虑并需要可扩展性以适应网络农场场景，那么序列化数据会出现其他问题。在 sql server 中存储会话状态时需要这样做。为您的应用程序增加了很多复杂性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-24T21:21:57.353

I think, that good way is use turn-key e-commerce solution. For example: [http://advantshop.com/](http://advantshop.com/)

# android - Android - 使用 LocationManager 不会提供地理修复

> ID：938719
> 
> 赞同：3
> 
> 时间：2009-06-02T09:46:28.233
> 
> 标签：android, gps

我正在尝试使用以下代码获取 G1 的 GPS 位置

**活动中**

```
MyLocationListener myListener = new MyLocationListener();
LocationManager myManager = (LocationManager)getSystemService(LOCATION_SERVICE);
myManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 2000, 0, myListener); 
```

这是 LocationListener 类

```
public class MyLocationListener implements LocationListener {

  private static double latitude;
  private static double longitude;

  @Override
  public void onLocationChanged(Location arg0) {
    latitude = arg0.getLatitude();
    longitude = arg0.getLongitude();
  }

  @Override
  public void onProviderDisabled(String provider) {
  }

  @Override
  public void onProviderEnabled(String provider) {
  }

  @Override
  public void onStatusChanged(String provider, int status, Bundle extras) {}

  public static double getLatitude() {
    return latitude;
  }

  public static double getLongitude() {
    return longitude;
  }

} 
```

我等了 30 秒，但没有调用任何侦听器方法。GPS图标出现了，在那里停留了一段时间，但由于某种原因我没有得到修复，即使在户外明亮的阳光下也是如此。我正在使用 1.5 SDK 在 G1 上进行测试。

有人可以告诉我代码有什么问题吗？谢谢。

添加日志

```
06-02 18:30:43.143: ERROR/System(52): java.lang.SecurityException
06-02 18:30:43.143: ERROR/System(52):     at android.os.BinderProxy.transact(Native Method)
06-02 18:30:43.143: ERROR/System(52):     at android.os.ServiceManagerProxy.addService(ServiceManagerNative.java:146)
06-02 18:30:43.143: ERROR/System(52):     at android.os.ServiceManager.addService(ServiceManager.java:72)
06-02 18:30:43.143: ERROR/System(52):     at com.android.server.ServerThread.run(SystemServer.java:155)
06-02 18:30:43.152: ERROR/AndroidRuntime(52): Crash logging skipped, no checkin service

06-02 18:30:43.382: ERROR/SystemServer(52): Failure starting StatusBarService
06-02 18:30:43.382: ERROR/SystemServer(52): java.lang.NullPointerException
06-02 18:30:43.382: ERROR/SystemServer(52):     at com.android.server.status.StatusBarPolicy.updateBluetooth(StatusBarPolicy.java:749)
06-02 18:30:43.382: ERROR/SystemServer(52):     at com.android.server.status.StatusBarPolicy.<init>(StatusBarPolicy.java:282)
06-02 18:30:43.382: ERROR/SystemServer(52):     at com.android.server.status.StatusBarPolicy.installIcons(StatusBarPolicy.java:337)
06-02 18:30:43.382: ERROR/SystemServer(52):     at com.android.server.ServerThread.run(SystemServer.java:186)
06-02 18:30:43.382: ERROR/AndroidRuntime(52): Crash logging skipped, no checkin service 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-05T23:54:50.107

首先，在您调用的活动中，`requestLocationUpdates()`第二个参数是最短时间，而不是预定时间。您目前要求最多每 2 秒更新一次。它实际上不会报告任何内容，直到它可以...有时需要一点时间。

如果您的 GPS 在其他地方也没有响应/速度很慢（例如在地图中），请尝试重新启动手机（有些人声称您必须关闭手机然后拔出电池才能完全关闭 GPS 无线电）。希望这将使它恢复到正常的响应状态。

另外，没关系，但是您说您使用的是 1.5 SDK，但是您没有提及是否针对它进行编译（与 1.1 相对）。我之所以提出这个只是因为 GPS 在 Cupcake 中工作得更好/更快，所以我想知道你的手机实际上在运行什么。

**更新：**

我自己写了一个小测试，看看我是否可以复制你的问题。它仅包含三个用户生成的文件，我使用 SDK 1.1 和 1.5 对其进行了测试

在主要活动中（我只是使用`Main.java`）：

```
package org.example.LocationTest;

import android.app.Activity;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.util.Log;
import android.widget.TextView;

public class Main extends Activity implements LocationListener{
    private LocationManager myManager;
    private TextView tv;

    /********************************************************************** 
     * Activity overrides below 
     **********************************************************************/
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        // get a handle to our TextView so we can write to it later
        tv = (TextView) findViewById(R.id.TextView01);

        // set up the LocationManager
        myManager = (LocationManager) getSystemService(LOCATION_SERVICE);   
    }

    @Override
    protected void onDestroy() {
        stopListening();
        super.onDestroy();
    }

    @Override
    protected void onPause() {
        stopListening();
        super.onPause();
    }

    @Override
    protected void onResume() {
        startListening();
        super.onResume();
    }

    /**********************************************************************
     * helpers for starting/stopping monitoring of GPS changes below 
     **********************************************************************/
    private void startListening() {
        myManager.requestLocationUpdates(
            LocationManager.GPS_PROVIDER, 
            0, 
            0, 
            this
        );
    }

    private void stopListening() {
        if (myManager != null)
            myManager.removeUpdates(this);
    }

    /**********************************************************************
     * LocationListener overrides below 
     **********************************************************************/
    @Override
    public void onLocationChanged(Location location) {
        // we got new location info. lets display it in the textview
        String s = "";
        s += "Time: "        + location.getTime() + "\n";
        s += "\tLatitude:  " + location.getLatitude()  + "\n";
        s += "\tLongitude: " + location.getLongitude() + "\n";
        s += "\tAccuracy:  " + location.getAccuracy()  + "\n";

        tv.setText(s);
    }    

    @Override
    public void onProviderDisabled(String provider) {}    

    @Override
    public void onProviderEnabled(String provider) {}    

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {}
} 
```

在您的“主要”布局文件中（我使用过`main.xml`）：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical" 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <TextView 
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" 
        android:id="@+id/TextView01"
        android:text="Waiting for location information..." 
    />
</LinearLayout> 
```

然后，在你的`AndroidManifest.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="org.example.LocationTest"
    android:versionCode="1"
    android:versionName="1.0">
    <application 
        android:icon="@drawable/icon" 
        android:label="@string/app_name">
        <activity 
            android:name=".Main"
            android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
    <uses-sdk android:minSdkVersion="3" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
</manifest> 
```

你应该能够编译/运行它就好了。如果，使用这个，你仍然无法得到修复，这不是软件问题。你要么有一个糟糕的 GPS，要么就是无法锁定任何卫星。

你可以在[这里](http://fixedd.com/project_files/AndroidLocationTest.tar.gz)下载源代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T12:14:04.350

1.  您的设备设置中是否启用了 GPS？我想是这样，因为你得到了 GPS 图标，但我想我会检查一下。
2.  只有在设置中禁用 GPS 时才会调用 onProviderDisabled()，因此不太可能调用该代码。
3.  您是否尝试过 0 而不是 2000 的距离？
4.  您确定您对 requestLocationUpdates() 的调用实际上正在执行吗？
5.  您的日志是否显示任何错误？您可以通过 adb logcat、DDMS 或 Eclipse 中的 DDMS 透视图检查您的日志。
6.  您是否尝试过任何现有的、已发布的、应该可以工作的代码？例如，您可以获取[我的 Android 书籍](http://commonsware.com/Android/)的源代码，其中 Weather 和 WeatherPlus 示例展示了 LocationManager 的使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-01T13:48:06.540

这是一个很好的例子，源代码[http://marakana.com/forums/android/android_examples/42.html](http://marakana.com/forums/android/android_examples/42.html)

# c# - Sql ce 3.0 数据库多用户

> ID：938729
> 
> 赞同：1
> 
> 时间：2009-06-02T09:49:57.713
> 
> 标签：c#, windows-mobile, sql-server-ce

我试图从两个不同的应用程序访问 Windows 移动设备上的 Sql CE 2005 数据库。

根据我在网上找到的信息，它应该可以工作，但是当我打开第二个连接时，出现文件共享冲突错误

```
"There is a file sharing violation. A different process might be using the file. [ \\\Program Files\xx\DB.sdf ]" 
```

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T12:59:18.580

SQL Compact[确实支持到数据库的多个连接](http://msdn.microsoft.com/en-us/library/ms171959.aspx)，[甚至在 3.0 版本](http://blogs.msdn.com/stevelasker/archive/2006/04/10/SqlEverywhereInfo.aspx)中也是如此。第一个进程如何打开数据库？例如，3.0 和 3.1 的移动查询分析器确实以独占方式打开数据库，有效地将其与任何其他进程锁定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-16T16:22:14.733

问题是连接字符串.....

`"Data Source=\\\Program Files\xx\DB.sdf"`显然以单个用户身份打开数据库

使用

`"Data Source=Program Files\xx\DB.sdf"`正常打开数据库...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T10:27:59.727

是同一进程使用多个线程访问此 sdf 文件，还是仅使用一个线程。当它说其他一些“过程”正在访问该文件时，它是什么？是VS，还是别的什么。我认为您可以使用远程进程查看器来查看设备中的哪些进程正在使用此 SDF 文件。如果您可以分别看到哪些句柄用于设备中的哪些进程，那就太好了。即便如此，在杀死桌面上的一些进程后，尝试删除 sdf 文件（或移动/重命名它）。这可能会告诉你什么是违规过程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-13T20:41:32.897

SQLCE 4 社区技术预览版已发布。它支持多用户场景和来自同一进程的多个线程的访问。

它不会遇到与 SQLCE 3.5 相同的问题。在 256 个连接上运行良好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-06T09:48:09.530

参考：http: [//msdn.microsoft.com/en-us/library/ms171750.aspx](http://msdn.microsoft.com/en-us/library/ms171750.aspx)

//在 SQL Server Compact 中，您可以同时运行多个**正在访问或修改不同数据集的应用程序。**

我认为很多人被误导的原因是因为 sql ce 支持多个连接，他们使用它来修改具有 sql server CE 不支持的多个连接**的同一组数据。**

希望这可以帮助！

# python - Python进程使用的总内存？

> ID：938733
> 
> 赞同：360
> 
> 时间：2009-06-02T09:50:40.083
> 
> 标签：python, memory-management

Python 程序有没有办法确定它当前使用了多少内存？我已经看到有关单个对象的内存使用情况的讨论，但我需要的是进程的总内存使用情况，以便我可以确定何时需要开始丢弃缓存的数据。

* * *

## 回答 #1

> 赞同：435
> 
> 时间：2014-02-07T16:11:44.000

[这](http://fa.bianp.net/blog/2013/different-ways-to-get-memory-consumption-or-lessons-learned-from-memory_profiler/)是一个适用于各种操作系统（包括 Linux、Windows 等）的有用解决方案：

```
import os, psutil
process = psutil.Process(os.getpid())
print(process.memory_info().rss)  # in bytes 
```

笔记：

*   `pip install psutil`如果尚未安装，请执行此操作

*   如果您很快想知道您的过程需要多少 MB，那么方便的单线：

    ```
    import os, psutil; print(psutil.Process(os.getpid()).memory_info().rss / 1024 ** 2) 
    ```

*   在 Python 2.7 和 psutil 5.6.3 中，它是`process.memory_info()[0]`相反的（后来 API 发生了变化）。

* * *

## 回答 #2

> 赞同：250
> 
> 时间：2011-10-06T01:23:56.997

对于基于 Unix 的系统（Linux、Mac OS X、Solaris），您可以使用`getrusage()`标准库模块中的函数[`resource`](https://docs.python.org/library/resource.html)。结果对象具有属性`ru_maxrss`，它给出了调用进程的*峰值*内存使用量：

```
>>> resource.getrusage(resource.RUSAGE_SELF).ru_maxrss
2656  # peak memory usage (kilobytes on Linux, bytes on OS X) 
```

[Python 文档](https://docs.python.org/library/resource.html#resource-usage)没有记录单位。请参阅特定系统的[`man getrusage.2`](http://man7.org/linux/man-pages/man2/getrusage.2.html)页面以检查单位的值。在 Ubuntu 18.04 上，单位以千字节表示。在 Mac OS X 上，它是字节。

该`getrusage()`函数还可以`resource.RUSAGE_CHILDREN`用于获取子进程的使用情况，以及（在某些系统上）`resource.RUSAGE_BOTH`获取总（自身和子）进程使用情况。

如果您只关心 Linux，您也可以按照此问题的其他答案和[这个](https://stackoverflow.com/questions/897941/)问题的其他答案中的描述阅读`/proc/self/status`or文件。`/proc/self/statm`

* * *

## 回答 #3

> 赞同：69
> 
> 时间：2009-06-02T10:13:40.987

在 Windows 上，您可以使用 WMI（[主页](http://timgolden.me.uk/python/wmi.html)、[cheeseshop](http://pypi.python.org/pypi/WMI/1.3.2)）：

```
def memory():
    import os
    from wmi import WMI
    w = WMI('.')
    result = w.query("SELECT WorkingSet FROM Win32_PerfRawData_PerfProc_Process WHERE IDProcess=%d" % os.getpid())
    return int(result[0].WorkingSet) 
```

在 Linux 上（来自 python 食谱[http://code.activestate.com/recipes/286222/](http://code.activestate.com/recipes/286222/)：

```
import os
_proc_status = '/proc/%d/status' % os.getpid()

_scale = {'kB': 1024.0, 'mB': 1024.0*1024.0, 'KB': 1024.0, 'MB': 1024.0*1024.0}

def _VmB(VmKey):
    '''Private.'''
    global _proc_status, _scale
     # get pseudo file  /proc/<pid>/status
    try:
        t = open(_proc_status)
        v = t.read()
        t.close()
    except:
        return 0.0  # non-Linux?
     # get VmKey line e.g. 'VmRSS:  9999  kB\n ...'
    i = v.index(VmKey)
    v = v[i:].split(None, 3)  # whitespace
    if len(v) < 3:
        return 0.0  # invalid format?
     # convert Vm value to bytes
    return float(v[1]) * _scale[v[2]]

def memory(since=0.0):
    '''Return memory usage in bytes.'''
    return _VmB('VmSize:') - since

def resident(since=0.0):
    '''Return resident memory usage in bytes.'''
    return _VmB('VmRSS:') - since

def stacksize(since=0.0):
    '''Return stack size in bytes.'''
    return _VmB('VmStk:') - since 
```

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2009-06-02T09:59:10.673

在 unix 上，您可以使用该`ps`工具对其进行监控：

```
$ ps u -p 1347 | awk '{sum=sum+$6}; END {print sum/1024}' 
```

其中 1347 是某个进程 ID。此外，结果以 MB 为单位。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2018-01-23T08:51:13.003

**Linux 上**当前进程的当前内存使用情况，对于 Python **2**、 Python **3**和**pypy**，没有任何导入：

```
def getCurrentMemoryUsage():
    ''' Memory usage in kB '''

    with open('/proc/self/status') as f:
        memusage = f.read().split('VmRSS:')[1].split('\n')[0][:-3]

    return int(memusage.strip()) 
```

它读取当前进程的状态文件，取之后的所有内容`VmRSS:`，然后取第一个换行符之前的所有内容（隔离 VmRSS 的值），最后切断最后 3 个字节，即空格和单位（kB）。
要返回，它会删除所有空格并将其作为数字返回。

在 Linux 4.4 和 4.9 上进行了测试，但即使是早期的 Linux 版本也应该可以工作：查看`man proc`并搜索`/proc/$PID/status`文件上的信息，它提到了某些字段的最低版本（如 Linux 2.6.10 用于“VmPTE”），但“VmRSS” " 字段（我在这里使用）没有这样的提及。因此，我认为它从早期版本就已经存在。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2018-02-22T08:50:43.833

下面是我的函数装饰器，它允许跟踪这个进程在函数调用之前消耗了多少内存，在函数调用之后它使用了多少内存，以及函数执行了多长时间。

```
import time
import os
import psutil

def elapsed_since(start):
    return time.strftime("%H:%M:%S", time.gmtime(time.time() - start))

def get_process_memory():
    process = psutil.Process(os.getpid())
    return process.memory_info().rss

def track(func):
    def wrapper(*args, **kwargs):
        mem_before = get_process_memory()
        start = time.time()
        result = func(*args, **kwargs)
        elapsed_time = elapsed_since(start)
        mem_after = get_process_memory()
        print("{}: memory before: {:,}, after: {:,}, consumed: {:,}; exec time: {}".format(
            func.__name__,
            mem_before, mem_after, mem_after - mem_before,
            elapsed_time))
        return result
    return wrapper 
```

所以，当你有一些用它装饰的功能时

```
from utils import track

@track
def list_create(n):
    print("inside list create")
    return [1] * n 
```

您将能够看到以下输出：

```
inside list create
list_create: memory before: 45,928,448, after: 46,211,072, consumed: 282,624; exec time: 00:00:00 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2018-11-11T10:15:29.850

对于 Python 3.6 和 psutil 5.4.5，更容易使用[此处](https://psutil.readthedocs.io/en/latest/#psutil.Process.memory_percent)`memory_percent()`列出的函数。

```
import os
import psutil
process = psutil.Process(os.getpid())
print(process.memory_percent()) 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2016-10-21T10:07:52.087

我喜欢[它](https://stackoverflow.com/a/938754/686105)，谢谢@bayer。我现在得到了一个特定的进程计数工具。

```
# Megabyte.
$ ps aux | grep python | awk '{sum=sum+$6}; END {print sum/1024 " MB"}'
87.9492 MB

# Byte.
$ ps aux | grep python | awk '{sum=sum+$6}; END {print sum " KB"}'
90064 KB 
```

附上我的流程清单。

```
$ ps aux  | grep python
root       943  0.0  0.1  53252  9524 ?        Ss   Aug19  52:01 /usr/bin/python /usr/local/bin/beaver -c /etc/beaver/beaver.conf -l /var/log/beaver.log -P /var/run/beaver.pid
root       950  0.6  0.4 299680 34220 ?        Sl   Aug19 568:52 /usr/bin/python /usr/local/bin/beaver -c /etc/beaver/beaver.conf -l /var/log/beaver.log -P /var/run/beaver.pid
root      3803  0.2  0.4 315692 36576 ?        S    12:43   0:54 /usr/bin/python /usr/local/bin/beaver -c /etc/beaver/beaver.conf -l /var/log/beaver.log -P /var/run/beaver.pid
jonny    23325  0.0  0.1  47460  9076 pts/0    S+   17:40   0:00 python
jonny    24651  0.0  0.0  13076   924 pts/4    S+   18:06   0:00 grep python 
```

## 参考

*   [内存 - Linux：找出正在使用所有 RAM 的进程？- 超级用户](https://superuser.com/a/1037753/205255)
*   [Python进程使用的总内存？- 堆栈溢出](https://stackoverflow.com/a/938754/686105)
*   [linux - ps aux 输出含义](https://superuser.com/a/117921/205255)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2018-11-26T06:25:38.463

`/proc/self/status`甚至比:更容易使用`/proc/self/statm`。它只是几个[统计信息](http://man7.org/linux/man-pages/man5/proc.5.html)的空格分隔列表。我无法判断这两个文件是否始终存在。

> /proc/[pid]/statm
> 
> 提供有关内存使用情况的信息，以页为单位。这些列是：
> 
> *   size (1) 总程序大小（与 /proc/[pid]/status 中的 VmSize 相同）
> *   resident (2) 驻留集大小（与 /proc/[pid]/status 中的 VmRSS 相同）
> *   shared (3) 常驻共享页面的数量（即，由文件支持）（与 /proc/[pid]/status 中的 RssFile+RssShmem 相同）
> *   文字（4）文字（代码）
> *   lib (5) 库（自 Linux 2.6 起未使用；始终为 0）
> *   数据（6）数据+堆栈
> *   dt (7) 脏页（自 Linux 2.6 起未使用；始终为 0）

这是一个简单的例子：

```
from pathlib import Path
from resource import getpagesize

PAGESIZE = getpagesize()
PATH = Path('/proc/self/statm')

def get_resident_set_size() -> int:
    """Return the current resident set size in bytes."""
    # statm columns are: size resident shared text lib data dt
    statm = PATH.read_text()
    fields = statm.split()
    return int(fields[1]) * PAGESIZE

data = []
start_memory = get_resident_set_size()
for _ in range(10):
    data.append('X' * 100000)
    print(get_resident_set_size() - start_memory) 
```

这会产生一个看起来像这样的列表：

```
0
0
368640
368640
368640
638976
638976
909312
909312
909312 
```

您可以看到它在大约 3 次分配 100,000 字节后跳跃了大约 300,000 字节。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-11-25T14:46:28.847

```
import os, win32api, win32con, win32process
han = win32api.OpenProcess(win32con.PROCESS_QUERY_INFORMATION|win32con.PROCESS_VM_READ, 0, os.getpid())
process_memory = int(win32process.GetProcessMemoryInfo(han)['WorkingSetSize']) 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2019-08-16T13:01:08.047

对于 Unix 系统`time`，如果您通过 -v，命令 (/usr/bin/time) 会为您提供该信息。见`Maximum resident set size`下文，这是**程序执行期间使用的****最大**（峰值）**实际**（非虚拟）内存：

 **```
$ /usr/bin/time -v ls /

    Command being timed: "ls /"
    User time (seconds): 0.00
    System time (seconds): 0.01
    Percent of CPU this job got: 250%
    Elapsed (wall clock) time (h:mm:ss or m:ss): 0:00.00
    Average shared text size (kbytes): 0
    Average unshared data size (kbytes): 0
    Average stack size (kbytes): 0
    Average total size (kbytes): 0
    Maximum resident set size (kbytes): 0
    Average resident set size (kbytes): 0
    Major (requiring I/O) page faults: 0
    Minor (reclaiming a frame) page faults: 315
    Voluntary context switches: 2
    Involuntary context switches: 0
    Swaps: 0
    File system inputs: 0
    File system outputs: 0
    Socket messages sent: 0
    Socket messages received: 0
    Signals delivered: 0
    Page size (bytes): 4096
    Exit status: 0 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-05-15T22:25:44.487

使用 sh 和 os 进入 python bayer 的答案。

```
float(sh.awk(sh.ps('u','-p',os.getpid()),'{sum=sum+$6}; END {print sum/1024}')) 
```

答案以兆字节为单位。

# jquery - jQuery 查找功能未按预期工作

> ID：938734
> 
> 赞同：2
> 
> 时间：2009-06-02T09:51:03.047
> 
> 标签：jquery

```
var firstValue = $(this).find('.feedback-selected').val();
var secondValue = $('.feedback-selected').val();
alert(firstValue);
alert(secondValue);
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<div>
  <input class="feedback-selected" type="hidden" value="4" />
</div>
```

这听起来可能有点愚蠢，但您能否指出为什么在以下脚本中“firstValue”未定义而“secondValue”是需要的，即 4。

我确定我没有使用应有的 find 功能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T09:54:47.670

**this**在您的示例中没有值，因此 find() 函数将找不到任何内容。

（**这**仅在实例函数或事件处理程序中有效）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T10:02:35.830

[解释 'this' 在 jQuery 中的含义](http://remysharp.com/2007/04/12/jquerys-this-demystified/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T09:59:41.967

activa 所说的......如果您需要使用 .find()，您可能可以使用 $(document) 而不是 $(this)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T10:00:10.623

activa 的回答是正确的。`$("<selector>")`相当于您在第一次搜索时尝试执行的操作。`find("<selector>")`用于在包装集中进行搜索，而不是作为起点。

但是，我要补充一点，在这种情况下检索值的更好方法是：

```
var value = $("input.feedback-selected").val(); 
```

这是因为包含元素的类型将允许 jQuery 以更快的方式搜索 DOM。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T10:00:53.323

find() 搜索您调用它的 jQuery 对象的后代元素。你在 $(this) 的结果上调用 find()，这没什么。如果要在文档上调用 find()，则必须使用 $(document)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T10:02:34.380

`this`在您的示例中，它不是包含“feedback-selected”类的任何子元素的 DOM 元素，因此 find 函数找不到它们。它甚至可能不是 DOM 元素。

我会注意到 $(this) 在 this 指向 DOM 元素的任何地方都可以有效。因此，如果几乎任何时候您都在触发从 DOM 元素调用的函数，那么您就可以了。在这种情况下，一切都与范围有关。这也是有效的：

```
function aha() {
 alert($(this).find('.feedback-selected').val());
}

aha.apply(document); 
```

# python - 使用 Python 和 YouTubeAPI 提取 YouTube 视频的作者

> ID：938742
> 
> 赞同：5
> 
> 时间：2009-06-02T09:54:32.663
> 
> 标签：python, youtube, youtube-api

如何使用以下方法从对象中获取作者/用户名：

```
GetYouTubeVideoEntry(video_id=youtube_video_id_to_output) 
```

我正在使用 Google 的 gdata.youtube.service Python 库

提前致谢！:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T04:40:34.520

所以因为 YouTube 的 API 是基于 GData 的，它是基于 Atom 的，所以 'author' 对象是一个带有名称对象的数组，可以包含名称、URL 等。

这就是你想要的：

```
>>> client = gdata.youtube.service.YouTubeService()
>>> video = client.GetYouTubeVideoEntry(video_id='CoYBkXD0QeU')
>>> video.author[0].name.text
'GoogleDevelopers' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T10:04:13.970

你有没有尝试过这样的事情？

```
foo = GetYouTubeVideoEntry(video_id=youtube_video_id_to_output)
foo.author 
```

[YouTubeVideoEntry](http://gdata-python-client.googlecode.com/svn/trunk/pydocs/gdata.youtube.html#YouTubeVideoEntry)的文档不是很好，但该`__init__`方法似乎接受了作者。

# html - 将html页面加载到flex textarea

> ID：938743
> 
> 赞同：2
> 
> 时间：2009-06-02T09:54:45.720
> 
> 标签：html, apache-flex, url

您好，我想在 flex 的 textarea 框中显示来自网站的一些文本内容。

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
 import mx.managers.PopUpManager;
        import mx.core.Application;
        import flash.net.URLLoader;
        import mx.rpc.events.ResultEvent;
        import mx.controls.Text;
        import mx.controls.Alert; 

        [Bindable]
        private var xmlText:String;

        private function serviceResult(event:ResultEvent):void 
        {
        myTextArea.text = event.result.contents.content;
        }

        private function init():void{
        listContents.send();
        }
    ]]> 
</mx:Script>

<mx:HTTPService id="listContents" url="http://theurl.com" result="serviceResult(event)"/>

<mx:TextArea id="myTextArea" text="{xmlText}" /> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T10:06:00.893

我已经完成了这样的 b4 但使用 URLLoader 和 URLRequest 使用 flash CS3 所以在 flex 中尝试使用这个概念是相同的想法

```
public function sendSQLQuery(aspURL:String, variables:URLVariables, returnSQLXMLCallback:Function):void
        {
           var myXMLURL:URLRequest = new URLRequest(aspURL);          
           myXMLURL.data = variables;          
           myXMLURL.method = URLRequestMethod.POST;        
           var myLoader:URLLoader = new URLLoader();           
           //Define the event handlers to listen for success and failure
           myLoader.addEventListener ( IOErrorEvent.IO_ERROR, handleIOError );
           myLoader.addEventListener ( HTTPStatusEvent.HTTP_STATUS, handleHttpStatus );
           myLoader.addEventListener ( SecurityErrorEvent.SECURITY_ERROR, handleSecurityError );
           myLoader.dataFormat = URLLoaderDataFormat.TEXT;
           myLoader.addEventListener("complete", returnSQLXMLCallback);         
           myLoader.load(myXMLURL);
        } 
```

我以 XML 格式接收返回的页面，然后对其进行解析

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-07T04:19:21.923

一种速记方式：

```
<mx:TextArea htmlText="{xmlText}" />    
<mx:String id="xmlText" source="data.xml" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T14:06:09.210

尝试使用 TextArea 控件的 .htmlText 属性。请参阅此处，来自 Flex 文档：

[http://www.adobe.com/livedocs/flex/3/langref/mx/controls/TextArea.html#htmlText](http://www.adobe.com/livedocs/flex/3/langref/mx/controls/TextArea.html#htmlText)

这应该可行，但请记住，Flex 控件的 HTML 呈现功能仍然很初级；你不会在样式或格式方面得到太多东西（因此 StackOverflow 上关于这个主题的问题数量很多），但基础知识应该对你有用。

# sharepoint - 数字字段上的 Eq 的 SPSiteDataQuery 问题

> ID：938745
> 
> 赞同：0
> 
> 时间：2009-06-02T09:55:19.980
> 
> 标签：sharepoint, moss, spsitedataquery

好的，所以我不想做的是执行一个 SPSiteDataQuery，它提供了我所有的 SPListItems，这些 SPListItems 具有某种内容类型，并带有 2008 年的字段。

```
<Where>
      <And>
        <BeginsWith>
          <FieldRef Name="ContentTypeId" />
          <Value Type="Text">0x0101010053B766E295F2456DA0470906DC0E36F9</Value>
        </BeginsWith>
        <Eq>
          <FieldRef Name="Year" />
          <Value Type="Number">2008</Value>
        </Eq>
      </And>
    </Where> 
```

我正在设置我的 SPSiteDataQuery，就像上面的一个查询一样。当我删除 Eq 部分时，我得到 10 个命中（这是正确的），但这总是出现 0（应该是 5）。是不是查询有问题。Year 是一个数字字段，但我也尝试过使用 Text（带有 contains 子句）以及 Int 和 Integer。

有任何想法吗？

**编辑：** 我的错，字段 Year 没有值（我的代码中有错误）。它确实有效

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T10:57:27.343

我的错，字段 Year 没有值（我的代码中的错误）。它确实有效

# mysql - 数据库问题：将简单的关系表更改为非关系表？

> ID：938751
> 
> 赞同：1
> 
> 时间：2009-06-02T09:58:56.413
> 
> 标签：mysql, database, database-design, rdbms, non-relational-database

我有一个在 MySQL 数据库上运行的 Web 应用程序（正在开发中）。我正在考虑将我的应用程序迁移到 Google App Engine，并希望更好地了解如何将我的简单关系数据库模型转换为非关系方法。

我是一个长期的关系数据库人员，我没有使用 BigTable 等基于列的数据库的经验。万一谷歌也支持关系数据库的小型部署，我想说明我的问题是一般性的，而不是谷歌特有的——我想了解如何在非关系数据库中表示简单的关系模型。

我的数据库（简化）如下：

```
Items Table
------------

ItemID  ItemName  ItemPriority
1       "Car"     7
2       "Table"   2
3       "Desk"    7

ItemProperties Table
---------------------

ItemID  Property        Importance 
1       "Blue"          1
1       "Four Wheels"   2
1       "Sedan"         0
2       "Rectangular"   1
2       "One Leg"       1 
```

我有很多项目，每个项目都有一个名称和 ID。每一项都有多个属性，每个属性都有几个参数（我只说了每个属性的名称和“重要性”，但还有更多）。我有数千万个项目，每个项目都有数百个属性。

使用场景：我收到一个 ItemName 作为输入，在 items 表中查找它的 ID，并通过该 id 获取所有属性。然后我对属性列表（在内存中）进行一些分析，并返回一个结果。

90% 的工作是基于参数的查找，这（如果我理解正确的话）是非关系数据库的痛点。

推荐的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T04:10:19.657

从已经使用非关系数据库一段时间的人那里，您的两个表应该很容易转换为非关系数据库。

拿两张桌子，把它们变成一个物体。

项目： - ID - 名称 - 属性 - prop1 - prop2

将整个内容存储在您的数据存储列（Big-Table）、文档（CouchDB）或它使用的任何其他内容中。

您可以通过任何 ID、名称或属性来查找项目。没有连接是非关系数据库的最大痛点之一。除非我不理解您的意思，否则参数查找并不是真正的痛点。您可能需要进行多次查找，但大多数时候这不是问题，而且它的扩展性比 rdbms 更好。

在您的示例中，我实际上认为非关系模型更简单，更易于实现和理解。

每个非关系数据存储都有不同的约定和约束，因此很难给出一般意义上的指导。例如，CouchDB 可以使用它的视图在对象的任何部分上创建索引。使用 BigTable，您可能必须存储非规范化数据的多个副本才能获得快速索引查找。当您决定如何存储数据时，其他人会考虑不同的事情。一旦你离开 SQL 世界，就会有很多差异化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T11:34:30.810

GQL 不支持连接。您可以通过两种方式解决此问题：

*   自己加入

只需获取项目，检查其 ItemID，并使用该 ItemID 查询 ItemProperties。您的表格看起来与您指定的完全相同。当然，这是两个查询，但是这两个查询很简单。

*   使用 Expando 模型

在 Expando 模型中，您可以在运行时创建新字段。它们不会被索引，因此如果您想搜索它们可能会更慢，但只需获取它们就可以了。您也可以使用复杂类型，例如 ListProperty。有了这种灵活性，您也许可以想办法将 ItemProperties 表中的所有内容都放入 Items 表中，并为自己节省一个查询。要有创意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T03:01:37.207

我有一个非常相似的数据库结构（我们的“records”和“recordEntries”表反映了您的“items”和“itemProperties”）并且正在考虑向非关系数据库进行类似的迁移。我们可能会去 CouchDB 或 memcachedb 或类似的东西，而不是谷歌。

像您一样，我没有使用非关系数据库的经验（我的开发人员也没有）。但是，我们已经提出了一些想法。我们目前的想法是（使用您的架构）：

*   第一：将每个项目及其项目属性折叠成一个带有字段的对象（本质上是一个 XML 文档），并将其填充到由标识符键入的数据库中。每次您检索一个项目时，您也会返回所有 itemProperties。

请注意，我们的不同之处在于我们在数据库之外（使用 Solr）索引我们的内容，因此不需要使用“名称”属性对数据库本身进行查找，因此 YMMV。

*   第二：我们正在列出我们正在做的所有“关系”操作，这些操作不能被上面的模型支持。这包括几个“分组”操作，我们根据项目表中的特殊字段查询项目，以及我们尝试检测最近修改的所有项目的查询（之前通过查询项目表）。我们正在为每种情况发明替代实现（幸运的是，只有少数）。

如果这被证明太难了，我们将尝试使用另一个模型进行相同的练习。幸运的是，我们有时间计划。

对我们来说，一个关键点是我们在外部使用 Solr 进行所有索引，因此（例如）我们不需要对 itemProperties 值中的值进行数据库查找，或者在 item 表上按名称进行查找。

无论如何，这可能没什么帮助，但我很想看看更有经验的人能想出什么样的解决方案。

PS：我推断您的属性表必须有数十亿行。到底有多少，你在什么硬件上运行 MySQL 服务器？您是否还在使用 MySQL 时遇到可扩展性问题？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-05T22:04:06.273

你需要把它全部展平，我认为 AppEngine 允许像这样的结构

ID=1, ItemName=汽车, ItemPriority=7, Property=(蓝色,1),Property=(四轮,2),Property=(轿车,0) ID=2, ItemName=Table, ItemPriority=2, Property= (矩形,1),Property=(一条腿,1) ID=3, ItemName=Desk, ItemPriority=7

Notice that the same "field" could have multiple values, and that you could use multiple items in it.

Your sample data would be 3 rows in one table.

# swing - 斯卡拉弹出菜单

> ID：938753
> 
> 赞同：3
> 
> 时间：2009-06-02T09:59:10.283
> 
> 标签：swing, scala, popup

如何在 Scala 中显示弹出窗口？我有一个“后门”，但对我来说似乎很难看：

```
val item = new MenuItem(new Action("Say Hello") {
  def apply = println("Hello World");
})
//SO FAR SO GOOD, NOW FOR THE UGLY BIT!
val popup = new javax.swing.JPopupMenu
popup.add(item.peer)
popup.setVisible(true) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-06-22T12:45:34.713

我知道这个问题已经存在两年了，但我认为值得用另一个答案来更新。这是我的解决方案：

```
import javax.swing.JPopupMenu
import scala.swing.{ Component, MenuItem }
import scala.swing.SequentialContainer.Wrapper

object PopupMenu {
  private[PopupMenu] trait JPopupMenuMixin { def popupMenuWrapper: PopupMenu }
}

class PopupMenu extends Component with Wrapper {

  override lazy val peer: JPopupMenu = new JPopupMenu with PopupMenu.JPopupMenuMixin with SuperMixin {
    def popupMenuWrapper = PopupMenu.this
  }

  def show(invoker: Component, x: Int, y: Int): Unit = peer.show(invoker.peer, x, y)

  /* Create any other peer methods here */
} 
```

这是一些示例使用代码：

```
val popupMenu = new PopupMenu {
  contents += new Menu("menu 1") {
    contents += new RadioMenuItem("radio 1.1")
    contents += new RadioMenuItem("radio 1.2")
  }
  contents += new Menu("menu 2") {
    contents += new RadioMenuItem("radio 2.1")
    contents += new RadioMenuItem("radio 2.2")
  }
}
val button = new Button("Show Popup Menu")
reactions += {
  case e: ButtonClicked => popupMenu.show(button, 0, button.bounds.height)
}
listenTo(button) 
```

需要注意的一些事项：

1.  [使用scala-swing-design.pdf](http://www.scala-lang.org/sid/8)中推荐的 SuperMixin 类，在“编写包装器的指南”部分的“使用包装器缓存”小节中。
2.  混合 scala.swing.SequentialContainer.Wrapper 以便我可以使用该`contents +=`构造，因此我的 Popup Menu 代码看起来像其他 scala-swing Menu 构造代码。
3.  当问题使用`JPopupMenu.setVisible`时，我想你会想要包装和使用方法`JPopupMenu.show`，这样你就可以控制弹出菜单的位置。（只需将其设置为可见，我就可以将其放在屏幕的左上角。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T16:26:59.883

What you are doing is fine, but if you'd like to hide the peer call you could create your own class:

```
class PopupMenu extends Component
{
  override lazy val peer : JPopupMenu = new JPopupMenu

  def add(item:MenuItem) : Unit = { peer.add(item.peer) }
  def setVisible(visible:Boolean) : Unit = { peer.setVisible(visible) }
  /* Create any other peer methods here */
} 
```

Then you can use it like this:

```
val item = new MenuItem(new Action("Say Hello") {
  def apply = println("Hello World");
})

val popup = new PopupMenu
popup.add(item)
popup.setVisible(true) 
```

As an alternative, you could try SQUIB (Scala's Quirky User Interface Builder). With SQUIB, the above code becomes:

```
popup(
  contents(
    menuitem(
      'text -> "Say Hello",
      actionPerformed(
        println("Hello World!")
      )
    )
  )
).setVisible(true) 
```

# select - 在 COBOL 中读取 STDIN (SYSIN)

> ID：938760
> 
> 赞同：9
> 
> 时间：2009-06-02T10:01:05.613
> 
> 标签：select, stdin, cobol, sysin

我想从 COBOL 中的 STDIN（又名 SYSIN）中读取行。现在我只想把它们打印出来，这样我就知道我有它们了。从我正在阅读的所有内容来看，这应该可以工作：

```
IDENTIFICATION DIVISION.
PROGRAM-ID. APP.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.

    SELECT SYSIN ASSIGN TO DA-S-SYSIN ORGANIZATION LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.

FD SYSIN.
01 ln PIC X(255).
    88 EOF VALUE HIGH-VALUES.
WORKING-STORAGE SECTION.

PROCEDURE DIVISION.
    OPEN INPUT SYSIN
    READ SYSIN
      AT END SET EOF TO TRUE
    END-READ
    PERFORM UNTIL EOF
        DISPLAY ln
        READ SYSIN
            AT END SET EOF TO TRUE
        END-READ
    END-PERFORM
    CLOSE SYSIN
    STOP RUN. 
```

编译（使用 open-cobol 和 cobc -x），但运行它我得到：

```
libcob: File does not exist (STATUS = 35) File : '' 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T23:44:05.650

以下是在[OpenCOBOL 论坛](http://www.opencobol.org/modules/newbb/viewtopic.php?viewmode=thread&topic_id=610&forum=1&post_id=3111#3111)上向我提出的建议。

```
SELECT SYSIN ASSIGN TO KEYBOARD ORGANIZATION LINE SEQUENTIAL. 
```

让它起作用的是关键字 KEYBOARD。

显然 DISPLAY 是 STDOUT 的类似词，但我没有测试过。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T11:39:38.147

我的 COBOL 可以追溯到运行 GCOS-6 的 DPS-6 小型计算机，我在 1992 年最后一次接触到它。但那时我们使用 ACCEPT 从标准输入获取输入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-12T11:19:19.780

您可以只使用 ACCEPT 关键字来获取键盘输出。循环直到你点击诸如“end”之类的关键字，或者你可以使用 EOF 的十六进制值（我相信是 1A）。

如：

```
1000-YOUR-PARAGRAPH.
  ACCEPT WS-YOUR-VARIABLE.
  DISPLAY WS-YOUR-VARIABLE.
  IF WS-YOUR-VARIABLE IS NOT EQUAL TO EOF
    THEN GO TO 1000-YOUR-PARAGRAPH
  ELSE GO TO 1090-EXIT
  END-IF.
1090-EXIT.
  EXIT. 
```

这将使一切都达到 EOL 标记（例如退货）。

# iphone - iPhone 上的 YAJL

> ID：938763
> 
> 赞同：2
> 
> 时间：2009-06-02T10:01:39.577
> 
> 标签：iphone, objective-c, cocoa-touch

有没有人让 YAJL Json 解析框架与 iPhone 一起工作？如果你有，你可以发布关于如何链接到它的简单说明。

我想将它与 MGTwitterEngine 框架一起使用。

目前我收到这些错误..

“yajl_get_error”引用自

..和一些非常相似的人。

YAJL [http://lloyd.github.com/yajl/](http://lloyd.github.com/yajl/)

MGTwitterEngine [http://mattgemmell.com/2008/02/22/mgtwitterengine-twitter-from-cocoa](http://mattgemmell.com/2008/02/22/mgtwitterengine-twitter-from-cocoa)

谢谢，

担

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T07:12:24.293

yajl 的objective-c 绑定应该可以在iPhone 上运行。[http://github.com/gabriel/yajl-objc/tree/master](http://github.com/gabriel/yajl-objc/tree/master)

我建立了一个静态库，似乎工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T18:35:01.783

我不知道它是否适用于 MGTwitterEngine，但是；试试我已经成功使用的 iPhone 的 json-framework：

[http://code.google.com/p/json-framework/](http://code.google.com/p/json-framework/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-20T14:21:50.683

我知道这个问题是 OOOLD，但我刚刚从[MGTwitterEngine](https://github.com/mattgemmell/MGTwitterEngine/wiki/Building-and-testing-MGTwitterEngine)创建者本人那里找到了有关如何成功构建和使用 MGTwitterEngine 的说明。

我希望这会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-28T04:00:43.217

[Three20 支持 YAJL。](https://github.com/facebook/three20/tree/master/src/extThree20JSON/)它似乎没有使用 yajl-objc。

# asp.net-mvc - 在没有 RedirectToAction() 的 SignOut() 之后清除 Request.IsAuthenticated 值

> ID：938764
> 
> 赞同：0
> 
> 时间：2009-06-02T10:01:45.317
> 
> 标签：asp.net-mvc, authentication, logout

我正在编写一个帐户管理控制器，并且必须单独处理删除自己用户的帐户：

```
[Authorize]
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Delete(string userName, string confirmButton)
{
    MembershipService.DeleteUser(userName);

    if (User.Identity.Name.Equals(userName,
        StringComparison.InvariantCultureIgnoreCase))
    {
        FormsAuth.SignOut();

        return View("DeleteSelf");
    }
    else
        return RedirectToAction("Index");
} 
```

但是部分视图 LogOnUserControl.ascx 在显示 DeleteSelf 视图时仍然显示刚刚注销的用户名，因为 Request.IsAuthenticated 和 Page.User.Identity 值仍然在 FormsAuth.SignOut() 之后设置。

添加一个新动作 ShowDeleteSelfMessage 可以解决问题，但我不喜欢这个解决方案：

```
 ...
    {
        FormsAuth.SignOut();

        return RedirectToAction("ShowDeleteSelfMessage");
    }
    ...

public ActionResult ShowDeleteSelfMessage()
{
    return View("DeleteSelf");
} 
```

还有其他想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T19:24:55.053

更改您的 LogOnUserControl.ascx 以处理 ViewData["UserDeleted"]：

```
[Authorize]
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Delete(string userName, string confirmButton)
{
    MembershipService.DeleteUser(userName);

    if (User.Identity.Name.Equals(userName,
        StringComparison.InvariantCultureIgnoreCase))
    {
        FormsAuth.SignOut();

        // ***
        ViewData["UserDeleted"] = true;
        // ***

        return View("DeleteSelf");
    }
    else
        return RedirectToAction("Index");
} 
```

LogOnUserControl.ascx：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl" %>
<% if (Request.IsAuthenticated && !(ViewData["UserDeleted"] ?? false)) { %>
    Welcome <b><%= Html.Encode(Page.User.Identity.Name) %></b>!
    [ <%= Html.ActionLink("Log Off", "LogOff", "Account") %> ]
<% } else { %> 
    [ <%= Html.ActionLink("Log On", "LogOn", "Account") %> ]
<% } %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T10:12:16.433

在`Delete`行动中，而不是`return View("DeleteSelf")`，试试这个`return Redirect("DeleteSelf")`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T11:09:03.637

我检查了标准 AccountController.cs 文件的源代码，发现了两种方法

```
public ActionResult ChangePasswordSuccess()
{
    return View("ChangePasswordSuccess");
} 
```

和

```
public ActionResult RestorePasswordSuccess()
{
    return View("RestorePasswordSuccess");
} 
```

仅显示相应的视图。所以我的

```
public ActionResult ShowDeleteSelfMessage()
{
    return View("DeleteSelf");
} 
```

在这样的公司，方法看起来不错。虽然我应该更改名称以保持一致性。

# c# - System.Net.CredentialCache.DefaultCredentials 中的密码是如何加密的？

> ID：938765
> 
> 赞同：1
> 
> 时间：2009-06-02T10:01:47.347
> 
> 标签：c#, encryption, credentials, kerberos, ntlm

如果我使用 system.net.credentialcache.defaultcredentials 将当前用户凭据传递给 Web 服务，信息将以哪种方式传输？我认为它不会是明文，因此必须对凭据进行加密，但是它们如何呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T10:13:07.323

这取决于服务器在 HEAD 响应中请求的内容。

例如，如果我对您的 Web 服务执行 HEAD 请求，并且其响应中的 http 标头之一是“WWW-Authenticate: NTLM”，则存储在 DefaultCredentials 中的凭据将使用 NTLM 加密，然后与完整的 GET 一起发送/POST/PUT/随便。为确保发生这种情况，您需要确保将 Web 服务器配置为请求 NTLM 身份验证。在 IIS 中，这是选择“集成 windows 身份验证”的情况。我不确定 TomCat，但[这篇文章](http://www.theresearchkitchen.com/blog/archives/39)看起来很中肯。

但是，如果您的 Web 服务器对特定资源回复“WWW-Authenticate: Basic”（这将涉及以明文发送凭据，编码（注意：*未*加密）为 base64），您将收到一个 ArgumentException，因为它被认为是通过基本身份验证发送您的帐户凭据的安全例外。

Web 服务器也可以配置为接受多种身份验证方法，但您应该始终准备好接受其中最弱的一种，因此提供基本身份验证作为“后备”意味着您的一些用户很可能会发送他们的凭据明文。

浏览器通常会选择可用的最强方法，我怀疑（但不确定）.net 库的行为方式相同。

**编辑**

只要您的 Web 服务器*只*为您的 Web 服务请求 NTLM，您就可以确定任何明智的客户端都不会以明文形式发送凭据。使用 .net 框架中的网络类，您可以确保如果您使用 DefaultCredentials，并且不自己手动注入基本身份验证标头，您的凭据将使用 NTLM 加密发送。

他们的凭据将作为一个大的加密混乱到达服务器，除了网络服务器之外的任何人，谁将解密它们以查看它们包括当前登录用户的用户名、密码和域。

DefaultCredentials 将发送的凭据取决于请求 DefaultCredentails 的应用程序类型。如果它是在用户帐户下运行的客户端应用程序，则凭据将是该用户的。如果它是与您的 Web 服务通信的 ASP.NET 应用程序，它将使用运行应用程序池的帐户的凭据，默认情况下，这是`NETWORK_SERVICE`.

# objective-c - Uncrustify 可以在 Objective-C 方法调用中对齐冒号吗？

> ID：938775
> 
> 赞同：15
> 
> 时间：2009-06-02T10:04:36.903
> 
> 标签：objective-c, uncrustify

我正在使用[uncrustify](http://uncrustify.sourceforge.net/) 0.52。当我针对 Objective-C 文件运行它时，它希望像这样转换方法调用：

```
[NSApp beginSheet:startTimerDialog
   modalForWindow:nil
    modalDelegate:nil
   didEndSelector:nil
      contextInfo:nil]; 
```

对此：

```
[NSApp beginSheet:startTimerDialog
 modalForWindow:nil
 modalDelegate:nil
 didEndSelector:nil
 contextInfo:nil]; 
```

我更喜欢第一个版本，冒号对齐。uncrustify 配置文件中是否有一个选项可以支持我想要的，或者 uncrustify 只是不支持对齐的冒号？

如果 uncrustify 不能对齐冒号，有没有办法防止它不对齐我自己对齐的冒号？

**更新：**

[mmc](https://stackoverflow.com/users/85344/mmc)指出，从 build 1581 开始，Uncrustify svn 存储库中提供了此功能。它在 uncrustify 0.54 中。在您的配置文件中设置`align_oc_msg_colon = true`以启用它。

**进一步更新**

对于将来找到此答案的人： .cfg 文件中的首选项名称已更改。现在是`align_oc_msg_colon_span= 1`得到上述行为。现在还有一个`align_oc_decl_colon = true`可以为多行声明做名称的事情。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-23T15:30:34.267

昨晚我玩了一段时间，并且（尽管我认为这不值得赏金）你两个问题的答案都是“不，Uncrustify 的当前版本（.53）不这样做。”

我什至研究了编写一个补丁来做到这一点（因为我也真的想要它）并且在查看了 Uncrustify 源代码之后，并得出结论，这将花费比我能够弄清楚在哪里插入补丁来完成的时间更多的时间“多行消息参数冒号对齐”而不是“多行消息左对齐” 在最近的补丁中，Objective-C 解析似乎确实有了一些改进。

我非常希望有人能回答这个问题。我也很想知道。

**注意：**对于将来找到此答案的人： .cfg 文件中的首选项名称已更改。现在是 align_oc_msg_colon_span = 1 来获得上述行为。现在还有一个 align_oc_decl_colon 将为多行声明执行名称操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T03:48:05.757

你试过了吗：

```
align_var_def_colon=true 
```

# java - 哪种方法在性能方面更好？（关于JDBC中prepared statement中可变参数标记的使用）

> ID：938776
> 
> 赞同：1
> 
> 时间：2009-06-02T10:05:03.547
> 
> 标签：java, performance, jdbc, prepared-statement

我的目标是从 Emp 表中获取某些员工的 DeptNames。但员工人数参差不齐。请判断以下方法是否正确，以及以下哪种方法性能更好。还是有更好的方法来解决它？

```
PreparedStatement pstmt = conn.prepareStatement("SELECT Dept from Emp WHERE EmpNum = ? ");
    for (int i = 0, len = empNumberList.size(); i < len; i++) {
      pstmt.setLong (1, empNumberList.get(i));
      ResultSet rs = pstmt.executeQuery();
    } 
```

**或者**

```
StringBuffer buffer = new StringBuffer();
buffer.append("SELECT Dept from Emp WHERE EmpNum IN(?");
for (int i = 0, len = empNumberList.size(); i < len; i++) {
  buffer.append(",?");
}
buffer.append(")");
PreparedStatement pstmt = con.prepareStatement(buffer.toString());
for(int i = 0; i < len; i++) {
pstmt .setLong(i, empNumberList.get(i));
}
ResultSet rs = pstmt .executeQuery(); 
```

或者有没有其他更好的方法来做到这一点？请指教。提前致谢！

拉维拉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T10:12:04.143

一般来说，执行一个查询胜过执行多个查询，因为服务器往返被视为大多数（琐碎）查询的重要成本。

话虽如此，数据库供应商、JDBC 或驱动程序可能会限制您可以通过这种方式传递的参数数量，因此您必须对此保持警惕。

就像另一张海报说的那样：无需在客户端进行过滤。只需在这种情况下使用 DISTINCT。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T10:10:07.063

我会说

"SELECT DISTINCT Dept FROM Emp WHERE EmpNum IN (" + queries + ")"

那么执行 setLong()s 将是最好的方法，并且可能是最好的性能，但要确保性能的唯一方法是对其进行分析。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T10:13:20.113

可能是第二种选择，因为通常数据库查询需要更多时间。

此外，您的代码中有一个错误：

```
StringBuffer buffer = new StringBuffer();
buffer.append("SELECT Dept from Emp WHERE EmpNum IN(?");
for (int i = 1, len = empNumberList.size(); i < len; i++) { // one ? was written
  buffer.append(",?");
}
buffer.append(")");
PreparedStatement pstmt = con.prepareStatement(buffer.toString());
for(int i = 0; i < len; i++) {
pstmt .setLong(i+1, empNumberList.get(i)); // pstmt setXXX() are 1 based
}
ResultSet rs = pstmt .executeQuery(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T10:28:17.697

我同意第二个可能会更快的估计。

但是，如果您真的想知道：基准测试。性能结果通常不直观，并且会因平台、数据库、架构和版本而异。因此，请自己尝试并衡量差异。

# c++ - 如何从我的应用程序无缝地使用 ISA 代理进行身份验证？

> ID：938780
> 
> 赞同：0
> 
> 时间：2009-06-02T10:08:43.260
> 
> 标签：c++, qt, proxy

我正在尝试让我们 Qt 访问网站并下载更新，问题是一个安装基础正在使用需要身份验证的 Microsoft ISA 代理服务器。

Qt 给了我一个提供用户名和密码的功能：http: [//doc.qt.io/archives/4.6/qnetworkaccessmanager.html#proxyAuthenticationRequired](http://doc.qt.io/archives/4.6/qnetworkaccessmanager.html#proxyAuthenticationRequired)

然而，其他应用程序在不询问用户详细信息的情况下执行此操作。我如何实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T08:48:35.287

您正在运行什么类型的代理？看

[http://doc.qt.io/archives/4.6/qnetworkproxy.html](http://doc.qt.io/archives/4.6/qnetworkproxy.html)

找到 Qt 支持的代理。

# .net - 从 LINQ 迁移到 SQL 时要注意的事项 --> LINQ to Entities

> ID：938783
> 
> 赞同：3
> 
> 时间：2009-06-02T10:09:10.513
> 
> 标签：.net, linq-to-sql, linq-to-entities

我最近在许多项目中成功使用了 LINQ to SQL，但我热衷于迁移到 LINQ to Entities，因为随着微软迁移到 .NET 4.0 及更高版本，这看起来将获得更多来自 Microsoft 的投资。

在这样做之前，我很想知道 LINQ to SQL 有哪些东西是 LINQ to Entities 所缺少的。我的初步调查揭示了一些小烦恼。

*   LINQ to Entities 不支持`Single()`或`SingleOrDefault()`
*   LINQ to Entities 不允许您在 VS2008 IDE 中检查生成的 SQL 以查找未执行的查询

有谁知道任何其他这样的差异？

请注意，我并不是在寻找 LINQ to SQL 和 LINQ to Entities 的主要功能的并排比较。我希望了解人们遇到的更细微的差异。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T13:02:06.857

使用 EF，如果将查询强制转换为 ObjectQuery，然后检查 ToTraceString 函数，您可以获得将生成的 SQL。当然，这并不像 LINQ to SQL 的实现那么简单。此外，EF 没有像 LINQ to SQL 中的 Context.Log 这样的良好日志记录拦截选项。

我将在下周从 VS Live 开始就 LINQ to SQL -> EF 迁移进行一些演示，并将很快在 Thinqlinq.com 上开始一个关于它的博客系列。

吉姆

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T10:18:07.907

*   第一/取/等；在 EF 中，它需要 (IIRC) 一个命令；LINQ-to-SQL 将接受这些用于无序查询
*   子表达式评估；如果您使用 滚动自定义`Expression`（例如谓词）`Expression.Invoke`，它将不起作用；EF 不支持子表达式使用（LINQ-to-SQL 支持）
*   序列化；非常非常不同
*   关联加载；需要在 EF 中显式加载
*   UDF 支持（可在数据库中组合）

# java - 良好的客户端套接字池

> ID：938784
> 
> 赞同：8
> 
> 时间：2009-06-02T10:09:23.320
> 
> 标签：java, sockets, pool

我需要管理从我的 Java 应用程序到外部服务器的长时间运行的 TCP 套接字连接。我正在寻找一个好的套接字池，这样我就可以重新使用套接字。有什么建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T10:23:48.347

[您可以看看在Commons Pool](http://commons.apache.org/pool/index.html)之上构建一个套接字池。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T10:46:13.120

Koders.com 在[这里](http://www.koders.com/java/fidC48F31080E7917460C81CF6DF7424660DB666249.aspx?s=socket#L7)有一个实现。但是，我不能保证它的功能，所以你应该对其进行一些测试。

# wpf - 使用 Onyx 的 MVVM 中父/子视图模型关系的最佳实践？

> ID：938787
> 
> 赞同：0
> 
> 时间：2009-06-02T10:11:07.687
> 
> 标签：wpf, mvvm, parent-child, viewmodel

嘿伙计们！

我目前正在通过 Onyx 框架使用 MVVM 开发一个小型 WPF 项目。

我当前的视图架构是这样的：

```
<DockPanel>
    <Menu DockPanel.Dock="Top" Background="#cecece">
        <!-- Menu -->
    </Menu>

    <Grid>
        <views:TranslationView x:Name="translationView" />
    </Grid>
</DockPanel> 
```

我现在的问题是如何实现两个视图模型之间的关系。我目前基本上只有 TranslationView 有自己的 ViewModel，没有到父 ViewModel 的链接。

问题是我希望能够通过 MainView 打开一些文件，然后解析内容并将它们显示在 TranslationView 中。有推荐的方法吗？

我考虑过只使用 TranslationViewModel 作为 MainViewModel 中的属性，然后将其用作 TranslationView 的 DataContext，但它似乎有点违反 Onyx 的模型以通过类型（而不是对象）引用来定义 ViewModel。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-06-15T17:44:34.027

Onyx 没有“通过类型（而非对象）引用定义 ViewModel 的模型”。可以为 ViewModel 附加属性分配对象引用。实际上，这个属性是一个Object类型，通过强制转换将一个Type实例变为指定Type的对象实例。这只是一种方便。您可以随意分配以您想要的任何方式创建的对象引用。

像大多数问题一样，有多种方法可以解决您的问题。您提到但因为您认为它与 Onyx 的设计背道而驰而被解雇的解决方案是可行的，但我会犹豫使用，只是因为它会产生更紧密的耦合。另一种解决方案是利用事件聚合器模式以断开连接的方式在视图之间进行通信。或者，您可以使用更加面向服务的方法。例如，我通常定义一个 IApplication 服务，它位于您通常在紧密耦合设计中访问 Application.Current 的位置。您可以在此服务上提供一个属性来保存已加载文件的内容，并在服务上公开 INotifyPropertyChanged 以允许 TranslationViewModel 知道该属性已更改。

# iphone - AudioQueueEnqueueBuffer 错误代码

> ID：938792
> 
> 赞同：2
> 
> 时间：2009-06-02T10:12:17.527
> 
> 标签：iphone, audio-streaming

我在我的应用程序中使用音频队列服务，它播放通过网络传输的音频。有时，当我调用 AudioQueueEnqueueBuffer 并且该函数返回 OSStatus 代码 -50 时会出错。音频队列服务参考未指定此错误代码。我正在使用 iPhone OS 2.0 和 iphone SDK 3.0 谁能告诉我这段代码 -50 的含义是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-17T08:38:37.623

It's an Invalid parameter Error.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-27T14:02:20.937

你的音频队列真的在运行吗？因为如果不是——如果有什么东西阻止了它——那么-50就是我所期望的。

# delphi - Vista 应用程序缩略图

> ID：938793
> 
> 赞同：5
> 
> 时间：2009-06-02T10:12:40.863
> 
> 标签：delphi, windows-vista, toolbar, dwm

根据设计，当应用程序最小化时，Vista 上的工具栏应用程序缩略图不会更新，因为最小化的窗口本身不会重绘。对于我拥有的监控应用程序，在应用程序保持最小化的同时更新应用程序缩略图会很有用。我正在使用 Delphi 2009。任何人都可以为此提出一个好的解决方法吗？

血红蛋白

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T11:27:11.150

这是一个有趣的问题，我想在某种程度上使用 Windows API 是可能的，我目前不在 vista 机器上，但我认为 Windows Media Player 在最小化时仍会显示视频播放。

我想一个技巧是覆盖最小化按钮并将表单移出屏幕，然后检测表单再次变为活动状态并将其移回旧位置。这意味着表格不在视野范围内，但没有最小化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T19:38:06.993

我[在 Microsoft 开发论坛](http://social.msdn.microsoft.com/Forums/en-US/windowsuidevelopment/thread/9a7a7d61-359c-4971-834e-00391ae2fbb3)中找到了一些解决此主题的内容。问题是关于提供自定义缩略图的方法，微软的[Leonardo Blanco](http://social.msdn.microsoft.com/Forums/en-US/user?user=Leonardo%20Blanco%20-%20MSFT)对此做出了回应：

> 我们不[t] 计划为应用程序提供一种方法来创建自定义替代缩略图表示，但我们将提供一个 API 来完全退出正常的缩略图图像......

[`DwmSetIconicLivePreviewBitmap`](http://msdn.microsoft.com/en-us/library/dd389410.aspx)从 MSDN 中的功能和Windows 7的存在来看，这些计划看起来可能在此期间发生了变化[`DwmSetIconicThumbnail`](http://msdn.microsoft.com/en-us/library/dd389411.aspx)。目前这些条目并没有真正包含任何解释，但它们的名称看起来很有希望。

有人指出，即使窗口最小化，Windows Media Player 的缩略图也会显示移动视频。布兰科的解释：

> WMP 使用直接与 [桌面窗口管理器] 对话的新视频管道，以实现更流畅的播放体验。此管道依赖于 [DirectX] 并且不依赖于窗口可见性信息，因此即使窗口最小化，缩略图也可以保持活动状态，只要应用程序继续提交帧。但是，您可能会注意到，视频周围的 UI 不再存在（这很难观察，因为视频周围的 UI 通常不会更新）。有关此方法的更多信息，请参阅[`DwmSetPresentParameters`](http://msdn.microsoft.com/en-us/library/aa969523.aspx)API。

恐怕我找不到更多关于这方面的信息了。DWM 函数的文档很少。

鉴于您的应用程序的性质，也许值得考虑将[*小工具*](http://msdn.microsoft.com/en-us/library/aa965850.aspx)放在 Windows 边栏上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T14:49:44.033

我不知道[这种解决方法](http://yoy.be/item.asp?i89)是否在 Delphi 2009 中仍然有效：覆盖 CreateParams 以将 GetDesktopWindow 设置为 WndParent。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T12:57:24.293

我过去更改了 Application.Title 以在任务栏按钮中显示一些信息。我不认为这会导致图标重绘？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-26T10:05:27.320

go to your source project and change Application.MainFormOnTaskbar to false: Application.MainFormOnTaskbar := false;

Regards, Mauricio

[http://sourceforge.net/projects/tcycomponents/](http://sourceforge.net/projects/tcycomponents/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T17:39:28.927

在 Delphi 2007 中，您的主窗体位于任务栏上，如果您设置

```
 Application.MainFormOnTaskbar := True; 
```

为了保持更新，您需要防止您的应用程序最小化，而是将其移到后面。您可以通过在表单上放置一个**TApplicationEvents并为****OnMinimize**事件分配一个事件处理程序，然后在其中调用**Application.Restore**来做到这一点。您将需要跟踪自己的最小化状态，并确保隐藏所有其他表单（如果有的话）并且只让您的主表单可见，但在“最小化”时处于最低 Z 顺序。

我不认为 Windows Vista 允许您将表单移出屏幕，或者您可以这样做。也许有一个hack。

祝你好运！

# vba - 从文本文件中读取行但跳过前两行

> ID：938796
> 
> 赞同：15
> 
> 时间：2009-06-02T10:13:07.917
> 
> 标签：vba, excel, ms-word, text-files

我在 Microsoft Office Word 2003 中有这个宏代码，它读取文本文件的行。每行代表一个字符串值，稍后我需要在代码中使用它。

但是，文本文件的前两行包含一些我不需要的内容。如何修改代码以跳过前两行？Word 中 VBA 编辑器中的“智能感知”很糟糕。

无论如何，代码看起来像这样

```
Dim sFileName As String
Dim iFileNum As Integer
Dim sBuf As String
Dim Fields as String

sFileName = "c:\fields.ini"
''//Does the file exist?
If Len(Dir$(sFileName)) = 0 Then
    MsgBox ("Cannot find fields.ini")
End If

iFileNum = FreeFile()
Open sFileName For Input As iFileNum
Do While Not EOF(iFileNum)
    Line Input #iFileNum, Fields

    MsgBox (Fields) 
```

这段代码目前给了我所有的行，我不想要前两行。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-06-02T11:24:18.770

整个`Open <file path> For Input As <some number>`事情都是*1990*年代。它也很慢而且很容易出错。

在您的 VBA 编辑器中，从“工具”菜单中选择“引用”并查找“Microsoft Scripting Runtime”（scrrun.dll），它应该在几乎任何 XP 或 Vista 机器上都可用。它在那里，选择它。现在您可以使用（至少对我而言）更强大的解决方案：

```
With New Scripting.FileSystemObject
    With .OpenTextFile(sFilename, ForReading)

        If Not .AtEndOfStream Then .SkipLine
        If Not .AtEndOfStream Then .SkipLine

        Do Until .AtEndOfStream
            DoSomethingImportantTo .ReadLine
        Loop

    End With
End With 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-02T11:10:52.447

You can use random access.

```
Open "C:\docs\TESTFILE.txt" For Random As #1 

    Position = 3    ' Define record number.
    Get #1, Position, ARecord    ' Read record.

Close #1 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T10:47:14.163

```
Open sFileName For Input As iFileNum

Dim LineNum As Long
LineNum = 0

Do While Not EOF(iFileNum)
  LineNum = LineNum + 1
  Line Input #iFileNum, Fields
  If LineNum > 2 Then
    DoStuffWith(Fields)
  End If
Loop 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T10:36:56.183

可能是我过于简单化了？

只需添加以下代码：

```
Open sFileName For Input as iFileNum
Line Input #iFileNum, dummy1
Line Input #iFileNum, dummy2
........ 
```

桑达尔

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-11T17:31:14.537

```
Dim sFileName As String
Dim iFileNum As Integer
Dim sBuf As String
Dim Fields as String
Dim TempStr as String

sFileName = "c:\fields.ini"
''//Does the file exist?
If Len(Dir$(sFileName)) = 0 Then
    MsgBox ("Cannot find fields.ini")
End If

iFileNum = FreeFile()
Open sFileName For Input As iFileNum

''//This part skips the first two lines
if not(EOF(iFileNum)) Then Line Input #iFilenum, TempStr
if not(EOF(iFileNum)) Then Line Input #iFilenum, TempStr

Do While Not EOF(iFileNum)
    Line Input #iFileNum, Fields

    MsgBox (Fields)
Loop 
```

# c# - 将 TransactionScope 与 MySQL 和读锁一起使用

> ID：938801
> 
> 赞同：1
> 
> 时间：2009-06-02T10:13:48.617
> 
> 标签：c#, mysql, subsonic, transactions, transactionscope

我有以下情况：

如果有一个带有 InnoDB 表的 MySQL 数据库，我用它来存储唯一的数字。我开始一个事务，读取值（例如 1000471），将该值存储在另一个表中并更新增量值（100472）。现在我想避免其他人甚至在我的事务运行时读取该值。

如果我使用普通的 MySQL，我会做这样的事情：

执行（“锁定 tbl1 读取”）；
执行（“从 tbl1 中选择 ...”）；
执行（“插入到 tbl2”）；
执行（“解锁表”）；

但由于我使用 SubSonic 作为 DAL 并且代码应该独立于 mysql，所以我必须使用 TransactionScope。

我的代码：

```
 TransactionOptions TransOpt = new TransactionOptions();
        TransOpt.IsolationLevel = System.Transactions.IsolationLevel.ReadCommitted;
        TransOpt.Timeout = new TimeSpan(0, 2, 0);

        using (TransactionScope ts = new TransactionScope(TransactionScopeOption.RequiresNew, TransOpt))
        {

             // Select Row from tbl1

             // Do something

             ts.Complete();
        } 
```

根据 TransactionOptions 的帮助

[system.transactions.isolationlevel](http://msdn.microsoft.com/en-us/library/system.transactions.isolationlevel(VS.85).aspx)

我想要达到的效果可以用 IsolationLevel.ReadCommitted 来实现，但是我仍然可以从事务外部读取行（如果我尝试更改它，我会得到一个锁，所以事务正在工作）

有人有建议吗？TransactionScope 甚至可以实现读锁吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T09:05:09.467

如果有人感兴趣，这就是 TransactionOptions 影响 MySql 的方式：

可以说我有两种方法。

Method1 启动一个事务，从我的表中选择一行，增加值并更新表。

Method2是一样的，但是在select和update之间我加了一个1000ms的sleep。

现在想象我有以下代码：

```
 Private Sub Button1_Click(sender as Object, e as System.EventArgs) Handles Button1.Click

        Dim thread1 As New Threading.Thread(AddressOf Method1)
        Dim thread2 As New Threading.Thread(AddressOf Method2)

        thread2.Start() // I start thread 2 first, because this one sleeps
        thread1.Start()

    End Sub 
```

如果没有事务，就会发生这种情况：
thread2 启动，读取值 5，然后休眠，
thread1 启动，读取值 5，将值更新为 6，
thread2 也将值更新为 6。

效果：我有两次唯一号码。

我想要什么：
thread2 启动，读取值 5，然后休眠，
thread1 启动，尝试读取值，但获得锁并休眠，
thread2 将值更新为 6，
thread1 继续，读取值 6，将值更新为7

这就是如何使用 TransactionScope 开始事务：

```
 TransactionOptions Opts = new TransactionOptions();
        Opts.IsolationLevel = IsolationLevel.ReadUncommitted;

        // start Transaction
        using (TransactionScope ts = new TransactionScope(TransactionScopeOption.RequiresNew, Opts))
        {
            // Do your work and call complete
            ts.Complete();
        } 
```

这甚至可以管理分布式事务。如果抛出异常，则永远不会调用 ts.Complete 并且 Scope 的 Dispose() 部分会回滚事务。

以下是不同 IsolationLevels 如何影响事务的概述：

*   **IsolationLevel.Chaos**
    引发 NotSupportedException - 不支持混沌隔离级别

*   **IsolationLevel.ReadCommited**
    事务不相互干扰（两个相同的读取，不好）

*   **IsolationLevel.ReadUncommitted**
    事务不相互干扰（两个相同的读取，不好）

*   **IsolationLevel.RepeatableRead**
    事务不相互干扰（两个相同的读取，不好）

*   **IsolationLevel.Serializable**
    抛出 MySqlException - 尝试获取锁时发现死锁；尝试在更新期间重新启动事务

*   **IsolationLevel.Snapshot**
    引发 MySqlException - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在 Connection.Open() 期间在第 1 行的 '' 附近使用正确的语法

*   **IsolationLevel.Unspecified**
    引发 MySqlException - 尝试获取锁时发现死锁；尝试在更新期间重新启动事务

*   **未设置 TransactionOptions**
    引发 MySqlException - 尝试获取锁时发现死锁；尝试在更新期间重新启动事务

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T11:20:15.533

My first guess was to use `SELECT FOR UPDATE` and after a quick search I found a page about [locking reads](http://dev.mysql.com/doc/refman/5.0/en/innodb-locking-reads.html) in the MySQL 5 reference.

If I understand correctly this is independent from the isolation level used. And take care - the isolation level just tells how the current transaction is affected by changes in other transactions. It does not tell what other transactions can do. However, more restricting locks are required for higher isolation levels.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T13:27:21.907

由于我没有找到一种方法来锁定一行以使用 InnoDB 和 TransactionScope 读取（我可能错了），这应该可以：

如果我同时运行两个事务（没有 TransactionOptions）并且一个完成，另一个由于“死锁”异常而无法完成。

[根据 MySQL文档](http://dev.mysql.com/doc/refman/5.0/en/innodb-deadlocks.html)，最好的做法似乎不是避免这种异常，而是期望出现死锁并重新启动事务。

如果你设置：

```
 TransactionOptions TransOpt = new TransactionOptions();
    TransOpt.IsolationLevel = System.Transactions.IsolationLevel.ReadCommitted; 
```

对于您的交易，您不会遇到死锁异常，但是在我的情况下，这会导致重复的唯一编号，这会更糟。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T06:51:07.367

由于 SubSonic 似乎不支持`SELECT ... FOR UPDATE`并且使用隔离级别在我看来是一种滥用 - 如果有一个[用户定义的函数](http://dev.mysql.com/doc/refman/5.1/en/create-procedure.html)会返回一个新的 id 呢？该函数将使用 a 从 tbl1 读取当前值`SELECT ... FOR UPDATE`，更新该行并返回该值。

在您插入新值的应用程序代码中，您只需使用：

```
insert into tbl2 (id, ....) values (next_id(), ...) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T07:27:56.747

好的，我决定使用“后门”，现在使用内联查询：

```
 // start transaction
        using (TransactionScope ts = new TransactionScope(TransactionScopeOption.RequiresNew))
        {
            using (SharedDbConnectionScope scope = new SharedDbConnectionScope(DB._provider))
            {

                try
                {

                    Record r = new InlineQuery().ExecuteAsCollection<RecordCollection>(
                        String.Format("SELECT * FROM {0} WHERE {1} = ?param FOR UPDATE",
                                        Record.Schema.TableName,
                                        Record.Columns.Column1), "VALUE")[0];

                    // do something

                    r.Save();
                 }
             }
         } 
```

我同时启动了 10 个线程，它按预期工作。感谢 rudolfson 提供“SELECT FOR UPDATE”提示。

# mysql - 定期备份 MySQL 数据库

> ID：938805
> 
> 赞同：8
> 
> 时间：2009-06-02T10:17:01.603
> 
> 标签：mysql, backup

我需要知道如何定期备份我的 MySQL 数据库并将备份下载到我的本地服务器。我正在使用navicat，它有一个简单的备份界面和任务计划工具，但它备份数据库并将备份存储在服务器本身上。我希望有一种方法可以将备份下载到我的本地系统，而不是将它们与数据库放在同一台服务器上。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-02T10:48:31.323

设置一个服务器 cron，它在一段时间后运行 mysqldump 命令（例如 24 小时）

```
mysqldump -hMY_HOST.COM -uDB_USERNAME -pDB_PASSWORD USERNAME_DATABASENAME > MysqlDump.sql 
```

创建转储文件后。设置另一个 cron 以将此转储复制到目标服务器（最好是本地），使其以与上述 cron 相同的间隔执行。

```
scp user@MY_HOST.COM:/some/path/file user2@MY_HOST2.COM:/some/path/file 
```

**注意：此命令可能会导致服务器负载高（确保在服务器负载最小时执行它们）**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T13:22:12.603

除了 mysqldump，还有一些其他的备份选项。这些主要是为了解决 mysqldump 导致高负载/长重新加载时间的问题。

1.  有[InnoDB 热备份](http://www.innodb.com/products/hot-backup/order/)，它是 InnoDB 制造商的付费产品，可以在线备份。备份 InnoDB 表也比备份 MyISAM 更难，因为使用后者，如果表被刷新，您可以只复制文件，但前者有问题。
    *   如果您的备份可以对您的硬盘进行即时快照，则[FLUSH TABLES WITH READ LOCK](http://dev.mysql.com/doc/refman/5.0/en/flush.html)会将您的写入刷新到磁盘，以便您的备份处于一致状态。但是，这将阻止所有读取，直到您完成，所以如果它们不是即时的，那就不好了。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-12-07T22:09:13.603

你应该试试 mydumper - [https://answers.launchpad.net/mydumper/+faq/338](https://answers.launchpad.net/mydumper/+faq/338)

它有一个守护模式，可以为你定期备份，由一些优秀的 MySQL 工程师开发。我相信它被称为 mysqldump，就像 dba 想象的那样；)

# matlab - MatLab递归错误（初学者）

> ID：938806
> 
> 赞同：1
> 
> 时间：2009-06-02T10:18:07.563
> 
> 标签：matlab, recursion, function-handle

好的。所以我在 MatLab 中有两个互相调用的函数。

黎曼

```
function I = Riemann(f, dx, a, b)
   x = a:dx:b;
   fx = f(x).*dx;
   I = sum(fx); 
```

和 myfunc.m

```
function f = myfunc(x)
   f = sin(1./x);
   for n=1:100
        I = Riemann(@myfunc, 0.001, 1/n, 1);
   end
   plot(I) 
```

问题是让它运行。我如何调用 myfunc 以从中获取任何信息。我尝试过的一切都以无穷无尽的递归调用堆栈结束（这是有道理的）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T10:30:07.943

您的问题在于函数的定义：为了能够使用递归定义，您**必须**能够在没有另一个函数的情况下计算两个函数中的至少一个，至少对于某些值。您还**必须**确保每次计算最终都依赖于您无需递归即可获得的这些结果。

对于您的具体问题，我感觉您想要集成函数 f(x)=sin(1./x)。如果是这样，您的第二个函数的代码应为：

```
function f = myfunc(x)
   fct = @(x) sin(1./x);
   f = fct(x);
   for n=1:100
        I = Riemann(fct, 0.001, 1/n, 1);
   end
   plot(I) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T10:27:47.853

当 myFunc 停止调用 Riemann 时，您需要输入 x 的最终条件。将实际函数（在本例中为 sin）发送给 Riemann 比调用 myFunc 更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T10:30:00.987

函数 myfunc 没有`f = sin(1./x);`在它应该结束的地方结束。在那里终止函数并从其他地方调用绘图代码（单独的文件）。

来自手册：您可以使用 end 语句终止任何函数，但在大多数情况下，这是可选的。只有在使用一个或多个嵌套函数的 M 文件中才需要 end 语句。在这样的 M 文件中，每个函数（包括主函数、嵌套函数、私有函数和子函数）都必须以 end 语句终止。您可以使用 end 终止任何函数类型，但除非 M 文件包含嵌套函数，否则不需要这样做。

# makefile - nmake Makefile 将目标文件放在单独的目录中

> ID：938808
> 
> 赞同：6
> 
> 时间：2009-06-02T10:18:09.700
> 
> 标签：makefile, nmake

我的所有源文件都在 Source 文件夹中，makefile 在 Makefile 文件夹中，我希望所有对象文件都放在 Objects 文件夹中。这是我正在开发的 C 项目。所有这三个文件夹都位于名为 Project 的文件夹中。

项目文件夹包含： Source Makefile Objects

我试图找出一种方法来让makefile从Source文件夹编译源代码，我尝试过使用：

```
...
SOURCE_DIR=..\Source
OUTPUT_DIR=..\Objects
.c.obj:
    $(CC) $(SOURCE_DIR)\$*.c /Fo$(OUTPUT_DIR)\$*.obj
... 
```

但这不起作用，我最终收到一条错误消息，同时说不知道如何制作 myfile.obj

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-01-06T00:30:49.670

尝试这个：

```
SOURCE_DIR=..\Source
OUTPUT_DIR=..\Objects
{$(SOURCE_DIR)}.c{$(OUTPUT_DIR)}.obj:
    $(CC) $* /Fo$< 
```

如此处所述：http: [//msdn.microsoft.com/en-us/library/hk9ztb8x.aspx](http://msdn.microsoft.com/en-us/library/hk9ztb8x.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-08T20:59:00.810

您应该添加目标，将当前目录更改为要制作目标文件的目录。下面是 nmake 示例 Makefile 文件。在示例中，nmake 从当前目录编译 ac bc 并放置 objs $(OBJ_FILES_DIR) 目录并在 $(OUTDIR) 目录中构建 SOME_STATIC.LIB。

```
# commmand to launch Makefile
nmake OBJ_FILES_DIR=my_obj_dir OUTDIR=my_lib_dir

# Makefile
STATICLIB = SOME_STATIC.LIB
OBJS = a.obj b.obj # objs in lib
O = $(OBJ_FILES_DIR)
S = $(MAKEDIR)  # remember source dir where a.c b.c reside and current    dir from which nmake launched.

.PHONY: $(STATICLIB)
.PHONY: CHDIR

$(STATICLIB): CHDIR $(OUTDIR)$(STATICLIB) # 

CHDIR:
    -md $(O) 
    cd $(O)

all: $(STATICLIB) 

$(OUTDIR)$(STATICLIB): $(OBJS)
    $(AR) $(ARFLAGS) -out:$@ $(OBJS)

{$(S)}.c.obj::
    $(CC) $(WFLAGS) $(CFLAGS) -c $< 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-07T00:38:45.227

如果字面意思是`don't know how to make myfile.obj`，而不是，`don't know how to make ..\Objects\myfile.obj`那么您的问题出在其他地方-makefile 中的某些内容要求当前目录中的目标文件。

需要 myfile.obj 构建的规则是什么？我猜想在该规则中您没有指定`$(OUTPUT_DIR)\myfile.obj`为依赖项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T02:53:59.910

如果您使用的是 Visual Studio，有时您会收到错误消息：

“不知道如何制作'.obj'”

我可以通过打开“Makefile”并取消注释“在 Visual Studio 2010 中编译以输出 32 位二进制文​​件时取消注释这些”的注释下方的行来解决此问题。找到与您的 Visual Studio 版本和体系结构（32 位/64 位）相对应的注释，然后取消注释下面的行！

# javascript - 如何验证鼠标悬停在一个元素上？

> ID：938810
> 
> 赞同：0
> 
> 时间：2009-06-02T10:20:20.240
> 
> 标签：javascript, jquery

你知道如何检查鼠标是否在一个元素上吗？

像这样的东西？

```
setTimeout(function() {
    if($(this).mouseover()) {  // this not work
        return false;   
    } else {
        $(this).hide();
    }
}, 1000); 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T10:24:53.163

你可以使用这样的东西：

```
var isMouseOver = false;

$(myitem).hover(function() {isMouseOver = true;}, 
                function() {isMouseOver = false;}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T10:25:19.077

我假设您在“this”代表单个元素的闭包中操作：

```
var mouseovered = false,
    myElem = this;

$(myElem)
    .mouseover(function(){
        mouseovered = true;
    })
    .mouseout(function(){
        mouseovered = false;
    });

setTimeout(function() {
   if(mouseovered) {  
        return false;   
    } else {
        $(myElem).hide();
    }
}, 1000); 
```

* * *

请注意，我使用的是“myElem”而不是“this”关键字，在 setTimeout 回调的上下文中，它是对 Window 对象的引用——显然不是你想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T10:23:15.523

使用相关元素上的 onmouseover 事件调用函数以隐藏相关元素（因为这似乎是您想要做的）。

# php - 通过 php 中的 post 接收 xml 文件

> ID：938811
> 
> 赞同：13
> 
> 时间：2009-06-02T10:20:29.850
> 
> 标签：php, xml, http, post

我正在寻找一个可以通过 POST 接受 XML 文件，然后发送响应的 PHP 脚本。

有没有人有任何代码可以做到这一点？

到目前为止，我唯一的代码就是这个，但不确定响应，或者我是否确实朝着正确的方向前进，因为 XML 字符没有正确保存。有任何想法吗？

```
<?php

if ( $_SERVER['REQUEST_METHOD'] === 'POST' ){ 
    $postText = file_get_contents('php://input'); 
}

$datetime=date('ymdHis'); 
$xmlfile = "myfile" . $datetime . ".xml"; 
$FileHandle = fopen($xmlfile, 'w') or die("can't open file"); 
fwrite($FileHandle, $postText); 
fclose($FileHandle);

?> 
```

我的文件都是空的......内容没有被写入它们。它们正在被创建。

```
//source html
<form action="quicktest.php" method="post" mimetype="text/xml" enctype="text/xml" name="form1">
<input type="file" name="xmlfile">
<br>

<input type="submit" name="Submit" value="Submit">

</form>

//destination php

$file = $_POST['FILES']['xmlfile'];

$fileContents= file_get_contents($file['tmp_name']);

$datetime=date('ymdHis'); 
$xmlfile="myfile" . $datetime . ".xml"; 
$FileHandle=fopen($xmlfile, 'w') or die("can't open file"); 

fwrite($FileHandle, $postText); 
fclose($FileHandle); 
```

* * *

我不是在谈论上传文件。有人想通过 HTTP 连接定期发送 XML 文件。

我只需要在我的服务器上运行一个脚本来接受他们在我的 URL 上发布的帖子，然后将文件保存到我的服务器上并向他们发送回复说确认或接受。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T14:02:48.153

您的方法很好，从外观上看，这是正确的方法，并附有一些注意事项：

*   如果你有 PHP5，你可以使用`file_put_contents`as 的逆运算`file_get_contents`，避免整个`fopen/fwrite/fclose`. 然而：
*   如果您将接受的 XML POST 正文可能很大，那么您现在的代码可能会遇到问题。它首先将整个主体加载到内存中，然后将其写成一个大块。这对于小型帖子来说很好，但如果文件大小趋向于兆字节，最好完全使用`fopen/fread/fwrite/fclose`，因此您的内存使用量永远不会超过例如 8KB：

    ```
    $inp = fopen("php://input");
    $outp = fopen("xmlfile" . date("YmdHis") . ".xml", "w");

    while (!feof($inp)) {
        $buffer = fread($inp, 8192);
        fwrite($outp, $buffer);
    }

    fclose($inp);
    fclose($outp); 
    ```

*   当文件的发布频率超过每秒 1 个时（例如，当它们从多个来源发布时），您的文件名生成方法可能会遇到名称冲突。但我怀疑这只是示例代码，您已经意识到这一点。

# c# - Visual Studio 2005 中不存在 C# 项目类型

> ID：938814
> 
> 赞同：0
> 
> 时间：2009-06-02T10:22:39.003
> 
> 标签：c#, templates, visual-studio-2005

一段时间以来，我一直在 VB.NET 中使用 Visual Studio 2005 进行编码。没问题。

最近，我决定要开始一个新的 C# 项目。在尝试这样做时，我注意到 Visual Studio 2005 完全缺少此功能！

这正是我在屏幕上看到的：

[![替代文字](https://i.stack.imgur.com/1GAS6.png)](https://i.stack.imgur.com/1GAS6.png)
[（来源：[googlepages.com](http://jongallant.googlepages.com/Untitled-1.png)）]

另请注意，我在同一台机器上安装了 Visual Studio 2003 和 2005。Visual Studio 2003 具有可用的 C# 模板。

知道我可以做些什么来解决这个问题，而无需重新安装？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T10:26:32.880

我认为您在安装期间没有包含 C#？重新启动安装并添加 C#。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T10:25:56.407

这似乎是一个愚蠢的问题，但是您是否曾经使用该版本创建过 C# 项目？换句话说，您是否安装了 C# 个性？因为，您知道，C# 不是 Visual Studio 的基础；）

您无需重新安装。如果您确定应该安装 C#，请尝试修复。如果之前没有安装，可以修改安装。比完全重新安装花费的时间要少得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T10:29:22.377

安装 VS 时不必安装 C#。

另外，您是在运行 VS 或 express 的填充版本，express 版本仅包含一种技术。

从屏幕截图中，我会说您正在运行完整版本，因为 Express 具有针对 Web 内容的特定安装。

重新安装 VS 并将 C# 添加到要安装的内容列表中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T10:41:47.530

看看那里。我希望对你有所帮助。

[http://social.msdn.microsoft.com/forums/en-US/csharpide/thread/4b09ba47-18d2-49a0-8cb7-7020706e034a/](http://social.msdn.microsoft.com/forums/en-US/csharpide/thread/4b09ba47-18d2-49a0-8cb7-7020706e034a/)

# apache-flex - 构建时找不到 FlashDevelop 应用程序

> ID：938823
> 
> 赞同：1
> 
> 时间：2009-06-02T10:25:24.303
> 
> 标签：apache-flex, flash, actionscript-3, flashdevelop

如何配置我的项目以在调试 Flash 播放器中打开生成的 swf 文件？当我点击 f5 FlashDevelop 告诉我以下内容

初始化：Adobe Flex Compiler SHell (fcsh) 开始新的编译。加载配置文件 D:\Programmierung\Flex\flex_sdk_3\frameworks\flex-config.xml 加载配置文件 D:\Programmierung\Flex\FlashDevelop_workspace\Test\obj\TestConfig.xml obj\Test633795421567473000 (1009 bytes) (fcsh) 构建成功完成 (0) [使用 FDB 捕获痕迹] Anwendung nicht gefunden（未找到应用程序）

我希望你们中的一些人可以帮助我

亲切的问候

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T11:05:54.157

下载[Flash Player 10 投影仪内容调试器](http://download.macromedia.com/pub/flashplayer/updaters/10/flashplayer_10_sa_debug.exe)。运行一次。在“项目”>“属性...”中的 FlashDevelop 中，将“测试影片”更改为“在外部播放器中播放”。按 F5。

# c# - 你最喜欢的 VS 2008 快捷键是什么？

> ID：938826
> 
> 赞同：1
> 
> 时间：2009-06-02T10:26:45.470
> 
> 标签：c#, .net, visual-studio-2008

> **可能的重复：**
> [Visual Studio 6 提示和技巧](https://stackoverflow.com/questions/147339/visual-studio-6-tips-and-tricks)
> [Visual Studio 2005 Shortcuts](https://stackoverflow.com/questions/26452/visual-studio-2005-shortcuts)
> [最喜欢的 Visual Studio 键盘快捷键](https://stackoverflow.com/questions/98606/favorite-visual-studio-keyboard-shortcuts)

我是 VS2008 快捷键的忠实拥护者，它可以节省大量时间，并且可以将手指放在键盘上而不是鼠标上。

最近，我下载了 VS 2008 的整个[键盘快捷键](http://swami-k.blogspot.com/2009/01/visual-studio-2008-keyboard-shortcut.html)列表，并通过它们找到了我最喜欢的。

目前这里是我使用的顶级：

1.  Shift + DEL：删除整行
2.  Ctrl + Shift + F10：调出使用/分辨率框
3.  cw[tabx2]：插入 Console.Writeline 代码
4.  ctor[tabx2]：插入默认构造函数代码

人们还知道哪些其他可以节省时间/实际上有用的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T10:51:46.870

`F12`跳转到定义

`SHIFT`+`F12`查找所有参考资料

`CTRL`+`MINUS` 跳回上一个光标位置

`CTRL`+ `SHIFT`+`MINUS`向前跳转到最后一个光标位置

`CTRL`+ `K`,`C`注释掉当前选中的代码

`CTRL`+ `K`,`U`取消注释当前选中的代码

`CTRL`+ `K`,`F`格式化选中的代码

`CTRL`+ `K`,`D`格式化文档

`F5` 开始调试

`F6` 构建解决方案

`F7`切换到代码视图

`Shift`+`F7`切换到设计视图

这些是我用得最多的。

PS。微软发布了 Visual Studio 的键绑定海报。

*   VS C# 2005 键盘快捷键[参考海报](http://www.microsoft.com/downloads/details.aspx?familyid=C15D210D-A926-46A8-A586-31F8A2E576FE&displaylang=en)

*   VS C# 2008 键盘快捷键[参考海报](http://www.microsoft.com/downloads/details.aspx?familyid=E5F902A8-5BB5-4CC6-907E-472809749973&displaylang=en)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T10:28:56.980

增量搜索 - `Ctrl`+`I`

搜索您的代码，就像在 Firefox/IE8 中一样。但是不适用于区域。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T10:30:28.240

Ctrl+。：在文本编辑器中打开当前智能标签。当您使用智能标签时，这可以节省大量时间。

顺便说一句，选项卡选项卡的东西是代码片段而不是快捷方式。不过，这个问题不应该有所作为。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T10:44:35.713

`Ctrl`+ `M`+ `O`: 折叠所有区域和方法

`Ctrl`+ `M`+ `M`: 切换当前区域或方法的大纲

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T10:30:17.350

我的大部分“快捷方式”来自 ReSharper 和 ViEmu，因此 R# 的 Alt+Enter 和各种 Vim 功能在我的列表中名列前茅。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T10:31:02.497

```
F5, F5, F5 and F5 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T10:36:43.453

Shift + F11 -> 设置下一个执行语句[调试时]

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-02T10:37:17.133

`Shift`+ `Alt`+ `F10`> 包括命名空间

`Ctrl`+ `R`+ `E`> 重构，封装字段

`Shift`+ `F6`> 构建当前项目

`Ctrl`+ `Alt`+ `Q`> 调试器中的快速观看

`Ctrl`+`+`和`Ctrl`+ `-`> 在代码中前后导航

`F2`> 重构、重命名 > 我最喜欢的一个

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-02T10:40:43.040

Shift + F5：停止调试

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-02T10:45:34.887

我使用 Resharper，它提供了具有不同快捷方式的主要重构和搜索功能。

# rowlex - 循环枚举类值的问题

> ID：938828
> 
> 赞同：0
> 
> 时间：2009-06-02T10:27:18.480
> 
> 标签：rowlex

我正在开发一个语义 Web 应用程序，其中使用了本体的组装。我使用 Rowlex OWLGrinder 将 OWL 转换为程序集。

在本体中有一些具有个体的类，它们是转换的 tp Enum 类，其中包含 .dll 程序集中的一些常量。例如，一个名为 Language 的 OWL 类和一个名为 English 的个体将被转换为一个名为 Language 的类，其中包含 English 常量。Language.English 是一个字符串，包含为本体中的个体指定的 URI。

[替代文字 http://img5.imageshack.us/img5/9308/73263054.jpg](http://img5.imageshack.us/img5/9308/73263054.jpg) [替代文字 http://img5.imageshack.us/img5/2246/11461238.jpg](http://img5.imageshack.us/img5/2246/11461238.jpg)

在这种情况下，我找不到在枚举类常量之间循环的方法。例如使用这样的东西：

```
 foreach (string item in Enum.GetNames(typeof(Language)))
    {

    } 
```

此代码引发异常，指出 Language 不是 Enum。

我想知道是否有人会帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T10:32:07.253

正如错误所说，它不是真正的枚举。

听起来你需要反思：

```
var fields = typeof(Language).GetFields(BindingFlags.Static 
                                        | BindingFlags.Public);
foreach (string item in fields.Select(field => field.GetValue(null)))
{
     // ...
} 
```

这是假设类型中没有其他公共静态字段。您总是可以按类型等进行过滤。

# javascript - Firefox Web 开发人员工具栏：“动态”HTML 编辑后 JS 不起作用

> ID：938835
> 
> 赞同：1
> 
> 时间：2009-06-02T10:29:11.423
> 
> 标签：javascript, firefox, firefox-addon, web-developer-toolbar

我已经习惯了这个工具栏，动态编辑页面并查看我正在更改的内容真是太酷了……

唯一的问题是我的 JavaScript 在我编辑之后（或同时）停止工作，我需要保存刷新页面......我错过了任何选项吗？有没有其他工具可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T10:33:46.640

[萤火虫。](http://getfirebug.com/)我几乎不再使用 Web Developer。（虽然调整大小功能很好）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T10:34:29.277

除非您保存并刷新，否则您将无法看到更改。所以保存和刷新对我来说似乎没问题。你能告诉我们发生了什么的例子吗？

# c# - 与 .NET 兼容的非托管本机 C 代码

> ID：938859
> 
> 赞同：0
> 
> 时间：2009-06-02T10:38:15.213
> 
> 标签：c#

dll 的整个代码都是使用本机 C 编写的，下面有一个函数供您参考。

DllImport int32 FAR PASCAL swe_calc(double tjd, int ipl, int32 iflag, double *xx, char *serr);

大多数函数都是使用 FAR PASCAL 编写的，当我尝试将此 dll 转换为与 .net 兼容时，我遇到了错误。

我尝试将 Comman Runtime Support 属性从“No Common Runtime Support”更改为 Common Runtime Support（即 \clr）。并更改了 \MD 。

当我尝试从命令提示符处使用 Regsvr32 注册 dll 时，我收到错误消息，指出“找不到入口点 DllRegisterServer 加载了模块“mydll.dll””。

我喜欢在我的 C# 应用程序中使用这个 dll，如果有人能帮我解决这个问题，那就太好了。

提前致谢。

甘

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T11:21:44.470

You don't need to change compilation settings for the dll (common runtime support) - this is for mixed mode assemblies written in c++/cli. You may use this, but there is option to use the dll without making any modifications to it and that's the common scenario. Big parts of .NET framework do exactly this - using native win32 dlls.

You also do not need regsvr32 and don't have to make the dll "compatible" with .NET, it already is. Calling native functions from .NET is supported out of the box and is very common. Just make sure the dll file can be found from the .net application - place in the same directory or in the path.

Declare the functions in c# with DllImport using the .dll name and use them.

Consider x64 issues if have to support it - you may need x64 version of the dll. Make sure .NET code loads the correct dll according to the architecture.

The other direction "calling .NET code from the C .dll" may be more complicated, but it also supported.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T10:43:15.997

[这个网站](http://www.pinvoke.net/)会很有帮助（[http://www.pinvoke.net/](http://www.pinvoke.net/)）。Regsvr32 适用于 COM 对象，而 DLL 似乎不是一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T13:02:34.907

通过将函数签名输入谷歌代码搜索，大约需要 30 秒才能找到源代码和文档。您应该能够使用 Interop 来处理它。

sweph.zip 中似乎包含一个 VB.Net 解决方案 - 它可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T11:47:54.317

感谢大家，

在您的帮助下，我终于解决了这个问题，我使用的是 64 位 Vista，所以我收到了类似 system.dllnotfoundException 的错误。

当我将平台从“任何 CPU”更改为“X86”并编译它工作的应用程序时，我将 dll 放在“C:\Windows\SysWOW64\”中。

我使用了 DllImport 函数，它起作用了。

谢谢各位热心帮忙

甘

# php - 回显一行输出或关闭 php 标签和写出 html 代码之间有什么区别吗？

> ID：938862
> 
> 赞同：3
> 
> 时间：2009-06-02T10:38:54.633
> 
> 标签：php, html

我几乎可以肯定这个问题的答案是“根本没有！” 但无论如何我都会问。如果您在 PHP 中有一条回显一行 html 的条件语句，那么这两个示例之间在性能方面是否存在差异：

```
<?php if ($output) { ?>
  <h2><?=$output;?></h2>
<?php } ?> 
```

和

```
<?php if ($output) { echo "<h2>".$output."</h2>"; } ?> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T11:00:50.737

我认为没有明显的性能差异。我使用任何使我的代码更具可读性的变体。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-02T11:34:25.177

从字面上看，答案是“根本没有”。考虑

```
<span>
<?php
  echo $myMessage;
?>
</span> 
```

和

```
<?php
  echo "<span>\n";
  echo $myMessage;
  echo "</span>";
?> 
```

我从记忆中（几年前）开始，但那时 Zend 字节码编译器产生基本相同的输出；“literal” HTML 被编译成包含文本的 echo 语句。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-02T10:58:54.873

标签无效，除非您启用了 short_open_tags ，`<?= ?>`否则不建议这样做。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-02T11:20:24.037

If you are really into micro optimization, you should start with changing

```
echo "<h2>".$output."</h2>"; 
```

into:

```
echo '<h2>', $output, '</h2>'; 
```

(no variable expansion and no string concatenation)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-02T10:48:18.390

为什么这么多 PHP 开发人员试图优化这些东西？这与关于单引号和双引号字符串的辩论相同。如果这些性能差异在*任何*方面都很重要，那么您真的应该使用另一种语言。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-02T10:43:41.957

这叫做微优化，不能依赖这样的性能差异

但这在几纳秒内的性能更好

```
<?php if ($output) { ?>
  <h2><?=$output;?></h2>
<?php } ?> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-02T10:44:51.160

性能可以忽略不计，在实践中不值得担心。第一个选项将是首选方法，因为它更具可读性并使用 php，因为它本来是要使用的（模板）。

但从理论上讲，我猜第一种方法会更快，因为该语言需要解析的内容更少。直接返回 html 文本而不进行处理。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-02T20:34:13.487

我必须知道，所以在 10000 次迭代的循环中运行了几个不同的块。经验教训：不要打扰。编写可读和可维护的代码。使用 MVC 模式... :)

**时间**：2.66 微秒

```
<? if ($output) { ?>
    <h2><?=$output;?></h2>
<? } ?> 
```

**时间**：1.65 微秒

```
<? if ($output) { echo "<h2>$output</h2>"; } ?> 
```

**时间**：1.65 微秒

```
<? if ($output) { echo "<h2>".$output."</h2>"; } ?> 
```

**时间**：1.64 微秒

```
<? if ($output) { echo '<h2>'.$output.'</h2>'; } ?> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-02T10:55:35.647

我更喜欢选项 1，因为它在大多数情况下更容易编辑 HTML - 特别是在处理具有内部内容的 div 时。

在这两种情况下，性能都可以忽略不计。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-03T07:55:18.810

为什么不直接测试一下？通过嗅探或查看您喜欢的浏览器中页面的来源。

# visual-studio-2008 - VS 2008 中的解决方案级别构建事件

> ID：938864
> 
> 赞同：3
> 
> 时间：2009-06-02T10:39:23.430
> 
> 标签：visual-studio-2008, msbuild

我知道您可以在项目级别进行构建前和构建后事件，但我想在解决方案构建的开始和结束时停止并启动服务——即，当我执行“构建解决方案”时，服务会停止构建的最后一个动作是重新启动服务。

解决方案属性页上没有构建事件，我该怎么办？

我猜我可以将任务添加到 msbuild 文件中，但恐怕我根本不了解 VS 和 msbuild 之间的关系。VS 是否使用 SLN 文件执行 msbuild？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T10:46:42.137

我为自己的项目编写了一个宏，因为我需要这个确切的功能：

您可以编写一个为您执行此操作的宏。转到工具 -> 宏 IDE

在那里，双击 EnvironmentEvents 模块并添加以下代码：

```
Private Sub BuildEvents_OnBuildBegin(ByVal Scope As EnvDTE.vsBuildScope, ByVal Action As EnvDTE.vsBuildAction) Handles BuildEvents.OnBuildBegin
    If (Scope = EnvDTE.vsBuildScope.vsBuildScopeSolution)
        //Do whatever solution independent stuff you need here.
        If(DTE.Solution.FullName = "C:\My Solutions\Solution1.sln")
           //Do whatever you need for Solution1.sln here.
        End If
    End If
End Sub

Private Sub BuildEvents_OnBuildDone(ByVal Scope As EnvDTE.vsBuildScope, ByVal Action As EnvDTE.vsBuildAction) Handles BuildEvents.OnBuildDone
    If (Scope = EnvDTE.vsBuildScope.vsBuildScopeSolution)
        //Do whatever solution independent stuff you need here.
        If(DTE.Solution.FullName = "C:\My Solutions\Solution1.sln")
           //Do whatever you need for Solution1.sln here.
        End If
    End If
End Sub 
```

# c# - C#：IEnumerator 在 using 语句中

> ID：938868
> 
> 赞同：6
> 
> 时间：2009-06-02T10:41:16.640
> 
> 标签：c#, ienumerable, idisposable, using-statement, ienumerator

我很想知道该`SingleOrFallback`方法是如何在[MoreLinq](http://code.google.com/p/morelinq/)中实现的，并发现了一些我以前从未见过的东西：

```
 public static T SingleOrFallback<T>(this IEnumerable<T> source, Func<T> fallback)
    {
        source.ThrowIfNull("source");
        fallback.ThrowIfNull("fallback");
        using (IEnumerator<T> iterator = source.GetEnumerator())
        {
            if (!iterator.MoveNext())
            {
                return fallback();
            }
            T first = iterator.Current;
            if (iterator.MoveNext())
            {
                throw new InvalidOperationException();
            }
            return first;
        }
    } 
```

为什么`IEnumerator<T>`在`using`声明中？`foreach`这也是在使用on an时应该考虑的事情`IEnumerable<T>`吗？

*附带问题：*这种方法究竟做了什么？每当源序列不包含一个项目时，它是否返回后备项目？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T10:45:42.640

`IEnumerator<T>`extends `IDisposable`，所以你*应该*在 using 语句中使用它。`foreach`自动执行此操作。（非泛型`IEnumerator` *不会*扩展`IDisposable`，但 C# 编译器仍会生成`Dispose`有条件调用的代码。这是 C# 1.0 和 1.2 之间的（少数）更改之一，其中 1.2 是 .NET 1.1 附带的版本，出于某种原因。 )

[这是一篇文章，](http://csharpindepth.com/Articles/Chapter6/IteratorBlockImplementation.aspx)解释了为什么这在迭代器块的上下文中很重要。

至于该方法的作用：

*   如果序列为空，则返回后备项
*   如果序列只有一项，则返回它
*   如果序列有多个项目，则抛出异常

PS：很高兴看到 MoreLinq 得到了一些关注 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-03T18:04:44.357

如果不调用 Dispose，一些枚举器的行为会很糟糕；这对于非泛型代码和泛型代码一样正确（非泛型代码要求代码要么对 Dispose 调用进行鸭式输入，要么强制转换为 IDisposable，然后调用 IDisposable.Dispose）。确保 IEnumerator 对象被释放是一种好的习惯；我认为任何接受未知类型的 IEnumerable 的例程的正确性都是必要的。

# python - Python IRC bot 和编码问题

> ID：938870
> 
> 赞同：3
> 
> 时间：2009-06-02T10:41:48.183
> 
> 标签：python, unicode, encoding, irc

目前我有一个用 python 编写的简单 IRC 机器人。

自从我将它迁移到区分字节和 unicode 字符串的 python 3.0 后，我开始遇到编码问题。具体来说，其他人不发送 UTF-8。

现在，我可以告诉每个人发送 UTF-8（不管怎样，他们都应该这样做），但更好的解决方案是尝试让 python 默认为其他编码等。

到目前为止，代码如下所示：

```
data = str(irc.recv(4096),"UTF-8", "replace") 
```

至少不会抛出异常。但是，我想跳过它：我希望我的机器人默认使用另一种编码，或者尝试以某种方式检测“麻烦的字符”。

此外，我需要弄清楚 mIRC 实际使用的这种神秘编码是什么——因为其他客户端似乎可以正常工作并按应有的方式发送 UTF-8。

我应该如何去做这些事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T10:45:28.817

[chardet](https://pypi.python.org/pypi/chardet)应该有所帮助 - 它是用于检测未知编码的规范 Python 库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T00:29:07.587

正如 RichieHindle 所提到的，chardet 可能是您最好的解决方案。但是，如果你想覆盖大约 90% 的文本，你会看到你可以使用我使用的：

```
def decode(bytes):
    try:
        text = bytes.decode('utf-8')
    except UnicodeDecodeError:
        try:
            text = bytes.decode('iso-8859-1')
        except UnicodeDecodeError:
            text = bytes.decode('cp1252')
    return text

def encode(bytes):
    try:
        text = bytes.encode('utf-8')
    except UnicodeEncodeError:
        try:
            text = bytes.encode('iso-8859-1')
        except UnicodeEncodeError:
            text = bytes.encode('cp1252')
    return text 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T15:03:06.113

在消息很短的情况下（IRC 就是这种情况），仅使用 chardet 会导致较差的结果。

Chardet 结合在整个消息中记住特定用户的编码可能是有意义的。但是，为简单起见，我会使用一些可能的编码（编码取决于文化和时代，请参阅[http://en.wikipedia.org/wiki/Internet_Relay_Chat#Character_encoding](http://en.wikipedia.org/wiki/Internet_Relay_Chat#Character_encoding)），如果它们失败了，我会去 chardet（如果有人使用一些东亚编码，这将帮助我们）。

例如：

```
def decode_irc(raw, preferred_encs = ["UTF-8", "CP1252", "ISO-8859-1"]):
    changed = False
    for enc in preferred_encs:
        try:
            res = raw.decode(enc)
            changed = True
            break
        except:
            pass
    if not changed:
        try:
            enc = chardet.detect(raw)['encoding']
            res = raw.decode(enc)
        except:
            res = raw.decode(enc, 'ignore')
return res 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-02T11:59:04.597

好的，经过一些研究发现 chardet 在 python 3 上遇到了问题。结果证明解决方案比我想象的要简单。如果 UTF-8 不能削减它，我选择使用 CP1252：

```
data = irc.recv ( 4096 )
try: data = str(data,"UTF-8")
except UnicodeDecodeError: data = str(data,"CP1252") 
```

这似乎工作。虽然它没有检测到编码，所以如果有人输入的编码既不是 UTF-8 也不是 CP1252，我会再次遇到问题。

这实际上只是一个临时解决方案。

# android - 如何在android中以表格格式显示数据？

> ID：938872
> 
> 赞同：4
> 
> 时间：2009-06-02T10:42:49.570
> 
> 标签：android

我是安卓新手。现在我正在研究一些数据库示例程序。现在我在以表格格式显示从数据库检索到的数据时遇到问题。如果有人知道答案，请帮助我提供源代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T12:17:35.480

您可以使用`TableLayout`包裹在`ScrollView`. 或者您可以使用`GridView`. 这取决于您是否要允许人们选择单元格。

# .net - 如何使用 WPF 确定默认打印机？

> ID：938873
> 
> 赞同：8
> 
> 时间：2009-06-02T10:43:02.847
> 
> 标签：.net, wpf, printing

要检索我使用的打印机列表：

```
new LocalPrintServer().GetPrintQueues(new[] { EnumeratedPrintQueueTypes.Local, EnumeratedPrintQueueTypes.Connections }) 
```

如何确定哪些打印机是默认打印机？

注意：使用的`System.Printing.dll`组件。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-02T10:47:24.087

```
LocalPrintServer.GetDefaultPrintQueue() 
```

# javascript - 将 Google 地图数据导入 iPhone

> ID：938879
> 
> 赞同：0
> 
> 时间：2009-06-02T10:44:53.843
> 
> 标签：javascript, iphone, google-maps, maps

编写一个 iPhone 应用程序，我需要使用 Google Maps api 来获取方向和路线。不幸的是，谷歌地图是围绕 javascript 工作的。

知道怎么做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-07T19:41:52.180

在执行此操作之前，您应该知道在付费应用程序中使用地图数据是违反 Google 的条款和条件的。

来自[http://code.google.com/apis/maps/terms.html](http://code.google.com/apis/maps/terms.html)

> 9.1 对您的 Maps API 实施的免费、公开可访问性。您的 Maps API 实施必须通常可供用户免费访问。如果您不要求用户付费，您可能会要求用户登录您的 Maps API 实施。除非您已与 Google 签订单独的书面协议或获得 Google 的书面许可，否则您的 Maps API 实施不得：
> 
> (a) 需要收费订阅或其他收费的受限访问；(b) 仅在防火墙后或仅在内部网络上运行（开发和测试阶段除外）。
> 
> 10.8 使用静态地图 API，而不是在网络浏览器中的实现；

我也包括了第 10.8 节。这是一个有争议的问题，因为您可能会争辩说 UIWebView 是一个浏览器，但仍然要注意它。

如果您决定继续使用它，那么以下是一个非常好的实现，可以连接您需要的大部分代码，[http://code.google.com/p/iphone-google-maps-component/](http://code.google.com/p/iphone-google-maps-component/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-07T19:36:15.373

由于您需要遵守 OS 3.0 API 才能在应用商店中启动您的应用，您不妨开始使用 MapKit API 方法在您的应用中嵌入 Google 地图，而无需使用 WebView。上面的解决方案是 Google 地图过去是如何“嵌入”到您的应用程序中的，但现在您可以在 OS 3.0 中使用 MapKit。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T14:15:32.683

您可以使用 UIWebView 来实现这一点。在使用 JavaScript 通过其 Google Maps API 访问 Google Maps 服务时，您只需利用 UIWebView 方法：

```
- (NSString *)stringByEvaluatingJavaScriptFromString:(NSString *)script 
```

请注意，您需要在代表脚本的字符串中转义，所有出现的双引号都需要根据需要进行转义。

例如，以下将地图居中所需的方法取自 Maher Ali 的 iPhone SDK 编程第 12 章：

```
-(void) centerMap:(NSUInteger) index{
    CLLocation *loc = [locations objectAtIndex:index];
    NSString *js = 
    [NSString stringWithFormat:
     @"var map = new GMap2(document.getElementById(\"map_canvas\"));"
     "map.setMapType(G_HYBRID_MAP);"
     "map.setCenter(new GLatLng(%lf, %lf), 18);"
     "map.panTo(map.getCenter());"  
     "map.openInfoWindow(map.getCenter(),"
     "document.createTextNode(\"Loc: (%i/%i), Time: %@\"));", 
     [loc coordinate].latitude, [loc coordinate].longitude,
     index+1, [locations count], 
     [loc timestamp]];
    [webView stringByEvaluatingJavaScriptFromString:js];
} 
```

另外，请记住 Apple 文档中的以下内容：

> 每个顶级入口点的 JavaScript 执行时间限制为 10 秒。如果您的脚本执行超过 10 秒，Safari 将停止执行该脚本。这很可能发生在代码中的随机位置，因此可能会导致意想不到的后果。施加此限制是因为 JavaScript 执行可能会导致主线程阻塞，因此当脚本运行时，用户无法与网页交互。
> 
> JavaScript 分配也限制为 10 MB。如果超过 JavaScript 的总内存分配限制，Safari 会引发异常。

# .net - .NET Windows 存储数据

> ID：938882
> 
> 赞同：4
> 
> 时间：2009-06-02T10:45:33.840
> 
> 标签：.net, windows, data-storage

好吧，如果我想为应用程序机器范围存储数据，我只是使用

```
Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData) 
```

如果我想为每个用户存储数据，我会使用

```
Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) 
```

但是，如果我想为每个应用程序实例保存数据怎么办？我可以使用存储应用程序的文件夹，但如果我理解正确的话，“程序文件”文件夹不是用于这种类型的数据存储的......

编辑：为了澄清我的意思，如果我在不同的文件夹中安装应用程序 2 次......不是运行抱歉的实例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T10:49:43.740

我不知道有任何其他应用程序可以做到这一点。

例如，如果我运行两个 Visual Studio 副本，我希望最后一个关闭实例的设置是持久的。

如果您为实例分配唯一 ID (GUID)，您如何在下次运行应用程序时重用该值？或者您想在每次运行应用程序时获取一组新值？

如果您想重用，您可以创建编号的子目录（1、2、3、4 等），并且每次运行应用程序时都会将锁定文件写入该目录。然后检查锁定文件的存在并增加数字，直到找到未锁定的文件夹。

**更新**

根据添加的评论 - 为什么不获取可执行文件的路径并在其下创建一个文件夹？

如果用户无权访问该文件夹，则必须在位置和 GUID（例如）之间创建某种映射，然后将其附加到应用程序设置和用户设置路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T10:48:30.480

为什么不将数据存储在临时目录 Path.GetTempPath 中。您可以为您的应用程序使用一个子文件夹，并为您的实例使用另一个子文件夹（也许一个 Guid 作为名称会很有用）。我将实现一些实现 IDisposable 的管理器类，以允许在应用程序关闭时删除实例路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T11:37:33.050

一种可能性是在程序第一次运行时生成一个唯一的 id 并将其存储在特定于程序的某个位置（可能是本地配置文件）。

然后，当您要访问该应用程序的特定副本的文件时，只需使用

```
System.IO.Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData), "\" + uniqueid); 
```

或者

```
System.IO.Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData), "\" + uniqueid); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T10:58:12.130

如果需要，请在用户数据文件夹或机器数据文件夹下创建实例文件夹。您的应用程序可以在退出时删除任何不需要的数据。尽管@ChrisF 关于最常见的行为是正确的。

# ruby-on-rails - Rails 中的自定义路由问题

> ID：938885
> 
> 赞同：2
> 
> 时间：2009-06-02T10:45:58.737
> 
> 标签：ruby-on-rails, routes

我在路线中有这条线：

```
map.resources :questions, :new => {:vote_for => :put, :vote_against => :put}, :has_many => :replies, :shallow => true
```

在我看来，我使用以下助手：

```
link_to 'OK', vote_for_question_path(@question), :method => :put
link_to 'NO', vote_against_question_path(@question), :method => :put

```

但不幸的是，正如 Rails 所说，我的代码有问题：

```
未定义的方法 `vote_for_question_path' 用于#
```

怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T11:08:10.097

It looks like your route syntax is wrong.

If you want to add new member routes (i.e. ones that apply to a single instance of a resource), then you should do:

```
map.resources :questions,
              :member => { :vote_for => :put, :vote_against => :put },
              :has_many => :replies, :shallow => true 
```

On the other hand, if you want to override the standard "new" URL segment, then it would be:

```
map.resources :questions, :path_names => { :new => 'vote_for' },
              :has_many => :replies, :shallow => true 
```

—Note that the corresponding controller action would still be named "new". This would allow URLs such as:

/questions/vote_for

However, looking at what you appear to be trying to do you might want to consider creating a new `Vote` resource. This would get created when a user votes for a question and would fit within the standard Rails' RESTful routing conventions. Voting on a question could then have a URL something like:

/questions/22/votes/new

# c# - 使用ownerdraw和virtualmode在listview中闪烁

> ID：938896
> 
> 赞同：2
> 
> 时间：2009-06-02T10:48:37.250
> 
> 标签：c#, winforms, listview

我正在使用设置了以下参数的 listview 控件：

```
 this.listView1.BackColor = System.Drawing.Color.Gainsboro;
        this.listView1.Columns.AddRange(new System.Windows.Forms.ColumnHeader[] {
        this.columnHeader1,
        this.columnHeader2});
        this.listView1.FullRowSelect = true;
        this.listView1.HideSelection = false;
        this.listView1.Location = new System.Drawing.Point(67, 192);
        this.listView1.Name = "listView1";
        this.listView1.Size = new System.Drawing.Size(438, 236);
        this.listView1.TabIndex = 0;
        this.listView1.UseCompatibleStateImageBehavior = false;
        this.listView1.View = System.Windows.Forms.View.Details;
        this.listView1.DrawColumnHeader += new System.Windows.Forms.DrawListViewColumnHeaderEventHandler(this.listView1_DrawColumnHeader);
        this.listView1.RetrieveVirtualItem += new System.Windows.Forms.RetrieveVirtualItemEventHandler(this.listView1_RetrieveVirtualItem);
        this.listView1.DrawSubItem += new System.Windows.Forms.DrawListViewSubItemEventHandler(this.listView1_DrawSubItem); 
```

两行提供了一些随机文本。Ownerdrawing很简单：

```
 private void listView1_DrawSubItem(object sender, DrawListViewSubItemEventArgs e)
    {
        if (e.ColumnIndex == 0)
        {
            e.DrawBackground();
            e.DrawText();                
        }
        else
            e.DrawDefault = true;
        //Console.WriteLine("{0}\t\tBounds:{1}\tItem:{2}\tSubitem:{3}", (i++).ToString(), e.Bounds.ToString(), e.Item, e.SubItem);
    } 
```

问题是：当我将鼠标悬停在 listview 的内容上时，我得到第一列的闪烁。调试显示 DrawSubItem 在鼠标悬停时不断被调用。

是虫子吗？如何避免这种行为？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T15:27:06.253

这是 .NET 的 ListView 中的一个错误，您无法通过双缓冲来解决它。

在虚拟列表上，当鼠标悬停在第 0 列上时，底层控件会生成大量自定义绘制事件。即使您启用 DoubleBuffering，这些自定义绘制事件也会导致闪烁，因为它们是在正常 WmPaint 消息之外发送的。

我似乎还记得这只发生在 XP 上。Vista 修复了这个问题（但引入了其他问题）。

您可以查看[ObjectListView](http://objectlistview.sourceforge.net)中的代码，了解它是如何解决这个问题的。

如果你想自己解决它，你需要深入研究 ListView 控件的内部管道：

1.  覆盖 WndProc
2.  拦截 WmPaint msg，并在 msg 期间设置一个为 true 的标志
3.  拦截 WmCustomDraw 消息，并忽略在 WmPaint 事件之外发生的所有消息。

像这样的东西::

```
protected override void WndProc(ref Message m) {
    switch (m.Msg) {
        case 0x0F: // WM_PAINT
            this.isInWmPaintMsg = true;
            base.WndProc(ref m);
            this.isInWmPaintMsg = false;
            break;
        case 0x204E: // WM_REFLECT_NOTIFY
            NativeMethods.NMHDR nmhdr = (NativeMethods.NMHDR)m.GetLParam(typeof(NativeMethods.NMHDR));
            if (nmhdr.code == -12) { // NM_CUSTOMDRAW
                if (this.isInWmPaintMsg)
                    base.WndProc(ref m);
            } else
                base.WndProc(ref m);
            break;
        default:
            base.WndProc(ref m);
            break;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-05T11:52:55.727

我得到一堆

```
'System.Drawing.NativeMethods' is inaccessible due to its protection level 
```

和

```
The type name 'NMHDR' does not exist in the type 'System.Drawing.NativeMethods' 
```

错误。我在某处读到我必须包含 user32.dll 但在这种情况下不知道该怎么做。

**编辑：**好的，我什至在开始思考之前就发布了。我现在创建了自己的 ListView 控件并从 objectListView 代码中复制了结构。它现在似乎起作用了。这是我的代码：

```
public class Listview : ListView
{
    private bool isInWmPaintMsg=false;

    [StructLayout(LayoutKind.Sequential)]
    public struct NMHDR
    {
        public IntPtr hwndFrom;
        public IntPtr idFrom;
        public int code;
    }

    protected override void WndProc(ref Message m)
    {
        switch (m.Msg)
        {
            case 0x0F: // WM_PAINT
                this.isInWmPaintMsg = true;
                base.WndProc(ref m);
                this.isInWmPaintMsg = false;
                break;
            case 0x204E: // WM_REFLECT_NOTIFY
                NMHDR nmhdr = (NMHDR)m.GetLParam(typeof(NMHDR));
                if (nmhdr.code == -12)
                { // NM_CUSTOMDRAW
                    if (this.isInWmPaintMsg)
                        base.WndProc(ref m);
                }
                else
                    base.WndProc(ref m);
                break;
            default:
                base.WndProc(ref m);
                break;
        }
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T15:01:03.637

我不能为 ListView 经常调用自定义绘制事件提供解决方案，但也许你可以用双缓冲来掩盖问题：

[Stackoverflow：如何在表单上加倍缓冲 .NET 控件？](https://stackoverflow.com/questions/76993/how-to-double-buffer-net-controls-on-a-form/77233#77233)

# windows - 网络文件夹安全

> ID：938897
> 
> 赞同：0
> 
> 时间：2009-06-02T10:48:38.390
> 
> 标签：windows, vb.net, security, networking, directory

我有一个树视图控件，用于浏览用户系统驱动器上的各种文件夹。它还可以设置为使用 UNC 路径连接网络文件夹，例如“\server\files”。目前，我正在使用 My.Computer.FileSystem.GetDirectories 获取目录列表，但是当文件夹受密码保护时，这显然会失败。

有没有一种方法可以让 Windows 像您在 Windows 资源管理器中看到的那样打开凭据对话框并处理凭据端，以便用户名和密码也被缓存？

顺便说一句，我不允许物理映射驱动器。

谢谢你的帮助。

抢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T10:52:15.607

您将需要使用 P/Invoke 来调用 Windows API 函数，特别是 WNetAddConnection3。

在此处查看我的问题的答案：[我可以强制 Windows 向用户发起身份验证吗？](https://stackoverflow.com/questions/379941/can-i-force-windows-to-challenge-a-user-for-authentication)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-22T15:24:21.893

我认为你应该使用十六进制值 Private Const CONNECT_INTERACTIVE As Integer = &H8 Private Const CONNECT_PROMPT As Integer = &H10

# castle-windsor - Castle Windsor：如何更新组件注册

> ID：938898
> 
> 赞同：3
> 
> 时间：2009-06-02T10:48:44.660
> 
> 标签：castle-windsor, components, registration

如果我在配置中定义：

```
container.Register(
   Component.For<X.Y.Z.IActivityService>()
            .ImplementedBy<X.Y.Z.ActivityService>()
            .ServiceOverrides(ServiceOverride.ForKey("Listeners").Eq(new [] { typeof(X.Y.Z.DefaultActivityListener).FullName }))
            .LifeStyle.Transient
); 
```

我希望扩展此配置并向 Listeners 数组属性添加一个新项目，以便最终配置有效：

```
container.Register(
   Component.For<X.Y.Z.IActivityService>()
            .ImplementedBy<X.Y.Z.ActivityService>()
            .ServiceOverrides(ServiceOverride.ForKey("Listeners").Eq(new [] { typeof(X.Y.Z.DefaultActivityListener).FullName, "MyOtherListenerID" }))
            .LifeStyle.Transient
); 
```

首次注册组件时必须知道“数组”的内容，还是可以检索组件注册并添加到其中？

我希望使用装饰器模式来实现我的配置，这样我就可以构建我的容器，然后根据不同场景的需要对其进行扩展。这意味着我需要能够访问已配置的组件并添加到它们。

正在考虑有一个`DefaultConfig`返回默认设置的类，然后是多个“ `DecoratedConfig`”类之一，这将扩展默认配置。

所以我会

```
IWindsorContaner c = new DecoratedConfig(new DefaultConfig()).InitialiseContainer(); 
```

`DefaultConfig`将`ActivityService`使用 a设置`DefaultActivityListener`（如示例所示）。

`DecoratedConfig`将识别`ActivityService`已创建并将其自己的 Listener 实现添加到`Listeners`数组 on `ActivityService`。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T14:42:15.703

订阅`Kernel.ComponentModelCreated`活动。您可以从那里更改任何组件参数。看到[这个](http://www.castleproject.org/container/documentation/trunk/advanced/extendingit.html)。它不一定*是*执行此操作的设施，但它很方便。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-23T10:29:54.320

最好将[ComponentModel 构造贡献者](http://docs.castleproject.org/Windsor.ComponentModel-construction-contributors.ashx)与`IContributeComponentModelConstruction`接口一起使用，因为它是进一步配置组件的推荐方式。

为此，您将实现接口以指定要应用于配置的更改

```
public class ChangeConfiguration : IContributeComponentModelConstruction
{
    public void ProcessModel(IKernel kernel, ComponentModel model)
    {
        // filter your model to match the subset you're interested in
        // change the configuration for matching models
    }
} 
```

然后在注册组件之前，只需将类添加到容器中：

```
container.Kernel.ComponentModelBuilder.AddContributor(new ChangeConfiguration()); 
```

然后所有组件都将通过这个类，您可以在其中更改它们的配置。在您的情况下，更改侦听器列表等（我猜这是拦截器的旧名称）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T22:20:19.583

@mausch，调整`ComponentModel`配置似乎是解决方案。

下面的测试有效地完成了我需要的操作，而无需挂钩，`ComponentModelCreatedEvent`因此即使在创建组件模型之后我也可以进行更改。

我会将功能包装为扩展方法，并尝试适应流畅的 API。

```
[TestMethod]
public void ArrayPropertyTestApi3()
{
    using (Castle.Windsor.WindsorContainer container = new Castle.Windsor.WindsorContainer())
    {
        container.Register(Component.For<Components.A>().ServiceOverrides(ServiceOverride.ForKey("I").Eq(new[] { typeof(Components.B).FullName })));
        container.Register(Component.For<Components.B>());
        container.Register(Component.For<Components.C>());

        IHandler h = container.Kernel.GetHandler(typeof(Components.A));
        if (h != null)
        {
            var config = h.ComponentModel.Configuration;
            if (config != null)
            {
                var items = config.Children.Single(c => c.Name == "parameters")
                                  .Children.Single(c => c.Name == "I")
                                  .Children.Single(c => c.Name == "list")
                                  as MutableConfiguration;

                items.Children.Add(new MutableConfiguration("item", string.Format("${{{0}}}", typeof(Components.C).FullName)));
            }
        }

        Components.A svc = container.Resolve<Components.A>();
        Assert.IsTrue(svc.I.Length == 2);
        Assert.IsTrue(svc.I[0].Name == "B");
        Assert.IsTrue(svc.I[1].Name == "C");
    }
} 
```

# asp.net - 在 GridView / Repeater / ListView 中显示事件列表

> ID：938901
> 
> 赞同：0
> 
> 时间：2009-06-02T10:49:56.530
> 
> 标签：asp.net, gridview, listview, repeater

我将开发一个事件日历页面，它将显示从当前日期起 12 个月的事件列表（它将是只读的）。使用 SP 传递开始日期和月数等从数据库中获取数据很容易，但是当信息显示在页面中时，我需要按月对信息进行分组。例如：

```
=================================
2009 年 6 月
=================================
活动一
2009 年 6 月 1 日至 2009 年 6 月 2 日
*活动信息*
--------------------------------
活动 2
2009 年 6 月 20 日至 2009 年 6 月 21 日
*活动信息*
=================================
2009 年 7 月
=================================
活动 3
2009 年 7 月 1 日至 2009 年 7 月 2 日
*活动信息*
--------------------------------

*...这里还有几个月/活动...*

=================================
2010 年 5 月
=================================
活动 99
2010 年 5 月 10 日至 2010 年 5 月 11 日
*活动信息*
--------------------------------

```

我看过其他帖子，人们谈论在中继器中嵌套 GridView，反之亦然，但我不确定如何使用这种方法实现按月分组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T11:08:51.080

Bind your repeater to something that enumerates the months. Put a grid view in the item template of the repeater. In the ItemDataBound event of the repeater bind the gridview to something that enumerates all the events for that month. You can get the month from the RepeaterItemEventArgs.Item.DataItem object that holds the item that is being bound to the repeater item.

```
 <asp:Repeater ID="Repeater1" runat="server" 
        onitemdatabound="Repeater1_ItemDataBound">
    <ItemTemplate>
        <asp:GridView ID="GridView1" runat="server">
        </asp:GridView>
    </ItemTemplate>
    </asp:Repeater>

protected void Repeater1_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    GridView gridview = e.Item.FindControl("GridView1") as GridView;
    gridview.DataSource = ...;
    gridview.DataBind();
} 
```

**EDIT:** Updated to show how the range of months is generated.

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack)
    {
        DateTime currentDate = DateTime.Now;
        DateTime startDate = new DateTime(currentDate.Year, currentDate.Month, 1); 
        List<DateTime> dateRange = new List<DateTime>();
        for (int i = 0; i < 12; i++)
            dateRange.Add(startDate.AddMonths(i));

        Repeater1.DataSource = dateRange;
        Repeater1.DataBind();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T19:47:39.610

基本上一个 GridView 是一个表，使用中继器中的表就可以了，你应该考虑这一点，`DataBinder.Eval`例如：

```
<asp:Repeater ID="Repeater1" runat="server" DataSourceID="SqlDataSource1">
        <ItemTemplate>
            <table>
                <caption><%# Eval("MONTH") %></caption>
                <tr>
                    <td><%# Eval("EVENT_NAME") %></td>
                </tr>
                <tr>
                    <td><%# Eval("DATE_BEGIN") %> to <%# Eval("DATE_END") %></td>
                </tr>
                <tr>
                    <td><%# Eval("EVENT_INFO") %></td>
                </tr>
            </table>
        </ItemTemplate>
    </asp:Repeater> 
```

不知不觉这将为每个事件创建一个表。您也可以在 中启动表格并在 中`<HeaderTemplate>`完成它`FooterTemplate`。

现在您只需要相应地返回数据。

祝你好运。

# c# - 在 WPF 应用程序中创建新窗口

> ID：938903
> 
> 赞同：0
> 
> 时间：2009-06-02T10:50:28.790
> 
> 标签：c#, .net, wpf

我正在编写一个 WPF 应用程序来监视提要。当有从提要确定的新项目时，我想生成小窗口作为*通知*。如果有人熟悉 OS X 上的 Growl，那就是我正在尝试做的事情。另外，我要指出这是我的第一个 WPF 应用程序（也是我第一次做了一段时间不是 Web 应用程序的事情！）。

我最初是这样做的代码：

```
foreach(var feedNotification in newFeedNotifications) {
  var popupWindow = new PopupWindow() { ... };
  popupWindow.Show();
} 
```

问题是上面的CPU**非常**密集，它占用了大约 50% 的 CPU 使用率。此外，我希望能够跟踪屏幕通知的位置，以便如果下一次检查发现更多信息显示它知道当前最后一个可见的在哪里，并且新的显示在其他的下方。

在确保运行应用程序的计算机不被拖累的同时，我将如何实现这一目标？

**编辑：**我正在使用 .NET 3.5 SP1 框架

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T11:09:08.037

I'm not *100%* on this, but I think it would be much more efficient to spawn a new instance of the window into a collection maintained by your main window (or an object there-in). Then you could create an event that could be subscribed to by the newly spawned window. Once the new windows are watching for updates from the main window or object, you could just fire the event on the main window and let your notification windows take care of the rest.

As far as the notification window tracking, you could allow the notification windows to be alerted via another event hookup that there is a new window to display, and pass it to them (or allow them to retrieve it from the main object.) You can place that window directly beneath the currently visible notification by tracking when the window receives focus. So, the last window that received focus is the one that was last viewed. Once you have the existing window, it's just a matter of creating the new one in the same location (or slightly offset) then calling the focus of the window that's on top.

An alternative to tracking the active window via the focus check would be to just go through the collection of window objects contained in your main window, since the collection would be in order of creation. Hope this helps.

Found [this link](http://roecode.wordpress.com/2008/01/07/wpf-popup-control-part-1-the-quick-and-dirty-way/) a minute ago regarding popup controls that have some useful properties tied to them.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T11:56:47.800

是否绝对有必要为每个通知创建一个新窗口？虽然我没有对此进行测量，但可能是创建新的 WPF 窗口是一项 CPU 密集型任务。如果是这种情况，那么您无法更改代码以使用更少的 CPU。

是否可以只创建一个通知窗口，它将包含所有新通知的列表？我意识到这不是 Growl 的工作方式，但这将提供相同的信息，只是以不同的方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T23:06:58.413

为什么不使用 Windows 版本的 Growl？( [http://www.growlforwindows.com](http://www.growlforwindows.com) )

如果这不可能，只需创建一个透明窗口，其内容是 ItemsControl；ItemsControl 源是您的通知

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T15:17:44.710

我不确定 CPU 利用率（并且在我的所有机器上都是具有良好 GPU 的双核，我不太关心它），但看起来你正在尝试做一个“气球弹出”，以及好项目重用将是[codeproject WPF NotifyIcon](http://www.codeproject.com/KB/WPF/wpf_notifyicon.aspx)（这是我在自己的 RSS 阅读器中使用的）

# mysql - mysql选择涉及csv的行

> ID：938904
> 
> 赞同：0
> 
> 时间：2009-06-02T10:50:34.610
> 
> 标签：mysql

我有一个名为 txn 的表，其中名为 pid 的列是 csv。我通过以下方式使用查询：

```
SELECT * FROM txn where pid like '%,11%'; 
```

即，如果 pid=,1,2,7,11,4 ，那么应该选择这个特定的行..但我的问题是..因为我正在使用

> 喜欢

如果 pid=,1,111,112 或类似的东西，那么即使它没有 11，这行也会被选中..所以这个查询不能解决我的问题..有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-11T18:05:35.443

SELECT * FROM txn where pid IN (1,2,7,11,4)

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T10:53:02.857

```
SELECT * FROM txn where pid like '%,11,%' or pid like '%,11'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T11:05:32.007

你的字符串总是有一个前导逗号，所以也添加一个尾随（例如`pid=',1,111,112,'`），这样`'%,11,%'`就足够了。您甚至可以即时执行此操作：

```
concat(pid,',') like '%,11,%' 
```

# log4j - Log4j SyslogAppender 是否支持 MDC 和 NDC

> ID：938907
> 
> 赞同：4
> 
> 时间：2009-06-02T10:52:32.843
> 
> 标签：log4j, syslog, mdc, structured-data, ndc

真的很简单，Log4j SyslogAppender 是否支持 MDC 和 NDC，因为输出是结构化数据，即使用协议的结构化数据特性？

此外，对于可以放入 MDC 并成功附加到日志的内容是否有任何限制？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T10:02:08.243

MDC 和 NDC 都是 Syslog 协议的一部分。因此，log4j 不（也不能）在 Syslog 协议的结构化数据中支持 MDC/NDC。但是，没有什么可以阻止您通过将 ConversionPattern 参数设置为包含 MDC 信息来在 syslog 消息的“消息”部分中添加 MDC 或 NDC 数据。

下面是一个带有键 "ki" 的 MDC 条目的示例：

```
log4j.rootLogger=INFO, SYSLOG
log4j.appender.SYSLOG=org.apache.log4j.net.SyslogAppender
log4j.appender.SYSLOG.SyslogHost=a.host.name

# Facility must be one of the case-insensitive strings:
# KERN, USER, MAIL, DAEMON, AUTH, SYSLOG, LPR, NEWS, UUCP, CRON,
# AUTHPRIV, FTP, LOCAL0, LOCAL1, LOCAL2, LOCAL3, LOCAL4, LOCAL5, LOCAL6,
# LOCAL7 
log4j.appender.SYSLOG.facility=KERN

log4j.appender.SYSLOG.layout=org.apache.log4j.PatternLayout
log4j.appender.SYSLOG.layout.ConversionPattern=%r %p %c %X{ki} - %m\n 
```

对于 NDC，您只需将“%X{ki}”替换为“%x”（注意使用小写字母）。

As for the second part of your question, there are no limits to the values you can place within MDC or NDC.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T11:11:13.663

查看源代码，我看不出它不应该的任何理由。

您是否尝试过成功写入 syslog，然后在 NDC/MDC 中写入内容？请注意，您必须在[PatternLayout](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/PatternLayout.html)中启用此功能（使用 %x 或 %X）。

MDC 似乎对您可以插入的内容没有任何限制（同样，基于检查源代码）。我怀疑 MDC 编写只会对`toString()`MDC 的内容执行 a，因此您可能会受到以这种方式呈现时对象的有用/可读性的限制。

# css - 如何部分反转角色的颜色？（左边的 33% 是黑色，右边的 67% 是白色）

> ID：938909
> 
> 赞同：1
> 
> 时间：2009-06-02T10:53:24.450
> 
> 标签：css

在此页面上使用 Chrome 或 Firefox 时：

[dell.com 上的页面](http://configure.us.dell.com/dellstore/config.aspx?oc=dxcwpp1&c=us&l=en&s=dhs&cs=19&kc=productdetails~desktop-studio-xps-435)

（或大多数任何产品页面都应该工作）。有 4 个选项卡，如果我们单击“查看”的最后一个选项卡，状态栏会出现部分反转的字符。例如，字母“v”可以让左边的 66% 为白色，右边的 33% 为黑色。我很确定它不是由 Flash 完成的，因为鼠标右键单击不显示任何 Flash 插件菜单。有人知道怎么做吗？

截屏：

[替代文字 http://img192.imageshack.us/img192/2696/partlyreversed.png](http://img192.imageshack.us/img192/2696/partlyreversed.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T10:55:13.807

我想这个词实际上有两次，每种颜色一次，但是白色版本被进度条剪掉了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T11:16:23.840

样本：

```
<div style="width:400px; height:1.1em; position:relative;">
    <div style="position:absolute; text-align:center; width:400px; height:100%; background-color:#eee;">49 %</div>
    <div style="position:absolute; overflow:hidden; width:195px; height:100%; background-color:#347;">
        <div style="width:400px; text-align: center; color: #ace;">49 %</div>
    </div>
</div> 
```

# c# - smime 带有附件的 C# 加密电子邮件

> ID：938920
> 
> 赞同：1
> 
> 时间：2009-06-02T10:59:26.450
> 
> 标签：c#, .net, encryption, base64, digital-certificate

我需要使用 C# 发送加密电子邮件而不使用任何第三方组件。只要我不需要电子邮件附件，这几乎可以工作，但是一旦我添加附件，我就会面临与[http://social.msdn.microsoft.com/forums/en-US/中描述的相同的问题netfxnetcom/thread/74e4711e-1f66-43a7-9e3b-bc9cfbcd1b73/](http://social.msdn.microsoft.com/forums/en-US/netfxnetcom/thread/74e4711e-1f66-43a7-9e3b-bc9cfbcd1b73/)

这里发布了一个使用attchment.rawdata 和attachment.filename 的解决方案，这是一些我一无所知的问题。什么可以是原始数据？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-06-02T12:58:28.503

请参阅Attachment 类的[构造函数。](http://msdn.microsoft.com/en-us/library/system.net.mail.attachment.attachment.aspx)

如果你传入一个 Stream，你几乎可以在附件中放任何东西。

# python - Pygtk 图形上下文和分配颜色

> ID：938921
> 
> 赞同：2
> 
> 时间：2009-06-02T11:00:21.113
> 
> 标签：python, pygtk, drawing2d

我已经对此进行了搜索，但没有我想要的东西。

[http://www.mail-archive.com/pygtk@daa.com.au/msg10529.html——](http://www.mail-archive.com/pygtk@daa.com.au/msg10529.html)没有人回答他。这正是我正在经历的。当我在图形上下文中设置前景时，它似乎并没有真正改变。

我已经通过教程和常见问题解答，但都没有说太多。他们要么只使用黑白上下文，要么给你断开的链接。我想也许这是一个错误。但是我内心的孩子说我只是错过了一些东西，而我一直无视我有一个可行的选择这一事实。不过这样会更好。我越深入，我就越需要这些上下文和颜色。

这是我的代码片段。

```
def CreatePixmapFromLCDdata(lcdP, ch, widget):
    width = lcdP.get_char_width()
    height = lcdP.get_char_height()

    # Create pixmap
    pixmap = gtk.gdk.Pixmap(widget.window, width, height)

    # Working graphics contexts, wrong color
    black_gc = widget.get_style().black_gc
    white_gc = widget.get_style().white_gc

    char_gc = widget.window.new_gc()
    colormap = char_gc.get_colormap()

    bg_color = NewColor(text="#78a878", colormap=colormap)

    print "Before", char_gc.foreground.red, char_gc.foreground.green, char_gc.foreground.blue
    char_gc.set_foreground(bg_color)
    print "AFter", char_gc.foreground.red, char_gc.foreground.green, char_gc.foreground.blue

    fg_color = NewColor(text="#113311", colormap=colormap)

    pixmap.draw_rectangle(char_gc, True, 0, 0, width, height)
    char_gc.foreground = fg_color
    for j in range(lcdP.dots['y']):
        k = lcdP.pixels['y']*j
        for i in range(lcdP.dots['x']):
            if 1<<(lcdP.dots['x']-1-i) & ch[j] == 0: continue

            m = i*lcdP.pixels['y']

            for jj in range(k, k+lcdP.pixels['y']-1):
                for ii in range(m+1, m+lcdP.pixels['x']):
                    pixmap.draw_point(char_gc, ii, jj)
    return pixmap 
```

我想这可能是我分配颜色的方式。正如您在片段中看到的，我使用了图形上下文自己的颜色图。我尝试了不同的颜色图，这是最新的。我什至尝试过未分配的颜色。注意 white_gc 和 black_gc 图形上下文。当我使用这些时，我可以在白色背景上画黑色。否则（使用创建的上下文）一切都是黑色的，fg 和 bg。当我改变白色的前景色时，它总是变成黑色。

这是输出。注意颜色变化不大。我会说它没有改变，或者至少不足以在视觉上产生影响。

```
Before 6 174 60340
After 5 174 60340 
```

这是我分配颜色的方法。

```
def NewColor(red=0, green=0, blue=0, text=None, colormap=None):
    if text == None:
        c = gtk.gdk.Color(red, green, blue)
    else:
        c = gtk.gdk.color_parse(text)
    if colormap == None:
        colormap = gtk.gdk.colormap_get_system()
    colormap.alloc_color(c)
    return c 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T12:14:38.870

过去我在[Drawable](http://www.pygtk.org/pygtk2reference/class-gdkdrawable.html)和[GC](http://www.pygtk.org/pygtk2reference/class-gdkgc.html)方面遇到了一些麻烦。[这个答案](https://stackoverflow.com/questions/326300/python-best-library-for-drawing/326548#326548)让我开始寻求解决方案。这是一个使用自定义颜色 gc 绘制一些正方形的快速示例：

```
import gtk

square_sz = 20
pixmap = None
colour = "#FF0000"
gc = None

def configure_event( widget, event):
    global pixmap
    x, y, width, height = widget.get_allocation()
    pixmap = gtk.gdk.Pixmap(widget.window, width, height)
    white_gc = widget.get_style().white_gc
    pixmap.draw_rectangle(white_gc, True, 0, 0, width, height)
    return True

def expose_event(widget, event):
    global pixmap
    if pixmap:
        x , y, w, h = event.area
        drawable_gc = widget.get_style().fg_gc[gtk.STATE_NORMAL]
        widget.window.draw_drawable(drawable_gc, pixmap, x, y, x, y, w, h)
    return False

def button_press_event(widget, event):
    global pixmap, square_sz, gc, colour
    if event.button == 1 and pixmap:
        x = int(event.x / square_sz) * square_sz
        y = int(event.y / square_sz) * square_sz
        if not gc:
            gc = widget.window.new_gc()
            gc.set_rgb_fg_color(gtk.gdk.color_parse(colour))
        pixmap.draw_rectangle(gc, True, x, y, square_sz, square_sz)
        widget.queue_draw_area(x, y, square_sz, square_sz)

    return True

if __name__ == "__main__":
    da = gtk.DrawingArea()
    da.set_size_request(square_sz*20, square_sz*20)

    da.connect("expose_event", expose_event)
    da.connect("configure_event", configure_event)
    da.connect("button_press_event", button_press_event)

    da.set_events(gtk.gdk.EXPOSURE_MASK | gtk.gdk.BUTTON_PRESS_MASK)

    w = gtk.Window()
    w.add(da)
    w.show_all()
    w.connect("destroy", lambda w: gtk.main_quit())

    gtk.main() 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-27T08:47:45.660

问题是该`NewColor()`函数返回一个未分配的颜色`c`。`colormap.alloc_color()`返回 a`gtk.gdk.Color`这是分配的颜色。要解决问题，最后一行`NewColor()`应该是：

```
return colormap.alloc_color(c) 
```

# c# - 获取 WPF 窗口的最小化框单击

> ID：938924
> 
> 赞同：16
> 
> 时间：2009-06-02T11:00:59.863
> 
> 标签：c#, .net, c#-3.0, wpf-controls

如何获取 WPF 窗口的最小化框单击事件？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-06-02T11:13:20.757

有一个名为`StateChanged`which （来自帮助）的事件看起来可能会做你想做的事。

> 在窗口的 WindowState 属性更改时发生。

帮助说它仅在 Vista 下的 .NET 3.0 和 3.5 中受支持，但我刚刚在 XP 上尝试过它，它会在窗口最小化、最大化和恢复时触发。**但是，根据我的测试，它会在状态更改后**触发，因此如果您想在窗口最小化之前执行某些操作，这可能不是您需要的方法。

您必须检查实际状态以确保它是正确的。

```
 private void Window_StateChanged(object sender, EventArgs e)
    {
        switch (this.WindowState)
        {
            case WindowState.Maximized:
                MessageBox.Show("Maximized");
                break;
            case WindowState.Minimized:
                MessageBox.Show("Minimized");
                break;
            case WindowState.Normal:
                MessageBox.Show("Normal");
                break;
        }
    } 
```

*显然，如果我只是打印出我将使用的状态`this.WindowState.ToString()`；）*

Visual Studio 应将以下内容添加到窗口的 XAML 定义中：

```
StateChanged="Window_StateChanged" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T11:14:26.730

除了Shoban的回答......

您可以使用 Window 的 Deactivated 事件，甚至可以使用 StateChange 事件，如下所示

```
private void Window_Deactivated(object sender, EventArgs e)
{
      if(this.WindowState== WindowState.Minimized)
           // Do your stuff

} 
```

这会有所帮助....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T11:05:57.620

抱歉，这与 WPF 无关，因为我对 WPF 的工作不多。但是您可以做的另一件事是在窗体的 Resized 事件期间检查 Windowsstate 属性。如果它等于 FormWindowState.Minimized 然后单击最小化按钮（？）;-)

# java - Ehcache 和多线程

> ID：938926
> 
> 赞同：15
> 
> 时间：2009-06-02T11:01:53.870
> 
> 标签：java, multithreading, ehcache

ehcache 默认支持多线程还是需要任何配置更改？在使用 Ehcache 对我的应用程序进行多线程处理时，我发现 DB 命中计数实际上在增加，即，尽管我的缓存都是单例，但没有可用于所有线程的全局缓存。有什么建议么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-02T12:53:19.293

这可能有助于回答您的问题，来自[常见问题解答](http://ehcache.sourceforge.net/documentation/faq.html)：

> **从缓存中检索后修改元素值是否线程安全？**
> 
> 请记住，缓存元素中的值可以从多个线程全局访问。*修改值本质上不是线程安全的。*检索一个值、删除缓存元素然后重新插入该值会更安全。

*（重点由我添加）*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-23T08:44:30.013

从[官方文档](http://www.ehcache.org/about/features.html)看来，它是*专门构建和测试的，可以在高并发访问下运行良好*，只要您不`Element`从多个线程进行修改。

但是，当然，这并不意味着使用 Ehcache 会使代码的其他部分成为线程安全的。如果您从多个线程中获取相同的值（使用相同的键），则该实例可能是共享的，您需要在修改它之前知道自己在做什么。Best 似乎使用不可变对象（如字符串）作为缓存值。

# zend-framework - Zend framework 1.8推荐的插件注册方式？

> ID：938930
> 
> 赞同：2
> 
> 时间：2009-06-02T11:02:53.713
> 
> 标签：zend-framework

在 Zend Framework 1.8 中，推荐在 Zend Framework 1.8 中注册新插件的方法是什么？

```
<?php
/**
 * Enter description here...
 *
 */
class Wenbert_Controller_Plugin_CheckHasAccess extends Zend_Controller_Plugin_Abstract {

    /**
     * Enter description here...
     *
     * @param Zend_Controller_Request_Abstract $request
     */
    public function preDispatch(Zend_Controller_Request_Abstract $request) {
        echo 'This plugin is called...';
    }
} 
```

我记得在 1.8 之前的版本中做了这样的事情：

```
require_once 'Wenbert/Controller/Plugin/CheckHasAccess.php';
$frontController = Zend_Controller_Front::getInstance();
$frontController->registerPlugin(new Wenbert_Controller_Plugin_CheckHasAccess()); 
```

在 ZF 1.8 中最好/推荐的方法是什么？

提前致谢！

-文伯特

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-07T15:39:58.183

我假设你的意思是 Zend_Application 做事的方式。你上面提到的方法绝对没有错。也就是说，您可以指定在 application.ini 中加载哪些插件，如下所示：

```
resources.frontController.plugins.foo = "My_Plugin_Foo"
resources.frontController.plugins.bar = "My_Plugin_Bar" 
```

我知道这种方法的唯一缺点是您无法控制插件的优先级（插件堆栈中的位置）......但对于大多数（几乎所有情况）来说，这无关紧要。

# c# - 参考名称案例不符合 CLS

> ID：938931
> 
> 赞同：5
> 
> 时间：2009-06-02T11:04:34.380
> 
> 标签：c#, reference, cls-compliant

我有一个 .NET 3.5 C# 项目，其命名空间为`SampleNamespace.Tools.Sample`.

如果我将一个名为“Samplenamespace.Utils.Example”的程序集添加到我的项目中，我会收到以下警告：

> 标识符“Samplenamespace”仅在不符合 CLS 的情况下有所不同

注意 中的小写“n” `Samplenamespace`。

目前我什至没有在我的项目中使用参考程序集。只需将其添加为参考就会导致警告。

考虑到我什至没有在我的公共类中公开对程序集的任何引用，为什么编译器会抱怨这个？

任何解决方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T11:08:33.933

Not all .NET languages are case sensitive (VB for example) when you have mixed namespaces like this, diffing only in case (to use the wording of the warning) your code may not be accessable to other developers.

That may not be your case, which is why it's a warning (which in my shop we treat as an error)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T11:10:13.713

It is simply warning you since not all languages that can consume the types within your solution will be aware of the difference (and may be unable to use the types).

I think that you can avoid this warning by marking your assembly as being non-CLS compliant (in the AssemblyInfo.cs file) ([read more here](http://msdn.microsoft.com/en-us/library/system.clscompliantattribute.aspx)):

```
[assembly:CLSCompliant(false)] 
```

Not sure I think it's a good idea though...

**Update:** I think that the reason that the warning is issued though nothing is publicly exposed is that namespaces do not have access modifiers. You could perhaps say that namespaces are always public, so they *are* exposed to potential clients, even though they may not contain any public types.

# c# - 使用 LiNQ 加载嵌套的 XML

> ID：938934
> 
> 赞同：1
> 
> 时间：2009-06-02T11:05:17.857
> 
> 标签：c#, .net, xml, linq-to-xml

我最近问了一个关于如何[将带有嵌套元素的列表保存到 XML](https://stackoverflow.com/questions/938698/nested-linq-to-xml)的问题，但现在我正在尝试为该类编写加载器并且遇到了问题。

我试图扭转给出的答案（感[谢乔恩](https://stackoverflow.com/users/22656/jon-skeet)）。

我相信我的核心 LINQ 查询没问题，这是我正在努力解决的递归问题。到目前为止，这是我的代码（为清楚起见，我按原样发布了整个 CPP）

```
 /// <summary>
/// 
/// </summary>
public class ErrorType
{
    List<ErrorType> _childErrors;

    public String Name { get; set; }
    public bool Ignore { get; set; }

    public List<ErrorType> ChildErrors { get; protected set; }
}

/// <summary>
/// 
/// </summary>
public class ErrorList
{
    public List<ErrorType> ChildErrors { get; protected set; }

    /// <summary>
    /// 
    /// </summary>
    /// <param name="xml"></param>
    public void FilterErrors(XElement xml)
    {
        //Convert to ErrorList
        //Write back out to XML but not writing out anything with errors
        //Send XML on its way
    }

    /// <summary>
    /// 
    /// </summary>
    /// <param name="el"></param>
    /// <returns></returns>
    private XElement ErrorListToXml(ErrorList el)
    {
        // Need to declare in advance to call within the lambda.
        Func<ErrorType, XElement> recursiveGenerator = null;
        recursiveGenerator = error => new XElement
            (error.Name,
             new XAttribute("Ignore", error.Ignore),
             error.ChildErrors.Select(recursiveGenerator));

        var element = new XElement
                   ("ErrorList",
                    ChildErrors.Select(recursiveGenerator));

        Console.WriteLine(element);

        return element;
    }

    /// <summary>
    /// 
    /// </summary>
    /// <param name="xd"></param>
    /// <returns></returns>
    private ErrorList FromXmlToErrorList(XElement xd)
    {
        //Prepare lambda
        Func<ErrorType, XElement> recursiveGenerator = null;
        recursiveGenerator = error => new List<ErrorType>
            (error.Name,
             new XAttribute("Ignore", error.Ignore),
             error.ChildErrors.Select(recursiveGenerator));

        List<ErrorType> typeList = (from error in xd.Descendants()
                        select new ErrorType
                        {
                            Name = error.Value,
                            Ignore = bool.Parse(error.Attribute("Ignore").Value),
                            ChildErrors= error.Elements().Select()
                        }).ToList<ErrorType>();

        ErrorList el = new ErrorList();
        el.ChildErrors = typeList;
        return el;
    }

    /// <summary>
    /// 
    /// </summary>
    public void Save()
    {
        XElement xml = ErrorListToXml(this);
        xml.Save("errorlist.xml");
    }

    public void Load()
    {

    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T11:18:28.313

我让它与类似的东西一起工作：

```
 XDocument doc = XDocument.Parse(xml);

    Func<XElement, ErrorType> nodeReader = null;
    nodeReader = el => new ErrorType(
        el.Elements().Select(nodeReader)) {
        Name = el.Name.LocalName,
        Ignore = (bool)el.Attribute("Ignore"),
    };

    ErrorList list = new ErrorList(
        doc.Root.Elements().Select(nodeReader)); 
```

添加了合适的构造函数：

```
public ErrorType(IEnumerable<ErrorType> children) {
    ChildErrors = new List<ErrorType>(children);
}
public ErrorType() { ChildErrors = new List<ErrorType>(); }

public ErrorType(IEnumerable<ErrorType> children) {
    ChildErrors = new List<ErrorType>(children);
}
public ErrorType() { ChildErrors = new List<ErrorType>(); } 
```

有什么用吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T11:27:50.493

好的，我还没有尝试过（现在也没有时间），但我认为它应该很有效......

```
public class ErrorType
{
    List<ErrorType> _childErrors;

    public String Name { get; set; }
    public bool Ignore { get; set; }

    public List<ErrorType> ChildErrors { get; protected set; }

    public static ErrorType Parse(XElement element)
    {
        return new ErrorType
        {
            Name = element.Name.LocalName,
            Ignore = (bool) element.Attribute("Ignore"),
            ChildErrors = element.Elements()
                                 .Select(x => Parse(x))
                                 .ToList()
        };
    }
}

public class ErrorList
{
    public List<ErrorType> ChildErrors { get; protected set; }

    public static ErrorList Parse(XElement element)
    {
        return new ErrorList { ChildErrors = element.Elements()
                                 .Select(x => ErrorType.Parse(x))
                                 .ToList() };
    }
} 
```

# windows - 在 Windows 上使用音频检测进程

> ID：938955
> 
> 赞同：4
> 
> 时间：2009-06-02T11:12:29.370
> 
> 标签：windows, audio

如何检测 Windows 机器上哪些进程正在播放音频？换句话说，我如何枚举正在使用我的声卡的进程？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T16:49:27.727

在 Windows 7 上，有一些 API 允许您枚举机器上的所有音频会话，您可以使用这些 API 来枚举当前（或最近）播放音频的进程。

对此有一些严重的警告。例如，您无法发现使用 ASIO 等第 3 方音频堆栈的应用程序，也无法检测呈现压缩音频（使用独占模式）的应用程序。但是对于很大一部分（98%？）的应用程序，您可以使用 IAudioSessionManager2 接口来检索会话枚举器，它可以让您枚举在共享模式下呈现（或最近呈现）音频的应用程序。

不幸的是，此功能仅适用于 Windows 7。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T13:41:12.910

从 sysinternals (Microsoft) 下载进程资源管理器。一旦安装并在界面中单击“查找”“查找句柄或 DLL”

在 Vista 中，我放入了 audioses.dll（音频会话）和 audioeng.dll（音频引擎）

任何一个都会显示可以/确实使用声卡的应用程序列表。

谢谢，-马修

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T10:20:16.677

您不需要流程资源管理器。
只需从 ring3 枚举句柄表（旧常见问题解答、Google 群组、Win32）

# asp.net - Link Button on the page and set it as default button, work fine in IE but not in Mozila

> ID：938957
> 
> 赞同：3
> 
> 时间：2009-06-02T11:13:55.017
> 
> 标签：asp.net, mozilla, linkbutton

I have a **link button** on the page and set it as default button, It works fine in IE but not working in Mozila Firefox. Does anybody have any clue how to resolve this issue?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2011-04-26T09:36:20.980

`DefaultButton`不支持将该属性与`LinkButton`. [http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.panel.defaultbutton.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.panel.defaultbutton.aspx)

最简单的解决方案是在页面上包含一个虚拟按钮`style="display:none"`，将其设置为默认按钮，并为其提供与 LinkBut​​ton 相同的事件处理程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T11:21:22.253

I had this kind of issue with FF3 and ASP.NET linkbuttons. This seems to be a bug with FF3 (not sure), but the script that fixed is given below:

```
var __defaultFired = false;

function WebForm_FireDefaultButton(event, target) {
    var element = event.target || event.srcElement;

    if (!__defaultFired && event.keyCode == 13 && !(element && (element.tagName.toLowerCase() == "textarea"))) {
        var defaultButton;

        if (__nonMSDOMBrowser)
            defaultButton = document.getElementById(target);
        else
            defaultButton = document.all[target];

        if (defaultButton) {
            if(typeof(defaultButton.click) != "undefined")
                defaultButton.click();
            else
                eval(unescape(defaultButton.href.replace("javascript:", "")));

            event.cancelBubble = true;

            if (event.stopPropagation) event.stopPropagation();
            return false;
        }
    }
    return true;
} 
```

Keep it at the end of the page so that it overrides the `WebForm_FireDefaultButton` method rendered by ASP.NET.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T22:00:33.367

我的第一篇 Stack Overflow 写的，哇 :-)

ASP.NET：

```
<asp:Panel runat="server" DefaultButton="lbHello">
    First name: <asp:TextBox runat="server" ID="txtFirstName" />
    <asp:LinkButton ID="lbHello" Cssclass="button" runat="server" Text="Click me" OnClick="lbHello_Click" />
</asp:Panel> 
```

js：

```
$(document).ready(function () { $('.button').eventClick(); });

$.fn.eventClick = function() {
    function eventClick(a) { 
            if (a && typeof (a.click) == 'undefined') {
                a.click = function () {
                    var result = true;
                    if (a.onclick) result = a.onclick();
                    if (typeof (result) == 'undefined' || result) {
                        eval(a.getAttribute('href'));
                    }
                }
            }
        }
        return eventClick($(this).get(0));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-13T14:01:53.050

我认为它非常简单，只需添加需要回发的文本框的 onkeypress js 事件。

```
txtUserName.Attributes.Add("onKeyPress", "javascript:if (event.keyCode == 13)
 __doPostBack('" + btnLogin.UniqueID + "','')"); 
```

希望这会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-30T07:16:42.110

仅在我们第一次在文本框中按 Enter 时起作用。在文本框中添加一些文本然后按 enter 后，默认按钮将不会触发。

# java - 我应该如何在java中提取压缩文件夹？

> ID：938958
> 
> 赞同：8
> 
> 时间：2009-06-02T11:14:11.613
> 
> 标签：java, compression, zip, extraction

我正在使用以下代码在 Java 中提取 zip 文件。

```
import java.io.*;
import java.util.zip.*;

class  testZipFiles 
{
    public static void main(String[] args) 
    {

        try
        {
            String filename = "C:\\zip\\includes.zip";
            testZipFiles list = new testZipFiles( );
            list.getZipFiles(filename);
        }
        catch (Exception e)
        {
            e.printStackTrace();
        }
    }

    public void getZipFiles(String filename)
    {
        try
        {
            String destinationname = "c:\\zip\\";
            byte[] buf = new byte[1024];
            ZipInputStream zipinputstream = null;
            ZipEntry zipentry;
            zipinputstream = new ZipInputStream(
            new FileInputStream(filename));

            zipentry = zipinputstream.getNextEntry();
            while (zipentry != null) 
            { 
                //for each entry to be extracted
                String entryName = zipentry.getName();
                System.out.println("entryname "+entryName);
                int n;
                FileOutputStream fileoutputstream;
                File newFile = new File(entryName);
                String directory = newFile.getParent();

                if(directory == null)
                {
                    if(newFile.isDirectory())
                    break;
                }

                fileoutputstream = new FileOutputStream(
                   destinationname+entryName);             

                while ((n = zipinputstream.read(buf, 0, 1024)) > -1)
                    fileoutputstream.write(buf, 0, n);

                fileoutputstream.close(); 
                zipinputstream.closeEntry();
                zipentry = zipinputstream.getNextEntry();

            }//while

            zipinputstream.close();
        }
        catch (Exception e)
       {
            e.printStackTrace();
       }
  }

} 
```

显然，由于 break 语句，这不会提取文件夹树。我尝试使用递归来处理文件夹树但失败了。有人可以告诉我如何改进此代码以处理文件夹树而不是压缩的单级文件夹。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T11:40:45.040

您可以使用 File.mkdirs() 创建文件夹。尝试像这样更改您的方法：

```
public static void getZipFiles(String filename) {
    try {
        String destinationname = "c:\\zip\\";
        byte[] buf = new byte[1024];
        ZipInputStream zipinputstream = null;
        ZipEntry zipentry;
        zipinputstream = new ZipInputStream(
                new FileInputStream(filename));

        zipentry = zipinputstream.getNextEntry();
        while (zipentry != null) {
            //for each entry to be extracted
            String entryName = destinationname + zipentry.getName();
            entryName = entryName.replace('/', File.separatorChar);
            entryName = entryName.replace('\\', File.separatorChar);
            System.out.println("entryname " + entryName);
            int n;
            FileOutputStream fileoutputstream;
            File newFile = new File(entryName);
            if (zipentry.isDirectory()) {
                if (!newFile.mkdirs()) {
                    break;
                }
                zipentry = zipinputstream.getNextEntry();
                continue;
            }

            fileoutputstream = new FileOutputStream(entryName);

            while ((n = zipinputstream.read(buf, 0, 1024)) > -1) {
                fileoutputstream.write(buf, 0, n);
            }

            fileoutputstream.close();
            zipinputstream.closeEntry();
            zipentry = zipinputstream.getNextEntry();

        }//while

        zipinputstream.close();
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T22:42:37.767

另一个选项是[commons-compress](http://commons.apache.org/compress)，上面链接的站点上有示例代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-20T22:58:34.240

我需要这样做，因为我使用的 API 需要一个 File 参数，而您无法从 JAR 中的资源中获取该参数。

我发现@Emre 的答案不能正常工作。出于某种原因，ZipEntry 跳过了 JAR 中的一些文件（对此没有明显的模式）。我改用 JarEntry 解决了这个问题。上面代码中还有一个bug，zip入口中的文件可能在目录之前就被枚举出来了，这导致了一个异常，因为目录还没有被创建。

请注意，以下代码取决于 Apache Commons 实用程序类。

```
/**
 * 
 * Extract a directory in a JAR on the classpath to an output folder.
 * 
 * Note: User's responsibility to ensure that the files are actually in a JAR.
 * The way that I do this is to get the URI with
 *     URI url = getClass().getResource("/myresource").toURI();
 * and then if url.isOpaque() we are in a JAR. There may be a more reliable
 * way however, please edit this answer if you know of one.
 * 
 * @param classInJar A class in the JAR file which is on the classpath
 * @param resourceDirectory Path to resource directory in JAR
 * @param outputDirectory Directory to write to  
 * @return String containing the path to the folder in the outputDirectory
 * @throws IOException
 */
private static String extractDirectoryFromClasspathJAR(Class<?> classInJar, String resourceDirectory, String outputDirectory)
        throws IOException {

    resourceDirectory = StringUtils.strip(resourceDirectory, "\\/") + File.separator;

    URL jar = classInJar.getProtectionDomain().getCodeSource().getLocation();
    //Note: If you want to extract from a named JAR, remove the above 
    //line and replace "jar.getFile()" below with the path to the JAR.
    JarFile jarFile = new JarFile(new File(jar.getFile()));

    byte[] buf = new byte[1024];
    Enumeration<JarEntry> jarEntries = jarFile.entries();
    while (jarEntries.hasMoreElements()) {
        JarEntry jarEntry = jarEntries.nextElement();

        if (jarEntry.isDirectory() || !jarEntry.getName().startsWith(resourceDirectory)) {
            continue;               
        }

        String outputFileName = FilenameUtils.concat(outputDirectory, jarEntry.getName());
        //Create directories if they don't exist
        new File(FilenameUtils.getFullPath(outputFileName)).mkdirs();

        //Write file
        FileOutputStream fileOutputStream = new FileOutputStream(outputFileName);
        int n;
        InputStream is = jarFile.getInputStream(jarEntry);
        while ((n = is.read(buf, 0, 1024)) > -1) {
            fileOutputStream.write(buf, 0, n);
        }
        is.close();
        fileOutputStream.close();
    }
    jarFile.close();

    String fullPath = FilenameUtils.concat(outputDirectory, resourceDirectory);
    return fullPath;
} 
```

# .net - 安装不成功

> ID：938961
> 
> 赞同：0
> 
> 时间：2009-06-02T11:14:35.763
> 
> 标签：.net, windows-mobile

我创建了 cab 文件。当我安装到我的真实设备上时。我遇到了这种类型的错误。- 安装不成功。无法安装程序或设置，因为它没有足够的权限。

谁能帮帮我？？？？]

提前谢谢....

问候潘卡伊

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T13:03:08.947

听起来您正在安装到 WinMo 手机，并且手机[具有](http://technet.microsoft.com/en-us/library/cc182305.aspx)提供商设置的安全策略。您必须对 CAB 进行签名（或在允许的情况下降低设备安全性）才能安装 CAB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T11:28:15.347

你的 CAB 文件在做什么？文件在哪些目录中？您是否尝试设置某些可能受保护的注册表值？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T13:03:29.257

确保您的应用程序安装在“程序文件”下的**子文件夹**中，并且仅在“程序”文件夹下创建快捷方式。

我曾经有同样的错误信息，但不记得我犯了哪个错误：要么忘记了子文件夹，要么“程序”和“程序文件”不匹配。

# php - TYPO3 protected sites access to GET variables

> ID：938962
> 
> 赞同：0
> 
> 时间：2009-06-02T11:15:02.143
> 
> 标签：php, typo3

I am writing an TYPO3 Extension and everything is working fine right now. I Access the GET Variables via

```
t3lib_div::_GET('rid'); 
```

This does work on the testsite I added my Extension to, but if I add it on another subsite of the same page which is in an access-restricted area this does not work. I use var_dump to look at the GET vars, and on the normal site it works, on the restricted I dont get anything (not even NULL!) Just no output and the logic also does not take it. How do i fix that, or ist there another way to access the GET variables in that case?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T22:32:13.623

我猜这是因为在第一个请求中，扩展的输出存储在缓存中。第二个输出只是从缓存中生成的（而不是在您的扩展中重新生成）。为避免这种情况，您可以只使您的扩展不可缓存（USER_INT）或使用 cHash 来显示缓存条目与更多输入值相关，而不仅仅是简单的页面 URL ...

cHash 在 cHash[的奥秘一](https://typo3.org/documentation/article/the-mysteries-of-chash-1)文中进行了解释，我想您会通过 google 找到有关 USER 与 USER_INT 对象的足够信息；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T11:52:27.667

我不知道为什么，但似乎是某种缓存问题。我总是清除 Typo3 缓存，所以这不是直接的问题，但是如果我为插件所在的站点设置“nocache”标志，一切正常。所以实际上它与访问无关，但我不明白为什么没有 nocache 这不起作用。

# php - PHP script ending prematurely

> ID：938967
> 
> 赞同：0
> 
> 时间：2009-06-02T11:17:46.303
> 
> 标签：php, zend-framework, soap, zend-soap

My site has a php page that prints out XML, for some reason though it's being truncated to 8KB in size, I've never encountered this before and all the other pages on the site remain un-truncated.

Where should I start looking for the problem and what could cause it to stop like this?

The site uses the Zend framework and the page in question uses the soap server.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T12:43:39.000

将其放在输出切断的部分之前：

```
error_reporting(E_ALL);
ini_set('display_errors', 1); 
```

有可能只是一个没有输出的错误。还要确保您的代码不包含错误抑制运算符 (@symobl)，因为这是难以检测到错误的常见原因：[http ://www.php.net/manual/en/language.operators.errorcontrol.php](http://www.php.net/manual/en/language.operators.errorcontrol.php)

如果我的第一个建议解决了您的问题，那么我建议您正确设置和测试错误处理，以便您将来会收到所有错误，因为这将为您节省大量时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T11:22:52.487

I'd expect an error if it was memory but have you tried increasing the memory limit in php.ini?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T12:42:50.547

这可能是一些内存限制，也可能是在 XML 创建的那部分运行的脚本的任意部分。

检查你得到什么错误，看看是否有任何错误被抑制。如果所有其他方法都失败了，请发布一些在该 8KB 标记处运行的示例代码。

# c# - WSE 3.0 set content type

> ID：938970
> 
> 赞同：0
> 
> 时间：2009-06-02T11:18:47.503
> 
> 标签：c#, web-services, wse3.0

I've a simple question, for you, that I just can't seem to get my head around.

The situation is the following:

*   We create and send a request to a web service, using WSE 3.
*   The web service is written in Java.

Most of the things are fine, but I can't seem to have an impact on the ContentType of either the WebResuest or WebResponse and that's causing some problems.

The errormessage I keep getting is the following:

Client found a response content type of ' application/xop+xml;type="text/xml; charset=utf-8" ' but expected 'text/xml'. The request failed with the error message: ....

In the details of the error message it has the response to our call from the server and it's coming through properly. Obviously it's not good as it is at the moment as it's coming through an exception :).

So, how could I set the expected content type for the response?

If I'm correct, the Request and the Response in WSE 3.0 has to have the same ContentType. So I thought I would try to set the request.Headers[HttpRequestHeader.ContentType] to the expected one, but with no luck. (also, I can set the HttpWebRequest's contenttype in quite a few places, but none of them seem to do the trick)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T10:04:06.057

幸运的是，这个问题已经解决了，所以这里是未来参考的解决方案：

我们的客户端继承自 WebServicesClientProtocol 类，其中有一个名为 GetWebResponse(..) 的方法。简单地覆盖该方法并更改响应的 ContentType 似乎对我们有用。

```
 protected override WebResponse GetWebResponse(System.Net.WebRequest request)
    {
        WebResponse response = base.GetWebResponse(request);
        response.Headers[HttpResponseHeader.ContentType] = "text/xml";
        return response;
    } 
```

# security - 在不留下审计线索的情况下攻击网站

> ID：938978
> 
> 赞同：1
> 
> 时间：2009-06-02T11:21:44.423
> 
> 标签：security, owasp

最近， [Aetna 遭受了泄露](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fwww.computerworld.com%2Faction%2Farticle.do%3Fcommand%3DviewArticleBasic%26articleId%3D9133621&ei=qQolStfQMsfAtwepvLnfBg&rct=j&q=computerworld+aetna+breach&usg=AFQjCNEDcZnUExyxu1HlPhI22XVz3Loj0g)，丢失了 65,000 个 SSN。他们永远无法找到所发生事件的审计线索，这可能暗示攻击利用了 XSS 或类似技术。

是否有特定的已知攻击被坏人反复利用来进行此类攻击？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T11:28:55.297

人们会犯一些常见的错误，人们会使用一些常见的平台。如果不打补丁，每个人都可以使用简单的脚本闯入。

但是，如果有人专门追踪某些东西，在这种情况下是社会安全号码，在有组织的犯罪团伙中具有很高的价值，我本来希望有人花更多的时间来弄清楚该网站是如何工作的，并应用一个自定义漏洞来获取数据。

我也不明白为什么它必须是 XSS。如果他们的系统没有将访问日志发送到服务器之外，甚至没有记录每个入口点，那么有人可以通过多种方法利用可利用的服务器并随后进行清理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T11:27:46.970

目前还不清楚这是一次技术故障，鉴于尚无定论的取证，在我看来，这更有可能是人为故障，无论是社会工程、火车座位上留下的数据还是心怀不满的员工.

AFAIK 真正留下零审计线索的唯一方法是不编写审计。单独记录 HTTP 流量总是会给你*一些*基于 HTTP 的攻击的证据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T12:03:15.773

我已经看到了一些自动攻击的结果，他们做的第一件事就是禁用日志记录，并删除所有日志。

这就是为什么将日志记录位置更改为非标准路径很常见的原因 - 它不会对坚定的攻击者做任何事情，但它会在自动攻击的情况下为您提供更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T12:16:14.577

至少可以说，缺乏审计线索并不奇怪。没有多少公司保留有意义的审计线索。当然，通常会有千兆字节和千兆字节的日志，但谁会经历所有这些呢？大多数 IT 地方只会在它足够老的时候就将其转储，因此完全有可能发生这种违规行为，并且他们已经转储了日志，因为从文章中看起来他们直到垃圾邮件才知道可能的违规行为开始进来了。

我怀疑是糟糕的 IT，而不是一些导致缺乏审计线索的巧妙攻击。

# jquery - 使用“克隆”助手执行可拖动事件后，如何删除原始元素？

> ID：938984
> 
> 赞同：2
> 
> 时间：2009-06-02T11:23:57.070
> 
> 标签：jquery, jquery-ui-sortable, draggable

我有一个可拖动的项目列表。我将这些拖到几个可排序的列表中。我必须在拖动时使用“克隆”辅助方法，因为其他辅助方法无法正常工作。

不幸的是，我不希望该项目在可排序列表中被删除后保留在原始列表中。

成功拖动后如何删除原始项目？（即一旦它包含在可排序列表之一中）

我以为我可以通过可排序列表上的 droppable 事件访问原始元素，但我不确定如何实现这一点。

谢谢

格雷姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T23:07:47.510

```
$('li','#draggable').draggable({
    helper: "clone"
});

$('ul#droppable').droppable({
    accept: "#draggable > li",
    drop: function(event,ui){
        $('li.note').remove();
        ui.draggable.appendTo('ul#droppable').fadeIn();
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T12:02:58.193

[检查这个例子（jQuery UI-demo for sortables）](http://jqueryui.com/demos/sortable/#connect-lists)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T14:27:50.037

此基本设置似乎可以满足您的要求。

```
$(function() {
    $(".drag").draggable({ helper: 'clone' });
    $("#dropArea").droppable({
        drop: function(event, ui) {
            //ui.draggable.appendTo(this);
            $(this).append(ui.draggable);
        }
    });
}); 
```

如果这对你不起作用，你能给我们看一些代码吗？

# xml - XSLT; 在文档中查找最常见的元素值

> ID：938986
> 
> 赞同：1
> 
> 时间：2009-06-02T11:24:45.180
> 
> 标签：xml, xslt

如果这是一个非常简单的问题，我们深表歉意；我不怎么使用 XSLT，而且在网上也找不到太多建议，因为搜索结果有很多污染！

我有一个格式如下的 XML 文档。它的主要目的是通过 XSLT 以几种方式重新格式化，以便以几种不同的格式显示。

```
<desk>
<drawer>
    <contents>pencils</contents>
    <quantity>2</quantity>
</drawer>
<drawer>
    <contents>pens</contents>
    <quantity>15</quantity>
</drawer>
<drawer>
    <contents>pencils</contents>
    <quantity>3</quantity>
</drawer>
<drawer>
    <contents>rulers</contents>
    <quantity>2</quantity>
</drawer>
</desk> 
```

我想从 xml 中提取两条信息：i）平均数量；ii) 在 xml 中出现次数最多的内容（即“铅笔”，因为它出现两次，而不是“钢笔”，因为它的数量最多）。这个想法是，这可以通过管道传输到一个非常简单的 shell 脚本中。因此，我认为获取此信息的最简单方法是编写几个简短的 xsl 样式表，然后使用 xsltproc 获取数据。

第一条信息似乎直截了当。样式表的核心是这一行：

```
<xsl:value-of select="(sum(drawer/quantity)) div (count(drawer))" /> 
```

但我有点被第二个卡住了。

我想我可以使用这样的东西循环遍历每个内容的列表：

```
<xsl:for-each select="drawer[not(contents = preceding-sibling::drawer/contents)]" /> 
```

但我不太确定如何计算具有 $current_contents 的元素数量及其内容元素的值。我也看不到按结果排序的简单方法，因此我可以获得最常遇到的内容值的名称。

我觉得这在 XSLT 2.0 中更容易，因为它有各种分组选项，但不幸的是，xsltproc 似乎不支持这一点。任何帮助将不胜感激。

非常感谢，

雅各布

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T11:32:26.180

与在 XSLT 中解决的许多问题一样，我认为您的答案是[muenchian grouping](http://www.jenitennison.com/xslt/grouping/muenchian.html)。按您感兴趣的任何数据分组，一个 for-each 反对将让您使用 xsl:sort 然后对第一个结果执行您需要的任何操作。

未经测试，头顶，可能是更清洁的代码：

```
<xsl:key name="average" match="desk/drawer/contents" use="text()"/>

<xsl:template match="/">
    <xsl:for-each select="desk/drawer/contents[generate-id() = generate-id(key('average',text())[1])]">     
        <xsl:sort select="count(//desk/drawer/contents[text()=current()])"  order="descending"/>
        <xsl:if test="position()=1">
            Most common value: "<xsl:value-of select="current()"/>" (<xsl:value-of select="count(//desk/drawer/contents[text()=current()])"/>)
        </xsl:if>       
    </xsl:for-each>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T11:31:12.500

排序`for-each`是通过`sort`元素完成的。只需按数量排序并（如果您只想要最频繁的）添加一个`<xsl:if test="position()=1">`标签以仅获取循环中的第一个。

```
<xsl:for-each select="drawer">
   <xsl:sort select="quantity" data-type="number" order="descending"/>
   <xsl:if test="position()=1">
      Most frequent: <xsl:value-of select="contents"> with <xsl:value-of select="quantity"> items
   </xsl:if>
</xsl:for-each> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T11:53:51.130

已经有一段时间了，但我认为这些方面的东西可能会奏效。

首先计算所有内容

```
<xsl:variable name="tally">
  <xsl:for-each select="drawer">
     <contents count="{count(drawer[contents = current()/contents])}"><xsl:value-of select="contents"/></contents>
  </xsl:for-each>
</xsl:variable> 
```

请注意，每次都会计算重复的条目， $tally 将包含：

```
<contents count="2">pencils</contents>
<contents count="1">pens</contents>
<contents count="2">pencils</contents>
<contents count="1">rulers</contents> 
```

然后用它来找到一个没有其他更高计数的：

```
<xsl:variable name="mostfrequentcontents" select="$tally/contents[not($tally/contents/@count > @count)]" /> 
```

根据您的 xslt 处理器，您可能必须使用节点集函数将 $tally 转换为节点集。

# .net - 从 .NET 程序集 (dll) 中获取所有静态（内部）字符串

> ID：938987
> 
> 赞同：14
> 
> 时间：2009-06-02T11:25:19.440
> 
> 标签：.net, string, internationalization, low-level

我希望获得 .NET 程序集中使用的所有字符串的列表，包括局部变量设置为的“静态”值、传递给方法的参数、设置为的字段等。

我从很久以前读过的一篇文章中回忆起 .NET 程序集包含一个包含它使用的所有字符串的表（或者它们可以被“实习”）——或者我只是在做梦？

使用[.NET Reflector](http://en.wikipedia.org/wiki/.NET_Reflector)是一个很好的理想选择（感谢 thijs），如果没有人提出已经编写好的工具，我也会看看它的 API。

（这样我就可以编写一个工具来检查我们没有遗漏任何应该翻译的字符串。我可以处理 C# 源代码，但是我将不得不处理分成多行的字符串等）

我刚刚想，我希望排除传递给 CodeFlowException() 等的字符串，所以这已经变得越来越复杂了。

PS：如果您能想到更好的标签集，请重新标记此问题。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-02T11:41:41.980

您可以使用 SysInternals [Strings](http://technet.microsoft.com/en-us/sysinternals/bb897439.aspx)工具查看可执行文件和目标文件中的字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-02-26T11:14:49.670

对于那些想要从 .NET 程序集（.exe 或 .dll）中提取所有**用户字符串**的人，我编写了一个可以执行此操作的[简单实用程序](https://skydrive.live.com/?cid=954c6e938720df5d&id=954C6E938720DF5D%21126)（文件`ExtractExeNetStrings2.zip`）。该实用程序是用 C# 编写的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T11:49:55.037

您应该能够使用反射来做到这一点，看看这个：

[http://msdn.microsoft.com/en-us/library/system.reflection.fieldinfo.isliteral.aspx](http://msdn.microsoft.com/en-us/library/system.reflection.fieldinfo.isliteral.aspx)

和

[http://msdn.microsoft.com/en-us/library/system.reflection.fieldinfo.aspx](http://msdn.microsoft.com/en-us/library/system.reflection.fieldinfo.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-05-09T18:13:20.733

简单的 C# 实用程序，通过检查二进制文件的位从 .NET 程序集（.exe 或 .dll）中提取所有**用户字符串。**

现在可以[在 github上找到](https://gist.github.com/vbelcik/01d0f803b9db6ec9b90e8693e4b0493b#file-extractexenetstrings-cs)**vladob**答案的源代码。原始答案的链接已损坏。vladob 同意此转发。其实我同意了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-27T09:04:12.537

最后，我编写了一个非常简单的 C# 解析器，可以在源代码中找到字符串。这解决了我遇到的问题，让我在字符串中添加“注释”以帮助翻译。

注释只是从 C# 注释中以“魔术格式”读取的</p>

（对不起，解析器不够好，不能让其他人使用它，它只能在我的 C# 代码库上工作）

# wpf - WPF 拖动滚动无法正常工作

> ID：938989
> 
> 赞同：2
> 
> 时间：2009-06-02T11:25:46.130
> 
> 标签：wpf, drag-and-drop, scroll, itemscontrol

我想在我的应用程序中实现拖动滚动功能，但在路上遇到了问题。有谁能够帮我？我有一个 ScrollViewer，其中有一个 ItemsControl，在 ItemsTemplate 中有一个 UserControl。我想在 ItemsControl 中拖动那个 UserControl。当我拖动到 ItemsControl 的边界时，我希望 ScrollViewer 向下滚动。

```
protected override void OnPreviewMouseMove(System.Windows.Input.MouseEventArgs e)
{
    if (this.IsMouseCaptured)
    {
        // Get the new mouse position. 
        Point mouseDragCurrentPoint = e.GetPosition(this);

        if (Math.Abs(mouseDragCurrentPoint.Y - this.ActualHeight) <= 50)
        {
            this._scrollStartOffset.Y += 5;
            _containingScrollViewer.ScrollToVerticalOffset(this._scrollStartOffset.Y);
        }
        if (mouseDragCurrentPoint.Y <= 50)
        {
            this._scrollStartOffset.Y -= 5;
            _containingScrollViewer.ScrollToVerticalOffset(this._scrollStartOffset.Y);
        }
    }
    base.OnPreviewMouseMove(e);
} 
```

当我通过调用`DragDrop.DoDragDrop()`滚动开始拖动时不会发生。但是当我禁用拖动时，ScrollViewer 会根据鼠标位置向下滚动。也许有一些我不考虑拖动和捕获鼠标的事情？感谢关注。加雷金

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-10-07T12:58:04.867

使用 DragDrop.DoDragDrop() 时，我使用了一个处理 Me.DragOver 事件的 Sub（在 VB 中），因此它看起来如下所示。请注意，我的控件有一个包含在 ScrollViewer 中的 ListBox。

```
Private Sub ListBox_Items_DragOver(ByVal sender As System.Object, ByVal e As System.Windows.DragEventArgs) Handles Me.DragOver
        Dim currentMousePoint As Point = e.GetPosition(_containtingScrollViewer)
        If Math.Abs(currentMousePoint.Y - _containtingScrollViewer.ActualHeight) <= 50 Then
            _containtingScrollViewer.ScrollToVerticalOffset(currentMousePoint.Y + 5)
        End If
        If currentMousePoint.Y <= 50 Then
            _containtingScrollViewer.ScrollToVerticalOffset(currentMousePoint.Y - 5)
        End If
End Sub 
```

这使我能够在拖动项目时滚动。您可以根据需要调整公差以获得更好/更平滑的滚动。

# c# - 创建“新文件窗口”行为

> ID：938991
> 
> 赞同：0
> 
> 时间：2009-06-02T11:25:58.830
> 
> 标签：c#, file-manipulation

在 windows 环境和几个应用程序中，当我们创建一个与现有文件同名的新文件时，不会提示用户输出文件已经存在的消息，但它会使用 (1) 在文件名的结尾...

```
name.doc 
```

将会

```
name(1).doc 
```

我试图在 C# 中创建相同的行为，我的问题是......我可以减少所有这些代码吗？

```
FileInfo finfo = new FileInfo(fullOutputPath);
if (finfo.Exists)
{
  int iFile = 0;
  bool exitCreatingFile = false;
  while (!exitCreatingFile)
  {
    iFile++;
    if (fullOutputPath.Contains("(" + (iFile - 1) + ")."))
        fullOutputPath = fullOutputPath.Replace(
                "(" + (iFile - 1) + ").",
                "(" + iFile + ").");  // (1) --> (2)

    else
        fullOutputPath = fullOutputPath.Replace(
                Path.GetFileNameWithoutExtension(finfo.Name),
                Path.GetFileNameWithoutExtension(finfo.Name) + "(" + iFile + ")"); // name.doc --> name(1).doc

    finfo = new FileInfo(fullOutputPath);
    if (!finfo.Exists)
        exitCreatingFile = true;
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T11:39:57.053

我编写了一个 Winforms 控件来处理文件菜单实现的大部分细节。我不认为它使用更少的代码（尽管实现方式不同），但您可能想看看。

[文件选择](http://www.codeproject.com/KB/menus/fileselect.aspx)控件

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T11:42:19.217

怎么样（没有在 FileInfo 构造函数周围添加任何进一步的异常处理）：

```
FileInfo finfo = new FileInfo(fullOutputPath);
int iFile = 1;
while (finfo.Exists)
{
    finfo = new FileInfo(
        Path.GetFileNameWithoutExtension(fullOutputPath) +
        "(" + iFile + ")" +
        Path.GetExtension(fullOutputPath));
    iFile++;
}
// Optionally add fullOutputPath = finfo.Name; if you want to record the final name used 
```

# dll - 使用 DLL 的优缺点是什么？

> ID：938992
> 
> 赞同：7
> 
> 时间：2009-06-02T11:26:05.647
> 
> 标签：dll, shared-libraries

Windows 仍然使用 DLL，而 Mac 程序似乎根本不使用 DLL。使用这两种技术有好处还是坏处？

如果一个程序安装包含它需要的所有 DLL 以使其 100% 正常工作，它是否与静态链接所有库相同？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-02T11:27:46.783

MacOS X 和其他风格的 Unix 一样，使用共享库，这只是 DLL 的另一种形式。

是的，两者都是有利的，因为 DLL 或共享库代码可以在多个进程之间共享。它通过操作系统加载 DLL 或共享库并将其映射到使用它的进程的虚拟地址空间来实现这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T11:35:07.673

> Windows 仍然使用 DLL，而 Mac 程序似乎根本不使用 DLL。它们是使用这两种技术的好处还是坏处？

任何形式的模块化都是好的，因为它使更新软件更容易，即如果程序中的错误已修复，您不必更新整个程序二进制文件。如果bug出现在某些dll中，只需要更新dll即可。

imo 唯一的缺点是您在程序开发中引入了另一种复杂性，例如，如果 dll 是 ac 或 c++ dll，不同的调用约定等。

> 如果一个程序安装包括它需要的所有 DLL，它是否与静态链接所有库一样？

或多或少是的。取决于您是否在假设静态链接的 dll 中调用函数。dll 也可以是一个“独立的”动态库，您只能通过 LoadLibrary() 和 GetProcAddress() 等访问。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T11:35:25.050

共享库（Windows 上的 DLL 或 Unix 上的 .so）的一大优势是您可以分别重建库及其使用者，而使用静态库您必须重建库然后重新链接所有使用者，这在 Unix 系统上非常慢而且在 Windows 上不是很快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T11:40:32.373

MacOS 软件也使用“dll”，只是名称不同（共享库）。
如果您有想要在软件的不同组件中重用的代码，那么 Dll 就很有意义。大多数情况下，这在大型软件项目中是有意义的。
当不需要代码重用时，静态链接对于小型单组件应用程序很有意义。它简化了分发，因为您的组件没有外部依赖项。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T11:31:00.253

在 Windows 上，您必须使用动态加载的库，因为 GDI 和 USER 库只能作为 DLL 使用。您不能使用不涉及动态加载的协议将其中任何一个链接或与他们交谈。

在其他操作系统上，您无论如何都希望对复杂的应用程序使用动态加载，否则您的二进制文件会无缘无故地膨胀，并且从长远来看，它增加了您的应用程序与系统不兼容的可能性（但是，在短期内是静态的链接可以在一定程度上保护您免受库中微小的破坏性更改）。而且您不能在依赖它们的操作系统上链接专有库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T11:44:17.560

除了内存/磁盘空间使用之外，使用共享库的另一个重要优点是库的更新将被系统上使用该库的所有程序自动获取。

当 InfoZIP ZIP 库中存在安全漏洞时，对 DLL/.so 的更新会自动使所有使用这些库的软件安全。必须重新编译静态链接的软件。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-06-02T12:24:00.523

> Windows 仍然使用 DLL，而 Mac 程序似乎根本不使用 DLL。它们是使用这两种技术的好处还是坏处？

两者都使用共享库，只是使用不同的名称。

> 如果一个程序安装包含它需要的所有 DLL 以使其 100% 正常工作，它是否与静态链接所有库相同？

有些。当您将库静态链接到程序时，您将获得一个非常大的文件，使用 DLL，您将拥有许多文件。

静态链接的文件不需要“解析共享库”步骤（在程序加载时发生）。很久以前，加载静态程序意味着首先将整个程序加载到 RAM 中，然后发生“解析共享库”步骤。今天，只有实际执行的程序部分是按需加载的。因此，使用静态程序，您无需解析 DLL。使用 DLL，您不需要一次全部加载它们。所以在性能方面，它们应该是相当的。

这留下了“DLL地狱”。Windows 上的许多程序都带有它们需要的所有 DLL，并将它们写入 Windows 目录。最终结果是最后安装的程序可以正常工作，而其他所有程序都可能被破坏。但有一个简单的解决方法：将 DLL 安装到与 EXE 相同的目录中。Windows 将首先搜索当前目录，然后搜索各种 Windows 路径。这样，你会浪费一点磁盘空间，但你的程序可以工作，更重要的是，你不会破坏其他任何东西。

有人可能会争辩说，您不应该在 Windows 目录中安装已经存在（具有相同版本）的 DLL，但随后，您又容易受到一些不良应用程序的攻击，这些应用程序会用破坏您脖子的东西覆盖您需要的版本。缺点是您必须自己为您的应用分发安全修复程序；你不能依赖 Windows 更新或类似的东西来保护你的代码。这是一个紧张的地方；破解者从安全问题中赚了很多钱，当有人窃取他们的银行数据时，人们不会喜欢你，因为你没有尽快发布安全修复程序。

如果您计划在很多年（例如 20 年）内非常紧密地支持您的应用程序，那么将所有 DLL 安装在程序目录中是适合您的。如果没有，则编写代码检查是否安装了所有 DLL 的合适版本并告知用户，以便他们知道您的应用程序突然开始崩溃的原因。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-06-02T11:41:46.910

是的，请看这段[文字](http://msdn.microsoft.com/en-us/library/dtba4t8b.aspx)：

> 动态链接具有以下优点：
> 节省内存并减少交换。许多进程可以同时使用单个 DLL，在内存中共享 DLL 的单个副本。相反，对于使用静态链接库构建的每个应用程序，Windows 都必须将库代码的副本加载到内存中。
> 节省磁盘空间。许多应用程序可以共享磁盘上 DLL 的单个副本。相比之下，使用静态链接库构建的每个应用程序都将库代码链接到其可执行映像中作为单独的副本。
> 升级到 DLL 更容易。当 DLL 中的函数发生变化时，只要函数参数和返回值不变，使用它们的应用程序就不需要重新编译或重新链接。相反，静态链接的目标代码要求在功能更改时重新链接应用程序。
> 提供售后支持。例如，可以修改显示驱动程序 DLL 以支持应用程序发布时不可用的显示。
> 支持多语言程序。只要程序遵循函数的调用约定，用不同编程语言编写的程序就可以调用同一个 DLL 函数。程序和 DLL 函数必须在以下方面兼容：函数期望其参数被压入堆栈的顺序，函数或应用程序是否负责清理堆栈，以及是否传递任何参数在寄存器中。
> 提供一种机制来扩展 MFC 库类。您可以从现有的 MFC 类派生类并将它们放置在 MFC 扩展 DLL 中以供 MFC 应用程序使用。
> 简化国际版本的创建。通过将资源放置在 DLL 中，可以更轻松地创建应用程序的国际版本。您可以将应用程序的每个语言版本的字符串放在单独的资源 DLL 中，并让不同的语言版本加载相应的资源。
> 使用 DLL 的一个潜在缺点是应用程序不是独立的。这取决于是否存在单独的 DLL 模块。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-06-03T08:54:59.347

从我的角度来看，共享组件具有一些有时被视为缺点的优点。

*   共享组件在您的流程中定义接口。所以你不得不决定哪些组件/接口在外面是可见的，哪些是隐藏的。这会自动定义哪些接口必须是稳定的，哪些不需要是稳定的，并且可以在不影响组件外部的任何代码的情况下进行重构。
*   C++ 和 Windows 的内存管理必须经过深思熟虑。因此，通常您不应处理未在同一个 dll 中释放的 dll 之外的内存。如果这样做，您的组件可能会在以下情况下失败：使用不同的运行时或编译器版本。

所以我认为使用共享组件将有助于软件更好地组织。

# .htaccess - 使用 URL 重写的问题（相对路径不起作用）

> ID：938997
> 
> 赞同：4
> 
> 时间：2009-06-02T11:27:18.950
> 
> 标签：.htaccess, mod-rewrite, url-rewriting, relative-path, absolute-path

我正在使用 .htccess 文件来重写我的 URL。我在我的 .htaccess 文件中使用以下规则

```
Options +FollowSymlinks
RewriteEngine on 
RewriteBase /
RewriteRule ^product/([0-9]+)/([A-Za-z0-9+]+)$ /product.php?productid=$1&prodname=$2 
```

重写工作正常。

但是，当我尝试通过相对路径访问任何其他页面时，在所有情况下，URL 都没有正确重定向。

就像下面的例子

```
<form action "something.php" method="post">
   <input type="text" name="1" />
   <input type="submit" value="submit" />
</form> 
```

当我单击提交时，加载的页面`http://mydomain/product/1/something/something.php`不存在，因此引发 404 错误

我尝试在头部使用基本标记，但这会在我使用页面锚点和模式窗口时产生问题。它被重定向到索引页面。

如果需要更多详细信息，请告诉我。

我对此很陌生。那么，有人可以帮我解决这个问题吗？

提前致谢， Kartik

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T15:20:26.517

这是一个 URL 解析问题。有关详细信息，请参阅[所需的 mod_rewrite URL 信息](https://stackoverflow.com/questions/891775/modrewrite-url-info-required/891785#891785)。

您可以使用绝对 URL 路径或绝对 URL：

```
<form action="/something.php" method="post">
<form action="http://example.com/something.php" method="post"> 
```

或者您更改基本 URL（请参阅[`BASE`HTML 元素](http://www.w3.org/TR/html401/struct/links.html#edef-BASE)），以便从该 URL 而非当前 URL 解析每个相对 URL：

```
<base href="/">
<base href="http://example.com/"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T15:26:00.733

解决这个问题的简短而简单的版本是绝对路径您的 URL - /something.php 在表单操作中，而不仅仅是“something.php”。**************