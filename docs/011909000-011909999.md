# StackOverflow 问答 11909000-11909999

# javascript - 您将如何在仪表板上订购瓷砖？

> ID：11909000
> 
> 赞同：11
> 
> 时间：2012-08-10T20:44:57.780
> 
> 标签：javascript, jquery, asp.net, css, asp.net-mvc

我的任务是在我们的 ASP.NET MVC 3 Web 应用程序中创建仪表板界面。首先，我将列出该项目所需的功能，然后我将尽力说明我打算创建什么以适应所有这些功能。

## 所需功能

*   仪表板将包含可在仪表板界面中拖动的小部件（或磁贴）。

*   拖动小部件时，周围的小部件将适当地重新排序。

*   小部件不可调整大小或可折叠，但它们将是可移动的。如果他们愿意，用户将通过菜单添加回小部件。

*   小部件必须适应可变宽度的浏览器窗口。垂直空间几乎是无限的。

*   小部件的高度和宽度将以 300 像素为增量，最大为 900 像素。换句话说，一个小部件可以是：300 x 300、600 x 300、300 x 900、900 x 900 等等。

## 我打算建造什么

这是我希望构建的几个插图。

[![](../Images/df3f04613ee4cb8b36415a3d5e79ff3d.png)](https://i.imgur.com/hJbCx.jpg)

尺寸并不完美，但这显示了一个带有 9 个小部件的仪表板。所有小部件都很舒适，并尽其所能优雅地填充屏幕的宽度。但是，小部件不必形成完美的正方形或矩形。如下图所示，吊坠是可以的。

[![](../Images/f089e56b0932daf4e6f80cf8525724ad.png)](https://i.imgur.com/PGUQM.jpg)

请注意小部件的宽度和高度如何都以 300 像素为增量，如上述要求中所述。这应该有望使重新排序瓷砖的数学计算变得更容易。这让我想到了我的问题。

## 我的问题

我已经理解了这个概念，但我无法弄清楚从哪里开始。我不像我希望的那样精通数学，我需要一些帮助才能找到正确的方向。

如何从无特定顺序排序的一系列小部件（所有形状和大小）中获取到布局整齐、*绝对定位*的瓷砖网格，尽可能优雅地占用空间？

我如何从中得到：

[![](../Images/803c9b01f06421852f29668a47773ad2.png)](https://i.imgur.com/pZo8J.jpg)

对此：

[![](../Images/5aba4d8535ac4e5a5e8cdbfa964005b5.png)](https://i.imgur.com/PGUQM.jpg)

或者至少是一个同样优雅的布局。瓷砖不必位于上图所示的确切位置。我只是想让他们玩完美的俄罗斯方块游戏，并且没有尴尬的间隙就位。

![](../Images/7c8796fefadf9e8db9ef187f6afb6018.png)

* * *

我需要考虑浏览器窗口的宽度，然后以某种方式循环遍历小部件数组并开始将它们添加到某种虚拟网格中。我希望它看起来尽可能优雅。

然后，在解决了我在初始页面加载后如何在页面上排序小部件之后，我需要允许用户移动他/她的小部件并让其他小部件尽可能整齐地重新排序以适应移动的小部件的新位置. 如果重新调整浏览器的大小，我还需要一种优雅的方式来重新排序小部件。

我不期待成熟的解决方案或实现。我只需要*推动*我认为的正确方向。也许，一个简单的头脑风暴描述循环遍历小部件的逻辑以及计算什么东西来达到最佳配置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T14:54:56.703

在研究了 jQuery Masonry、jQuery isotope 甚至自定义块填充算法之后，我偶然发现了另一个 jQuery 插件，称为[jQuery Gridster](http://gridster.net/)，它完全符合我的要求。该插件有一些怪癖，而且不是很精致，但通过一些调整，我能够有效地使用它。

注意：这些怪癖之一是插件的 API。当您尝试使用插件 API 中的 remove 选项从网格中动态删除项目时，它会引发一大堆错误。这是某种竞争条件，因为它偶尔发生。该错误可能被遗漏了，因为当您使用 API 一次只删除一个项目时，它在 99% 的时间都有效。如果您快速连续删除多个项目（通过循环并多次调用 API，或者通过将包含多个元素的包装集传递给 remove 函数），那么您将收到一堆控制台错误。

我需要从网格中删除所有图块并重新加载一组新图块。使用 jQuery 删除调用 Gridster 的元素，然后从头开始重新调用插件，将新的瓦片集传递给它，这样会更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T00:47:22.270

你可以试试[jQuery Masonry 之](http://masonry.desandro.com)类的东西。看起来它至少可以解决您想要解决的一些问题。此外，为了获得一些灵感和一些代码，请查看 StackExchange 如何列出他们的 QA 站点：[https ://stackexchange.com/sites?view=grid](https://stackexchange.com/sites?view=grid)

# java - How to change an Imagebutton to an integer

> ID：11909005
> 
> 赞同：0
> 
> 时间：2012-08-10T20:45:23.673
> 
> 标签：java, android, imagebutton

basically I am trying to make a side scrolling game, with an an Image button, the reason why I am using the image button is because when the image of the person is clicked it double jumps, when the background is clicked, it jumps. but, I am getting a problem when trying to convert an imagebutton into an integer, how would I go about doing this? or is there a better way of doing things such as double clicking the background for a double jump ect.?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:48:34.227

There are much, much better ways to go about this. It would take a lot of unnecessary work to get your implementation to work correctly. What you want to do is draw an image on a Canvas and check touch events and see if they happened in the boundary of that image.

Look here: [http://www.javacodegeeks.com/2011/07/android-game-development-displaying.html](http://www.javacodegeeks.com/2011/07/android-game-development-displaying.html)

# antlr - 如何使用 ANTLR 树语法从树解析器中获取信息？

> ID：11909007
> 
> 赞同：2
> 
> 时间：2012-08-10T20:45:27.870
> 
> 标签：antlr

我已经成功构建了一个为我的语言创建 AST 的解析器/词法分析器。是的！！我现在进入“翻译”阶段。我用引号说解释器是因为该语言是声明性的，因为它并没有像程序语言那样真正被执行。它被翻译成 Java 对象，稍后在我的应用程序运行中使用。

当我走我的 AST 时，我需要将树节点转换为 Java 对象。这些 Java 对象在我的程序中的其他地方使用。我了解如何创建操作以创建 Java 对象，但是如何将操作的结果返回到我的主程序中？

我是否使用 @members{} 标签并在其中编写我的 getter 方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:11:48.143

> 我是否使用 @members{} 标签并在其中编写我的 getter 方法？

是的，这是一个选择。但是，（树）语法规则可以返回您的自定义对象，因此当您调用 tree walker（或解析器）的入口点时，会返回此自定义对象：

### 语法

```
tree grammar YourTreeWalker;

...

walk returns [CustomObject obj]
 : ... 
   {
     $obj = ...
   }
 ;

... 
```

### 代码中的其他地方

```
...
YourTreeWalker walker = new YourTreeWalker(...); 
CustomObject obj = walker.walk(); 
```

# coldfusion - 循环通过 Coldfusion 中另一个查询的 cfoutput 中的查询

> ID：11909014
> 
> 赞同：1
> 
> 时间：2012-08-10T20:45:59.103
> 
> 标签：coldfusion

我正在尝试编写一个函数，通过遍历与缺少图像的产品共享标题的任何产品来从产品的替代版本中查找图像（这些是书籍，因此任何具有相同“标题”的产品都可以使用） .

我首先运行查询以获取将在页面上显示的产品（我知道这部分工作正常，所以我不关心它）。当需要显示图像时，我首先检查是否有用于所选产品的图像。

如果没有可用的图像，我想对具有相同“标题”或“完整标题”的任何产品运行第二次查询，并查看它们是否有可用的图像。（这将是#SKU#.jpg，正如您在代码中看到的那样）如果找到其中一个替代版本的图像，我将其保存到一个变量中，一旦循环完成，我就会显示该选择的图像。

如果我仍然没有找到产品图片，它会显示我们默认的“图片不可用”图片。

```
<cfquery name="GetProductBasicInfo" datasource="#Request.Application.DataApp.datasource#" dbtype="odbc">
    SELECT product.Title, product.FullTitle, product.SKU, product.series, product.pubdate, productmarket.binding, product.productid, productmarket.productid
    FROM Product, productmarket
    WHERE product.productid = productmarket.productid 
        AND productmarket.Binding LIKE '#FORM.formFormat#' 
        AND product.series NOT IN ('Young Adult','childrens') 
        AND product.PubDate 
            BETWEEN '<cfoutput>#DatePart("m", FORM.formDate)#</cfoutput>/01/<cfoutput>#DatePart("yyyy", FORM.formDate)#</cfoutput>' 
            AND '<cfoutput>#DatePart("m", FORM.formDate)#</cfoutput>/28/<cfoutput>#DatePart("yyyy", FORM.formDate)#</cfoutput>' 
</cfquery> 

<cfoutput query="GetProductBasicInfo">
<!-- set of CFIF statements that determine if the current product has an image. If not, the following code is executed -->
    <cfquery name="altImages" datasource="#Request.Application.DataApp.datasource#" dbtype="odbc">
        SELECT product.SKU
        FROM Product
        WHERE product.title = '#Title#' OR product.fulltitle = '#FullTitle#'
    </cfquery>
    <cfset altPic = "">
    <cfloop query="altImages">
        <cfset altPicLocation = '#application.site.PWROOT#/client/products/prodimagetmb/#altImages.sku#.jpg'>
        <cfif FileExists(ExpandPath(altPicLocation)) eq 'true'>
             <cfset altPic = altPicLocation>
        </cfif>
    </cfloop>
    <cfif altPic NEQ "">
        <img src = "#altPic#" border = "0"> </a>
    <cfelse>
        <img src = "<cfoutput>#application.site.PWROOT#</cfoutput>/client/Products/prodimagedefault/tmbdefault/defaulttmb.jpg" border="0"> </a>
    </cfif>
</cfoutput> 
```

当我运行上面的代码时，我得到一个错误响应。由于“安全问题”，我不允许 Coldfusion 管理员通过或访问我正在开发的站点的错误日志（是的，我知道那是多么愚蠢）所以我不知道具体的错误我越来越。

编辑：错误已解决。这与我的第二个查询的格式和我已修复的错字有关。结果和我担心的一样低效，所以我仍然希望以某种方式简化它。

编辑：从每个请求的第一个查询中添加了代码。“产品”是一个绝对*庞大的*表格，包含我们公司销售的大约 20k 条产品记录，每个记录大约 35-40 列。Productmarket 是一个包含大约 40 列的关联表。

第一个查询按产品类型和发布日期搜索以定义页面内容。当给定产品不存在名称为#SKU#.jpg 的图像时，会触发第二个查询；它会搜索具有完全相同标题的任何其他产品（因为它是错误的产品类型，所以在第一次搜索中会被忽略）。如果存在这样的产品，它会检查#SKU#.jpg 是否*存在*。如果是，则将其分配给一个变量并代替原始变量使用。

# django - from _jcc import initVM DLL load failed: 找不到指定的模块

> ID：11909029
> 
> 赞同：2
> 
> 时间：2012-08-10T20:47:09.630
> 
> 标签：django, python-2.7, mod-wsgi, pylucene

嗨，我正在尝试将使用 Pylucene 从 DJANGO 开发服务器的工作 Django v1.3 应用程序移植到带有 mod_wsgi 的 Apache，它在同一台 Windows XP 机器上给出错误。

**来自 Django 调试的错误消息：**

> ViewDoesNotExist 在 /administration/feeds/
> 
> 无法导入 plunk4.feeds.views。错误是：DLL 加载失败：找不到指定的模块。
> 
> 请求方法：GET 请求 URL：localhost/administration/feeds/ Django 版本：1.3 异常类型：ViewDoesNotExist 异常值：
> 
> 无法导入 plunk4.feeds.views。错误是：DLL 加载失败：找不到指定的模块。
> 
> 异常位置：c:\Python27\lib\site-packages\django\core\urlresolvers.py in _get_callback，第 167 行 Python 可执行文件：C:\Program Files\Apache Software Foundation\Apache2.2\bin\httpd.exe Python 版本：2.7.1 Python 路径：
> 
> ['c:\Python27\lib\site-packages\south-0.7.3-py2.7.egg', 'c:\Python27\lib\site-packages\django_admin_tools-0.4.0-py2.7.egg' , 'c:\Python27\lib\site-packages\jcc-2.8-py2.7-win32.egg', 'c:\Python27\lib\site-packages\lucene-3.1.0-py2.7-win32.鸡蛋'，'c:\Python27\lib\site-packages\oauth2-1.5.170-py2.7.egg'，'c:\Python27\lib\site-packages\httplib2-0.7.2-py2.7。鸡蛋'，'c:\Python27\lib\site-packages\django_social_auth-0.6.0-py2.7.egg'，'c:\Python27\lib\site-packages\python_openid-2.2.5-py2.7。鸡蛋'，'c:\Python27\lib\site-packages\python_dateutil-1.5-py2.7.egg'，'c:\Python27\lib\site-packages\distribute-0.6.24-py2.7.egg' , 'c:\Python27\lib\site-packages\django_chronograph-0.2.0.dev-py2.7.egg', 'c:\Python27\lib\site-packages\pyofc2-0.1.5dev-py2.7.egg'、'c:\Python27\lib\site-packages\anyjson-0.3.1-py2.7.egg'、'c:\Python27\lib\site-packages\django_pagination-1.0.7-py2。 7.egg'、'c:\Python27\lib\site-packages\gdata-2.0.17-py2.7.egg'、'c:\Python27\lib\site-packages\flickrapi-1.4.2-py2。 7.egg'、'c:\Python27\lib\site-packages\threadpool-1.2.7-py2.7.egg'、'c:\Python27\Lib'、'c:\test\git_repo\src'、 'c:\test\git_repo\src\plunk4', 'c:\test\git_repo\src\plunk4\feeds', 'C:\Python27\Lib\site-packages\lucene-3.1.0-py2.7- win32.egg\lucene', 'C:\Python27\Lib\site-packages\lucene-3.1.0-py2.7-win32.egg\lucene\lib', 'C:\Program Files\Java\jdk1.6.0 _30\jre\bin'、'C:\Program Files\Java\jdk1.6.0_30\jre\bin\client'、'C:\Program Files\Apache Software Foundation\Apache2.2', 'C:\WINDOWS\system32\python27.zip', 'c:\Python27\DLLs', 'c:\Python27\lib\plat-win', 'c:\Python27\lib\lib-tk' , 'C:\Program Files\Apache Software Foundation\Apache2.2\bin', 'c:\Python27', 'c:\Python27\lib\site-packages']
> 
> 服务器时间：2012年8月10日星期五13:14:36 -0700

**这是apache error.log**

> [2012 年 8 月 10 日星期五 13:03:03] [警告] mod_wsgi：为 Python/2.7 编译。[2012 年 8 月 10 日星期五 13:03:03] [警告] mod_wsgi：运行时使用 Python/2.7.1。[2012 年 8 月 10 日星期五 13:03:03] [通知] Apache/2.2.22 (Win32) mod_wsgi/3.3 Python/2.7.1 已配置 -- 恢复正常操作 [2012 年 8 月 10 日星期五 13:03:03] [通知]服务器构建：2012 年 1 月 28 日 11:16:39 [2012 年 8 月 10 日星期五 13:03:03] [通知] 父级：创建子进程 6780 [2012 年 8 月 10 日星期五 13:03:03] [警告] mod_wsgi：为 Python 编译/2.7。[2012 年 8 月 10 日星期五 13:03:03] [警告] mod_wsgi：运行时使用 Python/2.7.1。[Fri Aug 10 13:03:03 2012] [notice] Child 6780：子进程正在运行 [Fri Aug 10 13:03:04 2012] [notice] Child 6780：获得启动互斥锁。[Fri Aug 10 13:03:04 2012] [notice] Child 6780：启动 64 个工作线程。[Fri Aug 10 13:03:04 2012] [通知] 儿童 6780：启动线程以侦听端口 80。 [Fri Aug 10 13:03:45 2012] [error] [client 127.0.0.1] mod_wsgi (pid=6780): Target WSGI script 'C:/temp/wsgi_test.py' cannot be作为 Python 模块加载。[2012 年 8 月 10 日星期五 13:03:45] [错误] [客户端 127.0.0.1] mod_wsgi (pid=6780)：处理 WSGI 脚本“C:/temp/wsgi_test.py”时发生异常。[2012 年 8 月 10 日星期五 13:03:45] [错误] [客户端 127.0.0.1] 回溯（最近一次通话最后）：[2012 年 8 月 10 日星期五 13:03:45] [错误] [客户端 127.0.0.1] 文件“ C:/temp/wsgi_test.py"，第 8 行，在 [Fri Aug 10 13:03:45 2012] [error] [client 127.0.0.1] 1] mod_wsgi (pid=6780): 处理 WSGI 脚本 'C:/temp/wsgi_test.py' 时发生异常。[2012 年 8 月 10 日星期五 13:03:45] [错误] [客户端 127.0.0.1] 回溯（最近一次通话最后）：[2012 年 8 月 10 日星期五 13:03:45] [错误] [客户端 127.0.0.1] 文件“ C:/temp/wsgi_test.py"，第 8 行，在 [Fri Aug 10 13:03:45 2012] [error] [client 127.0.0.1] 1] mod_wsgi (pid=6780): 处理 WSGI 脚本 'C:/temp/wsgi_test.py' 时发生异常。[2012 年 8 月 10 日星期五 13:03:45] [错误] [客户端 127.0.0.1] 回溯（最近一次通话最后）：[2012 年 8 月 10 日星期五 13:03:45] [错误] [客户端 127.0.0.1] 文件“ C:/temp/wsgi_test.py"，第 8 行，在 [Fri Aug 10 13:03:45 2012] [error] [client 127.0.0.1]
> 导入 jcc [2012 年 8 月 10 日星期五 13:03:45] [错误] [客户端 127.0.0.1]
> 文件“c:\Python27\lib\site-packages\jcc-2.8-py2.7-win32.egg\jcc\__init__ .py”，第 34 行，在 [Fri Aug 10 13:03:45 2012] [error] [client 127.0.0.1] from _jcc import initVM [Fri Aug 10 13:03:45 2012] [error] [client 127.0\. 0.1] ImportError：DLL加载失败：找不到指定的模块。

**Lucene 似乎可以在 Python Shell 中工作：**

```
C:\Documents and Settings\Carlos>python
Python 2.7.1 (r271:86832, Nov 27 2010, 18:30:46) [MSC v.1500 32 bit (Intel)] on
win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import jcc
>>> import lucene
>>> lucene.initVM()
<jcc.JCCEnv object at 0x00AC67C0>
>>> lucene.VERSION
'3.1.0' 
```

**这是 python -m jcc.__main__ 的输出**

```
 JCC - C++/Python Java Native Interface Code Generator

  Usage: python -m jcc.__main__ [options] [actions]

  Input options:
    --jar JARFILE           - make JCC wrap all public classes found in
                              JARFILE, add it to the module's CLASSPATH and
                              include it in the distribution
.... 
```

为了证明 mod_WSGI 安装正确：我在下面创建了 ac:\temp\wsgi_test.py 文件：

```
import sys

sys.path.append('C:/Python27/Lib/site-packages')
sys.path.append('C:/Python27/Lib/site-packages/lucene-3.1.0-py2.7-win32.egg/lucene')
sys.path.append('C:/Python27/Lib/site-packages/lucene-3.1.0-py2.7-win32.egg/lucene/lib')
sys.path.append('C:/Python27/Lib/site-packages/JCC-2.8-py2.7-win32.egg/jcc.dll')

def application(environ, start_response):
    status = '200 OK'

    output = ''
    output += 'sys.version = %s\n' % repr(sys.version)
    output += 'sys.prefix = %s\n' % repr(sys.prefix)
    output += 'sys.path = %s' % repr(sys.path)
    output += 'wsgi.multithread = %s' % repr(environ['wsgi.multithread'])
    output += 'mod_wsgi.process_group = %s' % repr(environ['mod_wsgi.process_group']) 

    response_headers = [('Content-type', 'text/plain'),
                        ('Content-Length', str(len(output)))]
    start_response(status, response_headers)

    return [output] 
```

它返回：

> sys.version = '2.7.1 (r271:86832, Nov 27, 2010, 18:30:46) [MSC v.1500 32 bit (Intel)]' sys.prefix = 'c:\Python27' sys.path = [ 'c:\Python27\lib\site-packages\south-0.7.3-py2.7.egg', 'c:\Python27\lib\site-packages\django_admin_tools-0.4.0-py2.7.egg', 'c:\Python27\lib\site-packages\jcc-2.8-py2.7-win32.egg', 'c:\Python27\lib\site-packages\lucene-3.1.0-py2.7-win32.egg ', 'c:\Python27\lib\site-packages\oauth2-1.5.170-py2.7.egg', 'c:\Python27\lib\site-packages\httplib2-0.7.2-py2.7.egg ', 'c:\Python27\lib\site-packages\django_social_auth-0.6.0-py2.7.egg', 'c:\Python27\lib\site-packages\python_openid-2.2.5-py2.7.egg ', 'c:\Python27\lib\site-packages\python_dateutil-1.5-py2.7.egg', 'c:\Python27\lib\site-packages\distribute-0.6.24-py2.7.鸡蛋'，'c:\Python27\lib\site-packages\django_chronograph-0.2.0.dev-py2.7.egg'，'c:\Python27\lib\site-packages\pyofc2-0.1.5dev-py2。 7.egg'、'c:\Python27\lib\site-packages\anyjson-0.3.1-py2.7.egg'、'c:\Python27\lib\site-packages\django_pagination-1.0.7-py2。 7.egg'、'c:\Python27\lib\site-packages\gdata-2.0.17-py2.7.egg'、'c:\Python27\lib\site-packages\flickrapi-1.4.2-py2。 7.egg'、'c:\Python27\lib\site-packages\threadpool-1.2.7-py2.7.egg'、'c:\Python27\Lib'、'c:\test\git_repo\src'、 'c:\test\git_repo\src\plunk4', 'c:\test\git_repo\src\plunk4\feeds', 'C:\Python27\Lib\site-packages\lucene-3.1.0-py2.7- win32.egg\lucene', 'C:\Python27\Lib\site-packages\lucene-3.1.0-py2.7-win32.egg\lucene\lib', 'C:\Program Files\Java\jdk1.6.0_30\jre\bin'，'C:\Program Files\Java\jdk1.6.0_30\jre\bin\client'，'C:\Program Files\Apache Software Foundation\Apache2\. 2', 'C:\WINDOWS\system32\python27.zip', 'c:\Python27\DLLs', 'c:\Python27\lib\plat-win', 'c:\Python27\lib\lib-tk' , 'C:\Program Files\Apache Software Foundation\Apache2.2\bin', 'c:\Python27', 'c:\Python27\lib\site-packages', 'C:/Python27/Lib/site-packages ', 'C:/Python27/Lib/site-packages/lucene-3.1.0-py2.7-win32.egg/lucene', 'C:/Python27/Lib/site-packages/lucene-3.1.0-py2 .7-win32.egg/lucene/lib', 'C:/Python27/Lib/site-packages/JCC-2.8-py2.7-win32.egg/jcc.dll', 'C:/Python27/Lib/site -packages'，'C:/Python27/Lib/site-packages/lucene-3.1.0-py2.7-win32。egg/lucene', 'C:/Python27/Lib/site-packages/lucene-3.1.0-py2.7-win32.egg/lucene/lib', 'C:/Python27/Lib/site-packages/JCC- 2.8-py2.7-win32.egg/jcc.dll']wsgi.multithread = Truemod_wsgi.process_group =''

**我尝试了以下参考来解决问题：** [http ://code.google.com/a/apache-extras.org/p/pylucene-extra/wiki/PyLucene](http://code.google.com/a/apache-extras.org/p/pylucene-extra/wiki/PyLucene)

[Apache 无法导入/没有名为 Django 的模块错误](https://stackoverflow.com/questions/1656159/could-not-import-no-module-named-django-error-with-apache)

[lists.osafoundation.org/pipermail/pylucene-dev/2007-November/002070.html](http://lists.osafoundation.org/pipermail/pylucene-dev/2007-November/002070.html)

[grokbase.com/t/lucene/pylucene-dev/125t3g2ph6/jcc-dll-loading-error](http://grokbase.com/t/lucene/pylucene-dev/125t3g2ph6/jcc-dll-loading-error)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-18T19:27:02.587

解决方案是改用 Apache Solr。这使我可以将 REST 服务从 Python 调用到 Lucene 索引，而无需尝试让 Python 调用 Java/Lucene。

# c# - 位于“地址”的 HTTP 服务太忙

> ID：11909032
> 
> 赞同：2
> 
> 时间：2012-08-10T20:47:30.583
> 
> 标签：c#, wcf

我正在使用 WCF 将图像从服务器连续流式传输到客户端。但是，每当我尝试运行它时，我总是会收到此错误：

> 位于“这里的本地主机地址”的 HTTP 服务太忙。

我在网上到处找，并尝试了其他解决方案。我尝试过节流、增加缓冲区大小和更改传输模式均无济于事。我对 WCF 很陌生，不知道还能去哪里。如果有人知道如何摆脱这个错误，我将不胜感激。谢谢！这是我所有的代码。

应用程序配置：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
<system.serviceModel>
    <bindings>
        <basicHttpBinding>
            <binding name="BasicHttpBinding_VisionWcfInterface" closeTimeout="00:01:00"
                openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
                allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
                maxBufferSize="2147483647" maxBufferPoolSize="2147483647" maxReceivedMessageSize="2147483647"
                messageEncoding="Text" textEncoding="utf-8" transferMode="Streamed"
                useDefaultWebProxy="true">
                <readerQuotas maxDepth="2147483647" maxStringContentLength="2147483647" maxArrayLength="2147483647"
                    maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647" />
                <security mode="None">
                    <transport clientCredentialType="None" proxyCredentialType="None"
                        realm="" />
                    <message clientCredentialType="UserName" algorithmSuite="Default" />
                </security>
            </binding>
        </basicHttpBinding>
    </bindings>
  <behaviors>
    <serviceBehaviors>
      <behavior>
        <serviceMetadata httpGetEnabled="true"/>
        <serviceDebug includeExceptionDetailInFaults="true"/>
        <serviceThrottling maxConcurrentCalls="16" maxConcurrentInstances="2147483647" maxConcurrentSessions="10"/>
      </behavior>
    </serviceBehaviors>
  </behaviors>
    <client>
        <endpoint address="http://localhost:8002/Visual/service" binding="basicHttpBinding"
            bindingConfiguration="BasicHttpBinding_VisionWcfInterface"
            contract="VisionWcfInterface" name="BasicHttpBinding_VisionWcfInterface" />
    </client>
</system.serviceModel>
</configuration> 
```

Client.cs 文件和 ClientWCF 函数：

```
public Form1()
{
    private VisionWcfClient client = new VisionWcfClient();
    client.Connect();
    pictureBox2.Image = ConvertByteArrayToImage(client.GetVideoStream());
}

public byte[] GetVideoStream()
{
    return m_clientProxy.GetVideoStream();
} 
```

Server.cs 文件和 ServerWCF 函数：

```
public byte[] GetVideoStream()
{
    return GetVideoStreamEvent();
}

byte[] ads_GetVideoStreamEvent()
{
    IntPtr pointer;

    m_Buffers.GetAddress(out pointer);

    Bitmap b = new Bitmap(m_Buffers.Width, m_Buffers.Height, m_Buffers.Pitch, System.Drawing.Imaging.PixelFormat.Format8bppIndexed, pointer);
    System.Drawing.Imaging.ColorPalette palette = b.Palette;
    Color[] entries = palette.Entries;
    for (int i = 0; i < 256; i++)
        entries[i] = Color.FromArgb(255, i, i, i);

    b.Palette = palette;
    m_Buffers.ReleaseAddress(pointer);
    using (MemoryStream ms = new MemoryStream())
    {
        b.Save(ms, ImageFormat.Bmp);
        return ms.ToArray();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-18T20:40:31.830

我有同样的问题......问题是链接到我的服务运行的应用程序池的帐户的密码已更改。

将 AppPool 与有效凭证关联后，服务又开始正常运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:21:27.613

您说您正在“持续”流式传输图像，这是否意味着您正在循环执行此操作？

* * *

更新：我建议您打开 WCF 跟踪以帮助确定问题。在此处查看此信息：

[http://msdn.microsoft.com/en-us/library/ms733025.aspx](http://msdn.microsoft.com/en-us/library/ms733025.aspx)

另外，您在服务方法和接口上定义的服务属性是什么？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-10T23:55:47.390

弄清楚了。我将端口号从 8002 更改为 8003 并且它工作。不知道为什么，但只要它有效，我不在乎。

# c# - 将文件字节从 C# 序列化到 SQL Server 并再次返回

> ID：11909033
> 
> 赞同：2
> 
> 时间：2012-08-10T20:47:31.940
> 
> 标签：c#, sql

我有一个应用程序，我将文件字节分块并将每个块存储在数据库中（我正在记录每个块的信息）。然后，我尝试从数据库中检索这些块，将它们重新放在 C# 中并写入文件。

目前，我有以下 C# 代码：

```
string encoded = GetBase64EncodedFile();  // This is just for readability
byte[] fileBytes = Convert.FromBase64String(encoded).ToList().ToArray();

Database database = DatabaseFactory.CreateDatabase();
using (DbCommand command = database.GetStoredProcCommand("SaveFileChunk"))
{
  database.AddInParameter(command, "fileName", DbType.String, fileName);
  database.AddInParameter(command, "offset", DbType.Int32, offset);
  database.AddInParameter(command, "number", DbType.Int32, number);
  database.AddInParameter(command, "chunkBytes", DbType.Binary, fileBytes);

  database.ExecuteNonQuery(command);
} 
```

此时，如果我打印出 fileBytes.Count()，我看到：152754

记录被写入具有以下结构的 SQL Azure 表：

```
FileChunk
---------
Filename nvarchar(max)
Offset int
Number int
ChunkBytes varbinary(max) 
```

后来，我尝试使用以下查询接收文件块：

```
SELECT * FROM [FileChunk] ORDER BY [Number] 
```

然后我尝试填充我的 FileChunk CLR 对象，如下所示：

```
public FileChunk(IDataReader reader)
{
  fileName = reader["Filename"].ToString();
  offset = Convert.ToInt32(reader["Offset"].ToString());
  number = Convert.ToInt32(reader["Number"].ToString());
  chunkBytes = reader["ChunkBytes"].ToString().ToCharArray().Select(c => (byte)c).ToArray();
} 
```

当我执行这段代码时，我了解到上面的 chunkBytes.Count() 是 13。

这意味着我有某种序列化或数据类型转换错误。但是，我没有看到。我该如何 a) 将字节放入 SQL Azure b) 将它们取出

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:51:04.993

只需`reader["ChunkBytes"]`转换为字节数组。

不必调用`ToString()`阅读器的每个字段，然后将其转换为实际类型。它极大地损害了性能 - 您可以直接将整数转换为`int`、 varchars 等，`string`并将二进制字段转换为`byte[]`：

```
public FileChunk(IDataReader reader)
{
    fileName = (string)reader["Filename"];
    offset = (int)reader["Offset"];
    number = (int)reader["Number"];
    chunkBytes = (byte[])reader["ChunkBytes"];
} 
```

作为旁注 - 您是否有特定的理由使用 ADO.NET 而不是一些 ORM 解决方案，如 LINQ to SQL 或实体框架？在编写了我的 ADO.NET 代码之后，我现在只会将它用于非常具体的项目——例如，当您需要手动创建语句时。

# javascript - 在 Jquery 追加后立即渲染 html

> ID：11909040
> 
> 赞同：1
> 
> 时间：2012-08-10T20:48:24.427
> 
> 标签：javascript, jquery, loops, append

我有一个看起来像这样的循环

```
for(i = 0; i < 50000; i++){
    $('body').append("<div>lol</div>');
} 
```

在 Opera 浏览器中，我可以在屏幕中看到内容“lol”的元素 div。

但在 Chrome、Firefox、IE 等中，我只能在循环到达结束时看到 div

如何强迫他们使用 Js/Jquery 或 POG 的其他客户端解决方案使用 Opera 工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T20:52:46.600

首先，这是非常糟糕的做法。每个附加都会强制重新布局并像蛋糕一样吃掉性能。

也就是说，运行循环会停止 UI 更新。所以只需使用“异步循环”，一个带有超时调用的自引用函数，以允许 UI 刷新。

```
var i = 5000;
var countdown = function () {
    $("body").append("<div></div>");
    if (i > 0) {
        i--;
        window.setTimeout(countdown, 0);
    }
}
countdown(); 
```

编辑：添加了实际的函数调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:55:40.153

使用带有 setTimeout 的递归函数。setTimeout 允许浏览器在 DOM 更新之间更新 UI。

```
function appendDiv(iteration, iterationLimit) {
   $('body').append('<div></div>');
   if(iteration <= iterationLimit) {
      window.setTimeout(appendDiv, 1, iteration + 1, iterationLimit);
   }
} 
```

# java - 整理从 PDF 中提取的图像

> ID：11909045
> 
> 赞同：0
> 
> 时间：2012-08-10T20:48:47.050
> 
> 标签：java, pdf, pdfbox

我有一段代码可以从 PDF 中收集图像并使用 pdfBox 将它们保存在文件夹中。这些图像是无用的，因为我对它们一无所知。PDF 包含章节标题，后跟 1-3 张图片。无论如何要更改程序，以便它会告诉我他们来自哪个部分？

这是代码：

```
public static void main(String[] args) throws IOException {

        PDDocument document = null; 
        try {
            document = PDDocument.load("C:\\Users\\564864\\Downloads\\wsh2012.pdf");
        } catch (IOException ex) {
            System.out.println("" + ex);
        }
        List pages = document.getDocumentCatalog().getAllPages();
        Iterator iter = pages.iterator(); 
        int i =1;
        String name = null;

        while (iter.hasNext()) {
            PDPage page = (PDPage) iter.next();
            PDResources resources = page.getResources();
            Map pageImages = resources.getImages();
            if (pageImages != null) { 
                Iterator imageIter = pageImages.keySet().iterator();
                while (imageIter.hasNext()) {
                    String key = (String) imageIter.next();
                    PDXObjectImage image = (PDXObjectImage) pageImages.get(key);
                    image.write2file("C:\\Users\\564864\\Desktop\\Java\\helloworld\\images\\" + i+"");
                    i ++;
                }
            }
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T07:57:52.907

除非 PDF 包含其他元数据，否则 PDF 中没有任何部分。[我在http://www.jpedal.org/PDFblog/2012/06/extracting-structured-text-from-pdf-files/](http://www.jpedal.org/PDFblog/2012/06/extracting-structured-text-from-pdf-files/)上写了一篇关于结构化文本（同样适用于图像）的文章

# delphi - 我的自定义组件应该来自 TDataModule 吗？

> ID：11909048
> 
> 赞同：2
> 
> 时间：2012-08-10T20:49:09.927
> 
> 标签：delphi, delphi-xe

我想构建一个自定义组件来管理一堆操作并触发几个事件。我将需要管理数据库连接和其他几个设计时组件。（TQuery、TTable 等）我想使用 IDE 接口来设置其中一些对象。

想法：

1.  当我设计组件时，是否以同样的方式从 DataModule 继承给了我放置这些组件的地方？（我怀疑不是，但是有没有办法让我的 CustomComponent 在设计时表现得像 DataModule，但在使用时却不行？）
2.  我是否应该让我的自定义组件简单地从 TComponent 继承，但包含一个 TDataModule 对象并将我需要的组件添加到它？
3.  我应该打包这个概念并手动创建我需要的组件吗？
4.  你的解决方案因为你比我聪明。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T21:48:25.543

我建议您完全忘记尝试在视觉上设计组件。它是一个非可视组件，因此只需从中派生`TComponent`并让它根据需要创建/管理数据库组件。根本不需要使用 a `TDataModule`。这应该留给最终用户在他们自己的项目中使用，而不是让组件作者在他们的非可视组件中使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T21:09:43.570

不，原因很简单：Delphi XE 的 IDE 中存在一个错误，导致表单设计器将继承自 TDataModule 的类视为继承自 TForm。这意味着一堆与 TForm 相关的属性将被写入您的 DFM，当它尝试加载数据模块时，最终会在运行时引发异常。

如果不是因为这个错误，那将是一个好主意。

# java - 如何让 java 客户端使用自定义登录模块连接到 JBoss 7 服务器

> ID：11909049
> 
> 赞同：1
> 
> 时间：2012-08-10T20:49:09.867
> 
> 标签：java, security, ejb, jboss7.x

我一直在浏览 Picketbox 示例： [https ://community.jboss.org/wiki/JBossAS7SecurityCustomLoginModules](https://community.jboss.org/wiki/JBossAS7SecurityCustomLoginModules)

我可以通过war文件（使用网络浏览器）让整个示例工作并登录。但我的问题是该示例没有解释如何使用简单的 java 应用程序登录。

war 文件（form-auth.war）有一个 jboss-web.xml 文件，它指定了安全域：form-auth，这似乎很关键，如果是，我在哪里可以从 java 应用程序中指定它？

如果war文件中的代码可以通过浏览器登录，那么一定可以让java客户端应用程序来做同样的事情。我可能需要调试/查找war文件是如何执行的，以确定它如何成功登录到JBoss。

# flash - 是否可以使用 jsfl 从 flash 库中导出声音文件？

> ID：11909053
> 
> 赞同：1
> 
> 时间：2012-08-10T20:49:32.237
> 
> 标签：flash, export, jsfl

我发现这个脚本似乎可以满足我的需要，但是，当我尝试导出文件时，我得到“文件名：假”作为输出。任何想法？

[http://cookbooks.adobe.com/post_Extract_bitmaps_and_audio_from_a_FLA_file-18144.html](http://cookbooks.adobe.com/post_Extract_bitmaps_and_audio_from_a_FLA_file-18144.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:41:40.103

花了我一点时间，但我发现了你的问题。问题在于您的声音文件的这个小属性：`soundItem.originalCompressionType`. [您可以在此处找到该问题的一些详细信息](http://help.adobe.com/en_US/flash/cs/extend/WSDB63C432-5816-4c62-94B9-5B3DE6DF137A.html)。您的代码中发生的事情是它将尝试将声音文件导出为存储在库中的类型。即filename.mp3 保存为.mp3 文件，filename.wav 保存为.wav 文件。如果`soundItem.originalCompressionType`等于“RAW”，则无法将声音文件保存为 .mp3 文件，因此会输出“filename: false”。您必须将文件另存为 .wav 文件。在定义 imageFileURL 时，我稍微修改了代码来执行此操作。

```
// Result of attempts to export will go to the output panel,
// so clear that first fl.outputPanel.clear();

// If bitmaps/audio in the library have been selected, export only
// those. Otherwise, export all bitmaps/audio in the library.

var lib;
if (fl.getDocumentDOM().library.getSelectedItems().length > 0) {
    lib = fl.getDocumentDOM().library.getSelectedItems(); 
} else { lib = fl.getDocumentDOM().library.items; } 

// Get destination directory for files 
var imageFileURLBase = fl.browseForFolderURL("Select a folder."); 
var imageFileURL; 

var totalItems = lib.length;
// Iterate through items and save bitmaps and 
// audio files to the selected directory.
for (var i = 0; i < totalItems; i++) 
{
    var libItem = lib[i];
    if (libItem.itemType == "bitmap" || libItem.itemType == "sound") 
    {
        // Check the audio files original Compression Type if "RAW" export only as a .wav file
        // Any other compression type then export as the libItem's name defines.
        if(libItem.itemType == "sound" && libItem.originalCompressionType == "RAW")
        {
            wavName = libItem.name.split('.')[0]+'.wav';
            imageFileURL = imageFileURLBase + "/" + wavName;
        } else {
            imageFileURL = imageFileURLBase + "/" + libItem.name;
        }
        var success = libItem.exportToFile(imageFileURL);
        fl.trace(imageFileURL + ": " + success);
    }
} 
```

# ios - ios - 如何在将 UITabBarController 添加到应用程序后进行渲染？

> ID：11909054
> 
> 赞同：0
> 
> 时间：2012-08-10T20:49:33.620
> 
> 标签：ios, ios5, uitabbarcontroller

我使用情节提要将 UITabBarController 添加到应用程序，并将其连接到我希望用户能够跳转到的现有视图。

但我有点困惑如何让底部的tas出现在每个屏幕上？我错过了什么步骤？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:11:57.733

标签栏控制器应该是您窗口的根视图控制器（iOS 应用程序中通常只有一个窗口）。任何其他视图控制器都应作为标签栏控制器的子级添加（使用 setViewControllers:)。您将一个视图控制器添加到每个选项卡的 viewControllers 数组中。添加它们的顺序决定了选项卡的顺序。标签栏控制器在每个屏幕的底部显示标签，而这些子视图控制器在标签上方显示视图。

# oracle - NHibernate Oracle Single 不正确的精度

> ID：11909055
> 
> 赞同：0
> 
> 时间：2012-08-10T20:49:37.580
> 
> 标签：oracle, fluent-nhibernate

我正在使用 Oracle9i 和 NHibernate 3.1.0.4 和 FluentNhibernate 1.2.0.712

NHibernate 配置如下...

```
<property name="dialect">NHibernate.Dialect.Oracle9iDialect</property>
      <property name="connection.driver_class">NHibernate.Driver.OracleClientDriver</property>
      <property name="connection.connection_string">Data Source=ORA9TEST;User ID=NOPE;Password=NOPE;</property>
      <property name="query.substitutions">true=1;false=0</property>
      <property name="show_sql">true</property> 
```

它生成这个插入状态

```
2012-08-10 16:33:36,380 [DEBUG] 15  NHibernate.SQL                      - 

INSERT INTO FACT_Data (STime, subg_number, subg_index, measurement, Rj, InvalidSpec, data_uid, WrittenState, dept_id, specs_id, data_id) VALUES (:p0, :p1, :p2, :p3, :p4, :p5, :p6, :p7, :p8, :p9, :p10);:p0 = 2/7/2012 12:49:57 AM [Type: DateTime (0)], :p1 = 103 [Type: Int32 (0)], :p2 = 0 [Type: Int32 (0)], :p3 = 30.346 [Type: Single (0)], :p4 = 0 [Type: Single (0)], :p5 = False [Type: Boolean (0)], :p6 = 0 [Type: Int32 (0)], :p7 = 0 [Type: Int32 (0)], :p8 = 2 [Type: Int32 (0)], :p9 = 45423 [Type: Int32 (0)], :p10 = 1178436 [Type: Int32 (0)] 
```

FACT_Data.Measurement 列的类型为 NUMBER(*,6)

当我读回该行时，测量值不是 30.346，而是 30.346001。如果没有额外的 0.000001，我该怎么做才能正确存储我的 Single 值？

谢谢，麻烦您了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T09:50:08.660

如果您需要这种精度，您应该使用 Decimal 而不是 Single。

您可以在此处找到有关浮点类型的更多信息：[十进制与双精度！- 我应该使用哪一个以及何时使用？](https://stackoverflow.com/questions/1165761/decimal-vs-double-which-one-should-i-use-and-when)

# java - 为什么我的组件没有包裹在 Swing 的 FlowLayout 中？

> ID：11909058
> 
> 赞同：2
> 
> 时间：2012-08-10T20:49:51.237
> 
> 标签：java, swing, flowlayout

为什么我的组件没有使用 FlowLayout 包装在这个 JPanel 中？他们只是跑出屏幕，只是部分可见。

```
JPanel panel = new JPanel(new FlowLayout());
panel.add(new JLabel("TEST"));
// ... repeat adding JLabels until they go off screen when they SHOULD wrap
// to the next line... 
```

这就是我的全部代码（除了添加和打包框架）。我误解了FlowLayout吗？我是否必须在标签或面板上设置某种尺寸？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-10T21:23:04.417

那是因为`FlowLayout`没有。我知道，这很糟糕。

但是，你可以看看[WrapLayout](http://tips4java.wordpress.com/2008/11/06/wrap-layout/)这是一个解决这个问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-10-29T01:40:16.763

我知道这是一个老问题，但我在尝试解决同样的问题时偶然发现了它。FlowLayout 不会包装其子组件并不完全正确。

问题是具有所需 FlowLayout 的 JPanel 必须位于另一个容器内，该容器将调整大小并*允许*FlowLayout 也调整大小并因此换行。根据我的经验， BorderLayout 的 CENTER 区域是唯一允许这种情况发生的容器。

# php - PHP 在带有参数的服务器上运行可执行文件

> ID：11909061
> 
> 赞同：1
> 
> 时间：2012-08-10T20:50:26.167
> 
> 标签：php, windows, python-2.7

我这里有点乱。

Windows Server 2008 R1 + IIS6 + PHP5.3.10

我有一个 PHP 脚本，它连接到一个小型本地 mssql 数据库，执行搜索并将结果放入变量中。db 中有 6 列，但其中只有 4 列值得通过。

我在这台服务器上有一个控制台 python 程序（2.7 版本）。它需要 4 个参数（目标电子邮件地址、主题、正文和键（键是 64 个字母数字字符串）。然后这个 Python 程序将所有这些放入一个 HTML 模板（在程序本身中定义）并通过电子邮件将其发送到目标。

好的 - 这两个都单独工作！现在有趣的部分。我是否可以让 PHP 启动这个 python 程序，它与 php 脚本位于同一目录中并传递四个参数/参数给它？参数/参数中可能有空格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:53:16.363

您正在寻找[Exec](http://php.net/manual/en/function.exec.php)。它将在控制台上运行命令并返回最后一行输出。如果您想要所有输出，可选的第二个参数将为您提供。

正如 Erty 所说，清理您的输入。永远不要将用户提供的数据直接传递到命令行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:55:30.263

您可能想要使用`exec()`或`shell_exec()`运行您的 python 脚本。也可以使用`escapeshellarg()`和`escapeshellcmd()`酌情清理您的输入。这可能看起来像这样：

```
$escaped_cmd = escapeshellcmd('nameofexecutable.exe para1 para2 para3');
exec($escaped_cmd); 
```

当然，您需要适当的权限才能运行可执行文件。

# python - 使用 poll() 方法（在 opensuse 中）运行 python 模块时，终端显示返回值为 None？

> ID：11909065
> 
> 赞同：0
> 
> 时间：2012-08-10T20:51:17.657
> 
> 标签：python, opensuse, subprocess

我正在为流行的 linux 版本（RHEL、opensuse、ubuntu 等）创建一个强化工具。我目前正在使用 zypper 包管理器在 OpenSUSE 环境中测试我的代码。

我有这段代码：

```
message = subprocess.Popen(["/usr/bin/zypper","-n","install","vlock"],
  stdout=subprocess.PIPE,shell = False) 
details = message.stdout.readlines()
print message.poll() 
```

这将安装包，在本例中为 vlock，然后从 shell 读取输出，然后打印成功值，该值将是 0 或非零数字。当我在 python 解释器中运行这段代码时，我可以打印 message.poll() 或 echo $? 如果我在解释器之外运行命令，我得到一个 0 表示成功，或者一个非零表示失败。

但是，当我实际从 shell 运行完整的单元测试脚本时：

```
sudo ./pkghelper.py 
```

我打印出 message.poll() 值，该值应该与打印 message.poll() 或 echo $？但是，我得到的值不是 0 或非零的整数，而是 None。有谁知道为什么python解释器中的值是整数而运行脚本时的值是None？！？！这实际上是程序继续开发的主要障碍，我可以在网上找到任何东西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:44:06.483

该值是`None`进程运行时的值，如果它没有错误退出，它将为 0。由于您在解释器中调用它，因此该过程已经完成并以返回码 0 退出。但是，当您将其作为脚本运行时，python 的运行速度比调用完成的速度快（并且它不会等待call)，所以它得到一个 None，表示该进程仍在运行。[子流程](http://docs.python.org/library/subprocess.html)文档对此进行了解释。

# django - 在 django 日期时间上使用 strftime 会在字符串中生成 UTC 时间

> ID：11909071
> 
> 赞同：19
> 
> 时间：2012-08-10T20:51:51.310
> 
> 标签：django, django-models, django-templates

我的一个模型中有以下代码：

```
def shortDescription(self):
    return self.name + ' ' + self.class_date.strftime("%I:%M") 
```

`self.class_date`是时区意识`DateTimeField`，`self.class_date.is_aware()`是`True`，`USE_TZ`是`True`。

shortDescription 返回一个字符串，该字符串以 UTC 而非默认时区给出时间，放入`{{ aclass.class_date }}`模板中会显示正确时区的时间。

总是`strftime`在基地工作，本地时间？或者这里发生了什么？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-08-10T21:09:01.407

当您直接引用日期时间的片段时`%I`，`%M`它会直接使用它，因为它没有进行语言环境转换。如果您包括在内`%Z`，您会看到时间在`UTC`. 如果您想要了解区域设置的结果，则需要使用 more limited `%X`，它只会吐出为区域设置转换的完整时间。

如果您需要更多，则必须对其进行转换：

```
from django.utils import timezone

def shortDescription(self):
    class_date = timezone.localtime(self.class_date)
    return self.name + ' ' + class_date.strftime("%I:%M") 
```

或者，您可以依赖`date`过滤器，它会自动为您执行此操作：

```
from django.template import defaultfilters

def shortDescription(self):
    return self.name + ' ' + defaultfilters.date(self.class_date, 'g:i') 
```

# c# - 应用程序挂起 XMLString = client.DownloadString(rootURL + basePolicyNumber);

> ID：11909073
> 
> 赞同：0
> 
> 时间：2012-08-10T20:52:11.673
> 
> 标签：c#, http, client, downloadstring

我在一个目录中有两张图片：

IMG_MGR_VAH007157100_d68807cb-8bd5-4ca8-861d-d878fa7e20b9.tiff IMG_MGR_VAH007157200_121e8ae3-8e88-4775-be1e-a833e1c1eb51.tiff

我有一个按钮：

```
private void btnUpload_Click(object sender, EventArgs e)
        {
            //check if all files in this folder are .tiff.

            finalImages = Directory.GetFiles(AppVars.FinalPolicyImagesDirectory);

            if (finalImages.Length == 0)
            {
                MessageBox.Show("There are no TIFF files to be uploaded. Please generate files first.", "Error!", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
            else
            {
                Web web = new Web();
                XML xml = new XML();

                //The first item in this foreach works fine. The second item gets hung.  
                foreach (string tiffFile in finalImages)
                {
                    PolicyNumber = Path.GetFileName(tiffFile).Substring(8, 12);

                    basePolicyNumber = PolicyNumber.Remove(PolicyNumber.Length - 2);
                    basePolicyNumber = basePolicyNumber + "00";

                    finalPolicyName = Path.GetFileName(tiffFile);

                //THIS IS WHERE I RUN INTO PROBLEMS......BUT ONLY WITH THE SECOND FILE IN THE FOREACH CLAUSE.
                    PolicyUUID = web.GetPolicyUUID(AppVars.pxCentralRootURL, basePolicyNumber);

                    if (!string.IsNullOrEmpty(PolicyUUID) == true)
                    {
                        ixLibraryPolicyBucketURL = AppVars.ixLibraryRootURL + "policy_" + PolicyUUID + "/objects/";

                        try
                        {
                            httpResponse = web.UploadFileToixLibrary(ixLibraryPolicyBucketURL, tiffFile);
                            xml.GeneratePayLoad(ixLibraryPolicyBucketURL + finalPolicyName + ".tiff", finalPolicyName);

                            //web.pxCentralPOST(ixLibraryPolicyBucketURL + "/IMG_MGR_37722779-7487-4d47-a669-ac33a61dceb2.tiff", AppVars.pxCentralRootURL + PolicyUUID, AppVars.pxCentralXMLPayloadFilePath);

                            MessageBox.Show(httpResponse);
                        }
                        catch (Exception ex)
                        {
                            MessageBox.Show(ex.Message);
                        }
                    }
                }
            }    
        } 
```

“foreach”子句中的第二项在此调用中被挂起：

PolicyUUID = web.GetPolicyUUID(AppVars.pxCentralRootURL, basePolicyNumber);

这是此类/方法的代码：

```
public string GetPolicyUUID(string rootURL, string basePolicyNumber)
        {
            string PolicyUUID = "";

            using (WebClient client = new WebClient())
            {
                NetworkCredential credentials = new NetworkCredential();
                credentials.UserName = AppVars.Username;
                credentials.Password = AppVars.Password;
                client.Credentials = credentials;

                if (DoesPageExist(rootURL + basePolicyNumber) == true)
                {
                    try
                    {
                        XmlDocument doc = new XmlDocument();

                        string XMLString = "";

                        //the app stops working here. it just hangs, no errors or anything. IT WORKS THE FIRST TIME AROUND.
                        XMLString = client.DownloadString(rootURL + basePolicyNumber);

                        doc.LoadXml(XMLString);

                        var node = doc.DocumentElement.SelectSingleNode("//Identifier[@name='InsightPolicyId']");

                        if (node != null && node.Attributes["value"] != null)
                        {
                            var val = node.Attributes["value"].Value;
                            PolicyUUID = val.ToString();
                        }
                    }
                    catch (WebException ex)
                    {
                        MessageBox.Show(ex.Message);
                    }
                }
                else
                {
                    MessageBox.Show("Page does not exist. This means that the policy number of the picture you're trying to upload does not exist in pxCentral. Please verify its name. The policy number in questoin is " + basePolicyNumber + ".", "Error!", MessageBoxButtons.OK, MessageBoxIcon.Error);
                }
            }
            return PolicyUUID;
        } 
```

我不确定为什么在为第二张图片运行这些代码时，应用程序只是挂起。谁能帮我一把？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:00:42.970

使用 Fiddler 或类似工具检查网络上发生的情况。也许链接没有正确构建？

关于[DownloadString](http://msdn.microsoft.com/en-us/library/fhd1f0sw%28v=vs.80%29.aspx)方法：

> 此方法**在下载资源时阻塞**。要下载资源并在等待服务器响应时继续执行，请使用**DownloadStringAsync**方法之一。

# javascript - 如何禁用“dijit.form.FilteringSelect”小部件？

> ID：11909075
> 
> 赞同：5
> 
> 时间：2012-08-10T20:52:30.293
> 
> 标签：javascript, html, dojo

我找不到禁用 dijit.form.FilteringSelect 小部件的方法。该要求使 css 显示为 none 不是一个选项。

有什么提示吗？提前致谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-10T21:07:26.200

自己想办法：

```
dijit.byId('_fromState_id').set('disabled', true); 
```

只是做这项工作。将其更改为`false`可以启用小部件。

干杯。

**更新**

另外，小部件还有另一个属性称为`"readOnly"`，与它的区别`"disabled"`在于：

1.  `disabled`不允许给小部件任何值，这意味着小部件值始终`NULL("")`在表单中。情况可能有问题`NotNull`；

2.  但`readOnly`允许为小部件预设一个值并使其不可编辑，用户仍然可以提交该值，只是无法更改它。

样本：

```
 dijit.byId("_fromState_id").set("value", "NOTAVAILABLE");
  dijit.byId('_fromState_id').set('readOnly', true); 
```

# linux - if thens 的 Bash 语法

> ID：11909076
> 
> 赞同：0
> 
> 时间：2012-08-10T20:52:30.687
> 
> 标签：linux, bash

尝试从 bash 运行它时遇到问题：

```
[root@bryanserver ~]# $SPACER="#-------#" APACHE_ENABLED=`ls -1 "$HTTPD_HOSTS-EN" | grep ".conf" | sed s/.conf//` APACHE_COUNT=`echo -e "$APACHE_ENABLED" | wc -1` if [ -n "$APACHE_ENABLED" ]; then echo $SPACER echo "Apache enabled Sites: $APACHE_COUNT" echo "$APACHE_ENABLED" else echo $SPACER echo "There are no detectable nor delectable WebSites In Sight Blackbeard" fi
bash: syntax error near unexpected token `then 
```

是代码本身的问题还是试图从外壳中使用它而不是将它放在文件中并获取文件？

在 Bash 的命令行中输入：

```
APACHE_ENABLED=`"$HTTPD_HOSTS_EN" | grep ".conf" | sed s/.conf//`
APACHE_COUNT=`echo -e "$APACHE_ENABLED" | wc -l`
if [ -n "$APACHE_ENABLED" ]; then
 echo $SPACER
 echo "Apache Enabled Sites: $APACHE_COUNT"
 echo "$APACHE_ENABLED" 
else
 echo $SPACER
 echo "There are no detected Apache Enabled Sites"
fi

produces this output:
APACHE_ENABLED=`"$HTTPD_HOSTS_EN" | grep ".conf" | sed s/.conf//`
APACHE_COUNT=`echo -e "$APACHE_ENABLED" | wc -l`
-bash: : command not found
[root@bryanserver ~]# APACHE_COUNT=`echo -e "$APACHE_ENABLED" | wc -l`
[root@bryanserver ~]# if [ -n "$APACHE_ENABLED" ]; then
>  echo $SPACER
>  echo "Apache Enabled Sites: $APACHE_COUNT"
>  echo "$APACHE_ENABLED"
> else
>  echo $SPACER
>  echo "There are no detected Apache Enabled Sites"
> fi  # 
```

然后点击进入，瞧！结果如下：没有检测到启用 Apache 的站点 [root@bryanserver ~]# 并且 Bash 已准备好进行更多工作。

所以，是的，正如基思指出的那样，我把*ell*误认为1，还有一些怪癖，但它执行并发出报告。这就是进步。

我在这里使用 Charles Smith 的一些材料；他在 GitHub 上分享了一些脚本；github.com/twohlix/HostingScripts/blob/master/listwww。

但是我使用的是记事本，在编辑了一些东西之后，当我将文本放在剪贴板上并在 Bash 中卸载它时，我相信发生的事情是我遇到了 EOF 问题。这个 SO question 给了我一个想法： [bash EOF in if statement](https://stackoverflow.com/questions/9349616/bash-eof-in-if-statement?rq=1) 我在 NotePad2 中使用了*View* / *Show Line Endings*，并复制了我的代码，然后将其粘贴到 Bash 中，这很有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:59:54.260

我看到的东西：

*   声明不`$SPACER`应该有美元符号
*   `;`在声明性语句之间添加分号

我认为这就是您在多行语句中的意思：

```
SPACER="#-------#"
APACHE_ENABLED=`ls -1 "$HTTPD_HOSTS-EN" | grep ".conf" | sed s/.conf//`
APACHE_COUNT=`echo -e "$APACHE_ENABLED" | wc -1`
if [ -n "$APACHE_ENABLED" ]; then 
    echo $SPACER;
    echo "Apache enabled Sites: $APACHE_COUNT";
    echo "$APACHE_ENABLED";
else 
    echo $SPACER;
    echo "There are no detectable nor delectable WebSites In Sight Blackbeard";
fi 
```

然后，在一行中，记住在`&&`分隔语句中添加分号或双 & 号：

```
SPACER="#-------#"; APACHE_ENABLED=`ls -1 "$HTTPD_HOSTS-EN" | grep ".conf" | sed s/.conf//`; APACHE_COUNT=`echo -e "$APACHE_ENABLED" | wc -1`; if [ -n "$APACHE_ENABLED" ]; then echo $SPACER; echo "Apache enabled Sites: $APACHE_COUNT"; echo "$APACHE_ENABLED"; else echo $SPACER; echo "There are no detectable nor delectable WebSites In Sight Blackbeard"; fi 
```

# php - youtube zend api：结果不到 n 分钟

> ID：11909077
> 
> 赞同：0
> 
> 时间：2012-08-10T20:52:34.873
> 
> 标签：php, zend-framework, search, youtube-api

我希望我的查询只产生比 7 分钟短的视频。那可能吗？

目前我使用这个：

```
$yt = new Zend_Gdata_YouTube();
$yt->setMajorProtocolVersion(2);
$query = $yt->newVideoQuery();
$query->setOrderBy('relevance');
$query->setSafeSearch('none');
$query->setVideoQuery($searchTerms);

// Note that we need to pass the version number to the query URL function
// to ensure backward compatibility with version 1 of the API.
$videoFeed = $yt->getVideoFeed($query->getQueryUrl(2)); 
```

文档说，有一个“持续时间”参数：[https ://developers.google.com/youtube/2.0/reference?hl=de#durationsp](https://developers.google.com/youtube/2.0/reference?hl=de#durationsp)

但不幸的是我没有运气

```
$query->setDuration('short'); 
```

但这无论如何都不会这样做，因为它会寻找短于四分钟的视频。

有任何想法吗？

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T12:37:56.807

我想你可能想试试`$query->setSeconds(240);`

我找到了信息：`Zend_Gdata_YouTube_Extension_Duration`和[与 Gdata 交互](http://framework.zend.com/manual/en/zend.gdata.introduction.html#zend.gdata.introduction.services)

祝你好运。

# c++ - 为什么在语言的简单性和执行时间之间似乎存在张力？

> ID：11909078
> 
> 赞同：4
> 
> 时间：2012-08-10T20:52:44.180
> 
> 标签：c++, python, compilation, interpreter, execution

在我看来，使用起来非常简单的语言（即 Python）通常比那些被认为更难学的语言（即 C++ 或 Java）执行时间更慢。为什么？我知道问题的一部分源于 Python 是解释而不是编译的事实，但是是什么阻止了 Python（或另一种高级语言）被有效编译？有没有你觉得没有这种权衡的编程语言？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T20:59:40.430

高级语言（或至少是动态语言）的效率问题源于这样一个事实：在运行时解决对象的实际类型之前，通常不知道需要执行哪些操作。因此，这些语言不能编译成简单的机器代码，必须在幕后完成所有繁重的工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-10T21:01:27.500

让我们比较一下 C 和 Python。在大多数情况下，C 编程比 Python 更“复杂”。这是因为 Python 自动化了很多 C 没有的工作。例如，垃圾收集在 Python 中是自动化的，但在 C 中是程序员的责任。

这种自动化的代价是这些“高级功能”需要足够通用以“适应”每个程序的需求。例如，Python 垃圾收集器有一个预定义的调度/垃圾收集算法，它可能不是每个应用程序的最佳选择。另一方面，C 为程序员提供了完全的灵活性，可以按照自己的意愿定义 GC 计划和算法。

所以你有它，轻松与性能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-10T21:07:08.360

基本上，这一切背后都有一个核心原因：做某事所需的指令数量。

在直接的旧 C 语言中，大多数语句只需几条指令就可以完成，通常从 1 到大约 4，并且可以非常接近 1。

在 C++ 中，还有更多隐藏的内容，例如，调用虚拟方法需要额外的几条指令。这可以通过一个好的优化器来解决，但是运行时类型信息会阻碍优化器。

在 Java 中，您也有同样的问题，而且代码在解释器中运行，该解释器将每个 JVM 指令扩展为一个或多个机器指令——在某些情况下更多，特别是如果代码运行时间不够长而无法利用运行时优化。

Python 有所有这些问题，但它必须在启动时进行解析，并且具有处理类型的移动灵活（因此更复杂）系统，这意味着更多的指令。

是的，可以编译 Python。甚至有[项目正在尝试](http://shed-skin.blogspot.com/)。但是硬编译会让你失去一些动态语言的优势。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-10T21:15:21.963

Python 代码执行时间比 C++ 慢，主要是因为它是一种动态类型语言。参见例如：

[为什么动态类型语言很慢](https://stackoverflow.com/questions/761426/why-are-dynamically-typed-languages-slow)

# javascript - jQuery UI 选项卡 - 将参数设置为 NEXT/PREVIOUS 按钮点击

> ID：11909082
> 
> 赞同：1
> 
> 时间：2012-08-10T20:52:50.577
> 
> 标签：javascript, jquery, jquery-ui, tabs

我目前正在使用 jQuery UI 选项卡以及 ajax。我总共有 3 个选项卡，只能通过“下一个”和“上一个”按钮导航。我已经设置了参数：在 tab1 中，如果您离开输入字段`car_name`，您将收到一条警告消息和与 tab2 类似的参数。

*我的预期设置：*如果不满足参数，则用户无法前进到下一个选项卡。但是，该部分不起作用。用户会收到一个警报：他们可以忽略它，再次单击下一步，然后前进到下一个选项卡。如何在参数（填写输入字段）完成之前禁用“下一步”按钮？[例子](http://webprolearner2346.zxq.net/dropdown-menu/tabs.php)

谢谢你

**JS**

```
 <script>  
        $(function () {
            var $tabs = $('#tabs').tabs({
              disabled: [0, 1, 2],
              select: function () {

                $.ajax({
                  type: "POST",
                  url: "post_tabs.php",
                  data: {
                    "name": $("#car_name").val(),
                    "title": $("#title").val(),
                    "price": $("#price").val()

                  },
                  success: function (result) {
                    $("#tab-3").html(result);
                  } 
                });  
              } 
            });

            $(".ui-tabs-panel").each(function (i) {
              var totalSize = $(".ui-tabs-panel").size() - 1;
              if (i != totalSize) {
                next = i + 2;
                $(this).append("<a href='#' class='next-tab mover' rel='" + next + "'>Next Page &#187;</a>");
              }
              if (i != 0) {
                prev = i;
                $(this).append("<a href='#' class='prev-tab mover' rel='" + prev + "'>&#171; Prev Page</a>");
              }
            });

            $('.next-tab, .prev-tab').click(function () {
              var prev = $(this).hasClass('prev-tab');
              var currentTab = $('#tabs').tabs('option', 'selected');
              if (
                prev || /*(A)*/ (
                  currentTab == 0 && /*(B)*/
                  $.trim($('#car_name').val()).length > 0

                ) || (
                  currentTab == 1 && /*(C)*/
                  $.trim($('#title').val()).length > 0 && $.trim($('#price').val()).length > 0)

              ) {
                var tabIndex = $(this).attr("rel");
                $tabs.tabs('enable', tabIndex).tabs('select', tabIndex).tabs("option", "disabled", [0, 1, 2, 3, 4]);
              } else if (!prev) {
                switch (currentTab) {
                  case 0:
                    alert('Please choose an option.', 'Alert Dialog');
                    break;
                  case 1:
                    alert('Please fill out all the required fields.', 'Alert Dialog');
                    break;

                }
              }
              return false;
            });

     $('.next-tab, .prev-tab').click(function () {
          var tabIndex = $(this).attr("rel");
          $tabs.tabs('enable', tabIndex).tabs('select', tabIndex).tabs("option", "disabled", [0, 1, 2, 3, 4]);
          return false;
      });
});
         </script> 
```

**HTML**

```
<div id="tab-1" class="ui-tabs-panel ui-tabs-hide">
 <label for="car_name">Car Model</label>
     <input type="text" id="car_name" class="detail" name="car_name" value="" /> <br>

</div>

<div id="tab-2" class="ui-tabs-panel ui-tabs-hide">

     <label for="title">Title</label>
     <input type="text" id="title" name="title" size="60" autocomplete="off" value=""/><br>
     <label for="price">Price</label>
     <input type="text" id="price" name="price" size="60" autocomplete="off" value=""/><br>
</div>

<div id="tab-3" class="ui-tabs-panel ui-tabs-hide">

</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T21:59:43.810

您的代码中有一些奇怪的地方。您注册“下一个”和“上一个”两次......

那不是你想要的。

您想要的是以下行为：

1.  如果点击 prev - 总是去 prev
2.  如果单击下一步 - 仅在满足必填字段时才进行下一步。

这意味着您应该更改以下内容

1.  从第一个事件中删除`.prev-tab`选择器 - 并删除对变量的任何提及`prev`。这种方法应该只处理`next`.
2.  从第二个事件绑定中移除`next`，这个应该只处理`prev`.

所以你的 JavaScript 看起来像这样：

```
 $('.next-tab').click(function () {

              var currentTab = $('#tabs').tabs('option', 'selected');
              if (
                (
                  currentTab == 0 && /*(B)*/
                  $.trim($('#car_name').val()).length > 0

                ) || (
                  currentTab == 1 && /*(C)*/
                  $.trim($('#title').val()).length > 0 && $.trim($('#price').val()).length > 0
                )

              ) {
                var tabIndex = $(this).attr("rel");
                $tabs.tabs('enable', tabIndex).tabs('select', tabIndex).tabs("option", "disabled", [0, 1, 2, 3, 4]);
              } else {
                switch (currentTab) {
                  case 0:
                    alert('Please choose an option.', 'Alert Dialog');
                    break;
                  case 1:
                    alert('Please fill out all the required fields.', 'Alert Dialog');
                    break;

                }
              }
              console.log("preventing default");

              return false;
            });

     $('.prev-tab').click(function () {
          var tabIndex = $(this).attr("rel");
          $tabs.tabs('enable', tabIndex).tabs('select', tabIndex).tabs("option", "disabled", [0, 1, 2, 3, 4]);
          return false;
      }); 
```

这应该可以解决您的问题。

您可以在操作中看到这一点并在[我的网站上下载我的资源](http://www.mograbi.info/stackoverflow/question_11909082/main.html)

以上将回答您的问题。

现在，请允许我有机会建议一种方法，让您为“下一个”场景编写更短的代码。

在该行的正上方`$('.next-tab').click(function () {`创建以下函数

```
function isEmpty( item ) { 
    return $.trim(item.val()).length <= 0;
} 
```

现在 - 添加`class='required'`单击时不应为空的每个输入字段`next`。

在每个选项卡上添加`data-alert="The alert message you want to show"`

现在 HTML 应该是这样的

```
<div id="tab-1" class="ui-tabs-panel ui-tabs-hide" data-alert="Please choose an option.">
 <label for="car_name">Car Model</label>
     <input type="text" id="car_name" class="required detail" name="car_name" value="" /> <br>

</div>

<div id="tab-2" class="ui-tabs-panel ui-tabs-hide" data-alert="Please fill out all the required fields.">
     <label for="title">Title</label>
     <input type="text" id="title" class="required" name="title" size="60" autocomplete="off" value=""/><br>
     <label for="price">Price</label>
     <input type="text" id="price" class="required" name="price" size="60" autocomplete="off" value=""/><br>
</div> 
```

现在 JS 代码应该更小并且更易于维护（即使您添加另一个带有必填字段的选项卡 - 它不应该改变） - 在这里

```
$('.next-tab').click(function () {
              var $tab = $(this).closest(".ui-tabs-panel");
              var $requiredFields = $tab.find(".required");
              var canContinue = true;

              $requiredFields.each(function(index,item){
                console.log(["checking" , item]);
                if ( canContinue && isEmpty($(item))){ alert( $tab.attr("data-alert"), 'Alert Dialog' ); canContinue = false; }

              });
              if ( canContinue )
              {
                var tabIndex = $(this).attr("rel");
                $tabs.tabs('enable', tabIndex).tabs('select', tabIndex).tabs("option", "disabled", [0, 1, 2, 3, 4]);
              } 
              return false;
            }); 
```

# javascript - d3.js 中的图形方向和节点定位

> ID：11909083
> 
> 赞同：6
> 
> 时间：2012-08-10T20:52:54.100
> 
> 标签：javascript, svg, graph, d3.js, force-layout

由于这个较早的[问题](https://stackoverflow.com/q/11894057/1036544)，我使用强制布局生成了一个静态固定布局图，如下所示`d3.js`：

![在此处输入图像描述](../Images/52444c749f22dfe91707b46b8b274c68.png)

我有两个具体问题需要进一步定制布局：

首先，我注意到确定性地初始化节点位置（例如，在此处对角线完成，有关详细信息，请参阅[脚本](https://stackoverflow.com/q/11894057/1036544)）固定节点的位置，并且节点的方向似乎取决于此初始化以及力图的尺寸* . 我想知道如何使`A, D, E, F, I`上图中的节点**水平对齐**？换句话说，我想将图形的方向逆时针旋转大约 45 度。我试图在中间水平初始化节点：

```
nodes.forEach(function(d, i) { d.x = w / size * i; d.y = h / 2; }); 
```

但是生成的输出在它们初始化的位置具有水平的所有节点和边缘。

`svg`其次，力图在元素内自动居中是真的吗？如果不是，我们怎样才能做到这一点？如果是，我们如何为`svg`元素内的力图指定一个中心？

（* 注意：奇怪的是，当设置力图的`.size([w, h])`位置`w = h`并确定性地沿对角线初始化节点时，所有节点和边都沿输出中的对角线定位，为什么？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-17T13:59:36.547

尝试在每个刻度上添加一个自定义重力，将节点拉向水平线。像这样的东西：

```
force.on('tick', function(e) {
  nodes.forEach(function(d) {
    d.y += (height/2 - d.y) * e.alpha;
  });
}) 
```

对于你的第二个问题，我相信它不是居中的，但默认情况下会有一个小的重力将节点拉向中心。

# jquery - jquery .html将html加载到div表单选项卡键不起作用

> ID：11909087
> 
> 赞同：0
> 
> 时间：2012-08-10T20:53:03.150
> 
> 标签：jquery, forms, html, tabs

我正在使用 jquery().html() 将带有 javascript 的动态 html 表单加载到 div 中，它可以完美地插入和显示表单。javascript 也会执行。我遇到的问题是在表单上，​​tab 键不起作用。为每个设置了 tabindex= 值

关于为什么 tab 键可能不起作用的任何想法？我试过 FF、IE、Chrome 和 Safari，它们都有相同的选项卡键问题。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:07:00.943

您一定在代码中做错了什么。（也许你在劫持选项卡按键事件？）我创建了一个[小提琴](http://jsfiddle.net/wLxA6/)，它对我来说工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-23T14:09:40.010

我使用的所有浏览器都有同样的问题。

1.  按 F12 进入您的 Google Chrome（开发控制台）。
2.  打开您的申请表
3.  进入开发者控制台，打开“控制台”选项卡并输入以下代码：

```
setInterval(function() {console.log(window.onkeydown)}, 1000);
```

javascript 控制台将打印“window.onkeydown”函数，如果此函数未被覆盖，控制台将显示“null”值。如果您使用任何覆盖 window.onkeydown 的 UI 库，您将在此控制台上识别覆盖此回调的事件。

在我的例子中，我们使用带有 angular 和 bootstrap 的模态组件。当我们显示模式时，从 3rd 方库更改“window.onkeydown”事件并阻止一些键转发到我的屏幕。

# ios - UIBarButtonItem 不居中

> ID：11909089
> 
> 赞同：2
> 
> 时间：2012-08-10T20:53:13.897
> 
> 标签：ios, uibarbuttonitem, uitoolbar

我使用以下方法在工具栏的中心添加了一个按钮：

```
UIBarButtonItem *addButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemAdd
                                                                          target:self
                                                                           action:nil];

UIBarButtonItem *spacer = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace
                                                                        target:nil
                                                                        action:nil];

self.toolbarItems = @[spacer, addButton, spacer]; 
```

但是添加的按钮不是很居中：

![在此处输入图像描述](../Images/c47421ec6037dc5fbc514cce7bc65e6d.png)

这里发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-30T19:38:14.483

我开始认为这是某种 iOS 范围的错误。那，或者他们在很多地方都弄错了。例如，主页上的分页点未居中。通知中心的前 3 个按钮（今天、全部、错过）也相差几个像素。还有很多这样的。所以这可能会在下一次更新中得到纠正。

现在，我会尝试强制它居中（例如，在 viewWillAppear 中）。下面的伪代码，没有时间测试：P：

```
self.toolbarItems[1].center = CGPointMake(self.bounds.size.width / 2.0f, self.bounds.size.height / 2.0f); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T01:08:48.223

不要在数组中两次添加相同的间隔 - 每次的值可能不同 - 制作两个间隔。

# c# - 如何从办公室功能区控件中获取选定的单元格

> ID：11909091
> 
> 赞同：3
> 
> 时间：2012-08-10T20:53:35.867
> 
> 标签：c#, vsto, excel-2010

我想从功能区控件中获取活动范围。只有当功能区上的控件需要它时，才应该有一种方法可以访问选定的单元格。

目前这就是我的做法；

```
public partial class ThisAddin
{
    private void SheetSelectionChange(object sh, Range target)
    {
        int count = target.Count;

            if (count < 5000) // This is for performance reasons 
            {
                //Set a custom range property in the office ribbon
                Req_Tool.ActiveRange = target; 
            {
    }
} 
```

我觉得这是软弱和浪费。
首先，每次选择更改我的代码都会运行。其次，我有两份选择的副本，无论是否使用。

我忽略了必须有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T22:00:47.260

您可以通过访问对象的`Selection`属性来访问活动工作表中当前选定的范围`Application`。

```
private void button1_Click(object sender, RibbonControlEventArgs e)
{
    this.ActiveRange = (Excel.Range)Globals.ThisAddIn.Application.Selection;
} 
```

MSDN 文档：

*   [ApplicationClass.Selection 属性](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.applicationclass.selection%28v=office.14%29 "ApplicationClass.Selection 属性")
*   [Application.Selection 属性](http://msdn.microsoft.com/en-us/library/office/bb214188%28v=office.12%29.aspx "Application.Selection 属性")

# ruby-on-rails-3 - Ruby Rails——获得动画前端的简单方法？

> ID：11909092
> 
> 赞同：0
> 
> 时间：2012-08-10T20:53:40.223
> 
> 标签：ruby-on-rails-3, visualization, graphviz

我正在开发一个基于 Web 的模拟，我希望前端能够实时“动画化”——它将是一个地图应用程序，我希望有一些小图标（代表我的模拟的组件）移动所有模拟运行时在地图上。我正在 Rails 中开发后端，但我想知道前端/动画部分使用哪些好的包？我使用 Graphviz 生成基本地图（有向图），但它似乎不太适合实时动画。

像 Hans Rosling 的 Gapminder 之类的东西（如果它甚至可以实时完成）。还是我应该做类似的事情并“记录”数据然后回放？在这种情况下我应该考虑哪些包？ [间隙器](http://www.gapminder.org/world/#%24majorMode=chart%24is;shi=t;ly=2003;lb=f;il=t;fs=11;al=30;stl=t;st=t;nsl=t;se=t%24wst;tts=C%24ts;sp=5.59290322580644;ti=2011%24zpv;v=1%24inc_x;mmid=XCOORDS;iid=phAwcNAVuyj1jiMAkmq1iMg;by=ind%24inc_y;mmid=YCOORDS;iid=phAwcNAVuyj2tPLxKvvnNPA;by=ind%24inc_s;uniValue=8.21;iid=phAwcNAVuyj0XOoBL_n5tAQ;by=ind%24inc_c;uniValue=255;gid=CATID0;by=grp%24map_x;scale=log;dataMin=282;dataMax=119849%24map_y;scale=lin;dataMin=12;dataMax=83%24map_s;sma=49;smi=2.65%24cd;bd=0%24inds=;example=75)

目前使用 Rails 3.0、Ruby 1.9.2、Graphviz 2.28。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:59:17.237

这里有 2 个可能有帮助的 javascript 库。您可以使用对 Rails 后端的 ajax 调用来填充其数据。我不确定 D3 是否具有映射功能，但我相信 Raphael 有。就实时而言，您必须查看他们的文档。在 Rails 4 中，我相信流式传输功能也可能使您受益，但我没有调查过。

[拉斐尔](http://raphaeljs.com/)

[D3](http://d3js.org/)

# php - 计数器无法注册计数

> ID：11909096
> 
> 赞同：0
> 
> 时间：2012-08-10T20:54:22.790
> 
> 标签：php, javascript, mysql

当有人单击我网页上的按钮时，此 JavaScript 代码将运行：

```
function count() {
    var xmlHttp = getXMLHttp(); // XMLHttpRequest object
    xmlHttp.open("GET", "count.php", true);
    xmlHttp.send(null);
} 
```

然后，这个 PHP 脚本被执行：（一个常见的）

```
<?php

mysql_connect("host","username","password"); 
mysql_select_db('database');
mysql_query('UPDATE table SET field = field + 1'); 

?> 
```

问题可能会有所不同。假设我点击了十次，它只注册了 8 次或其他东西。有时它有效，有时则无效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:57:53.903

您希望在 Ajax 请求完成并返回成功消息之前禁用单击按钮。例如，查看 StackOverflow 上的评论机制。您不能按两次，因为第一次后它会被禁用。

```
try {
    $pdo = new PDO("mysql:host=localhost;dbname=tests", "user", "pass");
    $pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
    //Have PDO throw exceptions on errors. That way you don't miss 'em.
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

    $sql = "UPDATE `table` SET `field` = `field`+1";

    $stmt = $pdo->prepare($sql);
    $stmt->execute();
}
catch (PDOException $e) {
    //In case an error has occurred, it will be caught and handled here.
    die("There was an error with the database! " . $e->getMessage());
} 
```

这就是我在 PDO 中的做法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T18:42:32.720

**总有办法解决...**

**快速修复解决方案@**

使您的 AJAX 调用同步。注意：这将使“生成”按钮在执行期间似乎卡住，我认为您不希望这样（因为您将所有名称保留在 JS 数组中以加快加载速度...是的，我访问了您的链接...谢谢发布它）

```
function count() {
    var xmlHttp = getXMLHttp();
    var async = false;
    xmlHttp.open("GET", "count.php?" + Math.random, async);
    xmlHttp.send();
} 
```

**更好的解决方案**

```
//call submit count every 60 secs, play with it to get a interval that suits you best
window.setTimeout("submitCount();",60000);
var globalCounter = 0;
function count() 
{
    globalCounter++;
}

function submitCount(){
    if (globalCounter > 0)
    {
        var xmlHttp = getXMLHttp();
        var async = false;
        var countForPHP = globalCounter;
        globalCounter = 0;
        xmlHttp.open("GET", "count.php?r=" + Math.random + "&count=" + countForPHP, async);
        xmlHttp.send();
    }
    window.setTimeout("submitCount();",60000);
} 
```

更改您的 PHP 以从 Request.QueryString 获取 countForPHP 并相应地更新 SQL

注意：当网站关闭且 60 秒批次未提交到服务器时，计数将丢失。为了解决这个问题，您可能需要在 window.onbeforeunload 上调用 submitCount

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T21:42:22.757

问题似乎是浏览器从缓存中加载结果。添加代码以发送标题以在您响应 count.php 时禁用页面缓存（来自 php.net 标题示例）：

```
header("Cache-Control: no-cache, must-revalidate"); // HTTP/1.1
header("Expires: Sat, 26 Jul 1997 05:00:00 GMT"); // Date in the past 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T13:06:38.747

将单个点击（带有日期时间）存储在数据库中，而不是更新字段。为此，需要更改您的 count.php 以将记录（单击一次）插入表中。

得到总数。点击次数，您可以使用表格的“count(1)”。由于您要插入点击的日期和时间，因此您可以从表格中获取按日/周/月/年进行的数据点击。

顺便说一句，UPDATE 将在更新记录/行时锁定它。当超过 1 个请求同时尝试更新同一条记录时（在并发请求的情况下），更新可能会因为锁定问题而失败。

您的表格（点击次数 - 表格名称）可以如下所示。
`+-------------+---------------------+`
`| sourceip | click_date |`
`+-------------+---------------------+`
`| 10.32.12.45 | 2012-08-16 13:35:03 |`
`+-------------+---------------------+`
count.php 中的查询应该类似于 insert into clicks(sourceip, click_date) values('10.32.12.45', now());

您可以使用 php 脚本获取源 ip（客户端 ip）。

下面的查询给你没有。每天/每月/每年的点击次数。Day => 选择 date_format(click_date, '%Y-%m-%d') 作为日期，按 date_format(click_date, '%Y-%m-%d') 从点击组中计数 (1) 次点击；
月 => 选择 date_format(click_date, '%Y-%m') 作为日期，按 date_format(click_date, '%Y-%m') 从点击组中计数 (1) 次点击；
年 => 选择 date_format(click_date, '%Y') 作为日期，按 date_format(click_date, '%Y') 从点击组中计数 (1) 次点击；

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-10T21:04:19.953

试试这个：

```
$con = mysql_connect("host","username","password"); 
mysql_select_db('database', $con);

$result = mysql_query("select * from table");

$numrows = mysql_num_rows($result);
if ($numrows!=0){
    while ($row = mysql_fetch_assoc ($result)){
        $Field = $row['field'];
    }
$FieldTwo = $Field+1;
$result = mysql_query('UPDATE table SET field='$FieldTwo'); 

} 
```

# c# - 链中的多个后台工作者

> ID：11909097
> 
> 赞同：2
> 
> 时间：2012-08-10T20:54:30.933
> 
> 标签：c#, .net, multithreading, backgroundworker

我有一系列 3 个耗时的函数，我想在后台工作人员或其他任何工具中执行它们，我的问题是每个函数都应该等待前一个函数完成，所以这是我的伪代码：

```
open_session() // during the execution of this function i like to display a loading-window 

open_session() //this function opens a process another windows app , while opening this app i would like to keep the current app responsive.

close_session()// during the execution of this function i like to display a loading-window 
```

我想用后台工作者来做这件事，但做功能是异步的。

请提供任何帮助

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-10T21:08:21.957

为什么不在同一个后台工作人员中依次执行所有三个？因此，您的后台工作人员工作事件将如下所示：

```
private void yourBackgroundWorker_DoWork(object sender, DoWorkEventArgs e)
{
    open_session();
    open_session();
    close_session();
} 
```

这样，backgroundworker 本身是异步的，但是你想要顺序运行的三个方法仍然在异步方法的上下文中顺序运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T20:58:17.670

`RunWorkerCompleted`只需在前一个的事件处理程序中启动每个连续的工作人员......

**解决反对意见：**请注意，这是一种*可能性*。这是否是一个好的选择，显然取决于上下文，就像往常一样。我不相信“最好只使用一个 BGW”这样的黄金法则。我可以想象很多情况，在这些情况下，对所有任务使用单个 BW 不会简化问题（例如，如果每个操作需要`ProgressChanged`以不同方式处理）。

OP 询问了多个后台工作人员，没有给出足够的背景来判断哪种方法最好 - 据我所知，他可能只是在理论上想知道如何“链接”BW，以便更好地了解 BW 的工作原理.

# google-maps - 将 d3 路径覆盖到 Google 地图上？

> ID：11909099
> 
> 赞同：35
> 
> 时间：2012-08-10T20:54:51.370
> 
> 标签：google-maps, d3.js

我正在尝试使用 d3.geo 和 GeoJson 将地图叠加到谷歌地图上。我设法强制 d3 使用 Google Map 的投影来绘制路径，这非常容易。这是我到目前为止所拥有的：

[http://www.caudillweb.com/temp/d3_choropleth.html](http://www.caudillweb.com/temp/d3_choropleth.html)

这在我放大和缩小时效果很好：

![地图缩小](../Images/35f4f9984af85da64905901057515a24.png) ![地图放大](../Images/12efdc7f2894ff3e4f6547c4bd94582e.png)

但是当我平移时，SVG 叠加层也会移动，并且由于它的大小是固定的，所以形状会被截断：

![地图向下平移](../Images/078126aa3ceb3e7c2d77b85de518ed01.png)

有没有人得到这样的工作？有什么想法我可以从这里去吗？上面的例子是一个独立的 HTML 文件，如果有人想玩的话。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-19T16:02:42.847

在[此示例](http://jsfiddle.net/Vjxpr/)中，svg 的宽度和高度设置为 8000 x 8000，在缩放级别为 9-10 时似乎还可以。顶部和左侧设置为 -4000 x -4000 以使其居中。最后，投影被移动/偏移，使其绘制在 svg 的中心：

**放大并居中 svg：**

```
.SvgOverlay svg {
    position: absolute;
    top: -4000px;
    left: -4000px;
    width: 8000px;
    height: 8000px;        
} 
```

**偏移投影：**

```
return [pixelCoordinates.x + 4000, pixelCoordinates.y + 4000]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-18T04:25:35.140

一种选择是将初始地图大小设置为非常大的值，例如 1000 x 1000 像素或更大。这将强制 SVG 覆盖在可视区域内呈现（这似乎是 Firefox 的限制）。我意识到这可能会影响您网站的设计，因此您可能需要考虑用 div 包裹地图以隐藏溢出。

```
#map-wrap {
    width: 500px;
    height: 500px;
    overflow: hidden;
}

#map {
    width: 1000px; /* just big enough to show the whole thing at zoom #6 */
    height: 1000px;
} 
```

地图渲染后，您可以将地图重新​​调整为所需的 500 x 500 大小并重新居中地图。这可以在以下`bounds_changed`事件中完成：

```
google.maps.event.addListener(map, 'bounds_changed', function() {
    $map.css({ height: '500px', width: '500px' }); // back to desired dims
    google.maps.event.trigger(map, 'resize'); // trigger a 'refresh'
    map.setCenter(new google.maps.LatLng(-18.2, 35.1)); // re-center map
    google.maps.event.clearListeners(map, 'bounds_changed'); // don't do this again
}); 
```

[这是一个工作示例](http://jsfiddle.net/umrXE/)（在 Firefox 和 Chrome 中测试）。

一些警告：

1.  您希望人们放大的越远，您需要渲染初始的“临时”地图就越大。例如，如果要允许缩放级别 7，则可能需要将初始地图设为 2000 x 2000 以进行补偿。显然，在渲染这么大的地图时存在性能问题。正如分散指出的那样，限制缩放级别可能是明智的。
2.  由于最后一分钟重新调整大小，地图重新调整时会出现闪烁。您可能需要考虑使用 jQuery 隐藏/显示地图，或者可能在所有内容之上放置一个白色覆盖层，直到地图完成重新调整大小。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-17T18:18:54.813

我能够通过使 svg 更大、添加一些填充并给出负的顶部和左侧位置来解决该缩放级别的问题，如下所示：

```
 .SvgOverlay, .SvgOverlay svg {
        position: absolute;
        top: -250px;
        left: -250px;
        padding: 500px;            
    }

    var svg = layer.append("svg")
          .attr("width", 1000)
          .attr("height", 1000) 
```

如果您想让您的用户进一步放大，您必须增加所有这些数字。例如，将它们增加 10 倍似乎可以解决所有缩放级别的问题。但是，您可能希望限制用户的缩放能力，因为 svg 叠加层的有用性会随着您进一步放大而降低。

这是一个演示这个想法的小提琴。 [http://jsfiddle.net/VHWqq/7/](http://jsfiddle.net/VHWqq/7/)

编辑：正如 Herb 指出的那样，这种方法不适用于 Firefox。

# caching - 如何从缓存中排除网站目录

> ID：11909101
> 
> 赞同：1
> 
> 时间：2012-08-10T20:55:07.720
> 
> 标签：caching

我在我的 .htaccess 中使用此代码缓存我的网站：

```
        `## 过期缓存##

过期活动在
ExpiresByType image/jpg "access plus 1 year"
ExpiresByType 图像/jpeg“访问加 1 年”
ExpiresByType image/gif "访问加 1 年"
ExpiresByType image/png "访问加 1 年"
ExpiresByType text/css "访问加 1 个月"
ExpiresByType 申请/pdf “访问加 1 个月”
ExpiresByType text/x-javascript "访问加 1 个月"
ExpiresByType application/x-shockwave-flash "访问加 1 个月"
ExpiresByType image/x-icon "access plus 1 year"
ExpiresDefault "访问加 2 天"

## 过期缓存##`

```

问题是它缓存了我的新闻通讯管理区域等内容。是否可以修改此代码以排除我的管理区域（它位于单独的文件夹中）。谢谢！

# ruby-on-rails - 重构为单个模型

> ID：11909102
> 
> 赞同：1
> 
> 时间：2012-08-10T20:55:13.670
> 
> 标签：ruby-on-rails, model, associations

我已经为我的网站建立了自己的照片库系统，但它与 Flickr 几乎是 1:1 绑定的，现在，这本身并不是一个大问题，但我现在想对其进行一些重构，这是我想要的第一件事尝试是看看我是否可以将一些现有的模型合并为一个。

目前，我有以下型号：

```
Collection
Album
Photo
Photo-size 
```

以下是每个的完整关联：

```
Collection
has_many :children, class_name: "Collection", foreign_key: "parent_id"
belongs_to :parent, class_name: "Collection", foreign_key: "parent_id"
has_many :albums

Album
has_many :photos, :dependent => :destroy
belongs_to :collection

Photo
belongs_to :album
has_many :photo_sizes, :dependent => :destroy

Photo_size
belongs_to :photo 
```

这一切都有效，但我想从这里的人那里得到一些想法，以了解你对我应该如何解决这个问题的看法。

例如，在我看来（无论如何），我可以将 Collections 折叠到相册中，然后作为第二件事，将 Photo_sizes 折叠到 Photos 中。

我感到困惑的是，这些关系将如何在合并的收藏/专辑模型中发挥作用，因为专辑需要能够拥有子专辑，但一个也应该是顶级收藏，而且还应该能够拥有多个相片。

包含其他相册的相册也不会有照片。所以一张专辑要么有儿童专辑，要么有一组照片。

关于我该如何解决这个问题的任何想法？

# bash - Bash -- 文件名中的 Rsync 变量有空格

> ID：11909103
> 
> 赞同：3
> 
> 时间：2012-08-10T20:55:16.160
> 
> 标签：bash, variables, directory, rsync, spaces

一直在寻找几个小时，仍然无法弄清楚:(

无论如何，我正在创建一个脚本，它将自动将大约 40 个不同的目录同步到另一台服务器上的 40 个其他目录。如果您想查看整个脚本，可以在此处查看：http: [//pastebin.com/Nt3KKvx9](http://pastebin.com/Nt3KKvx9)

但重要的是我运行 rsync 的 for 循环

```
for ((i=0; i<${#websys[@]}; i++))
do
  localpath="/nusdata/staff/NUS/NUS/Systems/${kiskasys[$i]}"
  remotepath="/home/www/html/nusalaska.com/html/systems/${websys[$i]}"
  rsync -rlptnvz -s "$localpath" -e "ssh -p 50014" "nusak@webserver:$remotepath/"
done 
```

问题是数组“kiskasys”有许多目录名，其中包含空格（例如：'101 greenbrook'）。我尝试让数组变量在它们周围有单引号，在它们周围有双引号，像'\'这样的转义空格，以及所有三个的组合。我还尝试将 $localpath 放在引号中，而不是引号等中。

我想我只是对 -s (--protect-args) 如何处理空格以及如何让它在我的情况下工作感到困惑。

错误输出总是如下所示：

```
rsync: change_dir "/nusdata/staff/NUS/NUS/101" failed: No such file or directory (2) 
```

或者

```
rsync: change_dir "/nusdata/staff/NUS/NUS/'101 greenbrook'" failed: No such file or directory (2) 
```

任何帮助表示赞赏！

谢谢

## 发现我的问题

在将我的代码从我的脚本复制到这个页面时，我不小心把它复制错了……但是在复制错误时，我在上面发布的是非常好的代码，可以正常工作哈哈。

所以我上面发布的是我自己问题的解决方案。

原文在 localpath 变量中有单引号，如下所示：

```
localpath="'/nusdata/staff/NUS/NUS/Systems/${kiskasys[$i]}'" 
```

单引号是问题所在。为了每个人的利益，这里是一个示例输出

```
echo ${kiskasys[1]}

#output would look like this:

101 greenbrook 
```

基本上没有特殊的转义字符等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T21:37:26.340

对于它的价值，我无法复制您的问题。如果我将`localpath`and设置`remotepath`为带有空格的目录：

```
localpath="/home/lars/tmp/so/dir1/a directory"
remotepath="/home/lars/tmp/so/dir2/a directory" 
```

然后运行您的`rsync`命令（针对我的环境稍作修改）：

```
rsync -rlptvz -s "$localpath/" -e "ssh" "localhost:$remotepath/" 
```

它只是工作。以下是 的内容`dir1`：

```
dir1/a directory/file1
dir1/a directory/file3
dir1/a directory/file2 
```

运行 rsync 后，`dir2`如下所示：

```
dir2/a directory/file1
dir2/a directory/file3
dir2/a directory/file2 
```

您能否显示导致您在上面看到的错误的*特定命令行？*也许运行带有标志的脚本`-x`并准确显示如何设置`localpath`和`remotepath`设置。

# matplotlib - 在图形上保留数据点注释

> ID：11909108
> 
> 赞同：0
> 
> 时间：2012-08-10T20:55:32.260
> 
> 标签：matplotlib, python-2.7

我有一个 pyplot 图，其中每个数据点都标有指向数据点的箭头，并且我对其进行了格式化，以便数据与它所注释的数据点保持恒定的偏移量。这工作正常，直到我用我的一个数据点太靠近图形边缘并且注释被切断。我希望有一种方法可以格式化我的注释，以便它自动将自己定位在我的数据之外，但仍然留在我的图中。下面是我如何格式化注释的片段。

```
for label, x, y in zip(bagOlabels, time, height):
    ax.annotate(
                label,
                xy = (x,y), xytext = (50,-20),
                textcoords = 'offset points', ha = 'right', va = 'top',
                arrowprops = dict(arrowstyle = '->', 
                connectionstyle = 'arc3,rad=0')
                ) 
```

这`xytext = (50,-20)`是我设置标签偏移的地方。我一直在挖掘，但我还没有找到我要找的东西。如果您对如何实现这一点有任何见解，我很想听听。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:04:41.927

您可以尝试一些策略：

1.  如果该点位于绘图的右半部分，则使用负偏移量放置注释：

    ```
    for label, x, y in zip(bagOlabels, time, height):
        offset = (50, 20)
        if x > mid_x:
           offset = (-50, 20)  # (-50, -20) could be better

    ax.annotate(...) 
    ```

2.  放大绘图，使所有注释都适合绘图。

在第一种情况下，注释可能会相互重叠。

**更新**：

该方法`get_xlim`返回您的绘图在 x 轴上的限制：

```
x = range(0, 100)
y = map(lambda x: x*x, x)

fig = pyplot.figure()
ax1 = fig.add_subplot(1, 1, 1)
ax1.plot(x, y, 'r.', x, y, 'r-')
xlim = ax1.get_xlim() 
```

# jquery - 如何按名称获取选定元素，然后使用 jQuery 从下拉列表中获取选定值？

> ID：11909109
> 
> 赞同：17
> 
> 时间：2012-08-10T20:55:38.547
> 
> 标签：jquery, select

我可以按名称找到我的选择元素，但我无法找到与其关联的选定值。

下面是我的代码：

```
<select  name="a[b]" onchange='mySelectHandler("a[b]")'>
     <option value='Choice 1'>Choice 1</option>
     <option value='Choice 2'>Choice 2</option>

</select> 
```

然后，在我的处理程序中，我正在使用：

```
function mySelectHandler(name){
     var mySelect = $('select[name=' + name)
     // try to get selected value
     // alert ("selected " + mySelect.val())
     console.log("object "+ mySelect.toSource());
  } 
```

我打印到日志的结果是：

对象 ({length:0, prevObject:{0:({}), context:({}), length:1}, context:({}), selector:"select[name=a[b]"})

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-08-10T20:58:43.013

您的选择器有点偏离，它缺少尾随`]`

```
var mySelect = $('select[name=' + name + ']') 
```

您可能还需要在名称周围加上引号，如下所示：

```
var mySelect = $('select[name="' + name + '"]') 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-10T21:00:04.720

试试这个：

```
$('select[name="' + name + '"] option:selected').val(); 
```

这将获得菜单的选定值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T21:02:41.833

从 HTML 标记中删除`onchange`事件并将其绑定到您的文档就绪事件中

```
<select  name="a[b]" >
     <option value='Choice 1'>Choice 1</option>
     <option value='Choice 2'>Choice 2</option>
</select>​ 
```

和脚本

```
$(function(){    
    $("select[name='a[b]']").change(function(){
       alert($(this).val());        
    }); 
}); 
```

工作样本：http: [//jsfiddle.net/gLaR8/3/](http://jsfiddle.net/gLaR8/3/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T20:59:53.613

代替

```
mySelect.toSource() 
```

采用

```
mySelect.val() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-10T21:03:19.430

MrOBrian 的回答显示了为什么您当前的代码不起作用，缺少尾随`]`和引号，但这里有一种更简单的方法可以使它起作用：

```
onchange='mySelectHandler(this)' 
```

进而：

```
function mySelectHandler(el){
     var mySelect = $(el)
     // get selected value
     alert ("selected " + mySelect.val())
  } 
```

或者更好的是，完全删除内联事件处理程序并将事件处理程序与 jQuery 绑定：

```
$('select[name="a[b]"]').change(function() {
    var mySelect = $(this);
    alert("selected " mySelect.val());
}); 
```

最后一个需要在 document.ready 处理程序中或出现在 select 元素之后的脚本块中。如果您想为其他选择运行相同的功能，只需将选择器更改为适用于所有的选择，例如，*所有*选择将是`$('select')`，或者所有具有特定类的都是`$('select.someClass')`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-09T11:47:19.517

试试这个以通过元素名称从选择元素中获取值

```
$("select[name=elementnamehere]").val(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-08-11T18:52:46.260

或者你可以简单地做

```
$('select[name=a[b]] option:selected').val() 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-11-22T13:31:42.943

`select`要在此处添加答案，请确保和之间没有空格`[name...`

**错误的：**

```
'select [name=' + name + ']'
       ^ 
```

**对：**

```
'select[name=' + name + ']' 
```

# php - 从 php 数据库嵌入 html5 视频

> ID：11909113
> 
> 赞同：3
> 
> 时间：2012-08-10T20:55:56.393
> 
> 标签：php, html, cakephp

我正在创建一个网站，用户可以在其中搜索和播放视频（存储在我们的服务器上）。我有其他人在做很多后端工作，但他不知道如何将视频从 php 数据库嵌入到网页中。

我听说这可能很难做到，但如果有人至少可以让我开始，我将非常感激。

如果有帮助，我们将使用 CakePHP 作为后端的东西。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T23:17:12.090

我看不出视频必须存储在数据库中的原因。如果我是你，我会将其存储在一个专用文件夹中，例如`myApplication/static/videos/`，然后只需将一条记录添加到`videos`数据库表中，其中包含有关视频的相关信息，可能如下所示：

*   作者
*   关键词
*   描述
*   视频宽度
*   视频高度
*   **服务器上源文件的路径**
*   视频类型、mp4 等

之后，它就非常简单了：在关键字或匹配描述之后搜索数据库 - 并在匹配时简单地生成`HTML5`标记：

```
// Gather information about the video
$video_data = get_video($id);

$markup = "<video width='". $video_data['source_width'] ."' height='". $video_data['source_height'] ."' controls='controls'>
  <source src='". $video_data['source_path'] ."' type='". $video_data['type'] ."' />
</video>"; 
```

确保清除来自将存储在数据库中的用户的任何输入。这不包括源路径，它应该在文件上传时生成，不需要任何用户交互，也就是说，如果您要允许用户上传文件。

# regex - 在 Vim 中用 '\%' 排除匹配？

> ID：11909115
> 
> 赞同：2
> 
> 时间：2012-08-10T20:56:05.230
> 
> 标签：regex, vim, csv

我有一个看起来像这样的 CSV 文件：

```
productSku-1,attribute1,2,3
productSku-1,attribute4,5
productSku-1,attribute4,5
productSku-2,attribute1,2,3
productSku-2,attribute4,5
productSku-3,attribute1,1 
```

我试图将相同的产品属性“折叠”成一行，同时去掉`productSku`. 因此，我将产品与下一行匹配，然后删除下一`productSku`行以及换行符以将其压缩为一行。在上面的示例中，结果应如下所示：

```
productSku1,attribute1,2,3,attribute4,5,attribute4,5
productSku2,attribute1,2,3,attribute4,5
productSku3,attribute1,1 
```

我认为以下替换命令会起作用，但我从未使用过该`\%` 符号。

```
:%s/(^[A-Za-z0-9-]+)(.)((\%(\n\1)(.))+)/\1\2\3 
```

我认为它会从匹配中排除匹配 `\3`......但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T05:07:40.943

解决这个问题的一种方法是这样的：

```
:sort
qqjkdt,:g/<C-r>"/norm dt,-gJ<Enter>0P+q
10000@q 
```

### 一步步

`:sort`- 按 productSku 对所有行进行排序

`qq`- 开始录音，见`:help qq`

`jk`- 这是一个小宏黑客......如果我们到达最后一行，它将抛出一个错误，并且命令的其余部分将不会执行。

`dt,`- 删除productSku

`:g/`- 启动`:global`命令，见`:help :global`

`<C-r>"`- 插入`"`寄存器的内容（我们删除的productSku）

`norm`- 短缺`:help :normal`

`dt,`- 删除 productSku，因为我们不想要它们

`-`- 转到上一行

`gJ`- 加入没有任何空格的行

`<Enter>`- 完成`:global`命令

`0P`- 将 productSku 放回行首

`+`- 下移一行

`q`- 完成录音

`10000@q`重复录音 10k 次（或更多，如果你需要）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T12:04:57.443

我会使用以下有效的命令。

```
:g/\%(^\1,.*\n\)\@<=\([^,]*\)/s/$/,/|-j! 
```

# c++ - 在 C++ 中迭代地连接两个字符串

> ID：11909116
> 
> 赞同：2
> 
> 时间：2012-08-10T20:56:10.717
> 
> 标签：c++, string-concatenation

我知道一个字符串连接问题在 SE 中被问死了。但据我所知，我已经解决了所有可以帮助我的问题，但都是徒劳的。

这是我希望通过这个程序完成的：

最初我有 a=0 和 b=1，分别代表 n=0 和 n=1。

对于下一个输入，即从 n=3 开始，我的结果应该是前两个字符串的连接。（就像一个斐波那契数列；只有加法被串联代替）

因此，例如：
对于 n=3，我的输出应该是“10”。
对于 n=4，我的输出应该是“101”
对于 n=5，我的输出应该是“10110”

我编写的代码没有逻辑问题，但我收到 SIGSEGV 错误，我不明白为什么。

```
#include <iostream>
#include<new>
#include<string.h>

using namespace std;

int main()
{
    long int n,i;
    char *a="0";
    char *b="1";
    char *c=new char[100000];

cout<<"Enter  a number n:";
cin>>n;

for(i=0;i<n;i++)
{

    strcat(b,a);
    strcpy(a,b);

}
cout<<"\nRequired string="<<b; 
```

}

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T20:59:08.643

`strcat(b,a);`调用未定义`b`的行为，因为指向字符串文字。

```
char * strcat ( char * destination, const char * source ); 
```

> 连接字符串 将字符串的副本附加`source`到`destination`字符串。

由于这是 C++，我建议你使用`std::string`和`+`运算符。或者一个`std::stringstream`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T20:59:16.173

您观察到的问题与未定义的行为有关：您正在写入已分配给字符串文字的内存。

为避免该问题，您应该改用 C++ `std::string`：通过将内存管理排除在外，它使您的代码更加简单。

```
string a("0");
string b("1");
int n = 10;
for(int i=0;i<n;i++) {
    string tmp(a);
    a = b;
    b = tmp + b;
}
cout<<"Required string="<<b; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T20:59:47.123

```
char *a="0";
char *b="1"; 
```

“0”和“1”是`string-literals`（a的地址为“0”，b的地址为“1”），其包含的变化是`undefined behaviour`。

```
strcat(b,a);
strcpy(a,b); 
```

UB。

由于您使用 C++ 更好地使用`std::string`or `std::stringstream`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T21:00:32.507

您已声明`a`并`b`作为

```
char *a="0"; 
char *b="1"; 
```

这些是指向常量字符串的指针。这意味着分配给这些指针的内存是固定的。当你写过去这块内存时，Bad Things(TM) 就会发生。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-10T21:02:50.133

您正在使用`strcat`，但您的目标字符串是字符串文字。`strcat`然后试图写过去那个终止空字符的字符串，这就是段错误出现的地方。根本不要尝试修改字符串文字。由于您可以使用 C++，除非这是一个学习练习，您最好使用 std::string。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-10T21:10:28.533

您可以改用此代码，我向您展示您需要考虑 n = 1, 2 的初始值，您还应该处理 n < 0 的错误输入并避免动态分配，因为您似乎使用 new 没有明显原因，你忘了在最后用 delete 释放内存。

```
#include <iostream>
#include<new>
#include<string.h>

using namespace std;

int main()
{
    long int n,i;
    char a[10];
    char b[10];
    char c[10];
    //char *c=new char[100000];
    cout<<"Enter  a number n:";
    cin>>n;

    strcpy(a, "0");
    strcpy(b, "1");

    if (n == 1)
        strcpy(b, a);
    else if (n > 2)
    {
        for(i=2;i<n;i++)
        {
            strcpy(c, a);
            strcat(c, b);
            strcpy(a, b);
            strcpy(b,c);
        }
    }
    else if (n != 2)
        cout<<"\nInvalid input!";

    cout<<"\nRequired string="<<b; 
```

}

# c# - 使用 Unity 拦截所有对 IMyInterface.SomeMethod 的调用

> ID：11909117
> 
> 赞同：17
> 
> 时间：2012-08-10T20:56:14.503
> 
> 标签：c#, .net, unity-container, unity-interception

我正在尝试学习 Unity 拦截器，但我很难做到。

假设我有一个这样的界面：

```
public interface IMyInterface
{
   void SomeMethod();
} 
```

而且我有未知数量的类实现了这样的接口：

```
public class SpecificClass1 : IMyInterface
{
   public void SomeMethod()
   {
       Console.WriteLine("Method Called");
   }
} 
```

我正在寻找一种说法，“对于 IMyInterface 的所有实例（我不想枚举它们），当调用 SomeMethod 时运行我的拦截器。

给我带来麻烦的是类的非枚举。（如果您可以枚举所有类，则有很多示例。）

我已经阅读了类型拦截，但我似乎无法确定它是否会满足我的要求。

那里有任何 Unity 专家知道如何做我正在寻找的东西吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-10T21:50:21.090

您可以创建`InterceptionBehavior`然后在特定类上注册它。`Invoke`请注意，您可以通过过滤执行方法`IMethodInvocation input`

```
using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.Practices.Unity;
using Microsoft.Practices.Unity.InterceptionExtension;
using NUnit.Framework;

namespace UnitTests
{
    [TestFixture]
    public class ForTest
    {
        [Test]
        public void Test()
        {
            IUnityContainer container = new UnityContainer().AddNewExtension<Interception>();
            container.RegisterType<IMyInterface, SpecificClass1>(
                new Interceptor<InterfaceInterceptor>(),
                new InterceptionBehavior<MyInterceptionBehavior>());
            var myInterface = container.Resolve<IMyInterface>();
            myInterface.SomeMethod();
        }
    }

    public interface IMyInterface
    {
        void SomeMethod();
    }

    public class SpecificClass1 : IMyInterface
    {
        #region IMyInterface

        public void SomeMethod()
        {
            Console.WriteLine("Method Called");
        }

        #endregion
    }

    public class MyInterceptionBehavior : IInterceptionBehavior
    {
        public bool WillExecute
        {
            get { return true; }
        }

        #region IInterceptionBehavior

        public IEnumerable<Type> GetRequiredInterfaces()
        {
            return Enumerable.Empty<Type>();
        }

        public IMethodReturn Invoke(IMethodInvocation input, GetNextInterceptionBehaviorDelegate getNext)
        {
            IMethodReturn result = getNext()(input, getNext);
            Console.WriteLine("Interception Called");
            return result;
        }

        #endregion
    }
} 
```

控制台输出

```
Method Called
Interception Called 
```

[有关使用 Unity 进行拦截的](http://msdn.microsoft.com/en-us/library/ff660891%28v=pandp.20%29.aspx)更多信息

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-12T07:29:33.443

@GSerjo，概述了运行良好的 Unity 拦截方法。如果您想自动配置拦截，您可以使用 UnityContainerExtension 自动连接所有接口拦截以及行为。如果您想进行更具体的拦截（方法名称、签名、返回值等），那么您可能需要查看 Policy Injection（使用与 CallHandlers 匹配的规则）。

所以在这种情况下，容器扩展看起来像：

```
public class UnityInterfaceInterceptionRegisterer : UnityContainerExtension
{
    private List<Type> interfaces = new List<Type>();
    private List<IInterceptionBehavior> behaviors = 
        new List<IInterceptionBehavior>();

    public UnityInterfaceInterceptionRegisterer(Type interfaceType, 
        IInterceptionBehavior interceptionBehavior)
    {
        interfaces.Add(interfaceType);
        behaviors.Add(interceptionBehavior);
    }

    public UnityInterfaceInterceptionRegisterer(Type[] interfaces, 
        IInterceptionBehavior[] interceptionBehaviors)
    {            
        this.interfaces.AddRange(interfaces);
        this.behaviors.AddRange(interceptionBehaviors);

        ValidateInterfaces(this.interfaces);
    }

    protected override void Initialize()
    {
        base.Container.AddNewExtension<Interception>();

        base.Context.Registering += 
            new EventHandler<RegisterEventArgs>(this.OnRegister);
    }

    private void ValidateInterfaces(List<Type> interfaces)
    {
        interfaces.ForEach((i) =>
        {
            if (!i.IsInterface)
                throw new ArgumentException("Only interface types may be configured for interface interceptors");
        }
        );
    }

    private bool ShouldIntercept(RegisterEventArgs e)
    {
        return e != null && e.TypeFrom != null && 
               e.TypeFrom.IsInterface && interfaces.Contains(e.TypeFrom);
    }

    private void OnRegister(object sender, RegisterEventArgs e)
    {
        if (ShouldIntercept(e))
        {
            IUnityContainer container = sender as IUnityContainer;

            var i = new Interceptor<InterfaceInterceptor>();
            i.AddPolicies(e.TypeFrom, e.TypeTo, e.Name, Context.Policies);

            behaviors.ForEach( (b) =>
                {
                    var ib = new InterceptionBehavior(b);
                    ib.AddPolicies(e.TypeFrom, e.TypeTo, e.Name, Context.Policies);
                }
            );
        }
    }
} 
```

然后你可以像这样使用它：

```
IUnityContainer container = new UnityContainer()
    .AddExtension(new UnityInterfaceInterceptionRegisterer(
        new Type[] { typeof(IMyInterface), 
                     typeof(IMyOtherInterface) }, 
        new IInterceptionBehavior[] { new MyInterceptionBehavior(), 
                                      new AnotherInterceptionBehavior() }
        ));

container.RegisterType<IMyInterface, SpecificClass1>();

var myInterface = container.Resolve<IMyInterface>();
myInterface.SomeMethod(); 
```

现在，当接口注册时，相应的拦截策略也将添加到容器中。因此，在这种情况下，如果注册的接口是 IMyInterface 或 IMyOtherInterface 类型，则将为接口拦截设置策略，并且还将添加拦截行为 MyInterceptionBehavior 和 AnotherInterceptionBehavior。

请注意，Unity 3（在此问题/答案之后发布）添加了[按约定注册](https://msdn.microsoft.com/en-us/library/dn178463(v=pandp.30).aspx#sec23)功能，可以执行此扩展的功能（无需编写任何自定义代码）。[使用 Unity 进行依赖注入](https://msdn.microsoft.com/en-us/library/dn223671(v=pandp.30).aspx)的开发人员指南中的一个示例：

```
var container = new UnityContainer();

container.AddNewExtension<Interception>();
container.RegisterTypes(
    AllClasses.FromLoadedAssemblies().Where(
      t => t.Namespace == "OtherUnitySamples"),
    WithMappings.MatchingInterface,
    getInjectionMembers: t => new InjectionMember[]
    {
      new Interceptor<VirtualMethodInterceptor>(),
      new InterceptionBehavior<LoggingInterceptionBehavior>()
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T21:30:27.953

设置拦截需要多个操作，包括。拦截类型、策略和处理程序的配置。

首先请参阅[在应用程序中使用拦截以](http://msdn.microsoft.com/en-us/library/ff660848%28v=pandp.20%29.aspx)了解有关支持拦截的情况类型的一般详细信息（例如，使用或不使用 DI 容器）。然后查看[类型拦截](http://msdn.microsoft.com/en-us/library/ff660861%28v=pandp.20%29.aspx#_Type_Interception)以获取有关支持的类型拦截器的更多详细信息。特别注意哪些拦截器可以与您的类的类型一起使用（否则处理程序将永远不会触发）。

当您决定使用什么拦截器后，根据上面的链接对其进行配置并创建一个足够的调用处理程序。如果此时您仍有问题，请发布更详细的问题。如果您已经这样做了，请将配置和代码发布为“类的非枚举”根本不会给出您实际要求的任何提示。您是否有任何机会意味着您分配了属性驱动的策略并且没有它就无法实现您想要的“枚举”？

# c# - 如何在 C# 中使用 MeasureString 设置表格列宽？

> ID：11909119
> 
> 赞同：1
> 
> 时间：2012-08-10T20:56:27.787
> 
> 标签：c#, string, graphics, width

我有一个很快（我希望是基本的）问题。我正在为我公司的网站修改一些 C# 代码。该代码在固定列中为我绘制了一个表格，其数据是从数据库中提取的。表格每列的高度是固定的（当前），我需要更改它，因此如果字符串有一定长度并因此换行，则第二行文本是可见的（而不是被下一行隐藏） .

根据我的研究，似乎我可以使用 MeasureString（因为我知道字体和字符串）来查看字符串是否比我设置的表格列长/宽，如果是这样，则更改行的高度。但是，我对 C# 编程非常陌生（多年来总体上没有做过太多编程，除了 Web 的东西），所以我不确定如何实现所有这些。我有适当的逻辑，我知道如何改变高度，我只需要知道如何获得一个实际数字我可以使用逻辑来反对使用 MeasureString 方法（以及如何实例化我可能需要使用的任何变量和函数那个方法）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:14:22.270

我相信您需要将此重载用于[`MeasureString(string,font,int)`](http://msdn.microsoft.com/en-us/library/9bt8ty58.aspx)：

> width 参数指定返回的 SizeF 结构的宽度分量的最大值（Width）。如果 width 参数小于字符串的实际宽度，则返回的 Width 组件将被截断为一个值，该值表示将适合指定宽度的最大字符数。**为了容纳整个字符串，返回的 Height 组件被调整为一个允许显示带有字符换行的字符串的值。**

-- 从上面链接的 MSDN 页面（重点是我的）

```
// Measure string (you'll need to instansiate your own graphics object, 
// since you wont have PaintEventArgs)
SizeF stringSize = new SizeF();
stringSize = e.Graphics.MeasureString(measureString, stringFont, stringWidth);
int cellHeight = stringSize.Height; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:20:42.887

您可以使用`e.Graphics.MeasureString()`或`TextRenderer.MeasureText()`

它们各自的区别和优点如下所述：

[TextRenderer.MeasureText 和 Graphics.MeasureString 大小不匹配](https://stackoverflow.com/questions/6704923/textrenderer-measuretext-and-graphics-measurestring-mismatch-in-size)

在那里您还可以找到使用示例，我将在此处跳过以避免重复。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T21:21:13.823

MSDN 提供了一个示例，您可以通过将事件处理程序注册到控件的 OnPaint 方法（在实例化控件中），或通过覆盖 OnPaint 方法（在继承的控件中），或通过覆盖表单的 OnPaint 方法（不是最好的练习，因为您可能不想为每个表单重绘都这样做）。OnPaint 方法将使您能够访问图形对象，因此您可以调用 MeasureString 方法。

考虑以下：

```
public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            label1.Paint += new PaintEventHandler(label1_Paint);
        }

        void label1_Paint(object sender, PaintEventArgs e)
        {
            SizeF size = e.Graphics.MeasureString(label1.Text, label1.Font);
            this.label1.Width = (int)size.Width;
            this.label1.Height = (int)size.Height;
        }
    } 
```

# c# - Web 角色部署期间缺少 Microsoft.WindowsAzure.Diagnostics

> ID：11909120
> 
> 赞同：6
> 
> 时间：2012-08-10T20:56:32.167
> 
> 标签：c#, .net, azure, azure-web-app-service

使用 Visual Studio 2012 RC，从页面中，我启动了 Azure 云服务。我选择了 MVC 4，包含了一个测试项目，并在构建时启用了 NuGet 包恢复。

当我使用 git 将它部署到 Azure 网站时，目标框似乎既不包含 the ，也不包含`WindowsAzure.Diagnostics` *库*`WindowsAzure.ServiceRuntime`。一般来说，我是 .NET 的新手，但我无法想象我在这里缺少什么。此外，虽然我可以从引用中轻松删除诊断（没有诊断，没问题），但似乎我不能对 ServiceRuntime 做同样的事情。

**我做错了什么，还是 Azure 网站中的错误？它可以修复吗？**

```
C:\... [master]> git push azure master
Counting objects: 17, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (11/11), done.
Writing objects: 100% (12/12), 216.47 KiB, done.
Total 12 (delta 5), reused 0 (delta 0)
remote: New deployment received.
remote: Updating branch 'master'.
remote: Preparing deployment for commit id '2cb9c59bd0'.
remote: Building web project 'MvcWebRole1.csproj'.
remote: ..
remote:   Successfully installed 'Microsoft.AspNet.WebApi 4.0.20505.0'.
remote:   Successfully installed 'Microsoft.AspNet.Web.Optimization 1.0.0-beta2'.
remote:   Successfully installed 'jQuery.Validation 1.8.1'.
remote:   Successfully installed 'Microsoft.AspNet.Razor 2.0.20505.0'.
remote:   Successfully installed 'Microsoft.AspNet.Providers.Core 1.0'.
remote:   Successfully installed 'Microsoft.AspNet.Providers.LocalDb 1.0'.
remote:   Successfully installed 'jQuery.UI.Combined 1.8.11'.
remote:   Successfully installed 'jQuery 1.6.2'.
remote:   Successfully installed 'Microsoft.AspNet.WebApi.Client 4.0.20505.0'.
remote:   Successfully installed 'Microsoft.AspNet.Mvc 4.0.20505.0'.
remote:   Successfully installed 'Microsoft.AspNet.WebApi.Core 4.0.20505.0'.
remote:   Successfully installed 'Microsoft.AspNet.WebApi.WebHost 4.0.20505.0'.
remote:   Successfully installed 'Microsoft.jQuery.Unobtrusive.Ajax 2.0.20505.0'.
remote:   Successfully installed 'Microsoft.jQuery.Unobtrusive.Validation 2.0.20505.0'.
remote:   Successfully installed 'Microsoft.Web.Infrastructure 1.0.0.0'.
remote:   Successfully installed 'Microsoft.AspNet.WebPages 2.0.20505.0'.
remote:   Successfully installed 'Modernizr 2.0.6'.
remote:   Successfully installed 'Microsoft.WindowsAzure.ConfigurationManager 1.7.0.0'.
remote:   Successfully installed 'Microsoft.Net.Http 2.0.20505.0'.
remote:   Successfully installed 'WebGrease 1.0.0'.
remote:   Successfully installed 'EntityFramework 5.0.0-rc'.
remote:   Successfully installed 'WindowsAzure.Storage 1.7.0.0'.
remote:   Successfully installed 'knockoutjs 2.0.0'.
remote:   Successfully installed 'Newtonsoft.Json 4.5.1'.
remote: D:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets(1360,9): warning MSB3245: Could not resol
ve this reference. Could not locate the assembly "Microsoft.WindowsAzure.Diagnostics, Version=1.7.0.0, Culture=neutral,
PublicKeyToken=31bf3856ad364e35". Check to make sure the assembly exists on disk. If this reference is required by your
code, you may get compilation errors. [C:\DWASFiles\Sites\barf\VirtualDirectory0\site\repository\MvcWebRole1\MvcWebRole1
.csproj]
remote: D:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets(1360,9): warning MSB3245: Could not resol
ve this reference. Could not locate the assembly "Microsoft.WindowsAzure.ServiceRuntime, Version=1.7.0.0, Culture=neutra
l, PublicKeyToken=31bf3856ad364e35". Check to make sure the assembly exists on disk. If this reference is required by yo
ur code, you may get compilation errors. [C:\DWASFiles\Sites\barf\VirtualDirectory0\site\repository\MvcWebRole1\MvcWebRo
le1.csproj]
remote: WebRole.cs(5,30): error CS0234: The type or namespace name 'Diagnostics' does not exist in the namespace 'Microsoft.WindowsAzure' (are you missing an assembly reference?) [C:\DWASFiles\Sites\barf\VirtualDirectory0\site\repository\Mv
cWebRole1\MvcWebRole1.csproj]
remote: WebRole.cs(6,30): error CS0234: The type or namespace name 'ServiceRuntime' does not exist in the namespace 'Microsoft.WindowsAzure' (are you missing an assembly reference?) [C:\DWASFiles\Sites\barf\VirtualDirectory0\site\repository\MvcWebRole1\MvcWebRole1.csproj]
remote: WebRole.cs(10,28): error CS0246: The type or namespace name 'RoleEntryPoint' could not be found (are you missing a using directive or an assembly reference?) [C:\DWASFiles\Sites\barf\VirtualDirectory0\site\repository\MvcWebRole1\Mvc
WebRole1.csproj]
remote:
remote: Error - Changes committed to remote repository but your website not updated. 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-05T05:35:17.197

由于程序集引用，您收到此错误。

如果安装了 Microsoft SDK，引用将在引用文件夹中。如果它不存在，那么我们必须浏览添加到解决方案中。即使我在运行解决方案时遇到了同样的问题。现在我解决了这个问题并且它工作正常。

如果我们安装了 windows azure sdk

> "C:\Program Files\Microsoft SDKs\Windows Azure\.NET SDK\2012-10\ref"

所有参考都将在这里。只需将此参考添加到您的解决方案并构建它，就可以了。

希望这可能会有所帮助，

谢谢，

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-16T02:41:46.140

这个问题得到了明确的回答。

但是，最简单的解决方法是将[AzureSDK2.2DLL](https://www.nuget.org/packages/AzureSDK2.2DLLs/)添加到您的 Web 角色项目中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T22:03:29.520

我相信这是因为您使用的是 Visual Studio 2012 Release Candidate，而适用于 Visual Studio 2012 的 Windows Azure 工具尚未发布。使用 Visual Studio 2010 尝试相同的代码，应该会找到所有程序集并解决问题。

# javascript - 禁用基于下拉选择asp.net javascript的启用文本框

> ID：11909121
> 
> 赞同：1
> 
> 时间：2012-08-10T20:56:36.550
> 
> 标签：javascript, asp.net, html, drop-down-menu

大家五一快乐！我正在尝试根据下拉选择启用/禁用文本框。如果下拉选择索引 == 0 则应启用文本框，否则应禁用它。这是我尝试过的：

```
 <tr>
                            <td></td>
                            <td class="selection">
                            <asp:dropdownlist id="ddlWindSpeed" onchange="HideTextBox(this);" runat="server" />
                            </td>
                            <td class="formField">
                                <asp:textbox id="txtActualWindSpeed" MaxLength="50" runat="server" />
                            </td> 
```

这是JS函数：

```
function HideTextBox(ddlId)
            {
             var ControlName = document.getElementById(ddlId.id);

             if(ControlName.value == 0)  //it depends on which value Selection do u want to hide or show your textbox
             {
                 document.getElementById('txtActualWindSpeed').style.display = '';

             }
             else
             {
                 document.getElementById('txtActualWindSpeed').style.display = 'none';

             }
        } 
                        </tr> 
```

使用它我收到此消息：

**SCRIPT5007：无法获取属性“样式”的值：对象为空或未定义**

知道我在做什么错吗？谢谢，拉齐尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:25:53.540

尝试`document.getElementById('<%=txtActualWindSpeed.ClientID%>')`

# javascript - JavaScript - 需要帮助组合两个脚本。

> ID：11909123
> 
> 赞同：-1
> 
> 时间：2012-08-10T20:56:42.250
> 
> 标签：javascript, html

我正在尝试调用用户输入数组。

我对 Javascript 很陌生，但知道我需要以某种方式引用数组（它是我放置 ??? 的地方）。

```
<script> 
var arrayX =5; 
var arrayY =1; 
var array=new Array(arrayX); 
var planetIndex=0; 

for (x=0; x<array.length; x++) 
{array [x] = new Array(arrayY);} 

function insert(val1){ 
    array[planetIndex][0]=val1; 
    planetIndex++; 
    document.getElementById('name').value = ''; };

function worldChange() {
        var newplanet = ????????????
        var whichWorld = Math.floor(Math.random()*newplanet.length); 
        return planetIndex[whichWorld];

        var planets = document.getElementsByClassName("world-name")
              for (var i=0; i < planets.length; i++) {
                planets[i].innerHTML = worldChange();};
        };

</script>
<body> 
   <div>  
    <form> 
              <input type="integer" id="name"/>
            <input type="button" value="Add Planets" onclick="insert   (this.form.name.value);"/> 
        </form>

        <input type="button" value="See planet!" onClick="worldChange()" />
        <br> Hello <span class="world-name">Earth!</span><br /> 
</div>
</body> 
```

我让脚本的两个元素在我的网站上完美运行，所以每次有人点击一个按钮时，它都会改变故事中的人物。但是正如你所看到的，如果从我创建的数组中提取。我想从用户创建的数组中提取数据，以便他们可以输入自己的姓名列表。

所以这个脚本工作正常：

```
function newGuy() {
        var guys = new Array ("Jeff", "Mike", "George", "Harold");
        var whichGuy = Math.floor(Math.random()*guys.length); 
        return guys[whichGuy];}

var guy = document.getElementsByClassName("guy")
     for (var i=0; i < guy.length; i++) {
        guy[i].innerHTML = newGuy();} 
```

这个脚本单独工作：

```
var arrayX =5; 
var arrayY =1; 
var array=new Array(arrayX); 
var guyIndex=0; 

for (x=0; x<array.length; x++) 
{array [x] = new Array(arrayY);} 

function insert(val1){ 
    array[guyIndex][0]=val1; 
    guyIndex++; 
    document.getElementById('name').value = ''; }; 
```

只是对如何将它们放在一起感到困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:00:41.610

您的脚本存在很多问题，但为了让您了解如何使其工作：

```
var planets = [];
// define how many planets there will be initially
var initialLength = 5;

// add the initital planets
for (x = 0; x < initialLength; x++) {
    planets.push("planet" + x);
}

function insert() {
        var planetToInsert = document.getElementById('name').value;
    if (planetToInsert) {
        // add the input to the array of planets
        planets.push(planetToInsert);
        document.getElementById('name').value = '';
    } else {
        alert("please enter a value");
    }
}

function worldChange() {
    // randomly pick an index
    var whichWorld = Math.floor(Math.random() * planets.length);
    document.getElementById('world-name').innerHTML = planets[whichWorld];
} 
```

工作样本[在这里](http://jsfiddle.net/jJFYw/)

对于在您的代码中查找问题，jsFiddle 可以提供极好的帮助。运行 JSlint 查找基本错误，将警报作为糟糕的 mans 调试。

对于一本好的 javascript 书，我会推荐[javascript 模式](http://shop.oreilly.com/product/9780596806767.do)

# hibernate - 如何根据 jpa / hibernate 中的连接表对条件进行建模？

> ID：11909129
> 
> 赞同：0
> 
> 时间：2012-08-10T20:57:19.767
> 
> 标签：hibernate, jpa

我试图通过制作一个毫无意义的应用程序来教自己休眠，该应用程序包含我的本地酒吧列表，用户可以标记访问或不访问，所以基本上是一个花哨的勾选列表。

如果我使用原始 sql 编写此代码，我将有一个 pubs 表、一个用户表和一个连接表，该表将其他两个表中的 id 链接起来，以防某个 pub 已被标记为为特定用户访问。

我用来获取指定用户的已访问状态的完整列表的查询将是这样的（在 postgres 中）

```
SELECT *, (CASE WHEN up.id IS null THEN 0 ELSE 1 END) AS visited 
FROM pubs p  
LEFT JOIN users_pub up ON p.id = up.pubId 
```

我试图弄清楚如何注释我的模型类以显示这个访问的属性。想法？

对于初学者来说，hibernate 文档可能非常笨拙，因此即使朝正确的方向轻推也会受到赞赏。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T04:08:47.313

对此进行建模的最简单方法是一个`User`具有`@ManytoMany`集合的类`Pub`，因此您可以读取用户并获取他们访问过的酒吧的集合。

那么在 User 上实现一个方法就很容易了，比如：

```
hasVisitedPub(id) 
```

如果该 pub 在他们的`pubsVisited`集合中，则返回 true。

`Map<id, Pub>`如果您想让访问过大量酒吧的人更有效地查找，请使用 a ，因为他们应该这样做 :-)

# php - 如何从 timthumb 的缓存中删除特定文件？

> ID：11909133
> 
> 赞同：0
> 
> 时间：2012-08-10T20:57:27.023
> 
> 标签：php, timthumb

我有一个照片共享应用程序，我使用[timthumb](http://code.google.com/p/timthumb/)来显示缩略图。当用户删除照片时，我希望缓存的图像也从 timthumb 的缓存目录中删除以节省空间。目前我只能从缓存中删除所有文件，但这并不理想。

给定原始图像，如何仅从 timthumb 的缓存中删除特定文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T01:11:40.080

假设我们要删除本地图像的缓存文件：

我们需要的第一件事是 cacheDirectory = **'./cache'**
第二， FILE_CACHE_PREFIX = **'timthumb'**
然后它是内部的**(_int_)**
然后有一个**md5**哈希：

*   timthumb.php的修改时间
*   字符'-'
*   timthumb.php 的 inode
*   图片修改时间
*   调用图像时的 $_SERVER ['QUERY_STRING']
*   *'fileCacheVersion'*始终是数字1

最后，FILE_CACHE_SUFFIX = **'.timthumb.txt'**

例如：

HTML：

```
<img src='timthumb.php?src=images/example.png&w=150'> 
```

PHP：

```
$cachefile = 'cache/timthumb_int_'.md5(filemtime('timthumb.php') . '-' . fileinode('timthumb.php') . filemtime("images/example.png"). "src=images/example.png&w=150" . 1) . '.timthumb.txt';
unlink($cachefile); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T02:08:38.213

我来到了这个解决方案。我必须对文件进行少量修改，`timthumb.php` 以便可以包含该文件并从另一个文件实例化该类。

**timthumb.php：**

```
<?php

// If this file is included from other script, don't start timthumb
if (basename($_SERVER['SCRIPT_NAME']) == basename(__FILE__)) {
  timthumb::start();
}

class timthumb {
  ...
  // $cachefile is protected so I create a getter function
  public function getCacheFile() {
    return $this->cachefile;
  }
} 
```

现在我可以获取给定图像的缓存文件名并将其删除。代码不漂亮，但我需要节省空间。

**删除缓存.php：**

```
<?php
require 'timthumb.php';

// Fake the query string
$_SERVER['QUERY_STRING'] = 'src=path/to/src/image.jpg&w=200&h=150';
parse_str($_SERVER['QUERY_STRING'], $_GET);

// When instantiated, timthumb will generate some properties: 
// salt, directories, cachefile, etc.
$t = new timthumb();

// Get the cache file name
$f = $t->getCacheFile();

// Delete the file
if (file_exists($f)) {
    unlink($f);
} 
```

# asp.net - 需要为当月的天数复制控件

> ID：11909135
> 
> 赞同：0
> 
> 时间：2012-08-10T20:57:32.950
> 
> 标签：asp.net

我正在创建一个包含多个 . 在下面的代码中；我需要在下面突出显示的部分中复制当月天数的控件。而不是手动编写代码的突出显示部分 30 或 31 次；有没有更好的方法来完成它？

```
enter code here 
```

```
 <tr id="Tr4" style="height:72px" runat="server"> 
        <td valign="top" colspan="1" align="center" class="Employee" width="150" style="display:none"> 
            <asp:Label ID="lblCounter" name="lblCounter" runat="server" Text='<%# Container.DataItemIndex + 1 %>'/> 
         <td valign="top" colspan="1" align="center" class="Employee" width="150" style="display:none"> 
            <asp:Label ID="lblRecordID" name="lblRecordID" runat="server" Text='<%#Eval("RecordID") %>'/> 
        </td> 
     </td> 
        <td valign="top" colspan="1" align="center" class="Employee" width="150" style="display:none"> 
            <asp:Label ID="lblEmployeeID" name="lblEmployeeID" runat="server" Text='<%#Eval("EmployeeID") %>'/> 
        </td> 

     <td valign="top" colspan="1" align="center" class="Employee" width="150"> 
         <asp:Label ID="lblEMployeeName" runat="server" Text='<%#Eval("EmployeeName")%>' /> 
     </td> 
```

' Columns="1" style="text-align:right"/>

```
 <asp:Label ID="lblHoursWorked2" runat="server" Text='HoursWorked' /> 
         <asp:TextBox ID="txtHoursWorked2" runat="server" AutoPostBack="true" 
            Text='' Columns="1" style="text-align:right"/> 
            <br /> 

         <asp:Label ID="lblOTMealsPaid" runat="server" Text='Meals Paid'/> 
         <asp:TextBox ID="txtOTMealsPaid2" runat="server" AutoPostBack="true" Enabled="false" 
            Text='<%#Eval("OTMealsPaid") %>' Columns="1" style="text-align:right"/> 

         <br /> 
       </td> 

      </tr> 
   </ItemTemplate> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:07:00.793

在 .NET 中快速搜索循环 HTML 之后，我在 .NET MVC 中遇到了这个。

```
@foreach (Object in Model)
{ 
    (displays html and data)
} 
```

假设您可以找到一种方法从 Date 对象循环遍历当前月份中的每一天？

编辑： [.NET MVC3 Html.HiddenFor 在 foreach 循环中期待一个集合？](https://stackoverflow.com/questions/6785187/net-mvc3-html-hiddenfor-inside-of-foreach-loop-expecting-a-collection)

它使用了一种循环形式，您可以使用它来构建......

编辑： ASP.NET MVC 应该与 Java Spring MVC 足够相似，在这种情况下，在您的后端，将一个列表传递给您的模型，并附加一个变量名，该变量名将传递给您的 .NET 页面（视图）。在 HTML 中的页面上，您应该能够执行类似...

```
@foreach (Date day in dateVariable) {
    <!-- your HTML here -->
} 
```

它应该遍历列表中的每个元素，并在每次迭代时将您的 html 粘贴到页面中。

# header - PyQt 表头上下文菜单

> ID：11909139
> 
> 赞同：0
> 
> 时间：2012-08-10T20:57:59.637
> 
> 标签：header, pyqt, contextmenu, qtableview

我正在研究一个 QTableView，它在 PyQt4 中显示来自 QAbstractTableModel 的自定义模型子类。我需要能够允许用户设置他们想要作为特定类型数据的列。为了实现这一点，我想在单击列标题时实现一个上下文菜单，允许选项将其设置为这些类型。我不确定如何创建这样的上下文菜单，它可以区分不同的列。谁能指出我正确的方向？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T23:42:44.923

您可以从标题视图访问信息。您可以执行以下操作：

```
def __init__( self, parent ):
    # initialize class
    ...

    # setup menu options
    header = self.ui.tree.header()
    header.setContextMenuPolicy(Qt.CustomContextMenu)
    header.customContextMenuRequested.connect( self.showHeaderMenu )

def showHeaderMenu( self, point ):
    column = self.ui.tree.header().logicalIndexAt(point.x())

    # show menu about the column
    menu = QMenu(self)
    menu.addAction('Hide Column')

    menu.popup(header.mapToGlobal(pos)) 
```

# php - Extjs：Ajax，代理，使用 JSON 和 JQuery 绘制图表

> ID：11909140
> 
> 赞同：0
> 
> 时间：2012-08-10T20:58:06.267
> 
> 标签：php, javascript, ajax, extjs

我从来没有像 extjs 那样对缺少示例/文档感到沮丧！有人可以对此有所了解：

我很困惑。我有一个 php 传递这个数组：（我的图表会有更多，但出于调试目的取出了大部分）

```
$rows = array ( 
                 "project" => "amt", 
                 "accepted" => 3400, 
                 "rejected"=> 2389, 
                 "deleted" => 1845, 
                 "undefined" => 2006
             );

$options = array("ONE"=> $rows); 
echo json_encode($options); 
```

我以为我可以做这个 Ajax 请求：

```
 /// GET AJAX DATA
Ext.Ajax.request({
    url:'extjs/turnin_chart/chart_data.php',
    success: function(response) {
       var text = Ext.decode(response.responseText);  
       alert(text.ONE);

        }
 }); 
```

但在此之后，我不知道如何将这些数据集成到我的图表存储中。我已经看到了仅使用 $.ajax (jquery) 和其他带有“代理”的示例。有时他们需要一个模型。有人可以解释一下并给出一个很好的例子来说明如何使用 Ajax 和 JSON 将远程数据传递给 extjs 图表吗？

编辑：返回的警报是“[object Object]”。当我转储数组时，我打印了数组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:42:11.367

我不确定你所说的缺乏例子；[Ext JS 文档站点](http://docs.sencha.com/ext-js/4-1/#!/example)上有几十个示例。查看图表示例以了解如何创建图表。[这个图表教程](http://docs.sencha.com/ext-js/4-1/#!/guide/drawing_and_charting)也将非常有帮助。
在相关说明中，您的问题似乎有一半在于不了解商店的工作方式。有关Ext JS Data 包的介绍，[请参见此处。](http://docs.sencha.com/ext-js/4-1/#!/guide/data)
我建议您先直接进行数据检索，然后再转到图表。一次承担整个事情确实会非常令人困惑。

# unit-testing - 是否有一个 Web 服务可以吐出发送的整个请求？

> ID：11909148
> 
> 赞同：0
> 
> 时间：2012-08-10T20:59:00.167
> 
> 标签：unit-testing

如果这不值得“编程”，我深表歉意。我想知道是否存在一个服务，当 HTTP 服务被 ping 时，它会回显与您发出的完全相同的请求作为响应。

我想要这个的原因是我想对我创建的一个类进行单元测试，以构建请求并通过套接字发送它们。我意识到我可以只做某种 Mock 对象，但我认为这比仅仅确保正确构建发送的请求更复杂。

理想情况下，Web 服务会将内容作为正确的 HTTP 1.1 连同我在响应正文中发送的请求信息一起发回。

谢谢！

凯尔

- 编辑 -

只是对解决方案的快速参考。将浏览器指向：[http](http://scooterlabs.com/echo.json) ://scooterlabs.com/echo.json或[http://scooterlabs.com/echo.xml](http://scooterlabs.com/echo.xml)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:02:09.490

这家伙似乎和你有同样的问题 [web service echo test](http://www.cantoni.org/2012/01/08/simple-webservice-echo-test)
参考一些你可能感兴趣的链接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:09:35.570

我想简单的回声有一些用途，但在任何一种真实的交互中，都很难隔离你正在尝试测试的部分。

更通用的方法是使用本地代理服务器，充当您和所有远程站点之间的中间人，并且可以记录 url、响应、内容等。

如果您正在开发服务器端以及客户端，则绝对应该运行服务器站点的本地镜像。

# ruby - 如何使用 Capybara 在两个帧之间切换

> ID：11909149
> 
> 赞同：14
> 
> 时间：2012-08-10T20:59:01.117
> 
> 标签：ruby, capybara

我正在尝试在 2 帧内执行某些操作，但每次尝试在帧之间切换时都会出现错误。例如：

```
# encoding: utf-8

require "capybara/dsl"

Capybara.run_server = false
Capybara.current_driver = :selenium
Capybara.app_host = 'https://hb.posted.co.rs/posted'

class Account
  include Capybara::DSL

  def check_balance
    visit('/')
    page.driver.browser.switch_to.frame 'main'
    fill_in 'korisnik', :with => 'foo'
    fill_in 'lozinka', :with => 'bar'
    click_button 'Potvrda unosa'

    page.driver.browser.switch_to.frame 'header'
    click_on 'Stanje' 
  end
end

account = Account.new
account.check_balance 
```

错误是：

> [远程服务器] file:///tmp/webdriver-profile20120810-9163-xy6dtm/extensions/fxdriver@googlecode.com/components/driver_component.js:6638:in `unknown': 无法定位框架：main (Selenium:: WebDriver::Error::NoSuchFrameError)

问题是什么？也许我在这里做错了什么？

如果我更改切换帧的顺序，那么首先尝试切换到“标题”然后切换到“主”帧，然后会出现同样的错误，只是它说这次没有“主”帧：

```
# encoding: utf-8

require "capybara/dsl"

Capybara.run_server = false
Capybara.current_driver = :selenium
Capybara.app_host = 'https://hb.posted.co.rs/posted'

class Account
  include Capybara::DSL

  def check_balance
    visit('/')
    page.driver.browser.switch_to.frame 'header'
    click_on 'Stanje' 

    page.driver.browser.switch_to.frame 'main'
    fill_in 'korisnik', :with => 'foo'
    fill_in 'lozinka', :with => 'bar'
    click_button 'Potvrda unosa'
  end
end

account = Account.new
account.check_balance 
```

错误：

> [远程服务器] file:///tmp/webdriver-profile20120810-9247-w3o5hj/extensions/fxdriver@googlecode.com/components/driver_component.js:6638:in `unknown': 无法定位框架：main (Selenium:: WebDriver::Error::NoSuchFrameError)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-10T22:28:14.227

**问题**

问题是当你这样做时`page.driver.browser.switch_to.frame`，它会将页面的上下文切换到框架。现在所有针对页面的操作实际上都是针对框架的。因此，当您第二次切换框架时，您实际上是在说在“主”框架内找到“标题”框架（而不是我假设您想要的，主页内的“标题”框架）。

**解决方案 - Capybara inside_frame（推荐）：**

在框架内工作时，您应该使用 Capybara 的`within_frame`方法。你会想做：

```
 def check_balance
    visit('/')

    within_frame('main'){
      fill_in 'korisnik', :with => 'foo'
      fill_in 'lozinka', :with => 'bar'
      click_button 'Potvrda unosa'
    }

    within_frame('header'){
      click_on 'Stanje' 
    }
  end 
```

**解决方案 - Selenium switch_to：**

如果您想自己进行框架管理（即不使用 Capybara 的内置方法），您可以将页面的上下文切换回浏览器，然后切换到第二个框架。这将如下所示。虽然我建议使用内置的 Capybara 方法。

```
 def check_balance
    visit('/')
    page.driver.browser.switch_to.frame 'header'
    click_on 'Stanje' 

    #Switch page context back to the main browser
    page.driver.browser.switch_to.default_content

    page.driver.browser.switch_to.frame 'main'
    fill_in 'korisnik', :with => 'foo'
    fill_in 'lozinka', :with => 'bar'
    click_button 'Potvrda unosa'
  end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T22:34:23.200

我找到了解决方案。inside_frame 按预期工作：

```
# encoding: utf-8

require "capybara/dsl"

Capybara.run_server = false
Capybara.current_driver = :selenium
Capybara.app_host = 'https://hb.posted.co.rs/posted'
class Account
  include Capybara::DSL
  def check_balance
    visit('/')

    within_frame 'main' do
      fill_in 'korisnik', :with => 'foo'
      fill_in 'lozinka', :with => 'bar'
      click_button 'Potvrda unosa'
    end

    within_frame 'header' do
      click_on 'Stanje'
    end
  end
end

account = Account.new
account.check_balance 
```

我在文件[https://github.com/jnicklas/capybara/blob/master/lib/capybara/selenium/driver.rb](https://github.com/jnicklas/capybara/blob/master/lib/capybara/selenium/driver.rb)中找到了 inside_frame 的源代码。从第 81 行开始。

**编辑：** 当我写这个答案时，@JustinKo 回答了问题，所以两个答案都是正确的，但 +1 并接受了他的答案。

# zend-framework - 为 php informix 设置 ZEND 框架

> ID：11909151
> 
> 赞同：0
> 
> 时间：2012-08-10T20:59:14.150
> 
> 标签：zend-framework

我们的组织使用 PHP/Informix 构建 Web 应用程序。目前我们没有任何框架并使用我们自己的库和模块。

现在我们设置了一个新的 apache web 服务器，以便我们可以安装和配置一个框架，可以开发所有全新的 web 应用程序。我正在考虑设置 Zend 框架。（它会与 informix 后端一起使用吗？）。我已经用谷歌搜索并四处寻找信息，但我认为会从这里的专家那里得到一些专家意见。我需要一些建议，以了解如何以正确的方式从头开始。安装、配置、设置版本控制和编写脚本来测试所有基本的 MVC 功能。任何建议和参考都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:23:55.957

如果您使用 Informix Dynamic Server 作为后端，那么可以使用 Zend Framework 的本机数据库类和适配器与 Informix 服务器进行通信。

您的要求是 PHP 必须在编译时支持 PDO（自 PHP 5.1 起默认启用）。然后，您需要下载、编译和安装[PDO_IBM](http://pecl.php.net/package/PDO_IBM) Pecl 包。

为了成功构建 PDO_IBM 扩展，您的系统上必须已经安装了 DB2 客户端（9.1+）。编译扩展模块时，必须告诉它安装这些文件的路径。

[有关PDO_IBM](http://www.php.net/pdo-ibm)的更多信息，[Zend_Db_Adapter](http://framework.zend.com/manual/en/zend.db.adapter.html)讨论了一些关于可用适配器（包括 PDO_IBM）的信息。

还有一个 Pecl 包[PDO_INFORMIX](http://pecl.php.net/package/PDO_INFORMIX)用于与 Informix 服务器通信，但 Zend_Db 不支持这个包。您将只能使用`Zend_Db_Adapter`with`PDO_IBM`与 IDS 服务器进行通信。

希望有帮助。

# java - 带有 Rails 的 JavaScript/Java GWT

> ID：11909161
> 
> 赞同：0
> 
> 时间：2012-08-10T20:59:53.840
> 
> 标签：java, javascript, ruby-on-rails, ruby, gwt

我对 Web 开发还很陌生，所以我有一些基本问题可以让我指出正确的方向。

上周我一直在学习 rails 框架，据我了解，这个框架非常适合构建网站，但您仍然需要 javascript 来构建在浏览器中运行的漂亮前端界面/应用程序。这种理解正确吗？如果不是，为什么 javascript 对几乎所有网站都如此重要？换句话说，你可以用js做什么？

另外，我想知道现在有像 GWT 这样的工具可以将 Java 编译成 js，我是否有必要学习 javascript。我问是因为，我精通 Java，但对 javascript 却一无所知。在我需要学习 javascript 之前，GWT 可以带我走多远，还是我必须学习 javascript？

如果有人可以通过回答这些问题为我指明正确的方向，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T07:18:00.257

GWT 将 Java 编译为 JavaScript，但您仍然需要了解 Web 开发。我见过很多项目在使用 GWT 时出错，因为人们刚开始编写 Java 代码，根本不关心底层平台（浏览器）。

如果您不想关心浏览器，请使用一些插件技术（如果您是受控环境中的应用程序），否则首先了解如何使用 HTML + JS + CSS 构建应用程序。

最终你会发现 GWT 是一个很棒的工具包，用于在 Java 中编写快速的 JavaScript 应用程序，它包含了许多在工具包中构建 Web 应用程序的最佳实践。它有很好的抽象，但是每个抽象都会泄漏，所以你需要对浏览器有很好的了解。您将节省一些事情，例如远离 JavaScript 的不良部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:03:50.620

我现在正在使用 GWT，而且我还没有使用过 Javascript。我会说对于大多数网站，GWT 应该没问题。

# php - 排除php中的多个mysql行

> ID：11909163
> 
> 赞同：0
> 
> 时间：2012-08-10T20:59:59.770
> 
> 标签：php, mysql

我正在使用此代码排除 checkout_success、checkout_without_account 和 index 以及我想添加的更多内容，但我不想每次我想排除某些内容时都继续添加“和 page_alias ！=” *** 。这个方法有效，但是难道没有一种更简洁、更简洁的方式来排除这种 != 格式的多行而不必重复这么多代码吗？

```
$page_query = tep_db_query('select * from ' . TABLE_INFORMATION . ' where languages_id="' . (int)$languages_id . '" and visible=1 and page_alias != "index" and page_alias != "checkout_without_account" and page_alias != "checkout_success" order by v_order asc') ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:03:13.260

使用`IN`语法：

```
WHERE page_alias NOT IN ('checkout_without_account', 'checkout_success', 'foo', 'bar', 'baz', ....) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:36:53.597

“不在”应该解决它：

```
Where fieldname NOT IN ('value1', 'value2', 'value3'); 
```

# c# - Linq查询填充复杂模型？

> ID：11909166
> 
> 赞同：1
> 
> 时间：2012-08-10T21:00:19.790
> 
> 标签：c#, linq

我正在尝试做一些我不确定 LINQ 可以做到的事情——但让我们试试吧！我有2节课；一个是另一个的列表结构：

```
public class1 {
    public int id {get; set;}
    public string title {get; set;}
    public List<class2> subcat {get; set;}
}
public class2 {
    public int Value {get; set;}
    public string Text {get; set;}
} 
```

是否可以用 LINQ 填充这样的结构？就像是：

```
return (from r in results 
    from sub in subresults.Where(sub => sub.id == r.subid).DefaultIfEmpty()
    select new class1  {
        id = r.id,
        title = r.title,
        subcat = [GET TWO COLUMNS FROM 'SUB' INTO THIS]
    }).ToList() 
```

这可能吗？我不想不得不使用嵌套循环等手动构建它们。
提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T21:05:02.610

这是你需要的吗？

```
return (from r in results 
    select new class1  {
        id = r.id,
        title = r.title,
        subcat = (from sub in subresults
                 where sub.id == r.subid
                 select new class2 { Value = sub.Value, Text = sub.Text }).ToList()

    }).ToList() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:19:14.107

您可以使用导航属性在一个查询中加载结果和子结果。

```
from r in results
select new class1  {
    id = r.id,
    title = r.title,
    subcat = r.Subresults.Select(sr =>
             new class2 { Value = sr.Value, Text = sr.Text }) 
```

...假设导航属性`result.Subresults`存在或可以创建方便。

AutoMapper 在这里也很有用。如果您定义了两个映射（`result => class1`, `subresult => class2`），它将自动加载嵌套集合。

# objective-c - 尝试通过函数传递错误时出现错误访问错误

> ID：11909167
> 
> 赞同：3
> 
> 时间：2012-08-10T21:00:19.843
> 
> 标签：objective-c, nserror

我正在尝试在我的班级中实现一些错误处理。我认为我没有完全理解处理错误的工作原理，但我注意到人们建议将函数中的错误声明为 ( `NSError *__autoreleasing *error`)，所以我这样做了。我在通过函数传递错误时遇到问题。

发生以下问题：将其分解似乎会出现以下问题：（对不起，实际代码太长，但我试图提取对问题最重要的部分！我希望我的代码范围包含问题）

想象一下你有**ObjectA**的方法：

```
 -(NSString *) do1: (NSString *) withstuff error:(NSError *__autoreleasing *)error{
         //...
         //error happens
         *error = [[NSError alloc] initwithDomain: domain code: blah userinfo: infodict];
         return nil;
    }
    -(BOOL) do2error:(NSError *__autoreleasing *)error{
         NSString *doesntmatter = [self do1: @"whatever" error: error];
         if (doesntmatter == nil){
              return NO;
         }
    } 
```

现在在另一个类（AppDelegate 对象）中，我调用以下内容：

```
 ObjectA* ob1 = [[ob1 alloc] init];
       NSError *errorBoom = nil;
       if ([ob1 do2error:&errorBoom] == NO){
            NSLog(@"error: %@",errorBoom); //---> bad access error 
       } 
```

似乎 errorBoom 不再可用了？那是因为“__autoreleasing”，我试图理解它的实际含义，但到目前为止所有的解释对我来说都不是很有用，因为我在这个领域很新......我希望你能帮助我！

**编辑：**

好的，我想我找到了错误。现在我知道是什么原因造成的，但我不知道具体原因。我编写了一个简单的示例应用程序，它提取了“Bad Access”-Error 发生的主要来源：

```
 - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions (NSDictionary *)launchOptions
    {
        self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
        // Override point for customization after application launch.
        NSError *errtest = nil;
        BOOL testBool = [self messaroundwitherr:&errtest];
        NSLog(@"Filled NSError? : %@",errtest); //<--Causes Bad Access.

        self.window.backgroundColor = [UIColor whiteColor];
        [self.window makeKeyAndVisible];
        return YES;
    } 
    -(BOOL) giveErrornow:(NSError *__autoreleasing *)err {
        NSMutableDictionary *errInfo = [[NSMutableDictionary alloc] init];
        [errInfo setObject:@"I feel like giving you an error!" forKey:NSLocalizedDescriptionKey];
        *err = [[NSError alloc] initWithDomain:@"nonesense"
                                  code:0
                              userInfo:errInfo];
        return  NO;
    }
    -(BOOL) messaroundwitherr:(NSError *__autoreleasing *)err{
        //@autoreleasepool { --> uncommenting that causes the error
            return [self giveErrornow: err];
        //}
    } 
```

所以显然激活了自动释放池，使得 err 变量在能够从外部函数（AppFinishLaunching ...）读取之前被释放。现在为什么会发生这种情况？我知道“@autoreleasepool”在使用后会释放变量。在原始上下文中，我有一个 while 循环，这就是我这样做的原因。这里只是出于理解的原因。那么@"autoreleasepool" 是如何工作的呢？命令 (*__autorelease *) 实际发生了什么。

我想在修复它之前我必须完全理解它的概念。NSError (*__autorelease *) err 是否为 ARC 定义了一个“指向将要自动释放的对象的指针（如果是，何时）”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T20:26:38.290

好的，我想我想通了，在两个有用的网站的帮助下：

[http://blog.pioneeringsoftware.co.uk/2012/03/06/out-parameters-when-arcing](http://blog.pioneeringsoftware.co.uk/2012/03/06/out-parameters-when-arcing)

和

[http://openbook.galileocomputing.de/apps_entwickeln_fuer_iphone_und_ipad/apps_02_005.html#dodtpc7187bdd-6422-4c4f-92d2-c60983032cf5](http://openbook.galileocomputing.de/apps_entwickeln_fuer_iphone_und_ipad/apps_02_005.html#dodtpc7187bdd-6422-4c4f-92d2-c60983032cf5)

（不幸的是，第二个是德语:-)）

无论如何，基本概念如下：

1.  通过引用定义变量，例如：

    ```
     (NSError ** err) or (NSError *__autoreleasing * err) 
    ```

    总是使 ARC 将其重写为：

    ```
     (NSError *__autoreleasing * err) 
    ```

    和重写

    ```
     *err = [[NSError alloc] initWithDomain:@"nonesense"
                              code:0
                          userInfo:errInfo] 
    ```

    到

    ```
     *err = .....]retain] autorelease]; 
    ```

    所以错误对象被标记为自动释放。

2.  现在如文档中所述：

    > 在自动释放池块结束时，在块内收到自动释放消息的对象会收到释放消息——对象每次在块内收到自动释放消息时都会收到释放消息

所以基本上从 1 和 2 发生的是，当取消注释 @autoreleasepool 块时，错误正在创建

```
 giveErrornow:(NSError *__autoreleasing *)err 
```

函数，它是从自动释放池中调用的，所以 *errtest 在它可以被使用之前被释放和释放

```
 NSLog(@"Filled NSError? : %@",errtest) 
```

是的，基本上就是这样。处理 out 参数时似乎是一个普遍问题，并且可以更改有问题的代码，例如：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions (NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    NSError *errtest = nil;
    BOOL testBool = [self messaroundwitherr:&errtest];
    NSLog(@"Filled NSError? : %@",errtest); //<--Causes Bad Access.

    self.window.backgroundColor = [UIColor whiteColor];
    [self.window makeKeyAndVisible];
    return YES;
} 
-(BOOL) giveErrornow:(NSError *__autoreleasing *)err {
    NSMutableDictionary *errInfo = [[NSMutableDictionary alloc] init];
    [errInfo setObject:@"I feel like giving you an error!" forKey:NSLocalizedDescriptionKey];
    *err = [[NSError alloc] initWithDomain:@"nonesense"
                              code:0
                          userInfo:errInfo];
    return  NO;
}
-(BOOL) messaroundwitherr:(NSError *__autoreleasing *)err{
    NSError *tempErr;
    BOOL retVal;
    @autoreleasepool {
        retVal = [self giveErrornow:&tempErr];
    }
    *err = tempErr;
    return retVal;
} 
```

欢迎您对这个问题发表任何评论，如果我确信我正确理解了这个问题，那就太好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-08T20:56:00.370

最后，我能够找到原因并修复它。在我的例子中，在*autorelease*`NSError`块内分配的对象被释放，导致崩溃。我创建了 error( ) 对象的副本并分配了那个外部块，它解决了我的问题。*`NSError`*

 *```
- (void)processError:(NSError **) error {

    NSError *unzippingError = nil; // error value which will be assigned inside `@autoreleasepool` block
    NSError *err = nil; // it will hold the copy of error outside block

    @autoreleasepool {
        unzippingError = [NSError errorWithDomain:@"Domain" code:-1
                                         userInfo:@{NSLocalizedDescriptionKey:@"Error message"}];

        //copy the error in another variable to keep reference after @autoreleasepool block
        err = [unzippingError copy];
    }

    if (error) {
        * error =  err;
    }
} 
```*

# session - Express.js 3 使用来自 Backbone.js 的每个 XHR 请求创建新会话

> ID：11909175
> 
> 赞同：3
> 
> 时间：2012-08-10T21:00:44.873
> 
> 标签：session, backbone.js, xmlhttprequest, express, connect

我有一个 Backbone 应用程序，它使用 un/pw 查询我的 Express 服务器，进行身份验证，然后将帐户信息（来自 MongoDB）连同新的 sessionID 一起发送回客户端。当我需要更多数据时，我将会话 ID 附加到 .fetch() 选项。然而，Express 会创建一个新会话，即使我的会话已成功存储在 Redis 中。

这是检查客户端是否尝试使用我的 api 的中间件

```
var _restrictApi = function(req, res, next) {
  if (req.url.match(/api/)) {
    res.xhrAuthValid = req.param('sessionId') == req.sessionID;
    if (res.xhrAuthValid || (req.method=='GET' && req.url.match(/api\/account/))) {
      console.log('API access granted', req.url);
      console.dir(req.session);
      next();
    } else {
      console.log('API access BLOCKED', req.url);
      console.log(req.param('sessionId'), req.sessionID);
      console.dir(req.session);
      res.send(403, 'Forbidden');
    }
  } else {
    next();
  }
}; 
```

我的 Backbone 应用程序在加载时会进行一些 .fetch() 调用。首先，登录，然后为用户获取事件。这是 Express 服务器控制台日志：

```
API access granted /api/account?email=test%40gmail.com&password=somepw
{ cookie: 
   { path: '/',
     _expires: null,
     originalMaxAge: null,
     httpOnly: true } }
_checkAccount test@gmail.com
pw matches
{ cookie: 
   { path: '/',
     _expires: null,
     originalMaxAge: null,
     httpOnly: true },
  account: 
   { _id: 500471eb8bfff124ce984917,
     dtAdd: '2012-07-16T20:07:58.671Z',
     email: 'test@gmail.com',
     pwHash: '$2a$10$2KJXrZeAGW58Kp9JQDL9B.K2Fvu2oE3oqWKRl55o8MeXGHA/zCBE.',
     sessionId: 'iqYjOA7CeQHny9cm8zOWERjv' } }
API access BLOCKED /api/events?accountId=500471eb8bfff124ce984917&sessionId=iqYjOA7CeQHny9cm8zOWERjv
iqYjOA7CeQHny9cm8zOWERjv rsSXKtzXNNiq8x3+pUN9JXWF
{ cookie: 
   { path: '/',
     _expires: null,
     originalMaxAge: null,
     httpOnly: true } } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T19:36:13.107

通过签署 sessionID 创建一个 connect.sid：

```
cookie = require('cookie-signature')
res.send('connect.sid=s%3A'+cookie.sign(req.sessionID, req.secret)) 
```

将其存储在本地存储中，并为每个 AJAX 请求设置 Cookie 标头：

```
r.setRequestHeader('Cookie', window.localStorage['connect.sid']) 
```

这样可行。

# asp.net - 用于行为驱动测试的 rspec 或 cucumber 的 ASP.NET 等效项

> ID：11909177
> 
> 赞同：3
> 
> 时间：2012-08-10T21:00:52.610
> 
> 标签：asp.net, ruby-on-rails, cucumber, bdd, nspec

我目前正在做一个 ASP.NET 项目，我想知道是否有一个等效的 ASP.NET 行为测试框架，类似于 Rails 中的 rspec 和 cucumber。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T15:48:25.483

评论中的链接问题涉及黄瓜替代品（[SpecFlow](http://www.specflow.org/specflownew/)是最受欢迎的），对于 RSpec 等价物，有[NSpec](http://nspec.org/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T15:53:57.883

还有 MSpec 又名机器规格。

Github 链接： [https ://github.com/machine/machine.specifications](https://github.com/machine/machine.specifications)

# tsql - T-SQL 日期函数

> ID：11909185
> 
> 赞同：0
> 
> 时间：2012-08-10T21:01:36.080
> 
> 标签：tsql, function, date

我有一个每个工作日运行的 T-SQL 脚本。该脚本会在过去 24 小时内查找新客户，周一除外，它将在过去 72 小时内（周五至周日）进行查找

```
Select FirstName, LastName, CustomerID, Date
FROM Customers
WHERE 
(
  (
     DATEPART(WEEKDAY, GetDate())=2 AND 
     DATEDIFF(DAY, Customers.Date, GetDate()) <= 3 AND 
     DATEDIFF(DAY, Customers.Date, GetDate()) >= 1
   ) 
   OR DATEDIFF(DAY, Customers.Date, GetDate()) = 1
) 
```

我需要将其更改为提前 30 天进行查找。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:08:37.583

```
WHERE DATEDIFF(DAY, Customers.Date, GetDate()) <= 30 
```

# javascript - 在 ASP.Net 页面中使用 Javascript 对表格行中的单元格求和

> ID：11909186
> 
> 赞同：0
> 
> 时间：2012-08-10T21:01:46.683
> 
> 标签：javascript, html, asp.net, vb.net

我在 ASP.Net 页面中有一个 HTML 表格，带有 ASP.Net 文本框，我需要能够仅在表格中汇总所有文本框。

我有一个脚本可以处理页面上的所有文本框，效果很好，但我似乎找不到缩小范围的方法。

我在这个网站上找到了一个脚本，它识别表格，然后遍历所有单元格，但是当我尝试实现它时，无法识别“单元格”。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:20:15.500

这会成功的

![在此处输入图像描述](../Images/7fcde5ae6197340ae34280052f014567.png)

```
<script type="text/javascript" src="Scripts/jquery-1.7.2.min.js"></script>
<script type="text/javascript">
    $(function () {
        $("#calculate").click(function () {
            var res = 0;
            $("#table input:text").each(function (i, e) {
                if ($(e).val() !== "") {
                    res += parseInt($(e).val());
                }
            });
            alert(res);
        });
    });
</script>

    <table id="table" border="0" cellpadding="0" cellspacing="0">
        <tr>
            <td>
                <asp:TextBox runat="server" ID="txt1" />
            </td>
            <td>
                <asp:TextBox runat="server" ID="txt2" />
            </td>
        </tr>
        <tr>
            <td>
                <asp:TextBox runat="server" ID="txt3" />
            </td>
            <td>
                <asp:TextBox runat="server" ID="txt4" />
            </td>            
        </tr>
    </table>
    <input type="button" id="calculate" value="calculate" />
    <asp:TextBox runat="server" ID="TextBox1" Text="0" />
    <asp:TextBox runat="server" ID="TextBox2" Text="0" />
    <asp:TextBox runat="server" ID="TextBox3" Text="0" /> 
```

只处理表格内的文本框

# jquery - 如何使 jquery 显示文本和此功能一起使用？

> ID：11909191
> 
> 赞同：1
> 
> 时间：2012-08-10T21:02:07.830
> 
> 标签：jquery, variables, text

我学会了如何显示文本+变量，但是在这种情况下我不知道该怎么做，我用逗号尝试了很多变化，但我觉得我缺乏基本知识在这里起着至关重要的作用，请帮助

```
$('div:Contains('"Some text" + '+ $.trim(this.value) +'')') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:03:40.087

SO 格式向您显示您的函数调用被解释为字符串文字。而不是

```
$('div:Contains('"Some text" + '+ $.trim(this.value) +'')') 
```

尝试

```
$('div:Contains("Some text"' + $.trim(this.value) +')') 
```

另外，你的目标是什么？

# php - 将选择选项框值传递给 PHP

> ID：11909194
> 
> 赞同：0
> 
> 时间：2012-08-10T21:02:09.943
> 
> 标签：php, jquery, select

So what I am looking to do is have a drop down box with options and when a option is chosen, there will be datas pulled from the Database and and place on the page.

这怎么可能？

我尝试使用 .post 方法通过 jquery 传递它，但我需要刷新页面，但我不能这样做，因为页面是一个表单，通过刷新，我们丢失了用户到目前为止输入的内容......

谢谢你，阿拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:04:54.787

使用`JQuery post`：

```
 $.post('<url>', {'input' : data},
        function(answer){
              alert(answer);
   }); 
```

您可以设置它不刷新页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:32:53.563

按照 Philippe 的建议使用 jquery .post，页面将标准不刷新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T22:13:37.477

您还可以将表单设置为预先填充用户输入的所有值（在页面刷新之后）。我不建议将它作为 AJAX 解决方案的替代品，但我仍然推荐它，即优雅降级。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T22:38:33.357

我不确定我是否了解您的需求。但我猜你想从 db 中选择一些数据并将其放在你的页面上。并且这个“选择过程”必须通过在提交表单之前更改某些下拉列表的值来触发，对吗？所以我会说你必须使用这样的东西：

```
 $("#dropdownlist").change(function(){
        var jqxhr = $.get("getdata.php",{key : $(this).val() });
        jqxhr.success(function(response){
            // and place response on yr page
        });
    }); 
```

# jquery - 在jquery中捕获提交表单中的值

> ID：11909198
> 
> 赞同：0
> 
> 时间：2012-08-10T21:02:49.047
> 
> 标签：jquery

我在一个页面上有多个相同的表单，我正在尝试传递一个隐藏字段的值，该隐藏字段的 id 为使用以下代码提交的特定表单的 idJoueur。目前，我只成功地将第一个的值传递给它，无论点击哪一个。

```
$(function() {
    $("form").submit(function(e) {
        var tramodifier = $("#idJoueur").val(); //variable to be populated from the
        //specific form which is posted
        alert(tramodifier); //alert for testing purposes
        $.post($(this).attr("action"), $(this).serialize(), function(data) {
            $("#result").html(data);
        });
        e.preventDefault();
        $("tr^=#" + tramodifier).css("background-color", "grey");
    });
});​ 
```

示例

```
<form action="/Admin/Match/LaCreation/1" id="1" method="post">
    <td style="width: 1px;">
        <input data-val="true" data-val-number="Le champ Int32 doit &amp;#234;tre un nombre." data-val-required="Le champ Int32 est requis." id="idJoueur" name="idJoueur" type="hidden" value="1" />....other stuff
        <input id=1 class='ajax_multi_submit' type="submit" value="Créer" />
        </p>
    </td>
</form>
<div id="result"></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T11:18:30.427

我终于解决了。因为我也将 idJ​​ueur 传递给表单，所以这就是我选择它的地方。

```
 <script type="text/javascript">

    $(function () {
        $("form").submit(function (e) {
         var tramodifier = $(this).attr("value");
            $.post($(this).attr("action"),
                $(this).serialize(),
                    function (data) {
                        $("#result").html(data);
                    });
            e.preventDefault(); 
            $("tr^=." + tramodifier).css("background-color", "grey");
        });
    });

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:13:29.403

`this`获取使用关键字提交的表单，并使用以下技术之一在表单中查找元素：

```
$(this).children('#idJoueur').val(); 
```

或者

```
$(this).find('#idJoueur').val(); 
```

我实际上不确定一个是否比另一个更好。他们都为我工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T21:13:49.720

而不是`var tramodifier = $("#idJoueur").val();`你应该这样做：

```
var tramodifier = $(this).find('#idJoueur').val(); 
```

此外，您应该将属性从 id 更改为 class。然后选择器将改为 .idJoueur。

`.find`在元素的子元素中进行搜索。通过像这样使用提交表单的上下文，您可以轻松提取正确的隐藏字段。文档：[http ://api.jquery.com/find/](http://api.jquery.com/find/)

# git - 詹金斯和 git

> ID：11909200
> 
> 赞同：2
> 
> 时间：2012-08-10T21:02:57.950
> 
> 标签：git, jenkins, console-output

我正在使用 Jenkins 进行测试系统自动化。我正在使用 git 插件。除了一件事，一切都运行良好。

当我在我的分支中推送某些内容时，Jenkins 会启动我的测试等。但是当我在开始时单击控制台输出时，它会两次显示“由 GitHub 推送开始”，而没有给我推送（我）的人。

为什么“Started by GitHub push by”出现两次？
我怎么能只用推那个人的名字一次呢？
当我单击更改时，我可以看到提交 ID 和我的用户名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-23T07:03:58.433

要在 jenkins 中使用 git scm，您应该安装 2 个插件。

[Git](https://wiki.jenkins-ci.org/display/JENKINS/Git+Plugin)和[Git 客户端](https://wiki.jenkins-ci.org/display/JENKINS/Git+Client+Plugin)

在安装 git 插件之前安装 git 客户端插件。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-18T17:15:14.723

对我来说，我使用钩子来触发构建。

# wcf - WCF 服务合同设计

> ID：11909204
> 
> 赞同：0
> 
> 时间：2012-08-10T21:03:05.077
> 
> 标签：wcf

我想创建我的第一个 WCF 服务，但我不确定如何构建它。

该服务将接受从我的数据库中检索不同类型项目的请求：

```
List<Product> getProducts()
List<Module> getModules(Product)
List<Releases> getReleases(Product)
List<Feature> getFeatures(Product,Module)
//many more types of items to get etc...
//and then the equivalent functions to update those item types back in the database... 
```

那么我应该将所有这些作为一个单一的服务合同来实现吗？

```
[ServiceContract]
public interface IMyService{}

public class MyService : IMyService{} 
```

我理解这种方式我只需要托管一项服务，但是这是否会因试图为很多人提供他们可能提出的所有可能请求而陷入困境？

或者我应该为每种类型的项目制定不同的服务合同，并分别实施每个项目，以便我可以将它们中的每一个托管在不同的机器上，以减少可能因交通繁忙而导致的性能不佳？

```
[ServiceContract]
public interface IMyProductService{}
public class MyProductService : IMyProductService{}

[ServiceContract]
public interface IMyModuleService{}
public class MyModuleService : IMyModuleService{}

[ServiceContract]
public interface IMyUserService{}
public class MyUserService : IMyUserService{}

... etc etc ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T10:14:57.017

我将拥有所有合同的单一实施。就像是：

```
public interface IUserService{}
public interface IYourModuleService{}
public interface IYourProductService{}
    public class YourService : IUserService, IYourModuleService, IYourProductService{} 
```

这样，您还可以控制您的客户仅使用他们需要的合同，而且（除非您期望大量）您的实施设计应该是任何瓶颈的第一个停靠点，而不是合同设计。

您还可以使用所有“开箱即用”的 WCF 工具来控制音量和实例等 - 以简化您的流程。

简而言之 - 单一实现，多个服务合同。

# jquery - 如何在追加查询中放置加载器？

> ID：11909208
> 
> 赞同：0
> 
> 时间：2012-08-10T21:03:11.373
> 
> 标签：jquery

对..我有以下内容：

```
$(document).ready(function() {
  var index = 2;
  $('#addElement').click(function() {
    var data = 'index='+index;
    $.get('/ajax/lo_add.php', data, function(response){
      var new_div = $(response).hide();
      $('#dynform').append(new_div);
      new_div.slideDown();
      $(".chzn-select").chosen();
      $('.onlyNums input').autotab_magic().autotab_filter('numeric');
      index++;
    });
  });
}); 
```

这花了我一整天的时间让它正常工作（这里是非常新的）.. 事情是我怎样才能放置加载图像（loader.gif），让我们在 div 调用“loader”中说，同时进行附加过程。也许有一个延迟功能用于测试目的，就像测试它的加载会话一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:06:44.967

您可以在调用 ajax 之前显示加载器并将其隐藏在 slideDown 方法的回调中。

```
$(document).ready(function() {

  $("#loader").hide();
  var index = 2;

  $('#addElement').click(function() {

     $("#loader").html("loading..").fadeIn(400,function(){
        var data = 'index='+index;
       $.get('/ajax/lo_add.php', data, function(response){

            var new_div = $(response);
            new_div.appendTo($('#dynform')).slideDown(100,function(){

              $(".chzn-select").chosen();
              $('.onlyNums input').autotab_magic().autotab_filter('numeric');
              index++;
              $("#loader").fadeOut(300);

            });     
       });

    });

  });

}); 
```

您可以通过将其更改为来显示图像而不是加载文本

```
$("#loader").html("<img src='someLoader.gif' />").fadeIn(400,function(){ 
```

# css - 规避 webkit 定位问题 浮动元素后的项目符号错误

> ID：11909210
> 
> 赞同：1
> 
> 时间：2012-08-10T21:03:15.193
> 
> 标签：css, webkit, css-float, position

[WebKit](https://bugs.webkit.org/show_bug.cgi?id=89829 "WebKit 中的错误")中存在一个错误，它会导致浏览器（Safari、Chrome 等）将第一个 <LI> 的项目符号或编号定位在右侧的 <OL> 或 <UL> 中，如果它前面有一个浮动元素。这是问题的一个简单示例：

```
<!DOCTYPE html>
<html>
  <head>
  </head>
  <body style="width:250px">
    <div style="width: 100%; float: left;">
    List with bullet at the wrong side:
    </div>
    <div>
      <ul>
        <li>bullet ends up here -></li>
      </ul>
    </div>
  </body>
</html> 
```

由于已经报道过，它可能会在某个时候得到修复。

同时，我怎样才能通过仅修改*现有*DIV:s 的样式（即不修改结构）来规避问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:34:50.837

`overflow: hidden;`在浮动元素之后的元素或列表中使用。

[http://jsfiddle.net/E3FPS/](http://jsfiddle.net/E3FPS/)

当然，这还有隐藏溢出带来的其他副作用，例如您不能将元素移动到边界框之外，否则它们会被切断。

# html - 显示 HTML 版权和限制符号

> ID：11909217
> 
> 赞同：0
> 
> 时间：2012-08-10T21:03:47.463
> 
> 标签：html, string, character, symbols, copyright-display

我正在使用的 MySQL 数据库有时会在其品牌名称旁边包含带有版权和受限字符的项目。这很好，但是当项目以 HTML 格式打印时，版权符号和受限符号都显示为带有“？”的菱形。在其中，表明它没有正确打印为 HTML。从这个参考 [http://www.shopfitter.com/html-special-characters.htm](http://www.shopfitter.com/html-special-characters.htm)

注册商标符号和版权符号需要

```
&reg and &copy 
```

分别。PHP中的字符串替换会很快摆脱这种情况，但我不确定如果它变成'？钻石。

如何正确检测数据库中的这些字符并将其替换为 Web 友好的对应字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:09:08.907

您有 2 个选项：要么更改字符编码，要么使用 PHP htmlentities() 函数。

[htmlentities() 的 PHP 手册](http://php.net/manual/en/function.htmlentities.php)

# javascript - 隐藏或显示数据属性的某个值的所有 div

> ID：11909219
> 
> 赞同：0
> 
> 时间：2012-08-10T21:04:03.500
> 
> 标签：javascript, jquery, css, html

我在这里尝试使用 HTML5 有效标记，因此我不想将值添加到类中，而是使用 data-*="" 来显示/隐藏某些 div。

```
<div class="randomclass" data-chattingto="cheesecake"></div>
<div class="randomclass" data-chattingto="milkshake"></div>
<div class="randomclass" data-chattingto="cheesecake"></div>
<div class="randomclass" data-chattingto="milkshake"></div> 
```

我可以像这样得到 data-chattingto 的值：

```
$("div").data("chattingto"); 
```

我可以像这样隐藏/显示具有某个**类**的 div ：

```
$(".randomclass").hide(); 
```

但是如何隐藏所有具有**芝士蛋糕的****data-chattingto 值**的div呢？

 **非常感谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-10T21:05:11.147

只需使用属性等于符号：

```
$('div[data-chattingto="cheesecake"]').hide(); 
```

还有一个[JS Fiddle 演示](http://jsfiddle.net/VpkrX/)，由[CrunchyV](https://stackoverflow.com/questions/11909219/hide-or-show-all-divs-for-a-certain-value-of-a-data-attribute/11909233#comment15855637_11909233)提供。参考：

*   [`[attribute="value"]`选择器](http://api.jquery.com/attribute-equals-selector/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:24:48.100

那将是：

```
$('div[data-chattingto = "cheesecake"]').show(); 
```

和

```
$('div[data-chattingto = "cheesecake"]').hide(); 
```**

# android - Android 无法在 onCreate() 中更新 SurfaceView？

> ID：11909221
> 
> 赞同：0
> 
> 时间：2012-08-10T21:04:14.953
> 
> 标签：android, canvas, surfaceview

我想要做的是创建一个带有 SurfaceView 的绘图应用程序。我的应用程序基本上完成了，但缺少一件事：我无法让 SurfaceView 在其活动的 onCreate 中绘制自己。

我的`SurfaceView`派生类看起来像这样（只是重要的部分）：

```
class DrawingSurface extends SurfaceView implements OnTouchListener
{ 
    SurfaceHolder holder;
    public DrawingSurface(Context context)
    {
        super(context);
        holder = getHolder();
    }
    // this method does the painting.
    public void paint()
    {
        Canvas canvas = holder.lockCanvas();
        //draw a bunch of stuff
        holder.unlockCanvasAndPost(canvas);
    }

    //in the onTouch method i call the paint() without any problem
} 
```

以及 Activity 的 onCreate：

```
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    surface = new DrawingSurface(this);
    setContentView(surface);
    //surface.paint(); <--- here is the problem
} 
```

所以你可以看到代码是非常标准的，但是如果我尝试在 onCreate() 中使用 surface.paint()，那么我会得到一个`NullPointerException`，因为那时，调用`SurfaceHolder`返回 null `lockCanvas`。

那么我该如何解决这个问题呢？我希望这个绘制方法在活动开始时运行，否则只有在用户开始绘制时才会绘制背景。我尝试了什么：

*   放置- 相同`surface.paint()`的`onResume()`结果。
*   覆盖表面`draw(Canvas)`，并在那里绘制 - 没有运气。
*   在绘制之前对 Canvas 进行 nullcheck - 没有例外，但是没有绘制任何内容，就像在 onCreate() 中没有 surface.paint()

我真的不知道为什么会发生这种情况，否则一切似乎都有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:40:13.470

尝试不同的模型。在 SurfaceView 内完成所有绘画

```
public class DrawingSurface extends SurfaceView implements SurfaceHolder.Callback {
    public DrawingSurface(Context context) {
        super(context);
        getHolder().addCallback(this);
    }
    @Override
    public void surfaceChanged(SurfaceHolder holder, int format, int width,int height) {
        updatePanel();
    }

    @Override
    public void surfaceCreated(SurfaceHolder holder) {
        updatePanel();
    }

    @Override
    public void surfaceDestroyed(SurfaceHolder holder) {
        updatePanel();
    }

    public void updatePanel() {
        Canvas canvas = null;
        try {
            canvas = getHolder().lockCanvas(null);
            synchronized (getHolder()) {
                doDraw(canvas);
            }
        }
        finally {
            if (canvas != null) {
                getHolder().unlockCanvasAndPost(canvas);
            }
        }
    }
} 
```

您还可以在触摸侦听器中调用 updatePanel 方法。

你所有的绘画都在 doDraw 方法中，它永远不会在 SurfaceView 之外调用。此外，请确保在尝试绘制任何内容之前在 Canvas 对象的 doDraw 中进行空检查。

# c - 在没有文本解析的情况下初始化 in_addr_t

> ID：11909224
> 
> 赞同：0
> 
> 时间：2012-08-10T21:04:33.817
> 
> 标签：c, unix

所以基本上我想用一个特定的地址初始化一个 in_addr_t 并从文本中解析它是没有意义的。这样做很诱人：

```
in_addr_t foo = network_byte_order(127 << 24 | 0 << 16 | 0 << 8 | 99 << 0}; 
```

对于 127.0.0.99，然后将其包装在一个宏中，以便它适用于任何地址......但是我想先检查是否有人知道任何现有的宏，最好是“官方”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T15:45:47.213

没有用于此的现有宏。看看这个例子是如何`INADDR_LOOPBACK`定义的`netinet/in.h`。它只是一个十六进制常量，比您的方法更简单：

```
# define INADDR_LOOPBACK        ((in_addr_t) 0x7f000001) /* Inet 127.0.0.1\.  */ 
```

所以你的方法很好。

您应该使用标准`htonl()`代替您的`network_byte_order`功能。

# php - php url 重定向到主页

> ID：11909229
> 
> 赞同：0
> 
> 时间：2012-08-10T21:04:46.510
> 
> 标签：php, redirect

好吧，我不知道我是否正确地制作了一个标题，但我有一个 lil php 脚本，我想知道当用户转到这个 url 时是否有可能：

```
siteurl.com/index.php?token=J55OSGTTk3W7mRcuq54006w7ROv 
```

在这种情况下仅自动获取 /index.php 而没有他复制/粘贴的内容

```
?token=J55OSGTTk3W7mRcuq54006w7ROv 
```

希望这是可能的。干杯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T21:11:20.650

是的。发出一个`Location`标题并用于**[`parse_url()`](http://php.net/manual/en/function.parse-url.php)**获取您需要的部分。

```
$url      = "http://siteurl.com/index.php?token=J55OSGTTk3W7mRcuq54006w7ROv";
$parsed   = parse_url($url);
$redirect = $parsed["scheme"] . "://" . $parsed["host"] . $parsed["path"];
header("Location: $redirect"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:09:58.967

也许`explode($url,"?")[0]`。如果没有问号，那么它应该返回一个长度为 1 的数组。如果有，您只会得到“？”之前的所有内容。

# mysql - mysqli + ckeditor = 转义和破坏 html

> ID：11909231
> 
> 赞同：2
> 
> 时间：2012-08-10T21:05:01.223
> 
> 标签：mysql, ckeditor

所以我一直在开发一个小系统，在这个系统中，用户可以在某个时候将一些 HTML 输入到 ckeditor 中，然后将 HTML 存储在数据库中（它有点像 microCMS）。

问题是当使用 Mysqli 时，它会在 " 和 ' 之前和之后插入转义字符，以便从逻辑上停止注入，这会破坏大量 HTML 代码。

例如

变成或接近那个，这会破坏代码

有没有办法可以禁用注入预防，或者以另一种方式将其输入数据库？或者当它从数据库中取出时，mabi 替换 /" ？

谢谢

-jman6495

编辑：我已经解决了我使用 php str_replace 函数将 /" 替换为 " 的问题。

这是代码： $pagecontent = str_replace('\"','"',$pagecontent); 回声$页面内容；

不管怎么说，还是要谢谢你

-jman6495

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T23:06:16.753

如果您在取回数据时看到这些字符，那么您会以某种方式双重转义内容。检查您是否只转义一次，并使用占位符而不是`mysql_real_escape_string`. 你还没有解决问题。您已经消除了严重错误的损害。

SQL转义的目的是为了正确可靠地插入数据。例如，`O'Reilly`应该`O''Reilly`用于 MySQL。数据库中的实际内容*应该*与`O'Reilly`引用无关。

# mod-rewrite - mod_rewrite 其他规则如果更多参数

> ID：11909234
> 
> 赞同：1
> 
> 时间：2012-08-10T21:05:14.947
> 
> 标签：mod-rewrite

我实际上为我的系统使用了这个 mod_rewrite 来对 SEO 友好：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} !(.*)/$
RewriteRule ^(.*)$ $1/ [L,R=301] 
RewriteRule ^(.*)/$ /?c=$1&l=deu 
```

我不知道它为什么会起作用，但是经过数小时的尝试和错误，这对我来说是解决方案，现在我想扩展它。

我想要类似的东西

`"if /eng/ is on the end of the url, redirect request to ?c=$1&l=eng"`

在所有其他情况下，它应该使用上面发布的规则。

有人能帮助我吗？（对不起，我的英语不好）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:57:33.827

尝试在 301 规则之后添加它

```
RewriteRule ^(.*)/eng/$ /?c=$1&l=eng [L] 
```

# ruby - Ruby，类变量和继承？超级类@@var 被改变了？

> ID：11909235
> 
> 赞同：1
> 
> 时间：2012-08-10T21:05:17.933
> 
> 标签：ruby

任何解释这一点的 Ruby 大师？

```
class Bar
  @@x = 10
  def self.test
    return @@x
  end
end

class Foo < Bar
  @@x = 20  
end

puts Bar.test  # 20 why not 10?
puts Foo.test  # 20 
```

当我从 TextMate 运行它时。我希望

```
puts Bar.test returns 10 
```

和

```
puts Foo.test returns 20 
```

但出于某种原因（我很想知道）Foo 中的@@x 也更新了 Bar，这是超类。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:18:55.340

这是可以预料的。类变量在层次结构中共享。请参阅维基百科中的部分：[http ://en.wikibooks.org/wiki/Ruby_Programming/Syntax/Variables_and_Constants#Class_Variables](http://en.wikibooks.org/wiki/Ruby_Programming/Syntax/Variables_and_Constants#Class_Variables)

将此与仅对该类私有的*类实例变量*进行比较。

```
class Bar
  @x = 10
  def self.test
    return @x
  end
end

class Foo < Bar
  @x = 20  
end

Bar.test # => 10
Foo.test # => 20 
```

# cakephp - 如何在 URL 中显示名称而不是 Cakephp 中的 id？

> ID：11909241
> 
> 赞同：1
> 
> 时间：2012-08-10T21:05:43.360
> 
> 标签：cakephp

我在 cakephp 环境中创建了一个应用程序，我在用户配置文件页面中使用 user_id 显示用户配置文件

我使用如下锚标记将值发送到控制器：（我无法发送名称，因为它不是唯一的）。

```
<a href="/users/<?php echo $result['user']['id'];?>">View Profile</a> 
```

用户控制器中的功能：

```
function viewprofile($userid){
 // my logic
} 
```

个人资料网址是这样的： [http ://www.xyz.com/users/12](http://www.xyz.com/users/12)

我想显示用户名而不是 user_id

我们如何在 cakephp 的 url 中显示名称（带有 slug）

请帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T23:25:13.213

你必须做三件事。

1.  创建独特的 User Slugs（你可能已经有了 ;-)）

2.  使用前面提到的代码 Dave 创建链接

    echo $this->Html->link('View Profile', array('controller' => 'users','action'=> 'view',$result['user']['slug']));

3.  告诉你的路由用它做什么（/app/condig/routes.php）

    Router::connect('/user/*', array('controller' => 'users', 'action' => 'view'));

现在您将获得漂亮的 url，并且 slug 将是一个参数，可用于在您的用户表中查找用户

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:22:08.253

```
echo $this->Html->link('View Profile', array(
    'controller' => 'users',
    'action'=> 'view',
    $result['user']['slug']
)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T10:45:47.617

试试这个代码

```
echo $this->Html->link('View Profile',array('plugin' => false,
                                            'controller' => 'users',
                                            'action' => 'view',
                                            "slug"=>$data['slug'])); 
```

在您的 Routes 文件中

```
Router::connectNamed(array('slug'));
    Router::connect('/user/:slug', array(
        'plugin' => false,
        'controller' => 'users', 
        'action' => 'view',
        ),array(
            "pass"=>array("slug")
        )
    ); 
```

# jsf - 使用 HttpServletRequest 和 LDAP 自动登录

> ID：11909245
> 
> 赞同：3
> 
> 时间：2012-08-10T21:05:52.597
> 
> 标签：jsf, jakarta-ee, authentication, jaas, jaspic

我有一个 JSF Web 应用程序，它使用 cookie 进行自动身份验证，而不提示输入用户名和密码。它使用带有用户名和随机 UUID 的 cookie，并使用 a`WebFilter`进行重定向。

当客户端没有 cookie 时，通过[HttpServletRequest #login(String username, String password)](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#login%28java.lang.String,%20java.lang.String%29)完成身份验证。在幕后，这种方法使用 JAAS 身份验证，并`LDAP`在后面使用服务器。

当我的应用程序通过保存用户 ID 和 UUID 的 cookie 识别用户时，我的问题就出现了。在这个情况下，

1.  应用程序不知道密码，因此`HttpServletRequest #login(String username, String password)`无法使用该方法。
2.  我应该通过 JNDI 向 LDAP 服务器询问密码吗？乍一看，这似乎是不可能的
3.  或者，我可以将密码存储在我的数据库中。但这意味着信息的重复，我不喜欢这样。
4.  我见过[周围的](http://www.java-only.com/LoadTutorial.javaonly?id=29)人只是将属性“角色”设置为会话，但这似乎并不等同于 JAAS 登录。“等效”是指能够使用`isUserInRole()`和`getUserPrincipal()`方法。

所以，问题是：在这种情况下我应该如何登录用户？我希望这个问题现在更清楚了。

**编辑**

为了让代码说话，我添加了一个简化版的 Managed Bean：

```
@ManagedBean
@SessionScoped 
public class loginBean() {
    private String username = null;
    private String password = null;
    private UUID uuid = null;
    private boolean rememberMe = false;

    public void doLogin() {
        checkCookies();   // this method sets the property values after checking if 
                          // username & uuid match the ones saved previously
        if (username != null && uuid != null && rememberMe) {
            // authenticate automatically. Here I don't know how to proceed, because 
            // I don't have the password, unless I have saved it in the application's db,
            // duplicating it because it's already in LDAP server.
        } else {
            httpServletRequest.login(username, password);  // this uses LDAP behind JAAS
            createCookies();  // this method also saves username & uuid in the app's db
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T09:08:04.697

要以自定义方式（在您的情况下通过 cookie 和 UUID 而不是密码）进行实际*容器登录*，您需要创建自己的登录模块。

Java EE 中用于此的专用 API 是 JASPI/JASPIC（人们永远无法完全同意名称，例如 google 查询变得复杂）。

登录模块处于完全控制之下，并且不必通过 ldap 服务器进行身份验证（如果您的应用程序可以在本地验证 cookie 有效 100%）。您可能确实必须授权用户（向 ldap 服务器询问用户拥有的角色/组）。

作为 JASPI/JASPIC 的替代方案，您还可以查看服务器正在使用的专有登录模块机制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T15:59:23.067

在这种情况下使用 LDAP 条目等效于请求目录服务器使用应用程序提供的信息对连接进行身份验证。就 LDAP 而言，*身份验证*意味着现有的 LDAP*会话*（即与目录服务器的连接）已通过成功的 BIND 请求更改其身份验证状态。

Web 应用程序应向用户请求适当的信息以进行身份​​验证，并将此信息作为 BIND 请求提供给目录服务器。所需信息因 Web 应用程序（LDAP 客户端）使用的身份验证方法而异：

*   一个简单的 BIND 请求需要一个专有名称和一个密码。此可分辨名称和密码应作为简单的 BIND 请求通过安全连接传输到目录服务器。
*   使用预定义 SASL 机制的 SASL BIND 请求。机制因服务器而异，范围从 GSSAPI 到 PLAIN。

目录服务器收到 BIND 请求后，会立即将连接的身份验证状态更改为*匿名*并处理 BIND 请求。如果可以成功处理该请求，则目录服务器使用包含整数结果代码零 (0) 的 BIND 响应来响应 LDAP。这表明专有名称或用户名能够成功进行身份验证。

Web 应用程序应该使用某种机制来维护身份验证状态，并在身份验证状态更改时向目录服务器发出 BIND 请求。这可能是会话超时或其他一些机制。选择的方法不应由用户更改。

总之，使用目录服务器检查身份验证凭据并使用会话框架来管理身份验证状态。

编辑：

似乎这是一个有争议的答案。

*   使用 cookie 不能处理浏览器禁用 cookie 的情况，并且在使用会话时，cookie 不是保持身份验证状态所必需的。
*   会话不需要密码，也不应该在内存或会话中存储任何敏感信息，如密码。当身份验证状态过期（如果有）或会话过期（如果有）时，应用程序应该请求密码。

# javascript - 在客户端对 IFRAME 中的内容进行沙盒处理

> ID：11909247
> 
> 赞同：6
> 
> 时间：2012-08-10T21:06:01.877
> 
> 标签：javascript, iframe, sandbox

## 问题

我有一些想要“沙盒”到 iframe 中的 javascript 内容：

```
<script type="text/javascript">
    doSomethingPotentiallyMalicious( // ideally, i want this to be able to run...
        top.document.getElementById('sensitive_information') // ...but want this to fail due to cross-domain permissions
    );
</script> 
```

问题是，由于我们的 Web 应用程序的性质，我需要在包含 iframe 的父页面上*内联*执行此操作，并且我需要以跨浏览器兼容的方式执行此操作。

## 数据 URL...几乎但不完全

通过数据 url 在 iframe 中设置内容，我能够在 Chrome 中获得所需的效果：

```
<iframe id="sandbox" src="data:text/html;charset=utf-8,%3Cscript%20type%3D%22text%2Fjavascript%22%3E%0A%20%20%20%20doSomethingPotentiallyMalicious(%20%2F%2F%20ideally%2C%20i%20want%20this%20to%20be%20able%20to%20run...%0A%20%20%20%20%20%20%20%20top.document.getElementById('sensitive_information')%20%2F%2F%20...but%20want%20this%20to%20fail%20due%20to%20cross-domain%20permissions%0A%20%20%20%20)%3B%0A%3C%2Fscript%3E"></iframe> 
```

但是，数据 url 支持参差不齐，这需要跨浏览器工作。

## Document.write 在那里获取内容，但缺乏跨域安全性

我可以在 javascript 转义字符串中包含不安全的内容，然后将其写为 iframe 的内容：

```
<iframe id="sandbox" src="http://google.com/"></iframe>
<script>
    var unsafeContent = '\x3Cscript\x20type\x3D\x22text\x2Fjavascript\x22\x3E\x0A\x20\x20\x20\x20doSomethingPotentiallyMalicious\x28\x20\x2F\x2F\x20ideally,\x20i\x20want\x20this\x20to\x20be\x20able\x20to\x20run...\x0A\x20\x20\x20\x20\x20\x20\x20\x20top.document.getElementById\x28\x27sensitive_information\x27\x29\x20\x2F\x2F\x20...but\x20want\x20this\x20to\x20fail\x20due\x20to\x20cross\x2Ddomain\x20permissions\x0A\x20\x20\x20\x20\x29\x3B\x0A\x3C\x2Fscript\x3E\x0A\x0A';
    var sandbox = document.getElementById('sandbox');
    sandbox = (sandbox.contentWindow) ? sandbox.contentWindow : (sandbox.contentDocument.document) ? sandbox.contentDocument.document : sandbox.contentDocument;
    sandbox.document.open();
    sandbox.document.write(unsafeContent);
    sandbox.document.close();
</script> 
```

问题是，一旦我将该内容写入 iframe，跨域安全性显然不再存在（这意味着该`doSomethingPotentiallyMalicious`函数可以访问父窗口中的所有内容）。

## Document.write + Document.domain 似乎也没有让我们到达那里

[我什至尝试按照之前的 SO post](https://stackoverflow.com/questions/6366739/using-an-iframe-for-sandboxing)更改`document.domain`（通过删除最左边的域，使“www.example.com”变为“example.com”），但这似乎也没有强制执行跨域策略：

```
<iframe id="sandbox" src="http://google.com/"></iframe>
<script>
    // prepended to unsafeContent: document.domain = document.domain.replace(/^[\w-]+\./,'');
    var unsafeContent = '\x3Cscript\x20type\x3D\x22text\x2Fjavascript\x22\x3E\x0A\x20\x20\x20\x20document.domain\x20\x3D\x20document.domain.replace\x28\x2F\x5E\x5B\x5Cw\x2D\x5D\x2B\x5C.\x2F,\x27\x27\x29\x3B\x0A\x20\x20\x20\x20doSomethingPotentiallyMalicious\x28\x20\x2F\x2F\x20ideally,\x20i\x20want\x20this\x20to\x20be\x20able\x20to\x20run...\x0A\x20\x20\x20\x20\x20\x20\x20\x20top.document.getElementById\x28\x27sensitive_information\x27\x29\x20\x2F\x2F\x20...but\x20want\x20this\x20to\x20fail\x20due\x20to\x20cross\x2Ddomain\x20permissions\x0A\x20\x20\x20\x20\x29\x3B\x0A\x3C\x2Fscript\x3E\x0A\x0A';
    var sandbox = document.getElementById('sandbox');
    sandbox = (sandbox.contentWindow) ? sandbox.contentWindow : (sandbox.contentDocument.document) ? sandbox.contentDocument.document : sandbox.contentDocument;
    sandbox.document.open();
    sandbox.document.write(unsafeContent);
    sandbox.document.close();
</script> 
```

在这一点上，我正在尝试做的事情在技术上是否可行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T21:03:54.420

我想知道[window.postMessage](http://davidwalsh.name/window-postmessage)是否会起作用。您可以设置一个 iframe 来评估它收到的第一条消息以将 javascript 注入其中。根据我链接的网站，它适用于 Firefox、IE8+、Opera、Safari 和 Chrome。希望这对您来说足够跨浏览器。移动设备可能会遇到问题。

# multithreading - 两个或多个线程如何在它们分配的堆上共享内存？

> ID：11909248
> 
> 赞同：18
> 
> 时间：2012-08-10T21:06:03.600
> 
> 标签：multithreading, heap-memory

正如标题所说，两个或多个线程如何共享它们分配的堆上的内存？我一直在考虑，但我不知道他们是如何做到的。这是我对过程的理解，想必我在某个地方错了。

任何线程都可以通过进行系统调用来添加或删除堆上给定数量的字节，该系统调用返回指向该数据的指针，大概是通过写入寄存器，然后线程可以将其复制到堆栈中。所以两个线程 A 和 B 可以根据需要分配尽可能多的内存。但是我看不到线程 A 怎么知道线程 B 分配的内存在哪里。我也不知道任何一个线程如何知道另一个线程的堆栈所在的位置。多线程程序共享堆，我相信，可以访问彼此的堆栈，但我不知道如何。

我尝试搜索这个问题，但只找到了抽象出细节的语言特定版本。

编辑：我试图不特定于语言或操作系统，但我使用的是 Linux，并且从低级别的角度来看它，我猜是汇编。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-10T22:04:22.357

我对您的问题的解释：线程 A 如何知道指向 B 正在使用的内存的指针？他们如何交换数据？

答：它们通常以指向公共内存区域的公共指针开始。这允许它们相互交换其他数据，包括指向其他​​数据的指针。

例子：

1.  主线程分配一些共享内存并将其位置存储在`p`
2.  主线程启动两个工作线程，*将指针传递`p`给它们*
3.  工作人员现在可以使用`p`和处理`p`

在真正的语言 (C#) 中，它看起来像这样：

```
//start function ThreadProc and pass someData to it
new Thread(ThreadProc).Start(someData) 
```

线程通常不访问彼此的堆栈。一切都从传递给线程过程的一个指针开始。

* * *

创建线程是一项操作系统功能。它是这样工作的：

1.  应用程序使用标准 ABI/API 调用操作系统
2.  操作系统分配堆栈内存和内部数据结构
3.  操作系统“伪造”第一个堆栈帧：它将指令指针设置为 ThreadProc 并将 someData “推入”堆栈。我说“伪造”是因为第一个堆栈帧不是自然产生的，而是由操作系统人为创建的。
4.  操作系统调度线程。ThreadProc 不知道它已在新堆栈上设置。它所知道的是 someData 位于它所期望的通常堆栈位置。

这就是 someData 到达 ThreadProc 的方式。这是第一个初始数据项的共享方式。步骤 1-3 由父线程同步执行。4发生在子线程上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T21:12:44.627

从鸟瞰的角度来看一个非常简短的答案（1000 英里以上）：
线程是同一进程的执行路径，而堆实际上属于该进程（并且因此由线程共享）。每个线程只需要它自己的堆栈作为一个单独的工作单元。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T21:51:37.797

如果线程都使用相同的堆，则它们可以共享堆上的内存。默认情况下，大多数语言/框架都有一个默认堆，代码可以使用该堆从堆中分配内存。在非托管语言中，您通常会显式调用分配堆内存。例如，在 C 中，可能是`malloc`等。在托管语言中，堆分配通常是自动的，分配的方式取决于语言——通常是通过使用`new`运算符。但是，这稍微取决于上下文。如果您提供您要询问的操作系统或语言环境，我也许可以提供更多详细信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-10T08:47:03.970

与属于同一进程的其他线程共享的线程：它的代码段、数据段和其他操作系统资源，例如打开的文件和信号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-09T16:29:05.637

您缺少的部分是包含**静态变量的****静态内存**。

 **该内存在程序启动时分配，并分配已知地址（在链接时确定）。所有线程都可以在不交换任何数据运行时访问此内存，因为地址被有效地硬编码。

一个简单的示例可能如下所示：

```
// Global variable.
std::atomic<int> common_var;

void thread1() {
  common_var = compute_some_value();
}

void thread2() {
  do_something();
  int current_value = common_var;
  do_more();
} 
```

当然，全局值可能是一个指针，可以用来交换堆内存。生产者分配一些对象，消费者获取并使用它们。

```
// Global variable.
std::atomic<bool> produced;
SomeData* data_pointer;

void producer_thread() {
  while (true) {
    if (!produced) {
      SomeData* new_data = new SomeData();
      data_pointer = new_data;
      // Let the other thread know there is something to read.
      produced = true;
    }
  }
}

void consumer_thread() {
  while (true) {
    if (produced) {
      SomeData* my_data = data_pointer;
      data_pointer = nullptr;
      // Let the other thread know we took the data.
      produced = false;
      do_something_with(my_data);
      delete my_data;
    }
  }
} 
```

请注意：这些不是良好的并发代码示例，但它们显示了总体思路，没有太多混乱。**

# javascript - jquery .val() 和 google 闭包编译器

> ID：11909249
> 
> 赞同：3
> 
> 时间：2012-08-10T21:06:06.760
> 
> 标签：javascript, jquery, google-closure-compiler

我想选择控件中的第一个选项，所以我写：

```
$("#MySelect").val($("#MySelect option:first").val()); 
```

现在继续将以下内容复制粘贴到[谷歌闭包编译器](http://closure-compiler.appspot.com/home)中：

```
// ==ClosureCompiler==
// @output_file_name default.js
// @compilation_level ADVANCED_OPTIMIZATIONS
// @externs_url http://closure-compiler.googlecode.com/svn/trunk/contrib/externs/jquery-1.7.js
// ==/ClosureCompiler==

$("#MySelect").val($("#MySelect option:first").val()); 
```

你会得到这个错误：

![在此处输入图像描述](../Images/7f69c10f6fea9ab03b4058e750d1a843.png)

我不明白为什么编译器会抱怨！有什么问题？

感谢您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:19:10.927

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T13:22:30.177

Many of the jQuery methods return different types based on the number and type of the input parameters. This behavior is akin to function overloading in a traditional language. However, JavaScript doesn't support traditional function overloading and jQuery mimics the behavior by inspecting the function arguments.

For `.val`, here's how the method would be annotated if function overloading was supported:

```
/** @return {number|string|Array.<string>} */
jQuery.prototype.val = function() {};

/**
 * @param {number|string|Array.<string>|function(number, *)} newVal
 * @return {!jQuery}
 */
jQuery.prototype.val = function(newVal) {}; 
```

Since there isn't function overloading, the actual signature for `.val` is a combination of both uses:

```
/**
 * @param {(number|string|Array.<string>|function(number, *))=} newVal
 * @return {!jQuery|number|string|Array.<string>|function(number, *)}
 */
jQuery.prototype.val = function(newVal) {}; 
```

Because of this, if you wish to use the return value of `.val` as the input for a separate call to `.val`, you must type cast the original return value to specify which usage you expect:

```
$("#MySelect").val(
    /** @type {number|string|Array.<string>} */
    ($("#MySelect option:first").val()) //note the extra parens
); 
```

This behavior is described in a comment at the top of the jQuery externs file: [http://code.google.com/p/closure-compiler/source/browse/trunk/contrib/externs/jquery-1.7.js#20](http://code.google.com/p/closure-compiler/source/browse/trunk/contrib/externs/jquery-1.7.js#20)

# sinatra - CloudFoundry 和 Sinatra 中的重定向

> ID：11909250
> 
> 赞同：1
> 
> 时间：2012-08-10T21:06:14.517
> 
> 标签：sinatra, ping, cloud-foundry

CloudFoundry 中的一个简单的 Sinatra 应用程序似乎会出现问题：

```
get '/ping' do
  "OK"
end

get '/ping_redirect' do
  redirect '/ping'
end 
```

`ping`有效，无效`ping_redirect`并给出错误：

> 502 错误网关 nginx

知道如何解决吗？

如果您想对其进行测试，请参见[此处](http://sc_app.cloudfoundry.com/ping)和[此处](http://sc_app.cloudfoundry.com/ping_redirect)。

我需要一个在 Sinatra 中重定向的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T23:57:15.860

我能够将以下内容推送到 ghoping.cloudfoundry.com：

```
require 'rubygems'
require 'sinatra'

get '/ping' do
    "OK"
end

get '/ping_redirect' do
    redirect '/ping'
end 
```

重定向对我来说很好：http: [//ghoping.cloudfoundry.com/ping_redirect](http://ghoping.cloudfoundry.com/ping_redirect)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-08T00:02:36.330

该问题可能是由于混合了错误的反向代理配置和 Sintra >= 1.2 的版本。

从[1.2 发行说明](http://www.sinatrarb.com/2011/03/03/sinatra-1.2.0.html)：

> ## 可配置的重定向
> 
> 在 1.1 中，我们确保所有重定向都是绝对 URI，以符合 RFC 2616 (HTTP 1.1)。如果您的反向代理配置损坏，这将给您带来问题。如果是这样，您应该真正修复您的配置。如果你不能这样做，一个简单的 disable :absolute_redirects 现在会让你回到 1.0 的行为。

我将这些知识应用于您的示例以获得以下工作代码（除了我喜欢乒乓球和我的 ping）：

```
require 'rubygems'
require 'sinatra'

disable :absolute_redirects

get '/pong' do
    "pong!"
end

get '/ping' do
    redirect '/pong'
end 
```

# mysql - 尝试对三个 SQL 表中的两组结果进行求和和分组

> ID：11909251
> 
> 赞同：1
> 
> 时间：2012-08-10T21:06:28.233
> 
> 标签：mysql, sql

我在以我想要的方式对查询结果进行分组和求和时遇到了一些重大困难。我无法用语言解释我想做什么，所以我会告诉你。我有三个表：A、H 和 W，它们看起来像（简化）：

**表 A：**

```
Aid name
1   adam
2   bob 
```

**表 H：**

```
Hid Wid  date  atk  Aid
1   1    -     10   2
2   2    -     1    1
3   2    -     5    1
4   1    -     2    2
5   1    -     22   1
6   2    -     7    2 
```

**表 W：**

```
Wid name     user pass
1   charlie  -    -
2   donald   -    - 
```

我试图获得由 Aid 和 Wid 分组的*atk的总和。*基本上，假设这是一个搏击俱乐部的统计。我想显示 W 攻击 A 的次数的总和（这将始终是单向战斗，即：查理只能攻击亚当，但亚当不能攻击查理）。（不是真正的搏击俱乐部——被用于在线游戏:)）

我试图让我的结果看起来像：

```
name1     atk  name2
charlie   22   adam
charlie   12   adam
donald    6    bob
donald    7    bob 
```

我当前的查询看起来像......

```
SELECT w.name AS name1, h.atk, a.name AS name2
FROM H 
JOIN W ON w.Wid=h.Wid
JOIN A ON a.Aid=h.Aid 
```

...这给了我 name1 攻击 name2 的每个实例。当我尝试 GROUP BY 和/或 SUM(h.atk) 时，它正在以我无法弄清楚的方式进行分组或求和。我只是不明白如何做到这一点。任何帮助将不胜感激。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:18:43.313

```
SELECT w.name AS name1, sum(h.atk) as atk, a.name AS name2
 FROM H 
JOIN W ON w.Wid=h.Wid
JOIN A ON a.Aid=h.Aid
GROUP BY w.name, a.name 
```

# php - OneAuth 空白回调

> ID：11909253
> 
> 赞同：1
> 
> 时间：2012-08-10T21:06:38.240
> 
> 标签：php, oauth, laravel

我正在使用 Laravel 和 OneAuth 来构建一个 Web 应用程序。用户可以使用他/她的 Twitter 或 GitHub 帐户登录。

这实际上在我的本地开发服务器上完美运行（GitHub 除外，因为回调 URL 与 localhost 不匹配），但是当我将其上传到生产环境时，我得到一个空白页面 ( `/connect/callback/twitter`)。

其他人使用 OneAuth 经历过这种情况吗？

错误日志中没有错误，页面有`200`状态码。

**本地服务器：**

*   Mac OS X 10.8
*   MAMP
*   PHP 5.4

**生产：**

*   CentOS 5
*   阿帕奇 + PHP 5.3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T20:43:58.020

是的，我遇到了这个问题，解决这个问题的方法是手动注册您的控制器，而不是这样做，

```
Route::controller(Controller::detect()); 
```

做这个，

```
Route::controller('connect'); 
```

仅供参考：如果您使用的是嵌套控制器，那么您注册的顺序很重要。

# maven-3 - Maven 传递依赖

> ID：11909255
> 
> 赞同：2
> 
> 时间：2012-08-10T21:06:44.663
> 
> 标签：maven-3

我有 3 个 maven 项目：第一个 - 带有包装罐的“A”，第二个 -“B”包装罐，第三个 -“C”包装罐。“C”依赖于“B”作为编译时依赖，“B”依赖于“A”也作为编译时依赖。项目“C”也使用“A”中的类。所以我有传递依赖C - > B - > A。但是当我尝试构建这些项目时，maven在编译项目C时因编译错误而失败：它无法从项目“A”中找到“C”中使用的类。

我认为maven解决了传递依赖。为什么我会收到这样的错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T23:22:14.193

Maven*解决*了传递依赖，但不会（通常）自动为您*构建*它们。`--also-make/-am`您可以通过提供标志以及项目列表来让 maven 做您想做的事情：

```
mvn -am -pl C clean install 
```

这假定 A、B、C 都是共享父级的所有模块，并且您将在父级目录中运行上述命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-16T06:17:24.077

Maven中传递依赖失败的原因有很多。您需要为此启用调试选项。我遇到了类似的问题。我正在使用日食。在 Eclipse 中启用 maven 的调试选项：Windows->Preference->Maven->Tick mark Debug Output

我的项目中的错误是：

```
[WARNING] The POM for mil-pop2:java-json:jar:1.0 is invalid, transitive dependencies (if any) will not be available: 4 problems were encountered while building the effective model for mil-pop2:java-json:1.0
[ERROR] 'dependencies.dependency.systemPath' for java-json.jar:java-json.jar:jar must specify an absolute path but is ${project.basedir}/src/main/resources/lib/java-json.jar @ 
```

传递依赖失败的原因是我们所依赖的项目从自定义路径而不是本地存储库继承了jar。如果您提供了自定义路径，请删除。

前 ：

```
<dependency>
<groupId>java-json</groupId>
<artifactId>java-json.jar</artifactId>
<version>1</version>
<scope>system</scope>
<systemPath>${project.basedir}/src/main/resources/lib/java-json.jar</systemPath>
</dependency> 
```

后：

```
<dependency>
<groupId>org.json</groupId>
<artifactId>json</artifactId>
<version>20090211</version>
</dependency> 
```

这解决了我的错误。

# ruby-on-rails - 如何急切加载多态模型？

> ID：11909257
> 
> 赞同：1
> 
> 时间：2012-08-10T21:06:46.670
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, polymorphism, eager-loading

我正在尝试优化我们的一些查询。一个特别的挑战是尝试加载多态模型。在这种情况下，`UserView`是多态的并且具有以下列：

```
user_id, user_viewable_id, user_viewable_type 
```

当我尝试运行此查询时。

```
@user_views = UserView.select('user_views.* AS user_views, songs.* AS songs, users.* AS users')
  .joins('INNER JOIN users AS users ON user_views.user_id = users.id')
  .joins('INNER JOIN songs AS songs ON user_views.user_viewable_id = songs.id')
  .where(:user_viewable_type => 'Song').order('user_views.id DESC').limit(5) 
```

它似乎并不急于加载查询。我正在使用一个名为[MiniProfiler](https://github.com/SamSaffron/MiniProfiler)的 gem ，这表明它实际上正在运行 n+1 个查询，而不仅仅是一个。

以下 AR 查询返回此 SQL：

```
SELECT user_views.* AS user_views, songs.* AS songs, users.* AS users FROM "user_views" INNER JOIN users AS users ON user_views.user_id = users.id INNER JOIN songs AS songs ON user_views.user_viewable_id = songs.id WHERE "user_views"."user_viewable_type" = 'Song' ORDER BY user_views.id DESC LIMIT 5 
```

在一个查询中返回所有记录。奇怪为什么这在 AR 中没有按预期工作。

任何想法如何让它发挥作用？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-10T22:21:29.143

[Rails 关于急切加载的文档](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#module-ActiveRecord::Associations::ClassMethods-label-Eager+loading+of+associations)说`includes`适用于多态关联。所以你应该写：

```
@user_views = UserView.includes(:user_viewable).
  where(:user_viewable_type => 'Song').order('id DESC').limit(5) 
```

# javascript - 在 node.js 中，“模块”总是一个对象吗？

> ID：11909258
> 
> 赞同：3
> 
> 时间：2012-08-10T21:06:50.897
> 
> 标签：javascript, node.js, module, logic, detection

当我看到如何检测脚本是否在[节点](http://nodejs.org/)中运行与在浏览器中运行的示例时，我看到如下逻辑：

```
if (typeof module !== 'undefined' && module.exports) {
    // do something that applies to node
} else {
    // do something that applies to browser
} 
```

[节点文档](http://nodejs.org/api/globals.html#globals_module)将全局`module`列为`{Object}`我认为`typeof module`应该始终是`"object"`的。这在节点中总是正确的吗？如果是这样，做如下检测逻辑不是更有意义：

```
if (typeof module === 'object' && module.exports) {
    // do something that applies to node
} else {
    // do something that applies to browser
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T21:14:55.667

是的，到目前为止，在所有节点版本中，`module`它一直是一个对象，并且很可能在所有 0.x 版本中都保持这种状态。至于检查它是否是特定的对象而不是未定义的对象是否有意义，这主要是风格问题。在前一个示例中，由于代码可能只真正关心向 中添加属性`module.exports`，因此它更具表现力且不那么脆弱。例如，在未来版本的节点中，可能`module`会变成一个函数。在这种情况下，前一个示例仍然有效，而后一个示例需要稍作改动。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T21:14:43.823

第二个片段可能会正常工作。但是，不，我不认为这更有意义。你关心它的存在远胜于关心它是什么。在 javascript 中检查是否存在的标准方法是：

```
typeof myVar !== 'undefined' 
```

所以这里有一些 JS 约定。

# vsto - 将音频设置为在 PowerPoint 幻灯片中自动播放会影响动画

> ID：11909260
> 
> 赞同：2
> 
> 时间：2012-08-10T21:06:51.887
> 
> 标签：vsto, ms-office, powerpoint

使用 VSTO 和 PowerPoint 2010，我正在尝试将音频文件插入到 PowerPoint 幻灯片中，并在幻灯片显示时自动播放。我用下面的代码做到了这一点：

```
var presentation = Gobals.ThisAddIn.Application.ActivePresentation;
var slide = presentation.Slides[1];
var audioShape = slide.Shapes.AddMediaObject2( audioFilePath );
var audioShape.AnimationSettings.PlaySettings.PlayOnEntry = Microsoft.Office.Core.MsoTriState.msoTrue; 
```

现在，在幻灯片中已经有项目符号的动画（由 Effect 对象表示）。每个要点都有一个 Effect 对象。我的加载项将它们从点击触发转换为自动运行。这是通过类似于以下的代码完成的：

```
var effect = slide.TimeLine.MainSequence[1];
if ( effect.Timing.TriggerType == PowerPoint.MsoAnimTriggerType.msoAnimTriggerOnPageClick )
{
   effect.Timing.TriggerType = PowerPoint.MsoAnimTriggerType.msoAnimTriggerWithPrevious;
   effect.Timing.TriggerDelayTime = delay;
} 
```

要点动画的最终目标是让每个动画在一定延迟后单独显示。

我的问题在于将音频形状设置为自动启动。这会导致每个项目符号点的单独效果对象被所有项目符号点的一个效果替换。因此，所有要点都立即显示在屏幕上，而不是在它们之间有延迟。我先插入音频还是先修改子弹效果都没有关系。

必须有一种方法可以将音频设置为自动播放而不会弄乱其他效果，因为您可以在 GUI 中进行操作。任何人都可以帮忙吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-10T09:14:46.597

（抱歉，如果这更适合作为评论 - 我还没有能力添加这些。我也意识到这个问题现在已经过时了。）

我刚刚遇到了一个类似的问题：设置任何`PlaySettings`属性后，幻灯片上的所有退出动画都将被删除，所有设置为“With Previous”的动画都变成了“After Previous”。

我遇到了[这个链接](http://skp.mvps.org/ppttimeline1.htm)，这表明该`AnimationSettings`对象是旧版本 PowerPoint 的保留，并且可能会在新版本中搞砸。进一步来说，

> 如果您在新版本中使用 AnimationSettings 对象设置任何动画属性，Microsoft PowerPoint 将从幻灯片上已设置的动画中删除所有早期版本中不支持的动画。

（该链接将 XP/2003 称为“新版本”，但即使在 2013 年，这种行为似乎也是一致的。）

本质上，通过设置音频设置`AnimationSettings.PlaySettings`会触发删除旧版本 PowerPoint 中不可用的动画。不幸的是，似乎没有其他方法可以这样做。

# jquery - 显示提交后突出显示的表单数据 - Django（和 jQuery）

> ID：11909268
> 
> 赞同：0
> 
> 时间：2012-08-10T21:07:17.270
> 
> 标签：jquery, html, django

目前我有一个包含所有选项的下拉框。按下提交后，页面将重新加载 url 中所有选定的变量

`http://127.0.0.1:8000/website/?var1=choice1&var2=choice3`

因此重新加载相同的视图，并通过视图收集和分析变量。根据选择，将数据库中的不同数据发送到此网页页面，从而在此下拉菜单下加载不同的表。

刷新后是否可以在表单中显示所选数据？像这样的东西： ![我目前的网站](../Images/f070ac28b6f889d2bcf3498fe847afe6.png)

到目前为止，我只使用了 HTML。我认为也许使用 jQuery 我可以让它工作，但是语言令人困惑（尽管我非常愿意学习，如果有人知道如何用 jQuery 来做的话）

**解决方案**

在 Chris 的指示下，我设法让它发挥作用。首先，Chris 的解决方案不适用的是 request.GET 方法。因此，在调用的 VIEW 内部`return render_to_response('website.html')`（所以是相应的视图），我添加了以下代码：

```
requestDict = request.GET

return render_to_response('optionset.html', {'request':requestDict}) 
```

因此，在我的模板中，我执行了以下操作：

```
<form action="" name="OptionSetForm">
     <select name="var1" size=2>
     <OPTGROUP LABEL="FirstPickHere">
            <option {% if request.var1 == "Choice1" %} selected="selected"{% endif %}>Choice1</option>
            <option {% if request.var1 == "Choice2" %} selected="selected"{% endif %}>Choice2</option>
            <option {% if request.var1 == "Choice3" %} selected="selected"{% endif %}>Choice3</option>
    </OPTGROUP>
    </select>
</form> 
```

确保在`==`和 两个变量之间有空格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:14:04.900

您可以使用 jQuery 解析查询字符串中的变量（[这里有一个库](https://github.com/allmarkedup/jQuery-URL-Parser)），然后按照[此处](https://stackoverflow.com/questions/7252633/populate-multiselect-box-using-jquery)所述填充多选字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:15:05.193

由于您使用的是选择框，因此您需要在每个选项中添加以下内容：

```
<option value="choice1"{% if request.GET.var1 == "choice1" %} selected="selected"{% endif %}>Choice 1</option> 
```

或者，如果您更愿意使用 jQuery：

```
var queryString = window.location.search.substring(1);
var params = queryString.split('&');
for (var i=0; i<params.length; i++) {
    var param = params[i].split('=');
    $('[name='+param[0]+']').val(param[1])
} 
```

# iis - 相对链接在 CruiseControl.NET HtmlReportPlugin 中不起作用

> ID：11909271
> 
> 赞同：0
> 
> 时间：2012-08-10T21:07:28.790
> 
> 标签：iis, iis-7, cruisecontrol.net

我的 CruiseControl.NET 项目的发布者区域中有一个合并任务，它成功地将一组 html 和 png 文件复制到工件目录。我在仪表板中启用了[HtmlReportPlugin](http://www.cruisecontrolnet.org/projects/ccnet/wiki/HtmlReportPlugin)，如下所示：

```
 <buildPlugins>
      <buildReportBuildPlugin>
        <xslFileNames>
          <xslFile>xsl\header.xsl</xslFile>
          <xslFile>xsl\compile.xsl</xslFile>
          <xslFile>xsl\modifications.xsl</xslFile>
          <xslFile>xsl\MsTestSummary2010.xsl</xslFile>
        </xslFileNames>
      </buildReportBuildPlugin>
      <buildLogBuildPlugin />
      <xslReportBuildPlugin description="MSTest2010 Report" actionName="MSTestBuildReport2010" xslFileName="xsl\MsTestReport2010.xsl"></xslReportBuildPlugin>
      <xslReportBuildPlugin description="MSTest Coverage 2010" actionName="MSTestBuildCoverReport2010" xslFileName="xsl\MsTestCover2010.xsl"></xslReportBuildPlugin>
      <htmlReportPlugin description="Html Report" actionName="HtmlReport" htmlFileName="index.html" />
    </buildPlugins> 
```

index.html 提供得很好，但 index.html 中的相对链接似乎不起作用。下面是 index.html 的源代码：

```
<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Frameset//EN'
 'http://www.w3.org/TR/html4/frameset.dtd'>
<html><head><title>
all.cov
</title>
<meta http-equiv=Content-Type content='text/html;charset=utf-8'>
</head>
<frameset cols='25%,75%'>
    <frame src=nav-folder.html>
    <frame name=right src=p0.html>
    <noframes>
    <p>Your browser does not support frames. See <a href=nav-folder.html>nav-folder.html</a>
    </noframes>
</frameset>
</html> 
```

这是我在加载 index.html 时遇到的错误之一（将 'nav-folder' 替换为 'p0' 以获得其他错误消息）：

> “/”应用程序中的服务器错误。
> 
> 未知对象名称：导航文件夹
> 
> 说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.ApplicationException：未知对象名称：导航文件夹
> 
> 源错误：
> 
> 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。
> 
> 堆栈跟踪：
> 
> [ApplicationException: Unknown object name : nav-folder]
> Objection.ObjectionStore.GetByName(String name) +307
> ThoughtWorks.CruiseControl.WebDashboard.MVC.Cruise.CruiseActionFactory.CreateHandler(String actionName) +231
> ThoughtWorks.CruiseControl.WebDashboard.MVC.Cruise .CruiseActionFactory.Create(IRequest request) +38
> ThoughtWorks.CruiseControl.WebDashboard.MVC.RequestController.Do() +155 ThoughtWorks.CruiseControl.WebDashboard.MVC.ASPNET.HttpHandler.ProcessRequest(HttpContext context) +651
> System.Web.CallHandlerExecutionStep. System.Web.HttpApplication.IExecutionStep.Execute() +625 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +27

如果我在任一参考文件（例如`http://localhost/server/local/project/Code_Coverage/build/log20120809181334Lbuild.168.xml/RetrieveBuildFile.aspx?file=p0.html`）上使用 RetrieveBuildFile.aspx，文件加载没有问题，但与第一个示例一样，任何相关文件都将无法加载。

我必须在 CruiseControl.NET web.config 中做些什么才能让 IIS 正确解析相对文件路径？我正在使用 CruiseControl.NET 1.8.0 并且我正在运行在 Windows 2008 上运行的 IIS 7，并且我已验证在 CruiseControl.NET 1.6 上发生了同样的问题？在 Windows 7 上运行的 IIS 上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T16:40:59.443

不幸的是，HTML tidy 不喜欢 Bullseye CodeCoverage HTML，因为它包含无效的 HTML。所以这个解决方案行不通。

CruiseControl 使用正则表达式来查找源链接，但这并不完美，因为它错过了 HTML 属性没有引号的情况，并且它可以匹配不是 HTML 属性的字符串片段。我修改了 CruiseControl.NET 源代码以使用 HtmlAgilityPack 解析 HTML，这似乎工作得很好（至少在我的测试用例中。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-28T16:27:00.943

如果您需要解决此问题（无需自行查看 CCnet 解析 html 的位置）。我将 ReportGenerator 与 CCnet 一起使用。这是一个例子：

在班上：

```
BuildFileDownload (namespace ThoughtWorks.CruiseControl.WebDashboard.Plugins.BuildReport) 
```

使用以下代码修改 Execute 过程：

```
HtmlDocument doc = new HtmlDocument();
doc.OptionAddDebuggingAttributes = false;
doc.OptionAutoCloseOnEnd = false;
doc.OptionCheckSyntax = false;
doc.OptionFixNestedTags = false;
doc.OptionOutputOptimizeAttributeValues = false;
doc.LoadHtml(htmlData);

var nodes = doc.DocumentNode.SelectNodes("//a[@href]");
if (nodes != null)
{
    foreach (var link in nodes)
    {
        HtmlAttribute att = link.Attributes["href"];
        if (!att.Value.StartsWith("data:") && !att.Value.StartsWith("#") && !att.Value.StartsWith("http://"))
            att.Value = @"RetrieveBuildFile.aspx?file=coverageReport\" + att.Value;
    }
    htmlData = doc.DocumentNode.WriteTo();
}

nodes = doc.DocumentNode.SelectNodes("//link[@href]");
if (nodes != null)
{
    foreach (var link in nodes)
    {
        HtmlAttribute att = link.Attributes["href"];
        if (!att.Value.StartsWith("data:") && !att.Value.StartsWith("#") && !att.Value.StartsWith("http://"))
            att.Value = @"RetrieveBuildFile.aspx?file=coverageReport\" + att.Value;
    }
    htmlData = doc.DocumentNode.WriteTo();
} 
```

Remember to get rid of old regEx parsing first. It's a sample code but it fits all my needs. This solution uses HtmlAgilityPack. Note that path given as a prefix for new attribute value may differ.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T02:42:18.397

问题是 CruiseControl.NET 不喜欢带有未引用值的属性的 HTML。我正在使用 Bullseye CodeCoverage 生成的输出，并且该输出具有未引用的值的属性。我正在使用[HTML Tidy](http://tidy.sourceforge.net/)添加引号。

# ruby-on-rails - 如何通过 Ruby on Rails 中的表单提交添加额外的查询字符串参数？

> ID：11909275
> 
> 赞同：1
> 
> 时间：2012-08-10T21:08:00.817
> 
> 标签：ruby-on-rails

我希望能够在提交时添加一个额外的查询字符串参数，该参数`classrooms_search_textbox`与用户将键入的值相同。我该怎么做呢？

```
<%= form_tag classrooms_path, :method => :get, :id => "classrooms_search_form" do %>
<%= text_field_tag "classrooms_search_textbox", "Find a classroom" %>
<%= submit_tag "Find", :id => "classrooms_search_button", :class => "button" %> 
```

我是否需要添加一个`hidden_tag`（如果需要，我将如何去做？）或者我可以以`classrooms_path`某种方式添加吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:29:20.843

由于您首先将其发送到您的控制器，因此您可以在发送之前操作控制器方法中的参数：

```
params[:classrooms_query] = params[:classrooms_search_textbox] 
```

然后继续使用这些参数发送到其他服务。无需添加隐藏字段标签或使用一些花哨的 JS 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:29:05.623

```
<%= form_tag classrooms_path, :method => :get, :id => "classrooms_search_form" do %>
  <%= text_field_tag "classrooms_search_textbox", "Find a classroom" %>
  <%= hidden_field_tag "classrooms_query" %>
  <%= submit_tag "Find", :id => "classrooms_search_button", :class => "button" %>

$('#classrooms_search_form').submit(function() {
   $('#classrooms_query').value($(classrooms_search_textbox.value());
}); 
```

那将实现您想要的。尽管如此，也许重构控制器或视图以使其不存在这种冲突符合您的利益。

# php - 检查查询结果数组的大小

> ID：11909285
> 
> 赞同：1
> 
> 时间：2012-08-10T21:08:45.633
> 
> 标签：php, arrays

使用以下代码，我可以遍历返回数组的元素：

```
foreach ($GLOBALS['myDB']->getAssets($i['uId']) as $x) 
```

但我不知道如何在进入循环之前有效地检查返回数组的大小。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T21:10:00.990

```
$assets = $GLOBALS['myDB']->getAssets($i['uId']);
$size = count($assets); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:10:29.293

您可以使用 count 找出数组的长度

```
count($arrayName); 
```

# c++ - CopyMemory 非 POD

> ID：11909286
> 
> 赞同：0
> 
> 时间：2012-08-10T21:08:49.353
> 
> 标签：c++

我的结构和向量看起来像：

```
typedef struct
{
    int SX, SY;
    int X, Y, Z;
    std::vector<Vector3D> Vertices;
    const void* VBOPointer;
} Model;

typedef struct
{
    int X, Y;
    struct
    {
        int VX[4], VY[4];
        int TX[4], VY[4];
    } Quad;
} Item;

std::vector<Item> ListOfItems;
std::vector<Model> ListOfModels; 
```

我需要将这些复制到内存中，以便我可以从另一个程序中重建它们。我已经映射了内存，但后来我意识到我不能在其中任何一个上使用 CopyMemory 或 MemCpy。

我怎样才能复制它？

我如何复制标准数据类型/结构的示例：

```
struct
{
    int X;
    int Y;
} POD;

//pData is a void pointer to mapped memory given to be by MapFileView..

POD Foo = {100, 50};
long double* Data = static_cast<long double*>(pData);
//Check if Data[1] contains a request command then copy.

CopyMemory(&Data[0], &Foo, sizeof(Foo)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:42:58.680

由于您必须处理非 POD 数据，因此您需要将结构数据展平为序列化格式，然后其他应用程序可以将其解析回其末端的结构。

您的`ListOfItems`矢量可以很容易地展平，因为它的元素是 POD 数据。将`vector`大小存储为整数，将其复制到缓冲区中，然后复制每个`Item`（假设缓冲区足够大以容纳展平数据）：

```
long double* Data = static_cast<long double*>(pData);  
//Check if Data[1] contains a request command then copy.  

unsigned char *Work = static_cast<unsigned char *>(pData);

int number = ListOfItems.size();
CopyMemory(Work, &number, sizeof(int)); 
Work += sizeof(int);

for (int i = 0; i < number; ++i)
{
    CopyMemory(Work, &ListOfItems[i], sizeof(Item)); 
    Work += sizeof(Item);
} 
```

由于其中包含另一个向量，因此您的`ListOfModels`向量将更难展平，但同样的概念通常适用：`Model``vector`

```
long double* Data = static_cast<long double*>(pData);  
//Check if Data[1] contains a request command then copy.  

unsigned char *Work = static_cast<unsigned char *>(pData);

int number = ListOfModels.size();
CopyMemory(Work, &number, sizeof(int)); 
Work += sizeof(int);

for (int i = 0; i < number; ++i)
{
    Model &m = ListOfModels[i];

    CopyMemory(Work, &(m.SX), sizeof(int) * 5);
    Work += (sizeof(int) * 5);

    int num = m.Vertices.size();
    CopyMemory(Work, &num, sizeof(int));
    Work += sizeof(int);

    for (int j = 0; j < num; ++j)
    {
        Vector3D &v = m.Vertices[j];
        // copy v as needed...
        Work += ...;
    }

    // copy m.VBOPointer as needed ...
    Work += ...;
} 
```

我通常为这样的事情做的是使用模板来帮助简化逻辑并使其更易于阅读：

```
template<typename T>
void Copy(unsignd char* &Work, const T &value)
{
    CopyMemory(Work, &value, sizeof(T));
}

template<template T>
void Copy(unsigned char* &Work, const std::vector<T> &vec)
{
    int number = vec.size();
    Copy(Work, number);
    for (int i = 0; i < number; ++i)
        Copy(Work, vec[i]);
} 
```

.

```
long double* Data = static_cast<long double*>(pData);  
//Check if Data[1] contains a request command then copy.  

unsigned char *Work = static_cast<unsigned char *>(pData);
Copy(Work, ListOfItems); 
```

.

```
template<>
void Copy<Vector3D>(unsigned char* &Work, const Vector3D &vec)
{
    // copy vec as needed...
    Work += ...;
}

template<>
void Copy<Model>(unsigned char* &Work, const Model &m)
{
    Copy(Work, m.SX);
    Copy(Work, m.SY);
    Copy(Work, m.X);
    Copy(Work, m.Y);
    Copy(Work, m.Z);
    Copy(Work, m.Vertices);

    // copy m.VBOPointer as needed ...
    Work += ...;
}

long double* Data = static_cast<long double*>(pData);  
//Check if Data[1] contains a request command then copy.  

unsigned char *Work = static_cast<unsigned char *>(pData);
Copy(Work, ListOfModels); 
```

# iphone - 从字符串转换为浮点数会改变数字

> ID：11909287
> 
> 赞同：0
> 
> 时间：2012-08-10T21:08:49.070
> 
> 标签：iphone, objective-c, string, floating-point

我有一个字符串：61146009 [从服务器发送]

但是当我打印它的浮点值时

```
[string floatValue]; 
```

输出为 61146008.000000。我也尝试将字符串作为 61146009.0 发送，但结果仍然相同。

知道为什么吗？

字符串需要显示为 61,146,009 使用

```
NSString *formattedScore = [numberFormatter stringFromNumber: [NSNumber numberWithFloat: [scoreString floatValue]]]; 
```

这是其他人编写的一行代码，他似乎错误地使用了 float 而不是 int

我知道使用 [string intValue] 可以轻松修复它。但不幸的是，代码与 [string floatValue] 一起使用，我正在尝试解决这个问题，而不必发布新的更新。

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T22:01:03.840

如果服务器发送字符串“61146009”，则其中一项为真：

1.  服务器有一个 IEEE 754 双精度值，将其转换为字符串，然后发送。
2.  服务器有一个 IEEE 754 单精度值，将其严重转换为字符串，然后发送。
3.  服务器具有 IEEE 754 双精度或单精度值以外的其他值。

我列出 2 的原因是 61146009 不能表示为 IEEE 754 单精度值。如您所见，最接近的可表示值是 61146008。如果服务器有 61146008 并且转换为字符串产生 61146009，那么它的格式化例程是错误的，应该修复或替换。您的解决方法是更改​​服务器将数字转换为字符串的方式。

在 1 的情况下，服务器具有无法以浮点数表示的数字（IEEE 754 单精度对象）。这使得客户端无法将它们存储在浮点数中。由于您不想更改客户端，因此您必须更改服务器永远不要发送无法以浮点数表示的值。一种方法是修改服务器以将其值转换为单精度，然后发送它。转换会将双精度值四舍五入为可以单精度表示的值。

3 的情况与 1 类似：服务器具有无法以浮点数表示的数字，您需要进行类似的转换。

鉴于您所描述的，我不认为您可以发送任何值会导致未修改的客户端显示 61146009。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T21:20:39.943

使用双精度，而不是浮点数。浮点数大约有 7 位小数位精度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-10T21:18:02.280

此数字不能以单精度浮点数表示。
在十六进制中，它是 0x3A50399，因此它需要 26 位，比浮点尾数中可用的 24 位多两位。
因此，您将获得最接近十进制输入的浮点数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T21:13:11.990

你有没有尝试过：

```
[NSString stringWithFormat:@"%.0f",string] 
```

# c# - bindingsource.AddNew 方法添加两条记录而不是 1

> ID：11909291
> 
> 赞同：1
> 
> 时间：2012-08-10T21:09:08.697
> 
> 标签：c#, visual-studio-2010, entity-framework-4, bindingsource

这个问题出现在带有实体框架的 Windows 窗体应用程序中。

源代码（VS 2010）： [https ://rapidshare.com/files/1553732530/WindowsFormsApplication8.rar](https://rapidshare.com/files/1553732530/WindowsFormsApplication8.rar)

我有一个*“雇员”*实体，它具有 ID、名称字段和自关联与“零或 1**到**多个”多重性。和两个导航属性 1-经理 2-人员

每个经理可以有零个或多个人员，每个人员可以有零个或多个经理。

在一个表格中，我有两个数据网格视图，一个用于经理，另一个用于第一个数据网格视图中当前选定经理的人员。直到现在一切都很好，但是当我调用下面的代码时，人员 BindingSource 添加了两条记录而不是一条记录

```
 employeBindingSource.AddNew();
        Employe p=(Employe)personnelBindingSource.AddNew();
        p.Manager = (Employe)employeBindingSource.Current; 
```

问题是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T08:25:12.380

此代码正常工作

```
 employeBindingSource.AddNew();
        Employe p = new Employe();

        p.Manager = (Employe)employeBindingSource.Current; 
```

# php - 如何在没有nodejs的php代码中编写dustjs

> ID：11909293
> 
> 赞同：1
> 
> 时间：2012-08-10T21:09:20.113
> 
> 标签：php, jquery, dust.js

目前我在客户端javascript中做了dustjs如下

```
<!DOCTYPE html>
<html>
<head>
  <script src="lib/dust-full-0.3.0.min.js" type="text/javascript"></script>
  <script src="vendor/jquery-1.7.1.min.js" type="text/javascript"></script>
  <script type="text/javascript">
  $(document).ready(function(){

  // JSON response from server 
  var json_object = { "profile_skill": "Profile Skill",
      "skills": [
            { "name": "JavaScript"  },
            { "name": "Ruby" },
            { "name": "Java" }
      ]
    }
  // render method

    dustRender = function(){
      // Get the dust html template to dust compile
      var dust_tag = $('#page').html() ; 

      var compiled = dust.compile(dust_tag, "tmp_skill");
      //load templates
      dust.loadSource(compiled);
      //Renders the named template and calls callback on completion. context may be a plain object or an instance of dust.Context.
      dust.render("tmp_skill", json_object, function(err, html_out) {
      //HTML output
         $('#page').html(html_out);
          console.log(html_out);
      });
    }();

  });

</script>

</head>
<body>
<h1>Dust templates in the browser</h1>
<div id="page">

{profile_skill}
  <ul> {#skills} 
      <li> {name} </li> 
      {/skills}
  </ul>
</div>

</body>
</html> 
```

但是在我的页面视图源中，我可以看到上面的代码而不是 html 标记输出。而且我还想知道如何将dustjs集成到php代码中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T22:23:16.427

不要只是将模板放在 php.ini 中。正确执行并将模板定义为字符串或单独的 html 文件。

```
var templateName = "myTemplate";
var model = { "profile_skill": "Profile Skill",
    "skills": [
        { "name": "JavaScript"  },
        { "name": "Ruby" },
        { "name": "Java" }
    ]
};

dust.onLoad = function(templateName, callback) {
    // this will load a template with [name].html in the folder templates
    // callback is an internal dust.js function
    $.get(["templates/", ".html"].join(templateName), function(data) {
        callback(undefined, data);
    }, "html"); 
};

// dust just takes the template name as first parameter
// if no template of this name is defined it will attempt to load
// and compile it if needed
// override dust's onLoad function to implement your loading

dust.render(templateName, model, function(err, out){
    $('#page').html(out);
}); 
```

在我的 template.html 里面

```
{profile_skill}
<ul> {#skills} 
    <li> {name} </li> 
    {/skills}
</ul> 
```

当然，重点是编译模板总能加快交付和渲染速度。但是，由于您将模板与页面的其余部分一起提供，因此没有必要调用`loadSource`and 。`compile`相反，如果您告诉灰尘这样做，它会尝试自行加载模板。

从文档中：

> ## 正在加载
> 
> (...)
> 
> 默认情况下，当在缓存中找不到命名模板时，Dust 会返回“找不到模板”错误。覆盖 onLoad 以指定后备加载机制（例如，从文件系统或数据库加载模板）。

如果必须，内部灰尘会调用`loadSource`and`compile`方法本身。在上面的示例中，我包含了一个可能的解决方案来覆盖`dust.onLoad`。当然你也可以简单地返回一个 DOM 节点的 html 内容。

```
dust.onLoad = function(templateName, callback) {
    callback(undefined, $("skill template").hmtml());
} 
```

并回答您的最后一个问题：

> 而且我还想知道如何将dustjs集成到php代码中。

你不能。除非您将模板发送到客户端以在那里呈现，或者您的后端有 JavaScript 解释器来呈现模板，否则您无法使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T01:12:36.360

正如 Torsten Walter 所提到的，如果您在浏览器中编译/渲染，您将无法在页面中看到 html 源代码。如果您在服务器端进行编译和渲染，html 源代码将包含最终的 HTML 代码。为此，您可以使用 Linkedin 博客中提到的 nodejs 或 Rhino 服务器：http: [//engineering.linkedin.com/frontend/leaving-jsps-dust-moving-linkedin-dustjs-client-side-templates](http://engineering.linkedin.com/frontend/leaving-jsps-dust-moving-linkedin-dustjs-client-side-templates)

这可能会帮助您使用 PHP 编译灰尘模板，

[https://github.com/saravmajestic/myphp/tree/master/dustcompiler](https://github.com/saravmajestic/myphp/tree/master/dustcompiler)

此实用程序仅用于在页面渲染之前编译灰尘模板，这将避免在浏览器中编译时间。您可以将编译后的模板作为 JS 文件加载到您的页面中，该文件可以与其他 JS 文件/模板一起缩小/聚合。

希望这可以帮助！！！

# javascript - 导致html div水平滑动的困难

> ID：11909294
> 
> 赞同：0
> 
> 时间：2012-08-10T21:09:25.973
> 
> 标签：javascript, html, css

我在使用 PHP、CSS 和 Javascript（使用 jQuery）为该项目设置动画时遇到问题。我想要一个当它的标签栏悬停在屏幕左侧时从屏幕左侧滑出的 div。我有三个 div：容器、内容和选项卡。

这是Javascript和HTML：

```
<div id="LeftSidebar">
    <div id="LeftSidebarTab" class="">
        Left sidebar tab
    </div>
    <div id="LeftSidebarContents" class="">
        Left sidebar contents
    </div>

    <script type="text/javascript">
        $("#LeftSidebar").mouseenter(function()
        {
                $("#LeftSidebar").animate(
            {
                    left: 0px
            });
        });

        $("#LeftSidebar").mouseleave(function()
        {
                $("#LeftSidebar").animate(
            {
                    left: -100px
            });
        });
    </script>
</div> 
```

这是CSS：

```
#LeftSidebar
{
    position: absolute;
    display: block;

    z-index: 12;
    top: 220px;
    left: 0px;

    background-color: green;

    height: 500px;
}

#LeftSidebarTab
{
    float: right;
    background-color: red;
    width: 20px;
    height: 100%;
}

#LeftSidebarContents
{
    background-color: blue;
    width: 100px;
    height: 100%;
} 
```

我是 Javascript、HTML 等的新手。

代码没有做我期望的事情。我希望它在悬停时逐渐将“左”CSS 属性移动到 0px，当鼠标移出内容时，将“左”CSS 属性移动到 -100px。

当我将鼠标悬停在它上面时，我看不到 div 的可见变化。我什至无法判断是否触发了“mouseenter()”或“mouseleave()”函数。

问题：1）如何检查功能是否被触发？我可以使用 Javascript 输出一些文本或其他内容吗？也许会弹出一个对话框进行调试？

2) 是否会为“LeftSidebar”触发 mouseenter/mouseleave，即使 LeftSidebarContents 和 LeftSidebarTab 完全覆盖了 LeftSidebar 的每个像素？

3) 我是否在上述代码中犯了任何明显的错误，导致它无法按预期工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:20:43.557

使用 ff 和 firebug 或 chrome 来调试你的脚本。将指针放在函数上，这将导致浏览器暂停执行脚本，以便您可以跳过它并查看会发生什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:33:15.733

确定是否触发事件的快速而肮脏的测试是使用警报功能。例如：

```
 $("#LeftSidebar").mouseenter(function()
    {
         alert("Mouse Enters Region");
    }); 
```

这也是我将如何处理你的 css 文件：

```
#LeftSidebar
{
    position: fixed;  
    display: block;

    z-index: 12;
    top: 220px;
    left: -100px;

    background-color: green;
    width:120px;
    height: 500px;
}

#LeftSidebarTab
{
    position:absolute;
    background-color: red;
    width: 20px;
    height: 500px;
    left:100px;
    top:0px;
}

#LeftSidebarContents
{
    background-color: blue;
    position:absolute;
    left:0px;
    top:0px;
} 
```

我建议更多地了解 CSS 盒子模型，并且可能只是阅读一般的 HTML/CSS。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T21:35:48.013

您可能想在 0px 周围加上一些单引号。

检查这个：[http ://api.jquery.com/animate/](http://api.jquery.com/animate/)

复制他们的示例并让他们根据您的需要对其进行修改。

至于检查事件是否被触发的警报：

```
 alert("Thanks for visiting!"); 
```

# c# - 在触发器上更改 XAML 中的按钮内容

> ID：11909302
> 
> 赞同：1
> 
> 时间：2012-08-10T21:10:07.993
> 
> 标签：c#, wpf, xaml, controltemplate

我正在尝试制作一个模板来改变 a`Button`的背景以及它的颜色`TextBlock`。我在模板中尝试了以下 XAML，但它只是使按钮在鼠标悬停时消失。有什么方法可以更改触发器上按钮内容的属性吗？

```
 <ControlTemplate TargetType="{x:Type Button}">
                <Border 
                        x:Name="Border"  
                        CornerRadius="0" 
                        BorderThickness="0"
                        Background="{x:Null}"
                        BorderBrush="#FF404040" />
                    <ControlTemplate.Triggers>
                       <Trigger Property="IsMouseOver" Value="true">
                          <Setter TargetName="Border" Property="Background" Value="White" />
                            <Setter Property="ContentTemplate">
                                <Setter.Value>
                                    <DataTemplate DataType="TextBlock">
                                        <TextBlock Foreground="Blue" />
                                    </DataTemplate>
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T04:41:32.980

风格：

```
<Style TargetType="{x:Type Button}" x:Key="MyButton">
    <Setter Property="OverridesDefaultStyle" Value="True" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Button}">
                <Border x:Name="Border"
                        CornerRadius="0"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        Background="{TemplateBinding Background}"
                        TextBlock.Foreground="{TemplateBinding Foreground}"
                        BorderBrush="#FF404040">
                    <ContentPresenter Margin="2"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      RecognizesAccessKey="True" />
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsMouseOver" Value="true">
                        <Setter TargetName="Border" Property="Background" Value="White" />
                        <Setter TargetName="Border" Property="TextBlock.Foreground" Value="Blue" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

用法：

```
<Button Width="100" Height="50" Content="Lalala" Style="{StaticResource MyButton}" Background="Brown" Foreground="Green" BorderThickness="2"></Button> 
```

1.  您缺少`ContentPresenter`，负责可视`Content`化`Button`.
2.  要设置前景，您可以使用`TextBlock.Foreground`附加属性。
3.  [控制样式和模板](http://msdn.microsoft.com/en-us/library/aa970773.aspx)对我来说一直非常有用:)

# php - WP——按类别获取帖子？

> ID：11909304
> 
> 赞同：18
> 
> 时间：2012-08-10T21:10:15.483
> 
> 标签：php, wordpress

我在我的页面模板中使用它来按类别获取帖子：

```
<?php 
        if (is_page(19)){
            ?>
            <ul>
            <?php
                global $post;
                $args = array( 'category' => 'Testimonial' );
                $myposts = get_posts( $args );
                foreach( $myposts as $post ) :  setup_postdata($post); ?>
                    <li class="testimonial"><?php the_content(); ?></li><br/>
                <?php endforeach; ?>
            </ul>
        <?php } ?> 
```

但它正在检索所有帖子。不仅仅是那些标有推荐信的。知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-09-30T10:23:19.680

'category_name'=>'this cat' 也有效，但未在 WP 文档中打印

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-10T21:11:31.577

在这里检查：[https ://developer.wordpress.org/reference/functions/get_posts/](https://developer.wordpress.org/reference/functions/get_posts/)

> 注意：category参数需要是类别的ID，而不是类别名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-19T11:30:18.590

您可以在参数中使用“category_name”。 [http://codex.wordpress.org/Template_Tags/get_posts](http://codex.wordpress.org/Template_Tags/get_posts)

> 注意： category_name 参数需要是一个字符串，在本例中为类别名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-14T17:38:27.113

```
add_shortcode( 'seriesposts', 'series_posts' );

function series_posts( $atts )
{ ob_start();

$myseriesoption = get_option( '_myseries', null );

$type = $myseriesoption;
$args=array(  'post_type' => $type,  'post_status' => 'publish',  'posts_per_page' => 5,  'caller_get_posts'=> 1);
$my_query = null;
$my_query = new WP_Query($args);
if( $my_query->have_posts() ) {
echo '<ul>'; 
while ($my_query->have_posts()) : $my_query->the_post();
echo '<li><a href="';
echo the_permalink();
echo '">';
echo the_title();
echo '</a></li>'; 
endwhile;
echo '</ul>'; 
}
wp_reset_query();

return ob_get_clean(); } 
```

//这将生成一个在您的网站上使用的简码函数 [seriesposts]

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-01-05T11:28:30.577

创建一个分类字段类别（字段名称 = post_category）并将其导入您的模板中，如下所示：

```
<?php
          $categ = get_field('post_category');  
          $args = array( 'posts_per_page' => 6,
         'category_name' => $categ->slug );
          $myposts = get_posts( $args );
          foreach ( $myposts as $post ) : setup_postdata( $post ); ?>
            //your code here
          <?php endforeach; 
          wp_reset_postdata();?> 
```

# url-rewriting - PrettyFaces 和具有可变路径参数的 url 映射

> ID：11909305
> 
> 赞同：1
> 
> 时间：2012-08-10T21:10:15.783
> 
> 标签：url-rewriting, prettyfaces

在使用 PrettyFaces 重写一些 URL 时，我发现自己使用父 url-mappings 进行映射组合。

例如，想象一个 JSF 应用程序，其页面使用 2 个过滤器过滤新闻。搜索时，页面url变成了这样

```
www.news.com/search.jsf?category=socials&topic=music&page=0 
```

问题是类别和主题是可选参数。我是否被迫为每个组合编写映射，或者有没有办法做这样的事情（忽略不存在的参数并且不添加或忽略路径参数）？

```
<url-mapping id="searchResultList">
    <pattern value="/search/#{cat/}#{topic/}#{page/}"/>
    <view-id value="/pages/search.jsf"/>
</url-mapping> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T06:52:45.823

对于像搜索分页这样的情况，我通常不建议使用路径参数（查询参数在 IMO 中是合适的），但如果你仍然想做这样的事情，那么你可以采取一些潜在的方法之一：

1.  为每个组合写一个映射。这是最可靠的方法。父映射可用于降低复杂性：

    [http://ocpsoft.org/docs/prettyfaces/3.3.2/en-US/html_single/#config.mapping.parents](http://ocpsoft.org/docs/prettyfaces/3.3.2/en-US/html_single/#config.mapping.parents)

2.  编写一个正则表达式配置映射并在自定义操作方法中手动解析动态参数：

    <url-mapping id="searchResultList">
    <pattern value="/search/#{/.*/ cat}"/>
    <view-id value="/pages/search.jsf"/>
    <action>#{ urlParsingBean.parseMyURL}</action>
    </url-mapping>

我希望这是有帮助的。~林肯

# html - Chome 下载 aspx 页面，而不是像在 IE 和 firefox 中那样下载 excel

> ID：11909311
> 
> 赞同：0
> 
> 时间：2012-08-10T21:10:44.877
> 
> 标签：html, excel, google-chrome

我有一个网页，允许用户在 Chrome 中下载 excel 报告，它只是尝试下载 aspx 页面，而不是像在 IE 和 Firefox 中成功下载的 excel。

这是一个已知问题吗？是否有解决方法？

我在 VB 中使用它：

```
db.subRunReader(resultSQL)
dgProperties.DataSource = db.sqlReader
dgProperties.DataBind()
db.subCloseReader()
db.subCloseConnection()

Response.ContentType = "application/vnd.ms-excel"
Response.Charset = ""
Me.EnableViewState = False

Dim tw As New System.IO.StringWriter()
Dim hw As New System.Web.UI.HtmlTextWriter(tw)
dgProperties.RenderControl(hw)
Response.Write(tw.ToString())
Response.End()
Response.Redirect(Request.Url.ToString()) 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:39:20.930

不确定您的具体情况，但一般来说，每当您想要下载文件时，添加`Content-Disposition`标题是个好主意。在 ASP.NET MVC 中，它会这样完成：

```
Response.Headers["Content-Disposition"] = 
    "attachment;filename=yourfile.xls"; 
```

我希望在 ASP.NET 2.0 中它会是类似的东西。这告诉浏览器它需要下载文件。

# c# - 在 C# 中使用结构读取数据

> ID：11909313
> 
> 赞同：1
> 
> 时间：2012-08-10T21:10:48.973
> 
> 标签：c#

假设我有一个这样定义的结构

```
struct Student
{
  int age;
  int height;
  char[] name[12];
} 
```

当我读取二进制文件时，它看起来像

```
List<Student> students = new List<Student>();
Student someStudent;

int num_students = myFile.readUInt32();
for (int i = 0; i < num_students; i++)
{
   // read a student struct
} 
```

我怎样才能编写我的结构，以便我只需要按照以下方式说些什么

```
someStudent = new Student(); 
```

这样它就会按照定义结构的顺序读取文件，并允许我根据需要使用类似的语法获取值

```
someStudent.age; 
```

我可以将 Student 定义为一个类，并让构造函数读取数据并填充它们，但它除了 getter/setter 之外没有任何方法，所以我认为结构更合适。

或者我使用类还是结构都没有关系？我见过其他人使用结构来编写 C 代码来读取数据块，并认为这是一种“好”的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:17:58.130

AFAIK 没有内置于 .NET 中的低级直接布局结构读取器。您想查看 BinaryReader，依次读取每个字段吗？基本上，两次 ReadInt32() 和 ReadChars()。特别注意字符数据的**编码**（ASCII？UTF8？UTF-16？）和整数的*字节序*。

就个人而言，我更倾向于使用专用的跨平台序列化程序！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:16:05.300

**如果你想序列化/反序列化结构**

如果你想读/写整个结构到一个二进制文件（序列化），我建议你看看

[https://stackoverflow.com/a/629120/141172](https://stackoverflow.com/a/629120/141172)

或者，如果您可以选择，请遵循@Marc 的建议并使用跨平台序列化程序。我个人建议[使用 protobuf-net](http://code.google.com/p/protobuf-net/)，它恰好是由 @Marc 编写的。

**如果您从任意文件格式加载**

就像*class*一样，*struct*可以有一个接受多个参数的构造函数。事实上，*不*为*struct*提供设置器通常是明智的。这样做可以让*结构体*的值在构造后发生变化，这通常会导致编程错误，因为许多开发人员没有意识到*结构体*是具有值语义的值类型这一事实。

我建议提供一个构造函数来初始化您的*struct*，将文件中的值读取到临时变量中，然后使用构造函数构造*struct*。

```
public stuct MyStruct
{
    public int Age { get; private set; }
    public int Height { get; private set; }
    private char[] name;
    public char[] Name 
    {
        get { return name; }
        set
        {
            if (value.Length > 12) throw new Exception("Max length is 12");
            name = value;
        }
    }
    public MyStruct(int age, int height, char[] name)
    {
    }
} 
```

为了进一步挖掘可变结构的危险（可以在初始化后更改的结构），我建议

[为什么可变结构是“邪恶的”？](https://stackoverflow.com/questions/441309/why-are-mutable-structs-evil)

# ruby-on-rails - 设计和自定义 Rails 用户 URL

> ID：11909319
> 
> 赞同：2
> 
> 时间：2012-08-10T21:11:30.140
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, routes, ruby-on-rails-3.2

我目前正在使用带有最新设计 gem 的 Rails 3.2.5。

目前，用户可以在... example.com/users/john-doe 访问他们的个人资料页面

我想删除 url 的用户部分，所以 url 将是*example.com/john-doe*。这可能与设计吗？

现在在我的路线文件中，我有以下内容......

```
devise_for :users, :controllers => {:omniauth_callbacks => 'omniauth_callbacks'} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:19:01.303

只需为其添加一条路线。您可能希望它成为路由文件中的最后一个。

就像是：

```
match '/:user' => "users#show", :as => :user_profile 
```

# java - 如果 Java 生产代码中不存在数据库表，则创建数据库表并在 JUnit 中确认

> ID：11909324
> 
> 赞同：5
> 
> 时间：2012-08-10T21:11:52.767
> 
> 标签：java, sql, jdbc, junit

我正在用 Java 编写一个数据库程序，如果它不存在，我想创建一个表。我`DatabaseMetaData.getTables()`从[如何在 Java 中检测 SQL 表的存在？](https://stackoverflow.com/questions/927807/how-can-i-detect-a-sql-tables-existence-in-java)我正在尝试使用它：

```
private boolean tableExists() throws SQLException {
    System.out.println("tableExists()");

    DatabaseMetaData dbmd = conn.getMetaData();
    ResultSet rs = dbmd.getTables(null, null, this.getTableName(), null);

    System.out.println("TABLE_NAME: " + rs.getString("TABLE_NAME"));

    return rs.getRow() == 1;
} 
```

问题是`rs.getRow()`总是返回`0`，即使在创建表之后也是如此。Using`rs.getString("TABLE_NAME")`会抛出一个异常，指出结果集为空。

我想到的一种可能的解决方案是执行`CREATE TABLE`语句并捕获抛出的任何异常。但是，我不喜欢在程序的控制流中使用异常的想法。

FWIW，我正在使用 HSQLDB。但是，我想编写独立于 RDMS 引擎的 Java 代码。还有另一种方法可以`DatabaseMetaData.getTables()`用来做我想做的事吗？还是有其他解决方案来编写我的`tableExists()`方法？

**添加：**

使用此处给出的建议，我找到了一个似乎适用于我的生产代码的解决方案：

```
private void createTable() throws SQLException {
    String sqlCreate = "CREATE TABLE IF NOT EXISTS " + this.getTableName()
            + "  (brand           VARCHAR(10),"
            + "   year            INTEGER,"
            + "   number          INTEGER,"
            + "   value           INTEGER,"
            + "   card_count           INTEGER,"
            + "   player_name     VARCHAR(50),"
            + "   player_position VARCHAR(20))";

    Statement stmt = conn.createStatement();
    stmt.execute(sqlCreate);
} 
```

现在我还在编写一个 JUnit 测试来断言该表确实已创建：

```
public void testConstructor() throws Exception {
    try (BaseballCardJDBCIO bcdb = new BaseballCardJDBCIO(this.url)) {
        String query = "SELECT count(*) FROM information_schema.system_tables WHERE table_name = '" + bcdb.getTableName() + "'";
        Connection conn = DriverManager.getConnection(this.url);
        Statement stmt = conn.createStatement();
        ResultSet rs = stmt.executeQuery(query);
        Assert.assertTrue(rs.next());
        Assert.assertEquals(1, rs.getInt(1));
        Assert.assertFalse(rs.next());
    }
} 
```

此测试失败`assertEquals()`并显示以下消息：

```
FAILED: expected: <1> but was: <0> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-10T21:37:05.890

我找到的解决方案似乎有效：

```
private void createTable() throws SQLException {
    String sqlCreate = "CREATE TABLE IF NOT EXISTS " + this.getTableName()
            + "  (brand           VARCHAR(10),"
            + "   year            INTEGER,"
            + "   number          INTEGER,"
            + "   value           INTEGER,"
            + "   card_count           INTEGER,"
            + "   player_name     VARCHAR(50),"
            + "   player_position VARCHAR(20))";

    Statement stmt = conn.createStatement();
    stmt.execute(sqlCreate);
} 
```

我必须将它放在`IF NOT EXISTS`我的 SQL 语句中的正确位置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T21:18:42.110

根据[`ResultSet`](http://docs.oracle.com/javase/7/docs/api/java/sql/ResultSet.html)Java 文档的定义：

> ResultSet 对象维护一个指向其当前数据行的游标。最初，光标位于第一行之前。next 方法将光标移动到下一行，因为当 ResultSet 对象中没有更多行时它返回 false，所以可以在 while 循环中使用它来遍历结果集。

因此，您必须始终调用该`next()`方法，否则`getRow()`将始终返回零，因为光标位于第一行之前。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T21:13:46.857

内置 mysql 功能可满足您的需求：http: [//dev.mysql.com/doc/refman/5.0/en/create-table.html](http://dev.mysql.com/doc/refman/5.0/en/create-table.html)

简而言之：只需`IF NOT EXISTS`在表创建查询的末尾追加即可。

编辑：
没有一般的方法可以做到这一点。大多数数据库都有一个 information_scheme 表，确定信息的查询可能如下所示：

`SELECT count(*) FROM information_schema.system_tables WHERE table_schem = 'public' AND table_name = 'user';`

这适用于 sqlite、mysql、msql、mariadb 和 postgres + 可能还有很多其他的。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-08-10T21:15:06.997

我不知道这是否一定有助于实现您的目标，但是当我使用 Python 和 MySQL 遇到这个问题时，我只是在每个“创建表”语句之前添加了一个“删除表”语句，这样就可以自动运行脚本删除现有表，然后重建每个表。这可能无法满足您的需求，但这是我发现成功解决类似问题的一种解决方案。

# javascript - 带有jquery .push的Javascript全局数组在备用函数中返回空数组

> ID：11909326
> 
> 赞同：0
> 
> 时间：2012-08-10T21:12:17.740
> 
> 标签：javascript, jquery-mobile

我在函数之外声明了一个变量，如下所示：

```
var vitalsValuesChecked = []; 
```

然后在我做的一个函数内部：

```
vitalsValuesChecked.push('foobar'); 
```

在稍后的函数中，我需要遍历数组以获取推送的项目，并且一直没有得到我期望的结果。所以在同一个函数中，我添加了`console.log(vitalsValuesChecked);`which returns `[]`。

**编辑**代码示例如下； **编辑 2**下面的固定代码

```
var vitalsValuesChecked = [];

$(document).delegate("#hv-byresult-btn", "click", function () {
    var vitalsTypeList = ['bp', 'ht', 'wt', 'pulse', 'resp', 'temp'];
    vitalsValuesChecked = [];
    for (var i = 0;i < vitalsTypeList.length;i++) {
        if (document.getElementById(vitalsTypeList[i]).checked == true) {
            vitalsValuesChecked.push(vitalsTypeList[i]);
            console.log(vitalsTypeList[i] + " is checked. Adding to global array");
        }
    }
    $('#vitals-measures-content').empty();
    navigate("#vitals-measures");
    for (var i = 0;i < vitalsValuesChecked.length;i++) {
        console.log("vitalsValuesChecked at index " + i + " is " + vitalsValuesChecked[i]);
     }
        readRec('clinicalObservation', null, sortVitalsByResult);

    });
function foobar() {
    console.log(vitalsValuesChecked); //return []
    for (var i=0;i < vitalsValuesChecked.length;i++) {
        var valueSelected = vitalsValuesChecked[i];
        console.log("Value of vitalsValuesChecked at index " + i + " is " + vitalsValuesChecked[i]);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:19:55.187

您已经定义`vitalsValuesChecked`了两次，这是一个问题。一个是全局的，一个是本地的 delegate() 回调。局部定义会覆盖全局定义，因此当您认为将值设置为全局变量时，您并没有 - 您只是更改了生命周期有限的局部变量，因此您的数据稍后在全局变量中不可用。

你应该删除

```
var vitalsValuesChecked = []; 
```

在委托处理程序内部，因此所有修改都发生在单个全局变量上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:21:23.593

函数内部将`var vitalsValuesChecked = [];`创建一个局部变量。如果您尝试推送到全局变量，我认为您不需要这个。

# javascript - 使用 JavaScript 替换 VisualForce 页面上的文本

> ID：11909334
> 
> 赞同：2
> 
> 时间：2012-08-10T21:12:56.000
> 
> 标签：javascript, jquery, html, replace, visualforce

我正在使用 VisualForce 页面（与 SalesForce 相关），我需要编写一段 JavaScript，在加载所有内容后替换页面上的一些文本。

我尝试了以下方法（我在页面的其他部分使用 jQuery，所以我也为此使用了 jQuery）：

```
var j$ = jQuery.noConflict();
j$(document).ready(function()
{
  var replaced = $find("body").html().replace('Test', '1234');
  $("body").html(replaced);
}); 
```

不幸的是，它似乎没有做任何事情。就像我无法获取页面 HTML 代码一样。我假设这是因为这是在 Force 平台上运行的 VisualForce 页面，所以如果有人可以提供任何帮助，将不胜感激。

谢谢。

PS 如果有人想知道我为什么这样做是因为我无法通过 VisualForce 或 Apex 执行此操作，因为我试图对变量提供的一些 HTML 字符进行转义并在 dataTable 标头中使用。不幸的是，dataTable 标头中的所有内容都会自动转义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:48:38.997

首先，它应该是 $.find() 但哼.. 也不是必需的：只需 $("body") 作为选择器。

然后在一行中你可以写：

`$("body").html($("body").html().replace(/test/g, '1234'));`

注意正则表达式中的 /g ，它应该允许它替换所有测试实例，而不仅仅是第一个。

您可能还需要精确地使用 j$ 并在任何地方使用它，而不仅仅是用于文档就绪事件。上面的行使用 $ 快捷方式。

# java - 知道如何在读取套接字数据（InputStream）时检测断开连接

> ID：11909336
> 
> 赞同：1
> 
> 时间：2012-08-10T21:13:03.857
> 
> 标签：java, sockets, stream, network-programming

我有一个线程不断从 InputStream 读取数据。InputStream 数据来自蓝牙套接字。以前，我没有在 InputStream 读取语句周围使用 if(mmInStream.available() > 0) 并且当蓝牙套接字消失（有人关闭设备）时， mmInStream.read 会抛出 IOException 然后我可以处理我的断开逻辑。确定何时发生断开连接的最佳方法是什么？

0xEE 的第一个字节告诉我它是数据包的领导者，第二个字节告诉我要读取的长度。

```
public void run() {
            byte[] tempBuffer = new byte[1024];
            byte[] buffer = null;
            int byteRead=0;
        long timeout=0;
        long wait=100;

            while (true) {
                try {
                timeout = System.currentTimeMillis() + wait;
                    if(mmInStream.available() > 0) {
                        while((mmInStream.available() > 0) && (tempBuffer[0] != (byte) 0xEE) && (System.currentTimeMillis() < timeout)){
                        byteRead = mmInStream.read(tempBuffer, 0, 1);
                    }
                    if(tempBuffer[0] == (byte) 0xEE){
                        timeout = System.currentTimeMillis() + wait; 
                        while(byteRead<2 && (System.currentTimeMillis() < timeout)){
                            byteRead += mmInStream.read(tempBuffer, 1, 1); 
                        }
                    }
                    timeout = System.currentTimeMillis() + wait; 
                    while((byteRead<tempBuffer[1]) && (System.currentTimeMillis() < timeout)){
                        byteRead += mmInStream.read(tempBuffer, byteRead, tempBuffer[1]-byteRead); 
                    }
                    }

                    if(byteRead > 0){
                        //do something with the bytes read in               
                    } 
                }

                catch (IOException e) {
                    bluetoothConnectionLost();
                    break;
                }
            }

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T02:06:47.027

您不需要使用 available() 进行所有这些恶意操作。只需使用 setSoTimeout 设置读取超时，读取，检测读取返回 -1，使用 read 返回的计数 if > 0 而不是假设缓冲区已填满，捕获 SocketTimeoutException 以检测读取超时，并捕获 IOException 以检测其他破损。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:36:37.433

看了下文档，我觉得是这样的：

```
public void run() {
    byte[] tempBuffer = new byte[1024];
    int byteRead = 0;

    while (true) {
        try {
            bytesRead = mmInStream.read(tempBuffer, 0, tempBuffer.length);
            if (bytesRead < 0)
                // End of stream.
                break;

            // Do something with the bytes read in. There are bytesRead bytes in tempBuffer.
        } catch (IOException e) {
            bluetoothConnectionLost();
            break;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-21T09:43:34.520

我认为是这样的：

```
 void fun(){
   isOpen = true;
   try{
      InputStream stream = socket.getInputStream();
      while(isOpen){
         byte[] buf = new byte[8];
         int pos = stream.read(buf);
         if (pos < 0) {
            throw new IOException();
         }
         //dosomething...
      }
  }catch(IOException e) {
    isOpen  = false;
  }finally{
    //do dispose here
  }
} 
```

# c++ - 类型类的输出向量

> ID：11909338
> 
> 赞同：0
> 
> 时间：2012-08-10T21:13:25.677
> 
> 标签：c++, vector

这个问题在上一个问题中有更多代码：[C++ Trouble Inputing Data into Private Vector (invalid use)](https://stackoverflow.com/q/11908532/938865)

我正在尝试输出“帐户”类型的向量

帐户：

```
class Account
{
    string firstName;
    string lastName;
    string accountPass;
    int accountID;
    float accountBalance;

private:
    int depositAmount;
    int withdrawAmount;

public:
    static Account createAccount( int, float, string, string, string ); //creates new account
    void deposit( int );    //deposits money into account
    void withdraw(int);     //withdrawals money from account
    int retdeposit() const; //function to return balance amount
    friend class BankingSystem;

}; //end of class Account 
```

这是我声明向量的方式： `std::vector<Account> accounts_;`

这是我尝试将其打印到屏幕上的方式：

```
for(int i=0; i < accounts_.size(); i++)
{     cout<< accounts_[i] <<endl;   } 
```

但我收到此错误“二进制表达式的无效操作数”。

当前代码；

```
class BankingSystem
{
int accountID;
char fileName;

private:
std::vector<Account> accounts_;

public:
void addAccount();
void storeAccount( Account );
void deleteAccount();
void accountInquiry();
void saveAccounts();
void loadAccountsFromFile();
friend class Account;
friend std::ostream& operator << (std::ostream&, const Account&);

}; // end of class BankingSystem
#endif

std::ostream& operator << (std::ostream& os, const Account& acc)
{
// output members to os
return os;
}

void BankingSystem::addAccount()
{
int ID;
float balance;
std::string pass, first, last;

cout << "\n\t Enter the Account ID: ";
cin >> ID;
cout << "\n\t Enter the passcode: ";
cin >> pass;
cout << "\n\t Enter Client's first name: ";
cin >> first;
cout << "\n\t Enter Client's last name: ";
cin >> last;
cout << "\n\t Enter starting balance: ";
cin >> setw(6) >> balance;

storeAccount( Account::createAccount( ID, balance, pass, first, last ) );

return;

}

//function gets data from createAccount
void BankingSystem::storeAccount( Account newAccountToAdd )
{
//append to vector "accounts_"
accounts_.push_back(newAccountToAdd);

}

void BankingSystem::deleteAccount()
{
cout << "\nEnter The Account ID: ";
cin >> accountID;

}

void BankingSystem::accountInquiry()
{
int n;
cout << "\n\t Enter The Account ID (-1 for all): ";
cin >> n;

//cout << accounts_.size();

if (n == -1)
{
    cout << "\n\t List of all Accounts; (" << accounts_.size() << ") TOTAL: ";

    for(int i=0; i < accounts_.size(); i++)
    {     
        cout<< accounts_[i] << endl;   
    }
}
else
{
    cout << "\n\t Listing Account: " << n;
    cout << "\n\t I should search the vector for the ID you input";
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:17:50.237

您需要提供插入运算符：

```
std::ostream& operator<<( std::ostream& out, const Account& acct ); 
```

然后通过以适当的格式转储每个字段来在内部实现它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:18:44.503

你应该超载上课`operator <<`。`Account`在班上：

```
friend std::ostream& operator << (std::ostream&, const Account&); 
```

在全局（或您的，帐户被定义的地方）命名空间中

```
std::ostream& operator << (std::ostream& os, const Account& acc)
{
    // output members to os
    return os;
} 
```

或在类中创建一些输出函数，例如

```
void print(std::ostream& os) const { } 
```

进而`free-operator <<`

```
std::ostream& operator << (std::ostream& os, const Account& acc)
{
    acc.print(os);
    return os;
} 
```

# javascript - 如果选择了多个选项，使用 jQuery 显示隐藏的表单元素？

> ID：11909340
> 
> 赞同：0
> 
> 时间：2012-08-10T21:13:29.973
> 
> 标签：javascript, jquery, toggle, visibility, contact-form

我在联系表单中有一个下拉选择，如果选择了任何一个选项，我想显示一些额外的表单元素。否则，应隐藏附加元素。我已经能够使用以下代码使用单个选项来完成此工作：

```
$(".hidden-section").hide();
$("#contact-form select").change(function(){
    if ($(this).val() == "extra options trigger one") {
        $(".hidden-section").slideDown("fast");
    } else {
        $(".hidden-section").slideUp("fast");
    }
}); 
```

不幸的是，如果选择了两个选项中的任何一个，我无法弄清楚如何让它工作。我能够让 jQuery 工作的唯一方法是：

```
$(".hidden-section").hide();
$("#contact-form select").change(function(){
    if ($(this).val() == "extra options trigger one") || ($(this).val() == "extra options trigger two") {
        $(".hidden-section").slideDown("fast");
    } else {
        $(".hidden-section").slideUp("fast");
    }
}); 
```

但是在这种情况下，一旦选择了除默认值之外的任何选项，隐藏的元素就会显示出来。

关于更好的解决方法的任何想法？非常感谢任何建议。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:17:46.007

你在这一行有额外的括号，不应该在那里：

```
if ($(this).val() == "extra options trigger one") || ($(this).val() == "extra options trigger two") { 
```

应该：

```
if ($(this).val() == "extra options trigger one" || $(this).val() == "extra options trigger two") { 
```

也就是说，`if()`语句的条件需要完全包含在外括号内，所以：

```
if (condition1 || condition2)          // valid
if ((condition1) || (condition2))      // valid
if (condition1) || (condition2)        // NOT valid 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:41:15.280

让我对您的代码添加一些注释。

首先 - 不要使用`$(".hidden-section").hide();`- 你应该添加`display:none`到`.hidden-section`CSS。原因是对于某些人来说网络连接很慢，并且在他们的浏览器运行 javascript 之前`hide`需要一些时间。在此期间它将是可见的。他们会经历闪烁——某些东西会出现然后突然消失。

评论 #2 -

如果你的 HTML 没有在 Ajax 中加载，你应该用`$(function(){ /* code here */ });`- 包装它，因为这只会在整个页面准备好时运行 JavaScript。当您的 JavaScript 引用 HTML 内容时，这是必需的。

评论 #3 -

您的代码将难以维护 - 想象有第三种选择需要额外的字段。

例如，您最好在需要额外字段的每个选项上添加一个类，`<option class="requires-extra">Option 2</option>`然后您的 JavaScript 会更短。

```
$(function(){
    $("select").change(function(){
        var $requiresExtra = $(this).find("option:selected").hasClass("requires-extra");
        if ( $requiresExtra ) {
            $(".hidden-section").slideDown("fast");
        } else {
            $(".hidden-section").slideUp("fast");
        }
    });
}); 
```

请参阅[我的小提琴](http://jsfiddle.net/2yzPn/)以获取工作示例。

# objective-c - PDF 在图像上方/文本下方突出显示

> ID：11909341
> 
> 赞同：0
> 
> 时间：2012-08-10T21:13:38.053
> 
> 标签：objective-c, pdf, annotations, core-graphics, highlight

我正在尝试突出显示 pdf 中的文本，并在文本下方绘制突出显示的矩形。

它在大多数 PDF 上都可以正常工作，但是当我试图突出显示的文本下面有图像/背景时，我遇到了一个问题。问题是高亮矩形也绘制在图像下方，因此不可见。

我的绘图顺序是这样的：

*   用页面大小绘制一个空白矩形
*   画出亮点
*   使用 CGContextDrawPDFPage(context, page) 绘制 pdf；

有没有办法分别绘制 PDF 图像和文本？这样我就可以走了

*   空白矩形
*   pdf图像/背景
*   强调
*   pdf文本

我是否必须对 pdf / 上下文做一些事情，以便它按照我想要的方式自动绘制它？我试过弄乱上下文，但到目前为止没有任何效果，它全部绘制在完整的 pdf 之下或之上

我见过的每个读者都会这样做（PDFExpert、GoodReader、iAnnotate 等等），所以这不是不可能的，我只是还没有找到解决方案 :) 任何帮助都会有所帮助，在此先感谢！！

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:45:12.557

我的理解是，这些其他应用程序本身正在阅读和呈现 PDF（例如，它们支持选择文本或添加注释），因此它们将能够更轻松地以您提到的方式对事物进行分层。

您开始使用的 CGPDFDocument 是一个不透明的对象（在 OO 意义上，不是透明度），它可以自己绘制，但我不知道有什么方法可以打破和渲染文档的各个子层。

作为一种前进的方式，您可以考虑使用 Core Image (iOS5+) 或其他方法将高光层与 PDF 混合。如果您使用了正确的过滤器（可能是正片叠底），较暗的文本仍然会通过，并且 0.3 alpha 高亮会与任何背景混合。

# c - 单次遍历中链接列表的中点？

> ID：11909342
> 
> 赞同：7
> 
> 时间：2012-08-10T21:13:40.320
> 
> 标签：c, data-structures, hyperlink, singly-linked-list

我试图找到循环开始的单链接列表的点。我想到的是用 2 个指针 *慢，*快，一个以两倍于另一个的速度移动。如果列表有一个循环，那么在某个时候

```
 5-6-7-8
    |     |
1-2-3-4-7-7 
```

慢=快

是否有另一种优雅的解决方案，以便列表只遍历一次？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T21:19:57.410

您使用两个walker 的想法，其中一个的速度是另一个的两倍会起作用，但是这提出的更基本的问题是您是否选择了合适的数据结构？您应该问自己是否真的需要找到中点，如果需要，还有哪些其他结构可能更适合在 O(1)（恒定）时间内实现这一目标？数组肯定会为集合的中点提供更好的性能，但其他操作速度较慢。在不了解其余上下文的情况下，我无法提出任何其他建议，但我建议您查看您的要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T21:19:54.330

我假设这个单链表以 NULL 结尾。在这种情况下，慢指针和快指针都会起作用。因为快指针的速度是慢指针的两倍，所以如果快指针到达列表末尾，慢指针应该在它的中间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-10T21:25:30.617

我假设这是某种面试问题。

如果您的列表有一个循环，那么要在一次遍历中完成，您需要在快速步行者通过列表时将节点标记为已访问。当 fast walker 遇到 NULL 或已经访问过的节点时，迭代可以结束，而你的 slow walker 处于中点。

有很多方法可以将节点标记为已访问，但可以使用外部地图或集合。如果您直接在节点本身中标记节点，则需要再次遍历以清理标记。

**编辑：**所以这不是关于找到中点，而是关于循环检测而不重新访问已经访问过的节点。标记也适用于此。只需遍历列表并标记节点。如果你命中 NULL，则没有循环。如果你点击一个访问过的节点，就会出现一个循环。如果标记还包括一个计数器，您甚至可以知道循环从哪里开始。

# c++ - 自动工具检查 C++11

> ID：11909347
> 
> 赞同：23
> 
> 时间：2012-08-10T21:14:03.580
> 
> 标签：c++, c++11, autotools, autoconf

我使用`AX_CXX_COMPILE_STDCXX_0X`（可以查看 autoconf-archive）来检查编译器的 c++11 功能。它正确地确定了`-std=c++0x`需要，但没有将其添加到`CXXFLAGS`. 我查看了宏源，它实际上会检查但随后会恢复以前的标志。

我应该怎么做才能`CXXFLAGS`编译 c++11 源代码？

只是添加`-std=c++0x`到`AM_CXXFLAGS`不是很好的解决方案，因为我想把编译器在 C++11 模式下编译的负担交给 autoconf 开发人员，而不是我。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-10T22:59:03.360

您正在寻找的东西已经被制作为[autoconf-archive](https://www.gnu.org/software/autoconf-archive/)[`AX_CXX_COMPILE_STDCXX_11`](https://www.gnu.org/software/autoconf-archive/ax_cxx_compile_stdcxx_11.html)的一部分。如果没有可用的 C++11 支持，它将向环境添加所需的选项（以前通过，现在通过）并出错。`CXXFLAGS``CXX`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-27T16:56:33.677

一般来说，您可以编译一个简单的代码并根据编译结果设置一个变量

```
DIALECT="-std=c++14"
echo 'int main() {return 0;}' > ./log.cpp && $CXX -std=c++14 ./log.cpp || $DIALECT="no"

if test $DILAECT = no; then
    AC_MSG_ERROR([c++ compiler does not support c++14])
else
    echo $DILAECT
fi 
```

# sql-server-2008 - COALESCE 在一行上获取逗号分隔值

> ID：11909352
> 
> 赞同：0
> 
> 时间：2012-08-10T21:14:29.727
> 
> 标签：sql-server-2008, reporting-services

尝试为 SQL Reporting Services 数据库的目录表中列出的每个报告获取逗号分隔的参数列表：

```
WITH cte AS (
    SELECT
    [Path], [Name], CreationDate, ModifiedDate,    
    CAST(parameter AS XML) AS parameter
    FROM     [dbo].[Catalog] AS c
)
SELECT  [Path], [Name], CreationDate, ModifiedDate, COALESCE(p.nodes('./Name')) 
FROM    cte AS c
    LEFT JOIN c.Parameter.nodes('/Parameters/Parameter') AS T ( p )
ORDER BY c.[Path] 
```

在 BOL 中，它说 COALESCE 用于返回第一个非空值，但我读过它可用于逗号分隔返回的值表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:23:56.850

我不知道使用 COALESCE 生成 CSV 的任何方法。但是，我确实对 XML PATH 查询使用了标准技巧：

```
WITH cte AS (
    SELECT  [Path] ,
            [Name] ,
            CreationDate ,
            ModifiedDate ,
            CAST(parameter AS XML) AS parameter
    FROM    [dbo].[Catalog] AS c
), 
cte2 AS (
SELECT  [Path] ,
        p.value('(./Name)[1]', 'nvarchar(50)') AS [Parameter]
FROM    [cte] AS c
CROSS APPLY c.parameter.nodes('/Parameters/Parameter') AS T ( p )
)

SELECT [Path], 
    STUFF((
        SELECT ',' + [Parameter] 
        from cte2 c2
        WHERE c.[Path] = c2.[Path]    
        FOR XML PATH('') 
    ), 1, 1, '')
from [dbo].[Catalog] AS c 
```

本质上，通过在查询末尾抛出“FOR XML PATH('')”，您可以说“获取所有返回的行并将它们与一个空字符串连接在一起作为周围的标记”。虽然这可以让你到达你需要去的地方，但如果你传入一个空字符串之外的东西，你可以试试看它的行为。

# common-lisp - 有没有办法像这样连接两个通用对象？: (foo 'a 'b) => 'ab

> ID：11909354
> 
> 赞同：0
> 
> 时间：2012-08-10T21:14:37.137
> 
> 标签：common-lisp

这样的事情存在吗？这似乎是一个基本功能，但我找不到类似的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T03:21:40.597

```
(defun concatoms (a b)
  (intern (concatenate 'string (symbol-name a) (symbol-name b)))) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-11T07:51:43.050

[Onlisp](http://www.paulgraham.com/onlisp.html)（第 57 页，第 4.7 节，*符号和字符串*）有一个更通用的解决方案：

```
(defun mkstr (&rest args)
  (with-output-to-string (s)
    (dolist (a args) (princ a s))))

(defun symb (&rest args)
  (values (intern (apply #'mkstr args)))) 
```

使用`symb`您可以连接字符串、符号、数字等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T06:21:38.207

您要做的是生成新符号。您可以使用`intern`或使用`make-symbol`（取决于您是否需要符号）来执行此操作。但是，这也是一个信号，表明您正在做一些需要更多思考的事情，从其他符号的符号名称的连接中生成符号很少是最好的事情。

如果您绝对需要创建新符号，则应该这样做：

```
(defun concatenate-symbols (a b &optional (package *package*))
  (intern (concatenate 'string (symbol-name a) (symbol-name b)) package)) 
```

# jquery - jquery当前菜单项改变颜色问题

> ID：11909359
> 
> 赞同：0
> 
> 时间：2012-08-10T21:15:04.143
> 
> 标签：jquery, menu

默认`a:link`和`a:visited`背景颜色是透明的，颜色是黑色的。然后 a:hover 指定背景为黑色，颜色为白色。这很好用。

这是问题所在：我插入了执行背景和颜色更改的 jquery 脚本，在我的情况下将背景黑色和颜色设置为白色 - 与`a:hover`. 此脚本正在执行所需的操作，但文本的颜色保持黑色。有什么帮助吗？

以下是代码：

```
<ul id="subnav">
    <li><a href="http://127.0.0.1:4001/wbdemo/pages/abc.php" class=”red” onclick=”selected(this)”&gt;<h99>Home<h99/></a></li>
    <li><a href="http://127.0.0.1:4001/wbdemo/pages/asd.php"><h99>Home</h99></a></li>
    <li><a href="http://127.0.0.1:4001/wbdemo/pages/rtz.php"><h99>Home</h99/></a></li> 
    <li><a href="#"><h99>Home</h99/></a></li> 
    <li><a href="#"><h99>Home</h99/></a></li>
</ul> 

<script type="text/javascript">
$(document).ready(function(){
    $('#subnav a').each(function(index) {
        if(this.href.trim() == window.location)
            $(this).addClass("selected");
    });
});
</script> 
```

```
ul
{ list-style-type: none;
  margin:0;
  padding:0;
  overflow: hidden;
}

ul a:link, ul a:visited
{ display: block;
  width: 240px;
  background-color: tranparent;
  text-align: right;
  text-transform: uppercase;
  text-decoration: none;
  height: 40px;
  color: #000000
}

ul a:hover, .selected
{ background-color: #000000;
  color: #ffffff
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:31:17.147

将最后一个 css 类拆分为两个：

```
ul a:hover
{ 
  background-color: #000000;
  color: #ffffff;
}

.selected
{ 
  background-color: #000000;
  color: #ffffff !important;
} 
```

或者，更简单，只需`!important`添加到最后一行：

```
ul a:hover, .selected
{ 
  background-color: #000000;
  color: #ffffff !important;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:23:44.993

尝试

```
$(this).css('color','coloryouwant') 
```

# java - 带有 SimpleCursorAdapter 的 Android ListView - CursorIndexOutOfBoundsException 错误

> ID：11909363
> 
> 赞同：0
> 
> 时间：2012-08-10T21:15:23.287
> 
> 标签：java, android, sqlite, listview, cursor

我有一个`ListView`使用`AcitivityA`名为. 适配器保存来自`SimpleCursorAdapter``RecipeAdapter``SQLite`

`EditText`顶部有一个视图`ListView`，用于在用户搜索食谱时过滤列表视图。当用户单击过滤后的项目时`ListView`，`ActivityB`启动。

这一切都完美无缺。但是，当用户按下后退按钮恢复`ActivityB`时，我收到以下错误。

```
java.lang.RuntimeException: Unable to resume activity {ttj.android.quorn/ttj.android.quorn.RecipeActivity}: 
java.lang.IllegalStateException: trying to requery an already closed cursor  android.database.sqlite.SQLiteCursor@418ae5d8 
```

为了解决这个问题，我修改了`onResume()`来自：

```
...
c = db.getCursor(); 
adapter.changeCursor(c); 
```

到

```
....
Cursor cursor = db.getCursor(); 
adapter.changeCursor(cursor); 
```

然后我得到以下异常。在 Logcat 中，问题出现`getId()`在`DBHelper`. 我已经添加`c.moveToFirst()`了这个方法，但这仍然不能解决问题。

```
FATAL EXCEPTION: main
android.database.CursorIndexOutOfBoundsException: Index -1 requested, with a size of 70
at android.database.AbstractCursor.checkPosition(AbstractCursor.java:400)
at android.database.AbstractWindowedCursor.checkPosition(AbstractWindowedCursor.java:136)
at android.database.AbstractWindowedCursor.getString(AbstractWindowedCursor.java:50)
at ttj.android.quorn.DBHelper.getId(DBHelper.java:224)
at ttj.android.quorn.RecipeActivity$RecipeHolder.populateFrom(RecipeActivity.java:650)
at ttj.android.quorn.RecipeActivity$RecipeAdapter.bindView(RecipeActivity.java:572)
at android.support.v4.widget.CursorAdapter.getView(CursorAdapter.java:256)
at android.widget.AbsListView.obtainView(AbsListView.java:2214)
at android.widget.ListView.makeAndAddView(ListView.java:1774)
at android.widget.ListView.fillDown(ListView.java:672)
at android.widget.ListView.fillFromTop(ListView.java:732)
at android.widget.ListView.layoutChildren(ListView.java:1611)
at android.widget.AbsListView.onLayout(AbsListView.java:2044)
at android.view.View.layout(View.java:11418)
at android.view.ViewGroup.layout(ViewGroup.java:4224)
at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1628)
at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1486)
at android.widget.LinearLayout.onLayout(LinearLayout.java:1399)
at android.view.View.layout(View.java:11418)
at android.view.ViewGroup.layout(ViewGroup.java:4224)
at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
at android.view.View.layout(View.java:11418)
at android.view.ViewGroup.layout(ViewGroup.java:4224)
at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1628)
at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1486)
at android.widget.LinearLayout.onLayout(LinearLayout.java:1399)
at android.view.View.layout(View.java:11418)
at android.view.ViewGroup.layout(ViewGroup.java:4224)
at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
at android.view.View.layout(View.java:11418)
at android.view.ViewGroup.layout(ViewGroup.java:4224)
at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1628)
at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2585)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4507)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557)
at dalvik.system.NativeStart.main(Native Method) 
```

谁能帮我解决我的问题？

这是我的代码：

在 中`onCreate`，`cursor`填充`ListView`使用`c.getCursor`，当用户`ListView`通过过滤时`EditText`，`c.getFilterCursor`使用 。

```
public class RecipeActivity extends SherlockListActivity {

private DBHelper db = null;
private Cursor c = null;
private RecipeAdapter adapter = null;
ListView listContent;   
private EditText filterText = null;

@SuppressWarnings("deprecation")
@Override
public void onCreate(Bundle savedInstanceState) {
    try {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.filter_list);

        filterText = (EditText) findViewById(R.id.search_box);
        filterText.addTextChangedListener(filterTextWatcher);

        ListView listContent = getListView();

        db = new DBHelper(this);
        db.createDataBase();
        db.openDataBase();

        c = db.getCursor();         

        adapter = new RecipeAdapter(c);

        listContent.setAdapter(adapter);

        adapter.setFilterQueryProvider(new FilterQueryProvider() {
            public Cursor runQuery(CharSequence constraint) {
                // Search for states whose names begin with the specified letters.
                c = db.getFilterCursor(constraint);
                return c;
            }
        });

        startManagingCursor(c);

    } catch (IOException e) {
        e.printStackTrace();
    }
}

@Override
protected void onDestroy() {
    super.onDestroy();
    filterText.removeTextChangedListener(filterTextWatcher);
    db.close();
}

@SuppressWarnings("deprecation")
@Override
protected void onResume() {
    super.onResume();

    Cursor cursor = db.getCursor(); 
    adapter.changeCursor(cursor);

}

@Override
protected void onPause() {
    super.onPause();

    adapter.notifyDataSetInvalidated();
    adapter.changeCursor(null);

}

    private TextWatcher filterTextWatcher = new TextWatcher() {

    public void afterTextChanged(Editable s) {
    }

    public void beforeTextChanged(CharSequence s, int start, int count,
            int after) {
    }

    public void onTextChanged(CharSequence s, int start, int before,
            int count) {

        adapter.getFilter().filter(s);

    }

}; 
```

`RecipeAdapter`内部阶级

```
class RecipeAdapter extends CursorAdapter {

    @SuppressWarnings("deprecation")
    public RecipeAdapter(Cursor c) {
        super(RecipeActivity.this, c);
    }

    public void bindView(View row, Context arg1, Cursor arg2) {
        RecipeHolder holder = (RecipeHolder) row.getTag();
        holder.populateFrom(c, db);

    }

    public View newView(Context arg0, Cursor arg1, ViewGroup arg2) {
        LayoutInflater inflater = getLayoutInflater();
        View row = inflater.inflate(R.layout.reciperow, arg2, false);
        RecipeHolder holder = new RecipeHolder(row);
        row.setTag(holder);

        return (row);
    }

static class RecipeHolder {
    public TextView id = null;
    private TextView name = null;
    private TextView desc = null;
    private TextView preptime = null;
    private TextView cooktime = null;
    private TextView serves = null;
    private TextView calories = null;
    private TextView fat = null;
    private TextView fav = null;

    RecipeHolder(View row) {
        id = (TextView) row.findViewById(R.id.id);
        name = (TextView) row.findViewById(R.id.recipe);
        desc = (TextView) row.findViewById(R.id.desc);
        preptime = (TextView) row.findViewById(R.id.preptime);
        cooktime = (TextView) row.findViewById(R.id.cooktime);
        serves = (TextView) row.findViewById(R.id.serving);
        calories = (TextView) row.findViewById(R.id.calories);
        fat = (TextView) row.findViewById(R.id.fat);
        fav = (TextView) row.findViewById(R.id.fav);
    }

    void populateFrom(Cursor c, DBHelper r) {
        id.setText(r.getId(c));
        name.setText(r.getRecipe(c));
        name.setTextColor(Color.parseColor("#CCf27c22"));
        desc.setText(r.getDesc(c));
        preptime.setText(r.getPrepTime(c) + ". ");
        cooktime.setText(r.getCookTime(c) + " mins");
        serves.setText(r.getServes(c));
        calories.setText(r.getCalories(c));
        fat.setText(r.getFat(c));
        fav.setText(r.getFav(c)); 
```

`DBHelper class`

```
public Cursor getCursor() {
    SQLiteQueryBuilder queryBuilder = new SQLiteQueryBuilder();
    queryBuilder.setTables(DATABASE_TABLE);

    String[] columns = new String[] { KEY_ROWID, RECIPE, DESC, PREPTIME,
            COOKTIME, SERVES, CALORIES, FAT, CATEGORY, FAV };

    Cursor myCursor = queryBuilder.query(myDataBase, columns, null, null,
            null, null, RECIPE + " ASC");

    return myCursor;
}

public Cursor getFilterCursor(CharSequence constraint) {
    SQLiteQueryBuilder queryBuilder = new SQLiteQueryBuilder();
    queryBuilder.setTables(DATABASE_TABLE);

    String[] columns = new String[] { KEY_ROWID, RECIPE, DESC, PREPTIME,
            COOKTIME, SERVES, CALORIES, FAT, CATEGORY, FAV };

    if (constraint == null || constraint.length() == 0) {
        // Return the full list
        return queryBuilder.query(myDataBase, columns, null, null, null,
                null, RECIPE + " ASC");
    } else {
        String value = "%" + constraint.toString() + "%";

        return myDataBase.query(DATABASE_TABLE, columns, "RECIPE like ? ",
                new String[] { value }, null, null, null);
    }
}

public String getId(Cursor c) {
               c.moveToFirst();
    return (c.getString(0));
}

public String getRecipe(Cursor c) {
    return (c.getString(1));
}

public String getDesc(Cursor c) {
    return (c.getString(2));
}

public String getPrepTime(Cursor c) {
    return (c.getString(3));
}

public String getCookTime(Cursor c) {
    return (c.getString(4));
}

public String getServes(Cursor c) {
    return (c.getString(5));
}

public String getCalories(Cursor c) {
    return (c.getString(6));
}

public String getFat(Cursor c) {
    return (c.getString(7));
}

public String getCategory(Cursor c) {
    return (c.getString(8));
}

public String getFav(Cursor c) {
    return (c.getString(9));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:08:03.800

```
@SuppressWarnings("deprecation") 
```

坏的。你应该摆脱弃用而不是隐藏它:)

```
startManagingCursor(c); 
```

不要那样做。这可能导致对已关闭游标的重新查询。只需删除该行。

```
 adapter.setFilterQueryProvider(new FilterQueryProvider() {
        public Cursor runQuery(CharSequence constraint) {
            // Search for states whose names begin with the specified letters.
            c = db.getFilterCursor(constraint);
            return c;
        }
    }); 
```

不要覆盖你的`c`这里。正是`return db.getFilterCursor(constraint);`这应该做的。其他可能产生积极影响的事情

```
@SuppressWarnings("deprecation")
public RecipeAdapter(Cursor c) {
    super(RecipeActivity.this, c);
}

public RecipeAdapter(Cursor c) {
    // no requeries and no observer required if you change the cursor yourself
    super(RecipeActivity.this, c, 0)
} 
```

下一个：

```
adapter.notifyDataSetInvalidated();
adapter.changeCursor(null);

// change to
adapter.changeCursor(null);
adapter.notifyDataSetChanged(); // maybe without this 
```

据我了解，文档`notifyDataSetInvalidated()`意味着数据在之后无效（“一旦调用此适配器不再有效，不应报告进一步的数据集更改。”）并且您需要创建一个新的适配器实例。不过不确定。只是做得`notifyDataSetChanged()`很好。甚至可能会做`adapter.changeCursor()`已经隐式地进行更改通知。

PS：`c.MoveToFirst()`不是必须的。将`CursorAdapter`光标移动到所需位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:20:17.747

您重命名了变量，如此处所示

```
....
Cursor cursor = db.getCursor(); 
adapter.changeCursor(cursor); 
```

正确的？但在那之后你指定你尝试过

```
c.moveToFirst() 
```

所以也许你应该设置

```
c = cursor; 
```

这样你的代码的其余部分就可以工作了吗？

# gnuplot - 使用“线色变量”时是否可以在 gnuplot 中设置“线型”？

> ID：11909367
> 
> 赞同：4
> 
> 时间：2012-08-10T21:15:46.827
> 
> 标签：gnuplot

我有一个制表符分隔的数据文件，其中包含许多（双空行分隔的）数据集，我想为每个数据集绘制一条线。我希望能够设置线型（我指的是实线/虚线/点线）。我希望每条线都是不同的颜色。

我可以使用以下方法绘制所有不同的颜色：

```
plot 'example.dat' using 1:2:(column(-2)) with lines linecolor variable 
```

我可以设置线型，但使用以下方法将它们绘制成相同的颜色：

```
plot 'example.dat' using 1:2:(column(-2)) with lines linetype 5 
```

但是当我组合它们时，线型不是我设置的（在这种情况下我只是得到一条实线）。

```
plot 'example.dat' using 1:2:(column(-2)) with lines \
  linetype 5 linecolor variable 
```

有没有办法做到这一点？

我正在使用 gnuplot 4.6，尝试使用 x11 和 postscript 终端。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T23:53:29.407

这对我来说似乎是一个错误。不幸的是，我不认为有太多的 gnuplot 开发者在 StackOverflow 上闲逛，所以我们可能永远也不会发现。（不过，我鼓励你提交一份错误报告，并让我随时了解可能取得的任何进展）......

如果您真的`column(-2)`用来挑选颜色，问题会变得容易得多，您应该能够使用绘图迭代来做到这一点（只要您知道数据集数量的上限）。

```
NDSET=3 #This will issue a warning if NDSET is too big, but will still work.
plot for [IDX=0:NDSET] 'example.dat' index IDX using 1:2 with lines linetype 5 linecolor IDX+1 
```

索引从 0 开始，对应于`column(-2)`。Linecolor`0`没有定义（我不知道为什么 gnuplot 在这里使用两种不同的约定——我想是因为理论上任何特定线条样式对应的颜色都是终端相关的，所以无论如何它并不重要......）

# ios - 消除 UINavigationBar 上栏左侧和 leftBarButtonItem 之间的空间

> ID：11909375
> 
> 赞同：2
> 
> 时间：2012-08-10T21:16:15.203
> 
> 标签：ios, uinavigationbar

我目前有 UINavigationBar 的 leftBarButton 的按钮图像。有没有办法消除这个按钮和 UINavigationBar 的左边缘之间的空间？我想为 UINavigationBar 的背景制作一个自定义图像，但我希望能够使用在其他屏幕上生成的后退按钮。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-26T16:40:49.250

在 ios7 中，您可以添加一个虚拟 barbuttonitem 来修复左侧空间，您应该首先添加虚拟，最后添加右侧

例如左侧，如果您使用情节提要设置按钮，则应在设置原始项目后或在 viewdidload 中添加此内容。

```
NSMutableArray *buttons = [[NSMutableArray alloc] init];
UIBarButtonItem *spacerItem = [[UIBarButtonItem alloc] init];
[buttons addObject:spacerItem];
for(UIBarButtonItem *item in self.leftBarButtonItems){
    [buttons addObject:item];
}
[self setLeftBarButtonItems:[NSArray arrayWithArray:buttons] animated:NO]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T23:08:31.843

导航栏本身的布局逻辑将要尝试保持左侧的空间。

您可以在设置导航项 (UIBarButtonItem initWithCustomView:) 时尝试指定自定义视图，并传入带有负 x 原点的视图——但我假设导航栏会忽略任何此类原点。（您也可以尝试保留对该视图的引用，并在导航栏完成布局后将其移至左侧）

另一种选择是尝试创建自己的自定义导航栏——可能通过将自定义视图放在导航栏的中心，并将其拉伸以覆盖栏的宽度和高度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T08:31:28.470

试试这个，它对我有用：

```
CGRect frame = self.navigationController.navigationBar.frame;
frame.origin.x = -10;
self.navigationController.navigationBar.frame = frame; 
```

基本上，将导航栏 x 坐标设置为负数，而不是栏项目。

# python - Google App Engine 上的客户端单元测试

> ID：11909377
> 
> 赞同：0
> 
> 时间：2012-08-10T21:16:37.840
> 
> 标签：python, unit-testing, google-app-engine

在 Google App Engine Python SDK 上是否有关于客户端（如在您的开发工作站上，使用测试平台并检查后端功能和呈现的 HTML）单元和集成测试的简单直接的教程？我可以向其他开发人员指出什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T22:54:23.487

[developer.google.com 上的本地单元测试](https://developers.google.com/appengine/docs/python/tools/localunittesting)教程很好。

然后，对于“渲染的 HTML”测试，您可能想要查看 Selenium。IDE 是一个好的开始，但您很快就会想要迁移到 WebDriver。seleniumhq.org 上的[WebDriver 介绍](http://seleniumhq.org/docs/03_webdriver.html)是一个好的开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-05T13:12:32.307

由于我找不到一个好的方法，我构建了一个工具来帮助组装一个环境（App Engine SDK 不是 pip-installable），以便于测试应用程序：

[https://github.com/rbanffy/testable_appengine](https://github.com/rbanffy/testable_appengine)

# jquery - 在jQuery中选择相同div中的隐藏字段值

> ID：11909378
> 
> 赞同：0
> 
> 时间：2012-08-10T21:16:40.197
> 
> 标签：jquery

这应该很简单，不知道为什么我会遇到问题。

我已经尝试过`$this.closest('.image_id').val()`，但我不断得到`undefined`。

这是我正在使用的 jQuery：

```
$('#image_container').on('change', '[name="image-type"]', function() {

    $this = $(this);

    console.log($this.closest('.image_id').val());

}); 
```

的HTML：

```
<div id="image_library"> 
    <div class="row-fluid library-row">

        <div class="span3 library-file-name">
          file name
        </div>

        <div class="span1 library-image-size">
            file size
        </div>

        <div class="span4 library-actions">

            <input type="hidden" class="image_id" name="image_id" value="1303">

            <select name="image-type">
                <option value="none">Not Set</option>
                <option value="thumbnail">Thumbnail</option>
                <option value="feature">Feature</option>
                <option value="gallery">Gallery</option>
            </select>

        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T21:18:49.003

最近搜索父母，但您正在寻找兄弟姐妹。这可以通过以下代码完成：

```
$(this).siblings('.image_id').val() 
```

[http://api.jquery.com/siblings/](http://api.jquery.com/siblings/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:33:27.987

```
​$(document).ready(function(​){
   $('[name="image-type"]').on('change', function() {
       $this = $(this);
       console.log($this.siblings('.image_id').val());
    }); 
});​ 
```

# java - 本机 JNI/JAWT Swing 应用程序在 Java 6 上成功运行，但在 Java 7（64 位 Windows 7 操作系统）上失败

> ID：11909380
> 
> 赞同：2
> 
> 时间：2012-08-10T21:16:51.343
> 
> 标签：java, windows, swing, java-native-interface, jawt

我想我对自己遇到的问题有一个不错的认识，但我想知道是否有人对正在发生的事情有更深入的了解。这可能与[尝试使用 jawt-on-64-bit-windows-7-os 有关](https://stackoverflow.com/questions/11885140/trying-to-use-jawt-on-64-bit-windows-7-os/11907601#11907601)。

我有一个相当简单的 Java GUI 应用程序，我正在尝试将 Windows HWND 安装到它上面，这样我就可以附加一个孩子。基本上，我注意到的是，每当我在本机代码中使用 JAWT 资源时，它都会崩溃。它甚至不一定会在我的代码上崩溃，甚至不必点击 JAWT 代码。在jawt.dll/jawt.lib 中链接似乎就足够了。例如，`sun.java2d.loops.DrawGlyphListLCD.DrawGlyphListLCD(Lsun/java2d/SunGraphics2D;Lsun/java2d/SurfaceData;Lsun/font/GlyphList;)V+0`当我的 Swing GUI 被渲染时，我在 Java 的 fontmanager.dll 中的类中看到了许多崩溃。完整`hs_err_pid9108.log`可用：http: [//pastebin.com/2QS0fDuf](http://pastebin.com/2QS0fDuf)

一些有趣的笔记：

*   如果我将 JRE 切换到 Java 1.6.0_33 而不是 Java 1.7.0_05，则应用程序不再崩溃
*   如果我在本机代码中删除所有对 JAWT 的引用，应用程序将不再崩溃
*   如果我删除所有业务逻辑，只在本机代码中实例化 JAWT，它仍然会崩溃
*   我什至实际上不必在我的代码中进行本机调用。加载链接到`jawt.lib`via的 DLL`System.load(...)`就足够了。我的应用程序在渲染其 GUI（使用 JRE 7）时仍会崩溃。

我已经尽可能地将代码提炼成一个仍然会失败的例子。这是Java类：

**JawtTestApp.h**（本机头文件）

```
 #include <jni.h>

#ifndef _Included_com_stackoverflow_JawtTestApp
#define _Included_com_stackoverflow_JawtTestApp
#ifdef __cplusplus
extern "C" {
#endif

JNIEXPORT void JNICALL Java_com_stackoverflow_JawtTestApp_testJawt(JNIEnv *, jobject, jobject);

#ifdef __cplusplus
}
#endif
#endif 
```

**JawtTestApp.cpp**（本机实现）

```
#include <jawt_md.h>
#include <assert.h>

JNIEXPORT void JNICALL Java_com_stackoverflow_JawtTestApp_testJawt(JNIEnv *env, jobject jawtTestApp, jobject component)
{
    JAWT awt;
    awt.version = JAWT_VERSION_1_4;
    assert(JAWT_GetAWT(env,&awt) != JNI_FALSE);
} 
```

**JawtTestApp.h**（Java 文件）

```
package com.stackoverflow;

import javax.swing.JFrame;
import javax.swing.JLabel;

public class JawtTestApp
{
    private final JFrame frame;

    /*
//AWT ONLY (this works)
private final Frame frame;
public JawtTestApp()
{
    frame = new Frame();
    frame.add(new Label("Please stop crashing!"));
    frame.pack();
    frame.setVisible(true);
}
*/

//SWING ONLY (this crashes)
private final JFrame frame;
public JawtTestApp()
{
    frame = new JFrame();
    frame.add(new JLabel("Please stop crashing!"));
    frame.pack();
    frame.setVisible(true);
}

    public native void testJawt(Object o);

    public static void main(final String args[])
    {
        System.load("C:\\Users\\username\\Documents\\Visual Studio 2005\\Projects\\JawtTestApp\\debug\\JawtTestApp.dll");
        JawtTestApp app = new JawtTestApp();
        app.testJawt(app.frame);

        //NOTE: I don't actually even have to call the native method!  System.load is enough
    }
} 
```

请记住，编译时必须包含 JDK/include 和 JDK/include/win32，链接时必须包含 JDK/lib/jawt.lib。

我仍在进行跨平台、JDK 等的测试，但是基于这些信息，有人有什么想法吗？我缺少一个神奇的编译器标志吗？有Java补丁吗？我在这里没有想法了。

这是我的系统信息：

```
OS: Windows 7 , 64 bit Build 7601 Service Pack 1

CPU:total 4 (2 cores per cpu, 2 threads per core) family 6 model 37 stepping 2, cmov, cx8, fxsr, mmx, sse, sse2, sse3, ssse3, sse4.1, sse4.2, popcnt, ht, tsc, tscinvbit

Memory: 4k page, physical 3985080k(1468212k free), swap 7968308k(4277740k free)

vm_info: Java HotSpot(TM) Client VM (23.1-b03) for windows-x86 JRE (1.7.0_05-b06), built on Jun 27 2012 00:51:27 by "java_re" with unknown MS VC++:1600 
```

=======================================

**更新**

似乎这只是使用 Swing 组件的问题。如果我将上面的示例更改为使用 AWT 组件（将 JFrame 切换为 Frame），应用程序将成功运行。

# javascript - 插入图片的javascript

> ID：11909383
> 
> 赞同：-2
> 
> 时间：2012-08-10T21:17:25.837
> 
> 标签：javascript

我目前正在构建一个用于数字菜单显示的站点。我在获取提示用户更改页面中图片的输入字段时遇到问题。图像将在本地显示上网本上托管，而不是通过站点服务器（图片选择将定期更改）。任何想法都会有很大的帮助，下面是我到目前为止的代码：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Custom Entree</title>
<style type="text/css">
body {
    overflow:hidden;
    }
#apIMG {
    position:absolute;

    top:50px;
    width:1080px;
    height:200px;
    z-index:2;
    text-align:right;
}

#apPDF {
    position:absolute;
    top:350px;
    width:100%;
    height:50%;
    z-index:1;
    text-align:center;
}
#pdfscoop {
    height:1358px;
    width:1050px;

}

#PRC {
    position:absolute;
    height:120px;
    width:100%;
    top:1708px;
    font-family:BrushScriptStd;
    text-align:center;
    }

#price {
    height:120px;
    width:1080px;
    text-align:center;
    font-family:BrushScriptStd;
    font-size:110px;
    color:#090;

    }

</style>

<script type="text/javascript">
var img = document.getElementById('logo').src='';
document.images.item(
</script>

</head>

<body>

<div id="apIMG"><a href="http://www.artisancateringandevents.com/Content_Pages/scoop_webMenu.html" target="_top"><img src="scoopTitle.png" height="130%" width="*" ></image></a></div>

<div id="apPDF">

<embed name="" id="logo" src="custom.pdf#scrollbar=0" type="application/pdf" width="900px" height="900px" scrollbar="0" /><input name="" type="image" width="900" height="900" /></div>
<div id="PRC"><input type="text" id="price" border="0" /><br/>
<input type="text" id="price" border="0" /></div>
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:24:00.470

看来你的问题不是很清楚。要替换图像的源，很简单：

```
var images = ['imageone.jpg','imagetwo.jpg'];    
var img    = document.getElementById('logo');
img.src    = images[0]; 
```

[编辑：]根据您使用 file:// 的最后评论，看起来这就是您所追求的：

```
<script type='text/javascript'>
    function callme() {
        document.getElementById('logo').src = document.getElementById('file').value;
    }
</script>
<img id='logo' src='' />
<input id='file' type='file' onchange='callme()' value='' /> 
```

# objective-c - 什么时候有人想在 GCD 上使用 NSThreads？

> ID：11909384
> 
> 赞同：7
> 
> 时间：2012-08-10T21:17:30.553
> 
> 标签：objective-c, cocoa-touch, cocoa, grand-central-dispatch, nsthread

是否有任何人想要使用原始 NSThreads 而不是 GCD 进行并发？我喜欢 GCD，但我想知道最终是否需要将 NSThreads 用于 Cocoa/Cocoa-Touch。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T21:32:07.613

我使用`pthread`s 来表示控制、良好的性能和便携性。有时，您可能会选择使用它提供`NSThread`的额外`NSObject`接口。

有一些较低级别的接口，您需要将线程与您使用的 API 进行协调（例如实时 I/O 或渲染）。有时您对使用的线程具有灵活性，有时`NSThread`在这种情况下使用起来很方便，因此您可以轻松地通过这些接口使用 CF 或 NS 运行循环。因此，您在线程上设置的运行循环参数可能比线程本身对 API 更感兴趣。在这些情况下，GCD 不一定是替代方案。

但是……大多数开发人员不需要经常降到这些级别。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-11T23:24:06.443

您应该几乎不需要直接在 OS X 或 iOS 上使用 NSThread/pthread API。在其他平台上，可能是的（尽管 GCD 正越来越广泛地移植到 *BSD、Linux 甚至 Windows - 请参阅 Grand Central Dispatch 的 Wikipedia 页面），但在 Apple OS 平台上，您几乎总是会通过允许获得更好的结果系统为你做线程生命周期管理。您可能想自己进行线程管理的唯一情况是在高度实时的场景中，您需要管理线程优先级并通过平衡每个线程手动执行的工作量来直接控制线程延迟。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-10T21:27:07.323

在某些特殊情况下，您必须做一些 GCD 无法完成的奇怪事情。但是你可以用 GCD 做的任何事情你都应该这样做（GCD 和线程不是相互排斥的，如果你需要实际使用一个线程，你不需要改变你已经拥有的任何 GCD 东西）。

但是不确定会是什么情况。也许如果您需要设置一个辅助专用 RunLoop（不确定是否可以使用 GCD 完成，但肯定可以使用线程）。或者可能还有其他一些我目前无法计算的特殊情况。

# visual-studio-2010 - GdiVerticalFont 是用来做什么的？

> ID：11909390
> 
> 赞同：2
> 
> 时间：2012-08-10T21:17:58.100
> 
> 标签：visual-studio-2010, fonts

因此，我进行了搜索，但没有任何结果。

微软对[GdiVerticalFont](http://msdn.microsoft.com/en-us/library/system.drawing.font.gdiverticalfont.aspx)的定义很模糊：

> **如果此 Font 派生自 GDI 垂直字体，则为**true ；**否则，**false**。**

 **嗯。真的吗？所以我想我不应该搞砸它；然而...

在这里，任何人都可以在 Visual Studio 设计器中进行更改。

（仅供参考：我从另一个 SO 问题中截取了这张照片）

![在此处输入图像描述](../Images/5b2a5b9cf38286ad732eb81dc6cf2e79.png)

我只见过它设置为 FALSE。

我尝试将其更改为 true，但什么也没注意到。

这个是来做什么的？**

# ios - 为什么 -drawRect 比为 UITableViews 使用 CALayers/UIViews 更快？

> ID：11909394
> 
> 赞同：4
> 
> 时间：2012-08-10T21:18:11.170
> 
> 标签：ios, uitableview, core-graphics

我已经能听到一千名 iOS 开发者的痛苦内心。

不，我不是菜鸟。

**为什么 -drawRect 对于 UITableView 的性能比拥有多个视图更快？**

我知道合成操作是在 GPU 上进行的。但是合成是一次性的操作；一旦层被提交到内存，它与缓存缓冲区没有什么不同，从 GPU 的角度来看，它被转换进出视图。将此与在 drawRect 中使用 Core Graphics 进行比较，后者在 CPU 上使用未知数量的操作来生成最终被缓存在 CALayers 中的像素。如果它最终都被缓存和展平，有什么区别？

此外，如果您正确处理单元重用，则不需要在每次调用 -cellForRowAtIndexPath 时重新生成视图。事实上，通过 UIView/CALayer 对象缓存状态数据（字体、字体大小、文本颜色、属性等）可能比在 -drawRect 期间不断地重新创建它们更有性能优势。

为什么对drawRect如此狂热？有人可以给我指点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T19:44:34.657

当您谈论优化时，您需要提供**具体**的情况和条件和限制。因为优化都是关于微观管理的。否则，它是没有意义的。

你*更快*的基础是什么？你是怎么测量的？数字是多少？

例如，无操作或非常简单`-drawRect:`可以更快，但这并不意味着它总是如此。

我也不知道 CA 的内部设计。所以这是我的**猜测**。

## 如果是静态内容

您的绘图代码不断被调用，这很奇怪。因为会缓存绘制结果，在您发送消息`CALayer`之前不会再次绘制。`setNeedsDisplay`如果您不更新单元格的内容，则与单个位图图层相同。应该比多个合成层更快，因为它不需要合成成本。如果您只使用少量足以同时存在于池中的单元，则无需更新。随着最近型号的 RAM 变得更大，它更有可能在最近的型号中发生。

## 如果是动态内容

如果它不断更新，则意味着您实际上是在自己更新它们。因此，也许您的图层合成版本也会不断更新。这意味着它正在为每一帧再次合成。它可能会因复杂和庞大而变慢。如果它复杂且大并且有很多重叠区域，它可能会更慢。我猜如果 CA 无法确定可以忽略哪些区域，它会严格绘制所有内容。不像你可以选择画什么或不画什么。

## 如果实际绘图是在 CPU 中完成的

即使您将视图配置为许多层的纯组合，最终也应该绘制每个子层。并且不能保证在 GPU 中绘制它们的内容。例如，我相信`CATextLayer`是在 CPU 中绘制自己。（因为在当前的移动 GPU 上用多边形绘制文本在性能方面没有意义）还有一些过滤效果。在这种情况下，总成本将相似，而且还需要合成成本。

## 在 CPU 和 GPU 负载均衡的情况下

如果您的 GPU 因层数过多或直接 OpenGL 绘图而非常忙于繁重的负载，则您的 CPU 可能处于空闲状态。如果您的 CG 绘图可以在空闲 CPU 时间内完成，那么它可能比给 GPU 提供更多负载要快。

## 他们都不是你的情况？

如果您的情况不是我上面列出的情况，我真的很想看看和检查 CG 代码的绘制速度比 CA 合成的速度快。我希望你附上一些源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T22:09:31.480

好吧，如果从基于 GPU 的渲染器到基于 CPU 的渲染器来回切换，您的程序很容易最终会移动和转换大量像素数据。

同样，许多层会消耗大量内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:21:20.117

我在这里只看到了一半的对话，所以我可能误解了。根据我最近优化 CALayer 渲染的经验，并调查 Apple 确实（不）优化您希望优化的东西的方式......

> 如果它最终都被缓存和展平，有什么区别？

Apple 最终为每层创建了一个单独的 GPU 元素。如果你有很多层，你就有很多 GPU 元素。如果你有一个drawRect，你就只有一个元素。Apple 通常不会将这些扁平化，即使它们可以（并且可能“应该”）。

在许多情况下，“很多元素”不是问题。但是如果它们变得很大......或者它们足够多......或者它们对于 OpenGL 来说是不好的尺寸......并且（见下文）它们被存储在 CPU 中而不是 GPU 上，那么事情就会开始变得令人讨厌. 注意：根据我的经验：

*   “足够”：内存中 40+
*   “大”：100x100 点（200x200 视网膜像素）

Apple 的 GPU 元素/缓冲区代码在大多数地方都得到了很好的优化，但在少数地方它的优化很差。性能下降就像跳崖一样。

> 此外，如果您正确处理单元重用，则不需要在每次调用 -cellForRowAtIndexPath 时重新生成视图

您说“正确”，除了... IIRC Apple 的文档告诉人们不要那样做，他们采用更简单的方法（恕我直言：弱文档），而是在每次通话时重新填充所有子视图。在这一点上......你节省了多少？

最后：

...这一切都不会随着 iOS 6 的改变而改变吗？在 iOS 6 中，创建 UIView 的成本大大降低了？（我还没有分析它，只是从其他开发人员那里听说过）

# python - 如何使python实例对象可重用？

> ID：11909396
> 
> 赞同：0
> 
> 时间：2012-08-10T21:18:19.517
> 
> 标签：python

我的几个 python 程序旨在

1.  格式化成哈希表（因此，我是一个 dict() 瘾君子 ;-) ）“源”文本文件中的一些信息，以及

2.  使用该表来修改“目标”文件。我担心的是，我通常处理的“源”文件可能非常大（几 GB），因此解析时间超过 10 秒，我需要多次运行该程序。总而言之，我觉得每次我需要修改一个新的“目标”时重新加载同一个大文件是一种浪费。

我的想法是，如果有可能编写一次由“源”文件生成的 dict() 以使 python 能够更快地读取/处理（我认为一种格式接近 RAM 中使用的格式）通过python），那会很棒。

有没有可能实现这一目标？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T21:20:45.650

是的，您可以[`marshal`](http://docs.python.org/library/marshal.html)使用 dict，也可以使用[`pickle`](http://docs.python.org/library/pickle.html#module-pickle). 有关两者之间的区别，尤其是速度方面的区别，请参阅[此问题](https://stackoverflow.com/questions/329249/why-is-marshal-so-much-faster-than-pickle)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T22:20:35.900

`pickle`是此类事情的通常解决方案，但是如果您看到能够编辑保存的数据有任何价值，并且如果字典仅使用字符串和数字等简单类型（嵌套字典或列表也可以），您可以简单地编写将字典转换为文本文件，然后使用（或者，更好的是， ）`repr()`将其解析回 Python 字典。`eval()``ast.literal_eval()`

# python - 如何从 HTML 表单上传带有 python-tornado 的图像？

> ID：11909397
> 
> 赞同：17
> 
> 时间：2012-08-10T21:18:18.817
> 
> 标签：python, tornado, image-upload

我看到了使用 pycurl 的示例，但不确定这是否是可行的方法？一些例子会有所帮助。谢谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-11T10:15:43.567

这是实现龙卷风上传的[演示应用程序。](https://github.com/vamsiikrishna/tornado-upload)

这是服务器代码：

```
import tornado.httpserver, tornado.ioloop, tornado.options, tornado.web, os.path, random, string
from tornado.options import define, options

define("port", default=8888, help="run on the given port", type=int)

class Application(tornado.web.Application):
    def __init__(self):
        handlers = [
            (r"/", IndexHandler),
            (r"/upload", UploadHandler)
        ]
        tornado.web.Application.__init__(self, handlers)

class IndexHandler(tornado.web.RequestHandler):
    def get(self):
        self.render("upload_form.html")

class UploadHandler(tornado.web.RequestHandler):
    def post(self):
        file1 = self.request.files['file1'][0]
        original_fname = file1['filename']
        extension = os.path.splitext(original_fname)[1]
        fname = ''.join(random.choice(string.ascii_lowercase + string.digits) for x in range(6))
        final_filename= fname+extension
        output_file = open("uploads/" + final_filename, 'w')
        output_file.write(file1['body'])
        self.finish("file" + final_filename + " is uploaded")

def main():
    http_server = tornado.httpserver.HTTPServer(Application())
    http_server.listen(options.port)
    tornado.ioloop.IOLoop.instance().start()

if __name__ == "__main__":
    main() 
```

唯一的事情，你必须从这段代码中理解，文件内容位于`self.request.files[<file_input_name>][0]`.

这是html代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head> 
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> 
<title>Tornado Upload Application</title>
</head>
<body>
<p><h1>Tornado Upload App</h1></p>
<form enctype="multipart/form-data" action="/upload" method="post">
File: <input type="file" name="file1" />
<br />
<br />
<input type="submit" value="upload" />
</form> 
```

处理文件时 - 请确保该表单具有`enctype="multipart/form-data"`.

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-08-11T04:44:51.743

这很简单：

```
<form action="/file" methods="POST"><!--your code--></form> 
```

在 Python 中：

```
class FileHandler(tornado.web.RequestHandler):
    # get post data
    file_body = self.request.files['filefieldname'][0]['body']
    img = Image.open(io.StringIO(file_body))
    img.save("../img/", img.format) 
```

但不推荐，因为所有上传的数据都加载在 RAM 中；最好的方法是使用 nginx 加载模块，但这很复杂。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-05-12T21:58:25.770

以前的代码返回错误的文件名和错误的编码。以下代码有效：

```
import tornado.httpserver, tornado.ioloop, tornado.options, tornado.web, os.path, random, string

class Application(tornado.web.Application):
    def __init__(self):
        handlers = [
            (r"/", IndexHandler),
            (r"/upload", UploadHandler)
        ]
        tornado.web.Application.__init__(self, handlers)

class IndexHandler(tornado.web.RequestHandler):
    def get(self):
        self.render("tornadoUpload.html")

class UploadHandler(tornado.web.RequestHandler):
    def post(self):
        file1 = self.request.files['file1'][0]
        original_fname = file1['filename']

        output_file = open("uploads/" + original_fname, 'wb')
        output_file.write(file1['body'])

        self.finish("file " + original_fname + " is uploaded")

settings = {
'template_path': 'templates',
'static_path': 'static',
"xsrf_cookies": False

}
application = tornado.web.Application([
   (r"/", IndexHandler),
            (r"/upload", UploadHandler)

], debug=True,**settings)

print "Server started."
if __name__ == "__main__":
    application.listen(8888)
    tornado.ioloop.IOLoop.instance().start() 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-01-17T14:28:49.737

使用 [''] 语法访问文件属性时遇到了麻烦，不知道为什么，但我切换到点语法并能够读取数据。我在 Windows 机器上，所以我还必须将 'open("static/public/" + file_name, 'w')' 更改为 'open("static/public/" + file_name, 'wb')'。如果没有“wb”，文件就会损坏。

```
def uploadFile(self,input_name,file_type):
            a_file = self.request.files[input_name][0]
            extension = os.path.splitext(a_file.filename)[1]

            if file_type is 'photo':
                type_list = ['.png','.jpg','.jpeg','.gif']
            elif file_type is 'attachment':
                type_list = ['.pdf','.doc','.docx','.xls']

            if extension in type_list:
                file_name = ''.join(random.choice(string.ascii_lowercase + string.digits) for x in range(16))
                output_file = open("static/public/" + file_name + extension, 'wb')
                output_file.write(a_file.body)
                return (a_file.filename + " has been uploaded.") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-03T08:18:12.607

`tornado.web.RequestHandler`有`self.request.files`方法。结果就像

```
{u'file': [{'body':FILEBODY, 'content_type':CONTENT_TYPE, 'filename': FILENAME}],...} 
```

# c++ - 在 C++ 中解密 AES-196-ECB 文件，尝试加密文件，但解密时无法恢复文件

> ID：11909406
> 
> 赞同：0
> 
> 时间：2012-08-10T21:18:51.623
> 
> 标签：c++, visual-c++, cryptography, aes, encryption

这是我的代码：

```
/* DECRYPTION */
int i;
aes_decrypt_ctx ctx[1];
//aes_encrypt_ctx ctx[1];
unsigned char iv[16];
unsigned char inBuffer[200], outBuffer[200];
FILE *inFile1=fopen("C:/sth.txt.aes", "rb"); /* used to read IV ONLY */
FILE *inFile2=fopen("C:/sth.txt.aes", "rb"); /* used to read the whole file, included IV */
FILE *outFile=fopen("C:/sth.txt", "wb");
if (inFile1 != NULL) {
  lbl_status->Text+="\r\nFinding IV(first 16 byte) of the file...";
  /* read initialization vector from file */
  if(fread(iv, 1, 16, inFile1) >= 16) {
    lbl_status->Text+="\r\nFound IV(first 16 byte) in the file...";
    fclose(inFile1);
    aes_decrypt_key192((unsigned char*)MStringToCCS(decryptsecret), ctx);

    // Start decrypting
    lbl_status->Text+="\r\nStart decrypting...";
    while((i=fread(inBuffer, 1, sizeof(inBuffer), inFile2)) > 0) {
      aes_ecb_decrypt(inBuffer, outBuffer, i, ctx);
      fwrite(outBuffer, 1, i, outFile);
    }
    fclose(inFile2);
    fclose(outFile);
  }else{
    /* error: file doesn't even contain an initialisation vector */
    lbl_status->Text+="\r\nError: IV(first 16 byte) not found.";
    MessageBox::Show("Could not find the IV.", "Error", MessageBoxButtons::OK, MessageBoxIcon::Error);
    fclose(inFile1);
    fclose(inFile2);
    fclose(outFile);
  }
 }else{
  lbl_status->Text+="\r\nError: Could not open the file.";
  MessageBox::Show("Error for opening the file.", "Error", MessageBoxButtons::OK, MessageBoxIcon::Error);
  fclose(inFile1);
  fclose(inFile2);
  fclose(outFile);
 } 
```

首先，我使用 openssl 创建了一个 AES 加密文件： `openssl enc -e -aes-192-ecb -in C:/sth.txt -out C:/sth.txt.aes` 我尝试了我的程序，但输出与原始文件不同。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:29:09.437

我建议您使用可移植库（例如[Crypto++](http://cryptopp.com/)或[Botan](http://botan.randombit.net/)）在 C++ 中进行加密。这些图书馆备受推崇，并拥有良好的社区支持。

# ajax - Django AJAX 导航

> ID：11909418
> 
> 赞同：0
> 
> 时间：2012-08-10T21:20:02.840
> 
> 标签：ajax, django, view, navigation, django-templates

作为一项测试，我决定看看我是否可以让 hashchange 导航技巧想想与我的 django 应用程序一起工作......

到目前为止，我在哈希更改触发的阶段拥有它，只需要加载数据，这就是我遇到问题的地方。

现在，我是 django 和 django/ajax 的新手，我不知道从哪里开始，做了几个 google 并没有运气。简而言之，我需要一种使用扩展语法在没有模板的情况下加载页面的方法。我是否能够将附加值解析到 url 并将其从模板中排除？我不确定

请给一些代码指导什么的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:32:53.660

您的模板创建发送到浏览器的 html，一旦它到达客户端，您的模板就无法在该页面上进行更改，需要重新加载该页面以使模板进行任何更改。因此，当哈希更改被触发时，您的选择是将您想要加载的信息作为页面的一部分但被隐藏，这意味着您必须知道页面加载时用户需要的一切，或者使用 AJAX。使用 AJAX，当用户通过使用 Javascript 发出 XMLHttpRequest 向我们提供新信息时，我们可以在不重新加载页面的情况下进行更改，它不必返回 XML，它可以是 JSON 甚至只是单个文本字符串。因此，当您的哈希更改触发时，您将向站点发送请求，通常是 GET 或 POST，站点上的脚本将处理从客户端发送的信息并做出相应的响应。这是一个在更改触发函数中的示例

```
data = "somedata";
request = new XMLHttpRequest(); //create the request object
request.open("POST", "app/handler", false); // set its parameters
request.send("data="+data); // send it to the server
response = request.responseText; // get the response
responseHandler(response) // do something with the data the server sent back 
```

在服务器端，这可能是应用程序的唯一目的。所有格式都可以使用网站的基本模板、javascript 和 css 完成。只需在每次响应后加载新信息。有一些适用于 Django 的 AJAX 库，请查看[wiki 页面](https://code.djangoproject.com/wiki/AJAX)或查看 django.core.serialization，它可以让您将应用程序模型返回为 json、xml 或 yaml。

```
from django.core import serializers 
def my_json_view(request):
    data = serializers.serialize("json", MyModel.objects.all()[:5])
    return HttpResponse(data, mimetype="application/javascript") 
```

# java - 在 Java 中覆盖用户库类

> ID：11909419
> 
> 赞同：1
> 
> 时间：2012-08-10T21:20:11.890
> 
> 标签：java, class, overriding, libraries, bluej

我用 BlueJ for Mac 编写 java 代码。我添加了 stdlib.jar 库（来自princeton [http://introcs.cs.princeton.edu/java/stdlib/](http://introcs.cs.princeton.edu/java/stdlib/)）。在添加这个库之前，我有自己的名为 StdDraw.java 的类（我在项目中使用的特定类）并复制/粘贴了代码。我还调整了一些代码并添加了一些新行。由于我无法编辑库代码，我如何覆盖或扩展库类以添加额外的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-23T15:51:18.860

由于库类是`final`，因此您无法扩展它们。另一种选择是将它们包装在您自己的类中。例如，您可以创建自己的绘图类，该类具有`StdDraw`它委托给的实例。对于您的许多方法，您可以简单地调用`StdDraw`实例的相应方法，或者您可以通过自己实现方法来模拟覆盖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:59:51.340

只需简单地扩展类，

```
public MyClass extends ClassFromLib 
```

确保库 jar 文件位于类路径中。如果该类的作者将其声明为 final，则表明它不适合子类化。那么最好的选择是使用委托模式。

我在这个编辑器中编写了下面的代码，所以没有承诺它会遵守，但希望你能明白。

```
public Myclass {
    private ClassFromLib cfl = new ClassFromLib();

    public void methodA(){
        //Do whatever you need here
        cfl.methodA();  //Doesn't have to be the same name. 
        //Do whatever you need here
    }
} 
```

# scala - 速记算术运算符在 Scala 中返回不同的结果 - EG: 3 + 2 != 3.+(2)

> ID：11909421
> 
> 赞同：0
> 
> 时间：2012-08-10T21:20:15.100
> 
> 标签：scala, operators, arithmetic-expressions

> **可能的重复：**
> [Scala 运算符怪异](https://stackoverflow.com/questions/9655080/scala-operator-oddity)

我对 Scala 很陌生，我读到在这种语言中，一切都是对象，很酷。此外，如果一个方法只有 1 个参数，那么我们可以省略 '.' 和双亲'（）'，没关系。

因此，如果我们采用以下 Scala 示例：`3 + 2`'3' 和 '2' 是两个`Int`Objects 并且 '+' 是一个方法，听起来不错。然后`3 + 2`只是 的简写`3.+(2)`，这看起来很奇怪，但我还是明白了。

现在让我们比较以下代码块`REPL`：

```
scala> 3 + 2
res0: Int = 5

scala> 3.+(2)
res1: Double = 5.0 
```

这里发生了什么？为什么显式语法返回 a`Double`而简写返回一个`Int`??

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-10T21:22:59.657

`3.`是一个`Double`。词法分析器首先到达那里。试试`(3).+(2)`。

# javascript - js调用函数存储在二维数组中

> ID：11909424
> 
> 赞同：0
> 
> 时间：2012-08-10T21:20:32.093
> 
> 标签：javascript, multidimensional-array

我有一个数组：

```
var markerArray = [];//global var
var markerCnt = 0;//global var
for(var x=0;x<10;x++){
    markerArray[markerCnt] = new Array(agency, address, marker, onMarkerClick);
    //agency and agency = string
    //marker = google maps marker
    //onMarkerClick = function
    markerCnt++;
} 
```

如何调用指定的 onMarkerClick 函数？我会这样做：

```
markerArray[0][3](); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:44:41.670

作为替代解决方案，您还可以这样做：

```
var markerArray = [];
var markerCnt = 0;

for(var x=0;x<10;x++){
    markerArray[markerCnt] = {
        'agency' : agency, 
        'address' : address, 
        'marker' : marker, 
        'click' : onMarkerClick
    };
    markerCnt++;
}

//To call the click
markerArray[0].click(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:44:16.460

你的问题的答案是*肯定*的。

无论有多少维，您都可以执行存储在数组中的任何函数。

```
// perfectly valid
markerArray[0][3]()

// as is this
someArray[0][1][7][2]() 
```

除了回答您的问题之外，我建议您使用一个对象数组，这样您就不必执行数组成员。如果您在 6 个月内查看它试图弄清楚您做了什么，这将增加您的代码的可读性并为您节省几个小时。

```
var markerArray = [];//global var
var markerCnt = 0;//global var
for(var x=0;x<10;x++){
    markerArray[markerCnt] = {
        agency: agency
        address: address
        marker: marker
        onMarkerClick: onMarkerClick
    };
    //agency and agency = string
    //marker = google maps marker
    //onMarkerClick = function
    markerCnt++;
}

// then reference your function
markerArray[0].onMarkerClick(); 
```

# javascript - Jquery 验证表单

> ID：11909435
> 
> 赞同：4
> 
> 时间：2012-08-10T21:21:02.713
> 
> 标签：javascript, jquery

我正在尝试在提交时验证我的表单，如果输入全部填写，他们将提交给 register.php

我的问题是它只有在所有输入都是空白的情况下才有效 - 否则它会出错 - 我只是想在提交之前检查这些字段中的任何一个是否为空白

```
function submitform() {
    if ($('#name, #email, #user, #address, #phone').val().length === 0) {
        $(this).addClass('warning');
    } else {
        alert("form submitted");
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T21:28:15.403

你不能在数组上做一个 .val 。它应该是

```
function submitform(){
   var warning = false;
   $('#name, #email, #user, #address, #phone').each(function() {
      $(this).val().length === 0){
         warning = true;
         return;
      }
   });
   if(warning) {
      $(this).addClass('warning');
   } else {
      alert("form submitted");
   }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T21:26:25.363

您需要使用`each`jquery 中的函数或`for`循环检查它们中的每一个。

```
$('#name, #email, #user, #address, #phone').each(function(){
    if ($(this).val().length === 0){
        $(this).addClass('warning');
    } else {
     alert("form submitted");
   }
}); 
```

这是与 for 相同的示例

```
var formElements = $('#name, #foo');

for (i = 0 ; i < formElements.length ; i++)
{
    if ( $(formElements[i]).val().length === 0 )
       $(this).addClass('warning');
    else {
       alert("form submitted");
    }
} 
```

​</p>

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-30T06:17:14.630

```
function formSubmit() {
    var pass = true;
    jQuery.each( jQuery('#form :input'), function( key, value ) {
       if(!this.value && jQuery(this).attr('class :contains("required")')) {
         if (jQuery(this).siblings('.error').length === 0 && jQuery(this).type != 'submit') {
            jQuery(this).after('<label class="error"><span class="form-required">*</span> Required</label>');
         }
         pass = false;
       } else {
        jQuery(this).siblings('.error').remove();
      }
    });
    if (pass === true) {
        document.getElementById('form').submit();
    }
} 
```

# c# - 在 C# 抽象中设置构造函数

> ID：11909441
> 
> 赞同：0
> 
> 时间：2012-08-10T21:21:33.760
> 
> 标签：c#, constructor, abstract-class, scope

考虑以下**非常基本**的C# 代码。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            Random random = new Random();

            for (int i = 1; i <= 100; i++)
            {
                int num = random.Next(1000);
                string it_type;

                if (num == 666)
                {
                    System.Console.Write("Antichrist/satanistic trips get. Enjoy! ");
                    JonSkeet technician = new JonSkeet(); // Needs more Super::$tatic
                    technician.setup();
                    it_type = technician.getITType();
                }
                else
                {
                    Whisperity technician = new Whisperity();
                    technician.setup();
                    it_type = technician.getITType();
                }

                System.Console.WriteLine(it_type + "... Prepare for next iteration.");
            }

            System.Console.ReadLine();
        }
    }

    abstract public class ITTechnician
    {
        protected string itt_type = "Noname person.";
        protected bool isJonSkeet = false;

        public string getITType()
        {
            return this.itt_type;
        }

        abstract public void setup();
    }

    public class JonSkeet : ITTechnician
    {
        public override void setup()
        {
            this.itt_type = "Jon Skeet";
            this.isJonSkeet = true;
        }
    }

    public class Whisperity : ITTechnician
    {
        public override void setup()
        {
            this.itt_type = "Whisperity";
            this.isJonSkeet = false;
        }
    }
} 
```

我如何能够以抽象类（`abstract public void`？）需要它并且我不必调用`technician.setup();`的方式设置构造函数，因为构造函数负责设置两个内部变量。如果我调用与类本身同名的类函数，则会收到以下错误：

> 错误 1 ​​'Whisperity'：成员名称不能与其封闭相同

另外，我的另一个问题是关于优化。有没有办法`technician`在构造之外定义，`if`所以可以执行以下内容：（这将省略`classType technician = new classType();`两次行，或者它在 C# 中是不可绕过的？）

```
string it_type;
// Register 'technician' as a variable here.
if (num = 666)
{
    technician = new JonSkeet();
}
else
{
    technician = new Whisperity();
}

it_type = technician.getITType();
System.Console.WriteLine(it_type + "..."); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:25:13.123

**回答你的问题**

您可以在抽象类中为构造函数提供参数。

```
abstract public class ITTechnician
{
    public ITTechnician(string itt_type, bool isJonSkeet)
    {
        this.itt_type = itt_type;
        this.isJonSkeet = isJonSkeet;
    }
} 
```

构建一个 JonSkeet（要是这么简单就好了！）

```
JonSkeet jon = new JonSkeet("Jon Skeet", true); 
```

**关于类设计的建议**

在旁注中，我知道这是一个示例问题，但是如果基类包含可以区分从它继承的类的信息，那么您就没有很好地使用面向对象。

具体来说，这种设计会引导你做类似的事情

```
ITTechnician itt = GetSomeInstance();

if (itt.IsJonSkeet)
{
    BehaviorA();
else
{
    BehaviorB();
} 
```

做类似的事情要干净得多

```
abstract public class ITTechnician
{
    public abstract void Behavior();
    // ...
}

public class JonSkeet
{
    public override Behavior()
    {
        // Do awesome things
    }
} 
```

这允许上面的代码写成

```
ITTechnician itt = GetSomeInstance();
itt.Behavior(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:29:47.103

> 我如何能够以抽象类需要它并且我不必调用technical.setup() 的方式设置构造函数

您不需要构建逻辑来强制`abstract`类的行为，反之亦然。`Abstract`类定义了一个孩子必须遵循的东西。

如果您在类中创建一个简单的无参数ctor *，*`abstract`它会初始化您需要的变量，那么无论何时`child`构造对象，都会在之前调用默认的ctor `abstract`，因此将执行初始化。

为了更清楚：

```
public class Child : Base 
{

    public Child(int x){
     "Child".Dump();
    }
}

public abstract class Base
{

    public Base() {

        //INIT VARIABLES HERE
       "Base".Dump();
    }
} 
```

使用这些结构，如

`vaar ch = new Child();`产生结果

```
"Base"
"Child" 
```

如果这不是您要的，请澄清。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T22:29:28.217

要在运行时发现类型，请使用`GetType()`. 无需创建自己的类型字符串字段。

除了类结构中的内在类型之外，唯一不同的是`IsJonSkeet`. 我们可以使用 .NET 属性来实现这一点，与带有 Getter 和 Setter 的传统私有/受保护字段相比，这是一种更现代和更具表现力的方式。

```
abstract public class ITTechnician
{
    public bool IsJonSkeet { get; protected set; }
    protected ITTechnician()
    {
        this.IsJonSkeet = false;
    }
}

public class JonSkeet : ITTechnician
{
    public JonSkeet()
    {
        this.IsJonSkeet = true;
    }
}

public class Whisperity : ITTechnician
{
} 
```

现在您的 itt_type 字符串字段已被删除，Whisperity 与基类相同，因此无需构造函数进行任何初始化 - 它会自动获取其父级的 IsJonSkeet 值。

也为 Eric J 的课程设计技巧 +1。您应该使用层次结构的设计来封装变化的内容，这使您的调用代码更加透明，并且代码库将来更容易扩展。

# python - Python 套件测试不运行测试

> ID：11909442
> 
> 赞同：1
> 
> 时间：2012-08-10T21:21:48.993
> 
> 标签：python, unit-testing

我正在尝试编写套件测试，我有一个模块可以正确运行单元测试，但我打算添加更多模块并立即测试它们，所以我编写了以下代码：

```
#main.py

import unittest
from test.Services import TestOS

if __name__ == '__main__':
    suite = unittest.TestSuite()
    suite.addTests( TestOS.TestOS() )
    unittest.TextTestRunner().run(suite) 
```

测试操作系统.py

```
import unittest
from app.Services.OS import OS

class TestOS(unittest.TestCase):
    os = OS()
    def setUp(self):
        pass
    def tearDown(self):
        pass
    def testOSName(self):
        self.assertEquals(self.os.getPlatform(), 'Windows')    
    def testOSVersion(self):
        self.assertEquals(self.os.getVersion(), '7')

if __name__ == "__main__":
    #import sys;sys.argv = ['', 'Test.testName']
    unittest.main() 
```

运行后，我得到以下输出：

```
Finding files... done.
Importing test modules ... done.

----------------------------------------------------------------------
Ran 0 tests in 0.000s

OK 
```

它没有找到任何测试，我的代码有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T22:00:02.023

`suite.addTest( TestOS.TestOS() )`仅当您的测试用例包含 runTest() 函数时才有效。否则你需要一个“TestLoader”来检测以“test*”开头的TestOS的功能。

```
#main.py

import unittest
from test.Services import TestOS

if __name__ == '__main__':
    suite = unittest.TestSuite()
    tests = unittest.defaultTestLoader.loadTestsFromTestCase(TestOS)
    suite.addTests(tests)
    unittest.TextTestRunner().run(suite) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T05:04:50.627

修改你的setUp方法如下

```
def setUp(self):
    self.os = OS()
    pass 
```

# cocoa - 依赖键是如何注册的？（键值观察）

> ID：11909443
> 
> 赞同：1
> 
> 时间：2012-08-10T21:21:50.007
> 
> 标签：cocoa, cocoa-bindings, key-value-observing

我创建了一个简单的 Cocoa 应用程序。在 MainMenu.xib 我添加了一个 NSDatePicker 和一个 NSTextField。这两个对象都有到 App Delegate 属性的值绑定。我希望当用户更改 NSDatePicker 中的日期时，将更新 NSTextField。这不会发生。这是应用程序代表：

```
//  AppDelegate.h
#import <Cocoa/Cocoa.h>

@interface AppDelegate : NSObject <NSApplicationDelegate>

@property (assign) IBOutlet NSWindow *window;
@property (nonatomic, strong) NSDate *dateFromPicker;
@property (nonatomic, readonly) NSString *dateString;

@end

//  AppDelegate.m
#import "AppDelegate.h"

@implementation AppDelegate

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{

}

- (NSString *)dateString
{
    NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
    return [formatter stringFromDate:self.dateFromPicker];
}

+ (NSSet *)keyPathsForValuesAffectingDateString
{
    return [NSSet setWithObject:@"dateFromPicker"];
}

@end 
```

使用 dateFromPicker 和一些 NSLog 语句的观察者更新代码：

```
@implementation AppDelegate

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    [self addObserver:self forKeyPath:@"dateFromPicker" options:0 context:NULL];
    self.dateFromPicker = [NSDate dateWithNaturalLanguageString:@"12/12/12"];
}

- (NSString *)dateString
{
    NSLog(@"dateString was called.");
    NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
    return [formatter stringFromDate:self.dateFromPicker];
}

+ (NSSet *)keyPathsForValuesAffectingDateString
{
    NSLog(@"keyPathsForValuesAffectingDateString was called.");
    return [NSSet setWithObject:@"dateFromPicker"];
}

- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:         (NSDictionary *)change context:(void *)context
{
    NSLog(@"dateFromPicker changed.");
}

@end 
```

这是日志：

```
2012-08-10 15:37:15.086 ... keyPathsForValuesAffectingDateString was called.
2012-08-10 15:37:15.087 ... dateString was called.
2012-08-10 15:37:15.116 ... dateFromPicker changed.
2012-08-10 15:37:15.117 ... dateString was called.
2012-08-10 15:37:19.831 ... dateFromPicker changed.
2012-08-10 15:37:19.831 ... dateString was called. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:38:44.530

我知道这不是您要问的，但是...

为什么不将 NSTextField 绑定到 NSDate 属性并在 Interface Builder 中为其添加格式化程序？

# twitter-bootstrap - Twitter Bootstrap设置输入文本流体大小不起作用

> ID：11909446
> 
> 赞同：1
> 
> 时间：2012-08-10T21:22:18.517
> 
> 标签：twitter-bootstrap, fluid-layout

这是我网站的正文：（使用 twitter bootstrap 2.0）

```
<div class="container">
  <div class="row-fluid" style="text-align: center">
    <div class="span12">
      <div class="page-header">
        <h1>Header</h1>
      </div>
      <form class="well form-search">
        <input type="text" class="span7 input-large search-query" />
        <button type="submit" class="span3 btn btn-primary" >Search</button>
      </form>
    </div>
  </div>
</div> 
```

我希望文本和提交按钮居中并以 7:3 流畅，但是当我将跨度类设置为它们时，它们会换行，第一行的文本和另一行的输入提交。为了使它们位于同一水平线上，我可以/应该做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T07:53:16.667

**更新** [版本 2.1.0](https://github.com/twitter/bootstrap/tree/v2.1.0)已经发布，因此您应该检查下面的偏移解决方案，因为它在此版本中默认提供（可能还有未来的版本）

* * *

似乎引导程序不会使输入跨度浮动：[github forms.less](https://github.com/twitter/bootstrap/blob/v2.0.4/less/forms.less#L245)

所以这是你可以使用的：

```
.form-span input[type="text"][class*="span"] { float: left; } 
```

### 编辑

对于流动性，您需要使用 a`.container-fluid`因为`.container`具有固定的大小（这使得固定内部的流体网格）。

对于居中，我看到 2 个解决方案：

使用内联文本居中：（绝对不是最佳选择）

```
.inline-center { text-align: center!important; }
.inline-center [class*="span"] { float: none!important; display: inline-block!important; } 
```

或者你可以使用流体`.offsetX`类，它[很快就会](https://twitter.com/twbootstrap/status/232936019366916096)在[2.1 版](https://github.com/twitter/bootstrap/blob/e2336ef02ab620277e2d81f3fc6b4ff69e027ae4/docs/assets/css/bootstrap.css#L392)或[这个 gist中可用](https://gist.github.com/3230479)

```
<input type="text" class="offset1 span7 input-large search-query" />
<button type="submit" class="span3 btn btn-primary" >Search</button> 
```

[演示（jsfiddle）](http://jsfiddle.net/Sherbrow/NEmXL/4/)

# json - 我可以将来自另一个 Salesforce 组织的反序列化 JSON SObject 插入我的组织吗？

> ID：11909447
> 
> 赞同：1
> 
> 时间：2012-08-10T21:22:18.220
> 
> 标签：json, salesforce

我们需要将复杂的数据结构从一个组织克隆到另一个组织。这包含一系列自定义 SObject，包括父母和孩子。

流程如下。在 origin org 上，我们只是 JSON.serialize 我们想要发送的 SObject 列表。然后，在目标组织上，我们可以 JSON.deserialize 该对象列表。到目前为止，一切都很好。

问题是我们无法直接插入这些 SObject，因为它们包含原始组织的 ID，而 Salesforce 不允许我们插入已经有 Id 的对象。

我们找到的解决方案是手动插入对象层次结构，维护 originId > targetId 的映射并手动修复关系。但是，我们想知道 Salesforce 是否提供了一种更简单的方法来做这样的事情，或者有人知道更好的方法来做这件事。

Salesforce 中是否有嵌入式方式来执行此操作？还是我们陷入了繁琐的手动过程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T09:21:45.420

`List.deepClone()`使用*preserveIds* = false 调用可能会解决一个问题，然后：

考虑使用 upsert 操作为您建立关系。Upsert 不仅可以防止重复，还可以[保持层次结构](http://www.salesforce.com/us/developer/docs/api/Content/sforce_api_calls_upsert.htm)。您需要在父级上使用外部 Id 字段，而不是在子级上。

```
/* Prerequisites to run this example succesfully:
    - having a field Account_Number__c that will be marked as ext. id (you can't mark the standard one sadly)
    - having an account in the DB with such value (but the point of the example is to NOT query for it's Id)
*/
Account parent = new Account(Account_Number__c = 'A364325'); 
Contact c = new Contact(LastName = 'Test', Account = parent);
upsert c;

System.debug(c);
System.debug([SELECT AccountId, Account.Account_Number__c FROM Contact WHERE Id = :c.Id]); 
```

如果您不确定它是否适合您 - 使用 Data Loader 的 upsert 功能，可能有助于理解。

如果您在同一个 sObject 类型上有超过 2 个级别的层次结构，我认为您仍然必须以正确的顺序更新它们（或使用`Database.upsert`版本并继续为失败的版本重新运行它）。

# python - 使用可变查询文本进行 Python WMI 查询

> ID：11909448
> 
> 赞同：1
> 
> 时间：2012-08-10T21:22:25.040
> 
> 标签：python, wmi

我是 Python 新手（和一般的编码），我正在通过 WMI 模块工作。我正在寻找的是一种查询 WMI 以查找过滤日期的事件日志错误的方法。

例如，如果我执行以下操作，它会起作用：

```
events = userwmi.query("Select * from Win32_NTLogEvent where Type='error' AND TimeWritten='20120806000000.000000-000'") 
```

如果我这样做：

```
q_text = "Select * from Win32_NTLogEvent where Type='error' AND TimeWritten='20120806000000.000000-000'"
events = userwmi.query(q_text) 
```

它失败并出现以下错误：

```
Traceback (most recent call last):
  File "<pyshell#37>", line 1, in <module>
    events = user.query(q_text)
  File "C:\Python27\lib\site-packages\wmi.py", line 1009, in query
    return [ _wmi_object (obj, instance_of, fields) for obj in self._raw_query(wql) ]
  File "C:\Python27\lib\site-packages\win32com\client\util.py", line 84, in next
    return _get_good_object_(self._iter_.next(), resultCLSID = self.resultCLSID)
com_error: (-2147217385, 'OLE error 0x80041017', None, None) 
```

查询在语法上无效。我猜那是因为 query() 不是按原样传递文本，而是传递了一个表示文本的对象？我还尝试了 userwmi.query(wql=q_text) 来明确指定正在使用的关键字参数。

我的目标是使用 datetime 模块在运行时获取当前日期，然后在一个月前构造一个日期字符串（必要时考虑前导零和年份更改），然后构造一个采用新日期的 WQL 语句。现在我可以根据上面的格式构造日期，将它与查询语句的其余部分结合起来并打印完整的语句。我可以手动复制该语句并将其粘贴到 query() 方法中并成功运行。

我在这里有希望吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T02:10:59.137

我将在这里回答我自己的问题：字符串编码。通过构建字符串然后将其编码为 utf-8 一切正常。

# css - 为什么不能从 Rails 中的视图加载管道内的图像？

> ID：11909450
> 
> 赞同：0
> 
> 时间：2012-08-10T21:22:31.707
> 
> 标签：css, ruby-on-rails, ruby-on-rails-3, asset-pipeline

我有一个基于用户输入的动态背景的 div，所以我想直接从 erb 文件加载背景，所以当我输入

```
<div class="desk" style="background:url(myphoto.png);"> 
```

它不起作用，尽管如果我将这一行输入到 css 文件中它会起作用，所以有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:36:33.083

路径错误，应以“/assets/”为前缀。您应该使用asset_path 方法。如果在文件名末尾添加 md5 哈希，则生产中会出现其他问题。试试这个：

```
<div class="desk" style="background:url(<%= asset_path('myphoto.png') %>);"> 
```

更多信息可以在[Rails Guides中找到](http://guides.rubyonrails.org/asset_pipeline.html#coding-links-to-assets)

# bash - 目录命令行参数

> ID：11909451
> 
> 赞同：0
> 
> 时间：2012-08-10T21:22:39.940
> 
> 标签：bash, shell, unix

我在将脚本作为命令行参数运行的路径中遇到问题，测试它是否存在，然后更改为该路径以执行工作。这是我正在尝试的：

```
#!/bin/bash

scriptpath=$1

if [ $# -lt 1 ]
then
    echo "Usage: script.sh <directory_name>"
fi

if [ -d scriptpath ]
then
    # work......
else 
    echo "Directory does not exist"

fi 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T21:25:20.830

改变这个：

```
if [ -d scriptpath ] 
```

对此：

```
if [ -d $scriptpath ] 
```

另外，我建议使用`""`，这样当参数包含奇怪的字符时，您的脚本仍然可以正常运行。（Unix 允许在文件名中使用空格、换行符、星号，甚至是控制字符。）所以：

```
scriptpath="$1"

...

if [ -d "$scriptpath" ] 
```

# eclipse - 如何将来自多个项目的配置文件包含到 Eclipse 项目的 spring 特性中？

> ID：11909456
> 
> 赞同：2
> 
> 时间：2012-08-10T21:23:15.327
> 
> 标签：eclipse, spring, spring-nature

使用 Eclipse Helios 和 Spring Source Tool Suite 2.8.1.201111221000-RELEASE，添加了两个带有 Spring 特性的 Eclipse 项目，第二个取决于第一个 - 有没有办法将*两个*项目中的 Spring bean 配置文件添加到“Spring /Bean Support”的第二个项目的配置？

详细说说

*   项目 A 构建了一些`a.jar`，包含一些`module.xml`文件，声明了一些在 A 中实现的 Spring bean。
*   项目 B 构建一些`b.jar`，包含一些`application.xml`文件，声明在 B 中实现的 bean
*   B 的 spring 配置引用了在 A 的配置中声明的一些 bean
*   `application.xml`不导入`module.xml`，而是在运行时`ClassPathXmlApplicationContext`创建一个从匹配特定模式的类路径加载（所有）配置文件（类似于`"classpath:application.xml","classpath*:module.xml"`）
*   B的spring性质被配置`application.xml`为配置文件（Project properties => Spring => Beans Support => Config Files）

我要做的是告诉 STS B 的弹簧配置不仅包括 B 的`application.xml`，还包括 A 的`module.xml`。如果 A 不是工作区的一部分，但`a.jar`位于我的 Maven 存储库中，并且 B 声明依赖于该工件，我可以将`module.xml`配置文件添加到 B 的 spring 配置中。但是，如果 A 是工作空间的一部分，则`module.xml`似乎无法引用它。

我错过了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T08:28:35.643

啊，我*确实*错过了一些东西！你不能添加`module.xml`到 B 的“Spring / Beans Support / Config Files”列表中——但是当你编辑一个特定的配置集（第二个标签页）时——惊喜！- 模块 A 的所有配置文件也都可用。

奇迹般有效 ...

# javascript - 如何使用 Javascript 将持续时间字符串解析为秒？

> ID：11909457
> 
> 赞同：9
> 
> 时间：2012-08-10T21:23:16.427
> 
> 标签：javascript, regex

我正在尝试使用 Javascript 解析用户输入字符串的持续时间（以秒为单位）。

以下是我希望能够处理的一些示例输入：

*   “1小时2分钟”
*   “1天2小时3分钟”
*   “1d 2h 37m”
*   “1天2分钟”
*   “3天20小时”

关键组成部分是 1) 天，2) 小时 3) 分钟，但某些组成部分可能并不总是包括在内。

我的攻击计划是使用 .match 和正则表达式。只要我能得到单词的第一个字母，我就会知道前面的数字是什么，并且能够处理单词的所有不同格式（例如 hours、hour、hr、h）。然而，由于我正在为此学习正则表达式，结果证明它比我想象的要复杂得多。

任何帮助或建议将不胜感激！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-10T21:36:46.503

您的字符串中的天/小时/分钟的顺序是否得到保证？如果没有，为每个单独的 RegEx 做一个单独的 RegEx 可能会更容易。像这样的东西？

```
function getSeconds(str) {
  var seconds = 0;
  var days = str.match(/(\d+)\s*d/);
  var hours = str.match(/(\d+)\s*h/);
  var minutes = str.match(/(\d+)\s*m/);
  if (days) { seconds += parseInt(days[1])*86400; }
  if (hours) { seconds += parseInt(hours[1])*3600; }
  if (minutes) { seconds += parseInt(minutes[1])*60; }
  return seconds;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T21:48:37.190

您可以使用此代码将您的字符串分解为一个数字，后跟一个单位字符串：

```
function getPieces(str) {
    var pieces = [];
    var re = /(\d+)[\s,]*([a-zA-Z]+)/g, matches;
    while (matches = re.exec(str)) {
        pieces.push(+matches[1]);
        pieces.push(matches[2]);
    }
    return(pieces);
} 
```

然后函数返回一个数组，例如数组`["1","day","2","hours","3","minutes"]`中的交替项是值，然后是该值的单位。

所以，对于字符串：

```
"1 day, 2 hours, 3 minutes" 
```

函数返回：

```
[1, "day", 2, "hours", 3, "minutes"] 
```

然后，您可以检查每个值的单位以决定如何处理它。

在这里工作演示和测试用例：http: [//jsfiddle.net/jfriend00/kT9qn/](http://jsfiddle.net/jfriend00/kT9qn/)。该函数可以容忍可变数量的空格，并且在数字和单位标签之间使用逗号、空格或两者都不使用。它期望在单元之后有一个空格或一个逗号（至少一个）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T21:28:21.800

您可以在正则表达式中使用可选子字符串来匹配您描述的任何组合：

```
/(\d+)\s*d(ays?)?\s*(\d+)\s*h(ours?)?\s*(\d+)\s*m(in(utes?)?)?/ 
```

这至少需要一个`d`, `h`, 并且`m`接受常见的缩写。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-10T22:08:13.707

```
var str = "1 day, 2 hours, 3 minutes";

var seconds = 0;
str.replace (/\s*,?(\d+)\s*(?:(d)(?:ays?)?|(h)(?:ours?)?|(m)(?:in(?:utes?)?)?)/g, function (m0, n, d, h, m) {
  seconds += +n * (d ? 24 * 60 * 60 : h ? 60 * 60 : 60);
  return m0; 
}); 
```

在这里，我使用 replace 不是更改字符串，而是一一处理匹配项。注意天、小​​时/分钟可以按任何顺序排列。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-27T03:20:18.500

接受的答案的更通用版本，也接受月和秒。

```
const getSeconds = str => {
    let seconds = 0;
    let months = str.match(/(\d+)\s*M/);
    let days = str.match(/(\d+)\s*D/);
    let hours = str.match(/(\d+)\s*h/);
    let minutes = str.match(/(\d+)\s*m/);
    let secs = str.match(/(\d+)\s*s/);
    if (months) { seconds += parseInt(months[1])*86400*30; }
    if (days) { seconds += parseInt(days[1])*86400; }
    if (hours) { seconds += parseInt(hours[1])*3600; }
    if (minutes) { seconds += parseInt(minutes[1])*60; }
    if (secs) { seconds += parseInt(secs[1]); }
    return seconds;
};
```

# java - Java - 通过“参考值”传递？检索参考值或值？

> ID：11909458
> 
> 赞同：0
> 
> 时间：2012-08-10T21:23:20.723
> 
> 标签：java

如果我有一个像下面这样的课程：

```
public class Foo()
{
    private RandomObject randomObject = new RandomObject();

    public RandomObject GetRandromObject()
    {
        return randomObject;
    }
} 
```

在另一堂课中，我这样做：

```
public class Goo()
{
    private Foo fooObject = new Foo();

    public Goo()
    {
        RandomObject ro = fooObject.GetRandomObject();

        ro.ChangeNumberVariable(23);
    }
} 
```

会`fooObject`改成`randomObject` `NumberVariable`23吗？

如果不是，我是否只需要`Foo`调用一个方法`SetRandomObject`并传入`ro`？这会是 Java 中通过引用传递的一个很好的替代品吗？

如果我这样做怎么办：

```
public class Goo()
{
    private Foo fooObject = new Foo();

    public Goo()
    {
        fooObject.GetRandomObject().ChangeNumberVarialbe(23);
    }
} 
```

它仍然没有改变`NumberVariable`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:32:03.500

在这两种情况下， fooObject.randomObject 都会将 NumberVariable 更改为 23。它们几乎等价，只是前者使用了额外的引用。

这不会使 Java 引用传递。Java 是按值传递的。每当您将某些东西作为参数传递给方法时，它都会被复制，即使您传递的是对对象的引用。

尽管您可以使用该复制的引用来访问和更改对象末尾的对象，正如您在此处所做的那样，但对该引用的任何重新分配都无法逃脱该方法。

在您的第一个示例中：

```
ro = new RandomObject(); 
```

不会改变 fooObject.randomObject 的任何内容。

# c# - 如何在文本框下进行货币格式？

> ID：11909459
> 
> 赞同：0
> 
> 时间：2012-08-10T21:23:29.130
> 
> 标签：c#

我想在文本框中输入数字，我的文本框会自动将其转换为逗号（，）格式。我试图这样做，但它工作错了。帮我？像这样 1,20（我只输入 120）；

```
private bool IsNumeric(int Val)
{
    return ((Val >= 48 && Val <= 57) || (Val == 8) || (Val == 46));
}
String str;
private void textBox1_KeyDown(object sender, KeyEventArgs e)
{
    int KeyCode = e.KeyValue;
    if (!IsNumeric(KeyCode))
    {
        if (KeyCode == 13)
        {
            e.Handled = true;
            vendas();
            str = null;
        }
        e.Handled = true;
        return;

    }
    else
    {
        e.Handled = true;
    }
    if (((KeyCode == 8) || (KeyCode == 46)) && (str.Length > 0))
    {
        str = str.Substring(0, str.Length - 1);
    }
    else if (!((KeyCode == 8) || (KeyCode == 46)))
    {
        str = str + Convert.ToChar(KeyCode);
    }

    if (str.Length == 0)
    {
        textBox1.Text = "";
    }
    if (str.Length == 1)
    {
        textBox1.Text = "0,0" + str;
    }
    else if (str.Length == 2)
    {
        textBox1.Text = "0," + str;
    }
    else if ((str.Length > 2) && (str.Length != 6) && (str.Length != 9) && (str.Length != 12))
    {
        textBox1.Text = str.Substring(0, str.Length - 2) + "," + str.Substring(str.Length - 2);
        textBox1.Text = textBox1.Text;
    }
    else if ((str.Length > 6) && (str.Length != 8) && (str.Length != 10) && (str.Length != 12))
    {
        textBox1.Text = str.Substring(0, str.Length - 3) + "," + str.Substring(str.Length - 1);
        textBox1.Text = textBox1.Text;
    }
} 
```

它显示我 10,01 而不是 0,01？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:13:48.887

我最初打算建议使用 MaskedTextBox，但 MTB 是为固定（或至少在高级中已知）长度字符串的从左到右样式格式化而设计的，这使得它不太适合货币。

首先，我建议您避免使用键码等做任何事情，并坚持一些更简单的方法，只需在文本更改时验证和编辑文本：

```
 void tb_TextChanged(object sender, EventArgs e)
    {
          //Remove previous formatting, or the decimal check will fail
      string value = tb.Text.Replace(",", "").Replace("$", "");
      decimal ul;
          //Check we are indeed handling a number
      if (decimal.TryParse(value, out ul))
      {
            //Unsub the event so we don't enter a loop
        tb.TextChanged -= tb_TextChanged;
            //Format the text as currency
        tb.Text = string.Format(CultureInfo.CreateSpecificCulture("en-US"), "{0:C2}", ul);
        tb.TextChanged += tb_TextChanged;
      }
    } 
```

![例子](../Images/bcb5f580dcb482a7ba26eb4a68481523.png)

主要部分是`string.Format(CultureInfo.CreateSpecificCulture("en-US"), "{0:C2}", ul);`en-US 确保它始终将 $ 和小数显示为 '.'。将`{0:C2}`字符串格式化为`0`货币 ( `:C`) 到 2 个小数点 ( ) 的数字 ( `2`)。

这不会阻止用户输入文本，但您可以保留之前的文本（例如“$23.00”），如果用户输入的不是数字，decimal.TryParse 将失败，此时您可以还原文本恢复到用户更改之前的状态（只需在此事件处理程序的末尾附近插入一个 else 块）。

我建议最初将 TB 文本设置为 '$0.00' 或其他内容，否则光标会在格式化第一次更改时跳转。在添加逗号时它也有一些选择问题，您可以通过在格式化之前存储选择位置并在之后更改它来解决这个问题，或者做一些更复杂的事情，这只是一个例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:42:02.460

你想要的是一个[MaskedTextBox](http://msdn.microsoft.com/en-us/library/system.windows.forms.maskedtextbox.aspx)。

只需设置掩码，`"$999,999,990.00"`用户输入的任何输入都必须是数字，并且必须至少有3个，但输入可以是上亿的任何数字（如果您需要数十亿和万亿，只需添加更多的9和逗号）。当用户输入这些数字时，格式将根据掩码进行调整。这是踢球者；MaskedTextBox 尊重文化信息，因此如果您指定法国文化，则逗号变为空格，小数点变为逗号，美元符号变为欧元符号。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-10T21:46:34.073

好吧，乍一看，我注意到您的代码没有任何意义。

首先，**学习缩进的编码标准**。这段代码非常难以阅读。我很想将这个问题标记为冒犯，因为不得不查看它。

接下来，这一行：

```
if (!IsNumeric(KeyCode){ 
```

说：如果键码不是数字，请执行以下操作，其中“以下内容”是对假定为数字的键码的一大堆数字操作。

接下来，`str`没有在您的方法中的任何地方定义。也许它是在全球范围内定义的，但这很愚蠢。相反，您应该以编程方式获取它的当前值。

最后：你不需要重新发明轮子。有很多工具可以为你做这种事情。事实上，我很确定 win 表单有一个可以执行此操作的本机控件。它甚至可能是文本框的一个属性，我不记得了。

# php - json到数组到mysql不循环数据

> ID：11909469
> 
> 赞同：0
> 
> 时间：2012-08-10T21:24:24.480
> 
> 标签：php, mysql, json

嗨，伙计们，我需要将此 json 数据导入我的数据库，因此我已经使用类似于下面的脚本从同一站点收集了另一个结构的详细信息，但它只有 8 个项目长，这表现得好像它有效但没有发生在有问题的表上是json：

```
[{"country":"Sri Lanka","countryCode":"LK"},{"country":"Syria","countryCode":"SY"},{"country":"Kenya","countryCode":"KE"},{"country":"Cambodia","countryCode":"KH"},{"country":"Mongolia","countryCode":"MN"},{"country":"Senegal","countryCode":"SN"},{"country":"Jordan","countryCode":"JO"},{"country":"Sweden","countryCode":"SE"},{"country":"United Kingdom","countryCode":"GB"},{"country":"Austria","countryCode":"AT"},{"country":"Israel","countryCode":"IL"},{"country":"Paraguay","countryCode":"PY"},{"country":"Jamaica","countryCode":"JM"},{"country":"Mexico","countryCode":"MX"},{"country":"Chile","countryCode":"CL"},{"country":"Canada","countryCode":"CA"},{"country":"Bulgaria","countryCode":"BG"},{"country":"Monaco","countryCode":"MC"},{"country":"Puerto Rico","countryCode":"PR"},{"country":"Lebanon","countryCode":"LB"},{"country":"Ecuador","countryCode":"EC"},{"country":"Palau","countryCode":"PW"},{"country":"Guam","countryCode":"GU"},{"country":"Macedonia","countryCode":"MK"},{"country":"Reunion","countryCode":"RE"},{"country":"Botswana","countryCode":"BW"},{"country":"Libya","countryCode":"LY"},{"country":"Togo","countryCode":"TG"},{"country":"Thailand","countryCode":"TH"},{"country":"Malaysia","countryCode":"MY"},{"country":"Spain","countryCode":"ES"},{"country":"Denmark","countryCode":"DK"},{"country":"Dominican Republic","countryCode":"DO"},{"country":"Belize","countryCode":"BZ"},{"country":"Nicaragua","countryCode":"NI"},{"country":"Venezuela","countryCode":"VE"},{"country":"Latvia","countryCode":"LV"},{"country":"Azerbaijan","countryCode":"AZ"},{"country":"Moldova","countryCode":"MD"},{"country":"United Arab Emirates","countryCode":"AE"},{"country":"Malta","countryCode":"MT"},{"country":"Swaziland","countryCode":"SZ"},{"country":"Yemen","countryCode":"YE"},{"country":"El Salvador","countryCode":"SV"},{"country":"Malawi","countryCode":"MW"},{"country":"French Guiana","countryCode":"GF"},{"country":"Bangladesh","countryCode":"BD"},{"country":"Liechtenstein","countryCode":"LI"},{"country":"San Marino","countryCode":"SM"},{"country":"Belarus","countryCode":"BY"},{"country":"Mozambique","countryCode":"MZ"},{"country":"Iran","countryCode":"IR"},{"country":"Pakistan","countryCode":"PK"},{"country":"Russia","countryCode":"RU"},{"country":"Mauritius","countryCode":"MU"},{"country":"Taiwan","countryCode":"TW"},{"country":"Portugal","countryCode":"PT"},{"country":"Nigeria","countryCode":"NG"},{"country":"Greece","countryCode":"GR"},{"country":"Switzerland","countryCode":"CH"},{"country":"Kuwait","countryCode":"KW"},{"country":"Luxembourg","countryCode":"LU"},{"country":"Czech Republic","countryCode":"CZ"},{"country":"Croatia","countryCode":"HR"},{"country":"Argentina","countryCode":"AR"},{"country":"Egypt","countryCode":"EG"},{"country":"Costa Rica","countryCode":"CR"},{"country":"United States","countryCode":"US"},{"country":"Lithuania","countryCode":"LT"},{"country":"Kazakhstan","countryCode":"KZ"},{"country":"Serbia","countryCode":"RS"},{"country":"Estonia","countryCode":"EE"},{"country":"Singapore","countryCode":"SG"},{"country":"Micronesia","countryCode":"FM"},{"country":"Albania","countryCode":"AL"},{"country":"Mali","countryCode":"ML"},{"country":"Uganda","countryCode":"UG"},{"country":"South Africa","countryCode":"ZA"},{"country":"Myanmar","countryCode":"MM"},{"country":"Australia","countryCode":"AU"},{"country":"Fiji","countryCode":"FJ"},{"country":"Italy","countryCode":"IT"},{"country":"Andorra","countryCode":"AD"},{"country":"Norway","countryCode":"NO"},{"country":"Brazil","countryCode":"BR"},{"country":"Uruguay","countryCode":"UY"},{"country":"Guatemala","countryCode":"GT"},{"country":"French Polynesia","countryCode":"PF"},{"country":"Seychelles","countryCode":"SC"},{"country":"Barbados","countryCode":"BB"},{"country":"Montenegro","countryCode":"ME"},{"country":"Laos","countryCode":"LA"},{"country":"Cook Islands","countryCode":"CK"},{"country":"Cayman Islands","countryCode":"KY"},{"country":"Gabon","countryCode":"GA"},{"country":"Saudi Arabia","countryCode":"SA"},{"country":"Vietnam","countryCode":"VN"},{"country":"Philippines","countryCode":"PH"},{"country":"South Korea","countryCode":"KR"},{"country":"Japan","countryCode":"JP"},{"country":"Vanuatu","countryCode":"VU"},{"country":"New Zealand","countryCode":"NZ"},{"country":"Tunisia","countryCode":"TN"},{"country":"Ireland","countryCode":"IE"},{"country":"Slovenia","countryCode":"SI"},{"country":"Suriname","countryCode":"SR"},{"country":"Finland","countryCode":"FI"},{"country":"Aruba","countryCode":"AW"},{"country":"Nepal","countryCode":"NP"},{"country":"Faroe Islands","countryCode":"FO"},{"country":"Sudan","countryCode":"SD"},{"country":"Indonesia","countryCode":"ID"},{"country":"China","countryCode":"CN"},{"country":"Maldives","countryCode":"MV"},{"country":"Uzbekistan","countryCode":"UZ"},{"country":"Hong Kong","countryCode":"HK"},{"country":"Algeria","countryCode":"DZ"},{"country":"Germany","countryCode":"DE"},{"country":"Oman","countryCode":"OM"},{"country":"France","countryCode":"FR"},{"country":"Slovakia","countryCode":"SK"},{"country":"Poland","countryCode":"PL"},{"country":"Bahamas","countryCode":"BS"},{"country":"Guadeloupe","countryCode":"GP"},{"country":"Colombia","countryCode":"CO"},{"country":"Bolivia","countryCode":"BO"},{"country":"Ukraine","countryCode":"UA"},{"country":"Netherlands Antilles","countryCode":"AN"},{"country":"Tonga","countryCode":"TO"},{"country":"Georgia","countryCode":"GE"},{"country":"Ethiopia","countryCode":"ET"},{"country":"Bermuda","countryCode":"BM"},{"country":"Cyprus","countryCode":"CY"},{"country":"Gambia","countryCode":"GM"},{"country":"Morocco","countryCode":"MA"},{"country":"Hungary","countryCode":"HU"},{"country":"Honduras","countryCode":"HN"},{"country":"Peru","countryCode":"PE"},{"country":"Romania","countryCode":"RO"},{"country":"Armenia","countryCode":"AM"},{"country":"New Caledonia","countryCode":"NC"},{"country":"Zambia","countryCode":"ZM"},{"country":"India","countryCode":"IN"},{"country":"Tanzania","countryCode":"TZ"},{"country":"Netherlands","countryCode":"NL"},{"country":"Belgium","countryCode":"BE"},{"country":"Turkey","countryCode":"TR"},{"country":"Namibia","countryCode":"NA"},{"country":"Grenada","countryCode":"GD"},{"country":"Qatar","countryCode":"QA"},{"country":"Iceland","countryCode":"IS"},{"country":"Bahrain","countryCode":"BH"},{"country":"Zimbabwe","countryCode":"ZW"},{"country":"Gibraltar","countryCode":"GI"},{"country":"Cameroon","countryCode":"CM"}] 
```

那么这就是数组的样子：

```
array(155) 
{ [0]=> array(2) { ["country"]=> string(9) "Sri Lanka" ["countryCode"]=> string(2) "LK" }
 [1]=> array(2) { ["country"]=> string(5) "Syria" ["countryCode"]=> string(2) "SY" } 
[2]=> array(2) { ["country"]=> string(5) "Kenya" ["countryCode"]=> string(2) "KE" } 
[3]=> array(2) { ["country"]=> string(8) "Cambodia" ["countryCode"]=> string(2) "KH" } 
[4]=> array(2) { ["country"]=> string(8) "Mongolia" ["countryCode"]=> string(2) "MN" }
  [5]=> array(2) { ["country"]=> string(7) "Senegal" ["countryCode"]=> string(2) "SN" }
  [6]=> array(2) { ["country"]=> string(6) "Jordan" ["countryCode"]=> string(2) "JO" }
 [7]=> array(2) { ["country"]=> string(6) "Sweden" ["countryCode"]=> string(2) "SE" } 
[8]=> array(2) { ["country"]=> string(14) "United Kingdom" ["countryCode"]=> string(2) "GB" }
 [9]=> array(2) { ["country"]=> string(7) "Austria" ["countryCode"]=> string(2) "AT" } [10]=> array(2) { ["country"]=> string(6) "Israel" ["countryCode"]=> string(2) "IL" } [11]=> array(2) { ["country"]=> string(8) "Paraguay" ["countryCode"]=> string(2) "PY" } [12]=> array(2) { ["country"]=> string(7) "Jamaica" ["countryCode"]=> string(2) "JM" } [13]=> array(2) { ["country"]=> string(6) "Mexico" ["countryCode"]=> string(2) "MX" } [14]=> array(2) { ["country"]=> string(5) "Chile" ["countryCode"]=> string(2) "CL" } [15]=> array(2) { ["country"]=> string(6) "Canada" ["countryCode"]=> string(2) "CA" } [16]=> array(2) { ["country"]=> string(8) "Bulgaria" ["countryCode"]=> string(2) "BG" } [17]=> array(2) { ["country"]=> string(6) "Monaco" ["countryCode"]=> string(2) "MC" } [18]=> array(2) { ["country"]=> string(11) "Puerto Rico" ["countryCode"]=> string(2) "PR" } [19]=> array(2) { ["country"]=> string(7) "Lebanon" ["countryCode"]=> string(2) "LB" } [20]=> array(2) { ["country"]=> string(7) "Ecuador" ["countryCode"]=> string(2) "EC" } [21]=> array(2) { ["country"]=> string(5) "Palau" ["countryCode"]=> string(2) "PW" } [22]=> array(2) { ["country"]=> string(4) "Guam" ["countryCode"]=> string(2) "GU" } [23]=> array(2) { ["country"]=> string(9) "Macedonia" ["countryCode"]=> string(2) "MK" } [24]=> array(2) { ["country"]=> string(7) "Reunion" ["countryCode"]=> string(2) "RE" } [25]=> array(2) { ["country"]=> string(8) "Botswana" ["countryCode"]=> string(2) "BW" } [26]=> array(2) { ["country"]=> string(5) "Libya" ["countryCode"]=> string(2) "LY" } [27]=> array(2) { ["country"]=> string(4) "Togo" ["countryCode"]=> string(2) "TG" } [28]=> array(2) { ["country"]=> string(8) "Thailand" ["countryCode"]=> string(2) "TH" } [29]=> array(2) { ["country"]=> string(8) "Malaysia" ["countryCode"]=> string(2) "MY" } [30]=> array(2) { ["country"]=> string(5) "Spain" ["countryCode"]=> string(2) "ES" } [31]=> array(2) { ["country"]=> string(7) "Denmark" ["countryCode"]=> string(2) "DK" } [32]=> array(2) { ["country"]=> string(18) "Dominican Republic" ["countryCode"]=> string(2) "DO" } [33]=> array(2) { ["country"]=> string(6) "Belize" ["countryCode"]=> string(2) "BZ" } [34]=> array(2) { ["country"]=> string(9) "Nicaragua" ["countryCode"]=> string(2) "NI" } [35]=> array(2) { ["country"]=> string(9) "Venezuela" ["countryCode"]=> string(2) "VE" } [36]=> array(2) { ["country"]=> string(6) "Latvia" ["countryCode"]=> string(2) "LV" } [37]=> array(2) { ["country"]=> string(10) "Azerbaijan" ["countryCode"]=> string(2) "AZ" } [38]=> array(2) { ["country"]=> string(7) "Moldova" ["countryCode"]=> string(2) "MD" } [39]=> array(2) { ["country"]=> string(20) "United Arab Emirates" ["countryCode"]=> string(2) "AE" } [40]=> array(2) { ["country"]=> string(5) "Malta" ["countryCode"]=> string(2) "MT" } [41]=> array(2) { ["country"]=> string(9) "Swaziland" ["countryCode"]=> string(2) "SZ" } [42]=> array(2) { ["country"]=> string(5) "Yemen" ["countryCode"]=> string(2) "YE" } [43]=> array(2) { ["country"]=> string(11) "El Salvador" ["countryCode"]=> string(2) "SV" } [44]=> array(2) { ["country"]=> string(6) "Malawi" ["countryCode"]=> string(2) "MW" } [45]=> array(2) { ["country"]=> string(13) "French Guiana" ["countryCode"]=> string(2) "GF" } [46]=> array(2) { ["country"]=> string(10) "Bangladesh" ["countryCode"]=> string(2) "BD" } [47]=> array(2) { ["country"]=> string(13) "Liechtenstein" ["countryCode"]=> string(2) "LI" } [48]=> array(2) { ["country"]=> string(10) "San Marino" ["countryCode"]=> string(2) "SM" } [49]=> array(2) { ["country"]=> string(7) "Belarus" ["countryCode"]=> string(2) "BY" } [50]=> array(2) { ["country"]=> string(10) "Mozambique" ["countryCode"]=> string(2) "MZ" } [51]=> array(2) { ["country"]=> string(4) "Iran" ["countryCode"]=> string(2) "IR" } [52]=> array(2) { ["country"]=> string(8) "Pakistan" ["countryCode"]=> string(2) "PK" } [53]=> array(2) { ["country"]=> string(6) "Russia" ["countryCode"]=> string(2) "RU" } [54]=> array(2) { ["country"]=> string(9) "Mauritius" ["countryCode"]=> string(2) "MU" } [55]=> array(2) { ["country"]=> string(6) "Taiwan" ["countryCode"]=> string(2) "TW" } [56]=> array(2) { ["country"]=> string(8) "Portugal" ["countryCode"]=> string(2) "PT" } [57]=> array(2) { ["country"]=> string(7) "Nigeria" ["countryCode"]=> string(2) "NG" } [58]=> array(2) { ["country"]=> string(6) "Greece" ["countryCode"]=> string(2) "GR" } [59]=> array(2) { ["country"]=> string(11) "Switzerland" ["countryCode"]=> string(2) "CH" } [60]=> array(2) { ["country"]=> string(6) "Kuwait" ["countryCode"]=> string(2) "KW" } [61]=> array(2) { ["country"]=> string(10) "Luxembourg" ["countryCode"]=> string(2) "LU" } [62]=> array(2) { ["country"]=> string(14) "Czech Republic" ["countryCode"]=> string(2) "CZ" } [63]=> array(2) { ["country"]=> string(7) "Croatia" ["countryCode"]=> string(2) "HR" } [64]=> array(2) { ["country"]=> string(9) "Argentina" ["countryCode"]=> string(2) "AR" } [65]=> array(2) { ["country"]=> string(5) "Egypt" ["countryCode"]=> string(2) "EG" } [66]=> array(2) { ["country"]=> string(10) "Costa Rica" ["countryCode"]=> string(2) "CR" } [67]=> array(2) { ["country"]=> string(13) "United States" ["countryCode"]=> string(2) "US" } [68]=> array(2) { ["country"]=> string(9) "Lithuania" ["countryCode"]=> string(2) "LT" } [69]=> array(2) { ["country"]=> string(10) "Kazakhstan" ["countryCode"]=> string(2) "KZ" } [70]=> array(2) { ["country"]=> string(6) "Serbia" ["countryCode"]=> string(2) "RS" } [71]=> array(2) { ["country"]=> string(7) "Estonia" ["countryCode"]=> string(2) "EE" } [72]=> array(2) { ["country"]=> string(9) "Singapore" ["countryCode"]=> string(2) "SG" } [73]=> array(2) { ["country"]=> string(10) "Micronesia" ["countryCode"]=> string(2) "FM" } [74]=> array(2) { ["country"]=> string(7) "Albania" ["countryCode"]=> string(2) "AL" } [75]=> array(2) { ["country"]=> string(4) "Mali" ["countryCode"]=> string(2) "ML" } [76]=> array(2) { ["country"]=> string(6) "Uganda" ["countryCode"]=> string(2) "UG" } [77]=> array(2) { ["country"]=> string(12) "South Africa" ["countryCode"]=> string(2) "ZA" } [78]=> array(2) { ["country"]=> string(7) "Myanmar" ["countryCode"]=> string(2) "MM" } [79]=> array(2) { ["country"]=> string(9) "Australia" ["countryCode"]=> string(2) "AU" } [80]=> array(2) { ["country"]=> string(4) "Fiji" ["countryCode"]=> string(2) "FJ" } [81]=> array(2) { ["country"]=> string(5) "Italy" ["countryCode"]=> string(2) "IT" } [82]=> array(2) { ["country"]=> string(7) "Andorra" ["countryCode"]=> string(2) "AD" } [83]=> array(2) { ["country"]=> string(6) "Norway" ["countryCode"]=> string(2) "NO" } [84]=> array(2) { ["country"]=> string(6) "Brazil" ["countryCode"]=> string(2) "BR" } [85]=> array(2) { ["country"]=> string(7) "Uruguay" ["countryCode"]=> string(2) "UY" } [86]=> array(2) { ["country"]=> string(9) "Guatemala" ["countryCode"]=> string(2) "GT" } [87]=> array(2) { ["country"]=> string(16) "French Polynesia" ["countryCode"]=> string(2) "PF" } [88]=> array(2) { ["country"]=> string(10) "Seychelles" ["countryCode"]=> string(2) "SC" } [89]=> array(2) { ["country"]=> string(8) "Barbados" ["countryCode"]=> string(2) "BB" } [90]=> array(2) { ["country"]=> string(10) "Montenegro" ["countryCode"]=> string(2) "ME" } [91]=> array(2) { ["country"]=> string(4) "Laos" ["countryCode"]=> string(2) "LA" } [92]=> array(2) { ["country"]=> string(12) "Cook Islands" ["countryCode"]=> string(2) "CK" } [93]=> array(2) { ["country"]=> string(14) "Cayman Islands" ["countryCode"]=> string(2) "KY" } [94]=> array(2) { ["country"]=> string(5) "Gabon" ["countryCode"]=> string(2) "GA" } [95]=> array(2) { ["country"]=> string(12) "Saudi Arabia" ["countryCode"]=> string(2) "SA" } [96]=> array(2) { ["country"]=> string(7) "Vietnam" ["countryCode"]=> string(2) "VN" } [97]=> array(2) { ["country"]=> string(11) "Philippines" ["countryCode"]=> string(2) "PH" } [98]=> array(2) { ["country"]=> string(11) "South Korea" ["countryCode"]=> string(2) "KR" } [99]=> array(2) { ["country"]=> string(5) "Japan" ["countryCode"]=> string(2) "JP" } [100]=> array(2) { ["country"]=> string(7) "Vanuatu" ["countryCode"]=> string(2) "VU" } [101]=> array(2) { ["country"]=> string(11) "New Zealand" ["countryCode"]=> string(2) "NZ" } [102]=> array(2) { ["country"]=> string(7) "Tunisia" ["countryCode"]=> string(2) "TN" } [103]=> array(2) { ["country"]=> string(7) "Ireland" ["countryCode"]=> string(2) "IE" } [104]=> array(2) { ["country"]=> string(8) "Slovenia" ["countryCode"]=> string(2) "SI" } [105]=> array(2) { ["country"]=> string(8) "Suriname" ["countryCode"]=> string(2) "SR" } [106]=> array(2) { ["country"]=> string(7) "Finland" ["countryCode"]=> string(2) "FI" } [107]=> array(2) { ["country"]=> string(5) "Aruba" ["countryCode"]=> string(2) "AW" } [108]=> array(2) { ["country"]=> string(5) "Nepal" ["countryCode"]=> string(2) "NP" } [109]=> array(2) { ["country"]=> string(13) "Faroe Islands" ["countryCode"]=> string(2) "FO" } [110]=> array(2) { ["country"]=> string(5) "Sudan" ["countryCode"]=> string(2) "SD" } [111]=> array(2) { ["country"]=> string(9) "Indonesia" ["countryCode"]=> string(2) "ID" } [112]=> array(2) { ["country"]=> string(5) "China" ["countryCode"]=> string(2) "CN" } [113]=> array(2) { ["country"]=> string(8) "Maldives" ["countryCode"]=> string(2) "MV" } [114]=> array(2) { ["country"]=> string(10) "Uzbekistan" ["countryCode"]=> string(2) "UZ" } [115]=> array(2) { ["country"]=> string(9) "Hong Kong" ["countryCode"]=> string(2) "HK" } [116]=> array(2) { ["country"]=> string(7) "Algeria" ["countryCode"]=> string(2) "DZ" } [117]=> array(2) { ["country"]=> string(7) "Germany" ["countryCode"]=> string(2) "DE" } [118]=> array(2) { ["country"]=> string(4) "Oman" ["countryCode"]=> string(2) "OM" } [119]=> array(2) { ["country"]=> string(6) "France" ["countryCode"]=> string(2) "FR" } [120]=> array(2) { ["country"]=> string(8) "Slovakia" ["countryCode"]=> string(2) "SK" } [121]=> array(2) { ["country"]=> string(6) "Poland" ["countryCode"]=> string(2) "PL" } [122]=> array(2) { ["country"]=> string(7) "Bahamas" ["countryCode"]=> string(2) "BS" } [123]=> array(2) { ["country"]=> string(10) "Guadeloupe" ["countryCode"]=> string(2) "GP" } [124]=> array(2) { ["country"]=> string(8) "Colombia" ["countryCode"]=> string(2) "CO" } [125]=> array(2) { ["country"]=> string(7) "Bolivia" ["countryCode"]=> string(2) "BO" } [126]=> array(2) { ["country"]=> string(7) "Ukraine" ["countryCode"]=> string(2) "UA" } [127]=> array(2) { ["country"]=> string(20) "Netherlands Antilles" ["countryCode"]=> string(2) "AN" } [128]=> array(2) { ["country"]=> string(5) "Tonga" ["countryCode"]=> string(2) "TO" } [129]=> array(2) { ["country"]=> string(7) "Georgia" ["countryCode"]=> string(2) "GE" } [130]=> array(2) { ["country"]=> string(8) "Ethiopia" ["countryCode"]=> string(2) "ET" } [131]=> array(2) { ["country"]=> string(7) "Bermuda" ["countryCode"]=> string(2) "BM" } [132]=> array(2) { ["country"]=> string(6) "Cyprus" ["countryCode"]=> string(2) "CY" } [133]=> array(2) { ["country"]=> string(6) "Gambia" ["countryCode"]=> string(2) "GM" } [134]=> array(2) { ["country"]=> string(7) "Morocco" ["countryCode"]=> string(2) "MA" } [135]=> array(2) { ["country"]=> string(7) "Hungary" ["countryCode"]=> string(2) "HU" } [136]=> array(2) { ["country"]=> string(8) "Honduras" ["countryCode"]=> string(2) "HN" } [137]=> array(2) { ["country"]=> string(4) "Peru" ["countryCode"]=> string(2) "PE" } [138]=> array(2) { ["country"]=> string(7) "Romania" ["countryCode"]=> string(2) "RO" } [139]=> array(2) { ["country"]=> string(7) "Armenia" ["countryCode"]=> string(2) "AM" } [140]=> array(2) { ["country"]=> string(13) "New Caledonia" ["countryCode"]=> string(2) "NC" } [141]=> array(2) { ["country"]=> string(6) "Zambia" ["countryCode"]=> string(2) "ZM" } [142]=> array(2) { ["country"]=> string(5) "India" ["countryCode"]=> string(2) "IN" } [143]=> array(2) { ["country"]=> string(8) "Tanzania" ["countryCode"]=> string(2) "TZ" } [144]=> array(2) { ["country"]=> string(11) "Netherlands" ["countryCode"]=> string(2) "NL" } [145]=> array(2) { ["country"]=> string(7) "Belgium" ["countryCode"]=> string(2) "BE" } [146]=> array(2) { ["country"]=> string(6) "Turkey" ["countryCode"]=> string(2) "TR" } [147]=> array(2) { ["country"]=> string(7) "Namibia" ["countryCode"]=> string(2) "NA" } [148]=> array(2) { ["country"]=> string(7) "Grenada" ["countryCode"]=> string(2) "GD" } [149]=> array(2) { ["country"]=> string(5) "Qatar" ["countryCode"]=> string(2) "QA" } [150]=> array(2) { ["country"]=> string(7) "Iceland" ["countryCode"]=> string(2) "IS" } [151]=> array(2) { ["country"]=> string(7) "Bahrain" ["countryCode"]=> string(2) "BH" } [152]=> array(2) { ["country"]=> string(8) "Zimbabwe" ["countryCode"]=> string(2) "ZW" } [153]=> array(2) { ["country"]=> string(9) "Gibraltar" ["countryCode"]=> string(2) "GI" } [154]=> array(2) { ["country"]=> string(8) "Cameroon" ["countryCode"]=> string(2) "CM" } } 
```

然后这是用于转换为数组并插入 mysql 的代码，但它不会将数据导入 mysql：

```
$ch = curl_init();
$timeout = 0;
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
$rawdatar = curl_exec($ch);
curl_close($ch);
$object_array = json_decode($rawdatar,true);
foreach($object_array as $obj) {
    $country = $obj['country'];
    $countryCode = $obj['countryCode'];
    if($countryCode){
        $sql = "INSERT INTO `pt_country` (country,countrycode) VALUES ('$country','$countryCode')";
        database_queryModify($sql,$result);
    }
    else{
        echo "dint work";
    }
} 
```

它的行为就好像它应该做某事但是当我检查 sql 表时我没有做错什么？我知道一切正常，我只运行一次这个脚本来获取数据，这不是某人可以利用的常规请求我将监控数据输​​入

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T23:08:43.860

项目的长度对数据库来说应该不是问题。我认为有一个错误，但你看不到它。

尝试打开 error_reporting 并重新运行脚本。在脚本的开头添加此代码。

```
// Report all PHP errors (see changelog)
error_reporting(E_ALL); 
```

[http://www.php.net/manual/en/function.error-reporting.php](http://www.php.net/manual/en/function.error-reporting.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:29:56.017

您是否检查了 curl 调用是否有效？不。

```
$rawdata = curl_exec($ch) or die(curl_error($ch));
                          ^^^^^^^^^^^^^^^^^^^^^^^^ 
```

您是否检查过您是否真的获得了有效的 JSON 数据？CURL 完成后？不

```
var_dump($rawdata); 
```

您是否检查过 JSON 解码是否成功？不

```
var_dump($object_array); 
```

您是否检查过 INSERT 查询是否成功？不。

```
if (!database_queryModify($sql,$result)) { ... whatever your DB library's error message fetcher is }; 
```

就目前而言，您的查询容易受到 SQL 注入的攻击，因为您将远程站点提供的原始文本插入到查询字符串中。没有什么说远程站点不能被破坏并`$obj['country']`成为小[Bobby Tables](http://bobby-tables.com)

# javascript - 为什么 Bootstrap 的 scrollspy 不起作用？

> ID：11909474
> 
> 赞同：4
> 
> 时间：2012-08-10T21:24:53.220
> 
> 标签：javascript, twitter-bootstrap

我有一个简单的 Bootstrap 模式设置，并且在模式中我有一个`nav`和 scrollspy 设置的内容。但是，它不起作用。我看到它被激活了，但导航永远不会更新。

完整的源码在这里太长了，你看不到我得到的效果，所以我设置了一个[jsfiddle](http://jsfiddle.net/jkaiser/xjTpk/3/)

我正在使用该`data-spy="scroll"`方法来启用它。我做错了什么？为什么导航没有根据您的位置更新？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-21T12:27:42.587

bootstrap scrollspy 仍然有一些错误（我真的很喜欢 bootsrap）。我为此使用了一个自定义脚本，它工作得更好，更灵活：

```
<script type="text/javascript">
$(document).ready(function(){
var lastId, topMenu = $(".menu-sidebar"),
    topMenuHeight = topMenu.outerHeight() + 150,
    menuItems = topMenu.find("a"),
    scrollItems = menuItems.map(function() {
        var item = $($(this).attr("href"));
        if (item.length) {
            return item;
        }
    });

menuItems.click(function(e) {
    var href = $(this).attr("href"),
    topMenuHeight = topMenu.outerHeight() + 20,
        offsetTop = href === "#" ? 0 : $(href).offset().top - topMenuHeight + 1;
    $('html, body').stop().animate({
        scrollTop: offsetTop
    }, 300);
    e.preventDefault();
});

$(window).scroll(function() {
    var fromTop = $(this).scrollTop() + topMenuHeight;

    var cur = scrollItems.map(function() {
        if ($(this).offset().top < fromTop) return this;
    });
    cur = cur[cur.length - 1];
    var id = cur && cur.length ? cur[0].id : "";

    if (lastId !== id) {
        lastId = id;
        menuItems.parent().removeClass("active").end().filter("[href=#" + id + "]").parent().addClass("active");
    }
});
});
</script> 
```

来源：http: [//jsfiddle.net/mekwall/up4nu/](http://jsfiddle.net/mekwall/up4nu/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-12T20:42:38.940

嘿，我认为这里有两个问题：

(1) 将 scrollspy 放在身体以外的东西上会导致问题。看看这个：

[在 Twitter Bootstrap 的 ScrollSpy 中，我究竟可以在哪里放置 data-spy="scroll"？](https://stackoverflow.com/questions/11658755/in-twitter-bootstraps-scrollspy-where-exactly-can-i-put-data-spy-scroll)

基本上，如果您添加：

```
#area-to-watch {
    height: 200px;
    overflow: auto; 
} 
```

它将允许您滚动监视以“监视”身体以外的东西。 [http://jsfiddle.net/hajpoj/SZYKM/](http://jsfiddle.net/hajpoj/SZYKM/) 这是你的 jsfiddle 的修改版本

(2) 将 scrollspy 放入模型会导致更多问题。如果你把上面的东西放到一个模型中，它有点吓坏了。我不积极，但我认为你需要做类似的事情

```
.scrollspy('refresh') 
```

在文档中说明[http://twitter.github.com/bootstrap/javascript.html#scrollspy](http://twitter.github.com/bootstrap/javascript.html#scrollspy)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T08:37:40.607

请确保您的引导文件夹包含 ScrollSpy 所需的所有 .js 文件

就我而言，我的引导文件夹 (bootstrap/js/) 包含以下文件：

```
<script src="bootstrap/js/jquery.js"></script>
<script src="bootstrap/js/bootstrap-transition.js"></script>
<script src="bootstrap/js/bootstrap-alert.js"></script>
<script src="bootstrap/js/bootstrap-modal.js"></script>
<script src="bootstrap/js/bootstrap-dropdown.js"></script>
<script src="bootstrap/js/bootstrap-scrollspy.js"></script>
<script src="bootstrap/js/bootstrap-tab.js"></script>
<script src="bootstrap/js/bootstrap-tooltip.js"></script>
<script src="bootstrap/js/bootstrap-popover.js"></script>
<script src="bootstrap/js/bootstrap-button.js"></script>
<script src="bootstrap/js/bootstrap-collapse.js"></script>
<script src="bootstrap/js/bootstrap-carousel.js"></script>
<script src="bootstrap/js/bootstrap-typeahead.js"></script>
<script src="bootstrap/js/bootstrap-affix.js"></script>

<script src="bootstrap/js/holder/holder.js"></script>
<script src="bootstrap/js/google-code-prettify/prettify.js"></script>

<script src="bootstrap/js/application.js"></script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-04T20:11:11.137

在模态显示如下之后，您应该调用 .scrollspy('refresh') ：

```
 $('#myModal').on('shown.bs.modal', function (e) {
        $('.modal-body').scrollspy('refresh');
 }); 
```

# parallel-processing - 对于 NS-3，使用 MPI 分布式仿真时是否需要同步？

> ID：11909475
> 
> 赞同：0
> 
> 时间：2012-08-10T21:25:04.547
> 
> 标签：parallel-processing, mpi, ns-3

我正在尝试使用 NS-3 的 MPI 分布式模拟功能。我已经在我的模块中实现了一个应用程序和一个节点类。我也有一个工厂类作为单例对象。我是否必须考虑在我的单例类中使用监视器和互斥锁进行同步？

在某些函数中，我正在更改类变量，因此看起来我应该考虑线程安全，但我不确定 MPI 是如何工作的，以及它是否真的创建了对象的一个​​实例，或者它在每个进程中创建了单独的对象。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T16:17:42.730

ns-3 MPI 支持将 ns-3 节点分布在 mpi 计算节点之间，因此，如果您有一个进程级工厂单例，则每个 mpi 处理节点上都会有这个工厂的一个实例，并且不会与其他实例共享其状态其他节点上的工厂。

通常，将全局状态（即节点实例之间共享的状态）与基于 MPI 的模拟一起使用被认为是一个非常糟糕的主意。

# java - Guava 基于策略的缓存

> ID：11909476
> 
> 赞同：1
> 
> 时间：2012-08-10T21:25:12.167
> 
> 标签：java, caching, guava

我正在尝试创建一个简单的会话缓存，允许我在整个缓存上设置最大大小。缓存不是计算缓存，所以我认为`CacheBuilder`带有 a的 Guava`LoadingCache`是不合适的。我希望能够执行以下操作：

`get(key)`缓存操作中先前在缓存操作期间缓存的数据在缓存操作 `put(key,value)`期间存储到缓存中

我尝试使用 MapMaker，但最大尺寸方法似乎已经过时了。有谁知道我有什么选择？我想我总是可以只使用一个简单的地图并滚动我自己的政策？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T22:22:46.357

> 缓存不是计算缓存，所以我认为`CacheBuilder`带有 a的 Guava`LoadingCache`是不合适的。

所以使用`CacheBuilder`没有它。它的工作原理完全相同，只是你调用 plain`build()`代替 if `build(CacheLoader)`。一切都保持不变，除了您获得“正常”缓存而不是加载缓存。就这样。

> 我尝试使用 MapMaker，但最大尺寸方法似乎已经过时了。

缓存`MapMaper`总有一天会消失，算了。

* * *

例子很琐碎，只需创建

```
private final static Cache<String, String> cache =
    CacheBuilder.newBuilder().maximumSize(123).build(); 
```

然后试试这个：

```
cache.put("a", "A");
cache.put("b", "B");
System.out.println(cache.getIfPresent("a"));
for (int i=0; i<1000; ++i) cache.put("n" + i, "x");
System.out.println(cache.getIfPresent("a")); 
```

# matlab - 启用线条平滑会导致轴绘制错误

> ID：11909480
> 
> 赞同：0
> 
> 时间：2012-08-10T21:25:48.843
> 
> 标签：matlab, plot

在 Matlab 2011a 中，我正在绘制一条线，我使用参数`("LineSmoothing", 1)`使线看起来更漂亮，但它会导致 Y 轴和 X 轴消失。

![在此处输入图像描述](../Images/826d9d8fea9dfea1120239819d8ee7a5.png)

有人知道是什么原因造成的，更重要的是，如何解决？

我尝试了，`opengl('OpenGLLineSmoothingBug',1)`但它没有改变任何东西。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T10:50:10.767

未记录的[`LineSmoothing`](http://undocumentedmatlab.com/blog/plot-linesmoothing-property/)属性会导致图窗自动切换到使用 OpenGL 渲染器。实际上，您显示的错误会影响所有 OpenGL-rendererd 图形（无论此属性使用如何）。

示例：（在 WinXP 的 R2012a 上测试）

```
plot(1:10,'o-'), box on
set(gcf, 'Renderer','opengl') 
```

![截屏](../Images/5e13afa8a303796adba478acc7647513.png)

请注意执行第二行后框的顶部和右侧边框如何消失。

有一些[建议的](http://www.mathworks.com/support/solutions/en/data/1-5TS5P4/index.html) [解决方法](http://www.mathworks.com/support/solutions/en/data/1-5X41G7/index.html)。

# php - ZEND：将 XML 数据附加到 SQLDataBase(XML)

> ID：11909482
> 
> 赞同：0
> 
> 时间：2012-08-10T21:25:56.567
> 
> 标签：php, mysql, xml, zend-framework

我的问题：无法将 XML 数据附加到 MYSQL 数据库中的现有 XML 数据。

我有一个数组 - $buyer。这个数组里面是一个类似于 (shippingTotal => 55) 的 $key 和 $value。我想要做的是使用类似于

```
$param = array(
 'shippingTotal' => $shippingTotal
);
 $where['quote_data = ?'] = $quoteNumber
$n = $db->update('quote_xml', simplexml_load_string($param), $where); 
```

我的问题是 quote_data 中的当前数据是一个包含大量信息的 XML 元素。有什么方法可以将 shippingTotal “粘贴”到所述现有 XML 中？当我使用上面的代码时，我最终会得到 quote_data 变成空的。

我还创建了一个名为 $shippingTotal 的变量，这样我就不必使用 $buyer['shippingTotal']。仍然没有功能。

感谢您在此问题上的时间和帮助。亚伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:37:18.603

我看到了一些问题：

首先，`simplexml_load_string`不接受数组参数，只接受 XML 字符串。由于`$params`不是有效参数，因此它返回 boolean `false`。即使成功，它也会返回一个`SimpleXMLElement`. 要将其转换为 XML 字符串，您必须先调用`asXML()`返回对象的方法，然后再将其传递给`Zend_Db_Table::update()`.

其次，很可能 XML 不能仅仅“附加”到其他 XML。我不确切知道您的表包含什么，但需要以编程方式将 XML 添加到现有 XML 中。您不能附加 XML，因为您要添加的数据需要添加到适当的节点。

您需要做的是首先读取该列的值，使用 解析它，使用[SimpleXML 函数](http://www.php.net/manual/en/book.simplexml.php)`SimpleXML`之一将新数据添加到文档中的适当节点，然后执行更新。

希望有帮助。

# c# - 如何使用 C# BackgroundWorker 报告本机 C++ 代码的进度？

> ID：11909484
> 
> 赞同：-1
> 
> 时间：2012-08-10T21:26:01.263
> 
> 标签：c#, c++, visual-c++, interop

在我的 Visual Studio 解决方案中，我在 C# 中实现了 UI，在本机 C++ 中实现了一些代码。

我使用[BackgroundWorker 类](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)来实现执行长操作的报告进度。

如何使用`BackgroundWorker`本机 C++ 代码报告进度？

换句话说，如何将下面的 C# 代码重写为本机 C++ 并从 C# 调用获得的 C++ 代码？如果无法直接重写下面的代码，最好了解其他等效解决方案。谢谢。

```
class MyClass 
{
    public void Calculate(object sender, DoWorkEventArgs e)
    {
        BackgroundWorker worker = sender as BackgroundWorker;

        for (int i = 0; i < StepCount; i++)
        {
            if (worker.CancellationPending)
            {
                e.Cancel = true;
                break;
            }

            // code which handles current iteration here

            worker.ReportProgress((i + 1) * 100 / StepCount, 
                "Report progress message");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:34:35.047

~~在您的 C# 代码中，使用 DLLImport 属性声明您的本机 C++ 方法，并从您的`BackgroundWorker.ProgressChanged`处理程序中调用此方法。~~

免责声明：我没有测试过任何这段代码，这可能不是最好的方法，但至少在理论上我认为这是可行的。希望这里更有经验的成员之一可以验证这是否真的正确。

这假设您正在从 C# 启动后台工作程序，并且您想要`ProgressChanged`C# 中的事件（我假设是这种情况，因为您的 UI 在 C# 中）。

您仍然可以`BackgroundWorker`在 C# 中使用，但只需使用我上面提到的 DLLImport 调用您的本机方法。您还可以修改方法的签名以获取与签名匹配的函数指针，`ReportProgress`然后从您的本机代码调用该委托。

MSDN 有一些关于[编组委托和函数指针](http://msdn.microsoft.com/en-us/library/367eeye0.aspx)的文章（尽管示例都使用 C++/CLI）。您可能还想查看[DLLImport](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.dllimportattribute.aspx)和[MarshalAs](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshalasattribute.aspx)属性以及[UnmanagedType](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.unmanagedtype.aspx)枚举的文档。

例如，如果您的本机方法是

```
void foo(int arg1, BOOL arg2)
{
  // Your code here
} 
```

您将在本机代码中定义函数指针类型为

```
// Corresponds to void BackgroundWorker.ReportProgress(int progress, object state)
typedef void (*NativeReportProgress) (int, void*); 
```

并将您的本机签名更改为

```
void foo(int arg1, BOOL arg2, NativeReportProgress progressPtr)
{
  // Some code.
  progressPtr(progressValue, stateVar);
} 
```

你`DLLImport`的 for`foo`看起来像

```
// Delegate type for BackgroundWorker.ReportProgress
delegate void ReportProgressDelegate(int progress, object state);

// The MarshalAs attribute should handle the conversion from the .NET
// delegate to a native C/C++ function pointer.
[DLLImport]
void foo([MarshalAs(UnmanagedType.I4)] Int32 arg1, 
         [MarshalAs(UnmanagedType.Bool)] bool arg2, 
         [MarshalAs(UnmanagedType.FunctionPointer)] ReportProgressDelegate progressDel); 
```

然后你的工人看起来像

```
void DoWork(object sender, DoWorkEventArgs e)
{
  var worker = (BackgroundWorker)sender;
  // Notice that worker.ReportProgress is not followed the by ().
  // We're not actually calling the method here, we're just passing
  // a function pointer to that method into foo.
  foo(intArg, boolArg, worker.ReportProgress);
} 
```

希望这是有道理的（希望它也是正确的！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T23:56:40.427

示例如下。它在 x86 C# 和本机 Visual C++ 上进行了测试：

CppLayer.h：

```
 #ifdef CPPLAYER_EXPORTS
    #define CPPLAYER_API __declspec(dllexport)
    #else
    #define CPPLAYER_API __declspec(dllimport)
    #endif

    extern "C" {
        typedef void (__stdcall *ReportProgressCallback)(int, char *);
        typedef bool (__stdcall *CancellationPendingCallback)();

        struct CPPLAYER_API WorkProgressInteropNegotiator 
        {
            ReportProgressCallback progressCallback;
            CancellationPendingCallback cancellationPending;
            bool cancel;
        };

        CPPLAYER_API void __stdcall CppLongFunction(WorkProgressInteropNegotiator& negotiator);
    } 
```

CppLayer.cpp：

```
#include "stdafx.h"
#include "CppLayer.h"

#include <iostream>

extern "C"
{
    // This is an example of an exported function.
    CPPLAYER_API void __stdcall CppLongFunction(WorkProgressInteropNegotiator& negotiator)
    {
        const int STEP_COUNT = 12;

        char * messages[3] = {"ONE", "TWO", "THREE"};

        for (int i = 0; i < STEP_COUNT; i++)
        {
            Sleep(100);

            if (negotiator.cancellationPending()) {
                negotiator.cancel = true; 
                break;
            }

            std::cout << "Calculate " << i << std::endl;
            negotiator.progressCallback((i + 1) * 100 / STEP_COUNT, messages[i % 3]);
        }
    }

}; 
```

与 C++ 代码互操作的 C# 类：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Runtime.InteropServices;
using System.ComponentModel;
using System.Threading;

namespace CSharpLayer
{
    class SandboxCppProgress
    {
        public delegate void ReportProgressCallback(int percentage, string message);

        public delegate bool CancellationPendingCallback();

        [StructLayout(LayoutKind.Sequential)]
        public class WorkProgressInteropNegotiator
        {
            public ReportProgressCallback reportProgress;
            public CancellationPendingCallback cancellationPending;

#pragma warning disable 0649
            // C# does not see this member is set up in native code, we disable warning to avoid it.
            public bool cancel;
#pragma warning restore 0649
        }

        [DllImport("CppLayer.dll")]
        public static extern void CppLongFunction([In, Out] WorkProgressInteropNegotiator negotiator);

        static void CSharpLongFunctionWrapper(object sender, DoWorkEventArgs e)
        {
            BackgroundWorker bw = sender as BackgroundWorker;

            WorkProgressInteropNegotiator negotiator = new WorkProgressInteropNegotiator();

            negotiator.reportProgress = new ReportProgressCallback(bw.ReportProgress);
            negotiator.cancellationPending = new CancellationPendingCallback(() => bw.CancellationPending);

            // Refer for details to
            // "How to: Marshal Callbacks and Delegates Using C++ Interop" 
            // http://msdn.microsoft.com/en-us/library/367eeye0%28v=vs.100%29.aspx
            GCHandle gch = GCHandle.Alloc(negotiator);

            CppLongFunction(negotiator);

            gch.Free();

            e.Cancel = negotiator.cancel;
        }

        static EventWaitHandle resetEvent = null;

        static void CSharpReportProgressStatus(object sender, ProgressChangedEventArgs e)
        {
            string message = e.UserState as string;
            Console.WriteLine("Report {0:00}% with message '{1}'", e.ProgressPercentage, message);

            BackgroundWorker bw = sender as BackgroundWorker;
            if (e.ProgressPercentage > 50)
                bw.CancelAsync();
        }

        static void CSharpReportComplete(object sender, RunWorkerCompletedEventArgs e)
        {
            if (e.Cancelled)
            {
                Console.WriteLine("Long operation canceled!");
            }
            else if (e.Error != null)
            {
                Console.WriteLine("Long operation error: {0}", e.Error.Message);
            }
            else
            {
                Console.WriteLine("Long operation complete!");
            }
            resetEvent.Set();
        }

        public static void Main(string[] args)
        {
            BackgroundWorker bw = new BackgroundWorker();
            bw.WorkerReportsProgress = true;
            bw.WorkerSupportsCancellation = true;
            bw.ProgressChanged += CSharpReportProgressStatus;
            bw.DoWork += CSharpLongFunctionWrapper;
            bw.RunWorkerCompleted += CSharpReportComplete;

            resetEvent = new AutoResetEvent(false);

            bw.RunWorkerAsync();

            resetEvent.WaitOne();
        }
    }
} 
```

以下链接可能有用：

*   [与本机库互操作（单声道）](http://www.mono-project.com/Interop_with_Native_Libraries)
*   [如何：使用 C++ 互操作封送回调和委托](http://msdn.microsoft.com/en-us/library/367eeye0%28v=vs.100%29.aspx)
*   [如何：使用 PInvoke 封送函数指针](http://msdn.microsoft.com/en-us/library/ektebyzx%28v=vs.100%29.aspx)

# java - 如何比较两个像素颜色

> ID：11909489
> 
> 赞同：0
> 
> 时间：2012-08-10T21:26:34.600
> 
> 标签：java, compare

我正在编写一个打开程序并等待它加载的程序。加载时，中间有一个加载栏，屏幕的其余部分是黑色的。

我想要它做的是检查颜色，比如 1200 和 300，将其保存为变量，然后每隔 1 秒检查两者是否相同，当它们不同时，继续其余的代码。

我该怎么做呢？

编辑：有人可以提供一些有效的代码吗？

```
BGC = robot.getPixelColor(1200, 300);
 System.out.println(robot.getPixelColor(1200, 300));

        int counter = 1;
    while (counter < 10){
        System.out.println(robot.getPixelColor(1200, 300));
        if (BGC == robot.getPixelColor(1200, 300)){
            Thread.sleep(2000);
            System.out.println("Colors Match");
        } else{
            System.out.println("Colors Dont Match");
        }
        counter++;
    } 
```

此代码生成颜色不匹配的结果，以及明显匹配的颜色...帮助._。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:04:15.057

为什么不使用机器人类 (getPixelColor(x,y)) 来检查像素颜色？但如前所述，不确定这是你应该如何去做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:37:35.000

[http://www.javalobby.org/forums/thread.jspa?threadID=16400&tstart=0](http://www.javalobby.org/forums/thread.jspa?threadID=16400&tstart=0)

[http://www.daniweb.com/software-development/java/code/216988/java-code-to-capture-your-screen-as-image](http://www.daniweb.com/software-development/java/code/216988/java-code-to-capture-your-screen-as-image)

这里有两个链接描述了如何在 Java 中进行屏幕截图并将其保存为 BufferedImage。

[http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/image/BufferedImage.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/image/BufferedImage.html)

这是 BufferedImage 类的文档

所以你想做的是这样的：

1.  运行程序
2.  截图
3.  使用文档中描述的一些方法检查 RGB 值
4.  与旧值相比，是否相同？如果是，则返回 2，否则返回 5
5.  程序的其余部分

但是，我不确定这是否是您应该做的。您要解决的问题到底是什么？

# ruby-on-rails - 在 register.com 上部署一个 ruby /rails 站点

> ID：11909490
> 
> 赞同：0
> 
> 时间：2012-08-10T21:26:37.897
> 
> 标签：ruby-on-rails, ruby

我是 Rails 新手，也是 Web 开发的新手。Anywho，我已经完全开发了一个使用 js、jquery 和 rails 的网站，现在我希望使用 register.com 作为它的主机，但是我对如何去做这件事有点困惑。可能与 register.com 和 rails 打过交道的人能否为我提供一些关于如何解决此问题的见解。

感谢并抱歉我只是对如何将我的项目从我的计算机移动到 register.com 感到困惑的问题的模糊性

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:33:29.507

我建议改用 heroku.com。Register.com 适用于静态网页，而不是 Web 应用程序。Heroku 可以免费托管您的应用程序，除非您需要更多资源。您只需要购买一个域名。看看这个！

# c# - 从绑定中删除验证

> ID：11909496
> 
> 赞同：1
> 
> 时间：2012-08-10T21:27:13.990
> 
> 标签：c#, wpf, validation, binding

我有一个文本框，我只想根据复选框值验证其文本。检查时使用验证，未检查时不验证。

我可以让它验证得很好，并且红色框出现在它周围，但是当我不想验证它时，文本框周围的红色框仍然存在。我尝试清除文本框上的绑定，但没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:01:31.877

在您的情况下，您需要实现自定义验证，如下所示：

```
public class TestModel : ValidationRule
{
    public bool IsChecked { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }

    public override ValidationResult Validate(object value, System.Globalization.CultureInfo cultureInfo)
    {
        if (IsChecked)
        {
            if (string.IsNullOrEmpty(FirstName))
            {
                return new ValidationResult(false, "FirstName requierd.");
            }
        }
        return new ValidationResult(true, null);
    }
} 
```

希望这有帮助。

# ios - 缩小 UIImage

> ID：11909502
> 
> 赞同：1
> 
> 时间：2012-08-10T21:28:00.360
> 
> 标签：ios, uiimage

如何将 UIImage 在两个维度上平均缩小一半？

我有一个 UIImage 是 UIImageView 大小的两倍，并且希望它具有相同的大小，而不使用任何内容模式来填充或缩放等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T21:41:01.733

只需为自己制作一个新图像（表示为 UIImage 的类别方法）：

```
- (UIImage*)scaleToSize:(CGSize)size {
    UIGraphicsBeginImageContext(size);

    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextTranslateCTM(context, 0.0, size.height);
    CGContextScaleCTM(context, 1.0, -1.0);

    CGContextDrawImage(context, CGRectMake(0.0f, 0.0f, size.width, size.height), self.CGImage);

    UIImage* scaledImage = UIGraphicsGetImageFromCurrentImageContext();

    UIGraphicsEndImageContext();

    return scaledImage;
} 
```

# linux - 开放调用错误地设置了 POSIX 共享内存和信号量权限

> ID：11909505
> 
> 赞同：7
> 
> 时间：2012-08-10T21:28:24.063
> 
> 标签：linux, posix, ipc, file-permissions, shared-memory

我正在尝试创建一个将由多个进程使用的共享内存，这些进程不一定由同一个用户启动，因此我使用以下行创建段：

`fd = shm_open(SHARE_MEM_NAME,O_RDWR | O_CREAT,0606);`

但是，当我检查在 /dev/shm 中创建的文件的权限时，它们是：

`-rw----r-- 1 lmccauslin lmccauslin 1784 2012-08-10 17:11 /dev/shm/CubeConfigShare` 不像`-rw----rw-`我预期的那样。

/dev/shm 的权限是 lrwxrwxrwx。

同样的事情发生在同样创建的信号量上。

内核版本：3.0.0-23-generic

glibc 版本：EGLIBC 2.13-20ubuntu5.1

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-10T21:51:39.377

大概是吧[`umask`](http://linux.die.net/man/2/umask)。

引用手册[页`shm_open`](http://linux.die.net/man/3/shm_open)：

```
 O_CREAT    Create  the  shared memory object if it does not exist.  The user and
              group ownership of the object are taken from the corresponding effec‐
              tive IDs of the calling process, and the object's permission bits are
              set according to the low-order 9 bits of mode, except that those bits
              set in the process file mode creation mask (see umask(2)) are cleared
              for the new object.  A set of macro constants which can  be  used  to
              define  mode  is  listed  in open(2).  (Symbolic definitions of these
              constants can be obtained by including <sys/stat.h>.) 
```

因此，为了允许创建全局可写文件，您需要设置一个允许它的 umask，例如：

```
umask(0); 
```

像这样设置，`umask`不会再影响对创建文件的任何权限。但是，您应该注意，如果您随后创建另一个文件而不明确指定权限，那么它也将是全局可写的。

因此，您可能只想暂时清除 umask，然后将其恢复：

```
#include <sys/types.h>
#include <sys/stat.h>

...

void yourfunc()
{
    // store old
    mode_t old_umask = umask(0);

    int fd = shm_open(SHARE_MEM_NAME,O_RDWR | O_CREAT,0606);

    // restore old
    umask(old_umask);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-12T08:54:53.573

据我了解，POSIX 信号量是在共享内存中创建的。所以你需要确保用户有

`rw permissions to /dev/shm for the semaphores to be created.`

然后，作为一个方便的选项，将以下行放入您的 /etc/fstab 文件以挂载 tmpfs：

**无 /dev/shm tmpfs 默认值 0 0**

这样当您的机器**重新启动**时，权限就从一开始就设置好了。

三个中的两个将 /dev/shm 设置为 drwxrwxrwx，而不允许创建信号量的机器将其设置为 drwxr_xr_x。
您还可以查看共享内存限制：

------ 共享内存限制--------
`max number of segments = 4096`
`max seg size (kbytes) = 18014398509465599` `max total shared memory (kbytes) = 18446744073642442748`
`min seg size (bytes) = 1`

# protobuf-net - protobuf-net 中是否有可扩展机制来控制原始反序列化？

> ID：11909520
> 
> 赞同：2
> 
> 时间：2012-08-10T21:29:54.197
> 
> 标签：protobuf-net

我们正在使用 protobuf-net 序列化和反序列化深度对象图。这些图的某些成员实际上在许多图上一遍又一遍地重复，就像与少数对象的多对一关系一样。例如，一个*Sale*对象是一个图，它的*Store*成员（可能是它自己的一个子图）将只是 10 个可能的商店中的一个，因此它会在许多消息中一遍又一遍地重复（*销售*图）。

如果我们能够以某种方式缓存这些对象的序列化，我们可以获得明显的性能优势。理想情况下，我们想告诉*RuntimeModel*某些类型 - 在本例中为*Store* - 应该通过一个可扩展点来处理，就像代理一样，但是我们能够提供原始序列化字节。

我们的限制之一是生成的消息仍应与 protobuf-net 兼容，以便在没有这些“钩子”的情况下由其他平台（例如 Python）中的客户端直接解析（Python 客户端的螺丝性能优化！）。

我们查看了代理项，但看起来无论代理项产生什么（在我们的例子中，这将是一个*字节*[] 数组）（如您所料）仍然会被序列化为它的类型（即作为一个 *字节*[] 数组）因此与Python 客户端期望的*Store*对象不兼容。

我们还研究了扩展，即使我们以某种方式在一个额外的字段中破解了缓存的序列化*存储*，我们也会回到 Python 客户端。

对于这种情况，我们可能会使用任何其他可扩展性机制吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T07:39:34.247

哦，有趣。确实，python 要求偏离了我*要说*的内容（参考跟踪）。您*可以*做的是*首先*将它们序列化为 a `byte[]`each （通过`MemoryStream`），然后将该数据作为`byte[]`成员包含（ a 和原始对象之间没有区别`byte[]`- 外部客户端不会注意到任何差异），但想法发生了在大多数情况下，这不会比保持对象模型“原样”并多次序列化一些节点（序列化不是很慢）快得多。

不过，坦率地说，我会考虑以不同的方式存储它 - 因此，我不会将存储存储为子节点，而是将它们唯一地作为顶级节点一次，并将一些唯一标识符存储为查找（不是子对象本身）。不过，这会改变布局。

不，没有内置任何东西来支持这一点，我不确定它是否是支持的关键场景。

# r - Mac 10.8 上的 Rcpp 安装失败

> ID：11909522
> 
> 赞同：2
> 
> 时间：2012-08-10T21:29:58.273
> 
> 标签：r, rcpp

Rcpp 无法为我安装。当我在 R 控制台（Mac 10.8 上的 R 2.15.1）中运行以下命令时：

`install.packages("Rcpp")`

我收到以下错误：

```
/usr/bin/clang++ -I/usr/local/Cellar/r/2.15.1/R.framework/Resources/include \
       -DNDEBUG -I../inst/include/ -I/usr/local/Cellar/readline/6.2.4/include \
       -isystem /usr/local/include -I/opt/X11/include    -fPIC  -Os -w -pipe - \
       march=native -Qunused-arguments -mmacosx-version-min=10.8  \
       -c exceptions.cpp -o exceptions.o

exceptions.cpp:82:14: fatal error: 'bits/exception_defines.h' file not found 
#include <bits/exception_defines.h>
        ^
1 error generated.
make: *** [exceptions.o] Error 1
ERROR: compilation failed for package ‘Rcpp’ 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-10T21:38:49.477

哪个版本的 Rcpp？这在 SVN 中是固定的：

> ```
> 2012-07-06  Dirk Eddelbuettel  <edd@debian.org>
> 
>         * inst/include/Rcpp/config.h: In order to not attempt to include
>         exception_defines.h if on OS X (as the clang runtime may not have
>         predictable access to g+++ headers providing these), do not define
>         RCPP_HAS_DEMANGLING which is used in src/exceptions.cpp 
> ```

并在 rcpp-devel 列表中进行了讨论。

我试图适应 OS X 和 clang >= 3.0，但是 clang 和 g++ 的交互有点棘手。尝试[从 SVN 获取文件](https://r-forge.r-project.org/scm/viewvc.php/pkg/Rcpp/inst/include/Rcpp/config.h?view=markup&root=rcpp)或仅编辑其中的部分以产生

```
#ifdef __GNUC__
  // from http://sourceforge.net/apps/mediawiki/predef/index.php?\  
  //              title=Operating_Systems#MacOS
  #ifndef __APPLE__ 
    #ifndef __MACH__
      #define RCPP_HAS_DEMANGLING
    #endif
  #endif
#endif 
```

这会为所有 OS X 实例关闭此功能。

# java - Spring、JPA 和 Hibernate - id 生成

> ID：11909523
> 
> 赞同：0
> 
> 时间：2012-08-10T21:30:19.767
> 
> 标签：java, hibernate, jpa

设置：Sprting、JPA 和 Hibernate 作为 JPA 提供者。

我们有两个类层次结构，一个用于问题，另一个用于答案。在每个层次结构的根部都有一个抽象类，例如：

```
@Entity
@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)
public abstract class QuestionUnit {

    @Id
    @GeneratedValue(strategy = GenerationType.TABLE)
    private int id;
    @OneToOne(cascade = CascadeType.ALL)
    private AnswerUnit correctAnswer;

    public QuestionUnit(AnswerUnit correctAnswer) {
        this.correctAnswer = correctAnswer;
    }

    public void setCorrectAnswer(AnswerUnit correctAnswer) {
        this.correctAnswer = correctAnswer;
    }

    public AnswerUnit getCorrectAnswer() {
        return this.correctAnswer;
    }

    public int getId() {
        return id;
    }

    public abstract Object getQuestionContent();
} 
```

和

```
@Entity
@Inheritance(strategy=InheritanceType.TABLE_PER_CLASS)
public abstract class AnswerUnit {

    @Id
    @GeneratedValue(strategy = GenerationType.TABLE)
    private int id;

    public abstract Object getAnswerContent();

    public abstract boolean isEqual(AnswerUnit otherAnswer);

    public int getId(){
        return id;
    }
} 
```

在每个层次结构中都有 3 个具体类。我们想将它们存储在数据库中，现在我们使用的是 SQLite。

如果我理解正确，这个继承策略将为每个具体类创建一个表。

现在，当我在 auto 设置 GeneratedValue 策略时出现错误，所以我将其切换到 table。如果我理解正确，对于每个表都会有不同的独立代号。

但是奇怪的事情发生了。我创建了简单的测试代码：

```
QuestionUnit unit1=new OpenQuestion("4+4", new OpenQuestionAnswer("8"));
questionUnitDao.addQuestionUnit(unit1);
System.out.println(questionUnitDao.getQuestionUnit(OpenQuestion.class, 1).getQuestionContent()); 
```

第一个问题已成功插入，但后来我得到一个错误，即主键应该是唯一的，现在当我插入一些东西时，我得到非常大的数字作为 id，例如 65536。

为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T05:07:44.420

您可以在两个实体中添加 TableGenerator 注释。参见示例；

```
 @Id
  @TableGenerator(name = "QuestionUnitGen",
  table = "ID_GEN",
  pkColumnName = "GEN_NAME", 
  pkColumnValue = "QuettionUnit_Gen", 
  valueColumnName = "GEN_VAL", 
  initialValue = 0,
  allocationSize = 100
  )
  @GeneratedValue(strategy = GenerationType.TABLE, generator = "QuestionUnitGen")
  private int id; 
```

但不要忘记在您的数据库中创建包含两个字段 GEN_NAME 和 GEN_VAL 的 ID_GEN 表。

# ruby-on-rails - 为什么不推荐 Rails 传统路由匹配？

> ID：11909524
> 
> 赞同：1
> 
> 时间：2012-08-10T21:30:24.990
> 
> 标签：ruby-on-rails

默认路由文件有以下部分：

```
 # This is a legacy wild controller route that's not recommended for RESTful applications.
  # Note: This route will make all actions in every controller accessible via GET requests.
  # match ':controller(/:action(/:id))(.:format)' 
```

那么当格式为 ':controller(/:action(/:id))(.:format)' 时让 Rails 假定控制器、动作和视图显示的问题到底是什么？我的意思是，对于更具体的事情，比如嵌套，我总是可以使用特定的路线......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:35:10.537

这只是一种常识性的安全措施。

它强制设计者将 GET 请求列入白名单，以便应用不会无意中将表或记录的内容泄露给恶意用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:39:00.473

如果允许开发人员偷懒，他们就会偷懒。我们非常擅长优化工作。

每次使用新控制器时，不明确路由可能会帮助您节省 5 秒，但这对于新开发人员来说会很头疼，因为他们不熟悉您的代码库，因此不知道事情是如何粘合的。他们将不得不对您的视图控制器进行逆向工程。

在那里。不漂亮。

直言不讳通常更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-18T10:28:42.770

因为不是每个人都在构建下一个 Facebook，我们中的一些人这样做是为了好玩，或者是为了制作我们只在我们的开发设备上使用的简单应用程序，或者根本不做蠢事并用实际上有答案的问题来“回答”问题，而是让自己看起来非常聪明和重要：

```
match '/:controller(/:action(/:id))(.:format)', to: "#{:controller}#{:action}", via: [:get, :post] 
```

# android - 在 XML 文件中定义变量

> ID：11909526
> 
> 赞同：1
> 
> 时间：2012-08-10T21:30:48.807
> 
> 标签：android, xml

我有一个带有 5 个文本视图的 XML 文件，它们都具有相同的 textSize。目前，我这样定义大小：

`android:textSize="30dp"`

但是，我想要一种快速的方法来应用类似的东西：

`android:textSize="text_size"`

其中 textSize 将是我在某处定义的变量，并且可以在我的 XML 文件中的任何位置使用。我尝试在 Android 项目的 strings.xml 文件中定义这些变量，并像这样调用它们：

`android:textSize="@string/text_size"`

它将在 strings.xml 中这样定义的位置

`<string name="text_size">30dp</string>`

它在 Ecpise 本身中运行良好，并且在图形布局中显示得很好。但是当我尝试在手机上运行该应用程序时，它崩溃了。

那么，有没有办法在我的 XML 布局文件中定义变量？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T21:44:31.550

您将其放入的想法`strings.xml`很接近，但需要在维度 XML 文件中设置这些值。文档在[这里](https://developer.android.com/guide/topics/resources/more-resources.html#Dimension)。

使用您的示例，您可以创建一个名为`res/values/my_dimens.xml`. 然后放进去

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <dimen name="my_text_size">30dp</dimen>
</resources> 
```

然后在你的布局中使用它，只需设置

```
android:textSize="@dimen/my_text_size" 
```

# vba - Excel VB 宏用于比较工作表并将结果输出到另一张工作表

> ID：11909527
> 
> 赞同：1
> 
> 时间：2012-08-10T21:31:05.580
> 
> 标签：vba, excel

我正在使用此处的宏：[http](http://answers.yahoo.com/question/index?qid=20060906110734AA9t2l9) ://answers.yahoo.com/question/index?qid= 20060906110734AA9t2l9 突出显示差异。但是，当有 50000 行时，其中只有 2 行不同，这是大海捞针的问题。

我想要做的是在单独的表格中查看差异，并排更改之前和之后。对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:10:38.427

对现有代码的小补充：

```
Sub Compare_Sheets()

Dim v1,v2
Dim diffRow as long

Set From_WS = Workbooks("Book1").Worksheets("Sheet1")
Set To_WS = Workbooks("Book2").Worksheets("Sheet2")
Set diffWS = Thisworkbook.Sheets("Diff")

diffRow = 1

With From_WS.Cells(1, 1).CurrentRegion
    Total_Rows = .Rows.Count
    Total_Columns = .Columns.Count
End With

For Rows_Counter = 1 To Total_Rows
For Column_Counter = 1 To Total_Columns
v1 = Trim(LCase(From_WS.Cells(Rows_Counter, Column_Counter).Value))
v2 = Trim(LCase(To_WS.Cells(Rows_Counter, Column_Counter).Value)) 

If v1 <> v2 Then
    From_WS.Cells(Rows_Counter, Column_Counter).Interior.ColorIndex = 4
    To_WS.Cells(Rows_Counter, Column_Counter).Interior.ColorIndex = 5

    With diffWS.Rows(diffRow)
        .Cells(1).value=From_WS.Cells(Rows_Counter, Column_Counter).Address()
        .Cells(2).value = v1
        .Cells(3).value= v2
        diffRow = diffRow + 1
    End With

End If

Next Column_Counter
Next Rows_Counter

End Sub 
```

# c++ - 数组的第一个字符填充了不正确的数据 C++

> ID：11909535
> 
> 赞同：1
> 
> 时间：2012-08-10T21:31:34.520
> 
> 标签：c++, arrays, global

在头文件中，我声明了一个具有数组和数组长度的结构，如下所示：

```
typedef struct {
    unsigned char *frame;
    int length;
} ResponseFrame ;

extern ResponseFrame rf; 
```

在我的主文件中，我有以下内容：

```
ResponseFrame rf;

int main(void)
{
   while(1) {
      if (receive() == 0x01) {
         uint8_t val;
         rf.length = 6;
         for(int i = 0; i < 6; i++){
            val = receive();
            rf.frame[i] = val;
            transmit(val);            // LINE 1
         }

         for (uint8_t i=0; i<rf.length; i++){
            transmit(rf.frame[i]);    // LINE 2
         }
      }
   }
} 
```

我收到的数组是

```
{ 00 00 FF 00 FF 00 } 
```

初始传输用这个接收到的数据做出响应[见第 1 行]。但是，当我尝试使用全局变量 rf.frame [参见第 2 行] 进行传输时，第一个值与此不同----

```
{ 13 00 FF 00 FF 00 } 
```

为什么第一个初始值这样不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:34:20.537

您从不为 分配任何内存`ResponseFrame.frame`，因此您遇到了未定义的行为。

您假设通过做`rf.length = 6;`，大小会`unsigned char *frame;`以某种方式神奇地增加，但事实并非如此。

如果您确定尺寸，则需要：

```
rf.length = 6;
rf.frame = malloc(sizeof(unsigned char) * 6);   //for C 
```

或`std::vector`在 C++ 中使用 a 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:35:02.303

部分问题可能在于它似乎依赖于未定义的行为。它看起来（从显示的代码）`frame`从未初始化。如果是固定大小，可以声明为：

```
unsigned char frame[6]; 
```

否则，它可能需要调用来`malloc`为其分配内存。

# entity-framework - Entity Framework 5 的新迁移功能是否完全支持枚举更改？

> ID：11909537
> 
> 赞同：11
> 
> 时间：2012-08-10T21:31:38.383
> 
> 标签：entity-framework, enums, migration, .net-4.5, entity-framework-5

假设我们有以下简单模型：

```
public class Car
{
    public int Year { get; set; }
    public string Make { get; set; }
    public string Model { get; set; }
    public CarType Type { get; set; }
}

public enum CarType
{
    Car, Truck
} 
```

实体框架在向数据库添加新`Car`对象时，会将`CarType`枚举值存储为整数。

如果我们`CarType`以整数值更改的方式更改枚举（更改顺序或添加/删除值），**Entity Framework 是否知道如何使用 Migrations 正确处理数据迁移？**

* * *

例如，假设我们添加了另一个值`CarType`：

```
public enum CarType
{
    Car, Truck, Van
} 
```

这对数据库中的现有数据没有实际影响。`0`还在`Car`，`1`现在还在`Truck`。但是如果我们改变 的顺序`CarType`，像这样：

```
public enum CarType
{
    Car, Van, Truck
} 
```

`1`使用as`CarType`指定的数据库记录`Truck`是不正确的，因为根据更新的模型`1`是 now `Van`。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T20:34:07.077

不，迁移**不**完全支持枚举更改，因为它不会更新数据库值以反映更改的顺序、添加或删除等更改。

在保留顺序的同时添加枚举值将无效。事实上，它甚至不会触发模型支持更改错误。

如果`CarType`枚举的顺序发生变化，那么数据库数据实际上是无效的。原始`int`值被保留，但枚举结果将是错误的。

为了适应这种类型的变化，需要手动处理数据库数据。在此特定示例中，必须运行自定义 SQL，以`Type`根据枚举更改更改列的值：

```
public partial class CarTypeChange : DbMigration
{
    public override void Up()
    {
        // 1 now refers to "VAN", and 2 now refers to "Truck"
        Sql("Update cars Set [Type] = 2 Where [Type] = 1");
    }

    public override void Down()
    {
        Sql("Update cars Set [Type] = 1 Where [Type] = 2");
    }
} 
```

* * *

附录：我问过另一个与此相关的问题：[Handling enum changes in Entity Framework 5](https://stackoverflow.com/questions/11942078/handling-enum-changes-in-entity-framework-5)

# javascript - facebook评论插件是如何工作的？

> ID：11909539
> 
> 赞同：0
> 
> 时间：2012-08-10T21:31:47.253
> 
> 标签：javascript, facebook, plugins, comments

我想了解使用 javascript 脚本和 div 标签插入网页内的 facebook 评论插件是如何工作的。

如果我尝试猜测（并使用萤火虫），javascript 部分会加载一个插入到 div 部分内的 iframe。

我的问题是，每个人都可以放置不一定与网页内容相关的评论提要！建议我是 example.com，我如何确定 example.org 没有使用我的 example.com facebook 评论？

Disqus 的工作方式是否类似？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T01:57:47.330

在 IFRAME 中加载的 facebook url 可以访问该`REFERRER`URL（在这种情况下是加载页面）并使用它来检查域。

# dojo - 如何从 Dojo 拖放源中移除/删除项目？

> ID：11909540
> 
> 赞同：0
> 
> 时间：2012-08-10T21:31:54.593
> 
> 标签：dojo, drag-and-drop, dojo-dnd

我有以下 Dojo DnD，但我不知道如何从`catalog`源中删除和添加项目。我最终想要做的是允许用户：

1.  将项目从...`catalog`拖到`wishlist`...这工作正常。
2.  通过单击**清除列表**按钮删除`catalog`未移动到的任何剩余项目...在此处需要帮助。`wishlist`
***   能够`catalog`通过单击下面代码中未列出的另一个按钮来添加新项目...这里需要帮助。**

 **总而言之，我需要知道如何从 中删除项目和添加项目`catalog`，并将任何移动的项目保留在`wishlist`.

```
dojo.addOnLoad(function() {
    require([ "dojo/dom-class", "dojo/dnd/Source", "dijit/form/Button", "dojo/domReady!" ], function(domClass, Source){
        var catalog = new Source("catalogNode");
        catalog.insertNodes(false, [
            { data: "Bushmaster <div id='5' style='display:none;'>5</div>"},
            { data: "Colt <div id='4' style='display:none;'>4</div>"},
            { data: "DPMS <div id='6' style='display:none;'>6</div>"},
            { data: "Glock <div id='2' style='display:none;'>2</div>"},
            { data: "Kahr Arms <div id='7' style='display:none;'>7</div>"},
            { data: "Marlin <div id='3' style='display:none;'>3</div>"},
            { data: "Remington <div id='78' style='display:none;'>78</div>"},
            { data: "Rock River Arms <div id='1' style='display:none;'>1</div>"},
            { data: "Smith & Wesson <div id='105' style='display:none;'>105</div>"}
        ]);
        catalog.forInItems(function(item, id, map){
            domClass.add(id, item.type[0]);
        });

        var wishlist = new Source("wishlistNode");

        new dijit.form.Button({
            label: "Clear List",
            onClick: function() {
                alert("Clearing Items");
            }
        },
        "clearListBtn");
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T21:19:56.597

删除源中的所有（剩余）元素：

```
// e.g., var catalog = new Source("catalogNode");
catalog.selectAll().deleteSelectedNodes(); 
```

可以随时使用相同的方法添加新项目`insertNodes()`：

```
catalog.insertNodes(false, additionalData); 
```**

# windows-8 - 为什么我无法访问 System.IO 命名空间中的 IsolatedStorage？

> ID：11909541
> 
> 赞同：5
> 
> 时间：2012-08-10T21:31:58.400
> 
> 标签：windows-8, microsoft-metro, windows-runtime, isolatedstorage

我在 Windows 8 Release Preview 上运行 VisualStudio 2012 RC。

我使用我的“live”又名“outlook”ID 登录到 Win8。

我创建了一个新的 Windows Metro Style 项目。当我尝试使用 System.IO.IsolatedStorage 时，Visual Studio 告诉我缺少参考。但是当我去引用时，没有什么要添加的，它说默认添加了所有引用。

现在据我所知，IsolatedStorage 是 mscorlib.dll 的一部分，因此不太可能“丢失”。

我错过了什么？

谢谢和问候， 苏米特。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T22:13:31.203

隔离存储不是用于 WinRT 的 .Net 的一部分。您将不得不使用 Windows.Storage。

[http://msdn.microsoft.com/en-us/library/windows/apps/br230302%28v=vs.110%29.aspx#storage](http://msdn.microsoft.com/en-us/library/windows/apps/br230302%28v=vs.110%29.aspx#storage)

# c - 转发代理检测 FIN 数据包

> ID：11909543
> 
> 赞同：0
> 
> 时间：2012-08-10T21:31:59.683
> 
> 标签：c, linux, proxy, network-programming

我写了一个转发代理。我将它用于windows和linux。我确实需要根据操作系统进行更改。但是，我不断看到一些加薪条件。大多数情况下，我相信它们是由于我在猜测哪个是最后一个数据包（FIN sigal）时的误解。目前我确实选择了一组套接字。无论哪个套接字发出信号，我都会对其进行 read() 。如果 read 返回 0，那么我认为它是一个 FIN 数据包，然后我关闭该套接字。是否会发生我的 read() 给出非零值。但是该数据包确实包含 FIN（我认为它可能会发生）。因此，尽管某些套接字已关闭，但我不会关闭它们。我不确定代理如何检测哪个套接字已关闭？或者是已建立连接上的最后一个数据包。

我的代码如下所示：

我从客户那里接受了 100 个 fds。我将它们存储为一个数组`sock_array[total_size]`。

```
select(copy_of_sock_array,timeout)                                                          
for(int cnt=0;cnt<total_size;cnt++)                                                          
{                                                                                            
   if(FD_ISSET(sock_array[cnt],sock_array))                                                  
   {
            ret = recv(sock_array[cnt],buffer,len);                                          
            if(ret<=0){                                                                      
                /*This must be a FIN packet */                                               
                /* Close corresponding socket which is opened with outer world */            
                close(/*corresponding socket*/);                                                                      
            }                                                                                  
   }                                                                                          
} 
```

这看起来好吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:45:42.237

您需要进行非阻塞读取，并继续从套接字读取，直到获得指示您应该停止读取的返回值。

```
ssize_t r = 0;
for (;;) {
    r = recv(sock, buf, bufsz, MSG_DONTWAIT);
    if (r <= 0) {
        if (r < 0 && errno == EINTR) {
            continue;
        }
        break;
    }
    /* ... handle data in buf .. */
}
if (r < 0) {
    if (errno == EAGAIN) {
        /* ... wait in select again ... */
    } else {
        /* ... handle error ... */
    }
} else {
    /* got FIN */
} 
```

请注意，仅仅因为收到 FIN 并不一定意味着应该关闭连接。FIN 仅表示不再发送数据，但对等方可能仍愿意接受更多数据。这可能发生在客户端只需要一个响应的 HTTP 中，因此它会在请求后传递一个 FIN。它仍然希望收到响应。

您的代理可能有两个套接字，例如 sock1 和 sock2。因此，在 sock1 上收到 FIN 应该意味着该指示在已在其上排队的任何数据已被传递之后被转发到 sock2（并且镜像也是如此）。您可以使用 转发 FIN `shutdown`。

```
shutdown(sock2, SHUT_WR); 
```

当从 sock1 和 sock2 收到 FIN 时，您可以调用`close`两个套接字。

所以解决你的问题。

> 是否会发生我的 read() 给出非零值。但是该数据包确实包含 FIN（我认为它可能会发生）。

是的，这可能会发生。这就是为什么你继续阅读直到你得到停止的指示。好吧，从技术上讲，您不必这样做。如果您遇到每个连接的公平性问题，您可以将其推迟到处理完其他连接。但是，在进入选择等待之前，您需要返回并完成阅读。

> 因此，尽管某些套接字已关闭，但我不会关闭它们。我不确定代理如何检测哪个套接字已关闭？或者是已建立连接上的最后一个数据包。

正如我所描述的，作为一个（透明的）代理，一旦你在其上转发了一个 FIN 并且收到了一个 FIN，就可以安全地关闭套接字。如果您不是透明代理，那么您将遵循一组不同的规则，因为在这种情况下您确实是客户端的服务器。因此，只要您正在实施的应用程序协议允许您这样做，您就可以关闭套接字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T22:30:53.567

套接字具有明确定义的行为。如果您收到数据并在此之后关闭连接，您将需要两个 read()。第一个将返回数据，第二个将返回 0，表示连接结束。

在系统调用返回 0 之前，您必须一直阅读。

而且您不需要非阻塞读取来检测这一点！

# haskell - (,) 是如何在内部定义的？

> ID：11909545
> 
> 赞同：6
> 
> 时间：2012-08-10T21:32:01.617
> 
> 标签：haskell

重新定义函数很简单

```
(,) :: a -> b -> (a,b)
(,) a b = (a,b) 
```

奇怪的（对我来说）是这个函数是为任意长度的元组定义的。因此，例如，实际上有一个函数：

```
(,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,) :: a -> b -> c -> ... -> (a,b,c,...) 
```

这是怎么做到的？为什么不为元组上的所有标准函数完成它，比如 zip？

Hoogle 没有给我[任何结果](http://www.haskell.org/hoogle/?hoogle=%28,%29)，而且我看不到 Haskell 模板是如何做到这一点的，所以我认为它一定是编译器内部的某种魔法。但这对我来说似乎很不合时宜。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T23:08:31.470

> 这是怎么做到的？

编译器支持。Haskell 语言报告要求`(,)`至少支持 15 个参数（6.1.4），但 GHC 更进一步并生成更多（上次我们对此进行测试，它可以处理数百甚至数千个） . `zip`并且必须为最多 7 个元组定义其他元组函数。我不知道 GHC 是否会产生更大的数量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T11:05:57.357

我的理解是这`(,)`不是一个常规函数，它是一个具有特殊语法的构造函数，硬连线到语言中。它类似于 syntax `[1, 2, 3]`，你无法定义自己，因为它是硬连线的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-12T15:45:33.907

它在语言定义中指定并硬连接到编译器中。你没有在 Haskell 中定义元组，Haskell 的定义包括元组。

元组有可接受的 (,,,) 语法，它们是匿名产品类型，非常基础。这些也与类型推断完美配合，因为每个组件都存在并且可以推断。

匿名求和类型没有可接受的语法，它们可能无法很好地用于类型推断。

Haskell 提供用户可定义的中缀语法，但不提供用户可定义的括号（在广泛的准引用可能性之外）。

# cross-browser - 为什么没有类似dreamweaver 的跨浏览器html 编辑器？

> ID：11909550
> 
> 赞同：0
> 
> 时间：2012-08-10T21:32:10.120
> 
> 标签：cross-browser, wysiwyg, frontend, html-editor

据我所知，有许多所见即所得（所见即所得）的编辑器，但在涉及跨浏览器问题时，没有一个是成功的。

很少有框架，例如 twitter bootstrap、960.gs、blueprint 等...

构建一个跨浏览器的所见即所得编辑器有那么难吗？

这背后的主要障碍是什么？

我知道这不是一件小事，但如果有这样的程序或工具，它肯定会让事情变得更容易。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:59:23.313

主要问题是浏览器中的不同渲染引擎。当然，他们都试图实现相同的 HTML/CSS 标准，但是有时解释这些标准会导致不同的结果。

目前，确保跨浏览器兼容性的唯一方法是使用不由浏览器直接呈现的组件，例如 Java 小程序。

有一些基于 Java 的商业 WYSIWYG 编辑器，例如：

[编辑NG](http://www.realobjects.com/products/edit-on-ng/)

[斯费瑞克斯](http://www.sferyx.com/htmleditorapplet/)

或编辑直播

# iphone - 委托，如何使用非 viewController 设置层次结构

> ID：11909551
> 
> 赞同：0
> 
> 时间：2012-08-10T21:32:20.010
> 
> 标签：iphone

所以，我了解代表的基本示例。我所拥有的是：

```
WebService (class to handle grabbing web data)
HomeViewController (home screen)
ProgressViewController (shows the progress of a long download modally for long downloads)
OtherViewController (another view controller that might make a quick network request) 
```

场景 1：因此，他们可以从主屏幕进行下载，然后我们会要求 Web 服务获取数据，如果下载时间较长，则显示进度。

场景 2：OtherViewController 可能需要一些来自 Internet 的简单信息。它向 Web 服务请求该数据，并更新该视图。

目前，一切都由 NSNotifications 处理。

使用 NSNotification 的场景 1：主屏幕呈现模式视图控制器，将 ProgressViewController 添加为 web 服务的侦听器，ProgressViewController 在需要时更新其屏幕。

使用 NSNotification 的场景 2：其他视图控制器在 viewDidLoad 中注册为 Web 服务的观察者，在需要时从 Web 服务获取回调。

我想知道是否以及如何通过委托进行设置。我认为拥有一个可以实现以下方法的 WebServiceDelegate 可能会更好：

```
- (void)webService:(WebService *)webService didUpdateProgress:(double)progress; 
```

我看到的问题是，如果我的 Web 服务开始请求下载大量数据，目前，主屏幕视图控制器将执行以下操作：

```
ProgressViewController *pvc = [[ProgressViewController alloc] initWithNibName:@"ProgressViewController" bundle:nil]; 
```

呈现视图控制器，然后它侦听进度更新。

我不知道如何通过委托来做到这一点，因为我不知道在哪里设置委托属性。在 WebService 中，我需要执行以下操作：

```
self.WebServiceDelegate = progressViewController; 
```

但是，progressViewController 不会在 Web 服务中创建。它在 homeViewController 上创建。到目前为止，我唯一想到的就是执行以下操作：

```
ProgressViewController *pvc = [[ProgressViewController alloc] initWithNibName:@"ProgressViewController" bundle:nil];
            pvc.progressViewControllerDelegate = [WebServiceManager sharedInstance];
            self.webServiceManagerProgressDelegate = pvc;

            NSDictionary *progressViewDict = @{ @"ProgressViewController" : pvc };
            [[NSNotificationCenter defaultCenter] postNotificationName:WebServiceShowProgressViewNotification object:self userInfo:progressViewDict]; 
```

Web服务知道它应该显示这个视图控制器，发布通知，然后任何人（在我的情况下是主视图）正在监听，可以显示progressViewController，然后progressViewController可以显示进度并响应Web 服务委托方法。这似乎有点迂回，我不知道是否有更好的方法来做到这一点，或者只是坚持通知。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:44:22.733

如果我正确理解您的情况，homeViewController 具有对 Web 服务的引用，然后 homeViewController 创建 ProgressViewController 的实例。然后 ProgressViewController 需要使用委托从该 Web 服务获取更新。您可以尝试这样的事情作为 HomeViewController 的一部分：

```
ProgressViewController *pvc = ProgressViewController *pvc = [[ProgressViewController alloc] initWithNibName:@"ProgressViewController" bundle:nil];
self.webService.delegate = pvc; 
```

当然，这需要 homeViewController 有对 WebService 的引用（我称之为 webService）。

> Web 服务知道它应该显示这个视图控制器的地方

它真的不应该知道这些。它只需要做它的事情（下载、上传等等），如果有什么要报告的，它会通过向其委托发送消息来完成。该代表（无论是谁）将相应地更新视图。

**编辑：**我刚刚意识到 WebService 是一个单例。我相信单身人士的首选方法实际上是使用通知。由于所有视图控制器都可以访问单例，因此委托并不总是一种选择，因为所有这些视图控制器可能都需要更新正在发生的事情，而对象只能有一个委托。如果只有一个或两个视图控制器使用 WebService 单例，您可能不应该将其设为单例。

# php - 仅使用 PHP 隐藏文件

> ID：11909552
> 
> 赞同：0
> 
> 时间：2012-08-10T21:32:38.513
> 
> 标签：php

我必须从 PHP 中隐藏一些扩展名为 .png、.php 和 .html 的文件。

.htaccess 工作正常

```
IndexIgnore *.png
IndexIgnore *.php
IndexIgnore *.html 
```

但是，我想使用 PHP 隐藏文件。

我使用这个脚本：

```
<?php
    $myfolder = realpath(dirname(__FILE__));
    $handle = opendir("$myfolder");
    while($name = readdir($handle)) 
        echo "$name<br>";
    }
    closedir($handle);
?> 
```

但是，我仍然可以看到这些文件。感谢所有可以提供帮助的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T21:38:03.563

这是使用正则表达式的方法

```
<?php
    // Regex with which to hide some file types
    $ignore_regex = '/(\.png|\.php|\.html)$/';

    $myfolder = realpath(dirname(__FILE__));
    $handle = opendir("$myfolder");
    while($name = readdir($handle)) {
        // Check if this name matches the ignore regex
        if(preg_match($ignore_regex, $name)) {
            continue;
        }
        echo "$name<br>";
    }
    closedir($handle);
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T21:35:55.950

PHP 直接读取文件系统，它不通过网络服务器读取文件。因此它忽略了 .htaccess 文件。

您需要在循环中手动检查这些文件类型，然后忽略它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T21:42:48.507

PHP 有一个叫做[glob](http://www.php.net/glob)的函数，它将返回匹配模式的文件。这可能是您需要使用的。

[正如下面的Rocket](https://stackoverflow.com/users/206403/rocket)所指出的，这里有一个非常有用的关于[glob 模式](http://cowburn.info/2010/04/30/glob-patterns/)的简短教程。

仅用于名称就值得使用:)

# c# - HPQC C# 创建测试计划测试

> ID：11909555
> 
> 赞同：0
> 
> 时间：2012-08-10T21:32:57.763
> 
> 标签：c#, hp-quality-center

使用 QC 集成工具并在测试计划中创建测试时遇到问题 - 不幸的是，API 是为 VB6 编写的，而我正在使用 C#。

这是我到目前为止所得到的：

```
private void HPQC_Create_Test_Plan_Test(TDConnectionClass tdConnection, string ParentFolderPath, string TestName)
    {
        try
        {
            TreeManager treeM = (TreeManager)tdConnection.TreeManager;
            ISysTreeNode ParentFolder = (ISysTreeNode)treeM.get_NodeByPath(ParentFolderPath);
            TestFactory TestF = (TestFactory)tdConnection.TestFactory;

            Test TstTest = (Test)TestF.AddItem(System.DBNull.Value);
            TstTest.Name = TestName;
            TstTest.Type = "MANUAL";
            TstTest.Post();

            HPQC_Status_Test_Plan.Text = "Test " + TestName + " created.";

            tdConnection.Logout();
            tdConnection.Disconnect();
            tdConnection = null;

        }
        catch (Exception ex)
        {
            HPQC_Status_Test_Plan.Text = "Test Creation Failed.";
            Console.WriteLine("[Error] " + ex);

            tdConnection.Logout();
            tdConnection.Disconnect();
            tdConnection = null;

        }
    } 
```

帖子上的代码错误只是一个简单的“无法发布”，我不知道为什么。

这是 VB6 中的 API 示例：

```
Public Sub AddTest(FolderName$, TestName$) 
```

创建新的测试。此示例假定包含新测试的主题文件夹直接位于根“主题”文件夹下。

```
Dim objTest As Test
Dim folder As SubjectNode
Dim testF As TestFactory
Dim TreeMgr As TreeManager
Dim Path As String

Dim Trees As List
Dim RootName As String
Dim SubjRoot As SubjectNode

'tdc is the global TDConnection object.
Set TreeMgr = tdc.TreeManager

' Use TreeManager.TreeRoot to get the list of subject
' root nodes from the tree manager.
' There is only one item in this list.
Set Trees = TreeMgr.RootList(TDOLE_SUBJECT)

' Get the name of the subject tree root in your project.
RootName = Trees.Item(1)

Path = RootName & "\" & FolderName

On Error Resume Next
Set folder = TreeMgr.NodeByPath(Path)
On Error GoTo 0

If folder Is Nothing Then 'Create the folder
    ' Get the SubjectNode root node object from the
    ' tree manager by name.
    Set SubjRoot = TreeMgr.TreeRoot(RootName)
    Set folder = SubjRoot.AddNode(FolderName)
End If

Set testF = folder.TestFactory
Set objTest = testF.AddItem(Null)
objTest.name = TestName
objTest.Type = "SYSTEM-TEST"
objTest.Post

Dim VerCtl As VCS
Dim bIsLocked As Boolean
Dim strLockedBy As String

Set VerCtl = objTest.VCS

VerCtl.Refresh

bIsLocked = VerCtl.IsLocked
strLockedBy = VerCtl.LockedBy

' After POST, Test is checked in.
Debug.Print "Is locked: " & bIsLocked
'Is locked: False
Debug.Print "Is locked by: """ & strLockedBy & """"
'Is locked by: ""

VerCtl.CheckOut -1, "To change state", True

VerCtl.Refresh

bIsLocked = VerCtl.IsLocked
strLockedBy = VerCtl.LockedBy

Debug.Print "Is locked: " & bIsLocked
'Is locked: True
Debug.Print "Is locked by: """ & strLockedBy & """"
'Is locked by: "User1"

' Take an arbitrary field to change.
Debug.Print "Status: """ & objTest.Field("TS_STATUS") & """"
'Status: ""

objTest.Field("TS_STATUS") = "Ready"

objTest.Post

VerCtl.CheckIn "", "Changed status"

VerCtl.Refresh

bIsLocked = VerCtl.IsLocked
strLockedBy = VerCtl.LockedBy

Debug.Print "Is locked: " & bIsLocked
'Is locked: False
Debug.Print "Is locked by: """ & strLockedBy & """"
'Is locked by: "" 
```

结束子

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-14T14:56:15.737

我也有类似但更适合生成文件夹结构的东西。我们在 QC 中的根文件夹是“主题”，但您可以简单地更改它以创建您想要的特定文件夹。此外，不需要设置 ["TS_SUBJECT"] 标题，因为我们使用叶节点处的节点将测试创建到指定文件夹中。

```
private TestFactory addSubjectTreeStructure(String subjectField)
    {
        String folderRootString = subjectField;
        folderRootString = folderRootString.Replace("\\", "/");
        String[] folders = folderRootString.Split('/');

        // Test Plan Tree Manager
        TreeManager treeMgr = tdc.TreeManager;
        SubjectNode subjectNode = treeMgr.get_NodeByPath("Subject");

        ISysTreeNode node = (ISysTreeNode)subjectNode;

        // Creating the folders in test plan.
        for (int i = 0; i < folders.Length; i++)
        {
            try
            {
                node = node.FindChildNode(folders[i]);
            }
            catch (Exception ex)
            {
                node = node.AddNode(folders[i]);
                Console.WriteLine(ex.Message + ".\nChild not found. Adding new node: " + folders[i]);
            }
        }

        // Set the leaf folder and then returning the TestFactory from where all test cases will be generated from.
        SubjectNode folder = treeMgr.get_NodeById(node.NodeID);
        return folder.TestFactory;
    } 
```

然后通过使用返回的测试工厂，您可以在此文件夹中创建测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:03:57.000

给它一个周末考虑一下，并意识到上面的代码在树中没有可以链接到的父属性。不幸的是，C# 中的 TreeManager 由于某种原因没有可以使用的 TreeRoot。

通过手动获取原型的路径来解决这个问题 - 用户必须将父路径（如“Root\Subject”）键入文本框。

关键属性是“TS_Subject”，它是您要将测试附加到的文件夹的 NodeID。

以下代码适用于我：

```
private void HPQC_Create_Test_Plan_Test(TDConnectionClass tdConnection, string ParentFolderPath, string TestName)
    {
        try
        {
            TreeManager treeM = (TreeManager)tdConnection.TreeManager;
            ISysTreeNode ParentFolder = (ISysTreeNode)treeM.get_NodeByPath(ParentFolderPath);
            TestFactory TestF = (TestFactory)tdConnection.TestFactory;

            Test TstTest = (Test)TestF.AddItem(System.DBNull.Value);
            TstTest.Name = TestName;
            TstTest.Type = "MANUAL";
            TstTest["TS_SUBJECT"] = ParentFolder.NodeID;
            TstTest.Post();

            HPQC_Status_Test_Plan.Text = "Test " + TestName + " created.";

            tdConnection.Logout();
            tdConnection.Disconnect();
            tdConnection = null;

        }
        catch (Exception ex)
        {
            HPQC_Status_Test_Plan.Text = "Test Creation Failed.";
            Console.WriteLine("[Error] " + ex);

            tdConnection.Logout();
            tdConnection.Disconnect();
            tdConnection = null;

        }
    } 
```

# mysql - 为什么这两个mysql查询不同？

> ID：11909557
> 
> 赞同：1
> 
> 时间：2012-08-10T21:33:01.867
> 
> 标签：mysql

```
select distinct p.product_id from cscart_products p 
    left join product_bikes pb on p.product_id = pb.product_id
    left join cscart_product_options po on po.product_id = p.product_id
    left join cscart_product_option_variants pov on pov.option_id = po.option_id
    left join variant_bikes vb on vb.variant_id = pov.variant_id
    where pb.bike_id = 111 or vb.bike_id = 111 
```

和：

```
select distinct p.product_id from cscart_products p 
    left join product_bikes pb on p.product_id = pb.product_id and pb.bike_id = 111
    left join cscart_product_options po on po.product_id = p.product_id
    left join cscart_product_option_variants pov on pov.option_id = po.option_id
    left join variant_bikes vb on vb.variant_id = pov.variant_id and vb.bike_id = 111 
```

返回不同的结果集，为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T21:36:20.057

第一个查询在 WHERE 子句中有一个 OR：

```
WHERE pb.bike_id = 111 OR vb.bike_id = 111 
```

第二个查询实际上有 AND，而是通过条件：

```
LEFT JOIN product_bikes pb ON p.product_id = pb.product_id AND pb.bike_id = 111
...
LEFT JOIN variant_bikes vb ON vb.variant_id = pov.variant_id AND vb.bike_id = 111 
```

* * *

> 额外的问题：有没有一种方法可以通过连接使其行为相同并受益于较小的连接以提高性能？

有一种方法可以编写查询，但不一定更快，因为该方法（我正在考虑）使用 UNION：

```
select distinct p.product_id from cscart_products p 
    left join product_bikes pb on p.product_id = pb.product_id and pb.bike_id = 111
    left join cscart_product_options po on po.product_id = p.product_id
    left join cscart_product_option_variants pov on pov.option_id = po.option_id
    left join variant_bikes vb on vb.variant_id = pov.variant_id -- and vb.bike_id = 111
UNION
select distinct p.product_id from cscart_products p 
    left join product_bikes pb on p.product_id = pb.product_id -- and pb.bike_id = 111
    left join cscart_product_options po on po.product_id = p.product_id
    left join cscart_product_option_variants pov on pov.option_id = po.option_id
    left join variant_bikes vb on vb.variant_id = pov.variant_id and vb.bike_id = 111 
```

可能有更好的方法，例如您有一个 UNION 子查询，如下所示：

```
SELECT DISTINCT p.product_id
  FROM      cscart_products                AS p 
  LEFT JOIN cscart_product_options         AS po  ON po.product_id = p.product_id
  LEFT JOIN cscart_product_option_variants AS pov ON pov.option_id = po.option_id
  LEFT JOIN (SELECT vb.product_id FROM variant_bikes AS vb WHERE vb.bike_id = 111
             UNION
             SELECT pb.product_id FROM product_bikes AS pb WHERE pb.bike_id = 111
            ) AS pv ON pv.product_id = p.product_id 
```

由于您没有（在示例中）从`cscart_product_options`or`cscart_product_options_variants`表中选择数据，因此您可以从查询中消除这些数据。您还应该查看带有子查询的 LEFT JOIN 是否合适；我认为你更有可能想要一个内部连接。很可能有更多的工作可以做来提高性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:47:42.557

除了乔纳森所说的。在第一个查询中，WHERE 强制您没有得到任何结果，除非 (pb.bike_id = 111 或 vb.bike_id = 111) 为真。在第二个查询中，您将获得所有 DISTINCT [product_id]，即使只有一行能够通过 LEFT JOIN 连接。

如果您从第二个查询与第一个查询中得到很多结果，那就是这样。查看这一点的更简单方法是在您的 SELECT 中添加更多内容：

```
SELECT p.product_id, pb.bike_id ... 
```

如果这样做，您会注意到，第一个查询将在它显示的每个产品中包含 111，但第二个查询将有很多 pb.bike_id 的 NULL 值。

说得通？

# python - Python中的bdecode库不起作用

> ID：11909558
> 
> 赞同：0
> 
> 时间：2012-08-10T21:33:02.643
> 
> 标签：python

我正在尝试使用 python 中的 bdecode 库来解码 bencode 格式。我已经在我的 python 文件夹中导入了 bcode 库。当我尝试使用库中定义的函数 bdecode 时。我收到一个错误

```
 File "C:\Python27\fit.py", line 21, in <module>
                 decoded = bdecode(data)
                 NameError: name 'bdecode' is not defined 
```

知道为什么会发生此错误，我只是 python 新手吗？如果这是因为 bcode 库，任何人都可以提交指向其他 bcode 库的链接吗？

这是我正在尝试的代码

```
 import  bcode, urllib, urlparse, string
             url = "http://update.utorrent.com/installoffer.php?"
             url = url + "offer=conduit"

             filename = "out_py.txt"
             urllib.urlretrieve(url,filename)

             with open ("out_py.txt", "r") as myfile:
             data=myfile.readlines()

             decoded = bdecode(data) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:46:27.687

您可以通过以下两种方法之一解决此问题，更改您的导入语句：

```
from bcode import bdecode
import urllib, urlparse, string 
```

或者更改调用函数的行：

```
decoded = bcode.bdecode(data) 
```

问题是，当您导入 bcode 模块时，您没有将其中的任何符号导入本地命名空间。

# android - MYSQL 和 SQLite

> ID：11909565
> 
> 赞同：0
> 
> 时间：2012-08-10T21:34:05.413
> 
> 标签：android

我知道这似乎是一个基本问题，但我知道使用 SQLite 的 android 应用程序可以与[http://www.freemysql.net/client/](http://www.freemysql.net/client/)之类的网站一起使用。我在 netbeans 中开发了一个桌面程序，它使用 MYSQL 与这个网站一起运行，我希望我的 android 应用程序也能将信息上传到这个网站。或者我可以将 MYSQL 与 android 一起使用。我只需要指出正确的方向。任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:08:25.940

如果您只希望您的应用程序在“在线”时能够正常工作，那么您也许可以让它工作。我希望云数据库 API 已经符合 Kevin 提到的您需要的 Web 服务接口的要求。如果您希望桌面和 Android 应用程序使用相同的数据库，这似乎是合理的。

我没有看到您提到的网站的任何 API 文档。我会将您的注意力集中在如何编写与 Web 服务通信的 Android 应用程序上。由于您已经编写了 Java 桌面客户端，因此您可能已经对此有所了解。

如果您决定在某个时候需要“离线”访问数据库，您应该只查看 Android 上的数据库访问教程。这不是那么痛苦。您可能需要这样做，以便您可以在本地存储数据并在连接时推送到云端。

[http://developer.android.com/guide/topics/data/data-storage.html#db](http://developer.android.com/guide/topics/data/data-storage.html#db)

# ruby-on-rails - 这个包含数学符号的正则表达式有什么问题？（红宝石/导轨）

> ID：11909567
> 
> 赞同：0
> 
> 时间：2012-08-10T21:34:16.543
> 
> 标签：ruby-on-rails, ruby

```
text.scan(/\"[\d\w\s\+\-\*\/]*\"/) 
```

我只是想在引用中找到可以包含字母、数字、空格、加号、减号、星号或正斜杠的任何内容。一切都在控制台中运行良好。以下每一项都适用于浏览器：

```
"abc"
"123"
"x-1" or "x - 1"
"x/1" or "x / 1" 
```

但是加号和星号在浏览器中失败（尽管在控制台中使用相同的正则表达式工作正常）。有没有人有任何想法？

编辑 #1：我正在执行快速 gsub 以向扫描结果添加一些格式。如果引文中有加号或星号，它们甚至不会被扫描拾取。粘贴在控制台中的相同代码和文本可以正常工作。

编辑＃2：我想出了一个更好的方法来构建这个问题而没有多余的细节并得到了答案。“[如果结果包含正则表达式特殊字符，为什么我不能对扫描的每个结果执行 gsub？](https://stackoverflow.com/questions/12100765/why-cant-i-perform-a-gsub-on-each-of-the-results-from-a-scan-if-the-result-cont/) ”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:33:52.547

原来这个问题与正则表达式字符串插入（`/#{whatever}/`）没有转义特殊字符有关 - 手动转义将其清除（`/#{Regexp.escape(whatever)}/`）。有关完整示例/说明，请参阅[此问题](https://stackoverflow.com/questions/12100765)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:58:23.640

我不知道“在浏览器中工作”是什么意思，但我假设您正在尝试解析 URL。在 URL 中，`+`&`*`符号可以分别转换为`%2B`& `%2A`。

试试这个正则表达式：

```
/"[(\d\w\s\+\-\*\/|%2B|%2A)]+"/ 
```

...或在解析之前解码 URL。

# jquery - 如何使用更新的代码修改滑动切换来停止事件传播。

> ID：11909574
> 
> 赞同：2
> 
> 时间：2012-08-10T21:35:04.423
> 
> 标签：jquery, event-bubbling, event-propagation

我有一个 jquery 功能，其中有两个选项卡。
在 上`click`，每个选项卡都会进行 ajax 调用并绘制一个 jsp 页面。
第二个标签有一个滑动切换。

我的问题最初是当页面加载时我单击第二个选项卡，滑动切换工作正常。

当我单击第一个选项卡并单击第二个选项卡时，滑动切换将快速打开和关闭。

如何阻止这种传播？

我尝试了 event `.preventDefault()`,`stopPropagation()`等`die`。没有运气。

我试过的代码在下面。滑动切换方法是一个 js 文件，另外两个在不同的 js 文件中。

```
jQuery(function() {

    //$(".trigger1").on('click', function (e) {
    $("#qstnlist_content").off('click', '.trigger1').on('click', '.trigger1', function(event) {

        // $(".trigger1").die('click').live('click',function(event){
        //if($(event.target).is('div.trigger1')){
        //$("document").off('click', "#list_intrv_qstns").on('click', "#list_intrv_qstns", function (e) {
        var str = $(this).find("span.imgplus").text();

        if (str.indexOf("+") >= 0) $(this).find("span.imgplus").html("-&nbsp;");
        if (str.indexOf("-") >= 0) $(this).find("span.imgplus").html("+&nbsp;");

        $(this).next("div.dispnone").slideToggle("slow");

/* if(event.preventDefault){ event.preventDefault()}

            else{event.stop()};

            event.returnValue = false;*/

        event.stopImmediatePropagation();
        event.stopPropagation();
        return false;

    });

});
$("#list_intrv_qstns").off('click').on('click', function(event) {

    $("#qstnlist_content").removeClass();
    $("#qstnlist_content").addClass('dispnone');
    $("#qstn_content").removeClass();
    $("#qstn_content").addClass('dispshow');
    $("#qstnlist_content").off("click", ".trigger1");

    event.stopImmediatePropagation();

    $("#list_intrv_qstns_a").css('color', 'black');
    $("#start_intrv_a").css('color', 'white');
    $("#add_intrv_qstns_a").css('color', 'white');
    $("#create_intrv_qstns_a").css('color', 'white');
    $("#create_intrv_template_a").css('color', 'white');
    var inputData = {
        usrid: $(this).data("usrid"),
        buddyId: $("#qstbuddyid").val()
    }
    $.ajax({
        url: "listquestions",
        dataType: "html",
        data: inputData,
        success: function(data) {
            $("#qstn_content").empty().html(data);
        },
        error: function() {
            alert('Issue with save. ');
        }
    });

    //   if(event.preventDefault){ event.preventDefault()}
    // else{event.stop()};
    //event.returnValue = false;
    event.stopImmediatePropagation();
    event.stopPropagation();

});
$("#list_intrv_qstns").click();

//  $("#add_intrv_qstns").die('click').live('click', function(e){
$("#add_intrv_qstns").off('click').on('click', function(event) {

    $("#qstnlist_content").removeClass();
    $("#qstnlist_content").addClass('dispshow');
    $("#qstn_content").removeClass();
    $("#qstn_content").addClass('dispnone');

    //$("#qstnlist_content").off("click",".trigger1");
    $("#list_intrv_qstns_a").css('color', 'white');
    $("#start_intrv_a").css('color', 'white');
    $("#add_intrv_qstns_a").css('color', 'black');
    $("#create_intrv_qstns_a").css('color', 'white');
    $("#create_intrv_template_a").css('color', 'white');
    var inputData = {
        usrid: $('#usrid').val(),
        buddyId: $("#qstbuddyid").val()
    }
    $.ajax({
        url: "questions",
        dataType: "html",
        data: inputData,
        success: function(data) {
            $("#qstnlist_content").empty().html(data);
        },
        error: function() {
            alert('Issue with loading add questions. ');
        }
    });

    //event.stopPropagation();
    event.stopImmediatePropagation();
    event.stopPropagation();
    //event.preventDefault();
    // event.preventCapture();
    //event.preventBubble();
    //  if(event.preventDefault){ event.preventDefault()}
    //else{event.stop()};
    //event.returnValue = false;
    //event.stopImmediatePropagation();

});​ 
```

jsp：

```
<div class="Interviewprocess">
    <form id="feedback_form" action="savefeedback" method="post">
        <fieldset>
            <legend>Interview Process</legend>
            <input type="hidden" name="buddyBO.intrvBuddyId" value="${interviewModel.buddyBO.intrvBuddyId}">

            <ul id="tabmenu" >
                <li data-intrvbuddyid="${interviewModel.buddyBO.intrvBuddyId}" id="add_intrv_qstns"><a href="#"         id="add_intrv_qstns_a" style="color:white">Add Questions</a></li>
                <li data-intrvbuddyid="${interviewModel.buddyBO.intrvBuddyId}" id="create_intrv_qstns"><a href="#"     id="create_intrv_qstns_a" style="color:white">Create Questions</a></li>
                <li data-usrid="${hmEmpId}" id="list_intrv_qstns"><a href="#" id="list_intrv_qstns_a"  class="active"     style="color:black">Review Question List</a></li>
                <!--<li data-intrvbuddyid="${interviewModel.buddyBO.intrvBuddyId}" id="create_qstns_template"><a href="#"     id="create_qstns_template_a" style="color:white">Crt</a></li>-->
                <li data-intrvbuddyid="${interviewModel.buddyBO.intrvBuddyId}" id="start_intrv"><a href="#" id="start_intrv_a"     style="color:white">Start Interview</a></li>
            </ul>

            <div id="qstn_content" ></div><!--content-->
            <div id="qstnlist_content" class="dispnone"></div>
        </fieldset>
    </form>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:38:45.793

从[**文档**](http://api.jquery.com/live/)中引用，许多缺点之一`live()`是：

> 在事件处理程序中调用 event.stopPropagation() 无法停止附加在文档下方的事件处理程序；事件已经传播到文档

从 jQuery 1.7 开始，您应该使用[**on()**](http://api.jquery.com/on/)而不是[**live()**](http://api.jquery.com/live/)或者如果您使用的是旧版本的[**bind()**](http://api.jquery.com/bind) 或[**delegate()**](http://api.jquery.com/delegate/)。

有关不同绑定方法的更多详细信息，以及添加它们的时间以及替换的对象和时间，请参阅[**这篇文章。**](https://stackoverflow.com/a/11148053/448144)

尝试使用`off()`,`on()`代替。例如：

```
$("#list_intrv_qstns").off('click').on('click', function (e) { 
```

或者如果`list_intrv_qstns`是动态添加的元素：

```
$(document).off('click', "#list_intrv_qstns").on('click', "#list_intrv_qstns", function (e) { 
```

请注意，尽管对于动态元素，您应该绑定到最近的静态元素，但由于我不知道我使用的代码中的内容，`document`但您可以替换它。

**其他资源**
[**click()**](http://api.jquery.com/click/)
[**bind()**](http://api.jquery.com/bind)
[**live() (不要使用)**](http://api.jquery.com/live/)
[**delegate()**](http://api.jquery.com/delegate/)
[**on()**](http://api.jquery.com/on/)

# iphone - NSFileManager 多实例写入原子性

> ID：11909576
> 
> 赞同：1
> 
> 时间：2012-08-10T21:35:25.670
> 
> 标签：iphone, objective-c, ios, cocoa, nsfilemanager

我有一个动态库，我假设它使用 NSFileManager 的实例。对于我的应用程序，我需要使用 NSFileManager 写入与动态库相同的文件。如果动态库的 NSFileManager 与我的 NSFileManager 同时写入同一个文件，哪一个会赢，或者两者都无法完成写入？动态库没有使用 NSFileManager 单例实例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:04:40.283

如果是原子的，它们都会成功。哪个文件保留在磁盘上取决于最后完成的操作。将原子写入视为对临时文件的写入，然后对临时文件进行重命名。

# image - Hessian矩阵的特征向量和特征值

> ID：11909578
> 
> 赞同：1
> 
> 时间：2012-08-10T21:35:29.883
> 
> 标签：image, algorithm, matlab, image-processing, hessian-matrix

我想提取容器中的中心线像素。起初，我使用 ginput(1) 命令选择了靠近血管边缘的种子点。这提供了起点并指定了需要执行分析的血管段上的感兴趣区域 (ROI)。

```
figure; imshow(Igreen_eq); % Main green channel Image
p = ginput(1); 
```

然后将选定的种子点用作直径小于容器预期直径的圆的中心，以使该圆不与相对边缘相交。

```
t = 0:pi/20:2*pi;
d = 0.8*15; %d=80% of minwidthOfVessel so that it wont intesect with opposite edge;
R0=d/2;%radius
xi = R0*cos(t)+p(1);
yi = R0*sin(t)+p(2);
line(xi,yi,'LineWidth',2,'Color',[0 1 0]);
roimask = poly2mask(double(xi), double(yi), size(Igreen_eq,1), size(Igreen_eq,2));
figure; imshow(roimask) % Binary image of region selected
Itry = Igreen_eq; 
Itry(~roimask ) = 0;  
imshow(Itry);
Itry = im2double(Itry);
line(xi, yi,'LineWidth', 2, 'Color', [0 1 0]);
hold on; plot(p(1), p(2),'*r') 
```

**问题**：要计算该圆圆周上的光强度的 Hessian 矩阵，并且必须获得特征向量。我计算了 Dxx,Dyy,Dxy 使用：

```
[Dxx,Dxy,Dyy] = Hessian2D(Itry,2); %(sigma=2) 
```

我需要在 MATLAB 中编写代码来解决以下问题“对于容器内的一个点，对应于最大特征值的特征向量垂直于边缘，对应于最小特征值的特征向量指向沿血管的方向。

圆上具有最大方向变化的前两个连续向量被认为是反映血管边界的像素。跟踪方向上的点被认为是后续圆的中心。重复这个过程给出了血管边界的估计。

如上所述，我将如何计算 Hessian 矩阵的最大特征值及其对应的特征向量来选择新的种子点。

* * *

感谢您的回复 。我使用 eig2image.m 来查找图像上每个点的特征向量（在我的图像中，同心圆区域有灰度值，背景为黑色）。

```
[Lambda1,Lambda2,Ix,Iy]=eig2image(Dxx,Dxy,Dyy) 
```

其中 Ix 和 Iy 是最大的特征向量。
但是当我尝试使用以下方法绘制特征向量时：

```
quiver(Ix, Iy) 
```

我还可以看到黑色背景上的向量应该为零！

您能否回复我如何在图像顶部绘制特征向量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T22:19:30.480

假设`Dxx, Dyy, Dxy`是维度的二阶偏导数矩阵，`size(Itry)`那么对于给定的点`(m,n)`，`Itry`您可以执行以下操作：

```
H = [Dxx(m,n) Dxy(m,n); Dxy(m,n) Dyy(m,n)];
[V,D] = eig(H); % check by H*V = V*D;
eigenVal1 = D(1,1); 
eigenVal2 = D(2,2);
eigenVec1 = V(1,:); 
eigenVec2 = V(2,:); 
```

这种局部特征分解将为您提供特征值（和相应的特征向量），您可以根据幅度对其进行排序。您可以遍历图像点，或者更紧凑的解决方案，请参阅[FileExchange](http://www.mathworks.com/matlabcentral/fileexchange/24409-hessian-based-frangi-vesselness-filter)中的 eig2image.m。

# java - 枚举

> ID：11909579
> 
> 赞同：10
> 
> 时间：2012-08-10T21:35:31.513
> 
> 标签：java, interface, enums, type-constraints

我正在尝试拥有一组扩展通用接口的枚举，例如：

```
interface Fooable
{
  void someCommonMethod();
}

enum E1 implements Fooable
{
   // some enumuerations and a definition for someCommonMethod()
}

enum E2 implements Fooable
{
   // some different enumerations and a different definition for someCommonMethod()
} 
```

然后通过强制变量是枚举**并**实现接口来在其他地方使用它。所以有点类似..

```
bar(Enum<? extends Fooable> fe)
{
  fe.ordinal();
  fe.someCommonMethod();
} 
```

但是，到目前为止，我似乎必须强制转换 fe 才能将其视为实现接口，即

```
bar(Enum<? extends Fooable> fe)
{
  fe.ordinal();
  ((Fooable)fe).someCommonMethod();
} 
```

虽然这应该是安全的......它似乎不是最理想的，我可能会忽略一些东西。当然，如果我尝试仅将参数作为 Fooable 传递，那么我最终将其转换为将其视为枚举，这不仅没有收获，我现在甚至都不安全。请参阅以下内容：

```
bar(Fooable fe)
{
  // potentially unsafe cast!
  ((Enum<?>)fe).ordinal();
  fe.someCommonMethod();
} 
```

有什么我忽略的或者是

```
Enum<? extends Fooable> 
```

与我得到的“好”解决方案一样接近吗？

我对 Java 比较陌生，并且仍然在尝试像 C 或 C++ 一样使用它，所以如果我把它当作锤子而不是锯子来对待，或者忽略一些愚蠢简单的东西，请随时指出:)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-10T21:55:44.887

这意味着 T 扩展了 Enum 并实现了 Fooable：

```
<T extends Enum<T> & Fooable> 
```

因此，您的方法可以写成：

```
<T extends Enum<T> & Fooable> void bar(T fe) {
    fe.ordinal();
    fe.someCommonMethod();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T22:20:28.800

您可以选择的一种方法是将您需要的 Enum 中的任何方法添加到 Fooable 上，或者创建一个扩展 Fooable 的新接口并添加您需要的 Enum 方法。

例子：

```
interface Fooable {
   void someCommonMethod();
}

interface FooableEnum extends Fooable {
   int ordinal();
}

enum E1 implements FooableEnum {
   // Implement someCommonMethod.
   // ordinal() is already implemented by default.
} 
```

完成此操作后，您可以将`FooableEnum`其用作方法签名中的参数类型，而不必担心任何通用的东西。

# vba - 自动化错误：内部 SAP 站点抓取出现 800706B5、80004005、80010108

> ID：11909580
> 
> 赞同：3
> 
> 时间：2012-08-10T21:35:34.040
> 
> 标签：vba, excel, automation, office-automation, browser-automation

我正在编写一个宏，它将抓取我公司的内部 SAP 站点以获取供应商信息。出于几个原因，我必须使用 VBA 来做到这一点。但是，我无法弄清楚为什么在尝试抓取页面时会不断收到这三个错误。这可能与[UAC 完整性模型](http://msdn.microsoft.com/en-us/library/bb625962.aspx)有关吗？还是我的代码有问题？是否可以在 Internet Explorer 中以不同方式处理使用 http 的网页？我可以访问任何网页，甚至是其他内部网页，并且可以很好地抓取其中的每一个。但是当我尝试抓取 SAP 页面时，我得到了这些错误。错误描述及其发生时间是：

800706B5 - 接口未知（在运行有问题的代码之前放置断点时发生）

80004005 - 未指定的错误（当我没有放置任何错误并让宏运行时发生）

80010108 - 调用的对象已与其客户端断开连接。（我似乎无法始终如一地发生此错误，它似乎发生在 excel 中的某些内容严重损坏以至于无法加载任何页面并且我必须重新安装 excel 的时候）

我完全不知道发生了什么。Integrity 页面对我来说没有多大意义，我在此找到的所有研究都谈到了连接到数据库以及使用 ADO 和 COM 引用。但是，我通过 Internet Explorer 做所有事情。下面是我的相关代码：

```
Private Sub runTest_Click()
   ie.visible = True
   doScrape
End Sub
'The code to run the module
Private Sub doTest()
   Dim result As String
   result = PageScraper.scrapeSAPPage("<some num>")
End Sub 
```

PageScraper 模块

```
Public Function scrapeSAPPage(num As Long) As String
   'Predefined URL that appends num onto end to navigate to specific record in SAP
   Dim url As String: url = "<url here>" 
   Dim ie as InternetExplorer
   set ie = CreateObject("internetexplorer.application")
   Dim doc as HTMLDocument

   ie.navigate url 'Will always sucessfully open page, regardless of SAP or other
   'pauses the exection of the code until the webpage has loaded
   Do
     'Will always fail on next line when attempting SAP site with error
     If Not ie.Busy And ie.ReadyState = 4 Then 
        Application.Wait (Now + TimeValue("00:00:01"))
        If Not ie.Busy And ie.ReadyState = 4 Then
           Exit Do
        End If
     End If
     DoEvents
   Loop

   Set doc = ie.document 'After implementation of Tim Williams changes, breaks here
   'Scraping code here, not relevant

 End Function 
```

我在 Windows 7 机器上使用 IE9 和 Excel 2010。您可以提供的任何帮助或见解将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T07:31:32.840

我经常进行这种类型的抓取，并且发现很难使 IE 自动化 100% 可靠地工作，并出现您发现的错误。由于它们通常是时间问题，因此调试可能会非常令人沮丧，因为它们不会在您单步执行时出现，仅在实时运行期间为了最大限度地减少错误，我执行以下操作：

引入更多延迟；ie.busy 和 ie.ReadyState 不一定会在 ie.navigate 之后立即给出有效答案，因此在 ie.navigate 之后引入一个短暂的延迟。对于我通常加载 1 到 2 秒的东西，但任何超过 500 毫秒的东西似乎都可以工作。

在转到目标 url 之前，通过 ie.navigate "about:blank" 确保 IE 处于干净状态。

之后，您应该有一个有效的 IE 对象，并且您必须查看它以了解您在里面有什么。一般来说，我避免尝试访问整个 ie.document，而是使用 IE.document.all.tags("x") ，其中 'x' 是我正在寻找的合适的东西，例如 td 或 a。

然而，在所有这些改进之后，尽管它们提高了我的成功率，但我仍然随机出现错误。

我真正的解决方案是放弃 IE，而是使用 xmlhttp 来完成我的工作。

如果您使用文档上的文本操作来解析数据，那么交换将是一件轻而易举的事。xmlhttp 对象更加可靠。您只需获得“responsetext”即可访问文档的整个 html。

这是我现在在生产中用于抓取的简化版本，它非常可靠，可以在一夜之间运行，生成数百万行而不会出错。

```
Public Sub Main()

Dim obj As MSXML2.ServerXMLHTTP
Dim strData As String
Dim errCount As Integer

' create an xmlhttp object - you will need to reference to the MS XML HTTP library, any version will do
' but I'm using Microsoft XML, v6.0 (c:\windows\system32\msxml6.dll)
Set obj = New MSXML2.ServerXMLHTTP

' Get the url - I set the last param to Async=true so that it returns right away then lets me wait in
' code rather than trust it, but on an internal network "false" might be better for you.
obj.Open "GET", "http://www.google.com", True
obj.send ' this line actually does the HTTP GET

' Wait for a completion up to 10 seconds
errCount = 0
While obj.readyState < 4 And errCount < 10
    DoEvents
    obj.waitForResponse 1 ' this is an up-to-one-second delay
    errCount = errCount + 1
Wend

If obj.readyState = 4 Then ' I do these on two
    If obj.Status = 200 Then ' different lines to avoid certain error cases
        strData = obj.responseText
    End If
End If

obj.abort  ' in real code I use some on error resume next, so at this point it is possible I have a failed
           ' get and so best to abort it before I try again

Debug.Print strData

End Sub 
```

希望有帮助。

# javascript - 为显示/隐藏消息 Jquery 添加计时器间隔

> ID：11909585
> 
> 赞同：0
> 
> 时间：2012-08-10T21:35:50.733
> 
> 标签：javascript, jquery

我有显示警报消息并在 2 秒后隐藏它的 javascript 函数。这是上面的完整功能

```
function hideNotifyReport(noanimation)
{
    var el          = jQuery('#report-notify');

    var interval    = 2; // sec 

    if (noanimation)
    {
        el.hide();
        sizeNotifyReport();
    }
    else
    {   
        el.css('opacity', 1).animate({ opacity: 0 }, interval*2000, function()
        {
            hideNotifyReport(true);
        });
    }
} 
```

我的问题是这一行：

```
el.css('opacity', 1).animate({ opacity: 0 }, interval*2000, function() 
```

我想将间隔添加到不透明度 1 到该消息将在“n”时间和隐藏之后显示。问题是现在它显示并且隐藏得太快

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:38:51.417

[我认为这就是你想要的：](http://api.jquery.com/delay/)

```
el.css('opacity', 1).delay(interval*1000).animate({ opacity: 0 }, 1000, function(){... 
```

# sql - 约束一对多关系或创建具有预定义关系约束的表

> ID：11909589
> 
> 赞同：3
> 
> 时间：2012-08-10T21:36:28.820
> 
> 标签：sql, database, postgresql, database-design, database-schema

在我正在处理的项目中，我有一个需要定义为具有一对九关系的表，我想知道在数据库中创建它的最佳方法是什么？我在 PostgreSQL 工作。

我最初的想法是创建一个表并显式创建链接（请注意，actual_id 是因为系统我必须虚拟化 id，因为我需要唯一的表，但我还需要知道模板的实际 id 是什么）

```
CREATE TABLE template (
    id int,
    actual_id int,
    foreign_key0 int references other_table(id),
    foreign_key1 int references other_table(id),
    foreign_key2 int references other_table(id),
    foreign_key3 int references other_table(id),
    foreign_key4 int references other_table(id),
    foreign_key5 int references other_table(id),
    foreign_key6 int references other_table(id),
    foreign_key7 int references other_table(id),
    foreign_key8 int references other_table(id)
); 
```

但是，当我想在不再引用任何内容时从引用的表中清除数据时，这会产生一个问题。我也很肯定这从一开始就是糟糕的数据库设计。

我的另一个想法是我只会用一个约束来制作表格

```
CREATE TABLE template (
    id int,
    actual_id int,
    foreign_key0 int references other_table(id) ); 
```

但是这里的问题是我如何将其限制为只有 9 个对另一个表的引用？存储过程？以编程方式？

最终，如果我坚持第一种方式，我很确定我只需要将所有不同的外键选择到另一个只有一列的表中，然后将其与 other_table 的 id 进行比较。我不想这样做。看起来真的很傻。我真的很想用第二种方式来做，但我不知道如何最好地做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T09:27:53.533

1:n 关系总是可以反转为 n:1 。换句话说，而不是：

```
parent:field1 -> child1:id
parent:field2 -> child2:id
parent:field3 -> child3:id
....
parent:field9 -> child9 
```

你总是可以写：

```
child1:parent_id -> parent:id
child2:parent_id -> parent:id
child3:parent_id -> parent:id
....
child9:parent_id -> parent:id 
```

...并通过触发器或在应用程序中限制每个父母的孩子数量。这是我*强烈*推荐的方法。您需要一个可延迟的约束触发器来允许您插入任何内容。

如果要在数据库中强制执行，请使用约束触发器。给定虚拟模式：

```
CREATE TABLE parent (id serial primary key);
CREATE TABLE child( id serial primary key, parent_id integer references parent(id) );
INSERT INTO parent (id) values ( DEFAULT );
INSERT INTO child ( parent_id ) 
SELECT p.id FROM parent p CROSS JOIN generate_series(1,9) x; 
```

你可以写：

```
CREATE OR REPLACE FUNCTION children_per_parent() RETURNS TRIGGER AS $$
DECLARE
    n integer;
BEGIN
    IF TG_OP = 'INSERT' OR TG_OP = 'UPDATE' THEN
        SELECT INTO n count(id) FROM child WHERE parent_id = NEW.parent_id;
        IF n <> 9 THEN
            RAISE EXCEPTION 'During % of child: Parent id=% must have exactly 9 children, not %',tg_op,NEW.parent_id,n;
        END IF;
    END IF;

    IF TG_OP = 'UPDATE' OR TG_OP = 'DELETE' THEN
        SELECT INTO n count(id) FROM child WHERE parent_id = OLD.parent_id;
        IF n <> 9 THEN
            RAISE EXCEPTION 'During % of child: Parent id=% must have exactly 9 children, not %',tg_op,NEW.parent_id,n;
        END IF;
    END IF;

    RETURN NULL;
END;
$$ LANGUAGE 'plpgsql';

CREATE CONSTRAINT TRIGGER children_per_parent_tg
AFTER INSERT OR UPDATE OR DELETE ON child
DEFERRABLE INITIALLY DEFERRED
FOR EACH ROW EXECUTE PROCEDURE children_per_parent();

CREATE OR REPLACE parent_constrain_children() RETURNS trigger AS $$
DECLARE 
    n integer;
BEGIN
    IF TG_OP = 'INSERT' THEN
        SELECT INTO n count(id) FROM child WHERE parent_id = NEW.id;
        IF n <> 9 THEN
            RAISE EXCEPTION 'During INSERT of parent id=%: Must have 9 children, found %',NEW.id,n;
        END IF;
    END IF;
    -- No need for an UPDATE or DELETE check, as regular referential integrity constraints
    -- and the trigger on `child' will do the job.
    RETURN NULL;
END;
$$ LANGUAGE 'plpgsql';

CREATE CONSTRAINT TRIGGER parent_limit_children_tg
AFTER INSERT ON parent
DEFERRABLE INITIALLY DEFERRED
FOR EACH ROW EXECUTE PROCEDURE parent_constrain_children(); 
```

请注意，上面有两个触发器。对孩子的触发是显而易见的。需要在父级上触发以防止插入没有任何子级的父级。

现在观察一个测试：

```
regress=# delete from child;
ERROR:  During DELETE: Parent id 1 must have exactly 9 children, not 0
regress=# insert into child( parent_id) SELECT id FROM parent;
ERROR:  During INSERT: Parent id 1 must have exactly 9 children, not 10 
```

因为延迟约束触发器是在事务提交时检查的，而不是立即或在语句结束时检查，所以您仍然可以这样做：

```
regress# BEGIN;
BEGIN
regress# INSERT INTO parent (id) values ( DEFAULT ) RETURNING id;
 id 
----
  2
INSERT 0 1
regress# insert into child ( parent_id ) SELECT p.id FROM parent p CROSS JOIN generate_series(1,9) x WHERE p.id = 4;
INSERT 0 9
regress# COMMIT;
COMMIT 
```

...但是如果您将“generate_series”最大值更改为 8 或 10，或者完全不插入任何子项，COMMIT 将失败，例如：

```
regress=# commit;
ERROR:  During INSERT: Parent id 5 must have exactly 9 children, not 8 
```

如果您只要求每个父级*最多*有 9 个子级，而不是*上述*触发器中实现的 9 个子级，则可以删除`DEFERRABLE INITIALLY DEFERRED`，将 更改`<> 9`为`<= 9`，然后删除触发器`DELETE`中的处理程序`child`。

* * *

顺便说一句，如果我在 Java 或其他一些相当聪明的 ORM 中使用 JPA，我只会限制父级的子级集合的大小：

```
@Entity
public Parent {

    @Column
    @Size(min=9,max=9)
    private Collection<Child> collectionOfChildren;

} 
```

方式更简单，尽管没有在数据库级别强制执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:44:27.680

> 但是，当我想在不再引用任何内容时从引用的表中清除数据时，这会产生一个问题。

如果我理解正确，您希望自动删除悬空指针。会有`... REFERENCES other_table(id) ON DELETE CASCADE`帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T10:49:34.607

一个不同的想法。这是一对多的关系（只有 n 限制为 9），在一对多的关系中，外键引用与您所拥有的方式相反。

因此，以`FOREIGN KEY`另一种方式制作约束（奖励：您只需要一个这种方式）并添加一`counter`列和一个`CHECK`约束以将相关行数限制为最大 9：

```
CREATE TABLE template (
    template_id int,
    actual_id int,
    PRIMARY KEY (template_id)
);

CREATE TABLE other_table (
    other_table_id int,
    template_id,
    counter smallint NOT NULL,
    --- other columns,
    PRIMARY KEY (other_table_id),
    UNIQUE KEY (template_id, counter),
    CHECK (counter BETWEEN 1 AND 9),
    FOREIGN KEY (template_id)
       REFERENCES template (template_id) 
); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-11T08:26:08.467

我认为这不能通过约束来完成，请参阅[如何编写关于 postgresql 中最大行数的约束？](https://stackoverflow.com/q/1743439/)有几个想法。

下面我写了一个例子，其中 a使用以下假设`foo`保持与 a 的关系计数：`bar`

*   foos 和 bar 是独立的实体，它们的生命周期不相互依赖
*   关系存储在单独的`foo2bar`映射表中
*   必须首先从映射表中删除映射
*   删除没有关系的 foos 和 bar 被忽略

* * *

```
\pset pager off

begin;

create table foo(id serial primary key, data text not null,
                 bar_count integer check(bar_count >= 0 and bar_count <= 3));

create table bar(id serial primary key, data text not null);

create table foo2bar(id serial primary key,
                     foo_id integer not null references foo(id),
                     bar_id integer not null references bar(id));

create or replace function trigger_update_bar_count() returns trigger
as $$
declare
  v_bar_count integer := 0;
begin
  if TG_OP = 'INSERT' then
    select count(*) into v_bar_count from foo2bar where foo_id = new.foo_id;

    update foo
       set bar_count = v_bar_count + 1
     where id = new.foo_id;

    return new;
   elsif TG_OP = 'DELETE' then
    select count(*) into v_bar_count from foo2bar where foo_id = old.foo_id;

    update foo
       set bar_count = v_bar_count - 1
     where id = old.foo_id;

    return old;
  end if;

end;
$$ language plpgsql;

create trigger trigger_foo2bar_1
before insert or delete on foo2bar
for each row execute procedure trigger_update_bar_count();

insert into foo(data) values('foo 1');

insert into bar(data) values('bar 1');
insert into foo2bar(foo_id, bar_id) values(currval('foo_id_seq'),
                                           currval('bar_id_seq'));

insert into bar(data) values('bar 2');
insert into foo2bar(foo_id, bar_id) values(currval('foo_id_seq'),
                                           currval('bar_id_seq'));
insert into bar(data) values('bar 3');
insert into foo2bar(foo_id, bar_id) values(currval('foo_id_seq'),
                                           currval('bar_id_seq'));

insert into foo(data) values('foo 2');

insert into bar(data) values('bar 4');
insert into foo2bar(foo_id, bar_id) values(currval('foo_id_seq'),
                                           currval('bar_id_seq'));
insert into bar(data) values('bar 5');
insert into foo2bar(foo_id, bar_id) values(currval('foo_id_seq'),
                                           currval('bar_id_seq'));
insert into bar(data) values('bar 6');
insert into foo2bar(foo_id, bar_id) values(currval('foo_id_seq'),
                                           currval('bar_id_seq'));

insert into foo(data) values('foo 3');

insert into bar(data) values('bar 7');
insert into foo2bar(foo_id, bar_id) values(currval('foo_id_seq'),
                                           currval('bar_id_seq'));
insert into bar(data) values('bar 8');
insert into foo2bar(foo_id, bar_id) values(currval('foo_id_seq'),
                                           currval('bar_id_seq'));
insert into bar(data) values('bar 9');
insert into foo2bar(foo_id, bar_id) values(currval('foo_id_seq'),
                                           currval('bar_id_seq'));

-- deletes only mappings
delete from foo2bar where foo_id = 1;
delete from foo2bar where bar_id = 6;

-- This will raise because the check constraint will be violated
-- insert into bar(data) values('bar 10');
-- insert into foo2bar(foo_id, bar_id) values(currval('foo_id_seq'),
--                                            currval('bar_id_seq'));

select * from foo order by id;
select * from bar order by id;
select * from foo2bar order by id;

select foo.data as foo, bar.data as bar
  from foo2bar
 inner join foo on foo2bar.foo_id = foo.id
 inner join bar on foo2bar.bar_id = bar.id
 order by foo2bar.id
;

rollback; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-11T10:59:36.883

可维护和灵活的方法是规范化。而不是仅仅这样做：

```
CREATE TABLE template (
    id int,
    actual_id int,
    foreign_key0 int references other_table(id),
    foreign_key1 int references other_table(id),
    foreign_key2 int references other_table(id),
    foreign_key3 int references other_table(id),
    foreign_key4 int references other_table(id),
    foreign_key5 int references other_table(id),
    foreign_key6 int references other_table(id),
    foreign_key7 int references other_table(id),
    foreign_key8 int references other_table(id)
); 
```

用规范化的方式做，引入第三个表（template_ *assoc* _other_table）：

```
CREATE TABLE template (
    id int not null primary key,
    actual_id int -- I don't what is this
    -- ...other fields here
);

create table template__assoc__other_table
(
    template_id int not null references template(id),
    other_table_id int not null references other_table(id),
    constraint pk_template__assoc__other_table 
        primary key (template_id, other_table_id)
); 
```

# android - Android中的多个重复AsyncTask

> ID：11909594
> 
> 赞同：0
> 
> 时间：2012-08-10T21:36:51.287
> 
> 标签：android, android-asynctask, android-service, android-ui

我有两个 asynctask 互相工作。我正在使用它们来创建餐厅菜单。第一个 Web 服务从数据库中获取菜单的标题。第二个 Web 服务从数据库中获取标题项目。我在第一个异步任务中获取标题数据，在第二个异步任务中获取项目数据。

例如，我有十个菜单标题。每个标题有八个项目。我执行第一个 asynctask 并获取所有菜单标题。我想在第一个 asynctask 的 onPostExecute 中调用第二个 asynctask 以获取此标题的项目并添加 TextView。我必须等待完成每个第二个任务才能分别添加项目。

**简而言之，我需要先调用 AsyncTask 并等待完成它。然后向 First AsyncTask 中的第二个 AsyncTask 发送请求。我必须等待每个请求完成。我怎么能等？**

这是我的代码。

第一个异步任务

```
public class BaslikDoldurAS extends AsyncTask<String,String[][],String[][]>{
        int ParamID;

        public BaslikDoldurAS(String ParamID){
            this.ParamID=Integer.parseInt(ParamID);
        }

        @Override
        protected String[][] doInBackground(String... params) {
            BaslikDoldur(ParamID);
            return sonuc;
        }

        protected void onPostExecute(String[][] sonuc){
            for(int i=0;i<baslikCount;i++){ 
                 MenuDoldurAS kontrol = new MenuDoldurAS(firma_id,sonuc[2][i]);
                 kontrol.execute();
            } 
        }
    } 
```

我在第一个 asyncTask 中使用的函数

```
private String[][] BaslikDoldur(Integer ParamID){
        PropertyInfo id = new PropertyInfo();
        id.name= "id";
        id.setValue(ParamID);
        id.type = PropertyInfo.INTEGER_CLASS;

        SoapObject request = new SoapObject(NAMESPACE, "BaslikDoldur");
        request.addProperty(id);
        SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
        envelope.bodyOut=request;
        envelope.dotNet = true;     
        envelope.setOutputSoapObject(request);

        HttpTransportSE androidHttpTransport = new HttpTransportSE(MenuURL);
        androidHttpTransport.debug = true;

        try {

            androidHttpTransport.call("http://tempuri.org/BaslikDoldur", envelope);
            SoapObject response = (SoapObject) envelope.getResponse();

            sonuc[2]=new String[response.getPropertyCount()]; //baslik
            baslikCount=response.getPropertyCount();

            for(int i=0;i<response.getPropertyCount();i++){    
                   Object property = response.getProperty(i);
                   if(property instanceof SoapObject){
                       SoapObject menu = (SoapObject) property;
                       sonuc[2][i] = menu.getProperty("menu_baslik").toString();
                   }
            }
     } 
             catch (Exception e) {          
                e.printStackTrace();
            }
        return sonuc;

    } 
```

第二个异步任务

```
public class MenuDoldurAS extends AsyncTask<String,String[][],String[][]>{
        int ParamID;
        String Baslik;

        public MenuDoldurAS(String ParamID,String Baslik){
            this.ParamID=Integer.parseInt(ParamID);
            this.Baslik=Baslik;
        }
        @Override
        protected String[][] doInBackground(String... params) {
            MenuDoldur(ParamID,Baslik);
            return sonuc;
        }

        protected void onPostExecute(String[][] sonuc){
            for(int i=0;i<count;i++){
                String baslik="";
                if(!baslik.equals(sonuc[2][i])){
                    baslik=sonuc[2][i];
                    TextView basliktxt = new TextView(Urun.this);
                    basliktxt.setText(sonuc[2][i]);
                    basliktxt.setTextSize(20);
                    basliktxt.setTextColor(Color.RED);
                    basliktxt.setGravity(Gravity.CENTER_VERTICAL | Gravity.CENTER_HORIZONTAL);
                    urunLayout.addView(basliktxt);
                }
                else{
                    TextView aciklamatxt = new TextView(Urun.this);
                    aciklamatxt.setText(sonuc[3][i]);
                    aciklamatxt.setTextColor(Color.parseColor("#0c0c7c"));
                    aciklamatxt.setTextSize(17);
                    aciklamatxt.setGravity(Gravity.CENTER_VERTICAL | Gravity.CENTER_HORIZONTAL);
                    urunLayout.addView(aciklamatxt);
                }
            }   
        }

    } 
```

我在第二个 asyncTask 中使用的函数

```
private String[][] MenuDoldur(Integer ParamID,String Baslik){
        PropertyInfo id = new PropertyInfo();
        id.name= "id";
        id.setValue(ParamID);
        id.type = PropertyInfo.INTEGER_CLASS;

        PropertyInfo baslik = new PropertyInfo();
        baslik.name= "baslik";
        baslik.setValue(Baslik);
        baslik.type = PropertyInfo.STRING_CLASS;

        SoapObject request = new SoapObject(NAMESPACE, "MenuDoldur");
        request.addProperty(id);
        SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
        envelope.bodyOut=request;
        envelope.dotNet = true;     
        envelope.setOutputSoapObject(request);

        HttpTransportSE androidHttpTransport = new HttpTransportSE(MenuURL);
        androidHttpTransport.debug = true;

        try {

            androidHttpTransport.call("http://tempuri.org/MenuDoldur", envelope);
            SoapObject response = (SoapObject) envelope.getResponse();

            sonuc[3]=new String[response.getPropertyCount()]; //aciklama ve fiyat
            count = response.getPropertyCount();

            for(int i=0;i<response.getPropertyCount();i++){    
                   Object property = response.getProperty(i);
                   if(property instanceof SoapObject){
                       SoapObject menu = (SoapObject) property;
                       sonuc[3][i] = menu.getProperty("menu_aciklama").toString() + " - " + menu.getProperty("menu_fiyat").toString();
                   }
            }
     } 
             catch (Exception e) {          
                e.printStackTrace();
            }
        return sonuc;   

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T22:33:20.337

如果你想等到所有 AsyncTask 都完成后再继续，为什么不把所有的工作都放在第一个 AsyncTask 的 doInBackground 中呢？

或者您不想这样做，因为您想并行运行 10 个“第二个任务”？（顺便说一句，你什么也没做，因为你没有使用 THREAD_POOL Executor 来执行你的任务。）如果是这种情况，那么为什么不做类似的事情

```
// variable accessible to both tasks
ArrayList<AsyncTask> mRunningTasks = new ArrayList<AsyncTask>();
// AsyncTask1
protected void onPostExecute(String[][] sonuc){
    for(int i=0;i<baslikCount;i++){ 
         MenuDoldurAS kontrol = new MenuDoldurAS(firma_id,sonuc[2][i]);
         mRunningTasks.add(kontrol);
    }
    for (AsyncTask task : mRunningTasks) {
        task.execute();
    }
}

// AsyncTask2
protected void onPostExecute(...) {
    boolean allComplete = true;
    for (AsyncTask task : mRunningTasks) {
      if (!task.getStatus().equals(AsyncTask.Status.FINISHED)) {
          allComplete = false;
          break;
      }
    }
    if (allComplete) {
       //do whatever
       mRunningTasks.clear();
    }
} 
```

# python - Python 字符串解释和解析

> ID：11909602
> 
> 赞同：0
> 
> 时间：2012-08-10T21:37:40.163
> 
> 标签：python, string, syntax, command, interpretation

我正在尝试学习如何在 python 中解释和解析字符串。我想做一个“字符串命令”（不知道是否是正确的表达方式）。但为了更好地解释，我将举一个例子：我想要一个像 SQL 中的命令，其中有一个带有关键字的字符串，它将使进程执行所要求的操作。像这样：`cursor.execute("UPDATE Cars SET Price=? WHERE Id=?", (50000, 1))`。但我想为我的项目创建这样的格式（不一定要使用 sql）：`mydef("U={Cars[Price=50000], Id=1}")`

```
Syntax table: <command>={<table>[<value name>=<value (int/str/float/bool)>], <id>=<value to id>}
Where command is: U=update, C=create, S=select, I=insert, D=delete 
```

好吧，我真的很想学习如何在 Python 中做到这一点。如果可以的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:27:39.897

Pyparsing 是一个简单的纯 Python、占用空间小、自由许可的模块，用于创建像您描述的那样的解析器。以下是我在 PyCon'06（为 Texas Python UnConference，2008 年更新）所做的一些演示，一个是 pyparsing 本身的介绍，另一个是使用 pyparsing 解析和执行简单命令语言的演示（一个文本冒险游戏）。

Pyparsing 简介 - [http://www.ptmcg.com/geo/python/confs/TxUnconf2008Pyparsing.html](http://www.ptmcg.com/geo/python/confs/TxUnconf2008Pyparsing.html)

一个简单的冒险游戏命令解析器 - [http://www.ptmcg.com/geo/python/confs/pyCon2006_pres2.html](http://www.ptmcg.com/geo/python/confs/pyCon2006_pres2.html)

两个演示文稿都是使用 S5 编写的，因此如果您将鼠标移到右下角，您会看到 << 和 >> 按钮，一个 Ø 按钮可以将整个演示文稿视为一个可打印的网页，以及一个用于跳转的组合框到特定页面。

[您可以在http://pyparsing.wikispaces.com](http://pyparsing.wikispaces.com)找到更多关于 pyparsing 的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:51:07.180

为了清楚起见，您知道 Python2.5+ 包含 sqlite 吗？

```
import sqlite3
conn = sqlite3.connect(dbname.db)
curs = conn.cursor()
curs.execute("""CREATE TABLE Cars (UID INTEGER PRIMARY KEY, \
        "Id" VARCHAR(42), \
        "Price" VARCHAR(42))""")
curs.execute("UPDATE Cars SET Price=? WHERE Id=?", (50000, 1)) 
```

编辑添加：我实际上并没有测试这个；你至少需要一个插入语句来完成这项工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T14:08:56.277

我做了这个代码，我不知道这是否可行。只是想要意见。

```
>>> s = '<command>={<table>[<value name>=<value>], <id>=<value id>}'
>>> s1 = s.split('=', 1)
>>> s2 = s1[1].split(',', 1)
>>> s2 = s1[1].replace('{', '').replace('}', '').split(',', 1)
>>> s3 = s2[0].replace(']', '').split('[')
>>> s4 = s3[1].split('=')
>>> s1
['<command>', '{<table>[<value name>=<value>], <id>=<value id>}']
>>> s2
['<table>[<value name>=<value>]', ' <id>=<value id>']
>>> s3
['<table>', '<value name>=<value>']
>>> s4
['<value name>', '<value>']
>>> s5 = s2[1].split('=') 
```

拆分整个命令并获取参数：

```
<command>={<table>[<value name>=<value>],<id>=<value id>}
["<command>", "{<table>[<value name>=<value>],<id>=<value id>}"]
["<table>[<value name>=<value>]", "<id>=<value id>"]
["<table>", "<value name>=<value>"]
["<value name>", "<value>"]
["<id>", "<value id>"] 
```

# ruby-on-rails - 使用 DEFLATE 压缩的连接，托管在 Heroku 上，但机架中间件不使用 Rack::Deflater 报告

> ID：11909610
> 
> 赞同：1
> 
> 时间：2012-08-10T21:38:34.970
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, heroku, rack, deflate

Chrome 声称与我的网站的连接是用 DEFLATE 压缩的。问题是我没有使用 Rack::Deflater （我在运行 rake 中间件时看不到它）。我的登台站点与我的生产站点具有几乎完全相同的配置......并且该连接没有被压缩。

我不确定是什么导致与我的生产站点的连接被压缩 - 有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:35:19.300

你在哪个栈上，竹子还是雪松？您的环境是否使用不同的堆栈？

我相信[Bamboo 具有自动 gzip 压缩功能。](https://devcenter.heroku.com/articles/http-routing-bamboo)

Cedar 没有，您需要包含您描述的中间件。

# jquery - 选择几个元素jQuery

> ID：11909623
> 
> 赞同：2
> 
> 时间：2012-08-10T21:39:32.317
> 
> 标签：jquery, html, css, forms, jquery-selectors

我对 jQuery 很陌生，所以如果这听起来很愚蠢，请不要跳我。我想知道是否有一种方法可以选择其中的“#ammountbest2”、“input”和“textarea”，这样我就可以使用一个选择器一次隐藏和清除其中的值，所以我不会必须拼出每一个。像兄弟姐妹或父母之类的东西。有了它，我可以在最后附上：“.val('').css('display', none')”

```
$('#ammountbest').change(function () {
var ammountbest = ""

$('#ammountbest option:selected').each(function () {
    ammountbest += $(this).text() + "";});

if(ammountbest == "0") {$('#ammountbest1,#ammountbest2').css('display', 'none');}   
if(ammountbest == "1") {
    $('#ammountbest1').css('display', 'block');
    $('#ammountbest2 input,#ammountbest2 textarea').val('');
    $('#ammountbest2').css('display', 'none');
    }
if(ammountbest == "2") {
    $('#ammountbest1,#ammountbest2').css('display', 'block');
    }
})
.trigger('change');

<select id="ammountbest">
    <option>0</option>
    <option>1</option>
    <option>2</option>
</select>

<!-- 1 Winners -->
<div id="ammountbest1" style="display:none;">
<label for="besttitle1" title="Title">Title 01:</label><br>
<input name="besttitle1" id="besttitle1" size="30" type="input">
<label for="bestschool1" title="School">School 01:</label><br>
<input name="bestschool1" id="bestschool1" size="30" type="input">
<label for="bestvideo1" title="Video">Video Embed Code 01:</label><br>
<textarea name="bestvideo1" id="bestvideo1" cols="30" rows="5"></textarea>
</div>

<!-- 2 Winners -->
<div id="ammountbest2" style="display:none;">
<label for="besttitle2" title="Title">Title 02:</label><br>
<input name="besttitle2" id="besttitle2" size="30" type="input">
<label for="bestschool2" title="School">School 02:</label><br>
<input name="bestschool2" id="bestschool2" size="30" type="input">
<label for="bestvideo2" title="Video">Video Embed Code 02:</label><br>
<textarea name="bestvideo2" id="bestvideo2" cols="30" rows="5"></textarea>
</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T21:42:13.423

最简单的方法是简单地在一个 jQuery 对象中指定两个对象：

```
$('#ammountbest2 input, #ammountbest2 textarea') 
```

当然，您可以改用：

```
$('#ammountbest2').children() 
```

* * *

**针对 OP 的评论进行了**编辑：****

 **> 我不想要第一个选项的原因是代码变得很大，因为我有 7 个像这样填充输入和 txtarea 的 div，所有这些都必须立即隐藏和清除。

要根据上面发布的 HTML 选择多个元素，假设格式保持可预测且一致，我建议：

```
$('div[id^=ammountbest]').children('input, textarea').val('').andSelf().hide() 
```

（编辑为根据 OP 的原始问题故意拼错单词`ammount`（原文如此）。）

参考：

*   [属性开始值`[attribute^="value"]`选择器](http://api.jquery.com/attribute-starts-with-selector)。
*   [`children()`](http://api.jquery.com/children/).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T21:47:20.450

使用类。

```
<div id="ammountbest1" class="amountbest" style="display:none;">
<div id="ammountbest2" class="amountbest" style="display:none;"> 
```

并像这样使用jquery选择器

```
$('.amountbest'); 
```

祝你好运 ！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T21:42:27.793

是的，您可以通过逗号分隔它们来指定多个选择器。试试这个：

```
$("#ammountbest1,#ammountbest1 input,#ammountbest1 textarea") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T21:44:29.520

您可以使用 . 分隔选择器`,`。这将分别运行每个选择器并在 jQuery 对象中收集所有结果。我可以看到你已经这样做了，但是你有一个可能导致问题的尾随逗号：

```
$('#ammountbest2 input,#ammountbest2 textarea,').val('');
                                             ^ there 
```

您还错过了一个单引号，以及另一个尾随逗号。

```
$('#ammountbest2,).css('display', 'none');
                ^ here 
```**

# c++ - C++：实现智能指针

> ID：11909626
> 
> 赞同：0
> 
> 时间：2012-08-10T21:39:47.690
> 
> 标签：c++, smart-pointers

我正在阅读实现智能指针，发现以下代码，

```
template <class T>
class SmartPtr
{
public:
explicit SmartPtr(T* pointee) : pointee_(pointee);
SmartPtr& operator=(const SmartPtr& other);
~SmartPtr();
T& operator*() const
{
...
return *pointee_;
}
T* operator->() const
{
...
return pointee_;
}
private:
T* pointee_;
...
}; 
```

我无法理解以下内容，

1.  “SmartPtr& operator=(const SmartPtr& other)”：为什么参数是常数？分配完成后它不会失去所有权吗？
2.  为什么我们需要“T& operator*() const”和“T* operator->() const”方法？

谢谢@

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:44:44.870

Point 1\. 不一定，取决于智能指针的设计。有些人喜欢`boost:shared_ptr`不转让所有权。

Point 2\. 这些方法模拟智能指针上的正常指针操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:42:25.313

回答`2.`：

模拟原始指针。您可以使用`*ptr`它来返回它指向的对象（就像一个 C 指针），并且您可以使用它`ptr->foo()`来调用 , 中的方法`foo`（`T`就像一个 C 指针）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T23:57:01.353

1.  我可以想到两种类型的智能指针语义可以与该签名一起使用。第一个是引用计数指针，如 std::shared_ptr。另一种是值语义，即复制指针会生成指向对象的新副本。此签名不适用于 auto_ptr/unique_ptr 之类的指针。

# ios - 等到两个异步块被执行后再开始另一个块

> ID：11909629
> 
> 赞同：200
> 
> 时间：2012-08-10T21:40:03.613
> 
> 标签：ios, objective-c, objective-c-blocks, grand-central-dispatch

使用 GCD 时，我们希望等到两个异步块执行完毕后再继续执行下一步。最好的方法是什么？

我们尝试了以下方法，但似乎不起作用：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^ {
    // block1
});

dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^ {
    // block2
});

// wait until both the block1 and block2 are done before start block3
// how to do that?

dispatch_sync(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^ {
    // block3
}); 
```

* * *

## 回答 #1

> 赞同：318
> 
> 时间：2012-08-10T22:05:16.537

使用调度组：请参阅[此处](http://developer.apple.com/library/ios/documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW25)的示例，Apple 的 iOS 开发人员库并发编程指南的“调度队列”一章中的“等待队列任务组”

您的示例可能如下所示：

```
dispatch_group_t group = dispatch_group_create();

dispatch_group_async(group,dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^ {
    // block1
    NSLog(@"Block1");
    [NSThread sleepForTimeInterval:5.0];
    NSLog(@"Block1 End");
});

dispatch_group_async(group,dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^ {
    // block2
    NSLog(@"Block2");
    [NSThread sleepForTimeInterval:8.0];
    NSLog(@"Block2 End");
});

dispatch_group_notify(group,dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^ {
    // block3
    NSLog(@"Block3");
});

// only for non-ARC projects, handled automatically in ARC-enabled projects.
dispatch_release(group); 
```

并且可以产生这样的输出：

```
2012-08-11 16:10:18.049 Dispatch[11858:1e03] Block1
2012-08-11 16:10:18.052 Dispatch[11858:1d03] Block2
2012-08-11 16:10:23.051 Dispatch[11858:1e03] Block1 End
2012-08-11 16:10:26.053 Dispatch[11858:1d03] Block2 End
2012-08-11 16:10:26.054 Dispatch[11858:1d03] Block3 
```

* * *

## 回答 #2

> 赞同：282
> 
> 时间：2014-01-03T18:47:57.497

扩展 Jörn Eyrich 的回答（如果你支持这个回答，请支持他的回答），如果你无法控制对块的`dispatch_async`调用，就像异步完成块的情况一样，你可以使用 GCD 组直接使用`dispatch_group_enter`和`dispatch_group_leave`。

在这个例子中，我们假装`computeInBackground`是我们无法改变的东西（想象它是一个委托回调、NSURLConnection completionHandler 或其他），因此我们无权访问调度调用。

```
// create a group
dispatch_group_t group = dispatch_group_create();

// pair a dispatch_group_enter for each dispatch_group_leave
dispatch_group_enter(group);     // pair 1 enter
[self computeInBackground:1 completion:^{
    NSLog(@"1 done");
    dispatch_group_leave(group); // pair 1 leave
}];

// again... (and again...)
dispatch_group_enter(group);     // pair 2 enter
[self computeInBackground:2 completion:^{
    NSLog(@"2 done");
    dispatch_group_leave(group); // pair 2 leave
}];

// Next, setup the code to execute after all the paired enter/leave calls.
//
// Option 1: Get a notification on a block that will be scheduled on the specified queue:
dispatch_group_notify(group, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^{
    NSLog(@"finally!");
});

// Option 2: Block an wait for the calls to complete in code already running
// (as cbartel points out, be careful with running this on the main/UI queue!):
//
// dispatch_group_wait(group, DISPATCH_TIME_FOREVER); // blocks current thread
// NSLog(@"finally!"); 
```

在此示例中，computeInBackground:completion: 实现为：

```
- (void)computeInBackground:(int)no completion:(void (^)(void))block {
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^{
        NSLog(@"%d starting", no);
        sleep(no*2);
        block();
    });
} 
```

输出（带有运行的时间戳）：

```
12:57:02.574  2 starting
12:57:02.574  1 starting
12:57:04.590  1 done
12:57:06.590  2 done
12:57:06.591  finally! 
```

* * *

## 回答 #3

> 赞同：121
> 
> 时间：2017-03-25T23:00:31.357

使用 Swift 5.1，*Grand Central Dispatch*提供了多种解决问题的方法。根据您的需要，您可以选择以下 Playground 片段中显示的**七种模式之一。**

* * *

### #1。使用[`DispatchGroup`](https://developer.apple.com/documentation/dispatch/dispatchgroup),和`DispatchGroup`' s[`notify(qos:flags:queue:execute:)`](https://developer.apple.com/documentation/dispatch/dispatchgroup/2016066-notify)[`DispatchQueue`](https://developer.apple.com/documentation/dispatch/dispatchqueue)[`async(group:qos:flags:execute:)`](https://developer.apple.com/documentation/dispatch/dispatchqueue/2016098-async)

Apple Developer Concurrency Programming Guide[指出`DispatchGroup`](https://developer.apple.com/library/archive/documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW25)：

> 调度组是一种阻塞线程直到一个或多个任务完成执行的方法。您可以在完成所有指定任务之前无法取得进展的地方使用此行为。例如，在分派多个任务来计算一些数据之后，您可能会使用一个组来等待这些任务，然后在它们完成后处理结果。

```
import Foundation
import PlaygroundSupport

PlaygroundPage.current.needsIndefiniteExecution = true

let queue = DispatchQueue(label: "com.company.app.queue", attributes: .concurrent)
let group = DispatchGroup()

queue.async(group: group) {
    print("#1 started")
    Thread.sleep(forTimeInterval: 5)
    print("#1 finished")
}

queue.async(group: group) {
    print("#2 started")
    Thread.sleep(forTimeInterval: 2)
    print("#2 finished")
}

group.notify(queue: queue) {
    print("#3 finished")
}

/*
 prints:
 #1 started
 #2 started
 #2 finished
 #1 finished
 #3 finished
 */ 
```

* * *

### #2。使用[`DispatchGroup`](https://developer.apple.com/documentation/dispatch/dispatchgroup), `DispatchGroup`'s [`wait()`](https://developer.apple.com/documentation/dispatch/dispatchgroup/2016090-wait), `DispatchGroup`'s[`enter()`](https://developer.apple.com/documentation/dispatch/dispatchgroup/1452803-enter)和`DispatchGroup`'s[`leave()`](https://developer.apple.com/documentation/dispatch/dispatchgroup/1452872-leave)

```
import Foundation
import PlaygroundSupport

PlaygroundPage.current.needsIndefiniteExecution = true

let queue = DispatchQueue(label: "com.company.app.queue", attributes: .concurrent)
let group = DispatchGroup()

group.enter()
queue.async {
    print("#1 started")
    Thread.sleep(forTimeInterval: 5)
    print("#1 finished")
    group.leave()
}

group.enter()
queue.async {
    print("#2 started")
    Thread.sleep(forTimeInterval: 2)
    print("#2 finished")
    group.leave()
}

queue.async {
    group.wait()
    print("#3 finished")
}

/*
 prints:
 #1 started
 #2 started
 #2 finished
 #1 finished
 #3 finished
 */ 
```

请注意，您也可以`DispatchGroup` `wait()`与混合`DispatchQueue` `async(group:qos:flags:execute:)`或混合`DispatchGroup` `enter()`与`DispatchGroup` `leave()`。`DispatchGroup` `notify(qos:flags:queue:execute:)`

* * *

### #3。使用and的[`Dispatch​Work​Item​Flags`](https://developer.apple.com/documentation/dispatch/dispatchworkitemflags) [`barrier`](https://developer.apple.com/documentation/dispatch/dispatchworkitemflags/1780674-barrier)[`DispatchQueue`](https://developer.apple.com/documentation/dispatch/dispatchqueue)[`async(group:qos:flags:execute:)`](https://developer.apple.com/documentation/dispatch/dispatchqueue/2016098-async)

[Swift 4 的 Grand Central Dispatch 教程：](https://www.raywenderlich.com/5370-grand-central-dispatch-tutorial-for-swift-4-part-1-2)来自 Raywenderlich.com 的第 1/2 部分文章给出了*障碍*的定义：

> Dispatch Barriers 是一组在处理并发队列时充当串行式瓶颈的函数。当您向`DispatchWorkItem`调度队列提交 a 时，您可以设置标志以指示它应该是该特定时间在指定队列上执行的唯一项目。这意味着在调度屏障之前提交到队列的所有项目必须在`DispatchWorkItem`执行之前完成。

用法：

```
import Foundation
import PlaygroundSupport

PlaygroundPage.current.needsIndefiniteExecution = true

let queue = DispatchQueue(label: "com.company.app.queue", attributes: .concurrent)

queue.async {
    print("#1 started")
    Thread.sleep(forTimeInterval: 5)
    print("#1 finished")
}

queue.async {
    print("#2 started")
    Thread.sleep(forTimeInterval: 2)
    print("#2 finished")
}

queue.async(flags: .barrier) {
    print("#3 finished")
}

/*
 prints:
 #1 started
 #2 started
 #2 finished
 #1 finished
 #3 finished
 */ 
```

* * *

### #4。使用[`DispatchWorkItem`](https://developer.apple.com/documentation/dispatch/dispatchworkitem),和[`Dispatch​Work​Item​Flags`](https://developer.apple.com/documentation/dispatch/dispatchworkitemflags)' s[`barrier`](https://developer.apple.com/documentation/dispatch/dispatchworkitemflags/1780674-barrier)[`DispatchQueue`](https://developer.apple.com/documentation/dispatch/dispatchqueue)[`async(execute:)`](https://developer.apple.com/documentation/dispatch/dispatchqueue/2016103-async)

```
import Foundation
import PlaygroundSupport

PlaygroundPage.current.needsIndefiniteExecution = true

let queue = DispatchQueue(label: "com.company.app.queue", attributes: .concurrent)

queue.async {
    print("#1 started")
    Thread.sleep(forTimeInterval: 5)
    print("#1 finished")
}

queue.async {
    print("#2 started")
    Thread.sleep(forTimeInterval: 2)
    print("#2 finished")
}

let dispatchWorkItem = DispatchWorkItem(qos: .default, flags: .barrier) {
    print("#3 finished")
}

queue.async(execute: dispatchWorkItem)

/*
 prints:
 #1 started
 #2 started
 #2 finished
 #1 finished
 #3 finished
 */ 
```

* * *

### #5。使用[`DispatchSemaphore`](https://developer.apple.com/documentation/dispatch/dispatchsemaphore),和`DispatchSemaphore`' s[`wait()`](https://developer.apple.com/documentation/dispatch/dispatchsemaphore/2016071-wait)`DispatchSemaphore`[`signal()`](https://developer.apple.com/documentation/dispatch/dispatchsemaphore/1452919-signal)

Soroush Khanlou 在[GCD 手册](http://khanlou.com/2016/04/the-GCD-handbook/)博客文章中写道：

> 使用信号量，我们可以阻塞一个线程任意时间，直到另一个线程的信号被发送。与 GCD 的其余部分一样，信号量是线程安全的，可以从任何地方触发。当有一个异步 API 需要同步，但不能修改时，可以使用信号量。

Apple Developer API Reference 还为`DispatchSemaphore` [`init(value:​)`](https://developer.apple.com/documentation/dispatch/dispatchsemaphore/1452955-init)初始化器提供了以下讨论：

> 当两个线程需要协调特定事件的完成时，将值传递为零很有用。传递大于零的值对于管理有限的资源池很有用，其中池大小等于该值。

用法：

```
import Foundation
import PlaygroundSupport

PlaygroundPage.current.needsIndefiniteExecution = true

let queue = DispatchQueue(label: "com.company.app.queue", attributes: .concurrent)
let semaphore = DispatchSemaphore(value: 0)

queue.async {
    print("#1 started")
    Thread.sleep(forTimeInterval: 5)
    print("#1 finished")
    semaphore.signal()
}

queue.async {
    print("#2 started")
    Thread.sleep(forTimeInterval: 2)
    print("#2 finished")
    semaphore.signal()
}

queue.async {
    semaphore.wait()
    semaphore.wait()    
    print("#3 finished")
}

/*
 prints:
 #1 started
 #2 started
 #2 finished
 #1 finished
 #3 finished
 */ 
```

* * *

### #6。使用[`OperationQueue`](https://developer.apple.com/documentation/foundation/operationqueue)and`Operation`的[`addDependency(_:)`](https://developer.apple.com/documentation/foundation/operation/1412859-adddependency)

Apple Developer API Reference 指出`Operation​Queue`：

> 操作队列使用`libdispatch`库（也称为 Grand Central Dispatch）来启动其操作的执行。

用法：

```
import Foundation
import PlaygroundSupport

PlaygroundPage.current.needsIndefiniteExecution = true

let operationQueue = OperationQueue()

let blockOne = BlockOperation {
    print("#1 started")
    Thread.sleep(forTimeInterval: 5)
    print("#1 finished")
}

let blockTwo = BlockOperation {
    print("#2 started")
    Thread.sleep(forTimeInterval: 2)
    print("#2 finished")
}

let blockThree = BlockOperation {
    print("#3 finished")
}

blockThree.addDependency(blockOne)
blockThree.addDependency(blockTwo)

operationQueue.addOperations([blockThree, blockTwo, blockOne], waitUntilFinished: false)

/*
 prints:
 #1 started
 #2 started
 #2 finished
 #1 finished
 #3 finished
 or
 #2 started
 #1 started
 #2 finished
 #1 finished
 #3 finished
 */ 
```

* * *

### #7。使用[`OperationQueue`](https://developer.apple.com/documentation/foundation/operationqueue)and `OperationQueue`（[`addBarrierBlock(_:)`](https://developer.apple.com/documentation/foundation/operationqueue/3172534-addbarrierblock)需要 iOS 13）

```
import Foundation
import PlaygroundSupport

PlaygroundPage.current.needsIndefiniteExecution = true

let operationQueue = OperationQueue()

let blockOne = BlockOperation {
    print("#1 started")
    Thread.sleep(forTimeInterval: 5)
    print("#1 finished")
}

let blockTwo = BlockOperation {
    print("#2 started")
    Thread.sleep(forTimeInterval: 2)
    print("#2 finished")
}

operationQueue.addOperations([blockTwo, blockOne], waitUntilFinished: false)
operationQueue.addBarrierBlock {
    print("#3 finished")
}

/*
 prints:
 #1 started
 #2 started
 #2 finished
 #1 finished
 #3 finished
 or
 #2 started
 #1 started
 #2 finished
 #1 finished
 #3 finished
 */ 
```

* * *

## 回答 #4

> 赞同：58
> 
> 时间：2013-10-25T03:27:45.300

另一个 GCD 替代方案是障碍：

```
dispatch_queue_t queue = dispatch_queue_create("com.company.app.queue", DISPATCH_QUEUE_CONCURRENT);

dispatch_async(queue, ^{ 
    NSLog(@"start one!\n");  
    sleep(4);  
    NSLog(@"end one!\n");
});

dispatch_async(queue, ^{  
    NSLog(@"start two!\n");  
    sleep(2);  
    NSLog(@"end two!\n"); 
});

dispatch_barrier_async(queue, ^{  
    NSLog(@"Hi, I'm the final block!\n");  
}); 
```

只需创建一个并发队列，分派您的两个块，然后用屏障分派最后一个块，这将使其等待其他两个完成。

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2013-01-26T19:43:03.707

我知道你问过 GCD，但如果你愿意，`NSOperationQueue`也可以非常优雅地处理这类事情，例如：

```
NSOperationQueue *queue = [[NSOperationQueue alloc] init];

NSOperation *completionOperation = [NSBlockOperation blockOperationWithBlock:^{
    NSLog(@"Starting 3");
}];

NSOperation *operation;

operation = [NSBlockOperation blockOperationWithBlock:^{
    NSLog(@"Starting 1");
    sleep(7);
    NSLog(@"Finishing 1");
}];

[completionOperation addDependency:operation];
[queue addOperation:operation];

operation = [NSBlockOperation blockOperationWithBlock:^{
    NSLog(@"Starting 2");
    sleep(5);
    NSLog(@"Finishing 2");
}];

[completionOperation addDependency:operation];
[queue addOperation:operation];

[queue addOperation:completionOperation]; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-02-24T09:58:04.180

上面的答案都很酷，但他们都错过了一件事。`dispatch_group_enter`group 在您使用/时在其输入的线程中执行任务（块）`dispatch_group_leave`。

```
- (IBAction)buttonAction:(id)sender {
      dispatch_queue_t demoQueue = dispatch_queue_create("com.demo.group", DISPATCH_QUEUE_CONCURRENT);
      dispatch_async(demoQueue, ^{
        dispatch_group_t demoGroup = dispatch_group_create();
        for(int i = 0; i < 10; i++) {
          dispatch_group_enter(demoGroup);
          [self testMethod:i
                     block:^{
                       dispatch_group_leave(demoGroup);
                     }];
        }

        dispatch_group_notify(demoGroup, dispatch_get_main_queue(), ^{
          NSLog(@"All group tasks are done!");
        });
      });
    }

    - (void)testMethod:(NSInteger)index block:(void(^)(void))completeBlock {
      NSLog(@"Group task started...%ld", index);
      NSLog(@"Current thread is %@ thread", [NSThread isMainThread] ? @"main" : @"not main");
      [NSThread sleepForTimeInterval:1.f];

      if(completeBlock) {
        completeBlock();
      }
    } 
```

这在创建的并发队列中运行`demoQueue`。如果我不创建任何队列，它会在**主线程**中运行。

```
- (IBAction)buttonAction:(id)sender {
    dispatch_group_t demoGroup = dispatch_group_create();
    for(int i = 0; i < 10; i++) {
      dispatch_group_enter(demoGroup);
      [self testMethod:i
                 block:^{
                   dispatch_group_leave(demoGroup);
                 }];
    }

    dispatch_group_notify(demoGroup, dispatch_get_main_queue(), ^{
      NSLog(@"All group tasks are done!");
    });
    }

    - (void)testMethod:(NSInteger)index block:(void(^)(void))completeBlock {
      NSLog(@"Group task started...%ld", index);
      NSLog(@"Current thread is %@ thread", [NSThread isMainThread] ? @"main" : @"not main");
      [NSThread sleepForTimeInterval:1.f];

      if(completeBlock) {
        completeBlock();
      }
    } 
```

还有第三种方法可以让任务在另一个线程中执行：

```
- (IBAction)buttonAction:(id)sender {
      dispatch_queue_t demoQueue = dispatch_queue_create("com.demo.group", DISPATCH_QUEUE_CONCURRENT);
      //  dispatch_async(demoQueue, ^{
      __weak ViewController* weakSelf = self;
      dispatch_group_t demoGroup = dispatch_group_create();
      for(int i = 0; i < 10; i++) {
        dispatch_group_enter(demoGroup);
        dispatch_async(demoQueue, ^{
          [weakSelf testMethod:i
                         block:^{
                           dispatch_group_leave(demoGroup);
                         }];
        });
      }

      dispatch_group_notify(demoGroup, dispatch_get_main_queue(), ^{
        NSLog(@"All group tasks are done!");
      });
      //  });
    } 
```

当然，如前所述，您可以使用它`dispatch_group_async`来获得您想要的东西。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-08-11T22:01:15.513

第一个答案基本上是正确的，但是如果您想要最简单的方法来完成所需的结果，这里有一个独立的代码示例演示如何使用信号量来完成（这也是调度组在幕后工作的方式，JFYI） ：

```
#include <dispatch/dispatch.h>
#include <stdio.h>

main()
{
        dispatch_queue_t myQ = dispatch_queue_create("my.conQ", DISPATCH_QUEUE_CONCURRENT);
        dispatch_semaphore_t mySem = dispatch_semaphore_create(0);

        dispatch_async(myQ, ^{ printf("Hi I'm block one!\n"); sleep(2); dispatch_semaphore_signal(mySem);});
        dispatch_async(myQ, ^{ printf("Hi I'm block two!\n"); sleep(4); dispatch_semaphore_signal(mySem);});
        dispatch_async(myQ, ^{ dispatch_semaphore_wait(mySem, DISPATCH_TIME_FOREVER); printf("Hi, I'm the final block!\n"); });
        dispatch_main();
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-01-19T19:44:57.530

**斯威夫特 4.2 示例：**

```
let group = DispatchGroup.group(count: 2)
group.notify(queue: DispatchQueue.main) {
     self.renderingLine = false
     // all groups are done
}
DispatchQueue.main.async {
    self.renderTargetNode(floorPosition: targetPosition, animated: closedContour) {
        group.leave()
        // first done
    }
    self.renderCenterLine(position: targetPosition, animated: closedContour) {
        group.leave()
        // second done
    }
 } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-07-18T03:34:06.187

迅速接受的答案：

```
let group = DispatchGroup()

group.async(group: DispatchQueue.global(qos: .default), execute: {
    // block1
    print("Block1")
    Thread.sleep(forTimeInterval: 5.0)
    print("Block1 End")
})

group.async(group: DispatchQueue.global(qos: .default), execute: {
    // block2
    print("Block2")
    Thread.sleep(forTimeInterval: 8.0)
    print("Block2 End")
})

dispatch_group_notify(group, DispatchQueue.global(qos: .default), {
    // block3
    print("Block3")
})

// only for non-ARC projects, handled automatically in ARC-enabled projects.
dispatch_release(group) 
```

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2016-05-08T06:56:34.660

并不是说其他​​答案在某些情况下不是很好，但这是我经常从 Google 使用的一个片段：

```
- (void)runSigninThenInvokeSelector:(SEL)signInDoneSel {

    if (signInDoneSel) {
        [self performSelector:signInDoneSel];
    }

} 
```

# java - 当 StringBuilder 更快时，为什么 Java 使用 StringBuffer（同步）？

> ID：11909632
> 
> 赞同：1
> 
> 时间：2012-08-10T21:40:15.490
> 
> 标签：java, field, stringbuilder, stringbuffer

我正在查看 Java 反射类并注意到这段代码。让我想知道，为什么当 StringBuilder 更快时 Java 使用 StringBuffer ？

Java不想使用最快的实现，还是有其他原因？

代码在 Field.class 中：

```
static String getTypeName(Class<?> type) {
    if (type.isArray()) {
        try {
            Class<?> cl = type;
            int dimensions = 0;
            while (cl.isArray()) {
                dimensions++;
                cl = cl.getComponentType();
            }
            StringBuffer sb = new StringBuffer();
            sb.append(cl.getName());
            for (int i = 0; i < dimensions; i++) {
                sb.append("[]");
            }
            return sb.toString();
        } catch (Throwable e) { /*FALLTHRU*/ }
    }
    return type.getName();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T21:50:01.307

`StringBuffer`[自JDK 1.0](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/StringBuffer.html)以来一直存在。

`Field`出现在[1.4.2 之前](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/reflect/Field.html)。

终于`StringBuilder`在[Java 1.5](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuilder.html)中成功了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-10T21:51:24.127

主要原因是 JVM 具有先进的技术，可以查看是否可以避免必须执行上下文所暗示的各种事情。由于 StringBuffer 是一个从不逃避方法的局部变量，JVM 可以安全地避免在进入 StringBuffer 的同步方法之前尝试获取对象上的锁——因为没有其他线程能够调用这个特定的方法StringBuffer 的实例。

一个快速的微型基准测试证明了这一点。创建`buffer`一个字段将使以下代码减慢 50%。

```
private void doTest(String toCopy) {
    StringBuffer buffer = new StringBuffer();
    for (int i = 0; i < toCopy.length(); i++) {
        buffer.append(toCopy.charAt(i));
    }
    buffer.toString();
} 
```

上面的代码有一百万长度的字符串和 1000 次重复，在我的机器上运行 8 秒。但是，一旦`buffer`将其制成字段而不是局部变量，则大约需要 13 秒（因为 JVM 不再容易保证`buffer`只能由一个线程访问）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-10T21:44:25.323

如果我没记错的话，首先引入了 Stringbuffer，所以这可能是一段较旧的代码。真正的原因必须是线程安全，尽管当缓冲区是字符串生成器时，它不是安全的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-11T07:19:41.153

我遇到并询问了几个 JVM 开发人员，为什么仍然有这么多使用 StringBuffer，因为他们建议人们迁移到 StringBuilder 作为 8 年前的替代品。我的印象不是他们担心/考虑过的事情。其中一位产品经理没有给出官方理由。

我认为当 Java 编码约定 (1999) 建议您应该使用空格时，为什么 JDK 源代码使用制表符。使用代码格式化程序进行修复很简单，但它不在任何人的待办事项列表中。

* * *

恕我直言，StringBuffer 从一开始就不是多线程的好主意。在极少数情况下，您可能希望以多线程方式写入内存中的字符流，并且您不在乎它生成的文本有多混乱，您仍然可以使用更自然的替代方案，例如 StringWriter（不是t 在 Java 1.0 中可用）或同步 StringBuilder。

我相信它实际上包含了很多错误，例如 SimpleDateFormat 使用了它，并且在某种程度上仍然使用 StringBuffer，即使它不是线程安全的。它可能给一些开发人员一种错误的安全感，使用线程安全集合或看起来有点线程安全。即在多个线程中使用 StringBuffer 而不是 StringBuilder 更有可能通过简单的测试，即使可能存在错误。

例如考虑两个线程写入

```
sb.append("Hello ").append("World").append("\n"); 
```

问题是，虽然每个`append`都是同步的，但每个代码块都不是。所以你可以得到

```
Hello Hello World World\n\n 
```

或者

```
Hello World Hello \nWorld\n 
```

因此，如果您仅使用 append 一次，则 StringBuffer 仅在没有同步的情况下是线程安全的，这使得它变得毫无意义。

* * *

当涉及 StringBuffer 的问题发布在 SO 上时，我试图指出人们要切换。

# join - 从一个“连接”表到另一个“连接”表的 SqlAlchemy 关系

> ID：11909633
> 
> 赞同：3
> 
> 时间：2012-08-10T21:40:30.763
> 
> 标签：join, sqlalchemy

我正在测试设置 SQLAlchemy 以映射现有数据库。该数据库是很久以前由我们不再使用的以前的第 3 方应用程序自动建立的，因此未定义一些预期的东西，例如外键约束。该软件将管理所有这些关系。

它是一种节点式的生产跟踪数据库结构，具有父子关系。特定于节点类型的数据存在于它们自己的表中，并且有一个用于常见列（如 type、uid、parentUid、...）的主关系表

结构是这样的...

1.  基本上包含每个节点条目的层次结构表，具有主键“uid”、“type”枚举和用于引用父节点的“parentUid”。
2.  NodeA / NodeB / ...表有一个与层次表一一匹配的“uid”

我从 SQLAlchemy 文档中收集到的是我应该尝试做“加入”表。这是我到目前为止所拥有的：

```
# has a column called 'parentUid'
hierarchy = Table('hierarchy', METADATA, autoload=True)

hier_fk = lambda: Column('uid', 
                          Integer, 
                          ForeignKey('hierarchy.uid'), 
                          primary_key=True)

nodeTypeA = Table('nodetype_a', METADATA, nodehier_fk(), autoload=True)
nodeTypeB = Table('nodetype_b', METADATA, nodehier_fk(), autoload=True)

Base = declarative_base()

class NodeA(Base):
    __table__ = join(hierarchy, nodeTypeA)

    id = column_property(hierarchy.c.uid, nodeTypeA.c.uid)
    uid = nodeTypeA.c.uid

class NodeB(Base):
    __table__ = join(hierarchy, nodeTypeB)

    id = column_property(hierarchy.c.uid, nodeTypeB.c.uid)
    uid = nodeTypeB.c.uid

    # cannot figure this one out
    parent = relationship("NodeA", primaryjoin="NodeB.parentUid==NodeA.id") 
```

`relationship`显然是错误的并且崩溃了。我已经尝试了一堆定义`foreign_keys`属性的组合，并使用混合`hierarchy.c.uid`样式方法。但我只是无法掌握如何与另一张桌子建立关系。

没有这`relationship`条线，查询效果很好。我得到了加入层次表的每个节点的完整表示。我什至可以通过执行以下操作手动获取 NodeB 的 NodeA 父级：

```
node_a = session.query(NodeA).filter_by(uid=node_b.parentUid).first() 
```

“加入”方法是否适合我的目标？我怎样才能让这种关系发挥作用？

## 更新

到目前为止，我已经设法通过以下方式建立了一种单向关系：

```
children = relationship("NodeB", 
                        primaryjoin="NodeB.parentUid==NodeA.id", 
                        foreign_keys=[hierarchy.c.parentUid],
                        # backref="parent"
            ) 
```

但是如果我取消注释`backref`让它把它放在相反的位置上`NodeB`，我会得到这个：

> ArgumentError: NodeA.children 和反向引用 NodeB.parent 都是相同的方向。您的意思是在多对一上设置 remote_side 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T20:25:14.390

remote_side 用于自引用关系以区分哪一侧是“远程”。该标志在[http://docs.sqlalchemy.org/en/latest/orm/relationships.html#adjacency-list-relationships](http://docs.sqlalchemy.org/en/latest/orm/relationships.html#adjacency-list-relationships)中有描述。因为您将类直接映射到 join()，SQLAlchemy 将每个 join() 视为映射表，并且检测到“自引用”条件，因为两个连接都依赖于同一个基表。如果您要使用连接表继承的常用模式构建此映射（请参阅[http://docs.sqlalchemy.org/en/latest/orm/inheritance.html#joined-table-inheritance](http://docs.sqlalchemy.org/en/latest/orm/inheritance.html#joined-table-inheritance)），则 relationship() 将更多的上下文来确定如何在没有显式 remote_side 参数的情况下加入。

使用给定方法的完整示例：

```
from sqlalchemy import *
from sqlalchemy.orm import *
from sqlalchemy.ext.declarative import declarative_base

e = create_engine("sqlite://", echo=True)

e.execute("""
create table hierarchy (uid int primary key, parentUid int)
""")

e.execute("""
create table nodetype_a (uid int primary key)
""")

e.execute("""
create table nodetype_b (uid int primary key)
""")

Base = declarative_base()

# has a column called 'parentUid'
hierarchy = Table('hierarchy', Base.metadata, autoload=True, autoload_with=e)

nodehier_fk = lambda: Column('uid',
                          Integer,
                          ForeignKey('hierarchy.uid'),
                          primary_key=True)

nodeTypeA = Table('nodetype_a', Base.metadata, nodehier_fk(), autoload=True, autoload_with=e)
nodeTypeB = Table('nodetype_b', Base.metadata, nodehier_fk(), autoload=True, autoload_with=e)

Base = declarative_base()

class NodeA(Base):
    __table__ = join(hierarchy, nodeTypeA)

    id = column_property(hierarchy.c.uid, nodeTypeA.c.uid)
    uid = nodeTypeA.c.uid

class NodeB(Base):
    __table__ = join(hierarchy, nodeTypeB)

    id = column_property(hierarchy.c.uid, nodeTypeB.c.uid)
    uid = nodeTypeB.c.uid

    # cannot figure this one out
    parent = relationship("NodeA",
                    primaryjoin="NodeB.parentUid==NodeA.id",
                    foreign_keys=hierarchy.c.parentUid,
                    remote_side=hierarchy.c.uid,
                    backref="children")

s = Session(execute)
s.add_all([
        NodeA(children=[NodeB(), NodeB()])
])
s.commit() 
```

# ruby - GoDaddy 的 Ruby 网页抓取脚本

> ID：11909634
> 
> 赞同：0
> 
> 时间：2012-08-10T21:40:35.003
> 
> 标签：ruby, web-scraping, nokogiri, mechanize-ruby

我是 Ruby 新手，在我的第一个脚本任务中，我被要求编写一个网络抓取脚本来从 GoDaddy 抓取我们的 DNS 列表的元素。

在抓取链接时遇到问题，然后我需要关注链接。我需要从下面的“GoToSecondaryDNS”js 元素中获取链接。我正在使用机械化和 Nokogiri：

```
<td class="listCellBorder" align="left" style="width:170px;">
          <div style="padding-left:4px;">
            <div id="gvZones21divDynamicDNS"></div>
            <div id="gvZones21divMasterSlave" cicode="41022" onclick="GoToSecondaryDNS('iwanttoscrapethislink.com',0)" class="listFeatureButton secondaryDNSNoPremium" onmouseover="ShowSecondaryDNSAd(this, event);" onmouseout="HideAdInList(event);"></div>
            <div id="gvZones21divDNSSec" cicode="41023" class="listFeatureButton DNSSECButtonNoPremium" onmouseover="ShowDNSSecAd(this, event);" onmouseout="HideAdInList(event);" onclick="UpgradeLinkActionByID('gvZones21divDNSSec'); return false;" useClick="true" clickObj="aDNSSecUpgradeClicker"></div>
            <div id="gvZones21divVanityNS" onclick="GoToVanityNS('iwanttoscrapethislink.com',0)" class="listFeatureButton vanityNameserversNoPremium" onmouseover="ShowVanityNSAd(this, event);" onmouseout="HideAdInList(event);"></div>
            <div style="clear:both;"></div>
          </div>
        </td> 
```

如何抓取链接“iwanttoscrapethislink.com”，然后与 onclick 交互以跟随链接并使用 Ruby 抓取下一页上的内容？

到目前为止，我对代码有一个简单的开始：

```
require 'rubygems'
require 'mechanize'
require 'open-uri'

def get_godaddy_data(url)

      web_agent = Mechanize.new

      result = nil

      ### login to GoDaddy admin

      page = web_agent.get('https://dns.godaddy.com/Default.aspx?sa=')

      ## there is only one form and it is the first form on thepage
      form = page.forms.first
      form.username = 'blank'
      form.password = 'blank'

      ## form.submit
      web_agent.submit(form, form.buttons.first)

     site_name = page.css('div.gvZones21divMasterSlave onclick td')  
      ### export dns zone data

      page = web_agent.get('https://dns.godaddy.com/ZoneFile.aspx?zone=' + site_name + '&zoneType=0&refer=dcc')
      form = page.forms[3]
      web_agent.submit(form, form.buttons.first).save(uri.host + 'scrape.txt')

       ## end

    end 

    ### read export file
    ##return File.open(uri.host + 'scrape.txt', 'rb') { |file| file.read }
  end

  def scrape_dns(url)

  site_name = page.css('div.gvZones21divMasterSlave onclick td') 
  LIST_URL = "https://dns.godaddy.com/ZoneFile.aspx?zone=" + site_name + '&zoneType=0&refer=dcc"
  page = Nokogiri::HTML(open(LIST_URL))

#not sure how to scrape onclick urls and then how to click through to continue scraping on the second page for each individual DNS

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:44:43.267

您不能与“ `onclick`”交互，因为 Nokogiri 不是 JavaScript 引擎。

您可以提取内容，然后将其用作后续 Web 请求的 URL。假设`doc`包含解析的 HTML：

```
doc.at('div[onclick^="GoToSecondaryDNS"]')['onclick'] 
```

将为您提供`onclick`参数的值。`^=`意思是“找到以开头的单词”，这样我们就可以排除其他`<div>`带有参数的标签`onclick`并返回：

```
"GoToSecondaryDNS('iwanttoscrapethislink.com',0)" 
```

使用简单的正则表达式`[/'(.+)'/,1]`将为您提供主机名：

```
doc.at('div[onclick^="GoToSecondaryDNS"]')['onclick'][/'(.+)'/,1]
=> "iwanttoscrapethislink.com" 
```

其余的，比如如何访问 Mechanize 的内部 Nokogiri 文档，以及如何创建新的 URL，都留给你自己去解决。

# maven - Maven：使用内置 pom.xml 文件部署 jar/war

> ID：11909643
> 
> 赞同：1
> 
> 时间：2012-08-10T21:41:24.653
> 
> 标签：maven, pom.xml

我没有 Maven 项目。我所拥有的是一个`pom.xml`嵌入在文件中的 jar。当我通过 Artifactory GUI 部署它时，Artifactory 会找到 pom 并将其与 jar 一起部署。它甚至可以识别 groupId、artifactId 和 version。

当我尝试使用`mvn deploy:deploy-file`它失败。如果我提取 pom，并使用 运行`mvn deploy:deploy-file`，`-DpomFile=pom.xml`它可以工作。有没有办法通过 Maven 命令行使用嵌入式 pom 部署这个 jar？或者，我需要先提取 pom.xml 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T18:32:47.727

我还没有听说过从存档中指定 pom 文件的可能性。我认为这不太可能是一种选择，因为 Maven 本身只是一个轻量级的程序，它与插件一起运行；它需要一些配置才能运行；并且所有对要使用的插件的引用都在这些文件中。

考虑编写一个将提取文件、运行`mvn deploy:deploy-file -DpomFile=pom.xml`然后删除文件的 Ant 脚本。

我知道，该解决方案看起来不是很好，但它应该会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T07:55:08.353

这是一个 Artifactory 功能，而不是标准的 Maven 行为。

请记住，例如，如果您使用 dependency:unpack-dependencies 或程序集插件来创建某种 über jar，那么 /META-INF/ 路径下的 jar 中将会有多个 pom.xml 文件，所以它会是很难选择哪个 pom 是真正的 pom。

# orm - 使用fuelphp orm时如何按字段设置顺序有很多？

> ID：11909644
> 
> 赞同：1
> 
> 时间：2012-08-10T21:41:25.357
> 
> 标签：orm, has-many, fuelphp

我正在使用fuelphp 的orm 来建模我的数据。在进行级联查找时，如何控制返回子元素的顺序。

例如，这是将评论附加到帖子的示例配置：

```
protected static $_has_many = array(
    'comments' => array(
        'key_from' => 'id',
        'model_to' => 'Model_Comment',
        'key_to' => 'post_id',
        'cascade_save' => true,
        'cascade_delete' => false,
    )
); 
```

例如，如何按“日期输入”字段对评论进行排序？

在此先感谢，大卫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:51:58.570

您可以将 order_by 子句添加到条件中。

```
protected static $_has_many = array(
    'comments' => array(
        'key_from' => 'id',
        'model_to' => 'Model_Comment',
        'key_to' => 'post_id',
        'cascade_save' => true,
        'cascade_delete' => false,
        'conditions' => array(
            'order_by' => array(
                'field1' => 'DESC',
                'field2' => 'ASC',
            )
        ),
    ),
); 
```

请注意，由于它们是在关系中定义的，因此它们始终处于活动状态且无法关闭！

# javascript - 尝试将 var 发送到 AS3 ExternalInterface 时，Javascript 抛出错误

> ID：11909645
> 
> 赞同：0
> 
> 时间：2012-08-10T21:41:51.267
> 
> 标签：javascript, actionscript-3, flash, externalinterface

我知道已经有很多关于这个话题的问题，但没有一个能解决我的问题，也许我只是错过了一些东西。

无论如何，这是交易。我有一个快乐的 html5 小游戏，它可以播放一些音频和声音效果等，它在每个支持 html5 的浏览器中都运行良好。但是，那些不需要闪退的。没什么大不了的吧？显然不是……我制作了一个小的 swf，它应该接受来自 JS 的 mp3 url，然后获取 mp3 并播放它。我必须使用这种方式，因为有很多音频文件，我想尽量避免为每个文件制作一个 swf 文件。

这是 AS - 我正在使用 ExternalInterface 从 js 接收变量。

```
 import flash.external.*;

 ExternalInterface.addCallback("callFlash", playSound); 

 function playSound(file:String):void {
    var s:Sound = new Sound();
    s.load(new URLRequest(file));

    s.play();
 } 
```

然后我的 JS 传递变量：

```
 var flash = $('#fbplayer')[0];
 console.log(flash); //returns flash object so jquery is not the issue
 flash.callFlash(fallSource); 
```

所以理论上一切都应该正常工作（如果我正确理解 ExternalInterface）。但是，会引发以下错误：

```
 TypeError: flash.callFlash is not a function
 flash.callFlash(fallSource); 
```

我似乎找不到问题出在哪里。我愿意接受任何答案，甚至是完全不同的方式。只要它起作用，就可以阻止项目的交付：C

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-29T22:42:02.783

我知道这真的很老了，但我从来没有成功地用 jquery 正确找到我的 flash 对象。最好使用 getElementById。此外，就在几个月前，我在一些现代浏览器中遇到的另一件疯狂的事情是，在通过 ExternalInterface 初始化任何回调之后，我实际上需要告诉 flash 等待一帧。

# python - 需要编写程序来解码秘密消息的字母

> ID：11909649
> 
> 赞同：1
> 
> 时间：2012-08-10T21:42:17.033
> 
> 标签：python

所以，我需要输入一个加扰的字母表，然后使用那个字母表输入一个秘密信息。我的程序需要解读秘密信息。到目前为止我已经写了这个并且被卡住了。我希望有人能帮助我。到目前为止，我尝试将列表中的每个索引都更改为 AZ。我的问题是如何使用我为此编写的内容并使其也适用于我输入的秘密信息。

```
s = ()

alphabet = input("Please input the scrambled alphabet in order: ")
message = input("Now input the scrambled message: ")
alphabet.upper()
s = dict(alphabet)
num = 1

while num < 2:
    s[0] = chr(65)
    s[1] = chr(66)
    s[2] = chr(67)
    s[3] = chr(68)
    s[4] = chr(69)
    s[5] = chr(70)
    s[6] = chr(71)
    s[7] = chr(72)
    s[8] = chr(73)
    s[9] = chr(74)
    s[10] = chr(75)
    s[11] = chr(76)
    s[12] = chr(77)
    s[13] = chr(78)
    s[14] = chr(79)
    s[15] = chr(80)
    s[16] = chr(81)
    s[17] = chr(82)
    s[18] = chr(83)
    s[19] = chr(84)
    s[20] = chr(85)
    s[21] = chr(86)
    s[22] = chr(87)
    s[23] = chr(88)
    s[24] = chr(89)
    s[25] = chr(90)
    num +=1
print (s)

for alpha in message.upper():
    if alpha < "A" or alpha > "Z":
        print(alpha,end="")
    else:
        print(s [ord(alpha) -65 ], end="") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T22:01:32.920

`s`首先，完全没有必要创建大字典。它实际上什么都不做：行：

```
s [ord(alpha) -65 ] 
```

将一个字母变成一个数字，减去 65，然后将其放入字典中，将其加 65 再将其变回一个数字。

其次，该行`alphabet.upper()`实际上并没有改变字母表，它只是返回一个大写版本。你需要做

```
alphabet = alphabet.upper() 
```

现在是肉的部分。您要做的是创建一个字典，将代码字母表中的字母映射到真实字母表中的字母。该行`dict(alphabet)`不这样做。相反，遍历字符串中的字符并将每个字符分配给相应的字母。您在使用 时走在正确的轨道上`chr`，但要做的工作太多了。这个怎么样：

```
s = {}
for i in range(26):  # iterate from 0 to 25
    s[alphabet[i]] = chr(65 + i) 
```

因为`chr(65 + i)`是正常有序字母表中的字母，并且`alphabet[i]`是加扰的字母。

一旦你有了那本字典，逐个字母地浏览并更改它应该很容易（它留给你）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T22:10:43.830

您可以使用字符串[`translate()`](http://docs.python.org/library/string.html#string.translate)方法：

```
import string

intab   = 'abcdefghijklmnopqrstuvwxyz' # or string.ascii_lowercase
outtab  = 'xyzabcdefghijklmnopqrstuvw'
tab = string.maketrans(intab, outtab)
s = raw_input('Type some text: ').lower()
print s.translate(tab) 
```

`maketrans()`创建一个包含两个字母的表，并将`translate()`字符串的每个字符替换为表中的对。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T21:53:14.913

我不知道 Python - 这是伪代码

> 1.  创建加扰字母数组
> 2.  创建“正常”字母数组
> 3.  foreach char in message，在乱码数组中找到char，然后输出对应的“正常”char

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T22:08:17.920

你可以制作一本字典：

```
alphabet({'a':'alpha', 'b':'bravo','c':'charlie', etc.}) 
```

所以 abc 会翻译成 alphabravocharlie

其中 'a','b',.. 是编码字母，'alpha','bravo',... 是它们的实际值。通过反转这个来制作“密码”。

请参阅字典在线教程部分：http: [//docs.python.org/dev/library/collections.html](http://docs.python.org/dev/library/collections.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-10T22:22:48.900

我相信你在问'如果我输入一个字符串（我假设一个没有分隔符的字符串），我怎样才能让它成为一个字典，其中第一个字母 = A，第二个 = B，等等。（对不起，如果这是不正确的解释）。如果是这种情况，您可以执行以下操作（注意`raw_input`-的用法`input`是评估参数的内置函数 - 它不会分配）：

```
alphabet = raw_input("Please input the scrambled alphabet in order: ")
message = raw_input("Now input the scrambled message: ")

secret_map = {}

# Step through the provided string, incrementing the character number by index.
# Index will start at 65 + 0 = A (change to 98 if you want lowercase)
for index, letter in enumerate(alphabet):
    secret_map[letter] = chr(65 + index)

# Now join the string together, mapping each letter to its corresponding value
new_str = ''.join([secret_map[char] for char in message])

# Print the resulting string
print new_str 
```

由于这是家庭作业（也许你还没有列出理解），这相当于创建`new_str`：

```
new_str = ''
for letter in message:
    new_str += secret_map[letter] 
```

如果这不是您要找的，请告诉我。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-11T19:58:15.063

我无法抗拒扩展 stummjr 的答案，以创建一个更 Python 的编码和解码版本（我添加了一些额外的变量来尝试让每个步骤更清晰）：

```
import random, string

cypher_list = list(string.ascii_lowercase)
random.shuffle(cypher_list)
cypher_text = ''.join(cypher_list)

encode_tab = string.maketrans(string.ascii_lowercase, cypher_text)
decode_tab = string.maketrans(cypher_text, string.ascii_lowercase)

orig_text = 'this means war'
crypt_text = orig_text.translate(encode_tab)
clear_text = crypt_text.translate(decode_tab)

print cypher_text
print crypt_text
print clear_text
assert(clear_text == orig_text) 
```

# iphone - 在后台加载 MKMapview 以避免延迟问题

> ID：11909650
> 
> 赞同：7
> 
> 时间：2012-08-10T21:42:19.433
> 
> 标签：iphone, objective-c, ios, ios5, mkmapview

我正在构建一个具有多个不同视图的 iPhone 应用程序（在 iOS 5 中），其中一个包含地图（也有单独的视图控制器）。我第一次查看此视图​​时，它需要一段时间才能加载，并且动画针落等内容也因此无法正常工作。更不用说位置稳定需要一点时间。

我想知道的是，是否有办法在用户进入该视图之前加载 MKMapView，所以当他们到达那里时，这些问题不再存在。

我已经看过[这个](https://stackoverflow.com/questions/3969589/loading-mkmapview-asynchronously)和[这个](https://stackoverflow.com/questions/10585073/load-mkmapview-in-background-and-create-uiimage-from-it-iphone-ipad)问题，但它们并没有太大帮助。请记住，在我到达那里之前，我真的不需要与那个视图进行交互，我只是希望它在我去那里时完全加载。

# html - ie8 边距顶部错误

> ID：11909657
> 
> 赞同：0
> 
> 时间：2012-08-10T21:42:29.153
> 
> 标签：html, css, internet-explorer-8, margins

我不知道为什么 IE8 会这样做，但我有两个包含导航的 div。一个向左浮动，另一个向右浮动。两个 div 上的 margin-top 都是 10px。在除 IE8 之外的所有其他浏览器中，一切看起来都很棒。上边距消失。

我尝试将文档类型从 HTML5 更改为过渡性、严格且不走运。

我已经运行了更改文档类型和使用`http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"`元标记的组合，`http-equiv="X-UA-Compatible" content="IE=9,chrome=1"`并且`http-equiv="X-UA-Compatible" content="IE=8,chrome=1"`它仍然没有变化。

我添加了一个 &nsbp; 和CSS`height:0;`中的`clear:both;`div 如下所示： [IE8 - Container with margin-top: 10px has no margin](https://stackoverflow.com/questions/1245914/ie8-container-with-margin-top-10px-has-no-margin)

这似乎也不起作用。所以，我很难过。不太确定还有什么可以尝试的。

我忘了提到的一件事是 cufon 应用于文本，所以我不确定这是否会导致任何问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:08:49.230

您可以尝试重置样式表： [CSS Reset](http://yuilibrary.com/yui/docs/cssreset/)

# asp.net - 需要使用 vb.net 语法构建 restful wcf web 服务的示例

> ID：11909658
> 
> 赞同：1
> 
> 时间：2012-08-10T21:42:33.360
> 
> 标签：asp.net, wcf, rest

我需要的是一个使用 vb.net 语法创建 restful wcf 的好例子，但我能找到的只是 C# 示例，我花时间尝试转换为 vb.net。如果有人知道 vb.net 中好的示例代码，请告诉我，或给我发送链接。

我想看看如何创建和使用集合数据。任何事情都会有很大帮助，我正在努力。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T21:56:07.877

试着看看这个？

[http://msdn.microsoft.com/en-us/library/bb412178(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/bb412178(v=vs.90).aspx)

或这个：

[http://www.vb-tips.com/Making_a_REST_service_with_VB_and_WCF.aspx](http://www.vb-tips.com/Making_a_REST_service_with_VB_and_WCF.aspx)

我知道 VB.NET 中的资源有些有限，但是看看 c# 的资源并了解如何实现它，然后在 VB.NET 中实现相同的东西，我保证这并不难，我已经我自己曾经从 VB.NET 转到 C#。

# search - 批处理文件注册表搜索

> ID：11909661
> 
> 赞同：0
> 
> 时间：2012-08-10T21:42:46.033
> 
> 标签：search, registry

我正在尝试使用以下批处理文件在注册表中搜索键值，但返回的错误级别不一致：

```
@Echo off
setlocal
set PATHFIX=%CD%
set LOGFILE=%SYSTEMDRIVE%\windows\IA\%COMPUTERNAME%-ISPA_Windows_7_STIG_V1R9_27_Jul_2012-%DATE%.txt
echo Log file name will be %LOGFILE%
echo Security Template logfile for %COMPUTERNAME% > %LOGFILE%
echo -- >> %LOGFILE%
for /f "delims=*" %%i in ('time /t') do set TIME=%%i
echo Date run: %DATE% >> %LOGFILE%
echo Time run: %TIME% >> %LOGFILE%
echo -- >> %LOGFILE%
echo Windows_7_STIG_V1R9 27 Jul 2012 >> %LOGFILE%
echo =============================================================================================== >> %LOGFILE%
FOR /F "tokens=1,2,3,4,5,6,7,8,9 delims=    " %%F IN (WINDOWS_7_V1R9.txt) DO (
    reg query "%%F" /v "%%H" /t "%%I" | Find "%%J"

    IF not ERRORLEVEL 1 (
        echo %%G    Compliant   
        echo %%G    %%K Compliant   %%M>> %LOGFILE%
        echo -- >> %LOGFILE%
    ) ELSE (
        echo %%G    Non-Compliant   
        echo %%G    %%K Non-Compliant   %%F\%%H %%I %%J >> %LOGFILE%
        echo -- >> %LOGFILE%
    )
)
echo -- >> %LOGFILE%
:PATCHES_COMPLETE
for /f "delims=*" %%i in ('time /t') do set TIME=%%i
echo -- >> %LOGFILE%
echo ISPA-STIG for %COMPUTERNAME% completed at: %TIME% >> %LOGFILE%

pause

exit 
```

文本文件设置如下：

HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System V-1075 ShutdownWithoutLogon REG_DWORD 0x1 ECSC-1 SV-25111r1_rule 显示关机按钮

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T05:41:23.153

1) 无法批量搜索注册表

2）您永远不应该使用注册表进行自动搜索，因为这可能会破坏其他内容，并且还可能删除未指定的键

3) 自动导航注册表的唯一方法是使用 .reg 文件

抱歉，如果这看起来很卑鄙，我只是喜欢使用数字。

希望这对你有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-20T16:43:55.753

您无法使用批处理搜索注册表，因此无法回答您的问题。抱歉 :) windows 只是不允许它 f

# php - 使用 Ajax 从 PHP 数组交换图像并获取 ID

> ID：11909672
> 
> 赞同：0
> 
> 时间：2012-08-10T21:44:16.067
> 
> 标签：php, jquery, ajax, arrays, swap

在我的网站上，用户可以填写 url。当他填写 url 时，他会从该 url 中获取所有图像 src。我将这些 src 推送到 php 中的数组中：

```
 array_push($goodfiles,$pic); 
```

现在用户将能够选择图片（使用下一个或上一个按钮），然后将其保存到数据库中。保存的图片基于数组中图像的 id。所以 $goodfiles['0'] 意味着 id = "0" 等等。

我希望图像的交换可以与 ajax 一起使用，以便在单击下一个或上一个按钮时页面不必一直刷新。然后当我保存表单时，我想知道当前图像的id，以便将其保存到数据库中。

我如何使用 Ajax (jquery) 实现这一点？

编辑：

这就是我现在的做法：

```
 $current_id = $_GET['id'];
if(empty($_GET['id']) || !empty($empty)) { $current_id = 0; }
$prev_id = $_GET['id'] - 1;
if($prev_id < 0){ $prev_id = 0;}
$next_id = $_GET['id'] + 1;
if($next_id > $_SESSION['count']-1 && $_SESSION['count'] != 'empty') { $next_id = $_SESSION['count']-1;} 
```

这是分页的代码

这是分页：

```
 <div id="url_pic">

        <img src="<?=$_SESSION['pictures'][$current_id]?>" class="img_load"><br>
        <? if($_SESSION['count'] > 1) { ?><center><a href="additem_url.php?id=<?=$prev_id?>"><img src="img/add/left.png"></a> <a href="additem_url.php?id=<?=$next_id?>"><img src="img/add/right.png"></a></center> <? } ?>

    </div> 
```

所以现在我的解决方案不包含任何 javascript，但它都是 php 编码的。每次您想查看下一张图片时，页面都会刷新。我想在 ajax 中解决这个问题，这样您就可以在不刷新的情况下对图像进行分页。我想要的方式就像这个链接：

```
 http://d-scribe.de/webtools/jquery-pagination/demo/demo_options.htm 
```

但除了文字，我想通过图像进行分页。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:20:19.063

您可能不需要为此使用 AJAX。只需返回一个包含 JavaScript 数组的 html 文件，其中包含所有这些图像 URL，并使用 JavaScript 执行其他操作。

如果您有更精确的问题并希望有一些代码，请返回 StackOverflow，我们可以提供帮助；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T22:32:09.650

在您的 php 页面底部加载一个脚本

```
<script type="text/javascript">
   var myArray = <?php echo json_encode($myPHParray); ?>
</script> 
```

这样，当您的页面加载时，它会使用动态 javascript json 对象作为您可以与客户端一起使用的变量来呈现，这消除了对 AJAX 请求的需求，除非您对正在使用的数据进行处理。乍一看，我猜不是真的每说。但是，是的，至少它在页面加载时少了一笔交易。

编辑刚刚注意到有人在我打字时说了类似的话..拉斯..所以我想这是他回答的后续:-D

# opencv - opencv滑动窗口

> ID：11909678
> 
> 赞同：1
> 
> 时间：2012-08-10T21:44:31.993
> 
> 标签：opencv, histogram, svm, libsvm

是否有任何内置库用于在 opencv 2.x 版中的图像上滑动窗口（自定义大小）？我试图自己编写算法，但我发现它非常痛苦并且可能容易出错。我需要在图像上滑动并为 svm 的输入创建直方图。HOG Descriptor 有一个，它计算 HOG 特征，但我有自己的特征集，所以我只需要一个算法让我在图像上滑动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:37:09.690

您可以在对象上定义感兴趣区域 (ROI) ，从而为您提供一个引用子窗口`cv::Mat`的新对象。`Mat`这不会复制基础数据，只是复制带有适当元数据的新标头。

*   [cv::Mat::operator()](http://opencv.willowgarage.com/documentation/cpp/core_basic_structures.html#index-7903)

另请参阅另一个问题：

*   [OpenCV C++，使用 cv::Mat 获取感兴趣区域 (ROI)](https://stackoverflow.com/questions/6566295/opencv-c-getting-region-of-interest-roi-using-cvmat)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-08T13:02:50.770

基本代码可以看起来像。代码描述得很好。我希望。

这是第 30 步的单比例滑动窗口 60x60。

[![在此处输入图像描述](../Images/e30f1c28fd6050c1c7a42b119bd7b2b5.png)](https://i.stack.imgur.com/rvOpU.jpg)

这个简单示例的结果是 ROI。

[![在此处输入图像描述](../Images/ad3f6a9d670bcf14424dc905f48bbfc9.png)](https://i.stack.imgur.com/Z6ohH.jpg)

您可以访问此基本教程[Tutorial Here](http://funvision.blogspot.com/2015/12/opencv-tutorial-sliding-window.html)。

```
 // Parameters of your slideing window

      int windows_n_rows = 60;
      int windows_n_cols = 60;

      // Step of each window
       int StepSlide = 30;

 for (int row = 0; row <= LoadedImage.rows - windows_n_rows; row += StepSlide)
        {

  for (int col = 0; col <= LoadedImage.cols - windows_n_cols; col += StepSlide)
          {

           Rect windows(col, row, windows_n_rows, windows_n_cols);
           Mat Roi = LoadedImage(windows);
          }
         } 
```

# python - Python中有这样的模式匹配函数吗？

> ID：11909681
> 
> 赞同：6
> 
> 时间：2012-08-10T21:44:42.500
> 
> 标签：python, lisp, scheme, pattern-matching, racket

我刚刚发现[Racket中的](http://racket-lang.org)[模式匹配](http://docs.racket-lang.org/reference/match.html)功能非常强大。

```
> (match '(1 2 3) [(list a b c) (list c b a)])

'(3 2 1)

> (match '(1 2 3) [(list 1 a ...) a])

'(2 3)

> (match '(1 2 3)
    [(list 1 a ..3) a]
    [_ 'else])

'else

> (match '(1 2 3 4)
    [(list 1 a ..3) a]
    [_ 'else])

'(2 3 4)

> (match '(1 2 3 4 5)
    [(list 1 a ..3 5) a]
    [_ 'else])

'(2 3 4)

> (match '(1 (2) (2) (2) 5)
    [(list 1 (list a) ..3 5) a]
    [_ 'else])

'(2 2 2) 
```

在 Python 中是否有类似的语法糖或库可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T21:48:23.817

不，没有，python 的模式匹配只是像这样的可迭代解包：

```
>>> (x, y) = (1, 2)
>>> print x, y
1 2 
```

或者在函数定义中：

```
>>> def x((x, y)):
    ... 
```

或者在 python 3 中：

```
>>> x, *y = (1, 2, 3)
>>> print(x)
1
>>> print(y)
[2, 3] 
```

但是有一些[外部库](http://pypi.python.org/pypi?%3aaction=search&term=pattern%20matching&submit=search)实现了模式匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-01-18T00:11:05.087

Python 没有内置的模式匹配功能，但有一些 Python 库使用统一实现模式匹配。

根据您的第一个示例，可以使用[统一](https://github.com/mrocklin/unification)库匹配模式：

```
from unification import *

a,b,c = var('a'),var('b'),var('c')
matched_pattern = unify([1,2,3],[var('a'),var('b'),var('c')])
if(matched_pattern):
    second_pattern = [matched_pattern[c],matched_pattern[b],matched_pattern[a]]
    print(second_pattern)
else:
    print("The pattern could not be matched.") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-18T03:10:40.627

如果您愿意使用基于 Python 的语言（即使它们不是严格意义上的 Python），那么您可能会喜欢 Coconut。

Coconut 为 Python 增加了几个用于函数式编程的特性，包括模式匹配。

```
case [1,2,3]:
    match (a,b,c):
        print((c,b,a))
# (3,2,1)

case [1,2,3]:
    match (1,) + a:
        print(a)
# (2, 3)

case [1,2,3]:
    match (1,) + a if len(a) == 3:
        print(a)
else:
    print("else")
# else

case [1,2,3,4]:
    match (1,) + a if len(a) == 3:
        print(a)
else:
    print("else")
# (2,3,4)

case [1,2,3,4,5]:
    match (1,) + a + (5,) if len(a) == 3:
        print(a)
else:
    print("else")
# (2,3,4) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-20T04:06:41.943

2020 年即将到来，我想说[https://github.com/thautwarm/moshmosh](https://github.com/thautwarm/moshmosh)

你可以这样使用它：

*   在`main.py`

    ```
    import moshmosh
    import mypackage 
    ```

*   在某些模块中`mypackage`

    ```
    # +pattern-matching
    with match([1, [2, (3, 4)]]): 
     if [a, [2, (_, 4)]]: 
         print(a) # print 1 
    ```

也支持 IPython。

来自 moshmosh 的模式匹配是可扩展的（`__match__`用于制作新模式）和快速（不应该比手写慢）。

# css - 使 BODY DIV 填充可用区域

> ID：11909683
> 
> 赞同：0
> 
> 时间：2012-08-10T21:44:45.220
> 
> 标签：css, html, asp.net-mvc-4

我正在开发一个全新的网站，我正试图让基本布局继续下去。我正在使用 ASP.NET MVC 4 生成的 HTML，我希望在为 腾出空间并因此将其锚定到浏览器窗口底部之后，让`DIV`命名`body`填充可用空间。然而，我现在得到的是三个面板只是堆叠在一起。`header``footer`

*如果浏览器支持 HTML5，我想要一个可行的解决方案，如果不支持，我想要一个解决方案*

***请注意，我已在 CSS 中内联注释以尝试解释我尝试过的内容。***

# HTML

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>@ViewBag.Title - Title</title>
        <link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />
        <meta name="viewport" content="width=device-width" />
        @Styles.Render("~/Content/css")
    </head>
    <body>
        <header>
            <div class="content-wrapper">
                <div class="float-left">
                    <p class="site-title">@Html.ActionLink("Title", "Index", "Home")</p>
                </div>
            </div>
        </header>
        <div id="body">
            @RenderSection("featured", required: false)
            <section class="content-wrapper main-content clear-fix">
                @RenderBody()
            </section>
        </div>
        <footer>
            <div class="content-wrapper">
                <div class="float-left">
                    <p>&copy; @DateTime.Now.Year - ACME. All rights reserved.</p>
                </div>
                <div class="float-right">
                    <ul id="social">
                        <li><a href="http://facebook.com" class="facebook">Facebook</a></li>
                        <li><a href="http://twitter.com" class="twitter">Twitter</a></li>
                    </ul>
                </div>
            </div>
        </footer>

        @RenderSection("scripts", required: false)
    </body>
</html> 
```

# CSS

```
body {
    /* I'VE TRIED BOTH OF THE FOLLOWING TO SEE IF THE BODY ITSELF WOULD SPAN */
    /* WITH NO OTHER CSS APPLIED TO THE body ELEMENT */

    /*height: fill-available;*/
    /*height: 100%*/
}

/* general layout
----------------------------------------------------------*/
.float-left {
    float: left;
}

.float-right {
    float: right;
}

.clear-fix:after {
    content: ".";
    clear: both;
    display: block;
    height: 0;
    visibility: hidden;
}

/* main layout
----------------------------------------------------------*/
.content-wrapper {
    margin: 0 auto;
    max-width: 960px;
}

#body {
    background-color: #efeeef;
    clear: both;
    padding-bottom: 35px;

    /* I'VE TRIED BOTH OF THE FOLLOWING TO SEE IF I COULD GET THIS ELEMENT TO SPAN */
    /* WITHOUT ANY OTHER CSS APPLIED TO THE body TAG */

    /*height: fill-available;*/
    /*height: 100%*/
}

.main-content {
    /*background: url("../Images/accent.png") no-repeat;*/
    padding-left: 10px;
    padding-top: 30px;
}

.featured + .main-content {
    /*background: url("../Images/heroAccent.png") no-repeat;*/
}

footer {
    clear: both;
    background-color: #e2e2e2;
    font-size: .8em;
    height: 100px;
}

/* site title
----------------------------------------------------------*/
.site-title {
    color: #c8c8c8;
    font-family: Rockwell, Consolas, "Courier New", Courier, monospace;
    font-size: 2.3em;
    margin: 20px 0;
}

    .site-title a, .site-title a:hover, .site-title a:active {
        background: none;
        color: #c8c8c8;
        outline: none;
        text-decoration: none;
    }

/* social
----------------------------------------------------------*/
ul#social li {
    display: inline;
    list-style: none;
}

    ul#social li a {
        color: #999;
        text-decoration: none;
    }

a.facebook, a.twitter {
    display: block;
    float: left;
    height: 24px;
    padding-left: 17px;
    text-indent: -9999px;
    width: 16px;
}

a.facebook {
    background: url("../Images/facebook.png") no-repeat;
}

a.twitter {
    background: url("../Images/twitter.png") no-repeat;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T22:31:05.543

`fixed`只需使用定位在页面底部捕捉页眉和页脚。

```
header, footer{ position:fixed; left:0; right:0; z-index:1; }
header{ top:0; }
footer{ bottom:0; } 
```

然后你可以给你以前`body`的背景。`div#body`div 没有背景，将根据需要扩展。

```
div#body{ background:none; }
body{ background:#eee; } 
```

这看起来`div`会填满页面的剩余空间。最后给你的`header`和`footer`a `background`，这样你就看不到它下面的body背景了。

```
header, footer{ background:#fff; } 
```

顺便说一句，我建议删除身体边缘。`body{ margin:0; }`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T00:07:52.957

我相信仅使用 CSS 有点不可能做到这一点。您可以像这样制作一个 100% 高度的网页：

```
html{
    height: 100%;
}

body{
    height: 100%;
}

#body{
    height: 100%;
} 
```

然后对于页眉、正文和页脚，您可以这样做：

```
header{
  height: 100px;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
  background-color: #f00;
}

#body{
  bottom: 100px;
  left: 0;
  position: absolute;
  right: 0;
  top: 100px;
  background-color: #fff;
}

footer{
  bottom: 0;
  height: 100px;
  left: 0;
  position: absolute;
  width: 100%;
  background-color: #ff0;
} 
```

它可能会工作一段时间，但它会在某个时候中断。当您调整浏览器大小时，您的`#body`. 如果你想要一个更好的解决方案，你应该使用 javascript。在您的 javascript 中，计算您的 有多少空间，然后调整和`#body`的高度。或者调整一下。`header``footer``#body`

# android - Android - 旋转的圆圈出现在操作栏中

> ID：11909688
> 
> 赞同：0
> 
> 时间：2012-08-10T21:45:48.863
> 
> 标签：android, action, android-actionbar, geometry

所以我有一个我正在尝试学习的操作栏，当我实施它时，我看到我的第一个菜单项左侧的这个白色旋转圆圈。为什么会在这里显示？

来源：

```
package com.example.lookingfor;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.view.Window;

public class MainActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS);
    setContentView(R.layout.main);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.menu, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    super.onOptionsItemSelected(item);
    switch (item.getItemId()) {
    case R.id.atcAbout:

        break;
    case R.id.atcContact:

        break;
    case R.id.atcRate:

        break;

    }
    return true;
}

} 
```

菜单

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >

<item
    android:id="@+id/atcAbout"
    android:showAsAction="ifRoom"
    android:title="About"/>
<item
    android:id="@+id/atcRate"
    android:showAsAction="ifRoom"
    android:title="Rate this app"/>
<item
    android:id="@+id/atcContact"
    android:showAsAction="ifRoom"
    android:title="Contact Us"/>

</menu> 
```

主要布局

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/scroller"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:fillViewport="true" >

<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

</LinearLayout>

</ScrollView> 
```

显现：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.lookingfor"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="10"
    android:targetSdkVersion="15" />

    <uses-permission android:name="android.permission.INTERNET" >
</uses-permission>

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main"
 >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application>

</manifest> 
```

这是截图（我还不能在这里发布图片）

[http://imgur.com/RaTTP](http://imgur.com/RaTTP)

在发布应用程序之前，如何摆脱这个旋转的圈子？这对应用程序本身来说是一种丑陋且令人讨厌的干扰。

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:50:55.253

`requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS);`尝试在`onCreate()`回调中注释掉该行。

# bash - 在 shell 脚本中重命名文件

> ID：11909690
> 
> 赞同：0
> 
> 时间：2012-08-10T21:46:02.533
> 
> 标签：bash, shell

我需要在目录中找到格式为“ *abc.111* ”的文件，并在我的 shell 脚本中将它们重命名为“ *abc.222 ”。*模式替换以某种方式失败。我在这里想念什么？

```
#!/bin/sh

find . -name \*abc\* | while read FILES
do
        newfile =  ${FILES/111/222} #Replace 111 by 222
        mv $FILES $newfile
done 
```

错误：/temp.sh：替换错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:50:30.263

您的`/bin/sh`不支持`${var//}`替换。尝试另一个 shell，例如`/bin/bash`.

一旦你解决了这个问题，你会发现空格不起作用。

```
newfile =  ${FILES/111/222} 
```

您必须在`=`.

# sql - 索引列上的慢速 SQL 查询，多列数

> ID：11909695
> 
> 赞同：1
> 
> 时间：2012-08-10T21:46:18.223
> 
> 标签：sql, performance, sqlite, indexing, query-optimization

我有一个由 6 个数字组成的表作为主键

```
CREATE TABLE table1 ( num1 decimal, num2 int, num3 int, num4 bigint, num5 bigint, num6 bigint,
PRIMARY KEY (num1, num2, num3, num4, num5, num6)) 
```

我需要按排序顺序访问该表，并且经常需要查询该表以按顺序查找下一个 N 大数及其相关数据。

所以我写的查询是这样的

```
SELECT * FROM table1 WHERE  
 num1 >? OR (  
 (num1 == ? AND num2 > ?) OR (  
 (num1 == ? AND num2 == ? AND num3 > ?) OR (  
 (num1 == ? AND num2 == ? AND num3 == ? AND num4 > ? OR (  
 (num1 == ? AND num2 == ? AND num3 == ? AND num4 == ? AND num5 > ?) OR (  
 (num1 == ? AND num2 == ? AND num3 == ?  
 AND num4 == ? AND num5 == ? AND num6 > ?)))))) ORDER BY num1, num2, num3, num4, num5, num6  
 LIMIT ?; 
```

这是我能看到的找到下一个最大键的最好方法，而且它确实按照索引的顺序进行查询……但是查询需要几秒钟，这是我不喜欢的。

有什么方法可以提高性能吗？这需要几秒钟才能在 1000 万行的表上执行，我需要它在 100 毫秒左右执行更多。

查询计划：

```
"SEARCH TABLE table1 USING INDEX sqlite_autoindex_table1_1 (num1>?) (~250000 rows)"
"SEARCH TABLE table1 USING INDEX sqlite_autoindex_table1_1 (num1=? AND num2>?) (~2 rows)"
"SEARCH TABLE table1 USING INDEX sqlite_autoindex_table1_1 (num1=? AND num2=? AND num3>?) (~2 rows)"
"SEARCH TABLE table1 USING INDEX sqlite_autoindex_table1_1 (num1=? AND num2=? AND num3=? AND num4>?) (~2 rows)"
"SEARCH TABLE table1 USING INDEX sqlite_autoindex_table1_1 (num1=? AND num2=? AND num3=? AND num4=? AND num5>?) (~1 rows)"
"SEARCH TABLE table1 USING INDEX sqlite_autoindex_table1_1 (num1=? AND num2=? AND num3=? AND num4=? AND num5=? AND num6>?) (~1 rows)"
"USE TEMP B-TREE FOR ORDER BY" 
```

编辑：

为什么这是不可能的？我真的想在 INDEXED ORDER 中获取东西，与`ORDER BY`关键字生成的顺序相同吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T23:10:51.213

如果这是对您的问题的有效解决方案：您应该真正考虑使用单个代理键而不是六部分自然键。

从您自己的示例中可以看出，仅基于主键进行查找过于复杂。需要执行多个索引查找，而不是只考虑一列。每个索引查找都涉及磁盘延迟，在您的情况下，它很容易支配整个处理时间。

只需查看您发布的查询计划，在第一次查找后返回的行数已经减少到两个，并且与每个步骤之后可以遗漏的行数（0-1 行）相比，查询剩余索引的成本很高。

因此，如果您只需要查询一个整数类型的列作为主键，您应该会遇到一些显着的性能提升，正如您从[SQLite 文档](http://www.sqlite.org/lang_createtable.html#rowid)中看到的那样：

> SQLite 中每个表的数据都存储为 B-Tree 结构，其中包含每个表行的条目，使用 rowid 值作为键。这意味着按 rowid 检索或排序记录很快。搜索具有特定 rowid 的记录或具有指定范围内的 rowid 的所有记录的速度大约是通过指定任何其他 PRIMARY KEY 或索引值进行的类似搜索的两倍。
> 
> 除了一个例外，如果表的主键由单个列组成，并且该列的声明类型为“INTEGER”（大小写任意混合），则该列将成为 rowid 的别名。这样的列通常称为“整数主键”。

此外，您的 SQL 查询将更简单，更易于维护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T14:36:04.443

我认为查询优化器应该处理这种情况，但是在 aqlite 中它非常简单，所以像@cyroxx 所写的那样更改表结构确实会更好。

其他想法：您也可以尝试以其他方式重写查询，并且可能优化器会理解需要什么。例如，您可以尝试：

```
SELECT * FROM table1 WHERE
    num1 > 1   OR
  ( num1 = 1   AND ( num2 > 2 OR
                   ( num2 = 2 AND ( num3 > 3 OR
                                  ( num3 = 3 AND ( num4 > 4 OR
                                                 ( num4 = 4 AND ( num5 > 5 OR
                                                                ( num5 = 5 AND num6 > 6)
                                                                )
                                                 )
                                                 )
                                  )
                                  )
                   )
                   )
  ) 
```

可能会变得更好（或更糟:)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T18:12:10.577

与其他更复杂的 RDBMS 不同，sqlite 有一个基于规则的查询优化器，这意味着执行计划主要取决于查询的编写方式（以及子句的顺序）。它使优化器非常可预测，如果您知道 sqlite 如何生成执行计划，您可以利用这种可预测性来解决您的问题。

第一个想法是注意各种子句，如 (num1>?) 或 (num1=? and num2>?) 正在产生不相交的结果，并且这些结果自然地在彼此之间排序。如果查询被分成子查询（每个子查询处理部分条件）产生排序的结果，那么如果子查询以正确的顺序执行，那么所有结果集的连接也会被排序。

例如，考虑以下查询：

```
select * from table1 where num1=? and num2>? order by num1,num2
select * from table1 where num1>? order by num1,num2 
```

这些查询产生的两个结果集是不相交的，第一个结果集的行总是排在第二个结果集的行之前。

第二个想法是了解 sqlite 如何处理 LIMIT 子句。实际上，它在查询开始时声明了一个计数器，并在每个选定的行上递减和测试这个计数器，因此它可以提前停止查询。

例如，考虑以下查询：

```
.explain
explain select * from (
   select * from table1 where num1=? and num2>?
   union all
   select * from table1 where num1>?
) limit 10; 
```

sqlite 将按照查询中指定的顺序评估子查询。如果第一个子查询返回的行数超过 10 行，则甚至不会执行第二个子查询。可以通过显示计划轻松检查：

```
addr  opcode         p1    p2    p3    p4             p5  comment      
----  -------------  ----  ----  ----  -------------  --  -------------
0     Trace          0     0     0                    00               
1     Integer        10    1     0                    00               
2     Variable       1     2     2                    00               
3     Goto           0     44    0                    00               
4     OpenRead       3     3     0     keyinfo(6,BINARY,BINARY)  00               
5     SCopy          2     4     0                    00               
6     IsNull         4     23    0                    00               
7     SCopy          3     5     0                    00               
8     IsNull         5     23    0                    00               
9     Affinity       4     2     0     cd             00               
10    SeekGt         3     23    4     2              00               
11    IdxGE          3     23    4     1              01               
12    Column         3     1     6                    00               
13    IsNull         6     22    0                    00               
14    Column         3     0     7                    00               
15    Column         3     1     8                    00               
16    Column         3     2     9                    00               
17    Column         3     3     10                   00               
18    Column         3     4     11                   00               
19    Column         3     5     12                   00               
20    ResultRow      7     6     0                    00               
21    IfZero         1     23    -1                   00               
22    Next           3     11    0                    00               
23    Close          3     0     0                    00               
24    IfZero         1     43    0                    00               
25    Variable       3     13    1                    00               
26    OpenRead       4     3     0     keyinfo(6,BINARY,BINARY)  00               
27    SCopy          13    14    0                    00               
28    IsNull         14    42    0                    00               
29    Affinity       14    1     0     c              00               
30    SeekGt         4     42    14    1              00               
31    Column         4     0     6                    00               
32    IsNull         6     41    0                    00               
33    Column         4     0     7                    00               
34    Column         4     1     8                    00               
35    Column         4     2     9                    00               
36    Column         4     3     10                   00               
37    Column         4     4     11                   00               
38    Column         4     5     12                   00               
39    ResultRow      7     6     0                    00               
40    IfZero         1     42    -1                   00               
41    Next           4     31    0                    00               
42    Close          4     0     0                    00               
43    Halt           0     0     0                    00               
44    Transaction    0     0     0                    00               
45    VerifyCookie   0     3     0                    00               
46    TableLock      0     2     0     table1         00               
47    Goto           0     4     0                    00 
```

计数器被声明为第 1 步，并在第 21、24、40 步递减/测试。

通过结合这两个评论，我们可以提出一个不漂亮的查询，但会产生一个有效的执行计划：

```
SELECT * FROM (
  SELECT * FROM ( SELECT * FROM table1
                  WHERE num1 == ? AND num2 == ? AND num3 == ? AND num4 == ? AND num5 == ? AND num6 > ?
                  ORDER BY num1, num2, num3, num4, num5, num6 )
  UNION ALL
  SELECT * FROM ( SELECT * FROM table1
                  WHERE num1 == ? AND num2 == ? AND num3 == ? AND num4 == ? AND num5 > ?
                  ORDER BY num1, num2, num3, num4, num5, num6 )
  UNION ALL
  SELECT * FROM ( SELECT * FROM table1
                  WHERE num1 == ? AND num2 == ? AND num3 == ? AND num4 > ?
                  ORDER BY num1, num2, num3, num4, num5, num6 )
  UNION ALL
  SELECT * FROM ( SELECT * FROM table1
                  WHERE num1 == ? AND num2 == ? AND num3 > ?
                  ORDER BY num1, num2, num3, num4, num5, num6 )
  UNION ALL
  SELECT * FROM ( SELECT * FROM table1
                  WHERE num1 == ? AND num2 > ?
                  ORDER BY num1, num2, num3, num4, num5, num6 )
  UNION ALL
  SELECT * FROM ( SELECT * FROM table1
                  WHERE num1 > ?
                  ORDER BY num1, num2, num3, num4, num5, num6 )
) LIMIT ?; 
```

请注意，由于外部查询中不需要“order by”子句，因此 sqlite 不需要执行所有子查询。所以它可以在它有正确的行数时停止。子查询的顺序很关键。

需要第二级内部子查询，因为不能在“union all”之前使用“order by”。它们被 sqlite 优化掉了，所以这不是问题。

在包含 777K 行的虚拟表上，初始查询成本：

```
strace -c -eread,lseek sqlite3 toto.db < q1.sql
% time     seconds  usecs/call     calls    errors syscall
------ ----------- ----------- --------- --------- ----------------
 63.57    0.001586           0     18556           read
 36.43    0.000909           0     18544           lseek
------ ----------- ----------- --------- --------- ----------------
100.00    0.002495                 37100           total 
```

而我的只有成本：

```
strace -c -eread,lseek sqlite3 toto.db < q3.sql
% time     seconds  usecs/call     calls    errors syscall
------ ----------- ----------- --------- --------- ----------------
  -nan    0.000000           0        18           read
  -nan    0.000000           0         8           lseek
------ ----------- ----------- --------- --------- ----------------
100.00    0.000000                    26           total 
```

# java - 上传图片的更好方法是什么

> ID：11909696
> 
> 赞同：0
> 
> 时间：2012-08-10T21:46:18.740
> 
> 标签：java, android, post, upload, ftp

我正在编写一个 Android 应用程序。

我想知道通过上传图片`Http POST`还是使用上传图片更好`ftp`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:57:57.757

我推荐 HTTP post，因为如果太多人同时上传，那么 ftp 可能会崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:52:19.820

使用 http post 是更好的方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T21:55:10.753

使用`MimeType`结束`HTTP post`。那将是最好的方法

# perl - 在 POST 方法的 URL 中传递参数

> ID：11909702
> 
> 赞同：2
> 
> 时间：2012-08-10T21:46:58.067
> 
> 标签：perl, cgi

我正在尝试在 URL 中传递参数

例子：

```
// client side
URL: index.pl?action=view_user
METHOD: GET

#perl side

my $Q = CGI->new;
print $Q->param('action'); 
```

返回我`view_user`，但是当尝试在表单上通过示例发布时：

```
// client side
URL: index.pl?action=save_user
METHOD: POST
FORM:
   username: test

#perl side

my $Q = CGI->new;
print $Q->param('action'), "-", $Q->param('username'); 
```

还给我`-test`。**为什么 url 上的参数是空白的？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T21:51:39.320

在处理 POST 请求时，使用`->url_param`而不是`->param`从 URL 获取参数。

# javascript - 具有动态内容或图像的 Sliderjs

> ID：11909703
> 
> 赞同：1
> 
> 时间：2012-08-10T21:46:59.993
> 
> 标签：javascript, jquery

我遇到了一个问题，似乎找不到答案。显然，我使用来自 sliderjs.com 的 sliderjs 来创建一个滑块面板。该脚本适用于硬编码的 html (

*   元素在 niceslideing 面板中呈现）。

    现在我想用javascript动态插入那些ul、li元素。问题是滑块没有正确格式化新插入的代码。我做错了什么，我应该怎么做才能纠正这个问题。任何帮助表示赞赏。滑动面板仅适用于手机设备......

    如果我对它进行硬编码，它就会起作用

    ```
    <div id='slider' class='swipe' style='width:150px'>
    <ul>
    <li style='display:block'><div>1</div></li>
    <li style='display:none'><div>2</div></li>
    <li style='display:none'><div>3</div></li>
    <li style='display:none'><div>4</div></li>
    <li style='display:none'><div>5</div></li>
    </ul>
    </div> 
    ```

    这是我的完整代码，其中的 javascript 不起作用

    ```
     <html>
    <head>
        <title></title>
        <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
        <meta content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=1;" name="viewport" />
        <style type="text/css">
            html{background-color:transparent;height:100%;width:100%;}
            body{background-color:transparent;font-size:11pt;font-family:helvetica;}
            img{border:0px;}        </style>
        <link rel="stylesheet" href="BTA_Blog_Leather_colors/brown/BTA_Blog_Leather_brown.css" type="text/css" />
        <link rel="stylesheet" href="style.css" type="text/css" />
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(document).ready(function(){
                              if ($(".date").text() === "--")
                              $(".datecontainer").hide();
                              if($('.thevideo iframe').attr('src') === ""){
                              console.log('11');
                              $(".videocontainer").hide();
                              }

                              var names = "http://profile.ak.fbcdn.net/hprofile-ak-snc4/187660_100002435611825_501947_q.jpg,http://www.deerns.nl/gfx/image.phtml?image=/images/_images_2012_website/employees/Nederland/Martijn%20Timmer_DIE2082.jpg&width=50&height=50&type=crop,http://profile.ak.fbcdn.net/hprofile-ak-snc4/187660_100002435611825_501947_q.jpg";

    var namesArray = names.split(",");
    var item, items = [];

    for (var i = 0; i < namesArray.length; i++) {
        item = {};
        item.name = namesArray[i];
        items.push(item);
    }

    var main = $("<ul>");
    var str = "<li style='display:block;'><div><img src='http://profile.ak.fbcdn.net/hprofile-ak-snc4/187660_100002435611825_501947_q.jpg' /></div></li>";
    for (var i = 0; i < items.length; i++) {
        str += "<li style='display:none;'><div><img src='" + items[i].name + "' /></div></li></ul>";

    }
    main.html(str);
            $('#slider').append(main);

                              });
            </script>
    </head>
    <body>
        <div id="container">
            <div class="navbar">
                <div class="titlebox">
                    <div class="title">Gaat Europa het redden met de Euro? en met weet ik wat nog allemaal</div>
                </div><!-- end titlebox -->
            </div><!-- end navbar -->
            <div id="body">
                <div class="header">
                    <div class="theimage">
                        <div class="imagecontainer">
                            <div class="image"><!-- <img src="http://www.celfoon.nl/bt-addons/testimage130x130.png" /> -->
                                <div class="datecontainer">
                                    <div class="monthcontainer">
                                        <div class="dmonth">[[DATEMONTH]]
                                        </div> <!-- en monthcontainer -->
                                        <div class="daycontainer">
                                            <div class="dday">[[DATEDAY]]
                                            </div><!-- end daycontainer -->
                                            <div class="yearcontainer">
                                                <div class="dyear">[[DATEYEAR]]
                                                </div> <!-- end yearcontainer -->
                                            </div>
                                        </div>
                                    </div>
                                </div><!-- end datecontainer -->
                            </div>
                        </div>
                    </div><!--end theimage -->
                </div><!-- end header -->   
                <div class="content">

                    <div class="introtextcontainer">
                        <div class="introtext">
            <div id='slider' class='swipe'>

    </div>
    <a href='#' onclick='slider.prev();return false;'>prev</a>
    <a href='#' onclick='slider.next();return false;'>next</a>
    <br><br>
                        </div>
                    </div>
                    <div class="fulltextcontainer">
                        <div class="fulltext">
                            [[FULLTEXT]]
                        </div><!--end fulltext-->
                    </div><!--end fulltextcontainer-->

                    <div class="videocontainer">
                        <div class="thevideo">
                            <iframe allowfullscreen="" frameborder="0" height="174" src="[[YOUTUBE]]" width="280"></iframe>
                        </div><!-- end videocontainer -->
                    </div><!-- end thevideo -->                 
                </div><!-- end content -->
            </div><!-- end body -->
            <div id="footer">
                <div class="footertextcontainer">
                    <div class="footertext">[[FOOTERTEXT]]

                    </div>

                </div>
            </div>
        </div><!-- end container -->
        <script src='swipe.js'></script>
    <script>
    new Swipe(document.getElementById('slider'));
    new Swipe(document.getElementById('slider2'));
    var slider = new Swipe(document.getElementById('slider'));
    var slider3 = new Swipe(document.getElementById('slider3'));
    var slider4 = new Swipe(document.getElementById('slider4'));
    </script>
    </body>
    </html> 
    ```

# php - 带有 cURL 的 PHP 用于 POST

> ID：11909704
> 
> 赞同：0
> 
> 时间：2012-08-10T21:47:00.307
> 
> 标签：php, api, post, curl

我几乎没有使用 cURL 获取内容结果的功能；当我尝试不使用 POST 时，一切正常，但启用 POST 时，结果为空。

此代码不起作用：

```
function getAPI($url){
    $ch = curl_init();
    curl_setopt($ch,CURLOPT_URL,$url);
    curl_setopt($ch,CURLOPT_POST, true);
    curl_setopt($ch,CURLOPT_POSTFIELDS,'shard=Apex');     
    curl_setopt($ch,CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch,CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.0.3) Gecko/20060426 Firefox/1.5.0.3");
    $result = curl_exec($ch);
    return $result; 
    curl_close($ch);
} 
```

此代码有效，但请求不像 POST 那样传递：

```
function getAPI($url){
    $ch = curl_init();
    curl_setopt($ch,CURLOPT_URL,$url);
    //curl_setopt($ch,CURLOPT_POST, true);
    //curl_setopt($ch,CURLOPT_POSTFIELDS,'shard=Apex');   
    curl_setopt($ch,CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch,CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.0.3) Gecko/20060426 Firefox/1.5.0.3");
    $result = curl_exec($ch);
    return $result; 
    curl_close($ch);
} 
```

我用这个命令调用这个函数：

```
echo getAPI('http://world.needforspeed.com/SpeedAPI/ws/cmsbridge/news/rss/fr_FR'); 
```

你也可以试试这个网址

```
http://world.needforspeed.com/SpeedAPI/ws/game/nfsw/driver/levelkro/profile 
```

此 URL 仅在 shard=Apex 时有效（默认 shard=CHICANE 用于 CHHICANE 服务器，但我的配置文件仅在 Apex 服务器上可用）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:51:47.143

根据 SpeedAPI 手册（一个简单的 Google 搜索），给定的 URL 似乎不接受“分片”POST 参数......

[获取新闻 RSS 提要的 SpeedAPI 手册](http://world.needforspeed.com/SpeedAPI/doc/get_news_rss.html)

但是，您可以根据手册使用 GET 请求并在适用的情况下使用分片参数。

例如：[http](http://world.needforspeed.com/SpeedAPI/ws/game/nfsw/driver/DRIVER_NAME/profile?shard=APEX) : //world.needforspeed.com/SpeedAPI/ws/game/nfsw/driver/DRIVER_NAME/profile?shard=APEX（确保您输入大写的分片参数）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T22:09:37.163

您是否尝试过将参数作为这样的数组传递：

```
curl_setopt($ch,CURLOPT_POSTFIELDS,array('shard' => 'Apex')); 
```

# wpf - RichTextBox - 如何传递标记代码

> ID：11909706
> 
> 赞同：2
> 
> 时间：2012-08-10T21:47:03.437
> 
> 标签：wpf, richtextbox

我正在使用`RichTextBox`来显示一些我必须即时标记的只读文本。如何在文本中传递标记代码以使其由`RichTextBox`控件呈现？

例如，我想传递`this is \cf6 sample \cf1 text`给richtextbox 进行渲染。

现在，我构建了一个`FlowDocument`并将文本值添加到运行对象，但文本被逐字呈现。

```
RichTextBox fieldLabel = new RichTextBox();

FlowDocument flowDoc = new FlowDocument();
Paragraph myPara = new Paragraph();
Run myRun = new Run(content);

myPara.Inlines.Add(myRun);
flowDoc.Blocks.Add(myPara);
fieldLabel.Document = flowDoc; 
```

我想看到红色的值，但我看到的是标记。

提前感谢您的任何意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:07:59.577

您不能像那样分配 RTF 文本。您需要将该文本放入流中，然后将该流传递给 RichTextBox.Selection.Load() 方法。例如

```
MemoryStream stream = new MemoryStream(UTF8Encoding.Default.GetBytes(yourRTFText));
fieldLabel.Selection.Load(stream, DataFormats.Rtf); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T23:13:13.363

您必须适用于该段落

```
// Create a FlowDocument to contain content for the RichTextBox.
FlowDocument myFlowDoc = new FlowDocument();

// Add paragraphs to the FlowDocument.
myFlowDoc.Background = Brushes.LightBlue;
myFlowDoc.Foreground = Brushes.DarkRed;
myFlowDoc.Typography.Capitals = FontCapitals.SmallCaps;
myFlowDoc.Blocks.Add(new Paragraph(new Run("Paragraph 1")));
Paragraph p = new Paragraph(new Run("Paragraph 2"));
p.Foreground = Brushes.Black;
myFlowDoc.Blocks.Add(p);
myFlowDoc.Blocks.Add(new Paragraph(new Run("Paragraph 3")));
RichTextBox myRichTextBox = new RichTextBox();

// Add initial content to the RichTextBox.
myRichTextBox.Document = myFlowDoc; 
```

# google-docs-api - 使用 Google Docs API 删除的文档在 Google Drive 中仍然可见

> ID：11909709
> 
> 赞同：2
> 
> 时间：2012-08-10T21:47:28.203
> 
> 标签：google-docs-api, google-drive-api

我使用 Google Docs API（使用 GData）构建了一个集成，允许用户从另一个应用程序创建/编辑文档。最初，当文件被删除时，我们会将它们永久删除。它们不再出现在 Google 文档或 Google 云端硬盘中。现在，当使用 Google Docs API 删除它们时，它们仍然存在于 Google Drive 中的文档列表中。当您尝试点击指向文档的链接时，您会看到“抱歉，您请求的页面（或文档）不存在”。页。

Google Drive 是否不支持通过 Google Docs API 执行的操作？我是否需要同时使用 Google Docs API 和 Google Drive API 删除这些文档？如果用户尚未迁移到 Google 云端硬盘怎么办？有没有办法判断是否已迁移？或者我是否强制他们迁移，以便我可以使用 Google Drive API 来保持他们的 Google Drive 清洁这些死文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:26:29.507

Drive API 和 Docs List API 都在相同的资源上运行，因此您只需使用其中一个（我们推荐使用前者）。

使用 Drive API，您可以[删除](https://developers.google.com/drive/v2/reference/files/trash)或[删除](https://developers.google.com/drive/v2/reference/files/delete)文件。当您删除文件时，它仍会在 Google 云端硬盘中列出，并带有标签以将其标记为已删除，以便您仍然可以将其[取消删除](https://developers.google.com/drive/v2/reference/files/untrash)。

如果要完全删除文件，则必须使用该`delete`方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T17:48:50.250

我遇到了同样的问题，我相信这是驱动器 UI 上的某种缓存。

该文件似乎已正确删除，并且对驱动器 API 不可见。

随着缓存经常被清除，孤立的存根最终会被删除。

我发现通过从父级删除文件然后删除它意味着在测试我的应用程序时使用驱动器 UI 时更容易看到发生了什么。

```
service.children().delete(folderId=parent_id, childId=file_id).execute()
service.files().delete(fileId=file_id).execute() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-29T03:23:21.663

这是一个缓存问题，该文件实际上已被删除。如果您尝试在 Drive UI 中打开该文件，您应该会看到类似“抱歉，您请求的文件不存在”的内容。

它很快就会自行清除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-25T14:30:27.763

我在使用 Google Drive API 时遇到了同样的问题。我认为当 Delete api 删除文档时，它们仍然存在与父文件夹的一些链接，因此浏览器呈现文档。当我厌倦了用下面的代码删除文档时，它对我很有效。

DriveService.Childern.Delete(parentResId, fileId).Fetch(); // fileId=>要删除的文档的ResourceId

# django - 新手。Django 教程（来自 django 网站）停留在第 2 部分 - 管理员

> ID：11909710
> 
> 赞同：4
> 
> 时间：2012-08-10T21:47:30.187
> 
> 标签：django, admin

我在这里阅读了很多答案，但没有一个回答我的确切问题。

我做了第一部分，民意调查。我开始了第 2 部分，管理员，但是，在 runserve 之后，当我尝试访问页面时，这是我得到的错误（我的项目名称是 john）：

```
Page not found (404)
Request Method: GET
Request URL:    http://127.0.0.1:8000/
Using the URLconf defined in john.urls, Django tried these URL patterns, in this order:
^admin/
The current URL, , didn't match any of these.
You're seeing this error because you have DEBUG = True in your Django settings file. `` 
```

我的代码 - urls.py：

```
from django.conf.urls import patterns, include, url

# Uncomment the next two lines to enable the admin:
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
    # Examples:
    # url(r'^$', 'newgrid.views.home', name='home'),
    # url(r'^newgrid/', include('newgrid.foo.urls')),

    # Uncomment the admin/doc line below to enable admin documentation:
    # url(r'^admin/doc/', include('django.contrib.admindocs.urls')),

    # Uncomment the next line to enable the admin:
    url(r'^admin/', include(admin.site.urls)),
) 
```

模型.py：

```
from django.db import models
import datetime
from django.utils import timezone

# Create your models here.
from django.db import models

class Poll(models.Model):
    question = models.CharField(max_length=200)
    pub_date = models.DateTimeField('date published')
    def __unicode__(self):
        return self.question
    def was_published_recently(self):
        return self.pub_date >= timezone.now() - datetime.timedelta(days=1)

class Choice(models.Model):
    poll = models.ForeignKey(Poll)
    choice = models.CharField(max_length=200)
    votes = models.IntegerField()
    def __unicode__(self):
        return self.choice 
```

设置.py：

```
# Django settings for newgrid project.

DEBUG = True
TEMPLATE_DEBUG = DEBUG

ADMINS = (
    # ('Your Name', 'your_email@example.com'),
)

MANAGERS = ADMINS

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3', # Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.
        'NAME': 'C:/john/john/johny.db',                      # Or path to database file if using sqlite3.
        'USER': '',                      # Not used with sqlite3.
        'PASSWORD': '',                  # Not used with sqlite3.
        'HOST': '',                      # Set to empty string for localhost. Not used with sqlite3.
        'PORT': '',                      # Set to empty string for default. Not used with sqlite3.
    }
}

# Local time zone for this installation. Choices can be found here:
# http://en.wikipedia.org/wiki/List_of_tz_zones_by_name
# although not all choices may be available on all operating systems.
# In a Windows environment this must be set to your system time zone.
TIME_ZONE = 'America/Chicago'

# Language code for this installation. All choices can be found here:
# http://www.i18nguy.com/unicode/language-identifiers.html
LANGUAGE_CODE = 'en-us'

SITE_ID = 1

# If you set this to False, Django will make some optimizations so as not
# to load the internationalization machinery.
USE_I18N = True

# If you set this to False, Django will not format dates, numbers and
# calendars according to the current locale.
USE_L10N = True

# If you set this to False, Django will not use timezone-aware datetimes.
USE_TZ = True

# Absolute filesystem path to the directory that will hold user-uploaded files.
# Example: "/home/media/media.lawrence.com/media/"
MEDIA_ROOT = ''

# URL that handles the media served from MEDIA_ROOT. Make sure to use a
# trailing slash.
# Examples: "http://media.lawrence.com/media/", "http://example.com/media/"
MEDIA_URL = ''

# Absolute path to the directory static files should be collected to.
# Don't put anything in this directory yourself; store your static files
# in apps' "static/" subdirectories and in STATICFILES_DIRS.
# Example: "/home/media/media.lawrence.com/static/"
STATIC_ROOT = ''

# URL prefix for static files.
# Example: "http://media.lawrence.com/static/"
STATIC_URL = '/static/'

# Additional locations of static files
STATICFILES_DIRS = (
    # Put strings here, like "/home/html/static" or "C:/www/django/static".
    # Always use forward slashes, even on Windows.
    # Don't forget to use absolute paths, not relative paths.
)

# List of finder classes that know how to find static files in
# various locations.
STATICFILES_FINDERS = (
    'django.contrib.staticfiles.finders.FileSystemFinder',
    'django.contrib.staticfiles.finders.AppDirectoriesFinder',
#    'django.contrib.staticfiles.finders.DefaultStorageFinder',
)

# Make this unique, and don't share it with anybody.
SECRET_KEY = 'cl8%_lzxbct-^ebmpje25%r&amp;5*0=$qmv9gw6i$^arox*kr4$_e'

# List of callables that know how to import templates from various sources.
TEMPLATE_LOADERS = (
    'django.template.loaders.filesystem.Loader',
    'django.template.loaders.app_directories.Loader',
#     'django.template.loaders.eggs.Loader',
)

MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    # Uncomment the next line for simple clickjacking protection:
    # 'django.middleware.clickjacking.XFrameOptionsMiddleware',
)

ROOT_URLCONF = 'newgrid.urls'

# Python dotted path to the WSGI application used by Django's runserver.
WSGI_APPLICATION = 'newgrid.wsgi.application'

TEMPLATE_DIRS = (
    # Put strings here, like "/home/html/django_templates" or "C:/www/django/templates".
    # Always use forward slashes, even on Windows.
    # Don't forget to use absolute paths, not relative paths.
)

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    # Uncomment the next line to enable the admin:
    'django.contrib.admin',
    # Uncomment the next line to enable admin documentation:
    #'django.contrib.admindocs',
    'polls'
)

# A sample logging configuration. The only tangible logging
# performed by this configuration is to send an email to
# the site admins on every HTTP 500 error when DEBUG=False.
# See http://docs.djangoproject.com/en/dev/topics/logging for
# more details on how to customize your logging configuration.
LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'filters': {
        'require_debug_false': {
            '()': 'django.utils.log.RequireDebugFalse'
        }
    },
    'handlers': {
        'mail_admins': {
            'level': 'ERROR',
            'filters': ['require_debug_false'],
            'class': 'django.utils.log.AdminEmailHandler'
        }
    },
    'loggers': {
        'django.request': {
            'handlers': ['mail_admins'],
            'level': 'ERROR',
            'propagate': True,
        },
    }
} 
```

就是这样。哦，是的，我在 WinXP 中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T21:59:46.907

您正在导航到错误的 URL。正如[教程所说](https://docs.djangoproject.com/en/1.4/intro/tutorial02/#start-the-development-server)，

> 现在，打开 Web 浏览器并转到`/admin/`您的本地域 -*例如*，`http://127.0.0.1:8000/admin/`. 您应该看到管理员的登录屏幕：

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T21:56:43.640

在您的 URLconf 中，您没有为根 URL 定义视图，这就是为什么您的应用程序只有在您将浏览器指向以`admin/`

取消注释以下行：

```
# url(r'^$', 'newgrid.views.home', name='home'), 
```

并更改`'newgrid.views.home'`为现有视图，可能会呈现包含一些临时链接的普通模板。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-19T04:58:31.533

我知道这是很久以前问过的，但也许人们仍然在这里寻找相同问题的答案，就像我一样。对我来说，我遇到的问题是我更改了*哪个*urls.py。关键是更改PROJECT urls.py，而不是APP urls.py 文件。

例如，如果您的 PROJECT 名为“mysite”，而 APP 是“polls”，则您要更改的文件位于此处：

```
/mysite/urls.py 
```

不是应用程序版本（位于 /polls/urls.py）。

另外，您可能对我所做的错误感到生气，即将/polls/urls.py 更改为新的“命名空间”语法，然后在对/mysite/urls.py 进行更改后，忘记更改/polls/urls .py 回到教程 3（[https://docs.djangoproject.com/en/1.7/intro/tutorial03/](https://docs.djangoproject.com/en/1.7/intro/tutorial03/)）的“编写更多视图”部分中给出的原始代码

希望这可以帮助某人。（这将是我第一次为 StackOverflow 做贡献！）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-30T04:30:38.270

我也完成了本教程，并且在第 3 部分中遇到了一个问题，它返回了相同的错误；我的困惑在于目录结构。

我已经在我认为教程指定的目录中编写了 urls.py 文件，但它是`~/mysite/urls.py`在教程实际指定的时候`~/mysite/mysite/urls.py`

教程还提示我们创建的文件`~mysite/polls/urls.py`的位置正确，我应该怀疑两组指令只列出了内部目录（`polls`或`mysite`）。遇到此问题后，我不得不重新阅读教程的第 1 部分，但后来我终于从中理解了以下文字：

> 内部`mysite/`目录是您项目的实际 Python 包。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-22T14:03:16.557

您应该在“mysite/mysite/urls.py”文件中的 urlpatterns 类下尝试此语句“url(r'^polls/', include('polls.urls'))”，然后你可以看到你想要什么

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-03T13:53:23.613

我有同样的问题，现在通过两种方式获得解决方案，通过编辑**[mysite/mysite/urls.py]**中的 urls.py或将设置中的 ROOT_URLCONF 更改为**urls.py****如果**您已经编辑了 urls.py manage.py 存在的路径。

# vim - 为什么 `:set tw=n` 在 Vim 中不包装文本？

> ID：11909712
> 
> 赞同：0
> 
> 时间：2012-08-10T21:47:43.570
> 
> 标签：vim

我是 Vim 的新手，并试图将我的文本宽度设置为自动换行。完成本教程并阅读帮助文档后，我不明白为什么该命令`:set tw=78`不起作用。我的`.vimrc`文件包含语句： `autocmd FileType text setlocal textwidth=78` ，它也没有导致包装文本。感谢您对初学者的耐心等待。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:05:04.747

您必须在为 赋值后格式化文本`textwidth`，使用`gggqG`:`gg`将光标设置在文件的开头，`gq`开始格式化并`G`格式化直到文件结尾。这是一个`normal`指令，所以我在命令之前添加了它。

```
autocmd FileType text setlocal textwidth=78 | normal gggqG 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T14:32:03.720

设置`'textwidth'`不够。您还需要添加`t`到`'formatoptions'`（参见 参考资料`:help 'formatoptions'`）。来自`:help 'fo-table'`：

```
letter       meaning when present in 'formatoptions'

t            Auto-wrap text using textwidth
... 
```

所以你可能想使用这个自动命令：

```
autocmd FileType text setlocal textwidth=78 formatoptions+=t 
```

# javascript - jquery 使用 json 对象

> ID：11909714
> 
> 赞同：1
> 
> 时间：2012-08-10T21:48:11.510
> 
> 标签：javascript, jquery

**脚本.js**

```
$('#loginform').submit(function(e){
    $.ajax({
        type:"POST",
        url:"/accounts/login/ajax/",
        data:$('#loginform').serialize(),
        success: function(msg){
            var msg = msg;
            msg = JSON.parse(msg);
            $('#messagestatus').html('');
            if(msg.username != null){
                $('#messagestatus').append(msg.username);
            }
            if(msg.password != null){
                $('#messagestatus').append(msg.password);
            }
        }
    });
    e.preventDefault();             
}); 
```

**返回的对象**

```
{'username':['Required'],'password':['Required']} 
```

当我正在使用`JSON.parse`并发出警报时，它显示了正确的错误，但是当我将它附加到`messagestatus`div 时它没有响应，请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:52:46.903

您的用户名和密码是 json 中的数组。要么让你的 json 看起来像

```
 {'username':'Required','password':'Required'} 
```

或更改您的脚本：

```
 if(msg.username.length > 0)
    {
       $('#messagestatus').text(msg.username[0]);
    }
    if(msg.password.length > 0)
    {
       $('#messagestatus').text(msg.password[0]);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:53:02.723

可能很重要，也可能不重要，但您的 json 对象实际上由子数组组成：

```
{'username':['Required'],'password':['Required']}
            ^----------^            ^----------^ 
```

这意味着JS中解码的数据结构实际上是

```
obj['username'][0]   and        obj['password'][0] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T22:01:09.313

首先，参数不需要在其函数中重新声明。

然后，使用 $.parseJSON() 解析您的 json：

```
msg = $.parseJSON(msg); 
```

您的 JSON 包含数组，使用 msg["username"][0] 访问第一个字符串而不是完整数组。

我会把 e.preventDefault(); 作为 AJAX 之前的第一条语句。

和 .html('') => .empty() 但结果相同。

# jqgrid - 带有虚拟分页的 jqGrid - 无需调用 loadComplte 即可清除网格

> ID：11909720
> 
> 赞同：0
> 
> 时间：2012-08-10T21:48:44.827
> 
> 标签：jqgrid

我在我的 jqGrid (scroll = 1) 上调整了虚拟分页。我正在进行高级服务器端搜索，当找到搜索时，我希望将数据返回到 jqGrid。我想在绑定新数据之前清除网格。我观察到，当我调用 clearGridData 函数时，它会调用加载完成。在绑定找到搜索结果的行之前，有没有办法防止调用 loadComplete 并清除网格中的所有行？

# java - Oracle To_Date 问题

> ID：11909723
> 
> 赞同：0
> 
> 时间：2012-08-10T21:49:30.127
> 
> 标签：java, oracle, function, oracle10g, native

> **可能重复：**
> [Oracle DBMS_SQL.EXECUTE 函数的 TO_DATE 问题](https://stackoverflow.com/questions/11730144/to-date-issue-with-oracle-dbms-sql-execute-function)

我正在使用一个函数，该函数将日期作为 varchar 输入，然后 n 将其传递给另一个过程。我可以看到在某些情况下没有插入与日期相关的过去时间。请在我的功能下方找到

```
iv_plsql4 :='10-AUG-2012 07:30:30';
ln_dbms_cur := DBMS_SQL.OPEN_CURSOR;
iv_plsql2 := BEGIN PKG_PRADEEP.P_INSERTDATE(to_date(iv_plsql4,'DD-MM-YYYY HH24:MI:SS'));

DBMS_OUTPUT.put_line(iv_plsql);
DBMS_SQL.PARSE(ln_dbms_cur,iv_plsql,DBMS_SQL.NATIVE);
ln_cur_execute := DBMS_SQL.EXECUTE(ln_dbms_cur); 
```

此代码将日期插入数据库，但时间为上午 12:00

但是如果我更改下面给出的字符串 iv_plsql2 ，则日期将与 TIME 字段一起插入。

```
iv_plsql2 := BEGIN PKG_PRADEEP.P_INSERTDATE(to_date('10-AUG-2012 07:30:30','DD-MM-YYYY HH24:MI:SS')); 
```

有人可以解释为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:09:28.693

PL/SQL：您的日期格式应该是 DD-MON-YYYY，而不是 DD-MM-YYYY。

Java：您在 CallableStatement 上使用 setInt 来设置日期字符串。这不可能是正确的，事实上我不确定它会如何编译。

# java - Java：弱引用堆栈

> ID：11909727
> 
> 赞同：8
> 
> 时间：2012-08-10T21:49:44.627
> 
> 标签：java, stack, set, weak-references, weakhashmap

在 Java 中有一种称为 WeakHashMap 的数据结构，它将弱引用存储为键。每当弱引用从内存中取出时，条目就会从映射中删除。

**如果我有一个数据结构，例如堆栈或集合，我在其中存储弱引用，当弱引用从内存中取出时，它们的条目会被自动删除吗？**

下面是一个存储弱引用的堆栈示例。

```
Stack<WeakReference<Object>> objStack = new Stack<WeakReference<Object>>(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:56:38.127

是的。您所描述的是一般的弱引用属性，而不是`WeakHashMap`具体的。

从[API](http://docs.oracle.com/javase/6/docs/api/java/lang/ref/WeakReference.html)：

> 假设垃圾收集器在某个时间点确定一个对象是弱可达的。那时它将自动清除对该对象的所有弱引用......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-08-30T17:25:16.360

迟到总比不到好。

这不是弱引用的工作方式。-object`WeakReference`将永远存在，但它的`get()`-method 可能会返回原始对象或`null`（如果原始对象是 GC:ed）。

这意味着您的 Stack 将始终包含一个`WeakReference`-object。

这是我做的一个详细测试（但是它取决于 JVM 在中间执行 GC，这可能会或可能不会发生在“命令”上 -`System.gc()`如果没有发生，请尝试添加更多：s）：

```
public static void main(String[] args) {
    // Set up
    Object object = new Object();
    final WeakReference<Object> weakReference = new WeakReference<>(object);
    final Stack<WeakReference<Object>> references = new Stack<>();      
    references.add(weakReference);

    // Before
    System.out.println("Before:");

    references.forEach(r -> {
        System.out.println("Reference: " + r);
        System.out.println("Object: " + r.get());
    });

    // GC
    object = null;

    System.gc();
    System.gc();
    System.gc();

    // After
    System.out.println("After:");
    references.forEach(r -> {
        System.out.println("Reference: " + r);
        System.out.println("Object: " + r.get());
    });
} 
```

输出：

```
Before:
Reference: java.lang.ref.WeakReference@238e0d81
Object: java.lang.Object@31221be2
After:
Reference: java.lang.ref.WeakReference@238e0d81
Object: null 
```

您最好的方法可能是忽略“弹出”它们后`get()`返回的条目。`null`

旁注：我的第一个测试是使用一个从未得到 GC:ed 的字符串对象。这是因为 Java 中的字符串是“内部的”（请参阅​​ 参考资料`String.intern()`），这意味着有一个隐藏的静态字符串缓存可以重用。字符串永远不会被 GC:ed，除非字符串池已满（或类似的东西......）我认为字符串是唯一具有这种“特殊”特性的 Java 对象，但我建议始终使用自定义对象在 WeakReference 中以确保它得到正确的 GC:ed。

# php - 不确定如何将 bloginfo 引用添加到 wordpress 循环中的图像

> ID：11909728
> 
> 赞同：0
> 
> 时间：2012-08-10T21:49:52.857
> 
> 标签：php, wordpress

我想使用`<?php bloginfo('stylesheet_directory'); ?>`我的 wordpress 循环内部来引用图像，但不确定如何执行此操作。我的图像代码如下：

```
<?php
      if (is_category('Events')) {
        echo '<img src="http://localhost/mmj/wp-content/themes/child-theme/img/live-banner.jpg" class="live-holder-img" />';
      } else if (is_category('News')) {
       echo '<img src="http://localhost/mmj/wp-content/themes/child-theme/img/live-banner.jpg" class="live-holder-img" />';
      } else {
        echo '<img src="" class="default" />';
    } ?> 
```

我宁愿替换`http://localhost/mmj/wp-content/themes/child-theme`为，`<?php bloginfo('stylesheet_directory'); ?>`但我知道我不能包含`<?php`在里面`<?php`，所以我想知道我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:52:53.987

你可以这样使用：

```
echo '<img src="'.get_bloginfo('stylesheet_directory').'/img/live-banner.jpg" class="live-holder-img" />'; 
```

完整代码：

```
<?php
      if (is_category('Events')) {
        echo '<img src="'.get_bloginfo('stylesheet_directory').'/img/live-banner.jpg" class="live-holder-img" />';
      } else if (is_category('News')) {
       echo '<img src="'.get_bloginfo('stylesheet_directory').'/img/live-banner.jpg" class="live-holder-img" />';
      } else {
        echo '<img src="" class="default" />';
    } ?> 
```

很快，我将使用`get_bloginfo()`而不是`bloginfo()`获取样式表目录，而不是打印出来。然后像这样使用它：

```
echo 'Some strings here ' . get_bloginfo() . ' another strings'; 
```

# filter - Extjs4 商店过滤器 - 在字符串中搜索

> ID：11909731
> 
> 赞同：1
> 
> 时间：2012-08-10T21:50:04.880
> 
> 标签：filter, extjs4, store

在 extjs 中存储过滤功能如下：

store.filter（过滤器，值）；这是=> store.filter（列名，要搜索的字符串）；

该值与存储值连续匹配，IE如果我必须在“abcd”中搜索“bc”它不会找到它但是当我给ab时它会匹配，因为abcd以ab开头。

如何在存储过滤器期间过滤带有字符串的值，我想获得在字符串中匹配的所有结果，而不仅仅是字符串的开头。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T00:16:00.587

使用自定义过滤器功能。下面是一个未经测试的例子：

```
var myfilter = new Ext.util.Filter({
    filterFn: function(rec) {
        return rec.get('columnname').indexOf('bc') > -1;
    }
});

store.filter(myfilter); 
```

或者使用 filterBy 方法。

```
store.filterBy(function(rec){
            return rec.get('columnname').indexOf('bc') > -1;
        }
    }); 
```

# mongodb - Mongo DB 分组数据类型更改

> ID：11909733
> 
> 赞同：0
> 
> 时间：2012-08-10T21:50:29.897
> 
> 标签：mongodb, mongodb-java

我在使用 mongodb + 他们的 java 驱动程序时遇到了一个奇怪的事件。当我进行分组查询时，键的数据类型从 int 变为 double。

（即，我正在对“小时”的键进行分组，该键在所有对象中存储为 int，但在我返回的结果中键更改为 double 类型）。

这不是一个大问题……但奇怪的是它会随意更改这样的键值对的数据类型。有没有其他人出现过这个？这是正常行为吗？

谢谢，

ps 执行常规 .find() 查询会返回正确的数据类型，仅供参考。

编辑：一些示例代码：

```
import com.mongodb.BasicDBObject;
import com.mongodb.DBCollection;
import com.mongodb.DBCursor;
import com.mongodb.DBObject;
import com.mongodb.QueryOperators;

public class MongoTestQueries {

private static final String TESTDBNAME = "badgerbadgerbadger";
private static final String TESTCOLNAME = "mushroom";
private static final Long TESTMAX = 50L;

private static final String KEY1 = "a";
private static final String KEY2 = "snake";
private static final String KEY3 = "plane";

/**
 * This starts running it.
 * 
 * @param args
 *            the arguments.
 */
public static void main(final String[] args) {
//You'll need to write your own code here for connecting to db as you see fit.
    MongoConnection mc = new MongoConnection("someserver.com", TESTDBNAME);
    mc.setCurCol(TESTCOLNAME);
    mc.getCurCol().drop();
    mc.setCurCol(TESTCOLNAME);

    DBCollection col = mc.getCurCol();

    populateCollection(col);
    System.out.println(col.count() + " inserted into db.");

    regGroupSearch(col);

}

private static void populateCollection(DBCollection col) {
    for (Long l = 0L; l < TESTMAX; l++) {
        col.insert(new BasicDBObject(KEY1, new Integer(l.intValue())).append(KEY2,
                Math.random()).append(KEY3, (TESTMAX - l) + "a string"));
    }
}

private static void regGroupSearch(final DBCollection col) {
    System.out.println("Group Search:");
    DBObject key = new BasicDBObject(KEY1, true).append(KEY3, true);
    DBObject cond = new BasicDBObject().append(KEY1, new BasicDBObject(QueryOperators.GT, 4.0));
    DBObject initial = new BasicDBObject("count", 0).append("sum", 0);
    String reduce = "function(obj,prev){prev.sum+=obj." + KEY2 + ",prev.count+=1}";
    String finalize = "function(obj){obj.ave = obj.sum/obj.count}";
    DBObject groupResult = col.group(key, cond, initial, reduce, finalize);
    printDBObject(groupResult);
    System.out.println("Done.");
}

private static void printDBObject(final DBObject toPrint) {
    for (String k : toPrint.keySet()) {
        System.out.println(k + ": " + toPrint.get(k));
    }
} 
```

}

# javascript - bing 网络搜索 Api phonegap android

> ID：11909739
> 
> 赞同：2
> 
> 时间：2012-08-10T21:50:41.010
> 
> 标签：javascript, android, cordova, bing-api

我对此真的很陌生。从这里和那里阅读，我尝试使用 bing 搜索 API 编写一些代码，但似乎没有任何反应。

```
 var appid = "API KEY";

function init() {
document.addEventListener("deviceready", deviceready, true);
}

function deviceready() {
console.log('loaded');

$("#searchButton").bind("touchstart",function() {
    var s = $.trim($("#searchField").val());
    console.log("going to search for "+s);

    $.getJSON("http://api.bing.net/json.aspx?Appid="+appid+"&query="+escape(s)+"&sources=image&image.count=20&Market=%27ar-XA%27&Latitude=11.111&Longitude=11.1111&$top=50", {}, function(res) {
        var results = res.SearchResponse.image.Results;
        if(results.length == 0) {
            $("#results").html("No results!");
            return;
        }
        var s = "";
        for(var i=0; i<results.length; i++) {
            s+= "<p>"+results[i].Title+"<br/><a href='"+results[i].Url+"'>"+results[i].DisplayUrl+"</a></p>";                
        }
        $("#results").html(s);
    });

});
} 
```

任何帮助将不胜感激。我一直在拔头发。

请高手帮忙...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T15:07:43.597

bing api 已经改变，现在在 windows azure 数据市场下。[http://api.bing.net](http://api.bing.net)将不再工作。[在此处查看他们的迁移指南（.docx 格式）](http://go.microsoft.com/fwlink/?LinkID=248077)

就个人而言，我在迁移时遇到了麻烦，因为没有太多关于该过程的信息，而且他们现在为使用他们的 API 收取大量的钱，我需要用它来开发。它把我正在构建的应用程序直接扔出窗外。这只是我讨厌微软这些赚钱的混蛋的另一个原因。我希望他们不能这样做，所以我一开始就不会为他们的 API 烦恼。有趣的是，他们可以爬取网站获取数据，然后随意出售。

# asp.net - 正则表达式验证器回发

> ID：11909740
> 
> 赞同：0
> 
> 时间：2012-08-10T21:50:42.217
> 
> 标签：asp.net, regex, validation

我有一个正则表达式验证器。我希望它可以防止回发。第一次我点击一个按钮，然后它给了我错误消息并且没有生成回发，但是在我第二次点击该按钮时，验证器没有被触发或不会阻止回发。

如何获得正则表达式验证器以防止第二次回发？当我在第二次回发时不进行编辑时，也许它没有读取输入框？

也可能是它只阻止回车按钮而不是提交按钮。

我可以确认第一个按钮单击不会生成回发，但其他按钮可以。此按钮使用命令名。

## 就我而言，我试图阻止提交括号。我不想关闭验证请求。

更新它似乎是由于我已将此代码放在容器服务器控件中。当控件直接放在页面中时，不会发生奇怪的行为。评估这意味着什么。

# php - 取消链接功能不起作用

> ID：11909745
> 
> 赞同：-2
> 
> 时间：2012-08-10T21:51:12.633
> 
> 标签：php

我正在使用以下代码。

```
 $un=@unlink('/var/www/vhosts/mtsbeta.com/httpdocs/beta/cache_files/cache.php');
    print_r($unlink);
    @session_destroy();
    //exit;
    $host1=$_SERVER['HTTP_HOST'];
    header("location:https://$host1/index.php?msg=2"); 
```

如果我使用了它正在工作的出口。请告诉我为什么它不工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-10T22:04:10.607

发布的代码中有很多问题：

```
@unlink('/var/www/vhosts/mtsbeta.com/httpdocs/beta/cache_files/cache.php'); 
```

--按照其他人的建议删除@符号，它会抛出错误消息

```
print_r($unlink); 
```

-- 代码中没有调用变量`$unlink`。你所拥有的也是or`$un`的返回值，而不是数组。因此，当您执行 a 时，您要么得到 1（在 true/unlink 成功的情况下），要么什么都没有（在 false/unlink 失败的情况下）——这可能会让您更加困惑。`unlink()``true``false``print_r`

```
header("location:https://$host1/index.php?msg=2"); 
```

- 你已经在做一个`print_r`. 如果任何内容已输出到页面中，则标题将不起作用

我知道这不是对 OP 问题的答案，但我认为考虑到在五行工作代码中至少有三个所需的更改，也许在解决 unlink 不起作用的问题之前再调整一下代码？

# javascript - 在我的上下文中动态添加对象的方法

> ID：11909747
> 
> 赞同：0
> 
> 时间：2012-08-10T21:51:23.627
> 
> 标签：javascript, node.js

在 node.js 中，而不是：

```
dummy = require('dummy')

dummy.aMethod()
dummy.anotherMethod() 
```

我想直接在我的上下文中使用这些方法：

```
dummy = require('dummy')
loadMethods(dummy)

aMethod()
anotherMethod() 
```

如何实现函数 loadMethods ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T22:22:36.963

您可以做的一件事是使用[`with`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/with)，如下所示：

```
with (dummy) {
  aMethod();
  anotherMethod();
} 
```

但不建议这样做，因为它会使很多事情变得模棱两可，并且不会像您期望的那样表现。

要完全按照您的要求进行操作，您可以将这些方法添加到`global`对象中。你可以使用这样的东西：

```
for (var prop in dummy) {
  if (dummy.hasOwnProperty(prop)) {
    global[prop] = dummy[prop];
  }
} 
```

但是，这种方法也有其局限性——例如，您不能在函数体中使用 aMethod()，`this`对象将是错误的（当然，您可以使用`bind`它来保持正确）。此外，`global`它并不是真正的全局，而是模块范围的——所以每个模块都有自己的`global`对象。

因此，权衡选项后，您可能应该坚持使用`dummy`. 这样，您将始终获得预期的行为（`this`will be `dummy`），并且您将清楚地表明您正在使用的方法实际上是在`dummy`模块中实现并使用其状态。找到一个好的 IDE，打字应该不是问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T22:51:40.270

利用 的延展性`this`。当一个函数在没有被绑定到特定范围的情况下被调用时`this`（可以通过[.call](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call)、[.apply](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)或在方法上下文中完成），则`this`指的是全局对象。此代码将在浏览器和 Node.js 中运行，但当然会覆盖任何其他具有相同名称的全局范围的函数。谨慎使用……总的来说，我建议不要使用它。

```
function loadMethods(obj) {
    for (var prop in obj) {
        if (obj.hasOwnProperty(prop) && typeof(obj[prop]) === 'function') {
            this[prop] = obj[prop]
        }
    }
} 
```

[您可以在此处](http://helephant.com/2009/11/29/javascript-method-context/)了解有关`this`上下文的更多信息

# asp.net - 过期时多线程删除 HttpRuntime.Cache 项

> ID：11909759
> 
> 赞同：0
> 
> 时间：2012-08-10T21:52:12.980
> 
> 标签：asp.net, multithreading, caching, iis-7.5, httpruntime.cache

即使我使用 lock 和静态 locker 对象来锁定我的代码同时访问同一个项目，我如何保证在我的 lock 期间 HttpRuntime 不会从另一个线程中删除该项目？我在 HttpRuntime 或 HttpRuntime.Cache 中看不到任何 SyncRoot 属性。

如果我指定过期回调并将我的静态储物柜对象锁定在该回调中，这样做是否合适？

在回调中锁定 HttpRuntime.Cache 过期线程是不是很糟糕？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T18:20:26.917

寻找“SyncRoot”属性建议您`SyncRoot`在将锁定与集合结合使用时使用该属性。这是有原因的，尽管后来的集合支持它以实现向后兼容性，但它往往通过显式实现接口而被隐藏。真的，这个`SyncRoot` 主意不是很好。

在这种情况下，您正在谈论一个线程安全的集合，因此就更不需要了。`System.Web.Caching.Cache`执行自己的锁定（或其他机制，它被指定为线程安全的，而不是通过特定方法成为线程安全的），因此跨多个线程从集合中添加、访问和删除项目不会破坏它。

唯一剩下的风险是，如果对象本身不是线程安全的，或者您在同一个线程中多次从集合中访问它。

第二个很容易通过不这样做来避免。如果你这样做：

```
(HttpRuntime.Cache.Get(someKey) as SomeType).SomeMethod();
(HttpRuntime.Cache.Get(someKey) as SomeType).SomeOtherMethod(); 
```

*仅当您希望*在第二次调用中处理与第一次不同的对象时，这才有意义。否则，很容易解决：

```
SomeType obj = HttpRuntime.Cache.Get(someKey) as SomeType;
obj.SomeMethod();
obj.SomeOtherMethod(); 
```

`Get`（通过不重复调用该方法，您还可以获得轻微的性能提升。

如果您需要担心不同的线程调用`SomeMethod()`，`SomeOtherMethod()`同时您需要确保这些方法是线程安全的，或者锁定与相关对象相关的对象。大多数时候，与对象相关的对象最明显的选择就是对象本身。因此：

```
SomeType obj = HttpRuntime.Cache.Get(someKey) as SomeType;
lock(obj)
{
  obj.SomeMethod();
  obj.SomeOtherMethod();
} 
```

（请注意，即使`SomeMethod()`和`SomeOtherMethod()`是线程安全的，如果它们的组合不是线程安全的，我们可能仍然需要这样做。例如，如果第一个报告对象状态并且我们根据该状态决定是否执行第二个，那么我们通常需要锁定它以防止状态在第一个和第二个方法调用之间发生变化）。

当然，对象上的所有其他操作都需要以相同的方式锁定。如果我们需要将多个对象作为一个单元进行同步，它会变得更加复杂。然后我们需要一个更复杂的规则，即我们锁定什么对象，而不是简单地锁定有问题的对象；因为没有单一的“有问题的对象”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T15:36:09.100

缓存是您的应用程序的私有缓存。运行时唯一对它做任何事情的时候是应用程序重新启动时（即它清除缓存）。当您将项目添加到缓存中时，如果您真的想确保没有其他任何东西干扰您的缓存，您可以提供一个回调来通知删除。

我认为最好设计应用程序和缓存中的内容，以便尽量减少访问缓存中相同项目的两件事的需要。需要两个线程来访问缓存中的同一项目表明存在设计问题。

# mongodb - 是否可以从 MongoDB 查询中返回计算字段？

> ID：11909760
> 
> 赞同：13
> 
> 时间：2012-08-10T21:52:17.357
> 
> 标签：mongodb

在 SQL 中，我可以做类似的事情

```
SELECT myNum, (myNum+1) as `increment` FROM myTable 
```

有效地执行任意数学和其他函数并将它们作为结果中的字段返回。MongoDB也可以这样做吗？

```
db.test.find({}, {_id:1, myNum:1, increment:function() { return this.myNum + 1;}}); 
```

这不会像我期望的那样返回“增量”字段。

我可以在该主题上找到的所有其他相关问题都涉及 GROUPed 查询，而这不是；我只是在获取文档时向文档添加一个“虚拟”字段（客户端计算？）。

或者，这个问题似乎是一个没有“减少”的“地图”；每行都有自己的计算字段。有没有办法将映射函数的结果作为结果/光标返回？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-11T00:35:10.057

MongoDB 2.2 中的新[聚合框架](http://docs.mongodb.org/manual/reference/aggregation/)允许您通过[$project](http://docs.mongodb.org/manual/reference/aggregation/#_S_project)运算符添加计算字段。*这与任意*函数并不完全相同，因为您需要使用[受支持的运算符](http://docs.mongodb.org/manual/reference/aggregation/)，但它确实提供了很大的灵活性。

这是将 s 递增`_id`到新`myNum`字段的示例：

```
MongoDB shell version: 2.2.0-rc0

> db.test.insert({_id:123});

> db.test.insert({_id:456});

> db.test.aggregate(
  { $project : {
      _id : 1,
     'myNum': { $add: [ "$_id", 1]}
  }}
)
{
    "result" : [
        {
            "_id" : 123,
            "myNum" : 124
        },
        {
            "_id" : 456,
            "myNum" : 457
        }
    ],
    "ok" : 1
} 
```

# java - 访问 JSP 页面的数组引用变量

> ID：11909774
> 
> 赞同：0
> 
> 时间：2012-08-10T21:54:27.697
> 
> 标签：java, arrays, jsp, servlets

首先感谢您的阅读！所以我这周刚刚学习了 JSP 和 Servlet，今天早上我开始处理一个程序，它接受来自表单的评论，然后将它们全部显示在同一页面上！到目前为止，它运行良好，但我无法将此程序带入下一阶段。评论删除。

因此，我将评论输出的方式是将每个评论对象放在一个数组中，然后将每个评论字符串连接在一起。通过将每个评论放入一个静态变量中。

`AllComments.addComment(comments[count].toString());`

然后在我的 JSP 页面中我有这样的东西

```
<%=AllComments.getAllComments() %> 
```

所以效果很好。一个新的评论进来，它被连接起来，然后所有的评论都被打印为一个格式化的字符串。

这个问题甚至被认为是有效的，通过将评论放在一起，我再也不能对他们做任何事情了。因此，这使得我无法执行下一步，即在每个评论旁边都有一个链接，并带有删除选项。

因此，为了做到这一点，我认为我需要在我的 JSP 页面上将评论显示为循环，并将每个评论显示为单独的字符串。然后，如果有人单击删除，我可以从数组中删除该评论！

到目前为止，这就是我在 JSP 页面中所做的尝试

```
<%
    for (int i = 0; i < UserBean.getCommentCount(); i++)
    {
        %>
            <%=comments[i].toString() %>
        <%
    }
%> 
```

但是，这不起作用 b/c 注释引用变量的范围仅在受保护的 doPut 方法及其包中。那么我应该怎么做才能让我的评论在循环中一次输出一条评论！您可以在下面查看我的整个 servlet 类。感谢您抽出时间来阅读。

```
if (!request.getParameter("fullName").equals("") && !request.getParameter("comment").equals(""))
{
    UserBean[] comments = new UserBean[10];
    int count = UserBean.getCommentCount();

    comments[count] = new UserBean();
    comments[count].setFullName(request.getParameter("fullName"));
    comments[count].setDate(String.valueOf(new Date()));
    comments[count].setComment(request.getParameter("comment"));
    AllComments.addComment(comments[count].toString());

    UserBean.incrementCommentCount();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:57:34.310

您可以将注释设置为请求或会话属性，这取决于您是否重定向到 JSP。（如果重定向然后会话，导致请求属性将为空）。然后从会话或请求中获取 JSP 页面上的评论。

填写评论后的内部 doPut 方法

```
request.setAttribute("comments",comments);
request.getSession().setAttribute("comments",comments); 
```

在 JSP 页面上，您需要添加到顶部

```
<% UserBean[] comments = (UserBean[]) request.getAttribute("comments"); %>
<% UserBean[] comments = (UserBean[]) session.getAttribute("comments"); %> 
```

希望能帮助到你。

# ios - 简单的字符串加密/解密算法

> ID：11909775
> 
> 赞同：1
> 
> 时间：2012-08-10T21:54:54.077
> 
> 标签：ios, encryption

我需要加密和解密 NSStrings。它不一定是安全的（根本！）对于普通用户来说是不可读的。像移位密码这样简单的东西可以正常工作，但我想要一种对用户来说不太明显的算法。

iOS sdk 中是否有内置的东西可以做到这一点？也许是 RSA 加密？还是一种看起来不像一对一字符交换的简单编码算法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:00:15.043

[Base64](http://en.wikipedia.org/wiki/Base64)怎么样。

它是完全不安全的，虽然不可读，但对于任何在 IT 方面知识渊博的人来说，这将是一个相当明显的编码方案。

实施细节：[如何在 iphone-sdk 上进行 base64 编码？](https://stackoverflow.com/questions/392464/any-base64-library-on-iphone-sdk)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T22:01:41.430

[ROT13](http://en.wikipedia.org/wiki/ROT13)呢？它已经在古罗马使用，使用起来很有趣，而不是保存。

或者使用Web 技术中用于 URL 的[字符串编码。](http://www.w3schools.com/tags/ref_urlencode.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T22:20:07.153

您可以使用替换密码。只需准备一个索引从 1 到 255 的 255 字节数组，打乱数组并将每个字节替换为相应的索引值。另一个简单的密码使用长度为 N 的密钥，由正偏移量和负偏移量组成。nsstring 的每个字节都被移动 - 第一个偏移量为第一个偏移量，第二个字节偏移量为第二个，第 k 个字节偏移量为 (k mod N)-the。对于普通的、没有动力的用户来说，要发现它要困难得多，而且几乎与单班密码一样容易实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-11T12:51:59.657

除了其他建议外，您还可以尝试[Vigenère](http://en.wikipedia.org/wiki/Vigenere_cypher)，它似乎符合您的设计标准：简单且不可读。

# ruby-on-rails-3 - 在生产 amazon ec2 中使用橡胶设置 sunspot solr

> ID：11909781
> 
> 赞同：1
> 
> 时间：2012-08-10T21:55:30.783
> 
> 标签：ruby-on-rails-3, amazon-ec2, sunspot, sunspot-rails, sunspot-solr

我认为 sunspot 非常棒，但我觉得在所有的截屏视频和描述中，在生产环境中设置它的方法并没有涵盖那么多。我想说我对 Rails 还是很陌生，我已经用橡胶将我的应用程序部署到了亚马逊 ec2，到目前为止一切正常，但是，我不知道如何设置太阳黑子的起点我的应用程序。rake sunspot:solr:start 任务仅用于开发，那么我将如何在生产中解决这个问题？我会创建一个新实例并在 ubuntu 上使用 tomcat 安装 sunspot，这是我在某些板上读到的。我将如何让我的应用程序与该实例进行通信？任何建议都非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T00:14:29.700

它实际上比我想象的要容易。让我觉得这很困难的是 sunspot_solr 被分组并仅用于开发而不是生产。但是，在我的 ec2 实例上安装 java 运行时后，我能够执行简单的

```
sunspot:solr:start RAILS_ENV=production 
```

抱歉，如果我的问题现在看起来没有得到很好的研究等等。

# javascript - jQuery 通过下划线模板获取原始文本（未转义）以进行进一步解析

> ID：11909784
> 
> 赞同：6
> 
> 时间：2012-08-10T21:55:47.613
> 
> 标签：javascript, html, underscore.js

我目前有一个像这样的 html 模态块：

```
<div id="modal">
   <div class="header_buttons"></div>
   <p> 
       Are you sure you would like to perform <%= action_name %> 
       on <%= count %> objects?
   </p>
   <div class="footer_buttons">
        <button>Do <%= action_name %></button>
   </div>
</div> 
```

我想通过解析这个内容`_.template`

```
$("#modal").html() //-> escapes `<%` 
$("#modal").text() //-> doesn't escape, but doesn't include tags. 
```

我的直接解决方案是针对每个元素而不是整个块，以便我可以使用`text()`，但我很好奇这里是否有明显的解决方案？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-10T22:15:05.620

您经常看到的一个解决方案是将 HTML 嵌入模板放在脚本标签中，这些标签不是 HTML 转义的。

所以把你`div`变成：

```
<script id="modal" type="text/template">
   ...
</script> 
```

...将`$("#modal").html()`返回原始 HTML。

当然，如果出于某种原因您需要将它放在 a 中`div`，那么这不适合您。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-10T22:04:19.073

只需使用`.html()`，然后搜索并替换您的模板标签：

```
$("#modal").html().replace(/&lt;%=/g, '<%=').replace(/%&gt;/g, '%>'); 
```

这是小提琴：http: [//jsfiddle.net/PwL7L/](http://jsfiddle.net/PwL7L/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-12T04:16:52.370

[_.unescape](http://underscorejs.org/#unescape)应该可以帮助您使用 div 而不是脚本。

> _.unescape($("#modal").html());

# c# - 如何允许访问 MVC 中的方法？

> ID：11909785
> 
> 赞同：1
> 
> 时间：2012-08-10T21:55:50.973
> 
> 标签：c#, ajax, asp.net-mvc

我正在尝试对 MVC 项目中的模型进行 AJAX 调用。我不断收到以下错误：

> POST foobar/GetDate 405（不允许的方法）

（其中 'foobar' 是我的 MVC 项目的 localhost:port 格式。）

我还没有在项目中玩过路由，因为我不确定脚本的路由应该是什么样子。我现在知道如何正确路由视图。以下是一些代码片段：

在我的 MVC 项目中，我有一个具有以下方法的模型：

```
[WebMethod]
public static string GetDate()
{
    return DateTime.Now.ToString();
} 
```

在我的 Index.aspx 文件中，我有以下代码：

```
<button class="getDate">Get Date!</button>
<div class="dateContainer">Empty</div> 
```

在我的 script.js 文件中，我有以下代码：

```
$.ajax({
    type: "POST",
    url: "GetDate",
    data: "{}",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function (msg) {
        // Replace text in dateContainer with string from GetDate method
        $(".dateContainer").text(msg.d);
    },
    complete: function (jqHXR, textStatus) {
        // Replace text in dateContainer with textStatus
        if (textStatus != 'success') {
            $(".dateContainer").text(textStatus);
        }
    },
}); 
```

我的最终目标是将 XML 数据发送到 C# 模型中的方法，然后解析并保存 XML 文档。

现在，我将决定尝试将 jQuery 中的 AJAX 请求链接到我拥有的 C# 方法。我很肯定它与路由和语法有关。

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-10T22:00:12.227

为什么你`[WebMethod]`在 MVC 项目中有一个方法？

在 MVC 中，您可以在s中包含`action`方法。`controller`您也可以从 ajax 调用它

```
public class WebController : Controller
{
    public ActionResult GetDate()
    {
       return Content(DateTime.Now.ToString());
    }
} 
```

你可以像这样从你的javascript调用它（使用jQuery）

```
$.get("@url.Action("GetDate","Web")",function(result){
     alert("The result from ajax call is "+result);
}); 
```

如果您正在`POST`调用该方法，请确保使用 POST 属性装饰您的操作方法。

```
 [HttpPost]
    public ActionResult SaveUser(string userName)
    {
       //do something and return something
    } 
```

您甚至可以将**JSON**从您的操作方法返回到您的 ajax 调用的回调函数。在（我们的 WebController 的基类）类中有一个`JSON`方法`Controller`可以做到这一点。

```
 public ActionResult GetMagician(string userName)
    {
       return Json(new { Name="Jon", Job="Stackoverflow Answering" },
                                  JsonRequestBehavior.AllowGet);
    } 
```

# sql - 使用 SUM 和 Group BY 进行 T-SQL 更新

> ID：11909786
> 
> 赞同：3
> 
> 时间：2012-08-10T21:55:55.547
> 
> 标签：sql, sql-server-2008, tsql

我想用这个查询中的值更新，但它说它返回多个值。

```
UPDATE PO_HEADER
  SET TOTAL = (SELECT SUM(LINE_TOTAL) AS "NEW_LINE_TOTAL" 
  FROM PO_LINE pl, PO_HEADER ph 
  where ph.IC_PO_HEADER = pl.IC_PO_HEADER 
  and ph.RELEASE_NUMBER = pl.RELEASE_NUMBER 
  group by pl.IC_PO_HEADER,pl.FOREIGN_KEY,ph.RELEASE_NUMBER,
  ph.REVISION_NUMBER,ph.PO_NUMBER)
from PO_HEADER ph, PO_LINE pl
where ph.IC_PO_HEADER = pl.IC_PO_HEADER; 
```

> 消息 512，级别 16，状态 1，第 1 行
> 子查询返回超过 1 个值。当子查询跟随 =、!=、<、<=、>、>= 或子查询用作表达式时，这是不允许的。

它如何返回不止一列？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-10T22:08:08.927

如果此查询返回您想要的信息：

```
SELECT *, LINE_TOTAL = SUM(l.LINE_TOTAL) OVER 
    (PARTITION BY l.IC_PO_HEADER, l.RELEASE_NUMBER)
  FROM dbo.PO_HEADER AS h
  INNER JOIN dbo.PO_LINE AS l
  ON h.IC_PO_HEADER = l.IC_PO_HEADER 
  AND h.RELEASE_NUMBER = l.RELEASE_NUMBER; 
```

那么这可能是您想要的 UPDATE 查询：

```
;WITH x AS
(
  SELECT h.TOTAL, lt = SUM(l.LINE_TOTAL) OVER 
    (PARTITION BY l.IC_PO_HEADER, l.RELEASE_NUMBER)
  FROM dbo.PO_HEADER AS h
  INNER JOIN dbo.PO_LINE AS l
  ON h.IC_PO_HEADER = l.IC_PO_HEADER 
  AND h.RELEASE_NUMBER = l.RELEASE_NUMBER
)
UPDATE x SET TOTAL = lt; 
```

我不得不同意戈登，你的分组似乎很奇怪。我不确定我是否做对了（这就是为什么我强烈建议您先运行 SELECT）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-10T22:01:13.803

它返回多于一列，因为子查询选择返回多行。

也许你的意思更像这样：

```
with toupdate as (
     SELECT SUM(LINE_TOTAL) AS "NEW_LINE_TOTAL" 
     FROM PO_LINE pl join
          PO_HEADER ph 
          on ph.IC_PO_HEADER = pl.IC_PO_HEADER and
             ph.RELEASE_NUMBER = pl.RELEASE_NUMBER 
     group by pl.IC_PO_HEADER, pl.FOREIGN_KEY, ph.RELEASE_NUMBER,
              ph.REVISION_NUMBER, ph.PO_NUMBER
    )
UPDATE PO_HEADER
    SET TOTAL = toupdate. New_Line_Total
    from toupdate
    where PO_HEADER.IC_PO_HEADER = toupdate.IC_PO_HEADER; 
```

不过，我仍然对此持怀疑态度，因为您在子查询中按 5 个字段分组，但只加入其中一个。在这种情况下，我希望“toupdate”仅在 ic_po_header 上分组。

# unix - UNIX中文件的格式问题

> ID：11909793
> 
> 赞同：1
> 
> 时间：2012-08-10T21:56:58.283
> 
> 标签：unix, unix-timestamp

我有一些格式如下的数据：

```
Pin|add
jtyjg
Kolk|aaa||
Kawr|wht u
Disnce
Djhdb|bbb|| 
```

我想将其转换为以下格式：

```
Pin|add jtyjg Kolk|aaa||
Kawr|wht u Disnce Djhdb|bbb|| 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T22:16:53.310

目前还不太清楚你想要什么。不过，这个单线应该适用于您的示例：

```
tr -d '\n' < oldfile | sed 's/||/||\n/g' > newfile 
```

根据您的系统，您可能需要使用文字换行符进行 sed 替换，如下所示：

```
tr -d '\n' < oldfile | sed 's/||/||\<RETURN>/g' > newfile 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-12T14:45:52.120

试试这个..

**输入.txt**

```
Pin|add
jtyjg
Kolk|aaa||
Kawr|wht u
Disnce
Djhdb|bbb|| 
```

**代码**

```
cat Input.txt | tr '\n' ' ' | sed 's/|| ./||~~/g' | tr '~~' '\n'| sed '/^$/d' > Output.txt 
```

**输出.txt**

```
Pin|add jtyjg Kolk|aaa||
awr|wht u Disnce Djhdb|bbb|| 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-13T17:11:11.983

我假设原始文件在行尾字符之前没有空格......

这是相当基本的 Perl，适用于 v5.8.9

```
#!/usr/bin/perl

open( IN, '<', 'text.txt' );    # the input file
open( OUT, '>', 'text2.txt' );  # the output file

while( <IN> ) {
        chomp;          # get rid of the end-of-line characters
        $out .= $_;     # add the current input to the output string
        if ( /\|\|/ ) { # does this contain the output signal characters "||"?
                print( OUT "$out\n" );  # output the built string
                $out = '';              # clear the output string
        }
        else {
                $out = $out . ' ';      # append a space to the end
        }
}
print( OUT $out );                      # output anything left over... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-10T23:25:53.177

从表面上看，您希望将三组输入行组合成一个，用空格代替原始换行符。鉴于问题不限制工具集，那么 Perl 解决方案是适度合适的：

```
#!/usr/bin/env perl
use strict;
use warnings;

my($l1, $l2, $l3);
while (defined($l1 = <>) && defined($l2 = <>) && defined($l3 = <>))
{
    chomp($l1, $l2);
    print "$l1 $l2 $l3";
} 
```

如果输入中的行数不是三的倍数，则省略多余的行。代码不会单独处理每个输入文件；它只是将它们结合在一起。对于给定的输入数据，输出为：

```
Pin|add jtyjg Kolk|aaa||
Kawr|wht u Disnce Djhdb|bbb|| 
```

这似乎是正确的。

# html - 当我更新我的官 方网页时，我希望我的 Facebook 页面自动更新

> ID：11909794
> 
> 赞同：0
> 
> 时间：2012-08-10T21:57:03.587
> 
> 标签：html, facebook

当我更新我的官​​方非 Facebook 页面的内容时，我希望我的 Facebook 页面自动获得相同的更新。如果这是可能的，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T23:02:21.620

您使用什么类型的网站？是 Wordpress 还是任何形式的博客，如果是的话，会有一个插件，而如果你自己编写了你的​​网站，你可以使用 PHP，或者更简单的选择是创建一个 RSS 提要，然后使用[http://www之类的东西.facebook.com/RSS.Graffiti](http://www.facebook.com/RSS.Graffiti)更新您的 Facebook 个人资料

# media-player - 以编程方式将字幕添加到 flv 电影

> ID：11909795
> 
> 赞同：0
> 
> 时间：2012-08-10T21:57:05.850
> 
> 标签：media-player, flv, subtitle

我的服务器上有几部 flv 电影。我想让我的用户即时（以编程方式）为他们添加字幕。字幕的时间点和持续时间由管理员确定。他可以通过面板进行设置，并将其存储在数据库中。每部电影可以在不同的时间点有几个字幕。用户可以从数据库中选择电影并通过用户面板为其添加字幕。用户可以添加之前定义的尽可能多的字幕，最终它们将在之前定义的（由管理员）时间点出现在电影中。主要问题是如何将电影与用户添加的字幕结合起来 - 假设正在将带有用户 ID 和电影 ID 的字幕添加到数据库中，以便系统可以显示带有特定用户添加的字幕的电影。电影将通过提供带有 MovieID 和 UserID 的唯一 URL 来显示 - 因此我们将看到带有 UserID 的用户输入的字幕的电影，并且字幕不会覆盖其他字幕。仍然主要的问题是如何为 flv 电影动态添加字幕。HTML5 是，我害怕错误的方式，因为某些浏览器还没有准备好......任何帮助将不胜感激。

此致，

汤姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:03:38.110

您可以使用支持字幕的 3rd 方 Flash 视频播放器。最受欢迎的之一是**JW Player**。在这里您可以找到有关其字幕（字幕）插件的更多信息： [http ://www.longtailvideo.com/support/addons/captions-plugin/14974/captions-plugin-reference-guide](http://www.longtailvideo.com/support/addons/captions-plugin/14974/captions-plugin-reference-guide)

# python - 使用 django_registration 进行选择性用户注册？

> ID：11909800
> 
> 赞同：1
> 
> 时间：2012-08-10T21:57:36.753
> 
> 标签：python, django, authentication, django-registration

我有一个面向多个俱乐部的网站，每个俱乐部都有管理员维护俱乐部成员的数据库。我只想将网站注册限制为已明确添加到俱乐部数据库的会员。 **当会员添加到数据库中时，如何自动生成并向会员发送注册链接？** 换句话说，我希望注册只能由俱乐部管理员发起。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:17:03.740

你说你已经有一个俱乐部成员的数据库，所以你必须有一个主键或一个对该数据库唯一的元组，比如 俱乐部成员应该知道的**俱乐部注册号**

1.  告诉用户在注册时提供主键值（**俱乐部注册号**）。
2.  将该俱乐部注册号也作为您在为用户注册后创建的新数据库的主键，下次如果某个机构将重新使用该俱乐部注册号重新注册，那么***它将失败，因为数据库元组将已经与该俱乐部注册号相关联***
3.  注册时还有一条警告信息***，您可以使用一个俱乐部注册号进行一次注册，仅限该网站。***

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T22:18:45.480

要将注册限制为已在数据库中的人员，您将需要某种方式来识别他们。

1.  要求俱乐部管理员为每个输入的会员输入一个电子邮件地址。
2.  要求用户在注册时提供该地址。
3.  将注册链接发送到该地址，包括链接中用户记录的主键。
4.  当用户单击链接时，在您的 django 视图中检查链接并确保密钥匹配，然后完成注册。

# c++ - g++ 4.7 将运算符 "" 评估为宏扩展的兄弟

> ID：11909806
> 
> 赞同：13
> 
> 时间：2012-08-10T21:58:09.663
> 
> 标签：c++, compilation, user-defined-literals, gcc4.7

我正在将一些代码移至 GCC 4.7（从 4.6 开始）并遇到一些编译器错误并发现[GCC 4.7 移植指南](http://gcc.gnu.org/gcc-4.7/porting_to.html)中记录的问题：

> ## 用户定义的文字和空格
> 
> ISO C11 模式下的 C++ 编译器`std={c++11,c++0x,gnu++11,gnu++0x}` 支持用户定义的文字，这与一些有效的 ISO C++03 代码不兼容。
> 
> 特别是，现在在字符串文字之后和可能是有效的用户定义文字之前需要空格。获取有效的 ISO C++03 代码
> 
> ```
> const char *p = "foobar"__TIME__; 
> ```
> 
> 在 C++03 中，**TIME**宏扩展为一些字符串文字并与另一个连接。在 C++11`__TIME__`中没有扩展，而是`operator "" __TIME__`被查找，导致以下诊断：
> 
> ```
> error: unable to find string literal operator  ‘operator"" __TIME__’ 
> ```
> 
> 这适用于任何字符串文字，后面跟着一些宏而没有空格。要修复，只需在字符串文字和宏名称之间添加一些空格。

虽然我可以修复错误，但我想知道*为什么*我必须这样做。`__TIME__`是一个宏，所以`"something"__TIME__`会在预处理阶段变成`"something""15:52:03"`（或类似的），所以编译器永远没有机会看到它`operator ""`。

这种行为标准是批准的还是一个错误？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-10T22:09:03.450

问题是`"foobar"__TIME__`不再将其标记为预处理器标记`"foobar"`，然后是`__TIME__`.

预处理器标记“具有关键字、标识符、文字、运算符或标点符号的词法形式”。添加用户定义的文字会改变作为预处理器标记的词法。Now`"foobar"__TIME__`是单个*用户定义的字符文字*预处理器标记，因此当翻译的第 4 阶段发生时，它将替换`__TIME__`为`"15:52:03"`，没有`__TIME__`标记可以以这种方式被替换。

是的，标准中规定了这种行为。

由于 cinttypes 宏，受此影响的代码似乎比委员会意识到的要多，他们正在考虑解决它。一些编译器已经开始处理 cinttypes 的问题，但不是以一种可以`__TIME__`为您解决这种用法的方式。我认为您最好的选择是更改代码。

# javascript - 无法使用 jquery 加载页面的某些部分

> ID：11909809
> 
> 赞同：0
> 
> 时间：2012-08-10T21:58:29.287
> 
> 标签：javascript, jquery

您好，我有一个带有 div 标签的 html 页面，该标签是使用 javascript 动态填充的。现在，我只能在另一个页面中打开 div 标记的内容，但我无法做到这一点。我尝试过使用 iframe、jquery 加载等，但没有任何效果。
要么显示整个页面，要么显示空 div（在执行 javascript 之前）。

那么，有没有办法确保当所需的页面加载到不同的页面时，javascript 已经执行，所以当 div 的内容被捕获时，它已经被填充了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:14:28.197

使用 div 的 html 内容设置一个变量，将该变量传递给服务器并显示在另一个页面中..

var foo = html代码

之后

window.location(web.page.dir?phpvariable=foo)

在新页面中

echo phpvariable --这个变量有你想要的html代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T22:12:40.490

另一种选择是在到达浏览器之前用 PHP 填充 div 标签。

# sockets - 子域上的 Lighttpd 和 Redmine 给出 500 错误

> ID：11909820
> 
> 赞同：2
> 
> 时间：2012-08-10T21:59:53.983
> 
> 标签：sockets, redmine, lighttpd

好的，我得到了我的 CentOS6 VPS 和 Lighttpd 工作就像一个魅力。我安装了 Redmine，让它在 Webrick 上运行。当我杀死 Webrick 并尝试使用 fastcgi 在 Lighttpd 上托管 Redmine 时，我得到的唯一消息是 500。我的 PHP 应用程序运行良好。

每次我尝试访问我的 redmine 时，我都会在我的日志文件中收到这两条消息：

> （mod_fastcgi.c.2543）意外的文件结束（也许fastcgi进程死了）：pid：8490 socket：unix：/tmp/redmine.socket-0
> 
> (mod_fastcgi.c.3329) 未收到响应，已发送请求：597 on socket: unix:/tmp/redmine.socket-0 for /dispatch.fcgi?，关闭连接

/tmp/ 是可写的，lighttpd 用户拥有所有 redmine 文件，我的 lighttpd.conf 文件如下：

```
 $HTTP["host"] =~ "redmine.domain.com" {
        server.document-root = "/path/to/redmine/public"
        server.errorlog = "/path/to/redmine/log/lighttpd.log"
                accesslog.filename = "/path/to/redmine/log/access.log"
        magnet.attract-physical-path-to = ( "/path/to/redmine/tmp/cleanurl.lua" )
        fastcgi.server    = ( "dispatch.fcgi" =>
                ((
                        "socket" => "/tmp/lighttpd/redmine.socket",
                        "bin-path" => "/usr/bin/ruby /path/to/redmine/public/dispatch.fcgi",
                        "max-procs" => 1,
                        "idle-timeout" => 20,
                        "kill-signal" => 9,
                        "bin-environment" => (
                               "RAILS_ENV" => "production",
                                "TARGET" => "/path/to/redmine/public/dispatch.fcgi"
                        )
                ))
        )
} 
```

Lighttpd 重启正常，没有错误。

当然，/path/to/redmine 指向我实际的 redmine 文件夹。

软件版本：

> CentOS 6 x64
> Lighttpd 1.4.31
> Ruby 1.8.7
> Rails 3.2.6

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T11:19:23.673

终于搞定了。我只需要在我的 dispatch.fcgi 文件中添加两个要求，如下所示：

> 需要'rubygems'
> 需要'fcgi'

提示：他们**必须**先到文件的顶部，在另一个需要之前。

/主题关闭。

# java - 将音频添加到 java 程序

> ID：11909821
> 
> 赞同：-3
> 
> 时间：2012-08-10T21:59:55.293
> 
> 标签：java, audio

我想在我制作的游戏中添加背景中的循环音乐，以及在某些事件发生时播放的声音。我搜索了谷歌，但我想出的唯一结果是如何将它们实施到 Applet 或过时的版本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T08:09:38.413

如果您不介意链接本机代码，您可以使用几个提供与本机游戏/声音库绑定的 Java 库。例如：[Java 绑定到 SDL](http://sdljava.sourceforge.net/)、[LightWeight Java Game Library](http://lwjgl.org/)或[JogAmp](http://jogamp.org/)（后两者使用[OpenAL](https://en.wikipedia.org/wiki/OpenAL) API）。

您也可以使用集成到 JDK/JRE 中的 Java 的[javax.sound 包](http://docs.oracle.com/javase/tutorial/sound/index.html)，但根据我的经验，使用它并不容易。

# ruby-on-rails - Rails 应用程序正常工作，但在 rpsec 测试中不行。“零级”

> ID：11909830
> 
> 赞同：0
> 
> 时间：2012-08-10T22:00:42.843
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec

创建合同时，它需要一个单位、用户和折扣，并使用这些参数项（模型）来生成发票。

在浏览器中一切正常。但是在运行规范时，我得到`undefined method 'value' for nil:NilClass [/app/models/option.rb:19:in 'get_from_database'`

Option.rb 的第 18-20 行。这是从数据库中获取站点选项（可由管理员配置）的模型。正常工作（浏览器测试）。

```
def self.get_from_database(name)
  $option[name] = self.find_by_name(name).send('value')
end 
```

它是从 Contract.rb 调用的：

```
def start_date=(date)
    self[:start_date] = Date.strptime(date, Option.get_from_database('short_date'))
end 
```

知道为什么我会收到此错误吗？如果我注释掉这一行并重新运行规范测试，我会`nil:NilClass`从另一个类方法调用中得到另一个错误。

我刚刚开始使用 rspec，所以我确定我错过了一些东西。注意：第一个测试有效，第二个无效。

```
require 'spec_helper'

module ContractSpecHelper
  def contract_params
    {  :start_date => "08/09/2012",
       :client_id => '1', 
       :pay_interval_id => '1', 
       :billing_day => "1",
       :prorated => '1',
       :require_next => "1",
       :include_today => "1",
       :unit_id => '45',
       :due => "1" }
  end
end

describe 'Contract' do
  include ContractSpecHelper

  before :each do
    @contract = Contract.new
  end

  describe '#new' do
    it "requires a unit, user, and pay interval id" do
      @contract.should_not be_valid
    end

    it "creates an invoice once saved" do
      @contract.attributes = contract_params
      @contract.save

      @contract.should have(1).invoice
    end
  end

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T23:20:57.093

问题似乎`Option.find_by_name(name)`是返回零。

最可能的原因是您没有在测试环境中填充选项表。更改您的代码以处理不存在的选项记录，或在块（等）之前使用 fixtures/factory_girl/machinist/ 在您的测试环境中创建选项记录。

（要回答您的其他问题，您的环境应该加载到您的 spec_helper 中。您不需要手动将 Rails 模型包含到您的 rspec 规范中。）

# java - 为什么我不能删除这个 JTextField 默认键绑定？

> ID：11909835
> 
> 赞同：2
> 
> 时间：2012-08-10T22:00:52.077
> 
> 标签：java, swing

我有一个扩展 JTextField 的类，我想让 CTRL-Shift-O 做一些事情。我一直在听

```
JTextFieldExtension.addKeyListener(new KeyAdapter() {

public void keyReleased(KeyEvent e)
{
}

} 
```

在 e.isControlDown() 和 e.isShiftDown() 的帮助下，效果很好。但我注意到该字段中的文本也从左侧移动到右侧。显然这是 JTextField 的默认行为。所以我在 SO 上发现了这个似乎很有帮助的线程：

[如何禁用 JTextField 中的默认文本字段快捷方式](https://stackoverflow.com/questions/1476462/how-to-disable-default-textfield-shortcuts-in-jtextfield)

从那个线程，调用**jtextField.getInputMap().setParent(null);** 确实停用了该行为。但它也摆脱了 Ctrl-C 和其他我仍想保留的有用映射。所以我尝试了建议的方法来删除 KeyStroke“ctrl shift O”。但它们似乎都不起作用。

目前在类的构造函数中，我有以下内容：

```
 this.getInputMap().put(KeyStroke.getKeyStroke("shift ctrl pressed O"), null);
     KeyStroke[] strokes = this.getInputMap().allKeys();
     for (KeyStroke ks : strokes)
     {
        System.out.println(ks.toString());
     } 
```

尽管 System.out.Println 显示“shift ctrl press O”作为它列出的 allKeys 之一，但它不起作用。我也尝试调用 InputMap.remove 而不是 Put()，但没有成功。

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T00:01:44.713

在这种情况下，从输入映射中删除键似乎没有像我预期的那样工作，但是您可以覆盖已安装的操作以有效地禁用“切换组件方向”。在 Swing 中，输入映射将击键映射到对象（通常是字符串），这些对象用作动作映射的标识符，动作映射再次保存相应的动作。因此，禁用 ctrl+shift+O 的简单方法如下：

```
myComponent.getInputMap().put(KeyStroke.getKeyStroke("shift ctrl pressed O"), "Nothing"); 
```

这只是将击键重新映射到操作映射中未包含的内容（字符串“Nothing”，也可能是“Foo”），因此当您按下 ctrl+shift+O 时不会发生任何事情。

编辑：我可以看到这是在您链接的线程中提出的。但是，我确实确认上述代码适用于文本字段。如果它不适合您，请在您的代码中提供一个简短的调用示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-28T19:48:43.463

所有默认绑定都列在`InputMap`您的组件中。我只是想指出另一种方法，考虑到人们正在努力实现的目标，这可能会更好：

```
 myTextComponent.getActionMap().put("toggle-componentOrientation", myAction}); 
```

# ios5 - 如何有条件地在 XCode 中包含框架？

> ID：11909838
> 
> 赞同：1
> 
> 时间：2012-08-10T22:01:06.103
> 
> 标签：ios5, xcode4, frameworks, ios6

我有一个在 XCode 4.4 中针对 iOS 5 构建的应用程序。现在 XCode 4.5 测试版已经发布，我想尝试我的应用程序，利用其中一个新框架。

但是，当我回到 XCode 4.4 时，它抱怨找不到我包含的较新框架，因为它在 iOS 5 中不存在。

我如何在开发我的应用程序时考虑到未来的 iOS 6，告诉 XCode 在我使用较旧的 XCode 时忽略较新的框架？

ps 感谢您忍受我认为是一个非常业余的问题:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T09:04:26.547

不确定您是否在寻求答案。认为您需要[此链接](https://stackoverflow.com/a/6033512/1424174)中的解决方案。即您可以`optional`为不同版本中不可用的框架设置值。

# html - 设置水平表单和附加按钮

> ID：11909841
> 
> 赞同：0
> 
> 时间：2012-08-10T22:01:29.933
> 
> 标签：html, css, twitter-bootstrap

我有一个表格： http: [//fiddle.jshell.net/eJ2kS/](http://fiddle.jshell.net/eJ2kS/) 我想在一行上输入标签和文本，并将按钮附加到文本输入，但文档对附加按钮有点含糊： [http://twitter.github.com/bootstrap/base-css.html#forms](http://twitter.github.com/bootstrap/base-css.html#forms)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:46:26.067

您必须像下面这样覆盖样式。请注意，这不是关于使用您的框架的解决方案。

```
.control-group, .btn, .control-group label, .controls{ float:left !important; }
.controls{ margin:0 1em !important; }
.control-group{ margin:0 !important; }
label{ margin:5px !important; } 
```

我希望这是你想要的。它将所有需要的元素浮动到左侧并更正一些边距。就这样。这`!important`是强制覆盖框架中的旧值。

这是您更新的小提琴： http: [//fiddle.jshell.net/eJ2kS/5/](http://fiddle.jshell.net/eJ2kS/5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:54:10.380

你选择这个吗？![在此处输入图像描述](../Images/58d0853937dc55f00cbc12092f5df145.png)

如果是这样，那么代码应...

```
<form id="signup" method="post" action="/signup" class="form-horizontal">
                    <legend>Sign Up</legend>

                    <div class="control-group">
                        <label for="appendedInputButton" class="control-label">User Name</label>
                        <div class="controls">
                          <div class="input-append">
                            <input type="text" size="16" id="appendedInputButton" class="span2"><button type="button" class="btn">Check Availabilty</button>
                          </div>
                        </div>
                     </div>
                </fieldset>
            </form> 
```

我想我已经更新了你的小提琴......就在[这里。](http://fiddle.jshell.net/eJ2kS/12/)

# javascript - 如何更改无法通过标签、id 或类选择的文本？

> ID：11909844
> 
> 赞同：3
> 
> 时间：2012-08-10T22:01:35.243
> 
> 标签：javascript, jquery, html

我需要改变`text to change`。如何用 jQuery 做到这一点？

```
<form name="loginform" id="loginform" action="" method="post">
    <p>
        <label for="user_login">text to change<br />
        <input type="text" name="log" value="" /></label>
    </p>
</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T22:03:22.257

```
$("label[for='user_login']").text("New text"); 
```

请参阅：[属性等于选择器 [name="value"]](http://api.jquery.com/attribute-equals-selector/)

* * *

我看到，有点不同，比如：

```
var splitElem = "<br>";
var saveHtml = $("label[for='user_login']").html().split(splitElem)[1];
var newText = "New Text"
var newHtml = newText + splitElem + saveHtml;
$("label[for='user_login']").html(newHtml); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T22:11:36.413

仅替换 textnode ：

```
var newText = 'some text',
    elm = $('label[for="user_login"]').children();
    $('label[for="user_login"]').html(newText).append(elm); 
```

[**小提琴**](http://jsfiddle.net/k6M8k/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-10T22:19:49.050

那么试试这个：

```
var newText = 'some text';
$('label[for="user_login"]').contents().filter(function() { return this.nodeType == 3; }).first().replaceWith(newText);​ 
```

[小提琴](http://jsfiddle.net/fPZus/)

不过，我不保证它的性能:)，否则它应该这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T22:11:20.643

用`span`标签包裹文本。

```
<label for="user_login"><span>text to change<span><br />
<input type="text" name="log" value="" /></label>

$("label[for=user_login] > span").text("replaced text"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-10T22:11:43.040

会有一个很好的解决方案，因为在 HTML 中您无法选择和处理文本。您只能影响周围的标签。

你现在有一些可能性。

*   关闭输入标签之前的标签并更改孔标签的内容
*   将标签的文本包装在另一个标签中，如跨度并影响跨度
*   不要改变你的 HTML 结构，使用 JS 来获取标签的内容并替换之前被正则表达式过滤的空白文本
*   在JS中保存输入元素，替换标签的洞内容然后再次追加输入元素

# configuration - 为 chrome 扩展设置配置（配置 chrome 扩展参数）

> ID：11909846
> 
> 赞同：1
> 
> 时间：2012-08-10T22:01:47.677
> 
> 标签：configuration, google-chrome-extension

我们公司希望将我们的软件（Windows 的二进制 .exe）与简单的 chrome 扩展（仅内容脚本{它不使用 chrome API}）捆绑在一起。

我们的二进制 .exe 将动态生成一个字符串，该字符串必须传递给我们的 chrome 扩展程序。

我的问题是 - 怎么做？

似乎 chrome 扩展缺少某种配置文件。如果我可以创建一个 EXTENSION-ID.ini 并在那里设置配置或将其放在注册表中（如果是 Windows），那就太好了。

或者，我想我可以让我的二进制文件动态地将我们插件的每个文件（.js、.manifest）构建到一个单独的文件夹中，设置我们需要传递的这个字符串，然后将这个文件夹打包到一个 .crx 中，最后设置 Windows 注册表项，告诉 chrome 在初始化时安装此扩展。（但这似乎不是一个实用的解决方案，并且仍然必须重新启动浏览器才能获得更新的字符串值）。

我尝试部署一个 .crx 并通过使我的扩展程序注入页面中的脚本标记来从外部本地文件加载配置

```
<script src="file://c:/path/to/configs.js"></script> 
```

但它没有用，不知道为什么 - 也许扩展无法访问 file:// 协议？

看起来可以使用 chrome.extension.getURL() 通过 javascript 访问扩展本地路径；但这也无济于事，因为我想没有简单的方法可以将文件插入已打包的 .crx .... 如果它还没有打包，我的意思是，如果它只是一个包含文件的文件夹，那么 chrome不会让我安装扩展。天啊...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:18:59.917

好吧，这不是扩展应该如何工作的想法，这就是它看起来如此棘手的原因。扩展无法访问本地驱动器中的文件，也无法读取任何配置文件，也无法通过 dll 链接。

我会通过将信息作为参数传递到特定的 url 来将信息发送到我的扩展程序。假设[http://www.abc.com](http://www.abc.com)触发您的内容脚本，那么您应该调用[http://www.abc.com?param=configurationParametersAllYouCanPutInThisLine](http://www.abc.com?param=configurationParametersAllYouCanPutInThisLine)

我们可以计算出细节，例如在加载页面之前运行脚本等。

使用 Flash 访问本地驱动器可能会有更好、更优雅的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-11T20:02:03.613

尝试使用

```
chrome.extension.getURL('folder/file.js') 
```

其中文件夹是您的扩展包中的文件夹。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-02T10:23:38.000

对于这种情况，本机消息传递可能很有用。它允许扩展程序与本机应用程序对话。 [http://developer.chrome.com/extensions/messaging.html#native-messaging](http://developer.chrome.com/extensions/messaging.html#native-messaging)

# python - Python - 替换表情符号的字符

> ID：11909849
> 
> 赞同：-1
> 
> 时间：2012-08-10T22:01:55.493
> 
> 标签：python, regex

```
l = ':;\'"!@#$%^&*()_-=+][{}~`.><?/\\|' # list of character that can be used for emoticons

s = '<p>This :) is an example for:) emoticons :)</p>' 
```

我用过`s.replace(':)', '<img>')`，

```
result = '<p>this <img> is an example for<img> emoticons <img></p>' 
```

如何使结果如下：

```
result = '<p>this <img> is an example for:) emoticons <img></p>' 
```

谢谢你的帮助！

编辑：我有一个初始列表`l`。用户只能从`l`. 例如：`:)`, `:]`, 等。对于每个表情符号，我会分别将其更改为图像作为响应。所以用户必须正确输入数据：通配符应该是独立的。困难的部分是输入数据包括 HTML 标签。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T22:35:51.040

```
import re
emos = { ':)' : 'smiley.jpg',
         ':(' : 'saddy.jpg',
         ';p' : 'bllinky.jpg' }
pattern = re.compile('|'.join( re.escape(emo) for emo in emos))
def emoImg(emoMatch):
    return '<img src = "/images/{0}>'.format(emos[emoMatch.group(0)])
def emoSub(string):
    return pattern.sub(emoImg,string)
print(emoSub('Hi :) I miss you :(')) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T22:13:11.800

```
>>> s = '<p>This :) is an example for:) emoticons :)</p>'
>>> s.replace(' :)', ' <img>')
'<p>This <img> is an example for:) emoticons <img></p>' 
```

如果您只想在模式具有前导空格的情况下进行替换，请在匹配和替换周围放置一个前导空格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T22:13:30.830

```
import re
s = '<p>This :) is an example for:) emoticons :)</p>'
s = re.sub('\s:\)', ' <img>',s) 
```

# html - 为什么插入符号在某些网站上显得更粗？

> ID：11909851
> 
> 赞同：0
> 
> 时间：2012-08-10T22:02:36.880
> 
> 标签：html, css, textbox, caret

一些网站在 Chrome 中使用更大的插入符号。例如，在堆栈溢出上：

![粗插入符号屏幕截图](../Images/a3dc05dd6abd6143748906bbacf77493.png)

其他人，例如谷歌，不要：

![细插入符号屏幕截图](../Images/dfe750172e0f63e4d27aa7ab831b02e1.png)

我在元素检查器中看不到任何似乎定义它的东西。这是怎么做到的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T22:05:01.743

这是更改字体大小的副产品，并且可能由于亚像素渲染而绘制了“更粗”的线。你不能直接改变它，你绝对不应该关心它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T22:09:22.890

您需要使用自定义光标，您可以自行下载或创建。

然后把它放在你的 CSS 中：

```
cursor: url("customCursor.cur"); 
```

# rest - 在 Silex / Symfony 2 中验证没有模型的 POST 数据？

> ID：11909853
> 
> 赞同：6
> 
> 时间：2012-08-10T22:03:04.603
> 
> 标签：rest, symfony, silex

我正在构建一个仅提供 json/xml 数据的 RESTful 应用程序，我选择了 Silex，因为我已经（有点）了解 Symfony 2 并且因为它很小，所以我不需要 Twig 等...

没有模型，只有使用 Doctrine dbal 和序列化程序的普通旧 SQL 查询。无论如何，我应该验证 POST/PUT 请求。在不使用表单组件和模型的情况下如何做到这一点？

我的意思是 POST 数据是一个数组。我可以验证它（添加约束）吗？如何验证？

**编辑**：好的，现在我找到了一个有趣的库，即[尊重/验证](http://packagist.org/packages/Respect/Validation)。如果需要，它还使用 sf 约束。我最终得到了这样的东西（早期代码：P），如果没有更好的东西我会使用它：

```
$v = $app['validation.respect'];

$userConstraints = array(
    'last'     => $v::noWhitespace()->length(null, 255),
    'email'    => $v::email()->length(null, 255),
    'mobile'   => $v::regex('/^\+\d+$/'),
    'birthday' => $v::date('d-m-Y')->max(date('d-m-Y')),
);

// Generic function for request keys intersection
$converter = function(array $input, array $allowed)
{
    return array_intersect_key($input, array_flip($allowed));
};

// Convert POST params into an assoc. array where keys are only those allowed
$userConverter = function($fields, Request $request) use($converter) {

    $allowed = array('last', 'email', 'mobile', 'birthday');

    return $converter($request->request->all(), $allowed);
};

// Controller
$app->match('/user', function(Application $app, array $fields)
    use($userConstraints) {

    $results = array();

    foreach($fields as $key => $value)
        $results[] = $userConstraints[$key]->validate($value);

})->convert('fields', $userConverter); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-11T14:55:39.050

好吧，您可以使用 Symfony2 Validator 组件验证数组，例如

```
//namespace declaration    
use Symfony\Component\Validator\Constraints\Collection;
use Symfony\Component\Validator\Constraints\Email;
use Symfony\Component\Validator\Constraints\Date;
use Symfony\Component\Validator\Constraints\NotBlank;
//....

 //validation snippet

  $constraint = new Collection(array(
    'email' => new Email(),
    'last'  => new NotBlank(),
    'birthday' => new Date(),
  ));

  $violationList = $this->get('validator')->validateValue($request->request->all(), $constraint);

  $errors = array();
  foreach ($violationList as $violation){
    $field = preg_replace('/\[|\]/', "", $violation->getPropertyPath());
    $error = $violation->getMessage();
    $errors[$field] = $error;
  } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T23:00:57.907

如果您想使用 Symfony2（与 silex 类似）构建 API，这里有一个很好的教程：[http ://williamdurand.fr/2012/08/02/rest-apis-with-symfony2-the-right-way/](http://williamdurand.fr/2012/08/02/rest-apis-with-symfony2-the-right-way/)

在 silex 上验证发送值的最佳方法仍然是使用[验证](http://silex.sensiolabs.org/doc/providers/validator.html)和[表单](http://silex.sensiolabs.org/doc/providers/form.html)组件（带模型）！他们被要求执行此操作！阅读由 Hugo Hamon 创建的完整幻灯片，以使用 silex 构建您的 API！[http://www.slideshare.net/hhamon/silex-meets-soap-rest](http://www.slideshare.net/hhamon/silex-meets-soap-rest)（查看第 42 页进行验证）

不要在操作中一一验证发送的元素。

通过这样做，您将保持您的代码干净和不断发展！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T22:53:21.680

在这里的 Symfony Book 中有很好的解释：http: [//symfony.com/doc/master/book/forms.html#adding-validation](http://symfony.com/doc/master/book/forms.html#adding-validation)

# r - ggplot2 boxplots 对我来说没有任何意义，为什么会这样？

> ID：11909854
> 
> 赞同：1
> 
> 时间：2012-08-10T22:03:07.987
> 
> 标签：r, ggplot2, boxplot

所以我有一个数据框，就像：

`time,candidate_id,allocation_id,final_score,position data`...

然后我正在尝试制作一个 ggplot2 箱线图。我希望这个箱线图对每个`allocation_id`. 我试着做一个：

```
ggplot(data=(allocation_info), aes(allocation_id, final_score)) 
```

但不是为每个得到多个`allocation_id`箱线图，我只得到一个巨大的箱线图。有人知道为什么会发生这种情况吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T22:09:41.733

您需要包括组或颜色美学：

```
data(mpg)
ggplot(data=mpg) + geom_boxplot(aes(x=cyl, y=displ, group=cyl)) 
```

因此，对于您的特定数据集，它将类似于：

```
ggplot(data=(allocation_info), aes(allocation_id, final_score)) + 
    geom_boxplot(aes(group=allocation_id)) 
```

# c# - 无法在 C# Express (2008) 中删除断点

> ID：11909865
> 
> 赞同：3
> 
> 时间：2012-08-10T22:04:13.213
> 
> 标签：c#, visual-studio-2008, breakpoints

我已经做了很长一段时间的工作，在此期间我不得不在计算机之间移动我的项目，我认为这不知何故导致我的断点损坏。

我似乎无法删除断点。如果我右键单击断点并单击删除，它会在屏幕上消失，但下次调试时又会出现。

VC# 在哪里存储断点？据我所知，它似乎不在我的项目文件夹中......

我也尝试过删除 PDB 文件，但没有效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T22:10:33.583

找到了解决方案。您必须在 Windows 资源管理器中启用隐藏文件/文件夹并删除 VS Projects Folder\Your Project 中的 .suo 文件。

@Rob Delete All Breakpoints 在 Express 版本中不可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T22:10:43.363

断点存储在 .suo 文件中，因此要将所有内容重置为默认值，请尝试删除解决方案根文件夹中包含的 yoursolutionname.suo 文件...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T22:08:51.943

ctrl+shift+f9 或调试 >> 删除所有断点

# python - 计算多个标签 tsv 文件

> ID：11909868
> 
> 赞同：0
> 
> 时间：2012-08-10T22:04:20.197
> 
> 标签：python, parsing, csv, awk, tsv

我正在尝试解析一个巨大的制表符限制文件（tsv 文件）并将其转换为逗号分隔值文件。我遇到的问题是，并非 tsv 文件中的所有条目都是完整的，其中一些条目不完整，并且由条目之间的多个制表符间距表示。现在，当我将其转换为 csv 文件时，我希望它们之间有“na”，表示该记录字段中没有任何条目。

例如，考虑学生记录示例（1 个制表符 = 4 个空格，请忍受我糟糕的格式）

```
Name    Age    Department    GPA
Kevin    21    Computer Science    3.4
Tom    20        3.8
Kelsey    22    Psychology        (2 tab spaces here) 
```

在上面的示例中，第一条记录表示字段标题，每一行都是一条记录。我们可以观察到 Tom 缺少“部门”字段条目，而 Kelsey 缺少“GPA”字段条目。我的输出应该是这样的：

```
"Name","Age","Department","GPA"
"Kevin","21","Computer Science","3.4"
"Tom","20","n.a","3.8"
"Kelsey","22","Psychology","n.a" 
```

我的问题：
1) 我该如何解决这个问题？Python、java、bash、awk 任何脚本都可以
2) 观察“部门”字段下第二行中“计算机”和“科学”之间的空格被忽略并保留。所以生成的脚本不应该计算空格。

完美地做到这一点非常重要，因为我将为搜索索引提供数据。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T22:09:04.520

这可以在 python 中非常简单地完成，如下所示：

```
import sys
[infile, outfile] = sys.argv[1:]

with open(infile) as inf:
    with open(outfile) as outf:
        for l in inf:
            outf.write(','.join(l.split('\t')).replace(',,',',n.a.,')) 
```

该脚本将像

```
python convert_csv.py infile outfile 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T22:15:25.417

一种使用方式`awk`：

```
awk '
    ## Split line with tabs, join them in output with commas.
    BEGIN {
        FS = "\t";
        OFS = ",";
    }

    ## For each line, check if any field is blank, and substitute with
    ## "n.a". Add double quotes, recompute line and print.
    {
        for ( i = 1; i <= NF; i++ ) {
            if ( $i == "" ) {
                $i = "n.a";
            }
            $i = "\"" $i "\"";
        }
        $1 = $1;
        print $0;
    }
' infile 
```

使用以下输出运行它：

```
"Name","Age","Department","GPA"
"Kevin","21","Computer Science","3.4"
"Tom","20","n.a","3.8"
"Kelsey","22","Psychology","n.a" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T22:11:24.047

只需在每一行上使用 split('\t') ...

```
>>> x="a\t\tb"
>>> x
'a\t\tb'
>>> print x
a               b
>>> x.split("\t")
['a', '', 'b']
>>> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T22:12:55.217

在蟒蛇中，

```
inputFile = open.("yourFile.tsv", "r")
outputFile = open.("output.csv", "w")

for line in inputFile:
    entry = line.split("\t")
    for i in range(len(entry)):
        if entry[i] == '':
            entry[i] = "n.a"
    outputFile.write(",".join(entry))

inputFile.close()
outputFile.close() 
```

应该可以工作，尽管它不是特别 Pythonic。

# android - 试图通过意图发送 StringArrayList

> ID：11909871
> 
> 赞同：0
> 
> 时间：2012-08-10T22:04:31.360
> 
> 标签：android, android-intent, arraylist

无法将值传递到下一个活动

第一类

```
Intent i=new Intent(items.this,bill.class);
        i.putStringArrayListExtra("bill",sbill);     //here sbill=arraylist,
        System.out.println("exit intent.....");
        startActivity(i); 
```

类2

```
Bundle b=getIntent().getExtras();
    ArrayList<String> billArr=b.getStringArrayList("bill"); 
```

错误

> INFO/ActivityManager(64)：开始活动：Intent { cmp=com.items/.bill（有附加功能）}

在上述错误之后，它甚至没有从这里移动一步，也没有进入我的模拟器中的下一个活动。

# django - Django 用户保存钩子

> ID：11909877
> 
> 赞同：2
> 
> 时间：2012-08-10T22:05:02.293
> 
> 标签：django, django-admin

在 django 管理员中，当用户获得超级用户身份时，我希望执行检查。我想查看用户电子邮件是否来自 *.company.com 的形式

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T22:10:45.580

创建一个[信号](https://docs.djangoproject.com/en/dev/topics/signals/)：

```
from django.db.models.signals import post_save
from django.contrib.auth.models import User

def check_superuser(sender, instance, signal, *args, **kwargs):
    if sender is User and instance.is_superuser and not instance.email.endswith('@company.com'):
        ...

post_save.connect(check_superuser, sender=User) 
```

所以现在，每次`User`保存一个实例时，都会运行上面的`check_superuser`方法

# ios - 在索引处添加 NSMutableArray 的元素与其他 NSMutableArrays 的相应元素

> ID：11909882
> 
> 赞同：0
> 
> 时间：2012-08-10T22:05:20.720
> 
> 标签：ios, objective-c, arrays, xcode

如果我有 3 个 NSMutableArray，如何获得一个数组，其中每个索引处的元素是每个原始数组中同一索引处的元素之和？

例子：

```
MutableArrayOne  = [NSMutableArray arrayWithObjects:@"1",@"2",@"3",@"4",@"5", nil];

MutableArrayTwo  = [NSMutableArray arrayWithObjects:@"1",@"2",@"3",@"4",@"5", nil];

MutableArrayThree  = [NSMutableArray arrayWithObjects:@"1",@"2",@"3",@"4",@"5", nil]; 
```

我如何将它们加到一个数组中，例如：

```
MutableArrayThree  = [NSMutableArray arrayWithObjects:@"3",@"6",@"9",@"12",@"15", nil]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T22:17:12.487

假设所有数组的大小相同......

```
NSMutableArray *sums = [NSMutableArray arrayWithCapacity:MutableArrayOne.count];
for(NSInteger i = 0; i < MutableArrayOne.count; i++)
{
    NSInteger element1 = [[MutableArrayOne objectAtIndex:i] integerValue];
    NSInteger element2 = [[MutableArrayTwo objectAtIndex:i] integerValue];
    NSInteger element3 = [[MutableArrayThree objectAtIndex:i] integerValue];
    NSInteger sum = element1 + element2 + element3;
    [sums addObject:[NSString stringWithFormat:@"%lu", sum]];
} 
```

# javascript - 如何将getElementbyId变量分配给html代码

> ID：11909883
> 
> 赞同：1
> 
> 时间：2012-08-10T22:05:43.617
> 
> 标签：javascript, variables, getelementbyid

我有一个戴着帽子的人的形象。我在此图像上有帽子的«master.png»图像（单独），每次用户单击下面的不同颜色样本时，它将变为不同的图像（相同的帽子/不同的颜色）。

javascript 函数有效，但我无法将颜色变量值分配给我的色板。因此，无论您单击哪个色板，都只会出现列出的最后一个 js src 图像。我也不确定我的 javascript 变量代码是否正确。

我无法在网上找到有关如何执行此操作的任何内容。请帮忙！

这是代码：

```
<script type="text/javascript">
function hat(color)
{
var color = ['redhat', 'bluehat', 'blackhat'];
document.getElementById("master").src="images/redhat.png"; 
document.getElementById("master").src="images/bluehat.png"; 
document.getElementById("master").src="images/blackhat.png"; 
}
</script>

<img id="hat" src="images/manwearinghat.png" width="100%" class="center">

<img id="master" src="images/masterhat.png" width="100%" alt=" " name="master">

<img src="images/swatchs/redswatch.png" width="69" height="69" onclick="hat('redhat');" value="redhat" style="z-index:3">

<img src="images/swatchs/blueswatch.png" width="69" height="69" onclick="hat('bluehat');" value="bluehat" style="z-index:3">

<img src="images/swatchs/blackhat.png" width="69" height="69
" onclick="hat('blackhat');" style="z-index:3"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T22:09:05.697

你可以使用像这样简单的东西：

```
function hat(color) {
    document.getElementById("master").src = "images/" + color + ".png"; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T22:14:12.393

由于您已经传递了颜色的名称，因此您需要做的就是

```
 function hat(color) {
    document.getElementById("master").src = "images/" +color+".png";
} 
```

更改图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T01:52:10.277

这段代码不是很紧凑，但它会工作。HTML：

```
 <img id="hat" src="images/manwearinghat.png" width="100%" class="center">
    <div id="master"></div>
    <div>
        <img src="images/swatchs/redswatch.png" width="69" height="69" onclick="hat('redhat');"    
     value="redhat" style="z-index:3">

    <img src="images/swatchs/blueswatch.png" width="69" height="69" onclick="hat('bluehat');"
    value="bluehat" style="z-index:3">

    <img src="images/swatchs/blackhat.png" width="69" height="69
    " onclick="hat('blackhat');" style="z-index:3">
    </div> 
```

Javascript：

```
 function hat(color){
        if (color == 'bluehat'){
            document.getElementById('picture').innerHTML=<img id="master" 
    src="images/bluehat.png" width="100%" alt=" " name="master">
        if (color == 'blackhat'){
            document.getElementById('picture').innerHTML=<img id="master"
    src="images/blackhat.png" width="100%" alt=" " name="master">

        if (color == 'redhat'){
            document.getElementById('picture').innerHTML=<img id="master" src="images/redhat.png"
    width="100%" alt=" " name="master">
    }; 
```

# c# - 来自 C# 的压力测试 Cassandra 会消耗所有网络资源，并在 ~100K 插入后失败

> ID：11909897
> 
> 赞同：2
> 
> 时间：2012-08-10T22:08:01.610
> 
> 标签：c#, cassandra, fluentcassandra

我们目前正在评估 Windows Cassandra 部署，我已经设法编写了一个非常简单的压力测试。该测试尝试将包含各种数据的 100 万行插入到单个本地节点（到/从本地主机，无复制，集群上只有一个节点）。

该测试适用于前 100k 行（或者说，它并不总是阻塞在完全相同的行上）。可以正确地从数据库中读取插入的行，并且一切正常。然后测试似乎消耗了机器上所有可用的套接字/缓冲区/一些网络资源，并且测试无法连接到 Cassandra 并停止插入行。即使从浏览器刷新一个完全独立的网页也会有一段时间失败。

我首先指责了测试，但是杀死它并重新启动它不起作用。我需要等待大约一分钟才能有新的连接可用（超时？）。然后我可以恢复测试并继续抽取数据。我使用 Fluent Cassandra 和 Cassandra-Sharp 客户端编写了测试，结果相同。

是否需要在 Cassandra 或 C# 客户端中设置一些设置，例如最大并发连接数？

或者，是否有人有一个工作压力测试来源的链接，该测试从 C# 中插入了几百万行，所以我可以将它与我的测试进行比较并找出我的错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T03:03:23.593

我的猜测是您没有打开套接字连接。您可以通过将上下文包装在会话中来使连接在 FluentCassandra 中保持打开状态。如果您不这样做，则执行的每个请求都在一个新套接字上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:07:08.247

我直接使用了 Thrift API，而不是 Cassandra Sharp 或 Fluent Cassandra API。它表明此代码有效。

```
socket = new TSocket("127.0.0.1", 9160);
socket.Open();
client = new Cassandra.Client(new TBinaryProtocol(new TFramedTransport(socket)));
client.set_keyspace("Test");

foreach (Data data in myData) {
    Write(client, data);
}

socket.Close(); 
```

虽然以下代码最终重现了更高级别的 API 在“socket.Open()”上遇到的问题。

```
foreach (Data data in myData) {
    socket = new TSocket("127.0.0.1", 9160);
    socket.Open();
    client = new Cassandra.Client(new TBinaryProtocol(new TFramedTransport(socket)));
    client.set_keyspace("Test");

    Write(client, data);

    socket.Close();
} 
```

socket.Close() 方法不会释放套接字的所有资源，这可能是一个错误。

# ruby-on-rails - 动态生成表单以在 Rails 中编辑项目

> ID：11909903
> 
> 赞同：0
> 
> 时间：2012-08-10T22:08:24.293
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我有一个 Item 模型，带有一些属性，我在主页上显示为列表。

我希望能够将`<li>`' 的内容变成该 Item 的编辑表单，并在提交时，如果没有验证错误，恢复`<li>`' 的内容（使用更新的值）。

您可以假设 Item 只有一个名为 的字符串属性`title`，这足以让我适应更大的模型。

我应该如何处理这个？我猜我需要以某种方式在服务器端生成表单，并将它们带入`li`，因为将错误处理与它集成起来很容易，但我不确定如何优雅地做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:46:46.520

我认为“就地编辑”是您感兴趣的术语。有几个可用的宝石可以对此有所帮助。这个可以满足您的需求：[best_in_place](https://github.com/bernat/best_in_place)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T07:37:35.903

我插入了一个带有 display:none 的编辑表单，并让它在双击时出现。

# python - UnicodeDecodeError：“ascii”编解码器无法解码位置 304 中 0xc3 中的字节：序数不在范围内（128）

> ID：11909905
> 
> 赞同：4
> 
> 时间：2012-08-10T22:08:46.867
> 
> 标签：python, macos, syntax-error, python-unicode

我刚刚离开 PC 工作（使用 Python 2.7）并且有一个我刚刚完成的脚本（转载如下）。它在工作中运行良好，我只想添加一两件事。但我回到家，正在使用我的 Mac 版本的 Python（3.2.2），我收到以下错误：

```
Traceback (most recent call last):
  File "/Users/Downloads/sda/alias.py", line 25, in <module>
    for row_2 in in_csv:
  File "/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/encodings/ascii.py", line 26, in decode
    return codecs.ascii_decode(input, self.errors)[0]
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 304: ordinal not in range(128) 
```

我的代码在这里：

```
import csv
inname = "Fund_Aliases.csv"
outname = "output.csv"

def first_word(value):
    return value.split(" ", 1)[0]

with open(inname, "r") as infile:
    with open(outname, "w") as out file:
      in_csv = csv.reader(infile)
      out_csv = csv.writer(outfile)

     column_names = next(in_csv)
     out_csv.writerow(column_names)

      id_index = column_names.index("id")
      name_index = column_names.index("name")

      try:
          row_1 = next(in_csv)
          written_row = False

          for row_2 in in_csv:
            if first_word(row_1[name_index]) == first_word(row_2[name_index]) and row_1[id_index] != row_2[id_index]:
                if not written_row:
                    out_csv.writerow(row_1)

                out_csv.writerow(row_2)
                written_row = True
            else:
                written_row = False

            row_1 = row_2
      except StopIteration:
        # No data rows!
        pass 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T22:22:58.590

它看起来`Fund_Aliases.csv`不是一个 ascii 文件。

根据[Python3 文档](http://docs.python.org/py3k/library/csv.html#module-csv)：

> 由于 open() 用于打开 CSV 文件进行读取，因此默认情况下该文件将使用系统默认编码解码为 un​​icode（参见 locale.getpreferredencoding()）。要使用不同的编码解码文件，请使用 open 的 encoding 参数：

```
with open('some.csv', newline='', encoding='utf-8') as f:
    reader = csv.reader(f) 
```

所以尝试指定`encoding`参数。

# scheme - 加载文件时如何在 MIT-Scheme 中关闭解释器日志

> ID：11909913
> 
> 赞同：3
> 
> 时间：2012-08-10T22:09:12.000
> 
> 标签：scheme, mit-scheme

这是一个非常具体的问题，但我一直试图让它工作两天但没有成功。

我正在使用 MIT-Scheme（在 Ubuntu 10.04 上发布 7.7.90）来运行一些 Scheme 脚本。我的命令行如下所示

```
mit-scheme --band "myimage.com" --interactive --batch-mode < myscript.scm 
```

我的问题是，如果主脚本加载其他 Scheme 文件，解释器会通过打印以下内容来记录此内容：

```
;Loading "....scm"... done
;Loading "....scm"... 
;  Loading "....scm"... done
;  Loading "....scm"... 
;    Loading "....scm"... done
;  ... done
;... done
;Loading "....scm"... done 
```

这很烦人，因为我的脚本还记录了一些与上述输出混淆的进度信息。所以，我想完全抑制加载过程的输出。

我一直在浏览[在线文档](http://www.gnu.org/software/mit-scheme/documentation/mit-scheme-user/index.html)，但没有找到任何具体的内容。我发现的唯一解决方案是将脚本及其所有依赖项加载到解释器中，并使用磁盘保存保存图像。如果我然后使用 --band 选项加载该图像，所有不需要的输出都消失了。

但是我当然不想每次修改源文件时都加载源并保存图像。是否有更简单的解决方案，例如命令行选项、环境变量或可以从 Scheme 代码中设置的某些选项？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T20:40:24.673

这有点晚了，但对于以后遇到这个问题的人来说：

您可以使用`load/suppress-loading-message?`

例如，执行 a`(set! load/suppress-loading-message? #t)`将关闭加载消息。

在您的情况下，您应该尝试`--eval "(set! load/suppress-loading-message? #t)"`

# iphone - 选择 UIButton 时写入 plist

> ID：11909919
> 
> 赞同：0
> 
> 时间：2012-08-10T22:09:38.910
> 
> 标签：iphone, objective-c, xcode, plist, property-list

我正在编写此代码来为我的 DetailViewController 中的 UIButton 设置默认状态，这取决于带有字典的 plist 数组中的字符串值。这工作正常（在 viewDidLoad 中）。

然后我想在 favoriteButtonPressed 时写入 plist，但这不起作用。我认为代码中的某些内容是错误的。你能帮我改正吗？

DetailViewController.h

```
#import <UIKit/UIKit.h>

@interface DetailViewController : UIViewController

//The selectedObject property is recieved through segue from TableViewController
@property (nonatomic, strong) NSMutableArray *selectedObject;

@property (nonatomic, assign) BOOL favoriteButtonSelected;
@property (weak, nonatomic) IBOutlet UIButton *favoriteButton;

-(IBAction)favoriteButtonPressed:(id)sender;

@end 
```

细节视图控制器.m

```
#import "DetailViewController.h"

@interface DetailViewController ()

@end

@implementation DetailViewController

@synthesize selectedObject;

@synthesize favoriteButtonSelected;

@synthesize favoriteButton;

- (void)viewDidLoad
{
[super viewDidLoad];

if ([[selectedObject valueForKey:@"Favorite"] isEqual:@"Yes"])  {

    [favoriteButton setImage:[UIImage imageNamed:@"favoritedItem.png"] forState:UIControlStateSelected | UIControlStateHighlighted];
    [favoriteButton setSelected:YES];
    [favoriteButton setHighlighted:YES];
    favoriteButtonSelected = 1;

} else {

    [favoriteButton setImage:[UIImage imageNamed:@"notFavorite.png"] forState:UIControlStateNormal];
    [favoriteButton setSelected:NO];
    [favoriteButton setHighlighted:NO];
    favoriteButtonSelected = 0;
}
}

//Action to write to plist

-(IBAction)favoriteButtonPressed:(id)sender
{

NSString *path = [[NSBundle mainBundle]
                  pathForResource:@"Objects" ofType:@"plist"];

if (favoriteButtonSelected == 0) {

    [sender setSelected:YES];
    [sender setHighlighted:YES];

    favoriteButtonSelected = 1;
    [sender setImage:[UIImage imageNamed:@"favoritedItem.png"] forState:UIControlStateSelected | UIControlStateHighlighted];
    [selectedObject setValue:@"Yes" forKey:@"Favorite"];
    [selectedObject writeToFile:path atomically:YES];

} else {

    [sender setSelected:NO];
    [sender setHighlighted:NO];

    favoriteButtonSelected = 0;
    [sender setImage:[UIImage imageNamed:@"notFavorite.png"] forState:UIControlStateNormal];
    [selectedObject setValue:@"No" forKey:@"Favorite"];
    [selectedObject writeToFile:path atomically:YES];
}
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T23:27:06.513

你没有说你遇到了什么问题。我认为这与您尝试写入应用程序包目录有关。在[文件系统编程指南](http://developer.apple.com/library/ios/ipad/#DOCUMENTATION/FileManagement/Conceptual/FileSystemProgrammingGUide/FileSystemOverview/FileSystemOverview.html)中不鼓励这样做。您应该阅读它的“文件系统基础”和“访问文件和目录”章节。

一般要点是您应该在第一次启动时将“Objects.plist”复制到“Library”文件夹，然后从那里读取和写入。

# php - 将常量添加到数据库中的值并使用 PDO 更新

> ID：11909928
> 
> 赞同：0
> 
> 时间：2012-08-10T22:10:38.107
> 
> 标签：php, pdo

这是场景：我需要一种机制来更新一个值（将当前值加 1），该值存储在数据库中，供登录网站的某个用户使用。这是当前代码：

```
$value = $row["value"];
$add_value = $db->prepare('UPDATE table SET value = $value + 1 WHERE email = :email');
$add_value->execute(array(':email'   => $email)); 
```

但我收到以下错误消息： **解析错误：语法错误，意外的 T_LNUMBER in ...**

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:13:51.277

首先，您使用的是单引号，这意味着不会解析变量。（查询实际上是看到`$value`而不是实际值）。

其次，您不需要事先知道值，以下工作正常：

```
$add_value = $db->prepare('UPDATE `table` SET `value` = `value` + 1 WHERE `email` = :email');
$add_value->execute(array(':email'   => $email)); 
```

数据库引擎知道适当地更新该字段。

# javascript - 如何将函数传递给 JavaScript Web Worker

> ID：11909934
> 
> 赞同：31
> 
> 时间：2012-08-10T22:11:13.840
> 
> 标签：javascript, web-worker

我想通过 a 将一个（或多个函数）传递`postMessage()`给网络工作者，因为我无法引用常规文件。

为了启动 Web Worker，我将一个对象 URL（从 Blob 创建）传递给`Worker`构造函数。然后我传递了一条消息，但到目前为止还没有在消息中添加一个函数。

(JSON) 消息不能直接包含函数（如此[处](https://developer.mozilla.org/en-US/docs/DOM/Using_web_workers?redirectlocale=en-US&redirectslug=Using_web_workers#Passing_JSON_data)规定），虽然 importScripts 理论上是允许的，但到目前为止我在 Chrome 或 Firefox 中使用它还没有成功。

html文件的正文：

```
<div id="divText">1234</div>
<script>
    var greeter = function greet(name) {
        return "hello " + name;
    };
    function webWorkerWorker() {
        self.postMessage("started1");
        self.onmessage = function(event) {
            importScripts(event.data.content);
            self.postMessage("importScripts success");
            var result = greeter("john");
            self.postMessage(result);
        };
    }
    var functionBody = mylib.extractFunctionBody(webWorkerWorker);
    var functionBlob = mylib.createBlob([functionBody]);
    var functionUrl = mylib.createObjectURL(functionBlob);

    var functionBody2 = mylib.extractFunctionBody(greeter);
    var functionBlob2 = mylib.createBlob([greeter]);
    var functionUrl2 = mylib.createObjectURL(functionBlob2);

    var worker = new Worker(functionUrl);
    worker.onmessage = function(event) {
        document.getElementById("divText").innerHTML = event.data;
    }
    worker.postMessage({
                type: "init",
                content: functionUrl2
            });
</script> 
```

目前它导致将 divText 值设置为“importScripts 成功”。

难道我做错了什么？还有另一种方法可以将函数传递给网络工作者吗？还是不可能？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-13T15:54:25.390

事实证明这种方法工作正常，我的工人只有一个错误：

```
var result = greeter("john"); 
```

应该

```
var result = greet("john"); 
```

这是有道理的——我将 greeter 变量传递给工作人员，但它没有理由知道我正在传递的对象的变量名。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-07-30T07:01:27.783

对于那些正在寻找更通用答案的人：这是一个插件，它允许您在线程中执行 javascript 代码的任何功能。

[http://www.eslinstructor.net/vkthread/](http://www.eslinstructor.net/vkthread/)

将其视为“功能外包”。您将任何函数作为参数传递给插件并在回调中获得结果。您还可以“外包”对象的方法、具有依赖关系的函数、匿名函数和 lambda。

享受。

——瓦迪姆

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-12-14T01:37:27.097

是的，当然可以，我实现了

**这是一个将执行通用工作者的承诺**

```
/*
    @data.context, The context where the callback functions arguments are, ex: window
    @data.callback, ["fn_name1", "fn_name2", function (fn1, fn2) {}]
        The callback will be executed, and you can pass other functions to that cb
    @worker_url string url of generic web worker
*/
function genericWorker(worker_url, data) {
    return new Promise(function (resolve, reject) {

        if (!data.callback || !Array.isArray(data.callback))
            return reject("Invalid data")

        var callback = data.callback.pop()
        var functions = data.callback
        var context = data.context

        if (!worker_url)
            return reject("Worker_url is undefined")

        if (!callback)
            return reject("A callback was expected")

        if (functions.length>0 && !context)
            return reject("context is undefined")

        callback = fn_string(callback) //Callback to be executed
        functions = functions.map((fn_name)=> { return fn_string( context[fn_name] ) })

        var worker = new Worker(worker_url)

        worker.postMessage({ callback: callback, functions: functions })

        worker.addEventListener('error', function(error){
            return reject(error.message)
        })

        worker.addEventListener('message', function(e) {
            resolve(e.data)
            worker.terminate()

        }, false)

        //From function to string, with its name, arguments and its body
        function fn_string (fn) {
            var name = fn.name
            fn = fn.toString()

            return {
                name: name,
                args: fn.substring(fn.indexOf("(") + 1, fn.indexOf(")")),
                body: fn.substring(fn.indexOf("{") + 1, fn.lastIndexOf("}"))
            }
        }

    })
} 
```

**通用工作文件 worker_for_anything.js**

```
self.addEventListener('message', function(e) {    
    var worker_functions = {} //Functions used by callback
    var args = [] //Arguments of the callback

    for (fn of e.data.functions) {
        worker_functions[fn.name] = new Function(fn.args, fn.body)
        args.push(fn.name)
    }

    var callback = new Function( e.data.callback.args, e.data.callback.body) //Callback passed and ready to be executed    
    args = args.map((fn_name) => { return worker_functions[fn_name] }) //FUnctions loaded as arguments
    var result = callback.apply(null, args) //executing callback with function arguments
    self.postMessage( result )

}, false) 
```

**使用它 ：）**

```
var data = {
    context: window, //the context of the functions passed, ex: window for blockCpu
    callback: ["blockCpu", function (bla) {
        bla(7000) //blocking for 7000 ms
        return "bla" //This return is catched in the promise
    }]
}

genericWorker("/worker_for_anything.js", data)
    .then(function (result){
        console.log("result", result)

    }).catch((error)=> { console.log(error) })

//random blocking function
function blockCpu(ms) {
    var now = new Date().getTime();
    var result = 0
    while(true) {
        result += Math.random() * Math.random();
        if (new Date().getTime() > now +ms)
            return;
    }   
} 
```

# css - 右侧的 css 文本缩进等效项

> ID：11909947
> 
> 赞同：22
> 
> 时间：2012-08-10T22:12:39.670
> 
> 标签：css

我有右侧对齐的文本，我希望它向左推一点，就像你在右侧使用文本缩进 bur 所做的那样。有什么解决办法吗？我一直在尝试使用边距，但 IE9 将第一个菜单项 (?) 的边距加倍。

继承人的CSS：

```
h99
{ padding: 0px;
    font-family: lucida, sans-serif;
    font-size: 16px;
    font-weight: bold;
    line-height: 40px;
}

#menublock
{ width: 230px;
    height: auto;
    float: left;
    text-align:right;
    margin-right: 0px;
}

ul
{ list-style-type: none;
  margin:0;
  padding:0;
  overflow: hidden;
}

ul a:link, ul a:visited
{ display: block;
  width: 210px;
  background: transparent;
  text-align: right;
  text-transform: uppercase;
  text-decoration: none;
    height: 40px;
    color: #ffffff;
    padding: 0px;
    margin: 10px;
}

ul a:hover, .selected
{ background: #484848 !important;
  color: #ffffff !important;
} 
```

菜单是一个简单的水平菜单。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-10T22:49:18.357

没有，不幸的是css中没有文本缩进，但是，你可以`direction:rtl;`对一些短文本使用文本方向，这样缩进就会出现在另一边。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-11-15T23:58:37.173

简单的解决方案是将“之前” CSS 样式应用于您的文本元素，从而消除所有副作用`direction: rtl;`

```
&:before {
      content: ' ';
      width: 100px;
      float: right;
      height: 5px;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-04-22T18:27:59.807

请执行下列操作

```
text-indent: 60px;
direction: rtl;
text-align: left; 
```

**f.ardelian**指出：标点符号会出现在所以 abc 的行首。会出现.abc

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-09-02T19:39:17.980

我所做和为我工作的是：

```
text-indent: 20px;
padding-right: 40px; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-05-04T12:57:53.567

CSS 唯一的解决方案，不会弄乱文本方向（SEO 和翻译友好？），没有浮动，没有额外的元素，后缩进的宽度很容易修改：

```
&::after {
    content: "\0000a0";
    height: 1em;
    letter-spacing: 1rem;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-10T22:46:24.810

我需要查看您的代码，但是解决旧浏览器问题的方法是包含一个空跨度并应用一个宽度：

```
<style>
span.right-adjust {
  display:inline-block;
  width:5px;
}
</style>

<div>Your text here<span class="right-adjust"></span></div> 
```

如果不向我们提供代码，很难说出您想要什么。您也可以应用 float:right;

有很多方法可以解决旧浏览器和 CSS 的问题。

希望这可以帮助

# cuda - 为什么“符号”是某些 CUDA 函数名称的一部分？

> ID：11909951
> 
> 赞同：1
> 
> 时间：2012-08-10T22:13:26.160
> 
> 标签：cuda, gpu

几个 CUDA 函数名称中包含 Symbol 一词。

```
e.g. cudaMemcpyToSymbol() , cudaMemcpyFromSymbol(), cudaGetSymbolAddress() etc. 
```

编程指南中对这些函数的作用的解释非常清楚。我没有得到的是在命名这些函数时选择“符号”这个词。这是什么意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T23:38:31.210

他们使用“符号”一词，因为这些函数可以将设备变量的名称**作为字符串**。例如：

```
cudaMemcpyToSymbol("my_var_d", my_var_h, sizeof(my_var_d)); 
```

据推测，这种奇怪的语法允许一些我还没有想到的用例:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T23:16:02.230

这个“符号”是一个设备变量。

# asp.net - 几秒钟后 ASP.Net 应用程序丢失凭据

> ID：11909957
> 
> 赞同：0
> 
> 时间：2012-08-10T22:13:52.750
> 
> 标签：asp.net, dns

我有一个 asp.net 应用程序，它似乎在一个环境（DEV ......当然）中丢失了它的凭据，但在另一个环境（INT）中没有。登录后，随机点击几秒钟，我最终被重定向回登录页面。

我不是网络管理员，所以如果我说错了，请原谅我。简而言之，有两种环境：DEV 和 INT。每个都有一个指向底层服务器的 DNS A 记录。在 DEV 中，应用程序指向的 URL 类似于 devEnv.organization.com。这指向名为 dev01 的服务器。在 INT 中，应用程序指向的 URL 类似于 intEnv.organization.com。这指向两个服务器：int01 和 int02。现在，网络管理员做了一些事情，将 int02 排除在外，因此 intEnv.organization.com 记录仅指向 01。
上述问题在此环境中表现出来。如果我们将应用程序直接指向 int01 服务器，应用程序就可以正常工作。

同样，在 DEV 中，无论我们指向 devEnv.organization.com URL 还是 dev01 服务器，应用程序都能（自然地）完美运行。是否有人对可能导致此问题的原因或解决此问题的方法有任何想法？客户端正在使用 IIS7。每个 web.config 都是相同的（除了指向相应数据库服务器的数据库连接字符串。）

请帮忙！

谢谢，

史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:39:19.407

我会用像 Fiddler 这样的 http 调试器来嗅探流量。最终，您将被注销。然后你回到 Fiddler 并检查最后一个请求。您搜索的是清除身份验证 cookie 的标头。或任何其他迫使您的浏览器停止将 cookie 附加到连续请求的原因。

编辑：

运行提琴手。您将看到一个请求列表。在右侧，您可以看到每个请求的详细信息。请求在顶部，响应在底部。切换到原始视图。如果响应（前几行），您搜索的是标题部分中的 Set-Cookie 行。第一个请求将设置表单身份验证 cookie - 分配名称和值。您只需要在其他 cookie 中找到表单 cookie。几个请求之后，您可能会看到再次设置 cookie，但这次的日期指向过去。这会清除 cookie 并退出。

您必须找出它发生的原因，即是什么导致特定页面清除 cookie。

如果您首先想学习 Fiddler，请在 Google 上搜索“Fiddler 教程”，这里有很多。

# objective-c - 使用 NSKeyedUnarchiver 解码时的 EXC_BAD_ACCESS

> ID：11909959
> 
> 赞同：0
> 
> 时间：2012-08-10T22:14:08.070
> 
> 标签：objective-c, macos

我在 decodeObjectForKey: 调用上得到一个 EXC_BAD_ACCESS。如果有人能在这里发现一个明显的错误，我将不胜感激：

```
- (NSData *)serialize:(id <NSCoding>)object {
  NSMutableData *data = [[NSMutableData alloc] init];
  NSKeyedArchiver *archiver = [[NSKeyedArchiver alloc] initForWritingWithMutableData:data];
  [archiver setOutputFormat:NSPropertyListBinaryFormat_v1_0];
  [archiver encodeObject:object forKey:@"myobject"];
  [archiver finishEncoding];
  return data;
}

- (id)deserialize:(NSData *)data {
  NSKeyedUnarchiver *unarchiver = [[NSKeyedUnarchiver alloc] initForReadingWithData:data];
  unarchiver.delegate = self;
  id object = [unarchiver decodeObjectForKey:@"myobject"];
  [unarchiver finishDecoding];
  return object;
} 
```

NSCoding 协议是这样实现的：

```
- (id)initWithCoder:(NSCoder *)aDecoder {
  self = [super init];
  if (self != nil) {
    _fields = [aDecoder decodeObjectForKey:@"fields"];
    _entries = [aDecoder decodeObjectForKey:@"entries"];
  }
  return self;
}

- (void)encodeWithCoder:(NSCoder *)aCoder {
  [aCoder encodeObject:_fields forKey:@"fields"];
  [aCoder encodeObject:_entries forKey:@"entries"];
} 
```

我不能使用 +unarchiveObjectWithData: 因为我需要设置一个委托来更新反序列化对象：

```
- (id)unarchiver:(NSKeyedUnarchiver *)unarchiver didDecodeObject:(id)object {
  if([[object class] isSubclassOfClass:[LCEntity class]]) {
    [object setStore:_store];
  }
  return nil;
} 
```

我正在使用 ARC - 所以不用担心内存管理问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:20:04.590

你真的可以那样使用存档器/取消存档器吗？通常，您有一个已编码的根对象，它对图形的其余部分进行编码。尝试使用以下内容：

```
- (NSData *)serialize:(id <NSCoding>)object {
    return [NSKeyedArchiver archivedDataWithRootObject:object];
}

- (id)deserialize:(NSData *)data {
    return [NSKeyedUnarchiver unarchiveObjectWithData:data];
} 
```

当然，此时 -serialize: 和 -deserialize: 方法是相当多余的。他们的调用者应该直接调用 NSKeyedArchiver/NSKeyedUnarchiver。

* * *

或者，您的编码对象或其子对象之一可能对`-initWithCoder:`. 这在堆栈跟踪中应该很明显。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T00:33:42.287

我可以通过始终在我的 NSKeyedUnarchiverDelegate 中返回对象来解决问题：

```
- (id)unarchiver:(NSKeyedUnarchiver *)unarchiver didDecodeObject:(id)object {
  if([[object class] isSubclassOfClass:[LCEntity class]]) {
    [object setStore:_store];
  }
  return object;
} 
```

有点奇怪，因为Apple的文档声明如果您不想替换该对象，则应该返回 nil ...

# php - 使用 curl 获取 json 响应的值和键

> ID：11909964
> 
> 赞同：0
> 
> 时间：2012-08-10T22:14:57.267
> 
> 标签：php, json

我正在使用 curl 从服务返回 json 数据。var 转储工作正常，但是当我尝试访问键值对时，我什么也没得到？其中一个关键是状态，这是我试图在我的 if 语句中检索的内容。

```
//set the url, number of POST vars, POST data
curl_setopt($ch,CURLOPT_HTTPHEADER,array('Content-Type: application/x-www-form-urlencoded'));
curl_setopt($ch, CURLOPT_USERAGENT, '$AgentString');
curl_setopt($ch,CURLOPT_URL,$url);
curl_setopt($ch,CURLOPT_POST,count($fields));
curl_setopt($ch,CURLOPT_POSTFIELDS,$fields_string);
curl_setopt($ch,CURLOPT_HTTPHEADER,array (
    "Accept: application/json"
));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

//execute post
$result = curl_exec($ch);

//close connection
curl_close($ch);

$json = json_decode(utf8_encode($result), true);

var_dump($json["return"]);

if (isset($json->status)) {
   // do something
   print("yes");
} else {
print("No");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:18:31.290

由于 in 的第二个参数`json_decode`为 true，因此结果将作为关联数组返回。

```
$json->status 
```

应该

```
$json["status"] 
```

# c++ - 非默认构造的 boost::proto 终端

> ID：11909966
> 
> 赞同：1
> 
> 时间：2012-08-10T22:15:20.973
> 
> 标签：c++, boost, boost-proto

我正在尝试使用 boost::proto 定义一个非常有限的解析器组合库，并且想知道是否可以通过任何方式定义一个非默认构造的 proto 终端。

我有这样的结构：

```
struct symbol
{
   symbol(const string &str): str_(str) {}
   bool operator()(const string &str) const {
      return (str == str_);
   }

   string str_;
}; 
```

我想在 proto 表达式中用作 boost proto 终端。我能够在 的帮助下让它工作`BOOST_PROTO_DEFINE_OPERATORS`，但我发现经常必须将它包装在`proto::lit()`内部 proto 表达式中有点不方便：

```
match(symbol("abc") >> (proto::lit(symbol("xyz")) | symbol("klm"))) 
```

我想知道我是否可以像这样创建一个原型终端：

```
proto::terminal<symbol>::type sym; 
```

这将能够以某种方式获取一个字符串参数并将其传递给符号的构造函数。

**注意：**我知道 Spirit，但我的编译器不太支持它！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T22:21:23.860

您可以将名称`sym`设为返回终端的函数：

```
proto::terminal<symbol>::type sym(std::string const& s)
{ return { symbol(s) }; } 
```

很像`lit`一个函数模板，它把它的参数变成一个终端。

# scala - scala方法中的单个默认参数

> ID：11909970
> 
> 赞同：3
> 
> 时间：2012-08-10T22:15:44.917
> 
> 标签：scala

如果我用一个带有默认值的参数定义一个方法，我可以在不传递任何参数的情况下调用它吗？

```
scala> def printArgs(str:String = "default"){println(str)}
printArgs: (str: String)Unit

scala> printArgs
<console>:11: error: missing arguments for method printArgs in object $iw;
follow this method with '_' if you want to treat it as a partially applied function
              printArgs
              ^ 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-10T22:20:03.623

你可以在没有任何参数的情况下调用它，但你不能在没有任何参数块的情况下调用它——你至少需要一个空的参数列表：

```
scala> printArgs()
default 
```

# java - Jibx Maven 插件：模式之间的交叉引用，当它们在不同的构建执行中转换时

> ID：11909972
> 
> 赞同：0
> 
> 时间：2012-08-10T22:16:00.720
> 
> 标签：java, maven, jibx

我使用 jibx Maven 插件将一些 xsds 转换为 Java 源代码。在模式 A 中，有对模式 B 中定义的类型的引用。之前，我使用了这个 pom.xml 配置，一切正常：

```
<plugin>
    <groupId>org.jibx</groupId>
    <artifactId>jibx-maven-plugin</artifactId>
    <version>1.2.3</version>
    <configuration>
        <schemaLocation>${basedir}/resources/oxm/schemas</schemaLocation>
        <schemaBindingDirectory>${basedir}/src/java</schemaBindingDirectory>
        <includeSchemas>
            <includeSchema>schemaA.xsd</includeSchema>
            <includeSchema>schemaB.xsd</includeSchema>
            <includeSchema>schemaC.xsd</includeSchema>
        </includeSchemas>
        <verbose>true</verbose>
     </configuration>
 </plugin> 
```

输入模式 A 类似于：

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="myApp.com/schema/schemaA"targetNamespace="http://myApp.com/schema/schemaA" xmlns:rsType="http://myApp.com/schema/schemaB">
<xs:import schemaLocation="schemaB.xsd" namespace="http://myApp.com/schema/schemaB" />
<xs:complexType name="classAType">
    <xs:sequence>
        <xs:element name="objB" type="rsType:classBType" />
    </xs:sequence>
    <xs:attribute name="foo" type="xs:int" />
 </xs:complexType> 
```

输入模式 B 具有与 classBType 定义类似的代码。

以前的 Java 源代码输出类似于：

```
class classA
{
    classB objB;
    int foo;
} 
```

最近，我在 pom.xml 中分离了不同构建执行中模式的转换，以便能够为它们定义不同的目标包。我的新 pom.xml 是：

```
<plugin>
    <groupId>org.jibx</groupId>
    <artifactId>jibx-maven-plugin</artifactId>
    <version>1.2.3</version>
    <configuration>
        <schemaLocation>${basedir}/resources/oxm/schemas</schemaLocation>
        <schemaBindingDirectory>${basedir}/src/java</schemaBindingDirectory>
        <verbose>true</verbose>
     </configuration>
     <executions>
         <execution>
             <id>schemaCodegenA</id>
             <goals>
                 <goal>schema-codegen</goal>
             </goals>
             <configuration>
                 <includeSchemas>
                     <includeSchema>schemaA.xsd</includeSchema>
                  </includeSchemas>
                  <options>
                      <package>com.myApp.jibxgenerated.schema.resource</package>
                  </options>
              </configuration>
          </execution> 
```

（...每组模式执行一次）

Java 源输出现在是：

```
class classA
{
    // all properties of class B here
    int classBattrib1;
    int classBattrib2;
    int classBattribN;
    int foo;
} 
```

这是预期的行为吗？我想在 A 类源代码中返回 classB 引用，有什么方法可以实现吗？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T20:20:28.983

用户1550682,

实际上 JiBX 很容易处理这种情况。您可以将每个模式打包在单独的 jar 中，并使用 maven 插件轻松引用子模块。

在此处查看模块化架构的说明：http: [//jibx.sourceforge.net/maven-jibx-plugin/modular-codegen.html](http://jibx.sourceforge.net/maven-jibx-plugin/modular-codegen.html)

并在此处查看 github 中的示例代码： [https ://github.com/jibx/maven-plugin/tree/master/test-suite/base-binding-test](https://github.com/jibx/maven-plugin/tree/master/test-suite/base-binding-test)

此示例使用三个简单的模式：公司 -> 地址 -> 个人。并有一个简单的测试来编组和解组一些 xml。

我希望这有帮助！

大学教师

# python - 在 Python 模板中显示带有超链接的列表

> ID：11909977
> 
> 赞同：0
> 
> 时间：2012-08-10T22:16:52.643
> 
> 标签：python, markup, jinja2

我有一个用户列表。我想在模板中显示它：

```
{%- for user in listed_of_users -%}
        <P>{{ user.name  }}</P>
        {%- endfor -%} 
```

我想使用预定义的函数“create_link”为每个用户创建指向用户个人资料的超链接。此函数将返回每个对象的超链接。所以我写了一个如下的函数：

```
def users_list(users):
    return jinja2.Markup('# '.join(map(create_link, users)) ) 
```

它将返回如下列表：

```
User1# User2# User3# User4#... 
```

我在每个用户名下都有超链接。

我使用以下语法在模板中将其显示为字符串：

```
{{ users_list(listed_of_users)}} 
```

但是，我想像上面的格式一样显示每个用户。我试过了：

```
{%- for user in users_list(listed_of_users) -%}
        <P>{{ user  }}</P>
        {%- endfor -%} 
```

但是，它不起作用。有人可以帮我纠正吗？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T04:35:39.083

一方面，在您的示例中，`'# '.join(map(create_link, users))`创建了一个长字符串，因此您无法按照您尝试的方式对其进行迭代。您可以编写 lambda 表达式并执行双重映射或其他操作，但为什么不省去麻烦并`create_link`在模板中使用该函数，所以如果`create_link`为超链接返回有效的 HTML，您可以缩短您写入的内容：

```
{%- for user in listed_of_users -%}
   <p> {{ user | create_link | safe }} </p>
{%- endfor -%} 
```

要进行设置，您需要将 create_link 注册为名为`create_link`. 由于该`create_link`函数只接受一个值，因此您实际上只需要添加一行代码：

```
environment.filters["create_link"] = create_link 
```

（您用来渲染模板的环境在哪里）`environment`。`jinja2`作为奖励，这意味着您还可以在任何地方使用过滤器。[您可以在有关编写自定义过滤器](http://jinja.pocoo.org/docs/api/#writing-filters)的 jinja2 文档中找到更多信息。

# php - IIS 上包含错误的文件

> ID：11909981
> 
> 赞同：0
> 
> 时间：2012-08-10T22:17:13.890
> 
> 标签：php, iis, path

我有以下目录文件结构；

```
/index.php
/head.inc    (upper)
/subdir/page.php
/subdir/head.inc   (lower) 
```

在 /subdir/page.php 我有一个重定向到上层 index.php

```
header("location: ../index.php"); 
```

在 index.php 文件中有 include('head.inc') 指令。

在 Apache 服务器上加载了正确的 head.inc（上）——head.inc 来自 index.php 所在的同一（webroot）目录。在 IIS 上，加载了不正确的 head.inc（下部） - 来自 page.php 所在的 /subdir/ 的 head.inc 进行了重定向！这是国际空间站的错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T23:21:00.327

尝试生成自己的完整路径。这方面的例子可能是：

```
// Get the parent directory
$parent_directory = basename(dirname(dirname(__FILE__)));

header("Location: $parent_directory/index.php"); 
```

# ruby - 通过 erb 模板输出 ruby 数组

> ID：11909983
> 
> 赞同：5
> 
> 时间：2012-08-10T22:17:30.880
> 
> 标签：ruby, templates, erb, puppet

我正在使用 puppet 为 ruby​​ 程序提供一组常量。我需要提供一组主机名，我的程序将在这些主机名上进行迭代。

在我之前使用的 bash 脚本中，我只是将其作为 puppet 变量

```
hosts => "host1,host2" 
```

我将其提供给 bash 脚本

```
HOSTS=<%= hosts %> 
```

显然这对 ruby​​ 不太适用——我需要它的格式

```
hosts = ["host1","host2"] 
```

自从

```
p hosts 
```

和

```
puts my_array.inspect 
```

提供输出

```
["host1","host2"] 
```

我希望使用其中之一。不幸的是，我终其一生都无法弄清楚如何做到这一点。我已经尝试了以下各项：

```
<% p hosts %>
<% puts hosts.inspect %> 
```

我发现他们指出我需要将“function_”放在函数调用前面的地方......这似乎不起作用。我已经确定了一个迭代模型：

```
[<% hosts.each do |host| -%>"<%=host%>",<% end -%>] 
```

这行得通，给我

```
["host1","host2",] 
```

但尾随的逗号感觉很草率。整个事情感觉马虎。有没有人有更好的方法？还是我所做的最好的选择？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T11:10:11.050

我已经通过这种方式解决了（Puppet v3.0.1）：

```
{
    "your_key1": {
        "your_key2": [<% puppet_var.join('", "').each do |val| %>"<%= val %>"<% end -%>]
    }
} 
```

如果 $puppet_var 是一个类似 [ "a", "b" ] 的数组，输出应该类似于：

```
{
    "your_key1": {
        "your_key2": ["a", "b"]
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T11:16:16.133

Ruby 允许使用括号之间的 %w 快捷方式来初始化数组。这将做：

```
hosts = %w{<%= hosts.join(' ') %>} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T22:22:22.653

使用`to_json`；

```
hosts.to_json
=> "[\"host1\",\"host2\"]" 
```

# odata - 在哪里可以找到 SolrNet IQueryable 提供程序？

> ID：11909984
> 
> 赞同：0
> 
> 时间：2012-08-10T22:17:42.913
> 
> 标签：odata, iqueryable, solrnet

我正在使用 WebApi 并希望为我的 SolrNet 资源之一实现 OData。

如果您返回一个 IQueryable，WebApi 支持 OData。所以我需要一个用于 SolrNet 查询的 IQueryable 提供程序。

有谁知道我如何开始的任何或一些示例代码？如果没有可用的，我的公司可能会启动一个开源项目来创建它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-05-08T20:56:19.017

我知道，这个问题已经很老了，但以防有人在 5 年后需要它 - 这是我对 Linq to Solr IQueriable 的实现

**Git Hub 项目**

> [https://github.com/DanielLavrushin/LinqToSolr/](https://github.com/DanielLavrushin/LinqToSolr/)

**Nuget 包**

> [https://www.nuget.org/packages/LinqToSolr/](https://www.nuget.org/packages/LinqToSolr/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T07:00:40.010

一般来说，IQueryable 与某种 LINQ 提供程序相关联。我不确定社区与 LINQ-to-Solr 提供商的关系。我不知道今天有什么可行的方法，但是搜索结果中出现了一些项目，您应该在投入时间创建 LINQ 提供程序之前查看这些项目。

也就是说，您 - 可以 - 简单地获取事物列表并调用 .AsQueryable() 扩展方法。尽管以这种方式获取 IQueryable 在技术上很容易，但我假设您可能正在寻找要转换为 Solr 查询的 OData 查询，在这种情况下，前一段是您想要追求的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-03T18:06:24.947

您可以使用[https://www.nuget.org/packages/SolrNet.Linq](https://www.nuget.org/packages/SolrNet.Linq) nuget 包。它扩展了 SolrNet 功能并与构建 LINQ 表达式的 OData 方式兼容，但支持的方法数量有限。

代码示例将是：

```
var solr = ServiceLocator.Current.GetInstance<ISolrOperations<Product>>();
IQueryable<Product> solrLinq = solr.AsQuerable()
Product[] result = solrLinq.Where(p => p.Price > 12).ToArray(); 
```

# objective-c - 为什么在一个方法中更改了值的这个属性会在另一种方法中重置？

> ID：11909986
> 
> 赞同：0
> 
> 时间：2012-08-10T22:18:09.863
> 
> 标签：objective-c, xcode

`int indx;`我在头文件中声明了该属性。然后在实现文件中我有这两种方法：

```
-(IBAction)nextHaiku
{
{
    if (!self.indx)
    {
        self.indx=0;
    }
    NSString *cat = self.selectedCategory;
    //For now (adjust later so that, according to UISegmentedControl, it will also show only the user's haiku or all haiku):
    cat = @"Derfner";
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"category == %@", cat];
    NSArray *filteredArray = [self.gayHaiku filteredArrayUsingPredicate:predicate];
    int array_tot = [filteredArray count];
    int sortingHat;
    if (array_tot > 0)
        if (self.indx == self.theseAreDone.count)
        {
            while (true)
            {
                sortingHat = (arc4random() % array_tot);
                if (![theseAreDone containsObject:[filteredArray objectAtIndex:sortingHat]]) break;
            }
            self.haiku_text.text = [[filteredArray objectAtIndex:sortingHat] valueForKey:@"quote"];
            if (!self.theseAreDone || self.theseAreDone.count==array_tot)
            {
                self.theseAreDone = [[NSMutableArray alloc] init];
            }
            [theseAreDone addObject:[filteredArray objectAtIndex:sortingHat]];
            self.indx = self.theseAreDone.count;
        }
        else 
        {
            self.haiku_text.text = [[self.theseAreDone objectAtIndex:indx] valueForKey:@"quote"];
            self.indx += self.indx;
        }
}
} 
```

和

```
-(IBAction)previousHaiku
{
self.haiku_text.text = [[self.theseAreDone objectAtIndex:self.indx-1] valueForKey:@"quote"];
self.indx -= self.indx;
} 
```

`NSLog`表明每次调用`self.indx`递增 1 。`newHaiku`而且`NSLog`还说明`self.indx`从`previousHaiku`0开始，不管它是什么最后一次`newHaiku`被调用。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:27:10.917

我缺少的是我是个白痴的事实。我正在使用`self.indx -= self.indx`而不是`self.indx -=1`. 不要问我为什么。我不能告诉你。

# ios - 如何检索证书的到期日期？

> ID：11909987
> 
> 赞同：3
> 
> 时间：2012-08-10T22:18:21.923
> 
> 标签：ios, macos, security

我正在尝试编写一个脚本来监视我正在运行的构建服务器的签名凭据电池。我几乎可以肯定我可以使用 security(1) 在 bash 脚本中完成此操作，但我找不到任何关于如何在给定钥匙串中查找已安装身份的过期信息的示例（一切看起来都是加密的）。

有没有人做过类似的事情可以帮助我得到这些日期？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-10T23:27:56.573

如果您使用`find-certificate`带有 security(1) 的命令行选项，您可以使用`-p`.

从那里，用于`openssl x509 -text`输出证书中的字段。[参考](https://stackoverflow.com/questions/11793528/read-common-name-from-pem-file)您应该能够使用选项和文本输出从那里获取您需要的数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T02:22:07.373

为什么不使用**openssl** (x509 --help)获取它

```
$ openssl x509 -noout -in cert.pem -enddate 
```

# sql-server - Sql Server 事务日志阅读器

> ID：11909990
> 
> 赞同：4
> 
> 时间：2012-08-10T22:18:36.027
> 
> 标签：sql-server, transaction-log

是否可以使用某种类型的流阅读器对象打开 sql server 事务日志文件？

我在 C# 中尝试了多种方法，但数据库似乎正在使用显式锁定打开 .ldf 文件，即使我只想读取文件，在数据库运行时也无法读取。

在数据库关闭时打开文件不是我想要的，我需要能够读取流中的事务日志。我有一个文件布局的粗略草图，但现在我什至无法附加。

有人知道任何配置选项或其他方法吗？

谢谢！-G

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-20T19:24:00.927

可以使用[ApexSQL Log API](http://www.apexsql.com/sql_tools_logapi.aspx)读取在线事务日志 (LDF) 和事务日志备份。您可以直接从 .NET 应用程序中读取 LDF 文件。另外，事务日志的读取过程中没有锁

免责声明：我在 ApexSQL 担任产品支持工程师

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T23:37:08.050

您可以使用[fn_dblog](https://www.google.com/webhp?complete=1&hl=en#hl=en&sugexp=les;&gs_nf=1&tok=9E-dhqnARU18WvNQKwUNbQ&cp=4&gs_id=j&xhr=t&q=fn_dblog&pf=p&complete=1&output=search&sclient=psy-ab&oq=fn_d&gs_l=&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&fp=ba2d63190956a087&biw=1280&bih=849)函数在最低级别详细阅读日志内容。它要求 SQL Server 在线并且数据库在线。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-29T18:44:17.787

使用此命令：

```
Select * from ::fn_dblog(null,null) 
```

有关更多信息，请参阅此链接：[您如何解码事务日志中的简单条目](http://sqlfascination.com/2010/02/03/how-do-you-decode-a-simple-entry-in-the-transaction-log-part-1/)

# postgresql - FreeBSD：jail 无法设置 security.jail.sysvipc_allowed

> ID：11909993
> 
> 赞同：9
> 
> 时间：2012-08-10T22:18:53.457
> 
> 标签：postgresql, freebsd, jail

当我在 FreeBSD 监狱中初始化 PostgreSQL 数据库时出现问题。

我找到了一篇关于这个问题的文章。我尝试了它的建议，但我没有运气，我不知道为什么。有链接：[PostgreSQL in jail](http://www.freebsddiary.org/jail-multiple.php)。

[我还阅读了关于内核资源](http://www.postgresql.org/docs/9.1/static/kernel-resources.html)的 PostgreSQL 文档：

> 如果通过启用`sysctl`' 在 FreeBSD 监狱`security.jail.sysvipc_allowed`中运行，则在不同监狱中运行的 postmaster 应该由不同的操作系统用户运行。这提高了安全性，因为它可以防止非 root 用户干扰不同监狱中的共享内存或信号量，并允许 PostgreSQL IPC 清理代码正常运行。（在 FreeBSD 6.0 及更高版本中，IPC 清理代码无法正确检测其他监狱中的进程，从而阻止了不同监狱中同一端口上的 postmaster 运行。）

我做了什么：

*   我编辑`/etc/rc.conf`（在主机上）并添加了该行`jail_sysvipc_allow="YES"`
*   在监狱机器中`/etc/sysctl.conf`，我添加了一行`security.jail.sysvipc_allowed=1`

我多次重新启动监狱机器。我还没有重新启动主机，也不想。

希望有人能给我一个解决方案或一些建议。非常感谢。

这是我重新启动监狱时的消息：

```
 /etc/rc.d/sysctl: WARNING: unable to set security.jail.sysvipc_allowed=1 
```

或者当我手动运行 sysctl 时：（在监狱中）

```
 root@xxxxx:/home/xxxx# sysctl security.jail.sysvipc_allowed=1
 security.jail.sysvipc_allowed: 0
 sysctl: security.jail.sysvipc_allowed: Operation not permitted 
```

* * *

Freebsd 版本：FreeBSD xxxxxxx 9.1-PRERELEASE FreeBSD 9.1-PRERELEASE

postgreSQL 版本：postgresql-server-9.1.4

错误信息：

```
 root@xxxxxx:/home/xxx # /usr/local/etc/rc.d/postgresql initdb
 The files belonging to this database system will be owned by user "pgsql".
 This user must also own the server process.

 The database cluster will be initialized with locale C.
 The default text search configuration will be set to "english".

 creating directory /usr/local/pgsql/data ... ok
 creating subdirectories ... ok
 selecting default max_connections ... 10
 selecting default shared_buffers ... 400kB
 creating configuration files ... ok
 creating template1 database in /usr/local/pgsql/data/base/1 ... FATAL:  could not create      
 shared memory segment: Function not implemented
 DETAIL:  Failed system call was shmget(key=1, size=2146304, 03600).
 child process exited with exit code 1
 initdb: removing data directory "/usr/local/pgsql/data" 
```

* * *

更新：

在主机中，/etc/sysctl.conf：security.jail.sysvipc_allowed=1 /etc/rc.conf：jail_sysvipc_allow="YES"

在监狱服务器中，没有额外的 jail_sysvipc 配置。

主机中的 sysctl 值：

```
 root@xxxxx:/home/xxxx# sysctl -a | grep 'sysvipc'
   security.jail.param.allow.sysvipc: 0
   security.jail.sysvipc_allowed: 1 
```

我仍然收到与以前相同的错误消息。

另外，我想知道 security.jail.param.allow.sysvipc 是否有任何东西？因为，在主机中，我不允许设置它。(security.jail.param.allow.sysvipc 0-> 0)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-10T13:34:18.917

找到解决方案。以下对我有用。在**主机**上，执行：

```
root@host# jls
   JID IP 地址 主机名 路径
     3 - some.jail /usr/jails/somejail

```

找到正确的 JID，在我的示例中为 3。然后，在**主机**上，发出：

`jail -m jid=3 allow.sysvipc=1`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-15T15:10:07.420

监狱有一些特殊粒度的新功能，我们需要允许更改每个监狱的 sysvipc_allowed 将其放在 /etc/rc.conf 中：

```
jail_example_parameters="allow.sysvipc=1" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-14T17:30:26.207

在队友的帮助下，我发现了问题。

因为我使用/etc/jail.conf，所以我必须添加一行“allow.sysvipc”来启用系统共享内存。

在主机中，

```
 /etc/sysctl.conf
  security.jail.sysvipc_allowed=1

  /etc/rc.conf 
  jail_sysvipc_allow="YES" (DO NOT have to do this, remove it) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-12T23:31:28.033

sysctl`security.jail.sysvipc_allowed`必须在*主机*上设置，而不是在监狱中。但是，如果您`jail_sysvipc_allow="YES"`在主机`rc.conf`中设置，那应该为您设置，请参阅`/etc/rc.d/jail`。

如果启动监狱，您应该检查主机的值是否`security.jail.sysvipc_allowed`更改为 1。如果没有，你的 rc.conf 中可能有问题。尝试在*主机*`security.jail.sysvipc_allowed`上手动设置。

 ** * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-08T01:17:13.367

我的系统需要在重新启动监狱之前修改 /etc/rc.conf，否则它将主机和监狱都设置为 0。我*不需要*在 /etc/sysctl.conf 中设置 security.jail.sysvipc_allowed=1。

```
/etc/rc.conf:
jail_sysvipc_allow="YES" 
```*

# c++ - 路径树到树结构

> ID：11909995
> 
> 赞同：2
> 
> 时间：2012-08-10T22:19:21.890
> 
> 标签：c++, algorithm, tree

您好，假设您有普通的 unix 路径树作为输入（作为字符串）。

```
root 0
root/file1.txt 1
root/file2.txt 2
root/folder1 3
root/folder1/file3.txt 4
root/folder1/file4.txt 5
e.t.c. 
```

将此字符串转换为树数据结构的更好方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T09:07:42.043

Now i use simple tree representation, created by myself

```
template<typename T>
class TreeNode
{
public:
    TreeNode() {};

    TreeNode(T)
    {
        value = T;
    }

    TreeNode(const T& value)
        : Value(value)
    {
    }

    T Value;
    vector<TreeNode<T>*> Children;
}; 
```

I don't really understand Gir's algorithm (posted above). But i suppose the solution must be the following:

```
1\. Get a root node, set depth_level = 0
3\. set support_node = root_node
4\. for each path line
5\.     determine the quantity of slashes "/", key and file(folder) name

so for example in string root/folder1/file4.txt 5, num of slashes = 2 filename = file4.txt, key = 5
       create current_node
6\.     if num_of_slashes == level + 2
7\.          set support_node = current_node
8\.     if num_of_slashes == level + 1
9\.          add children to support_node
10\.    And after that we must remember all ancestors,  going down to leaves. Cuz we can  return to any ancestor. 
```

For me this algorithm seems to be really complicated. I don't understand algorithm, posted above, maybe it is possible to clarify this question? Maybe the structure i use to store the tree isn't the best one?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T23:21:05.750

像这样的东西：

为“\”创建一个根节点

```
node=root;
token=getNextToken(inputString);
while (token){
 if (!node.childExist(token)) node.createChild(token)
 node=node.Child(token)
 token=getNextToken(inputString);
} 
```

# knockout.js - 带有淘汰赛的 RadioButtonList

> ID：11909997
> 
> 赞同：3
> 
> 时间：2012-08-10T22:19:36.680
> 
> 标签：knockout.js, radio, radio-group

我需要一个带有一堆类似于 CheckBoxList 的开/关选项的 RadioButtonList。我需要将它转换为每个选项的开/关，但 Knockout 将一组单选按钮解析为一个值。建议？

示例：http: [//jsfiddle.net/DPnBE/2/](http://jsfiddle.net/DPnBE/2/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T20:59:21.187

我做了一个自定义绑定。您可以通过将先前选择的项目存储在某处来摆脱 for 循环。然后你只需要选择和取消选择 2 个项目。

**更新示例：http:** [//jsfiddle.net/DPnBE/5/](http://jsfiddle.net/DPnBE/5/)

```
ko.bindingHandlers.radioCheck = {
    init: function(element, valueAccessor) {
        //initalize checked value of element
        element.checked = valueAccessor()();

        //attach event to handle changes
        $(element).change(function(e) {
            var item = ko.dataFor(element);
            var items = ko.contextFor(element).$parent.items;
            for (var i = 0; i < items.length; i++) {
                //set selected() for all items
                //true for the checked element, false for the rest
                items[i].selected(items[i] == item);                
            }
        });        
    }
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T22:58:19.507

我发现匹配单选按钮和复选框的最佳方法是将`checked`绑定设置为选定值的数组。

但是，要使其正常工作，每个单选按钮/复选框都需要一个值，然后该值与所选值数组中的值相匹配。

根据您的小提琴，我想出了以下 HTML：

```
<div id="two">
    <div data-bind="foreach: items">
        <label>
            <input name="items" 
                   type="radio" 
                   name="radioItems" 
                   data-bind="value: name, 
                              checked: $root.selectedItemNames" />
            <span data-bind="text:name"></span>
        </label><br/>
    </div><div data-bind="text: ko.toJSON($root)"></div>
</div> 
```

这是使它工作的JavaScript：

```
var viewModel2 = {
    "items": [
        {
            "name": "one",
            "selected": ko.observable(false)
        },
        {
            "name": "two",
            "selected": ko.observable(true)
        },
        {
            "name": "three",
            "selected": ko.observable(false)
        }
    ]
};

viewModel2.selectedItemNames = ko.computed(function(){
    var selectedNames = [];
    ko.utils.arrayForEach(viewModel2.items, function(item) {
        if(item.selected()){
            selectedNames.push(item.name);
        }
    });
    return selectedNames;
});

ko.applyBindings(viewModel2, document.getElementById('two'));​ 
```

最后，这是我的分叉小提琴的链接，您可以在其中查看此代码的运行情况，以及以类似方式工作的复选框的重新设计版本：

如果您有任何问题，请告诉我。

**更新：http:** [//jsfiddle.net/jimmym715/h2e9j/](http://jsfiddle.net/jimmym715/h2e9j/)

# c - c++ 调用 c 函数 mbstowcs() 更改参数

> ID：11909999
> 
> 赞同：0
> 
> 时间：2012-08-10T22:19:55.557
> 
> 标签：c, visual-studio-2008, visual-c++

我有一个 mbstowcs() 不能正常工作：

```
mbstowcs(pParams->strDstFile, parParams->DstFile, sizeof(parParams->DstFile)); 
```

调试时的参数值是：

```
pParams->strDstFile = 0x0018e70c
parParams->DstFile = 121 long null terminated string.
sizeof(parParams->DstFile) = 1024 
```

参数类型是：

```
TCHAR strDstFile[2048]; 
char DstFile[1024]; 
```

在进入 mbstowcs(wchar_t *pwcs, const char *s, size_t n) 之后：

```
wchar_t  *pwcs = 0x0018ef0c 
```

这与发送的值不同。这会导致上述调用出现故障。

ps 在另一个函数调用中，和这个几乎一样，唯一的区别是第一个参数（pwcs）不同，没有问题。

该应用程序的连续运行给出了相同的结果，具有完全相同的地址值。

在查看另一篇文章时，它似乎是一个悬空指针/缓冲区溢出，尽管我无法使用内存断点跟踪它。

我在想也许是堆栈损坏？

谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T15:07:23.817

关于 TCHAR 和各种 TCHAR 宏的扩展方式似乎有几种不同的影响，请参阅[_UNICODE vs UNICODE](http://www.winehq.org/pipermail/wine-devel/2002-January/003565.html)和这篇[关于 _UNICODE vs UNICODE 的帖子](http://forums.codeguru.com/archive/index.php/t-221286.html)。

在使用`mbstowcs()`max size 参数时，应以字符为单位指定目标缓冲区的大小，而不是源缓冲区的大小。这将有助于防止缓冲区溢出。请参阅[mbstowcs 描述](http://msdn.microsoft.com/en-us/library/k1f9b8cy%28v=vs.80%29.aspx) ，还请注意，`mbstowcs()`如果字符数达到最大值，则不会零终止，这种行为类似于大多数字符操作函数。

由于`mbstowcs()`是用于宽字符串，因此您确实应该使用宽字符串而不是 TCHAR。

看起来您的问题是由于堆栈覆盖造成的。您是使用相同的测试数据还是使用不同的数据并得到不同的结果？

Microsoft 为 Visual Studio 引入的各种 TCHAR 和 _T() 扩展实际上是为了允许在 Windows 的非 UNICODE 版本（例如 Windows 95/98）和 UNICODE 版本的 Windows（例如 Windows XP）之间轻松移植应用程序。多字节字符串功能还旨在为 Windows 95/98 的泰语或简体中文等语言提供支持，因为它们没有太多对 UNICODE 的核心 Windows API 支持，UNICODE 是 32 位 Windows 版本（如 Windows XP 或 Windows）的一部分行政长官。

在 Windows XP 及更高版本的 UNICODE 世界中，使用 TCHAR 扩展似乎没有什么价值，因为它们只会增加源代码和编译器设置的复杂性。

不确定您为什么使用多字节字符串而不是 UNICODE。我有一个针对 Windows 98 和 Windows XP 的旧应用程序，它确实在用户界面上进行了一些转换，但是所有内容都在内部存储为宽字符 UNICODE 字符串。我在应用程序中引入了对多字节字符串的原始支持，因为当时它似乎是必要的，但是虽然这在当时看起来是个好主意，但它引入了我真的希望我没有做过的复杂性。可能你正在做类似的事情。